@&#MAIN-TITLE@&#
HiGeoM: A symbolic framework for a unified function space representation of trivariate solids for isogeometric analysis

@&#HIGHLIGHTS@&#
We propose a unified function space representation of trivariate solids and its attributes.We develop an approach for ab-initio construction of trivariate description of geometry using generative modeling techniques.The analysis of the constructed geometries enables isogeometric analysis without need for finite element mesh.We develop a symbolic modeling framework to construct trivariate solids and carry out isogeometric analysis.

@&#KEYPHRASES@&#
Generative modeling,Trivariate solid NURBS,Isogeometric analysis,Symbolic modeling,CAD–CAE integration,Analytic solids,

@&#ABSTRACT@&#
In this paper, a procedural description of solids is proposed with representational domain that encompasses the needs in Computer Aided Design (CAD), heterogeneous object modeling and Computer Aided Engineering (CAE). Specifically, a function space formalism, that unifies the representation of geometry and physical attributes, is proposed along with an algebra that operates on elements in those spaces. A declarative programming language is provided, which accepts a subset of mathematical semantics specified using the Mathematical Markup Language (MathML) as well as a fortran-like syntax. The language enables a high-level definition of the geometric model using continuous affine transformation and boolean operators leading to a mixed-dimensional representation. Thus, it is possible to construct analytically defined shapes as well as spline representation of complex geometry. The framework is demonstrated by constructing complex engineered solids and isogeometrically solving boundary value problems on the constructed solid.

@&#INTRODUCTION@&#
The solid models constructed in a modern CAD system satisfy many requirements including: boundedness/finiteness, closure under constructive operations, finite describability and boundary determinism  [1–3]. One property that is arguably missing from this requirement list is deformation and solid-like behavior, so that the model for solids takes into consideration the behavior of physical solids.In recent times, solid modeling has spawned the area of heterogeneous object modeling  [4–8]. This area concerns itself with methods and systems for primarily modeling solid objects composed of different constituent materials and/or subregions with different material composition. Classical solid models (Manifolds and cell complexes  [9]; R-sets and constructive solid geometry (CSG)  [1]) assume homogeneous domains. Heterogeneous object modeling aims at increasing the representational fidelity of solids to support emerging manufacturing applications such as those aimed at functionally graded materials. But, the focus has yet to be extended to enable modeling of other physical attributes of solids.The physical behavior of solids (displacement, stress, temperature etc.) is computationally deduced from solutions to partial differential equations (PDEs) applied on a given domain. Implied in solving such PDEs is the need to address specific regions within the domain on which the problem is posed as well as a need to directly specify locations within the domain at which the solutions are desired. Consequently, the mathematical models defined in traditional solid modeling, particularly the approaches that are based on a boundary representation, may be insufficient to represent such a physical behavior.Therefore, the question can be asked if it is indeed possible to develop a procedural description of solids with representational domain that encompasses the needs in Computer Aided Design (CAD), heterogeneous object modeling and engineering analysis (CAE). Additionally, can this representation meet the practical, adaptive (or as needed) refinement/fidelity requirements in both CAD and engineering analysis with minimal computational cost. That is, would the representation be suitable to describe the boundary as well as enumerate over the field for solving the analysis problem. These questions also naturally fall within the scope of CAD–CAE integration methods or isogeometric analysis techniques  [10,11].To address these questions, we develop and describe a symbolic trivariate solid construction approach that allows the generative definition of trivariate solids. Such mathematical solids that represent the behavior of physical solids are referred here as analysis amenable solids. Throughout the discussion here, we focus on solving elliptical PDE for engineering applications and refer to such a solution procedure as engineering analysis.Related to the present work, Staton and Crain  [12] defined a parametric cubic modeling system for unified representation of lines, surfaces, volumes and additional physical attributes. Casale and Stanton further studied construction techniques of the parametric cubic modeling, referring to it as analytic solid modeling  [13]. The freeform deformation approach by Sederberg  [14] defines a deformation field represented by a trivariate Bernstein polynomial for manipulating an embedded solid model. An approach for using trivariate functions for freeform sculpting was considered by Raviv et al.  [15] in which surfaces are defined as zero sets of scalar trivariate B-spline fields. Joy  [16] explored the use of hyperpatches for modeling free-form solids as an extension of modeling operations on surfaces. It should be further noted that with the exception of hyperpatch modeling and analytic solid modeling approaches, most methods utilize the trivariate representation only as a geometric manipulation tool. Recently, there is an increasing interest in trivariate solid construction motivated by isogeometric analysis that is exemplified by Refs.  [17–19]. The aim of this literature is to achieve tighter integration between design and analysis through a common mathematical representation.A number of procedural approaches exist in CAD  [20,21]. Procedural approaches allow the construction of solid models such that the validity of the models directly correlate to syntactic validity. These approaches are naturally amenable to a symbolic approach for defining the CAD geometry construction procedure and also result in a compact representation. Multiple CAD approaches, which include symbolic feature-based approaches, fall into the category of procedural approaches, but we focus only on those procedural approaches that define and manipulate geometric entities directly. Examples of systems that provide complete environments for creating geometric models of solids are PLaSM  [22,23], GenMod  [24] and FRep  [25]. PLaSM, which stands for Programming Language for Solid Modeling is based on the FL functional  [26] style programming language where the basic type are polyhedral objects, which enables it to define both manifold and non-manifold polyhedral solid models. GenMod is likewise a symbolic programming language, but it aims to produce shapes and constructs that are general transformations resulting in surface models. F-Rep was developed as a formalism for allowing general implicit functions as the main defining functions to allow the creation of semi-analytic representation of solids. The Hyperfun language was, for instance, derived from F-Rep  [21], however, with a focus on visualization applications. These approaches provide symbolic solid modeling framework, however, they lack the capability of constructing analysis amenable solids.In this work, we describe a symbolic trivariate solid construction approach that allows the generative definition of trivariate solids. We propose functional spaces and an algebra which operates on elements in those spaces for the representation of heterogeneous solids through their geometry and attributes. The specific contributions described in this paper are:1.Algebraic system: The development of a function/curve-based algebraic system with a set of operators sufficient for capturing geometric operations and final construction of analysis amenable trivariate solids.Discretization algorithm: A discretization operation for converting the symbolic trivariate solid description to an analysis suitable solid. The discretization operation is linear over the operators for constructing the trivariate representation, leading to a procedural discretization approach.Implementation framework: A framework embodying the shape algebraic system. The framework includes a parser for the MathML expressions, an ability to carryout symbolic calculus or other operations, and a semantic analysis code that maps the expressions to geometric construction operations based on the developed algebra.The rest of the paper is organized as follows. In Section  2, a general representation of analysis amenable solids is proposed. A symbolic geometric modeling framework that has the capability of generating analysis amenable functional solids is described in Section  3. Trivariate construction through continuous affine transformations is proposed in Section  4. A discretization approach for constructing analysis suitable trivariate solids is described in Section  5. The architecture, organization of code and implementation details of the system are described in Section  6. The capabilities of the system are illustrated through examples in Section  7. The paper is finally summarized in Section  8.In this section, we propose a representation for general solids to meet the needs in CAD, heterogeneous object modeling and engineering analysis (see Fig. 1).Consider a functional spaceF. We define the instance of a solidSas a product space of the geometryG⊂Fand a collection of itskattributesAi⊂F,i=1,2,…,k, thus,S=(G×(A1×⋯Ai…×Ak)). This functional representation of solids provides an explicit enumerative description for every point in the domain. The attribute fields are modeled through the same space of functions used for modeling the geometry and completely describe the physical behavior of the solids. Some of the attribute fields are defined a priori, for instance, material field. Other attribute fields are obtained by an appropriate mapping; for example, in  [27], the analysis problem is defined as a mapping from the design state consisting of geometry and material fields in the domain to the behavioral field. Another example is a mapping for creating an instance of a solid needed for visualization. In this case, the mapping would create attributes defining color appropriate to display some specific behaviorSu=G×U.A design stateDis described as the product spaceD=(G,ℳ)of geometryG⊂Hp, materialℳ⊂Hqand an appropriate mappingA:G×ℳ→Uto behaviorUfor analyzing the design state (Fig. 1). Here,His the space of Hilbert functions. These functions have properties needed for representing both analysis fields in discretized form and suitable for engineering analysis as well as the functions needed to define other attributes over the domain. Hilbert space of functions of orderm,Hmare particularly important because they are complete inner product spaces, and every Cauchy sequence defined within the space converges, guaranteeing that the PDE problems approximated by functions from this space converge  [28]. Further, inΩ⊂Rn,u,v:Ω→R,Hmis defined by an inner product of the form:(1)(u,v)m=∫Ω(uv+u,iv,i+u,ijv,ij+⋯+u,ij⋯k︸mindicesv,ij⋯k︸mindices)dΩ,1≤i,j,…,k≤n.Hence, every function in this space has the norm‖u‖m=(u,u)m1/2defined, and the function values and all the derivatives up to themth one are bounded.The orderpforG⊂Hpdepends on the smoothness requirement on the geometry. LetCkbe the space of functions which are bounded, continuous and have continuous and bounded derivatives of orderj,1≤j≤k. An important result of the Sobolev embedding theorem is thatHs⊂Ckifs>n/2+kwherenis the dimension of the space  [29]. Thus, in three-dimensional space withn=3, in order to ensureC0continuity,G⊂H2while forC1smoothness,G⊂H3. A discontinuous material field,ℳ⊂H0is, in general, acceptable for analysis. However, material field with higher smoothness may be desired in applications involving functionally graded materials, thus,ℳ⊂Hq,q≥0.Here, we assume that the general functional spaceFis defined over the unit interval[0,1]n. We further assume that the types of functions inFthat are allowed are functions that belong to the space of smooth functionsC∞or functions that belong to the space of Hilbert functions of an appropriate orderm,Hm. Functions from the space of smooth functions are particularly useful for describing attribute fields as will be discussed later.A complex design state or the global instance of a solid is viewed as the union of local instances of solids. Every element{Si}of the local set of instances of a solidSis the product space of the local geometry and the collection of attributesGi×(A1i×⋯Aki). The global state is then defined asS=∗iSi, where∗denotes valid operations{⋃,⋂,−}on the local geometry. The physical attributes in the global design state are defined using the Hierarchical Partition of Unity Field Compositions (HPFC) theory  [27] as weighted composition of attributes of the local instances of solids such that the weightswΩisatisfy partition of unity over the global domain. Such partitions of unity ensure convergence of the global approximations when errors in local approximations are bounded. Thus, at any pointxin the design domainΩ, the following representation of the composed attribute fieldsfi∈Aiis possible(2)f(x)=∑iwΩi(x)fi(x)such that weights obey partition of unity as follows:(3)∑iwΩi(x)=10≤wΩi≤1(4)‖wΩi‖L∞(Rd)≤C∞(5)‖∇wΩi‖L∞(Rd)≤CGdiamΩi.This smooth weight fieldwΩidescribed over the local instance of solid is another example of an attribute field of the solid.Here, we describe a symbolic geometric modeling framework that has the capability of generating analysis amenable functional solids based on parametric functions that fall into the class of functionsFmentioned earlier and mixed topological dimension. The generative modeling approach followed here is based on the work by Snyder  [24].A generative model is created by continuous transformation of lower-dimensional entities, namely, the generators. In this work, generative definition of trivariate solids is proposed by defining valid operands (generators) operated on by valid operators (transformations). The geometry construction of the primitive solid at the local level of the design state is done through operators defined such that the functions on which they operate become significant as shape descriptors in the resulting geometric entities. Additionally, the operators are defined such that they are closed under the general space of defining functions.A parametric functionfis defined asf∈F:[0,1]n⊂Rn→Rl. Parametric functions that belong to the space of smooth functionsC∞or to the space of Hilbert functions of ordermwith complete inner productHmare permitted as valid operands.For example, consider the function,f:R→R3, with parametric variableusuch thatf(u)=(f1(u),f2(u),f3(u))represents the geometric coordinates inE3of a helix (Fig. 2) as shown in Eq. (6):f1(u)=2cos(20πu)f2(u)=2sin(20πu)f3(u)=10u(6){xyz}=f(u)={f1(u)f2(u)f3(u)}.The same class of parametric functions are also used to define the attributes associated with the geometric entity. For instance, in the previous example, the geometryGiand r–g–b color attributesAri,Agi,Abiare defined by the parametric function in Eq. (7) whereGi,Ari,Agi,Abi⊂F([0,1]).(7){{xyz}{rgb}}=f(u)={{f1(u)f2(u)f3(u)}{12|f1(u)|12|f2(u)|u}}.In this example, the parametric functions are represented as vector objects. In Appendix, more general tensor objects are defined to represent a collection of parametric functions.Valid operatorsϕare defined such that they are closed under the general space of defining functions, that is, given functionsf,g∈Fthenϕ(f,g)∈F.Two types of operators are considered in this work. One set of operators only modify the underlying parameterization without changing the topological dimension of the entity. Examples of operators that only modify the underlying parameterization without changing the topological dimension of the entity are arithmetic, inversion, join and calculus operators. These are described in detail in Appendix. Figs. 3 and 4illustrate the application of these operators.The second set of operators result in an increase in the manifold dimension of geometric entities. Operators that turn functions defined over unit intervals to functions defined over unit squares are an example of the latter type resulting in an increase in the topological dimension of the entity.The operators considered in this sectionA(v)∈Fwhen applied on parametric functionsc(u)∈Fresult in higher-dimensional topological entitiesS(u,v)∈Ffrom lower-dimensional topological entities, i.e., defining 3-manifolds from 2-manifolds and 2-manifolds from 1-manifolds. The generalized continuous affine transformation applied in this section is of the form(8)S(u,v)=A(v)c(u)+t(v).The result of these operations are functions whose domains are tensor product of the domains of the operandf:[0,1]×[0,1]→Rand the parameterization of the individual operands are considered independently. The surface defined in Eq. (8) can be defined in homogeneous coordinates as a tensor product surface of the form(9)S(u,v)=H(v)c(u)H(v)represents the transformation in homogeneous form andc(u)is a curve both with elements inFand defined as tensors of order 2 and order 1 respectively. We describe specific types of generalized continuous affine transformations next.The profile product is the simplest surface that may be generatively defined  [24]. It is defined as the product of a cross-section curvec(u)with a profile curvep(v), both assumed here to be in thex−yplane for simplicity, as shown below:(10)S(u,v)=[px(v)0000px(v)0000py(v)00001]{cx(u)cy(u)11}.In Fig. 5, the use of profile product operations to create the body and cap of the tea pot is illustrated.The wire product transformation is obtained when a cross-section curve is translated along a “wire” curve while maintaining the cross-section curve to be perpendicular to the wire curve. This is illustrated in Fig. 6. The tensor product operator is therefore obtained from a moving frame computed from the second operand (curve). Letγv(v)be the wire curve withτ(v)as its unit tangent vector. Then, a moving frame associated withγv(v)is defined by an orthonormal system of vectors(τ(v),η(v),b(v))(see Fig. 6(a)) such that(11)τ(v)=γv′(v)‖γv′(v)‖b(v)=γv′(v)×γv″(v)‖γv′(v)×γv″(v)‖η(v)=b(v)×τ(v).Then, we obtainH(v)from the moving frame,{γv(v),τ(v),η(v),b(v)}relative to the original frame{γv(0),τ(0),η(0),b(0)}. We make the choice of using the rotation minimizing frame which may be readily obtained using the project method  [30] or the double reflection method  [31]. However, in our case we solve the rotation minimizing vectorbˆ(v), which uniquely describes the rotation minimizing frame as the solution to the differential equation(12)bˆ′(v)−d(v)τ(v)=0bˆ(v)⋅τ(v)=0}for some functiond(v). The first equation constrains the direction ofbˆ′(v)to be parallel to the tangentτ(v)and second equation preserves orthogonality. With the goal of ensuring that the result of the product transformation is closed under Non-Uniform Rational B-Splines (NURBS) operations, we approximate the frame vectorbˆ′(v)as a B-Spline. Product transformation over a closed curve prescribes an additional condition on Eq. (12) thatbˆ(0)=bˆ(1).Fig. 4 as well as Fig. 7are examples of surfaces constructed through a wire product operation. The functional form of the helix and the circle defined parametrically such that its coordinates belong toFare referred to as shape descriptor functions. The transformation tensorH(v)in Eq. (9) is obtained from the helixf(v)defining the moving orthogonal frame(tf(u),nf,bf), where these are the tangent, normal and binormal unit vectors. In general, the normal and binormal vectors are non-unique, but simply span the normal plane of the defining curve, or helix in this case.The rail transformation is a sweeping operation on the cross section area constrained between two curves. The rail transformation is similar to a constrained sweep operation, in which a scaling effect is introduced into the transformation to ensure that resulting surface interpolates the ends. A simple example of this type of transformation is a ruled surface, in which the cross section of the transformation is a straight line. Fig. 8shows an example of a rail transformation defined by a trochoid,t(v), shown in red, and a straight line,l(v), shown in green. Both of these rail curves are assumed here to be in thex–yplane for simplicity. These quantities are defined in Eq. (13)(13)t(v)={4+bcos(6πv)6πv+bsin(6πv)}l(v)=(1−v){P1xP1y}+v{P2xP2y}where,P1andP2are the end points of the straight linel(v), andbis a parameter that determines the shape of the trochoidt(v). Specifically, in the chosen example,P2x=4+bcos(6π)andP1y=P2y. Further defining(14)r(v)=[t(v)−l(v)]2,m(v)=[t(v)+l(v)]2.The surfaceS(u,v)in Fig. 8 is obtained by the rail transformation:(15)S(u,v)=[rx(v)00mx(v)ry(v)00my(v)01000001]c(u),withc(u)={cos(2πu)sin(2πu)01}.Trivariate geometry construction is achieved through sequential application of continuous affine transformations as defined in Eq. (9). The affine transformations applied on three operands or applied twice sequentially result in a trivariate function belonging toF. In fact, when multiple operands are passed to the operator, the application is done sequentially in a manner similar to currying in functional programming languages  [32]. In this case, the identity tensor product is applied on the initial operand. Here, a trivariate solid is defined through the following tensor product:(16)B(u,v,w)=H(w)S(u,v).In the above equation,H(w)may be defined using any of the products (profile, wire or rail) described earlier.Fig. 9illustrates a trivariate cylindrical solid obtained as a wire product of the section over the circle of revolution.In Fig. 10, we illustrate another trivariate solid “thread” constructed using operators defined over the helical shape descriptions.The boolean operators of union, intersection and difference can be applied on trivariate functions to allow the construction of more complex entities. The boolean operator shares relationships to some of the previously defined operators. For instance, the join operator is a specific union operator defined on 1-manifolds. On the condition that the dimensionality of the operands are the same, the intersection of the operands leads to a lower-dimensional entity. The numerical implementation of the boolean operations is described in detail in Ref.  [33].Smooth functions are retained as smooth functions, but their evaluations are done over their discretized form. That is, we assume that a suitable “discretization” operation exists such thatp:C∞→Hm. Thus, the functions inC∞([0,1])are converted to an appropriate function inHm([0,1])using a discretization procedure discussed in the next section. The evaluation of an entity therefore constitutes the evaluation over the parameter range of the defining functions. This therefore leads to a recursive evaluation over the composition of the discretized form of the defining functions.In the previous sections, we described a generative modeling framework for constructing “analysis amenable” functional solids based on parametric functions that fall into the class of functionsF. However, analytic solids belonging toC∞may not be convenient to use within analysis frameworks that rely on numerical quadrature and matrix solutions. In this section we illustrate the conversion process fromC∞functions toHm.NURBS is used as the canonical form of functions belonging toHm. The NURBS form has desirable properties for engineering analysis  [10,11]. Thus, analysis amenable solids are constructed for the class of functionsFby one of the following two approaches—1.Tensor product operations on NURBS entities. In this case, the discretization step is skipped.Discretization of analytic functions into NURBS entities followed by suitable product transformations.In developing a discretization procedure, we exploit some known properties of polynomials and the relationship between B-Splines, Bernstein polynomials and Chebyshev polynomials  [34–36]. The well known Weierstrass theorem from approximation theory states that any function can be approximated arbitrarily close by a polynomial over a finite interval and that a polynomial which gives the best approximation is unique  [37]. Furthermore, the Chebyshev polynomials give the best approximation under the minimax conditions. That is, the Chebyshev polynomials result in the polynomial,pn(x)=a0+a1x+a2x2+⋯+anxn, such that the‖f−pn‖L∞is minimized. A shape adaptive Chebyshev polynomial interpolation procedure with both error and refinement constraints is constructed. The Chebyshev polynomial is converted to the Bezier curve using a basis transformation  [36], which is in turn converted to a B-Spline form. The Chebyshev interpolation procedure that is developed here is motivated by the application of Chebyshev interpolation polynomials for degree reduction of B-Spline and Bezier curves  [38]. Consequently, the procedure described has benefit of generating shape adaptive linear piecewise approximations to a given shape descriptor function fromF.There are four kinds of Chebyshev polynomials  [35], but we focus on the first-kind, which is typically denoted by its basis functionTn. The Chebyshev polynomial of the first kind is a polynomial inxof degreendefined by the relation:(17)Tn(x)=cosnθandx=cosθ.The natural range ofxis the interval[−1,1]and corresponds toθ∈[0,π]. If one considers thecosθover the range[0,π]it is observed that thexis decreasing from 1 to−1, therefore the range ofxis reversed during evaluation. The first few bases of the Chebyshev polynomial areT0=cos0θ=1T1=cos1θ=cosθ=xT2=cos2θ=2cos2θ−1T3=cos3θ=4cos3θ−3cosθTn=cosnθ=2cosθcos(n−1)θ−cos(n−2)θwhich result in the recurrence relationship(18)T0(x)=1T1(x)=xTn(x)=2xTn−1(x)−Tn−2(x),n=2,3,….The functions we consider all belong toFdefined over[0,1]. Therefore, a change of variablex=2u−1is used resulting in the shifted form of the Chebyshev polynomial(19)Tn(x)=Tn(2u−1)=Tn∗(u)leading to the recurrence relation(20)Tn∗(u)=2(2u−1)Tn−1∗(u)−Tn−2∗(u),n=2,3,….The shifted form of the Chebyshev polynomial exhibits all the same desired interpolatory properties of the standard Chebyshev polynomial. The variableu, however, becomes equal to12(1+cosθ)and the roots of the Chebyshev polynomials are shifted.(21)uk=12{1+cos[(2k−1)π2n]}.The Chebyshev interpolation to a given functionf∈Fover the interval[0,1]is(22)pn(u)=∑i=0n(2n+1∑k=1n+1f(uk)Ti∗(uk))Ti∗(u).The error of the Chebyshev interpolation is defined as(23)en=f(u)−pn(u).The discretization procedure is made adaptive through a subdivision procedure, for which the number of subdivisions can be determined a priori  [36]. The minimum number of subdivisions based on an error toleranceεis given ass>1nlog2(pnε). Therefore, for a given degree,n, for a B-spline curve sought, the number of coefficients (control points) can be determined as(24)nc=(s+1)n+2.Therefore, the relationship between the number of coefficients and the error is(25)nc=1nlog2pnε+n+2.Fig. 11illustrates the fit using Chebyshev basis to a helix.The transformation from the Chebyshev basis to the Bernstein basis of Bezier curves is done using the transformation matrix described in  [36].All analytic functions are first discretized prior to evaluation. There are two consequences of this that are worth noting. The first is that discretization ensures that all sharp corners defined through multiplication with step functions or defined through the join operators are not captured in the discretized form. The second is that the operators on analytical functions may be applied on their discretized form, and the functions from the two sub-spaces of operands can be used together. Thus, for instance, in the radius variation shown in Fig. 7, the errors in the discretized form are carried through the join operator. Fig. 12illustrates the NURBS discretization resulting from the trivariate solid evaluation of the piston example described earlier.The above described discretization procedure converts analytic solids into analysis amenable NURBS solids. While one may debate whether analysis on such a discretized representation of analytic solids is truly “Isogeometric”, at this time, the “procedural” discretization described in the paper (as opposed to volumetric meshing) is necessary for purposes of analysis. However, if the solid is constructed starting from primitive NURBS entities, then no discretization is required and the mathematical representation used for analysis is identical to the geometric representation.HiGeoM is an integrated symbolic environment for geometric modeling and engineering analysis. HiGeoM enables the construction of complex geometrical shapes with inherent discretization that is amenable to isogeometric analysis  [10,11], as well as the definition and manipulation of variational formulations for elliptic partial differential equations.The capabilities in HiGeoM are factored into six core components: parser, symbolic manipulator, generative modeler, model data structures, approximations/discretized fields, and data type and arithmetic. These components are illustrated in Fig. 13.The parsers in HiGeoM accept user defined mathematical expressions in content MathML  [39] and a Fortran-like mathematical syntax. There are limitations to solely using a MathML syntax. This is due to the lack of flexibility needed for controlling the flow of operation and the inability to capture higher-level application specific semantics with intuitive mathematical syntax. Furthermore, the textual encoding of MathML is relatively verbose due to the tagged markup construct inherent in XML-based applications. However, given the availability of an editor such as the connexions Content MathML editor  [40] for the Mozilla Firefox browser or the formulator editor  [41], the use of content MathML can be very expressive when defining functional geometries  [42].The content MathML parser depends on the Xerces-J XML parser for checking well-formedness (conformity to the XML 1.0 specification) and generation of the Document Object Model (DOM)  [43], which in the case of content MathML corresponds to the expression tree representation of the mathematical expressions.The HiShar3D.mml sub-package contains the implementation of the Java binding to the MathML DOM interface and extends the MathMLContentElement to include a parse method that validates the subset of content MathML accepted in HiGeoM.With the Fortran-like syntax, the required parser is defined using the Java Compiler, parser generator (JavaCC)  [44]. The procedure for generating the JNS parser with JavaCC is illustrated in Fig. 14. All the arithmetic, trigonometric, transcendental and relational operators that are defined for the MathML elements are likewise accepted as valid operators by the parser.The HiExpression class embodies all the mathematical, geometric modeling and analysis problem definitions in HiGeoM and therefore defines the user’s interface to all its capabilities. There are six types of HiExpression: mathematical expression EXPRESSION, constant value VALUE, VARIABLE, function FUNCTION, geometric expression GEOM or an empty expression EMPTY. The typing of HiExpressions, with the exception of FUNCTION is determined from the user specified operations, hence, the typing is done dynamically. HiGeoM also provides a minimal set of operations for algebraic manipulation such as the simplification of HiExpression type of EXPRESSION and FUNCTION as well as symbolic differentiation and integration. The symbolic manipulation capabilities also enable the handling of variational statements of boundary value problem.The example in Fig. 15shows a mathematical expression containing symbolic variable “x”, construction of a parametric curve, parameterized over the symbolic variable “u” defined in HiGeoM. The string arguments to the higeom.makeExpr and higeom.makeLExpr methods in Fig. 15 are examples of valid expressions. Two symbolic operations of differentiation and integration involving the derivative of the expression as well as the line integral of the resulting expression are also illustrated.Complex 3-D geometric objects can be defined using arbitrary parametric functions and high-level operations such as tensor products in a similar manner as the curve in Fig. 15. Boolean operations can also be applied on the objects. The internal data structures representing the 3-D objects include the mathematical expression and high-level operations used for defining them.The analysis problem definition is done using a graphical user interface for defining symbolic elements of the analysis problem. These symbolic elements include the specification of the geometry, Geometry entities, material properties for a linear analysis problem, Material, enrichments for specifying discontinuities, singularities and boundary conditions, Enrichment entities. The existence of all these entities indicates that the analysis problem has been fully specified, and the analysis process can be initiated. Consequently, the analysis problem is defined as a collection of Geometry, Material, which is a special type of Attribute, and Enrichments defined on the Geometry.This section demonstrates the core capabilities of the system that has been developed and implemented for constructing trivariate NURBS solids. It also demonstrates the ability to define boolean operators over the trivariate NURBS solids. As mentioned earlier, the capabilities span three areas with the goal of integrating CAD and CAE through symbolic definition of geometry and its attributes. The underlying representation is based on the notion of product spaces of geometry and attributes for representing instances of solids.Therefore, the capabilities of the system will be illustrated through the following:1.Definition of a complex structure: a hex bolt using the operators defined earlier and using HiGeoM expressions.Computation of smooth weight field as an attribute over the hex bolt.Analysis and computation of behavior fields using hierarchical approximations enabled by the HPFC theory  [27].In designing a hexagonal bolt, there are three main parts of the structure: the head of the bolt, the shaft of the bolt and the thread. This division of the parts of the bolt design coincides with the functional aspects of a bolt. However, the partitioning of the bolt leading to its design in a CAD system would typically be governed by the tools and operations that are provided by a specific CAD system. While it is true that most CAD systems provide operations for standard engineered parts through a library of geometric shapes, the intent here is to use this complex geometrical shape to demonstrate the capability of HiGeoM.In considering the main parts of the hexagonal bolt, it would appear that the most complex part of the design is constructing the thread. Therefore, the dimensions illustrated in Fig. 16are first prescribed for the structure of the bolt. And the thread of the bolt is constructed from the parameterized dimensions given in Fig. 17for the external thread.The symbolic definition (using HiGeoM code) of the bolt thread is shown in the code snippet in Fig. 18. The circular cross section of the shaft of the bolt, the directrix for the shaft of the bolt and the head of the bolt were defined externally and loaded into the HiGeoM environment.The bolt solid is defined through the boolean union of the thread, shaft and the head of the bolt as shown in Fig. 19. The discretization and parameterization of the primitives are independently maintained during the boolean construction. As can be seen in Fig. 20, the level of refinement of the individual primitives may also be different. The expression tree of the boolean union of the primitives is equivalent to the CSG tree with the trivariate primitives at the nodes as in Fig. 21.An important element of HPFC theory is the construction of weight fields that determine the extent of contribution of approximations belonging to each primitive at a domain point (see Section  2.2). Here, the weight fields are constructed using signed distance fields from primitive boundaries. For theith primitive, signed distancedˆiis computed from the primitive boundaryΓisuch that(26)sign(dˆi)={1ifx∈Ωi−Γi−1ifx∉Ωi0ifx∈Γi.Further, R-functions  [46] that are functional equivalent of boolean operations are applied to compute signed distance for each primitive from the boundary of the region obtained by boolean subtraction of given primitive from all other primitives. That is, for two primitivesiandj, the signed distance field from the boundaryΓi−jis given by the following operation on signed distance fieldsdˆianddˆjfrom boundariesΓiandΓjrespectively.(27)dˆΓi−j=dˆi−dˆj−diˆ2+djˆ2.More generally, fornpintersecting primitives, with intersection regionΩ∩np, signed distance field ofith primitive for the region(28)Ωi−∩np=Ωi−Ω∩np=Ωi−(∩jΩj)j=1,2,…,npis computed by using Eq. (27) as follows:(29)dˆΓi−∩j=dˆΓi−∩j−1−dˆj−(dˆΓi−∩j−1)2+djˆ2j≠i,j=1,2,…,np.The weight field for theith primitive is constructed using the above signed distance field as(30)wˆΩi(x)={0ifx∉Ωi1inΩi−⋃j(Ωi∩Ωj)j=1,2…,np,j≠ie−(dˆΓi−∩np(x))2|dΓi(x)|in⋃j(Ωi∩Ωj)j=1,2…,np,j≠i.The global weight fields for a boolean union operation over the primitives with local primitive weight fieldswˆiis obtained as(31)wΩi(x)=wˆΩi(x)∑jwˆΩi(x).For the hex bolt that was constructed in previous Section  7.1, the primitive weight fields are shown in Fig. 22.The analysis capability of HiGeoM is illustrated by solving for the displacement field in the bolt when constant displacement boundary conditions were applied on the top and bottom surfaces of the bolt as shown in Fig. 23(a). The geometric primitives of both the solids, the head and the shaft of the bolt, were modeled as degree 2×2×2C1NURBS solids using a 11×11×11 control point net. Thus, the analysis domain contained 7986 degrees of freedom. Elastic modulus and Poisson’s ratio were set as 100 units and 0.3 respectively for each primitive. Compositional analysis was performed using the weight fields constructed in previous section, and the displacement field over the entire geometry was solved as shown in Fig. 23(b).

@&#CONCLUSIONS@&#
