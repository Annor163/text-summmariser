@&#MAIN-TITLE@&#
Discrete Malliavin calculus and computations of greeks in the binomial tree

@&#HIGHLIGHTS@&#
Discrete Malliavin calculus approach is introduced to compute greeks (sensitivity) of the option prices.Discrete Malliavin calculus is ‘Malliavin calculus’ on the binomial lattice.This method enables us to compute greeks easily using the binomial tree.Numerical demonstration indicates robustness of this method.All the results are obtained in an elementary manner.

@&#KEYPHRASES@&#
Discrete Malliavin calculus,European options,Greeks,Binomial tree,

@&#ABSTRACT@&#
This paper proposes new methods for computation of greeks using the binomial tree and the discrete Malliavin calculus. In the last decade, the Malliavin calculus has come to be considered as one of the main tools in financial mathematics. It is particularly important in the computation of greeks using Monte Carlo simulations. In previous studies, greeks were usually represented by expectation formulas that are derived from the Malliavin calculus and these expectations are computed using Monte Carlo simulations. On the other hand, the binomial tree approach can also be used to compute these expectations. In this article, we employ the discrete Malliavin calculus to obtain expectation formulas for greeks by the binomial tree method. All the results are obtained in an elementary manner.

@&#INTRODUCTION@&#
In the last decade, the Malliavin calculus has come to be considered as one of the main tools in financial mathematics. It is particularly important for computations of greeks. However, the Malliavin calculus appears to be a very difficult concept to understand for most practitioners. Because of these reasons, we employ the discrete Malliavin calculus on symmetric Bernoulli random walks. This approach enables us to compute discrete Malliavin greeks using only elementary mathematics.Greeks are quantities that represent the sensitivities of the price of derivative securities with respect to changes in the underlying asset price or parameters. They are defined in terms of the derivative of the option price with respect to parameters. One such greek, Delta, measures the sensitivity of the option price with respect to changes in the asset price. It is defined by the first derivative of the option value function with respect to the asset price. Another greek, Gamma, measures the sensitivity in the delta with respect to changes in the underlying asset price. It is defined by the second derivative of the option value function with respect to the asset price. Vega measures the sensitivity of the option price with respect to changes in the volatility level, σ. It is defined by the first derivative of the option value function with respect to the volatility level. These sensitivities are often important for risk management. In mathematical finance, sensitivities for options with a complex pay-off structure are often considered. Fournié, Laszry, Lebuchoux, Lions, and Touzi (1999) employed the Malliavin calculus to compute greeks and overcome these problems. For further discussion, refer to Benhamou (2003) and Kohatsu-Higa and Montero (2003) among others. In addition, refer Nualart (2006); Nunno, Øksendal, and Proske (2008), and Privault (2009) for discussions on the Malliavin calculus. Greeks are derived by combinations of the Malliavin calculus and Monte Carlo simulations in most previous studies. On the other hand, another important tool for evaluating greeks for contingent claims is the binomial tree approach introduced by Cox, Ross, and Rubinstein (1979). Although the naive finite difference approach is the most intuitive way to determine the sensitivity for the options value function, it is not a robust approach and thus not recommended. Pelsser and Vorst (1994) proposed a simple calculation for computing delta and gamma in the binomial tree approach. Also, refer to Hull (2008) for discussion on this topic. Although computational methods for delta and gamma have been investigated in these past studies, the computational method for the vega, for instance, is not clear if the simple finite difference approach is not used. There is an alternative method for computing greeks in the binomial tree approach. Rozario (2004) derived discrete Malliavin greeks in the binomial tree model by discretizing (continuous) Malliavin greeks. The effectiveness of this method is discussed in that article. However, an even more direct approach can be employed. Discrete Malliavin greeks can be obtained by the binomial tree approach. This approach is more direct because one does not have to consider the continuous time model. It directly leads expectation formulas for discrete Malliavin greeks in binomial tree settings. Interestingly, all the discussions on derivations of greeks with this approach are very similar to discussions in the continuous time model, when the discrete Malliavin derivative and the discrete Skorohod integrals are defined.The remainder of this paper is organized as follows. We introduce the discrete Malliavin calculus and the basic properties for the discrete Malliavin derivative and the discrete Skorohod integrals are also discussed. Leitz-Martini (2000) first introduced the discrete Malliavin calculus to obtain the discrete Ocone and Clark formulas. The discrete Malliavin calculus of Leitz-Martini (2000) was extended to more general cases by Privault (2008, 2009) for other applications. Leitz-Martini (2000) defined the discrete Skorohod integrals using discrete Wick products, and Privault (2008, 2009) defined them using the discrete Wiener–Chaos expansions. Although our definition on the discrete Skorohod integrals is more elementary than the definitions in these previous studies, they are equivalent each other. This is also discussed. The formulas for discrete Malliavin greeks after brief explanations on the binomial tree approach of Cox et al. (1979). Computational results are also presented in the last section.The discrete Malliavin derivative and the discrete Skorohod integrals are defined in this section. Further, we discuss the fundamental results of the discrete Malliavin calculus to evaluate greeks in the next section.Let∊i(p)i=1,…,Nbe a sequence of identically independent random variables defined on a probability space(Ω,F,Q)withQ∊i(p)=Δt=p,Q∊i(p)=-Δt=1-p(0<p<1).As a special case, if a random variable∊i(p)is a symmetric Bernoulli random variable, i.e. p=1/2, the random variable∊i(1/2)is denoted simply by ∊i. The time step Δt is fixed at Δt=T/N, where T is the horizontal time of our model. A filtration{FiΔt}i=0,…,Nis defined byF0={ϕ,Ω},FiΔt=σ∊1(p),…,∊i(p). We define that F as a random variable generated by∊i(p)i=1,…,N, if there is a function f(x1,…,xN) such thatF=f∊1(p),…,∊N(p). The random variable F is termed anFiΔtmeasurable random variable, if there is a function f(x1,…,xi), such thatF=f∊1(p),…,∊i(p). The symbols∊1(p),…,∊i(p)and (∊1,…,∊i) are denoted asei(p)and (ei), respectively, for simplicity. A set of random variables {FiΔt}i=1,…,Ndefined on time {Δt,2Δt,…,NΔt}, which is generated by∊i(p)i=1,…,N, is represented by a set of functions {fi(x1,…,xN)}i=1,…,N. It is expressed as(2.1)FiΔt=∑j=1NfjeN(p)1i(j),where a function 1i(j) is an indicator function, i.e., 1i(j)=1(i=j) and 1i(j)=0(i≠j). Then, a set of random variables {FiΔt}i=1,…,Nis called a stochastic process generated by∊i(p)i=1,…,N.Example 2.1A stochastic processWiΔt(p)i=1,…,Nis referred to as a random walk, ifWiΔt(p)is expressed asWiΔt(p)=∑j=1N∊1(p)+⋯+∊i(p)1i(j)=∊1(p)+⋯+∊i(p).As a special case, if the upward probability p is fixed at p=1/2, the stochastic processWiΔt(1/2)is referred to as a symmetric random walk. This symmetric random walk is denoted byWiΔt(1/2)=WiΔtfor abbreviation. The symmetric random walk is regarded as an approximation of the Brownian motion, if the time interval Δt is sufficiently small. The asymmetric random walkWiΔt(p)i=1,…,Nis also regarded as an approximation of the Brownian motion with a drift2p-1Δt.A set of random variables{FiΔt,jΔt}i≠ji,j=1,…,Ndefined on the pairs of times{(iΔt,jΔt)}i≠ji,j=1,…,Nis represented by the functions{fi,j(x1,…,xN)}i≠ji,j=1,…,N. It is expressed as(2.2)FiΔt,jΔt=∑k,l=1,k≠lNfi,jeN(p)1i,j(k,l),where the function 1i,j(k,l) is an indicator function, i.e., 1i,j(k,l)=1 (i=k and j=l) and 1i,j(k,l)=0 (otherwise). Then, a set of random variables{FiΔt,jΔt}i≠ji,j=1,…,Nis called a generalized stochastic process generated by∊i(p)i=1,…,N. We exploit the generalized stochastic process to compute gamma.In this article, we only introduce the discrete Malliavin calculus on the symmetric random walk. However, one can also construct the discrete Malliavin calculus on the asymmetric random walkWiΔt(p). Refer to Privault (2008, 2009) for discussion on that topic. Let us assume that there are two random variables X(eN) and Y(eN). The inner product on these random variables is defined by〈X,Y〉L2=E[X(eN)Y(eN)]=12N∑eN∈ΩX(eN)Y(eN).A set of random variables generated by {∊i}i=1,…,Nwith a finite norm is denoted by L2(Ω,Q). This set is called the discrete Wiener space.Definition 2.1The discrete Malliavin derivative for every random variable F=f(eN)∈L2(Ω,Q) is an operator from an element in L2(Ω,Q) into a stochastic process; {DiΔtF}i=1,…Nis defined byDiΔtF=∑j=1NfeNi+-feNi-2Δt1i(j)=feNi+-feNi-2Δt,where new symbolseik+andeik-are defined byeik±=∊1,…,∊k-1,±Δt,∊k+1,…,∊i.We will now demonstrate several examples of the discrete Malliavin derivative.Example 2.2A stochastic processWiΔtk±i=1,…,Nis a Bernoulli random walk with a deterministic epoch at time kΔt. In other words, the random variable ∊kis deterministic and is defined byWiΔtk±=∊1+⋯+∊k-1±Δt+∊k+1+⋯+∊iif k⩽i andWiΔtk±=WiΔtif k>i. Let us regard the random walk at time iΔt as a random variable. Applying the discrete Malliavin derivative to WiΔtresults in the following expression,DkΔtWiΔt=WiΔtk+-WiΔtk-2Δt=1k⩽i.Let f(·) be a differentiable function. Applying the discrete Malliavin derivative to a random variable f(WiΔt) leads to(2.3)DkΔtf(WiΔt)=fWiΔtk+-fWiΔtk-2Δt.We consider three cases for (2.3).•Case 1.k>i: The relationWiΔtk+=WiΔtk-=WiΔtis satisfied in this case. This relation leads to the immediate result DkΔtf(WiΔt)=0.Case 2.k⩽iand∊k=Δt: The relationsWiΔtk+=WiΔtandWiΔtk-=WiΔt-2Δtare satisfied. If Δt is sufficiently small, this relation leads to the following resultDkΔtf(WiΔt)=fWiΔtk+-fWiΔtk-2Δt=f(WiΔt)-fWiΔt-2Δt2Δt.The Taylor expansion formula leads tofWiΔt-2Δt=f(WiΔt)-2Δtf′(WiΔt)+2f″WiΔt-2θ1+(WiΔt)ΔtΔtwhere the new random variableθ1+(WiΔt)satisfies0⩽θ1+(WiΔt)⩽1. This yields the formulaDkΔtf(WiΔt)=f′(WiΔt)-2f″WiΔt-2θ1+(WiΔt)ΔtΔt.Case 3.k⩽i and∊k=-Δt: The relationDkΔtf(WiΔt)=fWiΔt+2Δt-f(WiΔt)2Δt=f′(WiΔt)+2f″WiΔt+2θ1-(WiΔt)ΔtΔtis satisfied for this case. The new random variableθ1-(WiΔt)satisfies0⩽θ1-(WiΔt)⩽1.These three cases are combined to obtain the following result:DkΔtf(WiΔt)=f′(WiΔt)+c1(ei)Δt1k⩽i,where c1(ei) is given byc1(ei)=-2f″WiΔt-2θ1+(WiΔt)Δtif∊k=Δt2f″WiΔt+2θ1-(WiΔt)Δtif∊k=-Δt.Let a function g(·) be differentiable and X=x(WiΔt), g(X)=g(x(WiΔt))∈L2(Ω,Q). Let assume that the function x(·) is also a differentiable function. Applying the discrete Malliavin derivative for g(X) leads to(2.4)DkΔtg(X)=gxWiΔtk+-gxWiΔtk-2Δt.We consider three cases for further calculations of (2.4).•Case 1. i<k: The formula DkΔtg(X)=0 is obviously satisfied.Case 2. The two conditionsk⩽iand∊k=Δtare satisfied: From the definition of the discrete Malliavin derivative, the formulaDkΔtg(X)=g(x(WiΔt))-gxWiΔt-2Δt2Δtmust be satisfied. The Taylor expansion leads togxWiΔt-2Δt=g(x(WiΔt))-2Δtg′(x(WiΔt))x′(WiΔt)+c2+(WiΔt)Δtwhere the random variablec2+(WiΔt)is defined using the new random variableθ2+(WiΔt)with the condition0⩽θ2+(WiΔt)⩽1and is given byc2+(WiΔt)=2g″xWiΔt-2θ2+(WiΔt)Δtx′WiΔt-2θ2+(WiΔt)Δt2+2g′xWiΔt-2θ2+(WiΔt)Δtx″WiΔt-2θ2+(WiΔt)Δt.This formula yields the resultDkΔtg(X)=g′(x(WiΔt))x′(WiΔt)-c2+(WiΔt)Δt=g′(x(WiΔt))DkΔtx(WiΔt)-c2+(WiΔt)Δt.Case 3. The two conditionsk⩽iand∊k=-Δtare satisfied: Proper choice of the random variablec2-(WiΔt)yields the resultDkΔtg(X)=g′(x(WiΔt))DkΔtx(WiΔt)+c2-(WiΔt)Δt.These three cases are combined to obtain the following result:DkΔtg(X)=g′(X)DkΔtX+c2(ei)Δt1k⩽i,where c2(ei) is given byc2(ei)=-c2+(WiΔt)if∊k=Δtc2-(WiΔt)if∊k=-Δt.An operator DiΔt,jΔtis termed the second discrete Malliavin derivative. It is an operator from the random variable F=f(eN)∈L2(Ω,Q) to the generalized stochastic processDiΔt,jΔtF=∑k,l=1,k≠lNfeN,k,l++-feN,k,l+--feN,k,l-++feN,k,l--4Δt1i,j(k,l)=feN,i,j++-feN,i,j+--feN,i,j-++feN,i,j--4Δt,whereen,k,l±±is given byen,k,l±±=∊1,…,∊k-1,±Δt,∊k+1,…,∊l-1,±Δt,∊l+1,…,∊n.We present several examples on the second discrete Malliavin derivative.Example 2.5A stochastic processWiΔtk,l,±±i=1,…,Nis a Bernoulli random walk with a deterministic epoch at kΔt and lΔt. In other words, the random variables ∊kand ∊lare deterministic andWiΔtk,l,±±is defined byWiΔtk,l,±±=∊1+⋯+∊k-1±Δt+∊k+1+⋯+∊l-1±Δt+∊l+1+∊i.if k, l⩽i. The random variableWiΔtk,l,±±is also defined byWiΔtk,l,±±=WiΔt,WiΔtk,l,±±=WiΔtk±,andWiΔtk,l,±±=WiΔtl±,under the conditions k, l>i, k⩽i<l, and l⩽i<k, respectively. Let us regard the random walk at time iΔt as a random variable. When the discrete Malliavin derivative is applied to WiΔt, the expressionDkΔt,lΔtWiΔt=WiΔtk,l,++-WiΔtk,l,+--WiΔtk,l,-++WiΔtk,l,--4Δt=0is satisfied.Let f(·) be a differentiable function. Applying the discrete Malliavin derivative to a random variable f(WiΔt) leads to(2.5)DkΔt,lΔtf(WiΔt)=fWiΔtk,l,++-fWiΔtk,l,+--fWiΔtk,l,-++fWiΔtk,l,--4Δt.We consider three cases for further calculation of formula (2.5).•Case 1.k>iorl>i: The formula Dk Δt, lΔtf(WiΔt)=0 is clearly satisfied.Case 2.k, l⩽iand∊k=∊l=Δt: Formula (2.5) is calculated as(2.6)DkΔt,lΔtf(WiΔt)=f(WiΔt)-2fWiΔt-2Δt+fWiΔt-4Δt4Δt.Using the Taylor expansion formula leads tofWiΔt-2Δt=f(WiΔt)-2Δtf′(WiΔt)+2Δtf″(WiΔt)-43f‴WiΔt-2θ31++(WiΔt)Δt(Δt)3/2fWiΔt-4Δt=f(WiΔt)-4Δtf′(WiΔt)+8Δtf″(WiΔt)-323f‴WiΔt-4θ32++(WiΔt)Δt(Δt)3/2,where the random variablesθ31++andθ32++satisfy the relation0⩽θ31++(WiΔt),θ32++(WiΔt)⩽1. This result is substituted into the formula (2.6) which leads toDkΔt,lΔtf(WiΔt)=f″(WiΔt)+c3++(WiΔt)Δt,where the new random variable c3(WiΔt) is given byc3++(ei)=23f‴WiΔt-2θ31++(WiΔt)Δt-83f‴WiΔt-4θ32++(WiΔt)Δt.Case 3. Otherwise:One can calculate this case in the same way as Case 2.The random variable c3(eN) must be chosen such thatDkΔt,lΔtf(WiΔt)=f″(WiΔt)+c3(ei)Δt1k,l⩽i,is satisfied.Let functions g(·) and x(·) be differentiable and X=x(WiΔt)∈L2(Ω,Q). Applying the discrete Malliavin derivative for g(X) leads to the formula,(2.7)DkΔt,lΔtg(X)=gxWiΔtk,l,++-2gxWiΔtk,l,+-+gxWiΔtk,l,--4Δt.We consider three cases for further calculation of the formula (2.7),•Case 1. k>iorl>i: The formula Dk Δt, lΔtg(X)=0 is satisfied.Case 2. The conditionsk, l⩽i, (k≠l) and∊k=∊l=Δt: Formula (2.7) is further calculated asDkΔt,lΔtg(X)=g(x(WiΔt))-2gxWiΔt-2Δt+gxWiΔt-4Δt4Δt.The Taylor expansion formula yieldsgxWiΔt-2Δt=g(x(WiΔt))-2g′(x(WiΔt))x′(WiΔt)Δt+2Δtg″(x(WiΔt))x′(WiΔt)2+g′(x(WiΔt))x″(WiΔt)+c4,1++(WiΔt)(Δt)3/2,gxWiΔt-4Δt=g(x(WiΔt))-4g′(x(WiΔt))x′(WiΔt)Δt+8Δtg″(x(WiΔt))x′(WiΔt)2+g′(x(WiΔt))x″(WiΔt)+c4,2++(WiΔt)(Δt)3/2,where the new random variablesc4,i++(WiΔt)(i=1,2)are defined byc4,1++(WiΔt)=-43g‴α1++x′α1++3+3g″α1++x′α1++x″α1+++g′α1++x‴α1++c4,2++(WiΔt)=-323g‴α2++x′α2++3+3g″α2++x′α2++x″α2+++g′α2++x‴α2++.Random variablesα1++(WiΔt)andα2++(WiΔt)are defined byα1++(WiΔt)=WiΔt-2θ4,1++(WiΔt)Δt,α2++(WiΔt)=WiΔt-4θ4,2++(WiΔt)Δt,whereθ4,i++(WiΔt)are random variables that satisfy the condition0⩽θ4,i++(WiΔt)⩽1. We finally obtain the formulaDkΔt,lΔtg(X)=g″(x(WiΔt)){x′(WiΔt)}2+g′(x(WiΔt))x″(WiΔt)+c4++(eN)Δt=g″(X)DkΔtXDlΔtX+g′(X)DkΔt,lΔtX+c4++(WiΔt)Δt.Case 3. Otherwise: One can calculate this case in the same way as Case 2.If one chooses the random variable c4(eN) properly, the following is obtained as the final result:DkΔt,lΔtg(X)=g″(X)DkΔtXDlΔtX+g′(X)DkΔt,lΔtX+c4(eN)Δt1k,l⩽i.Next, we introduce the discrete Skorohod integral. The discrete Skorohod integral is usually defined using the discrete Wick product or the discrete Wiener Chaos expansions. However, we define the discrete Skorohod integral in a different way to maintain an elementary discussion.Definition 2.3The Skorohod integral is an operator from a stochastic process {FiΔt}i=1,…,Ninto a random variable δ (F·Δt). If the stochastic process {FiΔt}i=1,…,Nis represented by (2.1), the Skorohod integral for this stochastic process is given byδ(F·Δt)=∑j=1N{fj(eN)∊j-DjΔtfj(eN)Δt}.A stochastic process {FiΔt}i=1,…,Nat time jΔt is represented by a random variable fj(eN). If this random variable fj(eN) isF(j-1)Δtmeasurable, i.e., if fj(eN) is represented by fj(ej−1), then the relation DjΔtfj(ej−1)=0 is satisfied. Hence, the discrete Skorohod integral is represented byδ(F·Δt)=∑j=1Nfj(ej-1)∊j.This is called the discrete Ito integral.Next, we briefly discuss the other definitions of the discrete Skorohod integrals. Leitz-Martini (2000) and Privault (2008, 2009) defined the discrete Skorohod integrals using the discrete Wick product and the Wiener Chaos expansions, respectively. These definitions are equivalent to Definition 2.1 of this paper. A new symbolPnis defined byPn={A⊂Λ:#A=n},P=∑n=0NPnwhere Λ={1,…,N}. A characteristic function χAexpressed on the set A⊂Λ is defined asχA=∏i∈A∊iΔt.As discussed in Proposition 4 in Leitz-Martini (2000), the characteristic function {χA}A⊂Λis an orthonormal basis of the discrete Wiener space L2(Ω,Q), and L2(Ω,Q) is a 2N-dimensional linear space. Any random variable X∈L2(Ω,Q) is represented byX=∑A⊂ΛX(A)χA=∑i=0N∑A∈PiX(A)χAwhere {X(A)}A⊂Λ is a set of 2Nscalars. This is termed as the discrete Walsh decomposition. Next, the discrete Wiener Chaos decomposition is introduced. LetX=∑A⊂ΛX(A)χAbe a Walsh decomposition of the random variable X. The random variable X is further calculated asX=∑n∑{m1,…,mn}∈PnX({m1,…,mn})χ({m1,…,mn})=∑n∑{m1,…,mn}∈Pn,m1<…<mn(Δt)n/2n!Xn(m1,…,mn)χ({m1,…,mn})=∑n∑{m1,…,mn}∈PnXn(m1,…,mn)∊m1⋯∊mn,where Xn(m1,…,mn) is expressed asXn(m1,…,mn)=(Δtn/2n!)-1X({m1,…,mn})(mi≠mjifi≠j)0(otherwise)This is called the discrete Wiener Chaos decomposition.Let X and Y be two random variables represented with the Walsh decomposition:X=∑A⊂ΛX(A)χA,Y=∑B⊂ΛY(B)χB.The discrete Wick product between these two random variables X◊Y is expressed asX◊Y=∑C⊂Λ∑A△B=C(X(A)Y(B))χC,where A△B is a symmetric difference between two sets A and B and is given by A△B=(A⧹B)∪(B⧹A). Leitz-Martini (2000) defined the discrete Skorohod integrals using the discrete Wick product. The discrete Skorohod integral for the stochastic process (2.1) is defined as(2.8)δ(F·Δt)=∑j=1Nfj(eN)◊∊j.This is equivalent to our definition because, according to Proposition 5.5 in Leitz-Martini (2000)DiΔtX=X·∊iΔt-X◊∊iΔt,and the right hand side of (2.8) can be expressed as∑j=1Nfj(eN)◊∊j=∑j=1N(fj(eN)·∊j-DjΔtfj(eN)Δt).This is identical to our definition. The discrete Skorohod integral can also be defined using the discrete Wiener Chaos expansions. Let us introduce the discrete Wiener Chaos expansion for the random variable fj(eN) that appears in the definition of the stochastic process (2.1):fj(eN)=∑n∑{m1,…,mn}∈PnXn(m1,…,mn;j)∊m1⋯∊mn.Hence, the Skorohod integral for the stochastic process (2.1) is expressed asδ(F·Δt)=∑n∑(m1,…,mn+1)∈Λn+1X^n+1(m1,…,mn+1)∊m1⋯∊mn+1,where a new variableX^nis a symmetrization of Xnand it is given byX^n=0(ifti=tjforsomei≠j)1n+1∑k=1n+1Xn(t1,…,tk-1,tn+1,tk+1,…,tn;tk)(otherwise).This is the definition of the discrete Skorohod integral in Privault (2008, 2009) and this definition is also equivalent to our definition. The discrete Malliavin derivative for the random variable X represented using the discrete Wiener Chaos expansion,X=∑n∑{m1,…,mn}⊂ΛnXn(m1,…,mn)∊m1⋯∊mnis expressed asDiΔtX=∑n∑{m1,…,mn-1}⊂Λn-1nXn(m1,…,mn-1,i)∊m1⋯∊mn-1.This formula is also presented in Leitz-Martini (2000).Definition 2.4The second discrete Skorohod integral is a mapping from a generalized stochastic process{FiΔt,jΔt}i≠ji,j=1,…,Ninto a random variable δ2(F). If the generalized stochastic process{FiΔt,jΔt}i≠ji,j=1,…,Nis defined by the formula (2.2), the second discrete Skorohod integral corresponding to this generalized stochastic process is given byδ2(F·Δt,·Δt)=∑i,j=1,i≠jN{fi,j(eN)∊i∊j-DiΔtfi,j(eN)∊jΔt-DjΔtfi,j(eN)∊iΔt+DiΔt,jΔtfi,j(eN)Δt2}.We discuss the relationship between the discrete Malliavin derivatives and the discrete Skorohod integrals. The first theorem is the discrete version of the duality formula in the Malliavin calculus.Theorem 2.1Assume that there is a random variable F=f(eN) and a stochastic process{UiΔt=∑j=1Nuj(eN)1i(j)}i=1,…,N. Then, the relation,(2.9)E∑i=1N(DiΔtF)ui(eN)Δt=E[Fδ(U·Δt)]must be satisfied.The left hand side of (2.9) is computed as(2.10)E∑i=1N(DiΔtF)ui(eN)Δt=∑i=1NEf(eNi+)-f(eNi-)2Δtui(eN)Δt.A new σ-algebraFiΔtkΔt(i>k)is defined byFiΔtkΔt=σ{∊1,…,∊k-1,∊k+1,…,∊i}. The expectation appearing on the right hand side of the equality (2.10) is further calculated as(2.11)Ef(eNi+)-f(eNi-)2Δtui(eN)=Ef(eNi+)-f(eNi-)2ΔtE[ui(eN)|FNΔtiΔt]=Ef(eNi+)-f(eNi-)2Δt12(ui(eNi+)+ui(eNi-))=Ef(eNi+)ui(eNi+)2Δt+f(eNi-)ui(eNi-)-2Δt-f(eNi+)+f(eNi-)2ui(eNi+)-ui(eNi-)2Δt=EEf(eN)ui(eN)∊iFNΔtiΔt-E[f(eN)|FNΔtiΔt]ui(eNi+)-ui(eNi-)2Δt=Ef(eN)ui(eN)∊i-f(eN)ui(eNi+)-ui(eNi-)2ΔtBy Substituting (2.11) in (2.10), we obtainE∑i=1N(DiΔtF)ui(eN)Δt=∑i=1NEf(eN)ui(eN)∊i-f(eN)ui(eNi+)-ui(eNi-)2ΔtΔt=Ef(eN)∑i=1N{ui(eN)∊i-DiΔtui(eN)Δt}=E[Fδ(U·Δt)].The next theorem shows the relation between the derivative (in the usual sense) and the discrete Malliavin derivative. Theorem 2.1 is extended to the generalized stochastic processes.□Assume that there is a random variable F=f(eN) and a stochastic processUiΔt,jΔt=∑k,l=1,i≠jNui,j(eN)1i,j(k,l)i=1,…,N. Then, the relation,(2.12)E∑i,j=1,i≠jN(DiΔt,jΔtF)ui,j(eN)(Δt)2=E[Fδ2(U·Δt,·Δt)]must be satisfied.We only give a brief proof here, because the complete proof is very lengthy. The left hand side of the formula (2.12) is given by(2.13)(LHS)=∑i,j=1,i≠jNEfeN,i,j++-feN,i,j+--feN,i,j-++feN,i,j--ui,j(eN)4Δt(Δt)2.We introduce a σ-algebraFNΔtijasFNΔtij=σ{∊1,…,∊i-1,∊i+1,…,∊j-1,∊j+1,…,∊N}. The expectation in the formula (2.13) is denoted by I, i.e.I=E14ΔtfeN,i,j++-feN,i,j+--feN,i,j-++feN,i,j--ui,j(eN). This expectation is further calculated asI=EfeN,i,j++-feN,i,j+--feN,i,j-++feN,i,j--4ΔtE[ui,j(eN)|FNΔtij]=EfeN,i,j++-feN,i,j+--feN,i,j-++feN,i,j--4Δt×ueN,i,j+++ueN,i,j+-+ueN,i,j-++ueN,i,j--4=⋯=EEf(eN)uij(eN)∊i∊jFNΔtij-14feN,i,j++uijeN,i,j++-uijeN,i,j+-2Δt+uijeN,i,j++-uijeN,i,j-+2Δt+feN,i,j+-uijeN,i,j++-uijeN,i,j+-2Δt-uijeN,i,j+--uijeN,i,j--2Δt+feN,i,j-+uijeN,i,j++-uijeN,i,j-+2Δt-uijeN,i,j-+-uijeN,i,j--2Δt+feN,i,j--uijeN,i,j+--uijeN,i,j--2Δt-uijeN,i,j-+-uijeN,i,j--2Δt+Ef(eN)|FNΔti,juijeN,i,j++-uijeN,i,j+--uijeN,i,j-++uijeN,i,j--4Δt=⋯=Ef(eN)uij(eN)∊i∊j+f(eN)DiΔt,jΔtuij(eN)-f(eN)∊iDjΔtuij(eN)-f(eN)∊jDiΔtuij(eN).On the other hand, the right hand side of the formula (2.12) is given by(RHS)=∑i,j=1,i≠jNE[f(eN)(ui,j(eN)∊i∊j-DiΔtui,j(eN)∊jΔt-DjΔtui,j(eN)∊iΔt+DiΔt,jΔtui,j(eN)(Δt)2)]=∑i,j=1,i≠jNEf(eN)uij(eN)∊i∊j+f(eN)DiΔt,jΔtuij(eN)-f(eN)∊iDjΔtuij(eN)-f(eN)∊jDiΔtuij(eN)(Δt)2.Hence, the formula (2.12) is verified.□Consider two random variables X=x(WNΔt) and Y=y(eN), where x(·) is a continuous function. For any stochastic processHiΔt=∑j=1Nhj(eN)1i(j), if a function g is differentiable, the following resultE[g′(X)Y]≈Eg(X)δYH·Δt∑j=1Nhj(eN)DjΔtXΔtmust be satisfied.The discussion in Example 2.4 leads to the relationDiΔtg(X)=g′(X)DiΔtX+c5(eN)Δt, and this equality leads the following identity:Yhi(eN)DiΔtg(X)=Yhi(eN)g′(X)DiΔtX+c5(eN)Δt.Summation from i=1 to N yields∑i=1NYhi(eN)DiΔtg(X)Δt=Yg′(X)∑i=1Nhi(eN)DiΔtXΔt+c6(eN)Δt,where a new random variable c6(eN) is given byc6(eN)=Yc5(eN)∑i=1Nhi(eN)Δt.This leads to the relationg′(X)Y=∑i=1NYhi(eN)DiΔtg(X)Δt-c6(eN)Δt∑j=1Nhj(eN)DjΔtXΔt=∑i=1Nui(eN)DiΔtg(X)Δt+c7(eN)Δt.A stochastic processUiΔt=∑j=1Nuj(eN)1i(j)i=1,…,Nand a random variable c7(eN) are given byui(eN)=Yhi(eN)∑j=1Nhj(eN)DjΔtXΔtandc7(eN)=-c6(eN)∑j=1Nhj(eN)DjΔtXΔt.Theorem 2.1 leads toE[g′(X)Y]=E∑i=1Nui(eN)DiΔtg(X)Δt+E[c7(eN)]Δt=E[g(X)δ(U·Δt)]+E[c7(e)]Δt≈E[g(X)δ(U·Δt)].This proves the results.□Consider two random variables X=x(WNΔt) and Y=y(eN), where x(·) is a continuous function. For any extended stochastic processHiΔt,jΔt=∑k,l=1,k≠lNhk,l(eN)1(k,l)(i,j)and stochastic processKiΔt=∑j=1Nkj(eN)1j(i)if a function g is differentiable, the following result must be satisfied:E[g″(X)Y]≈E[g(X)δ2(U·Δt,·Δt)]-E[g(X)δ(V·Δt)],where the generalized stochastic processUiΔt,jΔt=∑k,l=1,k≠lNuk,l(eN)1k,l(i,j)and stochastic processViΔt=∑j=1Nvj(eN)1j(i)i=1,…,Nare defined byuh,k(eN)=Yhh,k(eN)∑l,m=1,l≠mNhl,m(eN)(DlΔtX)(DmΔtX)(Δt)2andvj(eN)=ZkjΔt∑l=1Nkl(eN)DlΔtXΔt,respectively. The random variable Z is also defined byZ=∑i,j=1,i≠jNYhi,j(eN)DiΔt,jΔtX(Δt)2∑l,m=1,l≠mNhl,m(eN)DlΔtXDmΔtX(Δt)2.Example 2.7 is applied to the random variable g(X):DiΔt,jΔtg(X)=g″(X)(DiΔtX)(DjΔtX)+g′(X)DiΔt,jΔtX+c8(e)Δt.This formula leads toYhi,j(eN)DiΔt,jΔtg(X)=Yhi,j(eN)g″(X)(DiΔtX)(DjΔtX)+g′(X)DiΔt,jΔtX+c8(e)Δt.By taking summation, this formula is further calculated asg″(X)Y∑i,j=1,i≠jNhi,j(eN)(DiΔtX)(DjΔtX)(Δt)2=∑i,j=1,i≠jN{Yhi,j(eN)DiΔt,jΔtg(X)-g′(X)Yhi,j(eN)DiΔt,jΔtX}(Δt)2+c9(eN)Δtand we get the equation,g″(X)Y=∑i,j=1,i≠jN{Yhi,j(eN)DiΔt,jΔtg(X)}∑i,j=1,i≠jNhi,j(eN)(DiΔtX)(DjΔtX)(Δt)2(Δt)2-g′(X)∑i,j=1,i≠jN{Yhi,j(eN)DiΔt,jΔtX}∑i,j=1,i≠jNhi,j(eN)(DiΔtX)(DjΔtX)(Δt)2(Δt)2+c10(eN)Δt=∑i,j=1,i≠jNui,j(eN)DiΔt,jΔtg(X)(Δt)2-g′(X)Z+c10(eN)Δt.Using Theorem 2.1, the expectation E[g″(X)Y] is given byE[g″(X)Y]=E∑i,j=1,i≠jNui,j(eN)DiΔt,jΔtg(X)(Δt)2-E[g′(X)Z]+E[c10(e)]Δt≈E[g(X)δ2(U·Δt,·Δt)]-E[g(X)δ(V·Δt)],whereViΔt=∑j=1Nvj(eN)1j=iis a stochastic process withvj(eN)=Zkj(eN)∑l=1Nkl(eN)DlΔtXΔt.Note that we can consider any stochastic processKiΔt=∑j=1Nkj(eN)1j=ito define the above equation.□Let us assume that there is a random variable F=f(eN) and a stochastic processUiΔt=∑j=1Nuj(eN(p))1i(j)i=1,…,N. Then, the relation,(2.14)δ(FU·Δt)=Fδ(U·Δt)-∑i=1N(DiΔtF)ui(eN)Δt+∑i=1N(f(eNi+)-f(eNi-))(ui(eNi+)-ui(eNi-))2∊imust be satisfied.The left hand side in (2.14) yields(2.15)δ(FU·Δt)=∑i=1NFui(eN)∊i-f(eNi+)ui(eNi+)-f(eNi-)ui(eNi-)2ΔtΔt.We consider two cases,∊k=Δtand∊k=-Δt. If the former case is assumed, each term on the right hand side of (2.15) is further calculated asFuk(eN)∊k-f(eNk+)uk(eNk+)-f(eNk-)uk(eNk-)2ΔtΔt=f(eNk+)uk(eNk+)+(eNk-)uk(eNk-)2∊k.Even if the latter case is assumed, we obtain the same result. Therefore,(2.16)δ(FU·Δt)=∑i=1Nf(eNi+)ui(eNi+)+f(eNi-)ui(eNi-)2∊i.The right hand side of (2.14) is calculated as(2.17)(RHS)=∑i=1NFui(eN)∊i-ui(eNi+)-ui(eNi-)2ΔtΔt-f(eNi+)-f(eNi-)2Δtui(eN)Δt+(f(eNi+)-f(eNi-))(ui(eNi+)-ui(eNi-))2∊i.If∊k=Δtis satisfied, the k-th term in the summation in (2.17) is further calculated asFuk(eN)∊k-uk(eNk+)-uk(eNk-)2ΔtΔt-f(eNk+)-f(eNk-)2Δtuk(eN)Δt+(f(eNk+)-f(eNk-))(uk(eNk+)-uk(eNk-))2∊k=f(eNk+)ukeNk+Δt-uk(eNk+)-uk(eNk-)2Δt-f(eNk+)-f(eNk-)2uk(eNk+)Δt+(f(eNk+)-f(eNk-))(uk(eNk+)-uk(eNk-))2Δt=f(eNk+)uk(eNk+)+f(eNk-)uk(eNk-)2∊k.On the other hand, if∊k=-Δtis satisfied, the same result is obtained. These arguments indicate that (2.17) is equal to(RHS)=∑i=1Nf(eNi+)ui(eNi+)+f(eNi-)ui(eNi-)2∊i.This quantity is identical to (2.16). Hence, the theorem is proved.□In the first half of this section, we briefly explain the binomial tree model of Cox et al. (1979). Binomial tree is one of the most popular way to derive the price of options. (See Fig. 1. for the picture of a binomial tree.) In the last half of this section, we derive discrete Malliavin greeks in the binomial tree model. The binomial tree is a computational method for pricing options on securities whose price process is governed by the geometric Brownian motion,(3.18)dPt=Pt(rdt+σdZt),P0=s,where {Zt} is a standard Brownian motion under the risk-neutral measure Q. Let us consider European options with a maturity date T=NΔt and a pay-off function Φ(·) and we construct the binomial tree model with N periods. If the price of underlying assets at time iΔt (i=0,1,…,N−1) is given by SiΔt, the price moves to u SiΔtor d SiΔtat the next time period (i+1)Δt, where constants d and u satisfy the relation d<1<u. The price of underlying assets becomes u Siwith probability p and d Siwith probability 1−p. The binomial tree is an approximation of the geometric Brownian motion (3.18), and the constants u, d, and p are fixed as they are consistent with the original model under the constraint u=1/d. If higher order terms than Δt are neglected, the above mentioned constants are expressed as(3.19)u=eσΔt,d=e-σΔt,p=erΔt-du-d.Let us assume that the price of underlying assets moves upward j times and downward n−j times until time nΔt. The price of underlying assets is expressed as SnΔt=s ujdn−j, if the initial price is given by s. It can be regarded as a stochastic process, represented bySiΔt=∑j=1Nsexp(σWjΔt(p))1i(j)(i=1,…,N),where the constant p is given by (3.19). The (discrete time) stochastic processW·Δt(p)is a discrete approximation of the Brownian motion with a drift1σr-σ22and an approximation formulaWNΔt(p)≈1σr-σ22T+ZTis satisfied. The price of options at time iΔt is denoted by C(x,iΔt) if the price of underlying assets is x at time iΔt. If the pay-off function for European options at the maturity date T is given by Φ(x), the price of this option is given by the backward induction algorithmC(x,iΔt)=e-rΔt(pC(xu,(i+1)Δt)+(1-p)C(xd,(i+1)Δt)),C(x,NΔt)=Φ(x).This means that the initial price of options is given by(3.20)C=E[e-rTΦ(SNΔt)]=e-rNΔt∑j=0NNCjpj(1-p)N-jΦ(sujdN-j).Although the pricing formula (3.20) is represented by the asymmetric Bernoulli random variables∊i(p)i=1,…N, the discrete Girsanov theorem presented in Fujita (2008) enables us to represent it by the symmetric Bernoulli random variables {∊iΔt}i=1,…N. Consider a function f(x1,…,xn). The expectation formula forEf∊1(p),…,∊N(p)is calculated as(3.21)Ef∊1(p),…,∊N(p)=∑xi∈{-Δt,Δt}f(x1,…,xN)pΔt+x12Δt(1-p)Δt-x12Δt⋯pΔt+xN2Δt(1-p)Δt-xN2Δt=∑xi∈{-Δt,Δt}f(x1,…,xN)12Np1-p∑i=1Nxi2Δt(4p(1-p))N2=Ep1-pWNΔt2Δt(4p(1-p))N2f(∊1,…,∊N).The equality (3.21) enables us to represent the pricing formula for European options with the symmetric Bernoulli random variables as(3.22)C=Ee-rTΦseσWNΔt(p)=Ee-rTp1-pWNΔt2Δt(4p(1-p))N2ΦseσWNΔt.The hedging strategy for options in the binomial tree model is derived using discrete Clark–Ocone formulas in Privault (2008, 2009). However, the purpose of this paper is to derive greeks such as delta. Although a number of units invested at time t in underlying assets coincide with delta for the hedging of European options in the Black and Scholes model, this coincidence is not valid in the binomial tree model.In this subsection, we calculate Delta, which is used to measure the sensitivity of the option price with respect to changes in the price of underlying assets. As a first step, the pay-off function Φ(·) is assumed to be smooth. Delta is given by the first derivative of the option value function with respect to the price of underlying assets:Δ=∂C∂s=∂∂sEe-rTp1-pWNΔt2Δt(4p(1-p))N2ΦseσWNΔt=e-rT(4p(1-p))N2Ep1-pWNΔt2ΔtΦ′seσWNΔteσWNΔt=e-rT(4p(1-p))N2EΦ′seσWNΔte{log(p1-p)12Δt+σ}WNΔt.Theorem 2.3 with H=1 and Example 2.3 lead to(3.23)Δ≈e-rT(4p(1-p))N2EΦseσWNΔtδexplogp1-p12Δt+σWNΔt∑i=1NDiΔtseσWNΔtΔt≈e-rT(4p(1-p))N2EΦseσWNΔt1sσTδexplogp1-p12Δt+σWNΔteσWNΔt=e-rT(4p(1-p))N2sσTEΦseσWNΔtδeμWNΔt,where μ is given byμ=logp1-p12Δt. The discrete Skorohod integral in (3.23) is calculated asδeμWNΔt=eμWNΔtδ(1)-∑k=1NDkΔteμWNΔt1{N⩾k}Δt≈elog(p1-p)12ΔtWNΔt(WNΔt-μT)by the definition of the Skorohod integrals. This formula results in the further calculation of (3.23) as(3.24)Δ≈e-rT(4p(1-p))N2sσTEΦ(seσWNΔt)eWNΔtlogp1-p12Δt(WNΔt-μT)=e-rTsσTE(p1-p)WNΔt2Δt(4p(1-p))N2Φ(seσWNΔt)(WNΔt-μT)=e-rTsσTE[Φ(seσWNΔt(p))(WNΔt(p)-μT)].Approximation formula for μ with the Taylor expansion yields a more simple formula for delta as follows,μ=12Δtlogp1-p=12ΔtlogerΔt-e-σΔteσΔt-erΔt≈12ΔtlogσΔt+r-σ22ΔtσΔt-r-σ22Δt=12Δtlog1+2r-σ22ΔtσΔt-r-σ22Δt≈12Δt2r-σ22ΔtσΔt-r-σ22Δt=r-σ22σ-r-σ22Δt≈1σr-σ22.This formula is substituted in (3.24):(3.25)Δ=e-rTsσTEΦseσWT(p)WT(p)-1σr-σ22T+OΔt.The discrete Malliavin delta is defined by(3.26)ΔDM=e-rTsσTEΦseσWT(p)WT(p)-1σr-σ22T.Note that the approximation (3.25) is not valid, if the pay-off function Φ(·) is not smooth. Remember that Δ is delta for options in the binomial tree model and it is not identical to delta in the Black and Scholes model, ΔBS. However, it still is an approximation formula for the continuous time delta, even if Φ(·) is not smooth. Under certain assumptions in pay-off functions, Corollary 4.2 in Walsh (2003) shows that the price of options in the binomial tree model converges to the price of options in the Black and Scholes model1Kis the class of real valued functions on R which satisfy (i) ϕ(·) is piecewise C(2), (ii) at each x, the function ϕ(·) satisfiesϕ(x)=12(ϕ(x+)+ϕ(x-)), (iii) ϕ, ϕ′ and ϕ″ are polynomial bounded. We assume that f(·) is a function in the classK. ThenE[e-rTf(ST)]=Ee-rTfseσWNΔt→Ee-rTfse(r-σ22)T+σZT=E[e-rTf(PT)](N→∞)is satisfied. See Walsh (2003).1. This result shows that(3.27)ΔDM=e-rTsσTEΦseσWT(p)WT(p)-μT=e-rTsσTEΦ(ST)log(ST/s)-μσTσ=e-rTsσTEΦ(PT)log(PT/s)-μσTσ+O1N=e-rTsσTE[Φ(PT)ZT]+O1N,where Ptis a solution to the SDE (3.18).2The order of error term isO1N, if the discontinuity for the pay-off function Φ(·) is on a lattice point. However, if all discontinuities are on lattice points, the order of the error term isO1N. See Corollary 4.2 in Walsh (2003) for details.2On the other hand, the first term on the right hand side in the formula (3.27),e-rTsσTE[Φ(PT)ZT], is a (continuous-time) Malliavin delta. We get the final resultΔDM=ΔBS(s,0)+O1N.We introduce the following new symbols(3.28)πΔ=wsσT,w=1σjlogud+Nlog(d)-μ̃,andμ̃=r-σ22.The discrete Malliavin delta (3.26) is represented byΔDM=e-rT∑j=0NNCjpj(1-p)N-jΦ(sujdN-j)πΔ.This result is identical to the one derived by Rozario (2004).In this subsection, we calculate Gamma, which is used to measure the sensitivity in the delta with respect to changes in the underlying asset price. In other words, it is given by the second derivative of the option value function with respect to the underlying asset price. In order to compute gamma in the discrete time model, one has to use the discrete Malliavin calculus on the generalized stochastic processes. Gamma is given by taking second derivative of the option pricing formula (3.22), as follows:Γ=∂2C∂s2=e-rT(4p(1-p))N/2EΦ″seσWNΔte2σWNΔtp1-pWNΔt2Δt≈e-rT(4p(1-p))N/2EΦ(seσWNΔt)δ2e(μ+2σ)WNΔt∑i,j=1,i≠jNDiΔtseσWNΔtDjΔtseσWNΔt(Δt)2-EΦ(seσWNΔt)δZ∑i=1NDiΔtseσWNΔtΔt,where a random variable Z is given byZ=e(μ+2σ)WNΔt∑i,j=1,i≠jNDiΔt,jΔtseσWNΔt(Δt)2∑l,m=1,l≠mNDlΔtseσWNΔtDmΔtseσWNΔt(Δt)2≈e(μ+2σ)WNΔt×sσ2eσWNΔtN(N-1)(Δt)2sσeσWNΔtsσeσWNΔtN(N-1)(Δt)2=e(μ+σ)WNΔts.Calculation of Malliavin derivative leads to the further calculation of gamma:(3.29)Γ≈e-rT(4p(1-p))N/2EΦseσWNΔt1s2σ2N(N-1)(Δt)2δ2eμWNΔt-1sEΦseσWNΔtδe(μ+σ)WNΔtsσeσWNΔtT.The Skorohod integrals that appear in the first and second terms in the formula (3.29) are given byδ2(eμWNΔt)≈∑i,j=1,i≠jNeμWNΔt∊i∊j-μeμWNΔtΔt∊i-μeμWNΔtΔt∊j+μ2eμWNΔt(Δt)2=eμWTWT2-T-2μN-1NWNΔtT+μ2N-1NT2≈eμWT{(WT-μT)2-T}andδe(μ+σ)WNΔtsσeσWNΔtT=1sσTδ(eμWNΔt)≈1sσT(eμWNΔtWNΔt-μeμWNΔtT)=eμWTsσT(WT-μT),respectively. These calculations of Skorohod integrals enable us to further compute the formula (3.29):Γ≈e-rTs2σTEp1-pWNΔt2Δt(4p(1-p))N2Φ(seσWNΔt)(WNΔt-μT)2σT-(WNΔt-μT)-1σ=e-rTs2σTEΦ(seσWNΔt(p))(WNΔt(p)-μT)2σT-(WNΔt(p)-μT)-1σ.We obtain an approximation formula for gammaΓ=e-rTs2σTEΦseσWT(p)(WT(p)-μT)2σT-WT(p)-μT-1σ+OΔt.This formula is valid only if the pay-off function Φ(·) is a smooth one. We define the discrete Malliavin gamma as(3.30)ΓDM=e-rTs2σTEΦseσWT(p)(WT(p)-μT)2σT-WT(p)-μT-1σ.As in the case of delta, the discrete Malliavin gamma is also an approximation of the gamma in the continuous time model, even if the pay-off function Φ(·) is not smooth:ΓDM=ΓBS(s,0)+O1N.Let us reiterate that the stochastic processW·Δt(p)is an approximation of Brownian motion with drift1σr-σ22. The discrete Malliavin gamma (3.30) is an approximation of the continuous Malliavin gamma. It is also represented byΓDM=e-rT∑j=0NNCjpj(1-p)N-jΦ(sujdN-j)πΓ,where πΓis the Malliavin weight,πΓ=w2σT-w-1σ1s2σT, and w is given by (3.28). This formula is identical to the one derived by Rozario (2004).Vega measures the sensitivity of the option price with respect to changes in the volatility level σ. It is obtained using the first derivative of the option value function with respect to the volatility level:V=∂C∂σ=V1+V2whereV1andV2are given byV1=e-rTE(p1-p)WNΔt2Δt(4p(1-p))N2∂∂σΦ(seσWNΔt)V2=e-rTE∂∂σp1-pWNΔt2Δt(4p(1-p))N2Φ(seσWNΔt).V1is further calculated as(3.31)V1=e-rT(4p(1-p))N2Ep1-pWNΔt2ΔtΦ′(seσWNΔt)seσWNΔtWNΔt≈e-rT(4p(1-p))N2σTEΦ(seσWNΔt)δp1-pWNΔt2ΔtWNΔt.The Skorohod integral in (3.31) is expressed as(3.32)δp1-pWNΔt2ΔtWNΔt≈p1-pWNΔt2Δtδ(WNΔt)-∑i=1Nlogp1-p12Δtp1-pWNΔt2ΔtWNΔtΔt+2∑i=1N2Δtf′(WNΔt)2Δt∊iΔtby using Theorem 2.5. It should be noted that third term in (3.32) is2∑i=1N2Δtf′(WNΔt)2Δt∊iΔt=2f′(WNΔt)WNΔtΔt≈0.This permits further calculation of (3.32) as follows,δp1-pWNΔt2ΔtWNΔt≈p1-pWNΔt2Δtδ(WNΔt)-μp1-pWNΔt2ΔtWNΔtT=p1-pWNΔt2Δt(WNΔt2-μWNΔtT-T)By substituting this formula into (3.31),V1is expressed as(3.33)V1≈e-rTEΦ(seσWNΔt)p1-pWNΔt2Δt{4p(1-p)}N2σT(WNΔt2-μWNΔtT-T).V2is computed as follows:(3.34)V2=e-rTE4N2WNΔt2Δt+N2pWNΔt2Δt+N2-1∂∂σp(1-p)-WNΔt2Δt+N2Φ(seσWNΔt)+4N2-WNΔt2Δt+N2(1-p)-WNΔt2Δt+N2-1∂∂σ(1-p)pWNΔt2Δt+N2Φ(seσWNΔt).The derivatives∂∂σpand∂∂σ(1-p)in the right hand side of (3.34) are given by∂∂σp=(2-erΔt(eσΔt+e-σΔt))(eσΔt-e-σΔt)2Δt∂∂σ(1-p)=(erΔt(eσΔt+e-σΔt)-2)(eσΔt-e-σΔt)2Δt.These results lead to further calculation ofV2as follows:V2=e-rTEp1-pWNΔt2Δt(4p(1-p))N2(2-erΔt(eσΔt+e-σΔt))erΔt(eσΔt+e-σΔt)-1-e2rΔt×WNΔt2+12-pNΔtΦ(seσWNΔt).Two approximation formulas(2-erΔt(eσΔ+e-σΔ))erΔt(eσΔ+e-σΔ)-1-e2rΔt≈2-(1+rΔt)(2+σ2Δt)(1+rΔt)(2+σ2Δt)-1-(1+2rΔt)≈-(1+2rσ2)12-p=12-erΔt-e-σΔteσΔt-e-σΔt≈12-rΔt+σΔt-σ22Δt2σΔt=-(r-σ22)Δt2σΔtlead to(3.35)V2≈e-rTEp1-pWNΔt2Δt(4p(1-p))N21+2rσ2μT-WNΔt2ΦseσWNΔt.Two results (3.33) and (3.35) are combined to obtain,V≈e-rTEp1-pWNΔt2Δt(4p(1-p))N2ΦseσWNΔtWNΔt2σT-μWNΔtσ-1σ+1+2rσ2μT-WNΔt2=e-rTEΦ(seσWNΔt(p))(WNΔt(p)-μT)2σT-WNΔt(p)-μT-1σ.We get the formulaV=e-rTEΦseσWT(p)(WT(p)-μT)2σT-WT(p)-μT-1σ+OΔt.We define the discrete Malliavin vega asVDM=e-rTEΦ(seσWT(p))(WT(p)-μT)2σT-WT(p)-μT-1σ.This is converged to vega in the continuous time modelVDM=VBS(s,0)+O1N,as in the case of delta. This formula is related to the discrete Malliavin gamma given in (3.30) by the following relation, it is(3.36)VDM=s2σTΓDM.This result is already known for the continuous time model. See Carr (2000), for example. The Malliavin vega is computed by the formulaVDM=s2σTe-rT∑j=0NNCjpj(1-p)N-jΦ(sujdN-j)πΓ,where πΓis given the Malliavin weight for discrete Malliavin Gamma.The binomial tree approach to the computation of greeks for options has been investigated in the previous section. Greeks are computed using the binomial tree approach and they are compared with greeks of the Black and Scholes model. The parameters used in this numerical experiment are K=100, r=0.05, T=1(year), and σ=0.3. The mesh size of the binomial tree is fixed at N=1000. Table 1lists the numerical results for delta and gamma. We consider three cases for this numerical experiment: the price of underlying assets is given by S=100,95,105. The error is computed using the formula 100×(Greeks(DM)−Greeks(BS))/Greeks(BS). Table 1 shows that delta and gamma computed using the binomial tree approach are highly accurate. We do not list the computational result for vega, because gamma and vega have a special relation (3.36). We also compared discrete Malliavin methods with other existing tree methods. We compare discrete Malliavin delta with delta for European call options computed by other kinds of binomial tree: Tree methods introduced by Chung and Shackleton (2002), Tian (1993), and Leisen and Reimer (1996). These are summarized in Fig. 2. We used the extended binomial tree approach to compute delta using the binomial trees of Chung and Shackleton (2002) and Tian (1993). In order to obtain delta using the binomial trees of Leisen and Reimer (1996), we used the finite difference approach, because we wanted to implement simple calculations. They construct two kinds of trees using two different transform formulas and we used “Method-1” described in their article. However, there is no significant difference between two methods. As shown in Fig. 2, Greeks calculated by trees introduced by Chung and Shackleton (2002) and Tian (1993) converges to the real value smoothly. As shown in this figure, Discrete Malliavin delta also converges very smoothly. Delta computed by the tree introduced by Leisen and Reimer (1996) converges considerably fast, if one uses trees with odd steps.We also compute greeks for digital options. Figs. 3–5plot the values of greeks (delta, gamma, and vega) for digital options using our approach, the extended binomial tree approach of Pelsser and Vorst (1994) and the finite difference approach. These results are computed using binomial trees with N=5, 10, …, 500 steps for one year. The parameters used in these numerical studies are the same as those used to compute greeks in this work (Tables 1). The pay-off function for this numerical study is given by Φ(x)=1[100,110](x), i.e. there is a cash-flow 1 if and only if the underlying asset price is between 100 and 110. This pay-off function is also used in the numerical demonstrations in Fournié et al. (1999). The horizontal lines in Figs. 3–5 are the delta, gamma, and vega computed by the explicit formula. DM, EB, and FD in Figs. 3–5 denote Discrete Malliavin greeks, the greeks computed by the extended binomial tree approach, and the greeks computed by the finite difference approach, respectively. It is well known that one robustly obtain delta and vega for plain vanilla European options, even if one uses the finite difference approach. However, this approach is not suitable for computing greeks for digital options. On the other hand, one can obtain greeks very accurately if one uses the discrete Malliavin greeks approach. The extended binomial tree approach also computes greeks accurately, although one cannot compute vega using this approach.Table 2shows the pricing error for Discrete Malliavin Delta and Gamma to the real values for digital options: The pay-off function is given by Φ(x)=1[L,U](x). The parameters used in this numerical demonstrations are given by S=100, r=0.1, T=1(year),σ=0.2. These parameters are used in Fournié et al. (1999) to compute Greeks for digital options. The number of time steps are given by 50,000 steps, because the convergence of discrete Malliavin Greeks for digital options are not necessarily very fast.

@&#CONCLUSIONS@&#
