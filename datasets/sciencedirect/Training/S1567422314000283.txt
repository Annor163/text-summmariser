@&#MAIN-TITLE@&#
Unanimously acceptable agreements for negotiation teams in unpredictable domains

@&#HIGHLIGHTS@&#
Extended agent negotiation team models to assure unanimity for team decisions in domains with unpredictable issues.The proposed model outperforms existing negotiation team models against different families of negotiation opponents.As long as preferential conflict is present among team members, the team benefits from the inclusion of Bayesian members.

@&#KEYPHRASES@&#
Automated negotiation,Multi-agent systems,Agreement technologies,

@&#ABSTRACT@&#
A negotiation team is a set of agents with common and possibly also conflicting preferences that forms one of the parties of a negotiation. A negotiation team is involved in two decision making processes simultaneously, a negotiation with the opponents, and an intra-team process to decide on the moves to make in the negotiation. This article focuses on negotiation team decision making for circumstances that require unanimity of team decisions. Existing agent-based approaches only guarantee unanimity in teams negotiating in domains exclusively composed of predictable and compatible issues. This article presents a model for negotiation teams that guarantees unanimous team decisions in domains consisting of predictable and compatible, and alsounpredictable issues. Moreover, the article explores the influence of using opponent, and team member models in the proposing strategies that team members use. Experimental results show that the team benefits if team members employ Bayesian learning to model their teammates’ preferences.

@&#INTRODUCTION@&#
In the last decade, there has been an increase in the profit earned by electronic commerce systems. This increase has lead to a strong interest of the academic world in researching problems related to e-commerce (Ngai and Wat 2002; Grieger 2003; Wareham et al. 2005). As of today, most e-commerce systems rely on users manually browsing their catalogs and selecting which goods they desire to buy. This task may end up being time consuming and suboptimal in terms of users’ preferences, especially as the number of items and services offered on the Web increases. Therefore, it is necessary to propose mechanisms that helps costumers take better decisions while saving their time efforts.Agent-based electronic commerce has been proposed as a solution to such problems (Guttman et al. 1998; Sierra and Dignum 2001; Oliveira and Rocha 2001; He et al. 2003). In an agent-based e-commerce system, autonomous agents act on behalf of their users with the goal of finding and closing satisfactory deals. Automated negotiation is one of the most common approaches when implementing these systems since they allow different electronic parties to reach agreements by exchanging offers and feedback (Lomuscio et al. 2003; Nguyen and Jennings 2005; Buffett and Spencer 2007; lau 2007; Chan et al. 2008). The benefits of automated negotiation and agent-based e-commerce are many. Being brief, some of the most important include:•As stated, browsing online catalogs for an optimal deal may be time consuming. The state-of-the-art in automated negotiation can complete complex negotiations for multiple issues in less than a few minutes (Klein et al. 2003a; Williams et al. 2011; Baarslag et al. 2012).On the one hand, automated negotiation saves the user from having to browse the entire catalog. Additionally, its personal agent is directed by the preferences of the user in the negotiation, which should result in deals that are adjusted to the personal liking of the individual. Personalization has been reported to increase user satisfaction in many computational systems (Ball et al. 2006; Liang et al. 2007). On the other hand, a dynamic process like automated negotiation allows sellers to adapt their deals to the users’ preferences, their current business needs, and their competitor dynamics (He et al. 2003).Agreements achieved by human negotiators, suffer from the leaving money on the negotiation table effect (Thompson 2003). This means that human negotiators are content with current agreements, which are usually suboptimal, when they could have performed much better. Agents in automated negotiation have been reported to provide agreements close to the optimal solution (Lai et al. 2008).Compared to centralized and offline approaches (e.g., preference aggregation, recommendation approaches, etc.), automated negotiation is a dynamic and parallel process. For instance, some centralized approaches like preference aggregation are computationally hard especially if the preference space is combinatorial (Chevaleyre et al. 2007). On the other hand, recommendation approaches only filter prospective deals, but they do not close specific contracts adapted to business needs. Contrarily, automated negotiation can be adapted to current business needs (e.g., concede to gain customers and close fast deals). Additionally, as stated above, team members are also motivated by their own personal interests. Therefore, it is possible that some team members show opportunistic behavior inside the team. In such cases, preference aggregation may be manipulated by exaggerating preferences. Additionally, each parties’ preferences are private, therefore making it difficult for the other parties to exploit and manipulate. This latter factor is important, since nowadays most users in electronic applications care about the information they filtrate in systems (Taylor 2003).Most negotiation mechanisms proposed for e-commerce settings have focused on solving bilateral or multiparty negotiations where parties are individual agents (Faratin et al. 1998; Zeng and Sycara 1998; Klein et al. 2003b; Nguyen and Jennings 2005; Coehoorn and Jennings 2004; Buffett and Spencer 2007; Lai et al. 2008; Williams et al. 2011; Sanchez-Anguix et al. 2013; Aydoğan and Yolum 2012). However, some real life scenarios involve negotiation parties that are not necessarily formed by single individuals. Instead, each party may be formed by more than a single individual. For instance, imagine that a group of travelers wants to go on a holiday together. As a group, they have to negotiate with several travel agencies to get the best travel package for the group. Despite sharing a common goal, each member in the multiplayer party may also be motivated by its own personal interests Mannix (2005) and Halevy (2008). Therefore, the group not only faces a possibly difficult negotiation with the travel agency, but it also needs to deal with the conflict present in the group. This type of multi-individual negotiating party has been studied in the social sciences under the name of negotiation team (Thompson et al. 1996; Brodt and Thompson 2001).As far as the authors are concerned, multi-individual parties have been overlooked in automated negotiation research. The use of computational models for negotiation teams opens doors for new types of interesting and novel applications in electronic commerce. The inclusion of agent-based negotiation teams allows for e-commerce systems to deploy dynamic deal mechanisms for groups, making of e-commerce a more social system. Classically, when purchasing for groups in e-commerce systems, one representative takes decisions for the whole group. Either he makes decisions according to his own preferences or the group needs to engage in a human negotiation which is usually a costly process due to different schedules, logistics, lack of communication problems or interpersonal conflict (Behfar et al. 2008). With the inclusion of agent-based negotiation teams these problems are eluded since autonomous agents take decisions jointly while saving time and efforts for their users.We believe that agent-based negotiation teams could provide potentially interesting new services:•Electronic markets for groups of travelers: Online travel agencies offer their services by means of online catalogs where users can browse different products like flights, hotels, restaurants, activities, etc. The possibilities for travels are vast, and usually a single travel operator may offer thousands of possible trip packages/services. Exhaustively looking through this online catalog for an optimal deal becomes an unfeasible task for humans. Additionally, more often than not, travel is a social activity for groups (e.g., friends, family, young people, etc.). Users can benefit from agent-based negotiation teams since they can exhaustively look for deals while taking the preferences of the group into account and saving efforts. Service providers can also benefit from these models since they could adapt their business strategies in a dynamic way and add a level of personalization that may help to retain customers. Moreover, offering the possibility for groups to close travel deals based on their preferences is a value-added service, that as far as we know, is not currently offered by the industry. As an example of its application, users may indicate to their personal agents their desire to go on a travel together. Then, the agents prepare to negotiate with different travel agencies in order to provide a complete and satisfactory travel package for the users. The fact that the negotiation is carried out automatically by electronic agents also gives room to looking for several alternatives in parallel. Once several trip packages have been negotiated, the personal agents may communicate the agreements to users, who can validate them in the last instance.Electronic support for agricultural cooperatives: Agricultural cooperatives are supposed to be democratic institutions where groups of farmers join together to save resources for the distribution of their products. One of the main problems of agricultural cooperatives is the principal-agent problem (Ortmann and King 2007). Basically, despite being democratic institutions, agricultural cooperatives are managed by a board of directors who take decisions on behalf of the democratic institution. It has been reported in the literature (Ortmann and King 2007) that dissatisfaction in cooperatives comes from the fact that the goals of members are not aligned with those of the managers. As a novel application for electronic commerce, agent-based negotiation teams may provide support for the processes that are carried out by cooperatives. For instance, the negotiations between agricultural cooperatives and distributors may be supported by an electronic market where the agricultural cooperative is modeled as an agent-based negotiation team. Each member may be represented by an electronic and personal agent that participates in the negotiation team according to the preferences of its owner. This way, if the model is capable of ensuring unanimity with regards to team decisions, it may be possible to avoid the principal-agent problem. Of course, agricultural cooperatives are large institutions and considerable research has still to be done to provide scalable and fair computational models. However, research as the one presented in this article contributes to the obtention of such models in the long term.Groups of energy producers in the smart grid: The smart grid is addressed to be the next generation network for electricity distribution (Farhangi 2010). In this network, energy generation may come from geographically distributed small generators (e.g., green energy generators) that have to compete with large energy producers. Decisions at the smart grid have to be taken dynamically since energy production and consumption may vary or face unexpected events (Ramchurn et al. 2012). Recently, agent-based electronic commerce has been proposed as proper paradigm for this scenario due to its dynamic nature and adaptive response (Brazier et al. 2002; Lamparter et al. 2010; Morais et al. 2012; Ramchurn et al. 2012). If small generators want to compete with large generators like power plants, they may need to group together and act together as a single generator. Agent-based negotiation teams can give support for the group decision making of small generators in a dynamic environment like the smart grid. For instance, an agent-based negotiation team for the smart grid may decide on different contract attributes like energy price for different time slots, contract duration and cancellation fees with different energy consumers.The applications described above present benefits for electronic commerce systems. However, there are still several issues that need to be solved for deploying real applications based on agent-based negotiation teams due to the novelty of the topic. One of the main issues that should be addressed when designing agent-based negotiation team models is unanimity. The authors argue that, whenever it is possible, it is desirable for the final agreement with the opponent to be unanimously acceptable for all of the team members. When the members of the negotiation team are going to interact in the long term, the intra-team strategy should avoid one or some of the team members being clearly at disadvantage (e.g., unacceptable deal) with respect to the other team members. In the first place, the aforementioned situation may end up in users perceiving unfairness, which may affect commitment to the decision, group attachment, and trust (Korsgaard et al. 1995). And second, but not the least important, users that are not satisfied with agreements found automatically may end up leaving the electronic commerce application.The existing approaches (Sanchez-Anguix et al. 2011; 2012a,b) have focused on achieving unanimously acceptable agreements for negotiation domains exclusively comprised by predictable and compatible issues among the team members. An issue is predictable and compatible if the preference order over issue values is the same for team members and this fact is known from the domain (e.g., price in a team of buyers). While some e-commerce domains are exclusively composed by these issues, many domains also contain issues whose preferential ordering over issue values is not known from the domain (i.e., unpredictable issues). For instance, it is difficult to predict from a set of cities which ranking represents the preferences of a traveler, which can diverge from the preferences of other travelers.This article advances the state of the art in agent-based electronic commerce in two different ways. Firstly, it introduces a new model for agent-based negotiation teams, which could support dynamic negotiations for groups of autonomous agents representing their users. Secondly, the present model is capable of assuring that the final agreement is unanimously acceptable for all of the team members in domains that contain both predictable and compatible and unpredictable issues. We propose an intra-team protocol in which a team mediator helps team members to reach unanimously acceptable decisions. Furthermore, we propose two negotiation strategies for team members: a basic negotiation strategy based on concession tactics and a negotiation strategy using Bayesian learning to model teammates’ and opponent’s preferences for unpredictable issues. The model is capable of outperforming state-of-the-art approaches for agent-based negotiation teams. We describe our general framework in Section 2 and the intra-team protocol that allows team members to reach unanimity in Section 3. After that, we propose two negotiation strategies for team members in Section 4 and we explain why unanimity is guaranteed among team members in Section 5. After analyzing the experiments in Section 6, we relate our work to existing approaches and discuss future lines of work in Section 7.Let A represent a negotiation team consisting of∣A∣=Mdifferent team members and a trusted team mediatormedA, and leta∈Arepresent a team member in negotiation team A. Let op represent the opponent party of the negotiation team. The negotiation between team and opponent is carried out in a bilateral fashion, using an alternating-offers protocol (Rubinstein 1982). In this protocol, one of the two parties is the initiating party and sends the first offer to the other party or responding party. The responding party receives the offer and decides whether or not he/she accepts the offer. Accordingly, she or he may accept the current offer or send a counter-offer. If the responding agent sends a counter-offer, the initiating party has to decide whether he/she accepts the counter-offer or not. If the counter-offer is rejected, the process is repeated in a turn-taking fashion until a deal is mutually accepted (successful negotiation) or one of the parties decides to quit the negotiation since its deadline has been reached (failed negotiation). Concerning inter-party communications, the team mediator interacts with the opponent by sending team’s proposals and transmitting opponent decisions to team members. The team mediator plays a key role since it coordinates the team members and helps them reach unanimously acceptable deals.Let X be the object under negotiation,j∈{1,…,n}be the issues under negotiation,Djbe the negotiation domain or valid values for issue j andxj∈Djrepresent a valid value for issue j. Each agent’s preferences are represented by means of a private additive utility function. We assume that there is no preferential interdependency among negotiation issues; that is, the valuation given to a certain issue does not affect preference on the valuation of other negotiation issues. The utility function for an agent in our framework can be formalized as follows:(1)U(X)=w1V1(x1)+w2V2(x2)+⋯+wnVn(xn),wherewjrepresents the importance given to issue j by the agent, andVj:xj→[0,1]is a scoring function for issue j that gives the score that the agent assigns to an issue valuexj. It is assumed that∑j=1nwa,j=1andwa,j⩾0, and thenU(.)is a function scaled in [0,1], where 0 represents the least desirable negotiation deals, and 1 represents the most desirable negotiation deals. For agents,RU∈[0,1]represents the reservation utility or the minimum level of utility to consider an agreement as acceptable.In the proposed framework, private information and bounded rationality are assumed. The former has been introduced above: information regarding agents’ preferences is private, and so are the strategies and minimum acceptable values of each agent. This is true even among team members, since prior to the negotiation they do not know any information regarding other teammates’ preferences. The only information available is obtained via interactions in the intra-team protocol. The latter refers to the fact that given the limited time, information privacy, and limited computational resources, agents cannot calculate the optimal strategy to be carried out during the negotiation. Instead, they employ heuristic strategies that aim to be as good as possible in terms of the achievable utility.Each team membera∈Ahas a reservation utilityRUa∈[0,1]that represents the minimum utility that satisfies the team member’s need. Each outcome whose utility is lower than the reservation utility is unacceptable for the team member. As stated along this article, we consider that unanimity in a negotiation team is of extreme importance. An offer is unanimously acceptable for a team A if it is acceptable for all of the team members inside the negotiation team:(2)∀a∈A,Ua(X)⩾RUa.The proposed intra-team strategy will assure that team members only accept those offers that are unanimously acceptable for all the team members and that offers proposed to the opponent are over each team members’ reservation utilities, thus, making it unanimously acceptable.Among the different negotiation issues that compose the negotiation domain, we consider that there are issues that are predictable and compatible among team members and issues that are unpredictable among team members.Formally, we can define an issue j with domainDjas compatible among team members if for each possible pair of team membersa,b∈Aand for each pair of issue valuesv1,v2∈Dj, the following expression is true:(3)Va,j(v2)>Va,j(v1)→Vb,j(v2)⩾Vb,j(v1).Hence, an issue is compatible among team members if one of the team members can increase its utility by selecting a certain issue value with respect to the current assignment, then the rest of team members stay at the same utility or they also increase their utility. Thus, there is no preferential conflict among issue values between the team members, and there is full potential for cooperation among team members with respect to compatible issues. Fig. 1shows two examples of compatible issues among two agents (top part) and an example of a non compatible issue (bottom part). As it can be observed, in the case of price (top left), both agents obtain a better valuation when choosing a lower price value with respect to a high price value. Thus, Eq. (3) holds and it is a compatible issue for both agents. In the case of the city of destination (top right), the issue is also compatible among the two agents. For any pair of cities, if one of the agents prefers one of the cities with respect to other city, the other agent also holds the same preferential relationship. For instance, both agents prefer Paris to Berlin, Berlin to London, and London to Madrid. However, in the case of the type of room (bottom part), the blue agent prefers an individual room with respect to an apartment, whereas the red agent prefers exactly the opposite. Thus, there is no full potential for cooperation among team members in that negotiation issue since conflict is present.The concept of predictability and unpredictability (Hindriks and Tykhonov 2010, Marsa-Maestre et al. 2013) is related to vertical and horizontal issues found in economics literature (Stole 1995). The definition of predictable issues matches with vertical issues, while the definition of unpredictable issues matches with horizontal issues. From this point on, we will use the concepts of unpredictable/predictable and we will briefly introduce them. An issue is predictable for an agent if the preference ordering of issue values is known in the negotiation domain. Therefore, an issue is compatible and predictable among team members if the preferences regarding issue values are known in the negotiation domain and increasing the utility of one of the team members by selecting one specific issue value results in other team members staying at the same utility or also increasing their respective utilities. For instance, from the examples in Fig. 1, one can consider that inside a team of buyers the price is a compatible and predictable issue among team members since it is known that all of the buyers prefer low prices to high prices, and reducing the price results in all of the buyers increasing their utility or staying at the same utility. On the other hand, an issue is unpredictable among team members if the preference ordering of the issue values cannot be accurately predicted and Eq. (3) may not hold for that issue. In the case of Fig. 1, the city of destination is a compatible issue among the two agents. Nevertheless, in a travel negotiation domain it is not true that all of the travelers will hold the same preference ranking over the issue values and without additional knowledge, the preference ordering may not be predicted accurately. Hence, it is an unpredictable issue. With respect to the type of room, the preference ordering over issue values may vary for the travelers. Moreover, we cannot predict their preference ordering directly, thus making the issue unpredictable.In this framework, PR denotes the set of predictable and compatible issues among team members, while UN denotes the set of unpredictable issues.We define an unpredictable partial offerX′as a partial offer that has a concrete instantiation of all the unpredictable issues in UN. The utility of an unpredictable partial offer is calculated asUa(X′)=∑j∈UNwa,jVa,j(xj).For a team membera∈A, an unpredictable partial offerX′will never be part of an acceptable offer (i.e., it will never be an unanimously acceptable offer for the team) when the sum of the utility ofX′and the maximum utility that can be obtained from predictable issuesmaxPRa=∑j∈PRwa,jis less than its reservation valueRUa, since any full offer that completesX′is below the reservation utility. For a team member a, we refer to the set of unpredictable partial offers that will never be part of an acceptable offer as forbidden unpredictable partial offers,Fa(see Eq. (4)).(4)Fa={X′∣Ua(X′)+maxPRa<RUa}It is worth noting thatFadoes not represent the whole negotiation space that is unacceptable for a, but just a portion of it. In fact, some unpredictable partial offers that are not contained inFa, can become unacceptable when the agent does not get the value needed from predictable issues. The size ofFamay grow as the reservation utility increases. Thus, agents with high reservation utilities are expected to have larger sets ofFathan agents with low reservation utilities.In this article we have employed a case of study (i.e., a negotiation domain) that is extracted from a possible tourism electronic market. The case of study is used to illustrate and test the proposed negotiation framework.A group of travelers wants to go on a holiday together and arrange their accommodation. The group negotiates with a hotel on the following issues.•Price (p): It represents the price per night that each traveler pays to the hotel for the booking service. The value goes from 200$, which is the minimum rate applicable by the hotel, to 400$, which is the maximum rate found in the hotel. This negotiation issue is considered to be predictable and compatible among team members since all of the travelers obviously prefer low prices to high prices. Contrarily, the hotel prefers high prices to low prices.Cancellation fee (cf): This issue represents the amount of the final price that each friend pays if the reservation is canceled. Possible values for this negotiation issue go from 0% to 50%. This is a predictable and compatible issue among team members since all of the travelers prefer low cancellation fees to high cancellation fees. On the contrary, the opponent prefers high cancellation fees to low cancellation fees.Arranged foods included (af): The hotel may also offer some meals included in deal with the travelers. The type of meal plans included are none, breakfast, breakfast+lunch, breakfast+dinner, lunch+dinner, and all. In our negotiation scenario, we have considered that this negotiation issue is unpredictable among team members since preferences of team members on this issue may vary and it cannot be assumed to be same for each member.Type of room (tr): The four travelers can be accommodated in different types of room depending on their preferences. More specifically, the hotel offers 4 individual rooms, 2 twin rooms, 1 triple and 1 individual room, or 1 apartment. The type of room is an unpredictable negotiation issue among team members.Payment method (pm): The amount of money paid by the travelers may be paid by different methods. The hotel allows for the payment to be made in cash, via credit card, by bank transfer, in a 3 months deferred payment through the bank, and in a 6 months deferred payment. This negotiation issue is unpredictable since team members may prefer to choose different payment methods and we cannot predict their preference ordering directly.Room orientation (ro): If possible, the team members can decide upon an orientation for the balcony of their rooms. The different options are inner garden, main street, pool, sea, and outer garden. This issue is also considered an unpredictable issue among team members.Free amenity (fa): As a token of generosity for booking as a group, the hotel offers one free service to all of the team members. More specifically, the team members can choose between gym service, free wi-fi, 1 free drink per day, 1 free spa session, pool service, cable tv service, and one free guided tour. Since the preferences of team members vary for this issue and no assumption about their preferences can be made, this issue is also considered as unpredictable.To sum up, for this case study we have thatPR={p,cf}andUN={af,tr,pm,ro,fa}with a total of 4200 different combinations of discrete issue values (af,tr,pm,ro,fa) and two real issues (p,cf). We assume that the team mediator knows which issues are predictable and can apply an operator that determines the best value for team members from a given set. For unpredictable issues, team members can have different types of valuation functions and the mediator does not know which issue values are better for team members. Each team member may assign different weights (i.e., priorities) to negotiation issues and the opponent’s valuation functions and issue weights may be different from those of team members. The team mediator does not know the weights given by agents to the different issues.In a negotiation involving a negotiation team, the intra-team protocol defines how and when decisions are taken regarding the negotiation. In this framework, we propose an intra-team protocol that is governed by the trusted team mediatormedA. Basically, the team mediator regulates the interactions that can be carried out among team members and, accordingly, helps team members reaching unanimous acceptable decisions inside the team during the negotiation. The proposed protocol is clearly differentiated into two different phases: Pre-negotiation and Negotiation. On the one hand, during the pre-negotiation, the mediator helps team members identifying potential offers that are not unanimously acceptable for every teammate. On the other hand, during the negotiation the mediator coordinates the offer proposal mechanism, which is composed of a voting process for unpredictable issues and an iterated building process for predictable issues, and the offer acceptance mechanism for offers that come from the opponent. We describe those phases in a detailed way in the following Sections 3.1 and 3.2. An overview of all of the communications carried out in the negotiation model are depicted in Fig. 2. It specifies the protocols carried out within the team and the communications carried out with the opponent by means of Agent UML (Bauer et al. 2001) sequence diagrams. More detailed views of the intra-team protocols for the pre-negotiation, evaluation opponent’s proposals and proposing offers can be observed in Figs. 3–5respectively.In the pre-negotiation phase, the mediator coordinates the following intra-team protocol to discover the set of forbidden unpredictable partial offersFAfor the team. The set of forbidden unpredictable partial offers for the team,FA, is defined asFA={X′∣∃a∈A,X′∈Fa}. This means that any unpredictable partial offer inFAis never part of an acceptable offer for at least one team member. Thus, these unpredictable partial offers should be avoided for the team since the goal of the negotiation model is reaching unanimously acceptable agreements.A formal description of the pre-negotiation protocol is presented in Fig. 3. The picture describes the protocol by means of Agent UML sequence diagrams. According to the proposed protocol, the team mediator initiates the pre-negotiation phase by asking each team member a to calculate its own set of forbidden unpredictable partial offersFa(message 1 in Fig. 3). Each team member builds its own (forbidden) set as requested, and it is communicated to the mediator privately (message 2 in Fig. 3). When the mediator receives the sets from the team members, it aggregates them in order to construct the set of forbidden unpredictable partial offers for team A,FA=⋃a∈AFa. Then, the team mediator makes public the list of forbidden unpredictable partial offers of the teamFA(message 3 in Fig. 3). It should be stated that, since any unpredictable partial offer in this set will prevent one of the team members from reaching its reservation utility, the team is not allowed to generate an offer involving any of these partial offers inFA. After the team mediator has sharedFAwith team members, the negotiation phase starts.The reader may realize that it is possible that during this phase, most of the unpredictable partial offers are pruned. In that case, it means that there is little potential for cooperation among team members. This issue can be observed by the team mediator prior to starting any negotiation process. In that case, the team mediator may suggest the team not to negotiate and save the computational resources used in the negotiation. If the team is not static and can be dynamically formed, it may suggest team members to disband the team and look for other potential partners. However, this team/coalition formation (Gaston and desJardins 2005; Rahwan et al. 2009) is outside of the scope of this work since we focus on studying the performance of the negotiation model. We consider the use of the information provided with forbidden unpredictable partial offers for negotiation team formation as a future line of work. In general, combinations of team members that prune a small portion of the space should be more similar among them, and it should be more easy to achieve cooperation.In the negotiation, two mechanisms are carried out at each round: a mechanism for deciding to accept/reject the opponent’s offer (Evaluation of Opponent’s Offer), and a mechanism for proposing an offer to the opponent (offer proposal). For the former, a unanimity voting process is employed, while for the latter an offer building process is governed by the team mediator.This mechanism is carried out each time the team mediator receives an offer from the opponent. Since the main goal of the proposed intra-team strategy is achieving unanimously acceptable agreements for the team, a unanimity voting is carried out to decide whether or not the opponent’s offer is acceptable for the team. With this mechanism, as long as one of the team members is not satisfied with the opponent’s offer, the offer is not accepted by the team, precluding the team from reaching agreements that are not unanimously acceptable. A formalization of the protocol followed in this mechanism can be observed in Fig. 4. The picture shows the formalization employing sequence diagrams from Agent UML. The intra-team protocol used for this mechanism goes as follows. First, the team mediator receives the offerXtfrom the opponent at time t. IfXtinvolves any forbidden unpredictable partial offer inFA, the opponent offer is automatically rejected. However, the opponent’s offer is also informed to team members in order to allow each team member to process the new information leaked by the opponent if they see it necessary (message 1 in Fig. 4). Otherwise, if the combination of unpredictable issue values is not inFA, in order to see whether the offer is unanimously acceptable for team members, the mediator makes the opponent’s offer public among team members and starts an anonymous voting process (message 2 in Fig. 4). Each team membera∈Astates to the mediator whether he is willing to acceptXt(positive vote) or to reject it (negative vote) at that specific instant (messages 3.a or 3.b in Fig. 4). Since our aim is to guarantee unanimity, the offer is only accepted if all of the team members emit a positive vote (message 4.a in Fig. 4). Otherwise, the offer is rejected and a counter-offer is proposed as explained in Section 3.2.2.Proposing an offer to the opponent is a complex task, since the space of offers may be huge and the preferences of the team members should be reflected in the offer sent to the opponent, and, in our case, the offer sent should be unanimously acceptable for team members. The process is divided into two sub-phases: constructing an unpredictable partial offer, and setting up predictable issues. In both phases, the team mediator acts according to Algorithm 3.1. We include another formal description of the interactions between the mediator and a team member during the offer proposal. This information can be found in Fig. 5, which depicts the intra-team protocol specified in and Agent UML sequence diagram.•Constructing an unpredictable partial offer: The first step is to propose an unpredictable partial offer, a partial offer which has all of the unpredictable issues instantiated. Since team members know fromFAthe list of unpredictable partial offers that will not result in unanimously acceptable offers under any circumstance, any offer proposed by the team should avoid being constructed from unpredictable partial offers found inFA. The method used to propose offers to the opponent relies on the fact that unpredictable issues are those where intra-team conflict may be present, whereas there is full potential for cooperation in predictable and compatible issues. Hence, in order to build an offer to be sent to the opponent, it seems more appropriate to jointly set unpredictable issue values first and then, depending on the remaining needs of team members, allow team members to set compatible and predictable issues as they require for reaching their demands. The proposed mechanism for the first part, proposing an unpredictable partial offer, is based on voting and social choice. The voting process goes as follows.1.The mediator asks each team member to anonymously propose one unpredictable partial offerXa′t(message 1 in Fig. 5).Each team member privately sends its proposal to the mediator, who gathers all of the proposals in a list that will be later sent to team members. If any unpredictable partial offer proposed by a is contained inFA, the mediator automatically ignores this proposal (message 2 in Fig. 5).Once all of the proposals have been gathered, the mediator makes public the list of proposalUPO′tamong team members and opens a Borda scoring process (Nurmi 2010) on proposed candidates (message 3 in Fig. 5).Each team member anonymously scores candidates and sends the scores to the team mediator (message 4 in Fig. 5).The team mediator sums up scores and selects the winner candidate with the highest scoreXA′t, making it public among team members (message 5 in Fig. 5). This candidate, an unpredictable partial offer, will be the base for the full offer that will be sent to the opponent.Setting up predictable and compatible issue values: Once unpredictable issues have been set, it is necessary to set predictable and compatible issues to construct a complete offer. As it has been stated along this article, there is full potential for cooperation among team members in these issues since increasing the utility of one of the team members by selecting one issue value will result in the other team members staying at the same utility or increasing their utility. Obviously, the selected unpredictable partial offer will not satisfy equally the needs of all the team members. Nevertheless, team members can make use of predictable and compatible issues to satisfy their remaining needs while not generating conflict inside the team. To complete the partial offerXA′t, an iterative mechanism that we proposed in (Sanchez-Anguix et al. 2012a) is used to build the final offer issue per issue. The mechanism follows an order for predictable and compatible issues that is constructed by the mediator at each round according to the history of the opponent’s concessions. The rationale used to build this order is that the opponent would concede less on those predictable issues more important for him in the first negotiation rounds, whereas it would concede more on those predictable issues that are less important. Thus, the order established by the team mediator attempts to order predictable and compatible issues in ascending order of importance for the opponent. The general idea behind this ordering is attempting to satisfy team members’ demands with those predictable issues less important for the opponent first. The order is updated as new information becomes available from the offers sent by the opponent. Based on this order, the iterative mechanism goes as follows.6.The mediator selects the first predictable issue j and asks team members, given the current partial offerXA′t, the necessary valuexjfor j to get as close as possible to their current demands (message 6 in Fig. 5).Accordingly, each team member a informs the mediator privately about the most convenient valuexa,jfor that issue (message 7 in Fig. 5). To decide the final valuexjfor the issue j, the trusted mediator aggregates agents’ opinions (since the issue is predictable) by means of a function that, for team members, returns the most preferred issue value from a given set (best(.)). After deciding the valuexj,XA′tis updated withxj.The mediator asks the team whether or not the new partial offer is already satisfactory at round t (message 8 in Fig. 5).Each team member emits an affirmative response if the current partial offer covers its current demands and a negative response if it still has not covered its demands (message 9.a or 9.b in Fig. 5). Those agents that agree with the current state ofXA′tleave the iterative mechanism for this offer since they already are satisfied with the current partial offer. The process steps back to the selection of the next issue.The process continues until all of the predictable issues have been set or until all of the team members have left the iterative mechanism. In the latter case, the remaining issues are set attempting to maximize the opponent’s preferences. Once the offer is complete, it is announced among team members and sent to the opponent (message 10.b in Fig. 5).Pseudo-algorithm for the offer construction from the point of view of the mediator. Send (message⟶condition) means that message is sent to every agent that fulfills condition1:2: /*Proposing an unpredictable offer*/3: Send (REQUESTXa′t⟶∀a∈A)4: Receive (INFORMXa′t⟵∀a∈A)5:UPO′t=(⋃a∈AXa′t)-FA6: Send (REQUEST Borda onUPO′t⟶∀a∈A)7: Receive (INFORMscorea⟵∀a∈A)8:XA′t=argmaxX′∈UPO′t∑a∈Ascore(a,X′)9: Send (INFORMXA′t⟵∀a∈A)10:order=build_predictable_order();A′=A11:12: /*Setting predictable issues*/13: for allj∈orderdo14: Send (REQUEST value for j⟶∀a∣a∈A′)15: Receive (INFORMxa,j⟵∀a∣a∈A′)16:xj=best({xa,j∣a∈A′})17:XA′t=XA′t⋃{xj}18: Send (REQUEST Satisfied withXA′t?⟶∀a∈A′)19:for alla∈A′do20: Receive (INFORMaca′(XA′t)⟵a)21:ifaca′(XA′t)=truethen22:A′=A′-{a}23:end if24:end for25:ifA′=∅then26: break;27:end if28: end for29: for allj∈order∧issue_not_set(j)do30:xj=maximize_for_opponent(j)31:XA′t=XA′t⋃{xj}32: end for33:XAt=XA′tThe team mediator defines the coordination mechanisms inside the team. However, each team member’s internal strategy has a great effect on team dynamics. In this article, we propose two types of strategy for team members. According to the first strategy (i.e., our basic team member), the team member only proposes unpredictable partial offers based on its own utility. In the second strategy, team members model the preferences of the team and the opponent on unpredictable partial offers. Then, in the mechanism employed to set unpredictable partial offers, each team member selects the candidate that guarantees that it can reach its current aspirations at time t, and maximizes the probability of being acceptable for the opponent and the team. The learning mechanism employed by these team members is Bayesian learning (i.e., Bayesian team member).Since negotiations are time-bounded in our framework, we consider that team members have to perform some kind of concession if an agreement is to be found. For this purpose we have designed basic team members as agents whose demands are controlled by an individual and private concession strategy. More specifically, the concession strategy for a team membera∈Ais based on time-based tacticssa(t)(Faratin et al. 1998, Lai et al. 2008). It estimates the utility demanded by a at time t by using the formula in Eq. (5), whereRUais its reservation utility, T is the negotiation deadline, andβais the concession speed, which determines how fast the agent’s demands are lowered towardsRUa.(5)sa(t)=1-(1-RUa)×tT1βaBased on this concession tactic, each team member participates in the intra-team protocol with their demands regulated by his private concession tactic. Next, we define how team members take their decisions: evaluating the opponent’s offer, and proposing an offer for the opponent.Given an offerXtproposed by the opponent at instant t, the team member emits a positive vote in the unanimity voting process if it reports a utility greater than or equal to its current demandssa(t). Otherwise, a negative vote is emitted.(6)aca(Xt)=trueifsa(t)⩽Ua(Xt)falseotherwiseAs documented in Section 3.2, team members interact at three points during the offer proposal. First, they propose an unpredictable partial offer to the team mediator. Since each team member a has its demands regulated by a time-based tactic, when proposing an unpredictable partial offer to the mediator at instant t, the proposed unpredictable partial offerXa′tfulfills:(7)Xa′t∉FA∧(Ua(Xa′t)+maxPRa⩾sa(t))Hence, agent a selects an unpredictable partial offer which is not forbidden inside the team (since it will be ignored by the team mediator) and whose utility allows him to achieve or surpass its current demands at time t. This way, the team member assures that if its proposed unpredictable partial offer is the winner of the Borda voting process, it can reach its current demands. However, one should be aware that many unpredictable partial offers may fulfill Eq. (7). Therefore, it is necessary to select one of them as the proposed candidate. Being our basic team member, from the set of partial offers that fulfill Eq. (7), a team member selects one of the candidates randomly.The second time that a team member interacts with the team mediator is for scoring unpredictable partial offers that have been proposed by team members. For scoring candidate partial offers in the Borda voting process, a basic team member orders the candidates according to the partial utility reported by each of the candidates. That is, the team member assigns the highest score to the partial offer whose utility is the highest for itself, and the second highest score to the partial offer whose utility is the second best one, and so forth.Finally, team members also interact with the mediator during the mechanism used to set predictable and compatible issues. When team members are asked about a value for issue j, each team member communicates anonymously the valuexa,j. The value is the one that, given the current partial offerXA′t, gets the utility of the new partial offer as close as possible to its current aspirationsa(t). Taking normalized additive utility functions, it can be calculated as:(8)xa,j=argmaxVa,j(x)x∈DjifUa(XA′t)+wa,j⩽sa(t)argminVa,j(x)otherwisex∈Dj∧wa,jVa,j(x)⩾(sa(t)-Ua(XA′t))wheresa(t)is the utility demanded by the agent a at roundt,Ua(XA′t)is the utility reported by the current partial offer, andwa,jVa,j(x)is the weighted utility reported by the value demanded by the agent. The value asked for issue j is the closest one to the current demands of the agent. On the one hand, if the agent cannot reach its current demands by just setting issue j, it asks for the value that reports the highest utility. On the other hand, if the agent can reach or surpass its current demands by setting j, it asks for the value that makes the new partial offer the closest to the current demands. In the same iterative process, team members still have to declare whether or not they are satisfied with the different partial offers that are constructed. Team members follow a similar criterion to the method proposed to determine if an opponent offer is acceptable at t. Basically, a partial offer is acceptable for an agent a at t if it reports a utility greater than or equal to the aspiration level marked by its concession strategy:(9)aca′(XA′t)=trueifUa(XA′t)⩾sa(t)falseotherwisewhere true indicates that the partial offer is acceptable at its current state for agent a, and false indicates the opposite.The Bayesian-based negotiation strategy for a team member is based on modeling the team’s (as a whole) and its opponent’s preferences on unpredictable issues, and acting accordingly. For this purpose, two Bayesian models are employed to predict if unpredictable partial offers are acceptable for both teammates and the opponent. One of the Bayesian models is employed to capture the preferences of the team on unpredictable issues, whereas the other is used for capturing the preferences of the opponent on unpredictable issues. The strategy used to evaluate the opponent’s offer is the same as the one described in the basic strategy.Bayesian learning is a probabilistic learning method based on Bayes’ theorem (Russell and Norvig 2003). Given a certain set of hypothesis H and some observation e, Bayesian learning attempts to compute the probabilityp(h∣e)that a certain hypothesis h is true after observing e. In our case, we want to determine whether or not the proposed offer will be acceptable for the opponent (or the team) (H={acc,≠gacc})given a certain unpredictable partial offer (e=X′t) where acc stands for “acceptable” and≠gaccstands for “unacceptable”.Since we assume that there is no interdependence among negotiation issues, we can consider that each negotiation issue contributes individually to the acceptability of an offer/unpredictable partial offer. Thus, applying Bayes’ theorem under independence assumption we have:(10)p(acc∣X′t)=p(acc)∏j∈UNp(xj∣acc)∑H∈{acc,¬acc}p(H)∏j∈UNp(xj∣H)wherep(acc)is the prior probability for an unpredictable partial offer to be acceptable,p(≠gacc)is the prior probability for an unpredictable partial offer to be non-acceptable, andp(xj∣acc)is the conditional probability that assumingX′tas acceptable, it has the value of the j issues instantiated toxj.We consider positive examplesSaccas those examples that correspond to the acceptable hypothesis (acc) and negative examplesS¬accas those examples that correspond to the not acceptable hypothesis (≠gacc). For the opponent’s model, we employ unpredictable partial offers that have appeared in opponent’s offers as positive examples, and unpredictable partial offers that appear in offers rejected by the opponent as negative samples. For the team’s model, we useFAand those opponent’s offers rejected by team members as the set of negative examples. Winners in the Borda votings (i.e., unpredictable partial offers contained in offers sent to the opponent) are considered as positive examples. For computingp(xj∣h), we use the proportion between the number of times thatxjappears in hypothesis h (acc or≠gacc) and the total number of examples for h:(11)p(xj∣h)=#{xj∈Sh}∣Sh∣The reasons for employing Bayesian learning are varied. The most important one is that it allows online updating of the model as new samples become available. This is important in a process like negotiation, where at each interaction new information becomes available regarding the opponent’s/teammates’ preferences. If a computationally expensive learning mechanism was used, it would not be possible to include the new information in the model as it becomes available. Furthermore, the learning mechanism is computationally cheap since it mainly involves counting. This is also important in a real application since it allows for simultaneous negotiation threads to exist, which should be maintained with different opponents to look for the best alternatives in an electronic marketplace.Bayesian models are employed to help in the selection of the unpredictable partial offer that is proposed to the other team members. Bayesian team members propose at t unpredictable partial offers in the set defined in Eq. (7). Bayesian models help to select a candidate from that set.However, it is reasonable to think that in the first interactions Bayesian model do not accurately represent other agents’ preferences. For that purpose, a team member invests part of the negotiation timetexpin exploring the negotiation space and collecting information regarding the opponent’s and the team’s preferences. As long as the negotiation process has not surpassedtexp, the team member just selects randomly one of candidate unpredictable partial offers as basic team members do. Meanwhile, the Bayesian models are continuously updated with the new information that becomes available during the negotiation. After reaching the time threshold, the team member starts to use Bayesian models in order to select the unpredictable partial offer to be proposed to the mediator during the offer proposal phase. The heuristic used in the selection of the candidate is proposing an unpredictable partial offer that is both acceptable for the team and the opponent. The model has an additional parameter namedpesc. It represents the probability of avoiding the Bayesian proposal model and using the random proposal model as described in the basic team member model when the negotiation time has gone beyondtexp. This parameter is included in the model in order to: (i) further explore the negotiation space; (ii) escape from local optima induced by inaccurate Bayesian models (e.g., wrong samples, limited number of samples, etc.). We can formalize the selection as follows:(12)Xa∣t=argmaxX∈B∑wbpb(acc∣X)b∈{A,op}ifrand⩽pesc∧t⩾texprandom_partial_offer(B)otherwisewhere B is the set of candidate unpredictable partial offers that fulfill Eq. (7), rand is a random number,pA(acc∣X)is the probability for a candidate unpredictable partial offer to be acceptable for the team,popp(acc∣X)is the probability for the candidate unpredictable partial offer to be acceptable for the opponent, andwAandwop1wA+wop=1.1represent the weights given to the acceptability of the unpredictable partial offer for the team and the opponent, respectively (i.e., we will refer to them as Bayesian weights). Varying these Bayesian weights allow team members to show different behaviors depending on their inclination to satisfy either the team or the opponent with the unpredictable partial offer.As stated in the introduction, one of our research goals is proposing a negotiation team model that is able to guarantee unanimously acceptable team decisions. Next, we show that under the assumption of rationality,2Rational agents seek to improve their current welfare. Thus, they would not take actions that lead to utilities below their reservation utilities.2team members are able to achieve unanimously acceptable final agreements, if an agreement is found. For that matter, let us employ reductio ad absurdum (reduction to absurdity).If X is the final agreement, let us suppose that Eq. (2) (unanimously acceptable) is violated in a negotiation: unanimity is not reached because a obtained a utility below its reservation utility.(13)∃a∈A,Ua(X′t)+∑j∈PRwa,jVa,j(xj)<RUaThe final agreement is found when (1) team members accept an opponent’s offer or (2) the opponent accepts a team’s offer. Next, we show that in both cases, Eq. (13) is never true.1.When the team members accept an opponent’s offer, a unanimity voting process has been carried to decide whether or not to accept the final offer. The offer is only accepted if all of the team members have emitted a positive vote. Since a rational agent a would never have incentive to emit a positive vote of the offer reported a utility below its reservation utility, this scenario is never true due to the intra-team mechanism.When the opponent accepts a team’s offer X, this offer has been necessarily proposed by the intra-team mechanism mentioned in Section 3.2.2. The offer can be decomposed into an unpredictable partial offerX′tand the instantiation of predictable issues. The team member a is not able to get over its reservation utility if and only ifX′t∈Faor whenX′t∉Faand a could not get what it demanded in predictable issues. A rational agent has no incentive to exclude a forbidden unpredictable partial offerX′twhen declaringFa. SinceFA=⋃a∈AFaand the mediator ignores unpredictable partial offers inFA, an unpredictable partial offerX′tthat forms a team offer is never inFa. IfX′t∉Fathen the agent can accomplish to satisfy the following expressionUa(X′t)+maxPRa⩾RUa. Agent a could not get over its reservation value because he could not demand the most of predictable issues. However, when the team mediator aggregates predictable issues inside the team, the team mediator selects the highest value for team members in the list of values proposed by them. This makes possible for a to obtain the maximum utility from predictable issues. Hence, Eq. (13) never holds if the negotiation ends with agreement.Since both possible scenarios are never true under our initial assumption, we have shown by reduction ad absurdum that, if a final agreement is found, it is unanimously acceptable among team members. Another issue is the presence of exaggerating agents (i.e., agents that exaggerate to get the most from the negotiation). In our setting, even if team members exaggerate and decide to include inFaunpredictable partial offers that are acceptable but report low utility, or demand more than they need from predictable issues, if a final agreement is found it will be unanimous among team members. However, by doing so, they may be pruning negotiation space and lowering the probability of finding agreements. This is an interesting situation that we plan to study in the future.

@&#CONCLUSIONS@&#
In this article we have presented a new mediated team negotiation model for a team as a multi-individual party negotiating with an opponent in the alternating offers protocol. The present model is capable of assuring unanimously acceptable agreements for all of the team members. It takes advantage of the categorization of negotiation issues as predictable and compatible, and unpredictable. The former are those issues whose preferential order over issue values is known from the negotiation domain and it is common among team members (e.g., price in a team of buyers), whereas the latter are those issues whose preferential order over issues values is not known in the negotiation domain. In the case of predictable and compatible issues, there is full potential for cooperation among team members since if one of the team members demands more from the issue, the other team members are also benefited. Our negotiation model takes advantage of this property. During the pre-negotiation, each team member shares with a team mediator those unpredictable partial offers (i.e., partial offers that have all of the unpredictable issues instantiated) that, even if the team demands the most from predictable issues, preclude the agent from achieving its reservation value. A joint list forbidden unpredictable partial offers is constructed by the team mediator from the lists received from the team members. In the negotiation, the team mediator coordinates a unanimity voting process to decide whether or not to accept offers received from the opponent. As for the mechanism employed to decide on which offer should be sent to the opponent, the team mediator coordinates two processes: a proposing and voting process where each team member suggests an unpredictable partial offer not included in the forbidden list followed by a Borda voting on candidates received, and an iterated process where predictable issues are set issue per issue attending to the demands of the team members.We have proposed two different types of team members for the current model: a basic team member that proposes unpredictable partial offers during the negotiation solely guided by its own utility function, and a Bayesian team member that suggests unpredictable partial offers based on the preferences of the team and the preferences of the opponent. Results have shown that, as long as preferential conflict is present in the team, team members have an incentive to employ the Bayesian strategy over the basic strategy. In any case, we have shown that both approaches outperform other existing models for negotiation teams. Moreover, we have determined that when two negotiation teams face each other, both teams benefit from including Bayesian team members in the negotiation. Finally, we have shown that team members may benefit from playing higher reservation utilities against conceders, matchers and inverters. Nevertheless, setting high reservation utilities may become the worst option as team members’ preferences are more dissimilar and the opponent plays a competitor strategy.The topic of agent-based negotiation teams remains largely unexplored compared to negotiation involving single individual parties. The present work has focused on agent-based negotiation teams where team members have different preferences but they share the same knowledge regarding the negotiation domain. One potential area of research is modeling negotiation teams where team members differ in their knowledge of the negotiation domain and their skills related to the negotiation process. As another line of future work, one could consider the problem of forming negotiation teams based on the individual list of unpredictable partial offers. Lists that are more similar may suggest team members that are more similar, which, if put together in the same team, may result in more cooperative teams. Related to team formation, dynamic negotiation teams where team members may join and leave the team during the negotiation can be considered an alternative line of research.