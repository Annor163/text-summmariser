@&#MAIN-TITLE@&#
Dimension of trivariate C

@&#HIGHLIGHTS@&#
We introduce bipyramid cells inR3.We improve the lower bound on the dimension ofC1splines for bipyramids.We derive a new upper bound that is equal to the known lower bound in most cases.We use tools from algebraic geometry and Bernstein–Bézier analysis.

@&#KEYPHRASES@&#
Bipyramid,Dimension,Trivariate spline,Cell,Supersmoothness,

@&#ABSTRACT@&#
We study the dimension of trivariateC1splines on bipyramid cells, that is, cells withn+2boundary vertices, n of which are coplanar with the interior vertex. We improve the earlier lower bound on the dimension given by J. Shan. Moreover, we derive a new upper bound that is equal to the known lower bound in most cases. In the remaining cases, our upper bound is close to the known lower bound, and we conjecture that the dimension coincides with the upper bound. We use tools from both algebraic geometry and Bernstein–Bézier analysis.

@&#INTRODUCTION@&#
Smooth piecewise polynomial functions, or splines, are used widely in approximation theory, computer aided geometric design, image analysis, and numerical analysis. Key tools for analyzing multivariate spline spaces come from two fields: classical approximation theory and applied algebraic geometry. The two fields and the two corresponding research communities use entirely different approaches: Bernstein–Bézier analysis (see the survey of Alfeld, 2016, in this issue) and homological techniques (see the survey of Schenck, 2016, in this issue). For a full treatise on Bernstein–Bézier analysis, we refer the reader to Lai and Schumaker (2007). The homological approach to multivariate splines is explained in several papers, see Mourrain and Villamizar (2014), Schenck and Stilman (1997) and Billera (1988).In this paper we are concerned with trivariate splines. LetPddenote the set of polynomials in three variables of degree ≤d. A spline is a piecewise-polynomial function defined on a domainΩ⊂R3that belongs to a certain smoothness class. More precisely, for a fixed tetrahedral partition Δ of the underlying domain Ω, our spline space of interest is defined as(1)Sdr(Δ)={s∈Cr(Ω):s|T∈Pdfor each tetrahedronT∈Δ}.Finding the exact dimensions of spacesSdr(Δ)of trivariate splines remains an open problem. While the dimension of any particular spline can be computed using software such as Macaulay2, or the java applet (Alfeld), general formulae are still unknown. This problem is inherited from bivariate splines, where the dimension remains unknown ford≤3r+1. As it is shown in section 17.8 in Lai and Schumaker (2007), there is a tight connection between trivariate and bivariate cases, and there is no hope to resolve the trivariate case before the dimension of bivariate splines is known for all values of d and r. We note that despite this difficulty, the dimensions of trivariate splines are known for few very special partitions, including the so-called macro-element or finite-element spaces. For example, trivariate splines on the Alfeld, the Clough–Tocher and Worsey–Piper splits, see Lai and Schumaker (2007) and references therein. Other examples do not qualify as finite-element spaces, but are built on very special grids, see Schumaker and Sorokina (2004) for an example. The first and only formula for a dimension of a trivariate spline space on a tetrahedral partition of a somewhat general nature is for the so-called oranges, see Theorem 17.30 in Lai and Schumaker (2007). An orange, see Fig. 1, is a union of tetrahedra all sharing the same edge,[u,v]in Fig. 1, and pairwise sharing common triangular faces. The goal of this paper is to provide a second example of such a general formula for a partition that we call a bipyramid cell, see Fig. 2. A bipyramid cell is a special case of the so-called interior cell. An interior cell is a collection of tetrahedra all sharing an interior vertex (cf. Section 17.8.1 in Lai and Schumaker, 2007). Note that a bipyramid cell is very different from an orange. An orange is not an interior cell, and all smoothness conditions associated with it are essentially bivariate. The smoothness conditions associated with the bipyramid cell include purely trivariate ones. Because of this difficulty, we have been able to analyze the case forr=1in (1) only.A large part of research in the area of trivariate splines has focused on obtaining upper and lower bounds on the dimension of trivariate spline spaces. Several results have been obtained for bounding the dimension of general splines either below or above, see Mourrain and Villamizar (2014), Lau (2005), Alfeld and Schumaker (2008), Alfeld (1996), and Shan (2014). None of the bounds cited above are tight enough to obtain exact dimensions. In this paper, we prove new upper bounds for the bipyramid cells that allow us to obtain exact dimensions in three out of four subcases; in the last subcase our new upper bound is very close to the known lower bound, and we conjecture that the dimension is equal to the upper bound.Finally, we prove that the lower bound in Shan (2014) has a typo; fixing this leads to an improved lower bound. We compare the improved lower bound to our new upper bound. The lower bound is obtained using homological techniques, while the upper bound is proved using Bernstein–Bézier analysis.The paper is organized as follows. In Section 2 we introduce bipyramid cells, and study their geometry. In Section 3 we fix the bound in Shan (2014), and derive the lower bound for the dimension ofSd1(Δ)on bipyramid cells. In Section 4 we prove a result on supersmoothness needed to obtain our new upper bound. Section 5 contains several results on the dimension of bivariate splines that are also needed to derive the new upper bound. The main results of this paper concerning the new upper bound and the exact dimension ofSd1(Δ)on bipyramid cells are in Section 6. We conclude with remarks and conjectures in Section 7.To begin, we define a class of partitions inR3called bipyramid cells, see e.g. Fig. 2.Definition 2.1A bipyramid cell is a tetrahedral partition Δ such that:•there is exactly one interior vertexv0;n boundary verticesv1throughvnare coplanar along withv0, and form a polygon surroundingv0in the base planeB:=[v1,…,vn];each vertexvi,i=1,…,n, is connected tov0by the interior edges[v0,vi];two boundary verticesvn+1andvn+2lie outside the base plane B, are on opposite sides of B, and are connected tov0by the interior edges[v0,vn+1]and[v0,vn+2]; andverticesvn+1andvn+2connect to the boundary verticesvi,i=1,…,n.It is easy to check that these conditions force Δ to be shellable with no holes or cavities, see Lai and Schumaker (2007) for a discussion of the importance of these facts. For simplicity, and without loss of generality, we can assume that the interior vertexv0is located at the origin, and the n coplanar boundary vertices lie in the base xy-plane. For the remainder of this paper, we will assume that Δ is a bipyramid cell. Our goal is to find the dimension of the spline spaceSd1(Δ). The next lemma summarizes several immediately obvious facts about Δ.Lemma 2.2In a bipyramid cell the following holds:(1)there are 2n tetrahedra, 3n interior triangular faces, andn+2interior edges;the number of different slopes m formed by the coplanar interior edges[v0,vi],i=1,…,n, in the base plane satisfies2≤⌈n2⌉≤m≤n; andthe number of distinct planes h containing the interior triangular faces is as follows:Case 1 (Generic):vn+1andvn+2are not collinear withv0, and the plane containingvn+1,vn+2andv0does not contain any othervi. Thenh=2m+1;Case 2 (Coplanar):vn+1andvn+2are not collinear withv0, and the plane containingvn+1,vn+2andv0contains at least one othervi,i=1,…,n. Thenh=2m;Case 3 (Collinear):vn+1andvn+2are collinear withv0. Thenh=m+1.For further investigation, we split the coplanar case into two subcases as follows:• Coplanar Case I:vn+1andvn+2are not collinear withv0, and the plane containingvn+1,vn+2andv0contains exactly one othervi,i=1,…,n.• Coplanar Case II:vn+1andvn+2are not collinear withv0, and the plane containingvn+1,vn+2andv0contains exactly two othervi,i=1,…,n.Fig. 2 shows an example of the collinear case; Fig. 3shows an example of the coplanar case II, where verticesv0,v2,v4,v7,v8lie in the same plane (shaded). Fig. 4shows an example of the generic case, and finally Fig. 5shows an example of the coplanar case I. Next, we need to classify small values of h for the results in the next section. Ifh≥6, the results in the next sections do not require knowledge of the particular geometry of Δ. Since in the collinear case we will compute the dimension ofSd1(Δ)without using any lower bounds, the following lemma is stated for the non-collinear cases only.Lemma 2.3In a bipyramid cell with non-collinearv0,vn+1andvn+2, the following holds:Ifh=4, then it is the coplanar case II withm=2, andn=4.Ifh=5, then it is the generic case withm=2, andn=4.ProofIfh=3, then we must be in the collinear case whereh=m+1,m=2, andn=4. Thenv5andv6are collinear withv0, and there are only two different slopes. Thus, the partition must form an octahedron whose main diagonals intersect at the interior vertexv0.Ifh=4, then we have two possibilities. One possibility is the coplanar case II withh=2m,m=2, andn=4. The base vertices form a quadrilateral where opposite vertices are collinear withv0. The verticesv5,v6andv0are not collinear, and the plane containingv5,v6, andv0also contains two oppositevi. The other possibility is the collinear case withh=m+1,m=3, and3≤n≤6. Thenvn+1andvn+2are collinear withv0, and there are three different slopes in the base plane.Ifh=5, then we have two possibilities. One possibility is the collinear case withh=m+1, withm=4and4≤n≤8. In this case,vn+1,vn+2andv0are collinear. The other possibility is the generic case withh=2m+1withm=2, andn=4. Thenv5andv6are not collinear withv0, and the plane containingv5,v6, andv0does not contain any other vertices. This is another octahedral case.  □Results in this section follow from both Mourrain and Villamizar (2014) and Shan (2014). We use the terminology from the latter since it is better suited for our partition. Remark 7.1 in Section 7 shows how to use Mourrain and Villamizar (2014) to obtain the lower bound of this section. To simplify the notation in Shan (2014), we introduce the quantityJ(h,k), which depends on the number of distinct planes h, containing the interior triangular faces, and a parameter, k, that runs from 0 to the degree of the spline, d. For a ring R of trivariate polynomials, we defineJ(h,k)to be the dimension of the graded module(R/J)k, where J is the ideal generated by the squares of the linear forms which define the h distinct planes passing through the interior vertexv0, and k is the degree of the polynomials, see the survey of Schenck (2016) in this issue for additional information on the module.Lemma 3.1In a bipyramid cell with non-collinearv0,vn+1andvn+2, the following holds:J(h,0)=1for anyh;J(h,1)=3for anyh;J(4,2)=2;J(5,2)=1;J(h,k)=0otherwise.ProofWe first reproduce the more general result for cells that appears in Shan (2014), changing to our notation:J(h,0)=1,for anyh,J(h,1)=3,for anyh,J(3,k)={3,ifk=2,1,ifk=3,0,ifk≥4;J(4,k)={2,ifk=2,0,ifk≥3;J(5,k)={1or2,ifk=2,0,ifk≥3.J(h,k)=0,for anyk≥2,h≥6.Note that, in the more general case covered in Shan (2014),J(5,2)is multi-valued. For bipyramid cells, it follows from Lemma 2.3 that the only case withh=5is the generic case. In this case, after a change of variables, we haveJ=〈x2,y2,z2,(z−αx)2,(z−βy)2〉, for some non-zeroα,β∈R. Clearly,dim(R/J)2=1=J(5,2). We next note that, for all bipyramid cases except the collinear one, the minimal number of generators of J is equal to either the number of distinct planes containing the interior triangular faces (i.e. h), or 6 ifh>6. Since we do not discuss the collinear case in this lemma, this completes the proof.  □Remark 3.2It is easy to see that in the collinear case, the line formed byvn+1,v0, andvn+2might be shared by an arbitrarily large number of planes. However, in this case J cannot be six-generated, as it is claimed in Shan (2014). In Section 6, we obtain the exact dimension of trivariate splines on bipyramids in the collinear case without referring to any lower bounds. Therefore, we omit the discussion of a lower bound for this case.We next discuss the lower bound for splines on any cell proved in Shan (2014). Letfidenote the number of i-dimensional interior faces of the partition:f3is the number of tetrahedra,f2is the number of interior triangular faces, andf1is the number of interior edges. Additionally, lethebe the number of planes containing all triangular faces attached to the edge e, letf1,2be the number of interior edges withhe=2, letf1,3be the number of interior edges withhe=3, and letf1,4be the number of interior edges withhe≥4. The following bound is proved in (Shan, 2014):Theorem 3.3If Δ is a cell,dim⁡Sd1(Δ)is bounded below asdim⁡Sd1(Δ)≥(f3−f2+f1)(d+33)+(f2−2f1,2−3f1,3−3f1,4)(d+13)+2(f1,3+f1,4)(d3)+f1,2(d−13)−∑k=0dJ(h,k).Next we apply Theorem 3.3 to the case of bipyramid cells. From Lemma 2.2, we know thatf3=2n,f2=3n,f1=n+2,andf1,3+f1,4=n+2−f1,2.We can thus rewrite the bound in Theorem 3.3 as followsdim⁡Sd1(Δ)≥2(d+33)+(f1,2−6)(d+13)+(2n+4−2f1,2)(d3)+f1,2(d−13)−∑k=0dJ(h,k).Applying a variety of combinatorial identities, Lemma 2.3 and Lemma 3.1, we obtainCorollary 3.4Let Δ be a bipyramid cell. Then ford≥2the following holds:dim⁡Sd1(Δ)≥6d−2+f1,2(d−1)+2n(d3)−∑k=2dJ(h,k).In the coplanar case I we havef1,2=1,h≥6. Thusdim⁡Sd1(Δ)≥7d−3+2n(d3).In the coplanar case II, ifm≥3, thenf1,2=2, andh≥6. Ifm=2, thenf1,2=4andh=4. Thusdim⁡Sd1(Δ)≥2n(d3)+{10d−8,ifm=2,8d−4,ifm≥3.Moreover, in the generic case ifm≥3, we havef1,2=0. Ifm=2, thenf1,2=2. Thusdim⁡Sd1(Δ)≥2n(d3)+{8d−5,ifm=2,6d−2,ifm≥3.Corollary 3.4 can be obtained from Mourrain and Villamizar (2014) as well, see Remark 7.1.The result in this section is essential for obtaining our upper bound in Sections 5 and 6. We use the notation of Definition 2.1, and square brackets for the convex hull. As in Lai and Schumaker (2007), a bivariate (interior) cell is a collection of triangles all sharing an interior vertex.Theorem 4.1Any spline s in the spaceSd1(Δ)of trivariateC1splines on a bipyramid with the baseB:=[v1,…,vn]and interior vertexv0∈Bhas the following supersmoothness: if a vertexvi,1≤i≤n, is not coplanar with[v0,vn+1,vn+2], then all derivatives of s of order two across[v0,vi]in any direction coplanar with B are continuous.ProofWe first note that ifv0is collinear withvn+1andvn+2, then there is a plane containingv0,vn+1,vn+2andvi, for any of the remainingvi. Thus, we letv0be not collinear withvn+1andvn+2. Without loss of generality, letv5be not coplanar with[v0,vn+1,vn+2], see Fig. 4. Fix an arbitrary pointu5in the interior of the edge[v0,v5], and consider any cross-section of the double pyramid by a plane passing throughu5, parallel to[v0,vn+2], and not containing[v0,v5]. In Fig. 4, it is the quadrilateral[u1,u6,u4,u7]. Such a cross-section contains a bivariate cell Q with the interior vertexu5and four interior edges. Two of them lie in B and are collinear, and the other two are not collinear. In Fig. 4, the collinear ones are[u5,u1]and[u5,u4], while[u5,u6]is parallel to[v0,v6]by construction, and thus[u5,u7]is not collinear with[u5,u6].It clearly suffices to prove that the bivariate splines˜=s|Qhas supersmoothness two atu5in the direction of the two collinear edges. In Fig. 4, we need to prove thats˜has a second order continuous derivative atu5in the direction[u5,u1]. The required supersmoothness immediately follows from Theorem 3.2 in Sorokina (2010). Sinceu5is an arbitrary point on the edge[v0,v5]such bivariate supersmoothness holds across the whole edge[v0,v5].To complete the proof, we note that ifviis coplanar with[v0,vn+1,vn+2], as in Fig. 5v1is coplanar with[v0,v6,v7], then Q is formed by two pairs of collinear edges. In Fig. 5,u6,u1,u7are collinear, and so areu2,u1andu5. The bivariate splines˜=s|Qdoes not have continuous second order derivatives in either direction atu1, see e.g. section 4 of Sorokina (2010). Thus, the non-coplanarity condition on the statement of the theorem is essential.  □To prove our upper bound in the next section, we need to compute the dimension of bivariateC1splinesSk1(ΔB)over the triangulationΔBof the base B of the bipyramid,0≤k≤d. We note thatΔBis an interior bivariate cell, i.e., a collection of triangles sharing the interior vertexv0.Lemma 5.1LetΔBbe a bivariate cell with n edges and m slopes. Then(2)dim⁡S01(ΔB)=1,dim⁡S11(ΔB)=3,and fork≥2,dim⁡Sk1(ΔB)={4+4(k2),ifm=2,3+n(k2),ifm≥3.ProofClearly, splines inS01(ΔB)andS11(ΔB)are bivariate polynomials whose dimensions are 1 and 3, respectively. Using Theorem 9.3 from Lai and Schumaker (2007) (originally proved in Schumaker, 1979), fork≥2, we obtain(3)dim⁡Sk1(ΔB)=3+n(k2)+∑j=1k−1(2−j(m−1))+.We next simplify (3) for various values of m. Ifm=2, thenn=4and∑j=1k−1(2−j(m−1))+=∑j=1k−1(2−j)+=1.Ifm≥3, then2−j(m−1)≤0⇔2≤j(m−1). Since j starts at 1 andm≥3, the minimum value ofj(m−1)is 2, so the inequality is always true. Therefore(2−j(m−1))+=0, so the sum evaluates to 0, and the result follows.  □Fork=d, due to additional supersmoothness described in Theorem 4.1, we can no longer use Theorem 9.3 in Lai and Schumaker (2007). LetSd1,⁎(ΔB)be the restriction ofSd1(Δ)on B, i.e., the subspace ofSd1(ΔB)with the supersmoothness described in Theorem 4.1. It then follows from Theorem 9.25 in Lai and Schumaker (2007) that(4)dim⁡Sd1,⁎(ΔB)=∑i=1n∑j=2d(j−ri)+3+∑j=2d(j+1−ϵj)+,whereriis the smoothness across the edge[v0,vi],ϵj:=∑i=1nmi,j, andmi,j:={0,if there existslwithαi=αlandrl<ri,0,if there existsl>iwithαi=αlandrl=ri,j−ri,otherwise.We next simplify (4) further by considering each case of Section 2.Lemma 5.2LetΔBbe a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and letSd1,⁎(ΔB)be the restriction ofSd1(Δ)on B. In the generic case,dim⁡S21,⁎(ΔB)=6,dim⁡S31,⁎(ΔB)=12, ifm=2and for all remaining casesdim⁡Sd1,⁎(ΔB)={9+4(d−12),ifm=2∧d≥4,7+n(d−12),ifm=3∧d≥3,6+n(d−12),ifm≥4.ProofIn this case, Theorem 4.1 yieldsri=2, for alli=1,…,n, andϵj=m(j−2)for allj≥2. Substituting the values forϵjandriin (4), we obtaindim⁡Sd1,⁎(ΔB)=∑i=1n∑j=3d(j−2)+3+∑j=2d(j+1−m(j−2))+=n(d−12)+6+∑j=3d(2m+1−j(m−1))+.Sincem≥2, we have2m+1−j(m−1)≤0⇔2m+1≤j(m−1)⇔j≥2+3m−1.Since j starts at 3, oncem≥4, the inequality is always true. Therefore,(2m+1−j(m−1))+=0ifm≥4, and the casesm=2andm=3must be computed separately. Ifm=3, thenj=3is the only positive term and∑j=3d(2m+1−j(m−1))+=1. Ifm=2, we have two non-negative termsj=3, andj=4, and∑j=3d(2m+1−j(m−1))+=3.Ford=2, the dimension formula yields∑i=1n∑j=22(j−ri)+3+∑j=22(j+1−m(j−2))+. Sinceri=2for all i, andj=2, the first sum is a summation of zeros, and the second summation has only one term, namely(2+1−m(2−2))+=3. Therefore, the dimension is 6.Ford=3, the dimension formula gives∑i=1n∑j=23(j−ri)+3+∑j=23(j+1−m(j−2))+. Again, sinceri=2for all i, the double summation becomes∑i=1n(3−2)=n. The second sum is equal to3+(4−m)+, so the value depends on m. Considering the casesm=2,m=3, andm≥4completes the proof.  □Lemma 5.3LetΔBbe a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and letSd1,⁎(ΔB)be the restriction ofSd1(Δ)on B. In the first coplanar case I, we havedim⁡Sd1,⁎(ΔB)=(d2)+(n−1)(d−12)+5.In this case, the plane containingvn+1,vn+2, andv0contains exactly one boundary vertex of B. Without loss of generality, assume that it isv1. Then Theorem 4.1 yieldsri:={1,ifi=1,2,if2≤i≤n.Moreover,ϵj=(j−1)+(m−1)(j−2), for allj≥2. We substitute the values forϵjandriin (4)dim⁡Sd1,⁎(ΔB)=∑j=2d(j−1)+∑i=2n∑j=3d(j−2)+3+∑j=2d(2−(m−1)(j−2))+=(d2)+(n−1)(d−12)+5+∑j=3d(2m−j(m−1))+.Sincem≥3, we have2m−j(m−1)≤0⇔2m≤j(m−1)⇔j≥2+2m−1.Since j starts at 3 andm≥3, the inequality is always true. Therefore,(2m−j(m−1))+=0, and the result follows.  □Lemma 5.4LetΔBbe a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and letSd1,⁎(ΔB)be the restriction ofSd1(Δ)on B. In the second coplanar case II,dim⁡S21,⁎(ΔB)=7, and ford≥3, we havedim⁡Sd1,⁎(ΔB)=2(d2)+(n−2)(d−12)+{6,ifm=2,5,ifm≥3.ProofIn this case, the plane containingvn+1,vn+2, andv0contains exactly two boundary vertices of B. Without loss of generality, assume they arev1andv2, and they are collinear withv0. Then Theorem 4.1 yieldsri:={1,ifi=1ori=2,2,if3≤i≤n.Moreover,ϵj=(j−1)+(m−1)(j−2), for allj≥2. Note thatϵjdoes not change between coplanar cases I and II, but the difference inrimust be taken into account for the first part of the formula. Another difference with the previous case is that the value ofr2=1. Thusdim⁡Sd1,⁎(ΔB)=2∑j=2d(j−1)+∑i=3n∑j=3d(j−2)+3+∑j=2d(2−(m−1)(j−2))+=2(d2)+(n−2)(d−12)+5+∑j=3d(2m−j(m−1))+,and the result follows ford≥3. Whend=2, the double summation has only two non-zero terms of 1, sodim⁡S21,⁎(ΔB)=2+3+2=7.  □In the collinear case, there is no supersmoothness associated with the base cell and one can use Lemma 5.1 to compute the dimension.Lemma 5.5LetΔBbe a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and letSd1,⁎(ΔB)be the restriction ofSd1(Δ)on B. In the collinear case, we havedim⁡Sd1,⁎(ΔB)=n(d2)+{4,ifm=2,3,ifm≥3.In this section we obtain a new upper bound using the results from Section 5 with the help of Bernstein–Bézier methods (see the survey of Alfeld, 2016 for the terminology). The advantage of this upper bound over the upper bound of Mourrain and Villamizar (2014) is that our upper bound does not require knowing a priori that the module ofCrsplines over bipyramids is free. We start by defining levels in a bipyramid.Definition 6.1LetB:=[v1,…,vn]be the base,v0be the interior vertex, andvn+1,vn+2be the two remaining vertices of a bipyramid. The k-th level of Δ (denotedΔk) is the cross-section of Δ by the plane parallel to B and passing through the point{(d−k)v0+kvn+1d,if0≤k≤d,(d+k)v0−kvn+2d,if−d≤k<0.EachΔkis a bivariate cell of the same geometry as the base cellΔB=:Δ0. To explain the method, we first note that all domain points ofs∈Sdr(Δ)can be placed on the2d+1levels parallel to the base B. Clearly, if we simply ignore all smoothness conditions involving domain points from different levels and consider each level separately, the dimension ofSd1(Δ)can only decrease. Thus, we obtain the following upper bound on the dimension of splines over bipyramids(5)dim⁡Sd1(Δ)≤∑k=−dddim⁡Sd−|k|1(Δk),whereSd−|k|1(Δk)is the space of bivariate splines of degreed−|k|and smoothness 1 overΔk. We then note that the bound (5) can be immediately improved. First, if we set all coefficients corresponding to the domain points in the levelsΔ0, andΔ1, then all coefficients associated with the levelΔ−1are defined byC1smoothness conditions across the base B. SinceΔkandΔ−kare simply shifts of the same bivariate cellΔB, we obtaindim⁡Sd−|k|1(Δk)=dim⁡Sd−|k|1(Δ−k)=dim⁡Sd−|k|1(ΔB),∀k,anddim⁡S01(ΔB)=1,dim⁡S11(ΔB)=3.Additionally, Theorem 4.1 combined with the results in Section 5 implies thatdim⁡Sd1(ΔB)=dim⁡Sd1,⁎(ΔB),whereSd1,⁎(ΔB)is defined in Section 5. Thus, ford≥2, the bound (5) improves to(6)dim⁡Sd1(Δ)≤{dim⁡S21,⁎(ΔB)+5,ifd=2,dim⁡Sd1,⁎(ΔB)+dim⁡Sd−11(ΔB)+2∑k=2d−2dim⁡Sk1(ΔB)+8,ifd≥3.To further simplify (6), we note that∑k=2d−2dim⁡Sk1(ΔB)=∑k=2d−2{4+4(k2),ifm=2,3+n(k2),ifm≥3.={4(d−3)+4(d3)−4(d−12),ifm=2,3(d−3)+n(d3)−n(d−12),ifm≥3.Thus, ford≥3, the bound (6) simplifies to(7)dim⁡Sd1(Δ)≤dim⁡Sd1,⁎(ΔB)+dim⁡Sd−11(ΔB)+{8d−16+8(d3)−8(d−12),ifm=2,6d−10+2n(d3)−2n(d−12),ifm≥3.We are now ready to prove the main results of our paper.Theorem 6.2Let Δ be a bipyramid cell. In the collinear case, ford≥2, the following holdsdim⁡Sd1(Δ)={8(d3)+12(d−1)+(3−d)+,ifm=2,2n(d3)+n(d−1)+6d−4,ifm≥3.ProofIn this case, the upper bound (6) is equal to the dimension since the onlyC1smoothness condition involving coefficients associated with different levels has been taken into account. As a result, ford=2, using Lemma 5.1 in the bound (6), we havedim⁡S21(Δ)={13,ifm=2,8+n,ifm≥3.Ford≥3, combining Lemma 5.5 and Lemma 5.1 in the bound (7), we obtaindim⁡Sd1(Δ)={8+4(d2)+4(d−12),ifm=2,6+n(d2)+n(d−12),ifm≥3.+{8d−16+8(d3)−8(d−12),ifm=2,6d−10+2n(d3)−2n(d−12),ifm≥3.={8(d3)+12(d−1),ifm=2,2n(d3)+n(d−1)+6d−4,ifm≥3.Combining the formulae ford=2, andd≥3completes the proof.  □Remark 7.2 shows how to extend this result to higher values of r.Theorem 6.3Let Δ be a bipyramid cell. In the coplanar case I, ford≥2, the following holdsdim⁡Sd1(Δ)=2n(d3)+7d−3.ProofFord=2, using the bound (6) and Lemma 5.3 we obtain the following upper bounddim⁡S21(Δ)≤11,which is equal to the lower bound of Lemma 3.4. We now considerd≥3. Recall thatm≠2in this case. Using Lemma 5.3 and Lemma 5.1 the bound (7), we obtain the following upper bounddim⁡Sd1(Δ)≤(d2)+(n−1)(d−12)+n(d−12)+6d−2+2n(d3)−2n(d−12)=7d−3+2n(d3).Combining the results ford=2, andd≥3, and comparing them with the corresponding lower bound in Lemma 3.4 completes the proof.  □Theorem 6.4Let Δ be a bipyramid cell. In the coplanar case II, ford≥2, the following holdsdim⁡Sd1(Δ)={8(d3)+10d−8,ifm=2,2n(d3)+8d−4,ifm≥3.ProofFord=2, using the bound (6) and Lemma 5.4 we obtain the following upper bounddim⁡S21(Δ)≤12,which is equal to the lower bound of Lemma 3.4 ifm≥3. We now considerd≥3. Using Lemma 5.3 and Lemma 5.1 the bound (7), we obtain the following upper bounddim⁡Sd1(Δ)≤2(d2)+(n−2)(d−12)+{10+4(d−12),ifm=2,8+n(d−12),ifm≥3,+{8d−16+8(d3)−8(d−12),ifm=2,6d−10+2n(d3)−2n(d−12),ifm≥3.={8(d3)+10d−8,ifm=2,2n(d3)+8d−4,ifm≥3.Combining the results ford=2, andd≥3, and comparing them with the corresponding lower bound in Lemma 3.4 completes the proof.  □Theorem 6.5Let Δ be a bipyramid cell. In the generic case, ford≥2, andm≥3, the following bounds hold2n(d3)+6d−2≤dim⁡Sd1(Δ)≤2n(d3)+6d−1+(4−m)+.Moreover, form=2, dimS21(Δ)=11, and ford≥3, the following bounds hold8(d3)+8d−5≤dim⁡Sd1(Δ)≤8(d3)+8d−3−(4−d)+.ProofIn the generic case, there are more subcases to consider following the structure in Lemma 5.2. We start withd=2. Using the bound (6), and Lemma 5.2 for the upper bound and Lemma 3.4 for the lower bound we obtain the following estimate11≥dim⁡S21(Δ)≥{11,ifm=2,10,ifm≥3.Similarly, in the cased=3, andm=2, we have27≤dim⁡S31(Δ)≤28.We now considerm=2, andd≥4. Combining Lemma 3.4 and (6) we obtain8(d3)+8d−5≤dim⁡Sd1(Δ)≤8(d3)+8d−3.Form=3, andd≥3, we obtain2n(d3)+6d−2≤dim⁡Sd1(Δ)≤2n(d3)+6d.We finally considerm≥4, andd≥3. Using (7), Lemma 5.2 and Lemma 3.4 we obtain the following tight bounds2n(d3)+6d−2≤dim⁡Sd1(Δ)≤2n(d3)+6d−1.Combining all these subcases completes the proof.  □Through the combination of homological and Bernstein–Bézier methods, we have been able to provide exact dimensions of trivariate splines on bipyramid cells in most cases, and tight bounds in one subcase. While limited to the caser=1and a specific type of partition, our hope is that the methods contained in this paper can be refined and extended to other classes of trivariate splines. We conclude the paper with several remarks.Remark 7.1Theorem 5.1 in Mourrain and Villamizar (2014) applied directly to the bipyramid case yields a weaker lower bound than the one in Shan (2014). However, working through the proof and making necessary adjustments improves the result and matches the bound in Theorem 3.3. Indeed, in the proof of Theorem 5.1 in Mourrain and Villamizar (2014) we find(8)dim⁡Sdr≥dim⁡Rk+∑i=12(−1)idim⁡⨁β∈Δ3−i0J(β)k+dim⁡⨁i=1f00J˜(γi)k,where the notation matches the one in Section 4 of Schenck (2016). In the case of a cell partition,f00=1, andJ˜(γ)=J(γ), where γ is the single interior vertex. Moreover, forr=1, and particularly in the bipyramid case, the values ofJ(γ)kcan be explicitly computed. This is exactly what is done in Shan (2014), and stated in Lemma 3.1. Using Lemma 3.1 in bound (8) in the proof of Theorem 5.1 in Mourrain and Villamizar (2014), yields the lower bound of Corollary 3.4.In the collinear case, one can easily generalize the result to an arbitrary value ofr≤d. Indeed, using the addition of the dimension associated with the bivariate layersΔk,k=−d,…,0,…,dand smoothness r across the baseΔ0we obtaindim⁡Sdr(Δ)=∑k=0rdim⁡Sd−kr(Δk)+2∑k=r+1ddim⁡Sd−kr,where each dimension can be computed using Theorem 9.3 in Lai and Schumaker (2007). Forr=1, Theorem 6.2 provides a closed-form expression for the sum. For higher values of r, the closed-form expression can be obtained as well; however, it does not look as elegant as the one of Theorem 6.2.In all examples of the generic case of Theorem 6.5 that we have checked using software, the dimension of the spline space has matched our upper bound. Per Shan (2014), when the dimension does not match the lower bound used in this paper, the implication is that∑k=0ddim⁡H2(R/J)k≠0.Remark 7.4In comparison to the upper bound of Mourrain and Villamizar (2014), if the module of splines is not known to be free, our upper bound of Section 6 is a significant improvement, though it is limited to the case of bipyramid cells. The upper bound of Mourrain and Villamizar (2014) is a powerful general tool because it can be applied in many more situations than ours.

@&#CONCLUSIONS@&#
