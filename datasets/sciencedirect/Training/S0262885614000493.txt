@&#MAIN-TITLE@&#
Global registration of large collections of range images with an improved Optimization-on-a-Manifold approach

@&#HIGHLIGHTS@&#
Goal: new approach to enable global registration of large collections of point sets.We consider an optimization-on-a-manifold for global registration of multiple scans.We evidence computational and convergence issues in the original approach.We propose computationally effective correspondence update and other improvements.Results: better accuracy compared to state-of-the-art, good computational performance.

@&#KEYPHRASES@&#
Global registration,3D scanning,Range images,Correspondence selection,Newton-type optimization,Differential geometry,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Objects and scene modeling from 3D scan data requires an accurate alignment of the acquired multiple views. In a conventional alignment pipeline [1], two consecutive alignment steps, usually called coarse (or initial) and fine (or refined), are performed on all the overlapping views. Either these steps are carried out in a pairwise fashion (with possible accumulation of alignment errors) or according to some multi-view heuristics, high quality 3D modeling requires a final optimized global registration of the whole set of views in order to further reduce and evenly distribute the residual alignment errors. Other than guaranteeing the highest alignment accuracy, this last step should also provide other desirable properties. First of all robustness, because it is not guaranteed that all views are already well aligned, e.g. when loop closure problems are to be solved. Secondly computational efficiency, where computation time becomes an issue especially for dense view and large view collections. Moreover, several advanced, specialized and professional application fields (e.g. biomedicine, orthopedics and orthodontia, cultural heritage, industrial design and reverse engineering) tend to generate large data sets (both in terms of number of views, spatial point density, as well as metric accuracy) so that the overall usability of the acquisition and processing pipeline emerges as another primary requirement.Pretty fast heuristic methods have been proposed to handle the global registration problem; the most popular one, and also a recognized reference in terms of performance, is the method proposed by Pulli [2]. However, such kind of methods cannot guarantee (as we also verify in this work) to actually minimize the alignment error, so that the views' position remains suboptimal while, as stated, maximized metric accuracy of the views' alignment is a sine qua non for the aforesaid demanding application fields. For this reason, more connatural methods for approaching the global registration problem are those that adopt some numerical optimization solutions. However, 1) the global nature of the problem can easily generate computational issues, and 2) optimization methods are to be well designed and conditioned in order to reduce the risk to be stuck in local minima or to behave incorrectly. Our proposed solution relies on the optimization over the differentiable manifold of 3D rotation matrices (i.e. the orthogonal Lie group SO(3)) [3,4], a functional theoretical framework which, however, in its early proposed global registration implementation [5,6], reveals itself not fully adequate to address the above problems 1) and 2). Our main contribution here consists of a new redesigned algorithmic approach which significantly improves the performance of the original one, demonstrating to be suitable for the most demanding modern applications in terms of convergence, accuracy, and computational performance. A hybrid approach, which combines a first heuristic-based alignment stage followed by the proposed solution, is also tested in order to further reduce the global registration time for the most demanding cases.Since the proposed solutions are designed to be used in the context of modern and high-quality 3D object modeling chains, a gentle introduction to the problem we tackle is firstly provided in Section 1.1 (which can be possibly skipped by the informed reader). Subsequently, a literature review is presented in Section 1.2. Finally, an outline of the paper concludes this introduction (Section 1.3).The possibility to create accurate 3D models of real objects is a primal asset of several application domains such as industrial reverse engineering [7] and visual inspection [8], cultural heritage preservation [9], robot localization and navigation [10], and biological and medical imaging [11]. This is increasingly influencing a number of related fields such as computer animation and augmented reality, environmental remote sensing, construction site management, e-commerce, entertainment, fashion industry, and more. When metric accuracy is a priority, the acquisition is usually made by active 3D optical devices such as laser or structured light 3D scanners which today guarantee high quality and dense point sets captured from their field of view (FoV). At the same time, the physical FoV limitation of the scanner and the spatial morphology of the objects to acquire, require the collection of several (dozen or even hundreds) views in order to build a complete 3D model of the object or the scene of interest. Starting from a collection of independent views (lying in their own local reference systems), and under proper view overlapping and object surface coverage hypothesis, the construction of a 3D model is obtained through a pipeline consisting in a series of (geometric) data processing steps, where the main objective is the registration (or alignment) in a common reference system of all views toward a unique digital model, under application-driven requirements that are usually related to accuracy, robustness, computational speed and automatism.Due to the intrinsic complexity nature of the acquired data (caused by the presence of occlusions, noise, outliers, residual distortions and variable view overlapping area) it is not viable to conceive and formalize the alignment problem according to a unique single-step, closed-form solving approach. A main distinction regards the concepts of ‘local’ and ‘global’. It is clear how the alignment problem would have a global nature as a whole, however it must be recognized that the alignment of a single view is quite a local problem, and that in most cases the acquisition of an object or the navigation of an environment follows a certain path, either decided on-the-fly or planned in advance, and this is usually linked to local decisions as well. Therefore the alignment problem can be conceived as a local-to-global approach, in that each view is registered with respect to its neighboring ones, possibly according to a specific path, with the aim of arriving to a global registration. The role of global registration is twofold: to perform an equal redistribution of residual alignment errors due to data imperfections, and to solve the closure problems that are likely to happen whenever the acquisition path turns around the object, possibly several times and through crossing paths, in order to obtain a complete coverage of the object. The typical strategy employed by well-defined, state-of-the-art approaches is to apply a local coarse alignment technique followed by a local fine alignment step, which is in turn used to initialize a global registration phase. Usually, each phase defines different problems that require distinct solving approaches. In the present work we focus on the final step of the alignment problem, that is, the global registration phase. We initially assume that we can rely on a fairly good initial alignment of the views, as the one that can ordinarily be provided by reference fine alignment techniques, e.g. those based on pairwise Iterative Closest Point solutions, being the fine alignment usually applied in a sequential pairwise order following the object scanning path. We will also strain our system by gradually releasing the strictness of the fine alignment assumption, while concurrently performing an enlarged exploration of the basin of convergence of the proposed optimization solution. Overall, our method will prove to be effective, robust and versatile to guarantee a highly accurate global alignment for a wide class of challenging (large and dense) experimental datasets (here anticipated in Fig. 1) and initial alignment conditions.Due to the complexity of the alignment task and the strict interdependence of the phases of fine alignment and global registration, we now focus on an essential literature overview of the above steps of the 3D modeling pipeline. For a state-of-the-art of coarse alignment techniques, the interested reader can start off with our recent work [12].These methods are usually employed to improve the alignment obtained after the application of a coarse alignment technique. Many approaches to this problem are related to the Iterative Closest Point (ICP) technique, first introduced in [13,14], and to its efficient variants introduced afterwards [15–18]. The ICP technique is an iterative approach for which, at every iteration, a set of correspondences is established between two views, and used to estimate the rototranslation matrix that brings these views closer to alignment. Due to problems induced by sample noise and partial occlusions in the superposition zones, some methods try to avoid the computation of the correspondence set and define the registration problem using surface distance functions [19,20]. Some work has also been done on ‘non-rigid’ fine alignment as a form of compensation for nonlinearities related to the acquisition device, such as optical distortions and calibration errors [21,22]. These techniques can be used to compensate for discrepancies that appear in the overlapping areas of different scans, which cannot be removed by the application of rigid transformations, since each scan is subject to noise and distortion introduced during the acquisition process. To this end, also some classes of surface reconstruction algorithms can effectively cope with this kind of residual misalignment [23].After an initialization of the presentation of the different scans of an object provided by a multiview coarse alignment, which is commonly followed by a sequence of multiple pairwise fine alignments, there is the need to perform a simultaneous ‘adjustment’ (commonly addressed as ‘global registration’) of the positions of all the views. In fact, a mere chained application of pairwise fine alignments (as proposed in early works [13,24]) is usually unable to solve the typical problems that arise in multi-view alignment, such as error propagation and loop closure issues. A global registration can be done in several ways and it usually leads to formalizations which comprise non-convex minimization problems to solve with constraints related to the rigid transformations of point sets belonging to the views. Graph based representations of the overlapping views can help to define heuristics or algorithms to better condition the problem while keeping the computational load under control. In general, although various methods exhibit similarities, it can be very difficult to compare them due to several factors: the diversity of used metrics and experimental conditions, different HW and SW environments and, not least, the large heterogeneity existing in the dataset we may want to consider (e.g. due to creation/acquisition tools/equipments, synthetic/real (noisy) data, point/vertex density, mesh/point cloud format, number of views, …). In general, convergence trend studies are valuable but should be carefully verified on real-world data and, as we will see, it is not at all guaranteed that a better rate of convergence is also toward a better minimum. The point correspondence theme is also very important. Some works are based on out-of-core computed correspondence sets, others foresee to update the correspondences in an iterative manner, and others try to avoid using them at all.Among representative early works on global registration, Blais and Levine [25] minimize a Euclidean distance cost function, calculated on sets of control points, by simulated annealing. Later, Silva et al. [26] adopt a similar approach exploiting genetic algorithms with a surface interpenetration measure. Bergevin et al. [27] organize the pair of views in a network structure to simultaneously and iteratively minimize the alignment error. Benjemaa and Schmitt [28] propose a randomized ICP over a multi z-buffer structure capable of representing overlapping portions of the views and accelerate operations on them. Another generalized multiview ICP is proposed by Williams and Bennamoun [29]. Pennec [30] proposes a method which alternates between the calculation and refinement of a mean shape and the alignment of the views on it, while Stoddart and Hilton [31] map the registration problem on a physically inspired model where a minimum of potential energy is found with an iterative numerical method based on gradient descent. An improved force-based optimization method is also proposed by Eggert et al. [32]. Huber and Hebert [33] use a global consistency measure on a graph of pairwise matching looking for globally connected subgraphs on which to solve a multiview point-to-plane distance minimization problem according to the approach proposed by Neugebauer [34]. Pulli in [2] uses correspondence-based pairwise alignments and matching heuristics as constraints for its effective multi-view error distribution among the aligned views. The method is still considered a valid approach thanks to its effective error distribution heuristic, computational efficiency, outlier rejection rules and the capability to handle large datasets. However, as we also observed in our experiments, some criticality remains when handling multiple closure problems (from the acquisition of complex objects), as well as when the number of views to align increases up to the point that the underlying heuristic fails to converge to the global minimum of the error function.Quaternion representation of rigid rototranslation transformations [35] is exploited in several global registration works [36–38]. Benjemaa and Schmitt [36] demonstrate that the optimal translation can be decoupled and solved independently from the optimal rotation. Their approach is based on an iterative method where rotation solutions are found based on the movement of one view at a time while keeping the others fixed. The same decoupling is exploited in the work of Sharp et al. [37] where optimization over the graph of neighboring views in a quaternion space is done and closed form solutions are obtained on the cycles of a graph decomposition. The method does not require the computation of point correspondences and can be combined with any pairwise alignment algorithm to generate the estimates of relative motion between each pair of views. Torsello et al. [38] adopt a dual quaternion formulation to project pairwise alignments on the same reference frame and to perform a diffusion along the graph of adjacent views. Also in this case an alternation of the diffusion method and ICP pairwise alignment is suggested for real-world data where alignment performance similar to that of the Pulli method is obtained.Pottmann et al. [39] developed a method based on a first order kinematical analysis that exploits local quadratic approximants of the squared distance function associated to the surfaces to be aligned. This is further investigated in [40], where the global registration problem from a geometric optimization point of view is studied, trying to provide a theoretical framework for a better understanding of the empirical results reported in former literature (including ICP-based methods which exhibit linear convergence), and to explore various constrained nonlinear least squares approaches based on Newton type descent algorithms which can lead to faster (locally quadratic) convergence. Krishnan et al. [5,6] proposed an unconstrained optimization procedure which exploits translation and rotation decoupling and solve for the vector of all view rotations through an optimization method that explicitly works on the constrained manifold of rotations SO(3). Breitenreicher and Schnörr [41] further show (even if limited to pair wise alignment) that taking the intrinsic geometry of the underlying manifold into account for registration, significantly increases robustness with respect to poor initialization. The global registration method described in [6] guarantees a closed form solution in the noiseless case (assuming the knowledge of a set of ‘exact’ correspondences),while for real-world data the use of an iterative Gauss–Newton scheme obtained locally quadratic convergence and computational costs independent of the number of points in the views. In fact, to perform global registration, a set of correspondences between the overlapping pairs of views has to be provided, which is kept fixed during minimization. In the noisy case this ‘known correspondences’ assumption is motivated by the fact that methods like ICP already deliver reliable correspondences at a pairwise level and that global error distribution can rely on that. This is the same line of reasoning we can find in Pulli's work and in others that see the possibility of performing global error distribution without or with minimal correspondence updating. This is also considered an enabling factor to attain computationally affordable techniques. Nevertheless, with regard to computational performance, it has been observed by some comparison studies [42,43] that, in general, accuracy of the alignment comes at the price of heavier computational cost. Therefore, methods that reach a good compromise between accuracy and speed are of great value for practical applications. Our effort here is directed to advance some steps in this direction by proposing and demonstrating that a substantial accuracy improvement and benefits in terms of computational cost can be achieved with respect to [6] with a solution based on iterative correspondence updating and other adjuvant technical solutions.Following, we focus on rigid global registration solutions which are particularly suited for good quality (low noise and distortion) and high-resolution (computational demanding) range scans produced by modern optical range scanners, such as structured light optical devices. We propose some operative modifications to the original ‘Optimization-on-a-Manifold’ (OOM) framework proposed in [6] (here recapped in Sections 2.1 and 2.2) which are intended to obtain a superior alignment accuracy as well as a boost in computational speed. In Section 2.3 we present the main ideas at the base of our ‘Improved Optimization-on-a-Manifold’ (IOM) technique. They consist in the introduction of a fast technique for updating correspondences at each OOM iteration, which was not foreseen in the original algorithm and which can give significant improvements in terms of convergence rate and alignment accuracy. Moreover, we devise a significant computational speedup with respect to the original algorithm, and a different correspondence matching strategy that contributes to improve the convergence rate. Other optimized implementation solutions are described in Section 3, which allow us to increase the execution speed of the IOM method. Experimental results and discussions are presented in Section 4, where robustness (with respect to input misalignments), accuracy and execution time are evaluated and compared with respect to reference methods. The present work is an updated extension of our conference paper [44], where results are presented on a substantially expanded dataset. In particular, the paper has been reorganized, improved and partially rewritten in all parts (with expanded introductory sections), a new stress test has been introduced aiming to establish the basin of convergence of the proposed method, as well as an enriched comparison with the Global Registration method of Pulli [2], with also new experiments about its combined usage with IOM, aimed to explore the possibility to better manage larger datasets.

@&#CONCLUSIONS@&#
