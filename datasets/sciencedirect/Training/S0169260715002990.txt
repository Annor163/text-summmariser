@&#MAIN-TITLE@&#
Robust estimation of event-related potentials via particle filter

@&#HIGHLIGHTS@&#
We constructed a model describing event-related potential (ERP) by trend model.A 400-particle filter produced the best mean square error in the ERP estimation.The filter reduced an amount of average by 42.8% compared with simple averaging.The filter could estimate P300 robustly by application to EEG in P300 speller.Real-time processing is realized in any computer with an appropriate particle number.

@&#KEYPHRASES@&#
Particle filter,Event-related potential,P300,Robust estimation,

@&#ABSTRACT@&#
Background and objectiveIn clinical examinations and brain–computer interface (BCI) research, a short electroencephalogram (EEG) measurement time is ideal. The use of event-related potentials (ERPs) relies on both estimation accuracy and processing time. We tested a particle filter that uses a large number of particles to construct a probability distribution.MethodsWe constructed a simple model for recording EEG comprising three components: ERPs approximated via a trend model, background waves constructed via an autoregressive model, and noise. We evaluated the performance of the particle filter based on mean squared error (MSE), P300 peak amplitude, and latency. We then compared our filter with the Kalman filter and a conventional simple averaging method. To confirm the efficacy of the filter, we used it to estimate ERP elicited by a P300 BCI speller.ResultsA 400-particle filter produced the best MSE. We found that the merit of the filter increased when the original waveform already had a low signal-to-noise ratio (SNR) (i.e., the power ratio between ERP and background EEG). We calculated the amount of averaging necessary after applying a particle filter that produced a result equivalent to that associated with conventional averaging, and determined that the particle filter yielded a maximum 42.8% reduction in measurement time. The particle filter performed better than both the Kalman filter and conventional averaging for a low SNR in terms of both MSE and P300 peak amplitude and latency. For EEG data produced by the P300 speller, we were able to use our filter to obtain ERP waveforms that were stable compared with averages produced by a conventional averaging method, irrespective of the amount of averaging.ConclusionsWe confirmed that particle filters are efficacious in reducing the measurement time required during simulations with a low SNR. Additionally, particle filters can perform robust ERP estimation for EEG data produced via a P300 speller.

@&#INTRODUCTION@&#
Event-related potentials (ERPs) are electroencephalography (EEG) signals evoked by sensory stimuli. Currently, ERPs are applied to clinical diagnoses in various fields, including psychiatry, neurology, and clinical psychology. Among the ERP components, the P300 is a positive potential that appears approximately 300ms after a sensory stimulus. The P300 component is thought to correspond to recognition and judgment processes in the brain. Many researchers have published reports focused on the P300. For instance, Goodin et al. [1] reported that the P300 latencies of people with Alzheimer's disease, Parkinson's disease, and Huntington's disease are delayed in comparison with those of healthy individuals.In addition to clinical investigations, the P300 has been widely used in brain–computer interface (BCI) research in recent years. BCI development has involved various modes of biological signal measurement, including EEG and electrocorticogram. Among these, EEG is the representative tool because it is relatively inexpensive and simple. In EEG-based BCI, ERPs are easy to comprehend and analyze because they can be synchronized with the stimulus.Many researchers have published reports regarding the estimation of the P300 component. For instance, D’Avanzo et al. [2] attempted to extract single-trial ERPs, including the P300, using the multi-task learning method. In their model, they assumed that a single-trial ERP is the sum of an average component, common to all sweeps, and an individual shift, which varies from sweep to sweep. Turnip et al. [3] proposed a real-time feature extraction method for the P300 in which a nonlinear principal component was combined with a multilayer neural network. In this method, visual inspection was conducted for the extracted P300 waveform in lieu of quantitative evaluation.Other P300 estimation techniques include those based on wavelet denoising [4], independent component analysis [5], the autoregression of exogenous input (ARX) model [6], and common spatial pattern (CSP) analysis [7]. Additionally, a recent report described an estimation method for compressed sensing using the property of ERP sparsity in the frequency domain [8].In this study, we focused on optimizing and using a particle filter to estimate the P300. This filter was described as part of the general state space model approximately 20 years ago. It was proposed for estimating the distribution of high dimensional state vectors, which had a high computational cost, and thus, required many particles. Its implementation is simple and the filter is applicable to various fields. In contrast to the Kalman filter, the particle filter is expected to improve estimation accuracy because it enables a non-Gaussian distribution in state estimation. Vedel-Larsen et al. [9] compared the performance of a simplified Kalman filter with that of sliding window averaging for single trial P300s. They concluded that the simplified Kalman filter was better than sliding window averaging in terms of noise suppression. Regarding the use of a particle filter in single trial ERP estimation, Mohseni et al. [10] proposed a method based on recursive Bayesian estimation of wavelet coefficients corresponding to ERPs. They then compared the particle and Kalman filtering approaches. They found that the particle filter was more robust than the Kalman filter for processing non-Gaussian noise in EEG data. Although Ting et al. conducted several studies in which ERPs were estimated via particle filter, their target ERP component was different from that in the present study (i.e., P300). They proposed a time-varying AR model with non-Gaussian Cauchy noise to estimate event-related desynchronization [11] and a non-linear state-space model with a non-Gaussian stochastic volatility process and particle filter to estimate single-trial auditory brainstem responses [12]. They also constructed state-space dynamic models for single-trial ERPs such that the evolution of latencies and amplitudes was defined by a continuous-time AR process with trend components, and ERPs were estimated via a Rao-Blackwellized particle filter [13].The appearance of the P300 depends on various factors. These are not only related to the physical properties of stimuli, but also to human circumstances, such as fatigue [14], motivation [15], and habituation [16]. That single sweep response may be considerably different from one another has been well established [17]. Accordingly, assuming that each response is independent, we did not make any special assumptions or incorporate information about past responses into our ERP estimation model. In this study, we focused on the idea that a probability distribution can be constructed from many particles. In this case, estimation accuracy and processing time can be modulated by the number of particles. Applying the filter, we can set the number of particles according to the desired performance of the computer used for analysis. This enables us to sacrifice estimation accuracy and save in terms of computation cost for instances in which a low level of specification is necessary.We sought to develop a simple filter that would be applicable to cases in which the processing was conducted as preprocessing, prior to conventional averaging (the calculation of an average for measured responses). In this study, we demonstrated the application of this filter to simulated EEG data and attempted to apply the filter to actual EEG data generated using a P300 BCI speller. Additionally, we examined the possibility of using the filter for real-time processing, which is an ideal condition for analysis. Here, we define real-time processing as the execution of ERP estimation within the time required to collect the corresponding measurement. As accuracy is affected by computer performance, we evaluated the real-time properties using specific parameters on a computer in our laboratory.

@&#CONCLUSIONS@&#
In this study, we considered the efficacy of a particle filter for the analysis of simulated and actual EEG generated via the P300 speller. A distinguishing feature of the particle filter is that it can be used to construct probability distributions based on a large number of particles. We constructed a simple model that recorded three components of EEG waveforms: ERPs, background waves, and noise. The former two components can be approximated via trend models and autoregressive models, respectively. We evaluated the filter performance based on the MSE of the estimated waveform, the peak amplitude, and the latency of the P300 component. In terms of the relationships between the number of particles and the MSE, we were able to achieve a satisfactory MSE, with only 400 particles, using this model. The particle filter yielded a better MSE for original waveforms with a low SNR compared with the Kalman filter and a conventional averaging method. The application of a particle filter to ERP estimation will be especially useful for data with a low SNR. We also investigated time complexity as a function of the number of particles. We found that the complexity increases in a near-linear fashion for up to 1000 particles, although it increases with O(n2) when using our algorithm. We examined the relationship between MSE improvement and the amount of averaging, and determined that the optimal number of particles was 400. We found that the merit of the filter decreased when the original waveform already had a high SNR. Using a particle filter, we found that when the SNR of the original waveform was −10dB, the amount of averaging could be reduced by a maximum of 42.8% compared with the amount of averaging employed with a conventional method. In terms of processing time, real-time processing may be possible as we were able to execute ERP estimation in individual analysis sections within the measurement times corresponding to the chosen sections.Regarding the relationship between P300 peak amplitude, P300 peak latency, and the amount of averaging, we found the following. In terms of peak amplitude, the particle filter showed the best performance for stimuli less than −5dB SNR. As for peak latency, we found that it was easily affected, especially when there was a low SNR. However, the particle filter was clearly advantageous for processing data with a lower SNR.We applied the particle filter to measured EEG responses generated by a P300 speller. As a result, we were able to obtain stable estimated ERP waveforms compared to those obtained by conventional averaging, irrespective of the amount of averaging.The outcome depends on the optimal parameter settings, which in this experiment, were set using the simplex method. The simplex method is limited in that it has a local maximum/minimum point. Thus, more investigation will be needed to obtain the best parameters.In future research, we hope to test the application of this particle filter on clinical EEG measurements or real BCI systems.