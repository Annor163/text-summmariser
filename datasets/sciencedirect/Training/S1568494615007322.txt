@&#MAIN-TITLE@&#
Chattering-free fuzzy variable structure control for multivariable nonlinear systems

@&#HIGHLIGHTS@&#
A fuzzy based variable structure control for multivariable nonlinear systems is presented.A generic matrix formulation of the FLC-VSC algorithm for nonlinear multivariable systems, is proposed.The weighting parameters approach is used to optimize local and global modelling capability of T-S fuzzy model.The global stability of the controlled system is guaranteed.A fuzzy switching function is added as an additional fuzzy variable.

@&#KEYPHRASES@&#
Variable structure control,Fuzzy systems,Nonlinear multivariable systems,T-S fuzzy model,

@&#ABSTRACT@&#
In this paper, a fuzzy logic controller (FLC) based variable structure control (VSC) with guaranteed stability for multivariable systems is presented. It is aimed at obtaining an improved performance of nonlinear multivariable systems. The main contribution of this work is firstly developing a generic matrix formulation of the FLC-VSC algorithm for nonlinear multivariable systems, with a special attention to non-zero final state. Secondly, ensuring the global stability of the controlled system. The multivariable nonlinear system is represented by T-S fuzzy model. The identification of the T-S model parameters has been improved using the well known weighting parameters approach to optimize local and global approximation and modeling capability of T-S fuzzy model. The main problem encountered is that T-S identification method cannot be applied when the membership functions (MFs) are overlapped by pairs. This in turn restricts the application of the T-S method because this type of membership function has been widely used in control applications. In order to overcome the chattering problem a switching function is added as an additional fuzzy variable and will be introduced in the premise part of the fuzzy rules together with the state variables. A two-link robot system and a mixing thermal system are chosen to evaluate the robustness, effectiveness, accuracy and remarkable performance of proposed FLC-VSC method.

@&#INTRODUCTION@&#
VSC with slide-mode control (SMC) is characterized by its ability to deal with nonlinearities, uncertainties of control systems, invariance to parameters, order reduction, fluctuations and disturbances, decoupling design procedure and its robustness.Motivated by observation on similarity between FLC rules and the VSC, the robustness of the FLC has been analyzed for nonlinear multivariable dynamic systems in this paper. The relationship is important since it gives guidance on the design parameters of the FLC to achieve the specified control performances [18,20,21,42].Sliding modes are used to determine best values for parameters in fuzzy control rules in which the robustness is inherent in the VSC with SMC, thereby robustness in fuzzy control can be improved. With the aid of SMC, it provides an effective design of fuzzy control to ensure robustness, rapid and accurate tracking control of a class of nonlinear systems [12,19,26,30,41].This work is a generalized version of a FLC-VSC for multivariable nonlinear systems based on a previous one [6] for single-input-single-output (SISO) systems where a FLC-VSC with chattering elimination is developed. In order to eliminate the chattering effect, a direct efficient solution [44] is used in this paper to implement the boundary layer converting it in fuzzy system by defining three fuzzy sets without sacrificing invariant properties. An improved T-S model developed by the authors in [1,2,7,22] has been used. This model uses the well known weighting parameters approach to optimize local and global approximation of T-S fuzzy model to improve the choice of the performance index and minimize it. It has been proved that the proposed estimation algorithm converge very fast, thereby making it very practical to use. The effectiveness of the proposed controller is proven infront of disturbances and noise effects.A FLC for a class of uncertain nonlinear multivariable systems represented by a T-S model is presented in [17]. The first attempt is made to relax the restrictive assumption that each nominal local model shares the same input channel, which is required in the traditional VSC-based FLC design methods. As the local controller, an SMC is used with a switching feedback control term. In terms of linear matrix inequalities (LMIs), a sufficient condition for the existence of linear sliding surfaces is derived guaranteeing asymptotic stability of the reduced-order equivalent SMC dynamics.In [14], T-S model of a multivariable nonlinear system in state space is obtained using the developed fuzzy modeling algorithm. The system state space equation is expressed as the fuzzy summation of state variables, disturbance and control input. To obtain high accurate model, a genetic algorithm with a new encoding method is applied looking for the optimal model. The proposed technique can evolve the fuzzy rule so that the obtained model has the simplest structures without decreasing the modeling accuracy.In [16], a stable adaptive neural SMC is developed for a class of multivariable uncertain nonlinear systems. For such systems not all state variables are available for measurements. By designing a state observer, adaptive neural systems, which are used to model unknown functions, can be constructed using the state estimations. The designing of the adaptive neuro-sliding mode controller is based on Lyapunov stability theorem so that the stability of the whole closed loop system is proved.In [25], FLC of a class of multivariable nonlinear systems subject to parameter uncertainties is presented. The nonlinear plant is an nth order with n inputs. If the input matrix of the fuzzy plant model is invertible, an FLC can be designed such that the states of the closed-loop system will follow those of a user-defined stable reference model despite the presence of uncertainties.In [46], an FLC-VSC scheme based on a T-S model is proposed for a permanent-magnet synchronous motor (PMSM) drive system in order to solve the speed tracking problem. An FLC-VSC controller for the PMSM system with parameter variation and load disturbances is designed. The FLC-VSC scheme can drive the dynamics of the PMSM into a designated sliding surface in finite time, and guarantee asymptotical stability.In [8], a robust adaptive FLC which combines SMC with an adaptive proportional integral term is developed for nonlinear Multi Inputs Multi Outputs (MIMO) underactuated systems with unknown parameters and in presence of external disturbances. The aim is that underactuated systems can be controlled in their original non square form. The problem of matrix singularity is solved by using the regularized inverse and by introducing a compensator term in the proposed control law. The free parameters of the adaptive fuzzy controller are tuned on-line based on the Lyapunov approach.Recently, much attention has been devoted to FLC for robotic manipulators. A good survey on FLC for robotic manipulators can be found in [33] and references cited therein. Control laws designed by Hsu [39] consisted of a regular fuzzy controller and a supervisory control term, which ensured stability of closed-loop systems. In [28], two FLC schemes for a class of uncertain continuous MIMO nonlinear dynamical systems were derived.The design and analysis of an intelligent control system that posses the robust features of SMC for an n-link robot manipulator, with actuator dynamics to obtain a precise and robust position tracking is presented in [45]. A fuzzy-neural-network inherited SMC (FNNISMC) scheme is proposed to relax the requirement of detailed system information and deal with chattering control efforts in the SMC system. The FNN framework is designed to mimic the SMC law, and adaptive tuning algorithms for network parameters are derived in the sense of projection algorithm and Lyapunov stability theorem to ensure the network convergence as well as stable control performance.The problem of chattering phenomena on the conventional SMC is analyzed in [44]. An adaptive fuzzy sliding-mode control (AFSMC) system for an indirect field-oriented induction motor (IM) drive to track periodic commands is presented. Moreover, a fuzzy logic inference mechanism is applied to eliminate the chattering phenomena on the conventional SMC. In addition, to confront the uncertainties existed in practical applications, an adaptive algorithm, which is derived in the sense of Lyapunov stability theorem, is utilized to adjust the fuzzy parameter for further assuring robust and optimal control performance.In [34], an interval-valued fuzzy model-based controller for handling the effects of uncertainty in a complex system is presented. Theoretically, model-based controllers may be the ideal choice; however, they are highly sensitive to model uncertainties and lack robustness. They are also computationally intensive, being unusable for many real-world applications. The proposed controller is developed for a 3-PSP parallel robot. It aims to handle the uncertainties in the robot model. The designed controller also satisfies the computational complexity constraints for real-time implementation.In [38], it is supposed that robotic manipulator with structured uncertainty and/or unstructured uncertainty can be separated as two subsystems: nominal one with precise dynamical knowledge and uncertain one with unknown knowledge. The fuzzy controller acts as compensator for CTC. Parameters updating of the fuzzy controller are derived using Lyapunov theorem.It is well known that a robust effective controller requires an accurate and efficient model. In [40], an interesting method is developed to identify nonlinear systems using input-output data. Nonlinear control systems based on the T-S fuzzy model [40] have attracted quite attention during the last twenty years (e.g., see [9,10,13,15,29,31]. It provides a powerful solution for development of function approximation, systematic techniques to stability analysis and controller design of FLC systems in view of fruitful conventional control theory.In [1,2,22], new and efficient approaches are presented to improve the local and global estimation of T-S model. The aim is obtaining high function approximation accuracy. The problem is that T-S identification method cannot be applied when the MFs are overlapped by pairs. This restricts the use of the T-S method because this type of membership function has been widely used during the last two decades in the stability, controller design and is popular in industrial control applications. The approaches developed can be considered as a generalized version of T-S method with optimized performance in approximating nonlinear functions. The first approach uses the minimum norm method to search for an exact optimum solution at the expense of increasing complexity and computational cost. The second one is a simple and less computational method, based on weighting of parameters. These estimation methods are characterized by the high accuracy obtained in approximating nonlinear systems locally and globally in comparison with the original T-S model.In addition to VSC method, several other control design methodologies through state feedback control can be applied. By using the pole assignment method for example, the desired characteristics and the coincidence of all the subsystems can be achieved, ensuring the stability of the resulting feedback system. However, this methodology can lead to systems where the control action exceeds the allowed environment limits. Selecting closed loop poles with great negative real parts make the dynamic response of the system to be quick while the control effort to be greater than permissible levels. If selection of the closed loop poles saturate of control signals, dynamic behavior of the system will not be as same as the desired behavior even it may become unstable. Therefore optimal selection of closed loop poles will lead to a trade-off between speed of dynamic response and control effort. Together with the proposed estimation method, the well known linear quadratic regulator (LQR) method might be an appropriate choice. With this method we might not guarantee of stability, which needs to be analyzed a posteriori, gaining in return a balance between static and dynamic behavior of the system with admissible control actions. Q is a non-negative definite matrix which is called weighting matrix. On the other hand, R is a positive definite weighting matrix. Optimal selection of these matrices determines the dynamic speed of the controller as well as amplitudes of state variables and control signals. For example if R is selected small while Q is selected large, more stability will be attained with large control efforts [1–4] and [5].In [1], an efficient estimation approach is presented to improve the local and global approximation and modelling capability of T-S fuzzy model. A global fuzzy controller FLC-LQR is proposed in order to show the effectiveness of this approach in control applications. Illustrative examples of an inverted pendulum and Van der Pol system are chosen to evaluate the robustness and remarkable performance of the proposed method and the high accuracy obtained in approximating nonlinear and unstable systems locally and globally in comparison with the original T-S model. Simulation results show the potential, simplicity and generality of the algorithm.New identification methods of T-S model are developed in [2]. The authors propose a noniterative method through the weighting parameters approach and an iterative algorithm by applying the extended Kalman filter, based on the same idea of parameters weighting. We show that the Kalman filter is an effective tool in the identification of T-S fuzzy model. An FLC-LQR is proposed in order to show the effectiveness of the estimation method and the developed controller.In [3], a fuzzy feedback linearization control method is used to control nonlinear systems described by T-S fuzzy systems. In this work, an optimal controller is designed using LQR. Simulation results indicate the robustness of the proposed control algorithm.In [4], several algorithms of FLC-LQR are presented. The multivariable nonlinear system is represented by a generalized T-S model developed by the authors in previous works [1]. In comparison with existent works, the proposed controller is based on the calculation of the control action in each point of the state space according to the dynamic properties of the nonlinear system at that point. This control methodology offers a robust, well damped dynamic response and zero steady state error when the system is subjected to disturbances and modeling errors. A two-link robot system is chosen to evaluate the superiority of the proposed controller algorithms in comparison with other approaches.In [5], a novel approach based on incremental state models has been proposed for the modeling of multivariable nonlinear delayed systems expressed by a generalized version of T-S fuzzy model [1]. One of the key features of the new approach is that the proposed incremental state model compared with the no incremental one, naturally solves the problem of computing the target state, since for a desired output vector, a zero incremental state can be taken as an objective. Moreover, the control action in an incremental form is equivalent to introduce an integral action, thereby cancelling the steady state errors. Among other advantages using incremental models are the disappearance of the affine terms. Then, an FLC-LQR is designed. Furthermore, a new optimal observer for multivariable fuzzy systems is developed, because not all states of the nonlinear system are fully available or measured.The rest of the paper is organized as follows. An introduction to FLC-VSC is presented in Section 2. New method for chattering elimination is developed in Section 3. Stability analysis is presented in Section 4. Section 5 deals with the analysis of the non zero final state. In Section 6, the estimation of T-S fuzzy model is presented. Section 7 entails two examples of a two link robot and a thermal mixing tank as nonlinear multivariable systems to evaluate the robustness, effectiveness of the proposed controller. The proposed VSC-FLC and the simulation results are given in Section 8. The application of the proposed FLC-VSC shows that both elimination of chattering and robust performance are achieved.The VSC is a combination of subsystems together with a suitable switching logic. In VSC, the design algorithm includes choosing the desired sliding functions which are formed by a choice of their parameters as will be explained. Then a discontinuous control is found which assures the existence of the sliding modes at each point of the sliding plane s(x)=0. In the final stage, the control should drive the system states to the sliding plane. The robustness of VSC stems from the property that the behavior of the controlled system in the sliding mode only depends on the parameters of the sliding mode, not on the system parameters or any disturbances or fluctuations.The control algorithm developed in this work supposes that the system dynamics can be modeled as the following state model:(1)x˙(t)=a0(x(t))+A(x(t))x(t)+B(x(t))u(t)where:x:R⟶Rnu:R⟶Rma0:Rn⟶RnA:Rn⟶Rn×nB:Rn⟶Rn×mwith n≥m.The initial objective is approaching the final zero state from any initial one. The structure of the VSC is determined by the sign of the vector valued function s(x), which is defined to be the switching function which is assumed to be a linear one, i.e.,(2)s(x)=Sx,S∈Rm×nwhere S is an arbitrary (m×n) matrix chosen such that s(x)=0 defines a stable dynamic system of reduced order. A classical formulation of VSC algorithm [43] includes the calculation of a control action u(t) that satisfies the following reaching condition.(3)sT(x)s˙(x)≤0Substituting (1) ins˙(x)obtained by differentiating (2), we get:(4)s˙(x)=Sx˙(t)=S(a0(x(t))+A(x(t))x(t)+B(x(t))u(t))=S(a0(x(t))+A(x(t))x(t))+SB(x(t))u(t)Therefore,(5)SB(x(t))u(t)=−S(a0(x(t))+A(x(t))x(t))+s˙(x)The condition of applicability is that the product SB(x) should be always invertibe. Solving Eq. (5) for the control action, we get:u(t)=−[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−s˙(x))The feedback system becomes:(6)x˙(t)=a0(x(t))+A(x(t))x(t)−B(x)[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−s˙(x))In this article, we suppose that the system can be represented in a canonical controllable form as follows,a0=a01a02⋮a0m,a0i=0⋮0a0ni,A=A11A12⋯A1mA21A22⋯A2m⋮⋮⋱⋮Am1Am2⋯AmmAii=010⋯0001⋯0⋮⋮⋮⋱⋮000⋯1ani1ani2ani3⋯anini,Aij=000⋯0000⋯0⋮⋮⋮⋱⋮000⋯0ani1ani2ani3⋯aninjB=B1B2⋮BmBi=00⋯0⋮⋮⋯⋮00⋯0bni1bni2⋯bnimrange(B)=mwhere {n1, n2, …, nm} are the dimensions of the controllable subspaces for each input.The next step in the design of the VSC includes choosing the structure of the control to satisfy a reaching condition. There exist various structures of control algorithms which guarantee the existence of sliding modes. Sometimes, it is convenient to preassign the structure of the VSC and then determine the values of the controller gain. The design of VSC can be proceed with the structure of the control u(x(t)) free or preassigned. In either case, the objective is to satisfy the reaching condition. In the free structure approach, the control structure can be solved by constraining the switching function to any one of various reaching conditions mentioned in [43]:Then, we propose to choose the switching matrix asS=S11S12⋯S1mS21S22⋯S2m⋮⋮⋱⋮Sm1Sm2⋯Smm,Sii=sii1sii2⋯sii,ni−11Sij=00⋯00where the characteristic polynomial:pi(λ)=λni−1+sii,ni−1λni−2+⋯+sii1λ+sii1will have all its roots in the negative left-hand side. This means that each one of m systems si(x) will be stable and of reduced order.si(x)=Six=0In this work, we have also proposed the following switching condition which includes selecting Ki>0 to implement the control action:(7)Ifsi(x)<0thenchooseu(t)suchthats˙i(x)=KiIfsi(x)=0thenchooseu(t)suchthats˙i(x)=0Ifsi(x)>0thenchooseu(t)suchthats˙i(x)=−Kior in another form:s˙(x)=K(x)K(x)=α1α2⋯αmTwhere:Ifsi(x)<0thenαi=KiIfs(x)i=0thenαi=0Ifsi(x)>0thenαi=−KiFirstly, the reaching condition should be fulfilled:s(x)s˙(x)=∑i=1msi(x)s˙i(x)≤0∀x∈RnThe condition of applicability which states that the product SB(x) should be always invertibe is also fulfilled. If we suppose that the system is of a canonical controllable form, then:SB=S11S12⋯S1mS21S22⋯S2m⋮⋮⋱⋮Sm1Sm2⋯SmmB1B2⋮Bm=S11B1S22B2⋮SmmBm=bn11bn12⋯bn1mbn21bn22⋯bn2m⋮⋮⋱⋮bnm1bnm2⋯bnmmwhich will be invertible if B is of m rank.The feedback system becomes:(8)x˙(t)=a0(x(t))+A(x(t))x(t)−B(x)[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−K(x))From above, it is fulfilled that:B[SB]−1Sa0=a0A*=A−B[SB]−1SA=A11A12⋯A1mA21A22⋯A2m⋮⋮⋱⋮Am1Am2⋯Amm−S˜11S˜12⋯S˜1mS˜21S˜22⋯S˜2m⋮⋮⋱⋮S˜m1S˜m2⋯S˜mmA11A12⋯A1mA21A22⋯A2m⋮⋮⋱⋮Am1Am2⋯Amm=A11*A12*⋯A1m*A21*A22*⋯A2m*⋮⋮⋱⋮Am1*Am2*⋯Amm*Aii*=010⋯0001⋯0⋮⋮⋮⋱⋮000⋯10sii1sii2⋯sii,ni−1∈Rni×ni,Aii*=0∈Rni×njK*=B[SB]−1K=B1*B2*⋮Bm*α1α2⋮αm=α1*α2*⋮αm*,αi*=0⋮0αi∈RniThus, the closed loop system becomes:x˙(t)=a0(x(t))+A(x(t))x(t)−B(x)[SB(x)]−1(S(a0(x(t))+A(x(t))x(t))−K(x))=a0(x(t))−B(x)[SB(x)]−1S(a0(x(t))+(A(x(t))−B(x)[SB(x)]−1SA(x))x(t)+B(x)[SB(x)]−1K(x)=A*(x)x(t)+K*(x)This means that the feedback system in independent of the original systemAs mentioned before, the main drawback of sliding mode control is the chattering problem resulted from the switching from one value to another.Example 3.1Let us consider the following unstable linear multivariable system:Figs. 1and 2show the chattering effect assuming that the simulation is carried out with a sampling time of 0.02s.Figs. 3 and 4show the temporal evolution of s1(x) and s2(x). The amplitude of the limit cycle AL=0.5KT=0.5.5.0.02=0.02 for s1 and AL=0.5KT=0.5.10.0.02=0.1 for s2.The origin of these oscillations is the discrete implementation of the system:s˙(x)=v(t)when it is controlled by:(9)v(t)=Kifs(t)<0−Kifs(t)>0Fig. 5shows the phase plane of this system.The discrete implementation of this system with zero order holding device and sampling time T corresponds to the system:(10)sk+1=sk+Tvkwith(11)vk=Kifsk<0−Kifsk>0It can be shown that there is a limit cycle of amplitude AL=0.5KT and frequencyωL=πT, i.e. 2 samples per cycle.Many authors have dealt with chattering reduction by developing fuzzy rules to reduce or eliminate the chattering problem. This comes from the fact that there is a high similarity between the SMC with boundary layer and an FLC whose rules have been derived from the phase plane [23,24,32]. The analysis of the two working principles leads to the following conclusion: Fuzzy control, in the above mentioned sense, is an extension of sliding mode with boundary layer.In order to overcome the chattering problem, a smooth transition is introduced in this work between these two control actions. Instead of making an abrupt change in the definition ofs˙(x)(see Fig. 5), a boundary layer [37] is introduced around the switching surface (see Fig. 7. The resultant controller is a combination of the discontinuous one used to create the SM outside the layer and applying the equivalent control method inside this layer. Therefore, it is suggested in this work to switch from the SM control to the equivalent control according to the position of the state trajectory.The solution applied here for this problem is converting the VSC in fuzzy control by defining three fuzzy sets for s(x) [44] as shown in Fig. 6.(12)Ifsi(x)isMi−thenchooseu(t)suchthats˙i(x)=KiIfsi(x)isMi0thenchooseu(t)suchthats˙i(x)=0Ifsi(x)isMi+thenchooseu(t)suchthats˙i(x)=−KiThe phase plane of the system given with the boundary layer is shown in Fig. 7)The resultant fuzzy VSC is:Ifsi(x)isMi−thenu(t)=−[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−K)Ifsi(x)isMi0thenu(t)=−[SB(x(t))]−1S(a0(x(t))+A(x(t))x(t))Ifsi(x)isMi+thenu(t)=−[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))+K)Example 3.2Now, the proposed fuzzy control is applied for the same system in the previous example with the same sampling time and the fuzzy sets shown in Fig. 6 with Φ=1.It can be clearly shown in Figs. 8–11the effectiveness of the proposed controller in eliminating the chattering effect.In this paper, fuzzy inference is applied to switch from the discontinuous controller to the equivalent one by regarding the distance from the switching hyperplane as a variable of the premise of the control laws.Firstly, the feedback system in (2) has a singular point in x=0x˙(t)x=0=A*(x(t))x(t)+K*x=0=0Since si(x)=Six=0 is a stable linear dynamic system of reduced order, there should exist a Lyapunov function for this system [27,37]:xri=xσi+1xσi+2…xσi+ni−1Tσi=∑j=1i−1njVri(xri)=xriTPrixriwhich should fulfill that Vri(x) is a positive definite function in xrianddVri(xri(t))dtis a negative definite one in xri.Let us define the following Lyapunov function for the controlled system:(13)V(x)=∑i=1mVri(xri)+s(x)Ts(x)It can be observed that:Vr=∑i=1mVri(xri)=∑i=1mxriTPrixri=xTPrxPr=Pr10⋯0000⋯00⋮⋮⋱⋮⋮00⋯Prm000⋯00s(x)Ts(x)=∑i=1msi2(x)The two terms in Eq. (13) should verify:(14)∑i=1mVri(xri)≥0∀x∈Rns(x)Ts(x)≥0∀x∈Rnwhere V(x) should be at least a positive semidefinite function.Moreover,(15)Vr(x0)=0⇔x0=0…0x0σ10…0x0σ2…0…0x0σmTVerifying,s(x0)Ts(x0)=∑i=1msi2(x0)=∑i=1mx0σi2=0⇔x0σi=0In conclusion:V(x)=0⇔x=0Therefore, it is clear that V(x) is a positive definite function. The derivative of Lyapunov function becomes:(16)dV(x(t))dt=dVr(x(t))dt+2s(x)Ts˙(x)The two terms in Eq. (16) should verify:(17)dVr(x(t))dt=∑i=1mdVr(xri(t))dt≤0∀x∈Rn2s(x)s˙(x)=2∑i=1msi(x)s˙i(x)≤0∀x∈RnwheredV(x)dtshould be at least a negative semidefinite function.Moreover,(18)dVr(x0)dt=0⇔x0=0…0x0σ10…0x0σ2…0…0x0σmT2s(x0)Ts˙(x0)=2∑i=1mx0σiαi=0si(x)s˙i(x)=x0σiαi≤0⇔x0σi=0and thus:dV(x)dt=0⇔x=0where it is evident thatdV(x)dtis a negative definite function. Thus, the feedback system is an asymptotically stable one. Moreover,(19)V(x)ispositivedefinite∀x∈RndV(x)dtisnegativedefinite∀x∈RnandV(x)→∞asx→∞Therefore, the system is a globally and asymptotically stable one.The objective now is to approach a steady state xr. The first condition to impose is that there is an input signal urthat allows the system given by (1) to maintain this steady state, i.e., it should comply:(20)0=a0(xr)+A(xr)xr+B(xr)urIf we change the variables in (1) as follows:(21)x(t)=xr+Δx(t)u(t)=ur+Δu(t)(22)Δx˙(t)=a0(x(t))+A(x(t))(xr+Δx(t))+B(x(t))(ur+Δu(t))we will obtain a new system:(23)Δx˙(t)=a0(x(t))+A(x(t))xr+B(x(t))ur+A(x(t))Δx(t)+B(x(t))Δu(t)This means that:(24)Δx˙(t)=ar0(x(t))+A(x(t))Δx(t)+B(x(t))Δu(t)wherear0(x(t))=a0(x(t))+A(x(t))xr+B(x(t))urIt will satisfy in this new system (24) that,Δx=0⇒x=xr(25)ar0(xr)=a0(xr)+A(xr)xr+B(xr)ur=0Thus the control satisfies the condition so that the VSC becomes:(26)Δu(t)=−[SB(x(t))]−1(S(ar0(x(t))+A(x(t))Δx(t))−K]whereK=α1α2⋯αmTandIfsi(Δx(t))<0thenαi=KiIfsi(Δx(t))=0thenαi=0Ifsi(Δx(t))>0thenαi=−Kileads to a feedback system asymptotically and globally stable in:Δx(t)=0⇒x=xrBy substituting (26) in (21), we get(27)u(t)=ur−[SB(x(t))]−1(S(a0(x(t))+A(x(t))xr+B(x(t))ur+A(x(t))Δx(t))−K)=ur−[SB(x(t))]−1SB(x(t))ur−[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−K)=−[SB(x(t))]−1(S(a0(x(t))+A(x(t))x(t))−K)which can be clearly seen that it does not depend on ur.An interesting method of identification is presented in [40]. The idea is based on estimating the nonlinear system parameters minimizing a quadratic performance index. The method is based on the identification of functions of the following form:f:Rn⟶Ry=f(x1,x1,…,xn)Each IF-THEN rule for an nth order system can be written as follows:(28)S(i1…in):Ifx1isM1i1and…xnisMninthenyˆ=p0(i1…in)+p2(i1…in)x2+…+pn(i1…in)xnwhere the fuzzy estimation of the output is:(29)yˆ=∑i1=1r1…∑in=1rnw(i1…in)(x)p0(i1…in)+p1(i1…in)x1∑i1=1r1…∑in=1rnw(i1…in)(x)+∑i1=1r1…∑in=1rnw(i1…in)(x)p2(i1…in)x2+…+pn(i1…in)xn∑i1=1r1…∑in=1rnw(i1…in)(x)where,w(i1…in)(x)=∏l=1nμlil(xl)beingμjij(xj)the membership function that corresponds to the fuzzy setMjij.Letx1k,x2k,…,xnk,ykbe a set of input/output system samples. The parameters of the fuzzy system can be calculated as a result of minimizing a quadratic performance index:(30)J=∑k=1m(yk−yˆk)2=Y−XP2where(31)Y=y1y2…ymTP=p0(1…1)p1(1…1)p2(1…1)…pn(1…1)…p0(r1…rn)…pn(r1…rn)TX=β1(1…1)β1(1…1)x11…β1(1…1)xn1…β1(r1…rn)…β1(r1…rn)xn1βm1…1βm(1…1)x1m…βm(1…1)xnm…βm(r1…rn)…βm(r1…rn)xnmand(32)βk(i1…in)=w(i1…in)(xk)∑i1=1r1…∑in=1rnw(i1…in)(xk)If X is a matrix of full rank, the solution is obtained as follows:(33)J=Y−XP2=(Y−XP)T(Y−XP)∇J=XT(Y−XP)=XTY−XTXP=0P=(XTX)−1XTYIn the case when the matrix X is not of full rank, an effective approach with few computational effort, based on the well known parameters’ weighting method, is presented in [2,7] and [22].This method can also be used for parameters tuning of T-S model from local parameters obtained through the identification of a system in an operating region or from any physical input/output data.We suppose that in this case we have a first estimation:P0=[p00p10p20…pn0]Tof the T-S model parameters. In order to obtain such an estimation, the classical least square method can be used around the equilibrium point. This first approximation can be utilized as reference parameters for all the subsystems. Then, the parameters’ vector of the fuzzy model can be obtained minimizing:(34)J=∑k=1m(yk−yˆk)2+γ2∑i1=1r1…∑in=1rn∑j=0n(pj0−pj(i1…in))2=Y−Xp2+γ2P0−p2=YγP0−XγIp2=Ya−Xap2wherep0=[P0P0…P0]T︸r1.r2…rnIn this case, the factor γ represents the degree of confidence of the parameters initially estimated [1,7,22].In the case of dynamic systems represented by state variables, the system model is described by vectorial functions as follows:f:Rn⟶Rmy=f(x1,x2,…,xn)y∈RmThis function is equivalent to m scalar functions:yj=fj(x1,x2,…,xn)y∈R,j=1..mEach one of these functions can be modeled as follows:Sj(i1…in):Ifx1isMj1i1x2isMj2i2and…xnisMjninthenyˆj=pj0(i1…in)+pj1(i1…in)x1+pj2(i1…in)x2+…+pjn(i1…in)xnApplying the previous method for each one of these models, we get in basic case:Yj=yj1yj2…yjNTPj=pj0(1…1)pj1(1…1)pj2(1…1)…pjn(1…1)…pj0(r1…rn)…pjn(r1…rn)TXj=βj1(1…1)βj1(1…1)x11…βj1(1…1)xn1…βj1(r1…rn)…βj1(r1…rn)xn1βjN1…1βjN(1…1)x1N…βjN(1…1)xnN…βjN(r1…rn)…βjN(r1…rn)xnNand the formulation for parameters tuning becomes:(35)Jj=YjΓjpj0−XjΓjpj2It is quite usual in the modelling of T-S model that the fuzzy sets of the premise part of all the subsystems are the same, fulfilling in this case that:X1=X2=…=Xm=XIn addition to that, if the weight factorsγj(i1…in)of the matrix Γ are the same for all the subsystems, they can be all grouped as follows:J=Y1Y2YmΓp10Γp20Γpm0−XΓp1p2pm2J=Ya−Xap2and the solution is still:(36)p=(XatXa)−1XatYaA detailed proof is found in [1]In this section the proposed FLC-VSC is explained by two multivariable nonlinear examples of a two link robot and a thermal mixing tank.Example 7.1Two link robotLet us consider the physical model of a two-link robot [37] (see Fig. 12), with each joint equipped with a motor for providing input torque, an encoder for measuring joint position and a tachometer for measuring joint velocity. The objective of the control design is to make the joint positions θ1 and θ2 follow desired position histories θd1(t) and θd2(t), which are specified by the motion planning system of the robot. Such tracking control problems arise when a robot hand is required to move along a specified path, e.g. to draw circles. Let us suppose that θ1 is the angle measured from the stable equilibrium position (inferior vertical) and θ2 is the angle from the prolongation of the main link to the second one.The dynamic equations of the robot can be derived using the Lagrangian equations as follows:(37)H11H12H21H22θ¨1θ¨2+−hθ˙2+β1−hθ˙1−hθ˙2hθ˙1β2θ˙1θ˙2+g1g2=τ1τ2where θ=[θ1θ2]Tare the two joint angles, τ=[τ1τ2] are the joint inputs andH11=m1lc12+I1+m2(l12+lc22+2l1lc2cosθ2)+I2H12=m2l1lc2cosθ2+m2lc22+I2H21=H12H22=m2lc22+I2h=m2l1lc2sinθ2g1=m1lc1gsinθ1+m2g(lc2sin(θ1+θ2)+l1sinθ1)g2=m2lc2gsin(θ1+θ2)m1=2,l1=1,lc1=0.5,I1=0.25,β1=0.05m2=1.5,l2=1,lc2=0.75,I2=0.12,β2=0.05Forθ1=θ1˙=θ2=θ2˙=0it verifies that,τ10=g10=0,τ20=g20=0In order to model T-S system, we should take into account that the states are:x=θ1θ1˙θ2θ2˙TWe should observe that in our nonlinear model, the dependence of the pairs τ1, τ2 is linear so the T-S rules do not depend on these variables. If we suppose three fuzzy sets for each state variable, we will have 34=81 rules of the form:S(i1…in):Ifx1isM1i1and…x4isM4i4thenx˙=0a20(i1i2i3i4)0a40(i1i2i3i4)+0100a21(i1i2i3i4)a22(i1i2i3i4)a23(i1i2i3i4)a24(i1i2i3i4)0001a41(i1i2i3i4)a42(i1i2i3i4)a43(i1i2i3i4)a44(i1i2i3i4)x+00b21(i1i2i3i4)b22(i1i2i3i4)00b41(i1i2i3i4)b42(i1i2i3i4)τ1τ2The work space isθ1∈[0,π],θ˙1∈[−1,1],θ2∈[−π2,π2],θ˙2∈[−1,1]. Let us choose 5, 3, 5 and 3 triangular membership functions respectively.If we apply the methodology described in [1] and [22], we obtain:S1111:Ifx1isM1i1and…x4isM4i1thenx˙2=−2.2816−14.8609x1+1.2924x2−2.1967x3+0.1681x4+0.3355u1−0.3346u2x˙4=8.4921+24.2250x1−3.1540x2+0.7544x3+0.4721x4−0.2624u1+1.1547u2⋮S4444:Ifx1isM1i4and…x4isM4i4thenx˙2=−1.5761+1.7165x1−1.7015x2−1.6274x3+1.1794x4+0.2618u1−0.3398u2x˙4=6.0187−3.8358x1+4.1864x2+8.5766x3−2.1167x4−0.1041u1+1.1526u2The resultant mean square error of the first link from this approximation is 0.0016 and the maximum absolute error is 1.1055 while the resultant mean square error of the second link is 0.0040 and the maximum absolute error is 1.1055.By applying the proposed controller, we gets(x)=21000031x(t)p1(λ)=λ+2,k1=5,Φ1=0.05p2(λ)=λ+3,k2=8,Φ1=0.05Case 1:The first case is without anti-chattering controller starting from zero initial condition. The objective is to approach3π40−π40.Fig. 13shows the transient response of the two-link robot system without applying the proposed anti-chattering controller. Figs. 14and 15show the phase-plane plot of the first and second link respectively. Figs. 16and 17show the temporal evolution of s1(x) and s2(x). The resultant mean square error vector in the last 5s is [0.00000.00100.00000.0034] rad.Case 2:This case is with the proposed anti-chattering controller starting from zero initial condition. The objective is to approach3π40−π40at 1s.Fig. 18shows the transient response of the two-link robot system by applying the proposed anti-chattering controller. Figs. 19and 20show the phase-plane plot of the first and second link respectively. Figs. 21and 22show the temporal evolution of s1(x) and s2(x). The resultant mean square error vector in the last 5s is 1.0e−004*[0.21430.01370.03610.0000]rad.Case 3:The first case is with the proposed anti-chattering controller starting from zero initial condition. The objective is to approach.3π4000at t=1 second and3π40−π40at t=10s.Fig. 23shows the transient response of the two-link robot system applying the proposed anti-chattering controller. The resultant mean square error vector in the last 5s is 1.0e−004*[0.23560.00000.03590.0000]rad.Case 4:The first case is with the proposed anti-chattering controller starting from zero initial condition. The objective is to follow a ramp input. Fig. 24shows the transient response of the two-link robot system subjected to a ramp input by applying the proposed anti-chattering controller.Case 5:This case is with anti-chattering controller for the robot subjected to a disturbance starting from zero initial condition. The objective is to approach3π4000at t=10s and3π40−π40at t=20s with a mass of 0.5kg.Fig. 25shows the transient response of the two-link robot system subjected to a disturbance effect by applying the proposed anti-chattering controller. The resultant mean square error vector in the last 5s is 1.0e−003*[0.03080.00000.17550.0000]rad.Example 7.2Thermal mixing processIn most of the chemical and biochemical processes, it is of fundamental importance to control the temperature at which various processes occur. Improper temperature control may lead to loss of product quality, non-profitable operation or even create hazardous situations.Temperature is generally controlled by modifying the power output of a heating/cooling device. This translates in setting the flow rate of a heating/cooling agent or the electrical current applied to an electrical heater.The problem of measuring the amounts of hot and cold fluid to produce a mixture having a desired temperature and flow rate is familiar to everyone, including people who are not control experts. In addition to the well-known case of the bathroom shower example, the problem appears in industrial practice as well [11,35,36].Consider the multivariable thermal mixing process of Fig. 26. The mixer consists of a mixing chamber, hot and cold fluid valves, and an exit valve. The main objective is to keep Q and T at the desired values, which are considered the same as that of the tank T. The system is supposed to have a hot water with a temperature T1 and cold water with temperature T2. Both of them are considered constants. The two inlet flowrates Q1 and Q2 act as manipulable variables by two motorized valves, whose dynamic model can be simplified as follows:(38)Qi=K1+τisUi(s)We can also suppose that there are thermal losses proportional to the temperature difference between the inside and outside temperature which act as a disturbance effect. The model becomes:(39)Q1+Q2−Q=Adhdt(40)T1Q1+T2Q2−TQ+kp(T−Te)=AdThdt(41)Q=αhSubstituting (41) in (39), we get:(42)Q1+Q2−αh=AdhdtRewriting (40) as follows:(43)T1Q1+T2Q2−TQ+kp(T−Te)=AdThdt=ATdhdt+AhdTdtAnd substituting (39) in (42), we obtain:(44)T1Q1+T2Q2−TQ+kp(T−Te)=T(Q1+Q2−Q)+AhdTdt(T1−T)Q1+(T2−T)Q2+kp(T−Te)=AhdTdtThe model can also be expressed in function of Q taking into account (41)Q=αh⇒h=1α2Q2⇒dhdt=2α2QdQdtThus, the complete model becomes:(45)−1τQ1(t)+Kτu1(t)=dQ1(t)dt−1τQ2(t)+Kτu2(t)=dQ2(t)dtQ1+Q2−Q=2Aα2QdQdt(T1−T)Q1+(T2−T)Q2+kp(T−Te)=2Aα2Q2dTdtThe state variables are supposed to bex=Q(t)dQdtT(t)dTdtT. Therefore, the output equation becomes:QT=10000010xLet us suppose the following process values:A=1m2,α=1,T1=90°C,T2=10°C,kp=0.1,τ=5sand the following central operating point:u10=2.0438,u20=1.9563,Te=15°C,Q0=4m3s,T0=50°CThus, we can proceed to the identification of the T-S model using some input/output test data. The model becomes:S(i1…i4):Ifx1isM1i1andx2isM2i2andx3isM3i3andx4isM4i4thenx˙=0a20(i1i2i3i4)0a40(i1i2i3i4)+0100a21(i1i2i3i4)a22(i1i2i3i4)a23(i1i2i3i4)a24(i1i2i3i4)0001a41(i1i2i3i4)a42(i1i2i3i4)a43(i1i2i3i4)a44(i1i2i3i4)x+00b21(i1i2i3i4)b22(i1i2i3i4)00b41(i1i2i3i4)b42(i1i2i3i4)u1u2QT=10000010xThe identification of the T-S model is handled according to the methodology presented in Section 6. The work space isQ∈[0.5,7.5],dQdt∈[-0.3,0.3],T∈[15,85],dTdt∈[−12,12]. If we suppose three triangular membership functions for each state variable, we will have 34=81 rules.If we apply the methodology described in [1] and [22], we obtain:S1111:Ifx1isM11andx2isM21andx3isM31andx4isM41thenx˙2=0.0095−0.0147x1−0.1201x2−0.0010x3+0.0020x4+0.0126u1+0.0111u2x˙4=0.7169−0.0356x1−0.7791x2−0.0566x3+0.0190x4−0.0294u1+0.1286u2⋮S3333:Ifx1isM13andx2isM23andx3isM33andx4isM43thenx˙2=0.0095−0.0146x1−0.1201x2−0.0000x3+0.0020x4+0.0127u1+0.0112u2x˙4=0.7187−0.0352x1−0.7795x2+0.0158x3+0.0255x4−0.0342u1+0.1371u2By applying the proposed controller, we gets(x)=51000041x(t)p1(λ)=λ+5,k1=1,Φ1=2p2(λ)=λ+4,k2=5,Φ1=3Figs. 27 and 28show the transient response of the system under study when it is subjected to changes in the flowrate reference signal and temperature reference signal at t=10s and t=20s, respectively. Moreover, it is supposed that an abrupt change is produced in the environmental temperature from Te=15°C to Te=30°C at t=40s. It can be clearly seen that the resultant conrolled system is robust, well damped with zero steady state error inspite of the disturbance effect.Figs. 29 and 30show the phase-plane plot of the flowrate and temperature, respectively. Figs. 31 and 32show the temporal evolution of s1(x) and s2(x), respectively.

@&#CONCLUSIONS@&#
