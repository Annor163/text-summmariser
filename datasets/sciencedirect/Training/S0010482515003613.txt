@&#MAIN-TITLE@&#
Visualization of boundaries in CT volumetric data sets using dynamic

@&#HIGHLIGHTS@&#
We build a generalized boundary model contaminated by noise.We prove boundary middle value has a good statistical property in our boundary model.A dynamicM−|∇f|histogram is established with a novel strategy of boundary extraction to avoid misclassification.A complete application is designed to implement our boundary visualization method.

@&#KEYPHRASES@&#
Direct volume rendering,Multi-dimensional transfer function,Volume visualization,3-D CT volume,Boundary extraction,

@&#ABSTRACT@&#
Direct volume rendering is widely used for three-dimensional medical data visualization such as computed tomography and magnetic resonance imaging. Distinct visualization of boundaries is able to provide valuable and insightful information in many medical applications. However, it is conventionally challenging to detect boundaries reliably due to limitations of the transfer function design. Meanwhile, the interactive strategy is complicated for new users or even experts. In this paper, we build a generalized boundary model contaminated by noise and prove boundary middle value (M) has a good statistical property. Based on the model we propose a user-friendly strategy for the boundary extraction and transfer function design, using M, boundary height(Δh), and gradient magnitude(|∇f|). In fact, it is a dynamic iterative process. First, potential boundaries are sorted orderly from high to low according to the value of their height. Then, users iteratively extract the boundary with the highest value ofΔhin a newly defined domain, where different boundaries are transformed to disjoint vertical bars usingM−|∇f|histogram. In this case, the chance of misclassification among different boundaries decreases.

@&#INTRODUCTION@&#
Direct volume rendering is a widely used visualization technique to demonstrate the internal structures of volume data sets. To generate a meaningful visualization, transfer functions (TFs) should be designed to map data properties (e.g. scalar value, gradient) to optical properties (e.g. color, opacity). Color is used to generate a visual distinction between different data properties. Opacity determines the visual degree for each voxel of the volume data.Since data properties may be changing with different applications, designing an ad hoc TF is quite necessary to make the structures of interest visible and distinguishable. The most commonly used 1-dimensional (1-D) transfer function maps scalar value to color and opacity based on the histogram of scalar value occurrences. Users need to select the materials of interest and set color and opacity by trial-and-error method.The visualization of boundaries of 3-dimensional (3-D) computed tomography (CT) data has a wide range of applications and great significance for disease diagnosis and screening [1–3]. In order to highlight boundaries, gradient magnitude(|∇f|)has been adopted as a data property [4,5]. Adding|∇f|as an independent dimension to the 1-D TF of scalar value, the 2-dimensional (2-D)f−|∇f|histogram [6] has been proposed to facilitate boundary extractions. Boundaries inf−|∇f|histogram are represented as arches, enabling users to extract different boundaries and design TFs for individual boundaries. Nevertheless, it is difficult to extract arches, especially considering the overlapping among arches. Low/high (LH) histogram [7], therefore, has been introduced to overcome the drawback by using the low and high intensities of materials around the boundary as two key data properties. In LH histogram, boundaries are expressed as points (without noise), lines and regions (with noise and bias), making the implementation of boundary extractions much easier.As is known to all, boundaries represented in 2-D histograms are often extracted interactively, while the strategies are too complicated for new users or even experts to follow. For instance, inf−|∇f|histogram users have to precisely pick out each arch by widgets. In LH histogram, users have to pick out each targeted region manually. Under the situation that the noise and overlapping is large, arches with smaller size are apt to be hidden by larger ones inf−|∇f|histogram and different targeted regions tend to merge in LH histogram. Thus, it is a tedious or even impossible task for users via trial-and-error process.Misclassification among different boundaries, to some extent, can be avoided by carefully choosing arches and regions inf−|∇f|and LH histograms respectively. However, as the number of boundaries increases, the effect of misclassification will accumulate gradually. This will likely have a negative impact on the subsequent arches/regions selection. When the effect reaches a certain level, it is impossible for users to pick out the remaining boundaries with high quality. They have to extract boundaries using the original histogram from the very beginning.In this paper, on one hand, we build a generalized boundary model contaminated by noise. On the other hand, based on the model we propose a novel multidimensional TF design method using boundary middle value (M), boundary height(Δh)and gradient magnitude(|∇f|)as data properties. Unlike traditional histograms presenting all boundary information once, the proposed method employs dynamicM−|∇f|histogram and presents only one or a few boundaries at each step. A simple and iterative strategy of boundary extraction is also developed. We first sort different boundaries according to the values of their heights(Δh)from high to low. Users control theΔhvalue until a vertical bar occurs inM−|∇f|histogram, then pick out the boundary represented by the bar inM−|∇f|histogram. Boundaries are extracted one by one until theΔhvalue reaches 0. The misclassification among different boundaries can be reduced with the help of boundary ordering and the one-by-one extraction strategy. Besides, region elimination and region growing are further adopted to enhance the quality of rendering.There are two main contributions. First, we establish a two-material boundary model contaminated by noise and prove that M has a good statistical property in this model. Second, we propose a novel 3-D TF in a newly defined domain, using boundary middle value (M), boundary height(Δh)and gradient magnitude(|∇f|). Based on the dynamicM−|∇f|histogram, we propose an iterative boundary extraction method.In the following section, we describe a variety of related methods. In Section 3, we build a generalized boundary model contaminated by noise. Based on the model we describe the construction and properties of the dynamicM−|∇f|histogram, as well as refining techniques. In Section 4, we show several examples using our method and the traditionalf−|∇f|and LH histograms, and make a comparison. In Section 5, we present the conclusion and future work.

@&#CONCLUSIONS@&#
In this paper, on one hand, we propose a generalized boundary model contaminated by noise and prove M has a good statistical property. On the other hand, we propose an interactive TF design method employing dynamicM−|∇f|histogram. Users extract the vertical bars one by one withΔhfrom high to low. This is a convenience interactive strategy. However, there exist several limitations, which can be overcome to improve the quality of visualizations.First, we employ the C++ container of queue to implement the region growing and region elimination on CPU. This serial implementation leads to the non-real time interaction. In the future, the serial implementation can be replaced by a parallel implementation using CUDA.Second, although we add noise to the boundary, the visualization is not satisfactory when a strong bias occurs in the data set. In the future, two methods can be applied to improve the rendering quality.Multi-scale local extremum search method may be a solution of the instability of the traditional line search. The noise in large scale can be eliminated easily, while the locations of the boundaries are blurred. It is a challenge to balance the pros and cons of the multi-scale extremum search method.Local inherent properties employed in this work are scalar value and gradient. There are other properties such as curvature, texture, etc. How to select and combine these properties is worth a further investigation. Recently, deep learning method brings a new understanding of these properties. Farabet et al. [37] employed ConvNets to extract the properties and label scene for a 2-D image. This inspires us to employ deep learning method in the visualization of 3-D data set in our future work.None declared.