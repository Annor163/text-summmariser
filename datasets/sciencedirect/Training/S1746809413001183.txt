@&#MAIN-TITLE@&#
3D model-based approach to identification of laminar structures of the cerebral cortex: Application to Brodmann areas 17 and 18

@&#HIGHLIGHTS@&#
Automated, model-based algorithm for parcellation of architectonic fields in 3D.Demonstrated on high-resolution Macaque dataset intermediate between MR and microscopic histology.Accurately identified Stria of Gennari and hence the boundary between Brodmann areas 17 and 18.Introduced curvature weighting term that improves parcellation accuracy in highly curved cortical regions.

@&#KEYPHRASES@&#
Cortex,Architectonic field,Automatic parcellation,Three-dimensional,

@&#ABSTRACT@&#
The human cerebral cortex may be subdivided into architectonic fields according to variations within its laminar structure. Studies have shown correspondences between the locations of functional activation foci and architectonic regions. In order to perform accurate localization of functional activation foci to architectonic regions, a parcellation algorithm capable of segmenting architectonic regions on in vivo imaging datasets is required. This paper presents a novel 3D model-based approach to directly detect cortical layers and classify architectonic fields. The column-like structure of the cortex is modeled using a Laplace equation method which generates a collection of intensity profiles that span the cortical mantle. Bayesian evidence for intensity profile elements belonging to hyper- or hypo-intense bands, which represent cell or myelin poor or rich layers in imaging data, is gathered. A non-isotropic Markov Random Field model is used to encourage contiguous bands as well as a penalty term that completes bands across highly curved cortical regions where neighbouring evidence for banding is strong. This algorithm is validated on a 3D histological dataset of a macaque brain with visible layering at intermediate resolution between high-resolution MRI and histology. The algorithm detects the myelin-rich Stria of Gennari and uses this as the basis for finding the Brodmann Area 17/18 boundary.

@&#INTRODUCTION@&#
Classical histological studies have revealed that the human cerebral cortex can be subdivided or parcellated into distinct regions, called architectonic fields, according to their laminar structures. As many brain functions may be localised to subsets of architectonic fields, a major challenge of functional neuroimaging research involves the correlation of functional task-based activation foci to anatomical landmarks [1]. Functional neuroimaging studies typically report group results with respect to structural atlases. The most popular microstructural atlas used by neuroimaging studies is that of Brodmann [2], whose architectonic fields are referred to as Brodmann Areas (BA).Brodmann's atlas, and other atlases produced in the early to mid 20th century (for example von Economo [3], Sarkissov [4], Flechsig [5], Vogt [6] and Mauss [7]) were produced by visual inspection of 2D histological sections. These atlases were based on one of the two principled criteria of cytoarchitecture (referring to size, arrangement, density and shape of neuronal cell bodies) or myeloarchitecture (referring to the orientation, density and thickness of myelin sheaths that surround axons). The subjective nature of the methods applied in classical histological analysis led to differences between their layering schemes and disagreements in the size and number of architectonic fields between atlases [8]. Furthermore, inter-subject variability that may be caused by genetic or environmental factors lead to unknown degrees of uncertainty when interpreting localisation results using these atlases on novel brain images.In order to overcome the inherent uncertainties present of structural atlases, it is essential to apply objective, reproducible parcellation algorithms. Since the cortex is a 3D object with complicated geometry, such automated algorithms should operate in 3D. Desirably, architectonic field parcellation should be achievable in vivo. There is a growing body of evidence that high-resolution MRI may be used to identify the laminar features of the cortex and thus potentially facilitate cortical parcellation of living subjects [9–17] (see [18] for a review).Automated and objective microanatomical cortical parcellation algorithms have been proposed and applied to 2D stained histological tissue [19–21] and 3D MR images of postmortem specimens [22]. Schleicher et al. [19] proposed a sliding window technique in order to estimate the location of borders between architectonic fields in 2D. Schmitt et al. [21] proposed a method that examines changes in the distribution of statistical modes, peaks, to identify architectonic boundaries in 2D. Annese et al. [20] employed a hierarchical clustering technique in order to parcellate predefined numbers of architectonic fields that is 3D-capable. This method is limited since it requires knowledge of how many architectonic fields are to be identified. Bose et al. [22] presented a level-set method to isolate BA 17 by evolving an open surface tangentially to the cortical surface until the surface covered all intensity profiles whose patterns were in agreement with training data previously sampled from the same dataset. Such texture-based methods attempt to parcellate regions based on discriminating intensity patterns that are potentially different between architectonic fields. However, the algorithms do not attempt to explicitly detect the layers themselves and may be affected by changes to intensity profiles unrelated to layering.This work addresses two limitations of current cortical parcellation literature: (i) parcellation algorithms based on detection of cortical layering in 3D, and (ii) application to a dataset whose resolution and intensity contrast is potentially achievable by in vivo MR imaging techniques and whose cortical laminar structures, and hence ground truth boundaries between architectonic fields, are visible. Such a dataset is important for quantitative algorithm evaluation.This paper proposes a model-based algorithm that detects cell- or myelin-dense (or -poor) layers that appear as hypo- or hyper-intense surfaces, which we call “bands”11As opposed to the term “Layer” which refer to a histologically defined entity whose characterisation requires specific criteria be satisfied. Since these criteria may not be satisfiable by the acquired image data, we do not claim that we are identifying Layers.within the cortical mantle. This cortical parcellation technique involves the following steps: (1) segmentation of the image voxels into white matter (WM), grey matter (GM) and background (BG) tissue types, (2) representation of the columnar structure of the cortex by a collection of intensity profiles, which are vectors of sampled image intensities taken along trajectories that span the cortical mantle, (3) classification of intensity profile elements into bands and (4) identification of architectonic fields. The K-means algorithm [23] is employed as a generic intensity-based classifier for labelling voxels as WM, GM or BG tissue types. The Laplace equation method of Jones et al. [24] is used to construct cross-sectional streamlines for sampling intensity profiles from the cortical mantle; this produces equivalent results to the method of Schmitt et al. [25]. The Laplace equation method only guarantees orthogonal traversals of layers close to the inner and outer boundaries. The method of [26] proposed a modification that used image intensity gradients as a cue to the directionality of lamination, which was used to modify the direction of the streamlines to ensure orthogonal traversals of all layers in 2D. This method is effective in correcting the worst geometric distortions to laminae, which occur mostly in 2D imaging where the angle of cutting plane may vary from orthogonal to parallel to laminae within the image. Here, 3D images are used and the streamline trajectories are more likely to remain orthogonal to the layer orientations and correction using image data is less essential. The architectonic field classification algorithm is based on our previous work [27], which gathers Bayesian evidence that intensity profile elements belong to or do not belong to bright or dark bands. The cortical layers are expected to be contiguous, occupy a large number of intensity profiles and have limited local variation in depth. This belief is modelled using a Markov Random Field that encourages neighbouring elements to be like-classified. The algorithm Iterated Conditional Modes [28] is used to construct a locally optimal classification of intensity profile elements.Cortical layer detection using MR imaging is difficult due to the typical voxel resolution being orders of magnitude coarser compared to the typical thickness of a layer. High-resolution MR imaging is able to achieve voxel sizes of the order of (100μm)3 while layer thickness is of the order of 10μm. Table 1summarises the current cortical parcellation literature in terms of image resolution, modality and subject state. This data shows that resolution and image quality are key factors in machine identification of architectonic regions, which has only been successful using histology imaging or high resolution MR imaging on postmortem specimens.To date, there has been no 3D dataset of resolution intermediate between typical layer thickness (10μm) and MR (100μm)3 that provides ground truth for architectonic field boundaries. To address this issue is the second aim of this work: application of a 3D cortical parcellation algorithm to a dataset whose resolution is potentially achievable by in vivo MR imaging techniques, whose cortical laminar structures are visible and whose intensity contrast in the cortex is similar to MR. The 3D histological macaque brain dataset of [29], with a resolution of 55μm×55μm×50μm, is analysed in this work. The grey matter intensities of this dataset mimic myelin density and hence reflect myeloarchitecture, a feature of structural MR images [15,16].Visually evident cues to cortical layering in the data are used as ground truth for evaluating the performance of the proposed algorithm. The focus of applying the algorithm in this paper is identifying Brodmann Area (BA) 17 which is occupied by the heavily myelinated Stria of Gennari (cytoarchitectonic Layer IVb of Brodmann [2], myeloarchitectonic Layer 4 of Mauss [7], outer stripe of Baillarger) and hence find the boundary between BA 17 and its neighbouring region BA 18, which contains no striking evidence of banding. The fields BA 17 and BA 18 are homologous between the Macaque and the human, and the Stria of Gennari has been a focus of cortical parcellation work using in vivo MR images. The algorithm is demonstrated to be able to identify a band corresponding to Layer IVb and hence find BA 17.Cortical layer detection using MR image data is particularly difficult in highly curved regions of the cortical surface, where the cortical layers undergo significant depth and thickness variations [30], since the coarse voxel resolution leads to weak evidence of banding. Clare and Bridge [14] demonstrated that detection rates of Layer IVb in functional V1, putatively BA 17, ranged between 33 and 81% with most errors occurring in highly curved regions of the calcarine sulcus. This limitation is addressed by introducing a cortical surface curvature penalty term that encourages bands to be completed over regions of highly curved cortical surface. Thus, in regions of low data confidence we increase the weight of our prior belief of contiguous bands. For comparison, we demonstrate the results of the algorithm with and without this curvature penalty term. The curvature penalty term reduces the classification error rates in BA 17 whilst retaining the estimated BA 17/BA 18 border.The 3D macaque dataset was acquired and preprocessed at the Laboratory of Neuroimaging, University of California, Los Angeles, according to the methods described in [29]. This dataset features in a stereotaxic atlas of the rhesus monkey brain [31]. Briefly, the brain of a healthy young male rhesus monkey (macaca mullata) was perfused with Methylene blue. Coronal sections were taken at uniform intervals of 50μm and each slice was mounted on a blockface in order to take colour (RGB) images with a Polaroid DMCe digital camera at the pixel resolution of 55μm×55μm. Thus, the voxel size was 55μm×55μm×50μm. Each slice was converted to greyscale format by preserving the brightness channel while discarding the hue and saturation channels.A region of interest within the occipital cortex known to contain BA 17 and BA 18 was selected (Fig. 1). A ground truth parcellation was manually constructed via slice-by-slice markup with a computer-assisted drawing program. The Felleman and Van Essen [32] (FVE) atlas was used as a guide for the manual parcellation.Prior to commencing cortical lamination analysis, we established whether the grey matter intensity patterns reflected cyto- or myelo-architectonic features. Methylene blue stains the neuropil, which are the unmyelinated processes within the grey matter of the central nervous system. As a result, the cortical grey matter was heavily stained and took on a dark blue colour, whilst the white matter, consisting mainly of myelinated axons, was stained lightly and took on a light blue colour. This suggested qualitatively that image intensities reflected myelin density and, hence provide an intensity contrast reflective of myeloarchitecture.The hypothesis of myelin-weighted intensities in the grey matter was quantitatively tested by inspecting manually sampled 2D intensity profiles from a slice in the ROI with visible laminar features (Fig. 2). Fig. 2(i) shows the location of the slice, Fig. 2(ii) displays the slice and Fig. 2(iii) shows the ground truth parcellation of the slice into BA 17 and BA 18, which matches closely with the parcellation of a similar slice in the FVE atlas (Fig. 2(iv)). The only consistent laminar feature in the image was a bright band that appeared between the range of approximately 40–60% cortical depth and was present in BA 17 but not in BA 18. This band most likely represents the heavily myelinated Stria of Gennari, which resides in BA 17 but not in BA 18. Intensity profiles were extracted from BA 17 (see Fig. 2(v)–(vi)) and BA 18 (Fig. 2(vii)). A small hump at the expected depth of Layer IVb is seen in both BA 17 intensity profiles but not in the BA 18 intensity profile.A second bright band, deeper than Layer IVb, appears occasionally in BA 17 but not in BA 18 (see Fig. 2(ii)). This band likely represents the inner stripe of Baillarger or Layer 5b of Mauss [7]. Layer 5b is thinner and less densely myelinated than Layer IVb but is more densely myelinated than its neighbouring layers. The relatively low thickness of Layer 5b is the most likely explanation for its intermittent appearance in this dataset. Specifically Layer 5b is not visible in much of the calcarine sulcus or occipital gyrus in this dataset.The qualitative evidence of bright white matter compared to grey matter and bright cortical banding that corresponds to layers known to be heavily myelinated supports our hypothesis of myelin-weighted image intensities in the grey matter. Hence, the intensity profiles extracted from the cortex are indicative of myeloarchitecture.The cortical parcellation method used in this work consists of 4 steps: (1) Voxel segmentation, (2) Column-like structure extraction and intensity profile sampling, (3) Band classification, and (4) Architectonic field labelling. A flowchart of our method is given in Fig. 3.Step 1: Voxel segmentation. Voxel segmentation involved classifying each voxel into one of the following tissue types: white matter (WM), grey matter (GM) and background (BG).22BG includes voxels with no signal and any tissue residing superficially to the cortical surface.For this dataset we utilised the automatic K-Means algorithm [23]. Any voxel segmentation algorithm, however, may be used interchangeably depending on the dataset.Step 2: Column-like structure extraction and intensity profile sampling. The column-like structure of the cortex, in each hemisphere, was modelled by a collection of cross-sectional streamlines that were constructed according to the Laplace equation based method of Jones et al. [24].The streamline initialisation points were chosen to lie on a triangular mesh approximation of the midpoint equipotential surface of the Laplace equation solution. Thus, complete cross-sectional streamlines were formed by concatenating the streamlines that intersected with the inner and outer cortical boundaries. Vertices were marked as “invalid” if they were associated with streamlines that did not intersect with both cortical boundary surfaces.Intensity profiles were formed by resampling each streamline to a common number, M, of evenly-spaced points that were used to perform linear interpolation on image voxels. The value of M was chosen to ensure that the grey matter voxels across the cortical mantle were densely sampled. For the voxel size of 0.05mm3 and a maximum cortical thickness of approximately 4.5mm, we chose the number of samples to be M=128 so that every voxel within a column would be sampled from. Consider that N intensity profiles were generated, then the collection of intensity profiles is denoted by the matrixd=[dk,i]M×N. Each intensity profile element is real-valueddk,i∈ℝ. The edges of the triangular mesh created to initialise the streamlines determine the first order neighbours of each intensity profile.Intensity profiles were filtered using the same approach of [27]. This method was centered on the observation that after appropriate filtering, bright bands appear as smoothed peaks within intensity profiles. Smoothing was conducted with box averaging filters of size [5(vertical)×τ(horizontal)], where τ denotes the smoothing size parameter. Here, the terms vertical and horizontal are used to denote displacement from a reference intensity profile element (k, i), so that a vertically displaced element is any other element in the same intensity profile (i.e. modifying k), whilst a horizontally displaced element is any element in another intensity profile at the same cortical depth (i.e. modifying i).Step 3: Band classification. The band classification method involves classifying each intensity profile element as either belonging or not belonging to a bright or dark band. Denote sk,ias the classification of element k within intensity profile i. DenoteSas the set of all intensity profile element classification random variables, defined as follows:(1)S={sk,i:k=1,2,…,M;i=1,2,…,N}.Lets={s1,1, …, sM,N} be a configuration of the classification variables. Let the common state space be denoted Λ=“No Band”, “Band”, so that sk,i∈Λ for all k and all i. Let sk,i=“Band” denote that element k of intensity profile i is classified as belonging to a band. All configurations are assumed to have non-zero probability, thus the minimal sample space can be written as:(2)Ω={s:sk,i∈Λ;k=1,…,M;i=1,2,…,N}.The problem of computing an optimal classifying the intensity profile elements,s*, given the observed intensity profiles, within the Bayesian maximum a posteriori estimation problem is formally expressed as:(3)s*=argmaxs∈Ωp(s|d),∝argmaxs∈Ωp(s)∏i=1N∏k=1Ml(dk,i|sk,i),where l(dk,i|sk,i) denotes the likelihood distribution, p(s) denotes the joint prior distribution and the transition from the first line to the second line involved the application of Bayes’ rule and an assumption of conditional independence of the intensity profile element intensities. This conditional independence is not strictly satisfied due to the data smoothing step described earlier, however the amount of smoothing is small compared to the expected number of intensity profiles that a cortical band occupies.Only local dependence of the data, within a window of size m, denoted the quadratic window size parameter, is assumed. Each intensity profile is interpreted as a function whose horizontal axis is the intensity profile element and the vertical axis is the measured intensities (Fig. 4). For each intensity profile element a quadratic is fitted to the neighbourhood [dk−m,i, …dk,i…dk+m,i]. Let the quadratic for element k of intensity profile i be(4)qk,i(x)=ak,ix2+bk,ix+ck,i.The magnitude of the vector that joins the coordinate of the intensity profile element, (k, dk,i), and the turning point of the fitted quadratic,(kˆ,qk,i(kˆ)), is computed as follows:(5)||k,dk,i−kˆ,qk,i(kˆ)||=(k−kˆ)2+(dk,i−qk,i(kˆ))2,where(6)kˆ=−bk,i2ak,i.The magnitude (5) will be small if the intensity profile element is in close proximity to the centre of a peak or trough, and large otherwise. For example, the leftmost and rightmost highlighted points in Fig. 4 are situated close to and far away from the centre of strong bands. The vector connecting the leftmost highlighted point in Fig. 4 to its quadratic turning point is small, meaning (5) would be small and hence this element would receive a high likelihood. In contrast, the vector connecting the rightmost highlighted point in Fig. 4 is large, yielding a high magnitude (5) and a lower likelihood.The likelihood distribution for “Band” classification of each intensity profile element is constructed by modelling (5) as a Gaussian distribution:(7)ldk,i|sk,i=“Band”∼N(k−kˆ)2+(dk,i−qk,i(kˆ))2,ρ2|ak,i|whereρ∈ℝ+denotes a user-defined parameter that is used to weight the influence of ak,i. The scaling of the distance by the second order coefficient of the fitted quadratic, ak,i, weights likelihood values towards intensity profile elements that are situated in strong peaks (more likely to be a band) and away from intensity profile elements that are situated in flat regions of the intensity profile (more likely to be an undefined band or noise).The prior distribution was constructed to reflect the belief that the cortical bands are large, occupying many intensity profiles, and spatially contiguous. Locally, this is expressed in the belief that intensity profile elements in close proximity should be like-classified. This like-classification belief is formally modelled by assuming that the vector of classification variables,S, is a Markov Random Field (MRF) with pairwise cliques. Thus, the joint prior, p(s), is expressed via conditional distributions at each intensity profile element (k, i) using the Gibbs form,(8)p(sk,i|sNk,i)∝exp−∑(l,j)∈Nk,iɛV(sk,i,sl,j),where V(sk,i, sl,j) denotes the potential function. The neighbourhood systemNk,iɛis parametrised and hierarchical and formally defined as follows:(9)Nk,iɛ=(k,j)(horizontal)(k±1,i),(k±2,i),…,(k±α,i)(vertical)(k±1,j),(k±2,j),…,(k±α,j)(diagonal)wherej∈Niɛ, α and ɛ are positive integer tuning parameters that control the numbers of vertical and horizontal neighbours, respectively. The intensity profile neighbourhood,Niɛ, contains all intensity profiles j whose geodesic distances along the cortical surface from i, according to the triangular mesh-based edges, are less than or equal to ɛ edges. See Fig. 5for a schematic view of the neighbourhood system defined in (9). Both α and ɛ influence the expected smoothness of the final classification, where an increase in α encourages thicker band estimations while an increase in ɛ encourages band estimations to occupy a greater number of contiguous intensity profiles.Letsˆk,idenote the provisional classification of element (k, i). The potential function, V(·, ·), is defined at element (k, i) separately for horizontal (k, j), diagonal (l, j) and vertical (l, i) neighbours according to the following set of equations:(10)V(sk,i,sk,j)=2ζnf(Ki,sk,i)sk,i≠sˆk,j0sk,i=sˆk,j(horizontal)(11)V(sk,i,sl,j)=ζnf(Ki,sk,i)sk,i≠sˆl,j0sk,i=sˆl,j(diagonal)(12)V(sk,i,sl,i)=ζnsk,i≠sˆl,i0sk,i=sˆl,i(vertical)wherej∈Niɛ, l∈{k−α, …, k−1, k+1, …, k+α}, ζn=N/4|E| is a normalisation constant and |E| denotes the number of edges in the triangulated surface. Note that only classifications that are dissimilar between an element and its neighbours are penalised in equations (10), (11), and (12), thus the classification is encouraged to be smooth.The horizontal and diagonal potential functions are scaled using the cortical surface curvature penalty term (CSCPT), f(Ki, sk,i), which is the smoothed Heaviside function (Fig. 6):(13)f(Ki,sk,i)=ηKtanh(wK(log|Ki|)−τK)+ηK+1sk,i=“NoBand”1(nopenalty)otherwisesuch that the Gaussian curvature of the triangulated cortical surface, Ki, is computed using the method of Desbrun et al. [33] and ηK, τK, andwKare user-defined constants. The value τKis used to translate the ramp region of the tanh function to overlap the curvature distribution (Fig. 6). The values τKandwKare chosen to ensure that regions of minimal curvature produce no penalty and regions of maximal curvature, the fundi33The plural form of fundus in anatomy, referring to the bottom or the lowest part of a hollow organ; that part which is the farthest from the opening.of sulci for example, will return a higher penalty. The parameter ηKcontrols the weighting of the penalty term. Given that (13) is only active for the “No Band” class and the potential functions only penalise dissimilar classifications, (11) and (10), the effect of the CSCPT is to discourage discontinuities in bands where the cortex is highly curved. In other words bands are encouraged to be completed over highly curved cortical regions.In order to evaluate the effect of algorithm tuning parameter values on classification accuracy the variables m, τ, and ɛ were subject to a factorial sweep; the particular values employed are shown in Table 2. For this parameter sweep, the following parameters were fixed: the number of vertical neighbours (α=1), and the CSCPT parameters ηK=2, τK=3, andwK=0.4. For comparison, we ran the parameter sweep with the CSCPT disabled, i.e. ηK=0. These values were tuned for this dataset and may need to be altered for a novel datasets.The optimisation algorithm used to evaluate (3) within the context of the likelihood (7) and prior (8) models previously specified will now be described. The Iterated Conditional Modes (ICM) [28] algorithm was used to sequentially update each classification variable sk,iby minimising the negated log posterior as follows:(14)sk,i=argminsk,i[−logp(dk,i|sk,i)+∑(l,j)∈Nk,iɛV(sk,i,sˆl,j)]ICM sweeps across all intensity profile elements in a randomised manner to avoid introducing bias. The algorithm is terminated when, at the conclusion of an iteration, the number of changed classification variables between iterations does not exceed a predetermined threshold.Connected components of band classified elements are identified, which are interpreted as the estimated locations of bands. Given that the architectonic fields are assumed to be large, bands that do not occupy many intensity profiles are likely to be unrepresentative of a real layer. To remove these transient bands we remove connected components of “Band” classified elements that do not occupy more than a user-defined threshold of number of intensity profiles. Users should select a number of intensity profiles that reflects the expected size of architectonic fields in their dataset. The connected component threshold was set to 10,000 intensity profiles so that bands that occupied less than 10,000, which was approximately a radius of 2mm in this dataset, were not considered significant and were deleted.Step 4: Architectonic field labelling. The final component of the algorithm was to classify collections of bands within intensity profiles as representing architectonic fields. Each intensity profile is classified into an architectonic field according to the combination of connected components labels that are present. For this dataset, we employed the following classification scheme for each intensity profile: BA 18 if no bands were present, BA 17 if one band, Layer IVb, or two bands, Layer IVb and Layer 5b, were present.

@&#CONCLUSIONS@&#
This work has proposed a 3D, Bayesian model-based algorithm for identifying the microscopic cortical layers in order to perform architectonic field parcellation. The algorithm was applied to a high-resolution 3D dataset of a postmortem macaque brain which had evidence of lamination in BA 17, and was used to detect the boundary between BA 17 and BA 18. The parcellation method was able to detect cortical layers at the resolution of 55μm×55μm×50μm. The proposed parcellation method directly translates to high-resolution MR images that contain evidence of cortical lamination and, therefore, may be appropriate for in vivo cortical parcellation. Such a method will produce individualised cortical atlases, with important applications in structure-function correlations and accurate localisation of functional activation foci to underlying anatomy.