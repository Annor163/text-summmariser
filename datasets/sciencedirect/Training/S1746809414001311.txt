@&#MAIN-TITLE@&#
Heart diseases prediction based on ECG signals’ classification using a genetic-fuzzy system and dynamical model of ECG signals

@&#HIGHLIGHTS@&#
We use a set of three differential equations as a dynamical model of ECG signals.We analyze the changes occurred in the ECG model parameters due to arrhythmias.Two classifiers are constructed to classify ECG signals according to the parameter changes.Classifiers can identify similarities between ECGs and segregate them using these similarities.We predict heart condition of clinically obtained ECGs more precisely through these classifiers.

@&#KEYPHRASES@&#
Electrocardiogram (ECG) signals classification,ECG signals dynamical model,Genetic algorithm,Genetic-fuzzy system,Fuzzy logic,

@&#ABSTRACT@&#
The early detection of abnormal heart conditions is vital to identify heart problems and avoid sudden cardiac death. The people with similar heart conditions almost have similar electrocardiogram (ECG) signals. By analyzing the ECG signals’ patterns one can predict arrhythmias. Since the conventional methods of arrhythmia detection rely on observing morphological features of the ECG signals which are tedious and very time consuming, the automatic detection of arrhythmia is more preferable. In order to automate detection of heart diseases an adequate algorithm is required which could classify the ECG signals with unknown features according to the similarities between them and the ECG signals with known features. If this classifier can find the similarities precisely, the probability of arrhythmia detection is increased and this algorithm can become a useful means in laboratories. In this article a new classification method is presented to classify ECG signals more precisely based on dynamical model of the ECG signal. In this proposed method a fuzzy classifier is constructed and its simulation results indicate that this classifier can segregate the ECGs with an accuracy of 93.34%. To further improve the performance of this classifier, genetic algorithm is applied where the accuracy in prediction is increased up to 98.67%. This proposed method increases the accuracy of the ECG classification regarding more precise arrhythmia detection.

@&#INTRODUCTION@&#
The electrocardiogram (ECG) signals are the recordings of the bioelectrical activities of the cardiac system and some or all parts of these signals are changed from normal condition when heart disease occurs [1,2]. People with similar heart conditions have almost ECG signals with similar features. If an ECG signal with unknown features has a morphological pattern similar to that of an ECG signal with an especial arrhythmia, it could be deduced that this unknown signal has the same arrhythmia. In such cases, it is possible to detect the heart disease by analyzing the pattern of the ECG signals.Early detection of abnormal heart conditions can avoid sudden cardiac death and other dangerous illnesses caused by heart disease. Many researchers have reported results on analyzing the ECG signals and detecting the abnormal conditions thereof. To detect such conditions in laboratory, a continuous ECG signal monitoring is required for each patient. This procedure is tedious and very time consuming. Automation of the ECG signal analysis based on computer programming is a better system to diagnose heart diseases. In this article a new automatic categorization method is proposed that can classify similar ECG signals into one group and predict the potential of the heart diseases in each group.Several techniques on automatic detection of the abnormal conditions are reported. In these reports, the analysis of the ECG signals to detect these abnormal conditions is conducted by using autocorrelation function, frequency domain features, time frequency analysis and wavelet transform [3–7]. Since these techniques ignore the nonlinear behavior of the signal dynamics, the information provided on ECG signals are insufficient and their classification based on these techniques is not acceptable. To avoid this deficiency several articles in the area of the nonlinear analysis and chaos theory in studying the behavior of the ECG signal from an experimental time series are published. The objective of these articles is to determine whether the dynamical measures such as correlation dimension and especially the greatest Lyapunov exponent can serve as useful tools for ECG classification. Though there exist good results on distinguishing between normal and abnormal patients, segregation between abnormal ECG signals and their acceptable classification is yet to be perfected [8–18].Attempt is made in this article to introduce a method based on dynamical model of the ECG signal that can classify ECG signals in a more precise manner which would enhance the prediction of the illnesses related to the heart diseases.This method is found on the fact that similar ECG signals have almost similar heart conditions and when these ECG signals are modeled a similarity is observed among their parameters. When the parameters of the dynamical model of the ECG signals are obtained, by applying adequate classifier the ECG signals can be classified according to these parameters. Through this classification, since the ECG signals placed in one group indicate similar heart condition, the heart condition of the unknown signals can be predicted.In order to construct this classifier: first, the genetic algorithm (GA) is applied to estimate unknown parameters of the dynamical model of the clinically obtained ECG signals from PhysioBank database [19], second, by studying a group of ECG signals with known features, a set of fuzzy rules is generated and through them a fuzzy classifier is constructed. Here, to improve the performance of this fuzzy classifier, the GA is applied to optimize the membership functions and fuzzy rules which lead to the construction of a genetic-fuzzy classifier. Finally, this genetic-fuzzy classifier is implemented for ECG signal classification.The structure of this article is as follows: the dynamical model of the ECG signal, the genetic algorithm and its application in estimation of the unknown parameters of the dynamical model are presented in Section 2. The theory of the fuzzy and genetic-fuzzy classifiers is introduced in Section 3 which are used in classification of the ECG signals. The results and discussion are presented in Section 4 and finally, the conclusions in Section 5 end the article.If an ECG signal can be modeled precisely by differential equations, one can study this signal using certain mathematical tools. Modeling of the ECG signal by differential equations is of essence, where the effect of heart diseases on ECG signals can be analyzed by using the mathematical software like MATLAB. When the effect of the heart diseases are modeled, by a suitable computer program, the prediction and diagnosis of the heart diseases can be made and conducted, respectively, on an automatic basis.The initial model of the ECG signal was reported in 1972 by Zeeman [20], where the effects of the sympathetic and parasympathetic nervous system are not considered. A new model for ECG signal is proposed in [21], where a new parameter according to the activities of sympathetic and parasympathetic systems is defined and applied in the Zeeman model. Afterwards, an improved and flexible model for generating ECG signal which generates a trajectory in the three-dimensional state-space with coordinates (x, y, z) is introduced; in addition to the fact that the variation of the ECG is produced through the trajectory motion at z direction [22]. This model is described using three ordinary differential equations presented in (1). The accuracy and some applications of this model are studied in [23].(1)x˙=αx−wyy˙=αy−wxz˙=−∑i∈{P,Q,R,S,T}αiΔθiexp−Δθi22bi2−(z−z0)whereα=1−x2+y2,Δθi=(θ−θi)mod2π,θ=αtan2(y,x)(the four quadrant arctangent of the real parts of the elements of x and y, with −π≤αtan2(y, x)≤π) and w is the angular velocity of the trajectory, zo=Asin(2πf2t) where A=0.15mV and f2 is the respiratory frequency [22]. The details of these three differential equations are presented in Appendix I.According to [22], distinct points on the ECG signal like the P, Q, R, S, and T used in (1) can be configured by setting ai, bi, and θiparameters. The location of these points is set by θi, as well as the amplitude and the width of the ECG waves are set by aiand bi. Proper setting of these parameters would generate a desirable ECG signal; therefore, by applying the parameters of Table 1in (1), the ECG signal is generated through MATLAB and illustrated in Fig. 1a. The real ECG signal [19] which has characteristics similar to the simulated ECG is demonstrated in Fig. 1b to compare real ECG and ECG signal generated by simulating (1).Since heart diseases change the ECG signal model parameters, recognizing the effects of these parameters’ changes through related computer programs make the prediction of the heart diseases more rapid in an automatic manner.In the ECG model by changing the parameters ai, bi, and θia desirable ECG signal can be generated. The value of these parameters is different in the patients with different heart conditions, and these differences are illustrated in Table 2, where one individual is normal and the other has an Atrial fibrillation (AF) arrhythmia.After the values of these parameters for various heart diseases are identified, then, the values obtained from ECG signal of a patient with unknown disease are compared to these identified values which would contribute to the diagnosis of the heart diseases.The ECG signals in clinics always are obtained in the form of a continuous signal and a direct access to accurate values of these parameters is not possible; therefore, in order to obtain these parameters, the ECG signal must be sampled and these parameters must be calculated through estimation techniques.Because the dynamical model of the ECG contains three nonlinear differential equations, the classic estimation methods cannot be adopted in estimating the unknown parameters of this model [24–26].The GA is applied in order to estimate these parameters. In this proposed method, the unknown parameters of the ECG signal are estimated in a manner where the error function defined in (2) is minimized (or its inverse is maximized). In (2), s1 is the sampled ECG signal obtained from continuous ECG signal acquired in clinical environment with unknown parameters, and s2 is the signal generated by simulating (1). Both the s1 and s2 are sampled in the same frequency.(2)e=∑i(s1(i)−s2(i)),F=1/eIn this estimation technique, the parameters of s2 are changed by GA in a manner that the value of the error function is decreased to a value lower than predefined threshold, or the value of F reaching a value higher than predefined threshold.The objective of the GA is to search and find the unknown parameters (ai, bi, and θi) in order to maximize the F value. The chromosomes used in this estimation have 112 genes consisting of a1, a2, a3, a4, a5, b1, b2, b3, b4, b5, θ1, θ2, θ4 and θ5 parameters, where the samples are: a1 is the value of the parameter a for the P-wave, b2 is the value of the parameter b for the Q-wave, b3 is the value of the parameter b for the R-wave and θ4 is the value of the parameter θ for the S-wave. In this estimation, since the parameter θ3 representing R-wave position is always zero, it is ignored. Each one of these parameters is coded in a binary form and consists of eight genes. The real values of these parameters are obtained by converting these binary values to decimal values.The first GA population used in this estimation consists of fifty random chromosomes. In this estimation, the values of 0.06 and 0.6 are selected as the mutation and cross-over rates, respectively, according to the rule reported in [24]. For selecting the 0.06 and 0.6 values the trial-and-error method is adopted here. After thirty iteration of the GA, the best chromosome with maximum F is selected as an optimal solution. In order to select a suitable number of iterations, some simulations are made at the beginning with fifty iterations. The simulation results indicate that the optimal chromosome is found by GA after about 26 iterations, and hence, to be on the safe side, the thirty iterations is selected. After obtaining the optimal chromosome, the optimal values of the parameters of s1 are obtained. For examining the accuracy of this estimation method, an ECG signal of the normal person with known parameters [19] is selected and this proposed technique is applied for estimating its parameters. The outcome of the thirty iterations, the real values and the estimated values of the ECG parameters are illustrated in Table 3. In this estimation, parameter i is equal to 65,536 (number of data points obtained from the ECG signal sampling) and the value of the error function for the optimal chromosome is 0.139, indicating that, GA is a suitable method for estimating the unknown parameters of the ECGs obtained in clinics. Based on the results obtained from this proposed estimation, the ECG signals can be classified with respect to the estimated parameters.In this article, the ECG signals of four groups: normal heart beat (NHB), congestive heart failure beat (CHF), ventricular tachyarrhythmia beat (VT), and AF (Appendix II), each with seventy five ECG signals are collected from PhysioBank; the parameters of which are obtained through this proposed estimation method. By using these values, the membership function of each parameter is generated, which contribute to the construction of the fuzzy rules. These fuzzy rules in turn contribute to the classification of the ECG signals and prediction of heart diseases.Here a fuzzy classifier is applied in ECG signals. In this fuzzy classifier the membership functions are used for describing the input data. The procedure of generating membership functions for ECG parameters is described here. This procedure is used for generating membership function of all ECG model parameters. These membership functions are obtained after estimating the parameters of one hundred ECG signals with known heart conditions. After identifying these values, according to the upper and lower limits of these parameters (Table 4), the membership functions are constructed. After studying the values of a1 parameter of all one hundred signals, the membership function of this parameter is generated and demonstrated as a sample in Fig. 2.In this proposed fuzzy classifier a set of IF THEN rules is generated based on the study conducted on the features of the same one hundred ECG signals and the constructed membership functions. These one hundred ECG signals are in four groups of (NHB), (CHF), (VT), and (AF) mentioned above, where each one consists of twenty-five ECG signals with known heart conditions in accordance with the PhysioBank database. The form of these fuzzy rules is as follows:(3)Rule1:IFa1isZEANDθ3isPSTHENSisAF.(4)Rule2:IFθ1isNLANDθ5isPLTHENSisCHF.where a1, a2, a3, a4, a5, b1, b2, b3, b4, b5, θ1, θ2, θ3, θ4 and θ5 are the ECG parameters, NL, NM, NS, ZE, PS, PM and PL are the fuzzy sets and S is an ECG signal with unknown features the condition of which must be identified. In fuzzy set definition, NS, ZE, PM and PL are negative small, zero, positive medium and positive large, respectively.After studying all ECG signals with known features, twelve rules are generated. Because the desired output of this proposed fuzzy classifier is an ECG group and is not a number; therefore, assigning unknown ECG signals to these groups using fuzzy rules must be made in a proper manner. To do this, one membership function is generated for the output and one fuzzy set is defined for each one of these ECG groups. Construction of the fuzzy sets must be presented in a manner where in the defuzzification phase the ECG groups are segregated perfectly. Furthermore, this membership function must be generated in a manner where the incorrect selection of a group is prevented (Fig. 3).In general, several rules can be corrected under the same circumstance, while only one group must be selected for unknown ECG signal. To obtain proper classification, the contribution of each rule must be combined in an appropriate manner. Here, the sup-min (supermom-minimum) composition method is adopted. Moreover, for defuzzification of the output, the center of gravity (COG) method, presented in (5) is adopted, as follows:(5)Z*=∑i=1K(zi⋅μ(zi))∑i=1Kμ(zi)where, Z* is the value of the output obtained from defuzzification, K is the number of the fuzzy rules, and values of ziand μ(zi) are calculated through the sup-min composition [27]. By applying Z* according to Fig. 3 the ECG signals are classified. The performance of this classifier is investigated in Section 4.For increasing the accuracy of the fuzzy classifier the GA is applied in generating a genetic-fuzzy classifier. In this approach, the fuzzy sets, membership functions and fuzzy rules are optimized through GA, where twelve rules with optimum configuration are generated. The simulation results indicate that the accuracy of the classification is increased significantly; therefore, the heart diseases can be predicted more precisely. The performance of this classifier is investigated in Section 4.

@&#CONCLUSIONS@&#
