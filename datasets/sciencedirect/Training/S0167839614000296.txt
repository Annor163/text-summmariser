@&#MAIN-TITLE@&#
C-shaped

@&#HIGHLIGHTS@&#
The method reproduces a conic arc if the input data come from such a conic curve.The method can reproduce a ‘whole’ conic curve even if it has singularities.The Bézier control points have well understood geometrical meaning.The final rational Bézier control points and weights are given in explicit form.Each of the tangential angles of the given tangent vectors can be arbitrary up to π.

@&#KEYPHRASES@&#
Rational conic Bézier curve,Rational cubic Bézier curve,G,2,Hermite interpolation,Conic precision,

@&#ABSTRACT@&#
We present a simple method for C-shapedG2Hermite interpolation by a rational cubic Bézier curve with conic precision. For the interpolating rational cubic Bézier curve, we derive its control points according to two conic Bézier curves, both matching theG1Hermite data and one end curvature of the givenG2Hermite data, and the weights are obtained by the two given end curvatures. The conic precision property is based on the fact that the two conic Bézier curves are the same when the givenG2Hermite data are sampled from a conic. Both the control points and weights of the resulting rational cubic Bézier curve are expressed in explicit form.

@&#INTRODUCTION@&#
It's well known that (rational) Bézier curves (Farin, 1996) are widely used in Computer Aided Geometric Design (CAGD). Especially,G2Hermite interpolation, interpolating points as well as their tangent vectors and curvatures, by rational cubic Bézier curves have been extensively studied in the literature (Farin, 1996; de Boor et al., 1987; Goodman, 1988; Degen, 1993; Sakai, 2001; Chen et al., 2002; Walton and Meek, 2011; Li and Deng, 2012).Recently, methods on interpolatingG1(Farin, 2008; Femiani et al., 2012) orG2(Walton and Meek, 2011; Li and Deng, 2012) Hermite data by rational cubic Bézier curve with circular arc precision property have been proposed. However, to our best knowledge, there are no methods onG2Hermite interpolation by rational cubic Bézier curves with conic precision. In consideration of the important applications of conics in CAGD, we propose such a method in this paper.Applying the reparametrization method, rational Bézier curve can be transformed to standard form: both the first and the last weight are equal to 1. For such rational cubic Bézier curve, it is easy to derive the other two weights according to the givenG2Hermite data under the condition that its control polygon is determined (Farin, 1996; Goodman, 1988). However, they do not describe how to select the Bézier polygons to meet the conic precision property. We also use the rational cubic Bézier curve with standard form. The difference between our method and those of Farin (1996), Goodman (1988) lies in how to construct the control polygon. We derive the control points according to two conic Bézier curves, both matching theG1Hermite data and one end curvature of the givenG2Hermite data. The conic precision property is based on the fact that the two conic Bézier curves are the same conic which the givenG2Hermite data sampled from. We give the explicit form for both the control points and the weights of the interpolating rational cubic Bézier curve.The rest of this paper is organized as follows. The definitions of rational conic and cubic Bézier curves and their relations are given in Section 2. Then in Section 3,G2Hermite data interpolation by rational cubic Bézier curve and its conic precision property are proposed. Examples and remarks are presented in Section 4. Section 5 is devoted to conclusions.A rational conic Bézier curve with weights 1,w>0, 1 and control pointsqi(i=0,1,2)is defined as (Piegl and Tiller, 1997):(1)r(t)=(1−t)2q0+2(1−t)twq1+t2q2(1−t)2+2(1−t)tw+t2,0⩽t⩽1.If the weight is extended within the interval−1<w<0, the rational conic Bézier curve (1) is an ellipse arc, while ifw=−1orw<−1, it's a parabolic curve or a hyperbolic curve with singular points.The two end curvatures of rational conic Bézier curve are(2)κ(0)=‖(q1−q0)×(q2−q1)‖2w2‖q1−q0‖3,κ(1)=‖(q2−q1)×(q1−q0)‖2w2‖q2−q1‖3.A rational cubic Bézier curve is defined by weightsw1,w2>0and control pointsbi(i=0,1,2,3)(Piegl and Tiller, 1997) as(3)r(t)=(1−t)3b0+3(1−t)2tw1b1+3(1−t)t2w2b2+t3b3(1−t)3+3(1−t)2tw1+3(1−t)t2w2+t3,0⩽t⩽1.Its two end curvatures are(4)κ(0)=2w2‖(b1−b0)×(b2−b1)‖3w12‖b1−b0‖3,κ(1)=2w1‖(b3−b2)×(b2−b1)‖3w22‖b3−b2‖3.Rational conic Bézier curve (1) can be exactly represented by rational cubic Bézier curve (3) with weightsw1=w2=(1+2w)/3and control pointsb0=q0,b1=q0+2wq11+2w,b2=q2+2wq11+2w,b3=q2.Ifw=−12, thenw1=w2=0, which meansb1,b2are points of infinity. In general, a rational cubic curve cannot be exactly represented by a conic, but we haveLemma 1Ifw1,w2>0, the rational cubic curve(3)is a conic arc if and only if (Wang and Wang, 1992):1.b0b1b2b3is a planar convex quadrilateral and any three points cannot be on the same line;w12w2=S123S0S2,w22w1=S223S1S3;GivenG2Hermite data{b0,T0,κ0;b3,T1,κ1}, without loss of generality, we assume that the middle point of line segmentb0b3be the origin O, andb0b3be the positive direction of x-axis,‖b3−b0‖=L. Let α be the angle fromb0b3toT0and β be the angle fromT1tob0b3, then C-shapedG2Hermite data means0<α,β<π(see Fig. 1). The control points of the rational Bézier cubic curve matching{b0,T0;b3,T1}are:(5)b0=(−L/2,0),b3=(L/2,0),b1=b0+u(cosα,sinα),b2=b3+v(−cosβ,sinβ),whereu=‖b0b1‖,v=‖b2b3‖.In the following we describe the interpolating method by classifying two cases, i.e.,α+β≠π(Section 3.1) andα+β=π(Section 3.2).Let b be the intersection point of radial linesb0T0,b3T1(see Fig. 2):(6)b=b3+Lsinαsin(α+β)(−cosβ,sinβ).With control pointsb0, b,b3and a free weight w, the rational conic Bézier curver(t)interpolatesG1Hermite data{b0,T0;b3,T1}. In general, it is impossible to find a weight w matchingκ0atb0andκ1atb3simultaneously, but it is possible to have a weightwLmatchingκ0atb0and another weightwRmatchingκ1atb3. According to Eq. (2), we have(7)wL=sinα2Lκ0sin(α+β)sinβ,wR=sinβ2Lκ1sin(α+β)sinα.Now with control pointsb0, b,b3and weightswL,wR, two rational conic curvesrL(t),rR(t)are constructed. Both of two conics interpolateG1Hermite data{b0,T0;b3,T1}, and the curvatures ofrL(t)atb0,rR(t)atb3areκ0,κ1, respectively. Note thatwL,wR>0for0<α+β<π, whilewL,wR<0forπ<α+β<2π.To guarantee that the weights are positive after degree elevation of these two conics,wL,wRshould be greater than−12. IfwS⩽−12, we define(8)wS=−X2X+2>−12,S={L,R},whereX=min{‖b0−b3‖‖b0−b‖,‖b0−b3‖‖b3−b‖,1}.We know‖b0−b1‖=‖b0−b0+2wLb1+2wL‖=(11+2wL−1)‖b0−b‖⩽(11−2‖b0−b3‖‖b0−b‖2‖b0−b3‖‖b0−b‖+2−1)‖b0−b‖=‖b0−b3‖,and similarly we have‖b3−b2‖⩽‖b0−b3‖, thus edges‖b0−b1‖,‖b3−b2‖are shorter than‖b0−b3‖. It means that edges‖b0−b1‖,‖b3−b2‖are bounded by‖b0−b3‖.Elevating the degree ofrL(t)andrR(t)to three, we get two rational cubic Bézier curves,r¯L(t)andr¯R(t)with control points (see Fig. 3)(9)b0,b1L=b0+2wLb1+2wL,b2L=b3+2wLb1+2wL,b3,(10)b0,b1R=b0+2wRb1+2wR,b2R=b3+2wRb1+2wR,b3.The control points of the interpolating rational cubic Bézier curver(t)are then defined by (see Fig. 3)b0,b1=b1L+b1R2,b2=b2L+b2R2,b3.Adopting the method of Farin (1996) (p. 234), by Eq. (4) and interpolating condition, we finally get the weights(11)w1=23C1C02κ1κ023,w2=23C0C12κ0κ123,where(12)C0=‖(b1−b0)×(b2−b1)‖‖b1−b0‖3,C1=‖(b3−b2)×(b2−b1)‖‖b3−b2‖3.There is no intersection point of radial linesb0T0,b3T1in this case, and so we construct the interpolating cubic curve directly.By Eq. (4) and the interpolation condition we haveκ0=2Lw2sinα3w12u2,κ1=2Lw1sinα3w22v2.If theG2Hermite data come from an ellipse, thenκ0=κ1, the reduction conditions of Lemma 1 requirew12w2=v3u,w22w1=u3v⇒w1w2=19.Thus the simple selection(13)w1=w2=13,u=2Lsinακ0,v=2Lsinακ1,satisfies the condition of interpolation and reduction condition of conic and makes the root ratio of two end curvatures equals to that of edges lengthu,v.Summarizing the methods of Sections 3.1 and 3.2, we present Algorithm 1and finally prove the conic precision property of the interpolation method.Theorem 1If the inputG2Hermite data is sampled from a rational conic Bézier curvec(t)with weightwc>−12,wc≠0and control pointsc0,c1,c2, the interpolating rational cubic Bézier curve is an arc segment ofc(t).ProofBy the method of Section 3.2, the theorem holds forα+β=π.Ifα+β≠π, by (2) we haveκ1κ0=‖c1−c0‖3‖c2−c1‖3.Then by (7) we havewLwR=κ1sin3ακ0sin3β=1.ThusrL(t)=rR(t)and finally the interpolating rational cubic Bézier curver(t)is an arc segment ofc(t).  □WhenwL=wR⩽−0.5, we simply allow that the weights are not positive after degree elevation of two conics. In this way, our method can reproduce all conic Bézier curves, including those having singularities. Fig. 4illustrates some complementary conic curves reproduced by our method.If the data comes from an ellipse, we get the whole ellipse in two complementary pieces, while if the data come from a hyperbolic curve or a parabolic curve, we also get the ‘whole’ curve in two complementary pieces with at least one of the complementary pieces having singularities.We also present some examples in Figs. 5–7to compare our method (work for0<α,β<π,α+β<2π) with those of Walton and Meek (2011) (work for0<α,β<23π,α+β<43π) and Li and Deng (2012) (work for0<α,β<π,α+β<43π). Fig. 7 shows an example indicating that only our method works.Without loss of generality, letb0=(−1,0),b3=(1,0)in all examples. Interpolating curves and control polygons produced by Walton and Meek (2011) (‘WM2011’), Li and Deng (2012) (‘LD2012’) and our method (‘LDM’) are displayed in green, red and black lines, respectively. Curvature plots are provided in Figs. 6 and 7. Figs. 6 and 7 show that the interpolating curves of our method always gives better or similar curvature distribution compared with those of ‘WM2011’ and ‘LD2012’. Some statistics data is summarized in Table 1(M is the number of curvature extreme, and ε is the difference of the maximum and minimum curvature) to make this fact clearer.When the inputG2Hermite data is sampled from a circle, Fig. 5 shows that all these methods produce the same curve and control polygon. Both of ‘LDM’ and ‘LD2012’ allow circular arcs with a span up to (not equal to)43π, i.e. the largest possible span for a circular arc represented by a rational cubic Bézier curve (Piegl and Tiller, 1997).

@&#CONCLUSIONS@&#
We have shown how to construct a rational cubic Bézier curve which interpolates a C-shapedG2Hermite data with conic precision, a property not reported before. The idea is natural in that its control points are constructed based on two conic Bézier curves, which turn to be the same curve when theG2Hermite data come from a conic and thus the algorithm is simple. Both the weights and control points are expressed in explicit form. The two tangential angles implied by theG2Hermite data can range from 0 to π, and the sum of them is no more than 2π, which is more general than previous methods.