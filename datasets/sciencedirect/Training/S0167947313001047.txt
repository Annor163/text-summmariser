@&#MAIN-TITLE@&#
Numerical distribution functions for seasonal unit root tests

@&#HIGHLIGHTS@&#
A generalisation of HEGY seasonal unit root tests was presented in Smith, Taylor and del Barrio Castro (2009).We use a response surface regressions approach to calculateP-values for the HEGY statistics.They can be used for any seasonal periodicity, sample size and autoregressive order.A Gretl function package is provided for applying the tests and calculating theirP-values.

@&#KEYPHRASES@&#
Seasonality,Unit roots,Response surface analysis,HEGY tests,

@&#ABSTRACT@&#
It is often necessary to test for the presence of seasonal unit roots when working with time series data observed at intervals of less than a year. One of the most widely used methods for doing this is based on regressing the seasonal difference of the series over the transformations of the series by applying specific filters for each seasonal frequency. This provides test statistics with non-standard distributions. A generalisation of this method for any periodicity is presented and a response surface regressions approach is used to calculate theP-values of the statistics whatever the periodicity and sample size of the data. The algorithms are prepared with the Gretl open source econometrics package and two empirical examples are presented.

@&#INTRODUCTION@&#
Unit roots may cause severe problems in a regression model if they are not properly dealt with: this may imply inconsistent coefficient estimators and non-standard distributions for significance tests and for forecast intervals. There have been many papers on testing for unit roots since the book by Fuller (1976), which introduced the test currently known as the Augmented Dickey–Fuller test, ADF (see also  Dickey and Fuller, 1981). Apart from the ADF test, other noteworthy tests are Phillips and Perron (1988), the KPSS test for stationarity by Kwiatkowski et al. (1992) and the ADF–GLS test by Elliott et al. (1996), all of which have become widely used by empirical economists. However, when working with time series data observed at intervals shorter than a year, the presence of unit roots should be tested for, not only in the long run but also in seasonal cycles. Over the last thirty years various methods have been proposed for testing for seasonal unit roots. For example, Hasza and Fuller (1982) and Dickey et al. (1984) propose joint tests for all seasonal unit roots, and in later papers Osborn et al. (1988) and in particular Hylleberg et al. (1990) (hereinafter HEGY) propose tests that would deal with each seasonal and zero frequency root to be considered separately. There are also interesting tests of seasonal stability by Canova and Hansen (1995), which also consider each frequency individually. The HEGY tests are not very difficult to implement and have therefore become widely used among empirical economists.One of the problems with most of the unit root tests mentioned above is that their statistics have non-standard distributions, so in practice the values in the tables published need to be interpolated to compare them with the values calculated or simulate the empirical distributions for exactly the same model and the same sample size that is being used. MacKinnon (1994) uses simulation methods and response surface regressions to estimate the asymptotic distributions of a large number of unit roots and cointegration tests at zero frequency (long run). MacKinnon (1996) then extends these results, providing a way of approximating small sample distributions too.Harvey and van Dijk (2006) apply MacKinnon’s method, using response surface regressions to provide a simple way of obtaining critical values andPvalues for any sample size and any order of lags of the endogenous variable in the regression for the HEGY tests mentioned above. As in the original HEGY article, all this is for quarterly data.In the 21st century it seems quite anachronistic to have to use statistical tables. Empirical economists normally use computers for calculations, so ideally they should have a computer algorithm to calculateP-values instead of having to look at statistical tables. The main objective of this paper is to obtain a generalisation of the method by Harvey and van Dijk for calculating thePvalues of the HEGY statistics whatever the seasonal periodicity,S, and sample sizeTof the data. Seasonal periodicitySis defined as the number of values of the series observed in each year (it is sometimes convenient to change the reference period from one year, for example, to one day if data are hourly,S=24, or one week if data are daily,S=7, but for ease of exposition I will continue to refer to the reference period as the ‘year’).For this approach to be practical it needs to be possible to implement it in a computer algorithm. As a complement to this paper an algorithm prepared in Gretl is provided (see http://gretl.sourceforge.net). Gretl is a cross-platform software package for econometric analysis. It is open source, free software: anyone may redistribute it and/or modify it under the terms of the GNU General Public License (GPL). This makes Gretl a very good econometric package in terms of the replicability of its calculations and results (Baiocchi, 2007).The study of seasonality requires the use of some concepts of spectral or frequency-domain analysis. The fundamental goal of such analysis is to determine how important cycles of different frequencies are in accounting for the behaviour of the series [For a thorough introduction to frequency-domain analysis see, for example, Chapter 6 of Harvey (1993) or the equivalent chapter in Hamilton (1994)].The period,T, is defined as the time taken to complete one cycle. The angular frequency,ω=2π/T, measures the frequency of the cycle in radians per unit of time. For a series withTobservations, ifTis even a total ofT/2complete cycles may be observed, with their periods beingT/jwithjbeing an integer andj=1,2,…,T/2. IfTis odd,T/2is not an integer, and only(T−1)/2complete cycles may be observed, with their periods beingT/jwithj=1,2,…,(T−1)/2. Those of these cycles that can be observed within a year are called seasonal cycles. Series whose values are observedStimes a year may, ifSis even, show up toS/2complete seasonal cycles every year, with periodsS/jwithjbeing an integer andj=1,2,…,S/2. IfSis odd, only(S−1)/2cycles may be observed within a year and their periods areS/jwithj=1,2,…,(S−1)/2. For example ifS=4the seasonal cycles have periods 4 and 2, which correspond respectively to cycles observed once and twice a year; ifS=5two seasonal cycles are also observed, one with period 5 and the other with period2.5. In summary, a time series in which observations are regularly collectedStimes a year can contain⌊S/2⌋different seasonal cycles, with⌊⋅⌋denoting the integer part of the number contained in brackets, i.e.⌊S/2⌋={S/2ifSis even(S−1)/2ifSis oddand the angular frequencies corresponding to the seasonal cycles areωj=2πjS, withj=1,…,⌊S/2⌋.If a series is generated by an autoregressive (AR) process such as(1)ϕ(L)xt=εtwhereLis the lag operator, such thatLxt=xt−1,ϕ(L)represents the polynomial1−ϕ1L−ϕ2L2−⋯andεtis a white noise process with varianceσε2, the cycles inxtare associated with the roots of the polynomial equationϕ(z)=0, wherezis a number in the complex plane, i.e.z=a+b⋅iwitha,b∈Randi=−1. Each root implies a cycle. The real and imaginary parts of the roots determine the period and the frequency of the cycle. The angular frequency of a cycle is related to the roots of the AR polynomial byω=arctan(b/a). Ifz>0and real(b=0)the root is on the horizontal right axis of the complex plane,ω=0, and the period is infinite. This root corresponds to the long run (or trend) of the series. Ifz<0and real, the root is on the left side of the horizontal axis,ω=π(called the Nyquist frequency) and the period is 2. All the complex solutions (withb≠0) ofϕ(z)=0have conjugate solutions associated with them. In this case, the problem of aliasing arises (See  Hamilton, 1994, pp. 160–161, for a detailed description of this problem). Basically the problem is this: based on a sample ofTobservations it is impossible to distinguish between the cycle associated with the rootz=a+b⋅i, with frequencyω, and the cycle associated with its complex conjugate rootz=a−b⋅i, with frequency−ω. The only possible way of working with them is therefore to treat them jointly.Hylleberg et al. (1990) study how to test for unit roots in seasonal time series. They take quarterly periodicity of data(S=4)as their reference and assume that the seriesxtis generated by a possibly infinite order autoregressive process, as in Eq. (1). To test the hypothesis that the roots ofϕ(z)=0are on the unit circle against the alternative hypothesis that they are outside the unit circle they set up the following procedure. They show that Eq. (1) can be written in an equivalent form as(2)ϕ∗(L)y4t=π1y1t−1+π2y2t−1+π3y3t−2+π4y3t−1+εtwherey1t=(1+L+L2+L3)xt,y2t=−(1−L+L2−L3)xt,y3t=−(1−L2)xt,y4t=(1−L4)xt=Δ4xtandϕ∗(L)is a polynomial with all the roots outside the unit circle. Eq. (2) can be estimated consistently by ordinary least squares (OLS).Testing the hypothesis of a unit root,z=1, at zero frequency is equivalent to testing the significance of the coefficientπ1, which can be done by using atstatistic. However, this statistic does not follow a Student’st-distribution. Hylleberg et al. (1990) show that the asymptotic distribution of thistπ1statistic is the same as that of the Dickey–Fuller statistic.The existence of a unit root,z=−1, at frequencyω=πcan be checked for by a significance test on the coefficientπ2, also using at-statistic. The presence of the complex conjugate (alias) unit rootsz=±iat frequenciesω=±π/2can be tested for by an F-statistic for the joint hypothesis thatπ3=π4=0.Beaulieu and Miron (1993) (and in a slightly different way  Franses, 1990) study the problem of testing for seasonal unit roots with monthly data. They show that an equation with a similar structure to that of HEGY could also be proposed for this case. In the quarterly case there are two seasonal cycles at frequencies±π/2andπ, but in the monthly case there are six seasonal cycles at frequencies±π/6,±π/3,±π/2,±2π/3,±5π/6, andπwhich, as Beaulieu and Miron show, makes the structure of the equation a little more complicated, as it depends on 12 filters instead of only 4 (See Eqs. (4) and 5 in  Beaulieu and Miron, 1993). There is also a version of Eq. (2) for weekly data (withS=52) in Cáceres (1996), which depends on 52 seasonal filters.To test for seasonal unit roots in an applied study with quarterly data, the aforementioned procedure by Harvey and van Dijk for calculating critical values orP-values for the tests can be used. If the data are monthly or weekly the tables of critical values in the articles by Beaulieu and Miron or Cáceres mentioned above can be used. An interpolation method is needed to calculate the critical values and there is no method for obtainingP-values. When working with daily data (S=5,6or 7 days a week), hourly data (S=24ha day), etc., there are not even any tables to compare with. As stated above, the main goal of this paper is to solve this problem.The first step towards obtaining a general solution to the problem is to show a generalisation of Eq. (2) for any seasonal periodicityS. Such a generalisation, presented in Smith et al. (2009), is used in the next section.Letytbe a time series observedStimes a year integrated of order one at frequenciesωj≡2πj/S,j=0,…,⌊S/2⌋, and let its autoregressive representation be(3)ϕ(L)yt=γ′Dt+utwhereϕ(L)is a polynomial on the lag operator,Dtis a column vector with deterministic terms,γis its associated coefficients vector andu1,…,uTareiid(0,σu2).Now defineΔs=1−LSas the polynomial of orderSmade up of (single) unit roots at frequenciesωj,j=0,…,⌊S/2⌋[remember that there are two unit roots perωj∈(0,π)but only one perωj=0,π]. The roots at frequencies 0 andπare real, but the rest have complex-conjugate values. DefineS∗as(S/2)−1(ifSis even) and⌊S/2⌋(ifSis odd).Model (3) may be expressed as follows (See Eq. (4.1) in  Smith et al., 2009):(4)ϕ∗(L)ΔSyt=γ′Dt+π0y0,t−1+∑j=1S∗(πj,ayj,t−1a+πj,byj,t−1b)+πS/2yS/2,t−1+utdropping the termπS/2yS/2,t−1ifSis odd,t=1,2,…, with the transformed level variablesy0,t,yj,ta,yj,tbandyS/2,tj=1,…,S∗defined byy0,t=∑i=0S−1yt−i,yj,ta=∑i=0S−1cos[(i+1)ωj]yt−i,yj,tb=−∑i=0S−1sin[(i+1)ωj]yt−iandyS/2,t=∑i=0S−1cos[(i+1)π]yt−i.In practice, using data for a given sample sizeT,ϕ∗(L)is approximated by a finite orderppolynomial, so that model (4) may be written as(5)ΔSyt=γ′Dt+π0y0,t−1+∑j=1S∗(πj,ayj,t−1a+πj,byj,t−1b)+πS/2yS/2,t−1+∑i=1pϕiΔSyt−i+utwith the termπS/2yS/2,t−1being dropped ifSis odd. Filtersyj,taandyj,tbin the quarterly case reflect the same transformations as in the HEGY paper, in the monthly case they are the same as those of Beaulieu and Miron.To test for unit roots, (5) is estimated by OLS and then the significance of the coefficients is tested using appropriate finite sample distributions based on Monte Carlo results.π0=0implies that the series contains a unit root at the zero frequency. WhenSis even andπS/2=0, there is a seasonal unit root at frequencyπ(two observations per cycle). Whenπj,a=πj,b=0, seasonal unit roots are present at frequencyωj=2πjS. For frequencies 0 andπit suffices to examine the relevantt-statistics forπ0=0andπS/2=0against the alternatives thatπ0<0andπS/2<0respectively. For other frequencies, the strategy is to testπja=πjb=0. This may be done by means of twot-statistics, but anF-statistic for this hypothesis, referred to here asFjab, proves to be more powerful.By means of Itô calculus, Phillips (1987) shows thattπ0andtπS/2asymptotically have the Dickey–Fuller distribution. Ahtola and Tiao (1987) and Chan and Wei (1988) note that the asymptotic distributions oftstatistics for theπjacoefficients are the same across frequencies. Beaulieu and Miron show, using their Lemma 1, that thetstatistics for theπjbcoefficients also have the same asymptotic distribution and that theFjabstatistics, forj=1,…,S∗converge in law to12(tπja2+tπjb2). Because all thetπja-statistics have the same distribution and all thetπjb-statistics have the same distribution, all theFjabstatistics, forj=1,…,S∗, have the same asymptotic distribution. An analysis of the proof in Chan and Wei (1988) and Lemmas 1–4 in the aforesaid article by Beaulieu and Miron reveal that this asymptotic distribution does not depend onS, the periodicity of the data. This is the key feature of Eq. (5), which enables a general method for calculatingP-values or critical values to be set up that is valid for any periodicity. However, different periodicities imply different numbers of regressors in this equation so a movement should be expected in the finite sample distributions of thetandFstatistics depending on the periodicityS.Along with thetπ0,tπS/2andFjabstatistics already explained, the following sections also study the distribution of theF-statistic for the joint hypothesisπ1a=π1b=⋯=πS∗a=πS∗b=πS/2=0(all the seasonal roots have modulus one), which is denoted byFS, and theF-statistic for the joint hypothesisπ0=π1a=π1b=⋯=πS∗a=πS∗b=πS/2=0(all the seasonal and the frequency zero roots have modulus one), which is denoted byFC.Even for seasonal periodicities for which tables of the HEGY tests are available, and even though the asymptotic theory of those tests is well developed, it is not easy for applied researchers to calculate theP-value of a given test statistic. Here a generalisation of Harvey and Van Dijk’s procedure is presented which is based on response surface regressions, which serve to obtainP-values not only for quarterly data but for any seasonal periodicity.The first step in implementing the response surface regressions is to estimate the relevant quantiles of the distributions of the HEGY tests for several combinations of T (effective sample size),pandSfrom a large set of Monte Carlo simulations. Following MacKinnon (2002), the process is then repeatedM=50times for each value ofTto obtain more accurate results. These Monte Carlo simulations were carried out here in two stages. In the first stage the value of the autoregressive order,p, was considered as fixed, and in the second stage the value ofpwas determined empirically using information criteria. In particular, the Akaike information criterion (AIC), the Bayes information criterion (BIC) and the Hannan–Quinn criterion (HQC). In both stages, each experiment consisted ofN=100000replications, where the seriesytwas generated by the data generation processΔSyt=utwithut∼nid(0,1)and the equation estimated was  (5).The distributional properties of the HEGY statistics depend on four ‘design parameters’: the estimation sample size(T), the number of autoregressive lags included in the model(p), the seasonal periodicity(S)and the deterministic components inDt. To provide well fitted results for a wide range of situations common in empirical investigations, the simulations for the first stage, wherepis considered as fixed, span a full factorial design of the followingT,p,SandDt:T:48,52,64,76,100,124,152,200,300,400,500,7800,1,2,…,S(with maximum 12)4,5,6,7,12,24,52(a)constant term;constant term,t;constant term,S−1seas. dummies;constant term,S−1seas. dummies,t.The range of the sample size is intended to provide information on both the test statistic’s asymptotic properties and the deviations of the finite sample therefrom. For each value ofSthe estimation in the longest version of (5) uses2S+p+1degrees of freedom so whenS>12a minimum sample size of2S+12is needed. This implies that the first valid sample size forS=24isT=64and forS=52isT=124. For eachS≤12the design includes all integer values ofpfrom zero up toS; forS>12high values ofpimply significant computation costs, sopis limited to 12, which is deemed sufficient for most empirical applications. The values forSinclude the most widely used periodicities in time series applications: 4 (quarterly data), 5 and 7 (two types of daily data), 12 (monthly data), 24 (hourly data), 52 (weekly data), andS=6which is not so widely used but for which results are obtained very quickly in computational terms. The choice of the deterministic termDtimplies four cases for each test statistic which are required for adequate model specification, i.e. because the deterministic terms are in the DGP.Although full factorial design was used at this stage, the use of optimal methods for response surface design could improve computational efficiency and/or the precision of the estimates for some specific values ofT,porS(see for example Kleijnen, 1987, Part II.a, Conlisk, 1974 or for more recent developments Hertel and Kohler, 2013).In practice, it is rare to be able to specify the value ofpbeforehand. Analysts must typically use an empirical method to determine it. The method may include observing the graph of the series, the partial autocorrelation function, using significance tests or using information criteria such as AIC, BIC, and HQC. Information criteria have been proven to have good properties in selecting the order of an autoregression (see for example  Tsay, 1984). To account for this and to provideP-values that may be useful in some of these empirical contexts, in the second stage we proceed in a way similar to Harvey and van Dijk (2006). For each replication, we determine the appropriate lag order in (5) using the AIC, BIC or HQC by varyingpbetweenpmin=0andpmaxand selecting the value ofpthat minimises the criterion chosen.There are various definitions of information criteria in the context of autoregressive models. Following Ng and Perron (2005) the version used here is(6)IC(p)=lnσˆp2+KpCT−KmaxT−Kmaxwhereσˆp2=(T−Kmax)−1∑Kmax+1Teˆt2,is an estimate of the regression error variance for the model withplags,Kpis the number of regressors in that model and, withndetbeing the number of deterministic components,Kmax=ndet+S+pmaxis the maximum number of regressors. UsingCT−Kmax=2in (6) for the AIC,CT−Kmax=ln(T−Kmax)for the BIC andCT−Kmax=2lnln(T−Kmax)for HQC.The prior identification ofpvia information criteria generally slows down simulations and increases computational costs. This meant that at this stage it was necessary to use an experimental design which limited computational costs to an affordable level. The simulations for this second stage were made using a fractional factorial design based on the following values ofT,pmax, andS:T:124,200,300,400,780,3,6,9,12,50,4,5,6,7,12,24,52The Monte Carlo simulations were programmed in Gretl 1.9.6 (see Cottrell and Lucchetti, 2011a,b; Yalta and Schreiber, 2012). From version 1.9.4 onwards Gretl uses the SIMD-oriented Fast Mersenne Twister (SFMT) (see  Saito and Matsumoto, 2008) as its random number generator for the uniform distribution, in particular the implementation referred to as SFMT19937, which has a period of 219937−1 and is based on version 1.3.3 of the original C code by Saito and Matsumoto. Gretl uses Ziggurat (Marsaglia and Tsang, 2000) as the default method for generating normal variates on the basis of uniform input.In the first stage, wherepis considered as fixed, from each Monte Carlo experiment a record is made of the 221 quantiles estimated of the statisticstπ0,tπS/2,Fjabwithj=1,…,S∗,FSandFCfor probabilitiesα=0.0001,0.0002,0.0005,0.001,0.002,…,0.01,0.015,…,0.99,0.991,…,0.999,0.9995,0.9998,0.9999and the quantiles estimated are used as dependent variables in response surface regressions of the form(7)qiα(Tc,p,S)=θ∞α+θ1α1Tc+θ2α1Tc2+θ3α1Tc3+θ4αpTc+θ5αpTc2+θ6αpTc3+θ7αp2Tc+θ8αp2Tc2+θ9αp2Tc3+θ10αp3Tc+θ11αp3Tc2+θ12αp3Tc3+θ13αSTc+θ14αSTc2+θ15αSTc3+eiwhereTc=T−m, withTbeing the sample size in the estimation of Eq. (5) andmthe number of regressors used in this equation.qiα(Tc,p,S)denotes quantileαobtained from thei-th experiment with a given value ofTc, autoregressive orderpand periodicityS. This functional form was arrived at after some experimentation: it is based on the one used by Harvey and van Dijk but includes a third degree inp, which is significant whenS>4, and adds three terms to take seasonal periodicity into account. Parameterθ∞αrepresents quantileαof the asymptotic distribution whenT→∞. In the regressions estimated some of the coefficients were not significant but I preferred to maintain the same explanatory variables in all regressions, given that with the number of observations available this did not imply much loss of efficiency and the algorithms were thus made much simpler.When the parameters of Eq. (7) are estimated by ordinary least squares, the errors are heteroscedastic with variance depending onTcandS. Several alternative weighted least squares were tried out to take heteroscedasticity into account and in all cases the best result was that of the default hsk native command of Gretl. The procedure implemented by this command involves three steps: first an OLS estimation of the model, then an auxiliary regression to generate an estimate of the error variance, and then finally weighted least squares, using the reciprocal of the estimated variance as the weight. In the auxiliary regression the log of the squared residuals from the first OLS is regressed on the original regressors and their squares. The log transformation is performed to ensure that the estimated variances are non-negative.In the monthly case(S=12), Beaulieu and Miron (1993, pp. 316–317) have the following to say with respect to theFjabstatistics (and for thetπja,tπjbstatistics) for the different values ofj=1,…,5: “Investigation of the finite sample distributions for a subset of the cases considered below indicates that these distributions are similar for a given number of simulations and converge as the number of simulations increases”. Eq. (7) has been used here to test the hypothesis that all theFjabstatistics have the same distribution across different values ofj. This is a joint test of the null hypothesis that parametersθ∞α,θ1α,…,θ15αfor theFstatistics are the same for differentj. Assuming normality, albeit asymptotically, the statistic has a very highP-value so at a 5% significance level the null is not rejected and the conclusion is that the distribution ofFjabdoes not depend onjwith finite samples either. The only remaining concerns are five distributions:tπ0,tπS/2, a genericFwhich is the same for different values ofj,FSandFC. This means that all the simulations of the differentFjabstatistics can be used jointly to estimate the parameters of (7) forF, thus improving the precision of the estimates.With the experimental design for the first stage described above, the number of observations available is∑SNS(pS,12+1)Mfor thetπ0,FSandFCstatistics,∑S≠5,7NS(pS,12+1)MfortπS/2and∑SNS(pS,12+1)M[(S/2)−1]for theFstatistic, whereNSis the number of different sample sizes simulated for periodicitySandpS,12isSforS≤12and 12 ifS>12.Tables with the coefficients estimated for Eq. (7) for the quantiles of probabilities 0.10,0.05 and 0.01 for alternatives (c) and (d) of the deterministic term can be found online as supplementary material related to this article.In the second stage, where the AR order is determined empirically, the same quantiles of the empirical small sample distributions are recorded as before and response surface regressions are estimated as in (7) withpreplaced withpmax. Tables with the coefficients estimated for Eq. (7) for the quantiles of probabilities 0.10,0.05 and 0.01 for the alternatives (c) and (d) of the deterministic term when the value ofpis determined using AIC, BIC and HQC can also be found in the supplementary material section of the online version of this article.After the response surface regression (7) is estimated for all 221 quantiles for the five statistics, an interpolation between these values can be performed using the method by MacKinnon (1996). Consider the regression(8)Φ−1(α)=γ0+γ1qˆ(α)+γ2qˆ2(α)+γ3qˆ3(α)+eαwhereαdenotes one of the 221 points at which the quantiles are estimated, with0<α<1,qˆ(α)denotes the estimate ofqαandΦ−1(α)is the inverse of the cumulative standard normal distribution function. There is enough empirical evidence to show that this equation may be a good candidate for approximating the distribution of a two-tailed test statistic, such astπ0andtπS/2, in a small region around a specified value ofα. For an F-type test aχ2(2)is a better option than the normal distribution inΦ−1(α). In principle the orderpof an autoregressive model may be an integer between 0 and∞but obviously the model cannot be simulated for infinite values ofp. Furthermore for Eq. (7) to be practical and produce well fitted estimations ofqˆ(α)it is not advisable to use high powers ofp. This implies that the procedure works well for values ofparound those used in the simulations but tends to give very inaccurate forecasts ofq(α)for large values ofp. However these cases are very easy to detect in practice so it is not difficult to put a warning in the computer algorithm for when excessively large values ofporpmaxare selected. In our case, after some experimentation I have found that this method with the powers determined in (7) and the values ofpused in our experimental design is reliable for aroundp⪅80(and the same forpmax).Eq. (8) is usually estimated with a small, odd number of points,ℓ, around the specified significance level, in particular,ℓ=9,11,13or 15 points are considered reasonable (there seems to be little difference between the results from 9 to 15, so this parameter is left to the choice of the user in the Gretl functions provided). To account for heteroscedasticity and serial correlation MacKinnon suggests employing a feasible GLS estimator using a symmetric covariance matrix with elements(9)ωˆij=s.e(θˆ∞αi)s.e(θˆ∞αj)αi(1−αj)αj(1−αi),i<j,where the standard errors ofθˆ∞αiare obtained from the OLS estimation of Eq. (8).In order to calculate theP-value for an observed test statistic,τ∗, it is possible simply to estimate Eq. (8) for a small set of values ofqˆ(α)nearτ∗and then compute(10)P∗=Φ(γˆ0+γˆ1τ∗+γˆ2τ∗2+γˆ3τ∗3).Some scripts prepared by the author in HANSL (the Gretl scripting language) can be found in the supplementary material section of the online version of this article.In particular they contain•a function for obtaining theP-values of thetπ0,tπS/2,F,Fs, andFCtests;a function for automatically calculating the HEGY tests andP-values for any periodicity; anda Gretl function package for using these functions under the Gretl graphical user interface.TheP-values and quantiles obtained with the methods described above use all the data from the simulations in the experiments andM=50repetitions for each model. So although both the values obtained here and the critical values reported in the articles mentioned above are estimations or approximations of the true critical values, a much lower variance and thus a more accurate approximation can be expected from the method described in this paper.The precision of the estimated quantiles obtained by a single simulation (as done e.g. in the cited articles by HEGY and Beaulieu–Miron) and that of the present procedure can be compared by the confidence intervals calculated for both procedures. A confidence interval for a single simulation may be obtained as follows (see for example Kleijnen, 1987). In order to estimate the quantileqα, the simulated values of the statisticxi(i=1,…,N)(wherexmay betπ0,tπS/2,F,FsorFC) must be arranged in increasing order; that is the order statisticsx(i)must be obtained:x(1)≤x(2)≤⋯≤x(N−1)≤x(N).It can be proved that a1−ϵconfidence interval for the quantileqα, providedN>20, is(11)Pr(x(l)≤qα≤x(r))=1−ϵwithl=⌈Nα−zϵ/2Nα(1−α)⌉andr=⌈Nα+zϵ/2Nα(1−α)⌉,where the symbol⌈⌉means thatlandrare rounded upward andzϵ/2denotes the quantileϵ/2in the Gaussian distribution. Applying this, for example, to a single simulation with the deterministic part formed by a constant andS−1seasonal dummies, withS=4,T=1000,p=0andN=24000, withα=ϵ=0.05, a 95% confidence interval for the 0.05 quantile fortπ0of (−2.89554,−2.85211) is obtained. Its semi-amplitude is 0.02171 which, assuming local linearity in the densityf(tπ0), implies an approximate standard error of 0.01108 for the quantile.A confidence interval for the estimations of the quantiles oftπ0obtained through the method described in Section  4 may be obtained as a prediction interval for given values of the explanatory variables (forS=4,T=1000,p=0) in Eq. (7). Given that this equation is estimated by weighted least squares, the confidence interval may be approximated through the usual OLS confidence interval in the weighted equation, and a subsequent de-weighting of the interval limits, which for 95% confidence gives (−2.86729,−2.83333), with semi-amplitude 0.01698 and a standard error for the quantile of 0.008663, which gives a standard error 21% smaller than using a single simulation estimate.The accuracy of the quantile estimations obtained through the response surface regression  (7) can also be compared with the quantile estimation obtained as an average of the quantiles obtained after 50 repetitions ofN=100000replications of the given statistic. MacKinnon (2002) makes such a comparison for the example of the Dickey–Fuller tests and concludes that “…it appears that the standard errors of response surface estimates will be of roughly the same order of magnitude as, but probably somewhat smaller than, the standard errors suggested by the formula (45.11)” (using an average of the repetitions). In general here I obtain better results. The left side of Table 1has the results for the use of 50 repetitions withN=100000replications of the same model as above and considering the estimation of the 0.10,0.05 and 0.01 quantiles oftπ0,tπS/2andFobtained by averaging the empirical quantiles of the 50 repetitions. The right side of the table shows the results obtained with the response-surface regressions, which in all cases produce much lower standard errors.Hylleberg et al. (1990) illustrate their tests using United Kingdom data on consumption and income (the data set can be obtained from  Hylleberg et al., 1996). The data are quarterly observations for the period 1955.1–1984.4 on the variablesy=log of personal disposable incomeandc=log of consumption expenditures on non durables. Forcandythey use a model withp=5, which givesT=111effective observations for estimating Eq. (5). They also usep=4withc−yto test for a cointegration relationship, which impliesT=112. They report the seasonal unit roots statistics for five different specifications for the deterministic term. For example, forDt=constant,(S−1)seasonal dummies and a linear trend, they obtain the values of the statistics under columnstπ1,tπ2andFπ3∩π4shown in Table 2.The tables of critical values based on Monte Carlo simulations that they present give information forT=48,100,136and 200, so withT=111or 112 they can only obtain one conclusion because their estimated values are far enough from all the values for the different sample sizes in their tables. In cases that are not so clear an interpolation method is needed. Using the Gretl algorithm based on the method presented above it is easy to obtain theP-values associated with the statistics calculated by HEGY. They are reported in parentheses in Table 2. It can be seen that in general the conclusions obtained by Hylleberg et al. are valid. The only difference is that they did not reject the hypothesisπ2=0forc−ywhereas it can now be seen that it should be rejected at a 5% level of significance, which implies that there is no unit root at frequencyω=πin this series. Although in theory this might be considered as providing some degree of evidence of seasonal cointegration on the biannual cycle, that evidence is not strong and a more comprehensive analysis using, for example, the Canova–Hansen test is advisable.Fig. 1shows the series of hourly aggregate demand for electricity in Spain from 2012/04/01/01:00 to 2012/09/30/24:00 (4392 observations. Source: Comisión Nacional de Energía, http://www.cne.es). Taking the day as the period of reference, there are 24 observations in a day, so in this caseS=24. The graph shows intra-daily cycles which may lead to the suspicion that there are seasonal unit roots with periods of less than or equal to 24, but it also shows a weekly cycle with period 24×7=168. This means that if the period of one day is taken as a reference,S=24, in running the intra-day seasonal unit root tests at least one AR order ofp=168−24=144will need to be determined to obtain consistent estimators. Table 3shows statistics for testing for unit roots by means of the procedure described in Section  4. Given the graph of the series, a deterministic part including a constant and 23 seasonal dummies (the trend is not significant) is considered, withp=144taken as given. From the last row of the table it can be seen that by means of theFCstatistic the null hypothesis of unit roots in all seasonal frequencies and also the zero frequency is not rejected at, for example, 5% significance level. The possibility of unit roots at each frequency separately can now be considered. In this case at 5% significance level only the hypothesis that the series presents a unit root with statisticF6ab, i.e. corresponding to a cycle with period 4, is rejected.Another alternative with these hourly data is to consider the possibility of seasonal unit roots not only for the cycles in the day but also for the cycles in the week. In that case the reference period must be changed to a week, makingS=168. Table 4shows the results of applying the seasonal unit root tests for this seasonal periodicity and calculating theP-values with the method described in Section  4. A deterministic part including a constant and 167 seasonal dummies is used and the autoregressive order is determined by means of the BIC withpmax=40, which gives a value ofp=2. This table shows that most of the unit roots corresponding to intra-day frequencies are not rejected, except the root at frequency±π/2(period 4) as before and now also the root at frequency±π/12(period 24). However, given the value ofF1ab, the unit root is clearly rejected for the cycle with period 168, which implies that the weekly cycle shown in the graph is deterministic, and given the values of the statisticsFjabwhenjis not a multiple of 7, the unit root is also rejected for the rest of the intermediate frequency cycles that appear because of the weekly seasonality. Thus, by means of theFCstatistic the null hypothesis of unit roots at all seasonal frequencies and also at zero frequency is rejected at the 5% significance level, and the same occurs with theFSstatistic, i.e. the null joint hypothesis of having unit roots at all seasonal frequencies (not including zero frequency) is rejected.

@&#CONCLUSIONS@&#
