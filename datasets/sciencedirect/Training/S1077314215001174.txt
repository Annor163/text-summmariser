@&#MAIN-TITLE@&#
A statistical method for line segment detection

@&#HIGHLIGHTS@&#
Voting in each column around an initial peak is considered to be a random variable.The optimal θ is determined by fitting and minimizing a 2nd-order curve.The optimal ρ is determined by fitting and interpolating a sine curve.We calculate voting boundaries instead of searching for non-zero voting cells.The endpoint coordinates are determined by fitting instead of by solving equations.

@&#KEYPHRASES@&#
Hough transform,Statistical analysis,Endpoint specification,Fitting and interpolation,

@&#ABSTRACT@&#
Line segment detection is a fundamental procedure in computer vision, pattern recognition, or image analysis applications. This paper proposes a statistical method based on the Hough transform for line segment detection by considering quantization error, image noise, pixel disturbance, and peak spreading, also taking the choice of the coordinate origin into account.A random variable is defined in each column in a peak region. Statistical means and statistical variances are calculated; the statistical non-zero cells are analyzed and computed. The normal angle is determined by minimizing the function which fits the statistical variances; the normal distance is calculated by interpolating the function which fits the statistical means. Endpoint coordinates of a detected line segment are determined by fitting a sine curve (rather than searching for the first and last non-zero voting cells, and solving equations containing coordinates of such cells).Experimental results on simulated data and real world images validate the performance of the proposed method for line segment detection.

@&#INTRODUCTION@&#
The Hough transform (HT) [1–3] is widely used for extracting geometric features in images. The standard HT is inefficient with respect to run time and storage requirements; it also suffers from the peak-spreading problem in the Hough space [4,5].In order to improve the computation and storage efficiency, many methods have been proposed, such as the fast HT[6], adaptive HT[7], special architectures HT[8], probabilistic HT[9], randomized HT[10], or generalized HT[11].In order to locate accurately the peak, and to derive accurate normal parameters, various extensions to the standard HT have been proposed. Numerous methods put the emphasis on generating more distinct peaks by modifying the voting scheme of a Hough transform. Edge information [12–14] or image preprocessing techniques [15–17] are used to enhance the peak in the accumulator array. In addition, a continuous statistical kernel [18] is proposed for modeling the Hough votes instead of using a discrete accumulator array. This approach is computationally more expensive because it considers and models all pixels in the given image.After finding a peak, there are three different ways for supporting the computation of accurate peak parameters:(1)A peak cell (θ, ρ) is simply selected for specifying the normal parameters of the detected line.A weighted averaging [19,20] is used by considering neighboring cells (θi, ρi) around a peak cell.A specially designed peak localization technique is employed. For example, two accurate peak localization methods are presented in [21,22] using smoothing windows and weighted averaging, a two-stage method [23] is described by finding a median position in narrow strips passing through an initial peak, a high-accuracy HT, proposed in [24], is based on the theoretical symmetry of the butterfly pattern around a peak, and a subcell-accuracy method [25] locates the peak by using fitting and interpolation techniques while analyzing the butterflies.The HT can also be used for extracting the endpoints of a detected line segment [26] although the standard HT only provides normal angle θ and normal distance ρ.We classify HT-based methods for detecting line segments into two categories. One class of methods is based on projection [27–29]. After applying the standard HT, the detected line is cut into pairwise disjoint segments; the endpoints of one of those line segments are determined by analyzing the projection of the feature points on either the x- or y-axis in image space. Two thresholds are needed to control the length of a line segment and the width of a gap between line segments. But, how to determine these two thresholds defines then a new problem.The second class of methods is motivated by the butterfly shape [30,31] of a peak region in Hough space [32–34]. Butterfly features are used to extract parameters of a line segment. The first and last cell with non-zero voting values are identified and used to compute the endpoints of the line segment by solving two sets of simultaneous equations [35–38]. However, how to obtain the first and the last cell containing a non-zero voting value is a difficult problem in the presence of image noise, pixel disturbance, and a wide line-segment.In a recent publication [39], we described a method for detecting line segments based on minimum-entropy analysis. Direction and length of a line segment are simultaneously determined by analyzing the voting entropies. The midpoint is detected by fitting voting means. The endpoint coordinates are finally calculated based on the detected direction, length and midpoint.This paper proposes a novel statistical method based on HT for extracting line segments. The vote in each column (around a peak) is considered to be a random variable. The normal angle and distance of a line segment are computed by fitting and interpolating statistical variances and means. Endpoint coordinates of a line segment are computed by fitting a sine curve to the statistical non-zero voting cells, computed from statistical means and variances. Thus, there is no need for searching non-zero cells and solving two equations generated from just two cells.In distinction to [39], this paper does not apply any minimum-entropy analysis. It extracts the normal angle, the normal distance, and endpoint coordinates using statistical characteristics. This paper also proposes a solution to calculate the statistical non-zero cells instead of searching for the first and the last non-zero voting cells in each column of a butterfly.The rest of the paper is organized as follows. Section 2 introduces a way for peak distribution analysis in Hough space. Section 3 defines the random variable and statistical characteristics. Section 4 describes our normal angle and distance detection method based on statistical characteristics. Section 5 outlines endpoint detection by fitting sine curves. Section 6 compares experimental results with simulate data and real images. Section 7 concludes.Our method for line segment detection focuses on the voting cells around a peak. After voting, we start with analyzing the voting value distribution in each column around a peak in the Hough space.A pixel (x, y) in the image space votes for a set of cells (θ, ρ) in the Hough space according to Eq. (1), defined in [2] (see comments on historic origins in [40]):(1)ρ=x·cosθ+y·sinθVotes of a set of collinear pixels in an image would create a peak in Hough space. When mapping a line segment from a noise-free image into the Hough space, assumed to be given at the finest quantization resolution, the peak is distinct in Hough space, and is easy to locate. However, due to various uncertainties, like image background noise, pixel disturbance, space quantization error, or line thickness, there is the phenomenon of peak spreading. See Fig. 1. The peak is not distinct anymore in Hough space. An extraction step is needed to find and locate the accurate peak parameters.Let Hijbe the voting value at cell (θi, ρi) in Hough space. An initial peak is found by using a sliding 3 × 3 window over all cells of the Hough space. At each position in the whole Hough space we consider the sum of all nine voting values in this placed window. If this sum is the maximum then we take the central cell of this placed window as the initial peak λ.A larger window, centered at the initial peak, defines the peak region. The size of this larger window depends upon the quantization resolution of the Hough space. For example, we used a window of size 17 × 21 for Δθ equals 1°, and Δρ equals 1p (i.e. the edge length of one pixel), and a window of size 11 × 17 for (Δθ, Δρ) equals (2°, 2p).Let w and h be width and height of the image space, respectively. In the standard Hough transform, the origin in image space is selected to be at a corner of the image, identified with the origin of the coordinate system as used for representing image data. In this case, the range of θ is [0, π), and the range of ρ in the Hough space is from−w2+h2tow2+h2.If the image center is selected to be the origin, the range of ρ changes to the interval[−w2+h2/2,w2+h2/2]Thus, it is reduced to half of its previous size.The Hough transform equation is then as follows:(2)ρ=(u−w/2)cosθ+(v−h/2)sinθwhere (u, v) is the pixel location in image space.The location of the origin in the image also influences the shape of the voting distribution of a peak region. This translation of the origin leads to a butterfly-like distribution around a peak, especially for a line segment that is far away from its perpendicular point.Fig. 2shows voting distributions around a peak for both placement options for the origin. There is a line segment that is far away from its perpendicular point. In case of selecting O as the origin of the image, there is only a very small number (e.g. one or two) of voting cells in many columns, and the peak is not distinct in Hough space. It is difficult to detect and to locate the peak. The likelihood of such a case is reduced by selecting the center O′ as the coordinate origin, and voting values converge now “more” in the peak region. Therefore, a relatively distinct peak is generated.Around a peak, the voting in each column is considered to be a random variable. We analyze the statistical characteristics of this variable.Fig. 3illustrates the Hough voting correspondence between image space and Hough space.For voting angle θiin image space, there are several parallel rays that intersect with the considered line segment. Therefore, this line segment contributes to the voting in several cells in the θicolumn in the Hough space. In general, in different columns we have different numbers of related voting cells. The closer to the peak a column is, the smaller is the number of voting cells.The voting ρ in θicolumn is considered to be a random variable Ri. The voting values of cells define the probabilistic distribution of Ri. Because the length of the line-segments defined by crossing each strip is about constant, the voting values of cells are approximately equal in each column, and the voting distribution in each column is approximately uniform. That is:(3)Ri∼U[ρimin,ρimax]For a random variable Rithat corresponds to voting angle θiin image space, we analyze its statistical mean miand varianceσi2.The mean miis that ρ-value for which the line-segment’s midpoint (xc, yc) votes for with respect to θi. That is:(4)mi=xccosθi+ycsinθiDue to the above equation, the functional relation between statistical mean miand θiis a sine curve.Since Riis a random variable that is uniformly distributed betweenρimintoρimax,the statistical variance equals(5)σi2=(ρimax−ρimin)2/12=(L·sin|θi−θ0|)2/12=L2·sin2(θi−θ0)/12where L is the length of the line segment, and θ0 is the actual angle of the line segment.Because only columns around θ0 are considered,θi−θ0is small, thereforesin(θi−θ0)≈(θi−θ0). Thus,(6)σi2≈L2·(θi−θ0)2/12Based on the above equation, the functional relation between statistical varianceσi2and θiis a second-order curve function.In the θicolumn in Hough space, the voting mean miand varianceσi2are calculated as follows:(7)mi=∑j[Hij·ρj]/∑jHij(8)σi2=∑j[Hij·(ρj−mi)2]/∑jHijSums are taken over the range of j-values in the peak region.We aim at detecting a final peak accurately and robustly by considering various uncertainty. We compute θpeakand ρpeakof the peak by using fitting and interpolation techniques. Regarding fitting, we fit a second-order curve with the variances of the columns in the chosen peak region; the θpeak-value is defined by minimizing the fitted function. We also fit a sine-curve with the means of those columns in the peak region; the ρpeakvalue is computed by interpolating the sine-curve at the obtained θpeak-value.In a peak region, the θpeak-value is located at a coordinate where voting is “most clustered”. The variance σ2 is selected for measuring the degree of voting scatter of a column. The closer to the peak the column is, the more clustered the voting is, and the smaller the variance is. The θpeak-value would be located where σ2 takes its minimum.The θpeak-value with subcell accuracy is computed by fitting a second-order curve to these variances, and by minimizing the fitted function.We calculate the variancesσi2for each θicolumn in the peak region. Fit a second-order function f, depending on θi, with the estimatedσi2values as follows:(9)f:σ2=f(θ)≜a2·θ2+a1·θ+a0Compute θpeakwhere f has its minimum:(10)θpeak=θ|f′(θ)=0=−a1/(2·a2)A result is illustrated in Fig. 4. The quantization resolution of the Hough space is set to(Δθ,Δρ)=(2∘,2p). First, an initial peak λ is detected at(θ,ρ)=(16,−22)following the described peak-finding method. Then,σi2-values of columns in the peak region are computed, and a second-order curve is fitted to those values; the minimum of the curve is atθpeak=17.15of subcell accuracy.The functional relation between the mean m and θ is a sine curve. We calculate the means for each θicolumn in the peak region and fit a sine curve. A final ρpeakis computed by interpolating this curve at θpeak.First, compute means miaccording to Eq. (7), for each column in the peak region. Fitting a sine curve g with the computed statistical means mimay be performed as follows: The sine curve is a nonlinear function. Fitting directly a sine curve is difficult; thus we fit it by using the following transform11If π/4 < θ < 3π/4, then apply an alternative transform as follows:m=xc·cosθ+yc·sinθandm/sinθ=xc·cotθ+yc.:(11)m=xc·cosθ+yc·sinθm/cosθ=yc·tanθ+xcWe see that m/cos θ and tan θ are in a linear relation. Now, for these pairs (mi/cos θi, tan θi), we fit a linear function(12)g:m/cosθ=g(tanθ)≜b1·tanθ+b0Altogether, we compute ρpeakby interpolating the fitted sine function corresponding to θpeakas follows:(13)ρpeak=g(tanθpeak)·cosθpeak=b1·sinθpeak+b0·cosθpeakA result is illustrated in Fig. 5. First, the computed mi-values are used for fitting a sine curve. Then, the ρpeak-value is computed by interpolating this sine curve. In the shown example, the interpolated ρpeak-value equals−21.72,and this is again at subcell accuracy. The final normal parameter (θpeak, ρpeak) of the line segment is calculated as being(17.15,−21.72).We calculate the endpoint coordinates of a line segment, called left endpointpl=(xl,yl)and right endpointpr=(xr,yr). Left and right can be defined by viewing toward the origin at the perpendicular point; see Fig. 6.According to the equation of the HT, if the left endpoint votes for two different cells (θ1, ρ1) and (θ2, ρ2), the coordinates of the left endpoint can be computed directly by solving the equational system(14)ρ1=x·cosθ1+y·sinθ1(15)ρ2=x·cosθ2+y·sinθ2Taking the appearance of image noise, pixel disturbance, parameter quantization, and peak spreading into account, we compute the coordinates of endpoints by fitting more cells rather than using two equations only; we calculateρiminandρimaxusing statistical properties instead of searching for the first and last non-zero voting cells.In each column, the first and the last non-zero voting cell contain votes of the line’s endpoints. These cells also corresponds to the maximum voting ρ-value ρmaxand the minimum voting ρ-value ρminin each column.Due to various uncertainties, a direct search for the first and the last non-zero cell is difficult and inaccurate. We calculate those cells by using statistical mean miand statistical variance σi.In the θicolumn, because Riis a random variable with uniform distribution fromρimintoρimax,the statistical mean and variance are equal to the following:(16)mi=(ρimax+ρimin)/2(17)σi2=(ρimax−ρimin)2/12Given values miandσi2,the voting range boundariesρimaxandρimincan be computed as follows:(18)ρimax=mi+3σi(19)ρimin=mi−3σiThis avoids a search for the first and the last non-zero voting cells in each column.Considering the columns left of a peak,ρimaxorρiminare selected to compute the left or right endpoint, respectively. Contrary, in columns right of a peak,ρimaxorρiminare used to compute the right and left endpoint, respectively.For the left endpoint computation, in every θicolumn,(20)ρil:={ρimaxifθi<θpeakρiminotherwiseFor the right endpoint computation, in every θicolumn,(21)ρir:={ρiminifθi<θpeakρimaxotherwiseWe select the set of all pairs(θi,ρil)in the peak region to fit a sine curve(22)ρ=xl·cosθ+yl·sinθAs discussed above, ρ/cos θ and tan θ are in a linear relationship. Again, we fit to those pairs(ρil/cosθi,tanθi)a linear function(23)h:ρ/cosθ=h(tanθ)≜c1·tanθ+c0Based on Eqs. (22) and (23), the endpoint coordinates are then given byxl=c0andyl=c1. Similarly, the right endpoint can be computed by fitting allρirand θivalues.Due to various uncertainty, the endpoints computed above are not expected to be exactly on the line. They need to be projected onto the line defined by normal (θpeak, ρpeak). This is illustrated in Fig. 7. We do as follows:(24)xl′=xl−(yl·sin(θ)+xl·cos(θ)−ρ)·cosθ(25)yl′=yl−(yl·sin(θ)+xl·cos(θ)−ρ)·sinθand(26)xr′=xr−(yr·sin(θ)+xr·cos(θ)−ρ)·cosθ(27)yr′=yr−(yr·sin(θ)+xr·cos(θ)−ρ)·sinθwhere θ and ρ are the calculated normal angle and distance of the line segment, respectively, as computed in Section 4.

@&#CONCLUSIONS@&#
