@&#MAIN-TITLE@&#
Region-based snake with edge constraint for segmentation of lymph nodes on CT images

@&#HIGHLIGHTS@&#
Edge- and region-based snakes were complementary for lymph nodes segmentation.We proposed a segmentation method which integrates both edge and region information.The method does not suffer from the trade-off between edge and region terms.This is a clinical application-based implementation of the B-spline snake.It allows automatic delineation of targeted lymph nodes in CT images.

@&#KEYPHRASES@&#
Automated segmentation,Treatment evaluation,Lymph nodes,CT images,

@&#ABSTRACT@&#
Lymph nodes segmentation is a tedious process with large inter-user variability when performed manually. To facilitate lymph nodes assessment for lung cancer patient, we present an automatic and improved snake segmentation method for thoracic lymph nodes on CT images in this paper. We first investigated the performance of both edge-based and region-based snake algorithms for the segmentation task, using a B-spline contour parameterization. The effect of the number of B-spline control points on the snake performance was also examined. Both edge-based and region-based snakes were found to have their own advantages and disadvantages for lymph nodes segmentation. We further developed a method of region-based snake with edge constraint, which utilizes a self-adjusting mechanism to integrate both edge and region information in a constructive manner. The average Dice Similarity Coefficient obtained was 0.853±0.059 and 0.841±0.108 for the baseline and follow-up lymph nodes respectively using the proposed method. The method was found to be an effective lymph node segmentation method and would potentially be useful to help with treatment response evaluations in the clinical practice.

@&#INTRODUCTION@&#
Lymph nodes assessment is important in clinical practice and drug trials as changes in lymph nodes often indicators of disease progression. In the newly revised RECIST 1.1 [1], uni-dimensional measurement in short axis of enlarged lymph nodes is required for treatment evaluation of cancer patient. Two dimensional (2D) measurement, which takes area into account, could be more revealing on the actual size of the structure. This requires segmentation of the lymph nodes in medical images such as computed tomography (CT) scans. However, manual segmentation is a very tedious process, which suffers from low reproducibility. Computer-aided lymph nodes segmentation tool could be valuable in the clinical practice. Nevertheless, automatic segmentation of lymph nodes is a very challenging problem. First, lymph nodes are very small structures whose boundaries can be obscured due to partial volume effect. Second, they often appear in various size and shape (from bean shape to circular shape and other irregular shapes). Third, they can be located adjacent to structures of similar intensity range, making threshold-based segmentation methods ineffective. Some lymph nodes even share part of the boundary with surrounding tissues. Fourth, high contrast structures such as blood vessels, which have prominent edge profiles, could suppress the expression of lymph node edges and potentially mislead model-driven algorithms based on edge information. Last but not least, central necrosis can occur and further disturb the interior homogeneity of the structure.Several methods have been proposed to assist study of lymph nodes in CT scans in a semi-automatic or automatic manner. Rogowska et al. [2] in 1997 were the first to evaluate four elementary techniques for lymph nodes segmentation on CT images, namely manual tracing, semi-automatic local criteria threshold selection, Sobel/watershed technique, and interactive deformable contour algorithm. Results from phantom images showed that reliable lymph node segmentation is only possible with the use of model-based knowledge. Honea et al. [3] applied the original parametric snake model on phantom nodes and achieved promising segmentation results using information on both the shape of the object and its image properties in the energy formulation. Honea and Snyder [4] extended the 2D active contour model into three-dimensional active surface model. By deriving surface energy from 3D data and incorporating a balloon force, a single user-chosen point balloon will inflate until the object of interest is found. However, the usefulness of the algorithm on real medical images was not reported. Also based on active contour but in its level set representation, Yan [5] reported using fast marching method on lymph nodes in CT, in which they proposed a speed term which is based on both local image gradient and target region intensity features in dealing with the ‘boundary leaking’ problem. Due to disturbance of image noise, the detected lymph nodes may not be smooth enough and this is a limitation of using level set on structures with smooth boundaries. A stable 3D mass spring model (MSM) [6], which took the characteristic gray value range, directed contour information as well as shape knowledge into consideration, was employed by Dornheim et al. [7] for neck lymph node segmentation in 2007. However, a large number of parameters had to be adjusted carefully to ensure good performance and the varying size of the targeted structures would have a significant impact on the performance of the method. This drawback is partially addressed by Dornheim et al. [8] in another study using a multi-model strategy where each single model is specifically designed for a certain type of lymph nodes. Results improved from the original MSM. However, nodes with weak gradients at the border or deformed shape lead to worse results because of partly obscured border or shape information. The MSM model is further improved by Steger and Erdt [9] in 2010 using a size invariant mass spring model, which is less sensitive to the target structure’s size than its predecessors and achieved an average dice similarity coefficient (DSC) of 0.72 over 25 lymph nodes in head and neck region from 11 CT datasets. Besides size invariant MSM, Steger et al. [10] proposed another method in 2011 to segment lymph nodes in the same body region. The closed contour is found by minimizing an energy function, which depends on gradients, intensities and shape priors, using dynamic programming. The average DSC improved to 0.81 using the new method. The algorithm is adapted to radiologists’ behavior by including transition areas in intensity cost function. The DSC is further improved to 0.84. However, the method is highly heuristic and needs more investigation to claim for a general purpose.Considering the above-mentioned challenges, snake model is the most suitable deformable method to accommodate lymph nodes variations in size and shape as well as to combine model-based formulations. In the literature, both Honea [4] and Yan [5] have reported using edge-based active contour for lymph node segmentation. But only results based on phantom images were examined and no quantitative measures were provided. In this paper, we investigated the performance of both edge-based and region-based snake in segmenting lymph nodes of the thoracic region on real CT images. We further developed a strategy to integrate both edge and region information in a constructive manner to improve its performance on lymph nodes segmentation. Section 2.2 explains in detail the implementation of B-spline snake models and the working of the new scheme. Section 3 reports our results. Sections 4 and 5 discuss the findings and draw conclusions.Retrospective thoracic CT images from 8 lung cancer patients were included in the study, among which 18 pairs of suspicious lymph nodes growing over time were examined at both baseline and follow-up scans. In total, 36 lymph nodes were studied. The image was captured using Siemens Sensation Cardiac 64. Thorax routine protocol with source voltage 120kV, current 125mAs, rotation time 0.5s, slice collimation 16×1.5mm and slice width 5.0mm, was used in the scan. The cross-sectional images were of size 512×512pixel, with a voxel resolution 0.64mm×0.64mm×5mm. These are standard CT images acquired for monitoring lung cancer treatment response. The lymph nodes in the study ranged from 1 to 3cm in size and are of aortic, mediastinal, interlobar and hilar in their respective anatomic locations.In order to accommodate large variations in lymph nodes’ morphology, snake models are considered to a suitable method for segmenting the structure. Given an imageI:Ω⊂ℛd→ℛ, a snake model sets out to find a contourx:ℜ→ℜd, such that it minimizes the energy functionminxEx=EexternalI,x+Einternalx. The external energy provides the driving for the contour to evolve while internal energy regularizes the smoothness of the contour obtained.Because of the smooth boundaries of lymph nodes, we choose the cubic B-spline for contour parameterization, which offers high flexibility, local control and computational efficiency [11]. A B-spline curve is a piecewise polynomial function defined as(1)x(s)=∑i=1NBi,k(s)Pifors∈[sk,sN]wherePirepresents the control points governing the contour, andBi,krepresents their corresponding basis functions of degreekpolynomial (k=3for cubic B-spline with the corresponding basis functions shown in Eq. (2)).(2)B0,3(s)=(1−s)36B1,3(s)=(3s3−s2+4)6B2,3(s)=(−3s3+3s2+3s+1)6B3,3(s)=s36An important parameter of B-spline contour is the number of B-spline control points, which corresponds to the same number of B-spline segments for closed contours. Degrees of freedom, which measure the flexibility of the underlying contour and can translate into the ability of delineating structures in finer details, increase with increased number of control points. To study the effect of the number of control points on lymph nodes segmentation and determine an optimal number, the use of various numbers of B-spline control points (ranging from 6 to 24) were examined for both edge-based and region-based snake.For edge-based snake model,Eedge(x,y)=−∫01g(x,y)ds, whereg(x,y)is the edge- or gradient-driven energy landscape for snake to evolve. We made use of Canny edge detector, which was found effective in detecting lymph node boundaries [12], to derive partial lymph nodes edges. Distance transform of the edge map was calculated subsequently and used as the external energy to guide snake evolution.Region-based snake was first proposed by Chan and Vese [13]. It assumes that the image has only two phases present, namely object and background. It attempts to separate the image into two different regions with maximum intensity separation.(3)Eregion(x,y)=λ1∫R1(I−μ1)2dx+λ2∫R2(I−μ2)2dx+λ3∫γds+λ4∫R1dx,where isμ1the mean intensity of regionR1enclosed by the contour andμ2the mean intensity of the outside regionR2. In our study, the parameters were fixed asλ1=0.6andλ2=0.3whileλ3andλ4were taken to be zero as regularization on smoothness is implicit in general spline representation.Both edge-based and region-based snakes have their own strengths and limitations in their formulations. As pointed out by Munoz [14], the two approaches are not affected in the same way by a problem. The overall performance is expected to improve if we could find a way to integrate edge and region information in a constructive manner. Towards this end, a region-based snake with edge constraint is proposed as shown inFig. 1.Referring to Fig. 1, the contour will evolve using region-based snake formulation on gray level CT images while partial edge map of the lymph node is derived using Canny edge detector (examples of derived edge maps are presented in Fig. 4). The contour grows freely until any segment encounters the partial edges of lymph nodes. A hard constraint is imposed on the movement of those segments of the curve touching the edges. To do so, we make use of the locally controlled property of cubic B-spline curves. Out of the four control points responsible for any curve segment, the two middle control points are identified as principal control points since they have more influence over the curve segment than the other two. Thus the gradients of the two principal control points are set to zeros for that iteration, resulting in no movement of those segments which are in contact with edges of the lymph nodes. As a result, segments of the contour touching the edges will be stopped from growing but anchored at the respective edge locations.Note that the movement of each control point is only suspended for the current iteration. Whenever evolution of the curve as the result of other free control points releases the previously paused segment of the curve from its anchored edge, the movement of the corresponding control points resumes; otherwise the movement of those control points will remain halted. This self-adjusting mechanism not only ensures the evolution of contour is confined to the inner side of edge segments but also allows the maximal fitting of the contour to the lymph nodes boundaries.As the iteration continues, the portion of the curve which grows to the edge of the lymph nodes will gradually adapt to the edge profile while the rest of the curve continues to evolve based on region-based formulation. Because the movement of large number of control points could be constrained at each iteration when they come in touch with the edges, the whole curve evolution can become stagnant if the total number of control points is small. Thus, the number of control points used in region-based snake with edge-constraint is set to 18.Two points across the short axis of the lymph node were used for initialization. Subsequently a circle was obtained by taking the distance between the two points as its diameter. The initial control points were obtained by fitting in least squares with the circle line.The performance of B-spline snake segmentation was evaluated quantitatively using both the Hausdorff distance, which is a contour distance-based measure, and DSC, which measures the region agreement between manual segmentation and snake segmentation. Wilcoxon signed-rank test was used as the statistical test to study the significance in the difference of the results from each segmentation method. Qualitative evaluation of segmentation results on representative nodes is presented as well.

@&#CONCLUSIONS@&#
