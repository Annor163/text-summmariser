@&#MAIN-TITLE@&#
Subspace-based linear multi-step predictors in type 1 diabetes mellitus

@&#HIGHLIGHTS@&#
Data-driven subspace-based linear multi-step predictors are proposed.The method exploits orthogonal projection of structured data matrices onto appropriate subspaces.The implementation is efficient and relies upon LQ-decompositions.The approach is successful in short-term T1DM glycemia prediction.

@&#KEYPHRASES@&#
Subspace-based methods,Prediction theory,Diabetes,

@&#ABSTRACT@&#
A major challenge for a person with diabetes is to adapt insulin dosage regimens and food intake to keep blood glucose within tolerable limits during daily life activities. The early knowledge about the effects of inputs on glycemia would provide the patients with invaluable information for appropriate on-the-spot decision making concerning the management of the disease. Against this background, in this paper we propose multi-step data-driven predictors to the purpose of predicting blood glucose multiple steps ahead in the future, supporting therefore the patients when deciding upon treatments. We formulate the predictors based on the state-space construction step in subspace identification methods for linear systems. Physiological models from the literature were used to filter the raw information on carbohydrate and insulin intakes in order to retrieve the input signals to the predictors. The clinical data of 14 type 1 diabetic patients collected in hospital during a 3-days long visit were used. Half of the data were employed for predictor development and the remaining half for validation. Mean population prediction error standard deviation on 30min, 60min, 90min, 120min ahead prediction on validation data resulted in, respectively, 19.17mg/dL, 37.99mg/dL, 50.62mg/dL and 58.06mg/dL.

@&#INTRODUCTION@&#
Diabetes mellitus is a chronic disease of disordered glucose metabolism due to defects in either insulin secretion by the pancreatic β-cells or insulin action [1]. Type I diabetes (T1DM), also called insulin-dependent diabetes mellitus (IDDM) is characterized by failing production of insulin, whereas type II diabetes is caused by decreased sensitivity of the tissues to the metabolic effect of insulin. The basic consequence of insulin lack or insulin resistance is the prevention of the efficient uptake and utilization of glucose by most cells of the body, mainly the skeletal muscles, resulting in abnormally high blood sugar levels (hyperglycemia). Sustained hyperglycemia is associated with acute ketoacidosis, nephropathy, retinopathy, neuropathy and damages to the cardio-vascular system which are irreversible once they develop and can mean serious disability for the person who experiences them [1]. In order to avoid the long-term health complications, the patients need to regulate their blood glucose maintaining its levels as close to normal as possible. This is achieved by exogenous insulin replacement. Focusing on tight blood glucose targets, i.e., 70–140mg/dL [2], the philosophy of insulin replacement is to mimic the physiological endogenous insulin secretion pattern of the non-diabetic person. In the non-diabetic subjects, insulin is secreted into the portal circulation at two rates: a slow basal secretion throughout the 24h and an augmented rate at meal times. This pattern can be achieved to some extent with the so-called basal-bolus regime: a basal dose of long-acting insulin is sufficient to keep a constant glucose concentration during fasting conditions and a prandial bolus of rapid-acting insulin enhances an increased glucose uptake during and after meals. In current medical practice, the rough calculation of insulin doses and eventually extra carbohydrate intakes is based on empirical rules-of-thumb. Many factors have to be considered in this decision process: health status, current blood glucose level, blood glucose target, foreseen activities, insulin sensitivity, expected future glycemia evolution and approximation of the estimated meal carbohydrate content effects as well as insulin impact on the subject own blood glucose, taking into account medical advice and patients previous experience of his/her own metabolism. One common measure used in this regard is the carbohydrate-to-insulin ratio, which is an estimate of how many insulin units to administer to match the amount of digested carbohydrates. The task is non-trivial and demanding, although the standard tools in diabetes care improved significantly during the last decades.Against this background, a personalized blood glucose predicting system to be used on the spot by the users in different daily situations, predicting glycemic excursions following meals, insulin intakes and exercise, would support the patients in optimizing their therapy. Actually, this was the focus of the European FP7-IST research project DIAdvisor™ [3] during the quadrennium 2008–2012. The predictor system needs user inputs concerning patient condition (e.g., fasting, meal time, rest or physical activity), time and size of meals and insulin doses, minimally invasive glucose sensors and produces short-term, i.e., up to 120min, blood glucose predictions to be graphically shown to the patients.Although seemingly simple in concept, the problem of glucose prediction in an active individual has to date proved intractable. Currently, continuous glucose monitoring (CGM) devices are the available technology able to provide high/low glucose alarms when certain user specified preset threshold levels have been crossed and to deliver warnings of events that are likely to occur if the current trend continues. However, patients will benefit more from an early alarm that predicts the episodes before they occur. To date many studies have investigated the possibility of predicting blood glucose concentration for the purpose of regulating glucose intervention, in order to enable individuals to take corrective actions and avoid low or high glucose values (see e.g., [4,5] for a comprehensive review on T1DM modeling). Bremer and Gough [6] originally developed the idea of T1DM CGM time-series analysis using 10-min sampled data from ambulatory T1DM patients to identify autoregressive (AR) models. They explored 10, 20 and 30min prediction horizons, and report that the 10-min predictions are accurate and the 20-min or 30-min predictions may also be acceptable for a limited set of data only. Sparacino et al. [7] collected 48h of continuous (3-min) glucose data from 28 T1DM subjects in ambulatory conditions. In their retrospective analysis, they recursively identified simple polynomial and AR models from the CGM time-series data, prefiltered to removed noise spikes. They investigated prediction horizons of 10 and 15 steps (i.e., 30 and 45min) and concluded that hypoglycemia can be detected 25min before the hypoglycemic threshold is passed. A tutorial overview of algorithms for CGM time series analysis to the purpose of alarm generation is provided in [8]. Eren-Oruklu et al. [9] proposed a recursive second-order AR and ARMA model identification strategy with an adjustable forgetting factor for healthy and type II diabetics. Their models utilized only recent glucose history from a CGM device, achieving 3–5% error for 30-min-ahead prediction. In [10] a kernel-based regularization learning algorithm, in which the kernel and the regularization parameter are adaptively chosen on the basis of previous similar learning tasks, using past glucose concentration information, was presented. A short-coming of the methods listed above is the lack of exploitation of the dynamic interplay between previously injected insulin, meal intake and eventually exercise to the purpose of improving glucose prediction. Patient-specific ARX models both batch-wise and recursively identified from nine patients data records by Finan et al. [39] showed a mean 30-min prediction error RMSE of 26mg/dL. An ARX model with a nonlinear forgetting factor scaled according to the glucose range was considered in Castillo-Estrada et al. [11,12], and a 45-min prediction horizon showed good results. A feedforward neural network (NN) was exploited in [13] and tested on 10 real datasets, incorporating, in addition to CGM data, other inputs such as SMBG readings, information on insulin, meal, hypo- and hyperglycemia symptoms, lifestyle, activity and emotions and predict glucose values up to 75min. In [14–16], 30-min-ahead prediction was performed with a feedforward NN in cascade with the first-order polynomial model in [7]. The inputs to the linear predictor were the past CGM values weighted using a forgetting factor, while the inputs to the NN were current CGM and its trend, information on the past error committed by the polynomial model and information on meal, supplied as plasma glucose rate of appearance obtained from the physiological model of [17]. In [18] a recurrent NN (RNN) was shown to outperform a feedforward NN in predicting glycemia in 12 children on a short-term prediction horizon. Zhao et al. [19] used a latent variable-based approach to predict future CGM values from past CGM and known carbohydrate and insulin boluses, transformed into time-smoothed inputs using second-order transfer functions. The method was applied to collected clinical data and simulated data generated by the model described in [20,21]. They concluded that their LV-based method resulted in models whose prediction accuracy was as least as good as the accuracies of standard AR/ARX models. In [22] a multi-sensor body monitor providing seven signals related to activity and emotional conditions was used in addition to a CGM monitor to improve glucose prediction. A multivariate ARMAX model with weighted recursive least-squares estimation of the unknown parameters using a variable forgetting factor was proposed. Results showed that the prediction error can be significantly reduced with the addition of the vital signs measurements, as compared to an ARMA model based only on CGM signals. Balakrishnan et al. [23] developed personalized glucose prediction models taking into account physical exercise, meal and insulin interventions as input and CGM sensor measurements as output and validated them using the clinical data of 34 children and adolescent. The input–output relationship was described by means of transfer functions with different number of poles (varying between 1 and 3) and with or without zeros for each input. Last, the same authors proposed in [24] personalized mechanistic models involving exercise, meal and insulin interventions for type 1 diabetic children.This contribution is concerned with subspace-based multi-step linear predictors, previously introduced in [25,26], to the purpose of short-term T1DM glycemia prediction. The approach is data-driven to overcome the limitations arising from the lack of the underlying physiological system model and takes into account meal and insulin informations as well as subcutaneously measured blood glucose concentration. To the best of the our knowledge this is the first time such multi-step predictors are applied to diabetes management.The paper is organized as follows. Section 2 deals with the subspace-based predictors, Section 3 introduces the clinical data acquisition, while in Section 4 the proposed subspace predictors are used to forecast blood glucose concentrations multi-steps ahead. Results of such a procedure are given in Section 5, followed by some discussion and conclusions on the achievements in Section 6.Consider a discrete-time linear time-invariant systemSn(A,B,C,K)in innovation form(1)xk+1=Axk+Buk+Kekyk=Cxk+ekwhereuk∈ℝmis the input,yk∈ℝlthe output,xk∈ℝnthe state,ek∈ℝlthe zero-mean white noise innovation process uncorrelated with ukandA∈ℝn×n,B∈ℝn×m,C∈ℝl×n,K∈ℝl×nare constant matrices. In the following, assume that (A, B) is reachable and (C, A) is observable. Further, assume that no linear feedback from the states to the input is present, i.e., input–output data are obtained from an open-loop experiment and the sampling is uniform.The available data sequences {uk}, {yk}, the state {xk} and the innovation process {ek} will be organized in Hankel matrices denoted by uppercase letters. Subscript indices [α, β] of a Hankel matrix will be used to indicate the argument of the upper-left and the lower-left element, respectively, e.g.,U[t1,t2]will contain in the first column the input history between instants t1 and t2. Accordingly, data records of finite length N will be represented by the block rows of the Hankel data matrices and will be denoted by uppercase letters, the subscript indicating the first time instants of the time series:U[t1,t2]=Ut1Ut1+1⋮Ut2=ut1ut1+1⋯ut1+N−1ut1+1ut1+2⋯ut1+N⋮⋮⋯⋮ut2ut2+1⋯ut2+N−1The orthogonal projection of the rows of a given matrix A onto the row space of a given matrix B will be denoted byEˆ{A∣B}, whereas the symbolEˆ∥C{A∣B}will denote the oblique projection of the row space of A onto the row space of B along the row space of C, the projection operator beingEˆ{·}. Throughout the paper k will be the discrete-time index, t shall denote the current time instance in the identification problem, t0 shall be the initial time from which the data are collected, so that t−t0=p is the past horizon in the identification problem, T shall be such that T−t+1=f represents the future horizon. The two integers p and f are such that p≥max(f, n), n model order. Last, the number of steps in the look ahead that one wishes to investigate will be denoted by τ, where τ≤f.Suppose ideally that we have observations of the processes {uk}, {yk}, {xk}, {ek}, k∈[t−p, t+f−1]. In addition, suppose the finite length N of the interval be large. Since the finite length observed data sequences are realization of the underlying stochastic processes in Eq. (1), the following holds:(2)Xk+1=AXk+BUk+KEkYk=CXk+EkFurthermore, from the observed samples construct the following block Hankel matrices:(3)Up=U[t−p,t−1]∈ℝp·m×N(4)Uf=U[t,t+f−1]∈ℝf·m×Ncalled the past and future input data matrices, respectively, and(5)Yp=Y[t−p,t−1]∈ℝp·l×N(6)Yf=Y[t,t+f−1]∈ℝf·l×Ncalled the past and future output data matrices, respectively.Define the extended observability matrix(7)Of=CCACA2⋮CAf−1and the Toeplitz matrices containing the impulse responses of the system due to the input ukand the innovation process ek, respectively(8)Hf=00⋯0CB0⋯0⋮⋮⋱⋮CAf−2BCAf−3B⋯0,Wf=I0⋯0CKI⋯0⋮⋮⋱⋮CAf−2KCAf−3K⋯0Then, by iteration of the system equations in Eq. (1), the following matrix input–output relations may be written to express the future output matrix:(9)Yf=OfXf+HfUf+WfEfIn the practical scenario the state sequence Xfis not known, so future outputs cannot be computed. An estimator of future output can be found, however, from the available data as a linear combination of the joint input–output past and the future input (see Appendix A.6 in [27] for a proof), provided that ukand ekare uncorrelated:(10)Yˆf=ΓˆZp+ΛˆUfwhere we have introduced the short-hand notation(11)Zp=UpYp=Z[t−p,t−1]∈ℝp·(m+l)×Nto denote the past joint input–output data matrix. Now, the problem of finding an optimal output predictor can mathematically be formulated as a least-squares problem:(12)Γˆ,Λˆ=argminΓ∈ℝlp×(l+m)pΛ∈ℝlp×mfYf−ΓΛZpUfF2where ∣∣·∣∣Fstands for the Frobenius norm of a matrix. Note that in this way f prediction problems are solved simultaneously row-wise. Each problem consists in estimatingYˆt+τ, τ∈[0, f−1]:(13)Yˆf=YˆtYˆt+1⋮Yˆt+f−1=yˆtyˆt+1⋯yˆt+N−1yˆt+1yˆt+2⋯yˆt+N⋮⋮⋮⋮yˆt+f−1yˆt+f⋯yˆt+f+N−2A geometric interpretation can be given to the least-squares problem as the orthogonal projection of YfontoZpUf⊤, i.e.,(14)Yˆf=EˆYf∣ZpUfActually, the orthogonal projection (14) corresponds to the sum of two oblique projections ([28, Lemma 1]) under the assumption span(Zp)∩span(Uf)={0}, with span(·) standing for the space spanned by the raw vectors of a matrix:(15)Yˆf=Eˆ∥Uf{Yf∣Zp}+Eˆ∥Zp{Yf∣Uf}(16)Yˆf=ΓˆZp+ΛˆUfOnce the operatorΓˆandΛˆhave been estimated, they can be applied to new data generated by the same underlying mechanisms, to forecast the output τ steps ahead.Numerically, the efficient implementation of such projection operations relies upon LQ decompositions (i.e., transpose of the QR decomposition) [29]. The following algorithm is outlined:Algorithm 1[30,27]1.Consider the following(17)UfZpYf=L1100L21L220L31L32L33Q1TQ2TQ3TwhereL11∈ℝfm×fm,L22∈ℝp(m+l)×p(m+l),L33∈ℝfl×fland Qi, i=1, …, 3 are orthogonal.Define(18)Γˆ=L32L22†(19)Λˆ=(L31−L32L22†L21)L11−1Use Eq. (10) to calculate the future outputs asYf=ΓˆZp+ΛˆUfIn the framework of the DIAdvisor™ project [3], clinical data acquisition from insulin-treated diabetic subjects was accomplished during a 3 days in-hospital trial. The investigations focused on a population of basal-bolus regimen treated subjects, either as combination of multiple daily insulin injections or as continuous insulin infusion from a pump. Prior to any study procedure the subjects participating in the study signed an informed and witnessed consent form. Standard meals for breakfast (8.00am), lunch (1.00pm) and dinner (7.00pm) were served, the amount of administered carbohydrates being 42, 70 and 70g, respectively. During the whole 3-days-long visit, the participant was permanently equipped with the Abbott Freestyle Navigator™ Continuous Glucose Monitoring Sensor (CGMS) [31] which provided estimates of glycemia levels from interstitial glucose measurements every 10min. No specific intervention on usual diabetes treatment was scheduled during the period. The patients decided their insulin needs according to the glucose measurements from the HemoCue® 201+ Glucose Analyzer [32] as usually in activities of daily life. As needed, particularly when hypo- or hyperglycemia occurred, support was provided by nurses and physicians. We present results for a population of 14 patients (nine males and five females, age 45.8±12.7 [years], disease duration 18±11.6 [years], BMI 23.4±2.7 [kg/m2], 10 MDI and 4 CSII, HbA1c 7.6±1 [%], total daily insulin 41.9±18.9 [IU]). Fig. 1presents population statistics of patients clinically relevant parameters, whereas Fig. 2gives the empirical distribution of the output signal for all the patients in the population. The selection criteria were the quantity of data collected (>80% of the expected), no sensor failures and patient diary correctly filled in. Fig. 3shows the data for a representative patient.The physiology of glucose metabolism in diabetes was considered having one output, i.e., glucose level in the bloodstream yBG, and two main inputs, i.e., carbohydrate intake ucarband administered insulin Iir(Fig. 4). Physiological models from the literature were used to filter the raw informations on carbohydrate and insulin intakes collected by the study participants in their diaries. In particular, the glucose intestinal absorption model first presented in [33] was used to retrieve the glucose rate of appearance in plasma after a meal, i.e.,uˆg, while the insulin pharmacokinetics model in [20] allowed us to compute the insulin appearing in plasma after subcutaneous injection, i.e.,uˆi. Both models exploited mean population values for the parameters appearing therein which were provided us by Dalla Man and co-workers. Fig. 5reproducesuˆganduˆisimulated for a representative patient parameter set. The Abbott FreeStyle Navigator™ [31] records were taken as assessment of glycemia. A retrospective recalibration against the collected HemoCue [32] samples was performed offline. The algorithm proposed by King et al. in [34], later evaluated by Facchinetti et al. in [35], was used. For each patient a recalibration parameter αrwas found by least-squares estimation:αr=argminα||yBG−αyIG||2with yBGand yIGdenoting the HemoCue and the CGM samples, respectively. The recalibrated tracesyIGr=αryIGwere provided by Facchinetti and co-workers within the DIAdvisor™ project and were used as output signals. We were interested in predictions up to 120min ahead. Denoting by τmax (min) the maximum prediction horizon we take into consideration, we distinguished two simulation set-ups: Case A where we wanted to optimize predictions up to 30min ahead, i.e., τmax=30 and Case B with focus on predictions up to 120min, i.e., τmax=120. The scheme used for calculation of multi-step predictions is reported in Algorithm 2.Algorithm 2Multi-step prediction1.Choose the maximum prediction horizon τmax.Set p=f=τmax.EstimateΓˆandΛˆfrom Eqs. (18) and (19) applying Algorithm 1 to the first half of the data.Let t denote the current time step. Form the predictionsyˆof the second half of the data (validation) using the relation(20)yˆtyˆt+1yˆt+2⋮yˆt+f−1=Γˆzt−pzt−p+1zt−p+2⋮zt−1+Λˆuˆtuˆt+1uˆt+2⋮uˆt+f−1wherezt−pzt−p+1⋯zt−1⊤are the joint input–output data up to time t−1 anduˆtuˆt+1⋯uˆt+f−1⊤are the future inputs. Notation:uˆ=uˆiuˆgandy=yIGr.

@&#CONCLUSIONS@&#
In this contribution subspace-based data-driven linear multi-step predictors have been applied to the problem of short-term prediction of blood glucose concentration in T1DM. Resorting to geometric operations on appropriate subspaces spanned by the measured input–output data sequences, predictor coefficients were estimated directly from the collected data. No model structure selection or model order determination was, therefore, required.Some conditions need to be fulfilled in order to have unbiased predictors. Specifically:•Input data should be “rich” enough, that is, the persistency of excitation of the data should be of sufficiently high order.The space spanned by the row vectors of matrix Zpand the space spanned by the row vectors of matrix Ufshould have zero intersection: span(Zp)∩span(Uf)={0}. This corresponds to no feedback interconnectionThe second condition is necessary for the orthogonal projection to split uniquely into the sum of two oblique projections (Eq. (15)). When data are generated in closed loop this condition is no longer satisfied.Throughout the paper, p was chosen so to meet the following condition:p≥max{n,τ}in order for the system (1) to be observable (condition p≥n) and to guarantee predictions up to the largest future horizon we wished to investigate (condition p≥τ). The parameter has strong connections with model order, and to optimize results it should be given by the user from knowledge or intuitions on the system dynamics. Indeed, requesting to predict with a look-ahead τ≫n implies to choose also p≫n, which lead to overparametrization of the model and suboptimal performances.In the diabetes application, the effects of the choice of p on the prediction performances were tested in two scenarios: Case A, where the prediction horizon τ was set to 10min, 20min, 30min, respectively, and the parameter p was chosen equal to the maximum τ, i.e., p=30; and Case B, with τ=30, 60, 90, 120 and p=τmax=120. Actually, p should be given by the user so to optimize performances. In other words, if the objective is to predict τ=30min ahead p should not be given ≫ 30. Inspection of Tables 1 and 2 confirmed this statement. The highlighted columns refer to the same prediction horizon, i.e., τ=30min, and show better performances in the case where p=τ=30 (Case A).A third-order ARMAX model was identified for each of the patients and a model-based Kalman predictor was constructed in order to allow comparison with the proposed algorithm. Tables 5–11 prove the competitiveness of our approach.