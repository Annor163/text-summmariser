@&#MAIN-TITLE@&#
BotGrab: A negative reputation system for botnet detection

@&#HIGHLIGHTS@&#
A novel negative reputation system is proposed to detect bot-infected hosts.It considers both malicious activities and history of coordinated group activities.A proposed online incremental clustering technique facilitates the online learning.The negative reputation threshold can adjust the sensitivity of the system.It can successfully detect various botnets with a high DR and a low FAR.

@&#KEYPHRASES@&#
Botnet detection,Negative reputation system,Reputation score,Coordinated group activity,Malicious activity,

@&#ABSTRACT@&#
Botnets continue to be used by attackers to perform various malicious activities on the Internet. Over the past years, many botnet detection techniques have been proposed; however, most of them cannot detect botnets in an early stage of their lifecycle, or they often depend on a specific command and control protocol. In this paper, we propose BotGrab, a general botnet detection system that considers both malicious activities and the history of coordinated group activities in the network to identify bot-infected hosts. BotGrab tracks suspected hosts participating in some coordinated group activities and calculates a negative reputation score for each of them based on the history of their participation in these activities. A suspected host will be identified as being bot-infected if it has a high negative reputation score or performs some malicious activities while having a low negative reputation score. We demonstrate the effectiveness of BotGrab to detect various botnets including HTTP-, IRC-, and P2P-based botnets using a testbed network consisting of some bot-infected hosts.

@&#INTRODUCTION@&#
The increasing number of malware threats and the growing complexity of cyber attacks have attracted renewed interest in much of the recent research. Over the past few years, the objectives and motivations behind malware threats have changed significantly; hence, they have evolved into better organized and more profit-centered endeavors [1]. This matter has created a new type of threat that endangers thousands of network infrastructures around the world. At the heart of these threats lies a network of compromised hosts remotely controlled by an attacker. These hosts form a botnet.The term bot is short for robot. A bot, also known as zombie or drone, is a kind of malware that runs on a host typically unbeknownst to its owners and carries out commands sent by a so-called botmaster. A botnet is a network of bot-infected hosts, and its value to the botmaster can be quantified by some characteristics, such as diversity of attacks, botnet size, attack rate, and synchronization level [2]. Due to a large number of bots and their coordinated behaviors, it not only provides the botmaster with more processing power and Internet bandwidth for free but also allows her to launch coordinated attacks on an unprecedented scale and complexity.The number of botnets has risen dramatically in the past few years [3] and they have become one of the biggest malware threats, responsible for a large volume of malicious activities. Therefore, there is a need to develop an effective technique for botnet detection and the best policies can be taken out only when the behavior of each stage of the botnet lifecycle is clearly understood.The lifecycle of botnets can be generally divided into three stages: formation, command and control (C&C), and attack. In the formation stage, the botmaster spreads her bots using a propagation mechanism, such as exploiting propagation, email propagation, web browser propagation, and file sharing propagation [4] to compromise numerous hosts and install bots on them. The bots then try to join the botnet through a rallying mechanism and form a botnet meeting the needs of the botmaster. In addition, each bot is programmed carefully so that it can connect to the botmaster through a C&C channel to update itself with new instructions and code in order to launch new attacks. In the C&C stage, the botmaster sends her commands via C&C channels to remotely control her bots. Finally, in the attack stage, the bots perform different types of malicious activities, such as launching distributed denial of service attacks, sending spam, leaking personal information, and defrauding pay per click advertisers [5].Although various techniques have been recently proposed to detect botnets, most of them have some limitations in terms of depending on a specific C&C protocol, lacking of detection in an early stage of the botnet lifecycle, working offline, and needing to labeled data for training. To overcome some of these limitations, several techniques have been suggested that generally focus on identifying botnet coordinated group activities, but they still suffer from the lack of enough attention paid to the history of these activities. Therefore, this makes them potentially have a high false alarm rate.Moreover, reputation systems represent a significant trend in supplementary decision making services and they have been extensively used in many applications, such as P2P networks [6,7], multi-agent systems, ad-hoc and wireless sensor networks [8], and file-sharing systems [9]. The basic idea is to let a party (or parties) calculate reputation scores for a set of objects based on a collection of opinions hold about the objects.In this paper, we propose BotGrab, a novel negative reputation system that considers both malicious activities and the history of coordinated group activities in the monitored network to identify bot-infected hosts. BotGrab leverages intrinsic behavior of bots in a botnet, which is that they (1) receive the same commands from the botmaster in the C&C stage and (2) perform some malicious activities in response to those commands in the attack stage. Hence, this behavior leads bot-infected hosts to participate in some coordinated group activities in these stages, which can be used as a “footprint” to identify them.The main contributions of this paper are as follows:•We develop a general botnet detection system that considers both malicious activities and the history of coordinated group activities in the monitored network. Thus, it is able to identify bot-infected hosts that perform some malicious activities in the attack stage or participate in some coordinated group activities in an early stage of the botnet lifecycle.We propose a novel negative reputation system to track each suspected host in the network and calculate a negative reputation score for it based on its participation in coordinated group activities. We also take some factors into account to make the score more reliable. Consequently, this would be much more accurate than in the case where some hosts temporarily participate in few coordinated group activities.We build a prototype of BotGrab to demonstrate how it works in the real network traffic including various botnets (e.g., those controlled via IRC, HTTP, or P2P). The experimental results show that it can successfully detect various botnets with a high detection rate and a low false alarm rate.The rest of this paper is organized as follows: Section 2 provides a general overview of botnet C&C channels and briefly reviews some related work. Section 3 presents BotGrab and Section 4 reports experimental results. Finally, Section 5 discusses some conclusions.Each botnet has a form of communication infrastructure that the botmaster can use to send out commands to her bots and receive responses from them [10]. This communication infrastructure is commonly known as command and control (C&C) channel.Botnets can be classified into two main categories based on the structure of their C&C channels: centralized and distributed. In the centralized botnets, the botmaster usually designates a host with a high bandwidth Internet access as C&C server and then utilizes IRC or HTTP protocol to communicate with her bots. Although the centralized structure is easy to construct and efficient in distributing the botmaster’s commands, it presents a major weakness: the C&C server becomes a single point of failure. In fact, taking down the server would cause all bots to lose their communications with the botmaster.In order to avoid the weakness of having a single point of failure, in the distributed botnets, the communication infrastructure does not completely depend on only a C&C server and it cannot be destroyed even by detecting a number of bots [11]. In these botnets, the botmaster utilizes a P2P protocol to communicate with her bots. In a P2P-based botnet, a new bot-infected host needs to follow an initial procedure, usually known as bootstrap, so that it can find and then join the botnet. There are two general ways of bootstrapping: using an initial peer list or using rendezvous server hard-coded in each bot to obtain the IP address of peer bots in order to join the botnet. Instead of connecting with one C&C server, each bot connects to its peer bots and acts as both client and server. Therefore, if some bots in the botnet are detected, the botnet can still continue to operate under the control of the botmaster. In fact, she can inject her commands to some bots and they distribute these commands to all peer bots connected to them.

@&#CONCLUSIONS@&#
