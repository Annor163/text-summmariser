@&#MAIN-TITLE@&#
Computer-assisted diagnosis for chronic heart failure by the analysis of their cardiac reserve and heart sound characteristics

@&#HIGHLIGHTS@&#
We proposed an innovative LS-SVM based system for diagnosis of CHF.Two novel features of heart sound such as fPSDmax and sub_EF were proposed.The cardiac reserve indexes and heart sound features were used to diagnose the CHF.The classification performances of LS-SVM, HMM and BP-ANN were compared.

@&#KEYPHRASES@&#
Heart sound,Cardiac reserve,MF-DFA,MESE,EMD,CHF,

@&#ABSTRACT@&#
An innovative computer-assisted diagnosis system for chronic heart failure (CHF) was proposed in this study, based on cardiac reserve (CR) indexes extraction, heart sound hybrid characteristics extraction and intelligent diagnosis model definition. Firstly, the modified wavelet packet-based denoising method was applied to data pre-processing. Then, the CR indexes such as the ratio of diastolic to systolic duration (D/S) and the amplitude ratio of the first to second heart sound (S1/S2) were extracted. The feature set consisting of the heart sound characteristics such as multifractal spectrum parameters, the frequency corresponding to the maximum peak of the normalized PSD curve (fPSDmax) and adaptive sub-band energy fraction (sub_EF) were calculated based on multifractal detrended fluctuation analysis (MF-DFA), maximum entropy spectra estimation (MESE) and empirical mode decomposition (EMD). Statistical methods such as t-test and receiver operating characteristic (ROC) curve analysis were performed to analyze the difference of each parameter between the healthy and CHF patients. Finally, least square support vector machine (LS-SVM) was employed for the implementation of intelligent diagnosis. The result indicates the achieved diagnostic accuracy, sensitivity and specificity of the proposed system are 95.39%, 96.59% and 93.75% for the detection of CHF, respectively. The selected cutoff values of the diagnosis features are D/S=1.59, S1/S2=1.31, Δα=1.34 and fPSDmax=22.49, determined by ROC curve analysis. This study suggests the proposed methodology could provide a technical clue for the CHF point-of-care system design and be a supplement for CHF diagnosis.

@&#INTRODUCTION@&#
Chronic heart failure (CHF) occurs in the situation that heart loses the ability to pump adequate oxygen-rich blood to meet the need of peripheral tissues and organs of the body. This may cause some symptoms such as shortness of breath, tiredness, irregular heartbeats, etc. Compared to the expensive imageological diagnosis and biochemical analysis, it is of great significance to develop a non-invasive, low-cost and convenient detection method for CHF diagnosis.Many researchers have devoted themselves to the studies on computer-assisted diagnosis for CHF based on the detection and analysis of Electrocardiograph (ECG). Ivanov et al. [1,2] and Dutta [3] have found there are both a loss of multifractality in heartbeat sequences and ECG of the patients with CHF. The prolongation duration of QRS or wide QRS/T angles could be a predictive indicator of CHF [4,5]. Skrabal et al. [6] used ECG detection combined with bio-impedance measurement technique to diagnose CHF. However, ECG can only detect the cardiac chronotropic and dromotropic action instead of the cardiac inotropic action that is reduced significantly in CHF patients [7], so it can be seen that single ECG detection for the diagnosis of CHF is insufficient.Heart sound is very important as it directly reflects the mechanical properties of heart activity [8,9]. The studies on the relationship between heart sound and cardiac contractility indicate that the amplitude of the first heart sound (S1) is positively correlated with the maximum rise rate of left ventricular pressure (r=0.9551, p<0.001) and the amplitude of S1 is also closely related to the strength of cardiac contractility [10,11]. This has suggested that the amplitude of S1 can reflect the level of cardiac contractility. The most important aspect of cardiac dysfunction in heart failure is not the depressed cardiac performance observed at basal resting state but rather the loss of cardiac reserve (CR) [12,13], which is manifested in the decrease of cardiac contractility, so the detection and analysis of heart sound and the measurement of CR could provide important clues for the diagnosis of CHF. Based on the relationship between heart sound and cardiac contractility, an noninvasive and quantitative method for the assessment of CR has been proposed by our group [14,15]. Some diagnostic techniques such as real-time transmission of the phonocardiogram (PCG) through the Internet and computer-assisted auscultation were developed [16,17]. The application of CR indexes in monitoring and evaluating heart function for gestational woman was implemented [18]. However, until now, the studies about the application of CR in the diagnosis of CHF have not been reported, and the utilizations of heart sound characteristics for the diagnosis of CHF are few, except that an appearance of the third heart sound is regard as a highly specific and none sensitive marker for the diagnosis of CHF [19,20].In this paper, an intelligent diagnosis system for CHF diagnosis was proposed, the schematic of which is shown in Fig. 1. It consists of acquisition system (hardware) and decision support system (software). The acquisition system includes sensor, acquisition circuit and computer device shown in Fig. 2. The decision support system is embedded in the computer. This paper emphatically introduces the decision support system that includes the following parts. The preprocessing is implemented based on amplitude normalization and modified wavelet packet denoising methods. The CR indexes such as the ratio of diastolic to systolic duration (D/S) and the amplitude ratio of the first to second heart sound (S1/S2) combined with three heart sound characteristics such as the frequency corresponding to the maximum peak of the normalized PSD curve (fPSDmax), adaptive sub-band energy fraction (sub_EF) and multifractal spectrum parameter were proposed to structure a diagnostic feature set. The self-developed cardiac reserve monitor software (CRM version1.0, Chongqing University and Bo-Jing Medical Informatics Institute, China) was used to measure the CR indexes, and the heart sound characteristics were extracted based on maximum entropy spectra estimation (MESE), empirical mode decomposition (EMD) and multifractal detrended fluctuation analysis (MF-DFA) methods which are good at the analysis of non-stationary and non-linear physiological signal [21–23]. The LS-SVM was determined as the classifier of proposed system by the comparison of performances with back-propagation artificial neural network (BP-ANN) and hidden markov model (HMM). A dataset collected from the healthy volunteers and CHF patients was used to verify the proposed system. In addition, statistical analysis methods such as t-test and ROC curve were conducted to suggest the diagnosis thresholds. The purpose of our study is to explore a new effective computer-assisted diagnosis technique for the diagnosis of CHF.The outline of this paper is organized as follows. Section 2 describes the detail of proposed diagnostic system including the methodologies of preprocessing, feature extraction and identification. Section 3 represents the statistical result of CR indexes and heart sound characteristics and the comparison of diagnostic performance among LS-SVM, BP-ANN and HMM. Section 4 discusses the differences of diagnostic indexes and characteristics between the healthy and CHF patients as well as the advantage and limitation of the proposed system. Section 5 gives the conclusion and future work of the study. The methodology framework of this paper is shown in Fig. 3.The subjects consist of 88 healthy volunteers (college students and teachers) as controls and 64 CHF patients, who knew and signed the informed consent forms. The patients with CHF include the patients with heart failure with reduced ejection fraction (HFrEF) and heart failure with preserved ejection fraction (HFpEF), which are confirmed by the experienced cardiologists. The CHF patients with left ventricular ejection fraction (LVEF) more than 50% are considered as the patients with HFpEF, and the others are considered as the patients with HFrEF [24], shown in Table 1. LVEF was calculated by the modified Simpson's rule through echocardiography examine using a color Doppler Ultrasound medical machine (Vivid-7, GE company, USA). One minute heart sound was recorded from the apex position of each subject in rest state by employing the self-developed cardiac reserve monitor (11,025Hz sampling frequency and 8-bit resolution) shown in Fig. 2. The normal and pathological heart sound samples were gathered at Chongqing University and the First and the Second Affiliated Hospitals of Chongqing University of Medical Sciences, respectively.The CR indexes such as S1/S2 and D/S were employed to evaluate cardiac function noninvasively [14], which denote the amplitude ratio of the first to the second heart sound (S2) and the ratio of diastolic to systolic duration in a cardiac cycle, illustrated in Fig. 4. The S1/S2 and D/S indexes are relative indicators used to evaluate the cardiac contractility reserve which can reflect the relationship between left ventricular systolic function and peripheral circulation and appraise whether cardiac blood perfusion time is sufficient or not during diastole, respectively [15]. The CR indexes were measured by CRM software shown in Fig. 5.Normalization is necessary to eliminate the amplitude differences of heart sound signals caused by the different chest wall thickness of subjects. It aims to maintain the amplitudes of the normalized heart sound signals from −1 to 1, and is operated as:(1)snorm(n)=s(n)maxn=1N(|s(n)|)where N is the number of data points. s(n) and snorm(n) are the original and normalized heart sound signal, respectively.It is necessary to reduce the disturbance in heart sound singals that could cause great influence on the diagnosis performance [25]. Wavelet packet-based noise reduction has been proven effective to remove the disturbance introduced during the data gathering process such as the interferences of the background-noise, power and respiratory sounds [26]. In this study, we proposed a modified wavelet packet-based denoising method where the threshold estimation and calculation have been improved. Both the low and high frequency components of heart sound signal were decomposed to obtain the relevant approximate coefficients and detail coefficients by a Daubechies-10 wavelet at 8th level, and then the improved soft threshold model was employed to alter the detail coefficients of each decomposition level, according to following principle:(2)ωˆj,k=th(ωj,k,ζj),|ωj,k|ζj≥1;0,|ωj,k|ζj<1;(3)th(ωj,k,ζj)=sin(ωj,k)ωj,k2-ζj2+ωj,k(4)ζj=lnNjln[e+(j−1)2]where ωj,kdenotes the detail coefficients in the kth position of the jth decomposition level and ζjdenotes the noise coefficient threshold in the jth decomposition level.ωˆj,kis the modified detail coefficients. Njis the number of the detail coefficients in the jth level. Finally, the reconstruction of the original approximate coefficients and improved detail coefficients was the heart sound signal after noise cancelation.Because of the superiority that differentiates between multifractal properties of the heart rate in the healthy people and patients with left ventricular systolic dysfunction [27], MF-DFA method, which implements an overall (localized or integral) multi-scale detection of multifractal behavior, proposed by Kantelhard et al. [28], was utilized to calculate the multifractal spectrum of heart sound correspondingly. Firstly, the sum of squares of deviations of x(i) is computed as:Y(j)=∑i=0j(x(i)−x¯). And then, the new time series Y(j) is divided into the non-overlapping equaling segments of size s (the number of these segments is Ns=int(N/s)), which starts from both the beginning and end of the series to obtain 2Nssegments. The fluctuationF2(s,v)is calculated as the sum of squares of local differences:(5)whenv=1,2,…,Ns,F2(s,v)≡1s∑i=1s[Y((v−1)s+i)−Pv(j)]2(6)whenv=Ns+1,Ns+2,…,2Ns,F2(s,v)≡1s∑i=1s[Y(N−(v−Ns)s+i)−Pv(j)]2where s describes scale,v∈[1,2Ns]is the current segment number,Pv(j)is the least-square fit within a segmentv. The fluctuation function is determined as follows:(7)Fq(s)≡12Ns∑v=12Ns[F2(s,v)]q/21/qwhere q is the fluctuation parameter, which allows us to focus the analysis upon different magnitudes of the overall fluctuations.The power-law scaling function determines the scaling behavior of the fluctuation functions by analyzing the log–log plot of Fq(s) versus s for each value of q, which is estimated in the form:(8)Fq(s)∼sh(q)where h(q) is the slope in a log–log plot of Fq(s) versus s called generalized Hurst exponent. Finally, applying the Legendre transform to h(q), we can get: α=h(q)+qh′(q) and f(α)=q[α−h(q)]+1, and the multifractal spectrum f(α)∼α can be obtained. The multifractal spectrum parameters are illustrated in Fig. 6.MESE with the advantage of high resolution and sidelobe suppression was selected to calculate the power spectral density (PSD) curve [29], defined by the Wiener–Khintchine theorem as the Fourier transform of the self-correlation function Rx(m) of the original time series:(9)sx(f)=∑m=−∞∞Rx(m)e−j2πfmTAccording to the maximum entropy principle, let ∂h/∂Rx(m)=0, |m|≥M+1, we can obtain:(10)∫−fcfce−j2πfmTS∧x(f)df=0,|m|≥M+1whereh=limm→∞(H/m+1)=limm→∞(1/2)log10det[Rx(m)]1/m+1and(1/S∧x(f))=∑n=−MMane−j2πfnT, then the self-correlation function can be expressed as follows:(11)Rx(m)=fcjπ∮zm−1∑n=−MManz−ndz,0≤m≤MAccording to the definition of PSD, the MESE-based PSD estimation is given by:(12)Sˆx(f)=PM2fc|1+∑m=1Mame−j2πmfT|2where PM=2fcσ2T, which is prediction error power. fcis band width of the signal. am, σ2 and T denote coefficients, the variance of the driving noise input and sampling period, respectively. In our study, the model order m=12 was selected based on the criterion autoregressive transfer function proposed by Parzen [30].EMD technique developed by Huang et al. [31] is an adaptive method that can break down any nonlinear or nonstationary time series such as biomedical signals into a number of amplitude and frequency modulated components each called intrinsic mode function (IMF). Unlike Fourier and wavelet-based analysis methods, EMD does not require any a priori known basis function and is widely used to analyze biomedical signals. The signal can be expressed using IMFs as follows:(13)x(i)=∑n=1Ncn(i)+rN(i)where N is the number of IMFs. cn(i) represents IMF and rN(i) is the residue after the decomposition of original signal. The algorithm flow chart of EMD is described in Fig. 7. The aim of EMD is to decompose a signal into a sum of adaptive bandwidth IMFs based on the adaptively defined basis functions with well-defined frequency localization levels. Then, we obtain the correlation between each IMF and the original signal x(i) by computing the Pearson's correlation coefficient as follows:(14)r=∑i=1n(xi−x¯)(yi−y¯)∑i=1n(xi−x¯)2⋅∑i=1n(yi−y¯)2where xiand yidenote the discrete points of the original signal x(i) and the IMF, respectively.Then, the special IMFs with a value of r more than 0.1 were selected for the calculation of adaptive sub_EF. According to Parseval theorem [32], the energy spectrum of the original signal can be computed as follows:(15)E=∫Γ|x(i)|2dt=∑i=1N|x(i)|2where N is the number of sampling points of the discrete original signal. Similarly, the energy spectrum of the selected IMF is given as:(16)E=∫Γ|c(i)|2dt=∑i=1N|c(i)|2So the calculation of adaptive sub_EF refers to:(17)sub_EF=∑i=1N|c(i)|2∑i=1N|x(i)|2In this study, we only select the first five IMFs to calculate adaptive sub_EFs.LS-SVM method firstly proposed by Suykens and Vandewalle [33] is an effective approch especially to solve the problems of prediction and classification on artificial intelligence. It solves a set of linear equations so as to avoid solving high-computational-cost quadratic programming problem [34]. By using an appropriate kernel function (KF), LS-SVM maps the input data into a high dimensional state space where an optimal separating hyperplane can separate the different classes linearly. A training set of input data{xi}i=1Nand output data{yi}i=1Nare given where xi∈ℜnand yi∈ℜ represent the ith input and output patterns. The hyperplane separating the input data in the state space can be expressed by Eq. (18)(18)ωTx+b=0The regression function can be given as(19)y(x)=ωTx+bThe output of LS-SVM is constructed so that the optimal hyperplane satisfies the following constraint.(20)ωTψ(xi)+b≥+1−ξiforyi=+1(21)ωTψ(xi)+b≤−1+ξiforyi=−1These are equivalent to(22)yi[ωTψ(xi)+b]≥1−ξi,i=1,2,…,Nwhere ψ(·) represents a function mapping the inputs into the state space, ω represents a weight vector which defines the boundary, b is a bias, ξiis the nonnegative slack variable which controls the constraint violation and makes the training error minimum.The discriminant boundary is determined by maximizing the margin among all hyperplanes, therefore the LS-SVM classifiers is defined by minimizing the following equation:(23)minω,b,ξΦ(ω,b,ξ)=12ωTω+12γ∑i=1Nξi2(24)Subjecttoyi[ωTψ(xi)+b]=1−ξi,i=1,2,…,Nwhere γ is a penalty parameter which controls the trade-off of training errors.To solve the optimization problem, the Lagrangian function has been constituted by introducing Lagrange multipliers αi(25)L(ω,b,ξ;α)=Φ(ω,b,ξ)−∑i=1Nαi{yi[ωTψ(xi)+b]−1+ξi}According to the Kuhan–Tucker conditions, we can obtain [33,35]:(26)∂L∂ω=0⇒ω=∑i=1Nαiyiψ(xi)(27)∂L∂b=0⇒∑i=1nαiyi=0(28)∂L∂ξi=0⇒αi=γξi(29)∂L∂αi=0⇒yi[ωTψ(xi)+b]−1+ξi=0i=1,2,…,NFinally, the LS-SVM classifier model is constructed by(30)y(x)=∑i=1NαiK(x,xi)+bwhere K(x, xi) is the KF. In literatures, some widely used KFs includes linear, polynomial, sigmoid and Gaussian radial basis function (GRBF). In this study, the GRBF shown in Eq. (31) as the KF of LS-SVM was employed for the intelligent diagnosis of CHF, which has been proven more effective in previous work [26].(31)K(x,xi)=exp−||x−xi||22θ2where θ is the kernel parameter that affects the structure of feature vector. In calculation, both γ and θ values were chosen empirically to achieve a satisfactory performance of the system, represented in the last column of Table 2.The statistical results of heart sound characteristics and CR indexes were expressed as mean±standard deviation. Student's t-test was implemented to analyze whether statistical differences of those exist between the control and CHF groups. A value of p less than 0.05 was considered as a statistical difference. ROC curve analysis was used to select the diagnosis thresholds for distinguishing the control from CHF groups. The area under the ROC curve (AUC) was employed as a performance measurement for the supervised classification in this study. The statistical analysis was performed by SPSS software (version 18.0) [36].

@&#CONCLUSIONS@&#
