@&#MAIN-TITLE@&#
Affine arc length polylines and curvature continuous uniform B-splines

@&#HIGHLIGHTS@&#
We study links between splines and discrete affine differential geometry.Discrete affine arc length parametrizations lead to B-splines with increased smoothness.We introduce an osculating conic of discrete curves in the plane.We show how to approximate planar curves with nearly affinely regular polylines.

@&#KEYPHRASES@&#
Discrete affine differential geometry,Quadratic B-spline,Geometric continuity,Curve approximation,

@&#ABSTRACT@&#
We study the recently introduced notion of polylines that form a discrete version of planar curves in affine arc length parametrization, showing that they match the control polylines of curvature continuous uniform quadratic B-splines (with analogous results inRn). It is demonstrated how inflection-free planar curves may be approximated by such affine arc length polylines in a way that the polyline is close to an affinely equidistant discretization of the curve and allows good approximations of the smooth affine curvature.Affine geometry is the study of geometric objects and properties that are invariant under (equi-)affine transformations. Many of the concepts from Euclidean planar curve geometry can be reproduced in an analogous way in planar affine geometry; thus we have affine arc length, affine curve normal, affine curvature, affine evolutes, affine osculating conics (analogous to the Euclidean osculating circle). Inflection-free planar curves can be parametrized by the affine arc length. This parametrization has simple expressions for the affine normal, curvature etc., as opposed to the rather unwieldy formulae in a general parametrization.There is a geometrically simple discrete analog to planar curves in affine arc length parametrization: Polylines where the area spanned by three consecutive vertices is constant, that isdet⁡(xi−xi−1,xi+1−xi)=A, or equivalently, wherexi+1−xi∥xi+2−xi−1. We term those affine arc length polylines. They were studied recently by Craizer et al. (2012). Using some of the theory contained in that work, we will extend it to include notions not studied before. These include the discrete osculating conic and the connection to curvature continuous quadratic B-splines.For most applications cubic B-splines are preferred over quadratic B-splines because they generically haveC2continuity as opposed to onlyC1, which is often not enough. For a given control polyline or data to be interpolated the smoothness of quadratic B-splines can be increased by either using non-uniform parameters or allowing non-uniform control vertex weights, which results in rational B-splines (NURBS). This involves a tradeoff, as the main advantage of using uniform B-splines lies in the algorithmic simplicity and speed of evaluation.There is, however, a different approach to constructing splines with the desired smoothness, which lies in the concept of imposing conditions on the control polyline (the data) itself. This work will show how the condition for curvature continuity (equivalent to geometricalG2continuity in the plane) is such that the control polylines coincide with the aforementioned affine arc length polylines.A frequently occurring task is the approximation of a given curve by some type of curve governed by discrete data, in our case a curvature continuous uniform quadratic B-spline. At a first glance the geometric constraints on the control polygon might be thought as being too restrictive to allow the satisfactory approximation of arbitrary curves. A simple approach will result in affine arc length polylines with strong oscillations of the discrete affine curvatures. This makes the polyline visually uneven, because the affine arc lengths of the segments of the smooth curve between two consecutive discrete polyline vertices oscillate as well. However, in Section 4 we present an algorithm which, by means of an uncomplicated iterative process, optimizes the smoothness of the discrete affine curvatures, thus yielding polylines with relatively few vertices and desirable geometric properties.Generally affine arc length polylines have higher vertex density where the (Euclidean) curvature is higher, thus offering a good compromise between simplicity (few vertices) and quality of approximation (many vertices). The advantage of smoothing the affine curvatures is that it makes the polyline locally as affinely regular as possible. This ensures that the affine arc length polyline is nearly an affinely equidistant discretization of the curve. It also provides good approximations of the smooth affine curvature of the original curve.Affine differential geometry is a classical field of study going back to the early 1900s due to the research of G. Pick, W. Blaschke, G. Thomson and others. Well-known textbooks on the subject are e.g. Blaschke (1923), Bol (1950). At that time, discretization of those smooth notions was not considered.Discrete affine differential geometry has mostly focused on surfaces inR3, in particular discrete affine minimal surfaces, which in the case of negative curvature can described by A-nets with an added geometric constraint (Craizer et al., 2010; Käferböck and Pottmann, 2013). Using those nets as control nets of bilinear B-spline surfaces yields geometrically smooth surfaces. Thus the principle of imposing geometric conditions on the discrete data in order to make the resulting B-spline object (curve resp. surface) geometrically smoother that it would generically be is the same as in this paper.The recent work (Craizer et al., 2012) studied the same model of discrete curves in affine arc length parametrization (called equal area polygons) as we have undertaken, focusing on the notion of the discrete affine evolute. They also proved a discrete version of the well-known classical six-sextactic-point theorem, which is the affine version of the four-vertex theorem. Affine osculating conics were not considered, and neither was the connection to curvature continuous quadratic B-splines.Splines with higher smoothness thanC1, in particular curvature continuity were studied extensively in classical B-spline literature (geometric splines, ν-splines, uniform cubic B-splines), see e.g. Boehm (1985), Dyn and Micchelli (1988). For example, Hagen (1986) stated the general conditions for the curvature continuous joining of Bézier curve segments. The majority of these works did not look at quadratic splines in particular, and most assumed adegree≥3.However, there is also a number of works wereG2quadratic spline interpolation was studied explicitly, like Schaback (1989). The splines in that paper allow a representation as non-uniform B-splines, where the non-uniformity is necessary in order to do without geometric constraints on the control polygon (apart from the obvious one of convexity).Although the equal-area condition forG2continuity of uniform quadratic B-splines clearly was realized in the literature, its interpretation in terms of discrete affine differential geometry provides new insights into its geometric meaning.1.Section 2 introduces a way of describing polylines in an affine-invariant way and uses that notation to describe affine arc length polylines, which can be seen as discrete affine arc length parametrized curves. Building upon the work done by Craizer et al. (2012) on the discrete affine evolute, we study discretizations of conics and introduce the notion of the discrete osculating conic.Finally we show the connection between affine arc length polylines andG2continuous uniform quadratic B-splines.Section 3 generalizes some of the results of the previous section to curves inRnand uniform B-splines of order n.In Section 4 it is shown how inflection-free planar curves can be approximated by discrete affine arc length polylines such that the affine arc length polyline is close to an affinely equidistant discretization of the original curve. Those approximations have desirable geometric qualities, as the vertex density of the polyline is higher where the Euclidean curvature is higher and the polyline is locally as near affinely regular as possible. They also allow good approximations of the affine smooth affine curvature.There are several geometries that are commonly termed affine geometry. The one we will be using is (planar) equiaffine geometry, that is the study of geometric notions that are invariant under the group of equiaffine transformations (also called the special affine group) of the plane which comprises the transformationsx↦Mx+v,M∈R2×2withdet⁡M=1,v∈R2.Generally the invariant geometric properties of equiaffine geometry are parallelity, ratios of parallel lengths and areas.On the other hand, general affine geometry allows all transformationsx↦Mx+vwithdet⁡M≠0. In this paper affine will always refer to equiaffine geometry, because it is the main object of study. General affine geometry will always be referred to as such.The affine polyline coordinates introduced below belong to equiaffine geometry, but the notion of the affine arc length polyline as well as its affine curvature, osculating conics and the algorithm for approximating curves by affine arc length polylines in Section 4 are fully invariant under the general affine group, thus being objects of general affine geometry.Letxi∈R2,i=0,…,Nbe a polyline. We will use the forward difference operator frequently, defined asδαi=αi+1−αifor any sequence α. We also writevi:=δxi=xi+1−xias an abbreviation. Then we define affine polyline coordinatesAi,Biby(1)Ai=det⁡(vi−1,vi)andBi=det⁡(vi−1,vi+1).They are illustrated in Fig. 1.AiandBiare invariant under equiaffine transformations, and they associate2(N+1)−5numbers with the polyline consisting ofN+1vertices, which describe the polyline uniquely up to equiaffine transformations:x0andx1can be freely chosen, andx2has one degree of freedom left under the conditiondet⁡(x1−x0,x2−x1)=A1. After that, the rest of the polyline can be constructed uniquely by way of the equation(2)Bivi=Ai+1vi−1+Aivi+1,as long asBi≠0. This formula can be easily verified byBidet⁡(vi,vi+1)=Ai+1det⁡(vi−1,vi+1)+Ai⋅0andBidet⁡(vi,vi−1)=Ai+1⋅0+Aidet⁡(vi+1,vi−1). The 5 degrees of freedom in choosingx0,x1,x2correspond to the 5 degrees of freedom of the equiaffine group.The affine arc length of a curvef:R→R2is defined (e.g. in Blaschke, 1923, §4) ass(t)=∫0tdet⁡(f˙(t˜)f¨(t˜))13dt˜.Therefore noninflecting curves possess a parametrization with respect to the affine arc length.Using affine polyline coordinates this definition can be discretized to define the affine length of a polyline in an obvious way:(3)L2(x0,…,xN):=∑i=1N−1Ai13.Lengths are therefore carried by triples of consecutive polyline verticesxi−1,xi,xi+1. A polyline can be said to be in discrete affine arc length parametrization if all lengths are the same, that isA:=Ai=const.≠0. We call such a polyline an affine arc length polyline. See Fig. 2for an example. AsAiis the area of the parallelogram spanned byxi−1,xi,xi+1, Craizer et al. (2012) (who only considered closed curves) called them equal-area polygons. Throughout the paper we will assumeA>0, meaning we are restricted to polylines that are noninflecting in a discrete sense. However, in Section 4.4 we demonstrate how several affine arc length polylines may be concatenated to discretize curves with inflection points.The affine curvature is defined by the equationf‴+κf′=0, or equivalently byκ:=det⁡(f″,f‴), wheref″is the affine curve normal (Blaschke, 1923). Analogously to the Euclidean case the envelope of the normal linesf(t)+λf(t)″is called the affine evolute.In the discrete setting of affine arc length polylines the affine normal lines arexi+λniwithni:=δ2xi−1=xi−1−2xi+xi+1and the vertices of the (discrete) affine evolute result as intersection points of consecutive affine normal lines, as shown in Fig. 3. One can now define the affine curvaturekiof an affine arc length polylinexi−1,…,xi+2by straightforward discretization throughδ3xi−1+kiδxi=0. Useful equivalent characterizations are(4)xi+2−xi−1=(3−ki)(xi+1−xi),orki=det⁡(ni,ni+1)A,orki=2−BiA.From this it is easy to see that the affine evoluteξiof an affine arc length polyline can be expressed by(5)ξi=xi+1kini=xi+1+1kini+1.The discrete affine evolute was studied extensively by Craizer et al. (2012). We will focus on the notion of the osculating conic (Section 2.4).Affinely regular polylines were introduced by Coxeter (1969) as the orbits of equiaffine transformations. In particular they arise as equidistant discretizations of conics in affine arc length parametrization. Craizer et al. (2012) show how an affine arc length polyline is affinely regular if and only if its affine evolute is a single point. Due to Eq. (5) that is equivalent tokibeing constant.This is the discrete analog to the well-known result from classical affine differential geometry, that a planar curve with constant affine curvature is a conic, see e.g. Blaschke (1923).That result can be somewhat generalized:Theorem 1An affine arc length polylinexidiscretizes a conic if and only if the sequence of its affine curvatures alternates between two constant values, that is,ki−1=ki+1∀i. (For an example seeFig. 5.)ProofWe need to show that 6 consecutive verticesxi−2,…,xi+3of an affine arc length polyline lie on a conic if and only ifki−1=ki+1.We lay the unique conic throughxi−2,…,xi+2and apply an equiaffine transformation such that the x-axis is a symmetry axis of the conic and the symmetry mapsxi↔xi+1. See Fig. 4.The affine arc length polyline propertyAi=Ai+1implies that alsoxi−1↔xi+2. Then the linexi−2xi+1(which is parallel toxi−1xi) is symmetric to the line throughxiparallel toxi+1xi+2, on whichxi+3must lie. Then due to Eq. (4),ki−1=ki+1⇔‖xi+3−xi‖=(3−ki+1)‖xi+2−xi+1‖=(3−ki−1)‖xi−1−xi‖=‖xi−2−xi+1‖⇔the symmetry mapsxi−2↔xi+3⇔xi+3lies on the conic throughxi−2,…,xi+2⇔xi−2,…,xi+3lie on a conic.  □In planar affine differential geometry the affine evolute point is also the center of a unique conic which has 5-point (4th order) contact with the curve, called the osculating conic. Forκ=0the affine evolute point is ideal and the osculating conic a parabola.Because ofxi+1−xi∥xi+2−xi−1the set of the centers of all conics that containxi−1,…,xi+2is the line through(xi+xi+1)/2and(xi−1+xi+2)/2(including the ideal point), which passes through the affine evolute point. Thus we can define a unique conic throughxi−1,…,xi+2with the affine evolute point as its center, which we call the outer osculating conic.Another way of defining a discrete osculating conic (again withξias center point) is to make the three edges involved (xi−1xi,xixi+1andxi+1xi+2) tangents of the conic. This can be termed the inner osculating conic. Both conics are displayed in Fig. 6.Just like in the classical smooth setting, we can infer the type of the conic from the sign of the affine curvature:(6)The inner and outer osculating conics are{hyperbolasparabolasellipses⇔{ki<0ki=0ki>0.Both choices of discrete osculating conics, however, are not ideal when one considers the (constant) affine curvatures of those conics as planar curves. The rationale of an osculating conic is that its affine curvature matches that of the given curve at the point of osculation. This is not the case with either of the conics defined above, but a better solution suggests itself:Theorem 2For an affine arc length polyline we define three types of osculating conics ofxi−1,…,xi+2:osculating conicdefinitionaffine curvatureoutercenterξi, throughxi−1,…,xi+2κioinnercenterξi, tangential toxi−1xi,xixi+1andxi+1xi+2κiimiddlecenterξi, geometric mean of inner and outer conicκimThen the inner and outer osculating conic are related by uniform scaling around the center (or a translation in the caseki=0), which allows us to define the middle osculating conic as their geometric mean.κio,κii,κimare the conics' classical smooth affine curvatures (see Section2.3), which are constants for each conic. Then they have the following values:(7)κio=A−23ki(1−ki4)13κii=A−23ki(1−ki4)−13κim=A−23ki.ProofDepending on the sign ofki, every polylinexi−1,…,xi+2can be brought into one of the formshyperbolaparabolaellipsexi=r(cosh⁡λi−sinh⁡λi)xi=(iλi2)xi=r(cos⁡λisin⁡λi)A=−2r2sinh⁡λ(1−cosh⁡λ)A=2λA=2r2sin⁡λ(1−cos⁡λ)ki=2(1−cosh⁡λ)<0ki=0ki=2(1−cos⁡λ)>0withr,λ>0by an equiaffine transformation. The points of contact of the polyline edges with the inner osculating conic are the polyline edge midpoints12(xi−1+xi), etc. for reasons of symmetry.If we consider the elliptic case, in the special form from the table above the osculating conics are circles with center at 0. The outer conic has radius r. The inner conic's radius is‖(xi+xi+1)/2‖=rcos⁡λ2=r(1+cos⁡λ)/2=1−ki/4(with the value ofkifrom the table). This gives us a scaling factor1−ki/4between the outer and inner osculating conic. In the hyperbolic case we analogously find the same factor. The scaling factor “inner:middle:outerosculating conic” is therefore(1−ki4)1/4(ki≠0). In the caseki=0symmetry shows that the inner osculating conic is also an x-symmetric parabola, and inserting the edge midpoints proves that it has the form(i,λi2+λ/4)T. It is therefore related to the outer osculating conic by translation with vector(0,A/8)T. Thus they have the same smooth affine curvature.Keeping in mind that the (constant) smooth affine curvatures for hyperbola, parabola and ellipse are−r−43, 0 andr−43, respectively, the desired results follow from straightforward calculation.  □Trying to connect planar affine geometry with the theory of B-splines the obvious choice is to look at quadratic B-splines, because they consist of parabolae which have vanishing curvature from the point of view of affine geometry.So we will take a polylinex0,…,xNto be the control polyline of a uniform quadratic B-spline. The algorithm of Chaikin (1974) is the version of the Lane–Riesenfeld subdivision algorithm (Lane and Riesenfeld, 1980) that goes with quadratic B-splines. It replaces the polyline withx14,x34,…,xN−14, wherexi±14:=34xi+14xi±1. Now it is easy to see (Fig. 7) that the Chaikin algorithm does not change the affine arc length of the polyline:L2(x0,…,xN)=L2(x14,…,xN−14)In addition an affine arc length polyline will maintain that property under subdivision, where the new constantA′has the valueA′=18A.In fact we find that affine arc length polylines have a distinguished role in the context of uniform quadratic B-splines. The two consecutive parabola segments of the B-spline with control polylinex0,…,x3are parametrized byp1(t)=x1−(1−t)22v0+t22v1andp2(t)=x2−(1−t)22v1+t22v2(with0≤t≤1each). Calculating their (Euclidean) curvatures at the intersection point we findκ1(1)=κ2(0)⇔A1‖v1‖−3=A2‖v1‖−3⇔A1=A2. Thus we see that a uniform quadratic B-spline is curvature continuous if and only if its control polyline is an affine arc length polyline.Affine differential geometry differs from its Euclidean counterpart by the fact that the notion of the affine arc length of a curve is explicitly dependent on the dimension of the containing space.As in the planar case, we use as affine equivalence transformations those linear maps which leave n-dimensional volumes constant, that is, those maps of the formx↦Mx+vwithdet⁡(M)=1,v∈Rn. Thus the obvious way of defining an affinely-invariant arc length element is to use a determinant of derivatives of the curve f, which isdet⁡(f˙,f¨,…,f(n))inRn. To make this term invariant under changes of variables, however, it is necessary to add a suitable exponent (1/3 in the planar case). Thus one gets for the affine arc length in n dimensionss(t)=∫det⁡(f˙(t),…,f(n)(t))2n(n+1)dt.Therefore affine arc length parametrization hass=t⇒det⁡(f˙,f¨,…,f(n))≡1. Allowing (as in the planar case) any constant value ≠0 instead of 1, we now defineDefinition 3A polylinex0,…,xN∈Rnconsists ofN−n+1discrete affine length elements, which are the subpolylinesxi,…,xi+n, which have the affine lengths(8)Ln(xi,…,xi+n)=det⁡(δxi,…,δxi+n−1)2n(n+1),in particularL2(xi−1,xi,xi+1)=Ai1/3. The polyline is called an affine arc length polyline iff all values ofLnare the same ≠0, that is(9)∃A≠0:det⁡(δxi,…,δxi+n−1)=A∀i.In the plane it was advantageous to use affine arc length polylines as control polylines of uniform quadratic B-splines; inRnthat role is played by uniform B-splines of degree n:Theorem 4Affine arc length polylines are exactly those polylinesxi∈Rnwhich when taken as control polylines of uniform B-spline curves of degree n result in all Frenet curvaturesk1,…,kn−1being continuous at the transitions of the B-spline segments.ProofThe B-spline basis functionsBjk(t)for equidistant knotstj=jare recursively defined byBjk(t)=t−jkBjk−1(t)+j+k+1−tkBj+1k−1(t)andBj0(t)={1,t∈[j,j+1)0,elseand form the B-spline curvef(t)=∑i=0NBin(t)xiwith control pointsxi(see e.g. Cohen et al., 2001). As B-spline curves are translation invariant, in the usable regiont∈[n,N−n]the basis functions form a partition of unity.The curvaturesk1,…,kn−2of f are continuous because they only depend on the firstn−1derivatives of f and the basis functionsBinareCn−1. The curvaturekn−1(called the torsion τ inR3) is calculated in Aminov (2000) to bekn−1=det⁡(f˙,…,f(n))⋅|[f˙,…,f(n−2)]|‖f˙‖⋅|[f˙,…,f(n−1)]|2,where[a0,…,ak]denotes the multivector spanned bya0,…,ak, whose length is equal to the k-dimensional volume of the parallelotope spanned bya0,…,ak. The only term in the formula which has to be tested for continuity is the determinant, as it is the only one which containsf(n). Using derivatives of the first B-spline segment we getf(k)(t)=∑i=0n−kBi+kn−k(t)δkxiforn≤t≤n+1.Using the calculus of multivectors we can now employ induction for k starting fromk=n+1down to 1.[f(k)(t),f(k+1)(t),…,f(n)(t)]=[f(k)(t),δk+1x0,…,δk+1xn−k−1]=∑i=0n−kBi+kn−k(t)[δkxi,δk+1x0,…,δk+1xn−k−1]=∑i=0n−kBi+kn−k(t)(−1)i[δkx1−δkx0,…,δkxi−δkxi−1,δkxi,δkxi+1−δkxi,…,δkxn−k−δkxn−k−1]=∑i=0n−kBi+kn−k(t)(−1)i[−δkx0,…,−δkxi−1,δkxi,δkxi+1,…,δkxn−k]=∑i=0n−kBi+kn−k(t)[δkx0,…,δkxn−k]=[δkx0,…,δkxn−k].With e.g. Sternberg (1964, p. 16) andk=1we then seedet⁡(f˙(t),…,f(n)(t))⋅[e1,…,en]=[f˙(t),…,f(n)(t)]=[δx0,…,δxn−1]=det⁡(δx0,…,δxn−1)⋅[e1,…,en]for alln≤t≤n+1. Therefore the determinant is continuous over segment transitions (even constant) if and only if the control polylinexifulfills Eq. (9).  □In addition, we saw in Section 2.5 that if we subdivide a general planar polylinex0,…,xNby the Chaikin algorithm to a polylinex0′,…,x2N−1′, the overall affine length will stay the same:∑i=1N−1Ai1/3=∑i=12N−2Ai′1/3. We now find that the same holds true inRnif we use the Lane–Riesenfeld algorithm of degree n, as is appropriate for B-Splines of degree n.Theorem 5Letx0,…,xNbe the vertices of the polylinexinRn. Letμx:=(x0+x12,…,xN−1+xN2)denote the averaging operator for finite sequences andδx:=(x1−x0,…,xN−xN−1)the forward difference operator. The Lane–Riesenfeld refinement of degree n (Lane and Riesenfeld, 1980) ofxproduces a polylinex′, which is described byx′=(x0′,…,xN+1′):=μn(x0,x0,x1,x1,…,xN,xN).Then the discrete affine arc lengths (as defined by Eq.(8)) ofx′are(10)Ln(x0′,…,xn′)=Ln(x1′,…,xn+1′)=12Ln(x0,…,xn).Letv=(v0,…,v2n):=(0,x1−x0,0,x2−x1,…,0,xn−xn−1,0)and thusδx′=μnv. We also note that(δμv)2i=12(v2i+2−v2i)=0, from which(δmμmv)2i=0,m≥0follows by iteration, as the operators δ and μ commute.We will use induction for k to show(11)[(μkv)j,(μkv)j+1,…,(μkv)j+(k−1)]=2−k(k+1)2[vj+1,vj+3,…,vj+2k−1]fork≤nandj=0,2,…,2(n−k). Fork=1the statement is true, becausevj=0for even j. Assume therefore that it holds for somek<n, and pass tok+1.As an abbreviation we introduce the sequencew=(w0,…,wn):=μkv.[(μk+1v)j,(μk+1v)j+1,…,(μk+1v)j+k]=2−(k+1)[wj+wj+1,…,wj+k+wj+k+1]=2−(k+1)[∑i=0k((wj+i+wj+i+1)(−1)i∑l=0i(kl)),wj+1+wj+2,…,wj+k+wj+k+1]=2−(k+1)[∑i=0k(−1)i(ki)wj+i︸=(−1)kδkwj=0+(−2)kwj+k+1,wj+1+wj+2,…,wj+k+wj+k+1]=2−1[wj+1,wj+2,…,wj+k+1]=↑Eq. (11) withj+2in place ofj2−1−k(k+1)2[wj+1,vj+3,vj+5,…,vj+2k+1]=2−(k+1)(k+2)2[vj+1,vj+3,…,vj+2k+1].To complete the proof we letk=nin (11) to see[(δx′)0,…,(δx′)n]=2−n(n+1)/2[(δx)0,…,(δx)n], which is the proposition according to Definition 3. The length of(x1′,…,xn+1′)is the same, as can be seen by reversing the ordering of the vertices.  □We now want to study the problem of approximating an inflection-free planar curve f by an affine arc length polyline x such thatxi=f(ti). LetSi:=∫titi+1det⁡(f˙(t),f¨(t))1/3dtbe the affine arc length fromxitoxi−1. Curves with inflection points can be treated by allowing a jump of the affine arc length constant A at each inflection point (including a sign change). See Section 4.4 for a demonstration of that approach.A simple approach to the problem of discretizing a given inflection-free planar curve calls for the choice of two initial pointsx0andx1on the curve. With a likewise fixed value A the method proceeds by imposingdet⁡(xi+1−xi,xi+2−xi+1)=A, thus findingxi+2at the intersection of the curve with a line parallel toxi+1−xi. This is the path taken in Craizer et al. (2012).Fig. 5demonstrates this procedure for different values oft1but identical A in discretizing a conic. All of these discretizations have the sequence of discrete affine curvatureskialternate between two constant values (see Theorem 1), except for the one with constantki, which is affinely regular. Clearly this discretization is the most desirable one, because it hasSi=const., making it an affinely equidistant discretization of the conic.For a generic curve f discretizations by affine arc length polylines cannot be affinely equidistant, but we will try to make the differencesSi+1−Sias small as possible. The path we will be taking to achieve this is to minimize∑i(δki)2. It is motivated by the following theorem:Theorem 6Consider the affine arc length polylinexi=f(ti), withSibeing the affine arc length fromxitoxi+1. Then ifSiis sufficiently small(Si+1−Si)/Siis a monotonous function ofδki. In particular asymptotically forSi→0the function(Si+1−Si)/Siattains 0 atδki=0.ProofWe consider a quintuple of an affine arc length polyline with vertices lying on f such that(t−2,t−1,t0,t1,t2):=(−t(2+z(t)),−t,0,t(1+w(t)),t(2+y(t)))Assume f is parametrized by the affine arc length and letxi:=f(ti),i=−2,…,2. ThenSi=ti+1−ti. We calculate Taylor polynomials of the discrete polyline coordinates (Section 2.1) by using the following tabledet⁡(.,.)f0′f0″f0‴f0(4)f0(5)f0′010−κ0−2κ0′f0″−10κ0κ0′f0‴0−κ00f0(4)κ0−κ0′f0(5)2κ0′wheref0(j):=f(j)(0),κ0:=κ(0)etc.We know that in the Taylor series ofxiderivativesf0(j)only appear in terms where the exponent of t is ≥j, andδxi=O(t). Therefore the remainder of the Taylor series ofAi(t)=det⁡(δxi−1,δxi)which is not calculable from the table, coming from sums of determinantsdet⁡(f0(j),f0(k)),j+k≥7, isO(t7). This means that we can calculate the coefficients ofAi(t)=Ai,3t3+Ai,4t4+Ai,5t5+Ai,6t6+O(t7). For instanceA−1(t)=t32+3z0+z022+t43+2z02z0′+t5(−κ06+15z0+14z02+6z03+z0424+12(z0′)2+3+2z04z0″)+t6(κ0′60+176z0+205z02+120z03+35z04+4z05240−κ0z0′15+28z0+18z02+4z0324+12z0′z0″+3+2z012z0‴)+O(t7).Now we demand thatx−2,…,x2is an affine arc length polyline⇔A−1(t)=A0(t)=A1(t). Equating coefficients of those conditions yields equations in the Taylor coefficients ofw(t),y(t),z(t). E.g.A−1,3=A0,3⇒z0=w0orz0=−3−w0. The second solution is excluded because it impliesx−2=x1. Under the assumptionz0=w0the equationA−1,4=A0,4results inz0′=w0′. Proceeding like this to consecutively solve the eight equationsA−1,j=A0,j=A1,j,j=3,4,5,6we findA−1(t)=A0(t)⇒w(t)−z(t)=2+w060(1+w0)(5+6w0+2w02)κ0′t3+O(t4)A0(t)=A1(t)⇒y(t)−w(t)=2+w060(5+4w0+w02)κ0′t3+O(t4)Now we can do the analogous calculation for the equation of constant discrete affine curvature,k−1=k0⇔B−1(t)=B0(t), inserting the results from above forz(t)andy(t)to getdet⁡(δx−2,δx0)=det⁡(δx−1,δx1)⇒w(t)=−κ0′6t3+O(t4)and thusS0−S−1=−κ0′6t4+O(t5). If the discrete affine curvature is not constant, we use the equationB0−B−1+A0δk−1=0(see (4)) to obtainS0=t(δk−1+16+(δk−1)2)/4+t3κ0α(δk−1)−t4κ0′6β(δk−1)+O(t5).Here α and β are abbreviations for differentiable terms inδk−1withα(0)=0andβ(0)=1, whose exact forms are not necessary to know. For slightly simpler notation we may define ϕ byδk−1=4sinh⁡(ϕ), then we equivalently get(12)S0=teϕ+t3κ0α˜(ϕ)−t4κ0′6β˜(ϕ)+O(t5),whereα˜(0)=0andβ˜(0)=1likeα,βabove. Thus the relative change of the affine arc lengths is(13)S0−S−1S−1≈eϕ−1forSi→0.□This shows that minimizing the(δkj)2is effective in order to make an affine arc length polyline a near affine equidistant discretization of f. In fact it turns out that the(δkj)2are a very sensitive measure for the non-constantness of theSi: Ifx0=f(0)andx1=f(t1), even a small deviation oft1from the optimum value ((S1−S0)/S0≪1%) will cause strong oscillations inki, and thus large values of(δkj)2, as evidenced by Fig. 11. We find the optimal value oft1by minimizing∑(δkj)2. This optimization process, as well as the initial value fort1is discussed in detail in Section 4.2.Another way of characterizing the optimal affine arc length polyline in our problem is to define them it be (locally) “as affinely regular as possible”. By this we mean that locally its deviation from an affinely regular polyline is as small as possible.To justify this we will denote the sector areas with respect to the discrete affine evolute pointξiofxi−1,…,xi+2byAj, as shown in Fig. 8. The polylinexi−1,…,xi+2is affinely regular with respect toξi, and so we haveA−1=A0=A1. Calculating the areas of the next triangles outside those three we get the relative changesA−2−A0A0=ki−ki−1andA2−A0A0=ki−ki+1.Thus forxi−2,…,xi+3to be near affinely regular we wantki−ki−1andki+1−kias near zero as possible. So finally we can state our problem clearly:We wish to discretize f by an affine arc length polylinexisuch that equivalently(14)xidiscretizesfin a nearlyaffinely equidistant way⇔xiis locally nearaffinely regular⇔∑i(δki)2=minThe method we will be using to minimize the(δki)2is a simple iterative algorithm called golden section search. It is explained in detail in Section 4.2.It turns out that if we approximate the curve f by an affine arc length polyline with minimal∑i(ki+1−ki)2, the affine curvatures of the middle osculating conicsκim=kiA−23form good approximations of the smooth affine curvature of f. See Figs. 11 and 13 as well as Table 1for examples. For non-optimal choices oft1this approximation is destroyed by the strong oscillations ofki.As mentioned in the previous section, the construction of an affine arc length polylinex0,…,xnwithxi=f(ti)calls for frequent calculation of intersection points of the given curve f and straight lines; it needs to be performed for every vertexxiin every optimization step. This can be nontrivial and thus time-consuming. Therefore it is proposed here to preprocess f, replacing it by a curvef˜which is a very close approximation of f, and whose structure makes those intersection operations easy.This can be achieved by obtaining a fine samplingpj,j=0,…,Nof f and interpolating this polyline by parabolic arcs. It is appropriate to construct those arcs in an affine-invariant way: Make the tangent direction of the arc frompjtopj+1inpjto bepj+1−pj−1and inpj+1to bepj+2−pj. It is illustrated in Fig. 9. We will always assume thatf˜:[0,N]→R2is parametrized in such a way thatf˜(j)=pj(which lies on f). Thus forf˜(t)the integral part of t specifies the parabolic arc this point is on, and the fractional part the position on that arc.It is important to note that p is not an affine arc length polyline, because it does not have curvature continuity. It is only a tool to facilitate the construction of the affine arc length polyline x.It turns out that the density (number of vertices) of the polyline p strongly affects the quality of the end result x: it must be sufficiently high. We suggest|p|≈20⋅|x|. In the example below we aimed to approximate f by an affine arc length polyline x with 60 vertices, so we replaced f by a curve made from 1000 parabolic segments. See Table 1 for details.While it is also possible to replace f with a piecewise linear curve instead of a piecewise quadratic one, due to the lower approximation quality the vertex count of p must be much higher to enable the same smoothness of the final affine arc length polyline x.After choosing a first vertex onf˜, e.g.x0:=f˜(0), we need an initial valuet1,x1:=f˜(t1)to start the optimization. We do this by calculating the exact affine arc length of the replacement curvef˜, which is easy (and another advantage of a piecewise parabolic replacement of f). If we take the affine polyline coordinates ofpjto beAj⁎andBj⁎, then the segment frompjtopj+1has the affine arc length(15)Sj:=(4Aj⁎Aj+1⁎Aj⁎+Bj⁎+Aj+1⁎)1/3.The total length off˜isS:=∑j=0N−1Sj. If we want to approximate the curve by the affine arc length polylinex0,…,xnit is a good choice to useA:=(S/n)3. As initial value fort1we want to placex1=f˜(t1)such that the affine arc length fromx0tox1is roughly1/nof the total affine arc length. For simplicity we initializet1with an integral value:t1such that∑j=0t1−1Sj≈S/n.From this the rest of the affine arc length polylinex0,…,xncan be constructed easily as described in Section 4.Now we want to perform optimization ont1in order to minimize the error functionψ(t1):=∑i(ki+1−ki)2, keepingx0and A fixed. The error function is unimodal with respect tot1. Therefore we can use the iterative method called golden section search (see (Kiefer, 1953)). This method is a variant of ternary search which finds a minimum of a unimodal function of one variable in an interval. As initial interval we can use e.g.[0,2t1]=:[a,d]. It is split into three parts with length ratiosϕ:1:ϕ, where ϕ is the golden section. This gives us four pointsa<b<c<d. Now the function ψ to be minimized is evaluated at the middle points b and c. Ifψ(b)<ψ(c)the minimum cannot lie in the right interval(c,d], which is discarded. The remaining interval[a,c]is once again subdivided into 3 intervals with the length ratiosϕ:1:ϕ. Here the properties of the golden section guarantee that ϕ needs only be evaluated one more time to achieve this:(a,b,c,d)↦(a,a+c−b,b,c). Ifψ(b)≥ψ(c), the left interval is the one discarded. Every iteration decreases the total interval size by a factor ofϕ−1≈0.618until the interval is judged small enough. In the end we simply sett1:=12(b+c). Examples below were created in that way.Below is the summary of the proposed method of approximating a noninflecting planar curve f with an affine arc length polylinex0,…,xn.1.Preprocessing: Replace f by a piecewise parabolic curvef˜, to facilitate the constructions in the following steps.f˜:[0,N]→R2,f˜(j)=pj, wherepjlies on f; the tangent directions off˜(j)are chosen as shown in Fig. 9. It is important that the number of parabolic segments is sufficiently high, to make the replacement curvef˜a good approximation of f.IfSjis the affine length of the parabolic segment off˜frompjtopj+1(as given by Eq. (15)), the total affine length off˜isS:=∑j=0N−1Sj. Letx0:=f˜(0). We sett1to an initial integral value such that∑j=0t1−1Sjis as close toS/nas possible. Thusx1:=f˜(t1)=pt1.The affine arc length polylinex0,…,xncan now be constructed uniquely fromx0,x1and the constant A, which we set to the valueA:=(S/n)3. The construction consecutively findsxiat the intersection of the curvef˜and the straight line of all points z withdet⁡(xi−1−xi−2,z−xi−1)=A. The affine arc length polyline determines the affine curvaturesk1,…,kn−2.Golden section search is performed to find the optimal valuet1which minimizesψ(t1):=∑i(ki+1−ki)2. The affine arc length polyline is constructed anew fromx0, A and the updatedt1to get the new value ofψ(t1)in every optimization step. The optimization terminates after a fixed number of iterations.As an example we take f to be a Bézier curve of degree 8, to be approximated by an affine arc length polyline with 60 vertices. Fig. 11and Table 1 compare the affine curvatures of the middle osculating conicskiA−2/3with the exact affine curvatures of the original Bézier curve at that point,κ((ti−1+ti+ti+1+ti+2)/4).Curves with inflection points do not have an affine arc length parametrization in the classical sense and can therefore not be represented by affine arc length polylines. It is however possible to split them at the inflection points and treat the segments separately, with visually pleasing results. Below is a description of the procedure.Assume that we want to approximate a curvef(t),0≤t≤1which has k inflection points by a polylinexicontainingn+1vertices.1.Identify the inflection pointsf˜(si),0<s1<…<sk<Nof the piecewise parabolic replacement curvef˜. This is easy, assi∈Z.Letx0:=f˜(0)andn0:=0. We want to place vertexxniclose to the i-th inflection point for eachi≥1. To find a good choice for the indicesniwe calculateS˜i:=∫0si|det⁡(f˜˙,f˜¨)|1/3dt,S˜:=∫0N|det⁡(f˜˙,f˜¨)|1/3dtand then choose thenias to fulfillS˜1:S˜2:…:S˜k:S˜≈n1:n2:…:nk:nas closely as possible.Now we consecutively construct the sub-polylinesxni−1,…,xn1, constructingxni−1+1,…,xnifor the already fixedxni−1andA:=(S˜i−S˜i−1)/(ni−ni−1). For the smoothing optimization in this step it is advisable to disregard a few vertices that are closest to the inflection points. The sub-polylinexni−1,…,xn1determines the affine curvatureskni−1+1,…,kni−2. Therefore, if we skip l vertices at each end of the sub-polyline this means that we will minimize∑j=ni−1+1+lni−3−l(kj+1−kj)2, for e.g.l=2.This may be redone with adjusted value for A if the resultingxniis too far from the inflection point, but an exact coincidence is not necessary.An example of this situation is shown in Figs. 12 and 13.We have shown that the theory of affine arc length polylines, the discretization of curves in affine arc length parametrization, can be extended beyond the previous work by Craizer et al. (2012). In particular we defined discrete osculating conics. In addition we showed how affine arc length polylines equivalently arise as control polygons of curvature continuous uniform quadratic B-splines. Some of our results were shown to also hold inRnfor uniform B-splines of degree n. Finally, we presented an algorithm for the approximation of inflection-free planar curves by affine arc length polylines in a way that the smoothness of the discrete affine curvature was optimized, making it a good approximation of the smooth affine curvature of the original curve. This demonstrates how the added geometric constraints on the discrete data pose no obstacle to the practical problem of approximating an arbitrary given curve.There are several directions for future research that look promising. One possibility is to try to extend discrete affine curve geometry inR3andRn. Another idea is to further study the concept of imposing geometric constraints on discrete data in order to make piecewise smooth objects deriving from it (geometrically) smoother than in the generic case. In particular, we need to see whether the notion affine arc length polylines can be transferred into the theory of surfaces inR3.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
