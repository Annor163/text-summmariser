@&#MAIN-TITLE@&#
Automatic 3D model-based method for liver segmentation in MRI based on active contours and total variation minimization

@&#HIGHLIGHTS@&#
Automatic and accurate 3D active contour method for MRI liver segmentation.New approach to enhance the contrast in the input MRI image.The proposed methodology replaces the input image by a model based probability map.The minimization of this model is achieved by means of dual approach of Chambolle.Validation of the performance of the method with well-established quality metrics.

@&#KEYPHRASES@&#


@&#ABSTRACT@&#
Liver cancer is one of the leading causes of cancer-related mortality worldwide. Non-invasive techniques of medical imaging such as Computerized Tomography (CT) and Magnetic Resonance Imaging (MRI) are often used by radiologists for diagnosis and surgery planning. With the aim of assuring the most reliable intervention planning to surgeons, new accurate methods and tools must be provided to locate and segment the regions of interest. Automated liver segmentation is a challenging problem for which promising results have been achieved mostly for CT. However, MRI is required by radiologists, since it offers better information for diagnosis purposes. MRI liver segmentation represents a challenge due to the presence of characteristic artifacts, such as partial volumes, noise, low contrast and poorly defined edges of the liver in relation to adjacent organs. In this paper, we present a method for MRI automatic 3D liver segmentation by means of an active contour model extended to 3D and minimized by total variation dual approach that has also been extended to 3D. A new approach to enhance the contrast in the input MRI image is proposed and it allows more accurate segmentation. The proposed methodology allows replacing the input image by a probability map obtained by means of a previously generated statistical model of the liver. An Accuracy of 98.89 and Dice Similarity Coefficient of 90.19 are in line with other state-of-the-art methodologies.

@&#INTRODUCTION@&#
Liver cancer is one of the leading causes of cancer-related mortality worldwide. Diagnostic confirmation is performed by percutaneous or surgical biopsies although currently these invasive techniques can be partially replaced by medical imaging techniques such as Computerized Tomography (CT) and Magnetic Resonance Imaging (MRI), with obvious benefits for the patient. For this reason, it becomes of key importance to provide radiologists with new methods and tools for medical image understanding capable of segmenting properly the organ of interest and the pathologies present inside [1–4].In the literature of liver segmentation, several approaches for image processing and segmentation can be found mainly over CT images. However, MRI is required by radiologists, since MRI images can provide richer information for diagnosis purposes. Automatic liver segmentation in MRI is a challenging problem due to some artifacts and characteristics of the images, such as noise, the low contrast of the liver in relation with adjacent tissues or partial volume effect [5]. Delimitation of border is often confusing. Robust methods capable of dealing with these problems are needed.Regarding recent state-of-the-art methodologies for liver segmentation on MRI images, some of them are semiautomatic [6,7] and thus requiring interaction from the user. In recent works for automatic liver segmentation mainly deformable models based on different approaches over active contours are developed. Deformable models are capable of segmenting elements with complex topological shapes. Reska et al. propose in [8] a 3D active isosurface method aiming to locate the liver in MRI images. Yuan et al. developed in [9] a liver segmentation method over MRI images based on fast marching methods. These methods provide reasonable results whenever images present good contrast among organs, but active contours can get stuck on local minima if the minimization process does not manage to converge to a global solution.Other works in state-of-the-art apply artificial neural networks to extract the liver volume from the MRI abdominal images [10,11]. Masoumi et al. combine artificial neural networks architecture with watershed algorithm for liver segmentation, which provide good results that will be compared with our method in the discussion section [12]. Watershed techniques are used by Rafiee et al. in [13] to create regions in the image. Features are extracted from these regions to feed the neural network architecture. Recently, watershed techniques have also been proposed in combination with stochastic partitions to enhance the gradient of the original MRI image and it has been validated as a robust method in [14].Even if textural and spatial relations play an important role for 2D segmentation, they discard the more accurate 3D textural and spatial relationships. This is of utter importance when large organs such as the liver are involved. The spatial relation among the pixels along the third axis of the volume provides information on the continuity of the candidate segmented regions constituting a straightforward feature to get a more robust segmentation. The main drawback in any 3D approach is its pre-assumed extensive computing time.Several recent works dealing with 3D approach for liver segmentation over MRI images can be identified in the literature. Gloger et al. develop a fully automatic three-step 3D segmentation approach in MRI based upon a modified region growing methodology and a further thresholding technique [15]. Other approach of same authors can be found in [16] to estimate liver volume. Therein, it is proposed a 3D level set algorithm that delineates liver tissue on liver probability. Probability maps for healthy and fatty liver are generated by using linear discriminant analysis and Bayesian methods. Huynh et al. propose in [17] 3D liver segmentation in three stages, joining noise reduction, 3D fast marching methods, and 3D geodesic active contours.In this paper, we propose an accurate 3D method for automatic liver segmentation in MRI. Our method adapts a previously existing active contour model and it is minimized by total variation dual approach [18]. Neither this active contour model nor the minimization approach has ever tackled the difficulty of segmenting the liver in MRI images. Another contribution of this paper is a new approach to improve the contrast in the MRI image that will allow more accurate segmentation. The proposed methodology replaces the input image by a model based probability map.The rest of the paper is structured as follows: Section 2 details the proposed system and method for segmentation, Section 3 describes the experimental results, Section 4 contains the discussion, and in Section 5 concluding remarks are provided.The method we propose considers an active contour model minimized by variational techniques. Specifically, we follow the dual approach to the minimization of the variational energies proposed by Chambolle in [18] for the 2D case. This approach has been adopted in general segmentation and denoising applications [18–20]. However, it has not been applied previously to liver segmentation in MRI. Moreover, the image over which the active contour model evolves is not the original one but a probability map generated by means of previously built liver model. The proposed algorithm and its stages are explained in detail in the following sections.As it can be appreciated in Fig. 1, MRI images present poor contrast, which makes quite difficult the segmentation. We propose to replace this initial image by a model based probability map. Previously, clinically representative sample studies are selected by the radiologist. These examples are employed to extract first and second order statistical values (average and standard deviation) of the liver in the image and build a prior model. These statistical values considered to build the model of the liver directly depend on the MRI sequence to be processed. Thus, in case the processed sequence varies, the liver model is updated automatically.Once the model of the liver is generated, analysis of MRI sequence is done. The probability for a pixel of belonging to class liver is related to an estimate of the distance of that pixel to that class, assuming the class as a Gaussian model. The pixels having the smallest distances belong to liver. Under these circumstances, the distance that maximizes Bayes criterion is the Mahalanobis distance, by means of the following equation:(1)X(i,j)=Ii,j−μ2σ2being I(i,j) the value of each pixel in the image, and being μ the mean value of the model of the liver, and σ is the standard deviation.According to Eq. (1) every pixel of the image of distances is the result of calculating the Mahalanobis distance of the same pixel value to the mean value of liver model in relation to standard deviation in the previously generated statistical model. After performing this process slice by slice, the observation of the resulting image already gives an idea of how good the new generated image of distances is as an improved input for the segmentation process. Pixels that represent the information of the liver appear darker, since the distance is expected to be shorter to the generated model. An example of the resulting image of distances is shown in Fig. 1.We can appreciate that contrast with adjacent elements is clearly improved in the generated image of distances compared to original images. Moreover, the inhomogeneity of the images is minimized. Finally, assuming the liver represented by a Gaussian model, the obtained image of distances can be transformed into a probability map directly after application of the expression in the following equation:(2)Probi,j=1σ2πe−12X(i,j)−μ2/σ2We have assumed that the intensities of the liver in MRI follow a Gaussian distribution. There is a large variability in MRI images, according to scanning hardware, protocols, and tissue response that conforms a non-uniform scene in every slice. To minimize this irregular illumination effect in the image, strong emphasis has been put traditionally in the design of robust anisotropic filters or several image enhancement techniques. In our method, we propose to create a probability map by means of a previously generated model of the liver to minimize this variability in the image. Besides, we want it to be fast. The main aim of this assumption is not to create an accurate model of the liver but to increase the quality of the input image to be segmented by any fast means. This approach allows creating a compact descriptor, the probability value linked to a Gaussian distribution in a fast mathematical operation. This contributes to increase the speed of the whole process at the same time the input image is enhanced to make feasible an accurate segmentation.Active contours can segment objects that are highly variable or whose shape may vary slightly over time. First approach was known as snakes and was introduced by Kass et al. in [21]. Snakes do not have sufficient flexibility to conform to complex shapes. To solve this problem, Malladi et al. [22] and Osher et al. [23] introduced the level set. Even if level set techniques can represent really complex surfaces they can get stuck in a local minimum instead of converging on the global one.Two methods have become very popular in relation to these segmentation techniques. These are the Active Contours Without Edges (ACWE) introduced by Chan et al. [24] and the Geodesic Active Contours (GAC) developed by Caselles et al. [25]. The ACWE model is based on the assumption that there are two different uniform regions. The transition limit at which the regions are not uniform can then be bounded by an active contour. That is, the function u can only present two values, c1and c2; c1 being the average intensity of the region K, and c2 the average intensity value of the other region, which is outside K. The values c1 and c2are not constant all over the process, but are modified as long as the contour evolves and delimits different regions. This procedure ends when the values c1(K) and c2(K) remain stable and the difference between those values outside and inside the two established regions are maximized. On this basis, and as stated in the work by Chan et al. the energy functional to minimize is expressed this way for a 2D image I(x,y):(4)EACME(Ωc,c1,c2,λ)=PerΩc+λ∫Ωcc1−I(x,y)2dxdy+λ∫Ω\Ωcc2−I(x,y)2dxdywhere I is the image given Ωca subset of the image domain bounded by closed contour,PerΩcthe perimeter of the set Ωc, λ is a positive parameter that controls the balance between the regularization and fidelity of the solution with respect to the original image I, c1 and c2∈R.As proposed and demonstrated in [24] by Chan and Vese and based on the variational problem, Eq. (4) can be solved to determine the evolution of the whole ΩCin an approach based on level set. In this, the regions ΩCand Ω\ΩCare represented by the Heaviside function. Therefore, the energy EACWE can be written according to a level set function Φ as follows:(5)EACWE2ϕ,c1,c2,λ=∫Ω∇Hε(ϕ)dxdy+λ∫ΩcHε(ϕ)(c1−I(x,y))2+Hε(−ϕ)(c2−I(x,y))2dxdywhere Ω is the image domain and Hεis a regularization of the Heaviside function.Regarding implementation issues,PerΩcis the total length of all the points belonging to the contour of the active contour. Since the contour evolves and changes every iteration, it is updated till convergence.Geodesic Active Contours are proposed as an improvement of active contours based on the level set equation that adds geometric parameters to control the evolution of the curve. A GAC minimizes the length of a curve which assigns smaller energy values to curves that attach to regions of the image where the module of its gradient is higher. The energy functional model for GAC is(6)EGAC(C)=∫Cgdsbeing g an edge detecting function, and s is defined in the C contour separating Ωcsubset of the image that is the boundary between the two soft regions.The method we propose consists of an active contour model, specifically adapted to liver segmentation in MRI and extended to 3D, evolving over our proposed model based probability image. The active contour model was first proposed by Bresson [26].On the other hand, the variational techniques arise as a mathematical approach to minimize properly the active contours and guarantee the global minimum is achieved, and therefore, and optimal segmentation. These techniques are also very useful in denoising applications. These techniques consider the fact that some energy functions are not strictly convex, implying that there does not exist a unique global minimum but rather many local minima. This energy functional defined on the images is such that a minimum of such functional provides a solution to the problem of segmentation. The mathematical resolution of the problem can usually be reduced to the solution of nonlinear partial differential equations, which can be translated into discrete space in an affordable way to identify a solution.In our approach we adapt the active contour model and the minimization process to make it suitable for liver segmentation in 2D and 3D space. The energy functional employed in the active contour model studied in this paper is represented by the linked relation between the two energies (4) and (6), and according to [26], is exposed in Eq. (7), which is not strictly convex.(7)Er(u,v,c1,c2,λ,α,θ)=TVg(u)+12θu−vL22+∫Ωλr1(x,c1,c2)v+αv(v)dxwhere TVg is the classical total variation, but weighted by a function g containing information about I0 image edges, and which is obtained by the expression:(8)g|∇I0|=11+β|∇I0|2being β a positive constant that weights the contributions of the gradient in function g for edge detection.It is necessary to minimize Eq. (7). Chambolle [18] developed a mathematical approach on dual formulation based on the fact that if the function is not convex and therefore it owns some local minima besides the global one, to calculate the global minimum, he proposed to convert this not strictly convex function in a strictly convex one. To this aim, he adds another function v, so that the location of the minimum is performed by setting v minimizing with respect to u; and setting u minimizing with respect to v separately and two both are iterated until convergence. Hence two equations are to be solved:•v being fixed, u is minimized as solution of(9)minuTVg(u)+12θu−υL22u being fixed, v is minimized as solution ofThe solution to (9) is(11)u=v−θdivpwhere p=(p1, p2) is given by(12)g(x)∇(θdivp−v)−|∇(θdivp−v)|p=0The previous equation can be solved by a fixed point method, so the problem in the continuous space is translated to the discrete space, much more feasible. This is,(13)p0=0pn+1=pn+δt∇divpn−v/θ1+δt/g(x)∇(div(pn)−v/θ)The solution to Eq. (10) to locate the minimum of v is given by(14)v=minmaxu(x)−θλr1(x,c1,c2),0,1To minimize the energy it is necessary to iterate (13) and (14). The values c1 and c2 are updated every N defined iterations. There are some configurable parameters, such as λ, which governs how soft the contours can be. The smaller λ is, the smoother the edges are (it fits worst the possible existing irregularities). β indicates the importance of the gradient at the location of the edges.Knowledge on pre-established patient position during image acquisition allows spurious region filtering. After that, liver vessels are integrated through morphologic filling operations.We propose to extend this model formulation to 3D by considering the following premises:•The characteristics functions u and v, i.e., the minimizers of the active contours have three dimensions instead of two. They can be named as active surfaces. Same concept remains for the values c1, c2∈R which are the intensity values inside and outside the active surface, respectively.The calculation of the Probability Distribution Function and the extraction of values c1 and c2 is calculated for a volume.The minimization method is also to be extended to a higher dimension. To achieve so:•The edge detection function g has to consider gradients in the three axes, g=(gx, gy, gz)The minimization process is solved with PDE, by the same fixed point method, being now spatial point p=(px, py, pz)The parameters that can be configured in the minimization process remain being the same: λ, β y N.The main aim of the minimization method used to make the active contour evolve, this is, the dual approach of the variational problem proposed by Chambolle, is to converge in the global minimum and not to get stuck in local minima. Under this consideration, initialization is not so crucial, since the algorithm manages to converge to the global solution and thus, obtain the optimal segmentation of the object. The implementation of the minimization is independent of the initial condition. In this case, it has been chosenu=v=I0max(I0), c1=c2=px=py=pz=0, being I0 the original image after being smoothed by means of a Gaussian function.

@&#CONCLUSIONS@&#
The aim of this paper was to detail the theoretical and practical issues associated with the implementation of a new automatic method for more accurate liver segmentation in MRI images. The proposed approach considers a previous active contour model. The process of minimization of the active contour is proposed to be done by means of the dual formulation of variational approach. Furthermore, we propose to transform the MRI gray-level image of every slice in a sequence in a new probability map according to a statistical model of the liver previously generated. This new image presents higher contrast among tissues, which allows a better segmentation. The method has been extended to 3D. The method in 2D and extended to 3D has been validated and compared over MRI abdominal images for liver segmentation. Comparison has been made with other state-of-the-art methods.As main conclusion of this paper, we obtain that our proposed 3D automatic method is a valuable method for liver segmentation in MRI images. An accuracy of 98.89 and Dice Similarity Coefficient of 90.19 are aligned with other methods of the state-of-the-art.