@&#MAIN-TITLE@&#
Continuous multifacility ordered median location problems

@&#HIGHLIGHTS@&#
New models for continuous multifacility location with any ℓpnorm are presented.For multiple allocation problems we provide SOCP formulations.For single allocation problem, the formulation becomes a MISOCO problem.Alternatively, a hierarchy of SDP problems converging to the optimal solution is given.Some computational results with the presented models are reported.

@&#KEYPHRASES@&#
Continuous multifacility location,Ordered median problems,Semidefinite programming,Second order cone programming,

@&#ABSTRACT@&#
In this paper we propose a general methodology for solving a broad class of continuous, multifacility location problems, in any dimension and with ℓτ-norms proposing two different methodologies: (1) by a new second order cone mixed integer programming formulation and (2) by formulating a sequence of semidefinite programs that converges to the solution of the problem; each of these relaxed problems solvable with SDP solvers in polynomial time.

@&#INTRODUCTION@&#
Multifacility location problems are among the most interesting and difficult problems in Location Analysis. It is well-known that even in their discrete version the p-median and p-center problems are already NP-hard (see Kariv and Hakimi, 1979.) A lot of attention has been paid in the last decades to these classes of problems, namely location-allocation problems, since they are easy to describe and to understand and they still capture the essence of difficult problems in combinatorial optimization. A comprehensive overview over existing models and their applications is given by Drezner and Hamacher (2002) and the references therein.On the other hand, also in the last two decades locators have devoted much effort to solve continuous location problems that fall within the general class of global optimization, i.e. convexity properties are lost. Given a set of demand points (existing facilities) the goal is to locate several facilities to provide service to the existing ones (demand points) minimizing some globalizing function of the travel distances. Assuming that each demand point will be served by its closest facility we are faced with another location-allocation problem but now the new facilities can be located anywhere in the framework space and therefore they are not confined to be in an “a priori” given set of locations. These problems are much harder than the discrete ones and not much has been obtained regarding algorithms, and general convergence results, although some exceptions can be found in the literature (see Albareda, Hinojosa, and Puerto, 2015; Brimberg, Drezner, Mladenović, and Salhi, 2014; Brimberg, Hansen, Mladenovic, and Taillard, 2000; Michelot, 1987 and the references therein).Since the 1990s a new family of objective functions has started to be considered in the area of Location Analysis: the ordered median problem (Nickel & Puerto, 2005). Ordered median problems represent as special cases nearly all classical objective functions in location theory, including the Median, CentDian, Center and k-Centra. Hence, handling the most important objective functions in Location Analysis is possible with one unique model and also new ones may be created by adapting the parameters adequately. More precisely, the p-facility ordered median problem can be formulated as follows: a vector of weights(λ1,…,λn)is given. The problem is to find locations for the facilities that minimize the weighted sum of distances to the facilities where the distance to the closest point to its allocated facility is multiplied by the weight λn, the distance to the second closest, byλn−1,and so on. The distance to the farthest point is multiplied by λ1. As mentioned above, many location problems can be formulated as the ordered 1-median problem by selecting appropriate weights. For example, the vector for which allλi=1is the p-median problem, the problem whereλ1=1and all others are equal to zero is the p-center problem, the problem whereλ1=…=λk=1and all others are equal to zero is the p-k-centrum. Minimizing the range of distances is achieved byλ1=1,λn=−1and all others are zero. Lots of results have been obtained for these problems in discrete settings, on networks and even in the continuous single facility case (see the book Nickel and Puerto, 2005 and the recent papers Blanco, El-Haj Ben-Ali, and Puerto, 2013; Boland, Dominguez-Marin, Nickel, and Puerto, 2006; Kalcsics, Nickel, Puerto, and Rodríguez-Chía, 2010; Marín, Nickel, Puerto, and Velten, 2009; Puerto, D. Pérez-Brito, and Garcia-González, 2014; Puerto and Rodriguez-Chia, 2011). However, very little is known in the continuous multifacility counterpart (Kalcsics, Nickel, Pozo, Puerto, & Rodriguez-Chia, 2014).In this paper, we address the multifacility continuous ordered median problem in finite dimension d and for general ℓτ-norm for measuring the distances between points. We show how these problems can be cast within a general family of polynomial optimization problems. Then, we show how these problems can be formulated as mixed integer second order cone programs or, using tools borrowed from the Theory of Moments (Lasserre, 2009b), they can be solved (approximated up to any degree of accuracy) by a series of relaxed problems, each one of them is a SDP, polynomially solvable. We report some computational results on a battery of problems solved with the presented models.In this section we recall the main definitions and results on Semidefinite Programming and the Theory of Moments that will be useful for the development through this paper. We use standard notation in those fields (see e.g. Lasserre, 2009b; Wolkowicz, Saigal, & Vandenberghe, 2000).Semidefinite programming (SDP) is relatively a new subfield of convex optimization and probably one of the most exciting development in mathematical programming. SDP is a particular case of conic programming when one considers the convex cone of positive semidefinite matrices, whereas linear programming considers the positive orthant, a polyhedral convex cone. This class of problems theoretically includes a large number of convex programming models such as convex quadratic programming (QP), or second-order cone programming (SOCP). Moreover, semidefinite programming has experienced a great growth during the 1990s, as a consequence of the adaptation of some polynomial time interior point methods firstly developed for linear optimization to solve SDP. SDP duality is not always strong because of the nonlinear positive semidefinite constraint. To avoid duality gaps, we can require the problem and its dual to satisfy some constraint qualification. The purpose of a constraint qualification is to ensure the existence of Lagrange multipliers at optimality in nonlinear problems. These multipliers are an optimal solution for the dual problem, and thus the constraint qualification ensures that strong duality holds: it is possible to achieve primal and dual feasibility with no duality gap. One common choice of constraint qualification is Slater’s constraint qualification (Boyd & Vanderberghe, 2004). The handbooks (Anjos & Lasserre, 2012) and (Wolkowicz et al., 2000) provide excellent coverage of SDP as well as extensive bibliographic reviews of the literature up to the year 2012.On the other hand, the Theory of Moments is a powerful technique that can be applied to approximate hard global optimization problems (Lasserre, 2009b). It can be used to construct hierarchies of approximate problems whose optimal values converge to the optimal value of the multifacility location problems considered in this paper. For this reason next we describe its basic elements. We denote byR[x]the ring of real polynomials in the variablesx=(x1,…,xd),ford∈N(d ≥ 1), and byR[x]r⊂R[x]the vector space of polynomials of degree at mostr∈N(hereNdenotes the set of non-negative integers). We also denote byB={xα:α∈Nd}a canonical basis of monomials forR[x],wherexα=x1α1⋯xdαd,for anyα∈Nd. Note thatBr={xα∈B:∑i=1dαi≤r}is a basis forR[x]r.For any sequence indexed in the canonical monomial basisB,y=(yα)α∈Nd⊂R,letLy:R[x]→Rbe the linear functional defined, for anyf=∑α∈Ndfαxα∈R[x],asLy(f):=∑α∈Ndfαyα.The moment matrix Mr(y) of order r associated with y, has its rows and columns indexed by the elements in the basisB={xα:α∈Nd}and for two elements in such a basis,b1=xα,b2=xβ,Mr(y)(b1,b2)=Mr(y)(α,β):=Ly(xα+β)=yα+β,for |α|, |β| ≤ r (here |a| stands for the sum of the coordinates ofa∈Nd). Note that the moment matrix of order r has dimension(d+rd)×(d+rd)and that there are(d+2rd)yαvariables.Forg∈R[x](=∑γ∈Ndgγxγ), the localizing matrix Mr(gy) of order r associated with y and g, has its rows and columns indexed by the elements inBand forb1=xα,b2=xβ,Mr(gy)(b1,b2)=Mr(gy)(α,β):=Ly(xα+βg(x))=∑γgγyγ+α+β,for |α|, |β| ≤ r.Observe that a different choice for the basis ofR[x],instead of the standard monomial basis, would give different moment and localizing matrices useful for instance to derive improvements in the relaxations for structured (symmetric or sparse) problems.The main assumption to be imposed when one wants to assure convergence of some SDP relaxations for solving polynomial optimization problems is known as the Arquimedean property (see for instance Lasserre, 2009a; 2009b) and it is a consequence of Putinar’s results (Putinar, 1993).The importance of Archimedean property stems from the link between such a condition with the semidefiniteness of the moment and localizing matrices (see Putinar, 1993). The use of this property for the particular problems that we deal with through this paper will be given in the next sections. A detailed presentation and an account of its implications can be found by Lasserre (2001). In the following we shall use the following convention: for any matrixA∈Rn×n,we denote by A≽0 (resp. A≻0) that the matrix A is positive semidefinite (resp. positive definite).Proposition 1Lasserre (2001)LetK:={x∈Rd:gj(x)≥0,j=1,…,m}⊂Rdsatisfy the Archimedean Property and letp∈R[X]be a polynomial. Letr≥r0:=max{⌈degp2⌉,⌈degg12⌉,…,⌈deggm2⌉},and consider the hierarchy of semidefinite relaxations(1)Qr:infyLy(p)Mr(y)⪰0,Mr−⌈deggj/2⌉(gjy)⪰0,1≤j≤mLy(y0)=1with optimal value denoted by infQr.Then, the hierarchy of SDP-relaxations{(Qr)r≥r0}is monotone non-decreasing and converges to ρ* ≔ minx ∈ Kp(x).SOCP is a particular class of problems that falls within the family of SDP. SOCP refers to convex optimization problems in which a linear function is minimized over the intersection of an affine linear manifold with the Cartesian product of second-order cones. Many applications in engineering, statistics, robust optimization, finance or combinatorial optimization use SOCP models (see Lobo, Vandenberghe, Boyd, & Lebret, 1998). Although the available algorithms for SDP are clearly applicable to SOCP, specialized approaches for SOCP have been proved to be more efficient for this family of problems (see Alizadeh & Goldfarb, 2003).For the sake of readability and to do the paper self contained we recall the following result, proved by Blanco, Puerto, and El-Haj Ben-Ali (2014b), that allows to represent several types of constraints as intersection of second order cone constraints.Lemma 2Blanco et al. (2014b)Letr,s∈N∖{0}such thatgcd(r,s)=1. Then, the constraintsustr−s≥xr,x,u,t≥0,can be equivalently written as a set of at most ⌊log2(r)⌋ second order cone inequalities with ⌊log2(r)⌋ new (auxiliary) nonnegative variables.This section deals with multifacility location models where more than one new facility have to be located to improve the service for the demand points. Several results obtained in previous papers are extended or reformulated with great generality giving a panorama view of the geometric insights of location theory.We start by considering a class of multifacility ordered median problems already introduced by Nickel and Puerto (2005) and Rodríguez-Chía, Nickel, Puerto, and Fernández (2000). We shall extend these models, originally considered only in dimension 2 and with polyhedral norms to the more general case of any dimension d > 1 and any ℓτ-norm beingτ∈Q,τ≥1(here ℓτstands for the norm∥x∥τ=(∑i=1d|xi|τ)1τ,for allx∈Rd). Unlike the original approaches for the planar case by Carrizosa and Puerto (1995); Nickel and Puerto (2005); Rodríguez-Chía et al. (2000), where even for polyhedral norms there are proposed iterative algorithms for which polynomiality results can not be proven; we shall follow on a different approach. In this section, we provide efficient reformulations of these classes of multifacility continuous location models. We apply tools borrowed from conic programming to prove that these problems can be polynomially solved.We are given a set of demand points{a1,…,an}and three sets of scalars{ω1,…,ωn}⊆R+,{λ11,…,λnp}⊆R+and{μ12,μ13,…,μp−1p}⊆R+.The elements ωiare weights corresponding to the importance given to the existing facilitiesai,i∈{1,…,n}and depending on the choice of the λ-weights we get different classes of problems. The μ-weights represent the penalty per distance unit given when locating two different facilities. We denote byPnthe set of permutations of the first n natural numbers (i.e.,Pn={σ:{1,…,n}→{1,…,n}:σbijective}).Natural extensions of the multifacility models considered by Nickel and Puerto (2005) and Rodríguez-Chía et al. (2000), assume that one is looking for the location of p new facilities rather than only one. In this formulation the new facilities are chosen to provide service to all the existing facilities minimizing an ordered median objective function. These ordered problems are of course harder to handle than the classical ones not considering ordered distances. To simplify the presentation we consider that the different demand points use the same norm to measure distances, although all our results extend further to the case of mixed norms (different norm for each facility).Let us consider a set of demand points{a1,a2,…,an}⊂Rd. We want to locate p new facilitiesX={x1,x2,…,xp}which minimize the following expression:(2)fλNI(x1,x2,…,xp)=∑i=1n∑j=1pλijd(i)(xj)+∑j=1p−1∑j′=j+1pμjj′∥xj−xj′∥τ,where for anyx∈Rd,di(x)=ωi∥ai−x∥τand d(i)(x) is the ith element in the permutation of(d1(x),…,dn(x))such thatd(1)(x)≥d(2)(x)≥…≥d(i)(x)≥…≥d(n)(x). In this model, it is assumed that (see Rodríguez-Chía et al., 2000)(3)λ1j≥λ2j≥…≥λnj≥0,∀j=1,…,p.μjj′≥0for anyj,j′=1,…,pand, as mention above, d(i)(xj) is the expression, which appears at the ith position in the ordered version of the list(4)LjNI:=(w1∥xj−a1∥τ,…,wn∥xj−an∥τ)forj=1,2,…,p.Note that in this formulation we assign the lambda parameters with respect to each new facility, i.e., xjis considered to be non-interchangeable with xiwhenever i ≠ j. For this reason we say that this model has non-interchangeable facilities.The problem consists of(LOCOMF-NI)ρλNI:=minx{fλNI(x):x=(x1,…,xp),xj∈Rd,∀j=1,⋯,p},The reader should observe that this is the extension of Problem (3) by Rodríguez-Chía et al. (2000, Section 4.1).Theorem 3The problemLOCOMF-NIattains an optimal solution.We know that∑i=1n∑j=1pλijd(i)(xj)=∑i=1nmaxσ∑j=1pλijwσ(i)∥xj−aσ(i)∥τ,where σ is a permutation of the set{1,2,…,p}. Therefore, the first part of the objective function is a sum of maxima of convex functions. Hence, it is a convex function. Thus,fλNIis a convex function as a sum of convex functions.Next, suppose that we restrict ourselves to consider the problem wherexj=xfor allj=1,…,p. Assume that x* is a solution. Then, for any x not optimal it must existix∈{1,…,n}such that∥x−aix∥τ≥∥x*−aix∥τ. Thus takingx=0,we get∥x*−ai0∥τ≤∥ai0∥τwhich implies that∥x*∥τ−maxi=1,…,n∥ai∥τ≤maxi=1,…,n∥ai∥τ. Hence, any candidate x* to optimal solution must satisfy∥x*∥τ≤2maxi=1,…,n∥ai∥τ=M.Let us denote byXthe set{x∈Rp×d:∥xj∥τ≤M,∀j=1,…,p}. Observe that for solving LOCOMF-NI we can restrict, without loss of generality, toX. Thus, it consists of minimizing the convex functionfλNIoverXwhich is compact inRp×dand consequently by Weierstrass theorem, Problem LOCOMF-NI admits at least one optimal solution.□The following result states a sufficient condition for uniqueness of optimal solution of Problem (LOCOMF-NI).Theorem 4Assume thatτ∉{1,+∞},the demand points in A are not collinear and for alli=1,…,nthere exists at least onej∈{1,…,p}such that λij≠ 0. Then the optimal solution of Problem(LOCOMF-NI)is unique.We prove that the functionfλNI(x1,x2,…,xp)is strictly convex which clearly implies the result.Since the functionfλNI(x1,x2,…,xp)is globally convex we can take without loss of generality two pointsx¯,x^and[x¯,x^]in the same ordered region and γ ∈ (0, 1). (Observe that otherwise, we can decompose the segment in subsegments satisfying the hypothesis and we apply the same argument in each of them.) In the ordered region the sorting of the distances is fixed and to simplify the presentation we suppose that this sorting is induced by the identity permutation.By hypothesis, the demand points in A are not collinear and the ‖ · ‖τ-norm is strictly convex forτ∈(1,+∞); thus, for eachj∈1,…,pthere exists i(j) such that∥γx¯j+(1−γ)x^j−ai(j)∥τ<γ∥x¯j−ai(j)∥τ+(1−γ)∥x^j−ai(j)∥τ,j∈1,…,p. These inequalities imply thatfλNI(γ(x¯1,x¯2,…,x¯p)+(1−γ)(x^1,x^2,…,x^p))<γfλNI(x¯1,x¯2,…,x¯p)+(1−γ)fλNI(x^1,x^2,…,x^p).□Note that when the demand points in A are collinear one can find multiple solutions to Problem (LOCOMF-NI). The following example illustrates this situation.Example 5LetA={(0,0),(1,1),(2,2),(10,10)}be a set of demand points inR2endowed with the ℓ2-norm and consider the following weightswi=1for alli=1,…,4,μ12=0andλ11=λ21=λ31=λ41=1,λ12=1,λ22=λ32=λ42=0.The optimal value of (LOCOMF-NI) forp=2facilities isf*=162which is attained byx1*∈{(x,x):x∈[1,2]},x2*=(5,5). Fig. 1shows the demand points (circles) and the optimal solutions to the problem (triangles and square).Next we prove that Problem LOCOMF-NI can be reformulated in an appropriate way that allows us the development of an efficient algorithm based on the theory of second order cone programming.Theorem 6Letτ=rsbe such thatr,s∈N∖{0},r ≥ s andgcd(r,s)=1. For any set of lambda weights satisfyingλ1j≥…≥λnj≥0for allj=1,…,p,Problem(LOCOMF-NI)is equivalent to(NIMFOMP)λρλNI=min∑i=1n∑j=1pvij+∑ℓ=1n∑j=1pwℓj+∑j=1p−1∑j′=j+1ptjj′(5)s.t.vij+wℓj≥λℓjuij,∀i,ℓ=1,…,n,j=1,…,p(6)yijk−xjk+aik≥0,∀i=1,…,n,j=1,…,p,k=1,…,d(7)yijk+xjk−aik≥0,∀i=1,…,n,j=1,…,p,k=1,…,d,(8)yijkr≤ςijksuijr−s,∀i=1,…,n,j=1,…,p,k=1,…,d,(9)ωirs∑k=1dςijk≤uij,∀i=1,…,n,j=1,…,p(10)zjj′k−xjk+xj′k≥0,∀j,j′=1,…,p,k=1,…,d,(11)zjj′k+xjk−xj′k≥0,∀j,j′=1,…,p,k=1,…,d,(12)zjj′kr≤ξjj′kstjj′r−s,∀j,j′=1,…,p,k=1,…,d,(13)μjj′rs∑k=1dξjj′k≤tjj′,∀j,j′=1,…,p,(14)ςijk≥0,∀i=1,…,n,j=1,…,p,k=1,…,d,(15)ξjj′k≥0,∀j,j′=1,…,p,k=1,…,d,(16)vij∈R,wℓj∈R,tjj′≥0,∀i=1,…,n,j,j′=1,…,p(17)yijk≥0,zjj′k≥0,∀i=1,…,n,j,j′=1,…,p,k=1,…,d.Moreover, (NIMFOMPλ) satisfies Slater condition and it can be represented as a second order cone program with(np+p2)(2d+1)+p2linear inequalities and at most4(p2d+npd)logrsecond order cone inequalities.Note that the conditionλ1j≥…≥λnjfor allj=1,…,p,allows us to write Problem (LOCOMF-NI) as(18)minx∈Rdpmaxσ∈Pn∑i=1n∑j=1pλijωσ(i)∥xj−aσ(i)∥τ+∑j=1p−1∑j′=j+1pμjj′∥xj−xj′∥τ,Let us introduce the auxiliary variables uijandtjj′,i=1,…,nandj,j′=1,…,pto which we impose thatuij≥ωi∥xj−ai∥τandtjj′≥μjj′∥xj−xj′∥τ,to model the problem in a convenient form.Now, for any permutationσ∈Pn,letuσj=(uσ(1)j,…,uσ(n)j)forj=1,…,p. Moreover, let us denote by ( · ) the permutation that sorts any vector in nonincreasing sequence, i.e.u(1)j≥u(2)j≥…≥u(n)j. Using thatλ1j≥…≥λnjand sinceuij≥0,for alli=1,…,nandj=1,…,pthen(19)∑i=1n∑j=1pλiju(i)j=maxσ∈Pn∑i=1n∑j=1pλijuσ(i)j.The permutations inPncan be represented by the binary variablespijk={1,ifuijgoesinpositionk,0,otherwise,imposing that they verify the following constraints:∑i=1npijk=1,∀j=1,…,p,k=1,…,n,∑k=1npijk=1,∀i=1,…,n,j=1,…,p.Next, combining the two sets of variables we obtain that righthand side of (19) can be equivalently written as(20){∑i=1n∑j=1pλiju(i)j=max∑i=1n∑j=1p∑k=1nλijuijpijks.t∑i=1npijk=1,∀j=1,…,p,k=1,…,n,∑k=1npijk=1,∀i=1,…,n,j=1,…,p,pijk∈{0,1}.Now, we point out that for fixed j, i.e. considering the terms that containu1j,…,unj,we have that(21){∑i=1nλiju(i)j=max∑i=1n∑k=1nλijuijpijks.t∑i=1npijk=1,∀k=1,…,n,∑k=1npijk=1,∀i=1,…,n,pijk∈{0,1}.The problem above is an assignment problem and its constraint matrix is totally unimodular, so that solving a continuous relaxation of the problem always yields an integral solution vector (see Ahuja, Magnanti, & Orlin, 1993), and thus a valid permutation. Moreover, the dual of the linear programming relaxation of (21) is strong and also gives the value of the original binary formulation of (21). Hence, for fixedj∈{1,…,p}and for any vectoru·j∈Rn,by using the dual of the assignment problem (21) we obtain the following expression(22){∑i=1nλiju(i)j=min∑i=1nvij+∑l=1nwljs.tvij+wlj≥λljuij,∀i,l=1,…,n.Finally, we replace (22) in (18) and we get(23){min∑i=1n∑j=1pvij+∑l=1n∑j=1pwlj+∑j=1p−1∑j′=j+1ptjj′s.tvij+wlj≥λljuij,∀i,l=1,…,n,j=1,…,p,uij≥ωi∥xj−ai∥τ,i=1,…,n,j=1,…,p,tjj′≥μjj′∥xj−xj′∥τ,j,j′=1,…,p.It remains to prove that each inequalityuij≥ωi∥xj−ai∥τ,i=1,…,n,j=1,…,pcan be replaced by the systemyijk−xjk+aik≥0,k=1,…,d,yijk+xjk−aik≥0,k=1,…,d,yijkr≤ςijksuijr−s,k=1,…,d,ωirs∑k=1dςijk≤uij,ςijk≥0,∀k=1,…,d.Indeed, setρ=rr−s,then1ρ+sr=1. Let(x¯j,u¯ij)fulfil the inequalityuij≥ωi∥xj−ai∥τ. Then we have(24)ωi∥x¯j−ai∥τ≤u¯ij⟺ωi(∑k=1d|x¯jk−aik|rs)sr≤u¯ijsru¯ij1ρ⟺ωi(∑k=1d|x¯jk−aik|rsu¯ijrs(−r−sr))sr≤u¯ijsr⟺ωirs∑k=1d|x¯jk−aik|rsu¯ij−r−ss≤u¯ijThen (24) holds if and only if∃ςij∈Rd,ςijk≥0,∀k=1,…,dsuch that|x¯jk−aik|rsu¯ij−r−ss≤ςijk,satisfyingωirs∑k=1dςijk≤u¯ij,or equivalently,(25)|x¯jk−aik|r≤ςijksu¯ijr−s,ωirs∑k=1dςijk≤u¯ij.Sety¯ijk=|x¯jk−aik|andς¯ijk=|x¯jk−aik|τu¯ij−1/ρ. Then, clearly(x¯j,u¯ij,y¯ij,ς¯ij)satisfies (6)–(9) and (14).Conversely, let(x¯j,u¯ij,y¯ij,ς¯ij)be a feasible solution of (6)–(9) and (14). Then,y¯ijk≥|x¯jk−aik|for all i, j and by (8)ς¯ijk≥y¯ijk(rs)uij−r−ss≥|x¯jk−ajk|τu¯ij−r−ss. Thus,ωirs∑k=1d|x¯jk−ajk|rsu¯ij−r−ss≤ωirs∑k=1dς¯ijk≤u¯ij,which in turns implies thatωirs∑k=1d|x¯jk−ajk|rs≤u¯iju¯ijr−ssand hence,ωi∥x¯j−ai∥τ≤u¯ij. In the same way we prove that each inequalitytjj′≥μjj′∥xj−xj′∥τ,j,j′=1,…,pcan be replaced by the systemzjj′k−xjk+xj′k≥0,k=1,…,d,zjj′k+xjk−xj′k≥0,k=1,…,d,zjj′kr≤ξjj′kstjj′r−s,k=1,…,d,μjj′rs∑k=1dξjj′k≤tjj′,ξijk≥0,∀k=1,…,d.Next, we observe that each one of the inequalitiesyijkr≤ςijksuijr−s,k=1,…,d(respectivelyzjj′kr≤ξjj′kstjj′r−s,k=1,…,d) can be transformed, according to Lemma 2, into 4log r linear matrix inequalities (respectively 4log r linear matrix inequalities), being then exactly representable as second order cone constraints or semidefinite constraints.Finally, it is straightforward to check Slater condition, for instance, for the system (23). Setvij=1,wlj=32Mλljmaxiωi,uij=32Mωi+2with M > >0 large enough andtjj′=2Mμjj′+1fori,l=1,…,nandj,j′=1,…,p.□In the case that the considered norm is polyhedral (in particular ifτ=1orτ=+∞in the theorem above), the above problem reduces to a standard linear problem and its number of variables and inequalities highly decreases.As a consequence of Theorem 6 and Lemma 2, Problem (LOCOMF-NI) can be solved in polynomial time for any dimension d, by solving its reformulation as a SOCP problem (NIMFOMPλ) (see Monteiro & Tsuchiya, 2000; Nesterov, Nemirovski, & Ye, 1994). The reader may note that this is an important step forward with respect to the already stated complexity results (see e.g. Rodríguez-Chía et al., 2000). There, it was proven that these problems are solvable in polynomial time in the plane (d=2) and using polyhedral norms. Here we extend this complexity result to be true in any dimension d > 1 and for any polyhedral or ℓτ-norm withτ∈Q,τ ≥ 1.Example 7Consider a two-facility problem on the Euclidean plane with a set of 4 demand points given byA={(9.46,9.36),(8.93,7.00),(2.20,1.12),(1.33,8.89)}(A is subset of size 4 of the 50-cities data set from Eilon, Watson-Gandy, and Christofides (1971)), and (randomly generated-) lambda weights:λ11=147.31,λ21=24.44,λ31=24.16,λ41=10.77,λ12=119.08),λ22=0.56,λ32=0.00,λ42=0.00,μ12=0.56andwi=1for alli=1,…,n.The problem to be solved can be written asminx1,x2∈R2147.31d(1)(x1)+24.44d(2)(x1)+24.16d(3)(x1)+10.77d(4)(x1)+119.08d(1)(x2)+0.56d(2)(x2)+0.00d(3)(x2)+0.00d(4)(x2)+0.56∥x1−x2∥2We get as solution:x1*=(5.24,6.41)andx2*=(5.61,5.44),with objective valuef*=1704.55. Fig. 2shows the points and the solutions of the problem. The reader may observe that in general optimal solutions of this problem do not collocate.The structural difference of a single allocation multifacility location problem with those considered in the previous section rests on the fact that in the former each demand point shall be directed to a unique serving facility by means of a predetermined allocation rule (usually closest distance). This little difference makes the problem much more difficult since the convexity properties exhibited in the previous models are no longer valid and more sophisticated tools must be used to solve these problems.In this framework, we are given a set{a1,…,an}⊂Rdendowed with a ℓτ-norm; and a feasible domainK={x∈Rd:gj(x)≥0,j=1,…,m}⊂Rd,closed and semi-algebraic. The goal is to find p pointsx1,…,xp∈K⊂Rdminimizing some globalizing function of the shortest distances to the set of demand points.The main feature and what distinguishes multifacility location problems from other general purpose optimization problems, is that the dependence of the decision variables is given throughout the norms to the demand points, i.e.∥x−ai∥τ.For the ease of presentation we have restricted ourselves to the particular case of pure location problems, namelyf˜i(x):=minj=1…p∥xj−ai∥τwhich has attracted a lot of attention in the literature of Location Analysis. Needless to say that our methodology applies to more general forms of objective function, namely we could handle general rational functions of the distances as for instance by Blanco et al. (2013).We shall define the dependence of the decision variablesx1,…,xp∈Rdviat=(t1,…,tn),whereti:Rpd↦R,ti(x1,…,xp):=minj∥xj−ai∥τ,i=1,…,n. Therefore, the ith component of the ordered median objective function of our problems reads asf˜i(x):Rpd↦Rx=(x1,…,xp)↦ti:=minj=1…p{∥xj−ai∥τ}.Consider the following problem(LOCOMF)ρλ:=minx{∑i=1nλif˜(i)(x):x=(x1,…,xp),xj∈K,∀j=1,…,p},where•K⊆Rdsatisfies the Archimedean property. Without loss of generality we shall assume that we know M > 0 such that ‖xj‖2 ≤ M, for allj=1,…,p.τ:=rs≥1,r,s∈Nwithgcd(r,s)=1.λℓ ≥ 0 for allℓ=1,…,n.First of all, we observe that problem LOCOMF is well defined and that it has an optimal solution. Indeed, we are minimizing a continuous function over a compact set inRd. Thus, by Weierstrass theorem problem LOCOMF admits an optimal solution. On the other hand, unlike in the previous section uniqueness can not be easily obtained since, as proven by the following easy example, multiple solutions often occurs.Example 8Consider a two-facility problem on the Euclidean plane with set of demand pointsA={(0, 0), (0, 1), (1, 1), (1, 0)}. Assume that the λ-weights areλij=1for alli=1,…,n,j=1,…,p. Then, any pair of pointsx1*∈{0}×[0,1]andx2*∈{1}×[0,1]is an optimal solution.In this section, we present a tractable formulation of problem LOCOMF as a mixed integer nonlinear program with linear objective function. For eachi∈{1,…,n},we set UBias a valid upper bound on the value of∥x¯j−ai∥τ,x¯j∈K.We introduce the following auxiliary problem(MFOMP)λρ^λ=min∑ℓ=1nλℓθℓ(26)s.t.hil1:=ti≤θℓ+UBi(1−wiℓ),∀i=1,…,n,ℓ=1,…,n,(27)hl2:=θℓ≥θℓ+1,∀ℓ=1,…,n−1,(28)hij3:=uij≤ti+UBi(1−zij),∀i=1,…,n,j=1,…,p,(29)hijk4:=vijk−xjk+aik≥0,∀i=1,…,n,j=1,…,p,k=1,…,d,(30)hijk5:=vijk+xjk−aik≥0,∀i=1,…,n,j=1,…,p,k=1,…,d,(31)hijk6:=vijkr≤ζijksuijr−s,∀i=1,…,n,j=1,…,p,k=1,…,d,(32)hij7:=∑k=1dζijk≤uij,∀i=1,…,n,j=1,…,p,(33)hi8:=∑j=1pzij=1,∀i=1,…,n,(34)hℓ9:=∑i=1nwiℓ=1,∀ℓ=1,…,n,(35)hi10:=∑l=1nwil=1,∀i=1,…,n,(36)wiℓ∈{0,1},∀i,ℓ=1,…,n,(37)zij∈{0,1},∀i=1,…,n,j=1,…,p,(38)θℓ,ti∈R+,∀i,ℓ=1,…,n,(39)vijk,ζijk,uij∈R+,∀i=1,…,n,j=1,…,p,k=1,…,d,(40)xj∈K,∀j=1,…,p.With constraints (26) and (27), we enforce the variable θlto assume the value tithat is sorted in the lth position of the vector t, while constraints (28)–(32) model the evaluation of∥xj−ai∥τfor all i and j. Constraints (34)–(36) model permutations, and constraints (33) and (37) are introduced to model the allocation of element indexed by i to a unique index j. Therefore, putting all the above ingredients together we get that in the optimumti=minj∥xj−ai∥τ.LetN:=3n+n2+n−1+np(3d+2)=n2+4n+np(3d+2)−1and denote by{h1,…,hN}the constraints (26)–(35) in the problem above. LetK^denote the feasible domain of Problem MFOMPλ.Theorem 9Let x be a feasible solution ofLOCOMFthen there exists a solution (x, z, u, v, ζ, w, t, θ) forMFOMPλsuch that their objective values are equal. Conversely, if (x, z, u, v, ζ, w, t, θ) is a feasible solution forMFOMPλthen x is a feasible solution forLOCOMF. Furthermore, if K satisfies Slater condition then the feasible region of the continuous relaxation ofMFOMPλalso satisfies Slater condition andρλ=ρ^λ.Letx¯=(x¯1,…,x¯p)be a feasible solution of LOCOMF. Then, it satisfiesx¯j∈K,for allj=1,…,p. Letuij=∥x¯j−ai∥τ,based in (24) and (25),∥x¯j−ai∥τcan be represented by{vijk=|x¯jk−aik|,vijkr=ζijksuijr−s,∑k=1dζijk=uij,ζ≥0.Fori=1,…,n,j=1,…,pandk=1,…,d,we denote byti=minℓ∥x¯ℓ−ai∥τandzij={1,ifminl∥x¯l−ai∥τ=∥x¯j−ai∥τ,0,otherwise.Observe that if it would existj′∈{1,…,p}such that j′ ≠ j andminl∥x¯l−ai∥τ=∥x¯j′−ai∥τthen we can choose arbitrarily any of them, because a client can be assigned to only one facility.These values clearly satisfy constraints (28)–(32) and (37)–(39).Besides, let σ be the permutation of(1,…,n)such that tσ(1) ≥ … ≥ tσ(n). Take,wil={1,ifi=σ(l),0,otherwize;andθl=tσ(l).Then the constraints (26) and (27) are also satisfied. Clearly,∑ℓ=1nλℓθℓ=∑i=1nλif˜(i)(x).Conversely, if(x¯,z¯,u¯,v¯,ζ¯,w¯,t¯,θ¯)is a feasible solution of MFOMPλthen, clearlyx¯j∈Kandx¯is a feasible point of LOCOMF.Consider the continuous relaxation of problem (MFOMPλ). Suppose that K satisfies Slater condition. Take xjfor allj=1,…,p,in the interior of K. Setθ=4M+1ℓ,ti=3Manduij=2Mforℓ,i=1,…,nandj=1,…,pwith M > >0 large enough. Then, for any zij, wiℓ ∈ [0, 1] we get that the set of inequality constraints satisfies{θℓ−ti+UBi(1−wiℓ)>0,i=1,…,n,ℓ=1,…,n,θℓ>θℓ+1,ℓ=1,…,n,ti−uij+UBi(1−zij)>0,∀i=1,…,n,j=1,…,p,uij>∥xj−ai∥τ,∀i=1,…,n,j=1,…,p.This proves that the continuous relaxation of MFOMPλsatisfies Slater condition.By the above arguments, optimal solutions and optimal values of both formulations coincide.□To illustrate the applicability of the above formulation, in the following we have applied it to an instance of 10 demand points extracted from the 50-points data set by Eilon et al. (1971):(9.46, 9.36), (7.43, 1.61), (6.27, 3.66), (5.00, 9.00), (2.83, 9.88), (2.20, 1.12), (1.90, 8.35), (1.68, 6.45), (1.24, 6.69), (0.75, 4.98).Forp=3,τ=75andλ=(2.25,1.70,1.14,1.11,1.06,1.03,1.01,1.01,1.00,1.00),we get the solutionsx1*=(6.19,1.58),x2*=(5.00,9.36),andx3*=(1.44,6.55),with optimal objective valuef*=30.1460. Fig. 3shows the demand points (filled dots), solutions (filled triangles) and the allocation of the demand points to the facilities (dashed lines).An interesting observation that follows from Problem (MFOMPλ) is that the unconstrained version of the location problem is an appealing mixed integer nonlinear program. Observe that the only set of nonlinear constraints that appear in (MFOMPλ) is (31). However, (31) can be written equivalently as a polynomial number of second order cone constraints, according to Lemma 2. This way, Problem (MFOMPλ) becomes a mixed integer nonlinear program with lineal objective function and only linear and second order cone constraints, although with two sets of binary variables, namely w and z. Nevertheless, there are nowadays general purpose solvers, as Gurobi, Cplex or Xpress, that implements exact B&B algorithms for this type of problems and that are rather efficient.Remark 11Assume that the hypothesis of Theorem 9 are satisfied. In addition, any of the following conditions hold1.gi(x) are concave fori=1,…,mand−∑i=1mμi∇2gi(x)≻0for each dual pair (x, μ) of the problem of minimizing any linear functional ctx on K (Positive Definite Lagrange Hessian (PDLH)).gi(x) are sos-concave on K fori=1,…,mor gi(x) are concave on K and strictly concave on the boundary of K where they vanish, i.e.∂K∩∂{x∈Rd:gi(x)=0},for alli=1,⋯,m.gi(x) are strictly quasi-concave on K fori=1,…,m.Then, applying (Blanco et al., 2014b, Theorem 4) to the formulation of Problem (MFOMPλ), we get that there exists a constructive finite dimension embedding, which only depends on τ and gi,i=1,…,m,such that the problem is mixed-integer SDP representable.From the above observation to solve Problem MFOMPλefficiently we have combined a branch-and-bound approach over a mixed integer nonlinear program. In that approach, one may provide two types of lower bounds in the nodes of the branching tree: a continuous relaxation and a SDP relaxation based on a hierarchy of SDP “a la Lasserre”. Clearly, the first type of bounds are only possible if in each node of the tree the continuous relaxation of MFOMPλsatisfies Slater condition. This is ensured in Theorem 9.The consequence of the above transformation is that one can easily put this family of problems in commercial solvers and then to get solutions without going to painful ad hoc implementations that may be problem dependent. We illustrate this approach in our computational experiments in Section 5.Finally, we conclude this section providing some results concerning the second type of lower bounds, based on a SDP hierarchy, that can be used to approximate to any degree of accuracy the solution of the problem as well as within the branch and bound framework at each node of the branching tree.Lety=(yα)be a real sequence indexed in the monomial basis (xβzηuγvδζκwψtτθϑ) ofR[x,z,u,v,ζ,w,t,θ](withα=(β,η,γ,δ,κ,τ,ψ,ϑ)∈Npd×Nnp×Nnp×Nnpd×Nn2×Nn×Nn×Nnpd). Denote bynv1=d+np(d+2)+n2+2n+npdthe number of variables in the extended formulation of the problem.Leth0(θ):=∑ℓ=1mλℓθℓ,and denote ξj≔ ⌈(deg gj)/2⌉ and νj≔ ⌈(deg hj)/2⌉, where{g1,…,gnK},and{h1,…,hN}are, respectively, the polynomial constraints that define K andK^∖Kin MFOMPλ. Forr≥r0:=max{maxk=1,…,nKξk,maxj=0,…,Nνj},introduce the hierarchy of semidefinite programs:Q1rinfyLy(pλ)s.t.Mr(y)⪰0,Mr−ξk(gk,y)⪰0,k=1,…,nK,Mr−νj(hj,y)(⪰=)0,j=1,…,N,y0=1,with optimal value denotedinfQ1r(and min Q1rif the infimum is attained). The reader may observe that some of the localizing constraintsMr−νj(hj,y)in Q1rare linear matrix equations since the families of constraints (33)–(35) contain several equations. This is indicated in Q1rby our notationMr−νj(hj,y)(⪰=)0. Next, based on Proposition 1 and (Lasserre, 2009b, Theorem 6.1) we can state the following result.Theorem 12LetK^⊂Rnv1(compact) be the feasible domain of ProblemMFOMPλ. Let infQ1rbe the optimal value of the semidefinite programQ1r. Then, with the notation above:(a)infQ1r↑ρλ as r → ∞.Letyrbe an optimal solution of the SDP relaxationQ1r. IfrankMr(yr)=rankMr−r0(yr)=φthenminQ1r=ρλand one may extract φ points(x1*(k),…,xp*(k),z*(k),u*(k),v*(k),ζ*(k),w*(k),t*(k),θ*(k))k=1φ⊂K^,all global minimizers of theMFOMPλproblem.One of the drawbacks of using hierarchies of SDP problems to approximate the solution of our original multifacility location problem (MFOMPλ) is the dimension of the SDP objects that must be used when the relaxation order increases. The size of the matrices to be considered in the SDP problems that have to be solved grows exponentially with the relaxation order. Significant reductions in the sizes of the problems to be solved can be performed by exploiting the sparsity and symmetry that appear in the location problem. On the one hand, at times the number of variables that appear in the polynomial constraints of (MFOMPλ) can be separated in blocks so that only some of them appear together in some constraints. In those cases the SDP variables to be used can be simplified and thus, the sizes of the moment and localizing matrices are dramatically reduced. The application of this result requires the so call running intersection property (see Lasserre, 2006) that easily applies in this case. On the other hand, the invariance of this problem under the action of the symmetric group applied to the indices of the facilities (j) allows to adapt the results by Riener, Theobald, Andrén, and Lasserre (2013) to reduce the dimensionality of the matrices that appear in the hierarchy of SDP (Q1r) that converge to the optimal solution. The interested reader can find all the details of the application of the dimensionality reduction based on sparsity and symmetry for multifacility location problems by Blanco, Puerto, and El-Haj Ben-Ali (2014a). Combining both approaches helps to solve some problems.We have performed a series of computational experiments to show the efficiency of all the proposed formulations and approaches. The SOCP (LOCOMF-NI) and the mixed integer SOCP (MFOMPλ) formulations have been coded in Gurobi 5.6 and executed in a PC with an Intel Core i7 processor at 2x 2.40 GHz and 4 GB of RAM. We have applied our formulations to the well-known 50-points data set by Eilon et al. (1971) by considering different number of facilities, norms and weights. In particular we have considered the number of facilities to be located, p, ranging in {2, 5, 10, 15, 30} and τ (the norm) in{32,2,3}. We have run both the unconstrained non-interchangeable LOCOMF-NI model and the single-allocation model MFOMPλ. For the non-interchangeable model we have considered random λ and μ weights (fulfiling the conditions described in (3)). Table 1reports our results on these experiments. There, we report the average CPU times of 5 different random instances for each problem (when fixing p and τ).For general single-allocation multifacility problems, we have consider three of the most classical multifacility models that fit within the ordered median formulation when particular λ weights are chosen: p-median problem, p-center problem and p-k-centrum problem (withk=0.5n=25). In Table 2we report the overall CPU times needed to solve the problems and the optimal solutions provided by Gurobi (f*). These optimal values are important to test accuracy of solutions for future authors that wish to compare new approaches to solve these problems.We observe that the bottleneck for solving (MFOMPλ) is the existence of binary variables (z and w), since otherwise it would be solvable in polynomial time. Due to the high running time, optimality could not be ensured for some instances. In order to ease the resolution some improvements can be done via some preprocessing and fixing binary variables based on a geometric branch and bound phase. This preprocessing is effective whenever the dimension of the space of variables in low, namelyd=2,3.Finally, to illustrate the use of the hierarchy of problems Q1r, we have applied to the same data set by Eilon et al. (1971) the SDP relaxation Q12 for p-median problems with Euclidean distances. Implementation was done in SDPT3. The results are detailed in Table 3. The reader can observe that the results obtained with this approach (in terms of accuracy) are good although we could no certify optimality since the rank condition was not satisfied. Moreover, the running times are considerably higher (by several orders of magnitude) than those needed for similar problems solved with the MISOCO implementations in Gurobi.

@&#CONCLUSIONS@&#
We propose a novel, effective mixed integer nonlinear programming formulation for the continuous multifacility ordered median location problem for any ℓτ-norm and in any dimension. This formulation provides a unified approach for dealing with a broad family of multifacility location problems which up to now were usually solved only for some special cases and usually in low dimension. We also provide lower bounds for the nodes of the branching tree based on a hierarchy of SDP relaxations “a la Lasserre”. A simpler class of multifacility (multiple-allocation) location problems is also analyzed for which optimal solutions are obtained by a continuous SOCP formulation.