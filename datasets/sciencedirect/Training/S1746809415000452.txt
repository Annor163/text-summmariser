@&#MAIN-TITLE@&#
Fetal ECG enhancement: Adaptive power line interference cancellation based on Hilbert Huang Transform

@&#HIGHLIGHTS@&#
An adaptive PLI canceller based on Hilbert Huang Transform, IPRAC, is proposed.It is compared with high performance adaptive, and EMD based algorithms.The evaluation considers three scenarios: variable/fixed PLI frequency (and harmonics).IPRAC shows the best results in all scenarios.It preserves abdominal fetal ECG morphology being appropriate for fetal monitoring.

@&#KEYPHRASES@&#
Hilbert Huang Transform,Power line interference,Abdominal signals,Fetal electrocardiogram,Adaptive filtering,

@&#ABSTRACT@&#
In this paper the fetal electrocardiogram (fECG) enhancement in abdominal recordings acquired by electrodes placed on the maternal belly is considered, a new algorithm being proposed to remove the power line inference (PLI). Typically, PLI affects the evaluation of physiological signals, e.g., (fECG), for diagnostic purposes, therefore different hardware and software approaches to reduce/remove it from biomedical measurements have been proposed, some considering even the case of very low energy physiological signals. The remaining PLI still impairs the analysis of the signal of interest in some specific cases like fetal monitoring, where the morphology of fECG is essential. This paper proposes an adaptive filter based on Hilbert Huang Transform (HHT) to remove both the PLI fundamental frequency and its harmonics from the abdominal recordings, allowing the further fECG processing. The proposed algorithm, the Internal Powerline Reference Adaptive Canceler (IPRAC), shows very good performance in PLI cancellation without affecting the fECG morphology. The IPRAC performance is evaluated on both real and simulated signals including also the worst case scenario when the PLI signal does not have an absolutely constant fundamental frequency. It outperforms two recently investigated algorithms as proved by the evaluation of four different quantitative performance indexes analyzed in this study.

@&#INTRODUCTION@&#
The Power Line Interference (PLI) is one of the most common type of noise encountered in bio-potential measurements. It contaminates the physiological measurements entering through different inductive and capacitive paths, i.e., magnetic induction due to a variable magnetic field, and parasite capacitive coupling with the body and the measurement leads, respectively [1]. A common hardware solution to reduce the PLI is to use differential recording with instrumentation amplifiers having very high common mode rejection ratio (CMRR) and very high input impedance; an additional improvement can be achieved by twisting the electrode leads. However, the measurements are still contaminated by PLI since any slight difference between the electrodes impedances leads to an imbalance of the PLI at the differential inputs [1,2].Moreover, there are some aspects which make the PLI cancellation either by hardware or by software techniques even more complex: (i) besides the fundamental frequency, e.g., in Europe 50Hz) the PLI contains also harmonics generated usually by nonlinear loads connected to the power line grid (mainly odd harmonics [3–7]). The bio-potentials have generally frequency bandwidths that overlap the PLI frequencies: e.g., the QRS complex of the ECG signal has the most relevant information at about 10Hz [8], but when abnormal ECG morphologies appear, i.e., biphasic/fragmented QRS, the ECG spectra goes to higher frequencies [9–11]; the American Heart Association (AHA) recommends that the ECG signal acquired for diagnostic purposes should be recorded up to 150Hz for adults and 250Hz for neonates [12]. Therefore, it is mandatory to remove the PLI fundamental frequency and its harmonics; (ii) the PLI signal is usually non-stationary, i.e., the fundamental frequency is not exactly 50Hz at any time, showing variations. These variations are limited to 1%, but very often deviations up to 3% are reported [13–15] (the limit of the deviations differs from country to country, depending on the available power supply technologies).The residual PLI that remains after applying the available PLI cancelling methods is high enough to disturb measurements of very low amplitude, e.g., bio-potentials like fetal electrocardiogram (fECG) or electroencephalogram (EEG). When the fECG is analyzed, PLI affects sometimes the correct estimation of the RR intervals or may lead to wrong fECG delineation [16]. Moreover, it may disturb the fECG morphology, that was recently proposed to extract new information about the health state of the fetus [17–19].Most commonly, PLI is rejected by using analogue and digital fixed-frequency notch filters [20,21]. However, these filters have a fundamental limitation, i.e., a narrow band is necessary to remove only the PLI with minimum distortion of the signal of interest, making them inappropriate when PLI frequency deviations appear.There are many other methods based on different concepts for PLI cancellation from bio-potential measurements, and a recent review evaluates their performances on simulated data [22]. However, they all have limitations, from inability to track the PLI frequency deviation to introduced ringing effects and long transient time.Adaptive filters have the advantage that they are able to track the frequency changes in the PLI. Widrow et al. are the first who used them to reduce the noise in biomedical applications [23]. Since then, several adaptive filters configurations are proposed in the literature, the least mean square (LMS) algorithm with variable step size introduced in [24] showing faster convergence rate and smaller mean square error. In [25], the authors developed an improved version of the basic adaptive noise canceller (ANC) which suppresses also the harmonics with a minimal increase in computational complexity. All these methods use external PLI reference; however, it is more convenient to have the reference signal generated internally. An ANC with internal noise reference is proposed in [26], which is later improved by Martens et al. [27]. Recently, a new LMS based ANC is introduced, which minimizes the mean-squared-error (MSE) between measured ECG and the estimated PLI, over a small window [28]; its performance is compared with the performance of the algorithm proposed in [27], showing poorer results when the frequency deviation is constant.The current paper proposes a LMS ANC algorithm based on Hilbert Huang Transform (HHT), to remove the PLI from abdominal signals, allowing thereafter the fECG extraction. The HHT is used to derive the instantaneous PLI fundamental frequency directly from the measured signal, i.e., no external reference is needed. More precisely, a band pass filter is applied on the recorded signal to isolate it and then the HHT is applied in order to decompose the signals into IMFs and to extract the instantaneous PLI frequency which is further used to estimate the reference PLI components. In this way, a very good PLI estimate is obtained, making the ANC to converge rapidly even when variations of the PLI frequencies appear, which lead to overall short transient times. The performance of the proposed algorithm is compared with the performance of two relevant conceptually different algorithms described in [27,29], respectively: (i) an ANC that removes the PLI fundamental frequency and its harmonics, the Improved Adaptive Canceller (IAC) and (ii) an EMD based algorithm, the EMD canceller (EMDC).The HHT was introduced in [30,31], and is effective in analyzing non-stationary data. It consists of two stages: (i) EMD and (ii) the Hilbert analysis (Hilbert spectrum). The EMD is used to decompose any complicated data in finite and small number of oscillations, the so-called “intrinsic mode functions” (IMFs), which admit well – behaved Hilbert transform [30]. This decomposition is based on the local characteristics of the data on time scale, and is therefore adaptive allowing the method to be applied on non-stationary processes. The second stage is used to construct an energy–frequency–time distribution that lets us estimate the instantaneous frequency. The HHT represents an alternative to the Fourier Transform which has some critical limitations: the system must be linear and the data must be strictly periodic or stationary, the resulting spectrum having otherwise little physical meaning [30]. On the other hand, the HHT decomposes the data into a number of IMFs based on the direct extraction of the energy associated with various intrinsic time scales, and computes the instantaneous frequency for each IMF, using the Hilbert analysis. In this way, any event can be localized both in time and frequency domain. Moreover, the IMFs can be viewed as the basis for the complete and adaptive data expansion [30]. The full energy–frequency–time distribution generated by the HHT is an important tool for the analysis of non-stationary data, usually the case of most real (bio)signal, i.e., for the fECG analysis too. The PLI fundamental frequency can vary, as shown in the introduction, which allows us to consider that PLI is non-stationary.The EMD is used to obtain the IMFs which allow the identification of the instantaneous frequencies under the following assumptions: (i) at any point the mean value of the envelope determined by the local maxima and the envelope determined by the local minima is zero, and (ii) the number of extrema and number of zero crossings must be either equal or differ at most by one [30].The computation of the IMFs is fully data driven, they being obtained by decomposing the data (the process is called “sifting” process) using the EMD algorithm which has the following steps:(a)find all the local maxima and minima of the data;construct the upper and lower envelopes by cubic spline interpolation of the local maxima and local minima, respectively;find the zero crossing;for the first sifting process, the mean of the upper and lower envelops, m1(t), is determined and subtracted from the original time series x(t) as in (1):(1)p1(t)=x(t)−m1(t)1.If p1(t) satisfies the conditions of the IMF, then p1(t) is the first frequency and amplitude modulated oscillatory mode, IMF1.If p1(t) does not satisfy the conditions of the IMF, then steps (a–c) are repeated for p1(t); thus, p1,1(t) is obtained:(2)p1,1(t)=p1(t)−m1,1(t)The steps are iterative and after k cycles the IMF is obtained:(3)p1,k(t)=p1,k−1(t)−m1,k(t)Thus, the first IMF component from the original data is obtained, c1(t)=p1,k(t).The obtained IMF is subtracted from the original data, leading to the residual component r1(t):(4)r1(t)=x(t)−c1(t)r1(t) is considered to be the original data in the next cycle. The above steps are repeated for l times, where l is the number of IMF plus the residue rl(t). In order to guarantee that the IMFs retain enough physical meaning, a stopping criterion is necessary for the sifting process. Such a stopping criterion, (5), is defined in [30] and is based on the standard deviation computed for two consecutive sifting results:(5)SD=∑t=0T|p1,k−1(t)−p1,k(t)|2p1,k−1(t)2The sifting process stops when the SD is within a predefined range. Typical values for SD are 0.2–0.3 [30].The data can be reconstructed from its IMFs as following:(6)x(t)=∑i=1lci(t)+rl(t)The sifting process described above has two purposes: to eliminate the ridding waves and to smooth the amplitudes, i.e., to make the wave-profiles more symmetric.From the mathematical considerations of the EMD it can be observed that high frequency components are decomposed into the first IMFs while the low frequencies are identified in the higher order IMFs.The Hilbert transform is applied on each IMF, (7), leading to the instantaneous frequency:(7)y(t)=1πP∫−∞∞x(t)′t−t′dt′where P indicates the Cauchy principal value and x(t) is an IMF [30]. Then the analytical signal z(t) is constructed:(8)z(t)=x(t)+iy(t)=a(t)eiθ(t)with(9)a(t)=x(t)2+y(t)2,θ(t)=arctany(t)x(t)The instantaneous frequency is thereafter obtained by (10):(10)ω(t)=dθ(t)dtFinally the original data can be reconstructed:(11)x(t)=∑j=1laj(t)e∫ω(t)dtEq. (11) resembles the Fourier transform except that the amplitudes and the frequencies are not constant anymore. The variable amplitude, aj(t), and the time-varying instantaneous frequency ω(t), enables HHT to investigate non-stationary data. The frequency–time distribution of the amplitude, (11), is called the Hilbert spectrum [30].As stated in Section 1 the PLI fundamental frequency can show variations; thus, simple notch filters with fixed central frequency are not efficient in removing the interference. The adaptive approach is able to overcome this limitation. However, the classical adaptive noise canceller (ANC) requires that (i) the reference signal is recorded simultaneously with the signal of interest and (ii) the noise and signal are uncorrelated, but (iii) the reference noise is correlated with the noise from the signal, these assumptions being valid for the PLI cancellation problem in fECG monitoring. The PLI signal and the abdominal fECG signal are uncorrelated because they have totally different sources. The drawback of the classical ANC approach is the recording of an additional disturbing signal, i.e., the reference signal. A new simple and robust adaptive noise canceller algorithm, with internal generated reference signal, Internal Power line Reference Adaptive Canceler – IPRAC, is proposed for suppressing the 50Hz and its harmonics from abdominal fECG signals. The block diagram is given in Fig. 1.The algorithm consists of two important blocks: (i) the estimation of the PLI fundamental frequency and the construction of the reference signal and (ii) the adaptive algorithm that minimizes the difference between the PLI reference and the signal, canceling the PLI.In order to obtain a data driven reference signal the following steps are considered: (i) a Butterworth bandpass filter with the band pass 47–53Hz is applied. The bandwidth is wide enough to include possible variations of the PLI fundamental frequency; (ii) next, the HHT is applied to estimate the instantaneous fundamental frequency which is further used to construct an estimate of the fundamental PLI component. Once the instantaneous frequency,ω˜50(n), is obtained, the internal reference signal can be computed (12):(12)z˜(n)=sin(ω˜50(n)×n)+sin(3×ω˜50(n)×n)The adaptive algorithm proposed for the IPRAC to cancel the estimated PLI is the LMS algorithm, defined by the following equations, considering a filter of order k and adaptation step size μ:(13)z˜n=[z˜(n),z˜(n−1),z˜(n−2),…,z˜(n−k+1)]T(14)wn=[w0(n),w1(n),…,wk−1(n)]T(15)z¯(n)=∑i=0k−1wi(n)z˜(n−i)=wnT·z˜n(16)e(n)=s(n)−z¯(n)(17)wn+1=wn+μe(n)z˜n*where n=0, 1, 2, …, N, is the current samples, N≥k, s(n)=d(n)+z(n) is the observation vector (d(n) is the desired signal, i.e., the fECG signal and z(n) is the noise, i.e., PLI),z˜nis the internal reference, i.e., the input vector,z˜n*is the complex conjugate of the input vector, wnis the vector of filter weights,z¯(n)is the filtered output and the optimal estimate of z(n), e(n) is the error (see Fig. 1).The simulated data used to evaluate the performance of the proposed IPRAC algorithm are generated by the algorithm described in [22] which consists of two steps. Firstly, the fECG is simulated using the dynamic model introduced in [32] and defined by (18):(18)x˙=αx−ωyy˙=αy−ωxz˙=−∑iαiΔθie−(Δθi2/2bi2)where ω is the angular velocity of the time vector as it moves around the limit circle (representing the period T),α=1−x2+y2, Δθi=θ−θi, θ=arctan(y/x); aicontains the amplitudes of the fECG waves, bicontains the widths of each wave, and θiare the angles which specify the P-, Q-, R-, S-, T-waves/peaks.Secondly, the PLI components simulated as sinusoids are added. Hence, three data sets are constructed, (19), considering three PLI scenarios: (i) the PLI contains just the PLI fundamental frequency, of 50Hz, (ii) the PLI includes both the PLI fundamental frequency and its 3rd harmonic (150Hz), and (iii) the PLI is a sinusoid whose frequency slightly varies in time around 50Hz.(19)PLI(n)=A1·sin2πf1fs·n,idealcaseA1·sin2πf1fs·n+A3·sin2π3f1fs·n,A3=13A1,A1·sin2πf1±pfs·nwhere n=0, 1, 2, ..., N, is the current sample, f1=50Hz, fs=1000Hz is the sampling frequency and p∈[0−1, 5].It is clear that the worst scenario is the third one, assuming that the power line fundamental frequency is time-varying.For each scenario, the SNR defined by (20) is varied; five noise levels are considered: −2dB, 0dB, 2dB, 4dB and 5dB:(20)SNR=10log10PfECGPPLI=log10∑n=1nfECG(n)∑n=1nPLI(n)The real data are recorded with the MP150 Biopac system using a configuration of 10 electrodes placed on the maternal abdomen; the sampling frequency is 1000Hz and the A/D resolution is 16 bits, a segment of a recorded abdominal channel being depicted in Fig. 2. It can be observed that the PLI signal is very strong, only the maternal ECG (mECG) being barely detectable, this signal having usually an amplitude ten times greater than that of the fECG [33].For the qualitative evaluation of the implemented algorithms, the performance indices proposed in [22] are used:(a)noise retention, expressed in percentage [29]:(21)NR=Porig_fECG−Pest_fECGPorig_fECG×100where P is the power of the signal computed:(22)Porig_fECG=10×log10∑n=1Norig_fECG(n)2SNR improvement:(23)SNRimp=10log10∑n=1N(signal(n)−orig_fECG(n))2∑n=1N(est_fECG(n)−orig_fECG(n))2where signal is the input signal containing both the fECG and the PLI.cross-correlation coefficient, considering the original and the denoised fECG signal:(24)p=∑n=1N(est_fECG(n)×orig_fECG(n))∑n=1N(est_fECG(n)2×∑n=1N(orig_fECG(n)2normalized root mean square error, expressed in percentage:(25)RMSD=∑n=1N(origfECG(i)−estfECG(n))2∑n=1NorigfECG(n)2×100

@&#CONCLUSIONS@&#
In this paper a PLI cancelling algorithm is proposed to clean the abdominal signals, allowing then the fECG processing. It is based both on the HHT and the adaptive noise canceller. The fECG signal, available in the abdominal recordings measured on the maternal abdomen is usually contaminated by different noise sources, the extraction of important fECG features for diagnostic purposes being thus impaired. Moreover, the fECG itself is a non-stationary physiological signal and the PLI signal usually presents also a non-stationary behavior. Hence, an adaptive approach based on a fully data driven processing is mandatory. In comparison to the Fourier or Wavelet transform, the HHT computes its basis expansion, the set of IMFs, from the signal itself, using the data driven sifting process described in Section 2. The proposed adaptive noise canceller is able to generate an internal PLI reference signal used to adaptively cancel the PLI. Thus, the limitations of classical ANC are overcome, the obtained results showing that the IPRAC algorithm is able to adapt very fast to the variations of the PLI fundamental frequency.The performance of the IPRAC algorithm is evaluated on three different simulated datasets which include the best case scenario when the PLI signal has a constant fundamental power line frequency equal to 50Hz, and the worst case scenario when the harmonics are present or the fundamental power line frequency varies. In all scenarios the SNR is varied having the following values: −2dB, 0dB, 2dB, 4dB, and 5dB. Four indexes are defined, all showing that the proposed algorithm is very effective in all the scenarios. Hence, the IPRAC algorithm is able to track the changes in the fundamental power line frequency and efficiently removes the PLI interference from the abdominal fECG signal. Its performance is compared to the one showed by the IAC and EMDC algorithms. The IAC algorithm, based on an adaptive filter as the IPRAC, has the worst performance for all scenarios and all noise levels, as depicted in Figs. 3–6. Particularly in the worst case scenario defined by variable PLI fundamental frequency IAC has low performance not being able to track efficiently the changes in the fundamental frequency; thus, the IAC algorithm is not suitable for real applications (Figs. 3–6).Regarding the EMDC algorithm, it shows good results for scenarios 1 and 2, but its performance indexes have atypical variation with the noise level: the best performance is unexpectedly obtained for a very high noise level and goes down when the noise level decreases. The EMDC algorithm cancels the PLI by firstly decomposing the input signal using the EMD, then by discarding the IMF containing the PLI signal, usually the first one, and finally by reconstructing the cleaned signal summing up the remaining IMFs. However, the EMD decomposition is not able to efficiently separate just the PLI signal into the first IMF. Thus, important QRS information can still remain in the first IMF, being removed with the discarded IMF, when obtaining the cleaned signal. A possible explanation for the atypical behavior of the EMDC performance is that when very high noise level exists, the PLI signal is better separated into the first IMF, due to the sifting process, leading to good fECG signal estimation. For low SNR levels the first IMF including the fundamental PLI frequency contains more QRS information and the EMDC is not efficient in extracting and including this information in the reconstruction step and thus, a worse estimated fECG is obtained.However, the IPRAC algorithm uses the IMFs only in order to obtain the instantaneous frequency; the identified PLI frequency is further used to generate an internal reference signal for the adaptive filter. In scenarios 1 and 2, noise level −2dB, IPRAC is slightly outperformed by the EMDC, while for noise level 0dB they show similar results for scenario 1 and IPRAC outperforms EMDC for scenario 2. Thus, when very high PLI levels are present, even if the IPRAC estimates accurately the PLI frequency, the PLI amplitude is not very efficiently adapted, the adaptive filter showing slower convergence speed than for the low PLI levels case. For the rest of the SNR levels, the IPRAC clearly outperforms both algorithms. Most importantly, for the worst case scenario, i.e., scenario 3, the IPRAC algorithm is able to accurately track the changes in the PLI fundamental frequency, obtaining the best results for all noise levels, as compared to the obtained IAC and EMDC performance.The IPRAC algorithm is also validated on real abdominal signals; Figs. 7 and 8reveal that the PLI interference including the 150Hz harmonic is completely removed, enabling the analysis of the fECG morphology.The obtained results encourage the use of noninvasive abdominal recordings in fetal monitoring, the fECG acquired by electrodes placed on maternal wall being a more attractive alternative as compared to the invasively recorded fECG, using an electrode placed on the fetus scalp only after the rupture of the membrane. The noninvasive aspect is just one advantage of the abdominal fetal monitoring, the method being also quite suitable appropriate for long-term fECG monitoring.