@&#MAIN-TITLE@&#
Detection of pathologic liver using ultrasound images

@&#HIGHLIGHTS@&#
Identification of steatosis through three distinct approaches.We show that it is possible to detect fatty liver using classifiers with a reduced number of features.We prove that the hepatorenal coefficient and the attenuation coefficient are capable to successfully discriminate steatotic from normal livers.Our methodologies could be also used to detect the degrees of steatosis useful for analyzing its evolution over time.

@&#KEYPHRASES@&#
Classification,Feature selection,Steatosis,Attenuation coefficient,Hepatorenal coefficient,Liver,

@&#ABSTRACT@&#
Fatty liver or steatosis is a pathology characterized by fat accumulation in the liver cells. Ultrasound is the most common technique used for its evaluation, however the diagnosis is strongly dependent on the physician's expertise and system settings. These drawbacks have motivated the development of procedures for the quantitative analysis of ultrasound images to help the steatosis diagnosis. In this work, three approaches are presented and tested with human liver images. The first one addresses textural analysis of the hepatic parenchyma using five classifiers, 357 features, a feature selector, and classifiers fusion. Its performance is measured by two parameters: accuracy and area under the ROC curve. The second makes use of the hepatorenal coefficient followed by a statistical analysis to discriminate echogenicity differences between liver and kidney. The third is based on the acoustical attenuation coefficient evaluated over a line traced in the images with parallel orientation to the acoustical beam. The use of classifiers fusion has provided better results (accuracy of 0.79), when compared with the performance of the best one considered alone (0.77 for ANN). The hepatorenal coefficient proved to be a good parameter for steatosis detection with calculated sensitivity and specificity of 0.90 and 0.88, respectively. It was observed the hepatorenal coefficient is not influenced by the ultrasound machine parameters. The attenuation coefficient provided lower sensitivity and specificity values than the ones from the hepatorenal coefficient.

@&#INTRODUCTION@&#
Technological advances in the last decade have provided the growth of two important concepts: computer vision and image processing. The combination of these two concepts enabled the development of new tools capable to provide additional information. The medical area has benefited from those technological advances. For instance, the diagnosis of liver diseases has been improved by using image processing techniques, greatly contributing for a more effective evaluation of steatosis, which is characterized by fat accumulation in liver. Fatty liver tissue is potentially risky as it might lead to untreatable diseases, namely steatohepatitis, cirrhosis or hepatocellular carcinoma [1]. Biopsy is the most effective technique used to detect those diseases, however it is invasive and uncomfortable for the patients [2,3]. Should detected at an early stage steatosis can be reversed, which strengthens the need for an effective diagnosis and treatment [4,5].Several computer-aided diagnosis (CAD) systems have been applied for assisting physicians in the early detection and characterization of pathologies in organs as the liver, breast, thyroid and lungs, using ultrasound images [6,7]. The CAD systems may be assisted by segmentation methods to identify not only the hepatic region, but also the heart cavities [8–10], lungs [11–13] and also vascular or neural structures from the eye [14,15].Ultrasound is the most used technique in steatosis evaluation. However, ultrasound images are susceptible to misinterpretation and some subjectivity, which has justified the development of methods capable of processing the data provided by that technique [16]. Unlike the computed tomography, which uses the Hounsfield units the ultrasound images do not have an absolute quantitative reference as the pixels may not have the same values for images acquired by different equipments (using a higher/lower gain (more/less bright pixels). To overcome this difficulty a qualitative analysis is done based on the comparison between the liver echogenicity and the surrounding organs as the kidney, spleen and pancreas [17,18]. In a normal liver the echogenicity is equal to or slightly greater than the echogenicity of the renal cortex and spleen. The main changes in ultrasound images by steatosis are expressed by:-Higher hepatic parenchymal echogenicity than the renal cortex and spleen due to the greater number of intracellular deposits of fat in the liver;Higher attenuation as the ultrasound wave goes deeper, producing poor visualization of the diaphragm and weak intrahepatic delineation;Portal and hepatic veins presenting lower details as a result of the compression caused by excess fat [18–21].The steatosis diagnosis by visual analysis has a strong subjectivity, due to the following difficulties. First, changes in the echogenicity of structures used for comparison (kidney and spleen) can occur, because they are also prone to diseases. Second, intra-observer and inter-observer variability always exists in diagnoses. Third, variations in the ultrasound machine parameters give rise to different levels of echogenicity. Also, the occasional irregular distribution of fat in the liver parenchyma can lead to misinterpretation [18].This work aims to overcome the subjectivity occurring when analyzing the hepatic regions as well as to assist the physician in the diagnosis task. It is intended to be a medical diagnosis complement working as an important images analysis tool. The proposed methodology is different from traditional methods since it uses a large number of features and several classifiers, including fusion of classifiers, complemented with a features selector to enhance the most important features.For the present work a large number of echographic images were collected by expert physicians using an ultrasound machine (GE Logic E9) and a 4MHz convex probe. The images were acquired with a resolution of 8 bits (256 grayscale levels), then converted to high quality (low compression) JPEG format in order to reduce their size, with 720×960 pixels, and then analyzed by MATLAB. The patients agreed with the use of images for research purposes by a written permission.A first dataset corresponds to 120 patients, where the images were singly adjusted by changing the overall gain and the time gain compensation (TGC) to achieve the best contrast. Two expert physicians analyzed the images and classified them as normal (68) and steatotic (52) livers.A second dataset is composed by 42 images (two for each patient), where the parameters overall gain (set to 60) and TGC (set to 10) were kept unchanged. For each patient, an image was collected according to the sagittal plane for the hepatorenal coefficient calculation, and the other one acquired from an intercostal space for the attenuation coefficient evaluation and textural analysis. From this dataset, 22 were classified as having steatosis and the remaining 20 were considered normal.For the experimental study, large hepatic regions were delineated by physicians. Whether normal and pathological regions exist in the same image they are labeled accordingly. Then, small regions of interest (ROIs) were automatically selected within those large regions. The number of ROIs varies with the size of each one and the size of the selected regions.

@&#CONCLUSIONS@&#
This work focused on the identification of steatosis through three distinct approaches. The first one included the extraction of features followed by the implementation of five classifiers and two classifiers fusions, whose performances were evaluated by using a reduced number of features (much lower than the initial 357 features) obtained by the feature selection technique, considering the first images dataset, and two parameters: accuracy and area under the curve (AUC). The obtained results showed that the use of a large number of features are not directly related to additional improvements in the classifiers performance. The ANN classifier provided the best performance with an accuracy of 0.77 and an AUC of 0.82 using the best 12 features. On the other hand, the classifiers fusion using the weighted vote gave rise to an accuracy of 0.79 and an AUC of 0.84, for the best 18 features.The same methodology was also applied to the second set of images and the results were very promising. Thus, the best performance was obtained for a combination of 38 features resulting in an accuracy of 0.86 and an AUC of 0.93 for the SVM. This showed the importance of keeping the equipment configuration parameters unchanged for reliable textural analysis. It is important to refer those results are higher than ones presented in the literature using the same classifiers [44–46].The three different best feature sets used in this work, as a result of the feature selector application are within the expected, i.e., ranging from 10 to 30. For the second dataset the best result was 38, probably due to overfitting [47].The second method for the steatosis identification made use of the hepatorenal coefficient, which was based on the echogenicity differences between the liver parenchyma and renal cortex. This coefficient proved to be a good indicator of the steatosis, as demonstrated by the calculated AUC values of 0.94 and 0.92 for the first and second datasets, respectively. It was also shown that the hepatorenal coefficient is not influenced by the ultrasound machine parameters during the data acquisition. The third method for assessing the steatosis consisted of the attenuation coefficient computation. That approach led to AUC values of 0.74 and 0.83 for the first and second datasets, respectively that are lower than the ones provided by the second method.Comparing the three methods, it can be said the third method is the one that produces the worst results. That can be justified by the approach used for its calculation (line of pixels), which certainly is influenced by the intrinsic noise of ultrasound images. Additionally, the obtained results allowed to conclude that the performance of a SVM classifier is similar to the one provided by the hepatorenal coefficient, for the second dataset. Thus, it is apparent that the second method based on pixels intensity of liver and kidney is less susceptible to the ultrasound equipment subjectivity and variability, appearing as the most effective one to be applied in a hospital scenario.It is important to note that the presented methodologies have used medical images previously selected and classified by physicians. The methods showed that the automatic steatosis evaluation procedure can give rise to results similar to the physician's ones, which is demonstrated by the high performance values achieved by them.It should be emphasize the method based on classifiers requires that the acquisition parameters be constant. This can be an important limitation because the physicians have the tendency to adjust the ultrasound machine parameters to enhance the image displaying, which can affect the classifier performance. As above mentioned that limitation can be overcome by using the proposed hepatorenal coefficient approach, since that the two concerned organs be in the same image.Concluding, it can be said the presented approaches, namely classifiers with a reduced number of features, the hepatorenal and the attenuation coefficients are all capable to successfully discriminate steatotic from normal livers. Additionally, these methodologies are innovative because of the high number of features used, which was followed by a feature selector to identify the most relevant ones that is not frequently found in similar works. Also, classifiers fusion was tested with very good results.