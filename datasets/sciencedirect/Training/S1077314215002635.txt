@&#MAIN-TITLE@&#
Height from photometric ratio with model-based light source selection

@&#HIGHLIGHTS@&#
New photometric stereo method that recovers surface height directly.Propose a model-based approach to selecting and removing noisy observations.Exploit photometric ratios to express height recovery as a large sparse linear system of equations.Evaluate quantitatively and qualitatively on wide range of objects including shadows and specularities.

@&#KEYPHRASES@&#
Photometric stereo,Surface integration,Non-Lambertian reflectance,Albedo estimation,

@&#ABSTRACT@&#
In this paper, we present a photometric stereo algorithm for estimating surface height. We follow recent work that uses photometric ratios to obtain a linear formulation relating surface gradients and image intensity. Using smoothed finite difference approximations for the surface gradient, we are able to express surface height recovery as a linear least squares problem that is large but sparse. In order to make the method practically useful, we combine it with a model-based approach that excludes observations which deviate from the assumptions made by the image formation model. Despite its simplicity, we show that our algorithm provides surface height estimates of a high quality even for objects with highly non-Lambertian appearance. We evaluate the method on both synthetic images with ground truth and challenging real images that contain strong specular reflections and cast shadows.

@&#INTRODUCTION@&#
Photometric stereo has a long history in computer vision [1]. In recent years it has begun to find practical application in areas such as face recognition [2,3], object capture [4,5], medical imaging [6] and surface texture classification [7]. Photometric stereo uses the intensity of reflected light under varying illumination direction to infer the orientation and reflectance properties of a surface. Usually, the only reflectance property that is estimated is the diffuse albedo, although more exotic experimental setups allow estimation of additional reflectance properties such as specular albedo [8], surface roughness [9] and index of refraction [10].The advantages of photometric stereo are well known: observations are dense (measurements are made at every pixel and resolution is limited only by the resolution of the camera); it can be applied to smooth surfaces devoid of matchable features; estimated surfaces can be relit since both shape and reflectance properties are estimated; and it is able to recover fine scale surface detail. However, surface orientation is only a 2.5D shape representation and the estimated normal field must be integrated in order to recover surface depth or used to refine a 3D mesh captured using other cues [11]. Often, modelling errors mean that the estimated surface normals are subject to low frequency bias leading to distortion in the 3D surface and low global accuracy. Also, photometric methods are usually much more demanding in data capture terms and also in their requirement for controlled conditions.Despite sustained research effort on the topic, many methods are surprisingly still heavily based on the original approach proposed by Woodham [1]. One of the reasons for this is that Woodham’s least squares solution “averages out” errors due to inaccurate assumptions or model inaccuracies. This leads to robust performance even in the presence of significant deviations from the assumptions of Lambertian reflectance with no shadows or specularities, or when there are errors in the light source directions and intensities.A popular class of approaches that has arisen in the past decade are based on selecting a subset of observed intensities for each pixel [12–15]. We refer to these as selection-based approaches. The idea is to exclude observations that are believed to deviate from the modelling assumptions made by the algorithm, for example by excluding shadowed pixels. This transforms the photometric stereo problem into one of labelling pixels according to photometric phenomena. These approaches are motivated by the fact that greater than three observations leads to redundancy which can be exploited by exclusion of noisy data. Almost all of these selection-based approaches rely on ad hoc heuristics that require careful tuning of parameters.

@&#CONCLUSIONS@&#
We have presented a photometric stereo algorithm that combines model-based selection with solving for surface height via photometric ratios. Our approach has a number of attractive properties. The selection algorithm is robust to any source of noise causing non-Gaussian deviations from the expected intensity. Our experimental results show that this is useful for detecting shadowed and specular observations. By solving in the surface height domain, we guarantee an integrable solution. Moreover, surface normals at each pixel are no longer independent since the surface gradients depend on surface height at neighbouring pixels. This introduces non-local constraints and improves robustness. Finally, our method requires only a single parameter. Even this, the threshold parameter, is a dimensionless quantity (indicating the number of standard deviations of noise that we will consider as valid observations) and is therefore easy to set (we used the same value in all of our experimental results). This means that our method does not require tuning to a particular dataset.There are a number of avenues for future work. Concerning the selection strategy, we currently make selections independently across images and then use a single cycle through the selections to form pairs. It may be better to define a criterion for a good pair and make selections pairwise. We would also like to experiment with weighting pairs to improve robustness. Our selection strategy is currently based on a very simple statistical test. In future, we intend to consider more appropriate directional distributions for uncertainty in the surface normal direction and use this to rigorously define the probability distribution for an observation. Moreover, our selection relies on a reliable initial estimate. If this is systematically biased, then the selections themselves are biased. Hence, in future we will explore whether selection and reconstruction can be combined without relying on an initial reconstruction.Concerning height recovery from photometric ratios, Eq. (6) can be made invariant to ambient illumination by introducing a third image. Specifically, the idea is to take ratios of differences between images so that the ambient term is cancelled. Although this makes the method more general, it would also be more sensitive to noise. We also believe that robustness could be improved by introducing priors such as smoothness into Eq. (12). In low albedo regions where all observations are noisy, it may be better to rely on smooth interpolation from more reliably reconstructed regions.A Matlab implementation of our algorithm and the synthetic datasets used are available from http://www-users.cs.york.ac.uk/~wsmith/HfPR.