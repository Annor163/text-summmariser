@&#MAIN-TITLE@&#
On Liu’s simplicial depth and Randles’ interdirections

@&#HIGHLIGHTS@&#
An important connection between Liu’s simplicial depth and Randles’ interdirections.Computational advantage of simplicial depth over interdirections.Basis for profitably modifying statistical procedures based on interdirections.New perspectives on multivariate sign tests.

@&#KEYPHRASES@&#
Simplicial depth,Interdirections,Multivariate,Sign tests,Computational burden,

@&#ABSTRACT@&#
At about the same time (approximately 1989), R. Liu introduced the notion of simplicial depth and R. Randles the notion of interdirections. These completely independent and seemingly unrelated initiatives, serving different purposes in nonparametric multivariate analysis, have spawned significant activity within their quite different respective domains. A surprising and fruitful connection between the two notions is shown. Exploiting the connection, statistical procedures based on interdirections can be modified to use simplicial depth instead, at considerable reduction of computational burden in the case of dimensions 2, 3, and 4. Implications regarding multivariate sign test statistics are discussed in detail, and several other potential applications are noted.

@&#INTRODUCTION@&#
In order to define affine equivariant order statistics and related quantities in the setting of multivariate data in higher dimensional space where there is no natural order, notions of depth function for the purpose of measuring centrality of pointsxinRdrelative to a given distributionFonRdhave been developed, beginning with the seminal halfspace depth of Tukey (1975). When a quite different version, the simplicial depth, was introduced by Liu (1988, 1990), it became realized that in fact there are many viable and interesting implementations of the idea of depth function. Among the many versions of depth function that have been formulated, the most prominent in current practice are perhaps the halfspace, simplicial, Mahalanobis, spatial, and projection depths. A review of depth functions with respect to structural features is provided by Zuo and Serfling (2000a), and the wide range of their methodological applications is laid out by Liu et al. (1999).In general, a depth function induces a definition of multivariate median, given by the point(s) of maximal depth. Also, corresponding quantile and rank functions are generated by the nested contours of equal centrality at levels decreasing from the “center”. Depth functions desirably are affine invariant. On the other hand, one may initially formulate some multivariate rank function and generate corresponding depth and quantile functions. For some discussion of such interrelations, see Serfling (2006a, 2010).With either a depth function or a rank function in hand, one may formulate an associated multivariate “sign test” of a hypothesized “center”θ0, either by evaluating the sample depth function atθ0, or by evaluating the sample rank function atθ0. When the depth and rank functions correspond to each other, these are equivalent. The “center” might be formulated as the multivariate median according to a particular depth notion, or as the point of symmetry according to a given notion of symmetry. With respect to the latter, we will here refer to several key notions of symmetry, elliptical symmetry, central symmetry, elliptical directions, angular symmetry, and halfspace symmetry. See Randles (2000) and Serfling (2006b) for general discussion and the following relationships:elliptical⟹central⟹angular⟹halfspace,elliptical⟹elliptical directions⟹angular⟹halfspace.Of most interest for our purposes are central symmetry, denotingX−θ0=dθ0−X, and angular (or “directional”) symmetry, denotingS(X−θ)=dS(θ−X), where=ddenotes equality in distribution andS(⋅)is the spatial sign function (or unit vector function),S(x)={x‖x‖,x≠0,0,x=0,forx∈Rd, with‖⋅‖the usual Euclidean norm.Our goal here is to establish and exploit a special relationship between the simplicial depth of Liu (1988, 1990) and the notion of “interdirections” introduced by Randles (1989) in formulating a new multivariate sign test. Specifically, we introduce an “interdirections depth” and show that it is linearly equivalent to the simplicial depth in dimensiond=2and approximately equivalent in higher dimensiond≥3. In their direct formulations, the simplicial depth and the interdirections both pose a computational burden of orderO(nd+1), which becomes quickly prohibitive asdincreases. However, for the simplicial depth, more favorable algorithms have been developed in the casesd=2, 3, and 4. Also, the simplicial depth is conceptually simpler than the interdirections. Statistical procedures based on interdirections can thus be modified to use simplicial depth instead, thereby taking advantage of more efficient computational algorithms and greater conceptual appeal, without loss of practical effectiveness. In particular, we compare the sign test introduced by Liu (1990) based on simplicial depth and the above-mentioned sign test of Randles (1989).We proceed as follows. The simplicial depth is reviewed in Section  2, along with details on its computation. The interdirections and our associated interdirections depth function are treated in Section  3. The special connection between the two depths is developed in Section  4, where also comparisons with respect to computation time are made. Several statistical procedures that use interdirections and which could profitably be modified to use simplicial depth instead are noted in Section  5, with selected multivariate sign tests for location treated in detail.Let us denote byS[x1,…,xd+1]the closed simplex inRdwith verticesx1,…,xd+1. (If the vertices are not affinely independent, thenS[x1,…,xd+1]is actually not a simplex but rather a convex object contained within ak-flat for somek<d.) Relative to a given distributionFonRd, Liu (1988, 1990) introduced the simplicial depth,DS(x,F)=PF(x∈S[X1,…,Xd+1]),x∈Rd,which associates with a pointxtheF-probability that it is covered by a random simplex whose vertices are given byd+1independent hypothetical observationsX1,…,Xd+1fromF. (For continuousF, these are affinely independent, with probability 1.) Besides its evident simplicity and conceptual appeal, the simplicial depth is easily seen to be affine invariant. The pointMFof maximal simplicial depth defines the simplicial median.Two important properties ofDS(x,F)established by Liu (1990) in the case thatFis absolutely continuous onRdand angularly symmetric aboutMFare:(a)DS(x,F)is monotone nonincreasing along rays outward fromθ,DS(MF,F)=2−d.For a sampleXn={X1,…,Xn}fromF, the sample simplicial depth is given by(1)DS(x,Xn)=(nd+1)−1∑1≤i1<⋯<id+1≤n1{x∈S[Xi1,…,Xid+1]},x∈Rd,where1{A}denotes the indicator function of the eventA. Note that, for each fixedx, the sample version is precisely a U-statistic, based on the kernel(2)hS(x;x1,…,xd+1)=1{x∈S[x1,…,xd+1]}.We denote byMnthe sample simplicial median.Asymptotic results for the sample simplicial depth and sample simplicial median are available assuming merely angular symmetry ofF. Liu (1990) shows consistency ofDS(x,Xn)for estimation ofDS(x,F), and Dümbgen (1992) and Arcones and Giné (1993) develop asymptotic distribution theory for the random function{DS(x,Xn),x∈Rd}considered as a special case of U-process. In particular, forx≠θ,DS(x,Xn)is a nondegenerate U-statistic with normal limit distribution. However, as remarked by Liu (1990),DS(MF,Xn)is a degenerate U-statistic with limit distribution a weighted sum of independent chi-square variables. Relevant asymptotic theory forMnis developed by Arcones et al. (1994) and de la Peña and Ginè (1999):n1/2(Mn−MF)→dN(0,ΓF),n→∞,for a suitable covariance matrixΓFdepending onF. (ForFstandard bivariate normal,ΓF=4πI2, showing that the simplicial median has asymptotic relative efficiency4/π=0.785relative to the sample mean, in dimensiond=2).As discussed by Liu (1990), applying properties (a) and (b), a test of the hypothesis thatFis angularly symmetric aboutθ0may be carried out in terms of the test statistic(3)Sn=2−d−DS(θ0,Xn).UnderH0,Snis a nondegenerate U-statistic as noted above. Alternatively, and equivalently, assuming angular symmetry ofF, one may test the hypothesisH0:MF=θ0using the test statistic based onMnand its asymptotic normality. However, as noted below, the computational cost ofMnis much higher than that ofSn. We further discuss these tests, in comparison with others, in Section  5.1.For efficient computation of the sample simplicial depth, key results are reviewed in Burr et al. (2006), who also treat variations on the definition of simplicial depth. In particular, ford=2, the simplicial depth of a single pointx(e.g.,θ0) can be computed inO(nlogn)time and that of allndata points inO(n2)time (see Khuller and Mitchell, 1990, Gil et al., 1992, Rousseeuw and Ruts, 1996, and Aloupis et al., 2002). In dimensionsd=3and 4,O(n2)andO(n4)algorithms are available, respectively, for computation of the simplicial depth of a single point (see Khuller and Mitchell, 1990, Gil et al., 1992, and Cheng and Ouyang, 2001). However, ford≥5, no algorithms have been developed faster than simply generating all simplices and counting the ones enclosing the given point, usingO(nd+1)time.In the case of higher dimension, a standard approach toward overcoming computational complexity is to take just a random subset of the data. Another possibility is to compute merely the “simplicial depth matrix”DS(x,X)=[DS((xi,xj),Xn(i,j))]d×dof bivariate simplicial depths taken pairwise over the components ofx=(x1,…,xd)′, which can be computed inO(nlogn)time for any fixed dimensiond. These possibilities will be explored in a separate study.Computation of the simplicial median is considerably more challenging and costly than the simplicial depth. Ford=2, Aloupis et al. (2003) provide algorithms that entail querying allO(n4)intersections of theO(n2)lines formed by pairs of data points. One algorithm usesO(n4)time and space, the otherO(n4logn)time andO(n2)space. Boros and Füredi (1984) establish a worst case order ofO(n3)for computation of the bivariate simplicial median. For comparison, the best algorithm for computation of the bivariate halfspace median requires onlyO(nlog3n)time (Langerman and Steiger, 2003). Of course, as a surrogate for the sample simplicial median, the deepest sample data point with respect to simplicial depth can be found inO(n2logn)time and is the version given in the R package depth. We note, however, that the deepest sample data point has a different limit distribution than the actual sample simplicial median.For a distributionFonRdassumed to be angularly symmetric aboutθinRd, Randles (1989) considers the hypothesisH0:θ=θ0and develops a type of “sign test” based on “interdirections” defined as follows relative to a sampleXn={X1,…,Xn}. For each pair{i,j},1≤i≠j≤n, consider the(n−2d−1)hyperplanes formed byθ0with anyd−1points inXnother thanXiandXj. The countCij=Cjiof those hyperplanes for whichXi−θ0andXj−θ0are on opposite sides measures the angular distance betweenXi−θ0andXj−θ0, relative to the positions of the other points. In effect, it counts the number of points lying betweenXi−θ0andXj−θ0, just as in the univariate case the number of points between two points is given by the difference of their ranks. The counts{Cij}are called interdirections and are invariant under nonsingular linear transformations.Randles converts the counts to equivalent fractions, with two variants. These are, for1≤i≠j≤n,f˜ij=Cij/(n−2d−1),which is natural and straightforward, being based on the number of hyperplanes involved in the countCij, andfij={[Cij+dn]/(nd−1)ifi≠j,0ifi=j,which, withdn=[(nd−1)−(n−2d−1)]/2, is the fraction of all(nd−1)data-based hyperplanes which fall betweenXi−θ0andXj−θ0, counting 1/2 whenever one or both of the pairXi−θ0andXj−θ0fall directly on the hyperplane. Relative to the plane formed byθ0,Xi−θ0, andXj−θ0, the quantityπfijestimates the angle betweenXi−θ0andXj−θ0.In formulating an associated sign test statistic, Randles applies the cosine function to the quantities{fij}and forms the sign test statisticVn=dn∑i=1n∑j=1ncos(πfij), withH0rejected for high values. ForFhaving elliptical directions, Randles shows thatVnhas underH0a limitingχd2distribution. Ford=2,Vnreduces to the bivariate sign test of Blumen (1958). We further discuss these tests in Section  5.1.Note that, for each of the(n2)choices of pair(i,j), the computation ofCijentails(n−2d−1)sets ofd−1data points. Thus computation of the full set of{Cij,1≤i<j≤n}of interdirections treats(4)N(n,d)=(n2)(n−2d−1)=O(nd+1)different sets of sized+1. Even ford=2, this is prohibitive for largen. As discussed in Hallin and Paindaveine (2002a), this computational burden motivates the use of other test statistics that are more readily computed.As mentioned in Section  1, not only do depth functions induce rank functions, but the converse holds. Thus, although the interdirections have been introduced strictly in the context of sign tests and related tests, it is important to explore whether there is an associated notion of “median”, just as in the univariate case the sign test is associated with estimation of a median. More comprehensively, we ask whether we can identify a productive “interdirections depth function”. Indeed, we now formulate and study such a depth function.Note that forθ0near the center of the data cloud, the corresponding countsCijtend to be high, whereas they tend to be low forθ0near the margin of the data cloud or far away from it. That is,Cij=Cij(θ0,Xn)measures the centrality ofθ0relative to the locations ofXiandXjin the full data setXn. Accordingly, we analogously defineCij(x,Xn)for all pointsxinRd, and also equivalently convert to the associated fractionsf˜ij(x,Xn)=Cij(x,Xn)/(n−2d−1). (Alternatively, the fractionsfijcould be used, or even the quantitiescos(πfij), but we prefer thef˜ij, which capture quite directly and naturally the “interdirections information” regarding centrality of points.) On this basis, we define the (sample) interdirections depth function by(5)DI(x,Xn)=(n2)−1∑1≤i<j≤nf˜ij(x,Xn),x∈Rd,taking values in[0,1]. This provides a fuller way to apply the interdirections. Later we will see that the population version ofDI(x,Xn), given by taking the expectation, can be carried out by taking the expectation of a somewhat simpler quantity thanf˜ij(x,Xn), which is a complex function of all the data points inXn.Very importantly, the interdirections depth function has a representation (pointwise) as a U-statistic, developed as follows. Note that each term generating the countCij(x,Xn)involvesd+1points ofXn. Instead of organizing the count information separately by pairs{i,j}, we instead organize it by the separate subsets ofXnof sized+1. For this purpose, we first introduce, for each{i,j}, the functionsgij(x;x1,…,xd+1)=1or 0 according as the hyperplane formed byxand{xk:k≠i,k≠j,1≤k≤d+1}separatesxiandxj, or not. Then we average these functions over all pairs{i≠j}to form the kernel(6)hI(x;x1,…,xd+1)=(d+12)−1∑1≤i<j≤d+1gij(x;x1,…,xd+1).It then readily follows that(7)DI(x,Xn)=(nd+1)−1∑1≤i1<⋯<id+1≤nhI(x;Xi1,…,Xid+1),expressingDI(x,Xn)as precisely a U-statistic with kernelhI(x;x1,…,xd+1). (Note that (4) can be reexpressed asN(n,d)=(nd+1)(d+12).) Thus the asymptotic behavior of this depth function follows using standard U-statistic theory. The computation of the interdirections depth at a single point requires, as noted above for computation of the interdirections,O(nd+1)time. Finally, we note that the population interdirections depthD(x,F)is given simply by taking expectations in the U-statistic representation (7), yieldingDI(x,F)=EhI(x;X1,…,Xd+1),x∈Rd, or equivalentlyDI(x,F)=Eg12(x;X1,…,Xd+1),x∈Rd. In the cased=2, a further simplification holds using the connection developed in the following section.We show that the simplicial and interdirections depth functions are exactly equivalent in the bivariate case and nearly so in higher dimensions. Of course, taking computational burden into consideration, the bivariate case is the one of greatest practical significance.Note that, forFcontinuous onRd, it holds with probability 1 that each simplexS[Xi1,…,Xid+1]formed fromXndoes not lie in any lower-dimensional hyperplane. That is, with probability 1,Xnis in “general position”. Also, forFcontinuous, the unionH(Xn)of the hyperplanes corresponding to all the faces of all the simplicesS[Xi1,…,Xid+1]has probability 0. Therefore, for convenience and simplicity, we assume thatXnis in general position and ignore points inH(Xn), which is justified with probability 1 forFcontinuous. Although, therefore, the data points themselves are excluded in our formal relationships betweenDI(x,Xn)andDS(x,Xn), this is of little or no consequence in the applications of our results.Theorem 1Consider the cased=2and assume thatXnis in general position. Then the sample interdirections and simplicial depth functions are linearly equivalent onR2∖H(Xn):(8)DI(x,Xn)=23DS(x,Xn)+13,x∈R2∖H(Xn).ProofWe show that the corresponding kernelshIandhSin the respective U-statistic representations ofDIandDSsatisfy the same equivalence as in (8), i.e., that(9)hI=1{hS=1}+131{hS=0}=23hS+13,subject tox∉H(Xn). Then (8) immediately follows via (7).To establish (9), letx∈R2and take any triplet fromXn, say{X1,X2,X3}. We havehI(x;X1,X2,X3)=g12(x;X1,X2,X3)+g13(x;X1,X2,X3)+g23(x;X1,X2,X3)3.Let us now consider the open planar regionA=S[X1,X2,X3]∘(the interior ofS), the six open regionsB,C,D,E,F, andGoutside ofAdefined by extending the three edges of the simplexS, and six representative pointsxa-xgwithin these regions, respectively. See Fig. 1for illustration.First, let us considerx∈A(in which casehS(x;X1,X2,X3)=1). In particular, letx=xa. It is immediate thatg12(xa;X1,X2,X3)=1because the extended linexaX3intersects the edgeX1X2and thus separatesX1andX2. Similarly,g13(xa;X1,X2,X3)=1=g23(xa;X1,X2,X3). ThushI(xa;X1,X2,X3)=1and we havehI(x;X1,X2,X3)=1=hS(x;X1,X2,X3),x∈A.Forx=xb∈B, we readily see thatg12(xb;X1,X2,X3)=1, but nowg13(xb;X1,X2,X3)=0=g23(xb;X1,X2,X3), yieldinghI(xb;X1,X2,X3)=1/3. In similar fashion, we also obtainhI(x;X1,X2,X3)=1/3for each ofx=xc,xd,xe,xf, andxg. Thus we havehI(x;X1,X2,X3)=1/3,andhS(x;X1,X2,X3)=1,x∉A.We ignore pointsxon the extended lines defining the edges ofS[X1,X2,X3], which belong toH(Xn). Thus (9) holds, establishing (8).□Thus, ford=2, the interdirections and simplicial depthsDIandDSare averages of equivalent indicator function kernelshIandhS, each assigning one of two constants according asxdoes or does not belong to a pertinent set (the same set for each kernel). In particular, both kernels assign “1” for membership, whereas for nonmembership the simplicial kernel assigns “0” while the interdirections kernel assigns “1/3”. Thus, in the bivariate case, the depthsDIandDSare interchangeable for practical purposes.For dimensiond≥3, the situation is similar, although in a somewhat looser sense. The following result shows a “quasi-linear” equivalence ofDIandDS.Theorem 2Consider the cased≥3and assume thatXnis in general position. Then the sample interdirections and simplicial depth functions are “quasi-linearly equivalent” onRd∖H(Xn), as follows:(10)DI(x,Xn)=(1−α(x,Xn)(d+12))DS(x,Xn)+α(x,Xn)(d+12),x∈Rd∖H(Xn),whereα(x,Xn)is the average, over all{Xi1,…,Xid+1}such thatx∉S[Xi1,…,Xid+1], of a functionα(x,Xi1,…,Xid+1)which is integer-valued, depends on the location ofxrelative toS[Xi1,…,Xid+1], and satisfies(11)2≤α(x,Xi1,…,Xid+1)≤(d2),with the lower bound sharp ford=3and the upper bound sharp for alld≥3.ProofAgain it suffices to treat the kernelshIandhSin the U-statistic representations. Consider any(d+1)-set fromXn, say{X1,…,Xd+1}. We treat two cases.Case 1:x∈S[X1,…,Xd+1]∘.It is readily seen thatgij(x;X1,…,Xd+1)=1for all1≤i<j≤d+1and hence thathI(x;X1,…,Xd+1)=1=hS(x;X1,…,Xd+1),exactly as in the cased=2. Therefore,hI=1wheneverhS=1.Case 2:x∉S[X1,…,Xd+1]∘.Denote byFi,1≤i≤d+1, the(d+1d)=d+1faces ofS[X1,…,Xd+1]. The following notation will be convenient:H(Fi)=hyperplane ofFi,Hi=open halfspace associated withH(Fi)inS[X1,…,Xd+1]c,vi=the vertex ofS[X1,…,Xd+1]not inFi,Ai={x∈Hi:linexvi¯passes throughFi},Bij=Hi∩Hjandα(x,X1,…,Xd+1)=number of pairs{i,j}for whichgij(x;X1,…,Xd+1)=1.Case 2(a):x∈⋃i=1d+1Ai.Note that theAiare disjoint. Fixiand selectx∈Ai.(i) Consider any hyperplaneHformed byx,vi, and anyd−2vertices fromFi. Each suchHintersectsS[X1,…,Xd+1]∘and separates the 2 vertices ofFinot inH. Since there are(dd−2)=(d2)choices of suchH, the resulting increment toα(x,X1,…,Xd+1)is(12)increment=(d2).(ii) Now consider the hyperplanes formed byxand anyd−1vertices fromFi. There are(dd−1)=(d1)=dsuch choices, and none of these intersectS[X1,…,Xd+1]∘.(iii) Now the total number of hyperplanes formed byxand anyd−1vertices fromS[X1,…,Xd+1]is(d+1d−1). Since(d+1d−1)=(d+12)=(d2)+(d1), we have accounted for all hyperplanes in (i) and (i) above, and it follows from (12), taken for each1≤i≤d, and from the disjointness of theAi, that(13)α(x,X1,…,Xd+1)=(d2),x∈⋃i=1d+1Ai.See Fig. 2for illustration ofx∈⋃i=1d+1Aiand of cases (i) and (ii) above, ford=3.Case 2(b):x∉⋃i=1d+1Ai.Thenx∈Bijfor at least one pair{i,j}, where1≤i<j≤d+1. (Note that the{Bij}are not all mutually exclusive.) Thusxcan “see” both ofFiandFjand is in the “corner wedge” formed byH(Fi)andH(Fj). Now there are exactly two vertices, sayvij(1)andvij(2), ofS[X1,…,Xd+1]that are not common toFiandFj. Clearly,xcan “see” both of these, too, but not via lines through the faces.(i) The hyperplane formed byxwith thed−1vertices common toFiandFjseparatesvij(1)andvij(2), and the corresponding increment toα(x,X1,…,Xd+1)is(14)increment=1.(ii) Now consider the(d−12)hyperplanes formed byx,vij(1),vij(2), andd−3other vertices ofS[X1,…,Xd+1]. (a) Suppose that at least one such hyperplane separates the remaining two vertices. Then, for each such hyperplane, none of the corresponding four hyperplanes which are formed from that hyperplane by substituting one of the two still available vertices for exactly one ofvij(1)andvij(2)separates the remaining two vertices ofS[X1,…,Xd+1]. Therefore, in this scenario involving the hyperplanes that use one or both ofvij(1)andvij(2), the increment toα(x,X1,…,Xd+1)satisfies(15)1≤increment≤(d−12)(=1ifd=3).(b) On the other hand, if none of the(d−12)hyperplanes usingxwith both ofvij(1)andvij(2)separates the remaining two vertices, then, for each such hyperplane, exactly half of the four corresponding hyperplanes formed by substituting for exactly one ofvij(1)andvij(2)do separate their remaining two vertices, depending on whetherxis “high” or “low” in its wedge, relative toS[X1,…,Xd+1]. In all, there are2(d−1)distinct hyperplanes formed byx, exactly one ofvij(1)andvij(2), andd−2other vertices. Therefore, in this second scenario involving the hyperplanes that use one or both ofvij(1)andvij(2), the increment toα(x,X1,…,Xd+1)is one half of their number, i.e.,(16)increment=d−1.(c) Combining the above, it follows that, forx∈Bij,α(x,X1,…,Xd+1)is given by the increment 1 in (14) plus an increment corresponding to either (15) or (16). In the first case this yields2≤α(x,X1,…,Xd+1)≤1+(d−12), and in the second case it yieldsα(x,X1,…,Xd+1)=1+(d−1)=d. Thus we arrive at(17)2≤α(x,X1,…,Xd+1)≤max{d,1+(d−12)},x∉⋃i=1dAi.See Fig. 3for illustration ofx∈Bijand cases (i) and (ii) above, and cases ofxattaining the lower and upper bounds in (17), ford=3.Completion of Case 2. Combining (13) and (17), we have(18)2≤α(x,X1,…,Xd+1)≤(d2),x∉S[X1,…,Xd+1]∘.Now, for any subset{Xi1,…,Xid+1}, the analogue of (9) is(19)hI(x,Xi1,…,Xid+1)=1{hS(x,Xi1,…,Xid+1)=1}+α(x,Xi1,…,Xid+1)(d+12)1{hS(x,Xi1,…,Xid+1)=0},subject tox∉H(Xn). We now introduce the averageα(x,Xn)ofα(x;Xi1,…,Xid+1)over the cases withx∉S[X1,…,Xd+1](i.e., withhS=0), which number(nd+1)(1−DS(x)). Thusα(x,Xn)=[(nd+1)(1−DS(x))]−1∑hS=0α(x;Xi1,…,Xid+1).Now averaging over (19), we obtain (in abbreviated notation)DI(x)=(nd+1)−1[∑hS=11+∑hS=0α(x;Xi1,…,Xid+1)(d+12)]=(nd+1)−1[(nd+1)DS(x)+(nd+1)(1−DS(x))α(x;Xn)(d+12)],and we have established (10) and (11), completing the proof of Theorem 2.□Remark 3(i)Forx∈S[Xi1,…,Xid+1]∘, it is immediate from the proofs of Theorems 1 and 2 that, for every dimensiond≥2, the simplicial and interdirections “kernels” evaluated at{Xi1,…,Xid+1}agree.Forx∉S[Xi1,…,Xid+1]∘, and ford≥3, it is seen from the proof of Theorem 2 thatα(x;Xi1,…,Xid+1)attains the upper bound(d2)for allxsuch that for some face ofS[Xi1,…,Xid+1]the line fromxto the vertex ofS[Xi1,…,Xid+1]not included in that face passes through the face, and otherwise satisfies the lower upper boundmax{d,1+(d−12)}, except that these bounds agree in the cased=3.Ford=2, the simplicial and interdirections depths are equivalent, as shown by Theorem 1, and the simplicial depth is then preferred on the basis of its significantly lesser computational burden ofO(nlogn)versusO(n3).Ford=3, forx∉S[Xi1,…,Xi4]∘the interdirections indicator kernel assigns one of two possible values, 1/3 and 1/2. Therefore, the averageα(x,Xn)/(d+12)in (10) lies between these values, showing that the simplicial and interdirections depths perform very similarly. Again, therefore, the simplicial depth is preferred on the basis of its more favorable computational burden ofO(n2)versusO(n4).Ford=4, the averageα(x,Xn)/(d+12)in (10) lies between 1/5 and 3/5, indicating again a rather close correspondence between the two depths. Again, therefore, the simplicial depth is preferred on the basis of its computational burden ofO(n4)versusO(n5).Ford≥5, the number of possible values assigned to nonmembership increases slowly withd, with4d(d+1)≤α(x,Xn)/(d+12)≤d−1d+1.Again, they perform rather similarly. Although the computational burden is nowO(nd+1)for each, the constant in this order is more favorable for the simplicial depth, which also might be preferred on the basis of greater conceptual appeal.A small simulation study was carried out to compare computation times ofDIandDSin the most significant case of dimensiond=2. ForFstandard bivariate normal, 1000 samples were generated for each of sample sizesn=50and 100. For each sample, each ofDIandDSwas evaluated for 5 points inR2, corresponding to the origin(0,0)and the points of form(x,x)on the 50%, 75%, 90%, and 99% quantile contours ofF. The corresponding computation times averaged over all 1000 samples are reported in Table 1.ForDI(x,Xn), computation was carried out using (A): the naive algorithm of orderO(n3), which we coded in R. ForDS(x,Xn), computation was carried out for each of four implementations:(B)theO(nlogn)algorithm of Rousseeuw and Ruts (1996), which we coded in R;the naive algorithm of orderO(n3), which we coded in R;the naive algorithm of orderO(n3)available in Fortran in the R package ddalpha;the naive algorithm of orderO(n3)available in C in the R package localdepth.The findings in Table 1 support the following conclusions:•The relative efficiency ofDSoverDIis over 1000-fold at sample size 50 and over 4000-fold at sample size 100, as seen by comparing times for algorithms A and B. This improvement with increasing sample size follows the rateO(n2/logn), from comparingO(n3)withO(nlogn).As expected, doubling the sample size from 50 to 100 increases computation time by only a factor of 2 for the efficient algorithm B of orderO(nlogn), but by a factor of 8 for the naive algorithms A, C, D, and E of orderO(n3).The computational burden ofDIis about 6 times that ofDS, as seen by comparing times for the naive algorithms A and C, each coded in the same language. WhereasDSevaluates a single indicator function for each of the(n3)triplets from the sample,DIevaluates and averages 3 indicator functions for each triplet.Coding algorithm B in either Fortran or C language should improve computation time by about a factor of 300, as seen by comparing times for algorithms C, D, and E.Analogous simulations for dimensionsd≥3would yield similar perspectives.Theorems 1 and 2, Remark 3, and the findings from Table 1 altogether suggest replacing interdirections approaches by simplicial depth approaches. The simplicial depth performs comparably to the interdirections depth in efficiency while offering some computational advantage as well as greater conceptual appeal. Of course, for dimensiond≥5, both depths are prohibitive computationally, except for very small sample sizes. However, especially ford=2and also ford=3and 4, the computational advantage of the simplicial depth is substantial. On this basis, various statistical procedures involving interdirections may profitably be modified by substituting use of the simplicial depth. Multivariate sign tests for location are discussed in Section  5.1, and several other possibilities are noted in Section  5.2.We discuss five multivariate sign tests for location.1.A key benchmark in extending the univariate sign test to higher dimension is the bivariate sign testBninvented by Blumen (1958) for testingH0:θ=θ0, withθdefined as a very general notion of median (equivalent to the halfspace median defined by Zuo and Serfling, 2000b) which generalizes the point of angular symmetry. The test statisticBnis affine invariant and asymptoticallyχ22in distribution. It is locally optimal against normal (and all elliptical) alternatives, with AREπ/4=0.785relative to the bivariate Hotelling test in the normal case.Also, again for the bivariate case, and for testing central symmetry aboutθ0, Oja and Nyblom (1989) formulate and study a class of sign test statistics which includesBnas well as other statistics of special interest, including a statisticUnwhich equivalently toBnis locally optimal against normal (and all elliptical) alternatives but improves uponBnagainst certain nonelliptical, but centrally symmetric, alternatives such as bivariate Laplace.The above-mentioned Liu (1990) testSn, available in any dimensiond, is readily seen in the bivariate case to be equivalent toUn:Sn=14−Dn(θ0,Xn)=3n(n−1)(n−2)Un+−3n4(n−1)(n−2).Therefore, applying the limit distribution forUngiven in Example 5.1 of Oja and Nyblom (1989), we obtain forSna weighted sum of chi-square variates as its limit distribution:(20)43nSn+1⟶d4π2∑k=1∞(2k−1)−2χk2(2),where theχk2(2)are independent chi-square variates with 2 degrees of freedom. The equivalence withUnyields forSnthe AREπ/4=0.785relative to the bivariate Hotelling test in the normal case, the same as forBn. (This agrees with the afore-mentioned ARE of the simplicial median versus the mean. However, the equivalent simplicial median test being computationally much more intensive, the use ofSnis much preferred.)As discussed in Section  3, Randles (1989) introduces the interdirections in formulating a new sign test statisticVnfor testingH0:θ=θ0in the setting of a sampleXninRd, for any dimensiond≥2, from a distribution angularly symmetric aboutθ. However, its asymptotic distribution is derived in general only forFhaving elliptical directions. Ford=2,Vnreduces toBn. Although a preprint of Liu (1990) is cited, with reference to both its definition of angular symmetry and its proposed invariant test of symmetry using simplicial depth, the direct connections between simplicial depth and interdirections are not noted.Chaudhuri and Sengupta (1993) introduce a general form of sign test statisticWnfor any dimensiondand note that (i)Wnincludes Randles’Vnas a special case, and (ii) ford=2,Wnis equivalent both to Oja and Nyblom’sUnand to the simplicial depth ofθ0(and thus toSn). They comment that analogues of (ii) do not hold ford≥3, and that the implications and consequences of these “intriguing” connections “are not fully understood at present”.The equivalence in performance ofSnandVnin the bivariate case is corroborated by a small simulation study also comparing with the HotellingT2test and including computation times. For each ofFbivariateN(0,I),N(Δ,I),N(2Δ,I), andN(3Δ,I), 10,000 samples were generated for each of sample sizesn=50and 100. HereΔ=0.0815(1,1)forn=50and=0.0567(1,1)forn=100, so that the HotellingT2test at level 0.05 has power 0.10 atN(Δ,I), based on the relevant central and noncentralF2,48andF2,98distributions. ForVnthe cutoff point for a level 0.05 test is the 0.95 quantile of the limit chi-square distribution with 2 degrees of freedom, whereas forSnvia the statistic43nSn+1the cutoff point is 1.218 based on the limit distribution in (20). For each distribution and each test statistic, the empirical rejection rate and mean computation time, based on 10,000 samples, are shown in Table 2. Computations are coded in R, using forSnthe efficientO(nlogn)algorithm.The findings in Table 2 support the following conclusions, within negligible statistical error:•With respect to Type I error, the three procedures perform reliably and equivalently.With respect to Type II error, theSnandVntests perform equivalently and with quite high relative efficiency with respect to theT2test (even greater than the asymptotic RE of 0.785).However, with respect to computation time (ford=2),Snis dramatically superior toVnby factors of approximately 1400 and 3600 forn=50and 100, respectively.On the basis of the above considerations, for testing a center of symmetry by a sign test, the simplicial depth approach usingSnis simple conceptually, relatively attractive computationally, competitively efficient, and accompanied by asymptotic distribution theory under merely the angular symmetry assumption. Further, it is affine invariant. This sign test is worthy of more extensive investigation, not only for the bivariate case but also, through some variants, for higher dimension. It evidently captures in an efficient way information about location.We note several other statistical procedures based on interdirections that are candidates for developing modifications based on simplicial depth to improve computational time while maintaining the same or comparable efficiency. Peters and Randles (1990) develop a type of signed-rank test for location based on the interdirections. Jan and Randles (1994) develop a signed-sum test of multivariate location using interdirections, and Randles and Peters (1990) and Um and Randles (1998) extend it to the multi-sample setting. Asymptotically locally optimal tests of multivariate location in the setting of elliptical symmetry using interdirections are developed by Hallin and Paindaveine (2002b). Similarly, Hallin and Paindaveine (2002c) construct interdirections-based tests against serial dependence, and Hallin and Paindaveine (2005) provide tests for linear models with VARMA errors. These various possibilities for modification using simplicial depth will be explored in separate studies.

@&#CONCLUSIONS@&#
