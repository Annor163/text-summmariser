@&#MAIN-TITLE@&#
Observer-based tracking control of abnormal oscillations in demyelination symptom

@&#HIGHLIGHTS@&#
Phase plane and bifurcation analysis to find the key parameters of demyelination neuron model.Unscented Kalman filter to estimate the unobservable key parameter.State feedback control to eliminate the nonlinearity in neuron model.The UKF-state feedback scheme is robust and more efficient compared to proportional integral control.

@&#KEYPHRASES@&#
Demyelination symptom,Action potential propagation,Unscented Kalman filter,State feedback control,

@&#ABSTRACT@&#
Fast axonal conduction of action potentials in mammals relies on myelin insulation. Demyelination can cause slowed, blocked, desynchronized, or paradoxically excessive spiking that underlies the symptoms observed in demyelination diseases. Feedback control via functional electrical stimulation (FES) seems to be a promising treatment modality in such diseases. However, there are challenges to implementing such method for neurons: high nonlinearity, biological tissue constrains and unobservable ion channel states. To address this problem, we propose an estimating and tracking control strategy for systems based on Kalman filter, in order to enhance the action potential propagation reliability of demyelinated neuron via FES. Unscented Kalman filter (UKF) is employed to estimate the unobservable states and parameters in the demyelination neuron model from membrane potential dynamics. Our method could promote the design of new closed-loop electrical stimulation systems for patients suffering from different nerve system dysfunctions.

@&#INTRODUCTION@&#
Action potential propagation along the axon relies on the myelin sheath, which is warp axon at regular intervals [1–5]. Demyelination is characterized by the unraveling of this insulation [6–10]. The clinical symptoms of demyelination including conduction slowing or failure, stimulus-dependent after discharge (AD), and spontaneous spiking [21–24]. Demyelination is known to destabilize the densities of ionic conductance in affected regions [25–28]. Recently, it has been demonstrated that a single mechanism controlling the balance of sodium and leak conductance is sufficient to explain the full range of demyelination symptoms by producing a four-way switch in axonal excitability [29,30]. The models make testable predictions and have broad implications for understanding regulation of axonal excitability [29].Functional electrical stimulation is a promising treatment in the above demyelination symptom [31–34]. Feedback control of input current pulses has made many improvements in existing functional electrical stimulation schemes [35,36]. Feedback neuron control schemes have been used to suppress neural oscillation, and control action potential propagation along the axon [37]. However, there are challenges to implementing feedback control for neurons. First, current conductance-based neuron models are highly nonlinear, while feedback control designs can only apply to linear or only weakly nonlinear systems. The other challenge is most of the dynamic states or parameters of the ion channels that needed in control strategy are usually unobserverable, which is a big obstacle in current studies [38].To solve the highly nonlinearity of conductance-based neuron model, some advanced control algorithms has been introduced for control design to allow a desired time response of neuron activity. A feedforward and feedback control scheme has been introduced to annihilate neural oscillation and oscillation transmission on single neuron level [42]. Furthermore, an optimal controller was combined with a state feedback controller to achieve time course control of neuron membrane potential. Model predictive control (MPC) was applied as an optimal control scheme, and membrane voltage was used as the control signal [43]. A LMI-based reference tracking control has been proposed to enhancing the spike propagation along the axon. However, as mentioned in those studies, the state variables of the ion channels are usually unobserverable, which is a main obstacle of implementing the feedback controllers introduced in these papers [42–45].Apparently, the estimation of unmeasured variables and parameters in nonlinear neuron model is an urgent problem that needs to be solved before implementing the control strategy. The most prominent of the model based predictor-controller strategies is the unscented Kalman filter (UKF) [46]. Schiff et al. has employed UKF to estimate action potential from measurement noise and restrain the epileptic spiking [47]. The key parameter of Parkinson's symptoms also estimated to design controller in their studies [48]. With modern measurement devices, such as DataWave Experimenter which can sampling at high rate up to 1MHz, the real time filtering and estimating can be achieved. Meanwhile, the analog/digital rate of CPU can also reach high rate. Therefore, the proposed controller can be implemented.In this paper, based on state feedback linearization theory, the action potential propagation problem of demyelination symptom is solved by the UKF-state feedback mixed tracking control method. The dynamics of unobservable states and parameters in demyelination symptom neuron model are reconstructed by UKF. State feedback controller can linearize the neuron model and move the membrane potential to the desired rest state. Therefore the goal of suppressing the demyelination symptom and recovery the normal response of neuron to pre-synaptic spike, which is important for action potential propagation reliability, can be achieved.The remainder of this paper is organized as follows. First, we introduce a single compartment and a multi-compartment Morris Lecar-like demyelination symptom models and their dynamics are also explored. Then a Kalman-state feedback tracking control method is proposed to estimate the values of unobservable parameters and states, the controller design procedure is based on state feedback linearization theory. Finally, computational simulation examples are given to illustrate the design procedure and confirm the tracking performance of the proposed Kalman-state feedback mixed method in a single compartment and multi-compartment HH model. Finally, we illustrate the role of Kalman filter and state feedback control and conclude the paper.Single compartment Morris Lecar-like demyelination symptom model is given in Eq. (1)[29,30](1)CmdV(t)/dt=−gL(V−EL)−gNam∞(V)(V−ENa)−gkw(V−EK)−gNapz(V−ENa)+Iinjdw/dt=Φww∞(V)−wτw(V)dz/dt=Φzz∞(V)−zτz(V)x∞(V)=0.51+tanhV−βXγXτX(V)=1/coshV−βX2γXwhere V is voltage and w and z are variable controlling time- and voltage-dependent activation of gkand gNap, respectively; gNawas assumed to activate instantaneously, and m was therefore always at steady state. In Eq. (1), x corresponds to m, w, or z. The following parameters were used in all simulations:C=2μF/cm2,EL=−70mV,ENa=50mV,EK=−100mV,βm=−1.2mV,γm=18mV,βw=−10mV,γw=10mV,Φw=0.15,βz=−45mV,γz=10mV,Φz=0.05,and delayed rectifier potassium conductance gK=20mS/cm2. Leak conductance gL=0.7mS/cm2 and persistent sodium conductance gNap=0.1mS/cm2, the fast sodium conductance gNais the key parameters of the model. Iinjrepresents the external inject stimulus current.Under single pulse stimulus, the demyelination neuron model can exhibit three different firing patterns: single spiking, after-discharge, spontaneous spiking with the fast sodium conductance gNavaries from 0 to 60mS/cm2. After-discharge (AD) and spontaneous spiking are the two main demyelination symptom that greatly decrease the action potential transmission reliability. The different firing patterns of demyelination model shown in Fig. 1and it also represent the phase plane analysis and bifurcation diagram of these patterns in order to reveal the underlie different dynamical mechanisms.The model given in Eq. (1) describes the temporal dynamics and the measurement output of a space-clamped axon where no spatial dynamics occur. Action potentials (APs) propagate along the axon by currents that excite neighboring regions. In the most general case, the dynamics of the membrane voltage as a function of time and space is described by a partial differential equation in the form of a reaction–diffusion equation. Instead of numerically solving this equation for the axon in the neuron system, the usual approach is to divide the axon into discrete compartments, which model the regeneration sites of the action potential. At these sites (nodes of Ranvier) the axon are in direct contact with its extracellular environment, and the nodal currents can be modeled together by coupling conductivity. The total diffusion current flowing into a given compartment i can be approximated by Eq. (2)[29,30](2)Ij=Ga(Vj−1−2Vj+Vj+1)where Gadenotes the coupling conductivity and Vj−1, Vj, and Vj+1 the membrane voltages in the corresponding compartments. Such a model consisting of 10 compartments was used to test the applicability of the control schemes to setups, where spatial propagation of APs was considered. Schematic diagram of multi-compartment demyelination neuron model is given in Fig. 2.In this paper, our goal is to tracking the dynamics of single spiking from after-discharge (AD) and spontaneous spiking by demyelination model. Here, based on state feedback linearization theory, we discuss the problem in the next tracking control design section.Here we propose a state feedback control strategy aiming at tracking the dynamics of unmeasured states and parameters in demyelination symptom model based on state feedback linearization theory.For permanent feedback control of the membrane voltage a state feedback linearization controller was designed. A reference rest voltage Vref=−70mV for the output V is specified. The controller forces V to reach the desired voltage and stay there.The differential equation describing the membrane voltage V in the demyelination neuron model was transformed into an equivalent linear system by applying state feedback linearization transformation. This transformed our nonlinear dynamical system description into an equivalent description consisting of linear differential equations. Following this transformation, a linear state controller was designed for the transformed system. The resulting final state feedback controller yields a current Iinjwhich forces the membrane voltage V to asymptotically track a given reference voltage Vref. The control law of the state feedback controller equals:(3)Iinj=gL(V−EL)+gNam∞(V)(V−ENa)+gkw(V−EK)+gNapz(V−ENa)+Cm(V˙ref+K(Vref−V))Therefore we design the external inject stimulus current in demyelination model shown in Eq. (1) as the output of state feedback controller shown in Eq. (3), then Eq. (1) equals:(4)CmV˙=Cm(V˙ref+K(Vref−V))The dynamics of the tracking errore=Vref−Vis described by a first-order differential equation with time constantτ=1/K:(5)e˙+Ke=IbiasCmwhere K represents the feedback gain of the controller, and Ibiasdenotes the sustained bias current input from the neighborhood neurons through node of Ranvier. If enough large K is adopted to make suree˙=(Ibias/Cm)−Ke<0, the error will converges to zero with time increase, thus the desired state can be reached.The dynamics of unobservable biological variable states and parameters in Eq. (1) can be obtained from the UKF estimation process. So state-feedback controller in Eq. (3) can be represented as Eq. (6)(6)I˜inj=g˜L(V−EL)+g˜Nam∞(V)(V−ENa)+g˜kw˜(V−EK)+g˜Napz˜(V−ENa)+Cm(V˙ref+K(Vref−V))whereg˜L,g˜Na,g˜k,g˜Nap,w˜,z˜represent states and parameters estimated from UKF.I˜injis the stimulus current injected to neuron model.In this section, we provide four examples of tracking control of neuron systems to illustrate the design procedure and confirm the tracking performance of the proposed method. The Morris Lecar-like demyelination symptom model can exhibit after-discharge spiking and spontaneous spiking. The rest-state potential (see the solid blue lines in Fig. 4a) can be roughly specified beforehand by equilibrium point analysis. Therefore, in the four computational examples, the state feedback control design method is applied to demyelination neuron model to efficiently track a desired single spiking dynamics from the after discharge (AD) and spontaneous spiking in demyelination neuron model with measurement noise (see Figs. 4 and 5), track single spike that propagation along the axon in multi-compartment demyelination neuron model with measurement noise (see Figs. 7 and 8). Schematic diagram of single-compartment demyelination neuron model tracking control is given in Fig. 3. The dark circle represents the demyelination neuron model, while the white circle represents a normal neuron that provide the reference membrane potential. State-feedback controller receives the difference between the normal and abnormal membrane potential, and output functional stimulus current is taken as inject current to demyelination neuron. Schematic diagram of multi-compartment demyelination neuron model tracking control is given in Fig. 6.Numerical simulation is proceeding with the Matlab software.Fig. 4 represents the tracking control results of annihilation after-discharge (AD) in demyelination model with UKF-state feedback control strategy. The goal is suppress AD after stimulus pulse injection and tracking the dynamics of sub-threshold oscillation after single spiking. Fig. 4(a) represents the tracking result of membrane potential V. Meanwhile the dynamics of biophysics variables w, z can well track the reference dynamics without direct control for their dynamics are solely depending on the membrane potential's and their own, as shown in Fig. 4(b) and (c). So through add a control signal to the dynamics of membrane, we cannot only can well tracking the dynamics of membrane potential but also the dynamics of biophysics variable of ion channels. Fig. 4(d) and (e) represents the UKF estimate process of key parameter gNa, gNap. Fig. 4(f) represents the output of state feedback controller.Fig. 5 represents the tracking control results of annihilation spontaneous spiking in demyelination model with UKF state feedback control strategy. The goal is suppress spontaneous spiking, which is an irregular firing pattern without stimulus injection, and tracking the dynamics of sub-threshold oscillation after single spiking. Fig. 5(a) represents the tracking result of membrane potential V and ion channel variables w, z. Through adding control signal to the neuron, we can suppress spontaneous spiking caused by abnormal value of gNato track the firing pattern of single spiking and the dynamics of biophysics variable of ion channels can also be well tracked.After tracking control of action potential firing patterns in single compartment demyelination model, we focus on apply the control strategy to multi-compartment demyelination model to control AP propagation along the axon via the nodes of Ranvier. The first compartment of axon is activated by periodic pulse stimulus. When the first compartment generate periodic spikes, stimulus current injection of the following part will be influenced through node of Ranvier and track the dynamics of the former part, then an action potential will propagate along the axon. However, in the case of demyelination, neuron activity in the demyelinated part will be abnormal, such as AD or spontaneous spiking as mentioned above. Therefore, abnormal spiking will propagate along the rest of axon after the demyelinated part, which will cause demylination symptom.Here we design the action potential propagation control via the proposed mixed control strategy. The axon is designed as constituted by ten compartments of node of Ranvier. The fifth compartment is designed as demyelinated part. The reference signal has been measured beforehand and the controller output is injected to the demyelinated compartment, increasing the reliability of action potential propagation.Fig. 7 shows the results of annihilation after-discharge (AD) during action potential propagation in multi-compartment demyelination model with UKF state feedback control strategy. In the multi-compartment model, the period of stimulus pulse strength inject to the first compartment is 100ms with a duration of 5ms and a maximum value of I=50μA/cm2. The membrane potential of ten compartments are selected randomly from 0 to 100mV to simulate the uncertainty of initial values. Action potential propagation becomes abnormal after-discharge at the fifth compartment (see Fig. 7(a)). After-discharge induced abnormal action potential propagation is blocked and single spiking dynamics is recovered at the fifth compartment after state feedback control (see Fig. 7(b)).According to the result of Fig. 5, spontaneous spiking generates repetitive spiking without external stimulus. Action potential cannot propagate reliably along the axon via the nodes of Ranvier with such demyelination symptom. Here we design UKF-state feedback controller for several compartments of Ranvier nodes, aiming to enhance action propagation reliability by tracking the dynamics of subthreshold oscillation after single spiking.Fig. 8shows the results of annihilation spontaneous spiking during action potential propagation in multi-compartment demyelination model with UKF state feedback control strategy. In the multi-compartment model, the period of stimulus pulse strength inject to the first compartment is 100ms with a duration of 5ms and a maximum value of I=50μA/cm2. The membrane potentials of ten compartments are selected randomly from 0 to 100mV to simulate the uncertainty of initial values. Action potential propagation becomes abnormal spontaneous spiking at the fifth compartment (see Fig. 8(a)). Spontaneous spiking induced abnormal action potential propagation is blocked and single spiking dynamics is recovered at the fifth compartment after state feedback control (see Fig. 8(b)).In the proposed UKF and state feedback mixed tracking control method, UKF not only can estimate the unmeasured states and parameters in demyelination neuron model, but also can restore the real value of membrane potential from the detected potential with measurement noise. On the other hand, state feedback linearization method can eliminate the nonlinearity of neuron model and force it to track a desire signal. In order to demonstrate the effectiveness of this method, we compare the results of two cases: the case that replaces the membrane potential estimated by UKF with original noisy membrane potential, and the case that replace the state feedback control with proportional integral (PI) control with the results of proposed method.First, we apply state feedback control to annihilate after-discharge during action potential propagation using unfiltered membrane potential with measurement noise. Fig. 9represents the results of action potential propagation state feedback control without UKF. The membrane potential with measurement noise force the controller output fluctuate frequently and also the maximum value of controller output increase. This will inevitably cause the waste of control energy and unpredictable damage to neuron.Then, we apply PI control to annihilate after-discharge and spontaneous spiking using filtered membrane potential by UKF. Response curve and Ziegler–Nichols method are used to tune the parameters of PI/PID controller. Fig. 10represents the results of suppressing after-discharge via PI control with UKF. Apparently, the maximum output of PI controller is large compare with that of state feedback controller as shown above, though the control result is similar. Fig. 11represents the results of suppressing spontaneous spiking via PI control with UKF. As similar to Fig. 10, the maximum output of PI controller is ten times larger than that of state feedback controller as shown above, in order to achieve the same control result. We find a well-tuned PI controller still cannot lead to acceptable performance, the controller output is quite large. Because the PI control does not eliminate the nonlinear element of neuron model, so the output should be enough large to counteract the nonlinear influence. Therefore, state feedback control is more suitable for neuron modulation implement than the classic PI control although the results are similar.

@&#CONCLUSIONS@&#
In this study, in order to annihilation abnormal neural oscillations in demyelination symptom, an observer-based state feedback tracking control strategy is proposed and the controller is designed based on state feedback linearization theory. The measurement noise filter process and unobservable parameter and state estimation are achieved by the UKF. The state feedback control strategy is employed to eliminate the high nonlinearity in feedback control design. Computational simulation examples of after-discharge (AD) and spontaneous spiking tracking control in single compartment demyelination neuron model are given to track the dynamics of a desired single spiking firing pattern. The proposed method is also applied to multi-compartment models in order to block the abnormal firing patterns and enhance action potential propagation reliability along the axon via nodes of Ranvier. Together with the comparison with the results of non-UKF or PI control, we can illustrate the design procedure and confirm the tracking performance of the proposed UKF-state feedback mixed tracking control method. Our results will be useful in the research of raising the neural coding transmission reliability through Functional electrical stimulation (FES) in similar neural disease symptoms.