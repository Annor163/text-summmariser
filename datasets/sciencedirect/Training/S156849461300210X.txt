@&#MAIN-TITLE@&#
Development and analysis of adaptive fuzzy controllers for photovoltaic system under varying atmospheric and partial shading condition

@&#HIGHLIGHTS@&#
A modified incremental conduction MPPT algorithm is proposed for solar PV system under partial shading conditions.An adaptive fuzzy modulator is developed to provide PWM pluses to the DC–DC converter.An adaptive hysteresis current control algorithm is proposed for DC–AC inverter in the PV system.The hardware implementation of proposed algorithms using Xilinx spartran-3 FPGA is presented.

@&#KEYPHRASES@&#
Photovoltaic system,Adaptive hysteresis current controller,Adaptive fuzzy MPPT,Partial shading,FPGA,

@&#ABSTRACT@&#
Control of power electronics converters used in PV system is very much essential for the efficient operation of the solar system. In this paper, a modified incremental conduction maximum power point tracking (MPPT) algorithm in conjunction with an adaptive fuzzy controller is proposed to control the DC–DC boost converter in the PV system under rapidly varying atmospheric and partial shading conditions. An adaptive hysteresis current controller is proposed to control the inverter. The proposed current controller provides constant switching frequency with less harmonic content compared with fixed hysteresis current control algorithm and sinusoidal PWM controller. The modeling and simulation of PV system along with the proposed controllers are done using MATLAB/SIMSCAPE software. Simulation results show that the proposed MPPT algorithm is faster in transient state and presents smoother signal with less fluctuations in steady state. The hardware implementation of proposed MPPT algorithm and inverter current control algorithms using Xilinx spartran-3 FPGA is also presented. The experimental results show satisfactory performance of the proposed approaches.

@&#INTRODUCTION@&#
The photovoltaic system converts sunlight directly into electricity. At a unique point on the I–V or P–V curve of a PV cell, called the maximum power point (MPP), the PV system operates with maximum efficiency and produces maximum output power. The maximum power point tracking (MPPT) module should usually be integrated with photovoltaic (PV) systems so that the PV arrays are able to deliver maximum available power. There are a number of MPPT techniques proposed in the literature namely, perturb and observe [1], incremental conduction [2], neural network [3], fuzzy logic [4], genetic algorithm [5], etc. These algorithms assume that there is only one peak power point in the P–V curve. The varying irradiation and partial shading condition result in multiple peaks in P–V curve, i.e. local maximum power point (local MPP) and global maximum peak power point (global MPP) and multiple steps in an I–V curve. The effectiveness of the existing MPP tracking algorithms deteriorates under these conditions.The reference paper [6] has experimentally obtained the I–V characteristics of the PV module to analyze the varying shading effect but, the work is limited to module-level study only and does not discuss the shading effects on an entire PV array. The reference paper [7] has adopted single-stage three-phase PV system that features an enhanced MPPT capability, but it has not studied the controlling methods of PV inverter. In [8], particle swarm optimization (PSO) based MPPT was proposed under varying atmosphere condition. This algorithm needs many variables that have to be set by the engineer. The reference paper [9] has proposed a MATLAB based PV module and P&O MPPT algorithm to track global MPP, and P controller to provide duty cycle for DC–DC converter in PV system. This approach uses a complex subroutine to track global MPP. This paper proposes a modified incremental conduction algorithm to track the global MPP and an adaptive fuzzy controller to provide duty cycle to the DC–DC converter. The authors of the research paper [10,11] have proposed adaptive fuzzy hysteresis current controller for filter application. Dai [12] proposes adaptive hysteresis controller for grid connected PV inverter but does not consider varying atmospheric conditions.In this work the DC–AC inverter is controlled by an adaptive hysteresis current controller. The adaptive hysteresis controller provides output with less harmonics and constant switching frequency. The PV system and the control algorithm are developed using Matlab/Simscape and Simulink software.This paper is organized as follows. Section 2 presents the modeling of PV cell and its characteristics. Section 3 describes the PV system in detail. Section 4 presents the details of the proposed modified incremental conduction method and adaptive fuzzy logic controller. Section 5 explains the details of the adaptive hysteresis current controller. Section 6 discusses the simulation and experimental results. Conclusions are presented in the last section.A PV cell can be represented by an equivalent circuit shown in Fig. 1.The expression for current in the above equivalent circuit is given by(1)I−IPH−IS(e(V+IRS/NVt)−1)where Is represents the saturation current of diodes; Vt represents thermal voltage; N represents the quality factor and IPH represents light generated current. The value of IPH is in proportion to light intensity (Ir), and is given by(2)IPH=IrIPH0Ir0In this expression, Ir is light intensity (irradiation), IPH0 is the light generated current under standard light intensity (Ir0), Ir0is irradiation used for measurement (1000W/m2). The model of the PV cell presented above can be expanded into the model of the photovoltaic module. A number of PV modules can be connected in series and parallel in order to get desired voltage and current. The basic characteristics of series and parallel connections of PV modules are similar to those of individual PV cells.To prevent the low irradiation PV module in becoming load and consuming energy during partially shaded conditions, it is necessary to connect bypass and reverse blocking diode with PV array. The bypass diodes are connected in parallel to each PV module and blocking diodes are connected in series with a group of series-connected PV modules. Fig. 2shows the I–V and P–V characteristic curves of PV array under different conditions. Curve A shows the characteristics of the P–V system under uniform shading conditions, whereas B and C show the characteristics under partially shaded condition without and with bypass and blocking diodes.It is seen from the I–V characteristics shown in Fig. 2 that the presence of bypass diodes will allow the unshaded modules of all the series assemblies to conduct their maximum current at a given irradiation and temperature. On the other hand, if the bypass diodes are not present, the shaded modules will limit the current output of the unshaded modules of the PV string. This may not only lead to a thermal destruction of the PV modules but may also decrease the available output power from the PV array. The blocking diodes will prevent the reverse current through the series assemblies, which generate lower output voltage as compared to the others connected in parallel. This reverse current may cause excessive heat generation and thermal breakdown of PV modules. The PV array having these diodes introduces multiple steps in the I–V characteristics and multiple peaks in the P–V characteristics, under the partially shaded conditions.Fig. 3shows the block diagram representation of a PV system, which includes a solar photovoltaic array with DC to DC converter, single phase inverter and load. The solar photovoltaic array produces electricity when the photon of the sunlight strikes the PV cell array. The output of the PV panel is directly connected to the DC to DC boost converter to step up the DC output of photovoltaic panel. Then it is fed to an inverter which converts DC into AC power at the desired voltage and frequency. The PV panel is assumed to work under varying atmospheric condition and partial shading. The DC–DC boost converter is controlled by means of a modified incremental conduction algorithm to provide optimum MPP voltage corresponding to global maximum power among multiple peaks of the P–V curve. An adaptive fuzzy controller provides a PWM signal to DC–DC converter to give faster response in transient state and smoother and less fluctuation in steady state. Then it is fed to a DC link capacitor. The DC link contains power pulsation so that capacitor should be connected to absorb this pulsating power to reduce the DC-link voltage ripple. The DC-link capacitor is calculated by the following equation:(3)Cdc=P2ωVdcVrippleHere P is power, ω is output AC voltage frequency, Vdc is nominal DC voltage and Vripple is the maximum allowed ripple voltage.An adaptive hysteresis current controller is proposed in this paper for the control of inverter to obtain better results in terms of less total harmonic distortion and constant switching frequency. The details of the proposed controllers for the PV system under varying atmospheric and partial shading conditions are presented in the subsequent sections.Each PV cell has an individual operating point where it can provide the highest electrical power, the maximum power point (MPP). Under rapidly varying atmospheric condition and partial shading condition, the PV array characteristics get complex due to the presence of multiple peaks (multiple local as well as a global maximum). Under this condition in order to improve efficiency, it is essential to use an effective MPPT algorithm. One of the most successful and simplest methods for MPPT is perturbation and observation (P&O), in which the controller is to provoke perturbation by acting (decrease or increase) on the PWM duty cycle and observing the effect on the output PV power. However, this algorithm may fail or oscillate around the maximum power point (MPP) under sudden atmospheric changes. The incremental conductance method [7] can track changing irradiance conditions with higher accuracy than P&O. However, it has to be modified to track and identify global MPP under partial shading condition. This paper proposes modified incremental conductance algorithm which is suitable for tracking global maximum power point under varying atmospheric and partially shaded conditions. In conjunction with this, an adaptive fuzzy logic controller is used to provide duty cycle calculation for the DC–DC converter. The flow chart of the modified incremental conductance algorithm is shown in Fig. 4.Under uniform irradiation and uniform shading conditions, all the PV modules in the PV system receive same irradiation. But in partial shading conditions, multiple MPPs (global MPP and local MPPs) occur. The algorithm should be able to differentiate and track global MPP among the number of local MPPs. The modified incremental conduction algorithm utilizes the following equation to check the occurrence of partial shading conditions:(4)ΔVPV=VPV(t)−VPV(t−1)=ΔVSET(5)IPV(t)−IPV(t−1)NP≈ΔIPV(t−1)NP=ΔISETwhere ΔVSET and ΔISET are predetermined voltage and current value set by the user and NP is the number of parallel connected modules in a PV system. If these equations are satisfied, the algorithm confirms that the PV system is under partially shading condition. If it is partially shaded, the voltage reference is changed by the linear function given by [7](6)Vref=NSVOCNPISCIPV(t)where NS is the number of series connected modules in a PV system, VOC the open circuit voltage and ISC the short circuit current. Eq. (6) moves the operating point toward the reference voltage level, and then MPP is tracked again by the incremental conductance method.The modified incremental conductance algorithm provides optimum voltage which is compared with PV array voltage (VPV). The result of the comparison is the error given by(7)E=VPV−ref−VPVThis error and change of error (ΔE=dE/dt) are given as input to the controller and duty ratio D is the output of the fuzzy controller. The input and output variables are represented by the fuzzy subsets, NB (negative big), NS (negative small), ZE (zero), PS (positive small) and PB (positive big). The adapted parameters may be scaling factors for each variable, meanings of linguistic variable or the if–then rules. In this work, the slope of the membership function of error and change in error is modified according to the values of the error.An adaptive hysteresis current controller is used to control the inverter in the PV system. This controller adjusts the hysteresis bandwidth, as a function of reference compensator current variation to optimize switching frequency and THD of supply current [11].Fig. 5(a) shows the schematic diagram of a grid connected PV system along with the various controllers. As shown in the diagram, an adaptive hysteresis current controller is used to control the inverter. Synchronous reference frame (SRF) method is used to extract reference current from the grid connected load current. The principle of SRF is shown in Fig. 5(b). In this method the load current is transformed into conventional rotating frame dq. The θ is the transformation angle that represents the angular position of the reference frame. The reference frame is rotating at constant speed in synchronism with the three phase AC voltages. To implement this method synchronizing system like phase lock loop (PLL) is used. The high pass filter (HPF) is used to eliminate the harmonic content in this method. Any one of the three phase reference current is then used for adaptive hysteresis current band calculation.Fig. 5(c) shows the concept of an adaptive hysteresis current controller where ascendant and descendant slope of the inverter reference current compensator are produced by imposing voltage stresses +Vdc and −Vdc on an inductor which connects the inverter to the grid.The expression for hysteresis bandwidth is derived as shown below:(8)diref+dt=1L(Vdc−VS)(9)diref−dt=−1L(Vdc+VS)From two triangles,(10)2HB=A−B=t1tanβ−t1tanα=t1diref+dt−t1diref*dt(11)2HB=C−D=−t2tanγ+t2tanα=−t2diref−dt−t2diref*dt(12)t1+t2=TC=1fCBy adding and subtracting Eqs. (10) and (11) and then substituting Eqs. (8) and (9), the resultant gives the equation of HB.(13)HB=12LfSVS+Ldirefdt1−1VdcVS+LdirefdtEq. (13) defines the hysteresis band that depends on the system parameters. By substituting the desired switching frequency, the hysteresis band value is obtained. Hence the algorithm that adaptively adjust hysteresis band width based upon electrical parameters with the purpose of maintaining switching frequency constant is known as adaptive hysteresis current controller. An adaptive hysteresis band method allows operating at nearly constant frequency and it is usually performed by the software using the system parameters.

@&#CONCLUSIONS@&#
