@&#MAIN-TITLE@&#
A data driven nonlinear stochastic model for blood glucose dynamics

@&#HIGHLIGHTS@&#
Data-driven model is presented for the response of glucose to food intake.Model describes blood glucose dynamics in people with and without diabetes.First study introducing a continuous data-driven nonlinear stochastic model.Model's parameters belong to different ranges for diabetes and controls.Variational Bayesian learning approach was employed for model identification.

@&#KEYPHRASES@&#
Nonlinear systems,Data-driven models,Stochastic systems,Blood-glucose dynamics,Diabetes mellitus,System identification,

@&#ABSTRACT@&#
The development of adequate mathematical models for blood glucose dynamics may improve early diagnosis and control of diabetes mellitus (DM). We have developed a stochastic nonlinear second order differential equation to describe the response of blood glucose concentration to food intake using continuous glucose monitoring (CGM) data. A variational Bayesian learning scheme was applied to define the number and values of the system's parameters by iterative optimisation of free energy. The model has the minimal order and number of parameters to successfully describe blood glucose dynamics in people with and without DM. The model accounts for the nonlinearity and stochasticity of the underlying glucose–insulin dynamic process. Being data-driven, it takes full advantage of available CGM data and, at the same time, reflects the intrinsic characteristics of the glucose–insulin system without detailed knowledge of the physiological mechanisms. We have shown that the dynamics of some postprandial blood glucose excursions can be described by a reduced (linear) model, previously seen in the literature. A comprehensive analysis demonstrates that deterministic system parameters belong to different ranges for diabetes and controls. Implications for clinical practice are discussed. This is the first study introducing a continuous data-driven nonlinear stochastic model capable of describing both DM and non-DM profiles.

@&#INTRODUCTION@&#
Tight glycaemic control using medication and life style adjustments has proven effective in reducing or delaying complications of DM [1]. There has also been major progress in the development of model predictive control devices, i.e. artificial pancreas systems [2] for type 1 diabetes (T1D), and attempts to automatically control blood glucose variations in people with type 2 diabetes (T2D) [3]. As stated in [2], the vital ingredient of predictive control algorithms is a model that captures the relationship between glucose excursions, food intake and insulin delivery. The development of such a model represents a major challenge due to limited access to quality data, high cost of equipment for data collection, and, most importantly, the complexity of the underlying systems dynamics. The latter includes four major properties: the glucose–insulin system is open, event-driven, nonlinear and stochastic. These essential properties are rarely incorporated altogether into models of blood-glucose dynamics. One of the reasons is that the inherent system complexity often leads to over-complicated models with large numbers of parameters, unsuitable for practical use. Let us briefly summarise two main types of model available in the literature and highlight the advantages of the approach taken in this work.Phenomenological models [4–8] describe the underlying physiological process (production, distribution, and degradation of glucose and insulin) by compartments, each of which is associated with several differential equations. Although the inherent nonlinearity of the glucose–insulin interaction has been recognised in these models, their application in predictive control is limited by two factors: they are not person specific and contain a high number of system parameters making such models hard to map to low-dimensional data and to validate [9].Data-driven models [5,10–13] are able to exploit the information hidden in the data and predict glucose concentration without detailed knowledge of the underlying physiological processes [14]. An accepted challenge of such data-driven models is the interpretation of their parameters. They also categorise every poor fit as measurement noise, without taking stochasticity in the data and uncertainty in the model into consideration. In nonlinear systems, noise acts as a driving force; it can radically modify deterministic dynamics, and therefore clearly requires inclusion in the model. This model uncertainty problem can be addressed using probabilistic identification techniques, which operate with parameter distributions rather than single values, and such an approach is taken in this work.The aim of this work was to find a parsimonious model formulation, i.e. a model of minimal order and with a minimal number of parameters, for postprandial (after a single food intake) glucose dynamics. The model should account for the essential systems properties listed above, and be suitable to support the control strategies in clinical settings. The framework for our approach lies in the area of data-driven nonlinear stochastic differential equations modelling. Data-driven models based on differential rather than difference equations have been explored, e.g. in a single case study [15], and for linear systems [16]. It has been shown [15] that postprandial blood glucose excursions can be modelled by a second order linear differential equation in which food intake is treated as a bolus injection of glucose, i.e. an impulsive force. It has also been demonstrated [17] that such linear systems can successfully describe some postprandial glucose excursions in subjects without DM, whereas a strong nonlinear characteristic of the responses was evident for many DM profiles. This highlights the importance of including nonlinear terms in modelling equations as opposed to linear systems approaches.The structure of the article is as follows. Section 2 gives details on the data available for the analysis. Section 3 explains the methodology for model formulation. Section 4 presents the model, a detailed analysis of systems parameters for profiles with and without DM, and some clinically related interpretation. Section 5 summarises the results, justifies the need for further work and outlines the relevance of the model for DM management.Datasets from 15 volunteers including five people without DM (control group), four patients with T1D and six patients with T2D was available for the study [17]. Recruitment was purposive to ensure a diverse sample of ages and treatment regimens. Baseline biographical data (Table A.1 in Appendix) were obtained on age, sex, body mass index, type of diabetes, treatment regimen and on recent HbA1c value, indicating the average blood glucose level in the past 2–3 months. Subcutaneous glucose values (Fig. 1) were taken every 5min over 72h using the Medtronic Minimed CGM system [18]. No restrictions were placed on usual daily activities of the participants.The dotted peaks in the time series (Fig. 1) represent the postprandial glucose concentration. To avoid mistaking measurement error for genuine postprandial peaks, only distinguishable peaks with height more than 1.1mmol/L during daytime from 6 am to midnight were selected. The highest peak value for the participant in the control group is just below 8mmol/L, whereas the highest values for the T1D and T2D patients are greater than 15mmol/L (not shown).There are three important characteristics of the blood glucose response to food intake to be taken into account. Firstly, the glucose response is nonlinear as explained in Section 1. Secondly, stochasticity enters into the model in two forms: as measurement error (noise) arising from the device, and/or as dynamical intrinsic noise resulting from factors other than food intake, including physical activity and emotional stress. For patients using insulin, inaccurate estimation of the necessary dose is another factor influencing postprandial excursions. Thirdly, the endocrine system tends to maintain homoeostasis, and any deviations of blood glucose from the basal level decay rapidly and return to the pre-disturbed state. The basal glucose level usually demonstrates slow nonstationary dynamics [17]. On the time scales corresponding to a single peak, the variations are small compared with the changes of baseline values from peak to peak, and therefore the glucose basal level within one peak can be considered as constant. Correspondingly, in our approach, basal level Gbis different for each peak and is set individually according to the experimental dataset. The glucose level over the baseline represents the system's transient response to food intake.Glucose response to a single food intake in people with and without DM can be considered as the following state-space dynamical model:(1)d2dt2xt+f1(xt)ddtxt+f2(xt)=F∫δ(t)dt+ηt(2)yt=xt+ɛtwhere(3)f1(xt)=∑i=0nθkixti,f2(xt)=∑j=1mθjxtjEq. (1) is the evolution (system's) equation in which (xt,dxtdt) is the state vector of the system [19], and ηtis the dynamic noise. Output xtof the model (1) has the same meaning and units as G(t); the two different notations are used to distinguish between estimated and measured glucose time series. In the measurement equation Eq. (2), ytis the output of the model in the presence of measurement noise ɛt. Two stochastic terms, the system noise ηtand the measurement noise ɛt, were modelled as Gaussian-distributed white noise [20] with zero means and intensities (variances) of Isysand Imeas, respectively. The deterministic solution of the system (1)–(3), i.e. solution in the absence of both noises, is denoted as xtd. In Eq. (1), F∫δ(t)dt represents an external force (food intake), where F is regarded as an unknown food impact factor, and δ(t) is the Dirac delta function. The food intake therefore is considered as a bolus injection of glucose at zero time moment [15].Functions f1(xt) and f2(xt) play an important role in the suggested model and introduce nonlinearity into the system. As there was no preliminary information on the form of nonlinearity, the polynomial form of the functions was chosen due to its generic nature and the ability to describe a wide variety of solutions xt. A linear deterministic equation is a particular case of this model when n=0, m=1,f1(xt)=θk0, f2(xt)=θ1xtand the stochastic terms are zero: ηt=0, ɛt=0. The linear noise-free system has been considered in [15] and was based on one T2D patient profile.The aim was to select the best model structure with the minimal number of parameters for each postprandial peak. To introduce sufficient nonlinearity into the system without overcomplicating the model, three polynomial terms were initially used in both functions f1 and f2. Note that using four or more terms increases the probability of overfitting, rendering the system unstable without improving parameter estimation. While considering the three polynomial terms, some models were disregarded; for example, it is known from the theory of dynamical systems that Eqs. (1)–(3) produce unstable solutions for a range of initial conditions if the quadratic term is kept but the cubic term is removed from function f2. Using this reasoning, we arrived at the four models presented in Table 1. The first model candidate M1 has full third order polynomial functions f1 and f2. The second candidate M2 has three terms in f1 and one linear term in f2. The third model M3 has three terms in f2 and one term in f1. The three models have been compared with each other and with the linear model (ML).In order to decide which of the four models best describe each postprandial event and, at the same time, identify corresponding values of deterministic (θki, θj) and stochastic (Isys, Imeas) parameters, a variational Bayesian learning numerical algorithm was employed [21]. Specifically, the variational Bayesian toolbox [21,22], initially developed for neuroimaging data, was used with the corresponding modifications to make it applicable to our CGM time series. The algorithm accounts for the stochastic nature of the underlying glucose dynamics and also enables us to distinguish the two types of stochasticity: measurement and dynamic noise. This algorithm is flexible and delivers the model parameters in the form of probabilistic distributions rather than fixed values. The final result thereby includes information on uncertainties in parameter estimates. As shown in [21], this approach outperforms standard extended Kalman filtering, the Bethe and Kikuchi family of variational methods and is more robust to model misspecification.Mathematically, the value of probability p(yt|M), also referred to as the model evidence, is found by numerically integrating the product of the prior distributions (priors) of the parameters p(ϑ|M) and the likelihood p(yt|ϑ, M) of observing time series ytgiven the parameters ϑ and the model M over the distribution of all the parameters ϑ:(4)p(yt|M)=∫p(ϑ|M)p(yt|ϑ,M)dϑIn the Bayesian approach, the choice of priors has a particular importance since it influences the inferred (posterior) parameter distributions. For deterministic parameters, normal prior distributions were considered, which is a commonly used form for an unknown variable. The mean values of the priors for parametersθk0and θ1 of linear terms were chosen in accordance with [15], i.e. set to zero. Also, for consistency, in models M1–M3, mean values of priors for remaining parameters were set to zero. Since there was no prior knowledge about the possible range of parameter values, large variances (104) were set, i.e. priors with flat distributions were considered to allow the algorithm searching in a relatively wide region. The large variances provide a weak informative prior, which however converges with iterations towards a narrow final (posterior) distribution. The prior of the food impact factor F was set to be normally distributed with a mean value ofyt2−yt1, whereyt1andyt2are the first and second time points of each peak, and variance of 104. The noise precisions, which are inversely proportional to noise intensities and have to take positive values, were modelled by Gamma distributions with both shape and rate parameters set to 0.001 [23].In Eq. (4), letter ϑ represents the space of all parameters in Eqs. (1)–(3). The integral in (4) is analytically intractable, therefore the Laplace and the mean-field approximations were used to calculate parameter probability distributions p(ϑ|M). The distribution of each parameter was approximated by the first two moments (mean and variance) known as Laplace approximation [24]. The combined distribution of all the parameters was approximated by the product of individual parameter distributions known as mean-field approximation [24]. The estimated value of p(ϑ|M) is noted as q(ϑ), and makes the integral Eq. (4) solvable. The estimated final solution for model evidence p(yt|M) is smaller than the true value due to decreased entropy [19]. The logarithm of p(yt|M) is known as ‘free energy’F(q(ϑ),yt)[19]. This value is maximised during the process of optimising the model for our data and that, among other criteria, defines the goodness of fit. The full procedure for finding the parameters of the best model is referred to as inference.For each model candidate M (where M is M1, M2, M3 or ML), the probability p(yt|M) of observing the time series ytgiven the model M, was approached by iterative optimisation of the model parameters and the estimated states until a local maximum value of p(yt|M) was reached. The model with the highest value of p(yt|M) was selected as the true model.Note that in the linear case, the selected form of the model guarantees structural identifiability. Indeed, as shown in [25] if a linear stochastic model is stable, controllable and observable, its parameters are identifiable. For linear model ML, both the controllability and observability matrices have full ranks, and we only consider stable solutions. For the nonlinear case, the identifiability is diagnosed via the analysis of the variance of parameters posterior distribution [26], and this is performed automatically in the framework of the variational Bayesian approach.Four models (ML, M1, M2 and M3) were compared to achieve the most satisfactory fitting. In order to select the best model, the following two criteria were considered:1The absolute value of the difference in free energyFbetween any two models:|ΔF|. According to [27], if|ΔF|>3, there is strong evidence that the model with the higher value of the free energy is better. This rule is derived from a well known Bayes’ factor which is a measure for comparing the evidences of two Bayesian models [27].The decay ratio. Since the glucose dynamics is tightly regulated by the endocrine system, it is a stable process with limited decaying oscillations except for patients in critical conditions or T1D patients who have to maintain the dynamics with insulin injections. Thus, any glucose excursion after food intake should relax to a steady state demonstrating the dynamics of an over-damped system. In the available time series the transient response corresponding to one meal is often superimposed by that of another meal, and consequently small oscillations might be hard to observe. We believe, however, that any model with a decay ratio (ratio of the height of the second peak to the height of the first peak) higher than 0.33 is unrealistic, and should be disregarded.Statistical analysis of the models’ parameters was performed using the Wilcoxon rank sum test. The null hypothesis of no difference between the groups of interest was tested at the 5% level of significance, and this is presented by p-values.

@&#CONCLUSIONS@&#
