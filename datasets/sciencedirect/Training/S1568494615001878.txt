@&#MAIN-TITLE@&#
Genetic algorithm and self organizing map based fuzzy hybrid intelligent method for color image segmentation

@&#HIGHLIGHTS@&#
A novel genetic algorithm based on spatial fuzzy C-mean (sFCM) method has been proposed to make compact and well separated clusters.Fuzzy separation and global compactness are considered the two objective functions to be optimized simultaneously.The self organizing map (SOM) is used to automatically determine the optimal number of clusters in order to set the length of chromosome.A progressive technique is used to handle the initialization problem. The algorithm considers some small parts of an image as separate segments which leads to over-segmentation.A novel merging technique is proposed to address the over-segmentation problem.

@&#KEYPHRASES@&#
Self organizing map (SOM),Segmentation,Fuzzy,Genetic algorithm (GA),Centroid,Segment,

@&#ABSTRACT@&#
The grouping of pixels based on some similarity criteria is called image segmentation. In this paper the problem of color image segmentation is considered as a clustering problem and a fixed length genetic algorithm (GA) is used to handle it. The effectiveness of GA depends on the objective function (fitness function) and the initialization of the population. A new objective function is proposed to evaluate the quality of the segmentation and the fitness of a chromosome. In fixed length genetic algorithm the chromosomes have same length, which is normally set by the user. Here, a self organizing map (SOM) is used to determine the number of segments in order to set the length of a chromosome automatically. An opposition based strategy is adopted for the initialization of the population in order to diversify the search process. In some cases the proposed method makes the small regions of an image as separate segments, which leads to noisy segmentation. A simple ad hoc mechanism is devised to refine the noisy segmentation. The qualitative and quantitative results show that the proposed method performs better than the state-of-the-art methods.

@&#INTRODUCTION@&#
The fundamental purpose of color image segmentation is to divide or partition a color image into a set of disjoint non-overlapping regions (segments) such that each segment represents a particular object. Since last decades, abundance of techniques have been proposed to address the problem of an image segmentation. Although, color image segmentation is still considered as a challenging problem in computer vision research community. Particularly, the segmentation of colored natural images is the most difficult job because of the random inhomogeneities that exist in color and texture. Most of the approaches address the segmentation of a particular type of an image for particular application. Moreover, these approaches are not fully automatic and need a significant amount of user intervention to segment the objects of interest accurately.In literature there are many color image segmentation techniques which can be divided into [1] image-domain based, physics based and feature-space based approaches. Image-domain based methods use both color and spatial features to carry out the segmentation task. The efficiency of these methods is depending on the selection of seed regions, which are normally set manually by the user. On the other hand the physics based methods use the physical models of material reflection to carry out color image segmentation [2]. It needs the reflection property of the underlying object which are not known in most of the cases and hence it is an application specific. The feature-based methods use color features only which leads to inaccurate results due to the lack of spatial relationship among the pixels [3].Contour based segmentation algorithms can be found in literature [4–7]. It starts from an initial boundary in the form of a spline curve; the curve is iteratively evolved to minimize some energy function. It suffers from the manual initialization of the curve or boundary to the object of interest. It is trapped in local optima and leads to unsatisfactory results. Markov random field based on statistical models [8] uses spatial connectivity information among the neighboring pixels to perform segmentation. Graph cut [9–12] is another segmentation approach based upon Markov random fields. These algorithms solve a two class problem, i.e., separating the background and foreground objects. Watershed segmentation [13,14] has been successfully adopted for the two class segmentation problems. It often produces bad results for image having many regions.Image segmentation can be treated as a clustering problem. The feature of each pixel corresponds to a pattern and the combination of the pixels (i.e. segment) corresponds to a cluster. Keeping this analogy in mind, many clustering algorithms have been used for image segmentation [15–18]. Among them K-means [15] is the basic clustering algorithm adopted for color image segmentation. Similarly, fuzzy C-means (FCM) [16] has been used for image segmentation extensively. It is a clustering process which decrease intra clusters distances and increase inter clusters distances. However, its implementation faces three problems: (1) cluster initialization, (2) determining number of the clusters, and (3) lacking of the robust cluster validity index. The performance of the algorithm depends on the initialization of clusters centroids. If the cluster centroids represent the search space uniformly then the results will be better on the other hand the biased initialization will lead to poor performance. Similarly the number of clusters have considerable impact on the quality of segmentation. The clustering validity index (CVI) performs a vital role in the process of image segmentation and data clustering [19]. It checks whether the provided clustering or grouping of the given data reflects the original structure of the data or not. The cluster validity index (CVI) adopted for the FCM takes into account both compactness and separation for reliable segmentation. Note that if the first (i.e., compactness) is adopted as a cluster validly index then the best result would contain the cluster/segments number as that of the number of points present in the underlying search space. Similarly if the second (i.e., separation) is considered as a cluster validity index then the best result would contain only one segment/cluster. The CVI that combines compactness and separation is insufficient to represent the geometrical structure of the data because it normally finds the distances between the centroids of different clusters.In this paper, a fixed length fuzzy genetic algorithm (GA) is used to perform color image segmentation. A new objective function or clustering validity index (CVI) is proposed which incorporate the fuzzy compactness of data points and fuzzy separation of the segments centroids. In the new objective function, the compactness is defined term of fuzzy deviation of data points while the separation is based on the average variance of segments centroids. A self organizing map (SOM) is used to determine the optimal number of segments in order to set the length of a chromosome. In some cases the proposed method makes some small regions of an image as separate segments which leads to noisy segmentation. A simple merging technique is proposed to address this problem and make segmentation refine. All the operations are performed in the Lab color space, which is near to the human level of perception. The block diagram of the proposed method is given in Fig. 1.The rest of the paper is organized as follows. Section 2 presents a mechanism to set the length of a chromosome automatically. In Section 3 the GA based color image segmentation is discussed. Section 4 presents the detail of the merging algorithm to handle the over-segmentation problem. Experimental results are discussed in Section 5 followed by the conclusion.We have used a fixed length genetic algorithm in which the length of a chromosome depends on the number of segments. Generally in segmentation algorithms the number of segments is set by user manually using some sort of domain knowledge. In this work a self organizing map (SOM) [20] is used to determine the number of segments that are hiddenly present in the underlying distribution (input image).SOM is an unsupervised type of artificial neural network (ANN) which is used to produce the low dimensional map of complex input space. Here we use a two-dimensional (2D) SOM network that consists of nodes or cells. Each node Niof the SOM, where i∈16, is assigned a weight vector (w→i) having three elements. The training dataset (in the form of input image) is organized as a vectorV→jin a raster scanning manner, where j=1, …, N and N represents the total number of pixels in the input image. Note that each element of theV→j(training set) consists of the three channels of the input image.The SOM network is randomly initialized. Then each input vector is iteratively feeded to the SOM network. The input vector is assigned to a best matching unit (BMU), a node in the SOM network which has maximum similarity to the given input vector. The best matching unit (BMU) to a given input vectorV→jis determined by using the following Eq. (1).(1)BMU=argmini∈[1,16]V→j−w→i,j∈[1,N]where 16 is the number of nodes/cells in the SOM network. Here, 16 is to be considered the maximum number of segment s present in a particular image. The weights of NBMU(a node in the network which has maximum matching to the input vectorV→j) and its neighboring nodes are updated using Eq. (2)(2)w→i(t+1)=w→i(t)+Ψ(t)ζ(t)[V→j(t)−w→i(t)],if∥NBMU−Ni∥≤v(t)w→i(t),if∥NBMU−Ni∥>v(t)In Eq. (2)t, andv(t)represent the iteration step and the neighborhood radius of the network respectively. Initially the neighborhood radiusv0is kept high to cover all the nodes of the network. Then the size of neighborhood radiusv(t)reduces exponentially with the increase in number of iterations t, as given in Eq. (3).(3)v(t)=v0·e−t/λwhere t is the iteration number and λ is a constant usually set to the ratio between the initial radius and the maximum number of iterations. The weights that lie inside the neighborhood of BMU are updated. It is clear from Eq. (2) that the weight updating process of the nodes, that lies inside in the neighborhood of BMU, are controlled by two functions ζ(t) and Ψ(t). The function ζ(t) represents the learning rate which shows that what percent of change should be incorporated in the weight of a particular node. In the initial stages more changes are made to the weights of SOM network in order to speed up the convergence. However to ensure maximum exploitation, the effect of learning rate is reduced with the increase in number of iteration t. The learning rate function ζ(t) is given by Eq. (4).(4)ζ(t)=ζ0·e−t/λwhere ζ0 is a constant value which may be fixed according to the requirement of learning process. The neighborhood function Ψ(t) controls the updating strength of the neighbor nodes of the best matching unit (BMU). It is implemented as a Gaussian function, in order to make changes according to proximity of neighbors, as given in Eq. (5).(5)Ψ(t)=e−∥NBMU−Ni∥22v2(t)The training of the SOM network continues until the radiusv(t)reach the size of NBMUand the weights of the network are not changed for a few successive iterations.Using the procedure of [20], the number of segments are determined from the trained SOM network. For each pixel a mapping is performed to the final weights of the nodes using Eq. (6).(6)V→j←w→g,g=i∈[1,16]argmin∥V→j−w→i∥,j∈[1,N]Then a variance map is formed based on the minimum cumulative distance among the weights of the SOM and pixels of input image. For all pixelsV→jlabeled withw→i, the variance is given as:(7)variance(w→i)=∑j∈Dw→i∥V→j−w→i∥no_pixels_labeled(w→i),i∈[1,16]whereDw→iis the domain set of pixelsV→jthat has maximum matching to the weightsw→i. The smaller variance (w→i) value represents a more reliable estimate of a compact segment.In the last step the inter-segment variability is calculated to find out the final number of segments. A similarity matrix is constructed in order to store the Euclidian distances between the neighboring nodes in the SOM network. An elimination process is exploited to minimize the number of nodes/segment centroids. If the distance between two neighboring nodes is less than a pre-defined threshold β, inter segment distance, then a node having highest variance score is removed. The elimination process continues until the distances among all the neighboring nodes remain greater than a pre-defined threshold value of β. In this work the inter-segment threshold β is set to 0.4 based on the empirical study of BSD images [21]. This value proved good enough for all images analyzed in the experimentation.A genetic algorithm (GA) is a population based probabilistic search technique used to solve the optimization problems. This section presents the details of genetic algorithm and its use in the area of color image segmentation. The basic mechanism of GA is outlined in Algorithm 1. The following are the terminologies used in the given algorithm.ρm: mutation rateρc: crossover rateNp: population sizeP: is a matrix used to represent the population. Note that, there are Nprows in P and each row represents a particular chromosome.aj: the maximum value in the jth channel of an imagebj: the minimum value in the jth channel of an image∥: represents the logical OR operatorP→i,g: is a row vector represents the ith chromosome at generation (iteration) gϜi,g: is a scalar value which represents the fitness of the ith chromosome at generation gA genetic algorithm needs to be initialized before starting the iterative procedure. Usually the initialization is performed by user using some sort of domain knowledge or random procedure. The pure random initialization is not good enough because it forces the segmentation algorithm to converge to local optima [22]. The initialization process can be diversified by opposite number generation. The opposite number diversify the initialization process and tends to select the initial solutions from the productive regions of the underlying search space.Here we used the opposition based strategy [23] to generate the initial population. The best individuals from the union of purely random solutions and their opposites are selected. This strategy avoids the unproductive samples or solutions and initialize the population to the most fertile regions. In Algorithm 1 lines 3–8, demonstrate the initialization process. The ajand bj(Algorithm 1, line 6) are the minimum and maximum values of a particular dimension, which ensure to select a value in the given range.Algorithm 1Here a chromosome is represented as a series of real values to encode K segments centroids. Each segment centroid consists of three colored channel of an image. So a particular chromosome can be represented as a string of K×3 real values. In each chromosome the first three values represent the centroid of first segment, the second three values represent the centroid of second segment and so on. Suppose we have K=3 then a particular chromosome can be represented as:C11C12C13C21C22C23C31C32C33The above illustration demonstrates three segment centroid s (C11, C12, C13), (C21, C22, C23), and (C31, C32, C33) respectively, where Cijrepresents the jth value of the ith segment centroid such that 1≤i≤K, and, j∈{1, 2, 3}.In fuzzy C-mean (FCM) algorithm [24] the membership μijof a data point xjto a segment centroidviis given as:(8)μij=1∑k=1KD(vi,xj)D(vk,xj)2m−1,for1≤i≤K,1≤j≤Nwhere N and K represent the number of data points and the number of segments,D(vi,xj)represents a distance between a cluster centroidviand a point xj, m is a fuzzifier which determines the level of cluster fuzzyness. It is important to note that, when calculating the membership value μijin Eq. (8) ifD(vi,xj)becomes zero for any value of k then μijis assigned 0, ∀i=1, 2, …, K, i≠k, while the value of μijis set to 1. It means that a particular point xjhas complete matching with the segment centroidvitherefore the difference or distance between them becomes 0. Then the membership of this point to the corresponding segment centroid is set to maximum,i.e., 1 and the membership to the rest of the cluster centroids is set to minimum, i.e., 0.In images the neighboring pixels have maximum similarities. In other words, they have similar features or characteristics. So there is a maximum probability that they belong to the same segment. To exploit this idea in color image segmentation a spatial function is constructed as [25]:(9)sij=∑k∈□(xj)μikwhere □(xj) denote a square window, in the spatial domain centered around a pixel xj. The spatial function sijrepresents the relationship among the neighboring pixels – that how much they are similar. If the majority of pixels, in the same neighborhood, belongs to one segment then the value of spatial function will be greater and vice versa. The spatial information can be included in the membership function by the following way:(10)μij′=μijpsijq∑k=1Kμkjpskjqwhere p and q are parameters used to give relative weights to each function. Here we set the values of p and q to 1 and 2 respectively. The effect of p and q on the final segmentation is discussed in qualitative evaluation Section 5.1.In this paper we use the compactness and separation measures to develop a new objective function (fitness function) in order to asses the quality of solution/chromosome. The compactness determines that how much the points in one segment are similar while the separation determines that how much the given segments centroids are different. The smaller the compactness and the greater the separation leads to better segmentation. Here we determine the compactness in the following way:(11)Ω=∑i=1K∑i=1Kμij′D(vi,xj)∑i=1Kμij′whereμij′D(vi,xj)is the weighed distance of a point xjto a segment centroidviand∑i=1Kμij′is the fuzzy cardinality of the segment centroidvi. Note that the sum of the weighted distances of a all points give the fuzzy deviation of the data.For the fuzzy separation we find the distances between each pair of segments centroids. If there are total K centroids, then K(K−1)/2 distances can be calculated. So, the fuzzy separation of the segments centroids is given as:(12)Ψ=Mediani≠k(D(vi,vk))−Mini≠k(D(vi,vk))+Maxi≠k(D(vi,vk))−Mediani≠k(D(vi,vk))2The compactness ‘Ω’ should be minimized to get compact segments (i.e. to maximize the inter-segment similarities). On the contrary the fuzzy separation Ψ should be maximized in order to decrease the intra-segments similarities. Finally the fitness function is determined by Eq. (13).(13)Ϝ=ΨΩThe chromosome/solution which has higher fitness value is considered the best. It is a maximization case so the aim is to maximize the fitness value. The chromosomes having highest fitness values are selected for the reproduction.In GA, selection is one of the most important operator. The main purpose of the selection is to select the best chromosomes for reproduction. To determine the quality of a solution/chromosome the fitness function is used. The chromosome which has best fitness should have higher probability for the selection. Here we use the binary tournament selection.Reproduction is the process to generate new solutions (chromosomes) from the current selected solutions. We carried out a single point crossover to reproduce new child solutions. The cut point for crossover is selected randomly. Note that, the crossover probability ρcis initialized to 0.8, while the mutation probability ρmis set to 0.05. If a chromosome is selected for mutation then the allele position, which is expose to the mutation process, is randomly selected. The allele value of that particular position is replaced by a randomly generated value from the respective component of an image. The parent and new offspring populations are exposed together for the selection of new generation in order to ensure the elitism operation.It a is condition to terminate the iterative execution of the GA. We use (g≤G∥δ≠true) as a stoping criteria. Here, G is the maximum number of iterations and δ is a flag which is set to true if Δ<τ (Algorithm 1, lines 20–23). Note that, here we set τ to 0.0001. Moreover, it each iteration g the Δ is updated as (Algorithm 1, lines 20): Δ←Ϝbest,g−Ϝbest,g−1, where the Ϝbest,grepresents the fitness of the best chromosome at the current iteration while Ϝbest,g−1 represents the fitness of the best chromosome at previous iteration Table 1.In some cases the given genetic algorithm makes the small regions as separate segments, which leads to over-segmentation. A simple ad hoc mechanism is used to eliminate the small segments by merging the to their matching neighbors. The pseudocode of the elimination process is given in Algorithm 2.Algorithm 2If the size of a segment x is less than a threshold τ then its neighboring segments are find out. In line 4, y∈NB(Lx) represent that segment y is the neighbor of the segment x. Then the average distance among the segment y and segment x in the corresponding color image I is calculated. Note that, the argmin(·) returns the label of the best matching neighbor (BMN) which has the smallest distance to the target segment x. After finding the best matching neighbor (BMN) the two segments are merged by giving same label to their union in the corresponding newLp∪q. Fig. 2shows the results of the elimination process. The first column shows the original images, while the second and third columns show the segmentation results before and after the elimination process. Note that, some small dots can be seen in Fig. 2 (column 2 before elimination) which are eliminated in column 2 by the elimination process.

@&#CONCLUSIONS@&#
