@&#MAIN-TITLE@&#
An on-line, real-time learning method for detecting anomalies in videos using spatio-temporal compositions

@&#HIGHLIGHTS@&#
A fast and accurate algorithm for anomalous event detection in videos.Densely sampling video to construct spatio-temporal video volumes.Handling uncertainties in codebook construction.Coding spatio-temporal composition of volumes by a probabilistic framework.Unsupervised and continuously learning new events.

@&#KEYPHRASES@&#
Video surveillance,On-line anomaly detection,Suspicious event detection,Spatio-temporal video volumes,Spatio-temporal compositions,

@&#ABSTRACT@&#
This paper presents an approach for detecting suspicious events in videos by using only the video itself as the training samples for valid behaviors. These salient events are obtained in real-time by detecting anomalous spatio-temporal regions in a densely sampled video. The method codes a video as a compact set of spatio-temporal volumes, while considering the uncertainty in the codebook construction. The spatio-temporal compositions of video volumes are modeled using a probabilistic framework, which calculates their likelihood of being normal in the video. This approach can be considered as an extension of the Bag of Video words (BOV) approaches, which represent a video as an order-less distribution of video volumes. The proposed method imposes spatial and temporal constraints on the video volumes so that an inference mechanism can estimate the probability density functions of their arrangements. Anomalous events are assumed to be video arrangements with very low frequency of occurrence. The algorithm is very fast and does not employ background subtraction, motion estimation or tracking. It is also robust to spatial and temporal scale changes, as well as some deformations. Experiments were performed on four video datasets of abnormal activities in both crowded and non-crowded scenes and under difficult illumination conditions. The proposed method outperformed all other approaches based on BOV that do not account for contextual information.

@&#INTRODUCTION@&#
In recent years video surveillance systems have become very popular due to heightened security concerns and low-hardware costs. They are widely used in many applications such as nursing care institutions, law enforcement, building security, and traffic analysis. Moreover, in most circumstances, it is necessary for humans to analyze the videos, which is inefficient in terms of accuracy and cost [1,2]. In light of this, together with the tremendous number of such videos produced on a daily basis, there is a great need for a real-time automated system that detects and locates suspicious behaviors and alerts security agents.Consequently, detecting unusual or suspicious activities, uncommon behaviors, or irregular events in a scene is the primary objective of an automated video surveillance system. We refer to this activity as anomaly detection because the sought-after situations are not observed frequently. Although the term anomaly cannot be defined explicitly, all such systems are based on the implicit assumption that events that occur occasionally are potentially suspicious, and thus may be considered as being anomalous [3–12]. Therefore, the working definition of this term in this paper is taken to be the spatio-temporal compositions in a video or set of videos with low probability of occurrence with respect to the previous observations. This implies that the anomalies are spatial, temporal, or spatio-temporal outliers that are different from the regularly observed patterns. We define the anomalies with respect to a context, meaning that a particular activity in a particular context would be an anomaly, while in another context it might be normal [11].A real-time video surveillance system can be considered to be a form of saliency detector, concerned with focusing attention on anomalies by localizing them in space and time. It is preferable to locate these as actual suspicious regions in each frame of the video, rather than just simply selecting the whole frame. Such precise localization makes it possible to attend to suspicious regions by either automated systems or human operators [5].The detection of anomalies in a video is an active research area that has been addressed for both crowded and non-crowded scenes [10,13,14,4–7,15,3,11,8]. In the literature, detection has been achieved either by explicitly determining normal (or abnormal) behaviors (called rule-based) in the early work [16–18], or by statistically learning behaviors (lacking predefined rules) [3–5,19–22,15]. The latter is more promising due to its flexibility for describing observed data and generalization capabilities and is the one adopted here.Most of the reported approaches are based on the trajectory analysis of the objects, which requires precise tracking methods [23–26,21,27,15,14]. Nevertheless, this still remains a significant challenge to computer vision, particularly in complex situations [28]. In general, a moving object is considered to be an amorphous blob that is tracked, thereby producing a trajectory. Any major deviation from the learnt trajectories is considered to be an anomaly. Tracking-based approaches are suitable for scenes with few objects but are impractical for detecting abnormal patterns in a crowded or complex scene. An additional issue is that human behavior analysis also requires a knowledge of what occurs within a blob.Non-tracking approaches that focus on local spatio-temporal anomalies in videos also exist. These rely mainly on extracting and analyzing local low-level visual features, such as motion and texture, either by constructing a pixel-level background model and behavior template [29–32] or by employing spatio-temporal video volumes (dense sampling or interest point selection) [4,33–37,20,38–41,10,42,43]. In large part, the former relies on an analysis of the activity pattern (busy-idle rates) of each pixel in each frame as a function of time. These are employed to construct a background model, either by analyzing simple color features at each pixel [29] or more complex motion descriptors [30,32]. More advanced approaches also incorporate the spatio-temporal compositions of the motion-informative regions to build background and behavior templates [31,44,43] that are subtracted from newly observed behaviors in order to detect an anomaly. In [8], dynamic behaviors are modeled using spatio-temporal oriented energy filters to construct an activity pattern for each pixel in a video frame. Generally, the main drawback associated with these methods is their locality. Since the activity pattern of a pixel cannot be used for behavioral understanding, their applicability in surveillance systems is restricted to the detection of local temporal phenomena [8,30].One representative approach to spatio-temporal anomaly detection is to use local spatio-temporal video volumes in the context of Bag of Video words (BOV) models. However, the relationships between the volumes are often ignored, even though they are crucial for anomaly detection. In fact, there is also psychological support suggesting that contextual information (spatio-temporal relationships between different objects and their surroundings) is necessary for scene understanding in human perception [45,46]. In general, in the literature, spatial and temporal information about the distribution of video volumes is only exploited implicitly, locally, and at a fixed temporal scale, which is inadequate for accurate event recognition [5,47,19,48,38,22,40,49]. Another drawback of all BOV approaches that employ clustering methods to group similar video volumes to reduce the search space is their finality. Once a video-volume has been assigned to an incorrect video word, there is no way to correct this error. In other words, they are unable to deal with uncertainty in the visual word assignment. Moreover, real-time performance is usually not possible. Another important issue in the current literature relates to the popularity of the use of supervised [23,50–52,16] or offline learning methods [4,50,5,6], which are wholly dependent on large numbers of training data. Clearly, in the case of anomaly detection in videos, it is necessary to incrementally update the learned model for both normal and abnormal events [3,10,11,53,54].Thus the question arises as to how a set of new observations can be classified as being either normal or abnormal? Perhaps this is the most difficult challenge to this research. Among the proposed solutions in the literature, we believe that the most promising and reliable answer to this question should simultaneously determine both normal and abnormal compositions. The only difference between these is that the likelihood of the latter will be much smaller than that of the former. In light of this definition, it is possible to accomplish this task by considering the problem as one of reconstruction, as was done in [4]. Consequently, having a few video samples of a normal event (“training set”), a new normal observation would have high likelihood, while an abnormal event would have low likelihood. In the former case, video compositions should be capable of being reconstructed by finding similar regions to those already found in these videos.In this paper, we present a fast online unsupervised method for anomaly detection in videos, based on spatio-temporal video volume construction, while using both local and global compositional information regarding the volumes. This is achieved using dense sampling at various spatial and temporal scales and is related to the method presented by Boiman and Irani [4]. These authors used a reconstruction framework for anomaly detection, in which an observation is considered to be anomalous if it cannot be reconstructed using previous observations.By formulating anomaly detection as a reconstruction process, anomaly detection is reduced to being defined as an outlier detection problem, i.e., finding the events that are not similar enough to the previously observed events in the video. Therefore, given a video sequence, V, containing a set of eventsV={ei}i=1Nand a similarity measure S, the concept of an anomaly is defined for a particular event eq, as follows:(1)eq∈Vsq,i=S(eq,ei),ei∈V-{eq}eqisanomalyiff∀i,sq,i⩽γwhere γ is a threshold. This implies that the event eqis not similar enough to any of the observed events. Similar to [4], in our approach, each event eiconsists of a set of spatio-temporal video volumes, pk, defined for all pixels inside a much larger contextual region around each pixel. Such a set is called an ensemble of volumes around the particular pixel in the video. The ensemble of volumesEiis defined at each point (xi, yi, ti) in the video (where (xi, yi) refers to the spatial position in the frame and tito the temporal location in the video):(2)ei=Ei=pkEik=1K≜pk:pk⊂Rik=1Kwhere pkis a spatio-temporal video volume (e.g., of size 7×7×4) andRiis a larger region in space and time around each pixel (e.g., of size 50×50×50). Although this formulation is straightforward, finding an anomaly is not trivial. Using this definition, the problem of finding short-term anomalous events will be modeled by means of a set of spatio-temporal volumes while using a probabilistic model of their spatial and temporal arrangements. This will be described in Section 3.In light of the above, our goal is to build a fast anomaly detection framework for surveillance systems that addresses practical requirements, such as real-time performance and reliable detection and localization of anomalies. In addition, we seek the ability to learn newly observed events without any offline and supervised training. Perhaps most important, we wish to eliminate tracking, background subtraction or other processes such as foreground segmentation methods with their attendant weaknesses, which form the basis for previously reported approaches. After initialization of the algorithm using just a few seconds of video,1The number of initialization frames required to construct the ensemble of volumes (contextual region in the time domain) is related to the temporal size of the ensembles,Ri(see Eq. (2)). We discuss the number of initialization frames in Section 4.3.1our method builds a model of normal behavior and detects anomalies while incrementally updating itself in an unsupervised manner when a new normal pattern is observed.The main characteristics of our approach and also the contributions of this paper are as follows:•We introduce a probabilistic framework to capture spatio-temporal configurations of video volumes. This is achieved by estimating probability density functions of the arrangements of video volumes. Consequently, anomalies are defined as those spatio-temporal compositions in a video or set of videos having very low probability of occurrence.We significantly reduce the size of the database for finding similar examples to a new observation while retaining summary information, thereby speeding up the process and making it real-time.We use an online unsupervised incremental method in order to update the probability distribution functions of the normal events. Thus, our method can adaptively learn newly observed normal patterns.We have conducted extensive experiments to evaluate the capability of our approach for anomaly detection using four datasets with different abnormality patterns and different contextual compositions: anomalous walking patterns2http://www.wisdom.weizmann.ac.il/∼vision/Irregularities.html2[4]; the UCSD pedestrian dataset, which consists of two datasets3http://www.svcl.ucsd.edu/projects/anomaly.3: UCSD Ped1 and UCSD ped2 datasets[6]; subway surveillance videos4Obtained from the authors of [3].4[3]; and an anomaly detection dataset5http://www.cse.yorku.ca/vision/research/spatiotemporal-anomalous-behavior.shtml.5[8]. The results indicate that our approach is comparable to the state-of-the-art in terms of accuracy, while requiring vastly fewer computations than alternative non-local approaches and hence, makes real-time video analysis possible. The rest of this paper is organized as follows. Section 2 reviews the related work for solving the problem of anomaly detection. Section 3 describes the proposed approach for anomalous event detection and the steps of the algorithm: the sampling process and codebook formation, capturing spatio-temporal compositions of the video volumes, similarity map construction and the inference mechanism. Section 4 discusses experimental results on four different datasets, and finally, Section 5 concludes the paper.

@&#CONCLUSIONS@&#
