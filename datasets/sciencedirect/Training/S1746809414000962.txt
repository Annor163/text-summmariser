@&#MAIN-TITLE@&#
Improved complete ensemble EMD: A suitable tool for biomedical signal processing

@&#HIGHLIGHTS@&#
Two major improvements on a noise-assisted EMD method are proposed.The obtained components contain less noise and more physical meaning.These improvements are confirmed on artificial signals.The new method is successfully tested on several biomedical signals.Information of physiological phenomena involved in their production is obtained.

@&#KEYPHRASES@&#
Empirical mode decomposition (EMD),Noise-assisted data analysis,Electroglottography,Ventricular fibrillation,Epileptic seizure,

@&#ABSTRACT@&#
The empirical mode decomposition (EMD) decomposes non-stationary signals that may stem from nonlinear systems, in a local and fully data-driven manner. Noise-assisted versions have been proposed to alleviate the so-called “mode mixing” phenomenon, which may appear when real signals are analyzed. Among them, the complete ensemble EMD with adaptive noise (CEEMDAN) recovered the completeness property of EMD. In this work we present improvements on this last technique, obtaining components with less noise and more physical meaning. Artificial signals are analyzed to illustrate the capabilities of the new method. Finally, several real biomedical signals are decomposed, obtaining components that represent physiological phenomenons.

@&#INTRODUCTION@&#
Empirical mode decomposition (EMD) [1] is an adaptive (data-driven) method to analyze non-stationary signals stemming from nonlinear systems. It produces a local and fully data-driven separation of a signal in fast and slow oscillations. At the end, the original signal can be expressed as a sum of amplitude and frequency modulated (AM–FM) functions called “intrinsic mode functions” (IMFs), or simply modes, plus a final monotonic trend. In this way, EMD is complete.The local nature of the EMD may produce oscillations with very disparate scales in one mode, or oscillations with similar scales in different modes. When this phenomenon is undesirable, and similar scales for each mode are preferred, this consequence of the method becomes a problem, named as “mode mixing”. To alleviate it, a new method was proposed: the ensemble empirical mode decomposition (EEMD) [2], which performs the decomposition over an ensemble of noisy copies of the original signal, obtaining the final results by averaging. The addition of white Gaussian noise reduces the mode mixing by populating the whole time–frequency space, taking advantage of the dyadic filter bank behavior of the EMD [3]. Thus, more regular modes are obtained, with similar scales for the whole time span. Even if EEMD has shown to be useful in a wide range of applications [4,5,16], it also created new difficulties. Indeed, as a consequence of the algorithm, the reconstructed signal, the sum of the modes and the final trend, contains residual noise. Also, different realizations of signal plus noise may produce a different number of modes, making difficult the final averaging. The Complementary EEMD [7] significantly alleviated the reconstruction problem by using complementary (i.e., adding and subtracting) pairs of noise. However, the completeness property cannot be proven, and the final averaging problem remains unsolved since different noisy copies of the signal can produce a different number of modes.The complete ensemble empirical mode decomposition with adaptive noise (CEEMDAN) [8] proved to be an important improvement on EEMD, achieving a negligible reconstruction error and solving the problem of different number of modes for different realizations of signal plus noise. Applications of this technique can be found in areas such as biomedical engineering [9], seismology [10,11] and building energy consumption [12].In spite of that, CEEMDAN still has some aspects in which it deserves to be improved: (i) its modes contain some residual noise; and (ii) the signal information appears “later” than in EEMD with some “spurious” modes in the early stages of the decomposition. The first two or three modes contain an important amount of noise and similar scales of the signal, as it can be seen in the signals analyzed in [8,13]. We address this two issues in the present paper.The paper is organized as follows. In Section 2 a brief explanation about EMD, EEMD and original CEEMDAN is given. In Section 3 we introduce the improvements on CEEMDAN. Section 4 is devoted to the experiments and results discussion. Section 5 concludes the paper.The EMD technique [1] decomposes a signal into a usually small number of IMFs. To be considered as an IMF, a signal must fulfill two conditions: (i) the number of extrema (maxima and minima) and the number of zero-crossings must be equal or differ at most by one; and (ii) the local mean, defined as the mean of the upper and lower envelopes, must be zero. The algorithm can be described as follows [1]:Step 1.Set k=0 and find all extrema of r0=x.Interpolate between minima (maxima) of rkto obtain the lower (upper) envelope emin(emax).Compute the mean envelope m=(emin+emax)/2.Compute the IMF candidate dk+1=rk−m.Is dk+1 an IMF?•Yes. Save dk+1, compute the residuerk+1=x−∑i=1kdi, do k=k+1, and treat rkas input data in step 2.No. Treat dk+1 as input data in step 2.Continue until the final residue rKsatisfies some predefined stopping criterion.The refinement process (steps 2 to 5) needed to extract every mode, requires a certain number of iterations and is named as sifting process.The ensemble version, EEMD [2], defines the “true” modes as the average of the corresponding IMFs obtained from an ensemble of the original signal plus different realizations of finite variance white noise. Let x be the signal of interest. The EEMD algorithm can be described as follows:Step 1.Generatex(i)=x+βw(i), wherew(i)(i=1, …, I) is a zero mean unit variance white noise realization, and β>0.Decompose completely each x(i) (i=1, …, I) by EMD, obtaining the modesdk(i), where k=1, …, K indicates the mode.Assignd¯kas the kth mode of x, obtained by averaging the corresponding modes:d¯k=1I∑i=1Idk(i).The extraction of everydk(i)requires a different number of sifting iterations.It can be noticed that in EEMD, every x(i) is decomposed independently from the other realizations and for every one of them a residuerk(i)=rk−1(i)−dk(i)is obtained at each stage, with no connection between the different realizations. This situation is the cause of some EEMD disadvantages: (i) the decomposition is not complete and (ii) different realizations of signal plus noise might produce different number of modes.In order to deal with the reconstruction error, the complementary EEMD [7] was proposed. Noise is added in pairs to the original data (one positive and one negative) to generate two ensembles(1)y1(i)y2(i)=111−1xw(i).Although this proposals significantly alleviates the residual noise in the reconstructed signal, there is no guarantee thaty1(i)andy2(i)will produce the same number of modes, making difficult the final averaging. Also, residual noise is present in the modes, as we will see in what follows.Taking into account these drawbacks, in [8,14] the authors proposed a new ensemble method called CEEMDAN. The general idea is the following: x(i) are generated from x and the first moded˜1=d¯1is computed exactly as in EEMD. Then, a unique first residue is obtained, independently from the noise realization:(2)r1=x−d˜1.After that, the first EMD mode is computed from an ensemble of r1 plus different realizations of a particular noise. The second moded˜2is defined as the average of these modes. The next residue is:r2=r1−d˜2. This procedure continues until a stopping criterion is reached.The next algorithm details the CEEMDAN method. Let Ek(·) be the operator which produces the kth mode obtained by EMD and letw(i)be a realization of zero mean unit variance white noise. Then:Step 1.For every i=1, …, I decompose eachx(i)=x+β0w(i)by EMD, until its first mode and computed˜1=1I∑i=1Id1(i)=d¯1.At the first stage (k=1) calculate the first residue as in Eq. (2):r1=x−d˜1.Obtain the first mode ofr1+β1E1(w(i)),i=1,…,I,by EMD and define the second CEEMDAN mode as:d˜2=1I∑i=1IE1(r1+β1E1(w(i))).For k=2, …, K calculate the kth residue:(3)rk=r(k−1)−d˜k.Obtain the first mode ofrk+βkEk(w(i)),i=1,…,I,by EMD until define the (k+1)th CEEMDAN mode as:(4)d˜(k+1)=1I∑i=1IE1(rk+βkEk(w(i))).Go to step 4 for the next k.Iterate the steps 4 to 6 until the obtained residue cannot be further decomposed by EMD, either because it satisfies IMF conditions or because it has less than three local extrema.Observe that, by construction of CEEMDAN, the final residue satisfies:(5)rK=x−∑k=1Kd˜k,with K being the total number of modes. Therefore, the signal of interest x can be expressed as(6)x=∑k=1Kd˜k+rK,ensuring the completeness property of the proposed decomposition and thus providing an exact reconstruction of the original data. The final number of modes is determined only by the data and the stopping criterion. The coefficients βk=ɛkstd(rk) allow the selection of the SNR at each stage.It was shown in [8] and [14] how CEEMDAN overcomes the main difficulties of EEMD, but it still has two problems, as it was stated in the Section 1. These issues, the presence of residual noise in the modes and the existence of spurious modes, are addressed in this Section.The main idea in the noise-assisted variations of EMD is to add some controlled noise to the signal in order to create new extrema. In this way, the local mean is “forced” to stick to the original signal in those portions where new extrema were created while it remains unmodified in the rest of the signal (where no creation of extrema occurred); i.e., the algorithm is forced to focus in some specific values of the scale-energy space. Averaging is meant to better estimate this local mean that is slightly different across the signal plus noise realizations.However, EEMD does not estimate local means but modes instead. This is because it independently decomposes each realization of signal plus noise, so at the first stage of each realization decomposition there is one local mean and one mode. It is impossible to proceed in a different way in EEMD, then the true mode is an average of modes of noisy copies of the original signal, containing some residual noise.On the other hand, CEEMDAN uses each final mode for the computation of the next one. Each mode is computed sequentially, in a deflationary scheme. Then, we can proceed differently from EEMD estimating the local means of each realization of signal plus noise and defining the true mode as the difference between the current residue and the average of its local means.Let us recall the operator Ek(·), and let M(·) be the operator which produces the local mean of the signal that is applied to. It can be noticed that E1(x)=x−M(x). Letw(i)be a realization of white Gaussian noise,x(i)=x+w(i), and 〈·〉 the action of averaging throughout the realizations. For the first EEMD and original CEEMDAN modes we have:(7)d˜1=〈E1(x(i))〉=〈x(i)−M(x(i))〉=〈x(i)〉−〈M(x(i))〉.By estimating only the local mean and substracting it from the original signal, we have:(8)d˜1=x−〈M(xi)〉.In this way, we obtain a reduction in the amount of noise present in the modes. We are replacing the estimations of modes for the estimations local means, which better reflects what we have stated in the first paragraph.In the original formulation of CEEMDAN [8], we computed the first mode in the same way as in EEMD (i.e., averaging first modes of signal plus white noise). To extract the rest of the modes we must add a different noise to the current residue. That particular noise is an EMD mode of white noise. For example, to extract the second moded˜2we must decompose different copies ofr1+E1(w(i)), where r1 is the first residue. This produces a strong overlapping in the scales we are focusing in for the first two modes (first one extracted adding white noise and the second one addingE1(w(i))). In order to reduce this overlapping, we propose here to make no direct use of white noise but use insteadEk(w(i))to extract the kth mode.Taking into account the two previous subsections, here we propose a new algorithm for CEEMDAN. We will make use of the already introduced operators M(·), Ek(·). Letw(i)be a realization of white Gaussian noise with zero mean and unit variance. With this in mind, we propose the improved CEEMDAN's algorithm as follows:Step 1.Calculate by EMD the local means of I realizationsx(i)=x+β0E1(w(i))to obtain the first residuer1=〈M(x(i))〉.At the first stage (k=1) calculate the first mode:d˜1=x−r1.Estimate the second residue as the average of local means of the realizationsr1+β1E2(w(i))and define the second mode:d˜2=r1−r2=r1−〈M(r1+β1E2(w(i)))〉.For k=3, …, K calculate the kth residuerk=〈M(rk−1+βk−1Ek(w(i)))〉.Compute the kth moded˜k=rk−1−rk,Go to step 4 for next k.Constants βk=ɛkstd(rk) are chosen to obtain a desired SNR between the added noise and the residue to which the noise is added. Notice that in EEMD, the SNR between the added noise and the residue increases with the order k. This is because the energy of the noise in the kth residue, k>1, is only a fraction of the energy of the noise added at the beginning of the algorithm. To emulate this behavior, in the present work we will set β0 in a way that ɛ0 is exactly the reciprocal of the desired SNR between the first added noise and the analyzed signal: if we express the SNR as a quotient of standard deviations, we haveβ0=ɛ0std(x)/std(E1(w(i))). In order to obtain noise realizations with smaller amplitudes for the late stages of the decomposition, in the rest of the modes we will use the noise as resulting from its pre-processing by EMD, i.e., without normalizing them by its standard deviation (βk=ɛ0std(rk), k≥1). Studies on the influence of this important parameter can be found in [14]. A flowchart of this new algorithm can be found in Fig. 1.In what follows, we will refer the method introduced in [8] as original CEEMDAN and the improved version here presented as improved CEEMDAN. In all implementations we used the EMD toolbox available at: http://perso.ens-lyon.fr/patrick.flandrin/emd.html. An implementation of the original formulation of CEEMDAN can be found at: http://www.bioingenieria.edu.ar/grupos/ldnlys/.

@&#CONCLUSIONS@&#
We proposed two major improvements on the CEEMDAN method. The avoidance of the spurious modes and the reduction in the amount of noise contained in the modes are important features which grant more physical meaning to the obtained results.In general, the addition of noise sets a global reference for the EMD method. Then, the noise-assisted variations of EMD are less local and less data-driven (because they are also driven by the noise) than noiseless version.We have shown the capabilities of the improved CEEMDAN method on artificial signals, confirming the theoretical improvements with respect to the original formulation. We have also illustrated the potentiality in the analysis of real biomedical signals, extracting relevant information associated with physiological processes of the systems involved in its production.Finally, we propose this improvement to become the new standard for CEEMDAN and a reference method for the noise-assisted variation of empirical mode decomposition.