@&#MAIN-TITLE@&#
A microscale bone remodeling simulation method considering the influence of medicine and the impact of strain on osteoblast cells

@&#HIGHLIGHTS@&#
Proliferation, differentiation and drugs influence were considered.A so called domain separated method (DSM) was proposed to establish FE mesh model.Formation rate was calculated based on vitro cell experiment data.Several interesting sets of bone remodling simulations results were presented.

@&#KEYPHRASES@&#
Bone remodeling,Microscale,Medicine influences,

@&#ABSTRACT@&#
Bone remodeling is an evolutionary process of microstructure configuration that occurs under a variety of external stimulations. Critical to the process are the osteoblast and osteoclast cells, which relate to bone formation and absorption. Unlike osteoclast cells, the osteoblast cells are sensitive to mechanical strain, which indicates that mechanical strain plays a key role in the bone remodeling process. In this paper, a modified governing equation for bone remodeling is proposed to simulate the remodeling process at a microscale. Equivalent strain was used as the stimulus, and the influence of medicine was taken into account. A forward Euler integration method and a strain distribution solver, Abaqus/standard, were used to solve the governing equation. Three sets of simulations were conducted based on the idealized microstructure configuration, the semi-idealized microstructure configuration (the space truss structure) and the actual bone microstructure configuration derived from a Micro-CT scan experiment. The results indicate that mechanical load eventually determines the microstructure configuration as bone structure attempts to support the mechanical load with minimal mass. The simulation confirms that Denosumab, which has been wildly used to treat osteoporosis, effectively increased bone density and decreased porosity. Furthermore, bone microstructure samples were obtained through the simulation to provide the elastic module – porosity data points. All of the simulations indicated that the proposed method was reasonable and effective.

@&#INTRODUCTION@&#
In the human body, cancellous bones are spongy-like structures consisting of interlaced rod-type or plate-type trabecular bone [1]. This type of bone is the primary component of pressure-bearing bones such as the spinal bones and the femoral head. The evolution of bone microstructure is a process wherein stimuli affect the osteoclast cells and osteoblast cells, which are closely associated with bone resorption and formation, respectively [2]. The bone microstructure evolution process is also often referred to as the bone remodeling process. The bone remodeling process is an important physiological mechanism that helps keep the bone structure functional and stable [3]. Once the dynamic balance of bone remodeling is broken, the patient may suffer osteoporosis or sclerosis. Mechanical stimulus plays a very important role in the remodeling process [4]. When the mechanical stimulus, known as strain, drops below a certain threshold, the osteoclast cells are activated and begin to absorb bone. Conversely, when the stimulus becomes higher than the threshold but remains within the physiological range, the activated osteoblast cells begin to format new bone [5]. Under some extreme circumstances when the stimulus is within a pathologic range, the bone matrix cracks, and a bone fracture occurs.The bone remodeling simulation method can be divided into two categories: macroscale and microscale according to the size of the simulation object. Macroscale bone remodeling [6,7] mainly focuses on the density redistribution inside the bone structure. Assuming the relationship between the density and elastic module, the density variation is calculated in accordance with the mechanical stimulus, which in this case, is the strain energy density. This method was frequently used to predict bone remodeling long after an orthopedic surgery [8,9] or implant [10–12]. Because the macroscale bone remodeling method only updated the density, it was incapable of simulating the morphological evolution of the bone structure. Concurrently, the microscale bone remodeling method deals primarily with the microstructure configuration [13,14], which is continuously evolving during remodeling. Depending on the mechanical stimulus, the bone matrix surfaces were either swallowed or grew outward. This resorption and formation mechanism led to a microstructure evolution.In macroscale bone remodeling simulation, the relationship between the mechanical stimulus and resorption/formation is relatively simple. A piecewise linear function is usually applied to describe the relationship [15,16]. More specifically, a ‘lazy zone’ [17] represents the interval at which the resorption rate and the formation rate remain in equilibrium. At the same time, increased mechanical stimulus enhances the formation, and decreased mechanical stimulus leads to local bone resorption. As density is used to represent the local microstructure and the mechanical stimulus distribution in the bone matrix (trabecular bone) is unattainable, the piecewise function involving the mechanical stimulus of each element is a successful simplification. However, in microscale bone remodeling simulation method, the mechanical stimulus distribution in the bone matrix (trabecular bone) is available, and a more complicated function based on remodeling mechanism is adopted [13,18–20].Scholars have proposed disparate mechanical stimuli as the basis for bone remodeling simulation methods. These include strain energy density (SED) [10–12], strain energy density rate (SED-R) [13,14], non-uniformity of the stress/strain distribution [21], etc. However, many osteoblast in vitro experiments [22] have shown that strain is the mechanical stimulus that influences proliferation [23] and differentiation [24]. Additionally, a low-frequency (0.2–1Hz) alternating strain stimulus was more effective than a constant strain stimulus [25].In this study, a microscale bone remodeling simulation method was proposed, and a corresponding governing equation was established. The equivalent strain was used as the mechanical stimulus; the proliferation and differentiation effect of the osteoblast cells affected by the equivalent strain were also considered, as was the influence of the different physiological conditions on the formation/resorption rate.This paper is organized as follows: a description of the governing equation and the solving scheme are given in Section 2. Several different numerical examples are presented in Section 3. The discussion and conclusions follow in Sections 4 and 5, respectively.In this section, the governing equation and solving scheme are detailed.Based on different mechanical strain, bone remodeling reveals varying characteristics in different stages. When the stimulus is lower than a threshold, the formation speed is lower than the absorption speed, and bone mass decreases. When the stimulus reaches a certain magnitude, the formation speed is higher than the absorption speed, and bone mass increases [4]. The threshold strain is equivalent to the very strain at which the formation speed equates to the absorption speed. Moreover, each bone inner boundary element is considered (Fig. 2) as a virtual remodeling site.At any time t, the bone mass variation rate in each remodeling site of the current micro-structure configuration is the combination of the formation and resorption, as outlined below(1)dmtotdt=dmbldt+dmcldtwhere dmcland dmblare the contribution of resorption and formation to the bone mass variation, respectively. Because resorption has nothing to do with mechanical strain,(2)dmcldt=−rclwhere rclis the resorption rate in each virtual remodeling site. And Eq. (2) was identical to the work of [13]. However, the osteoclast cells are sensitive to specific medicine (Denosumab) and hormones (Testosterone), so an impact factor η is introduced into Eq. (2):(3)dmcldt=−(1+η)rclandrcl=nPclρThe value of η is in the range of [−1,+∞), theoretically, and the upper and lower bounds represent infinitely enhancing and completely inhibiting bone resorption, respectively. According to the different types of medicine and the condition of the patient, η should be set to an appropriate value. n is the osteoclast cell density (the osteoclast cell number per a virtual remodeling site), Pclis the resorption rate per each osteoclast cell. ρ is the true density of the bone material.When the strain of the osteoblast cell is larger than the threshold strain Ktrand less than the failure strain Kf, the formation rate in each virtual remodeling site is(4)dmbldt=(1+λ)τiNPKtrρandτi=P(εi)⋅N(εi)Kf≥εi≥Ktrwhere εiis the mechanical strain of the osteoblast cell i caused by the adhesion bone matrix. PKtris the formation rate of a single osteoblast cell under threshold strain Ktr. N is the number of osteoblast cells per the virtual remodeling site. τiis the ratio of the formation rate between the current strain and the threshold strain. And τiincludes two parts: differentiation and proliferation. The osteoblast cell differentiates to osteocytes when it matures; during this process, the osteoblast cell secretes matrix and fiber, which turn into bone matrix. Thus, the differentiation factor P(εi) can be used to represent the formation rate ratio of a single osteoblast cell between the current strain εiand the threshold strain Ktr. Moreover, the total osteoblast cell numbers increase because of proliferation. Accordingly, N(εi) is defined as the ratio of total osteoblast cells between the current εistrain and the threshold strain Ktr. Based on the study of Yang [22], proliferating cell nuclear antibody (PCNA) and alkaline phosphatase (ALP) activities are chosen as the indexes for proliferation and differentiation, respectively. Two normalized piecewise functions are used to describe these effects based on the experiment data.Similar to η, λ is the theoretical medicine influence on the osteoblast cell in the range of [−1,+∞). The upper and lower bounds represent the infinitely enhancing and completely inhibiting bone formation, respectively. According to the different types of medicine and the condition of the patient, λ should be set to an appropriate value.When the mechanical strain of the basal bone matrix is larger than the failure strain Kf, the matrix is damaged.When the mechanical strain is lower than the threshold strain Ktr, the osteogenesis effect is still active but is always less than the formation effect under the threshold strain. This concept is outlined as follows:(5)dmbldt=(1+λ)εiKtrNPKtrρandεi<Ktr.The bone remodeling governing equation is a function of time and strain. A forward Euler integration method was implemented to solve the equation. At the current time tn, the strain field can be calculated through the Abaqus/standard using the microstructure configuration under certain mechanical loading. The resorption and formation is calculated per the governing equation. Then, a time step Δtnis determined based on the average single element resorption/formation period, as in Eq. (8). The microstructure configuration at time tn+1=Δtn+tnis updated. Until the configuration is stable, the process outlined above is repeated. See the flow chart below for the solving scheme inFig. 1.The microstructure evolution simulation is the most important subprocedure. There are two main steps in this subprocedure: (1) According to Eq. (1), the mass variation rate dmtot/dtis calculated based on the strain of the adhesion bone matrix as determined by the Abaqus/standard; (2) based on dmtot/dt, it can be determined whether the current bone matrix element will be swallowed by the osteoclast cells and become void or if it will grow to form new bone matrix elements. In the microstructure evolution subprocedure, the resorption phase and the formation phase co-exist. The resorption phase deals primarily with the bone matrix inner boundary element {Ei} of the current configuration, and the formation phase focuses on the outer boundary of the void elements {E′i}, which is connected with the bone matrix element and has the potential of becoming a bone matrix element. Thus, for every microstructure alteration, two collections {Ei} and {E′i} need to be updated by iterating all elements.Fig. 2 gives a visual representation of the inner boundary and outer boundaries. There are only two types of elements, i.e., bone matrix elements and void elements. Furthermore, there are only three different ways for any two elements to be directly connected, i.e., concurrent, collinear and coplanar (existing in 3D). Thus, the void elements which directly connect with the bone matrix are both the inner boundary of the void element and the outer boundary of the bone matrix elements, marked with a slash in the figure. The boundary element search algorithm is outlined below. It is worth mentioning that subscript i, j and k all represent element labels in the following sections.As previously mentioned, the two collections, {Ei} and {E′i}, are the inner boundary of the bone matrix elements and the inner boundary of the void elements, both of which require updating for each configuration. This search algorithm is valid for both collections because they are complementary, as seen in Fig. 2. The search process for the inner boundary of the void elements is as follows:(1)Assigning a flag value for each element ei, as(6)Fei={−1ifeiisvoid1ifeiisbonematrixFor any element eiwith a flag value Fei=−1, all of the connected elements ei,jcan be determined. Then, if the flag value of any of the related elements is opposite to the element ei, i.e., Fei,j=1, then the element eibelongs to the inner boundary of the void elements.The resorption phase is relatively simple. A temporary configuration should be obtained by deleting the bone matrix elements that were swallowed by the osteoclast cells from the current configuration. The discriminant of the bone matrix inner boundary element Eiwhether swallowed or not is(7){FEi=1ifPi⋅Δt+mvoxel>0FEi=−1ifPi⋅Δt+mvoxel≤0andΔt=12M∑i=1M(mvoxelPi)where M is the total number of bone matrix elements in collection{Ei}, mvoxelis the bone mass of a single element (voxel), and Piis the mass variation rate of element Ei. Eq. (7) shows that when the element Eiis completely swallowed, the element changed from bone matrix to void. However, when element Eiis partially swallowed, the element remains bone matrix. More specifically, each element has a status flag value of either 1 (bone matrix) or −1 (void). Thus, the flag value must be switched to identify the element as void or bone matrix. Moreover, in Abaqus/standard, if the element has flag value −1, it will not appear in the finite element mesh model. Therefore, only the bone matrix elements are included in the calculation file for Abaqus/standard.A unified step time must be determined. In this study, the step time Δtnof current step tnwas determined by Eq. (8)(8)Δtn=max(Δtnr,Δtn−1f)whereΔtnrandΔtn−1fare the resorption step time of the current time tnand the formation step time of the last time tn−1, respectively.The formation phase then proceeds according to the temporary configuration. Initially, the new collections of {Ei} and {E′i} are updated according to the temporary configuration. Then the mass variation rate Pican be calculated for each bone matrix inner boundary element Ei. And for each void elementE′i, the mass variation rateP′iis the summation of all contributions from the connected bone matrix element Ek, i.e.,P′i=ΣP′i,k, whereP′i,kis partial of Pkwhich stands for the element Ek. Thus, the new configuration can be updated after every potential void element is processed. The allocation algorithm of the mass variation rate will be listed in the following paragraph.The allocation algorithm is used to distribute the total mass variation rate of the current bone elements (the inner boundary element of the bone matrix) to the related void elements for further calculation. The main concept underlying this method is that the allocated mass variation rate is related to the distance between the void elements and the bone elements. As seen in Eq. (9), Piis the total mass variation rate of the bone matrix inner boundary element Ei, which can be calculated with Eqs. (4) and (5). Wjis the weight of the connected void elementE′j, WTis the total weight of all related void elements, li,jis the distance between void elementE′jand the bone matrix inner boundary element Ei. There are only three values for li,j: 1,2and3, which represent the coplanar, collinear and concurrent relations between EiandE′j.(9)Wj=1/li,jWT=∑WjPj,i′=Pi⋅Wj/WT.

@&#CONCLUSIONS@&#
Based on three different types of microstructure, the idealized microstructure, the semi-idealized structure (space truss structures) and the actual bone microstructure, the remodeling processes under different external loads were simulated. The following conclusions have been made:(1)Under an equal triaxial stress external load, the idealized structure maintained its topological characteristics during the entire remodeling period.Under a different external load, the space truss structure remodeling revealed a strong adaptability to the external load. The microstructure was always evolving to withstand the external load with minimum mass by disconnecting the old trabeculae and reconstructing new trabeculae to form a new structure.Through the remodeling simulation of the real bone microstructure, it was found that (a) the bone microstructure evolved over a long process into an optimal structure. After 3 years, the structure continues to evolve in the optimal structure, even under a single load. It is not hard to imagine that because of the diversity of the external load and internal metabolism perpetually changing in the human body, the bone microstructure will always continue along the evolutionary path to an optimal structure. (b) Denosumab, which is an inhibitor to osteoclast cell activity, can effectively improve bone mineral density and reduce porosity. These findings show that the method proposed can accommodate drug treatment effects. (c) The proposed method can be used to generate enough random specimens for statistical analysis. These specimens involve a wide porosity distribution range because of the diversity of the external load. This range compensates for the bone material experiment disadvantages to specifically include the number limitation and the comparatively concentrated porosity of the real bone specimens.The main difference between microscale and macroscale bone remodeling simulation is the size of the structure and the discrete element. The resolution of the image data obtained from the CT scan experiments is at the millimeter level. The resolution of the image data obtained from the micro CT experiments, which, unlike the CT, contain too much radiation for the human body and can only scan an in vitro sample at the micrometer level. High-resolution peripheral quantitative computed tomography (HR-pQCT) allows for the quantification of the trabecular and cortical structure in vivo, and it includes a capability for generating images at a hundred micron resolution. This makes the bone remodeling simulation method under microscale suitable for macro structures, which is the future research of this study.