@&#MAIN-TITLE@&#
Domain decomposition based finite element verification in linear framework

@&#HIGHLIGHTS@&#
We study finite element quality in linear elasticity.We use constitutive relation error estimator.We consider an original construction of admissible field using domain decomposition.We illustrate the strategy.

@&#KEYPHRASES@&#
Domain decomposition,Finite elements,Admissible field,Error,

@&#ABSTRACT@&#
The objective of this work is to obtain an a posteriori estimate of the discretization error of a reference problem. This reference problem is a mechanical problem solved using a finite element analysis in linear elasticity. We use the constitutive relation error based estimator. The construction of admissible fields, which is a pillar of the constitutive relation error method, is revisited using a domain decomposition method.The originality of the present work is the introduction of a simplifying hypothesis that leads to an approximation of the discretization error. The construction of admissible fields, which is global, is then replaced by resolution of several local problems that conduce to lower CPU costs. The key point of this domain decomposition based error estimation is the fact that no inter-subdomain communication is needed. We present and illustrate this strategy and evaluate its benefits.

@&#INTRODUCTION@&#
In the field of mechanical engineering, numerical simulation has become an indispensable tool to predict the response of a structure to various solicitations. These numerical simulations involve the use of a discretized version of an initially continuous mathematical model (finite element analysis) that leads only to an approximation of the exact solution of the reference problem. In industrial situations, the Finite Element (FE) simulations have to satisfy both requirements of quality and CPU cost. On one side, quality requirement of the simulation, which is the purpose of verification consists in evaluating the distance between the exact solution and an approximated solution of the problem. A state-of-the-art review on verification can be found in [13,1]. On the other side recent development of parallel computers brought the foreground new simulations methods to achieve better CPU Cost. In particular, Domain Decomposition Method (DDM) is a more and more used strategy to take advantage of multicore processors or multiprocessor systems.In Parret-Fréaud et al. [19], the proposed error estimator is strongly linked to the domain decomposition finite element based simulation, and is used to control the simulation. In this work, a new domain decomposition technique is introduced to compute the Finite Element analysis error, which takes a different path by defining totally independent calculations on each sub-domains. The main interest is a gain on CPU costs, the main drawbacks are a degraded error estimation, and thus a small quality loss. Note that the origin of the Finite Element solution can be varied. In particular, whether the finite element analysis can be performed elements using a domain decomposition method or not, the method developed here applies.The objective of this paper is to illustrate that the quality loss is widely acceptable in a practical use. Section 2 reviews the equations of the reference problem and associated discretization and Section 3 reviews the constitutive relation error method and a technique for building admissible fields. Recovery of the admissible stress using a domain decomposition approach is introduced in Section 4. Sections 4 and 5 present some results obtained using these techniques.Let us consider a linear elastic static problem under the assumption of small transformations. The structure is defined in a domainΩbounded by∂Ω. The structure is submitted to a prescribed displacementu̲dover a part∂1Ωof the boundary∂Ω, a prescribed volume forcef̲dwithinΩand a prescribed surface force densityF̲dover∂2Ω=∂Ω−∂1Ω.Hence the reference problem: find the displacement fieldu̲(M̲)and the stress fieldσ(M̲), defined at all points M of domainΩ, which satisfies•the kinematic admissibility equations:(1)u̲∈U,u̲=u̲don∂1Ωthe static admissibility equations:(2)σ∈S,σ·n̲=F̲don∂2Ω(3)σ∈S,div̲(σ)+f̲d=0̲onΩand the constitutive relation:(4)σ=Kϵ(u̲)onΩIn practice, the exact solution of the reference problem(u̲ex,σex)is often unknown. Therefore, one calculates an approximate solution by introducing a discretized problem based on a weak formulation of the model׳s equations. This leads to an approximated pair(u̲h,σh)which is the solution of the discretized problem. This solution is defined from a set of approximate displacementsUh⊂U.Thus, the finite element problem consists in seeking the pair (u̲h,σh) which satisfies•the kinematic admissible equations:(7)u̲h∈Uh,u̲h|∂1Ω=u̲d,the equilibrium equation:(8)σh∈S,∫ΩTr[σh·ϵ(u̲h⁎)]dΩ=∫Ωf̲d·u̲h⁎dΩ+∫∂2ΩF̲d·u̲h⁎dΩ,∀u̲h⁎∈Uad,0∩Uh,and the constitutive relation:(9)σh=Kϵ(u̲h).The difference between the solution of the finite element problem (u̲h,σh) and the exact solution of the mathematical problem (u̲ex,σex) is called the discretization error. This error is due mainly to the approximation concerning the equilibrium equations, the spatial discretization of the geometry or the approximation concerning the loading.For the purpose of dimensioning the structure, it is important to quantify that error and, if possible, to obtain an upper bound. A global measure of the error is defined by(10)e=∥σex−σh∥K−1,Ω,whereσexis the stress field which is the exact solution of the reference problem andσhis the approximated stress field obtained using the finite element method. The energy norm is based on Hooke׳s tensorKonΩ:(11)∥•∥K−1,Ω2=(•,•)K−1,Ω=∫ΩTr[•K−1•]dΩ.To estimate e, we use an error estimator based on the constitutive relation error (CRE), see Ladevèze and Pelle [13]. A measure of the non-verification of the constitutive relation by an admissible pair(u^̲,σ^)is introduced:(12)eCRE2(u^̲,σ^)=∥σ^−Kϵ(u^̲)|K−1,Ω2.A pair(u̲^,σ^)is said to be admissible ifu̲^satisfies Eq. (1) and ifσ^satisfies Eqs. (2) and (3). Since fieldu̲hsatisfies Eq. (7), it necessarily satisfies Eq. (1); therefore, one generally choosesu^̲=u̲h. The construction of fieldσ^is reviewed in Section 3.2. The error in constitutive relation satisfies the Prager Synge relation Prager and Synge [21] which leads to the following upper bound:(13)e≤eCRE.This upper bound of the global error can be used to obtain bounds of the local quantities thanks to the introduction of a dual problem, see Becker and Rannacher [3]. The contributions of this error can also be used to perform an adaptative mesh refinement, see Florentin et al. [5].While the admissible displacement field construction is straight forward, the construction ofσ^requires a specific recovery step based on the finite element solutionσhand the data of the reference problem. Different paths can be used see e.g. [18,19,16,9]. The construction we use here consists of two steps:•Construction of nodal densitiesF̲^hThe nodal densitiesF̲^hare defined along the edgeΓbelonging to∂E, the set of the edges of each element. These densities are calculated to be in equilibrium with the problem׳s boundary conditions, i.e. they satisfy:(14)F̲^h=F̲don∂2Ω(15)∫Ef̲d·U̲h⁎dE+∫∂EηEΓF̲^h·U̲h⁎dΓ=0,∀U̲h⁎solidbodymotionofE.In order to guarantee the continuity of the loads along edgeΓassociated to E, we have introducedηEΓ=±1, withηEiΓ·ηEjΓ=−1for two adjacent elements Eiand Ej, see Ladevèze and Pelle [13] for more details. FieldF̲h^can be built in several ways. For this work, we chose what is called the “optimal method”, which consist in a global minimization problem defined onΩ, see [6] for more details.Construction ofσ^fromF̲^hOnce fieldF̲h^has been calculated, the field of the admissible stresses is built element by element. Analytical methods can be used, see Ladevèze and Pelle [13]. One can also use a numerical method. For example, in Babuska et al. [2], it is showed that the construction of the stresses in each element through the resolution of a higher-order finite element calculation leads to good results. Thus, one has an implicit link between stressσ^andF̲^h:(16)σ^=l(F̲^h)where l is a linear mapping which corresponds to the resolution of an elastic problem for each element. The details of the construction of l can be found in [6].The proposed approach presented here shows that the method proposed in Florentin et al. [6] can be approximated using an efficient strategy based on a domain decomposition method.To lower the CPU cost, the error estimation is computed using a technique of domain decomposition. Let consider a partition ofΩinnSDsubdomains Ωisuch that(17)Ω=⋃i=1nSDΩiandΩi∩Ωj=∅,∀i≠j.By doing so, actual error e is splitted into contributions eias follows:(18)e2=∑i=1nSD∥σex−σh∥K−1,Ωi2=∑i=1nSDei2.Constitutive Relation Error based estimator requires admissible fields construction. Because the construction is global onΩ, building such an admissible field is the main difficulty of the method. For example, if one considers 2 adjacent subdomains Ωiand Ωj, the stress vector or traction must be continuous through the interface to be admissible. The construction of an admissible stress field is necessarily global, the optimal path to construct it is developed in Florentin et al. [6] and consists in minimizing a global function defined onΩ. The main disadvantage of this method is the CPU cost.Different ideas have been proposed to build such admissible stress field independently on each subdomain. For example, in [10,17], the buildings are purely computed on local sets of adjacent elements. The main disadvantage is that the resulting fields is far from the optimal one. On the other hand, these approaches are easily computable on parallel computers (Figs. 1 and 2).The approach proposed here is based on a domain decomposition where each term∥σex−σh∥K−1,Ωi2is estimated separately and independently on corresponding subdomain Ωi. This method is then easy to compute using parallel computers. The results are very close of those obtained with the optimal method.The idea is to construct admissible fields for Child Problems defined on each subdomain Ωi. Then we estimate distance between each local Child Problem and the restriction to Ωiof the reference problem solution.A child problem denoted Ciis defined on each subdomain ΩiofΩ. The boundary conditions on the boundary∂Ωiof Ωiare defined from the approximated solution of reference problem. The material is the same as for the reference problem. Displacement and stress fields are indexed with i.The child problem Ciconsists in: find the displacement fieldu̲˜i(M̲)and the stress fieldσi˜(M̲), defined for all point M of structure Ωi, which satisfies•the admissibility equations:(19)u̲˜∈U,u̲i˜=u̲hon∂Ωi,the equilibrium equations:(20)σ˜∈S,div̲(σi˜)+f̲d=0̲onΩi,the constitutive relation:(21)σi˜=Kϵ(u̲i˜)onΩi.The exact solution of the child problem, denoted(u̲˜i,ex,σ˜i,ex)is different of(u̲ex,σex)on the restriction ofΩon Ωi. The difference between this two solutions defines the errorei,pbbetween reference problem and child problem on Ωi:(22)ei,pb=∥σex−σ˜i,ex∥K−1,Ωi.It is interesting to note that on Ωithe finite element solution (u̲h,σh) of the reference problem is also a finite element approximate for the child problem:(23)(u̲˜i,h,σ˜i,h)=(u̲h,σh)onΩi.As in the case of the reference problem, one can define the concept of admissibility to zero. The spacesUad,0Ωi˜andSad,0Ωi˜are expressed as(24)Uad,0Ωi˜={u̲|u̲∈U,u̲=0̲on∂Ωi}and(25)Sad,0Ωi˜={σ|σ∈S,div̲(σ)=0̲onΩi}.We illustrate here how the estimation of e can be performed using property of each Child problem solution.The error eican be split into two parts:(26)ei2=∥σex−σh∥K−1,Ωi2=∥σex−σ˜i,ex∥K−1,Ωi2+∥σ˜i,ex−σh∥K−1,Ωi2=ei,pb2+e˜i2.The termei,pb=∥σex−σ˜i,ex∥K−1,Ωicorresponds to the error between the child problem and the reference problem. Indeed, in Eq. (22)),σexrepresents the solution of the reference problem andσ˜i,exrepresents the solution of the child problem; thenei,pbrepresents the “distance” between this two problems. The terme˜i=∥σ˜i,ex−σh∥K−1,Ωi2corresponds to the discretization error of the child problem (see Eq. (23)).The proof of Eq. (26) is straightforward, as far as:(27)(σex−σ˜i,ex)∈Sad,0Ωi˜,and(28)(σ˜i,ex−σh)=Kϵ(u̲˜i,ex−u̲h)with(u̲˜i,ex−u̲h)∈Uad,0Ωi˜,then(29)(σex−σ˜i,ex,σ˜i,ex−σh)K−1,Ωi=0Here, our objective is to estimate the two termsei,pbande˜iintroduced previously in Eq. (26).•estimation ofe˜iThe terme˜ican be estimated directly because it corresponds to a discretization error for a problem (the child problem) which is completely known and whose discretized solution (σh=σ˜h) is available. One can apply the constitutive relation estimation techniques on the subdomain Ωi, build an admissible fieldσ˜^ifor this child problem and obtain the error∥σh−σ˜^i∥K−1,Ωiin a totally independent manner on each subdomain Ωi. Therefore, the estimate of terme˜icorresponds to a strict upper bound:(30)e˜i≤∥σh−σ˜^i∥K−1,ΩiIt is important to remark thatσ˜^iis statically admissible regarding the child problem equations but not statically regarding reference problem.estimation ofei,pbA classical way to estimate the error between two exact quantities Δexis to use their discrete representations Δh:(31)Δex≈ΔhHere, we chooseσhto representσex(because it is an easily available quantity) and we chooseσ˜^ito representσ˜exon Ωi. Thus, the estimate proposed for epbis(32)ei,pb≈∥σh−σ˜^i∥K−1,Ωi.Thus an approximation of our global error eiis(33)ei2⪅2·∥σh−σ˜^h∥K−1,Ωi2.And finally an approximation of e on the complete domainΩis(34)e2⪅2·∑i=1nSD∥σh−σ˜^h∥K−1,Ωi2.Remark: Because of the assumption onei,pb, this upper bound is not guaranteed, see Eq. (31). However, one can assume that the approximation introduced in Eq. (32) tends to produce an upper bound numerically.The studied domain is a rectangular plate with uniformly distributed holes. The structure is clamped on both right and left sides and submitted to a distributed force on the upper side, see Fig. 3.The structure is meshed with 6 refinement levels denoted N10 to N60 hereinafter. This corresponds to a number of Degree Of Freedom (DOF) denoted nDOFvarying between 28,918 and 978,814, see Table 1.The global error estimator associated to the Child Problem Equation (34) is defined as(35)eSD2(nSD)=2·∑i=1nSD∥σh−σ˜^h∥K−1,Ωi2Estimator eOptcorresponds to the method described in Florentin et al. [4], which is a mathematical upper bound of the actual error. In Florentin et al. [4] and Ladevèze and Moës [12] are presented a complete study of the comparison between eOptestimate and ZZ estimate (see [23]). The results of this studies conduce to a practical result: eOptis systematically greater than ZZ estimate.Fig. 4shows plotseSD(1)and eOptversus nDOF. EstimatoreSD(1)corresponds to the method described in Section 4 in the particular case of a unique subdomain (i.e.nSD=1).It is observed that global erroreSD(1)is greater than eOptbut is still close and have same trends. This has been already shown on others numerical example in Pavot et al. [20]. Indeed, the difference between the two estimators is due to the approximation made for prescribed forces on the edges∂2ΩforeSD(1). We keep later in this study estimatoreSD(1)as a reference estimator. This choice is particularly suitable to study the effect of nSDon the introduced approximation (splitting into subdomains).Remark: using the results of the comparison mentioned above (see [4,12]), one can easily conclude thateSD(1)is greater than a ZZ estimate.We are interested here in the study of the deterioration of the proposed method with the number of subdomains used to build error estimate and associated admissible fields. Deterioration is defined as a ratio:(36)d(nSD)=eSD(nSD)eSD(1).One plots in Fig. 5the degradationd(nSD)versus nSD. The number of subdomains varies betweennSD=1andnSD=180and have similar geometries due to the repetitive pattern of the structure.It is observed that the deterioration decrease weakly, which means that the gap betweeneSD(nSD)andeSD(1)increase. Ideally, a DDM does not depend on the number of substructure, and solutions would correspond to the one computed with one subdomain, i.e.d(nSD)=1,∀nSD.In Fig. 5, we see thatd(nSD)≈1,∀nSDfor high levels of discretization (here N50 and N60). There is an influence for coarser discretization (N10–N40). This observation tends to highlight the fact that unsufficiently refined subdomain leads to deterioration of the global error evaluation. Here appears the principal defect in Child Problem approach, because the number of sub-domains has an influence on the result. This is the counterpart of the fact that the error can be estimated independently on each subdomain.It is observed that even if there is an influence, it remains low (maximum 5%), which validates the method for this example were a relatively consistent number of subdomains to be used (nSD=180).By nature the method is fully parallelizable and requires no exchange. Indeed, the contributions are collected on each subdomain and are added at the end. We define the dimensionless computation time by the ratio:(37)C(nSD)=∑inSDti,nSDt1,1whereti,jis the computation time of the subdomain i for a decomposition ofΩin j subdomains. The reference is thent1,1, which correspond to compute the method fornSD=1. The valueC(nSD)=1means that the calculation time innSDsubdomain is the same as for 1 subdomain. It also means that if the calculations are distributed on nSDcomputers, the result is obtained approximately nSDtimes faster (with uniform subdomains decomposition distribution).Fig. 6shows, for different level of discretization (N10–N60), the evolution ofC(nSD)with nSD. In Fig. 6, it can be seen that the method can be useful even if used in a sequential manner (i.e.C<1). This corresponds to sufficiently refined sub-domains, which is the case for levels N50 and N60. For coarser discretizations (N10–N40), a sequential manner on a unique processor is not interesting (i.e.C>1). The resolution remains naturally interesting if computed on several processors, or parallel machine.Remark: Levels N50 and N60, which correspond to sufficiently refined subdomain correspond to both:•sequential CPU cost saving andquality requirements for good estimation of global error.Remark: It is interesting to note that for coarse subdomain, constantC>1is certainly due to time preparation of each of the subdomain data which take an important part of function cost C).A second example is tested to verify the robustness of the method using different conditions. More specifically, a validation is performed on the quality of the method when using unregular shaped subdomains. The studied example is clamped at bottom and submitted to lateral forces, see Fig. 7.The chosen discretization corresponds to a number of Degrees Of FreedomnDOF=231,426. The number of subdomains varies betweennSD=1andnSD=1792, which corresponds to a wider range of variation than on the previous example. Subdomains are automatically created by GMSH, irregularly with similar sizes (Fig. 8), see Geuzaine and Remacle [8].Fig. 9shows evolution ofd(nSD), defined in Eq. (36), versus nSD. It is observed that the estimate quality decreases slightly with a maximum error of 3%.One can conduct the same kind of study at a local level. Let consider the contribution of zoneω⊂Ωto the global error estimate defined on the domainΩ, and its associated deterioration defined by(38)dloc,ω(nSD)=eSD,ω(nSD)eSD,ω(1)witheSD,ωthe contribution of zone ω to global error eSD. Two zones of interest regarding the discretization error (ω=Aandω=B) are defined in Fig. 10. Associated valuesdloc,ωare also plotted versus nSD.In Fig. 10, we observe that similar conclusions can be drawn at local and global levels.The same kind of CPU cost study can be done as in Example 1. In Fig. 11, one plotsC(nSD), defined in Eq. (37), versus nSD.This results extend the study carried out in Example 1 with subdomains defined irregularly. The subdomain discretization level which is coarse, in this case, conduces toC>1, confirming the conclusions drawn in Example 1. This means that if simulations are performed sequentially on a mono-processor machine, the method is not interesting from CPU cost point of view. Nevertheless, the method remains systematically efficient in case of parallel computing. Conventionally, the speed-up S is introduced to characterize the gain when performing parallel resolution:(39)S(nPro)=t1,1supiti,nPro.Ideal speed-up is generally defined bySideal(nPro)=nPro. Let us study S versus nPro, the number of processor used. For this study we choosenPro=nSD. One plots in Fig. 12the evolution of speed-up S versusnPro.

@&#CONCLUSIONS@&#
