@&#MAIN-TITLE@&#
Expert system supporting an early prediction of the bronchopulmonary dysplasia

@&#HIGHLIGHTS@&#
We construct a database of214results of both logit regression and SVM models.Our expert system finds the best method and model to use in given circumstances.Accuracy, sensitivity and specificity are estimated for user selected model.Bronchopulmonary dysplasia diagnosis is predicted with the accuracy up to 83.25%.

@&#KEYPHRASES@&#
Machine learning,Feature selection,Chronic lung disease,Prediction,Bronchopulmonary dysplasia,Expert system,Support vector machine,Logit regression,Prematurity,Low-birth-weight infant,

@&#ABSTRACT@&#
This work presents a decision support system which uses machine learning to support early prediction of bronchopulmonary dysplasia (BPD) for extremely premature infants after their first week of life. For that purpose a knowledge database was created based on the historical data gathered including data on 109 patients with birth weight less than or equal to 1500g. The core of the database consists of support vector machine and logit regression classification results calculated specifically for that system, and obtained by considering214different combinations of 14 risk factors. Based on the results obtained and user demands, the system recommends the best methods and the most suitable parameter subset among those currently available to the user. The program is also able to estimate the accuracy, sensitivity and specificity together with their standard deviations. The user is also given information on which additional parameter it is worth adding to his measurement system most and what an increase in prediction efficiency it is expected to trigger. The BPD can be predicted by the system with the accuracy reaching up to 83.25% in the best-case scenario, i.e. higher than for most of the models presented in the literature. This work presents a set of examples illustrating the difficulties in obtaining one single model that can be widely used, and thus explaining why an expert system approach is much more useful in day-to-day clinical practice. In addition, the work discusses the significance of the parameters used and the impact of a chosen method on the sensitivity and specificity.

@&#INTRODUCTION@&#
Bronchopulmonary dysplasia (BPD) is a chronic pulmonary disorder affecting premature infants [1], which results in significant morbidity and mortality: almost a third of infants with birth weight lower than 1000g [2] are affected. This chronic lung disease is most common among children with low birth weight and those who received prolonged mechanical ventilation to treat the respiratory distress syndrome. Due to the fact that the disease is poorly understood, many research projects are focused on identifying its risk factors. It is known that steroids applied before the eighth day of life can prevent BPD development; however, the risks of such treatment may outweigh the benefits [3]. Since illness cannot be diagnosed until the 28th day of life [4], it is very important to predict such a result by the end of the first week, which would enable early intervention and an increased likelihood of preventing the disease [3]. Therefore, an intensive work has been done to define a classifier, based on static parameters (gathered just after birth) and dynamic ones (collected during the first week of life), which would be able to predict the diagnosis. The literature [5–15] reports several prediction models of BPD used in the research. However, none of them could be used in common clinical practice due to a variety of reasons. For instance, when for some reason there was no technical capability to measure one of the parameters just after birth or the mensuration was delayed, no models based on that variable can be used. Similarly, when using roentgenographic scoring systems – an image of sufficient quality which could be compared with a database, especially by a machine, is extremely hard to obtain, because of ceaseless child movements. Therefore, it is essential to propose an expert system which could advise on which model and method to choose in a given situation.

@&#CONCLUSIONS@&#
It was confirmed that one of the most important risk factors mentioned in the literature [3,4,12–15,18,20–24,35] is the gage. The situation is similar for pda, which is reported on [3,4,9,14,16–18,20,22–24,31] as crucial. In that context the use of surfactant (surfact) seems to be more important than so far believed [30,31], especially when logit regression is used, which seems logical since it contains some unrevealed knowledge of the doctor who has administered it. Interestingly thelow85and bpmmean parameters, which are quite uncommon in the literature [26,27], turned out to be very important. The last feature which should be mentioned is bweight, which is common in the literature and increases prediction accuracy, but it does not seem to be crucial [20,30,31].Authors have found some new models which achieved higher accuracy than the ones referred to in the literature [5–15] (differences are between 1 and 10%), but the real value of research presented herein is the possibility to predict BPD in real-life situations. This paper presents some of the limitations encountered by doctors on a daily basis and because of which it is very hard to use a single model which could be deemed the best one. Therefore, the solution is to use an expert system, which will provide a user with the best method in a given situation and simply help make the right decision. The authors are aware of the fact that the system needs to be extended to include more prediction methods and explanatory variables such as already mentioned: radiological images scores, sex, race, ethnicity, respirator setting, etc. For practical reasons, it would be also very important to use historical data where BPD diagnosis is not a dichotomic variable, but is a grade of severity. Having such data, we could better predict not only the probability of the disease, but also its intensity. Providing a user with the possibility of searching for the best model not only by accuracy, but also by the sensitivity or specificity – depending on requirements – would be also very useful. The expert system presented is only the first step in such a type of doctors’ decision support, but we think that this is the direction worth developing.None declared.Probability of the dependent variable equaling a BPD positive diagnosis (yk=1), on the condition that the vector of explanatory variables (features of specific case k) equalsXk=(x1,k,x2,k,‥,xn,k), is defined as(A.1)pk=P(yk=1|Xk)=ea0+∑i=1naixi,k1+ea0+∑i=1naixi,k,wherexi,kis an explanatory variable value for feature i of case k, aiis a regression coefficients, and n is the number of features.In contrast to linear regression, where normal distribution of the independent variables is assumed, and because variances of explanatory variables are not equal, the method of least squares cannot be used to calculate regression coefficients. Thus, using learning data they are usually obtained with maximum likelihood estimation by maximizing likelihood function (L), which is the same problem as minimizing its negative logarithm:(A.2)L=∏yk=1pk∏yk=0(1−pk),(A.3)ln(L)=∑k=1m[yk·ln(pk)+(1−yk)·ln(1−pk)],where k is an observation number (learning case), ykis a diagnosis for case k, and m is the number of observations.Having regression coefficients ai, the probability of positive BPD diagnosis case X can be easily predicted using Eq. (A.1).The learning data D divided into two classes y is defined as(A.4)D={(Xk,yk)|Xk∈Rn,yk∈{1,−1}}k=1m.The solution which is being searched for is a hyperplane W(A.5)W·X+b=0that separates the two classes, and provides maximum margin, as in Fig. A1, which is an equivalent of L-minimizing problem(A.6)L(W)=∥W∥22+c·∑k=1mεk,with conditions(A.7)yk(W·ϕ(Xk)+b)≥1−εkwhereε≥0is a slack variable,c>0is a penalty parameter for each incorrectly classified point, and ϕ is a kernel function:(A.8)K(Xi,Xj)≡ϕ(Xi)Tϕ(Xj),Linearly inseparable problems, thanks to the use of a kernel function, could be transformed into some higher dimensional space, in which there is much higher likelihood that classes would be separable. It should be noted that we use the function K Eq. (A.8) which defines only a dot product of Xiand Xjin some higher dimensional spaceH. K can be interpreted as measure of similarity between border points (Support Vectors) and the ones being classified in the space mentioned. Owing to what is known as ”kernel trick”, hyperplane W is never explicitly calculated, and it is not even required to know function ϕ which maps data to some (possibly infinite dimensional) spaceH[29]. Since in our research we used sigmoid kernel function Eq. (1) for which ϕ exist only in an infinite dimensional space, we were not able to produce any figure presenting that transformation even for two features. Therefore, what Figs. A1 and A2show is just the ideas of maximizing the margin and data remapping, but they do not contain any real data.(B.1)AA=pO2pATM·FiO2−pCO2,where pO2 is the oxygen partial pressure, pATMis the atmospheric pressure, pCO2 is the carbon dioxide partial pressure, and FiO2 is a fraction of inspired oxygen.See Fig. C1.