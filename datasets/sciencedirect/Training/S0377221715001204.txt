@&#MAIN-TITLE@&#
A branch-price-and-cut algorithm for the minimum evolution problem

@&#HIGHLIGHTS@&#
We study the Minimum Evolution problem (MEP), which arises in Computational Biology.We study the polyhedral combinatorics of the MEP.We present an exact solution approach for the MEP.We study relationships between the MEP and the Balanced Minimum Evolution Problem.We show the statistical consistency of the MEP.

@&#KEYPHRASES@&#
Combinatorial inequalities,Branch-price-and-cut,Symmetry breaking,Tree isomorphism,Computational biology,

@&#ABSTRACT@&#
We investigate the Minimum Evolution Problem (MEP), anNP-hard network design problem arising from computational biology. The MEP consists in finding a weighted unrooted binary tree having n leaves, minimal length, and such that the sum of the edge weights belonging to the unique path between each pair of leaves is greater than or equal to a prescribed value. We study the polyhedral combinatorics of the MEP and investigate its relationships with the Balanced Minimum Evolution Problem. We develop an exact solution approach for the MEP based on a nontrivial combination of a parallel branch-price-and-cut scheme and a non-isomorphic enumeration of all possible solutions to the problem. Computational experiments show that the new solution approach outperforms the best mixed integer linear programming formulation for the MEP currently described in the literature. Our results give a perspective on the combinatorics of the MEP and suggest new directions for the development of future exact solution approaches that may turn out useful in practical applications. We also show that the MEP is statistically consistent.

@&#INTRODUCTION@&#
Molecular phylogenetics studies the hierarchical evolutionary relationships among species, or taxa, by means of molecular data such as DNA, RNA, amino acids, or codon sequences. These relationships are usually described through a weighted tree, called a phylogeny (see Fig. 1), whose leaves represent the observed taxa, internal vertices represent the intermediate ancestors, edges represent the estimated evolutionary relationships, and edge weights represent evolutionary processes (e.g., evolutionary rates, expected number of mutations, and so on) between pairs of taxa (Felsenstein, 2004). As usual in most of the literature, in this paper the leaves of a phylogeny are labeled in order to identify the given taxa, whereas the internal vertices are unlabeled.Phylogenies provide fundamental information in the analysis of many fine-scale genetic data. For this reason, the use of molecular phylogenetics has become more and more frequent (and sometimes indispensable) in a multitude of research fields such as systematics, medical research, drug discovery, epidemiology, and population dynamics (Pachter and Sturmfels, 2007). For example, the use of molecular phylogenetics was of considerable assistance in predicting evolution of human influenza A (Bush, Bender, Subbarao, Cox, and Fitch, 1999), understanding the relationships between the virulence and the genetic evolution of HIV (Ou et al., 1992; Ross and Rodrigo, 2002), identifying emerging viruses such as SARS (Marra et al., 2003), recreating and investigating ancestral proteins (Chang and Donoghue, 2000), designing neuropeptides causing smooth muscle contraction (Bader, Moret, and Vawter, 2001), and relating geographic patterns to macroevolutionary processes (Harvey, Brown, Smith, and Nee, 1996). More recently, phylogenies have been used to study the evolutionary relationships of the genetic factors involved in common human diseases (Misra, Blelloch, Ravi, and Schwartz, 2011; Pennington, Smith, Shackney, and Schwartz, 2006; Sridhar et al., 2007; Sridhar, Lam, Blelloch, Ravi, and Schwartz, 2008). Similarly, phylogenies have been also employed to reconstruct a plausible progression of carcinomas over time (Riester, Attolini, Downey, Singer, and Michor, 2010; Subramanian, Shackney, and Schwartz, 2013) by using, in particular, single-cell sampled data from affected individuals (Catanzaro, Schackney, and Schwartz, 2013; Chowdhury et al., 2013). In this context, phylogenies allowed the classification of tumor cells in subfamilies characterized by specific evolutionary traits. This classification might enable a better understanding of cellular atypia over time and, on a long run, suggest new therapeutical approaches for tumor pathologies. A recent survey concerning the practical uses of molecular phylogenetics can be found in Beerenwinkel, Schwartz, Gerstung, and Markowetz (2015).The internal vertices of a phylogeny of n taxa represent speciation events occurred throughout evolution of the observed taxa and are usually constrained to have degree three. This constraint has both a biological foundation (see Felsenstein, 2004) and a mathematical motivation, as it proves helpful when formalizing the evolutionary process of taxa. In fact, it does not introduce oversimplifications, as any m-ary tree can be transformed into a phylogeny by adding “dummy” vertices and edges, e.g., see Fig. 2. Moreover, as observed in Felsenstein (2004), the degree constraint helps both in quantifying a priori the number of edges and internal vertices of a phylogeny (2n−3and n−2,respectively), otherwise hard to determine, and in counting the overall number of possible phylogenies for a set of n taxa, (i.e.,(2n−5)!!=1×3×5×7×⋯×(2n−5)). The large number of possible phylogenies for a set of n taxa entails the use of an estimation criterion to select a phylogeny from among plausible alternatives.The literature on molecular phylogenetics proposes a number of possible criteria to estimate phylogenies from molecular data. Apart from particular cases (e.g., Bayesian Inference, Huelsenbeck, Larget, Miller, and Ronquist, 2002; Huelsenbeck, Ronquist, Nielsen, and Bollback, 2001), these criteria can be quantified and expressed in terms of objective functions, giving rise to families of optimization problems, whose general paradigm can be stated as follows:Problem 1The Phylogeny Estimation Problem (PEP)Given a set Γ of n taxa, find a phylogeny T* that solves the problemoptimizeΛ(T)s.t.Ω(Γ,T)≥0T∈T,whereTis the set of all possible phylogenies of Γ,Λ:T→Ris a function modeling the selected criterion of phylogeny estimation, andΩ:Γ×T→Rm,for some m ≥ 1, is a function correlating the set Γ to a phylogeny T.A specific PEP is completely characterized by defining the functions Λ and Ω. A phylogeny T* that optimizes Λ and satisfies the constraints described by Ω is referred to as optimal.A possible version of PEP is Minimum Evolution (ME) (see Felsenstein, 2004, p. 161) which consists in minimizing the length of a phylogeny (i.e., the sum of its edge weights) with respect to a given measure of dissimilarity among taxa (see Page and Holmes, 1998; Felsenstein, 2004; Gascuel, 2005). In the context of ME, a phylogeny of Γ is defined to be optimal if it satisfies the following requirements:(i)it has the shortest length, i.e., the minimum sum of edge weights;it has nonnegative edge weights and, for each pair of distinct taxa i, j ∈ Γ, the sum of the weights of the edges belonging to the (unique) path from i to j in T* is not smaller than the given measure of the dissimilarity between i and j.We refer the interested reader to Farach, Kannan, and Warnow (1995) for a biological justification of constraint (ii). Here we just observe that if only (i) and the nonnegativity of the weights were imposed, then the problem would be trivial, as all weights would be set to zero.A number of versions of ME have been proposed in the literature, mainly differing from one another by the way in which the edge weights are estimated. Examples include Kidd and Sgaramella-Zonta (1971), Beyer, Stein, Smith, and Ulam (1974), Rzhetsky and Nei (1992); 1993), Felsenstein (2004), Gascuel (2005). One of the earliest edge weight estimation models was proposed by Waterman, Smith, Singh, and Beyer (1977) and can be stated as follows:Problem 2The Minimum Evolution Problem (MEP)Given a set Γ of n taxa and values dij≥ 0 for all pairs of taxa i, j ∈ Γ (i ≠ j), find a phylogenyT*∈Tthat solves the problem(1)minT∈TL(T)=∑e∈E(T)we(2)s.t.∑e∈P(i,j)we≥dij∀i,j∈Γ:i≠j(3)we≥0∀e∈E(T)where E(T) denotes the set of edges of a phylogenyT∈T,we is the weight of edge e ∈ E(T), and P(i, j) is the unique path in T connecting the distinct taxa i, j ∈ Γ.The generic value dijin Problem 2 is called the observed evolutionary distance between taxa i and j, and represents a given measure of the observed dissimilarity between i and j; the dij’s satisfydij=djifor all i, j ∈ Γ, i ≠ j. These values are usually computed, e.g., by using one of the models described in Jukes and Cantor (1969), Fitch (1971), Kidd and Sgaramella-Zonta (1971), Beyer et al. (1974), Hasegawa, Kishino, and Yano (1981), Kimura (1980), Lanave, Preparata, Saccone, and Serio (1984), Rodriguez, Oliver, Marin, and Medina (1990), Waddell and Steel (1997), Galtier (2001), Huelsenbeck (2002), Lopez, Casane, and Philippe (2002), Felsenstein (2004), Catanzaro, Pesenti, and Milinkovitch (2006).The objective function (1) models condition (i), while constraints (2)–(3) impose condition (ii). Problem 2 is a particular network design problem (see Johnson, Lenstra, and Kan, 1978; Pop, 2012) with specific degree constraints and unknown edge weights. As observed in Catanzaro (2011), all known versions of ME can be obtained from MEP by imposing further constraints on the edge weights.The MEP can be solved in polynomial time if the observed evolutionary distances satisfy some specific properties described in Waterman et al. (1977). In contrast, if the observed evolutionary distances are generic, then the MEP is proved to beNP-hard via a reduction from the k-coloring problem (Farach et al., 1995). Moreover, in such a case the MEP cannot be even approximated in polynomial time within rationϵ,for someϵ>0,unlessP=NP(Farach et al., 1995).The hardness of the MEP has prevented researchers from finding practical solution techniques even for small (n ≤ 10) instances. This fact justifies the interest of operations researchers in developing approaches that can exactly solve the problem or approximate its optimal solution. In this context, Catanzaro, Labbé, Pesenti, and Salazar-Gonzáles (2009) recently presented mixed integer programming models for the MEP based on a particular encoding of phylogenies by means of edge-path incidence matrices of trees (see, e.g., Nemhauser and Wolsey, 1999). This encoding allowed the use of ad-hoc block decomposition methods capable of reducing the solution space of the problem. Unfortunately, all the proposed models proved to be unable to solve real instances of the MEP containing more than 8 taxa.Starting from the theoretical results presented in Aringhieri, Catanzaro, and Di Summa (2011); Catanzaro et al. (2009) and Catanzaro, Labbé, Pesenti, and Salazar-Gonzáles (2012), in this article we investigate the mathematical foundations of the MEP and its relationships with another recent version of the PEP: the Balanced Minimum Evolution Problem (BMEP), anNP-hard combinatorial optimization problem closely related to the Quadratic Assignment Problem. One of our findings shows that the BMEP provides lower bounds on the MEP. Moreover, we also show that the MEP is statistically consistent, a very desirable property for phylogeny estimation methods (see Section 6). We also develop an exact solution approach for the problem based on a nontrivial combination of a parallel branch-price-and-cut scheme and a non-isomorphic enumeration of all possible phylogenies for a set of n taxa. This particular approach has two main benefits: it allows both to break symmetries in the problem and to solve instances whose size is 62.5 percent larger than the size of the instances solved on the same machine with the techniques described in Catanzaro et al. (2009). Due to the hardness of the problem, the computational performance of the algorithm is still far from being suitable for practical use. However, the theoretical results provide a new perspective on the combinatorics of the MEP and may suggest new directions for the development of better exact solution approaches that could turn out useful in practical applications.The rest of the paper is organized as follows. In Section 2 we introduce some notation, definitions and fundamental properties of phylogenies. In Section 3 we investigate a possible solution approach to the MEP based on a particular type of implicit enumeration called Non-isomorphic Enumerative Approach (NEA). In Section 4 we develop a branch-price-and-cut algorithm to speed-up some enumerative tasks involved in the NEA. In Section 5 we discuss the computational performance of the NEA on real instances of the problem and compare our results with the current state-of-the-art algorithm for the MEP. Finally, in Section 6 we prove the statistical consistency of the MEP.In this section we introduce some notation and briefly recall some fundamental properties of phylogenies that will be useful throughout the article. We mention that these properties allow one to consider the MEP as an optimization problem over the lattice of the phylogenies of Γ. The interested reader is referred to Catanzaro et al. (2012) and Parker and Ram (1996) for a more systematic discussion about these properties.Given a phylogeny T of Γ and a taxon i ∈ Γ, we denote by Γithe set Γ∖{i}, by VIthe set ofn−2internal vertices of T, and by τijthe topological distance between two distinct taxa/internal vertices i, j ∈ Γ∪VI, i.e., the number of edges belonging to the path from i to j in T. We also assume that Γ is ordered and we use the notation i < j, for some distinct i and j ∈ Γ, to indicate that taxon i precedes taxon j in Γ. We define the path-length sequenceτi=[τij:j∈Γi]to be the sequence of the topological distances relative to the n−1paths from taxon i to each taxon j ∈ Γiin T, ordered accordingly to the order of taxa in Γ. For example, for the phylogeny shown in Fig. 1, the path-length sequence from taxon ‘A’ isτA=[2,4,4,3].Given a phylogeny T of Γ and a taxon i ∈ Γ, we denote byi^the only vertex adjacent to i in T. We say that a given edge is external if it joins a taxon i with the corresponding vertexi^,and internal otherwise. For example, for the phylogeny shown in Fig. 1, ifi=‘A’ theni^=1,hence A-1 is an external edge and e.g., 1–3 is internal. We denote by D an n × n symmetric distance matrix whose generic entry dij, i, j ∈ Γ, i ≠ j, represents the observed evolutionary distance between the corresponding pair of taxa. Finally, we call unweighted a phylogeny of Γ for which the edge weights are not specified.Topological distances in a phylogenyT∈Tare symmetric, that is:τij=τjifor all i, j ∈ Γ∪VI, i < j. Topological distances have also less trivial properties that derive from the particular degree constraints of phylogenies. Specifically, we have:Proposition 1Parker and Ram, 1996Let Γ be a set of n taxa, and let i ∈ Γ. A sequence of positive integersτi=[τij:j∈Γi]is a path-length sequence (with respect to taxon i) of a phylogenyT∈Tif and only if the entries ofτisatisfy the following condition:(4)∑j∈Γi2−τij=12.We refer to Eq. (4) as the Kraft equality.Proposition 2Catanzaro et al., 2012Let Γ be a set of n taxa. Then, for all theT∈T,the following equality holds:(5)∑i∈Γ∑j∈Γiτij2−τij=2n−3.We say that two (unweighted) phylogeniesT1,T2∈Tare isomorphic if there exists a graph isomorphism between T1 and T2, i.e., a bijection ϕ from the vertex set of T1 to the vertex set of T2 such that two vertices u, v are adjacent in T1 if and only if ϕ(u), ϕ(v) are adjacent in T2. (Note that here we ignore the edge weights of phylogenies and only consider the underlying graph.) Phylogeny isomorphism defines an equivalence relation inTand we refer to each equivalence class as a single unlabeled phylogeny. For example, the phylogeny in Fig. 1 belongs to the equivalence class of the unlabeled phylogeny shown in Fig. 3.All phylogenies inTcan be generated starting from the knowledge of the equivalence classes (i.e., unlabeled phylogenies) in which the setTis partitioned. In fact, given an unlabeled phylogeny U of Γ and denoting by L the set of its n leaves, any phylogenyT∈Tbelonging to the class U can be defined by means of an assignment of the taxa in Γ to the leaves in L, i.e., by means of a bijective mapping f: Γ → L. This insight is useful to develop a possible exact solution approach for the MEP based on the iteration of the following two operations: (i) choose an unlabeled phylogeny U of Γ, and (ii) assign taxa to leaves of U and weights to its edges in order to minimize (1). This approach, hereafter called Non-isomorphic Enumerative Approach (NEA), has a fundamental advantage: the number of unlabeled phylogenies for an increasing number n of taxa is a function that, though exponential in n, grows much slower than the corresponding number of phylogenies of Γ (see Table 1). Hence, the NEA may have a chance to compete with the exact solution approach for the MEP described in Catanzaro et al. (2009), provided that the unlabeled phylogenies of Γ can be efficiently enumerated and the assignment problem can be efficiently solved. In this section we shall investigate both the enumeration and the assignment problems. However, before proceeding we need to introduce some definitions and tools that will prove useful.Consider an unlabeled phylogeny U of Γ and let u be an internal vertex of U. Let S1 and S2 be two subtrees of U rooted at u. We say that S1 and S2 are root-vertex isomorphic with respect to u if (i) they are isomorphic, (ii) u is their only vertex in common, and (iii) the leaves of S1 and S2 are leaves of U. For example, in the unlabeled phylogeny in Fig. 4, the subtree rooted at vertex 12 having {1, 2} as leaf set and the subtree rooted at vertex 12 having {3, 4} as leaf set are root-vertex isomorphic. Similarly, lete=uvbe an internal edge of U, and let S1 and S2 be two subtrees of U rooted at u and v, respectively. We say that S1 and S2 are edge-isomorphic with respect to e if (i) they are isomorphic, (ii) they have no vertex in common, and (iii) the leaves of S1 and S2 are leaves of U. For example, in the phylogeny in Fig. 4, the subtree rooted at vertex 14 having {1, 2, 3, 4, 5} as leaf set and the subtree rooted at vertex 15 having {6, 7, 8, 9, 10} as leaf set are edge-isomorphic.With little abuse of notation with respect to the standard terminology, we call claw of U each K1, 2-subtree of U consisting of two external edges that are incident with a common internal vertex (thus the remaining endpoints are two leaves of U). Note that each claw of U consists of two single-edge root-vertex isomorphic subtrees. For instance, the unlabeled phylogeny shown in Fig. 4 has four claws rooted at vertices 11, 13, 16, 18, respectively.Finally, given an unlabeled phylogeny U of Γ, we denote bySthe set of all unordered pairs of subtrees of U that are either root-vertex isomorphic or edge-isomorphic. For example, the setSrelative to the unlabeled phylogeny shown in Fig. 4 includes six pairs of root-vertex isomorphic subtrees, namely the four claws mentioned before and two pairs of isomorphic subtrees rooted at vertices 12 and 17, respectively. Moreover,Sincludes also one pair of edge-isomorphic subtrees rooted at the endpoints of edge 14–15.We remark that for a fixed unlabeled phylogeny U, a given subtree of U can be root-vertex or edge isomorphic to at most one other subtree, with possibly one exception: there might be a node of U that is the root of three root-vertex isomorphic subtrees (see Fig. 5). It is easy to see that this happens for at most one node of U.The NEA enumerates the unlabeled phylogenies through a procedure based on the results on the degree-constrained tree enumeration described in Aringhieri, Hansen, and Malucelli (2003). Specifically, starting from an initial tree, this procedure generates recursively larger and larger trees in such a way that, at each step of the enumeration process, the degree constraint on the internal vertices is satisfied. Aringhieri et al. (2011) showed that, when dealing with unlabeled phylogenies, this enumeration process can be easily performed by recursively substituting a leaf of the current tree with a new claw. For example, the unlabeled phylogeny with 5 taxa shown in Fig. 6can be obtained from the unlabeled phylogeny with 4 taxa by replacing its top-right leaf with a new claw.The enumeration procedure encodes the trees that it recursively generates in order to maximize the efficiency of the process. Among the possible encodings, see e.g., Read (1972), Kvasnička and Pospichal (1991), Trinajstić, Nicolić, Knop, Müller, and Szymanski (1991), Hansen, Jaumard, Labatteux, and Zeng (1994), theCN-tuple encoding(Hansen et al., 1994) seems particularly suitable for unlabeled phylogenies. This kind of encoding is based on the following result.Proposition 3Jordan, 1869Let T be a tree with n vertices.1.Ifn=2k+1for somek∈N,then there exists a unique node v in T, called thecentroid, such that all (two or more) subtrees obtained by removing v contain at most k nodes.Ifn=2kfor somek∈N,then there exists in T either(a)a unique node v, called thecentroid, such that all (three or more) subtrees obtained by removing v contain less than k nodes, ora unique edge e, called thebicentroid, such that the two subtrees obtained by removing e contain exactly k nodes.Here, we observe that if an unlabeled phylogeny T has a pair of edge isomorphic subtrees, then the corresponding edge is the bicentroid of the tree. If T has a vertex that is the root of three isomorphic subtrees, then this vertex is the centroid of the tree. In the remainder we refer to the centroid or the bicentroid of a given unlabeled phylogeny simply as the center of the tree.TheCN-tuple code of an unlabeled phylogeny U with n taxa (and thus 2n−2vertices) is a string〈α1α2…α2n−2〉over the alphabetΣ={0,1,2,3}that is associated with the center of U and built from U accordingly to a particular recursive law. Specifically, if the center of U is a centroid, then theCN-tuple code of U is recursively defined as follows:Base case: If U consists of a single vertex, its code is 〈0〉.Recursive law: If U has more than one vertex, let r be the center of U and letv1,…,vg,g ≤ 3, be the vertices adjacent to r in U. Set g as the first character of the code. Remove r and its incident edges from U. Recursively compute the codesc1,c2,…,cgassociated with the roots of the subtrees rooted atv1,…,vg. The code of U is then obtained by concatenating the codesc1,c2,…,cgin such a way that the resulting string is lexicographically maximum.For instance, let us consider the unlabeled phylogeny U in Fig. 6(b). U has a unique center (labeled with c), which is connected tog=3nodes. By removing the center, we obtain one single-vertex subtree, whose code is 〈0〉, and two subtrees (U1 and U2, say) with three nodes each. Fori=1,2,Uihas a unique center, whoseg=2neighbors are single vertices and thus have code 〈0〉; then, fori=1,2,the code of Uiis obtained by setting ‘2’ as the first character and then concatenating ‘0’ and ‘0’ in maximum lexicographic order, that is 〈200〉. The finalCN-tuple code of U is obtained by setting ‘3’ as the first character and then concatenating ‘0’, ‘200’ and ‘200’ in maximum lexicographic order: 〈32002000〉.When the center of U is a bicentroid, theCN-tuple code of U is the string that is lexicographically maximum between the ones that are obtained by applying the recursive law to each of the two vertices that constitute the bicentroid. For example theCN-tuple code of the unlabeled phylogeny in Fig. 6(a) is 〈320000〉.The enumerating procedure exploits theCN-tuple encoding to avoid generating isomorphic phylogenies from the same initial subtree U0. Specifically, it employs the code to detect the presence of isomorphic subtrees in U0. As an example, in this way the enumerating procedure identifies that tree (a) in Fig. 6 contains isomorphic subtrees and then it generates only one of the four isomorphic phylogenies (b) that can be obtained by transforming into a claw any of the four leaves of (a). Other kinds of enumeration procedures could have been implemented but, in the authors’ opinion, they would require more sophisticated techniques to prevent the generation of isomorphic unlabeled phylogenies, see, e.g., the techniques described in Avis and Fukuda (1992); 1996), Aringhieri et al. (2003).The second step in the NEA consists in assigning taxa to leaves of an unlabeled phylogeny U and weights to its edges minimizing objective function (1). This task can be formalized as follows. Let U be an unlabeled phylogeny of Γ, denote byFthe set of all n! bijective mappings f of Γ to the set of n leaves of U, and by Tfthe phylogeny belonging to the class U such that the taxa are assigned to its leaves by means of the assignmentf∈F. Then, NEA solves the following assignment problem:Problem 3Fixed Phylogeny Problem (FPP)Given an unlabeled phylogeny U of Γ, find an optimal assignmentf*∈Fand weightswe*≥0that solve the problem(6a)z(U)=minf∈Fzf(6b)zf=min∑e∈E(Tf)we(6c)s.t.∑e∈P(f(i),f(j))we≥dij∀i,j∈Γ:i≠j(6d)we≥0∀e∈E(Tf).From now on, we define two phylogenies TfandTf′,that are feasible solutions of FPP, equivalent if each pair i, j of taxa in Γ has the same topological distanceτij=τij′on the two phylogenies, and the weights weandwe′of corresponding edges of the paths from i to j on the two phylogenies are equal,we=we′. Then we observe that in general, given an unlabeled phylogeny U of Γ, different assignments inFmay produce equivalent phylogenies. Given an assignmentf∈Fand any automorphism ϕ of Tf(i.e., any permutation ϕ of the vertices of Tf, such that the pair of vertices uv forms an edge if and only if the pair ϕ(u)ϕ(v) also forms an edge), the assignmentf′∈Fdefined byf′(i)=ϕ(f(i))produces a phylogenyTf′equivalent to Tf. As an example, for the unlabeled phylogeny shown in Fig. 4, it is easy to realize the equivalence of the phylogenies that differ only for the swapping of the assignments of the taxa between the pair of leaves {1, 2}, or {3, 4}, or {7, 8}, or {9, 10}. We also observe that the relation “defining an equivalent phylogeny” is trivially an equivalence relation onF. Then we can constrain the search for an optimal assignment f* to a single representative assignment f for each equivalence class inF.The next proposition provides the number of automorphisms#Tof a phylogeny T, i.e., the number of elements ofFin each equivalence class. To this end, we recall that bySwe denote the set of unordered pairs of root-vertex or edge isomorphic subtrees of U.Proposition 4Given a phylogeny T belonging to the class of U,#T=34·2|S|if T has a node that is the root of three root-vertex isomorphic subtrees, and#T=2|S|otherwise.The proof is by induction on the number of nodes of T. For the induction to work, it is convenient to prove the result not only for phylogenies, but for every tree in which all internal vertices have degree 3 except at most one vertex, which might have degree 2. We remark that all the definitions and results of Section 3.1 apply to this more general case.The base case of the induction is that of a tree consisting of a single node: in this situationS=∅and the only automorphism is the identity, thus the result#T=1is verified.Now let T be a tree as above, where the number of nodes is at least 2. Let us first assume that T does not have a bicentroid (therefore there is no pair of edge isomorphic subtrees in T). If there is a (unique) node of degree 2 in T, let v denote such a node; otherwise, let v be the centroid of the tree. Let k be the degree of v (so eitherk=2ork=3) and denote byv1,⋯,vkits neighbors. If we remove v from T, we obtain k subtreesT1,⋯,Tk(containingv1,⋯,vk,respectively).In the following, as inductive step, we show that#Tis proportional to∏i∈[k]#Ti,where[k]={1,⋯,k},and we determine the proportionality constant.Note that every automorphism ϕ of T satisfiesϕ(v)=v,as either v is the unique vertex of degree 2 or the unique centroid of T (and both properties are preserved by automorphisms). Note also that there exist automorphisms ϕ of T such thatϕ(vi)=vjwith i, j ∈ [k] if and only if Tiand Tjare root-vertex isomorphic subtrees of T (ori=j). In general, we can say that every automorphism ϕ of T is associated with a specific permutation σ of the set [k] such thatϕ(vi)=vσ(i)for i ∈ [k]. Accordingly, we call feasible every permutation σ such that there is an automorphism of T associated with σ.Denote bySithe set of unordered pairs of root-vertex or edge isomorphic subtrees of the class Uithat includes Ti, for i ∈ [k], and observe that the properties of v can be linked to the number of root-vertex or edge isomorphic subtrees of T and the number of automorphisms of T:(a)if v is not the root of any two root-vertex isomorphic subtrees, then|S|=|S1|+⋯+|Sk|and there is only one feasible permutation σ, the identical one (σ(i)=ifor all i ∈ [k]), as every automorphism ϕ of T must satisfyϕ(vi)=vifor i ∈ [k];if v is the root of exactly two root-vertex isomorphic subtrees, let us say Tiand Tj, then|S|=|S1|+⋯+|Sk|+1and there are only two feasible permutations, the identical one and the one that permutes only i with j, as every automorphism ϕ of T must satisfy eitherϕ(vi)=vifor i ∈ [k], orϕ(vi)=vj,ϕ(vj)=vi,andϕ(vl)=vlfor l ∈ [k]∖{i, j};if v is the root of exactly three root-vertex isomorphic subtrees (thus, in particular,k=3), then|S|=|S1|+⋯+|Sk|+3and all thek!=6permutations of [k] are feasible.Let t be the number of feasible permutations. In the three cases analyzed above, the value of t is 1, 2, and 6, respectively.We now claim that#T=t×∏i∈[k]#Ti. To see this, note that if ϕ is an automorphism of T and σ is the associated permutation of [k], thenσ−1∘ϕis an automorphism of T associated with the identity permutation; vice versa, if ϕ′ is any automorphism of T associated with the identity permutation and σ is a feasible permutation, then ϕ′○σ is an automorphism of T associated with σ. It follows that#Tis equal to t times the number of automorphisms of T associated with the identity permutation. Now, an automorphism of T is associated with the identity permutation if and only if its restriction to Tiis an automorphism of Ti, for i ∈ [k]; vice versa, any choice of automorphisms ofT1,…,Tkleads to an automorphism of T associated with the identity permutation. It follows that the number of automorphisms of T associated with the identity permutation is exactly∏i∈[k]#Ti,and thus#T=t×∏i∈[k]#Tias claimed.Note that each Tiis a tree with all internal vertices of degree 3, except for vi, whose degree is 2 (here we use the fact the v is defined as the only vertex of degree 2 in T if there is such a vertex, and as the centroid only when there is no vertex of degree 2 in T). This easily implies that no vertex of Tiis the root of three root-vertex isomorphic subtrees in Ti. Then, by induction,#Ti=2|Si|,hence#T=t×2|S1|×⋯×2|Sk|. The conclusion now follows by using (a)–(c) and recalling that t is equal to 1 (resp., 2, 6) in case (a) (resp., (b), (c)).This concludes the proof for the case of a tree T with no bicentroid. Now assume that T has a bicentroide=uv. Note that in this case all nodes of T have degree 3 (otherwise by removing e we would obtain two subtrees with a different number of nodes, a contradiction). We can reduce this case to the one analyzed above by subdividing the edge e, i.e., replacing edgee=uvwith a path of length two of the form u, z, v, where z is a new node. It is easy to check that neither|S|nor#Tchanges.□We remark that the above proof also shows that every automorphism of a phylogeny T can be derived as composition of automorphisms of T associated with the pairs of subtrees inS. This will prove useful later.By the above proposition, onlyn!2|S|or43·n!2|S|out of n! assignments need to be considered for each unlabeled phylogeny. Assuming n ≥ 4, we can derive an estimation of|S|by using the following trivial properties:1.an unlabeled phylogeny has at least as many pairs of root-vertex isomorphic subtrees as the number of its claws;an unlabeled phylogeny has at most one pair of edge-isomorphic subtrees; moreover, this situation occurs only if the unlabeled phylogeny possesses a bicentroid.Then the following proposition holds:Proposition 5Every unlabeled phylogeny U of n taxa satisfies3≤|S|≤n.We have|S|≥3,as any unlabeled phylogeny has at least three claws, except for the unlabeled phylogenies in which all n−2internal nodes are adjacent to a leaf (see Fig. 7). For this latter kind of phylogenies,|S|=3holds, since they have two claws and, if they have an odd number of internal vertices, they contain two root-vertex isomorphic subtrees rooted at the centroid, and otherwise, they contain two edge-isomorphic subtrees with respect to the bicentroid.To see that|S|≤n,assume first that U does not have a vertex that is the root of three vertex isomorphic subtrees. Then, since only the internal vertices can be roots of root-vertex isomorphic subtrees, and there is at most one pair of edge-isomorphic subtrees, we have|S|≤n−1. Finally, suppose that U has a vertex v that is the root of three root-vertex isomorphic subtrees. Then v is the centroid of U, thus there is no pair of edge-isomorphic subtrees. Since v is the root of three pairs of isomorphic subtrees, and every other internal vertex is the root of at most one pair of isomorphic subtrees, we conclude that|S|≤n.□In the light of the results discussed in the previous sections, we now introduce a mixed integer programming model to solve the FPP (Problem 3) for a fixed unlabeled phylogeny U of Γ having L as set of leaves. To this end, let us assume without loss of generality thatL={1,…,n}andΓ={1,…,n}(so they are both totally ordered sets). Given an unlabeled phylogeny U of Γ, we define we, e ∈ E(U), as a nonnegative continuous variable representing the edge weight of e ∈ E(U). Moreover, we use the following decision variables:xip={1iftaxonpisassignedtoleafi0otherwise∀p∈Γ,∀i∈Landyijpq={1ifpisassignedtoiandqtoj0otherwise∀p,q∈Γ:p≠q,∀i,j∈L:i<j.Note the correspondence between the above variables and the desired assignment  f*:xip=1if and only iff*(p)=i,andyijpq=1if and only iff*(p)=iandf*(q)=j. Then a formulation for the FPP is the following:Formulation 1(7a)z(U)=min∑e∈E(U)we(7b)s.t.∑e∈P(i,j)we≥dpq(yijpq+yijqp)∀i,j∈L:i<j,∀p,q∈Γ:p<q(7c)∑p,q∈Γp≠qyijpq=1∀i,j∈L:i<j(7d)∑i,j∈Li<j(yijpq+yijqp)=1∀p,q∈Γ:p≠q(7e)yijpq≤xip∀i,j∈L:i<j,∀p,q∈Γ:p≠q(7f)yijpq≤xjq∀i,j∈L:i<j,∀p,q∈Γ:p≠q(7g)∑i∈Lxip=1∀p∈Γ(7h)∑p∈Γxip=1∀i∈L(7i)we≥0∀e∈E(U)(7j)xip∈{0,1}∀p∈Γ,∀i∈L(7k)yijpq∈{0,1}∀p,q∈Γ:p≠q,∀i,j∈L:i<j.Constraints (7b) impose that, for each pair of distinct taxa p, q ∈ Γ, the sum of the weights of the edges in P(i, j) is greater than or equal to the observed evolutionary distance dpqif P(i, j) joins taxa p and q. Eqs. (7c) impose that for a given pair of taxa (i, j) there is a uniqueyijpq-variable set to 1. Symmetrically, Eqs. (7d) ensure that for each pair of taxa (p, q) there exists exactly oneyijpq-variable set to 1. Inequalities (7e) impose thatxip=1wheneveryijpq=1for some leaf j and taxon q, and (7f) impose a similar condition. Constraints (7g)–(7h) ensure that thexipvariables model a one-to-one taxon-leaf assignment. Finally, constraints (7i)–(7k) impose the nonnegativity of the edge weights and integrality of variablesxipandyijpq,respectively.Thanks to the presence of constraints (7c)–(7d), we can replace inequalities (7b) with the following stronger inequalities:(8)∑e∈P(i,j)we≥∑p,q∈Γp≠qdpq(yijpq+yijqp)∀i,j∈L:i<j.Furthermore, inequalities (7e)–(7f) could be replaced by(9)∑q∈Γq≠pyijpq=xip∀p∈Γ,∀i,j∈L:i<j(10)∑p∈Γp≠qyijpq=xjq∀q∈Γ,∀i,j∈L:i<j,thus obtaining a strengthened linear-programming relaxation. However, extensive preliminary tests run on a number of variations of the above model showed that, under our branch-price-and-cut approach described in Section 4.1, it is convenient to write the constraints in the form (7e)–(7f) and add Eqs. (9)–(10) as cuts.We also observe that the integrality requirements on theyijpq-variables can be relaxed, as the following proposition shows.Proposition 6Constraints (7k) can be relaxed to(11)yijpq≥0∀p,q∈Γ:p≠q,∀i,j∈L:i<j.We show that variablesyijpqtake integer values in any feasible solution to the problem in which constraints (7k) are replaced by (11). Observe that constraints (11) and (7e)–(7f) imply(12)0≤yijpq≤min{xip,xjq}∀p,q∈Γ:p≠q,∀i,j∈L:i<j,hence, because of (7j),yijpq>0only ifxip=xjq=1. In this case, (7g)–(7h) imply thatxip′=xjq′=0for all p′ ≠ p and q′ ≠ q. Then, by (7e)–(7f),yijp′q′=0whenever (p′, q′) ≠ (p, q). Eq. (7c) then implies thatyijpq=1.□A first family of valid cuts for our formulation is given below.Proposition 7For every leaf i ∈ L and distinct taxa p, q ∈ Γ, constraint(13)∑j∈Li<jyijpq+∑j∈Li>jyjiqp=xipis valid for Formulation 1.The proof of Proposition 6 shows that in any feasible solutionyijpq=xipxjqfor all p, q ∈ Γ such that p ≠ q and i, j ∈ L such that i < j. With this in mind, one immediately sees that ifxip=0then both sides of (13) are equal to zero and the equation is satisfied, and ifxip=1,then there exists a unique j ∈ L∖{i} such thatxjq=1,thus the equation is again satisfied.□By exploiting the fundamental properties of phylogenies and the integrality of variablesxipandyijpq,some valid inequalities can be developed to strengthen Formulation 1. Specifically, the following propositions hold:Proposition 8The equalities(14)∑q∈Γp∑j∈Li<j(yijpq+yijqp)2−τij=12∀i∈L,∀p∈Γ(15)∑p,q∈Γp≠q∑i,j∈Li<j(yijpq+yijqp)τij2−τij=2n−3are valid for Formulation 1.The equalities follows by observing that in any feasible solution to the FPP the Kraft equality (4) and equality (5) hold.□Given an unlabeled phylogeny U of Γ, the inequality(16)∑e∈E(U)we≥∑p,q∈Γp≠q∑i,j∈Li<j(yijpq+yijqp)dij2−τijis valid for Formulation 1.From Semple and Steel (2004) it follows that for every phylogeny T belonging to the class U,(17)L(T)=∑e∈E(T)we=∑i,j∈Li≠jδij2−τij,where δijis equal to the sum of the weights of the edges belonging to the path from leaf i to leaf j in T. Then, asE(T)=E(U),constraints (6c) give(18)∑e∈E(U)we=∑i,j∈Li≠jδij2−τij≥∑i,j∈Li≠jdij2−τij=∑p,q∈Γp≠q∑i,j∈Li<j(yijpq+yijqp)dij2−τij.□It is worth noting that Proposition 9 not only gives a valid inequality for the MEP, but it also provides a relationship between the Balanced Minimum Evolution Problem (BMEP, Pauplin (2000); see also Catanzaro et al., 2012) and the MEP. Specifically, given a set Γ of n taxa and its corresponding distance matrix D, the BMEP consists in finding a phylogeny T that minimizes the following objective function (Pauplin, 2000):∑i,j∈Γi≠jdij2−τij.Proposition 9 states that the optimal solution to the BMEP provides a lower bound for the MEP. This will be useful when proving the statistical consistency of the MEP in Section 6. Moreover, since it was observed by Fiorini and Joret (2012) that the optimal value of the BMEP is at least half the length of the shortest Hamiltonian cycle in the complete graph with vertex set Γ and weights dij, Proposition 9 immediately implies the following result.Proposition 10Cycle inequalityLet G be the weighted complete graph with vertex set Γ and weights dijfor i, j ∈ Γ, i ≠ j. Denote by C* a shortest Hamiltonian cycle in G and by L(C*) its length. Then the inequality(19)∑e∈E(U)we≥12L(C*)is valid for Formulation 1.The inclusion of inequality (19) in Formulation 1 can be performed by solving the Traveling Salesman Problem (TSP) on G. Though the TSP is anNP-hard problem, it can be solved very efficiently for quite large values of n (see, e.g., D’Ambrosio, Lodi, and Martello, 2011); in particular, it can be solved almost instantaneously for the values of n of our instances using Concorde (Applegate, Bixby, Chvátal, and Cook, 2001).A standard branch-and-bound algorithm tends to perform poorly when solving Formulation 1, due to the presence of the equivalent assignments discussed in Section 3.3. Removing those assignments reduces the size of the model and speeds up the overall solution time of the FPP. To do so, we enumerate a single representative assignment for each class of equivalent assignments. Recalling that every automorphism of a given unlabeled phylogeny is the composition of automorphisms associated with the pairs inS,it is sufficient to require that, for each pair of subtrees{S1,S2}∈S,taxa assigned to S1 lexicographically precede taxa assigned to S2. This can be implemented by imposing that, for each pair of isomorphic subtrees{S1,S2}∈S,the following constraints hold:(20)yijpq=0∀p,q∈Γ:q<pwhere i andj=ϕ(i)are two reference vertices in S1 and S2, respectively (with ϕ being the isomorphism between S1 and S2). As an example, if we consider the phylogeny in Fig. 7, all equivalent assignments can be excluded by imposing the following constraints:(21a)y12pq=0∀p,q∈Γ:q<p(21b)yn,n−1pq=0∀p,q∈Γ:q<p(21c)y1,n−1pq=0∀p,q∈Γ:q<p.Imposing constraints (20) requires finding the tree symmetries discussed in Section 3. Specifically, given an unlabeled phylogeny U, one can detect the presence of a pair of root-vertex isomorphic subtrees in U by checking whether theCN-tuple code of U contains two consecutive identical substrings c1, c2, where the first character of c1 and the first character of c2 correspond to nodes with the same predecessor. For example, the phylogeny in Fig. 6(b) has code 〈32002000〉; the two substrings 〈200〉 denote the presence of a pair of root-vertex isomorphic subtrees rooted at the centroid of U, while each of the first two pairs of consecutive 0s indicates the presence of a claw. Edge-isomorphic subtrees in an unlabeled phylogeny can be detected in a similar way.Finding the tree symmetries for a fixed unlabeled phylogeny does not require any further computational overhead and can be implemented in a very easy way by using the algorithms described in Aringhieri et al. (2003).The large number ofyijpq-variables in Formulation 1 tends to slow down the resolution of the FPP and constitutes a bottleneck for the NEA. Therefore, it is worth investigating possible strategies to decrease the number of variables involved in the formulation. To this end, in this section we shall develop a branch-price-and-cut approach for the FPP. Moreover, we shall investigate possible heuristic strategies to speed up the overall performance of the NEA.A possible strategy to speed up the resolution of the FPP consists in using a branch-price-and-cut approach in which theyijpq-variables are dynamically added to Formulation 1. Specifically, at each node of the search tree we solve the corresponding linear program by means of a column generation technique, as described below. Subsequently, we strengthen the linear-programming bound by adding inequalities (9)–(10) and the valid inequalities described in Section 3.4.1. If the node is not pruned, we perform a branching by fixing the value of the most fractionalxipvariable (i.e., the variable with maximum distance from the closest integer). Finally, we reiterate the procedure by considering the resulting subproblems. We remark that at each node of the search tree we compute a bound for a subproblem by removing all strengthening inequalities previously added to the formulation and by including all theyijpq-variables introduced during the previous iterations. The choice of ignoring the valid inequalities when performing column generation was due to the large number of preliminary tests carried out on different variants of the model. The strategy described here turned out to be the one providing the best trade-off between solution time and tightness of the bound.Given a generic node of the search tree of the FPP, consider Formulation 1 and replace inequalities (7b) by the stronger constraints (8); moreover, relax all of the integrality constraints on the decision variables. We assign dual variables Bijto inequalities (8), dual variables Cijconstraints to (7c), ..., dual variables Hito constraints (7h). The feasible region of the dual problem reads as follows:(22a)∑i,j∈L:i<je∈P(i,j)Bij≤1∀e∈E(U)(22b)∑j∈Lj>i∑q∈Γq≠pEijpq+∑j∈Lj<i∑q∈Γq≠pFjiqp+Gp+Hi≤0∀i∈L,∀p∈Γ(22c)dpqBij+Cij+Dpq−Eijpq−Fijpq≤0∀i,j∈L:i<j,∀p,q∈Γ:p≠q(22d)Bij≥0,Eijpq≥0,Fijpq≥0,∀i,j∈L:i<j,∀p,q∈Γ:p≠q.We start with a reduced primal problem restricted to the following variables: variables wefor all e ∈ E(U); variablesxipfor all i ∈ L and p ∈ Γ; variablesyijijfor all i, j ∈ L such that i < j. These variables are sufficient to make the formulation feasible for the FPP. Note that none of inequalities (22a) or (22b) can be violated by the dual solution of the reduced problem, as all primal variables corresponding to these constraints are included in the reduced linear program. Thus we only have to check if the current dual solution satisfies all inequalities (22c). We also note that if a variableyijpqis not part of the current reduced problem, then the corresponding constraints (7e)–(7f) are redundant, and thus we can ignore the corresponding dual variablesEijpqandFijpq. On the other side, if a variableyijpqis part of the current reduced problem, then the dual constraint (22c) associated with indices i, j, p, q is of course satisfied.We conclude that, in order to verify whether there is a violated dual constraint, it is enough to check whether there exist indices i, j ∈ L, i < j, and p, q ∈ Γ, p ≠ q, such that the current dual solution satisfiesdpqBij+Cij+Dpq>0.This can be achieved by enumerating all possible quadruples of indices i, j, p, q—it seems unlikely that a less trivial pricing oracle can be devised. Though this pricing oracle requires Θ(n4) operations, the overall computation time needed to solve the linear relaxation of Formulation 1 with this approach turned out to be much smaller than the time needed to solve directly the original model.In order to speed up the overall performance of the NEA, one can reduce the number of unlabeled phylogenies of Γ to be considered during the enumeration process. This task can be accomplished by performing a preprocessing phase consisting of the following subtasks: (i) computing a first primal upper bound for the problem; (ii) computing a lower bound for each possible unlabeled phylogeny of Γ (e.g., by solving the linear relaxation of Formulation 1); (iii) sorting in nondecreasing order the unlabeled phylogenies of Γ according to their lower bounds; and finally (iv) pruning those unlabeled phylogenies whose lower bound is greater than the primal bound previously computed. The fact of keeping ordered the list of the unpruned unlabeled phylogenies allows a further potential dynamical pruning whenever a better primal bound is determined. The efficiency of this strategy can be maximized by parallelizing the resolution of the assignment problem, i.e., by solving in parallel the FPPs corresponding to multiple unpruned unlabeled phylogenies.Finding a good primal bound for the MEP is a critical step to reduce the number of unlabeled phylogenies of Γ to be considered. In order to do so, we exploit the insights provided by Proposition 10. Specifically, let G be the weighted complete graph with vertex set Γ and weights dijfor i, j ∈ Γ, i ≠ j. Let C* be a shortest Hamiltonian cycle in G and denote by L(C*) its length. Fix any unlabeled phylogeny U of Γ and denote by T(C*) the labeled phylogeny obtained from U by proceeding as follows: select at random a leaf of U and assign the taxa to the leaves of U according to the order given by C*, starting from the selected leaf and proceeding clockwise. Now, finding weightswe*for the edges of T(C*) that minimize the length of the phylogeny is a linear programming problem (as it is Problem 2 for a fixed T) that can be solved in a negligible time. Then we have the following primal bound for the MEP:Proposition 11For a fixed unlabeled phylogeny U of Γ, let(w¯e)e∈E(U)be the optimal weights for the edges of U. Then∑e∈E(U)w¯e≤∑e∈E(T(C*))we*.The bound provided by Proposition 11 is not tight, but it can be improved by (i) applying the heuristic assignment to all unlabeled phylogenies of Γ, and (ii) using local search. In this context, it is worth noting that for a fixed unlabeled phylogeny of Γ, a first improvement on the heuristic assignment of the taxa in C* to the leaves of U can be obtained by shifting the starting leaf during the assignment process. Moreover, a further improvement can be achieved applying 2-OPT (Glover and Kochenberger, 2003) on the best shift found. We experienced in preliminary numerical experiments that the primal bounds obtained by using this approach are usually below 3 percent from the optimum.In order to evaluate the efficiency of our exact solution approach for the MEP, we tested the performance of the NEA on nine real aligned DNA datasets already used in Catanzaro et al. (2009); 2012), namely: “Primates12”, a dataset of 12 sequences, 898 characters each from primates mitochondrial DNA; “SeedPlant25”, a dataset of 25 sequences of 19,784 characters each from pinoles; “RbcL55/1314”, a dataset of 55 sequences, 1314 characters each of the rbcL gene; “Rana64 /1976”, a dataset of mitochondrial DNA containing 64 taxa of 1976 characters each from ranoid frogs; “M17/2550”, “M43/2086”, “M18/8128”, “M82/2062”, “M62/3768”, five datasets of respectively 17 sequences of 2550 characters each from insects, 43 sequences of 2086 characters each from mammals, 18 sequences of 8128 characters each from cetacea, 82 sequences of 2062 characters each from fungi, and finally 62 sequences of 3768 characters each from hyracoidae. Table 2provides a summary of the characteristics of considered datasets.From each dataset we have extracted the first 20 taxa (or all taxa if n < 20) and built the associated n × n distance matrix by using the General Time Reversible (GTR) model of DNA sequence evolution (Lanave et al., 1984; Rodriguez et al., 1990). Moreover, from each distance matrix we have extracted the corresponding kth leading principal submatrices,k∈{10,…,max},where max  is 12 for Primates12, 17 for M17, 18 for M18, and 20 for the remaining datasets, generating therefore an overall number of 167 real instances of the MEP. Datasets and corresponding distance matrices can be found at http://di.unito.it/datasetsmep2.We implemented both the NEA and its improved version based on the Branch-Price-and-Cut approach (BPC-NEA) in ANSI C++ by using Xpress Optimizer libraries v18.10.00. The experiments ran on a Pentium 4, 3.2 gigahertz, equipped with 2 gigabyte RAM and operating system Gentoo release 7 (kernel linux 2.6.17). During the runtime of the NEA, we activated Xpress automatic cuts, Xpress pre-solve strategy, and Xpress primal heuristic to generate the first upper bound for the FPP. In contrast, during the runtime of the BPC-NEA we deactivated Xpress automatic cuts, pre-solve strategy, and primal heuristic. When computing the overall solution time taken by both versions of the NEA to solve a specific dataset, we disregarded the overhead added by the unlabeled enumeration routine. The reason for this choice is twofold: first, such overhead is negligible as shown in Table 3, and second, the unlabeled enumeration can be performed offline once for all, as the unlabeled phylogenies are independent of the specific dataset.In order to measure the performance of both versions of the NEA, we considered, as a reference, the performance of the mixed integer programming model introduced in Catanzaro et al. (2009), at present the only exact algorithm for MEP available in the literature. We refer to such a model as the EPT model, as it is based on a particular representation of a phylogeny in terms of the Edge-Path incidence matrix of a Tree (EPT), see, e.g., Nemhauser and Wolsey (1999). In order to have a sound comparison of the results, we implemented the model in Catanzaro et al. (2009), on our machine.Table 4shows the computational results for the given datasets. The columns relative to the EPT model show respectively the running time (expressed in seconds) taken to solve a generic instance of the MEP, the number of branches needed, and the gap (expressed in percentage) i.e., the difference between the optimal value found and the value of the linear relaxation at the root node of the search tree, divided by the optimal value. When “24 hours” appears in the columns “Time”, this is to highlight that the run relative to a specific instance took longer than 24 hours with respect to a specific approach. The columns “NEA Time” and “BPC-NEA Time” show the running time (expressed in seconds) taken by the NEA and the BCP-NEA, respectively, to solve a generic instance of the MEP. Finally, the last column provides the linear relaxation gap, i.e., the percentage value relative to the difference between the optimal value to the MEP and the value of the poorest linear relaxation in the list of the unlabeled phylogenies, divided by the optimal value.As a general trend, we observe that the EPT model is unable to tackle instances of the MEP containing more than 10 taxa within 24 hours. The solution time is usually very high, ranging from 1.3 hours to 6 hours, and the gap is always above 30 percent. In contrast, the NEA provides a better performance both in terms of solution time and gap. Specifically, the solution time for 10 taxa ranged from 137 seconds to a maximum of 333 seconds, with gap usually not above 11 percent; in some cases (see datasets Rana64 and M62) the value of the gap approaches 1 percent, demonstrating tightness of the bounds provided by Formulation 1. Unfortunately, the solution time trend of the NEA shows that its performance dramatically deteriorate as the number of taxa increases. In fact, already with 11 taxa the solution time ranges from 944 seconds to 1.64 hours. This behavior is mainly due to the large number ofyijpq-variables involved in Formulation 1, which slows down the simplex algorithm and, more in general, the whole solution time of the FPP. In these circumstances, the BPC-NEA shows its advantages. Specifically, although slower than the NEA below 10 taxa, the BCP-NEA turns out to be the faster approach when tackling instances containing 11 or more taxa. Although the BCP-NEA was able to solve SeedPlant25 and Rana64 when considering 14 taxa, as a general trend the instances containing more than 13 taxa constitute the current limitation for the BPC-NEA.The performance of the NEA approach depends on the number of taxa and the structure of the distance matrix D. As we have already noted, the number of taxa directly affects the number ofyijpq-variables involved in Formulation 1, which in turn slows down the resolution of the FPP. In this context, we tried to develop an alternative model to the branch-and-price approach described in Session 4.1, which consists in substituting the four-indexyijpq-variables with the following three-index arc variables:ωepq={1ifthearcebelongstothepaththatjoinstaxap,q0otherwise∀p,q∈Γ:p≠q,∀e∈E(U).Unfortunately, we experienced very poor performance for such a model, mainly due to its linear relaxation bound, which is significantly smaller than that of the BPC-NEA and quite close to that of the EPT model.With regard to the structure of the distance matrix D, we observed that two main characteristics of D may worsen the NEA performance, namely (i) the uniformity of the entries and (ii) the “non additivity” of the entries, i.e., the tendency of the entries to not satisfy the additive property(Waterman et al., 1977)dzi+dkj≤max{dzj+dik,dkz+dij}for any four distinct taxa i, j, k, z ∈ Γ. Concerning the uniformity of the entries, the worst possible scenario for the NEA consists in choosing a distance matrix D whose non-diagonal entries are equal to a given value d. In this case, any phylogeny whose edge weights arewe*={d2ifeisanexternaledge0otherwise∀e∈E(U)is optimal and has lengthnd2. In this situation, the NEA has to enumerate all possible phylogenies inTbefore stopping, with consequent worsening of the performance.Concerning the additive property, Waterman et al. (1977) showed that it plays a central role in solving the MEP. In fact, the authors proved that the entries of D can be seen as the sum of the weights of the edges of a phylogeny if and only if D is additive. When this situation occurs, the optimal solution to MEP is unique and it can be found in O(n2) by using a constructive greedy called the Sequential Algorithm. In particular, the Sequential Algorithm starts from an initial partial phylogeny of Γ, i.e., a phylogeny having a number of taxa n′ < n, and determines the corresponding weights by using specific formulas described in Waterman et al. (1977) valid only if D is additive. Subsequently, the algorithm picks a taxon from among those that are not in the current partial phylogeny and constructs a new partial phylogeny withn′+1taxa by using again the previous mentioned formulas. The algorithm iterates the constructive step until the unique phylogeny of Γ is obtained. Interestingly, the literature reports on faster versions of the Sequential Algorithms, the best of which is characterized by a computational complexity O(nlog n) (see Culberson and Rudnicki, 1989). Describing these versions is out of the scope of the article. We refer the interested reader to Sattah and Tversky (1977) and Culberson and Rudnicki (1989) for further information.Unfortunately, the observed evolutionary matrices are usually not additive, as they are generally estimated by means of specific Markov substitution models of molecular evolution, such as those described in Felsenstein (2004), Hasegawa et al. (1981), Jukes and Cantor (1969), Kimura (1980), Lanave et al. (1984), Rodriguez et al. (1990), Waddell and Steel (1997) or, more rarely, by means of metric models, such as those described in Beyer et al. (1974), Kidd and Sgaramella-Zonta (1971). These estimation models provide evolutionary matrices whose entries are nonnegative and symmetric, but that not necessarily satisfy the triangle inequality. Thus, as the satisfaction of the triangle inequality is a necessary condition for additivity (Semple and Steel, 2003; Waterman et al., 1977), these matrices are usually not additive. This fact prevents the use of the Sequential Algorithm even to approximate the optimal solution to the problem, as it requires the additivity of D to compute the edge weights. In this context, we observed that the “closer” D is to an additive matrix, the easier (faster) solving the MEP. Hence, in a certain sense, the degree of additivity of a matrix can be considered as a qualitative measure of the goodness of the MEP as a phylogenetic estimation paradigm.There is no general way to empirically validate a candidate phylogeny for a set of molecular sequences extracted from taxa, as their real phylogeny, i.e., the real evolutionary process undergone by the sequences, is generally unknown. Hence, the literature proposes a number of criteria to select one phylogeny from among plausible alternatives. Each criterion usually adopts its own set of evolutionary hypotheses. The ability of such hypotheses to describe the real evolutionary process of taxa determines the gap between the real and the true phylogeny, i.e., the phylogeny that one would obtain under the same set of hypotheses if all molecular data from taxa were available (Felsenstein, 2004). If the optimal phylogeny of a given phylogenetic estimation criterion approaches (according to a given metric) the true phylogeny as the amount of molecular data from taxa increases, the corresponding criterion is said to be statistically consistent(Felsenstein, 2004).The statistical consistency is a desirable property in molecular phylogenetics because it measures the ability of a criterion to recover the true (and hopefully the real) phylogeny of the considered taxa. The literature on molecular phylogenetics shows that in the context of distance matrix methods (see Felsenstein, 2004) a number of versions of the PEP are statistically consistent, such as the minimum evolution method under the least squares edge weight estimation model (see Rzhetsky and Nei, 1993) and the BMEP (Desper and Gascuel, 2004). In this section we show that MEP is statistically consistent as well by using a different approach from the ones used e.g., in Rzhetsky and Nei (1993), Gascuel, Bryant, and Denis (2001), Denis and Gascuel (2003), Desper and Gascuel (2004), Gascuel (2005).Before proceeding, we introduce some notation and definitions. For a given phylogeny T, we will use T to denote both T and its support, i.e., the unweighted tree underlying T. Recall that when we disregard the edge weights of T, we use terminology unweighted phylogeny. Note however that an unweighted phylogeny is labeled. We denote by T* the true phylogeny of Γ and byΔ={δij}i,j={∑e∈P*(i,j)we*}i,jthe corresponding true distance matrix, where P*(i, j) denotes the path from i to j in T* andwe*denotes the weight of edge e in T*. LetDl={dijl}i,j,forl∈N,be the observed distance matrices, where superscript ‘l’ means that its entries are estimated from molecular data of length l. Similar to Gascuel (2005), we say that {Dl} is a consistent estimate ofΔif the greater the amount of molecular data of taxa we have (e.g., the longer the DNA sequences), the closer Dlis toΔ; more formally,liml→∞∥Dl−Δ∥∞=0.For each l, let Tlbe an optimal phylogeny for the MEP when the input distance matrix is Dl, and letwelbe the weight of edge e in Tl. We say that Tlconverges to T* if the following conditions are satisfied:1.there existsl¯such that, forl≥l¯,the support of Tlcoincides with the support of T*;for every edge e of T*,liml→∞l≥l¯wel=we*.The MEP is said to be statistically consistent if whenever {Dl} is a consistent estimate ofΔ, Tlconverges to T*.Proposition 12The MEP is statistically consistent.For a given distance function D and an unweighted phylogeny T, we denote byLD(T)the minimum weight of a phylogeny whose support is T. Furthermore, we denote byBD(T)the length of a phylogeny whose support is T, computed under the BMEP objective function:(23)BD(T)=∑i,j∈Γi≠jdij2−τij.Since Δ is an additive matrix, then T* is the unique optimal phylogeny under the BMEP when the input distance function is Δ (see Desper and Gascuel, 2004). Thus there exists ɛ > 0 such that(24)BΔ(T)≥BΔ(T*)+ɛfor every unweighted phlyogeny T ≠ T*. Moreover, if we fix an unweighted phylogeny T, then, since {Dl} is a consistent estimate of Δ and (23) is a continuous function of D, there exists l1 such thatBDl(T)≥BΔ(T)−ɛ/2for every l ≥ l1.Now fix an unweighted phylogeny T ≠ T*. Then, for l ≥ l1,(25)LDl(T)≥BDl(T)≥BΔ(T)−ɛ/2≥BΔ(T*)+ɛ/2=LΔ(T*)+ɛ/2,where the first inequality follows from (18), the second inequality holds because l ≥ l1, the third inequality follows from (24), and the equation holds because (18) is satisfied at equality for T* (as Δ is the true distance matrix corresponding to the true phylogeny T*).On the other hand, since, for a fixed T,LD(T)is a continuous function of D, there exists l2 ≥ l1 such thatLDl(T*)<LΔ(T*)+ɛ/2for l ≥ l2. Together with (25), this implies that, for l ≥ l2, the unique optimal solution to the MEP with input distance matrix Dlhas support T*. Thus the first condition in the definition of convergence given above holds withl¯=l2. The second condition follows from the continuity ofLD(T)whenT=T*is fixed.□

@&#CONCLUSIONS@&#
