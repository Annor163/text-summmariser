@&#MAIN-TITLE@&#
Data-driven modeling of pharmacological systems using endpoint information fusion

@&#HIGHLIGHTS@&#
We propose a novel method to derive data-driven model of pharmacological systems.The method is built upon information fusion of endpoint responses.System׳s identifiability is shown by analyzing a relation between endpoint responses.System is fully identifiable in case all the responses involve effect compartments.The efficacy of the method is shown by benchmark pharmacological modeling problems.

@&#KEYPHRASES@&#
Data-driven modeling,Pharmacological system,Endpoint information fusion,Identifiability,Parametric variance,

@&#ABSTRACT@&#
This study investigated the feasibility of deriving data-driven model of a class of pharmacological systems using the information fusion of endpoint responses. For a class of pharmacological systems subsuming conventional steady-state dose-response models, compartmental pharmacokinetic–pharmacodynamic models and indirect response models, a relation between multiple endpoint responses was formalized and analyzed to elucidate if this class of systems is identifiable, i.e., if the data-driven model of this class of systems can be derived from the endpoint responses alone. It was shown that this class of systems is fully identifiable in case all the responses involve effect compartments. However, it was also observed that persistently exciting dose profiles may be required in accurately deriving reliable data-driven model with low variance. The findings from the identifiability analysis were demonstrated using benchmark pharmacological system examples.

@&#INTRODUCTION@&#
It has been suggested that high-fidelity model of pharmacological systems may contribute to improved healthcare through low-cost and expedited simulation of new therapeutic regimens, accurate prediction of patient response to medication therapy, and design of automated systems for medication infusion. For example, pharmacological models have been used to design and evaluate dose schedules in topotecan therapy for pediatric neuroblastoma [1], cancer chemotherapy [2] and diabetes mellitus [3]. These models have also been used in predicting the clinical responses of patients to anesthesia [4] and vasoactive [5] drugs. Besides, design of automated systems for medication infusion based on the pharmacological models has been studied in the field of anesthesia [6–9] and diabetes mellitus [10,11].Conventional methods to derive data-driven pharmacological models necessitate the measurements of medication dose, plasma concentration of medication and the resulting endpoint(s) (Fig. 1(a)). In research settings, the PK model is derived using medication dose and plasma concentration of medication as input and output, respectively, while the PD model is derived using plasma concentration of medication and endpoint as input and output, respectively. However, this modeling framework cannot be used in real clinical settings in which plasma concentration of medication is not measured. To cope with this problem, the population PK model was often used to yield model-based prediction of plasma concentration of medication from dose data [8,12–15]. However, this approach is susceptible to large errors due to drastic inter-individual variability in the PK profile (see, e.g., [16]). More recently, efforts to derive subject-specific PKPD model were made via low-order modeling. In Silva et al. [17], PK and effect compartment models for anesthesia medications were merged into a low-order rational transfer function incorporating both population-averaged and subject-specific parameters. Hahn et al. [16] proposed a low-order model directly relating medication dose to an endpoint, which could be fully adapted to dose-endpoint data on an individual basis. These models showed promise in accurately predicting subject-specific endpoint responses to medication doses. However, they failed to retain the compartmental model structure, thereby compromising the physiologic transparency. To date, attempts to derive data-driven model of pharmacological systems in the absence of plasma concentration of medication appear to be very rare.This study investigates the feasibility of deriving data-driven model of a class of pharmacological systems using dose and endpoint responses alone. The key idea is to exploit the fact that all endpoints originate from the same plasma concentration of medication via distinct PD mechanisms (Fig. 1(b)). In this way, a relation between multiple endpoints is derived that can be solved using the endpoint data alone to yield data-driven PD models. Then, plasma concentration of medication can be de-convolved from the endpoint data using the PD model. Finally, PK model can be derived using (measured) medication dose and (model-predicted) plasma concentration of medication (Fig. 1(b)).This paper is organized as follows: Section 2 formalizes the proposed data-driven modeling method and presents the theoretical analysis conducted in this study. Section 3 outlines the application of the method to benchmark examples on data-driven pharmacological systems modeling problems. Section 4 shows and discusses the results. The paper is concluded in Section 5.The class of pharmacological systems considered in this study is shown inFig. 2. The system consists of a compartmental PK model followed by multiple PD models, each of which includes an effect compartment and an indirect response model. The PK model is given by an ordinary differential equation(1)u(n)+αn−1u(n−1)+⋯+α0u=βm−1d(m−1)+⋯+β0dwhere d is the medication dose, u is the plasma concentration of medication, andαj,j=1,⋯n−1andβk,k=1,⋯m−1are constant coefficients. The superscript(i)denotesi-th order time derivative. The effect compartment models are given by:(2)τjẋj+xj=uwherexjis the effect site concentration of medication associated with thej-th endpoint (j=1,⋯,NEPwhereNEPis the number of endpoints), andτjis the corresponding equilibration time constant. Thesexj׳s affect the endpointsyj(j=1,⋯,NEP) by stimulating/inhibiting its production or dissipation via nonlinear functionsfjI(xj)andfjO(xj),j=1,⋯,NEP:(3)ẏj=kjIfjI(xj)−kjOfjO(xj)yjwherekjIandkjOare the zeroth-order production and first-order dissipation constants associated withyj, andfjI(xj)andfjO(xj)are given by(4)fjI(xj)=1±bjIxjajI+xj,fjO(xj)=1±bjOxjajO+xjwhere0<bjI≤1and0<bjO≤1denote the maximum stimulation/inhibition effect, whileajIandajOare the effect site concentrations of medication at which 50% of maximum stimulation/inhibition effect occurs. It is assumed thatxjexerts effect on eitherfjIorfjO, but not both [18]. Note that plus and minus signs in (4) denote, respectively, stimulation and inhibition. Note also thatkjIandkjOare related to each other bykjI=kjOyj0whereyj0is the baseline value of thej-th endpoint [18]. Indeed, in the steady state (ẏj=0) under zero medication dose (xj=0and thusfjI(xj)=fjO(xj)=1), (3) reduces tokjI=kjOyj0.It must be emphasized that the class of pharmacological systems shown in Fig. 2 subsumes a wide range of conventional pharmacological models, including steady-state dose-response models (e.g., [19]), direct effect models (e.g., [1,6–9,20] ) and indirect response models (e.g., [18,21,22]). Indeed, it is obvious that (1) steady-state dose-response model yields by removing the PK model then settingẋj=ẏj=0andajO=bjO=0, (2) direct effect model yields by settingẏj=0andajO=bjO=0, and (3) indirect response model yields by settingẋj=0. Thus, findings from this study are applicable to a broad range of pharmacological systems being widely used in today׳s pharmacology.This study examines the feasibility of deriving a data-driven model of the above class of pharmacological systems in case the plasma concentrationuis not available for measurement (as in real clinical settings). It is noted that, althoughuis not known, it serves as the common source for all the endpoints that are observed. By exploiting this commonality among endpoints, a relation between multiple endpoints can be formalized as follows. First, consider the case in whichxjexerts effect on the production of endpoint responses (i.e.,fjO=1,j=1,⋯,NEP). Then,xjcan be written in terms ofyjas follows:(5)xj=ajI[żjkjO+zj]±bj−[żjkjO+zj]=ajIgj(zj,kjO)±bjI−gj(zj,kjO)wheregj(zj,kjO)=(żj/kjO)+zjandzj=yj/yj0−1. Thus,uis given from (2) by(6a)u=τjẋj+xj=τjajIbjIġj(zj,kjO)[±bjI−gj(zj,kjO)]2+ajIgj(zj,kjO)±bjI−gj(zj,kjO)Similarly, it is straightforward (though tedious) to show thatucan be written in terms ofyjas follows in casexjexerts effect on the dissipation of endpoint responses (i.e.,fjI=1,j=1,⋯,NEP)(6b)u=τjẋj+xj=τjajObjOġj(zj,kjO)[±bjO−gj(zj,kjO)]2+ajOgj(zj,kjO)±bjO−gj(zj,kjO)wheregj(zj,kjO)=(1/kjO)(żj/zj+1)+zjandzj=yj0/yj−1. Combining (6a) and (6b) yields the following universal expression foru:(7)u=τjajbjġj(zj,kj)[bj−gj(zj,kj)]2+ajgj(zj,kj)bj−gj(zj,kj)wheregj(zj,kj)=(1/kj)wj+vj, and the variableswjandvjas well as the parametersaj,bjandkjare defined inTable 1. Therefore, the following relation holds betweeni-th andj-th endpoints (1≤i,j≤NEP):(8)τiaibiġi(zi,ki)[bi−gi(zi,ki)]2+aigi(zi,ki)bi−gi(zi,ki)=τjajbjġj(zj,kj)[bj−gj(zj,kj)]2+ajgj(zj,kj)bj−gj(zj,kj)This relation can be fitted to the observed endpoint datayj(j=1,⋯,NEP) so as to derive the data-driven PD model (that is, to derive the parametersτj,aj,bjandkj, thereby reconstructing the PD model (2)–(4)). Once the PD model is derived, the plasma concentrationucan be reconstructed using (7). Then finally, data-driven PK model can be derived by fitting (1) to the observed dose (d) and reconstructed plasma concentration (u) data as input and output. Since computinguis straightforward and deriving (1) is a standard linear regression problem, the key to the feasibility of this “endpoint information fusion” idea for data-driven pharmacological modeling is the identifiability of the PD model, i.e., whether or not (8) can be solved using endpoint data to yield the data-driven PD model.This subsection rigorously analyzes the identifiability property of the relation (8). To facilitate the analysis, (8) is re-written as follows by multiplying it by[bi−gi(zi,ki)][bj−gj(zj,kj)]and then dividing it byaibj(9)τibibjġi(zi,ki)bj−gj(zj,kj)bi−gi(zi,ki)−τjajaiġj(zj,kj)bi−gi(zi,ki)bj−gj(zj,kj)=λ1gj(zj,kj)+λ2gi(zi,ki)gj(zj,kj)−gi(zi,ki)whereλ1=(aj/ai)(bi/bj)andλ2=(1−(aj/ai))(1/bj). Note that the left-hand side of (9) is due to the effect compartment model (2), while the right-hand side accounts for the indirect response model (3). Based on (9), this study considers the following models of clinical significance:(1)Steady-state dose-response model is derived from (9) by settingẋj=ẏj=0, which yieldsġj=0andgj=vj,j=1,⋯,NEP. Then (9) reduces to the following (seeFig. 3(a)):(10a)λ1vj+λ2vivj−vi=0→vi=λ1vj+λ2vivjDirect effect model is derived from (9) by settingẏj=0in (3) (which yieldsyj=yj(xj)=yj0(1±(bjxj/(aj+xj)))), which yieldsgj=vj,j=1,⋯,NEP. Then (9) reduces to the following (see Fig. 3(b)):(10b)τibibjv̇ibj−vjbi−vi−τjajaiv̇jbi−vibj−vj=λ1vj+λ2vivj−viIndirect response model without effect compartment is derived from (9) by settingẋj=0, which reduces (9) to the following (see Fig. 3(c)):(10c)λ1gj(zj,kj)+λ2gi(zi,ki)gj(zj,kj)−gi(zi,ki)=0→gi(zi,ki)=λ1gj(zj,kj)+λ2gi(zi,ki)gj(zj,kj)Indirect response model with effect compartment is (9), which is the universal pharmacological model that can subsume all the above models.The following claims are made on the identifiability of the above PD models. The basic idea is to re-write the relation (10a–c) between endpoint responses into a linear regression, noting that the parameter vector in the linear regression is always identifiable [23].Claim 1(Identifiability of steady-state dose-response model): Consider the steady-state dose-response model shown inFig. 3(a), where the PD model for each endpoint is given by(11a)yj=yj0[1±bjIuajI+u]wherej=1,⋯,NEP. Using two observed endpoint response data (i-th andj-th endpoints), the following model parameters can be derived(11b)θSSDR=[λ1,λ2]Proof: see Appendix A.1.(Identifiability of direct effect model): Consider the direct effect model shown inFig. 3(b), where the PD model for each endpoint is given by(12a)τjẋj+xj=u,yj=yj0[1±bjIxjajI+xj]wherej=1,⋯,NEP. Using two observed endpoint response data (i-th andj-th endpoints), the following model parameters can be derived:(12b)θDE=[τi,τj,biI,bjI,ajIaiI]Proof: see Appendix A.2.(Identifiability of indirect response model without effect compartments): Consider the indirect response model without effect compartment shown inFig. 3(c), where the PD model for each endpoint is given by (note that eitherfjI(u)=1orfjO(u)=1holds):(13a)ẏj=kjIfjI(u)−kjOfjO(u)yjwherej=1,⋯,NEP. Using two observed endpoint response data (i-th andj-th endpoints), the following model parameters can be derived, wherekjI=yj0kjO,j=1,2:(13b)θIDR=[λ1,λ2,kiI,kjI,kiO,kjO]Proof: see Appendix A.3.(Identifiability of indirect response model with effect compartments): Consider the indirect response model with effect compartment shown inFig. 2, where the PD model for each endpoint is given by (note that eitherfjI(u)=1orfjO(u)=1holds):(14a)τjẋj+xj=u,ẏj=kjIfjI(xj)−kjOfjO(xj)yjwherej=1,⋯,NEP. Using two observed endpoint response data (i-th andj-th endpoints), the following model parameters can be derived, wherekjI=yj0kjO,j=1,2, andai,aj,biandbjare defined inTable 1:(14b)θIDREC=[τi,τj,bi,bj,kiI,kjI,kiO,kjO,ajai]Proof: see Appendix A.4.Two remarks can be made from the above claims. First, the effect compartment model plays an important role in the identifiability of the system, especially the stimulation/inhibition function (4). More specifically, the parametersbi,bjandaj/aiare identifiable only in the presence of the effect compartment models (as can be seen in Claims 2 and 4). Otherwise, only combinations of these parameters (λ1andλ2) can be derived. Second,aiandajare not identifiable from (9). This is due to the way the problem is formulated: sinceuis unknown, neither is its scale. Suppose the input is doubled in (4) (i.e.,xj→2xj). It is possible to keepyj(t)constant simply by doublingaj. So, the absolute values ofaiandajare not identifiable from (9); rather, only the ratio between them is identifiable.In most data-driven pharmacological modeling problems, parametric identifiability alone cannot guarantee high-quality derivation of the identifiable parameters. In theory, identifiable parameters can be accurately derived if the data used for modeling is sufficiently rich and informative (“persistently exciting”) [23]. In deriving a data-driven model of an engineering system, input to the system may be designed to fulfill this requirement [23]. In contrast, this is almost impossible in pharmacological systems under real clinical settings (such as a patient receiving medication treatment), because the primary goal in designing input (i.e., medication dose) is to deliver optimal therapy. Thus, the reliability (or variance) of the derived parameters depends on the profile of the medication dose delivered to the system. In fact, noting that medications are typically administered orally (modeled as an impulse function) or via constant infusions (modeled as step functions) which are often far from being persistently exciting, the variance of the parameters derived in the data-driven pharmacological models using these real-world dose profiles must be examined carefully to assess their reliability.A well-known empirical approach to quantitative examination of the parametric variance is the asymptotic variance analysis [23]. In this approach, the asymptotic variance of parameters in a model is computed by the diagonal elements in the following parametric covariance matrixPN:(15a)PN=λ^N[1N∑k=1Nψ(k,θ^N)ψT(k,θ^N)]−1whereλ^Nis the prediction error variance given by(15b)λ^N=1N∑k=1Nϵ2(k,θ^N)=1N∑k=1N[σ(k,θ^N)−σ^(k,θ^N)]2whereσ(k,θ^N)andσ^(k,θ^N)are reference versus observed system outputs, respectively,θ^Nis the model parameters derived fromNobserved data, andψ(k,θ^N)is the parametric sensitivity of the prediction error given by(15c)ψ(k,θ^N)=∂ϵ(k,θ)∂θ|θ=θ^NTo apply the asymptotic variance analysis to the parameters in the data-driven pharmacological models derived from the endpoint information fusion, (8) is re-written as follows to account for the fact that onlyaj/ai, but notaiandajseparately, is identifiable:(16)τibiġi(zi,ki)[bi−gi(zi,ki)]2+gi(zi,ki)bi−gi(zi,ki)=ajai{τjbjġj(zj,kj)[bj−gj(zj,kj)]2+gj(zj,kj)bj−gj(zj,kj)}It is obvious that both right-hand side and left-hand side of (16) areu/ai. In theory, therefore, they have to be identical. Then,ϵ(k,θ^N)in (15a–c) can be defined as follows:(17)ϵ(k,θ^N)=σ(k,θ^N)−σ^(k,θ^N)=0−{τibiġi(zi,ki)[bi−gi(zi,ki)]2+gi(zi,ki)bi−gi(zi,ki)−ajaiτjbjġj(zj,kj)[bj−gj(zj,kj)]2−ajaigj(zj,kj)bj−gj(zj,kj)︸σ^(k,θ^N)}whereσ(k,θ^N)=0. Using (17),ψ(k,θ^N)is given by:(18)ψ(k,θ^N)=[∂ϵ(k,θ^N)∂τi∂ϵ(k,θ^N)∂τj∂ϵ(k,θ^N)∂bi∂ϵ(k,θ^N)∂bj∂ϵ(k,θ^N)∂ki∂ϵ(k,θ^N)∂kj∂ϵ(k,θ^N)∂(aj/ai)]|θ=θ^N=[−biġi(zi,ki)[bi−gi(zi,ki)]2ajaibjġj(zj,kj)[bj−gj(zj,kj)]2τiġi(zi,ki){bi+gi(zi,ki)[bi−gi(zi,ki)]3}+gi(zi,ki)[bi−gi(zi,ki)]2−ajaiτjġj(zj,kj){bj+gj(zj,kj)[bj−gj(zj,kj)]3}−ajaigj(zj,kj)[bj−gj(zj,kj)]2−τibi{∂ġi(zi,ki)∂ki[bi−gi(zi,ki)]+2ġi(zi,ki)∂gi(zi,ki)∂ki[bi−gi(zi,ki)]3}−∂gi(zi,ki)∂kibi[bi−gi(zi,ki)]2τjbjajai{∂ġj(zj,kj)∂kj[bj−gj(zj,kj)]+2ġj(zj,kj)∂gj(zj,kj)∂kj[bj−gj(zj,kj)]3}+ajai∂gj(zj,kj)∂kjbj[bj−gj(zj,kj)]2τjbjġj(zj,kj)[bj−gj(zj,kj)]2+gj(zj,kj)bj−gj(zj,kj)]|θ=θ^Nwhere(∂gj(zj,kj)/∂kj)=−(wj/kj2)and(∂ġj(zj,kj)/∂kj)=−(ẇj/kj2). Note that (18) applies directly to indirect response models with effect compartments, while its reduced versions apply to the other models considered in this study. In sum, oncePNis computed, the variance of thej-th parameter can be derived from the (j,j) element ofPN(e.g., from (18), the variance ofτiis the (1,1) element ofPN).

@&#CONCLUSIONS@&#
