@&#MAIN-TITLE@&#
Clearing control policies for MAP inventory process with lost sales

@&#HIGHLIGHTS@&#
We model, via simple probabilistic approach, a reflected MAP inventory process.We analyze 3 clearing policies under the discounted and average criterions.For high values of K, Tqand Tζare preferred.For high values of h, min(Tq, Tζ) policy is preferred. It is worthwhile to determine q*, which minimizes the total cost.

@&#KEYPHRASES@&#
Inventory control,Clearing models,Stochastic processes,Applied probability,

@&#ABSTRACT@&#
We consider a production/clearing process in a random environment where a single machine produces a certain product into a buffer continuously. The demands arrive according to a Markov Additive Process (MAP) governed by a continuous-time Markov chain, and their sizes are independent and have phase-type distributions depending on the type of arrival. Since negative inventory is not allowed, the demand may be partially satisfied. The production process switches between predetermined rates that depend on the state of the environment. In addition, the system is totally cleared at stationary renewal times and starts anew at level zero immediately. Several clearing policies are considered: clearing at random times, clearing at crossings of a specified level, and a combination of the above policies. We assume the total cost includes a fixed clearing cost, a variable cost for the cleared amount, a holding cost, and a lost demand cost. By applying regenerative theory, we use tools from the exit-time theorem for fluid processes and martingales to obtain cost functionals under both the discounted and average criteria. Finally, illustrative examples and a comparative study are provided.

@&#INTRODUCTION@&#
Stochastic systems with clearing policies model many different applications, including certain bulk server queues and buffers in communication systems and manufacturing. Clearing models were first studied mainly for the stock level of cumulative inventory systems; see e.g., Berman, Porlar, Perry, and Posner (2005), Kella (1998), Kella, Perry, and Stadje (2003), Pinçe, Gürler, and Berk (2008), Serfozo and Stidham (1978), and Stidham (1977). Other applications include public transportation models, where arriving customers form a queue until a server, say, a bus or a train, arrives and removes all the customers present; a tour may depart only after enough interested people are on hand to constitute a group. The shuttle model of Ignall and Kolesar (1972) has some of the characteristics of a clearing system. In the queueing context, systems with work removals have also attracted attention; see, e.g., Boucherie and Boxma (1996), and Jain and Sigman (1996).In this paper, we consider a production/clearing model in a random environment where a single machine produces a certain product into a buffer continuously. Customers (e.g., retailers) generate the demand for the product. The system is totally cleared at stationary renewal times. The model is therefore characterized by stochastic inputs (production) and outputs (retailers) and additional total “clearings” at certain random times. After each such clearing, the system is assumed to be ready to start working again immediately. Thus, the associated content process is assumed to be semi-regenerative, starting almost anew at level zero at every clearing time.In the literature, two core models are considered. In the first model, each time a pre-deterministic control limit level is reached by the content level, the buffer is cleared. In the language of inventory theory, the inventory level is controlled under continuousreview because it is observed continuously over time and the controller ”sees” the specific level once reached. In the second core model, the buffer is emptied periodically at random times and we assume that these sporadic clearing times form a renewal process that is independent of the input times and sizes. We emphasize that models with continuous review are different from those with sporadic clearing times, because the timing of the clearing is determined by the controller and is therefore dependent on the inventory level.The continuous models can be used to describe the control of epidemics, in which the quantity of interest is the number of susceptibles and the clearing corresponds to a mass vaccination whenever the number of susceptibles exceeds a specific number (see also Taylor, 1968 and Perry and Stadje, 2001). Further use of these models includes inventory control. In many factories, due to physical capacity limits or safety and fire hazard regulations, inventory levels cannot exceed a specific level and so the inventory is transferred to other locations. An example that the authors are familiar with comes from Haifa Group Ltd. Haifa Group Ltd. is a global supplier of potassium nitrate for agriculture and industry, specialty plant nutrients and food phosphates. It has two production plants located in Israel and another in France, with a combined production capacity of 0.5 million tons of potassium nitrate annually (see www.haifa-group.com). A huge time and cost factor associated with changing the production rates or switching the plants off causes the plants to operate continuously in a 24/7 manner. Due to the stochastic nature of the production/demand processes, inventories may reach undesirably high levels and exceed the predetermined base stock level. Thus, each time the control level is reached, Haifa Group Ltd. has to dispose of the stock in the form of sales in a secondary market and/or temporary relocation.Examples of sporadic models are the so-called disasters and obsolescence. In models with disasters all items stored are subject to unexpected external events that instantaneously bring the utility of all items on the shelf to zero, e.g., spoilage because of extreme weather conditions or a malfunction of a refrigerator that stores them; see e.g., Baron, Berman, and Perry (2014), Boxma, Perry, and Stadje (2001), and Gomez-Corral (2005).The family of models with obsolescence assumes that items become obsolete due to the introduction of a new product that replaces them in the market. Thus, the entire stock will simultaneously become obsolete at some (typically random) time. Examples are ample; in some industries like wireless chips the lifecycles of parts can be less than one year. There are thousand of components that reach the end of their life every month as suppliers prune their offerings (Tyler, 2004); part obsolescence has become an increasingly acute problem for many equipment companies (Shotter, 2012). Further examples of obsolescence models range from avionics and the military sectors, high-tech products, communications, construction equipment, medical devices, transportation, and supply chain networks (we refer the readers to Chandiran (2004), Shen and Willems (2014), Song and Lau (2004), and Song and Zipkin (1996) for more examples).Combined models have been widely discussed in recent decades. Boxma et al. (2001) consider M/G/1-type queueing system with disasters, occurring at deterministic equidistant times, at random times, and at crossings of some specified level. Kella et al. (2003) study a stochastic input-output system with time between clearings given by a Brownian motion and a compound Poisson process clearing. Berman et al. (2005) introduce two clearing policies: continuous and sporadic review under two different issuing policies. Stadje (2007) studies a cumulative storage system that is totally cleared at stationary renewal times and determines the distribution of the interoverflow times.In this paper we assume that the arrival times of demands form a Markov Additive Process (MAP) governed by a continuous-time Markov chain (environment), where the demand sizes are independent and have phase-type distributions depending on the type of arrival. The production process switches between predetermined rates which depend on the state of the environment (note that the case of a fixed production rate is a special case of the latter). Negative inventory is not allowed; that is, there is no backlogging and so level 0 is a reflecting barrier and we assume that the demand is completely or partially satisfied.Three control policies are studied in this paper:1. Each time a pre-determined control limit level q is reached by the content level, the buffer is cleared and transferred to the wholesaler (e.g., as in the case of a finite storage capacity). Define the first clearing timeTq=inf{t:I(t)≥q}. For this policy, q is the controller’s decision variable.2. We assume that the clearing times form a Poisson process that is independent of I. Thus the clearing policy for the first cycle is an exp (ζ) distributed random time, say, Tζ. Alternatively, this can reflect situations where management may have little control or information on the process (as in the case of disasters or obsolescence).3. We also deal with a combination of the above policies, min (Tq, Tζ). Clearing takes place at exponential time unless the level q is reached before hand, in which case the controller gets an emergency call, arrives immediately, and clears the system.For the three policies, we assume the following costs: (i) a fixed cost for each clearing, (ii) a cost for each cleared item, (iii) a holding cost for the inventory, and (iv) a penalty cost for the unsatisfied demand. Our objective is to obtain tractable formulas for the appropriate cost functionals under all of these policies. In this paper we focus on the discounted cost criterion using a discount factor β > 0; however, we also deal with the long-run average cost criterion. To the best of our knowledge, such a general model has never been investigated in the clearing/disaster literature and thus our research is novel. Furthermore, while the afore-mentioned papers involve analytic derivations of the quantities of interest, we emphasize our study using a more probabilistic approach; this enables a simple derivation of quantities of interest and obtains easy-to-implement explicit formulas for each policy. Our analysis is based on martingale techniques and on exit-time results for Markov-modulated fluid flow (MMFF) models. Starting from this analysis, one can minimize the cost of the system with respect to the parameters (e.g., q, ζ, the production rates, the demand size, and the costs) under each policy.The martingale approach was introduced by Kella and Whitt (1992) and then generalized by Asmussen and Kella (2000); it has become an increasingly popular tool in the study of various stochastic inventory models; see, e.g., Barron (2015), Barron, Perry, and Stadje (2014), Kella et al. (2003) and the references given therein. The exit-time theory for the Markov-modulated fluid flow models have been initiated by some papers; see Bean and O’Reilly (2008), Ramaswami (2006) and others. They develop quadratically convergent algorithms that can be used to calculate the Laplace-Stieltjes transforms of the time taken to return to the initial level in an MMFF model.The article is organized as follows. In Section 2, we define the inventory content level and the cost functionals in a formal manner. The basic techniques are expounded in Section 3. In Sections 4–6 we present the derivations under the three policies. Section 7 is devoted to the long-run analysis. We also provide some numerical examples by way of graphical displays and tables. Finally, in the concluding Section 8 we propose some extensions for further research.Consider an inventory process I, modeled via a Markov additive process (MAP) with downward jumps (e.g., Asmussen, 2003, chap. XI). LetJ={Jt}t≥0be the underlying environment process, which is a homogeneous irreducible continuous-time Markov chain with finite state spaceE={1,2,ldots,m}and representation (v, D0, D1). Here v is the initial probability row vector andD0+D1is the intensity matrix. We shall writeD0=(D0(i,j))i,j=1mD1=(D1(i,j))i,j=1m. The demand arrival process N(t)t ≥ 0 of a MAP is controlled by J as follows:(1)transition of J from state i to state j without any accompanying demand (where i ≠ j ) occurs at rate D0(i, j) ≥ 0; andtransition of J from state i to state j with an accompanying demand (with the possibility thati=j) occurs at rate D1(i, j) ≥ 0.Note that forD0+D1to be an intensity matrix, each diagonal element of D0 has to be negative and is such that the sum of the elements on each row ofD0+D1is zero. The bivariate Markov process (N, J) is called the Markovian arrival process. Thus, whenJ(t)=i,demands arrive according to a Poisson process at rate D1(i, i). We call this demand an ii demand. At rate D1(i, j), demand arrives upon a transition from state i to state j ≠ i and is called an ij demand.Let{Uk}k=1∞be the sequence of individual demand amounts. We assume that{Uk}k=1∞have a phase type distribution. A phase type distribution with representation(E,α,T)is the distribution of the time to absorption in a continuous time Markov chain with transient states in the finite setE,and one absorbing state.αis the initial probability vector of the transient states, and T is the transition rate matrix among the transient states. It is assumed that the distribution of the demand amount depends on the states of the environment process J immediately before and after a transition of type (2). More precisely, whenever a transition from i to j is accompanied by a demand, the resulting demand amount Ui, jhas a phase type distribution with representation (Eij, gij, Gij). LetGi,jo=−Gijebe the transition rate vector to the absorbing state, e be a column vector with all components equal to 1,μij=E[Ui,j]=−gijGij−1eandMUi,j(s)=gij(sI−Gij)−1Gi,jo,where I is the |Eij| × |Eij| identity matrix.We assume a set of production ratesR={c1,…,cm}⊂(0,∞). The rate at which the inventory is filled at time t is determined by the current environmental state J(t); ifJ(t)=i,i∈E,the content level is filled at rate ci∈ R. In our model backorders are not allowed, and thus unsatisfied demand is lost. Let I(t) be the inventory level process under one of the clearing policies mentioned above.Let Tn, n ≥ 1 be the length of the n cycle (i.e., the time between the(n−1)th and the nth clearing) and letS0=0,Sn=T1+⋯+Tnfor n ≥ 1. Note that at times S0, S1, S2, ... the process restarts at level 0, but has to ”remember” the environmental state; thus, I is a semi-regenerative process with respect to the times S0, S1, S2, .... A typical sample path of the process is given in Fig. 1.Obviously, in the absence of any controls (clearings), the following∑i=1mπici<∑i=1mπi∑j=1mD1(i,j)μijis necessary and sufficient for stability. Hereπ=(π1,…,πm)is the stationary distribution of the Markov chain J(t).We use P to denote the underlying probability measure and Pito denote conditional probability given thatJ(0)=i. Denote by E and Eithe corresponding (vector) expectation and conditional (vector) expectation operators. Let E, P represent a matrix-valued expectation and probability operators, respectively. Denote by eia vector with the ith component equal to 1 and all the other components equal to 0, and denote by I the identity matrix (all of the appropriate sizes).Using regenerative theory we can express all cost functionals in terms of{I(t)}t≤T1,the stock level process in the first cycle. For the rest of the paper letT1=T.Let us now introduce meaningful discounted functionals to measure the main cost factors of the system.(a) Fixed cost for clearings. Let N(t) be the number of clearings up to time t. Thus,C1(β)=KE(∫0∞e−βtdN(t))where K is the cost of a single clearing. By applying renewal theory, C1(β) can be expressed in terms of one cycle:C1(β)=KE(∑i=1∞e−βSi)=Kν(I−E(e−βT))−1E(e−βT)e(recall that ν is the distribution of J(0)). We useE(e−βT)as shorthand notation for the (m × m) matrix whose ijth component is[E(e−βT)]ij=E(e−βT1{J(T)=j}∣J((0)=i),which is the conditional Laplace–Stieltjes transform (LST) matrix of the clearing time T.(b) Variable costfor the cleared amount. This cost is incurred at the clearing time. If f > 0 is the cost of one cleared unit, the expected total discounted variable cost C2(β) can be expressed asC2(β)=fE(∑ie−βSiI(Si−))=fν(I−E(e−βT))−1E(I(T−)e−βT),whereI(T−)is the actually cleared amount andE(I(T−)e−βT)is an (m × 1) vector whose ith component is the expected discounted cleared amount for a cycle givenJ(0)=i. Note that under the TqpolicyI(T−)=q;however, under other policies the actually cleared amount is random, depending on the content level just before clearing.(c) Holding cost. The total expected discounted holding cost can be expressed asC3(β)=hE(∫0∞e−βtI(t)dt),where hdt is the holding cost for a unit of stock during a time interval of length dt. In revoking the ergodic theorem for regenerative processes, we can write C3(β) in terms of the first cycle:(1)C3(β)=hE(∫0T1e−βtI(t)dt+e−βT1∫0T2e−βtI(T1+t)dt+⋯)=hν(I−E(e−βT))−1h^T(β),whereh^T(β)is an (m × 1) vector whose ith component is given by[h^T(β)]i=Ei(∫0Te−βtI(t)dt)i=1,…,m.(d) Unsatisfied demand cost. In our model negative inventory is not allowed. Thus a partially unsatisfied demand occurs whenever the process I(t) down-crosses level 0. Let φ > 0 be the penalty cost per unsatisfied unit of demand. Denote the kth time that this happens by ξkand the size of the corresponding portion of unsatisfied demand by Yk. The expected total discounted cost of unsatisfied demand can be expressed as(2)C4(β)=φE(∑ke−βξkYk).Let NY(T) be the number of partially unsatisfied demands during the first cycle. Regenerative theory yields(3)C4(β)=φν[I−E(e−βT)]−1u^T(β),whereu^T(β)is the (m × 1) vector whose ith component is given by[u^T(β)]i=Ei(∑k=1NY(T)e−βξkYk).The simplest way to combine the functionals in (a)–(d) in one cost measure is to add themC(β)=C1(β)+C2(β)+C3(β)+C4(β).The central tools of our analysis are the exit-time theory of fluid process and the optional sampling theorem to the multi-dimensional martingale. We summarize them shortly in order to make this paper self-contained.Consider an MAP inventory level process with production rates R. Suppose an ij demand of size x occurs at time t so thatJ(t−)=iandJ(t)=j.Then the downward jump of size x is replaced by a line segment of length x/ciof continuous linear decrease at rate ciper time unit. Thus, when the incoming demand has a size that is phase-type distributed with representation (Eij, gij, Gij), the fluid decreases at rate cifor a time interval whose length has the phase-type distribution with representation (Eij, gij, ciGij). The processF(t)generated in this way is called the fluid inventory process. The fluid inventory process can also be described as follows. Assume (without restriction of generality) that the sets Eijare pairwise disjoint. We introduce a modulating CTMCJ(t)with state spaceS=S1∪S2,whereS1=EandS2=∪i∈E∪j∈EEij.States in S1 are denoted by i ∈ E and states in S2 by (ij, l) with i, j ∈ E and l ∈ Eij. The fluid level at time t isF(t)and is modulated as follows: whenever the Markov chain is in i ∈ S1, i.e.,J(t)=i,the fluid flow increases at rate ci, and when it is in S2, say,J(t)=(ij,l),F(t)decreases at rate ci.In the analysis of the Markov-modulated fluid flow process, first passage times play an important role. Letτ(x)=inf{t>0,F(t)=x}be the first passage time to level x and letΨ(s)be the following Laplace-Stieltjes transforms (LST)[Ψ(s)]ij=E(e−sτ(0),J(τ(0))=j∣F(0)=0,J(0)=i).[Ψ(s)]ijrepresents the LST of τ(0) restricted to the event that the fluid process hits level 0 at state j ∈ S2, givenF(0)=0andJ(0)=i∈S1.In the literature, a few algorithms, including some quadratically convergent ones, were established for computingΨ(s);however, in this paper we apply the algorithm of Ramaswami (Ramaswami, 2006, Appendix 1, p. 512). Letabτ(x,y)(for x ≥ 0, y ≥ 0, b > a ≥ 0) be the first passage time ofFfrom level x to level y avoiding a visit to the levels in[0,a]∪[b,∞)enroute. We use the notationabf^(x,y,s)to denote the matrix of Laplace-Stieltjes transform of the joint distribution of the first passage timeabτ(x,y)and the state of the phase process at each first passage time. All LST matrices, for the hitting times, that we will use (e.g.,0f^11(0,q,β),qΨ(β)) are straightforward to evaluate once we have computedΨ(s).For more details we refer the readers to Ahn, Badescu, and Ramaswami (2007), Barron et al. (2014), and Ramaswami (2006).In order to apply the results to our original process, we replace the argument of the LSTs for the fluid model by 0 (i.e., sets=0) for all matrix entries of the form ((ij, k), j) or ((ij, k), (ij, l)), i.e., in all rows corresponding to states in S2. From now on we assume that all the LST matrices for hitting times are modified for the original inventory model.Let (X(t))t ≥ 0 be a right-continuous Markov-modulated Lévy process with a modulating process (J(t))t ≥ 0, which is a right-continuous irreducible continuous-time Markov chain with a finite state space. Let Y(t) be an adapted continuous process having a finite expected total variation on every compact interval. SetZ(t)=X(t)+Y(t).For such a process, the matrix with elementsEi(eαX(t)1{J(t)=j})can be represented in the form etK(α) for some matrix K(α). Theorem 2.1 in Asmussen and Kella (2000) yields that, under certain mild conditions on (Z(t))t ≥ 0, the multi-dimensional process(4)M(α,t)=∫0teaZ(s)1J(s)dsK(α)+eaZ(0)1J(0)−eaZ(t)1J(t)+α∫0teaZ(s)1J(s)dY(s)is a (row) vector-valued zero mean martingale. Here 1J(t) is the row vector(1{J(t)=1}…,1{J(t)=m}).Some of the relevant functionals in this paper will be obtained by applying the optional sampling theorem (OST) to appropriate special cases of (4) .Remark 1Once our process down-crosses level 0 due to ij demand (either under policy Tq, Tζor min (Tq, Tζ)), the unfilled demand is lost and the content level starts again from level 0 and state j ∈ S1. In order to ”remember” the process’s state, we need to applyI¯as follows. LetI¯be the (|S2| × |S1|) matrix whose entries are nonzero only for states of the form ((ij, l), j) andI¯((ij,l),j)=1; the multiplication by the matrixI¯collects all the terms corresponding to a specific environmental state in S1 after down-crossing level 0 and starting again from 0.Under the Tqpolicy, the system is cleared whenever the content level crosses the level q > 0, so the first clearing takes place at timeTq=inf{t:I(t)≥q}.Note that the content level process is a semi-generative process with cycle time Tq. We are interested in the following costs functionals: the expected discounted cycle lengthE(e−βTq)(associated with all the costs), the expected discounted inventory levelh^Tq(β),and the expected discounted lost salesu^Tq(β)(the latter two associated with C3(β) and C4(β), respectively).We start with the derivation ofE(e−βTq).Corollary 2The expected discounted cycle length is given by(5)E(e−βTq)=(I−qΨ(β)I¯)−10f^11(0,q,β).There are two possibilities: either the first clearing epoch is reached without crossing level 0 (the restricted LST of this time is0f^11(0,q,β)), or the process drops to level 0 before level q and starts again (the restricted LST of this time isqΨ(β)I¯).Thus,E(e−βTq)satisfies the matrix equation(6)E(e−βTq)=0f^11(0,q,β)+qΨ(β)I¯E(e−βTq).Arranging (6) yields (5). Note thatE(e−βTq)completes the derivation of C1(β) and the derivation of C2(β) sinceE(e−βTqI(Tq−))=qE(e−βTq)e.□To determine C4(β) we have to deriveu^Tq(β)=E(∑k=1NY(Tq)e−βξkYk).Recall that we denote the occurrence time of the kth lost demand by ξkand the lost amount by Yk. LetGbe the following |S2| × |S2| matrix:G=(−G11−10−G12−1⋱0−Gmm−1)Lemma 4.1(7)u^T(β)=(I−qΨ(β)I¯)−1qΨ(β)Ge.A lost demand occurs when the process hits level 0 before reaching q (the restricted LST of this time isqΨ(β)). Once the inventory process crosses 0 due to an ij-demand at phase l, the unsatisfied demand level is a random variable ε(ij, l) that has a phase-type distribution with representation (Eij, el, Gij) with mean−elGij−1e.From that point, it starts again from level 0 and state j ∈ S1. Thus, we can writeu^T(β)as follows:(8)u^T(β)=qΨ(β)Ge+qΨ(β)I¯u^T(β),whereGeis the expected demand loss. Solving (8) foru^T(β)yields (7).□Finally, we need to deriveh^Tq(β)=E(∫0Tqe−βtI(t)dt).Define the stopping time(9)Lq=inf{t>0:I(t)=qorI(t)<0}such that Lqis the first time the inventory process reaches level q or drops below 0. Clearly, Lq≤ Tq.Claim 4.1(10)h^Tq(β)=(I−qΨ(β)I¯)−1E(∫0Lqe−βtI(t)dt).Since Lq≤ Tqwe obtain(11)E(∫0Tqe−βtI(t)dt)=E(∫0Lqe−βtI(t)dt)+E(∫LqTqe−βtI(t)dt).Applying decomposition, we get(12)E(∫LqTqe−βtI(t)dt)=E(∫LqTqe−βt1{Lq=Tq)I(t)dt)+E(∫LqTqe−βt1{Lq<Tq)I(t)dt)=E(e−βLq1{Lq<Tq))E(∫0Tqe−βtI(t)dt).Notice that the (|S1| × |S1|) matrixE(e−βLq1{Lq<Tq))=qΨ(β)I¯.Substituting (12) in (11) yields (10).□Next, we derive the right-hand side term of (10),E(∫0Lqe−βtI(t)dt).We apply the OST to the multi-dimensional martingale (4). Consider the associated Lévy process (X(t))t ≥ 0 with no negative jumps, defined as follows:(13)X(t)=∑k=1N(t)Uk−∫0tcJ(s)dst≥0.N(t) is the counting process of the demand arrival times,cJ(s)is the production rate and Ukis the kth demand size. Note thatX(0)=0. Each ij demand Ukhas a phase-type distribution with representation (Eij, gij, Gij). It can be concluded from Chapter XI, p. 311 of Asmussen (2003) thatEi(eαX(t)1{J(t)=j})=etK(α),where the matrix K(α) is given by(14)K(α)=D0+D1−αC+[D1(i,j)(U˜i,j(α)−1)].Here the diagonal matrixC=diag(cj,j∈S1),U˜i,j=E(eαUij)is the moment-generating function of an ij demand, and[D1(i,j)(U˜i,j(α)−1)]is the (m × m) matrix whose (i, j) element is given byD1(i,j)(U˜i,j(α)−1).It is not difficult to see that this process up to time Lq, i.e.,(X(t))0≤t<Lq,has the same distribution as(−I(t))0≤t<Lq. Finally, defineY(t)=−(β/α)t,for arbitrary β ≥ 0 and α < 0, andW(t)=X(t)+Y(t)=X(t)−(β/α)t.Since Y is adapted and has paths of finite expected total variation on bounded intervals, Theorem 2.1 of Asmussen and Kella (2000) yields that the process(15)M(α,t)=(M1(α,t),M2(α,t),ldots,Mm(α,t))⊺=∫0teαW(s)1J(s)dsK(α)+eαW(0)1J(0)−eαW(t)1J(t)+α∫0teαW(s)1J(s)dY(s)=∫0teαX(s)−βs1J(s)ds(K(α)−βI)+eαX(0)1J(0)−eαX(t)−βt1J(t)is an m-row vector-valued zero mean martingale. Recall that E is the matrix-valued expectation operating on m-row vector random variables like M(α, t) whose (i, j) component is the conditional expectation of the jth entry given thatJ(0)=i,i.e.,[E(M(α,t))]i,j=[E(Mi(α,t))]j.Note that∫0teαX(s)−βsds=∫0teαX(s)−βs1J(s)dse.The optional sampling theory yieldsE(M(α,Lq))=E(M(α,0))=0,so that(16)E(∫0LqeαX(s)−βsds)=[E(eαX(Lq)−βLq1J(Lq))−E(eαX(0)1J(0))](K(α)−βI)−1e.Clearly,E(eαX(0)1J(0))=I. For the first right-hand side term of (16) ,westart with the decomposition(17)E(eαX(Lq)−βLq1J(Lq))=E(eαX(Lq)−βLq1{J(Lq),Lq=Tq})+E(eαX(Lq)−βLq1{J(Lq),Lq<Tq}).ForLq=Tq,X(Lq)=−q,applying the fluid method yields(18)E(eαX(Lq)−βLq1{J(Lq),Lq=Tq})=e−αq0f^11(0,q,β).As for the case Lq< Tq, assume that the process hits level 0 due to kj demand with phase l ∈ S2. Thus, X(Lq) has the same distribution as ε(kj, l). LetU˜(α)be the |S2| × |S1| matrix whose ((kj, l), j) component is the moment-generating function of ε(kj, l), i.e.,(19)[U˜(α)](kj,l),j=el(−αI−Gkj)−1Gkjo,and all other components are 0. Now,(20)Ei(eαX(Lq)−βLq1{J(Lq),Lq<Tq})=∑(kj,l)∈S2Ei(e−βLq1{J(Lq)=(kj,l),Lq<Tq})E(kj,l)(eαX(Lq)).Note that(21)Ei(e−βLq1{J(Lq)=(kj,l),Lq<Tq})=[qΨ(β)](i,(kj,l))andE(kj,l)(eαX(Lq))=[U˜(α)]((kj,l),j).Inserting (21) in (20) yields the matrix form(22)E(eαX(Lq)−βLq1{J(Lq),Lq<Tq})=qΨ(β)U˜(αa).Substituting (22), (18) and (17) in (16) we arrive at(23)E(∫0LqeαX(s)−βsds)=[e−αq0f^11(0,q,β)+qΨ(β)U˜(α)−I](K(α)−βI)−1e.Taking the derivative of (23) with respect to α and settingα=0leads to(24)∂∂α{[e−αq0f^11(0,q,β)+qΨ(β)U˜(α)−I](K(α)−βI)−1e}|α=0⟶−E(∫0Lqe−βtI(t)dt).Example 1We consider a two-state MAP process with the following transition rate matrices:D0=(−0.040.010.05−0.17),D1=(0.020.010.020.1)As the initial probability vector we takev=(0.8,0.2).The demand sizes have phase-type distributions, each with two states:G11=(−521−3),G12=(−0.10.051−2)G21=(−1.511−1),G22=(−1/1500−1/20)whereg11=(0.7,0.3),g12=(0.5,0.5),g21=(1,0)andg22=(0.8,0.2).We fix the discount factorβ=0.01and the costsK=1,f=1,h=1andφ=1.The production rates areR={c1,c2}and we assume thatc1=c2(call this rate R).Let R vary in {0.2, 0.5, 1, 1.5, 2} and let q vary in {1, .., 10}. Figs. 2–4display the fixed clearing cost, holding cost and lost demand cost, respectively, as functions of q and R. We see that C1(β) decreases in q and increases in R since increasing q decreases the number of clearings; however, increasing the production rate R clearly decreases the time to a clearing. Fig. 3 shows that the holding cost, C3(β), increases in q, but it seems to be concave in R. The logic of the latter behavior is that increasing R increases the inventory level; however, for high levels of R, the time to a clearing is reduced, and thus we see a reduction in the inventory level. Regarding q, Figs. 4 and 2 share a similar behavior. Regarding R, we see that C4(β) decreases for lower values of R and increases for higher values. Clearly, increasing R causes less loss; however, a higher production rate causes more clearings and thus more loss.In general, different values of the parameters K, f, h, φ imply unique behavior of the total cost C(β). Figs. 5–7present the total cost as a function of q forR=0.5.In each figure we vary one of the parameters K, h, φ and fix the other ones. We see that relatively high values of K and h cause C(β) to be a convex function of q (similar to other classical inventory models, e.g., EOQ); thus, we can obtain a q* which minimizes C(β). In addition, Fig. 7 shows that the behavior of C(β) is influenced mostly by K and h and hardly by φ.We retain the notation introduced in Section 1. Let clearings take place at time instants that form a Poisson process with intensity ζ which is independent of the inventory process (I(t))t ≥ 0. Let Tζdenote the first clearing time; thus, Tζis exponentially distributed with mean 1/ζ.For a modulated CTMC J(t), it is well known that the generator matrix Q satisfies(25)[exp(Qx)]ij=P(J(x)=j∣J(0)=i)(see Latouche and Ramaswami, 1999, chap. 2). Applying (25) and conditioning with respect to Tζleads to the (|S1| × |S1|) expected discounted cycle length matrix(26)E(e−βTζ)=(∫0∞e−βuζe−ζueQudu)=ζ((β+ζ)I−Q)−1.The matrix eQuarises due to the fact that the phase of the process at time Tζneeds to be taken into account for the continuity of the model. The termE(e−βTζ)completes the derivation of C1(β) under Tζpolicy.Next we determineu^Tζ(β)=E(∑k=1NY(Tζ)e−βξkYk)associated with C4(β).Claim 5.1(27)u^Tζ(β)=(I−Ψ(β+ζ)I¯)−1Ψ(β+ζ)Ge.A lost demand occurs when the process hits level 0 before time Tζ. Regarding ξ1, the first time the process drops below level 0, we have(28)u^Tζ(β)=E(e−βξ11{ξ1<Tζ}Y1)e+E(e−βξ11{ξ1<Tζ})I¯u^Tζ(β).Applying the exponential properties, the second term is given by(29)E(e−βξ11{ξ1<Tζ})=E(e−(β+ζ)ξ1)=Ψ(β+ζ).The first term of (28) can be obtained similarly to the proof of Lemma 4.1, which leads to(30)E(e−βξ11{ξ1<Tζ}Y1)=Ψ(β+ζ)Ge.Substituting (30) and (29) in (28), solving foru^T(β)yields (27).□In order to obtain C3(β), we need to derive the expected discounted inventory level vectorh^Tζ(β)=E(∫0Tζe−βtI(t)dt).Letχ=min(ξ1,Tζ),so χ is the time of clearing or dropping below level 0, whichever occurs first. Thus,(31)h^Tζ(β)=E(∫0χe−βtI(t)dt)+E(∫χTζe−βt1{ξ1<Tζ}I(t)dt)+E(∫χTζe−βt1{ξ1>Tζ}I(t)dt).Clearly,E(∫χTζe−βt1{ξ1>Tζ}I(t)dt)=0.Applying the memoryless property of the exponential distribution leads toE(∫χTζe−βt1{ξ1<Tζ}I(t)dt)=E(e−βξ11{ξ1<Tζ})I¯h^Tζ(β),whereE(e−βξ11{ξ1<Tζ})is given by (29). Hence, we obtain(32)h^Tζ(β)=(I−Ψ(β+ζ)I¯)−1E(∫0χe−βtI(t)dt).For the determination ofE(∫0χe−βtI(t)dt)we follow OST to the multi-dimensional martingale (16), this time with χ replacing Lq(33)E(∫0χeαX(s)−βsds)=[E(eαX(χ)−βχ1J(χ))−E(eαX(0)1J(0))](K(α)−βI)−1e.ClearlyE(eαX(0)1J(0))=I.Note that(34)E(eαX(χ)−βχ1J(χ))=E(eαX(ξ1)−βξ11{J(χ),ξ1<Tζ})+E(eαX(Tζ)−βTζ1{J(χ),ξ1>Tζ}).We reveal two cases. In the case of ξ1 < Tζ, assume the process hits level 0 due to (ij, l) demand; thus, X(ξ1) has the same distribution as ε(ij, l) and the (m × m) matrixE(eαX(ξ1)−βξ11{J(χ),ξ1<Tζ})=Ψ(β+ζ)U˜(α).In the case of ξ1 > Tζwe use the identityE(eαX(Tζ)−βTζ1{J(χ),ξ1>Tζ})=ζE(∫0ξ1eαX(t)−(β+ζ)t1J(t)dt),which follows by conditioning on the left-hand side with respect to Tζ∼ exp (ζ). Then, applying again the OST to the multi-dimensional martingale (16), with ξ1 replacing Lqandβ+ζreplacing β, yields(35)E(∫0ξ1eαX(t)−(β+ζ)t1J(t)dt)=[E(eαX(ξ1)−(β+ζ)ξ11J(ξ1))−E(eαX(0)1J(0))](K(α)−(β+ζ)I)−1=(Ψ(β+ζ)U˜(α)−I)(K(α)−(β+ζ)I)−1.Substituting (35) returns(36)E(eαX(Tζ)−βTζ1{J(χ),ξ1>Tζ})=ζ(Ψ(β+ζ)U˜(α)−I)(K(α)−(β+ζ)I)−1.Substituting (34)–(36) in (33), taking the derivative of (33) with respect to α, then settingα=0leads to−E(∫0χe−βtI(t)dt).It remains to obtain the (|S1| × 1) vectorE[I(Tζ−)e−βTζ].First we derive the functionalE(eαX(Tζ−)−βTζ).Note that taking the derivation ofE(eαX(Tζ−)−βTζ)with respect to α and settingα=0leads to−E[I(Tζ−)e−βTζ].We start with the decomposition(37)E(eαX(Tζ)−βTζ)=E(eαX(Tζ)−βTζ1{ξ1<Tζ})+E(eαX(Tζ)−βTζ1{ξ1>Tζ}).Regarding the first term of (37) , the process hits level 0 before a clearing occurs. Thus, by applying the memoryless property of the exponential distribution, since ξ1 < Tζ, we obtainTζ=ξ1+T˜ζ,whereT˜ζis independent of Tζand has an exponential distribution with parameter ζ. Since at time ξ1 the process starts from 0,X(ξ1+T˜ζ)=X(T˜ζ)and we obtain(38)E(eαX(Tζ)−βTζ1{ξ1<Tζ})=E(eαX(ξ1+T˜ζ)−β(ξ1+T˜ζ)1{ξ1<Tζ})=E(e−βξ11{ξ1<Tζ})E(eαX(T˜ζ)−βT˜ζ)=Ψ(β+ζ)I¯E(eαX(Tζ)−βTζ).Regarding the second term of (37), multiplying (36) by e yields(39)E(eαX(Tζ)−βTζ1{ξ1>Tζ})=ζ(Ψ(β+ζ)U˜(α)−I)(K(α)−(β+ζ)I)−1e.Substituting (38) and (39) in (37) yieldsE(eαX(Tζ−)−βTζ).Remark 3Another way of obtaining C2(β) is to apply Eq. (7.1) of Kella et al. (2003, Section 7) as follows. IfY=(Y(t))t≥0is a measurable and nonnegative process, T is an exp (ζ) distributed random variable independent of Y, and Y(T) is measurable, thenE(Y(T))=ζE(∫0TY(t)dt).Thus,(40)E(eαX(Tζ)−βTζ)=ζE(∫0TζeαX(t)−βtdt).Note that the left-hand side of (40) determines C2(β) while the right-hand side determines C3(β).We consider the same data as in Example 1, withK=f=h=φ=1.Let ζ vary in {0.1, 0.25, 0.5, 0.75, 1, 1.5}. Note that since the cycle length is independent of R (see (26) ), the fixed cost C1(β) is also independent of R and a simple derivation shows thatC1(β)=Kζ/β.Figs. 8–10display the variable cost, the holding cost and the lost demand cost, respectively, as functions of R and ζ. Fig. 8 shows that C2(β) increases in R and ζ.Figs. 9 and 10 imply that the holding cost, C3(β), and the lost demand cost, C4(β), have the opposite behavior of the corresponding costs in Figs. 3 and 4 (probably due to the opposite impact of q and ζ on the cycle length, which increases in q but decreases in ζ). However, the behavior of the total cost, C(β), is more difficult to obtain since this cost is influenced by all cost factors.In this section we study the clearing ruleT^=min(Tq,Tζ).Thus, clearing takes place after an exponential time unless the level q is reached before. We start our treatment with derivation ofE(e−βT^).Write(41)E(e−βT^)=E(e−βTq1{Tq<Tζ})+E(e−βTζ1{Tζ<Tq}).Applying the exponential distribution returns the first right-hand term(42)E(e−βTq1{Tq<Tζ})=E(e−(β+ζ)Tq),whereE(e−(β+ζ)Tq)is given by (5) (withβ+ζreplacing β ).The second term of (41) is equal to(43)E(e−βTζ1{Tζ<Tq})=E(e−βTζ)−E(e−βTζ1{Tq<Tζ}).The (m × m) matrixE(e−βTζ)is given by (26) . Regarding the second term of (43), note that by the memoryless property of the distribution of Tζand given that Tq< Tζ, we can writeTζ=Tq+Tζ′,whereTζ′has an exponential distribution with ζ independent of Tqand yields(44)E(e−βTζ1{Tq<Tζ})=E(e−β(Tq+Tζ′)1{Tq<Tζ})=E(e−βTq1{Tq<Tζ})E(e−βTζ′),whereE(e−βTq1{Tq<Tζ})has already been derived in (42) andE(e−βTζ′)is given in (26). Substituting (43) and (44) in (41) leads toE(e−βT^).In this section, we derive the functionalu^T^(β)associated with C4(β).Claim 6.1The expected discounted lost demand is given by(45)u^T^(β)=(I−qΨ(β+ζ)I¯)−1qΨ(β+ζ)Ge.Similar to Claim 5.1 withT^replacing TζandqΨ(β+ζ)replacingΨ(β+ζ).Note that for ζ → 0, we obtain (8) , and for q → ∞, we haveqΨ(β+ζ)→Ψ(β+ζ),and thus we obtain (27).□To obtain C3(β) we need to derive the vectorh^T^(β)=E(∫0T^e−βtI(t)dt).Letθ=min(ξ1,T^)and writeh^T^(β)=E(∫0θe−βtI(t)dt)+E(∫θT^e−βtI(t)dt)=E(∫0θe−βtI(t)dt)+E(e−βξ11{ξ1<T^})h^T^(β).Applying(46)E(e−βξ11{ξ1<T^})=qΨ(β+ζ)I¯leads to(47)h^T^(β)=(I−qΨ(β+ζ)I¯)−1E(∫0θe−βtI(t)dt).The functionalE(∫0θe−βtI(t)dt)can be obtained by applying the OST to the multi-dimensional martingale (15) with the stopping time θ:(48)E(∫0θeαX(s)−βsds)=[E(eαX(θ)−βθ1J(θ))−E(eαX(0)1J(0))](K(α)−βI)−1e,where(49)E(eαX(θ)−βθ1J(θ))=E(eαX(ξ1)−βξ11{J(ξ1),θ=ξ1})+E(eαX(Tq)−βTq1{J(Tq),θ=Tq})+E(eαX(Tζ)−βTζ1{J(Tζ),θ=Tζ}).The first two terms of (49) can be easily obtained by(50)E(eαX(ξ1)−βξ11{J(ξ1),θ=ξ1})=qΨ(β+ζ)U˜(α)E(eαX(Tq)−βTq1{J(Tq),θ=Tq})=e−αq0f^11(0,q,β+ζ).In order to derive the last functional of (49), note that(51)E(eαX(Tζ)−βTζ1{J(Tζ),Tζ<min(Tq,ξ1)})=ζE(∫0min(Tq,ξ1)eαX(t)−(β+ζ)t1J(t)dt).Recalling thatLq=min(Tq,ξ1)(see (9)) and applying the OST to the stopping time Lqleads to(52)E(∫0LqeαX(t)−(β+ζ)t1J(t)dt)=[E(eαX(Lq)−(β+ζ)Lq1J(Lq))−E(eαX(0)1J(0))](K(α)−(β+ζ)I)−1.The functional (53) was determined in (16) (withβ+ζreplacing β) and is given by(53)E(eαX(Lq)−(β+ζ)Lq1J(Lq))=e−αq0f^11(0,q,β+ζ)+qΨ(β+ζ)U˜(α).Substituting (49)–(53) in (48) , taking the derivative with respect to α, and settingα=0leads to−E(∫0θe−βtI(t)dt).To end the derivation of the discounted case, we need to obtainE(e−βI(T^)I(T^)).As in the previous section, we obtain the (|S1| × 1) vectorE(eαX(T^)−βT^).We start with the decomposition(54)E(eαX(T^)−βT^)=E(eαX(Tq)−βTq1{Tq<Tζ})+E(eαX(Tζ)−βTζ1{Tq>Tζ}).Noting that the first term of (54) equalse−αqE(e−βTq1{Tq<Tζ})and applying (42) we arrive at(55)E(eαX(Tq)−βTq1{Tq<Tζ})=e−αqE(e−(β+ζ)Tq)e.For the second term of (54) and the time to hit level 0, ξ1, we obtain(56)E(eαX(Tζ)−βTζ1{Tζ<Tq})=E(eαX(Tζ)−βTζ1{Tζ<min(Tq,ξ1)})+E(eαX(Tζ)−βTζ1{ξ1<Tζ<Tq}).The first term of (56) is given by multiplying (51) by e (and the sequential equations (52) and (53)). For the second term of (56), applying the memoryless property of the exponential distribution and similar to the Tζpolicy results(57)E(eαX(Tζ)−βTζ1{ξ1<Tζ<Tq})=E(eαX(Tζ)−βTζ1{ξ1<T^,Tζ<Tq})=E(e−βξ11{ξ1<T^))E(eαX(Tζ)−βTζ1{Tζ<Tq})=qΨ(β+ζ)I¯E(eαX(Tζ)−βTζ1{Tζ<Tq}).Substituting (55)–(57) in (54) leads toE(eαX(T^)−βT^). Now, derivingE(eαX(T^)−βT^)with respect to α and settingα=0returns−E(e−βI(T^)I(T^)).Remark 4Regarding all the functionals, it is easy to see that for q → ∞, Tq→ ∞ and thus we obtain the Tζpolicy; for ζ → 0, Tζ→ ∞ and we obtain the Tqpolicy.We consider the same data as in Example 1. Let ζ vary in {0.1, 0.5, 1, 1.5, 2} and q vary in {1, 3, 5, 7}. We fixR=1andK=f=h=φ=1.Figs. 11–14display C1(β), C2(β), C3(β) and C4(β) as functions of ζ and q. We can see that the fixed clearing cost decreases in q and increases in ζ. Fig. 12 shows that C2(β) increases in ζ, particularly for high levels of q (when the Tζpolicy is dominant). Furthermore, it is easy to see that the behavior of C3(β) and C4(β) is a combination of the Tqpolicy (Figs. 3 and 4) and the Tζpolicy (Figs. 9 and 10). In addition, one can conclude that the major growth and reduction of the variable cost, the holding cost and the loss cost are applied for low values of ζ and high values of q.To learn about the behavior of C(β) we have carried out additional numerical checkings. Our observations show that the behavior of C(β) may be influenced mainly by h. For example, we take the basic values for the parametersζ=1,R=1,K=5,f=1andφ=1and let h vary in {0.1, 1, 5, 10, 20}. Fig. 15shows curves of C(β) as a function of q for various values of h. We see that C(β) decreases in q for low values of h and increases in q for high values. In addition, for relatively high values of h(h=5,10)we can obtain q* which minimizes C(β) (where q can be a controller’s decision variable).Furthermore, it would be interesting to study the case of a relatively high inventory cost under different policies. The following example compares Tζand min(Tq, Tζ) policies for such a case.Example 4We consider the same data as Example 1. Let ζ vary in {0.1, 0.25, 0.5, 0.75, 1} and q vary in {1, 2, 3, 4, 5, 6, 7}. We fix the parametersR=0.5,K=10,h=5,f=1,φ=1.The gray surface in Fig. 16presents C(β) under the Tζpolicy and the black surface represents the min(Tq, Tζ) policy. Due to the high inventory cost, the additional level q (under the min(Tq, Tζ) policy) leads to a reduced total cost, particularly for small ζ; thus, the min(Tq, Tζ) policy is preferred. For high ζ and q the surfaces coincide. (Note that in our observations, which are not presented here, for a relatively low h, the Tζpolicy performs better and thus is preferred.)In addition, for a fixed ζ, it would be worthwhile investigating the value of q* which minimizes C(β) in the case where q can be a controller’s decision variable. Table 1presents q*, C(β)* under the min(Tq, Tζ) policy compared to C(β) under the Tζpolicy, for several values of ζ and R (we limited our observations to the setq=1,2,…).Fig. 17shows curves of C(β)* and C(β) forζ=0.1,0.25,0.5(blue, red and black lines, respectively) as a function of R. For each ζ, we use a dashed line for C(β)* under the min(Tq, Tζ) policy and a solid line for C(β) under the Tζpolicy. A simple observation leads to some important conclusions:(1)The min (Tq, Tζ) policy performs better, particularly for low values of ζ and for high values of R (since high production rate and low ζ increase the inventory level and the holding cost).The value q* is nondecreasing in ζ and R.In this section we derive the long-run average costs for the min (Tq, Tζ) policy. As mentioned before, lettingζ⟶0leads to the Tqpolicy, and lettingq⟶∞returns the exponential policy.We retain the notations introduced in Section 1; regarding the time of kth clearing, Sk,k=1,2,ldots,let Jkbe the state of the process just after the kth clearing. (Jk, Sk) is a Markov semi-renewal process, and the content level process I(t) is a semi-regenerative process with respect to (Jk, Sk).Sk,k=1,2,…are the semi-regenerative points of the process. Thus, the processJk,k=1,2,…is an irreducible positive recurrent Markov chain with transition probability matrixP*and stationary probability vector π*.The long-run average costC¯can be derived from C(β) by a well-known procedure:C¯=limβ⟶0βC(β)=K+fπ*E(I(T^))+hπ*E(∫0T^I(u)du)+φπ*E(∑k=1NY(T^)Yk)E(T^).HereE(T^)denotes the average cycle length. We now have explicit formulas for all the components above:•The stationary probability vector is given byπ*=π*P*,π*e=1,where the (m × m) probability matrixP*is obtained by settingβ=0in (41).The average cleared amountE(I(T^))is obtained by substitutingβ=0in (54)–(57) and in all sequential equations.The average lost demand vector for one cycleE(∑k=1NY(T^)Yk)can also be obtained by substitutingβ=0inu^T^(β)(see (45)).The expected inventory levelE(∫0T^I(u)du)is obtained by settingβ=0in (47) and in all sequential equations. For Eq. (48) we would like to setα=0;however, this is not possible as K(α) is singular atα=0. Instead, we have to use (48) to conclude that(58)∂∂α[(E(eαX(θ)1J(θ))−E(eαX(0)1J(0)))K(α)−1e]⟶E(∫0T^X(t)dt)as α → 0 through values for which K(α) is non-singular. Relations (58) amount to applying L’Hôpital’s rule twice in order to determine the vectorsE(∫0T^X(t)dt).Finally, to complete our long-run average analysis, we have to deriveE(T^)=π*E¯(T^),whereE¯(T^)is the (m × 1) vector whose ith component is the expected cycle length given an initial phase i ∈ S1. This will be done in the next section.Regardingθ=min(ξ1,T^),we haveE¯(T^)=E(θ)+P(θ=ξ1)I¯E¯(T^).Substitutingα=β=0in (50) returnsP(θ=ξ1)=qΨ(ζ); thusE¯(T^)=(I−qΨ(ζ)I¯)−1E(θ).For E(θ) we apply the theory of MAP as introduced in Asmussen (2003, Section XI, pp. 312–313) (see also Barron, 2015). We use the notations of (13) and (14) and the method of Asmussen (2003, Section 2d, pp. 312–313), and Asmussen and Kella (2000). The matrix K(α) has a real eigenvalue k(α) with maximal real part among all eigenvalues (cf. chap. XI, p. 312 in Asmussen, 2003). The corresponding left and right eigenvectorsυαand hαmay be chosen with strictly positive components. Moreover, without loss of generality, it can be assumed thatυαhα=1and thatπhα=1,whereπ=υ0is the stationary distribution of J(t) and h0 is a column vector of 1’s. Let h′ be the derivative of hαatα=0.By Corollary 2.6 in Asmussen (2003, chap. XI, p. 313) we have, for any stopping time θ with Ei(θ) < ∞,(59)E(X(θ))=k′(0)E(θ)+hi′−E(hJ(θ)′).By Corollaries 2.7 and 2.8 of Asmussen (2003, chap. XI, p. 313),(60)k′(0)=−∑iπici+∑i≠jπiD1(i,j)E[Ui,j].To find the vector h′ we apply the same technique as in Asmussen and Kella (2000, p. 385). We start from(61)k(α)hα=K(α)hα.Take the derivative of (61) with respect to α and setα=0. Furthermore, usek(0)=0,h0=e,andK(0)=D0+D1. This yields(62)k′(0)e=(D0+D1)h′+K′(0)e.Note thatK′(0)=−C1+[D1(i,j)EUi,j]andπhα=1,so thatπh′=0.Subtractingeπh′=0from the two sides of (62) shows that(63)k′(0)e=(D0+D1−eπ)h′+K′(0)eh′=(D0+D1−eπ)−1[k′(0)I−K′(0)]e.Now we have to derive E(X(θ)) andE(hJ(θ)′)as follows.•Settingβ=0in (49) , taking the derivative with respect to α, settingα=0and multiplying by the vector e leads to the vector E(X(θ)).Settingβ=0,α=0in (49) yields E(1J(θ). Multiplying by the vector h′ returnsE(hJ(θ)′).SubstitutingE(X(θ)),E(hJ(θ)′),h′and k′(0) in (59) leads to E(θ) and hence toE¯(T^).We consider the same data as in Example 1. Let ζ vary in {0.1, 0.25, 0.5, 0.75, 1, 1.25, 1.5} and q vary in {1, 2, 3, 4, 5, 6}. Fig. 18displays the average cycle lengthE(T^). As expected,E(T^)increases in q and decreases in ζ. Note that the fixed cost for a clearing equalsK/E(T^);other costs (variable, holding and loss costs) show a similar behavior to the discounted case, and hence are omitted.Clearing policies form an important part of the inventory literature. In this paper we consider three control policies: (i) the Tqpolicy, in which the inventory is cleared whenever a pre-determined control limit q is reached; (ii) the Tζpolicy, in which the time between clearings is exponentially distributed with parameter ζ; and (iii) a combination of the above policies, the min (Tq, Tζ) policy, in which clearing takes place in exponential time unless the level q is reached before. These policies are applied for a MAP arrival process and demand sizes are i.i.d. phase-type distributed. The cost associated with this problem includes a fixed cost of a clearing, a variable cost for the cleared amount, a holding cost for the inventory, and a lost demand cost due to the reflection in level 0. By a simple probability approach and by applying exit-theory for fluid processes and martingales, explicit cost functionals for the expected discounted costs and for the long-run average costs were derived. These formulas are used for an analysis of the dependence of the cost functionals on the system parameters, for optimization purposes, and enable us to investigate the behavior of the system and study its properties.Numerical examples present the trade-off between the fixed and lost demand costs and the holding costs as a function of q and ζ (similarly to other classical inventory models, e.g., EOQ). In addition, one can conclude that the major growth and reduction of both the variable cost, the holding cost, and the loss cost are applied for small values of ζ and high values of q (clearly, the parameters q and ζ have an opposite impact on the cost functionals).The behavior of the total cost, C(β), is more difficult to determine since it is influenced by all the costs. In general, for a high clearing cost K, the Tqand Tζpolicies are preferred to the min (Tq, Tζ) policy (since the former policies have fewer clearings than the latter).For a relatively high holding cost h, a comparative study between the Tζpolicy and the min (Tq, Tζ) policy was considered and our observations reveal that the min (Tq, Tζ) policy performs better, particularly for low values of ζ and for high values of R (however, for high values of ζ, both policies perform equally well). Thus, it is worthwhile for the controller to determine the optimal q* (where q can be a controller’s decision variable) in order to reduce the total cost under the min (Tq, Tζ) policy. In addition, it was found that q*, which minimizes C(β) under the min (Tq, Tζ) policy, is nondecreasing in ζ and R.Finally, the average case was investigated, and it was shown that both the discounted and the average cost functionals show similar behavior.One can try to incorporate the idea of continuous review control policies with lead time with several possible extensions of the above model; the case of fixed or exponential lead time is probably very tractable. In addition, the inventory control during the lead time can be investigated. Another interesting and practical extension is to consider an ”all or none” demand policy, in which each demand can be either completely satisfied or completely unsatisfied depending on the content level present.

@&#CONCLUSIONS@&#
