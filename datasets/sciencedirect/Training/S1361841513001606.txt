@&#MAIN-TITLE@&#
Respiratory motion correction in dynamic MRI using robust data decomposition registration – Application to DCE-MRI

@&#HIGHLIGHTS@&#
A registration technique based on low rank – sparse data decomposition is introduced.Registration is applied to dynamic contrast enhanced MRI.Errors in the monitoring of enhancement in dynamic contrast enhanced MRI are reduced.

@&#KEYPHRASES@&#
Registration,Respiratory motion correction,Dynamic contrast-enhanced MRI,Robust principal component analysis,

@&#ABSTRACT@&#
Motion correction in Dynamic Contrast Enhanced (DCE-) MRI is challenging because rapid intensity changes can compromise common (intensity based) registration algorithms. In this study we introduce a novel registration technique based on robust principal component analysis (RPCA) to decompose a given time-series into a low rank and a sparse component. This allows robust separation of motion components that can be registered, from intensity variations that are left unchanged. This Robust Data Decomposition Registration (RDDR) is demonstrated on both simulated and a wide range of clinical data. Robustness to different types of motion and breathing choices during acquisition is demonstrated for a variety of imaged organs including liver, small bowel and prostate. The analysis of clinically relevant regions of interest showed both a decrease of error (15–62% reduction following registration) in tissue time–intensity curves and improved areas under the curve (AUC60) at early enhancement.

@&#INTRODUCTION@&#
Dynamic Contrast-Enhanced MRI (DCE-MRI) provides a morphologic and functional depiction of pathologies and is widely used as a biomarker in oncology (Jackson et al., 2007; Türkbey et al., 2010) and for various types of diseases (Bae et al., 2012; Ziech et al., 2012). Such a technique relies on the monitoring (uptake and washout) of a contrast agent – usually Gadolinium based – providing tumor delineation and assessment of tissue vascular properties (Knopp et al., 2003). DCE-MRI is usually achieved by performing fast gradient echo MRI sequences to obtain a set of T1-weighted image frames before, during, and after the administration of contrast agent. The contrast agent concentration over time can be derived from the MR images using an assumed relationship with pixel intensities. A pharmacokinetic model is then fit at every pixel to the concentration of Gadolinium as a function of time, resulting in kinetic parameters values that may be correlated with tissue characteristics (Tofts, 2010).In order to monitor contrast agent uptake and washout, acquisition times of the order of minutes are required. Hence patient motion (e.g. breathing, heartbeat and bowel peristalsis) during the acquisition can cause inter-frame misalignments. In extreme cases, the magnitude of motion due to breathing can be as large as 80mm (Plathow et al., 2004) along the superior–inferior axis in organs close to the diaphragm. These misalignments have a strong impact on the analysis of DCE-MR data since apparent intensity changes will be related to a mixture of motion and contrast agent changes, leading to a bias in the derived enhancement parameters and yielding incorrect information on tissue properties; in particular, motion during the contrast agent arrival phase can bias the estimation of pharmacokinetic parameters used to assess local tissue permeability.Several strategies including image registration methods have been developed to overcome the effect of motion and provide well aligned features across the images. Nevertheless developing an (intensity based) registration scheme specific to DCE-MRI data is challenging since changes due to motion and those corresponding to contrast enhancement must be differentiated. Conventional registration algorithms are likely to fail with DCE-MRI data as important local intensity changes across the different time-points can be interpreted as motion and produce a non-realistic expansion or contraction of the volume (Rohlfing et al., 2003; Tanner et al., 2007).The possibility of avoiding unphysical volume changes caused by local intensity variations due to contrast enhancement has been investigated in several studies. The multi-resolution fast free-form deformation (FFD) based on b-splines with normalized mutual information (NMI) as a similarity measure by Rueckert et al. (1999) has been used as a basis to address the problem of misalignments in DCE-MR time-series. In many cases a specific regularization term was introduced to limit non-realistic deformations (Tanner et al., 2000, 2007; Rohlfing et al., 2003). Zheng et al. (2010) developed a new method based on FFD in order to register breast images. In this approach a Lorentzian estimator is used as a similarity measure, combined with a reformulation of the energy function minimization using linear programming. Li et al. (2012) recently registered high temporal resolution free-breathing contrast enhanced images of the bowel. In this method a retrospective respiratory gating is applied to the data and the remaining images are sequentially registered using a transformation model based on a combination of discrete cosine transformation basis functions (Ashburner and Friston, 2003).Another class of methods dedicated to the problem of DCE-MRI registration are those that use a pharmacokinetic model to drive the registration processes. Hayton et al. developed a registration scheme that incorporates such a model and applied it to the analysis of breast images (Hayton et al., 1997). This relies on the assumption that the better the alignment between images in the time-series, the lower the residual difference between the model fit and the actual data. Therefore model fitting results can be used as a cost function for registration. Xiaohua et al. (2005) proposed simultaneous segmentation and registration using Markov random fields combined with a similar model. Buonaccorsi et al. (2007) introduced a method based on the modified Tofts model (Tofts, 1997, 2010). By iteratively fitting such a model to the unregistered data, a motion-free synthetic time-series based on the resulting pharmacokinetic parameters map can be created and used as a reference for rigid registration. More recently Bhushan et al. proposed a joint estimation of the deformation and contrast enhancement based on a Bayesian framework (Bhushan et al., 2011).As an alternative to registration, Filipovic et al. (2011) introduced a technique based on the generalized reconstruction by inversion of coupled systems (Odille et al., 2008) which uses extra physiological measurements (e.g. pneumatic respiratory belts) as a model and compensates motion in raw MR data.A further approach is to separate motion from contrast enhancement before registration. Melbourne at al. introduced an algorithm named progressive principal component registration (PPCR) that gradually removes misalignments (Melbourne et al., 2007, 2011). The method is based on the iterative use of principal component analysis (PCA) combined with a standard registration algorithm such as multi-resolution FFD (Modat et al., 2010). In PCA, contrast changes are assumed to appear in the more significant principal components and motion in the less significant. This is used to create a synthetic motion-free set of target images using a limited number of principal components that correspond to contrast enhancement. It has been utilized to register both liver and breast data acquired using repeat breath-hold protocols (Melbourne et al., 2007, 2011). However, the ability of PCA to disentangle motion from contrast enhancement depends on the nature of motion: for instance, the periodic motion of free breathing can appear in the more significant principal components along with contrast changes. More recently Wollny et al. investigated the use of independent component analysis to decompose data prior to registration in free breathing cardiac MRI (Wollny et al., 2012). In this case too, the objective is to remove motion elements to form a synthetic target time-series.In this study we introduce a novel registration approach specifically designed to address the problem of misalignments in DCE-MR time-series. Similar to (Melbourne et al., 2007; Wollny et al., 2012), our method is based on the assumption that motion can be separated from contrast enhancement, but here we chose Robust Principal Component Analysis (RPCA) for data decomposition (Candès et al., 2009). RPCA reformulates decomposition as an optimization problem to recover the sparse and low rank components of the input data. Our hypothesis is that RPCA coupled with a registration algorithm based on residual complexity minimization (Myronenko and Song, 2010) provides accurate registration of DCE time series in a broad range of organs and for various breathing protocols. Given the explicit separation of a sparse term, RPCA should allow more flexibility and a greater degree of robustness than regular PCA, and can potentially benefit DCE-MRI registration. Importantly, it is expected to have a particular impact at critical times such as the arrival of contrast agent bolus.Several frameworks aimed at decomposing a given matrix into low-rank and sparse components have emerged recently (Candès et al., 2009; Chandrasekaran et al., 2009; Yuan and Yang, 2019). Applications include background modeling in video surveillance and facial recognition as well as medical image processing (Trémoulhéac et al., 2012). Our application of Robust PCA (RPCA) decomposes a cine series into a low rank component (e.g. smooth and slowly varying changes affecting most of the field of view) and a sparse component (e.g. rapid and local intensity changes). For DCE-MRI, we attribute the sparse component to local contrast changes and motion to the low rank.Let M be a Casorati matrix with each column being formed from all the pixels of a 2D time-frame. RPCA splits such a matrix into a low rank component L and a sparse component S. This is achieved under the constraint that the sum of L and S must correspond exactly to the initial dataset M. It was shown that such a decomposition can be formulated as an optimization problem (Candès et al., 2009):(1)minimize‖L‖∗+λ‖S‖1subject toL+S=Mwhere ||·||∗ and ||·||1 respectively represent the nuclear norm (i.e. the sum of the matrix singular values) and the l1-norm (i.e. the sum of the absolute values of the matrix elements). The parameter λ appearing in (1) is a trade-off parameter: for high values all the information will appear in L while S will be empty, and vice-versa. The optimal setting of λ may depend on the application and the nature of the data. However, a suggested value independent of any knowledge of expected rank or sparsity was introduced in Candès et al. (2009):(2)λ0=1/max(Np,Nt)where Npand Ntrespectively represent the number of pixels in each frame and the number of time-frames in M. For practical images, this means:(3)λ0=1/NpThe information in DCE-MR time-series can be regarded as a combination of motion related changes, and local changes caused by contrast enhancement. We hypothesize that RPCA makes it possible to correct for low rank motion elements via registration without confounds from contrast agent induced changes of intensity as shown in Fig. 1.We consequently introduce a novel algorithm for DCE-MRI registration named Robust Data Decomposition Registration (RDDR). The process of RDDR can be described as follows: a given DCE time-series is reshaped as a (Npby Nt) Casorati matrix and decomposed using RPCA with a starting value λinit for the trade-off parameter (see Section 2.2.3). The time-frames from the resulting low-rank component are then registered. The resulting deformation fields are applied to the original time-series so that a part of the motion can be removed. The process is then repeated for increasing values of the trade-off parameter over a fixed number of iterations, independent of the number of time-points in the dataset. This process is summarized in Fig. 2. One should notice that deformation fields generated at each registration stage are not directly applied to images but added to a single global deformation field so that loss of information caused by multiple resampling is avoided.Since motion components and contrast changes cannot be perfectly separated with RPCA, an iterative approach is used. By using gradually increasing values of the trade-off parameter, it is possible to control the amount of motion included in the low-rank matrix.In principle, any non-rigid registration technique could be used to register the low-rank frames and update the deformation field in Fig. 2. However, the separation between motion and contrast is not perfect in the decomposition and part of the changes due to contrast are likely to remain in the low rank matrix (e.g. slow washout process in healthy tissue) especially for higher values of λ. To account for such effects we chose a registration algorithm that is robust to intensity changes (Myronenko and Song, 2010). The similarity metric it utilizes, named residual complexity (RC), incorporates an intensity correction field that brings the source and the target images into agreement in the intensity space. RC favors the transformation that leads to the minimum complexity of the residual difference image. This is achieved by measuring the sparseness of the residual in terms of the discrete cosine transform (DCT) basis functions. The transformation model used is the b-spline based FFD (Rueckert et al., 1999) with a gradient descent optimization scheme.Considering two (low-rank) time-frames Ltarget and Lsource to be registered with the unknown transformation TFFD, given the intensity correction field Icorr and the noise component η (both unknown). The following relationship can be written:(4)Itarget=Isource(TFFD)+Icorr+ηRegistration can be achieved by minimizing the following objective function, E:(5)E(Icorr,TFFD)=‖Itarget-Isource(TFFD)-Icorr‖2+β‖PIcorr‖2The operator ||·|| represents the Euclidean norm, and P and β respectively are the regularization operator and the regularization parameter. The form of P is chosen as the first order derivative regularizer. Icorr can be analytically solved, and the DCT basis function is chosen for eigen-decomposition leading to the final form of E. More details can be found in Myronenko and Song (2010).

@&#CONCLUSIONS@&#
