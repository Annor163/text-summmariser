@&#MAIN-TITLE@&#
Ultrasound image denoising using backward diffusion and framelet regularization

@&#HIGHLIGHTS@&#
We propose a new model of ultrasound image denoising using backward diffusion and framelet regularization.The fidelity term is deduced by using Maximum a Posteriori of the Rayleigh distribution of the noise.The introduction of framelet regularization can remove noise and preserve edges in multiscale framework.The Split Bregman algorithm is designed to simplify the minimization problem of the proposed model.

@&#KEYPHRASES@&#
Image denoising,Multiplicative noise,Backward diffusion,Framelet regularization,Ultrasound image,

@&#ABSTRACT@&#
This paper introduces a novel variational method for ultrasound image denoising for speckle suppression and edge enhancement. This method is designed to utilize the favorable denoising properties of framelet regularization and edge enhancement of backward diffusion technique. The sparsity and multiresolution properties of the framelet is well suited for speckle noise reduction. The fidelity term of the method can be obtained by Maximum a Posteriori (MAP). The introduction of backward diffusion and framelet regularization makes it difficult to solve the variational energy function. To simplify minimization problem, the Split Bregman algorithm for the proposed model is proposed and then we use it for ultrasound image denoising. Experiment results validate the usefulness of the proposed method for ultrasound image denoising.

@&#INTRODUCTION@&#
Ultrasound imaging is widely used in medical diagnosis because of its noninvasive, practically harmless to the human body. However, ultrasound images suffers from strong speckle noise because of the imaging principle. The speckle noise reduces the contrast of ultrasound image and blurs image details, thereby decreasing the reliability of the image and interfere with the diagnosis. Image processing methods especially image denoising method for speckle noise reduction have been proven useful for improving the quality and enhancing the diagnostic potential of ultrasound image.Various methods have been proposed for the speckle reduction of ultrasound images. The Nonlinear Coherent Diffusion (NCD) filter [1] is proposed by transforming the multiplicative speckle signals in ultrasound images into an additive Gaussian noise in Log-compressed images. Speckle reducing anisotropic diffusion (SRAD) method [2,3] is the extension of the PM diffusion model by casting the typical spatial adaptive filers into diffusion model. The diffusion coefficient is noise-dependent in every iteration step. Oriented SRAD (OSRAD) filter [4] is the extension of SRAD, it was proposed by analyzing the properties of the numerical scheme associated with SRAD filter using a semi-explicit scheme. OSRAD method is based on matrix anisotropic diffusion and can make the different diffusion across to the principal curvature directions. Methods using TV (Total Variation) [9] minimization scheme for ultrasound image denoising have been proposed in [5,6]. They use TV norm as the smoothing term. Rayleigh distribution is used as modeling the distribution of noise in ultrasound image [7,8]. Using the Rayleigh distribution metric, different methods [10–12] are proposed for ultrasound image denoising. TV norm used in these methods for edge preserving is conflicting with speckle removing because the noise is very large. That is to say the edges are blurred when noise is removed or edges are preserved but the noise is not well removed.Guo [26] proposed using nonlocal method for ultrasound image denoising. He modified the original nonlocal method by using MAP method of Rayleigh distribution. The performance is good but the computation efficiency is very low. Deka [27] use sparse coding method for speckle noise removal. The speckle noise removal scheme using the sparse representations over a learned overcomplete dictionary. The proposed model can be used effectively for the removal of speckle by combining an existing pre-processing stage before an adaptive dictionary could be learned for sparse representation. The results are good but the dictionary learning is also a time consuming work.Yue [13] used wavelet transform for aiding speckle reduction in ultrasound image. The method is designed to utilize the favorable denoising properties of two frequently used techniques: the sparsity and multiresolution properties of the wavelet, and the iterative edge enhancement feature of nonlinear diffusion. Based on the multiscale idea, we propose a novel variational method for ultrasound image denoising for speckle suppression and edge enhancement. Our proposed method is designed to utilize the favorable denoising properties of framelet regularization and edge enhancement of backward diffusion techniques. The sparsity and multiresolution properties of the framelet is well suited for speckle noise reduction. The fidelity term of the method can be obtained by MAP.In recent years, framelet based restoration [14–17] has achieved great success for its robustness and stableness. The framelet transform is assumed the sparse representation of the natural images. And the framelet transform has the ability of multiresolution analysis. It can remove noise and preserve edges in multiscale framework. So different kind of edges can be preserved by framelet regularization. It is noted, that the framelet based approaches solve image restoration problems in digital domain directly and many associated efficient algorithms which utilize the multilevel nature of wavelet frame transforms are developed to achieve better sparse approximation of the underlying solutions [16,17]. Framelet regularization is used in many applications [18–20] and also used with other regularization such as TV term. More details about discrete algorithms of framelet transforms can be found in [16].The introduction of backward diffusion and framelet regularization of our method makes variational energy function is difficult to solve. To simplify minimization problem, the Split Bregman algorithm for the proposed model is proposed and then we use it for ultrasound image denoising. The Split Bregman is widely used in variational energy function solving. The Bregman distance is introduced into variational model by Osher [21], it can enhance the quality of image diffusion for classical TV model. This algorithm improved the quality of solutions in terms of edge preservation, and reduced the influence of penalty parameter in the diffusion process. The method is still complex for implementation due to the complex difference operation. Wang [22] proposed split method for the classical TV model by the introduction of auxiliary variable which is equivalent to image intensity gradient. The method can change the complex difference operation into an alternating iterative process by simple divergence operation and shrinkage operator of soft threshold formula. Goldstein [23] proposed the Split Bregman method of ROF model by combining split algorithm [22] and Bregman iteration [21], which was easy to implement, and had a high computational efficiency. Cai [16] designed the Split Bregman methods of framelet regularization for image restoration, we also extend the Split Bregman to our proposed method.The organization of this paper goes as follows. In Section 2, we will introduce the backward diffusion method briefly and then proposed the new ultrasound image denoising method with backward diffusion and framelet regularization. The Split Bregman method for the proposed model is also designed in Section 2. Then some numerical examples on some synthetic and real images are shown in Section 3. Section 4 is the concluding remarks.The generalized TV model is depicted as (1), it is also called nonlinear diffusion.(1)E(u)=12∫Ω(u−f)2dxdy+λ∫Ω|∇u|pdxdywhere f is the noisy image, u is the clear image and λ is the balance parameter control the diffusion degree.If p=1, the model is called the TV model and it has the ability of edge preserving, and if p=2, the model is called Tikhonov mode and it has the ability of edge diffusion. If 0<p<1, the model is called backward diffusion model, it has the ability of enhancement for the edges. When p>1, the model has the ability with edge reduced. In Fig. 1, we compare the diffusion effects of generalized TV model with p=0.8, p=1, p=2 respectively. Fig. 1 shows the different metric of generalized TV model with different value of p. From the experiment we can see that when 0<p<1, the edges are enhanced with noise removing, when p>1, the edges are blurred. When p=1, the model is the TV model, and the edges are preserved.The noise in different images can be divided into additive noise and multiplicative noise. The model of additive noise is:(2)f=u+ηAnd the model of multiplicative noise is(3)f=uηwhere f is the noisy image, u is the clear image and η is the noise. The probability density function of η for ultrasound image is given by the following Rayleigh distribution:(4)p(f|u)=fuσ2exp−f22u2σ2(η≥0)where σ is a parameter indicating the intensity of the noise.In the Bayesian framework, we will get framelet based prior and lpbased prior as:(5)p(u)∝exp(−λ1|Wu|)andp(u)∝exp(−λ2|∇u|p)where W denotes the framelet transform, λ1 and λ2 are the positive parameters. According Bayes formula, the a posteriori density is p(u|f)∝p(f|u)p(u), so the maximum a posterior estimation can be transformed to minimize the function(6)E(u)=∫Ω12fu2+logudxdy+λ1∫Ω∇updxdy+λ2∫ΩWudxdyThe fidelity is same as Denis [10] because they are all deduced by MAP method. The second term is the backward diffusion term which has the ability for edge enhancement. The third term is the framelet regularization which has the ability of large noise removal and detail preservation due to the multiscale implementation and sparse representation. The backward diffusion term and framelet regularization are not new functions, here, we incorporate them into our model because of their advantages in image diffusion.Direct calculating the Euler–Lagrange equation of the above equation is a hard work because of the lpnorm and framelet transform. So, we use the Split Bregman method for assisting the equation solving.We introducing several auxiliary variables d1=(d11, d12)T, d2=(d21, d22)Tand Bregman iteration parameters b1=(b11, b12)T, b2=(b21, b22)T. When the following energy function gets its minimization, we will get d1≈∇u, d2≈Wu.The Split Bregman method of Eq. (6) is:(7)E(u,d1,d2)=∫Ω12fu2+logudxdy+λ1∫Ω|d1|pdxdy+λ2∫Ω|d2|dxdy+12θ1∫Ω(d1−∇u−b1k+1)2dxdy+12θ2∫Ω(d2−Wu−b2k+1)2dxdywhereb1k+1=b1k+∇uk−d1kandb2k+1=b2k+Wuk−d2k.To solving the u, d1, d2, we use alternating iteration method.Fixing d1, d2, for solving u, the energy function about u is:(8)E(u)=∫Ω12fu2+logudxdy+12θ1∫Ω(d1−∇u−b1k+1)2dxdy+12θ2∫Ω(d2−Wu−b2k+1)2dxdyFixing d2 and u for solving d1, the energy function about d1 is:(9)E(d1)=λ1∫Ω|d1|pdxdy+12θ1∫Ω(d1−∇u−b1k+1)2dxdyFixing d1 and u for solving d2, the energy function about d2 is:(10)E(d2)=λ2∫Ω|d2|dxdy+12θ2∫Ω(d2−Wu−b2k+1)2dxdyWith variational method, the corresponding Euler–Lagrange equation of Eq. (8) is(11)1uk−f2(uk)3−1θ1∇⋅(∇uk+1+b1⇀k−d1⇀k)−1θ2WT(Wuk+1+b2⇀k−d2⇀k)=0Because WTW=I, so we will get:(12)uk+1=1(1/θ2)−(4/θ1)1uk−f2(uk)3−1θ1(uNk+1+usk+1+uEK=1+uWk+1+∇⋅b1⇀k−∇⋅d1⇀k)−1θ2WT(b2⇀k−d2⇀k)The corresponding Euler–Lagrange equation of Eqs. (9) and (10) are:(13)d1k+1=∇uk+1+b1k+1−θ1d1k+1d1k+1(14)d2k+1=Wuk+1+b2k+1−θ2d2k+1d2k+1Using generalized shrinkage formula [24] we will get:(15)d1k+1=max(|∇uk+1+b1k+1|−θ1,0)d1k+1d1k+1(16)d2k+1=max(|Wuk+1+b2k+1|−θ2,0)d2k+1d2k+1Algorithm 1 outlines our whole procedure.Algorithm 1Overall algorithm1. Initialization:d10=d20=b10=b20=0, u0=f;2. Iterations:Updateb1k+1=b1k+∇uk−d1kandb2k+1=b2k+Wuk−d2kUpdate uk+1 using (12)Updated1k+1=max(|∇uk+1+b1k+1|−θ1,0)d1k+1d1k+1Updated2k+1=max(|Wuk+1+b2k+1|−θ2,0)d2k+1d2k+13. Stopping criterion: stop ifmax(uk+1−uk)≤εUsing Algorithm 1, we will get the results of denoised ultrasound image.To verify the effectiveness of our new method, we compare our method to the state-of-the-art ultrasound noise removing algorithms [2,25]. VO [25] is a model of image decomposition and the author also uses it for ultrasound image denoising. First, we use two synthetic images polluted by multiplicative noise with Rayleigh distribution. In judging the performance of a speckle noise suppression technique, many aspects can be evaluated such as the ability to retain small details, retaining edges and gradual changes in gray level. For synthetic images, we use peak signal to noise ratio (PSNR) as the evaluation.Figs. 1 and 2are the experimental results applied to two different synthetic images polluted by multiplicative noise with Rayleigh distribution using different methods. The variance of the two images are 0.8 and 0.9 respectively. The noise is very dense which is similar with the real ultrasound images. Results using SRAD are not satisfactory. The edges in the results using VO model is blurred. The edges using our method without backward diffusion are clearer than VO model because the framelet regularization is more adaptive than TV regularization because its multiscale implementation. From the experiments, we can find that our proposed method get good results. Edges are well preserved and noise is well removed. Our method can higher PSNR values and good visual appearance than the methods we compared.We also compare our method with other methods on real cases. Figs. 3–6are the experimental results applied to different ultrasound images using different methods. The results of SRAD demonstrate that they are not very effective in removing the multiplicative speckle noise at this noise level. The results of using VO model are also not good in noise suppression. We list the speckle noise suppression results using framelet without backward diffusion for comparison with the whole method. The framelet can remove large noise because it is multiscale implementation and sparse representation but the edges are not well preserved. By incorporating backward diffusion, we can see that the edges are enhanced. The backward diffusion also has the ability of noise removal, so incorporation of backward our method can enhance the edges and remove noise very well.From visual comparison, we can see that our proposed method gets smooth effect while preserving the edges of organs. The useful information is maintained.

@&#CONCLUSIONS@&#
