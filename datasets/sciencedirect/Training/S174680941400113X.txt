@&#MAIN-TITLE@&#
Optimization of EMG-based hand gesture recognition: Supervised vs. unsupervised data preprocessing on healthy subjects and transradial amputees

@&#HIGHLIGHTS@&#
An optimization study on EMG-based hand gesture recognition is proposed.We compare unsupervised PCA vs. supervised CSP preprocessing technique.Artificial neural network achieves best classification accuracies in both cases.The study identifies the best parameters to choose in pattern recognition stages.The optimization algorithm is robust enough to be used on amputees as well.

@&#KEYPHRASES@&#
sEMG,Principal component analysis,Common spatial pattern,Classification,Amputees,

@&#ABSTRACT@&#
We propose a methodological study for the optimization of surface EMG (sEMG)-based hand gesture classification, effective to implement a human–computer interaction device for both healthy subjects and transradial amputees. The widely commonly used unsupervised Principal Component Analysis (PCA) approach was compared to the promising supervised common spatial pattern (CSP) methodology to identify the best classification strategy and the related tuning parameters. A low density array of sEMG sensors was built to record the muscular activity of the forearm and classify five different hand gestures. Twenty healthy subjects were recruited to compute optimized parameters for (“within” analysis) and to compare between (“between” analysis) the two strategies. The system was also tested on a transradial amputee subject, in order to assess the robustness of the optimization in recognizing disabled users’ gestures.Results show that RMS-WA/ANN is the best feature vector/classifier pair for the PCA approach (accuracy 88.81±6.58%), whereas M-RMS-WA/ANN is the best pair for the CSP methodology (accuracy of 89.35±6.16%). Statistical analysis on classification results shows no significant differences between the two strategies. Moreover we found out that the optimization computed for healthy subjects was proven to be sufficiently robust to be used on the amputee subject. This motivates further investigation of the proposed methodology on a larger sample of amputees. Our results are useful to boost EMG-based hand gesture recognition and constitute a step toward the definition of an efficient EMG-controlled system for amputees.

@&#INTRODUCTION@&#
Surface electromyography (sEMG) is a non-invasive technique for measuring and evaluating the electrical activity of skeletal muscles. By recording EMG signals on forearms’ muscles, it is possible to reconstruct different hand gestures [1]. Thanks to its non-invasiveness and ease in acquisition, sEMG signals can be exploited by many human–computer interaction (HCI) devices as input to control a prosthesis [2] or a virtual device [3], either for interactive or clinical/rehabilitative purposes [4,5]. The development of such HCI systems can address the needs of transradial amputees, who could greatly benefit from the resulting augmentation of stump functionalities.Standard EMG-controlled devices are usually based on the evaluation of thresholds signal amplitude, merely using two sensors. Therefore, they can perform very simple movements (e.g. hand opening and closing) with restricted usability and poor adaptability to different contexts [6]. Multiple/arrays of sensors can be used [7] to avoid this kind of limitations but the increased number of channels leads to an increase in data dimensionality and complexity. To deal with such complexity, more sophisticated EMG signal analysis techniques are needed, and pattern recognition methods [8] can help recognize executed hand gestures within a set of predefined movements.Several researches have investigated the potentiality of EMG pattern recognition techniques in prosthesis control [9,10], rehabilitation [11] and clinical practice [12], employing high density sEMG configuration. Given the practical constraint of placing a large amount of electrodes onto a small surface [13], in particular for daily/routine applications, studies involving pattern recognition techniques on low density sEMG configurations were proposed [13–15], with the aim to realize an efficient sEMG-controlled device.In general, a pattern recognition-based system consists of preprocessing, feature extraction and classification. In the preprocessing stage, in addition to the application of simple analog or digital filters, data dimensionality reduction techniques, e.g. Principal Component Analysis (PCA) [16], or signal-to-noise ratio improving techniques, e.g. Common Spatial Patterns (CSP) [14], are implemented. The feature extraction stage consists in the calculation of a vector of signals descriptive characteristics (features), namely feature vector; EMG data features are typically computed in time, frequency and/or time-frequency domain (see [17] for a review). Concerning the classification phase, linear/non-linear algorithms (classifiers) assign the extracted features to the class (gesture) they most probably belong to. Different classifiers have been proposed in literature (see [8] for a review), including Euclidean Distance, Logic Regression, k-Nearest Neighbors (kNN), Hidden Markov Model (HMM), artificial neural network (ANN), support vector machine (SVM), linear discriminant analysis (LDA).Identifying the best choice and the related tuning parameters for the three above-mentioned stages still remains the main challenge: here we present a methodological offline study that compares a supervised CSP with an unsupervised PCA data preprocessing technique to optimize sEMG-based hand gestures classification. Out of the wide variety of preprocessing EMG classification techniques being investigated [18–20], we chose to analyze PCA, the widely commonly used technique, and CSP, which has shown interesting potentialities in EMG pattern recognition [14]. We investigated the performances of the two approaches by using 32 combinations of features (feature vectors) and 3 different classifiers: linear discriminant analysis (LDA, linear classifier), support vector machines (SVM, non-linear kernel classifier) and artificial neural networks (ANN, non-linear classifier). EMG signals were acquired by means of a low-density sEMG-based device designed for the recognition of hand gestures [21]. Twenty able-bodied (healthy) subjects were recruited to identify (“within” analysis) and compare (“between” analysis) the optimal PCA and CSP pattern recognition parameters (best feature vector/classifier pair). Non-parametric statistical tests, i.e. Friedman and Wilcoxon signed-rank tests, were used to detect any statistically significant differences in the performances.Furthermore, intended hand gestures from a transradial amputee subject have been classified to evaluate the robustness of the optimization algorithm toward amputees’ anatomy modifications. As a matter of fact, during surgical intervention, amputees’ residual muscles and tendons are directly sutured to the bone with a procedure called myodesis [22], causing changes in muscle shape and length.This study provides information on the optimization of system performances for the online implementation of EMG-controlled devices based on pattern recognition, such as HCI devices, for both healthy subjects and transradial amputees. Our results can be also exploited by different EMG signal classification studies for medical and engineering applications, where it is crucial to identify the best parameters for the tuning of preprocessing, feature extraction and classification stages.Testers were twenty able-bodied subjects, ten males and ten females, free of known muscular and/or neurological diseases, 31.5±10.3 years aged. The transradial amputee subject was a 25 years old male, traumatically injured at the age of 18 in the dominant right hand, 11cm below the elbow.Each subject gave informed consent before performing experiments. For healthy subjects, data were recorded from the dominant forearm; to determine handedness, each subject was asked for his/her hand preference in most of the daily activities. Eighteen subjects resulted dominant in right hand, two in left hand.Six commercial active sEMG sensors (Ottobock 13E200=50) were placed on the subjects’ forearm using an ad-hoc silicone support bracelet, as shown in Fig. 1a–d. Sensors were placed equally spaced in the bracelet (Fig. 1a), so that sensor no.1 acquired signals from the flexor carpi-radialis muscle (Fig. 1b) and sensor no. 6 from the brachio-radialis muscle (Fig. 1c). The bracelet was placed around the forearm, 5cm below the elbow (Fig. 1d). The same procedure was followed to place the support bracelet around the amputee subject's stump, as shown in Fig. 2.This configuration was chosen to simulate the typical positioning of the prosthesis’ sensors on amputees’ forearms. In order to best fit the different forearm diameters, the relative distance between sensors was changed, keeping equal spacing, according to the subjects.Sensors operated in 0÷5V, bandwidth of 90÷450Hz and Common-Mode Rejection Ratio (CMRR) >100dB. Data were collected using a purpose-built acquisition system (12 bits A/D converter, 1kHz sampling frequency) and transmitted to the PC via USB.The subjects were sitting in front of a monitor and were asked to perform the following gestures (see Fig. 3):(1)Rest: hand relaxed.Fist: hand with all fingers closed.Pinch: hand with thumb and finger touching as if picking a small object.Spread: hand open and stretched.Pointing: hand with all fingers closed with the index pointing.Each gesture was randomly repeated 10 times and recorded for 2s. We empirically determined the best gesture duration by means of preliminary studies. Since steady-state sEMG signal are more robust than transient signal for classification purposes [19,23], transitions between gestures were not recorded.Each single gesture registration generates a [L×N] matrix, where L=2000 (2s registration length, sampling rate 1kHz) and N=6 (number of sensors) samples. Therefore, as the 5 gestures were repeated 10 times, a [10×5×L×N] dataset matrix (from now on, we refer to it as “data”) was collected for each subject. An example of raw data acquired on a whole registration session is shown in Fig. 4.Two different preprocessing techniques were implemented: PCA, to reduce dimensionality of the feature vector after the feature extraction stage; CSP, to maximize the differences in classes (gestures) variance before the feature extraction stage. Fig. 5shows the mainly differences between the two approaches.We implemented a 5-folds cross-validation. Each subject's data was randomly partitioned into 5 equal size subsets before the preprocessing stage: 4 subsets (train, [8×5×L×N] matrix) were used to compute PCA/CSP preprocessing matrix and to train the classifiers and 1 subset (test, [2×5×L×N] matrix) was used to test the classifiers. This procedure was repeated until each possible subset was used for test the classifiers.Data was segmented using the overlapped windowing technique [23], windows length equal to 300ms, 75ms of delay between two successive (overlapped) windows. This timing was chosen in order to fulfill the requirements of real-time applications, e.g. control of prosthesis or virtual avatars. Features were extracted from each time window, in particular, by indicating with xithe ith time sample in a window and by W the total length of the window (in samples), the following time-domain features were extracted:•Mean (M): it is defined in Eq. (1) and represents the average value of the EMG amplitude:(1)M=1W∑i=1WxiRoot mean square (RMS): it is defined in Eq. (2) and represents the mean power of the signal:(2)RMS=1W∑i=1Wxi2Willison amplitude (WA): it is defined in Eq. (3) and represents the number of counts for each change in the EMG signal amplitude that exceeds a predefined threshold, set to avoid background noise-induced counts. It is related to the level of muscle contraction.(3)WA=1W∑i=1W−1f(|xi−xi+1|)f(x)=1,x≥threshold0,otherwiseThe threshold value (respectively 1.22mV on PCA and 2.44mV on CSP preprocessing technique) was set after preliminary studies.Slope sign change (SSC): it is defined in Eq. (4) and represents the number of times the slope of the EMG signal changes sign:(4)SSC=1W∑i=2W−1f[(xi−xi−1)×(xi−xi+1)]f(x)=1,x≥threshold0,otherwiseThe threshold leading to the highest performance on both preprocessing techniques was 2.44mV.Simple square integral (SSI): it is defined in Eq. (5) and represents, similarly to energy in continuous-time signal, the area under the curve of the squared signal:(5)SSI=∑i=1Wxi2Variance (V): it is defined in Eq. (6) and represents a statistical measure of how signal varies from its average value (Mean, as defined in Eq. (1)) during the observation:(6)V=1W−1∑i=1W(xi−M)2Waveform length (WL): it is defined in Eq. (7) and represents cumulative length of the EMG signal waveform. WL is a measure of EMG signal complexity:(7)WL=∑i=1W−1|xi+1−xi|Several dimensions of the feature vector were tested, single and combinations of two and three different features above reported. A total of 32 different configurations were thus analyzed. Cross-gesture windows (windows that included data from different gestures) were discarded.PCA is a multivariate statistics algorithm which implements a data orthogonal transformation. Data is projected using the eigenvectors of the covariance matrix, achieving a new dataset where variables are linearly uncorrelated; new variables are called Principal Components (PCs). PCA is an unsupervised dimensionality reduction, as it does not make use of class information (labels) [18].In this study we implemented a PCA preprocessing stage by partitioning raw EMG data in train and test subset, as previously described. Feature extraction stage outputted an [1050×N×F] matrix for train subset (F number of features extracted; F=1 single mode, F=2 combination of two, F=3 combination of three), and a [250×N×F] matrix for test subset (since we have 300ms-long windows, overlapped by 75ms, after feature extraction we obtain a matrix with [1+(8×5×L−300)/75]=1050 rows for the train subset and a matrix with [1+(2×5×L−300)/75]=250 rows for the testing subset).After the feature extraction, PCA was applied to the train subset to compute principal component coefficients (loadings) and to reduce column dimensionality from N×F to the value R<N×F. Dimensionality of test subset was therefore reduced multiplying it by the first R loadings. R was chosen to achieve a cumulative variance greater than 90%.CSP is a supervised algorithm to implement spatial filters that maximize variance of a single class while minimizing variance of remaining class [24] by projecting data into a subspace. Such a technique was successfully employed in classification of motor imaginary EEG data within an EEG-based brain computer interface (BCI) [25]; only in recent years, potentiality of CSP to improve the accuracy and information rate of EMG data was explored [14]. To apply CSP in such contexts, algorithm must be extended to multiclass problems, i.e. combining 2-class filters in a one-vs-rest approach [24]; in such a technique, i-th spatial filter is computed to maximize the variance of the i-th class while, at the same time, it minimizes the average of variances of the remaining classes. Formally we can express such a spatial filter as:(8)vi=argmaxviviTΣiviviT∑j≠iΣjviSolution to Eq. (8) can be found by computing the generalized eigenvalue problem, defined in Eq. (9) for each i-th class, retaining only the filter with the highest eigenvalue, which is the one with highest variance:(9)ΣiV=λ∑j≠iΣjVIn this study we implemented a CSP preprocessing stage by partitioning data into train and test subsets, in the same way done for PCA technique. CSP was applied to train subset to compute a matrix of spatial filters, S, of [C×N] dimensions (C number of classes/gestures to be classified). Both train and test subsets were pre-multiplied by S, so the differences in variance between classes were maximized. Both subsets were changed their original dimensionality, respectively to [8×5×L×C] and [2×5×L×C].Features were extracted from both CSP-filtered subsets, obtaining an [1050×C×F] output matrix for train subset, and a [250×C×F] matrix for test subset (F number of features extracted; F=1 single mode, F=2 combination of two, F=3 combination of three).Three different classifiers, namely LDA, SVM and ANN were tested. Classifier performances were assessed by averaging the accuracies of each time window (note that in online applications, performances are usually computed with a majority voting strategy on consecutive time windows [20]).LDA computes several hyperplanes (k-class problem, k>2) which linearly separate data into the different classes [26]. In order to prevent errors due to bad estimation of covariance matrices (bias), a shrinkage regularization was implemented [27].SVM computes several hyperplanes (k-class problem, k>2) using Tikhonov regularization to classify data such that minimizing the classification error and, at the same time, maximizing the geometric margins (distances from the nearest training sample). In this study we implemented a non-linear SVM with Gaussian Radial Basis-based kernel [28].ANN is a non-linear classifier simulating brain information processing through a series of weighted nodes, called neurons. Neurons are organized in layers and interconnected with each other to create a network. We implemented an artificial neural network with 10 neurons in the hidden layer, 5 neurons in the output layer and trained the network with scaled conjugate gradient back-propagation algorithm. 15% of the training dataset (namely “validation dataset”) was randomly selected and automatically used to validate network configuration, in order to generalize properties and avoid overfitting [29]. Taking into account that network performance is highly depending on the training samples and configuration chosen, the network was optimized by repeating the training stage until validation dataset did not achieve a classification accuracy higher than 90%.The preprocessing techniques were tested with all the 32 different feature extraction modalities and the 3 classifiers. Results for a single subject consisted therefore of two [32×3] matrices. Value in the i-th row/j-th column was the average classification accuracy rate of the i-th feature vector obtained with the j-th classifier after the 5 folds cross-validation.For both techniques, each feature vector was assigned a final score; the i-th feature vector final score was computed by averaging its classification accuracy. Since we had 3 classifiers and 20 healthy subjects, final score FSiis defined by Eq. (10). We chose the best feature vector FV by means of Eq. (11):(10)FSi=13×20∑k=120∑j=13xijk(11)maxiFSi→FVWithin analysis to identify the best feature vector/classifier pair was applied to a [20×3] matrix, rows being healthy subjects and columns being the three FV/classifiers accuracies. A Friedman test, non-parametric equivalent to the repeated measures ANOVA test (see [30] for insights), was implemented to find statistically significant differences in classifiers performances. Chi-squared and p-values were computed, setting a threshold of 5% for the accepted error. When null hypothesis was rejected (p<0.05), a Tukey's HSD post hoc analysis was executed.Between analysis to identify best preprocessing technique was then applied to a [20×2] matrix, rows being healthy subjects and columns being the classification accuracies related to the best PCA and CSP feature vector/classifier pair. A Wilcoxon signed-rank test, non-parametric equivalent to the paired Student's t-test, was executed to detect differences in the two approaches. Z-score and p-values were computed, setting a threshold of 5% for the accepted error.Performances achieved by the transradial amputee subject with the 32 different feature extraction modalities and the 3 classifiers were compared with the results obtained by the healthy subjects. For both preprocessing techniques, we performed a direct comparison between the maximum amputee's classification performance and the accuracy obtained using the best healthy subjects’ feature vector-classifier pair (optimized parameters).

@&#CONCLUSIONS@&#
We realized a system capable to discriminate five different hand gestures, using a low density sEMG sensors setup placed on subjects’ forearms. Such a device could be used as input to pilot a real hand prosthesis [2], a virtual avatar [3] and for clinical/rehabilitative purposes [4] on healthy subjects, as well as on transradial upper-limb amputees, who currently utilize EMG-controlled devices to partially substitute missing arm functionalities. In order to improve the performances of the proposed setup and to explore new possibilities related to EMG classification problems, we evaluated two separate approaches to preprocess and classify EMG data. Unsupervised PCA preprocessing technique is the widely commonly used preprocessing algorithm to reduce raw EMG signals data dimensionality after the feature extraction phase [16], whereas supervised CSP preprocessing technique is a preprocessing technique successfully applied with EEG-based BCI, also showing interesting potentialities for EMG pattern recognition [14,24]. By analyzing the classification accuracy achieved with these two modalities, we obtained precious information for tuning all the pattern recognition parameters and also provided recommendations for further studies on EMG data.Two levels of analysis were performed: a within analysis, to discover the best settings for each preprocessing techniques (best feature vector-classifier pair) and a between analysis, in order to find out benefits and drawbacks in using one technique rather than the another.Concerning the within analysis, on healthy subjects we found out that the PCA technique obtained the best results with the RMS-WA feature vector and an ANN classifier (average classification accuracy of 87.34±7.3%, statistically significant higher than those obtained with SVM or LDA). Instead, the CSP strategy achieved the best performance when we fed an ANN classifier with an M-RMS-WA feature vector (average classification accuracy of 86.62±7.34%, statistically significant higher than those obtained with SVM or LDA). In both cases, ANN turned out to be the best choice to classify EMG data.Considering the between analysis, we did not find any statistically significant difference in classification accuracy between the two preprocessing techniques, so we concluded that the two implemented approaches can be both used in EMG pattern recognition with equivalent performances.Furthermore, we tested the tuned pattern recognition strategies on a transradial amputee subject, to evaluate their robustness on the detection of the amputees’ hand gestures. Using the same parameters which best performed on healthy subjects, the system achieved the maximum classification accuracy on with CSP, and an accuracy 0.95% lower (with respect to the PCA maximum classification rate) on with PCA preprocessing technique. This indicates that the parameters tuned with healthy subjects’ data are sufficiently robust to be used for the design of EMG-based devices for transradial amputees. Moreover, the amputee's classification accuracies (PCA: 92.04%; CSP: 93.4%) suggest that, despite of the amputation and all the changes in muscles shape and length, we succeeded in recognizing amputee's gestures, achieving an accuracy comprised within the healthy subjects’ average accuracy range (PCA: 88.81±6.58%; CSP: 89.35±6.16%).It is important to notice that the accuracies of the system obtained in this study are underestimated with respect to real-time applications, since they are relative to an offline classification performed with 75ms overlapped windows. Since a real-time (online) system requires only one classification output per 300ms, it is possible to adopt additional postprocessing algorithms to further improve the accuracy, e.g. a majority voting strategy [20].This study proposes a robust optimization for sEMG-based hand gestures classification on healthy subjects, and represents a step toward the implementation of a HCI device for transradial amputees. The robustness of our algorithm will be further investigated including a larger sample of transradial amputees. Definitively this study will serve as a reference for future EMG classification studies and for the design and implementation of sEMG-controlled related devices.The authors state that they have no conflict of interest.