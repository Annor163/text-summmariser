@&#MAIN-TITLE@&#
A comparative numerical study of different finite element formulations for 2D model elliptic problems: Continuous and discontinuous Galerkin, mixed and hybrid methods

@&#HIGHLIGHTS@&#
Different finite element formulations for Poisson problems are implemented and compared.The methods are applied to two model problems.The first problem has smooth solution and the second one presents a square root singularity.For the problem with a smooth solution, the results confirm convergence orders.For the singular problem, hp adapted meshes tuned to the singularity are created.

@&#KEYPHRASES@&#
Finite elements,Discontinuous Galerkin,H,(,div,),spaces,Hybrid method,hp refinements,Quarter-point elements,Elliptic singular problem,

@&#ABSTRACT@&#
In this work, different finite element formulations for elliptic problems are implemented and compared, in terms of accuracy versus number of required degrees of freedom. The implemented formulations are: (a) the classical H1 weak formulation (continuous); (b) the non-symmetric discontinuous Galerkin formulation by Baumann, Oden and Babuska; (c) a mixed discontinuous Galerkin formulation, known as Local Discontinuous Galerkin (LDG); (d) a mixedH(div)-conforming formulation; (e) a primal hybrid formulation. In order to compare the methods, two 2-dimensional test problems are approximated, one having a smooth solution and the second one presenting a square root singularity in a boundary node. The different formulations are compared in terms of the L2 norm of the approximation errors in the solution and in its gradient (the flux). The tests are performed with h refinement with constant order of approximation p, as well as for a given hp refinement procedure. For the problem with a smooth solution, the results confirm convergence orders predicted by theoretical a priori error estimates. As expected, the application of hp refinement to the singular problem improves considerably the performance of all methods. Furthermore, due to the type of the singularity (square root), the efficiency of continuous and discontinuous Galerkin formulations is further improved by using enriched spaces with quarter-point elements. Regarding continuous, hybrid and mixed formulations, the effect of using static condensation of element equations is also analysed, in order to illustrate the reduction in the global system of equations in each case. A third comparison is given in terms of the conservation of the flux over a curve around a singularity.

@&#INTRODUCTION@&#
Many engineering problems are formulated as boundary value problems for second order elliptic differential equations. Elasticity, diffusion, heat conduction, Darcy×³s flow are examples of phenomena modeled by second order elliptic problems. Its simplest form is the Poisson equation, which possesses the main characteristics of the actual engineering problems while remaining simple in terms of constitutive laws, input data, etc. Thus, the development of new numerical methods often refer to the Poisson problem, which are used for their verification. In this work, different finite element formulations for Poisson problems are implemented and compared, in terms of accuracy versus number of required degrees of freedom.The finite element method (FEM) approximates the solution of partial differential equations based on the Galerkin method using a systematic way of generating subspaces. Different finite element formulations have been developed to solve second-order elliptic problems. In fact, the expression finite element refers to a broad family of methods such as continuous, discontinuous Galerkin, mixed methods, hybrid methods, among others. Thus, before solving an engineering problem, one needs to choose the formulation that is more suited to the kind of application at hand. That choice would be guided by different aspects concerning the quantity of interest. Depending on whether the application aims to compute the solution or the flux field, it would determine the choice of a primal or a mixed H(div)-conforming formulation. Another concern relates to local conservation property. One needs to ponder whether this property is required, convenient or mandatory.In this work, different finite element formulations for elliptic problems are implemented and compared, in terms of accuracy versus number of required degrees of freedom (DoF). The implemented formulations are: (a) the classical H1 weak formulation (continuous); (b) the non-symmetric discontinuous Galerkin formulation by Baumann, Oden and Babuska; (c) a mixed discontinuous Galerkin formulation, known as Local Discontinuous Galerkin (LDG); (d) a mixed H(div)-conforming formulation; (e) a primal hybrid formulation.The classical H1-conforming Galerkin FEM method for second order elliptic problems [19], developed in the early ages of the FEM method, and which is based on continuous finite element approximation spaces, still remains a good option for many applications. However, for situations, as in fluid flow applications, where accuracy of the flux is important, a direct approximation of the velocity by taking the gradient of H1-approximate solutions leads to lower-order accuracy.Alternative formulations have been employed to enhance the accuracy of the flux approximations. The dual mixed H(div)-conforming method [12,5] is based on simultaneous approximations of the primal variable and the flux. In its classical formulation, using consistent H(div)-conforming FEM approximations for the flux, the approximation spaces for primal and dual variable are required to be compatible to obtain a numerical scheme which is both consistent and stable (LBB conditions).A variety of new FEM methods have being developed (or recovered) in more recent years, which are mainly based on discontinuous (and thus non-conforming) approximation spaces, both in the primal or dual settings. There are several advantages in using finite element spaces consisting of discontinuous piecewise polynomials, as the flexibility for implementing h and p-adaptive strategies, robustness and local conservation property. However, the practical use of primal (non-hybridizable) discontinuous Galerkin methods is limited by the fact that the formulations are more complex and that the number of DoF is much larger for a given mesh when compared with the classical conforming Galerkin methods.For hybrid formulations, static condensation can be applied to the element matrices such that only globally coupled DoF are included in the global system of equations. This approach results in an approximation of the solution defined only on the boundaries of the elements [5,3,16]. Recently, the connection between hybridization techniques and discontinuous Galerkin methods have been successfully exploited to derive new finite element methods with improved stability and reduced computational cost [7].In this paper, we consider the classical H1-conforming and mixed H(div)-conforming Galerkin FEM methods, as well as the following discontinuous formulations: non-symmetric discontinuous Galerkin method by Oden, Baumann and Babuska [4]; Local Discontinuous Galerkin method [8]; and a primal hybrid stabilized method [13], consisting of locally discontinuous Galerkin approximation of the primal variable coupled to a global problem in a multiplier representing the trace of the primal variable on the element interfaces.The methods are implemented and compared in terms of the quality of their solution and flux approximation errors in the L2 norm versus the number of required DoF when applied to two model problems. The first problem has a smooth solution and the second one presents a square root singularity in a boundary node. The square root singularity is representative for modeling the state of tension around a fracture in elasticity formulations.For the problem with a smooth solution, the tests are performed with h refinement with constant order of approximation p=2. The results confirm convergence orders predicted by theoretical a priori error estimates. Regarding continuous, hybrid and mixed formulations, the effect of using static condensation of the internal equations of the element is also analysed, illustrated by the reduction in the size of the global system of equations to be solved.For the second problem, the methods with uniform mesh refinement have limited convergence rates due to the lack of regularity of the function being approximated. However, due to the type of the singularity (square root), the efficiency of continuous and discontinuous Galerkin formulations can be improved by including functions with the appropriate singular behavior in the approximation space. In this case the shape functions were modified by using quarter-point geometric maps [15,14]. Another comparison is made by computing the error of the computed flux between elements. The motivation for this study is to verify whether approximation spaces which allow to implement formulations with local conservation have smaller flux error. When a given sequence of hp-refined meshes is adopted, the performances of all tested methods improve considerably. It should be noted that the purpose is not to present a self-adaptive procedure, which would require an error indicator. Rather a documented sequence of h and p refinements is applied to all formulations to compare errors on similar hp adapted meshes. For a discussion on different existent a posteriori error estimation and self-adaptive strategies, we refer to [1,21,9].All formulations have been implemented using the object-oriented scientific computational environment NeoPZ.11http://github.com/labmec/neopzNeoPZ is a general finite element approximation software, which incorporates a variety of element geometries, variational formulations, and approximation spaces. The use of this environment has made the current comparisons between approximation spaces/formulations possible. It contains modules for a broad classes of technologies such as system resolution, finite element geometric approximation, finite element approximation spaces (e.g. continuous, discontinuous, H(div), and others). It allows to apply local mesh refinements and to choose the order of approximation. NeoPZ is integrated with pthreads and thread building blocks for efficient execution on multi core computers. Multiphysics simulations can be implemented by combining different approximation spaces into a coupled system of equations. The development of the present numerical study was made possible thanks to the wide range of resources provided by this software.The paper is divided as follows. Section 2 describes the formulations that are implemented, and Section 3 gives the procedures for static condensation to be adopted. Section 5 defines the smooth model problem. Aspects of mesh and mesh refinement are addressed, and L2 norm of the errors in the approximations of the solution and of its gradient (the flux) are presented, confirming convergence orders predicted by theoretical a priori error estimates. Static condensation is also explored for continuous, hybrid and mixed H(div)-conforming formulations. The singular problem, whose exact solution has a square root singularity, is treated in Section 5. For this problem, special quarter-point elements are employed near the singularity, and hp meshes are also used to improve the convergence history. Section 6 concludes the paper.This section describes the finite element formulations to be compared in this paper for the Poisson problem, which can be stated as:{âÎu=finÎ©,u=udonÎd,âuÂ·Î·=gonÎN,where u is a scalar function,Î©âR2is a bounded domain, with boundaryâÎ©=ÎdâªÎN,Îdâ©ÎN=â. The forcing term f is a function inL2(Î©), the space of square-integrable functions. On the boundary region Îd, Dirichlet conditions are imposed and ÎNis the region where Neumann conditions are imposed. Throughout the text,Î·refers to the outward unit normal to the boundary of a region.Several formulations using different approximations spaces are applied to the Poisson problem and their results are compared. Section 2.1 brings the classical H1 continuous formulation [19]. Section 2.2 describes the discontinuous Galerkin formulation of Oden, Baumann and Babuska [18,4], and the mixed H(div)-conforming formulation [5] is presented in Section 2.3. Section 2.4 describes the mixed discontinuous Galerkin formulation, also known as the Local Discontinuous Galerkin method [8], and the hybrid formulation [13] is presented in Section 2.5. Section 2.6 describes the special quarter-point element and its application in H1-continuous and discontinuous formulations [14].For the comparison studies, all the considered formulations make use of finite element spaces based on a partition Î hof the domain Î©,Î h={Î©e,e=1,â¦,nel},where Î©eare open quadrilateral subsets withÎ©=âªe=1nelÎ©Â¯e, nel is the number of elements, andÎ©eâ©Î©i=âforeâ i. Locally defined polynomial spacesPp(Î©e), of total degree p, orQp(Î©e), of maximum degree p in each variable, are used.For the construction of element matrices and load vectors, Gauss quadrature rules are used. The integration points are determined by the tensorization of one-dimensional rules with sufficient points to exactly integrate polynomials of degree2p, excepting in the case of mixed H(div)-conforming formulation (described in Section 2.3), which requires integration rules for polynomials of degree2(p+1).The classical H1 formulation [19] is stated as: finduâU={vâH1(Î©);u|Îd=ud}such thatâ«Î©âuÂ·âvdÎ©=â«ÎNvgds+â«Î©fvdÎ©,âvâU0,whereH1(Î©)={vâL2(Î©);âvâxiâL2(Î©),i=1,2},andU0={vâH1(Î©);v=0onÎd}. Here, this weak form is solved by searching approximate solutions uh, and by using test functions vhlocally defined in terms of hierarchical polynomial functions inQp(Î©e). As described in [10], the shape functions are associated with sides of Î©e, namely, they are of vertex, edge or interior type.The discrete version for the discontinuous Galerkin weak formulation is constructed over the broken polynomial spacesVp(Î h)={vâL2(Î©);v|Î©eâPp(Î©e),âÎ©eâÎ h}.We also adopt the notationÎÎ h=âÎ©âªÎint, where Îintis the union of all interelement boundaries. Thus, the discrete weak formulation, presented in [4,18], is given as: finduâVp(Î h)such thatâe=1nelâ«Î©eâuÂ·âvdÎ©e+â«Îd(uâvÂ·Î·âvâuÂ·Î·)ds+â«Îint(ãâvÂ·Î·ã[u]âãâuÂ·Î·ã[v])ds=â«ÎdudâvÂ·Î·ds+â«ÎNvgds+âe=1nelâ«Î©efvdÎ©e,for anyvâVp(Î h). The termsãâvÂ·Î·ãand[v]are the average and jump operatorsãâvÂ·Î·ã=âveÂ·Î·e+âviÂ·Î·i2,[v]=(v|âÎ©eâ©Îeiâv|âÎ©iâ©Îei),e>i,which are defined between two elements Î©eand Î©i, withe>i, having a common boundary Îei, whereÎ·e=Î·ibeing the outward normal of the boundary âÎ©e.The basis functions for the local discontinuous elementsPp(Î©e)may be defined in terms of Cartesian coordinates x and y or in terms of parametric master element coordinates Î¾ and Î¶. For elements with linear mapping between reference and real elements, no difference is observed and both definitions result in a polynomial basis. However, for bilinear, quadratic or higher order geometry interpolation, the base functions may differ. In this work, the shape functions are defined in terms of Î¾ and Î¶, and are of the total order pÏ(Î¾,Î¶)â{Î¾kÎ¶â;k=0,â¦,p,â=0,â¦,p,k+ââ¤p}.The classical mixed H(div)-conforming formulation starts by rewriting the model problem as a first order system{âÂ·Ï=finÎ©,Ï=ââuinÎ©,u=udonÎd,âÏÂ·Î·=gonÎN,which requires an additional space for the gradientH(div,Î©)={qâL2(Î©)ÃL2(Î©);âÂ·qâL2(Î©)}.As studied in [12,5], the variational formulation for this problem is: findÏâU={qâH(div,Î©);ÏÂ·Î·|ÎN=âg}anduâL2(Î©), such that(1)â«Î©ÏÂ·qdÎ©ââ«Î©uâÂ·qdÎ©=ââ«ÎdudqÂ·Î·ds,(2)ââ«Î©âÂ·ÏvdÎ©=ââ«Î©fvdÎ©,for allqâU0={qâH(div,Î©);qÂ·Î·|ÎN=0}, and forvâL2(Î©).In typical H(div)-conforming discretized versions of the mixed formulation, approximate solutions ofÏand u are searched inUp(Î h)âUandW(Î h)âL2(Î©), and the system of variational Eqs. (1) and (2) is enforced by test functionsqâU0p(Î h)âU0, andvâW(Î h). However, to obtain a discrete mixed H(div)-conforming model with stable and accurate solutions, the finite element approximating spaces must be compatible, demanding the compliance of the LBB conditions [5].In matrix form, the discrete version of the saddle point system (1) and (2) can be written as(3)(ABTB0)(Ïhuh)=(âudhâfh),whereÏhand uhdenote the dual and primal degrees of freedom, udhrefers to the discrete values of the duality termâ«ÎdudqÂ·Î·ds, and fhis associated to the L2 projection of the forcing term onW(Î h). The matrices A and B correspond to discrete versions of the bilinear formsa(Ï,q)=â«Î©ÏÂ·qdÎ©andb(Ï,v)=ââ«Î©âÂ·ÏvdÎ©.Here, this saddle-point problem is solved by using a mesh of quadrilateral elements with compatible pair of conforming approximation spaces for(Ï,u), as described in [20]. For the variable u, discontinuous piecewise polynomials of maximum degree p is adopted. For the construction of H(div)-conforming subspaces for flux approximations, the principle is to choose appropriate constant vector fields, which are multiplied by scalar shape functions inH1(Î©)of total degree p, constructed in [10]. The resulting vectorial shape functions are said to be of internal type if their normal components vanish over all the edges of the element. Otherwise, they are classified as being of edge type. This kind of vectorial approximation space is classified as being ofQâptype. For stability, extended spaces denoted byQâpâare used. They refer to H(div)-conforming approximation spaces formed by enrichingQâpwith internal functions fromQâp+1whose divergences are inQp. The resulting space configurations produce stable simulations of the mixed H(div)-conforming formulation with optimal rates of convergencep+1both for primal and dual variables.Another method for approximating the second order partial differential equations is the nonconforming discontinuous versions for the mixed formulation, as discussed in [2]. For the model problem, we implement the Local Discontinuous Galerkin (LDG) method proposed by Cockburn and Shu [8], which also adopts u and its gradientÏ=ââuas state variables. The discrete version for the LDG method is formulated as: finduhâV(Î h)andÏhâV(Î h)ÃV(Î h)such thatâe=1nel(ââ«Î©eÏhÂ·âvdÎ©e)+â«ÎintãÏhÂ·Î·ã[v]ds+â«ÎdÏhÂ·Î·vds=â«ÎNgvds+âe=1nelâ«Î©efvdÎ©e,âe=1nel(â«Î©eÏhÂ·qdÎ©eââ«Î©euhâÂ·(q)dÎ©e)+â«Îintãuhã[qÂ·Î·]ds+â«ÎdudqÂ·Î·ds+â«ÎNuhqÂ·Î·ds=0,for anyvâV(Î h)andqâV(Î h)ÃV(Î h), whereãâvÂ·Î·ãand[v]are the average and jump operators.Hybrid formulations are also based on nonconforming spaces (see [5,13,3]). We present the primal stabilized hybrid formulation for the Poisson problem proposed in [13]. The presentation is restricted to a pure Dirichlet boundary condition(âÎ©=Îd). Consider discontinuous finite element spacesV(Î h)and multiplier spaces(4)Îh={Î¼âL2(ÎÎ h);Î¼|e=Pp(e),âeâÎint,Î¼|âÎ©=ud},Î£h={Î¼âL2(ÎÎ h);Î¼|e=Pp(e),âeâÎint,Î¼|âÎ©=0}.The stabilized hybrid discontinuous Galerkin method is formulated as: find(uh,Î»h)â(V(Î h)ÃÎh)such thatâe=1nel{â«Î©eâuhÂ·âvdÎ©eââ«âÎ©eâuhÂ·Î·(vâÎ¼)dsââ«âÎ©eâvÂ·Î·(uhâÎ»h)ds+Î²â«âÎ©e(uhâÎ»h)(vâÎ¼)ds}=âe=1nelâ«Î©efvdÎ©e,for anyvâV(Î h)andÎ¼âÎ£h. The parameterÎ²=p2hÎ²0is a penalty stabilization where p is the polynomial approximation order, h is the element size and Î²0 is a given positive constant. By setting the penalization parameterÎ²=0, this method is locally conservative. However, for this choice the formulation becomes unstable. As in [3], in this work, the simulations adoptÎ²0=6, and the same order for the finite element spaces for uhand multiplier Î»h.For further discussion on primal hybrid formulations, see Ref. [3], where a stabilized hybrid finite element method for elliptic problems is proposed consisting of locally discontinuous Galerkin problems in the primal variable coupled to a globally continuous problem in the multiplier. The connection between hybridization techniques and a large class of DG methods is discussed in [7].

@&#CONCLUSIONS@&#
This paper addresses the implementation and comparison of different finite element formulations and their application to model Poisson problems. The classical H1 formulation, the non-symmetric discontinuous Galerkin formulation by Baumann, Oden and Babuska, the Local Discontinuous Galerkin method, the mixed H(div)-conforming formulation, and a primal hybrid formulation are compared using the same computational finite element environment. The performance of the methods are compared in terms of accuracy versus number of DoF, for h and hp refinement procedures.The first problem used for comparing the different formulations has a smooth solution. When comparing the performance of the formulations in terms of the L2-error norm, using uniform refinement and polynomial order p=2, one observes that the continuous H1, the mixed H(div)-conforming and the hybrid formulations produce better approximations of the primal variable. When comparing the L2 error between the different formulations, the H1 approximation performs best as a function of element size and number of condensed degrees of freedom. As predicted by the approximation theory, the mixed H(div)-conforming formulation produces a higher order of convergence rate for the flux as a function of element size. It also performs better as a function of the estimated computational cost (which is measured by the product of the size and the square of the condensed matrix bandwidth).The second problem used for comparison features has a singular solution. In this case, the methods based on uniform meshes have their accuracy limited by the regularity of the solution. Using the NeoPZ library, the geometric map is separated from the approximation space. When combining quarter-point geometric maps with regular and/or hp-adaptive spaces, an increased accuracy is obtained for continuous and discontinuous Galerkin methods. For uniform meshes the hybrid formulation converges at a rate 1/2 order higher than the other methods. The error in approximating the flux for a region around a singularity is also analysed. As expected, the singularity influences the convergence rates. Methods which have local conservation property did not have smaller errors.For the singular problem, hp adapted meshes tuned to the singularity are created. As expected, hp refined meshes substantially improve the quality of the solution u and its gradient, when compared with the uniform refinement procedure. The hp-adaptive mesh sequences are also applied to geometric maps with quarter-point singularity. These meshes, combined with H1-continuous Galerkin approximation produce the best results.We plan to extend this study to 3D problems, where the effects of static condensation and hp refinement are expected to be more important to reduce the computational effort, specially for hybrid and mixed H(div)-conforming formulations. It should also be observed that the application of the methods to other kind of equations may lead to different comparison conclusions.