@&#MAIN-TITLE@&#
Isotopic equivalence by Bézier curve subdivision for application to high performance computing

@&#HIGHLIGHTS@&#
We establish ambiently isotopic control polygons for Bézier curves via subdivision.We provide closed-form formulas for the required number of subdivision iterations.The results are being applied in computer animation.

@&#KEYPHRASES@&#
Bézier curve,Subdivision,Piecewise linear approximation,Non-self-intersection,Homeomorphism,Ambient isotopy,

@&#ABSTRACT@&#
For an arbitrary degree Bézier curveB, we first establish sufficient conditions for its control polygon to become homeomorphic toBvia subdivision. This is extended to show a subdivided control polygon that is ambient isotopic toB. We provide closed-form formulas to compute the corresponding number of iterations for equivalence under homeomorphism and ambient isotopy. The development of these a priori values was motivated by application to high performance computing (HPC), where providing estimates of total run time is important for scheduling.

@&#INTRODUCTION@&#
Preserving ambient isotopic equivalence between an initial geometric model and its approximation is of contemporary interest in geometric modeling (Amenta et al., 2003; Andersson et al., 1995, 2000; Miller, 2009; Moore et al., 2007), with the focus here being on Bézier curves.A Bézier curve is characterized by an indexed set of points, which form a piecewise linear (PL) approximation of the curve, called a control polygon (Definition 2.1). We consider the special class of simple22A curve is said to be simple if it is non-self-intersecting, exclusive of common end points of a closed curve and junction points in composite Bézier curves.Bézier curves, because we are interested in knots.33A knot is a simple closed curve.The motivation for this theory was the scaling of dynamic visualization to HPC applications. For models of complex molecules (Jordan et al., 2008), as found in the Protein Data Bank (PDB), Bézier curve models of these molecular backbones could be of arbitrarily high degree, but the existing literature on relevant ambient isotopic approximation was limited to degree 3 (Moore et al., 2007). A formally proven guarantee that the graphics be ambient isotopic to the Bézier curve is essential. A simulation of molecular writhing is run on a high performance computing architecture, generating terabytes of floating point data. The output of all this data is the significant bottleneck. However, small portions of the data, covering seconds to minutes of the simulation can be offloaded within an acceptably minimal time lag to enable nearly synchronous dynamic visualization for informed decisions in computational steering. The appropriately high threshold here is that the dynamic visualization should not lead to inappropriate abortion of a simulation, based upon a misrepresentation of the isotopic type of the molecule.There may be substantial topological differences between Bézier curves and their control polygons. It has long been known that Bézier curves and their control polygons are not necessarily homeomorphic. There are examples in the literature showing self-intersecting Bézier curves with simple control polygons or simple Bézier curves with self-intersecting control polygons (Li et al., 2012; Neagu et al., 2000; Piegl and Tiller, 1997). Bézier curves and their control polygons are not necessarily ambient isotopic. There is an example showing an unknotted Bézier curve with a knotted control polygon (Bisceglio et al., 2011; Moore, 2006). Examples of a knotted Bézier curve with an unknotted control polygon have also been given (Li et al., 2012; Sequin, 2009).The de Casteljau algorithm (Farin, 1996) is a subdivision algorithm associated to Bézier curves which recursively generates control polygons more closely approximating the curve under Hausdorff distance (Munkres, 1999). It is known that the convergence of the subdivided control polygon to its Bézier curve is exponential under Hausdorff distance (Lane and Riesenfeld, 1980; Nairn et al., 1999). As a fundamental lemma, we show that the convergence of the exterior angles of the subdivided control polygon to 0 is also exponential for simple, regular,C1, composite Bézier curves44These Bézier curves are necessarily compact, as continuous images of[0,1].inR3. Furthermore, we derive closed-form formulas to compute sufficient numbers of subdivision iterations to achieve homeomorphism and ambient isotopy, respectively.A brief overview of the relevant computational science issues follows. Prior knowledge of the run time of any job is important to estimate HPC time allocation and the sufficient number of iterations presented here will permit computational scientists to produce reliable estimates. With often more than 100,000 processors available, there are many creative, ad hoc parallelization techniques to achieve acceptable performance for subdivision. The initial ambient isotopic approximation can be done on a static geometric model, before the simulation begins. The next crucial experimental question is, “As the spline perturbs, how long can the original PL approximation be perturbed to maintain ambient isotopic equivalence?” Recently published work (Cassidy et al., 2014) provides some initial insight. If these time periods are sufficient for the amount of data initially output, then the cycle would begin again, but this remains to be verified experimentally. The emphasis here is that the theory proven provides a strong foundation to pursue these experiments with confidence that subdivision will not become a time sink. As a contrast, in absence of this theory, the subdivision might be run recursively, with no prior knowledge of time to completion. The classical pipe surface was invoked as the boundary of a tubular neighborhood as an algorithmic constraint for a PL ambient isotopic approximation of a static spline curve (Maekawa et al., 1998). That static view has been extended so that many perturbations of the PL approximant within the pipe surface continue to maintain ambient isotopic equivalence (Jordan et al., 2008) and is applied here. Once the dynamic visualization begins, the containment of the PL graphics within a pipe surface of constant radius enables run time warning messages, as the geometry approaches the boundary of this tubular neighborhood, increasing the prospect for a significant topological change. This is far superior to prevailing animation techniques that concentrate on self-intersection analysis on a per frame basis, which are known to be error prone (Jordan et al., 2008; Lasseter, 1987).The availability of hundreds of thousands of processors noted in the preceding paragraph is common today. The number of processors is rapidly growing to millions, so moving simulation data results will become an issue of increasing greater concern. Computational steering and in-situ visualization will become ever more important. The theoretical results presented here provide the foundation to ensure that the perturbed PL graphics faithfully represent the underlying molecular science. The resultant algorithms are expected to scale gracefully. In the absence of this theory, an inappropriate steering decision – based upon a flawed visual analysis, could lead to lost results. These flawed decisions are expensive, motivating this theory as the primary basis for properly informed decisions.Some basic background on Bézier curves is provided.Definition 2.1A parameterized Bézier curve of degree n with control pointspj∈R3is defined by∑j=0nBj,n(t)pj,t∈[0,1],whereBj,n(t)=(nj)tj(1−t)n−jand the PL curve given by the ordered set of points{p0,p1,…,pn}is called its control polygon and is denoted by P. Whenp0=pn, the control polygon is closed. Otherwise whenp0≠pn, it is open.In order to avoid technical considerations and to simplify the exposition, the class of Bézier curves considered will be restricted to those where the first derivative never vanishes.Definition 2.2A differentiable curve is said to be regular if its first derivative never vanishes.The Bézier curve of Definition 2.1 is typically called a single segment Bézier curve, while a composite Bézier curve is created by joining a sequence of two or more single segment open Bézier curves at their common end points.Throughout the paper, we useBto denote a simple, regular,C1, composite Bézier curveB:[0,1]→R3,defined by a control polygon with distinct consecutive vertices, except that for a closed Bézier curve, the end points are the same.Beginning with Theorem 6.2 the hypothesis ofC2is added forB, but this is because theC2condition was previously implicitly used in establishing a non-singular pipe surface (Maekawa et al., 1998) as the boundary of a tubular neighborhood. This dependency continues for other results which use this non-singular pipe. This non-singular pipe surface is merely a convenience to ease the exposition. There are many cases where theC1assumption will suffice for an alternative tubular neighborhood to replace that created with the indicated pipe surface as its boundary. Some creative alternatives could rely upon previous ‘snow cone’ constructions (Jordan et al., 2011), but this is left as a subject of future work. We note that our use of Fenchel's Theorem 4.1 in the proof of Lemma 6.2 relies only on the PL case.

@&#CONCLUSIONS@&#
