@&#MAIN-TITLE@&#
A combined neural network and genetic algorithm based approach for optimally designed femoral implant having improved primary stability

@&#HIGHLIGHTS@&#
It aims to design optimal femoral implant for better primary stability.It uses a combined neural network and genetic algorithm-based approach.Knowledge of problem domain has been represented using neural networks.Optimization problem has been solved using genetic algorithms.

@&#KEYPHRASES@&#
Total hip arthroplasty,Cementless implant,Finite element analysis,Neural networks,Genetic algorithms,

@&#ABSTRACT@&#
Excessive implant-bone relative micromotion is detrimental to both primary as well as long-term stability of a hip stem in cementless total hip arthroplasty (THA). The shape and geometry of the implant are known to influence the resulting post-operative micromotion. Finite element (FE)-based design evaluations are manually intensive and computationally expensive, especially when a large number of designs need to be evaluated for an optimum outcome. This study presents a predictive mathematical model based on back-propagation neural network (BPNN) to relate femoral stem design parameters to the post-operative implant-bone micromotion, with no recourse to tedious nonlinear FE analysis. The characterization of the design parameters were based on our earlier study on shape optimization of femoral implant. The BPNN led to faster prediction of the implant-bone relative micromotion as compared to the FE analysis. Using the BPNN-predicted output as the objective function, a genetic algorithm (GA) based search was performed in order to minimize post-operative micromotion, under simulated physiological loading conditions. The micromotion predicted by the neural network was found to have a significant correlation with FE calculated results (correlation coefficient R2=0.80 for training; R2=0.82 for test). The optimal stems, evolved from the GA search of over 12,500 designs, were found to offer improved primary stability, as compared to the initial TriLock (DePuy) design. Our predicted results favour lateral-flared designs having rectangular proximal transverse sections with greater stem-sizes.

@&#INTRODUCTION@&#
The biologic fixation is an important criterion associated with the biomechanics of cementless total hip arthroplasty (THA). The absence of biologic fixation has often been reported as one of the major causes of aseptic loosening of cementess hip implant [1–4]. A combination of both primary as well as secondary stability is necessary for long-term success of the THA. During early post-operative period, when the bone ingrowth is yet to commence, the primary stability or the mechanical stability is typically governed by the amount of bone-implant relative micro-movement, induced by the physiological loading [5]. Secondary stability indicates the implant-bone relative micromotion occurring under physiological loading conditions, after osseointegration (i.e., mechanical interlocking through bone ingrowth) process is completed. Generally speaking, small micromotions enhance osseointegration through bone ingrowth, whereas large micromotions inhibit it causing the formation of fibrous tissue at the interface [6]. Therefore, in order to promote secondary (i.e., long-term) fixation through osseointegration, a desired level of primary stability should prevail post-operatively [7,8].Although surgical techniques play the fundamental role in resulting primary stability of femoral implant [9,10], the design of the femoral implant is also known to have an influence over the outcome [11–14]. Therefore, there is a need for interrogation on the optimal implant geometry that would minimize micromotion and thereby, enhance primary stability of the prosthesis. However, an extensive investigation on various hip implant designs with regard to primary stability has hardly been explored. The design evaluation of thousands of new implant models involves remeshing on each implanted model; a task which is manually intensive in nature [15–17]. Moreover, solving the non-linear finite element (FE) model to assess the corresponding implant-bone relative micromotion is computationally expensive and time consuming. Therefore, the development of a predictive mathematical model, with no recourse to FE analyses, may be endeavoured in order to identify the relationship between the design parameters and post-operative micromotion of hip implant.Artificial neural networks (ANNs) are algorithms that are patterned after human brains containing a series of mathematical equations used for simulating biological processes, for example, learning and memorizing [18]. The first artificial neural network (ANN) was developed several decades ago in order to investigate complex learning processes of human brains [19]. However, a widespread interest on ANN was developed in the scientific community only with the rediscovery of back-propagation algorithms in the late 1980s [20], especially because of its simple architecture but excellent interpolation, pattern recognition and generalization ability. Unlike logistic regression techniques, ANNs are more competent with regard to modelling a complex nonlinear relationship between predictor variables and the predicted outcome [21]. Owing to their adaptive nature and machine learning capability, ANNs have been extensively recruited to solve a wide variety of problems that are difficult to solve using ordinary statistical methods or rule-based programming, including computer vision and speech recognition [22]. Henceforth, the abbreviation ANN or NN will be used throughout the article referring to neural networks.The combined NN and genetic algorithm (GA)-based approaches provide a good alternative to design a system, when mechanically plausible or deterministic relationships between the input and the output parameters are hard to find. The purpose of a combined NN-GA based simulation is to first recognize a pattern to model the input–output relationship, and then to optimize the system performance by searching for optimal design parameters. The GA, similar to the ANN, is biologically inspired algorithm, which comprehensively searches for the optimum outcome using certain genetic operators. In comparison with a traditional optimization method, such as the steepest-descent method, a robust heuristic method, namely the GA has an advantage for complex multi-variable analysis and its search for optimum values does not require a gradient function. Therefore, the chance of convergence to a local extreme is diminished, and a wide range of solutions may also be obtained. Moreover, the GA presents a multi-solution approach to the problem and does not require any first-hand knowledge of the search environment.The application of combined NN-GA based design approaches can be found in a variety of fields. A novel hybrid intelligent system using NN and GA was implemented by Coit and Smith [23] to solve a combinatorial hardware design problem. The NN was employed to estimate the system reliability value during the GA-search. An integrated NN-GA system was used by Cook et al. [24] to determine the critical process parameter values for desired level of internal bond in a particle-board manufacturing process. The process parameters associated with injection molding were optimized using a combined NN-GA technique, while the fitness values were determined based on the ANN model [25]. Dutta and Pratihar [26] modelled the input–output relationships of a tungsten inert gas (TIG) welding process using both back-propagation neural network (BPNN) and genetic neural (GA-NN) system and subsequently, compared the performances of the two approaches. A novel GA-NN system was employed by Dybowski et al. [27] to predict the medicinal outcome of ICU patients. A two-stage approach – one based on NN-GA and the other based on integrated Taguchi's method and GA – was proposed by Ozturk et al. [28] to address design optimization applications in concurrent engineering (CE).Several other hybrid optimization schemes had been implemented with good results in the fields of structural and manufacturing optimization dealing with various engineering problems. Robust hybrid techniques based on a differential evolution algorithm was introduced to solve optimization problems related to manufacturing [29,30]. A similar scheme had been further applied to a welded beam design problem and the optimal design of a vehicle component [31]. A novel hybrid Taguchi–Harmony search algorithm was implemented to the case studies for turning and milling operations, and design optimization problems [32]. A two-stage combined Taguchi's method and immune algorithm was used for shape optimization of a vehicle component [33]. Using a multi-objective GA, a hybrid optimization scheme was developed to simultaneously optimize the topology and geometry of structural assemblies [34]. A hybrid optimization method based on artificial bee colony algorithm and Taguchi method was utilized for structural optimization of a vehicle component and multi-tool milling optimization problem [35]. Hybrid approaches based on particle swarm optimization algorithm [36,37] and immune-hill climbing algorithms [38] were also developed and applied to a variety of case studies from structural and manufacturing domains.Both clinical as well as applied biomechanics attempt to model human body phenomena that are mostly nondeterministic and hence, a suitable mechano-mathematical relationship is difficult to establish [39]. The ANN-based approaches, therefore, find their applications in the field of biomechanics; examples of such applications can be found in medical imaging and signal processing [40], classification and pattern recognition of biological systems [41], biomedical engineering [42], analytical techniques to obtain gait data [43], gait modification [44], joint-torque measurements [45,46] and in physical medicine and rehabilitation [47]. The shape of a cementless femoral implant is non-primitive and typically unorthodox. Hence, a complete description of the geometry involves a large set of design parameters. Consequently, there might exist complex nonlinear relationships between different geometric parameters and the resulting implant-bone micromotion. Therefore, a combined NN-GA based approach seems to be a more suitable option to model such a relationship. Moreover, a significantly faster prediction of the micromotion enables evaluation of a large number of designs for an optimum result. However, there is a scarcity of study in predictive ANN models in the field of prostheses design. Moreover, to the authors’ knowledge, there is hardly any reported investigation on combined NN-GA based design optimization of hip implants.The primary objective of this study is to develop a mathematical model based on a feed-forward BPNN to map femoral stem design parameters to the post-operative interfacial micromotion of the cementless THA under simulated physiological loading conditions. Thereafter, a GA based search was carried out for optimized implant design by minimizing the BPNN predicted micromotion.In order to determine the input–output relationships between the geometric parameters of the implant and the implant-bone relative micromotion, a BPNN-based approach was adopted. After the BPNN was modelled and validated, it was used as an objective function in order to search for an optimized implant shape with regard to the primary stability of the implant. The complete procedure is explained step-by-step in the following sections.Like all neural networks, BPNN requires a set of sample data for ‘training’. The sample data set in the present study was obtained from the FE analyses of bone-implant constructs for a range of implant designs with a pre-defined femur-implant configuration. A total of 160 implanted FE results were used as test cases for training the network and another 26 cases were used for validation purpose. The input parameters were eighteen design parameters (a1 through a6, b1 through b4 and p1 through p8) obtained at four key transverse sections that characterize the shape of the femoral implant (Fig. 1a). The parameter p ranges between 2 and 5, and takes only integer values. The initial parametric model was designed based on a TriLock (DePuy) stem using SolidWorks (SolidWorks, Dassault Systèmes, SA) (Fig. 1b). The design parameters had lower and upper bounds and were subject to a set of constraints in order to maintain clinical admissibility. The entire scheme of CAD-based parameterization had been described previously [48]. All input data were normalized in the range (0, 1) with respect to their corresponding lower and upper bounds.The output parameter, designated as ‘Index of Instability’ (IoI), had been carefully chosen, such that it could represent the implant-bone relative micromotion along the interface by means of a globally normalized value. The value of IoI was calculated from the micromotion data obtained from the corresponding FE analysis and can be defined as follows:(1)IoI=f(a1,…,a6,b1,…,b4,p1,…,p8)=μ¯Π2+σΠ2−μ′μ″−μ′whereμ¯Πand σΠrepresent the mean value and the standard deviation of the relative sliding displacements obtained at the interfacial nodes, respectively and the subscript Π denotes the global implant-bone interfacial domain. Simultaneous minimization of both mean and standard deviation terms would ensure that the relative micro-movements at the interface would remain within specific limits. μ′ and μ″ are the two chosen micromotion values used for normalization purpose. Therefore, lesser the value of IoI, better will be the primary stability of the implant. Fig. 2illustrates the input–output parameters to be mapped by the neural network.The FE models corresponding to each candidate design of implant were developed based on a patient-specific CT-scan data of a 31-year-old male patient and ANSYS v14.0 FE software (ANSYS v14.0, Ansys Inc., PA, USA) (refer to Fig. 3). Images of the femur were stored in 512×512 pixels, with a pixel size of 0.799mm, slice thickness of 0.699mm. The CT grey value was expressed in terms of Hounsfield Units (HU). The CT-scan data was processed using a medical image processing program, MIMICS® (Materialise, Leuven, Belgium) to acquire the 3D surface geometry of the femur. Within a 2D CT-scan slice, image segmentation was performed to identify bone from soft tissue using threshold values of CT number. Ten-noded tetrahedral element was used to mesh the implanted femur models. Finer mesh density was used at the implant-bone interface in order to capture the nodal micromotion values with greater accuracy (refer to Fig. 3).The bone was considered to be a linearly elastic and isotropic material. Elastic modulus of each bone element was extracted from the CT-scan data using shareware software Bonemat v2.0, developed at the Institute Ortopedici Rizzoli, Bologna, Italy [49,50]. The apparent density (ρ in gcm−3) for bone element was computed from corresponding CT number (HU) in Hounsfield Unit using the following relationship:(2)ρ=ρ1+ρ2−ρ1HU2−HU1×[HU−HU1]where (ρ1, HU1) represented the apparent density and CT number of water, that is, no bone condition (0.022gcm−3, 0HU), and (ρ2, HU2) were the apparent density in the hardest cortical region and corresponding CT number value (1.73gcm−3, 1700HU), respectively. The Young's moduli (E in MPa) of bone elements were related to the apparent density (ρ in gcm−3) as given below.(3)E=7281ρ1.52The values of constants in Eq. (3) correspond to that reported in some earlier investigation [51]. The implant material considered in the study was titanium alloy, Ti-6Al-4V (Young's modulus, E=110GPa). Poisson's ratio for both bone and implant was considered as 0.3. The FE modelling procedure was similar to that described in our earlier work on shape optimization of cementless femoral stem [48]. However, unlike bonded implant-bone interfacial condition used in the previous work, contact condition was simulated in the present study using surface-to-surface contact elements of ANSYS for obtaining contact sliding micromotion data at the interfacial nodes. The coefficient of friction between implant and bone was considered as 0.4.Loading conditions for the FE models comprised of the maximum loads during stance phase of normal walking and stairs climbing, applied as two static load cases [52,53]. The combined effect of the two load cases was considered, by giving equal weightage to each case. The joint reaction force was projected onto the centre of the femoral head (Fig. 3). The muscle forces were distributed over a circular patch, centred on the point of attachment of the respective muscles or group of muscles in the femur. The data on area of muscle insertions were taken from Duda et al. [54], although it may be noted that there exist inter-individual variations in musculoskeletal system. The muscle forces and hip contact force were calculated assuming a moderate body weight of 70kg, which approximately represents the weight of average population in the same age group of the subject. Nodes located on the distal most end of the femur, about 150mm below the lesser trochanter, were fixed in all directions. Typical values of the musculoskeletal force system in global coordinates are presented in Table 1.The architecture of the neural network proposed here consists of three layers, namely input, hidden and output layers. The schematic view of the BPNN used to model the relationship is presented in Fig. 4. Eighteen geometric parameters (i.e., J=18) identified at four key transverse sections of the implant served as inputs. The hidden layer consists of K neurons. A parametric study was carried out to identify a suitable value of K. The output layer contains only one neuron (i.e., M=1), representing the normalized micromotion index IoI. The activation functions for input and hidden neurons were considered to be log-sigmoidal and tan-sigmoidal, respectively, whereas that for the output neuron was assumed to be pure-linear. The vectors: [V] and [W] represent the connecting weights between the input and hidden layers and that between the hidden and output layers, respectively. The values of [V] and [W] were allowed to vary in the range of −1.0 to 1.0, whereas the bias value b ranged between 0 and 1. The initial values of all the weights and biases were generated at random. It can be noted from Fig. 4, that [V] is a matrix of size j×k, whereas [W] is a vector of length k. A custom MATLAB program (MATLAB vR2011b, MathWorks Inc., Natick, MA) was written to model the neural network.It may be noted here that the performance of a BPNN depends on both the quality and quantity of the data used for training. It also depends on several other factors, such as the architecture, momentum constant (α) and learning rate (η). In order to determine an optimal set of above parameters, a study was carried out by varying one parameter at a time while keeping the other parameters constant [26]. Only one hidden layer was considered in the present study, since a single hidden layer is found to be sufficient for designing a competent BPNN for vast majority of problems.A single-objective mixed-integer GA-search was carried out using MATLAB Optimization Toolbox (MATLAB vR2011b, MathWorks Inc., Natick, MA) to seek for optimal stem geometry by minimizing IoI. To facilitate the GA-search, the BPNN was employed for estimating the IoI value for each candidate design. A GA-parametric study was performed to identify the optimum set of GA parameters, such as, crossover fraction, population size and maximum number of generations [55]. Crossover fraction is the fraction of individuals in the next generation, other than the elite children, that are created by crossover (i.e., mating). The rest are generated by mutation. Therefore, a crossover fraction of 1.0 suggests that all children other than the elite individuals are crossover children, whereas for a crossover fraction of 0.0, all children are generated through mutation [56].Stochastic-uniform selection algorithm and scattered crossover function from the MATLAB Toolbox were used in the GA-search. The number of elite children was fixed at 2 across all generations. During the parametric study, a unique seed value was considered throughout for creating initial set of random population in order to have reproducibility. The final GA-run was then carried out based on the optimum set of GA-parameters, subject to the geometric constraints defined by clinical admissibility [48]. The optimum stem geometric parameters were obtained at the final generation of the GA search.

@&#CONCLUSIONS@&#
The study presents a near-optimal NN constructed for the purpose of predicting primary stability of cementless hip prosthesis based on implant geometry. To the authors’ knowledge, this is the first ever NN-based study to relate the geometric parameters to the resulting micromotion of cementless femoral implant. The bone-stem total relative micromotions predicted by the ANN were found to have a significant correlation with the FE calculated outcomes. The optimal MMGs obtained based on the GA search were found to offer improved primary stability, as compared to the initial design. The present optimization study supports lateral-flared designs having rectangular proximal transverse sections with greater stem-size, perhaps owing to their increased metaphyseal support and tight diaphyseal fit. Although patient-specific and implant material specific, the study was able to quickly speculate the gross initial stability of implant based on its design and can, therefore, be used for the search of favourable design outcomes.The authors hereby declare that with regard to the submission of this article there are no financial or personal relationships with other people and organisations.