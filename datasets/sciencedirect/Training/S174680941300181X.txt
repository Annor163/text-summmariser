@&#MAIN-TITLE@&#
Analysis of non-stationary HRV as a frequency modulated signal by double continuous wavelet transformation method

@&#HIGHLIGHTS@&#
We propose a new model of non-stationary rhythmogram as a frequency modulated signal.Double continuous wavelet transformation is performed to analyze non-stationary HRV.Various scenarios of oscillation rearrangement are studied for frequency modulated rhythmogram signal.The transient periods and other spectral characteristics are calculated basing on head up tilt test real records.

@&#KEYPHRASES@&#
Heart rate variability,Rhythmogram,Frequency modulated signal,Double continuous wavelet transformation,Spectral integral,Head up tilt table test,

@&#ABSTRACT@&#
The analysis of heart rate variability (HRV) is central for cardiac diagnostics but its essential nonstationarity has started to gain attention only recently. The aim of this work is to develop a method for finding mathematical indicators of HRV spectral properties considering frequency nonstationarity. The analysis is done both for the new model of rhythmogram taking into account frequency modulation and for the true rhythmogram record during head up tilt test. Continuous wavelet transformation of the frequency-modulated signal (CWT) has been derived in analytical form. The local frequency of heart rhythm giving the maximum of CWT has been determined. Treated as another non-stationary signal, this frequency has been subjected to CWT following double CWT procedure (DCWT). The transient periods for local frequency, the frequencies of local frequency fluctuation against the main trend and the periods of emergence and attenuation of such fluctuations have been defined by estimating the spectral integrals in the ranges {ULF, VLF, LF, HF}. The presented technique allows to use HRV control in the cases of arrhythmia, ectopic beats, heart turbulence and other non-stationary violence of heart rhythm and also while studying long term cardiac records.

@&#INTRODUCTION@&#
Heart rate variability (HRV) is an important characteristic of cardiovascular system and can be investigated during such diagnostic procedures as functional cardiologic tests (veloergometry, treadmill), Holter monitoring, respiratory, orthostatic and psychoemotional tests [1–11].The fact is that in many cases the parameters recommended for use in medical practice are inadequate to the complexity of the object under study. According to the accepted HRV-Standards [5,6], a lot of statistical parameters (RRNN – the average duration of RR intervals, SDNN – a standard deviation, etc.), spectral characteristics of cardio-intervals received by Fourier transformation (VLF, LF, HF) and also histogram methods can be used only in stationary situations. However, the condition of stationarity is not satisfied at many functional cardiac tests, in particular on the sections of heart rhythm corresponding to transient processes, which probably contain the main information on irregularities in a heart work. Only short periods of an electrocardiogram can be considered as a stationary process.Still, a sine rhythm without any arrhythmias has been as usual the main object under study in HRV analysis. The HRV parameters have been determined for RR-interval sequences between sine cardiac cycles. However, the majority of cardiac patients have primarily ventricular and supraventricular ectopic beats. These rhythm violations can significantly distort the results of HRV quantitative analysis. According to the Standards [5,6], before analyzing HRV the cardiac cycles, corresponding to arrhythmia and following them, are excluded from consideration. Such approach restricts the objectivity and completeness of heart activity research. Since such HRV control methods as statistical methods, Fourier transformation method, histogram methods, correlation methods are not efficient enough in this case, and a new approach is necessary to analyze transient processes registered while carrying out functional tests. Furthermore, for highly non-stationary HRV signals the methods of chaos theory (correlation dimension, Lyapunov exponent, approximate entropy, Hurst exponent, fractal and multifractal scaling, detrended fluctuation analysis) [4,7,8,11] essential modification is required. Thus, the development of new approaches for the analysis of transient processes during functional tests [5,6] is an urgent task.In this paper the wavelet theory [12–16] is applied to reveal the mathematical indicators of HRV spectral properties taking into account the frequency nonstationarity in sequences of RRn-intervals between the adjacent beats of heart. The wavelet theory approach to HRV problems was developed in [17,4,18–20], where it was used to investigate spectral properties of HRV signals with amplitude modulation, when under uniform signal discretization of Δt coinciding with the average duration of RR-intervals (Δt=RRNN), various values of RRn-intervals were fixed in equidistant points of time. The method of double wavelet transformation (DCWT) was proposed in [26–28] for sine signals. The main feature of the approach developed in [21–25] and presented in this paper is in the fact that double continuous wavelet transformation is used for the analysis of heart rhythm signal (rhythmogram) with frequency modulation: all heart beats with number n have an identical form but come up at real time moments tn(t0=RR0, tn=tn−1+RRn). So the rhythmogram model is presented as a superposition of Gaussian peaks of the identical amplitude with the centers located on the irregular grid of times. The method suggested in this paper is illustrated both on the model relation of RRn-cardiac interval to n-beat number and on a real rhythmogram record during head up tilt table test.Consider non-stationary HRV, assuming that there is no amplitude modulation of a rhythmogram signal, when cardiac interval length RRndepends on heart beat number n, but HRV is described by a frequency modulated signal. Let the centers of RRnheart peaks be located at non-uniform grid characterized by real time points tn. In reality it is the heartbeat with the number n and the amount of time between n and n−1 heartbeats equal to RRnthat happens at time tn:(1)tn=∑m=0nRRm,Following [5,6], let us introduce the average duration of cardiac intervals RRnduring the entire observation period T as:(2)RRNN=1N∑n=0N−1RRn,where N is the total number of beats. If RRNN is measured in ms, the heart rate (HR – heart rate), measured in 1min−1, is expressed by relation HR=60*1000/RRNN. If the frequency of cardiac contractions νHRis measured in Hz and RRNN – in s, then νHR=1/RRNN. The time of the last beat tN−1 is related to RRNN(1) by the ratio tN−1=N*RRNN.Assume that all the peaks R of the heart complex P-QRS-T have the same amplitude, measured in mV, and the form approximated by Gaussian peak. In this case the rhythmogram signal Z(t) is the superposition of N Gaussian peaks of the same unit amplitude with the centers located on a non-uniform time scale tn(2):(3)Z(t)=∑n=0N−1z0(t−tn),(4)z0(t−tn)=12τ0πexp−(t−tn)24τ02.The characteristic width of the Gaussian peak τ0=20ms is chosen so that it corresponds to the width of the R-heart rate peak approximately equal to 80ms. Fourier spectrum Z(ω) (ω=2πν, ν in Hz) of the signal is as follows:(5)Z(ω)=exp[−ω2τ02]∑n=0N−1exp[iωtn].According to [21–25], continuous wavelet transformation (CWT) of frequency modulated signal Z(t) has the form(6)V(ν,t)=ν∫−∞∞Z(t′)ψ*(ν(t′−t))dt′,reflecting the signal Z(t) on the surface of continuously varying arguments – frequency ν and time t. In this expression ψ(x) is the mother wavelet; the asterisk denotes complex conjugation. The argument ν determines the scope of compression or stretching of the mother wavelet and the argument t – the center of localization. The wavelet acts as an adaptive window having large width for low frequencies ν and small one for high frequencies. The components of Z(t′), which are most similar to the wavelet function centered at the point t′=t and oscillating with the frequency of ν, provide the main contribution to integral V(ν, t). The mother wavelet must be well localized near the point x=0 to have zero mean and unit norm. These properties are of the Morlet wavelet:(7)ψ(x)=Dexp−x22exp(−iΩ0x)−exp−Ω022,where parameter Ω0=2π, and value D of the normalization constant is(8)D=1π1−2exp−3Ω024+exp(−Ω02).The second term in (7) is necessary to restore the signal by its continuous wavelet transformation.The advantage of integral wavelet transform V(ν, t) over the ordinary power spectrumPHR(ω)=Z(ω)2is that, in contrast to the power spectrum PHR(ω), indicating only the existence of frequencies, value V(ν, t) shows the moments in time when these frequencies appear or disappear. This is very important in analyzing the complex non-stationary signal Z(t) modulated in frequency, whose spectral characteristics may change quite rapidly in time. For Gaussian peak z0(t−tn) (4), the wavelet transform is derived analytically:(9)V(ν,t−tn)=Dνa(ν)exp−x2+Ω02[a2(ν)−1]2a2(ν)exp−iΩ0xa2(ν)−exp−Ω022a2(ν),where x=ν(t−tn) and functiona(ν)=1+2ν2τ02. The analytical expression for CWT of the complex model signal (3) can be calculated based on the principle of superposition(10)V(ν,t)=∑n=0N−1V(ν,t−tn).Let frequency νHRmax(t) denote the maximum value ofV(ν,t)2at any point in time. In order to find the maximum ofV(ν,t)2, the range of frequencies [νmin; 2Hz], characteristic of the heart rate, is used. Boundary effects take place on the left (0<t<tL) and right border (tR<t<T) of observation period T of the signal. To eliminate the boundary effects we have to nullify the values of CWT at these time-points. Let Morlet mother wavelet ψ(x) (7) have standard deviations Δxand ΔΩin spaces X and Ω. According to Heisenberg's uncertainty principle: ΔxΔΩ≥1/2. The width of ψ(x) is 2Δx[12]. For the Morlet mother wavelet (7), we have Δx≈0.707. Let us estimate frequency νmin for CWT (6). The left boarder interval tLin (6) for the required value of νmin can be estimated from the condition νmintL≈2Δx. The durations of [0,tL] and [tR,T] are related to νmin as follows tL≈T−tR≈2Δx/νmin. When determining νmin, we take into account that the period of signal observation T is the sum of boarder intervals 4Δx/νmin and length m/νmin of the correct determination of spectral properties of the signal, where m is the number of periods, i.e. νmin=(m+4Δx)/T. To verify this relation we made calculations for CWT at various localizations of signals relative to interval T and compared the results with the exactly solvable analytical models [24]. As a conclusion, boundary effects can be minimized if we take m=7 and substitute ΔB≈1.5 instead of Δxin the last evaluation formula for νmin.In signal νHRmax(t) determining the local heart rate at time t, in addition to the smooth change (the main trend of the heart rate) one can observe the fluctuations in νHRmax(t) against the trend with characteristic periods Tfin the range of [1000; 2.5s]. These values correspond to the low frequency range νf=[0.001; 0.4Hz] that directly coincides with the appropriate frequency intervals ULF=[νmin; 0.015Hz], VLF=[0.015; 0.04Hz], LF=[0.04; 0.15Hz] and HF=[0.15; 0.4Hz]. To obtain the analytical expressions for (10), the whole analyzed frequency range [νmin; 2Hz] is divided into Nν=400 parts and the step of time Δt=0.5s. The period of signal observation T≈3000s leads to the calculation of about 2.4×106 values. The resulting non-stationary signal νHRmax(t) has complex spectral density which depends on time.Double CWT (DCWT) following (6) is applied to study the moments of appearance and disappearance of low-frequency oscillations νf(t) with respect to the trend of νHRmax(t). When calculating the DCWT defined as VDW(ν, t), signal Z(t) in the expression (6) is replaced by νHRmax(t). The study of appearance and disappearance of low-frequency oscillations can be made by calculating the skeletons VDW(ν, t) of DCWT showing extreme lines of VDW(ν, t) on the plane ν and t. The value ɛ(ν, t) illustrates instantaneous distribution in frequency of the signal energy (local density of energy spectrum of the signal) [21–25].(11)ε(ν,t)=2CΨVDW(ν,t)2ν.The constant CΨfor the Morlet wavelet is approximately 1.0132. The dynamics of time-variation for different frequencies is determined by spectral integral Eμ(t)(12)Eμ(t)=1Δν∫νμ−Δν/2νμ+Δν/2ε(ν,t)dν.Spectral integral Eμ(t) represents the average value of the local density of the signal energy spectrum integrated over a certain frequency range μ=[νμ−Δν/2;νμ+Δν/2], where νμdenotes the middle of the interval, Δν – its width. The time-variation of Eμ(t) performs a kind of signal filtration summing the contributions from the local density of the spectrum ɛ(ν, t) only in a certain range of frequencies μ. By studying DCWT of the signal and calculating Eμ(t) in the range of μ={ULF, VLF, LF, HF} one can follow the dynamics of appearance and disappearance of low-frequency spectral components νf(t).

@&#CONCLUSIONS@&#
The paper proposes a new model of rhythmogram with frequency modulation based on the fact that n-number heartbeat occurs in true time-point tn, where tn=tn−1+RRn, n=1, 2, 3, …, N−1, RRn– the period between heartbeats and t0=RR0.The analytical expression for continuous wavelet transformation CWT of frequency-modulated non-stationary signal is obtained.Local frequency νHRmax(t) giving the extremum of CWT is determined. Note that in medical practice νHRmax(t) defines the deposits of respiratory waves caused by dynamic influence of sympathetic and parasympathetic divisions of autonomic nervous system (ANS) during transient periods.Double wavelet transformation is performed to analyze non-stationary signal νHRmax(t). The DCWT skeletons and spectral integrals Eμ(t) in the ranges μ={ULF, VLF, LF, HF}, which carry out the signal filtration by summarizing the deposits of local spectral density ɛ(ν, t) only in certain frequency interval, are found.The oscillation frequency of νHRmax(t) against the trend, which shows various scenarios of oscillation rearrangement for complex frequency modulated rhythmogram, is studied extensively.The duration of transient periods is calculated while studying the increasing dynamics of low-frequency spectral integrals EULF(t).For the real medical data (head up tilt test record), characteristic times τLF≈25ms and τHF≈11ms, corresponding to the rise and fall of ELF(t) and EHF(t), are found. The analysis indicates a strong nonstationarity in the spectral properties of the rhythmogram signal during the head up tilt table test.The advantage of double CWT method proposed in the paper is that it provides the tool to study the dynamics of growth and decay of low-frequency spectral components for μ={ULF, VLF, LF, HF}. Using this method we have obtained such characteristics of nonstationarity in the HRV signal as the time periods, when the oscillations against the main trend appear or disappear, as well as the durations of transient processes. In our opinion, it is just the main feature and the advantage of the method, when comparing it with others. The calculations have been done both for the mathematical model of a frequency modulated signal and for the record during real the head up tilt test. We should add that in medical practice this approach permits to avoid long-lasting visual evaluation of a rhythmogram at Holter monitoring.The method proposed in this paper can be applied to the quantitative description of cardiac arrhythmias and also for the analysis of cardiac rhythm turbulence associated with ectopic beats.