@&#MAIN-TITLE@&#
Speech energy redistribution for intelligibility improvement in noise based on a perceptual distortion measure

@&#HIGHLIGHTS@&#
An algorithm is presented to improve speech intelligibility for the near-end listener.Speech energy is redistributed optimally for a perceptual distortion measure.An intelligibility listening test is performed to evaluate the proposed method.The algorithm leads to significant intelligibility gains, while preserving quality.A reference method obtained higher intelligibility gains, with a decrease in quality.

@&#KEYPHRASES@&#
Near-end speech enhancement,Intelligibility improvement,Transients,

@&#ABSTRACT@&#
A speech pre-processing algorithm is presented that improves the speech intelligibility in noise for the near-end listener. The algorithm improves intelligibility by optimally redistributing the speech energy over time and frequency according to a perceptual distortion measure, which is based on a spectro-temporal auditory model. Since this auditory model takes into account short-time information, transients will receive more amplification than stationary vowels, which has been shown to be beneficial for intelligibility of speech in noise. The proposed method is compared to unprocessed speech and two reference methods using an intelligibility listening test. Results show that the proposed method leads to significant intelligibility gains while still preserving quality. Although one of the methods used as a reference obtained higher intelligibility gains, this happened at the cost of decreased quality. Matlab code is provided.

@&#INTRODUCTION@&#
Speech intelligibility for the near-end listener can be affected by background noise from both sides of the communication channel (see Fig. 1). That is, the noise can come from both the far-end and the near-end. In order to eliminate the negative impact of the far-end noise, one would typically apply a single-channel noise-reduction algorithm (see, for example, Hendriks et al., 2013; Loizou, 2007 for an overview). However, the speech can also be pre-processed before playback in order to become more intelligible in presence of the near-end background noise, which is the focus of this work. Here we assume that a clean recording of the speech is available and that the far-end noise is successfully removed with noise-reduction. A relevant application would be a train-station where the intelligibility of an announcement is degraded by a passing train. To improve the speech intelligibility in a noisy environment, one obvious solution would be to increase the level of the speech. However, at a certain point increasing the playback level may not be possible anymore due to loudspeaker limitations. Moreover, unpleasant playback levels may be reached which are close to the threshold of pain. An alternative approach would be to fix the speech energy and redistribute energy within the speech signal over time and/or frequency.One straightforward and effective approach for improving intelligibility of speech in noise is by boosting high frequencies at a cost of lower frequencies. For example, Griffiths (1968) concluded already in 1968 that the long-term average speech spectrum should be ‘whitened’, which effectively results in a strong amplification of high frequencies. Positive effects of high-pass-filtering were also found in Griffiths (1968), Niederjohn and Grotelueschen (1976), Hall and Flanagan (2010), Skowronski and Harris (2006). To further gain intelligibility improvements, linear filtering was combined with dynamic range compression by Niederjohn and Grotelueschen (1976). Also dynamic range compression without any form of high-pass filtering was found to improve speech intelligibility in noise (Rhebergen et al., 2009).Other approaches are based on the fact that transient-like parts of speech signals, e.g., consonants, play an important role in speech intelligibility. For example, Strange et al. (1983) showed that the center vowel in CVC words is almost fully understandable based on the preceding and succeeding consonant only. Unfortunately, the energy of consonants is relatively low compared to vowels and therefore, despite their importance, more vulnerable to noise. In line with these findings are the experiments from Gordon-Salant (1986) and Hazan and Simpson (1998), which found significant intelligibility improvements in noise for normal-hearing listeners by amplifying hand-annotated consonants. Similar results were found with hearing-impaired listeners (Kennedy et al., 1998). To use these principles in a practical application several methods are also available that automatically modify the vowel-consonant energy ratio, e.g., (Skowronski and Harris, 2006; Huang et al., 2009; Jayan et al., 2008; Yoo et al., 2007).Most of the high-frequency boosting and transient-detection methods are noise-independent, while noise-statistics maybe available in an application scenario as illustrated in Fig. 1. Sauert and Vary therefore proposed several algorithms, which do take into account the noise statistics (e.g. Sauert et al., 2006; Sauert and Vary, 2010a), to further improve intelligibility. These methods improve objective speech intelligibility as predicted by the speech intelligibility index (SII) (ANSI, 1997). Similar work based on the SII has been done more recently by Taal et al. (2013). Other methods exploiting noise statistics are, for example, based on the masking effects of the auditory system (Brouckxon et al., 2008) or a loudness perception model (Shin and Kim, 2007). Tang and Cooke investigated several strategies where energy is relocated based on local SNRs (Tang and Cooke, 2010, 2011). Best results were obtained with a strategy where only the high frequency regions (1800–7500) were amplified, when a local SNR <5dB was observed.In this work we propose a new method where speech energy is redistributed over time and/or frequency as a function of the near-end noise statistics, based on a perceptual distortion measure. The time-span over which energy is redistributed is flexible, such that the method can be used in both low-delay applications and applications where a higher delay is tolerated. As we will show, speech intelligibility can be further improved when more delay is allowed in the system. The results we present in this article extend existing work due to several reasons: (1) the considered perceptual distortion measure (Taal and Heusdens, 2009; Taal et al., 2012) (see Section 2.1) takes into account short-time information, which results in a higher sensitivity to transient regions compared to spectral-only models as in Brouckxon et al. (2008), Shin and Kim (2007), Sauert et al. (2006), Sauert and Vary (2010a). When a delay is tolerated in the system, the proposed method will therefore automatically distribute energy from vowels to transients as a function of the noise statistics. (2) An analytic solution is provided to optimally redistribute speech energy relevant for the perceptual distortion measure subject to a power constraint. This is different from the majority of algorithms (with the exception of Griffiths, 1968; Sauert and Vary, 2010b), which instead normalize the speech signal heuristically after processing which may result in suboptimal solutions. (3) Some algorithms are very effective in improving intelligibility of speech in noise, while they may have poor speech quality (pleasantness or naturalness of speech). For example, aggressive amplitude compression (Niederjohn and Grotelueschen, 1976) results in very unnatural speech but the SNR can be lowered down to 15dB while preserving intelligibility. The proposed method improves speech intelligibility while preserving speech quality.The remainder of this article is organized as follows. First, we will explain the proposed algorithm and the used perceptual distortion measure in Section 2, followed by an evaluation and comparison of other reference methods in Section 3. Finally, in Section 4, a discussion is provided followed by conclusions.Let x denote a time-domain speech signal and x+ɛ a noisy version, where ɛ represents the far-end background noise. We assume that in isolation, x is fully intelligible and that far-end noise is either absent or successfully removed by a single-channel noise reduction algorithm. The distortion measure considered in this work, denoted byDx,ɛ, will inform us about the audibility of ɛ in the presence of x. Hence, a lower D value implies less audible noise and therefore more audible speech. Our goal is to adjust the speech signal x such thatDx,ɛis minimized subject to the constraint that the energy of the modified speech remains unchanged. First, in Section 2.1, more details will be given about the considered distortion measure, after which in Section 2.2 we will formalize and solve the constrained optimization problem. Section 2.3 will describe several implementation details, where in Section 2.4 some properties of the algorithm are revealed.The perceptual distortion measure is based on the work from Taal and Heusdens (2009), Taal et al. (2012). There are three important motivations why this particular distortion measure is used. (1) The measure takes into account a spectro-temporal auditory model and therefore also considers the temporal envelope within a short-time frame (20–40ms). As a consequence, the distortion measure is more sensitive to transients than spectral-only models, e.g., as used in (Sauert et al., 2006; Sauert and Vary, 2010a). (2) The measure fulfills certain mathematical properties, which makes it possible to derive an analytic solution in the eventual constrained optimization problem (see Section 2.2) and (3) the measure correlates well with the intelligibility of speech in noise (Taal et al., 2009).To guide the reader, we give a brief summary of the perceptual distortion measure presented in Taal et al. (2012). The basic structure for the distortion measure is shown in Fig. 2. First, a time–frequency (TF) decomposition is performed on the speech and noise by segmentation into short-time (32ms), 50% overlapping square-root Hann-windowed frames. Then, a simple auditory model is applied to each short-time frame, which consists of an auditory filter bank followed by the absolute squared and low-pass filtering per band, in order to extract a temporal envelope. Here, the filter bank resembles the properties of the basilar membrane in the cochlea, while the envelope extraction stage is used as a crude model of the hair-cell transduction in the auditory system.Let hidenote the impulse response of the ith auditory filter and xmthe mth short-time frame of the clean speech. The output of their linear convolution at time sample n is denoted by xi,m(n)=(xm*hi)(n). Subsequently, the temporal envelope is defined by (|xm,i|2*hs)(n), where hsrepresents the smoothing low-pass filter. Similar definitions hold for (|ɛm,i|2*hs)(n). The audibility of the noise in presence of the speech, within one TF-unit, is determined by a per-sample noise-to-signal ratio (Taal and Heusdens, 2009). By summing these ratios over time, an intermediate distortion measure for one TF-unit is obtained denoted by lower-case d. That is,(1)d(xm,i,ɛm,i)=∑n(|ɛm,i|2*hs)(n)(|xm,i|2*hs)(n),where n denotes the time index running over all samples within one short-time frame. To prevent divisions by very small numbers only speech-active regions are considered in the eventual algorithm (see Section 2.2 for more details). As an example, internal representations within one auditory filter are shown in Fig. 2 for a windowed noise realization ɛmand a speech transient xm. Also, the point-wise division in Eq. (1) of the internal representations before summation over n is shown in the figure. Due to the fact that the measure uses a per-sample (16kHz) rather than a frame-based noise-to-signal ratio, the measure is sensitive to the short-temporal structure. Note that the cutoff frequency of the low-pass filter hsdetermines the sensitivity of the model toward temporal fluctuations within a short-time frame.The distortion measure for the complete signal is then obtained by summing all the individual distortion outcomes over time and frequency, which gives,(2)D(x,ɛ)=∑m,id(xm,i,ɛm,i).To improve the speech audibility in noise, we minimize Eq. (2) by applying a TF-dependent gain function α which redistributes the speech energy by scaling of the individual (perceptually) filtered frames, i.e., αm,ixm,i, where αm,i≥0. Only TF-units are modified where speech is present. This is done in order to prevent that a large amount of energy would be redistributed to speech-absent regions. We consider a TF-unit to be speech-active when its energy is within a 25dB range of the TF-unit with maximum energy within that particular frequency band. Note that with the near-end speech enhancement application the clean speech is available and voice activity detection is a relatively easy process (in contrast to the detection of speech already corrupted by noise). The TF-description of the noise is assumed to be a stochastic process denoted byEm,iand the speech deterministic (recall that the speech signal is known in the near-end enhancement application). Hence, we minimize for the expected value of the distortion measure. LetLdenote the set of speech-active TF-units and·the ℓ2-norm, the problem can then be formalized as follows, which has to be solved for∀αm,i,{m,i}∈L,(3)αm,i=argminαm,i,{m,i}∈L∑{m,i}∈LEd(αm,ixm,i,ɛm,i)s.t.∑{m,i}∈Lαm,ixm,i2=r,wherer=∑m,i∈Lxm,i2is the total power measured at the output of the auditory filters and E denotes the expected value. Two important reasons exist for fixing the speech energy r rather than any other constraint, for example, based on loudness: (1) typically, algorithms are compared with a listening test by fixing the SNR for which the used global energy constraint is optimal.11Since the gammatone filters are not perfectly orthogonal (e.g., as in a Fourier transform), the energy of the signal waveform is not mathematically equal to the energy measured at the output of the auditory filters. However, these differences due to the non-orthogonal gammatone filters are relatively small and are a good approximation of the actual energies used in determining the SNR at the waveform level.(2) The used constraint is mathematical tractable in contrast to complex loudness models for which closed-form solutions may not exist, resulting in suboptimal and computational demanding methods, e.g., as in Shin and Kim (2007).Let λ denote a Lagrangian multiplier such that we can introduce the following cost function,(4)J=∑m,i∈LEd(αm,ixm,i,Em,i)+λ∑{m,i}∈Lαm,ixm,i2−r.Due to the linearity of the convolution in Eq. (1) and the assumption that α≥0 we have thatdαx,y=dx,y/α2. Therefore, in order to minimize Eq. (4), we have to solve the following set of equations for α,(5)∂J∂αm,i=−2E[d(xm,i,Em,i)]αm,i3+λ2αm,ixm,i2=0∂J∂λ=∑m,i∈Lαm,i2xm,i2−r=0The solution is given by,(6)αm,i2=rβm,i2∑m′,i′∈Lβm′,i′2xm′,i′2,where,(7)βm,i=E[d(xm,i,Em,i)]xm,i21/4.In order to determine α, we have to compute the expected valueE[d(xm,i,Em,i)], which can be expressed as follows,(8)E[d(xm,i,Em,i)]=∑n(E[|Em,i|2]*hs)(n)(|xm,i|2*hs)(n),Here we used the linearity of the convolution and the summation in order to move the expected value operator inside the distortion measure. To simplify, we assume that the power-spectral density of the noise within the frequency range of an (relatively narrow) auditory band is constant, i.e., has a ‘flat’ spectrum. As a consequence, the noise within an auditory band can be modeled byEm,i=(wmNm,i)*hi, wherewmdenotes the window function and Nm,irepresents a zero mean, i.i.d. stochastic process with varianceE[Nm,i2(n)]=σm,i2,∀n. By combining this statistical model and the numerator of Eq. (8) we have,(9)E[|Em,i|2(n)]=E[|∑khi(k)wm(n−k)Nm,i(n−k)|2]=∑khi2(k)wm2(n−k)E[Nm,i2(n−k)]=(hi2*wm2)(n)σm,i2.wherehi2*wm2can be calculated offline and reused, andσm,i2can be estimated with any noise power spectral density (PSD) estimator from the field of single-channel speech enhancement (Loizou, 2007) (see next section for more details). Here we use the method from Hendriks et al. (2010).

@&#CONCLUSIONS@&#
A speech pre-processing algorithm is presented to improve the speech intelligibility in noise for the near-end listener without modifying the speech energy. This was accomplished by optimally redistributing the speech energy over time and frequency based on a perceptual distortion measure. Due to the fact that the distortion measure takes into account short-time information, transient signals, which are more important for speech intelligibility than vowels, receive more amplification. The lookahead of the algorithm can be adjusted to the specific application. To verify the effect of this, two extreme versions of the proposed method were considered: one with maximum lookahead, where energy is distributed over time and frequency jointly for a complete sentence (PROP1), and one with minimum lookahead where energy is redistributed over frequency within a short-time frame (PROP2). From the results we can conclude that the proposed methods result in a large intelligibility improvement compared to the noisy unprocessed speech. PROP1 performed better than PROP2 due to the fact that PROP1 contains a larger time-span, where a better redistribution of energy is possible. However, this results in a larger algorithmic delay. The proposed methods were compared with a method where transients were amplified (ERVU) and a method that redistributes energy over frequency within one short-time frame (SAU). PROP1 and PROP2 resulted in higher intelligibility scores than ERVU. Best performance in terms of speech intelligibility was obtained with SAU. However, additional tests reveal that the good performance of SAU comes with a decrease in speech quality. PROP1 did not have a negative effect on speech quality. Matlab code of PROP1 and PROP2 is provided at http://www.ceestaal.nl/.