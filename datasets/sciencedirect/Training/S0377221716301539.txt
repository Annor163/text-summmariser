@&#MAIN-TITLE@&#
Age-structured linear-state differential games

@&#HIGHLIGHTS@&#
We define the class of linear-state age-structured differential games.For such games, the open-loop Nash equilibria are sub-game perfect.We propose a search scheme to determine open-loop Nash equilibria.We discuss an age-structured advertising model.For such model we prove existence and uniqueness of the OLNE.

@&#KEYPHRASES@&#
Age-structured models,Differential games,Advertising,

@&#ABSTRACT@&#
In this paper we search for conditions on age-structured differential games to make their analysis more tractable. We focus on a class of age-structured differential games which show the features of ordinary linear-state differential games, and we prove that their open-loop Nash equilibria are sub-game perfect. By means of a simple age-structured advertising problem, we provide an application of the theoretical results presented in the paper, and we show how to determine an open-loop Nash equilibrium.

@&#INTRODUCTION@&#
In this paper we want to extend the concept of linear-state differential game to a family of models with age-structured dynamics. In the last few years there has been an increasing number of papers on applications of age-structured optimal control. For an introduction to this topic the reader can consult the book by Grass, Caulkins, Feichtinger, Tragler, and Behrens (2008, Chapter 8, pp. 417–421) or the book by Aniţa, Arnăutu, and Capasso (2011, Chapter 4, pp. 145–184). Moreover, three papers are important for our analysis. Feichtinger, Tragler, and Veliov (2003) introduce a very general set of Pontryagin-type necessary conditions, while Feichtinger, Hartl, Kort, and Veliov (2006) describe the anticipation effect: in age-structured models it is convenient to anticipate an investment flow to take advantage of the age evolution. Finally, Krastev (2013) presents a set of Arrow-type sufficient conditions. This is definitely a non-exhaustive list, but browsing the references in the just mentioned papers the reader can find a variety of different applications in this active research field. On the other hand, only a few applications of these mathematical techniques to differential games have been proposed so far. To the best of our knowledge, one of the first papers on applications of partial differential games is by Roxin (1977), who presents two examples: one on pollution control, the other on competitive fishing. A more technical paper on partial differential games is by Ichikawa (1976), who shows how to study the linear-quadratic differential games when the motion equation is described using a strongly continuous semigroup. Even if this approach is rather technical, the reference may be useful for further research on age-structured differential games. Finally, as far as we know, the most recent application is by Reluga and Li (2013) in the field of mathematical biology.The fact that there are only few applications of age-structured optimal control to differential games is surely due to the complexity that arises in the analysis of the necessary conditions for this kind of models. However, even ordinary differential games are difficult to analyze, so that, in the applications, it is customary to focus on some special families of differential games. Two of them are the linear-quadratic differential gamesEngwerda (2005) and the linear-state differential games (Dockner, Jørgensen, Van Long, and Sorger, 2000, Chapter 7, p. 187). The analysis of these kinds of differential games is mathematically tractable and allows the characterization of strong equilibria: for example it has been proved that an open-loop Nash equilibrium in a linear-state differential game is sub-game perfect (Dockner, Jørgensen, Van Long, and Sorger, 2000, Chapter 7, p. 189).In this paper we define a class of age-structured differential games which has the features of ordinary linear-state differential games. In Section 2 we present a quick review of age-structured optimal control and we introduce a formulation of an age-structured differential game. In Section 3 we introduce the linear-state formulation of an age-structured differential game and we show that it is the right formulation, because we can prove the sub-game perfectness of the open-loop Nash equilibria. In Section 4 we describe a very simple advertising model with age-structured dynamics which is useful to show how to characterize an open-loop Nash equilibrium.First of all we present a formal definition of an age-structured optimal control problem. We inform the readers that the material introduced in this subsection is presented to make the paper self-contained and is taken from the seminal work by Feichtinger et al. (2003).Definition 1An age-structured optimal control problem is defined by stating an objective functional to maximize(1)maxu(t,a)∈U,v(t)∈V{J(u(t,a),v(t))=∫0T∫0ωL(t,a,y(t,a),p(t,a),u(t,a))dadt+∫0ωℓ(a,y(T,a))da+∫0TL(t,q(t),v(t))dt},subject to a motion PDE(2)(∂t+∂a)y(t,a)=f(t,a,y(t,a),p(t,a),q(t),u(t,a)),y(0,a)=y0(a),y(t,0)=k(t,q(t),v(t)),where the non-local variables p(t, a) and q(t) are defined as follows:(3)p(t,a)=∫0ωg(t,a,σ,y(t,σ),u(t,σ))dσ,q(t)=∫0ωh(t,σ,y(t,σ),u(t,σ))dσ.A feasible control u(t, a) is an element of the set of the measurable and essentially bounded functions L∞([0, T] × [0, ω]; U) where U is a compact subset ofR; a feasible control v(t) belongs to L∞([0, T]; V) where V is a compact and convex subset ofR. Given a couple of feasible controls (u(t, a), v(t)) there exists a unique state functiony(t,a)∈L∞([0,T]×[0,ω];R)which satisfies (2) and (3). The couple of feasible controls (u*(t, a), v*(t)) is optimal if and only ifJ(u*(t,a),v*(t,a))≥J(u(t,a),v(t,a))for all couples of feasible controls (u(t, a), v(t, a)).In this definition we are assuming that the functionsL,ℓ,L,f,g,h,kare measurable with respect to the variables t, a, σ, continuous with respect to the remaining variables, locally essentially bounded, and differentiable w.r.t. y, p, q, u, v. Moreover, the partial derivatives are measurable w.r.t. t, a, σ, continuous w.r.t. the remaining variables, and locally essentially bounded. For further details on the analytical setting we refer to the seminal paper by Feichtinger et al. (2003) where the Pontryagin-like necessary conditions are introduced. The idea behind this formulation is the following: the decision-maker wants to control the evolution of the PDE in the set [0, T] × [0, ω]; the first variable t ∈ [0, T] represents the time (the programming horizon is finite, T > 0), while the second variable a ∈ [0, ω] represents the age (ω > 0 is the maximum age we take into account). The quantity y(t, a) is the value of the state function at the time t for the “class” of age a. Time and age evolve together; the motion equation describing the state variable evolution in time and age is a linear PDE. In the two segments {0} × [0, ω] and [0, T] × {0} we define the boundary conditions as follows: at the timet=0the value of the state function is known for all a ∈ [0, ω] and it is given by the function y0(a); while at each time t the value of the state function for the agea=0is given in an implicit way. This value is defined using the equationy(t,0)=k(t,q(t),v(t))where v(t) is a control, while q(t) is a “non-local” variable that depends on the shapes of the state and control functions along the segment {t} × (0, ω]. A clarifying example is provided in the field of population dynamics, where y(t, a) represents the number of people of age a at the time t. In this kind of model the number of newborns at a given time (i.e. y(t, 0)) depends on the age distribution of the population at that time (to explore this topic we suggest the interesting paper written by Simon, Skritek, and Veliov, 2013 and the references therein). The non-local variable q(t) is present also in the motion equation. In order to describe a different phenomenon another non-local variable p(t, a) is defined. This variable represents the influence of the “age-class” σ on the “age-class” a at a given fixed time t. In our opinion, an application that clearly explains the meaning of this non-local variable in the context of drug initiation is by Almeder, Caulkins, Feichtinger, and Tragler (2004). In this model y(t, a) represents the number of non-drug-users. At a fixed time t, for all σ ∈ [0, ω], the number of non-drug-users in the age-class σ (i.e. y(t, σ)) can influence the evolution of y(t, a) because of reputation interactions among different age groups.The decision maker chooses the control functions u(t, a) and v(t) in order to maximize the objective functional (1). This is the sum of three terms: the first one depends on the values of the state and control functions on their whole domain [0, T] × [0, ω]; the second term depends on the values of the state function in the final segment {T} × [0, ω]; finally, the third term depends on the values of the state and control functions through the synthesis along the segment {t} × (0, ω] provided by the function q(t).The formulation of the problem in Definition 1 is less general than other formulations considered in literature, as we assume that the initial value for the state function y(t, a) is given a priori (it does not depend on further control), and that the quantity q(t) is defined explicitly ( the function h does not depend on p or q). This clarifies the presentation and makes the analytical setting simpler.Given the optimal control problem introduced in Definition 1, we define the distributed Hamiltonian(4)H(t,a,y,p,q,u,λ,η(t,σ),ζ)=L(t,a,y,p,q,u)+λf(t,a,y,p,q,u)+∫0ωη(t,σ)g(t,a,σ,y,u)dσ+ζh(t,a,y,u)and the boundary Hamiltonian(5)Hb(t,q,v,λ(t,0))=L(t,q,v)+λ(t,0)k(t,q,v).Moreover, we define the adjoint variables as follows: λ(t, a) satisfies(6)(∂t+∂a)λ(t,a)=−∂yH(t,a,y(t,a),p(t,a),q(t),u(t,a),λ(t,a),η(t,σ),ζ(t)),λ(t,ω)=0,λ(T,a)=∂yℓ(a,y(T,a)),while η(t, a) and ζ(t) are defined explicitly by the equations:(7)η(t,a)=∂pH(t,a,y(t,a),p(t,a),q(t),u(t,a),λ(t,a),η(t,a),ζ(t)),ζ(t)=∂qHb(t,q(t),v(t),λ(t,0))+∫0ω∂qH(t,a,y(t,a),p(t,a),q(t),u(t,a),λ(t,a),η(t,a),ζ(t))da.We observe that, under our assumptions, Eq. (7) defines the quantities η(t, a) and ζ(t) explicitly, as the functions ∂qH and ∂pH do not depend on the two variables η and ζ. The assumptions introduced after Definition 1 allow us to apply the necessary conditions for optimality described by Feichtinger et al. (2003) and recalled by Krastev (2013).Theorem 1Necessary conditionsLet (u*(t, a), v*(t)) be an optimal couple of controls for the age-structured problem(1)–(3)and let y*(t, a) be the state function associated with that couple of controls. We denote by p*(t, a) and q*(t) the quantities associated with this optimal solution by(3). Then there existλ(t,a)∈L∞([0,T]×[0,ω];R),η(t,a)∈L∞([0,T]×[0,ω];R),andζ(t)∈L∞([0,T];R)that solve(6)and(7), and moreover the following relations holdu*(t,a)∈argmaxu∈UH(t,a,y*(t,a),p*(t,a),q*(t),u,λ(t,a),η(t,a),ζ(t)),v*(t)∈argmaxv∈VHb(t,q*(t),v,λ(t,0)).See Feichtinger et al. (2003) for the original version of the necessary conditions and see Krastev (2013) for the equivalent version used in this paper.□Let (u*(t, a), v*(t)) be a couple of feasible controls for the age-structured optimal control problem(1)–(3). Let us assume that these controls satisfy the necessary conditions described in Theorem 1 and let us define the maximized distributed Hamiltonian as follows:(8)H*(t,a,y,p,q,λ,η(t,σ),ζ)=maxu∈UH(t,a,y,p,q,u,λ,η(t,σ),ζ).Furthermore, let us assume that•U and V are convex sets,H*(t, a, y, p, q, λ, η(t, σ), ζ) is jointly concave with respect to y, p, q for all values of the other variables,Hb(t, q, v, λ(t, 0)) is jointly concave with respect to q, v for all values of the other variables,ℓ(a, y) is concave in y for all a,then (u*(t, a), v*(t)) is optimal for(1)–(3).See Krastev (2013).□Here we present a formal definition of a two-player age-structured differential game.Definition 2A two-player, non-cooperative, age-structured differential game is defined by stating, fori=1,2,an objective functional to maximize(9)maxui(t,a)∈Ui,vi(t)∈Vi{Ji(ui(t,a),vi(t),uj(t,a),vj(t))=∫0T∫0ωLi(t,a,y(t,a),p(t,a),u1(t,a),u2(t,a))dadt+∫0ωℓi(a,y(T,a))da+∫0TLi(t,q(t),v1(t),v2(t))dt},wherej≠i,subject to a motion PDE(10)(∂t+∂a)y(t,a)=f(t,a,y(t,a),p(t,a),q(t),u1(t,a),u2(t,a)),y(0,a)=y0(a),y(t,0)=k(t,q(t),v1(t),v2(t)),where the non-local variables p(t, a) and q(t) are defined as follows:(11)p(t,a)=∫0ωg(t,a,σ,y(t,σ),u1(t,σ),u2(t,σ))dσ,q(t)=∫0ωh(t,σ,y(t,σ),u1(t,σ),u2(t,σ))dσ.A player i’s feasible control ui(t, a) is an element of the set of the measurable and essentially bounded functions L∞([0, T] × [0, ω]; Ui) where Uiis a compact subset ofR; a player i’s feasible control vi(t) belongs to L∞([0, T]; Vi) where Viis a compact and convex subset ofR. Given a pair of feasible controls((u1*(t,a),v1*(t)),(u2*(t,a),v2*(t)))there exists a unique11We are assuming the same hypotheses on the functionsL,ℓ,L,f,g,h,kalready introduced after Definition 1.state functiony(t,a)∈L∞([0,T]×[0,ω];R)which satisfies (10) and (11).We define now the open-loop Nash equilibrium.Definition 3A pair of feasible controls((u1*(t,a),v1*(t)),(u2*(t,a),v2*(t)))for the two-player, non-cooperative, age-structured differential game (9), (10), (11) is an Open-Loop Nash Equilibrium (OLNE for short) if and only if for all i, j ∈ {1, 2},i≠j,and for all feasible controls (ui(t, a), vi(t)) ∈ L∞([0, T] × [0, ω]; Ui) × L∞([0, T]; Vi), the following inequalities holdJi(ui*(t,a),vi*(t),uj*(t,a),vj*(t))≥Ji(ui(t,a),vi(t),uj*(t,a),vj*(t)).This definition is consistent with the similar ones presented in the books by Dockner et al. (2000, Chapter 4, p. 86) and by Haurie, Krawczyk, and Zaccour (2012, Chapter 7, p. 247). The necessary conditions for an open-loop Nash equilibrium lead us to study a system of nonlinear-integro-partial differential equations. To the best of our knowledge, this problem can only be tackled using numerical methods. However, in theoretical models, it is often important to obtain a closed form solution. In ordinary differential games, where the necessary conditions have a lower complexity, two common families of models are introduced in order to obtain an analytically tractable system of conditions. The family of linear-quadratic differential games is illustrated for example in the book by Dockner et al. (2000, Chapter 7, p. 170) and in the book by Engwerda (2005). The family of linear-state differential games is presented in the book by Dockner et al. (2000, Chapter 7, p. 187) in the book by Haurie et al. (2012, Chapter 7, p. 262), and in the clear paper by Jørgensen, Martín-Herrán, and Zaccour (2010).The main features of the linear-state differential games are the following:•the optimal strategies do not depend on the state;the adjoint equations are decoupled from the motion equations.The importance of these features is described in several papers and books, for example in Dockner et al. (2000, Section 7.2, p. 187) and Haurie et al. (2012, p. 262). In our personal opinion, the clearest reference for this topic is the paper by Jørgensen et al. (2010). If the two features just outlined occur, we can solve the problem using the following procedure: solve the adjoint equations, characterize the optimal strategies, and find the optimal state function.In Sections 3 and 4 we will study the features of such linear-state differential games in age-structured problems. In the remaining part of this section we propose an example of a differentiable game with age-structure as of Definition 2. In such example we implement an elementary approach to extend the linear-state structure to model (9)–(11), by assuming that all the data are affine functions in the state y and additively separable in y and (u1, u2), so that there is no multiplicative interaction between the state and the control variables as required in Dockner et al. (2000, Chapter 7, p. 188). Such features are a natural requirement, albeit insufficient, towards the definition of a tractable class of differentiable games with age-structure. Unfortunately, they cannot guarantee that the procedure “solve adjoint equations, characterize optimal strategies, find optimal state” really works. The obstacles are due to the presence of a non-local variable that introduces an indirect link between the state and its adjoint function. This observation paves the way to the assumptions of Section 3. The reader may well skip the example and go on to the next section, if he simply wants to see our definition of linear-state age-structured differential game.Example 1Let us consider the following symmetric age-structured differential game(12)maxui(t,a)∈U{∫0T∫0ω−12ui2(t,a)dadt+∫0ωy(T,a)da},(∂t+∂a)y(t,a)=q(t)(u1(t,a)+u2(t,a)),q(t)=∫0ωy(t,σ)dσ,y(0,a)=0,y(t,0)=q(t).We notice that all the functions are linear in the state. The distributed Hamiltonian for the player i(13)Hi(t,a,y,p,q,u1,u2,λ1,λ2,ζ1,ζ2)=−ui2/2+λiq(u1+u2)+ζiyand the boundary Hamiltonian(14)Hib(t,q,v1,v2,λ1(t,0),λ2(t,0))=λi(t,0)qare both linear functions of the state. We notice that maximizing the Hamiltonian of player i we obtain(15)ui*(t,a)=λi(t,a)q(t),where the adjoint variables are defined as follows:(16)(∂t+∂a)λi(t,a)=−ζi(t),λi(t,ω)=0,λi(T,a)=1.The variables ζi(t) are explicitly defined by the equations:(17)ζi(t)=λi(t,0)+∫0ωλi(t,a)(u1(t,a)+u2(t,a))da.Putting together all this information, we obtain that(18)(∂t+∂a)λi(t,a)=−λi(t,0)−q(t)∫0ωλi(t,a)(λ1(t,a)+λ2(t,a))daand this shows that the adjoint equation is coupled with the motion equations by the presence of the non-local variable q(t). This definitely destroys the fundamental idea behind the linear-state structure of a differential game.We need a definition of a special class of age-structured differential games to obtain the analytical features that characterize the ordinary linear-state differential games. The basic idea comes from observing the form of the necessary conditions: if we want to decouple the motion from the adjoint equations, we have to assume the linearity of the data functions both in the state variable and in the non-local variables. According to this intuition, we present the following definition:Definition 4Let us consider the two-player non-cooperative age-structured differential game (9)–(11); we call it linear-state if the data functions are affine (linear) functions of the state y and of the non-local variables p, q, and additively separable in (y, p, q) and (u1, u2, v1, v2), i.e. if for all i, j ∈ {1, 2},(19)Li(t,a,y,p,u1,u2)=L¯i(t,a)y+L˜i(t,a)p+L^i(t,a,u1,u2),ℓi(a,y)=ℓ¯i(a)y+ℓ˜i(a),Li(t,q,v1,v2)=Lˇi(t)q+L^i(t,v1,v2),f(t,a,y,p,q,u1,u2)=f¯(t,a)y+f˜(t,a)p+fˇ(t,a)q+f^(t,a,u1,u2),g(t,a,σ,y,u1,u2)=g¯(t,a,σ)y+g^(t,a,σ,u1,u2),h(t,σ,y,u1,u2)=h¯(t,σ)y+h^(t,σ,u1,u2),k(t,q,v1,v2)=kˇ(t)q+k^1(t)v1+k^2(t)v2.In order to show that this definition is the right one, we observe some of its consequences. In the following result we prove that an Open-Loop Nash Equilibrium (OLNE) for a linear-state age-structured differential game is sub-game perfect, as defined in Dockner et al. (2000, Chapter 4, p. 102). Roughly speaking, if we restrict the game to a subinterval [τ, T] for all τ ∈ [0, T), then the previous OLNE still remains a valid OLNE. This result has a twofold outcome. First of all, we show that the necessary conditions for an OLNE lead to an adjoint equation which is decoupled from the motion equation. Secondly, we prove that the linear-state assumption implies sub-game perfectness even when the motion equation is age-structured. The latter is a standard result for ordinary linear-state differential games as shown in Dockner et al. (2000, Chapter 7, p. 188), and it is important because it gives “stability” to the equilibrium.Theorem 3Let((u1*(t,a),v1*(t)),(u2*(t,a),v2*(t)))be an open-loop Nash equilibrium for the linear-state age-structured differential game(9)–(11)and(19); if  Ui and Vi are convex sets andL^i(t,v1,v2)is jointly concave in (v1, v2) for all t ∈ [0, T], then the equilibrium is sub-game perfect.If((u1*(t,a),v1*(t)),(u2*(t,a),v2*(t)))is a Nash equilibrium, then it satisfies the necessary conditions for the control problems of both players.Player i’s distributed Hamiltonian isHi(t,a,y,p,q,u1,u2,λi,ηi(t,σ),ζi)=L¯i(t,a)y+L˜i(t,a)p+L^i(t,a,u1,u2)+λi(f¯(t,a)y+f˜(t,a)p+fˇ(t,a)q+f^(t,a,u1,u2))+∫0ωηi(t,σ)(g¯(t,a,σ)y+g^(t,a,σ,u1,u2))dσ+ζi(h¯(t,a)y+h^(t,a,u1,u2)),while the boundary Hamiltonian isHib(t,q,v1,v2,λi(t,0))=Lˇi(t)q+L^i(t,v1,v2)+λi(t,0)×(kˇ(t)q+k^1(t)v1+k^2(t)v2).By the necessary conditions (see Theorem 1), there exist λi(t, a), ηi(t, a), ζi(t) that solve the following integro-partial-differential equation(∂t+∂a)λi(t,a)=−L¯i(t,a)−λi(t,a)f¯(t,a)−∫0ωηi(t,σ)g¯(t,a,σ)dσ−ζi(t)h¯(t,a),λi(t,ω)=0,λi(T,a)=ℓ¯i(a),where ηi(t, a) and ζi(t) areηi(t,a)=L˜i(t,a)+λi(t,a)f˜(t,a),ζi(t)=Lˇi(t)+λi(t,0)kˇ(t)+∫0ωλi(t,a)fˇ(t,a)da.Moreoveru1*(t,a)=argmaxu1∈U1{L^1(t,a,u1,u2*(t,a))+λ1(t,a)f^(t,a,u1,u2*(t,a))+∫0ωη1(t,σ)g^(t,a,σ,u1,u2*(t,a))dσ+ζ1(t)h^(t,σ,u1,u2*(t,a))},v1*(t)=argmaxv1∈V1{L^1(t,v1,v2*(t))+λ1(t,0)k^1(t)v1},and symmetric equations hold foru2*(t,a)andv2*(t). We can notice thatui*(t,a)andvi*(t)depend on the adjoint variables λi(t, a), ηi(t, σ), ζi(t) only, and, in addition to that, the adjoint integro-PDEs are decoupled from the motion equation. These two observations imply that the optimal controls are independent of the state function, hence the functionsu1*(t,a),v1*(t),u2*(t,a),v2*(t),restricted to the time interval [τ, T], satisfy the necessary conditions for an open-loop Nash equilibrium concerning the same game starting at the time τ from any state yτ(a). These controls satisfy not only the necessary conditions, but also the sufficient ones. By the assumption of Theorem 3, Uiand Viare convex fori=1,2. Moreover, the concavity assumptions required by the sufficient conditions are satisfied too, and to prove it we explicitly write player 1’s maximized distributed Hamiltonian:H1*(t,a,y,p,q,u2,λ1,η1(t,σ),ζ1)=L¯1(t,a)y+L˜1(t,a)p+λ1(f¯(t,a)y+f˜(t,a)p+fˇ(t,a)q)+∫0ωη1(t,σ)g¯(t,a,σ)ydσ+ζ1h¯(t,a)y+maxu1∈U1{L^1(t,a,u1,u2)+λ1f^(t,a,u1,u2)+∫0ωη1(t,σ)g^(t,a,σ,u1,u2)dσ+ζ1h^(t,a,u1,u2)}.We notice that this function is linear in y, p, q, by the assumption (19), hence it is jointly concave in y, p, q. Player 1’s boundary HamiltonianH1b(t,q,v1,v2,λi(t,0))=Lˇ1(t)q+L^1(t,v1,v2)+λ1(t,0)×(kˇ(t)q+k^1(t)v1+k^2(t)v2)is linear in q, by (19), and concave in v1, by the assumption of the theorem, hence it is jointly concave in q, vi. Finally,ℓ1(a,y)=ℓ¯1(a)y+ℓ˜1(a)is linear in y, by (19), hence it is concave in y. The same results hold for player 2. This implies that the restriction of(u1*(t,a),v1*(t),u2*(t,a),v2*(t))to the time interval [τ, T] is an open-loop Nash equilibrium for the game starting at the time τ from any state value yτ(a). This proves that the open-loop Nash equilibrium is sub-game perfect.□Theorem 3 proves that, in a linear-state age-structured differential game, with an additional restriction concerning the control ranges Ui, Viand the functionL^i(t,v1,v2),any OLNE is sub-game perfect. What is still missing in our analysis is a general result about the existence and the uniqueness of an OLNE for this kind of differential games. Unfortunately, we cannot present such a theorem and we think that the analytical form of the problem makes it very difficult to prove a general result on this issue. However, in the following, we suggest a solution search scheme that may be useful to characterize the OLNE using the necessary and sufficient conditions. It is inspired by an analogous scheme proposed by Bressan (2011) for a standard differential game.Let us consider a linear-state age-structured differential game. For the sake of simplicity we assume that the non-local variables p and q cannot be controlled directly by the players, i.e.g^(t,a,σ,u1,u2)=h^(t,a,u1,u2)=0. Moreover, we assume that the players cannot control the value of the state function on the boundary, i.e.k^1(t)=k^2(t)=0.While searching for an OLNE of a linear-state age-structured differential game, we try to perform the following steps.Step 1 Find the best response of player i, by maximizing the distributed Hamiltonian with respect to uiui#(t,a,uj,λi)=argmaxui∈Ui{L^i(t,a,u1,u2)+λif^(t,a,u1,u2)}and by maximizing the boundary Hamiltonian with respect to vivi#(t,vj)=argmaxvi∈ViL^i(t,v1,v2).We assume that the functionsui#(t,a,uj,λi)andvi#(t,vj)are well-defined, although this is a restrictive assumption.Step 2 Find a solution(u1*,u2*,v1*,v2*)of the nonlinear equations systemui=ui#(t,a,uj,λi)∀i,j∈{1,2},i≠j,vi=vi#(t,vj)∀i,j∈{1,2},i≠j.We assume that such a system has a unique solution which leads us to define the functionsui*(t,a,λi,λj),vi*(t),i=1,2. In fact, the uniqueness of the solution is not always guaranteed, nor its existence.Step 3 Solve the following system of two coupled integro-PDEs (with i ∈ {1, 2})(∂t+∂a)y(t,a)=f¯(t,a)y(t,a)+f˜(t,a)p(t,a)+fˇ(t,a)q(t)+λi(t,a)f^(t,a,u1*,u2*),(∂t+∂a)λi(t,a)=−L¯i(t,a)−λi(t,a)f¯(t,a)−∫0ωηi(t,σ)g¯(t,a,σ)dσ−ζi(t)h¯(t,σ),p(t,a)=∫0ωg¯(t,a,σ)y(t,a)dσ,q(t)=∫0ωh¯(t,σ)y(t,σ)dσ,ηi(t,a)=L˜i(t,a)+λi(t,a)f˜(t,a),ζi(t)=Lˇi(t)+λi(t,0)kˇ(t)+∫0ωλi(t,a)fˇ(t,a)da,y(0,a)=y0(a),y(t,0)=k(t)q(t),λi(t,ω)=0,λi(T,a)=ℓ¯i(t).In the following, we assume that we are able to find a unique solution to such system, although this search is a challenging task and it represents the main obstacle in the analysis of a linear-state age-structured differential game.If we can complete the three steps, then we have a unique solution that satisfies all the necessary conditions. The analytical forms of the distributed Hamiltonian and the boundary Hamiltonian in a linear-state age-structured differential game allow us to apply the sufficient conditions, provided that the control ranges Ui, Viare convex and the functionL^i(t,v1,v2)is concave in (v1, v2). Therefore, through this scheme we characterize the unique OLNE.In the following section we apply the scheme to an example and show a case in which we can explicitly perform all the required computations.In this section we illustrate the use of the results we have just obtained, introducing a very simple model based on the papers by Grosset and Viscolani (2005) and by Faggian and Grosset (2013).We assume that two retailers sell the same product to different target markets. The market segmentation is made using the age as a fundamental parameter, hence the goodwill value is described by the state function y(t, a) (see Huang, Leng, and Liang, 2012 for a recent survey about dynamic advertising research, where our approach could be classified as an extention of the classical Nerlove–Arrow model). We denote by ui(t, a) ≥ 0 the advertising flow controlled by retailer i ∈ {1, 2} and directed at the time t towards the segment a. In this kind of models the investment process is irreversible and a negative advertising flow makes no sense. We assume that the goodwill evolution can be described by the following PDE:(20)(∂t+∂a)y(t,a)=−δy(t,a)+u1(t,a)+u2(t,a)+ρu1(t,a)u2(t,a),where δ > 0 is the constant goodwill decay factor. The first term in the r.h.s. of the PDE represents the goodwill decay, the second and third terms are the direct effects of the advertising flows of the two retailers, while the last term represents the interaction effect of the two advertising flows. Withρ=0we have the linear advertising productivity generalization of the Nerlove–Arrow’s model, as often used in cooperative advertising models (see: Jørgensen and Zaccour (2014)) and the age-distributed goodwill, as in Grosset and Viscolani (2005). With ρ > 0, we have a synergy situation with a positive correction to the linear part, as in Prasad and Sethi (2009) and Leitmann and Schmitendorf (1978). With ρ < 0 we have an interference situation with a negative correction to the linear part, which occurs, for example, when the two retailers have dissonant advertising messages; this agrees with the model by Grosset, Roberti, and Viscolani (2011).The revenue flow of retailer i at age a and time t is assumed to be proportional to the goodwill(21)(πi(a)+ξi)y(t,a),with piecewise continuous πi(a) and πi(a) ≥ 0, ξi≥ 0. For example, we can think that retailer i sells his product using two different distribution channels. The first one is an on-line store, where detailed information on the customers is available and retailer i can estimate the marginal revenue of goodwill in each segment a. The second channel is a traditional shop, where only general market information is available and retailer i is not able to profile the customers by age. This assumption means that the total revenue flow for retailer i at time t is(22)∫0ωπi(a)y(t,a)da+ξiq(t),where ω > 0 is the maximum age considered in the market segmentation and(23)q(t)=∫0ωy(t,σ)dσrepresents the global goodwill at the time t. Here, ξiand πi(a) are the uniform and the age-specific parts of the marginal revenue of goodwill y(t, σ), respectively.As frequently done, the advertising cost flow is quadratic for both retailers(24)Ci(a,ui)=κi(a)ui2/2,where the piecewise continuous function κi(a) > 0 describes the cost for retailer i to reach the age-segment a. Finally, we assume that the initial value of the state function is given:y(0,a)=α(a)for all a ∈ [0, ω] and we assume the further boundary conditiony(t,0)=0,i.e. the goodwill for the youngest class of the population is equal to 0.These assumptions lead us to study the following age-structured differential game, where each retailer aims at maximizing his total discounted profit with discount rate r > 0,(25)maxui(t,a)≥0∫0Te−rt×(∫0ω{πi(a)y(t,a)−κi(a)2ui2(t,a)}da+ξiq(t))dt,subject to the motion PDE(26)(∂t+∂a)y(t,a)=−δy(t,a)+u1(t,a)+u2(t,a)+ρu1(t,a)u2(t,a),y(0,a)=α(a),y(t,0)=0,where(27)q(t)=∫0ωy(t,σ)dσ.We apply the solution search scheme presented in Section 3 to the linear-state age-structured differential game (25)–(27).Maximizing the distributed Hamiltonian of retailer i,(28)Hi(t,a,y,u1,u2,λi,ζi)=e−rtπi(a)y−e−rtκi(a)2ui2+λi(−δy+u1+u2+ρu1u2)+ζiy,we obtain that the equilibrium advertising policies of the retailers are given by(29)ui#(t,a,uj,λi)=ertλiκi(a)(1+ρuj),i,j∈{1,2},i≠j,provided that λi≥ 0. We will discuss this condition at the end of Step 3.We have to solve the system(30)ui=ui#(t,a,uj,λi),i,j∈{1,2},i≠j,in the unknowns u1, u2, and we obtain(31)ui*(t,a,λi,λj)=ertλiκj(a)+ρertλjκi(a)κj(a)−ρ2e2rtλjλi,i≠j,provided thatκi(a)κj(a)−ρ2e2rtλjλi>0. We will check this condition at the end of Step 3 when we obtain an explicit form of the adjoint functions.Here we have to characterize the adjoint functions. First of all we notice that(32)ζi(t)=e−rtξi,therefore the adjoint functions λi(t, a) must satisfy the linear PDEs(33)(∂t+∂a)λi(t,a)=δλi(t,a)−e−rtπi(a)−e−rtξi,λi(t,ω)=0,λi(T,a)=0.We notice that the adjoint equations are decoupled from the motion equation. This is exactly what we want to obtain from the linear-state assumption of the model. Now we solve the adjoint PDE and then we characterize the remaining quantities. In order to solve the linear PDE (33), let us introduce the characteristic lineσ(τ)=a′+τ. If λi(t, a) is a solution of the adjoint PDE, we defineΛi(τ)=λi(τ,σ(τ))=λi(τ,a′+τ),which satisfies the linear ODE(34)Λ˙i(τ)=δΛi(τ)−e−rτπi(σ(τ))−e−rτξi,hence(35)Λi(τ)=eδ(τ−θ){∫τθ(πi(σ(s))+ξi)e−rse−δ(s−θ)ds+Λi(θ)}.Now, let (t, a) ∈ [0, T] × [0, ω] be a point in the time-age space and letσ(τ)=a−t+τbe the unique characteristic line which passes through the point (t, a). This characteristic line may either intersect the segment [0, T) × {ω}, or the segment {T} × [0, ω].•If the characteristic line intersects the segment [0, T) × {ω}, then the intersection occurs at the timeθ=ω−a+t∈[0,T)such thatσ(θ)=ω,thereforea−t>ω−T. In this case we have thatΛi(θ)=λi(θ,ω)=0,andΛi(τ)=∫τω−a+t(πi(a−t+s)+ξi)e−rse−δ(s−τ)ds;hence the value of the adjoint function at the point (t, a) isλi(t,a)=Λi(t)=e−rt∫aω(πi(u)+ξi)e−(δ+r)(u−a)du≥0.If the characteristic line intersects the segment {T} × [0, ω], then the final age isσ(T)=a−t+T≤ωand thereforea−t≤ω−T. In this case we have thatΛi(T)=λi(T,σ(T))=0,andΛi(τ)=∫τT(πi(a−t+s)+ξi)e−rse−δ(s−τ)ds;hence the value of the adjoint function at the point (t, a) isλi(t,a)=Λi(t)=e−rt∫aa+T−t(πi(u)+ξi)e−(δ+r)(u−a)du≥0.Finally, recollecting the two parts of the analysis, we obtain that(36)λi(t,a)={e−rt∫aω(πi(u)+ξi)e−(δ+r)(u−a)du,a−t>ω−T,e−rt∫aa+T−t(πi(u)+ξi)e−(δ+r)(u−a)du,a−t≤ω−T.Now we want to check whether our general assumptions are satisfied. The first assumption, λi(t, a) ≥ 0, is satisfied because the integrand function is positive. Ifπ¯i=supa∈[0,ω]πi(a),then(δ+r)ertπ¯i+ξiλi(t,a)≤{1−e−(δ+r)(ω−a),a−t>ω−T,1−e−(δ+r)(T−t),a−t≤ω−T,henceλi(t,a)≤e−rt(π¯i+ξi)/(δ+r). Moreover, ifκ¯i=infa∈[0,ω]κi(a),then, using the previous inequality, we obtain a sufficient conditon for the second assumption:(37)ρ2<κ¯i·κ¯j·(δ+r)2(π¯i+ξi)(π¯j+ξj).If this inequality holds, then we have characterized a unique solution that satisfies the necessary conditions for an OLNE.Finally, we observe that the control ranges are convex sets and the functionsL^i(t,v1,v2)are identically equal to zero in this problem; hence the sufficient conditions hold and the previous solution is really the unique OLNE for the linear-state age-structured differential game (25)–(27). We collect all this information in a proposition.Proposition 1Let us assume that(37)holds, then the strategies(31), where λi(t, a) is substituted by(36), are the unique OLNE for(25)–(27).In Eqs. (30) and (31) we can observe some general features of the equilibrium advertising efforts of the two retailers.We notice that inequality (37) is a sufficient condition for the existence and the uniqueness of an OLNE. If the interaction effect between the two advertising flows is small (i.e. if |ρ| is small), then the differential game admits an equilibrium. On the other hand, if such interaction effect is large (i.e. if |ρ| is large) then the quadratic term in the motion equation ρu1u2 is the predominant one. In particular, when ρ is large and positive, the return on investment in goodwill is greater than the adversing expenditure; hence both optimal advertising strategies diverge and the game does not admit an equilibrium (the quadratic advertising costs cannot balance the advertising effort increment required). In the following we comment on some features of the model due to the different signs of the parameter ρ.Ifρ=0,then each retailer behaves as if they were alone and their advertising effort were unaffected by the other retailer’s decision,(38)ui*(t,a)=ertλi(t,a)κi(a),as in the monopolistic problem treated in Grosset and Viscolani (2005).Ifρ≠0,the relationship between the two retailers is more interesting and we have to consider the sign of ρ:•in the synergy situation, when ρ > 0, each retailer advertises more than in the caseρ=0as they exploit the synergy with the other retailer’s advertising effort;in the interference situation, when ρ < 0, each retailer advertises less, in order to limit the harmful interference of the other retailer’s advertising effort.If we assume thatπ1(a)=η1I[ϑ1,ω](a),with η1 > 0, 0 < ϑ1 < ω, andξ1=0,then retailer 1 observes a demand with constant marginal value of goodwill equal to η1 only from the customers who are older than ϑ1.On the other hand, if we assume that π2(a) ≡ 0 and ξ2 > 0, then there is a segment-constant demand addressed to retailer 2.Substituting the values of the parameters πi(u) and ξiinto Eq. (36), settingν=δ+r,and after some computations, we obtain:λ1(t,a)={e−rt∫aωη1I[ϑ1,ω](u)e−ν(u−a)du,a>ω−T+t,e−rt∫aa+T−tη1I[ϑ1,ω](u)e−ν(u−a)du,a≤ω−T+t,(39)={e−rtη1eνaν−1(e−νmax{a,ϑ1}−e−νω),a>ω−T+t,e−rtη1eνaν−1(e−νmax{a,ϑ1}−e−ν(a+T−t)),a≤ω−T+t,a>ϑ1−T+t,0,a≤ϑ1−T+t,and(40)λ2(t,a)={e−rtξ2(1−e−ν(ω−a))/ν,a>ω−T+t,e−rtξ2(1−e−ν(T−t))/ν,a≤ω−T+t.In the following, we consider some numerical examples of the two-retailer game and we illustrate the results through some plots of the relevant functions.22All the plots are obtained programming the explicit formula (31), (39) and (40) in Wolfram Mathematica 10.1. The file gv2015_a.nb, used to prepare these plots, is attached as supplementary content to this paper.With reference to the notation in this subsection, let us setr=0.02,δ=0.2,ω=80,T=70,ξ2=10,ϑ1=40,η1=20,and let the advertising costs be age-independentκ1(a)=κ2(a)=30,a∈[0,ω].In particular, we want to examine the advertising strategies of the two retailers associated with the different signs of the interaction parameter ρ.The Nash equilibrium advertising strategies of retailers 1 and 2 are plotted in Figs. 1and 2, respectively.The equilibrium advertising flow of the first retailer is decreasing in time for all age-segments. This is due to the presence of the discount factor in the objective function and to the setting of the model in a finite horizon (the advertising flow must vanish at the end of the programming interval). As far as the age-segmentation is concerned, the advertising flow is maximum in the target market [ϑ1, ω]. We can see an anticipation effect: the optimal advertising flow is positive before ϑ1, as already observed in Grosset and Viscolani (2005) and in Faggian and Grosset (2013). Moreover, the equilibrium advertising flow decreases quickly near the maximum age ω: it is not convenient to invest in these segments because they will soon exit the target market.The equilibrium advertising flow of the second retailer is also decreasing in time for all age-segments. Nevertheless, the target market of the second retailer is [0, ω], hence his advertising flow does not exhibit any anticipation effect. As shown in Fig. 1, the advertising flow decreases quickly near the maximum age ω.If we assume thatρ=−0.2,then an interference effect is observed between the advertising efforts. The Nash equilibrium advertising strategies of retailers 1 and 2 are plotted in Figs. 3and 4, respectively.When a negative interaction exists between the advertising flows, we obtain that the equilibrium advertising effort of the first retailer has the same qualitative shape as before, but a smaller magnitude.On the other hand, the equilibrium advertising flow of the second retailer changes both in shape and magnitude with respect to the caseρ=0. The second retailer focuses his advertising flow in the age-segments which do not belong to the target market of the first retailer. In other words, to avoid the negative interference of retailer 1’s advertising actions, the second retailer focuses his advertising flow in the market niche which is not covered by the first retailer.If we assumeρ=0.2,then a synergy effect is observed between advertising efforts. The Nash equilibrium advertising strategies of retailers 1 and 2 are plotted in Figs. 5and 6, respectively.In the case of advertising synergy, both retailers focus their equilibrium advertising flows in the target market of the first retailer, in order to obtain the maximum profit from their investment by exploiting the synergy effect.The same results apply to the case where both retailers have an age-specific marginal revenue.33All computations are described in the Mathematica notebook gv2015_b.nb attached as supplementary content to this paper.If a negative interference effect is observed between the two advertising efforts, then each retailer concentrates his advertising flow mainly in the market niche which is not covered by the competitor. On the other hand, if an advertising synergy is observed, then both retailers address their advertising efforts mainly to the intersection of the spectra of the two marginal revenue functions.

@&#CONCLUSIONS@&#
