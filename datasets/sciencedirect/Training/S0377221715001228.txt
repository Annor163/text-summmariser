@&#MAIN-TITLE@&#
The economic lot-sizing problem with perishable items and consumption order preference

@&#HIGHLIGHTS@&#
Introduction of an ELS model accounting for perishability (ELS-PI).Analysis of ELS-PI under FEFO, LEFO, LIFO, FIFO consumption orders.Uncapacitated ELS-PI is polynomially solved under FEFO, LEFO, LIFO, FIFO.With constant production capacities ELS-PI is NP-hard under LIFO, FEFO.With constant production capacities ELS-PI is polynomially solved under FIFO, LEFO.

@&#KEYPHRASES@&#
Lot-sizing,Dynamic programming,Perishable items,Complexity analysis,

@&#ABSTRACT@&#
We consider the economic lot-sizing problem with perishable items (ELS-PI), where each item has a deterministic expiration date. Although all items in stock are equivalent regardless of procurement or expiration date, we allow for an allocation mechanism that defines an order in which the items are allocated to the consumers. In particular, we consider the following allocation mechanisms: First Expiration, First Out (FEFO), Last Expiration, First Out (LEFO), First In, First Out (FIFO) and Last In, First Out (LIFO). We show that the ELS-PI can be solved in polynomial time under all four allocation mechanisms in case of no procurement capacities. This result still holds in case of time-invariant procurement capacities under the FIFO and LEFO allocation mechanisms, but the problem becomesNP-hard under the FEFO and LIFO allocation mechanisms.

@&#INTRODUCTION@&#
The dynamic economic lot-sizing problem (ELS), introduced in Wagner and Whitin (1958), is described as follows. Demands for a single item over a finite and discrete planning horizon have to be satisfied by producing in a facility with no capacity restrictions. An item produced in a period can satisfy demands in that period and the following periods. Whenever there is positive production in a period, a setup has to take place, which entails a fixed setup cost. Any item produced incurs a unit production cost and any item carried to the next period incurs a unit inventory holding cost. The goal is to find a minimum cost production plan.This basic model has been extended in several ways by, for example, considering backlogging (Zangwill, 1968), production capacities (Bitran and Yanasse, 1982 and Florian, Lenstra, and Rinnooy Kan, 1980), and inventory bounds (Atamtürk and Küçükyavuz, 2005; Hwang and van den Heuvel, 2012; Liu, 2008; Toczylowski, 1995). In all these models it is assumed that items can be kept in stock indefinitely. However, items such as agricultural products, dairy products and pharmaceutical products may deteriorate over time. For the procurement and inventory control decisions of such items, models that account for item perishability should be used.Broadly, past research has modeled perishability in two ways. In the first one, items deteriorate continuously, and in the second one items have certain lifetimes after which they deteriorate completely. Seminal work on the first category of models includes Ghare and Schrader (1963), Covert and Philip (1973), and Philip (1974). For an extensive review of early work, see Raafat (1991) and for more recent reviews, see Goyal and Giri (2001) and Bakker, Riezebos, and Teunter (2012). Regarding the second category of models, in some it is assumed that demand follows a deterministic function (see Hwang and Hahn, 2000; Zhou and Yang, 2003), while in others demand is stochastic (see Fries, 1975; Liu and Lian, 1999; Nahmias and Pierskalla, 1973; Olsson and Tydesjö, 2010; Tekin, Gürler, and Berk, 2001). For a review of recent literature on these models, we refer the readers to Urban (2005), Bakker et al. (2012) and the related chapter in Kempf, Keskinocak, and Uzsoy (2012).When the items are perishable, the order in which they are consumed becomes an important factor to consider. In Derman and Klein (1958) and Eilon (1962), the problem of optimally allocating items of different ages in stock to maximize total utility is considered, and the performance of a FIFO (First In, First Out) and a LIFO (Last In, First Out) allocation mechanism is evaluated. Assuming that items procured earlier deteriorate faster, FIFO (LIFO) corresponds to the mechanism where the oldest (freshest) item is issued first. In Nose, Ishii, and Nishida (1984), a perishable inventory system with stochastic procurement leadtime under both a FIFO and a LIFO allocation mechanism is discussed. Procurement policies when the demand rate depends on the inventory level under a FIFO and a LIFO allocation mechanism are considered in Hwang and Hahn (2000) and Zhou and Yang (2003), respectively. A model with interaction between a retailer and a supplier under both a LIFO and a FIFO allocation mechanism is studied in Hahn, Hwang, and Shinn (2004). The items have fixed lifetimes and the supplier needs to determine the amount of discount on the items so that the retailer does not return perished items. A stochastic input–output inventory system for perishable items under a FIFO and a LIFO allocation mechanism is considered in Parlar, Perry, and Stadje (2011).ELS models that account for item perishability have been studied in the literature as well. An ELS model where a certain fraction of the inventory spoils at the end of each period is considered in Friedman and Hoch (1978). It is assumed that the fraction of items that spoil in each period increases as the items get older, so that, in a given period, items that were produced earlier deteriorate faster. A similar model with concave procurement and holding costs, where holding older items is never cheaper than holding newer items in stock, is considered in Hsu (2000). In turn, Chu, Hsu, and Shen (2005) generalize the model in Hsu (2000) by assuming economies of scale costs.In the ELS models above, it is assumed that the allocation mechanism is FIFO and that older items deteriorate at a rate faster than newer ones (as we shall see (Section 4.6), under these assumptions there is a close link between our model and lot-sizing models with time windows). However, these assumptions may not hold in general. For example, consider the case of a retailer who orders from multiple suppliers, say, for risk mitigation. If supplier lead times are different (e.g., if they are located at different distances from the retailer), it is possible that an item may expire after a subsequently delivered item. In particular, newly received items may have an earlier expiration date than items that are already in stock. In this situation it may be suboptimal to use a FIFO policy. If the retailer is an online grocer, it might prefer to issue items in a First Expiration, First Out (FEFO) manner in order to minimize wastage. However, if the retailer is a brick-and-mortar supermarket, it loses power to control the issuance of items. In that case, when products with different expiration dates are displayed together, the customers will prefer the items with maximum remaining lifetimes. This means that the items will be issued in a Last Expiration, First Out (LEFO) manner.Based on the above discussion, in this paper we consider a retailer who needs to solve an economic lot-sizing model with perishable items (ELS-PI), where lifetimes are general, such that an item procured later might expire earlier. We assume that items deteriorate completely after a certain expiration date, until which items remain undamaged and good for consumption. Furthermore, we consider the model both with and without capacity restrictions on the amount of procurement in each period. Because of the general lifetimes, a FIFO allocation mechanism does not imply the issuance of the oldest items first. Likewise, LIFO does not imply the issuance of the freshest items first either. Therefore, we analyze the ELS-PI explicitly under a FEFO and a LEFO allocation mechanism as well. Although the discussion above suggests that the most common settings in which items that are procured later may have an earlier expiration date are ones with multiple suppliers, for the sake of clarity in presentation, we assume that there is only a single supplier in each period to order the items from. The model with multiple suppliers was studied in the first author’s doctoral thesis (Onal, 2009), and it turns out (see Section 2) that the difficulties that arise in the presence of multiple suppliers do not introduce significant changes in the analysis.The rest of the paper is organized as follows. In Section 2, we introduce and formulate the economic lot sizing problem with perishable items (ELS-PI). In Section 3, we discuss the effect of allocation mechanisms on the optimal objective function values. We derive structural properties of optimal solutions to the ELS-PI with no procurement capacities in Section 4, and propose solution algorithms. In Section 5, we analyze the computational complexity of the ELS-PI with procurement capacities. We conclude the paper, and discuss future research subjects in Section 6.The ELS-PI is an economic lot-sizing problem over a discrete and finite planning horizon consisting of T periods. Demand in each period is satisfied by procurement from a single supplier with zero lead time. As soon as the items are procured, they are stored in a single location from where they are distributed to satisfy demands. The procurement amount in each period may be subject to limited capacity.Each item in stock has a certain expiration date that depends on the period in which it is procured. Particularly, an item procured in period t expires after period vt≥ t (t=1,…,T). Since we have a planning horizon of T periods, we assume that vt≤ T. We assume that there is no degradation in the quality of the item as long as its expiration date has not passed. Although all items in the stock are equivalent regardless of procurement or expiration date, we allow for an allocation mechanism that defines a preference order in the allocation of items to the consumers. More formally, an allocation mechanism is characterized by a preference order of the procurement periods, where we write i≻j if and only if items procured in period i must be consumed earlier than items procured in period j. Moreover, we write i ∼ j to denote indifference between items procured in periods i and j. This leads to the notation i≿j to indicate that items procured in period i are at least as preferred as items procured in period j, i.e., i≻j or i ∼ j.We say that a period t (partially) satisfies the demand in period i if some items procured in period t are allocated to (partially) satisfy the demand in period i. For convenience, we associate a supply intervalF(t)={t,…,vt}with each period t, consisting of periods whose demand can be satisfied by items procured in period t. To formulate the ELS-PI, we use the following additional notation:Parameters:Dt=demandinperiodtCt=procurementcapacityinperiodtSt=fixedsetupcostofprocurementinperiodtpt=unitprocurementcostinperiodtht=unitinventoryholdingcostinperiodtcti=variablecosttosatisfyoneunitofdemandinperiodibyprocurementinperiodt=pt+∑j=ti−1hj.Decision variables:xti=quantityprocuredinperiodtusedto(partially)satisfydemandinperiodizti=1ifperiodtsatisfiessomedemandinperiodi(i.e.,ifxti>0),0otherwiseyt=1ifthereisprocurementinperiodt(i.e.,if∑i=tvtxti>0),0otherwise.Using the parameters and decision variables above, we formulate the ELS-PI as follows:(P)min∑t=1T(Styt+∑i=tvtctixti)subjectto(1)∑t:i∈F(t)xti=Difori=1,…,T(2)∑i=tvtxti≤Ctfort=1,…,T(3)xti≤Diztifort=1,…,T;i=t,…,vt(4)zti≤ytfort=1,…,T;i=t,…,vt(5)zis+zjt≤1for1≤i≤s≤vi;1≤j≤s<t≤vjwithj≻i(6)xti≥0fort=1,…,T;i=t,…,vt(7)zti∈{0,1}fort=1,…,T;i=t,…,vt(8)yt∈[0,1]fort=1,…,T.The objective function minimizes total procurement and holding costs. Constraints (1) ensure that demand in period i can only be satisfied by periods that contain period i in their supply intervals. Constraints (2) are the capacity constraints. Constraints (3) ensure that a period t can (partially) satisfy the demand in period i only ifzti=1,while constraints (4) ensure that a period can (partially) satisfy the demand in period i only if a setup takes place in that period. Constraints (5) model the assumed allocation mechanism: for any pair of procurement periods j≻i, if period i (partially) satisfies period s, then a period j ≤ s cannot (partially) satisfy demand in a period t > s. Finally, constraints (6)–(8) specify the domains of the decision variables. Combining constraints (4) with (8) ensures that in an optimal solution the setup variables are binary.Besides model (P), in which capacities are general, we consider two special cases: the problem with time-invariant procurement capacities (i.e.,Ct=Cfort=1,⋯,T) and the uncapacitated problem (i.e.,Ct=∞fort=1,⋯,T). To distinguish between problems with different allocation mechanisms and capacity assumptions, we refer to PU(M), PC(M) and PCt(M) as problem (P) under some allocation mechanism M with no, time-invariant, and time-variant capacities, respectively. For example, the uncapacitated version of problem (P) under the FEFO allocation mechanism (see also the next section) is denoted by PU(FEFO). Finally, we refer to PCt( ∼ ) as the problem without a preference order.In our analysis it will be useful to distinguish between an allocation plan and an aggregate plan. An allocation plan is characterized by the quantities {xti} (i=t,…,vt,t=1,…,T), where the variable xtiis called an allocation, and specifies how the procured items are distributed to satisfy demands. An allocation plan is called feasible if it is part of a feasible solution to (P). In contrast, an aggregate plan is characterized by the aggregate procurement quantitiesxt:=∑i=tvtxtiand the implied ending inventory levelsIt:=∑i=1t(xi−Di)in each period t (t=1,…,T). An aggregate plan is called feasible if the procurement in each period can satisfy demands disregarding the underlying preference order. A feasible allocation plan implies an associated feasible aggregate plan. However, a feasible aggregate plan may not have an associated feasible allocation plan for some allocation mechanisms. Throughout the paper, we use the notation x to either refer to an allocation plan or an aggregate plan, where the correct interpretation will be clear from the context. These x-variables can be represented as flows in a network. Fig. 1is a representation of a three period problem withv1=3,v2=2andv3=3. The flows on the upper level arcs correspond to the aggregate plan, while the flows on the lower level arcs correspond to the allocations. The network representation can also help to graphically illustrate different allocation mechanisms. For example, a feasible solution to the problem with a FIFO mechanism cannot have any crossing arcs with positive flows.In the remainder of the paper we will focus particularly on ‘natural’ allocation mechanisms that either represent the power structure between retailer and customer, or are dictated by the physical properties of the inventory system.A customer who is allowed to select from the items in stock is likely to choose the ones with the longest remaining lifetime. In that case, the inventory is consumed in Last Expiration, First Out (LEFO) order. Formally, this allocation mechanism corresponds to the preference order defined by i≻j and i ∼ j if and only if vi> vjandvi=vj,respectively. On the other hand, a retailer who controls the allocation of items will sell the ones with the shortest remaining life first. In this case the inventory is consumed in First Expiration, First Out (FEFO) order, and we have i≻j and i ∼ j if and only if vi< vjandvi=vj,respectively.If the inventory system is designed as a queue, so that newly procured items are placed at the back of the queue and demands are satisfied from the front of the queue, then items are allocated in First In, First Out order (FIFO). Formally, in this allocation mechanism we have i≻j if and only if i < j. On the other hand, if the inventory system is designed as a stack, then items are allocated in Last In, First Out (LIFO) order, and we have i≻j if and only if i > j.Finally, our model can handle a setting with multiple suppliers as studied in Onal (2009). In this setting there are Ktsuppliers to choose from in each period t, where we let the pair (t, k) represent the supplier k in period t. Each supplier (t, k) has an associated expiration date vtk, setup cost Stk, unit purchase cost ptkand procurement capacity Ctk. We can easily transform such a multiple supplier problem with T periods to a∑t=1TKtperiod problem with a single supplier in each period as follows. Between each pair of periods t−1and t we insert Kt−1dummy periods with zero demand and zero inventory holding cost. We then associate the Ktsuppliers with these dummy periods (including the original period t) such that there is only one supplier in each period. All the supplier related costs remain the same but we transform the expiration periods of the items procured from each supplier accordingly. Therefore, all properties and algorithms that we derive for the single supplier case will also hold for the above multiple supplier case.In this section we will show that, in terms of retailer costs, the FEFO allocation mechanism is the most attractive one, while the LEFO allocation mechanism is the least attractive one among all possible allocation mechanisms. Moreover, we will show that there exists no ordering w.r.t. the optimal costs between the FIFO and LIFO allocation mechanisms in general.As is common in lot-sizing models, we use the concept of a regeneration interval (RI). An RI [t1, t2] (1 ≤ t1 ≤ t2 ≤ T) is an interval of periods [t1, t2] for which the aggregate plan satisfiesIt1−1=It2=0and It> 0 for t1 ≤ t < t2. Note that we use [t1, t2] as a shorthand notation for the set{t1,⋯,t2}. Clearly, any feasible solution to (P) can be decomposed into such RIs. Moreover, as long as the aggregate plan does not change, the composition of the RIs does not change either.To prove the main theorem of this section, we will transform solutions that are feasible w.r.t. one mechanism into solutions that are feasible w.r.t. another mechanism. In order to facilitate this, we introduce a generic allocation algorithm. Given a feasible aggregate solution, Algorithm 1allocates procurements to demands such that some allocation mechanism M is satisfied.In each iteration t of the for loop, the variables d′ and Iirepresent the demand of period t that still needs to be allocated and the inventory of items procured in period i, respectively. Those variables are initialized by the demand and procurement quantity of that period (lines 4–5). In the while loop, the demand of some period t is satisfied by the inventory (probably consisting of items procured in different periods). We first select some inventory with the highest preference (line 7) and allocate as much of this inventory as possible to the current demand (line 8). The current demand and inventory levels are updated (lines 9–10) and the procedure continues, so that the allocation mechanism is satisfied in the end. For ease of notation, we denote by A(M) the algorithm with the assumed allocation mechanism M.Lemmas 3.2 and 3.4 show that any feasible solution to PCt(M) can be transformed into a feasible solution to PCt(FEFO), and any feasible solution to PCt(LEFO) can be transformed into a feasible solution to PCt(M) for any arbitrary allocation mechanism M without changing the aggregate plans. To prove this, we will establish a few additional properties, which we state in Lemmas 3.1 and 3.3.Lemma 3.1Let x be a feasible allocation plan of PCt(FEFO). Let j be a period in some RI [t1, t2] and t ∈ [t1, j] be the procurement period with the latest expiration date satisfying period j. Then there exists a period u ∈ [t1, t] such that for r ∈ [u, j],xt′r>0implies t′ ∈ [u, j] andvt′≤vt.We will show how to locate period u. Let period i0 be the procurement period with the latest expiration date that satisfies period j ≥ i0. Thenvt≤vi0for all t with xtr> 0 for r ∈ [i0, j], since x satisfies the FEFO rule. If t ≥ i0 for all t with xtr> 0 and r ∈ [i0, j], thenu=i0. Otherwise, there exist periodsu=in<⋯<i0such thati1=min{t:t<i0,xtr>0,r∈[i0,j]}andik=min{t:t<ik−1,xtr>0,r∈[ik−1,ik−2−1]}fork=2,…,nwith n as large as possible. By construction of the sequence, we havext′r=0for periods t′ < inand r ∈ [in, j]. Furthermore, since x satisfies the FEFO rule, we have that (i)vik≤vik−1≤vi0fork=1,…,n,and (ii) ifxt′r>0for somer∈[ik,ik−1−1],thenvt′≤vik≤vi0fork=0,…,n. In conclusion, the interval [u, j] has the desired properties.□To illustrate Lemma 3.1, Fig. 2shows an RI[t1=1,t2=7]in some allocation plan. If we start with periodj=7,theni0=1,leading tou=1and the interval [1, 7]. Furthermore, because of the FEFO rule, we must have vi≤ v1 fori=2,⋯,5. On the other hand, if we havej=6,theni0=5,i1=3andi2=2,leading tou=2and the interval [2, 6]. Again because of the FEFO rule, we must have v2 ≤ v3 ≤ v5 but also v4 ≤ v3 ≤ v5. Hence, both intervals [1, 7] and [2, 6] are examples that satisfy the properties of Lemma 3.1.Lemma 3.2Let x be a feasible allocation plan of PCt(M) for some allocation mechanism M. Applying A(FEFO) to the aggregate plan of x leads to a feasible allocation plan x′ of PCt(FEFO) with the same cost.See Appendix A.□Let x be a feasible allocation plan of PCt(LEFO). If xτs> 0 in RI [t1, t2], then vτ≥ t2.The proof is by contradiction. Assume there is some allocationxi1s1>0in the RI [t1, t2] withvi1<t2. Clearly, we haves1≤vi1<t2. Since Iτ> 0 forτ∈[t1,t2−1]and henceIs1>0,there exists somexi2s2>0with i2 ≤ s1 and s2 > s1. Since the solution satisfies the LEFO rule, we havevi2≤vi1<t2. Repeating this argument, we find a sequence ofn∈Nallocationsxi1s1,xi2s2,⋯,xinsn>0withsn=t2andvin<t2. This clearly contradicts the feasibility of the solution.□Let x be a feasible allocation plan of PCt(LEFO). If we apply A(M) to the aggregate plan of x for some allocation mechanism M, then the output x′ is a feasible allocation plan of PCt(M) with the same cost.As Algorithm 1 does not change the aggregate quantities, the RIs and costs of x and x′ are equal. Furthermore, due to Lemma 3.3, any procurement period t in some RI [t1, t2] has vt≥ t2. Therefore, no items perish and hence, x′ is feasible.□We are now ready to prove the main theorem.Theorem 3.5Problems PCt(FEFO) and PCt(LEFO) have the lowest and highest optimal objective function value, respectively, among all allocation mechanisms M.It is sufficient to show that the following properties hold: (i) for each feasible solution to PCt( ∼ ), there exists a feasible solution to the corresponding instance of PCt(FEFO) with the same cost; and (ii) for a feasible solution to PCt(LEFO) there exists a feasible solution for the corresponding instance of PCt(M) with the same cost. Clearly, statements (i) and (ii) immediately follow from Lemmas 3.2 and 3.4, respectively.□Theorem 3.5 identifies two allocation mechanisms that lead to the smallest (FEFO) and largest (LEFO) optimal cost. This implies that the other two common allocation mechanisms, FIFO and LIFO, have costs that are between these two extremes. The next theorem shows that, in general, neither the FIFO nor the LIFO allocation mechanism is guaranteed to dominate the other in terms of costs. In fact, the ratio of the optimal costs under these two mechanisms can be arbitrarily large or small.Theorem 3.6Let ϕFIFO(I) and ϕLIFO(I) denote the optimal costs of PU(FIFO) and PU(LIFO), respectively, for some instance I. LetIUdenote the set of all uncapacitated problem instances. ThensupI∈IU{ϕLIFO(I)ϕFIFO(I)}=∞=supI∈IU{ϕFIFO(I)ϕLIFO(I)}.Moreover, the result still holds for capacitated instances, even if the capacities are time-invariant.The proof is based on two examples. To be precise, consider two uncapacitated problem instances I1(α) and I2(α), parameterized by a scalar α > 1, with planning horizonT=3,St=ht=0andCt=∞(t=1,2,3), and the other problem data as in Table 1.The optimal aggregate plan for instance I1(α) under the LIFO allocation mechanism isx=(1,α+1,0)with costϕLIFO(I1(α))=α2+α+1,while the optimal aggregate plan under the FIFO allocation mechanism isx=(1+α,1,0)with costϕFIFO(I1(α))=2α+1. This implies thatlimα→∞ϕLIFO(I1(α))ϕFIFO(I1(α))=limα→∞α2+α+12α+1=∞.Furthermore, the optimal aggregate plan for instance I2(α) under the LIFO allocation mechanism isx=(2,α,0)with costϕLIFO(I2(α))=3α,while the optimal aggregate plan under the FIFO allocation mechanism isx=(α+2,0,0)with costϕFIFO(I2(α))=α2+2α. This implies thatlimα→∞ϕFIFO(I2(α))ϕLIFO(I2(α))=limα→∞α2+2α3α=∞.Since any uncapacitated problem instance can be converted into an equivalent capacitated problem instance by choosingCt=∑t′=1Tdt′(t=1,…,T), the results hold for the ELS-PI with (time-invariant) procurement capacities as well.□We will use a few structural properties of optimal solutions to develop efficient algorithms for the uncapacitated ELS-PI. The first structural property we introduce is the unique procurement property, which holds true under any allocation mechanism.Theorem 4.1Let M be an allocation mechanism. Then there exists an optimal solution to PU(M) such that demand in each period is satisfied by a unique procurement period.Problem PCt(M) (and hence PU(M)) can be viewed as a concave network flow problem (see also Fig. 1) with additional constraints imposed by the allocation mechanism. Following Zangwill (1968), given that there are no capacity restrictions, an extreme point solution does not contain any cycle (constraints (3)–(5) will not be violated after removing a cycle). Clearly, in an extreme point solution to PU(M), every demand is satisfied by a unique procurement period. Since we can find an optimal solution among the extreme point solutions, the theorem follows.□If the allocation mechanism is FEFO, LEFO, FIFO or LIFO (or if there is no allocation mechanism at all), we can generalize the unique procurement property to Theorem 4.2, which states that periods i and j do not both partially satisfy the demand in the interval F(i)∩F(j).Theorem 4.2There is an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO}, such that for any two procurement periods i and j (i ≠ j), eitherxir=0orxjr=0for all r ∈ F(i)∩F(j).See Appendix B.□We emphasize that Theorem 4.2 does not necessarily hold for all allocation mechanisms. For example, consider a 4-period instance with preference order 1≻3≻2≻4,St=ht=0(t=1,⋯,4) and other parameters as in Table 2. It can be verified that the unique optimal solution hasx12=x24=x33=1with cost 10. Clearly, this solution does not satisfy Theorem 4.2 sinceF(1)∩F(2)=[2,4]and x12, x24 > 0.Corollary 4.3Let x be an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO} satisfying Theorems 4.1 and 4.2. Suppose thatxti=Diandxtℓ=Dℓfor some procurement period t with t ≤ i ≤ ℓ ≤ vt. Then, ifxt′k=Dkfor somek∈[i+1,ℓ−1],we have thatk∈[t′,vt′]⊆[i+1,ℓ−1].The above result, following from Theorem 4.2, implies that if the earliest and the latest periods satisfied by a period t are i and l respectively, the allocation plan within periods i and l is independent of the allocation plan prior to period i (except that period t can satisfy any demand in the interval [i, ℓ]) and after period l. Therefore, we can independently optimize the allocation plan between i and ℓ. In other words, an optimal solution is composed of independent subintervals [τ1, τ2] such that (i) periods τ1 and τ2 are the first and the last periods satisfied by the same period t1,t1≤τ1≤τ2≤vt1; (ii) no period before period τ1, other than t1, can satisfy the demand in [τ1, τ2]. We refer to such intervals as subplans and denote such a subplan by SP [t1; τ1, τ2]. We note that a subplan is not equal to a regeneration interval. In fact, a regeneration interval may consist of a sequence of subplans. More importantly, inside any subplan, there might exist several other subplans. These observations are summarized in the following corollary.Corollary 4.4Let x be an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO} satisfying Theorems 4.1 and 4.2. Let periods j and ℓ be such that (a)j=0andℓ=T+1,or (b)xtj=Dj,xtℓ=Dℓand t′ ≠ t for allxt′k=Dkwithk∈[j+1,ℓ−1]. Then there exists a sequence of N subplans SP[tk;ik,ik+1−1](k=1,⋯,N) such that(i)j+1=t1=i1<i2<⋯<iN+1=ℓ,j < tk< ℓ (k=1,⋯,N), andtk≠tk′for k ≠ k′ (k,k′=1,⋯,N).Under condition (a) the corollary states that the whole horizon [1, T] can be decomposed into a sequence of subplans, while under condition (b) it states that a subplan itself may contain a sequence of subplans as well. In the following sections, we are going to investigate additional properties of optimal solutions of the ELS-PI under the FEFO, LEFO, FIFO and LIFO allocation mechanisms and propose solution algorithms.We will develop a dynamic programming (DP) algorithm that is based on Corollary 4.4. To be more precise, we will develop an algorithm that produces a solution satisfying Corollary 4.4(i), but not necessarily Corollary 4.4(ii) or (iii). As a result, the obtained solution may not satisfy the FEFO allocation mechanism, as we will discuss in more detail later. However, by Lemma 3.2, any allocation plan can always be transformed into a plan that is feasible under the FEFO allocation mechanism.In order to develop the DP algorithm, let f(t; τ1, τ2), 1 ≤ t ≤ τ1 ≤ τ2 ≤ vt, be the minimal cost of SP [t; τ1, τ2]. Furthermore, let g(t; τ1, τ2), 1 ≤ t ≤ τ1 ≤ vtand τ1 ≤ τ2 ≤ T, be the minimal cost of a sequence of subplans on the interval [τ1, τ2], where demand in period τ1 is satisfied by period t. Note that outside the specified ranges, the (sequences of) subplans are not feasible and hence not defined. Finally, we let f(τ1, τ2) be the minimal cost subplan and g(τ1, τ2) the minimal cost sequence of subplans over all procurements periods in the interval [τ1, τ2], 1 ≤ τ1 ≤ τ2 ≤ T, which are given by(9)f(τ1,τ2)=mint:t≤τ1≤τ2≤vt{f(t;τ1,τ2)}and(10)g(τ1,τ2)=mint:t≤τ1≤vt{g(t;τ1,τ2)}.Since any sequence of subplans starts with a single SP [t; τ1, τ2] followed by a (possibly empty) sequence of subplans, it follows that(11)g(t;τ1,τ2)=minτ:τ1≤τ≤τ2{f(t;τ1,τ)+g(τ+1,τ2)}.If we substitute (11) into (10), then we can equivalently define g(τ1, τ2) asg(τ1,τ2)=mint:t≤τ1≤vt{g(t;τ1,τ2)}=mint:t≤τ1≤vt{minτ:τ1≤τ≤τ2{f(t;τ1,τ)+g(τ+1,τ2)}}=minτ:τ1≤τ≤τ2{mint:t≤τ1≤vt{f(t;τ1,τ)}+g(τ+1,τ2)}=minτ:τ1≤τ≤τ2{f(τ1,τ)+g(τ+1,τ2)}The interpretation is similar to that of (11), but now we start with a minimum cost subplan on the interval [τ1, τ2]. Furthermore, since a subplan extends an existing subplan or it contains a (possibly empty) sequence of subplans by Corollary 4.4(i), it follows that for τ1 < τ2(12)f(t;τ1,τ2)=min{f(t;τ1,τ2−1)+ctτ2Dτ2,g(t;τ1,τ2−1)+ctτ2Dτ2}=g(t;τ1,τ2−1)+ctτ2Dτ2,where the equality holds because g(t; τ1, τ2) ≤ f(t; τ1, τ2) by (11). Finally, the DP recursion is initialized byf(t;τ,τ)=St+ctτDτandg(t;τ,τ−1)=0.Note that the above DP recursion is not a traditional forward or backward algorithm as often seen for lot-sizing problems. Since (sequences of) subplans may be contained in subplans, we should start with the subplans defined on the smallest intervals. Hence, the correct order of computation is to subsequently compute f(t; τ1, τ2), g(t; τ1, τ2), f(τ1, τ2) and g(τ1, τ2) for all feasible combinations of t, τ1 and τ2, where we start withτ2−τ1=0and end withτ2−τ1=T−1.Our algorithm is summarized in Algorithm 2. The algorithm is initiated in lines 1–7 by computing f(τ, τ) and g(τ, τ) forτ=1,…,T. It is then continued in lines 8–16 by computingg(τ,τ+k)forτ=1,…,Tin increasing order of k,k=1,…,T−τ. Due to the order of operations, when we arrive at lines 11 and 12, all the values off(t;τ,τ+k′)andg(t;τ,τ+k′)are known for 1 ≤ k′ < k, and hence those lines can be feasibly executed. It is not difficult to see that the bottleneck of the algorithm is the computation of all valuesg(t;τ,τ+k)in line 12 takingO(T4)time. In conclusion, the optimal objective value g(1, T) of the overall problem can be found inO(T4)time.As mentioned before, the final solution may not satisfy all optimality properties derived so far. First, since we minimize over all feasible procurement periods in (9) and (10), a subplan within SP [t; τ1, τ2] may be satisfied by some procurement period t < τ1, which violates Corollary 4.4(ii) (and Corollary 4.3). Second, we do not require in (11) that the sequence of subplans corresponding tog(τ+1,τ2)does not contain a subplan of which the first demand is procured by period t. Hence, in the final solution Corollary 4.4(iii) may be violated as well. However, since the costs are concave, this can only happen if the setup cost in period t is zero. Third, we do not require in (11) and (12) that the property of Theorem 4.2 holds. A violation of this theorem can only occur if the marginal procurement costs are the same in some periods. Nevertheless, a minimum cost solution satisfying Theorem 4.2 can be obtained by applying the procedure outlined in the proof of that theorem. Although the obtained minimum cost solution may fail to satisfy all corollaries, it is feasible with respect to perishability and demand satisfaction. Hence, by applying A(FEFO) to the obtained solution, we find an optimal solution that satisfies the FEFO allocation mechanism. In conclusion, problem PU(FEFO) can be solved inO(T4)time.Let x be a feasible allocation plan of the uncapacitated ELS-PI that satisfies Corollary 4.4. A necessary condition for x to satisfy the LIFO allocation mechanism is thatxtt=Dtfor every procurement period t. In other words, under the LIFO allocation mechanism, only subplans of the form SP [τ1; τ1, τ2] exist. Therefore, we restate Corollary 4.4 as follows.Corollary 4.5Let x be an optimal solution to PU(LIFO) satisfying Theorems 4.1 and 4.2. Let periods j and ℓ be such that (a)j=0andℓ=T+1,or (b)xtj=Dj,xtℓ=Dℓand t′ ≠ t for allxt′k=Dkwithk∈[j+1,ℓ−1]. Then there exists a sequence of N subplansSP[tk;tk,tk+1−1](k=1,⋯,n) such thatj+1=t1<t2<⋯<tn+1=ℓ.Our DP algorithm is based on Corollary 4.5 and the above mentioned special form of the subplans. Because of this special form, the DP variables have one less index compared to the FEFO case. Let f(τ1, τ2),1≤τ1≤τ2≤vτ1,be the minimal cost of SP [τ1; τ1, τ2]. Furthermore, let g(τ1, τ2), 1 ≤ τ1 ≤ τ2 ≤ T, be the minimal cost of a sequence of subplans on the interval [τ1, τ2]. Then, using similar arguments as in the FEFO case, we have(13)g(τ1,τ2)=minτ:τ1≤τ≤τ2{f(τ1,τ)+g(τ+1,τ2)}and(14)f(τ1,τ2)=g(τ1,τ2−1)+cτ1τ2Dτ2forτ1<τ2with the initial conditionsf(τ,τ)=Sτ+cττDτandg(τ,τ−1)=0.As in Section 4.2, we subsequently compute f(τ1, τ2) and g(τ1, τ2) for all feasible combinations of τ1 and τ2, where we start withτ2−τ1=0and end withτ2−τ1=T−1. These computations can be handled by executing lines 2–5 and lines 11–12 only fort=τin Algorithm 2. Clearly, this reduces the overall complexity by a factor of T, and we conclude that problem PU(LIFO) can be solved inO(T3)time.When the allocation mechanism is FIFO, the consumption of items procured in a particular period does not start unless all the items that were procured in earlier periods have been consumed. Together with the unique procurement property, this implies that items procured in a period satisfy the demands of a set of consecutive periods as stated in Theorem 4.6.Theorem 4.6Suppose there are N procurement periods 1 ≤ t1 < ⋅⋅⋅ < tN≤ T in an optimal solution to PU(FIFO) that satisfies Theorems 4.1 and 4.2. Then, this solution is decomposed into N subplans of the form SP[tk;ik,ik+1−1],wherei1=t1,iN+1=T+1andik=tk≤vtk+1−1orik=vtk−1+1fork=2,…,N.Due to the nature of the FIFO allocation mechanism, every procurement period tkshould completely satisfy demand of consecutive periods in some interval[ik,ik+1−1],wheretk≤ik≤ik+1−1≤vtkfork=1,…,N. Obviously, we havei1=t1,because there exists no earlier period to satisfy the demand in i1. We need to prove that in a solution that satisfies Theorem 4.2, we should haveik=tkorik=vtk+1−1for 1 < k ≤ N.For some k with 1 < k ≤ N, consider two procurement periodstk−1and tk. Due to Theorem 4.2, we have either (i)xtki=0or (ii)xtk−1,i=0fori∈F(tk−1)∩F(tk)=[tk,min{vtk,vtk−1}]. If (i) is true, then we havemin{vtk,vtk−1}=vtk−1(otherwise tkcannot be a procurement period) andik=vtk−1+1. On the other hand, if (ii) is true, thenxtk′i=0fork′<k−1andi∈[tk,vtk−1],which implies in particular thatxtktk=Dtk. This further implies thatik=tk,and completes the proof.□To solve problem PU(FIFO), we exploit the property in Theorem 4.6 and use a slight modification of the algorithm in Hsu (2000) as follows. We define f(t; τ) to be the minimal cost of satisfying demands from period 1 to period τ (t ≤ τ ≤ vt), with the additional constraint that the latest period with positive procurement is t, and that it completely satisfies the demand of period τ. This definition implies that the minimum cost to satisfy demands over the whole planning horizon can be determined by computing min 1 ≤ t ≤ Tf(t; T). This also leads to the following recursive equations fort=1,…,Tandτ=t,…,T:(15)f(t;τ)={min{f(t;τ−1)+ctτDτ,mini∈κ(t,τ){f(i;τ−1)+St+ctτDτ}}ift<τ≤vtmini:i≤t−1≤vi{f(i;t−1)+St+ptDt}ifτ=t∞otherwisewhereκ(t,τ)={i:i<tandvi=τ−1}. Observe that in (15), we can restrict our search to i ∈ κ(t; τ) due to Theorem 4.6. By performing a similar analysis as in Hsu (2000) (see Appendix C), we find that the overall time complexity of carrying out (15) and computing min 1 ≤ t ≤ Tf(t; T) isO(T2). As a result, PU(FIFO) can be solved inO(T2)time.Under the LEFO allocation mechanism, there exists an optimal solution, where two items with different procurement periods are never held in stock together as stated in Theorem 4.7 (see Appendix D for the proof), implying that the zero-inventory-ordering (ZIO) property holds. As a result, a Wagner–Whitin-type algorithm can be developed, and PU(LEFO) can be solved inO(T2)time.Theorem 4.7There exists an optimal solution to PU(LEFO) that possesses the ZIO property.As stated in the Introduction, previous research has been limited to cases where vi≤ vjfor i < j. It is easy to see that under this assumption, the FIFO and FEFO mechanisms are equivalent, as well as the LIFO and LEFO mechanisms. Furthermore, under this assumption, problem PU(FIFO) (or PU(FEFO)) is equivalent to an ELS problem with inventory bounds (ELS-BI), where the bounds are set asIt≤∑i=t+1vtDit=1,…,Tto prevent wastage of the items. The ELS-BI was first studied by Love (1973), who developed anO(T3)algorithm for the problem. Toczylowski (1995) later proposed anO(T2)algorithm for this problem, which is the fastest algorithm known to date. Moreover, under the aforementioned assumption, PU(FIFO) (or PU(FEFO)) can also be viewed as an ELS problem with procurement time windows (ELS-TW). In the ELS-TW, the demand in period t can only be satisfied by procuring in a period in the time window [bt, t]. Clearly, the equivalence of the problems holds by settingbt=min{i:vi=t}. In fact, Wolsey (2006) showed that the problems ELS-BI and ELS-TW are equivalent and provided anO(T2)algorithm for both. Therefore, under the special assumption that vi≤ vjfor i < j, PU(FIFO) and PU(FEFO) can be solved in O(T2) time by the algorithm of Toczylowski (1995) or Wolsey (2006).It is well known that the ELS with procurement capacities isNP-hard even under various special cost structures (see Bitran and Yanasse, 1982 and Florian et al., 1980). Since the ELS-PI generalizes the ELS by incorporating item deterioration, it follows that the ELS-PI with procurement capacities is alsoNP-hard under these special cases. On the other hand, the ELS with time-invariant procurement capacities can be solved in polynomial time under general concave cost functions (see Florian and Klein, 1971 and Hoesel and Wagelmans, 1996). We would like to know whether this property holds in case of item deterioration. Hence, we analyze the ELS-PI under time-invariant procurement capacities (i.e.,Ct=Cfort=1,…,T). We first prove that the ELS-PI with time-invariant procurement capacities without any allocation mechanism isNP-hard.Theorem 5.1Problem PC( ∼ ) isNP-hard.We use a reduction from problem Partition, which is described as follows. Given positive integers at(t=1,…,N) andA=∑t=1Nat,is there a subsetS⊆{1,…,N}such that∑t∈Sat=A2?We construct an instance for the ELS-PI withN+1periods and time-invariant procurement capacities, where periods are indexed from 0 to N. We setv0=Nandvt=tfort=1,…,N. Furthermore, we setS0=0,D0=0,St=Dt=at,fort=1,…,N,andpt=ht=0fort=0,…,N. Finally, we set the procurement capacity in each period equal toC=A2=12∑t=1NDt. We refer to this problem instance as I. Note that the answer to Partition is no ifat>A2for somet∈{1,…,N}and we disregard these trivial instances. Therefore, we assume thatat≤A2fort=1,…,Nand hence Dt≤ C fort=1,…,N. We will prove that the answer to Partition is yes if and only if there is a feasible solution to I with total cost at mostA2.First, let x be a feasible solution of I with total cost at mostA2. LetS⊆{1,…,N}be the set of positive procurement periods other than period 0. Because the cost is at mostA2,we have(16)∑t∈Sat=∑t∈SSt≤A2.Now consider the procurement quantities in periodst=1,⋯,N. Since x is feasible with respect to perishability, we have thatxt=xtt≤Dt=at(sincevt=tfor t ∈ S). Moreover, since the capacity constraint should be satisfied in period 0, we have(17)12A=C≥x0=∑t=1NDt−∑t∈Sxt≥∑t=1Nat−∑t∈Sat=A−∑t∈Sat⇔∑t∈Sat≥12A.Combining (16) and (17) shows that∑t∈Sat=12Aand hence the answer to Partition is yes.Now suppose that the answer to Partition is yes, i.e., there exists a subsetS⊆{1,…,N}with∑t∈Sat=A2. We construct a solution x′ for instance I such thatxt′=xtt′=Dtfor t ∈ S,x0′=∑t=1NDt−∑t∈SDtandxt′=0otherwise. Clearly, x′ is feasible with respect to demand satisfaction and perishability and the total cost of x′ is∑t∈SSt=A2. With respect to the capacity constraints, we havext′=Dt≤Cfor t ∈ S, and since∑t∈SDt=A2,it follows that(18)x0′=∑t=1NDt−∑t∈SDt=A2=C.Hence, x′ is feasible with respect to the capacity constraints. Therefore, if the answer to Partition is yes, then there is a feasible solution to I with total cost at mostA2.□The special instance constructed in the proof of Theorem 5.1 can also be used to derive the complexity of PC(FEFO) and PC(LIFO). Note that any item procured in some period t > 0 should be consumed in that period since otherwise it will expire. This means that any item procured in period t is consumed no later than any item in stock at the beginning of period t, which is procured in period 0. In turn, this implies that items with an earlier expiration date (vt≤ v0) or that are procured later are consumed first. Hence, an optimal solution to the instance of the proof of Theorem 5.1 should satisfy both the FEFO and LIFO allocation mechanism. Therefore, we conclude that the ELS-PI with time-invariant capacities remainsNP-hard under the FEFO and LIFO allocation mechanisms as stated in Corollary 5.2. Moreover, this holds true even when there is no holding cost and the production cost functions have a fixed charge structure where the variable part is zero.Corollary 5.2Problems PC(FEFO) and PC(LIFO) areNP-hard.As mentioned before, under the FIFO allocation mechanism, consumption of items procured in a period cannot start before the items procured in earlier periods are consumed. This implies the following property, which also holds for the uncapacitated case.Theorem 5.3There exists a feasible allocation plan x of PCt(FIFO) if and only ifIt≤∑i=t+1vtDiwhen xt> 0 (t ∈ [1, T]) in the associated feasible aggregate plan.Consider a feasible aggregate plan and assume that xr> 0 andIr>∑j=i+1vrDjfor some period r. Because of the FIFO allocation mechanism  all items in stock at the beginning of period r should be consumed before the xritems are consumed. SinceIr>∑j=i+1vrDj,this implies that some items procured in period r are still in stock at the end of period vrand hence they expire. This clearly contradicts the feasibility of x. The other direction of the proof is trivial and hence omitted.□Following the lot-sizing literature, we call a procurement period t fractional if the procurement quantity in period t is strictly between 0 and the capacity, i.e., if 0 < xt< C. Likewise, we call a procurement period t full if the procurement amount in that period is equal to the capacity, i.e.,xt=C. In Florian and Klein (1971) it is shown that in a regeneration interval of an optimal solution of the ELS with procurement capacities, there is at most one fractional procurement period. This is equivalent to the property that there is at least one period where the inventory level drops down to zero between two fractional procurement periods. This property also holds in the case of time-variant capacities, and is referred to as the fractional procurement property in the literature. For the ELS-PI with procurement capacities, we generalize this property in Theorem 5.4.Theorem 5.4There exists an optimal aggregate plan x to PCt(FIFO) such that between two fractional procurement periods t1 and t2, there is at least one period t, t1 ≤ t < t2, for which either of the following properties holds:(i)It=0,xt> 0 andIt=∑i=t+1vtDi.Let x be an optimal aggregate plan for PCt(FIFO). Let t1 and t2 be two fractional procurement periods in x. By contradiction, assume that in this optimal solution It> 0, andIt<∑i=tvtDiwhen xt> 0 for t1 ≤ t < t2 (due to Theorem 5.3, we cannot haveIt>∑i=tvtDi).First, letɛ1=min{xt2,Ct1−xt1,mint:xt>0,t1≤t<t2{It−∑i=t+1vtDi}}>0. Consider an aggregate plan x′, wherext1′=xt1+ɛ1,xt2′=xt2−ɛ1,and the other procurement quantities are the same as in x, implying thatIt′=It+ɛ1fort=t1,…,t2−1. By the choice of ɛ1, we have that eitherxt1′=Ct1,xt2′=0orIt′=∑i=t+1vtDifor some procurement period t, t1 ≤ t < t2, so that property (ii) is satisfied between periods t1 and t2.In a similar way, letɛ2=min{xt1,Ct2−xt2,mint:t1≤t<t2{It}}>0and construct an aggregate plan x′′, wherext1′′=xt1−ɛ2,xt2′′=xt2+ɛ2,and the other procurement quantities unchanged, implying thatIt′′=It−ɛ2fort=t1,…,t2−1. By the choice of ɛ2, we have eitherxt1′′=0orxt2′′=Ct2orIt′′=0for some procurement period t, t1 ≤ t < t2, so that property (i) is satisfied between periods t1 and t2.By construction of x′ and x′′ and because of Theorem 5.3, there are feasible allocation plans corresponding to x′ and x′′ that satisfy the FIFO allocation mechanism. Furthermore, since (a) the aggregate plan x is optimal, (b) it is a convex combination of aggregate plans x′ and x′′, i.e.,x=λx′+(1−λ)x′′for some λ ∈ (0, 1), and (c) the objective function is concave, x′ and x′′ should also be optimal. By repeating the above arguments (if necessary), we obtain an optimal solution to PCt(FIFO) that obeys the desired properties.□Theorem 5.4 implies that an optimal solution to PCt(FIFO) is composed of non-overlapping intervals [s, t], 1 ≤ s ≤ t ≤ T, which have the following properties:(i)Is−1=0,orIs−1=∑i=svs−1Diand xs> 0,It=0,orIt=∑i=t+1vtDiand xt> 0,there is at most one fractional procurement period in [s, t].Using these properties, we can now follow an approach similar to Wolsey (2006) (see also Atamtürk and Küçükyavuz, 2005 and Love, 1973) to find the optimal subplan on such an interval for PC(FIFO). To identify the amount of inventory entering in and leaving from such intervals we use the notationIt0:=0andIt1:=∑i=tvtDifor t ∈ [1, T]. Furthermore, let[s,t]uv,u, v ∈ {0, 1}, be the interval [s, t] withIs−1=Is−1uandxs−1>0ifu=1,andIt=Itvand xt> 0 ifv=1. Moreover, letHuv(s,t)be the optimal cost in[s,t]uv. Finally, we define the DP variable F(s),1≤s≤T+1,as the optimal cost of satisfying demands from period s to T provided thatIs−1=0. Similarly, G(s),1≤s≤T+1,is the optimal cost of satisfying the demands from s to T provided thatIs−1=∑i=svs−1Diandxs−1>0. With the initial conditions given byF(T+1)=G(T+1)=0,the following recursions hold fors=1,…,T:(19)F(s)=min{mins≤t≤T{H00(s,t)+F(t+1)},mins≤t≤T{H01(s,t)+G(t+1)}}(20)G(s)=min{mins≤t≤T{H10(s,t)+F(t+1)},mins≤t≤T{H11(s,t)+G(t+1)}}.Our goal is to determine F(1), which, ifHuv(s,t),u, v ∈ {0, 1}, 1 ≤ s ≤ t ≤ T, are known, can be done inO(T2)time using recursions (19) and (20). In fact, theHuv(s,t)values can be computed inO(T2)time by finding a shortest path on a certain network. Since this approach is similar to Florian and Klein (1971), we omit the details. Since the number of possible (s, t) pairs isO(T2),the total time complexity to computeHuv(s,t)for u, v ∈ {0, 1}, 1 ≤ s ≤ t ≤ T isO(T4). This is also the overall complexity to solve PC(FIFO).As mentioned in Section 3, any solution to (P) can be decomposed into consecutive RIs. Since there is no incoming and outgoing inventory in an RI, we can independently solve a subproblem for each RI. This observation, together with the property stated in Lemma 3.3, is sufficient to develop a DP algorithm for PC(LEFO).Let f(t1, t2) be the minimal cost of RI [t1, t2]. Furthermore, let F(s) be the minimal cost of a sequence of RIs from period s to period T. Then, the following recursions hold fors=1,⋯,T:(21)F(s)=mins≤t≤T{f(s,t)+F(t+1)}with the initial conditionF(T+1)=0.Obviously, if all f(t1, t2) values are known, recursions (21) can be solved inO(T2)time. So all that remains is to find the complexity of determining all f(t1, t2) values. Due to Lemma 3.3, a procurement period t that satisfies some demand in RI [t1, t2] has the property vt≥ t2. This implies that when computing f(t1, t2) we should havext=0for periods t, t1 ≤ t ≤ t2, with vt< t2. This can be accomplished by setting the procurement cost in such periods to infinity, and obtaining a minimal cost aggregate plan for RI [t1, t2] inO(T2)time by using the algorithm of Florian and Klein (1971) (see also Section 5.3). We can do this because perishability is not an issue anymore in the RI. Since there areO(T2)possible RIs, the time complexity to determine an optimal aggregate plan over the planning horizon isO(T4). If necessary, the corresponding allocation plan can be found by applying algorithm A(LEFO) to the aggregate solution.

@&#CONCLUSIONS@&#
