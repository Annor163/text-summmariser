@&#MAIN-TITLE@&#
Automated detection and classification of high frequency oscillations (HFOs) in human intracereberal EEG

@&#HIGHLIGHTS@&#
We developed a novel automatic approach for the detection of HFOs based on Hilbert Huang Transform (HHT) and RMS feature.We compared the performance of the proposed method with some other methods previously used for HFOs detection.The proposed method detected HFOs events with high sensitivity and low false discovery rate (FDR).Most relevant HFOs events differed from the regular oscillatory waves and took the form of frequency modulated signals.

@&#KEYPHRASES@&#
Epilepsy,High-frequency oscillations (HFOs),Intracereberal EEG,Empirical mode decomposition (EMD),Hilbert spectral analysis (HSA),Root mean square (RMS),

@&#ABSTRACT@&#
Discrete high-frequency oscillations (HFOs) in the range of 80–500Hz have previously been recorded from human epileptic brains using intracereberal EEG and seem to be a reliable biomarker of seizure onset zone in patients with intractable epilepsy. Visual marking of HFOs bursts is tedious, highly time-consuming particularly for analyzing long-term multichannel EEG recordings, inevitably subjective and can be error prone. Thus, the development of automatic, fast and robust detectors is necessary and crucial for HFOs investigation and for propelling their eventual clinical applications. This paper presents a proposed algorithm for detection and classification of HFOs, which is a combination of both smoothed Hilbert Huang Transform (HHT) and root mean square (RMS) feature. Performance evaluation in terms of sensitivity and false discovery rate (FDR) were respectively 90.72% and 8.23% related to process validation. Indeed, the proposed method was efficient in terms of high sensitivity in which the majority of HFOs visually identified by experienced reviewers was correctly detected, and had a lower FDR. This would mean that only a low rate of detected events was misclassified as candidate HFOs events. The presented software is extremely fast, suitable and can be considered a valuable clinical tool for HFOs investigation.

@&#INTRODUCTION@&#
Epilepsy is one of the most common neurologic diseases in the world. Around 1% of the world's population is affected by epilepsy [1]. Almost 30% of epileptic patients suffer from pharmacoresistant epilepsy whose seizure cannot be controlled with medication (antiepileptic drugs: AEDs) [2]. Surgery is then an alternative for some candidates who have uncontrolled seizures with standard medications.Scalp EEG is occasionally necessary in cases of pharmacoresistant epilepsy. It may contain epileptiform discharges such as spikes [3,4] and sharp waves [3,4], which serve to distinguish between normal subjects and epileptic ones (only 69 of 13,658 healthy candidates without a history of seizures had interictal spikes and sharp waves on a routine scalp EEG [5]).However, scalp EEG and neuroimaging scans like magnetic resonance imaging (MRI), do not always provide enough information to delineate the part of the brain generating seizures (areas to be surgically removed). In some cases, it may be necessary to do a complicated and invasive EEG procedure by implanting microwires [6] and clinical macroelectrodes [6] on the surface of the brain and inside the brain volume (extent of epileptic regions). This procedure can give an accurate reading of the brain activities. In addition, the invasive EEG recordings contain more specific and reliable biomarkers of tissue capable of producing seizures compared to spikes and sharp waves. These emerging biomarkers are called high-frequency oscillations (HFOs) [6–11]. An HFO is defined as a discrete rhythmic wave consisting of at least three cycles or periods [9], and can be clearly delineated from the background EEG [12]. Khalilov et al. [13] reported that it consists of five cycles.HFOs bursts are divided into two subcategories: ripples (80–250Hz), fast ripples (250–500Hz) [6–11]. Even though a large proportion of HFOs co-occur with spikes [10]. These discrete oscillations can also occur independently in non-spiking channels [11]. HFOs may be occurring as spontaneous EEG patterns [10,11] in the absence of specific stimuli, and may be also occurring as evoked potentials [14,15]. In microelectrode recordings [7,9], ripples are regarded as normal activities and fast ripples as pathological bursts. However, studies with macroelectrodes suggested that this distinction might be uncertain. In fact, ripples may contribute similarly as fast ripples and were associated with good epilepsy surgery outcomes [16]. In addition, the rates of ripples and fast ripples were higher within the seizure onset zone (SOZ) rather than outside [10,11]. Thus, ripples and fast ripples seem to be associated with tissue that generates epileptic seizures. Actually, the distinction between pathological and physiological HFOs remains unclear and is currently an active area of research [17]. HFOs may be recorded during interictal [10,11], preictal [18] and ictal[19,20] periods. Two types of channels were found [21]: active channels containing high rates of HFOs, and others with rare HFOs events. HFOs remain confined to the same region during interictal and ictal periods, while spikes and sharp waves present a wider spread during seizures than interictal periods [21]. Moreover, during interictal periods, rates [10,11,22], powers [10] and durations [11,22] of HFOs were significantly higher inside rather than outside the seizure onset zone. More importantly, two postsurgical studies showed a good correlation between surgical outcome and removal of tissue corresponding to channels with high HFOs rates [16,23]. Moreover, HFOs could be useful in predicting the spatial location and possibly the timing of the onset of epileptic seizures [24,25]. In summary, HFOs bursts seem to be a reliable indicator of epileptogenic tissue capable of producing seizures and could reveal the underlying mechanisms of seizures and help to develop targeted therapeutic interventions in epileptic patients.Nevertheless, HFOs processing was traditionally done by visual review of the EEG [10,11]. However, despite its valuable advantage of providing an advanced understanding of the relationship between HFOs and epileptogenesis, its reliance on manual processing makes it highly time-consuming [12,21,25,26], complicated [25] and subjective. Indeed, the visual HFOs processing of a 10-channel, 10-min recording would take more than 10h of hard work of an experienced reviewer [21]. On the other hand, visual scoring of HFOs can be error-prone [27,28] and requires a great deal of concentration [12,28]. Indeed, fatigue or distraction during visual scoring of long-term multichannel EEG, may easily lead to errors such as false positive or false negative detection by electroencephalographers [27,28]. Finally, it is possible that some actual small HFOs escape visual inspection [29] like fast ripples co-occur with spikes with high amplitudes.As a solution for these shortcomings, different types of automated methods of HFOs detection have been developed in recent years. The first one is based on FIR filter and root mean square (RMS) feature [9]. The second method is based on line-length feature [27] in conjunction with Butterworth filter. These two methods were based on energy detection. Their energy thresholds were computed based on the entire band-pass filtered signal in the HFOs band (80–500Hz), including the HFOs events. This assumption seems correct in channels with rare HFOs events, but it is probable that it can fail in active channels. It has been reported [21] that performance detection can be improved by first detecting baseline sections from the entire EEG signals, and subsequently computing the energy threshold based only on the energy of detected baselines. This methodology can improve the performance of HFOs detection for both rare and active channels. The third method is based on complex Morlet wavelet transform [12,13,26]. The fourth method is called MNI detector [21]. The fifth method is derived from Bumps modeling technique [26,30]. It modeled HFOs bursts as Bumps in time frequency map. The sixth method is based on FIR filters in conjunction with Hilbert transform [31]. The seventh method is based on Radial Basis function neural network [32]. The eighth method is based on approximate entropy and artificial neural networks [25]. The ninth method is based on Hilbert Huang Transform and autocorrelation analysis [24]. Finally, new algorithms, namely, “Slope”, “Iterative-Slope” and “Slope-Causal”, were proposed for HFO detection [28].In the fact, there are two major types of limitations associated with automatic HFOs processing. For a comprehensive explanation, low specificity and high false-positive rates [6,9,12,21,26–28,32,33] have been reported during automated HFOs detection process. Indeed, most of the existing techniques in the literature are frequency based decomposition, which can lead to a high rate of false-positives. The spurious HFOs events have been reported arose essentially from the filtering of spikes, sharp waves without HFOs and artifacts [12,26,27]. Consequently, it would be useful to find an automated, fast and reliable HFOs detector. Such a detector would be necessary for a systematic investigation of HFOs [17,21]. In addition, it would propel the clinical use of these bursts [21].For any efficient algorithm to provide a satisfactory detection of HFOs, it should meet the following six conditions: First, it should have the highest possible sensitivity and the lowest possible False Discovery Rate (FDR). Second, it should require the minimum user input parameters. Third, its sensitivity and FDR should be adjustable to various input parameters. Fourth, it should have a consistent performance for a group of patients. Fifth, as was recommended by [12], the algorithm should be robust to distinguish between actual HFOs and high-frequency contribution caused by the filtering process of transient events like spikes, sharp waves and artifacts. Sixth, the algorithm must be validated to be clinically useful and suitable.Hilbert Huang Transform (HHT)[24,34–36] is a combination of both empirical mode decomposition (EMD) and Hilbert spectral analysis (HSA). Several attempts have been made to use the HHT for the processing of biomedical signals [24,35,36]. Indeed, it was applied successfully for the detection and analysis of numerous EEG signals [36] of clinical alcoholics, sleep, epilepsy, and anesthesia. In addition, it was used for the ECG denoising and abnormal ECG feature extraction. It was also used for brain activity feature extraction and brain computer interface (BCI) detection. Finally, it was used in conjunction with autocorrelation analysis to detect HFOs [24]. To our knowledge, no one study has yet used a combination of the EMD, HSA and RMS feature to detect HFOs automatically. This paper will attempt to present an application of this approach, test its findings and compare them with previous works.Empirical mode decomposition (EMD) is a promising technique that has been applied successfully for analyzing of multiple non linear and non stationary biomedical signals [24,35,36]. EMD was first proposed by Huang et al. [34]. It has been already proven that it is a robust and efficient technique in analyzing of cerebral oscillatory activities [24,35,36]. EMD is an algorithmic construction which aims at decomposing a given signal into a collection of intrinsic mode functions (IMFs). The major advantage of EMD technique is that the basis functions are derived directly from the signal itself. Hence, the decomposition is adaptive, in contrast to Fourier analysis[37], matching pursuit technique [26,29,33] and wavelet analysis [12,13,26], in which an a priori functional basis (Templates) are required, like sine, cosine, Gaussian and different wavelet shapes (Hat, Mexican, Morlet wavelets, etc.). The main idea is that this method is an iterative sifting process which decomposes a given signal into a sum of IMFs. Each component must satisfy the two following criteria to be an IMF. Firstly, the number of extrema and the number of zero crossings are either equal or differ at most by one. Secondly, the mean value of the envelope defined by the local maxima and the envelope defined by the local minima is zero. Given these two definite requirements of an IMF, the sifting process for extracting IMFs from a given signal x(n) is described as follows:1.Create upper envelope Eu(n) by local maxima and lower envelope E1(n) by local minima of signal x(n).Calculate the mean of upper and lower envelope as follows:(1)m1(n)=Eu(n)+E1(n)2Subtract the mean from original data(2)h1(n)=x(n)−m1(n)Verify that h1(n) satisfies the conditions for IMF. Otherwise, repeat steps from 1 to 4 until h1(n) is an IMF h1(n) is labeled proto IMF because it does not necessarily satisfy the rigorous constraints that define an IMF.Get first IMF (after k iterations):(3)h1(k)(n)=c1(n)=h1(k−1)(n)−m1k(n)Calculate the first residue as follows:(4)r1(n)=x(n)−c1(n)Once the first highest frequency (c1(n)) is removed from the considered signal, the same procedure is applied on the residue signal r1(n) to identify next highest frequency (c2(n)). The residue is considered a new signal to be decomposed.Repeat whole algorithm with r2(n), r3(n), …, rN(n).After N iterations, x(n) can be decomposed according to Eq. (5). Condition of end (rN(n) must be monotonic). Then, the reconstructed signal that describes the original signal can be expressed as the sum of N IMFs and a residue signal as follows:(5)x(n)≜∑i=1NIMFi(n)+rN(n)As can be seen in Fig. 1, it is clear that EMD performed a better synthesis of the original EEG signal related to Eq. (5), in which the residual is approximately equal to zero. The synthesized signal is the sum of nine extracted IMFs (IMF1(n)…IMF9(n)) of oscillatory activities and the residue: res (r9(n)). Each IMF component can have variable amplitude and frequency along the time axis.In general, Hilbert spectral analysis (HSA) is a signal analysis method applying the Hilbert transform [] to compute the instantaneous frequency and amplitude as functions of time. The amplitude can be contoured on the frequency–time plane in a three-dimensional plot. This frequency–time distribution of the amplitude is designated as the Hilbert spectrum.In our case, HSA provides a method for examining the IMFs instantaneous frequencies and amplitudes data as functions of time. For a comprehensive explanation [38] of the HSA, Hilbert Transform is a linear operator which takes a real function IMFi(n) and produces a complex function Zi(n) with the same domain. Zi(n) can be expressed as follows:Zi(n)=IMFi(n)+jHIMFi(n), where H is the Hilbert Transform of the related signal IMFi(n).The instantaneous amplitude (envelope) for each IMFi(n) can be computed as follows:(6)Ai(n)=Zi(n)The instantaneous phase for each IMFi(n) is computed as follows:(7)ϕi(n)=argZi(n)The instantaneous frequency subsequently for each IMFi(n) is defined as follows:(8)fi(n)12πddtϕi(n)We use the Eqs. (6) and (8) to compute both the instantaneous amplitude and frequency for each component IMFi(n) as functions of time. The final presentation of the results is an energy–frequency–time distribution of all considered N IMFs, which is designated as the Hilbert Huang Spectrum.The clinical database used in this study was recorded using the Harmonic system (Stellate) at the Montreal Neurological Institute and Hospital (MNI), Canada. The data was low-pass filtered at 500Hz and sampled at 2000Hz. The sampled data was then quantized using a 16 bit analog-to-digital converter. In order to avoid the risk of limiting this study to a particular data, the used channels were chosen based on the following criteria: Firstly, the clear presence of interictal HFOs upon initial review was controlled. Secondly, both channels with active and rare HFOs events were considered. Thirdly, a group of three patients with intractable epilepsy was considered for the current study. Finally, channels containing different background levels were selected.For both training data and validation data, the custom graphical user interface (GUI) illustrated in Fig. 2was used in order to visually identify all relevant HFOs included in the selected EEG recordings. This step was performed independently by two reviewers trained in electrophysiology and HFO analysis. The visual marking of HFOs was performed by splitting the screen horizontally in which the reviewers could view a raw of untreated EEG and a filtered version simultaneously. The unfiltered signal was seen in the top plot and the band-pass filtered signal at 80–500Hz in the bottom plot as is shown in Fig. 2. The chosen signal length could be adjusted through a time window. The filtered EEG was viewed at a higher gain than unfiltered EEG. The filter removed the lower frequency components and helped to locate HFOs events. The higher gain was necessary because HFOs had very low amplitudes compared to the unfiltered EEG signals. Each event was marked as a relevant HFO; if it was seen as an oscillation had three consecutive cycles in the frequency band 80–500Hz, and could be clearly distinguished from the average of the background in filtered signals. Besides, it should be confirmed in the unfiltered EEG signal. Every event detected by the two reviewers was considered as a relevant HFO burst. In contrast, the remaining events were excluded from the analysis. A snapshot of HFOs marking (visualization) using the custom GUI is illustrated in Fig. 2.As is illustrated in Fig. 2, each relevant HFO event was marked graphically by delimiting its start–end time position using a blue rectangle. All the marked events by the two reviewers were immediately saved numerically in a database. That would serve subsequently as a gold standard for the evaluation and the measurement of the performance detection. It was ensured that the visual identification of HFOs was associated with high inter-rater reliability.This section consists of an integration of the various techniques detailed above in conjunction with root mean square feature (RMS) in order to implement our custom HFOs detector. The Hilbert–Huang transform (HHT) is the result of the empirical mode decomposition (EMD) and the Hilbert spectral analysis (HSA). The HHT uses the EMD method to decompose a given EEG signal into so-called intrinsic mode function IMFs, and uses the HSA method to compute instantaneous frequency and amplitude data associated with different IMFs. In the following paragraphs, different steps of the proposed algorithm will be described in detail.Fig. 3represents the flowchart of the proposed HFOs detector. IMFs are firstly extracted by EMD technique. Then, instantaneous frequencies and amplitudes of all extracted IMFs can be computed using HSA method. Generally, the calculation of instantaneous frequency of EEG signals using HSA can be affected by the presence of noise and is sometimes highly oscillatory. In other words, errors in forms of random jumps in the curve of instantaneous frequency can occur due to noise. Therefore, instantaneous frequency curve become more unstable with the decrease of signal to noise ratio (decrease of SNR). Selection only the local slope of the instantaneous frequency curve as a relative frequency is generally done. Fortunately, as is illustrated in a previous study [32], the computed instantaneous frequency during an HFO burst is not highly oscillatory and is more stable compared to background activity in which the local slopes (true frequencies) of an HFO burst can be estimated correctly. Hilbert Huang Spectrum is designated as S(t, f) and can be obtained by plotting the time–frequency map described by time (x-axis), instantaneous-frequency (y-axis), and instantaneous amplitudes (z-axis). Then, in order to improve the estimation of the slopes of both instantaneous frequency and amplitude, we smoothed the map S(t, f) by applying a recently smoothing technique. The smoothing procedure is achieved by a 2-D smoothing Matlab function that is described in detail in [39,40]. Smoothed Hilbert Huang Spectrum is then obtained and considered as an important tool and useful information for reducing noise effects and clarifying both labeled frequencies and changing amplitudes of HFO events. In addition smoothing can serve for correct classification of HFOs based on their smoothed frequency curves. Subsequently, for each time sample, instantaneous amplitudes coefficients are accumulated only in function of IMFs traces presented in HFOs band 80–500Hz. As a result, a 1-D signal of interest y, which highly correlates with the time frequency map associated with the original EEG signal, is obtained. Finally, a smoothing of the signal (y) is done using the RMS feature as follows:(9)RMS(t)=1N∑k=t−N+1ty2(k)Then, successive RMS values exceed an RMS threshold (input parameter) are firstly detected as putative HFOs and delimited by start–end time markers. Since the discovery of HFOs, researchers and epileptogists have assumed that an HFO event has only one characterizing frequency [9,10,12,13,26] so that it was modeled as regular oscillatory wave with N cycles. N is set to a certain number of wave-cycles, N may be 3, 4 or 5 cycles. The main challenge in our method is that the most relevant HFOs events are localized with high frequency resolution and are viewed as amplitude–frequency modulated signals like AM–FM signals [41] (AM–FM signal is a function in which the frequency and amplitude varies as a function of time). Several examples of dynamic change for sixteen relevant HFOs events are illustrated in Fig. 4using a smoothed HHT. In other HFOs detectors like those using Complex MORLET wavelet [12,13,26], matching pursuit [26,29,33] and FIR filters [37], putative HFOs events must be longer than a duration threshold (DT=N/f) to be as candidate HFOs. Where f is the estimated frequency of the putative HFO. In this study, the duration based condition cannot be applied for the reason that the major detected HFOs segments are modulated by frequency, which covers a wide range of instantaneous frequencies. Another instead robust condition was applied for the method adopted in this study. This condition was reported in [9], which is based on peaks number. Putative events should have at least six peaks to be candidate events, which is equivalent to three wave cycles. The remaining events are discarded. Then, remaining candidate HFOs events can be easily classified into ripple category if they have only instantaneous frequencies traces in 80–250Hz band. They can be classified as fast ripple category if there are only component traces in 250–500Hz band. Finally, they can be considered as a mixed category (ripple+fast ripple) if the two components are presented. In summary, the classification depends on instantaneous frequency traces extracted by smoothed HHT of each candidate event.Related to Fig. 4, different EEG segments were decomposed to a set of IMFs components, and then HSA is applied to each of them to determine instantaneous amplitude and frequency curves. Finally, Hilbert Huang spectrum is calculated as the sum of Hilbert spectra of each component and subsequently smoothed using smoothed 2D function [39,40]. On the contrary to other methods like spectrogram, wavelet transform and matching pursuit in which time–frequency resolution is limited and does not allow determining intrawave modulation of the signal, they just qualitatively indicates the presence of the modulation while quantitative analysis is still complicated. However, compared to that, smoothed HHT is useful for visualizing of instantaneous frequencies modulation during an HFO train and with significantly higher-resolution.Performance measure is normally calculated using sensitivity and specificity in terms of receiver operating characteristic (ROC) curve. In the context of HFOs detection, two scenarios were used to evaluate the performance of HFOs detectors. The first one [30] is based on sensitivity and specificity. The sensitivity measures the proportion of actual HFOs correctly detected by the system and the specificity measures the proportion of correctly detecting the absence of HFOs by the system. For a particular threshold; the true positives, false positives, true negatives and false negatives are determined in order to estimate the sensitivity and the specificity. True negative determination is not straightforward and its value depends on the chosen window size [30] and the signal length.In the second scenario [12], the performance measure is calculated using the false discovery rate (FDR) instead of specificity. However, as shown in Eq. (11), the FDR does not depend on the number of true negative and is therefore not affected by the size or the number of the chosen window. Indeed, FDR is only in function of actual and false detected event. Therefore, FDR was chosen as a robust metric to measure the rate of incorrect detection rate rather than using the specificity.(10)Sensitivity=100Dppos(11)FDR=100FPTP+FPHFOs detection software produces a list of candidate HFOs with their location, duration and frequency. Candidate HFOs could overlap with positives, negatives. Positives: are different HFOs segments visually identified. Negatives: are different baseline segments. Pos: is the number of positives. Dpos (detected positives): is the number of positives which overlap with at least one candidate HFO. TP (true positives): is the number of candidate HFOs which overlap with at least one positive event. FP (false positives): is the number of candidate HFOs which could not overlap with any positive event.The sensitivity and the FDR usually range between 0 and 100% and following the varying input parameter (RMS _threshold).

@&#CONCLUSIONS@&#
