@&#MAIN-TITLE@&#
ROI image retrieval based on multiple features of mean shift and expectation–maximisation

@&#HIGHLIGHTS@&#
An image retrieval by using MS and EM to adaptively change the location and scale of the region of interest (ROI).EM-like merged into the colour and spatial features to detect the scale and position of the ROI.A novel similarity measure based on the colour and spatial histograms over the lattice structure.Huge speed up the EM-like iteration due to the proposed similarity measure.

@&#KEYPHRASES@&#
Image retrieval,Mean shift,EM,Colour histogram,Spatial distribution,

@&#ABSTRACT@&#
In this paper, a novel region of interest (ROI) query method is proposed for image retrieval by combining a mean shift tracking (MST) algorithm and an improved expectation–maximisation (EM)-like (IEML) method. In the proposed combination, the MST is used to seek the initial location of the target candidate model and then IEML is used to adaptively change the location and scale of the target candidate model to include the relevant region and exclude the irrelevant region as far as possible. In order to improve the performance and effectiveness using IEML to track the target candidate model, a new similarity measure is built based on spatial and colour features and a new image retrieval framework for this new environment is proposed. Extensive experiments confirm that compared with the latest developed approaches, such as the generalized Hough transform (GHT) and EM-like tracking methods, our method can provide a much better performance in effectiveness. On the other hand, for the IEML, the new similarity measure model also substantially decreases computational complexity and improves the precision tracking of the target candidate model. Compared with the conventional ROI-based image retrieval methods, the most significant highlight is that the proposed method can directly find the target candidate model in the candidate image without pre-segmentation in advance.

@&#INTRODUCTION@&#
Image databases can be queried in many ways. So far, the region of interest, i.e. (ROI)-based query, among these is the most common method in research prototypes and commercial products [1,4,9,12–14,19,22]. Typically a query image contains not only the ROIs but also other irrelevant areas. These irrelevant regions limit the effectiveness of content-based image retrieval (CBIR) systems. For an ROI-based query method, a user constructs a query by selecting a target model from a given image. Then the method extracts the features of the target model and compares them with the features of the target candidate model based on a built similarity measure. After that, the method shows the database images, which contain a region most similar to the target model, to the user. As mentioned above, key problem for ROI-based query method is how to extract the features of the relevant region from the current image.Existing CBIR techniques are not effective in processing ROI-based queries. Exclusion of irrelevant regions is not possible for whole-matching approaches based on the entire image, because the features of the entire image area are integrated into one or several global feature vectors. Local-matching approaches are useful if similarity can be quantified over each corresponding homogeneous image region. Approaches such as these are known as region-based. Each image is segmented into several regions and image matching proceeds by comparing visual features. Though this approach has some advantages, its effectiveness depends on image pre-segmentation techniques.Recently, many ROI-based query methods have been developed, which include one method based on a conventional colour histogram (CCH) [2] and another based on the fuzzy colour histogram (FCH) [3]. These ROI query methods adopt hierarchical overlapping segmentation to partition the current image into several overlapping blocks. And both methods compare the colour histogram of the target model to one of each overlapping block to cut off the target candidate model from the current image. The disadvantage of both of these methods is that it is quite difficult to control exactly the hierarchical levels. Vu et al. [1] adopted a sampling-based approach (called SamMatch) to implement the ROI query. This method takes samples of16×16-pixel blocks at various locations in each image and assumes that this size of block is chosen since the correlation between pixels tends to decrease beyond 15 to 20 pixels. The method, however, has not considered the rotation of the ROI. In addition, all these aforementioned methods partition each database image into overlapping regions of several sizes, and assume that the query image has the same size as one of the overlapping regions. Nevertheless, the users may give arbitrarily sized query images. Hence, these methods cannot adaptively decide the size of the ROI.Chan et al. [4] proposed an image retrieval method based on colour variance among adjacent objects (CVAAO), which determines the location and size of the ROI in the current image through features such as shape, area, and position of the largest object, and then cuts off the ROI from the image. The method is also compared to some conventional methods such as CCH, FCH, and SamMatch and confirms it outperforms these conventional methods. One of the latest and better researches is region-based object retrieval using the GHT and adaptive image segmentation proposed in [20], which claims that the GHT gives good performance in terms of retrieval accuracy, robustness, and execution speed. Godec et al. [26] proposed a novel tracking-by-detection approach based on the GHT and show that the GHT-based method can be used to better segment an image and then track the target object, however, the drawback is a higher computational complexity.Furthermore, in the latest decade the MST algorithm has become a popular one due to its simplicity and efficiency. Mean shift is a nonparametric density estimator which iteratively computes the nearest mode of a sample distribution. After it was introduced to the field of computer vision, mean shift has been adopted to solve various problems, such as image filtering, segmentation [7,31] and object tracking [8,32,11,15,27–30]. While the performance of mean shift is promising, various articles have raised concerns about its drawbacks related to the scale and shape of the kernel. For instance, the biggest drawback is that traditional mean shift tracking maintains a constant scale while tracking the target candidate model. Against this drawback, in recent years a number of improved MST algorithms have been presented, which are devoted to investigating an adaptive scale change of the target candidate object during tracking. Amid those methods, the two, most highlighted methods are the EM-like algorithm [6,23] and the CAMShift algorithm [10,33–36], which efficiently solve the mode location and scale of the target candidate model in the process of tracking.For the traditional ROI-based image retrieval methods mentioned above, in order to avoid completely depending on the pre-segmentation of an image prior to matching a target candidate model, in this paper we present a novel framework, which is motivated by the EM-like algorithm and the CAMShift algorithm. Both of these are used to adaptively change the location and scale of the target candidate model, i.e., once an initial location and scale of the target candidate model are given, the optimum mode and scale of this target candidate model must be achieved after the EM-like or CAMShift algorithm has been iterated several times. This implies that if a rough initial location and scale of the target candidate model can be provided in a current image, then the optimum location and scale must be achieved by using either EM-like or CAMShift method. The former is discussed in this paper and our experimental results confirm this assumption to be correct. Based on this idea, our framework is proposed as follows (see Fig. 1).Given a target modelQt, for each image in the database it is a fact that it probably either contains or does not containsQt. Since the candidate imageIcis systematically read into the memory image by image, the image data set can be seen as audio video interleave (AVI) or video and each image amid that can be seen as a frame. Firstly,Icis simply partitioned into a few of sub-blocks according toQt. Secondly, the scale windowQtis slid over these sub-blocks ofIcto find the sub-block most similar toQt. Thirdly, the most similar sub-block is taken as the target candidate model and denoted asQc, the centroid and size ofQcare looked at as the rough initial location and scale of the MST and the IEML. Finally, the IEML is used to find the optimum location and scale ofQcand the similarity measure is calculated betweenQtand the optimumQc.Note that each image in the database must contain such a sub-block that is most similar to the target model; therefore this block is taken as the rough initial target candidate model. By using the MST and IEML to iterate the rough initial candidate model, a much better target candidate model is achieved (in this paper, the iterative numbers of both the MST and the IEML are up to 6). Finally the similarity measure between the target model and the target candidate model is calculated. For the image data set, all image similarity measures are sorted and those images are displayed to the user with respect to the top similarity measures.In summary, the proposed framework includes four major steps as follows: firstly, a simple image partition method is used to seek the rough initial location of the target candidate model; then, based on the rough initial location and scale, the IEML, which combines the colour and spatial features, is applied to optimize the location and scale of the target candidate model. Thirdly, the similarity measure between the target model and the target candidate model is defined, calculated and saved. Finally, according to the similarity measures' ranking, images containing the target candidate model most similar to the target model are exhibited to the user.This paper provides three contributions as follows: the first is that a new framework, in which the MST and the IEML are combined to match the target model with its candidate model over the current image, is proposed. The second is a new colour histogram based on the lattice structure over an elliptical region, which efficiently speeds up the EM-like iteration. The third is that a spatial histogram is integrated into the EM-like procedure, which promotes the robustness of the EM-like tracking algorithm. Moreover, the proposed method also provides a research clue for the salient region detection proposed in [16–18], which recently has become a hot research area in image processing.For this proposed framework there are two challenges to be solved: the first is to seek the rough initial location of the target candidate model, and the second is to define a new similarity measure to decrease the computational complexity and improve the precision using the EM-like to track the target candidate model.The remainder of this paper is organised as follows. Section 2 introduces the new framework. Section 3 presents the representation of the target model and the target candidate model. In Section 4, ROI-based image retrieval with MST and IEML is described. In Section 5, experiments are carried out and compared with the GHT. The concluding remarks are given in Section 6.Here, a completely novel framework is presented for ROI-based image retrieval as follows:Step 1.Make some selections, such as a target image, a target model and a query image database, and then submit these selections to our system, as Fig. 1 shows.The system reads an image into the memory from the specified database, and uses the image partition method to find the initial point of the target candidate model by computing the Bhattacharyya coefficient between the target model and the target candidate model, as Figs. 1(a) and (b) show.Based on the initial point above, the system uses the two methods MST and IEML to adaptively change the candidate model, as Figs. 1(c), (d), (e) and (f) show.Calculate the similarity measure between the elliptical region of the target model, as Fig. 1(2) shows, and one of the target candidate models as in Fig. 1(f) with the colour and spatial features.Save the similarity measure into an array.Loop Step 2 to Step 6 until each image in the database has been traversed and processed.Sort the array of all similarity measures, and return the 24 images regarding the top 24 similarity measures.In this section, in order to carry out the proposed framework, a new colour histogram model, which is exactly limited to the lattice structure of an elliptical region of the ROI, is presented to decrease the computational complexity of the whole rectangular region of the ROI in [6]. Meanwhile, to merge the spatial information of the ROI into the EM-like method, a new spatial histogram is also investigated based on the lattice structure of the elliptical region of the ROI.Similar to [6], in this paper for the colour feature, the colour histogram is to be quantified into8×8×8bins in the RGB space but in the Hue-Saturation-Value (HSV) space the objects are represented using8×8bins to be more robust to the light effects. The two colour histograms are very popular and effective. The former is sensitive to the light effects but the latter is not.In order to facilitate computation during adaptively changing the location and scale of the target candidate model, the elliptical region of the target model and the target candidate model is latticed as shown in as Fig. 1. The centre of the elliptical region is taken as pole and a polar coordinate system can be set up. From inward to outward, a series of ellipses with different sizes are drawn with equal ratio increment Δρ along the polar axis; on the other hand the polar axis is rotated by the same angle increment Δθ in a clockwise direction. Then, a lattice distribution is constructed and each crossing point on the lattice structure is assigned an index. As Fig. 2shows, each crossing point(ρi,θi)may be transformed into the corresponding Cartesian coordinate(xi,yi)over the elliptical region of the ROI, which in fact denotes a pixel position in the current image. Denote these pixel positions to be(1)P={pi=(xi,yi)|i=1,…,N}where N is the number of crossing points on the lattice structure. Fig. 2 shows an instance where the target candidate model is latticed, and all cross points on the lattice structure are to be used for representing the target candidate model. Furthermore, Fig. 3shows the effectiveness when a lattice structure of a target candidate model is projected onto the target candidate model.MPEG-7 has done considerable work in designing efficient descriptors for these features for applications such as similarity retrieval. For this paper it seems to be a good choice that the dominant colour descriptor is used in describing the colour feature of ROI to enhance the application interoperability. However, in order to compute the dominant colour descriptor, the colours present in a given image or region are first clustered [37–40] but this leads to a much higher computational complexity. We define our colour histogram similarly to the colour histograms in [5–9]. However, compared with the former, our colour histogram is defined based on the lattice structure of the target candidate model; therefore, it is easy to see that during the EM-like iteration it substantially reduces the computational complexity.The feature u representing the colour of the target model is assumed to have a density functionqu, while the candidate model centred at location y has the distributionpu(y)for the feature u. Tracking a target is equivalent to finding the position where the Bhattacharyya coefficientρ(y)is maximised. The Bhattacharyya coefficient is defined as follows:(2)ρ(y)=[qu,pu(y)]=∑u=1m(qupu(y))where m is the number of bins of the colour histogram and8×8×8for the RGB colour space or8×8for the HSV colour space in this paper, and u the index with respect to each bin.p(y)and q stand for the colour histogram of the candidate (located at y) and target model respectively. Let b be a function that maps a pixel to its histogram bin. A kernel k is centred at the target model and a weighted colour histogram is computed as follows:(3)qu=C1∑i=1Nqk(‖xiqh‖2)δ[b(xiq)−u](4)pu(y)=C2∑j=1Npk(‖y−xjph‖2)δ[b(xjp)−u]whereC1andC2are normalization constants which makequandpu(y)integrate 1,xiqandNqare the position of pixel i and the number of pixels over the lattice structure of the target model respectively, andxjpandNpare the position of pixel j and the number of pixels over the lattice structure of the target candidate model respectively. δ is the Kronecker delta function, which is defined as(5)δ(x)={1ifx=00otherwiseh is the radius of the kernel profile. The kernel ensures that pixels closer to the centre are given a higher weight than pixels at the periphery of the object window.Later experiments show that compared with the colour histogram and similarity measured in literature [6] the proposed colour histograms and similarity measure based on the lattice structure have been significantly improved in the computational complexity. In this paper experiments carried out show that the IEML's time is less than one third of the EM-like's, while both iteration numbers are taken as 6. Obviously, the computational complexity for the IEML also depends on the lattice structure division.In MPEG-7, the colour structure descriptor (CSD) is designed to express local colour structure in an image or region using an8×8-structure element [37]. It counts the number of times a particular colour is contained within the structuring element as the structuring element scans the image. However, since CSD is used for the8×8-structure element in order to describe the colour spatial distribution for an image or region, obviously it is inflexible to describe an irregular region, especially the elliptical region in our paper. We investigate the way to construct a spatial histogram based on the lattice of the ROI. Suppose the colour space is divided into M bins, the lattice includes N pixels, and pixel i over the lattice is expressed byxi. Also, let Z be the set of all N data points over the lattice and r their mean location [25].(6)r=1N∑i=1NxiIt is well known that each pixel over the lattice is classified into a bin according to functionb(x), and letrmbe the mean location of these pixels belong to bin m(7)rm=1Nm∑i=1Nxiδ(b(xi)−m)whereNmis the number of pixels over the lattice belonging to bin m.(8)rT=∑i=1Mrm=1N∑m=1M∑i=1Nxiδ(b(xi)−m)rTis the total variance that N points over the lattice are mapped into M bins. For each,rmis normalized as follows:(9)r(m)=rm/rT,m=1,2,…,MObviously,∑m=1Mr(m)=1. So, corresponding to the colour histogramq(m)over the lattice, a spatial histogramr(m)which describes the spatial feature of colour distribution of the ROI, is defined over the lattice and owns the same properties as the colour histogram. For the spatial histogram, the Bhattacharyya coefficient can be defined as(10)θ(y)=[sqm,spm(y)]=∑m=1M(sqmspm(y))wheresqm,spm(y)are the spatial histogram of the target model and one of the target candidate models respectively. Fig. 4shows that using the IEML truly achieves a much better effectiveness than that of the EM-like.In this section, we introduce a new framework with MST and IEML, referred to as MSIEM, into ROI-based image retrieval. One of the highlights is that multiple features are merged into the EM-like. The EM-like with multiple features (IEML) will sufficiently enhance the robustness and the precision of tracking the target candidate model. Especially, when two objects or many similar objects appear in an image, most ROI-based algorithms randomly match one object and drop the others. However, the MSIEM always seeks the optimum target candidate model. The proposed MSIEM consists two major stages as follows:1.Stage 1 is to seek a rough initial location and scale of the target candidate model in the current image; this is carried out by the traditional MST.Stage 2 is to iteratively and adaptively change the initial location and scale of the target candidate model by using IEML in the current image; this stage does not end until a given iterative condition for the IEML is satisfied. Here the iterative number is taken as 6.Given an image I, divide it into arbitrary blocks, which depend on a user's requirement. Here, we choose to divide an image into four blocks and calculate their colour histograms as Fig. 5(a) shows. The similarity between each sub-block and the target model is measured by the Bhattacharyya coefficient metric. The sub-block with the largest similarity as Fig. 5(b) shows is assumed to be the approximate position of the candidate model. The centroid coordinate of this sub-block is passed to the IEML algorithm as its initial position. The IEML is used to find the new location and scale of the target candidate model. The position is finally obtained where the Bhattacharyya coefficient is the largest in the whole candidate image. Looking at Fig. 5, an image is divided into four sub-blocks and the Bhattacharyya coefficient of each sub-block is calculated with respect to the target model. Bhattacharyya coefficients of the four sub-block are0.4439,0.6092,0.3259, and 0.4427 respectively. Obviously, we would like to select sub-block 2 as the initial iteration window. Next, MST is used to adjust the scale window and the Bhattacharyya coefficient is attained at 0.74282, at the location of Fig. 5(c). The centroid and size of the scale window are taken as the initial location and scale of the IEML; further more the IEML is used to adaptively change its location and scale until the iterative condition is satisfied.In order to adaptively change the initial location and scale of the target candidate model, letqu,squ,p(y)u,sp(y)ube the colour histogram and spatial histogram of the target model and the target candidate model respectively; y is the initial location of the target candidate model. The Bhattacharyya coefficients of the colour histograms and the spatial histograms between the target model and the target candidate model are denoted asρ1andρ2respectively.(11)ρ1=∑u=1Mqupu(y)(12)ρ2=∑u=1Msquspu(y)Here, a novel similarity measure with colour and spatial features is defined as:ρ(y)=ρ1×ρ2Using a Taylor expansion around the valuesspu(y0)andpu(y0), the Bhattacharyya coefficient is approximated by (see Appendix A):(13)ρ(y)=C1ρ1(y0)2∑i=1Nwi(1)K(⁎)+C2ρ2(y0)2∑i=1Nwi(2)K(⁎)In (13)K(⁎)is a kernel function andwi(1)=∑uqupu(y0)δ(b(xi)−u)wi(2)=∑msquspu(y0)δ(b(xi)−m)Maximising (13) is equivalent to maximisingwi(1)+wi(2). One intuitive interpretation for this result is that the overall MS vector is obtained by weighting each MS components with the Bhattacharyya coefficient. Therefore, the higher coefficient suppresses the other shift vector so that it can be maximised prior to other operations.wi(1)describes the weight of the colour features andwi(2)that of the spatial features. As Eq. (13) shows, the IEML algorithm can retrieve not only similar colour regions, but also similar spatial structure regions.In this subsection, we show an algorithm which adaptively changes the location and scale of the target candidate model. We assume that the shape of the target candidate model is approximated by an elliptical region in an image. Initially the target model is selected manually or detected using some other algorithm, and then the target model is approximated to an elliptical region by using the affine transformation, as Fig. 1(2) shows. Letxi→denote pixel i over the lattice structure of the elliptical region of the target candidate model andθ→the centroid of the elliptical region. The second order moment can be used to approximate the shape of the target candidate model:(14)θ→=1N∑i=1Nxi→;V=1N∑i=1NN(xi→−θ→)(xi→−θ→)TThe second-order moment V which includes scale and orientation is symmetric and positive. Theθ→and V could represent an arbitrary elliptical region. Thescalexandscaleyare scaling and skew is the skew transformation obtained by using the unique Cholesky factorization.(15)V=[scalexskew0scaley]T[scalexskew0scaley]If each data point has multiple weight factorswi(1)+wi(2), the probability density function is(16)f(θ→,V)=(wi(1)+wi(2))N(xi→,θ→,V)whereN(xi→,θ→,V)=|2πV|−12exp⁡(12(xi→−θ→)V−1(xi→−θ→)T)N(xi→,θ→,V)is a Gaussian function. We would like to find the parametersθ→and V to maximise value of (19). This can be done iteratively by using EM-like iterations [6]. From Jensen's inequality we get:(17)log⁡f(θ,V)≥G(θ,V,q1,q2,⋯,qn)=∑i=1Nlog⁡((wi(1)+wi(2))N(xi→,θ→,V)qi)qiwhere∑i=1N=1andqi>0. Repeat the E and M steps described below until a convergence is achieved.E step: findqito maximisef(θ→,V)while keepingθ→(k)andV(k)fixed. It is easy to show that the maximum is achieved when(18)qi=(wi(1)+wi(2))N(xi→,θ→(k),V(k))∑i=1N(wi(1)+wi(2))N(xi→,θ→(k),V(k))M step: maximisef(θ→,V)with respect toθ→and V while keepingqiconstant. Nowqiis fixed, we maximise the part of G according to parametersθ→and V(19)g(θ→,V)=∑i=1Nqilog⁡N(xi→,θ→,V)From∂∂θ→g(θ→,V)=0, we have(20)θk+1=∑i=1Nqixi→=∑i=1Nxi→(wi(1)+wi(2))N(xi→,θ→(k),V(k))∑i=1N(wi(1)+wi(2))N(xi→,θ→(k),V(k))Note that this updated equation for the position estimation is equivalent to the mean-shift update for the Gaussian kernels. For Gaussian kernels Jensen's lower bound has a simple form and leads to simple equations for updating V for the Gaussian kernel. From∂∂Vg(θ→,V)=0we get:(21)V(k)=β∑i=1Nqi(xi→−θ→(k))(xi→−θ→(k))TFig. 6shows the performance of the scale algorithm, with a Gaussian mixture model with three distributions generating the simulated data points. The three modes are clearly visible as Fig. 6 shows, the result for the mean shift is shown in Fig. 6(a) and one for our scale algorithm in Fig. 6(b). We can also observe the position of the local mode and the covariance matrix that describes the shape of the mode. Fig. 7shows a process by which the location and scale of the target candidate model is adaptively evolved by using the IEML to iterate six times. Fig. 8also shows a performance comparison between the EM-like and the IEML with the spatial feature; we find that the target object car with a white side ellipse tracked by using our method is more exact than that with a blue sided ellipse by using the EM-like.

@&#CONCLUSIONS@&#
In this paper, a novel ROI-based image retrieval method with MST and IEML is presented. We have demonstrated that since the colour and spatial features are integrated into the proposed method and both the colour and spatial histograms are based on the lattice structure of the ROI, so that it can more exactly and rapidly adapt to changes of the shape and scale of the ROI during the EM-like iteration. Further more, based on the IEML, the proposed MSIEM method can more robustly and effectively retrieve the image containing the ROI from the image database. The proposed method is used for the ROI-based image retrieval, while the IEML's iteration which takes six times the computational cost is also much less than that of the MGHT. Moreover, compared with the EM-like, if the IEML with the colour and spatial features based on the lattice structure of the ROI is used for tracking the target model, it will be able to significantly reduce the computation cost and hugely promote the tracking precision. In future, we plan to investigate, using the proposed method, the detection and extraction of the salient object in an image, and to explore the differences between the CAMShift, the EM-like and the Hough-based tracking methods.