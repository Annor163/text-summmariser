@&#MAIN-TITLE@&#
Completeness of generating systems for quadratic splines on adaptively refined criss-cross triangulations

@&#HIGHLIGHTS@&#
Hierarchical Zwart–Powell elements are studied.Sufficient conditions for algebraic completeness are given.Construction uses decoupling and partial chessboard functions.Characterization of linear dependencies is provided.

@&#KEYPHRASES@&#
Multilevel spline space,Criss-cross triangulation,Zwart–Powell elements,Completeness,

@&#ABSTRACT@&#
Hierarchical generating systems that are derived from Zwart–Powell (ZP) elements can be used to generate quadratic splines on adaptively refined criss-cross triangulations. We propose two extensions of these hierarchical generating systems, firstly decoupling the hierarchical ZP elements, and secondly enriching the system by including auxiliary functions. These extensions allow us to generate the entire hierarchical spline space – which consists of all piecewise quadraticC1-smooth functions on an adaptively refined criss-cross triangulation – if the triangulation fulfills certain technical assumptions. Special attention is dedicated to the characterization of the linear dependencies that are present in the resulting enriched decoupled hierarchical generating system.

@&#INTRODUCTION@&#
We consider spline spaces spanned by Zwart–Powell (ZP) elements, which were originally introduced by Zwart (1973). These functions are compactly supportedC1-smooth piecewise quadratic spline functions defined on criss-cross triangulations, which are also called four-directional grids or type-2 triangulations (Wang, 2001). ZP elements were also recognized as a special instance of box splines, see de Boor et al. (1993) and the references cited therein.The approximation power of ZP elements has been studied thoroughly in the literature. It was shown by Lyche et al. (2008) that no local quasi-interpolant projector exists for the box spline space defined by translates of the ZP element. Quasi-interpolation operators and the approximation power of ZP elements have been studied by Dahmen and Micchelli (1984), Dagnino and Lamberti (2001) and Foucher and Sablonnière (2008).Various applications of ZP elements and of the spline spaces generated by them have been described in the literature. These include computer tomography (Entezari et al., 2012; Richter, 1998), computation of isophotes (Aigner et al., 2009), approximation of medial surface transforms (Bastl et al., 2010), generation of offset surfaces (Bastl et al., 2008) and numerical simulation (Kang et al., 2014).The underlying criss-cross triangulation, which is associated with the ZP elements, possesses a highly regular structure, which precludes the possibility of adaptive refinement. This is similar to the case of tensor-product splines.Hierarchical splines are one of the main approaches – besides T-splines (Sederberg et al., 2003), PHT-splines (Deng et al., 2008) and LR splines (Dokken et al., 2013) – that were developed to overcome this limitation. Their construction was originally proposed by Forsey and Bartels (1988). About ten years later, Kraft (1997) published a selection mechanism that defines a basis for hierarchial splines and designed a quasi-interpolation operator. Yvart et al. (2005) studied hierarchical triangular splines, whereas Speleers et al. (2009) explored hierarchies of Powell–Sabin splines. Recently, Giannelli et al. (2012) proposed truncated hierarchical B-splines as a modification of Kraft's basis for hierarchical tensor-product splines to restore the partition of unity property without scaling and to improve numerical stability and sparsity properties. Quasi-interpolation operators in this framework were discussed by Speleers and Manni (2016).The applications reported in the literature include surface fitting and reconstruction (Greiner and Hormann, 1997; Kiss et al., 2014) and isogeometric analysis (Vuong et al., 2011; Schillinger et al., 2012). The idea of truncated hierarchical B-splines has recently been generalized to spaces of functions spanned by generating systems that are possibly linearly dependent (Zore and Jüttler, 2014; Kang et al., 2014). In particular, these studies include the case of ZP elements.In fact, Kang et al. (2014) in their paper use adaptively refined spaces spanned by hierarchical ZP elements for isogeometric analysis. Their result concerning linear independence (Lemma 4) unfortunately contradicts the related result of Zore and Jüttler (2014) and relies on local linear independence, which is not satisfied by ZP elements, not even after removing one of them to restore linear independence.The completeness problems for spline spaces is one of the fundamental questions in spline theory. Given a partition of the domain into cells (e.g., a triangulation) and a generating system of smooth piecewise polynomial functions defined on it, does it span the entire spline space consisting of the piecewise polynomial functions with a specified order of smoothness? It is closely related to the computation of the dimension of a spline space. See the monographs of Lai and Schumaker (2007) and Wang (2001) for a detailed introduction.Several approaches to answer the completeness question and to compute the dimension have been proposed in the literature. The very powerful approach of using techniques from homological algebra was introduced by Billera (1988) and has been further explored since, e.g., by Mourrain (2014) and Schenck and Stillman (1997). The important particular case of biquadratic splines on hierarchical T-meshes has been extensively studied using the smoothing cofactor method (e.g., Huang et al., 2006; Zeng et al., 2015), and similar results are available for higher degrees as well. Indeed, the case of tensor-product splines of general degree on hierarchical meshes has attracted particular attention due to the importance for applications.Homological techniques for hierarchical tensor-product splines were used by Berdinsky et al. (2014, 2015). The characterization of the contact of polynomials via blossoming led to the results by Mokriš et al. (2014) and Mokriš and Jüttler (2014). These generalize the earlier results of Giannelli and Jüttler (2013) on bivariate splines to the full multivariate case.The present paper extends the latter approach to the case of bivariate splines on adaptively refined criss-cross triangulations, which are obtained by collecting triangles from a hierarchy of nested criss-cross triangulations. The case of triangulations with only one level is studied in Section 2. Considering triangles from criss-cross triangulations of several levels simultaneously leads us to the definition of the multilevel spline space, which is formalized in Section 3.Since ZP elements are defined on each of the criss-cross triangulations that form the hierarchy, it is natural to produce a generating system by selecting ZP elements of the different levels using a suitably modified version of Kraft's construction. In order to achieve completeness of this generating system, and to control its linear dependencies, we propose to decouple the ZP elements and to enrich the hierarchical generating system by additional functions, see Section 4. Suitably generalizing the techniques of Giannelli and Jüttler (2013) then enables us to establish the completeness property under certain technical assumptions in Section 5 and to analyze the resulting linear dependencies in Section 6.After reviewing some well-known facts about Zwart–Powell box splines, we show that their restrictions span the entire space ofC1-smooth quadratic splines on a multicell domain.We consider the points lying on horizontal, vertical and diagonal linesx=2−ℓiory=2−ℓiorx+y=2−ℓiorx−y=2−ℓi,i∈Z,which form a four-directional gridGℓin the planeR2. Varying the integer ℓ, which is called the level, leads to dyadic refinement and coarsening of the grid. While we keep it constant in this section (choosing, e.g.,ℓ=1), we shall consider grids of different levels in the later part of the paper.The closures of the connected components ofR2∖Gℓare called the cells, and the set formed by them will be denoted byCℓ. Any subset thereof is called a criss-cross triangulation of level ℓ, see Fig. 1. More precisely, we shall speak of a criss-cross triangulation of the domain that is covered by these triangles; often we will omit the information about the level if it is clear from the context.More generally, any set Δ of triangles inR2with mutually disjoint interiors is called a triangulation. The union operatorU(Δ), which is defined byU(Δ)=⋃c∈Δc,transforms each triangulation into a planar domain covered by its triangles.IfΔℓ⊂Cℓis a criss-cross triangulation of level ℓ, then the setDℓ=U(Δℓ)⊂R2shall be called a multicell domain of level ℓ. Clearly it is then also a multicell domain of any levelℓ′larger than ℓ, as we consider nested grids.Conversely, the triangulation operatorTℓof level ℓ, which is defined byTℓ(D)={c∈Cℓ|c⊆D},transforms any setD⊆R2into the maximal criss-cross triangulation covered by it. We omitted the upper index ℓ of D sinceTℓcan be applied to any set.When applied to criss-cross triangulationsΔℓand multicell domainsDℓof level ℓ, the union and triangulation operators are inverses of each other,Tℓ(U(Δℓ))=ΔℓandU(Tℓ(Dℓ))=Dℓ.For any criss-cross triangulationΔℓof level ℓ we will denote the associated multicell domain of level ℓ byDℓand vice versa.Additionally, we introduce the splitting operator S, which transforms each setD⊆R2into the setS(D)that is formed by its maximal connected components, i.e.,D=⋃k∈S(D)˙k,where each k is a connected subset of D that is not contained in any other connected subset of D.We now classify the vertices which are contained in a multicell domainDℓ. A regular vertex is characterized by the fact thatDℓis a topological manifold with boundary in its sufficiently small neighborhood. Each regular vertex belongs to one of the types schematically shown in Table 1(up to rotations by integer multiples ofπ/2and reflections). The symbols shown below denote the number of vertices of the particular type, where e and f stands for vertices of valence 8 and 4 in the underlying grid and the lower index specifies the number of incident triangles. We omit the index ℓ to simplify the notation.The remaining vertices will be called kissing vertices. Based on their valence with respect to the underlying grid, they will be called valence-4 kissing vertices and valence-8 kissing vertices, respectively. An example is shown in Fig. 2. Note that the valence does not refer to the criss-cross triangulation ofDℓbut to the underlying grid. There is only one possible type of a valence-4 kissing vertex, while several types of valence-8 kissing vertices exist, see Fig. 2.Definition 1We define the spline space of degree d and smoothness r on a triangulation Δ by(1)Sdr(Δ)={σ∈Cr(U(Δ))|∀c∈Δ:σ|c∈Pd|c},wherePd|cis the space of polynomials of degree d restricted to the triangle c.In this definition, we useCr(F)to denote the space of all functions defined onF⊂R2that possess continuous partial derivatives up to order r in the interior of F and which can be continuously extended to the closureF‾. Consequently, the spline space (1) is well defined even for multicell domains where kissing vertices are present.In the remainder of this section, we analyze the dimension of the spline spaceS21(Δℓ)on a criss-cross triangulationΔℓof level ℓ.Lemma 2IfΔℓdoes not contain any kissing vertices, then(2)dim⁡S21(Δℓ)=6+e8+12(∑i=17(i−1)vi−3f4)withei=eia+eibfori∈{2,4,6}andvi=ei+fi, where all undefined quantities are equal to zero, e.g.,f5=0.ProofThe term in the parentheses in (2) counts the incident inner edges of all boundary vertices. This equals twice the number of the cross-cuts ofΔℓ, which are the line segments that intersect the boundary ofDℓexactly in their end points. The formula (2) is then a special case of Wang (2001, Theorem 2.2).  □For eachi∈Z2we define the Zwart–Powell (ZP) elementζiℓon the level ℓ criss-cross triangulation by its Bernstein–Bézier coefficients as shown in Fig. 3. The center of the support of such an element is the point2−ℓ(i+(12,12)).For each ZP elementζiℓand a domainD⊆R2we define support componentsS(suppζiℓ∩D)as the connected components of the support of the restricted functionζiℓ|D. Note that we takesuppf(x)={x∈R2|f(x)≠0}and, therefore, in the case of ZP elements, the support is an open set. Note also that in case of a kissing vertex, one has to take special care: such a vertex may splitsuppζiℓ∩Dinto several connected components only if it is on the boundary of the octagonsuppζiℓ. An example is shown in Fig. 4.Since we will need to refer to the support components for the different ZP elements, we introduce the index setIDℓ=⋃i∈Z2{i}×S(suppζiℓ∩D),which consists of pairsıˆ=(i,s)where s is a support component ofζiℓ.Definition 3The separated generating systemRDℓ={ϱıˆℓ|ıˆ∈IDℓ}on a domainD⊆R2is formed by the restrictions of the ZP elements to their support components (each considered separately)ϱ(i,s)ℓ(x)={ζiℓ(x)ifx∈s,0otherwise.These are indexed byıˆ=(i,s)∈IDℓ.Note that the restriction of a ZP element to D is decomposed into separated ZP elements(3)∑s∈S(suppζiℓ∩D)ϱ(i,s)ℓ(x)=ζiℓ(x)forx∈D.The sum is empty if no support component exists. It consists of one or more contributions otherwise.Lemma 4IfD=cis a single cell of level ℓ, thenRcℓconsists of seven functions and any six of them are linearly independent.ProofThis can be confirmed by a direct computation using the Bernstein–Bézier representations of the ZP elements, see Fig. 3. The seven local coefficient vectors form the matrix(200000221224000020001220244424221000001000)and removing any row thereof produces a regular matrix.  □We extend this observation to connected multicell domains.Lemma 5Removing at least one function fromRDℓℓproduces a linearly independent system ifDℓis a connected multicell domain of level ℓ.ProofAfter removing at least one function, we obtain a subsetR′⊊RDℓℓ. We consider a linear combination of the zero function by functions inR′with certain coefficients. The differenceRDℓℓ∖R′contains one or more functions and we consider all cells c in their combined support. The previous lemma implies that the coefficients of all functions inR′with a support containing at least one of these cells are equal to zero. Adding these functions to the difference set then increases the number of cells in the combined support sinceDℓis connected, unless the cells already coverDℓentirely. Using the same argument repeatedly shows that all coefficients are equal to zero. □The coefficientsχıˆ=χ(i,s)=(−1)(i1+i2)will be called the chessboard pattern. Note that their values are independent of s.Lemma 6Any representation(4)0=∑ıˆ∈IDℓℓαıˆϱıˆℓ(x)of the zero function on a connected multicell domainDℓof level ℓ has coefficients of the formαıˆ=λχıˆfor some scalar λ.ProofA direct computation using the Bernstein–Bézier representation (see Fig. 3) confirms(5)0=∑ıˆ∈IDℓℓχıˆϱıˆℓ(x).Consequently, any functionϱıˆ′ℓwithıˆ′∈IDℓℓcan be represented as a linear combination(6)ϱıˆ′ℓ=−∑ıˆ∈IDℓℓ∖{ıˆ′}χıˆχıˆ′ϱıˆℓof the remaining functions. Given an identity of the form (4), using the representation (6) of the functionϱıˆ′ℓtransforms it into a linear combination of functions inRDℓℓ∖{ϱıˆ′ℓ}with coefficientsαıˆ−αıˆ′χıˆ′︸=λχıˆ.These coefficients are equal to zero, as the functions are linearly independent according to Lemma 5. This completes the proof. □Note that any two functionsϱ(i,s)ℓandϱ(i,s′)ℓthat are derived from the same functionζiℓ(see Definition 3) are multiplied by the same coefficientλχıˆin (4).Definition 7A multicell domainDℓis admissible, if its connected components are simply connected and no valence-4 kissing vertices are present inTℓ(Dℓ).Definition 7 rules out multicell domains with holes. Some admissible and non-admissible level ℓ multicell domains are presented in Fig. 5.Theorem 8IfDℓis an admissible multicell domain of level ℓ, then the separated generating system on its criss-cross triangulationΔℓof level ℓ is complete, i.e.,(7)span{ϱıˆℓ|ıˆ∈IDℓℓ}=S21(Δℓ).ProofThe proof consists of two steps: Firstly, we prove the theorem in the case of a single connected component without kissing vertices, based on the dimension result (2). Secondly, we extend it to domains with valence-8 kissing vertices and several connected components.Step 1. We consider a simply connected domain without kissing vertices. According to Lemma 5 it suffices to prove that(8)dim⁡S21(Δℓ)=|IDℓℓ|−1.A careful case-by-case analysis, which is similar to the offset counting by Mokriš et al. (2014), leads to(9)|IDℓℓ|=|{ϱıˆℓ|ıˆ∈IDℓℓ}|=2e1+2f1+e2a+2e2b+f2+e3+e4b+f4−e6a−2e7+εb,whereεbis the number of axis-aligned (i.e., horizontal or vertical) boundary edges. Substituting (9) and (2) into (8) results (after rewriting) in the equivalent formula(10)2εb+4e1+4f1+e2a+3e2b+f2−2f3−3e4a−e4b+2f4−4e5−7e6a−5e6b−8e7−2e8−14=0,which is now proved with the help of four identities:(i)Each axis-aligned boundary edge has two incident vertices and each boundary vertex has between zero and two incident axis-aligned boundary edges, depending on its type, thus2εb=e1+2e2a+e3+2e4a+e5+2e6a+e7.Each non-axis-aligned (i.e., diagonal) boundary edge connects one vertex of valence 4 with one vertex of valence 8, and each boundary vertex has between zero and two incident non-axis-aligned boundary edges. Counting the contributions of the boundary vertices of the two different valencies separately gives2f1+2f2+2f3=e1+2e2b+e3+2e4b+e5+2e6b+e7.A similar observation, applied to the interior non-axis-aligned edges givesf2+2f3+4f4=e2a+e3+2e4a+e4b+2e5+3e6a+2e6b+3e7+4e8.The boundary of the domain is a simple closed curve, hence the total turning of the tangent vector equals 2π. Summing up the turning angles for the different types of boundary vertices confirms that(3e1+2f1+2e2a+2e2b+e3−2f3−e5−2e6a−2e6b−3e7)π4=2π.Step 2. First we extend our result to simply connected domains with valence-8 kissing vertices. Such a domain can be subdivided at the kissing vertices into several simply connected parts. (For instance, the domain in Fig. 5 (right) is subdivided into 6 connected parts without kissing vertices.) Any function inS21(Δℓ), which is defined on the entire domain, can be represented as a linear combination of the functions in the separated generating system on each of these parts. Clearly, each of these representations can be modified by adding a real multiple of the chessboard pattern, since the coefficients thereof correspond to the zero function.We number the parts, starting with 1, so that each part is connected by a kissing vertex to exactly one part with a lower number, except for the first one. At each kissing vertex, exactly four functions in each of the separated generating systems on the parts joining there take non-zero values. We visit the parts according to the chosen ordering and add a scaled multiple of the chessboard pattern to make sure that one of the four associated coefficients takes the same value. Since the function isC1-smooth at the kissing vertex, the remaining three coefficients take the same values too, as there are three equations characterizing aC1-joint at the kissing vertex. This completes the proof for simply connected domains with valence-8 kissing vertices.Finally, we note that, since the support components are considered separately, the theorem extends to admissible domains with more than one connected component, as the representations on the different components are independent of each other.  □Theorem 8 does not generalize to domains possessing valence-4 kissing vertices, since there are five functions in each of the separated generating systems on the parts joining there that take non-zero values. Moreover, the theorem is not valid for non-admissible domains, as demonstrated by the following example.Example 9We consider the level 0 multicell domainD0shown in Fig. 6(left), which is not admissible in the sense of Definition 7. Removing the dashed line segment AB transforms it into a simply connected domain. The dimension of the spline space defined on that domain is equal to 41 according to Lemma 2. EnforcingC1-smoothness across AB reduces the dimension of the space by 5, thereforedim⁡S21(Δ0)=36. The number of linearly independent functions in the separated generating system, however, amounts to 35 only. Consequently this system does not generate the entire spline space onD0.The construction of a function inS21(Δ0)∖spanRD00is shown in Fig. 6 (right). The function is equal to zero everywhere except in the green region. Within that region, the function is defined as a linear combination of the six ZP elements with the coefficients specified in the picture. Due to the choice of these coefficients as a subset of a chessboard pattern, the function isC1-smooth and therefore belongs toS21(Δ0). However, it does not admit a representation by ZP elements of level 0.Indeed, this function can be represented as a linear combination of 42 ZP elements on the simply connected domain obtained after removing AB, where only six coefficients (the ones shown in the figure) take non-zero values. These six coefficients correspond to the six ZP elements that are split into pairs of separated functions, and the non-zero coefficients are assigned to the separated functions that act on the right-hand side of AB. This representation on the simply connected domain is unique up to additions of multiples of the chessboard pattern. However, no addition of such a multiple gives a representation with the property that the six pairs of coefficients of the separated ZP elements possess matching values. ⋄In the remainder of the paper we consider criss-cross triangulations of several levels and the ZP elements defined on them simultaneously. An adaptively refined spline space is defined with the help of a hierarchy of subdomains.More precisely, given a bounded domainΩ0⊂R2, the definition of a hierarchical spline space is based on a nested sequence ofN+1subdomainsΩ0⊇Ω1⊇⋯⊇ΩN−1⊇ΩN=∅,where N denotes the number of levels in the hierarchy. SettingΩN=∅simplifies some of the definitions below.Each subdomainΩℓrepresents the part ofΩ0selected for refinement to functions of level ℓ, in order to benefit from the increased approximation properties in this region.We will assume that each difference setDℓ=Ω0∖Ωℓ+1‾,ℓ=−1,…,N−1,is a multicell domain of level ℓ. This is automatically satisfied if eachΩℓ+1is a multicell domain of level ℓ. In particular, we have thatD−1=∅andDN−1=Ω0.Definition 10The spline spaceH=S21(ΔH), which is defined on the adaptively refined triangulationΔH=⋃ℓ=0N−1Tℓ(Ωℓ∖Ωℓ+1‾),will be called the multilevel spline space.The adaptively refined triangulationΔHis obtained by triangulating each setΩℓ∖Ωℓ+1individually using cells of level ℓ. Combining these gives a triangulation of the entire domainΩ0, possibly with cells of different levels. The individual triangulations are obtained by applying the triangulation operatorTℓfrom Section 2.The following equivalent characterization of the multilevel spline space will be useful.Lemma 11The multilevel spline space can be equivalently characterized byH′={σ:Ω0→R|∀ℓ=0N−1:σ|Dℓ∈S21(Δℓ)},i.e.,H=H′.ProofOn the one hand, the inclusionH⊆H′follows from the fact thatΔℓis a finer triangulation of the domain covered by⋃k=0ℓTk(Ωk∖Ωk+1‾)forℓ=0,…,N−1. On the other hand, any spline functionσ∈H′isC1-smooth onΩ0sinceU(ΔN−1)=DN−1=Ω0. Moreover, it is a single polynomial on each triangle inΔH. Indeed, for eachc∈ΔHthere exists a level ℓ such thatc∈Δℓandσ∈S21(Δℓ). We conclude thatσ∈S21(ΔH)=H. □The next section proposes a generating system for the multilevel spline space. An affirmative answer to the completeness question will be given later in Section 5.We introduce decoupled Zwart–Powell elements and auxiliary functions, which we will call partial chessboard functions. The enriched decoupled hierarchical generating system is then constructed using a selection procedure which is inspired by the work of Kraft (1997).It should be noted that we use a slightly modified definition of the support in the remainder of the paper. Since the domain of all functions under consideration is the setΩ0introduced in Section 3, all supports are understood as subsets thereof, i.e.,supp0f={x∈Ω0|f(x)>0}.The grids of adjacent levels are nested,Gℓ⊂Gℓ+1. Each ZP element of level ℓ can be represented as a linear combination of 12 elements of levelℓ+1with the coefficients shown in Fig. 7. Consequently, the space generated by the ZP elementsZℓ={ζiℓ|i∈Z2}of level ℓ is a refinement of the coarser space spanned by the elements of the coarser levels. Raising the level ℓ increases the approximation power, see Foucher and Sablonnière (2008).In Section 2, we introduced the separated generating systems by considering the support components of the ZP elements with a given multicell domainDℓ. This system, however, consists of functions that are defined onDℓonly. We will now use the refinability of ZP elements to construct decoupled functions that continuously extend the separated ones toR2. In order to do so, we need an assumption, which we call the support intersection condition(SIC):(SIC)∀ℓ=0N−2∀i∈Z2:supp0ζiℓ+1∩Dℓis connected.This condition is illustrated in Fig. 8, which shows several hierarchical grids consisting of two levelsℓ=0,1and the support of ZP elements of level 1 (hatched). The setD0consists of all cells that belong to the coarser grid. SIC is satisfied for the first two triangulations (left and center) since the support components withD0are all connected, while this is not the case for the third one (right).SIC is automatically satisfied if each triangulationT(Dℓ)possesses no vertices of typef1,f2andf3, i.e., the multicell domainsDℓconsist of squares formed by the four triangles incident to vertices of typef4, see again Fig. 8 (left).Definition 12For each indexıˆ=(i,s)∈IDℓℓwe define the decoupled function(11)γıˆℓ=γ(i,s)ℓ=∑{j|supp0ζjℓ+1∩s≠∅}ci,jζjℓ+1,where the coefficientsci,jare determined by representing the ZP elementζiℓwith respect to the ZP elements of the next finer level, i.e.,(12)ζiℓ=∑j∈Z2ci,jζjℓ+1,using the refinement relation shown in Fig. 7. All decoupled functions of level ℓ form the setGℓ.Note thatsupp0ζiℓ⊆Dℓimpliesγıˆℓ=ζiℓwhereıˆ=(i,supp0ζiℓ).The construction of decoupled functions is visualized in Fig. 7. A ZP element of level 0, whose support is the entire octagon, is used to define two decoupled functions according to (11). This element possesses two support components. The ZP element is represented as a linear combination of 12 ZP elements of level 1 with coefficients shown in the circles, which are then grouped according to the associated support components. The green and blue coefficients correspond to the left and the upper right support component. The supports of the elements associated with the red coefficients do not intersectD0. Consequently, we obtain two decoupled functions in this case, the supports of which (hatched regions) are shown in green and blue.Lemma 13(SIC)implies that the decoupled functions satisfyγıˆℓ(x)=ϱıˆℓ(x)for allx∈Dℓ.Therefore,Gℓ|Dℓ=RDℓℓ.ProofSIC implies that the support of each of the finer elements in (12) intersectsDℓin at most one support component ofζiℓ.  □Since the support components s of the ZP elements of level ℓ are contained inDℓ, the supports of the decoupled functionsγıˆℓare not entirely contained inΩℓ+1.We classify the decoupled functions according to the intersection of their supports withΩℓandDℓ−1. We collect the functions with support contained inΩℓin the set(13)Hℓ={γıˆℓ|ıˆ∈Jℓ},whereJℓ={ıˆ|supp0γıˆℓ⊆Ωℓ}.The supports of the remaining functions intersectDℓ−1. For each connected componentk∈S(Dℓ−1), we collect the decoupled functions of level ℓ that take non-zero values there,Pkℓ={γıˆℓ|supp0γıˆℓ∩k≠∅}.The setsPkℓare mutually disjoint. Indeed, the supports of the ZP elementsζiℓintersect at most onek∈S(Dℓ−1)due to SIC andsupp0γ(i,s)ℓ⊆supp0ζiℓ.For each connected componentk∈S(Dℓ−1)we define the partial chessboard as the function(14)πkℓ(x)=∑γıˆℓ∈Pkℓχıˆγıˆℓ(x),where the coefficientsχıˆare taken from the chessboard pattern defined in Section 2.Lemma 14The supports of the partial chessboardsπkℓ,k∈S(Dℓ−1), are contained inΩℓ.ProofWe rewriteΩℓasΩℓ=Ω0∖Dℓ−1=Ω0∖⋃k∈S(Dℓ−1)k.Combining Lemma 13,k⊆Dℓand (5) confirmsπkℓ|k=0, whereasPk′ℓ∩Pkℓ=∅impliesπkℓ|k′=0fork′≠k.  □Fig. 9shows an adaptively refined triangulation and the supports (red and green regions) of the two partial chessboards of level 1 defined on it. The colored circles (blue/green and red/yellow, respectively) correspond to the decoupled functions in the setsPk1.The definition of the setsHℓuses the selection mechanism, which was introduced in Kraft (1997) to define a basis for hierarchical B-splines. We generalize this mechanism by applying it to decoupled functions and enriching the result with partial chessboards.Definition 15The set(15)H+=⋃ℓ=0N−1Hℓ∪{πkℓ|k∈S(Dℓ−1)}︸=H+ℓ,is called the enriched decoupled hierarchical generating system (EDHGS).It should be noted that the definition of EDHGS assumes SIC, since this assumption is needed for the definition of the partial chessboards.Fig. 10summarizes the relationships between the definitions in this section. The decoupled functionsγıˆℓ∈Gℓare derived from the ZP elementsζiℓ∈Zℓ. They are then classified according to their supports, forming the setsPkℓandHℓ. The setsPkℓdefine partial chessboards. Finally, combining those with the selected functionsHℓprovides the contributionH+ℓof each level to the EDHGS.We show that the enriched decoupled hierarchical generating system is complete, i.e., that it spans the entire hierarchical space defined in Section 3. We need to assume – in addition to SIC, which is required by the definition of the EDHGS – that the multicell domainsDℓare all admissible. This is equivalent to requiring that each connected component ofΩℓcontains at least one point on the boundary ofΩ0.Theorem 16The EDHGS spans the entire multilevel spline space,spanH+=H, if each difference setDℓis an admissible multicell domain of level ℓ.ProofThe proof is inspired by that of Theorem 20 by Giannelli and Jüttler (2013). The EDHGS, however, is not linearly independent, thus the original proof does not apply directly.On the one hand,spanH+⊆H, as all the functions inH+are elements ofHas well. On the other hand, we consider anyσ∈Hand show that it is contained inspanH+.We start by considering the restrictionσ0=σ|D0, which is an element of the spline spaceS21(Δ0). According to Theorem 8 and Lemma 13 it can be written asσ0=∑ıˆ∈ID00αıˆ0γıˆ0|D0=∑ıˆ∈J0αıˆ0γıˆ0|D0∈spanH+0,with certain coefficientsαıˆ0, sinceID00=J0, cf. (13).We now consider the remainderσ1=(σ−∑ıˆ∈J0αıˆγıˆ0)|D1,which belongs to the spline spaceS21(Δ1). Invoking Theorem 8 and Lemma 13 again, we obtain the representation(16)σ1=∑ıˆ∈ID11αıˆ1γıˆ1|D1,with certain coefficientsαıˆ1. Sinceσ1|D0=(σ−σ0)|D0is equal to zero on each connected componentk∈S(D0), there exist scalarsλk1such that the coefficients satisfyαıˆ1=λk1χıˆfor allıˆ∈Ik1, due to Lemma 6. The corresponding parts of the representation (16) can therefore be expressed by partial chessboards,∑ıˆ∈Ik1αıˆ1γıˆ1=λk1πk1.We rewrite (16) as(17)σ1=∑ıˆ∈J1αıˆ1γıˆ1|D1+∑k∈S(D0)λk1πk1|D1∈spanH+1.Proceeding to the next level, we find a representation ofσ2=(σ−∑ıˆ∈J0αıˆ0γıˆ0−∑ıˆ∈J1αıˆ1γıˆ1−∑k∈S(D0)λk1πk1)|D2∈spanH+2,and similarly for all higher levelsℓ=3,…,N−1. In the final step we obtain a representationσN−1=(σ−∑ıˆ∈J0αıˆ0γıˆ0︸∈spanH+0−∑ℓ=1N−2(∑ıˆ∈Jℓαıˆℓγıˆℓ+∑k∈S(Dℓ−1)λkℓπkℓ)︸∈spanH+ℓ)|DN−1∈spanH+N−1.This completes the proof ofσ∈spanH+, sinceDN−1=Ω0.  □Remark 17If each difference setDℓis connected, i.e.,|S(Dℓ)|≤1, then the above theorem remains valid for the non-enriched decoupled hierarchical generating systemH=⋃ℓ=0N−1Hℓas well. Moreover, the theorem can be extended to non-enriched non-decoupled hierarchical generating systems by assuming a stronger version of SIC.The assumption of Theorem 16 that each difference setDℓis an admissible multicell domain implies that eachΩℓis required to be connected to the boundary. This could be guaranteed by choosing a refinement strategy that always generates a thin stripe connecting the refined domain to the boundary. Thanks to the decoupling, it suffices to choose the width of this stripe as one cell of level ℓ. Fig. 11(left) shows domains selected for refinement to level 1 and 2 (light and dark gray, respectively) as well as the stripes added to reach the boundary.Finally, we present an example to show that the assumptions of Theorem 16 are indeed necessary for completeness of the EDHGS.Example 18We consider the adaptively refined triangulation shown in Fig. 11 (right). The function, which is defined as the linear combination of the 8 ZP elements of level 1 with the coefficients specified in the picture, has been constructed by representing the function from Example 9 in the next finer level, using the refinement coefficients shown in Fig. 7. It clearly belongs to the multilevel spline space, since its restriction toΔ0is equal to the function from Example 9 and it also obviously belongs toS21(Δ1), as it is a linear combination of level 1 ZP elements. However, it does not admit a representation with respect to the EDHGS, cf. Example 9. ⋄Adding the function from this example to the EDHGS resolves the completeness problem in this specific case. We conjecture that this idea can be extended to more general configurations, thereby eliminating the assumption regarding the admissibility of the difference sets. A more detailed investigation of this issue is beyond the scope of the current paper.Any functionf∈spanH+possesses a representation(18)f=∑ℓ=0N−1(∑ıˆ∈Jℓdıˆℓγıˆℓ+∑k∈S(Dℓ−1)pkℓπkℓ),where(dıˆℓ)ıˆ∈Jℓand(pkℓ)k∈S(Dℓ−1)are vectors of real coefficients andS(D−1)=∅.A linear dependency relation (LDR) is a system of coefficients(dıˆℓ)ıˆ∈Jand(pkℓ)k∈S(Dℓ−1),ℓ=0,…,N−1, such that the corresponding function f defined in (18) is equal to zero.The LDRs form a linear space and we specify a basis for it; thus the linear dependencies ofH+are well-controlled. One may see this in the terminology of operators: Equation (18) implicitly defines the evaluation operatorE:R|H+|→R, which can be applied to a system of coefficients. We provide a basis forker⁡(E).Lemma 19The equation(19)0=∑{(i,s)∈Jℓ|s⊆k}χ(i,s)ℓγ(i,s)ℓ+∑{k′∈S(Dℓ−1)|k′⊆k}πk′ℓ,holds for each level ℓ and for each connected componentk∈S(Dℓ). Consequently, the associated system of coefficients (which are all equal to zero except for some coefficients of level ℓ) forms an LDR.ProofWe use the definition of the partial chessboard (14) to rewrite the right-hand side of equation (19) as(20)∑{(i,s)|s⊂k}χiℓγ(i,s)ℓ.This sum involves all decoupled functions of level ℓ which take non-zero values on k and their coefficients form a chessboard pattern.Firstly we consider its restriction to k. We rewrite it using (3) and Lemma 13 and obtain(21)∑{i|suppζi∩k≠∅}χiℓζiℓ,which equals zero everywhere (on k) according to Lemma 6.Secondly, considering the right-hand side (20) again for general arguments (i.e., also outside k), we express it in terms of ZP elements of the next finer levelℓ+1using the refinement relation (11). This representation involves only ZP elements of levelℓ+1with supports that intersect k, due to the definition of the decoupled functions (11) and the partial chessboards (14). The coefficients of these ZP functions of levelℓ+1, however, are obtained by refining the chessboard pattern (21), and this is known to produce zero coefficients only (Zore and Jüttler, 2014, Example 22). This completes the proof.  □The equations in Lemma 19 are instances of evaluations of linearly independent LDRs. The linear independence is obvious since the equations involve mutually disjoint sets of coefficients. We will refer to them as Linear Dependency Generators (LDGs).An example for LDGs of levelℓ=1is shown in Fig. 12. Two such LDGs are obtained in this case, sinceS(D1)possesses two connected components (shown in gray). The LDG on the left connected component involves two partial chessboards (visualized by the red dots that represent the participating decoupled functions) and 76 decoupled functions (represented by blue dots). The other LDG involves 48 decoupled functions (represented by green dots) but no partial chessboard. In total, we get two LDGs of level 0 (each involving 18 decoupled functions but no partial chessboard), two of level 1 and one of level 2 (involving two partial chessboards and 88 decoupled functions) in this situation.We show that the system of LDGs from Lemma 19 forms a basis of the space of LDRs. Consequently, the number of LDRs equalsdim⁡ker⁡(E)=∑ℓ=0N−1|S(Dℓ)|.It should be noted that the definition of the EDHGS assumes that SIC is satisfied.Theorem 20Any LDR that is present in the EDHGS is a linear combination of the LDGs inLemma 19.ProofWe consider an LDRf=0, where f is defined in (18), and re-arrange the sum according to the levels ℓ and the connected components ofDℓ,(22)0=∑ℓ=0N−1∑k∈S(Dℓ)(∑(i,s)∈Jℓ,s⊆kd(i,s)ℓγ(i,s)ℓ+∑k′∈S(Dℓ−1),k′⊆kpk′ℓπk′ℓ).Note that the index sets of the sums within the brackets for different values ofℓ,kare mutually disjoint, since we assume SIC.Forℓ=0and the first connected component k, the only functions that are active on k are the decoupled functionsγ(i,s)0with indices satisfying(i,s)∈J0,s⊆k, but no partial chessboards. Invoking Lemma 6 confirms that the associated coefficients are a multiple of the corresponding LDG.We now continue by considering the levels ℓ from 0 toN−1and visiting one connected component k after the other. In each step we prove that the associated coefficients are a multiple of the corresponding LDG. This is possible since the coefficients of the previously considered decoupled functions and partial chessboards have been chosen so that their sum is equal to zero (as they are linear combinations of LDGs) and the supports of the remaining decoupled functions and partial chessboards do not intersect k.Consequently, the only functions that are active on k are the decoupled functionsγ(i,s)ℓwith indices satisfying(i,s)∈Jℓ,s⊆k, and the partial chessboardsπk′ℓwith indicesk′∈S(Dℓ−1),k′⊆k. The latter ones can be split into decoupled functions according to (14). Invoking Lemma 6 again confirms that the associated coefficients are a multiple of the corresponding LDG.  □Corollary 21The dimension of the multilevel spline spaceHequalsdim⁡H=|H+|−∑ℓ=0N−1|S(Dℓ)|if each ringDℓis an admissible multicell domain of level ℓ. A basis ofHis obtained by removing one of the functions involved in each of the LDGs fromH+.Under the assumptions of the previous corollary,dim⁡H=∑ℓ=0N−1|Hℓ|−S(Ω0).In particular, this agrees with the observation that there is exactly one LDR among the separated functions of one level on a simply connected domain.

@&#CONCLUSIONS@&#
We defined the enriched decoupled hierarchical generating system (EDHGS) of ZP elements on adaptively refined criss-cross triangulations. The definition assumes that the subdomains – which represent the regions selected for refinement to a certain level – are chosen such that the resulting difference sets satisfy SIC. This assumption can be ensured by always refining sufficiently wide subdomains.The completeness of the EDHGS was proved under an additional assumption. More precisely, the difference sets need to be admissible. This condition is fulfilled if each component of the refined area is connected to the boundary of the domain.In addition, we studied the linear dependencies that are present in the EDHGS. They can be controlled easily and linear independence can be restored by simply eliminating one of the functions involved in each of the linear dependency generators, which have been identified. Combining this with the completeness result allows to compute the dimension of the multilevel spline space.Future work may be devoted to the generalization of our approach to other classes of box splines.