@&#MAIN-TITLE@&#
Improved characterization of HRV signals based on instantaneous frequency features estimated from quadratic time–frequency distributions with data-adapted kernels

@&#HIGHLIGHTS@&#
Improved quadratic TFDs with lag-independent kernels to characterize HRV signals.Instantaneous frequency based HRV features for the detection of perinatal hypoxia.The proposed TFD can enhance the ability of resulted features for hypoxia detection.

@&#KEYPHRASES@&#
Time–frequency distribution,Lag-independent kernel,Heart rate variability,Instantaneous frequency,Perinatal hypoxia detection,

@&#ABSTRACT@&#
The analysis of heart rate variability (HRV) provides a non-invasive tool for assessing the autonomic regulation of cardiovascular system. Quadratic time–frequency distributions (TFDs) have been used to account for the non-stationarity of HRV signals, but their performance is affected by cross-terms. This study presents an improved type of quadratic TFD with a lag-independent kernel (LIK-TFD) by introducing a new parameter defined as the minimal frequency distance among signal components. The resulting TFD with this LIK can effectively suppress the cross-terms while maintaining the time–frequency (TF) resolution needed for accurate characterization of HRV signals. Results of quantitative and qualitative tests on both simulated and real HRV signals show that the proposed LIK-TFDs outperform other TFDs commonly used in HRV analysis. The findings of the study indicate that these LIK-TFDs provide more reliable TF characterization of HRV signals for extracting new instantaneous frequency (IF) based clinically related features. These IF based measurements shown to be important in detecting perinatal hypoxic insult – a severe cause of morbidity and mortality in newborns.

@&#INTRODUCTION@&#
Heart rate variability (HRV), defined as the variation of inter-heartbeat intervals, provides a large amount of information on the autonomic regulation of the cardiovascular system. Since HRV can be readily estimated through electrocardiogram (ECG) recordings, it has been used as a non-invasive tool to assess the autonomic nervous system (ANS) functions [1,2].The relationship between the HRV and ANS activity is established by frequency domain analysis [3]. Three spectral components are generally recognized in HRV signals (Fig. 1), namely: the high frequency (HF) component related to the vagally-mediated respiratory sinus arrhythmia, the low frequency (LF) component associated with both sympathetic and vagal regulation and the very low frequency (VLF) component linked to various neurological and hormonal factors [3]. The frequency domain analysis of HRV signals is performed under the assumption of quasi-stationarity, which means that the spectral components do not vary over time [4]. However, in some practical cases, subjects are examined in unstable states. As a result, HRV signals present non-stationarities caused by an abrupt change of the autonomic modulation, as occasioned by acute hypoxia [5] or anesthesia [6]. If not taken into account properly, this may significantly reduce the accuracy and reproducibility of HRV spectral features [4].To overcome the limitation of frequency domain analysis, a number of time–frequency (TF) analysis methods have been used to characterize HRV signals [7]. Time–frequency distribution (TFD) is one of these methods and highly popular for its potentiality of extracting HRV features for detection and classification purposes [8]. Fig. 2outlines the methodology in detection and classification using TFD-based features extracted from HRV signals. This generally involves ECG acquisition, generation of HRV signals from ECG, TFD mapping, feature estimation and final decision-making.A TFD represents signals simultaneously in both time and frequency domains jointly, and the quadratic TFD (QTFD) is a subclass of the TFD in which the signal kernel is of quadratic form [9,10]. At the core of QTFDs is the Wigner–Ville distribution (WVD) which can accurately represent mono-component linear frequency modulated (LFM) signals. However, due to its quadratic nature, the WVD generates inner cross-terms for signals with nonlinear FM components and outer cross-terms for signals with multi-components [10]. The WVD of HRV signals generally contains both types of cross-terms; nevertheless, the outer type is more prominent because the signal components are close, whereas the inner type is less disturbing as the components have slowly varying IF laws (as will be seen in Figs. 7 and 9 in Sections 3.4 and 3.5). These cross-terms may confuse the identification and interpretation of the components of interest in HRV analysis and reduce the effectiveness of TFD-based HRV features in detection and classification.The cross-terms in TFDs can be reduced by applying a smoothing kernel but at the expense of the TF resolution. Considerable efforts have been made to design effective kernels to compromise the cross-term reduction and TF resolution enhancement [10–19]. One early attempt was to use the exponential function in the ambiguity domain to filter out the cross-terms [15]. To further improve the resolution, reduced interference distributions (RIDs) have been introduced with the property that the kernels have a 2-dimensional low-pass shape in the ambiguity domain [14]. Virtually, this is based on the fact that the majority of the signal content (auto-terms) is located around the center in the ambiguity domain, whereas most cross-terms spread within the surrounding area away. According to this characteristic, TFDs with separable kernels have also been proposed, e.g. the B-distribution (BD) [16]. The idea of using separable kernels provides an efficient way to design TFDs for signals with nonlinear and/or multiple components. One further improvement of this class was to use a lag-independent kernel (LIK) for signals with slowly varying FM components, e.g. the modified B-distribution (MBD), which uses a gamma function over the Doppler direction to diminish the cross-terms [17].There is no universal TFD suitable for all types of signals and the choice of a particular TFD depends on the application and the characteristics of the signal under analysis. A TFD with lag-independent kernel (LIK-TFD), e.g. MBD, has shown better performance in characterizing HRV signals as compared with smooth pseudo WVD (SPWVD), exponential distribution and spectrogram [20]. Based on this finding, we present in this paper, a modification of this type of TFD to further improve the characterization of HRV signals. We show that an LIK mediates the trade-off between the cross-term elimination and resolution preservation by the shape of the kernel function. It works in such a way that the narrower kernel in the ambiguity domain is more effective in removing the cross-terms, but tends to smear the signal components, and thus results in poorer resolution. In HRV analysis, this may cause information loss relevant to the dynamic ANS regulation.This paper has two major contributions: (1) it introduces a new parameter in the LIK-TFD in order to overcome the aforementioned constraint. The new parameter allows for effective minimization of cross-terms without further narrowing the kernel while maintaining a satisfactory resolution for accurate feature extraction; (2) it defines instantaneous frequency (IF) based HRV features to detect perinatal hypoxia in a piglet model, and demonstrates that the detection performance of these features can be enhanced with improved TF characterization.This paper is organized as follows. Section 2 first provides the background information on QTFDs, followed by the analysis of LIK-TFDs to represent mono- and multi-component signals, leading to the definition and determination criterion of the new parameter for this type of kernel. The performance of the proposed LIK-TFDs is evaluated using both simulated and real HRV signals in Section 3. In Section 4, new IF-based features extracted from the improved TFD of HRV signals are presented to detect perinatal hypoxia. Finally, the paper concludes within Section 5.For a given analytic signal z(t) associated with a real signal x(t) [10], the signal kernel Kz(t,τ) is defined as:(1)Kz(t,τ)=z(t+τ/2)z*(t−τ/2)where * indicates the complex conjugation. The Fourier transform of Kz(t,τ) results in the WVD of the signal, i.e.:(2)Wz(t,f)=Fτ→f{Kz(t,τ)}To minimize the cross-terms generated by nonlinear and/or multiple component signals, smoothing kernels were introduced. The smoothed WVD ρz(t,τ) can be represented in the TF domain as [10]:(3)ρz(t,f)=Fτ→f{Kz(t,τ)*tG(t,τ)}=Wz(t,f)*t*fFτ→f{G(t,τ)}where*t*fdenotes the convolutions over time and frequency. G(t,τ) is the time-lag kernel of the TFD and can be Fourier transformed to the Doppler-lag kernel as g(υ, τ)=Ft→υ{G(t, τ)}. The TFD with such an expression in Eq. (3) is known as a QTFD. By carefully selecting G(t,τ) or g(υ,τ), one may attenuate the cross-terms relative to the auto-terms, and the resulting TFD is named an RID [14].For a TFD with separable kernel, the time-lag kernel G(t,τ) can be expressed as G(t,τ)=g1(t)g2(τ) (alternatively, g(υ,τ)=G1(υ)g2(τ) in the ambiguity domain, where G1(υ)=Ft→υ{g1(t)} is the Doppler function andg2(τ)=Fτ←f−1{G2(f)}is the lag function) [10]. In fact, both G1(υ) and g2(τ) have the effect of a smoothing window that reduce the cross-terms. Taking this into account, two TFDs, namely BD and MBD were defined and used in a number of applications [16,17].By fully expressing the convolutions and Fourier transform operations, we can expand Eq. (3) as:(4)ρz(t,τ)=∫−∞∞∫−∞∞Kz(u−t,τ)G(u,τ)exp(−j2πfτ)dudτFor simplicity, let us consider initially the case of a mono-component stationary signal z1(t)=exp(j2πf0t) where f0 denotes a constant frequency. The signal kernel can then be expressed as:(5)Kz1(t,τ)=exp[j2π(t+τ/2)f0]exp[−j2π(t−τ/2)f0]=exp(j2πf0τ)Substituting Eq. (5) andG(t,τ)=Ft←υ−1{g(υ,τ)}into Eq. (4), we have(6)ρz1(t,f)=∫−∞∞g1(u)du∫−∞∞g2(τ)=MG2(f−f0)exp[−j2π(f−f0)τ]dτwhereM=∫−∞∞g1(u)du=G1(0).Theoretically, the optimal TFD of a signal is achieved if we have a Dirac function at the IF of the signal, i.e. ρz1=(t,f)=δ(f−f0). Comparing to Eq. (6), i.e. δ(f−f0)=MG2(f−f0), and applying the inverse Fourier transform on both sides, we can get:(7)g2(τ)=M−1Thus,(8)G(t,τ)=g1(t)g2(τ)=g1(t)/∫−∞∞g1(t)dtThe above derivation confirms that the LIK-TFD provides an ideal TF representation for mono-component signals with a constant IF law. For an LFM signal given by z1(t)=exp(f0t+αt2/2), its LIK-TFD with the kernel given in Eq. (8) is:(9)ρz1(t,f)=M−1g1((f−f0)/α−t)At f=fi(t)=f0+αt, we have ρz1=(t,fi(t))=M−1g1(0). If we choose g1(t)≤g1(0)∀t, then the proposed LIK-TFD attains absolute maximum at the IF law of the LFM signal. Therefore, an edge of the IF can be exactly obtained when the IF law is constant or linear over time; however, the peaks of the LIK-TFD result in a biased estimate of the IF when the IF law is nonlinear due to the existence of the higher order derivative of the signal phase [12,17].In the previous section, we have verified that the LIK-TFD is able to characterize mono-component signals. In the case of multi-component signals, there is a need to investigate the generation of cross-terms between components in order to understand the performance of the LIK-TFD for HRV signals. Let us consider a signal with two components, which can be of the analytic form as z2(t)=α1exp(−j2πf1t)+α2exp(−j2πf2t), where α1 and α2 are the amplitude for each signal component. The LIK-TFD of this signal is(10)ρz2(t,f)=α12δ(f−f1)+α22δ(f−f2)+2M−1δ[f−(f1−f2)/2]Re{α1α2*exp[(−j2π(f1−f2)t)]G1(f1−f2)}The first two terms represent the components of the signals, whereas the third term describes the cross-terms between the components. In addition, this expression indicates that the TFD of the sum of two signals is not equivalent to the sum of the TFD for the signals. Since HRV signals are multi-component with slowly varying IF laws, they may be modeled aszp(t)=∑p=1Pαpexp(j2πfpt), where αpdenotes the component amplitude and fprepresents the component frequency. Thus, the LIK-TFD of zp(t) can be expressed as a generalized form of Eq. (10):(11)ρzp(t,f)=∑p=1Pαp2δ(f−fp)+2M−1∑p=1P∑q=1,q≠pPδ[f−(fp+fq)/2]Re{αpαq*exp[(−j2π(fp−fq)t)]G1(fp−fq)}where the second additional term represents the cross-term located in the middle of each pair of components as a result of the quadratic nature of the LIK-TFD [10].Careful selection of the LIK may effectively reduce the cross-terms while preserve the TF resolution. To effectively suppress the unwanted content, we propose to choose a Doppler function G1(υ) such that: (1) M, equal to G1(0), is as large as possible; (2) G1(υ) is compactly supported by using a lowpass filter with G1(υ)=0forυ>υ0whereυ0=|min(fp−fq)|;p, q=1, …, P, p≠q. The first requirement can be achieved by increasing the sharpness of the Doppler function, which is done by adjusting function parameters when the window is normalized (Fig. 3a). The second requirement means that, in the ambiguity domain, the kernel function regarded as a lowpass filter should have a cut-off frequency no more than the minimal distance between any two components in the signal. In the case of HRV signals, since there are three components that are generally recognized, the value of υ0 can be determined by:(12)υ0=min{min(fLF−fVLF),min(fHF−fLF)}Various functions can be used as the kernel function, one of which is g(υ, τ)=G1(υ)=|Γ(β+jπυ)|2/Γ2(β) as in the MBD [17]. The difference between the proposed kernel and the original LIK in the MBD is that the latter has a lowpass shape but is not strictly equal to 0 beyond the cut-off frequency defined as υ0 (Fig. 3b). In fact, to better remove the cross-terms in multi-component signals when using the MBD, one tends to choose small values for β in order to make G1(υ) narrower based on Eq. (11), especially for those with components close to each other. Yet this in turn causes the loss of resolution of auto-terms as some of the auto-terms around the origin get attenuated by G1(υ). With the proposed parameter satisfying G1(υ)=0 for υ>υ0 the cross-terms can be effectively attenuated while the better-suited β can be chosen to preserve the resolution. This will be further detailed in Section 3.The aforementioned requirements for the LIKs can be met by selecting two parameters to define the kernel. The first one adjusts the shape of the window; and the second one, that we propose, determines the cut-off frequency of the kernel window in the ambiguity domain. In this work, we apply the new parameter not only to the MBD kernel but also to two other kernels that are based on the Cauchy function and Gaussian function. These kernels are defined in the ambiguity domain as follows:(1)MBD with compact support kernel (CS-MBD)(13)gcsmbd(υ,τ)=|Γ(β+jπυ)2|/Γ2(β)ifυ2<υ020otherwiseLIK-TFD with compact support Cauchy function kernel (CS-CD)(14)gcscd(υ,τ)=exp(−γ|υ|)ifυ2<υ020otherwiseLIK-TFD with compact support Gaussian function kernel (CS-GD)(15)gcscd(υ,τ)=exp(−υ2/σ2)ifυ2<υ020otherwiseIn Eqs. (13)–(15), β, γ and σ denote the positive parameters that control the window shapes in the proposed TFDs. The kernel functions of the above TFDs are tabulated in Table 1in both time-lag and Doppler-lag domains. There may be more options for the selection of windows as kernel function, e.g. rectangular, Hanning, etc., which are commonly used in the filter design. Since the choice is dependent on the signal to be analyzed, one may compare the effectiveness of these window functions including the proposed ones to determine the best one to use.TFDs with this type of kernel satisfy a number of important properties that are required in TFD design as listed below [10]:(1)Time shift invariance.Frequency shift invariance.Frequency marginal property:∫−∞∞ρz(t,f)dt=|Z(f)|2, as g(0,τ)=1∀τ.Group delay:tg(f)=∫−∞∞t⋅ρz(t,f)dt/∫−∞∞ρz(t,f)dt, as g(0, τ)=1while∂g(υ, τ)/∂υ|υ=0∀τ.Frequency support:fi(t)=0for|t|>tc→ρz(t,f)=0fort>tc,asϑ(υ,f)=Fτ→f{g(υ,τ)}=0for|υ|<2|f|.The proof for these properties can be referred to in [12,18]. In the next section, the discrete-time version of the proposed TFDs will be addressed, which is needed for the implementation and real-life applications.In real-life applications, the proposed methods need to be implemented using discrete-time signals, so we present here their equivalent discrete-time formulation and an implementation procedure.Given the discrete-time analytic signal z[n/fs]forn=0, 1, …, N−1, where n, fsand N denote the discrete time, sampling frequency and the number of samples, the discrete version of g(υ,τ) is expressed as g[l/fs, m/fs], where l and m represent discrete Doppler and lag. By assuming normalized frequency, the discrete versions of the proposed LIK-TFDs can be written as:(1)Discrete CS-MBD(16)gcsmbd[l,m]=|Γ[β+jπl]|2/Γ2[β]ifl2<υ020otherwiseDiscrete CS-CD(17)gcscd[l,m]=exp[−γ|l|]ifl2<υ020otherwiseDiscrete CS-GD(18)gcscd[l,m]=exp[−l2/σ2]ifl2<υ020otherwisecalculate the analytic signal z[n] associated with x[n];generate half of the quadratic signal kernelKz[n,m]by∑m=0N/2z[n+m]z*[n−m], the other half can be obtained by symmetry;transform g[l,m] into G[n,m] in the ambiguity domain by the DFT, i.e.G[n,m]=DFTn←l−1{g[l,m]}, and convolve Kz[n,m] and G[n,m] over time;Compute the discrete TFD byρz[n,k]=DFTm→k{Kz[n,m]*nG[n,m]}, where k denotes discrete frequency.One can also transform Kz[n,m] into the Doppler-lag domain, then multiply it by the proposed kernel g[l,m], and finally obtain the TFD by double convolutions of the product over time and frequency. But this procedure has increased computational complexity due to the additional DFT. A detailed description of the implementation procedure is provided in [10,21,22].

@&#CONCLUSIONS@&#
