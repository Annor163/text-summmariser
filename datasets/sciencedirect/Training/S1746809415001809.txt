@&#MAIN-TITLE@&#
Automatic multi-organ segmentation of prostate magnetic resonance images using watershed and nonsubsampled contourlet transform

@&#HIGHLIGHTS@&#
An automatic multi-organ segmentation method of prostate magnetic resonance images is proposed.The series of procedure is composed of decomposition, segmentation, and reconstitution.The decomposition and reconstitution are based on contrast à trous wavelet based wavelet transform.Marker-based watershed algorithm using texture gradient is used to implement segmentation.The main tissues in prostate magnetic resonance images can be obtained by the proposed method.

@&#KEYPHRASES@&#
Prostate magnetic resonance image,Multi-organ segmentation,Multi-scaled geometric image analysis,Watershed,

@&#ABSTRACT@&#
The watershed is an efficient algorithm for the segmentation of images. However, over-segmentation, which contains so many tiny regions that regions of interest cannot be identified easily, decreases the effectiveness. In this paper, pre-processing of images and the modification of watershed algorithm are both studied to restrain the over-segmentation. In the process of pre-processing, a kind of multi-scaled transform, contrast à trous wavelet based contourlet transform, is proposed and constructed to get sparse representation. In the aspect of modifying watershed, the “texture gradient” is defined, and the texture gradient is combined with marker-based watershed algorithm to reduce the number of segmented regions. The proposed method is tested by 36 prostate MR images and compared with several image segmentation algorithms; the experiment and comparison results show that the proposed method consistently restrains the number of segmented regions. The segmentation results correctly correspond to the main tissues in the images, and each tissue is integrally segmented, respectively with the elimination of small regions. The segmentation accuracy rate is 87.29%, which is higher than other methods under comparison.

@&#INTRODUCTION@&#
Prostate cancer is one of the most universal malignant tumors in the male reproductive system and a main kind of disease which causes of death for men [1]. Transperineal iodine-125 (125I) seed implantation is an effective approach for the treatment of localized prostate cancers, and the particle treatment planning plays an important role during the treatment [2]. In order to obtain precise treatment planning, virtual three-dimensional models of prostate and tissues around the target are generated in computer, and based on the model, particle treatment planning is set. Dose volume histogram (DVH) is used to evaluate and optimize the plan, which can cure prostate cancer and avoid damaging tissues around the prostate. The precision of models constructed based on image segmentation is the precondition of the seed implantation treatment. Because of the high contrast, MR images are chosen to perform the pretreatment of prostate cancer [3]. Therefore, a robust automatic segmentation of multi-organ technique for prostate MR images plays an important role in image guided brachytherapy treatment of prostate cancer.However, automatic tissue classification of MR images is still a challenging task in applications [4]. The watershed segmentation [5] is an efficient tool for image classification and has been widely used in medical image segmentation and improved by combined with some classical algorithm [6]. The method regards image as a 3D topography surface, starts the region growing from the surface minima detected by image gradient, combines both the discontinuity and similarity properties effectively and finally obtains the segmentation results of one pixel wide, closed connected precise contours of objects [7]. Using gradient information of the actual image, watershed segmentation obtains accurate results for images containing connecting objects. The main courses of the algorithm are smoothing and extracting gradient image from the original image. However, the segmentation method has a major problem of over-segmentation [8], as shown in Fig. 1(b), where so many tiny regions are generated that regions of interest cannot be identified easily.There are two main methods to restrain the over-segmentation of watershed. One way is to perform pre-processing before segmentation, such as obtaining sparse representation of original images [9], the other is to improve the watershed segmentation, such as marker-controlled watershed-based segmentation [10]. In this paper, two methods are studied. In the process of pre-processing, a new kind of multi-scaled transform, contrast à trous wavelet based contourlet transform, is proposed and constructed to get sparse representation. In the aspect of modifying watershed, the concept of the “texture gradient” and marker-based watershed segmentation are introduced, and the texture gradient is used in marker-based watershed to reduce the number of segmented regions. The main procedures of the proposed method are shown in Fig. 2. First, original images are performed the decomposition of contrast à trous wavelet based contourlet transform, and low-frequency images and high-frequency images are separated. Through the transform, some spurious minimal values widely exists in medical images are removed. Then, the low-frequency images are segmented by the marker-based watershed segmentation using texture gradient. Although images in level 2 in Fig. 2 are not clear in visual aspect, they make contribution to the final segmentation result. The results achieved in this step are low resolution image, which is vaguer than original image. Finally, the inverse contourlet transform is implemented to get high resolution image. The achieved image is the final segmentation results. In order to facilitate reconstructing three-dimensional model and enhance the intuition of the model, the segmentation results are labeled with special numbers and colored by different colors. Based on a series of segmentation results, the three-dimensional model can be reconstructed.Through these processes mentioned above, the over-segmentation of watershed is efficiently reduced. The segmentation has been evaluated using prostate MR images. The achieved results are more continuous and satisfying as a result of the human organs. According to the experiment results, this method lends itself well to the multi-organ segmentation.This paper is arranged as follows: Section 2 introduces in detail the contourlet transform and the way implementing image analysis by contrast à trous wavelet based contourlet transform and directional filter bank. In Section 3, “stationary texture gradient” and its combination with watershed algorithm are addressed, the integration of marker watershed segmentation and contrast à trous wavelet based contourlet transform is also proposed. In Section 4, experimental results and related analysis are presented. Finally, the whole paper is concluded.The watershed segmentation has been widely used in medical image segmentation. Although the method is efficient, the segmentation is often over-segmented. In order to restrain the over-segmentation, contourlet transform [11], which is a new method of two-dimensional image representation, is performed before segmentation. The transform effectively reduces the number of segmented regions.Contourlet transform, also called pyramidal directional filter bank (PDFB), is a multi-resolution, local and multi-directional representation method. Different from wavelet transform [12], contourlet transform theory is constructed in discrete domain, and expended to continuous domain by Do and Vetterli with multi-resolution framework [13]. The objective of this transform is to obtain sparse representation containing line and surface singularity of the original image. By means of basis analogous to contour, the support of the basis has strip structure, whose aspect ratio changing with different scale. Because of the direction and anisotropy of the strip structure, contourlet transform can effectively characterize lines and aspects in the images with sparse representation. The contourlet transform is briefly described in Fig. 3. The contourlet transform consists of the Laplacian pyramid and a directional filter bank.Contourlet transform, respectively analyzes multi-scale and direction of an image. First, Laplacian pyramid (LP) is used to implement multi-scale decomposition of each image to detect and capture singular points of the image. In the process of the first decomposition, original image signal is decomposed into low frequency component and high frequency components. And then, the low frequency components are iteratively decomposed to obtain multi-directional image. The high frequency components of each scale are decomposed by directional filter bank (DFB) and the singularities in same direction are comprehensively represented as a coefficient.Laplacian pyramid transform is the first step of contourlet transform. However, after performing many experiments and analysis, Toet [14] drew the conclusion that multi-resolution contrast pyramid [15] is more coincident with human vision system (HVS) than Laplacian pyramid transform [16], and because the terminal purpose of pretreatment is to aid the doctor, the multi-resolution contrast is preferred. Thus, in this paper, the contrast pyramid is constructed to improve the contourlet transform and one of the main algorithms, the ratio of low-pass pyramid, is introduced.The constitution of contrast pyramid is designed based on standard Laplacian pyramids [17], which is widely used in images segmentation [18]. The original image is defined as G0, and the pixels of lth (1≤l≤N, N is the highest layer) are obtained by:(1)Gl=REDUCEGl−1where(2)Gii,j=∑m=−22∑n=−22ωm,nGl−12i+m,2j+nThe weighting functionωm,n=ω′mω′n, andω′0=a,ω′1=ω′−1=0.5,ω′2=ω′−2=a/2, a is generally set to 0.375.In order to eliminate the difference of pixel density in each layer, interpolation is performed in low frequency images with the EXPAND framework before generating high frequency images. The EXPAND framework can be defined as follows:(3)Gl,0=GlGl,k=EXPANDGl,k−1where(4)Gl,ki,j=4∑m=−22∑n=−22ωm,nGl,k−1i+m2,j+n2and Gl,k(i,j) is calculated by the formula wheni+m/2,j+n/2is integer, otherwise Gl,k(i,j)=0.The ratio of low-pass pyramid can be constructed as follows:(5)Rl=GlEXPANDGl+1,0≤l≤N−1RN=GNwhere the Rlof each layer is the ratio of images of adjacent two layers.The reconstitution is the inverse process of constituting ratio low-pass pyramid and the detailed procedure is given:(6)GN=RNGl=Rl×EXPANDGl+1where 0≤l≤N−1. According to the procedure, reconstitution is accomplished.Then, the contrast of luminance is represented by C and can be defined by:(7)C=L−LbLbwhere L is the luminance values of some special pixels, Lbis the luminance values of local pixels, and for all i,j, I(i,j)=1.Suppose that,(8)Cl=GlEXPANDGl+1−I,0≤l≤N−1CN=GNHence, the image sequence represented by Clis contrast pyramid. Because of the integrity of contrast pyramid, original images can be obtained by the inverse transformation of contrast pyramid using the following formula:(9)GN=CNGl=Cl+I×EXPANDGl+1,0≤l≤N−1The general thought of constitution of contrast à trous wavelet based contourlet transform is to combine the definition of contrast with à trous wavelet transform, and obtain contrast à trous wavelet transform. Then, the transform is used in the contourlet transform.Because of the undecimated property, à trous wavelet is a well-defined tool for image fusion, pattern recognition and image segmentation. At the same time, contrast pyramid transform is an efficient image representation method. Hence, in this paper, contrast pyramid transform based on contrast à trous wavelet is proposed. First, contrast à trous wavelet is obtained through introducing contrast into traditional à trous wavelet [19]. Second, contrast à trous wavelet is incorporated into contourlet transform to perform multi-scale analysis.According to à trous wavelet [20], which is used in image fusion [21], the filter generated by scaling function (usually B3 spine function) is used to implement convolution for original images. For a given image p, a series of similar images pl(l=1,2,…,N, N is the number of decomposition layers) are produced by à trous wavelet, and the wavelet plane is obtained by calculating the difference between pl−1 and pl.By using contrast pyramid strategy, the contrast of luminance is represented by C and can be defined by:(10)C=L−LbLb=LLb−Iwhere L is the luminance values of some special pixels, Lbis the luminance values of local pixels, and for all i,j,I(i,j)=1.The contrast à trous wavelet transform is defined as follows:(11)p0=pωl=pl−1pl−I,0≤l≤NωN=pNwhere ωnis the contrast coefficient. Correspondingly, the reconstruction formula can be derived. First, defineωl=pl−1/pl−I,l=1,2,…,N, p0=p, the reconstitution formula are defined as follows:(12)pN=ωNpl−1=ωl+I×pl,0≤l≤NFinally, the contourlet transform with contrast à trous wavelet is achieved by replacing the Laplacian Pyramid transform with contrast à trous wavelet.In this paper, decimation-free directional filter bank (DFDFB) is designed to perform the directional decomposition of images. DFDFB is shift invariant by avoiding image sampling and interpolation. In the beginning, a one-dimensional filter is chosen and extended into two-dimensional domain. Then, the two-dimensional filter is transformed to DFDFB. The one-dimensional filter chosen in this paper is half-band filter, which is efficient and robust.The unit response in sampling cells of half-band filter can be represented as follows:(13)hn=c,n=00,n=2kk≠0,k=1,2,3…h2k+1,n=2k+1where c=1/2, h(n) is the unit response in sampling cells, k is an integer. The z-transform of is h(n) is performed:(14)Hz=c+z−1∑n=0∞h2n+1z−nSuppose that, the frequency response of half-band filter is H(ejω), the amplitude is 1, and the one-dimensional transform function is A(ejω), then(15)Aejw=2Hejw−0.5The one-dimensional filter can be defined as:(16)Bz=1+AzThe amplitude of B(z) is 2.0, cut-off frequency is π/2. Then, the two-dimensional filter is represented as follows:(17)D˜z1,z2=12Bz1Bz2(18)Dz1,z2=12Bjz1Bjz2+12B−jz1B−jz2(19)Cz1,z2=2−Dz1,z2where D(z1,z2) is the band-pass filter in first and third quadrant, C(z1,z2) is the band-pass filter in second and forth quadrant.Fan-shaped filterHfan1z1,z2in first and third quadrant can be obtained by the transformation:z1←z10.5z2−0.5,z2←z10.5z20.5.Hfan2z1,z2can be calculated as the same transform.The four-sub-band filter Hfour and the first two sub-bands of eight-sub-band Hoct are calculated as follows:(20)Hfour1z1,z2=Dz1,z2×Hfan2z1,z22(21)Hfour2z1,z2=Dz1,z2×Hfan1z1,z22(22)Hfour3z1,z2=Cz1,z2×Hfan1z1,z22(23)Hfour4z1,z2=Cz1,z2•Hfan2z1,z22(24)Hoct2z1,z1=Hfour1z1,z2×Hpshift1z1,z22(25)Hoct1z1,z1=Hfour1z1,z2−Hoct2z1,z2Other sub-bans of eight-sub-band Hoct and the sub-band filters with more numbers can be calculated by the same mode. According to the formula presented above, DFB decomposition of the images generated by contrast à trous wavelet is accomplished.Fig. 4shows the flowchart of the proposed sparse representation algorithm: contrast à trous wavelet based contourlet transform. It can be observed from Fig. 4 that the sub-sampling operations are eliminated. The algorithm consists of two parts. One is the contrast à trous wavelet transform, and the other is a decimation-free directional filter bank. As a whole, using the contrast à trous wavelet based contourlet transform will be helpful in capturing substantial geometrical structures of prostate MR images, which will be demonstrated in the experiments later in this paper.The existence of a large number of minute details in the image results in the edge line buried in disorderly watershed line, especially for texture of images. However, texture is regularly located and homogenous at visual effects. The ideal segmentation method should divide the regions with the same texture features into one part. Hence, a texture gradient feature which can highlight the texture boundary and minimize the inner of the texture image is expected.In this section, the texture gradient is combined with marker-based watershed to reduce the number of segmented regions. First, the modified gradient images are generated according to the definition of texture gradient. Then, marker-based watershed algorithm is used to segment the modified gradient images.A simple method of obtaining texture gradient is to calculate the gradient of the amplitude in each subband and add these gradients. But it is noteworthy that while the texture feature of original image is amplified, the small boundary is enlarged, whose texture may cause narrow region around double-edge [22]. In this paper, in order to avoid the narrow region, one-dimensional median filter is performed along the horizontal and vertical directions for the amplitude of each subband, respectively. The filter suppresses over-segmentation caused by double-edge and smoothes texture feature.The texture of original image can be represented as T(x,y), and MT(x,y) is defined as follows:(26)MTix,y=MedianFilterTix,y,1<i≤n.where n is the number of subbands, the length of the one-dimensional median filter is2l+2.The texture gradient [23] TG(x,y) can be calculated by:(27)TGx,y=∑i=1n∇MTix,yl2MTiwhere n is the number of subbands, ∇ is approximated using a Gaussian gradient calculation algorithm (with the scale parameter σ set to 2.0). Ti(x,y) is the amplitude of the subband i decomposed by complex wavelet transform. l2(MTi) is the l2 norm energy of MTi, which can normalize the texture gradient of each subband.In this paper, the complex wavelet is replaced by the ratio of low-pass pyramid. The ratio of low-pass pyramid coincides with human vision system (HVS). At the same time, the modified transform algorithm can efficiently characterize the texture gradient.The final modified gradient can be calculated as follows:(28)Gx,y=mix×∇f1.2FMTx,y3+TGx,y3where ∇f is just the gradient of the original intensity image, mix is a constant coefficient, set to weigh the intensity and texture gradients. F(|MT(x,y)|) is designed as(29)FMTx,y=meanMTifMT(x,y)≤meanMTMTx,yifMTx,y>meanMTThe meaning of the parameters within the definition G(x,y) is justified as follows:(1)(▿f)1.2: This is used to emphasize the weight of gradient values by expending the range of the gradient image.TG(x,y)3: This is set to emphasize large texture gradient values to highlight the texture boundaries.(F(MT(x,y)))3: This is included to reduce the texture values within texture regions.The modified gradient images can efficiently characterize the texture gradient feature, which can highlight the texture boundary and minimize the inner of the texture image. Then, marker-based watershed algorithm is used to segment the modified gradient images.One of the effective methods of restraining over-segmentation of watershed is to pre-process the raw image data. Marker-based watershed segmentation takes that strategy and reduces the number of segmented regions.Marker-based watershed submerges images from some special pixels such as local minimum, and accurately locates homogeneous regions with large size in textures, density and other features of images through mark recognition algorithm [24]. The segmentation method follows three steps as follows: (1) Seek a small initial region as seed point to start submerge images; (2) Calculate threshold values which changes with different image pixel values; (3) Perform region growing segmentation using the seed point and threshold.In the method proposed in this paper, marker-based watershed algorithm is used to segment the modified gradient images referred in Section 3.1. First, some threshold values are set to get a series of binary images, and an acceptable minimum size is set to ensure the size of segmented regions is not too small. Then, these binary images are segmented and the regions with bigger size than minimum size are reserved. Finally, these binary images are marked and performed the watershed segmentation to generate the segmentation results.The proposed method is evaluated by a series of experiments. The primary procedures of the integration of marker watershed segmentation and modified contourlet transform include three steps. First, original images are performed the decomposition of contrast à trous wavelet based contourlet transform. Then, the low-frequency images produced in the decomposition are segmented by marker-based watershed segmentation. Finally, the inverse contourlet transform is implemented to get high resolution image. The achieved image is the final segmentation results.The experimental data is a set of T1-weighted MR prostate images (spin echo, TR=2324ms, TE=75ms, flip angle=90, 528×528 matrix, 1.5T magnetic field strength, 6mm thick slices, FFS patient position). Each image is collected on a PHILIPS-FE9A9DC Nuclear Magnetic Resonance Spectrometer with same parameters, in-plane image size of 528×528 and pixel size of 0.78×0.78mm2. The manual segmentation of each image is also provided by a clinical expert. The computer used for all tests has an Intel Core i3-2120, 3.3-GHz 32-b Quad-Core processor with 8192-MB RAM.Fig. 5shows a detailed experiment of the prostate images. It can be observed from Fig. 5 that the proposed method restrains the number of segmented regions. The segmentation results correctly correspond to the main tissues in the images, and each tissue is integrally segmented, respectively with the elimination of small regions. At the same time, the proposed method also can keep a high definition of images. The achieved results are more continuous and satisfying as a result of the human organs.The experimental results of other prostate images are illustrated in Fig. 6. Desirable experimental results were achieved with the proposed method.Six images, which are in the same slice with Fig. 5(a) and contain similar contents, are segmented by traditional watershed method, marker-based watershed algorithm, marker-based watershed combining traditional contourle transform and the proposed method. The segmentation results are compared and the average datas of the segmentation of six prostate MR images are listed in Table 1.The comparisons among different approaches are summarized in Table 1. The accuracy rate of segmentation results is calculated by the comparison pixel by pixel with the hand-labeled segmentation results, which are all labeled and binarized. It can be observed that the proposed method has higher segmentation accuracy rate than watershed and marker-based watershed. In Table 1, there are six organs in the given slice, so ideal number of segmented regions is six. The number is counted following the principle: if a segmented organ has 80% pixels same with the handle-labeled result, the organ is counted as a correct segmentation organ. It can be observed from Table 1 that the proposed method consistently restrains the number of segmented regions and generates correct number of segmented regions.The average accuracy rate of each main organ generated by the compared algorithms are provided in Table 2, and the number in brackets is the responding standard deviation. The average percentage of the volume in the target organs is also represented. The accuracy rate of each algorithm in Table 1 is the weighted average of the accuracy rate of main targets, and each accuracy rate is weighted by the average percentage of the volume in the target organs. Table 2 shows that the proposed method has higher segmentation accuracy rate than watershed and marker-based watershed.The experimental results suggest that the improved watershed algorithm can generate more satisfactory results by the combination of à trous wavelet based contourlet transform. The main organs in the segmented image are segmented integrated and the over-segmentation is restrained.

@&#CONCLUSIONS@&#
