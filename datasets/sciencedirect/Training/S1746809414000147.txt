@&#MAIN-TITLE@&#
Logistic ordinal regression for the calibration of oscillometric blood pressure monitors

@&#HIGHLIGHTS@&#
A Hammerstein–Windkessel model to represent the central blood pressure system.A Kalman filter estimated the time varying Fourier series representing the Windkessel model's output signal.The Fourier coefficients of this modeled oscillometry is then used in a next step to drive a logistic regression analysis.A logistic regression analysis based on the signal features of the oscillometry can detect hyper- and hypotension and correct the blood pressures accordingly.

@&#KEYPHRASES@&#
Blood pressure measurement,Oscillometric signal,Pulse-pressure signals,Bio-signal processing,Heart frequency estimation,Logistic regression,Calibration,

@&#ABSTRACT@&#
Oscillometric blood pressure (BP) monitors are omnipresent and used on a daily basis for personalized healthcare. Nevertheless, physicians generally approach these devices cautiously since the mercury Korotkoff sphygmomanometer remains the golden standard. Various reasons explain the hesitating attitude of the medical world towards automated BP monitors: (i) its principle is based on the pressure pulsations arriving at the cuff by the cardiac cycle instead of an audio wave used by physicians triggered by the turbulences in the artery, (ii) the actual computation of the systolic and diastolic BP from the measured oscillometry is manufacturer dependent and not based on general scientific principles, (iii) the quality of the oscillometric monitors is labeled by a trial such that the devices correspond well to the Korotkoff method for the average healthy patient but deviates for patients suffering from hypo- or hypertension. In this paper, we develop a statistical learning technique to calibrate and correct an oscillometric monitor such that the device better corresponds to the Korotkoff method regardless of the health status of the patient. The technique is based on logistic regression which allows correcting and eliminating systematic errors caused by patients suffering from hyper -or hypotension. No user interaction is required since the technique is able to train and validate the calibration procedure in an unsupervised way. In our case study, the systematic error is reduced by nearly 50% corresponding to the performance specifications of the device.

@&#INTRODUCTION@&#
Personalized healthcare and home health monitoring is a booming business. This is due to aging and the advanced technologies in telecommunication applications. From a technological perspective, one needs to ensure that we do not clear the path for a wild growth of medical monitors such that medical devices are based on scientific principles ensuring quality. The safeguard should consist of reducing the discrepancy between (low cost) home monitors and more expensive and specialized clinical devices. Nevertheless, the quality difference between the clincal device and the home monitoring system is apparent due to cost, space, and layman use.In an effort to eliminate the gap between the Korotkoff method applied in the sphygmomanometer [1] and the oscillometric devices a calibration procedure needs to be established [2,3]. The calibration method eliminates the systematic error by comparison with the Korotkoff results denoted as the golden standard. A few constraints to establish this procedure are: (i) the patient needs to be able to perform the calibration at home, (ii) additional hardware should be avoided, (iii) The patented algorithm should remain unchanged. The calibration problem is two-fold: The systematic error needs to be detected and the systematic error needs to be corrected. Since 1999, test simulators for the calibration of oscillometric devices have been introduced [4–6]. Such simulators apply test signals to the oscillometric device for testing the accuracy of the measurement. Either these simulators require additional hardware or they apply a database of oscillometric signals to correct the algorithm computing the BP values [7]. Once a systematic error is detected, post-processing should account for this discrepancy without changing the patented algorithm. Most research on oscillometric blood pressure signals is focused on either understanding the fundamental signal properties [8–10], blood flow dynamics in the presence of delating cuff [11,12], filtering techniques [13] and signal feature detection with various methods [14].The number of published results regarding the (post) correction of automatic blood pressure monitors is significantely less abundant. For instance a denoising approach to eliminate confounding and movement artifacts was studied in [15]. Temporal variability was modeled and suppressed in [16,17]. To obtain more accurate readings the blood pressure variability was measured and taken into account in [18]. In [19,20] we tried to correct the oscillometric monitors for patients with an extremely high or low blood pressure by taking into account a dynamic blood flow model.In this paper, we want to study a statistical technique which can be used together with a test simulator for oscillometric devices. Test signals are fed to the oscillometric devices to quantify the discrepancy between the Korotkoff sphygmomanometer and the automatic oscillometric monitor. Based on the signal characteristics of the measured oscillometric signal and the oscillometric blood pressure readings a logistic regression is applied for the bank of test signals to identify a correction rule for the automatic blood pressure monitor. The actual relationship between the signal features and the Korotkoff blood pressure is highly nonlinear such that only a limited performance can be observed by using a linear regression to map the shape of the oscillometric signal to the blood pressure see [19]. To avoid a crusade for a very complex nonlinear model, we remain in the linear modeling framework. As a result, we can rely on the linear regression framework but not to estimate the correct blood pressure specifically but to estimate the correct range of the blood pressure. This type of linear regression is known as logistic regression.The golden standard for measuring the blood pressure remains the Korotkoff sphygmomanometer. The sphygmomanometer inflates a cuff wrapped around the patient's upper arm until the blood circulation is stopped. A stagewise deflation of the cuff restores the blood flow while slowly opening the artery. Through the stethoscope, the physician listens at the turbulences caused by restoring the blood flow. The sound type of the turbulences undergo five phases known as the Korotkoff sounds [1]. The systolic blood pressure is determined at the start of the first Korotkoff sound whereas the diastolic pressure is defined by the final Korotkoff sound.The oscillometric monitors also apply a cuff but instead of recording the turbulences in the arteries, the pressure pulsations of the heart arriving at the cuff are measured. The pulsations hold an oscillating nature due to the systolic and diastolic phases of the heart cycle. On top of that the deflation of the cuff acts as an amplitude modulation on the blood pulse oscillations. This amplitude modulated signal is known as the oscillometric signal. The determination of the systolic and diastolic BP from the oscillometric signal is obscure in the sense that a unique algorithm is not available. Indeed, there are two important theoretic schools which conjecture that the BP is a function of the relative height of the oscillometric signal w.r.t. the global maximum (height based school) whereas a second school is in favor of the BP as a function of the points of inflection of the oscillometric signal around the global maximum [21,22]. On top of that, the exact implementation to determine the inflexion points, the exact percentages to pin-point the relative heights w.r.t the global maximum differ from brand to brand due to possible patented software solutions. Once the algorithm computes the necessary points on the oscillometric signal, the time instant is traced back to the cuff pressure which determines the systolic and diastolic pressure (see Fig. 1as an illustration).A measurement campaign following the protocols of the British Hypertension Society. In total, the campaign selected 75 patients. The patients were randomized in terms of age, sex, and socio-cultural background. However, half of the patients were selected among patients without cardiovascular issues whereas the other half of the selected patients have records indicating cardiovascular problems.The used oscillometric measurement device was the Contec PM-50 a blood pressure monitor certified by the FDA. The device is validated for upper arm measurements only. It has a systolic pressure range between 40 and 270mmHg, a mean arterial pressure (MAP) range between 20 and 235mmHg and a diastolic pressure range between 10 and 215mmHg. A continuous monitoring option with a periodic measurement interval of at least 5min. The pressure is quantized at an accurary of 1mmHg. The inflation is by means of a forced pump while the deflation is stagewise with steps of 4mmHg. The FDA reports the device to be accurate with a root-mean-square (RMS) error of 6mmHg.An expert physician selected 100 healthy and 100 unhealthy (cardiovascular problems) patients from a pool of patients based on some qualitative parameters to avoid confounding: mixed backgrounds, sex, education, medical history,... From this set of 200 patients a random sampling was performed by the physician to obtain the 75 measured oscillometric signals. The patients were examined by means of the Korotkoff sphygmomanometer following the abovementioned protocols. The blood pressure is partitioned into different groups according to the cardio-vascular risks. We discriminate Hypotension (Systolic< 90, Diastolic< 60), Desired (90< Systolic< 120, 60< Diastolic< 80), pre-hypertension (120< Systolic< 140, 80< Diastolic< 90), Hypertension stage 1 (140< Systolic< 160, 90< Diastolic< 100), Hypertension stage 2 (160< Systolic< 180, 100< Diastolic< 110) and crisis (Systolic> 180, Diastolic> 120).Table 1shows the Korotkoff readings performed by a certified physician for the different patients in the campaign. The table reveals that for the diastolic pressures slightly <53.3% of the patients reveal pressures beyond the desired range while for the systolic pressures this holds for 75.4% of the patients. Given that oscillometric devices are based on an algorithm computing the blood pressure. This suggests that these algorithms work reasonably for patients in the desired blood pressure range but these devices normalize the estimated blood pressure for hypo- and hypertensive patients towards the desired ranges. As a result, the campaign shows quite some patients outside the desired range which poses a challenge for the oscillometric devices for which a correction of the oscillometric signal may be desired.The calibration procedure to correct the readings of the oscillometric blood pressure monitor requires specific signal features of the oscillometric waveform. In order to extract these features, one needs to model the oscillometric waveform. On top of that, a good model serves to suppress disturbing noise corrupting the measured oscillometric signal resulting in a more accurate feature extraction.One of the most popular and widely used cardiovascular models is the Windkessel model, [23]. Its popularity is based on the fact that it is a simple parallel RC-network driven by a current source and its results provide a good decription of the central BP or the low-frequency behavior of the vascular system [24]. Hence, the corner stone of our model is the Windkessel model describing the linear dynamics relating the Cardiac Output (CO) to the BP. The CO is represented by a Fourier paradigm such that the signal is decomposed into harmonically related sinusoids. Hence, the CO is represented by a single sine wave corresponding to the fundamental heart frequency passing through a static nonlinearity inducing its higher harmonics. The fundamental heart frequency represents the beat-to-beat period while the static nonlinearity describes the effect of the different heart chambers. As a result, this representation of the Low Frequency behavior of the vascular system will be called throughout this paper the Hammerstein–Windkessel model. Finally the cuff in- and deflation mode is modeled by an amplitude modulation acting on the pressure waveform given by the output of the Windkessel model.In Fig. 2the model is represented as a feed-forward block design model. The signal u0 denotes the beat-to-beat heart rate represented by a signal sinewaveu0=A0sin2πf0t+ϕ0with an unknown frequency f0, phase ϕ0 and amplitude A0. The polynomial block generates higher harmonics such thatq(t)=∑k=0RAksin2π(k+1)f0t+ϕkwith R the highest degree of the polynomial. The parameters Akand ϕkdepend on the coefficients of the polynomial. The windkessel model represents the low frequency behavior of the cardiovascular system relating blood flow q(t) to blood pressure p(t) by means of the following differential equationRq(t)=p(t)+CR∂∂tp(t)Besides the transient conditions of the pressure wave p(t) associated to each heart beat, the pressure signal is a cyclo-stationary signal. The steady-state response of a linear system to a multi-sine input is again a multi-sine such that we obtain(1)p(t)=∑k=0RBksin2π(k+1)f0t+ψkThe inflating and deflating cuff has an effect on the arterial compliance and resistance such that the parameters R, C become time-varying which implies that the eventual oscillometric signal can be represented by(2)y(t)=∑k=0RBk(t)sin2π(k+1)f0t+ψk(t)Note that the heart rate in this model is assumed constant over time. This assumption is easily violated in practice although specific measurement protocols of for instance the British Hypertension Society. Perturbations in the heart frequency f0 leads to leakage since the pressure signal p(t) never reaches steady state. As a result, the presented approach treats this type of possible leakage as an additional noise disturbance.The parameter identification is not a straightforward regression problem since we do not have access to an actual intput. We have a rough estimate of the heart rate f0 but the amplitude A0 and phase ϕ0 of the fundamental heart signal u0 are inaccessible. Hence, we need to solve a blind identification problem. This comes with the price that the individual substructures of the model in Fig. 2 are not identifiable. Fortunately, the actual goal is to obtain the (time-varying) amplitude and phase in Eq. (2). The remainder of Section 3.2 describes the two step procedure to identify the oscillometric waveform (2).To obtain the heart rate it is assumed that the dominant oscillations present in the oscillometric signal (see Fig. 1) is driven by the heart frequency. Hence, the procedure tries to extract the frequency of the fundamental sine wave u0(t) which is maximally correlated to the oscillometric signal y(t). Assume that both signals are sampled (possibly incoherently) at a sampling frequency fsthen the Z-transform evaluated at angular frequency ωk=((2πk)/N)fsorzk=expjωkof the sampled signal u0(tn) with tn=(n/fs) reveals,(3)U0ωk=▵∑n=0∞u0nfszk−n=A0sinϕ0+zk−1sin2π(f0/fs)−ϕ01−zk−12cos2π(f0/fs)+zk−2where=▵denotes equality by definition. The heart frequency f0 can be determined by maximizing the correlation between the measured spectrum of the oscillometric signal Y(ωk) computed by the Discrete Fourier Transform and the regressors11−zk−12cos2π(f0/fs)+zk−2zk−11−zk−12cos2π(f0/fs)+zk−2Now that the heart frequency f0 is estimated, we can estimate the remaining unknown parameters in Eq. (2). The advantage of prior estimates of the heart frequency is that the remaining parameters are linear. Indeed, we can express Eq. (2) in the following form:(4)y(t)=∑k=0RBk(t)sin2π(k+1)f0t+ψk(t)=∑k=0RBk(t)cosψk(t)sin2π(k+1)f0t+Bk(t)sinψk(t)cos2π(k+1)f0t=∑k=0RBkc(t)sin2π(k+1)f0t+Bks(t)cos2π(k+1)f0twhereBkc(t)=Bk(t)cosψk(t)andBks(t)=Bk(t)sinψk(t). The estimation problem reduced to a linear regression problem with time-varying coefficients due to the amplitude modulation driven by the cuff deflation mode. We propose to track the time-varying coefficients by means of an adaptive Least Squares or a Kalman filter. An ordinary regression problem can be easily represented in matrix form, where the vectoryN=[y(0),y(Ts),y(2Ts),…,y(N−1)Ts]Twith T the transpose operator, N the total number of measured samples and Ts=(1/fs) the sampling period. The nth row of the regression matrix X is given byxn=sin2πf0Tsncos2πf0Tsn….sin2πf0(R+1)Tsncos2πf0(R+1)TsnThe weighted least squares (WLS) solution is given by the minimizer of(5)argminθ∑n=0m−1λm−n−1y(n)−xnθ2where λ denotes the forgetting factor allowing to emphasize more to more recent samples and suppressing the information coming from past samples. The information of the past is exponentially decaying. A straightforward computation reveals the analytical solution of (5)(6)θˆWLS(m)=XmTΛmXm−1XmTΛmymwithXm=x0⋮xm−1andΛm=λm−10…00⋱⋱⋮⋮⋱λ00…01The estimator (6) can capture the time-varying features of the coefficients estimated in (4), it is computationally inefficient as it requires a matrix inversion for every computed estimator. Modifying the compution of (6) in a recursive manner, transforms the solution into a Kalman filter with gain(PmxmT)/(λ+xmPmxmT)and residualy(m)−xmθˆWLS(m). The Kalman filter or recursive WLS estimator is given by,(7)θˆWLS(m+1)=θˆWLS(m)+y(m)−xmθˆWLS(m)λ+xmPmxmTPmxmTPm=1λ1−Pm−1xm−1Txm−1λ+xm−1Pm−1xm−1TPm−1The proof of (7) is found in A. The choice of λ is difficult to determine, we followed the rule given in [25]: λ=1−(f0/fs) where fsis the sampling frequency of the oscillometric monitor. In Fig. 3, we illustrate the Kalman filtering approach (7). The blue signal represents is a raw oscillometric signal as measured during the measurement campaign (see Section 2). The green signal is the modeled signal by means of the Kalman filtering approach and the forgetting factor chosen by the rule-of-thumb. To estimate the intermediate signal p(t) (shown in magenta) which is stationary, we freeze the time-varying coefficients of (7) to the time instant tMAP. This time instant tMAPis the time when the cuff pressure equals the mean arterial pressure as determined by the blood pressure monitor (in this case PM-50). In the next section we show how the signal properties of the intermediate signal are used to calibrate the oscillometric device.The philosophy of the calibration resides in the fact that an accurate estimation of the arterial resistance and compliance given by the Windkessel model allows correcting the oscillometric devices. Since the output signal of the Windkessel model is stationary, we retrieve the stationary signal p(t) from the time-varying model (4) estimated by the Kalman filter (7) by freezing the coefficients of (6) to the time instant tMAP. It is clear from (1) that the amplitudes and phases are a function of the Windkessel parameters RandC. The oscillometric device provides systolic, diastolic and MAP readings which serve as initial estimates to classify the patient in one of the different categories (each category corresponds to a line) as defined in Fig. 1. We want to update this initial category based on the features extrated from the oscillometric signal and compute the probability that this patient in fact belongs to a different category. The computation of the category probabilities is referred to as logistic regression and since the categories reveal an order from small to large we need to solve an ordinal logistic regression problem.Let Ybin denote a nominal variable showing two possible categories {0, 1} such that Ybin is binary. Assume that we have measured features F1, F2, …, Fpwhich can be either continuous or discrete features. If one wants to model Ybin as a linear regression of the measured features X1, X2, …, Xpwe need a link function G which maps the continuous linear combination to the binary variable YbinYbin=G∑k=1pβkFk+β0+ϵkwhere ϵkdenotes the zero-mean noise term. The expected value of this equation shows that the model predicts the probability p that Ybin=1 such thatp=G∑k=1pβkFk+β0Hence, the link function G maps the linear combination to the interval [0, 1] such that G is a Cumulative Distribution Function (cdf). Standard choices are the probit link function which is the cdf of the standard normal distribution, whereas the more commonly used logit function is the cdf of the logistic distribution. As a result, the use of the logistic distribution provides the model(8)p=11+exp−∑k=1pβkFk−β0which is called binary logistic regression. Next, we need to generalize (8) to the case where Ybin is a discrete random variable revealing different levels.Let Yord denote a variable showing different increasing values {0, 1, 2, 3, …, M}. Since the link function G is a cumulative distribution function, we do not want to predict Yord=l but Yord≤l such that Zl={Yord≤l} is again a {0, 1} variable since it is either true or false. Following the same philosophy as before we find thatZl=G∑k=1pβk[l]Fk+β0[l]+ϵkand after taking the expected value we obtain(9)p0+p1+…+pl=G∑k=1pβk[l]Fk+β0[l]Eq. (9) is not applied in practice as the model is overparametrized. Indeed, the difference between Zland Zl−1 is only one probability plalthough Zlidentifies p+1 new parameters. As a result, the model's complexity of (9) is generally reduced to(10)p0+p1+⋯+pl=G∑k=1pβkFk+β0[l]where the parameters associated to the linear combination are the same regardless of the level l. The constantsβ0[l]are called the ordinal thresholds. This type of ordinal logistic regression is referred to as the Walker and Duncan proportional odds ordinal logistic regression [26]. An overview article discussing the various approaches to deduct and perform an ordinal logistic regression analysis is found in [27]. Various software packages exist to estimate the parameters of (10). In matlab the “mnrfit” program is available while in SPSS the “plum” is available.To calibrate an oscillometric device, we feed the database of oscillometric signals and their associated cuff inflation and deflation curves. The oscillometric devices can then compute the systolic, diastolic and MAP pressures given byps[m],pd[m]andpMAP[m]. In Fig. 1 we see the different blood pressure categories for the systolic and diastolic pressures. To compute the logistic regression, we select the following features per signal in the database corresponding to the signal characteristics of the estimated intermediate signal p(t):F1=B0c(tMAP),F2=B0s(tMAP),…,F2R+1=BRc(tMAP),F2R+2=BRs(tMAP),F2R+3=px[m]withx=s,dThe ordinal variable Yord is a vector which specifies for each oscillometric signal in the database the systolic or diastolic blood pressure as measured by the Korotkoff technique. This allows estimating the logistic parameters of (10). For every oscillometric signal, we can predict the probability that {Yord≤l} which is computed aspˆ0+pˆ1+⋯+pˆl=G∑k=1pβˆkFk+βˆ0[l]where the estimated logistic parametersβˆkare used. From the predicted cumulative probabilities we can easily solve the probabilitiespˆkwhich predicts the probability that the oscillometric signal corresponds to a blood pressure in category k. Hence, we can assign new categories for every oscillometric signal corresponding to the category revealing the largest predicted probability.If the category of the measured blood pressurepx[m],x=s,dremains the one with the largest predicted probability, then no calibration is required. However, if the predicted blood pressure category differs from the initial category as described by the measured blood pressurepx[m],x=s,dwe need to calibrate and correct the measured blood pressure of the blood pressure monitor. Let the initial blood pressure category determined bypx[m],x=s,dbe k[m]. We can define δ[m] the difference between the measured pressurepx[m],x=s,dand the category's mean. Let the predicted category by the logistic model be given by k[p], then we can correct the blood pressure such that the difference between the calibrated pressurepx[c],x=s,dand the mean pressure of the category k[p] is δ[m].To test the procedure, we selected the oscillometric blood pressure monitor ABPM-06 of Contec. The device is a continuous-time oscillometric device taking up to 300 measurements during one day. The device has a systolic and diastolic range from 10 to 270mmHg with a heart frequency range from 0.5 to 4Hz. The blood pressure measurement resolution is 1mmHg. The device's accuracy is 6mmHg and meets the ANSI/AAMI SP10-1992 standard. The oscillometric database as described in Section 2 is fed to the ABPM-06. The 75 signals are partitioned in a training set and a validation set. A cross-validation is performed where 1000 times the 75 signals are partitioned randomly in a training set of 60 oscillometric signals and a validation set of 15 signals. The logistic regression training is performed by the mnrfit.m m-file in Matlab, the predicted probabilities per category is computed by the mnrval.m m-file in Matlab.We compute and study the difference between the Korotkoff readings assocated to the oscillometric waveforms and the response of the ABPM-06 to the oscillometric waveform database. In Table 2we see the descriptive statistics for the error of the systolic and diastolic blood pressures. The range of the errors is very large and the 95% confidence bounds reveal that the results show some heavy outliers. On top of that the Root Mean Square (RMS) error is 12.75 mmHg for the systolic and 7.91mmHg for the diastolic. The error is significantly larger than the tabulated 6mmHg as reported. Finally, the systolic error reveals a bias of 3.36mmHg which should be corrected. As expected by medical literature, the diastolic errors are significantely lower than for the systolic case. Nevertheless, a large range of 41mmHg is observed and the RMS error is larger than the expected 6mmHg.We report the results for both the training phase as well as the validation phase. The tables shows the average results over 100 validation runs. In Table 3we see the results of the logistic regression model on the Training set of 60 oscillometric signal chosen randomly. The outliers have been significantly decreased by a factor 2 for the Systolic pressure. This is also reflected in the range which drops from 78mmHg to 38mmHg. The standard deviation and bias are reduced such that the RMS for the systolic pressure is approximately 6.02mmHg and for the diastolic pressure only 4.71mmHg. The specification of the error as reported by the ABPM-06 technical sheet is achieved.In Table 4, we see the results of the validation phase performed on the remaining 15 oscillometric signals chosen randomly. Although, all statistics increase for the validation set, we still obtain significantly improved results with respect to the raw data in Table 2. On top of that, the increase of the error, bias and range from the Traing phase to the Validation phase are, based on a proper statistical test, found to be insignificant. Hence, the calibration procedure by means of the logistic regression approach succesfully lowered the RMS error by almost a factor 2 regardless of the health condition of the patient.To show the significance of the reduction between Tables 2 and 3 and Tables 2–4 we apply an F-test on the standard deviations of the errors. We do not perform a test on the mean since the reduction in bias or mean error is not significant. In Table 5, we analyze the significance of the reduction in standard deviation for the systolic pressure (rows 1–2) and for the diastolic pressure (rows 3—4). The test was performed at a confidence of 95% with a null hypothesisH0:σi2=σj2and alternativeH1:σi2>σj2. The first two columns indicate which two standard deviations are being tested. The columns 3 and 4 reveal the degrees of freedom for each variable which equals the number of observations used to compute the standard deviation minus 1. Column five computes the F-statistic which is given by the ratio of the 2 variances being tested. The critical value corresponding to a confidence level of 95% indicates that the alternative hypothesisH1holds for F-values exceeding this value. Finally, the last column shows the p-value which is the probability that a larger value for the F-statistic can be observed if the null-hypothesis holds. Table 5 reveals that the error reduction is significant when performing the calibration for the training set for both systolic and diastolic pressures. However, for the validation set we only observed a significant reduction for the systolic pressure but not for the diastolic pressure.

@&#CONCLUSIONS@&#
