@&#MAIN-TITLE@&#
An innovative intelligent system based on automatic diagnostic feature extraction for diagnosing heart diseases

@&#HIGHLIGHTS@&#
An innovative intelligent system is proposed for diagnosing heart diseases.A novel procedure is proposed for automatically extracting S1 and S2.A novel frequency feature matrix (FFM) is defined and automatically extracted.PCA-based diagnostic featuresy1andy2are generated from the FFM.SVM-based generated classifiers are used to diagnose heart diseases.

@&#KEYPHRASES@&#
Heart sound,STMHT,SE,S1 and SE,S2,PCA,Boundary curve,

@&#ABSTRACT@&#
An innovative intelligent diagnostic system is proposed in this study, which is primarily reflected in first heart sound (S1) and second heart sound (S2) automatic extraction, frequency feature matrix (FFM) automatic extraction, diagnostic featurey1andy2generation based on principal components analysis (PCA) and diagnostic method definition based on the classification boundary curves. Four stages corresponding to the diagnostic system implementation are summarized as follows. Stage 1 describes an envelopeETextraction from heart sound signals. In stage 2, heart sound segmentation points and peaks are first automatically located based on a novel method STMHT, and then S1 and S2 are automatically extracted according to the relationship between the systolic time interval and the diastolic time interval. In stage 3, in the frequency domain, a novel method is first proposed to generate the secondary envelopesSES1andSES2for S1 and S2, respectively, and then anSTMHT-basedFFMis automatically extracted fromSES1andSES2. Finally, the PCA-based diagnostic featuresy1andy2are generated from theFFM. In stage 4, support vector machine (SVM)-based classification curves for the dataset consisting ofy1andy2are first generated, and then, based on the classification curves, the scatter diagram diagnostic result (SDDR) and numerical diagnostic result (NDR) are defined for diagnosis of heart diseases. The proposed intelligent diagnosis system is validated by sounds from online heart sound databases and by sounds from clinical heart diseases. As a result, the classification accuracies (CA) achieved are 91.7%, 98.8%, 98.4%, 99.8%, 98.7%, 97.8%, 98.1% and 96.5% for the detection of atrial fibrillation (AF), aortic regurgitation(AR), mitral regurgitation (MR), normal sound (NM), pulmonary stenosis (PS), small ventricular septal defect (SVSD), medium ventricular septal defect (MVSD) and large ventricular septal defect (LVSD), respectively.

@&#INTRODUCTION@&#
Heart disease is the most common overall cause of death for people worldwide. According to the World Health Organization [47], heart diseases were the top major killers from 2000 to 2011. Thus, using a modern information processing method to diagnose heart disease is one of the most important medical research areas [44]. Currently, methods for the diagnosis of heart valve disorders include non-invasive techniques (electrocardiograms, chest X-rays, heart sound analysis and ultrasound imaging and Doppler techniques) and invasive techniques (angiography, transozefagial and echocardio-graph). Of these methods, heart sound analysis is a noninvasive, economical, easy and efficient method widely used to diagnose heart disease and evaluate heart functions during medical check-ups for adults and children, such as ventricular septal defects (VSD) diagnosis [40], fetal heart rate extraction algorithm testing [5], fetal examination [18], valvular heart disease diagnosis [8], heart valve disease identification [24] and children’s congenital heart disease screening [36]. Heart sounds are generated by vibrations induced by valve closure, abnormal valve opening, vibrations in the ventricular chambers, tensing of the chordae tendineae, and by turbulent or abnormal blood flow across valves or between cardiac chambers [17]. Basic heart sound signals are primarily composed of four sound types, including S1, S2 and two weak sounds, called the third sound (S3) and the fourth sound (S4). S1 is produced by the closure of the mitral and tricuspid valves at the beginning of isovolumetric ventricular contraction. S2 is produced by the closure of the aortic and pulmonic valves at the beginning of isovolumetric ventricular relaxation. S3, when audible, occurs early in ventricular filling and may represent tensing of the chordae tendineae and the atrioventricular ring, which is the connective tissue supporting the tricuspid and mitral valves valve leaflets. S4, when audible, is caused by vibration of the ventricular wall during atrial contraction and is usually associated with a stiffened ventricle and is therefore heard in patients with ventricular hypertrophy, myocardial ischemia, or in older adults. Although these four sounds may be audible by the auscultation of the heart and occur in the frequency range of 20–2000Hz, unitary murmurs such as a systolic ejection murmur (e.g., aortic stenosis) and a pan systolic murmur (e.g.,mitral regurgitation) mostly appear between S1 and S2 with different noise patterns [14]. However, S3 and S4 appear at extremely low amplitudes with low frequency components and are difficult to detect during normal auscultation. Therefore, the analysis of S1 and S2 plays an important role in heart sound analysis. To obtain more information on heart sounds to diagnose heart sounds with higher accuracy, heart sound segmentation used to extract S1 and S2 is first conducted, and then the efficient features are extracted from S1 and S2. Finally, a classification method is used to diagnose heart diseases.In recent years, the reported studies on heart sound segmentation can be summarized into three categories. In the first category, the performance of heart sound segmentation is quite good with reference electrocardiography [25,11]. However, in children with left or right hypertrophic ventricles, the axis deviation of the heart causes an abnormality on the electrocardiograph signal, which complicates heart sound segmentation [35]. Another category makes use of the frequency domain-based segmentation algorithms, which were proposed with tracking heart sound spectra [20,19,12,29]. However, the selection of the threshold and the filtering of the unexpected noise remain difficult problems with this method type, and few studies mention this issue. The third category is the envelope-based segmentation method, which has been studied by many researchers [48,14,32]. However, the selection of the threshold and filtering of unexpected noise remain difficult problems in this method. Furthermore, the study [48] revealed that locating the local peaks of S1 and S2 remains extremely difficult with this method. Fortunately, the novelSTMHT-based method of automatic heart sound segmentation and peak location proposed by the study [39] has been reported to provide sufficient performance compared with a published algorithm [48] that was demonstrated to be better than other segmentation methods.As an efficient feature defined in the frequency domain, the frequency width of the envelope over a given threshold value (Thv) has been verified to be useful for detecting heart diseases [6] and for diagnosing VSD [40]. However, for many types of heart diseases, it is difficult to extract frequency widths with a smallerThv(Fig. 4(b)). Moreover, to achieve higher classification accuracy for diagnosing different types of heart disease, differentThvvalues must be considered. For example, the study [6] indicated that the highest classification accuracy is 96.88% for diagnosing MR atThv=0.8, and the highest classification accuracy is 93.94% for detecting AF atThv=0.3. However, the highest reported classification accuracy is 98.4% for diagnosing ventricular septal defect (VSD) atThv=0.2[40]. To avoid setting differentThvto extract features for different heart diseases, a novel frequency feature matrixFFMproposed by the study [38] was evaluated and found to be efficient at diagnosing many types of heart diseases, such as aortic regurgitation (AR), aortic stenosis (AS) and mitral regurgitation (MR). However, using FFM for features to diagnose heart diseases involves complicated computation. Therefore, to reduce the computation of the proposed diagnostic system, principal components analysis (PCA) is a linear dimensionality reduction technique for finding new principal components in high-dimension data and is used to make a diagnostic system more simple and effective in many studies, such as those involving heart disease diagnosis [3], thyroid disease diagnosis [9], cardiac death diagnosis [16], coronary artery disease diagnosis [10], data clustering [22], cardiovascular diseases diagnosis [37] and electrocardiogram arrhythmias diagnosis [50].Recently, as a classification method, support vector machines (SVMs) have been proposed as an effective statistical learning method for the classification of different data classes using classification curves [45] and have been successfully used for the solution of many problems, such as handwritten digital recognition [27], cancer diagnosis [2], and heart murmur classification [40,6]. In the study [40], an SVM-based efficient calculation procedure for generating a classification curve was proposed that can successfully diagnose VSD.In this study, an innovative intelligent system for diagnosing heart disease is proposed. To achieve this intelligent diagnostic system, this study is arranged into four stages. In stage 1, an envelopeETis extracted from the heart sound signalXTfiltered using the wavelet decomposition method. In stage 2, heart sound segmentation points and peaks ofETare first automatically located based on a novel method,STMHT, and then S1 and S2 are automatically extracted according to the relationship between the systole time interval and the diastole time interval. In stage 3, in the frequency domain, a novel method is first proposed to generate the secondary envelopesSES1andSES2for S1 and S2, respectively, and then anSTMHT-based frequency feature matrix (FFM) is defined and automatically extracted fromSES1andSES2. Finally, two PCA-based first principal components,y1andy2, are generated from theFFMand used as the diagnostic features. In stage 4, SVM-based classification curves for the datasets consisting ofy1andy2, which are generated from heart disease sounds, are first generated by a novel procedure, and then, based on the classification curves, the diagnostic method are defined to diagnose detected sounds. Furthermore, to evaluate the performance of this intelligent system, a comparative analysis for the diagnosis of the sounds from online heart sound databases and clinical heart diseases in hospitals is performed to validate the proposed intelligent diagnostic system.

@&#CONCLUSIONS@&#
This study proposed an innovative intelligent system for diagnosing heart diseases. The innovation of this study is primarily reflected in the automatic S1 and S2 extraction, automatic 2-dimensional featurey1andy2generation and classification curve generation. To accomplish this intelligent diagnosis system, the procedure for the diagnostic system implementation was arranged as the following four stages. Stage 1 described an envelopeETfor heart sound signalXTfiltered using the wavelet decomposition method. In stage 2, heart sound segmentation points and peaks were first automatically located based on a novel method,STMHT, and then S1 and S2 were automatically extracted according to the diastole time interval, which is generally greater than the systole time interval in one period heart sound. In stage 3, in the frequency domain, a novel method was first proposed to generate the secondary envelopesSES1andSES2for S1 and S2, respectively, and then, based on theSTMHTofSES1andSES2, the frequency feature matrix (FFM) was automatically extracted fromSES1andSES2. Finally, the first two principal componentsy1andy2, which simplify the diagnostic system, were generated fromFFMbased on PCA and used as the diagnostic features. In stage 4, SVM-based classification curves for the datasets consisting ofy1andy2were first generated for disease sounds, and then, based on the classification curves, the diagnostic method was defined to diagnose detected sounds. To evaluate the performance of this automatic system, the total sound data (188-period AF sounds from 14 patients, 181-period AR sounds from 17 patients, 257-period MR sounds from 25 patients, 325-period NM sounds from 25 individuals, 150-period PS sounds from seven patients, 129-period SVSD sounds from 21 patients, 128-period MVSD sounds from 21 patients and 93-period LVSD sounds from 15 patients) were validated and classified with higher classification accuracies. Therefore, this proposed intelligent diagnosis system provides an efficient way to diagnose these types of heart diseases. In addition, further studies concerning methods to manage the sounds where S1 cannot be segmented from S2 using the STMHT method, to characterize the physical meaning by the frequency components and to build the models for the boundary curves proposed will be considered in the future.