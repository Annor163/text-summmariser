@&#MAIN-TITLE@&#
Semi-automatic motion compensation of contrast-enhanced ultrasound images from abdominal organs for perfusion analysis

@&#HIGHLIGHTS@&#
This paper proposes a semi-automatic system to motion compensated CEUS perfusion data.Evaluation showed equal or improved performance compared to manual processing.It saves 41% of the time required for manual processing of the datasets.

@&#KEYPHRASES@&#
Ultrasonography,Motion analysis,Motion compensation,Registration,CEUS,Contrast-enhanced ultrasound,Perfusion,Perfusion modeling,

@&#ABSTRACT@&#
This paper presents a system for correcting motion influences in time-dependent 2D contrast-enhanced ultrasound (CEUS) images to assess tissue perfusion characteristics. The system consists of a semi-automatic frame selection method to find images with out-of-plane motion as well as a method for automatic motion compensation. Translational and non-rigid motion compensation is applied by introducing a temporal continuity assumption. A study consisting of 40 clinical datasets was conducted to compare the perfusion with simulated perfusion using pharmacokinetic modeling. Overall, the proposed approach decreased the mean average difference between the measured perfusion and the pharmacokinetic model estimation. It was non-inferior for three out of four patient cohorts to a manual approach and reduced the analysis time by 41% compared to manual processing.

@&#INTRODUCTION@&#
Ultrasound (US) imaging is one of the most commonly available medical imaging techniques. It is cost-efficient compared to other imaging modalities, radiation free and portable. In the last decade, significant research has been conducted in the field of US contrast agents (CA) and associated acquisition protocols [1,2].Contrast-enhanced ultrasound (CEUS) is commonly used to assess perfusion in various organs such as the heart, liver, kidney, spleen, pancreas or bowel [3–5]. Gas-filled microbubbles serve as true intra-vascular tracers as they do not leak into extra-vascular space and their non-linear echo can be separated from the tissue echo (see Fig. 1). Thus, they enable the measurement of absolute perfusion parameters such as blood volume, mean transit time and blood flow in an organ per unit time [6,7]. It is crucial to know the actual perfusion of an organ in many processes such as assessing ischemia, characterizing tumors and separating inflammatory from fibrotic processes [8–10]. Absolute perfusion can be quantified using pharmacokinetic modeling where the CA-concentration time curve is approximated by an appropriate model [6,11].CEUS image sequences are subject to limitations interfering with correct analysis of the data. The most noticeable interference in addition to noise and speckle artifacts is motion [12]. Motion originates from various sources and can be subdivided into intrinsic and extrinsic sources [13]. Intrinsic sources are breathing, perfusion or digestive activity resulting in moving organs or tissue. Extrinsic sources include the tilting or moving of the US probe. This happens unintentionally due to breathing or patient motion. However, this also occurs intentionally when the examiner tries to adapt the field of view of the transducer to image a region of interest (ROI). This adaption is often necessary at the time of CA arrival when enhancement becomes visible. While breathing or tilting of the probe mostly causes linear motion shifts, organ motion such as aorta pulsation or the heartbeat results in non-linear deformation effects.Valid spatial correspondences of tissue over time cannot be established if the images of the sequences are influenced by such motion [14]. A specific problem of 2D image acquisition is that motion can emerge in directions perpendicular to the imaging plane (3D motion) so that frames are acquired out-of-plane. Whereas motion occurring within the imaging plane can be compensated by image processing methods, frames with out-of-plane motion yield erroneous information and should be removed.Motion analysis in US imaging can be performed through speckle decorrelation analysis [15]. However, reliable estimates of the motion extent are only obtained from an ideal medium with known and uniform speckle characteristics. In addition, this only works for in-plane motion as out-of-plane motion results in a changed speckle pattern. To overcome the problem of unknown speckle characteristics, Laporte and Arbel [16] proposed to use learning methods and synthetic US images with known ground truth. However, for learning methods, a sufficiently large database has to be available. Additionally, learning has to be performed for a specific application scenario.Only few approaches in the literature discuss the detection of out-of-plane motion when applying motion compensation. Renault et al. [17] proposed a method for hepatic CEUS by using frame selection of a specific point in the respiration cycle through factor analysis of independent components. According to the authors, this is necessary to avoid mixing information of different imaging planes. The approach requires that the liver occupies the same position at a particular point in the respiration cycle. This cannot be generalized for observations of abdominal organs. Frouin et al. [18] examined the quality of motion compensation. If residual motion exceeds a certain threshold, the affected images are excluded. In other publications, the problem of out-of-plane motion is mentioned and accounted for in a motion compensation approach, although it does not lead to the exclusion of data [19,20].In most scenarios of motion compensation, image registration is used [21]. In contrast to standard registration techniques where two images are aligned, motion compensation in CEUS requires the alignment of multiple images. Formalizing the problem for all images leads to the introduction of constraints in spatial and temporal direction. Temporal constraints, i.e. restrictions on motion depending on preceding or successive frames, can be incorporated in a number of different ways to stabilize the search process for correct motion compensation. In particular, this holds true if dealing with low signal-to-noise ratio (SNR) and low resolution [22].Original work was done by Szeliski and Coughlan [23] who use splines to regularize the motion field for the registration of image series. This has been adapted by many researchers to solve specific application problems. Registration of US image sequences of the heart allows for quantification of the contractility of the myocardium by cardiac motion estimation. Carbayo et al. [24,19] treated this registration problem as a global one, searching for the correct motion within a single optimization scheme with spatial and temporal smoothness constraints by using spline functions. This compensates for the deficiencies in US datasets, specifically the low SNR and decorrelated speckle patterns due to out-of-plane motion. In addition to the smoothness assumption, the velocity of the motion change can be assumed to be continuous [25].A new approach for the detection of out-of-plane motion and motion compensation in US is required that is not specialized for an organ class. We propose the first system to target semi-automatic motion analysis and compensation for CEUS images of abdominal organs. For the correct perfusion analysis of CEUS data it is inevitable to perform a motion analysis to exclude out-of-plane frames. We use a similarity correlation analysis based on the measured intensities in the B-mode data to help the user identify areas of out-of-plane motion. Subsequently, a two-step strategy for motion compensation combining the compensation of linear shifts and non-linear motion deformations is applied. Both steps are achieved using image registration with optimization through Markov random fields (MRF) [26]. This can be efficiently calculated with graph cut-based approaches [27–29]. MRF have been successfully used to solve problems of optical flow, non-rigid image registration and combined registration and segmentation [30–32].The aim of our evaluation study was to examine if our CEUS analysis system performed equally well as manual correction and reduced the analysis time. Since we did not know the ground truth, the quality of both approaches was assessed by measuring the difference to a pharmacokinetic model [6]. We assume that a considerable amount of time is saved by using the proposed method and that the accuracy of the computer assisted motion compensation improves compared to manual analysis according to the pharmacokinetic model analysis.In previous publications, we proposed the motion analysis for out-of-plane motion detection [13] and the MRF-based motion compensation system [33]. The difference to the motion compensation method in this work is the introduction of B-spline based transformation functions instead of direct pixel translations and a larger patient data evaluation.The study was performed on 40 datasets. Twenty datasets were acquired from patients at the clinic at Haukeland University Hospital of which 10 had cystic fibrosis with exocrine pancreatic failure and 10 patients had an acute exacerbation of Crohn׳s disease. The other 20 recordings were from healthy volunteers of which 10 where acquired from the pancreas and 10 from the small or large bowel. Bowel and pancreas were chosen as target organs in this study as they represent different challenges in perfusion quantification. The bowel is relatively stable, superficially located and the healthy bowel wall is very thin. The pancreas is severely affected by both respiration and pulsation of the abdominal aorta and deeply located. The Regional Ethics Committee West approved the study and all patients and healthy volunteers gave their informed consent to participate in the study.

@&#CONCLUSIONS@&#
The presented methods offer a thorough approach to process CEUS recordings for perfusion analysis. They are able to reduce variability and analysis time compared to a manual approach especially with regard to noisy datasets. Compared to a time consuming manual analysis, the proposed system is able to reach the same level of accuracy in terms of a pharmacokinetic model evaluation in bowel and pancreas datasets. This is an important aspect as such a model is also used to extract perfusion parameters for diagnosis. The system is generalizable in order to be used for different abdominal organs. However, additional studies need to be conducted to assess the performance improvement compared to manual analysis.None declared.