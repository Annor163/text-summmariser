@&#MAIN-TITLE@&#
Efficient offset trimming for deformable planar curves using a dynamic hierarchy of bounding circular arcs

@&#HIGHLIGHTS@&#
Offset trimming for planar freeform curves under deformation.Dynamic BVH generation using a hierarchy of recursive bisections.BV generation using the bounding circular arcs (BCA) of Meek and Walton (1995).Performance improvement over the biarc-based algorithm of Kim et al. (2012).

@&#KEYPHRASES@&#
Planar freeform curve,Offset curve trimming,Monotone spiral curve,Bounding circular arcs,Dynamic BVH,Self-intersection,

@&#ABSTRACT@&#
We present an efficient algorithm for computing a family of trimmed offsets for planar freeform curves under deformation. The algorithm is based on a dynamic bounding volume hierarchy (BVH) for the untrimmed offsets of a given planar curve, which can be generated efficiently using a hierarchy of recursive bisections of the given curve. The proposed algorithm is effective for deformable planar curves. At each time frame, we segment the input curve into monotone spiral pieces (Barton and Elber, 2011), which is the only pre-processing needed for the dynamic BVH construction. To speed up the on-line generation of dynamic BVH, we employ the bounding circular arcs (BCA) of Meek and Walton (1995) that can be computed very efficiently using the position and tangent information at the endpoints of each monotone spiral curve segment. Using several experimental results, we demonstrate the performance improvement of our algorithm over the previous biarc-based algorithm of Kim et al. (2012).

@&#INTRODUCTION@&#
The generation of offset curves and surfaces has been one of the most active research areas in CAD/CAM  [1,2]. There are many previous algorithms developed for trimming offset curves and surfaces  [3–11]. Nevertheless, the offset trimming is a highly unstable geometric problem, in particular, when the given curves and surfaces are under deformation. The current work proposes an efficient and robust solution to this non-trivial problem.Given a deformable planar freeform curveC(t), we consider the problem of computing a family of trimmed offset curvesOrwith respect to different offset radiir. For this purpose, we present an efficient algorithm for computing all self-intersection points of the untrimmed offset curve defined as follows:Or(t)=C(t)+r⋅N(t),whereN(t)is the unit normal ofC(t).Topological analysis (combined with efficient point projections to the curveC(t)) around self-intersection points produces a robust algorithm for trimming all redundant components of the offset curve, i.e., the segments closer to the curveC(t)than the offset radiusr. Fig. 1shows a self-intersecting planar curve (in black) and its two-sided offset curve (in red). All self-intersections of the untrimmed offset curveOr(t)are marked as dots. Removing redundant branches (in blue) of the offset curveOr(t), we can complete the offset trimming procedure. The main computational bottleneck for the offset trimming is the efficient and robust detection of self-intersection locations in the untrimmed offset curveOr(t).In a recent work, Kim et al.  [12] employed aG1-biarc approximation of planar freeform curves  [13] and essentially reduced the offset trimming problem to that of computing all intersections among offset arcs. Because of the high approximation order of arc-splines to planar curves, the biarc-based approach of Kim et al.  [12] is considerably more efficient and robust than previous algorithms [7,10]. For deformable planar curves, however, the biarc approach requires a repetitive computation of theG1-biarc approximation for each time frame of the curve deformation. The most time-consuming part in the biarc approximation is in the estimation of a tight upper bound for the maximum error of the curve approximation.In this paper, we make the error bounding straightforward for a monotone spiral curve using the bounding circular arcs (BCA) of Meek and Walton  [14]. (A spiral curve is an inflection-free curvature monotone curve  [15].) Each arc of BCA interpolates two end points and one end tangent. The center is located at the intersection between the curve normal line at one end and the bisector line of the two endpoints. The bounding arcs share the bisector line as their common axis of symmetry as shown in Fig. 2(a). The BCA bounding volume has cubic convergence  [14], as illustrated in Fig. 2(b) for the spiral curveC(t)=(t,t2),0≤t≤1, subdivided atC(12). For efficient overlap tests, we may employ simpler bounding volumes such as oriented bounding box (OBB)  [16] and line swept circle (LSC)  [17] using the outer bounding circle of BCA (Figs. 2(c) and (d)).As an illustration of our approach, Fig. 3(a) shows a periodic cubicB-spline curveC(t)which consists of 12 cubic Bézier segmentsCi(t),0≤t≤1. Also shown in the figure is a two-sided untrimmed offset curveOr(t)(excluding “fishtails”). Each Bézier curve is first segmented intoxandy-monotone spiral curves by subdividing atxandy-extreme points, inflection points, and curvature extreme points  [15]. The corresponding offset segments are then bounded by axis-aligned bounding boxes (AABBs), bounding circular arcs (BCAs), line swept circles (LSCs) (Figs. 3(b)–(d)). The BCAs after one step refinement are visually almost indistinguishable from the offset curve (Fig. 3(e)). The corresponding LSCs are shown in Fig. 3(f). The size of LSC changes depending on the segmentation result ofC(t)andOr(t)into small pieces. Each self-intersection ofOr(t)should be contained in the overlap of (non-adjacent) BCAs (or LSCs). By refining the overlapping regions and repeating the same overlap test, we can compute a more accurate location of the self-intersection point contained in the overlap region. Redundant offset curve segments are eliminated when the distance to the curveC(t)is smaller than the offset radiusr, an efficient detection of which can be implemented using the BCA tree of the curveC(t). Fig. 3(g) shows the BCA regions forC(t)at the highest level of the hierarchy. The final result of offset trimming is presented in Fig. 3(h).The rest of this paper is organized as follows. In Section  2, we briefly review related previous work. Section  3 presents the dynamic BVH for planar curves and their offsets. In Section  4, we discuss the details of our offset trimming algorithm. Some experimental results are presented in Section  5, and finally, Section  6 concludes the paper.

@&#CONCLUSIONS@&#
We have presented an efficient and robust algorithm for trimming offset curves when the given planar curves are under deformation. For this purpose, we have developed a special dynamic bounding volume hierarchy, which is based on a recursive uniform sampling and BCA approximation of the planar curve and the offset curves under deformation. Compared with other conventional techniques, the BCA approximation provides an optimal solution to our current needs: an efficient dynamic generation of tightly bounding regions with cubic convergence to planar curves under deformation. An extension of our result to the more general problem of trimming self-intersections in the offset surfaces is considerably more challenging than the current problem, an efficient solution of which is an immediate goal of our future work.