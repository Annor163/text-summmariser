@&#MAIN-TITLE@&#
Geometric shapes of C-Bézier curves

@&#HIGHLIGHTS@&#
Transformation matrixes between any C-Bézier curve and its separated form.Geometric shape and the explicit expressions of the geometric characters of any C-Bézier curve.Sufficient and necessary conditions for the C-Bézier basis constructing some classical curves.Some classical curves can be constructed intuitively.

@&#KEYPHRASES@&#
Computer aided geometric design,Bézier curve,C-Bézier curve,Trajectory,Ellipse,

@&#ABSTRACT@&#
In this paper, we focus on the geometric shapes of the C-Bézier curves for the space span{1,t,…,tn,sint,cost}. First, any C-Bézier curve is divided into a Bézier curve and a trigonometric part. So any C-Bézier curve describes the trajectory of a point orbiting around a center in an elliptical orbit while the orbital plane is moving as the ellipse center translating along a Bézier curve. Second, the geometric characters of the C-Bézier curve (the control points of the center Bézier curve, the trajectories of the vertices and the foci of the ellipse, etc.), can all be explicitly presented by the control points of the C-Bézier curve. Third, considering some special cases, we give the sufficient and necessary conditions of C-Bézier basis forming Bézier curve, ellipse, circle, common helix, and so on. Lastly, we show how to build some geometrically intuitive curves through the C-Bézier basis without rational forms.

@&#INTRODUCTION@&#
The Bézier-like models, defined over some non-algebraic polynomial spaces, may be used as alternatives of the rational Bézier model  [1]. They include thep-Bézier  [2], the quasi Bézier  [3], the C-Bézier  [4,5], the AH-Bézier  [6], the AHT-Bézier  [7], the Bézier-like models using complex numbers  [8–10], and so on.These Bézier-like models can build some classical curves without rational forms; for example, C-Bézier for ellipse, and AH-Bézier for hyperbola. Then what about the general cases? This paper considers an arbitrary C-Bézier curve overΓn=span{1,t,…,tn,sint,cost}[5].(1)P(t)=∑i=0n+2Ci,n+2(t)Pi,t∈[0,α],whereα∈(0,π)is the given shape parameter,{Pi}i=0n+2are the control points, and{Ci,n(t)}i=0n+2are the C-Bézier basis functions.We focus on the geometric shape of the C-Bézier curve (1). Previous studies indicate that any rational quadratic Bézier curve is a conic  [11]. Its geometric characters (vertices, eccentricity, etc.) can be explicitly expressed by the control points and weighs [12,13]. Similarly, for any given C-Bézier curve (1) overΓn, we ask two questions.•What is the geometric shape of (1)?Can the geometric characters of (1) be expressed by its control points{Pi}i=0n+2explicitly?For the first question,  [14] gives the answer to planar curves under the conditionn=1. In this paper, we consider more general cases, both planar and space curves, for any positive integern. We explain what the C-Bézier curve is from a geometric view. This helps the intuitive construction of some classical curves.The C-Bézier curve (1) forΓncan be represented as(2)P(t)=Q(t)+R(t),t∈[0,α],called the separated form in this paper. Here,Q(t)is the Bézier part(3)Q(t)=∑i=0nBi,n(t)Qi,t∈[0,α],where{Qi}i=0nare the control points and{Bi,n(t)}i=0nare the Bernstein basis functions of degreenon[0,α]. AndR(t)is the trigonometric part(4)R(t)=R0sint+R1cost,t∈[0,α].In this paper, both{Ri}i=01and{Qi}i=0nare called geometric points of (1) to distinguish them from the C-Bézier’s control points{Pi}i=0n+2.In this section, we consider the transformation between the C-Bézier form (1) and the separated form (2).First, the three bases are all rewritten as rows.(5)Cn+2(t)=(C0,n+2(t)C1,n+2(t)…Cn+2,n+2(t)),(6)Bn(t)=(B0,n(t)B1,n(t)…Bn,n(t)),(7)T(t)=(sintcost).Then consider each basis’s derivative oft. From (5),(8)ddtCn+2(t)=Cn+1(t)Hn+1,whereHn+1=(−δ0,n+1−1δ0,n+1−1⋱⋱−δn+1,n+1−1δn+1,n+1−1)is an(n+2)×(n+3)matrix andδi,n+1=∫0αCi,n+1(s)ds,0≤i≤n+2.Similarly, from (6) and (7), there exists(9)ddtBn(t)=Bn−1(t)Gn−1,ddtT(t)=T(t)M,whereM=(0−110)andGn−1=nα(−11⋱⋱−11)n×(n+1).Consider the transformation matrixAn+2fulfilling(10)Cn+2(t)=(T(t)Bn(t))An+2.First, take the derivative ofton the both sides of (10). According to (8), (9), (10) and the linear independence of(T(t)Bn−1(t)), a basis forΓn−1, we haveAn+1Hn+1=Wn+1An+2whereWn+1=(MGn−1).Second, to get the recursion ofAn+2, we useGˆn−1=(Gn−101)(n+1)×(n+1),Wˆn+1=(MGˆn−1)(n+3)×(n+3),Aˆn+1=(An+1001)(n+3)×(n+3),Hˆn+1=(Hn+1I)(n+3)×(n+3),whereI=(01)+(cosαa0−sinαa1)Hn+1anda0,a1is the first, second row ofAn+1, respectively.It is easy to see thatWˆn+1is invertible, andWˆn+1−1=(M−1Gˆn−1−1),whereM−1=(01−10)andGˆn−1−1=−αn(11⋯1−nα1⋯1−nα⋱⋮⋮1−nα−nα).Third, from the endpoint property of the C-Bézier basis in  [5], we can get the recursion formula(11)An+2=Wˆn+1−1Aˆn+1Hˆn+1.Lastly, from the initial matrix(12)A2=12sin2α2(−sinαsinα0−cosα2cos2α2−11−2cos2α21),we have the following theorem about (1).Theorem 2.1C-Bézier Curve to Separated FormAny C-Bézier curve   (1)   can be transformed to the separated form   (2). The geometric points(R0R1Q0…Qn)T=An+2(P0…Pn+2)T,where the transformation matrixAn+2can be obtained by the recursion   (11)   and the initializationA2in   (12).In this paper, without special explains, we use blue circles to denote the C-Bézier’s control points{Pi}i=0n+2. The corresponding C-Bézier curve is blue. The geometric points,{Ri}i=01, are red diamonds, and{Qi}i=0nare red asterisks. The Bézier curve given by{Qi}i=0nis red. The separated form curve defined by the geometric points{Ri}i=01and{Qi}i=0nis in magenta.Fig. 1shows an example, whereα=3. Given the control points{Pi}i=04, the geometric points{Ri}i=01and{Qi}i=02are obtained from Theorem 2.1. The magenta thinner curve, drawn by the geometric points and the separated-form basis, is the same as the blue thicker C-Bézier curve. This means that our formulas are all correct.Consider the transformation matrixAn+2−1satisfying(T(t)Bn(t))=Cn+2(t)An+2−1.To avoid calculating the inverse, we consider the Bernstein basis and the trigonometric part separately. LetT(t)=Cn+2(t)D,(13)Bn(t)=Cn+2(t)Fn.First, considerFn=(fij)(n+3)×(n+1). Suppose that the rows ofFnfrom top to bottom arefi,i=0,1,…,n+2in order. Lett=0in (13). Then we have(14)f0=(10).Take the derivative ofton the both sides of (13). Then lett=0in the derivative equation. Thus we havef1=f0+nαδ0,n+1(−110).Through gradual derivations, we get(15)fi=(gi−∑l=0i−1hlifl)δi,1≤i≤⌊n2⌋+1,where(16)δi=∏j=0i−1δj,n+2−i+j,giis the first row of∏j=n−in−1Gj, andhliis the(l+1)th element in the first row of∏j=n+2−in+1Hj. From the symmetry of the Bernstein and the C-Bézier basis, we have(17)fij=fn+2−i,n−j,0≤j≤n,⌊n2⌋+2≤i≤n+2.Second, suppose that the rows ofDfrom top to bottom aredi,i=0,1,…,n+2, in order. Similarly, we have(18)d0=(01),dn+2=(sinαcosα),(19)di=(d0Mi−∑l=0i−1hlidl)δi,(20)dn+2−i=[(−1)idn+2Mi−∑l=0i−1hlidn+2−l]δi,wherei=1,2,…,⌊n2⌋+1.Lastly, we get the following theorem.Theorem 2.2Separated Curve to C-Bézier FormAny separated-form curve   (2)   can be transformed to its C-Bézier form   (1). The control points(P0…Pn+2)T=An+2−1(R0R1Q0…Qn)T,whereAn+2−1=(DFn). The rows ofFn,{fi}i=0n+2, and the rows ofD,{di}i=0n+2, can be obtained by   (14)–(20).Fig. 2shows an example, whereα=3. Given the geometric points{Ri}i=01and{Qi}i=03, the control points{Pi}i=05are obtained by Theorem 2.2. Its blue thinner C-Bézier curve is the same as the thicker magenta separated-form curve. This means that our transformation formulas are all correct.This section focuses on the geometric shapes of C-Bézier curves. We first consider the general cases, and then some special cases.From the last section, any C-Bézier curve (1) can be represented as the separated form (2). So in the general cases, any pointP(t)on the C-Bézier curve (1) is regarded as the pointQ(t)on a Bézier curve (3) added the vectorR(t), whereR(t)is a vector starting from the center of an ellipse and ending at a point on the rim of the ellipse, seen in Fig. 3. For simplicity, we callR(t)the ellipse radius vector ofP(t)in the paper.Therefore, any C-Bézier curve (1) describes the trajectory of a point making a revolution in an elliptical orbit while the orbit plane is translating with the ellipse center along a Bézier curve. From Theorem 2.1, the control points of the center Bézier curve can be explicitly represented as a linear combination of the C-Bézier’s control points. About the ellipse, we separately sett=0,π2in (4). So it is obvious that the ellipse radius vectors of the four ellipse vertices are±R0and±R1ifR0•R1=0.IfR0•R1≠0, then we set a variableλ∈[−π2,π2), which satisfiesR(t)=L0sin(t+λ)+L1cos(t+λ)andL0⊥L1. By comparing with Eq. (4), we have(21){R0=L0cosλ−L1sinλR1=L0sinλ+L1cosλL0•L1=0.There is one solution forL0,L1andλ.(22){L0=cosλR0+sinλR1L1=−sinλR0+cosλR1,(23)sinλ={{0‖R0‖≤‖R1‖−1‖R0‖>‖R1‖R0•R1=0−2R0•R1μ(μ+R12−R02)R0•R1≠0,(24)cosλ={{1‖R0‖≤‖R1‖0‖R0‖>‖R1‖R0•R1=0μ+R12−R022μR0•R1≠0,(25)μ=(R02−R12)2+4(R0•R1)2.Eqs. (23)–(25) involve in the cases ofR0•R1=0and ensure that‖L0‖≤‖L1‖. We see the ellipse centered atQ0in Fig. 4, whereR0is the ellipse radius vector ofP0, andL0,L1is the ellipse radius vector of a minor, major axis vertex, respectively.In the paper, without special explanations, the C-Bézier curve and its center Bézier curve is drawn in blue and red, respectively. The curves limited on[0,α]are thicker than the extended curves. The ellipses are all black, while their centers on the Bézier curve are red dots. Blue dots are the intersection points of the ellipses with the C-Bézier curve.The geometric shape of the C-Bézier curve is shown in Fig. 5, whereα=3. Fig. 5(a) draws the C-Bézier curve and its center Bézier curve on[0,α]. The ellipse radius vectors of the two vertices,{Li}i=01, are both drawn as black arrows. In Fig. 5(b), we show the extended curve of Fig. 5(a).Theorem 3.1Shape of C-Bézier CurveAny C-Bézier curve   (1)   is the trajectory of a point turning around a center in an ellipse orbit while the orbit plane is translating with the center along a Bézier curve   (3). A normal of the plane pencil formed by the moving orbit plane isL0×L1, whereL0andL1can be explicitly linearly presented by{Pi}i=0n+2fromTheorem  2.1   and   (22)–(25). The minor, major radius of the ellipse is‖L0‖,‖L1‖, respectively. The trajectories of the four vertices of the moving ellipse areQ(t)±L0,Q(t)±L1,that is, four Bézier curves with the control pointsQi±L0,Qi±L1,i=0,1,…,n; the trajectories of the two foci areQ(t)±‖L1‖2−‖L0‖2‖L1‖L1,that is, two Bézier curves with the control pointsQi±‖L1‖2−‖L0‖2‖L1‖L1,i=0,1,…,n. The shape parameterαdescribes the revolution angle from the start point to the end point of   (1)   if the ellipse is changed into a circle through an affine transformation.If the C-Bézier’s control points are all coplanar, then the ellipse lies on the same plane as the center Bézier curve. Fig. 6gives an example, whereα=1and the ellipse is a circle. Soαis the revolution angle.Ifα→0, then (1) converges to a Bézier curve of degreen, whose control points are{Qi+R1}i=0n. So the results about the limit of C-Bézier curve in  [5,15] are deepened from a geometric view.Fig. 7gives a space case, whereα=2. The vertex trajectories, four Bézier curves, are in green. They intersect the ellipses at the green dots.Theorem 3.2Bézier CurveAny C-Bézier curve   (1)   is a Bézier curve iffL0=L1=0.In Fig. 8, the blue C-Bézier curve is just the red Bézier curve.Theorem 3.3EllipseAny C-Bézier curve   (1)   is an ellipse arc iff①all the control points of the center Bézier curve(3),{Qi}i=0n, coincide with each other;L0,L1≠0.Fig. 9gives an example of a circle arc, whereα=2. The center Bézier curve is a single point, i.e. the center of the circle.αis just the central angle corresponding to the C-Bézier arc.A common helix is a 3D curve that turns around an axis at a constant distance while moving uniformly parallel to the axis.Theorem 3.4Common HelixAny C-Bézier curve   (1)   is a segment of a common helix iff①its center Bézier’s control points,{Qi}i=0n, are all collinear and with uniform nonzero-gap distribution;(L0×L1)//Q0Qn, and‖L0‖=‖L1‖≠0.The first condition holds iff the degree of the center Bézier curve (3) is 1. That is,ddtQ(t)is a constant. It ensures that the velocity of translation along the center Bézier curve is uniform. Fig. 10gives an example of a common helix, whereα=3.Theorem 3.5Sin/Cos CurveAny C-Bézier curve   (1)   is a segment of a sin/cos curve iff①its center Bézier’s control points,{Qi}i=0n, are all collinear and with uniform nonzero-gap distribution;in{L0,L1}, one and only one vector is0, while the other nonzero one is perpendicular toQ0Qn.Fig. 11gives an example of sin curve, whereα=2.So any planar C-Bézier curve overΓ1is a single point, a line, an ellipse, an affine image of a trochoid or a sin/cos curve. The result is consistent with  [14].The Shape analysis for the C-Bézier curve may be used to construct some geometrically intuitive curves.For example, cycloid is traced by a point on the rim of a circle while the circle is rolling along a line at a uniform speed  [16]. First, designL0,L1satisfying‖L0‖=‖L1‖=r, whereris the radius of the circle. Second, chooseλ, the angle between the ellipse radius vector of the start point and the circle’s forward direction parallel to the line. Third, designQ0,Qn, which are the two endpoints of the center line segment fulfilling‖Q0Qn‖=l. Fourth, choose the rotation angleα. Lastly, the C-Bézier’s control points can be obtained from (21) and Theorem 2.2.See Fig. 12. We can adjustα,randl. Ifαr>,=,<l, then the C-Bézier curve (1) is a segment of a prolate cycloid, a common cycloid, a curtate cycloid, seen in Fig. 12(a)–(c), respectively.

@&#CONCLUSIONS@&#
In this paper, we consider the geometric shapes for C-Bézier curves overΓn. Theorem 3.1 answers the two questions in Section  1.Our main results include: the transformation matrixes between any C-Bézier curve and its separated-form; the geometric shape and the explicit expressions of the geometric characters of any C-Bézier curve; the sufficient and necessary conditions for the C-Bézier basis constructing some classical curves (ellipse, helix, etc.). The results show the geometric means of C-Bézier curves, so that some classical curves can be constructed intuitively.