@&#MAIN-TITLE@&#
Dual representation of spatial rational Pythagorean-hodograph curves

@&#HIGHLIGHTS@&#
Dual representation of spatial rational PH curves is presented.Connection between the degrees of a dual and a point representation of rational curves is revealed.It is proven that linear quaternion polynomials lead to reparameterized cubic PH curves.Spatial rational PH curves of a classm=3,4,5,6are derived in a closed form having2m+4degrees of freedom.

@&#KEYPHRASES@&#
Pythagorean-hodograph,Rational curves,Dual parametric curve form,Frenet frame,Quaternions,

@&#ABSTRACT@&#
In this paper, the dual representation of spatial parametric curves and its properties are studied. In particular, rational curves have a polynomial dual representation, which turns out to be both theoretically and computationally appropriate to tackle the main goal of the paper: spatial rational Pythagorean-hodograph curves (PH curves). The dual representation of a rational PH curve is generated here by a quaternion polynomial which defines the Euler–Rodrigues frame of a curve. Conditions which imply low degree dual form representation are considered in detail. In particular, a linear quaternion polynomial leads to cubic or reparameterized cubic polynomial PH curves. A quadratic quaternion polynomial generates a wider class of rational PH curves, and perhaps the most useful is the ten-parameter family of cubic rational PH curves, determined here in the closed form.

@&#INTRODUCTION@&#
Polynomial Pythagorean-hodograph curves are characterized by the property that the Euclidean norm of their hodograph is a polynomial, not a square root of a polynomial. These curves thus have a rational unit vector field of tangents, rational offset curves, and a polynomial arc length what makes them an important practical tool that finds its applications in robotics, in CAD/CAM systems, in animations, etc. Polynomial PH curves were introduced in Farouki and Sakkalis (1990) and have widely been studied since then (see Farouki, 2008 and the references therein). The usual approach to obtain a polynomial PH curve is to integrate the appropriate hodograph constructed with the help of the complex or the quaternion polynomials in the plane or in the space case respectively (see e.g. Farouki, 2008, 1994; Choi et al., 2002).But the natural extension of the PH property to rational curves turned out to be quite a task, and only few results are known in this direction. The main obstacle is the fact that the polynomial preimage approach cannot be applied here since the integral of a rational curve is not a rational curve in general. Planar rational PH curves were derived in Pottmann (1995a), and independently in Fiorot and Gensane (1994). The suggested construction determines a planar rational curve as the envelope of a one-parameter family of tangent lines, given by a rational unit vector field of tangents, and a rational support function which defines the distance of the tangent line from the origin. As observed in Pottmann (1995a), the introduced dual form of a planar rational PH curve turns out to be more appropriate from the computational point of view than the corresponding point representation. Interpolation schemes involving planar PH curves can be found in Pottmann (1995b).A short note (Pottmann, 1994) made the first step to spatial rational PH curves. It introduced the space curves in dual representation as well as its wedge product notation. Just recently, a comprehensive study of these curves has been carried out in Farouki and Šír (2011), where the construction of rational spatial PH curves has been presented and further justified and illuminated from several equivalent geometric viewpoints. Basically, the approach originates from the implicit curve representation involving the curve binormal direction and a rational function that determines the signed distance of the osculating plane from the origin. In order to assure the PH property of the curve, its binormal directions are generated from a rational vector field of unit length tangents.In this paper a further insight into rational spatial PH curves is provided, with emphasis to their construction in a form that could be used in practical applications. First of all, since the construction in Farouki and Šír (2011) leads to rational PH curves of high degree in general, we stick to the dual form introduced in Pottmann (1994, 1995a). Note that this curve representation can be naturally extended to any dimension. In the PH case, the dual form enables one to deal in general with polynomials of a significantly lower degree than in the curve closed form point representation. The exception is the cubic case where degrees of both representations are equal. Equipped with the dual approach, we obtain the dual PH curve from the Euler–Rodrigues frame in a similar way as already in Farouki and Šír (2011). The E–R frame is generated by quaternion polynomials, and we focus on the question, how one should choose superfluous parameters to assure that the corresponding dual form would be of a low degree. Quaternion polynomials of degree ⩽2 are considered here in detail. It is shown that linear quaternion polynomials give rise to cubic or reparameterized cubic polynomial PH curves. Based on quadratic quaternion polynomials we derive rational PH curves with the dual form of degreem=3,4,5,6having2m+4degrees of freedom. In particular, a ten parametric family of cubic rational PH curves with nonconstant denominator is presented in a closed form. This comes somewhat as a surprise since there are no additional free parameters in comparison to the cubic polynomial case.The paper is organized as follows. In the next section the dual form of a parametric space curve is introduced and its properties with the emphasis on rational curves analysed. Section 3 introduces rational PH curves with the dual form based upon E-R frame. Degree of the dual form of a rational PH curve and its reduction is considered in Section 4. In the next section curves that arise from a linear quaternion polynomial are treated. Rational PH curves from a quadratic quaternion polynomial are considered in Section 6 together with a few examples. In the end, we discuss possible future work directions.In Pottmann (1994) or Farouki and Šír (2011), the key step to the construction of rational PH curves was a nice implicit representation of a parametric curve. Since the approach works in the planar case too, and it could be extended to more than three dimensions if needed, we briefly recall it. Letr:[α,β]→R3be a smooth parametric curve such that the derivativesr′andr″are linearly independent on the parameter interval[α,β]. Then the corresponding Frenet frame(t,n,b)is well defined for eacht∈[α,β]. Here, the vectorst,nandbdenote the unit tangent, the principal normal and the unit binormal respectively. Further, a pointr(t)can be uniquely recovered as the intersection of the osculating, the rectifying, and the normal plane at a particular parameter valuet∈[α,β]. This givesras a set of pointsp∈R3that satisfy the linear system(1)b(t)⋅(p−r(t))=0,n(t)⋅(p−r(t))=0,t(t)⋅(p−r(t))=0,t∈[α,β].Here, the dot ⋅ denotes the scalar product inR3. If the torsion τ of the curverdoes not vanish on[α,β], as observed in Farouki and Šír (2011), the one-parametric family of linear systems (1) is by Frenet–Serret formulas equivalent to(2)b(ℓ)(t)⋅p−(b⋅r)(ℓ)(t)=0,ℓ=0,1,2,t∈[α,β].These systems can further be simplified by any nonzero functionϕ∈C2([α,β])to(3)u(ℓ)(t)⋅p−f(ℓ)(t)=0,ℓ=0,1,2,t∈[α,β],where(4)u:=ϕb,f:=ϕb⋅r.Namely, (2) and (3) are equivalent since by the Leibniz rule one has(u⋅p−fu′⋅p−f′u″⋅p−f″)=(ϕ00ϕ′ϕ0ϕ″2ϕ′ϕ)(b⋅p−b⋅rb′⋅p−(b⋅r)′b″⋅p−(b⋅r)″).Note thatfϕdenotes the signed distance of the osculating plane with the normal vectorufrom the origin. Ifuand f are given, anddet(u,u′,u″)≠0, the curvermay be determined from (3). Rather then using the closed form solution (Farouki and Šír, 2011) that gives the point representationr=1det(u,u′,u″)(fu′×u″+f′u″×u+f″u×u′),where × denotes the cross product, we proceed to the construction of curves in the implicit form (3). The coefficients of the first equation in (3) whereℓ=0that pin down the family of the osculating planes, determine the corresponding curve uniquely since the second and the third equations of the system (3) follow from the first one. Following Pottmann (1995a) we call them dual coordinates of the parametric curve. In order to shorten the notation we introduce an imbedding shortcutR×R3→R4that will be used throughout the paper,(u0;u):=(u0;(u1,u2,u3)T):=(u0,u1,u2,u3)T.Withu=(u1,u2,u3)Twe order the dual coordinates in the curve dual form LL:=(−f;u)=(−f,u1,u2,u3)T.Quite clearly, the dual formLis homogeneous. It determines the same curve if multiplied by any smooth nonzero function. More generally, let ∼ denote this type of equivalence between vector fields. Two vector fieldsQi:[α,β]→Rd,i=1,2, are equivalent,Q1∼Q2, iffQ1=ζQ2for some smooth function ζ that does not vanish on this interval. Since the dual form is homogeneous, it is convenient to rewrite the original curverin a homogeneous form too,(5)P:=(P0,P1,P2,P3)T∼(1;r),r=1P0(P1,P2,P3)T,P0≠0.Relations betweenPandLcould be written in a very compact form. Let⋅∧⋅∧⋅denote the Grassmann wedge product, defined asv1∧v2∧v3:=((−1)idetV[i])i=14,vj∈R4,whereV=(v1,v2,v3)∈R4×3andV[i]∈R3×3is a submatrix of V with i-th row of the original matrix omitted. The system (3) in the homogeneous form readsL(ℓ)⋅P=0,ℓ=0,1,2. If we differentiate these equations consecutively, we obtain(6)L(ℓ)⋅P(r)=0,0⩽ℓ+r⩽2,L(r)⋅P(3−r)+L(3−r)⋅P(r)=0,r=0,1.By (6) and the assumption on the derivatives ofrand τ it follows(7)P∼L∧L′∧L″,L∼P∧P′∧P″.Moreover, any regular reparameterizationφ:[α,β]→[γ,δ]of one form reparameterizes the other one too,(8)P∘φ∼(L∘φ)∧(L∘φ)′∧(L∘φ)″,L∘φ∼(P∘φ)∧(P∘φ)′∧(P∘φ)″.Note that the first assertion in (7) has already been derived in Pottmann (1994). Both relations in (7) emphasize the symmetry among the homogeneous form of a curve and the dual one. The formLis dual toP, and vice versa. So dual to dual ofPorLshould be equivalent to the original form. The following theorem states this fact precisely.Theorem 1Suppose thatr:[α,β]→R3is a smooth parametric curve such thatr′,r″are linearly independent and the corresponding torsion τ doesnʼt vanish on the domain interval. LetQ1:=P,Q2:=Lbe the homogeneous and the dual representation of r and leti∈{1,2}be fixed. If the representationQ3−iis determined by(9)Q3−i=Qi∧Qi′∧Qi″,then(10)Q3−i∧Q3−i′∧Q3−i″=det(Qi,Qi′,Qi″,Qi(3))2Qi.ProofSince by (7),Qi∼Q3−i∧Q3−i′∧Q3−i″, there exists a smooth functionζ≠0such thatζQi=Q3−i∧Q3−i′∧Q3−i″. If we apply the scalar product⋅Q3−i(3)on both sides of the equation, we obtain, with the help of (6),(11)ζ=−det(Q3−i,Q3−i′,Q3−i″,Q3−i(3))Qi(3)⋅Q3−i=det(Q3−i,Q3−i′,Q3−i″,Q3−i(3))det(Qi,Qi′,Qi″,Qi(3)).The relations (6) give also(Q3−i,Q3−i′,Q3−i″,Q3−i(3))T(Qi,Qi′,Qi″,Qi(3))=(000Q3−i⋅Qi(3)00Q3−i′⋅Qi″Q3−i′⋅Qi(3)0−Q3−i′⋅Qi″Q3−i″⋅Qi″Q3−i″⋅Qi(3)−Q3−i⋅Qi(3)Q3−i(3)⋅Qi′Q3−i(3)⋅Qi″Q3−i(3)⋅Qi(3)).From here and (6) we obtaindet(Q3−i,Q3−i′,Q3−i″,Q3−i(3))det(Qi,Qi′,Qi″,Qi(3))=(Q3−i⋅Qi(3))2(Q3−i′⋅Qi″)2=det(Qi,Qi′,Qi″,Qi(3))4,what together with (11) concludes the proof.  □Suppose now that the curverthat satisfies the assumptions of Theorem 1 is a rational one,r=1qp=1q(p1,p2,p3)T.The polynomialsq,p1,p2,p3are assumed to be relatively prime, and degree of the curve is the highest degree of the polynomials involved. Quite clearly, the degree should be at least 3 since otherwise the torsion ofrwould vanish. The homogeneous representation of a rational curve is naturally a polynomial one,P=(q;p), and the degree ofPequals to the degree ofr. For the dual representation we take (9) withi=0,L=P∧P′∧P″, what by (10) implies(12)L∧L′∧L″=det(P,P′,P″,P(3))2P.If the components ofLare not relatively prime, we may divideLby the greatest common polynomial divisor to obtain relatively prime components. This simplifies the polynomial dual representation as much as possible. Except for the cubic case, degrees ofPandLwill be different in general. The following definition makes a distinction between degree of the curve and degree of its dual form.Definition 1Rational curves with relatively prime polynomial dual formLof degree m are called class m curves.Let us reveal the relation between degrees of the curve representations. But first, we need the following theorem.Theorem 2Letp:R→Rdbe a polynomial vector field of degree n, and let0⩽r<d,r⩽n. Any(r+1)×(r+1)minor of the matrixP=(p(j))j=0ris a polynomial of degree⩽(r+1)(n−r).Polynomial vector field can be expressed asp=A(ti)i=0nwhereA∈Rd×(n+1)is a matrix of its coefficients. ThenP=AM, where the matrix that does not depend on the polynomial field coefficients readsM=((ti)(j))i=0;j=0n;r. So it is enough to consider the minors of M only. For this purpose, let us introduce polynomials(13)πj(t):=(n−r)!(n−j)!∏k=0r−j−1(n−j−k−t),j=0,1,…,r.Since the polynomialπjis of degreer−j, it can be written in the Newton form asπj(t)=∑k=0r−j[0,1,…,k]πj∏ℓ=0k−1(t−ℓ).With divided differences, involved in this polynomial representations, we build a lower triangular matrixC=(cij)i=0,j=0r,r∈Rr+1,r+1,cij:={ti−j[0,1,…,i−j]πj,i⩾j,0,i<j.SincedetC=∏j=0rcjj=∏j=0rπj(0)=1, the minors of M are equal to the minors of the productMC=(m˜i,j)i=0,j=0n,r. Note thatm˜ij=0fori<j, and(i−j)!i!tj−im˜ij=∑k=jmin{i,r}((i−j)!i!tj−i)(i!(i−k)!ti−k)(tk−j[0,1,…,k−j]πj)=∑k=jmin{i,r}(i−j)!(i−k)![0,1,…,k−j]πj=πj(i−j),i⩾j.From (13) it follows now thatm˜ij=0,i=n−r+j+1,n−r+j+2,…,n,j=0,1,…,r−1.All the nonzero elements ofM˜are thus of degree⩽n−rand the conclusion follows.  □Letn=degP,m=degLandL=P∧P′∧P″. Theorem 2, applied toLshows thatm⩽3(n−2). Further, it revealsdeg(det(P,P′,P″,P(3)))⩽4(n−3), and if the equality is reached, then (12) impliesm=3(n−2)since3(m−2)⩾deg(L∧L′∧L″)=2(4(n−3))+n=3(3(n−2)−2).Similarly, ifm˜=degL, andn˜=degP,P=L∧L′∧L″the bound readsn˜⩽3(m˜−2)where the equality holds ifdeg(det(L,L′,L″,L(3)))=4(m˜−3). This observation simply says that a switch from a known dual representationLto a closed form representationPmight significantly increase complexity of the curve representation. If one is forced to start with the dual representation as it is the case with PH curves, low class curves will be the first to consider. However, point evaluation is a basic task one encounters, but it can be done efficiently from the dual form too. A Bézier dual representation that has been introduced in Pottmann (1994), allows one to do the computations in an efficient and stable way by applying the de Casteljau algorithm to dual coordinates.Let us turn our attention to rational PH curves. The PH conditions are satisfied if one starts with a rational unit length tangentt=1ρh, wherehis a polynomial curve, andρ=‖h‖is its polynomial norm. Then a rational PH curve can be constructed by choosing any rational function ψ such that(14)r=∫ψhis a rational curve too. But, the possible candidates for ψ are hard to be determined, especially ifhdepends on some unknown coefficients. More or less, all reduces to a question, when the integral of a rational function is rational too. Fortunately, this problem can be avoided by using the dual construction. A dual form of a curve (14) is by (4) equivalent to(15)L∼(−det(∫ψh,h,h′);h×h′),wheredet(∫ψh,h,h′)is of the formfgwith f and g being two relatively prime polynomials. If instead of ψ one chooses f and g, a dual formL=(−f;gh×h′)defines a rational PH curve and the corresponding rational function ψ is given in the following theorem.Theorem 3Suppose thath:R→R3is a polynomial curve such thath,h′,h″are linearly independent, and its norm‖h‖is polynomial too. Letv:=h×h′, and let f, g be relatively prime polynomials. The dual form(16)L=(−f;gv)determines a rational PH curve r with the denominator(17)g3det(v,v′,v″)=g3det(h,h′,h″)2and the hodographr′=ψh, where(18)ψ=(fgdet(h,h″,h‴)det(h,h′,h″)2+((fg)′1det(h,h′,h″))′)′+fgdet(h′,h″,h‴)det(h,h′,h″)2.Moreover, the curve r reduces to a polynomial PH curve iff g is constant and f is chosen as(19)f=det(∫ψ˜h,h,h′),for some arbitrary polynomialψ˜.Using the cross product identity(a×b)×(a×c)=det(a,b,c)a,a,b,c∈R3,one obtains(20)v×v′=(h×h′)×(h×h″)=det(h,h′,h″)h.Furthermore,(21)det(v,v′,v″)=(v×v′)⋅(h′×h″+h×h‴)=det(h,h′,h″)2anddet(gv,(gv)′,(gv)″)=g3det(v,v′,v″)=g3det(h,h′,h″)2,which confirms (17). In order to prove the hodograph assertion and (18), letLbe the curve dual form (16), and letL˜:=1gL=(−fg;h×h′). Then equivalent homogeneous representations of the rational curverare derived asL∧L′∧L″∼L˜∧L˜′∧L˜″=:R=:(R0,R1,R2,R3)T∼1R0R=:R˜=(1;r),and the derivativeR˜′readsR˜′=(0;r′)=1R0R′−R0′R02R=L˜∧L˜′∧(1R0L˜″)′,whereR0=det(h,h′,h″)2by (21). Further, we observe from (6)R˜′⋅L=0=r′⋅(h×h′),R˜′⋅L′=0=r′⋅(h×h′)′=r′⋅(h×h″).This shows thatr′is orthogonal tovandv′. By (20) we conclude thatr′=ψhfor some function ψ. Applying a linear functionaldet(⋅,h′,h″)on both sides of this equation givesψ=det(r′,h′,h″)det(h,h′,h″).The proof of (18) is completed by a straightforward evaluation of the determinant(h′×h″)⋅r′=(0;h′×h″)⋅R˜′=(0;h′×h″)⋅(L˜∧L˜′∧(1R0L˜″)′).It remains to prove when the curverreduces to a polynomial one. Suppose first that g is constant and f is of the form (19) for some polynomialψ˜. Thenf′=∫ψ˜h⋅v′,f″=∫ψ˜h⋅v″and the wedge product evaluates toP=L∧L′∧L″=(det(v,v′,v″);det(v,v′,v″)∫ψ˜h)∼(1;∫ψ˜h)which confirms thatris a polynomial curve. The proof in the other direction follows directly from (15) and the accompanying discussion.  □A rational unit vector field can be constructed by using the stereographic projection, which defines a bi-rational correspondence between points in the plane and points on the unit sphere inR3(see Farouki and Šír, 2011). The other standard way is the quaternion approach, which will be used in this paper.Space of quaternionsHis a 4-dimensional vector space with a standard basis{1,i,j,k}. Quaternions can be written asA=(a,a)where the first component is called a scalar part, and the remaining three components form a vector part of the quaternion. A quaternion with a zero scalar part is called a pure quaternion, and such quaternions are identified with vectors inR3, i.e.,A≡aforA=(0,a). The quaternion sum and product are defined asA+B=(a+b,a+b),AB=(ab−a⋅b,ab+ba+a×b),whereB:=(b,b). Equipped with these two operationsHbecomes an algebra.To construct a rational unit vector field of tangents we start by a quaternion polynomialA∈H[t], which components are relatively prime. With quaternion polynomialAwe associate the orthonormal Euler–Rodrigues frame(ei)i=13, defined by(22)e1:=1‖A‖2AiA⁎,e2:=1‖A‖2AjA⁎,e3:=1‖A‖2AkA⁎,whereA⁎=(a,−a)denotes the conjugate ofA, and‖A‖=AA⁎the norm. Note that the multiplication in (22) yields pure quaternions which are then considered as vectors. A vector fieldωthat satisfiesei′=ω×eidetermines the rotation axis of the frame. If we express it in the E–R moving frame,ω=ω1e1+ω2e2+ω3e3, the relationej⋅ei′=ej⋅(ω×ei)=det(ej,ω,ei)gives the coefficients(23)ω1=e3⋅e2′=−e2⋅e3′,ω2=e1⋅e3′=−e3⋅e1′,ω3=e2⋅e1′=−e1⋅e2′,and the frame speed(ei′)i=13follows from(24)e1′=ω3e2−ω2e3,e2′=−ω3e1+ω1e3,e3′=ω2e1−ω1e2.The polynomial elements needed in Theorem 3 are introduced by(25)ρ:=‖A‖2,hi:=ρei,i=1,2,3,h:=h1.Since the components ofAare relatively prime, one hasρ>0(Farouki, 2008, p. 483). Moreover, the vector fieldv=h×h′of Theorem 3 can be expressed as(26)v=ν2h2+ν3h3,ν:=(νi)i=13:=ρ(ωi)i=13,whereνiis the numerator ofωi. Given f in g, the procedure outlined generates the corresponding dual formL=(−f;gv)fromAby (22), (23), (25), and (26) completely.As an example, let us apply Theorem 3 to a curve generated by the quadratic quaternion polynomialA(t)=(1,(0,0,0)T)+(0,(1,0,1)T)t+(0,(1,−1,1)T)t2.The components ofAare1,t(t+1),−t2,t(t+1), thus relatively prime. One obtainsh=(1−t42(1−t2)t(t+1)2(t2+(t2+t)2)),v=(4t2(t4+6t3+7t2+4t+2)−4t(t5+2t4+2t2+3t+2)2(t+1)2(−t4+4(t−1)t2+1)).The dual form (16) is of degree 6 provided g is constant anddeg(f)⩽6. The choiceg(t)=1andf(t)=1+t3−t6determines class 6 rational PH curverof degree 12 with a hodographr′=ψhwhereψ(t)=38(2t6+3t5−12t3−9t2−3t−1)3(22t12+42t11+6t10+559t9+1152t8+1035t7+423t6+81t5+189t4+547t3+363t2+96t+5).Singular points ofrare determined by ψ only. The derivativer′vanishes at zeroes of ψ:t=−3.13475,t=−0.0676759,t=±∞, and it is unbounded att=−0.59708,t=1.70123.Degree of a dual PH curve representation (16) depends on degrees ofA, f and g. Degree of quaternion polynomial affects it most. Namely, if degree ofAis equal to k, it is easy to verify that(27)deg(νi)⩽2k−2,deg(hi)⩽2k,i=1,2,3.Theorem 2 implies thendeg(v)⩽4k−2. If the components ofvare relatively prime and the equality holds, class m equals tom=max{4k−2+deg(g),deg(f)}.So a quest for low class rational PH curves must start withk=1, and g of a low degree. Further, a quadraticAyields curves of class ⩾6, and cubic one results in class ⩾10 provided the components ofvare relatively prime. But if they are not, the class could be quite clearly reduced by a proper choice of f. Suppose thatv=ϑvR=ϑ(vR,1,vR,2,vR,3)Tfor some nonconstant polynomial ϑ. Then for any f which is divisible by ϑ class m reduces bydeg(ϑ). Relations between quaternion polynomialAcoefficients that give rise to a common polynomial factor ϑ invare rather complicated. The next lemma reveals some necessary ones. The notationp|qwill be used to denote that a polynomial p divides a polynomial q.Lemma 1Suppose thatv=ϑvR. Then ϑ must satisfy(28)ϑ|(ν2ρ2),ϑ|(ν3ρ2).Moreover,(29)ϑ2|λ,where(30)λ:=det(h,h′,h″)=ν1(ν22+ν32)+ρ(ν2ν3′−ν3ν2′).ProofSincehi⋅hj=δi,jρ2, the assertion (28) follows from (26). The expansion (30) is computed from (23), (24), (25), and (26). From (20) we obtainv×v′=ϑ2vR×vR′=λh.The condition (29) clearly holds if the components ofhare relatively prime. To prove that it always holds we need to examine the case whenh=ϑhhR, whereϑhdenotes the greatest common factor. In this caseλ=ϑh3det(hR,hR′,hR″). This shows that any function that dividesϑhdivides also λ which implies the assertion and completes the proof.  □The next lemma shows that a multiplication ofAby a constant quaternion does not change the class of the corresponding curve or the degree of a common factor inv. It induces a rotation and the scaling of the original curve only.Lemma 2Suppose thatQ=(q0,(q1,q2,q3)T)∈H,‖Q‖>0,A∈H[t], and polynomials f, g are prescribed. Let dual formsL=(−f;gv),LQ=(−f;gvQ)be generated by the quaternion polynomialsAandAQ:=QArespectively and let r andrQbe the corresponding rational curves. ThenvQ=‖Q‖4R(Q)v,rQ=1‖Q‖4R(Q)r,whereR(Q):=1‖Q‖2(q02+q12−q22−q322(q1q2−q0q3)2(q1q3+q0q2)2(q1q2+q0q3)q02−q12+q22−q322(q2q3−q0q1)2(q1q3−q0q2)2(q2q3+q0q1)q02−q12−q22+q32)is the rotation matrix that corresponds to the quaternionQ.ProofFor any vectors∈R3a quaternion productQ(0,s)Q⁎gives a pure quaternion which is equivalent to a multiplication ofsby a rotation matrix (see e.g. Farin et al., 2002, Chapter 29), i.e.,Q(0,s)Q⁎≡‖Q‖2R(Q)s.Therefore,hQ:=AQiAQ⁎=‖Q‖2R(Q)AiA⁎=‖Q‖2R(Q)handvQ=hQ×hQ′=‖Q‖4(R(Q)h)×(R(Q)h′)=‖Q‖4R(Q)v.To prove the second assertion note that(Ms1)∧(Ms2)∧(Ms3)=detM(M−T(s1∧s2∧s3))for any nonsingular matrixM∈R4×4and anysi∈R4,i=1,2,3. If we choose M asM=(10T0‖Q‖4R(Q)), thenLQ=MLandPQ=detM(M−TP). Using (5) andM−T=(10T01‖Q‖4R(Q))concludes the proof.  □Let us examine rational PH curves generated by a linear quaternion polynomial(31)A(t)=A0+1t,A0:=(a0,0,(a1,0,a2,0,a3,0)T).The functions and the fields needed are generated by (22), (23), (25), and (26). From (27) we observedeg(νi)=0,deg(hi)⩽2,i=1,2,3,and thus (26) implies that the vector fieldvis of degree ⩽2. Further, from (30) we computeλ=−8a1,0(a2,02+a3,02), and the curve generated is well defined provideda1,0≠0anda2,02+a3,02≠0. The dual formL=(−f;gv)is of degreemax{2+deg(g),deg(f)}and class 3 curveris obtained by the choicef(t)=f0+f1t+f2t2+f3t3,g(t)=g0+g1t,g≢0.Let us reparameterize an equivalent dual formL˜:=1g3L=(−fg3;1g2v)by(32)t=φ(τ):=g1+g0τg0−g1τ.Fromtig(t)k=φ(τ)ig(φ(τ))k=1(g02+g12)k(g0τ+g1)i(g0−g1τ)k−i,0⩽i⩽k,k=2,3,we observe that the polynomialfg3∘φand the polynomial field1g2v∘φare of degree ⩽3 and ⩽2 respectively. But then, by (8), (17), and Theorem 2, the reparameterized cubic curver∘φis a polynomial one. Since a rotationRdoes not change the degree of the curve, the following observation is confirmed.Theorem 4Suppose that v is generated by a linear quaternion polynomial(31), anda1,0≠0,a2,02+a3,02≠0. Suppose that f is a cubic polynomial, and g is a linear one. Then a rational curve obtained from a dual representationL=(−f;gRv)is a reparameterized polynomial cubic PH curve.The previous section showed that we must start with at least a quadratic quaternion polynomial(33)A(t)=A0+A1t+A2t2,Ai=(a0,i,(a1,i,a2,i,a3,i)T),i=0,1,A2=1,to obtain a rational PH curve that cannot be reparameterized to a polynomial one in the casedeg(g)⩽1where the final rotation of the generated curve is left to the rotation matrixR. The functions and the fields needed are obtained by (22), (23), (25), and (26). Also, (27) givesdeg(νi)⩽2,deg(hi)⩽4,i=1,2,3. It is straightforward to compute(34)ν=(ν1ν2ν3)=−2(a1,1t2+2a1,0t+a0,1a1,0−a0,0a1,1−a2,1a3,0+a2,0a3,1a2,1t2+2a2,0t+a0,1a2,0−a0,0a2,1+a1,1a3,0−a1,0a3,1a3,1t2+2a3,0t−a1,1a2,0+a1,0a2,1+a0,1a3,0−a0,0a3,1),ρ=t4+2a0,1t3+(∑i=03ai,12+2a0,0)t2+2(∑i=03ai,0ai,1)t+∑i=03ai,02,λ=−8(a2,1a3,0−a2,0a3,1+a1,1(a2,12+a3,12))t6+⋯,and the vector field(35)v=(v1v2v3)=(−4(a2,1a3,0−a2,0a3,1+a1,1(a2,12+a3,12))t4+⋯−2a2,1t6−4(a2,0+a0,1a2,1−a1,1a3,1)t5+⋯−2a3,1t6−4(a3,0+a1,1a2,1+a0,1a3,1)t5+⋯),which is of degree 6 provideda2,12+a3,12>0. Based uponvin (35) we proceed to find additional assumptions onA(t)in (33), that generate vector fieldsvR,deg(vR)=m,m=6,5,4,3.With the assumptiong=1and the choice of the functionf=∑i=0mfitiwe obtain class m dual formL=(−f;RvR). The corresponding homogeneous formP=L∧L′∧L″is by Theorem 2 of the degreen=3(m−2)⩽12in general. Not all the parameters that determineP, i.e.,#par(P)=#par(A)+#par(R)+#par(f)=#par(A)+3+(m+1),can be considered free. Recall the transformation of a rational curve to the standard Bézier form (Farin et al., 2002). One degree of freedom is lost sincePis homogeneous and the other one disappears by the particular linear rational reparameterization and the renaming of the parameters.Classm=6curves are right at hand if we choosevR=v. The homogeneous formPis of degree 12, and it has(8+3+7)−2=16degrees of freedom. In order to obtain class <6 curves some further relations between quaternion parameters have to be imposed. If these conditions imply polynomial factorizationv=ϑvR, we write f as ϑf to make it divisible by ϑ too. This gives the final dual form asL=(−f;RvR)∼(−ϑf;ϑRvR).A straightforward approach to obtain classm=5curves is to impose conditions that result in a common linear factorϑ:=ϑ(t):=θ0+θ1tin (35), so that the reduced fieldvRequals1ϑv. The componentsv1andv2in (35) have a common linear divisor if their resultant with respect to t vanishes, and similarly forv1andv3. Both resultants have three common factors that depend on coefficientsai,j. If we pick the simplest one, we obtain the relation(36)(4a0,0−a0,12)(a2,1a3,0−a2,0a3,1)2−a1,12(a2,0a2,1+a3,0a3,1)2−2a1,0(−2a2,0a2,1−2a3,0a3,1+a0,1(a2,12+a3,12))(a2,1a3,0−a2,0a3,1)+2a1,1(a2,1a3,0−a2,0a3,1)(−2a2,02+a0,1a2,1a2,0−2a3,02+a0,1a3,0a3,1)+2a1,1a1,0(a2,0a2,1+a3,0a3,1)(a2,12+a3,12)−a1,02(a2,12+a3,12)2=0.Eq. (36) could be solved fora0,0linearly. The resulting divisor ϑ is then determined by the constantsθ0=a0,1(a2,1a3,0−a2,0a3,1)−a1,1(a2,0a2,1+a3,0a3,1)+a1,0(a2,12+a3,12)32(a2,1a3,0−a2,0a3,1)6,θ1=116(a2,1a3,0−a2,0a3,1)5.The homogeneous formPis of degree 9, and it has(7+3+6)−2=14degrees of freedom. Unfortunately, the reduced fieldvR, and consequentlyL=(−f;RvR)is unbearably complex. Observe also that the denominator of the curve obtained fromLby (17) and (30) equals(37)det(RvR,RvR′,RvR″)=det(vR,vR′,vR″)=λ2ϑ3=(λϑ2)2ϑ,where the right hand expression must by (29) be a product of polynomials. So the curve has a singular point at the parameter valuet=−θ0θ1which one may usually want to avoid. However, the reparameterization (32) withgi→θi,i=0,1, maps this singular point to infinity, and the reparameterized dual form(θ0−θ1τ)9L(−f∘φ;vR∘φ)could be simplified by a proper renaming of the free parameters. But fortunately, there is a shortcut to the curves of this form. Instead of only one condition (36), we impose two simple ones that imply both classm=5and a singular point of the curve mapped to infinity. A brief look at (35) assures that the leading terms ofvvanish under the assumptions(38)a2,1=a3,1=0.This generates class 5 curves with the standard rational form of degree 9, withvfrom (35) reduced to(39)vR=(−4(a2,02+a3,02)(a1,1t2+2a1,0t+a0,1a1,0−a0,0a1,1)−4a2,0t5+(6a1,1a3,0−10a0,1a2,0)t4+⋯−4a3,0t5−2(3a1,1a2,0+5a0,1a3,0)t4+⋯),and further(40)ν=ν(vR)=−2(a1,1t2+2a1,0t+a0,1a1,0−a0,0a1,12a2,0t+a0,1a2,0+a1,1a3,02a3,0t−a1,1a2,0+a0,1a3,0),λ=λ(vR)=−(a2,02+a3,02)(24a1,1t4+16(4a1,0+a0,1a1,1)t3+⋯).The denominator of the curve is by (17) of degree2deg(λ(vR))=2⁎4=8in general. Thus the choice (38) implicitly determines the linear rational reparameterization in such a way that one singular point is at infinity. The next theorem summarizes the results and provides a simple construction of class 5 curves.Theorem 5Suppose thatvRis generated by a quadratic quaternion(33), witha2,1=a3,1=0. Then a dual representationL=(−f;RvR)is of class 5 for any quintic polynomial f. The corresponding rational PH curve is of degree 9 in general. It has(6+3+6)−1=14degrees of freedom.As an example, takeA=(t2−t,(−t,−2,2)T),f=t3, andR=I. Then(41)h=((t−2)(t3+2t+4)4t24(t−2)t),vR=(32t28(t−2)2(t3−2)−8t(t4−t3+8)),and the homogeneous curve form equalsP=(−4096(−3t4+2t3+8)2−128t(3t8−6t6+2t5−48t4+48t3−16t2+192)512t3(3t4−t3+8)512t2(3t5−4t4+8t−24)).The hodographr′=ψhfollows from (41) andψ=3((3t5+96t−32)t3+64)32(t3(3t−2)−8)3.An obvious way to search for class 4 curves is to carry on the degree reduction ofvRfrom (39) further. However, this approach fails since it impliesa2,0=a3,0=0, and the denominator of the generated curve vanishes. This leaves two ways to obtain class 4 curves. Either one has to determine conditions such thatvRin (39) would admit a common linear factor or one has to assure a quadratic divisor of the field (35). We only consider the latter case since it will cover the first possibility too. A straightforward trial to obtain a quadratic divisor ϑ ofvin general turned out to be quite complicated. Instead, we use the sufficient condition (28) supplied by Lemma 1. Sinceρ=‖A‖2=‖h‖and a common factor ofhcannot have real roots providedAhas relatively prime components, it is clear that any polynomial that divides ρ can only be factorized to irreducible quadratic factors over the real fieldR. But then by (28) the polynomial ϑ must divide eitherν2andν3, or ρ. The second possibility brings no simplification and we consider the first one only. Note (34) and assume thata2,1≠0,a3,1≠0. Since ϑ,ν2andν3are all quadratic, conditionsϑ|ν2andϑ|ν3imply the equalityν2a3,1=ν3a2,1which simplifies to(42)a1,0a3,1=a1,1a3,0,a2,0a3,1=a2,1a3,0.With these two relations satisfied we observe that the components ofνsimplify to(43)ν=(ν1ν2ν3)=−2(a1,1t2+2a1,0t+a0,1a1,0−a0,0a1,1a2,1t2+2a2,0t+a0,1a2,0−a0,0a2,1a3,1t2+2a3,0t+a0,1a3,0−a0,0a3,1),and they satisfyν1a1,1=ν2a2,1=ν3a3,1=−2a1,1(a1,1t2+2a1,0t+a0,1a1,0−a0,0a1,1)provideda1,1≠0. So we may chooseϑ=ν1, andvin (35) factorizes asv=ν1vR. This observation paves the way to the proof of the following theorem.Theorem 6Suppose that the polynomial field v is generated by a quadratic quaternion(33), where its coefficientsA0,A1, andA2are linearly dependent anda1,1≠0,a2,12+a3,12≠0. Then v admits a common factor,v=ν1vR. The dual representationL=(−f;RvR)is of class 4 for any quartic polynomial f. The corresponding rational PH curve is of degree 6 in general. It has(6+3+5)−2=12degrees of freedom.SinceA2=1, the assumption that the quaternion coefficients are linearly dependent is equivalent to (42), and additionally(44)a1,0a2,1=a1,1a2,0which is superfluous except in the casea3,0=a3,1=0. Soνis of the form (43), and the proof of the assertion in the casea2,1≠0,a3,1≠0is completed. Ifa2,1≠0,a3,1=0, we observe from (42) thata3,0=0must hold too. But then (43) revealsν3=0andν1a1,1=ν2a2,1, and from (26) one can see thatν2dividesv. The casea2,1=0,a3,1≠0follows similarly. This concludes the proof.  □In the casea1,1=0anda2,12+a3,12≠0the conditions (42) and (44) implya1,0=0and furtherν1=0,v=ν2vR. But thendet(vR,vR′,vR″)=0and the curve is not well defined. Ifa1,1≠0anda2,12+a3,12=0then (42) and (44) implya2,0=0,a3,0=0which leads to a trivialv. The casea1,1=a2,1=a3,1=0recovers the field (39), obtained in the quintic case, but with the additional linear divisorν1. The reducedvRthen leads to a curve with the denominator equal to(2t+a0,1)3provideda0,1≠0,a0,2≠0,a0,3≠0.As an example, letf=t3,R=I. The quaternion polynomialA=(t2+2t+2,(−2t−2,−2t−2,2t+2)T)generates the curve determined by either one of the formsL=(−t316(t+1)2t4−(t+2)4),P=(2048t3(t+2)3192t4(t+2)2128t2(t+2)2(t2+2t−6)128t4(t2+6t+6)).To derive class 3 PH curves, one has to reducevfrom (35) to a cubic vector field. As with class 5 we can without loosing generality send one singular point to infinity by assuming (38), and only a quadratic reduction factor ϑ of (39) has to be decided upon. We observe from (39) and (40) that ϑ should be proportional toν1, so we chooseϑ=−12a1,1ν1=t2+2a1,0a1,1t+a0,1a1,0−a0,0a1,1a1,1.By (28), it is necessary that ϑ divides ρ. The remainder that should vanish is a linear polynomial1a1,13(a1,02−a0,1a1,1a1,0+a0,0a1,12)(4(a0,1a1,1−2a1,0)t+(a0,12+4a0,0)a1,1−4a0,1a1,0+a1,13)+a2,02+a3,02.The terma1,02−a0,1a1,1a1,0+a0,0a1,12must not vanish since obviouslya2,02+a3,02>0. This impliesa0,1a1,1−2a1,0=0, and we obtain equationsa2,02+a3,02+14(a0,12−4a0,0)(a0,12−a1,12−4a0,0)=0,a0,1a1,1−2a1,0=0,simplified toa0,1=2a1,0a1,1,a0,0=a1,02a1,12−a1,128±18a1,14−16(a2,02+a3,02).If these equations are satisfied, ϑ divides not only ρ, butvtoo. Namely, it is straightforward to evaluatevR=1ϑv, and to prove the following conclusion.Theorem 7Suppose that coefficients of the quadratic quaternion are given asA0=(a0,0,(a1,0,a2,0,a3,0)T),A1=(2a1,0a1,1,(a1,1,0,0)T),A2=1,wherea1,14⩾16(a2,02+a3,02)>0anda0,0=a1,02a1,12−a1,128±18a1,14−16(a2,02+a3,02).If f is a polynomial of degree ⩽3, then the dual formL=(−f;RvR), withvR=(vR,1,vR,2,vR,3)T, andvR,1=−4a1,1(a2,02+a3,02),vR,2=2a1,13(−2a2,0a1,13t3+(3a1,14a3,0−6a1,0a1,12a2,0)t2+6a1,13(a1,0a3,0−a0,0a2,0)t+(a1,14+5a0,0a1,12−2a1,02)a3,0a1,12+2a1,0(2a1,02−3a0,0a1,12)a2,0),vR,3=−2a1,13(2a3,0a1,13t3+(3a2,0a1,14+6a1,0a3,0a1,12)t2+6a1,13(a1,0a2,0+a0,0a3,0)t+(a1,14+5a0,0a1,12−2a1,02)a2,0a1,12+2a1,0(3a0,0a1,12−2a1,02)a3,0),determines the rational cubic PH curve with the denominator576a1,12(a2,02+a3,02)2ϑ=576(a2,02+a3,02)2(a1,12t2+2a1,1a1,0t+2a1,02−a0,0a1,12).It has(4+3+4)−1=10degrees of freedom.Let us now determine the homogeneous point representation for the curve, given by Theorem 7. If we simplifyR=I, and we extract the common factor36(a2,02+a3,02)a1,13,we obtain the simplified homogeneous coordinatesP0=−16a1,13(a2,02+a3,02)(t2a1,12+2ta1,1a1,0+2a1,02−a0,0a1,12),P1=((8a1,02a1,12−4a0,0a1,14)t2+4a1,0a1,13(a1,12+2a0,0)t−4a1,04+(5a1,14+8a0,0a1,12)a1,02−a1,14(a0,0a1,12+5(a2,02+a3,02)))t,P2=4a1,13((a2,0a1,12+2a1,0a3,0)t+2a1,1(a1,0a2,0+a0,0a3,0))t,P3=4a1,13((a3,0a1,12−2a1,0a2,0)t+2a1,1(a1,0a3,0−a0,0a2,0))t.The general homogeneous form is then given as(P0;R(P1,P2,P3)T).As an example,(45)f=t3,R=I,a1,0=0,a1,1=3,a2,0=2,a3,0=1,a0,0=−54,−1,generates curves (see Fig. 1)−1240(4t2+5)(5t(4t2−11),8t(12t−5),16t(3t+5))T,and−160(t2+1)(t(t2−4),2t(3t−1),t(3t+4))T.In this paper we carry the construction of spatial rational PH curves from Pottmann (1994) and Farouki and Šír (2011) a step further, based upon the dual curve representation mainly. Using quadratic quaternion polynomials, curves of classm=3,4,5,6having2m+4parameters of freedom are derived. There are many questions left concerning spatial rational PH curves. Of course, one has to state and analyse interpolation schemes suited for this purpose. Analysis of singular points and potential alternative ways how to present rational PH curves might also be two interesting issues. But perhaps the most valuable would be the answer to the question, where and when rational PH curves do better than their polynomial counterpart.

@&#CONCLUSIONS@&#
