@&#MAIN-TITLE@&#
A bi-level evolutionary optimization approach for integrated production and transportation scheduling

@&#HIGHLIGHTS@&#
The integrated scheduling problem is formulated as a bi-level mixed-integer nonlinear program.Consider unrelated parallel-machine environment and product batch-based delivery.An evolution-strategy-based bi-level evolutionary approach is developed.The proposed approach is superior to other 3 intelligent algorithms-based approaches.

@&#KEYPHRASES@&#
Supply chain scheduling,Production and distribution,Bi-level programming,Bi-level evolutionary algorithm,

@&#ABSTRACT@&#
This paper investigates an integrated production and transportation scheduling (IPTS) problem which is formulated as a bi-level mixed integer nonlinear program. This problem considers distinct realistic features widely existing in make-to-order supply chains, namely unrelated parallel-machine production environment and product batch-based delivery. An evolution-strategy-based bi-level evolutionary optimization approach is developed to handle the IPTS problem by integrating a memetic algorithm and heuristic rules. The efficiency and effectiveness of the proposed approach is evaluated by numerical experiments based on industrial data and industrial-size problems. Experimental results demonstrate that the proposed approach can effectively solve the problem investigated.

@&#INTRODUCTION@&#
Promoting the efficiency of handling production and transportation operations is one of main measures to improve the supply chain performance. In some supply chains, the delivery of time-intensive products must be completed within a very limited time after their production. Their production and transportation operations thus must be highly integrated to promote the supply chain performance and reduce the total operating cost [1–3].This study was motivated by a common and important decision-making problem arising from the integrated production and transportation scheduling (IPTS) practice existing widely in time-intensive and labor-intensive make-to-order (MTO) supply chains in China. The plant receives production orders from different customers. Each customer places a group of orders (called as an order group) at a time. Each order needs to be assigned to an appropriate shop floor in the plant for production. Its production time in a shop floor depends on its order size, its product complexity and the shop floor's production efficiency. This production environment is equivalent to an unrelated parallel-machine environment if we consider each shop floor as a machine and each order as a job. The products of each order group are also classified into multiple product batches, each of which corresponds to a customer destination and a desired delivery date. Each product batch involves a certain number of products from one or more orders. Products of each order are usually included in multiple product batches. In practice, the products of each product batch need to be transported together to a distribution center by an appropriate transportation mode according to its desired delivery date after its order group's production is completed in the plant. This is called as the product batch-based delivery. Multiple transportation modes with different carrying capacities and transportation times are available. An important decision-making problem behind these operations is the IPTS problem, which investigates how to assign production orders to shops and how to transport finished product batches to the distribution center in an integrated manner. This research focuses on investigating an IPTS problem with some realistic features in the aforementioned supply chain context, which has not been investigated so far.This IPTS problem can be considered as a bi-level optimization problem involving an order assignment sub-problem and a transportation sub-problem. In the outer (upper) level, the order assignment sub-problem is to determine which shop floor each order should be assigned to and when each order's production should start. In the inner (lower) level, the transportation sub-problem is to determine when the products of each product batch should leave the plant, which transportation mode and how many vehicles should be used for each product batch. The two sub-problems are dealt with in an integrated and nested manner. The goal of this research is to propose a bi-level evolutionary optimization approach that generates effective solutions to this problem.Research on supply chain optimization and IPTS problems has received significant attention from researchers and a number of papers have been published in recent 10 years [1–12]. Chen [1] made a comprehensive review on previous IPTS studies in 2010. Ullrich [9] addressed an IPTS problem that considered job-dependent processing times in an identical parallel-machine environment. Viergutz and Knust [3] investigated an IPTS problem in an MTO manufacturing supply chain with multiple customers and a single plant for producing short lifespan products, which aimed to determine the optimal set of customers to be supplied so as to maximize the total satisfied demand. A brief overview of related IPTS studies is shown in Table 1, in which IP, DP, MIP and MINLP represent integer program, dynamic program and mixed-integer program, mixed-integer nonlinear program (MINLP) respectively.In the literature, the IPTS problems were usually formulated as single-level (ordinary) mathematical programming problems, and solved by mathematical programming or heuristic techniques [1,4,7,11–15]. For optimization problems with complex nonlinear and mix-integer constraints and large solution spaces, mathematical programming and heuristic techniques have difficulties in finding optimal or near-optimal solutions within a reasonable time [16,17]. It is well-known that evolutionary optimization algorithms, such as genetic algorithm (GA) [18], evolution strategy (ES) [19] and memetic algorithm (MA) [20], have been successfully applied in solving various complex scheduling and optimization problems [21–29]. However, there are only very few studies adopting evolutionary optimization techniques to find solutions to the IPTS problems. Geismar et al. [2] handled an IPTS problem by utilizing either a genetic or a memetic algorithm to generate a locally optimal permutation of the given set of customers. Zegordi et al. [30] developed a gendered GA that considered two different chromosomes with non-equivalent structures and used this algorithm to handle an IPTS problem in a two-stage supply chain environment with multiple suppliers and multiple transportation modes. Cakici et al. [5] utilized a multi-objective GA to solve a multi-objective IPTS problem in an MTO supply chain with single plant and multiple customers. Ullrich [9] adopted a GA-based approach to handle an IPTS problem in a parallel-machine environment with the consideration of job-dependent processing time and delivery time window. These studies demonstrated the effectiveness of evolutionary optimization techniques in solving complex IPTS problems. Moreover, a large number of studies have reported that the MA outperformed traditional evolutionary techniques (e.g., GA and ES) in solving various complex scheduling problems [2,31–33]. This research thus proposes an MA-based evolutionary optimization methodology to handle the investigated IPTS problem.The optimization problem needs to be formulated as a bi-level mathematical programming problem when one or more constraints are described by an optimization problem [34]. Li and Ierapetritou's work [34] addressed a bi-level production planning and scheduling problem, which converts the bi-level formulation into a single-level one by considering the special structure of the investigated problem. However, previous studies have not addressed the IPTS problems that are formulated as bi-level mathematical programs.The most distinct feature that differentiates our problem from previous work is the use of bi-level programming model on the problem under investigation. The model is further complicated by several realistic problem features, such as unrelated parallel machines, product batch-based delivery and multiple transportation modes. However, the majority of previous studies focused on IPTS problems with consideration of the manufacturing environment characterized by single machine or identical parallel machines [2,5,6,8,9,36,37], and by the single transportation mode (homogeneous vehicles) [2,3,5–7,36]. No research has investigated the IPTS problem with the features of unrelated parallel machines, product batch-based delivery and multiple transportation modes so far. These distinct features make the resulting IPTS problem challenging and interesting. It is hard to convert its bi-level programming model into a single-level program. Therefore, a bi-level optimization approach needs be utilized to solve the investigated problem.An MA-based bi-level evolutionary optimization (BLEO) approach will be developed to solve the investigated problem, which is one of the main contributions of this paper. Another contribution of this paper is to establish the mathematical model of the IPTS problem with distinct realistic features, which is formulated as a bi-level MINLP. The rest of this paper is organized as follows. It begins with problem description and formulation in Section 2. Section 3 describes how to simplify the transportation sub-problem. Section 4 presents the BLEO approach for the investigated IPTS problem. Numerical experiments designed to validate the effectiveness of the proposed methodology and discussions on experimental results are presented in Sections 5 and 6. The paper ends with concluding remarks and suggestions for future study in Section 7.In some labor-intensive MTO manufacturing environments such as apparel and footwear, time-intensive products are produced. The plant receives various order groups from different customers. An order group, denoted by h, is a group of orders from a customer. Each order needs to produce a specified number of identical products. Different orders may have different product complexities due to different product features. Let (h,j) denote the jth production order of order group h. The production workload Whjof order (h,j) is equivalent to the number of standard products with the same workload. A standard product is a selected common product in the plant, which has a certain standard processing time and a certain volume.The orders of each order group are assigned to I shop floors of the plant for production. Shop floor i produces different orders in turn and consecutively. The orders from the same order group must be produced consecutively in each assigned shop floor. The daily production capacities θiof floor i indicate the maximal number of standard products that can be completed per day in this shop floor. The production capacities of different shop floors can be different. The efficiency percentages rhjiof different shop floors can be different for production order (h,j). In shop floor i, the higher the product complexity of order (h,j) is, the smaller the value of rhji. The finished products are transported to a distribution center first according to pre-specified desired delivery dates before they are finally shipped to different customer destinations. The holding cost Rhkis incurred if the finished product batch (h,k) is stored temporarily in the plant's warehouse before it is transported.The products of each group are classified into multiple product batches by the customer, each of which corresponds to a customer destination and involves a certain number of products from one or more orders. In order group h, the product combination to customer destination k is called as product batch (h,k). The products of each product batch have the same desired delivery date and should be transported together. Different product batches may have different desired delivery dates in the distribution center, in which early arrival and late arrival of product batch (h,k) incur earliness penalty Ehkand tardiness penalty cost Thkrespectively.The vehicles from the third-party logistics company are used to transport the finished product batches to the distribution center. There are M transportation modes available. Each transportation mode corresponds to a certain set of transportation cost, transportation time and carrying capacity (standard product quantity). Different transportation modes can correspond to different sets. Product batch (h,k) can be transported by multiple vehicles of different transportation modes while multiple product batches can also be transported by one vehicle based on different product quantities and transportation modes. The vehicles can come to the plant and pick up product batches ready for delivery at a fixed time per day.The goal of investigating the IPTS problem is to minimize the summation of production and transportation-related costs of all customer orders while reducing the number of tardy product batches as many as possible through constructing order assignment and transportation schedule solutions. Related decision variables include (1) the assignment Xhjiof order (h,j) to an appropriate shop floor, (2) the production beginning time Bhiof order group h in shop floor i, (3) the pick-up date Shkof product batch (h,k), (4) the transportation mode Mhkmto deliver the finished product batch (h,k), to the distribution center, and (5) the number Ehkmof corresponding vehicles to deliver product batch (h,k).Several reasonable assumptions are made in the formulation of mathematical model, which include (1) the production period starts from time zero and the production plant is empty initially; (2) there are no materials shortage, interruption and preemptions in production; and (3) each transportation mode contains sufficient vehicles to perform transportation tasks requested.In the development of the mathematical model of the IPTS problem, we make use of the following notation.Indicesadate, a∈{1, 2, …, A}horder group, h∈{1, 2, …, H}(h,j)jth production order of order group h, j∈{1, 2, …, Jh}(h,k)kth product batch of order group h, k∈{1, 2, …, Kh}ishop floor, i∈{1, 2, …, I}mtransportation mode, m∈{1, 2, …, M}Parameterscmcarrying capacity (unit: standard product quantity) of one vehicle via mode mdhkdesired delivery date (unit: day) of product batch (h,k)ehkdaily earliness penalty rate of product batch (h,k)lilabor cost of producing one standard product (standard unit labor cost) in floor iqhjactual product quantity (order size) of order (h,j)rhjiefficiency percentage of shop floor i producing order (h,j)thkdaily tardiness penalty rate of product batch (h,k)umtransportation rate of one vehicle via transportation mode mvmtransportation time (unit: days) from the plant to distribution center via transportation mode mθidaily production capacity (unit: standard product quantity) of shop floor iφhkproduct quantity of product batch (h,k)ζaverage daily holding rate of each product at the plantη0standard processing time (SPT) of a standard productηhjSPT of a product of order (h,j)λhkaverage volume ratio of a product of product batch (h,k) to a standard productIntermediate variablesChproduction completion date of order group hChiproduction completion time (unit: days) of order group h in shop floor iDhkactual delivery date of product batch (h,k)Ehkearliness penalty (cost) of product batch (h,k)Ghh′1 if order group h is the immediate predecessor of order group h′; otherwise it is 0Lhjproduction labor cost of order (h,j)Nhk1 if product batch (h,k) is tardy; otherwise it is 0Phjprocessing time (unit: days) of order (h,j)Qhiprocessing time (unit: days) of order group h in shop floor iRhkholding cost of product batch (h,k)Shkpick-up date of product batch (h,k)Thktardiness penalty (cost) of product batch (h,k)Uatransportation cost at the ath dayVhktransportation time (days) of product batch (h,k)Whjproduction workload (unit: standard product quantity) of order (h,j).Decision variablesBhiproduction beginning date of order group h in shop floor iMhkm1 if the products of product batch (h,k) are transported via transportation mode m; otherwise it is equal to 0Xhji1 if order (h,j) is assigned to shop floor i; otherwise it is equal to 0Yhkmnumber of vehicles to deliver products of product batch (h,k) via transportation mode mZhka1 if the products of product batch (h,k) are picked up at the ath day; otherwise it is 0.The mathematical model of the investigated IPTS problem is formulated as follows:Minimize(1)F1(Xhji,Bhi,Zhka,Mhkm,Yhkm)=∑h=1H∑k=1Kh(Nhk)(2)F2(Xhji,Bhi,Zhka,Mhkm,Yhkm)=∑h=1H∑j=1JhLhj+∑a=1AUa+∑h=1H∑k=1Kh(Rhk+Ehk+Thk)(3)=∑h=1H∑j=1Jh∑i=1I(Whj⋅li⋅Xhji)+∑a=1A∑m=1M∑h=1H∑k=1Kh(Zhka⋅Yhkm)⋅um+∑h=1H∑k=1Kh((Shk−Ch)⋅ζ⋅φhk)+∑h=1H∑k=1Kh(max(dhk−Dhk,0)⋅ehk+max(Dhk−dhk,0)⋅thk)Subject to(4)∑i=1IXhji=1,∀j,h(5)Phj=∑i=1IXhji⋅Whjθi⋅rhji,∀j,h(6)Whj=ηhjη0⋅qhj,∀j,h(7)Qhi=∑j=1Jh(Xhji⋅Phj),∀h,i(8)Chi=Bhi+Qhi,∀h,i(9)Ch=maxi(Chi),∀h(10)Bh′i⋅Ghh′=Chi⋅Ghh′,∀h,h′,i(11)∑h=0,h≠h'HGhh′=1,h′=1,…,H(12)∑h'=1,h≠h'H+1Ghh′=1,h=1,…,H(13)Ch≤Shk,∀k,h(14)Shk=∑a=1A(Zhka⋅a),∀k,h(15)∑a=1A(Zhka)=1,∀k,h(16)∑m=1MMhkm≥1,∀k,h(17)maxm(Mhkm⋅vm)=∑m=1M(Mhkm⋅vm)/∑m=1MMhkm,∀k,h(18)∑m=1M(Yhkm⋅cm)=φhk⋅λhk,∀k,h(19)Mhkm=1Yhkm>00otherwise,∀k,h,m(20)Dhk=Shk+Vhk,∀k,h(21)Vhk=maxm(Mhkm⋅vm),∀k,h(22)Nhk=1Dhk−dhk>00otherwise,∀k,h(23)Xhji,Zhka,Mhkm∈{0,1},∀i,j,k,h,d,m(24)Bhj,Yhkm∈ℝ0+,∀j,k,h,m(25)Ch,Dhk,Shk∈ℤ+,∀k,hObjective function 1 in (1) indicates the total number of tardy product batches while the objective function in (2) represents the sum of labor costs, holding costs, transport costs and tardiness costs of all customer orders. Objective 1 has the higher preference than objective 2 does. That is, the number of tardy product batches is minimized first. Constraint (4) guarantees that each production order in an order group must and can only be assigned to one shop floor. Constraints (5) and (6) calculate the processing time of order (h,j). Constraints (7) and (8) calculate the processing time Qhiand completion time Chiof order group h in shop floor i respectively. Constraint (9) calculates the production completion time Chof order group h. Constraint (10) indicates order group h′ must begin immediately in each shop floor once its immediate predecessor h is completed. Constraints (11) and (12) stipulate that each order group must be processed in turn. Order groups 0 and H+1 are two virtual order groups. Order group 0 must be produced first and its completion time C0iis 0 in shop floor i. Order group H+1 is the end order group that is produced last in shop floor i. Constraints (13) and (14) stipulate that product batch (h,k) is picked up and transported after the production of order group h is completed. Constraint (15) guarantees that each product batch is only picked up once. Constraints (16)–(19) ensure that product batch (h,k) must and can only be transported via one or more transportation modes with a same transportation time. Constraints (20) and (21) are designed to calculate the actual delivery date Dhkof product batch (h,k). Constraint (22) calculates the value of Nhk. Constraints (23)–(25) indicate the non-negativity and binary restrictions on the 5 decision variables and 3 intermediate variables.As mentioned in Section 1, this problem is a bi-level optimization problem, in which an order assignment sub-problem and a transportation sub-problem are dealt with in an integrated and nested manner. The transportation sub-problem is in the inner level since its solutions (the values of Zhka, Mhkmand Yhkm) are dependent on the solutions of the order assignment sub-problem (the values of Xhjiand Bhi) in optimum-seeking process. The bi-level optimization structure makes the investigated problem challenging, which demands immense computational resources to solve the problem effectively.The IPTS problem formulated above is a bi-level MINLP since (1) it is hard to convert this program into a single-level (ordinary) optimization program, and (2) the problem is characterized by binary and real decision variables as well as nonlinear constraints (e.g., constraints (9), (10) and (17)). The difficulties of developing efficient algorithms for the bi-level programming problem have been demonstrated widely [38–41]. It is well known that even the simplest instance of bi-level programming problem, linear bi-level programming with pure linear objectives and constraints, is NP-hard [39,40]. The mixed-integer and nonlinear nature of this IPTS problem further increases the problem complexity and makes the problem too hard to tackle. It is extremely hard for classical mathematical programming techniques to solve this problem effectively. A bi-level evolutionary optimization approach is thus developed to solve this challenging problem.To solve this IPTS problem, this research firstly simplifies the problem by transforming its transportation sub-problem (transportation problem I) into a simpler transportation sub-problem (transportation problem II) so that its computational complexity can be reduced.Consider the transportation sub-problem. At each pick-up day, one or more product batches need to be transported to the distribution center. The transportation sub-problem needs to determine the values of Mhkmand Vhkm(transportation problem I), i.e., to determine which vehicles are used to transport the product batches at this day. Once the pick-up date of a product batch is determined, the transportation time for this product batches can be determined, according to the procedures described in Section 4.3.3. We group the product batches to be delivered at a pick-up day by transportation time. The product batches with a same transportation time are combined into a same group, which are transported together by one or more vehicles of the same transportation time. We define a vehicle combination to represent a group of vehicles with a same transportation time. These vehicles may be from different transportation modes. Let (v,b) denote the bth vehicle combination of transportation time v (v∈[1,V],b∈[1,βv]). Vehicle combination (v,b) can be represented by a sequence of elements whose length equals the number of transportation modes with transportation time v. Each element represents a transportation mode and its value indicates the number of vehicles assigned in the corresponding transportation mode. For example, the combination [3201] represents a combination comprising 3 vehicles of transportation mode 1, 2 vehicles of mode 2 and 1 vehicle of mode 4. At a pick-up day, to determine the values of Mhkmand Vhkmis actually equivalent to determine the optimal vehicle combination (v,b) for each group of product batches with the same transportation time. The 3-variable transportation sub-problem (transportation sub-problem I) is thus transformed to a 2-variable transportation sub-problem (transportation sub-problem II), which determines the optimal pick-up date and the optimal vehicle combinations, and is formulated in Section 3.2. The two transportation sub-problems are equivalent. The procedures of determining the optimal vehicle combination will be introduced in Section 4.3.3.Letψavbdenote the transportation load transported by vehicle combination (v,b) at the ath day.ρvb,υvbandμvbdenote the carrying capacity, the transportation time (day), and the transportation cost of vehicle combination (v,b) respectively. Letξhkvbindicate if product batch (h, k) is transported by vehicle combination(v,b). If so,ξhkvbequals 1; otherwise it equals 0. Among these notations,ξhkvbandψavbare variables while others are parameters.Given the production completion time Chof each order group, the transportation sub-problem aims to minimize the objective function (1) by determining the optimal Zhka(equivalent to pick-up date Shk) of product batch (h, k) and its optimal vehicle combinationξhkvb. The transportation sub-problem II is formulated as follows, which uses objective function F3 to replace the relative terms in objective function F2.(26)MinimizeF3(Zhka,ξhkvb)=∑a=1AUa+∑h=1H∑k=1Kh(Rhk+Ehk+Thk)=∑a=1A∑v=1V∑b=1βvμvb⋅∑h=1H∑k=1Kh(Zhka⋅ξhkvb)/max∑h=1H∑k=1Kh(Zhka⋅ξhkvb),1+∑h=1H∑k=1Kh((Shk−Ch)⋅ζ⋅φhk+max(dhk−Dhk,0)⋅ehk+max(Dhk−dhk,0)⋅thk)A feasible solution of the transportation sub-problem II must satisfy constraints (13)–(15) and (20), described in Section 2.3, and constraints (27)–(31) listed below.(27)∑v=1V∑b=1βvξhkvb=1,∀h,k(28)ψavb=∑h=1H∑k=1Kh(φhk⋅λhk⋅Zhka⋅ξhkvb),∀h,k,b(29)ψavb≤ρvb,∀a,v,b(30)Vhk=∑v=1V∑b=1βv(υvb⋅ξhkvb),∀h,k(31)Zhka,ξhkvb∈{0,1},∀h,k,a,v,bThe objective function in (26) minimizes the sum of 4 transportation-related costs. The transportation cost Uaof the ath day is different from the corresponding term in (3). At a pick-up date, it is possible that multiple vehicle combinations with different transportation times are used for reducing or avoiding the tardiness of product batches. Constraint (27) ensures that product batch (h,k) must and can only be transported via one vehicle combination. Constraints (28) and (29) calculate and limit the value ofψavb. Constraint (30) calculates the transportation time Vhkof product batch (h,k). Constraint (31) indicates the binary restrictions on Zhkaandξhkvb.Once Zhkais determined, the transportation sub-problem II only needs to determine the value of binary variableξhkvbinstead of seeking the optimal values of integer variable Mhkmand real variable Yhkm. The transportation sub-problem has been converted from a mixed-integer program (sub-problem I) to a 0–1 program (sub-problem II). The complexity and the solution space of transportation sub-problem II are much less than those of the transportation sub-problem I since less variables are used and complicated nonlinear constraints (e.g., constraints (17) and (21)) are eliminated.On the basis of the transportation sub-problem II, the IPTS problem investigated can be reformulated by using the new term Uaand constraints (23)–(27) to replace corresponding term and constraints in Section 2.3.A BLEO approach is developed to solve this IPTS problem based on the MA and ES techniques. Both MA and ES are population-based metaheuristics. The MA is composed of an evolutionary framework and a set of local search algorithms which are activated within the generation cycle of the external framework [32]. In general, an optimum-seeking flow of a traditional MA is the similar to that of GA (crossover, change random individuals, new generation). One of its major differences from GA is that the MA uses a local search process in each generation of the evolutionary process, to perform an intensive exploitation of the decision space attempting to enhance the performance by slightly modifying some design variables. Traditional MAs usually use GA to perform a broad exploration to find candidate solution located in unexplored areas of the decision space. It is well known that the main difference between traditional ES and GA is that the ES uses only mutation operation to generate the child individual, which makes the ES easier to use than GA does. However, using ES to replace GA and perform the exploration in MA has not been reported in the IPTS-related literature. Hence, this research develops the BLEO approach based on an ES-based memetic optimization process.The flowchart of the BLEO approach is shown in Fig. 1. This approach consists of an outer-level optimization process and an inner-level optimization process. The outer-level optimization process aims to seek the optimal order assignment solution Xhjiby using a (1+1)-ES-based memetic optimization (ESMO) process while the inner-level optimization aims to seek the optimal Zhkaby using a (1+1)-ES-based optimization process. Based on Xhjiand Zhka, Bhiandξhkvbcan then be derived by heuristic rules respectively.The procedures involved in the flowchart are described briefly as follows. The values of algorithm parameters used in the BLEO approach are initialized in Step 1. These parameters include the number (κ) of decision variables to be represented by a solution individual, mutation probability σ, and the maximal optimum-seeking time gmax. The initial solution individual is generated randomly in Step 2 based on the representation described in Section 4.2.1. Each individual represents a feasible assignment of orders to shop floors. Step 3 is then used to evaluate the performance of the newly generated individual based on the inner-level optimization. Since each solution individual only determines Xhji, other variables (Bhi, Zhkaandξhkvb) are to be determined in this step by three sub-steps shown in Fig. 1(b). Firstly, Bhiand Chiare calculated in sub-step 3a by using formulae (10) and (8) respectively based on the processing precedence of order groups, which is determined by the production planner based on each order group's production deadline. The order group with an earlier production deadline has a higher processing precedence. The production completion time Chof order group h can be then determined by constraint (9). Zhka,ξhkvband the objective function are calculated next in sub-step 3c by using the ES-based inner optimization process, which is described in Section 4.3. Sub-step 3b is used to check if the inner optimization process is required so that unnecessary inner optimization processes are avoided and the optimum-seeking efficiency is improved. Next, the individual is improved locally based on a tabu search-based local search technique in Step 4. Steps 5–8 constitute the iterative process of memetic optimization. Each iteration represents a generation of the outer-level optimization (ESMO) process. In step 5, a new child individual is generated. The new individual is then evaluated and locally improved in steps 6–7. The procedures in steps 6–7 are the same as the procedures in steps 3–4 respectively. After each iteration, the termination condition is checked in step 8. If a specified maximum optimum-seeking time gmax is reached, the iterative process of the ESMO process is terminated; otherwise, the iterative process returns to step 5 and the generation continues. The final individual is returned as the best solution generated by the proposed BLEO approach in step 9. Necessary steps are presented in detail in following sub-sections.This research defines the candidate solution individual OI in the ESMO process as the assignment Xhjiof each order to an appropriate shop floor. OI is a sequence of elements, OI=[OI1, OI2, …, OIi, …, OIκ], where κ is equal to the number of orders to be processed. Each element indicates an order group and the value of the element indicates the shop floor assigned to produce the corresponding order.The initial individual is generated randomly based on the solution representation described above. In each individual, each order is assigned randomly to one of the I shop floors.In the iterative process of (1+1)-ES, the child individual,OI′=[OI′1,OI′2,…,OI′i,…,OI′κ], is generated by a mutation operation. According to this mutation operation, the valueOI′iof the ith element in the child individual is obtained by the following expression:OI′i←OI′iwith probabilityσOI′jwith probability(1−σ)where σ is the mutation probability. Its value range is between 0 and 0.2.OI′jis set randomly as the one of two adjacent neighboring values ofOI′iwith an equal probability. For example, ifOI′iequals 2 and it has four possible values such as {1, 2, 3, 4},OI′ican be moved to neighboring {2} or {4} with an equal probability. IfOI′iis a boundary value, its neighborhood consists of its adjacent value and another boundary value.

@&#CONCLUSIONS@&#
This paper presented the bi-level mixed-integer non-linear programming model for an IPTS problem with the consideration of some distinct real-world features. The origin of this paper is a real-life case of a labor-intensive MTO manufacturing supply chain characterized by heterogeneous orders, heterogeneous shop floors, multiple transportation modes and product batch-based transportation. To solve this problem, we need to determine each order's assignment Xhjito shop floors, the beginning time Bhiof each order group in each shop floor in the outer level, and to determine each product batch's pick-up date Zhka, the transportation mode Mhkmand the number of vehicles used Yhkmin the inner level.The novelty of this paper includes not only the new IPTS problem with distinct realistic features, but also the novel BLEO-based methodology for the problem investigated. To reduce the computation time of optimum-seeking process, we simplified the investigated problem firstly by introducing a new binary variable (vehicle combinationξhkvbof each product batch) to replace the binary variable Mhkmand the real variable Yhkm. A novel BLEO approach was developed to tackle the investigated IPTS problem due to its NP-hard nature and high complexity. This approach used an ES-based memetic optimization process to determine Xhjiin the outer-level optimization process and used an ES-based optimization process to determine Zhkain the inner-level optimization process. Based on Xhjiand Zhka, the values of other variables are then derived by heuristic rules. In addition, two heuristic rules are proposed to avoid unnecessary running of the inner-level optimization process so that the computation time of the proposed BLEO approach can be greatly reduced.Experimental comparisons were conducted to evaluate the effectiveness of the proposed approach in terms of industrial data. The experimental results showed that the proposed approach was capable of tackling the IPTS problem effectively by providing much superior solutions to 3 other bi-level intelligent optimization approaches. The results also implied that using effective heuristic rules to guide the optimization process could improve optimum-seeking efficiency largely.The study on the IPTS problem is helpful to make more effective and efficient decisions for the integrated scheduling of production and transportation operations. The two objectives of the investigated problem aim to reduce the number of tardy jobs and the total supply chain cost, which are helpful to meet customer due dates well and to improve the customer satisfaction level as well as the overall supply chain performance. Due to the bi-level MINLP nature of the investigated problem, the proposed BLEO approach can also be used to solve other complex bi-level MINLP problems.Further research should aim to develop other bi-level optimization approaches and compare their performances in solving complex bi-level IPTS problems. More realistic features in real-life IPTS should be considered as well, which include production and transportation uncertainties as well as other optimization objectives. In addition, to reduce the optimum-seeking time, it is worthy to investigate the use of the proposed BLEO approach on graphic processing units on the basis of the method introduced by Valdez [42].