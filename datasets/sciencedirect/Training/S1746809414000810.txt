@&#MAIN-TITLE@&#
A novel heart sound activity detection framework for automated heart sound analysis

@&#HIGHLIGHTS@&#
Heart sound activity detector (HSAD) is presented based on instantaneous phase waveform of the envelope of a filtered PCG signal.Total variation filter provides better noise-reduction while preserving components of heart sounds and murmurs.Envelope extractor achieves better nonlinear peak amplification and reduces effect of magnitude of residual noise components.Boundaries of heart sounds (S1, S2, S3, S4) and murmurs are automatically determined using instantaneous phase waveform of the envelope.HSAD accurately determines the boundaries of low-amplitude heart sounds and murmurs even under low SNR conditions.

@&#KEYPHRASES@&#
Phonocardiogram,Heart sound analysis,Heart sound segmentation,Cardiac signal monitoring,Audio-visual stethoscope,

@&#ABSTRACT@&#
In automated heart sound analysis and diagnosis, a set of clinically valued parameters including sound intensity, frequency content, timing, duration, shape, systolic and diastolic intervals, the ratio of the first heart sound amplitude to second heart sound amplitude (S1/S2), and the ratio of diastolic to systolic duration (D/S) is measured from the PCG signal. The quality of the clinical feature parameters highly rely on accurate determination of boundaries of the acoustic events (heart sounds S1, S2, S3, S4 and murmurs) and the systolic/diastolic pause period in the PCG signal. Therefore, in this paper, we propose a new automated robust heart sound activity detection (HSAD) method based on the total variation filtering, Shannon entropy envelope computation, instantaneous phase based boundary determination, and boundary location adjustment. The proposed HSAD method is validated using different clean and noisy pathological and non-pathological PCG signals. Experiments on a large PCG database show that the HSAD method achieves an average sensitivity (Se) of 99.43% and positive predictivity (+P) of 93.56%. The HSAD method accurately determines boundaries of major acoustic events of the PCG signal with signal-to-noise ratio of 5dB. Unlike other existing methods, the proposed HSAD method does not use any search-back algorithms. The proposed HSAD method is a quite straightforward and thus it is suitable for real-time wireless cardiac health monitoring and electronic stethoscope devices.

@&#INTRODUCTION@&#
The phonocardiography (PCG) is a recording of the acoustic sounds and murmurs produced by mechanical events of the heart valves and associated vessels [1–3]. The audible components of heart sound are produced by acoustic vibrations of the valvular, muscular, vascular and blood circulation. The PCG signal provides vital clinical information to physicians for analyzing and diagnosing different heart abnormalities [1–11]. A normal cardiac PCG cycle comprises four major segments: the first heart sound (S1), the systolic pause segment after the sound S1 (or systolic pause period), the second heart sound (S2), and the diastolic pause segment after the sound S2 (or diastolic pause period) [2]. The other extra heart sounds like the third heart sound (S3), the fourth heart sound (S4) and the heart murmurs may be heard in systolic interval and diastolic interval segments [7]. Fig. 1shows the heart sound components (S1, S2, S3 and S4) of the PCG signal and their temporal and spectral parameters. Heart auscultation is an inexpensive and widely used medical diagnostic tool to detect heart diseases. However, an effective diagnosis of different heart sounds is highly limited by human auditory perception abilities, poor quality of hearing instruments and physician's experiences. In pathological cases, the fundamental heart sounds (S1 and S2) are buried in high-frequency murmur sounds [5–11]. Thus, physicians should have to pay special attention for analyzing such complex heart sound signals. Therefore, physicians prefer computer-aided heart sound analysis (CAHSA) system, which could help physicians to effectively interpret, listen and visualize complex heart sound signals. Heart murmurs features such as timing (temporal), duration, loudness (intensity), pitch, tonal quality and shape of murmurs are most important in characterizing abnormal murmurs in the diagnosis of heart diseases [2,10,11]. A well-designed CAHSA system can ensure a more accurate assessment and clinical diagnosis. Furthermore, it can reduce the number of unnecessary diagnostic tests and save treatment cost.The CAHSA system generally consists of three major modules: segmentation, feature extraction and classification [7,11]. For accurate classification of heart disorders, an accurate and robust heart sound activity detector (HSAD) is highly demanded for automatically determining the peaks and boundaries of heart sounds (S1, S2, S3, and S4) and the boundaries of heart murmurs, the systolic and diastolic pause segments of each cardiac cycle of the PCG signal [39]. A well-designed automated HSAD can improve diagnostic accuracy of the CAHSA system under different normal and pathological PCG signals and background noises. Furthermore, a HSAD plays an important role in many PCG signal applications such as denoising, compression, PCG based biometric, cardiac-event change detection, heart rate estimation, and wireless cardiac monitoring systems [9–12].A significant amount of research effort has been devoted for development of accurate and robust heart sound segmentation (HSS) algorithms. The HSS algorithms can be grouped into four major categories [13–26]: (i) ECG and/or carotid pulse reference based methods [2,14,36], (ii) temporal-spectral parameters based methods [13,15–17,25], (iii) time-frequency analysis based methods [18–29], and (iv) envelope based methods [18,22,30–33,35,37,39].In ECG and/or carotid pulse reference based methods, the PCG segmentation method uses electrocardiogram (ECG) signal or/and carotid pulse (CP), as reference(s) for determining locations of the first sound S1 and the second sound S2 [2]. In [14], El-Segaier et al. (2005) reported a computer-based detection algorithm based on time-instants of the R-wave and T-wave in the ECG signal. The timing reference-based segmentation method requires a simultaneous recording of the ECG or/and carotid pulse and the PCG signal. In such scenarios, the performance of the segmentation method may be degraded due to the synchronization between electrical and mechanical activities of the heart that may vary in a larger extent [15]. Moreover, determining accurate locations of R-wave and T-wave is challenging task in the case of ECG signal with low-amplitude QRS complexes, sudden changes in RR intervals, sudden changes in QRS amplitudes, sudden changes in QRS morphologies, low-amplitude T waves and various kinds of artifacts and noise [40,41]. Furthermore, these methods highly demand additional memory space and high-speed processor for processing multiple cardiac signals (ECG, PCG and carotid pulse) and thus it increases the computational cost and power consumption.In temporal-spectral parameters based methods [13,15,16], the time-domain and frequency-domain characteristics of the heart sounds, murmurs and noise are exploited for determining the boundaries of the heart sounds and systolic/diastolic period portions. In [13], Iwata et al. (1980) presented a spectral tracking based heart sound detection algorithm for automatic PCG diagnostic system. In [15], Haghighi-Mood and Torry (1995) presented an automatic heart sound segmentation based sub-band energy tracking algorithm, which utilizes an auto regressive model to estimate the power spectral density (PSD) of the signal as well as the energy in certain frequency bands for consecutive overlapping frames. In [16], Liang et al. (1998) reported an improved boundary detection algorithm for heart sound segmentation based on the spectrogram of the high-pass filtered PCG signal with cut-off frequency of 40Hz.In wavelet based PCG segmentation methods [18–29], wavelet signal decomposition is adopted for emphasizing the heart sounds and suppressing the effect of the heart murmurs and noises. In [18], Liang et al. (1997) presented a wavelet based heart sound segmentation algorithm using the db6 wavelet filters, Shannon energy envelope extraction, and the primary amplitude-threshold, interval-thresholds and secondary threshold for segmentation PCG signal. In [19], Oskiper and Watrous (2002) presented a heart sound detection based on the Morlet wavelet decomposition in combination with a time-delay neural network (TDNN). In [20], Olmez and Dokur (2003) reported a classification algorithm based on segmentation of the heart sounds S1 and S2. Here, the wavelet detail coefficients at the sixth decomposition level are used to detect the sounds S1 and S2. In [21], Wang et al. (2005) reported a method for first heart sound detection based on adaptive wavelet sub-level tracking and Shannon-energy tracking algorithms. In [22], Xinpei Wang et al. (2009) presented a S1 and S2 sound detection method using heart sound energy. The method suppresses background noises and murmurs by using 5-level decomposition with db6 wavelet filters. The segmentation is based on the normalized average three-order Shannon energy of preprocessed signal constructed from the detail subbands d3, d4, and d5. In [24], Lisha Zhong et al. (2011) reported envelope extraction algorithm based on Morlet wavelet for cardiac sound signal segmentation. In most wavelet based segmentation methods, the decomposition is performed using predefined wavelet filters and number of decomposition level. The wavelet subbands exhibits different spectral information of the PCG signal for a fixed sampling rate of the PCG signal. As compared to the digital filters based segmentation approaches, the major challenge of the wavelet-based segmentation method is the selection of wavelet filters, number decomposition level, and characteristic subbands of interests used to detect the heart sounds and murmurs. In [25], Yi-Li Tseng et al. (2012) presented a Hilbert-Huang Transform (HHT) based method to detect the presence of S3 and S4 based on maximal instantaneous frequency and its amplitude of heart sound signal. The HHT is a powerful method in the analysis of non-stationary and nonlinear signals. Although the empirical mode decomposition (EMD) of HHT can decompose heart sound signals adaptively to numbers of intrinsic mode functions (IMFs), selection of IMFs for performing a heart sound segmentation is challenging task under varying temporal-spectral characteristics of heart sounds and murmurs and background noises.In envelope-based segmentation methods [18,22,30–33,35,37,39], major acoustic events in the cardiac cycle are identified by analyzing the signal envelope of the processed PCG signal. In [30], Baranek et al. (1989) presented an iterative automatic detection algorithm based on the estimates of the PCG envelope and noise level to determine the position and duration of the acoustic events in the PCG signal. In [31], Liang et al. (1997) presented a segmentation algorithm based on heart sound envelogram (or envelope) constructed using the zero-phase eighth order Chebyshev type I low-pass filtering with cut-off frequency of 882Hz, amplitude normalization, average Shannon energy computation and decision rules. In [32], M.B. Malarvili et al. (2003) presented a heart sound segmentation based on the instantaneous energy of the ECG signal. In [33], Gill et al. (2005) presented a detection and identification of heart sounds using homomorphic envelogram and self-organizing probabilistic model. In [35], Alajarin and Merino (2005) presented a reliable method based on the envelopes of the instantaneous magnitudes and instantaneous frequency to detect the events present in the phonocardiogram. The method validates different envelope extraction approaches for detecting heart sounds. In [37], Beritelli and Serrano (2007) reported an automatic human identification method based on the energy profile of the PCG signal. In [39], M. Sabarimalai Manikandan and K. P. Soman (2010) presented a robust heart sound activity detection based on a signal envelope constructed by using normalized lag-1 autocorrelation coefficient for discriminating between the heart sounds and silent/noise segment portions.One of the most salient PCG segmentation methods is based on the signal envelope of the processed PCG signal [31,35,38,39]. In previously reported envelope-based segmentation methods [18,22,30–33,35,37,39], a candidate signal envelope of the processed PCG signal was computed by using different approaches including amplitude (or absolute), energy (or squarer), average Shannon energy, average three-order Shannon energy, instantaneous amplitude, instantaneous energy and instantaneous frequency. Amongst, the energy and Shannon energy approaches are widely used for calculating the signal envelope (or envelogram) of the processed PCG signal. The PCG envelope extraction was commonly performed in time-domain [31], Hilbert-transform domain [35] and wavelet-transform domain [18]. The advantages of the energy and Shannon energy is widely studied in PCG segmentation and QRS complex detection methods [40,41]. However, each signal envelope extraction approach has its own advantages and limitations [31]. The major limitation of the energy-based approach is that it diminishes the magnitude of low-amplitude heart sounds as compared to that of high-amplitude heart sounds. The Shannon energy accentuates the components of medium-amplitude heart sound meanwhile it reduces the effect of low-amplitude noises much more than that of high-amplitude sounds [31]. However, Shannon energy approach may not provide a sufficient amplification for medium-amplitude heart sounds including the third heart sound S3, fourth heart sound S4, and murmurs. Furthermore, the conventional envelope extraction approaches may provide a signal envelope with large peak-amplitudes and low peak-amplitudes. Due to a large peak-amplitude deviation measured between successive local peaks (or local maxima) of the signal envelope, the amplitude-threshold based segmentation method may fail to detect peaks and boundaries of the low-amplitude heart sounds in the PCG signal. Therefore, many segmentation methods use search-back algorithms with different amplitude-threshold, duration-threshold and medical rules for determining the missed heart sounds [18,20,22,31,34]. In these segmentation methods, search-back algorithms are designed to reject or include peaks and boundaries that may improve segmentation accuracy for some tested PCG signals. The decision rules may combat with other rules under noisy environments. However, finding an appropriate set of threshold values are challenging tasks under time-varying temporal-spectral characteristics of complex PCG signals. Moreover, the detection performance is poor when the energy level of heart sounds is highly dynamic and the SNR is very low. Most segmentation methods are proposed to mainly detect the first and second heart sounds or to detect the specific heart sound and heart murmur events. Therefore, the segmentation performance should be further investigated and improved under the influence of abnormal heart sounds and murmurs, irregular heart rates and background noises. The determination of boundaries and peaks of low-amplitude heart sounds and murmurs is still a challenging task in automated heart sound analysis.The objective of this paper is to develop an automated, robust heart sound activity detection (HSAD) method for automatically determining boundaries of heart sounds (S1, S2, S3, and S4) and heart murmur portions contained in normal and pathological PCG signals. It is a quite straightforward method because it does not use multiple searchback decision rules for including missing sounds and rejecting noisy sounds detected in the previous stage unlike other envelope-based segmentation methods [31,18,20,34,22]. The proposed HSAD method comprises the steps of: total variation (TV) filtering, Shannon entropy envelope extraction, analytical signal representation of the envelope, instantaneous phase waveform computation, and boundary point's determination. In the first stage, the TV filtering approach is designed to smooth out background noises and preserve the heart sounds and murmurs in the PCG signal. In the second stage, a smooth Shannon entropy envelope is computed by applying zero-phase filtering on the thresholded Shannon entropy of the samples of the filtered PCG signal. In the third stage, an instantaneous phase waveform is computed as the phase angle of an analytical signal of the smooth signal envelope. In the fourth stage, boundaries of the candidate signal envelope are determined by processing the positive slope-line corner points and the local maxima and minima between successive zerocrossing points of the instantaneous phase waveform. Finally, the candidate boundaries determined are used as the guides for determining true peaks and boundaries of the acoustic heart sounds contained in the original PCG signal.In practice, the acquired PCG signals are often corrupted by various kinds of noise and artifacts from various sources. The presence of noise and artifacts may decrease the accuracy of a PCG segmentation method. Therefore, the recorded PCG signal was first filtered to reduce the effect of high-frequency noises. Most PCG segmentation methods used a digital low-pass filter (LPF) designed with cutoff frequency of 800/750Hz and wavelet decomposition approach for removing high-frequency noises [18,22,31,34,35]. In this work, we propose a total variation filter (TVF) approach for smoothing out high-frequency noises in the input PCG signal x[n]. Assume that the x[n] be the noise contaminated version of a clean signal y[n] and then the noisy PCG signal is expressed as(1)x[n]=y[n]+w[n],n=0,1,2,3,…,N−1wherew[n]denotes the noise signal. The TV regularization algorithm finds the approximation signaly¯from the noisy signal x by solving the optimization problem [42–44]:(2)y¯=argminy12∥x−y∥22+λ∥Δ(y)∥1,where λ denotes the regularization parameter which controls the degree of smoothing and Δ(y) denotes the discrete form of differentiator. The ℓ1-norm and ℓ2-norm of the vector x are defined as∥x∥ℓ1=∑i|xi|and∥x∥ℓ2=(∑i|xi|2)1/2, respectively. The TV regularization algorithms are described in [42–44]. The noise reduction capability of the TVF approach is tested with different clean and noisy PCG signals, which include heart sounds (S1, S2, S3, and S4), split, gallop, regurgitation and stenosis sounds. For testing the effectiveness of the proposed TVF approach, the additive white Gaussian noise (AWGN) is added to the input PCG signal. For different signal-to-noise ratio (SNR) values of 20, 15, 10 and 5dB, the performance of the nonlinear TVF approach is compared with a conventional low-pass filter (LPF) approach, which is designed with cutoff frequency of 800Hz. The quality of the denoised PCG signal is evaluated by using a SNR metric [12]. In this work, the SNR metric is computed between the original (or clean) PCG signal y[n] and the denoised signal f[n]. The SNR metric is defined as the ratio of clean signal power to noise power. The SNR metric is computed as(3)SNR=10log10∑n=0N−1y2[n]∑n=0N−1(y[n]−f[n])2,where N denotes the number of samples. Higher SNR value indicates a better noise reduction whereas lower SNR value indicates a poor noise reduction performance.For visual inspection, the original PCG signal y[n], noisy signal x[n] and the denoised signal f[n] are shown in Figs. 2and 3for two different test PCG signals. Fig. 2(a) shows the original PCG signal including the first heart sound S1, second heart sound S2 and fourth heart sound S4. Fig. 2(b) shows the noisy version of the original PCG signal with SNR value of 10dB. For the noisy PCG signal shown in Fig. 2(b), the output waveforms of the LPF and TVF approaches are shown in Fig. 2(c) and (d), respectively. The error signal is computed between the original signal and the denoised PCG signal for observing local signal distortions in the denoised signal. The error signals of the LPF and TVF approaches are shown in Fig. 2(e) and (f), respectively. By observing the error signal shown in Fig. 2(e), we can notice that the LPF approach distorts the heart sounds of the PCG signal and also does not effectively suppress the noise components. The LPF approach achieves a SNR value of 18.09dB whereas the proposed TVF approach achieves a SNR of 20.12dB. For the test PCG signal with continuous murmur, the proposed LPF and TVF approaches achieve SNR values of 17.98dB and 20.28dB, respectively as shown in Fig. 3(c) and (d). By comparing the objective test results measured in SNR metric, we can observe that the proposed TVF approach significantly suppresses the noises while preserves the local sound components of the PCG signal. By referring the filtered signals shown in Figs. 2(f) and 3(f), we can notice that the proposed TVF approach provides a better noise reduction than the conventional LPF-based noise reduction approach.In this work, an appropriate regularization parameter λ is chosen based upon noise-reduction results obtained for four kinds of PCG signals including normal, low-amplitude fourth heart sound, systolic continuous murmur and diastolic mitral stenosis. For these four PCG signals with SNR values of 20, 10, and 5dB, Fig. 4shows noise-reduction results in terms of SNR obtained for different values of regularization parameter λ. For SNR values of 5dB and 10dB, the results reported in Fig. 4 shows that the SNR improvement is better for the λ value below 6. It is noted that the SNR value gradually decreases when λ value is above 6 for high-frequency heart sound signals [see Fig. 4(d)]. By considering the input PCG signals with low SNR, the regularization parameter λ is set to 6 in this study.For testing the effectiveness of the proposed TVF approach, the additive white Gaussian noise (AWGN) is added to the input PCG signal. For different signal-to-noise ratio (SNR) values of 20, 15, 10 and 5dB, the performance of the nonlinear TVF approach is compared with a conventional low-pass filter (LPF) approach, which is designed with a cutoff frequency of 800Hz. The noise reduction capability of the proposed TVF approach as compared with conventional LPF approach is illustrated in Fig. 5. The objective quality test results for the input PCG signals are shown in Fig. 5(a)–(d). For most test PCG signals, the proposed TVF approach achieves a higher SNR value as compared to that of the LPF approach. For visual inspection, the original and denoised signals f[n] are shown in Figs. 2 and 3 for two different test PCG signals including low-amplitude heart sounds S4 and continuous murmurs.In conventional segmentation methods, a candidate envelope of the processed PCG signal was extracted by using different approaches including absolute, energy, Shannon energy, three-order Shannon energy, instantaneous amplitude, instantaneous energy and instantaneous frequency [22,31,35,38,39]. Here, we first study the limitations of most commonly used envelope extraction approaches. Fig. 6shows the effectiveness of the different envelop extraction approaches. Fig. 6(a) shows an original PCG signal with large-amplitude heart sounds (S1 and S2) and low-amplitude heart sound S4. Fig. 6(b) shows the output of the absolute-based envelope extraction approach. Fig. 6(c) shows the output of the Shannon entropy-based approach. Fig. 6(d) is the energy envelope. Fig. 6(e) is the signal envelope obtained by using Shannon energy computation. However, each envelope extraction approach has its own advantages and limitations [38,40,41]. Fig. 6(d) clearly shows that the energy-based approach diminishes the low-amplitude heart sounds as compared to that of high-amplitude heart sounds. The Shannon energy accentuates medium-amplitude heart sound meanwhile it suppresses the low-amplitude noises much more than that of high-amplitude sounds [31]. By referring Fig. 6(e), we can observe that the Shannon energy approach may not provide a sufficient amplification for medium-amplitude heart sounds including the fourth heart sound S4. From the experimental results shown in Fig. 6, we can observe that the Shannon entropy approach provides a better nonlinear peak amplification for high-amplitude, medium-amplitude and low-amplitude heart sounds meanwhile it amplifies the noise components in the systolic/diastolic period portions. However, the magnitude of the noises are small as compared to magnitude of the major acoustic events. In this work, we present a new Shannon entropy-based envelope extraction approach which advantageously overcomes the major limitations of other envelope extraction approaches reported in the literature.The proposed signal envelope extraction approach comprises the steps of: normalizing the filtered PCG signal, computing the magnitude (or absolute) of normalized PCG signal, computing Shannon entropy of the positive-valued PCG signal, applying adaptive thresholding rule on the Shannon entropy sequence, and performing smoothing process.The filtered signal f[n] is first normalized for maintaining the signal amplitude from −1 to 1. The normalized filtered signalf˜[n]is computed as(4)f˜[n]=f[n]maxn=1N(|f[n]|),where N denotes the number of samples in PCG signal block. The absolute operation is applied on the normalized filtered PCG signal to obtain a positive-valued signal, which has signal amplitude from 0 to 1. Then, the absolute operation is implemented as(5)a[n]=|f˜[n]|,where a[n] denotes absolute of the filtered PCG sequence. From the result shown in Fig. 7(a3), we can observe that the absolute operation provides a linear amplification to amplitude of the heart sounds and other noise components of the PCG signal. Although the absolute operation produces a unipolar signal regardless of negative polarity of PCG signal, the absolute operation does not reduce the magnitude of the residual components due to the presence of low-amplitude periodic components and artifacts within signal bandwidth. In such a scenario, the amplitudes of residual noise components can lead to produce a noisy signal envelope.In order to reduce the effect of magnitude of residual noise components in the PCG signal envelope, the adaptive amplitude thresholding rule is proposed in this work. The adaptive amplitude thresholding rule is defined as(6)a˜[n]=0,a[n]<ηa[n],otherwise.wherea˜[n]denotes the thresholded absolute PCG signal and the adaptive threshold parameter η for each PCG block is determined as(7)η=0.5×σa,whereσa=1N∑n=1N(a[n]−μa)2andμa=1N∑n=1Na[n].where N is the number of samples. The noisy PCG and total variation filtered signals are shown in Fig. 7(a1) and (a2), respectively. The outputs of the linear transformation and adaptive energy thresholding stages are shown in Fig. 7(a3) and (a4), respectively. By comparing Fig. 7 (a1) and (a2), we can notice that the adaptive thresholding process effectively eliminates noise spikes in the systolic and diastolic pause period portions (or low activity portions) of the PCG cycle. By referring the experimental results shown in Fig. 7(b1), (c1) and (d1), we can notice that the peak-amplitudes of the low-amplitude fourth heart sound S4 are very small as compared to that of high-amplitude heart sounds S1 and S2. Thus, conventional envelope extraction approaches provide a signal envelope with large and small local peaks. In many PCG signals, the intensity (or amplitude) of the heart sounds and murmurs may vary under different subjects and pathological conditions. In this case, the conventional envelope based segmentation method fails to detect boundaries of the low-amplitude heart sounds in the PCG signal. As a result, the segmentation method may frequently result in more false-negative detections. From the experimental results shown in Fig. 7, we can observe that the Shannon entropy computation advantageously overcomes the limitations of the conventional envelope based segmentation approaches. Therefore, the Shannon entropy formulation is proposed to achieve a better non-linear peak amplification of the PCG signala˜[n]. The nonlinear peak amplification is aimed at reducing the number of false-negative detections. In this work, the Shannon entropy of the thresholded PCG signala˜[n]is computed as(8)s[n]=−a˜[n]log(a˜[n]),where s[n] denotes the Shannon entropy of nth sample of the signala˜[n]. The result shown in Fig. 7(a5) illustrates that the significant peaks of the envelope are associated with acoustic events of the PCG signal. The multiple peaks in the signal envelope may increase number of false positive detections. Therefore, in this work, we introduce an envelope smoothing process that can produce a smooth Shannon entropy envelope by smoothing out multiple peaks and spikes.The envelope smoothing process is implemented by using a linear zero-phase filtering with a rectangular impulse response, h(k) of length L. The purpose of this filter is to smooth out noise spikes (and/or multiple peaks) contained in the signal envelope so that it can reduce false positive detection rates. The smoothness depends on the filter length. Generally, the filter length may be determined from the normal durations of the heart sounds and spilt interval within heat sounds. Here, filter length (L) equal to 50ms is chosen such that it can reduce the effect of multiple peaks within each heart sound portion, and can avoid merging of two successive heart sounds. The proposed smoothing process is implemented as shown in Fig. 8. The smooth Shannon entropy envelope z[n] is obtained by using zero-phase filtering, which is designed to provide smoothed peaked envelopes around major acoustic events and to smooth out the multiple peaks. The effectiveness of the proposed smoothing process is illustrated in Fig. 7(a6). The proposed smoothing process further provides smooth envelope at the boundaries of the heart sounds in the PCG signal. The envelope smoothing process can reduce the number of false positive detections and also improve the accurate determination of endpoints of the local heart sounds. By referring Fig. 7(a6), we can clearly notice that the peaks and boundaries of the local waves provide approximate boundaries and peaks of the true major acoustic events of the PCG signal. The proposed smooth Shannon entropy based envelope extraction approach has the following advantages: (i) it results in small peak-amplitude deviations between the successive peaks in the candidate signal envelope, (ii) the adaptive thresholding stage reduces the effects of low-frequency components of the artifacts, and (iii) the zero-phase filtering produces a smooth signal envelope with sharp local maxima and smooth envelope at the boundaries and peaks of the acoustic events of the PCG signal. Experimental results in Fig. 7 show that the proposed envelope extraction approach can lead to provide a better detection performance for the PCG signal with small-amplitude heart sounds and murmurs under nonstationary noises.In this work, the instantaneous phase waveform of the smooth Shannon entropy envelope is proposed for automatically determining the boundaries of the local waves in the candidate Shannon entropy envelope obtained for the PCG signal at previous stage. Finally, the locations of boundaries determined are used as guides to determine true boundaries of the significant acoustic events in the input PCG signal. In this subsection, we first describe the proposed instantaneous phase waveform based boundary determination approach.The analytical signal representation of a smooth Shannon entropy envelope z[n] is computed as(9)za[n]=z[n]+jzˆ[n]where za[n] denotes an analytical signal of the Shannon entropy envelope andzˆ[n]denotes Hilbert transform (HT) of z[n]. The HT of a real-valued continuous-time signal z(t) is defined as(10)zˆ(t)=H[z(t)]=1πt*z(t)=1π∫−∞∞z(τ)t−τdτ.where * denotes the convolution operator. The Fourier transform (FT) of thezˆ(t)is given by(11)Zˆ(f)=F[zˆ(t)]=F[1πt]·F[z(t)]=−jsgn(f)·Z(f),where Z(f) denotes the FT of the signal z(t), −jsgn(f) denotes the FT of1πt, and sgn denotes signum function which is defined as(12)sgn(f)=1f>00f=0−1f<0Then, the Hilbert transform of the signal z(t) can be computed as(13)zˆ(t)=IFT[Zˆ(f)]whereZˆ(f)=jZ(f)f<0−jZ(f)f>0where IFT denotes the inverse Fourier transform. The analytical signal representation of the signal envelope z[n] can be expressed as(14)za[n]=A[n]ejφ[n]where A[n] denotes the amplitude envelope of the analytical signal za[n] of the Shannon entropy envelope z[n] and ϕ[n] denotes the instantaneous phase of the analytical signal za[n]. The instantaneous phase ϕ[n] is computed as(15)ϕ[n]=tan−1zˆ[n]z[n]where ϕ[n] denotes the instantaneous phase of the nth sample and the phase is measured in radians.In order to study the effectiveness of the instantaneous phase waveform in determining the boundaries of the signal envelope, we conducted various experiments by using different PCG signals. The experimental results of the instantaneous phase computation stage are shown in Fig. 9for the PCG signals with heart sounds (S1, S2, and S3) and diastolic aortic insufficiency. In this experiment, the test PCG signals include low-amplitude audible heart sound and high-frequency sound components. Fig. 9(a3) illustrates the instantaneous phase waveform of the candidate Shannon entropy envelope shown in Fig. 9(a2), which is obtained for the filtered PCG signal with the heart sounds (S1, S2, and S3) shown in Fig. 9(a1). The experimental results for the PCG signal with diastolic aortic insufficiency are shown in Fig. 9(b1)–(b4). Fig. 9(b3) illustrates the instantaneous phase waveform obtained for the signal envelope shown in Fig. 9(b2). By referring Fig. 9(a3) and (b3), we can observe that the instantaneous phase waveform varies between −1.57 to 1.57 radians. The instantaneous phase waveform has positive-slope and negative-slope vertical lines. In this work, boundaries of the candidate signal envelope are determined by analyzing the positive-slope line and the positive-peak and negative-peak between the successive zerocrossing points of the instantaneous phase waveform.From the results as shown in Fig. 9(a3) and (b3), it is noted that the instantaneous phase waveform has positive-slope and negative-slope vertical lines. The instantaneous phase waveform provides the phase angles (in radians) determined for each sample of the envelope signal using analytical signal representation. In general, analytical signal is a complex signal which has the real part as signal envelope z[n] and the imaginary part as Hilbert transformed envelopezˆ[n]. The envelope z[n] may comprise of four components: positive-slope, negative-slope, peak point and zero-valued portions. For the positive valued signal envelope z[n], the samples of the Hilbert transformed envelope have negative amplitudes for the positive-slope portion and positive amplitudes for the negative-slope portion. The phase angle is negative for the positive-slope portion and positive for negative-slope portion. The negative to positive angle change happens at the peak point of the envelope. For the signal envelope z[n] with zero-valued samples and Hilbert transformed envelopezˆ[n]with positive valued samples, the phase angle is +1.57 radian. Similarly, for the envelope with zero-valued samples andzˆ[n]with negative-valued samples, the phase angle is −1.57 radians. Since the sign of amplitudes of thezˆ[n], the sign of the phase angle also changes accordingly. The phase angle transition from +1.57 to −1.57 can be seen at negative zerocrossings point of thezˆ[n]. Thus, the negative-slope vertical line has a higher slope (or sharp discontinuity) than that of the positive-slope vertical line. The negative-slope vertical line can be useful for separating two local waves of the signal envelope. The information about negative-slope vertical line may not be useful in finding approximate boundary points of the local-waves of the signal envelope. The positive-slope vertical line has bottom and top horizontal lines with a phase value of −1.57 and 1.57 radians, respectively. The positive-slope vertical line is connected with left bottom horizontal line and right top horizontal line. The endpoint of the bottom horizontal line that is connected with the start-point of a positive-slope vertical line indicates the start-point of the local-waves in the signal envelope. The start-point of the top horizontal line that is connected with the endpoint of a positive-slope vertical line indicates the endpoint of the local-waves in the signal envelope. With reference to Fig. 9(a3), we can further observe that the instantaneous phase waveform has a positive-peak between successive positive and negative zerocrossing points and a negative-peak between successive negative and positive zerocrossing points. These positive-peak and negative-peak can be observed when there is an insufficient zero-line spacing between two successive local-waves in the signal envelope s[n]. In such case, the locations of the positive-peak and negative-peak indicate the endpoint of the local-waves and the start-point of the local-waves of the signal envelope, respectively. The boundary determination steps are further described with an example in this subsection.Detecting locations of positive-slope vertical line: The positive-slope vertical line of the instantaneous phase waveform ϕ[n] provides more relevant information about the boundaries of local-waves contained in the signal envelope z[n] than the negative-slope vertical line. Therefore, we further process information about the positive-slope vertical line in this work. From the results as shown in Fig. 9(a3) and (b3), we can notice that the positive-slope vertical line is connected with the bottom and top horizontal lines, which have phase-angle of −1.57 and 1.57 radians, respectively. The endpoint of the bottom horizontal line is connected with the start-point of a positive-slope vertical line. The endpoint value of the bottom horizontal line is approximately −1.57 for smooth signal envelope with large zero-line spacing between local waves. The endpoint of the bottom horizontal line indicates the start-point of the local-waves in the signal envelope z[n]. Therefore, the start-point of the positive-slope vertical line is determined by using bottom horizontal threshold value of −1.5. The start-point of the top horizontal line is connected with the end-point of a positive-slope vertical line. The start-point value of the top horizontal line is approximately 1.57. The start-point of the top horizontal line indicates the end-point of the local-waves in the signal envelope z[n]. Therefore, the endpoint of the positive-slope vertical line is determined by using top horizontal threshold value of 1.5. The algorithm for determining start point and endpoint of the positive-slope vertical line is illustrated in Table 1. For the envelopes with large zero-line spacing between local waves [see Fig. 9(b2)], it is observed that the proposed boundary determination approach is able to determine boundaries of all heart sounds and murmurs irrespective of their amplitudes [see results shown in Fig. 9(b3)–b(4) for more details].Detecting locations of positive and negative peaks: For determining the boundaries of the local waves which are having insufficient zero-line spacing [see Fig. 9(a2)], the method determines positive and negative zerocrossing points by checking the sign of the instantaneous phase waveform samples at the time-instants tnand tn+1. The algorithm for detecting both positive zerocrossing point and negative zerocrossing point is illustrated in Table 2. Then, the positive-peak between successive positive and negative zerocrossing points and a negative-peak between successive negative and positive zerocrossing points are determined by using the algorithm illustrated in Table 2. From the results as shown in Fig. 9(a3), it is noted that the positive-peak of the instantaneous phase waveform indicates the endpoint of the low-amplitude heart sounds while the negative-peak indicate the start point of the high-amplitude heart sounds when a interval of between the low-amplitude heart sound and high-amplitude heart sound is below 50ms, which is the length of smoothing filter. For determining locations of the positive-peak and negative-peak of the instantaneous phase waveform, the lower peak-amplitude threshold (TH1) and upper peak-amplitude threshold (TH2) are used in this work. From our results, the lower peak-amplitude threshold (TH2) of 0.25 and upper peak-amplitude threshold (TH3) of 1.49 are chosen in this work. The proposed peak determination algorithm stores locations of the positive peaks which are detected between the successive positive and negative zero-crossing points if the peak-amplitudes determined are between the positive-valued lower and upper peak-amplitude thresholds. Also, the algorithm stores locations of the negative peaks which are detected between the successive negative and positive zero-crossing points if the peak-amplitudes determined are between the negative-valued lower and upper peak-amplitude thresholds. The locations of the positive-peaks indicate the end-points of the corresponding local-waves in the envelope. The locations of the negative-peaks indicate the start-points of the corresponding local-waves in the signal envelope. Experimental results of the proposed boundary point determination method for the test PCG signals are shown in Fig. 9(a4) and (b4). The boundary points are indicated with different color marks (start-point marked as green color and endpoint marked as red color). From experimental results, we can observe that the proposed method accurately determines the boundary points of the significant acoustic events including heart sounds (S1, S2, and S3), low-amplitude heart sounds and high-frequency heart sounds in the PCG signal.Based upon the results, we observed that the locations of the boundaries determined using the candidate signal envelope differ slightly from the locations of boundaries of the heart sounds and murmurs contained in the original PCG signal. The boundary location error is due to the usage of smoothing filter with duration of 50ms. To correct the time-location error, a simple boundary adjustment rule is implemented by measuring the root-mean-square (RMS) value of moving window with duration of 5ms on the filtered PCG signal. The short-term window is moved on forward and backward directions for the correction of the boundary point determined for each heart sound segment. The time-location correction is done by comparing the RMS value of each moving-window with a threshold equal to 0.05. The new time-locations will be stored for heart sound segments identified in the previous stage. Otherwise, the previous time-locations are stored if a moving-window does not satisfy the adjustment rule. Finally, the time-locations of the boundaries of the heart sound segments identified by using the proposed method are stored for further analysis of heart sound signals.The performance of the proposed heart sound activity detection (HSAD) is tested and validated by using both clean and noisy PCG signals. The PCG database [45] consists of different pathological and non-pathological heart sounds and murmurs including normal heart sounds, normal split, early-systolic, late-systolic and pan-systolic, mitral and tricuspid stenosis, aortic and pulmonic regurgitation, fixed and wide S2 split, S1 split, mitral prolapse, ejection murmur and click and different time-varying systolic and diastolic murmurs [12]. The PCG signals are digitized with different sampling rates and sample resolutions. The test PCG signals include low-frequency artifacts and different kinds of noise with varying noise-level. Moreover, the PCG signals with different signal-to-noise ratios (SNRs) are created by adding additive white Gaussian noise to the input signals. In order to evaluate the performance of proposed total variation filter (TVF) approach, a SNR metric defined in Eq. (3) is used for assessing the quality of the denoised PCG signals.In order to compute different performance metrics, we created ground-truth annotations for all test PCG signals. We manually marked the start-time and end-time of each significant acoustic segment of the test PCG signal and the total number of true segments contained in the PCG signal. From the experimental results, we compute three quantitative results: true positive (TP) when a heart sound segment is correctly detected, false negative (FN) when a heart sound segment is not detected, and false positive (FP) when a noise segment is detected as heart sound. By using these quantitative results, we calculate the following performance metrics:(16)Sensitivity(Se)=TPTP+FN×100%,(17)PositivePredictivity(+P)=TPTP+FP×100%,(18)DetectionErrorRate(DER)=FP+FNTP×100%.The overall performance of the HSAD method is measured in terms of the detection accuracy which is defined as(19)Accuracy(Acc)=TP/(TP+FP+FN)×100%.The average absolute time error is computed as(20)AATE=∑(|tds−tas|+|tde−tae|)/NTPwhere tdsand tdedenote the detected start-time and end-time, respectively and tasand taedenote the true start-time and end-time of PCG segment from ground-truth annotation, respectively. Various experiments are conducted for evaluating the effectiveness of the proposed HSAD method under both clean and noise environments. Finally, the overall performance of the proposed HSAD is compared with other existing methods by using the absolute (ABS) value, energy (ENR) value and Shannon energy (SE) value with total variation filter and conventional low-pass filter approaches.

@&#CONCLUSIONS@&#
