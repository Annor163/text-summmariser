@&#MAIN-TITLE@&#
Fast computation of Hessian-based enhancement filters for medical images

@&#HIGHLIGHTS@&#
A method for fast computation of Hessian-based enhancement filters is proposed.The method relies on avoiding computation of Hessian eigenvalues.The percentage reductions in processing time can be over 65%.

@&#KEYPHRASES@&#
Hessian-based enhancement filter,Routh–Hurwitz criterion,Selective enhancement filter,Hessian eigenvalue,

@&#ABSTRACT@&#
This paper presents a method for fast computation of Hessian-based enhancement filters, whose conditions for identifying particular structures in medical images are associated only with the signs of Hessian eigenvalues. The computational costs of Hessian-based enhancement filters come mainly from the computation of Hessian eigenvalues corresponding to image elements to obtain filter responses, because computing eigenvalues of a matrix requires substantial computational effort. High computational cost has become a challenge in the application of Hessian-based enhancement filters. Using a property of the characteristic polynomial coefficients of a matrix and the well-known Routh–Hurwitz criterion in control engineering, it is shown that under certain conditions, the response of a Hessian-based enhancement filter to an image element can be obtained without having to compute Hessian eigenvalues. The computational cost can thus be reduced. Experimental results on several medical images show that the method proposed in this paper can reduce significantly the number of computations of Hessian eigenvalues and the processing times of images. The percentage reductions of the number of computations of Hessian eigenvalues for enhancing blob- and tubular-like structures in two-dimensional images are approximately 90% and 65%, respectively. For enhancing blob-, tubular-, and plane-like structures in three-dimensional images, the reductions are approximately 97%, 75%, and 12%, respectively. For the processing times, the percentage reductions for enhancing blob- and tubular-like structures in two-dimensional images are approximately 31% and 7.5%, respectively. The reductions for enhancing blob-, tubular-, and plane-like structures in three-dimensional images are approximately 68%, 55%, and 3%, respectively.

@&#INTRODUCTION@&#
Image pre-processing plays an important role in medical image processing. Many pre-processing techniques have been developed [1–3]. Among those techniques, the Hessian-based enhancement filter is one of the most widely used. Hessian-based enhancement filters have been developed and adopted to process blob-, tubular-, and plane-like structures in medical images [4–15].High computational cost is one of the main drawbacks of Hessian-based enhancement filters [12,16,17]. The Hessian-based enhancement filter technique is based on the eigenvalue analysis of the Hessian matrix corresponding to each image element in two-dimensional (2D) or three-dimensional (3D) images. To obtain the response of a Hessian-based enhancement filter to an image element, the Hessian eigenvalues corresponding to the element are first computed and arranged in some order. The filter response is then obtained by computing the designed response function with the arranged Hessian eigenvalues. Computing eigenvalues of a matrix requires substantial computational effort. Moreover, Hessian-based enhancement filters are commonly applied in multiscale frameworks. One has to compute Hessian eigenvalues for each image element for every selected scale. Consequently, high computational cost becomes a challenge in the application of Hessian-based enhancement filters.Few efforts have been dedicated to solving the problem of high computational cost in the application of Hessian-based enhancement filters. Orlowski and Orkisz [17] proposed a method to reduce the computational costs of Hessian-based enhancement filters for tubular-like structures in 3D images. Their method is based on the fact that the response of a Hessian-based enhancement filter to an image element is zero if the specified condition in the response function of the filter for identifying a particular structure is not satisfied. They showed that for a voxel, one can conclude by performing two tests that the condition for identifying tubular-like structures is not satisfied. The first test checks the sign of the Hessian trace, and the second test examines the sign of the Hessian determinant and whether the Hessian matrix is negative-definite. If the two tests conclude that the condition is not satisfied, the response of the Hessian-based enhancement filter to the voxel can be determined to be zero without having to compute the corresponding Hessian eigenvalues. The computational cost of the Hessian-based enhancement filter can thus be reduced.In this paper, a method is proposed for reducing the computational costs of Hessian-based enhancement filters for blob-, tubular-, and plane-like structures in 2D and 3D images. It is shown that for an image element, under certain conditions, we can conclude that the conditions in the response functions of the Hessian-based enhancement filters are not satisfied without having to compute the corresponding Hessian eigenvalues. These conditions are developed by using a property of the characteristic polynomial coefficients of the Hessian matrix corresponding to the image element and the well-known Routh–Hurwitz criterion in control engineering. They can be checked with very low computational costs. As a result, the number of computations of Hessian eigenvalues required by the filters to process images can be reduced with very low computational cost. The computational costs of the filters are thereby reduced.The rest of the paper is organized as follows. Section 2 reviews Hessian-based enhancement filters for 2D and 3D images. Section 3 develops the method for reducing the computational costs of Hessian-based enhancement filters for blob-, tubular-, and plane-like structures in 2D and 3D images. The experimental results are given in Section 4 to show the effectiveness of the method. The results are discussed in Section 5, and conclusions are drawn in Section 6.Let f(x) be the intensity function of an image, where x is the location in the image space. For a 2D image, the Hessian matrix, H2(x), corresponding to the pixel at x=(x,y) is given by(1)H2(x)=∂2f∂x2∂2f∂x∂y∂2f∂y∂x∂2f∂y2≜fxxfxyfyxfyywhere∂2f∂x2,fxx,∂2f∂x∂y,fxy, etc. are the second order partial derivatives of f.Similarly, for a 3D image, the Hessian matrix, H3(x), corresponding to the voxel at x=(x,y,z) is given by(2)H3(x)=∂2f∂x2∂2f∂x∂y∂2f∂x∂z∂2f∂y∂x∂2f∂y2∂2f∂y∂z∂2f∂z∂x∂2f∂z∂y∂2f∂z2≜fxxfxyfxzfyxfyyfyzfzxfzyfzzFor convenience and without causing ambiguity, let Λ=(λ1, λ2) withλ1≥λ2and Λ=(λ1, λ2, λ3) withλ1≥λ2≥λ3be the eigenvalues of H2(x) and H3(x), respectively. The response function, Φ(x), of a Hessian-based enhancement filter has the form(3)Φ(x)=ϕ(Λ),ifconditionΩΛissatisfied;0,otherwise.In designing the response function Φ(x) , the condition ΩΛis specified according to the structure to be enhanced. The image element at x is determined to belong to the structure if the Hessian eigenvalues corresponding to the image element satisfy the condition ΩΛ. If this is the case, the filter response to the image element is given by the designed function, ϕ(Λ); otherwise, the filter response is zero.The condition ΩΛin the response function Φ(x) in Eq. (3) is associated only with the signs of Hessian eigenvalues. The derivation of the condition ΩΛfor identifying blob-, tubular-, and plane-like bright structures in a dark background can be found in [9,12]. Typically, the conditions, ΩΛ,b2 and ΩΛ,t2, for identifying blob- and tubular-like bright structures, respectively, in 2D images and the conditions, ΩΛ,b3, ΩΛ,t3, and ΩΛ,p3, for identifying blob-, tubular-, and plane-like bright structures, respectively, in 3D images, are given by(4)ΩΛ,b2:λ1<0,λ2<0ΩΛ,t2:λ1<0ΩΛ,b3:λ1<0,λ2<0,λ3<0ΩΛ,t3:λ1<0,λ2<0ΩΛ,p3:λ1<0However, usage of these conditions can differ. For example, the filter designed by Zhou et al. [11] uses the condition ΩΛ,b3 to identify both blob- and tubular-like structures in 3D images. The discrimination between a blob-like structure and a tubular-like structure is achieved by setting the value of a constant in the function ϕ(Λ) in Eq. (3). Although there can be different usage of the conditions in Eq. (4), the fact that condition ΩΛin Eq. (3) is associated only with the signs of Hessian eigenvalues does not change. In this paper, this characteristic of condition ΩΛplays the key role in the development of the method for reducing the computational costs of Hessian-based enhancement filters.To enhance objects of different sizes, Hessian-based enhancement filters are commonly applied in multiscale frameworks. For example, Li et al. [12] designed selective enhancement filters as follows:(5)Φb2(x)=λ22λ1,ifλ1<0,λ2<0;0,otherwise.Φt2(x)=λ1−λ2,ifλ1<0;0,otherwise.Φb3(x)=λ32λ1,ifλ1<0,λ2<0,λ3<0;0,otherwise.Φt3(x)=λ2λ2−λ3λ1,ifλ1<0,λ2<0;0,otherwise.Φp3(x)=λ1−λ2,ifλ1<0;0,otherwise.where Φb2(x) and Φt2(x) are for blob- and tubular-like structures, respectively, in 2D images, and Φb3(x), Φt3(x), and Φp3(x) are for blob-, tubular-, and plane-like structures, respectively, in 3D images. They also designed the algorithm of multiscale selective enhancement filters for enhancing objects with diameters lying in a given interval, as follows [12]:Algorithm 1Algorithm of multiscale selective enhancement filtersStep 1:Determine empirically the number, Ns, of scales to be used for enhancing objects with diameters lying in the interval [d0,d1].Compute the Nsindividual scales σi, i=1, …, Nsusing the formula(6)σ1=d04,σ2=rσ1,σ3=r2σ1,…,σN=rNs−1σ1=d14where r=(d1/d0)1/(Ns−1).For each scale σi, i=1, …, Ns, perform Steps 4 through 9.Compute the convolution, Ti, of the image and a Gaussian function of scale σi.For each image element at x in Ti, perform Steps 6 through 8.Compute the Hessian eigenvalues corresponding to the image element at x.Compute the filter response Φ(x) .End the loop for x.End the loop for σiFor each image element at x, the final filter response ismaxσi2Φ(x),i=1,…,Ns.It can be seen from Algorithm 1 that the filter response to every image element of the image must be computed once for each scale. This leads to high computational cost, especially for a large number of scales Ns, because it requires computing the eigenvalues of a large number of Hessian matrices. In the next section, theorems for checking the conditions in Eq. (4) without having to compute Hessian eigenvalues are developed. With these theorems, the computational costs of multiscale Hessian-based enhancement filters can be reduced remarkably.Let A be an n×n matrix. The characteristic polynomial of A is given by(7)pA(λ)=detλIn−A=λn+c1λn−1+⋯+cn−1λ+cnwhere det(.) and Inare the determinant of the indicated matrix and the identity matrix of size n, respectively. The coefficient c1 of pA(λ) has the property that(8)c1=−tr(A)where tr(.) is the trace of the indicated matrix [18]. The roots, λ1, λ2, …, λn, of pA(λ) are the eigenvalues of A. Moreover, the sum of the eigenvalues of A is equal to the trace of A[19], i.e.,(9)tr(A)=∑k=1nλkFrom Eqs. (8) and (9)(10)c1=−∑k=1nλkLet p(s) be a real polynomial of degree n given by(11)p(s)=a0sn+a1sn−1+⋯+an−1s+an,an≠0The following theorem states a condition for all the roots of p(s) to lie in the open left-hand complex plane, i.e., for the real parts of all the roots of p(s) to be negative.Theorem 1[20]If all the roots of the polynomial p(s) lie in the open left-hand complex plane, then all the coefficients of p(s) are nonzero and have the same sign.From Theorem 1, if any of the coefficients of p(s) are zero or have different signs from other coefficients, we can immediately conclude that some of the roots of p(s) do not lie in the open left-hand complex plane. However, if all the coefficients of p(s) are nonzero and have the same sign, no conclusion can be made. In other words, Theorem 1 is only a necessary condition. The Routh–Hurwitz criterion in control engineering gives a necessary and sufficient condition for all the roots of p(s) to lie in the open left-hand complex plane. For the polynomial p(s) in Eq. (11), the Routh array, shown in Table 1, can be constructed using(12)a0,j=a2j,j=0,1,…,n0a1,j=a2j+1,j=0,1,…,n1ai+1,j=(ai−1,j+1ai,0−ai−1,0ai,j+1)ai,0,j=0,1,…,ni+1;i=1,…,n−1whereni=(n−i)/2and⋅is the floor function. With the Routh array, the Routh–Hurwitz criterion can be stated as follows:Theorem 2(Routh–Hurwitz criterion) [20](i)The number of roots of the polynomial p(s) that lie in the open right-hand complex plane is equal to the number of sign changes in the first column of the Routh array of p(s).The polynomial p(s) has roots that are symmetrically located about the origin of the complex plane if all the elements of a row of the Routh array of p(s) are zero.Computing eigenvalues of a matrix is time-consuming. In this paper, we are concerned with fast computation of the eigenvalues of the 2×2 Hessian matrix, H2(x), in Eq. (1) and the 3×3 Hessian matrix, H3(x), in Eq. (2), when the computation of Hessian eigenvalues cannot be avoided. Therefore, the analytical methods given below for computing 2×2 and 3×3 Hessian matrices are adopted.The eigenvalues of the 2×2 Hessian matrix, H2(x), in Eq. (1) can be computed fast by solving analytically for the roots of the quadratic characteristic polynomial of the matrix. LetpH2(λ)be the characteristic polynomial of H2(x). It is easy to derive the formula(13)pH2(λ)=λ2+α1λ+α2where(14)α1=−(fxx+fyy)α2=fxxfyy−fxyfyxThe two eigenvalues of H2(x) are precisely the roots ofpH2(λ), which can be computed analytically using the formulas(15)12−α1+α12−4α2,12−α1−α12−4α2The eigenvalues of the 3×3 Hessian matrix, H3(x), in Eq. (2) can be computed fast using the analytical method developed by Kopp [21], which has been proved more efficient than iterative algorithms, such as the Jacobi and QL algorithms [21]. LetpH3(λ)be the characteristic polynomial of H3(x), which can be derived easily as(16)pH3(λ)=λ3+β1λ2+β2λ+β3where(17)β1=−(fxx+fyy+fzz)β2=fxxfyy+fxxfzz+fyyfzz−fxyfyx−fxzfzx−fyzfzyβ3=fxxfyzfzy+fxyfyxfzz+fxzfyyfzx−fxxfyyfzz−fxyfyzfzx−fxzfyxfzyLet(18)η=β12−3β2μ=−272β3−β13+92β1β2θ=13tan−127β22(η−β2)/4+β3(μ+27β3/4)μ,0≤θ≤πMoreover, let(19)x1=2cosθx2=−cosθ−3sinθx3=−cosθ+3sinθThe three eigenvalues of H3(x) can be computed using the following formula [21]:(20)η3xi−13β1,i=1,2,3To determine whether the conditions ΩΛ,b2 and ΩΛ,t2 in Eq. (4) are not satisfied without computing the eigenvalues of H2(x), the following two theorems are established.Theorem 3The condition ΩΛ,b2in Eq.(4)is not satisfied if any of the coefficients of the polynomialpH2(λ)in Eq.(13)are nonpositive.Since the leading coefficient ofpH2(λ)is positive, from Theorem 1, it is obvious that the condition ΩΛ,b2 is not satisfied if any of the coefficients ofpH2(λ)are nonpositive.□The condition ΩΛ,t2in Eq.(4)is not satisfied if one of the following conditions associated with the coefficients of the polynomialpH2(λ)in Eq.(13)holds:•α1<0α1=α2=0(i)From Eq. (10), α1=−(λ1+λ2). Sinceλ1≥λ2, if α1<0, we can conclude that λ1>0, and the condition ΩΛ,t2 is not satisfied.It is obvious that λ1=λ2=0 if α1=α2=0. Therefore, the condition ΩΛ,t2 is not satisfied.□To establish theorems that can determine whether the conditions ΩΛ,b3, ΩΛ,t3, and ΩΛ,p3 in Eq. (4) are not satisfied without computing the eigenvalues of H3(x), the Routh array of the polynomialpH3(λ)in Eq. (16) is first constructed using the formulas in Eq. (12), as follows:(21)1β2β1β3β1β2−β3β1β3With the Routh array ofpH3(λ), the theorems can now be established as follows.Theorem 5The condition ΩΛ,b3in Eq.(4)is not satisfied if one of the following conditions associated with the coefficients of the polynomialpH3(λ)in Eq.(16)holds:(i)Any of the coefficients of the polynomialpH3(λ)are nonpositive.β1β2≤β3(i)Since the leading coefficient ofpH3(λ)is positive, from Theorem 1, it is obvious that the condition ΩΛ,b3is not satisfied if any of the coefficients ofpH3(λ)are nonpositive.If β1β2≤β3, the Routh array ofpH3(λ)in Eq. (21) has a negative element in the first column or has a row whose elements are all zero. Since the leading coefficient ofpH3(λ)is positive, from Theorem 2 and Eq. (21), the polynomialpH3(λ)has roots lying in the open right-hand complex plane or symmetrically located about the origin of the complex plane. Therefore, the condition ΩΛ,b3 is not satisfied.□The condition ΩΛ,t3in Eq.(4)is not satisfied if one of the following conditions associated with the coefficients of the polynomialpH3(λ)in Eq.(16)holds:(i)β1≤0β2≤0 and β3=0β1>0, β3>0, and β1β2<β3(i)From Eq. (10),β1=−λ1+λ2+λ3. If β1≤0, then λ1+λ2+λ3≥0. Sinceλ1≥λ2≥λ3, it is obvious that λ1+λ2+λ3<0 if λ1<0 and λ2<0. Therefore, the condition ΩΛ,t3 is not satisfied if β1≤0.If β3=0, the polynomialpH3(λ)can be rewritten aspH3(λ)=λp˜(λ), wherep˜(λ)=λ2+β1λ+β2. Since the leading coefficient ofp˜(λ)is positive, from Theorem 1, the roots ofp˜(λ)are not all negative if β2≤0. Therefore, if β2≤0 and β3=0, then the polynomialpH3(λ)has at least two nonnegative roots and the condition ΩΛ,t3 is not satisfied.If β1>0, β3>0, and β1β2<β3, from Eq. (21), there are two sign changes in the first column of the Routh array ofpH3(λ). From Theorem 2, the polynomialpH3(λ)has two positive roots. Therefore, the condition ΩΛ,t3is not satisfied.□The condition ΩΛ,p3in Eq.(4)is not satisfied if one of the following conditions associated with the coefficients of the polynomialpH3(λ)in Eq.(16)holds:(i)β1≤0 and β2=β3=0β1<0, β2>0, and β3=0β1<0, β3<0, and β1β2<β3(i)It is obvious that if β1≤0 and β2=β3=0, then all three roots ofpH3(λ)are nonnegative. Therefore, the condition ΩΛ,p3 is not satisfied.If β3=0, the polynomialpH3(λ)can be written aspH3(λ)=λp˜(λ), wherep˜(λ)=λ2+β1λ+β2. Moreover, from Eq. (12), the Routh array ofp˜(λ)is(22)1β2β1β2If β1<0 and β2>0, then there are two sign changes in the first column of the Routh array in (22). Therefore, from Theorem 2, the polynomialp˜(λ)has two positive roots. In other words, if β1<0, β2>0, and β3=0, then all three roots ofpH3(λ)are nonnegative. Therefore, the condition ΩΛ,p3 is not satisfied.If β1<0, β3<0, and β1β2<β3, from Eq. (21), there are three sign changes in the first column of the Routh array ofpH3(λ). From Theorem 2, the polynomialpH3(λ)has three positive roots. Therefore, the condition ΩΛ,t3 is not satisfied.□Theorems 3–7 can be applied to reduce the computational costs of Hessian-based enhancement filters, because they can determine that the conditions in Eq. (4) are not satisfied without computing the eigenvalues of the Hessian matrices H2(x) and H3(x). To compute the response of a Hessian-based enhancement filter to an image element, the theorem corresponding to the condition ΩΛin the response function Φ(x) in Eq. (3) is used first to determine if the condition ΩΛis not satisfied. If the condition is not satisfied, the response of the filter to the image element can be determined immediately to be zero. It is not necessary to compute the Hessian eigenvalues corresponding to the image element. With Theorems 3–7, Algorithm 1 can be improved as follows:Algorithm 2Improved algorithm of multiscale selective enhancement filtersStep 1:Determine empirically the number, Ns, of scales to be used for enhancing objects with diameters lying in the interval [d0, d1].Compute the Nsindividual scales σi, i=1, …, Nsusing the formula in Eq. (6).For each scale σi, i=1, …, Ns, perform Steps 4 through 9.Compute the convolution, Ti, of the image and a Gaussian function of scale σi.For each image element at x in Ti, perform Steps 6 through 8.Determine whether the condition ΩΛis not satisfied by using the corresponding theorem. If the condition ΩΛis not satisfied, set Φ(x)=0. Goto Step 8.Compute the Hessian eigenvalues corresponding to the image element at x and then compute the filter response Φ(x).End the loop for x.End the loop for σiFor each image element at x, the final filter response ismaxσi2Φ(x),i=1,…,Ns.

@&#CONCLUSIONS@&#
This paper has presented a method for fast computation of Hessian-based enhancement filters for medical images. The computational costs of Hessian-based enhancement filters come mainly from the computation of Hessian eigenvalues to obtain filter responses. Theorems have been established to determine if the conditions in the response functions of the filters are not satisfied without having to compute Hessian eigenvalues. With the theorems, the filter responses can be obtained without computing Hessian eigenvalues. The computational costs of the filters can thus be reduced. Experiments were performed using the original and improved multiscale selective enhancement filters to process 2D and 3D thoracic CT images. The results show that the proposed method can reduce significantly the number of computations of Hessian eigenvalues and the processing time in applying Hessian-based enhancement filters to the processing of medical images.None.