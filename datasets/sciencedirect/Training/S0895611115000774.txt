@&#MAIN-TITLE@&#
Sparse Non-negative Matrix Factorization (SNMF) based color unmixing for breast histopathological image analysis

@&#HIGHLIGHTS@&#
SNMF uses more meaningful representation of color components for separating stained colors.Color unmixing is driven by the specific data information of each individual image.SNMF efficiently decomposes brown DAB component from IHC images.Served as a pre-processing step for accurately segmenting nuclei and lymphocytes from H & E images.SNMF shows improved performance than compared approaches.

@&#KEYPHRASES@&#
Color unmixing,Breast histology,Immunohistochemistry image,Hematoxylin and Eosin image,

@&#ABSTRACT@&#
Color deconvolution has emerged as a popular method for color unmixing as a pre-processing step for image analysis of digital pathology images. One deficiency of this approach is that the stain matrix is pre-defined which requires specific knowledge of the data. This paper presents an unsupervised Sparse Non-negative Matrix Factorization (SNMF) based approach for color unmixing. We evaluate this approach for color unmixing of breast pathology images. Compared to Non-negative Matrix Factorization (NMF), the sparseness constraint imposed on coefficient matrix aims to use more meaningful representation of color components for separating stained colors. In this work SNMF is leveraged for decomposing pure stained color in both Immunohistochemistry (IHC) and Hematoxylin and Eosin (H&E) images. SNMF is compared with Principle Component Analysis (PCA), Independent Component Analysis (ICA), Color Deconvolution (CD), and Non-negative Matrix Factorization (NMF) based approaches. SNMF demonstrated improved performance in decomposing brown diaminobenzidine (DAB) component from 36 IHC images as well as accurately segmenting about 1400 nuclei and 500 lymphocytes from H & E images.

@&#INTRODUCTION@&#
In clinical practice, pathologists visually examine tissue samples under a microscope for the purpose of diagnosing the presence of disease. Different colour stains are usually used to indicate the presence of different proteins. Hematoxylin and Eosin (H&E) are standard stains that highlight nuclei in blue/purple and cytoplasm in pink in order to visualize the structure of interest in the tissue [28]. Hematoxylin (H) dye can stain all nuclei in the H&E histopathological images. Therefore, in order to detect or segment all the nuclei, one popular idea (such as blue ratio algorithm [7]) is to detect H stains or blue color in the image. Immunohistochemistry (IHC) is yet another type of tissues staining that attempts to capture the expression levels associated with specific proteins. For instance, CD31, CD34, and CD105 expressions are found on vascular channels and some specific cell types (e.g. expression of CD34 on myofibroblasts) in human breast tumor tissue sections. As they are indicators of angiogenesis, the immunostaining of these proteins can be used to evaluate the degree of tumor angiogenesis in histological tissue sections [3,5,8,22]. In clinical practice, the malignancy grading of the tumor and angiogenic activity are largely based on the intensity, architectural, and vascular density features of brown diaminobenzidine (DAB) in IHC stained breast tissue [2]. Therefore, quantitative analysis on DAB compound is the pre-requisite to evaluate the tumor growth and metastasis in breast tissue [17].However, the IHC, H, E stains unfortunately overlap considerably which makes the problem of stain quantification within specific histologic primitives (e.g. nuclei, gland) challenging. Fig. 1(a) is an image of a breast tumor tissue section stained with CD31 antibody and hematoxylin counterstain. Stain or color separation in histology images could aid in automated detection of specific histologic structures such as nuclei and lymphocytes. A few approaches have been recently proposed to address this problem. Color Deconvolution (CD) is one such effective approach presented in [25] for unmixing pure stain colors. In [25], CD algorithm was employed for color unmixing of IHC stained histological images. Similarly, CD was employed for separating DAB and H stains from IHC stained histological images in [2]. Then H and DAB components are further used for constructing vascular density and graph features, respectively. In [4,21,27], CD was used for H & E stained image analysis. The unmixed H stain component with CD was further used for nuclei detection and segmentation. Nuclear morphology is an important phenotypic feature for grading of disease aggressiveness. For instance, the modified Bloom Richardson (mBR) grading system for breast cancers is highly correlated with nuclei morphology. The alterations in nuclei size, shape, and topological information are important signatures for disease diagnosis and prognosis [35–37]. Recently a number of nuclear segmentation approaches have been proposed [1,4,7,12,21,23,26,27]. CD was employed in [4,21,26,27] as a pre-processing step for nuclei detection/segmentation. The unmixed H stain component was leveraged to detect the nuclei boundaries in [27]. Then nuclear morphological features are extracted to predict prognosis of male breast cancers. Similarly, in [4] cancer nuclei was detected based on the unmixed H stain component. Then graph features and texture features were subsequently extracted for quantifying the mBR grade in ER+ breast cancers. In [21], the unmixed H stain component was leveraged to identify different types of nuclei. In [26,27], color unmixing and mathematical morphology operators were integrated with radial symmetry-based image transformation for nuclei detection. The watershed method was subsequently employed for nuclei segmentation. In [7], the blue ratio and multi-reference graph framework were employed for nuclei segmentation from H & E stained Glioblastroma Multiforme images. In [1], a hybrid active contour model developed on color intensities of RGB space was studied for nuclei segmentation in H & E stained breast histopathological images.Before color unmixing, the CD approach usually transforms the H & E stained images into Optical Density (OD) images based on the Beer–Lambert Law [16]. The CD operation is subsequently applied to separate different color components by multiplication of OD image with the inverse of the color matrix. This stain matrix was defined by the measurement of relative absorbtion for red, green and blue components associated with each stain used in the tissue. One disadvantage of this approach is that the color matrix is pre-defined and therefore limits its applicability to other image modalities. Moreover, the CD method requires accurate estimation of the stain matrix [19].Principle Component Analysis (PCA) [18] and independent Component Analysis (ICA) [15] are two popular unsupervised approaches that have been broadly used for representation learning [6]. Non-negative matrix Factorization (NMF) is the other important approach which decomposes a non-negative matrix into two low-rank non-negative matrices for finding a linear representation of non-negative data. In [24], an unsupervised spectral decomposition with Non-negative Matrix Factorization (NMF) algorithm was presented for color unmixing on IHC images of human biopsy tissue. In [13], a blind color decomposition method was presented for color unmixing of histopathological images. Sparse representation is usually incorporated for improving the efficiency of decomposition. Sparsity methods have been widely investigated and applied for medical image analysis, such as in [9–11,14,29–34,38].In this paper, we present a sparse NMF (SNMF) approach for color unmixing on histological images of the breast. The sparse representation of histological images aims to represent the image using fewer “active” components for better interpreting the staining of different components. The SNMF algorithm begins by transforming an intensity image in RGB space into the Optical Density (OD) image via the Beer–Lambert Law. Then the OD image is decomposed into a basis and a coefficient matrices, respectively. Multiplication of individual components of the basis matrix and coefficient matrix produces the OD image for each corresponding component. Finally, the intensity images of each component are represented in RGB space from the corresponding OD image. The post-processing operation is conducted on the intensity image of the resulting component. For instance, for H & E images, the unmixed H components can be leveraged for further segmenting nuclei/lympocytes. To show the effectiveness of proposed approach in color unmixing, we qualitatively and quantitatively evaluate the SNMF against PCA, ICA, CD, and NMF on three data sets which includes 36 CD 31, CD34, and CD105 IHC and H & E stained histopathological images, 200 H & E lymph node-negative and estrogen receptor-positive (LN-, ER+) breast cancer images, and 100 human epidermal growth factor receptor-2 (HER2+) breast cancer images, respectively. SNMF is compared with other approaches in terms of decomposing brown diaminobenzidine (DAB) component from IHC images as well as accurately segmenting nuclei/lymphocytes from H & E images.The rest of paper is organized as follows: A detailed description of Sparse Non-negative Matrix Factorization (SNMF) for color unmixing is presented in Section 2. The experimental setup and comparative strategies are discussed in Section 3. The experiment results and discussions are reported in Section 4. Concluding remarks are presented in Section 5.

@&#CONCLUSIONS@&#
