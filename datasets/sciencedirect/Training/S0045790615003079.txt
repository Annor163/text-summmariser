@&#MAIN-TITLE@&#
A hybrid automated detection of epileptic seizures in EEG records

@&#HIGHLIGHTS@&#
A new automated seizure detection model is proposed.Applying Weighted Permutation Entropy to classify raw and decomposed EEG signals.Simulating physiological and environmental artifacts to test the model robustness against noise.Comparison between Support Vector Machine and Artificial Neural Network classifier.Comparison with other automatics seizure detection models found in literature.

@&#KEYPHRASES@&#
Electroencephalogram (EEG),Epileptic seizure detection,Weighted Permutation Entropy (WPE),Support Vector Machine (SVM),

@&#ABSTRACT@&#
The paper introduces a new automated seizure detection model that integrates Weighted Permutation Entropy (WPE) and a Support Vector Machine (SVM) classifier model to enhance the sensitivity and precision of the detection process. The proposed system utilizes the fact that entropy based measures for the EEG segments during epileptic seizure are lower than in normal EEG. The new suggested model better tracks abrupt changes in the signal and assigns less complexity to segments that exhibit regularity or are subjected to noise effects. The Weighted Permutation Entropy algorithm relies on the ordinal pattern of the time series along with the amplitudes of its sample points. The proposed technique is implemented and tested on hundreds real EEG signals and the performance is compared based on sensitivity, specificity and accuracy. Various experiments have been applied in different scenarios including healthy with eyes open, healthy with eyes closed, epileptic patients during no-seizure state from two different location of the brain. Other scenarios have been applied accompanied by background simulated noise resulting from physiological and environmental artifacts. Results showed outstanding performance and revealed promising results in terms of discrimination of seizure and seizure-free segments. It also manifests high robustness against noise sources.

@&#INTRODUCTION@&#
Epilepsy is a common long-term neurological condition in which nerve cell activity in the brain becomes disrupted. According to the WHO [1], about 0.6% of the general population suffers from epilepsy and nearly 80% of the affected people are found in developing regions. It manifests clearly through “epileptic seizure”, a period of sudden recurrent and transient disturbances of perception or behavior resulting from excessive synchronous activity of neurons in the brain. Only two third of epileptic patients can control seizures through medications. The remaining third develop drug-resistant epilepsy and are referred for a resection surgery where seizure onset zone (SOZ) is removed. Candidates for the surgery undergo many pre-surgery investigations where the most important is the long term Electroencephalographic (EEG) monitoring to capture seizures for off-line analysis. Expert neurologists then visually inspect the collected EEG data to detect epilepsy-related activity so they can determine the area where the seizures begin, called the seizure focus, and hence conclude whether the surgery is feasible [2]. The EEG has been a very useful clinical tool; it measures the electrical activity and represents potential differences from different sites of the human brain. EEG video monitoring generates a lengthy EEG recordings data for the clinical neurophysiologists to review and analyze seizures that occurred during the monitoring period. However, locating epileptic activity in a continuous EEG recording lasting several days or weeks is an exhausting, demanding and time-consuming task because such activity represents a small percentage of the entire recording. In an earlier study [3], that included 4 human experts to mark an EEG of 8 h, it was shown that here was little variation between readers. High seizure rate, short seizure duration and long seizure durations with ambiguous offsets can complicate the analysis and result in poor correlation. These difficulties have motivated the development of automated methods that scan, identify, and then present to a neurophysiologist epochs containing epileptic events. Such systems help to overcome the limitations of the traditional visual inspection performed by expert neurologists and avoid any misreading or missing information.This paper introduces an automated seizure detection model that integrates Weighted Permutation Entropy (WPE) as input feature to a Support Vector Machine (SVM) learning model to enhance the sensitivity and precision of the detection process. WPE is a modified statistical parameter of the permutation entropy (PE) suggested by Bandt and Pompe [4]. It measures the complexity and irregularity of a time series by combining the ordinal pattern and the amplitude of its sample points. The feasibility of WPE as a feature for automated seizure detection has not been investigated so far.The paper is organized as follows: Section 2 provides a cover of some related work presented in literature. Section 3 describes the medical background of epilepsy and brain seizures onto which the work was built, while Section 4 introduces the proposed seizure detection model and the dataset used. The model validation and experiments are demonstrated in Section 5. Results and discussion are illustrated in Sections 6 and 7, respectively. Finally, conclusion and suggestions for future work are illustrated in Section 8.The automatic seizure detection system is a two stage problem; EEG recordings serve as input to a feature extraction phase, and then the features extracted are fed into a classifier. The features extraction methods exploited by researchers include; time-based features such as amplitude, duration, and sharpness [5]. Also frequency-based features such as fast Fourier transform [6], power spectral density [7]. The EEG signal being a non-stationary signal can be described by time-frequency features such as time frequency distribution [8] and wavelet analysis [9,10]. Complexity measures have been also suggested to describe the chaotic behavior of EEG, such as Lyapunov exponent [11] and fractal dimension [12]. Other nonlinear parameters include second-order difference plot and phase space representation of intrinsic mode functions [13,14]. Fractional linear prediction and Gabor filter have been also applied [15,16].The work presented in this paper focuses on entropy -based features; it utilizes the fact that the entropy of EEG seizure segments is lower than in normal EEG due to the synchronicity firing of the neurons during an epileptic seizure [17]. Among the entropy measures applied; Approximate Entropy [18]. Sample entropy [19], spectral entropy [20], permutaion entropy [21]; or a combination of more than one entropy measure [22,23]. Others combined time frequency analysis with Approximate Entropy [24]. The classification methods employed vary from naive Bayes classifiers [8], fuzzy logic classifiers [11], linear classifiers [24] but the most used in literature are Support Vector Machines [21,25] and Artificial Neural Networks [8].The role of EEG in the seizure detection process is very important compared to other approaches such as Magnetoencephalography (MEG) and functional Magnetic Resonance Imaging (fMRI) in terms of safety and cost. For an epilepsy diagnosed patient, the EEG recordings can belong to one of four categories; Pre-ictal refers to the state immediately before the actual seizure, though it has recently come to light that some of characteristics of this stage (such as visual auras) are actually the beginnings of the ictal state. Ictal refers to a physiologic state or event such as a seizure. Post-ictal refers to the state shortly after the event. Inter-ictal refers to the period between seizures characterized by electrical abnormalities known by neurologists as subclinical seizures of an epilepsy disorder. For most people with epilepsy, the inter-ictal state corresponds to more than 99% of their life.Measuring the brain activity be achieved through two methods; the non-invasive EEG implies fixing the electrodes to the subject's scalp where the electrode positions can be chosen according to the standardized 10–20 system. On other occasions, extra-cranial EEG is not efficient so and invasive approach that involves an operation under general anesthetic to place electrodes either on the surface or deep within the brain. These electrodes are attached to a video electroencephalogram (EEG) monitor and the patient is monitored continuously [26]. The electrical activity along the brain can be divided according to frequency ranges. Activity lower than 4 Hz is called delta (δ) activity. Theta (θ) activity is the range of 4–8 Hz, alpha (α) is 8–13 Hz, beta is (β) 13–30 Hz, and activity above 30 Hz is called gamma (γ) activity.The proposed model includes a data acquisition phase followed by a pre-processing phase, a phase for segmenting each EEG channel into fixed length windows, a feature extraction phase where the Weighted Permutation Entropy (WPE) is estimated for each window, and finally a classification phase where EEG records are divided into one of two clinically significant EEG classes: (1) seizure and (2) no-seizure. The procedure of the proposed SVM classification for automated epileptic seizure detection system is shown in Fig. 1.For the suggested model testing, three scenarios were applied. The first scenario implies extracting WPE values from raw EEG data after segmentation directly which requires no pre-processing of the data. A second scenario involves a pre-processing phase of applying wavelet decomposition to extract the different physiologically relevant frequency sub-bands. A third scenario that aims to test the model against signal noise requires projection of artifacts sources into the dataset first.Most of the patient's data is not generally accessible through hospitals and medical clinics for confidentiality purposes. For this reason, the experimental data used in this paper was obtained from the publically available Bonn data set “Klinik für Epileptologie, Universität Bonn’’ [27]. The dataset includes five different sets (Z, O, N, F and S). Set Z and O contain surface EEG recordings that belong to five healthy subjects in relaxing state. Set Z is recorded with subject's eyes were open while set O was recorded when subjects eyes were closed. Sets N, F, S contain intracranial recordings from depth and strip electrodes collected from five epileptic patients. Set N contains seizure-free intervals from the hippocampal formation of opposite hemisphere, set F contains seizure-free intervals from epileptogenic zone, and set S contains epileptic seizure segments from all channels. Each set contains 100 single channel EEG artifact-free segments of 23.6 s duration. All EEG signals are recorded at a sampling rate of 173.61 Hz using a 128-channel amplifier system with an average common reference, and are band-pass filtered at 0.53–40 Hz. Table 1summarizes the Bonn dataset and Fig. 2shows the first EEG record from each of the five classes available in the dataset.The WPE was originally suggested by Fadlallah et al. [28], it is a complexity measure which has aspects of both dynamical systems and entropy measures. It extends the main concept of the PE based on comparing neighboring values but at the same time incorporates the different amplitude values per each ordinal pattern. It estimates complexity as the entropy of the distribution of permutations of groups of time samples and the variance of their amplitudes. Thus, the variation of WPE as a function of time can effectively indicate the dynamic changes in any real world data. It has been shown that any continuous time series representing a dynamical system can be mapped on to symbolic sequence. According to the embedding theorem, any arbitrary time series x(t) where t = 1, 2, 3, … , T can be mapped onto `m’ dimensional space with vectors(1)Xt={xt,xt+τxt+2τ…,xt+(m−1)τ}The WPE parameters are the embedding dimension (m) representing the number of values in each sequence, and the delay time for embedding (τ) (the number of samples spanned by each section of the sequence).Each of the N = T − m + 1 sub-vector X is characterized by two properties:iThe arrangement of its components in a certain order, each considered as symbolic pattern which will be one of the m! possible permutations of `m’ distinct symbols.The amplitudes distribution of its components which represents the total weight of the sequence.The weight ωj of each sequence j can be calculated using the variance as:(2)ωj=1m∑t=1m(xj+(t+1)τ−Xj¯)2whereXj¯is the arithmetic mean of sequence j given by:(3)Xj¯=1m∑t=1mxj+(t+1)τThe probability distribution of each pattern with weight ω can be represented as:(4)Pω(πi)=∑j<N1u:type(u)=πi(Xj).ωj∑j<N1u:type(u)=π(Xj).ωjwhere∑j<N1u:type(u)=πi(Xj)defined as 1 if the pattern πiis the same as the sub-vector Xjand 0 otherwise. j is the total number of vectors for a given time series (1 < j < N), and i is the distinct number of symbols for a given embedding dimension (i ≤ m!). Note that the relation∑iPω(πi)=1still holds. According to the Shannon entropy, WPE can be computed as:(5)Hω(m,τ)=−1ln(m!)∑Pω(πi)lnPω(πi)The 1/ln(m!) is a normalization factor such that the final WPE value ranges from 0 to 1.In our analysis, feature extraction is performed using a sliding data frame (window/epoch) approach. A single WPE value is calculated for each window; any change in the dynamics of the system will be reflected in the variation of WPE with respect to moving window. For a reliable estimation of WPE, the window length Tw should be greater than m! In our analysis, each EEG channel was buffered in non-overlapping and overlapping windows of approximately 0.35 s which corresponds to 64 values per window. This results in 64 and 128 windows per channel for non-overlapping and overlapping segmentation techniques, respectively. For overlapping window segmentation, the EEG channel has a shift forward of 0.175 s corresponding to 32 values of overlap between consecutive windows.To compare the results achieved from classifying raw EEG data, wavelet transform has been used as a preprocessing phase to apply the WPE on the various frequency components of the EEG signal. The wavelet transform has the advantage of the variable window size according to the frequency band. The spectral analysis of the EEG signals through wavelet transform translates its lengthy data into few features [29,30]. Wavelet transform can represent EEG sub bands as a weighted sum of shifted and scaled versions of the original wavelet, without any loss of information and energy. In order to extract five physiological EEG bands, delta (0–4 Hz), theta (4–8 Hz), alpha (8–13 Hz), beta (13–30 Hz), and gamma (30–60 Hz), four levels discrete wavelet transform (DWT) with third-order Daubechies (db3) wavelet function have been used. Such choice of the mother wavelet is also supported by many works in literature [9,31]. Since our dataset is in range 0–60 Hz, coefficients D1, D2, D3, D4 and A4 were extracted corresponding to 30–60 Hz, 15–30 Hz, 8–15 Hz, 4–8 Hz and 0–4 Hz, respectively. Weighted Permutation Entropy is calculated for each sub-band separately and then all WPE values are fed into the classifier. Fig. 3shows a sample. EEG channel of dataset S and its decomposed frequency bands.The features extracted through the estimation of the WPE values serve as input to the classifier and a training model is built to discriminate between seizure and no-seizure intervals. In our study, the results obtained from the Support Vector Machine classifier (with both linear and non-linear kernels) are compared to the results of the Artificial Neural Network Classifier.Support Vector Machine is a supervised learning algorithm introduced in 1995 by Vapnik. The built model maps the training data into different categories separated by a decision boundary. Given a training example {xi, yi} and a class label with one of two values (yi∈ {1, −1}). The decision boundary represented by (w, b), where w is a vector containing the hyperplane parameters and b is an offset. The data is rescaled so that that anything on or above the boundary wTx + b = 1 is of one class (with label 1), and anything on or below the boundary wT x + b = −1 is of the other class (with label −1). The in-between distance is called the margin defined as2||w||2. Finding the maximal margin is equivalent to minimizing ||w|| which can be achieved through quadratic programming and the optimal hyperplane can be described by:w=∑αiyixi.However, the separation task is not always linear especially real complex classification problems, SVM then extends the data from the input space into a higher dimensional space where the data is separable. It achieves this type of mapping through kernel induced feature space. A kernel function is a function that only deals with the dot product of the data. The optimal hyperplane can be then expressed asf(x)=∑αiyiK(xi,x)+b[32].The mathematical model of the basic artificial neuron is based on three simple sets of rules: multiplication, summation and activation. The inputs are multiplied with individual weight. In the middle section of artificial neuron is a sum function that sums all weighted inputs and bias. At the exit of artificial neuron the sum of previously weighted inputs and bias is passing through activation function that is also called transfer function [33]. The output value y(k) in discrete time kcan be described mathematically as;y(k)=F(∑i=0mwi(k).xi(k)+b)wherem the total number of inputs is, xi(k) is the input value, wi(k) is the weight value, b represents the bias and F is a transfer function. Transfer function defines the properties of artificial neuron and can be any mathematical function. The classification problem to be solved defines the function to be used. Popular transfer functions include step function, linear function and non-linear sigmoid function. Combining artificial neurons constructs an Artificial Neural Network capable of solving complex real-life problems by processing information in their basic building blocks (artificial neurons).Experiments have been carried out to validate the efficiency of the proposed seizure detection system and also its capability of detection and robustness to noise. Although the data set has five different classes of EEG segments (healthy with eyes open, healthy with eyes closed, interictal state obtained from epileptic zone, interictal state obtained from hippocampus zone of brain, and ictal state). The aim of this study is to detect segments with epileptic seizure activity so the multi-class problem is reduced to a one-against-one classification, i.e. 4 different binary classification problems were formed; set Z versus set S, set O versus set S, set N versus set S and finally set F versus set S.One common measure of performance is the accuracy, incorporating both a classifier's sensitivity and specificity, defined as follows:(6)Accurcay=TP+TNTP+FN+TN+FPThe confusion matrix parameters for the seizure detection analysis can be interpreted as follows; true positive (TP): seizure events detected by both the algorithm and the expert neurologists, true negative (TN): Events identified as non-seizures by both the algorithm and the expert neurologists, false positive (FP): seizure events detected by the algorithm, but not scored by the expert, and false negative (FN): events identified as seizures by the experts but were missed by the algorithm. The sensitivity represents the number of correctly detected positive patterns/total number of actual positive patterns.The accuracy of each classifier is assessed using cross-validation with 10 folds. The data will be divided equally 10 subsets, a single subsample is retained as the test set for validating the model, and the remaining 9 subsamples are used as training data. The cross-validation process is then repeated 10 times (the folds), with each of the 10 subsets used exactly once as the validation data. The mean accuracy values are measured for both raw EEG channels (using different segmentation techniques) and also the decomposed frequency bands.Although the WPE calculation is easy and simple, an important step before extracting the features is to set the parameters (the dimension order and time lag) of the algorithm. The dimension order of WPE (m) should not be too small as this will not give enough number of distinct states. Any change in m will affect the window size of the segmentation as the window size value needs to be larger than m!. Too large values of order `m’ will demand large values of window size which will not effectively detect dynamical changes and will create memory restrictions. Optimum values of order of WPE are reported to be around 3–8 [4]. Table 2shows the set of values tested for dimension order m and the corresponding window sizes chosen and features extracted for each segmentation technique. Fig. 4shows that order dimension of value 3 has the best discrimination performance in classifying the EEG segments. The classification levels mentioned were calculated on the basis of averaging all classification accuracy for each non-seizure dataset versus dataset S.Many methods exist for the calculation of the appropriate time lag τ such as false nearest neighbor calculation and first minimum of autocorrelation function [34]. Time lag represents the number of samples spanned when dividing the time series. Different values of time lag were tested (τ = 1, τ = 2, τ = 3) and compared. As observed in Fig. 5, the highest overall classification accuracy obtained through linear Support Vector Machine when time lag was set to 1. Greater values of time lag decrease the accuracy achieved by at least 8%. Our findings with regards to the appropriate time lag are in agreement with previous studies, that in EEG processing, τ value is usually set to 1 [35,21]. It is adequate to span each and every value along the signal to extract most of the information in the EEG, hence this value is commonly chosen in EEG analysis.The data set used in this paper was visually inspected for non-cerebral origin (artifacts) and thus all EEG segments are noise free. However the EEG data acquisition process is usually accompanied by many noise sources [36]. For real-time classification, the proposed model must show enough classification sensitivity to noisy EEG segments.To be accurate, a solution must distinguish seizure signal from those caused by the activity of artifacts whose spectral domain often overlaps that of seizures. EEG artifacts can be divided into two categories; physiological artifacts and environmental. Physiological artifacts arise from the patient himself and it includes cardiogenic activity, eye movement such as blinking, and muscle artifacts such as perspiration. Environmental or extra-physiological artifacts include external electrical interference from other power sources, electrode pop, instrumental disorder and non-symmetrical electrode placement. To simulate real EEG segments, a noise was added to raw EEG data of the five data sets in this experiment before the segmentation stage even begins. The procedure for creating artifacts was derived from [37].Eye blinks and muscle artifacts were simulated using random noise band-pass filtered (FIR) between 1–3 Hz and 20–60 Hz, respectively and added to a random number of channels for each dataset (range 20–45). Electrical shift artifacts are implemented through discontinuities and unfiltered linear trends at other randomly selected channels (range 0–5). Fig. 6shows the simulated artifacts and samples of the contaminated EEG channel from the datasets.

@&#CONCLUSIONS@&#
