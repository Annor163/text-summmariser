@&#MAIN-TITLE@&#
Multi-period mean-variance portfolio selection with stochastic interest rate and uncontrollable liability

@&#HIGHLIGHTS@&#
Study a multi-period portfolio selection problem with a stochastic interest rate.Extend the model formulation further to include an uncontrollable liability.Derive analytical expressions of the efficient strategy and efficient frontier.Investigate solution properties and their implications.Reveal prominent economic features of the derived investment policies.

@&#KEYPHRASES@&#
Stochastic interest rate,Multi-period mean-variance portfolio selection,Uncontrollable liability,Dynamic programming,Lagrangian duality,

@&#ABSTRACT@&#
While the literature on dynamic portfolio selection with stochastic interest rates only confines its investigation to the continuous-time setting up to now, this paper studies a multi-period mean-variance portfolio selection problem with a stochastic interest rate, where the movement of the interest rate is governed by the discrete-time Vasicek model. Invoking dynamic programming approach and the Lagrange duality theory, we derive the analytical expressions for both the efficient investment strategy and the efficient mean-variance frontier of the model formulation. We then extend our model to the situation with an uncontrollable liability.

@&#INTRODUCTION@&#
As we have often experienced in our real life, interest rate does change unexpectedly sometimes. For example, the global financial crisis ignited by the American Subprime Crisis in 2007 forced the world’s central banks cutting interest rates considerably. The global marketization of the interest rate contributes to more frequent and more violent fluctuations in interest rates worldwide. Hence, a consensus has been formed for quite a long time to model the interest rate as a stochastic process, and, of course, to consider a stochastic interest rate as one of the important uncertain factors in investment. The recent years have witnessed several research works in investigating the optimal portfolio selection problem with a stochastic interest rate. Using the martingale approach, Lioui and Poncet (2001) investigate an optimal portfolio selection problem with stochastic interest rates, where an investor maximizes the expected utility of the terminal wealth under a continuous-time setting. Korn and Kraft (2002) adopt a stochastic control approach to consider the optimal investment problem with a stochastic interest rate under a power utility maximization framework, where the interest rate follows a Vasicek and Ho-Lee model. Under a continuous-time CRRA utility maximization framework, Deelstra, Grasselli, and Koehl (2003) study the optimal investment strategies for a Defined Contribution (DC) pension fund in the presence of a minimum guarantee, where the stochastic interest rate is assumed to follow affine dynamics, including the Cox–Ingersoll–Ross (CIR) model and the Vasicek model. By maximizing the expected utility, Munk and Sørensen (2004) consider the optimal investment-consumption strategy by using a martingale method; Munk and Sørensen (2010) further study the case with stochastic income and interest rates. Using a stochastic optimal control method, Gao (2008) studies the optimal investment problem with stochastic interest rates for a defined benefit (DB) pension fund manager who wants to maximize the expected utility of the terminal wealth. Under continuous time mean-variance criterion, Ferland and Watier (2010) analyze the portfolio selection problem with CIR stochastic interest rate. Based on a utility maximization formulation, Shen and Siu (2012) investigate an optimal asset allocation problem in a Markovian regime-switching financial market with a stochastic interest rate. For more discussions on portfolio selection with stochastic interest rates, please refer to Hainaut (2009), Josa-Fombellida and Rincón-Zapatero (2010), and Noh and Kim (2011).However, all the above cited research works on dynamic portfolio selection with stochastic interests have been limited to the case of continuous-time. Furthermore, the existing literature on portfolio selection with stochastic interests has confined itself under the expected utility maximization framework whose abstract nature makes it hard to be appreciated by investors. In the real world, the portfolio strategies can be only implemented in a manner of discrete-time, since investors can only rebalance their positions from time to time. To the best of our knowledge, portfolio selection problem with stochastic interest rates in a discrete-time setting has not yet been considered in the literature. This paper attempts to fill up this gap in the literature. In this paper, we will study a multi-period portfolio selection problem with a stochastic interest under a mean-variance framework, where the interest rate is described by a discrete-time version of the Vasicek model. The mean-variance portfolio selection formulation proposed by Markowitz (1952) is the cornerstone of the modern finance theory and is appealing to investors due to its clear definition of investment risk. In the mean-variance model, the return is measured by the mean of the terminal wealth, the risk is measured by the variance of the terminal wealth, and an investor allocates assets in the financial market so as to achieve the optimal trade-off between the return and the risk. Inspired by the pioneering work of Markowitz (1952) and its wide success in real investment practice, the past 60 years have witnessed numerous extensions of the mean-variance portfolio selection framework (see, e.g., Li and Ng (2000), Zhou and Li (2000), Li, Zhou, and Lim (2002), Bielecki, Jin, Pliska, and Zhou (2005), Fu, Lari-Lavassani, and Li (2010), Chiu and Wong (2011), Cui, Gao, Li, and Li (2014), etc.).On the other hand, liability is also an important factor to consider in many real-world situations. Thus, an incorporation of the liability into a portfolio selection model will evidently extend the mean-variance formulation to a more practical setting, which has been referred as asset-liability management (ALM) problem. ALM has been extensively applied to banks, pension funds and insurance companies. In ALM, the main concern is the surplus which is the difference between the asset value and the liability value. Accordingly, ALM is also known as surplus management. ALM was first studied by Sharpe and Tint (1990) in a static mean-variance model. In recent years, along with the breakthrough and progress in solving dynamic mean-variance formulations, many scholars adopt the dynamic mean-variance model to study the ALM problem. Leippold, Trojani, and Vanini (2004), for the first time, consider an ALM problem under multi-period mean-variance criterion by using a geometric approach, in which the liabilities are considered to be uncontrollable. Yi, Li, and Li (2008) and Chen and Yang (2011) extend the work of Leippold et al. (2004) to the cases with an uncertain time horizon and in a regime switching market, respectively. Li and Li (2012) investigate a multi-period ALM problem with bankruptcy control under a mean-variance framework. Using mean-variance criterion, Chiu and Li (2006), Xie, Li, and Wang (2008), Chen, Yang, and Yin (2008), and Xie (2009) consider the ALM problems with uncontrollable liabilities in continuous-time settings. For more discussion on the subject of ALM under dynamic mean-variance model, please refer to Leippold, Trojani, and Vanini (2011), Chiu and Wong (2012), and Yao, Lai, and Hao (2013), Yao, Lai, and Li (2013).We start our analysis from the no-liability case. Then, following the spirit of Leippold et al. (2004) and Yi et al. (2008), we add uncontrollable liability into the model. From the view point of mathematical modeling, considering stochastic interest rate and random liability factors would add two new state variables, i.e., the interest rate and liability, to the model. Note that the interest rate at the current time period is observed, which makes impossible to deal with the stochastic interest rate in the same way as for the stocks whose return in the current stage will be realized only in the end of the current time period or in the beginning of the next time period. The dimension enlargement in the state space drastically raises up the difficulty level in solving the corresponding Bellman equation which comes from the dynamic programming principle, which makes the model studied in this paper a substantial extension of Li and Ng (2000) which has a one-dimensional state space. We combine the Lagrange dual approach and the dynamic programming method in this paper to conquer this challenge, and derive both the efficient investment strategy and the efficient mean-variance frontier explicitly.The remaining of this paper is organized as follows. We describe in Section 2 the market setting for our problem, and set up the multi-period mean-variance portfolio selection formulation in the no-liability case. In Section 3, we translate the original problem into its Lagrangian relaxation problem, which is a standard stochastic optimal control problem, and derive the corresponding analytical solution by the dynamic programming approach. We then obtain close form expressions for the efficient strategy and the efficient mean-variance frontier in Section 4 by applying Lagrange duality. We discuss some special cases in Section 5. In Section 6, we further incorporate the uncontrollable liability into the model and derive the corresponding optimal strategy. In Section 7, we illustrate our results obtained in this paper via some numerical examples. We finally conclude our paper in Section 8. To help readers follow the main story line of our paper, we place all the proofs for the propositions and theorems in Appendix B of this paper, while we present five lemmas in Appendix A which are used in the proofs in Appendix B.In a time horizon with T time periods, we consider a financial market composed ofn+1assets, including one cash account (instantaneous risk-free asset) labeled as asset 0 and n stocks (risky assets) labeled as assets1,…,n. Note that the time period can be any time unit in accordance with the given specific application. Denote by Rkthe (gross) return of the cash account (namely, the gross interest rate) over period k (i.e., the time interval from time k to timek+1)fork=0,1,…,T−1. LetPkibe the excess return (i.e., the risk premium) of the ith stock over the interest rate during period k. Then, the return of the ith stock over period k isRk+Pkifori=1,2,…,nandk=0,1,…,T−1. Suppose that an investor enters the market at time 0 with initial wealth x0 > 0. Denote by xkandukithe wealth held by the investor and the amount invested in the ith stock (i=1,2,…,n)at time k, respectively. Then the amount deposited in the riskless account at time k isxk−∑i=1nuki. We assume that transactions are carried out at the beginning of every time period with no transaction cost or tax charged. Thus, the dynamics of the wealth process follows the following stochastic process,(1)xk+1=(xk−∑i=1nuki)Rk+∑i=1nuki(Rk+Pki)=xkRk+∑i=1nukiPki=xkRk+Pk′uk,wherePk=(Pk1,Pk2,…,Pkn)′,uk=(uk1,uk2,…,ukn)′,and A′ denotes the transpose of A which could be either a matrix or a vector.In reality, while the current interest rate is known (deterministic), the future interest rate could be uncertain (stochastic). Thus, we assume in our mathematical model that Rkis known at time k, and Rs(s > k) is stochastic. The Vasicek model proposed by Vasicek (1977) is one of the most commonly used stochastic interest rate models in the literature. In a continuous-time setting, the Vasicek stochastic interest rate model can be described as follows:(2)drt=ϑt(r¯−rt)dt+σtdwt,where rtis the instantaneous interest rate at time t, wtis a standard Brownian motion, and ϑt,r¯and σtare three deterministic parameters. More specifically,r¯describes the long-run mean of the interest rate, ϑtdescribes the degree of mean reversion, and σtis the interest rate volatility.As Rkis the gross interest rate, we suppose in this paper that Rk> 0 for allk=0,1,…,T−1. Letrk=lnRk. Then,Rk=erk. According to the continuous-time Vasicek stochastic interest rate model in (2), we consider in this paper the following discrete time (multi-period) version of Vasicek stochastic interest rate model,(3)rk+1=rk+(1−φk)(r¯−rk)+σkɛk,k=0,1,…,T−1,whereφk=1−ϑkwith 0 < φk≤ 1, σkis a constant, and the expectation and the variance of {εk} satisfyE[ɛk]=0andVar[ɛk]=1. We point out that in this paper we need not assume that εkobeys a normal distribution. Sincerk=lnRk,by (3) we havelnRk+1=φklnRk+(1−φk)r¯+σkɛk. Therefore, it follows that(4)Rk+1=Rkφke(1−φk)r¯+σkɛk=bkRkφk,k=0,1,…,T−2,where(5)bk=e(1−φk)r¯+σkɛk>0.Let ℘kbe the information set up to time k. Thus, at time k, the current interest rate Rkis ℘kmeasurable (known at time k), while the future interest rates, Rs(s > k), remain random. On the other hand, the returns of n risky assets over period k (the time interval from time k to time k + 1) are random at time k, as they are only℘k+1measurable (realized at timek+1). Therefore, the instantaneous risk-free asset cannot be simply treated as a risky asset (stock). In summary, we need to take both the current wealth, xk, and the current interest rate, Rk, as the state variables in our formulation. Therefore, our proposed model with stochastic interest cannot be considered as a special case of the multi-period mean-variance portfolio selection model with only risky assets (stocks) in Li and Ng (2000), which involves only a scalar state variable (the current wealth level).Remark 1We only need to assume that R0 > 0, which in turn ensures the satisfaction of our assumption that Rk> 0 for allk=0,1,…,T−1,from (4) and (5).In our model, σkand φkcan be time variant (time k-dependent). Compared with the time invariant case where σkand φkare constants, our model would be more flexible. Generally speaking, although the interest rate is stochastic, it does not change at the same rapid pace as the return of stocks. In the case where the interest rate is not expected to change over period k, we can setσk=0andφk=1. Then, by (4) and (5), we havebk=e0=1andRk+1=Rk.Throughout this paper, for two symmetric matrices M and N with the same dimension, we denote M≻N(M≽N) ifM−Nis positive definite (semidefinite). Especially, we denote by M≻0(M≽0) if M is positive definite (semidefinite). Similar to the most existing literature, we make the following assumptions in this paper.Assumption 1Var[Pk]=E[(Pk−E[Pk])(Pk−E[Pk])′]≻0,i.e., Var[Pk] is positive definite fork=0,1,…,T−1.Random seriesΥk=(Pk′,ɛk)are statistically independent fork=0,1,…,T−1,i.e., Υiand Υjare independent for i ≠ j.E[bkψk+1Pk]≠0→nfor allk=0,1,…,T−1,where0→nis the n-dimensional zero vector.SinceE[PkPk′]=Var[Pk]+E[Pk]E[Pk′]andE[Pk]E[Pk′]≽0,Assumption 1 implies thatE[PkPk′]≻0fork=0,1,…,T−1.An investment strategyu={uk;k=0,1,…,T−1}is called an admissible strategy, if ukis finite and progressively measurable with respect to information set ℘kfork=0,1,…,T−1. Denote by Ω(xk, Rk) the set of all such admissible investment strategies starting from time k to time T with the initial state vector, (xk, Rk).The multi-period mean-variance portfolio selection problem refers to the problem of finding the optimal admissible investment strategy such that the variance of the terminal wealth is minimized for a given expected terminal wealth level d. With the Vasicek stochastic interest rate taken into the consideration, the multi-period mean-variance portfolio selection problem can be formulated as(6){minu∈Ω(x0,R0)Var[xT]=E[xT−d]2s.t.E[xT]=d,StatevariablesxkandRksatisfy(1)and(4).For anyd≥dσmin,we call the optimal solutionu*={uk*;k=0,1,…,T−1}of Problem (6) an efficient investment strategy, wheredσminis the expected terminal wealth corresponding to the global minimum variance of the terminal wealth over all feasible strategies. Let Var*[xT] be the corresponding minimum value of Problem (6), then the point (Var*[xT], d) is called a mean-variance efficient point ford≥dσmin. The set of all such efficient points is called the mean-variance efficient frontier.Introducing Lagrange multiplier 2γ to the equality constraintE[xT]=dyields the following Lagrangian relaxation problem,(7)minu∈Ω(x0,R0){E[xT−d]2+2γ(E[xT]−d)},s.t.(1)and(4).Since(8)E[xT−d]2+2γ(E[xT]−d)=E[xT2+2axT]−d2−2ad,wherea=γ−d,Problem (7) is equivalent to the following optimization problem,(9)minu∈Ω(x0,R0)E[xT2+2axT],s.t.(1)and(4).Define the optimal value function of Problem (9) at time k with wealthxk=xand gross interest rateRk=R>0as follows:fk(x,R)=minu∈Ω(x,R)E[xT2+2axT|xk=x,Rk=R],s.t.(1)and(4).Applying the optimality principle of dynamic programming gives rise to the following Bellman equation of Problem (9):(10){fk(x,R)=minukE[fk+1(xR+Pk′uk,bkRφk)],fT(x,R)=x2+2ax.Carrying out this backward recursion up tok=0,we obtain f0(x0, R0) as the optimal value of Problem (9), and, furthermore,f0(x0,R0)−d2−2adas the optimal value of Problem (7).To derive the analytical expression for fk(x, R), we construct the following four backward time sequences, ψk, wk, λkand αk(k=T,T−1,…,0),(11){ψk=1+φkψk+1,wk=wk+1Dk,λk=λk+1Ck,αk=αk+1−λk+124wk+1(1−Gk),with boundary conditionsψT=0,wT=1,λT=2andαT=0,where(12){Dk=E[bk2ψk+1]−E[bk2ψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bk2ψk+1Pk],Ck=E[bkψk+1]−E[bk2ψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk],Gk=1−E[bkψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk].In the above expression,E−1[bk2ψk+1PkPk′]means(E[bk2ψk+1PkPk′])−1. Note that all Dk, Ckand Gkdepend onψk+1. Thus, in the computational process, we should first compute the value of ψkfor allk=T,T−1,…,0,by using (11) (or by (15)). We then compute the values for Dk, Ckand Gkby (12), and finally compute the values for wk, λkand αkby (11).For convenience, let(13)Hk=(1Pk),Lk=(1bkψk+1Pk),Qk=bkψk+1Hk.Proposition 1E[bk2ψk+1PkPk′],E[HkHk′]andE[QkQk′]are all positive definite fork=0,1,…,T−1.In the following, we present some properties regarding Dk, Ckand Gk.Proposition 2Fork=0,1,…,T−1,we have(14){Dk=|E[QkQk′]||E[bk2ψk+1PkPk′]|−1,Ck=|E[QkLk′]||E[bk2ψk+1PkPk′]|−1,Gk=|E[LkLk′]||E[bk2ψk+1PkPk′]|−1.For anyk=0,1,…,T−1,we have Dk> 0, 0 ≤ Gk< 1 andCk2≤DkGk<Dk.For convenience, we define∏i=kk−1(·)=1and∑i=kk−1(·)=0fork=0,1,…,T. For given boundary conditions of ψk, wk, λkand αkin (11), the backward recursions generate the following four time sequences.Proposition 4For allk=0,1,…,T,we have(15){ψk=∑i=kT−1∏j=ki−1φj,wk=∏i=kT−1Di>0,λk=2∏i=kT−1Ci,αk=−∑i=kT−1(1−Gi)∏j=i+1T−1Cj2Dj.Based on the above preliminary results, we are now in a position to state and prove the main results of this paper.Theorem 1Fork=0,1,…,T−1,the optimal value function of Problem(9)is given by(16)fk(x,R)=wkx2R2ψk+λkaxRψk+αka2,and the corresponding optimal investment strategy is given by(17)uk*=−E−1[bk2ψk+1PkPk′](xRE[bk2ψk+1Pk]+12R−φkψk+1aλk+1wk+1E[bkψk+1Pk]),where ψk, wk, λk and αk are defined in(11)or(15).It is interesting to note from (17) that one state variable, the current wealth level, x appears linearly in the portfolio policy, the other state variable, the current interest rate, R appears nonlinearly in the portfolio policy, firstly in a product form of the two state variables and secondly in a quotient form, and the randomness of the interest rate featured by bkand the randomness of the stocks characterized by Pkare coupled with each other affecting together the portfolio policy.As we have already derived in Theorem 1 thatf0(x0,R0)=w0x02R2ψ0+λ0ax0Rψ0+α0a2,we know that the optimal value of Problem (7) is given byV(x0,R0,γ)=f0(x0,R0)−d2−2ad=w0x02R02ψ0+λ0ax0R0ψ0+α0a2−d2−2ad,wherea=γ−d.According to the Lagrange duality theory (see Luenberger, 1968), the optimal value for the original mean-variance Problem (6), namely the minimum variance Var*[xT], can be obtained by maximizing V(x0, R0, γ) over γ, which is equivalent to maximizingV(x0,R0,a+d)over a asa=γ−d,(18)Var*[xT]=maxaV(x0,R0,a+d)=maxa{α0a2+(λ0x0−2d)a+w0x02R02ψ0−d2}.We first give the following proposition to show both the existence and uniqueness of a solution to Problem (18).Proposition 5For allk=0,1,…,T−1,we have (i)0>αk≥−1+λk24wk≥−1; and (ii)αk=−1+λk24wkif and only ifCj2Dj=Gjforj=k,k+1,…,T−1.Proposition 5 shows that α0 < 0. Therefore, there exists a unique optimal solution to Problem (18), which can be obtained by the first-order condition,(19)a*=2d−λ0x0R0ψ02α0.Substituting (19) into (17) and noticing thatx=xkandR=Rk,we can now express the optimal investment strategy to the mean-variance model (6) as(20)uk*(xk,Rk)=−E−1[bk2ψk+1PkPk′]×(xkRkE[bk2ψk+1Pk]+Rk−φkψk+1×(2d−λ0x0R0ψ0)λk+14α0wk+1E[bkψk+1Pk]).Substituting (19) into (18), we also obtain the minimum variance boundary of the mean-variance model (6) as follows:Var*[xT]={−λ0x0R0ψ0d+(w0+λ024)x02R02ψ0,α0=−1,−1+α0α0(d−λ0x0R0ψ02(1+α0))2+(w0−λ024(1+α0))x02R02ψ0,α0≠−1.For any real number d, we should have Var*[xT] ≥ 0. So, we can exclude the case ofα0=−1. Thus, the minimum variance is(21)Var*[xT]=−1+α0α0(d−λ0x0R0ψ02(1+α0))2+(w0−λ024(1+α0))x02R02ψ0.We have excluded the case ofα0=−1,which, together with Proposition 5, yields−1<α0<0. Then it follows that−1+α0α0>0. Therefore, settingd=dσmin:=λ0x0R0ψ02(1+α0),we can obtain the global minimum variance as(22)Varmin*[xT]:=(w0−λ024(1+α0))x02R02ψ0.Proposition 5 shows that−1+λ024w0≤α0,that is,w0−λ024(1+α0)≥0. Therefore we have that the global minimum varianceVarmin*[xT]≥0.Obviously, rational investors should not select the expected terminal wealth less thandσmin. We summarize the above results in the following theorem.Theorem 2For given expected terminal wealthE[xT]=d(d≥dσmin),the efficient investment strategy and the efficient frontier of the multi-period mean-variance portfolio problem(11)with stochastic interest rates are given by(20)and(21), respectively.Let(23)ζk=E−1[bk2ψk+1PkPk′]E[bk2ψk+1Pk],πk=E−1[bk2ψk+1PkPk′]E[bkψk+1Pk].Then, the optimal investment strategy (20) can be rewritten as the following compact form,(24)uk*(xk,Rk)=−xkRkζk−Rk−φkψk+1(2d−λ0x0R0ψ0)λk+14α0wk+1πk.Eq. (24) reveals a property of “two fund theorem” in the optimal strategy. We can viewζ˜k=ζk1′ζkandπ˜k=πk1′πkas two mutual funds, where1is the n dimensional all-one vector. Thus, the optimal investment is a summation of two portfolios, one is proportional toζ˜k,and the other is proportional toπ˜k. Furthermore, there is a property of separability in the following sense: While the product of the two current states, xkRk, determines the investment amount inζ˜k,the initial wealth, x0, and the investor’s risk attitude dictated by the expected final wealth level d only affects the investment amount inπ˜k(although the current Rkalso plays a role). Thus, in a market consisting of one riskless asset and n risky assets, all investors only need to strike a balance among the riskless asset and the two “artificial” mutual fundsζ˜kandπ˜k,according to his initial wealth, his risk attitude, his current wealth level and the current interest rate level. We point out that there also exists a type of two-fund theorem in continuous-time portfolio selection frameworks with stochastic interests, see, for example, Munk and Sørensen (2004) and Ferland and Watier (2010).Letχk=E−1[PkPk′]E[Pk]andχ˜k=χk1′χk. Note that, when the interest rate is deterministic, bothζ˜kandπ˜kreduce toχ˜k,leading to the well-known one-fund theorem in the conventional dynamic portfolio selection problem with deterministic interest rate (see Li and Ng (2000) for more details). The above assertion also holds true when the stochastic interest rate is uncorrelated with all the risky assets, i.e., bkis uncorrelated with Pk. In other words, when the stochastic interest rate is uncorrelated with all the risky assets, the optimal portfoliouk*(xk,Rk)is proportional toχ˜k(see Section 5 for more details).Although there exists an instantaneous risk-free asset (cash account) in the market, we cannot guarantee that−1+λ024w0=α0due to the randomness of the interest rate. Namely, the inequality−1+λ024w0≤α0may be strict. So the global minimum variance of the terminal wealth can still be strictly greater than zero. In this case the efficient frontier is no longer a straight line, but a hyperbola in the standard deviation-mean plane, which is different from the case with a determinate interest rate (see Li & Ng, 2000). However, under some conditions the risk incurred by a stochastic interest rate can also be hedged completely. The following theorem gives a necessary and sufficient condition under which the global minimum variance is 0. Letσ*[x(T)]=Var*[x(T)]denote the standard derivation of the terminal wealth.Theorem 3The global minimum variance is 0 if and only ifCi2Di=Gifor alli=0,1,…,T−1,and in such a case, the efficient frontier is given by(25)E[xT]=x0R0ψ0∏i=0T−1DiCi+σ*[xT]∏i=0T−1DiCi2−1,which is a straight line in the standard derivation-mean plane.An intuitive explanation for the conditionsCi2Di=Gifor alli=0,1,…,T−1is that there exists a completely linear correlation among the stochastic interest rate and the risky assets over each period.In order to show the impacts of the stochastic interest rate on both the efficient strategy and the mean-variance efficient frontier, we discuss in this section some special cases of our model and demonstrate the corresponding simplified results in such cases.Special case 1: We assume that the interest rate is independent of excess returns of the stocks. Mathematically, in such a case, εkis statistically independent of Pk,k=0,1,…,T−1,andbkψk+1=e(1−φk)r¯ψk+1+ψk+1σkɛkis also statistically independent of Pk. So we haveE[bk2ψk+1Pk]=E[bk2ψk+1]E[Pk],E[bk2ψk+1PkPk′]=E[bk2ψk+1]E[PkPk′].According to (12) and (15), it follows that(26){Dk=E[bk2ψk+1](1−Bk),Ck=E[bkψk+1](1−Bk),Gk=1−E2[bkψk+1]E−1[bk2ψk+1]Bk,Bk=E[Pk′]E−1[PkPk′]E[Pk],(27){wk=∏i=kT−1E[bi2ψi+1](1−Bi),λk=2∏i=kT−1E[biψi+1](1−Bi),αk=−∑i=kT−1E2[biψi+1]E[bi2ψi+1]Bi∏j=i+1T−1E2[bjψj+1]E[bj2ψj+1](1−Bj),while ψkis still given by (15). Furthermore, the efficient investment strategy can be simplified to the following form in such a special case,(28)uk*(xk,Rk)=−(xkRk+Rk−φkψk+1(2d−λ0x0R0ψ0)λk+14α0wk+1E[bkψk+1]E[bk2ψk+1])χk,whereχk=E−1[PkPk′]E[Pk],while the efficient frontier is still given by (21). We can conclude from (28) that the efficient investment strategy is proportional toχk. Thus, the “one fund theorem” holds true in such a special case. This finding implies that the correlation between the interest rate uncertainty and the risky assets is the hidden reason behind the transition from the one-fund property to the two-fund property in the optimal investment strategy.From the classical paper of Li and Ng (2000), with some modification, we can find that the optimal strategy with deterministic interest rate is stated as follows (see page 398 of Li & Ng (2000)):(29)uk*(xk)=−(skxk+(∏i=k+1T−1si)−1(∏i=0T−1(1−Bi))(∏i=0T−1si)x0−d(1−∏i=0T−1(1−Bi)))χk,where skis the deterministic interest rate over period k (k=0,1,…,T−1),and other notations are the same as these in this paper.Comparing (29) and (28), we can find some relationships and differences between these two efficient investment strategies. First, they are both proportional toχk(=E−1[PkPk′]E[Pk]),namely, the one fund theorem holds true in both efficient investment strategies (28) and (29). Second, the product term xkRkin (28) is exactly the same as stxtin (29), the termRk−ϕkψk+1in (28) corresponds to(∏k=t+1T−1sk)−1in (29), which can be understood as the (expected) discount rate from time T tot+1,the termR0ψ0in (28) corresponds to∏k=0T−1skin (29), α0 corresponds to(∏i=0T−1(1−Bi)−1)and λ0 corresponds to2∏i=0T−1(1−Bi)(it would be even clearer when reading (37) ). Third, one of the differences between efficient investment strategies (28) and (29) is that, there is a modified factorλk+1E[bkψk+1]2wk+1E[bk2ψk+1]in the second term of (28).Special case 2: We assume thatσk=0for allk=0,1,…,T−1,which leads tobkψk+1=e(1−φk)r¯ψk+1,which is deterministic. Then the interest rate is also deterministic, and we thus haveE[bk2ψk+1Pk]=e2(1−φk)r¯ψk+1E[Pk],E[bk2ψk+1PkPk′]=e2(1−φk)r¯ψk+1E[PkPk′].Thus, (26) and (27) can be further rewritten as(30)Dk=e2ψk+1(1−φk)r¯(1−Bk),Ck=eψk+1(1−φk)r¯(1−Bk),Gk=1−Bk,and(31){wk=∏i=kT−1e2ψi+1(1−φi)r¯(1−Bi),λk=2∏i=kT−1eψi+1(1−φi)r¯(1−Bi),αk=−∑i=kT−1Bi∏j=i+1T−1(1−Bj)=∏i=kT−1(1−Bi)−1,where ψkand Bkare given by (15) and (26) respectively. In this case, the efficient investment strategy can be simplified to(32)uk*(xk,Rk)=−(xkRk+Rk−φkψk+1(2d−λ0x0R0ψ0)λk+14α0wk+1e−ψk+1(1−φk)r¯)χk.As Special case 2 is a special case of Special case 1, the “one fund theorem” holds true in Special case 2 and its comparisons with the efficient investment policy of Li and Ng (2000) are also similar to those in “Special case 1”.Substituting (31) into (21), we obtain the efficient frontier as(33)Var*[xT]=∏i=0T−1(1−Bi)1−∏i=0T−1(1−Bi)(d−x0R0ψ0∏i=0T−1eψi+1(1−φi)r¯)2.In this case, the global minimum variance is 0, and the efficient frontier is a straight line in the standard derivation-mean plane. This is consistent with the results in Li and Ng (2000), where the efficient frontier is given by(34)Var*[xT]=∏i=0T−1(1−Bi)1−∏i=0T−1(1−Bi)(d−x0∏i=0T−1si)2.In order to show relationship and difference between the efficient frontier (33) and the efficient frontier (34), we first give the following proposition.Proposition 6Whenσk=0fork=0,1,…,T−1,we have(35)R0ψ0∏i=0T−1eψi+1(1−ϕi)r¯=∏i=0T−1Ri.Since both skand Rkdenote the deterministic interest rate over period k, Proposition 6 shows that the efficient frontiers in (33) and (34) are exactly the same. The difference between the efficient frontier in this special case and the efficient frontier in Li and Ng (2000) is that, the interest rate skin Li and Ng (2000) is exogenous constant, while the interest rate Rkin this special case is an endogenous variable defined by (4) withσk=0and∏i=0T−1Rican be expressed in terms of R0 and market parametersr¯and ϕk,22By (15),ψk+1can be expressed in terms ofϕi,i=k,k+1,…,T−2.k=0,1,…,T−1.Special case 3: We assume thatσk=0andφk=1for allk=0,1,…,T−1. According to Remark 2, in this case,bk=e0=1,andRT=RT−1=⋯=R0. Therefore, we have(36)E[bk2ψk+1Pk]=E[Pk],E[bk2ψk+1PkPk′]=E[PkPk′],Ck=Dk=Gk=1−Bk,(37)ψk=T−k,wk=∏i=kT−1(1−Bi),λk=2wk,αk=∏i=kT−1(1−Bi)−1.Furthermore, the efficient investment strategy can be further simplified as(38)uk*(xk,Rk)=−(xkRk+Rk−(T−k−1)(x0R0T∏i=0T−1(1−Bi)−d)(1−∏i=0T−1(1−Bi)))χk.Substituting (37) into (21), we obtain the efficient frontier as(39)Var*[xT]=∏i=0T−1(1−Bi)1−∏i=0T−1(1−Bi)(d−x0R0T)2.Because in this caseRT=RT−1=⋯=R0,we have∏i=0T−1Ri=R0Tand∏i=k+1T−1Ri=RkT−k−1. So Special case 3 is also a special case of Li and Ng (2000) whensT=sT−1=⋯=s0=R0.In this section, we extend our previous results in Sections 2–4 to the case with additional uncontrollable liability. Suppose that an investor not only needs to consider his/her investment strategy, but also needs to consider the impact of his/her uncontrollable liability. This kind of problem is referred to as asset-liability management (ALM) problem. Let lkbe the liability of the investor at the beginning of the kth period. We consider the following dynamics of the liability which is similar to the model setting in Leippold et al. (2004),(40)lk+1=qklk,where qkis an exogenous random variable, which can be understood as the random growth rate of liability. All other settings in the market remain the same as those in Section 2.The ALM problem with stochastic interest rate under the multi-period mean-variance framework is to find the optimal admissible strategy to minimize the variance of the final surplusST=xT−lTfor given expected final surplus d, i.e.,(41)minu∈Ω(x0,R0,l0)Var[ST]=E[ST2]−d2,s.t.E[ST]=d,(1),(4)and(40).Similar to the case without liability in Section 3, we can introduce a Lagrange multiplier 2a, and turn to solve the following dynamic optimization problem(42)minu∈Ω(x0,R0,l0){E[ST2]−d2+2a(E[ST]−d)},s.t.(1),(4)and(40).SinceE[ST2]−d2+2a(E[ST]−d)=E[xT2+2axT−2xTlT+lT2−2alT]−d2−2ad,Problem (42) is equivalent to(43)minu∈Ω(x0,R0,l0)E[xT2+2axT−2xTlT+lT2−2alT],s.t.(1),(4)and(40).Note that in Problem (43), the state space is three dimensional, which includes the current wealth level, the current interest rate and the current liability level. Letf˜k(x,R,l)denote the optimal value function associated with Problem (43) starting from time k with initial statexk=x,Rk=Randlk=l. Mathematically,f˜k(x,R,l)can be expressed as{f˜k(x,R,l)=minu∈Ω(x,R)E[xT2+2axT−2xTlT+lT2−2alT|xk=x,Rk=R,lk=l],s.t.(1),(4)and(40).Then, applying the dynamic programming principle gives rise to the following Bellman equation of Problem (43):(44){f˜k(x,R,l)=minuk∈ΘkE[f˜k+1(xR+Pk′uk,bkRφk,qkl)],f˜T(x,R,l)=x2+2ax−2xl+l2−2al.We now construct the following three sequences ϖk, ηkand θk(k=0,1,…,T)by backward recursions with given boundary conditions at terminal time T,(45){ϖk=ϖk+1(E[bkψk+1qk]−Fk),ϖT=−2,ηk=ηk+1E[qk2]−14ϖk+12wk+1Jk,ηT=1,θk=θk+1E[qk]−12ϖk+1λk+1wk+1Fk,θT=−2,where,ψk+1,wk+1andλk+1are defined in (11) and(46){Fk=E[bk2ψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1qkPk],Jk=E[bkψk+1qkPk′]E−1[bk2ψk+1PkPk′]E[bkψk+1qkPk].Solving (45) yields the explicit expressions for ϖk, ηkand θkin the following proposition.Proposition 7Fork=0,1,…,T,we have(47){ϖk=−2∏i=kT−1(E[biψi+1qi]−Fi),ηk=∏i=kT−1E[qi2]−14∑i=kT−1ϖi+12wi+1Ji∏j=ki−1E[qj2],θk=−2∏i=kT−1E[qi]−12∑i=kT−1ϖi+1λi+1wi+1Fi∏j=ki−1E[qj].Similar to Theorem 1, we have the following theorem.Theorem 4Fork=0,1,…,T−1,the optimal value function of Problem(42)is given by(48)f˜k(x,R,l)=wkx2R2ψk+λkaxRψk+αka2+ϖkxRψkl+ηkl2+θkal,and the corresponding optimal investment strategy can be expressed as(49)u˜k*=−E−1[bk2ψk+1PkPk′](xRE[bk2ψk+1Pk]+12R−φkψk+1×(aλk+1wk+1E[bkψk+1Pk]+lϖk+1wk+1E[bkψk+1qkPk]),where ψk, wk, λk and αk are defined in(11), and ϖk, ηk and θk are defined in(45).According to Theorem 4, the optimal value of Problem (42) is given byV˜(x0,R0,a)=f˜0(x0,R0)−d2−2ad=w0x02R02ψ0+λ0ax0R0ψ0+α0a2+ϖ0x0Rψ0l0+η0l02+θ0al0−d2−2ad.From the Lagrange duality theory, the optimal value for the mean-variance ALM problem (41) can be obtained by maximizingV˜(x0,R0,a)over a, i.e.,(50)Var*[ST]=maxaV˜(x0,R0,a)=maxa{α0a2+(λ0x0R0ψ0+θ0l0−2d)a+w0x02R02ψ0+ϖ0x0Rψ0l0+η0l02−d2}.As we know α0 < 0 from Proposition 5, there is a unique optimal solution to Problem (50), which can be identified using an approach similar to that in Section 4.Theorem 5For a given expected final surplusE[ST]=d(d≥dσmin:=λ0x0R0ψ0+θ0l02(1+α0)),the efficient investment strategy of the multi-period mean-variance ALM problem(41)with a stochastic interest rates is given by(51)u˜k*(xk,Rk,lk)=−E−1[bk2ψk+1PkPk′](xkRkE[bk2ψk+1Pk]+12Rk−φkψk+1×((2d−λ0x0R0ψ0−θ0l0)λk+12α0wk+1E[bkψk+1Pk]+lkϖk+1wk+1E[bkψk+1qkPk]))and the corresponding mean-variance efficient frontier is given by(52)Var*[ST]=−1+α0α0(d−λ0x0R0ψ0+θ0l02(1+α0))2−(λ0x0R0ψ0+θ0l0)24(1+α0)+w0x02R02ψ0+ϖ0x0Rψ0l0+η0l02.It is evident from (51) that the efficient investment strategy is an affine function of both the current wealth level xkand the current liability level lk. On the other hand, similar to the case of no liability, the efficient investment strategy is a nonlinear function of the current interest rate Rk. There are two terms in the expression of the efficient investment strategy which contains the current interest rate. The current interest rate Rkappears linearly in the first term and nonlinearly (in a quotient form) in the second term. In addition, the randomness of the interest rate featured by bk, the randomness of the stocks characterized by Pk, and the randomness of the liability dictated by qk, are coupled with each other affecting together the efficient investment strategy.Let(53)ξk=E−1[bk2ψk+1PkPk′]E[bkψk+1qkPk].Then the optimal portfolio (51) can be rewritten as(54)u˜k*(xk,Rk,lk)=−xkRkζk−Rk−φkψk+1(2d−λ0x0R0ψ0−θ0l0)λk+14α0wk+1πk−12lkRk−φkψk+1ϖk+1wk+1ξk,whereζkandπkare defined in (23). It is evident from (54) that the optimal portfolio also has a simple structure being a linear combination of three mutual funds:ζ˜k,π˜kandξ˜k=ξk1′ξk. Compared with the case of no liability, there is an additional fundξ˜kin the expression of the optimal portfolio (54), which leads to a “three-fund” property in the case with both stochastic interest and stochastic liability. In the continuous time model, Munk and Sørensen (2010) also obtained an analogous result of the three-fund theorem in the case with stochastic income and interest rates. Similar to the case without liability, separability appears again in the optimal policy in the following sense: The current wealth level only affects the investment amount inζk, the initial wealth level x0 and the risk attitude d only affectπk, and the current liability level only affects the investment amount inξk, while the current interest rate affects all three “artificial” funds. Note that, when the stochastic interest rate, the risky assets and the liability are uncorrelated with each other (i.e., bk, qkand Pkare uncorrelated with each other), then all three fundsζ˜k,π˜kandξ˜kreduce toχ˜k. As a result, optimal portfoliou˜k*(xk,Rk,lk)is proportional toχ˜k,back to the one-fund theorem.In this section, we present three numerical examples to illustrate our results and the solution procedures for our models.33All the numerical results are obtained by MATLAB and the computational results are accurate to 2 digits after the decimal point.Example 1We take the overnight rate of the Shanghai Interbank Offered Rate (Shibor) in China as the interest rate, and select three stocks listed in China Stock Market with stock codes 601989, 000096 and 000402 as the risky assets in our model. Collecting the historical daily data of the overnight rate and these stocks from January 4, 2012 to February 8, 2013, we getT=269daily-return samples. In order to improve the precision of the calculation, we multiply the net returns by 250. For the need of calculating market parameters about the interest rate, we also transform historical data of the overnight rate of Shibor into their logarithm. Assume that an investor (or an investment institution) enters the market at time 0 with initial wealthx0=10,and exits the market at timeT=3. He can invest in the three stocks, and can also deposit and borrow money with a Vasicek’s stochastic interest rate governed by model (4). Suppose that the initial interest rate isR0=1.035. For convenience, suppose that the market parameters are independent of time k. Based on the historical data of Shibor above, we obtain(55)r¯=0.0273,φk=0.8788,σk=0.0038.Then, by (15), we have(56)ψ0=2.6526,ψ1=1.8793,ψ2=1,ψ3=0.Based on the historical data above, we can further calculate the related market parameters as(57)E[b0ψ1]=E[b01.8793]=1.0061,E[b1ψ2]=E[b1]=1.0032,E[b2ψ3]=E[b20]=1,(58)E[b02ψ1]=E[b03.7587]=1.0122,E[b12ψ2]=E[b12]=1.0064,E[b22ψ3]=E[b20]=1,(59)E[b0ψ1P0]=(0.08660.0110−0.0283),E[b1ψ2P1]=(0.08660.0121−0.0278),E[b2ψ3P2]=(0.08650.0134−0.0273),(60)E[b02ψ1P0]=(0.08680.0087−0.0292),E[b12ψ2P1]=(0.08660.0109−0.0284),E[b22ψ3P2]=(0.08650.0134−0.0273),(61)E[b02ψ1P0P0′]=(7.48415.15983.12475.15989.05934.40683.12474.40684.0896),E[b12ψ2P1P1′]=(7.44485.13863.11015.13869.01564.38253.11014.38254.0637),E[b22ψ3P2P2′]=(7.40075.11483.09365.11488.96674.35543.09364.35544.0348).Substituting the above data into (20) yields the efficient investment strategies at the beginning of every time period,u0*(x0,R0)=x0R0(−0.0212−0.00050.0239)+R0−1.6526(d−10.9745)(2.79240.1256−3.193),u1*(x1,R1)=x1R1(−0.0211−0.00090.0241)+R1−0.8793(d−10.9745)(2.80090.1521−3.2258),u2*(x2,R2)=x2R2(−0.0209−0.00140.0243)+(d−10.9745)(2.80040.1818−3.2513).Letσ[xT]=Var[xT]denote the standard deviation of the terminal wealth xT. Then, calculating (21) using the given data gives rise to the following mean-variance efficient frontier,σ*[x3]=132.9985(d−11.0570)2+0.0082,d≥11.0570.We depict the efficient frontier in Fig. 1. Setting the expected terminal wealth atd=11.0570,we get the global minimum standard deviation asσmin*[x3]=0.0908,which is strictly larger than zero. Hence, the efficient frontier is a hyperbola in the standard deviation-mean plane (see Fig. 1), and one cannot find a risk-free portfolio on the efficient frontier. This is due to the fact that the risk resulted from the stochastic interest rate cannot be hedged by the three stocks.In order to show the impact of the randomness of the interest rate on the efficient investment strategy and the efficient frontier, we setσk=0andφk=1fork=0,1,2,3(which corresponds to Special case 3 in Section 5). In this case, the interest rate is deterministic, more specifically,Rk≡R0=1.035fork=0,1,2,3. Based on the historical data of the three stocks in Example 1 and noting that Rk≡ 1.035, we obtain(62)E[Pk]=(0.0792,0.0061,−0.0346)′,E[PkPk′]=(7.40265.11663.09605.11668.96864.35783.09604.35784.0377).We still considerx0=10andT=3as we did in Example 1. Plugging (62) into (38) yields the efficient investment strategy fork=0,1,2uk*(xk,Rk)=(xkRk−131.9117(d−11.0031))(−0.0204−0.00170.0261).Substituting (62) into (39), we obtain the efficient frontier asσ*[xT]=11.4417(d−11.0872),d≥11.0872.In this case, the global minimum standard deviationσmin*[xT]of the terminal wealth is equal to zero, and the efficient frontier is a straight line (see Fig. 1). From Fig. 1, we also find that the efficient frontier moves to the upper left when compared to the case with stochastic interest rate. This clearly indicates that the randomness of the interest rate deteriorates the mean-variance performance as evidenced by the dominance relationship between the two efficient frontiers.In this example, we suppose that the investor (or an investment institution) confronts with an uncontrollable liability with initial liabilityl0=2. The investor can invest in the three stocks and can lend and borrow money with a Vasicek’s stochastic interest rate as stated in Example 1. Related parameters about the stochastic interest rate and the three stocks are the same as in Example 1, which are given by (55)–(61). We also suppose thatx0=10andT=3,which are also the same as in Example 1.In this example, we take the daily return of Shanghai corporate bonds index (the bonds code is 000022) in China as the return of the uncontrollable liability. Based on the historical daily data of Shanghai corporate bonds index and the three stocks (see Example 1) from January 4, 2012, to February 8, 2013, we obtained the market parameters related with the liability as follows,E[qk]=1.0813,E[qk2]=1.1836,E[b0ψ1q0]=1.0878,E[b1ψ2q1]=1.0848,E[b2ψ3q2]=1.0813,E[b0ψ1q0P0]=(0.0478−0.0236−0.0454),E[b1ψ2q1P1]=(0.0479−0.0222−0.0448),E[b2ψ3q2P2]=(0.0480−0.0207−0.0442).Calculating (51) using the given data yields the efficient investment strategies for individual time periods as follows,u˜0*(x0,R0,l0)=x0R0(−0.0212−0.00050.0239)+R0−1.6526[(d−8.4601)(2.79240.1256−3.193)+l0(0.0193−0.0012−0.0264)],u˜1*(x1,R1,l1)=x1R1(−0.0211−0.00090.0241)+R1−0.8793[(d−8.4601)(2.80090.1521−3.2258)+l1(0.0179−0.0008−0.0247)],u˜2*(x2,R2,l2)=x2R2(−0.0209−0.00140.0243)+(d−8.4601)(2.80040.1818−3.2513)+l2(0.0165−0.0005−0.023).Plugging the computational results calculated above into (52), we obtain the following mean-variance efficient frontier,σ*[xT]=132.9985(d−8.5237)2+0.2452,d≥8.5237.Setting the expected terminal wealthd=8.5237,we can get the global minimum standard deviation asσmin*[xT]=0.4952>0. This also shows that one cannot find a risk-free portfolio and the efficient frontier is also a hyperbola. Obviously, this can be easily understood since the stochastic interest rate and uncontrollable liability can generate additional risk during the process of the investment.In the following, we investigate the effects of uncontrollable liability, which is determined by the initial liability and the growth rate of liability. First, we study the impact of initial liability on the efficient frontier. We plot the efficient frontiers for cases with five different initial liabilitiesl0=2,1.5,1,0.5,and 0 in Fig. 2(a). It is clear from Fig. 2(a) that when the initial liability decreases from 2 to 0, the efficient frontier moves to the upper left. This means that the initial liability increases the standard deviation and lowers the expected final surplus.In order to identify the effects of the growth rate of liability, we denote byq={qk;k=0,1,…,T−1}the growth rate process of liability. We reduce the same proportion on q to generate the corresponding growth rate process of liabilityq*={qk*;k=0,1,…,T−1}. Fig. 2(b) displays different efficient frontiers corresponding to different growth rate processes of liability. The efficient frontier moves to the upper left when q* gradually decreases to zero. We find that, for a given risk level measured by variance, the expected return of the final surplus decreases with the increase of the growth rate of liability.Since the liability is determined by the initial liability and the growth rate of liability, both Fig. 2(a) and (b) imply that liability is negatively related to the performance of an ALM investor with mean-variance preference. Obviously, this result is consistent with our common sense.

@&#CONCLUSIONS@&#
Recognizing the importance to (i) incorporate randomness of the interest rate in portfolio selection formulation and (ii) to consider asset and liability management (ALM) at the same time, we have investigated in this paper (i) a multi-period mean-variance (MV) portfolio selection problem with a stochastic interest rate and (ii) ALM problem with a random interest rate under the mean-variance framework. When we place efforts to reduce the gap between investment practice and mathematical models, we also pay the cost of increasing the dimension of the state space to two and three in these two extensions, respectively. Fortunately, we are able to overcome the increasing complexity by using Lagrange duality theory and dynamic programming approach. Most prominently, we have derived closed-form expressions for the efficient investment strategy and the mean-variance efficient frontier. Our research shows that, when there exists randomness in interest rate, the global minimum variance of terminal wealth can be strictly bigger than zero. On the other hand, we have identified a condition under which the zero global minimum variance can be achieved. We have further offered explanations for the impacts of a stochastic interest rate on the portfolio performance via studying the simplified expressions of the efficient investment strategy and the efficient frontier in some special cases. Our results show that, a two fund theorem holds in case of no liability and a three fund theorem holds in case with liability. However, when the stochastic interest rate, the risky assets and the liability (if it exists) are uncorrelated with each other, the one fund theorem in the classical mean-variance model (Markowitz, 1952) reappears in both cases with and without a liability. Our work can be extended further in several directions. For example, we can generalize our results under the mean-variance criterion to a framework under an expected utility maximization formulation with a stochastic interest rate; we can further consider the case of stochastic market environment, such as Markov regime-switching market; and we can also apply our results to the pension fund management problem or investment-reinsurance problem.In this appendix, we present some lemmas which are useful for us to prove the propositions and theorems in this paper. Let |M| denote the determinant for a square matrix M.Lemma 1Letξ=(ξ1,ξ2,…,ξn)′be a random vector. Then|E[ξξ′]|=0iff there is a nonzero vectorc=(c1,c2,…,cn)′such thatc′ξ=c1ξ1+c2ξ2+⋯+cnξn=0with probability 1.SinceE[ξξ′]=Cov(ξ)+E[ξ]E[ξ′],thenE[ξξ′]is a positive semidefinite matrix. Therefore|E[ξξ′]|=0is equivalent to there exists a nonzero vectorc=(c1,c2,…,cn)′such thatc′E[ξξ′]c=E[c′ξξ′c]=E[(c′ξ)2]=0.On the other hand, since (c′ξ)2 ≥ 0, thenE[(c′ξ)2]=0is equivalent toc′ξ=c1ξ1+c2ξ2+⋯,cnξn=0with probability 1.□Letξ=(ξ1,ξ2,…,ξn)′be a random vector such thatE[ξξ′]is positive definite, and η be another positive random variable. ThenE[ηξξ′]is also a positive definite matrix.Since η > 0, letς=η,namely,η=ς2. ThenE[ηξξ′]=E[(ςξ)(ςξ)′]≽0. IfE[ηξξ′]≻0is not true, it must have|E[ηξξ′]|=|E[(ςξ)(ςξ)′]|=0. According to Lemma 1, there exist a nonzero vectorc=(c1,c2,…,cn)′such thatc′(ςξ)=ς(c′ξ)=ς(c1ξ1+c2ξ2+⋯+cnξn)=0with probability 1. Because ς > 0, it follows thatc1ξ1+c2ξ2+⋯+cnξn=0with probability 1. Again by Lemma 1, we obtain|E[ξξ′]|=0,which contradicts the fact ofE[ξξ′]≻0. Therefore,E[ηξξ′]is positive definite.□Let matrix M be partitioned asM=(M11M12M21M22),where M11 and M22 are also symmetrical square matrices. Then the following lemmas hold.Lemma 3Zhang, 2011If M22≻0, then we have|M|=|M22||M11−M21M22−1M12|.WhenM21=M12′,then M≽0 is equivalent to M22≽0,M22M22+M12′=M12′andM11−M12M22+M12′≽0,whereM+is the Moore–Penrose pseudo inverse of M.If M≽N≽0, then we have |M| ≥ |N|.In this appendix, we provide the proofs for our main results in the paper.Proof of Proposition 1It is known from Assumption 1 thatE[PkPk′]≻0. Notice thatbk=e(1−φ)r¯+σkɛk. Then we havebk2ψk+1=e2ψk+1(1−φ)r¯+2ψk+1σkɛk>0. Therefore, it follows from Lemma 2 thatE[bk2ψk+1PkPk′]≻0.Now we prove that the positive definiteness ofE[HkHk′]by using reduction to absurdity. Assume thatE[HkHk′]is not a positive definite matrix. SinceE[HkHk′]≽0,then we have|E[HkHk′]|=0. According to Lemma 1, there exists a nonzero vectorc¯=(c0,c1,c2,…,cn)′=(c0,c′)′such that(A.1)c′H=c0+c′Pk=0with probability 1. Then it follows thatVar[c′H]=Var[c0+c′Pk]=Var[c′Pk]=c′Var[Pk]c=0.Since by Assumption 1 , Var[Pk]≻0, c must be the zero vector, that isc=0→n. Substitutingc=0→ninto (A.1) further gives rise toc0=0. Namely,c¯is also the zero vector, which contradicts thatc¯is a nonzero vector. Therefore,E[HkHk′]is positive definite.Finally, we proveE[QkQk′]≻0. Note thatE[QkQk′]=E[bk2ψk+1HkHk′]andbk2ψk+1>0. As has been proved above thatE[HkHk′]≻0,it then follows from Lemma 2 thatE[QkQk′]≻0.□According to (13), we obtainE[QkQk′]=E[bkψk+1(1Pk)bkψk+1(1Pk′)]=(E[bk2ψk+1]E[bk2ψk+1Pk′]E[bk2ψk+1Pk]E[bk2ψk+1PkPk′]),E[QkLk′]=E[bkψk+1(1Pk)(1bkψk+1Pk′)]=(E[bkψk+1]E[bk2ψk+1Pk′]E[bkψk+1Pk]E[bk2ψk+1PkPk′]),E[LkLk′]=E[(1bkψk+1Pk)(1bkψk+1Pk′)]=(1E[bkψk+1Pk′]E[bkψk+1Pk]E[bk2ψk+1PkPk′]).By Proposition 1, we have|E[bk2ψk+1PkPk′]|>0. Then it follows from Lemma 3 and (12) that(A.2){|E[QkQk′]|=Dk|E[bk2ψk+1PkPk′]|,|E[QkLk′]|=Ck|E[bk2ψk+1PkPk′]|,|E[LkLk′]|=Gk|E[bk2ψk+1PkPk′]|.Since|E[bk2ψk+1PkPk′]|>0,(A.2) implies that (14) holds true. We complete the proof for the proposition.□For anyk=0,1,…,T−1,it follows from Proposition 1 that|E[bk2ψk+1PkPk′]|>0and|E[QkQk′]|>0. Obviously,|E[LkLk′]|≥0. Then, by Proposition 2, we have Dk> 0 and Gk≥ 0. SinceE[bk2ψk+1PkPk′]is positive definite, then so isE−1[bk2ψk+1PkPk′]. By Assumption 3 ,E[bkψk+1Pk′]≠0→n. Then we haveE[bkψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk]>0.Therefore, the following holds true from (12),Gk=1−E[bkψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk]<1.In the following, we prove thatDkGk≥Ck2. By Proposition 1,E[QkQk′]≻0. So the inverse ofE[QkQk′],E−1[QkQk′],exists, andE+[QkQk′]=E−1[QkQk′]≻0. SinceE[(LkQk)(Lk′Qk′)]=(E[LkLk′]E[LkQk′]E[QkLk′]E[QkQk′])≽0,then, it follows from Lemma 4 thatE[LkLk′]−E[LkQk′]E−1[QkQk′]E[QkLk′]≽0.Obviously, we haveE[LkQk′]E−1[QkQk′]E[QkLk′]=E[LkQk′]E−1[QkQk′](E[LkQk′])′≽0.Consequently, we obtain(A.3)E[LkLk′]≽E[LkQk′]E−1[QkQk′]E[QkLk′]≽0.Then, according to (A.3) and Lemma 5, it follows that(A.4)|E[LkLk′]|≥|E[LkQk′]E−1[QkQk′]E[QkLk′]|=|E[LkQk′]||E−1[QkQk′]||E[QkL′|.Notice that|E[QkLk′]|=|E[LkQk′]|and|E−1[QkQk′]|=|E[QkQk′]|−1>0. Then (A.4) implies|E[QkLk′]|2≤|E[QkQk′]||E[LkLk′]|,which, along with Proposition 2, yieldsCk2≤DkGk.As we have already proved Gk< 1 and Dk> 0, we haveCk2≤DkGk<Dk.□We prove this theorem by mathematical induction on k. Fork=T−1,by Bellman equation (10), we have(A.5)fT−1(x,R)=minuT−1E[fT(xR+PT−1′uT−1,bT−1RφT−1)]=minuT−1E[(xR+PT−1′uT−1)2+2a(xR+PT−1′uT−1)]=x2R2+2axR+minuT−1{uT−1′E[PT−1PT−1′]uT−1+2(xR+a)E[PT−1′]uT−1}.SinceE[PT−1PT−1′]≻0by Assumption 1 , then applying the first order condition (which is also sufficient) aboutuT−1yields the following optimal strategy,(A.6)uT−1*=−(xR+a)E−1[PT−1PT−1′]E[PT−1′].Substituting (A.6) into (A.5) gives rise to(A.7)fT−1(x,R)=(1−BT−1)x2R2+2a(1−BT−1)xR−BT−1a2,whereBT−1=E[PT−1′]E−1[PT−1PT−1′]E[PT−1]. On the other hand, by (11), it follows that(A.8){DT−1=1−BT−1,CT−1=1−BT−1,GT−1=BT−1,ψT−1=1,wT−1=DT−1,λT−1=2CT−1,αT−1=−GT−1.Hence, we obtain(A.9)fT−1(x,R)=DT−1x2R2+2aCT−1xR−GT−1a2=wT−1x2R2ψT−1+λT−1axRψT−1+αT−1a2.According to (A.8) and (A.6), we have(A.10)−E−1[bT−12ψTPT−1PT−1′](xRE[bT−12ψTPT−1]+12R−φT−1ψTaλTwTE[bT−1ψTPT−1])=−E−1[PT−1PT−1′](xRE[PT−1]+aE[PT−1])=−(xR+a)E−1[PT−1PT−1′]E[PT−1]=uT−1*.Eqs. (A.9) and (A.10) validate (16) and (17) fork=T−1.Now suppose that both (16) and (17) hold fork+1. Note that1+φkψk+1=ψk,by Bellman equation (10), we have(A.11)fk(x,R)=minukE[fk+1(xR+Pk′uk,bkRφk)]=minukE[wk+1(xR+Pk′uk)2(bkRφk)2ψk+1+λk+1a(xR+Pk′uk)(bkRφk)ψk+1+αk+1a2]=wk+1E[bk2ψk+1]x2R2ψk+λk+1aE[bkψk+1]xRψk+αk+1a2+minuk{wk+1R2φkψk+1uk′E[bk2ψk+1PkPk′]uk+2wk+1xR2φkψk+1+1E[bk2ψk+1Pk′]uk+λk+1aRφkψk+1E[bkψk+1Pk′]uk}.SinceE[bk2ψk+1PkPk′]≻0andwk+1>0by Propositions 1 and 4, and notice thatR=Rk>0,applying the first order condition (which is also sufficient) about ukgives rise to(A.12)uk*=−E−1[bk2ψk+1PkPk′](xRE[bk2ψk+1Pk]+12R−φkψk+1aλk+1wk+1E[bkψk+1Pk]).Substituting (A.12) into (A.11) and simplifying the resulted equation generatefk(x,R)=x2R2ψkwk+1(E[bk2ψk+1]−E[bk2ψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bk2ψk+1Pk])+axRψkλk+1×(E[bkψk+1]−E[bk2ψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk])+(αk+1−λk+124wk+1E[bkψk+1Pk′]E−1[bk2ψk+1PkPk′]E[bkψk+1Pk])a2.Therefore, it follows from (12) and (11) that(A.13)fk(x,R)=x2R2ψkwk+1Dk+axRψkλk+1Ck+(αk+1−λk+124wk+1Gk)a2=wkx2R2ψk+λkaxRψk+αka2.Eqs. (A.12) and (A.13) validate (16) and (17) for k. By the principle of mathematical induction, (16) and (17) hold true for allk=0,1,…,T−1and the theorem is thus proved.□(i)We first prove αk< 0 fork=0,1,…,T−1. By Proposition 3, we have1−Gi>0andCj2Dj≥0forj=0,1,…,T−1. Then, by (15) and (11), fork=0,1,…,T−1,it follows thatαk=−∑i=kT−1(1−Gi)∏j=i+1T−1Cj2Dj≤−∑i=T−1T−1(1−Gi)∏j=i+1T−1Cj2Dj=−(1−GT−1)<0.In the following, we prove thatαk≥−1+λk24wk≥−1fork=0,1,…,T−1. By Proposition 3, we have 0 ≤ Gj< 1 and0≤Cj2Dj≤Gjforj=0,1,…,T−1. Then by (15), it follows thatαk=−∑i=kT−1(1−Gi)∏j=i+1T−1Cj2Dj≥−∑i=kT−1(1−Gi)∏j=i+1T−1Gj=−∑i=kT−1∏j=i+1T−1Gj+∑i=kT−1Gi∏j=i+1T−1Gj=−∑i=kT−1∏j=i+1T−1Gj+∑i=kT−1∏j=iT−1Gj=−∏j=TT−1Gj+∏j=kT−1Gj=−1+∏j=kT−1Gj≥−1+∏j=kT−1Cj2Dj=−1+λk24wk≥−1,fork=0,1,…,T−1.From the proof of (i), we know thatαk=−1+∏j=kT−1Cj2Dj=−1+λk24wkiffCj2Dj=Gjforj=k,k+1,…,T−1.□It is known from Proposition 5 that(A.14)α0=−1+λ024w0,iffCi2Di=Gifor alli=0,1,…,T−1. By (22), it follows that (A.14) is equivalent to that the global minimum variance is 0. Substituting (A.14),w0=∏i=0T−1Diandλ0=2∏i=0T−1Ciinto (21) yields the following efficient frontier,(A.15)Var*[xT]=∏i=0T−1Ci2∏i=0T−1Di−∏i=0T−1Ci2(E[xT]−x0R0ψ0∏i=0T−1DiCi)2.Asσ2[xT]=Var*[xT],(A.15) is equivalent to (25) and we complete the proof.□Becauseσk=0fork=0,1,…,T−1,by (4), we have(A.16)Rk+1=e(1−ϕk)r¯Rkϕk,k=0,1,…,T−2.It follows that(A.17){R1=R0ϕ0e(1−ϕ0)r¯,R2=e(1−ϕ1)r¯R1ϕ1=R0ϕ1ϕ0e(1−ϕ1)r¯e(1−ϕ0)ϕ1r¯,R3=e(1−ϕ2)r¯R2ϕ2=R0ϕ2ϕ1ϕ0e(1−ϕ2)r¯e(1−ϕ1)ϕ2r¯e(1−ϕ0)ϕ1ϕ2r¯,⋯RT−1=R0ϕT−2⋯ϕ1ϕ0e(1−ϕT−2)r¯e(1−ϕT−3)ϕT−2r¯⋯e(1−ϕ1)ϕ2⋯ϕT−2r¯e(1−ϕ0)ϕ1ϕ2⋯ϕT−2r¯.Noting thatψk=∑i=kT−1∏j=ki−1ϕj,eψT−1(1−φT−2)r¯=e(1−φT−2)r¯andeψT(1−φT−1)r¯=e0(1−φT−1)r¯=1. Hence, we obtain∏i=0T−1Ri=R0R1R2R3⋯RT−1=R0(R0ϕ0e(1−ϕ0)r¯)(R0ϕ1ϕ0e(1−ϕ1)r¯e(1−ϕ0)ϕ1r¯)×(R0ϕ2ϕ1ϕ0e(1−ϕ2)r¯e(1−ϕ1)ϕ2r¯e(1−ϕ0)ϕ1ϕ2r¯)⋯(R0ϕT−2⋯ϕ1ϕ0e(1−ϕT−2)r¯e(1−ϕT−3)ϕT−2r¯⋯e(1−ϕ1)ϕ2⋯ϕT−2r¯e(1−ϕ0)ϕ1ϕ2⋯ϕT−2r¯)=R01+ϕ0+ϕ1ϕ0+ϕ2ϕ1ϕ0+⋯+ϕT−2⋯ϕ1ϕ0×(e(1−ϕ0)r¯e(1−ϕ0)ϕ1r¯e(1−ϕ0)ϕ1ϕ2r¯⋯e(1−ϕ0)ϕ1ϕ2⋯ϕT−2r¯)×(e(1−ϕ1)r¯e(1−ϕ1)ϕ2r¯⋯e(1−ϕ1)ϕ2⋯ϕT−2r¯)⋯(e(1−ϕT−2)r¯)=R0ψ0e(1+ϕ1+ϕ1ϕ2+⋯ϕ1ϕ2⋯ϕT−2)(1−ϕ0)r¯e(1+ϕ2+⋯+ϕ2ϕ3⋯ϕT−2)(1−ϕ1)r¯⋯e(1−ϕT−2)r¯=R0ψ0eψ1(1−ϕ0)r¯eψ2(1−ϕ1)r¯⋯eψT−1(1−ϕT−2)r¯=R0ψ0∏i=0T−1eψi+1(1−ϕi)r¯.This completes the proof.□The proof of this theorem is similar to the one for Theorem 1.Fork=T−1,by (11)–(12) and (45)–(46), we have(A.18){ψT−1=1,wT−1=DT−1,λT−1=2CT−1,αT−1=−GT−1,ϖT−1=−2(E[qT−1]−FT−1),ηT−1=E[qT−12]−JT−1,θT−1=−2(E[qT−1]−FT−1),where(A.19){DT−1=1−BT−1,CT−1=1−BT−1,GT−1=BT−1,BT−1=E[PT−1′]E−1[PT−1PT−1′]E[PT−1],FT−1=E[PT−1′]E−1[PT−1PT−1′]E[qT−1PT−1′],JT−1=E[qT−1PT−1′]E−1[PT−1PT−1′]E[qT−1PT−1′].Applying Bellman equation (44) gives rise to(A.20)f˜T−1(x,R,l)=minuT−1E[f˜T(xR+PT−1′uT−1,bT−1RφT−1,qT−1l)]=minukE[(xR+PT−1′uT−1)2+qT−12l2−2(xR+PT−1′uT−1)qT−1l+2a(xR+PT−1′uT−1)−2aqT−1l]=x2R2+2axR+qT−12l2−2xRlE[qT−1]−2alE[qT−1]minu{uT−1′E[PT−1PT−1′]uT−1+2((xR+a)E[PT−1′]−lE[qT−1PT−1′])uT−1}.AsE[PT−1PT−1′]>0by Assumption 1, applying the first order condition with respect touT−1yields the following optimal solution,(A.21)u˜T−1*=−E−1[PT−1PT−1′]((xR+a)E[PT−1′]−lE[qT−1PT−1′]).Substituting (A.21) into (A.20), and noticing (A.19) and (A.18), we have(A.22)f˜T−1(x,R,l)=DT−1x2R2+2CT−1axR−GT−1a2−2xRl(E[qT−1]−FT−1)+(E[qT−12]−JT−1)l2−2al(E[qT−1]−FT−1)=wT−1x2R2ψT−1+λT−1axRψT−1+αT−1a2+ϖT−1xRψT−1l+ηT−1l2+θT−1al.According to (A.18) and (A.21), we have(A.23)−E−1[bT−12ψTPT−1PT−1′](xRE[bT−12ψTPT−1]+12R−φT−1ψT×(aλTwTE[bT−1ψTPT−1]+lϖTwTE[bT−1ψTqT−1PT−1]))=−E−1[PT−1PT−1′]((xR+a)E[PT−1]−lE[qT−1PT−1])=u˜T−1*.Thus, (48) and (49) hold true fork=T−1.Now suppose that (48) and (49) hold fork+1. Note that1+φkψk+1=ψk. Applying Bellman equation (44) gives rise to(A.24)f˜k(x,R,l)=minukE[f˜k+1(xR+Pk′uk,bkRφk,qkl)]=minukE[wk+1(xR+Pk′uk)2(bkRφk)2ψk+1+λk+1a(xR+Pk′uk)(bkRφk)ψk+1+αk+1a2+ϖk+1(xR+Pk′uk)(bkRφk)ψk+1qkl+ηk+1qk2l2+θk+1aqkl]=wk+1E[bk2ψk+1]x2R2ψk+λk+1aE[bkψk+1]xRψk+αk+1a2+ϖk+1E[bkψk+1qk]xRψkl+ηk+1E[qk2]l2+θk+1E[qk]al+minuk{wk+1R2φkψk+1uk′E[bk2ψk+1PkPk′]uk+Rφkψk+1×(2wk+1xRφkψk+1+1E[bk2ψk+1Pk′]+λk+1aE[bkψk+1Pk′]+ϖk+1E[bkψk+1qkPk′]l)uk}.From Propositions 1 and 4,E[bk2ψk+1PkPk′]>0andwk+1>0. Also notice thatR=Rk>0. Applying the first order condition with respect to ukgives rise to(A.25)u˜k*=−E−1[bk2ψk+1PkPk′](xRE[bk2ψk+1Pk]+12R−φkψk+1×(aλk+1wk+1E[bkψk+1Pk]+lϖk+1wk+1E[bkψk+1qkPk])).Substituting (A.25) into (A.24) and simplifying the resulting equation yieldf˜k(x,R,l)=x2R2ψkwk+1Dk+axRψkλk+1Ck+(αk+1−λk+124wk+1Gk)a2+ϖk+1(E[bkψk+1qk]−Fk)xRψkl+(ηk+1E[qk2]−14ϖk+12wk+1Jk)l2+(θk+1E[qk]−12ϖk+1λk+1wk+1Fk)al,where Dk, Ckand Gkare defined in (12), and Fkand Jkare defined in (46). By (11) and (45), it follows that(A.26)f˜k(x,R,l)=wkx2R2ψk+λkaxRψk+αka2+ϖkxRψkl+ηkl2+θkal.We can conclude from (A.26) and (A.25) that (48) and (49) hold true for k. We complete the proof based on the principle of mathematical induction.□