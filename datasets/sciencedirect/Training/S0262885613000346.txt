@&#MAIN-TITLE@&#
Contrast-Adaptive Removable Visible Watermarking (CARVW) mechanism

@&#HIGHLIGHTS@&#
The transparency of the watermark is applicable to the various host images.The browsers can recognize the watermark, and the host image is not seriously obscured.The new scheme can remove the embedded watermark from the watermarked image.The PSNR values of the various restored images are around 56dB after the visible watermark has been removed.

@&#KEYPHRASES@&#
Restoration,Transparency,Visible watermark,Contrast-adaptive,Copyright protection,

@&#ABSTRACT@&#
Engineers have proposed many watermark mechanisms for protecting the content of digital media from unauthorized use. The visible watermark scheme indicates the copyright of digital media posted over the Internet by embedding an inconspicuous but recognizable pattern into media. However, the embedding process often results in serious distortion of the protected image. Since the strength of the watermark in conventional methods mainly depends on the feature of protected media, this may lead to unsatisfactory transparency of watermarked images. This paper proposes a removable solution for visible watermark mechanism. By adopting the subsampling technique, the method proposes a contrast-adaptive strategy to solve this problem. This method can also guarantee the essentials of general visible watermark schemes. Experimental results show that the proposed method outperforms related works in terms of preserving the quality of the restored image.

@&#INTRODUCTION@&#
Digital watermark techniques [1–11] have recently been utilized to protect the content of multimedia from unauthorized use. According to the visibility of the watermark embedded in the protected media, watermark mechanisms are classified as visible or invisible. Although they are applied to different applications and possess the same importance, engineers often pay more attention on invisible methods. This paper offers a novel solution for visible watermark mechanism to mitigate this unbalance. For simplicity, we focus our research on the digital images presented in this article.For commercial consideration, valuable images are digitalized and posted over the Internet by resource provider. Naturally, people can freely browse and download these online media; thus, how to protect the digital media from illegal use is an important issue. Visible watermark mechanisms [12–16] are employed to indicate the copyright of digital media by embedding an inconspicuous but recognizable logo into media. The embedded visible watermark, however, can seriously distort the protected image. Removable visible watermark (RVW) mechanisms are proposed to resolve this issue [14]. In addition to being capable of preventing the online resource from unauthorized use, this version allows authorized users to remove the visible watermark and obtain an unmarked image with acceptable quality. Hu and Jeon proposed an improved version in which the embedded visible watermark can be completely removed [15]; nevertheless, this visible watermark can only protect a local area of the whole image. This limitation cannot fulfill the protection requirement of the visible watermark mechanisms [2,3].Tsai and Chang proposed a reversible visible image watermarking using the pixel value mapping (PVM) function [17]. The visible logo is embedded into the host image according to two principles: creating a bright logo on the dark regions of the host image, and constructing a dark logo on the bright regions of the host image. Nevertheless, the PVM is irreversible, and the quality of the reconstructed unmarked image approximates to that of the host image with a difference value of 0 or 1 (the distortion of each pixel is at most unity). To restore the lossless unmarked image, the scheme records the difference values between the restored areas and the original image areas. A compression technique, JBIG, afterward is used to reduce the payload of the difference values.The main concerns in designing an RVW mechanism are transparency and restoration. The transparency focuses on how the strength of the watermark influences the host image. Generally speaking, the perceptual translucence of a host image and its watermark recognition is a tradeoff. To obtain good watermark recognition from a host image, the visibility strength of the watermark must be increased. However, increasing visibility of the watermark may cause distortion on a host image. The restoration addresses the quality of the reconstructed image. Without loss of generality, the host image is seriously distorted after being embedded a visible logo. RVW methods must permit authorized users to restore watermarked images to unmarked images with excellent quality; otherwise, the reconstructed image may become distorted and valueless.The strength of the watermark in conventional methods mainly depends on the feature of the protected media. This dependency may result in the unsatisfactory transparency of watermarked images. Employing the subsampling technique, we propose a contrast-adaptive strategy to solve this problem. In addition to the feature of the protected media, the proposed scheme employs an adaptive weight that allows resource provider to adjust the energy of the watermark according to the visual requirement of the protected image. Furthermore, the experimental results show that the performances of the proposed scheme are superior to those of the others [13–17].The rest of this paper is organized as follows. Prior works are introduced in Section 2. The embedding procedure of the novel mechanism is elaborated in Section 3, while the removing procedure is addressed in Section 4, followed by an instance of the proposed method in Section 5. Experimental results and performance analyses are discussed in Section 6. Finally, we make conclusions in Section 7.Here, we describe the essentials of RVW mechanisms and introduce the subsampling technique adopted in the novel method.In the following, we define the essentials of the novel RVW mechanism as follows [2,3]:Essential 1: RestorationThe commercial value of the original image may be reduced due to distortion resulting from the embedded visible watermark. Thus, RVW mechanisms must guarantee that an authorized user can restore a host image with satisfactory quality.Essential 2: TransparencyThe host image must not be seriously obscured by the RVW; otherwise, browsers cannot recognize the content of the host image. That is, the RVW method must ensure that the strength of the visible watermark is appropriate.Essential 3: Global protectionIt is clear that the visible watermark is used to protect a whole image from illegal use. Therefore, the RVW must not be applied to the local area of a host image but to the global area.Essential 4: Multiple authorizationsThe RVW mechanism must be able to authorize a host image to distinct users; this makes the system more flexible and practical. That is, for each authorized user, the RVW mechanism must generate an individual watermarked image for the same subject image with a unique secret key. Later, the users can remove the visible watermark to obtain an unmarked image with their own secret key.Essential 5: RobustnessAn unauthorized user may intend to eliminate the visible logo from the watermarked image. Hence, a robust RVW algorithm shall be able to resist such malicious attack. Without the authorized information, it is difficult for the attacker to erase the visible logo. That is, the elimination process is labor intensive, and its cost is more expensive than purchasing the copyright of the digital image.The proposed contrast-adaptive RVW (CARVW) mechanism consists of two procedures: embedding and removing. The first procedure embeds a visible watermark into the image to be protected, while the second allows an authorized user to remove the logo from the watermarked image and restore the unmarked image.Fig. 1shows the block diagram of CARVW. The host image O is an N×N gray-scale image. First, we adopt the subsampling technique [5] to divide the host image O into four sub-images, O1, O2, O3, and O4, with N/2×N/2pixels. The subsampling process is defined as follows:(1)O1pq=O2p,2q,O2pq=O2p,2q+1,O3pq=O2p+1,2q,O4pq=O2p+1,2q+1,where p=0, 1, …, (N/2)−1 and q=0, 1, …, (N/2)−1.We subsequently apply discrete wavelet transformation (DWT) to sub-images O1, O2, O3, and O4 to obtain four corresponding decomposed wavelet domains D1, D2, D3, and D4, respectively. Let the t-level lowest-frequency subband of Dibe LLiwith size N/2t+1×N/2t+1, i∈{1, 2, 3, 4} as shown in Fig. 2. It is clear that the four lowest-frequency subbands are similar, i.e. LLi≈LLj, for j∈{1, 2, 3, 4} and j≠i. This is because the coefficients of the four lowest-frequency subbands at the same locations are highly correlated. The property especially occurs in the smooth areas. As to the significant texture areas, however, differences between the corresponding coefficients may arise. Based on these characteristics, we utilize the coefficient correlations of sub-images to estimate the strength of the visible watermark.To begin, each authorized user is assigned a unique secret key SK by the resource provider. Next, the SK is applied to generate a total of N/2t+1×N/2t+1 individual pairs (i, j), for i, j∈{1, 2, 3, 4} and i≠j. For simplicity, we use P as a pool to host all the pairs. To enhance security, we employ these pairs to produce an individual visible watermarked image for each legal user. Therefore, only the authorized user with SK can remove the embedded watermark to restore the host image O.NomenclatureOthe host gray-level image with size N×N pixelsthe watermarked imagefour sub-images of O, i∈{1, 2, 3, 4}four DWT corresponding to Oit-level discrete wavelet transformation (DWT)the t-level lowest-frequency subband of Dithe watermark with size N/2t+1×N/2t+1k=1, 2, …, N/2t+1×N/2t+1the k-th bit of Ma unique secret key for each authorized userthe N/2t+1×N/2t+1 pairsthe k-th pair in Pthe k-th coefficient value in the lowest-frequency subbandLLαkthe k-th coefficient value in the lowest-frequency subbandLLβka difference between coefficientsLLαkkandLLβkka variance among all dkthe strength of the watermarkthe strength of the significant texture of host imagesthe visible weight for the watermark bit mkThis procedure includes two subroutines: weight estimation and watermark embedding. First, we address how to estimate the perceptible weight for the visible watermark. According to the weight, we subsequently illustrate how to embed the visible watermark into the host image. Fig. 2 illustrates the embedding process.Assume that the embedded visible watermark M is a binary watermark image, M={mk| k=1, 2, …, N/2t+1×N/2t+1}. According to the requirements of RVW mechanisms, the embedded visible watermark should be as translucent as possible. In addition to ensuring that the visible watermark is recognizable, we strive to protect the original image quality from distortion.Here, we follow two rules. First, for smooth areas, the weight of visible watermark must be diminished so that the watermark does not seriously obscure the host image. Second, we must enhance the visual perception of embedded watermark while dealing with rough areas; that is, we increase the weight to highlight the logo in the complex region. Consequently, we estimate the weight as follows:Step 1: Let (αk, βk) be the k-th pair in pair pool P, k=1, 2, …, (N/2t+1×N/2t+1).Step 2: For a pair (αk, βk), we can obtain the k-th coefficient values of subbandsLLαkandLLβk, depicted as x and y, respectively:(2)x=LLαkk,y=LLβkk.Here,LLαkkdenotes the k-th coefficient value in the lowest-frequency subbandLLαk, andLLβkkdenotes the k-th coefficient value in the lowest-frequency subbandLLβk.Step 3: The integer difference dkbetween the coefficient values x and y is calculated as(3)dk=x−y.Step 4: We then obtain the variance σkof the coefficient values x and y by computing(4)σk=dk−dmindmax−dmin,where dmin and dmax are the minimum and maximum difference values among all dks, for k=1, 2, …, (N/2t+1×N/2t+1).Step 5: The weight wkfor the watermark bit mkis defined as(5)wk=wu+wv×σk.The values of wuand wvare determined by the strength of the user-defined watermark and the significant texture of the protected image, respectively.Since the content energy of watermark M mainly gathers in black pixels, we must highlight these black regions of M in the watermarked image to emphasize visibility. In contrast to the black pixels, the white pixels, which possess less energy, are not considered to alter the original image. In CARVW, we only embed the black regions of M to protect the copyright of the original image. Thus, we can reduce the alteration of the original image to preserve the quality of watermarked image while enhancing the visibility of the watermark.Obeying the above concept, if a watermark bit mkbelongs to the black regions (i.e. the watermark bit mk=0), we employ the corresponding weight wkto adjust the k-th coefficient values of the lowest-frequency subbands LL1, LL2, LL3, and LL4 by the following equation:(6)LLδ′k=LLδk−wk.Here, LLδ′(k) denotes the k-th coefficient value in the lowest-frequency subband of the processed image LLδ′, for δ=1, 2, 3, and 4 and k=1, 2, …, (N/2t+1×N/2t+1).Subsequently, we apply the inverse discrete wavelet transformation (IDWT) to the processed D1, D2, D3, and D4 to obtain four corresponding sub-images. By employing the inverse subsampling technique on the sub-images, we can derive the watermarked image O′. The resource provider thereby can issue O′ to the individual user along with the secret factors {wu, wv}, unique key SK, and logo M. Moreover, to enhance the security, the secret parameters {wu, wv}, SK, and M can be encrypted by the individual user's secret key firstly.With weight wk, the quality of the watermarked image O′ is capable of highlighting the energy of the watermark. Specifically, each weight is adjustable with the correlation variance of the two selected lowest-frequency subbands. That is, the perceptual quality of the watermarked image is sensitively adapted according to the watermark image, the feature of host image, and user-defined {wu, wv}.An authorized user can remove the embedded information in order to restore an unmarked image from the watermarked image by employing the decrypted secret factors {wu, wv}, user key SK, and logo M.Step 1: Suppose that O′ is the watermarked image. We apply the subsampling technique in Eq. (1) and DWT transform to O′ to obtain four watermarked lowest-frequency subbands LLδ′, for δ=1, 2, 3, and 4.Step 2: We then input the user key SK to generate the same pairs in P.Step 3: For the k-th pair (αk, βk) of P, we can obtain the k-th coefficient values of subbandsLLαk′andLLβk′, respectively.(7)x′=LLαk′k,y′=LLβk′k.Here,LLδk′kdenotes the k-th coefficient value in the lowest-frequency subbandLLδk′, for k=1, 2, …, (N/2t+1×N/2t+1).Step 4: The difference value dk′ between x′ and y′ is computed by(8)dk′=x′−y′.Step 5: The variance σk′ of x′ and y′ is obtained by(9)σk′=dk′−dmin′dmax′−dmin′,where dmin′ and dmax′ are the minimum and maximum difference values among all dk's, for k=1, 2, …, (N/2t+1×N/2t+1).Step 6: Since the values of difference dk′, dmin′, and dmax′, and variance σk′ are invariant (i.e. dk′=dk, dmin′=dmin, dmax′=dmax, and σk′=σk), we can further acquire accurate weight wk′ by(10)wk′=wu+wv×σk′.Here, only the authorized owner can decrypt the SK and {wu, wv} to attain the accurate wk′.Step 7: According to wk′ and the logo M={mk| k=1, 2, …, (N/2t+1×N/2t+1)}, if the watermark bit mk=0, we remove the weight wkfrom the k-th coefficient values of lowest-frequency subbands LL1′, LL2′ LL3′, and LL4′ by(11)LLδ*k=LLδ′k+wk.where LLδ⁎(k) denotes the k-th reconstructed coefficient value in the lowest-frequency subband LLδ′ of the restored image, for δ=1, 2, 3, and 4 and k=1, 2, …, (N/2t+1×N/2t+1).Step 8: Employ IDWT to obtain four corresponding sub-images. Finally, the unmarked image O⁎ can be reconstructed by employing the inverse subsampling techniques to these sub-images.In Eq. (6), the four coefficient values LLδ′ are subtracted by wk(LLδ′(k)=LLδ(k)−wk, for δ=1, 2, 3, and 4 and k=1, 2, …, (N/2t+1×N/2t+1)). According to Eq. (3), the original difference value dk=| x−y |=| LLα(k)−LLβ(k) |=| (LLα(k)−wk)−(LLβ(k)−wk) |=|LLα′(k)−LLβ′(k)|=dk′. Hence, the values of difference dk′, dmin′, and dmax′, and variance σk′ are invariant (i.e. dk′=dk, dmin′=dmin, dmax′=dmax, and σk′=σk).Here, we demonstrate an instance of CARVW in Fig. 3. To simplify the illustration, we only describe how to embed the weight into watermarked coefficients and how to remove the weight from the coefficients.Let (αk, βk)=(3, 1), wu=60, and wv=80. Suppose that the k-th coefficient values of the four corresponding subbands LL1, LL2, LL3, and LL4 are 736, 822, 843, and 793, respectively. At first, we calculate the difference between the coefficients of LL3(k) and LL1(k) by Eq. (3) asdk=843−736=107.By repeating Eq. (3) to all pairs, we can learn dks, for k=1, 2, …, (N/2t+1×N/2t+1). Thereby, we can acquire the minimum and maximum difference values dmin=0, and dmax=280 among all dks.Subsequently, we can obtain the variance by Eq. (4),σk=107−0280−0=0.382.By Eq. (5), we can further compute the weight aswk=60+80×0.382=90.According to Eq. (6), we have the four corresponding coefficients of the processed image asLL1′k=736−90=646,LL2′k=822−90=732,LL3′k=843−90=753,LL4′k=793−90=703.Hereafter, we introduce how an authorized user removes the weight from the watermarked image. Since the authorized user can decrypt the secret factors {wu, wv}, SK, and M. The accurate parameters thereby can be generated as {wu, wv}={60, 80}, and (αk, βk)=(3, 1). The difference, dk′=|753−646|=107 between subbands LL3′(k) and LL1′(k) can be computed by Eq. (8). We can observe that the value, dk′=107=dk, is invariable. By applying the same manner for all pairs, we can acquire the values dk′=dk, for k=1, 2, …, (N/2t+1×N/2t+1). Subsequently, the minimum and maximum difference values dmin=0, and dmax=280 can be computed among all dks.According to Eq. (9), we obtain the sameσk′=107−0280−0=0.382=σk. Given σk′ and {wu, wv}, we can compute the estimated weight, wk′=60+⌊80×0.382⌋=90, by Eq. (10). Finally, we can remove the weight from watermarked coefficients by Eq. (11):LL1k=646+90=736,LL2k=732+90=822,LL3k=753+90=843,LL4k=703+90=793.For RVW mechanisms, the greatest concerns are the transparency of the watermarked image and the quality of the restored images. In this section, we conduct several simulations to demonstrate the practicability of the new scheme. Moreover, we compare related well-known schemes to highlight the superiority of CARVW over other mechanisms.The peak-signal-to-noise rate (PSNR) is used to measure the image quality of the watermarked and restored images. The PSNR formula is described as follows:(12)PSNR=10log102552MSEdB.Where the mean square error (MSE) of an image with H×W pixels is defined as(13)MSE=1H×W∑i=1H∑j=1Woij−o˜ij2.Here, oijis the original pixel value ando˜ijis the processed pixel value. The sizes of the test images and the visible logo are set to 512×512pixels and 128×128pixels, respectively.We examine the strength of the visible watermark in various test images. As shown in Fig. 4, the transparency of the watermark is applicable to the protected image when we set the secret factors to wu=80 and wv=80. That is, browsers can recognize the watermark, and the host image is not seriously obscured.Using Airplane image as the representative example, we illustrate the effect of using different values of wuto obtain a suitable watermarked image. Given a fixed wv, we raise the value of wuto adjust the strength of the watermark. As displayed in Fig. 5, the increase of wumakes the visibility of the watermark become more perceivable. Moreover, the transparency of the watermark is still acceptable under different settings of wu. Through various evaluations, we suggest that wuis in the range of [60, 80] for almost all images.More precisely, we adopt the secret factor wvin Eq. (5) to highlight the significant feature of the original image. That is, if the protected image is complex, then wvcan be used to increase the strength of watermark so that browsers can recognize the logo. However, the larger value of wvmay result in underflow coefficient. That is, we cannot recover the watermarked image back to the original host image because of the underflow problem. According to the experimental results, setting wvto 80 is appropriate for almost images to retain their significant features. Consequently, CARVW can preserve Essential 2. In Fig. 9, we set wu≤80 to prevent our scheme from the underflow problem. In the experiments, the setting of wuand wvis equal to 80 because it is sufficient for all natural images in order to meet the requirements of high transparency, great restoration quality, and little underflow problems.In general, the distortion of the restored image is usually caused by the embedded watermark. The quality of a restored image is an important concern in evaluating an RVW mechanism. In this section, we demonstrate that CARVW is superior to related work in preserving reconstructed image.Without the loss of generality, if the PSNR value of a processed image is less than 35dB, some of the important signal characteristics may be lost. While the PSNR value is less than 30dB, the quality is unacceptable [18]. That is, the PSNR value of a processed image should be larger than 35dB for providing acceptable quality. As illustrated in Fig. 6, the PSNR values of the various restored images are around 56dB after the visible watermark has been removed. The quality of the unmarked image is satisfactory, with wuin the range of [20, 120] and wv=80. Table 1compares Hu et al.'s [14] RVW method with CARVW in terms of the restored image quality. Obviously, the novel mechanism outperforms the method [14] under the suggested setting of wu=80 and wv=80. In addition, the wPSNR (weight peak signal-to-noise ratio) [19] and the SSIM (structural similarity) [20] values are adopted to evaluate the perceptual quality of the proposed scheme in the human visual system and similarity. The high values of the wPSNR and SSIM indicate that the unmarked images approximate to the original image after the watermark removing processes.Next, we enlarge the Lena image to examine the performance of CARVW in terms of human visual perception. Fig. 7(b) and (c) presents the enlarged partial areas of the watermarked image and recovered image, respectively. Compared with Fig. 7(a), the recovered image is nearly identical to the original image. This indicates that the proposed scheme is capable of removing the embedded information such that the recovered image is nearly equivalent to the original image; therefore, CARVW can preserve Essential 1.

@&#CONCLUSIONS@&#
