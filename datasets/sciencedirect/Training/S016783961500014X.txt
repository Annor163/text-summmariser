@&#MAIN-TITLE@&#
Constructing B-spline representation of quadratic Sibson–Thomson splines

@&#HIGHLIGHTS@&#
B-spline basis of Sibson–Thomson splines.Refinement equation.Quasi-interpolants.

@&#KEYPHRASES@&#
Sibson–Thomson split,B-spline,Refinement equation,Blossoming,Marsden's identity,Quasi-interpolation,

@&#ABSTRACT@&#
In this paper, we show how to construct a normalized B-spline basis for a specialC1continuous splines of degree 2, defined on Sibson–Thomson refinement. The basis functions have a local support, they are nonnegative, and they form a partition of unity. The dilatation equation can be found by applying the dyadic subdivision scheme directly to the Sibson–Thomson spline basis functions. As an application, a quasi-interpolation method, based on this Sibson–Thomson B-spline representation, is described which can be used for the efficient visualization of gridded surface data.

@&#INTRODUCTION@&#
Sibson–Thomson (ST) splines are functions in the spaceS21(Δ2⁎)ofC1continuous piecewise quadratic functions on a ST refinement (uniform criss-cross triangulation). Such a refinementΔ2⁎can be obtained from a rectangular mesh by dividing each rectangular patch into four rectangles by arbitrary parallels to its vertical and horizontal edges. Then, each subrectangle is subdivided into four triangles by its diagonals. The structure of these splines has been analyzed in Beatson and Ziegler (1985), Lorente-Pardo et al. (2000), Sibson and Thomson (1981), Sibson (1980) and they can be computed in Bernstein–Bézier form (Farin, 1986; Lorente-Pardo et al., 2000). In Dubuc and Merrien (1999), given f and ∇f at the vertices of a rectangular mesh, Dubuc and Merrien have studied an algorithmHR1building an interpolatingC1function. As an example, they show that the ST element can be obtained byHR1. The connection between the refinable Hermite interpolant and ST Hermite interpolation on subrectangles was described in Han et al. (2003).Sorokina and Zeilfelder (2004) have presented a method to construct quasi-interpolation operators based on quadraticC1-splines on uniform type-2 triangulation. The Bernstein–Bézier coefficients of the piecewise quadratic polynomials are directly determined by appropriate combinations of the data values. Their motivation, it seems difficult – if not impossible – to construct local and stable bases for splinesC1-splines on uniform type-2 triangulation. However, representing complex surfaces requires the use of a large number of Bézier triangles. Preserving a certain degree of continuity between all patches results in a large set of non-trivial relations between their Bézier ordinates. These relations are hard to implement and they hinder the designer to make predictable local changes (Vanraes, 2004). On the other hand, the operator described in Sorokina and Zeilfelder (2004) was first developed in Chui and He (1986) (see also Dagnino and Lamberti, 2005; Sablonnière, 2003) by using a completely different approach based on the so-called box-splines, which are locally supported and not linearly independent splines. A well-known example where linear independence does not hold is theC1-quadratic Zwart–Powell element defined on a four-directional (criss-cross) partition of the plane (Wang, 2001).The aim of this paper is to show that ST splines could be compactly represented in a normalized B-spline basis. The basis functions have a local support, they are nonnegative, and they form a partition of unity. This representation has an intuitive geometric interpretation involving tangent control triangles. There exist many sets of basis functions with a similar construction based on Powell–Sabin partitions with different degrees (see for example Dierckx, 1997; Lamnii et al., 2014; Speleers, 2010a, 2013b). Similar B-spline representation for bivariate reduced Clough–Tocher splines has been considered in Speleers (2010b). Recently, a simplex spline basis for theC1-quadratics on the Powell–Sabin-12 with all the usual properties of the univariate B-spline basis was discovered (Cohen et al., 2013).In addition, we discuss dyadic subdivision scheme for the ST spline surfaces. The goal is to calculate the B-spline representation of a surface on a dyadic refinement of the given triangulation. More precisely, we show that the basis functions are translated and dilated of one vectors of scaling function. Hence, the dilatation equation can be found by applying the subdivision scheme directly to the ST spline basis functions. Moreover, we use some results on blossoming to establish general Marsden identities representing polynomials of at most degree 2 in terms of ST B-splines ofC1-smoothness. As a consequence, we employ the bivariate polarization formulas to construct different families of differential and discrete quasi-interpolants (q.i.s.) reproducing bivariate polynomials of degree 2 and have an optimal approximation order.The paper is organized as follows. Section 2 recalls the definition of the ST spline space. Section 3 describes the construction of a normalized B-spline basis, which is based on determining a set of triangles that contain a specific set of points, and the Marsden's identity for theC1-continuous ST splines. In Section 4 we discuss dyadic subdivision scheme for the ST spline surfaces. In Section 5, we present an approach to construct the q.i.s. based on this representation. The approach is illustrated by the construction of Hermite interpolant and particular q.i.s. based on function evaluations. Finally, in order to illustrate our results, we give in Section 6 some numerical examples.Leth>0,n,m≥2and{(xi,yj)=(ih,jh),0≤i≤n,0≤j≤m}be the set of(n+1)×(m+1)points in the rectangular domainR:=[0,nh]×[0,mh]. Then the collection of rectanglesRi,j:=[xi,xi+1]×[yj,yj+1], wherei=0,…,n−1,j=0,…,m−1, forms a partition of R. The so-called ST refinementΔ2⁎of R is defined by dividing each rectangleRi,jinto four rectangles by arbitrary parallels to its vertical and horizontal edges. Then, each subrectangle is subdivided into four triangles by its diagonals: thus, ST partition does define a uniform criss-cross triangulation consisting of 16 triangles (see Fig. 1).The ST spaceS21(Δ2⁎)is the space of piecewise quadraticC1continuous functions on a ST refinementΔ2⁎, with additional smoothness around some edges. More precisely, for each functions∈S21(Δ2⁎),∂s/∂xis linear along the edgesx=xiandx=xi+1of the subrectangleRi,jand the derivative∂s/∂yis linear along the edgesy=yjandy=yj+1. It is well known (cf. Sibson and Thomson, 1981) that the dimension ofS21(Δ2⁎)is3(n+1)(m+1). Furthermore, any element ofs∈S21(Δ2⁎)is uniquely specified by its value and its gradient atVi,j:=(xi,yj)T, fori=0,…,nandj=0,…,m, and can be locally constructed on each triangle ofΔ2⁎once these values and gradients are given, see Farin (1986), Sibson and Thomson (1981). Hence, for any given set of(fi,j,fx,i,j,fy,i,j)-values, a splines∈S21(Δ2⁎)can be defined by means of the following Hermite interpolation problem:(1)s(Vi,j)=fi,j,∂s∂x(Vi,j)=fx,i,j,∂s∂y(Vi,j)=fy,i,j,fori=0,…,nandj=0,…,m.LetPddenote the linear space of algebraic polynomials of degree less than or equal to d. We use the piecewise Bernstein–Bézier representation (B-form) of the splines, i.e., for each splines∈S21(Δ2⁎), the polynomial piecep=s|T∈P2on a triangleT∈Δ2⁎is given byp(x,y)=∑i+j+k=2bi,j,kBi,j,kd(λ1,λ2,λ3).HereBi,j,kd=2i!j!k!λ1iλ2jλ3kare the six quadratic Bernstein polynomials associated with T, andλ=(λ1,λ2,λ3)are the barycentric coordinates of a point(x,y)T∈R2with respect to the triangle T.We now show how to compute the Bernstein–Bézier representation of the ST spline satisfying (1). In order to simplify the construction, we develop the ST element on a reference squareS(V1,V2,V3,V4)of verticesVi,i=1,…,4(see Fig. 1). SettingA1=12(V1+V2),A2=12(V2+V3),A3=12(V3+V4),A4=12(V4+V1),B1=12(Z+V1),B2=12(Z+V2),B3=12(Z+V3),B4=12(Z+V4),Z=12(V1+V3).Suppose that the ST-spline s is defined by means of interpolation problem (1). On each micro-triangle in the squareS(V1,V2,V3,V4), the spline s is a quadratic polynomial that can be represented in its Bernstein–Bézier formulation. The corresponding Bézier ordinates are schematically represented in Fig. 2.In view of theC1-smoothness at vertexV1, the Bézier ordinates in the neighborhood ofV1are found as(2)a1=s(V1),(3)a2=a1+12(A1−V1).∇s(V1),(4)a3=a1+12(B1−V1).∇s(V1).Similarly, the coefficientsa5,…,a16can be computed from theC1smoothness condition atVi,i=2,3,4. By theC1smoothness atA1we obtain(5)a17=12(a2+a8).The coefficientsa18,a19,a20can be computed in the same way.Using straightforward computations, we obtain(6)a21=−a12−a52+a3+a7,with similar formulas fora22,a23anda24.We also have(7)a25=12(a2+a21).In the same way,a27,…,a32can be determined.Similarly, we have(8)a33=12(a32+a25),(9)a37=12(a24+a21).Finally, we get(10)a41=12(a21+a23).By using a similar argument, we can determine the expression ofa34,a35,a36,a38,a39,a40.In this section, a basis ofS21(Δ2⁎)can be constructed in a similar way as for the basis described in Dierckx (1997) for the quadratic Powell–Sabin spline space. More precisely, we are looking a B-spline representation for ST-splines(11)s(x,y)=∑i=0n∑j=0m∑k=13ci,j,kBi,j,k(x,y),(x,y)T∈R,where the basis functions satisfy(12)Bi,j,k(x,y)≥0,1=∑i=0n∑j=0m∑k=13Bi,j,k(x,y),and have local support.To construct the basis functionsBi,j,k, we use a geometric method suggested by Dierckx (1997) and some results presented in Speleers (2013b).LetMi,jbe the subset of R consisting of the points belonging to the union of all the rectanglesRi1,j1=[xi1,xi1+1]×[yj1,yj1+1]containing the vertexVi,j. From the Bézier–Bernstein representation, it is immediate to see that if we would like ST B-splines to have minimal support then the support for anyBi,j,kis contained inMi,j.For each vertexVi,jthe three functionsBi,j,k(x,y),k=1,2,3, can be locally constructed over theMi,jonce their values and gradients at each vertex are given. Due to the structure of the support we haveBi,j,kis zero with its first derivatives at any vertex except forVi,j. Moreover, we denote:(13)βi,j,kab:=∂a+b∂xa∂ybBi,j,k(Vi,j)for0≤a+b≤1.For each vertexVi,jwe associate an arbitrary triangleti,j(Qi,j,1,Qi,j,2,Qi,j,3)with verticesQi,j,k=(Xi,j,k,Yi,j,k)T,k=1,2,3. From such a ST triangle one can uniquely determine the values{βi,j,kab,0≤a+b≤1}of the three B-splinesBi,j,kat the vertexVi,jas(βi,j,100βi,j,200βi,j,300βi,j,110βi,j,210βi,j,310βi,j,101βi,j,201βi,j,301)(Xi,j,1Yi,j,11Xi,j,2Yi,j,21Xi,j,3Yi,j,31)=(xiyj1xiyj1xiyj1)More precisely, from Speleers (2013b) we have(14)βi,j,1ab=∂a+b∂xa∂ybB1001(Vi,j),βi,j,2ab=∂a+b∂xa∂ybB0101(Vi,j),βi,j,3ab=∂a+b∂xa∂ybB0011(Vi,j),for all0≤a+b≤1, whereBi1i2i31are the Bernstein basis polynomials of degree 1 with respect to a triangleti,j. Consequently, the B-splinesBi,j,k(x,y)constructed using the set of trianglesti,jform a partition of unity and the following expansions holdx=∑i=0n∑j=0m∑k=13Xi,j,kBi,j,k(x,y),y=∑i=0n∑j=0m∑k=13Yi,j,kBi,j,k(x,y).The positivity of a normalized ST-basis depends on finding a set of ST-triangles that must contain a number of specified points. LetZ:={Zi,j=(Vi,j+Vi+1,j+1)/2,0≤i≤n−1,0≤j≤m−1}the set of the centers of all squaresRi,j. We can then give a geometric approach to satisfy the nonnegativity conditions.Theorem 1The B-splinesBi,j,k(x,y)constructed using a set of trianglesti,jare nonnegative onRi,jif each triangleti,jcontains its corresponding vertexVi,jand the points34Vi,j+14Vi+1,j,12(Vi,j+Zi,j),34Vi,j+14Vi,j+1.We use a similar line of argument as in the Powell–Sabin splines (see Section 4 of Dierckx, 1997) and reduced cubic Clough–Tocher splines (see Section 3.2 of Speleers, 2010b). We consider again the macro-squareS(V1,V2,V3,V4)depicted in Fig. 1 such that the corresponding B-splines with respect to a vertexV1are noted byB1,k,k=1,2,3. The Bernstein–Bézier representation of the B-splineB1,kis schematically represented in Fig. 3. In order to derive the conditions for the nonnegativity ofB1,kon the squareS(V1,V2,V3,V4), it is sufficient to request(15)di≥0,i=1,…,6.PutP1=V1,P2=12(V1+A1),P3=B1,P4=12(V1+A4).Without loss of generality we assumek=1. We recall from (13) and (14) that(16)∂a+b∂xa∂ybB1,1(V1)=β1,1abfor0≤a+b≤1,whereβ1,1ab=∂a+b∂xa∂ybB1001(V1),withB1001is the Bernstein polynomial of degree 1 with respect to a trianglet1(Q1,Q2,Q3).Let us denotef(V):=B1001(V), then(17)f(V)=f(V1)+(V−V1).∇f(V1).As presented in above section, we haved1=f(V1)=f(P1),d2=d1+12(A1−V1).∇f(V1)=f(A1+V12)=f(P2),d3=f(P1+P32),d4=f(P4),d6=d5=−12d1+d3=12f(V1)+12(B1−V1).∇f(V1)=12f(P3).Each Bernstein polynomial is nonnegative on its domain triangle. It follows thatf(V)≥0for allV∈t1. It follows that the nonnegativity conditions (15) for B-splineB1,1on rectangleS(V1,V2,V3,V4)are satisfied when the trianglet1contains the pointsP1,P2,P3andP4.  □Summarizing, the ST B-splines associated to each vertexVi,jare uniquely associated to the triple of pointsQi,j,k,k=1,2,3, forming the ST triangle. ST triangles are very useful to geometrically identify and describe ST B-splines and their properties. ST triangles are not uniquely defined (see Fig. 4). One possibility for their construction is to calculate a triangle of minimal area subjected to the constraints of Theorem 1. As Powell–Sabin B-splines (Dierckx, 1997), we can propose an optimization strategy to select triangles with minimal area ensuring positivity of the corresponding ST B-splines.In the following result, we give Hermite interpolation rules forC1quadratic ST-splines in the normalized B-spline representation which is completely identical to what is known for Powell–Sabin splines, see Section 4.1 of Speleers (2013a) and reduced Clough–Tocher splines, see Eq. (4.2) given in Speleers (2010b).Proposition 2Lets∈S21(Δ2⁎), thens(x,y)=∑i=0n∑j=0m∑k=13(s(Vi,j)+(Qi,j,k−Vi,j).∇s(Vi,j))Bi,j,k(x,y),(x,y)T∈R.We shall study a ST B-spline representation of ST-splines of classC1or all quadratic polynomials in terms of their blossoms. The blossom of a polynomialp∈Pd(introduced in Ramshaw, 1989) is the unique multivariate polynomialB[pd]that satisfies the following three conditions:•B[pd]is symmetric,B[pd](z1,…,zd)=B[pd](zπ(1),…,zπ(d)),for any permutation π of the integers1,…,d.B[pd]is multiaffine,B[pd](z1,(αzˆ+βz˜),z3,…,zd)=αB[pd](z1,zˆ,z3,…,zd)+βB[pd](z1,z˜,z3,…,zd),whereα+β=1.B[pd]is diagonal,pd(z)=B[pd](z,…,z︸d), for allz∈R2.Proposition 3For anys∈S21(Δ2⁎)we haves(x,y)=∑i=0n∑j=0m∑j=13B[si,j](Vi,j,Q˜i,j,k)Bi,j,k(x,y),wheresi,jis the restriction of s to one of the triangles ofΔ2⁎havingVi,jas vertex.Corollary 1For any polynomialp∈P2, we havep(x,y)=∑i=0n∑i=0m∑k=13B[p](Vi,j,Q˜i,j,k)Bi,j,k(x,y),∀(x,y)T∈R.Dubuc and Merrien (1999) show that the quadratic finite element of ST can be constructed by Hermite dyadic interpolation. Lounsberg et al. (1997) proved that with every subdivision scheme, a sequence of nested linear spaces, with the corresponding basis functions, the scaling functions can be associated. It is then possible to associate the ST B-splines andHR1presented in Dubuc and Merrien (1999).In order to simplify the construction the uniform ST B-splines, we give explicitly the 3 B-spline functionsBk(x,y),k=1,2,3, on a reference square[−1,1]×[−1,1], where the center of their support is at(0,0)T. The three ST B-splines associated to a vertex(0,0)Tare uniquely associated to the triple of pointsQ1=(0,−12)T,Q2=(34,14)TandQ3=(−34,14)T, see Fig. 5.Any pointV=(x,y)Tin the plane of the triangle can be uniquely expressed in terms of the barycentric coordinatesλj(x,y),j=1,2,3with respect tot(Q1,Q2,Q3).Since,x=34λ2(x,y)−34λ3(x,y),y=−12λ1(x,y)+14λ2(x,y)+14λ3(x,y),1=λ1(x,y)+λ2(x,y)+λ3(x,y),it follows that(18)λ1(x,y)=13−4y3,(19)λ2(x,y)=2x3+2y3+13,(20)λ3(x,y)=−2x3+2y3+13.From (13), the three B-splinesBk(x,y),k=1,2,3are determined by(β0,100,β0,110,β0,101)=(13,0,−43),(β0,200,β0,210,β0,201)=(13,23,23)(β0,300,β0,310,β0,301)=(13,−23,23).Hence, Figs. 6, 7 and 8show respectively the Bézier representation of B-splinesBk(x,y),k=1,2,3. From the previous, it follows that for a given uniform ST-triangulation, the basis functions are translations of three functionsBk:B(u)=[B1(u)B2(u)B3(u)]Noted byϕj,j=1,2,3the classical Hermite basis of ST element. LetΦ=(ϕ1,ϕ2,ϕ3)T. From Dubuc and Merrien (1999), we have the following refinement equation:(21)Φ=∑α∈Z2A(α)Φ(2.−α),whereA(0,0)=[10001200012],A(η1,0)=[12−η10η18−1400014],A(0,η2)=[120−η20140η280−14],A(η1,η2)=[14−η12−η22η116−18−η1η28η216−η1η28−18],withη1,η2∈{±1}andsuppA={(0,0),±(1,0),±(0,1),±(1,1)}.Let us denoteM=(β0,100β0,200β0,300β0,110β0,210β0,310β0,101β0,201β0,301).It is easy to see that(22)B(u)=M.Φ(u).The dilatation equation, which expresses the multi-scaling function in terms of translations and dilations of itself, can be found by applying the subdivision scheme directly to the uniform ST-spline basis functions:(23)B=∑α∈Z2MA(α)M−1B(2⋅−α).Here, we are primarily interested in the case whereQ1=(0,−12),Q2=(34,14)andQ3=(−34,14).Then, we haveM=[130−4313232313−2323]andM−1=[111034−34−121414].By (23), we haveB=∑α∈Z2A¯(α)B(2.−α),whereA¯(0,0)=[231616162316161623],A¯(η1,0)=[13112(1−3η1)112(3η1+1)112(η1+1)112(1−2η1)13(η1+1)112(1−η1)13(1−η1)112(2η1+1)],A¯(0,η2)=[014(1−η2)14(1−η2)14(η2+1)14014(η2+1)014],A¯(η1,η2)=[018(η1−1)(η2−1)−18(η1+1)(η2−1)124(η1+3)(η2+1)−112η1(η2+1)124(η1(η2+4)+3)−124(η1−3)(η2+1)124(3−η1(η2+4))112η1(η2+1)],andsuppA¯={(0,0),±(1,0),±(0,1),±(1,1)}.We can now define a linear operatorQmappingC(R)onto the spaceS21(Δ2⁎). More precisely, for eachf∈C(R)we define(24)Qf=∑i=0n∑j=0m∑k=13λi,j,k(f)Bi,j,kwhereλi,j,kare suitable linear functionals. First of all we note that, if(25)f(Vi,j),∇f(Vi,j),i=0,…,n,j=0,…,m,are given, setting(26)λi,j,k(f):=f(Vi,j)+(Qi,j,k−Vi,j).∇f(Vi,j),then, from Proposition 2, expression (24) provides the unique element inS21(Δ2⁎)which interpolates the data (25). So, the scheme (24) with coefficients given by (26) is a quasi-interpolating (actually Hermite interpolating) scheme inS21(Δ2⁎)which obviously reproducesS21(Δ2⁎).In this subsection we introduce general methods that will be applied in Subsections 5.2 and 5.3 for the construction of bivariate quadratic q.i.s. More precisely, we introduce general methods for constructing q.i.s. of the form(27)Q[r]f=∑i=0n∑j=0m∑k=13λi,j,k[r]fBi,j,k(x,y)and satisfying(28)Q[r]f=f,for allf∈Pr,wherer=0,1,2andλi,j,k[r],i=0,…,n,j=0,…,m,k=1,2,3, are suitable linear functionals. The following results are essentially taken from Sbibih et al. (2009).Theorem 4Letr=0,1,2. For each0≤i≤n,0≤j≤mandk=1,2,3, letIi,j,k[r]fbe the unique polynomial inPr|Mi,jthat interpolates or approximates some scattered data values and derivatives of f such that for allp∈Pr, we haveIi,j,k[r]p(x,y)=p(x,y),for all(x,y)T∈Mi,j.Then, the q.i.Q[r]of the form(27)withλi,j,k[r]defined byλi,j,k[r]=B[Ii,j,k[r]f](Vi,j,Q˜i,j,k)satisfies(28).For each0≤i≤n,0≤j≤mandk=1,2,3, suppose that there exists a subtriangleτi,j,kofΔ2⁎, withVi,jas vertex, that contains the data sites which determine the polynomialIi,j,k[2]f. Then the q.i.Q[2]fof the form(27)reproducesS21(Δ2⁎), i.e.,Q[2]f=f,for allf∈S21(Δ2⁎).Let f be a function of classC3on R. For each0≤i≤n,0≤j≤m, andk=1,2,3, we letIi,j,k[r]fbe the Taylor polynomial of degreer≤2at the pointZi,j(k)=(xi,j(k),yi,j(k))T,Ii,j,k[r]f(x,y):=∑0≤l1+l2≤r1l1!l2!∂l1+l2∂xl1∂yl2f(xi,j(k),yi,j(k))(x−xi,j(k))l1(y−yi,j(k))l2.Consider the q.i.(29)Q[r]f(x,y)=∑i=0n∑j=0m∑k=13B[Ii,j,k[r]f](Vi,j,Q˜i,j,k)Bi,j,k(x,y).Hence, from Theorem 4,Q[r]freproduces all polynomials of degree r.We now give some examples with different choices ofZi,j(k). The Schoenberg–Marsden type schemeQ[1]f(x,y)=∑i=0n∑j=0m∑k=13f(Qi,j,k)Bi,j,k(x,y),can be obtained by choosingZi,j(k)=Qi,j,kin (29), withr=1. So that,Q[1]p=p,∀p∈P1.This Schoenberg operator has excellent shape preserving properties. For instance, it maps convex functions on convex functions.Forr=2, if we chooseZi,j(k)=Vi,j,0≤i≤n,0≤j≤mandk=1,2,3. Then, we have(30)B[Ii,j,k[2]f](Vi,j,Q˜i,j,k)=f(Vi,j)+(Qi,j,k−Vi,j).∇f(Vi,j).Hence, from Proposition 2 we deduce that the scheme (29) withZi,j(k)=Vi,j, is the Hermite interpolating scheme which obviously reproduces the whole spline spaceS21(Δ2⁎).Now, by choosingZi,j(k)=Qi,j,kin (29), for0≤i≤n,0≤j≤m,k=1,2,3, we getB[Ii,j,k[2]f](Vi,j,Q˜i,j,k)=f(Qi,j,k)−12(Qi,j,k−Vi,j)T∇2f(Qi,j,k)(Qi,j,k−Vi,k).Finally, as∇2p(Qi,j,k)=∇2p(Vi,j)for allp∈P2, we deduce that the q.i. (29) with coefficients(31)f(Qi,j,k)−12(Qi,j,k−Vi,j)T∇2f(Vi,j)(Qi,j,k−Vi,k)reproducesP2. We note that the formula (31) has also an equivalent for Powell–Sabin splines, see Theorem 2 in Manni and Sablonnière (2007).Frequently in practice one has to approximate given values at scattered data points where no derivative information is provided. In this case, we propose some q.i.s. based on point evaluators. More precisely, we look for q.i.s. of the form (27) with(32)λi,j,k[2](f)=∑l=16qi,j,k(l)f(Zi,j(k,l)),qi,j,k(l)∈R.More precisely, letZi,j(k,l),l=1,…,6, be six points satisfying a specific geometric configuration, for example the GC condition (see Chui and He, 1986). Then there exists a Lagrange basisLi,j(k,l)(x,y), such thatLi,j(k,l)(Zi,j(k,m))=δl,m,l,m=1,…,6, and the polynomial of degree 2Ii,j,k[2]f(x,y)=∑l=16f(Zi,j(k,l))Li,j(k,l)(x,y),interpolates f at the pointsZi,j(k,l),l=1,…,6.Consequently, from Theorem 4, we have the following result.Proposition 6LetQ[2]fbe any q.i. of the form(27)such that(33)λi,j,k[2](f)=∑l=16B[Li,j(k,l)](Vi,j,Q˜i,j,k)f(Zi,j(k,l)).Then,Q[2]p=p, for allp∈P2.In order to minimize the number of needed values of f, it is convenient to select the pointsZi,j(k,l),l=1,…,6as follows.Proposition 7For each0≤i≤n,0≤j≤mandk=1,2,3, if the pointsZi,j(k,l),l=1,2,3are collinear withVi,jandQ˜i,j,k. Then, we have(34)B[Li,j(k,l)](Vi,j,Q˜i,j,k)=0,forl=4,5,6.For each0≤i≤m,0≤j≤nandk=1,2,3we assume thatZi,j(k,l),l=1,…,6, satisfy the GC condition. The GC condition implies that(35)Li,j(k,l)(x,y)=Ri,j,k(l,1)(x,y)Ri,j,k(l,2)(x,y)Ri,j,k(l,1)(Zi,j(k,l))Ri,j,k(l,2)(Zi,j(k,l)),whereRi,j,k(l,1),Ri,j,k(l,2)are two lines containingZi,j(k,m),m=1,…,6, andm≠l. Hence, ifZi,j(k,l),l=1,2,3are collinear withVi,jandQ˜i,j,k, we deduce that forl=4,5,6,Ri,j,k(l,1)orRi,j,k(l,2)is the line(Vi,jQ˜i,j,k). Consequently, it is easy to verify that (34) is satisfied.  □We will work out a specific case study. Given a polynomialp∈P2. LetZijk,i+j+k=2, be 6 points satisfying a specific geometric configuration, for example the GC condition (see Chui and He, 1986). The geometric condition for bivariate interpolation is equivalent to the existence of a Lagrange formulas whose terms are products of linear factors. Then there exists a Lagrange basispijksuch thatpijk(V)=∏μ=0i−1aμ(V)aμ(Zijk)∏ν=0j−1bν(V)bν(Zijk)∏κ=0k−1cκ(V)cκ(Zijk)whereaμ,bνandcκare linear polynomials such thataμ:the line passing through the pointsZμjkwithμ+j+k=2,bν:the line passing through the pointsZiνkwithi+ν+k=2,cκ:the line passing through the pointsZijκwithi+j+κ=2.Then,p=∑i+j+k=2p(Zijk)pijk.We can then find the polar formB[p]by substituting the elementary symmetric functions into the Lagrange interpolant. Consequently, we getB[p]=∑i+j+k=2p(Zijk)B[pijk].An interesting question is how to construct sets of points satisfying the GC condition. Busch (1990) has been proved that the set of 6 points in the plane satisfying the GC condition must contain 3 collinear points. Some important examples have been given in Chui and He (1986), such as natural lattices and principal lattices. First example, consider the triangleTwith verticesA1,A2,A3. LetZijk=iA1+jA2+kA32,i+j+k=2.Then, these points satisfy the geometric characterization, see Chui and He (1986). Letλl=(λ1l,λ2l,λ3l)be the barycentric coordinates of the pointsPl,l=1,2, with respect to the triangleT. Using straightforward computations (see Speleers, 2014), we obtainB[pijk](P1,P2)=B[pijk](λ1,λ2)=1i!j!k!12∑π∈S2∏μ=0i−1(2λ1π(μ+1)−μ)∏ν=0j−1(2λ2π(i+ν+1)−ν)∏κ=0k−1(2λ2π(i+j+κ+1)−κ),whereS2is the group of all permutations on the 2 first natural numbers.We then arrive at the following theorems.Theorem 8LetQ[2]fbe any q.i. of the form(27)withλi,j,k[2](f)defined according to(32). Fori=0,…,n,j=0,…,mandk=1,2,3, letZi,j(k,1)=Vi,j,Zi,j(k,2)=ζi,j(k,2)Vi,j+(1−ζi,j(k,2))Q˜i,j,k,Zi,j(k,3)=Q˜i,j,kwithζi,j(k,2)≠0,1,andqi,j(k,1)=12(1−1ζi,j(k,2)),qi,j(k,2)=121ζi,j(k,2)(1−ζi,j(k,2)),qi,j(k,3)=−12ζi,j(k,2)(1−ζi,j(k,2)),qi,j(k,4)=qi,j(k,5)=qi,j(k,6)=0,the q.i.Q[2]fsatisfiesQ[2]p=p,∀p∈P2.LetQ[2]fbe any q.i. of the form(27)such thatλi,j,k[2](f)are defined according to(32). Fori=0,…,n,j=0,…,mandk=1,2,3, letZi,j(k,1)=(1−1ζi,j(k))Vi,j+1ζi,j(k)Qi,j,k,Zi,j(k,2)=−ζi,j(k)1−ζi,j(k)Vi,j+11−ζi,j(k)Qi,j,k,withζi,j(k)≠0,12,1, andqi,j(k,1)=(ζi,j(k))22ζi,j(k)−1,qi,j(k,2)=(1−ζi,j(k))22ζi,j(k)−1,qi,j(k,3)=qi,j(k,4)=qi,j(k,5)=qi,j(k,6)=0,then, the q.i.Q[2]fsatisfiesQ[2]p=p,∀p∈P2.For the second example, we considerZi,j(k,1)=Vi,j=(ih,jh)T,Zi,j(k,2)=(ih,jh−h2)T,Zi,j(k,3)=(ih,jh+h2)T,Zi,j(k,4)=(ih−h2,jh)T,Zi,j(k,5)=(ih+h2,jh−h2)T,Zi,j(k,6)=(ih+h2,jh+h2)T.Then, it is well known that{Zi,j(k,l)}l=16satisfies node configuration A (see Chui and Lai, 1987), hence it admits unique Lagrange interpolation. Using straightforward computations, we have an interesting spline q.i.Theorem 10LetQ[2]fbe any q.i. of the form(27)such thatλi,j,k(f)are defined according to(32). Fori=0,…,n,j=0,…,mandk=1,2,3, let(36)λi,j,1[2](f)=f(ih,jh)+12(f(ih,jh−h2)−f(ih,jh+h2))λi,j,2[2](f)=14(−f(ih,jh−h2)−3f(ih−h2,jh)+4f(ih,jh)+3f(ih+h2,jh)+f(ih,jh+h2))λi,j,3[2](f)=14(−f(ih,jh−h2)+3f(ih−h2,jh)+4f(ih,jh)−3f(ih+h2,jh)+f(ih,jh+h2)).The q.i.Q[2]fsatisfiesQ[2]p=p,∀p∈P2.Forf∈C(R)and any compact subsetG⊆R, we let‖f‖D:=sup⁡{f(u),u∈G}be the uniform norm. By standard arguments (see, e.g., Lai and Schumaker, 2007) we can establish an optimal order error bound of‖f−Q[2]f‖R, where f is a function in the classical spaceC3(R)andQ[2]is a q.i. defined by (27) which satisfies (28). In the next theorem, for anyf∈C3(R), we let‖D3f‖G:=sup⁡{‖DxaDybf‖G,a+b=3}whereG⊆RandDxfandDyfdenote the first derivatives of a function f in x and y directions, respectively.Proposition 11There exists a constantC2, depending only on the smallest angle inΔ2⁎such that for everyf∈C3(R),(37)‖DxaDyb(f−Q[2]f)‖R≤C2h3−a−b‖D3f‖R.We now derive error bounds for the discrete q.i.s.Q[2]defined in the previous section where the interpolation points verify the GC condition. Denoting by‖Q[2]‖Rthe corresponding induced norm, then ifQ[2]reproduces quadratic polynomials, we have‖f−Q[2]f‖R≤(1+‖Q[2]‖R)infp∈P2⁡‖f−p‖R.From properties (12) and (27), we have(38)‖Q[2]‖R≤maxi=0,…,n⁡maxj=0,…,m⁡maxk=1,2,3⁡|λi,j,k[2]|.Using (33), we obtain‖Q[2]‖R≤maxi=0,…,n⁡maxj=0,…,m⁡maxk=1,2,3⁡|∑l=16B[Li,j,k(l)](Vi,j,Q˜i,j,k)f(Zi,j(k,l))|,‖Q[2]‖R≤6‖f‖Rmaxi=0,…,n⁡maxj=0,…,n⁡maxk=1,2,3⁡maxl=1,…,6⁡|B[Li,j,k(l)](Vi,j,Q˜i,j,k)|.Using some elementary manipulations (see also Theorem 8 in Speleers, 2014), we can show that|B[Li,j,k(l)](Vi,j,Q˜i,j,k)|≤(max{Ai,j,k(p,q,r)>0,p,q,r=1,…,6}⁡1Ai,j,k(p,q,r))2(maxp=1,…,6⁡‖Vi,j−Zi,j(k,p)‖2)2(maxp=1,…,6⁡‖Q˜i,j,k−Zi,j(k,p)‖2)2,whereAi,j,k(p,q,r)=area(Zi,j(k,p),Zi,j(k,q),Zi,j(k,r)).We now give an error bound forf−Q[2]f, whereQ[2]fis the q.i. presented in Theorem 10.Theorem 12LetQ[2]be any q.i. of the form(27)withλi,j,k[2]defined according to(36). Then, for anyf∈C3(R),(39)‖f−Q[2]f‖R≤18h3‖D3f‖R.Since the proof is similar to the one of Theorem 6 given in Sorokina and Zeilfelder (2004), we can be brief. Let us fix T a split ofΔ2⁎, then there exists ap∈P2such that(40)‖f−p‖T≤‖f−p‖ΩT≤92h3‖D3f‖ΩT,whereΩTis the union of the triangles in thestar(T)(for the definition ofstar(T), see Lai and Schumaker, 2007). Using the linearity ofQ[2]and the fact thatQ[2]reproduces polynomials of degree 2, we can write(41)‖f−Q[2]f‖T≤‖f−p‖T+‖Q[2](f−p)‖T.It suffices to estimate the second quantity. By applying (27) and (38), it follows that(42)‖Q[2](f−p)‖T≤3‖f−p‖ΩT.Finally, we take the maximum over allT∈Δ2⁎to get (39).  □In order to illustrate the approximation properties and the visual quality of our splines, in this section we present some numerical results. We approximate the smooth bivariate test function of Franke typef(x,y)=34exp⁡(−(9x−2)2+(9y−2)24)+34exp⁡(−(9x+1)249−(9y+1)10)12exp⁡(−(9x−7)2+(9y−3)24)−15exp⁡(−(9x−4)2−(9y−7)2),on the domainR=[0,1]×[0,1].To measure the accuracy of a q.i.Q[2]fwe have computed the maximum error on a50×50uniform grid on R:(43)maxr,s=1,…,50⁡|f(xr,ys)−Q[2]f(xr,ys)|.The numerical results are given in Table 1. The first column indicates the refinement level. In the remaining columns, we have the values of the tabulated absolute error (43) for different q.i.s. In column 2 we have considered the Hermite interpolant see (30). Column 3 shows the results for the q.i. presented in Theorem 8 withζi,j(k,2)=12. Column 4 refers to the q.i. presented in Theorem 9 withζi,j(k)=14. Finally, column 5 shows the results for the q.i. presented in Theorem 10.

@&#CONCLUSIONS@&#
