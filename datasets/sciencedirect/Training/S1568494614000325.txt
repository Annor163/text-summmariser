@&#MAIN-TITLE@&#
Online identification of evolving Takagi–Sugeno–Kang fuzzy models for crane systems

@&#HIGHLIGHTS@&#
New evolving Takagi–Sugeno–Kang (TSK) fuzzy models dedicated to crane systems are proposed.A set of three evolving TSK fuzzy models are derived by an online identification algorithm.The models are tested and compared against the experimental data on a pendulum–crane equipment.The proposed TSK fuzzy models are simple and consistent with both training data and testing data.

@&#KEYPHRASES@&#
Crane systems,Evolving Takagi–Sugeno–Kang fuzzy models,Online identification algorithms,Pendulum–crane laboratory equipment,Potentials of new data points,Sum of squared errors,

@&#ABSTRACT@&#
This paper suggests new evolving Takagi–Sugeno–Kang (TSK) fuzzy models dedicated to crane systems. A set of evolving TSK fuzzy models with different numbers of inputs are derived by the novel relatively simple and transparent implementation of an online identification algorithm. An input selection algorithm to guide modeling is proposed on the basis of ranking the inputs according to their important factors after the first step of the online identification algorithm. The online identification algorithm offers rule bases and parameters which continuously evolve by adding new rules with more summarization power and by modifying existing rules and parameters. The potentials of new data points are used with this regard. The algorithm is applied in the framework of the pendulum–crane system laboratory equipment. The evolving TSK fuzzy models are tested against the experimental data and a comparison with other TSK fuzzy models and modeling approaches is carried out. The comparison points out that the proposed evolving TSK fuzzy models are simple and consistent with both training data and testing data and that these models outperform other TSK fuzzy models.

@&#INTRODUCTION@&#
The evolving Takagi–Sugeno–Kang (TSK) fuzzy systems are characterized by the continuous online learning for rule base learning [1–5]. Several algorithms for recursive parameter estimation, eventually associated with online clustering, are used with this regard accepting that the model structure evolves similarly to the model parameters, much slower as mentioned in [1].The online identification algorithms dedicated to evolving TSK fuzzy models have wide applications in several fields with some recent results outlined as follows. A hybrid evolving architecture with incremental learning which consists of two sequential and incremental learning modules is proposed in [6]. A semi-supervised classification method based on fuzzy pattern matching is suggested in [7] to aim the learning of membership functions with a limited initial data set. An incremental fuzzy rule-based system for classification applications is given in [8]. Approaches to handling drift and shift in on-line data streams by means of evolving TSK fuzzy systems are offered in [9]. The application of the robust incremental FLEXFIS approach to fuzzy modeling of the NOx emissions of a Diesel engine is discussed in [10]. The combination of a recursive Gustafson–Kessel clustering algorithm and of the fuzzy recursive least squares method is treated in [11] and applied to two chemical processes. Approaches to reduce the complexity of evolving TSK fuzzy systems by eliminating local redundancies during training, evolving the models on on-line data streams are investigated in [12]. An unsupervised pattern recognition method for the clustering step of the identification of temporally switched linear hybrid dynamic systems is proposed in [13]. The combination of evolving classifiers with tree-based user profiling is suggested in [14] to create and recognize automatically the behavior profile of computer users. Evolving TSK fuzzy systems for pricing fixed income options are analyzed in [15]. The sliding mode control approach is integrated in incremental learning algorithms and validated by simulation of two nonlinear system identification problems in [16].The crane control systems are important in industry as translational electromechanical systems. These systems can also operate in combination with pendulum systems resulting in inverted pendulum systems or pendulum–crane systems in the framework of Multi Input–Multi Output (MIMO) systems. The crane control systems can focus on either the cart position control as Single Input-Single Output (SISO) control systems or on the position control of the cart and on the downward angular position control of the pendulum. The process models for crane systems can involve the cart position, as considered in this paper, and the pendulum angular position as well.Attractive examples of fuzzy models of crane systems, referred to also as gantry crane systems or as cart systems, were recently reported in the literature. The fuzzy modeling of a container gantry crane is included in [17] in a fault detection scheme for fault tolerant control. The universal fuzzy control problem based on generalized TSK fuzzy models is discussed in [18] and applied to pendulum systems. A three-rule TSK fuzzy model with a saturated input is suggested in [19] to model an overhead crane system and to control it by means of state-feedback fuzzy control. These results are considered in the general framework of fuzzy modeling of nonlinear dynamic system with fuzzy logic control applications [20–30].This paper proposes an online identification algorithm dedicated to the derivation of evolving TSK fuzzy models. The new functionalities of this algorithm are:-The algorithm is inspired from [31], and it offers rule bases and parameters which continuously evolve by adding new rules with more summarization power.The existing rules and parameters are modified in terms of using the potentials of new data points.These functionalities are advantageous in comparison with other online identification algorithms for evolving TSK fuzzy models because our algorithm ensures a relatively simple and transparent implementation. In addition, the algorithm leads to TSK fuzzy models with improved performance for an illustrative class of nonlinear systems represented by crane systems. These advantages are highlighted by means of the following novel contributions of this paper with respect to the state-of-the-art in evolving TSK fuzzy models [1–16] and in fuzzy models for crane systems [17–30]:-A novel, simplified and transparent implementation of an online identification algorithm of evolving TSK fuzzy models is proposed. Our algorithm is characterized by the already mentioned two functionalities which make the evolving TSK fuzzy models have the ability to evolve the rule base efficiently such that to capture the nonlinearities of the process.A set of three evolving TSK fuzzy models with one to three inputs for crane systems are offered. The experimental results validate these models by the application of the algorithm on the pendulum–crane system laboratory equipment. The models are compared with three other TSK modeling approaches: a batch modeling approach represented by the adaptive-network-based fuzzy interference system (ANFIS) [32] which is very popular in fuzzy modeling of crane systems [17–30], the eFS Lab implementation [33,34] of the online identification algorithm of evolving TSK fuzzy models proposed in [31], and the evolving TSK fuzzy modeling approach represented by Dynamic Evolving Neural-Fuzzy Inference System (DENFIS) [35–37]. The comparison with these TSK fuzzy models shows that the proposed evolving TSK fuzzy models ensure the performance enhancement on both training and validation data in a computationally undemanding manner.The input selection is an important problem for the online identification algorithm suggested in this paper. A straightforward approach to select the most important input variables is to compare all possible combinations by using a predefined evaluation criterion applied in [38] to select the most relevant inputs for ANFIS learning. Using the importance factor of a certain input defined in [39] in the framework of input selection based on neural networks, this paper proposes an input selection algorithm which ranks the inputs according to their importance factors after the first step of the online identification algorithm. This algorithm is useful to guide modeling.This paper addresses fuzzy modeling. The fuzzy models will next be used in the model-based design of stable and optimal fuzzy control systems. The typical MIMO control system structure for the pendulum–cart system employs the cart and pendulum controllers. The low-cost design of linear controllers has been carried out successfully and validated by experimental results in [40–42], and the iterative experiment-based improvement of linear and of fuzzy controllers for nonlinear processes has been addressed in [43,44].The paper is organized as follows. Section 2 presents the application-oriented derivation of the evolving TSK fuzzy models and the new input selection algorithm. Section 3 gives the experimental validation of the proposed TSK fuzzy models for a laboratory pendulum–cart system and offers a discussion of the results. Although the laboratory process is nonlinear and time-invariant, it models industrial applications of crane systems which are characterized by parametric disturbances that justify the derivation of evolving TSK fuzzy models. This Section 4 highlights the conclusions and presents future research directions.Fig. 1shows the block diagram of a pendulum–cart system [45], where: x1 – the cart position (the distance from the center of the rail), x2 – the angle between the upward vertical and the ray pointing at the center of mass cart (x2=0 for the upright position of the pendulum), F–the control force, parallel to the rail, produced by the direct current (DC) motor and applied to the cart, F is proportional to the pulse-width modulation (PWM) voltage signal (the control signal) u constrained to |u(t)|≤umax>0 and, mc– the equivalent mass of the cart, mp– the mass of the pendulum (pole+load), and ld– the distance from the axis of rotation to the center of mass. Introducing the cart velocity as the third state variable x3 and the pendulum angular velocity as the fourth state variable x4, the state equations of the process (the independent time argument is omitted for the sake of simplicity) are(1)x˙1=x3,x˙2=x4,x˙3={Jp/(mc+mp)ld[(p1u/(mc+mp)ld)−x42sinx2−((fc−p2)x3/(mc+mp)ld)]+[gsinx2−(fpx4/(mc+mp)ld)]cosx2}[(Jp/(mc+mp)ld2)−cos2x2],x˙4={[(p1u/(mc+mp)ld)−x42sinx2−((fc−p2)x3/(mc+mp)ld)]cosx2+(1/ld)[gsinx2−(fpx4/(mc+mp)ld)]}[(Jp/(mc+mp)ld2)−cos2x2],where Jpthe moment of inertia of the pendulum–cart system with respect to the axis of rotation, p1 the control force to PWM signal ratio, p2 the control force to cart velocity ratio,(2)F=p1u+p2x3,fp– the rotational friction coefficient, and fc– the dynamic cart coefficient. The specific parameter values used in our experimental setup are [40,45]: umax=0.5, mc=0.76kg, mp=0.052kg, ld=0.011m, Jp=0.00292kgm2, p1=9.4N, p2=−0.548Ns/m, fp=6.65×10−5Nms/rad and fc=0.5Ns/m.The unified expression of the rule base of the TSK fuzzy models of the crane system, viewed as a nonlinear dynamic process and considered in this paper is(3)Rulei:IF(z1ISLTi1)AND…AND(znISLTin)THEN(yi=ai0+ai1z1+⋯+ainzn),i=1…nR,where nR is the number of rules, zj, j=1…n, are the input variables, n is the number of input variables, LTij, i=1…nR, j=1…n, are the input linguistic terms, yiis the output of the local crisp system yi=ai0+ai1z1+⋯+ainznin the rule consequent of rule i, i=1…nR, and ail, i=1…nR, l=0…n, are the parameters in the rule consequents. The fuzzy sets of the input linguistic terms LTij, i=1…nR, j=1…n, are modeled by Gaussian membership functions which produce the membership degrees(4)μij(zj)=e−(4/rs2)(zj−zij*)2,i=1…nR,j=1…n,where rs, rs>0, is the spread of all input membership functions andzij*,i=1…nR,j=1…n,are the centers of input membership functions μij, i=1…nR, j=1…n.Accepting the algebraic product t-norm to model the AND operator, each rule generates the firing degree τi(z) according to(5)τi(z)=AND(μi1(z1),μi2(z2),…,μin(zn))=μi1(z1)⋅μi2(z2)…μin(zn),wherez=[z1z2…zn]Tis the input vector, and the superscript T indicates the matrix transposition.The weighted average defuzzification method leads to the output y of the TSK fuzzy model:(6)y=∑i=1nRτiyi∑i=1nRτi=∑i=1nRλiyi=∑i=1nRλi[1zT]Tπi,whereλi=τi/[∑i=1nRτi],i=1…nR,are the normalized firing degree of rule i, andπi=[ai0ai1ai2…ain]T,i=1…nR,is the parameter vector of rule i.Considering the following data point as the vector p in the input–output data space Rn+1:(7)p=[zTy]T=[z1z2…zny]T=[p1p2…pnpn+1]T∈Rn+1,the online identification algorithm uses the potential of the data pointpk=[pk1pk2…pkn+1]T, which corresponds to p at the discrete time step k, defined as the first order Cauchy type function [31]Pk(pk)(8)Pk(pk)=11+(1/(k−1))∑l=1k−1∑j=1n+1(dlkj)2,dlkj=plj−pkj,k=2…D,wheredlkjis the projection of the distance between the data points pland pkon the axis pj, j=1…n+1, and D is the number of input–output data points. The calculation of the potential of a new data sample is carried out by means of(9)Pk(pk)=k−1(k−1)(ϑk+1)+σk−2νk,where(10)ϑk=∑j=1n+1(pkj)2,σk=∑j=1n+1∑l=1k−1(plj)2,νk=∑j=1n+1(pkj∑l=1k−1plj).The parameters in the rule consequents are computed using a least squares approach. The expression of the TSK fuzzy model output in (6) is organized in terms of the following vector form to enable this approach:(11)y=ψTθ,ψ=λ11zTλ21zT…λnR1zT,θ=π1Tπ2T…πnRTT.For the given set of input–output data(12)pk|k=1...Dthe global objective function is defined as(13)JG(θ)=∑k=1D(yk−ψkTθ)2,ψkT=λ1(zk)[1zkT]Tλ2(zk)[1zkT]T…λnR(zk)[1zkT]TTwhere zkis the vector z at the discrete time step k. The minimization of the objective function JG(θ) can be achieved by the recursive least squares algorithm referred to also as the Kalman filter and characterized by the recurrent equations [46,47](14)θˆk=θˆk−1+Ckψk−1(yk−ψk−1Tθˆk−1),Ck=Ck−1−Ck−1ψk−1ψk−1TCk−11+ψk−1TCk−1ψk−1,k=2…D,with the initial conditions(15)θˆ1=[(π1T)1(π2T)1…(πnRT)1]T=[00…0]T,C1=ΩIwhere Ck∈RnR(n+1)×nR(n+1) is the covariance matrix, I is the nR(n+1)th order identity matrix, Ω=const, Ω>0, is a large number, andθˆkis an estimation of the parameters in the rule consequents at the discrete time step k.The online identification algorithm, which leads to evolving TSK fuzzy models, consists of seven steps. The steps of the online identification algorithm are presented as follows by the novel application-oriented implementation of the recursive procedure given in [31].Step 1. The initialization of the rule base structure, viz. the initialization of the parameters in the rule antecedents. The rule base is initialized such that to contain a single rule, nR=1, and the subtractive clustering [46] can be applied to obtain the parameters of the TSK fuzzy models using the first data sample p1. The parameters are initialized using (15), the default value rs=0.4, andStep 2. At the next time step, k is set to k=k+1, and the next data sample pkis read.Step 3. The potential of each new data sample is computed using (9) and (10).Step 4. The potentials of the centers of existing rules (clusters) are recursively updated by [48]Step 5. The possible modification or upgrade of rule base structure is carried out on the basis of the potential of the new data compared to the potential of existing rules’ centers. The rule base structure is modified if the condition pointed out in the sub-step 5.1 is fulfilled, and a new rule is added if the condition specified in the sub-step 5.2 is fulfilled.Sub-step 5.1. If the potential of the new data point is higher than the potential of the existing centers:In this sub-step, the new data point is used as a prototype of the rule center, supposed to have the index j:(20)pj*=argmini=1nR||pk−pi*||,the new center is characterized by(21)zj*=zk,Pk(pj*)=Pk(pk),and the parameters in the rule consequents and the covariance matrices are inherited from the rule to be replaced:(22)πˆk=πˆkj,Ck=Ckj.Sub-step 5.2. If the potential of the new data point is higher than the potential of the existing centers as shown in (18)and the condition (19) is not fulfilled, then the new data point is added to the rule base as the center of a new rule:The parameters in the rule consequents and the covariance matrices are reset by [31](24)θˆk=πˆ1(k−1)Tπˆ2(k−1)T…πˆnR(k−1)Tπˆ(nR+1)kTT,πˆ(nR+1)k=∑i=1nRλiπˆi(k−1),Ck=ρς11…ρς1nR(n+1)0…0………………ρςnR(n+1)1…ρςnR(n+1)nR(n+1)0…0000Ω…0………………0000…Ω,ρ=[nR2+1]/nR2,where ςijis an element of the co-variance matrix, i, j=1…nR(n+1).Step 6. The parameters in the rule consequents are recursively updated using (14) with the initializations (15).Step 7. The evolving TSK fuzzy model's output at the next discrete time step k+1 is predicted by the particular expression of (11):The algorithm continues with step 2 until all data points are read. Step 1 is carried out offline, and steps 2–7 are carried out online.The dynamics is introduced in the TSK fuzzy models of the crane system in terms of considering several past values of the control signal u and eventually of the cart position y=x1. An input selection algorithm is proposed as follows in order to select the important input variables from all possible input variables as an important problem in system modeling. The algorithm consists of the following steps that guide modeling.Step A. The algorithm is initialized in terms of setting its parameters λ, 0<λ<1 – the importance threshold, and τ, 0<τ<1 – the significance threshold.Step B. The step 1 of the online identification algorithm is run to obtain the initial TSK fuzzy model. The input variable zj, j=1…n, is applied to this TSK fuzzy model, the outputs yj,kof the initial TSK fuzzy model at the discrete time moment k, k=1…D, are read. The change rangeRzjthat corresponds to the input variable zj, j=1…n, is calculated:As shown in [39], the most important input variable is characterized byIzj=1. Eqs. (26) and (27) show that a large change rangeRzjand a large importance factorIzjindicate a big influence of the corresponding input variable zj, j=1…n. Contrarily, small values ofRzjandIzjpoint out a relatively unimportant input variable zj, j=1…n.Step C. The importance of all input variables is ranked according to the values of the importance factorsIzj,j=1…n.Step D. All input variables that fulfill the conditionStep E. The closely related input variables are recognized in order to conduct the independent input variable testing by the calculation of the correlation functions, Corr(zi,zj), between the selected input variables ziand i, j=1…nr:

@&#CONCLUSIONS@&#
This paper has suggested a set of TSK fuzzy models dedicated to crane systems. The models are derived by the application of a novel implementation of an online identification algorithm which gives continuously evolving rule bases and parameters. The application of the online identification algorithm is assisted by a new input selection algorithm to guide modeling.The main advantages of our approach are the simplicity of TSK fuzzy models, their consistency with both training data and testing data, and the simplicity and transparency of the online identification algorithm. These advantages should be also emphasized in other suggestive applications.The TSK fuzzy models are validated against experimental data which correspond to a pendulum–crane system laboratory equipment as a representative nonlinear dynamic system. The comparison of experimental results shows the performance improvement ensured by the proposed TSK fuzzy models with respect to other fuzzy models obtained by other similar approaches. The comparison can continue accounting for other state-of-the-art algorithms for evolving fuzzy systems [5] and for other input selection algorithms [55–58].Future research will deal with the extension of the online identification algorithm to the modeling of MIMO nonlinear dynamic systems. The development of fuzzy models for the pendulum angle x2 will be addressed as well and the combination of fuzzy models for both x1 and x2 will target the reduction of oscillations in crane control systems. The data-driven experiment-based calculation of gradients of objective functions will be included in order to ensure the online identification of closed-loop fuzzy control systems. The objective of these fuzzy models is the model-based design of stable and optimal fuzzy control systems.