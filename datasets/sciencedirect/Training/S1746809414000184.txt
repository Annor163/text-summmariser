@&#MAIN-TITLE@&#
A comparison of upper-limb motion pattern recognition using EMG signals during dynamic and isometric muscle contractions

@&#HIGHLIGHTS@&#
STFT-ranking feature was employed for multi-channel EMG signal analysis.Motion pattern recognition using dynamic or isometric EMG signals was compared.Recognition accuracy over 90% was achieved applying the STFT-ranking feature.Inconsistent EMG signals in training and validation phases yield a negative effect.

@&#KEYPHRASES@&#
Electromyography,Exoskeleton robot,Motion pattern recognition,Support vector machine,

@&#ABSTRACT@&#
Multichannel electromyography (EMG) signals are one of the common methods used in human motion pattern recognition. In exoskeleton robot control, EMG signals are measured during dynamic or isometric muscle contractions. Various types of contraction can cause EMG signals to vary, affecting recognition performance. A motion pattern recognition model using EMG signals from either dynamic or isometric muscle contractions has not yet been fully investigated. In this study, a novel feature extraction method, using the short-time Fourier transform ranking (STFT-ranking) feature, was employed to determine multichannel EMG signals. The performance of the novel feature and conventional features for motion pattern recognition using EMG signals, which included time-domain and frequency-domain features, was compared during dynamic and isometric muscle contractions. Experiments were conducted using an exoskeleton robotic arm to aid users in generating EMG signals of designated motion patterns. Among the features tested, the STFT-ranking feature yielded an accuracy rate exceeding 90% when the EMG signals used in the training and validation feature data sets were of the same type of muscle contraction. After examining the STFT-ranking feature projected onto the PCA space, the STFT-ranking feature was determined to offer more satisfactory performance than the other features tested for motion pattern recognition, because the feature data it collected from various motion patterns were more separable. The experimental results also revealed that it is preferable that EMG signals from the same type of muscle contraction, whether dynamic or isometric, are consistently used in both the training and validation (control) phases. Inconsistent EMG signals in the training and validation phases yielded a negative effect on motion pattern recognition performance. The methodology developed in this study has potential applications in exoskeleton robot control and rehabilitation.

@&#INTRODUCTION@&#
Human–machine interfaces (HMI) are media that handle human–machine interactions, and play a crucial role in numerous applications, particularly robotics. Among the many HMI modes, biomedical signals are crucial for HMI implementation. Biomedical signals contain an abundance of information, and employing biomedical signals can result in a user-friendly interface allowing easy control of electromechanical systems. Electromyography (EMG) is one type of biomedical signals, and collects information regarding activated skeletal muscles. Thus, the use of EMG signals is not only beneficial in medical diagnoses, but can also be helpful in controlling robots and assistive devices used for rehabilitation. To enable robotics or assistive devices to be controlled using EMG signals, two methods are discussed in this paper. In the first method, a muscle skeleton model is estimated and built by employing EMG signals. In the second method, features are extracted from EMG signals, and a motion pattern recognition model is built using a machine-learning algorithm.To establish a muscle skeleton model, one conventional method is to apply a Hill-based model. The Hill-based model applies contractile, series, and parallel elements to approximate the mechanical behavior of muscles [1]. Rosen et al. presented a robotic arm control method using the Hill-based model [2]. In their report, the motion of a joint was estimated using the Hill-based model, and the motion information was used to control a powered robotic arm system. In addition to the Hill-based model, Fleischer et al. proposed a dynamic human body model (DHBH) and used direct force control (DFC) in their exoskeleton systems [3]. The proposed methods were used to build a muscle model to estimate limb motions and force. To establish a muscle skeleton model, parameters of the muscle, such as muscle length, activation, and rest lengths, must be characterized. However, these muscle parameters vary among individuals, and are typically difficult to obtain. Referring to a biomechanical database is one approach to acquire muscular information, and many studies have used it; however muscular information obtained from a database is approximated, and can vary among individuals. Direct measurements can be used to obtain more accurate individual muscular information, but can be complicated. Another common approach for controlling robots other than the Hill-based model is building a motion pattern recognition model using EMG signals [4,5], in which feature extraction and the machine-learning algorithm play major roles. Various feature extraction methods and machine-learning algorithms have been proposed to perform recognition tasks. The features of EMG signals, in general, include time-domain (TD) and frequency-domain (FD) features. In 1993, Hudgins et al. proposed five TD features: the mean absolute value (MAV), the mean absolute value slope, zero crossing (ZC), slope sign changes (SSC), and waveform length (WL) [4]. Unlike TD features, FD features contain the FD information of the EMG signals. FD features include the coefficient of the short-time Fourier transform (STFT), autoregression (AR), the median frequency (MDF), and the mean frequency of power spectrum (MNF). Oskoei et al. combined the TD and FD features into a feature vector. The feature combinations included TD features, FD features, and combinations of TD and FD features. A well-known pattern recognition method, the support vector machine (SVM), was then applied to perform upper-limb motion pattern recognition, and the performance of using various feature combinations was compared [5].Numerous approaches to feature extraction have been proposed, and various motion model recognition applications have been created. However, few studies have been conducted on the relationship between EMG signals and extracted features among various muscles in motion patterns. In most studies, EMG signals and features have been combined in motion pattern recognition models. In conventional feature combinations, features are extracted from multichannel muscles and combined into a feature vector. However, these conventional combinations fail to consider the relationships between muscles. We expected that accounting for these relationships would enhance recognition performance. In addition, building a motion pattern recognition model using EMG signals resulting from either dynamic or isometric contraction is typically confounded. The associated effects of using dynamic and isometric contraction EMG signals in the model building and recognition processes must be clearly determined. In anatomy and biomechanics, during dynamic contraction, the length of the muscle fiber changes when the joint angle is altered. Thus, considering the principle of EMG signal measurement, EMG patterns can vary depending on the type of contraction, because of the change in muscle fiber [6]. To apply EMG signals in control applications, Scheme and Englehart [7] proposed training strategies for proportional control. They investigated the influence of wrist and hand contraction strength, and then discussed proportional control in motion pattern recognition applications. Lorrain et al. [8] investigated recognition performance when using surface EMG as a training set for a multifunctional prosthetic control application, and discussed motion patterns of the wrist and hand. They observed that using EMG signals during dynamic contractions to build the recognition model provided greater prosthetic control accuracy. This study also investigated the differences between using EMG signals during dynamic and isometric contractions. However, considerable differences exist between these two studies and our study: our target joints focuses were the elbow and shoulder, and we also considered the incorporation of robotic arms.In the TD, the magnitude of EMG signals during dynamic contraction can differ from and be greater than those during isometric contraction [8]. Previous studies have indicated that the neural control strategies of isometric and dynamic contractions differ. For instance, during dynamic contractions, numerous motor units (MUs) showed lower recruitment thresholds [9,10], which implies that forces generated by muscles during various types of contraction must be considered differently. In motion recognition applications, normalization is a crucial step, and changes in EMG amplitude can influence the normalization result, affecting recognition performance. Conversely, the behavior of MUs during dynamic contraction also differs from their behavior during isometric contraction. Thus, the spectrum of EMG signals and the muscle activation pattern of these two types of contraction might be dissimilar [6,8,9]. In FD analysis, power spectrum density (PSD), median power frequency, and mean frequency of the power spectrum are usually applied as indices to characterize EMG signals [12,13]. These factors have been extensively discussed in many studies regarding either the TD or FD [6–13]. The target muscles studied and the experimental protocols used in these studies differed, possibly resulting in dissimilar explanations. EMG signals from two types of muscle contraction can affect motion pattern recognition performance differently. Therefore, when analyzing EMG signals, the different contraction types should be carefully examined because different neural control strategies might result in different EMG signals.In this study, the novel STFT-ranking feature was used to compare recognition results from training and validation motion patterns generated from various muscle contractions. The STFT feature has been used in many applications. However, combining STFT and a ranking method has been neither proposed nor employed. In multichannel EMG signal studies, conventional features are typically combined directly into a feature vector, which is unable to represent the relationships between the muscles. Unlike these conventional features, the novelty of STFT-ranking feature used in the proposed ranking method can represent the relationships between muscles in the FD. The experimental results revealed that the recognition performance of the STFT-ranking feature was superior to that of conventional features. With the same experimental protocol and same conditions, the performance of using conventional features and STFT-ranking feature is discussed. The remainder of this paper is organized as follows. In Section 2, the data acquisition method and robotic system are presented, and the STFT-ranking feature and the recognition method are introduced. In Section 3, the experimental results are presented; the performance of the STFT-ranking method and conventional features was compared by analyzing the experimental results. The performance of the recognition model using EMG signals during the two types of muscle contraction was also compared, and is discussed in this section. The conclusion of this study is presented in Section 4.Human limb motion is driven by various muscles. In this study, four motion patterns, of the shoulder and elbow joints in the sagittal plane, were examined: shoulder extension and flexion, and elbow extension and flexion. The biceps brachii and triceps brachii are responsible for elbow extension and flexion. The middle deltoid, upper trapezius, pectoralis major, and latissimus dorsi are employed for shoulder extension and flexion. Fig. 1illustrates the placement of the noninvasive surface EMG electrodes. The locations of the electrodes were determined using the SENIAM website and a textbook on muscle testing [14,15]. Pairs of surface EMG Ag/AgCl electrodes manufactured by Kendall Medi-Trace were placed on participants’ skin, which was precleaned using alcohol. The diameter of the electrodes was 1.5 in. Each electrode was then fixed in place with 3M Micropore tape. The measured EMG signals were amplified 1000 times, using a preamplifier circuit, and acquired using a data acquisition (DAQ) device (NI-PCIe-6320) with a 16-bit resolution and a 1000Hz sampling rate. The DAQ device was manufactured by National Instruments (NI). Because the front-end signals were amplified using the preamplifier circuit, the distance between the electrodes influenced the measured results. Therefore, the pairs of surface electrodes were placed as close to each other as possible, to fix this distance as the diameter of a single electrode.Muscle contractions, based on the change in muscle length, can be classified into three types: isometric, concentric, and eccentric. During isometric contraction, the length of the muscle remains nearly constant because the external torque equals the internal torque. During concentric contraction, the muscle shortens, and the internal torque produced by the muscle exceeds the external torque. During eccentric contraction, although the muscle is directed by the nervous system to shorten, the external torque exceeds the internal torque, causing the muscle to elongate, and the external torque typically results from an external load or an antagonist muscle [16]. In this study, concentric and eccentric contractions were considered dynamic contractions because they are related to motion.The exoskeleton robotic arm was designed to assist participants in generating the EMG signals of desired motion patterns. As shown in Fig. 2, the robotic arm system comprised two joints, the shoulder and elbow joints, as well as a handle and a pair of supporting mechanisms. The length of the upper arm and forearm were adjustable. When a participant used the robotic arm, the shoulder and elbow joints of the robotic arm aligned with the shoulder and elbow joints of the participant by adjustments to the length of the robotic upper arm and forearm. During the experiment, the robotic arm was controlled to either perform a series of designed motions, or maintain a fixed pose to facilitate the generation of the desired EMG signals from muscle contractions among the participants. The designed motions are specified in Section 2.2. In our study, the motion patterns of the flexion and extension of the elbow and shoulder joints were studied, and the motions performed by the robotic arm were designed in consideration of the flexion and extension of human elbows and shoulders in the sagittal plane.Fig. 3shows the complete data acquisition and analysis procedure. Initially, the exoskeleton robotic arm was controlled to perform the designed dynamic or static motions. The dynamic and static motion patterns, which consisted of elbow and shoulder flexion and extension, were designed based on human motion patterns in the sagittal plane. The trajectories of these motion patterns were recorded using a computer. At the start of the experiment, the computer was used to send a control command to the robotic arm to perform a designed motion pattern; the participant was requested to resist the robotic arm with the handle and pair of supporting mechanisms, then the EMG signals were recorded. By resisting the robotic arm, the participant generated the appropriate EMG signals. The measured EMG signals and muscle activities were considered an approximation of the real condition of a participant wearing and controlling a robotic arm. When resisting the robotic arm, EMG signals generated by the participant were marked as motion patterns opposite to the motion performed by the robotic arm. In our experiments, the participants were asked to resist the robotic arm as much as possible, and not to resist when taking a rest. Thus, there was no maximum or minimum limit in the degree of resistance. After obtaining EMG signal data, the STFT-ranking and conventional feature extraction methods were employed to build a motion pattern recognition model using the SVM method. The built SVM model was subsequently used to recognize the motion pattern in the acquired multichannel EMG signals. The recognition performance of various features and EMG signals exerted during dynamic or static motion patterns is compared and discussed in Section 3.The experiments were approved by the Research Ethics Committee at National Taiwan University. Seven male participants who had approved and signed an informed consent form were recruited; the participants were on average 25.7±2.2 years of age, and had an average height of 167.5±2.9cm. The four motion patterns were shoulder extension and flexion, and elbow extension and flexion [15,16]. The four motion patterns studied were more complicated than motion patterns in other anatomical planes, because, in the sagittal plane, muscle co-contraction occurs frequently. The motion patterns were therefore difficult to recognize by using EMG signals. The motions the exoskeleton robotic arm performs comprise dynamic and static motions, and were designed and referred from human's motion patterns. For dynamic motions, EMG signals were obtained by instructing each volunteer to resist the robotic arm as it performed motions at a constant angular velocity (1.5rpm, 0.16rad/s). For isometric motions, EMG signals were obtained by instructing each volunteer to resist the robotic arm in a fixed pose. The exoskeleton robotic arm had a handle and support rings, as illustrated in Fig. 2, designed to hold the participant's arm, and facilitate their resistance. The volunteers were asked to resist the robotic arm by pushing against the support rings and holding the handle.To measure the participants’ EMG signals during dynamic motion, the shoulder and elbow of the robotic arm were controlled to rotate forward and backward with respect to the participant's body in the sagittal plane. In its original position, as the anatomical position of human arms, the forearm and upper arm of the robotic arm were both vertical to the ground, and the shoulder and elbow angles of the robotic arm were treated as in a 0° position. Before the first series of motions for the robotic arm's shoulder joint was initiated, EMG signals were measured during 10s of rest. At rest, the robotic arm was maintained in its original position, and the volunteer was relaxed. Hence, the measured EMG signals were assumed to indicate that no muscle activation had occurred, and used to eliminate the offset of the EMG signals in signal preprocessing. After 10s of rest, the shoulder joint of the robotic arm rotated forward from 0° to 10°. The participant was instructed not to resist the robotic arm but to comply with its motion; this movement was designed to prepare the participant for the subsequent movement of the robotic arm. After this, the shoulder joint of the robotic arm rotated from 10° to 90°, and the participant was asked to resist the robotic arm in the opposing direction. The measured EMG signals were marked as shoulder extensions. The robotic arm then assisted the participant to perform shoulder flexion. In the second series of robotic arm's motions, participants’ EMG signals of elbow extension, and elbow flexion were measured using the same procedure.To measure the participants during static motion, the robotic shoulder joint was driven from 0° to 90°, and fixed at 90°, while the robotic elbow was maintained at 0°, and participants were instructed to resist the robotic arm by performing shoulder extension/flexion while holding their elbows steady. Subsequently, the robotic elbow joint was driven from 0° to 90°, and maintained at 90°, whereas the robotic shoulder joint was fixed at 0°, and the participants were instructed to resist the robotic arm's elbow rotation while holding their shoulders steady. The measured EMG signals were considered measurements of isometric contractions. On average, among the participants, each contraction during the dynamic and static motion of the robotic arm lasted approximately 6.3s. Participants were required to rest briefly between trials.Signal preprocessing, which includes eliminating the signal offset, signal segmentation, and onset detection, is required in EMG analysis. In this study, the signal offset was estimated using the mean of the baseline signal. The offset was then subtracted from the signal in each channel. The offset-removed signal was segmented, and each segment contained 256 samples. Segments were determined to contain signals reflecting muscle activation before features were extracted and motion patterns were recognized. The magnitude and frequency of segments with muscle activation differed from those of segments without muscle activation [18]. To define whether segments contained muscle activation signals, the Teager-Kaiser energy operator (TKEO) was employed in for onset detection [17]. The TKEO has been frequently used to enhance the magnitude and frequency of TD signals without requiring the conversion of those signals to the FD. The TKEO has also been proven to work effectively in EMG onset detection [18]. The TKEO is denoted in (1):(1)Ψ[x(n)]=x2(n)−x(n+1)x(n−1)where x(n) is the EMG signal. To determine the onset of muscle activation, the mean and standard deviation of the TKEO were estimated. Three times the standard deviation was used as a threshold to determine whether the segment contained signals of muscle contraction [21]. Three times the standard deviation covers 99.7% of the distribution of a baseline signal; if the value of a segment exceeded three times the standard deviation of the baseline signal, the current signal was determined to include muscle activation that did not belong to the baseline signal.The TD and FD features were used to analyze EMG signals. Five commonly used TD features were: MAV, ZC, SSC, WL and RMS. MAV, WL, and RMS were related to the signal magnitude, whereas ZC and SSC possibly contained frequency information, such as the muscle firing rate, without requiring conversion of the signal to the FD. ZC is the number of times a segment's signal crossed the zero line; a high ZC implied that a segment's signal contained high frequency elements, and a low ZC implied that the signal contained low frequency elements. Similar to ZC, SSC was used to count the number of slope sign changes in a segment's signal. Four FD features were employed: the STFT coefficient, AR, MDF, and MNF. The STFT coefficientSTFTxinshown in (2), represents the frequency elements of the EMG signal:(2)STFT{xi(n)}=∫−∞∞xi(n)⋅ω(n−τ)⋅e−jnωdnwhere xi(n) represents the EMG signal in the ith channel, and ω(n−τ) is the Hann window function. The AR feature has been used to study muscular fatigue [19], diagnostic classification [20], and motion pattern recognition. In this study, a six-order AR model was employed to approximate the spectrum of the EMG signal. However, MDF and MNF are commonly employed to represent the properties of an EMG signal in the FD. Numerous approaches have attempted to select and combine TD and FD features into a feature vector to achieve motion pattern recognition. To compare the performance of various feature combinations, four types of feature vectors, including conventional features, were used; these are listed in Table 1.In commonly used feature combination methods, conventional features are combined directly and consecutively in a feature vector. The STFT-ranking feature proposed in this study to analyze multichannel EMG signals uses a different approach: the ranking method [19]. In the FD, most EMG frequency information, including power spectrum information, is located at 250Hz. Hence, the applied frequency range in our study was 1–250Hz [21]. To determine the STFT feature, the magnitude of each frequency element in the six muscles was ranked from 1 to 6 [22]. In (3), the parameters STFTi(f) and πi(f) denote the STFT coefficient and the ranking of the fth frequency element in the ith channel EMG signal:(3)STFT1(f),…,STFT6(f)→{π1(f),…,π6(f)}.In addition, the parameter β was used to adjust the number of details presented by the ranking feature. In (4), the frequency elements are separated into several bins. Parameter β represents the number of frequency elements contained in a bin. If β is 10, all frequency elements from 1 to 250Hz are separated into 25 bins. Each bin contains 10 frequency elements. Bini(b) represents the mean of the magnitude of the 10 frequency elements in the bth bin of the ith muscle. In our analysis, parameter β was set as 1, 2, 5, and 10.(4)Bini(b)=1β∑k=1βSTFTi(β⋅b+k),b=0,1,…,250β−1Bini(b) for the EMG signal in the six channels is then ranked; the ranking result is denoted by Eq. (5). Parameter πi(b) is the result of ranking the bth bin:(5){Bin1(b),…,Bin6(b)}→{π1(b),...,π6(b)}The peak and valley values of conventional features must be estimated for normalization. The normalization process must also be performed for the STFT-ranking feature. However, unlike conventional features, the peak and valley values in the STFT-ranking feature are given as 6 and 1, allowing the normalization process to be simplified. Furthermore, the STFT-ranking feature can reveal the relationships between the six muscles through ranking (i.e., contrasting conventional feature combinations, which directly combine the features into a feature vector).After feature extraction was performed, principle component analysis (PCA) was employed for data reduction [23]. PCA is a powerful technique based on the orthogonal linear transformation method. The function of PCA is to reduce the dimensions of a large set of data by projecting them onto a new space. In the new space, the dimensions of the data are uncorrelated, and the variances of the projected multivariate data are maximized. For a given feature vector with dimensions (1×c), the feature matrix, including r feature vectors, is denoted asYwith dimensions r×c. After subtracting the mean from the features, the covariance ofYcan be represented by the covariance matrix Sy, which is also called the scatter matrix. The eigenvectors of the scatter matrix are the principal components (PCs), which are orthogonal; the eigenvalues correspond to the weight of the PCs and represent the importance of the PCs. In this study, the first three eigenvectors (PCs) with the highest eigenvalues were selected, and the remaining eigenvectors were ignored. The feature vectors were then projected onto a three-dimensional space.The SVM method was used to further classify the data for motion pattern recognition [5]. The SVM maps data onto a high-dimensional space by using a kernel function. The mapped data are then expected to be easily classifiable by a hyperplane in the high-dimensional space. The hyperplane that maximizes the margin between the boundaries formed by the data of each class is considered the most satisfactory hyperplane. Several kernel functions, such as the linear function, radial basis function (RBF), the polynomial function, and the sigmoid function are frequently used in the SVM approach. In this study, the RBF was applied to build recognition models. The RBF, also called the Gaussian function, is described in (6). In the training phase, the training dataset was separated into five folders and cross-validated to build the motion pattern recognition model. The LIBSVM was used to execute the SVM algorithm [24].(6)K(xˆu,xˆv)=exp−xˆu−xˆv22σ2The distribution of various features, when estimated and mapped onto PCA space, differed. This difference revealed the extent of separation between the features when applied to represent the four motion patterns in PCA space. Therefore, to analyze the distribution of the projected feature points in PCA space, the within-cluster scatter Sw, the between-cluster scatter Sb, and the ratio, Rs, of Swto Sb, were determined [25]. The ratio, Rswas an index indicating the separability of the feature data in the feature space. The formulae of Sw, Sband Rsare denoted in (7), (8) and (9). These formulae were used to estimated(p,pˆ)which is the distance between p andpˆ, and are normalized by considering the number of estimated points. In the within-cluster scatter, p andpˆare the different points in the same class. In the between-cluster scatter, points p andpˆcome from different classes. The variable Ucrepresents the amount of points in cth class, and UTsignified the total amount of points:(7)Sw=12⋅∑c=141Uc2∑p∈ScUc∑p≠pˆ,pˆ∈ScUcd(p,pˆ)(8)Sb=12⋅∑c=141Uc(UT−Uc)∑p∈ScUc∑pˆ∉ScUT−Ucd(p,pˆ),UT=∑c=14Uc(9)Rs=SwSbSmall value of Rsmeans the feature data in the PCA space are more separable. A more separable distribution of feature data enabled building a more efficient recognition model with satisfactory performance (Fig. 4).

@&#CONCLUSIONS@&#
Multichannel EMG signals from the shoulder and elbow were used for motion pattern recognition in this study. The use of four conventional features (TD1, FD1, TFD1, and TFD2) and the STFT-ranking feature were compared in detail. The recognition accuracy of the STFT-ranking feature, which exceeds 90%, is superior to that of the other features when muscle contractions during the training and validation phases are of the same type. Even when the muscle contractions are not of the same type during training and validation phases, the STFT-ranking feature still offers reasonably satisfactory performance. In our experiments, an exoskeleton robotic arm was used to aid participants in generating EMG signals during dynamic or isometric contractions. The EMG signals of these muscle contractions can vary, and this variation can affect recognition performance. Moreover, variation in EMG signals was present in individual participants. However, by using the STFT-ranking feature, our experimental results shows that the STFT-ranking feature is less affected by variation in EMG signals. Our experimental results revealed that it is preferable that EMG signals from the same type of muscle contraction, whether dynamic or isometric, are consistently used in both the training and validation phases. Changes in joint angles must be considered when the robotic arm moves; using EMG signals generated during dynamic contraction is reasonable and the procedure to build a recognition model based on PCA and SVM is feasible. The STFT-ranking feature has the potential to be employed in various applications of exoskeleton robot control and rehabilitation in the future.