@&#MAIN-TITLE@&#
Three-dimensional semiautomatic liver segmentation method for non-contrast computed tomography based on a correlation map of locoregional histogram and probabilistic atlas

@&#HIGHLIGHTS@&#
Liver segmentation for non-contrast CT would aid in diagnosis of disease/lesions.We evaluate the method against a hand-drawn standard in ten cases.We confirmed that our method was precise.Our method potentially offers radiologists a time-efficient segmentation aid.

@&#KEYPHRASES@&#
Liver/AH,Computed tomography,Probabilistic models,Region-growing methodology,Liver segmentation,

@&#ABSTRACT@&#
BackgroundWe sought to evaluate a new regional segmentation method for use with three-dimensional (3D) non-contrast abdominal CT images and to report the preliminary results.MethodsThe proposed method was evaluated in ten cases. Manually segmented areas were used as the gold standard for evaluation. To compare the standard and the extracted liver regions, the degree of coincidence R% was redefined by transforming a volumetric overlap error. We also evaluated the influence of varying the density window size in terms of setting the starting points.ResultsWe confirmed in ten cases that our method could segment the liver region more precisely than the conventional method. A size of window 15 voxels was optimal as the starting point in all cases.ConclusionsWe demonstrated the accuracy of a 3D semiautomatic liver segmentation method for non-contrast CT. This method promises to offer radiologists a time-efficient segmentation aid.

@&#INTRODUCTION@&#
Medical imaging modalities such as computed tomography (CT), positron emission tomography (PET), single photon emission computed tomography (SPECT), and magnetic resonance imaging (MRI) are often used to image the human body in three dimensions (3D) and to detect malignant tumors at an early stage. However, the large number of images generated during a single examination may complicate interpretation. Various computer-aided diagnostic (CAD) systems have been developed and applied to clinical cases to reduce such issues [1–8]. Because of its complex surgical anatomy, localization of liver lesions to the involved segment or segments is important. With an increasing number of liver cancer patients [9,10], segmentation methodology is receiving critical attention [11–13].Several studies have reported that multiple phase imaging is useful for improving automatic segmentation accuracy [11]. A level-set method that recognizes tumors by using rough segmentation results [12,13] and a graph cuts-based [14] method for interactive regional segmentation that selects an object and background as a seed [15] have also been proposed.The appearance of non-contrast CT images is markedly different from those of contrast CT images in terms of boundaries with other organs. Liver segmentation on non-contrast CT images has been achieved by using a conditional statistical shape model. However, this method still encounters difficulties when the morphology of the liver is abnormal [16].We have evaluated a new segmentation method for use with non-contrast abdominal CT images. This new method promises to reduce the computational cost for detection of diseases such as hepatocellular carcinoma in the CAD systems because it can exclude other organs from the targeted liver region.Considerable closeness to adjacent organs can be seen with a non-contrast segmentation method. A probabilistic abdominal atlas that provides human anatomical information has been developed [17,18]. These segmentation methods for multiple organs are clearly beneficial [17]; however, the problem of low accuracy for segmentation regarding the boundaries remains. The results of manually set landmarks were different from those obtained when the landmarks for registration were set automatically [17].We focused on the advantages of the region-growing method and the probabilistic atlas that make it possible to segment liver regions even if the liver shape and size are abnormal, owing to disease or surgery. We herein propose a new 3D regional segmentation method for use with non-contrast abdominal CT images. We also evaluated its capability in ten cases and report the preliminary results.Fig. 1 is a flow chart of the proposed method. A median filter (3×3×3) is applied to CT images to reduce noise. A conventional region-growing method is employed to extract a rough picture of the liver [19]. With this method, it is possible to select false starting points, such as blood vessels inside the liver region, even in normal liver. To solve this problem, precise region segmentation was accomplished by devising a method to select correct starting points using the following procedures.Step 1: A user manually determines the position of window w×w×w in a liver region and a histogram of CT values in this region is created automatically. In a clinical situation, the radiologist would empirically place this region of interest (ROI) to exclude blood vessels. As a starting point, the voxel in the ROI whose intensity has the maximum frequency in the histogram is selected automatically.Step 2: If the CT value of each of the six voxels adjacent to the first voxel satisfies conditions 1 and 2, below, those voxels are set as new starting points.Condition1:|V−VS|<αCondition2:|V−VNi|<β,(i=1…6),where V is the CT value of the voxel in question, Vsis the CT value that was determined to be the starting point in step 1, VNiis the CT value of the six adjacent voxels, and α and β are thresholds.Step 3: The starting points after step 2 are set as one of the candidate liver regions and are removed as previous starting points.Step 4: Steps 2 and 3 are repeated until all starting points are removed. The region-growing method is stopped at this time.A correlation map is constructed by calculating the correlation coefficients of the locoregional histogram between the window that the starting point was located at the center of gravity and the other window, once for each voxel in step 1. Here, the window is slightly different compared with the initial window in terms of the starting point located at the center of gravity. The initial window is manually generated by radiologists and other windows are automatically generated.A histogram H1(j) (j=min to max) is constructed to determine the window size w×w×w based on the starting point and m1. Here, j is the CT value, H1(j) represents the number of voxels for its CT value, and m1 represents the average number of voxels with each CT value within the window. The maximum and minimum CT values for all CT images are represented as max and min, respectively.Next, a histogram H2(j) is constructed based on each voxel, as is the case in H1(j). The average number of voxels for each CT value within the window is m2. Correlation coefficients C(i)(i=1−voxel size) are calculated by Eq. (1), where voxel size is the number of voxels for all CT images.(1)C(i)=∑j=minmax(H1(j)−m1)(H2(j)−m2)∑j=minmax(H1(j)−m1)2∑j=minmax(H2(j)−m2)2Only positive correlation coefficients 0–1 are used. Minus values are replaced with 0 since the negative correlations indicate an inverted region of the window. An obtained correlation coefficient is set as the value of each voxel, and the results were applied to the liver candidate region C(i).A probabilistic atlas was constructed by other cases compare with the correlation map. Liver regions were manually segmented from all cases and three-dimensional rigid transformation was performed by open source software (Insight Segmentation and Registration Toolkit; Kitware Inc., Clifton Park, NY, USA). CT values in the liver region for each transformed volume were replaced to 1 (white) as a maximum value of the probability that is liver region. Other regions were set as 0 (black). All volumes were overlaid. Then, average values (0–1) once every voxels were calculated. In this study, we used this volume as the probabilistic atlas.Thin-plate spline (TPS) [20] was used to perform registration between the targeted CT images and the probabilistic atlas, in terms of size and shape. The required landmarks for registration were selected by an operator: the hepatic portal, lateral tip of the left hepatic lobe, inferior margin of the right hepatic lobe, because of their anatomical specifications using volume-rendering software (VolView; Kitware). Although there was 3D visualization in the volume-rendering software, 30 positions in the 3D coordinate system were manually recorded by a mouse-pointing operation. To avoid the risk of selecting another region, the probabilistic atlas was visualized for only regions of probability=1. Additionally, the correlation coefficient in Section 2.4 had the possibility of false recognition that adjacent liver tissue was not a liver region because of low correlation coefficients around the liver boundary. Thus, landmarks were located on the surface of the probabilistic atlas (probability=1) and matched to the liver surface on CT images.Fig. 2 shows examples of the locations of the adopted landmarks, where each landmark is represented by a red point. Fig. 2 shows the probabilistic atlas of the input data sets. The probabilistic atlas has a distribution within 0–1: the whiter the region, the higher the probability of it being a liver region. In all cases, regions of probability=1 correspond to liver regions that were used to generate the probabilistic atlas.Liver region segmentation was performed by using the probabilistic atlas after registration mentioned in Section 2.4. The maximum posterior probability between the targeted data and the probabilistic atlas was used to extract liver region. Posterior probability was calculated by Bayes׳ theorem following Eq. (2), and one organ label with the maximum posterior probability for each pixel was allocated as liver region [18].(2)p(n|v)=p(v|n)P{n}p(v)(3)p(v)=∑n=1Np(v|n)P{n},where n is the organ label, v is the CT value, p(v/n) is the probability density function of the CT value v related to organ n, P{n} is the prior probability (the value of the probabilistic atlas), and N is the number of organs labeled. In this study, the organs labeled in the liver region and the background were selected as 1 and 2, respectively.After maximizing the posterior probability, the liver candidate region was segmented using the probabilistic atlas and the correlation map. To create the condition whereby both the probabilistic atlas and the correlation map C(i) of the targeted voxel had high values, the liver candidate region L(i) that was over threshold t was extracted following Eq. (4):(4)L(i)={TRUEifA(i)×C(i)>t(i=1,2,3,…,voxelsize)FALSEelse,where threshold t was determined by the relation and the average μ and standard deviation σ of A(i)×C(i). Voxel size indicates the number of all voxels for A(i) or C(i). Threshold t was determined automatically by selecting a data range of μ±3σ, obtaining the left term of Eq. (4). Additionally, 99.73% of the data in the histogram were selected as the liver candidate region.The liver candidate region has blood vessels and noise depending on the CT parameters such as tube current, voltage, and slice thickness. Therefore, morphological processing was performed. After a dilation process (described below), an erosion process was applied the same number of times as the dilation process for a specific region of high value in the probabilistic atlas and in the liver candidate region for filling a region of blood vessels. Six neighbor voxels of the targeted voxel were replaced from 0 (black) to 1 (white) when a white voxel in six neighbor voxels existed in at least one. This process was called the dilation. The opposite process was called the erosion.

@&#CONCLUSIONS@&#
By generating a correlation map from correlation coefficients between an area adjacent to the starting point and another area, we successfully demonstrated 3D liver segmentation. After comparing the results of the conventional method, we found that our method offered better results. We effectively confirmed the advantages of our method by applying it to ten cases. Within the limitations of semi-automatic liver segmentation, our proposed method has a great potential to offer radiologists more time efficiency.