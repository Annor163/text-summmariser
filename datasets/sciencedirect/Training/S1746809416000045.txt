@&#MAIN-TITLE@&#
Sliding window averaging for the extraction of representative waveforms from motor unit action potential trains

@&#HIGHLIGHTS@&#
A new averaging algorithm for the extraction of representative waveforms from MUAP trains is presented.The algorithm is based on selection and averaging segments of potentials within the local scope of a sliding window.On normal muscles, it performs better than other relevant algorithms, regarding signal processing and quantitative MUAP waveform figures of merit.The algorithm requires a smaller number of potentials in the MUAP train, to estimate quantitative MUAP waveform parameters.

@&#KEYPHRASES@&#
EMG,Averaging,MUAP,Waveform,Sliding window,

@&#ABSTRACT@&#
In quantitative electromyography (EMG), the set of potentials that constitute a motor unit action potential (MUAP) train are represented by a single waveform from which various parameters are determined in order to characterize the MUAP for diagnostic analysis. Several methods that extract such a waveform are currently available, and they are, in essence, based on two operations: averaging and selection, which are performed either sample-by-sample or on the whole-potential. We present a new approach that carries out selection and averaging on a local interval basis.We tested our algorithm with a dataset of MUAP records extracted from the tibialis anterioris muscle of healthy subjects and compared it with some of the most relevant state-of-the-art methods considered in a previous work (Malanda et al., J. Electromyogr. Kinesiol., 2015). The comparison covered general purpose signal processing figures of merit and clinically used MUAP waveform parameters. Significantly better results in both sets of figures of merit were obtained with the new approach. In addition, relative to the other algorithms tested, the new approach required fewer potentials from the MUAP set to obtain an accurate representative waveform.

@&#INTRODUCTION@&#
Analysis of the motor unit action potential (MUAP) plays a central role in clinical electromyography (EMG). For quantitative MUAP analysis, intramuscular EMG signals are recorded by means of needle electrodes inserted into the muscle belly. Several trains of MUAPs are usually present in these signals, and manual, semiautomatic or fully automatic procedures [1,2] are used for separating out these trains [20]. A representative waveform is then constructed from each of these trains in order to quantitatively characterize its main features with parameters that convey clinically useful information [1,3–5]. To this end, the potentials in the set are time-aligned and averaged. Alignment is usually carried out by superposing the different potentials in the set, so that their maximum negative peaks or their triggering points coincide in time. Alternatively, they may be aligned on the basis of maximum correlation [6].A number of averaging methods have been proposed to extract representative waveforms from repetitive biomedical potentials in the realm of EMG (i.e, MUAP analysis) [7–10], evoked potentials [11–14,19]; and electrocardiography [15]. A descriptive review of these averaging methods, including a comparative evaluation of nine of them with a bank of intramuscular EMG signals has been recently presented [20]. In that review the authors introduced four features to characterize and classify the averaging methods: selection, weighting, observation scope and operation scope. Selection refers to the way that the algorithm chooses which potentials in the MUAP set to use in calculating the average. Weighting refers to the weights that are given to selected potentials. Scope refers to the locality of the search around a given inspected sample. Observation scope refers to the set of samples around the inspected one from which the information needed for the selection-weighting process is extracted. Operation scope is the time interval around the inspected sample over which the selection-weighting criteria operate: the time interval for which the selected potentials and the weighting coefficients remain unchanged. From the results of the analysis, operation scope turned out to be the most sensitive feature, and, in most of the evaluated cases, methods with one sample operation slope had better performance than those that operated on a ‘whole potential’ basis.As discussed in the above-mentioned article, available averaging methods make use of one of two scopes: either one-sample scope or whole-potential scope. These two alternatives represent the extreme cases of what is normally known as local processing, in which, for processing a certain time sample, information from a limited neighbourhood of the sample is considered.Here we present a new averaging method in which potentials are observed through a sliding window that traverses the time span of the whole potential and imposes an intermediate scope for the estimation process. The rationale behind this idea is that all the potentials in the MUAP set may contain useful information for composing the representative waveform; even if a certain potential is corrupted by one or more interfering potentials over some part of its time span, other parts may be unaffected and therefore valid for obtaining the representative waveform. Local processing provides a sensible strategy to materialize this idea, and a sliding window, a simple way to implement it (Fig. 1).If several potentials within a MUAP set have similar shapes within a certain time interval, the common shape is more likely to be of physiological origin than due to noise or contamination. Therefore those potentials that share a common shape over a specific time interval should be the ones used to construct the shape of the representative waveform over this interval. For this reason, our algorithm selects and averages the most similar potentials within the scope of a sliding window. Once the selection and averaging process on one time interval has been completed, the algorithm slides the window along one time sample, delimiting the next interval to be analysed, from which a new set of potentials is selected and averaged. In view of these concepts, we refer to this approach as Sliding-window selective averaging (SWSA). In terms of the framework previously described, both the observation scope and the operational scope applied by SWSA are local, and the averaging process is based on selection of signal sections with similar shapes from several potentials in the set and uses uniform weighting of the selected potentials.The aim of this paper is to present the SWSA approach and compare its performance with the most relevant of the methods examined and evaluated in the above-mentioned descriptive review of averaging methods [20].In the following section we describe the materials used in the study. Next, we give an account of SWSA as well as the methods we used to compare its performance. Then we explain the figures of merit and the gold standard used in comparisons before reporting the results of the comparative evaluation, discussing those results and offering our final conclusions.The material used in this study was the same as that used in the work previously mentioned [20], with the expressed approval of the UPNA Ethical Committee. Particularly, 35 raw EMG signals were recorded from the tibialis anterioris muscle of seven healthy and physically active volunteer subjects who had given their informed consent before the experiments. These signals were 10s-long and were taken while the subjects were exerting a slight to moderate muscle contraction, in the range of the current performance of signal recording with multi-MUP systems, i.e. 5–30% maximum voluntary contraction [9].A Synergy electromyograph (Oxford Co.) and concentric needle electrodes (type DCN37; diameter 0.46mm, recording area 0.07mm3; Medtronic) were used for the acquisition. The EMG signals were band-pass filtered (filter setting was 3Hz to 10kHz), sampled (sampling rate was 20kHz) and digitized (16-bits per sample). The digitized signals were stored on the hard disk of a PC and analyzed off-line. From these 35 EMG recordings, 175 MUAP trains were extracted using a recognized decomposition algorithm [16]; however, four MUAP train sets were lost as a result of file corruption. Each MUAP train consists of a set of potentials that have a fixed length L, sufficiently large that the waveform characteristics of the potential are fully contained within this length. In our case, L=1000 samples (50ms).We discarded MUAP trains that were evaluated as unacceptable by an expert electromyographer for having an excessively noisy visual appearance or because the yielded average waveform presented unrealistic MUAP shapes. We also discarded waveforms with a peak-to-peak amplitude lower that 0.1mV. For SWSA sensitivity tests we included all MUAP trains with at least 40 potentials (Section 3.5). The number of MUAP trains that met the requirements for the sensitivity tests was 119. Because in our tests we wanted to measure the behaviour of the methods for different numbers of potentials in the train, we only included in the comparative tests those MUAP trains that had at least 80 potentials (Section 3.6). The number of MUAP trains that met the requirements for the comparative tests was 78.

@&#CONCLUSIONS@&#
1-A new averaging algorithm for the extraction of representative waveforms from MUAP sets has been presented. The Sliding-window selective averaging is based on selection and averaging segments of potentials within the local scope of a sliding window.In terms of several signal processing figures of merit and of various commonly-used quantitative MUAP waveform parameters, the new algorithm performed markedly better than three other relevant averaging algorithms at processing trains of real MUAP recordings.With regard to MUAP waveform parameters, the new algorithm converged faster than the other three methods tested, that is, it generally required a smaller number of MUAP potentials to attain maximal accuracy.The best performance of the algorithm was found for a length of the sliding window in the range of 5 to 12.5ms and for the internal parameter η in the range from 0.25 to 1.0.Further studies are necessary to evaluate how the Sliding-window selective averaging algorithm performs with EMG signals from muscles with neuromuscular pathological dysfunctions.