@&#MAIN-TITLE@&#
Drape simulation using solid-shell elements and adaptive mesh subdivision

@&#HIGHLIGHTS@&#
Solid-shell elements attending shear, trapezoidal and thickness locking are employed.To avoid interpenetration, a curvature-based reversible adaptive meshing is devised.Kirchhoff condition is employed to reduce dynamic oscillation of new-inserted nodes.The predicted drape shapes appear to be realistic with interpenetration avoided.

@&#KEYPHRASES@&#
Drape,Solid-shell,Adaptive meshing,Discrete Kirchhoff,Transition element,

@&#ABSTRACT@&#
In this paper, 4-node quadrilateral and 3-node triangular solid-shell elements are applied to drape simulations. With locking issues alleviated by the assumed natural strain method and plane-stress enforcement, static and dynamic drape problems are attempted by the quadrilateral element. If the drape is deep and the mesh density is inadequate, non-realistic sharp folds are predicted due to the non-physical interpenetration of top and bottom element surfaces. To avoid the interpenetration, a reversible adaptive subdivision based on the 1–4 splitting method is developed. To ensure displacement compatibility among elements at different subdivision levels, macro-transition elements are formed by quadrilateral and triangular solid-shell elements. To reduce the dynamic oscillation induced by newly inserted nodes, the discrete Kirchhoff condition is employed to determine the related nodal variables. Dynamic drape examples using adaptive meshing are presented. It can be seen that the predictions look realistic and deep drapes can be predicted with the interpenetration avoided yet the required number of nodes can be kept relatively small.

@&#INTRODUCTION@&#
In recent decades, a desire has been arisen in the apparel industry on how to automate the design and manufacture of clothing as well as to reduce the time and effort in the design process [1]. Meanwhile, in electronic commerce, people would enjoy seeing how a garment drapes on a virtual human body based on the figures of the potential customer through the internet before making an order. In this light, fabric drape simulation has drawn considerable attention [2–16].The computational methods used in drape simulation can be broadly classified into the geometrically-based and the physically-based. Early works mainly belong to the former which employs geometric equations and constraints to model folds and creases of deformed fabrics without considering their physical properties [2,3]. The physically-based method, also called the mechanics approach, takes the principle of mechanics and the material properties of fabric into account. Typical examples of physically-based method are particle-based method [4–9] and the finite element method (FEM) [10–15]. In the former, the fabric is assumed as discrete particles or masses which are located at the grid-points while the deformation energies are quantified by virtue of springs connected to grid-points or grid-lines. The particle-based models are sometimes known as mass-spring models. Their major shortcomings are the stringent requirement on particle/mass distributions as well as the laborious treatments for oblique and curved boundaries.FEM as a well-received numerical method for mechanics problems had been naturally applied to fabric drape simulation. The most direct application is the shell finite element method, e.g., thin-shell elements [12] and degenerated-shell elements [10,11]. In recent years, many solid-shell elements have been devised [17–25]. These elements are typically defined by two layers of nodes positioned at the top and bottom surfaces of the plates/shells and equipped with three translational dofs per node (seeFig. 1(a)). Alternatively, they can be defined by the mid-surface nodes equipped with three mid-surface nodal translational dofs and three nodal relative translational dofs between the two ends of the nodal directors (see Fig. 1(b)). For convenience, the latter configuration is adopted hereafter. Similar to the degenerated shell elements, the well-known shear and membrane lockings also plague the solid-shell elements. Remedies such as assumed natural strain (ANS) method [18–22,24,25] and the hybrid formulation [17,22,23] have been resorted to. Trapezoidal locking occurs when lower order solid-shell elements are applied to model curved shell structures. It is so-named because the element cross-section is a trapezoid. The ANS method is commonly used to alleviate this locking deficiency by sampling the normal strain along the nodal director [19–22,24]. Solid-shell elements also suffer from the thickness locking which is caused by Poisson׳s ratio coupling of thickness normal stress and in-plane strains in the constitutive matrix. When the element is subjected to pure bending, a plane-strain state is predicted instead of the physical plane-stress condition. This locking deficiency is automatically resolved when the zero Poisson׳s ratio is assumed. Other successful remedies include the hybrid-stress method [20,22], the modified generalized laminate stiffness matrix [21–23], the enhanced assumed strain method [18,23,25] and the plane-stress enforcement [17,19,24].Solid-shell elements have gained considerable success in structural analysis. Comparisons between the degenerated and solid-shell elements indicated that the latter can undertake large load increments and converge by consuming less iterations [17]. Solid-shell element was also applied to fabric drape simulation in [13] where the 4-node quadrilateral solid-shell element was employed in static drape analysis and the predictions appeared to be promising. In this paper, both the 4-node quadrilateral and 3-node triangular solid-shell elements are employed. In both element formulations, the ANS methods are employed to avoid the transverse shear and trapezoidal lockings while the plane-stress enforcement is used to resolve thickness locking. The 4-node element is firstly applied to drape simulations. Natural and pleasant predictions are obtained for most problems. However, when the drape is deep, unrealistic sharp folds are predicted due to the non-physical interpenetration of top and bottom element surfaces. This phenomenon was also reported in [13] (seeFig. 2(a)). Schematic diagrams of typical elements undergoing interpenetration are depicted in Fig. 2(b) where the upper and lower element surfaces interpenetrate each other whilst the mid-surface remains un-deformed but some nodal directors are reversed. However, the remedy suggested in [13] does not always work. To circumvent the interpenetration, a reversible local adaptive subdivision based on the 1–4 splitting method is developed. To ensure displacement compatibility between elements at different subdivision levels, macro-transition elements are formed by the quadrilateral and triangular solid-shell elements. To attenuate the dynamic oscillation induced in each subdivision procedure, the discrete Kirchhoff condition [26–28] is employed to determine the kinematic variables of new-inserted mid-edge node. Lastly, drape examples attempted by using the adaptive mesh subdivision are presented. The predictions look realistic and deep drapes can be predicted with interpenetration avoided by using less nodes.In this section, the geometric nonlinear formulations of the 3-node and 4-node solid-shell elements using the total Lagrangian description are presented.For the 4-node quadrilateral solid-shell element portrayed in Fig. 1(b), the initial coordinate vector X and displacement vector U with respect to X can be interpolated as(1)X(ξ,η,z)=Xo(ξ,η)+zXn(ξ,η)=∑i=14Ni(ξ,η)Xoi+z∑i=14Ni(ξ,η)Xni,U(ξ,η,z)=Uo(ξ,η)+zUn(ξ,η)=∑i=14Ni(ξ,η)Uoi+z∑i=14Ni(ξ,η)Uni=(No+zNn)dwhere N1=(1−ξ)(1−η)/4, N2=(1+ξ)(1−η)/4, N3=(1+ξ)(1+η)/4 and N4=(1−ξ)(1+η)/4; ξ, η∈[−1,+1] are the natural coordinates of mid-surface; z∈[−h/2,+h/2] is the coordinate along the director and h is the thickness; Xoand Xndenote the initial mid-surface geometry and its normalized director defined asXo=X|z=0andXn=(X|z=+h/2−X|z=−h/2)/h, respectively; Xoiand Xniare the corresponding nodal values of ith node;Uo=U|z=0,Un=(U|z=+h/2−U|z=−h/2)/h;d={Uo1T,Un1T,Uo2T,Un2T,Uo3T,Un3T,Uo4T,Un4T}Tis the element nodal displacement vector; Noand Nnare self-defined.The natural Green strain components with respect to ξ, η and z can be derived as(2)εij=(X,iTU,j+X,jTU,i)/2+(U,iTU,j+U,jTU,i)/4where i, j=ξ, η and z. Since the second order z-terms in in-plane strains (εξξ, εηηand γξη) and the first order z-terms in transverse shear strains (γzξand γzη) are often, if not always, truncated in shell formulation, the individual strain components can be written as(3)εξξ=X,ξTU,ξ+U,ξTU,ξ/2≃εξξm+zεξξb,εηη=X,ηTU,η+U,ηTU,η/2≃εηηm+zεηηb,γξη=(X,ξTU,η+X,ηTU,ξ)+(U,ξTU,η+U,ηTU,ξ)/2≃γξηm+zγξηb,εzz=X,zTU,z+U,zTU,z/2=XnTUn+UnTUn/2,γzξ≃(XnTUo,ξ+Xo,ξTUn)+(UnTUo,ξ+Uo,ξTUn)/2,γzη≃(XnTUo,η+Xo,ηTUn)+(UnTUo,η+Uo,ηTUn)/2in which the symbol ‘≃’ indicates the aforementioned truncations, ‘m’ and ‘b’ stand for membrane and bending, respectively.To avoid transverse shear and trapezoidal lockings by ANS, the natural transverse shear strains and the thickness normal strain are modified to be(4)γ¯zξ=12(1−η)⋅γzξ|ξ=0,η=−1+12(1+η)⋅γzξ|ξ=0,η=+1,γ¯zη=12(1−ξ)⋅γzη|ξ=−1,η=0+12(1+ξ)⋅γzη|ξ=+1,η=0(5)ε¯zz=N1⋅εzz|ξ=−1,η=−1+N2⋅εzz|ξ=+1,η=−1+N3⋅εzz|ξ=+1,η=+1+N4⋅εzz|ξ=−1,η=+1.The material properties are often defined under a local physical frame (x, y, z) with the x-y-plane parallel to the mid-surface of the shell and the z-axis orthogonal to the x-y-plane accordingly. Then, the Green strains under (x, y, z) can be obtained by the following transformationε=={εxxεyyγxy}=εm+z⋅εb=T={εξξεηηγξη}=T={εξξmεηηmγξηm}+z⋅T={εξξbεηηbγξηb},=[Bm+Dm(d)/2]⋅d+z⋅[Bb+Db(d)/2]⋅d,(6)γ˜={γ˜zxγ˜zy}=Tt{γ¯zξγ¯zη}=[BT+DT(d)/2]⋅d,ε˜zz=[B∥+D∥(d)/2]⋅dwhere T’s are the strain transformation matrices;B׳sandD׳sare the linear and nonlinear strain–displacement matrices, respectively. By (i) enforcing the plane stress condition, (ii) assuming the uncoupled nature of the bending, membrane and transverse shear energies and (iii) approximating the Jacobian determinant by its counterpart at the mid-surface, the element strain energy can be expressed as(7)Ue=12∫−1+1∫−1+1[(εmTCmεm+εbTCbεb+γ˜TCtγ˜+Ezε˜zz2]Jodξdηwhere Cm, Cband Ctare the membrane, bending and transverse shear rigidity matrices, respectively; and the approximate Jacobian determinant is given as(8)Jo=det[X,ξX,ηX,z]|z=0=det[Xo,ξXo,ηXn]Substitute Eq. (6) into Eq. (7), then the element internal force vector f and tangential stiffness matrix ktrequired for the solution procedures can be derived through(9)f=∂Ue∂dandkt=∂fT∂d=∂∂d(∂Ue∂d)TFor a 3-node triangular solid-shell element depicted inFig. 3(a), the initial coordinate vector X and displacement vector U with respect to X can be interpolated as(10)X(s,t,z)=Xo(s,t)+zXn(s,t)=∑i=13Ni(s,t)Xoi+z∑i=13Ni(s,t)XniU(s,t,z)=Uo(s,t)+zUn(s,t)=∑i=13Ni(s,t)Uoi+z∑i=13Ni(s,t)Uni=(ℕo+zℕn)din which N1=r, N2=s and N3=t; r, s, t are the area coordinates and r=1−s−t is treated as a dependent variable. Recalling the strain expression in Eq. (2) as well as the truncating approximations in Eq. (3), the natural in-plane and thickness normal Green strain components for the triangular element are written as(11)εss=X,sTU,s+U,sTU,s/2≃εssm+zεssb,εtt=X,tTU,t+U,tTU,t/2≃εttm+zεttb,γst=(X,sTU,t+X,tTU,s)+(U,sTU,t+U,tTU,s)/2≃γstm+zγstb,εzz=X,zTU,z+U,zTU,z/2=XnTUn+UnTUn/2.To overcome the transverse shear locking, the natural transverse shear strains at the three mid-edge points (see Fig. 3(b)) are firstly obtained as [21](12)γ¯zr=[(XnT(∂rUo)+(∂rXoT)Un)+(UnT(∂rUo)+(∂rUoT)Un)/2]|t=r=1/2γ¯zs=[(XnT(∂sUo)+(∂sXoT)Un)+(UnT(∂sUo)+(∂sUoT)Un)/2]|r=s=1/2γ¯zt=[(XnT(∂tUo)+(∂tXoT)Un)+(UnT(∂tUo)+(∂tUoT)Un)/2]|s=t=1/2in which the differentiation operators are defined as∂rF(r,s,t)=∂∂rF(r,s,1−r−s),∂sF(r,s,t)=∂∂sF(1−s−t,s,t),∂tF(r,s,t)=∂∂tF(r,1−r−t,t).Extrapolatingγ¯zr,γ¯zsandγ¯ztto the three element nodes, one can derive:(13)γ˜1={γ˜zxγ˜zy}1=[∂rx∂ry∂sx∂sy]−1{γ¯zrγ¯zs},γ˜2={γ˜zxγ˜zy}2=[∂sx∂sy∂tx∂ty]−1{γ¯zsγ¯zt},γ˜3={γ˜zxγ˜zy}3=[∂tx∂ty∂rx∂ry]−1{γ¯ztγ¯zr}where∂rx=exT(∂rXo),∂ry=eyT(∂rXo),∂sx=exT(∂sXo),∂sy=eyT(∂sXo),∂tx=exT(∂tXo),∂ty=eyT(∂tXo); ex, eyand ezare the unit vectors of the local physical coordinate system (x,y,z). Then, the physical transverse shear strains can be obtained by the nodal interpolation, i.e.(14)γ˜=[γ˜zx,γ˜zy]T=rγ˜1+sγ˜2+tγ˜3The trapezoidal locking could be alleviated by sampling and interpolating the strain along the three nodal directors, namely(15)ε˜zz=r⋅εzz|s=t=0+s⋅εzz|t=r=0+t⋅εzz|r=s=0The treatment on thickness locking and also the remaining geometric nonlinear formulation for the 3-node triangular solid-shell element just analogically follow the same procedures as its 4-node counterpart.For the mid-surface integration, the three-point rule and the second order Gaussian quadrature are employed for the triangular and quadrilateral elements, respectively.In this section, static analyses on fabric drape examples from [9,10,13,15] are implemented by using the quadrilateral solid-shell element. With Ktand F denoting the global tangential stiffness matrix and global internal force vector assembled from ktand f in Eq. (9), D denoting the global nodal displacement vector and ∆D denoting the iterative refinement of D, the following global equation can be yielded:(16)Kt⋅ΔD=P−Fin which P is the global external force vector. If the full Newton–Raphson iteration is used to solve the equation, we have(17)Kt(i−1)ΔD(i)=P−F(i−1)andD(i)=D(i−1)+ΔD(i)As fabric is very weak in bending, the displacement refinement can be very large and leads to convergent problem. Similar to [7,13,15], a small multiplier is applied to the refinement, namelyD(i)=D(i−1)+λ⋅ΔD(i). The multiplier λ is taken to be(18)λ=10−3Lfmax|ΔD(i)|~10−2Lfmax|ΔD(i)|where Lfis the free-hanging length of fabric and the denominator denotes the maximum absolute value of all the entries in ΔD(i). In all examples, the wool fabric with the mechanical properties inTable 1 is considered. Before deformation, the warp and weft directions are parallel to the global X- and Y-axis, respectively, unless otherwise specified. In Sections 3.1–3.3, dense meshes of Abaqus׳s S4R element are employed to compute the reference solutions by using Abaqus׳s default automatic load stepping. On the other hand, S4R fails to converge for the problems in Sections 3.4 and 3.5.In this example, two wool strips of unit width cut along the warp and weft directions are considered. Both strips are clamped at one end with 5cm free-hanging length and drape under self-weight. The strips are modeled by 10×1 and 20×1 quadrilateral elements. The deformed warp-cut strip predicted by 10×1 elements is shown inFig. 4(a) for visual illustration. The side views of the two deformed strips predicted by using two mesh densities are shown in Fig. 4(b). Compared with the reference solutions yielded by 50×5 S4R elements, it can be seen that the present predictions agree well with the reference solutions.In this example, a 20×20cm2 wool fabric sheet is draped over a 10×10cm2 pedestal. Instead of considering only one quarter of the sheet [13], the whole fabric is analyzed here to assess the symmetry of predictions. By using 24×8×4 and 48×16×4 quadrilateral elements, the deformed shape of the fabric is computed and shown inFig. 5(a) and (b), respectively. In Fig. 5(c), the projected boundaries of the draped fabrics onto the X–Y plane are depicted and compared with two reference solutions. One is the experimental measured result which was conducted by Kang and Yu [10] and the other is the prediction obtained by using 90×30×4 S4R elements. It can be seen that the prediction by 24×8×4 solid-shell elements is less stiff along the warp direction but more flexible at the weft direction than both reference solutions. With the mesh refined to 48×16×4 elements, the prediction fits well with the reference finite element (FE) solution and its visual depiction in Fig. 5(b) appears to be realistic. Furthermore, all the FE predictions are symmetric whereas the experimental shape of Kang and Yu is asymmetric as a result of complex effects involved in experiment such as the inhomogeneity of the fabrics, non-uniformity of the woven structure, asymmetry in the experimental setup, etc.In this example, a ∅25.4cm circular wool fabric sheet is draped over a ∅12.7cm pedestal. The whole fabric is modeled by 10×40 and 20×80 quadrilateral elements. The draped shape predicted by the finer mesh is shown inFig. 6(a). The projected boundaries of the draped fabrics onto the X–Y plane are extracted and compared with the experimental result reported in [10] and the FE prediction by 30×120 S4R elements (see Fig. 6(b)). It can be seen again that all three FE solutions are symmetric while the experiment result is not. The draped fabrics predicted by FEM exhibit diamond shape with four folds which are consistent to the experiment result. The prediction of 10×40 solid-shell elements is marginally more rigid than the FE reference solution which, in turn, is more rigid than the experiment result. With the mesh refined to 20×80 elements, the prediction gets softer and agrees well with the FE reference solution. Fig. 6(c) shows the multi-stable nature of many drape problems [9,10,15]. Instead of possessing four folds in Fig. 6(a), the prediction in Fig. 6(c) possesses eight folds and is obtained simply by doubling the multiplier λ in the iterative solution scheme.In this example, a 50×50cm2 wool fabric sheet over a ∅20cm circular pedestal is considered. The 30×240 mesh is employed to model the fabric and the results are depicted inFig. 7. The draped shape is symmetric and possesses 12 folds which look realistic and conform to our daily perception.In this example, a 40×40cm2 wool fabric sheet over a 20×20cm2 pedestal is considered. 45×15×4 elements are employed and the results are shown inFig. 8. It can be seen that doubling the free-hanging length of the example in Section 3.2, the fabric drapes more thoroughly compared to Fig. 5(b) and looks natural as well.Dynamic analysis needs to take the inertial and damping forces into account. The equation of motion for finite element dynamic analysis can be expressed as(19)MD¨+Fdamp+F=Pin which M,D¨, Fdamp, F, and P are the global mass matrix, the global acceleration vector, the global damping force vector, the global internal force vector and the global external force vector, respectively. By using the trapezoidal rule, the element and, thus, the global mass matrices are diagonal. On the other hand, the major damping in draping is probably the air resistance which increases with the velocity and the fabric area. It would then be sensible to adopt the popular mass Rayleigh damping, i.e.(20)Fdamp=αMḊwhere α is the Rayleigh damping factor empirically set to be 5.0s−1 andḊis the global velocity vector. The central difference explicit time integration is employed [29]. At time t=tn=n Δt, the equation of motion is(21)MD¨n+αMḊn+Fn=PnBy central difference(22)Ḋn=12Δt(Dn+1−Dn−1),D¨n=1Δt(Ḋn+1/2−Ḋn−1/2)=1Δt2(Dn+1−2Dn+Dn−1)Substitution of Eq. (22) into Eq. (21) yields(23)(1Δt2+α2Δt)Dn+1=M−1(Pn−Fn)+2Δt2Dn+(α2Δt−1Δt2)Dn−1from which the displacement at t=tn+1, namely Dn+1, can be solved efficiently as M is diagonal. Solutions at subsequent time steps can be obtained recursively. In the following subsections, examples on dynamic drape simulations considered by using the quadrilateral solid-shell element are presented.Dynamic draping of two square fabric sheets with dimensions 20×20cm2 and 100×100cm2 are considered. They are modeled by 40×40 and 50×50 elements, respectively. Initially, they are horizontal and stress-free. At t=0, they are allowed to fall from rest under gravity with two adjacent corners fixed. The predictions of the smaller one at t=0, 0.1, 0.4, 2.1s are shown inFig. 9. At t=2.1s, it has almost stopped from moving and attained its steady-state configuration. The predictions of the larger one at time instant t=0, 0.4, 1.4, 3.0s are shown inFig. 10. At t=3.0s, it has almost stopped from moving and attained its steady-state configuration. The intermediate and steady-state configurations of the two fabrics are compared. Firstly, the larger one drapes slower than the smaller one. For example, at t=0.4s, the free end of the former has already overshot its lowest position while that of the latter is still on its way. Secondly, the steady-state configuration of the larger fabric possesses more wrinkles than that of the smaller fabric. Both predictions appear to be realistic and conform to our daily perception.In this subsection, four drape examples are considered by dynamic relaxation which uses time integration to obtain the steady-state solution of the damped equation of motion in Eq. (19). The mass scaling technique, which aims at lengthening the critical time step size in the explicit time integration by scaling up the nodal mass, is employed and all nodal masses are increased by 100 times while the weight appearing as the external force vector remains unchanged.The first three examples have already been considered in Section 3 using static analysis. They are the 20×20cm2 fabric sheet draped over a 10×10cm2 pedestal, the 40×40cm2 fabric sheet draped over a 20×20cm2 pedestal and the 50×50cm2 fabric sheet draped over a ∅20cm circular pedestal. Here, they are re-analyzed with the same meshes used in the static analysis. For both 20×20cm2 and 40×40cm2 fabrics problems, the steady-state drapes are highly similar to the static predictions and are not plotted again for saving space. For the 50×50cm2 fabric, the steady-state configuration is shown inFig. 11(a) which shows ten folds. On the other hand, 12 folds are predicted in the static solution (see Fig. 7). To further verify multi-stable draped patterns for this type of problem [9], the authors reduce the Rayleigh damping factor α in Eq. (20) to 1.0s−1 and re-analyzes this problem with the same mesh. A different pattern with eight folds is predicted as shown in Fig. 11(b). The predictions with eight, ten and twelve folds all appear to be realistic.The fourth example considers a 30×30cm2 cloth draped over a ∅10cm sphere in which the cloth-to-sphere contact is involved and treated by the penalty method [9]. A 60×60 mesh is used to model the cloth. Top and side views of the steady-state configuration are shown inFig. 12(a) and (b). Unrealistic sharp folds are noticed in the zoomed top view in Fig. 12(c).The sharp fold observed in Fig. 12(c) is further identified to be the interpenetration of top and bottom surfaces of solid-shell elements. This non-physical interpenetration has been reported in [13] (see Fig. 2). It is caused by zero force modes of the ANS solid-shell elements and the following quasi-engineering thickness strain at node p was proposed as a remedial measure [13]:(24)εzz={‖Xnp+Unp‖‖Xnp‖−1=‖Xnp+Unp‖−1fornpTdp>−μ,−‖Xnp+Unp‖‖Xnp‖−1=−‖Xnp+Unp‖−1otherwise,where npis the upward unit vector normal to the deformed element mid-surface and dpis the normalized deformed counterpart of Xnp, i.e.np=(Xoq+Uoq−Xop-Uop)×(Xop+Uop−Xor-Uor)‖(Xoq+Uoq−Xop-Uop)×(Xop+Uop−Xor-Uor)‖anddp=(Xnp+Unp)‖Xnp+Unp‖where q=1+mod(p,4) and r=1+mod(p+2,4) define the two adjacent nodes of node p; μ is a positive scalar less than unity. Interpenetration occurs at node p whennpTdp<0. The above nodal thickness normal strains are then interpolated to get the element normal thickness strains. FornpTdp<−μ, the quasi-engineering strain is the same as engineering strain.The quasi-engineering strain is not always effective to alleviate the interpenetration problem. For instance, using 60×60 quadrilateral elements employing the strain to predict the 30×30cm2 cloth problem, unrealistic sharp folds due to interpenetration similar to those shown in Fig. 12 exist. However, using 100×100 quadrilateral elements employing the Green thickness strain, the interpenetration and unrealistic sharp fold are not detected throughout the dynamic relaxation process. The steady-state configuration is shown inFig. 13 which is a bit unsymmetric. As the fabric drape simulation involves a large number of iterations or time steps, loss of symmetry is well-expected and also observed in [9,16]. In this light, reducing the element size or refining the mesh appears to be more effective in avoiding interpenetration.Fine mesh is required to predict realistic wrinkles/folds which may not be captured by coarse meshes. It can also avoid the interpenetration. Nevertheless, a finer mesh usually brings forward higher computational cost and requires smaller critical time step. In solid-shell elements, the critical time step is controlled by the thickness stretching mode and, in general, is insensitive to the planar size of the element. To avoid the computational burden on using fine mesh in areas where wrinkles/folds are absent or mild, adaptive meshing has been popularly used in drape/cloth simulation which can broadly categorized into locally-based and globally-based. Most of them [8,30–32] belong to the locally-based adaptive meshing in which triangles/quadrilaterals are subdivided and consequently multi-level meshes are generated. In the globally-based approach, the mesh is re-generated and the nodal variables are obtained through projection [16]. By comparison, the locally-based approach is less computation consuming. Moreover, it causes far less oscillation in nonlinear and dynamic analyses. In this paper, a reversible local adaptive meshing method is developed for drape/cloth simulation in which 4-node quadrilateral and 3-node triangular solid-shell finite elements are employed. The subdivision process is a 1–4 splitting method [33] and the merging process is basically the reverse subdivision process.In adaptive mesh subdivision, elements belonging to different subdivision level are co-used (seeFig. 14(a)). To keep track of the nodes and elements, a background mesh is employed. In the user-input mesh or Level 0 mesh (see Fig. 14(b)), each element is split into 4nchild elements by performing the 1–4 splitting n times and the finest or background mesh is obtained (see Fig. 14(c)) for n=3. In each splitting operation, four mid-edge and one center nodes will be inserted to an existing quadrilateral to make up the correct number of nodes needed by the subdivision. While Xoand Xnof the mid-edge nodes are obtained by simple averaging, those of the center node are obtained by using the interpolation functions of the 8-node serendipity element. All Xoand Xnof the nodes in the background mesh are numbered sequentially and stored. A 1D array is declared to indicate whether the nodes are active after each subdivision/merging.To build the connections between nodes and elements in different levels, the element labeling scheme to be described are adopted. InFig. 15(a), nodes 1–4 taken anti-clockwisely define element i0 in Level 0. When it is split, its Level 1 child elements include elements i0-1 to i0-4 taken anti-clockwisely and the first node of element i0 is also the first node of element i0-1. Following the same scheme, the elements outlined by the thickened lines in Fig. 15(b) and (c) should be labeled as i0-3-1 and i0-4-2-3, respectively. The connectivity of all elements in the background mesh is stored. In this way, the connectivity of the elements at different levels can be deduced according to its label and the connectivity of elements in the background mesh.In the adaptive drape/cloth simulation, curvature/curvature-based parameters popularly serve as the adaptive criteria. Here, an element in Level i is subdivided if(25)‖εb‖⋅Li>constin which Liis the average element side length, and const is a preset positive dimensionless coefficient. It can be noted in Eq. (6) that the dimension of εbis 1/length and is a measure of the curvature. Similar refinement criteria are also used in [31,32].During the deformation process, a curved fabric area may be flattened. In this light, the child elements at Level i from the same parent element at Level i-1 is merged if all the child elements satisfy the condition(26)‖εb‖⋅Li−1≤const−∈where∈is another preset positive dimensionless coefficient less than const.The criteria in Eqs. (25) and (26) also define the admissible ranges of ||εb|| for elements at different levels. It should be also noted that the condition in Eq. (25) is sufficient but not necessary for splitting while that in Eq. (26) is necessary but not sufficient for merging. Considerations to be elaborated in the following section must be taken for ensuring the mesh conformity.A major issue for most, if not all, local adaptive meshing schemes is interfacing the elements at different levels with the required displacement continuity maintained. To reduce the redundancy in the data structure and avoid excessive dynamic oscillation of the nodal variable, the subdivision and merging processes are not allowed to create adjacent elements with their levels differ by more than 1. To avoid gaps occurring in the common edge of two adjacent elements at different levels, measures in literature include constructing macro-transition elements with triangular elements [33], constraining the new-inserted mid-edge node to the common edge [8] and using 5- to 7-node transition quadrilateral elements [34].Fig. 16(a) shows the macro-transition elements composed of triangles given in [33] for different combinations of mid-edge nodes along the boundary. The 3-node triangular solid-shell elements befit these macro-transition elements. However, some of the employed triangles have poor mesh quality. Moreover, the 3-node triangular solid-shell elements still have moderate possibility of shear-locked even after the ANS method has been adopted [21].In this work, hybrid macro-transition elements formed by 3-node triangles and 4-node quadrilaterals shown in Fig. 16(b) are employed. It can be seen that the use of triangles is minimal and all elements possess reasonable mesh quality. The macro-transition elements interfacing the Level i and Level i+1 elements will be marked as Level i+1/2.In each 1–4 splitting, the newly inserted nodes are mid-edge and center nodes. The initial positions of the new-inserted nodes have been readily provided in the background mesh. For the kinematic variables of a new-inserted mid-edge node, the linear interpolation of displacements is often used which, however, causes considerable oscillation in the dynamic system. Here, a novel interpolation method based on the discrete Kirchhoff (DK) assumption [26,27] is used to obtain the kinematic variables of new-inserted mid-edge nodes. A very brief introduction on the DK condition is here illustrated by using the 4-node quadrilateral DK plate element inFig. 17. In the element, the mid-plane is defined by z=0 whilst the inplane displacements are given by u=zβxand v=zβy. The following describes how (βx,βy) at the fictitious mid-edge node, node 5, bounded by nodes 1 and 2 are defined by using the DK condition. The following Kirchhoff conditions are imposed at the discrete points:(27)βx+w,x=0andβy+w,y=0atnodes1and2,(28)βs+w,s=0atnode5where s is the running coordinate from node 1 to node 2. From Eq. (27), the rotations (βn,βs) at nodes 1 and 2 about the tangential and normal directions, respectively, can be obtained by transformation. Hence, w,sat nodes 1 and 2 would be available. The thin beam interpolation can be constructed based on the w and w,sat nodes 1 and 2. At node 5, one can obtain from the thin beam interpolation and Eq. (28) that(29)w,s|node5=−βs|node5=−32L12(w|node1−w|node2)−14(w,s|node1+w,s|node2)in which L12 is the distance from node 1 to node 2. On the other hand, βnat node 5 is taken to be the average of those at nodes 1 and 2. Finally, (βx,βy) at node 5 can be obtained from (βn,βs) at the same node.As the first and second nodal dofs in Unof the solid-shell elements are respectively analogous to the rotational dofs βxand βyof the DK element, the above DK conditions are here extended to obtain the variables of the newly inserted mid-edge node. Note worthily, the above DK conditions are based on the linear strain–displacement relationship. To consider the geometric nonlinearity, the co-rotational framework [29] is adopted. Consider the edge of a 4-node quadrilateral solid-shell element inFig. 18 with nodes A and B being the corner nodes whilst node M being the new-inserted mid-edge node. Node E is another corner node to define the initial mid-plane EAB. (XoA, XoB, XoM, XoE), (XnA, XnB, XnM, XnE) and (UA, UB, UM, UE) are respectively the initial position vectors, the initial directors and displacement vectors of A, B, M and E. After deformation, the nodes are at A′, B′, M′ and E′ whilst xnA, xnB, and xnM are the nodal directors. The co-rotated x′–y′–z′ frame is defined with its origin at A′; its y′-axis passing thru A′B′; and E′ on the x′–y′-plane. The co-rotational configuration of the edge A′–Mc–Bcobtained by rigid body motion from A–M–B is shown in the figure.For small strain, the difference between A′–Mc–Bcand A′–M′–B′ is small. From A′ to A′,uoAl=0whilst the components ofunAlalong the x′-, y′- and z′-axis are:(30)unA=nx′T(XnA+UnA),vnA=ny′T(XnA+UnA),wnA=nz′T(XnA+UnA)−1in which nx′, ny′ and nz′ are the unit vectors along the local x′-, y′- and z′-axis, respectively. Similarly, from Bcto B′,(31)uoB=woB=0,voB=‖XoB+UoB−XoA−UoA‖−‖XoB−XoA‖,unB=nx′T(XnB+UnB),vnB=ny′T(XnB+UnB),wnB=nz′T(XnB+UnB)−1.Using the DK conditions in Eqs. (27)–(29), the components ofuMlfrom Mcto M′ along the local x′-, y′- and z′-axis can be derived to be(32)uoM=12(uoA+uoB),voM=12(voA+voB),woM=12(woA+woB)−LAB8(vnA−vnB),vnM=−wo,y׳|y׳=LAB/2=32LAB(woA−woB)−14(vnA+vnB),unM=12(unA+unB),wnM=12(wnA+wnB),where LAB is the initial length of the edge AB. Then, the global displacement of node M can be expressed as(33)UM=UMc+uMlin whichUMcis the displacement vector from M to Mcand is given as(34)UoMc=UoA+LAB2ny׳−(XoM−XoA)andUnMc=xnMc×XnM.Similar approach is used to get the velocity of the mid-edge node M.If there is a newly inserted center node, displacements and velocities of all the mid-edge nodes regardless whether they need to be inserted or not are first derived. Those of the center node are then obtained from the corner and mid-edge nodes by using interpolation functions of the 8-node serendipity element.With the key issues in the reversible adaptive procedure discussed in the last subsections, the procedure is summarized below:(a)The background mesh is generated from the user-input Level 0 mesh; the initial nodal positions and directors as well as the element connectivity are generated and stored according to the element labels in the background mesh.The Level 0 mesh is firstly invoked by switching on the nodes of Level 0 elements.The simulation is advanced for a prescribed number of integration time increments.In the current mesh, flag all the elements ‘0’, calculate the bending strain for all elements, change the element flag to ‘+1’ if the strain satisfies the subdivision criterion or ‘−1’ if the strain satisfies the merging criterion.Implement both subdivision and merging operations on the current mesh. During the adaptive meshing process, the removed nodes are switched off and the newly inserted nodes are switched on. The kinematic variables of these newly inserted nodes are obtained through the DK condition discussed in Section 5.4.Update the global nodal mass matrix according to the new-generated mesh.Go to step (c).In Section 4, the four fabric drape examples considered by dynamic relaxation need relatively dense meshes to avoid interpenetration and obtain realistic predictions. Here, they will be re-analyzed by using the adaptive mesh generation.For the 20×20cm2 fabric sheet draped over a 10×10cm2 pedestal, the adaptive mesh and deformed configurations at different time instants are shown inFig. 19. Fig. 19(a) depicts the Level 0 mesh which employs 48 quadrilaterals. It can be seen from Fig. 19(b) that the mesh refinement is firstly activated along the weft direction due to the smaller bending rigidity. As the fabric drapes, the mesh is self-adaptive to the curvature distribution and dense meshes can be seen at areas with wrinkles and folds (see Fig. 19(c)). Fig. 19(d) depicts the steady-state configuration which is highly similar to that predicted by the 48×16×4 uniform mesh in Fig. 5(b). Nevertheless, it is noteworthy that the maximum number of switched-on nodes in the present adaptive mesh is only half of that in the 48×16×4 uniform mesh.For the 40×40cm2 fabric sheet draped over a 20×20cm2 pedestal, the adaptive mesh and deformed configuration at different instants are shown inFig. 20. Fig. 20(a) shows the Level 0 mesh which employs 48 quadrilaterals. As the fabric starts to drape under gravity, the meshes at the four corners become denser than other areas (see Fig. 20(b) and (c)). Fig. 20(d) shows the steady-state shape of the fabric sheet and it looks similar to the prediction in Fig. 8 which is obtained by using 45×15×4 uniform mesh. Again, the maximum number of switched-on nodes in the adaptive mesh is far less than that in the uniform mesh.For the 50×50cm2 fabric sheet draped over a ∅20cm pedestal, the adaptive meshes and deformed shapes at different time instants are shown inFig. 21. Fig. 21(a) shows the Level 0 mesh which employs 4×32 quadrilaterals. As the fabric sheet drapes, the mesh around eight radii becomes denser than other areas as shown in Fig. 21(b) and (c). Eight folds are formed in the steady-state configuration given in Fig. 21(d). It can be noted that the present steady-state pattern is different from that in Fig. 11(b) though both of them possess eight folds, which again reflects the multi-stable drape patterns.For the 30×30cm2 cloth draped on a ∅10cm sphere, the adaptive meshes and deformed shapes at different time instants are shown inFig. 22. The Level 0 mesh in Fig. 22(a) contains 16×16 quadrilaterals. As the cloth drapes over the sphere, both the adaptive meshing and the cloth-to-sphere contact are activated. The mesh density along the X- and Y-axis is distinctively higher due to fold development (see Fig. 22(b) and (c)). Fig. 22(d) shows the steady-state configuration of the cloth which looks highly similar to that predicted by 100×100 uniform mesh in Fig. 13. The maximum number of switched-on nodes in the adaptive mesh is only about half of that in the 100×100 uniform mesh, however, unrealistic sharp fold or interpenetration appeared in Fig. 12(c) is no more detected throughout the dynamic process.In this paper, the solid-shell finite element method is applied in both static and dynamic fabric drape simulation. Both 4-node quadrilateral and 3-node triangular solid-shell elements are used. In their geometric nonlinear formulations, transverse shear and trapezoidal lockings are subdued by the ANS method and the thickness locking is overcome by plane-stress enforcement. Static and dynamic drape examples are examined by using the 4-node solid-shell element and predictions look realistic if the drape is shallow. When the drape is deep or the mesh density is not adequate, the non-physical interpenetration appears and produces unrealistic sharp fold. To circumvent the interpenetration, a local adaptive mesh generation technique based on the 1–4 splitting method is developed. To link elements at different subdivision levels, macro-transition elements composed of quadrilateral and triangular elements are employed. Meanwhile, the DK condition is generalized to obtain the kinematic variables of the new-inserted mid-edge nodes during each remeshing process. The assumption is effective in reducing the out-of-balance forces and, thus, the dynamic oscillation. Examples involving deep folds and/or interpenetrations are repeated. The adaptive meshing is effective in producing realistic predictions by effectively capturing wrinkles/folds of the fabric and avoiding the interpenetration problem.

@&#CONCLUSIONS@&#
