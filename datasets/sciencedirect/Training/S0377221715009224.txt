@&#MAIN-TITLE@&#
Better than pre-commitment mean-variance portfolio allocation strategies: A semi-self-financing Hamilton–Jacobi–Bellman equation approach

@&#HIGHLIGHTS@&#
We expand the admissible set for pre-commitment MV portfolio allocation.It can be proved it is optimal to withdraw cash in certain cases.We determine the optimal strategy by numerically solving an HJB equation.Numerical examples illustrate the optimality of cash withdrawals.

@&#KEYPHRASES@&#
Finance,Investment analysis,Constrained pre-commitment mean-variance,HJB equation,

@&#ABSTRACT@&#
We generalize the idea of semi-self-financing strategies, originally discussed in Ehrbar (1990), and later formalized in Cui et al (2012), for the pre-commitment mean-variance (MV) optimal portfolio allocation problem. The proposed semi-self-financing strategies are built upon a numerical solution framework for Hamilton–Jacobi–Bellman equations, and can be readily employed in a very general setting, namely continuous or discrete re-balancing, jump-diffusions with finite activity, and realistic portfolio constraints. We show that if the portfolio wealth exceeds a threshold, an MV optimal strategy is to withdraw cash. These semi-self-financing strategies are generally non-unique. Numerical results confirming the superiority of the efficient frontiers produced by the strategies with positive cash withdrawals are presented. Tests based on estimation of parameters from historical time series show that the semi-self-financing strategy is robust to estimation ambiguities.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
In this paper, we generalize the idea of semi-self-financing strategies developed in Cui and Li (2010), Cui et al. (2012), and Ehrbar (1990) for the MV optimal portfolio allocation problem, which can be re-formulated as an embedded MV optimization problem (Li & Ng, 2000; Zhou & Li, 2000) in terms of the numerical solution of an HJB equation. Under this fully numerical approach, it is straightforward to determine an MV embedded optimal strategy over all possible semi-self-financing strategies, in a very general setting, namely continuous or discrete re-balancing, jump-diffusions with finite activity, and realistic portfolio constraints. If the portfolio wealth is above a critical threshold, then we prove that a scalarization MV optimal strategy is (i) to withdraw wealth exceeding this threshold, and (ii) to invest the remaining wealth in the risk-free asset for the remainder of the investment horizon.In certain cases, we can prove that an optimal scalarization MV strategy is to not withdraw cash if the portfolio wealth is below the critical threshold. However, it remains an open question as to whether or not this is true in general for the case of jump-diffusions and discrete re-balancing. Nonetheless, we always observe that it is non-optimal to withdraw below the threshold in all of our numerical experiments.We show that, in general, embedded MV optimal semi-self-financing strategies are not unique. However, in case of non-uniqueness, all embedded MV optimal semi-self-financing strategies produce the same embedded MV points. Using the results of Dang et al. (2015) and Tse et al. (2014), we show that all of these strategies generate the same set of points on the MV efficient frontier. Moreover, semi-self-financing strategies have the ability to produce a free cash flow during the investment, and can never be inferior, in terms of MV efficiency, to a self-financing strategy.We have carried out an empirical data analysis using historical long term market returns. We obtain estimates for a GBM model, as well as estimates for jump diffusion models. Jump diffusion models are probably the simplest models which account for the observed fat tails of market returns. Based on several representative test cases, we find that the semi-self-financing pre-commitment mean-variance strategies are robust to model parameter estimation errors.We present a characterization of the main property of the embedding technique given in Li and Ng (2000) and Zhou and Li (2000) in terms of the achievable objective set. This main property is summarized in Theorem 2.1. We follow along the lines of Li and Ng (2000) and Zhou and Li (2000) to prove this result, although we use slightly different steps. We include this proof to illustrate the generality of the embedding result, i.e. it is essentially independent of the specification of the admissible set for the control c(·).ProofAssume to the contrary that (2.13) does not hold. Then,(A.1)inf(V,E)∈YV+E2−γE<V0+E02−γE0.Then there exists(V*,E*)∈Ysuch that(A.2)V*+E*2−γE*<V0+E02−γE0.Rearranging Eq. (A.2) and multiplying by ρ > 0 gives(A.3)ρ(V*+E*2)−ρ(V0+E02)−γρ(E*−E0)<0Substitute Eq. (2.14) into Eq. (A.3) to obtain(A.4)ρ(V*+E*2)−ρ(V0+E02)−(1+2ρE0)(E*−E0)<0.Further manipulation gives(A.5)(ρV*−E*)−(ρV0−E0)+ρ(E*2−E02−2E0E*+2E02)<0,and(A.6)ρV*−E*<ρV0−E0−ρ(E*−E0)2,and henceρV*−E*<ρV0−E0,which contradicts Eq. (2.12). Hence (2.13) holds.□Finally, we note that the embedded objective function can be written as(A.7)V+E2−γE=Ec(·)x0,t0[Wc(T)2]−(Ec(·)x0,t0[Wc(T)])2+(Ec(·)x0,t0[Wc(T)])2−γEc(·)x0,t0[Wc(T)]=Ec(·)x0,t0[Wc(T)2−γWc(T)]=Ec(·)x0,t0[(Wc(T)−γ/2)2]−(γ/2)2So minimizing the above embedded objective function is equivalent to (2.15).In this section, we briefly describe the HJB PIDEs for the case of continuous re-balancing and jump-diffusions. For brevity, we omit the PIDEs for the case of discrete re-balancing which can be found in Dang et al. (2015). For the case of continuous re-balancing with jump-diffusions, the MV optimal portfolio allocation problem can be formulated as the solution to a 2-dimensional (2-D) impulse control problem, in the form of a non-linear HJB PIDE. This approach is suggested in Dang and Forsyth (2014). We refer the reader to Dang and Forsyth (2014) for a complete discussion of the formulation. We define the solution domain as(B.1)Ω={(s,b,t)∈[0,∞)×(−∞,+∞)×[0,T]}.We define the solvency region, denoted byS,as(B.2)S={(s,b)∈[0,∞)×(−∞,+∞):Wc(s,b)>0},and the bankruptcy (insolvency) regionB=Ω∖S. LetQ={(s,b)∈S:s/(s+b)>qmax}be the region where the leverage constraint is violated. We respectively denote byLVandJVthe diffusion and jump operators, where(B.3)LV≡σ2s22Vss+(μ−λκ)sVs+rbVb−λV,(B.4)JV≡∫0∞p(ξ)V(ξs,b,τ)dξ.Following standard arguments (Øksendal & Sulem, 2009; Pham, 2009), the value function V(s, b, t) is the viscosity solution of the HJB PIDE(B.5)max[Vt+LV+JV,V−infc∈Z(M(c)V)]=0;if(s,b)∈S∖Q,(B.6)max[Vt+rbVb,V−infc∈Z(M(c)V)]=0;ifs=0,(B.7)V−infc∈Z(M(c)V)=0;if(s,b)∈Q,(B.8)V(s,b,t)=V(0,Wc(s,b),t);if(s,b)∈B,(B.9)V(s,b,T)={(s+b−γ/2)2Z=Zself(max(γ/2−(s+b),0))2Z=Zsemi,defined on the domain Ω. The intervention operatorM(c)V(s,b,t)is defined as(B.10)M(c)V(s,b,t)=V(S(s,b,c),B,t)+ϱ.Here, ϱ > 0 is an arbitrarily small switching cost required to ensure that the impulse control HJB PIDE problem is well-posed, the control c ≡ (d, B) is defined in (2.3), and S(s, b, c) is defined in (2.4).For computational purposes, we localize the original domain to(B.11)Ωloc={(s,b,t)∈[0,smax)×[−bmax,bmax]×[0,T]},where smaxand bmaxare positive and sufficiently large. We assume that the boundary conditions at smax,−bmax,and bmaxused in this paper are the asymptotic forms of the HJB PDE/PIDE as s, |b| → ∞ (Dang & Forsyth, 2014).