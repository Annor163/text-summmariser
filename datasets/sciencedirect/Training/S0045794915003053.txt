@&#MAIN-TITLE@&#


@&#HIGHLIGHTS@&#
The first computational treatment of magnetostritive effects in conducting fluids.Consistent linearisation of the coupled non-linear equations.Computational solution using Newton–Raphson and hp-finite elements.Benchmarking against problems with homogeneous material parameters.Simulation of complex flow problems with non-homogeneous material parameters.

@&#KEYPHRASES@&#
Magnetohydrodynamics,Coupled problems,hp-Finite elements,Magnetostriction,

@&#ABSTRACT@&#
We extend our existing hp-finite element framework for non-conducting magnetic fluids (Jin et al., 2014) to the treatment of conducting magnetic fluids including magnetostriction effects in both two- and three-dimensions. In particular, we present, to the best of our knowledge, the first computational treatment of magnetostrictive effects in conducting fluids. We propose a consistent linearisation of the coupled system of non-linear equations and solve the resulting discretised equations by means of the Newton–Raphson algorithm. Our treatment allows the simulation of complex flow problems, with non-homogeneous permeability and conductivity, and, apart from benchmarking against established analytical solutions for problems with homogeneous material parameters, we present a series of simulations of multiphase flows in two- and three-dimensions to show the predicative capability of the approach as well as the importance of including these effects.

@&#INTRODUCTION@&#
Magnetohydrodynamics (MHD) studies the behaviour of electrically conducting fluids under the existence of a magnetic field [6,15,30]. Since it was established by Hannes Alfvén in 1942, the field of MHD has grown rapidly and is now widely established and used in a variety of research fields, such as in geophysics (e.g. [3]), space weather forecasting (e.g. [33]), plasma physics (e.g. [22]), nuclear fusion reactors (e.g. [31]), metal casting (e.g. [14]) and in the Lorentz force flowmetre [28], to name but a few.MHD can be viewed as a particular case of coupling between magnetic fields and fluids. In general, time independent magneto-fluid coupled problems can be described by the coupling between the steady incompressible Navier–Stokes equations(1a)ρ(∇v)v-∇·[[σF]]=f,(1b)∇·v=0,which govern the fluid flow, and the time independent Maxwell equations(2a)∇×H=Jext+Johm,(2b)∇×E=0,(2c)∇·B=0,(2d)∇·D=ρv,which govern the electromagnetic fields. In (1),ρis the fluid density,vis the fluid velocity,[[σF]]is the Cauchy stress tensor andfis total body force. Furthermore, in (2),Bis the magnetic flux density vector,Dis the electric flux intensity vector,Jextis the external current source,Johmis the Ohmic current,ρvis the volume current density andEandHare the electric and magnetic field intensity vectors, respectively.From the fluid perspective, we shall consider it to be Newtonian, with constitutive law(3)[[σF]]=-p̂[[I]]+2μ̂[[ε]],where[[I]],[[ε]]are the identity and strain rate tensors, respectively. Furthermore,p̂is the pressure andμ̂is the dynamic viscosity. From the electromagnetic perspective, we consider constitutive laws of the form(4)B=μH,Johm=ΣE,D=∊E,whereμis the permeability of the material, which describes the extent of magnetisation,Σis its conductivity and∊is its permittivity. Note that residual magnetism will be ignored and that, in general,μ,Σand∊are tensors, in which case we denote them as[[μ]],[[Σ]]and[[∊]], respectively. For a discussion on different classes of diamagnetic, paramagnetic and non-magnetic fluids, we refer to [26].Intrinsic to simulating MHD problems is the coupling mechanism. The existence of a magnetic field applies a magnetic body forcefEM(ponderomotive force) (as a contribution tof) onto the fluid domain, which affects the fluid flow. There are several different expressions for this magnetic body force, which can be found in the literature [10–12,29,38]. All in all, the magnetic body force consists of the Lorentz force, the magnetostrictive force and the dimagnetophoretic force [10]. We follow Stratton [38] and call the combination of dimagnetophoretic and magnetostrictive forces magnetostriction. In previous research on MHD, the electromagnetic constitutive relations are usually selected as (2), with a scalar constant permeability and conductivity. Furthermore, dielectric effects and the magnetostrictive (and dimagnetophoretic) forces are neglected and only the Lorentz force is considered [1,29]. This, in turn, leads to the standard governing equations for MHD stated in Moreau [30], Davidson [6] and Armero and Simo [1]. However, when considering problems with different fluid phases [16,41], as well as problems where the induced strain rate alters the distribution of[[μ]], which in turn changes the magnetic field distribution, magnetostrictive effects become important [26,27]. This coupling mechanism is illustrated in Fig. 1. In order to include magnetostrictive effects with ease, it makes sense to revisit the governing equations for MHD and instead express the ponderomotive forcefEMin terms of the divergence of a stress tensor[[σEM]](5)fEM=∇·[[σEM]],which, in turn, permits more general coupling mechanisms to be considered. In order to solve MHD problems cost-effectively, various finite element methodologies have been applied thus far. Guermond and Minev [19,20] dealt with a decoupled linear MHD problem involving electrically conducting and insulating regions by using a mixed finite element approach with nodal (H1(Ω)conforming) finite elements for the magnetic field. It was observed that in non-convex domains with sharp edges and corners, a nodal finite element approach may fail to capture the singularities associated with these domains. Therefore, Schneebeli and Schötzau proposed a new mixed finite element for stationary incompressible MHD based on the Sobolev spaceH(curl,Ω)[34,36]. In [21], a weighted regularisation approach was used to solve the same equation set. In [5], Codina and Hernández-Silva present a stabilised finite element method for the stationary magneto-hydrodynamic equations based on a simple algebraic version of the subgrid scale variational concept. Houston, Schötzau and Wei applied a discontinuous Galerkin (DG) method to linearised incompressible MHD in [23]. Greif, Schötzau, Wei and Li used a DG method with divergence free velocities for incompressible MHD [18]. AH(div)conforming finite element has been proposed to solve the MHD equations so that the divergence-free condition on the magnetic flux intensity vector is rigorously guaranteed [4]. However, in all of these approaches, only a simple conducting fluid with constant permeability and conductivity was considered.Our recent work has been devoted to the application of high-order hp-finite element discretisations to problems involving the coupling of electromagnetism, mechanics and fluids including electrostricitive and magnetostrictive effects. In [17], a fixed point algorithm was applied to the simulation of fully coupled electrostrictive dielectric materials. Then, in [25,26], we extended our methodology to account for magnetostrictive effects in both nearly incompressible and incompressible Newtonian fluids and applied a Newton–Raphson algorithm, which exhibits quadratic convergence of the residual and exponentially fast convergence of the unknown fields. In closely related work, [32], the hp-finite element analysis of three-dimensional linear piezoelectric beams is also considered.This work continues to build on these developments and presents the following novel contributions. We extend our existing hp-finite element framework for non-conducting magnetic fluids to the treatment of conducting magnetic fluids including magnetostriction effects in both two- and three-dimensions. In particular, we present, to the best of our knowledge, the first computational treatment of magnetostrictive effects in conducting fluids. We propose a consistent linearisation of the resulting non-linear equations and solve the resulting discretised equations by means of the Newton–Raphson algorithm. We once again employ the high order hp-finite element discretisation of Schöberl and Zaglmayr [35,40], but the computational complexity in the present contribution is considerably higher than in our previous work due to the requirement of compatibleH1,L2andH(curl)conforming discretisations, which this basis set provides. The advantages of hp-finite elements are already outlined in [7,8,17] and thus are not discussed here.The article is broken down into the following sections. In Section 2, the coupling approach is introduced and applied to derive the governing equations of MHD for homogeneous conducting fluids as well as for conducting magnetostrictive fluids. In Section 3, the Newton–Raphson algorithm is established via a consistent linearisation for both cases. Section 4 describes, briefly, the main features of the hp-finite element framework employed for the spatial discretisation of the weak form. Section 5 includes a series of numerical examples, well known within the fluid mechanics community, which are used to demonstrate the accuracy and robustness of the hp-implementation. Finally, some concluding remarks are summarised in Section 6.In this section we construct the boundary value problems (BVPs) for describing the problem of stationary incompressible MHD, beginning with the boundary value problem for homogeneous isotropic conducting fluids with constant scalar permeability and conductivity and then, extending this to the treatment of more general magnetic fluids, including magnetostrictive effects. In the first case, following the discussion in the introduction, the electromagnetic body force is assumed to be described entirely using only the Lorentz force. Then, in the second case, we consider a more general ponderomotive force, which is expressed as the divergence of a stress tensor.In a similar manner to [23,36], we consider a bounded Lipschitz domainΩ⊂Rd,d=2,3,Ω≔ΩF∪ΩM, whereΩFis the fluid domain andΩMis the magnetic domain. For simplicity, we shall assume thatΩ=ΩF=ΩMand its boundary can be described as∂Ω=∂ΩDF∪∂ΩNF=∂ΩDM∪∂ΩNM. We introduce the scaled fields as(6)E=∊01/2E,D=∊0-1/2D,ρv=∊0-1/2ρ̂v,H=μ01/2H,B=μ0-1/2B,J=μ01/2J,where∊0andμ0denote the permittivity and permeability of free space, respectively. It can then be shown that the coupling between (1) and (2) due to the Lorentz force, in absence of dielectric effects and the magnetostrictive forces and with constitutive relations (4) and (3), leads to the BVP formulation derived in [1,18,36], which we write in the form(7a)ρ(∇v)v-∇·[[σF]]=finΩ,(7b)∇·v=0inΩ,(7c)[[μr]]∇r+∇×c[[σ̃]]-1∇×H-∇×(v×[[μr]]H)=ginΩ,(7d)∇·([[μr]]H)=0inΩ,(7e)v=vDon∂ΩDF,(7f)([[σF]])n=ton∂ΩNF,(7g)n×H=fDon∂ΩDM,(7h)n×(c[[σ̃]]-1∇×H+v×[[μr]]H)=fNon∂ΩNM,whereHis the scaled magnetic field intensity introduced in (6) andg:=∇×(c[[σ̃]]-1Jex)is a source term,nis unit outward normal vector. In addition,[[σ̃]]≔μ0/∊01/2[[Σ]]is the scaled electric conductivity tensor,[[μr]]≔[[μ]]/μ0is the relative permeability tensor, c is the speed of light andJexis an external current source. Here r is the Lagrange multiplier which is used to enforce (7d)[36].The constitutive laws for this system are stated in (4) and (3) where, for the scaled fields,[[μ]]becomes[[μr]]and[[Σ]]becomes[[σ̃]]. Furthermore, in the case of a homogeneous isotropic conducting fluid,[[μr]]and[[σ̃]]become constant multiples of[[I]]andμ̂adopts a constant value. Furthermore, the body forcefin this case is(8)f:=f̃+fEM=f̃+∇×H×([[μr]]H),which follows from rescaling the Lorentz forceJ×B. In the above,f̃is the non-magnetic part of the total body force. Note that, compared to the form of the stationary incompressible MHD equations presented in [23,36], we have chosen to write the formulation in terms of the scaled magnetic intensityH, rather than the magnetic flux densityB≔[[μ]]H.With the addition of suitable transmission conditions, (7) can already treat problems involving subdomains in which[[μr]]and[[σ̃]]are different scalar multiples of[[I]]. However, we also wish to include other effects. As stated in the introduction, magnetostrictive effects become crucial in the case of multiphase problems where the magnetic permeability exhibits changes in its gradient. In order to include these effects, we consider a total body force acting on the fluid domain, where we expressfEMin terms of the divergence of a stress tensor asf:=f̃+∇·[[σEM]],and, in general,[[σEM]]:=[[σE]]+[[σH]],[[σE]]=[[σE]]0+[[σE]]∊,[[σH]]=[[σH]]0+[[σH]]μ.Note thatfEMexpressed in this form implicitly includes the effects described byJ×B=∇×H×([[μ]]H)in the absence of magnetostriction. In our case, only magnetic effects are important and so[[σEM]]=[[σH]]and the contributions[[σH]]0and[[σH]]μare those associated with free space and a magnetic material, respectively. Specifically, in the case of a homogeneous isotropic medium with[[μ]]=μ0μr[[I]], then in the same manner as [17],(9a)[[σH]]0=μ0H⊗H-μ02(H·H)[[I]],(9b)[[σH]]μ=μ0(μr-1)-μr(1)2H⊗H-12((μr-1)+μr(2))(H·H)[[I]],whereμr(1)andμr(2)are as defined in [26].Further simplifications can be made by making use of the scaled magnetic intensityH, such that(10a)[[σH]]0=H⊗H-12(H·H)[[I]],(10b)[[σH]]μ=(μr-1)-μr(1)2H⊗H-12((μr-1)+μr(2))(H·H)[[I]].For a magnetostrictive conducting fluid, the stress tensor can be expressed in a similar way to [26] to include magnetostrictive effects as(11)[[σEM]]=[[σH(H)]]=μr-μr(1)2H⊗H-12μr+μr(2)(H·H)[[I]],(12)[[μr]]=[[μr(v)]]=μr[[I]]+(∇·v)[[I]]-2[[ε(v)]]+μr(1)[[ε(v)]]+μr(2)(∇·v)[[I]].Using the stress tensor approach allows us to consider a more general set of boundary conditions for (7) asv=vDon∂ΩDF,([[σF]]+[[σEM]])n=ton∂ΩNF,n×H=fDon∂ΩDM,n×(c[[σ̃]]-1∇×H+v×[[μr]]H)=fNon∂ΩNM,where∂Ω=∂ΩDF∪∂ΩNF=∂ΩDM∪∂ΩNMand, in general we do not require that∂ΩDF=∂ΩDMor∂ΩNF=∂ΩNM. The difference between the homogeneous isotropic conducting fluid and a magnetostrictive conducting fluid is that, the Neumann boundary for the fluid domain contains the total stress tensor, which is more realistic at describing the actual physics since, in real experiments, terms making up the contributions to the applied traction cannot be identified separately.IfΩconsists of a series of non-overlapping regions such thatΩ=Ω1∪Ω2∪⋯then, at the interfaces between different materials,∂Ωi∩∂Ωj, the following conditions are required to holdv|∂Ωi=v|∂Ωj([[σF]]+[[σEM]])n|∂Ωi=([[σF]]+[[σEM]])n|∂Ωjn×H|∂Ωi=n×H|∂Ωjn×(c[[σ̃]]-1∇×H+v×[[μr]]H)|∂Ωi=n×(c[[σ̃]]-1∇×H+v×[[μr]]H)|∂Ωj.In this section, we present the linearised schemes for both homogeneous isotropic conducting and magnetostrictive conducting fluids. Once the linearised schemes have been established by computing directional derivatives, the Newton–Raphson is applied and the resulting algorithms are summarised in Algorithms 1 and 2.We begin by following the treatment described in Section 2.1. Associated with (7), we define for the weak solutions(v,p̂,H,r)∈W(vD)×Z×Y(fD)×Xthe associated residualsRv,Rp̂,RHandRras(13a)Rv(vδ;v,p̂,H):=∫Ωρ(∇v)v·vδdΩ+∫Ω[[σF]]:[[ε(vδ)]]dΩ-∫Ωf̃·vδdΩ+∫Ωvδ×([[μr]]H)·∇×HdΩ-∫∂ΩNFt·vδd∂Ω,(13b)Rp̂(p̂δ;v)≔∫Ω(∇·v)p̂δdΩ,(13c)RH(Hδ;v,H,r):=-∫Ωc[[σ̃]]-1∇×H·∇×HδdΩ+∫Ωv×([[μr]]H)·∇×HδdΩ-∫Ω[[μr]]∇r·HδdΩ+∫Ωg·HδdΩ-∫∂ΩNMfN·Hδd∂Ω,(13d)Rr(rδ;H):=-∫Ω[[μr]]H·∇rδdΩ,for all(vδ,p̂δ,Hδ,rδ)∈W(0)×Z×Y(0)×Xwhere, following [36], we haveW(vD)≔v∈(H1(Ω))d:v=vDon∂Ω,Z≔p̂∈L2(Ω):∫Ωp̂dΩ=0,Y(fD)≔H∈H(curl,Ω):n×H=fDon∂Ω,X≔r∈H1(Ω):r=0on∂Ω.In the aboveH1(Ω),L2(Ω),H(curl,Ω)have their usual meanings (e.g. [7]) and we denote by(u,v)Ω:=∫Ωu·vdΩthe standardL2inner product and by‖u‖L2:=(u,u)Ω-1/2theL2norm. In addition, we associate the corresponding‖u‖H1:=(‖u‖L22+‖∇u‖L22)1/2and‖u‖H(curl):=(‖u‖L22+‖∇×u‖L22)1/2norms.The residuals given in (13) are obtained by weighting Eq. (7) with the weightsvδ,p̂δ,Hδandrδand performing integration by parts. Notice that all boundary terms disappear for the pure Dirichlet case.We remark that it is necessary to add the criteria that∫Ωp̂dΩ=0in Z in order to ensure uniqueness of the pressure field when dealing with pure Dirichlet boundary conditions forv[37].With an iterative solution approach in mind, we consider possible trial solutions(v[m],p̂[m],H[m],r[m])∈W(vD)×Z×Y(fD)×Xand linearise the residuals (13) as follows(14a)Rv(vδ;v[m],p̂[m],H[m])+DRv(vδ;v[m],p̂[m],H[m])[δv[m]]+DRv(vδ;v[m],p̂[m],H[m])[δp̂[m]]+DRv(vδ;v[m],p̂[m],H[m])[δH[m]]=0,(14b)Rp̂(p̂δ;v[m])+DRp̂(p̂δ;v[m][δv[m]]=0,(14c)RH(Hδ;v[m],H[m],r[m])+DRH(Hδ;v[m],H[m],r[m])[δH[m]]+DRH(Hδ;v[m],H[m],r[m])[δv[m]]+DRH(Hδ;v[m],H[m],r[m])[δr[m]]=0,(14d)Rr(rδ;H[m])+DRr(rδ;H[m])[δH[m]]=0,for all(vδ,p̂δ,Hδ,rδ)∈W(0)×Z×Y(0)×Xwith update equations(15a)v[m+1]=v[m]+δv[m],(15b)p̂[m+1]=p̂[m]+δp̂[m],(15c)H[m+1]=H[m]+δH[m],(15d)r[m+1]=r[m]+δr[m].The directional derivatives can be computed as(16a)DRv(vδ;v[m],p̂[m],H[m])[δv[m]]=∫Ωμ̂∇δv[m]:∇vδdΩ+∫Ωμ̂(∇·δv[m])(∇·vδ)dΩ+∫Ωρ(v[m]·∇δv[m])·vδdΩ+∫Ωρ(δv[m]·∇v[m])·vδdΩ̲,(16b)DRv(vδ;v[m],p̂[m],H[m])[δp̂[m]]=-∫Ω(∇·vδ)δp̂[m]dΩ,(16c)DRv(vδ;v[m],p̂[m],H[m])[δH[m]]=∫Ω(vδ×[[μr]]δH[m])·∇×H[m]dΩ̲+∫Ω(vδ×[[μr]]H[m])·∇×δH[m]dΩ,(16d)DRp̂(p̂δ;v[m])[δv[m]]=-∫Ω(∇·δv[m])pδdΩ,(16e)DRH(Hδ;v,H,r)[δH[m]]=-∫Ωc[[σ̃]]-1∇×δH[m]·∇×HδdΩ+∫Ωv[m]×([[μr]]δH[m])·∇×HδdΩ̲,(16f)DRH(Hδ;v,H,r)[δv[m]]=∫Ω(δv[m]×[[μr]]H[m])·∇×HδdΩ,(16g)DRH(Hδ;v,H,r)[δr[m]]=-∫Ω[[μr]]∇δr[m]·Hδ,(16h)DRr(rδ;H)[δH[m]]=-∫Ω[[μr]]δH[m]·∇rδdΩ.where certain terms have been highlighted for later reference. Assuming the solutions(v[m],p̂[m],H[m],r[m])to be known, and associating the bilinear formsCvv,Cvp̂,CvH,Cp̂v,CHH,CHv,CHrandCrHin turn with the directional derivatives stated above, the Newton–Raphson iteration can be stated as: Find(δv[m],δp̂[m],δH[m],δr[m])∈W(0)×Z×Y(0)×Xsuch that(17a)Cvv(vδ,δv[m])+Cvp̂(vδ,δp̂[m])+CvH(vδ,δH[m])=-Rv(vδ;v[m],p̂[m],H[m]),(17b)Cp̂v(p̂δ,δv[m])=-Rp̂(p̂δ;v[m]),(17c)CHH(Hδ,δH[m])+CHv(Hδ,δv[m])+CHr(Hδ,δr[m])=-RH(Hδ;v[m],H[m],r[m]),(17d)CrH(rδ,δH[m])=-Rr(rδ;H[m]).for all(vδ,p̂δ,Hδ,rδ)∈W(0)×Z×Y(0)×Xwith(v[0],p̂[0],H[0],r[0])∈W(vD)×Z×Y(fD)×X.Note that, by neglecting terms with an underline in (16) the simplified Picard iterative scheme can be obtained [36]. This scheme is fully symmetric withCvH(vδ,δH[m])=CHv(δv[m],Hδ), in addition to the already symmetric termsCvp̂(vδ,δp̂[m])=Cp̂v(δp̂[m],vδ)andCHr(Hδ,δr[m])=CrH(δr[m],Hδ). The Newton–Raphson scheme for a homogeneous fluid can be summarised as shown in Algorithm 1.Algorithm 1Newton–Raphson scheme for a homogeneous isotropic conducting fluid.Require:v[m],p̂[m],H[m],r[m],Rv[m-1],Rp̂[m-1],RH[m-1],Rr[m-1]form=0and TOL1: while‖Rv[m-1]‖,‖Rp̂[m-1]‖,‖RH[m-1]‖and‖Rr[m-1]‖⩾TOLdo2: Solve the linear system of Eq. (17)→δv[m],δp̂[m],δH[m],δr[m]3: Record the residual for stepm→Rv[m],Rp̂[m],RH[m]andRr[m]4: Update the solution with Eq. (15)→v[m+1],p̂[m+1],H[m+1],r[m+1]5:m←m+16: end while7: returnv←v[m+1],p̂←p̂[m+1],H←H[m+1],r←r[m+1]In this section we consider the extension of Section 3.1 to more complex magnetostrictive fluids. In order to achieve this we follow Section 2.2 and our own presentation in [26]. In this case, associated with (7), we define for the weak solutions(v,p̂,H,r)∈W(vD)×Z×Y(fD)×Xthe associated residualsR̃v,R̃p̂,R̃HandR̃ras(18a)R̃v(vδ;v,p̂,H)≔∫Ωρ(∇v)v·vδdΩ+∫Ω[[σF+σEM]]:[[ε(vδ)]]dΩ-∫Ωf̃·vδdΩ-∫∂ΩNFt·vδd∂Ω,(18b)R̃p̂(p̂δ;v)≔∫Ω(∇·v)p̂δdΩ,(18c)R̃H(Hδ;v,H,r):=-∫Ωc[[σ̃]]-1∇×H·∇×HδdΩ+∫Ωv×([[μr(v)]]H)·∇×HδdΩ-∫Ω([[μr(v)]]∇r)·HδdΩ+∫Ωg·HδdΩ-∫∂ΩNMfN·Hδd∂Ω,(18d)R̃r(rδ;H,v):=-∫Ω([[μr(v)]]H)·∇rδdΩ,for all(vδ,p̂δ,Hδ,rδ)∈W(0)×Z×Y(0)×X. Note that in the case of non-pure Dirichlet conditions the constraint of∫Ωp̂dΩ=0in Z can also be dropped.Analogue to the previous section, with the possible trial solutions(v[m],p̂[m],H[m],r[m])∈W̃(vD)×Z×Ỹ(fD)×X, the linearised residuals (18) can be written as follows(19a)R̃v(vδ;v[m],p̂[m],H[m])+DR̃v(vδ;v[m],p̂[m],H[m])[δv[m]]+DR̃v(vδ;v[m],p̂[m],H[m])[δp̂[m]]+DR̃v(vδ;v[m],p̂[m],H[m])[δH[m]]=0,(19b)R̃p̂(p̂δ;v[m])+DR̃p̂(p̂δ;v[m][δv[m]]=0,(19c)R̃H(Hδ;v[m],H[m],r[m])+DR̃H(Hδ;v[m],H[m],r[m])[δH[m]]+DR̃H(Hδ;v[m],H[m],r[m])[δv[m]]+DR̃H(Hδ;v[m],H[m],r[m])[δr[m]]=0,(19d)R̃r(rδ;v[m],H[m])+DR̃r(rδ;v[m],H[m])[δv[m]]+DR̃r(rδ;v[m],H[m])[δH[m]]=0,for all(vδ,p̂δ,Hδ,rδ)∈W̃(0)×Z×Ỹ(0)×Xwith similar update equations to (15).The directional derivatives are(20a)DR̃v(vδ;v[m],p̂[m],H[m])[δv[m]]=DRv(vδ;v[m],p̂[m],H[m])[δv[m]],(20b)DR̃v(vδ;v[m],p̂[m],H[m])[δp̂[m]]=DRv(vδ;v[m],p̂[m],H[m])[δp̂[m]],(20c)DR̃v(vδ;v[m],p̂[m],H[m])[δH[m]]=∫Ω[[ε(vδ)]]:∂[[σEM]]∂HδH[m]dΩ,(20d)DR̃p̂(p̂δ;v[m])[δv[m]]=DRp̂(p̂δ;v[m])[δv[m]],(20e)DR̃H(Hδ;v[m],H[m],r[m])[δH[m]]=-∫Ωc[[σ̃]]-1∇×δH[m]·∇×HδdΩ+∫Ωv[m]×([[μr(v[m])]]δH[m])·∇×HδdΩ,(20f)DR̃H(Hδ;v[m],Hm],r[m])[δv[m]]=∫Ω(δv[m]×[[μr(v[m])]]H[m])·∇×HδdΩ+∫Ωv[m]×∂([[μr]]H)∂[[ε]]:[[ε(δv[m])]]·∇×HδdΩ,(20g)DR̃H(Hδ;v[m],H[m],r[m])[δr[m]]=-∫Ω[[μr(v[m])]]∇δr[m]·HδdΩ,(20h)DR̃r(rδ;v[m],H[m])[δv[m]]=-∫Ω∇rδ·∂([[μr]]H)∂[[ε]]:[[ε(δv[m])]]dΩ,(20i)DR̃r(rδ;v[m],H[m])[δH[m]]=-∫Ω[[μr(v[m])]]δH[m]·∇rδdΩ.In the above∂[[σEM]]∂Hijk=μr-μr(1)2δikHj+δjkHi-μr+μr(2)δijHk,∂([[μ]]H)∂[[ε]]ijk=(μr+μr(2))δjkHi+(μr(1)-2μr)δijHk.Assuming the solutions(v[m],p̂[m],H[m],r[m])to be known, and associating the bilinear formsC̃vH,C̃HH,C̃Hv,C̃Hr,C̃rvandC̃rHin turn with the new directional derivatives stated above, the Newton–Raphson iteration can be stated as: Find(δv[m],δp̂[m],δH[m],δr[m])∈W(0)×Z×Y(0)×Xsuch that(21a)Cvv(vδ,δv[m])+Cvp̂(vδ,δp̂[m])+C̃vH(vδ,δH[m])=-R̃v(vδ;v[m],p̂[m],H[m]),(21b)Cp̂v(p̂δ,δv[m]])=-R̃p̂(p̂δ;v[m]),(21c)C̃HH(Hδ,δH[m])+C̃Hv(Hδ,δv[m])+C̃Hr(Hδ,δr[m])=-R̃H(Hδ;v[m],H[m],r[m]),(21d)C̃rv(rδ,δv[m])+C̃rH(rδ,δH[m])=-R̃r(rδ;H[m]).for all(vδ,p̂δ,Hδ,rδ)∈W(0)×Z×Y(0)×Xwith(v[0],p̂[0],H[0],r[0])∈W(vD)×Z×Y(fD)×X. Note that this reduces to (17) for a homogeneous isotropic conducting fluid without magnetostrictive effects. The Newton–Raphson scheme for a magnetostrictive material can be summarised as shown in Algorithm 2.Algorithm 2Newton–Raphson scheme for a magnetostrictive fluid.Require:v[m],p̂[m],H[m],r[m],R̃v[m-1],R̃p̂[m-1],R̃H[m-1],R̃r[m-1]form=0and TOL1: while‖R̃v[m-1]‖,‖R̃p̂[m-1]‖,‖R̃H[m-1]‖and‖R̃r[m-1]‖⩾TOLdo2: Solve the linear system of Eq. (21)→δv[m],δp̂[m],δH[m],δr[m]3: Record the residual for stepm→R̃v[m],R̃p̂[m],R̃H[m]andR̃r[m]4: Update the solution with Eq. (15)→v[m+1],p̂[m+1],H[m+1],r[m+1]5:m←m+16: end while7: returnv←v[m+1],p̂←p̂[m+1],H←H[m+1],r←r[m+1]The hp-finite element discretisation of (17) and (21) follows similar lines to that already discussed in [17,26], where we employ the hp-finite element discretisation of Schöberl and Zaglmayr [35,40]. In the following, we discuss the discretisation for an unstructured tetrahedral discretisation ford=3, the corresponding triangular discretisation ford=2follows mostly by obvious simplifications. For this we consider a regular simplicial triangulation ofΩdenoted byTh, with the set of verticesVh, the set of edgesEhand the set of facesFhand recall the low-order vertex, high-order edge-face-cell based splitting of the hierarchic scalarH1conforming finite element spaceXh,p≔Xh,1⊕∑edgesE∈EhXpE⊕∑facesF∈FhXpF⊕∑cellsI∈ThXpI⊂H1(Ω),whereXh,1is the classical space of continuous piecewise linear hat functions andXpE,XpF,XpIdenote its hierarchic edge, face and cell enrichment. In the case of a uniform polynomial degree we obtain the space of polynomials of total degree p, i.e.Xh,p|T≔Pp(T)on each elementT∈Themployed. For problems in this work we require a discretisation of the vectorH(curl)conforming space, employing the approach of Schöberl and Zaglmayr [35,40] this results in the splitting low order edge, high order edge-face-cell based splittingYh,p≔Yh,0⊕∑edgesE∈EhYpE⊕∑facesF∈FhYpF⊕∑cellsI∈ThYpI⊂H(curl,Ω),whereYh,0is the classical Nédélec element with continuous constant tangential components on edges andYpE,YpF,YpIdenote its hierarchic edge, face and cell enrichment. In addition, we setWh,p:={v:v∈(Xh,p)3},Zh,p-1:=Zh,0⊕∑cellsI∈ThZp-1I⊂L2(Ω),whereZh,0is the space of classical scalar finite element space of piecewise constants. We present below the fully discretised version of (17), which must be solved at each Newton–Raphson iteration for a simple conducting fluid. Then, in Section 4.2, we present the corresponding discretised version of (21) for the case of a conducting magnetostrictive fluid.The mth step of the discrete Newton–Raphson scheme for this fluid ind=3is: Find(δv,hp[m],δp̂,hp[m],δH,hp[m],δr,hp[m])∈W(0)∩Whp+2×Z∩Zhp-1×Y(0)∩Yhp+1×X∩Xhp+2such that(22a)Cvv(vhpδ,δv,hp[m])+Cvp̂(vhpδ,δp̂,hp[m])+CvH(vhpδ,δH,hp[m])=-Rv(vhpδ;vhp[m],p̂hp[m],Hhp[m]),(22b)Cp̂v(p̂hpδ,δv,hp[m])=-Rp̂(p̂hpδ;vhp[m]),(22c)CHH(Hhpδ,δH,hp[m])+CHv(Hhpδ,δv,hp[m])+CHr(Hhpδ,δr,hp[m])=-RH(Hhpδ;vhp[m],Hhp[m],rhp[m]),(22d)CrH(rhpδ,δH,hp[m])=-Rr(rhpδ;Hhp[m]).for all(vhpδ,p̂hpδ,Hhpδ,rhpδ)∈W(0)∩Whp+2×Z∩Zhp-1×Y(0)∩Yhp+1×X∩Xhp+2. The update equations are similar to those given in (15). It is important to note the need to use different sets of basis functions for the different fields but, also, the need to use different polynomial degrees. Ford=2triangular elements, the updates of velocityδv,hp[m]and pressureδp̂,hp[m]are approximated as polynomials of degreePp,Pp-2in order to satisfy the LBB condition [37]. Ford=3, the updates of velocityδv,hp[m]and pressureδp̂,hp[m]are approximated as polynomials of degreePp,Pp-3in order to satisfy the LBB condition for tetrahedral elements for this case [8,37]. The updates of the magnetic fieldδH,hp[m]and the Lagrange multiplierδr,hp[m]are selected to bePp-1,Ppfor bothd=2andd=3[8].The mth step of the discrete Newton–Raphson scheme for a conducting fluid including magnetostrictive effects ind=3is: Find(δv,hp[m],δp̂,hp[m],δH,hp[m],δr,hp[m])∈W(0)∩Whp+2×Z∩Zhp-1×Y(0)∩Yhp+1×X∩Xhp+2such that(23a)Cvv(vhpδ,δv,hp[m])+Cvp̂(vhpδ,δp̂,hp[m])+C̃vH(vhpδ,δH,hp[m])=-R̃v(vhpδ;vhp[m],p̂hp[m],Hhp[m]),(23b)Cp̂v(p̂hpδ,δv,hp[m]])=-R̃p̂(p̂hpδ;vhp[m]),(23c)C̃HH(Hhpδ,δH,hp[m])+C̃Hv(Hhpδ,δv,hp[m])+C̃Hr(Hhpδ,δr[m])=-R̃H(Hhpδ;vhp[m],Hhp[m],rhp[m]),(23d)C̃rv(rhpδ,δv,hp[m])+C̃rH(rhpδ,δH,hp[m])=-R̃r(rδ;H[m]),for all(vhpδ,p̂hpδ,Hhpδ,rhpδ)∈W(0)∩Whp+2×Z∩Zhp-1×Y(0)∩Yhp+1×X∩Xhp+2. In the above, terms with a tilde are different from those in (22), which have been constructed in order to include magntostrictive effects, but do reduce to their previous forms in the case of a homogeneous isotropic conducting fluid. The polynomial orders are taken as described in Section 4.1.A series of numerical examples are presented to benchmark our approach by applying it to the simulation of MHD problems ind=2,3with known analytical solutions. Then, the predictive capability of our approach is considered by applying it to the simulation of problems ind=2,3, which include non-homogeneous media and magnetostrictive effects, that do not have analytical solutions.In order to verify thed=2implementation, we apply the scheme to several well-known benchmarking problems. We start from a simplified linearised case with smooth and singular solutions. We then progress to the fully coupled problem, where a smooth problem and the well known Hartmann flow problem [18,9,15] are used for verification.The first example consists of an L-shaped domainΩ=(-1,1)2⧹([0,1)×(-1,0])on which we consider the solution of a linearised MHD problem [36] by considering[[μr]]=c[[σ̃]]-1=[[I]]andρ=μ̂=1. For this linearised problem, only a single step of the Picard iteration scheme is required for which we setv[0]=21,H[0]=x-yinΩ,and choosef̃andgso that the analytical solution is [23](24)δv=-(ycosy+siny)exysinyex,δp̂=2exsiny,δH=-(ycosy+siny)exysinyex,δr=-sinπxsinπy,inΩ. Then, the boundary conditions are different to those in Algorithm 1 and are of the formδv,hp[0]=δvon∂ΩDF=∂Ωandn×δH,hp[0]=n×δHon∂ΩDM=∂Ω. As the analytical solution is smooth, we consider a fixed uniform mesh consisting of 382 triangular elements and apply uniform p-refinement with polynomial degreesp=2,3,4,5,6, where p refers to the degree of theH1conforming approximation and the degrees of the approximation for the other variables are chosen to satisfy the LBB constraints (see Section 4.1). Unless otherwise stated, we follow this convention for naming p in each of the following examples.In Fig. 2(a) we show the convergence of‖δv-δv,hp[0]‖H1and‖δH-δH,hp[0]‖H(curl), which both indicate a downward sloping curve confirming the expected exponential convergence of p-refinement for this smooth problem. In Fig. 2(b) we show the computed streamlines forδv,hp[0]for the converged solution.We again consider the L-shaped domain described in the previous subsection for the linearised MHD problem with the same material parameters as described above. Let us consider a single step of the Picard iteration withv[0]=00,H[0]=-11inΩ,andf̃andgselected so that the analytical solution is [23](25)δv=ρ̂λ((1+λ)sin(ϕ)ψ(ϕ)+cos(ϕ)ψ′(ϕ))ρ̂λ(-(1+λ)cos(ϕ)ψ(ϕ)+sin(ϕ)ψ′(ϕ)),δp̂=-ρ̂λ-1((1+λ)2ψ′(ϕ)+ψ‴(ϕ))/(1-λ),δH=∇(ρ̂2/3sin(2/3ϕ)),δr=0,inΩwhere(26)ψ(ϕ)=sin((1+λ)ϕ)cos(λw)/(1+λ)-cos((1+λ)ϕ)-sin((1-λ)ϕ)cos(λw)/(1-λ)+cos((1-λ)ϕ).In the above(ρ̂,ϕ)represent the polar coordinates centred atx=0,y=0and, for the case whereω=32πandλ≈0.54448373678246, the analytical solution exhibits a strong magnetic singularity at the origin [23]. The boundary conditions are analogous to Section 5.1.1.A series of meshes are constructed with geometric refinement towards the re-entrant corner (and the location of singularity), the geometric refinement factors are2,3,4,5and 6, respectively. Illustrations of typical meshes with grading factors 3 and 6, and 176 and 308 unstructured triangles, respectively, are shown in Fig. 3.On these meshes we apply uniform p-refinement with polynomial degreesp=2,3,4,5,6leading to the results shown in Fig. 4(a) where the convergence of‖δv-δv,hp[0]‖H1and‖δH-δH,hp[0]‖H(curl)can be observed. As expected, a family of convergence curves are produced and each show a similar behaviour: initially p-refinement on particular grid produces a rapid convergence of the error, which then slows to an algebraic rate of convergence with further increments of p. By combining both h- and p-refinements the resulting error envelope is a downward sloping curve, confirming the expected exponential convergence for this problem with a strong singularity. Fig. 4(b) shows the computed streamlines forδv,hp[0]for the converged solution. In Fig. 4(c) and (d), the computed contours for the x and y components ofδH,hp[0], for the converged solution, are presented from which we can observe the strong singularity towards the re-entrant corner.A fully coupled non-linear MHD problem with a known smooth analytical solution can be found in several references such as [18,9]. We use the former for benchmarking our fully coupled Newton–Raphson implementation summarised in Algorithm 1. The geometry consists of a square domainΩ=(-1,1)2, and we construct the problem by setting the parameters as[[μr]]=[[I]],c[[σ̃]]-1=104andρ=μ̂=1. The source termsf̃,gare chosen so that the analytical solution is(27)v=y2x2,p̂=x,H=1-y21-x2,r=(1-x2)(1-y2).inΩand the Dirichlet boundary conditionsvhp[0]=von∂ΩDF=∂Ωandn×Hhp[0]=n×Hon∂ΩDM=∂Ωare applied. From (27), we can deduce that, of the different fields, r is of the highest polynomial degree being bi-quadratic and, for triangular elements, this means thatp=4H1conforming elements are required to fully capture this field. AlthoughHandvare quadratic functions, which can be captured withp=2H1conforming andp=2H(curl)conforming elements, respectively, we expect that, due to the coupled nature of the problem, these fields will not be fully resolved until the degree isp=4(using our earlier naming convention).For the fully coupled smooth problem, we consider performing hp-refinement with elements of uniform sizeh=0.6,0.3,0.15,0.075, the finest mesh having 2048 unstructured triangular elements. Uniform p-refinement is applied with polynomial degreesp=2,3,4,5, where the last p increment represents an intentional overkill to test the implementation.In Fig. 5(a) we show the computed quadratic convergence for updatesδv,hp[m],δH,hp[m]andδp̂,hp[m]and the relative residualR=‖Rv[m],Rp̂[m],RH[m],Rr[m]‖/‖Rv[0],Rp̂[0],RH[0],Rr[0]‖forp=5elements, which implies the correct implementation of the Newton–Raphson method. Then, in Fig. 5(b) we show the convergence of hp-refinement for‖v-vhp[m]‖H1,‖p̂-p̂hp[m]‖L2and‖H-Hhp[m]‖H(curl)withm=M, such thatR⩽10-10, which indicate a downward sloping curve confirming the expected exponential convergence of p-refinement for each of the meshes considered. Note that, unless otherwise stated, this Newton–Raphson convergence criteria will be used in the following. As the analytical solution for r is bi-quadratic, the p-refinement should converge to machine precision withp=4for this problem, which is exactly exhibited in the figure.The description of thed=2Hartmann flow problem can be found in [18,9] and this allows us to further benchmark our full Newton–Raphson scheme as the resulting solution satisfies both the linearised and the non-linear MHD equations. For this problem, the domain is set to beΩ=(0,L)×(-1,1)withL≫1, for which we chooseL=10. The analytical solution corresponds to an unidirectional flow under constant pressure gradient-Gin the x-direction withf̃=g=0. In order to apply our scheme to the reference non-dimensional Hartmann flow problem, we set the parameters as[μr]=[[I]],ν=μ̂/ρ=0.1,[[σ̃]]=σ̃[[I]],σ̃-1c/ρ=0.1,Ha=10,G=0.5,ρ=1,p0=10. The analytical solution to this problem then corresponds to(28)v=GμνHatanh(Ha)1-cosh(yHa)cosh(Ha)0,(29)H=Gρsinh(yHa)sinh(Ha)-y1,(30)p̂=-Gx-G22ρsinh(yHa)sinh(Ha)-y2+p0,(31)r=0.inΩ. We set∂ΩDFto be the boundaries corresponding to(0,y),y∈(0,1)and(x,±1),x∈(0,L)and here we prescribevhp[0]=vand we set∂ΩDM=∂Ωandn×Hhp[0]=n×H, while on∂ΩNF=∂Ω⧹∂ΩDF, we prescribethp=t=[[σEM]]n(free velocity boundary), based on the above analytical solution.As the analytical solution is smooth for this low Hartmann number, a single mesh consisting of 400 triangular elements is employed. On this mesh we consider both the linearised one step Picard [23] and the fully coupled non-linear Newton–Raphson schemes. For the one-step Picard scheme we solve the linearised problem, as described in [23], and for the Newton–Raphson scheme we apply Algorithm 1. In both cases, we apply uniform p-refinement with polynomial degreesp=3,4,5,6,7and show, in Fig. 6(a), the typical quadratic convergence of the relative residualR=‖Rv[m],Rp̂[m],RH[m],Rr[m]‖/‖Rv[0],Rp̂[0],RH[0],Rr[0]‖for the Newton–Raphson iterations when uniformp=7elements are used. In Fig. 6(b), we show the convergence of‖v-vhp[M]‖H1and‖H-Hhp[M]‖H(curl)where M denotes the iteration of the converged solution for Newton–Raphson scheme and‖δv-δv,hp[0]‖H1and‖δH-δH,hp[0]‖H(curl)for the one-step Picard. Fig. 6(b), indicates that both schemes converge exponentially fast with p-refinement to the analytical solution.Subsequently, we have considered the convergence of updates‖v-vhp[M]‖L2,‖v-vhp[M]‖H1,‖p̂-p̂hp[M]‖L2and‖H-Hhp[M]||H(curl)for Hartmann numbersHa=0.01,1,10,1010underhp-refinements. These tabulated results are presented in full in [24], here we show only the case forHa=10forh=0.25andh=0.125in Tables 1 and 2, respectively, which we compare with the convergence of the error stated in references [18,9].Although the results shown in [18,9] are obtained with a different method and are presented for h-refinement only, we can compare the accuracy of the solutions with respect to the number of degrees of freedom (DOFs). Our hp-finite element scheme shows a significant improvement in terms of accuracy when compared to the reference solution. In particular, we can use much fewer DOFs yet still achieve the same level of accuracy, which indicates the high efficiency and high accuracy of the current approach. However, we also acknowledge that, ideally, if the data is available, the computational cost should not only be measured in terms of degrees of freedom as a hp-approach does result in matrices that are not as sparse as in pure h-refinement and there are additional computation costs associated with the generation of the basis functions and the evaluation of the elemental contributions. Nonetheless, these can be minimised by a careful implementation, see e.g. [24]. From the tables of convergence behaviour in [24], we also can conclude that, for higher Hartmann number, more DOFs are needed. This indicates that a high Hartmann number introduces strong coupling, steeper gradients as well as non-linearity into the system, which makes the flow behaviour much more challenging to capture.The numerical solutions for the centreline profiles for x-component of the velocity and x-component of the magnetic field are illustrated in Fig. 7with different Hartmann numbers. It transpires that, on the chosen mesh, the degree of the elements needs to be chosen asp=7to fully capture the behaviour of the strong coupling and the non-linearity of the MHD problem. The comparison between numerical and analytical solutions, which shows a good agreement, indicates the accuracy of the implementation. From the results, we can also see that, a high Hartmann number results in steeper gradients near the boundary, which are well captured by our hp-refinements.After verifying our implementation, and in order to show the applicability of our approach to capture complex flow patterns, we now consider applying Algorithm 2 to solve a multiphase MHD flow, which consists of two different fluids. The geometry and mesh are shown in Fig. 8. The mesh is refined near the inner droplet as we are interested in the behaviour between two different fluids.The domain consists ofΩ=(0,2)×(-1,1)with 9 droplets, each being a circle with radiusrin=0.1and equally separated inside the squared domain at positions(0.5,-0.5),(0.5,0),(0.5,0.5),(1,-0.5),(1,0),(1,0.5),(1.5,-0.5),(1.5,0)and(1.5,0.5). The Neumann boundary for the fluid part is∂ΩNF=(2,y),y∈(-1,1)with conditionthp=t=[[σEM]]nand the Dirichlet boundary for the fluid part∂ΩDF=∂Ω⧹∂ΩNFwith conditionvhp[0]=(v(1-y2),0). For the magnetic field, the Dirichlet boundary conditionsn×Hhp[0]=n×HDare applied on∂ΩDM=∂ΩwhereHD=(0,H). Note that v is the amplitude of input velocity and H is the amplitude of the magnetic field. In order to investigate the influence of the magnetic field on the multiphase problem, the amplitude H of the magnetic field is increased. The parameters for the inner and outer fluids are taken from [13,15] and shown in Table 3. Here v can be obtained by the relationv=Re×μ̂/(2rin), whereRe=0.01is the Reynolds number without the magnetic field and in absence of the droplets.With a mesh of 2910 unstructured triangular elements, we found, by uniformly incrementing the polynomial degree, thatp=5is required in order to fully capture the complex fluid pattern. Several different magnetic amplitudes are applied, namelyH=0.1,0.2,0.4, and the results of the streamlines for the multiphase problem and the quadratic convergence curve for the different magnetic fields are shown in Fig. 9. The results shown in Fig. 9(a), (c), and (d) indicate the correct implementation of the Newton–Raphson scheme and in Fig. 9(b), (d), and (e) the influence of the magnetic field over the fluid flow pattern is illustrated. In particular, we see that as the magnitude of the magnetic field is increased, the flow pattern is substantially effected creating regions of low and high velocities in the vicinity of the conducting cylinders. This complex flow pattern would be impossible to be captured without the use of a higher order discretisation. Fig. 9 also indicates that the contrast of the magnetic permeability for the two different fluids could result in a complex flow pattern under a large magnetic field.Next, we verify thed=3implementation by applying the scheme to several well-known benchmarking problems. As we have already established the benefits of the Newton Raphson over the Picard iteration we consider only the former and use it to benchmark a lid-driven cavity with and without a magnetic field, a three dimensional extension of the Hartmann flow problem and, to finish, we show the predicative capability of the scheme by applying it to a multiphase MHD flow problem.We first consider the standard lid-driven cavity problem for pure Navier–Stokes flow in the absence of a magnetic field on the cubic domainΩ=(0,1)3. We define the surface(x,y,1),x,y∈(0,1)as∂ΩDF(1)and the other boundary faces as∂ΩDF(2)=∂Ω⧹∂ΩDF(1). We impose the boundary conditionsv=(v,0)on∂ΩDF(1),v=0on∂ΩDF(2).where v is the constant amplitude of the applied of the driving velocity. For this problem an unstructured mesh of 756 tetrahedral elements is generated on which uniform orderp=3,4,5,6elements are applied forRe=100,p=4,5,6are applied forRe=400andp=6,7,8are applied forRe=1000.Initially, we consider the flow pattern in the absence of a magnetic field. Fig. 10(a), (c), and (e) shows the quadratic convergence of a suitably simplified version of the Newton–Raphson procedure given in Algorithm 1 to the previously stated criteria whereR=‖Rv[m],Rp̂[m]‖/‖Rv[0],Rp̂[0]‖and the convergence of the updates variablesδvandδp̂are also presented for completeness. We can observe that, with an increasing Reynolds number, we need more iterations to converge. ForRe=1000, an incremental approach using 2 increments has also been applied (see [24] for details). Note that the convergence shown in Fig. 10(e) is for the final increment forRe=1000withp=8. In Fig. 10(b), (d), and (f), the centreline profiles forvx(0.5,y,0.5)for0⩽y≤1forRe=100,400,1000with p-refinement are presented and in Fig. 11the corresponding streamlines are shown. The results show that as the degree of the polynomial order is increased, the solution converges to the reference solution. For the lower Reynolds numberRe=100we can see that, withp=4, we can already accurately capture the fluid behaviour. ForRe=400,p=6is needed to fully solve the problem. ForRe=1000, even withp=8, our computed solution is still slightly away from the reference solution. In this case local mesh refinement, combined with p-refinement could be applied, if desired, to improve the accuracy.Secondly, we consider the case of the coupled MHD problem where, in addition to the fluid boundary conditions, we applyn×Hhp[0]=n×HDon∂ΩDM=∂Ωwhere we chooseHD=(1,0,0)andHD=(0,1,0), in turn, as uniform magnetic fields. Here, in order to adapt our framework to the dimensionless schemes, we set the parameters as[μr]=[[I]],κ=ρ,ν=μ̂/ρ=0.1,[[σ̃]]=σ̃[[I]],νm=σ̃-1c/ρ,Ha=κ/ννm. The fluid parameters are summarised in Table 4for the Hartmann numberHa=10withRe=1/ν=400andRem=1/νm=40as [2]. The mesh of 6048 unstructured tetrahedra is employed and uniformp=4elements are used throughout. In Fig. 12(a) and (c) we show the quadratic convergence of the Newton–Raphson procedure given in Algorithm 1 to the previously stated criteria and in Fig. 12(b) and (d), the centreline profiles ofvx(0.5,y,0.5)for0⩽y⩽1forHa=10whenHD=(1,0,0)andHD=(0,1,0)are shown. In the latter cases, we also include the corresponding reference solution for the Navier–Stokes lid driven cavity problem withRe=400as a comparison. Illustrations of the computed streamlines for this problem are presented in Fig. 13. Note that, for further increases in Hartmann number, we see an even greater departure of the flow field for the MHD problem from the flow field of the standard lid driven cavity problem [24].The description of this problem can be found in [18,9] and consists of a rectangular duct given byΩ=(0,L)×(-y0,y0)×(-z0,z0)withy0,z0≪L. The source terms aref̃=g=0and the analytical solutions is in the form ofv=v(y,z)00,H=b(y,z)10,p̂=-Gx+p̂0(y,z),r=0.inΩwherev(y,z)=-12Gν-1(z2-z02)+∑n=0+∞vn(y)cos(λnz),b(y,z)=∑n=0+∞bn(y)cos(λnz),p̂0(y,z)=-κb(y,z)22+10,andλn=(2n+1)π2z0,bn(y)=νκAnλn2-p12p1sinh(p1y)+Bnλn2-p22p2sinh(p2y),p1,22=λn2+Ha22±Haλn2+Ha24,An=-p1(λn2-p22)Δnun(y0)sinh(p2y0),Bn=-p2(λn2-p12)Δnun(y0)sinh(p1y0),Δn=p2(λn2-p12)sinh(p1y0)cosh(p2y0)-p1(λn2-p22)sinh(p2y0)cosh(p1y0),vn(y0)=-2Gνλn3z0sin(λnz0),In order to again adapt our framework to the dimensionless Hartmann flow problem, we set the parameters as[μr]=[[I]],κ=ρ,ν=μ̂/ρ=0.1,[[σ̃]]=σ̃[[I]],νm=σ̃-1c/ρ,Ha=κ/ννm. The fluid parameters for the three-dimensional Hartmann flow problem for different Hartmann numbers ofHa=0.01,1,10,1010are shown in Table 5. Then, following the literature [18,9,13], we consider the solution of this problems for the dimensionless quantitiesL=10,y0=2andz0=1. The fluid Neumann boundary∂ΩNFis set as the face(10,y,z),(y,z)∈(-y0,y0)×(-z0,z0)and the fluid Dirichlet boundary∂ΩDFas∂ΩDF=∂Ω⧹∂ΩNFand, for the magnetic field, we set∂ΩDM=∂Ω. IntroducingHD=(0,1,0)the boundary conditions can be summarised asvhp[0]=0on∂ΩDF,thp=([[σF]]+[[σEM]])n=p̂0n+[[σEM]]non∂ΩNF,n×Hhp[0]=n×HDon∂ΩDM.The benchmarking is performed on an unstructured grid of 125 elements by performing uniform p-refinement. By uniformly increasing p until convergence was reached, it was deduced that usingp=6on a mesh of 125 elements can capture the Hartmann flow pattern accurately for the Hartmann number up toHa=10. By applying Algorithm 1 the Newton–Raphson procedure exhibits quadratic convergence similar to that shown in the previous cases, although, for higher Hartmann numbers, the number of iterations required to reach the aforementioned convergence criteria increases.The centreline profiles ofvx(5,y,0)andHx(5,y,0)for-2⩽y⩽2are illustrated in Fig. 14for the Hartmann numbersHa=0.01,1and 10. The comparison between the numerical solutions and the analytical solutions show a good agreement for the presented cases. For higher Hartmann numbers the flow patterns exhibit increasingly sharp gradients in the flow field close to the boundaries and, as discussed in [24] performing p-refinement alone on a coarse mesh of 125 tetrahedra is not sufficient to capture the flow pattern. In this case, h- and p-refinements must be combined.The geometry of the multiphase MHD flow is shown in Fig. 15, which is a rectangular duct given byΩ=(0,L)×(-y0,y0)×(-z0,z0)with dimensionless coordinatesy0=2,z0=1,L=8containing a sphere with radius0.3at the point of(2,0,0). The source terms are such thatf̃=g=0and the fluid Neumann boundary conditionthp=t=[[σEM]]n(free stream velocity) is applied at the face(8,y,z)with(y,z)∈(-y0,y0)×(-z0,z0)and the fluid Dirichlet boundary conditionsvhp[0]=vDwherevD=(0.001(2+y)(2-y),0,0)is a Poiseuille flow distribution in the x-direction. For the magnetic field, the boundary conditionn×Hhp[0]=n×HDis imposed on∂ΩDM=∂ΩwhereHD=(0,H,0). The parameters are taken to be same as those previously provided in Table 5, except that we assign the background fluid such that, in absence of the inclusion, the Hartmann number would beHa=1and in absence of the background the Hartmann number would beHa=1010. We fix the relative permeability of the background fluid to beμrout=1whilst varying the relative permeability of the inner fluid droplet according toμrin=0.01,0.1,1,10, in turn. For both fluids we setμr(1)=μr(2)=0.By uniformly incrementing p on an unstructured grid of 1765 tetrahedral elements it was found that convergence is reached withp=4elements. As in previous cases, the application of Algorithm 2 results in a Newton–Raphson scheme that converges quadratically exhibiting a behaviour similar to that shown in earlier plots. In Fig. 16we also present the centre line profiles forvx(-1.5,y,0),vx(2.5,y,0),Hx(-1.5,y,0)andHx(2.5,y,0), for-2⩽y⩽2, such that they represent the x-components of the flow field and magnetic field just before and just after the inclusion withμrin=0.01,0.1,1,10, in turn. Fig. 16(a) and (b) shows the centreline profiles forvxand Fig. 16(c) and (d) shows the centre line profile forHx. In these plots, the effects of including the sphere droplet and increasing permeability contrast can clearly be observed. Note that despite thatμr(1)=μr(2)=0in both fluids the distribution of[[μr]]is still dependent on the strain rate for this problem.The streamlines, which show the influence of the magnetic fields on the fluid pattern, are shown in Fig. 17for different values ofμrin. From Fig. 17(c), when there is no contrast between the inner and background fluid, the flow pattern tends to that of the prescribed Poiseuille flow. However, with the presence of a permeability contrast, the flow pattern around the droplet is greatly affected by the magnetic field. This simple example illustrates that the gradient of the permeability, which forms an important role in magnetostriction, also plays a major role for the multiphase MHD problem. In order to resolve these complex flow patterns an hp-finite element scheme is essential without it such complex phenomena observed in this simulation cannot be recovered.

@&#CONCLUSIONS@&#
In this paper, we have extended our previous work [25,26] on the numerical simulation of two-dimensional non-conducting magnetostrictive fluids to the simulation of two- and three-dimensional conducting magnetostrictive fluids as well as multi-phase MHD problems. The coupled formulation is implemented in a monolithic manner and solved by means of a Newton–Raphson strategy in conjunction with consistent linearisation. A finite element discretisation employing hp-finite elements conforming to the spacesH(curl),H1andL2has been used leading to a non-trivial implementation. By the application of p-refinement, exponential convergence for problems with smooth benchmark solutions has been obtained, and by combining h- and p-refinements, exponential convergence for benchmark solutions with singularities due to sharp corners and edges has also been demonstrated. We have included further problems that show the predictive capability of the approach and the complex flow patterns that result in the presence of non-homogenous materials and the presence of magnetostrictive effects. Further work will include reducing the computational cost of our approach as well as exploring the role that magnetostriction plays in three dimensional MHD problems in greater detail.