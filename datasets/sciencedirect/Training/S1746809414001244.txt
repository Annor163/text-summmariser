@&#MAIN-TITLE@&#
Evaluation of a posteriori Wiener filtering applied to frequency-following response extraction in the auditory brainstem

@&#HIGHLIGHTS@&#
A posterior Wiener filtering was applied to the FFR extraction, as well as sub-band optimal weighted averaging and Median averaging method.Wiener achieved the best performance in improving FFR quality and experiment efficiency, thus it is the most suitable method for FFR preprocessing.Comprehensive and quantitative quality indices were described to evaluate FFR qualities.

@&#KEYPHRASES@&#
Frequency following response (FFR),A posteriori Wiener filtering (APWF),Preprocessing methods,Sweep number,Quality indices,

@&#ABSTRACT@&#
The main goal of the present study was to determine the best preprocessing method for extracting the frequency-following response (FFR) in the auditory brainstem. The a posteriori Wiener filtering (APWF) method was first applied in FFR preprocessing and then compared with the standard method of conventional averaging with artifact rejection (MeanAR). Two other methods, sub-band optimal weighted averaging (SubBand) and median averaging (Median), were also investigated. FFRs were recorded from 10 normal-hearing subjects. A harmonic complex tone with a missing fundamental frequency was used as the sound stimulus. Comprehensive and quantitative indices were constructed to evaluate the quality of FFRs processed by the four methods. The indices in the time domain included the root mean square (RMS) of the residual background noise, RMS of the FFR, and autocorrelation function, and the indices in the frequency domain included the signal-to-noise ratios (SNRs) of the harmonics. The results revealed that the APWF method achieved the best performance in FFR extraction. Additionally, the effect of sweep number on FFR quality was studied. Paired t-tests indicated that APWF required far fewer sweeps compared with other methods in obtaining equivalent high-quality FFRs. In conclusion, APWF is a more suitable method for FFR preprocessing than the existing methods because of its advantages in improving SNR and experiment efficiency.

@&#INTRODUCTION@&#
The frequency-following response (FFR), recorded from the scalp, is a sustained response from brainstem neurons that is evoked by periodic sound stimuli. Based on the temporal patterns of phase-locked neural activities, the FFR reflects the spectral and temporal characteristics of the stimulus with remarkable fidelity, but the upper limit of FFR phase-locking is lower than 2000Hz [1,2]. Specifically, the FFR has been used to measure neural phase-locking to the fundamental frequency (F0) and the phase-locking activities at the harmonic frequencies or distortion product frequencies [3–10]. Recent studies have also examined the relationship between subcortical neural representations by the FFR and behavioral perception abilities [11–20]. Therefore, the FFR has been widely accepted as a useful, objective and noninvasive paradigm for studying signal processing mechanisms at the auditory brainstem level.The challenge of FFR extraction is its relatively low signal-to-noise ratio (SNR). FFR amplitude is usually on the order of hundreds of nanovolts (nV), whereas the background noise (physiological and non-physiological) is much larger, in the range of 10–20microvolts (μV) [1,5,21–23]. Extracting the FFR with relatively high quality is important for further FFR analyses, particularly for FFR phase-locking to each frequency component. Techniques have been developed to minimize the effects of acquisition artifacts such as shielded sound booths, shielded tube-insert earphones and keeping subjects relaxed and still [24–26]. As for signal processing, conventional arithmetic averaging and filtering have been most popular in improving the SNR of the FFR [22,24]. Generally, FFR preprocessing includes three main steps: band-pass filtering, artifact rejection and conventional averaging [3–5,22,24,27]. Raw FFR data are usually first band-pass filtered, e.g., from 30 to 3000Hz, to reduce wide-band noise. Next, sweeps with amplitudes greater than a given threshold are considered artifacts and rejected (i.e., artifact rejection) [3,4,24,27,28]. The final response is calculated as the mean of the remaining filtered sweeps. If stimuli with alternating polarity are used, the responses to alternating polarities are either added or subtracted. The addition of responses to alternating polarities enhances the components related to the stimulus envelope and minimizes both the stimulus artifact and the cochlear microphonic [9,25,29], whereas the subtraction of such responses enhances the components phase-locked to temporal fine structure and minimizes the envelope-related activity [3,4,9,29]. However, there are still some limitations to the common processing steps. The classical filter is not effective when the noise spectrum overlaps with the signal spectrum [30–32]. In addition, the effectiveness of artifact rejection is limited for the requirement of a pre-determined rejection threshold [31,33]. These problems have been widely discussed in the literature for evoked potential (EP) research [31–34], but few studies exist on preprocessing methods for the FFR [35]. Therefore, it is necessary and meaningful to conduct more research on FFR preprocessing methods that extract the FFR with optimal SNR.This study aimed to find an FFR preprocessing method that would be effective when the noise spectrum overlaps with the signal spectrum and could suppress the effects of artifacts without data rejection. A posteriori Wiener filtering (APWF) was considered the first choice for several reasons. First, APWF is a biased estimator and weighs the spectral components according to the SNRs at individual frequencies. The spectral components without noise power are entirely preserved, whereas the spectral components without signal power are entirely suppressed. Based on a posteriori-estimated power density spectra of signal and noise, the averaged response, which is noise-contaminated, can be improved by APWF. Particularly in the case of spectral overlap between noise and signal, APWF can reduce the effects of the noise by attenuating each noisy frequency component in proportion to an SNR estimate [36]. Second, the application of APWF is restricted to deterministic responses with time-invariant power distributions, contaminated with uncorrelated stationary noise [37–39]. In a simulation study, APWF performed well for steady-state signals such as sine waves [40]. APWF was assumed to be suitable for FFR preprocessing because the FFR reflects stationary phase-locked responses to periodic components of sound stimuli. Artifacts that are mainly caused by motion are highly non-stationary with varied spectra and can therefore be suppressed by APWF.In previous work, we aimed to establish our own FFR recording system, and we found that APWF could improve the FFR's SNR in the time domain [41]. In this study, we further justified APWF's suitability for FFR pre-processing. We evaluated the applicability of APWF in extracting the FFR in three steps. First, APWF was compared with the standard method, i.e., conventional mean averaging with artifact rejection (abbreviated as MeanAR hereinafter). APWF was expected to improve SNRs for all harmonic frequencies of FFR, which would be helpful for spectral analysis and would not require an artifact rejection step. Second, APWF was compared with two other methods, i.e., sub-band optimal weighted averaging (SubBand) and median averaging (Median), which were applied to FFR preprocessing for the first time. The SubBand method is a variation on Hoke weighted averaging [42–45]. The sweeps’ spectra were split into several sub-bands, and weighted averages were calculated for individual sub-bands and then summed. SubBand was selected for its utility in dealing with individual harmonic partials. The Median method finds the middle value for each time point across all sweeps. The Median method reduces the effect of extreme data values [33]. APWF was compared with SubBand and Median to further investigate whether APWF had an advantage in extracting FFR phase-locking of individual harmonic frequencies and in suppressing artifact effects. Third, to objectively evaluate the quality of FFR, comprehensive quantitative indices were constructed. For an analysis in the frequency domain, the SNR of each harmonic was able to evaluate FFR's phase-locking of individual harmonic frequencies. The SNR calculated by the root mean square (RMS) in the time domain was a general index for evaluating the overall FFR amplitude relative to the residual background noise amplitude. Autocorrelation function (ACF) analysis was performed to focus on FFR phase-locking to F0, with robustness evaluated using the highest ACF peak amplitude. The ratio of the ACF peak's height to half-height–width was also calculated to represent how many harmonic components were contained in the FFR. The indices were used not only to compare different methods but also to evaluate the effect of sweep number on FFR quality.Signal averaging is one of the most effective approaches to improve the SNR of a recording. Averaging methods take advantage of the time-locked feature between the stimulus onset and the sweep onset. Conventional mean averaging is most commonly used in clinics and research laboratories. It assumes that a single recorded sweep is the addition of a determinate signal (constant and phase-locked to stimulus) and a stationary randomly occurring noise. There is no correlation between the signal and the random noise and no correlation between the noises of different sweeps. The recording sweeps are summed and divided by the number of sweeps K to obtain the mean average, and amplitude-based SNR is proportional to the square root of K[22,30]. The mean averaged time-domain responseX¯(t)is taken as the estimationsˆ(t)of the signal; these functions are defined as(1)xk(t)=s(t)+BNk(t)(2)sˆ(t)=X¯(t)=1K∑k=1Kxk(t)=s(t)+1K∑k=1KBNk(t),k=1,2,…,Kwhere s(t) and BNk(t) are the signal and background noise components of the kth sweep xk(t), respectively.There are some inherent problems with mean averaging. In the real world, noise is usually not a stationary random process. For example, if subjects move after being stationary, the noise level changes. Limitations of mean averaging have been recognized, and numerous attempts have made to overcome them, resulting in different averaging methods [32,46]. Some of these methods (i.e., MeanAR, APWF, Median and SubBand) were applied in this study.Sweeps with artifacts were detected and eliminated. Then, the remaining sweeps were averaged using the conventional mean averaging method. In this study, a sweep was rejected if it contained voltages greater than ±30μV.Wiener filtering was proposed in the 1970s to reduce the effects of non-stationary noise. Later, APWF was introduced for averaged evoked potentials [36–39]. APWF was inspired by the Wiener theory, which assumes that the signal and noise are additive and uncorrelated and that both are stochastic and stationary processes with a priori knowledge of power density spectra [38,39]. APWF weighs the spectral components in the signal according to the power density SNR at individual frequencies with no phase distortion. Generally, it is a biased estimator that reduces the variance in the signal at the cost of a systematic reduction in the amplitude of signal components. An optimal estimate of the signal component is obtained by passing the averaged responseX¯(t)through a filter with the transfer function H(ω). Specific computation procedures were completed as follows.First, the power density spectrum Pk(ω) was computed for each sweep xk(t), and then all of the power spectra were averaged to calculateP¯x(ω),as in Eq. (3).Second, the power density spectrum for the average responseX¯(t)was calculated and represented asPX¯(ω).Because the noise at different sweeps was assumed to be uncorrelated (see Eq. (2)),PX¯(ω)was expressed as in Eq. (4).(3)P¯x(ω)=1K∑k=1KPk(ω)=Ps(ω)+Pn(ω)(4)PX¯(ω)=Ps(ω)+1KPn(ω)Ps(ω) and Pn(ω) are the power spectra of the signal and noise components.Third, the transfer function H(ω) of the theoretical APWF is given in Eq. (5). From Eqs. (3) and (4), H(ω) can be expressed in terms ofP¯x(ω)andPX¯(ω).(5)H(ω)=Ps(ω)Ps(ω)+1KPn(ω)=KK−11−1KP¯x(ω)Px¯(ω)Finally, the estimation of the signal was obtained as follows:(6)sˆ(t)=X¯(t)*h(t)where h(t) is the impulse response of the filter H(ω) and the asterisk ‘*’ means convolution.Median averaging is also used for reducing the sensitivity of conventional mean averaging to noise fluctuations, especially when there are large artifacts. It is more reliable than mean averaging for a small number of recording sweeps with high SNRs. Computationally, for each time t, the values of all the K sweeps at t are sorted and the median value is found. If K is even, median is defined as the mean of the two values in the middle. There is high-frequency noise superimposed on median averaging, which can be easily filtered out with a mean filter [33].Weighted averaging is thought to reduce the high sensitivity of conventional mean averaging to noise. Each sweep to be averaged is weighted with respect to some criterion that indicates the amount of noise in that sweep. Generally, weighted averaging uses the inverse variance of noise as the weight. For responses with a low SNR (e.g., less than −20dB), the variance of a single sweep is taken as the variance of the background noise [43–45]. Because noise has a time-varying spectral distribution, a sub-band optimal weighted averaging was proposed. Each recording sweep's spectrum is split into several frequency bands through a group of band-pass filters, the summation of which forms an all-pass filter with a zero-phase delay. The weighting factor is determined for each frequency band, which leads to an optimal weighted average for each frequency component. The final frequency band optimal weighted average is obtained by summing the weighted averages of all sub-bands [42].(7)ykj(t)=xk(t)*hj(t)=sj(t)+BNkj(t),j=1,2,…,Jwhere hj(t) is the impulse response of the jth filter and ykj(t) is the jth sub-band signal of the kth sweep. The weighted average is calculated for each sub-band across all sweeps as follows:(8)y¯j(t)=1∑k=1K1/σkj2∑k=1Kykj(t)σkj2,k=1,2,…,KFinally, the summation of all of the sub-band weighted averages is considered the estimation of the signal.(9)sˆ(k)=∑j=1Jy¯j(t),j=1,2,…,JTo ensure that the signal is not distorted, the sum of the filters constitutes an all-pass filter with a zero phase.(10)h(t)=∑j=1Jhj(t)=δ(t)In this study, each sweep spectrum was split into 12 frequency bands centered at each harmonic. In the case of FFR recordings, which are dominated by low-frequency components, common weighted averaging calculates the weight based on the whole noise, which in turn is primarily composed of low frequencies. Compared with common weighted averaging, sub-band optimal weighted averaging calculates the weight based on the noise of each frequency band, thereby achieving an optimal average for each individual harmonic frequency component of the FFR. It should be noted that the SubBand method was the most complex and time-consuming of the four methods.

@&#CONCLUSIONS@&#
