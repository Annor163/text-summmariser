@&#MAIN-TITLE@&#
Object detection, shape recovery, and 3D modelling by depth-encoded hough voting

@&#HIGHLIGHTS@&#
We propose a novel method to jointly detect objects, infer their categories, and estimate their poses.When the model is trained with depth information, object depths can be decoded from a single image.Finally, we obtain a convincing 3D shape reconstruction of the object from a novel 3D modeling stage.

@&#KEYPHRASES@&#
Object recognition,Object detection,Viewpoint estimation,Shape recovery,3D reconstruction,Shape completion,Texture completion,

@&#ABSTRACT@&#
Detecting objects, estimating their pose, and recovering their 3D shape are critical problems in many vision and robotics applications. This paper addresses the above needs using a two stages approach. In the first stage, we propose a new method called DEHV – Depth-Encoded Hough Voting. DEHV jointly detects objects, infers their categories, estimates their pose, and infers/decodes objects depth maps from either a single image (when no depth maps are available in testing) or a single image augmented with depth map (when this is available in testing). Inspired by the Hough voting scheme introduced in [1], DEHV incorporates depth information into the process of learning distributions of image features (patches) representing an object category. DEHV takes advantage of the interplay between the scale of each object patch in the image and its distance (depth) from the corresponding physical patch attached to the 3D object. Once the depth map is given, a full reconstruction is achieved in a second (3D modelling) stage, where modified or state-of-the-art 3D shape and texture completion techniques are used to recover the complete 3D model. Extensive quantitative and qualitative experimental analysis on existing datasets [2–4] and a newly proposed 3D table-top object category dataset shows that our DEHV scheme obtains competitive detection and pose estimation results. Finally, the quality of 3D modelling in terms of both shape completion and texture completion is evaluated on a 3D modelling dataset containing both in-door and out-door object categories. We demonstrate that our overall algorithm can obtain convincing 3D shape reconstruction from just one single uncalibrated image.

@&#INTRODUCTION@&#
Detecting objects and estimating their geometric properties are crucial problems in many application domains such as robotics, autonomous navigation, high-level visual scene understanding, surveillance, gaming, object modelling, and augmented reality. For instance, if one wants to design a robotic system for grasping and manipulating objects, it is of paramount importance to encode the ability to accurately estimate object orientation (pose) from the camera view point as well as recover structural properties such as its 3D shape. This information will help the robotic arm grasp the object at the right location and successfully interact with it. Moreover, if one wants to augment the observation of an environment with virtual objects, the ability to reconstruct visually pleasing 3D models for object categories is very important.This paper addresses the above needs, and tackles the following challenges: (i) Learn models of object categories by combining view specific depth maps along with the associated 2D image of object instances of the same class from different vantage points. Depth maps with registered RGB images can be easily collected using sensors such as Kinect Sensor [5]. We demonstrate that combining imagery with 3D information helps build richer models of object categories that can in turn make detection and pose estimation more accurate. (ii) Design a coherent and principled scheme for detecting objects and estimating their pose from either just a single image (when no depth maps are available in testing) (Fig. 1b), or a single image augmented with depth maps (when these are available in testing). In the latter case, 3D information can be conveniently used by the detection scheme to make detection and pose estimation more robust than in the single image case. (iii) Have our detection scheme reconstruct the 3D model of the object from just a single uncalibrated image (when no 3D depth maps are available in testing) (Fig. 1c–g) and without having seen the object instance during training.In this paper, we propose a two stages approach to address the above challenges (Fig. 2). In the first stage, our approach seeks to (i) detect the object in the image, (ii) estimate its pose, and (iii) recover a rough estimate of the object 3D structure (if no depth maps are available in testing). This is achieved by introducing a new formulation of the Implicit Shape Model (ISM) [1] and generalized Hough voting scheme [7]. In our formulation, depth information is incorporated into the process of learning distributions of object image patches that are compatible with the underlying object location (shape) in the image plane. We call our scheme DEHV – Depth-Encoded Hough Voting scheme (Section 3.1). DEHV addresses the intrinsic weaknesses of existing Hough voting schemes [1,8–10] where errors in estimating the scale of each image object patch directly affects the ability of the algorithm to cast consistent votes for the object existence. To resolve this ambiguity, we take advantage of the interplay between the scale of each object patch in the image and its distance (depth) from the corresponding physical patch attached to the 3D object, and specifically use the fact that objects (or object parts) that are closer to the camera result in image patches with larger scales. Depth is encoded in training by using available depth maps of the object from a number of view points. At recognition time, DEHV is applied to detect objects (Fig. 1b), estimate their pose, and simultaneously infer their 3D structure given hypotheses of detected objects (Fig. 1c). The object 3D structure is inferred at recognition time by estimating (decoding) the depth (distance) of each image patch involved in the voting from the camera center. Critically, depth decoding can be achieved even if just a single test image is provided. If depth maps are available in testing, the additional information can be used to further validate if a given detection hypothesis is correct or not. We summarize the inferred quantities in Fig. 3and the required supervision in Fig. 4. Notice that the inferred object 3D structure from stage one is partial (it does not account for the portions of the object that are not visible from the query image) and sparse (it only recovers depth for each voting patch). The goal of the second stage is to obtain a full 3D object model where both 3D structure and albedo properties (texture) are also recovered.In the second stage, the information inferred from stage one (object location in the image, scale, pose, and rough 3D structure) is used to obtain a full 3D model of the object. Specifically, we consider a 3D modelling stage where a full 3D model of the object is obtained by 3D shape recovery and texture completion (Section 3.2). We carry out 3D shape recovery (i.e., infer shape from the unseen regions) by: (i) utilizing 3D shape exemplars from a database of 3D CAD models which can be collected from [11] and other online 3D warehouses, or obtained by shape from silhouette [12] and (ii) applying a novel 2D+3D iterative closest point (ICP) matching algorithm which jointly registers the best 3D CAD model to the inferred 3D shape and the occlusion boundaries of back projected 3D CAD model to object contours in the image. By choosing the best fit, our system obtains a plausible full reconstruction of the object 3D shape (Section 3.3) (Fig. 1d). Object appearance is rendered by texture mapping the object image into the 3D shape. Such texture is clearly incomplete as non-visible object surface areas cannot be texture mapped (Fig. 1e). Thus, we perform texture completion by: (i) transferring texture to such non-visible object surface areas by taking advantage of the fact that some object categories are symmetric (when possible) (Fig. 1f) and (ii) using an error-tolerant image compositing technique inspired by [6] to fill the un-textured regions (i.e., holes) (Section 3.4) (Fig. 1g). We summarize the required supervision in Fig. 4.Extensive experimental analysis on a number of public datasets (including car Pascal VOC07 [2], mug ETHZ Shape [3], mouse and stapler 3D object dataset [13]), an two in-house datasets (comprising at most five object categories), where ground truth 3D information is available, are used to validate our claims (Section 4). Experiments with the in-house datasets demonstrate that our DEHV scheme: (i) achieves better detection rates (compared to the traditional Hough voting scheme); further improvement is observed when depth maps are available in testing; (ii) produces convincing 3D reconstructions from single images; the accuracy of such reconstructions have been qualitatively assessed with respect to ground truth depth maps; (iii) achieves accurate 3D shape recovery and visually pleasing texture completion results. Experiments with public datasets demonstrate that our DEHV successfully scales to different types of categories and works in challenging conditions (severe background clutter, occlusions). DEHV achieves state of the art detection results on several categories in ETHZ Shape dataset [3], and competitive pose estimation results on 3D object dataset [13]. We also evaluate the accuracy of shape completion and quality of the texture completion on the 3D modelling dataset (Section 3.2). Finally, we show typical results demonstrating that DEHV is capable to produce convincing 3D reconstructions from single uncalibrated images using Pascal VOC07 dataset [2], ETHZ Shape dataset [3], and 3D object dataset [13] in Figs. 19 and 15.In the last decade, the vision community has made substantial progress addressing the problem of object categorization from 2D images. While most of the work has focussed on representing objects as 2D models [14,1,15] or collections of 2D models [16], very few methods have tried to combine in a principled way the appearance information that is captured by images and the intrinsic 3D structure of an object category. Works by [17,13,4] have proposed solutions for modelling the way how 2D local object features (or parts) and their relationship vary in the image as the camera view point changes. Other works [18–21] propose hybrid representations where reconstructed 3D object models are augmented with features or parts capturing diagnostic appearance. Interestingly, few of these methods [22,21,23] have demonstrated and evaluated the ability to recover 3D shape information from a single query image. The work by [22] is the closest to ours in spirit. Authors in [22] propose to use image patches to transfer metadata (i.e., depth). Unlike our method, 3D information is not directly encoded into the model during training. Other works propose to address the problem of detecting and estimating geometrical properties of single object instances [24–27]; while accurate pose estimation and 3D object reconstruction are demonstrated, these methods cannot be easily extended to incorporate intra-class variability so as to detect and reconstruct object categories. Unlike our work, these techniques also require that the objects have sufficient “texture” on their surface to carry out successful geometric registration. Other approaches assume that additional information about the object is available in both training and testing (videos, 3D range data) [28,29]. These approaches tend to achieve high detection accuracy and pose estimation relying on more expensive hardware platforms, and fail when the additional 3D data is either partially or completely unavailable. A comprehensive survey of 3D object detection method is presented in [30].Research on 3D object and scene modelling from images has received a large amount of attention in the graphics and vision community. Such approaches are often referred to as image-based modelling techniques (IBM). Starting from early work by [31,32], IBM techniques have been recently employed for successfully modelling large scale environments such as city environments from large collection of images on the internet [33,34]. IBM techniques often require different degrees of human intervention [31] or the assumptions that special equipments are available and/or cameras are calibrated [35,36].Even if outstanding results have been produced, many of these methods make the basic assumption that several images (portraying the object in the scene from different view points) are available. However, this is not always the case. Recovering scene geometry from a single view has been initially explored under the assumption of having users guiding the reconstruction [37,38] or augmenting the photograph with additional 3D data [39]. Recently, researchers have proposed to apply machine learning methodologies for resolving the 3D-2D mapping ambiguity and obtaining convincing reconstructions of outdoor [40,41] and indoor scenes [42–45] from just one single image.Alternative techniques have been proposed for modelling specific 3D objects (rather than scenes or environments). Again, depending on the application and the level of accuracy that one aims to achieve, researchers have proposed methods employing either external lighting sources such as lamps [46,47], projectors [48], lasers [49], or a number of calibrated [50] or uncalibrated views obtained using external devices such as turntables [51]. A recent survey nicely summarizes most relevant works [52] from an almost endless literature on this topic. Recently, Prasad et al. [53] have proposed a method to reconstruct deformable object classes from multiple and unordered images. Due to the absence of reliable point correspondences across deformable object instances, class-specific curve correspondences need to be manually selected.The reconstruction of an underlying 3D shape model is not always a necessary step if one wants to render the environment appearance from just images. These methods fall under the name of image based rendering approaches (IBR). Works by [54–57] are among the most notable examples. The lack of the underlying 3D shape model, however, makes it harder for these techniques to be used in applications where virtual worlds are to be augmented with the reconstructed models.As opposed to indoor or outdoor scenes where cues such as vanishing lines or texture foreshortening are available, fewer methods have been proposed for recovering 3D models of objects from a single image. Researchers mostly focused on recovering 3D shape models from object contours (silhouettes) extracted or identified on a single image either automatically [58,59] or through some level of user intervention [60–62]. These methods, however, often assume topological properties of objects such as smoothness, convexity, or cylindrical symmetry or heavily relies on user intervention. In our work, we do not want our query objects to be subject to these constraints. Rather, similar to [40,41], we advocate the usage of machine learning for solving the daunting task of single view object reconstruction with arbitrary topology and minimal user intervention. Very recently, [63,64,21,23] have shown the ability to reconstruct sparse/partial 3D object points from a single image. However, none of these methods have been extensively tested so as to demonstrate that realistic 3D models of objects can be obtained.To summarize, our method can be roughly decomposed in a recognition/reconstruction stage and a 3D modelling stage.In the recognition/reconstruction stage, Depth-Encoded-Hough-Voting detectors (DEHV) [64], trained with both object 3D shape and local diagnostic appearance information, identifies object’ locations and classes, and recovers approximate and partial 3D structure information from a single query image (Section 3.1) (Fig. 1(a-c)).Because we obtain only a partial reconstruction (object surface that is not visible from the query image cannot be reconstructed at this stage). Thus, we consider a 3D modelling stage where a full 3D model of the object is obtained by 3D shape recovery and texture completion (Section 3.2) (Fig. 1d–g).In recognition techniques based on hough voting [7] the main idea is to represented the object as a collection of parts (patches) and have each part to cast votes in a discrete voting-space. Each vote corresponds to a hypothesis of object location x and class O. The object is identified by the conglomeration of votes in the voting space V(O,x). V(O,x) is typically defined as the sum of independent votes p(O,x,fj,sj,lj) from each part j, where ljis the location of the part, sjis the scale of the part, and fjis the part appearance.Previously proposed methods [1,8–10] differ mainly by the mechanism for selecting good parts. For example, parts may be either selected by an interest point detector [1,9], or densely sampled across many scales and locations [8]; and the quality of the part can be learned by estimating the probability [1] that the part is good or discriminatively trained using different types of classifiers [9,8]. In this paper, we propose a novel method that uses 3D depth information to guide the part selection process. As a result, our constructed voting space V(O,x∣D), which accumulates votes for different object classes O at location x, depends on the corresponding depth information D of the image. Intuitively, any part that is selected at a wrong scale can be pruned out by using depth information. This allows us to select parts which are consistent with the object physical scale. It is clear that depending on whether object is closer or further, or depending on the actual 3D object shape, the way how each patch votes will change (Fig. 5).In detail, we define V(O,x∣D) as the sum of individual probabilities over all observed images patches at location ljand for all possible scales sj, i.e,(1)V(O,x|D)=∑j∫p(O,x,fj,sj,lj|dj)dsj=∑j∫p(O,x|fj,sj,lj,dj)p(fj|sj,lj,dj)p(sj|lj,dj)P(lj|dj)dsjwhere the summation over j aggregates the evidence from individual patch location, and the integral over sjmarginalizes out the uncertainty in scale for each image patch. Since fjis calculated deterministically from observation at location ljwith scale sj, and we assume p(lj∣dj) is uniformly distributed given depth, we obtain:(2)V(O,x|D)∝∑j∫p(O,x|fj,sj,lj,dj)p(sj|lj.dj)dsj=∑j,i∫p(O,x|Ci,sj,lj,dj)p(Ci|fj)p(sj|lj,dj)dsjHere we introduce codebook entry Cj, matched by feature fj, into the framework, so that the quality of a patch selected will be related to which codeword it is matched to. Noting that Cjis calculated only using fjand not the location lj, scale sj, and depth dj, we simplify p(Cj∣fj, sj, lj, dj) into p(Cj∣fj). And by assuming that p(O,x∣.) does not depend on fjgiven Cj, we simplify p(O,x∣Cj,fj,sj,lj,dj) into p(O,x∣Cj,sj,lj,dj).Finally, we decompose p(O,x∣.) into p(O∣.) and p(x∣.) as follows:(3)V(O,x|D)∝∑j,i∫p(x|O,Ci,sj,lj,dj)p(O|Ci,sj,lj,dj)p(Ci|fj)p(sj|lj,dj)dsjWe design our method so as to specifically selects image patches that tightly enclose a sphere with a fix radius r in 3D during training. As a result, our model enforces a 1-to-1 mapping m between scale s and depth d. This way, given the 3D information, our method deterministically select the scale of the patch at each location l, and given the selected patches, our method can infer the underlying 3D information (Fig. 6). In detail, given the camera focal length t, the corresponding scale s at location l=(u,v) can be computed as s=m(d,l) and the depth d can be inferred from d=m−1(s,l). The mapping m obeys the following relations:(4)s=2(v¯-v);v¯=tan(θ+ϕ)tθ=arcsinrdyz;ϕ=arctanvtdyz=dt2+v2u2+v2+t2:dprojectedontoyzplaneHence, p(s∣l,d)=δ(s−m(d,l)). Moreover, using the fact that there is a 1-to-1 mapping between s and d, probabilities p(x∣.) and p(O∣.) are independent to d given s. As a result, only scale s is directly influenced by depth.In the case when depth is unknown, p(s∣l,d) becomes a uniform distribution over all possible scales. Our model needs to search through the scale space to find patches with correct scales. This will be used to detect the object and simultaneously infer the depth d=m−1(s,l). Hence, the underlying 3D shape of the object will be recovered.In order to utilize dense depth map or infer dense reconstruction of an object, we use random forest to efficiently map features f into codeword C (similar to [8]) so that we can evaluate patches densely distributed over the object. Moreover, random forest is discriminatively trained to select salient parts. Since feature f deterministically maps to Cigiven the ithrandom tree, the voting score V(O,x∣D) becomes:(5)V(O,x|D)∝∑j,i∫p(x|O,Ci(fj),sj,lj)p(O|Ci(fj))p(sj|lj,dj)dsjwhere the summation over i aggregates the discriminative strength of different trees. In Section 3.1.3, we describe how the distributions of p(x∣O,Ci(fj),sj,lj) and p(O∣Ci(fj)) are learned given training data, so that each patch j knows where to vast votes during recognition.We assume that for a number of training object instances, the 3D reconstruction D of the object is available. This corresponds to having available the distance (depth) of each image object patch from its physical location in 3D. Our goal is to learn the distributions of location p(x∣.) and object class p(O∣.), and the mapping of Ci(f). Here we define location x of an object as a bounding box with center position q, height h, and aspect ratio a. We sample each image patch centered at location l and select the scale s=m(l,d). Then the feature f is extracted from the patch (l,s). When the image patch comes from a foreground object, we cache: (1) the information of the relative voting direction b asq-ls; (2) the relative object-height/patch-scale ratio w ashs; (3) the object aspect ratio a. Then, we use both the foreground patches (positive examples) and background patches (negative examples) to train a random forest to obtain the mapping Ci(f). p(O∣C) is estimated by counting the frequency that patches of O falls in the codebook entry C. p(x∣O,C,s,l) can be evaluated given the cached information {v,w,a} as follows:p(x|O,C,s,l)∝∑j∈g(O,C)δ(q-bj·s+l,h-wj·s,a-aj)where g(O,C) is a set of patches from O mapped to codebook entry C.It is straightforward to use the model when 3D information is observed during recognition. Since the uncertainty of scale is removed, Eq. (5) becomesV(O,x|D)∝∑j,ip(x|O,Ci(fj),m(lj,dj),lj)p(O|Ci(fj))Since sj=m(lj,dj) is a single value at each location j, the system can detect objects more efficiently by computing less features and counting less votes. Moreover, patches selected using local appearance at a wrong scale can be pruned out to reduce hallucination of objects (Fig. 5).When no 3D information is available during recognition, p(sj∣lj,dj) becomes a uniform distribution over the entire scale space. Since there is no closed form solution of integral over sj, we propose to discretize the space into a finite number of scales S so that Eq. (5) can be approximated byV(O,x|D)∝∑j,i∑sj∈Sp(x|O,Ci(fj),sj,lj)p(O|Ci(fj)).Once we obtain a detection hypothesis (x,O) (green box in Fig. 7a) corresponding to a peak in the voting space V, the patches that have cast votes for a given hypothesis can be identified (red cross in Fig. 7a). Since the depth information is encoded by the scale s and position l of each image patch, we apply Eq. (4) in a reverse fashion to infer/decode depths from scales. The reconstruction, however, is affected by a number of issues: (i) Quantization error: The fact that scale space is discretized into a finite set of scales, implies that the depths d that we obtained are also discretized. As a result, we observe the reconstructed point clouds as slices of the true object (see Fig. 7b). We propose to use the height of the object hypothesis h and the specific object-height/patch-scale ratio w to recover the continuous scalesˆ=h/w. Notice that since w is not discretized,sˆis also not discretized. Hence, we recover the reconstruction of an object as a continuum of 3D points (see Fig. 7c). (ii) Phantom objects: The strength and robustness of our voting-based method comes from the ability to aggregate pieces of information from different training instances. As a result, the reconstruction may contain multiple phantom objects since image patches could resemble those coming from different training instances with slightly different intrinsic scales. Notice that the phantom objects phenomenon reflects the uncertainty of the scale of the object in an object categorical model. In order to construct a unique shape of the detected object instance, we calculate the relative object height in 3D with respect to a selected reference instance to normalize the inferred depth. Using this method, we infer a unique 3D structure of the visible surface of the detected object.

@&#CONCLUSIONS@&#
