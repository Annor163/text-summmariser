@&#MAIN-TITLE@&#
Adaptive Kalman snake for semi-autonomous 3D vessel tracking

@&#HIGHLIGHTS@&#
We propose 3D vessel segmentation and tracking algorithm based on an active contour model and a Kalman filter.To obtain refined segmentation results, we model an adaptive control spacing algorithm for the active contour model.To obtain refined tracking results, we model an initial contour estimation algorithm for the Kalman filter.ROC analyses demonstrated the time efficiency and tracking robustness of the proposed model.Processing time can be effectively reduced by approximately 20%.

@&#KEYPHRASES@&#
Vessel tracking,Active contour,Snake,Kalman filter,Initial contour estimation,Adaptive control points spacing,

@&#ABSTRACT@&#
In this paper, we propose a robust semi-autonomous algorithm for 3D vessel segmentation and tracking based on an active contour model and a Kalman filter. For each computed tomography angiography (CTA) slice, we use the active contour model to segment the vessel boundary and the Kalman filter to track position and shape variations of the vessel boundary between slices. For successful segmentation via active contour, we select an adequate number of initial points from the contour of the first slice. The points are set manually by user input for the first slice. For the remaining slices, the initial contour position is estimated autonomously based on segmentation results of the previous slice. To obtain refined segmentation results, an adaptive control spacing algorithm is introduced into the active contour model. Moreover, a block search-based initial contour estimation procedure is proposed to ensure that the initial contour of each slice can be near the vessel boundary. Experiments were performed on synthetic and real chest CTA images. Compared with the well-known Chan-Vese (CV) model, the proposed algorithm exhibited better performance in segmentation and tracking. In particular, receiver operating characteristic analysis on the synthetic and real CTA images demonstrated the time efficiency and tracking robustness of the proposed model. In terms of computational time redundancy, processing time can be effectively reduced by approximately 20%.

@&#INTRODUCTION@&#
Rapid developments in image processing technologies, including image segmentation, tissue characterization, and image registration, are facilitating a common platform for medical image processing. Several vessel tracking methods for different human organs based on image processing algorithms have been proposed for this common platform. However, the amount of data that needs to be manipulated is growing exponentially as a result of advances in image acquisition technologies as well as clinical requirements. In addition, the expectations for diagnostic accuracy are higher, in line with the large number of applications that utilize processed images. Robust, precise, and reproducible image processing algorithms are therefore essential [1]. To overcome these challenges, many image processing techniques have been developed. However, no single image processing technique works for all applications, and thus different approaches with varying accuracy, speed, and degrees of complexity have been explored for each practical problem [2].In this paper we present a semi-autonomous blood vessel tracking algorithm. Given a medical volume data set composed of computed tomography angiography (CTA) slices, the algorithm requires the user's initial input (positioning of control points) for the first slice and then autonomously tracks blood vessels slice by slice (SBS). As shown in Fig. 1(a), a user inputs several control points surrounding the target vessel on the first CTA slice. The points are then moved to segment the vessel boundary using an active contour model, termed ‘snake’. These successive control points become seed points to estimate the initial control points of the next slice. In this way, the initial control points for subsequent slices are autonomously found, and segmentation and tracking (SNT) are performed. For this semi-autonomous temporal tracing, it is necessary to resolve two predictions, termed inter- and intra-predictions, which are illustrated in Fig. 1(b). The former determines the initial control points of the vessel in each slice for segmentation by considering the translation and size variation. Once the boundary has been determined in the previous slice, inter-slice prediction temporally tracks the vessel boundary on a slice-by-slice basis. For intra-slice prediction, it is important to segment irregular vessel boundary shapes correctly within the slice.Various SNT methods have been developed to resolve the two slice predictions described above. In conventional research, two types of vessel segmentation approaches are used: a model-based approach ([3–5]) and a tracking-based approach ([6,7]). In the model-based approach, segmentation is achieved using prior information regarding elongation, hyper-intensity, or statistical distribution to extract blood vessels [8]. In [9] a gray level distribution for magnetic resonance angiography was approximated to extract the 3D cerebrovascular system. An automated septum thickness measurement method based on a deformable model of the septum and mitral valve was proposed by Snare et al. [10]. Delibasis et al. [11] presented an automatic model-based tracing algorithm for vessel segmentation and diameter estimation. The algorithm utilizes a parametric model of a vessel composed of a stripe, which exploits geometric properties for parameter definitions.The model-based approach is very effective at tracking an object even if there are slight deformations or variations in translation, rotation, or magnification, as opposed to radical structural deformations. One of the most representative model-based approaches is an active contour algorithm that creates a contour from the initial contour input by the user while deforming the shape. This algorithm has demonstrated good performance in two-dimensional (2D) object segmentation. However, this algorithm has limited applicability to vessel segmentation in three dimensions due to ambiguity of the depth information. In other words, if snake is applied solely to track the vessel boundary, it is difficult to predict drastic changes in the shape of the boundary between slices. Moreover, it is challenging to set an initial contour manually for each slice over three-dimensional (3D) space, and it is not easy to calculate concavity in the process of contour evolution.The tracking-based approach segments and tracks each vessel by applying a local operator around the vessel. It detects the centerline or boundary of the vessel in the first computed tomography/magnetic resonance imaging (CT/MRI) slice and tracking is then performed consecutively for subsequent slices based on initial detection in the first slice. In [12] authors used Hessian-based and particle filter to determine seed points and track coronary arteries. To improve the robustness of the algorithm, the authors devised a local geometric feature based on the similarity of consecutive cross-sections perpendicular to the vessel direction.The tracking-based approach makes it possible to reduce user intervention and consequently leads to a considerable decrease in computation cost after the initial segmentation. The most common algorithm used in the tracking-based approach is the Kalman filter algorithm. This algorithm consists of a series of tracking states defined by a linear state-space model. It can also track the structure of a vessel in a 3D environment because the state-space model can be applied to track shape variations of the vessel boundary between slices. However, it is easy to fail to segment the vessel boundary when the vessel is adjacent to bone because of ambiguous vessel boundaries, which in turn leads to failure to trace the vessel in subsequent slices due to error propagation. Moreover, if the shape varies non-linearly between slices, the Kalman filter does not yield accurate results.In this paper, we present a SNT scheme for vessel boundary that we refer to as an adaptive Kalman snake that takes advantage of both model-based and tracking-based approaches, and is therefore resilient to shape deformation and requires minimal user intervention. As first introduced in [13], the Kalman snake employs the equations of motion of a physical snake model. Our algorithm incorporates the Kalman snake scheme, but several modifications are made to segment and track the vessel boundaries, as follows: First, we employ a snake to initialize the vessel boundary. Next, to design a state transition matrix of the Kalman filter, which determines inter-slice vessel position translation and shape deformation, we use an initial contour estimation algorithm. Finally, we propose an adaptive control point spacing algorithm to resolve potential errors introduced by the simple combination of snake and Kalman filter. Experiments were performed on synthetic and real CTA images, and the proposed algorithm is compared with the well-known Chan-Vese (CV) [14] model. Computation time analysis is also performed.The layout of the paper is as follows: In Section 2, we provide a brief introduction of the active contour model and Kalman filter. Motivation for our proposed model is presented in Section 3, and a detailed explanation of the proposed model is described in Section 4. The simulation environment is given in Section 5. In Section 6, we apply our model to synthetic and real medical images, and analyze the results. Finally, we draw our conclusions in Section 7.

@&#CONCLUSIONS@&#
In this study we developed a 3D vessel tracking model called the adaptive Kalman snake by jointly employing an active contour model and the Kalman filter, both of which have been widely used in automatic control algorithms in the field of computer vision. The arbitrarily-shaped blood vessel boundary was segmented on each slice using the active contour model, whereas the Kalman filter was used to track translation and shape deformation between CTA slices. To obtain refined segmentation results, an adaptive control point spacing algorithm is introduced into the active contour model. Moreover, a block search-based initial contour estimation procedure is proposed to ensure that the initial contour of every slice can be placed near the vessel boundary. Experiments were performed on synthetic and in vivo chest CTA images. For the performance evaluation, SEN and SPC were calculated using a binary classification test. Based on such statistical measures, the number of successfully segmented slices (Nseg), ROC curves, and corresponding AUC values can be obtained. The performance comparison showed that the proposed algorithms have better SNT performance than the CV model. In particularly, as the elapsed time for each algorithm decreases, the performance difference between the two algorithms increases. This demonstrates the time efficiency for segmentation using our model. In addition, we found that if a vessel boundary varies rapidly between slices, the proposed model will have a greater advantage in SNT performance, i.e., our model is more robust in tracking than the CV model. In the synthetic model, the proposed model also shows better performance over the CV model in a noisy environment, i.e., as the noise level is increased, the proposed method shows better performance than the CV model. Also, in a real CTA model, the proposed method has strong SNT performance in curly, short-diametered, or branched vessels. In future work we will extend the current model to track not only parallel to the slice, but also in arbitrary vessel directions.