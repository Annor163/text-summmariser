@&#MAIN-TITLE@&#
Surfaces with Pythagorean normals along rational curves

@&#HIGHLIGHTS@&#
An algebraic analysis of components of offsets to irreducible surfaces along rational curves is provided.A simple criterion for deciding if the curve on the surface is (proper/non-proper) PSN is formulated.Surfaces with PSN pencils such that a generic fiber is a proper/non-proper PSN curve are investigated.It is shown that all developable surfaces are PSN pencils (but not necessarily PN surfaces).For non-developable surfaces a method for generating all real parameterizations respecting PSN pencils is designed.

@&#KEYPHRASES@&#
Offset surfaces,Pythagorean surface normals,Double planes,PSN curves,PSN pencils,Numerical-control machining,

@&#ABSTRACT@&#
A rational curve on a rational surface such that the unit normal vector field of the surface along this curve is rational will be called a curve providing Pythagorean surface normals (or shortly a PSN curve). These curves represent rational paths on the surface along which the surface possesses rational offset curves. Our aim is to study rational surfaces containing enough PSN curves. The relation with PN surfaces will be also investigated and thoroughly discussed. The algebraic and geometric properties of PSN curves will be described using the theory of double planes. The main motivation for this contribution is to bring the theory of rational offsets of rational surfaces closer to the practical problems appearing in numerical-control machining where the milling cutter does not follow continuously the whole offset surface but only certain chosen trajectories on it. A special attention will be devoted to rational surfaces with pencils of PSN curves.One of the basic operations in Computer-Aided Design (CAD) and related technical applications (such as numerical-control machining, robot path-planning, tolerance analysis, etc.) is offsetting. The two-sided δ-offsetOδ(X)to an irreducible surfaceXis the envelope of the system of spheres centered at the points ofXwith the radius δ. Because of their high applicability, investigating surface offsets has become a popular research field in recent years and many interesting and challenging problems have been thoroughly studied – e.g. analysis of their geometric and algebraic properties, determining the number and type of components and constructing rational parameterizations (if they exist); see e.g. Arrondo et al. (1997, 1999), Lü and Pottmann (1996), Sendra and Sendra (2000). Computational techniques for offsets have been surveyed firstly by Pham (1992) and later by Maekawa (1999).A serious problem with offsets is that they are often far more complicated than the input generating surfaces (they can be of very high degree, reducible, with self-intersections, non-rational, etc.). Hence approximation methods are in several real situations not only possible but unavoidable. However, offsets to special classes of rational surfaces admit exact rational representations. The notion of rational surfaces with rational offsets, the so-called Pythagorean Normal vector (PN) surfaces, was introduced by Pottmann (1995) as the surface counterpart to the theory of Pythagorean Hodograph (PH) curves, which are planar curves possessing rational offset curves introduced by Farouki and Sakkalis (1990). More details about PN surfaces can be found e.g. in papers by Krasauskas (2008), Lávička and Bastl (2008), Lávička and Vršek (2012), Vršek and Lávička (2013). For a survey of shapes with Pythagorean normals property (i.e., possessing rational offsets) see Farouki (2008) and for a recent discussion about rational offset surfaces and their modelling application see Krasauskas and Peternell (2010).The aim of this paper is to start an investigation of rational offsets to surfaces from a new point of view and return this research back to one of the practical applications which originally motivated the introduction of PN surfaces in CAGD, namely closer to numerical-control machining. We recall that PN surfaces were introduced due to their straightforward applicability in CAD/CAM as they guarantee that the surface representing the centers of the sphere milling cutter (i.e., an offset of the shape being milled) is rational and thus it can be described via NURBS formalism and then entered to some CAD system. Nevertheless, this requirement is too strong as the milling cutter does not follow continuously the whole offset surface but only a chosen (suitable) trajectories on it, see Fig. 1. So we do not have to assume that the PN property is satisfied globally but only along some special curves. Of course, it is necessary that the surface possess “enough” and “suitably” distributed curves (trajectories of the milling cutter) along which the unit normals of the surface are rational (we will call this trajectories PSN curves). The close relation of surfaces with pencils of PSN curves to PN surfaces will be investigated and presented.The main results concerning the PSN curves (and related topics) can be summarized as follows:1.A complete algebraic analysis of degeneration and existence of simple and special components of offsets to irreducible surfaces along rational curves is provided.A simple criterion, based on the discussion of the roots of a certain polynomial, for deciding if the curve on the surface is PSN or not is formulated. In addition, we also suggest how to decide whether the curve is proper or non-proper PSN curve.Surfaces with PSN pencils such that a generic fiber is a proper/non-proper PSN curve are investigated and related to PN surfaces. Moreover, the results dealing with the reducibility and the rationality of the offsets depending on the properties of the associated double covers are presented and discussed.It is shown that all developable surfaces are PSN pencils. Furthermore, for non-developable surfaces a method for generating all real parameterizations respecting PSN pencils is designed as a direct counterpart to a similar approach formulated for PN surfaces.The remainder of this paper is organized as follows. The next section shortly summarizes some fundamental facts about surfaces with Pythagorean normals (PN surfaces) and PN parameterizations. Furthermore, the so-called PSN curves and PSN parameterizations will be introduced (where PSN stands for Pythagorean surface normals). In Section 3 we will deal with algebraic properties of offsets and associated double covers (or double planes). In this section, the reducibility and rationality of the double plane associated to the given surface will be related to the PN/PSN property. Theorem enabling to distinguish whether a curve is PSN or not will be formulated. In addition, components of PSN curves will be investigated. Special and degenerated components of surface offsets along curves will be thoroughly studied in Section 4. Finally, after studying remarkable surfaces with pencils of PSN curves in Section 5 we conclude the paper.Throughout this paper we will work over the field of complex numbersC. Although for modelling applications the results over the field of real numbersRare necessary the global analysis over an algebraically closed field is usually very helpful for right understanding of the essence of the studied problems, especially when the tools of algebraic geometry are involved.LetX⊂AC3be an algebraic surface and let us denote byq∈S2a unit normal vector at a non-singular pointp∈XReg. Then for non-zero δ, the δ-offsetOδ(X)ofXis defined as the closure (with respect to Zariski topology) of the set{p±δq|p∈X}. IfXis rational andx(u,v)is its parameterization, i.e., the dominant rational mapping11We recall that a rational mapping which is defined almost everywhere will be denoted by ⇢ in what follows. Furthermore, a mappingφ:X⇢Yis said to be dominant if the closure ofφ(X)is equal toY.x:AC2⇢X, then the associated normal vector field of the surface is expressed as(1)nx(u,v)=xu(u,v)×xv(u,v),wherexu=∂x/∂uandxv=∂x/∂v. The two-sided δ-offsetOδ(X)of the surfaceXis now given by(2)x(u,v)±δnx(u,v)|nx(u,v)|,where for a vectora=(a1,a2,a3)we define|a|by the identity|a|2=a12+a22+a32. It turns out that (2) is rational if and only if|nx(u,v)|is rational. This is equivalent to the existence of a rational functionσ(u,v)such that(3)|nx(u,v)|2=σ2(u,v),see Pottmann (1995). The parameterizationsx(u,v)fulfilling this condition are called Pythagorean normal vector (PN) parameterizations and the condition (3) is referred to as PN condition or PN property. A surfaceXadmitting a PN parameterization is called a PN surface.Now letX⊂AC3be a rational algebraic surface andC⊂Xbe a rational curve given by the parameterizationc:AC1⇢C. SinceXis rational then by Castelnuovo's theorem there exists its proper parameterizationx(u,v), i.e., the birational mappingx:AC2⇢X. Hence we can writec(t)=x(u(t),v(t))for some rational functionsu(t)av(t). The normal vector field of the surface alongCis expressed as(4)nx,c(t)=xu(u(t),v(t))×xv(u(t),v(t)).With this notation we can define the two-sided δ-offsetOδ(X,C)of the curveCwith respect to the surfaceXby(5)x(u(t),v(t))±δnx,c(u(t),v(t))|nx,c(u(t),v(t))|.See Fig. 2for illustration of offset curves. We can also speak about the offset of the given surface along its curve. Although (5) defines an algebraic curve this curve is not rational, in general. Indeed the formula gives a rational mapping if and only if there exists a rational functionσ(t)such that the following (Pythagorean) condition is satisfied(6)[xu(u(t),v(t))×xv(u(t),v(t))]2=σ2(t).Then we say that the parameterizationx(u(t),v(t))fulfilling (6)admits Pythagorean surface normals with respect toX, or it is shortly called a PSN parameterization. A curveC⊂Xadmitting a PSN parameterization will be then called a PSN curve. Moreover, it is easy to verify that the PSN property(6) does not depend on the reparameterization ofx(u,v)and thus it is well defined.Remark 2.1Since a normal vector of a surface is not well defined at a singular point we will, for the sake of simplicity, implicitly assume in what follows that a generic point ofCis non-singular onX.Example 2.2Consider the paraboloidXgiven by the parameterizationx(u,v)=(u,v,u2+v22)and a curveCon it determined by the rational functionsu(t)=2t,v(t)=2t2. Then it holds(7)[xu(u(t),v(t))×xv(u(t),v(t))]2=u2(t)+v2(t)+1=(2t)2+(2t2)2+1=(2t2+1)2,i.e., the PSN condition is satisfied andCis a PSN curve onX. In addition, its offsetOδ(X,C)has a parameterization(8)2(t,t2,t2+t4)±δ12t2+1(2t,2t2,1).Of course, the PSN condition (6) can be satisfied for some curves despite the fact that the PN condition (3) is not fulfilled for the given surface parameterization, see for instance the previous example. On the other hand, when the parameterizationx(u,v)of the surfaceXis PN then any parameterizationx(u(t),v(t))of the curveC⊂Xis PSN. Thus there exist a lot of PSN curves on PN surfaces. Nevertheless it must be stressed out that not every rational curve on a PN surface has to be PSN, see Fig. 2 (right) showing an ellipsoid of revolution (i.e., a PN surface as proved by Peternell and Pottmann, 1998) with two curves on it – a PH circle and a non-PH ellipse. This occurs when the PN surface has only a non-proper PN parameterizationx(u,v)(see Section 3); in this case not all rational parameterizations of curves on the surface can be written in the formx(u(t),v(t)).Despite working only with irreducible surfaces their offsets need not to be generally irreducible. Hence, we have to distinguish the following components, whose names were introduced in Arrondo et al. (1997) and used e.g. in Sendra and Sendra (2000), Vršek and Lávička (2010). An irreducible componentU⊂Oδ(X)is called simple, special, or degenerated if for a generic pointr∈Uthere exist(s) just one, more than one but finitely many, or infinitely many pair(s)(p,q), wherep∈XRegandq∈S2, generating the pointr∈U, respectively. Special components are precisely those generated when computing offsets to offsets and it follows directly from the definition of degenerated components that they are not surfaces but curves or points.For later use, we recall some results from Sendra and Sendra (2000). In particular, it can be proved that offsets have at most two components and at least one of them is simple. For almost every distance δ (i.e., up to finitely many exceptions) the offsetOδ(X)has simple components only. Next, we summarize some results from Arrondo et al. (1997) in the following theorem and introduce two classes of PN surfaces, which will be later discussed in more detail.Theorem 3.1LetXbe a rational surface. Its offsetOδ(X)may consist of at most two components.1.IfOδ(X)is reducible then both components are rational and every parameterization is PN. For this reason we callXa proper PN surface.IfOδ(X)is irreducible then it is not rational in general. Moreover, if a rational non-proper parameterization ofXis PN then we call it a non-proper PN surface.The aforementioned properties can be efficiently studied with help of incidence varieties relating the surface and its offset. For an arbitrary algebraic surfaceX⊂AC3we may construct an incidence varietyI(X)as the closure of the set(9){(p,q)∈XReg×S2|NpX∥NqS2},whereNyYis the normal line at the point y of the surfaceY. The generic fiberπ1−1(p)of the projectionπ1:I(X)→X,(p,q)↦pconsists of two points(p,±q)where±q∈S2can be viewed as the two possible unit normal vectors atp∈X. On contrary, the morphismμδ:I(X)→Oδ(X), given by(p,q)↦p+δqis birational for simple offsets and thus for a generic value of δ.Considering the incidence variety and all related mappings we can view offsets as double covers of the original surface via the following incidence diagram(10)This point of view turns out to be very useful when trying to understand for instance the correspondence between the curves onXandOδ(X)and the rationality of offsets.The double cover is branched along a certain curve consisting of the points with only one preimage. The double covers (or sometimes also called double planes, see e.g. Jung, 1942; Calabri, 2002 for more details) are usually studied in normal form, i.e., asπ:Λ→AC2where Λ is a surface given by the equationw2−P(u,v)=0for some reduced polynomialP(u,v)22To be more precise we need the algebraic degree ofP(u,v)to be even otherwise the line at infinity has to be added to the branching curve in the projective extension. However, we will not need this fact in what follows.and π is a projection to the uv-plane. We recall that the polynomial is called reduced if it does not have multiple factors. In what follows we will find a normal double cover equivalent to the offset of the algebraic surface. Let(11)x(u,v)=(x1(u,v)x0(u,v),x2(u,v)x0(u,v),x3(u,v)x0(u,v))be a proper parameterization of the surfaceX. Then we can write(12)|xu(u,v)×xv(u,v)|2=Q2(u,v)P(u,v)R2(u,v)for some polynomialsQ,Rand a reduced polynomial P such that the coefficient of the leading term of P with respect to some fixed ordering (e.g. the lexicographic ordering) is one. We associate tox(u,v)the normal double cover(13)Λx:w2−P(u,v)=0,branched along the reduced curveP(u,v)=0.Example 3.2Consider the paraboloidx(u,v)=(u,v,u2+v22); then[xu(u,v)×xv(u,v)]2=u2+v2+1and the associated double cover has the formΛx:w2−u2−v2−1=0. Analogously for the Enneper surfacey(u,v)=(u−u33+uv2,v−v33+u2v,u2−v2)we obtain[yu(u,v)×yv(u,v)]2=(u2+v2+1)4and henceΛy:w2−1=0.Theorem 3.3There exists a birational mappingϕ:Λx⇢Oδ(X)such that the diagram commutes(14)ProofThe only mapping to be constructed in (14) isϕ:Λx⇢Oδ(X). Consider the normal vector fieldnx(u,v)=xu(u,v)×xv(u,v)and let us use the notation from (12). Then we define a rational mapping(15)ϕ:(u,v,w)↦x(u,v)+δR(u,v)Q(u,v)wnx(u,v)Indeed, since|nx(u,v)|=Q2P/R2=Qw/Rthe rational mapping is well defined. The commutativity follows from the fact that the mappingOδ(X)⇢Xsends the points of the formx(u,v)±nx(u,v)/|nx(u,v)|just tox(u,v).  □It is not seen at the first sight from the parameterization of the paraboloid from Example 3.2 that this surface is a PN surface (although this is a well-known fact as all elliptic/hyperbolic paraboloids belong to surfaces with Linear Normals (LN surfaces), see Jüttler, 1998, and thus they are PN). Hence, we have to consider suitable reparameterizations which relate the PN property of the surfaceXwith the rationality of the associated double coverΛx.Lemma 3.4Letx(u,v)be a parameterization ofXwith the associated double coverΛx. Thenu=φ(s,t),v=ξ(s,t)andw=ν(s,t)parameterizeΛxif and only ifx(φ(s,t),ξ(s,t))is a PN parameterization ofX.ProofThe behaviour of the normal vector field under the mentioned reparameterization is expressed by the formula(16)nx(φ,ξ)(s,t)=det⁡(J(φ,ξ)(s,t))nx(φ(s,t),ξ(s,t)).Combining this relation with (12) and substitutingP(φ(s,t),ξ(s,t))=μ2(s,t)leads to(17)|nx(φ,ξ)(s,t)|2=det⁡(J(φ,ξ)(s,t))2Q2(φ(s,t),ξ(s,t))μ2(s,t)R2(φ(s,t),ξ(s,t)).The right term is a perfect square of some rational function and hencex(φ(s,t),ξ(s,t))is a PN parameterization.Conversely if(φ(s,t),ξ(s,t),μ(s,t))does not parameterizeΛxthenP(φ(s,t),ξ(s,t))is not a square of any rational function. Comparing this with (17) we conclude thatnx(φ,ξ)(s,t)cannot be a square either, and thusx(φ(s,t),ξ(s,t))is not a PN parameterization.  □By the previous lemma the reducibility and/or rationality ofΛxdoes not depend on the choice of a proper parameterization. The following two corollaries establish the “dictionary” between the PN property of the surfaceXand the corresponding double cover.Corollary 3.5A rational surfaceXis a proper PN surface if and only ifΛxis reducible, i.e., it has the defining equationw2−1=0.Corollary 3.6A rational surfaceXis a non-proper PN surface if and only ifΛxis irreducible and rational.Example 3.7Obviously, the Enneper surface from Example 3.2 is a proper PN surface. On the other hand, the paraboloid from the same example is a non-proper PN surface asΛx:w2−u2−v2−1=0is irreducible and rational as it is a two-sheeted hyperboloid.Remark 3.8Suppose that a proper parameterizationx(u,v)of the surfaceXis given. It is a simple task to test whether it is a PN parameterization or not. Nevertheless, if we prove that the PN property is not satisfied we still cannot say with certainty whether the surface has rational offsets or not – one should try all the reparameterizations and test them on the PN property, which is of course impossible. Another variant is to calculate the offset surface directly (in implicit form) and then decide if it is rational or not. However, this computation is usually very complicated. Corollary 3.6 provides a new alternative tool because the equation ofΛxcan be easily calculated. Its rationality can be then decided via the standard methods, see e.g. Schicho (1998).Now we are ready to return back to PSN curves and we are able to use the introduced approach to obtain the first results dealing with their properties. It is not surprising that a statement analogous to Theorem 3.1 will hold for the offsets of curves on surfaces, too.Theorem 3.9LetC⊂Xbe a rational curve on a rational surface. Its offsetOδ(X,C)may consist of at most two components.1.IfOδ(X,C)is reducible then both components are rational and every parameterization is PSN. For this reason we callCa proper PSN curve.IfOδ(X,C)is irreducible then it is not rational in general. Nonetheless, it is rational if and only if there exists a PSN parameterization ofC(which is always non-proper). Then we callCa non-proper PSN curve.ProofConsider the incidence diagram (10) and let us denote the preimage ofConI(X)byI(X,C). Then the restriction of the corresponding mappings leads to(18)Since there is a well defined unit normal vector q at a generic pointp∈C, the preimage of p underπ1consists of exactly two points(p,q),(p,−q)∈I(X)anddeg⁡π1=2. ThereforeI(C,X)may consist of at most two components of dimension one.First, let us assume thatI(X,C)=U∪VwhereUandVare irreducible curves. Then both restrictions of the projectionπ1, i.e., the morphismsπ1|U:U→Candπ1|V:V→Care both of degree one and thus birational. For the offset of the curve it holds(19)Oδ(X,C)=μδ|U(U)∪μδ|V(V)and it consists of two components. The curveCis rational and thus there exists its parameterizationc:AC1⇢C. The composed mappingμδ|U∘(π1|U)−1∘cis a parameterization of a component of the offset. Hence it is unirational and by Lüroth's theorem rational, too. The same holds also for the second component.Now, ifc(s)is a parameterization ofCthen(20)(π1|U)−1(c(s))=(c(s),q(s))is a parameterization ofUand by the construction of the incidence varietyq(s)is the associated unit normal vector field ofXalongC. Hence,c(s)is a PSN parameterization.Second, let us assume thatI(X,C)is irreducible. Thenπ1is not birational but it has degree two and nothing can guarantee the rationality ofI(X,C)in general. We assume thatI(X,C)is rational, i.e., there exists its parameterizationy(t)=(c(t),nx,c(t)). Thenπ1(y(t))=c(t)is a parameterization ofCwith the associated unit normal vector fieldnx,c(t)and thus it is a PSN parameterization. Moreover any PSN parameterization can be obviously obtained in this way. Indeed, PSN parameterizationc(t)ofCcan be always lifted to the rational parameterization(c(t),nx,c(t))ofI(X,C). Since the degree of the composed mapping is the product of the particular degrees, i.e.,deg⁡c=deg⁡π1⋅deg⁡y=2deg⁡y>1,c(t)cannot be a proper parameterization.  □As the conclusion of the previous theorem we can see that the PSN property of curves is reflected in the rationality and/or reducibility of the corresponding curves on the offset surface. These properties ofOδ(X,C)may be efficiently studied when we know the multiplicities of the intersection points ofCwith the branching curve of the associated double cover. Unfortunately, it is not so easy to determine these numbers and thus we use Theorem 3.3 instead.Let the curveC⊂Xbe given by its proper parameterization(21)x(u(t),v(t))=x(φ1(t)φ0(t),φ2(t)φ0(t)).Let us denote byC′⊂AC2a planar rational curve parameterized by(u(t),v(t)). Then by Theorem 3.3 and Theorem 3.9,Cis proper PSN if the liftπ−1(C′)⊂Λxis reducible, and non-proper PSN if the lift is irreducible and rational. In what follows we will find a planar curveDbirationally equivalent toπ−1(C′)for which these questions can be easily answered. LetΛxbe given by the equationw2−P(u,v)=0, whereP(u,v)is reduced and of algebraic degree k and letPH(u0,u1,u2)be its homogenization. Since(u(t),v(t))is proper there exists its rational inverset=φ−1(u,v). First, consider the image ofπ−1(C′)under the birational mapping(22)(u,v,w)↦(φ−1(u,v),w).It is easy to verify that it is a planar curve given by the equation(23)φ0(t)kw2−PH(φ0(t),φ1(t),φ2(t))=0.Then, the required curveDis the image of the curve (23) underx=t,y=φ0(t)⌈k/2⌉wwith the rational inverset=x,w=y/φ0(x)⌈k/2⌉, i.e.,Dis a curve given by the equation(24)y2−φ0(x)(kmod2)PH(φ0(x),φ1(x),φ2(x))=0.There is a simple genus formula for the curves in the form (24) which allows us to formulate the following theorem:Theorem 3.10Cis a PSN curve if and only ifφ0(x)kmod2PH(φ0(x),φ1(x),φ2(x))has at most two roots of odd multiplicity. Moreover, it is a proper PSN curve if it has no root of odd multiplicity.ProofCis a PSN curve if and only ifOδ(X,C)is rational. By Theorem 3.3 and the above given considerationsOδ(X,C)is birationally equivalent toD. Let us denote by N the number of the simple roots of the polynomial from the statement of the theorem. ThenDis reducible if and only ifN=0and in this case so isOδ(X,C). In addition,Cis a proper PSN curve. IfN>0then the genus formula forDstates(25)g(D)=⌈N2⌉−1,and thusCis a non-proper PSN curve forN=1,2only.  □Example 3.11Consider again the paraboloidXgiven by the parameterizationx(u,v)=(u,v,u2+v22)and a curveCon it determined now by the rational functionsu(t)=t,v(t)=t. It holds[xu(u(t),v(t))×xv(u(t),v(t))]2=u2(t)+v2(t)+1=2t2+1which is not a perfect square. ThusCcannot be a proper PSN curve. However, there is still a chance that this curve is a non-proper PSN curve. The associated curveD(see above) has the equationy2−2x2−1=0. As the polynomial2x2+1has two simple roots we haveN=2andg(D)=0. Hence, any rational parameterization ofDwill determine a reparameterization which yields a non-proper parameterization ofCwith the PSN property. For instance, the parameterization(x,y)=(s21−s2,1+s21−s2)gives a new (non-proper) parameterization ofCdetermined byu(s)=s21−s2,v(s)=s21−s2which guarantees the PSN property, i.e.,[xu(u(s),v(s))×xv(u(s),v(s))]2=u2(s)+v2(s)+1=(s2+1s2−1)2. Thus,Cis a non-proper PSN curve on the paraboloidX.Analogously to different types of components of the classical surface offsetOδ(X)recalled in the previous section we may define the same notions also forOδ(X,C). A componentU⊂Oδ(X,C)is called simple, k-special33In the standard surface offset case we do not use the term k-special because every special component is solely 2-special.fork>1or degenerated if a generic point inUis generated by one, k or infinitely many points fromC, respectively. Since the rational mappingU⇢Ccan be constructed for simple components only it is necessary to understand correctly under which conditions the non-simple components can occur and to show that they are rare.Lemma 4.1LetU⊂Oδ(X,C)be a non-simple component thenUlies in a non-simple component ofOδ(X)orU⊂Oδ(X)Sing.ProofLet us denote byVthe preimage ofUon the incidence varietyI(X)under the morphismμδ, cf. (14).Uis non-simple ifdeg⁡μδ|V>1. This is possible ifdeg⁡μδ>1, i.e.,Uis contained in a non-simple surface offset component. For a simple surface offset componentY⊂Oδ(X)we havedeg⁡μδ=1and thus for each regular pointy∈Ythe fiberμδ−1(y)consists of exactly one point. Sincedeg⁡μδ|V>1, there must exist an open setU⊂Usuch thatU⊂YSing. HoweverUis the closure of U andYSingis a closed set, hence we concludeU⊂YSing⊂Oδ(X)Sing.  □We will start with studying degenerated components.Theorem 4.2The offsetOδ(X,C)contains a degenerated component if and only if there exists a sphere of radius δ tangent toXalongC. Moreover in this case,Oδ(X,C)is reducible and the second component is simple.ProofLetd∈Oδ(X,C)be a degenerated component, a point in particular. A generic point ofC(we can omit the singular points ofCand also ofXas there are only finitely many of them) then lies on the sphere with the centre d and the radius δ. Indeed, forp∈Cwe haved=p+δnp, wherenp2=1. This implies(p−d)2=δ2. Moreover, the normals of the sphere coincide with the normals of the surface and thus the sphere is tangent toXalongC.The second component ofOδ(X,C)consists of the points of the form2p−dforp∈C. Since from2p1−d=2p2−dwe obtainp1=p2, this component is simple.  □There exists a close relation of offsets along curves possessing degenerated components to standard surface offsets with degenerated components. In particular, the surface yielding an offset with a degenerated component has a lot of curves along which the offsets have also degenerated components. Nevertheless, not every curve on such a surface has to have such a component. To see this let us recall that the component ofOδ(X)degenerates to point if and only ifXis a sphere of radius δ and it degenerates to a curve if and only ifXis the envelope of a one-parameter set of spheres of radii δ, i.e., it is a pipe surface. In the first case, the δ-offset of any curve degenerates to a point (the center of the sphere). In the second case the δ-offset of a characteristic circle degenerates to the point but for other curvesOδ(X,C)consists of the spine curve (as the inner component) and other simple component. However, it must be stressed out that the curves with degenerated offsets may exist even when the underlying surface has simple components only, for illustration see e.g. Fig. 3(left) in which one of the curve offset components is a singular point of the surface offset.Now we will focus on the special components ofOδ(X,C). For the sake of simplicity we will consider only the curves with the offsets not contained in the singular locus ofOδ(X), cf. Lemma 4.1. Therefore we may assume thatOδ(X)has a non-simple component – let us start with the special one.Theorem 4.3LetXbe a surface such thatOδ(X)has a special surface componentY. ThenOδ(X,C)has a special curve componentU(U⊄Oδ(X)Sing) if and only ifC=Oδ(Y,U). Moreover,Uis 2-special,Oδ(X,C)is reducible and the second curve component is simple.The steps of this proof are a straightforward analogy to the steps of the proof of Theorem 7 in Sendra and Sendra (2000).  □It remains to be shown how curves with special offset components arise on surfaces with degenerated components. LetXbe a pipe surface given by its spine curve and the radius δ. Now consider an arbitrary curveConXintersecting any generic characteristic circle of this pipe surface in exactly k points. Then for each characteristic circle, the δ-offset will consist of k “outer” points and one k-tuple “inner” point (the centre of the characteristic circle). Thus, we can immediately conclude that the spine curve is a component ofOδ(X,C)which is k-special, see Fig. 3 (right). Therefore compared to the offsets of surfaces where only 2-special components can occur, in the curve case one can obtain a k-special component for any arbitrary k.To sum up this section, the main message of the above given considerations is that the degenerated and special components are rare as they can arise solely on non-simple components of surface offsets (which are rare by Sendra and Sendra, 2000) or in the singular locus of the surface offsets (which is also a rare case because a generic point on the surface is regular).As already mentioned before, the PN property of a given surface can be sometimes too strong for CNC machining as the milling cutter does not follow the whole offset surface continuously but only along some (discrete) trajectories on it. This is a main motivation to introduce and investigate PSN curves on surfaces and thus to extend the class of surfaces interesting and suitable for technical practise. Of course, it is also a challenging task to study a relation between the PN surfaces and surfaces possessing “enough” PSN curves. We recall that these curves can occur also on non-PN surfaces and vice-versa on PN surfaces we can find curves which are non-PSN. In addition, the natural question reads if e.g. a one-parametric system of PSN curves guarantees the PN property. We will discuss it in this section.Let us define a PSN pencil to be a rational mappingμ:X⇢AC1such that its generic fiber is an irreducible PSN curve, i.e., there exists an open set on the surface covered by a one-parametric family of PSN curvesCt=μ−1(t). If it happens for the parameterizationx(u,v)ofXsuch thatx(u0,v)is a PSN parameterization for a genericu0thenx(u,v)is called a parameterization respecting PSN pencil.In the following considerations we will use the next lemma whose detailed proof is omitted because of its purely technical character (it is enough to write the concerned polynomial in two ways, i.e.,[∑i=0kφi(u0)vi]2and∑i=02kψi(u0)vi, and then only to compare the corresponding coefficients, which brings us to the result).Lemma 5.1Consider a polynomialF∈C[u,v]such that for allu0∈Cthere existsG∈C[v]fulfillingF(u0,v)=G2(v). ThenF(u,v)can be written in the formP(u)Q2(u,v)for some polynomialsP∈C[u]andQ∈C[u,v].In what follows we will establish a relation between a surface with PSN pencil and its PN properties. Since a generic curve in the pencil is either proper or non-proper PSN curve we need to distinguish two cases.Theorem 5.2LetXbe a surface with PSN pencilμ:X⇢AC1such that a generic fiber is anon-properPSN curve. ThenOδ(X)is irreducible and rational, i.e.,Xis a non-proper PN surface.ProofFirst, let us prove thatOδ(X)is irreducible. Contrariwise, we suppose that it consists of two componentsUandV. Then sinceOδ(X,Ct)is irreducible it has to lie in the both components, i.e.,Oδ(X,Ct)⊂U∩V. However, this has to hold for a generic curveOδ(X,Ct)which impliesOδ(X)=U∩V¯and thusU=Vand the offset is irreducible.SinceOδ(X)is irreducible it is simple by Sendra and Sendra (2000). Hence, there exists a dominant rational mappingϕ:Oδ(X)⇢X. The fiber of the composed mappingμ∘ϕ:Oδ(X)⇢AC1isϕ−1(Ct)=Oδ(X,Ct)which is a rational irreducible curve by Theorem 3.9. Thus,μ∘ϕis a pencil of rational curves onOδ(X). By result of Noether (1870)Oδ(X)is a rational surface.  □The situation with the pencil of proper PSN curves is a bit more complicated and the resulting surfaces can be either proper PN surfaces or do not have rational offsets.Theorem 5.3LetXbe a surface with a PSN pencilμ:X⇢AC1such that a generic fiber is aproperPSN curve. Then there exists a parameterizationx(u,v)such thatΛxhas the equation(26)w2−P(u)=0,whereP(u)is a reduced univariete polynomial. Moreover, the reducibility and the rationality of the offset surface depend on the degree of the polynomialP(u)as followsdeg⁡P(u)Oδ(X)reducible?PN surface?0YESYES, proper1,2NOYES, non-proper>3NONOProofSince any PSN curve is by definition rational, the pencil μ is a pencil of rational curves, too. Thus again using the result from Noether (1870) there exists a parameterizationx(u,v)such that for a generic valueu0we obtain thatx(u0,v)parameterizes a curveCu0from the pencil. Since this is a proper PSN curve there exists a rational functionσ(v)such that|nx(u0,v)|2=σ2(v). When writing|nx(u,v)|2in the form (12) and applying Lemma 5.1 we arrive at(27)|nx(u,v)|2=P(u)Q2(u,v)/R2(u,v),and thus the associated double coverΛxpossesses the equationw2−P(u). Furthermore,Λxis reducible if and only ifP(u)is a constant and Corollary 3.5 gives us the condition onXbeing a proper PN surface.Next, let us assumedeg⁡P≥1. Then by Corollary 3.6Xis a non-proper PN surface if and only ifΛxis a rational surface. Nevertheless, this is a cylinder over the curve(28)w2−P(u)=v=0which is rational if and only if this curve is. To see this, let(u(s,t),v(s,t),w(s,t))be a parameterization ofΛxand assume w.l.o.g. that(u(s,0),v(s,0),w(s,0))does not define a generating line on the cylinder. Then(u(s,0),w(s,0))is a rational parameterization of the curve. On contrary, if(u(s),w(s))parameterizes (28) then(u(s),t,w(s))is a rational parameterization ofΛx.SinceP(u)is a reduced polynomial the curve (28) is rational if and only ifdeg⁡P<3(it is elliptic fordeg⁡P=3and hyperelliptic fordeg⁡P>3). This proves the theorem.  □The following corollary follows immediately from the proofs of the above theorems.Corollary 5.4LetXbe a PN surface andμ:X⇢AC1a proper PSN pencil. Then there exists a PN parameterizationx(u,v)such thatx(u0,v)parameterizes the PSN curveμ−1(u0).Remark 5.5It must be stressed out again that in this paper we work overC. However, problems originated in various fields dealing with computing for industrial applications need to work over the reals. Hence, some mathematical difficulties may appear and some results must be reconsidered. For instance, if one wants to parameterize a surface with a rational pencil properly, without passing to the complex numbers, then it is unfortunately sometimes necessary to produce parameterizations for which the curves in the pencilμ−1(u0)are not parameter lines. Even worse there exist rational surfaces not possessing any real proper parameterization, for more details see Schicho (2000). Hence, it is not guaranteed in general that the PSN parameterizationx(u0,v)of the parametric v-curve on the real PN surfacex(u,v)is real.In the rest of this section we want to study PSN pencils on general developable and non-developable surfaces in more detail. We start with a typical example of surfaces carrying pencils of PSN curves, in particular with the ruled surfaces. By definition ruled surfaces contain a continuous family of straight lines (generators or rulings). It was proved by Pottmann et al. (1996) (Proposition 1, p. 550) that the offset curveOδ(X,C)of a non-torsal generatorCis a rational quartic, i.e.,Cis a non-proper PSN curve. Since a generic ruling on a non-developable ruled surface is non-torsal we see that any non-developable ruled surface carries a pencil of non-proper PSN curves. On contrary, it is easy to show that the offset of a torsal ruling consists of two parallel lines and thus such a generator is a proper PSN curve. See also Fig. 4. Let us summarize this discussion to the next proposition.Proposition 5.6Each ruled surface is a PSN pencil with the rulings as the PSN curves. Moreover, the generic line is a proper PSN curve if and only if the surface is developable.The previous proposition with Theorem 5.2 give us also an alternative proof to the result from Pottmann et al. (1996), namely that the ruled non-developable surfaces have rational offsets (i.e., they are PN surfaces).Corollary 5.7Non-developable rational ruled surfaces are non-proper PN surfaces.To finish the analysis we will consider the developable surfaces as a special case. There exist three different types of the developable surfaces inAR3; namely tangent developables, cones and cylinders.Example 5.8LetXbe a rational tangent developable surface, i.e., there exists a space curve parameterized byp(u)such thatXadmits the parameterizationx(u,v)=p(u)+vp′(u)and the corresponding normal vector field is of the form(29)nx(u,v)=v(p″(u)×p′(u)).By Theorem 5.3 we conclude thatXis a proper PN surface if and only if(p″(u)×p′(u))2is a perfect square, and a non-proper PN surface if the numerator of the expression has at most two roots of odd multiplicity. Moreover, in this case the associated double coverΛxhas the equationw2−(u−α1), orw2−(u−α1)(u−α2), and its parameterization can be written in the form(30)u=s2+α1,v=t,w=s,or(31)u=α1−α221+s21−s2+α1+α22,v=t,w=α1−α222s1−s2,respectively. Nevertheless, by Lemma 3.4 settingu=u(s)andv=tgives us in both cases the formulas for a reparameterization ofx(u,v)yielding a PN parameterization ofX. In addition, the resulting parameterization still possesses the straight lines on the surface (rulings) as the parametric curves fort=t0.Completely the same computation can be done also for the two remaining types of the developable surfaces. We summarize the obtained results into the following table.Typex(u,v)PQ2/R2cylinderp(u)+qv|q×p′(u)|2conep(u)(1−v)+qv|p′(u)×(p(u)−q)|2tangent dev.p(u)+p′(u)v|p″(u)×p′(u)|2Thus developable surfaces are not necessarily PN, moreover most of them are not PN surfaces. Nevertheless the method presented above allows us to decide this very quickly and efficiently. In addition, we immediately obtain the PN parameterization if it exists.Remark 5.9Another class of surfaces carrying PSN pencil is the class of canal surfaces, which are shapes especially important in CAGD (similarly as ruled surfaces studied above). These surfaces are generated by the family of characteristic circles. The offset curve of these characteristic circles consists of two circles and thus they are proper PSN curves. Indeed each canal surfaceXis the envelope of one-parametric set of spheresSt. Each sphere from the family touchesXalong the characteristic circleCtand thusOδ(X,Ct)=Oδ(St,Ct)which consists generically of two circles. It is a well-known fact that a typical property of rational canal surfaces is being non-PN (in particular, they are proper PN only for rational medial axis transforms). Thus, considering the PSN pencils extends understanding of rational offsets also for canal surfaces.We have shown above that all developable surfaces are PSN pencils. In what follows, we will focus on non-developable surfaces and present a method for generating any real parameterizations respecting PSN pencils on non-developable surfaces. Using the dual representation, Pottmann (1995) derived the formula for generating all PN parameterizations. This approach can be modified also for PSN pencils.Considerx(u,v)as the envelope of two-parametric system of its tangent planes in the form(32)τ(u,v):n1(u,v)n0(u,v)x+n2(u,v)n0(u,v)y+n3(u,v)n0(u,v)z=h(u,v),whereni∈R[u,v]andh∈R(u,v). We recall that partial differentiation with respect to u and v gives the setsτu(u,v)andτv(u,v)and solving forx,y,zwe obtain the primal representationx(u,v). Now, let us assume thatx(u,v)is a parameterization respecting the PSN pencil, i.e.,∑i=13ni2(u0,v)is a perfect square inR[v]. By Lemma 5.1 this is equivalent to(33)∑i=13ni2(u,v)=P(u)Q2(u,v).Next, we considerni(u)(v),Q(u)(v)as polynomials in one variable v with the coefficients inR[u]. Then(34)(n1(u)(v)Q(u)(v),n2(u)(v)Q(u)(v),n3(u)(v)Q(u)(v))is a parameterization of a rational curve on the sphere(35)S:x2+y2+z2=P(u),centered at(0,0,0)and with the squared radiusP(u), i.e., it is a sphere in the spaceAR(u)3. The coefficients of this parameterization are chosen from the fieldR(u)and thus the parameterization is calledR(u)-rational. On contrary, for anyR(u)-rational parameterization(s1(u)(v),s2(u)(v),s3(u)(v))of the curve onSand a rational functionh(u,v)the envelope of the systems1(u)(v)x+s2(u)(v)y+s3(u)(v)z=h(u,v)is a PSN pencil.AnyR(u)-rational parameterization of a curve onScan be obtained by composingR(u)-rational parameterization of a curve in the planeAR(u)2andR(u)-rational parameterization ofS. It is a well-known fact that the existence ofR(u)-rational parameterization is equivalent to the existence of a pointz(u)∈Swith the coordinates inR(u). Indeed ifHis a plane not containing z then the projection from z toHinduces birational mappingσ:S⇢H. Its inverseσ−1is then anR(u)-rational parameterization. On contrary, any such a parameterization allows us to generate infinitely many points with coordinates inR(u)in an obvious way.We recall that (33) impliesP(u)≥0for allu∈R. Furthermore, any positive semidefinite polynomial admits an SOS decompositionP(u)=f12(u)+f22(u)+f32(u). Then the point(f1(u),f2(u),f3(u))is anR(u)-rational point on the sphereS.So, we can formulateTheorem 5.10All non-developable rational parameterized surfacesx(u,v)respecting PSN pencil, such that the parametric linesu=const.are PSN curves, can be represented dually as(32), where(36)n0(u,v)=a2+b2−2bcf+c2(f2+g2),n1(u,v)=2a[c(f2+g2)−bf],n2(u,v)=fa2−b2f+2bc(f2+g2)−c2f(f2+g2),n3(u,v)=g[a2+b2−c2(f2+g2)],fora(u,v),b(u,v),c(u,v),f(u),g(u)being polynomials withGCD(a,b,c)=1, andh(u,v)being a rational function.ProofThis follows directly from the above considerations when choosing the rational point(0,f(u),g(u))on the spherex2+y2+z2=f2(u)+g2(u), and the projection planeH:z=0. Since anyR(u)-rational parameterization of a curve inHcan be written as(a/c,b/c)we arrive to the statement of the theorem after a simple direct computation.  □Remark 5.11In addition, the choice of the polynomialsf(u)=0andg(u)=1, which provides a standard stereographic projection σ with the centrez(u)=(0,0,1)∈S, leads to the PN parameterizations from Pottmann (1995) as a special case.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
