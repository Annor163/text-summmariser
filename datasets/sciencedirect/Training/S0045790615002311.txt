@&#MAIN-TITLE@&#
A real-time control of photovoltaic water-pumping network

@&#HIGHLIGHTS@&#
A modeling and simulation of photovoltaic water-pumping network are affected.An energy management and a control strategy of the system are presented.A real time control of photovoltaic water-pumping network system is proposed.The optimization of the pumped water and the tanks regulation were ensured.An adequate maximum power-point tracker should be controlled.

@&#KEYPHRASES@&#
Photovoltaic energy,Water-pumping network,Speed-control,Fuzzy-logic controller,Water-level regulation,

@&#ABSTRACT@&#
In this paper a dynamic modeling, simulation, control and energy management of photovoltaic water-pumping network system is presented. A fuzzy-logic controller has been proposed for a real-time control of the system. The controller generates the reference speeds needed for the pulse-width-modulation generator to control each DC/DC boost converter taking into account the water levels in three tanks and the instantaneous value of the solar radiation. The main objectives of the fuzzy-logic controller are the design of an adequate maximum power-point tracker to extract the maximum power, regulate the water in the three tanks and finally ensure the correct operation for all the conversion strings in order to optimize the quantity of pumped water. The system performance under different scenarios has been checked carrying out Matlab/Simulink simulations using a practical load-demand profile and real weather data and comparing them to another control algorithm.photovoltaic panelideal factornormal operating cell temperaturerated voltageshort-circuit currenttemperature coefficient of ISCconstant of proportionality between G and IphphotocurrentPVP output voltageoptimal values Velectronic chargeBoltzmann’s constantcell temperaturePVP shunt resistanceoptimal values of Ireference of solar radiationtemperature coefficientstator voltagestator currentstator inductancerotor resistancemutual inductancemechanical speed of the machineelectromagnetic torquereference speed of motor ilevel of tank Ioutput flow of tank IDC link capacityband-gap energymaximum powerrated currentserial cellsopen circuit voltageparallel cellssolar radiationPVP output currentideality factorscell-reverse-saturation currentreverse-saturation currentPV array-series resistancecell-reference temperatureDC link voltageDC link capacitysaturation current for Trrotor voltagerotor currentrotor inductancestator resistancecoefficient of frictiontotal inertia of the machineload torqueduty cycle of DC inverter iinput flow of pump iDC link voltage

@&#INTRODUCTION@&#
Renewable energy sources have gained significant attention in the last decades due to the harmful effects of the fossil fuels on the environment and to the very high price of fuel energy.One of the most popular applications of renewable energy is water-pumping systems driven by electrical motors. The PhotoVoltaic (PV) energy presents the most important one for water pumping because of the strong relation between water needs and energy availability, especially in hot weather. Thus, the optimization of both using PV energy and controlling PV pumping systems has presented the object of a lot of researches.Many renewable energy sources, including PV, wind, solar-thermal, biomass sources and gas producer, can be used in water pumping systems [1–3]. Hence, a lot of scientific works have been interested in PV water-pumping systems. Some of them focused essentially on water-pump modeling [4,5]. Earlier reviews, reported in this area, highlighted the historical development of PV water-pumping control [5,6]. Some works have shed light on renewable energy sources with an auxiliary source, diesel engines [7] and a battery [8].Many works have been also developed in sizing PV water-pumping systems [9,10]. In [9] the authors presented a mathematical method of sizing PV water-pumping systems with more accuracy. The method took into consideration the calculation of hydraulic losses and the effect of temperature and solar radiation. Firstly the variation of power versus a hydraulic head for five different values of water flow was provided. Secondly, the effects of solar radiation and temperature on the power peak were investigated. The study concluded that a big variation in temperature had a negative effect on the solar panel leading to a lower-power production and an increase in solar radiation, which positively affected the system. In [10] the authors dealt with modeling and controlling a hybrid system, while integrating a PhotoVoltaic Panel (PVP) and batteries as an energy-storage system. In the first part, a description of the whole system and its sizing was given, based on the Deficiency of Power Supply Probability (DPSP), the Relative Excess Power Generated (REPG) for power reliability, the Total Net Present Cost (TNPC) and the Energy Cost (EC) for system costs. In the second part, modeling the three strings was presented. In the third part, specific focus was given to the new supervisory controller in order to coordinate the operation of energy sources fulfilling several functions.In [11] a PV water pumping converter and treatment systems without using storage elements was presented. The converter drove a three-phase induction motor directly from the PV solar energy. The PV energy was fed to the motor through a converter with two power stages, a DC/DC two-inductor boost-converter stage to boost the voltage of the panels and a DC/AC three-phase inverter to convert the DC voltage to a three-phase AC voltage.To extract the maximum power from the PVP, several works have been developed. In [12], an Maximum Power Point Tracker (MPPT) algorithm applied to a PV water-pumping system was presented. A cascade-sliding-mode control used the reference trajectories of the currents, the rotor flux and the speed to control an induction motor. A fuzzy logic MPPT was developed in [13]. The fuzzy controller generates a control signal for the pulse-width modulation generator which adjusts the duty ratio of the buck chopper to match the load impedance to the PV generator and consequently maximize the motor speed and the water discharge rate of a coupled centrifugal pump.In the present paper, a real time control of PV water-pumping network is developed. It is composed of one PV panel connected to three pumping motors, with three tanks. A fuzzy-logic controller is applied to control in real time the three-water-tank levels and the speeds of the three pumping motors based on solar radiation. Therefore, a proposal on how to determine the reference speed necessary for the control of the three DC motors is provided. The idea is to use a fuzzy-logic controller which aims to regulate the water levels in the three tanks by taking into consideration the sunshine state. The reference speed will be produced efficiently compared to calculated speeds. The suggested system is appropriate for rural communities because it is reliable, affordable and easy to maintain. It has three advantages. First, it optimizes the energy delivered by the PVP, since the powers of the three motors almost equalize the power delivered by the PVP. The goal is to minimize lost PV energy. Second, it minimizes the cost of the PV water-pumping network system, because the three systems of pumping motors are fed by only one PVP and are controlled by just one control system. Finally, it controls the three tanks in real time to offer water for the users.The paper is organized as follows. First, the system configuration is dealt with in Section 2. Next, the system component characteristics are displayed in Section 3. Then, Section 4 discusses the system controller. After that, Section 5 gives the simulation results. Finally, Section 6 concludes the paper.Fig. 1shows the system configuration for the proposed PV water-pumping network system. A system of three boost converters, three duty-cycle converters and three DC motors is used. Indeed, with the three motors, the used PV power can be optimized. Furthermore, the pumping motors can be operated in nominal power, which increases their efficiency. Besides, the use of a single pumping motor causes simultaneous problems for users in case there is a failure in the system. Another motivation behind the use of three converters and three duty cycle converters is related to the different motors’ control. In fact, this permits an independent control of motors from each other. Finally, we stress the fact that utilizing two or more motors is always possible and is related to the number of users. This may be done by an extension in the system and with some rules’ changing in the program. Recall that the energy delivered by the PVP depends on the solar radiation. If the solar radiation is low, the PV power will be low, and vice versa. In this system, a PVP of 1KW is used. This motivates the use of three 300-W DC motors. With this solution we can use one, two or three motors following the power delivered by the PVP. In contrast, if we use one 900-W motor, it will be operated in its nominal power, just in the case that the power delivered by the PVP is high. Then, as it is said previously, with three motors we can optimize the used PV power and operate the pumping motors in nominal power.The simulation requires the development of a mathematical model for each block of the system. Fig. 1 shows a block diagram of the proposed system, which consists of the following parts:•1kW PV panel with an MPPT controllerthree boost convertersthree duty-cycle invertersthree DC motorsthree-centrifugal-pump loadthree tanksa fuzzy-logic controller.Tables 1–3depict respectively the parameters of the PVP, the DC/DC converter and the DC motor.For convenience and completeness of the paper, we will explain below the modeling of the different parts of the PV pumping chain.The unit-sizing procedure discussed in this section is assumed for a stand-alone PV water-pumping network system with the structure suggested in Fig. 1 for an irrigation application. The purpose of the study is to properly measure the system components to assure reliable electricity supply and to minimize the PV energy losses. The PV water-pumping network system is designed to supply water to three irrigation places.To develop an overall control strategy for the performance of the PV water-pumping network system, the models of the main components have been developed using Matlab/Simulink. The models are developed for a PVP, a boost converter, a DC motor, a pump, and a tank.The PVP consists of a PV-cell photocurrent source Iph, a diode, a series resistance R, and a shunt resistance Rsh[14–16]. The equivalent circuit of the PV cell is given in Fig. 2.The output current to the load is given by:(1)I=Iph-Isexpq(V+IRs)kTA-1-V+IRsRshThe saturation current of the diodeIsis related to the temperature T as follows:(2)Is=IrrTTr3expqEGkqA1Tr-1TThe PV cell photocurrentIphdepends on the solar radiation and the cell temperature as:(3)Iph=Isc+ki(T-Tr)G1000The PVP power is then obtained as(4)P=IVThe control strategy with the PVP-power optimization is described below. The simplified model of a PV generator composed by Npand Nsparallel and series cells, respectively, is described thereafter [17,18]:(5)I=NpIph-NpIsexpAtVNs-1whereAt=qATkThe power of the chosen PVP is fixed at Pmax=1kW.The optimal power delivered by the generator is the product of the voltage V with the current I. At a maximum power point, we have:(6)d(VI)dI=0Applying a partial derivation, we get:(7)V+VdVdI=0From Eq. (5), we obtain:(8)expAtVNs=NpIph-I+NpIsNpIsThus, the terminal voltage of the generator based on the current output is:(9)V=NsAtlnNpIph-I+NpIsNpIsThe derivative of V, relative to I, gives:(10)dVdI=NsAt1NpIs-NpIsNpIph-I+NpIs=-NsAt(NpIs-I+NpIs)We have considered the optimal values Voptand Ioptof the current and voltage of the generator, respectively, corresponding to the maximum power point. By combining Eqs. (7), (9) and (10), we obtain:(11)lnNpIph-Iopt+NpIsNpIs-IoptNpIph-Iopt+NpIs=0Therefore, we obtain a linear relation yielding approximatedIoptas:(12)Iopt=0.94NpIphHence, the maximum power delivered by the PV generator taking into account the two Eqs. (9) and (12) is expressed as a function of illumination by:(13)Pmax=0.94NsNphAtGln0.06hG+IsIsThe boost converter has been inserted between the PV generator and the load. The boost DC–DC converter controlled by a tracking algorithm of the MPPT (duty cycle αi) provides the proper voltage to the load. The equivalent circuit for the boost converter [19,20] is shown in Fig. 3.The behavior of the boost converter can be captured by the following equations:Transistor T is onTransistor T is off(14)LdIdt=V(16)LdIdt=V-Vdc(15)CdVdcdt=Im(17)CdVdcdt=I+ImOver one switching period Ts, Eqs. (14)–(17) can be combined and represented as follows:(18)LdIdt=V+(α-1)Vdc(19)CdVdcdt=Im+(1-α)IThe model of DC motors reacts by the following electromagnetic equations [21,22]:(20)Vs=Rsis+Lsdisdt(21)Vr=Rrir+Lrdirdt-MsrisΩ(22)jdΩdt=Cem-Cr-fΩ(23)Cem=-MsrisirEach centrifugal pump applies a load torque proportional to the square of the rotor speed [10]:(24)Cri=KchiΩi2where Kchiis the proportionality constant.Given the performance of a centrifugal pump i (Qi, Liand P) with the speed Ni, the performance (Q′i, L′iand P′) for a speed N′ is evaluated as follows.(25)Qi′=QiNi′Ni;Li′=LiNi′Ni2;P′=PNi′Ni3where Qiand Qi′ correspond respectively to the flow speeds Niand Ni′, Liand Li′ are the total discharge heads corresponding respectively to the same flow speeds Niand Ni′, and P and P′ are the powers of the engine corresponding also to the speeds Niand Ni′.Qeiand Qsirepresent the water flow rate of the inputs and outputs of the three tanks. The flow Qeiis proportional to the speed of each DC motor and the flow rate Qsivaries according to the need of the user, so it is considered as a perturbation [10]. The schematic diagram of the water tank is given by Fig. 4below.The differential equation governing the liquid height in the tank, Li, is given by:(26)dVidt=SidLidt=Qei-Qsiwhere Viis the volume of liquid in the tank i and Siis the cross-sectional area of the tank i. The equation describes the height of liquid, h, as a function of time, due to the difference between the flow rates, Qeiand Qsistanding respectively for the input and output of the tank i. The level is sensed by a suitable sensor and converted to a signal acceptable to the controller.The principle of the fuzzy-logic controller consists in establishing a speed set, based on a measured water level of the three tanks Li, and the solar radiation G as inputs and the relative calculated speed Ωrefias an output. Fig. 5presents the fuzzy-logic architecture [23,24].In our application, we have elaborated the fuzzy inference carried out by using Mamdani’s method; whereas, the defuzzification uses the centroid method to compute the output of the fuzzy logic which is the reference speed (i=1, 2, 3).The determined fuzzy partitions lead to the calculation of the membership function considering the symmetric triangular, given in Fig. 6.The radiation G and the levels of the tanks Liare the inputs, and the reference speeds Ωrefiof the three pumping motors are the outputs.One basic issue here is the behavior of the whole system in case of fuzzy rules’ changing. In fact, it holds that the rules can be modified for two basic reasons. A change in the control strategy is already with conserving the system. For example, additional criteria such as priority may be given for the operation of the pumping system. A change in the system may be also applied to induce an increase or a decrease in the number of pumping stations, for example, or to induce a change of PV-panel power.The fuzzy-logic controller provides the speed reference for the motors according to the solar radiation and the water level in each tank. It is noticeable that each tank is equipped with a sensor to read the water level in it.An important conclusion based on our methodology is the fact that the users’ need for water can be time-wise satisfied. Furthermore, the applied methodology ensures the abundance of water instantaneously. Finally, it is also noticeable that the present methodology guarantees the fact that a possible abruption in one of the motors does not affect the others, which means the independence between the three pumping stations.The program developed with Matlab consists in establishing a set speed of each pumping motor, based on the measured water level of the three tanks and the solar radiation, as inputs, and the calculated reference speed, as an output. Fig. 7describes the algorithm flow chart of our approach.For each value of the solar radiation G, the fuzzy-logic controller reads the level state of the three tanks, L1, L2 and L3, and compares each level with the referenced levels Lm1, Lm2 and Lm3, which represent the maximum references of tank levels. Afterwards, the controller divides the power delivered by the PVP between the pumping motors with a water level lower than the referenced one. Finally, the controller determines the reference speed Ωrefifor the pumping motor. The relation between the solar radiation G and the reference speed Ωrefifor the three scenarios by using the curve fitting technique, as in [10], is given by (27)–(29) below.•Three operated motors, when the three tanks are not filled:•Two operated motors, when only one tank is filled:•One operated motor, when two tanks are filled:Using the component models, discussed in Section 3, and the control system, developed in Section 4, a simulation system test for the proposed PV water-pumping network system has been developed using MATLAB/Simulink. In order to verify the system performance under different situations, some simulation studies have been carried out using three practical pumping motors and real solar radiation. As discussed in Section 2, the system is designed to supply and control the water level of three PV water-pumping stations. This study consists in regulating the water level by using two controllers, a fuzzy controller and an algorithmic one, taking into account the solar-radiation variation as well as the water level in the three tanks. The evolution of the solar radiation for 12months of the year is provided in Fig. 8.To prove the efficiency of our proposed controller, a comparison to explicit the model algorithm based on Eqs. (27)–(29) has been conducted, using real data.To compare the performance of the two control strategies, we have calculated the daily maximum energy, which can be captured from the PVP with the two methods, regardless of the load consumption, by applying the value of the reference speed corresponding to the maximum output power (Fig. 9).It is clear from Fig. 9 that the fuzzy controller is the best one. Nevertheless, the energy gained with the fuzzy controller is about 88.5% of the real energy, and the energy gained with the algorithm controller is about 71.4%.A second valorization consists in determining the water level in the tank with both fuzzy and algorithmic controllers presented in Fig. 10. The level error with the two controllers is shown in Fig. 11.It can be clearly seen that the performance of the algorithmic controller is less significant than the fuzzy one. For that, some simulation results using it are given.As noticed previously, a modification in the methodology might induce a less stable system. For example, using the polynomial interpolations, stated in (27)–(29), has yielded a bad convergent model compared to the real state. Fig. 10 presents a non negligible error between the two curves. It shows also that the algorithmic controller converges asymptotically to a non real state due to polynomial interpolation.Table 4gives the error estimates due to the fuzzy-controller and algorithmic controller methods.By observing the different graphs of the water level, it is easily noted that the fuzzy controller shows an asymptotic convergence to the real state faster than the algorithmic one, which shows an important gap to the real state. This means that our methodology induces a more stable system than the algorithmic controller, thus proving also the performance and the efficiency of the proposed fuzzy system.To evaluate the performance of the suggested real-time control of the PV water-pumping network, some tests have been carried out using the fuzzy controller. The simulations are carried out for the PV water-pumping network during four hours of measured solar radiation of Sousse city in TUNISIA. Fig. 12gives the variation of the solar radiation.Figs. 13–16show the test results for the control system of the PV water-pumping network with a fuzzy controller.Fig. 13 presents the variation of the water flow Qeiof the three pumping motors during the day. Fig. 14 shows the variation of the water flow Qsiof the three tanks during the day, which represents the output-water flow consumed by the users. Fig. 15 represents the evolution of the real and reference speed of the three pumping motors. Fig. 16 shows the variation of the water levels of the three tanks during four hours of a summer day.The system has been controlled by a real-time control strategy based on the fuzzy logic proposed in this paper.The water level reaches its reference value (Hrefi=1m) without any error and without any overshoot, as shown in Fig. 16. Even if there is a disturbance Qsi, the water level will decrease, then it will return to its reference value.The speed takes different values depending on the solar radiation value and according to the state of the water level in the three tanks, (Fig. 16) while ensuring operation at a maximum power.In the first period (11:00–11:50), the water level of the three tanks was very low (Fig. 16), the solar radiation was very high (>700W/m2) (Fig. 12), the control system gave the order to the three pumping motors to pump the water, the speed motors of the three tanks rose (Fig. 15), and the flows of the three pumping motors Qeiincreased (Fig. 13).In the other periods, when the flows Qsiincrease (Fig. 14), the Lilevel of the tank i decreases, then the motor Wrefispeed of the tank i increases for pumping the water to the tank i. The synchronization between the levels of the three tanks Liand the pumping motor speed Wrefiand the similarity between the measured and the reference speed show the performance of the proposed controller.

@&#CONCLUSIONS@&#
