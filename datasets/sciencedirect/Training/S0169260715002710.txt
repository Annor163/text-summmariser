@&#MAIN-TITLE@&#
Detection of eye blink artifacts from single prefrontal channel electroencephalogram

@&#HIGHLIGHTS@&#
A novel method to detect eye blink artifacts from a single-channel frontal EEG signal was proposed.Overall accuracy of detecting epochs contaminated by eye blink artifacts was markedly increased.An online experiment showed that our method is useful for headband-type wearable EEG applications.A MATLAB package of our library and sample data is open for free download.

@&#KEYPHRASES@&#
Electroencephalogram (EEG),Electrooculogram (EOG),Artifact detection,Eye blink,

@&#ABSTRACT@&#
Eye blinks are one of the most influential artifact sources in electroencephalogram (EEG) recorded from frontal channels, and thereby detecting and rejecting eye blink artifacts is regarded as an essential procedure for improving the quality of EEG data. In this paper, a novel method to detect eye blink artifacts from a single-channel frontal EEG signal was proposed by combining digital filters with a rule-based decision system, and its performance was validated using an EEG dataset recorded from 24 healthy participants. The proposed method has two main advantages over the conventional methods. First, it uses single-channel EEG data without the need for electrooculogram references. Therefore, this method could be particularly useful in brain–computer interface applications using headband-type wearable EEG devices with a few frontal EEG channels. Second, this method could estimate the ranges of eye blink artifacts accurately. Our experimental results demonstrated that the artifact range estimated using our method was more accurate than that from the conventional methods, and thus, the overall accuracy of detecting epochs contaminated by eye blink artifacts was markedly increased as compared to conventional methods. The MATLAB package of our library source codes and sample data, named Eyeblink Master, is open for free download.

@&#INTRODUCTION@&#
Eye blinks are one of the most influential sources of artifacts contaminating electroencephalogram (EEG) signals [1–3]. It has been known that eye blinks can easily distort EEG signals, leading to inaccurate topographical maps [4]. Because of the high influence of eye blink artifacts on frontal channel EEG signals, removing eye blink artifacts is regarded as a common and essential preprocessing procedure in EEG studies [3,5,6]. Although theta band is distorted most severely when an EEG signal is contaminated by eye blink artifacts, eye blink artifacts have also been reported to significantly affect alpha and beta band EEG signals [3].The easiest way to detect eye blink artifacts is simply using a predetermined amplitude threshold [7]. This method classifies an EEG epoch as being artifact contaminated if a portion of the EEG or electrooculogram (EOG) signals in this epoch exceeds an amplitude (or power) threshold. This method is generally applicable to raw, time-domain EEG signals, but it can also be applied to frequency-domain signals [8]. The high simplicity of this method is obviously one of its main advantages. This method is particularly useful when high accuracy is not necessarily required [9], or when source EEG data are abundant and thus rejecting a number of contaminated epochs does not cause any critical problems with the main EEG analysis [10]. One of the major limitations of this method is the low accuracy of “epoch-based” artifact rejection, especially when the peak of the eye blink artifact is not included within an epoch [10]. That is to say, when only part of the eye blink artifact is included in an epoch under consideration, it is generally difficult to accurately determine whether the epoch actually includes a portion of an eye blink artifact, because the artifact contamination cannot be detected when the maximum amplitude of the artifact in an epoch is lower than the threshold value. Moreover, this method has difficulty extracting the range of the eye blink artifacts due to variances in eye blink duration [11]. There have been other methods proposed to detect epochs contaminated by eye blink artifacts, such as probability distribution and kurtosis [12], correlation between EEG signals of selected channels [13], and artificial neural networks [14]. However, since these methods also determine whether an epoch includes eye blink artifacts (referred to as epoch-unit-based detection in this paper), they have the same limitations as the amplitude thresholding method, such as difficulty in detecting eye blink artifacts when only part of the artifact is included in a given epoch.Removing artifacts without dividing signals into epochs by utilizing blind source separation methods [1] such as independent component analysis (ICA) [6,8,15] is an alternative approach that can circumvent the limitations of the conventional artifact detection methods described above. The artifacts could be removed from the contaminated EEG signals successfully by excluding the artifact components before re-mixing the decomposed signal [1,16,17]. However, ICA generally requires EEG signals recorded from many channels because of its intrinsic characteristics [18], which make it extremely difficult to remove independent components including artifacts accurately when only a few EEG signals are available.Recording EEG data from many channels may not be an important issue in a laboratory or clinical environment, where there are high-end EEG recording devices with a large number of channels and well-motivated participants who have agreed to participate in experiments with long durations. Recently, however, the advancement of modern sensors and wireless technology is expediting the development of novel applications of EEG that do not necessarily require a laboratory setting, such as measuring the brain activity of healthy persons during daily life, at work or during specific cognitive/emotional tasks [19–22]. Since these EEG applications commonly require wireless EEG recording devices that are easy to wear and comfortable for long-term use, headband-type or headset-type EEG devices with a few electrodes covering only the prefrontal area of the brain has been often preferred in many studies [23–28]. It is also noteworthy that simple system setup is becoming an important issue in recent brain–computer interface studies [29,30]. These types of portable EEG recording devices are not only inherently prone to eye blink artifacts, but also generally do not have an EOG channel that can be employed as a useful artifact indicator; thus, the accurate detection and rejection of eye blink artifacts is of great importance.In the present study, we propose a novel method to detect eye-blink-related waves precisely from a single frontal-channel EEG signal, which can potentially be applied to a variety of daily-life EEG applications. The proposed method was based on the combination of digital filters and a rule-based decision system. The digital filters were adopted to emphasize waves with specific wave-widths, and the rule-based decision system was developed to recognize eye blinks and to determine the ranges of the blinks. The proposed method is unique in two aspects: first, it uses a single EEG channel without EOG reference, and second, it can accurately estimate the extent of artifact ranges in continuous (online) EEG data. In the following sections, we describe the mathematical details of the proposed method and our procedure for validating it using an EEG dataset acquired from 24 healthy participants while they were performing a specific cognitive task.An eye blink artifact is formed with a gradual increase and decrease generally within 100 and 500ms [11,31–33], whereas the EEG signals cover wider frequency ranges (0.5–50Hz and above) [34,35] (see the first figure in Fig. 1for a schematic representation of a contaminated EEG signal). When a sliding window is set to be large enough to cover multiple ripples of an EEG waveform, as shown in Fig. 1, the summation of the first-order derivatives of the raw signal within the sliding window will filter out the ripples. When the sliding window size is set to be approximately half the width of the target eye blink wave and the window slides along the time axis, the filter output (the summation of the first-order derivatives within a sliding window) can distinctly extract the presence of the target wave while suppressing other ripples with smaller periods than the target wave, as depicted in Fig. 1.A function F(t) representing the “first derivative sum” at a time t can be written as(1)F(t)=∑k=t−n+1tS(k)−S(k−1),where n is the width of the sliding window and S(k) is the kth sample of the original signal. From now on, let us call this function SDW, denoting the summation of first derivatives within a window. The equation of SDW can be regarded as a kind of the two-point central difference algorithm [36], which was developed to calculate first order derivative in a digital signal.As shown in Fig. 1, SDW has maximum and minimum values at the peak point and the last point of the eye blink artifact, respectively, when the size of sliding window is assumed to be half of the artifact width. Therefore, the presence of an eye blink artifact can be determined by comparing the difference between a local minimum and the local maximum that directly precedes it with a predetermined threshold. When Miniis the ith local minimum value of an SDW time series and Maxiis the local maximum value preceding Mini, the time range of the artifact, R, can be estimated by(2)R={[T(Maxi)−|W|,T(Mini)]|Maxi−Mini>θ}where |W| is the size of the sliding window, θ is a predetermined threshold, and T(Maxi) and T(Mini) are the time points of the ith local maximum and minimum, respectively.Theoretically, the ranges of the artifacts can be estimated perfectly if the size of the sliding window is set to exactly half the target-wave range and the shape of the artifacts is assumed to be a triangular pulse shape, as shown in Fig. 1. In practice, however, there is wide variation in the ranges of the artifacts even in data from the same participant. Moreover, the artifacts often have irregular forms different from that shown in Fig. 1, which causes severe variation in the results of SDW. Fig. 2shows the influence of the sliding window size on the resultant SDW when a variety of artifacts with various sizes and shapes are assumed to be included in the source EEG data. The data used for this simulation were generated by adding artificial artifacts to a background ripple signal with a relatively higher frequency and smaller amplitude than those of the artifacts. The first five artificial artifacts had a regular shape (triangular pulse shape), but had different widths ranging from 62.5 to 312.5s (4, 8, 12, 16, and 20 points with the 64-Hz sampling rate). The last artificial artifact was assumed to include two closely located peaks, because similar shapes are frequently observed in practical EEG data (see Fig. 3for an example).In this preliminary test, the ideal SDW waveforms (as shown in Fig. 1) were observed only when the window size |W| was set to be the same as the half-width of the artifact and the shape of the artifact was assumed to be a single triangular pulse. From the simulation results, it could be readily observed that the local maximum in the SDW waveform is maximized when the window size becomes the same as the half-width of the artifact. Based on this finding, we developed an empirical procedure to determine the optimal window size for calculating SDW at time t. The detailed steps are given below:1.For each time point, calculate SDWs with different sliding window sizes ranging from m to M, where m and M are the minimum and maximum lengths, respectively, of the window sizes to be tested. Let F|W| denote an SDW with a window size of |W|.Choose the F|W| having the maximum value at time t and satisfying the following conditions, and denote it as RF(t):a.The numbers of local minimum and maximum within the range, t and t−|W|, should be the same.All the first derivatives between times t and t−|W|+1 should be placed within a range between S′(t−|W|+1) and S′(t), where S′(t) represents the first derivative of the original signal at time t.If the above conditions are not met, F|m| is chosen.If the maximum value of F|W| is obtained at multiple values of |W|, the smallest |W| is selected.The above process is repeatedly applied for every t, and the selected window size at a time t is denoted by |WRF(t)|.For the artifacts with irregular forms, the resultant SDW waveforms show multiple local maxima and local minima for a single artifact, as shown in Fig. 2. Therefore, there can be multiple maxima before the ith local minimum point. To consider this, the time range of the artifact was redefined as(3)R={[T(Maxi−j)−|WRF(T(Maxi−j))|,T(Mini)|Maxi−j−Mini>θ]}where j is an integer that maximizes Maxi−j−Minisubject to j≥0 and T(Maxi−j)−T(Mini)≤M, where T(Maxi) and T(Mini) are the time points of the ith local maximum and minimum, respectively. Any j is rejected if the range[T(Maxi−j)−|WRF(T(Maxi−j))|,T(Mini)]partially overlaps another range. If a range is fully included in another range, the included range is discarded. For more comprehensive understanding of our procedure, please download the library source codes freely downloadable at http://cone.hanyang.ac.kr/BioEST/Eng/EyeblinkMaster.zip.To evaluate the performance of the proposed method quantitatively, the amplitude thresholding method that has been widely used in EEG preprocessing [37–42] was implemented. This method simply classifies a signal epoch as being contaminated if it contains values over a certain threshold. The threshold was used as a variable in the experiments for the comprehensive evaluation of the method. We applied a bandpass filter (Butterworth, first order) with 2- and 10-Hz cutoffs to enhance the accuracy of the amplitude thresholding method. The type, order, and cutoff frequencies of the filter were determined empirically.The template matching method is a widely used method to detect specific patterns contained in a signal. We used a general implementation of the method [43] for comparison, with different dissimilarity metrics: correlation [44], root-mean-square error (RMSE), and dynamic time warping (DTW) [9].The process of the template matching method used in this study is given below:1.At each sampling point, calculate dissimilarity between a predetermined template and a subsequence of EEG signal which starts at the point. The length of the subsequence is set to be the same as that of the template. A sequence of dissimilarity can be obtained as the results.Find all local minima of the dissimilarity sequence. The subsequences around the minima are regarded as candidates of time interval including eye blink artifacts.Classify the candidates as eye blink artifacts if their corresponding minima are smaller than a threshold.One of the limitations of template matching is that its accuracy is highly dependent on the template selection. Though templates can be selected manually by an expert or generated automatically by an automated system, we selected templates which yielded the best accuracy in our previous study [43]. Please note the best templates were selected individually for each method.To verify the proposed method, EEG data acquired from 24 participants (eighteen males and six females) [43], aged between 22 and 31, were used. The data were collected using an ActiveTwo™ system (BioSemi, Netherlands) at a sampling rate of 2048Hz. During the data collection, the participants performed ‘spot-the-difference’ tasks, which was to find differences between two horizontally aligned images in 15s. This was repeated ten times with 15s interval for each participants. Data obtained at three channels were used for this study. The channels were Fp1, Fp2, and EOGv that was placed below right eye. Because we used active electrodes, electrode impedances could not be measured [45]. A common mode sense (CMS) and driven right leg (DRL) electrode loop were served as ground and reference, respectively, where the both CMS and DRL were placed to the closest approximation of a POz electrode (the CMS was placed between POz and PO3, the DRL was placed between POz and PO4).Before the data acquisition, a comprehensive summary of the experimental procedures and protocols were explained to each participant. All participants signed a consent form and received monetary reimbursement for their participation. The study was approved by the institutional review board (IRB) committee of Hanyang University. A total of 8099s of data (including data obtained before and after the task) acquired from 24 participants was used to compare the performance of different eye blink artifact detection algorithms. Among two prefrontal channels (Fp1 and Fp2), only Fp2 channel was used in this study because the artifacts observed in both channels showed very similar shapes (see Fig. 4).The collected EEG data were high-pass filtered at 0.1Hz (Butterworth, first order), downsampled into 64Hz to reduce the amount of data, and median filtered to smooth out tiny waves. We used a width-5 median mask for this purpose, which means the median filter had a width of about 7.81ms.A ground truth (or gold standard) dataset had been constructed by two independent researchers before the development of algorithms (the same dataset was already used in [43]). Eye blink regions in this dataset were marked according to the literature [11,31,32,46,47] based on both the Fp2 data and the vertical electrooculogram (EOGv) signals recorded from an electrode attached below a right eye. The criteria to determine that a wave was an eye blink artifact were as follows:1.A positive sharp wave over 50μV during 100–500ms in Fp2,A negative wave peak on EOGv within the range of the wave in Fp2, andA gradual increase and decrease from the starting point to the top of the peak and from the top to the end point, respectively.In some cases, it was difficult to determine whether an artifact originated from an eye blink or not; such patterns were classified as ambiguous artifacts (e.g., those with very long durations, and those with different timings or patterns between Fp2 and EOGv). Ambiguous artifacts were ignored irrespective of whether a method detected them as an eye blink artifact or not, so that they would not influence the accuracy calculations. The ground truth dataset had been constructed before the proposed method was developed, and thus the dataset was not biased at all.

@&#CONCLUSIONS@&#
