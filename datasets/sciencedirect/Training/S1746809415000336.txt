@&#MAIN-TITLE@&#
Orthogonal Golay excitation for range side lobe elimination in dual-frequency harmonic imaging

@&#HIGHLIGHTS@&#
Dual-frequency harmonic imaging benefits from improvement of SNR by Golay excitation.Conventional Golay decoding suffers from spectral crosstalk with 3f0 and DC interferences.For orthogonal Golay, the output of exchanged filtering can be subtracted from that of the original filtering to remove the crosstalk.Results demonstrate the reduction of range side lobe level in both hydrophone measurement and B-mode imaging.

@&#KEYPHRASES@&#
Tissue harmonic imaging,Dual-frequency,Golay excitation,Orthogonal pair,Range side lobe level,

@&#ABSTRACT@&#
Dual-frequency (DF) tissue harmonic imaging has been developed to take advantage of not only harmonic signal at second harmonic (2f0) frequency but also the inter-modulation harmonic signal at fundamental (f0) frequency for simultaneous nonlinear detection. Though phase-encoded Golay pair can improve the signal-to-noise ratio of DF harmonic signal at both f0 and 2f0 frequencies, conventional matched filtering cannot correctly decode the crosstalk from harmonic components at DC and third harmonic (3f0) frequency and will lead to range side lobe artifacts in DF harmonic imaging. For orthogonal Golay pair, however, exchanging the decoding filter will output zero for the signal and keep the crosstalk the same. Therefore, the output of exchanged filtering can be subtracted from that of the original matched filtering to completely remove the spectral crosstalk. Compared to phase inversion method, the proposed orthogonal Golay decoding does not require additional transmits to cancel the unwanted DC and 3f0 harmonic interferences and thus the achievable frame rate remains the same. Various experiments have been performed to verify the efficacy of the proposed orthogonal Golay decoding. Results from hydrophone measurements indicate that the proposed method effectively suppresses the spectral overlap between the harmonic signal and the interference. Corresponding range side lobe level (RSLL) can be suppressed by 10–20dB when the signal bandwidth is 60%. B-mode harmonic imaging also demonstrates a reduction of side lobe magnitude (SLM) by 8dB at 2f0 frequencies.

@&#INTRODUCTION@&#
Conventionally, tissue harmonic imaging relies on the received nonlinear signal at second harmonic (2f0) frequency to construct the image and thus only the transmission at fundamental (f0) frequency is required [1,2]. Since both transmission and reception are single-frequency (SF), the conventional method does not fully exploit the available system bandwidth. In order to fully utilize the system bandwidth, dual-frequency (DF) harmonic imaging has been proposed to provide simultaneous nonlinear detection of imaged objects at two distinct frequencies [3–5]. DF transmit waveform comprises of both f0 and 2f0 components to produce not only the self coupling of the f0 component but also the mutual coupling between the f0 and 2f0 components. Consequently, the received harmonic signal for DF imaging contains both the second harmonic component at 2f0 frequency and the inter-modulation component at f0 frequency. Since the two harmonic components are simultaneously available, they can be further spectrally compounded to improve the image contrast. Specifically, the spectral compounding is performed by combining the original 2f0 harmonic signal envelope with the additional f0 harmonic signal envelope to smooth the speckle variation. Note that the DF harmonic image with spectral compounding will have the same axial resolution as the SF counterpart [5].However, DF harmonic imaging still suffers from the intrinsic limitation of low signal-to-noise ratio (SNR). By utilizing elongated transmit waveform with low transmit amplitude, coded excitation delivers more acoustic energy into tissue to boost harmonic generation while still complying with safety regulations on acoustic output [6–10]. When the echoes from elongated transmit are received, a decoding filter is used to compress the acoustic energy into a short time interval to restore the axial resolution. For frequency encoding, the frequency-modulated waveform comprising of a sinusoid with sweeping instantaneous frequency such as the chirp waveform is commonly adopted. For phase encoding, on the other hand, the phase modulation is performed by changing the phase in a binary bit sequence such as in the Barker sequence and the Golay sequence. Among these phase codes, the Golay sequence can provide complete elimination of the range side lobes after compression by using a pair of complementary code [6]. Therefore, the Golay sequence is selected as an example of phase-encoded waveform in this study.As indicated in Eq. (1), a pair of N-bit binary sequences A(n) and B(n) (n=1,…,N) is complementary Golay when the sum of their respective matched filtering is a delta function with 2N magnitude:(1)A(n)*A(−n)+B(n)*B(−n)=2Nδ(n)where * represents the convolution, N is the number of bits and δ(n) represents the delta function. Eq. (1) also indicates that the N-bit Golay sequence can be temporally compressed to a 1-bit delta function without the presence of any range side lobe in ultrasound imaging. For a 2-bit Golay, the decoding process can be schematically illustrated in Fig. 1(a) with A=[1 −1] and B=[−1 −1]. Note that the 2-bit Golay sequences are also orthogonal to each other. Specifically, when the decoding filters for the A and B sequence in Eq. (1) are exchanged, the sum of their respective filtering is zero as shown in Fig. 1(b):(2)A(n)*B(−n)+B(n)*A(−n)=0For any pair of sequence satisfying both Eqs. (1) and (2), it is referred to as the orthogonal Golay pair. In this study, the orthogonal property of Golay pair is utilized to suppress the range side lobe artifacts from potential spectral crosstalk in DF harmonic imaging. It should be noted that, when the imaged object moves, the range side lobes of the Golay pair are no longer completely canceled in Eq. (1) and the orthogonal property in Eq. (2) is also compromised. This may produce side lobe artifacts that blur the image. Therefore, application of Golay excitation is generally limited to quasi-stationary tissue in ultrasound imaging [11]. Otherwise, motion compensation may be required to alleviate the range side lobe artifacts at the cost of extensive computation [12].In DF harmonic imaging, the transmit waveform comprises the f0 and 2f0 transmit components:(3)x(t)=[cos(2πf0t+(θ1))+cos(2π(2f0)t+(θ2))]In Eq. (3), θ1 and θ2 are the transmit phases at f0 frequency and 2f0 frequency, respectively. Generally, the f0 component is allocated in the lower side band of the transducer while the 2f0 component is in the upper side band to provide adequate sensitivity at both frequencies. As in Eq. (4), the resultant second-order harmonic signal can be modeled by the square of the transmit waveform [13,14]:(4)x2(t)=1+cos(2πf0t+(θ2−θ1))+12cos(2π(2f0)t+2θ1)+cos(2π(3f0)t+(θ1+θ2))+⋯Eq. (4) shows that the harmonic components are generated at the sum and difference frequencies of the original transmit components when the transmit components nonlinearly coupled by multiplication. Therefore, harmonic components are present not only at f0 and 2f0 frequencies but also at DC and 3f0 frequencies. Nonetheless, due to the limitation of transducer's bandwidth, only the f0 harmonic component and the 2f0 harmonic component are utilized for DF harmonic imaging.Note that the phase of the inter-modulation harmonic component at f0 frequency is encoded as (θ2−θ1) and that of the second harmonic component at 2f0 frequency is encoded as 2θ1. In order to correctly encode both harmonic components at f0 and 2f0 frequencies as the [1 −1] and [−1 −1] pair, the transmit phases θ1 and θ2 have to be simultaneously designed. Note that the “1” bit and the “−1” bit respectively correspond to a phase of zero and π. Similarly, the “j” bit and the “−j” bit represent a phase of π/2 and −π/2. For example, the f0 transmit sequence has to be encoded as [1 j] and [j j] pair in order to produce the Golay encoding of [1 −1] and [−1 −1] pair for the 2f0 second harmonic component. This is because the transmit of “j” bit at f0 frequency (i.e., θ1=π/2 in Eq. (3)) will lead to the “−1” bit of the second harmonic component at 2f0 frequency (i.e., 2θ1=π in Eq. (4)). Meanwhile, the 2f0 transmit sequence should be simultaneously encoded as [1 −j] and [−j −j] pair in order to produce the same Golay pair for the inter-modulation harmonic component at f0 frequency. This is also because the simultaneous transmission of the 2f0 component of “−j” bit and the f0 component of “j” bit (i.e., θ2=−π/2 and θ1=π/2 in Eq. (3)) will encode the inter-modulation harmonic component at f0 frequency to be the “−1” bit (i.e., θ2−θ1=π in Eq. (4)). Table 1summarizes the phase encoding of the DF transmit components and the resultant second-order harmonic components. Note that the harmonic components at both f0 and 2f0 frequencies have been simultaneously Golay encoded as [1 −1] and [−1 −1] pair.Table 1 also shows that the DC and 3f0 harmonic components are erroneously encoded as [1 1] and [1 1] pair and the corresponding range side lobe will be generated during the decoding process. As indicated in Eq. (1), Golay decoding is implemented by matched filtering and then complementary summation. Consequently, when the [1 1] and [1 1] pair is processed by the matched filter of [1 −1] and [−1 −1] pair, the filter output respectively becomes the [−1 0 1] and [−1 −2 −1]. Note that the summation of these filter outputs is [−2 −2 0] and it corresponds to a range side lobe in front of the main lobe. This is schematically demonstrated in Fig. 2(a). The DC and 3f0 harmonic components may respectively interfere with the inter-modulation harmonic component at f0 frequency and the second harmonic component at 2f0 frequency, particularly when the signal bandwidth is wide enough to produce spectral overlap. Therefore, the DC and 3f0 harmonic components are actually the source of interference and should be eliminated. For clarity, the DC and 3f0 harmonic components are referred to as the DC interference and the 3f0 interference in the following of this paper.As indicated in Eq. (2) and Fig. 1(b), exchanging the decoding filters for the orthogonal A and B sequence will output zero in the complementary sum. Since the f0 and 2f0 harmonic components in Table 1 have been correctly encoded as the 2-bit orthogonal Golay of [1 −1] and [−1 −1] pair, it is expected that the f0 and 2f0 harmonic components will become [0 0 0] in the complementary sum of the exchanged filtering. On the contrary, for the DC and 3f0 interferences, the exchanged filtering will have the same output as the matched filtering because they are always encoded as [1 1] for either A or B sequence. As shown in Fig. 2(b), when the [1 1] and [1 1] pair is processed by the exchanged filter of [−1 −1] and [1 −1] pair, the filter output respectively becomes the [−1 −2 −1] and [−1 0 1]. Note that the summation of the exchanged filter outputs is also [−2 −2 0] in Fig. 2(b), which is the same as that of the matched filter outputs in Fig. 2(a). To eliminate the DC and 3f0 interferences in the decoding process, the output of exchanged filtering can be subtracted from that of the matched filtering. For the f0 and 2f0 harmonic components, on the other hand, the summation of the exchanged filter outputs is [0 0 0] in Fig. 1(b) while the summation of the matched filter outputs is [0 4 0]. Therefore, the f0 and 2f0 harmonic components in the subtraction remain correctly decoded as [0 4 0] but now without the presence of DC and 3f0 interferences. Fig. 3demonstrates the proposed decoding process of the orthogonal Golay encoded DF harmonic signals. Before decoding, the f0 and 2f0 harmonic components cannot be spectrally separated from the DC and 3f0 interferences. In the first step of decoding, the harmonic signals of the A and B sequences are respectively processed by the matched filtering and the exchanged filtering in parallel. Then, in the second step of decoding, the summation of the exchanged filter outputs is subtracted from that of the matched filter outputs to remove the unwanted DC and 3f0 interferences from the desired f0 and 2f0 harmonic components.For clarity, the subtraction of the exchanged filtering from the matched filtering is referred to as the orthogonal Golay decoding in this study. For comparison, the matched filtering is referred to as the original Golay decoding. By taking advantage of the orthogonal property of 2-bit Golay sequences, the proposed orthogonal Golay decoding does not require any additional transmit events to achieve the interference cancelation. In other words, the frame rate can be exactly the same when the decoding is switched from the original scheme to the orthogonal scheme. Therefore, it is expected that the proposed orthogonal decoding may outperform the method of range side lobe inversion [15] in terms of temporal resolution.Hydrophone measurements are first performed to validate the efficacy of orthogonal Golay decoding. The experimental system for hydrophone measurements comprises one 3.5-MHz single-element transmit transducer with a −6-dB fractional bandwidth of 80% (Panametrics V380, Waltham, MA, U.S.A.) and one calibrated PVDF needle hydrophone (Force Technology, MH28-6, Brøndby, Denmark) in a water tank. The Golay sequences are generated by an arbitrary function generator (model 2571, Tabor Electronics, Tel Hanan, Israel) with f0 frequency at 2.25MHz and 2f0 frequency at 4.5MHz. The waveform is amplified by a broadband 50-dB RF power amplifier (ENI 350LA, Rochester, NY, U.S.A.) to drive the transmit transducer. The received signal is sent to an ultrasonic receiver (Panametrics PR5072, Waltham, MA, U.S.A.) to remove noises by filtering and then digitized by an analog-to-digital card (model PCI-9820, Adlink, Taipei, Taiwan). The noise removal is performed by low-pass filtering with a cut-off frequency of 10MHz and high-pass filtering with a cut-off frequency of 1MHz. To extract the second-order harmonic signals, the PI technique is performed by transmitting a pair of inverted waveforms and summing the corresponding echoes. The extracted harmonic signals are then processed by the proposed orthogonal decoding in Fig. 3 to eliminate the DC and 3f0 interferences and then demodulated to acquire the signal envelopes at f0 and 2f0 frequency bands.For B-mode harmonic imaging, the pulse-echo configuration is utilized and the echoes are received by the same transmit transducer. The imaged object is an agar speckle-generating phantom with uniform distribution of glass bead powder (Sigma G4649, St. Louis, MO, USA). An anechoic tubular void with diameter of about 9mm is fabricated inside the phantom for comparison of range side lobe artifact.

@&#CONCLUSIONS@&#
