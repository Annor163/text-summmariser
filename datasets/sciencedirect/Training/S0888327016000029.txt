@&#MAIN-TITLE@&#
Control-based continuation: Bifurcation and stability analysis for physical experiments

@&#HIGHLIGHTS@&#
We outline the control-based continuation method.We propose a new method for calculating the stability of the periodic orbits.We apply this method to a nonlinear experiment.

@&#KEYPHRASES@&#
Numerical continuation,Bifurcation theory,System identification,Feedback control,

@&#ABSTRACT@&#
Control-based continuation is technique for tracking the solutions and bifurcations of nonlinear experiments. The idea is to apply the method of numerical continuation to a feedback-controlled physical experiment such that the control becomes non-invasive. Since in an experiment it is not (generally) possible to set the state of the system directly, the control target becomes a proxy for the state. Control-based continuation enables the systematic investigation of the bifurcation structure of a physical system, much like if it was numerical model. However, stability information (and hence bifurcation detection and classification) is not readily available due to the presence of stabilising feedback control. This paper uses a periodic auto-regressive model with exogenous inputs (ARX) to approximate the time-varying linearisation of the experiment around a particular periodic orbit, thus providing the missing stability information. This method is demonstrated using a physical nonlinear tuned mass damper.

@&#INTRODUCTION@&#
Control-based continuation is a systematic method for performing bifurcation studies on physical experiments. Based on modern feedback control schemes it enables dynamical phenomena to be detected and tracked as system parameters are varied in a similar manner to how nonlinear numerical models can be investigated using numerical continuation. Control-based continuation was originally developed as an extension to Pyragas׳ time-delayed feedback control [1–3] to make it more robust and suitable for parameter studies [4], though its current implementation contains no elements of time-delayed feedback.The use of feedback control for the investigation of nonlinear systems is not new; in addition to time-delayed feedback, methods such as OGY control [5] have previously been employed to provide non-invasive control to stabilise unstable orbits and investigate dynamical phenomena. Indeed, previous authors have gone as far as to implement such control schemes within parameter continuation studies to numerically simulate particular experiments such as atomic force microscopes [6] or reaction kinetics [7]. Control-based continuation goes beyond these particular methods to allow the use of almost any feedback control scheme and, as such, it is a general purpose tool applicable to a wide range of physical experiments.Control-based continuation has been successfully applied to a range of experiments including a parametrically excited pendulum [8], nonlinear energy harvesters [9,10] and a bilinear oscillator [11,12]. In each case, periodic orbits have been tracked through instabilities such as saddle-node bifurcations (folds) thus revealing a great deal of dynamical information about the system in question, including the location of a codimension-2 cusp bifurcation in one case [13]. As well as bifurcations, other dynamic features such as backbone curves can also be tracked with control-based continuation [14].Although the basic scheme for control-based continuation is well established (an overview is provided in Section 2), it lacks many of the features of standard numerical continuation schemes such as bifurcation detection. Only saddle-node bifurcations (folds) can be detected readily and that is because they are geometric features in the solution surface. Bifurcations such as period-doubling bifurcations are not geometric features and can go undetected due to the stabilising affect of the feedback controller. Similarly, the inclusion of the feedback controller means that methods for calculating eigenvalues/Floquet multipliers and basins of attraction from experiments such as [15–17] are not helpful since they indicate the stability of the closed-loop system rather than the open-loop system.In this paper we consider only periodically forced systems and hence study periodic orbits, though there is no reason that the methods developed should not be applicable to autonomous systems as well. In Section 3, we propose a method for calculating the stability (the Floquet multipliers and associated stable and unstable eigendirections) based on the estimation of a local linearisation around a stabilised periodic orbit. We demonstrate the effectiveness of this method in Sections 4 and 5 by applying it to a (physical) nonlinear mass–spring–damper system where the nonlinearity is geometric in nature—the springs are mounted perpendicular to the direction of motion.Numerical continuation is a path following method used to track solution branches as parameters of the system in question are varied. In a nonlinear system, these solution branches can encounter bifurcations at particular parameter values which results in a qualitative change in the dynamics of the system. Numerical continuation enables these bifurcations to be detected and tracked in turn. It is typically applied to differential equation models but it can be used more widely, for example on finite element models.At a basic level, numerical continuation tracks the solutions of an arbitrary nonlinear function, a zero problem given by(1)f(x,λ)=0,f:Rn×Rp→Rmwhere x is the system state and λ is the system parameter(s). A common example of this is tracking the equilibria of an ordinary differential equation with respect to a single parameter. In this case n = m and p = 1 in Eq. (1), that is, f=0 defines a one-dimensional curve. Alternatively the function f can arise from the discretisation of a periodic orbit. Numerical continuation works in a predictor-corrector fashion; at each step a new solutionx˜is predicted from previously determined solutions and then the solution is corrected using a nonlinear root finder applied to the function f (typically a Newton iteration). The use of a nonlinear root finder means that the stability or instability of solutions is unimportant. In certain circumstances (for example, near a fold or saddle-node bifurcation) the function f must be augmented with an additional equation—the pseudo-arclength equation—which enables the numerical continuation scheme to track solution curves that double back on themselves. In these circumstances, without the pseudo-arclength equation the correction step for a fixed set of parameter values λ will fail since no solution exists. For extensive information and guidance on numerical continuation see the textbooks [18,19]. Numerical software is also readily available in the form of CoCo[20] and AUTO [21] amongst others.Control-based continuation is a means for defining a zero-problem based on the outputs of a physical experiment, thus enabling numerical continuation to be applied directly without the need for a mathematical model. To do this there are two key challenges to overcome: (1) In general, it is not possible to set the state x of the physical system and so it is not possible to evaluate f at arbitrary points. (2) The physical system must remain around a stable operating point while the experiment is running. While a numerical model going unstable might prove to be a mild annoyance, a physical system going unstable can prove dangerous.In order to overcome these challenges, a feedback controller is used to stabilise the system and the control target (or reference signal) acts as a proxy for the system state. The feedback controller takes the form(2)u(t)=g(x⁎(t)−x(t))wherex⁎(t)is the control target and g is a suitable control law such as proportional-derivative (PD) control (as used in this paper) where(3)u(t)=Kp(x⁎(t)−x(t))+Kd(ẋ⁎(t)−ẋ(t)).For the method outlined in this paper, the choice of control law is at the discretion of the user; any suitable stabilising feedback control scheme can be used. The challenge here is to devise a scheme for embedding the feedback control within the numerical continuation such that the controller becomes non-invasive, that is, the controller does not affect the locations of any invariant sets in the experiment such as equilibria or period orbits. This requirement for non-invasiveness defines the zero problem; a control target must be chosen such that the control action(4)u(t)≡0.In this paper, we consider the case of a periodically forced experiment with forcing frequency ω and, as such, only consider periodic motions. In this case it is appropriate to consider a Fourier discretisation of Eq. (4) and so find the coefficients of the Fourier series of the control targetx⁎(t)=A0x⁎/2+∑j=1mAjx⁎cos(jωt)+Bjx⁎sin(jωt)such that Eq. (4) is satisfied. (In other circumstances different discretisations may be appropriate.) In this case the control action u has a Fourier series representation given by(5)u(t)=A0u2+∑j=1mAjucos(jωt)+Bjusin(jωt),where the Fourier coefficients Aujand Bujare derived directly from the measured control action (Eq. (2)), that is,(6a)Aju=ωπ∫02πωg(x⁎(t)−x(t))cos(jωt)dt,forj=0,1,2,…(6b)Bju=ωπ∫02πωg(x⁎(t)−x(t))sin(jωt)dt,forj=1,2,….Hence the discretised zero problem is defined as(7)0=Aju,0=Bju∀j.To solve Eq. (7) standard root finding algorithms can be used, however, any required derivatives must be estimated using finite differences from experimental data after adjusting the experiment inputs. Consequently, gradient-based methods can be slow despite their good convergence rates. In previous publications a Newton–Broyden method, which avoids recomputing derivative information for successive iterates, has proven effective [8,10,11].In this paper, since the control acts through the same mechanism as the forcing, we are able to use a quicker method which exploits the fact that we are performing a parameter study in the forcing amplitude [13]. Consider the case where the total input to the system is given by(8)i(t)=p(t)+u(t)where p(t) is the forcing signal and u(t) is the control action. Furthermore, we consider the case of sinusoidal forcing where(9)p(t)=acos(ωt)+bsin(ωt).For an arbitrary control targetu⁎(t)and forcing input p(t), the Fourier coefficients of Eq. (5) will be non-zero. However, the contribution in the fundamental mode (coefficientsA1uandB1u) can be lumped together with the coefficients a and b of the forcing term giving a new effective forcing amplitude of(10)Γ=(a+A1u)2+(b+B1u)2.Hence, once the higher Fourier modes of the control action u(t) are set to zero (as described below), the total input to the system will bei(t)=Γcos(ωt+ϕ)(the phase ϕ is unimportant since the system is time invariant). In essence, instead of setting the forcing amplitude and trying to calculate the correct corresponding control target, we set the control target and measure the corresponding forcing amplitude.Though this procedure leaves theA0uand the higher harmonics untouched, the corresponding control target coefficients required to set the control action to zero can be quickly determined using a fixed-point iteration. In an iterative manner the remaining coefficients of the control targetx⁎(t)are simply set equal to the measured coefficients of the system response x(t), the iteration finishes when the response and the control target remain equal for a certain period of time. For the system described below, this takes a single iteration.A fixed-point iteration cannot be applied to the coefficients of the fundamental mode since, generically, instabilities in the system will manifest in the fundamental mode.It is important to emphasise that this procedure does not depend on the specifics of the control law used in the experiment. All that is required is that smooth changes in the control targetx⁎(t)result in smooth changes in the Fourier coefficients (Eq. (6)). As such, this method is convenient in realistic settings where the control law is more sophisticated than simple PD control and filtering of the signal is required; these effects are simply captured in the control action u(t) and fed into Eq. (6).For a typical ordinary differential equation model, the right-hand side of which is given byh(x(t)), the Floquet multipliers and hence stability of a periodic orbit are determined by integrating over one period the first variational equation(11)dydt=A(x^(t))y(t)where y(t) represents the deviation from a predetermined periodic orbitx^(t)and the Jacobian matrix A is calculated from the derivatives of h with respect to x evaluated along the periodic orbit given byx^(t)(as such A is a time varying quantity).In the context of control-based continuation, even determining whether an orbit is stable or unstable is problematic due to the presence of stabilising feedback control. In [12] a number of measures are suggested to overcome this problem but all require turning off the feedback control for a period of time; in many situations this is not desirable as damage could be caused to the experiment or even the experimenter. As such, here we attempt to fit a time-varying linearisation using techniques from the system identification community. From the fitted time-varying linearisation we are able to calculate the corresponding Floquet multipliers and hence the stability properties of the periodic orbit.We start by assuming that the experiment of interest is undergoing a periodic motionx^(t)for a given forcing inputi^(t)=p^(t)+u^(t)(cf. Eq. (8)). In order to generate data with which to fit a time-varying linearisation, the system is perturbed using filtered Gaussian white noiseη(t)such that the total input to the experiment is(12)i(t)=i^(t)+η(t)+u(t)−u^(t).The additionalu(t)−u^(t)term arises due to the presence of the feedback controller acting against the applied perturbation. (Details ofη(t)are below.) Finally, we define the perturbed system response(13)y(t)=x(t)−x^(t)and, similarly, the perturbed system input(14)k(t)=i(t)−i^(t).Rather than trying to fit a continuous time model of the response to perturbations such as Eq. (11), which requires the estimation of derivatives from experimental data, we instead fit the coefficients of a discrete-time multiple-input multiple-output (MIMO) auto-regressive model with exogenous inputs (ARX) of the form(15)B(q−1)y(T)=A(q−1)k(T)+e(T)wherey(T)=[y(T−i/m)]i=0…m−1,k(T)=[k(T−i/m)]i=0…m−1ande(T)=[e(T−i/m)]i=0…m−1are vectors of data points of the perturbed system response, the perturbed system input (due to the control action and an additional random perturbation) and the model error respectively, sampled across a single period of oscillation and q−1 is the backward shift operator [22, Section 6.2]. Thusy(T)corresponds to a discretisation of the perturbed system response using m points over the period; this discretisation is illustrated in Fig. 1.B(q−1)andA(q−1)are squarem×mmatrices of polynomials in q−1; here we restrict the polynomials to being first order (at most). Thus Eq. (15) acts as a period map with all the dynamics of interest encoded inB(q−1). (The matrixA(q−1)though required for system identification is not used to infer stability.)The model errore(T)is not measured directly but is minimised by the particular system identification method used on Eq. (15).ARX models are used extensively in the system identification and time series analysis communities. Their simplicity has seen them applied to a wide range of topics. They are particularly appropriate in situations where discretely sampled data is available as they avoid the need of estimating derivatives. For more information see the textbook by Hamilton [23] or one of the many other books on this topic.At each point we assume linear observability to state that the next point in the time evolution of the linearisation is determined entirely by the previous n points alone. We assume thatn<m(increase the value of m as appropriate) to obtain a banded matrix structure forB(q−1)of(16)B(q−1)=[1b1,1⋯b1,n−1b1,n00⋯001⋯b2,n−2b2,n−1b2,n0⋯0⋱⋱⋱⋱⋱⋱⋱⋱⋱bm,1q−1bm,2q−1⋯bm,nq−1000⋯1],and forA(q−1)(17)A(q−1)=[a1,0a1,1⋯a1,n−1a1,n00⋯00a2,0⋯a2,n−2a2,n−1a2,n0⋯0⋱⋱⋱⋱⋱⋱⋱⋱⋱am,1q−1am,2q−1⋯am,nq−1000⋯am,0].Thus the system identification procedure must identify them(2n+1)coefficients (ai,jandbi,j) within these matrices to fully identify the linear model. The optimal values for m and n can be estimated using the Akaike information criterion (AIC) [24] or similar. Note that while increasing n increases the data requirements for successful system identification, increasing m does not since more information is taken from the existing time series.Since the experiment is operating in closed loop, the number of available system identification methods is somewhat limited. In this paper we make use of the direct method for closed-loop identification due to its simplicity and so identify the unknown parameters of Eq. (15) with least squares, thus minimising the sum-of-squares of the model erroreT. However, other methods such as joint input-output identification can be used if required [22,25]. In order to provide sufficiently informative results for system identification purposes, the random perturbationη(t)should have a sufficiently broadband spectrum. However, to minimise extraneous noise (that is, random perturbations which are not captured by the discretisation) the bandwidth of the random perturbation should be less than the Nyquist frequency corresponding to the discretisation in Eq. (15). For the purposes of this paper,η(t)is generated by passing Gaussian white noise through a 6th order Butterworth filter with a cut-off frequency of10Hz.When there is a significant amount of measurement noise or unmeasurable random disturbances, a non-trivial noise model is required in Eq. (15), giving rise to a moving-average (MA) term. In this case the unknown coefficients of the resulting ARMAX model must be estimated using a method such as the prediction error method (PEM) since the straightforward use of linear least-squares will result in bias [22, Chapter 10]. However, linear least-squares provides a quick and effective way of starting the iterative PEM optimisation.Once a linearised model has been identified the Floquet multipliers of the periodic orbit can be determined from the matrixB(q−1). Specifically, we seek to determine the monodromy matrix M such thaty(T)=Mq−1y(T)withk(T)≡0ande(T)≡0, that is, we seek a linear mapping which takes one period of data points and returns the following period of data points subject to no disturbance to the system input. For the method described here M corresponds to the first n rows and n columns of the matrix given by(18)B−1(0)(B(1)−B(0)),and the Floquet multipliers of the periodic orbit are the eigenvalues of M. In addition to the Floquet multipliers, the eigenvectors of M correspond to the stable and unstable directions of the periodic orbit at a particular point in the oscillation.To test the effectiveness of this methodology outlined in this paper we apply control-based continuation to a nonlinear tuned mass damper (NTMD) similar to the one described in [26]. The NTMD consists of a mass able to move horizontally on a low friction bearing system while restrained by two springs that are mounted perpendicular to the direction of motion, thus providing a geometric nonlinearity. The NTMD is then excited at the base. This configuration results in a hardening spring-type characteristic. A photograph of the experiment is shown in Fig 2(a) along with a schematic of the experiment in Fig 2(b).The details of the actuation and measurement equipment are as follows. The NTMD is excited using an APS-113 long-stroke electrodynamic shaker in current control mode using a Maxon ADS-50/10-4QDC motor controller. Typical base displacements are sinusoidal with a frequency ranging from 2.2 to3.2Hzand an amplitude ranging from0to25mm. The peak response amplitude is limited to±80mm; at resonance, this limitation restricts the amplitude of the base motion to approximately±7mm. The motion of the base and the moving mass are measured using laser displacement sensors (an Omron ZX2-LD100 and an Omron ZX1-LD300 respectively). In addition to the displacement measurements, the force provided by the shaker is measured using an MCL-type load cell.For the real-time control, a linear proportional-derivative (PD) controller is used with manually tuned gains. The methodology is relatively insensitive to the control gains used provided they are sufficient to stabilise any unstable orbits that are encountered. The controller is implemented on a BeagleBone Black fitted with a custom data acquisition board (hardware schematics and associated software are open source and freely available [27]). All measurements are made at1kHzwith no filtering.A random perturbation signal is generated, when necessary, on the real-time control board using the Box–Muller transformation to generate Gaussian pseudo-random numbers which are then filtered using a sixth-order Butterworth filter with a cut-off arbitrarily set at10Hz(below the Nyquist frequency of the discretisation used for Eq. (15)).Estimations of the Fourier coefficients of the response and the control action are also calculated in real-time on the control board. However, this was for convenience rather than a necessity.

@&#CONCLUSIONS@&#
This paper has proposed a new method for estimating Floquet multipliers and their associated eigendirections for periodic orbits that encountered when using control-based continuation on a physical experiment. A linear time-varying model in the form of an auto-regressive model with exogenous inputs (ARX) is fitted to each periodic orbit using small perturbations to the orbit to explore the nearby state-space.The method was demonstrated on a nonlinear mass–spring–damper-type experiment that has a hardening spring characteristic. The nonlinearity is provided by placing springs perpendicular to the direction of motion, thus creating a geometric nonlinearity. The Floquet multiplier estimations were shown to agree with what is expected from dynamical systems theory and the associated eigendirections match well with open-loop measurements taken.All the experimental data used in this paper has been deposited into the University of Bristol Research Data Repository and is publicly available for download [29].