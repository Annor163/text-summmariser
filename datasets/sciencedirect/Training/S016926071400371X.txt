@&#MAIN-TITLE@&#
Obtaining optic disc center and pixel region by automatic thresholding methods on morphologically processed fundus images

@&#HIGHLIGHTS@&#
A method for OD segmentation and center-location on fundus images is presented.The methodology was tested on 1890 fundus images acquired from diabetic patients.Estimated and real OD center distance remained below 1/4 OD radius in 96% of cases.OD segmentation estimations outperform all the reviewed methods in literature.The method is suitable to be integrated into a system for retinal-disease diagnosis.

@&#KEYPHRASES@&#
Optic disc,Fundus image,Diabetic retinopathy,Medical image analysis,

@&#ABSTRACT@&#
Development of automatic retinal disease diagnosis systems based on retinal image computer analysis can provide remarkably quicker screening programs for early detection. Such systems are mainly focused on the detection of the earliest ophthalmic signs of illness and require previous identification of fundal landmark features such as optic disc (OD), fovea or blood vessels. A methodology for accurate center-position location and OD retinal region segmentation on digital fundus images is presented in this paper. The methodology performs a set of iterative opening–closing morphological operations on the original retinography intensity channel to produce a bright region-enhanced image. Taking blood vessel confluence at the OD into account, a 2-step automatic thresholding procedure is then applied to obtain a reduced region of interest, where the center and the OD pixel region are finally obtained by performing the circular Hough transform on a set of OD boundary candidates generated through the application of the Prewitt edge detector. The methodology was evaluated on 1200 and 1748 fundus images from the publicly available MESSIDOR and MESSIDOR-2 databases, acquired from diabetic patients and thus being clinical cases of interest within the framework of automated diagnosis of retinal diseases associated to diabetes mellitus. This methodology proved highly accurate in OD-center location: average Euclidean distance between the methodology-provided and actual OD-center position was 6.08, 9.22 and 9.72 pixels for retinas of 910, 1380 and 1455 pixels in size, respectively. On the other hand, OD segmentation evaluation was performed in terms of Jaccard and Dice coefficients, as well as the mean average distance between estimated and actual OD boundaries. Comparison with the results reported by other reviewed OD segmentation methodologies shows our proposal renders better overall performance. Its effectiveness and robustness make this proposed automated OD location and segmentation method a suitable tool to be integrated into a complete prescreening system for early diagnosis of retinal diseases.

@&#INTRODUCTION@&#
Diabetic Retinopathy (DR) is a retinal disease derived from complications caused by the abnormally high levels of glucose in blood produced by diabetes mellitus (DM). Closely associated with DR is the diabetic Macular Edema (ME), a swelling of the retina due to fluid leaking from blood vessels within the macula. DR and ME constitute the main cause of blindness in diabetic patients: although diabetes does not necessarily involve vision impairment, about 2% of patients are blind, and 10% undergo vision degradation after 15 years of diabetes as a consequence of these complications [1] and [2].The main problem involved by DR and ME diagnosis is that these disorders are usually asymptomatic in their early stages, when medical treatment is more effective and disease progression can be prevented. Therefore, to ensure treatment is received on time, diabetic patients need annual eye-fundus examination [3]. However, this preventive action means a huge challenge for health services, since the number of potential patients is very high (DM affects around 6% of the general population and its total number of patients is forecasted to reach 366 million in 2030 [4]). In this framework, development of automatic DR and ME diagnosis systems based on retinal image computer analysis may provide a remarkably quicker screening programs for early detection of these disorders. Such systems are mainly focused on the detection of early ophthalmic signs of illness (i.e., microaneurysms, hemorrhages, exudates). This way, much effort has been focused on the development of algorithms for these early DR- and ME-related lesions in recent years [5–7].Regarding ME, one of the earliest possible ophthalmic signs of illness is the presence of exudates in the retina. Exudates are lipid and lipoprotein deposits appearing as white or yellowish regions on fundus image retinography. Although the presence of exudates is not always a strong surrogate for ME (they are present in roughly 90% of ME patients), their detection – specifically their number and position in the retina relative to the fovea – can be used for automatic graduation of the risk of future disease development [8,9].This task requires previous identification of fundal landmark features such as the optic disc (OD). Like exudates, the OD usually appears in eye fundus images as a yellowish region and its segmentation is particularly important to reduce false positives in the detection of regions of retinal exudates [10]. On the other hand, OD segmentation can also be useful as valuable information to detect other fundus features such as the fovea [11], whose location is used for disorder-grade determination (the distance at which exudates are located from it influences the clinical relevance of ME). This way, OD center position can be used for fovea center estimation, since both points are separated on average a relatively constant distance of 2.5 OD diameters [12].Numerous automated methods for retinal OD detection on eye fundus images have been reported over the last years. They can be mainly grouped into location and segmentation methods, depending on whether they are focused on finding an OD pixel, [13–19] or estimating its boundary and thus segmenting its pixel region [20–25].Regarding the most recent methodologies, an OD segmentation methodology using three independent location methods and a voting procedure is presented in [26]. In [27], a circular transformation evaluates image variation along multiple evenly oriented radial line segments of specific length. The pixels with maximum variation along all radial line segments are determined, as they can be further exploited for both OD center and boundary location. A method for OD location based on clustering and histogram techniques is proposed in [28]. In this method, candidate regions are firstly determined by clustering the brightest pixels in the red plane of the fundus image. Then, three pixels are determined within the candidate region in the green plane by using three independent methods for OD location. In [29], OD location candidates are identified using template matching. The template is designed to adapt itself to different image resolutions. Then, vessel features (patterns) on the OD are used to determine OD location. Using the detected OD center and estimated OD radius, a hybrid levelset model, combining region and local gradient information is applied to OD boundary segmentation. The method proposed in [30] is mainly based on mathematical morphology, along with principal component analysis (PCA). It makes use of different operations such as the generalized distance function (GDF), a variant of the watershed transformation, the stochastic watershed, and geodesic transformations. The input of the segmentation method is obtained through PCA. Finally, to the best of our knowledge, the most recent studies on OD detection are the methodologies presented in [31] and [32]. In [31], blood vessel network-extracted information is combined with intensity data. In [32], OD is located exclusively according to brightness criteria. The OD pixel is detected through the centroid of the highest intensity pixels on a morphologically processed fundus image.This paper presents a new methodology for automatic identification of the OD pixel region and its center position on retinal images. On one hand, this methodology is based on exploiting OD visual appearance. This region is recognizable on fundus images as a round bright area. Thus, a set of morphological opening and closing operations are applied to enhance this kind of structures. On the other hand, it also exploits the fact that the OD is the entry point for the major blood vessels that supply the retina. In this sense, as shown in Section 3, the main vessels from the vascular arch play an important role, and their segmentation is also proposed.It should be pointed out that this work is specifically aimed at contributing to the development of a system for automated DR detection that is currently being implemented by the Health Ministry of the Andalusian Regional Government (Spain) with the purpose of enhancing the effectiveness of its DR screening program. Although other published solutions for OD segmentation may be used, this system's proven effectiveness and robustness, together with its simplicity, make our proposed method a suitable tool to be integrated into the mentioned automated prescreening system.The rest of the paper is organized as follows. The testing material used in this study is described in Section 2, while the proposed method is explained and illustrated in Section 3. Section 4 presents the obtained results and compares them to those obtained with other available methods. Finally, the authors’ conclusions put an end to this paper.To evaluate the OD location and segmentation methodology described in the next section, the publicly available MESSIDOR [33] and MESSIDOR-2 [34,35] databases were used. These databases contain 1200 and 1748 eye fundus color images of the posterior pole, respectively. All fundus images were captured using a Topcon TRC NW6 non-mydriatic retinograph with 45° field-of-view (FOV) digitalized to 1440×960, 2240×1488 or 2304×1536 pixels, and are 8 bits per color plane.The images in the MESSIDOR database were acquired by the Paris Hôpital Lariboisière, the Faculté de Médecine St. Etienne, and the LaTIM at Brest (France). 800 images were captured with pupil dilation (Lariboisière and St. Etienne subsets), and 400 without dilation (LaTIM subset). All fundus images from this database were diagnosed by medical experts attending to a classification designed within the framework of the Messidor – Techno-Vision Project. This classification grades DR into four stages (on a scale of 0–3, with 0 being normal retina) and evaluates the ME risk into three grades (on a scale of 0–2, with 0 being no risk). According to this classification, the whole set of MESSIDOR images includes 540 cases of healthy retinas (DR grade = 0; ME risk = 0), 660 cases of pathological retinas showing some DR or ME sign (DR grade ≠ 0 or ME risk ≠ 0) and 229 cases of retinas with presence of hard exudates and thus showing ME signs (ME risk ≠ 0). Therefore, the choice of this database allows evaluating the methodology under ME-related retinas where the presence of exudates may hinder OD location (as OD, exudates appear as bright yellowish regions in fundus images).MESSIDOR-2 database includes 874 two macula-centered eye fundus images (one per eye): 529 pairs of these images (1058 images) were obtained from the original MESSIDOR database. The remaining images (345 pairs, 680 images) consist of previously unpublished examinations acquired from diabetic patients by LaTIM at Brest (France). This set was imaged with no pharmacological dilation.On the other hand, MESSIDOR and MESSIDOR-2 databases provide no binary masks delineating retina pixels for the images (FOV masks). The use of these masks allows the application of algorithms exclusively within the retina, as well as obtaining outstanding information. For instance, for a given fundus image, retina diameter can be easily determined by measuring the diameter of the FOV mask. This fact is especially relevant in this paper, as the OD radius can be estimated from this retina size. Therefore, a FOV mask was generated for each fundus image.

@&#CONCLUSIONS@&#
Automated diabetic retinopathy (DR) screening or pre-screening carried out by systems focused on the detection of early ophthalmic signs of illness can have a major impact in the near future. Since the number of potential patients is very high, development of automatic DR diagnosis systems based on retinal image computer analysis may provide remarkably quicker screening programs for early detection of these disorders. The development of such systems require to detect anatomical structures such as optic disc (OD), fovea or vascular arch.A methodology for locating the center and segmenting the OD retinal region on digital fundus images is presented in this paper. The methodology firstly searches for a pixel within the OD to extract an OD-containing region of interest where accurate segmentation and center-position location have to be performed. For this purpose, an automatic thresholding procedure is applied on bright region-enhanced images, which are obtained after processing the retinography intensity channel by a set of morphological opening and closing operations. In this thresholding scheme, the main blood vessels originating from the OD play an important role and their detection has also been proposed.This methodology was tested on the publicly available MESSIDOR and MESSIDOR-2 databases. The MESSIDOR database was selected because it is composed by a large number of retinographies acquired from three different sources (Paris Hôpital Lariboisière, the Faculté de Médecine St. Etienne and the LaTIM at Brest, France), all of them diagnosed according to Diabetic Retinopathy (DR) grade and Macular Edema (ME) risk. Specifically, the whole set of 1200 fundus images includes 229 and 660 cases with ME and DR signs, respectively. On the other hand, MESSIDOR-2 images were included in our testing material to extend experimentation, since this database offers a set of new 690 images from diabetic patients. Therefore, the methodology was evaluated on a huge number of clinical cases of interest within the framework of automated diagnosis of these retinal diseases.Regarding the evaluation criterion, OD locations were quantified by measuring the Euclidean distance between the estimated and the actual OD center for each fundus image. Specifically, referential distances 1/8, 1/4, 1/2 and 1 times the OD radius (measured from the actual OD center position) were selected to set a quality scale. On the other hand, OD segmentation evaluation was performed in terms of Jaccard and Dice coefficients, as well as the mean average distance between the methodology-provided OD pixel region and the actual one, established with the help of an experienced ophthalmologist.The methodology proves very accurate locating the center of the OD region (results are presented in Table 2). The distance between the methodology-provided pixel and the actual OD center position remains below (1/8)R, (1/4)R, (1/2)R and 1R in 80.85, 95.5, 98.99 and 99.68%, respectively, of the 1890 different fundus images under consideration. These data lead to an average distance of 6.08, 9.22 and 9.72 pixels for retinas of 910, 1380 and 1455 pixels in size, respectively. Concerning OD segmentation results (Tables 4 and 5), the methodological comparison presented in Table 6 shows that methodology-rendered results systematically exceed those reported by the reviewed, most-recent OD-segmentation approaches available in literature.On the other hand, it should be pointed out that methodology-estimated OD location and segmentation results show no significant differences when sets of dilated and non-dilated fundus images acquired from different medical centers are independently considered. Thus, the methodology proves its stability relative to the quality variations that the images of non-dilated eyes may suffer. This is important for practical application, since OD detection tools must work on retinal images from multiple origins that may have been captured with or without pharmacological dilation. Moreover, no decreasing performance is observed when strong distracters such as yellowish exudates (ME signs) or bright reflects (common in MESSIDOR-2 LaTIM subset) are present on the fundus image. Therefore, the methodology also proves stable when confronted to different ME-grade diagnosed fundus images.In addition, method simplicity should also be highlighted. The performance results obtained on a massive digital retinal database indicate that simple methods based on basic image processing techniques seem to suffice for OD detection. Dealing with high resolutions images (1440×960, 2240×1488 and 2304×1536), average computational time to process a single image was 5.425s (SD = 0.981s) running on a PC with a dual-Intel Xeon CPU at 32Ghz and 32 GB of RAM capacity. Since our implementation is experimental, this performance might still be improved. The algorithms were implemented in Matlab (version R2012a).This fact, together with its proven effectiveness and robustness, makes this proposed OD location and segmentation method a suitable tool to be integrated into a complete system for automated retinal-disease diagnosis. This way, it should be pointed out that this work has specifically contributed to the development of the system for automated DR detection implemented by the Health Ministry of the Andalusian Regional Government (Spain) with the purpose of improving effectiveness in its DR screening program.Finally, it is worth mentioning that for the sake of rigorousness in future performance comparison between OD detection methods, the sets of methodology-estimated OD-center coordinates and OD-pixel region binary masks, as well as the corresponding ones used in this paper as ground truth, for each of the MESSIDOR and MESSIDOR-2 fundus images are available at [50] (in Images/Results subsection of the Downloads section). Moreover, researchers can generate the results of the proposed methodology on any fundus image online at [50] (in Methods section).