@&#MAIN-TITLE@&#
Derivatives of isogeometric functions on n-dimensional rational patches in

@&#HIGHLIGHTS@&#
We derive an exact representation of the derivatives of an isogeometric function.The isogeometric function is defined over a domain of arbitrary dimension.We use the formula to derive smoothness results for functions on singular patches.The conditions depend on the exact representation of the interior of the domain.The derivative formula can be used to derive functionals for regularization.

@&#KEYPHRASES@&#
Isogeometric analysis,Derivative,NURBS,Singular patch,Smoothness,Embedded manifold,

@&#ABSTRACT@&#
We consider isogeometric functions and their derivatives. Given a geometry mapping, which is defined by an n-dimensional NURBS patch inRd, an isogeometric function is obtained by composing the inverse of the geometry mapping with a NURBS function in the parameter domain. Hence an isogeometric function can be represented by a NURBS parametrization of its graph. We take advantage of the projective representation of the NURBS patch as a B-spline patch in homogeneous coordinates.We derive a closed form representation of the graph of a partial derivative of an isogeometric function. The derivative can be interpreted as an isogeometric function of higher degree and lower smoothness on the same piecewise rational geometry mapping, hence the space of isogeometric functions is closed under differentiation. We distinguish the two casesn=dandn<d, with a focus onn=d−1in the latter one.As a first application of the presented formula we derive conditions which guaranteeC1andC2smoothness for isogeometric functions on several singularly parametrized planar and volumetric domains as well as on embedded surfaces. It is interesting to note that the presented conditions depend not only on the general structure of the patch, but on the exact representation of the interior of the given geometry mapping.

@&#INTRODUCTION@&#
The aim of this work is to contribute to a better understanding of the properties of derivatives of the functions that occur in isogeometric analysis. Our starting point is the notion of isogeometric functions. It is inspired by the seminal article by Hughes et al. (2005), which introduced the framework of isogeometric analysis (IgA). An isogeometric function is the composition of a NURBS function defined on some parameter domain with the inverse of a NURBS geometry mapping defined on the same parameter domain. Ideally, the geometry mapping is directly obtained from the NURBS representations in an existing CAD model. In this case, the numerical simulations can be performed directly based on the exact geometric representations provided by the CAD framework.In IgA, the space of isogeometric functions is used to discretize and solve a partial differential equation. The underlying physical domain is defined by the NURBS geometry mapping. The numerical simulation uses the isogeometric functions as test/trial functions for a Galerkin discretization of the variational formulation (see e.g. Hughes et al., 2005; Gomez et al., 2008; Cottrell et al., 2009). Alternatively, these functions can be used as a basis for a collocation approach (see Auricchio et al., 2010; Schillinger et al., 2013). Consequently, it is necessary to find a good representation of the derivatives of the test functions, either for approximation or for point-wise evaluation. In addition, it may be necessary to establish smoothness and regularity properties of the spaces of isogeometric functions, which possibly entail additional constraints, e.g., for singularly parametrized domains.The properties of derivatives of NURBS patches are well understood. When it comes to derivatives of isogeometric functions defined on these patches, however, many questions are still open. An exact representation is hard to obtain, since the derivatives of piecewise rational functions and their inverse functions are involved.The approach presented in the paper leads to a closed-form representation of the derivatives of isogeometric functions which can be evaluated in a stable way. Moreover, this representation is quite helpful for analyzing theCksmoothness or theHkregularity of an isogeometric function. We consider the most general setting, i.e. domains represented by n-dimensional patches inRd, for bothn=dandn<d, where we especially focus onn=d−1(such as surface patches inR3). The present paper is an extension of a conference article by Takacs and Jüttler (2013), which was limited to the casen=d=2.An isogeometric function on a physical domain, defined by a NURBS patch, can be represented as a NURBS patch parametrizing its graph. If the domain is an n-dimensional patch inRd, then the graph of an isogeometric function is an n-dimensional patch inRd+1. Throughout this paper we will use homogeneous coordinates to simplify the notation. Using this approach, we develop a closed form representation of the graphs of the partial derivatives of an isogeometric function. The derivatives can again be interpreted as isogeometric functions of higher degree and lower smoothness defined on the image of the same piecewise rational geometry mapping.Consequently, the space of isogeometric functions on a given domain patch is closed under differentiation. We derive an exact representation of the derivatives of isogeometric functions. This may be of interest for symbolic manipulations, for other applications where an exact evaluation of derivatives is necessary, and for the formulation of regularization methods for solving inverse problems using the isogeometric approach.As a first application, we investigate conditions that guarantee smoothness when dealing with patches with singular parametrizations. Related results concerning the smoothness of singular rational Bézier patches were developed e.g. by Bohl and Reif (1997) and Sederberg et al. (2011). We consider a slightly different framework. First, we keep the domain parametrization fixed and consider the space of isogeometric functions defined over this domain parametrization. Second, we investigate not only surfaces, but parameterizations of general n-dimensional patches inRd. Our method provides a systematic approach to derive conditions which characterize smoothness of arbitrary order. We demonstrate the capabilities of the proposed approach to smoothness analysis by presenting results for parametrizations of planar and volumetric domains and for surfaces inR3.Regularly mapped, tensor-product NURBS can describe quadrilateral (n=2) or hexahedral (n=3) domains only. When it comes to representing more general domains, a standard approach is to consider singular patches. Consequently, surface patches such as the spherical shell presented in Section 6 are used in many applications (see e.g. Kiendl et al., 2009; Benson et al., 2010). The results concerning the smoothness of isogeometric functions are related to the results by Takacs and Jüttler (2011, 2012) concerningH1andH2regularity properties on singular patches.When using singular patches, certain isogeometric basis functions may not beC1- orC2-smooth, hence some derivatives cannot be evaluated properly. This may affect the stability and convergence properties of the numerical schemes applied. Contributions to the numerical analysis in IgA include consistency, stability and approximation power of the method (Bazilevs et al., 2006; Cottrell et al., 2007; Hughes et al., 2010; Echter and Bischoff, 2010). However, singularly parametrized domains are not covered by these general results and have to be dealt with differently.The first strategy that comes to mind when dealing with singular patches is to cut out the near-singular part of the patch, i.e. not evaluating functions at points where the Jacobian determinant is close to zero. However, this will lead to a reduced order of convergence in many situations. Another approach to handle singularities is to define some auxiliary basis functions locally at the singularity. We suggest to define new basis functions that lie in the span of the standard basis, i.e. that are smooth linear combinations of the non-smooth basis functions. We derive conditions on the isogeometric functions that guarantee the desired smoothness. These conditions can be used to define new basis functions and thus a smooth function space for discretization. It turns out that the dimension of this smooth function space is very sensitive to changes of the geometry mapping.The remainder of the paper is organized as follows. In Section 2 we introduce the notation of isogeometric functions on rational patches. We first introduce the homogeneous coordinate representation of rational n-dimensional patches inRd. In the second part we introduce isogeometric functions on such patches. In Section 3 we treat the case of derivatives on patches withn=d. We then discussC1(Ω¯)andC2(Ω¯)smoothness properties of isogeometric functions on planar domains Ω in Section 4. We denote byCk(Ω¯)the space of functions where the k-th derivatives are continuous in the interior of the domain Ω and can be extended continuously to the boundary ∂Ω. In Section 5 we extend the results to n-dimensional patches inRdwithn<d. We especially focus on surfaces inR3in Section 6, where we consider four examples corresponding to two types of model cases. We conclude the paper with some final remarks in Section 7.We introduce rational n-dimensional patches, which are embedded into the Euclidean space of dimension d and we define isogeometric functions on these patches.Throughout this section we deal with piecewise rational parametrizations of patches inRd. In order to keep the notation simple we will adopt the concept of homogeneous coordinates. This is a common approach when dealing with rational functions or NURBS (see e.g. Farin, 1999).Any Cartesian coordinate vectorr=[r1,…,rd]TinRdcan be represented in homogeneous coordinates byr˜=(r˜0,r˜1,…,r˜d)T∈R\{0}×Rd,whereri=r˜i/r˜0fori∈{1,…,d}. Hence any two points r and s are identical if and only if the homogeneous coordinate vectorsr˜ands˜are linearly dependent. More precisely, a point with the Cartesian coordinates r corresponds to the equivalence classr˜Rof points in homogeneous coordinates. In the remainder of this paper, homogeneous coordinates are always denoted with a tilde (r˜) and Cartesian coordinates without it (r).A piecewise rational patch in Cartesian coordinatesr(u)=(r˜1(u)r˜0(u),…,r˜d(u)r˜0(u))Tforu∈B⊂Rncan be represented by a piecewise polynomial parametrization in homogeneous coordinates,r˜(u)=(r˜0(u),r˜1(u),…,r˜d(u))Tforu∈B.The parameter domain B of the patch is the n-dimensional open boxB=(0,1)n.We assume thatr˜0(u)>0for allu∈B¯. HereB¯is the closure of B. The homogeneous coordinates are piecewise polynomial spline functions,r˜0,r˜1,…,r˜d+1∈Sp,s. HereSp,sis the space ofCs-smooth tensor-product spline functions of degreep=(p1,…,pn)with the inner knotsθjν,ν=1,…,n, where the vectors=(s1,…,sn)specifies the order of smoothness (differentiability) with respect to the parametersu=(u1,…,un). Consequently, the knot vectors take the form(1)θν=(0,…,0︸pν+1times,…,θjν,…,θjν︸pν−sνtimes,…,1,…,1︸pν+1times).We will not consider spline spaces with more general knot vectors in this paper. The bounds for the degree and smoothness of the derivative patches, which will be derived in the later sections, can be generalized to more general spline spaces. For details on NURBS and B-splines and their applications in computer aided geometric design we refer to Farin (1999), Prautzsch et al. (2002), Hoschek and Lasser (1993).We recall the tensor-product B-spline representation ofr˜with respect to the tensor-product B-spline basis{Bi}i∈IofSp,s,(2)r˜:u↦(r˜0(u),…,r˜d(u))T=∑i∈Ic˜iBi(u),with homogeneous control pointsc˜i∈Rd+1. When using Cartesian coordinates, this is transformed into(3)r:u↦(r1(u),…,rd(u))T=∑i∈IciRi(u),with Cartesian control pointsci=(c˜i,1/c˜i,0,…,c˜i,d/c˜i,0)T∈Rd, weightsc˜i,0and piecewise rational (NURBS) basis functions(4)Ri(u)=c˜i,0Bi(u)r˜0(u),withr˜0(u)=∑j∈Ic˜j,0Bj(u).The (physical) domainΩ⊂Rdis given as the image of the geometry mapping r, i.e.Ω=r(B), where we assume that the mappingr:B→Ωis bijective. In the following subsection we define isogeometric functions on the domain Ω.We consider a bijective NURBS patchr:B→Ω⊂Rdas in (3) withr˜as in (2) such thatr˜j∈Sp,s, for0≤j≤d.Definition 1Consider an auxiliary spline functionr˜d+1∈Sp,s,r˜d+1(u)=∑i∈If˜iBi(u).The functionf:Ω=r(B)→R, which is defined viaf(r(u))=r˜d+1(u)r˜0(u)=rd+1(u)is called an isogeometric function on the physical domain Ω. The symbolVp,sdenotes the space of all isogeometric functions obtained by consideringr˜d+1∈Sp,s.Clearly, due to the nestedness of spline spaces, it is possible to use spline spaces of higher degreep′≥pand lower smoothnesss′≤swith the same inner knots (with suitably increased knot multiplicities). The spaceVof all isogeometric functions is obtained by considering piecewise polynomial functionsr˜d+1of any degree over the given knot sequences. Strictly speaking, these functions are defined only in the interior of the boxes defined by the knot sequences, since they need not be continuous.The graph of an isogeometric functionf∈Vp,scan be represented by the parametric surface(5)f˜(u)=(r˜0(u),r˜1(u),…,r˜d(u),r˜d+1(u))T,which possesses the B-spline representationf˜(u)=∑i∈I(c˜if˜i)Bi(u),with homogeneous control points(c˜i,0,…,c˜i,d,f˜i)T∈Rd+2fori∈I.If all weightsc˜i,0are non-zero, then an isogeometric functionf∈Vp,shas a representation in the basisRi∘r−1with coefficientsf˜i/c˜i,0where the rational basis functionsRiare given as in (4), i.e.f=(r˜d+1r˜0)∘r−1=∑i∈If˜ic˜i,0(Ri∘r−1).We present two simple examples to give a geometric interpretation of isogeometric functions. The left part of Fig. 1depicts a bivariate geometry mapping r of a planar domain Ω and the graph surface f of an isogeometric function f defined on Ω. The right part visualizes an isogeometric function f defined over a planar curve given by r.In the following sections we derive a closed form representation of the derivatives of isogeometric functionsf∈Vp,sand, more generally,f∈V. The main results, which will be presented in Theorems 3 and 5, are valid for NURBS. In the examples in Sections 4 and 6, however, we will restrict ourselves to rational tensor-product Bézier patches. There we considerSp,s=Sp,p=Πp, whereΠpis the space of polynomials of degree p. The Bernstein polynomialsBi(u)=∏j=1n(pjij)(1−uj)pj−ijujijforu=(u1,…,un)andi∈I={(i1,…,in):0≤ij≤pj∀1≤j≤n}form a basis of the spaceΠp. In this context we will omit the indexs=pfor the order of smoothness and write simplySp,Vpinstead ofSp,p,Vp,p. Clearly, any NURBS parametrization can be transformed into a piecewise Bézier representation via knot insertion.In this section we assume that the geometry mapping takes the formr:B⊂Rd→Ω⊂Rd.We derive a representation of the partial derivatives of an isogeometric functionf∈Vwith respect to the coordinates in physical spacexifori∈{1,…,d}. More precisely, we define an operatorDi, such thatDir˜represents the graph of∇if, similar to the representation (5). Here∇if=∂f∂xiis the i-th component of the gradient of f.Note that the graph f of an isogeometric function f is a hypersurface inRd+1. We recall the homogeneous representation of the tangent space to a parametrized hypersurface f at a pointf(u)(cf. Ovsienko and Tabachnikov, 2005):Lemma 2Letfbe a d-dimensional patch inRd+1, which is given in the form(5)withn=d. We consider the tangent hyperplaneTuto the manifold at the pointf(u), which is assumed to be regular. The points of this hyperplane satisfy the equationg˜(u)Tx˜=0,where the vectorg˜(u)has the entries(6)g˜j(u)=det⁡(e˜j,f˜(u),∂1f˜(u),…,∂df˜(u)),j=0,…,d+1.In these formulas, the vectorse˜jare the unit vectors spanning the coordinate axes inRd+1, i.e.e˜0=(1,0,…,0)T,e˜1=(0,1,0,…,0)T, etc., and∂if˜(u)=∂f˜∂ui(u)denotes the partial derivative with respect to the i-th parameterui.The proof of this observation results from the fact that a pointx˜belongs to the tangent hyperplane if and only if its homogeneous coordinates are linearly dependent onf˜and the d partial derivatives of the vectorf˜of homogeneous coordinates.We use this well-known result from projective geometry to derive a representation of the derivatives of isogeometric functions as rational hypersurface patches. More precisely, given the graph of an isogeometric function f as a d-dimensional patch inRd+1, the following theorem provides a representation of the graph of a partial derivative of f, again as a d-dimensional patch inRd+1:Theorem 3The graph of the partial derivative∇if=∂f∂xiof an isogeometric functionf∈V, which is given in the form(5)withn=d, can be represented by the parametric hypersurface(7)Dif˜=(r˜0g˜d+1,r˜1g˜d+1,…,r˜dg˜d+1,−r˜0g˜i)T.ProofWe consider a fixed parameter value u. According to Lemma 2, the tangent hyperplane of the hypersurfacef˜at u isTu={x˜∈Rd+2:g˜(u)Tx˜=0}.LetT1f(x)be the first order Taylor approximation of f atr(u). Inserting(1,x1,…,xd,T1f(x))Tinto the equation of the tangent plane givesg˜0(u)+∑j=1dg˜j(u)xj+g˜d+1(u)T1f(x)=0,withg˜jas in (6). Solving forT1f(x)leads toT1f(x)=−g˜0(u)g˜d+1(u)−∑j=1dg˜j(u)g˜d+1(u)xjhence∂T1f∂xi(x)=−g˜i(u)g˜d+1(u).SinceT1f(x)is the first order Taylor approximation of f at the pointx=r(u),∂f∂xi(r(u))=∂T1f∂xi(x)=−g˜i(u)g˜d+1(u).Therefore the graph of the derivative in Cartesian coordinates fulfills(r˜1(u)r˜0(u),…,r˜d(u)r˜0(u),∂f∂xi(r(u)))T=(r˜1(u)r˜0(u),…,r˜d(u)r˜0(u),−g˜i(u)g˜d+1(u))Twhich directly leads to the representation (7) in homogeneous coordinates.  □Assume that r is a regular mapping. Then, given an isogeometric functionf∈Vp,scorresponding to the spline spaceSp,s, the derivative∇if=∂f∂xiis again an isogeometric function. It fulfills∇if∈Vpˆ,sˆ, withpˆ=(d+2)p−1andsˆ=s−1. The spaceVpˆ,sˆis the space of isogeometric functions corresponding toSpˆ,sˆ. Note thatSp,s⊆Spˆ,sˆ⊂PandVp,s⊆Vpˆ,sˆ⊂V(see Definition 1). HerePis the space of polynomials of arbitrary degree. Hence, we can directly conclude that the spaceVof all isogeometric functions on Ω is closed under differentiation.The bounds on the degree and smoothness are derived from the representation of Theorem 3 and are stated for generic functions on generic geometries. For certain choices of the function f or of the geometry mapping r, the degree of the derivatives may be decreased and/or the smoothness may be increased. In the following we use the representation of the partial derivatives from Theorem 3 to analyze the smoothness properties of isogeometric functions defined on singular patches. Note that the smoothness may decrease when singularities are present.We use Theorem 3 to analyze the order of smoothness of isogeometric functions defined on patches containing singularities. In the following we assume that a homogeneous representation of a rational patch in Bernstein–Bézier form is given. Since any NURBS patch can be split into a collection of rational patches, we restrict ourselves to rational patches.We denote withD0⊂B¯the set of singular points of the geometry mapping r. Recall thatB¯is the closure of B. Letdet⁡∇ur(u)≥0for allu∈B¯anddet⁡∇ur(u)=0if and only ifu∈D0. Note that the Jacobian determinantdet⁡∇ur(u)is a rational function of the formdet⁡∇ur(u)=(−1)d+1g˜d+1(u)(r˜0(u))d+1,where the numeratorg˜d+1(u)is the function defined in (6). Recall thatr˜0(u)>0for allu∈B¯. Consequently, the setD0is the zero set of the multivariate polynomialg˜d+1(u).We exemplify two types of singular planar patches (types P1 and P2) and three types of singular volumetric patches (types V1, V2 and V3). Patches of type P1, which were already studied by Takacs and Jüttler (2013), possess collapsing control points. Patches of type P2 have singularities caused by parallel tangents at a corner of the parameter domain. The trivariate patches of type V1 represent four-sided pyramids by collapsing the control points of one of the faces. The patches of type V2 describe tetrahedral patches by collapsing two faces to a point and to a curve, respectively. The patch described by type V3 contains a different kind of singularity. In this case the singularity is caused by two edges being collinear in the physical domain. The boundary of the patch consists of five quadrilateral faces and one degenerate triangular face.We will deriveC1(Ω¯)andC2(Ω¯)smoothness conditions for isogeometric functions defined on these model patches. Note that we consider a non-standard notion ofCk(Ω¯)smoothness on the closed domainΩ¯which is defined below. Usually,Cksmoothness is defined on open domains.Definition 4LetΩ⊂Rdbe an open set. We say thatf∈Ck(Ω¯)if and only iff∈Ck(Ω)and the derivatives of f up to order k can be extended continuously to the boundary ∂Ω of the domain Ω. We call such a function f aCksmooth function. Here the spaceCk(Ω)consists of all functions that satisfy the standard definition ofCksmoothness on an open domain Ω.All presented types of patches are (rational) Bézier patches, which can be seen as restrictions of NURBS patches to one of its elements (knot spans). Since the boundary of the Bézier element may be in the interior of the full NURBS patch, the smoothness of the functions at the boundary of the Bézier element is also of interest, and this is reflected by the definition. In addition, the functions covered by the definition possess certain regularity properties which may be required in isogeometric analysis, e.g., in order to guarantee the existence of the integrals needed to derive the discretization.The approach to derive the smoothness conditions for isogeometric functions on a singular patch consists of two major steps. First we compute the derivatives up to the desired order, second we deriveC0continuity conditions for the resulting singular patches.More precisely, given an isogeometric function with arbitrary coefficientsfi(as in Table 1), we compute the derivatives according to Theorem 3. Hence all derivatives are given via a hypersurface representing their graphs. These hypersurfaces are given as homogeneous patches in Bernstein–Bézier form. Each homogeneous control point of such a patch is either a basepoint, a point at infinity, or real point in Euclidean space.The second task consists in the analysis of the continuity of such patches. First one can identify linear conditions on the coefficientsfisuch that no points at infinity occur, resulting in a singular hypersurface consisting of real control points and basepoints only. Depending on the type of the singularity, one may then be able to cancel out basepoints. Again there exist linear conditions on the coefficientsfithat guaranteeC0-continuity for the resulting singular hypersurfaces. Here we refer to Warren (1990) which deals with the properties of surfaces containing basepoints. Related results concerning toric patches are presented in Krasauskas (2002).See Takacs and Jüttler (2013) for further details on deriving smoothness conditions for isogeometric functions on planar patches.We exemplify this case by considering an isogeometric functionfδ∈V(2,2), which is represented by its graph surface(8)f˜δ(u)=∑i1=02∑i2=02f˜(i1,i2)Bi1,i2(u1,u2)with the control points given in Table 1, where the basis functionsBi1,i2are the tensor-product Bernstein polynomials of degree(2,2). The singular points form the setD0={(0,u2),0≤u2≤1}.The left part of Fig. 2depicts an example of a patch of type P1. Note that the position of the inner control point with index(1,1)depends on the value of the perturbation parameterδ=(δ1,δ2).Using Theorem 3, we conclude thatfδ∈C1(Ω¯)if and only if(9)f(0,0)=f(0,1)=f(0,2)(10)δ1(f(0,0)−f(1,0))+δ2(f(0,0)−f(1,2))+2f(1,1)−f(1,2)−f(1,0)=0.This condition admits the (well-known) geometric interpretation that the Cartesian control pointsf(0,0),f(0,1),f(0,2),f(1,0),f(1,1)andf(1,2)must be coplanar to secureC1(Ω¯)smoothness.Using again Theorem 3 to compute the graph surfaces of the second partial derivatives from the first order ones, we conclude thatfδ∈C2(Ω¯)if and only if Eqs. (9), (10) and(11)δ1(f(1,0)−f(2,0))+δ2(f(1,0)−f(2,1))+2f(1,1)−f(1,2)−f(1,0)=0(12)δ1(f(0,0)−f(1,0)+f(1,2)−f(2,1))+δ2(f(0,0)−f(2,2))+4f(1,1)−2f(1,2)−2f(1,0)=0are satisfied. Note that Eqs. (10), (11) and (12) are equivalent ifδ1=δ2=0.The spaces ofC1andC2smooth isogeometric functions obtained from the biquadratic parametrization have generally the dimensions 6 and 4, respectively. Ifδ1=δ2=0, however, then both spaces possess the dimension 6. In fact, in this case the space consists of all quadratic polynomials on the physical domain.Here we consider an isogeometric functionfδ∈V(2,2)represented in the form (8) with the control points given in Table 1. The setD0of singularities contains only one point,D0={(0,0)}. The right part of Fig. 2 depicts a patch of type P2. Again, the inner control point depends on δ. Similar to type P1 we conclude thatfδ∈C1(Ω¯)if and only if(13)2f(0,0)=f(0,1)+f(1,0)f(2,0)−f(0,2)=2f(1,0)−2f(0,1).Moreover,fδ∈C2(Ω¯)if and only if (13) and(14)4δ2f(0,0)+(4+2δ1−2δ2)f(0,1)−2f(0,2)=4f(1,1)−(1−δ1−δ2)(f(2,1)+f(1,2))(15)(f(0,2)+f(2,0))(δ1−δ2)=(4δ1−6δ2)f(0,1)+2δ1f(1,0)+(δ1+δ2)(f(1,2)−f(2,1))are satisfied. If(δ1,δ2)=(0,0)then Eq. (15) can be omitted since both sides vanish.The spaces ofC1andC2smooth isogeometric functions obtained from the biquadratic parametrization have generally the dimensions 7 and 5, respectively. Ifδ1=δ2=0, however, then the latter space has dimension 6.We consider an isogeometric functionfδ∈V(2,2,2)represented by(16)f˜δ(u1,u2,u3)=∑i1=02∑i2=02∑i3=02f˜(i1,i2,i3)Bi1,i2,i3(u1,u2,u3)with tensor-product Bernstein polynomialsBi1,i2,i3of degree(2,2,2)and control pointsf˜(i1,i2,i3)=(1,i1,i1i22,i1i32,f(i1,i2,i3))Tfor(i1,i2,i3)≠(1,1,1),f˜(1,1,1)=(1,1+δ1,12+δ2,12+δ3,f(1,1,1))Totherwise,as depicted in Fig. 3. Note that the inner control point depends on δ. The set of singular points isD0={(0,u2,u3),0≤u2,u3≤1}.One can show thatfδ∈C1(Ω¯)if and only if the coefficients of the isogeometric function satisfy(17)f(0,i2,i3)=f(0,0,0)for all0≤i2,i3≤2and six additional linearly independent equations. We do not write down the equations explicitly, since this would not give any further insight. Eq. (17) leaves one degree of freedom for the coefficients with indexi1=0. The six additional equations restrict the coefficients withi1=1. The remaining coefficients remain unrestricted. Summing up, the dimension of the space ofC1smooth functions is equal to1+3+9=13.Similarly we can characterizeC2(Ω¯)smoothness by (17) and 12 further equations. Generally, the space ofC2smooth functions has dimension 7. Ifδ1=δ2=δ3=0, the dimension raises to 10. In this case, the space ofC2smooth isogeometric functions is described by Eqs. (17), as well asf(1,0,1)=12(f(1,0,0)+f(1,0,2))f(1,2,1)=f(1,2,0)+12(f(1,0,2)−f(1,0,0))f(1,1,0)=12(f(1,0,0)+f(1,2,0))f(1,1,2)=f(1,0,2)+12(f(1,2,0)−f(1,0,0))f(1,1,1)=12(f(1,0,2)+f(1,2,0))f(1,2,2)=f(1,0,2)+f(1,2,0)−f(1,0,0)andf(2,1,2)=f(2,0,0)−2f(2,0,1)+f(2,0,2)−f(2,1,0)+2f(2,1,1)f(2,2,1)=f(2,0,0)−f(2,0,1)−2f(2,1,0)+2f(2,1,1)+f(2,2,0)f(2,2,2)=3f(2,0,0)−4f(2,0,1)+f(2,0,2)−4f(2,1,0)+4f(2,1,1)+f(2,2,0).This space is equal to the space of quadratic polynomials on the physical domain. If a perturbation is present, however, this is no longer true and the approximation power is reduced.We consider an isogeometric functionfδ∈V(2,2,2)represented in the form (16) with control pointsf˜(i1,i2,i3)=(1,i1,i1i22,i1i2i34,f(i1,i2,i3))Tfor(i1,i2,i3)≠(1,1,1),f˜(1,1,1)=(1,1+δ1,12+δ2,14+δ3,f(1,1,1))Totherwise,as shown in Fig. 4. The patch is singular for all points in the setD0={(0,u2,u3),0≤u2,u3≤1}∪{(u1,0,u3),0≤u1,u3≤1}. Again, the inner control pointf˜(1,1,1)depends onδ=(δ1,δ2,δ3).The conditions forC1(Ω¯)smoothness lead to 17 independent equations, leading to a space of dimension 10. If no perturbation is applied, then this space is equal to the space ofC2smooth functions (which is equal to the space of all quadratic polynomials on the tetrahedron in this case). Generally, however, the space ofC2smooth functions has dimension 7 only.This example covers a different class of singularities. The top face of the object is equivalent to the triangular patch P2. All other faces are non-degenerate quadrilaterals. We consider an isogeometric functionfδ∈V(2,2,2)represented in the form (16) with control pointsf˜(i1,i2,0)=(1,i1,i2,0,f(i1,i2,0))Tfor0≤i1,i2≤2f˜(i1,0,i3)=(1,i1,0,i3,f(i1,i2,0))Tfor0≤i1,i3≤2f˜(0,i2,i3)=(1,0,i2,i3,f(0,i2,i3))Tfor0≤i2,i3≤2andf˜(1,1,1)=(1,78+δ1,78+δ2,1+δ3,f(1,1,1))T,f˜(1,1,2)=(1,34,34,2,f(1,1,2))T,f˜(1,2,1)=(1,34,74,1,f(1,2,1))T,f˜(1,2,2)=(1,12,32,2,f(1,2,2))T,f˜(2,1,1)=(1,74,34,1,f(2,1,1))T,f˜(2,1,2)=(1,32,12,2,f(2,1,2))T,f˜(2,2,1)=(1,32,32,1,f(2,2,1))T,f˜(2,2,2)=(1,1,1,2,f(2,2,2))Tas shown in Fig. 5. There is exactly one singular point,D0={(1,1,1)}, which corresponds to the control point with index(2,2,2). In the unperturbed case, the parametrization of the domain (i.e., the control points without the last coordinate, which corresponds to the isogeometric function) have been constructed by applying degree elevation to a tri-linear patch. TheC1(Ω¯)smoothness offδis characterized by four linearly independent equations, leaving a space of dimension 23. The space ofC2smooth isogeometric functions has dimension 18. The basis functions with indices(0,0,0),(1,0,0),(0,1,0)and(0,0,1)are not involved in the nine equations. In this example the dimension of the space ofC2smooth isogeometric functions is not reduced if the inner control point is perturbed. This, however, is not true when the perturbation is applied to control points different fromf˜(1,1,1).In all but the last of the presented examples, the dimension of theC2smooth subspace of the isogeometric function space depends on the location of the “free” inner control point. Using perturbations of other control points lead to similar results.Hence, the smoothness properties are very sensitive with respect to the choice of the parametrization. This should be taken into account when dealing with applications that need very smooth functions, since usingC2smooth isogeometric functions will often be too restrictive. In the vicinity of the singularity, the space spanned by these functions does not provide a representation of low-degree polynomials in the physical space (see especially types P1, V1, V2). This indicates the reduction of approximation power.In concrete applications, one should try to find a parametrization that leads to a high-dimensional space. We observed that parametrizations obtained by degree elevation of (bi-/tri-)linear ones are quite useful.We extend the result of Section 3 to functions on n-manifolds embedded intoRd, wheren<d. More precisely, we derive a representation of the intrinsic gradient of an isogeometric functionf∈V.We consider an n-dimensional patchr(u)with homogeneous representationr˜(u)=(r˜0(u),r˜1(u),…,r˜d(u))Tembedded intoRd, withn<d, and an isogeometric function f defined on r. Letx0∈Rdbe a point on the patch r. Let F be an extension of f to an open neighborhoodNx0⊂Rdofx0. The intrinsic gradient∇rfof f is∇rf(x0)=Πr(∇xF(x0)),where∇xFis the gradient of F with respect to x inNx0and the operatorΠrprojects a vector orthogonally into the tangent space of the patch r atx0(see e.g. Šír et al., 2008). When considering a surface in the three-dimensional space (i.e.n=2,d=3), this projection takes the formΠr(∇xF)=∇xF−((∇xF)Tn)n,where n is the unit normal vector of r inx0.The projection of the gradient onto the tangent space does not depend on the extension F of the function f into the embedding space, but it is fully determined by values of F on the patch (i.e.∇rfonly depends on f). The intrinsic gradient is therefore well-defined.We choose a particular extension F of f that allows to obtain the intrinsic gradient without the projection. The n-dimensional patchr˜(u), withu∈Rn, is extended to a d-dimensional patch inRd. Consider a basisnn+1(u),…,nd(u)of the normal space at u, i.e.(∂jr)Tnk=0for allj=1,…,nandk=n+1,…,d, where r is the representation ofr˜in Cartesian coordinates. Moreover letN=(nn+1,…,nd). We denote byF(u,u+)=(r(u)rd+1(u))+(u+N(u)0)the extended graph of f, with the row vectoru+=(un+1,…,ud)andu+N(u)=∑j=n+1dujnj(u).There are several possibilities to obtain a basis of the normal space. In the cased=3andn=2, the normal space is spanned simply by the normal vector∂1r×∂2r. For other values of d and n, however, the choice of the directions of the normal vectors is not unique. We outline an approach to generate the homogeneous representation of the normal space directly.In order to generate a setN˜of normal vectorsn˜k,n+1≤k≤d, of low degree, we consider the hyperplanes{x˜:det⁡(r˜,∂1r˜,…,∂nr˜,q˜n+1,…,q˜d−1,x˜)=0}which are spanned byr˜, by the n partial derivatives ofr˜and byd−n−1arbitrarily chosen auxiliary pointsq˜n+1,…,q˜d−1. The coordinates of their normal vectors are the coefficients ofx˜1,…,x˜nin the expansion of the determinant. These hyperplanes contain the tangent space of the patchr˜. Hence their normal vectors are possible choices for the vectorsn˜k, withn+1≤k≤d. Applying this construction for(d−n)sets of auxiliary points in general position leads to a set of(d−n)linearly independent normal vectors of degreepn≤(n+1)p−1.Rewriting the representation of the graph of the extended function F in homogeneous coordinates gives(18)F˜(u,u+)=(r˜(u)r˜d+1(u))+(u+N˜(u)0),whereN˜=(n˜n+1,…,n˜d). The entriesn˜jkof the vectorsn˜kare chosen asn˜jk=njkandn˜0k=0for alln+1≤k≤dand1≤j≤d. The graph of the isogeometric function defined on the patchr˜is represented byF˜(u,0)=(r˜0(u),…,r˜d+1(u))T=f˜(u). We denote withe˜jthe unit vector that spans the j-th coordinate axis inRd+1.Theorem 5The graph of the i-th component∇r,ifof the intrinsic gradient is represented by the parametric surfaceDif˜=(r˜0g˜d+1,r˜1g˜d+1,…,r˜dg˜d+1,−r˜0g˜i)T,whereg˜j=det⁡(e˜j,f˜,∂1f˜,…,∂nf˜,m˜n+1,…,m˜d)withm˜k=(n˜k0).ProofApplying Theorem 3 to the extended graphF˜givesDiF˜=(F˜0q˜d+1,F˜1q˜d+1,…,F˜dq˜d+1,−F˜0q˜i)T,withq˜j=det⁡(e˜j,F˜,∂1F˜,…,∂dF˜).The hypersurfaceDiF˜represents the i-th component of the gradient∇xF. Restricting the gradient∇xFto the patch r is equivalent to restricting the parameter value to(u,u+)=(u,0). Hence,DiF˜|{u+=0}=(r˜0g˜d+1,r˜1g˜d+1,…,r˜dg˜d+1,−r˜0g˜i)T,withg˜j=q˜j|{u+=0}=det⁡(e˜j,f˜,∂1f˜,…,∂nf˜,m˜n+1,…,m˜d).The gradient∇xFcan be decomposed as∇xF=Πr(∇xF)+Πn(∇xF),whereΠrandΠnare the orthogonal projections into the tangent space and into the normal space, respectively. The extended function F is constant in any normal direction. Hence, the normal componentΠn(∇xF)vanishes and∇xF=Πr(∇xF)=∇rf,which concludes the proof.  □Consider an isogeometric functionf∈Vp,s. If the homogeneous normal vectorsn˜jcan be represented as polynomials of degreepn, then the degree of the derivative patches is bounded by(d−n)pn+(n+2)p−1.Higher order derivatives of f can be computed recursively. The Hessian of f, as a tensor inRd×dcan be computed by applying the gradient operator∇ragain to each component of∇rf.When considering a surface inR3, the normal space in u is spanned by the normal vectorn(u)=∂1r(u)×∂2r(u). In homogeneous coordinates this leads tom˜=−(0det⁡(e˜1,r˜,∂1r˜,∂2r˜)det⁡(e˜2,r˜,∂1r˜,∂2r˜)det⁡(e˜3,r˜,∂1r˜,∂2r˜)0).Hence the degree of the normal vector is bounded bypn=3p−1, leading topn+4p−1=7p−2as a bound on the degree of the gradient patches. We analyze the smoothness of isogeometric functions on several singular surface patches which are embedded in the three-dimensional spaceR3.Patches of type S1 contain a singularity caused by an edge collapsing to a point in physical space (similar to P1). Patches of type S2 possess parallel tangents at the corner points (similar to P2).The first example from type S1 is an octant of the unit sphere (cf. Piegl and Tiller, 1995), while the second one is a polynomial approximation of the same patch.We consider an isogeometric function f represented by its graph surface as in (8) with the control points given in Table 2. Using Theorem 5, we conclude thatf∈C1(Ω¯)if and only if(19)f(0,0)=f(0,1)=f(0,2)f(1,2)−f(1,1)+f(1,0)−f(0,0)=0.Similar to the results for type P1, Eq. (19) expresses the condition that the pointsf(0,0),f(0,1),f(0,2),f(1,0),f(1,1)andf(1,2)are contained in a 2-plane inR4.When consideringC2(Ω¯)smoothness, we obtain a more restrictive result. We apply Theorem 5 to each component of the intrinsic gradient. The isogeometric function satisfiesf∈C2(Ω¯)if and only if Eq. (19) and(20)f(2,1)−f(1,1)+f(2,0)−f(1,0)=0f(2,2)−f(2,0)+f(1,0)−f(1,2)=0.Consequently, the space ofC2smooth isogeometric functions of this type has dimension 4.Now we modify the previous patch by setting the denominator to 1, i.e., we omit the factors in front of the homogeneous coordinate vectors in Table 2. This gives a polynomial approximation to the octant of the sphere. Similar to the previous example,f∈C1(Ω¯)if and only if Eq. (19) is satisfied. The conditions(21)f(0,0)=f(0,1)=f(0,2)=f(1,0)=f(1,1)=f(1,2)f(2,0)+f(2,1)=2f(0,0)f(2,2)=f(2,0)forC2(Ω¯)smoothness, however, are now far more restrictive and leave only 2 degrees of freedom. This is due to the lack of smoothness of the surface itself at the singularity.Finally we consider the two surface patches shown in Fig. 6with the control points listed in Table 3. The boundary of the first patch is a circle, and the boundary of the second one is a smooth curve.The space ofC1smooth isogeometric functions of the degree(2,2)has dimension 4 for the first patch, but only 1 for the second one. Both patches admit only constantC2smooth isogeometric functions.For these examples, perturbations of the control points change the surfaces themselves. In the second example, the conditions do not depend on the position and the weight of the control point with index(1,1). Comparing the two surfaces of type S1 leads to the conclusion that even minor changes of a surface can reduce the dimension of smooth function spaces dramatically. This has to be taken into account when dealing with singular patches in isogeometric analysis, where it is crucial to have sufficient degrees of freedom locally in order to maintain sufficient approximation power.

@&#CONCLUSIONS@&#
