@&#MAIN-TITLE@&#
An optimized Radial Basis Function model for color characterization of a mobile device display

@&#HIGHLIGHTS@&#
A novel method for characterization of a mobile device display based on Radial Basis Functions is presented.An overview of other state of the art methods for color characterization is given.Compared methods are tested on a number of various mobile devices.It is found that proposed method for color calibration is flexible and very accurate.Future research perspective for further optimization of the model is given.

@&#KEYPHRASES@&#
Approximation methods,Characterization,Colorimetry,Color displays,Neural networks,Piecewise linear approximation,Radial Basis Functions,

@&#ABSTRACT@&#
This paper presents an optimized color characterization model based on Radial Basis Functions (RBFs). The performance of the proposed model was tested on a number of different mobile devices and compared with the performance of other state of the art color characterization models. We compared the accuracy of models using the CIELAB color difference. Four different models were discussed in detail: Piecewise Linear Model Assuming Variation in Chromaticity, Polynomial regression, Artificial Neural Network, and proposed Radial Basis Function model. For training and evaluation of the models we measured a large number of color samples on various mobile device displays. Results have shown that our optimized RBF model has superior accuracy over other models with median color difference of 0.39. In addition, it has particularly good accuracy for colors on the boundary of device’s gamut with maximum color difference of 0.87, where other models shown unacceptably high (>10) color difference.

@&#INTRODUCTION@&#
Mobile devices today are ubiquitous and used in wide range of different applications from personal communication to image reproduction. Equipped with powerful imaging and processing hardware, mobile devices enable users to capture and view high resolution static images and interactive content. The expanding functionality of mobile devices is followed by rapid development of transmissive and emissive mobile display technologies.Most mobile devices on the market feature an Active Matrix Liquid Crystal Display (AMLCD) or an Active Matrix Organic Light-Emitting diode (AMOLED) display. AMLCD is a transmissive display technology based on controlled orientation of molecules in the liquid crystal (LC) layer through which light passes and forms the rendered image on the display. The LC layer is situated between two electrodes, one being controlled by active-matrix backplane and the other situated beneath the color filter. By controlling the voltage difference between the electrodes, molecular array of liquid crystals can be adjusted, thus controlling the intensity of the transmitted light [1]. Several different configurations of molecules in the LC layer, or Liquid Crystal Display Modes, exist: Twisted-Nematic (TN), In-Plane Switching (IPS), Vertical Alignment (VA) and Patterned Vertical Alignment (PVA). AMOLED represents an emissive display technology. AMOLED panels consist of series of organic thin films situated between two electrodes, a metal-based cathode and transparent anode. Instead of usual RGB subpixel array, AMOLED displays found in mobile devices often feature a RG-BG subpixel array, also known as PenTile array [2]. Compared to AMLCDs, AMOLEDs usually offer wider-viewing angles, better contrast ratio, significantly wider gamut and thinner construction, which make this technology attractive for mobile displays.The progress and widespread use of mobile technology is not adequately followed by research on colorimetric characterization of mobile devices. The display characterization in general is extensively researched. Authors in [3–5] give an extended overview of methods for characterizing CRT displays. While methods for characterization of LCD displays is given in [6–8]. On the other hand, research on characterization focused just on mobile displays is very limited. Only Piecewise Linear Model Assuming Constant Chromaticity (PLCC), Piecewise Linear Model Assuming Variation in Chromaticity (PLVC), and masking models where applied on mobile device displays [9].The goal of our paper is to broaden the available research on the subject of color characterization of mobile device displays, and to develop flexible and accurate model for color characterization of mobile device display. We propose a model for color characterization of mobile device display based on Radial Basis Functions (RBFs) and compare its performance against other popular approaches for color characterization: Piecewise Linear Model Assuming Variation in Chromaticity (PLVC), Polynomial regression model, Artificial Neural Network (ANN) model. We compare performance of the models in respect to number of training samples needed and color difference between estimated and measured data. For training and evaluation we use data obtained from twenty different mobile devices with different AMLCD and AMOLED display technologies.The main goal of the colorimetric characterization of a device is to obtain a model that will accurately transform color information from device dependent color space to device independent color space and vice versa. With the obtained model it is possible to estimate exact driving signals of the device for a needed color. A device dependent color space such are RGB and CMYK color spaces are not absolute color spaces, i.e. they differ from device to device. A device independent color space such are CIEXYZ and CIELAB are absolute and describe color as it is seen by a CIE standard observer [10]. In literature X, Y and Z values of CIEXYZ color space are also known as CIE tristimulus values.According to [11], all methods or models can be classified in three different groups: the methods that try to physically model the behavior of a color device, the methods based on numerical models, and the methods that are using 3D Look Up Tables (3D LUT).Physical modeling is usually carried out in three steps. Firstly, the linearization of the tone reproduction curves (TRCs) of the devices’ channels is done by modeling curves with a gamma law (CRT) or S-shaped curves (LCD) [12–17]. When the signals are linearized, transformation from device dependent color space (RGB) to the device independent color space (CIEXYZ) is done. Finally, an offset is added to the output (1).(1)i=M·f(d)+owhereidenotes output vector in independent color space; d denotes vector with driving signals in dependent color space,f(·)is linearization function;Mrepresent transformation matrix, whileodenotes offset vector.Generally, physical models assume a number of simplifying conditions such are channel independence, chromaticity constancy, spatial uniformity, and angle view independence. Channel independence assumes that the primaries of the device operate independently from one another. Chromaticity constancy assumes that each primary has constant chromaticity values regardless of the intensity of a driver signal. Spatial uniformity ensures that the output values will be the same, irrespective of the position on the device. Angle view independence assumes constant output values indifferent to the viewing angle. Color characterization of CRT displays was extensively studied in the past [18–20,12,4,21] and these assumptions where tested and validated in experiments [18,22].Numerical characterization estimate transformation from a device dependent space to a device independent space using a numerical model. This model can be based on a number of different methods such as polynomial regression of n-th degree [23], neural networks [24,25], sequential linear interpolation [26], or Radial Basis Functions (RBFs) [27,28]. In comparison with the physical models, this approach is able to successfully model devices without assumption of channel independence. However, for this to be possible, large number of measurements are needed. It should be noted that numerical methods are extensively used for characterization of printers as well [6,29].3D LUT models are based on tables with the information how to translate color information from a device dependent space to a device independent space. The accuracy of the model depends on the number of measurements taken to create the table [30], and the interpolation method to transform the color information for data that is between measurement points [31]. The main disadvantage of this approach is the need for large number of measurements. On the other hand, its advantage is that this approach does not imply any assumptions regarding the display technology.PLVC model was first proposed in 1980 by Farley and Gutmann in [32]. Later it was extensively used and evaluated for CRT displays [12,33,5] and for LCD displays [7,6,34]. It is extension of Piecewise Linear Model Assuming Constant Chromaticity (PLCC), which it supersedes in accuracy, especially for displays where the chromaticity shift for different illuminance levels is high [11].According to PLVC model, tristimulus values for any driving signal of the device can be expressed as a sum of tristimulus values for each primary for that driving signal. PLVC model can be generalized for any number of primaries, as well as for any number of possible levels of a driving signal. For a device with N primaries with L possible driving signal levels PLVC model is defined in (2).(2)X(p1(s1),p2(s2),…,pN(sN))=∑i=1i=NX(pi(si))-Xk+XkY(p1(s1),p2(s2),…,pN(sN))=∑i=1i=NY(pi(si))-Yk+YkZ(p1(s1),p2(s2),…,pN(sN))=∑i=1i=NZ(pi(si))-Zk+ZkwhereX,Y,Zdenote CIE tristimulus values;piisithprimary (i∈[0,N]) andsiis a driving signal level forithprimary (si∈[0,L]).Xk,Yk,Zkdenote tristimulus values for black level, (i.e.si=0∀pi).Since the values of the black level are included in every measured sample it is important to subtract it first from all samples, and then add it only once to ensure correct standard observer color space [35].Main advantage of PLVC model is that it needs only a small number of measured samples. In addition, it is very simple to implement. On the other hand, this model does not take into account channel interdependence.Implementation of PLVC was done using (2) forN=3primaries (i.e. R, G and B). Nine different driving signals of each primary were used for the model (Sr,Sg,Sb∈[0,32,64,96,128,160,192,224,255]). To calculate response of the model for other driving signals, linear interpolation was used as this approach was used in previously published research [7,6,34]. Note that the interpolation method can influence the performance of PLVC, however, this is not within the scope of this paper.Regression models are statistical models used for estimation of relationships among variables. These well-known methods are used in wide range of applications from data fitting to data prediction. Many different regression methods exist, such as linear, polynomial, robust, Bayesian, and non-parametric.Polynomial regression is a type of linear regression where the relationships between variables are modeled as n-th degree polynomial. It is often used to model complex nonlinear systems such as optical character recognition [36], multimodal biometrics classification [37], and color characterization [38,39]. General n-th degree polynomial regression model using matrix notation is defined as (3).(3)y=x·a+εwhereydenotes response vector,aparameter vector,εrandom error vector, whilexis vector containing independent variables.Solution of the model in (3) is then given by the well-known normal equation [40]:(4)a=(xTx)-1xTyEq. (3) is an example of multidimensional polynomial regression model that is easy to use for a multidimensional problem like color characterization of a color device. This approach can successfully take into account channel interdependence by using cross components factors in the model [4,21,34]. This is done by including in vectorxproducts of driving signals for two or more primaries of a device. Excellent introduction to polynomial regression used for color characterization is given by Kang [41]. In our investigation, two different degrees of regression models were used: Polynomial regression of 2nd degree and polynomial regression of 3rd degree. Polynomial regression of 2nd degree has vectorxwith nine interdependent variables (5).(5)x=[1rgbrgrbgbr2g2b2]This model takes into account channel interdependence for any two primaries (i.e.r,g,b). However, it is not able to model channel interaction for all three primaries. On the other hand, polynomial regression of 3rd degree has 19 variables capable of modeling channel interdependence for all three primaries (6).(6)x=[1rgbrgrbgbr2g2b2r2gr2b⋯g2rg2bb2rb2gr3g3b3rgb]The Artificial Neural Network (ANN) is model that simulates biological nervous system where each neuron of the ANN is analog to nerve cell, and connections between neurons are analog to synapses. An artificial neuron is composed of three parts, inputs with weights, a transfer function and an activation function (Fig. 1). The transfer function usually adds together values from the weighted inputs, while activation function defines the output of the neuron. There are many types of activation functions used (e.g. identity, step, ramp, logistic) and the type of an activation function influence the behavior of the entire ANN.The most important property of ANN is its ability to adaptively change the weights in artificial neurons to approximate the intrinsic properties of complex training data and to generalize these learnt properties for similar data not used in the training process. ANN is often used to process complex data in applications such as classification [42] or approximation [43]. Main advantage of ANNs is the ability to adjust to data, without any information regarding the process to be modeled. In addition, ANNs are nonlinear in nature and, therefore, capable to model very complex processes. Finally, they are capable to approximate any function with arbitrary accuracy [44]. However, it should be noted that the accuracy of ANN is still limited with the size of the network and the availability of the data used in training [42]. Furthermore, ANNs are highly nonlinear in parameters which implies the use of nonlinear optimization techniques [45]. Other common problem with ANNs is over-fitting, where the network fits training data well but fails to generalize, i.e., fit data not used for training.For an ANN architecture we used a simple network with input and output layers and one hidden layer. In the hidden layer as activation function we used logistic function while for the output layer linear function was used. For learning, the ANN model used Levenberg–Marquardt algorithm (LMA). Even though LMA is both time and memory consuming especially if the network has significant number of adaptive weights, it is very popular and often used for training of neural networks [46].The architecture of the ANN model used in the experiment is shown in Fig. 2. The number of neurons in input and output layers was fixed to three neurons. While the number of neurons in hidden layer was changed in order to find an optimal number of neurons.We propose a new model based on Radial Basis Function (RBF) methods. It extends the work of Sharma and Shaw [27] and Colantoni et al. [28]. Authors in [27] proposed the use of thin-plate splines functionθ(r)=r2ln(r)for color characterization of a printer and thoroughly investigated the influence of size of the training data on the performance of the model. They concluded that this approach is fairly accurate when enough of data points is used for the training of the model. Authors in [28] extended existing research by utilizing additional basis functions, namely biharmonicθ(r)=r, and triharmonicθ(r)=r3and applied their model on CRT and LCD displays.In our paper we further the investigation of RBFs by utilizing polyharmonic splines (8) with different k, Gaussian (9) and multiquadric (10) kernels. We investigate how this model performs in color characterization of a number of mobile devices, and optimize it by choosing the RBF kernelθ(·)and modifying the scaling factorε(7). After the optimization of the model we compare its performance against the performance of already mentioned models (i.e. PLVC, ANN, and polynomial regression).One other important difference from previous research is that our model doesn’t use smoothing factor used to overcome the problems of the display temporal stability. Reasons why we have discarded this approach is that smoothing factor complicates the model, and our empirical data showed that repeatability between consecutive measurements of mobile device due to temporal variability was very small (ΔEab∗<0.01).RBF methods are global interpolation methods proposed in [47] and revisited in [48]. The basic idea of RBF interpolation is to choose appropriate functionθ(·)(also known as kernel), and determine weightswidepending on given data points (7).(7)f(x)=∑wiθ‖ri‖wheref(x)is interpolated value at the pointx,ridenotes distance between given data pointxito x (i.e.ri=x-xi).‖·‖is the Euclidean norm.The choice of functionθ(·)should be made depending on the class of interpolation problem [31,49]. Some of the kernels used are harmonic, multiquadric, Gaussian and polyharmonic splines.The main advantage of RBF method is that it works well even if the data points on which fitting is based are scarce or unevenly distributed [49]. This is indeed the case for many applications especially when one wants to optimize a characterization procedure of a color device using as few data points as possible. We implemented RBF network using different kernelsθ(·), namely, polyharmonic splines of different order (8), gaussian (9) and multiquadric (10).(8)θ(r)=rkfork=1,3,5…rklog(r)fork=2,4,6…(9)θ(r)=e-(εr)2(10)θ(r)=1+(εr)2Note that scaling constantεhas impact on the overall performance of the model, especially for Gaussian. We have empirically found that optimal value forεis from 2 to 5. In experiments we usedε=3.After RBF function is chosen, weightswineeded for the model are determined by using already mentioned normal equation [40]:(11)w=(θTθ)-1θTxwherew,θandxdenote matrices of weightswi, coefficientsθ(ri), and given data pointsxirespectively.Experimental setup is shown in Fig. 3. Device dependent values in RGB space were sent to a mobile device using web based script. Response of the mobile device is then measured with luminance and color meter connected to a computer. Finally, measurements and device dependent values were used for training of models.For data acquisition we used 20 different mobile devices from various manufacturers and with different display technologies.1Measurements can be downloaded from: http://repro.grf.unizg.hr/media/Measurements_displays.zip.1For each device 729 uniformly spaced color samples (i.e. different RGB combinations) were measured from black (RGB=0,0,0) to white (RGB=255,255,255). To avoid possible changes in brightness level during measurement, all devices were set to have fixed maximum brightness.All measurements were done in CIEXYZ color space. Measuring distance from the device was 350mm±1mm, and angle from the normal was 0°±0.5°. Measurements were taken in completely dark room (illuminanceE<10-4lx). For measurement we used Konica Minolta CS-200 luminance and color meter with following parameters: Measurement time 2s, Viewing angle 2°. To avoid possible errors due to instability of the device’s display, each color sample was measured two times and mean was calculated. Distance from the display and viewing angle give measuring areaAm=117.25mm2. With fixed measuring area the number of pixels measured depended only on spatial resolution of device (e.g. for the resolution of 10px/mm the number of pixels measured is 11,725). This large number of pixels, and the focus of measuring device set to infinity, minimizes the possibility of the influence of pixel variations on measurements.After acquisition, measured data was uniformly divided in two subsets: a training subset used for training of the models, and the evaluation subset used for performance evaluation. Therefore, for training of models 365 equally spaced samples were used, while for evaluation 364 samples were used. Note that for PLVC model only 27 samples were used (nine for each primary).As already mentioned, to avoid the influence of the different brightness between devices all displays have been set to their maximum brightness settings. This, however, still results in very different lightness values for different devices. These large differences are due to different technologies displays are using. We can neutralize this difference in measured lightness across devices by normalization of all measured values according to its maximum value for a given device (12):(12)Yi′=YiYmaxwhereYi′denotes normalized Y value in CIEXYZ color space;Yiis measured Y value, andYmaxmaximum Y value of all measurements of a given device.To evaluate the accuracy of a model, obtained results and measured evaluation samples were converted from CIEXYZ color space to more convenient CIELAB color space. As a white point needed for the conversion from CIEXYZ to CIELAB color space, standard illuminant CIE D65 was used. We choose this illuminant as a white point since most LCD displays white point is near this illuminant [6], and it is recommended by CIE to be used for all colorimetric calculations requiring representative daylight illuminant [50]. However, note that the choice of the illuminant, if used consistently, will not influence the colorimetric comparison. For quantification of the color rendering accuracy of models, CIELAB color difference system was used. Color differenceΔEab∗is defined in (13). It is the Euclidean distance of two respective colors in CIELAB color space.(13)ΔEab∗=(ΔL∗)2+(Δa∗)2+(Δb∗)2whereΔL∗,Δa∗andΔb∗denote difference between respective colors in CIELAB color space for lightness axis (L∗) and two chromatic axis(a∗,b∗).

@&#CONCLUSIONS@&#
