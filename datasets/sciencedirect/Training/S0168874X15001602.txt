@&#MAIN-TITLE@&#
Direct-differentiation-based sensitivity analysis of an axisymmetric finite element formulation including torsion

@&#HIGHLIGHTS@&#
We present a sensitivity analysis for axisymmetry including torsion using the direct differentiation method.The sensitivity analysis is performed in the framework of finite strains.The accuracy is assessed by comparison with finite difference results.The sensitivity analysis permits the use of gradient-based methods in shape optimization in axisymmetry with torsional loads.

@&#KEYPHRASES@&#
Finite element modeling,Generalized axisymmetry,Direct differentiation,

@&#ABSTRACT@&#
The shape sensitivity analysis using the direct differentiation method is developed for the case of axisymmetry with superposed torsion in the framework of finite strains and elastic material behavior. The accuracy of this method is compared to results obtained by the finite difference method in two simple examples.

@&#INTRODUCTION@&#
In case of axisymmetric or near-axisymmetric geometries, generalized axisymmetry offers the possibility to reduce a three-dimensional model to a two-dimensional model with additional degrees of freedom in tangential direction. Generally speaking, the geometry is defined in a plane, and a discrete Fourier expansion is operated in tangential direction, in order to take into account either a non-axisymmetric geometry or, as in most cases, non-axisymmetric loads. The introduction of a single degree of freedom in tangential direction enables the treatment of axisymmetry with superposed torsion. The generalized axisymmetry thus offers the possibility to strongly reduce the computational effort by reducing the number of degrees of freedom in comparison to a full three-dimensional model. This may especially be of interest in optimization or inverse problems, where the same finite element model has to be recomputed a significant number of times. An additional advantage of an axisymmetric model concerns contact mechanics, as the treatment of contact surfaces in three dimensions is reduced to that of contact curves in two dimensions, which greatly simplifies modeling and enables the use of methods for more efficient contact treatment, like for example contact surface discretizations with C1-continuity [1].Among the first authors to produce a finite element formulation for generalized axisymmetry are [2,3] for linear elasticity and [4] for inelastic materials, both at small strains. Finite strain formulations for generalized axisymmetry in solid mechanics have been presented in [5], and later on in various contexts like thermomechanical homogenization [6], mixed or enhanced strain formulations [7–9], ALE formulations [6], consolidation analysis [10], or others [11,12]. Contact mechanics in the context of generalized axisymmetry has been treated in [14], for example. One of the major challenges in finite strains is that the base vectors vary with position [13]. The treatment of generalized axisymmetry may be executed either in mathematical or physical coordinates [15], using different ways to arrive at the equations of virtual work. Different mathematical concepts are use for an efficient treatment of generalized axisymmetry. For example, use is made of a mathematical shifter tensor in [16] for deriving the kinematics of generalized axisymmetry. In [5], the finite element equations use cylindrical coordinates for the description of the geometry, but the displacements are kept in Cartesian coordinates, in order to avoid displacement locking. Issues related to the numerical integration of axisymmetric finite element formulations are discussed in [17], an improved treatment of incompressibility is detailed in [18] and methods for reducing mesh locking in the context of axisymmetry are given in [19–21], for example.Sensitivity analysis, i.e. the calculation of derivatives with respect to model parameters like material or shape parameters, amongst others, is useful in gradient-based solution methods of inverse problems or shape optimization. Various aspects of sensitivity analysis in standard axisymmetry have been presented in [22–24], for example. Recently, the sensitivity analysis using the adjoint state method for generalized axisymmetry with fully asymmetric loading has been presented in [25] for the case of small strains. In the present work, sensitivity analysis based on the direct differentiation method is presented for finite strains for the most simple case of generalized axisymmetry, i.e. axisymmetry with superposed torsion. First, the kinematics of generalized axisymmetry are outlined. Then, the linearization and sensitivity analysis of the kinematic quantities are presented and introduced into the virtual work equation. With the sensitivity of the Cauchy stress, the discretized formulation of the linearized virtual work equation is given. Finally, the performance of the sensitivity analysis is assessed in two examples by comparing the sensitivities obtained by direct differentiation to those obtained by the finite difference method.According to [13], the geometry x in the current state, described by the coordinates r, z and ϕ,(1)x=rer+zez,is related to the initial geometry with coordinates R, Z and Φ through the radial displacement u, the vertical displacement v and the angular displacement θ:(2)r=R+u(R,Z)z=Z+v(R,Z)ϕ=Φ+θ(R,Z).The current basis vectors areer,eϕandez, the first two depending on ϕ. Then, the deformation gradient can be expressed as(3)F=(∂r∂R∂r∂Z0∂z∂R∂z∂Z0r∂ϕ∂Rr∂ϕ∂ZrR∂ϕ∂Φ)=(1+∂u∂R∂u∂Z0∂v∂R1+∂v∂Z0r∂θ∂Rr∂θ∂Z1+uR).Taking into account that in polar or cylindrical coordinates, the non-zero variations of the basis vectors are(4)δer=δθeϕδeϕ=−δθer,the variation of the deformation gradient, Eq. (3), becomes(5)δF=(∂δu∂R∂δu∂Z0∂δv∂R∂δv∂Z0r∂δθ∂Rr∂δθ∂ZδuR)+(000000δu∂ϕ∂Rδu∂ϕ∂Z0)+δθ(−r∂ϕ∂R−r∂ϕ∂Z−rR000∂r∂R∂r∂Z0).With the partial velocity gradient(6)δL˜=(∂δu∂r∂δu∂z0∂δv∂r∂δv∂z0r∂δθ∂rr∂δθ∂zδur)and the sparse anti-symmetric tensor(7)δΞ=(00−δθ000δθ00),the variation of the deformation gradient can be expressed as(8)δF=δL˜F+δΞF,where the last term in Eq. (5), which stems from the basis variation, equals the last term in Eq. (8). The variation of the velocity gradientδLis subsequently obtained by multiplying Eq. (8) by the inverse of the deformation gradient, yielding(9)δL=δFF−1=δL˜+δΞ.In opposition to sensitivities of kinematic entities with respect to material parameters, where the sensitivities correspond to a linearization, shape sensitivities include additional terms because the initial and current coordinates include the shape change. Thus, for shape sensitivities, Eq. (2) has to be rewritten using a reference geometry,Xr, a design velocity V and a parameter τ quantifying the design change, as described in [26,27]. In the following, the sensitivity of a generic variable α, designating either a scalar or a first or second order tensor, is defined as(10)[α]⋄=limτ→0α(Xr+τV(Xr))−α(Xr)τ.It should be noted that the design change is prescribed on the boundary of the solid, but the way the resulting design velocity propagates into the interior of the solid is determined using methods like the finite difference method, isoparametric mapping, boundary displacement method or fictitious load method [26,27]. In the present work, the boundary displacement method is used. In generalized axisymmetry, the shape change only affects the in-plane initial coordinates, i.e. no shape change in tangential direction, or shape change dependency in tangential direction, takes place. Thus one can extend Eq. (2) into(11)r=Rr+Vrτ+u(R,Z)z=Zr+Vzτ+v(R,Z)ϕ=Φ+θ(R,Z).The linearization of the deformation gradient gives a similar result to Eq. (5), notably(12)[F]⋄=[L˜]⋄F+[Ξ]⋄F−F∂V∂X,with(13)∂V∂X=(∂Vr∂R∂Vr∂Z0∂Vz∂R∂Vz∂Z000VrR).The last term in Eq. (12) comes from the dependency of the initial geometry on the shape velocity in the differentiation with respect to the initial geometry, as explained in [27]. Multiplying Eq. (12) with the inverse of the deformation gradient, one gets(14)[L]⋄=[F]⋄F−1=[L˜]⋄+[Ξ]⋄−F∂V∂x,where(15)∂V∂x=∂V∂XF−1and the tensors[L˜]⋄and[Ξ]⋄are defined as(16)[L˜]⋄=(∂[r]⋄∂r∂[r]⋄∂z0∂[z]⋄∂r∂[z]⋄∂z0r∂[ϕ]⋄∂rr∂[ϕ]⋄∂zδur)and(17)[Ξ]⋄=(00−[ϕ]⋄000[ϕ]⋄00).Eqs. (16) and (17) are similar to the definitions of the respective variations in Eqs. (6) and (7), respectively, with the difference that the former use derivatives of sensitivities of the coordinates, whereas the latter use derivatives of the variations of the displacements. The sensitivity of Eq. (9) reads(18)[δL]⋄=[δF]⋄F−1−δFF−1[F]⋄F−1=[δF]⋄F−1−δL[L]⋄.The second term in the middle of Eq. (18) comes from the sensitivity of the inverse of the deformation gradient, which is rewritten using the definitions ofδLand[L]⋄from Eqs. (9) and (14), respectively. With(19)δF˜=δL˜F,one can show that(20)[δF˜]⋄F−1=M˜−δF˜∂V∂x+δF˜[Ξ]⋄,where the tensorM˜is defined as(21)M˜=(000000δu∂[ϕ]⋄∂rδu∂[ϕ]⋄∂z0)+(000000[r]⋄∂δθ∂r[r]⋄∂δθ∂z0).Then, the linearization of the variational velocity gradient takes the form(22)[δL]⋄=M˜−δF˜∂V∂x+[δΞ]⋄+δΞ[L]⋄+[Ξ]⋄δL−δL[L]⋄.With the second term in Eq. (22) also being included in the last term, and with the sensitivity of the variation ofΞbeing zero, Eq. (22) becomes(23)[δL]⋄=M˜+[Ξ]⋄δL˜+[Ξ]⋄δΞ−δL˜[Ξ]⋄−δL˜[L˜]⋄.It can easily be shown that in a Cartesian coordinate system or in a standard axisymmetric analysis, all terms but the last one in Eq. (23) vanish.Using the Cauchy stressσin a body of current volume v, the equation of virtual work can be expressed as(24)δW=∫vσ:δLdv=∫vσ:(δL˜+δΞ)dv.The linearization of the virtual work equation then becomes, with the trace operator tr(25)[δW]⋄=∫v([σ]⋄:δL−σ:(δL˜[L˜]⋄)+σ:δLtr[L]⋄)dv+∫vσ:δLtr(F∂V∂x)dv+∫vσ:(M˜+[Ξ]⋄δL˜+[Ξ]⋄δΞ−δL˜[Ξ]⋄)dv.In Eq. (25), the first integral contains the standard constitutive, geometric and volumetric terms. The second integral stems from the shape change due to the shape parametrization. The last integral is specific to the use of cylindrical coordinates, as it vanishes in the case of Cartesian coordinates. Taking into consideration thatσand[σ]⋄are symmetric whereas[Ξ]⋄is antisymmetric, the double contractions of some tensors are zero. In addition to that, the integrand of the second integral cancels out a part of the last term of the first integral, as can be seen from Eq. (14). Thus, Eqs. (24) and (25) can be simplified to(26)δW=∫vσ:δL˜dv.and(27)[δW]⋄=∫v([σ]⋄:δL˜−σ:(δL˜[L˜]⋄)+σ:δL˜tr[L˜]⋄)dv+∫vσ:(M˜+[Ξ]⋄δL˜+[Ξ]⋄δΞ−δL˜[Ξ]⋄)dv.The additional terms stemming fromδΞand[Ξ]⋄do not have a significant impact on the complexity or effort of calculating the stiffness matrix because these tensors are sparse and antisymmetric. It is important to notice that even in the absence ofδΞin Eq. (26) and in the first integral of Eq. (27), the angular degrees of freedom appear implicitly inδL˜, as can be seen from Eq. (6). Likewise, even if the shape velocity vector does not appear in Eq. (26), it is implicitly included in the sensitivities of the current coordinates in[L˜]⋄.In this paper, neohookean material behavior is considered. However, for a generalization of the equations to inelastic material behavior, an incremental form of the material behavior is also used. The neohookean material behavior can be stated as(28)σ=μJ(b−I)+λlnJJI.Here, J is the determinant of the deformation gradient, F, μ and λ are the Lamé constants and I is the second order identity tensor. The right Cauchy–Green deformation tensor b is defined as(29)b=FFT,and with Eq. (14) and the symmetric fourth-order unit tensorIS, its linearization becomes(30)[b]⋄=[F]⋄FT+F[FT]⋄=[L]⋄b+b[LT]⋄=2IS:([L]⋄b),In an incremental formulation of kinematics, use is made of the deformation gradientF0and deformation tensorb0at the start of the time increment, and of the deformation gradient incrementΔF, defined as(31)ΔF=F(F0)−1.Using Eq. (31), the deformation tensor can alternatively be written as(32)b=ΔFb0ΔFT,and the linearization becomes(33)[b]⋄=ΔF[b0]⋄ΔFT+[ΔF]⋄ΔF−1b+b[ΔFT]⋄ΔF−T=ΔF[b0]⋄ΔFT+2IS:([ΔF]⋄ΔF−1b).The linearization of the neohookean elasticity law can be written as(34)[σ]⋄=∂σ∂κ+C:[b]⋄=∂σ∂κ+C¯:[L]⋄,where the fourth-order elasticity tensors,CandC¯, are defined as(35)C=1J(μIS+λI−Jσ2⊗b−1)and(36)C¯ijkl=2Cijmn:ImnkpSbpl.The first term on the right-hand side of Eq. (34) represents the explicit dependency of the Cauchy stress on the parameter κ with respect to whom the sensitivity is determined, as for example in sensitivities with respect to material parameters. In shape optimization, this term is zero. For the linearization in the framework of a sensitivity analysis in an incremental setting with variables at the increment start labeled ‘0’ and increment ‘Δ’, the sensitivities of the coordinates can be brought in the form(37)[r]⋄=Vr+[u0]⋄+[Δu]⋄=[r0]⋄+[Δu]⋄[z]⋄=Vz+[v0]⋄+[Δv]⋄=[z0]⋄[Δv]⋄[ϕ]⋄=[θ0]⋄+[Δθ]⋄=[ϕ0]⋄+[Δθ]⋄.Using the incremental kinematic quantities, some auxiliary tensors may be defined:(38)[L˜01]⋄=(∂[r0]⋄∂r∂[r0]⋄∂z0∂[z0]⋄∂r∂[z0]⋄∂z0r∂[ϕ0]⋄∂rr∂[ϕ0]⋄∂z[r0]⋄r)(39)[ΔL˜01]⋄=(∂[Δu]⋄∂r∂[Δu]⋄∂z0∂[Δv]⋄∂r∂[Δv]⋄∂z0r∂[Δθ]⋄∂rr∂[Δθ]⋄∂z[Δu]⋄r),(40)[Ξ0]⋄=(00−[ϕ0]⋄000[ϕ0]⋄00),and(41)[ΔΞ]⋄=(00−[Δθ]⋄000[Δθ]⋄00).Here, it is crucial to keep in mind that the tensors with index ‘01’ are derivatives with respect to the current configuration. Then, the sensitivity of the velocity gradient,[L]⋄in Eq. (14), can be written as(42)[L]⋄=[L˜01]⋄+[Ξ0]⋄−F∂V∂x+[ΔL˜01]⋄+[ΔΞ]⋄.In Eq. (42), the first three terms on the right-hand side are known at the increment start once the boundary value problem is solved, whereas the last two terms contain the sensitivity of the displacement increments which remain to be determined. Likewise, the terms in Eq. (33) containing the sensitivity of the deformation gradient increment require the determination of(43)[ΔF]⋄ΔF−1=[L]⋄−ΔF[F0]⋄F−1.Here, the second term on the right-hand side of Eq. (43) contains sensitivities of the increment start and is independent on the unknown sensitivities of the displacement increment. The second term uses the sensitivity of the deformation gradient at increment start,[F0]⋄, calculated as(44)[F0]⋄=[L˜00]⋄F0+[Ξ0]⋄F0−F0∂V∂X,with(45)[L˜00]⋄=(∂[r0]⋄∂r0∂[r0]⋄∂z00∂[z0]⋄∂r0∂[z0]⋄∂z00r0∂[ϕ0]⋄∂r0r0∂[ϕ0]⋄∂z0[r0]⋄r0).With the absence of body forces and contact loads, splitting up between known sensitivities and unknown sensitivity increments, and using the consistent tangent operatorDwith components(46)Dijkl=C¯ijkl−σilδjk+σijδkland the fourth order tensorsA¯andB¯defined as(47)Aijkl=σjkδil−σilδjkand(48)Bijkl=δilσjk,Eq. (27) can be transformed into a linear equation for the determination of the sensitivity increments(49)∫vδL˜:D:[ΔL˜01]⋄dv+∫vδL˜:C¯:[ΔΞ]⋄dv+∫vδr(σ31∂[Δθ]⋄∂r+σ32∂[Δθ]⋄∂z)dv+∫v(σ31∂δθ∂r+σ32∂δθ∂z)[Δu]⋄dv+∫v(δL˜:A+δΞ:B):[ΔΞ]⋄dv+∫vδL˜:D:[L˜01]⋄dv+∫vδL˜:C¯:([Ξ0]⋄−F∂V∂x)dv+∫vδu(σ31∂[ϕ0]⋄∂r+σ32∂[ϕ0]⋄∂z)dv+∫v(σ31∂δθ∂r+σ32∂δθ∂z)[r0]⋄dv+∫v(δL˜:A+δΞ:B):[Ξ0]⋄dv=0.The first five integrals in Eq. (49) constitute the consistent stiffness matrix with the unknown sensitivity increments, whereas the last five integrals make up the so-called pseudo-load vector.With the axisymmetric solid being discretized using Nesolid elements with shape functions NA, the coordinates and their variations, increments and sensitivities being interpolated as(50)α=NAαA,α∈{x,ux,Δux,δux,[x]⋄,[x0]⋄,[Δux]⋄},where a summation is performed over the index ‘A’, i.e. the number of nodes in an element, and x and uxstand for the coordinates r, z, ϕ and the displacements u ,v, θ, respectively. With the second order tensor P, defined as(51)P=(00−1000100),the variationδΞcan be written as(52)δΞ=PNAδθA.With the following auxiliary tensors(53)C˜=C¯:Pand(54)A˜=A¯:Pand with the scalarB˜defined as(55)B˜=P:B¯:P,Eq. (49) can be expressed as a summation over the integrals over elements with elemental volume ve(56)∑Ne∫veδL˜:D:[ΔL˜01]⋄dve+∑Ne∫veδL˜:(C˜+A˜)NBdve[ΔθB]⋄+δuA∑Ne∫veNA(σ31∂NB∂r+σ32∂NB∂z)dve[ΔθB]⋄+δθA∑Ne∫ve(σ31∂NA∂r+σ32∂NA∂z)NBdve[ΔuB]⋄+δθA∑Ne∫veNAB˜NBdve[ΔθB]⋄+∑Ne∫veδL˜:(D:[L˜01]⋄+(C˜+A˜)NB[ϕ0,B]⋄−C¯:(F∂V∂x))dve+δuA∑Ne∫veNA(σ31∂NB∂r+σ32∂NB∂z)[ϕ0,B]⋄dve+δθA∑Ne∫ve(σ31∂NA∂r+σ32∂NA∂z)NB[r0,B]⋄dve+δθA∑Ne∫veNAB˜NB[ϕB,B]⋄dve=0.With the vectors(57)δx=(NAδuA,NAδvA,NAδθA),(58)[Δx]⋄=(NA[uA]⋄,NA[vA]⋄,NA[θA]⋄)and(59)∂NA∂x=(∂NA∂r,∂NA∂z,0),together with the matrices(60)h=(10001000r),and(61)L¯A=(00000000NAr),the variations in Eq. (6) and the sensitivities in (39) can be rewritten as(62)δL˜ij=δxkAhki∂NA∂xj+L¯ijAδuAand(63)[ΔL˜ij01]⋄=[ΔxkB]⋄hki∂NB∂xj+L¯ijB[ΔuB]⋄.With Eqs. (57)–(63), Eq. (56) can be written as(64)δxpA∑Ne∫vehpi∂NA∂xjDijklhqk∂NB∂xldve[ΔxqB]⋄+δxpA∑Ne∫vehpi∂NA∂xjDij33NBrdve[ΔuB]⋄+δuA∑Ne∫veNArD33klhqk∂NB∂xldve[ΔxqB]⋄+δuA∑Ne∫veNArD3333NBrdve[ΔuB]⋄+δxpA∑Ne∫vehpi∂NA∂xj(C˜ij+A˜ij)NBdve[ΔθB]⋄+δuA∑Ne∫veNA(C˜33+A˜33rNB+σ3i∂NB∂xi)dve[ΔθB]⋄+δθA∑Ne∫veσ3i∂NA∂xiNBdve[ΔuB]⋄+δθA∑Ne∫veNAB˜NBdve[ΔθB]⋄.+δxpA∑Ne∫vehpi∂NA∂xj(Dijkl[L˜kl01]⋄+(C˜ij+A˜ij)NB[ϕ0,B]⋄−C¯ijkl(Fkq∂Vq∂xl))dve+δuA∑Ne∫veNAr(D33kl[L˜kl01]⋄+((C˜33+A˜33)NB+rσ3i∂NB∂xi)[ϕ0,B]⋄−C¯33kl(Fkq∂Vq∂xl))dve+δθA∑Ne∫ve(σ3i∂NA∂xi[r0,B]⋄+NAB˜[ϕ0,B]⋄)NBdve=0.The first eight integrals in Eq. (64) yield the components of the elemental stiffness matrix relative to nodes A and B as(65)Kpqe,AB=∫vehpi∂NA∂xjDijklhqk∂NB∂xldve+∫vehpi∂NA∂xjDij33NBrδ1qdve+∫veδ1pNArD33klhqk∂NB∂xldve+∫veδ1pNArD3333NBrδ1qdve+∫vehpi∂NA∂xj(C˜ij+A˜ij)NBδ3qdve+∫veδ1pNA(C˜33+A˜33rNB+σ3i∂NB∂xi)δ3qdve+∫veδ3pσ3i∂NA∂xiNBδ1qdve+∫veδ3pNAB˜NBδ3qdve.Likewise, the last three integrals in Eq. (64), which make up the pseudo-load vector, yield the components of the elemental pseudo-load vector of node A as(66)fpA=∫vehpi∂NA∂xj(Dijkl[L˜kl01]⋄+(C˜ij+A˜ij)NB[ϕ0,B]⋄−C¯ijkl(Fkq∂Vq∂xl))dve+∫veδ1pNAr(D33kl[L˜kl01]⋄+((C˜33+A˜33)NB+rσ3i∂NB∂xi)[ϕ0,B]⋄−C¯33kl(Fkq∂Vq∂xl))dve+∫veδ3p(σ3i∂NA∂xi[r0,B]⋄+NAB˜[ϕ0,B]⋄)NBdve.Generally speaking, in the direct differentiation method, the sensitivities are calculated after the solution of the time increment of the boundary value problem by the finite element method, once the geometry and state variables both at increment start and increment end are known. The sensitivities at increment start are known, either they are zero (or equal to the shape velocity for the current geometry) at the start of the first time increment, or known from the solution of the previous time increment. In the direct differentiation method, each increment of the finite element model is treated in three stages:1.Calculation of pseudo-load vector from Eq. (66) and, depending on the linearization used for the solution of the boundary value problem, retrieval or calculation of the consistent stiffness matrix according to Eq. (65).Solution of the discretized system of linear equations, which results from Eq. (64), for each shape parameter to obtain the unknown sensitivities of the displacement increment.Update of the sensitivities: backsubstitution of the displacement increment sensitivities to obtain the updated sensitivities of current geometry, x, and state variables, here only b, at the end of the increment.After implementing the equations developed in Section 2.6 into a finite element program, it is of crucial importance to assess both the correctness and accuracy of the calculated sensitivities. Because in general, no test cases with analytical sensitivity results which represent load cases with sufficient complexity are available, the validation of the shape sensitivities, computed here by direct differentiation, has to be performed by comparison against results obtained by the finite difference method. It is important to keep in mind that the sensitivities obtained by finite differences may be severely affected by the applied perturbation size, and that numerical round-off errors may lead to outright wrong results. For this reason, any comparison between the sensitivities obtained by both methods yields a relative or absolute difference, but one cannot conclude straight away from a large difference in results that the sensitivities of the direct differentiation method are wrong, as would be the case with a comparison against analytical results.For the validation of the shape sensitivities, it is sufficient to consider rather trivial shape changes involving single boundary nodes instead of shape parameters of parametrized shape boundaries, which in fact comes down to prescribing simultaneous shape changes to a larger number of boundary nodes. However, it is not sufficient to apply the finite difference method to two consecutive finite element models where the location of a single specific boundary has been perturbed. In fact, the definition of the sensitivity, Eq. (10), has to be applied, and the velocity field resulting from the perturbed boundary node has to be used for modifying all the affected nodes within the solid. Then, the sensitivity of a generic variable α is approximated by the finite difference method as(67)[α]⋄≈α(Xr+ΔτV(Xr))−α(Xr)Δτ.In the following first example, the shape change is introduced by modifying the coordinates of single nodes, whereas in the second, more complex example, a segment-wise linear interpolation of specific parts of the boundary by a small number of boundary nodes is performed. Thus, in both cases, the shape parameters are the coordinates of specific boundary nodes. As a consequence, the perturbation size for the finite difference method,Δτ, is determined by machine precision,γ, the magnitude of the respective reference coordinate of the boundary node with respect to which the sensitivity is calculated, i.e. either Rror Zr, and a scaling factor, p, used for reducing the impact of numerical noise(68)Δτ=pγ|α|,α∈{Rr,Zr}.There is another very important issue in the validation of the sensitivity calculation by the comparison between finite difference and direct differentiation results. In the calculation of the pseudo-load vector and the consistent stiffness matrix, the sensitivity of the deformation gradient has to be calculated using Eq. (12). Likewise, all variables calculated from this sensitivity, like the sensitivity of the deformation tensor or of the stress rely on the definition of Eq. (12). However, the true sensitivities, computed in the update step, and to be compared to the finite difference results, require their calculation based on a sensitivity of the deformation without the second term on the right-hand side of Eq. (12), i.e. the term stemming from the rotation of the basis. For example, the sensitivity of the deformation gradient has to be compared using(69)F(Xr+ΔτV(Xr))−F(Xr)Δτ≈[L˜]⋄F−F∂V∂X.In elasticity, the deformation tensor and its sensitivity can be calculated directly from the deformation gradient and its sensitivity using Eqs. (29) and (30), respectively. In this case, the calculation of the sensitivities with or without the second term in Eq. (12) stemming from the basis rotation, to be used for the calculation of the pseudo-load vector or the true sensitivities after the sensitivity update step, respectively, is trivial. However, if the deformation tensor is defined in an incremental way using Eq. (32), and subsequently also its sensitivity in Eq. (33), which is not necessary in elasticity but unavoidable in inelasticity, an important change in variable storage is required. In fact, for the calculation of the pseudo-load vector, the term[Ξ]⋄Fis required for the calculation of the sensitivities of the deformation tensor and the stress tensor, whereas in the update step, the sensitivity of the deformation tensor without this term is required, for example for calculating the stress sensitivity. Therefore, both versions of the sensitivity of the state variable b have to be stored and transferred between time increments.A very simple finite element model has been used for a basic validation of the implementation of the direct differentiation method for axisymmetry with superposed torsion. The validation itself has been performed by comparing the sensitivities of the stress components with respect to the in-plane coordinates of several boundary nodes, calculated by the direct differentiation method (DD) to those obtained by the finite difference method (FD) with a perturbation scaling factorp=102. To this avail, the average magnitude of the difference in the results obtained by both methods is calculated over all integration points in the model, i.e.(70)E¯αβ=1NelNip∑i=1Nel∑j=1Nip|[σαβi,j]⋄FD[σαβi,j]⋄DD−1|,∀αβ∈{rr,zz,θθ,rz,zθ,rθ}.The finite element model consists of an axisymmetric model of a slanted bloc. The finite element model is depicted in Fig. 1. The bloc has a constant height of 8mm, whereas the width changes from 10 to 11mm in vertical direction. It containsNel=2×5=10linear displacement-based elements withNip=4integration points, resulting in 18 nodes. The material behavior considered is finite strain elasticity with Young׳s modulus ofE=175000MPaand a Poisson ratio ofν=0.3. Two load cases are considered, one in displacement control and one in load control with the intent of producing inhomogeneous stress fields.In displacement control, a vertical displacement ofuz=3mmis applied to node 13 and a tangential displacement ofuθ=0.1radis applied to node 18. In load control, a vertical point load ofFz=100000Nis applied to node 13 and a torsional moment ofFθ=10000Nmmis applied to node 18. The sensitivities are calculated with respect to both in-plane components of the nodal positions of nodes 6, 12, 15 and 18, whose locations are given in Fig. 1.The results of the average difference between the sensitivities of DD and FD with respect to the nodal positions, as defined in Eq. (70), are given in Table 1for displacement control and in Table 2for load control. It can be observed that the relative difference between both methods is very small, i.e. in general below10−2%, which leads to the conclusion that the sensitivities of the stress components calculated by the direct differentiation method are very accurate. In fact, differences below 0.01% can be considered as numerical noise. In case higher differences are found, it is worthwhile taking into account that both an inappropriate magnitude of the perturbation and values close to zero may lead to very large differences, in order to avoid mistaking numerical round-off issues for an implementation error.In dental prosthetics, the replacement of a tooth by a prosthesis is performed in two stages. In a first stage, an implant is inserted into the jawbone. As the implant does not protrude out of the jawbone, it is only subjected to small loads, which is beneficial to the growth of bone cells around it. Once the implant has been sufficiently fixed to jawbone by growing bone cells, a crown is fitted onto the implant by means of an abutment. More precisely, the abutment is screwed to the implant and the crown is glued onto the abutment. In general, implant, abutment and screw are made of titanium. However, for the prosthesis of front teeth, one can observe a trend towards abutments made of zirconia ceramics, which are white, for purely aesthetic reasons. This comes with a major drawback, because ceramic materials are inherently brittle, and very specific design rules have to be applied. In this example, a shape sensitivity analysis is performed using a finite element model of the abutment shown in Fig. 2. This sensitivity analysis may then for example be used in shape optimization using gradient-based optimization algorithms.The finite element model of the ceramic abutment consists of 2175 four-noded displacement-based axisymmetric elements which include torsion. The abutment has neohookean elastic behavior, with Young׳s modulus ofE=200GPaand Poisson׳s ratio ofν=0.25. The finite element model is constrained in tangential and vertical direction on the line AB, which corresponds to the abutment/implant interface. The analyzed load case corresponds to the fixed implant without mastication loads, i.e. a torque applied to surface CD which is the abutment/screw interface. The torque ofT=250Nmmof the screw induces a compressive load ofF=1000N. Both the vertical load and the torque are applied as surface loads on the surface CD. The inner surface of the abutment is represented by a segment-wise linear interpolation using the nodes at locations U, C, D and V in Fig. 2, where U and V are remaining fixed. A part of the outer surface is interpolated using locations A, B and W, with fixed A and W. The shape sensitivities are calculated with respect to the vertical shape change of points C and D, as well as the horizontal and vertical displacement of point B. Like in the previous example, the relative difference between the sensitivities computed by direct differentiation and finite differences according to Eq. (70) is used as a global indicator for assessing the quality of the sensitivities. The finite difference sensitivity analysis uses a perturbation scaling factorp=101. In Table 3, the average global relative difference is shown for all six stress components. One can see that most values are well below 0.01%, which indicates that the sensitivities are very accurate.

@&#CONCLUSIONS@&#
A shape sensitivity analysis based on the direct differentiation method has been developed in this article for axisymmetry including torsion in finite strains. It has been shown that the obtained sensitivities are highly accurate and the method is suitable for use in gradient-based shape optimization of axisymmetric structures subjected to torsional loading. Thus, the main advantage of this type of axisymmetric analysis in comparison to fully three-dimensional finite element model, which is a highly reduced number of degrees of freedom, can help to considerably reduce the computational effort required in shape optimization of this type of mechanical problems.