@&#MAIN-TITLE@&#
Commodity derivatives pricing with cointegration and stochastic covariances

@&#HIGHLIGHTS@&#
We propose a multiple asset model with cointegration and stochastic covariances.The model is applied to pricing commodity derivatives.We show that the model captures key features of the commodity derivatives market.The pricing formulas are tractable and parameters can be calibrated to observed trading data.

@&#KEYPHRASES@&#
Option pricing,Cointegration,Stochastic covariance,Stochastic convenience yield,

@&#ABSTRACT@&#
Empirically, cointegration and stochastic covariances, including stochastic volatilities, are statistically significant for commodity prices and energy products. To capture such market phenomena, we develop a continuous-time dynamics of cointegrated assets with a stochastic covariance matrix and derive the joint characteristic function of asset returns in closed-form. The proposed model offers an endogenous explanation for the stochastic mean-reverting convenience yield. The time series of spot and futures prices of WTI crude oil and gasoline shows cointegration relationship under both physical and risk-neutral measures. The proposed model also allows us to fit the observed term structure of futures prices and calibrate the market-implied cointegration relationship. We apply it to value options on a single commodity and on multiple commodities.

@&#INTRODUCTION@&#
Commodity derivative market had tremendous growth in recent years. A number of stylized facts about commodity prices have been uncovered in the literature. Although Bessembinder, Coughenour, Seguin, and Smoller (1995) and Schwartz (1997) observe the mean reversion of commodity spot prices, other researchers have identified a long-term equilibrium relationship between multiple commodities, termed cointegration. In addition, Trolle and Schwartz (2009) recognize the unspanned stochastic volatility in commodity markets, particularly that in the crude oil market. Cointegration and stochastic volatility are important ingredients in derivatives pricing and hedging. Wong and Lo (2009) investigate the valuation of options on a single underlying asset following a mean-reverting lognormal process with stochastic volatility. Duan and Pliska (2004) consider the valuation of crack spread options on two cointegrated assets. They employ an error correction model with GARCH to value the spread option, but assume the correlation between the two assets to be a constant value. Dempster, Medova, and Tang (2008) model the spread process of cointegrated assets directly using two latent factors, as the correlation between asset returns is notoriously difficult to model. Marroquín-Martínez and Moreno (2013) and Rambeerich, Tangman, Lollchund, and Bhuruth (2013) discuss computational methods for option valuation under multifactor models.Not only are volatilities stochastic, but the correlations between pairs of assets in the energy market are also highly stochastic (see, e.g., Alexander, 1999; Kouvelis, Li, & Ding, 2013). Thus assuming a constant correlation structure is inappropriate. In this paper, we propose a tractable continuous-time model that simultaneously captures cointegration, stochastic volatilities, and stochastic correlations. More specifically, the cointegration structure is reflected by the diffusion limit of the discrete error correction model consistent with Duan and Pliska (2004), Chiu and Wong (2011) and Chiu and Wong (2012). Meanwhile, the stochastic covariance matrix is assumed to follow the continuous-time Wishart autoregressive (WAR) process proposed by Bru (1991). Gourieroux, Jasiak, and Sufana (2009) provide a thorough analysis of the properties of WAR processes in both discrete and continuous-time settings. Using the WAR process to model the covariance matrix is appealing as it does not require additional constraints to ensure the positivity or symmetry of the matrix. Buraschi, Porchia, and Trojani (2010) investigate stochastic correlation risk in asset allocation using a WAR process. Chiu and Wong (2014) generalize it to the mean-variance portfolio objective. Gourieroux and Sufana (2010) exploit the use of WAR processes for multivariate stochastic volatilities. Under the proposed model, we derive the closed-form solutions for the joint characteristic function of asset returns and futures contracts.The convenience yield, defined as the flow of benefit of immediate ownership of a physical commodity, is regarded as a distinguished feature of commodities as an asset class. Casassus and Collin-Dufresne (2005) document that mis-specification of the convenience yield can have a significant impact on option valuation and risk management. Therefore, correctly modeling the convenience yield process is a significant step towards modeling commodity-related contingent claims. We here document the stylized fact regarding the dynamics of the commodity convenience yield predicted by the proposed model and the traditional theory of storage, respectively. One insight of our framework is that the proposed model can be interpreted as arbitrage-free models of commodity spot prices, where the convenience yield is of stochastic volatility. To our knowledge, the implications of cointegration to stochastic convenience yield have never been explored in the literature. Using daily data on WTI crude oil and gasoline, we perform three regression tests on the market-implied convenience yield, to explore the economical and statistical significance of our model specification in commodity market. Although our empirical results reconfirm the theory of storage in Routledge, Seppi, and Spatt (2000), it also strongly support the hypothesis that cointegration is an important contributor to convenience yields. The overall explanatory power of our proposed model is much stronger than that of the traditional theory of storage. It implies that commodity market anticipates cointegration relationship under both physical and risk-neutral measures.In the literature, Hilliard and Reis (1998) and Casassus and Collin-Dufresne (2005) assume exogenous mean-reverting convenience yield model to improve the valuation of commodity derivatives. Under the proposed model, cointegrating factors form a mean-reverting system and are contributors to convenience yield. Therefore, our model offers an endogenous explanation for the stochastic mean-reverting convenience yield. In addition, as the cointegrating factor is a linear combination of log-spot-prices, and spot prices exhibit stochastic correlations and volatilities, our model also predicts that the volatility of the convenience yield is stochastic. This prediction coincides exactly with Broadie, Detemple, Ghysels, and Torres (2000), who use a non-parametric approach to show that putting the stochastic dividend and volatility together improves empirical option prediction. Furthermore, the proposed model allows the correlation structure between spot prices and convenience yields be time-varying, as desired by Routledge et al. (2000).The proposed model is also appealing in terms of calibration procedures as it can exactly fit to the market-observed term structure of futures prices. We further develop a way to individually filter out the risk-neutral cointegration relationship by examining the elasticity of futures prices to spot prices. The calibrated characteristic function can be applied to the valuation of options on a single commodity and on multiple commodities using fast Fourier transform (FFT) techniques.The remainder of this paper is organized as follows. Section 2 presents the proposed model under the physical measure and derives the joint characteristic function of asset returns. Section 3 examines the stylized facts of convenience yield process predicted by the proposed model and performs comprehensive empirical analysis using crude oil and gasoline data to demonstrate the economical and statistical significance of our model specification. Section 4 discusses the calibration of the model and applies it to the pricing of commodity derivatives. Section 5 concludes the paper.This section introduces and studies a continuous-time dynamics of cointegrated assets with stochastic covariance. To better understand our model and its implications, we start reviewing the two-asset case of the continuous-time cointegration model of Phillips (1991) and Duan and Pliska (2004). A stochastic covariance matrix is further introduced to simultaneously capture cointegration and stochastic covariances, which enables explicit formulation of joint characteristic function. We also discuss the corresponding risk-neutral asset dynamics and closed-form pricing of futures contract.We start with the spot-price process of two risky assets, S1(t) and S2(t), with a constant covariance matrix. Let Xj(t) = ln Sj(t) for j = 1, 2. The continuous-time cointegration model of Phillips (1991) and Duan and Pliska (2004) under the physical probability measure is given by(1)dX1(t)=[θ1−κ11X1(t)−κ12X2(t)+λ1σ12]dt+σ1dZ˜1dX2(t)=[θ2−κ21X1(t)−κ22X2(t)+λ2σ22]dt+σ2dZ˜2,whereZ˜1andZ˜2are correlated Wiener processes with correlation coefficientρ˜,and other parameters, i.e., θi, κij, λi, and σifor i, j = 1, 2, are constant values. In (1), λ1 and λ2 are market prices of risks. θ1 and θ2 are the equilibrium mean level of the log-asset values. If κ12 = κ21 = 0, X1 and X2 are mean-reverting assets individually. Let κ be the 2 × 2 matrix collecting κij, for i, j = 1, 2. (1) is said to be a cointegration system if two eigenvalues of κ are non-negative and at least one of them is positive. Ife→denotes an eigenvector associated with a positive eigenvalue of κ,[X1(t)X2(t)]·e→is a cointegrating factor of the system (1). The covariance matrix between X1(t) and X2(t) is constant and deduced to beV=(σ12ρ˜σ1σ2ρ˜σ1σ2σ22).However, such a model is unrealistic for certain circumstances. For example, Alexander (1999) pointed out that the correlation between pairs of assets in the energy market is highly stochastic. In this paper, we propose to model the covariance matrix V as a stochastic matrix following the continuous-time Wishart autoregressive process.Consider n risky assets whose prices at time t are represented in an n-dimensional vector St. The n × n covariance matrix at time t denoted by Vtis stochastic and positive definite. We postulate the joint dynamics of logarithmic spot prices Xt= ln Stand Vtunder the physical measurePas(2)dXt=[θ(t)−κXt+(Tr(D1Vt),…,Tr(DnVt))′]dt+VtdZtP,(3)dVt=(βQ′Q+MVt+VtM′)dt+VtdWtPQ+Q′(dWtP)′Vt,whereZtP∈RnandWtP∈Rn×nare a vector Brownian motion and a matrix Brownian motion under the physical measureP,respectively. The vector θ(t) represents the equilibrium mean level of the log-asset values against time. κ is an n × n constant matrix of cointegration coefficients. If κ is a positive diagonal matrix, all of the individual assets are stationary and exhibit mean-reversion. β is a scalar, such that β > n − 1, and M and Q are n × n constant real square matrices. Tr (·) denotes the trace operator. Q′ is the (unconjugated) transpose of matrix Q.Vtis the positive symmetric square root of Vtsuch thatVtVt=Vt. The continuous-time process of the stochastic covariance matrix in (3) is essentially the continuous-time Wishart autoregressive (WAR) process introduced by Bru (1991). The WAR process ensures that, at any point in time, the stochastic covariance matrix is positive definite. Tr(DiVt) in (2) represents a risk premium of Vt. If Q, M, andWtPare all diagonal matrices, Vtis also a diagonal matrix with each of its diagonal elements following the stochastic volatility model of Heston (1993) and therefore our model embraces the model of Wong and Lo (2009) when n = 1.Following Da Fonseca, Grasselli, and Tebaldi (2007), we require thatZtPin (2) andWtPin (3) are linearly correlated(4)dZtP=dWtPρ+1−ρ′ρdBtP,wheredBtPis an n-dimensional Brownian motion independent ofdWtP,and ρ is a vector of correlations, such that ρi∈ [−1, 1] and ρ′ρ < 1. Therefore, Xtand Vtare correlated in our model. The market model introduced by Gourieroux and Sufana (2010) is also based on (4) but further assumes that ρi= 0, for which the Brownian motions of asset returns are independent of those driving the covariance matrix, leading to a symmetric volatility smile for vanilla options.The multivariate cointegration dynamics with stochastic covariance matrix as specified in (2) and (3) strike a balance between analytical tractability and the ability of fitting empirical stylized facts. In particular, it enables the characteristic function of log-asset-values to take an explicit exponential affine form. Denote the joint characteristic function of XTunderPconditional onFtas(5)fP(x,v,t;u)=EP[eiuXT|Xt=x,Vt=v],where T ≥ t,i=−1,and u = (u1,…,un) is a row vector of size n. The following lemma holds.Lemma 1If Xt follows the dynamics in (2) and (3), the joint characteristic function defined in (5) is given by(6)fP(x,v,t;u)=exp[Tr(A(τ;u)v)+B(τ;u)′x+C(τ;u)],where τ = T − t, A(τ; u) = H(τ; u)−1G(τ; u),B(τ;u)=ie−κ′τu′,C(τ;u)=iu∫0τe−κsθ(t−s)ds−β2Tr[lnH(τ;u)+M′τ−i∫0τe−κ′sdsu′ρ′Q],ddτ(G(τ;u)′H(τ;u)′)=(M+Q′ρB(τ;u)′−2Q′QB(τ;u)B(τ;u)′2+∑j=1nUj(1)B(τ;u)Dj−(M′+B(τ;u)ρ′Q))′×(G(τ;u)′H(τ;u)′),with H(0; u) = In, G(0; u) = 0n, Inand0nbeing the identity and zero matrices of order n, respectively. Uj(y) denotes a row vector with the jth element equal to y and the remaining elements equal to 0.See Appendix A in the supplementary material.□The matrix exponential e−κτcan be computed easily based on the Cayley–Hamilton theorem by using a polynomial of − κ, as detailed in Appendix B in the supplementary material.For the purpose of derivatives valuation, it is necessary to study the joint process (Xt, Vt) under the pricing measure implied by the market, or the so-called risk-neutral measureQ,and its linkage to the physical dynamics. As commodities are not tradable on exchanges but their futures contracts are, the risk-neutral (martingale) condition should hold with respect to futures prices instead of spot prices in commodity market. Here, we adopt the extended affine market price of risk specification suggested by Cheredito, Filipovic, and Kimmel (2007) to preserve the cointegration relationship underQ. It is a realistic specification and consistent with empirical market phenomena, as will be shown in the later sections. Specifically, we propose the following extended affine specification(7)ΛX,t=(Vt)−1(λX0+λX1Xt+(Tr(D1λVt),…,Tr(DnλVt))′),(8)ΛV,t=(Vt)−1(ΛV0+VtΛV1),from which Brownian motions underPandQare linked through(9)dZtP=dZtQ−ΛX,tdt,dWtP=dWtQ−ΛV,tdt.Hence, the joint dynamics of Xtand VtunderQare given by(10)dXt=[θQ(t)−κQXt+(Tr(D1QVt),…,Tr(DnQVt))′]dt+VtdZtQ,(11)dVt=((β−2γ)Q′Q+MQVt+Vt(MQ)′)dt+VtdWtQQ+Q′(dWtQ)′Vt,which relates to theirP-processes (2) and (3) by reparametrization,(12)θQ(t)=θ(t)−λX0κQ=κ+λX1,DjQ=Dj−Djλ,MQ=M−Q′(ΛV1)′,dZtQ=dWtQρ+1−ρ′ρdBtQ,dBtQ=dBtP+(1−ρ′ρ)−1(ΛX,tdt−ΛV,tρdt).To preserve the type of distribution underPandQ,we require thatΛV0=γQ′for a scalar γ, such that β − 2γ > n − 1.The advantage of adopting the extended affine specification is that the cointegration coefficients and the long-run level of the covariance processes can be adjusted independently when changing the physical measure to the risk-neutral measure. This approach of changing measures is valid if Vtdoes not attain its boundary value of zero under bothQandP,as shown by Cheredito et al. (2007). The condition β − 2γ > n − 1 ensures the covariance matrix Vtbeing positive definite. The following lemma gives the joint characteristic function of XTconditional onFtunderQ.Lemma 2If Xt follows the dynamics in (10) and (11), the joint characteristic function for XT is given by(13)fQ(x,v,t;u)=EQ[eiuXT|Xt=x,Vt=v]=exp[Tr(AQ(τ;u)v)+BQ(τ;u)′x+CQ(τ;u)],whereAQ(τ;u),BQ(τ;u),andCQ(τ;u)are, respectively, theQ-counterparts of A(τ; u), B(τ; u), and C(τ; u) inLemma 1with the reparametrization (12).As theQ-characteristic function for XTis exponentially affine in the state variables, the marginalQ-characteristic function of Xj, Tconditional onFtfor j = 1,…,n, can be extracted from Lemma 2 as follows.(14)fjQ(x,v,t;ϕ)=EQ[eiϕXj,T|Xt=x,Vt=v]=fQ(x,v,t;u=Uj(ϕ)),where Uj(ϕ) denotes a row vector with the jth element equal to ϕ and the remaining elements equal to 0.The characteristic functions are not only useful in describing the distributional properties of the model, but also in deriving formulas for standard derivative products. An obvious application is to derive a closed-form solution of futures prices.Corollary 1Under theQ-dynamics (10) and (11), the futures price of the jth commodity with maturity T is given by(15)Fj,T(t)=EtQ[Sj,T]=fjQ(x,v,t;ϕ=−i),forj=1,…,n,wherefjQ(x,v,t;ϕ)is defined in (14).This corollary implies that the futures price of the jth commodity depends not only on its underlying spot price, but also on other commodities with a cointegrating relationship. Taking the situation of two cointegrated commodities and a constant interest rate as an example, Corollary 1 asserts that the futures price of S1 depends on the current values of both S1 and S2. The explicit formula is:(16)F1,T(t)=exp[Tr(AQ(τ;U1(−i))v)+BQ(τ;U1(−i))′x+CQ(τ;U1(−i))],where x = Xt= (ln x1, t, ln x2, t)′ is the vector of the current log-asset values.Under theQ-dynamics (10) and (11),θQ(t)is a vector-valued function, representing the equilibrium mean level of the log-asset values against time under the risk-neutral measureQ,which is notoriously difficult to estimate. The following proposition shows that the proposed model enables a practical approach of super-calibration, which not only avoids estimatingθQ(t)but also exactly fits the model to the observed term structure of commodity futures.Proposition 1If the underlying assets follow the model with cointegration and stochastic covariances in (10) and (11), the joint characteristic function calibrated to the term structure of futures prices is given by(17)fQ(x,v,t;u,FT(t))=∏j=1n[Fj,T(t)]iuj×exp[Tr(ΔA(τ;u)v)+ΔC˜(τ;u)],whereΔA(τ;u)=AQ(τ;u)−i∑j=1nujAQ(τ;u=Uj(−i)),ΔC˜(τ;u)=C˜(τ;u)−i∑j=1nujC˜(τ;u=Uj(−i)),C˜(τ;u)=−β−2γ2Tr×[lnHQ(τ;u)+(MQ)′τ−i∫0τe−(κQ)′τu′ρ′Q],and Fj, T(t) is the futures price of the jth asset with maturity T quoted at time t.See Appendix C in the supplementary material.□The proposed model implies that futures prices with different maturities can fully capture the seasonality of commodity prices. Therefore, the market-implied risk-neutral vectorθQ(t)disappears in the closed-form solution of theQ-characteristic function, while the term structure of futures prices is exactly accommodated instead. However, there only exist a limited number of futures contracts with standardize maturity in the market. Therefore, the seasonality of the commodity prices is partially revealed in the market-observed futures prices instead.The convenience yield, defined as the flow of benefit of immediate ownership of a physical commodity, is regarded as a distinguished feature of commodities as an asset class. In this section, we first document the stylized fact regarding the dynamics of the commodity convenience yield predicted by the traditional theory of storage and the proposed model, respectively. Using daily data on WTI crude oil and gasoline, we perform three regression tests on the market-implied convenience yield, to explore the economical and statistical significance of accommodating cointegration and stochastic covariance in commodity market.Since convenience yield is not directly observable, we infer the dynamics of convenience yieldq^i,T(t)from the market-observed commodity futures and spot prices based on the following non-arbitrage condition(18)Fi,T(t)=EQ[Si,T|Ft]=Si,te(r−q^i,T(t))(T−t),where Fi, T(t) denotes the price of futures contract of the ith commodity with maturity T quoted at time t, and Si, tthe ith commodity spot price at time t.11For some commodities without good spot price data, futures prices on maturing contracts can be used to represent spot prices due to the convergence of spot and futures prices at expiration.Therefore, we callq^i,T(t)the market-implied convenience yield.As discussed in Schwartz (1997), the theory of storage is a widely adopted view about commodity futures prices in the literature. It explains the difference between the futures price and the contemporaneous spot price in terms of interest forgone in storing a commodity, warehousing costs, and a convenience yield from inventory. Therefore, Schwartz (1997) predicts that the changes in interest rates are positively related to the changes in convenience yield. We here adopt the regression approach analogous to Fama and French (1987) and Bailey and Ng (1991) to examine this hypothesis.Hypothesis 1Fi,T(t)=Si,te(r−q^i,T(t))(T−t)for i = 1,…,n, where Fi, T(t) is the T-futures price of Si, tquoted at time t and(19)Δq^i,T(t)=βi0I+βi1IΔrt+βi2IΔ(T−t)−1,whereq^i,T(t)=r−ln(Fi,T(t)/Si,t)/(T−t),Δq^i,T(t)=q^i,T(t)−q^i,T(t−Δt),Δrt= rt− rt − Δt, andΔ(T−t)−1=1T−t−1T−(t−Δt).In Hypothesis 1, the interest rate term reflects the time value of the storage cost, and the term (T − t)−1 is used to model the Samuelson effect, where T − t is the time-to-maturity of the futures contract. As discussed in Fama and French (1987), the theory of storage expects the regression coefficient of the interest rate termβi1Ito be positive.Besides the effect of interest rate, the theory of storage implies that the convenience yield depends mainly on commodity inventories. Several papers (see, e.g., Deaton and Laroque (1992), Routledge et al. (2000)) have shown that convenience yields arise endogenously as a result of the interaction among supply, demand, and storage decisions. In particular, Routledge et al. (2000) provide economic rationale for allowing the convenience yield to depend on spot price. Assuming that periods of scarcity, for example, lower inventories, correspond to higher spot prices, this theory predicts a positive relation between convenience yield and spot price. Our second hypothesis, following Bailey and Ng (1991) and Casassus and Collin-Dufresne (2005) uses the underlying spot price Si, tas the proxy for the inventory level contributing to the convenience yield.Hypothesis 2Fi,T(t)=Si,te(r−q^i,T(t))(T−t)for i = 1, …, n, where Fi, T(t) is the T-futures price of Si, tquoted at time t and(20)Δq^i,T(t)=βi0II+βi1IIΔrt+βi2IIΔ1T−t+β^iIIΔXi,t,whereq^i,T(t)=r−ln(Fi,T(t)/Si,t)/(T−t),and ΔXi, t= Xi, t− Xi, t − Δt.Both Hypotheses 1 and 2 come from the traditional theory of storage in which the existence of cointegration relationship has no impact on the convenience yield. As pointed out by Duan and Pliska (2004), the derivatives prices do not depend on the cointegration parameters when volatilities are deterministic. Therefore, stochastic volatility is a prerequisite for cointegration relationship to be preserved under the risk-neutral measure. We here discuss the convenience yield dynamics predicted by our proposed model with cointegration and stochastic covariance. Consider the situation of two cointegrated commodities. Corollary 1 asserts that the futures price of S1 depends on the current values of both S1 and S2. The explicit formula is:(21)F1,T(t)=exp[Tr(AQ(τ;U1(−i))v)+BQ(τ;U1(−i))′x+CQ(τ;U1(−i))]=S1,texp[rτ−q1(t,T)τ],which gives us the convenience yieldq1(t,T)=r+x1τ−Tr(AQ(τ;U1(−i))v)τ−BQ(τ;U1(−i))′xτ−CQ(τ;U1(−i))τ,where(22)BQ(τ;U1(−i))′xτ=(α0Q(τ)−κ11Qα1Q(τ)τ)x1−κ12Qα1Q(τ)τx2,[κ11Qκ12Q]is the first row ofκQ,αiQ(τ)=γi0+∑j=1nγijeλjτ,as shown in Appendix B by the Cayley–Hamilton theorem, and x1 = log S1, tand x2 = log S2, tare the current log-asset values. By Taylor’s theorem, we haveαiQ(τ)=γ^i0+γ^i1τ+R1(τ),with R1(τ) denoting the remainder term. Substituting the Taylor expansion ofαiQ(τ),i = 0, 1 into (22) gives usBQ(τ;U1(−i))′xτ≃(γ^00−κ11Qγ^10)x1τ+(γ^01−κ11Qγ^11)x1−κ12Qγ^10x2τ−κ12Qγ^11x2.Therefore, we obtain the following dynamics of the convenience yield of S1,(23)Δq1(t,T)=Δq^1,T(t)+ErrorTerms,whereΔq^1,T(t)=β10+β11Δrt+β12Δ1T−t+∑j=1nβ^1jΔXj,t+∑j=1nβ˜1jΔXj,tT−t,for constants β10, β11, β12,β^1jandβ˜1j,j = 1, 2. Eq. (23) offers a linear regression-based estimation for the convenience yield dynamics, yielding our third hypothesis.Hypothesis 3Fi,T(t)=Si,te(r−q^i,T(t))(T−t)for i = 1, …, n, where Fi, T(t) is the T-futures price of Si, tquoted at time t and(24)Δq^1,T(t)=β10+β11Δrt+β12Δ1T−t+∑j=1nβ^1jΔXj,t+∑j=1nβ˜1jΔXj,tT−twhereq^i,T(t)=r−ln(Fi,T(t)/Si,t)/(T−t),andΔXi,tT−t=Xi,tT−t−Xi,t−ΔtT−(t−Δt).Hypothesis 3 points out that our proposed model with cointegration and stochastic covariances under the risk-neutral measure can be interpreted as “arbitrage-free models of commodity spot prices, where the convenience yield depends on the spot prices of cointegrated assets with stochastic volatilities”. As mentioned by Routledge et al. (2000), the correlation between spot prices and convenience yields is unlikely to be constant. Under our proposed model, the stochastic convenience yield arises endogenously as a result of the cointegrating relationship and is stochastically correlated with the spot price.We here empirically examine the stylized facts of two commodity prices and their market-implied convenience yields. In particular, the existence of cointegration and stochastic correlation in the spot prices of crude oil and gasoline is investigated. We also test the aforementioned three hypotheses about the convenience yield to demonstrate the significance of our proposed model.The data set obtained from Bloomberg consists of the NYMEX daily spot prices of WTI crude oil and gasoline from January 03, 2008 to July 15, 2011. We also collect data on their futures prices with different maturities over the same period of time.We first investigate the existence of cointegration and stochastic correlation between the two commodities. Fig. 1plots the daily closing prices of crude oil and gasoline against time, in which the prices of gasoline are multiplied by 42 because crude oil is quoted as price per barrel, whereas gasoline is quoted as price per gallon (42 gallons = 1 barrel). A high degree of correlation between the two commodities is displayed because shocks to one series are accompanied by shocks to the paired series. In addition, the series appear to follow each other through time, and their spread exhibits mean reverting. These properties usually occur in a pair of cointegrated time series. For formally testing cointegration relationship, we employ the Engle–Granger two-step method (Engle & Granger, 1987) to obtain the following cointegrating vector(25)Zt=0.6801+0.00016t+X1,t−0.957599X2,t,where X1, tand X2, tdenote the log-spot price of crude oil and gasoline respectively and the time trend variable t reflects the growth in the underlying variables. The pair of commodities contribute to the cointegrating factor (25) in the opposite direction. Table 1reports the results of three cointegration tests. The p-value of the augmented Dickey–Fuller (ADF) test on Ztis 0.01, which implies that the null hypothesis of no cointegration is rejected at the 1 percent level. We also check the Phillips–Ouliaris cointegration test and the Phillips–Perron unit root test, which both imply a significant cointegration relationship.We further investigate the market behavior of correlation to examine the importance of permitting stochastic correlations in the asset dynamics. Fig. 2plots the estimated correlations with different rolling window lengths, of which the descriptive statistics are reported in Table 2. When using this rolling-window approach to calculate time-varying correlations, the length of the window determines the smoothness of the temporal movements of the data. In general, a shorter window will produce a more erratic time series of sample correlations but will give a better representation of the contemporaneous correlation. Here, we set the length of the rolling window to 30 days, 100 days and 250 days, respectively. It can be seen from Fig. 2 that the correlation is not constant over time. Therefore, our proposed model is appealing as it simultaneously incorporates cointegration and stochastic covariances empirically observed in commodity market.To test Hypotheses 1 and 2 predicted by the theory of storage and Hypothesis 3 predicted by our proposed model, we adopt regression approaches analogous to Fama and French (1987) and Bailey and Ng (1991) to explain the changes in convenience yield. Table 3reports the results for crude oil and gasoline. In Hypothesis 1, we regress the changes in the convenience yield on the changes in the set of state variables (Δrt, Δ1/(T − t)). For the risk-free rate rt, we use the daily 3-month constant maturity Treasury yield obtained from the U.S. Department of the Treasury. The estimates of the regression coefficients, and their standard errors (SE) and p-values, are given in Table 3, in addition to the explanatory power of the regressions, as measured by adjusted R2. As predicted by the theory of storage, change in interest rate Δrtis positively related to the changes in convenience yield for both crude oil and gasoline with significance at 1 percent level. However, the overall explanatory power of Hypothesis 1 is low with adjusted R2 of 1.33 percent for crude oil and 0.53 percent for gasoline. It implies that the interest rate term and Samuelson effect together are far from sufficient to explain the variations in the convenience yield.In Hypothesis 2, we add the underlying spot price as a regressor to reflect the level dependence of the convenience yield. More specifically, the changes in the convenience yieldq^i,T(t)are regressed against the changes in the set of state variables (Δrt, Δ1/(T − t), ΔXi, t). The regression results are also given in Table 3. The coefficients of ΔXi, tare significantly positive at 1 percent level for both crude oil and gasoline, which is in line with predictions of the theory of storage. Compared to Hypothesis 1, the overall explanatory power is greatly improved in Hypothesis 2 with adjusted R2 increasing from 1.33 percent to 45.77 percent for crude oil and from 0.53 percent to 14.2 percent for gasoline. It implies that a realistic model of commodity prices should allow the convenience yield to depend on the underlying spot prices as well.In Hypothesis 3, we examine the prediction of our proposed model about the convenience yield dynamics by including the pair of cointegrated assets as explanatory variables. The regression results are presented in Table 3. Compared to Hypothesis 2, Hypothesis 3 further improves the adjusted R2 by about 6 percent in the case of crude oil and by about 34 percent in the case of gasoline. The regression coefficients of ΔXi, tremain positive and significant at 1 percent level, reflecting the relationship between inventories and spot prices. In addition, the regression coefficients of ΔX1, tand ΔX2, tare of different signs, which is consistent with the specification of the cointegrating factor Ztin (25). These findings imply that the market anticipates a cointegration relationship under the risk-neutral measure. Our proposed change of measure preserves the feature of cointegration and has greater flexibility to reflect such market phenomena. Overall, the regression results reported in Table 3 demonstrate the economical and statistical significance of accommodating cointegration and stochastic covariances for commodity market. In the literature, Hilliard and Reis (1998) use a latent Cox-Ingersoll-Ross (CIR) type model to describe the yield, which leads to a non-central χ2-distributed yield. In our proposed model, the convenience yield process can be discovered from the cointegration relationship, which suggests us taking a close look at the cointegration feature when modeling the stochastic convenience yield dynamics. In turn, the existence of cointegration relationship can provide us with richer market information and techniques for commodity derivatives valuation and hedging. Our results are also consistent with the findings of Casassus and Collin-Dufresne (2005) on level dependence in the convenience yield, which corresponds to mean reversion in the spot prices under the risk-neutral measure.In this section, we first discuss the estimation of the proposed commodity price dynamics and develop a framework for directly estimating the risk-neutral cointegration relationship. The use of the model is then demonstrated in valuing options on a single commodity and on multiple commodities.The proposed commodity price dynamics needs to be estimated to incorporate available market information before being applied to derivatives pricing and hedging. As shown in Proposition 1, we can exactly calibrate the proposed model to the market observed term structure of futures prices and avoid estimating the equilibrium mean level functionθQ(t)in (10). The covariance matrix process (11) is essentially a continuous-time Wishart Autoregressive (WAR) process. The estimation of the WAR is straightforward, as it relies on standard methods such as the Method of Moments (see, e.g., Gourieroux et al., 2009; Gourieroux and Sufana, 2010). In our proposed model, it is straightforward to exploit the closed-form expression of the moment-generating function based on that of the characteristic function derived in Proposition 1, as the moment-generating function is the characteristic function evaluated at − it. The moments and cross-moments of asset returns can be found by using the moment-generating function and then applied in the Method of Moments for estimating (11). Sévi (2014) uses high-frequency data to forecast the volatility of crude oil futures.After estimatingθQ(t)and the covariance matrix process, the number of unknown model parameters is greatly reduced. Based on the elasticity of futures prices with different maturities with respect to spot prices, we can further develop a framework to separately estimate the market-implied matrix of cointegration coefficientsκQ(t). For the purpose of illustration, let us take the case of two risky assets as an example. As shown in (21), the explicit formulae for futures prices areF1,T(t)=exp[Tr(AQ(τ;U1(−i))v)+BQ(τ;U1(−i))′x+CQ(τ;U1(−i))]F2,T(t)=exp[Tr(AQ(τ;U2(−i))v)+BQ(τ;U2(−i))′x+CQ(τ;U2(−i))],whereBQ(τ;U1(−i))′x=(α0Q(τ)−κ11Qα1Q(τ))x1−κ12Qα1Q(τ)x2,BQ(τ;U2(−i))′x=(α0Q(τ)−κ22Qα1Q(τ))x2−κ21Qα1Q(τ)x1.The elasticity of the time-t futures prices maturing at T with respect to the time-t spot prices is∂F1,T(t)∂S1(t)S1(t)F1,T(t)=∂lnF1,T(t)∂x1(t)=α0Q(τ)−κ11Qα1Q(τ)=12ϕe−12(κ11Q+κ22Q+ϕ)τ×(κ11Q−eϕτκ11Q+(−1+eϕτ)κ22Q+(1+eϕτ)ϕ),whereϕ=(κ11Q)2+4κ12Qκ21Q−2κ11Qκ22Q+(κ22Q)2. Similarly, we have∂lnF2,T(t)∂x2(t)=α0Q(τ)−κ22Qα1Q(τ)=e−12(κ11Q+κ22Q+ϕ)τ((−1+eϕτ)κ11Q+κ22Q−eϕτκ22Q+(1+eϕτ)ϕ)2ϕ,∂lnF1,T(t)∂x2(t)=−κ12Qα1Q(τ)=−e−12(κ11Q+κ22Q+ϕ)τ(−1+eϕτ)κ12Qϕ,∂lnF2,T(t)∂x1(t)=−κ21Qα1Q(τ)=−e−12(κ11Q+κ22Q+ϕ)τ(−1+eϕτ)κ21Qϕ.To estimate the elasticities of the futures prices with respect to the contemporaneous spot prices, we can regress the first difference of the logarithmic distant futures prices on the first difference of the logarithmic spot prices or near futures prices, which are used as proxies for the spot prices. Then, the elements in the market-implied cointegration matrixκQcan be estimated separately by fitting the market-observed elasticities of futures prices.Example 4.1We first contrast the futures price under our proposed model with that under the stochastic convenience yield model proposed by Hilliard and Reis (1998). Our computation is based on (10) and (11) with the following parameters: r = 0.05, T = 1, β − 2γ = 7,ρ=(0.60.6)′,θQ(t)=(0.10.05)′,S0 = (1  1.1),κQ=13(1.1221),D1Q=(−0.500−0.5),D2Q=(−0.500−0.5),MQ=(−2.5−1.5−1.5−2.5),Q=(0.110.040.140.21),V0=(0.09−0.036−0.0360.09).The upper part of Fig. 3 plots the futures price against the spot convenience yield using the Hilliard–Reis model, and the lower part plots the futures price against the log-value of the current asset price of S2 using our proposed model. As we fix S1, t= 1 in all the computations, the change in log S2 corresponds to the change in the cointegrating factor of our model. Similar increasing trends are observed in futures prices with the spot value of the convenience yield and with the spot log-value of the cointegrated asset. Hence, we provide numerical evidence that the cointegrating factor contributes to futures prices as a stochastic convenience yield.We here discuss the valuation of the European vanilla call option on a single asset. Consider S1 to be the underlying asset of the vanilla call option whose payoff is given bymax(S1,T−K,0),where K is the strike price and T is the option’s maturity.The following proposition from Carr and Madan (1998) enables the valuation of the European vanilla option based on an inverse Fourier transform when the characteristic function of log-asset-values is available.Proposition 2(Carr & Madan, 1998) Suppose that the interest rate r is constant and the log-asset values Xt follow the risk-neutral dynamics (10) and (11). Then, the European call option pricing formula on S1at time 0 is given by(26)C(S1,0,K,T)=S1,0e−rT−ακFk,ξ−1[f1Q(x,v,t;ξ−(α+1)i)α2+α−ξ2+i(2α+1)ξ],where k = log K,f1Q(x,v,t;ϕ)is defined in (14) andFk,ξ−1[·]represents the inverse Fourier transform:(27)Fk,ξ−1[g(ξ)]=1π∫0∞e−iξkg(ξ)dξ.In addition, the inverse Fourier transform in (26) converges for some α > 0.Carr and Madan (1998) further advocate the use of the Fast Fourier Transform (FFT) to implement the Fourier inversion numerically, which simultaneously computes the option values for a set of log-strikes. Chourdakis (2004) shows significant improvement using the fractional FFT (FRFT), which is a linear transformation that generalizes the Fourier transform.Example 4.2It would be interesting to determine the performance of the FRFT applied to pricing vanilla options under the proposed model. We examine the pricing error of the solution of Proposition 2 and Lemma 2 using the FRFT technique. The model parameters are the same as those of Example 4.1. Monte Carlo (MC) simulation is adopted as the benchmark with the Wishart process generated by the efficient simulation procedure of Gauthier and Possamaï (2009), so that the percentage difference can be computed accordingly. The simulation uses 10, 000 pairs of sample paths, and the time-step is 1/300. The FRFT employs a different N, i.e., N = 8, 16, 32. The damping coefficient α is set at 3. Table 4shows that the numerical method is highly accurate because all of the errors are less than 1 percent. For the options with a maturity of one year, the 16-FRFT takes less than half a second to produce 16 option prices corresponding to different strike prices, whereas the simulation requires more than seven minutes. This numerical example verifies that our analytical solution is correct and the FRFT is accurate and efficient.Many options, such as spread, maximum, minimum, and basket options, are defined in terms of two or more underlying price processes. The underlying price system is typically modeled as a multivariate geometric Brownian motion whose volatility matrix is constant, in which case the option valuation problem is straightforward. However, such a model is unrealistic for capturing certain market phenomena. The proposed model not only accommodates cointegration relationship and stochastic covariance in commodity market, but also enables an explicit solution of characteristics function, which provides greater flexibility in pricing multivariate derivatives. To illustrate this, we consider the European option on two assets with payoff function Π(XT).22The extension to options on three or more assets is straightforward but suffers from the curse of dimensionality.Let the corresponding valuation formula be P(t, Xt, T). The following proposition links the option pricing formula to the joint characteristic function.Proposition 3Suppose that the interest rate is constant. The present value of the option is given by(28)P(0,X0,T)=e−rTFX0,u−1{f^(X0,V0;T,u)Π^(u)},whereFX0,u−1is the 2-D inverse Fourier transform, andΠ^(u)is the 2-D Fourier transform of the payoff function:(29)Π^(u)=FXT,u{Π(XT)},f^(X0,V0;T,u)=f(X0,V0;T,u)eiX0u′,in which f(X0, V0; T, u) is defined inLemma 2.See Appendix D in the supplementary material.□Given the characteristic function, all that remains is to derive the Fourier transform for the specific option payoffs. For instance, the crack spread option of the oil market has the payoff: max (S1, T− S2, T− K, 0), of which the Fourier transform has been derived in Hurd and Zhou (2010). Another popular option contingent on multiple assets is the maximum option or the best-of option with the payoff: max (max (S1, T, S2, T) − K, 0), of which the corresponding Fourier transform is derived here.Proposition 4Suppose that Π(X) = max (max (S1, T, S2, T) − K, 0). For any real numbers ε = (ε1, ε2) with ε2 > 0 and ε1 + ε2 < −1,(30)Π^(u)=−iK1−i(u1+u2)u1u2(i+u1+u2).See Appendix E in the supplementary material.□For options on several assets, Hurd and Zhou (2010) have already suggested a numerical method for pricing spread options in general. The derived characteristic function enables their numerical solution to work using FFT under our proposed model as well. We here provide numerical examples for the best-of option in Table 5, of which the model parameters are given in Example 4.1. With an option maturity of 12 months, the FFT method produces option prices with around 1 percent pricing difference compared to the simulation.

@&#CONCLUSIONS@&#
