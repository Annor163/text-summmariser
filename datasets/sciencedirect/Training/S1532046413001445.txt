@&#MAIN-TITLE@&#
Discovery of clinical pathway patterns from event logs using probabilistic topic models

@&#HIGHLIGHTS@&#
We propose a probabilistic model to discover underlying patterns in clinical pathways.Our approach models treatment activities and that of occurrences in clinical pathways.Evaluation is done using a real clinical dataset from a Chinese hospital.Discovered patterns surmise the essential features of clinical pathways.Discovered patterns can profitably be exploited as a basis for further analytical objectives.

@&#KEYPHRASES@&#
Clinical pathway analysis,Topic models,Latent Dirichlet Allocation,Pattern discovery,Clinical event log,

@&#ABSTRACT@&#
Discovery of clinical pathway (CP) patterns has experienced increased attention over the years due to its importance for revealing the structure, semantics and dynamics of CPs, and to its usefulness for providing clinicians with explicit knowledge which can be directly used to guide treatment activities of individual patients. Generally, discovery of CP patterns is a challenging task as treatment behaviors in CPs often have a large variability depending on factors such as time, location and patient individual. Based on the assumption that CP patterns can be derived from clinical event logs which usually record various treatment activities in CP executions, this study proposes a novel approach to CP pattern discovery by modeling CPs using mixtures of an extension to the Latent Dirichlet Allocation family that jointly models various treatment activities and their occurring time stamps in CPs. Clinical case studies are performed to evaluate the proposed approach via real-world data sets recording typical treatment behaviors in patient careflow. The obtained results demonstrate the suitability of the proposed approach for CP pattern discovery, and indicate the promise in research efforts related to CP analysis and optimization.

@&#INTRODUCTION@&#
In order to increase the quality of care services in an unfavorable economic scenario and under the financial pressure by governments, health-care organizations have to introduce clearly defined clinical pathways (CPs) for patients, and these pathways must be improved continuously [1–5]. A CP is a defined set of therapy and treatment activities that represent the steps required to achieve a specific treatment objective in patient careflow. It has been proven that CPs can break functional boundaries and offer an explicit process-oriented view of health-care where the efficient collaboration and coordination of physicians become the crucial issue [6,2,7–13]. Since actual treatment activities are extremely complex, with numerous variations across various stages in CPs, they often bear no relation to the ideal as envisaged by the designers of CPs. To this end, CP analysis is nonetheless vital for health-care management due to its usefulness for capturing the actionable knowledge to administrate, automate, and schedule the best practice for individual patients in the executions of CPs [14–19].Traditionally, health-care practitioners analyze CPs by looking at aggregated data seen from an external perspective, e.g., length of stay (LOS), charge, bed utilization, medical service levels, and so on [20]. A new and promising way of acquiring insights into CPs is to analyze clinical event logs using process mining techniques [21–24], which have been widely studied in the domain of business process management, which attempt to extract non-trivial and useful information from event logs [24,16]. Regarding clinical settings, many hospital information systems usually record various kinds of treatment events in patient careflow, and each event refers to a specific case (i.e., a patient trace following a specific CP), is related to a particular clinical activity type (i.e., a well-defined step in a specific CP), has an associated occurring time stamp, and other properties. Clinical event logs conceal an untapped reservoir of knowledge about the way of specific therapy and treatment activities being performed on particular patients in their careflow. It is, therefore, possible to mine clinical event logs, extract non-trivial knowledge from these logs, and exploit these for further analysis.In this study, we focus on discovering CP patterns from clinical event logs. We define CP patterns to be temporal regularities of CPs. A CP often involves several underlying patterns of treatment activities from admission to discharge, possibly over different time scales and for varying time intervals. The underlying patterns form the backbone of CPs and should be conserved, and the absence of presence of such patterns may indicate the cause of an anomaly or a malfunction (e.g., medical error) [25]. Therefore, we argue that discovery of CP patterns offers potentially rich information about patient treatment intent and behaviors, and can provide a basis for further CP analysis.However, discovery of CP patterns is in general a challenging task as the diversity and complexity of treatment behaviors in CPs are far higher than that of common business processes [16]. Although it is possible to employ existing process mining techniques in mining CP patterns from clinical event logs, many of them often generate spaghetti-like patterns which are difficult to be comprehended by clinical experts and either not amenable or lack of assistance to efforts of CP analysis and improvement. In our previous work [19], we developed a new process mining algorithm to derive a concise summary from a clinical event log. While the constructed summary is capable of describing the entire structure of a CP, it is challenged by describing underlying treatment patterns and handling the different levels of complexity of these patterns. Note that what makes the discovery of CP patterns complex is that they are typically composed of various and heterogeneous treatment activities and the composition of activities has a large variability depending on factors such as time, location and patient individual.To this end, we propose to leverage the power of probabilistic topic models (1) to extract latent CP patterns from event logs, and (2) to enable the recognition of patient traces as a composition of such patterns. In our previous work [18], we adapted a probabilistic topic model, Latent Dirichlet Allocation (LDA) to build a discovery model of latent CP patterns. LDA is an unsupervised probabilistic clustering technique used to discover latent topics from bags of words in text by finding co-occurrences of words in documents. Here, treatment activities are extracted and are mapped to words. These are then collated for a specific patient trace and become analogous to a document. The latent topics discovered by LDA in this way are interpreted as CP patterns. The probability distribution derived from LDA surmises the essential features of CP patterns, and CPs can be accurately described by combining different classes of distributions [18].While interpretable and meaningful CP patterns can be discovered, our previous work has a major shortcoming that it does not take the occurring time stamps of treatment activities into account. Note that a CP pattern captures not only the low-dimensional structure of treatment activities, but also when these activities are performed in patient careflow. Standard LDA does not distinguish differences in occurring time of treatment activities in CPs. While the occurring time stamp is often critical to capturing the meaning of treatment behaviors in CP analysis, neglecting it may result in spurious associations and misleading inference on capturing the meaning of underlying CP patterns from clinical event logs. Although it is possible to take pairs of “treatment activity–time stamp” as words in topic models, it will not be able to discriminate the generation of treatment activities and that of occurrences.In this work, we exploit to extend our previous work using LDA in [18] to propose an extension of LDA, i.e., clinical pathway model (CPM), show that richer CP patterns can be automatically discovered from clinical event logs. The proposed model finds latent CP patterns that are influenced by both treatment activities and their occurring time stamps in an unsupervised manner, thus disclosing temporal structure of discovered patterns. The ability to infer latent CP patterns is a vital and foundational component for CP analysis. Our investigations enable both richer representation and more accurate extractions of different aspects of treatment behaviors in CPs, and hence the outcomes of out study can be potentially valuable to CP analysis and redesign.The remainder of the paper is organized as follows. Section 2 presents preliminary knowledge of the proposed approach. Section 3 describes the proposed CPM for discovering underlying CP patterns from clinical event logs. Section 4 carefully presents our experimental results. Section 5 discusses the results obtained. Related work is outlined in Section 6. Finally, some conclusions are given in Section 7.The objective of this study is to discover latent CP patterns from clinical event logs. In particular, the proposed approach assumes that it is possible to record clinical events sequentially such that each event refers to a treatment activity (i.e., a well-defined step in a CP). Furthermore, additional information such that the occurring time stamp of the event is used in this study. To explain the kind of input needed for the proposed approach, we first define the concept of a clinical event.Definition 1(Clinical event)2Some clinical events might have a duration, i.e., they are conducted not at a specific time stamp, but over a time period. However, such a clinical event can be assumed to consist of a pair of sub clinical activities, i.e., a start event and an end event, which correspond to a start event and an end event, respectively. In this study, we assume that clinical events are time point events, and intervals are represented by starting and ending time point events.2. Let A be a finite set of event identifiers (clinical terms describing treatment activities), and T the time domain (set of time stamp primitives). A clinical evente is a pair e=(a,t) where a∈A and t∈T. Formally, we use e·a and e·t to denote the activity type, and the occurring time stamp of a clinical event, respectively. We denote by E⊆A×T the set of all valid clinical events of a particular domain.Note that clinical events could be characterized by various properties, e.g., an event has an occurring time stamp, it corresponds to an activity type, and has associated costs, etc. We do not impose a specific set of properties, however, given the focus of this paper, we assume that the activity type and occurring time stamp of the event are present. Thus, unfolding in time stamp and activity type, a clinical event e is a treatment activity–time stamp pair 〈activity,time stamp〉 that the activity has been occurred at a specific time point. For example, let ‘(Admission, day 1)’ is a clinical event indicating that a patient was in admission on the first day in his or her length of stay; likewise ‘(PCI, Day 4)’ means the patient was performed a percutaneous coronary intervention on the 4th day in his/her length of stay. For simplicity, the time stamps of these event examples are integer values, however it could be presented in a date-format time stamp.Definition 2(Patient trace). Let E be the domain of clinical events (i.e., the number of unique clinical events in the collection). A patient trace is a non-empty sequence of clinical events performed on a particular patient, i.e., σ=〈e1,e2,…,en〉, where ei∈E (1⩽i⩽n) is a particular clinical event.In general, a patient trace consists of different categories of clinical events. For a particular patient trace, certain temporal constraints exist between the events. Table 1depicts an example of eight patient traces. The corresponding meanings of treatment activities listed in Table 1 can be found in Table 4. We will continue to use this example in the rest of the paper to illustrate various points.From the practical point of view, we make the assumption that treatment behaviors in the executions of CPs are correctly recorded in a clinical event log. Information in the log is expected to (1) refer to clinical events of specific patient traces, and (2) the activity type and occurring time stamp of clinical events. The formal definition of a clinical event log is as follows:Definition 3(Clinical event log). LetCbe the set of all possible patient traces. A clinical event logLis a set of patient traces, i.e.,L⊆C.Table 1 shows an example of a clinical event log about the unstable angina CP, which consists of eight patient traces. Note that we assume that clinical events in CPs are regularly recorded in an event log by various kinds of hospital information systems, e.g., electronic medical record system (EMRs), radiology information system, picture archiving and communication system, laboratory information system, etc., which effectively reflects the real executing conditions in CPs.Latent Dirichlet Allocation (LDA) is a powerful tool, introduced by [26] and initially developed to characterize text documents, in which each document is modeled as a multinomial distribution of topics, and each topic is modeled as a multinomial distribution of words. LDA has been extended to other collections of discrete data. They are probabilistic generative models that can be used to explain multinomial observations by unsupervised learning.In our previous work, we employed LDA to discover latent CP patterns from clinical event logs, viewing this task as an inference problem over the latent CP pattern variables [18]. LDA allows to infer the inherent CP patterns from a clinical event log. For a particular patient trace σ, it picks a set of CP patterns with different emphasis. Thus, we model the mixture of CP patterns as multinomial probability distribution P(z∣σ) over CP pattern z. Similarly, the importance of each clinical activity a for each CP pattern z is also modeled as a multinomial probability distribution P(a∣z) over activities a of an activity domain. Given these two distributions, we can compute the probability of a clinical activity a occurring in patient trace σ:(1)P(a|σ)=∑z=1KP(a|z)P(z|σ)assuming that there are K CP patterns the log contains. Having many patient traces in the log, we observe a matrix of observed P(a∣σ) as depicted on the left-hand side of the equation in Fig. 1. This resulting clinical activity-patient trace matrix is assumed to be the product out of two matrices, one of the activity probabilities within CP patterns and another of the CP pattern probabilities within patient traces on the right-hand side, thereby recovering the characteristic clinical activities for each CP pattern and the mixture of CP patterns for each patient trace.Using the LDA model shown in Fig. 2A, each patient trace in the log is modeled as a finite mixture over an underlying set of K CP patterns. The CP pattern mixture is drawn from a Dirichlet prior to the entire log. The generative process begins by choosing a distribution over CP patterns z=(z1:K) for a given patient trace σ. Given a distribution of CP patterns for a patient trace, treatment activities are generated by sampling CP patterns from this distribution. The result is a vector of ∣σ∣ activities a=(e1:∣σ∣·a) for a patient trace σ (e1,e2,…,e∣σ∣∈σ). The steps adapted for patient traces are summarized below:1.Select a multinomial distribution ϕzfor each CP pattern z from a Dirichlet distribution with parameter β.For each patient trace σ in a clinical event logL, select a multinomial parameter θσover K CP patterns is sampled from a Dirichlet distribution with parameter α.For the activity type a of each event e in σ, select a CP pattern z from θσ,Select an activity a from ϕz.In LDA, each patient trace is a mixture of CP patterns represented by θσand each pattern is a distribution over treatment activities represented ϕz,a=P(a∣z), which represents CP patterns that we are interested to infer. Exact inference in LDA is known to be intractable. Options include the variational approach, expectation propagation or collapse Gibbs sampling [26,27]. In our previous work [18], we use Gibbs sampling to iteratively draw samples from the conditional distribution for each CP pattern ziafter marginalizing out the parameters:(2)P(ziσ=z|z-i,ei.a=a,a,α,β)∝mσ,z-i+αznσ,∗-i+α∗×nz,a-i+βanz,∗-i+β∗whereziσ=zrepresents the assignments of the ith event in a patient trace σ to pattern z, and z−i,σrepresents all pattern assignments not including the ith event. Furthermore,mz,a-iis the number of times clinical events whose activity types are a are assigned to pattern z, not including the current instance,nσ,z-iis the number of times pattern z has occurred in trace σ, not including the current instance, and the dot ∗ denotes the summing operation at the corresponding index, e.g.,mz,∗=∑a∈Amz,aorβ∗=∑a∈Aβa, where A is the universe of treatment activities.The first term of Eq. (2) is proportional to the number of the current CP pattern z within the patient trace σ and the second term is proportional to the count of the current activity a in σ to z. Intuitively the effect of co-occurrence is achieved by assigning higher probability to two activities in the same trace being assigned to the same pattern. For any sample from this Markov chain, being an assignment of each activity to a treatment pattern and using symmetric Dirichlet distribution (i.e., each distribution is parameterized by a single parameter), we can estimate ϕ and θ as follows:(3)ϕz,a=mz,a+βmz,∗+|A|β(4)θσ,z=nσ,z+αnσ,∗+KαFor more details of LDA-based CP pattern discovery from clinical event logs, please refer to [18].Realizing the needs above for the discovery of meaningful CP patterns, in this paper, we extend our previous work to propose a richer Bayesian topic model, i.e., clinical pathway model (CPM), for the task of hidden CP pattern extraction from clinical event logs, which offers solutions to the previously mentioned problem.The proposed CPM can discover latent CP patterns that are determined by both treatment activities and their occurring time stamps. The proposed model first generates a treatment activity to be performed, and then generates its occurring time stamp. The generative process is similar with that of standard topic models. For a specific event logLrecording routine treatment behaviors of a particular CP, it has pattern proportions θ that are sampled from a Dirichlet distribution, and each CP pattern is associated with a multinomial distribution ϕzover treatment activities and multinomial distribution φz,aover the time stamp of the occurred activity a for pattern z. So, θ, ϕzand φz,ahave a symmetric Dirichlet prior with hyper parameters α, β and δ, respectively.In summary, the proposed model assumes the following generative process for a clinical event log:1.Draw Discrete distribution ϕzfrom a Dirichlet prior β for each CP pattern z;Draw Discrete distribution φz,afrom a Dirichlet prior δ for each CP pattern z and each treatment activity a;For each patient trace σ, draw a Discrete distribution θσfrom a Dirichlet prior α, and then for each clinical event eiin patient trace σ:Draw CP pattern zifrom Discrete θσ; andDraw treatment activity ei·a from DiscreteϕziDraw time stamp ei·t from Discreteφzi,ei.a.Fig. 2B shows a graphical model representation of the proposed CPM for clinical event logs, which represents dependencies among variables. Here the shaded and unshaded nodes indicate observed and latent variables, respectively. The proposed model is an extension of the standard topic model. For a particular event ei, the time stamp ei·t is generated depending on CP pattern z and activity ei·a in the proposed CPM. Fig. 2C shows a possible generative process for CP patterns when modeled as CPM with the patient traces σ1 and σ2 in the example log shown in Table 1. It can be viewed as the expanded graphical model of the plate representation in Fig. 2B. A clinical event e has two specific properties, i.e., treatment activity e·a and the occurring time stamp e·t, in which e·a depends on the immediate CP pattern variable z, and e·t depends on both the CP pattern variable z and the treatment activity e·a. Thus with CPM, explicit CP patterns are modeled.As indicated in [26], inference in the LDA model family is intractable, thus we resort to an approximate technique, Gibbs sampling, to derive efficient sampling routines for CPM. Formally, we denote zσ=(z1,σ,z2,σ,…,z∣σ∣,σ) as the vector of CP pattern assignments within the patient trace σ andz={zσ|σ∈L}as the concatenated pattern assignments for the entire log. This convention is also applied for clinical events {eσ,e}, treatment activities {aσ,a}, and time stamps {tσ,t}.Our interest is in the distribution P(z,e∣α,β,δ}. As we mentioned above, exact inference is known to be intractable in the LDA family, and thus we resort to approximate inference using Gibbs sampling. This is achieved by integrating out the parameter random variables, and taking advantages of conjugacy to derive a close form for the Gibbs conditional distribution P(zσ,i∣zσ,−i,e,α,β,δ). Because the parameter variables are integrated out during sampling, this is also known as collapsed Gibbs sampling. We start the joint distribution as follows:(5)P(z,e|α,β,δ)=P(z,a,t|α,β,δ)=P(z|α)P(a|z,β)P(t|z,a,δ)For P(z∣α), we have:(6)P(z|α)∝∏σ=1|L|∏z=1KΓ(mz,σ+α∗)Γ(mσ,∗+α∗)where Γ(·) is the gamma function, mz,σis the count of observing that patient trace σ is assigned to CP pattern z, and ∗ denotes the summing operation at the corresponding index, e.g.,mσ,∗=∑z=1Kmz,σorα∗=∑z=1Kαz.For P(a∣z,β), we have:(7)P(a|z,β)∝∏z=1K∏a=1|A|Γ(βa+nz,a)Γ(β∗+nz,∗)where nz,ais the count of observing that activity a is assigned to pattern z, and the dot ∗ denotes the summing operation at the corresponding index, e.g.,nz,∗=∑a=1|A|nz,aorβ∗=∑a=1|A|βa.For P(t∣z,a,δ), we have:(8)P(t|z,a,δ)∝∏z=1K∏a=1|A|∏t=1|T|Γ(δt+qz,a,t)Γ(δ∗+qz,a,∗)where qz,a,tis the count of observing that activity a occurring at time stamp t is assigned to pattern z, and ∗ denotes the summing operation at the corresponding index, e.g.,qz,a,∗=∑t=1|T|qz,a,torδ∗=∑t=1|T|δt.Our objective is to derive the conditional Gibbs distribution P(zσ,i=z∣zσ,−i,e,α,β,δ), where zσ,−i=z/{zσ,i} denotes the set of remaining pattern variables except at position i in the patient trace σ. Substituting Eqs. (6)–(8) into Eq. (5), and using symmetric Dirichlet distribution, we obtain the conditional Gibbs distribution as follows:(9)P(zσ,i=z|zσ,-i,e,α,β,δ)∝mσ,z+αmσ,∗+Kα·nz,a+βnz,∗+|A|β·qz,a,t+δqz,a,∗+|T|δDetails of the derivation are in Appendix A. In all cases, the current sampling position is always excluded during counting.Consider Eq. (9), which computes a probability of a certain CP pattern for the present event i in the patient trace σ. In particular, the occurring time information of clinical activities is inferred from Eq. (9). Suppose that we are currently determining the probability that the pattern of the present activity a is z. Eq. (9) determines the probability of the occurring time of a under z.The pseudo-code for CP pattern extraction with CPM is shown in Algorithm 1, where the posterior estimates in Eqs. (10)–(12) are used to derive the patterns.Algorithm 1Gibbs sampling for CPM.1: Input:2: A clinical event logL, hyper-parameters α, β, and δ3: Steps:4:Initialize zσ,eσfor allσ∈Lrandomly5:Iterate over a large number of iterations (e.g. 1000):6:Iterate over each patient trace σ in the logL7:Iterate over each clinical event e in the trace σ8:Sample a CP pattern z assignment for e according to Eq. (8)9: Output:10: Estimate the model parameters as follows:(10)ϕˆz,a=nz,a+βnz,∗+|A|β(11)θˆσ,z=mσ,z+αmσ,∗+Kα(12)φˆz,a,t=qz,a,t+δqz,a,∗+|T|δThe complexity of driving a sample from Eq. (9) is O(K), making an over complexity of O(NK) for each Gibbs round, where K is the number of CP patterns in consideration, andN=∑σ∈L|σ|is the number of events in clinical event logL. Thus, the total complexity for S Gibbs samples is O(SNK). In practice, K and S are often fixed in advance, making N the main factor that contributes to the complexity. In other words, the proposed CPM scales linearly with the number of events recorded in the log.We utilize the proposed CPM as a means of characterizing the underlying CP patterns from a specific clinical event log. Fig. 3presents a schematic representation of assumptions about learning, which are built into the model. It is assumed that each patient trace contains a set of CP patterns with initial proportions. During patient careflow, treatment behaviors performed on the patient updates the CP pattern proportions. The task for the model is to induce the CP patterns mixed in the patient trace from the treatment behaviors performed on his or her careflow, and to relate them to update the probability distributions of CP patterns over the patient trace.Taking the log shown in Table 1 as an example, and assuming the number of latent CP patterns K is 2. The typical activity labels and their occurring time stamps for the derived patterns shown in Fig. 4. The CP pattern-patient trace distribution p(z∣σ) measures the connection (or relatedness) of a specific patient trace with a specific CP pattern (i.e., the conditional probability of a CP pattern in a given patient trace). We used this statistical probability to group patient traces by associating them with patterns. Taking the log shown in Table 1 as an example, the pattern-trace distribution values are listed in Table 2. The traces are grouped into specific clusters based on their pattern-trace distribution values. For example, the traces σ1, σ3, σ4, σ5, σ6, σ7 and σ8 have the similar probability distribution to belong to pattern 1. Thus, these six traces are grouped into the same cluster. While for patient traces σ2 and σ3 in the example log, they have similar probability distributions over the derived patterns such that both traces can be grouped into the other cluster.As we can see, CPM is now explicitly capturing the associations between treatment activities and their occurring time stamps. By learning the parameters of the model, we obtain the set of CP patterns that appear in a clinical event log and their relevance to different patient traces, which truly models essential treatment activities and also possible occurring time instants of these activities. Thus we are able to reveal the temporal structure of discovered CP patterns.

@&#CONCLUSIONS@&#
