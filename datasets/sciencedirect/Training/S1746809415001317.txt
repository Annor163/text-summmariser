@&#MAIN-TITLE@&#
An adaptive RV measure based fuzzy weighting subspace clustering (ARV-FWSC) for fMRI data analysis

@&#HIGHLIGHTS@&#
We propose an adaptive RV measure based fuzzy weighting subspace clustering for fMRI data analysis.We apply a threshold to adaptively change the shape of the generated cube.We use a simple and effective denoising method.We adopt the RV coefficient to measure the distance between two multivariate sets.We modify the distance measure approach in objective function and updating formulas.

@&#KEYPHRASES@&#
Fuzzy clustering analysis,Fuzzy weighting subspace clustering,RV measure,Generated cube,

@&#ABSTRACT@&#
Conventional clustering methods for analyzing the fMRI data usually meet some difficulties, such as the huge samples, the slow processing speed, and serious noise effect. In this study, a novel adaptive RV measure based fuzzy weighting subspace clustering (ARV-FWSC) is proposed for fMRI data analysis. In this approach, the adaptive RV measure, different from the traditional distance measure like Euclidean distance or Pearson correlation coefficient, is applied to the clustering process, where the distance measure between two single voxels is converted into the adaptive RV measure between two sets of multi-voxels contained in the correspondingly generated cubes, whose shape is automatically updated by setting a threshold of the weighted template. Meanwhile, a simple denoising mechanism is also used to find noise points, whose datum generated cube only having one center voxel, and can directly exclude those noise voxels from the cluster. Furthermore, a modified fuzzy weighting subspace clustering is introduced to measure the importance of each dimension to a particular cluster, where the proposed algorithm could take the influence of different time points in each clustering process into account, besides having the advantage of ordinary fuzzy clustering like FCM (fuzzy c-means). Several evaluation metrics, e.g., coverage degree, ROC curve, and the number of clustering iteration, are adopted to assess the performance of the ARV-FWSC on real fMRI data compared with those of GLM (general liner model), ICA (independent component analysis), and FCM. Extensive experiment results show that the proposed ARV-FWSC for fMRI data analysis can effectively improve the clustering speed and raise the clustering accuracy.

@&#INTRODUCTION@&#
As a major data-driven analysis approach, clustering has been successfully applied to fMRI data analysis in the past decade [1–5], in which fuzzy clustering analysis (FCA) is particularly prominent [6–8]. In 1973, Ruspini [9] applied the fuzzy set theory to clustering analysis for the first time, and demonstrated that fuzzy clustering algorithm, such as the most classical algorithm fuzzy c-means (FCM) [10,11], is a method of unsupervised learning based on the theory of fuzzy mathematics. Since then, the research on fuzzy clustering is very active and has made a lot of concrete achievements in objective function, membership function and clustering criterion function, etc. The subsequent research is mostly the improvement and optimization of the FCM, which overcomes various inherent defects of FCM using different principle from different angles and different direction to achieve better clustering performance. The main idea of FCM is that the similarity between the objects belonging to the same cluster is the largest, while the similarity between the objects of different cluster is the smaller. However, due to the huge quantity and serious noise of fMRI data, conventional FCA methods show a few limitations which lead to the slow processing speed or unfavorable clustering results. This is mainly due to that the Euclidean distance or Pearson correlation coefficient between two single voxels leads to the slow convergence speed and the unsatisfactory noise suppression performance in the iteration process [12]. Fortunately, the multivariate distance measure regarding to the multiple voxels has more fine spatial information to contribute to computation. For this reason, many scholars adopted a kind of multivariate distance measure, i.e., RV coefficient measure [13], to measure the similarity between two multi-voxel sets in their fMRI data analysis [14–17]. Kherif et al. adopted the RV coefficient to measure meaningful spatial or temporal similarities and used multidimensional scaling to give a visual representation of each subject's position with respect to other subjects in the group [14]. Abdi et al. applied the RV coefficient to measure the distance between multiple distance matrices in their multidimensional scaling analysis [16]. Zhang et al. proposed the weighted-RV method under the ROI-based multivariate statistical framework to detect the spatial fine-scale patterns of functional connectivity [17]. In our previous study, we presented a fuzzy cluster method based on improved RV measure for task-related fMRI data to extract functional networks [12]. Although this method enhanced the convergence rate per iteration and converted the distance measure between two single voxels into the RV measure between two multi-voxel sets in the corresponding generated cube at a certain extent, its performance could be further improved and optimized.In addition, owing to the advantage of clustering high dimensional data, subspace clustering (or projective clustering) also attracted a lot of attentions of researchers in recent years, and got many theoretical and practical achievements [18–23]. The goal of subspace clustering is to identify different clusters in different subsets of data dimensions [18]. Therefore, a subspace cluster not only represents the cluster itself, but also represents the subspace where the cluster is located [19]. Subspace clustering methods are usually divided into two types: hard subspace clustering and soft subspace clustering. The former gives each dimension the determined weight of 0 or 1, while the latter gives each dimension a weight between 0 and 1. Because of the fuzzy weights of dimensions, soft subspace clustering has greater flexibility relatively and gets attention of many scholars [19]. Soft subspace clustering also can be grouped into two main categories: fuzzy weighting subspace clustering [24–27] and entropy weighting subspace clustering [28,29]. Jing et al. presented a new fuzzy weighting subspace clustering algorithm that automatically calculated the feature weights in clustering sparse text data, and their experimental results showed that the new method outperformed the standard k-means algorithm [25]. Deng and colleagues proposed an enhanced entropy weighting subspace clustering method and applied it to high dimensional gene expression data for clustering analysis [30].In this study, we firstly apply soft subspace clustering to analyze the fMRI data, where the influence of different time points in each clustering process could be taken into account. In view of the great amount of data in fMRI data analysis and the complexity of entropy weighting subspace clustering, we focus on the fuzzy weighting subspace clustering at present. Combining the RV measure and fuzzy weighting subspace clustering, we present a novel adaptive RV measure based fuzzy weighting subspace clustering (ARV–FWSC) for fMRI data analysis. The aim of our method is to effectively suppress the influence of noise, improve the accuracy of clustering, reduce the number of iteration, and accelerate the clustering speed. The performance of our method is evaluated on real fMRI data compared with those of several classical methods, e.g., GLM (general liner model), ICA (independent component analysis) and FCM (fuzzy c-means). In view of a few clustering methods having been applied to some nervous and mental diseases [31,32], we would take advantage of the proposed method to develop the research on the fMRI data of brain diseases in the future.Six healthy subjects (three participated in visual task experiment and three participated in resting state experiment) had been informed about the purpose of this study and signed a written agreement. The fMRI data were acquired on a Philips 3.0 Tesla scanner which used a multi-element receiver coil and could acquire partially parallel images.In visual task experiment, the visual stimulus paradigm was OFF-ON-OFF-ON-OFF-ON, and each state lasted 20s. At ‘OFF’ state, the subjects focused on the cross at the center of the screen. While at ‘ON’ state, the subjects received the visual stimulus which was a radial blue/yellow checkerboard reversing at 7Hz. The fMRI data of two subjects were acquired using a single-shot sensitive-gradient echo planar imaging sequence with 37 slices, a sensitive acceleration factor of 2.0, TR=2.0s, scan resolution of 64×64, in-slice resolution of 4mm×4mm, slice thickness of 4mm and slice interval of 1mm. The fMRI data of the other subject was acquired using a single-shot sensitive-gradient echo planar imaging sequence with 40 slices, a sensitive acceleration factor of 3.0, TR=2.0s, scan resolution of 80×80, in-slice resolution of 3mm×3mm, slice thickness of 3mm and slice interval of 1mm. The aim of using different scan parameters is to verify the effectiveness and stability of our method on different data with different original parameters.In resting-state experiment, the subjects were required to lie inside the machine, close their eyes, and stay relaxed and awake. The fMRI data of one subject was acquired using a single-shot sensitive-gradient echo planar imaging sequence with 37 slices, a sensitive acceleration factor of 2.0, TR=2.0s, scan resolution of 80×80, in-slice resolution of 3mm×3mm, slice thickness of 3mm and slice interval of 1mm. The fMRI data of the other two subjects were acquired using a single-shot sensitive-gradient echo planar imaging sequence with 35 slices, a sensitive acceleration factor of 2.0, TR=2.0s, scan resolution of 64×64, in-slice resolution of 3.75mm×3.75mm, slice thickness of 4mm and slice interval of 1mm.Data processing was mainly performed with Matlab (Matlab 2008a, Mathworks Inc., Sherborn, MA, USA), SPM8 (http://www.fil.ion.ucl.ac.uk/spm/) and MRIcro software (http://www.mricro.com). The preprocessing procedure of the task-related fMRI data included the slice timing and realign operation. The resting-state fMRI data were also performed the normalization and Gaussian smoothing besides the slice timing and realign operation.Here, the GLM method refers to the statistic parametric mapping based on the general linear model. As a classical model-driven analysis approach, it provided a general approach that accommodated most forms of experimental layout and ensuing analysis (designed experiments with fixed effects for factors, covariates and interaction of factors) [33]. In our comparative experiments, GLM is treated as a reference method for other methods to process task-related fMRI data. When analyzing rest-state fMRI data, GLM is not recommendable owing to the lack of prior knowledge.The main purpose of independent component analysis (ICA) is to solve the problem of blind source separation in signal processing. As an important data-driven method, ICA seeks to find a linear combination of components without prior information about the spatial or temporal patterns of source signals, and has been a popular method for functional connectivity detection using fMRI [34].Traditional univariate distance measures, like Euclidean distance or Pearson correlation coefficient, have certain defects in clustering process. The RV coefficient [35] was introduced as a measure of similarity between different matrices and as a theoretical tool to analyze multivariate techniques. RV coefficient could be described as:(1)RVX,Y=trXXTYYTtrXXTXXT1/2×trYYTYYT1/2where, X is a n×p matrix, and Y is a n×q matrix, XT is the transpose of a matrix, andtr⋅is the trace operation of a matrix.Fuzzy weighting subspace clustering (FWSC) attempts to categorize a datasetX=x1,x2,⋯,xn⊂ℜpinto a preselected number of clusters c with a set of clustering centersV=vi1≤i≤c. While uij(0≤uij≤1) denotes the fuzzy membership degree of xjbelonging to cluster i, the corresponding fuzzy membership degree matrix could be defined asU=uij1≤i≤c,1≤j≤n. A weightingwik(0≤wik≤1)is assigned to each dimension to measure the importance of the kth dimension to the ith cluster, and the corresponding weighting matrix could be defined asW=wik1≤i≤c,1≤k≤pwhich could identify the subspace where each cluster is located. The result of FWSC was achieved by minimizing the following objective function [18]:(2)JFWSCX,U,V,W=∑i=1c∑j=1nuijm∑k=1pwikτ(xjk−vik)2s.t.0≤uij≤1,∑i=1cuij=1;0≤wik≤1,∑k=1pwik=1where, m and τ are the fuzzy indices (m>1, τ>1). Membership degrees uij, the componentsvikof each cluster centerviand dimension weightingswikare updated according to the following expressions:(3)uij=1∑s=1cdijdsj1/(m−1),dij=∑k=1pwikτ(xjk−vik)2(4)vik=∑j=1nuijmxjk∑j=1nuijm(5)wik=1∑s=1pqikqis1/(τ−1),qik=∑j=1nuijm(xjk−vik)2In the proposed ARV-FWSC, the dataset X represents a set of all voxels of brain regions, and xj(j=1, 2, ⋯, n) represents each voxel's time course with p time points. Thus, each time course of a certain voxel could be regarded as a data point with p dimensions, and the whole dataset is defined by a matrixXn,p. The cluster centers, the membership degree matrix and the dimension weighting matrix are defined V with size c×p, U with size c×n and W with size c×p, respectively. The objective function of ARV-FWSC is modified as follows:(6)JARV-FWSCX,U,V,W=∑i=1c∑j=1nuijm∑k=1pwikτd2(xjk;vik)s.t.0≤uij≤1,∑i=1cuij=1;0≤wik≤1,∑k=1pwik=1where,dxjk;vikis the similarity measure between xjkandvik, distinct to the distance measure shown in Eq. (2). Membership degrees uij, the componentsvikof each cluster centerviand dimension weightingswikare also modified and updated according to the following expressions:(7)uij=1∑s=1cdx˜j;v˜idx˜j;v˜2/(m−1)(8)vik=∑j=1nuijmxjk∑j=1nuijm(9)wik=1∑s=1pqak;bikqas;bis2/(τ−1)where,ak=x1k,x2k,⋯,xnk⊂ℜn(k=1,2,⋯,p)represents the total data points of the kth dimension,bik=vik,vik,⋯,vik⊂ℜn(i=1,2,⋯,c;k=1,2,⋯,p), andqak;bikis calculated using the RV measure. Each dimension weightingwikrepresents the importance degree of the kth time point to the ith cluster. Every voxel with p time points would be multiplied by the corresponding dimension weightings and then be projected to the subspace of the ith cluster.x˜jandv˜iare the projection results of xjandvi, respectively, on each subspace of the ith cluster.d(x˜j;v˜i)is calculated by the adaptive RV measure:(10)d(x˜j;v˜i)=2(1−ARV(X˜,Y˜))X˜andY˜are two projection datasets of two generated cubes where voxel xjand cluster centerviare located, respectively.Before calculating the adaptive RV coefficient, we firstly calculate the Pearson correlation coefficients between each voxel and the central voxel in the generated cube to form the weighted template, and then set a threshold value ξ. All voxels, subjecting to the corresponding weight with less than the threshold value will be dropped from the search cube, and a specifically formed shape cube will participate in the RV coefficient calculation. The multivariate similarity illustration of the adaptive RV measure is presented in Fig. 1. The adaptive RV coefficient between X and Y can be described as:(11)ARV(X,Y)=RV(Xξ,Yξ),where, ξ is the threshold of the weighted template, and Xξwith the size of g×p, g>1, is the voxel set contained by the generated cube of the voxel xjto be classified under ξ. While Yξwith the size of h×p, h>1, is the voxel set contained by the generated cube of class centralviunder ξ.Furthermore, a simple but effective mechanism for denoising is applied in the adaptive RV metrics. In Fig. 1, we assume that the cube surrounded by the yellow curve is the generated cube of one cluster center (called center generated cube) and another cube is the generated cube of the voxel to be classified (called datum generated cube). When the datum generated cube only contains an isolated voxel, i.e., the central voxel, whose all neighborhood voxels having lower weight values than the threshold, this central voxel of the cube would be regarded as the noise point, and its membership degree would be directly set as 0 without calculating the RV coefficient between two generated cubes.In addition, a kind of cluster center initialization method, kd-tree cluster center initialization [36], is adopted to improve the accuracy of initial cluster center and steady the number of iterations.The corresponding algorithm of our proposed method is shown in Fig. 2. The input parameters include the number of clusters c, fuzzy index m and τ, the threshold of generated cube ξ, the threshold of termination ε and the maximal number of iterations M. In our task-related and resting-state experiments, ε=0.001, M=200, c varies from 2 to 30, m varies from 1.0 to 2.0 with a step of 0.1, τ varies from 1.0 to 2.0 with a step of 0.1, and ξ varies from 0.1 to 0.9 with a step of 0.1. The results we got are the local optimal results.Please note that when processing task-related fMRI data, we consider that the importance of each time point is same, i.e., the weighting values of all dimensions are always equal. Thus, for the task-related fMRI data, we fix the dimension weighting matrix W withwik=1/p, and set the fuzzy index τ=0.In our experiments of task-related fMRI data, to evaluate the precision of the discovered functional cortex areas, we define coverage degree as the coincidence degree of the functional networks detected by a certain analysis method and GLM, respectively, i.e., the ratio of the same areas detected by two methods to the total brain area.Receiver operating characteristic (ROC) curve has been used extensively as a tool for the analysis of fMRI processing techniques [37]. Given a classifier and a set of voxels, there are four possible outcomes. If a voxel is abnormal and it is classified as positive (i.e., the fact that this voxel is among the clustering result), it is counted as a true positive; if it is classified as negative (i.e., the fact that this voxel is not among the clustering result), it is counted as a false negative. If a voxel is normal and it is classified as negative, it is counted as a true negative; if it is classified as positive, it is counted as a false positive. The true positive rate and the true negative rate are called sensitivity and specificity, respectively, and they are described as:(12)sensitivity=positivescorrectlyclassifiedtotalpositives(13)specificity=negativesincorrectlyclassifiedtotalnegativesSensitivity and specificity will be altered with the change of a control parameter in detection procedure. ROC curve is drawn with sensitivity, i.e., true positive rate, plotted on the vertical axis and (1-specificity), i.e., false positive rate, plotted on the horizontal axis. That the curve is close to the top left corner represents the corresponding analysis method is superior [37].To a certain extent, the number of iterations of an algorithm reflects the execution speed of the algorithm. The number of iterations of our method refers to the update number of membership degree matrix when the objective function obtains the optimal solution. The number of iterations of FCM is similar to that of our method, and more specific description can be seen from the reference [12].

@&#CONCLUSIONS@&#
In this study, the ARV-FWSC is proposed to analyze the fMRI data. The work involves the following aspects: (1) We apply a weight value for each voxel in the generated cube and set a threshold to adaptively change the shape of the generated cube which contains multiple voxels and has more fine spatial information. (2) We use a simple and effective denoising method, i.e., those voxel points, whose all neighborhood voxels in the datum generated cube have lower weight values than the preset threshold, are directly regarded as noise points and their membership degree values are directly set to 0. (3) We adopt the RV coefficient rather than Euclidean distance or PCC to measure the distance between two multivariate sets. (4) We introduce the method of fuzzy weighting subspace clustering to the fMRI data process, and modify the distance measure approach in objective function and updating formulas. (5) Some evaluation methods of fMRI data analysis, such as coverage degree, ROC curve, and the number of clustering iterations, are adopted to compare the performance of different data process methods. Whether the task-related or the resting-state fMRI data experiments illustrate that our method is effective and stable on different data with different original parameters and has superior ability of detecting specific functional networks as well as faster clustering speed than that of traditional clustering method.Moreover, the threshold of the generated cube needs to be manually set in this paper. We can improve this shortcoming to the automatic threshold to realize the truly adaptive technique in the future. In addition, we can also apply some parameter optimization methods to simplify the computing complexity of our method. The study will be further extended to introduce other latest subspace clustering method such as entropy weighting subspace clustering and other clustering such as the thought of integrating within-cluster and between-cluster information to our clustering process, and apply our method to the diagnosis of brain diseases.