@&#MAIN-TITLE@&#
Adaptive threshold based fuzzy directional filter design using background information

@&#HIGHLIGHTS@&#
In this paper fuzzy logic based novel noise detection and removal technique has been presented.Adaptively computes the fuzzy membership functions for noise detection and restoration purposes.Noisy pixel's background information is used by the technique for accurate analysis.Based on quantitative measures, proposed technique outperforms the existing methods.

@&#KEYPHRASES@&#
Image restoration,Random-valued impulse noise,Directional statistics,Adaptive threshold,Fuzzy filter,

@&#ABSTRACT@&#
A novel adaptive fuzzy directional median filter is proposed in this paper which considers the directional pixels (horizontal, vertical and two diagonal directions) for estimation of adaptive threshold and incorporates the remaining background pixels based on directional statistics for efficient noise detection. The proposed filter consists of two phases: adaptive fuzzy noise detection phase followed by fuzzy filtering phase. In fuzzy noise detection phase, intensity differences from the central pixel in a 5×5 sliding window are calculated in four main directions, i.e., horizontal, vertical and two diagonal directions. Average value and central pixel value of 5×5 sliding window of newly constructed intensity differences image are exploited with fuzzy membership function to adaptively estimate threshold parameters. These parameters are then merged with fuzzy rules to detect the noise especially in detailed regions of an image. In filtering phase, simple median filter and directional median filters are smartly used based on edge and background information to restore the noisy pixels detected as noisy in adaptive fuzzy noise detection process. Experimental results based on well known quantitative measures shows the effectiveness of the proposed technique.center weighted median filterswitching median filterdirectional weighted median filteradaptive median filtermulti-stage directional median filterfuzzy reasoning based directional median filter designgrey level of noisy pixelnoise densityintensity differencesaverage directional differencesaverage directional deviation of δdcentral pixel value of average directional deviation of δdmembership degreemembership degree of largefirst threshold parametersecond threshold parametermediandirectional index5×5 sliding window

@&#INTRODUCTION@&#
Impulse noise in digital images is frequently introduced during acquisition, storage and transmission due to noisy sensors and communication channels etc. [1]. During this process, some pixel intensities got disturbed while others stay noise free. When impulse noise is added in an image, compatibility of the corrupted pixels becomes compromised with their local neighborhood [2]. Usually, impulse noise is of two types: fixed value and random value. In fixed value impulse noise, pixel value of the corrupted one transforms to 0 (minimum) or 255 (maximum) while in random value impulse noise, pixel value of the corrupted pixel fits into the interval [0,255] for grayscale images [1,2].A number of linear and non-linear impulse noise removal filters have been proposed. Linear filters are more like average filters and carry out fine filtering but produce blurry effects on restored images because the algorithm considers the noisy and non-noisy pixels equally during the filtering process. Non-linear filters are more robust against the noise because of their computational efficiency and de-noising power [3]. Median (MED) is a well know non-linear filter that restores the corrupted pixel value by taking the median of neighboring pixels around the current pixel. However, median filer might spread the information of edges and lines in detailed region. To handle this issue, a number of median based filters such as center weighted median (CWM) filter [3], switching median (SWM) filter [4], adaptive median (AMED) filter [5], tri-state median filter [6], directional weighted median (DWM) filer [7], multi-stage directional median (MSDM) filer [8], fuzzy reasoning based directional median (FRDMF) filter design [9] and other essential filters have been proposed for impulse noise removal, edge and detail preservation [21–25].Center weighted median (CWM) filter is a special case of weighted median (WM) filter [4] which restricts the freedom of setting the weights at central location of the window whereas in WM filter, weights can be put at unusual locations of the sliding window. These filters are more robust against additive noise. Switching median (SWM) and adaptive median (AMED) filters perform filtering in two steps – detection step and then filtering step. Noisy pixels are acknowledged in detection phase while pixels detected as noisy are restored with estimated values in filtering phase. AMED preserves low and high noise densities well whereas SWM filter is heavily dependent on the detection algorithm used in the filtering process.Directional weighted median (DWM) filter is also a variation of median filter that works excellently in smooth regions of an image. DWM filter first calculates the direction indices for the pixels aligning in horizontal, vertical and diagonal directions and then uses a fixed threshold which works well under some conditions but fails to find correct edge or line directions in detailed regions of an image which ultimately decreases the noise removal capabilities of the DWM filter. Multi-stage median (MSM) filter overcomes the problems of DWM filter by exploiting the background information. MSM filter first calculates the background information by taking the median value of the remaining eight (8) pixels of the convolutionary filter and then finds the standard deviation in four main directions. The smallest standard deviation suggests a possible edge direction. Fuzzy reasoning based directional median filter (FRDMF) design also offers a finer solution by exercising the fuzzy rules and fuzzy membership functions for the problems mentioned in DWM filter.In this paper we have proposed an adaptive threshold based fuzzy directional filter which considers the directional pixels (horizontal, vertical and two diagonal directions) as well as the remaining background pixels of 5×5 sliding window as shown in Fig. 1(a). For efficient noise detection, the proposed filter works in two phases: adaptive fuzzy noise detection phase and then fuzzy filtering mechanism. In adaptive fuzzy noise detection phase, threshold parameters to filter out the noisy pixels are determined adaptively by exploiting the directional statistics. If the noisy pixel lies in the smooth region then it can be preserved by simple median filter because the median filter preserves the information well in smooth regions. However, if the noisy pixel lies in detailed region then directional median filter is used to restore the noisy pixels. The proposed filter efficiently locates the edge or line and then restores the noisy pixels based on their tight clustering around the mean.The paper is organized as follows: Section 2 introduces DWM and fuzzy reasoning based directional filter design along with their problems. Noise models are discussed in Section 3, followed by proposed adaptive threshold based fuzzy directional median filer in Section 4. Section 5 presents performance measures. Comparison of results and their discussions are described in Section 6 while conclusions are drawn in Section 7.Image restoration techniques are developed based on two main assumptions. Firstly, the non-noisy image comprises of smooth regions and these smooth regions are separated by the edges present in the image. Secondly, the intensity of the noisy pixel is quite different from its surrounding pixels. Therefore, in impulsive noise contaminated image, identification of noisy pixel is done by using aforementioned intensity jumps in comparison with its neighboring pixels. Hence, by analyzing the local image statistics within a small window, impulse detection can be performed. Furthermore, classification of pixel which is detected as noisy in smooth region or detailed region, noisy pixel helps in estimation of its intensity value without distorting the detailed/smooth region. Therefore, edge statistics are being used in state-of-the-art filtering techniques for edge preserving noise removal. Fig. 1 shows the edges aligned in four main directions in a local 5×5 window. The sliding window Ωi,j={fi−2,j−2, fi−1,j−1, …, fi+2,j+1, fi+2,j+2} of size 5×5 centered at location (i,j) consists of 25 intensity values. LetCkΩi,jrepresent the coordinates of direction k in window Ωi,jcentered at (i,j).(1a)C1Ωi,j={(i−2,j−2),(i−1,j−1),(i+1,j+1),(i+2,j+2)}(1b)C2Ωi,j={(i,j−2),(i,j−1),(i,j+1),(i,j+2)}(1c)C3Ωi,j={(i+2,j−2),(i+1,j−1),(i−1,j+1),(i−2,j+2)}(1d)C4Ωi,j={(i−2,j),(i−1,j),(i+1,j),(i+2,j)}In DWM [7], directional indices are computed to find possible edge direction so that the noisy pixels can be distinguished from the edgy pixels. Eq. (2a) is used to compute directional indices for k directions.(2a)Dk=∑(h,l)εCkΩi,j|Ωi,j(h,l)−Ωi,j(i,j)|,∀k=1,2,3,4.These direction indices are then used to find the minimum direction index using following equation.(2b)Dmin=Min(Dk),∀k=1,2,3,4.In DWM [7], Dminis used to decide whether the current pixel is noisy or not but it cannot correctly classify that whether noise is on the edge or in smooth region. Let us compute the procedure on the sample window shown in Fig. 2.(2c)Dmin=(400,400,400,400)=400For threshold less than 400, pixel will be classified as noisy pixel in smooth region. However it is noisy pixel along the edge.In FRDMF [9], fuzzy reasoning is used to detect the pixel under consideration as noise free, noise in smooth region or noise in detailed region. Fuzzy membership functions based on fixed thresholds are applied on normalized directional indices.(3a)Dk=Dk4,∀k=1,2,3,4.(3b)Dk=100,∀k=1,2,3,4.In FRDMF [9], fuzzy rules are applied on directional indices sorted in ascending order. Let Dsdenote the sorted directional indices Dkin ascending order such that D1≤D2≤D3≤D4 and superscript s inDs, s=1, 2, 3, 4, represents the order number of Dk, k=1, 2, 3, 4. Following fuzzy rules are applied on Ds.(4a)F1=LARGE(D1)·LARGE(D2)·LARGE(D3)·LARGE(D4),(4b)F2=SMALL(D1)·LARGE(D2)·LARGE(D3)·LARGE(D4),(4c)F3=SMALL(D1)·SMALL(D2)·LARGE(D3)·LARGE(D4),(4d)F4=SMALL(D1)·SMALL(D2)·SMALL(D3)·LARGE(D4),(4e)F5=SMALL(D1)·SMALL(D2)·SMALL(D3)·SMALL(D4),where SMALL and LARGE are the fuzzy membership functions constructed using threshold [s=20, b=70] giving best performance in FRDMF [9]. These fuzzy membership functions are shown in Fig. 3(b). Membership degrees of directional indices in fuzzy membership function SMALL and LARGE are as follows:(5a)μSMALL(Ds)=0,∀s=1,2,3,4,(5b)μLARGE(Ds)=1,∀s=1,2,3,4.Product inference engine used in [9] is exploited in (4a)–(4e) to grasp the fuzzy logic. After computing Fmand Max(Fm)=F1, this satisfies the case-1 in FRDMF [9]. Case-1 indicates that the pixel under consideration is noisy pixel in smooth region due to which standard median filter is applied which will distort the edge information.In this section two essential noise models are discussed. These noise models [1] are very supportive for extensively probing the performance of the proposed filter in practical situations.In this type of noise, image pixels are corrupted by black and white spots which randomly appear in the image. Noise model 1 can be described mathematically as follows:(6a)Ni,j=0or255,with probabilitypOi,j,with probability1−pThis type of noise is also known as uniform noise in which pixels can take any value from the interval [0,255] for 8-bit grayscale images. Noise model 2 can be described mathematically as follows:(6b)Ni,j=ηi,j,with probability,pOi,j,with probability,1−p,where Ni,j, Oi,jare noisy and original images respectively, ηi,jrepresents the gray level of noisy pixel and p represents noise density in a gray scale image. Fig. 4shows the effects of these noise models on some standard images.The proposed filter is a combination of adaptive fuzzy noise detection and fuzzy filtering mechanism. In adaptive fuzzy noise detection algorithm, noise detection is purely based on directional pixels where as in fuzzy filtering mechanism, variations of median filters are used to restore the noisy pixels.First of all, intensity differences between the pixels aligned in four main directions i.e., vertical, horizontal and diagonals directions as shown in Fig. 1 from the central pixel are calculated as:(7a)Δn=14∑xεWn|x−xi,j|,n=1,2,3,4,where Wn, n=1, 2, 3, 4, denotes 16 neighboring pixels excluding the central pixel of the 5×5 sliding window. From Eq. (7a) we get four intensity differences. Let Δn, n=1, 2, 3, 4, be the new intensity difference values after sorting them in ascending order with Δ1 and Δ4 are the minimum and maximum intensity values respectively.For adaptive threshold, we calculate average directional deviations using the following equation:(7b)δd(i,j)=∑nεWnΔn4,n=1,2,3,4.Eq. (7b) gives a new image matrix where large values of δd(i,j) are the impulse noise pixels or edge pixels. Edge pixels are detail preserving pixels which cannot be mixed with the noisy ones. To differentiate the noisy and edgy pixels, we have used two important parameters based on directional statistics of the image.(8a)v1=∑l=−22∑m=−22δd(i+l,j+m)25(8b)v2=δd(i,j)Fuzzy logic and fuzzy rules [9–11] are used to establish the following three reasons to differentiate the edgy, noisy and noise free pixels.1.If v1 and v2 are large, then it is an edge pixel.If v1 and v2 are very similar, then it is a noise-free pixel.If difference between v1 and v2 is large, then it is a noisy pixel.Rule: IF |v1(i,j)−v2(i,j)| is largeTHEN pixel at position (i,j) is an impulse noise pixel.Where large is a fuzzy set [12] which can be represented by a fuzzy membership function Large as shown in Fig. 3(a). From this function, membership degrees (μDegree) are derived as:(9)μDegree(i,j)=μLARGE[|v1−v2|,α,β]As the membership degrees in a fuzzy set are mapped from 0 to 1 inclusive. If the difference between v1 and v2 receives a membership degree 1, then the pixel is considered as noisy and if it receives a membership degree 0 then it is a noise free pixel. Also, if the membership degree lies between 0 and 1, then we are not sure whether such pixel is corrupted with noise or not. To find the exact degree of noise present in noisy pixel, we have used two important parameters α and β which are defined as follows:(10a)α(i,j)=MINl,mε{−2,…,2}[δd(i+l),j+m)],(10b)β(i,j)=α(i,j)+0.2×α(i,j),where α(i,j) corresponds to δd(i,j), the area contains minimum noise and β(i,j) is dependent of α(i,j).Next we have used five fuzzy rules with two fuzzy membership functions BIG and SMALL to calculate the degree of noise present in each pixel using intensity differences and threshold parameters (α and β) shown in Fig. 3. The five fuzzy rules are as follows:Rule-1: noise in smooth regionR1=BIG(Δ1)(α,β)×BIG(Δ2)(α,β)×BIG(Δ3)(α,β)×BIG(Δ4)(α,β)Rule-2: an edge pixelR2=SMALL(Δ1)(α,β)×BIG(Δ2)(α,β)×BIG(Δ3)(α,β)×BIG(Δ4)(α,β)Rule-3: noise in detailed regionR3=SMALL(Δ1)(α,β)×SMALL(Δ2)(α,β)×BIG(Δ3)(α,β)×BIG(Δ4)(α,β)Rule-4: noise in detailed regionR4=SMALL(Δ1)(α,β)×SMALL(Δ2)(α,β)×SMALL(Δ3)(α,β)×BIG(Δ4)(α,β)Rule-5: noise-freeR5=SMALL(Δ1)(α,β)×SMALL(Δ2)(α,β)×SMALL(Δ3)(α,β)×SMALL(Δ4)(α,β)(11a)BIG(v)=0,v<αv−αβ−α,α≤v<β1,v≥β(11b)SMALL(v)=1,v<αv−βα−β,α≤v<β0,v≥βThe pixels acknowledged as noisy are considered for noise removal in filtering phase. The proposed filter wisely makes use of median filter to preserve the image details. For example, noisy pixels in smooth and detailed region are preserved by median and directional median filter respectively whereas the edge and noise-free pixels are simply preserved. The three cases for noise removal are as follows:Case 1. For noise pixel in smooth regionIf Max[R1, R2, R3, R4, R5]=R1 then standard median filter [1] can be used preserve the image details.(12a)yi,j=MEDxεW{x}Case 2. For an edge pixel or noise-free pixelIf Max[R1, R2, R3, R4, R5]=R2 or Max[R1, R2, R3, R4, R5]=R5 then the current pixel is simply preserved.(12b)yi,j=xi,jCase 3. For noise pixel in detailed regionIf Max[R1, R2, R3, R4, R5]=R3 or Max[R1, R2, R3, R4, R5]=R4 then the image details are preserved by the following directional median filter:(12c)yi,j=MEDxεWDir4{x},if|Δ1−Δ2|<|Δ3−Δ4|MEDxεWDir1{x},if|Δ1−Δ2|>|Δ3−Δ4|MEDxεWDirN{x},if|Δ1−Δ2|=|Δ3−Δ4|,(12d)yi,j=MAX︸kε{1,2,3,4}{|MED[B(i,j)]−Mk(i,j)|},where N represents the index of edge direction where |MED[B(i, j)]−Mk(i, j)| value is maximum, W belongs to a 5×5 sliding window, B(i,j) is background information of remaining eight pixels other than the directional pixels i.e., {(−2,1), (−2,−1), (2,−1), (2,1), (−1,−2), (−1,2), (1,−2), (1,2)}, Mk(i,j), k=1, 2, 3, 4 are the median values of pixels in four directions as shown in Fig. 1(a), yi,jis restored pixel, Dir1 and Dir4 are the directions of edge pixels. We can determine the edge direction of the pixels in other two cases by checking the value of the outlier. For example, if |Δ1−Δ2|>|Δ3−Δ4| then Δ1 is the outlier with noise in direction Dir1, otherwise, Δ4 is the outlier with noise in direction Dir4. When |Δ1−Δ2|=|Δ3−Δ4| then the direction of edge can be determined by checking the difference values of |MED[B(i, j)]−Mk(i, j)|. Index of the greater difference value gives the direction of edge because the edge pixels usually produce larger differences. By taking the median of directional pixels in that direction, we can restore the noisy pixel.Mean square error (MSE) and peak signal-to-noise ratio (PSNR) [1] are the objective quantitative measures used for comparisons of restored and original images defined by:(13)MSE(R,O)=1L×M∑iL∑jM[Oi,j−Ri,j]2,(14)PSNR(R,O)=10×log10×S21MSE(R,O),where Oi,jis the original image, Ri,jis the restored image of size L×M and S is the maximum possible intensity value (maximum will be 255 with 8-bit).

@&#CONCLUSIONS@&#
Restoration of tainted images corrupted by impulse noise is an interesting problem. For noise removal, median filter is one of the basic non-liner filter widely used in restoration techniques. Because of its ability to perform well in smooth regions, it has some snags as well as it smoothes the image noise resulting some loss of edge information. Therefore, to deal with two conflicting goals, noise smoothing and edge preservation, an intelligent technique has been proposed in this paper. Proposed technique considers directional pixels (horizontal, vertical and two diagonal directions) as well as the remaining background pixels for restoration of tainted images despoiled by random valued impulse noise. The proposed filter is a combination of two phases: adaptive fuzzy noise detection phase and then fuzzy filtering mechanism. In adaptive fuzzy noise detection phase, threshold parameters to filter out the noise are determined adaptively by exploiting the directional pixels. If the noisy pixel lies in the smooth region then it can be preserved by simple median filter. If the noisy pixel lies in detailed region then statistical based directional median filter is used to restore the corrupted pixels. The proposed filter intelligently utilizes the edge direction, background and directional information induced from intensity differences in detailed and smooth regions to restore the corrupted pixels. The proposed filter restores the corrupted image with finer image quality and excellent PSNR values for different types of images.In future, authors are planning to extend the proposed technique for de-blurring as well as space variant noise removal. Furthermore, various other soft computing techniques can be used to remove random valued impulse noise for color images.