@&#MAIN-TITLE@&#
A new B-spline representation for cubic splines over Powell–Sabin triangulations

@&#HIGHLIGHTS@&#
We consider aC1cubic spline space defined over a Powell–Sabin refined triangulation.The space has some localC2super-smoothness and can be seen as a close extension of the classical cubic Clough–Tocher spline space.We construct a suitable normalized B-spline representation for this spline space.We also show how to compute the Bézier control net of such a spline in a stable way.

@&#KEYPHRASES@&#
C,1,cubic splines,Macro-elements,Powell–Sabin splines,Clough–Tocher splines,Normalized B-splines,Bézier control net,

@&#ABSTRACT@&#
We consider aC1cubic spline space defined over a triangulation with Powell–Sabin refinement. The space has some localC2super-smoothness and can be seen as a close extension of the classical cubic Clough–Tocher spline space. In addition, we construct a suitable normalized B-spline representation for this spline space. The basis functions have a local support, they are nonnegative, and they form a partition of unity. We also show how to compute the Bézier control net of such a spline in a stable way.

@&#INTRODUCTION@&#
Smooth (finite element) spline spaces defined over triangulations have been studied extensively and applied in different contexts (see, e.g., Lai and Schumaker, 2007; Nürnberger and Zeilfelder, 2000, and the references quoted therein). Typically, such spline spaces provide good approximation properties and possess a small dimension which can be expressed in terms of geometrically interesting characteristics of the triangulation (like the number of vertices, edges and/or triangles). In addition, a stable basis representation is often required for practical purposes.For the construction of smooth splines with a low polynomial degree, one often considers triangulations with a particular macro-structure. Each triangle in the triangulation is then split into a number of subtriangles. The Clough–Tocher split (into three subtriangles) and the Powell–Sabin split (into six subtriangles) are commonly used splits. Splines defined on such refined triangulations are referred to as Clough–Tocher splines and Powell–Sabin splines, respectively.Dierckx (1997) has developed an interesting normalized B-spline representation forC1quadratic Powell–Sabin splines. These splines have been introduced by Powell and Sabin (1977) with the aim of drawing contour lines of bivariate functions. The B-spline representation consists of a set of locally supported basis functions which form a convex partition of unity (i.e., they are nonnegative and sum up to one). The spline coefficients in this representation possess an intuitive geometric interpretation involving tangent control triangles. This normalized B-spline representation has been effective in a wide range of application areas, for example, surface modeling and compression (Dierckx, 1997; Maes and Bultheel, 2006; Speleers et al., 2009), scattered data interpolation and approximation (Manni and Sablonnière, 2007; Sbibih et al., 2009, 2015), the numerical solution of differential problems (Speleers et al., 2006, 2012). Recently, basis functions with similar properties have been constructed for certain Powell–Sabin spline spaces of higher degree and smoothness. In particular, we mentionC1cubics (Lamnii et al., 2014),C2quintics (Speleers, 2010a), and a family of splines of smoothness r and polynomial degree3r−1(Speleers, 2013a). Local super-smoothness has been imposed in order to simplify their construction and to reduce their number of degrees of freedom while maintaining the full approximation order. The quadratic Powell–Sabin spline case has also been extended to the trivariate setting (Sbibih et al., 2012) and the general multivariate setting (Speleers, 2013b).On the other hand, the construction of a normalized B-spline representation for Clough–Tocher splines is a challenging task. Originally,C1cubic Clough–Tocher splines (CT3-splines) have been developed by Clough and Tocher (1965) as a tool for the finite element method. Later on, they were also applied in the area of scattered data interpolation (see, e.g., Farin, 1985; Kashyap, 1996; Mann, 1999). A normalized B-spline basis has been constructed by Speleers (2010b) for a certain subspace of the CT3-spline space. Yet, it is still an open question whether or not it is possible to construct a normalized B-spline basis for the full CT3-spline space. In this paper, we do not answer this question, but we provide a normalized B-spline basis for a slightly enlarged space, so every CT3-spline can be represented with it. We consider aC1cubic spline space defined over a triangulation endowed with a Powell–Sabin refinement. The space has specific localC2super-smoothness to mimic closely the CT3-spline space.The paper is organized as follows. In Section 2 we review some general concepts of polynomials on triangles, we give the definition of our cubic spline space and point out its relation with the classical Clough–Tocher spline space. Section 3 covers the construction of a normalized B-spline basis and gives a geometric interpretation: we are looking for a set of triangles that contain a specific set of points. In Section 4 we consider spline surfaces and describe how control points can be defined. We also present a stable way to compute the Bézier ordinates of such a spline. Section 5 discusses some strategies to reduce the number of degrees of freedom in the proposed spline space. In particular, we detail the relation with the reduced CT3-splines developed by Speleers (2010b). Finally, in Section 6 we end with some concluding remarks.In this section we introduce ourC1cubic spline space. To this end, we first recall some preliminary concepts of bivariate polynomials in Bernstein–Bézier form defined on triangles.LetT(V1,V2,V3)be a non-degenerate triangle. Any point P in the plane of the triangle can be uniquely expressed in terms of the barycentric coordinatesτ=(τ1,τ2,τ3)with respect toT, such that(2.1)P=∑i=13τiVi,andτ1+τ2+τ3=1.LetPddenote the linear space of bivariate polynomials of total degree less than or equal to d. Any polynomialpd∈Pddefined over the triangleThas a unique Bernstein–Bézier representation(2.2)pd(τ)=∑i+j+k=dbijkBijkd(τ),with(2.3)Bijkd(τ)=d!i!j!k!τ1iτ2jτ3kthe Bernstein polynomials of degree d, which form a convex partition of unity onT. The coefficientsbijkare called Bézier ordinates, and the Bézier domain pointsξijkare defined as the points with barycentric coordinates(id,jd,kd). The Bernstein–Bézier representation is often visualized in a schematic way by associating each Bézier ordinatebijkwith the Bézier domain pointξijk. The piecewise linear interpolant of the Bézier control points, defined asbijk=(ξijk,bijk), is called the Bézier control net. This control net is tangent to the polynomial surface at the three vertices. Polynomials in their Bernstein–Bézier form can be evaluated in a stable way using the de Casteljau algorithm. This algorithm can also be used to derive smoothness conditions between (the Bézier ordinates of) polynomials defined over adjacent triangles. More details can be found in the works by Farin (1986), Lai and Schumaker (2007).The diskDrof radius r around vertexV1ofTis the set of domain points defined by(2.4)Dr(V1)={ξi1i2i3:i1≥d−r}.The rowErat distance r parallel to edgeε12=〈V1,V2〉inTis the set of domain points defined byEr(ε12)={ξi1i2i3:i3=r}.Given a triangulation Δ, the diskDr(V1)in Δ is defined as the set of all domain points in (2.4) for each triangle in Δ havingV1as a vertex. A row in Δ is defined in a similar way. Hereinafter, if we refer to a Bézier ordinate in a disk or on a row, then we actually mean a Bézier ordinate whose corresponding domain point is in that location.Let Ω be a closed polygonal domain inR2and let Δ be a triangulation of Ω. We denote bynv,ntandnethe number of vertices, triangles and edges in Δ, respectively. The verticesVi,i=1,…,nv, in Δ have as Cartesian coordinates(xi,yi).A Clough–Tocher (CT-) refinementΔCTof Δ partitions all triangles in Δ into three smaller triangles (Clough and Tocher, 1965). For each triangleT, a split point Z is chosen in the interior ofTand it is connected to the three vertices ofTby straight lines (see Fig. 1(left)). The space of piecewise cubic polynomials onΔCTwith globalC1-continuity will be referred to as the cubic Clough–Tocher (CT3-) spline space, i.e.,(2.5)S31(ΔCT)={s∈C1(Ω):s|TCT∈P3,TCT∈ΔCT}.The dimension of this space is equal to3nv+ne. Given a single macro-triangleT(V1,V2,V3)in Δ, on each of the three subtriangles the CT3-spline is a cubic polynomial that can be represented in its Bernstein–Bézier form, i.e., withd=3in equations (2.2) and (2.3). Fig. 1(right) shows the regions inside a macro-triangle where the corresponding Bézier ordinates of a CT3-spline are related by the inherent smoothness conditions. Note that CT3-splines possess aC2super-smoothness at the split points (see, e.g., Farin, 1986).A Powell–Sabin (PS-) refinementΔPSof Δ is the refined triangulation obtained by subdividing each triangle of Δ into six subtriangles as follows (Powell and Sabin, 1977).1.Select a split pointZjinside each triangleTj∈Δand connect it to the three vertices ofTjby straight lines.For each pair of trianglesTiandTjwith a common edge, connect the two pointsZiandZj. IfTjis a boundary triangle, then also connectZjto an arbitrary point on each of the boundary edges.The space of piecewise cubic polynomials onΔPSwith globalC1-continuity is denoted by(2.6)S31(ΔPS)={s∈C1(Ω):s|TPS∈P3,TPS∈ΔPS}.In this paper we focus on a particular subspace ofS31(ΔPS)with additional smoothness around some vertices and edges. Imposing local super-smoothness is an interesting way to reduce the dimension of the space, while maintaining the full approximation order. LetZPS={Zi}i=1ntbe the set of triangle split points inΔPS, and letEPSbe the set of all edges inΔPSthat connect a triangle split pointZito an edge split pointRk. The spaceSˆ31(ΔPS)of super-smooth splines onΔPSis defined by(2.7)Sˆ31(ΔPS)={s∈S31(ΔPS):s∈C2(Z),Z∈ZPS;s∈C2(ε),ε∈EPS}.Here,Cμ(Z)means that the polynomials on triangles inΔPSsharing the vertex Z have common derivatives up to order μ at that vertex. Analogously,Cμ(ε)means that the polynomials on triangles inΔPSsharing the edge ε have common derivatives up to order μ along that edge. The spaceSˆ31(ΔPS)will be referred to as the cubic Powell–Sabin (PS3-) spline space. Fig. 2(right) shows the regions inside a macro-triangle where the corresponding Bézier ordinates of a PS3-spline are related by the inherent smoothness conditions. A splines∈Sˆ31(ΔPS)can be characterized by means of the following Hermite interpolation problem.Theorem 1For each edgeεmin Δ, letνmbe any unit vector that is not parallel to the edge. There exists a unique splines(x,y)∈Sˆ31(ΔPS)satisfying(2.8a)s(Vl)=fl,∂s∂x(Vl)=fx,l,∂s∂y(Vl)=fy,l,l=1,…,nv,and(2.8b)s(Rm)=gm,∂s∂νm(Rm)=gν,m,m=1,…,ne,for a given set of(fl,fx,l,fy,l)-values and(gm,gν,m)-values. Hence, a PS3-spline is uniquely defined by means of its function value and first derivatives at thenvverticesVlin Δ and by means of its function value andνm-derivative at theneedge split pointsRminΔPS.We focus on a single macro-triangleT(V1,V2,V3)in Δ, as shown in Fig. 2. On each of the six subtriangles, the PS3-spline s is a cubic polynomial that can be represented in its Bernstein–Bézier form. We will check that the interpolation conditions in (2.8) uniquely specify all the Bézier ordinates of s on the macro-triangle. The conditions (2.8a) determine the Bézier ordinates in the disksD1(V1),D1(V2)andD1(V3). Because of theC2-smoothness across the edge〈Z,R3〉and the conditions (2.8b) at the split pointR3on the edgeε3=〈V1,V2〉, the remaining Bézier ordinates on the rowsEr(ε3),r=0,1are also uniquely defined. The same argument holds for the Bézier ordinates on the rows related to the edgesε1=〈V2,V3〉andε2=〈V3,V1〉. Finally, theC2smoothness at the split point Z specifies the remaining Bézier ordinates in the diskD2(Z).  □From Theorem 1 it follows that the dimension ofSˆ31(ΔPS)is equal to3nv+2ne.In the next theorem we show that the CT3-spline space is a subspace of the PS3-spline space. We say that the partitionsΔCTandΔPSof the same triangulation Δ are compatible if the triangle split pointsZi,i=1,…,ntcoincide in both partitions.Theorem 2If the partitionsΔCTandΔPSare compatible, thenS31(ΔCT)⊂Sˆ31(ΔPS).It is easy to see thatS˜31(ΔPS)⊂Sˆ31(ΔPS), whereS˜31(ΔPS)={s∈S31(ΔPS):s∈C2(Z),Z∈ZPS;s∈C3(ε),ε∈EPS}.We now show thatS˜31(ΔPS)=S31(ΔCT)when the partitionsΔCTandΔPSare compatible. As already mentioned before, the CT3-splines possess aC2super-smoothness at the split pointsZ∈ZPS. Moreover, when a cubic spline isC3across an interior edgeε∈EPS, it is a single cubic polynomial over the two adjacent subtriangles. This completes the proof.  □Since the CT3-spline space is a subspace of the PS3-spline space, the latter space also contains cubic polynomials, and consequently has an optimal approximation order.Another cubic subspace ofS31(ΔPS)with localC2super-smoothness has been considered by Chen and Liu (2008); Lamnii et al. (2014). However, that space is not so attractive as (2.7), because the corresponding Hermite interpolation scheme involves second order derivatives and the CT3-spline space is not a subspace. Many other spline spaces with a higher order of smoothness defined on a triangulation with PS-refinement or CT-refinement can be found in the literature (see, e.g., Alfeld and Schumaker, 2002a, 2002b; Laghchim-Lahlou and Sablonnière, 1994; Lai and Schumaker, 2001, 2003, 2007; Sablonnière, 1985; Speleers, 2013a).In this section we look for a suitable B-spline representation ofs(x,y)∈Sˆ31(ΔPS),(3.1)s(x,y)=∑i=1nv∑j=13ci,jvBi,jv(x,y)+∑k=1ne∑j=12ck,jeBk,je(x,y),in which the basis functionsBi,jv(x,y)andBk,je(x,y)have a local support and form a convex partition of unity. We will refer toBi,jv(x,y)andBk,je(x,y)as a B-spline with respect to the vertexViand the edgeεk, respectively.We define the B-splineBk,je(x,y)with respect to the edgeεkas the unique solution of the interpolation problem (2.8) with all(fl,fx,l,fy,l)=(0,0,0)and with all(gm,gν,m)=(0,0), except form=k, where(gk,gν,k)≠(0,0). It is easy to prove that such a spline vanishes outside the union of the two macro-triangles adjacent to the edgeεk.We now focus on the macro-triangleT(V1,V2,V3), as shown in Fig. 2(left), and we assume that the points indicated in the figure have the following barycentric coordinates:(3.2)V1=(1,0,0),V2=(0,1,0),V3=(0,0,1),Z=(z1,z2,z3),R1=(0,λ23,λ32),R2=(λ13,0,λ31),R3=(λ12,λ21,0).In order to specify completely the B-splineBk,je(x,y)related to the edgeε3=〈V1,V2〉(k=3), i.e., determining the values(gk,gν,k), we make use of the Bernstein–Bézier representation. The corresponding Bézier ordinates are schematically represented in Fig. 3. From the definition of the B-spline it follows that many of these ordinates are zero, as can be seen in the figure. Because of theC2-continuity across the edge〈Z,R3〉, the Bézier ordinatesd1e,d2e,d3ecan be regarded as ordinates after subdivision of a single (univariate) quadratic polynomialp2edefined on the edge segment〈P1,P2〉given by(3.3)P1=23V1+13R3,P2=23V2+13R3.This quadratic polynomialp2ecan be chosen to have the values0,βk,j,0as its three Bézier ordinates, for some parameterβk,j. Then, we get(3.4)d1e=λ21βk,j,d2e=2λ12λ21βk,j,d3e=λ12βk,j.In a similar way, we obtain(3.5)d4e=λ21γk,j,d5e=2λ12λ21γk,j,d6e=λ12γk,j,for some parameterγk,j. The remaining ordinates are determined by theC2-smoothness at the split point Z, i.e.,(3.6)d7e=z2γk,j,d8e=(z2λ12+z1λ21)γk,j,d9e=z1γk,j,d10e=z2λ13γk,j,d11e=2z1z2γk,j,d12e=z1λ23γk,j.In order to ensure nonnegativity, it suffices to impose that all Bézier ordinates of the B-splineBk,je(x,y)are nonnegative. Looking at (3.4)–(3.6), this is the case when(3.7)βk,j≥0,γk,j≥0.The conditions in (3.7) are also necessary conditions for nonnegativity, becauseBk,je(Rk)=d2e=2λ12λ21βk,jandBk,je(Z)=d11e=2z1z2γk,j. Hence, we need to choose two couples of parameters(βk,1,γk,1)and(βk,2,γk,2)satisfying (3.7) in order to define two nonnegative basis functions related to the edgeεk. Depending on the type of the edgeεk, we choose these parameters as follows.1.Ifεkis a boundary edge:(3.8a)(βk,1,γk,1)=(0,1),and(βk,2,γk,2)=(1,0).Ifεkis an interior edge, so that there is another adjacent macro-triangleT˜and the line through the split points Z andZ˜intersects the edge inRk:(3.8b)(βk,1,γk,1)=(‖Rk−Z˜‖‖Z−Z˜‖,1),and(βk,2,γk,2)=(‖Z−Rk‖‖Z−Z˜‖,0).The molecule (also called 1-ring)Miof the vertexViis defined as the union of all triangles in the triangulation that containVi. The B-splineBi,jv(x,y)with respect to the vertexViis defined as the unique solution of the interpolation problem (2.8) with all(fl,fx,l,fy,l)=(0,0,0), except forl=i, where(fi,fx,i,fy,i)=(αi,j,αi,jx,αi,jy), and with all(gm,gν,m)=(0,0), except for any m such thatεmis an edge withVias endpoint, where(gm,gν,m)≠(0,0). Such a spline is zero outside the molecule ofVi.We consider again the macro-triangleT(V1,V2,V3)depicted in Fig. 2(left); the barycentric coordinates of the points in the figure are given in (3.2). Without loss of generality, we look at the Bernstein–Bézier representation of the B-splineB1,jv(x,y)related to the vertexV1(i=1), in order to specify the values(gm,gν,m)assuming the triplet(α1,j,α1,jx,α1,jy)is given. The corresponding Bézier ordinates are schematically represented in Fig. 4. In view of theC1-smoothness at the vertexV1, the Bézier ordinates in the neighborhood ofV1are found as(3.9a)d1v=α1,j,(3.9b)d2v=α1,j+λ213(α1,jx(x2−x1)+α1,jy(y2−y1)),(3.9c)d3v=α1,j+z23(α1,jx(x2−x1)+α1,jy(y2−y1))+z33(α1,jx(x3−x1)+α1,jy(y3−y1)),(3.9d)d4v=α1,j+λ313(α1,jx(x3−x1)+α1,jy(y3−y1)).In a similar way we can compute the Bézier ordinates in the neighborhood of the verticesV2andV3. In order to satisfy theC2-continuity across the edge〈Z,R3〉, we take(3.10)d5v=λ12d2v,d6v=λ12d3v,d10v=λ122d2v,d11v=λ122d3v.Note that the ordinatesd2v,d5v,d10vcan be regarded as ordinates after subdivision of a single (univariate) quadratic polynomialp2vdefined on the edge segment〈P1,P2〉, see (3.3). This quadratic polynomialp2vhas the valuesd2v,0,0as its three Bézier ordinates. A similar reasoning holds for the ordinatesd3v,d6v,d11v. In the same way, in order to satisfy theC2-continuity across the edge〈Z,R2〉, we take(3.11)d9v=λ13d4v,d8v=λ13d3v,d16v=λ132d4v,d15v=λ132d3v.The remaining Bézier ordinates are then specified by theC2-smoothness at the split point Z, i.e.,(3.12)d7v=z1d3v,d12v=z1λ12d3v,d13v=z12d3v,d14v=z1λ13d3v.From the Bernstein–Bézier representation depicted in Fig. 4 we notice that the B-splineB1,jv(x,y)isC2-continuous across the edge〈V2,V3〉.In order to ensure nonnegativity ofB1,jv(x,y), we impose that all its Bézier ordinates are nonnegative. It is clear from (3.9)–(3.12), that this is the case when(3.13)d1v≥0,d2v≥0,d3v≥0,d4v≥0.This is not only a sufficient condition, but also a necessary condition for nonnegativity. Indeed, we haveB1,jv(Vi)=d1v,B1,jv(R3)=d10v=λ122d2v,B1,jv(R2)=d16v=λ132d4v, andB1,jv(Z)=d13v=z12d3v. If the molecule ofV1has more than one triangle, then we have to impose conditions similar to (3.13) for each of these triangles. These conditions are always feasible and there is an infinite number of solutions. This can be proved following the same geometric construction as developed by Dierckx (1997); the details are given in the next subsection.In this subsection we investigate for which choices of the parameters(αi,j,αi,jx,αi,jy)the basis functions form a convex partition of unity. From the definition of the B-splines (related to both the vertices and the edges) it follows that only three basis functions have a nonzero function and derivative value at the vertexVi. Hence, we need to satisfy(3.14a)αi,1+αi,2+αi,3=1,(3.14b)αi,1x+αi,2x+αi,3x=0,(3.14c)αi,1y+αi,2y+αi,3y=0,fori=1,…,nv. By taking into account the construction of the B-splines and the choices for the edge parameters in (3.8), we easily find that the conditions (3.14) are necessary and sufficient to form a partition of unity.We now focus on the nonnegativity of the basis functions. For each vertexViwe define three pointsQi,jv=(Xi,jv,Yi,jv),j=1,2,3, and for each edgeεkwe define two pointsQk,je=(Xk,je,Yk,je),j=1,2, such that(3.15a)∑i=1nv∑j=13Xi,jvBi,jv(x,y)+∑k=1ne∑j=12Xk,jeBk,je(x,y)=x,(3.15b)∑i=1nv∑j=13Yi,jvBi,jv(x,y)+∑k=1ne∑j=12Yk,jeBk,je(x,y)=y,for any(x,y)∈Ω. Hence, the pointsQi,jvandQk,jeare the Greville points for our B-spline representation. By using the interpolation problem (2.8) and the definition of the B-splines, the Cartesian coordinates of the pointsQi,jvcan be obtained as the solution of the systems(3.16a)αi,1Xi,1v+αi,2Xi,2v+αi,3Xi,3v=xi,(3.16b)αi,1xXi,1v+αi,2xXi,2v+αi,3xXi,3v=1,(3.16c)αi,1yXi,1v+αi,2yXi,2v+αi,3yXi,3v=0,and(3.17a)αi,1Yi,1v+αi,2Yi,2v+αi,3Yi,3v=yi,(3.17b)αi,1xYi,1v+αi,2xYi,2v+αi,3xYi,3v=0,(3.17c)αi,1yYi,1v+αi,2yYi,2v+αi,3yYi,3v=1.We can compactly write (3.14), (3.16) and (3.17) in the following matrix notation(3.18)[αi,1αi,2αi,3αi,1xαi,2xαi,3xαi,1yαi,2yαi,3y][Xi,1vYi,1v1Xi,2vYi,2v1Xi,3vYi,3v1]=[xiyi1100010].The triangleti(Qi,1v,Qi,2v,Qi,3v)will be called the PS3-triangle with respect to the vertexVi.Following the same arguments as for quadratic Powell–Sabin B-splines (Dierckx, 1997), it can be easily shown that the constraints (3.13) related to the macro-triangleT(V1,V2,V3)are equivalent to the request that the following set of points are inside the trianglet1:(3.19)V1,S1=23V1+13Z,S2=23V1+13R2,S3=23V1+13R3.These points are the Bézier domain points in the diskD1(V1)inΔPS, and they will be called PS3-points with respect to the vertexV1. Summarizing, we can state the following theorem.Theorem 3The set of B-splinesBi,jv(x,y)andBk,je(x,y)are nonnegative and form a partition of unity, if the parameters(αi,j,αi,jx,αi,jy)and(βk,j,γk,j)in their definitions are constructed as follows.1.For each vertexViin Δ, the parameters(αi,j,αi,jx,αi,jy),j=1,2,3, are determined by the relation(3.18), given a PS3-triangleti(Qi,1v,Qi,2v,Qi,3v)that contains all the corresponding PS3-points, i.e., the Bézier domain points in the diskD1(Vi)inΔPS.For each edgeεkin Δ, the parameters(βk,j,γk,j),j=1,2, are given by(3.8).There are many triangles that contain all PS3-points. An appropriate choice for such triangles, as suggested by Dierckx (1997) and Speleers (2010b), is to calculate triangles of minimal area, the so-called optimal triangles. In Fig. 5we illustrate the PS3-points (black bullets) and a set of optimal PS3-triangles (red triangles) for a triangulation taken from Dierckx et al. (1992). Note that such PS3-triangles are much smaller than the ones needed for quadratic Powell–Sabin B-splines and for reduced Clough–Tocher B-splines; we refer to Speleers (2010b, Fig. 5 and Fig. 6) for a comparison on the same triangulation.Given the position of the pointsQi,jv, the triplets(αi,j,αi,jx,αi,jy)can be computed as follows. Referring to (2.1) and (3.18), the values(αi,1,αi,2,αi,3)can be interpreted as the barycentric coordinates of the vertexViwith respect toti(Qi,1v,Qi,2v,Qi,3v). From (3.18) we obtain thatαi,1x=Yi,2−Yi,3F,αi,2x=Yi,3−Yi,1F,αi,3x=Yi,1−Yi,2F,αi,1y=Xi,3−Xi,2F,αi,2y=Xi,1−Xi,3F,αi,3y=Xi,2−Xi,1F,withF=|Xi,1Yi,11Xi,2Yi,21Xi,3Yi,31|.The triplets(αi,1x,αi,2x,αi,3x)and(αi,1y,αi,2y,αi,3y)can be seen as the barycentric coordinates of the x- and y-direction with respect toti.Finally, we provide an expression for the pointsQk,je,j=1,2, related to the edgesεk,k=1,…,ne. By exploiting the Bernstein–Bézier representation of the B-splines and the parameter choices in (3.8), we deduce thatQk,1e=12(23V1+13Z)+12(23V2+13Z)=13(V1+V2+Z),for an edgeεk=〈V1,V2〉belonging to the macro-triangleTwhich has the split point Z. A similar reasoning can be used forQk,2e, and we arrive at the following expressions.1.Ifεk=〈V1,V2〉is a boundary edge, having the split pointRkand belonging to the macro-triangleTwhich has the split point Z:(3.20a)Qk,1e=13(V1+V2+Z),andQk,2e=13(V1+V2+Rk).Ifεk=〈V1,V2〉is an interior edge, shared between the two macro-trianglesTandT˜having the split points Z andZ˜, respectively:(3.20b)Qk,1e=13(V1+V2+Z),andQk,2e=13(V1+V2+Z˜).In this section we describe how to define control points and we provide a stable computation of the Bézier ordinates of a spline in the form (3.1). We assume that we are dealing with B-splines that are constructed as in Theorem 3.Referring to the PS3-spline representation (3.1) and the definition of the pointsQi,jvandQk,jein (3.15), we may define control points as(4.1)ci,jv=(Xi,jv,Yi,jv,ci,jv),j=1,2,3,andck,je=(Xk,je,Yk,je,ck,je),j=1,2,fori=1,…,nvandk=1,…,ne. We recall that the pointsQi,jvform the vertices of the PS3-triangles, whereas the expressions of the pointsQk,jeare given in (3.20). Since the PS3-spline basis forms a convex partition of unity, it follows that the graph of a spline in the form (3.1) lies inside the convex hull of the control points (4.1). The first set of control points can be considered as vertices of the trianglesTi(ci,1v,ci,2v,ci,3v),i=1,…,nv, which are called control triangles; the second set as vertices of the line segmentsLk(ck,1e,ck,2e),k=1,…,ne, which are called control lines.From the definition of the B-splines we know that(4.2a)s(Vi)=αi,1ci,1v+αi,2ci,2v+αi,3ci,3v,(4.2b)∂s∂x(Vi)=αi,1xci,1v+αi,2xci,2v+αi,3xci,3v,(4.2c)∂s∂y(Vi)=αi,1yci,1v+αi,2yci,2v+αi,3yci,3v.Inverting the system (4.2), and using (3.18), we find after some elementary calculations thatci,1v=s(Vi)+(Xi,1v−xi)∂s∂x(Vi)+(Yi,1v−yi)∂s∂y(Vi),ci,2v=s(Vi)+(Xi,2v−xi)∂s∂x(Vi)+(Yi,2v−yi)∂s∂y(Vi),ci,3v=s(Vi)+(Xi,3v−xi)∂s∂x(Vi)+(Yi,3v−yi)∂s∂y(Vi).It follows that the three control pointsci,jv,j=1,2,3, belong to the plane tangent to the spline surfacez=s(x,y)at vertexVi. Thus, the control triangleTiis tangent to the spline surface atVi. There is no similar tangent property for the control lines.The Bézier ordinates of a PS3-spline in the form (3.1) can be computed in a stable way from its B-spline coefficientsci,jvandck,je. We illustrate this procedure on the macro-triangleT(V1,V2,V3)shown in Fig. 2(left), and the corresponding Bézier ordinates are depicted in Fig. 6. The barycentric coordinates of the points in the macro-triangle are given in (3.2).By combining the formulas (3.9) and (4.2), we derive that the Bézier ordinates in the diskD1(V1)only depend on the three coefficientsc1,jvwithj=1,2,3:(4.3)d1=α1,1c1,1v+α1,2c1,2v+α1,3c1,3v,d2=σ3,1c1,1v+σ3,2c1,2v+σ3,3c1,3v,d3=σ1,1c1,1v+σ1,2c1,2v+σ1,3c1,3v,d4=σ2,1c1,1v+σ2,2c1,2v+σ2,3c1,3v,where(α1,1,α1,2,α1,3),(σ1,1,σ1,2,σ1,3),(σ2,1,σ2,2,σ2,3)and(σ3,1,σ3,2,σ3,3)are the barycentric coordinates of the PS3-pointsV1,S1,S2andS3, respectively, with respect to the PS3-trianglet1(Q1,1v,Q1,2v,Q1,3v), see (3.19). The expressions in (4.3) are convex combinations since the PS3-points are required to be inside the PS3-triangle. In a similar way we can compute(d5,d6,d7,d8)and(d9,d10,d11,d12)from the B-spline coefficientsc2,jvandc3,jv, respectively.The values of the Bézier ordinatesd13,d14,d15are computed from theC2-smoothness conditions of the PS3-spline across the edge〈Z,R3〉. As we have already mentioned before, they can be regarded as ordinates after subdivision of a single (univariate) quadratic polynomialp2defined on the edge segment〈P1,P2〉, see (3.3). This quadratic polynomialp2has the valuesd2,β,d8as its three Bézier ordinates, where the value of β depends on the type of the edgeε3.1.Ifεk(k=3) is a boundary edge, then(4.4a)β=ck,2e,following the B-spline ordering as in (3.8a).Ifεk(k=3) is an interior edge, then(4.4b)β=‖Rk−Z˜‖‖Z−Z˜‖ck,1e+‖Z−Rk‖‖Z−Z˜‖ck,2e,following the same notation as in (3.8b).Finally, the Bézier ordinatesd22,…,d37can be computed by exploiting theC2-smoothness at the split point Z. They can be regarded as ordinates after subdivision of a single (bivariate) quadratic polynomialpˆ2defined on the triangle spanned by the pointsPˆ1=23V1+13Z,Pˆ2=23V2+13Z,Pˆ3=23V3+13Z.The Bézier ordinates of this quadratic polynomialpˆ2are given byb200=d3,b020=d7,b002=d11,b110=c3,1e,b011=c1,1e,b101=c2,1e.This results in(4.6)d31=z1d3+z2c3,1e+z3c2,1e,d33=z1c3,1e+z2d7+z3c1,1e,d35=z1c2,1e+z2c1,1e+z3d11,d37=z1d31+z2d33+z3d35,and(4.7)d22=λ12d3+λ21c3,1e,d24=λ12c3,1e+λ21d7,d23=λ12d22+λ21d24,d32=λ12d31+λ21d33,and similar expressions for the remaining ordinates.Only convex combinations are needed in the above computation of all Bézier ordinates of the PS3-spline in the form (3.1) starting from its spline coefficients. Evaluation or differentiation of the PS3-spline within each of the six subtriangles can then further be performed using the de Casteljau algorithm (see, e.g., Farin, 1986; Lai and Schumaker, 2007). This gives us a stable procedure to manipulate PS3-splines in its normalized B-spline representation.More generally, if we apply the convex combinations (4.3), (4.5), (4.6) and (4.7) to the control points defined in (4.1), then we get directly the Bézier control points of the PS3-spline surface.Fig. 7(left) shows a PS3-spline surface obtained as a discrete least-squares fit to the functionf(x,y)=(exp⁡((x−0.52)2+(y−0.48)2)−0.95)−1on the domainΩ=[−1,1]×[−1,1]. The spline has been defined on the triangulation given in Fig. 5, and its Bézier control net is depicted in Fig. 7(right).In this section we provide some strategies to reduce the number of degrees of freedom in the PS3-spline space, i.e.,3nv+2ne. First, we describe the relation with the reduced Clough–Tocher (RCT3-) spline space considered by Speleers (2010b). Then, we provide a condensation strategy that maintains the full approximation order.In Theorem 2 we have shown that the CT3-spline space is a subspace of the PS3-spline space. In particular, the RCT3-spline space considered by Speleers (2010b) is a subspace, so we can represent all its elements in terms of the PS3-spline basis. In this subsection we investigate how we can convert an RCT3-spline in its B-spline form into the PS3-spline form (3.1). We refer to Speleers (2010b) for more details on RCT3-splines and their properties.LetsRCTbe an RCT3-spline in its B-spline form defined on the meshΔCT, i.e.,(5.1)sRCT(x,y)=∑i=1nv∑j=13ci,jRCTBi,jRCT(x,y).For the conversion into the corresponding PS3-spline form, we assume that the partitionsΔCTandΔPSare compatible, so thatS31(ΔCT)⊂Sˆ31(ΔPS).First, we set the PS3-triangles identical to the RCT3-triangles (see Speleers, 2010b, for details). From their construction it is clear that RCT3-triangles are always valid PS3-triangles. Indeed, focusing on the macro-triangleT(V1,V2,V3)in Δ, the RCT3-triangle related to the vertexV1contains the pointsV1,(2V1+V2)/3and(2V1+V3)/3. Since both spline representations satisfy the same relations like (3.18) and (4.2), it follows that(5.2)ci,jv=ci,jRCT,i=1,…,nv,j=1,2,3.Let us now concentrate on the edgeεk=〈V1,V2〉of the macro-triangleT(V1,V2,V3). The RCT3-splinesRCTis a (single) cubic polynomial along this edge. Moreover, the directional derivative ofsRCTin a certain directionνk(not parallel toεk) is constrained to be a linear polynomial along the edgeεk, i.e.,(5.3)∂sRCT∂νk(Rk)=λ12∂sRCT∂νk(V1)+λ21∂sRCT∂νk(V2).These two constraints will determine the values of the coefficientsck,je,j=1,2.A PS3-spline is a (single) cubic polynomial along the edgeεkwhen we impose an additionalC3super-smoothness across the edge〈Z,Rk〉with Z the split point of the macro-triangleT. This is achieved when the parameter β, used in the construction of the Bernstein–Bézier representation of the PS3-spline (see (4.5)), satisfiesβ=λ12λ21(d2−λ12d1)+λ21λ12(d8−λ21d5),or, equivalently,(5.4)β=λ12(sRCT(V1)+‖V2−V1‖3∂sRCT∂εk(V1))+λ21(sRCT(V2)−‖V2−V1‖3∂sRCT∂εk(V2)).We now address the constraint (5.3). For the sake of simplicity of the presentation, we will focus on a particular case of interest (see Speleers, 2010b, Example 2.2), whereνk=Rk−Z‖Rk−Z‖.It has been explained by Speleers (2010b) that this choice is favorable because the B-spline construction involves a less restrictive geometric constraint on the CT-refined triangulation. With this choice, we have∂sRCT∂νk(Rk)=3(d14−d23)‖Rk−Z‖,∂sRCT∂νk(V1)=3(d2−d3)‖Rk−Z‖,∂sRCT∂νk(V2)=3(d8−d7)‖Rk−Z‖,using the same notation for the Bézier ordinates as in Section 4.2. The constraint (5.3) impliesd14−d23=λ12(d2−d3)+λ21(d8−d7).On the other hand, by the smoothness of the PS3-spline and by the relations (4.5)–(4.7), we getd14−d23=λ12(d13−d22)+λ21(d15−d24)d14−d23=λ12(λ12(d2−d3)+λ21(β−ck,1e))+λ21(λ12(β−ck,1e)+λ21(d8−d7))d14−d23=λ122(d2−d3)+2λ12λ21(β−ck,1e)+λ212(d8−d7).Taking into account thatλ21=1−λ12, we obtainβ−ck,1e=12((d2−d3)+(d8−d7))=‖Rk−Z‖6(∂sRCT∂νk(V1)+∂sRCT∂νk(V2)).Hence,(5.5)ck,1e=β−‖Rk−Z‖3βν,withβν=12(∂sRCT∂νk(V1)+∂sRCT∂νk(V2)).From the definition of β in (4.4) we can compute the value ofck,2e, which depends on the type of the edgeεk.1.Ifεkis a boundary edge, then(5.6a)ck,2e=β.Ifεkis an interior edge, then(5.6b)ck,2e=‖Z−Z˜‖‖Z−Rk‖β−‖Rk−Z˜‖‖Z−Rk‖ck,1e=β+‖Rk−Z˜‖3βν.The coefficients in (5.2) and (5.5)–(5.6) with β given in (5.4) constitute the PS3-spline representation (3.1) of the RCT3-splinesRCTin (5.1).In the previous subsection we have detailed a strategy to reduce the number of degrees of freedom to3nv. Indeed, by choosing the edge coefficientsck,jeas in (5.5)–(5.6) with β given in (5.4), we only keep the vertex coefficientsci,jvas degrees of freedom. Unfortunately, it is known that this choice has a negative impact on the approximation order (the order is decreased by one).We now discuss how we can reduce the number of degrees of freedom, while maintaining the full approximation order. Instead of the RCT3-spline space, we could consider the (complete) CT3-spline space. We have seen in Theorem 2 that the CT3-spline space is also a subspace of the PS3-spline space. This subspace has optimal approximation order, while its dimension is smaller, namely3nv+ne. A CT3-spline is obtained by imposing an additionalC3super-smoothness along each edge in Δ. From Section 5.1 we know that this is achieved by requiring the condition (5.4) for each edgeek,k=1,…,ne.Alternatively, inspired by Kashyap (1996) and Mann (1999), the edge coefficients could be determined from the vertex coefficients by means of the following local two-step strategy, in caseekis an interior edge of Δ.1.Use the Hermite data at the vertices (provided by the vertex coefficientsci,jv, see (4.2)) of the two triangles sharing the edgeekto compute a cubic polynomial by least-squares fitting (or any other approximation method with cubic precision).Compute the coefficientsck,jerelated to the edgeekbased on this cubic polynomial such that the resulting spline has cubic precision.In this paper we have presented a newC1cubic spline space defined over a triangulation endowed with a PS-refinement. Thanks to the locally imposedC2super-smoothness, the proposed PS3-spline space has a simple dimension formula, namely3nv+2ne, and the space is a close extension of the classical CT3-spline space. In addition, we have constructed a normalized B-spline basis for this space. The basis functions have a local support, they are nonnegative, and they form a partition of unity. We have also described how to compute from the control points of a PS3-spline its corresponding Bézier control net in a stable way.In the literature one finds few other normalized B-spline representations forC1cubic splines on triangulations with a macro-structure. For example, such a representation exists for RCT3-splines (Speleers, 2010b) and for cubic PS-splines with a different super-smoothness (Lamnii et al., 2014). For the sake of convenience, the latter splines will be referred to as PS3✠-splines in the following. The proposed new cubic B-spline representation has some favorable properties with respect to the other ones.•The full space of cubic polynomials belongs to the PS3-spline space. This is also the case for the PS3✠-spline space, whereas the RCT3-spline space only contains the full space of quadratic polynomials. This implies that PS3-splines and PS3✠-splines possess full approximation power but RCT3-splines do not.CT3-splines (and RCT3-splines) are in the PS3-spline space (on condition that the partitions are compatible, see Theorem 2), so they can be represented in the PS3-spline form (3.1). This is not the case for the PS3✠-spline space.The PS3 Hermite interpolation problem (see Theorem 1) only involves first derivatives, and not second derivatives like in the PS3✠-spline case. The use of higher order derivatives is not so appealing in approximation. In addition, it might simplify the construction of quasi-interpolation schemes (see, e.g., Lamnii et al., 2014; Sbibih et al., 2014; Speleers, 2015).The construction of the PS3-spline basis involves the use of PS3-triangles. These triangles are required to contain a specific set of PS3-points (see Theorem 3). Because this constraint is less restrictive, the PS3-triangles can be chosen smaller than the corresponding triangles for RCT3-splines and PS3✠-splines. This implies that the PS3 control points will be closer to the PS3-spline surface.We now make a comparison with the spacesS31(ΔCT)andS31(ΔPS), defined in (2.5) and (2.6), respectively, and we give an outlook on the construction of a normalized B-spline basis for them.•The spaceS31(ΔPS)is an extension of the PS3-spline space, so it shares the full approximation power but it has a larger dimension, namely3nv+4ne. A normalized B-spline basis can be constructed for this space by adopting the techniques from Dierckx (1997) and Speleers (2010a, 2013a).The spaceS31(ΔCT)is contained in the PS3-spline space (see one of the previous items). It is known that it has full approximation power, but it is not clear whether a normalized B-spline basis can be constructed or not for this space in general. Since its dimension is3nv+ne, it is natural to associate three basis functions with each vertex and one basis function with each edge. For the construction of the vertex basis functions, one could follow the approach from Speleers (2010b) for RCT3-splines. It seems impossible, however, to construct a nonnegative basis function related to an interior edge with support on two macro-triangles (the triangles adjacent to the edge). This would imply that possible edge basis functions must have larger support.Finally, in Section 5, we have provided some strategies to reduce the number of degrees of freedom in the PS3-spline space. In particular, we have shown that we can easily convert an RCT3-spline in its B-spline form (5.1) into the PS3-spline form (3.1). Note that only the condition (5.4) is required to obtain a general CT3-spline in the PS3-spline form.

@&#CONCLUSIONS@&#
