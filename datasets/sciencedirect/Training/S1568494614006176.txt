@&#MAIN-TITLE@&#
Implementation of adaptive fuzzy logic and PI controllers to regulate the DC bus voltage of shunt active power filter

@&#HIGHLIGHTS@&#
The output gain of the adaptive fuzzy controller (AFC), it is considerate as a fuzzy variable.This gain is adapted as a function of the voltage error and its variation.The comparative at PI controller study, shows that the adaptive fuzzy controller can be enhance the performances the DC voltage control at various operating.Experimental results validate the design methodology.

@&#KEYPHRASES@&#
Shunt active power filter,Total harmonic distortion,Adaptive fuzzy controller,Self tuning filter,Proportional integral controller,

@&#ABSTRACT@&#
Active power filter (APF) performance is entirely dependent on capacitor voltage. DC voltage optimization is one of the key aspects in harmonics compensation. This paper presents an experimental comparative study of new adaptive fuzzy controller (AFC) and proportional integral (PI) regulator, applied to regulate the DC bus voltage of three phase shunt APF. The proposed AFC for APF, consist to adapt the output gain of this controller at every situation of the system as a function of the voltage error and its variation. The algorithm used to identify the reference currents is based on the Self Tuning Filter (STF). The firing pulses of the insulated-gate bipolar transistors (IGBTs) inverter are generated using a hysteresis current controller; which is implemented on an analog card. Finally, the above study, under steady state and transient conditions, is illustrated with signal-flow graphs and corresponding analysis. This study was verified by experimental tests on hardware prototype based on dSPACE-1104.

@&#INTRODUCTION@&#
In recent years with the development of power semiconductor technology power electronics based devices such as static voltage ampere reactive compensators, adjustable speed drives and uninterruptible power supplies are widely employed in various applications. Because of their nonlinear V–I characteristics, these devices draw current with harmonic content and reactive power from AC mains. Current harmonic drawn by nonlinear loads disturb the waveform of the voltage at the point of common coupling (PCC) and lead to voltage harmonics.So, it is necessary to develop techniques to reduce all the harmonics as it is recommended in the IEEE 519-1992 standard [1]. The first approach consists in the design of LC filters. But, passive filters are not well adapted as they do not take into account the time variation of the loads and the network. They can also lead to resonance phenomena [1,2]. So, since several years, a more interesting technique is studied: the active filter based either on voltage source or on currents source inverters yielding the harmonic currents needed by the load. However, their control needs to use automatic control theory to improve their efficiency [3,4].The identification approach is based on the phase locked loop (PLL) [5], which is not sensitive to the disturbances, specifically to the harmonic and unbalanced voltage. Moreover, the STF is proposed for extracting harmonic currents instead of classical harmonics extraction based on high pass or low pass filters [6,7]. But it is difficult to account the variation of the system parameters. Variation of system parameters and large signal transients, such as those produced in the startup cannot be dealt with these controllers. A control technique suitable for converters must cope with their intrinsic nonlinearity and load variations, ensuring stability in any operating condition.Fuzzy control technique has been successfully applied to the control of motor drives in recent years [8,9] and active power filter [10–13]. This strategy was proposed by Zadeh in 1965 to describe complicated systems which are hard to analyze using traditional mathematics, it is only since the 1970s that fuzzy logic theory has found wide popularity in various applications such as economics, management, medicine, or process control. Indeed, Mamdani et al. were the first to report on the application of fuzzy set theory to control a small laboratory steam engine.The results of these experiments showed that fuzzy controllers perform better, or at least well as, adaptive controllers. Moreover, this technique offers the advantage of requiring only a simple mathematical model to formulate the algorithm, which can easily be implemented by a digital computer. These features are appreciated for nonlinear processes for which there is no reliable model and complex systems where the model is useless due to the large number of equations involved. Nevertheless, the main problem with fuzzy logic is that there is no systematic procedure for the design of fuzzy controller.The superiority of fuzzy controller, it can adapt his structure, acting on number of factors which constitute the internal configuration of this type of controller, such as: fuzzification blocks [14,15], fuzzy rules [16,17], block defuzzification and input and output gains. Additionally, it possible to use the fuzzy logic to adjusted or supervised the parameters of traditional PI regulator [18], non-linear controller [19] and neural network algorithms [20].The capacitor that feeds the active filter plays the role of a voltage source. This tension must be kept constant, so as not to degrade the filter performance, and not to exceed the voltage of semiconductors. The main cause of the variation of this voltage is the change in the pollutant load, which creates an active power exchange with the network. The regulation of this voltage is necessary to keep its value constant, and to limit the fluctuations of this voltage. The control of the DC bus voltage of the shunt active power filter was shown in several studies and with different regulators [8,15,18,20,21,25,26].In this paper, first the circuit configuration of the APF system is presented. Second, the control strategy is developed according to the circuit configuration. After this, the AFC and PI design are presented taking in consideration the stability conditions. Finally, detailed experimental results of the developed APF with comparative study of AFC and PI controller are given and discussed to demonstrate their ability for control of the DC bus voltage, harmonic elimination and reactive power compensation.The proposed system configuration of an APF is shown in Fig. 1.Three-phase voltage source inverter using IGBT switches connected in parallel with the AC three-phase three-wire system through three inductors LF. The capacitor Cdcis used as energy source. The capacitor is initially charged through the diodes of the inverter. The nonlinear load consists of a three-phase diode bridge rectifier feeding an RLdc–LLdcload. This load generates harmonic currents in the supply system. The proposed control strategy can be divided in three parts. The first part is the harmonic isolator (reference current generation). It consists in generating the harmonic current references using the STF [6,7]. The identification method of harmonics used is the method of Synchronous reference frame [7,29]. This harmonic isolator will be implemented into a dSPACE system in the experimental. The second part is the current control of the power converter. The control generates the suited switching pattern to drive the IGBTs of the inverter using a hysteresis current controller. In the experimental study, the hysteresis controller is implemented on an analog card. Finally The DC capacitor voltage is regulated using the AFC.The quality of the compensation of current harmonics depends heavily on the performance of the identification method chosen. Indeed, a control system, even very effective, cannot alone make a good filter if the harmonic currents are poorly identified. For this reason, many identification methods have been developed in the literature. There are many control algorithms available for the generation of reference source currents for the control of proposed active power filter in the literature, synchronous reference frame theory, instantaneous reactive power theory (p–q theory), power balance theory [7,27–29]. The synchronous reference frame theory is found suitable for the control of voltage-source converter (VSC). A block diagram of the controlling algorithm is shown in Fig. 2.The feedback signals are sensed from the load currents, AC source voltages and DC bus voltages of APF. The three phase currents iLa, iLband iLcare transformed from three phase (a–b–c) reference frame to two phase's (α−β) stationary reference frame currents iαand iβusing:(1)iαiβ=231−12−12032−32iLaiLbiLcThe instantaneous current can be written as the sum of a fundamental component and an alternative component:(2)iα=iˆα+i˜αiβ=iˆβ+i˜βThen, the STF extracts the fundamental components at the pulsation ωcdirectly from the currents in the α–β axis. Then, the α–β harmonic components of the load currents are computed by subtracting the STF input signals from the corresponding outputs (see Fig. 3). The resulting signals are the AC components, ĩαand ĩβ, which correspond to the harmonic components of the load currents iLa, iLband iLcin the stationary reference frame. Using a PLL, we can generate cos(θ) and sin(θ) from the phase voltage source Vsa, Vsband Vsc. The currents expression ĩαand ĩβin d–q reference frame are given by:(3)i˜di˜q=sin(θ)−cos(θ)cos(θ)sin(θ)i˜αi˜βThe expression of the reference currentiα*andiβ*is given by:(4)i˜αi˜β=sin(θ)cos(θ)−cos(θ)sin(θ)i˜d+I*i˜qThe reference currents in the (a–b–c) frame are given by:(5)iFa*iFb*iFc*=2310−12−1232−32iα*iβ*These digital references are the outputs of the dSPACE system and are converted into analog signals by digital-to-analog converters. By using an analog card, the switching patterns for the inverter are generated by implementing the analog hysteresis current controller and comparing the measured active filter currents iFa, iFband iFcwith these dSPACE references. The STF in Fig. 3 is used in the harmonic isolator instead of classical extraction filters [6,7]. Hong-sock Song in [6] had presented that the integration in the synchronous reference frame is defined by:(6)Vxy(t)=ejωt∫e−jωtUxy(t)dtEq. (6) can be expressed by the following transfer function, after Laplace transformation:(7)H(s)=Vxy(s)Uxy(s)=s+jωs2+ω2We think of introducing a constant K in the transfer function H(s), to obtain a STF with a cut-off frequency ωc. So, the previous transfer function becomes:(8)H(s)=Vxy(s)Uxy(s)=K(s+K)+jωc(s+K)2+ωc2By replacing the input Vxy(s) by iαβ(s) and the output Uxy(s) by îαβ(s), the following expressions can be obtained:(9)i⌢α(s)=K(s+K)(s+K)2+ωc2iα(s)−Kωc(s+K)2+ωc2iβ(s)(10)i⌢β(s)=Kωc(s+K)2+ωc2iα(s)+K(s+K)(s+K)2+ωc2iβ(s)Eqs. (9) and (10) can be expressed as follows:(11)i⌢α(s)=Ks[iα(s)−i⌢α(s)]−ωcsi⌢β(s)(12)i⌢β(s)=Ks[iβ(s)−i⌢β(s)]+ωcsi⌢α(s)The finality of the AFC is a command to control the output currents of the APF in order to nearest they follow their references. The principle of this lawsuit is based on the comparison between the current generated by the APF and the reference current in order to deduce the control orders power switches. Hysteresis-band instantaneous current control PWM technique is popularly used because of its simplicity of implementation, fast current control response and inherent peak current limiting capability. This type of nonlinear control uses the error signal between the reference current and the current produced by the APF. The error is compared to a template called hysteresis band. Once the error reaches the upper or lower band, a new control command is sent to the semiconductor so as to maintain the actual current within the strip. The only parameter intervening in regulating is the width of the hysteresis band. It determines, on the one hand the average switching frequency and on the other the error on the currents generated. The hysteresis current control is simple to implement and gives good results in regulation because neither static error nor following error. The control is robust with respect to system parameters and exhibits good dynamic transient.The proposed system configuration is shown in Fig. 4. The AFC is related to voltage loop, whose inputs are the error voltage and its variation. The output of the AFC is reference current. The proposed control system shown in Fig. 4, it is composed by four stages: fuzzification, rules execution, defuzzification (classical fuzzy control) and adaptation mechanism of the output gain.The rule base is the principal component of the fuzzy controller; it indicates how the controller behaves to response to any input situation. The rule base is constituted by collection of If-Then rules of the form:(13)Rj:Ife1(k)isAjandΔe1(k)isBjThenIref(k)isCj,j=1…mwhere Aj, Bj and Cj are fuzzy sets such as: NL (negative large), NM (negative medium), etc. defining fuzzy partition on the controller input space (Fig. 5), and e1(k) and Δe1(k) are scaled and normalized version of the error e(k) and the change of error Δe(k) given by:(14)e1(k)=ge⋅e(k)Δe1(k)=gce⋅Δe(k)where(15)e(k)=Vcd*(k)−Vcd(k)Δe(k)=ev(k)−ev(k−1)With ge and gce, constant inputs gain which play an essential role, since they determine the control performances. The expression “e1(k) is Aj” is implemented by membership function indicating the grade of membership of e1(k) in the fuzzy set Aj as in Fig. 5, this operation is called fuzzification. The shape of the membership function is quite arbitrary and depends on the user's preference. For simplicity, triangular and trapezoidal shapes are usually used. The logical operators “and” and “Then” can be interpreted as min or algebraic product, and various inference and defuzzification algorithms can be used to produce crisp output value. If the operators “and” and “Then” are implemented as algebraic product, the max-product inference and the center of gravity defuzzification methods are adopted in this paper.In most fuzzy control studies [9,13,22], the gain associated with the control output must be constant and as low possible in order to avoid the instability problem. This increases considerably the response time of the system. To solve this problem, the output gain, it is considerate as a fuzzy variable (Fig. 6).Therefore, the gain must be adapted at every situation of the system as a function of the error and its variation. To improve the fuzzy decision table we associate, for each fuzzy set of the control, the fuzzy set gain, similar, but always strictly positive (Table 1).The fuzzy sets of variable gain whose corresponding membership functions are represented by Fig. 6. The decision matrix on the control of the output gain is given in Table 2.Fig. 7shows the block diagram of the proposed PI control scheme for the APF. The DC side capacitor voltage is sensed and compared with a reference voltage. This errore=Vdc*−Vdcat the nth sampling instant is used as input for PI controller. Its transfer function is represented by Eq. (16), where kPis the proportional constant that determines the dynamic response of the DC-side voltage control and kIis the integration constant that determines it is settling time. The proportional integral controller is eliminating steady state error in the DC-side voltage.(16)HPI(s)=kP+kIsThe PI controller for the DC-link voltage sets the amplitude of the active current of the APF inverter to regulate the DC-link voltage based on its reference value covering the inverter losses [4,5,23,24]. Subtracting the measured load current, the reference value of the APF current is obtained. The DC-link capacitor will be charged or discharged by the difference of the active load current and grid current, forcing the PI controller to change its output correspondingly, until both active currents are equal. In this way, the APF will compensate all non active components of the load current and regulate the DC-link voltage of the APF. Hence, kP=2·ξ·ωn·Cdcand kI=Cdc·ωn2, for ξ=0.707 and Cdc=1100×10−6F, kPand kIcan be determined, where ωnis natural frequency and ξ is damping coefficient.

@&#CONCLUSIONS@&#
