@&#MAIN-TITLE@&#
Lifted Euclidean inequalities for the integer single node flow set with upper bounds

@&#HIGHLIGHTS@&#
We introduce the family of lifted Euclidean inequalities for an integer single node flow setWe provide a polyhedral description of the convex hull of the feasible setWe test the effectiveness of these inequalities in three mixed integer problems

@&#KEYPHRASES@&#
Valid inequalities,Mixed integer programming,Polyhedral description,Single node flow set,

@&#ABSTRACT@&#
In this paper we discuss the polyhedral structure of the integer single node flow set with two possible values for the upper bounds on the arc flows. Such mixed integer sets arise as substructures in complex mixed integer programs for real application problems.This work builds on results for the integer single node flow polytope with two arcs given by Agra and Constantino, 2006a. Valid inequalities are extended to a new family, the lifted Euclidean inequalities, and a complete description of the convex hull is given. All the coefficients of the facet-defining inequalities can be computed in polynomial time.We report on some computational experimentations for three problems: an inventory distribution problem, a facility location problem and a multi-item production planning model.

@&#INTRODUCTION@&#
The description of the convex hull of elementary mixed integer sets has been useful in the generation of strong valid inequalities for general mixed integer problems. Particular cases of such elementary sets are the Single Node Flow (SNF) sets (see Fig. 1):{(y,x)∈Z+∣N∣×R∣N∣:∑t∈Nxt≤(=)(≥)D,ℓtyt≤xt≤utyt,t∈N}.These sets are very common structures that occur after the aggregation of variables and/or constraints of more complex fixed charge capacitated network flow sets.The single node flow sets have been studied for more than three decades. Padberg, Roy, and Wolsey (1985) studied the case where the yiare binary and the ℓjare null. They introduced the so called flow cover inequalities and showed this class of valid inequalities suffices to describe the convex hull of the feasible set whenuj=U,∀j∈N. The binary case was also studied in Goemans (1985). Roy and Wolsey (1986) derived the so called generalized flow cover inequalities and Stallaert (1997) introduced a new class of valid inequalities by complementing binary variables. For a survey on valid inequalities for this and other related sets from the perspective of lifting see Louveaux & Wolsey, 2003. Special cases where considered by several authors. Constantino (1998) describes the convex hull of several related regions, in particular, the integer single node flow set with U a large positive constant, U > D. Agra and Constantino (2006b) provide a polyhedral characterization whenℓj=Landuj=Ufor all j. In Agra and Doostmohammadi (2013) several inequalities are extended for the case where there is a set-up variable associated to the node itself.In this paper we describe the convex hull of the integer SNF set with two possible values for the upper bounds on each arc capacity:X={(y,x)∈Z+∣N∣×R∣N∣:∑t∈Nxt≤D,0≤xt≤a1yt,t∈N1,0≤xt≤a2yt,t∈N2},where {N1, N2} define a partition of N. We assume that the coefficients a1, a2 and D are positive integers and D > max {a1, a2}. While in the classical SNF set the y variables are binary, here they are assumed to be integer. SetXarises as relaxation of several fixed charge capacitated network flow sets when arc capacities may assume one of the two possible values. See Section 4for several applications.The description ofP=conv(X)by linear inequalities is obtained from the description of integer single node flow set involving only two arcs,Z={(y1,y2,x1,x2):x1+x2≤D,0≤x1≤a1y1,0≤x2≤a2y2,y1,y2integer},given in Agra and Constantino (2006a). It has similarities with the description of the convex hull of the integer single node flow set with constant lower and upper bounds (Agra & Constantino, 2006b).In Section 2 we summarize the results concerned with the description of the SNF problem with two arcs and, in Section 3 we introduce the lifted Euclidean inequalities to generalize those results for the SNF problem with two possible values for the upper bounds. Then, in Section 4 we test the inclusion of those inequalities in a branch and cut scheme to solve three mixed integer programs: an inventory-distribution problem, a facility location problem, and a lot-sizing multi-item problem.The results in this section were published in Agra and Constantino (2006a).First we consider the single node flow set with one arc,{(y,x)∈Z+×R+:x≤D,x≤ay}.The convex hull of this set is completely described by the inequalities x ≥ 0, x ≤ ay, x ≤ D, andx−γy≤(a−γ)⌊D/a⌋,whereγ=D−a⌊D/a⌋.The last inequality is the so-called Mixed Integer Rounding inequality (Nemhauser & Wolsey, 1988).Next we consider the set with two arcs,Z.It is important to notice that there are only two integer variables involved in this model and so, for this particular structure, all the information needed to describeconv(Z)can also be obtained from the 2-integer knapsack sets that result from the elimination of the continuous variables.All the extreme points ofconv(Z)lie in the intersection of two of the following three hyperplanes defined byx1=a1y1,x2=a2y2andx1+x2=D.Thus, every extreme point ofconv(Z)has to satisfy one of the following set of conditions: (i)x1=a1y1,x2=a2y2,(ii)x2=a2y2,x1=D−x2,(iii)x1=a1y1,x2=D−x1,In case (i) we have(y1,y2)∈Y≤whereY≤={(y1,y2)∈Z+2:a1y1+a2y2≤D}.In case (ii), noticing that 0 ≤ x1 ≤ a1y1 imply0≤D−a2y2≤a1y1,we have(y1,y2)∈Y1whereY1={(y1,y2)∈Z+2:a1y1+a2y2≥D,y2≤D/a2}.Note that constraint y2 ≤ D/a2 is implied by the non-negativity constraint x1 ≥ 0. Similarly, in case (iii) we have(y1,y2)∈Y2whereY2={(y1,y2)∈Z+2:a1y1+a2y2≥D,y1≤D/a1}.Let us defineY1>=Y1∖Y=andY2>=Y2∖Y=whereY=={(y1,y2)∈Z+2:a1y1+a2y2=D}.In Agra and Constantino (2006a) it is shown that all the coefficients involved in the computation of the extreme points and facets of the two dimensional polyhedraconv(Y≤),conv(Y1),conv(Y2)can be obtained inO(log(D/min{a1,a2}))elementary operations using a version of the Hirschberg and Wong’s algorithm, (Hirschberg & Wong, 1976). This algorithm is based on the Euclidean Algorithm. Hence, the inequalities we describe next, and are based on these two dimensional polyhedra, are referred to as Euclidean inequalities.First we consider the valid inequalities obtained from the lifting of facet-defining inequalities forconv(Y≤)(corresponding to case (i)).Proposition 2.1Ifα1y1+α2y2≤αis a valid facet-defining inequality forconv(Y≤)then the inequality(2.1)β1(x1−a1y1)+β2(x2−a2y2)+α1y1+α2y2≤αis a valid facet-defining inequality forconv(Z),whereβ1=max{α1y1+α2y2−αa1y1+a2y2−D:(y1,y2)∈Y1>}andβ2=max{α1y1+α2y2−αa1y1+a2y2−D:(y1,y2)∈Y2>}.Next, from the lifting of the facet defining inequalities ofconv(Y1)the following family of valid inequalities forconv(Z)is obtained.Proposition 2.2Ifα1y1+α2y2≥αis a valid facet-defining inequality forconv(Y1)containing only points inY1>then the inequality(2.2)α1y1+α2y2≥α+β1(x1+x2−D)+β2(x2−a2y2)is a valid facet-defining inequality forconv(Z),whereβ1=max{α−α1y1−α2y2D−a1y1−a2y2:(y1,y2)∈Y<}andβ2=max{α−α1y1−α2y2a1y1+a2y2−D:(y1,y2)∈Y2>}.Finally we consider the lifting of the facet defining inequalities ofconv(Y2).Proposition 2.3Ifα1y1+α2y2≥αis a valid facet-defining inequality forconv(Y2)containing only points inY2>the inequality(2.3)α1y1+α2y2≥α+β1(x1−a1y1)+β2(x1+x2−D)is a valid facet-defining inequality forconv(Z),whereβ1=max{α−α1y1−α2y2a1y1+a2y2−D:(y1,y2)∈Y1>}andβ2=max{α−α1y1−α2y2D−a1y1−a2y2:(y1,y2)∈Y<}.In Agra and Constantino (2006a) it is shown that the lifting coefficients β1 and β2 in each Euclidean inequality (2.1), (2.2), (2.3), can be obtained directly (in constant time) from the information required to derive the corresponding two-dimensional polyhedraconv(Y≤),conv(Y1),conv(Y2). So all the coefficients involved in the Euclidean inequalities can be obtained inO(log(D/min{a1,a2}))elementary operations.Now we consider two unbounded facet-defining inequalities that can be obtained by the MIR procedure.Proposition 2.4The inequality(2.4)xt−γtyt≤(at−γt)⌊D/at⌋whereγt=D−at⌊D/at⌋,and t ∈ {1, 2}, is valid forZ.(Agra and Constantino (2006a))conv(Z)is completely described by the trivial facet-defining inequalities and the families(2.1),(2.2),(2.3)and(2.4).Consider the set,Z={(x,y)∈R+2×Z+2:x1+x2≤1154,x1≤21y1,x2≤76y2}and the following restrictionsY≤={y∈Z+2:21y1+76y2≤1154},Y1={y∈Z+2:21y1+76y2≥1154,y2≤15},Y2={y∈Z+2:21y1+76y2≥1154,y1≤54}.The polyhedral description of these sets was given in Agra and Constantino (2006a).conv(Y≤)={y∈R+2:y1+3y2≤54,2y1+7y2≤109,5y1+18y2≤274,3y1+11y2≤166,y1+4y2≤60}.From Proposition 2.1 we obtain the following facet-defining Euclidean inequalities.y1+3y2+11(x1−21y1)+114(x2−76y2)≤542y1+7y2+11(x1−21y1)+16(x2−76y2)≤1095y1+18y2+11(x1−21y1)+13(x2−76y2)≤2743y1+11y2+12(x1−21y1)+12(x2−76y2)≤166y1+4y2+17(x1−21y1)+17(x2−76y2)≤60conv(Y1)={y∈R+2:8y1+29y2≥440,5y1+18y2≥274,2y1+7y2≥107}.Only2y1+7y2≥107defines a non-trivial facet that includes only points inY1>.Based on that inequality we obtain:2y1+7y2≥107+16(x1+x2−D)+0(x2−76y2).conv(Y2)={y∈R+2:y2≥1,y1+4y2≥56,3y1+11y2≥166,5y1+18y2≥274,2y1+7y2≥107,y1+y2≥16}.Based on these inequalities we derive the following set of facet-defining Euclidean inequalities forconv(Z):y2≥1+120(x1+x2−1154)+11(x1−21y1),y1+4y2≥56+17(x1+x2−1154)+11(x1−21y1),2y1+7y2≥107+16(x1+x2−1154)+0(x1−21y1),y1+y2≥16+114(x1+x2−1154)+0(x1−21y1).In this section we give a description ofP=conv(X)by linear inequalities.The following main result uses the fact that we are dealing with integer (not binary) variables. It establishes the link between sets with dimension determined by the number of different coefficients with sets in higher dimensions.Lemma 3.1Consider nonempty setsS1,…,Sk,with Si⊂ N1,i∈{1,…,k},andSi∩Sj=∅,for alli,j∈{1,…,k},such that i ≠ j. Consider nonempty setsSk+1,…,Sp,with Si⊂ N2,i∈{k+1,…,p},andSi∩Sj=∅,for alli,j∈{k+1,…,p},such that i ≠ j. Consider the setΣ{k,p}={(Y1,…,Yp,X1,…,Xp)∈Z+p×Rp:∑t=1pXt≤D,0≤Xt≤a1Yt,t∈{1,…,k},0≤Xt≤a2Yt,t∈{k+1,…,p}}.(i)The inequality(3.1)∑t=1pαt∑j∈Styj+∑t=1pβt∑j∈Stxj≤αis valid forXiff(3.2)∑t=1pαtYt+∑t=1pβtXt≤αis valid for Σ{k, p}.If (3.1) and (3.2) are valid forXand Σ{k, p}, respectively, then (3.1) defines a facet ofPiff (3.2) defines a facet of conv(Σ{k, p}).Since (i) can be easily checked, we only show (ii). We assume that (3.1) and (3.2) are valid forXand Σ{k, p}, respectively. Suppose (3.1) defines a facet,F,ofPand (3.2) does not define a facet of conv(Σ{k, p}). LetFabe the face of conv(Σ{k, p}) defined by (3.2). SinceFais not a facet of conv(Σ{k, p}) there must exist a valid inequality, which is not a multiple of (3.2) (observe that both polyhedra are full dimensional), for conv(Σ{k, p}),∑t=1pαt′Yt+∑t=1pβt′Xt≤α′satisfied as equation by every point inFa.Hence∑t=1pαt′∑j∈Styj+∑t=1pβt′∑j∈Stxj≤α′is not a multiple of (3.1), and, by (i), is valid forP.In order to obtain a contradiction, it suffices to prove that each point inFalso satisfies this inequality as equation. Suppose not, that is, there is(y′,x′)∈Fsatisfying∑t=1pαt′∑j∈Styj+∑t=1pβt′∑j∈Stxj<α′.Then a contradiction is obtained by considering the point(Y′,X′)=(∑j∈S1yj′,…,∑j∈Spyj′,∑j∈S1xj′,…,∑j∈Spxj′)that belongs toFaand verifies∑t=1pαt′Yt′+∑t=1pβt′Xt′<α′.Now, suppose (3.2) defines a facet of conv(Σ{k, p}) and letFbe the face defined by (3.1). Consider a generic facet forPdefined by(3.3)∑j∈Nμjyj+∑j∈Nνjxj≤πcontainingF.We will show that (3.3) is a multiple of (3.1).Since both polyhedra are full dimensional, the facet of conv(Σ{k, p}) defined by (3.2) must contain 2p affinely independent points,(Yj,Xj),j=1,…,2p.Construct 2p points inF,(y¯j,x¯j)as follows: For eachi∈{1,…,p},sety¯tj=Yijandx¯tj=Xijfort=ti=argmin{j∈Si}andy¯tj=x¯tj=0,otherwise.Consider the point(y¯1,x¯1),and for each t ∈ N∖S, withS=⋃i=1pSi,consider the point (yt, xt) belonging toF,where (yt, xt) coincides with(y¯1,x¯1)for all coordinates except foryit=1wheni=t.As(y¯1,x¯1)and (yt, xt), satisfy (3.3) as equation, it follows thatμt=0.Hence we haveμt=0,∀t∈N∖S.We assume(y¯1,x¯1)satisfies∑k∈Nx¯k1<D.Next, consider the point(y¯1,x¯1)and for each t ∈ N∖S, consider (y′t, x′t) belonging toFwhere (y′t, x′t) coincides with(y¯1,x¯1)for all coordinates except foryi′t=1,xi′t=ϵwheni=t,where t ∈ N∖S, and0<ϵ<min{a1,a2,D−∑j∈Nx¯j1}.As(y¯1,x¯1)and (y′t, x′t), satisfy (3.3) as equation, it follows thatνt=0,∀t∈N∖S.For eacht∈{1,…,p},consider two affinely independent points (Ya, Xa), (Yb, Xb) withYta>0,Ytb>0and assume that(Yta,Xta),(Ytb,Xtb)are affinely independent (observe that such two points must exist since (3.2) defines a facet). As before, define(y¯a,x¯a)and(y¯b,x¯b)as follows: for eachi∈{1,…,p},sety¯ta=Yiaandx¯ta=Xiafort=tiandy¯tj=x¯tj=0,otherwise. Similarly for(y¯b,x¯b).Now, for eachi∈{1,…,p},and each k ∈ Si∖{ti} we construct two points (y′a, x′a) and (y′b, x′b) inF,such thatyt′a=y¯ta,xt′a=x¯ta,for t ≠ tiand t ≠ k, andyti′a=xti′a=0andyk′a=y¯tia,xk′a=x¯tia.Point (y′b, x′b) is constructed similarly. Using these points we obtainμi=α¯t,νi=β¯t,∀i∈St,t∈{1,2}.Finally, since the 2p points inF,(y¯j,x¯j),are affinely independent (as all its non-null components coincide with the non-null components of the affinely independent points (Yj, Xj)), then we conclude that (3.3) must be a multiple of (3.1).□Lemma 3.1 states that from each facet defining inequality ofconv(Z)we obtain facet defining inequalities forP.Corollary 3.2The inequality(3.4)α1y1+α2y2+β1x1+β2x2≤αdefines a facet ofconv(Z)if and only if(3.5)α1∑j∈S1yj+α2∑j∈S2yj+β1∑j∈S1xj+β2∑j∈S2xj≤α.defines a facet forPfor all ∅ ≠ S1⊆N1, ∅ ≠ S2⊆N2.In this section we present the families of valid inequalities necessary for the description ofPthat cannot be obtained directly from the aggregated modelZ.The following family of valid inequalities is necessary when the equationa1Y1+a2Y2=Dhas no nonnegative integer solutions.Proposition 3.3Letγ=D−max{a1Y1+a2Y2:(Y1,Y2)∈Y≤},ϵ1=min{a1Y1+a2Y2:(Y1,Y2)∈Y1}−D,andϵ2=min{a1Y1+a2Y2:(Y1,Y2)∈Y2}−D.If γ > 0, then the following inequality is valid forX,(3.6)a1∑j∈S1yj+a2∑j∈S2yj+γ+ϵ1ϵ1∑j∈S1(xj−a1yj)+γ+ϵ2ϵ2∑j∈S2(xj−a2yj)+∑j∈N∖(S1∪S2)(xj−γyj)≤D−γwhere S1 ⊂ N1and S2 ⊂ N2.Observe that γ > 0 implies ϵ1 > 0 and ϵ2 > 0. Conversely, the two conditions ϵ1 > 0, ϵ2 > 0 imply γ > 0. The proof of Proposition 3.3 is left to the Appendix.Next we explain how to obtain facet-defining inequalities from lifting of the Euclidean inequalities. For ease of notation, for a subset S we will denote byX(S)=∑j∈SxjandY(S)=∑j∈Syj.Let Λ denote the set of the coefficients of all Euclidean facet-defining inequalities of types (2.1), (2.2), (2.3):Λ={(μ1,μ2,ν1,ν2,λ):μ1y1+μ2y2+ν1x1+ν2x2≤λis a facet-defining inequality of one of the types (2.1), (2.2), (2.3) for Z}.Consider an inequality for the restriction ofXto S1 ∪ S2, S1⊆N1, S2⊆N2, obtained from the Euclidean inequality defined by (μ1, μ2, ν1, ν2, λ) ∈ Λ:(3.7)μ1Y(S1)+μ2Y(S2)+ν1X(S1)+ν2X(S2)≤λ.From Lemma 3.1 it follows that (3.7) defines a facet of the restricted set resulting from X by considering only the subset of variables in S1⊆N1 and S2⊆N2.We assume henceforwardμ2+a2ν2μ1+a1ν1≠a2a1.It can be shown that the lifting of inequality (3.7) whenμ2+a2ν2μ1+a1ν1=a2a1gives inequalities (3.6). We omit the proof of this statement since it is too technical and this result will not be used in the remaining of the paper.Next we discuss the computation of the lifting coefficients of the variable pairs (yj, xj), forj∈I=I1∪I2,with I1 ∈ N1∖S1, I2 ∈ N2∖S2, whenμ2+a2ν2μ1+a1ν1≠a2a1in order to obtain a valid inequality forX:(3.8)μ1∑j∈S1yj+μ2∑j∈S2yj+∑j∈Iθjyj+ν1∑j∈S1xj+ν2∑j∈S2xj+∑j∈Iξjxj≤λThe lifting function associated with inequality (3.7) is given by(3.9)ϕ(z)=minλ−μ1Y(S1)−μ2Y(S2)−ν1X(S1)−ν2X(S2)(3.10)s.to∑j∈S1∪S2xt≤D−z(3.11)0≤xj≤atyj,t∈{1,2},j∈St(3.12)yj∈Z+,j∈S1∪S2The lifing function of the following Euclidean inequality given in Example 2.6,2y1+7y2+11(x1−21y1)+16(x2−76y2)≤109⇔−114y1−34y2+6x1+x2≤654is depicted in Fig. 2.The set of possible lifting coefficients for inequality (3.8) is denoted byΘ(μ1,μ2,ν1,ν2)and can be rewritten asΘ(μ1,μ2,ν1,ν2)={(θ,ξ)∈R2|I|:∑k∈Iθkyk+∑k∈Iξkxk≤ϕ(∑k∈Ixk),∀(y,x)∈X(I)}whereX(I)={(x,y)∈:R+∣I∣×Z+∣I∣:X(I)≤D,xj≤a1yj,j∈I1,xj≤a2yj,j∈I2}.The interesting cases are those where (θj, ξj) ≠ (0, 0), ∀j ∈ I, (θj, ξj) ≠ (μ1, ν1) if j ∈ I1 and (θj, ξj) ≠ (μ2, ν2) if j ∈ I2.In order to compute the lifting coefficients only extreme points and extreme rays ofPneed to be considered in the definition ofX(I).Extreme rays are of the form (0, ej) where ejis the unit vector with one in position j and zero elsewhere. Extreme rays imply θj≤ 0, j ∈ I. The following lemma considers extreme points ofP.Lemma 3.4Assume(3.8)defines a facet ofP,with (μ1, μ2, ν1, ν2) ∈ Λ, and (μ1, ν1) ≠ (θj, ηj), j ∈ I1, (μ2, ν2) ≠ (θj, ηj), j ∈ I2. If (x, y) is a tight extreme point ofPin the face defined by(3.8)and if yk> 0, for some k ∈ I1 ∪ I2, then (i)yk=1;(ii)yj=0,j∈I1∪I2∖{k};(iii)0<xk=D−X(S1∪S2)<atwheret=1if k ∈ I1andt=2if k ∈ I2; (iv)X(S1)=a1Y(S1);X(S2)=a2Y(S2).The proof is given in the Appendix.We can restrictX(I)to the set of points obtained by projecting the extreme points ofPinto the space of the lifting variables. We denote the restricted set asX¯(I).Using (i) and (ii) from Lemma 3.4 we can write setΘ(μ1,μ2,ν1,ν2)as follows.Θ(μ1,μ2,ν1,ν2)={(θ,ξ)∈R−|I|×R|I|:θk+ξkxk≤ϕ(xk),∀(y,x)∈X¯(I),yk=1,k∈I}.From condition (iii) and (iv), if (x, y) is an extreme point ofPandyk=1,k∈I,then0≤xk=D−X(S1∪S2)=D−a1Y(S1)−a2Y(S2)≤at.HenceD−at≤a1Y(S1)+a2Y(S2)≤D.For t ∈ {1, 2}, let us defineΣt={(Y1,Y2)∈Z+2:D−at≤a1Y1+a2Y2≤D};V(Σt) as the set of extreme points of conv(Σt), andΓt={γ:γ=D−a1Y1−a2Y2forsome(Y1,Y2)∈V(Σt)}.ThenProposition 3.5Θ(μ1,μ2,ν1,ν2)={(θ,ξ)∈R−|I|×R|I|:θj+ξjγ≤ϕ(γ),∀t∈{1,2},j∈It,γ∈Γt}.Since each inequality definingΘ(μ1,μ2,ν1,ν2)involves only one variable pair, setΘ(μ1,μ2,ν1,ν2)can be decomposed accordingly to variables pairs:Θ(μ1,μ2,ν1,ν2)=×j∈IΘ(μ1,μ2,ν1,ν2)(j)whereΘ(μ1,μ2,ν1,ν2)(j)={(θj,ξj)∈R−×R:θj+ξjγ≤ϕ(γ),t∈{1,2},j∈It,γ∈Γt}.Henceforward we focus on computing the lifting coefficients fromΘ(μ1,μ2,ν1,ν2)(j)only. We can observe that for each t ∈ {1, 2}, the setΘ(μ1,μ2,ν1,ν2)(j)is always the same for every j ∈ It. Hence, for t ∈ {1, 2}, we defineΘ(μ1,μ2,ν1,ν2)t={(θ,ξ)∈R−×R:θ+ξγ≤ϕ(γ),γ∈Γt}=Θ(μ1,μ2,ν1,ν2)(j),j∈It.It is well known that only extreme points ofΘ(μ1,μ2,ν1,ν2)tlead to facet defining inequalities of type (3.8). SinceΘ(μ1,μ2,ν1,ν2)t,t∈{1,2}are two dimensional polyhedra the set of extreme points can be computed efficiently (Hirschberg & Wong, 1976).The set of extreme points ofΘ(μ1,μ2,ν1,ν2,λ)twill be denoted byΘ¯(μ1,μ2,ν1,ν2,λ)t={(θtk,ξtk:k∈Tt}whereTt={1,…,nt}and ntdenotes the number of extreme points which isO(log(D/min{a1,a2})).These sets can be computed in the same time complexity.Example 3.6Consider the mixed integer setX={(y,x)∈Z+3×R+3:x1+x2+x3≤1154,x1≤21yj,x2≤76y2,x3≤76y3}.The full polyhedral description for the restricted set withx3=y3=0was given in Example 2.6. Next we discuss the lifting of variable pair (x3, y3). HenceI1=∅andI2={3}.Observe that Σ1 and Σ2 do not depend on the particular facet-defining inequality we are considering. Fig. 3depicts the setV(Σ2)={(54,0),(51,1),(44,3),(26,8),(4,14),(0,15),(8,12),(26,7),(48,1),(52,0)}.Now consider the Euclidean inequality2y1+7y2+11(x1−21y1)+16(x2−76y2)≤109which is equivalent to−114y1−34y2+6x1+x2≤654Based on the points in V(Σ2) we obtainΓt={20,7,2,0,6,14,74,76,70,62}and (see Fig. 2)ϕ(20)=6,ϕ(7)=0,ϕ(2)=0,ϕ(0)=0,ϕ(6)=0,ϕ(14)=6,ϕ(74)=40,ϕ(76)=42,ϕ(70)=36,ϕ(62)=30.ThusΘ(μ1,μ2,ν1,ν2,λ)2={(θ,ξ)∈R−×R:θ+20ξ≤6,θ+7ξ≤0,θ+2ξ≤0,θ≤0,θ+6ξ≤0,θ+14ξ≤6,θ+74ξ≤40,θ+76ξ≤42,θ+70ξ≤36,θ+62ξ≤30}.The extreme points are:Θ¯(μ1,μ2,ν1,ν2,λ)2={(−34,1),(−4213,613),(−387,47),(−332,34),(0,0)}.Hence we obtain the following set of facet-defining inequalities with (θ, ξ) ≠ (0, 0) and(θ,ξ)≠(−34,1):−114y1−34y2−4213y3+6x1+x2+613x3≤654−114y1−34y2−387y3+6x1+x2+47x3≤654−114y1−34y2−332y3+6x1+x2+34x3≤654Now we summarize the above discussion.Proposition 3.7Consider (μ1, μ2, ν1, ν2, λ) ∈ Λ and consider the disjoint sets S1, I1, ∅ ≠ S1 ⊂ N1, ∅ ≠ I1 ⊂ N1, and S2, I2, ∅ ≠ S2 ⊂ N2, ∅ ≠ I2 ⊂ N2. For t ∈ {1, 2}, let{It1,…,Itnt}define a partition of It. Then the following lifted Euclidean inequality is valid for X:(3.13)μ1∑j∈S1yj+μ2∑j∈S2yj+∑k∈T1∑j∈I1kθ1kyj+∑k∈T2∑j∈I2kθ2kyj+ν1∑j∈S1xj+ν2∑j∈S2xj+∑k∈T1∑j∈I1kξ1kxj+∑k∈T2∑j∈I2kξ2kxj≤λwhere(θtk,ξtk)∈Θ(μ1,μ2,ν1,ν2,λ)tfor t ∈ {1, 2}, k ∈ Tt.Note that all the coefficients involved in these valid inequalities can be computed in polynomial time since the information required can be obtained by computing the extreme points of two dimensional polyhedra, using a version of the Hirschberg and Wong’s algorithm (which is based on the Euclidean Algorithm).Here we establish the main result of this paper.Theorem 3.1The inequalities xj≥ 0, j ∈ N, xj≤ a1yj, j ∈ S, xj≤ a2yj, j ∈ N∖S,∑j∈Nxj≤D,(3.6)and the lifted Euclidean inequalities(3.13)suffice to describeP=conv(X).To prove this theorem we assume that the inequality(3.14)∑j∈Nμjyj+∑j∈Nνjxj≤λdefines a non-trivial facet,F(μ,ν,λ),of P (we call inequalities xj≥ 0, j ∈ N, xj≤ a1yj, j ∈ S, xj≤ a2yj, j ∈ N∖S, ∑j ∈ Nxj≤ D, trivial facets) and show that either it belongs to one of the families for the two dimensional case (3.5) or it belongs to one of the families (3.6) or (3.13) (which includes inequalities (3.5)). From Lemma 3.1 we may assume w.l.o.g. (μj, νj) ≠ (0, 0), j ∈ N.We will use the following notation for each t ∈ {1, 2} such that Nt≠ ∅, ℓt∈ argmin {μj, j ∈ Nt},St={j∈Nt:μj=μℓt},It=Nt∖StandI=I1∪I2.We also define the following aggregated variables:Yt=Y(St),Xt=X(St),t∈{1,2}.As the null vector is in X then λ > 0.The following properties hold:(i)For all j ∈ N1 ∪ N2, μj< 0.For all j ∈ N1 ∪ N2, νj> 0.(a)νℓ1>νjfor all j ∈ N1∖S1; (b)νℓ2>νjfor all j ∈ N2∖S2.(a)μℓ1+a1νℓ1>μj+a1νjfor all j ∈ N1∖S1; (b)μℓ2+a2νℓ2>μj+a2νjfor all j ∈ N2∖S2.If(x*,y*)∈F(μ,ν,λ)∩Xthen∑j∈Iyj*≤1.As the unit vector with 1 in position corresponding to yjand 0 elsewhere is a ray of P, then μj≤ 0. Ifμj=0then as we are assuming (μj, νj) ≠ (0, 0) we must have νj> 0. Then each point in the facetFmust satisfy∑j∈Nxj=D,(since otherwise, if there is a point(x,y)∈Fwith ∑j ∈ Nxj< D, then we can increase the value of yjand xjobtaining a violated point) which is a contradiction. Thus condition (i) must hold.Property (ii) follows from the fact that if νj≤ 0, thenxj=yj=0for every point inF(otherwise, if there is a solution(x,y)∈Fwith yj> 0 a new point in X can be constructed from (x, y) by decreasing the value of xjand yjto zero which violates (3.14)).To prove (iii) (a), observe that ifνℓ1≤νjfor some j ∈ N1∖S1, thenyj=xj=0for every point inF.Similarly for (b).To prove (iv), supposeμℓ1+a1νℓ1≤μj+a1νjfor some j ∈ N1∖S1. Thenμℓ1+γνℓ1<μj+γνjfor each 0 < γ < a1. This implies that for each(x,y)∈Feitherxℓ1=0ifyℓ1=0orxℓ1=a1yℓ1ifyℓ1>0(otherwise, if there is a solution(x,y)∈Fwithxℓ1<a1yℓ1then a violated point can be obtained by transferring the values ofxℓ1andyℓ1to variables xjand yj, respectively). In each case the conditionxℓ1=a1yℓ1holds, which is a contradiction.To prove (v) supposeyj*≥2with j ∈ I1. Ifxj*≤a1(yj*−1)a new point violating (3.14) can be obtained by decreasingyj*since, by (i), μj< 0. Ifxj*>a1(yj*−1)a new point violating (3.14) can be obtaining, using (iv), by decreasingxj*,yj*and increasingxℓ1*,yℓ1*in the same amounts. The case with j ∈ I2 is similar. Finally the case where∑j∈Iyj*>1andyj*≤1,∀j∈Ican be reduced to one of the previous ones by changing, appropriately, the values of the x variables.First notice that ifI=∅then, from Lemma 3.1, (3.14) is one of the valid inequalities (3.5) obtained from the aggregated model with two integer variables which is a particular case of (3.13).Next we show that ifN1=∅orN2=∅,then inequality (3.14) is an inequality (3.1) obtained from one of the inequalities (2.4).SupposeN1=∅.Next we show that μj, and νj, are constant for all j ∈ N2. Letj*∈argmax{μj+a2νj:j∈N2}.There must exist a point (x, y) inF(μ,ν,λ)satisfying ∑j ∈ Nxj< D. This point must satisfyxj=a2yj,∀j∈N2since νj> 0, j ∈ N2. Thus,λ=⌊D/a2⌋(μj*+a2νj*).This implies thatμj+γ2νj≤0for all j ∈ N2, whereγ2=D−a2⌊D/a2⌋,since otherwise, ifμj+γ2νj>0,then the point obtained by settingyj*=⌊D/a2⌋,xj*=a2yj*,yj=1,xj=γ2,and the remaining variables to zero, violates (3.14). Hence, if there is j ∈ N2 such thatμj+a2νj<μj*+a2νj*,then each point inF(μ,ν,λ)satisfiesxj=γ2yj,which is a contradiction since (3.14) defines a facet. Thusμj+a2νj=μj*+a2νj*for all j ∈ N2. It remains to prove thatμj*+a2νj*=μj+a2νjimpliesμj*=μjandνj*=νj.Suppose not. Assumeμj*+a2νj*=μj+a2νjandμj>μj*.This impliesνj<νj*.Thus, if there exists a tight point withxj*<a2yj*,one can obtain a feasible solution violating (3.14) by increasing xjinxj*−a2(yj*−1),yjin one unit, and decreasingxj*andyj*by the same amounts. This impliesxj*=a2yj*for every point inF(μ,ν,λ)which is a contradiction. The proof for the caseμj*+a2νj*=μj+a2νjandμj<μj*is similar and impliesxj=a2yjfor every point inF(μ,ν,λ). Thusμj=μj*,νj=νj*,for all j ∈ N2. Using Lemma 3.1, we conclude that (3.14) must be obtained from a facet-defining inequality for the set withn=1.Thus (3.14) belongs to family (3.5) obtained from a inequality (2.4) witht=2.Similarly, ifN2=∅,then (3.5) results from (2.4) witht=1.Henceforth we assume N1 ≠ ∅, N2 ≠ ∅. IfI=∅,thenμj=μℓt,andνj=νℓt,j ∈ Nt, t ∈ {1, 2}. From Lemma 3.1 we conclude that (3.14) must be obtained from a facet-defining inequality for the set conv(Z) with∣N1∣=∣N2∣=1.By Theorem (2.5) we conclude that coefficients(μℓ1,νℓ1,μℓ2,νℓ2,λ)of (3.14) belong to Λ, that is, they result from (2.1), (2.2), (2.3).Henceforth we assume I ≠ ∅. We will also use the notationXt=X(St),Yt=Y(St),t∈{1,2}.Let j ∈ I and consider a point(y*,x*)∈F(μ,ν,λ)∩Xsuch thatyj*>0.From (v) we haveyj*=1and from (i)-(iv) it followsxj*=D−X1*−X2*,X1*=a1Y1*,X2*=a2Y2*.Suppose j ∈ I1. As0<xj*<a1yj*implies0<D−X1*−X2*<a1⇒0<D−a1Y1*−a2Y2*<a1⇒(Y1*,Y2*)∈Σ1.Since (y*, x*) belongs toF(μ,ν,λ),it satisfies (3.14) at equality. Thus, settingxj*=D−X1*−X2*,X1*=a1Y1*,X2*=a2Y2*,andxj′*=0,j′∉S1∪S2∪{j},then we haveY1*(μℓ1+a1νℓ1−a1νj)+Y2*(μℓ2+a2νℓ2−a2νj)=λ−Dνj−μj.Therefore(Y1*,Y2*)must be optimal to(AP1):max{(μℓ1+a1νℓ1−a1νj)Y1+(μℓ2+a2νℓ2−a2νj)Y2:(Y1,Y2)∈Σ1}(otherwise, considering an optimal solution to AP1 we could construct a point violating (3.14)). Similarly, if j ∈ I2 then(Y1*,Y2*)must be optimal to(AP2):max{(μℓ1+a1νℓ1−a1νj)Y1+(μℓ2+a2νℓ2−a2νj)Y2:(Y1,Y2)∈Σ2}.Case 1. There is a i ∈ I such that(3.15)μℓ1+a1νℓ1−a1νi=0,(3.16)μℓ2+a2νℓ2−a2νi=0,which impliesμℓ2+a2νℓ2μℓ1+a1νℓ1=a2a1.There must exist solutions (y, x) inF(μ,ν,λ)satisfyingyi=0andX1+X2<D(since yj> 0 for some j ∈ I implies∑j∈Nxj=Dbecause νj> 0). Thenxj=yj=0,j∈I.In those casesX1=a1Y1,X2=a2Y2,becauseνℓ1,νℓ2>0.Hence,μℓ1Y1+μℓ2Y2+νℓ1X1+νℓ2Y2=λ⇔(μℓ1+a1νℓ1)Y1+(μℓ2+a2νℓ2)Y2=λ.Using Eqs. (3.15) and (3.16) it follows thata1νiY1+a2νiY2=λ.Noticing that(Y1,Y2)∈Y≤thenλ=νimax{a1Y1′+a2Y2′:(Y1′,Y2′)∈Y≤}⇒λ=νi(D−γ),whereγ=D−max{a1Y1′+a2Y2′:(Y1′,Y2′)∈Y≤}.There must exist solutions inF(μ,ν,λ)satisfyingyi=0and 0 < X1 < a1Y1 (otherwiseX1=a1Y1for every point inF). Againxj=yj=0,j∈I.In this case it must occurX2=a2Y2,X1=D−X2=D−a2Y2.Thus,μℓ1Y1+(D−a2Y2)νℓ1+(μℓ2+a2νℓ2)Y2=λ⇔μℓ1Y1+(μℓ2+a2νℓ2−a2νℓ1)Y2=λ−νℓ1D.Using (3.15) and (3.16) it follows thata1(νi−νℓ1)Y1+a2(νi−νℓ1)Y2=λ−νℓ1D.Noticing that(Y1,Y2)∈Y1and by (iii)νi−νℓ1<0,thenλ−νℓ1D=(νi−νℓ1)min{a1Y1′+a2Y2′:(Y1′,Y2′)∈Y1}=(νi−νℓ1)(D+ϵ1),whereϵ1=min{a1Y1′+a2Y2′:(Y1′,Y2′)∈Y1}−D.Similarly, using a solution inF(μ,ν,λ)satisfyingyi=0and 0 < X2 < a2Y2 we concludeλ−νℓ2D=(νt−νℓ2)(D+ϵ2)whereϵ1=min{a1Y1′+a2Y2′:(Y1′,Y2′)∈Y2}−D.Next we show that(3.17)μj=μiandνj=νi,∀j∈ISuppose conditions (3.17) do not hold for some j ∈ I1 (for j ∈ I2 the proof is similar). For each point inF(μ,ν,λ)with xj> 0 we have(μℓ1+a1νℓ1)Y1+(μℓ2+a2νℓ2)Y2+μj+νjxj=λ⇔a1νiY1+a2νiY2+μj+νj(D−a1Y1−a2Y2)=λ⇔a1(νi−νj)Y1+a2(νi−νj)Y2=λ−νjD−μj.Thus(Y1,Y2)=argmax{a1Y1′+a2Y2′:(Y1′,Y2′)∈Σ1}if νi> νjand(Y1,Y2)=argmin{a1Y1′+a2Y2′:(Y1′,Y2′)∈Σ1},otherwise. Let us defineφ=D−max{a1Y1′+a2Y2′:(Y1′,Y2′)∈Σ1}if νt> νjandφ=D−min{a1Y1′+a2Y2′:(Y1′,Y2′)∈Σ1}otherwise. Hencexj=φyjfor each point inF(μ,ν,λ),which is a contradiction.Using (3.17) and the six equations: (3.15); (3.16);λ=Dνi+μi;λ=νi(D−γ);λ−νℓ1D=(νi−νℓ1)(D+ϵ1);λ−νℓ2D=(νi−νℓ2)(D+ϵ2);we conclude that the facet is defined by inequality (3.6).Case 2.μℓ2+a2νℓ2μℓ1+a1νℓ1≠a2a1.Next we show that the inequality defined by(μℓ1,μℓ2,νℓ1,νℓ2,λ):(3.18)μ1∑j∈S1yj+μ2∑j∈S2yj+ν1∑j∈S1xj+ν2∑j∈S2xj≤λmust define a facet of the polyhedron withN′=N∖I.SinceF(μ,ν,λ)is a facet of P it includes a setAwith 2n affinely independent points. For each i ∈ I there must exist inAat least two points withyi=1.However, since each point inF(μ,ν,λ)∈Xwithyi=1,i ∈ I1, corresponds to an optimal solution to AP1, it follows that there are inAexactly two points withyi=1for each i ∈ I1 (observe that the hypothesisμℓ2+a2νℓ2μℓ1+a1νℓ1≠a2a1implies that the coefficients of the objective function of AP1 are not simultaneously null). ThusAincludes2(n−∣I1∣)affinely independent points withxi=yi=0for i ∈ I1. Similarly, considering i ∈ I2, we conclude thatAincludes2(n−∣I2∣)affinely independent points withxi=yi=0for i ∈ I2. This implies that (3.18) defines a facet of the polyhedron withN′=N∖I.From Lemma 3.1, we conclude that it defines a facet for the 2-integer variables model Z.As (3.14) is valid, then(μi,νi)∈Θ(μu,μℓ,νu,νℓ,λ)1.Observe that the points inF(μ,ν,λ)∩Xwithyi=1are obtained from two optimal solutions to AP1 which belong to V(Σ1). These two extreme points in V(Σ1) give the two tight constraints ofΘ(μu,μℓ,νu,νℓ,λ)1defining the extreme point (μi, νi).Hence, (3.14) is of type (3.13).□In this section we study the separation problems associated with the families of valid inequalities derived for X. Consider a point(y,x)∈R2n.For each family of valid inequalities the separation problem is: find an inequality that is violated by (y, x) or show that no such inequality exists.First we consider inequalities (3.6). Sets S1, S2 maximize the left-hand side of (3.6) if and only if:{j∈N1:xj−γyj<a1yj+γ+ϵ1ϵ1xj−a1γ+ϵ1ϵ1yj}⊆S1,{j∈N1:xj−γyj>a1yj+γ+ϵ1ϵ1xj−a1γ+ϵ1ϵ1yj}⊆N∖S1,{j∈N2:xj−γyj<a2yj+γ+ϵ2ϵ2xj−a2γ+ϵ2ϵ2yj}⊆S2,{j∈N2:xj−γyj>a2yj+γ+ϵ2ϵ2xj−a2γ+ϵ2ϵ2yj}⊆N∖S2.For those cases where the equalityxj−γyj=atyj+γ+ϵtϵtxj−atγ+ϵtϵtyjholds, for t ∈ {1, 2}, choose arbitrarily between the corresponding sets St, N∖St. The separation problem can be solved inO(n).Next we describe a simple separation procedure for the lifted Euclidean inequalities.For each Euclidean inequality of type (2.1), (2.2), (2.3) we construct a lifted Euclidean inequality (3.13). In order to maximize the left-hand side we choose the set in which to put j ∈ N as follows:For j ∈ N1 we determinemax{0,μ1yj+ν1xj,θ1kyj+ξ1kxj}wherek=argmaxℓ∈T1{θ1ℓyj+ξ1ℓxj}.Then put j in N1∖{S1 ∪ I1} if the maximum is 0; put j in S1 if the maximum isμ1yj+ν1xj;and putj∈I1kotherwise.For j ∈ N2 we determinemax{0,μ2yj+ν2xj,θ2kyj+ξ2kxj}wherek=argmaxℓ∈T2{θ2ℓyj+ξ2ℓxj}.Then put j in N2∖{S2 ∪ I2} if the maximum is 0; put j in S2 if the maximum isμ2yj+ν2xj;and putj∈I2kotherwise.The number of different coefficients in I isO(b)whereb=log(D/min{a1,a2})}and the time complexity to compute those coefficients is similar. The overall procedure isO(nb).In this section we discuss three possible applications: an inventory-distribution problem, a capacitated facility location problem, and a muti-item production planning problem. The main purpose is to illustrate and explain how the lifted Euclidean inequalities can be used in practical problems. We report on computational experimentations on small sets of instances for each one of these three problems. With the first two problems we also illustrate how these inequalities can be used in sets that are very similar to setXbut do not coincide withX.For each problem we compare the value of the linear relaxation with the value of the linear relaxation after the inclusion of cuts from the lifted Euclidean inequalities. In order to derive these cuts, we consider a single node flow set obtained by relaxation of the original feasible set. Then we add all valid inequalities derived for the corresponding single node flow set that are violated by the fractional linear programming solution. We repeat this process until no further violated valid inequalities are obtained.For the computation we use the optimization package Xpress Optimizer, Version 25.01.05, with MOSEL in a computer with a Intel Core I7, 2.4GHz processor with 16GB RAM.The Vendor Management Problem (VMP) occurs when a distributor/producer controls the inventory at the retailers. Given a set of n retailers and a demand in each period of each retailer during a time horizon of m periods, the VMP aims to find the amount to order in each time period of a given item and the amount to send to each retailer in each period, in order to minimize the holding, backlogging, distribution and fixed ordering costs.DefineT={1,…,m}andI={1,…,n}the set of time periods and retailers, respectively. We assume there is a fleet with two types of vehicles with capacities C1 and C2, and each retailer is visited by one type of vehicle only. Let I1, I2 define the subsets of I that are served by vehicles with capacity C1, C2, respectively.For each period t ∈ T and each retailer i ∈ I, consider the variablesxit,yit,sitthat represent, respectively, the amount sent, in time period t, to client i; the number of vehicles used to serve retailer i, in period t; and the stock level in retailer i at the end of time period t. The binary variable ztindicates whether a fixed cost is incurred in period t or not.For each time period t and each retailer i,ditrepresents the demand,pit,represents the unit product transportation cost,fitrepresents the fixed transportation cost per vehicle, andhitrepresents the unit product holding cost. M is distribution capacity in each time period and gtis the fixed cost for distributing in period t. The VMP can be written as follows.(4.1)min∑i∈I∑t∈Tpitxit+fityit+hitsit+∑t∈Tgtztsit−1+xit=dit+sit,i∈I,t∈T,(4.2)xit≤C1yit,i∈I1,t∈T,(4.3)xit≤C2yit,i∈I2,t∈T,(4.4)∑i∈Ixit≤Mztt∈T,(4.5)xit,sit≥0,yit∈{0,1}i∈I,t∈T,(4.6)si0=sim=0i∈I,(4.7)zt∈{0,1}t∈T.Constraints (4.1) are the usual flow conservation constraints at each retailer and for each time period. Constraints (4.2) and (4.3) are the variable upper bound constraints. Constraints (4.4) impose a maximum amount to distribute in each period and impose a setup cost whenever there is distribution. Constraints (4.5)–(4.7) are the sign constraints. The set defined by (4.1)–(4.7) will be denoted by XVMP.Consider the relaxation of the VMP obtained by eliminating the flow conservation constraints. The relaxed model is separable into several subproblems, one for each period t. For each period t, the feasible set, denoted byXtVMP,is the integer single node flow set with two capacities and with a set-up variable associated to the node itself:XtVMP={(z,y,x)∈{0,1}×Z+n×Rn:∑i∈Ixi≤Mz,0≤xi≤C1yi,i∈I1,0≤xi≤C2yi,i∈I2}.Set XVMPdiffers from X (considering I as N and C1, C2 as a1, a2) since it includes the set-up variable z. Following Proposition 4 in Agra and Doostmohammadi (2013), one can easily show that if(4.8)∑j∈Iαjxj+∑j∈Iβjyj≤δis valid for X, then (4.8) is valid for XVMP. Conversely, if βj≤ 0, ∀j ∈ N, then inequality (4.8) is valid for X, if and only if(4.9)∑j∈Iαjxj+∑j∈Iβjyj≤δzis valid forXtVMP.Hence all the inequalities derived for X can be used directly to tighten the linear relaxation of XVMP, and tighter inequalities can be derived by multiplying the RHS of inequalities (3.6) and (3.13) by zt.Such problem occurs, for instance, within maritime transportation, in a medium-term planning, when a product is supplied by large ships (batches in our model), and then distributed among a set of ports using an heterogeneous fleet (with two types) of smaller ships. Each port is served by one type of ship (accordingly to the characteristics of each port). The set-up variable ztindicates whether a large shipment must occur in that time period and the y variables indicate the number of smaller ships of type t that must be sent to a given port.We consider instances withm=20,n=5.Demandsditwere randomly generated in [1, 25], and we set the unit transportation costs topit=2,the fixed transportation costs tofit=1001,the unit holding costshit=0.M=1000.We consider 5 instances withC1=10,C2=17,labeled asi1a,…,i5aand 5 instances with capacitiesC1=30,C2=50,which are labeled asi1b,…,i5b.The computational results after 5 minutes of computer time are reported in Table 1. Column LR indicates the linear relaxation value, BFB gives the Best known Feasible Solution, Gap gives the corresponding gap(Gap=BFB−LRBFB*100%).ColumnsLR+CandGap+Cgive the linear relaxation value and the corresponding gap after the cuts have been added at the root node. Column Cuts gives the number of cuts added. The last columns give the Best Feasible Solution (BFS), the Best Lower Bound (BLB), which is the best lower bound obtained at the end of the running time, and the corresponding gap (Gap) for the cases with inclusion of cuts and without inclusion of cuts.We can see that the inclusion of cuts reduced both the initial gap and the gap after 5 minutes of running time.Consider the following capacitated facility location problem (CFLP). We are given a setN={1,…,n}of clients and a setL={1,…,m}of possible facility locations. Let dtrepresent the demand of client t, and Cjrepresent the capacity of each facility j ∈ L. Parameter fjindicates the fixed cost for installing a facility in j ∈ L and pjtindicates the cost of satisfying one unit of demand of client t ∈ N from a facility j ∈ L. The variables xjtindicate the amount of the demand of client t, that is satisfied by the facilities located at j. The integer variables yjrepresent the number of facilities open at location j. The CFLP can be described as follows.(4.10)min∑t∈N∑j∈Lpjtxjt+∑j∈Lfjyj∑j∈Lxjt=dt,t∈N,(4.11)∑t∈Nxjt≤Cjyj,j∈L,(4.12)xjt≤dtyj,j∈L,t∈N,(4.13)xjt≥0,j∈L,t∈N,(4.14)yj∈Z0+,j∈L.Constraints (4.10) ensure that the demand of each client is satisfied. Constraints (4.11) impose the capacity of each facility. Constraints (4.12) are the usual variable upper bound constraints, used to tighten the formulation .Considering a subset T ⊆ N of clients, and aggregating the corresponding variableswj=∑t∈Txjtwe obtain the following single node flow set:XFC={(y,w)∈Zn×R+n:∑j∈Lwj=∑t∈Tdt,wj≤Cjyj,j∈L}.Assume there are only two possible values for capacity Cj. Set XFCdiffers from X because it has the equality constraint∑j∈Lwj=∑t∈Tdt.Obviously, valid inequalities for set X (with ≤ constraints) are valid for XFCsince XFCis a restriction of X. For the equality case the families (3.6) are void (since it assumes γ > 0, ϵ1 > 0, and ϵ2 > 0). Similarly, in family (3.8) we haveI=∅.We consider instances withn=100,m=10.Parameters dt, fjwere randomly generated in [100, 150], and [9000, 10, 000], respectively. Andpjt=2,∀j,t.Again we consider 5 instances withC1=100,C2=170,labeled asi1a,…,i5aand 5 instances withC1=300,C2=500,labeled asi1b,…,i5b.The computational results are reported in Table 2. Since all the instances were solved to optimality, in addition to the notation introduced before, column OPT indicates the value of the optimal solution, columns Time indicate the running time in seconds to solve the problem and columns Nodes indicate the number of nodes in the branch-and-bound tree.The inclusion of cuts was again effective in reducing the integrality gap and the number of branch-and-bound nodes, in average.Consider the following muti-item production planning problem (MPP). LetI={1,…,n}be the set of items andT={1,…,m}be the set of time periods. For each period t ∈ T consider the variablesxit,yit,sitandrit,that represent the production lot sizing of item i in period t; the integer variable indicating the number batches of item i to produce in period t; the inventory of item i at the end of period t; and the backlog of item i at the end of period t, respectively.The demand of each item for each period is given bydit.For each time period t, Mtis the available production capacity. In each time period we consider two batch sizes. One with capacityc1tfor items i ∈ I1 and the other,c2t,for itemsi∈I2=I∖I1.For each item and each period the costspit,fit,hit,bitrepresent, respectively, the unit production cost, the fixed production cost, the unit inventory cost and the unit backlog cost.The multi-item lot-sizing problem is given by,(4.15)min∑i∈I∑t∈Tpitxit+fityit+hitsit+bitritsit−1+xit+rit=dit+sit+rit−1,i∈I,t∈T,(4.16)si0=sim=ri0=rim=0,i∈I,(4.17)xit≤c1tyit,i∈I1,t∈T,(4.18)xit≤c2tyit,i∈I2,t∈T,(4.19)∑i∈Ixit≤Mt,t∈T,(4.20)xit,sit≥0,yit∈{0,1},i∈I,t∈T.Constraints (4.15) are the flow conservation constraints. Constraints (4.16) ensure that the inventory and backlogging at the beginning and at the end of the planning horizon is zero for each item. Constraints (4.17) and (4.18) establish the upper bound capacity on each lot. Constraints (4.19) model a resource constraint (as time-machine constraint).Consider the relaxation of the MPP obtained by deleting the flow conservation constraints. The relaxed model is separable in several problems, one for each period t. For each period t, the feasible set is the integer single node flow set with two possible values for the upper bounds:{(y,x)∈Z+n×Rn:∑i∈Ixi≤M,0≤xi≤c1yi,i∈I1,0≤xi≤c2yi,i∈I2}.We consider instancesn=5,m=20,pit=2,fit=101,hit=1,∀i,t.Parameters dt,bit,were randomly generated in intervals [1, 25], and [500, 600], respectively. Again we consider 5 instances withC1=10,C2=17,labeled asi1a,…,i5aand 5 instances withC1=30,C2=50,labeled asi1b,…,i5b.The computational results are reported in Table 3. The meaning of the columns is the same as for the VMP.As for the previous two models, the value of linear programming gaps have improved in the presence of the lifted Euclidean inequalities, while the final gaps were slightly better for most instances.

@&#CONCLUSIONS@&#
