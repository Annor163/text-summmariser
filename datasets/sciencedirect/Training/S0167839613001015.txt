@&#MAIN-TITLE@&#
RAGS: Rational geometric splines for surfaces of arbitrary topology

@&#HIGHLIGHTS@&#
A new approach for constructing smooth parametric surfaces is proposed.Bivariate polynomial splines are generalized to rational splines.The genus and order of continuity of the surfaces can be arbitrary.The construction employs linear rational transformations as transition maps.The computational properties of the new splines are similar to those of the classical splines.

@&#KEYPHRASES@&#
Bivariate spline,Piecewise rational function,Unstructured mesh,Arbitrary topological genus,Smooth spline,Linear rational transition map,

@&#ABSTRACT@&#
A construction of spline spaces suitable for representing smooth parametric surfaces of arbitrary topological genus and arbitrary order of continuity is proposed. The obtained splines are a direct generalization of bivariate polynomial splines on planar partitions. They are defined as composite functions consisting of rational functions and are parametrized by a single parameter domain, which is a piecewise planar surface, such as a triangulation of a cloud of 3D points. The idea of the construction is to utilize linear rational transformations (or transition maps) to endow the piecewise planar surface with a particularC∞-differentiable structure appropriate for defining rational splines.

@&#INTRODUCTION@&#
The search for effective mathematical representations of smooth shapes suitable for storing and manipulating on a digital computer has been a central research activity in CAGD. For many years, splines or piecewise polynomials in two variables have played a prominent role in this endeavor. Special cases of bivariate splines on triangulations and rectangular partitions in the plane have been used for quite some time in data fitting and the finite element methods. Moreover, rational splines on tensor product meshes – so-called NURBS (Non-Uniform Rational B-Splines) – are employed frequently and are standard in many engineering applications and software packages. In fact, the majority of computer models of surfaces in the CAD/CAM industry today are spline models.However, despite the effectiveness of the spline methodology, the quest for an optimal construction and representation of general smooth surfaces seems to be far from over. This is imputable to the deficiencies of current spline representations that make them problematic, at least in their current form, for representing smooth surfaces of arbitrary topology. For example, the “NU” in the acronym NURBS has proven to be an oxymoron since the rigid and uniform nature of NURBS surfaces is precisely what stands in the way of their applicability to general surfaces. In particular, NURBS cannot be effectively used with unstructured meshes of general topological genus. Similarly, the bivariate polynomial splines – thought by many as the sine qua non of CAGD – also seem to lack sufficient flexibility to represent arbitrary shapes, for example those of closed surfaces. These drawbacks suggest that the classical spline representation, that is, a piecewise representation of surfaces based on stitching together polynomial or rational patches may not be well suited and powerful enough to tackle the general problem of surface modeling.Recent research in alternative shape representations seems to support and reinforce this view. In particular, we mention the rich field of the so-called subdivision methods (Warren and Weimer, 2001; Sabin, 2005; Peters and Reif, 2008; Cashman, 2012), T-splines (Sederberg et al., 2003; Li and Qin, 2012), and manifold-based methods (Grimm and Hughes, 1995; Navau and Garcia, 2000; Della Vecchia et al., 2008; Gu et al., 2008; Tosun and Zorin, 2011). While these approaches have certain aspects in common with the spline approach, for example, they offer local constructions of surfaces, there are important differences. The alternative methods typically do not express a surface as a finite collection of polynomial or rational patches and, in fact, in some cases they do not even give rise to an explicit analytic closed-form representation of the surface. It is clear that these alternative methods represent a major shift from the classical spline/NURBS paradigm.One wonders whether the departure from this paradigm is justified and necessary. It seems an undisputed fact that methods based on polynomial splines, which work well in settings where the modeled surfaces can be parametrized by a planar domain, do not carry over to the case where such parametrization is not possible. For example, the well-known Powell–Sabin macro-element method (Powell and Sabin, 1977) is an elegant means of constructing aC1piecewise quadratic surface, as long as the surface is homeomorphic to a subset of the plane or the torus. For other surfaces, this method fails, or at least we are not aware of any successful attempts of using Powell–Sabin polynomial splines for modeling surfaces of arbitrary genus, even simple surfaces that are homeomorphic to the sphere. In fact, we are not familiar with any methods based on bivariate (algebraic) piecewise polynomials, either on triangulations or rectangular partitions, that have been successfully implemented for surfaces of arbitrary topology. While there is a plethora of techniques for constructing bivariate splines of smoothnessC1,C2, or higher, such as conforming finite elements and many other types of splines on planar domains (see for example the recent book by Lai and Schumaker, 2007), when it comes to smooth surfaces of arbitrary genus, researchers resort to entirely new techniques.This discussion begs the question: Can the existing deficiencies of bivariate splines, which seem to make them inherently ill-suited for the purpose of representing arbitrary shapes, be mitigated or perhaps even redressed? Can the definition of polynomial splines on triangulations and other partitions be tweaked so as to expand their range of applicability to general surfaces, while still preserving most of the attractive features of the original splines? In particular, can this modification be done in such a way that essentially the same surface construction methods that have been devised for the traditional piecewise polynomials will work virtually identically in the more general setting?The objective of this paper is to point out that in our opinion the above questions can be answered affirmatively and that, indeed, it is possible to appropriately and in fact quite minimally adjust the definition of the piecewise polynomial spaces, thereby making them suitable for representing smooth surfaces of arbitrary topological genus. As it turns out, the modified spline spaces will consist of piecewise rational functions. This is beneficial for several reasons. One, once the decision is made to move away from pure algebraic polynomials, it is natural to consider rational functions, which are similarly well suited for numerical computation. Two, rational functions are comparable to polynomials in terms of their Bézier structure. Namely, they also admit a Bézier representation, a de Casteljau algorithm, and smoothness conditions between rational patches have similar form. Moreover, like polynomials, rational functions are refinable (i.e., can be subdivided), they can be degree-elevated, and one can also define a control (Bézier) net with the convex-hull property. Three, it makes sense to look for splines which are compatible, at least in principle, with NURBS, which are rational themselves. In fact, one of our motivations to define generalized splines as piecewise rational functions was the realization that the “R” in NURBS is hardly ever used in current practice, except in situations when one wants to represent quadric surfaces exactly. It therefore made sense to us to expect that the additional degrees of freedom afforded by the weights (i.e., coefficients in the denominators) of the rational functions could be beneficial for constructing surfaces of general topology, especially when one is willing to consider triangular meshes in addition to uniform quadrilateral meshes.Before we delve into these issues in more detail, we sketch the main idea behind the construction of the generalized spline spaces. Recall that the classical space of bivariate piecewise polynomials on a planar triangulated domainΩ⊂R2, of degree n and smoothness m, is defined as(1)Snm(Δ):={f∈Cm(Ω);f|T∈πn,T∈Δ},where Δ is a given triangulation of Ω andπnis the space of bivariate polynomials of total degree at most n. Thus, functions in this space are algebraic polynomials on triangles in Δ and are such that their values and values of their derivatives up to order m are identical along the common edge of any pair of neighboring triangles. This guarantees that the spline is globallyCmsmooth. We refer the reader to the recent monograph by Lai and Schumaker (2007), for an exhaustive study of such spline spaces.In this paper we are interested in defining an analog of the above space for the case where the trianglesT∈Δare not all lying in a single plane, but form a simplicial complex, whose geometric realization is a continuous piecewise linear surface Ω inR3, and whose facets are the given triangles in Δ. Thus, the new spline space will be a set of functions parametrized by the triangulated surface Ω. Therefore, the constructed analog ofSnm(Δ)can still be considered a collection of individual functions, each of which is parametrized by the (planar) triangles T of Δ, i.e., facets of Ω. Since algebraic polynomials seem to be no longer appropriate in this more general setting, the spaceπnin definition (1) will be replaced by the spaceρnof rational functions, which are quotientspn/qnof two degree-n polynomials. The general idea will be that the polynomialsqnwill be fixed to capture the topology of the modeled surface, while the polynomialspncan be used to control its geometry.A second needed modification of (1) will be as follows. Since in general the triangles of Δ will no longer lie in a single plane, we need to introduce regularC∞-transition maps or local coordinate transformations which will allow us to glue neighboring triangles together, so that it will be possible to define when two functions defined on neighboring triangles join withCm-continuity. These transformations will in effect equip Ω with aC∞-differentiable structure. It will be argued that transformations that make most sense in the above context are linear rational transformations. This is reasonable, in view of our intuition to replace the polynomial space in (1) by rational functions.As will be discussed later, with these proposed modifications the new spline spaces closely mimic the classical space (1). Of course, the classical space is in fact a special case of such newly defined spaces since, if Ω is planar, the transition transformations can all be chosen to be the identity maps and pure polynomials can be employed instead of rational functions.For the remainder of the paper, we will assume that Δ is a triangulation, although other polygonal complexes can also be considered, such as quadrilateral complexes. Moreover, we will assume that the surface Ω, obtained as the union of the triangles in Δ, is closed, i.e., it is a compact 2-manifold without a boundary, immersed inR3. However, all results of this paper readily apply to surfaces with boundary.To motivate the construction of splines in this paper, we start off with a few heuristic observations concerning the definition of barycentric coordinates on smooth surfaces. Barycentric coordinates (b.c.s, for short) play an important role in the context of generalizing spline spaces of type (1) since products of b.c.s give rise to analogs of polynomials on surface triangles. These in turn can be used to define spline spaces on triangulations of the given surface.Suppose that a triangulation Γ of aC∞-surface Σ is given, where all surface triangles of Γ are closed sets homeomorphic to a disk. LetT∈Γbe a triangle with verticesu1,u2,u3∈Σand edgesε1,ε2,ε3⊂Σ, whereεlis the edge opposite to vertexul, see Fig. 1. Bystar(T), we denote the set of all triangles in Γ, sharing a vertex in common withT. By b.c.s defined onTwe mean a tripleβ1,β2,β3of real-valued infinitely-differentiable functions onT, such that(a)the b.c.s satisfy:(2)βl(ul)=1,βl(u)=0,∀u∈εl,l=1,2,3,and, in particular, the spaceLT, the linear span of the b.c.s onT, is three dimensional;anyf∈LTcan be uniquely extended as aC∞-function tostar(T), where this extension, also denoted by f, is such thatf|T′∈LT′, for allT′∈star(T);ifT′is an adjacent surface triangle toT, i.e., sharing a common edgeε3withT, then the b.c.β3, which vanishes onε3, is positive onT\ε3and negative onT′\ε3.We note in passing that it is not necessary that b.c.s add up to one, for this condition could be too restrictive. For example, spherical b.c.s do not sum to one (Alfeld et al., 1996a).The motivation for the above postulates is that the b.c.s can now be used to define spline spaces closely resembling (1). Splines in such spaces can be defined as piecewise functions parametrized by Σ, and such that on each triangleT∈Γ, they can be written in the Bernstein–Bézier form (or B-form):(3)pn:=∑cijkBijkn,Bijkn:=n!i!j!k!β1iβ2jβ3k,i+j+k=n,where n is the spline degree,cijkare scalars or vectors,Bijknare analogs of the classical Bernstein basis polynomials, and where the sum is taken over all indices such thati+j+k=n. One justification for the requirement (2) is that these identities automatically imply that the value ofpnand its derivatives up to order m along an edge ofT, sayε3, are controlled by B-coefficients near that edge, i.e., the coefficientscijk,k⩽m, which is a well-known property of ordinary Bernstein–Bézier polynomials (or B-polynomials).To explain the rationale for (b), letT,T′∈Γbe adjacent triangles. Then, by (2), the spacesL:=LT,L′:=LT′are both 3-dimensional and their dimension drops to two on their common edgeε3. In order for the sought-for spline space to contain continuous functions alongε3, ideally the two spacesL|ε3andL′|ε3should be identical, for otherwise it will be impossible to join a functionf∈Lwith a functionf′∈L′alongε3. Similarly, for the spline space to contain functions of higher orders of continuity, the spacesLandL′will have to be interlocked together even more tightly. In particular, it is not hard to see that in order to construct splines of arbitrarily high orders of continuity (by increasing the degree n), the spaceLmust possess property (b). We will refer to (b) as the continuation property ofL. We note in passing that (b) immediately implies that the space of functionspnonTof the form (3) also possesses the continuation property, i.e., for eachpnthere exists a uniquepn′of the form (3) onT′such that the two functions join withC∞-continuity alongε3.Lastly, requirement (c) makes it possible to decide on which side of an edge is a given point of Σ. The importance of this property will become apparent in the sequel. Clearly, (c) is satisfied for the ordinary b.c.s.The above scenario for constructing spline spaces on surfaces is in principle plausible. In fact, this general approach of defining splines has been carried out successfully for the case where Σ is the 2-sphere in Alfeld et al. (1996a, 1996b), where it is demonstrated that well-established data fitting methods for the classical splines can be adapted in a straightforward way to work equally well in the spherical setting.However, it is not clear whether the above recipe can be realized in practice for general surfaces (see, for example, the discussion on this topic in Neamtu, 2002). First, most often a smooth initial surface Σ is not given, let alone in an explicit analytic form. In fact, frequently the reason for the need of an appropriate spline space is to find an unknown smooth surface, for example approximating a set of scattered points, and not vice versa. Second, even if Σ were given explicitly, it is not obvious in general how to construct matching sets of b.c.s on Σ, unless the surface is relatively simple, such as a sphere. This prompts us to suggest an alternative approach to building splines.In addition to the triangulation Γ on Σ, we will next consider a triangulation Δ, consisting of planar triangles, which is combinatorially equivalent to Γ. Thus Δ, viewed as a surface, say Ω, is homeomorphic to Σ. For example, Δ could be the piecewise linear interpolant to the vertices of Γ. Assuming, as before, that b.c.s are defined for all triangles of Γ, these give rise to a bijection of Σ onto the piecewise linear surface Ω. In particular, letT∈ΓandT∈Δbe two corresponding triangles, with verticesu1,u2,u3andv1,v2,v3, respectively (see Fig. 2). The bijection can now be defined as:σT:u↦v:=b1v1+b2v2+b3v3:=β1β1+β2+β3v1+β2β1+β2+β3v2+β3β1+β2+β3v3,whereβ1,β2,β3are the b.c.s of u w.r.t.Tand whereb1,b2,b3are the standard planar b.c.s of v w.r.t. T. We note that this map is well defined since by property (c),β1+β2+β3>0onT. In fact, by continuity of the b.c.s and property (b),σTis well defined in an (open) neighborhoodU⊂ΣofT. Thus, denoting byaff(T)the affine hull of T, the setU:=σT(U)⊂aff(T)is a neighborhood of T in the relative topology ofaff(T).Let us now focus on two adjacent triangles,T,T′∈Γ, the corresponding pair of adjacent trianglesT,T′∈Δ, and associated pairs of neighborhoodsU,U′andU,U′(Fig. 3). Consider a function φ defined onE:=U∩U′, which can be reparametrized as a function f onE:=σT(E)or as a functionf′onE′:=σT′(E), wheref(v):=φ∘σT−1(v),v∈E,f′(v′):=φ∘σT′−1(v′),v′∈E′.Thus, f andf′can be identified with each other, given that they correspond to the same function φ. This is equivalent to the property thatf′andf∘ϕT′,Tare identical onE′, where(4)ϕT′,T:=σT∘σT′−1:E′→E,or, also, that f andf′∘ϕT,T′are identical on E, withϕT,T′:=ϕT′,T−1=σT′∘σT−1.The mapsϕT′,Tare usually called transition maps or reparametrizations. They can be used to determine whether two spaces of functions defined on adjacent triangles T,T′can be identified with each other in the aforementioned sense. Moreover, using these maps one can also define when two functionsf,f′join smoothly along their common edge.Definition 1Letf,f′be defined on adjacent trianglesT,T′. We say that they join withCm-continuity,m⩾0, iff′andf∘ϕT′,T, and all their partial derivatives up to and including order m, are equal along the common edge of T andT′.Note that the above-definedCm-continuity is sometimes referred to as geometric continuity, orGm-continuity, w.r.t. mapϕT′,T(Peters, 2002b). We should point out that sinceϕT′,Thas been defined using b.c.s on aC∞-surface and since the b.c.s themselves were assumed infinitely differentiable, the transition maps are alsoC∞-maps. Moreover, ife3is the common edge of T andT′,ϕT′,TmapsE′, which is an open neighborhood ofe3inaff(T′), bijectively onto E, which is an open neighborhood ofe3inaff(T). In fact,ϕT′,Tis aC∞diffeomorphism onE′. Also, by (c),ϕT′,Tmaps points inE′that are interior toT′to points outside of T and vice versa (cf. Hahn, 1989).The above definition suggests that instead of constructing a spline space using an unknown smooth surface Σ, one could construct smooth functions and surfaces by parametrizing them by the piecewise linear surface Ω. The sought-for space of such spline functions, generalizing (1), will be denoted asSnm(Δ,Φ), where Φ stands for the collection of all transition maps associated with Δ, i.e.,Φ:={ϕT′,T;T,T′∈Δare adjacent}.Thus, a spline inSnm(Δ,Φ)will be a collection{fT}T∈Δof appropriately defined (scalar or vector) functions, such that functions corresponding to neighboring triangles are joined with a prescribed order of continuity in the sense of Definition 1. Consequently, the fact that mapsϕT′,Thave been constructed using hypothetical b.c.s becomes irrelevant. However, while there are ways of defining these maps without relying on the existence of b.c.s, we will see in the next section that this existence will motivate our choice of the transition maps.After appropriate transition maps have been selected, splines inSnm(Δ,Φ)can be used to modelCm-surfaces that are homeomorphic to Ω. In particular, functionsfTcan be chosen as three-dimensional vector functions and, as a result, the graph of the spline will be a surface consisting of surface patches of the form{fT(v),v∈T}. These patches will then give rise to a compositeCm-surface, because neighboring surface patches in this collection will join together smoothly in the usual parametric sense after one patch has been reparametrized using the reparametrizationϕT′,T. Note that a reparametrization of a surface does not change its physical shape inR3.We point out that the above idea of using transition maps or reparametrizations in connection with building smooth surfaces is not new. Therefore, a few historical remarks on other existing methods that employ the same general construction principle are given in Section 6.As is clear from the previous section, our approach to generalizing splines has two main ingredients: the construction of transition mapsϕT′,Tand the selection of an appropriate analogρnof the space of polynomialsπn. In this section we address the first problem.It turns out that the mappingϕT′,Tdefined by (4) can be expressed explicitly. To this end, we coordinatize the planesaff(T)andaff(T′)by representing their points in terms of the planar b.c.s,b=(b1,b2,b3)tandb′=(b1′,b2′,b3′)t, w.r.t. triangles T andT′. Consequently,ϕT′,Tcan be viewed as a mapping from the affine planeA:={(b1,b2,b3)∈R3|b1+b2+b3=1}into itself. We will abuse notation and use the symbolϕT′,Tto mean both a mapping of typeaff(T′)→aff(T), but alsoA→A. The common edge,e3, of T andT′, corresponds to the line segmenta:={(b1,b2,0)|b1+b2=1,b1,b2⩾0}⊂A. WhenϕT′,Tis viewed as a mapping fromAto itself, then this mapping is the identity on a. We next show thatϕT′,Thas a particular form.Proposition 1The transition mapϕT′,Tdefined by(4)is a linear rational transformation of the form(5)ϕT′,T:b′↦b=ΛT′,Tb′1ΛT′,Tb′,where1:=(1,1,1),(6)ΛT′,T=(10λ101λ200λ3),and whereλ1,λ2,λ3are real numbers, withλ3<0.Before proving the result, we make a few preliminary remarks. The conditionλ3<0is crucial since it means that the interior of the triangleT′is mapped to a region exterior to T. We also note that the above mapping is always well defined, bijective, and regular in an open neighborhoodE′of the common edgee3, i.e., in a strip{(b1′,b2′,b3′)|b1′+b2′+b3′=1,b1′,b2′>−δ,b3′∈(−δ,δ)}⊂A, for someδ>0, containing the line segment a.Proof of Proposition 1To derive formula (5), consider again spacesLandL′, the linear spans of hypothetical b.c.s on trianglesT,T′of Σ. One can show that for eachℓ∈L,(7)ℓ(u)=β1(u)ℓ(u1)+β2(u)ℓ(u2)+β3(u)ℓ(u3),u∈T.Given thatβ1,β2,β3form a basis forL, one hasℓ=β1c1+β2c2+β3c3, for somec1,c2,c3∈R. Thus (7) follows from(8)βi(uj)=δij,i,j=1,2,3.Assuming the continuation property of functions inL, anyℓ∈Lhas a uniqueC∞-extension toT′as a function ofL′and hence, we can also think of ℓ as an element ofL′. More precisely, if we use the same notation for the extension of ℓ toT′, we haveℓ|T′∈L′. In particular, the b.c.sβ1,β2,β3can be viewed as elements ofL′, and therefore, by (7) (applied to triangleT′instead ofT), we haveβl(u)=β1′(u)βl(u1)+β2′(u)βl(u2)+β3′(u)βl(u3′),u∈T′,l=1,2,3,or, taking into account (8) and recalling thatu1andu2belong to the common edge ofTandT′(see Fig. 3),β=(β1β2β3)=(10β1(u3′)01β2(u3′)00β3(u3′))(β1′β2′β3′)=:(10λ101λ200λ3)(β1′β2′β3′)=ΛT′,Tβ′.The fact thatb=β/1βandb′=β′/1β′readily gives formula (5), whereλ3=β3(u3′)<0, by property (c) of Section 2.  □Identity (5) is crucial in our considerations since it compels us to choose the reparametrizationsϕT′,Tas linear rational transformations. Although, as we have seen above, our motivation for considering such transformations came from the idea of b.c.s on surfaces (and, in particular, the spherical b.c.s on the 2-sphere), this fact will be largely immaterial in the following. Indeed, there are other important reasons, described below, why linear rational transformations are appropriate and why they seem to fit perfectly our objective of finding a meaningful generalization of the spline space (1).Let us first elaborate in more detail on conditions for triplesλ1,λ2,λ3, guaranteeing the existence of linear rational transformations for the entire triangulation Δ. There is one such triple for each edge of Δ. These triples must be such that the associated transformationsϕT′,Tsatisfy:(A)in the vicinity of the common edgee3,ϕT′,Tis a regular map of the form (5), for all pairsT,T′∈Δof neighboring triangles, i.e.,λ3<0;ifT,T′,T″,…,T(l)are the triangles of Δ sharing a common vertexv¯(ordered counterclockwise), then the compositionϕT′,T∘ϕT″,T′∘⋯∘ϕT,T(l)is the identity in a neighborhood N ofv¯;for allv∈N\{v¯}, the sum of the angles between pairs of consecutive line segments from the set{v¯v,v¯v′,…,v¯v(l),v¯v}is 2π, wherev(k):=ϕT(k−1),T(k)v(k−1),k=1,…,l, withv(0):=v,T(0):=T.One reason why linear rational transformations constitute a good choice of transition maps is that transformations satisfying conditions (A)–(C) are guaranteed to exist for any triangulation Δ. This follows from the well-known fact that all surfaces can be equipped with a real projective structure. It is also a consequence of a familiar result that all surfaces can be endowed with a homogeneous geometry, i.e. either hyperbolic, spherical, or affine, for which the transition functions are known to be linear rational.A special case of such rational transformations are affine transformations. Note that if affine transformations exist for Δ, then any two adjacent trianglesT,T′∈Δcan be thought of as being coplanar and hence generalizing (1) is straightforward. However, a closed surface inR3cannot be equipped with an affine structure unless it is a torus or a Klein bottle. On the other hand, it is known that by merely removing a single vertex from the triangulation, such affine transition maps can be found. This suggests that one does not have to go too far in generalizing affine transformations to be able to handle general surfaces. Clearly, linear rational transition maps are the next best thing to affine maps and so it is natural to consider them. In addition to the fact that such transformations can always be found, linear rational transformations will also offer more freedom than affine transformations to select appropriate parametersλ1,λ2,λ3. Note that a transformation of type (5) is affine ifλ1+λ2+λ3=1. Thus, by removing this condition, one gains an extra degree of freedom for each edge of Δ.Using rational reparametrizations also makes sense from the point of view of our advertised hope that the appropriate generalization of splines will employ piecewise rational functions. In particular, suppose that the restrictions of such generalized splines to adjacent trianglesT,T′are rational functions of typen/n, i.e. of the formpn/qnandpn′/qn′, wherepn,qn,pn′,qn′∈πn. By the continuation property, each rational function of the formf=pn/qnon T can be uniquely extended toT′and this extension is of the formf′=pn′/qn′. Thus, f composed withϕT′,Tmust be equal tof′, at least in a neighborhood of the common edge. Clearly, there are no better candidates forϕT′,Tthan linear rational transformations, which are of type 1/1, since composing a rational function of typen/nwith a function of type 1/1 is again of typen/n.The remainder of this section will be devoted to yet another justification for utilizing transformations (5). It will be argued that linear rational transformations are in fact an inevitable consequence of two assumptions made previously: that the sought-for splines are locally parametrized by planar triangles and that the spline space should closely resemble the spaceSnm(Δ)in (1). Namely, locally the generalized splines should belong to a spaceρn, which is analogous toπnin that functions inρnshould admit a B-representation with respect to any given triangle. Because of this property ofπn, it is possible to subdivide splines inSnm(Δ)by refining Δ and by expressing individual polynomial pieces in the B-form w.r.t. the refined triangulation. It turns out that this property limits the available choices forρnconsiderably.Let us first consider the casen=1. In order for elements ofρ1to admit a B-representation for any given triangle,ρ1has to contain b.c.s with respect to that triangle. In particular, for any edge e of the triangle, the spaceρ1has to contain a nonzero function vanishing on e. Thus,ρ1has to be such that for any straight line inA(which is used to parametrizeaff(T), for any givenT∈Δ) there exists a nontrivial function inρ1vanishing along that line. One can show that any such spaceρ1has to have the formhπ1, where h is a scalar function onA. This means that a spaceρ1with the above property is unique up to a multiplicative factor.Next suppose thatT,T′are adjacent triangles in Δ and thatf∈ρ1Tis defined on T, whereρ1Tdenotes a copy ofρ1associated with T. By the continuation property, f can be extended toT′. Iff′∈ρ1T′is this extension, then, as we know already,f=f′∘ϕT,T′. We now claim that the mappingϕT′,Tmust map lines to lines since if this were not the case then there would be a linee′⊂Amapped to a sete⊂A, containing at least three points that are not collinear. LetT¯⊂aff(T)be the triangle whose vertices are these three points. Consider now a specific nonzero functionf′∈ρ1T′, which vanishes alonge′. Hencef∈ρ1Tis not identically zero and vanishes on e, and therefore also at the vertices ofT¯. Consequently,ρ1Tdoes not admit a B-representation onT¯. For otherwise there would exist b.c.s forT¯and thus any function fromρ1T, vanishing at its vertices, would have to be identically zero, which would contradict that f is nonzero.The above shows thatϕT′,Tmaps lines to lines and therefore it is a collineation. As is well known, collineations are projective transformations and, as a result, they are linear rational transformations. This shows that such transformations are the only mappings that qualify for constructing adequate analogs of (1).Another consequence of the above discussion is that sinceρnis obtained as the linear span of products of functions inρ1(given that we assume that functions inρnadmit a B-representation), the spaceρnhas the form:(9)ρn=hnπn,n⩾1.Assume that a collection Φ of linear rational transition maps of type (5) has been determined for a given triangulation Δ, satisfying conditions (A)–(C) of the previous section. To define splines for Δ, we will require that they are piecewise rational functions and such that, when restricted to any triangle of Δ, they belong to the spaceρn:={rn=pnqn;pn,qn∈πn}.Consequently, each such function on a triangleT∈Δcan be expressed in the B-form:rnT=pnTqnT=∑cijkTBijkn∑wijkTBijkn,cijkT,wijkT∈R,whereBijkn=n!i!j!k!b1ib2jb3kare the usual Bernstein basis polynomials andb1,b2,b3are the planar b.c.s associated with T. The above functions can now be used as building blocks for splines defined over Ω.Definition 2The spline spaceSnm(Δ,Φ)of degree n and continuity of order m, associated with triangulation Δ and transition maps Φ, is defined asSnm(Δ,Φ):={f∈Cm(Ω);f|T∈ρn,T∈Δ}.Thus, functions belonging to this space, which will be called Rational Geometric Splines (RAGS), are functions of typef:Ω→R. Therefore, they can be thought of as being parametrized by the piecewise linear surface Ω whose facets are the triangles of Δ. These functions areCm-smooth in the sense of Definition 1 and w.r.t. the given transition maps Φ. Note thatSnm(Δ,Φ)defined above is not linear. To make it into a linear space, one can fix the denominatorsqnTof the rational functions defining the spline. If Q is the set of all such fixed polynomialsqnT, the resulting subset ofSnm(Δ,Φ)will be denoted bySnm(Δ,Φ,Q), which is a linear space.The central question before us is whetherSnm(Δ,Φ)shares important properties with the classical spaceSnm(Δ). In particular, is it reasonable to expect that appropriate weightswijkTof polynomialsqnTcan be found, guaranteeing that the resulting spaceSnm(Δ,Φ,Q)contains nontrivial smooth functions? The answer to this question is that the situation is essentially the same as in the standard spline case.To explain, we will first consider the following auxiliary problem. Suppose that p is a B-polynomial of degree n w.r.t. a planar triangle and suppose that the barycentric coordinates b for that triangle are transformed by a linear transformation,b↦Λb, where Λ is a matrix of the form (6). The next lemma gives a formula for the B-coefficients ofp(Λb). Note that in general the vectorb′:=Λbdoes not represent planar b.c.s since its components may not add up to one. In that casep(b′)=p(Λb)is still well defined if the Bernstein basis polynomialsBijknare interpreted as homogeneous trivariate polynomials.Lemma 1Let Λ be a matrix of the form(10)Λ=(10λ101λ200λ3)and letp(b)=∑dijkBijkn(b)andp′(b)=∑dijk′Bijkn(b). Thenp′(b)=p(Λb),∀b∈A,if and only if(11)dijk′=∑r+s+t=kdi+r,j+s,tBrstk(λ),for alli,j,ksuch thati+j+k=n, whereλ=(λ1,λ2,λ3)t.ProofThis result is well known in the affine case, i.e. whenλ1+λ2+λ3=1, and was proved by de Boor (1987). The proof for the caseλ1+λ2+λ3≠1is still the same.  □In the affine case, the result has a well-known interpretation. Suppose thatT,T′are adjacent triangles in the plane with verticesv1,v2,v3andv1,v2,v3′, and suppose that a polynomial p is given in the B-form w.r.t. triangle T. Then p can be expressed in the B-form corresponding to triangleT′. Lemma 1 shows how to express the B-coefficients of p w.r.t.T′. Namely, the vector λ in (11) should be such that its components are the b.c.s ofv3′w.r.t. T, since this is precisely when the transformationb↦Λbmaps b.c.s ofT′to b.c.s of T.In spline theory, this lemma is used to impose smoothness conditions between polynomials on adjacent triangles. In particular, if p andp′are polynomials on T andT′, respectively, they will join withCm-continuity along the common edge if and only if (11) holds, for alli,j,ksuch thati+j+k=nandk=0,…,m. This follows from the lemma using standard facts about B-polynomials. ForC0-continuity, this means that the B-coefficients associated with the common edge should be the same for both polynomials, i.e.dij0′=dij0,i+j=n. ForC1-continuity, identity (11) implies that one needs to impose conditions on the “second row” of B-coefficients, namely (see Farin, 2002 and Hoschek and Lasser, 1993)dij1′=λ1di+1,j,0+λ2di,j+1,0+λ3di,j,1,i+j=n−1.We now return toCm-continuity conditions for rational splines and general linear rational transformations, whenλ1+λ2+λ3is not necessarily equal to one. Sufficient conditions for joining two adjacent rational patches withCm-continuity are spelled out in the followingProposition 2LetT,T′∈Δbe adjacent triangles and let Λ be the matrix of the form(10), corresponding to the linear transition mapϕT′,T. Letrn=pnqn=∑cijkBijkn∑wijkBijkn,rn′=pn′qn′=∑cijk′Bijkn∑wijk′Bijknbe rational functions associated withT,T′, where(12)cijk′=∑r+s+t=kci+r,j+s,tBrstk(λ)and(13)wijk′=∑r+s+t=kwi+r,j+s,tBrstk(λ),for all indices such thati+j+k=n,k=0,…,m,m⩾0. Thenrn,rn′join withCm-continuity along the common edgee3ofT,T′.ProofThe proof follows along standard lines and is a direct consequence of Lemma 1 and the subsequent discussion. More precisely, Definition 1 prompts us to consider the functionrn∘ϕT′,T, which can be written as(rn∘ϕT′,T)(b)=pn(Λb/1Λb)qn(Λb/1Λb)=pn(Λb)/(1Λb)nqn(Λb)/(1Λb)n=pn(Λb)qn(Λb),where we used the fact thatpn,qnare homogeneous of degree n and that in the vicinity of the common edge,1Λb>0. By Lemma 1, the last expression above can be written aspn(Λb)qn(Λb)=∑c¯ijkBijkn∑w¯ijkBijkn,where the B-coefficients satisfyc¯ijk=∑r+s+t=kci+r,j+s,tBrstk(λ),w¯ijk=∑r+s+t=kwi+r,j+s,tBrstk(λ),for alli+j+k=n. By Definition 1, we need to verify that the rational functionsrn∘ϕT′,Tandrn′, or∑c¯ijkBijkn∑w¯ijkBijknand∑cijk′Bijkn∑wijk′Bijkn,and their derivatives up to order m agree along the common edge. However, this follows from the fact that by (12) and (13), one hascijk′=c¯ijkandwijk′=w¯ijk, as long ask⩽m, and the well-known fact that the B-coefficientsdijk,k>m, of a B-polynomial∑dijkBijkndo not influence derivatives of orders m or less along edgee3. This shows thatrn=pn/qnandrn′=pn′/qn′are joined withCm-continuity.  □Consistent with the above result, the B-coefficients ofpn,qnwill be assumed to be equal to those ofpn′,qn′along the common edge, i.e.,cij0=cij0′,wij0=wij0′,i+j=n,which ensures aC0-continuous join of the two rational patchesrn,rn′. In general, a consequence of Proposition 2 is that smoothness conditions for the numeratorspnand the denominatorsqnof the rational functions can be separated from one another. These conditions are linear and homogeneous and the only difference with the classical spline case is that the numbersλ1,λ2,λ3in (12) and (13) need not sum to one.Since the defined splines are assembled from rational patches, it is not surprising that one can define the concept of a control net for them. To construct surfaces inR3, we will consider B-coefficientscijk∈R3which have a special form, namelycijk=dijkwijk(see Farin, 2002 and Hoschek and Lasser, 1993).Definition 3Lets∈Snm(Δ,Φ)be a spline, whose rational piecesrnT=s|T,T∈Δ, are of the formrnT=pnTqnT=∑dijkTwijkTBijkn∑wijkTBijkn,wheredijkT∈R3andwijkT∈R. Then the pointsdijkTare called the control points or Bézier points of the rational patchrnT.It is well known that functionsrnTof the above form have several useful properties that make them suitable for CAGD. For example, it is easily seen that the patchrnTinterpolates the control pointsdn00T,d0n0T,d00nT, that the control net, i.e., the usual piecewise linear interpolant of the control points{dijk}i+j+k=n, has the convex hull property (ifwijkT>0,i+j+k=n), and points on the surface patchrnTcan be evaluated by a de Casteljau algorithm (Farin, 2002).To further illustrate the resemblance of rational and polynomial splines, we finish this section with a geometric interpretation of theC1-continuity conditions of Proposition 2.Proposition 3Letrn=pnqn=∑dijkwijkBijkn∑wijkBijkn,rn′=pn′qn′=∑dijk′wijk′Bijkn∑wijk′Bijknbe rational functions associated withT,T′, with positive weightswijk,wijk′, and such that(14)dij0′=dij0,wij0′=wij0,i+j=n,wij1′=λ1wi+1,j,0+λ2wi,j+1,0+λ3wi,j,1,i+j=n−1,and(15)dij1′=μi+1,j,0di+1,j,0+μi,j+1,0di,j+1,0+μi,j,1di,j,1,i+j=n−1,whereμi+1,j,0:=λ1wi+1,j,0/(λ1wi+1,j,0+λ2wi,j+1,0+λ3wi,j,1),μi,j+1,0:=λ2wi,j+1,0/(λ1wi+1,j,0+λ2wi,j+1,0+λ3wi,j,1),μi,j,1:=λ3wi,j,1/(λ1wi+1,j,0+λ2wi,j+1,0+λ3wi,j,1).Thenrn,rn′join withC1-continuity along the common edge ofT,T′.ProofSettingcijk=dijkwijk,cijk′=dijk′wijk′, and using (14), identity (15) can be rewritten ascij1′=λ1ci+1,j,0+λ2ci,j+1,0+λ3ci,j,1,i+j=n−1.This shows that (12) holds fork=1and the claim now follows from Proposition 2.  □On account ofμi+1,j,0+μi,j+1,0+μi,j,1=1,C1-continuity conditions for two adjacent rational functionsrn,rn′have the familiar geometric interpretation that the control pointsdij1′,di+1,j,0,di,j+1,0,di,j,1are coplanar, fori+j=n−1. This generalizes a well-known result for piecewise polynomials. However, in that special caseμi+1,j,0=λ1,μi,j+1,0=λ2,μi,j,1=λ3, i.e., these coefficients do not depend oni,j.Considerations in this section lead to the following recipe for building splines. Once an appropriate collection of transition maps Φ has been found, a set of weightswijksatisfying (13) is determined for each triangle of Δ, which in turn gives rise to a spline spaceSnm(Δ,Φ,Q). In the next section we briefly describe how this general prescription can be used to obtain smooth surfaces.We will illustrate the proposed idea with two examples demonstrating the possibility of effectively constructing RAGS surfaces of high smoothness and arbitrary topology. We will content ourselves with a schematic description of the construction, and delegate the technical details to a separate paper.We consider initial triangular meshes Ω, depicted in Figs. 5(a) and 6(a) and interpolate them by smooth RAGS surfaces parametrized by Ω. The resulting interpolants, displayed in Figs. 5, 6(c–f), are elements of the spacesS62(Δ,Φ)andS104(Δ,Φ), respectively. Their control nets can be seen in Figs. 5, 6(b).The first step in setting up the spline space is to determine, for each pair of neighboring trianglesT,T′, linear rational transformationsϕT′,T, identified by parametersλ1,λ2,λ3. In the current examples, these were obtained by using a homogeneous geometry as follows. Since the surfaces are of genusg>1, the initial triangulation Δ is in both cases equipped with the hyperbolic geometry, by associating Δ with a combinatorially equivalent hyperbolic triangulationΔH(of course, a spherical triangulation should be used wheng=0, while forg=1, Φ should be chosen as a collection of affine transformations). The triangulationΔHcan be completely described by a collection of anglesα1T,α2T,α3T,T∈Δ, where each tripleα1T,α2T,α3Tcorresponds to interior angles of a triangle in the hyperbolic plane. Such a hyperbolic triangle is uniquely determined by these angles up to a similarity transformation. These triples of angles describe a consistent hyperbolic triangulationΔHif the following conditions hold (see Ratcliffe, 2007):(i)the sum of the areas of all triangles inΔHis4π(g−1);the sum of the angles surrounding each vertex is 2π;common sides of adjacent triangles inΔHhave equal lengths.In our examples, the hyperbolic triangulationΔHwas determined through a simple iterative procedure, which starts from an initial set of angles satisfying conditions (i) and (ii) and which then adjusts the angles iteratively in order to satisfy (iii). A detailed discussion of this and related aspects of the construction is beyond the scope of this paper and will be postponed to another occasion.OnceΔHhas been found, the transition maps can be read off this triangulation as follows. For each pair of neighboring trianglesT,T′∈Δ, corresponding to anglesα1,α2,α3andα1′,α2′,α3′, we determine two adjacent triangles in the hyperbolic plane having these angles and with vertices labeled byu1,u2,u3andu1,u2,u3′, as depicted in Fig. 4. The sought-for valuesλ1,λ2,λ3are then the hyperbolic or homogeneous (Alfeld et al., 1996a) b.c.s ofu3′w.r.t. the triangle〈u1,u2,u3〉, that is,u3′=λ1u1+λ2u2+λ3u3.Note that a pair of adjacent hyperbolic triangles corresponding to anglesα1,α2,α3andα1′,α2′,α3′is determined uniquely up to a similarity transformation. Hence each such pair will give rise to the same triple of homogeneous b.c.sλ1,λ2,λ3.We remark that although we used a hyperbolic geometry to determine the linear rational transformations in the above examples, in general we do not advocate the use of homogeneous geometry. This approach, in fact, unnecessarily restricts the class of available transformations. Moreover, in a homogeneous geometry, the problem of finding appropriate transition maps becomes global in nature. As a consequence, local modifications to the triangular mesh, for example adding a handle or some other local feature to the surface, require solving the global problem of computing the transition maps for the entire modified triangulation Δ. In this way, the entire spline space would need to be altered, as opposed to the preferable approach of changing it locally in modified regions of the mesh.Once appropriate transition maps Φ have been selected, the next constructive step is to obtain a spline from the spaceSnm(Δ,Φ)that meets prescribed objectives. In our examples, we sought a parametric spline from spacesS62(Δ,Φ),S104(Δ,Φ), interpolating the vertices of the given mesh. The orders of smoothnessm=2,4were chosen to demonstrate that a high order of continuity is not a hindrance. Note that for methods based on the stitching-patches-together approach, alreadyC2-continuity represents a major hurdle. Like in all spline-based methods (see Lai and Schumaker, 2007), suitable spline degrees, in our casen=6,10, need to be chosen to allow sufficient flexibility of the splines to meet the smoothness constraints. The Bézier points of the spline,dijkT∈R3, and the weightswijkT∈Rhave been computed such that the resulting spline interpolates the vertices of the mesh, isC2andC4-smooth, and “fair”. The last objective was achieved by minimizing a fairness or energy functional based on the Laplace operator. Overall, the procedure is formally the same as that pursued in the classical bivariate spline setting. To be sure, this is true for a number of other methods we have tested, which are direct adaptations of available methods for bivariate splines. These will be reported elsewhere.

@&#CONCLUSIONS@&#
