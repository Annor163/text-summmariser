@&#MAIN-TITLE@&#
A hybrid classifier committee for analysing asymmetry features in breast thermograms

@&#HIGHLIGHTS@&#
An effective approach to analysing breast thermograms for breast cancer diagnosis is presented.Image features describing bilateral asymmetry are used in a classification stage.A multiple classifier system based on neural networks/support vector machines as base classifiers, balanced subspaces to address class imbalance, a neural network fuser and a fuzzy diversity measure is presented.Experimental results show excellent classification performance on a challenging dataset and statistical superiority compared to other ensemble classifiers.

@&#KEYPHRASES@&#
Breast cancer,Thermography,Pattern classification,Imbalanced classification,Multiple classifier system,Image features,

@&#ABSTRACT@&#
Breast cancer is the most commonly occurring form of cancer in women. While mammography is the standard modality for diagnosis, thermal imaging provides an interesting alternative as it can identify tumors of smaller size and hence lead to earlier detection. In this paper, we present an approach to analysing breast thermograms based on image features and a hybrid multiple classifier system. The employed image features provide indications of asymmetry between left and right breast regions that are encountered when a tumor is locally recruiting blood vessels on one side, leading to a change in the captured temperature distribution. The presented multiple classifier system is based on a hybridisation of three computational intelligence techniques: neural networks or support vector machines as base classifiers, a neural fuser to combine the individual classifiers, and a fuzzy measure for assessing the diversity of the ensemble and removal of individual classifiers from the ensemble. In addition, we address the problem of class imbalance that often occurs in medical data analysis, by training base classifiers on balanced object subspaces. Our experimental evaluation, on a large dataset of about 150 breast thermograms, convincingly shows our approach not only to provide excellent classification accuracy and sensitivity but also to outperform both canonical classification approaches as well as other classifier ensembles designed for imbalanced datasets.

@&#INTRODUCTION@&#
Breast cancer is the most commonly occurring form of cancer in women and accounts for about 30% of all cases [3]. While the standard modality to detect breast cancer is mammography, thermal imaging provides an interesting alternative [4,20]. Thermography uses cameras with sensitivities in the thermal infrared to capture a picture of the temperature distribution of the human body or parts thereof. In contrast to other modalities such as mammography, it is a non-invasive, non-contact, passive and radiation-free technique. The radiance from human skin is a function of the surface temperature which in turn is influenced by the level of blood perfusion in the skin. Thermal imaging is hence well suited to pick up changes in blood perfusion which might occur due to inflammation, angiogenesis or other causes [22]. Asymmetrical temperature distributions as well as hot or cold spots are known to be strong indicators of an underlying dysfunction [38].Importantly, it has been shown that thermography has advantages over mammography when detecting tumors in early stages or in dense tissue. Early detection is crucial as it provides significantly higher chances of survival [18] and in this respect infrared imaging outperforms the standard method of mammography. While mammography can detect tumors only once they exceed a certain size, smaller tumors can be identified using thermography due to the high metabolic activity of cancer cells which leads to an increase in local temperature that can be picked up in the infrared. The average tumor size undetected by mammography is 1.66cm compared to only 1.28cm by thermography [24].While diagnosis is typically performed manually by experts, there is a high demand for automated methods in order to provide an objective decision that can also be used as a second, unbiased, opinion.Several such computer aided diagnostic (CAD) approaches have been presented in the literature. In [33], an attempt based on asymmetry analysis is presented where, following segmentation based on edge detection and the Hough transform, Bezier histograms are generated and compared to identify cancer cases. In [36], some basic statistical features are extracted and fed to a complementary learning fuzzy neural network (CLFNN) for diagnosis. [37] proposes morphological analysis of “localised temperature increase” amplitudes in thermograms to detect tumors. A series of image features from the breast regions were extracted in [35] and subsequently analysed by a fuzzy classification method. The approach in [7] is based on transforming the thermogram into a representation derived from independent component analysis, thresholding and correlating the obtained channels to locate tumor areas. In [1], texture features and support vector machine classifiers are employed, while in [31] wavelet and texture descriptors are employed in combination with several classification algorithms.In this paper, we present an effective approach to analysing breast thermograms for cancer diagnosis. As cancer tumors recruit local blood vessels, this will lead to a change in the temperature pattern of the affected area. We therefore derive a set of image features that describe possible asymmetries between the bilateral breast regions to capture this effect. These features are then used in a pattern classification stage for which we employ a multiple classifier system. Multiple classifier systems (MCSs), ensemble classifiers or classifier committees, perform classification not based on a single algorithm but based on a joint decision of a pool of classifiers [29]. MCSs are considered one of the most promising trends in pattern recognition [41], being able to outperform single-model approaches when it comes to accuracy [13], robustness [27] or effective implementations [12]. They have also proven themselves as an effective tool for medical decision support systems, with numerous reports describing their superior performance over standard machine learning methods for tasks such as tumor malignancy grading [21], cytological image analysis [16] or microarray analysis [32] amongst many others.Our ensemble classifier is based on a hybridisation of three computational intelligence techniques. As base classifiers we employ neural networks or support vector machines. The individual classifiers are combined using an fuser implemented as a one-layer perceptron neural network. Finally, we remove redundant classifiers through an ensemble diversity measure based on fuzziness using an energy approach. Importantly, we also address the problem of class imbalance that often occurs in medical data analysis and might lead to biased decision making. We do this by training the individual base classifiers on balanced data subsets, thus eliminating any unfavourable class distribution.The main contributions of our presented work are as follows:•a hybrid decision support system, applied to the challenging task of breast cancer detection on a large dataset of thermograms;a novel classifier ensemble, dedicated to imbalanced classification;a method for generating base classifiers on the basis of object bags, consisting of the entire minority class and an equal number of randomly sampled objects from the majority class, to counter the unfavourable class distribution;a method for promoting best classifiers from the pool to boost minority class recognition rate, based on a novel diversity measure and a trained neural fuser.Our experimental results, on a dataset of about 150 breast thermograms, show convincingly that our proposed approach works well and gives excellent classification performance. Moreover, it is shown to statistically outperform canonical classifiers and recent classifier ensembles that are also dedicated to imbalanced classification, as well as to give clearly improved performance compared to prior published approaches on the same dataset.The remainder of the paper is organised as follows. In Section 2, we describe the set of image features we extract from the breast thermograms. Our classification approach is presented in Section 3, while experimental results are given in Section 4. Section 5 concludes the paper.As has been shown [33], an effective approach to automatically detect cancer cases is to study the symmetry between left and right breast regions in the captures thermograms. In the case of cancer presence, the tumor will locally recruit blood vessels resulting in hot spots and a change in vascular pattern, and hence an asymmetry between the temperature distributions of the two breasts. On the other hand, symmetry typically identifies healthy subjects.We follow this approach and segment (manually) the areas corresponding to the left and right breast from thermograms taken in frontal view. Once segmented, image features then need to be derived that can be employed in a decision making stage [8]. For this, we convert the breast regions to a polar co-ordinate representation to simplify the calculation of several of the features that we employ. A set of image features are then calculated to provide indications of symmetry between the regions of interest (i.e. the two breast areas) [35].The simplest feature to describe the temperature distribution captured in thermograms is to calculate its statistical mean. As we are interested in symmetry features, we calculate the mean for both breasts and use the absolute difference between the two. Similarly, we calculate the standard temperature deviation and use the absolute difference as a feature. Furthermore, we employ the absolute differences of the median temperature and the 90-percentile.Image moments [17] are defined as(1)mpq=∑y=0M−1∑x=0N−1xpyqg(x,y),where x and y define the pixel location and N and M the image size. We utilise moments m01 and m10 which essentially describe the centre of gravity of the breast regions, as well as the distance (both in x and y direction) of the centre of gravity from the geometrical centre of the breast. For all four features we calculate the absolute differences of the values between left and right breast.Histograms record the frequencies of certain temperature ranges of the thermograms. We construct normalised histograms for both regions of interest (i.e. left and right breast) and use the cross-correlation between the two histograms as a feature. From the difference histogram (i.e. the difference between the two histograms) we compute the absolute value of its maximum, the number of bins exceeding a certain threshold (0.01 in our experiments), the number of zero crossings, energy and the difference of the positive and negative parts of the histogram.Co-occurrence matrices have been widely used in texture recognition tasks [19] and can be defined as(2)γTi,Tj(k)(I)=PRp1∈ITi,p2∈I[p2∈ITj,|p1−p2|=k],with(3)|p1−p2|=max{|x1−x2|,|y1−y2|},where Tiand Tjdenote two temperature values and (xk, yk) denote pixel locations. In other words, given a temperature Tiin the thermogram, γ gives the probability that a pixel at distance k away is of temperature Tj. In order to arrive at an indication of asymmetry between the two sides we adopted this concept and use the cross co-occurrence matrix [44] defined as(4)γTi,Tj(k)(I(1),I(2))=PRp1∈I(1)Ti,p2∈I(2)[p2∈I(2)Tj,|p1−p2|=k],i.e. temperature values from one breast are related to temperatures of the second side. From this matrix we can extract several features [19], the ones we are using are(5)HomogeneityG=∑k∑lγk,l1+|k−l|,(6)EnergyE=∑k∑lγk,l2,(7)ContrastC=∑k∑l|k−l|γk,l,and(8)SymmetryS=1−∑k∑l|γk,l−γl,k|.We further calculate the first four moments m1 to m4 of the matrix(9)mp=∑k∑l(k−l)pγk,l.The mutual information MI between two distributions can be calculated from the joint entropy H of the distributions and is defined as(10)MI=HL+HR+Hwith(11)HL=−∑kPL(k)log2pL(k)HR=−∑lPR(l)log2pR(l)H=∑k∑lPLR(k,l)log2pL,R(k,l),and(12)pLR(k,l)=xk,l∑k,lx(k,l)pL(k)=∑lpLR(k,l)pR(k)=∑kpLR(k,l),which we use as a further descriptor.Finally, we calculate the Fourier spectrum and use the difference of absolute values of the ROI spectra. The features we adopt are the difference maximum and the distance of this maximum from the centre.In summary, we characterise each breast thermogram using the following set of features: 4 basic statistical features, 4 moment features, 8 histogram features, 8 cross co-occurrence features, mutual information and 2 Fourier descriptors. We further apply a Laplacian filter to enhance the contrast and calculate another subset of features (the 8 cross co-occurrence features together with mutual information and the 2 Fourier descriptors) from the resulting images. In total, we hence compile a set of 38 descriptors per breast thermogram designed to describe the asymmetry between the two sides.In our approach, we employ an ensemble classifier, i.e. perform classification not based on a single algorithm but based on a joint decision of a committee of classifiers [29]. This way, we are able to exploit the strengths of different base classifiers while eliminating their weaknesses, thus leading to more robust and typically better classification performance.Given a pool of N classifiers Ψ(1), Ψ(2), …, Ψ(N), for a given feature vector x, each of the individual classifiers makes a decision with respect to class i∈M={1, …, M}. The classifier ensembleΨ¯then makes a combined decision based on(13)Ψ¯(x)=iifFˆ(i,x)=maxFˆ(k,x)k∈M,where(14)Fˆ(i,x)=∑l=1Nw(l)F(l)(i,x)and∑l=1Nw(l)=1,and F(l)(i, x) is a discriminant function for the i-th class with given value of x used by the l-th classifier.In cancer datasets, typically there are far fewer malignant cases recorded than there are benign ones. For pattern classification algorithms, this class imbalance poses a difficult challenge as it will typically bias the classifier towards the majority class. To avoid this, we will perform classifier training on balanced data subsets as explained in Section 3.2.Clearly, the weights used in Eq. (14) play a key-role in establishing the quality ofΨ¯. In our presented approach, we train a fuser to derive an optimal set of weights. For this purpose, we employ a one-layer perceptron neural network as detailed in Section 3.4.Ensemble learning methods work best when the generated committee is as heterogeneous as possible. Conversely, similar classifiers do not provide any additional contribution to the ensemble and might lower the committee's performance. Prior to classifier fusion, we consequently assess the diversity of the generated ensemble and remove redundant classifiers from the pool. We perform this based on a fuzzy diversity measure as explained in Section 3.3.While in principle any classification approach can serve as base classifier, in our approach we build ensembles of neural network (NN) or support vector machine (SVM) classifiers. For the NN classifier [5], we use the Quickprop algorithm for training, and set the number of hidden neurons to half the sum of input and output neurons. For the SVM classifier [39], we employ a Gaussian RBF kernel, and perform classifier tuning [23] to obtain optimal parameters.In medical diagnosis, there are typically far fewer malignant cases than there are benign ones, and consequently conventional classification approaches often suffer from low sensitivity due to the skewed class distribution. Class imbalance can be addressed in several ways, including oversampling of the minority class [11] and cost-sensitive classification [28].In our approach, we revert to neither of these, but employ our earlier method from [26] which is based on the principle of object space partitioning to train individual classifiers on balanced subsets of the training data.In particular, we create a number of subspaces using a random undersampling method. Each of the subspaces contains a smaller number of objects, randomly drawn from the dataset, so that the number of objects from each of the classes are equal. Objects of the minority class are randomly sampled and removed from the training set. Subspaces are then created as long as there are objects in the majority set. Each subspace forms the basis of one of the classifiers; that is, each base classifier is trained on a different (balanced) training subset, hence leading to a heterogeneous ensemble that addresses class imbalance.To boost recognition performance, a feature selection step is performed (separately for each classifier). For this purpose, we utilise the fast correlation-based feature filter (FCBF) [43]. In FCBF, the relations between features-classes and between pairs of features are considered. The algorithm proceeds at two levels. First, a ranking algorithm using the symmetric uncertainty coefficient index is employed to estimate class-feature relevance, and a threshold established to select predominant features. In the second part, features redundant to the predominant features are removed.Different base classifiers will have different areas of competence and hence may provide different contributions to the committee. Therefore, careful classifier selection should be conducted in order to choose the most valuable individual models. In this paper, we employ a classifier ensemble diversity measure for this purpose. In particular, we extend the energy-based fuzzy diversity measure introduced in [25] for one-class classification problems to multi-class classification.The proposed energy approach provides an effective measure of fuzziness. It uses a threshold λ∈[0, 1] whose role is to filter insignificant degrees of membership, that may otherwise lead to lowering the stability of the proposed measure. Given N base classifiers in the pool, out of which S classifiers correctly identify a given training object xj, one can define a fuzzy membership functionμxj=S/Nfor the given object, with0≤μxj≤1.Based on this, the employed energy measure is calculated as(15)DIV=∫X∑i=1Nfλ(x)dx,where(16)fλ(x)=f(x)⇔∑k=1Nδ(ΨikM(x),Ψ*(x))N>λ,and Ψ*(x) denotes a classifier correctly classifying object x, and f(x):[0, 1]→ R+ is an increasing function in interval [0, 1] for f(0)=0.The derived measure gives an indication of the diversity of the entire classifier committee in the range [0, 1], where 0 corresponds to an ensemble of identical classifiers and 1 to the highest possible diversity respectively.Diversity-based classifier selection is achieved by an exhaustive search over all possible combinations of committee members, and selecting the ensemble which yields maximal diversity.Classifier fusion is an important aspect of classifier ensembles, and the choice of fusion method, which is responsible for the collective decision making process, is hence crucial. Instead of using traditional approaches such as majority voting or static weight assignment, in this paper we utilise a dynamic approach to combine the outputs of base classifiers created on different object subspaces. In particular, we employ a trained fuser which, although taking longer to achieve its final performance, leads to an increase of the overall classification accuracy [15].Based on the training process, the fuser needs to identify W={W1, W2, …, WN} whereWa=[w(l)(1),w(l)(2),…,w(N)(M)]T, which consists of weights assigned to each classifier and each of the M classes.The aim is to find a fuser which assures the lowest misclassification rate ofΨ¯for which we employ a neural network with a canonical learning approach [42] as illustrated in Fig. 1. One perceptron fuser is constructed for each of the classes under consideration. The perceptron may be trained with any standard procedure used in neural network learning; the input weights established during the learning process are then the weights assigned to each of the base classifiers.

@&#CONCLUSIONS@&#
In this paper, we have presented an effective approach to analysing breast thermograms for cancer diagnosis. We derive a set of image features describing bilateral asymmetry from the thermograms, and use these as input to a pattern classification stage. For classification, we employ a hybrid classifier ensemble, using neural networks or support vector machines as base classifiers, a fuzzy diversity measure to eliminate redundant classifiers from the ensemble, and a neural network as a trained fuser, while creating individual classifiers on the basis of balanced training subsets to address class imbalance. Our proposed approach is shown to give excellent classification and sensitivity results on a dataset of about 150 thermograms. Moreover, it is shown to statistically outperform not only various canonical classifiers, but also several ensemble classifiers designed to address class imbalance, and to give better results compared to earlier approaches on the same dataset.