@&#MAIN-TITLE@&#
Application of a Time-Scale Local Hurst Exponent analysis to time series

@&#HIGHLIGHTS@&#
We present a method for estimating a time-scale local Hurst exponent on time series.The method has proven to be sensitive to sudden behavior changes on time series.Lower scales evaluate short-range correlations.Larger scales evaluate long-range correlations.The analysis evaluates pattern changes regardless the amplitude and scale.

@&#KEYPHRASES@&#
Time-Scale Local Hurst Exponent,Multi-scale rescaled-range analysis,Fractional Brownian motion series,Seismic traces,

@&#ABSTRACT@&#
This paper introduces a method to perform a Time-Scale Local Hurst Exponent (TS-LHE) analysis for time series. The traditional Hurst exponent methods usually analyze time series as a whole, providing a single value that characterizes their global behavior. In contrast, the methods based on the Local Hurst Exponent allow the evaluation of the fractal structure of a time series on local events. However, a critical parameter in these methods is the selection of scale. Here, a TS-LHE method is presented, based on a systematic implementation of the rescaled-range (R/S) method, in a set of sliding windows of different sizes. This method allows calculating instantaneous values of Local Hurst Exponents at different scales, associating them with individual samples of a time series. This paper is organized as follows: first, an overview of the TS-LHE is provided; then, a proof-of-concept of this analysis is presented, considering (a) different fractional Brownian motion series, (b) a synthetic seismic signal under different noise conditions, and (c) a group of real seismic traces. Finally, the obtained results show that the TS-LHE analysis is particularly sensitive to sudden behavior changes of the time series, such as frequency or phase variations. This sensitivity is independent of the amplitude of the data, and thus, it can be used to identify pattern changes as well as long- and short-range correlations within a time series.

@&#INTRODUCTION@&#
Fractal analysis has become a regular procedure for finding correlations in time series. Several different applications have been reported in the literature, in fields such as seismic analysis [1–3], economics [4–6], or medical applications [7–9]. Commonly, fractal analysis provides a means to measure signals complexity, by estimating the short or long-range correlations between values of the time series [10], independently of the amplitude of data [11].The Hurst Exponent is a parameter normally used to study self-similarities in time series. It is a value that indicates the level of persistence of the series, and is based on scaling-law statistics [7,12]. Several different methods have been proposed for estimating the Hurst Exponent, such as the Rescaled-Range (R/S) analysis method [4,13,14], the Detrended Fluctuation Analysis (DFA) [8,15], or the Fourier Spectral technique [16]. The main particularity of these methods is that they generally analyze the time series as a whole, providing a single value of Hurst Exponent that characterizes times series globally.Several approaches for estimating a Local Hurst Exponent (LHE) have been reported in the literature [1,2,6,17]. Mostly, they are based on a moving window that slides through the data, with or without overlapping, locally calculating the Hurst Exponent within each window. Hence, these methods are sensitive to the size of the window.This paper provides a systematic method for time-scale analysis of the Local Hurst Exponent. Such a method aids in the identification of changes in the scale properties of time series, detecting singular events by estimating short- and long-range correlations. Also, it can be used as an analysis tool to highlight frequency or phase variations in the series. In this method, the LHE is calculated for windows with different sizes, and plotted as a function of the position of each window within the time series, and of its size, by using a color code. As proof-of-concept, the method is applied to fractional Brownian motion series, and to seismic data.The performance of the TS-LHE method is compared here with the Continuous Wavelet Transform (CWT), which is a conventional method for analyzing time series. A fundamental difference between both methods is that CWT analyzes features of time series dependent on time and frequency, while the proposed TS-LHE method analyzes features dependent on time, and on short- and long-range correlations within the time series.The method here is related to the Hölder Exponent [18,19], since both can show the multifractal behavior of a time series, when there are different scaling patterns in it. However, the main difference is that the Hölder Exponent measures the strength of the scaling patterns, known as singularities, while the Hurst exponent measures the rate at which the correlation of neighbor samples change as the lag between them increases, that is, it is a long memory test for the time series [9].This paper is organized as follows: Section 2 describes the basics of the TS-LHE method; Section 3 presents some testing data sets: a group of fractional Brownian motions series, a synthetic seismogram under different noise conditions, and finally, a real seismic gather. Section 4 presents the results of the analysis. Finally, the last section provides some conclusions and remarks.Hurst introduces the rescaled-range (R/S) analysis [13] to study the hydrology of the Nile River, and particularly, to estimate the reservoir required to hold the floodwater. In order to compute the (R/S) method, first the time series (y(n),n=1,2,…,N) is divided into k non-overlapping segments (yk) of sizeT=⌊N/k⌋, withT∈Z+andk∈Z+. Notice that in this approach some samples may not be considered in the analysis, due to the round of T. Then, the method continues by calculating the mean values of each segmentyk:(1)yk¯=1T∑j=1Tyk(j),k=1,…,⌊N/T⌋.The integrated subseries departed from the mean are computed for each segmentykas:(2)ϕk(i)=∑j=1i(yk(j)−yk¯),i=1,2,…,T.To calculate the(R/S)T, associated to the size T, first the rangesRkare computed for each intervalϕk, and then, divided by the local standard deviationsSkof each original segments,yk:(3)Rk=max1≤i≤T(ϕ(i))−min1≤i≤T(ϕ(i)),(4)Sk=1T∑j=1T(yj−yk¯).Then, the mean rescaled-range for the corresponding T length is calculated:(5)(RS)¯T=1k∑j=1k(RjSj).These calculations are repeated for all possible segments sizes T. The statistics of(R/S)¯Tfollows a power law in relation to the T size:(6)(RS)¯T∝TH,where H is the Hurst scaling exponent, and it is calculated as the slope of the straight line that best fits(R/S)¯Ton a log–log plot. The Hurst exponent H is related to the fractal dimension of the seriesy(n)byD=2−H[3], and it can be interpreted as a measure of the correlation of neighbor samples.Computing theR/Sstatistics of a time series provides a single value, an estimation of the Hurst Exponent, which provides a global description of such a time series. Here, a systematic method to locally evaluate the Hurst Exponent is proposed, so a deeper insight of the behavior of the time series is obtained. This method allows studying the Hurst Exponent as a function of time and scale,H(n,Ws).The main idea within this method is to make use of a moving window (ΨWs) of different size, defined by Ws, that runs along the entire series. HavingΨWscentered at the i-th sample of the series, for a given size Ws, theR/Sis computed for all the samples within the windowΨWs. The obtained Hurst Exponent is treated as the Local Hurst exponentH(i,Ws)due to scale Ws on the i-th sample. The process implies sliding the window one sample each time, repeating the calculations until the end of the time series is reached. After this, Ws size is increased and the process is repeated again, until a defined maximum Ws is attained. Details of the procedure are described as follows:i)First, define the scale range (Wsmin,…,Wsmax) for which the TS-LHE is to be calculated. The purpose of these scales Ws is to define the extent to which the short- and long-range correlations in the time series are estimated. The minimum window size (Wsmin) can be as small as the minimum number of samples that theR/Smethod requires to estimate the exponent H (this is, the slope of the best line that fitsR/S). In the limit, a minimum of two points is required to estimate H. Thus,Wsmin=4. Here, it is suggested thatWsmin≥8, in order to have at least 4 points to estimate H.On the other hand, the maximum window size (Wsmax) defines the extent of the long-range analysis, and it can be larger than the actual number of samples of the time series under analysis (from an algorithmic point of view). However, the purpose of scales Ws is to evaluate correlations within the time series, and thus, settingWsmax>Nsimply does not contribute to the scope of this analysis. Based on this consideration:Wsmin<Wsmax≤N.A padded seriesyPad(n)is obtained by addingL=⌊Ws/2⌋reflected samples at each end-point of the time seriesy(n), as shown Fig. 1(A) and (B). Thus, the resulting length ofyPad(n)isN+2L. Padding considerations are discussed later, at the end of this section.(7)yPad(n)={y(L+1),y(L),…,y(2),y(n),y(N−1),y(N−2),…,y(N−L)};wheren=1,…,N+2L.The sliding windowΨWs(ns)is defined forns=1,…,Ws; it is centered at the j-th sample ofyPad(n), which is aligned with the i-th sample ofy(n), as it is illustrated on Fig. 1(A) and (B).For each sliding windowΨWs(ns), the corresponding(R/S)¯is calculated. The resulting Hurst Exponent is the Local Hurst Exponent,H(i,Ws), associated to the i-th sample ony(n), and a window size Ws, as shown in Fig. 1(C).Move the windowΨWs(ns)one sample onyPad(n), starting at samplej=1and ending atj=N−L, as shown on Fig. 1(B). The idea is to align the first sample ofy(n)with the central sample ofΨWs(ns)at the initial position. Similarly, withΨWs(ns)at the final position, its central sample will be aligned with the last sample ofy(n). Repeat ii) to v). The procedure finishes when Ws is maximum.At the end of the procedure, the result is a matrixH(n,Ws)∈[0,1]:RN×Ws, which contains the TS-LHE estimates associated to the time seriesy(n). The TS-LHE estimates depend on windows size, and therefore, the LHE characterizes the data bounded by the window only. When the correlation of samples within the window changes due perhaps to a fast frequency or phase fluctuations, the LHE presents a deviation on a specific time and scale. The advantage of such a situation is that the TS-LHE method allows detecting these changes on time series patterns at specific times, as well as the extent of influence on neighbor samples. As the windows size increases, the LHE estimate approaches the value of the global Hurst Exponent. Considering the computational complexity of this method, the algorithm presents a complexity ofO(N2log⁡(N)).In order to analyze the samples at the end points of the series, some padding is required. However, the padding affectsWs/2values at the edges of theH(n,Ws). Thus, it is important to consider a suitable filling strategy for padding. In this case, a reflected-sample-padding allows analyzing samples at the end points with data from the same series that are in their vicinity. Despite the fact that it still affects the results, the calculatedH(n,Ws)is related to the same data. Other options, as zero-padding or random-padding, have the drawback that the TS-LHE analysis tests correlations between samples of different type, leading to results that are not meaningful for a correlation analysis.In order to evaluate the TS-LHE method, some time series from fractional Brownian motions, synthetic seismograms, and real seismic data are analyzed.A fractional Brownian motion (BH(t)), also known as a “random walk process”, is a self-similar Gaussian process, in which the distribution is similar at different scales [14]. The fBm presents a uniform scaling behavior, and it is generally parameterized through the Hurst Exponent,H∈(0,1). The parameter H can be seen as a measure of the dependence of each increment inBH(t)with neighboring samples:–IfH≥0.5, then the increments are persistent (the trend pattern of previous step is likely to be maintained).IfH≤0.5, then the increments are anti-persistent (the trend pattern of previous step is likely to be inverted). These represent an oscillating process.IfH=0.5, then each step is independent from previous ones, and the increment function,x(t)=BH(t+1)−BH(t), which represents the fractional Gaussian noise (fGn), corresponds to white noise.This behavior is illustrated in Fig. 2, from (A) to (F), where the fBm series has H values from 0.5 to 1.0, and a length of 500 samples. As the H value increases, the fBm series becomes smoother.The application of the TS-LHE method is tested for two other cases. The first is a synthetic seismogram, computed as the convolution between the Ricker wavelet and a series of randomly distributed spikes with random amplitudes. In this case, four configurations are tested, as shown in Fig. 3(A) to (D); the first is noise free, and the other three have a signal-to-noise ratio (SNR) of 10, 5, and 2 dB, respectively. The noise signal is the same in all cases. Only the amplitude has been changed in order to reach the specified SNR. In all cases, the sampling interval is set to 2 ms, the wavelet central frequency is 35 Hz, and the length of the series is 500 samples, for a simulation time of 1 second.The second case corresponds to a real seismic gather, composed of 28 traces, as shown in Fig. 4(A), and obtained from a seismic survey on an oil field in central Mexico. The sampling interval is 4 ms, the time interval comprises from 1 to 6 seconds (1250 samples). The traces have offsets which increase by 100 m each time. This gather has been selected due to the features present in the signal, one clearly observable at around 2 seconds.

@&#CONCLUSIONS@&#
In this paper, a systematic method for estimating the Time-Scale Local Hurst Exponent is presented and tested. The preliminary results applying this TS-LHE to fBm and seismic time series show that it is possible to identify changes on series behavior, such as frequency or phase variations. Because the LHE is a function of time, this information is related to the time when the changes occur.Also, it is shown that even if the features are strongly attenuated in the time series, the TS-LHE method detects them, allowing comparisons between sections of the time series. In order to detect changes on series behavior, it is necessary to observe how the Local Hurst Exponent fluctuates along the time series: if it is mainly constant, regardless of its value, it means that the series behavior is also constant; when the variation is fast, it means that the series has suffered a sudden change as well. As a general rule, small scales lead to results related to short-range correlations. As scales increase, long-range correlations tend to be more significant, and very large scales are similar to a global Hurst Exponent evaluation.Regarding the applications of the TS-LHE to seismic analysis, it can be useful as an additional tool that provides extra information on the complexity of the seismic data. Furthermore, temporal and scale variations of the local Hurst exponent may be a sensitive indicator capable of providing information on the fractal structure of seismic events present in the series.It has been observed that the TS-LHE method is notably sensitive to noise. Therefore, the SNR of the data needs to be considered. Also, the algorithm complexity is relevant, leading to a significant computational cost, particularly if the aim is to analyze a very large range of scales.A key difference between the proposed TS-LHE method and the CWT is that, in the latter, the energy of the signal has a strong influence on the results of the analysis. However, it may be difficult to detect singularities with relatively small amplitudes in the time series. In the case of the TS-LHE analysis, the amplitude does not influence the results, because it only tests and emphasizes the correlations and changes in patterns behavior, regardless their amplitude.