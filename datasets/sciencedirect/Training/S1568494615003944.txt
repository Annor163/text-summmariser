@&#MAIN-TITLE@&#
Predicting survival of individual patients with esophageal cancer by adaptive neuro-fuzzy inference system approach

@&#HIGHLIGHTS@&#
Based on the adaptive neuro-fuzzy inference system (ANFIS) approach, a hazard modeling and survival prediction system is developed to assist clinicians in prognostic assessment of patients with esophageal cancer and prediction of individual patient survival.The results show that application of ANFIS to prognosis prediction for esophageal cancer is a practical and effective method that can predict the survival of patients more accurately.This may provide valuable prognostic information in addition to AJCC staging and aid the clinicians’ decision-making process for risk stratification.

@&#KEYPHRASES@&#
Adaptive fuzzy inference system (ANFIS),Esophageal cancer,Radiotherapy,Survival analysis,

@&#ABSTRACT@&#
Since esophageal cancer has no symptoms in the early stage, it is usually not detected until advanced stages in which treatment is challenging. Integrated treatment provided by a multidisciplinary team is crucial for maximizing the prognosis and survival of patients with esophageal cancer. Currently, clinicians must rely on the cancer staging system for diagnosis and treatment. An accurate and easily applied system for predicting the prognosis of esophageal cancer would be useful for comparing different treatment strategies and for calculating cancer survival probability. This study presents a hazard modeling and survival prediction system based on adaptive neuro-fuzzy inference system (ANFIS) to assist clinicians in prognostic assessment of patients with esophageal cancer and in predicting the survival of individual patients. Expert knowledge was used to construct the fuzzy rule based prognosis inference system for esophageal cancer. Fuzzy logic was used to process the values of input variables rather than categorizing values as normal or abnormal based on cutoffs. After transformation and expansion, censored survival data could be used by the ANFIS for training to establish the risk model for accurately predicting individual survival for different time intervals or for different treatment modalities. Actual values for serum C-reactive protein, albumin, and time intervals were input into the model for use in predicting the survival of individual patients for different time intervals. The curves obtained by the ANFIS approach were fitted to those obtained using the actual values. The comparison results show that the ANFIS is a practical, effective, and accurate method of predicting the survival of esophageal cancer patients.

@&#INTRODUCTION@&#
Patients with esophageal cancer generally have a poor prognosis because onset symptoms are often insidious, which precludes diagnosis and treatment at an early stage [25]. Therefore, by the time of diagnosis, surgery alone is usually insufficient for managing patients with locally advanced esophageal cancer [8]. Trimodality treatment (i.e., neoadjuvant chemoradiotherapy followed by surgery) is a viable treatment option for patients in a stable condition [26]. In patients with major comorbidities who are not amenable to surgery, however, definitive concurrent chemoradiotherapy (CCRT) may be the best option [27].Survival probability is important prognostic information for cancer patients and their physicians. For patients, this information is important not only because it is needed to make major life decisions, but also because their uncertainty about the future has a large impact on their quality of life [3]. For physicians, this information is needed to counsel their patients and to tailor subsequent surveillance and treatment strategies. According to the American Joint Committee on Cancer (AJCC), cancer stage is the most important predictor of survival in cancer patients and is the major consideration when selecting treatment modalities for an individual patient [7]. Currently, esophageal cancer staging requires the expertise of a multidisciplinary team and detailed data provided by computed tomography (CT), endoscopic ultrasonography, bronchoscopy, positron emission tomography, and, most importantly, the pathology report after radical surgery. However, accurately predicting esophageal cancer survival before treatment is initiated remains challenging because the current AJCC staging system may not be accurate in patients not recommended for surgery, patients who are deemed inoperable, and patients who require exploratory surgery without esophagectomy [30]. Therefore, an accurate prognostic model is needed to predict survival and to determine the optimal treatment strategy for individual patients before they begin cancer therapy.Table 1shows how the Glasgow prognostic score (GPS) combines serum C-reactive protein (CRP) and albumin values into a single score. The GPS has been used to predict survival in many cancer types [9,20,10,5,22,18]. The survival of patients with esophageal cancer who have not received radiotherapy can be accurately predicted by correlating easily measurable serum markers of CRP and albumin with systemic inflammation and poor nutritional status [28]. This hypothesis is supported by several reports that elevated levels of pro-inflammatory cytokines are associated with disease progression and poor prognosis of esophageal cancer [19,17]. For many cytokines, however, analyses may be limited by their poor stability and the high cost of laboratory tests. Therefore, these serum factors are unsuitable for routine clinical use. In contrast, CRP and albumin are stable and easily measured serum parameters that are included in the routine serum chemistry panel of most clinical laboratories. Therefore, accurately estimating the reliability and validity of these markers for predicting patient prognosis would be extremely useful for the clinical management of esophageal cancer patients. Specifically, it would help to distinguish patients who would derive little survival benefit from radical esophagectomy, which has a significant negative impact on quality of life.Adaptive network-based fuzzy inference system (ANFIS) is a well-established approach to solving nonlinear mapping problems [14,15]. By using a hybrid learning algorithm that combines gradient method with least squares estimate for parameter identification, the ANFIS can perform input–output mapping based on both human knowledge (in the form of fuzzy if-then rules) and the stipulated input–output data pairs. The potential use of ANFIS as a novel technique for solving medical problems has received considerable attention, and ANFIS has already proven effective in various domains. For example Hamdan and Garibaldi [11–13], used ANFIS to estimate breast cancer survival based on the Nottingham Prognostic Index (NPI). Chang et al. [4] used bootstrap-ANFIS techniques to develop a model for predicting the prognosis of oral cancer. Their techniques were designed to improve accuracy in predicting oral cancer survival and to identify the key clinical and genomic markers of oral cancer. Devesh and Rajendra [6] used ANFIS to aid interpretation of suspect zones in magnetic resonance imaging and to identify features consistent with breast cancer. The ANFIS has also been used to improve efficiency in diagnosing tumor progression. Salmeri et al. [24] used ANFIS and an interval type-2 non-singleton fuzzy system to examine respiratory motion predictability from 12 traces from breast cancer patients. In Yuvaraj and Ragupathy [31], ANFIS was used to classify breast cancer masses. Experiments showed that their suggested features for classifying masses provided acceptable overall accuracy (91.30%). Lorestani et al. [16] used ANFIS to improve detection and prognosis of breast cancer based on mammography images. Comparisons showed that the detection accuracy of their ANFIS model was superior to that of other methods. Anandpushpara [1] used ANFIS for automatic detection and classification of lung tumors based on CT images of thoracic vertebrae. They improved the accuracy of neural network classifiers by training them with numerous CT thoracic images. The authors then used fuzzy logic rules to train classifiers, which improved their capability to distinguish between normal and abnormal tumors and between benign and malignant tumors at a low false positive rate. Therefore, we evaluated whether ANFIS can be used to predict survival in individual esophageal cancer patients based on their serum CRP and albumin values and whether ANFIS can accurately predict the survival of individual patients before they begin radiotherapy.The ANFIS combines rule-based systems with the learning capability of neural networks and builds a fuzzy inference system (FIS) from a given input–output data set. Construction of the fuzzy rule base used in the proposed inference system for predicting the clinical prognosis of esophageal cancer patients was based on expert knowledge, which is uncertain and ambiguous. Fuzzy logic was used to process the values of input variables rather than to classify the values as normal and abnormal according to a cutoff value. Fuzzy logic was also used to hypothesize a model structure that relates inputs to membership functions, to rules, or to outputs. The ANFIS is trained to establish a risk model that clinicians can use for prognostic assessment of patients with esophageal cancer and for prediction of individual patient survival.Regarding applicability, ANFIS has made important contributions in many engineering fields. However, its potential use for solving medical problems has also attracted considerable attention. To the best of our knowledge, this study is the first to apply ANFIS for predicting the prognosis and survival of esophageal cancer patients. Our experiments confirmed that, for this purpose, ANFIS is practical, effective, and accurate. This study addressed two major limitations of prior implementation of a fuzzy logic-based prognostic scoring system for predicting survival [29]. First, the membership functions of input variables were initially constructed according to expert experience and then fine-tuned by the ANFIS training process to provide a model that is sufficiently flexible for analyzing borderline cases. Second, compared to conventional approaches, the ANFIS generates a smoother model from the values for CRP and albumin, which are easily measurable biomarkers. It directly predicts the survival probability for each time interval instead of using a surrogate prognostic score requiring further survival analysis. The ANFIS approach also supports real-world decision making because it generates survival curves that reflect the consequences of different treatments at different stages.This paper is organized as follows. Section 2 presents the proposed materials and methods. Sections 3 and 4 present and discuss the results, respectively. Finally, Section 5 concludes the study.Since they do not have precisely defined membership criteria, biological systems are subject to uncertainty and ambiguity. Fuzzy logic was first introduced by Zadeh [32] to provide an intuitively satisfying way to analyze borderline cases and other hard-to-categorize situations. The ANFIS was proposed by Jang [14], and the Sugeno fuzzy model was used as a systematic approach to generating fuzzy rules from a given input–output data set. Fig. 1shows that the ANFIS architecture used in this study is a five-layer feed-forward neural network. Layer 1 is the fuzzification layer, which uses the fuzzy membership function to fuzzify the crisp signal for each input and to determine its membership degree. Layer 2 is the rule layer, in which a rule node receives inputs from the respective fuzzification nodes and calculates the firing strength of the rule it represents. Layer 3 is called the normalized layer, which calculates the ratio of the firing strength of a given rule to the sum of the firing strengths of all rules. Layer 4 is the defuzzification layer, which also receives initial inputs and yields the parameters of the consequent part of the rule. Layer 5 is a single node, which calculates the overall output by summing all incoming signals [14,21].The ANFIS was trained with a hybrid learning algorithm that combines gradient descent and least squares algorithm [14]. In the ANFIS training algorithm, each epoch is composed from a forward pass and a backward pass. In the forward pass, a training set of input patterns (an input vector) is presented to the ANFIS, neuron outputs are calculated on a layer-by-layer basis, and rule consequent parameters are identified by the least squares estimator. The parameters associated with the membership functions change through the learning process. The computation of these parameters and their adjustment are facilitated by a gradient vector, which indicates the efficiency of the FIS in terms its efficiency in modeling the input and output data for a given parameter set. When the gradient vector is obtained, any of several optimization routines can be used to make the parameter adjustments needed to reduce an error measure. This error measure is usually defined by the sum of the squared difference between actual and desired outputs. For ANFIS modeling, this study used the MATLAB fuzzy logic toolbox, which combines least squares estimation and back propagation for membership function parameter estimation.In summary, the ANFIS modeling approach resembles that of many other system identification techniques. The first step is hypothesizing a model structure for relating inputs to membership functions, to rules, and to outputs. Next, input and output data are collected in a form that the ANFIS can use for training. Finally, ANFIS is used to train the FIS model to emulate the training data presented to it by modifying the membership function parameters according to a chosen error criterion.The data source used for ANFIS modeling was a de-identified and updated database of esophageal cancer patients [28]. The cohort analyzed in this retrospective study included 271 anonymous Taiwan patients (261 males and 10 females) who had received radiotherapy for esophageal cancer during 2003–2010. According to clinical AJCC staging guidelines, the numbers of patients in cancer stages I, II, III, and IV were 13 (4.8%), 29 (10.7%), 123 (45.4%), and 106 (39.1%), respectively. The median follow up for surviving patients was 30 months (range, 5–81 months). Table 2lists the patient characteristics.Input and output variables were converted to a form understandable and acceptable by ANFIS in order to reduce the dimensionality of input data and to minimize model training time [11,12]. For example, instead of dividing the values for serum CRP and albumin into discrete groups based on predefined cut-off values and then combining these groups into GPS as in our previous study [28], the actual values obtained in laboratory examinations were used as the first two input variables, and the actual survival time was used as the third input variable. Fig. 2shows that the ANFIS model structure comprised 3 input variables (CRP, albumin, and time interval) and 1 output variable. Table 3shows an example of the transformation and expansion processes applied in a data set for three patients. Each row in the original data set contained different variables for each case. These variables included survival time (months), pretreatment serum CRP, pretreatment albumin value, and censor status (patient died or was censored). The data for each patient (CRP and albumin values) were replicated and expanded into multiple rows with each row representing a time interval of 1 month until completion of the study period or until death (survival time). The censor status, which was also replicated for use as an event indicator, was set to zero until the maximal time value was reached, where a death event was indicated by 1 and a censor event was indicated by 0. Table 4shows that, after transformation and expansion, the data were in a format suitable for use as input for training the ANFIS model.The ANFIS was used to train a risk model for predicting survival in an individual patient. Data transformation and expansion were performed to obtain inputs for model training. After the training process, test data were used to validate the final ANFIS model and to examine whether the output variable (hazard or probability of event occurrence) matched the actual clinical outcome. The test data loaded into the final ANFIS model were the original patient data without transformation and expansion. Fig. 3is a flowchart of the procedure used to construct and validate the ANFIS model. Since the survival and hazard functions are related, the survival function can be represented as follows as described by Biganzoli et al. [2]:S(t)=∏l:tl≤t(1−hl),where the time interval l=1, 2, …, L forms disjoint intervals (tl−1; tl]with t0=0 and where liis the last observation interval for the ith subject. The hldenotes the hazard (conditional failure probabilities) associated with that time interval. The hazard rate for each time interval is the mean hazard for all patients or subgroups of patients in that particular time interval. The survival function of the ANFIS then plots the survival curves, in which the y-axis is the percentage or probability of survival and the x-axis is months of survival.

@&#CONCLUSIONS@&#
The ANFIS approach can be used to model a smooth discrete hazard by treating the time interval and the clinical covariates as input variables. Given pretreatment values for CRP and albumin, the proposed ANFIS model can accurately predict the survival probability at specific time intervals. In addition to providing valuable prognostic information, it can be used for AJCC staging and to aid the decision-making process that clinicians use for risk stratification.