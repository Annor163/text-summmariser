@&#MAIN-TITLE@&#
Feature extraction of the first difference of EMG time series for EMG pattern recognition

@&#HIGHLIGHTS@&#
The stationarity of surface EMG signals during upper-limb motions is investigated.The differencing technique can transform EMG signals to become more stationary.The proposed differencing technique improves classification accuracies by 2–8%.Difference absolute mean value exhibits the best performance with an accuracy of 95.82%.EMG derivative features are recommended for use in the classification of dynamic motions.

@&#KEYPHRASES@&#
Differencing technique,Dynamic motions,Electromyography (EMG),Muscle–computer interface,Non-stationary signal,

@&#ABSTRACT@&#
This paper demonstrates the utility of a differencing technique to transform surface EMG signals measured during both static and dynamic contractions such that they become more stationary. The technique was evaluated by three stationarity tests consisting of the variation of two statistical properties, i.e., mean and standard deviation, and the reverse arrangements test. As a result of the proposed technique, the first difference of EMG time series became more stationary compared to the original measured signal. Based on this finding, the performance of time-domain features extracted from raw and transformed EMG was investigated via an EMG classification problem (i.e., eight dynamic motions and four EMG channels) on data from 18 subjects. The results show that the classification accuracies of all features extracted from the transformed signals were higher than features extracted from the original signals for six different classifiers including quadratic discriminant analysis. On average, the proposed differencing technique improved classification accuracies by 2–8%.

@&#INTRODUCTION@&#
Traditional surface electromyography (EMG) pattern recognition methods for muscle–computer interfaces have been developed under the assumption that surface EMG signals are stationary, or exhibit “stationarity” [1,2]. The term “stationarity” means that statistical properties of the signal do not change over time [3]. Generally, a weaker form of stationarity is used for the analysis of surface EMG signals based on second-order stationarity [1,2], such that signal mean and variance do not depend greatly on time differences. A signal with these characteristics can be considered weak- or wide-sense stationary.Two approaches have been proposed for EMG pattern recognition systems, using the assumption of stationarity. Measured EMG signals could be considered stationary if (1) a whole short-time static or dynamic contraction is classified to be a single output [4–7], and (2) the static portions of a medium- or long-duration dynamic motion are classified as single outputs over a sufficiently short-time window [8–11]. However, limiting a motion recognition system to utilize either a short transient or a steady-state EMG signal would limit the benefits of the system. In other words, a recognition system which combines both transient and steady-state EMG signals together would increase the utility of the system for clinical applications [12,13].In activities of daily living, a dynamic contraction is more common than a static contraction. Each activity usually contains both transient and steady-state EMG components. If both are considered as one motion with continuous classified outputs, the assumption of stationarity does not hold [14] because statistical properties of the signal consisting of mean, variance and/or spectral characteristics, continuously change over time [3]. EMG pattern recognition systems that are built only on the assumption of stationarity would fail to classify the EMG pattern in dynamic portions, particularly at the beginning and the end of the contractions [15,16].In modern EMG pattern recognition, time–frequency and time-scale analysis methods such as short-time Fourier transform, discrete and continuous wavelet transforms [6,11,14] have been used to study time-varying properties of non-stationary EMG signals. A wavelet transform approach with a support vector machine (SVM) classifier provides better classification accuracy compared to several state-of-the-art classifiers such as the artificial neural network (ANN) and the linear discriminant analysis (LDA) [17]. However, this combination has some disadvantages in practical applications such as performance-dependence on the optimization of training, i.e., static and dynamic training, and both steps of the technique must be optimized concurrently such that required training time becomes very lengthy [16]. Moreover, classification performance of an SVM degrades over time by 14.6% when not being recurrently trained [18]. On the other hand, a combination of simple approaches using time domain (TD) analysis methods and LDA classifiers provides performance comparable to more complex classification methods including the wavelet transform, the SVM, and ANN [19,20]. The classification performance of a combined TD/LDA approach is less sensitive to changes in training sets and does not require any optimization [16,19]. Moreover, the classification performance of an LDA has been shown to degrade by only 3.6% when not being trained recurrently [18].In general, TD methods are not designed to reliably quantify a non-stationary signal. TD features extracted from both static and dynamic portions have increased variance [21,22] and thereby degrade the performance of classifiers [15,16]. Therefore, in order to use TD methods to analyze actions associated with EMG signals, it is first necessary to understand stationarity of the measured EMG signals, and potentially render the measured EMG signals more stationary as needed [23]. However, previous studies investigating stationarity of surface EMG signals [1–3,23] reported that stationarity of the signals depends on many conditions such as the analysis window size, the type of motions and muscle contractions, and features used to characterize the signals.From a statistical viewpoint, simple transformations such as polynomial trend removal or differencing [24] could render a measured signal more stationary and more compatible with TD methods. The differencing technique has previously been applied as a part of some TD methods in the analysis of surface EMG signals [17,21,25–28]. These features are generally computed based on statistics of the first-order difference of EMG time series, d(1)(t), instead of the original EMG time series, x(t), and previous studies also demonstrated better classification performance of d(1)(t) features over x(t) features. The literature review on existing EMG features extracted from d(1)(t) is presented in detail in Section 2. While these existing EMG derivative features have shown very high performance in the classification of upper-limb motions associated with surface EMG signals, previous studies have lacked consistency in the application of differencing, and many of them could not explain why features extracted from d(1)(t) yield higher accuracy compared to features extracted from x(t). The question then arises whether it is the stationarity of the signals that is affected through differencing, leading to better classification performance.Therefore, the first purpose of this study was to examine the stationarity of EMG time series with and without a differencing technique applied. The second purpose of this study was to evaluate classification performance of features extracted from d(1)(t) and x(t) using various classifiers and analysis segment lengths of the same EMG data. The third purpose of this study was to explore new potential features of d(1)(t) by using existing methods applied to x(t) on d(1)(t). Based on results from previous studies, it was hypothesized that (1) d(1)(t) is more stationary compared with x(t), and (2) EMG features extracted from d(1)(t) provide better classification accuracy compared to features extracted from x(t).One of the most widely used and successful features using the differencing technique is waveform length (WL). It is defined as a summation of the absolute value of d(1)(t) and can be considered as an extended version of integrated EMG (IEMG), which is a summation of the absolute value of x(t). Oskoei and Hu [17] reports that WL yields the best performance in classification accuracy, stability, and computation load, among single TD and frequency domain features including IEMG, using three different classifiers: the SVM, ANN, and LDA. This finding has been confirmed in previous studies based on the LDA classifier [26] as well as a statistical separability measure [21].Mean absolute value (MAV) and root mean square (RMS) are two popular features which are often used as an estimate of EMG amplitude [29]. Both features have been modified using the differencing technique in several previous studies [25–27], which are called the difference absolute mean value (DAMV) and difference absolute standard deviation value (DASDV) respectively. Kim et al. [25] and Yu et al. [27] examined the classification performance between MAV and DAMV as well as RMS and DASDV using an LDA, a quadratic discriminant analysis (QDA), a k-nearest neighbor (kNN), and a maximum likelihood estimation classifier. The classification accuracies obtained from the DAMV and the DASDV were significantly higher than the accuracies obtained from the MAV and the RMS (p<0.05).A number of TD features have been proposed to measure frequency domain contents of surface EMG signals. For example, Willison amplitude (WAMP) effectively counts the frequency of motor unit action potentials (MUAPs) firing, which can be considered as an extension of the myopulse percentage rate (MYOP) using the differencing technique. In addition, Khushaba et al. [28] proposes a new TD feature set based on the Hjorth's approach [30], which provides the spectral moments of the signal via time-differentiation. The five features proposed are based on the zero, second, and forth order moments (M0, M2, and M4), and provide very accurate classification rates (approximately 90%) for eight motions across five different upper limb positions. The M2 feature of x(t) can be considered equivalent to the M0 feature, or simple square integral (SSI), of d(1)(t).The EMG data, used to evaluate the proposed methods, were recorded from four forearm muscles in 18 (9 male, 9 female) normal subjects aged between 20 and 23 years old, as they performed eight hand, wrist and forearm motions [31]. The eight motions consisted of forearm pronation (FP), forearm supination (FS), wrist extension (WE), wrist flexion (WF), wrist radial deviation (WRD), wrist ulnar deviation (WUD), hand open (HO), and hand close (HC). All subjects are dexterous with their right hands and the shoulder was positioned at 0 degree (neutral) with an elbow in full extension.The subjects were asked to perform 15 sessions per day for 4 separate days (60 sessions in total). Within each session, the subject performed each motion for 2s in duration and separated each motion by a 2-s period in the rest state to avoid any transitional stage (i.e., during motion changes). The order of motions was randomized in each session. In total, 60 datasets or a total duration of 120s per motion were collected for each subject.EMG data were collected from four muscles consisting of: extensor carpi radialis longus (ECRL), extensor carpi ulnaris (ECU), extensor digitorum communis (EDC), and flexor carpi radialis (FCR) on the right arm using bipolar Ag/AgCl electrodes (H124SG, Kendal ARBO) with a 24-mm diameter and a 20-mm inter-electrode distance. All EMG signals were amplified with a gain of 19.5× and sampled at 1024Hz with a 24-bit resolution by a commercial wireless EMG measurement system (Mobi6-6b, TMS International B.V.). In order to remove noise and unwanted signals, the EMG data were passed through a band-pass filter with a cutoff frequency of 20 and 500Hz and a notch filter with a cutoff frequency of 50Hz [32].According to theory [24], a transformed time series d(1)(t) will be stationary for a broad class of nonstationary time series x(t). Thus, it is possible that a differencing technique will allow the application of conventional EMG feature extraction methods, developed for stationary time series, to non-stationary time series.The first difference of a time series x in discrete time t is defined as the differences between consecutive values of x, which can be described by the following expression: d(1)(t)=x(t+1)−x(t), where t=1,2,…,N−1, and N is the total number of data points in the analyzed segment. It should be noted that the proposed technique reduces the signal length to be N−1.The EMG time series were analyzed with 250-ms adjacent segments (N=256 data points) to assess EMG stationarity. This length of segment was chosen as a compromise between feature variance, bias, and real-time constraints [9,10].To investigate the hypothesis that the differencing of EMG time series can transform the original signal, x(t), to be more stationary, variances in key statistical properties were investigated. A raw EMG time series of each motion trial was first divided into short analysis segments, and for each segment the mean and standard deviation were calculated. Then the variation of these quantities from all short segments in each motion trial was computed [2]. The EMG time series become more stationary when the variation of the statistical properties of EMG time series reduced [2,3].In the preliminary study, the range of d(1)(t) values was narrower than the range of x(t) values. Therefore, a normalized measure of statistical dispersion, the coefficient of variation (CV), was used instead of common measures such as variance or standard deviation. It is defined as the ratio of the standard deviation to the mean of the proposed quantity.Two commonly used descriptive statistics are mean and standard deviation. However, raw EMG time series generally have a mean value of about zero, due to positive and negative deviations from baseline. In order to analyze EMG signals, TD features are usually preceded by full-wave rectification (making negative EMG values positive). Thus, the mean value was calculated from the rectified EMG signal instead of the raw signal [2]. On the other hand, the standard deviation of EMG signals is a function of muscle contraction level and can be calculated directly from raw EMG time series.An evaluating test, namely the “reverse arrangements (RA) test” was used to evaluate the stationarity of forearm-muscle EMG signals at various hand, wrist, and forearm motions. The RA test has been widely used to evaluate the stationarity of surface EMG signals during static and dynamic contractions of upper- and lower-limb muscles [1,33]. It is important to note that the RA test is a general non-parametric test for a weak- or wide-sense stationarity [23]. The procedure of the RA test in which some parts are modified for this study is as follows:(1)x(t) is defined as the amplitude value of tth data point.The number of reverse arrangements (A) in the sequence {x(1), x(2), …, x(N)} are counted when x(t)>x(i) for t<i. In other words, A is the number of times that the value of the first data point x(1) in the segment is higher than each subsequent data point value, x(2), x(3), …, x(N), and then this process is repeated for x(2), x(3), …, x(N−1).The z-score is calculated using the following equation:(1)z=A−N(N−1)42N3+3N2−5N72.The averaged absolute value of the z-score of all segments and motions for each trial is calculated and used to indicate the stationarity of EMG time series. A significant level is usually defined and then the signal stationarity is examined. The segment is stationary when the absolute value of the z-score is less than 1.96 for a 5% significant level, as used in previous studies [1,23]. However, in current study, the average absolute z-score values of time series x(t) and d(1)(t) were directly compared.The success of any EMG pattern recognition system depends almost entirely on the selection of EMG features. Features based on time statistics have been widely used in research and can be performed within real-time constraints using simple hardware as compared to frequency-domain and time–frequency methods [7,10,34].TD features calculated based on statistics of the original signal, x(t), are (1) IEMG, (2) MAV, (3) SSI, (4) the variance of EMG (VAR), (5) RMS, and (6) MYOP, while matched TD features calculated based on the statistics of the transformed signal, d(1)(t), are (1) WL, (2) DAMV, (3) M2, (4) the difference variance value (DVARV), (5) DASDV, and (6) WAMP. Mathematical definitions of the proposed existing features are shown in Table 1. The threshold, thr, is a predefined threshold which is used to avoid background noise during EMG recording in the signal and was set at 20 for MYOP and WAMP based on the preliminary study. It should be noted that in several previous studies the DAMV was called “average amplitude change” [35].Five commonly used features that have not previously been applied to d(1)(t) were investigated for their classification performance in the current study including: (1) the absolute value of the higher order temporal moments (TM), (2) v-order (V), (3) log detector (LD), (4) autoregressive coefficients (AR), and (5) cepstrum coefficients (CC) [26,34,36]. There exist features other than the five mentioned above, including: mean absolute value slope, the EMG histogram, kurtosis, and skewness [26,37,38], however their classification accuracies are generally very low. Therefore, the results of such features are not included in this study. The five features extracted from both x(t) and d(1)(t) were computed and compared based on their classification performance. To indicate which features were extracted from x(t) and d(1)(t), the abbreviation of modified features is written beginning with “D”. For example, the TM feature extracted from x(t) is referred to as the DTM feature when extracted from d(1)(t). Mathematical definitions of the proposed features are shown as follows:(2)TM=1N∑t=1Nx(t)m,(3)V=1N∑t=1Nx(t)v1/v,(4)LOG=e1N∑t=1Nlog(x(t)),(5)x(t)=−∑p=1Pa(p)x(t−p)+w(t),(6)c(1)=−a(1);c(p)=−a(p)−∑l=1p−11−lpa(P)c(p−l)for1≤l≤P,where m is the temporal moment order, v is the v order, P is the AR order or the CC order, a(p) is autoregressive coefficients, w(t) is a white noise error, c(p) is cepstrum coefficients. Based on the preliminary experiments, m, v, and P were set at 3, 3, and 4, respectively.In this study, the quality of EMG features was evaluated by the classification rates obtained from classifiers. Generally, classification accuracy is used as the main index to show the performance of EMG pattern recognition [39]. It is defined as the rate of correct classification to all analysis segments in a test set. Six classifiers including LDA, QDA, kNN (k=5 [25]), decision tree (DT), naive Bayes (NB), and Mahalanobis distance (MD) were chosen as the representative classifiers in this study because the classification performance of these classifiers is not greatly dependent on the optimizing structures and parameters of the classifiers as it is with ANN and SVM classifiers. Six different classifiers were deployed to guarantee that the classification results did not depend on the type of classifiers. A single classification accuracy was produced by averaging across the 10-fold cross-validations for each subject. Original EMG datasets were randomly partitioned into 10 equal size sub-datasets. In each fold, a single sub-dataset was retained as testing data and the remaining 9 sub-datasets were used as training data for the classification model. The cross-validation process was then repeated 10 times using each sub-dataset once for training.In order to perform a continuous classification, a class decision has to be analyzed and produced on a short analysis segment less than 300ms, which is widely used as an acceptable delay for a real-time myoelectric control system [9,10]. However, segments shorter than this should be avoided since it can result in high variability for feature extraction [40]. There are two major techniques in data windowing: an adjacent (or disjoint) windowing and an overlapped windowing [11,41]. Processing time for either method is usually less than 50ms [9], particularly for TD methods. To use the adjacent windowing technique, the length of an analysis segment may be up to approximately 250ms in duration. Generally, this maximum segment length (under acceptable delay) could improve classification results as compared to a shorter segment length, e.g. 125 and 62.5ms [17]. For the overlapped windowing technique, the segment length was set at 250ms (256 samples at a 1024-Hz sampling rate) with the increment of 125, 62.5, and 31.25ms (or 128, 64, 32 samples). In total, six conditions of data windowing were proposed (segment length/segment increment, in samples): 64/64, 128/128, 256/256, 256/128, 256/64, and 256/32.

@&#CONCLUSIONS@&#
In conclusion, features extracted from the first difference of EMG time series are recommended for use in the classification of motions associated with surface EMG signal instead of features extracted from the original measured EMG signals. As a result of the proposed technique, the within-class variation of features extracted from the transformed EMG signal decreases, while it is possible to preserve the distance of clusters between classes. The findings in this study can be applied in many EMG applications including muscle–computer interfaces. In future studies, multiple EMG features based on the differencing technique, for example, DAMV, DASDV, WAMP, DAR, and DCC should be investigated and optimized together with successful classifiers such as the SVM, ANN, QDA, and LDA classifiers.The authors declared that there is no conflict of interest.