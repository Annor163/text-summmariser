@&#MAIN-TITLE@&#
Semi-implicit finite strain constitutive integration of porous plasticity models

@&#HIGHLIGHTS@&#
The combination of relative Green-Lagrange strains with the exact corotational method.The use of L¨owdin algorithm based on the Jacobians of configurations Ωb and Ωa.Replacement of the complementarity condition by the Chen-Mangasarian function.GTN and Rousselier constitutive models, with the determination of intersections with axes of pressure-shear diagram (p − q).The use of MINI element in triangles and tetrahedra to avoid locking due to quasi-incompressibility.

@&#KEYPHRASES@&#
Constitutive integration,Porous plasticity,Finite strains,Semi-implicit,Löwdin׳s method,

@&#ABSTRACT@&#
Two porous plasticity models, Rousselier and Gurson–Tvergaard–Needleman (GTN), are integrated with a new semi-implicit integration algorithm for finite strain plasticity. It consists of using relative Green–Lagrange during the iteration process and incremental frame updating corresponding to a polar decomposition. Lowdin׳s method of orthogonalization is adopted to ensure incremental frame-invariance. In addition, a smooth replacement of the complementarity condition is used. Since porous models are known to be difficult to integrate due to the combined effect of void fraction growth, stress and effective plastic strain evolution, we perform a complete assessment of our semi-implicit algorithm. Semi-implicit algorithms take advantage of different evolution rates to enhance the robustness in difficult to converge problems. A detailed description of the constitutive algorithm is performed, with the key components comprehensively exposed. In addition to the fully detailed constitutive algorithms, we use mixed finite strain elements based on Arnold׳s MINI formulation. This formulation passes the inf–sup test and allows a direct application with porous models. Isoerror maps for two common initial stress states are shown. In addition, we extensively test the two models with established benchmarks. Specifically, the cylindrical tension test as well as the butterfly shear specimen are adopted for validation. A 3D tension test is used to investigate mesh dependence and the effect of a length scale. Results show remarkable robustness.

@&#INTRODUCTION@&#
For common metals at room temperature, void nucleation and particle debonding, void growth and coalescence are the mechanisms for crack growth from the process region [10]. Detailed multiple-scale analysis of these mechanisms require robust polycrystalline plasticity and representation of dislocation dynamics and grain boundary barriers (Roters et al. [30] present a comprehensive review). Therefore, the so-called phenomenological models (e.g. [18]) are considered a cost-effective tool for predicting damage and fracture in metals when overall quantities, like maximum load and dissipated energy, are of interest. The now well-established GTN model is based on the original yield surface by Gurson [16] and was subsequently modified by Tvergaard and Needleman [34,35]. The void growth part of the GTN model is based on the micromechanics of the ductile process. Phenomenological models formulated based on thermodynamical principles have also been proposed such as the Lemaitre model [18] and its subsequent modifications. Among this class of constitutive models, the Rousselier model [31,4] is interesting from a computational perspective as it is simpler and requires the specification of fewer parameters than the GTN model, while possessing the ability to closely match the predictions of the latter by determination of its parameters. It adheres to the idea that the occurrence of localization, crack initiation and propagation emerges as a direct consequence of strain softening due to void growth. Hence, unlike micro-mechanics models of porous metal plasticity, the Rousselier model does not directly model the mechanism of coalescence. However, two properties are worth mentioning:1.The Rousselier model predicts void fraction growth in pure shear.The Rousselier yield surface has an isochoric vertex causing a non-zero plastic volumetric term component.The GTN model uses the same coalescence approach as the classical Tvergaard–Needleman technique (cf. [35]).Both void fraction and damage variables are integrated in closed-form using the Lambert W and the ERF functions.Due to their complementarity form (see, e.g. [20]), finite strain plasticity problems often exhibit convergence difficulties for large strain values and severe sensitivity to step size [3]. We have two measures to attenuate these difficulties: the use of a smoothed complementarity condition and the removal of iterative rotation matrices from the constitutive laws in finite strains.It is computationally convenient that both hyperelastic and finite-strain elasto-plastic laws are implemented in a unique algorithm and applicable to any discretization scheme.Classical assumed-strain elements typically do not directly provide the deformation gradient (e.g. [9]), necessary for many constitutive formulations. An estimated deformation gradient can be calculated from the polar decomposition if an approximate rotation matrix is available. Since a constitutive frame is adopted, the rotation matrix is obtained from this frame in two distinct configurations. Compatible frames use Löwdin׳s method [19].Since the seminal contributions of Weber and Anand [36] and Simo [32], Kirchhoff stress tensors (i.e.τ=Jσ) are frequently employed in the yield functions. This is a computational convenience, as commonly adopted elasto-plastic and hyperelastic models are often quasi-incompressible. This is not the case of porous plasticity (cf. [4]). We therefore avoid that approach.Semi-implicit formulations, where certain quantities are fixed in the flow vector (but not the flow vector itself), cf. [23,8] can lead to substantial savings in constitutive integration. We further extend the semi-implicit algorithm presented in [3] to achieve very large time steps. Consistent linearization of integrated form of objective rates is intricate and computationally expensive, making it a possible candidate for the explicit integration part of the semi-implicit scheme. However, rigid body motions are exactly accounted for.Cauchy equations of equilibrium for a rotated reference configuration are obtained from the corresponding spatial equilibrium (derivations for the latter are shown in Ogden [27]). Using standard notation (cf. [27]) we write the spatial equilibrium equations as(1)∂σij∂xaj+bi=0with the Cauchy tensor components σij(i,j=1,2,3). In (1)i is the direction index and j is the facet index. The components of the body force vector are identified as bi. In (1), coordinatesxajare the spatial, or deformed, coordinates of a given point under consideration. In addition, the following natural and essential boundary conditions hold on each part of the boundaryΓa=Γat∪Γauwhere Γatis the natural boundary and Γauis the essential boundary:(2)t¯=σ·vonΓat(3)u¯=uonΓauwheret¯is the known stress vector on Γat,vis the outer normal andu¯is the known displacement field on Γau. It is assumed that (1) and (2)–(3) are satisfied for a time parameterta∈[0,T]with T being the total time of observation and for a point with positionxa∈Ωabelonging to the deformed position domain at the time of analysis. Equilibrium configuration corresponds to the domain Ωaand is identified by the subscript a. In tensor notation, Eq. (1) can be presented as(4)∇·σT+b=0with∇=∂/∂xabeing the spatial gradient operator. After multiplication by the velocity fieldu̇, integration in the deformed configuration Ωaand application of integration by parts component-wise, we obtain the following power form (Ẇintis the internal andẆextis the external power):(5)∫Ωaσ:LdΩa︸Ẇint=∫Ωab·u̇dΩa+∫Γatt¯·u̇dΓa︸ẆextwhereLis the velocity gradient:L=∂u̇/∂xa.Lcan be decomposed into a symmetric part (D, called strain rate) and a skew-symmetric part (W, called vorticity),L=D+W. We also introduce the JacobianJ=detFandFis the deformation gradient. The use of equivalence between internalẆintand externalẆextpower for a continuum has been used to obtain objective rates of the Cauchy stressσ. In the corotational case, we can rotate the Kirchhoff stress and the strain rate to obtain(6)Ẇint=∫Ω0(R0aTτR0a):(R0aTDR0a)dΩ0From each element nodal arrangement, we use three directions, wheree¯1a,e¯2aande¯3ato defineR0aas(7)R0a=[e¯1a,e¯2a,e¯3a]where each column is a unit vector ande¯ia·e¯ja=δij. Section 2.3 describes the calculation ofR0a. We then use the following convention for writing tensors: the bold symbol indicates tensor components. Therefore, the frame where the tensor components are defined is identified as a superscript. For example, the second-order tensorSabwith the equilibrium configuration Ωaand reference configuration Ωbhas the following components in frame c:Sabc. If a global frame 0 is adopted, component transformation between frame 0 and frame c follows:(8)Sabc=Rc0Sab0Rc0TNote that this approach, although related, does not correspond to the rotated Algorithm of Areias and Belytschko (cf. [2]). Generalizing (8), change of basis22This corresponds to a change of frame, denoted by a superscript.from d to c results in the following transformation:(9)Sabc=RcdSabdRcdTIn addition, change in reference configuration reads(10)Sac0=RbcSab0RbcTUsing (10) and transformation (9) for coinciding reference configuration and frame,(11)Sacc=SabbFrom the relation between the time derivative right Cauchy–Green tensorCand the strain rateD, we obtain(12)Ċ=2FTDFSimo [33, p. 281, Eq. 8.1.13] derived the following one-step scheme for integrating the strain rate in frame 0, producing the following “strain” from integration ofD:(13)eab,β0≅12FbβT[FaβTFaβ−I]Fbβwhere β is an arbitrary configuration. Using the previous power conjugacy (6), the internal power can be written in the initial configuration Ω0 asẆint=∫Ω0Sa00:Da00dΩ0whereSa00=R0aTτa0R0aandDa00=R0aTda0R0a. Using a hypoelastic relation, stress updating is performed as follows:Sa00=Sb00+ΔSa(Rβ0eab,β0Rβ0T)whereΔSˇais a function of the straineab,β0. This termΔSˇais called the constitutive part of the stress. However, sinceSa00=SabbandSb00=Sbbb, we haveSabb=Sbbb+ΔSa(Rβ0eab,β0Rβ0T)In the caseβ=b, the result is(14)Sabb=Sbbb+ΔSa(eabb)with Simo integration scheme reducing to(15)eabb≅12Rb0[FabTFab−I]Rb0TWe now insert the Jacobian for configuration Ωbin (14) as(16)1Jb0Sabb︸Sab⋆b=1Jb0Sbbb︸σbb+1Jb0ΔSˇa(eabb)Defining(17)Sab⋆b=1Jb0Sabbthen we obtain the Cauchy stress in configuration Ωaand frame a as(18)σaa=Saa⋆a=1Ja0Saaa=1Ja0Sabb=Jb0Ja0Sab⋆bIfΔSˇa(eabb)is homogeneous of degree one, then it follows thatSab⋆b=σbb+ΔSˇa(e˜abb)where(19)e˜abb=1Jb0eabbFor hyperelastic models, we require the total strain, which is the strain from configuration Ωawith respect to configuration Ω0. Using frame b, we have the following update formula for the Green–Lagrange strain:(20)ea0b=eb0b+Fb0bTeabbFb0bWe can observe thatSab⋆bis work-conjugate toea0bin configuration Ωb. Global Cauchy stress can be obtained asσb0=R0bσbbR0bT. In frame a,ea0areads(21)ea0a=RbaTea0bRbaFor symmetric tensors, such asSab⋆bandeabb, it is preferable to use the Voigt notation. Upright bold symbols denote Voigt form of symmetric tensors:(22)Sab⋆b=Voigt[Sab⋆b]=1Jb0VS(Fb0b)Sa0bwhereSa0b=Voigt[Sa0b]. We note that, omitting indices a, b, and 0,VS(F)can be written asVS(F)=[F112F212F3122F21F112F31F112F31F21F122F222F3222F22F122F32F122F32F22F132F232F3322F23F132F33F132F33F23F11F12F21F22F31F32F21F12+F11F22F31F12+F11F32F31F22+F21F32F11F13F21F23F31F33F21F13+F11F23F31F13+F11F33F31F23+F21F33F12F13F22F23F32F33F22F13+F12F23F32F13+F12F33F32F23+F22F33]and, for the strain quantities,VE(F)=VST(F). The full algorithm is given in Algorithm 1. In summary:•Local constitutive quantities, as well as quadratic strain increments are implicitly integrated.Local frames a and b, and therefore the rotation tensor are explicitly integrated.General relative Lagrangian formulation (Voigt notation adopted).GivenFabb,eabb(both in frame b),R0bandR0a(both in frame 0) and Tband TaRecovered from storageFb0b,σb0,eb0b(σbis stored in frame 0 for purpose of representation)Represent Cauchy stress in frame bσbb=VS(R0bT)σb0Relevant Jacobian determinantsJb0=detFb0bJab=detFabbRelative rotation and total deformation gradient updateRab=R0aTR0bFa0b=FabbFb0bThermal effect in the relative straineabb○=eabb+α(Ta−Tb)ITotal strain updateea0b=eb0b+VE(Fb0bT)eabb○Corrected relative strain for ULe˜abb○=1Jb0eabb○(UL)DetermineSab⋆b=σbb+ΔSˇa(e˜abb○)and Qabalong with sensitivity quantitiesCab=1Jb0∂ΔSˇa∂e˜abb○,∂ΔSˇa∂Ta,1Jb0∂Qab∂e˜abb○and∂Qab∂Ta(TL)DetermineSa0b(ea0b)and Qab, along with sensitivity quantitiesCa0=∂Sa0b∂ea0b,∂Sa0b∂Ta,∂Qab∂ea0band∂Qab∂Ta(TL)Determine relative stressesSab⋆b=1Jb0VS(Fb0b)Sa0b(TL) Determine relative sensitivitiesCab=1Jb0VS(Fb0b)Ca0VE(Fb0bT)∂Sab⋆b∂Ta=1Jb0VS(Fb0b)∂Sa0b∂Ta∂Qab∂eabb=∂Qab∂ea0bVE(Fb0bT)Update temperature sensitivity∂Sab∂Ta∂Sab∂Ta+αCabIDetermine strain in frame aea0a=VE(Rab)ea0bDetermine deformation gradient in frame aFa0a=RabFa0bRabTDetermine Cauchy stress in frame 0σa0=1JabVS(R0a)Sab⋆bStoreFa0a,σa0,ea0aReturn Qab,Sab⋆b,Cab,∂Sab⋆b∂Ta,∂Qab∂eabband∂Qab∂TaWe determine the relevant constitutive quantities by solving a general nonlinear constitutive system. Omitting the frame superscript, it reduces to the root finding for the following nonlinear system:(23)φ(Sab,Qab︷Governing︸Unknown;eabK,eab,Ta︸Known;χa︸Internalvar.)=0whereχais the internal variable vector. For the present application, it is defined as(24)χa={εpfa}where εpis the effective plastic strain and fais the void fraction variable. Newton iteration for (23) provides, in general, the solution for the constitutive unknownsSab, Qab, andχa. For the present application, system (23) hasQab=0,Ta=0,eabK=∅. A smoothed version of (23) is introduced by using the Chen–Mangasarian replacement functions, which depend on a parameterErrorsuch that (cf. [3])(25)limError→0φError=φNewton iteration on (23), usingφErroras a replacement provides the following scheme:(26)[∂φError∂Sab∂φError∂χa]︸J{ΔSabΔχa}=−φErrorAfter achieving a solution using the Newton scheme (26), we calculate the sensitivities from the following equation:(27){dSabdχa}=−J−1[∂φError∂eab]deabSpecifically (with further details being provided in [3]), the present elasto-plastic system is therefore given as(28)φError(Sab;eab,χa)={eab−Clinear−1ΔSˇab−nΔγμ⋆Δγ−〈μ⋆Δγ+ϕ〉ErrorΔχa−Δγω(χa)}whereΔγis the plastic multiplier increment,μ⋆is a dimensional parameter described in [3] and the smooth ramp function of Chen and Mangasarian [14] is used for the third equation, which depends onError. Function ϕ in (28) is the yield function. In addition, the flow vectornis also required for the flow rule, and it is defined as(29)n=∂ϕ∂SabFig. 1shows the effect ofErrorin the satisfaction of the complementarity condition (see also [3]). In (28), functionω(χa)is the internal variable evolution function, such that(30)χ̇a=γ̇ω(Sab,χa)The motivation for a unique treatment for all yield functions is that any particular yield function is inserted by means of ϕ,nand derivatives ofn. This is accomplished with Mathematica and the AceGen add-on [29,17].Functions〈•〉and〈•〉Errorare respectively given by(31)〈•〉=•+|•|2(32)〈•〉Error=•+Errorln(2)ln[1+exp(−ln(2)Error•)]where〈•〉Erroris an approximation of〈•〉.With the objective of uniquely defining the element frame compatible with the concept of polar decomposition, use is made of the symmetric orthogonalization formula by Per-Olov Löwdin (cf. [19]). With that purpose, we resort to the singular value decomposition (SVD). Given a real 3×3 matrixJ, there exists a decomposition with the form(33)J=UΣVTwhereUis a 3×3 unit matrix,UTU=I,Σis a 3×3 diagonal matrix andVis a 3×3 unit matrix withVTV=I. Columns ofUare normalized eigenvectors ofJJTand columns ofVare normalized eigenvectors ofJTJ. The diagonal matrixΣcontains the singular values ofJin its principal diagonal. Singular values are nonnegative reals. Columns ofUare the left singular vectors and columns ofVare the right singular vectors. The non-zero singular values ofJare the square roots of the non-zero eigenvalues ofJTJ. In the present case columns ofJform a basis. Löwdin׳s formula provides the following orthogonal frame:(34)R=UVTIt was proved by Carlson and Keller [12] thatRobtained by this formula (34) is the proper orthogonal matrix whose columns have the minimum Euclidean distance to the corresponding columns ofJ. A more concise formula forRis(35)R=JVΣ−1VTand, sinceΣis a diagonal matrix, we have the following index notation:(36)Rij=1λlJikVklVjlwhere λl,l=1,…,n, are the eigenvalues ofJTJand columns ofVare the corresponding eigenvectors. In our case, and for a tetrahedron, we have the following specialization:(37)R0a=JaVaΣa−1VaTwhereJais the element Jacobian for configuration Ωa,Vaare the eigenvectors ofJaTJa. For the configuration Ωb, we have(38)R0b=JbVbσb−1VbTThe following notation is used for the Jacobian matrices:(39)Ja=∂xa∂ξ(40)Jb=∂xb∂ξwhereξis the vector of parent-domain coordinates. The motivation for the use ofR0aandR0bto obtain a rotation can be summarized as follows:In problems where local frames are required (anisotropic laws, fracture, shells), rotation can be obtained by multiplicationRab=R0aTR0b. For uniformity, we use the Löwdin local frames in all problems.The version of the Gurson–Tvergaard–Needleman model introduced by Reis et al. [28] is rewritten here in non-dimensional form:(41)ϕGTN(y,S,f⋆)=3STI6TdevS2y2−[1+q3f⋆2−2q1f⋆cosh(q2STI32y)]The effective void fractionf⋆is a function of the void fraction f . We use the nucleation part of the void fraction following the work of Chu and Needleman [15] using the normal distribution:(42)ḟN=fNSN2πexp[−12(εp−εNSN)2]ε̇pwhere fN, SNand εNare constitutive properties for the nucleation (N) part of the void fraction law. The classical void growth term of Gurson (cf. [16]) is adopted:(43)fG=1−exp(−εv)where εvis the trace of deformation. In addition, the shear part of Xue and Nahshon (cf. [37,24,25]) are combined to obtain the following term:(44)fS=3q62(6π)1/3(1−54det2[Sdev](STI6TdevS)3)f1/3εpa2Including the initial void fraction, f0, then the total f follows the following closed-form laws from the above classical relations:(45)f=f0+fN2[ERF(εNSN2)−ERF(εN−εpSN2)]+1−exp(−εv)︸f¯(46)+3q62(6π)1/3(1−54det2[Sdev](STI6TdevS)3)f¯1/3εpa2︸fSThe additional property q6 controls the void growth in shear. A depiction of (41) with is shown in Fig. 2. In contrast with the Rousselier model the GTN model is symmetric with respect to the trace ofS. The effect of increasing f can be observed as a uniform reduction in radius of the yield surface.The error functionERF(•)results from closed-form integration of the Gaussian curve and is available in several open-source libraries and is defined as(47)ERF(•)=2π∫0•e−t2dtTwo distinct types of effective plastic strain are adopted,33No power-consistent closed-form solution exists for the effective plastic strain in the classical Gurson model.εvand εp. The latter being given as(48)ε̇p=γ̇(1−f)ySabTnIntegration of constitutive quantities follow the unconditionally stable backward-Euler scheme:(49)εpa=εpb+Δγ(1−f)ySabTnIn addition, we have the trace of the flow vector, which is used to obtain εv:(50)ε̇v=γ̇(nTI3)It is straightforward to obtain the critical ff, corresponding to collapse, which is given by:(51)ff=q1+q12−q3q3The effective void fractionf⋆is calculated according to the additional property fc, using the Tvergaard–Needleman modification (cf. [35]):(52)f⋆={f,f<fcfc+ff−fcfm−fc(f−fc),fc≤f≤fmff,f>fmThe effective void fraction (52) is used in the yield function, and is not updated as is the case of f.The Rousselier [31] model for porous metals is characterized by the following yield function in non-dimensional form:(53)ϕR(y,S,f⋆)=32STI6TdevST(1−f⋆)y+σ1f⋆yDexp[STI33(1−f⋆)σ1]−1in whichf⋆is the effective void fraction in configuration Ωaand y is the yield stress. In addition to the hardening characteristics reflected in y, the only additional properties are σ1, D and the initial porosity f0. The property σ1 can be estimated from the original yield stress,y0=y(0)and the ultimate tensile strength,ymax=maxεpyas(54)σ1estimate=13(y0+ymax)Note thatymaxmust be provided by the actual hardening curve in the porous case. The effective void fractionf⋆depends on the corresponding constitutive void fraction f. A depiction of (53) is shown in Fig. 3. Note that the Rousselier model is asymmetric with respect to the trace ofS. The effect of increasing f can be observed. Void fraction follows from volume change and is calculated exactly as in the previous section. Fracture value ffcoincides with the zero stress condition fulfilling the conditionϕ=0:(55)ff=yDσ1It can be observed that D indirectly controls the void fraction rate. We can force the growth near the critical value of void fraction to model coalescence as in the GTN model, but with a slight difference (see [35]):(56)f⋆={f,f<fcfc+ff−fcfm−fc(f−fc),fc≤f≤fmff,f>fmwith fm, fcand ffbeing additional properties. An mentioned, initial void fraction f0 must also be provided. The equivalent plastic strain increment is computed based on the power equivalence relation:(57)SabTε̇p=(1−f){y−3σ1W[13Df⋆exp(y3σ1)]}︸y¯ε̇pwhereW(•) is the Lambert W function. The effective plastic strain rate is given by this power equivalence (see also [4]):(58)ε̇p=γ̇y¯SabTnand(59)ε̇v=γ̇(1−f)y(SabTI3)(nTI3)Integration of constitutive quantities follow the unconditionally stable backward-Euler scheme:(60)εpa=εpb+Δγy¯SabTnTime stepping is adapted so thatΔεp=εpn+1−εpnis kept below 5%. This measure is necessary for accuracy reasons in problems with localization.ForError=1×10−3we test the two porous plasticity models, along with the classical von-Mises yield criterion. Properties are shown in Table 1for the two presented models. Von-Mises is a particularization.Isoerror maps are shown in Fig. 4for the three yield functions. We use the properties shown in Table 2for the runs of the isoerror maps. Plane strain condition is assumed (4 direct stress components and 1 shear stress component). For each strain increment a single step is used. The following two conclusions are drawn:•Very small integration errors are observed for the von-Mises yield function. This is well known since in a simpler case an exact solution exists.The Rousselier yield function exhibits a larger error than the GTN yield function. This is now relatively well known since this yield function is not smooth for all stress states. It is also acknowledgedly difficult to integrate (cf. [4]).To estimate the properties for the Rousselier model from known properties of the GTN model, we can obtain D, σ1 from q1, q2 and q3 at a given void-fraction level fc. Using least-squares, we solve the following least-squares minimization problem Cf. Table 3:(61)minσ1,D12[(qGTN−qRousselier)2+(pGTN−pRousselier)2]where(62)qGTN=y1+fc(q3−2q1)(63)qRousselier=(1−fc)(y−σ1Dfc)(64)pGTN=2yq2arccosh(1+fc2q32fcq1)(65)pRousselier=3(1−fc)σ1log(yDfcσ1)Quasi-incompressible constitutive laws severely reduce the performance of displacement-based elements. Usually, mixed elements are a solution for avoiding locking in quasi-incompressible problems. The low-order MINI element by Arnold [5], see also Bathe [7] and Cao [11], is based on a two-field formulation where:•Pressure is linearly interpolated using the corner nodes.An internal shape function, named a bubble, enriches the velocity or displacement fields.We can therefore writeSab⋆bin Voigt form as a sum of deviatoric and pressure terms:(68)Sab⋆b=−JabpaI3+TdevSab⋆bwhereTdevis the following sparse matrix:(69)Tdev=[23−13−13000−1323−13000−13−1323000000100000010000001]In terms of power balance, we use the following relation, whereS˜ab⋆bdepends on the independent pressurep˜. It corresponds to a classical two-field variational principle:(70)∫Ωb(S˜ab⋆b)TėabbdΩb+∫Ωb(Jabp˜+(Sab⋆b)TI33)p˜̇dΩb︸Ẇint=Ẇextwhere the relative Jacobian Jabis used to ensure correct volume calculation. We note that the productJabp˜cannot be used as an unknown field. In (70), we have the following quantities:(71)S˜ab⋆b=−Jabp˜I3+TdevSab⋆bDiscretization follows the standard MINI formulation:(72)u(ξ)=∑K=15NK(ξ)uKIndependent pressurep˜is interpolated using the corner nodes:(73)p˜(ξ)=∑K=14NK(ξ)p˜K(74a)N1(ξ)=1−ξ1−ξ2−ξ3(74b)N2(ξ)=ξ2(74c)N3(ξ)=ξ3(74d)N4(ξ)=ξ1The bubble function, for tetrahedra, is given by(5)N5(ξ)=ξ1ξ2ξ3(1−ξ1−ξ2−ξ3)For the calculation of the stiffness matrix, the variation of (70) is required. Not all quantities are determined by hand-derivation, and we use Mathematica [29] with the AceGen (cf. [17]) add-on to calculate some derivatives. Using (70), we obtain(75)dẆint=∫Ωb[(dS˜ab⋆b)Tėabb+(S˜ab⋆b)Tdeabb]dΩb(76)+∫Ωb[dJabp˜+Jabdp˜+(dSab⋆b)TI33]p˜̇dΩbwhere the following notation was used:(77)dSab⋆b=Cabdeabb(78)dS˜ab⋆b=TdevCabdeabb−dJabp˜I3−Jabdp˜I3Specifically, the termsdeabbanddJabare determined by AceGen. In terms of rotation tensor, we use the following process to obtaine¯1,e¯2ande¯3.Dimensional reduction for plane-strain requires careful consideration of out-of-plane stress, which is in general non-null. We therefore explicitly enforce the plane-strain condition by setting 13 and 23 components of both stress and strain as zero, but including the out-of-plane stress[S˜ab⋆b]33as active. Therefore, for plane strain, we only omit out-of-plane shear components of stress and strain. In the axisymmetric case, we use reduced integration, which is sufficient to remove locking in the near-incompressible case.All examples are run in the SIMPLAS framework, cf. [1] with the present formulations. MINI elements were implemented to comply with the Löwdin frames and the relative Green–Lagrange strains. Internal degrees-of-freedom of mixed elements are condensed out.An axisymmetric idealization of a simple tension test with smooth geometry (cf. [6] for a complete testing program) is made, with the relevant dimensions shown in Fig. 5. The corresponding properties are shown in Table 1. Also shown in Fig. 5 are the contour plots for the effective plastic strain and void fraction in both models. Rousselier yield function produces earlier failure due to a steeper void fraction growth in the early nucleation stages. We can observe that no hourglass or mesh instabilities are visible and contour plots are relatively smooth.We compare the void fraction evolution for the two models, separating the nucleation and void growth terms, in Fig. 6. It can be observed that the growth term in Rousselier model44Note that properties have been fitted so that intersections in p- and q-axes for both models coincide atf=fc.is much quicker to develop and tends to localize strain in a sharper form (see also Fig. 5).Evolution of void fraction and effective plastic strain for the GTN yield function is shown in Fig. 7. Reaction–displacement results are also shown in the same figure. We obtain two conclusions:•Effective plastic strain and void fraction evolution are close (however not perfectly close in the case of the effective plastic strain) to the ones reported by Malcher et al. [21]. Reaction–displacement results are very similar to the reported experimental curve (cf. [21])Some mesh sensitivity is observed, however it can be considered mild and acceptable.This test, introduced by Bai and Wierzbicki [6] is required to assess the performance in shear of both yield functions. A description of this test is shown in Fig. 9with the corresponding geometrical data. Both [21,22] perform extensive testing with this test to calibrate the constitutive properties. In this work, and for this test, Aluminum 2024-T351 is used and both mesh size and time step size sensitivities are inspected.For the coarse mesh (due to size constraints), we show a sequence of relevant contour plots in Fig. 10. Since the MINI mixed element technology is employed, severe deformations are possible without volumetric locking. In addition, we note that a shear band is formed at the specimen weak region. Effect of step size is shown in Fig. 11for the GTN model and in Fig. 12for the Rousselier model. Only mild dependence on step size is observed. A complete depiction of the dependence on mesh size is shown in Fig. 13where again only slight dependence is observed. We note that, if stronger localization is required, then the mesh size has a serious effect in the results and regularization will be required. Mesh size effect on the effective plastic strain and void fraction evolution at the monitored node are shown in Fig. 14. In this case some effect is noted, which is not sufficient to detract from the overall very robust results.To inspect the mesh dependence with full localization (until collapse), we use the geometry from Norris tension test [26] (see also [32]). Fig. 15shows the tension test specimen with effective plastic strain and void fraction contour plots. Two meshes are used: a coarse one with 3175 nodes and a finer one with 5409 nodes (the latter is used in the contour plots). A fixed displacement step ofΔw=0.02is adopted for this problem. We use the constitutive properties described in Table 4which produce full localization. Regularization is performed by introducing a length-scale lcratio in Eq. (42) withεp→lcεp, and Eq. (43) withεv→lcεvfor the GTN model and similarly for the Rousselier model. This is sufficient to produce nearly mesh-insensitive results. The length-scale ratio is defined as follows:(79)lc=minlelfwhere leis the edge length and lfis the fixed length size, a constitutive property (given in Table 4). Relatively smooth effective plastic strain and void fraction contour plots are obtained. In terms of displacement/reaction results for the GTN problem, we test the unregularized (lc=1) and regularized cases with the two meshes (see Fig. 16for the GTN case). The length scale is sufficient to obtain insensitive results. For the Rousselier model, see Fig. 16, the same conclusion is obtained.

@&#CONCLUSIONS@&#
We presented a general semi-implicit constitutive algorithm and specialized it for the integration of porous plasticity yield functions. New contributions and distinctive features of the proposed algorithm are:•The combination of relative Green–Lagrange strains with the exact corotational method. Quadratic strains are used during iteration whereas a local frame is updated after convergence of Newton iteration.The use of Löwdin algorithm to calculate orthogonal frames based on the Jacobians of configurations Ωband Ωa. This corresponds to a definition of orthogonal frames consistent with the polar decomposition.The use of a local constitutive system which is smooth and nonlinear. This is achieved in two steps by replacing the complementarity condition for a non-smooth equation and subsequently by the Chen–Mangasarian replacement function (cf. [13,14]). Local Newton iteration is performed without concerns with the complementarity condition.The GTN and Rousselier constitutive models are explored in detail, with the determination of intersections with axes of pressure–shear diagram (p–q). We include isoerror maps and the explicit determination of the void fraction in both models.The use of finite strain versions of the MINI element (cf. [5]) in triangles and tetrahedra to avoid locking due to quasi-incompressibility in the early stages of void fraction evolution. Specializations and the second variation of the variational principle, required to calculate the stiffness matrix.The use of a length-scale in the stress measures and effective plastic strain present in the void growth laws, which was found to be sufficient to produce mesh-insensitive results. This is shown in the 3D tension test, where both models were tested with two meshes.