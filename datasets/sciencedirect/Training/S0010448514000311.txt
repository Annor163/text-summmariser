@&#MAIN-TITLE@&#
Interactive real-time physics

@&#HIGHLIGHTS@&#
Unified physics engine for both static–dynamic load analysis, structural optimization and form finding.The implementation combines dynamic relaxation and co-rotational formulation.Interactive structural analysis as a teaching and design aid.Interactive structural form-finding.

@&#KEYPHRASES@&#
Interactive structural analysis,Interactive structural form finding,Co-rotational formulation,Dynamic relaxation,

@&#ABSTRACT@&#
Real-time physics simulation has been extensively used in computer games, but its potential has yet to be fully realized in design and education. We present an interactive 3D physics engine with a wide variety of applications.In common with traditional FEM, the use of a local element stiffness matrix is retained. However, unlike typical non-linear FEM routines elements forces, moments and inertia are appropriately lumped at nodes following the dynamic relaxation method. A semi-implicit time integration scheme updates linear and angular momentum, and subsequently the local coordinate frames of the nodes. A co-rotational approach is used to compute the resultant field of displacements in global coordinates including the effect of large deformations. The results obtained compare well against established commercial software.We demonstrate that the method presented allows the making of interactive structural models that can be used in teaching to develop an intuitive understanding of structural behaviour. We also show that the same interactive physics framework allows real-time optimization that can be used for geometric and structural design applications.

@&#INTRODUCTION@&#
This paper describes the formulation of a physics engine which combines the principle aspects of Dynamic Relaxation [1] and those of the co-rotational formulation for the Finite Elements Method [2]. Our formulation draws on the work done by Williams [3] and shares similarities with recently published works in the literature [4]. Our contribution is to frame dynamic relaxation within the co-rotational approach in order to enable both the static and dynamic simulation of structures with geometrically non-linear behaviour (i.e. small strains, finite displacements and rotations). Such an approach aims at building a unified engine that can use linear formulations for conventional beams, shells/plates and 3D elements whilst being able to compute accurately displacement and stress fields in both static and dynamic problems.The formulation lies at the core of software, implemented by the authors, which has been published online as a java applet (http://expeditionworkshed.org/) in 2011 and since then adopted in both design and education by several universities in the UK. A description of their applications such as geometric and structural optimization tasks and the development of interactive structural models for teaching aid are given in the last section of the paper.Computational mechanics based on particle systems have been extensively used in computer graphics for realistic simulation of rigid and deformable bodies, elastoplastic deformation, fractures and fluids [5,6]. These applications frequently make use of the Verlet integration scheme [7], a method originally developed for simulation of molecular dynamics. This scheme can be shown to be very closely linked to the method of dynamic relaxation, a numerical method formulated as an alternative to other relaxation techniques such as Gauss–Seidel or successive over relaxation for solving systems of partial differential equations using finite difference approximation. Newmark [8] developed a method that used implicit integration and global stiffness, mass and damping matrices for both the static and dynamic solutions of structures with both material and geometric non-linear behaviour. Day [1] implemented an explicit solution method for the analysis of portal frames and plates and Otter for the analysis of pre-stressed concrete pressure vessels [9]. Later, these methods were adapted to finite elements problems [10] finally assuming the popular formulation in which equilibrium and compatibility relations are separated and no overall stiffness matrix of the structure is assembled. Successively, it was further improved by other authors amongst with Barnes [11] and Wakefield [12].Dynamic Relaxation is based on the discretization of the continuum into a set of concentrated masses (called particles or nodes) linked by elements (which can be one, two or three dimensional) defining how forces and moments propagate through the system. The method has been mainly used to solve static problems which are converted into dynamic problems with the use of fictitious masses and viscous damping at nodes.Non-linear FEM routines are usually implemented using implicit Newton–Raphson methods. Compared to Newton–Raphson methods dynamic relaxation needs less memory because there is no need to store and update the global structure stiffness matrix(N×N)but only the internal forces of the elements(N×1)whereNis the number of the nodal degrees of freedom. Since there is only need to derive the internal force vectors and the elements linear stiffness matrix, it is easier to include the higher order terms of the strain–displacement relations for the element [13]. In addition, it can be proven that for NR implicit methods the operation count is proportional to the number of elementsO(ne7/3)while for DR isO(ne4/3)(neis the number of elements) thus making the latter better suited for systems with larger number of elements [14] cited in [4]. On the other hand, DR is conditionally stable and requires pre-computation to estimate optimum parameters such as the integration time step to ensure convergence and stability.DR has been used for the design of grid-shells and tension structures such as those built with cable or fabrics, and more generally for the static solution of structures exhibiting material and geometrical non-linearity. A good review of applications of DR on building scale projects is given in [15]. Other recent examples of structural form-finding can be found in [16,17]. On-going work that adopts a force-based approach for purely geometric related optimization applications is the software called Kangaroo developed by Piker [18].The co-rotational formulation was developed for the analysis of geometrically non-linear structures under the assumption of small strains but arbitrarily large displacements and rotations [19,20]. It can be considered the most recent kinematics description after the Total Lagrangian and Updated Lagrangian which have been used extensively in the FEM analysis of structures with non-linear behaviour.The main idea behind the co-rotational approach is to separate the motion of the element into a rigid motion and a purely deformational part. Each element has a base (also called initial or rest) reference frame and its own co-rotated frame obtained as a rigid body motion (translations and rotations) of the base frame. When rotational degrees of freedom are involved, the nodes of the element have their own rigidly attached frames which move with the element. Deformations are measured with respect to the element co-rotated frame (Fig. 1).The node frames are effectively utilized to describe the element orientations at its ends. During load analysis, the difference between the orientations at the element’s ends and the co-rotated element frame represent the rotational part of the deformation. In form-finding or geometric optimization, the node orientations can be used to measure the difference with respect to target orientations specified beforehand. Fig. 1 shows the different reference frames for a beam element.Fig. 1 shows the kinematics for a co-rotated beam element in two dimensions; in Section  2.5 the main steps of the formulation for beam elements in 3 dimensions (6 degrees of freedom) are given; the same approach can be taken for 2D elements (i.e. plates, shells) [21] and 3D elements (i.e. tetrahedrons, bricks) [22].Due to the fact that each element has its own co-rotated frame and that deformational displacements and rotations are measured with respect to it, for sufficiently small element sizes the small strains assumption holds while both rotations and displacements can be arbitrarily large [23].Dynamic Relaxation is well suited to problems that are solved with the FEM formulation and can be implemented using standard element libraries [10].The co-rotational formulation qualifies as “element independent”. This definition comes from the fact that the relations between the local and global element deformational displacements and rotations are defined by a transformation matrix and consequently the stiffness and the local forces and moments depend on the choice of the local coordinate system. However, the relation between the local and global deformation is independent of the particular strain definition used [24,21]. In simpler words, the addition and removal of the rigid body motion part from translational and rotational displacements can be implemented separately from the element and the solver sub-routines. In addition, the fact that each element has its own co-rotated frame allows keeping deformations small with respect to the frame. For these reasons, standard linear or geometric-non-linear FEM libraries can be adopted immediately without the need of new implementation.A disadvantage of the co-rotational formulation is the involvement of relatively complex mathematics when rotational degrees of freedom are involved especially considering that finite rotations are not commutative and generally non-additive. However, several parameterizations of rotations are available that can be integrated in both explicit and implicit integration stepping routines [25].

@&#CONCLUSIONS@&#
Conventional engineering education draws a neat separation between linear and non-linear methods for structural analysis. In addition, design through optimization whether for size, shape or geometry is regarded as an advanced topic and most often is not part of the students’ curriculum. Combining computational techniques developed in computer graphics and established numerical methods for structural analysis creates a platform that can be used by students and designers to gain a qualitative and quantitative understanding of the structural behaviour of simple and complex systems. Real-time feedback and the possibility to interact with the model offer tremendous potential in teaching.Next steps will focus on expanding the range of elements available to plates/shells and 3d elements such as tetrahedrons and 8-node bricks. Further investigation to understand the benefits that such a platform can bring in teaching and design by means of analysis of performances in terms of structural efficiency, fabrication constraints and aesthetics will continue in order to gather stronger quantitative evidence.