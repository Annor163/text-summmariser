@&#MAIN-TITLE@&#
Derivative analysis for layer selection of geophysical borehole logs

@&#HIGHLIGHTS@&#
Differential wavelet operator for automated borehole blocking.Hierarchical blocking based on layer importance.Layer blocking based on minimum thickness, # of layers and % of total layers.Full Matlab code freely available under Creative Commons.

@&#KEYPHRASES@&#
Wavelet,Derivative analysis,Borehole,Blocking,Geophysical layer,

@&#ABSTRACT@&#
Analysis of geophysical borehole data can often be hampered by too much information and noise in the trace leading to subjective interpretation of layer boundaries. Wavelet analysis of borehole data has provided an effective way of mitigating noise and delineating relevant boundaries. We extend wavelet analysis by providing a complete set of code and functions that will objectively block a geophysical trace based on a derivative operator algorithm that searches for inflection points in the bore log. Layer boundaries detected from the operator output are traced back to a zero-width operator so that boundaries are consistently and objectively detected. Layers are then classified based on importance and analysis is completed by selecting either total number of layers, a portion of the total number of layers, selection of minimum layer thickness, or layers detected by a specified minimum operator width. We demonstrate the effectiveness of the layer blocking technique by applying it to a case study for alluvial aquifer detection in the Gascoyne River area of Western Australia.

@&#INTRODUCTION@&#
When examining information from boreholes, we often combine the use of drillers' lithological with geophysical borehole logs to determine relevant properties of the earth. However, the lithology record from the drilling process may be in error. This can be due to the type of drilling process used, such as a mud rig in a clay-rich environment, whereby discrimination of earth materials from drilling mud may be difficult or impossible, or it may be because drilling samples are only taken every metre to half-metre; and thereby information is lost during the drilling process. By comparison, geophysical logs are taken after the borehole has been drilled (and developed, in the case of water bores) and the tools are lowered to record information continuously. However, noise in the measurement of geophysical properties can be an issue, and the natural identification of layer boundaries may therefore be difficult or problematic. In addition, the actual resolution ability of the borehole device may be limited, so that layers from geophysical logs are smeared out. This can often be the case for natural gamma logging, which takes continuous recording over time intervals while being lowered; but it can also affect apparent conductivity logging. The separation of the transmitting coil from the receiving coil limits the minimum layer resolution in the well-log (e.g., Kaufman and Dashevsky, 2003).Recent advances on the natural identification of borehole layers and boundaries have been made with the use of wavelet transforms of geophysical well-logs (see for example Cooper and Cowan, 2009; Webb et al., 2008; Choudhury et al., 2007; Cowan and Cooper, 2003). Wavelet analysis transforms the profile data into depth and transform information which, in the case of geophysical logs, shows the power of the log signal as a function of the depth under ground. The efforts of these authors, which rely mostly upon the Morlet and Mexican Hat wavelets, have shown that wavelet analysis is an effective tool for de-noising and blocking geophysical log data. Cowan and Cooper (2003) use Haar and Morlet wavelets to examine magnetic susceptibility data in Western Australia. The Haar wavelets effectively limited high-frequency noise from the downhole logs, and showed clear images of the long-wavelength variations in the subsurface. Continuous wavelet transforms were also applied to density and susceptibility data in drillcore measurement by Webb et al. (2008), revealing statistical patterns in the density data that were previously undiscovered. The work of Cowan and Cooper (2003) was expanded upon several years later, where Cooper and Cowan (2009) use the continuous transform Mexican Hat Wavelet to analyse magnetic susceptibility log data in Australia for banded-iron formations in Hammersley Basin. They compare wavelet analysis to median and mean filtering with favourable results, and show that the Mexican Hat continuous wavelet transform is as effective as, or more effective than, using a mean or median filter for automated layer selection of data.In this paper, we further develop the concept of Cooper and Cowan (2009) by applying a derivative-type analysis based on a piecewise-linear approximation to the Mexican Hat wavelet transform. Instead of focussing on the frequency and signal content of the geophysical log, we examine the other primary purpose of wavelets of this shape: derivative analysis. Our wavelet, which acts more as an operator, effectively takes the second derivative of any geophysical bore log. Layer boundaries are objectively detected by looking for the inflection points in the log, and boundaries of layers in the transformed space are then traced back to zero-width derivative operators. We briefly explain how the derivative operator transforms the borehole trace, and how the transformed data is analysed for blocking. We provide tools for examining the blocked trace, and hierarchically classify layers based on layer-importance, proportion of total layers, and layer thickness. We show that the derivative analysis can be used for a variety of post-processing analysis techniques, including forward modelling for other complementary geophysical measurements and improving lithology layers from drilling records. We present a freely available, complete, working and annotated Matlab code package for the geophysical community under the Creative Commons Attributions CC-BY licence 3.0 (Creative Commons, 2013).

@&#CONCLUSIONS@&#
Following on the previous work of other authors, we present a package of open-source code that is freely available under the Creative Commons Attributions CC-BY licence 3.0. Our software revisits the use of wavelet transforms to de-noise and block geophysical borehole data. Instead of using the Mexican Hat wavelet, we approximate it by piecewise linear curves that essentially act as a second-derivative operator at increasing widths. The transformed matrix is then examined for areas and points of inflection (which are seen as zero-crossings in the data). The inflection points are traced back to zero-width operators which define the layer boundaries in the geophysical log. Layer regions are then organised into closed regions and indexed according to a hierarchical order based on layer thickness and total deflection. Layer blocking is then determined based on operator input so that the number of blocked layers is determined by three selection criteria: number of layers detected, % portion of total layers detected, or layers that are above a certain minimum thickness. The output data is then a Matlab structure that contains layer thickness, layer depth, and the mean, median and variance of each layer.In this paper, we demonstrate the usefulness of our geophysical data analyser by applying it to apparent conductivity and natural gamma data of a borehole selected from the Gascoyne Foodbowl Initiative operated by the Department of Food and Agriculture, Western Australia. In a joint project, we use the blocked apparent conductivity trace as a tool to assist in the selection of an electromagnetic airborne system for the Royalties for Regions Project in the Gascoyne River area outside Carnarvon, Western Australia. We show how we used the blocked conductivity data as ground truth information for generating the forward and inverse models of the AEM systems. Part of our selection process for this project is based on an analysis such as this. We have also shown that by combining apparent conductivity and natural gamma logs, we can compare to the lithology records obtained by hydrogeoelogists during drilling. Our blocked layers match extremely well with the lithology boundaries recorded by the hydrogeologist, however, we detect additional layers in the geophysical logs that were only hinted at in the drilling notes. We assert that our technique can be used in routine improvement of lithology data through geophysical borehole analysis. Derivative analysis of borehole data can objectively and consistently discriminate geophysically meaningful boundaries. The degree to which the trace is blocked out for subsequent analysis is entirely controlled by the operator, so that a good balance of signal to noise can easily be achieved.