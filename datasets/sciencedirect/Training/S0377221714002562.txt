@&#MAIN-TITLE@&#
Solving real-world cutting stock-problems in the paper industry: Mathematical approaches, experience and challenges

@&#HIGHLIGHTS@&#
We bridge research in optimization to real world cutting stock problems (CSPs).We develop two advanced column generation algorithms for 1D CSPs.We develop an Exhaustion Method for 1-CSPs with two criteria.We develop a sophisticated solution method for 2D-trim-loss minimization problems.We assemble a benchmark data set of 25 real world 1D cutting stock instances.

@&#KEYPHRASES@&#
Paper industry,Cutting stock,Roll production,Format production,Column generation,

@&#ABSTRACT@&#
We discuss cutting stock problems (CSPs) from the perspective of the paper industry and the financial impact they make. Exact solution approaches and heuristics have been used for decades to support cutting stock decisions in that industry. We have developed polylithic solution techniques integrated in our ERP system to solve a variety of cutting stock problems occurring in real world problems. Among them is the simultaneous minimization of the number of rolls and the number of patterns while not allowing any overproduction. For two cases, CSPs minimizing underproduction and CSPs with master rolls of different widths and availability, we have developed new column generation approaches. The methods are numerically tested using real world data instances. An assembly of current solved and unsolved standard and non-standard CSPs at the forefront of research are put in perspective.

@&#INTRODUCTION@&#
The pulp and paper industry plays an important role worldwide. There are in the order of 3000 paper mills, which produced a total of 394million tons of paper and paperboard, in 2010. Europe (including Russia) has approximately 900 paper mills, while Germany has about 180. The largest producer in the world is the Finnish UPM group with an annual tonnage of 12.7million tonnes, followed by Stora Enso with 11.8million tons and by International Paper with 9.7million tonnes per year. Santos and Almada-Lobo (2012) report that in Portugal the pulp and paper industry contributes over 4% of the GDP and 5% of the active employees. As it is subject of both local and global environmental discussions, effective planning and cutting stock techniques lies at the very heart of the operational performance of its manufacturing organizations.Exact solution approaches and heuristics have been used for decades to support cutting stock decisions in the paper industry. In the standard cutting stock problem (CSP), the problem input is given by a set of item sizes and demands, and by a set of master rolls of given widths; the simplest case consists of only one type of master rolls. The task is to decide on how many master rolls are cut to a certain pattern in order to minimize the total number of master rolls used.The pattern minimization problem (PMP) is a strongly NP-hard cutting problem, which seeks a cutting plan with the minimum number of different patterns, cf.McDiarmid (1999). This objective, relevant when changing from one pattern to another, involves a cost for setting up the cutting machine, i.e., adjusting the cutting knifes. When the minimization of the number of different patterns is done by assuming that no more than the minimum number of rolls can be used, the problem is also referred to as the cutting stock problem with setup costs.The international working group SICUP (Special Interest Group on Cutting and Packing) founded by Gerhard Wäscher in 1988, focuses on cutting stock and packing problems and is a platform for more than 200 practitioners and scientists to exchange ideas on these topics. In 2004, SICUP became the EUROworking group ESICUP (EURO Special Interest Group on Cutting and Packing).The main contributions of this paper can be classified into two categories:Mathematical optimization:For 1D CSPs with two criteria, minimizing the number of rolls and the number of patterns, we develop an Exhaustion Method (Section 3.4), a column generation approach allowing underproduction (Section 3.5.4) and column generation approach incorporating master rolls with different widths and limited availability (Section 3.5.5). We present a novel polylithic1The term polylithic has been coined by Kallrath (2009a) and explained in greater detail in Kallrath (2011); it refers to modeling and solution approaches in which mixed integer or nonconvex nonlinear optimization problems are solved by tailor-made methods involving several models and/or solve statements or algorithmic components.1solution method towards 2D trim-loss minimization (Section 4). Furthermore, we share real data in a 1D cutting stock benchmark data set (Section 3.6.1). For software products, it is not untypical to combine various basic algorithms to consistently provide solutions in acceptable time, with many empirical rules, or even rules of thumb, to decide which algorithms to use in each circumstance. We disclose this information instead of keeping it as a commercial secret, to provide evidence that there is more exact optimization and less heuristics involved as one might expect.We present real-world aspects relevant to the paper industry, which have seen only little treatment in the scientific literature (Section 3.5). We assemble current cutting-edge standard and non-standard cutting stock problems relevant to the paper industry (Section 5) and illuminate at length the variants and issues present in real-world problems. We discuss the financial impact mathematical programming-based solutions to cutting stock problems have in the paper industry (Section 6).The remainder of the paper is structured as follows: After a literature review in Section 2, we discuss the 1D CSP and its variants in Section 3 along with different solution techniques. A presentation of 2D polylithic solution methods in Section 4 is followed by a discussion of current-edge CSPs in Section 5 and our views on optimization in the paper industry in Section 6. Conclusions are in Section 7. Two appendices, post-processing (Appendix A) and and guidelines on how to derive the pricing problems (Appendix B) complete this paper.

@&#CONCLUSIONS@&#
Motivated by challenges arising in the paper industry, we have presented various polylithic solution approaches to model and solve a testbed of 1D and 2D real-world cutting problems. The methods are implemented in GSE’s ERP system. We have developed new column generation approaches to treat problems with different master roll widths, limited number of master rolls on stock, or problems in which underproduction is allowed but to be minimized. Numerical experiments demonstrate the value of these approaches and in some data instances also suggest either the use of Branch&Price techniques or other solution methods like the Exhaustion Method, which is very efficient and produces near optimal solutions for minimizing the number of patterns. The presented polylithic solution methods yield practically superior solutions compared to the standard GGA, with practically feasible computational times.As each paper producing company has its own production processes specific cutting machines, the mapping of reality and abstraction into a mathematical model and algorithm has, to our experience, the highest priority to receive the appreciation of our clients. Besides this, future research and efficient mathematical techniques on the integration of CSPs into the production planning process and the incorporation of uncertainty would be very welcome.The GGA/CGA produces solutions which are minimal in the number of rolls but are occasionally lead to overproduction exceeding the demandDibySipieces. We have developed three heuristics to eliminate overproduction: The first one just modifies patterns, the second one modifies patterns and generates new ones, and the third one is a combination of both.In Case 1, for a givenSi, we can find a pattern p used with multiplicityMpandNip>0subject to(A.1)∃κSi=κMp∧κ=1,2,…,Nip∈IN,whereκis an integer number. In this simple case, we modify pattern p as follows:Nip≔Nip-κandwp≔wp+κWi.This implies that the number of pieces i, produced by using pattern pMptimes, is reduced bySi=κMp.Case 2 is more complicated. LetRip≔NipMpdenote the number of pieces i produced by using pattern pMptimes. If we allow a new patternp′, in which item i occursμtimes, to be usedπtimes, the reduction condition reads nowNip-κMp-π+μπ=Rip-Sior(A.2)κ+μ-Nipπ=κMp-Si,whereπreduces the number of rolls cut to pattern p. The termμπconsiders the number of pieces of type i produced by using the new patternπtimes. Depending on the solution of (A.2),p′does not contain item i at allNp′i=0or has a reduced number of itNp′i<Nipwhile others itemsi′remain unchangedNi′p′=Nip. Forπ=0we obtain the simple case (A.1) above; it suffices to modify just one pattern.We solve the diophantine Eq. (A.2) by tests in three nested loops:π=0,1,…,k=1,2,…,Npi,μ=0,1,….The existing pattern p is modified byNip→Nip-κandMp→Mp-π.Forp′, item i and all other itemsi′≠iwe applyNi′p′→Nip,Nip′→μ,Mp′→π.Unfortunately, there are still situations not covered by Case 1 and Case 2. Let us illustrate this for itemi=14(also called A14) by the following example withD14=1:itemNipMpp11A1412p12A1415p23A1411We haveS14=7surplus items. The patternsp11,p12andp23contain other items not relevant here. The equality (A.1)Si=κMpdoes not have a solution forκ⩽1;similarly, (A.2) does not have a solution. The best we could do is to eliminate A14 inp23which leaves a surplus ofS14′=6.Therefore, we add Case 3. For those widths i withSi>0we generate a listLi≔{p1′,p2′,p3′,…}, which contains those patterns in which item i occurs, i.e., for all elementspm′∈Liwe have:Nipm>0withpm=p(pm′)for all m. Now we check for all m, whetherκ⩾1exists withκMp⩽Si. If it exists, item i in patternpmis eliminated k times and we obtainSi′≔Si-κMp. IfSi′>0, we continue the test for the next m and patternpmuntil all patterns inLihave been tested. If after this, we still haveSi′>0, we continue with Case 2.In this section, we briefly describe how the pricing problems of the cutting stock problem are derived.Let the master problem (minimization problem) contain all possible patternsP; the restricted master problem the patternsP′⊆P. An optimal solution of restricted master problem defines also an optimal solution for the master problem, if all the reduced cost(B.1)cp-πAp⩾0∀p∈Pwith objective function coefficientcpfor variableμp, (vector of) dual variablesπof all functional constraints andApbeing the constraint coefficient matrix of variableμp.Thus the pricing problem is obtained my minimizing (B.1) over all p. Naturally, the constraints of the pricing problem ensure that the newly computed pattern is feasible, i.e., is part of the setP.Let us illustrate this by the objective function term(B.2)∑r∈R∑p∈Pr′Br-∑i∈IWi-1Nipμpoccurring in (27). From this term and the inequalities (28)(B.3)∑p∈Pr′μp⩽Nr,∀r,and (8)(B.4)∑p∈P′Nipμp⩾Di,∀i,we had derived the pricing problem(B.5)zr∗≔minBr-∑i∈IWi-1αi-πr-∑i∈Iπiαi.We note in (B.5) that the∑p∈Pr′has disappeared, and that all occurrences ofNiphave been replaced byαi. Instead of∑r∈Rwe have to deal with r independent pricing problems to be solved. The coefficients appearing with the Lagrange multipliersπrandπiare those in (28) and (8) appearing with theμpvariables.Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.03.027.