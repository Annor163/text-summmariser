@&#MAIN-TITLE@&#
On the performance of digital adaptive spur cancellation for multi-standard radio frequency transceivers

@&#HIGHLIGHTS@&#
We model a multi-spur pollution and take into account the impairments affecting the spurs (pulsation shift, phase noise).We derive all closed-form formulae (optimal step, Signal to Interference Ratio) of the LMS-based spurs cancellation scheme.We add an original adaptive step overlay to improve the transitional mode while keeping the same asymptotic performance.

@&#KEYPHRASES@&#
Multi-standard transceiver,Radio frequency impairment,Spurs,Digital cancellation,Least-mean-square (LMS) algorithm,Adaptive-step-size algorithm,

@&#ABSTRACT@&#
This study deals with the asymptotic performance of a multiple-spur cancellation scheme. Radio frequency transceivers are now multi-standard and specific impairment can occur. The clock harmonics, called spurs, can leak into the signal band of the reception stage, and thus degrade the performance. The performance of a fully digital approach is presented here. A one-spur cancellation scheme is first described, for which we exploit the a priori knowledge of the spur frequency to create a reference of the polluting tone with the same frequency. A least-mean-square (LMS) algorithm block that uses this reference to mitigate the polluter is designed. However, due to imperfections in the physical components, there is a shift between the a priori frequency and the actual frequency of the spur, and the spur is affected by Brownian phase noise. Under these circumstances, we study the asymptotic and transient performance of the algorithm. We next improve the transient performance by adding a previously proposed adaptive-step-size process. In a second part of this paper, we present a multiple-spur parallel approach that is based on the one-spur cancellation scheme, for which we provide a closed-form expression of the asymptotic signal-plus-noise interference ratio in the presence of frequency shifts and phase noise.

@&#INTRODUCTION@&#
The development of multiple standards for wireless communication, from Global System for Mobile (GSM) to Long-Term Evolution (LTE), has been motivated by the increasing demand for mobility and new telecommunication services (e.g., data, audio, video) [1]. The coexistence of different wireless systems has resulted in multi-standard solutions for the mobile architecture loading, for instance, GSM, 3G, LTE, and WiFi devices, each of which comes with their specific impairments [2–5].Due to a multiplicity of the operating frequencies and the physical proximity between the components, harmonics from clocks, called spurs, can appear at detrimental frequencies. These spurs can have at least two harmful consequences. First, due to substrate coupling between components, they can leak into the phase-locked loop. If they fall near the transmission frequency, they can demodulate the received signal into the receiver path, which leads to degradation of the receiver signal-to-noise ratio (SNR) [6]. The second case is when spurs couple directly into the receiver path, which leads to a mixture of desired noisy signal and additive spurs (see Fig. 1).Spurs can be mitigated using different passive and active techniques. From frequency planning [7] to clock spreading [8,9], all of these passive methods aim at mitigating the level of the spur, to reduce the polluting interference that is synthesized.Nevertheless, the multiplicity of standards that are supported has lead to the constant growth of spur sources (which is related to the growing number of operating frequencies), and passive cancellation has become more difficult. At the same time, radio frequency (RF) transceivers contain more and more digital parts, and signal processing techniques are becoming an area of interest for problematic RF impairment [10–12,6]. Thus, active methods for spur cancellation that are based on notch filter techniques or signal processing algorithms have been developed over the last few years [13–17].In this study, we focus on direct pollution from spurs. The observed noisy signal is polluted by a fixed number of spurs that need to be mitigated. The aim of this study is to propose a fully digital approach for spur attenuation and to derive its analytic performance. We first focus on a one-spur model, for easy comprehension, and then extend the problem and results to a multiple-spur compensation model.Our method is based on (more or less accurate) knowledge of the spur frequency. The algorithms studied here are based on synthesized references of the spurs, which are tones with the same frequency. Due to imperfections in the physical components, the reference cannot be considered as a perfect replica of the polluting spur. We assume here that there is a shift between the a priori or expected frequency (assumed to be known or estimated) and the actual frequency of the spur. However, in real cases, the spur is not a pure tone, as it is modulated by phase noise (PN). This PN should follow a Brownian model, which is a classical model used in the literature for free-running oscillators [18–21].For the one-spur model, we introduce a mono-spur cancellation block. For this real-case model, we derive closed-form formulae of the signal-plus-noise-to-interference ratio (SNIR) at the output of the algorithm. We also give an equivalent scheme, which is a notch filter, and propose a frequency interpretation of the system design. Then, we improve the transient response of the algorithm by adding a previously proposed adaptive-step-size process to the least-mean-square (LMS) algorithm, which leads to a more rapid solution that has the same asymptotic performance.In the second part of this paper, we consider a problematic P-spur mixture, and propose a multiple-spur cancellation scheme based on a parallel structure that is composed of P mono-spur cancellation blocks. In this model, we still consider imperfections, e.g., PN and frequency shift (FS), for all of the spurs and references, and compute the theoretical values of the asymptotic SNIR in the most general case. Our main contributions, in addition to being a comprehensive study, can be summarized below:•Proposition and analytical analysis of a LMS-based algorithm for multiple-spur pollution with specific impairments (frequency shift and phase noise), with a frequency interpretation of the compensation system (equivalence to a first-order infinite impulse response (IIR) notch filter).Derivation of closed-form expressions usable to tune the step-size parameter of the LMS-based spur cancellation algorithms, as well as to predict the SIR performance with respect to the polluter properties (frequency shift values, phase noise variances, reference amplitudes). To the best of our knowledge, no such analytical results have been found to date.Proposition of an adaptive step overlay to the LMS algorithm to improve the transient response while keeping the same asymptotic performance. The improved algorithm has almost the same convergence speed as the recursive least squares (RLS) algorithm, but can better cope with a sudden change in the configuration of the spurs (if the parameters of the reference remain unchanged).This paper is organized as follows. We give the one-spur model in Section 2 and present the cancellation scheme in Section 3, for which we express asymptotic and transient studies. Then, we develop a multiple-spur cancellation scheme and provide closed-form formulae of the overall performance in Section 4. Section 5 validates our method and theoretical results through simulations.In this section, we first consider the cancellation of a single spur. The discrete-time observation model (at sample timenTs) is(1)d(n)=x(n)+b(n)+s(n),whered(n)is the observed signal,x(n)is the zero-mean data signal of varianceσx2,b(n)is circular complex additive white Gaussian noise with zero mean and varianceσb2, ands(n)is the additive spur. The spur is expressed as(2)s(n)=Aej(ω−δω)n+jϕ(n)+jϕ0,where A is the unknown amplitude,ϕ0is the unknown phase,ϕ(n)is the PN that affects the spur, and ω is the a priori spur (natural) frequency, which is normalized by the sample time. Nevertheless, due to imperfections in the oscillators, the spur is affected by an unknown (natural) frequency shift (FS)δω, which corresponds to the difference between the normalized a priori frequency and the normalized effective frequency of the spur.As mentioned in the introduction, we consider here that the PN is under a Brownian model [19–21]. The evolution of the phase is(3)ϕn+1=ϕn+ξ(n),withϕ(0)=0andξ(n)is an additive white noise of varianceσξ2.As the a priori frequency of the spur is known, a reference signal is synthesized as an image of the polluting spur. The evolution of this reference is written as(4)u(n)=Bejωn+jϕR,where B is the amplitude of the reference andϕRis its phase. In a real case, the synthesized reference can also have a FS and PN. Nevertheless, as it is only the global FS (spur + reference) and the global PN that matter, we assume for simplicity that all of the imperfections are attributed to the spur. The aim of the cancellation is to use the synthesized referenceu(n)to cancel the polluting spur and to evaluate the influence of the PN and FS on the performance. The influence of the polluting spur, in terms of the signal-plus-noise-to-interference-ratio (SNIR) expressed in dB, is(5)SNIRMixture=−10log10⁡(A2σx2+σb2).We denotee(n)as the compensated signal after application of the algorithm, and introduce the estimation errorϵ(n)as(6)ϵ(n)=x(n)+b(n)−e(n).The asymptotic variance of the estimation errorσϵ2is expressed as(7)σϵ2=limn→∞⁡E[|ϵ(n)|2].The spur canceler is not intended to cancel the additive noise term. As we focus here on the performance of the spur canceler and not on the impact of the additive white noise, we consider for the performance measurement that the noise is part of the desired signal. In other words, regarding the spur cancellation algorithm, the desired signal is the observed signal without the spur. The performance of the algorithm will be described by the SNIR after compensation, defined by:(8)SNIRcomp=−10log10⁡(σϵ2σx2+σb2).For the theoretical results, several hypotheses are made:•The desired signalx(n)is a white complex zero-mean circular signal;The normalized FSδω≪ω(normalized frequency);The PN varianceσξ2≪1.We will see in Section 5.1 that the last two assumptions are completely satisfied in practical cases. The link between our model parameters (δωandσξ2) and physical parameters of oscillator used in practice will also be explained later.The compensated signale(n)is obtained by subtracting the estimated spur valuesˆ(n)from the input sampled(n). This value is obtained by multiplying the reference signalu(n)by a complex adaptive coefficientw(n), which is updated using the output of the algorithme(n), as shown in Fig. 2.From an analysis perspective, let us introduce the ideal coefficient for this cancellation scheme, which is defined by a complex coefficientwopt(n)that provides an outputsˆ(n)that is strictly equal to the polluting spurs(n)for all n. Thus,wopt(n)verifies:(9)wopt(n)u(n)=s(n)∀n∈N.The iterative expression of the ideal coefficient using (2) and (4) is:(10)wopt(n)=ABej(ϕ0−ϕR)e−jδωnejϕ(n).Due to the hypotheses made at the end of Section 2 (δω≪ω,σξ2≪1), the ideal coefficient can be expressed recursively as(11)wopt(n+1)≈wopt(n)+wopt(n)[jξ(n)−jδω].Usingw(n)=wopt(n)specified in (10) or (11) in Fig. 2 gives an ideally recovered signal, which means that in this casee(n)=x(n)+b(n),∀n∈N. As most of the parameters (e.g., amplitudes, phases, FS, PN) are not known, the ideal coefficient cannot be used, and a recursive estimation ofwopt(n)has to be performed.We propose to use the LMS algorithm [22,23], which is based on the error signale(n)=d(n)−sˆ(n), to perform the updating of the coefficientw(n):(12)sˆ(n)=w(n)u(n)(13)e(n)=d(n)−sˆ(n)(14)w(n+1)=w(n)+μu⁎(n)e(n)where μ is the constant step size of the algorithm and()⁎denotes complex conjugate. The LMS algorithm is a stochastic-gradient descent method that computes at each iteration n the gradient of the instantaneous square error as1/2∂|e(n)|2/∂w=−u⁎(n)e(n), in order to use the steepest descend to update the coefficientw(n)in (14). In Appendix A, we briefly review how the LMS algorithm approach can also be legitimized thanks to a weighted-least-squares error cost function to be minimized. In the case of a perfect situation (i.e., no PN and no FS), it can be shown that (10) is the solution of the Yule–Walker equation, to which the LMS algorithm converges [24].We now introduce the difference between the ideal coefficient and the iterative coefficientw(n), called the misalignmentv(n):(15)v(n)=w(n)−wopt(n).From (13), with the model defined in (1) and using the property of the ideal coefficient of (9), the output of the algorithm then becomes(16)e(n)=x(n)+b(n)−v(n)u(n).We see from (16) and (6), thatϵ(n)=v(n)u(n), and with (8), we can link the SNIR after compensation to the variance of the misalignment as(17)SNIRcomp=−10log10⁡(B2σv2σx2+σb2).The variance of the misalignment can be expressed recursively using (11), (14), (16), and (17) (see Appendix B). We use the same hypotheses as mentioned at the end of Section 2, and since the PN follows a Brownian model, only the scale of this modelϕ(n+1)−ϕ(n)[which is the white noiseξ(n)] has any influence. Therefore,(18)E[|v(n+1)|2]=(1−μB2)2E[|v(n)|2]+μ2B2(σx2+σb2)+Q(δω,σξ2),where(19)Q(δω,σξ2)=A2B2(σξ2+δω2)+2A2(1−μB2)δω2(μB2δω2−δω2+μB2)B2(μ2B4δω2−2μB2δω2+μ2B4).Eq. (18) is composed of three terms: the first is the recursive term; the second is the contribution of the noisy signal; and the last termQ(δω,σξ2)represents the impact of both the PN and FS on the overall performance.Asymptotically, we assume thatE[|v(n+1)|2]=E[|v(n)|2], and substituting (18) into (17) and using the definition of (19), we obtain the asymptotic SNIR after convergence as(20)SNIRcomp=−10log10⁡[μB22−μB2+Q(σξ2,δω)μ(σx2+σb2)(2−μB2)].A maximal value of the step size μ, to ensure the convergence of the algorithm (see [24, Section 9-4]), is given by(21)μ<μmax=2B2.The asymptotic SNIR is composed of a static term (misalignment due to the presence of the input noise) and the pollution term (due to the PN and FS). It appears that the step size μ defined in (14) leads to a trade-off between the accuracy of the estimate and resistance against the contribution of the polluter.We consider here thatμ≪1. The optimal step sizeμoptis then obtained by the maximization of (20) (see Appendix C), and is described on(22)μopt=(A2108(σx2+σb2)δω4−σξ23A2σx2+σb2332(σx2+σb2)B6+2A2δω2(σx2+σb2)B6)13+σξ2A23(σx2+σb2)B4(A2108(σx2+σb2)δω4−σξ23A2σx2+σb2332(σx2+σb2)B6+2A2δω2(σx2+σb2)B6)13.From (12), (13), (14), the update of the filter coefficient can be expressed as(23)w(n+1)=(1−μB2)w(n)+μd(n)u⁎(n).This means that the algorithm can be considered as a low-pass filter (LPF) noise canceler, based on the filtering ofd(n)u⁎(n). The equivalent scheme is presented in Fig. 3.The observationd(n)is first frequency shifted downward (by −ω) and then filtered using a LPF. As a consequence, the translated observationd(n)u⁎(n)has its spur at the frequency−δωand is selected by the LPF. The result is then frequency shifted back upward by the reference frequency ω and then subtracted from the observed data.From (23), the transfer function of the LPF in the z domain is(24)L(z)=W(z)U⁎(z)⁎D(z)=μz−(1−μB2)where ⁎ denotes convolution in the z domain. This filter has a cut-off frequency ofμB2. As a consequence, there is a direct link between the value of the LMS step size and the bandwidth of the LPF.From this filter scheme, a global notch structure can be obtained as the result of the direct filtering of the observationd(n)by a filterH(z)(cf. Fig. 3). In the z domain, asL(z)⁎U(z)=BL(ze−jω), the output of the global filter H is [24]E(z)=D(z)−W(z)⁎U(z)=D(z)−{L(z)[D(z)⁎U⁎(z)]}⁎U(z)=D(z)−[BL(z)D(zejω)]⁎U(z).We denoteG(z)=BL(z)D(zejω)so thatE(z)=D(z)−BG(ze−jω)=D(z)−B2L(ze−jω)D(z)=D(z)−[B2L(z)⁎U(z)]D(z).We can defineH(z)as the global notch filter response of the overall structure in the z domain, expressed as(25)H(z)=E(z)D(z)=1−B2L(z)⁎U(z).The filter thus obtained is a band stop filter, asL(z)⁎U(z)is a LPF that is up-shifted in frequency by ω. Furthermore, from (25), the z transform of the filter becomes(26)H(z)=1−μB2zejω−(1−μB2)=1−z−1ejω1−(1−μB2)ejωz−1.It is of note that the equivalent notch filterH(z)coincides with the first-order IIR notch filter implemented in [14].In this subsection, we consider two special cases (frequency shift only and phase noise only) to obtain simplified and more interpretable asymptotic performance formulae.We consider here that there is no PN, i.e.,σξ2=0. The pollution term from (19) thus becomes(27)QFS(δω)=2A2(1−μB2)δω2(μB2δω2−δω2+μB2)B2(μ2B4δω2−2μB2δω2+μ2B4).We assume that the FSδωis smaller than the step μ. The asymptotic SNIR with only FS can therefore be approximated as:(28)SNIRFS≃−10log10⁡[μB22+A2δω2(σx2+σb2)μ2B4].It should be noted that due to the simplifications of (19) and (20), (28) can be obtained equivalently with a frequency-domain representation based on the LPFL(z)and a power spectral density computation (see Appendix D). The hypothesisδω<μconsists of having a LPF cut-off frequency that is greater than the FS. Indeed, the input of the LPFd(n)u⁎(n)has a spur at frequency−δω, which can only be mitigated if the LPF has a cut-off frequency that is greater than the FS.From the maximization of (28), a simplified expression of the optimal step size in this case can be obtained as(29)μoptFS=4A2δω2B6(σx2+σb2)3.From (28) and (29), the maximal value of the SNIR can be analytically expressed as(30)SNIRMaxFS=−1310log10⁡[27A2δω216(σx2+σb2)].Eq. (30) means that the SNIR performance will decrease by 6.66 dB per decade of the increase in the FS. This gives a direct link between the expected performance and the acceptable FS.We now consider that the reference frequency perfectly matches the spur frequency, i.e.,δω=0. With only PN, the pollution term from (19) is(31)Q(δω,σξ2)=A2B2σξ2.The associated SNIR is(32)SNIRPN=−10log10⁡[μB22−μB2+A2σξ2(σx2+σb2)μB2(2−μB2)].In the frequency domain, the PN will widen the spur spectrum, so if the cut-off frequency of the LPFL(z)is too small, the LPF will not mitigate all of the spur band, which introduces performance loss.As in the case of FS only, a simplified optimal step size can be obtained from (32) in the case of PN only:(33)μoptPN=1B2σξ2A2σx2and from (33), the maximal SNIR for a given PN can be analytically expressed as(34)SNIRmaxPN=10log10⁡(σx2+σb2σξ2A2−12).Eqs. (19)–(28) describe the performance in the asymptotic mode, after convergence of the system. In the transient mode, where the filterw(n)converges to the ideal coefficient, the average SNIR is a function of the sample index n, and is denoted as(35)SNIR(n)=−10log10⁡[B2E[|v(n)|2]σx2+σb2].In the asymptotic mode, wheren→∞, the transient SNIR defined in (35) converges to the asymptotic SNIR defined in (17). From (18), and assumingw(1)=0, the average SNIR can be obtained recursively, which leads to the closed-form formula(36)SNIR(n)=−10log10⁡{B2σx2+σb2[(1−μB2)2nA2B2+[μ2B2(σx2+σb2)+Q(δω,σξ2)]1−(1−μB2)2nμB2(2−μB2)]}.First, it is important to note thatlimn→∞⁡SNIR(n)=SNIRcomp, as defined in (20). At the same time, (36) demonstrates that the asymptotic convergence speed is inversely proportional to the step size μ. To have a faster algorithm in the transient mode, we propose to add an adaptive-step-size process to the LMS algorithm. Thus, the step size will have a large value if the convergence is not settled, and will have to converge to a deterministic value. The purpose is to have the same asymptotic performance as theoretically expressed in (20), but also to limit the transient mode of the algorithm.The step-size update is based on the instantaneous square error|e(n)|2, to which a gradient descent is applied. We use the step-size update proposed in [25], which is based on a geometric update [26] with a forgetting factorγ<1[27]:(37)μn+1={μn[γ+η|u⁎(n)e(n)G(n)|]}μminμmaxwhereG(n)=∂w(n)/∂μcan be expressed recursively as(38)G(n)=(1−μnB2)G(n)+u⁎(n)e(n)η is a constant factor, and{}μminμmaxmeans that the step size is bounded between a maximal and a minimal value. The maximal value is set for convergence reasons from (21), and the minimal value is set to have the desired asymptotic performance [for instance, by setting the value ofμminto the optimal value (22) in a given scenario, typically, the worst case, whereQ(δω,σξ2)is maximum].The term|u⁎(n)e(n)G(n)|represents the recursive expression of the cost function derivative∂|e(n)|2/∂μ|n. By construction, this has an important value if the convergence is not settled, and in the asymptotic mode, it converges to 0.With a geometric update combined with a forgetting factor, the step size will necessarily increase during transient mode, whereγ+η|u⁎(n)e(n)G(n)|>1, and then decrease to finally converge toμminin the asymptotic mode (whereγ+η|u⁎(n)e(n)G(n)|<1).The LMS algorithm combined with the adaptive-step-size process designed is summarized as(39)sˆ(n)=w(n)u(n)e(n)=d(n)−sˆ(n)w(n+1)=w(n)+μnu⁎(n)e(n)G(n+1)=(1−μnB2)G(n)+u⁎(n)e(n)μn+1={μn[γ+η|u⁎(n)e(n)G(n)|]}μminμmax.Here, the first three equations correspond to the LMS algorithm, and the last two correspond to the adaptive-step-size process overlay. In the asymptotic mode, (39) is equivalent to (12), (13), and (14) withμn=μmin.Several spurs can be present in the baseband signal at different frequencies. We consider here the case where P spurs pollute the noisy signal. We assume that all of the spur frequencies are different from each other. The mixture is given by(40)d(n)=x(n)+b(n)+∑i=1Psi(n)with(41)si(n)=Aiej(ωi−δωi)n+jϕ0i+jϕi(n)whereAiis the unknown amplitude,ϕ0iis the unknown phase,ϕi(n)is the PN that affects Spur i,ωiis the a priori frequency, andδωiis the FS of Spur i. We consider that all of the PNs are under a Brownian model of varianceσξi2, as in Section 2. For each spur, a dedicated reference is synthesized as(42)ui(n)=Biejωin+jϕRi.As all of the spur frequencies are assumed to be different, the spurs are temporally uncorrelated. From the one-spur cancellation scheme defined in Section 3, a parallel structure can be designed, where all of the spurs are simultaneously filtered (the P references are weighted by P complex coefficients). The parallel cancellation scheme is presented in Fig. 4. In this structure, all of the estimatessˆi(n)coming from the LMS blocks are summed and then subtracted from the observationd(n). The resulting outpute(n)is then used as feedback to the P blocks.The output of the algorithm at time index n is written as(43)e(n)=d(n)−Σˆ(n),where(44)Σˆ(n)=∑i=1Pwi(n)ui(n)is the global estimate. The iteration process of the P filter coefficients is then set from (14) as(45)wi(n+1)=wi(n)+μui⁎(n)e(n);∀iwhere μ is the global constant step size used in the structure. For all of the blocks in Fig. 4, the adaptive-step-size process described in (39) can also be used.At the same time, for each block, we introduce the related pollution factor from (19) as(46)Qi(δωi,σξi2)=Ai2Bi2(σξi2+δωi2)+2Ai2(1−μBi2)δωi2(μBi2δωi2−δωi2+μBi2)Bi2(μ2Bi4δωi2−2μBi2δωi2+μ2Bi4).Assuming there is no correlation between the spurs and the spur estimates, the asymptotic SNIR can be expressed (see Appendix E) as(47)SNIRPaLMS[P]=−10log10⁡[μ∑i=1PBi22−μ∑i=1PBi2+∑i=1PQi(δωi,σξi2)μ(σx2+σb2)(2−μ∑i=1PBi2)].The SNIR is composed of two terms: the first is due to the desired noisy signal, and the second is due to the polluting terms. In the case of one spur, the expression in (47) is equal to the asymptotic SNIR expressed in (20).In this section, analytic formulae for the asymptotic and transient performance of the digital spur cancellation algorithms are compared to simulations.First, we have supposed that the a priori spur frequency is perfectly known, as in the case of multi-standard transceivers. The clock harmonics are exact multiples of the operating clock frequency, and a spur will fall into the reception stage if one of the harmonics is within the signal bandwidth at the receiver carrier frequencyfRx(see Fig. 1). In such a case, the a priori spur natural frequency ω (normalized between 0 and 2π), defined in (2) and (4), is obtained from the clock frequency harmonic, which is a multiple of the operating clock frequencyFclock, the received carrier frequencyfRxand the sampling frequency F, where(48)ω=2πpFclock−fRxF,with p the index of the polluting harmonic.As an example, if we consider a clock operating atFclock=26MHz, and a carrier frequencyfRx=930MHzfor a LTE10MHzsignal (at sampling frequencyF=15.36MHz), the 36th clock harmonic, (at936MHz) will pollute the received signal. The spur will be atfs=6MHzin baseband, leading toω=2π36⋅26e6−930e615.36e6=2π⋅0.39.Our models and performance equations are based on values of the frequency shiftδωand the phase noise varianceσξ2. First, the parameterδωis related to the practical imprecision Δ of a synthesized frequency, which is expressed in parts-per-million (ppm). For example, in LTE systems, a typical frequency drift is about 10 ppm [28,29]. The link betweenδωand the physical parameters (spur frequencyfs, sampling frequency F, expressed in Hertz) isδω=Δfs/F. For example, in LTE, for a signal bandwidth of 10 MHz sampled atF=15.36MHz, with a polluting spur at6MHz, the resultingδωis4⋅10−6.Secondly, we have to link our parameter modelσξ2to a practical phase noise specification. A state-of-the-art discretized model for Brownian phase noise isϕ(n)=2πfscB(n), wherefsis the spur frequency,B(n)represents the Brownian motion process of variance1F(where F is the sampling frequency), and c is a parameter of the oscillator defined in [18]. Thus, our state noise varianceσξ2is4π2fs2c/F. The oscillator constant c cannot be obtained directly, but is a function of the oscillator power spectral density L expressed in dBc/Hz at a specific frequency f (>0), with the relationL(f)=10log10⁡(fs2c/f2)[18,30]. The link between a phase noise specification and the state noise variance of our model is finallyσξ2=4π2f210−L(f)101F.For example, in LTE, for a signal bandwidth of 10 MHz (F=15.36MHz) and for a power spectral density of−100dBc/Hzatf=10kHz, the equivalent variance of the Brownian model isσξ2=2.5⋅10−8.We focus first on the transient performance for one spur. We consider here that the observation is composed of a white complex signal of unit variance, an additive white complex Gaussian noise with a SNR of 10 dB and a spur of known frequency, where the SNIR before compensation is 0 dB. The spur follows the model presented in (2), which is affected by a frequency shiftδω=10−7, and the corresponding Brownian PN has a varianceσξ2of10−7. The reference is constructed from (4) and is used in the filter scheme described in Fig. 2. At the middle of the simulation, a change in the configuration is applied: the frequency of the spur and the reference are not changed, but the level of the spur is raised from 0 dB to 5 dB to force the algorithm to re-converge after having reached the asymptotic mode (assuming unchanged parameters for the reference). The two algorithms presented in Section 3 are compared: the constant-step solution of (12)–(14), and the adaptive-step-size solution of (39). For these algorithms to have the same asymptotic performance, the value of the constant LMS step size is the same as the minimal step of the adaptive-step-size solution, and this is set to2−11(which is close to optimal). The maximal value of the adaptive step size is bounded by (21). The simulated mean transient SNIRs for the two algorithms, the theoretical SNIR evolution for the constant step size of (36), the theoretical asymptotic value of (20), and the adaptive-step-size algorithm of (39) are depicted in Fig. 5. Also, two other methods in the literature are computed for comparison: the recursive least squares (RLS) algorithm [24] and the equivalent IIR as described in (26) and presented in [14]. It is first shown that the theoretical formulae are validated by the simulations: the mean transient performance of the constant-step-size LMS follows (36) and constant and adaptive-step-sized algorithms have the same asymptotic performance, as defined in (20). Furthermore, the adaptive-step-size solution is more rapid than the constant-step-size solution for the same asymptotic performance. The constant-step-size LMS solution has the same transient and asymptotic performance as the IIR filter, which is in agreement with the equivalent notch filter of (26). Finally, the adaptive solution has a convergence rate that is similar to the RLS solution, but can better cope with a change in the configuration of the spurs, and offers a more suitable hardware implementation (as there is no division in our algorithm).Fig. 6compares the asymptotic SNIR to the simulated results for one spur with input SNIR of 10 dB, in the case of FS only (no PN). The SNIR is computed versus the step size (which is equivalent to the minimal step size in the case of the adaptive-step-size solution) for different values of FS. The simulated data is white and has an additive white noise of variance 10 dB. The figure validates the asymptotic formula (28). The presence of the optimal step size is also validated, and the loss of performance, due to the second term of (28), is proportional to the square of the step size, as expected by the formulae.At the same time, the optimal step size gives the maximal value of the SNIR that can be obtained for a given FS. Fig. 7shows the evolution of this maximal SNIR (30) versus FS. This shows that the theory is in agreement, and that the FS leads to a loss of performance of 6.66 dB per decade.Fig. 8compares the asymptotic SNIR to the simulated results in the case of PN (no FS). The asymptotic SNIR is computed versus the step size, for different variances of the Brownian model of (3), again, showing agreement with the theory described in (32).The maximal SNIR is given by (34), and is validated in Fig. 9for an initial SNIR of 10 dB.In Fig. 10, we consider both the PN and FS for one spur, and the theory elaborated in (20) is validated by the simulation for several pairs ofσξ2andδω.In order to show the impact of the number of spurs on the asymptotic performance, Fig. 11shows the asymptotic SNIR of (47), as compared to the simulations. The noisy signal is still white, and is polluted by 1 to P spurs of different frequencies. All of the P spurs are affected by a Brownian PN of varianceσξi2and their reference has a FS ofδωi, following the model described in (41) and (42). The parameters used are described in Table 1. It should be noted that the frequency values are given for information only, and have no impact on the overall performance, as (47) does not depend onwi.We compare the influence of the spurs and the compensated spurs in terms of the bit error rate (BER). We first consider a data signal modulated by quadrature phase shift keying (QPSK) modulation through an additive white Gaussian noise channel with various SNRs. We suppose that the noisy signal is polluted by two spurs, affected by a FS of10−7and a PN of variance10−7. We show in Fig. 12the results of the BER without the compensation system and with the parallel LMS compensation scheme (with step size of2−11) for different values of the channel SNR and for different SIRs. (Here, the amplitudes of the spurs are computed from only the power of the desired signal (SIR) neglecting the additive white noise in order to have constant spur amplitude versus the channel SNR: the amplitudes of the spurs are obtained directly byA1=A2=σx2/10SIR/10, whereσx2is the variance of the data signal without noise.) We show that our methods greatly reduce the BER and that the compensated BER comes close to the ideal channel influenceQ(2Eb/N0).Finally, we compare the BER for the more realistic case of a simplified LTE modulation that is based on the Third Generation Partnership Project (3GPP) model [31]. The data signal follows a LTE 1.4 MHz bandwidth specifications based on orthogonal frequency division multiplexing (OFDM), with 72 QPSK subcarriers, a fast Fourier transform (FFT) of size of 128, and a cyclic prefix of length nine samples. The BER is computed on the uncoded bits of the data and through an additive white Gaussian noise channel with various SNRs. We consider that the noisy signal is polluted by two spurs. These spurs are affected by a FS of10−7and are modulated with a Brownian PN of variance10−7.Fig. 13shows the results of the BER without compensation and with the parallel LMS compensation scheme for different values of the channel SNR and for different SIRs. The theoretical performance without spurs (i.e., only the influence of the channel) is shown in black.11For the simulation, the theoretical curve is given by the link between the SNR andEb/N0. In the case of LTE with 1.4-MHz bandwidth and QPSK modulation, the link is given byEb/N0=SNR(nFFT+nCP)/(2nRe), wherenFFT=128is the size of the fast Fourier transform,nCP=9is the length of the cyclic prefix, andnRe=72is the number of received carriers. This leads to the expression ofBER=Q[SNR(nFFT+nCP)/nRe].Without compensation, it is shown that the presence of the spurs reduces the performance of the overall system, which leads to a lower limit on the BER. The decrease in performance depends on input SIR, although it impacts the signal as soon as the SNR is greater than about 4 dB. After compensation, the BER is greatly reduced compared to the initial BER, and reaches a floor. Thus, the designed system has good performance if the spurs have an initial SIR between 0 dB and 20 dB.Up to now, we have verified the theoretical performance of the proposed algorithm in the presence of Brownian phase noise, which is the usual model chosen in practice for free running oscillators [19–21]. However, if a more practical PLL-type oscillator is used, the polluting model for the phase noise will not be Brownian. In such a case, the theoretical asymptotic performance expressions (20) and (32) are no longer valid, and the performance will depend on the scale and shape of chosen phase noise.The profile of a practical phase noise is depicted in Fig. 14. Such a phase noise spectrum can result from a sum of1/f2noise modeled as a Lorenz spectrum,1/fnoise (flicker noise) filtered by a second-order PLL, and a noise floor as described in [32, Section 2.3]. An example of a phase noise specification from [32, Section 2.3] is proposed in Table 2.In Fig. 15, we represent in red the asymptotic performance of our algorithm versus the step size in the presence of one spur, impaired by the practical phase noise described in Table 2, obtained by Monte-Carlo simulation. For comparison, we also plot the theoretical asymptotic performance with Brownian phase noise with specific variance obtained in (32). We note that, for large values of the step size, the performance is similar for the two models [since the first term of (32),μB2/(2−μB2), is predominant and does not depend on the model], whereas for small values of the step size, the theoretical curve under the Brownian assumption does not match with the practical performance [since the second term of (32) is predominant and is model dependent].

@&#CONCLUSIONS@&#
This study has focused on the performance of a multiple-spur cancellation scheme. We first proposed a one-spur canceler based on the LMS algorithm, which uses a priori knowledge of spur frequency to create a reference. We proposed a model with imperfections, due to the limited accuracy of frequency knowledge and Brownian phase noise. In this case, we derived closed-form formulae of the asymptotic SNR and show that the step size of the algorithm can be optimally tuned. We showed that the LMS algorithm is equivalent to a notch filter, which leads to simplified expressions in the case of PN only or FS only. We added an adaptive-step-size process to improve the convergence speed without lowering the asymptotic performance. This solution offers performance similar to the RLS algorithm but can better cope with configuration changes. In a second part of the paper, we extended the problem to the multiple-spur case, and developed a parallel scheme that uses the one-spur block previously described. We developed closed-form formulae of the asymptotic SNIR for P spurs, in a general case of P Brownian noises and P FSs.The goal of this appendix is to recall how the LMS approach can be legitimized, from simplification of the recursive-least-squares approach. The weighted least-squares cost function used is [24,33]Jn(wˆ)=∑p=1nλn−p|e(p)|2withλ<1, because of the nonstationarity of the parameters to be estimated. Due to the structure of the filter defined in Fig. 2, we have:Jn(wˆ)=∑p=1nλn−p|d(p)−wˆu(p)|2=∑p=1nλn−p[d(p)d⁎(p)−wˆ⁎d(p)u⁎(p)−wˆd⁎(p)u(p)+wˆwˆ⁎u(p)u⁎(p)].At each iteration, the weight estimate updatew(n+1)is based on the minimization ofJn(wˆ). As the cost function is a real function of complex variables, using complex derivative theory [34], the minimization is obtained by setting∂Jn(wˆ)/∂wˆ⁎=0and assuming∂wˆ/∂wˆ⁎=0.As a consequence, the derivative component is written as∂Jn(wˆ)∂wˆ⁎=∇wˆ⁎Jn(wˆ)=∑p=1nλn−p∇wˆ⁎|e(p)|2=∑p=1nλn−p[−d(p)u⁎(p)+wˆu(p)u⁎(p)].Setting∂Jn(wˆ)/∂wˆ⁎=0then leads to(49)w(n+1)=∑p=1nλn−p[d(p)u⁎(p)]∑p=1nλn−p[u(p)u⁎(p)].We denote the temporal autocorrelation of the reference byRλ(n)and the temporal cross-correlation between the reference and the observation bypλ(n), which are estimated as(50)Rλ(n)=∑p=1nλn−pu(p)u⁎(p)(51)pλ(n)=∑p=1nλn−pd(p)u⁎(p),and finally have(52)w(n+1)=pλ(n)Rλ(n).The temporal cross-correlation and autocorrelation can be recursively expressed as(53)pλ(n)=λpλ(n−1)+d(n)u⁎(n)(54)Rλ(n)=λRλ(n−1)+u(n)u⁎(n).Substituting (53) in (52), we have(55)w(n+1)=1Rλ(n)[λpλ(n−1)+d(n)u⁎(n)].From (52) and due to the recursive update ofRλ(n)expressed in (54)pλ(n−1)=w(n)Rλ(n−1)=w(n)Rλ(n)−u(n)u⁎(n)λ,and substitution into (55) gives(56)w(n+1)=w(n)+1Rλ(n)[−w(n)u(n)u⁎(n)+d(n)u⁎(n)].As by constructione(n)=d(n)−w(n)u(n), the update becomes(57)w(n+1)=w(n)+1Rλ(n)[e(n)u⁎(n)].The standard update of the LMS algorithm [22] is finally obtained by substituting the inverse recursive update of the temporal autocorrelation of the reference [1/Rλ(n)] with a constant step size μ, to have a less complex algorithm, and thus the recursive equation ofw(n)becomes(58)w(n+1)=w(n)+μu⁎(n)e(n)w(n+1)=w(n)−μ2∇w|e(n)|2.The expression of the misalignment can be expressed recursively using (14) and (11), as(59)v(n+1)=w(n+1)−wopt(n+1)=w(n)+μu⁎(n)[x(n)+b(n)]−μB2v(n)−wopt(n)−wOpt(n)[jξ(n)−jδω]=[w(n)−wopt(n)]+μu⁎(n)[x(n)+b(n)]−μB2v(n)−wopt(n)[jξ(n)−jδω]=(1−μB2)v(n)+μu⁎(n)[x(n)+b(n)]−wopt(n)[jξ(n)−jδω].The LMS algorithm is based on minimization of the gradient ofJ(n), so the complex sequence of the misalignmentv(n)is white. Assuming temporal uncorrelation between the white sequences [the misalignmentv(n), the signalx(n), the additive noiseb(n), and the phase noiseξ(n)], we only have dependence between the misalignmentv(n)and the recursive expression of the optimal filterwopt(n). Note that there is no single dependency betweenv(n)and[x(n)+b(n)]due to causality and the whiteness of the desired noisy signal. The variance of the misalignment can be expressed as(60)E[|v(n+1)|2]=(1−μB2)2E[|v(n)|2]+μ2B2(σx2+σb2)+A2B2(σξ2+δω2)+δω(1−μB2)E[|v(n)wopt(n)|].The termE[|v(n)wopt(n)|]can be expressed through the separation between the real part and the imaginary part of the two components:(61)E[|v(n)wopt(n)|]=2A2(μB2δω2−δω2+μB2)B2(μ2B4δω2−2μB2δω2+μ2B4).Then, replacing (61) in (60) leads to (18).We still assume the aforementioned hypotheses•The normalized FSδω≪ω(normalized frequency),The PN varianceσξ2≪1,The step sizeμ≪1.In the asymptotic mode, assuming that there is no PN, the algorithm is equivalent to a notch filter after baseband frequency shifting of the spur. The estimation error at the output of the structure is expressed after shifting as(65)ϵBB(n)=[x(n)+b(n)−e(n)]u⁎(n).Expressing the z transform of the filter obtained, using the z transform of the equivalent LPF (24), the estimation error can be expressed as:EBB(z)=S(z)⁎U⁎(z)−B2W(z)=S(z)⁎U⁎(z)−B2L(z)[D(z)⁎U⁎(z)].With (1) for the observation equation(66)EBB(z)=−B2L(z)[X(z)⁎U⁎(z)]+[1−B2L(z)][S(z)⁎U⁎(z)].The variance of the estimation error is from (66)σϵBB2=σx2B4T∫−12T12T|L(e2jπfT)|2df+∫−12T12T|1−B2L(e2jπfT)|2Γsu⁎(f)df.The first term corresponds to the static error due to the presence of the noisy data (assumed to be white and with a power spectral densityσx2T). The second term corresponds to the dynamic error related to the frequency shift, whereΓsu⁎(f)is the power spectral density ofsu⁎(which corresponds to the downshifted spur frequency). After computation and using the same hypotheses (δω≪1,δω<μ;μ≪1), the variance of the estimation error is(67)σϵBB2≈σx2μB22−μB2+(AδωμB2)2,which leads to the same value of the asymptotic SNIR as described in the simplified form of (28).In the parallel structure, the global output of the algorithm is composed of the signalx(n), the noiseb(n), the spurssi(n), and the spur estimateswi(n)ui(n), such that(68)e(n)=x(n)+b(n)+∑i=1Psi(n)−∑i=1Pwi(n)ui(n).The misalignments for each block are introduced with the same definition as in (15), assi(n)=wopti(n)ui(n), so that(69)e(n)=x(n)+b(n)−∑i=1Pvi(n)ui(n).The estimation error of the structure, which is defined in (6), leads to the expression of the asymptotic SNIR of the P stages:(70)SNIRP=−10log10⁡(∑i=1PBi2E[vi2]σx2+σb2).For each block, the misalignment is recursively described using (11), (15), (45), (59), and (69) as(71)vi(n+1)=vi(n)+μui⁎(n)[x(n)+b(n)]−wopti(n)[jξi(n)−jδωi]−∑j=1PμBiBjvj(n),∀i∈[1;P].Assuming the same hypothesis between uncorrelated misalignment, the variance of Block i is expressed∀i∈[1;P]as(72)E[vi2(n)]=μ(σx2+σb2)2−μBi2+Qi(σξi2,δωi)μBi2(2−μBi2)+∑j=1j≠iP[μBj2E[vj2(n)]2−μBi2].From (72), the problem can be set in matrix form as(2−μB12…−μBP2−μB12…−μBP2⋮⋮⋮−μB12…2−μBP2)(E[v12(n)]E[v22(n)]⋮E[vP2(n)])=(μ(σx2+σb2)μ(σx2+σb2)⋮μ(σx2+σb2))+(Q1(σξ12,δω1)μB12Q2(σξ22,δω2)μB22⋮QP(σξP2,δωP)μBP2).The system can be solved for the P blocks, which leads to the same expression of the variance, i.e., ∀i:(73)E[vi2]=μ(σx2+σb2)2−μ∑j=1PBj2+12∑j=1PQj2−μ∑j=1PBj2+Qi(σξi2,δωi)2μBi2.Finally, substituting (73) into (70) gives∑i=1PBi2E[vi2]=μ(σx2+σb2)∑i=1PBi22−μ∑j=1PBj2+12∑i=1PBi2∑j=1PQj(σξj2,δωj)2−μ∑j=1PBj2+∑i=1PQi(σξi2,δωi)2μ,∀i.The above equation can be simplified to(74)∑i=1PBi2E[vi2]=μ(σx2+σb2)∑i=1PBi22−μ∑j=1PBj2+∑i=1PQi(σξi2,δωi)μ(2−μ∑j=1PBj2).Then, substituting (74) into (70) leads to the expression of the asymptotic SNIR expressed in (47).