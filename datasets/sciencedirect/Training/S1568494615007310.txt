@&#MAIN-TITLE@&#
Wavenet fuzzy PID controller for nonlinear MIMO systems: Experimental validation on a high-end haptic robotic interface

@&#HIGHLIGHTS@&#
The proposed control scheme is applied for nonlinear MIMO systems.The information of the wavelet fuzzy neural network is used for online tuning of feedback gains of the PID controllers.A real-time experimental study on a three degrees of freedom haptic interface.

@&#KEYPHRASES@&#
Identification,Wavelet fuzzy neural network,Self-adaptive algorithms,PHANToM robot,

@&#ABSTRACT@&#
A novel global PID control scheme for nonlinear MIMO systems is proposed and implemented for a robot as study case, this scheme is called AWFPID from its adaptive wavelet fuzzy PID control structure. Basically, it identifies inverse error dynamics using a radial basis neural network with daughter RASP1 wavelets activation function; its output is in cascaded with an infinite impulse response (IIR) filter to prune irrelevant signals and nodes as well as to recover a canonical form. Then, online adaptive fuzzy tuning of a discrete PID regulator is proposed, whose closed-loop guarantees global regulation for nonlinear dynamical plants. The wavelet network includes a fuzzy inference system for online tuning of learning rates. A real-time experimental study on a three degrees of freedom haptic interface, the PHANToM Premium 1.0A, highlights the regulation with smooth control effort without using the mathematical model of the robot.

@&#INTRODUCTION@&#
In recent years, wavelets have attracted much attention in many scientific and engineering research areas in virtue of wavelets possess two features that make them especially valuable for data analysis: it reveals local properties of data as well as multiscaling. The local property is useful for applications that requires online response to changes, such a controlling process [10]. Wavelets and neural networks have been combined [16,18,19], to conform a class of networks, so called wavelet networks or wavenets, which are capable of handling moderately high-dimensional problems [7]. On the other hand, the PID control, and some of its variants, are the main control scheme used for process control [1]. Some causes that have contributed to this is its easiness of implementation, the independence of the model, the availability of explicit, and formal tuning procedures for the linear approximation of the plant. There are even PID implemented in component-of-the-shelf technological resources. However, the linear regulator PID algorithm presents limitations of stability, robustness and convergence when applied to nonlinear processes [2,15] and tuning procedures can be cumbersome, at best, then it if of interest to obtain certain characteristic of global stability of for PID, preserving the other characteristics.However, in particular, when PID is applied to nonlinear plants such as a robot, it requires explicit and difficult procedures to tune gains and faces formidable challenges due to strong nonlinear couplings and common hard nonlinearities, typical of real robots. Since classical PID schemes have constant positive definite feedback gains, defining a unique set of gains for the whole operational regime is a tantamount tasks. It is then natural to quest gain scheduling or time-varying feedback gains for different operational regimes. In [2], it is explored recent analytical and experimental techniques to tune gains. One alternative is auto-tuning or self-tuning [3,13]. In this realm, a recent efficient scheme has been proposed, in particular, using wavenet neural networks (WNN) to identify the plant and compute accordingly such gains. In this way, WNN or wavenet control is different from classical neural network scheme in that the function approximation of inverse dynamics is not used to stabilize the plant, but to design specific policy to tune the gains so as to drive the error to zero. This requires a less intensive computation since the aim is not function approximation but a quantitative objective measure of system deviation. Additionally, the output layer of the wavenet is in fact a pruning filter that further enhances a compact and efficient design to determine the useful signals that contribute [12,11,5].Inspired by the theory of multi-resolution analysis of wavelet transform, in this paper, we propose an adaptive wavelet fuzzy PID (AWFPID) control whose design is based on the promising function approximation capability of wavelet networks. The goal of the paper is an scheme based on adaptive fuzzy learning rates for AWFPID to control MIMO nonlinear systems. The wavenet control uses a RASP1-type wavelet with IRR filtering that yields a simple PID controller for global asymptotic stability. Experiments are realized on the PHANToM Premium 1.0A to assess the advantages and disadvantages of AWFPID in real time.The paper is organized as follows. The wavenet and control design is presented in Section 2, whose fuzzy adaptation of its learning rates are given in Section 3. The experimental study are shown in Section 4, it considers the widely popular haptic interface Phantom Premium 1.0A controlled in torque mode, for regulation regime. In Section 5, the experimental results shows the viability of the proposed approach for a typical sampling period. Remarks are briefly addressed in Section 6 that highlight the subtlety advantages of our scheme. Finally, the conclusions about the proposed controller for robots are presented in Section 7.Consider Fig. 1, it is depicted identification and auto-tuning blocks have fuzzy sets that tunes learning rate. In there, the following variables are used: yref(k) is the reference signal, ϵ(k) stands for the error signal, the control input is u(k), r(k) models the noise signal, y(k) is the plant output withyˆ(k)its estimate, and e(k) the error estimated, finally,v(k)stands for the persistence signal.Let general nonlinear MIMO dynamical system be a general discrete state equation [8,9]:(1)x(k+1)=f[x(k),u(k),k](2)y(k)=g[x(k),k]wherex∈Rn,u,y∈Rpand(3)f:Rn×Rp⟶Rn(4)g:Rn⟶Rpare unknown smooth functions. Notice that input u(k) and system output y(k) are the only data available, and since the linearized system of (1) is observable around the equilibrium point, then there exists an input-output representation that can be reconstructed with a basis [8]. That is, consider the following canonical realization(5)y(k+1)=β[Y(k),U(k)]where(6)Y(k)=[y(k)y(k−1),…,y(k−n+1)](7)U(k)=[u(k)u(k−1),…,u(k−n+1)]Then, there exists a function β that maps the output y(k), input u(k) and their n−1 past values in y(k+1) [8]. Thus [4] establishes that there exists a wavenet neural networkβˆthat can be trained to converge locally to β. In this paper, we exploit this property of wavenets, but additionally we consider IIR filter at the output with twofold purposes, firstly, to obtain a representation in the well-known canonical form and secondly, in the output layer to prune irrelevant signals to build an efficient identification scheme useful to tune PID feedback gains.It is proposed radial basis neural network for the identification process, in which the activation functions ψ(τ) are daughter wavelet functions ψj(τ) of RASP1 type. This scheme identifies approximately the inverse plant using as few neurons as possible, which stands for an efficient approximator for practical applications due to its reduced computational load. The general interconnection and signal propagation is presented in Fig. 2, whereτl=∥u(k)−bl∥al. Infinite impulse response (IIR) recurrent structure, in cascading structure, yields double improving speed of learning by pruning those nodes with insignificant relevant information from the cross contribution summation of daughters wavelets, located in the third layer; then with little or null contribution in the identification process, allowing a reduction in the number of iterations in the learning process [6].The inner structure of the IIR filter is shown in Fig. 3, notice the forward delayed structure modulated by the input and the feedback loop modulated by the persistent signal to allows swapping a range of frequency. The mother wavelet function ψ(k) generates daughter wavelets ψa,b(τ) by its property of expansion and contraction, and translation, represented as [4]:(8)ψl(τl)=1aψ(τl)with a≠0;a,b∈Rand(9)τlj=∑j=1p(uj−bl,j)21/2aljThe j scale variable,aljallows expansion and contraction, and bl,jstands for the (l, j) translation variable at k, in the classical role of RBF, with the advantage of dealing with more refinement through daughters wavelets ψl(τl). This last feature is essential in the present algorithm together with the pruning capability of the IIR filter. As suggested in [4], the mathematical representation of wavelet RASP1 is a singularity-free normalization of the argument of the wavelet(10)RASP1=τ(τ2+1)2whose partial derivative with respect to bi,jis(11)∂τ∂bi,j=1a3τ2−1(τ2+1)3In this way, the i wavenet approximation signal with IIR filter can be calculated as(12)yˆi(k)=∑q=1p∑l=0Mci,lzi(k−l)up(k)+∑j=1Ndi,jyˆi(k−j)v(k)zi(k)=∑l=1Lwi,lψl(k)where L stands for the number of daughter wavelets,wlthe weights of each neuron in the wavenet, ciand djare the coefficients of forward and backward IIR filter, respectively, and M and N the coefficients number of forward and backward IIR filter, respectively. The wavenet parameters are optimized by a least mean square algorithm (LMS) subject to minimizing a convex radially unbounded cost functions E, defined by(13)E=E1E2⋯Ei⋯EpTwhere(14)Ei=12∑k=1Tei2(k)Let the estimation error between wavenet output signal with IIR filter and system output be(15)ei(k)=yi(k)−yiˆ(k)To minimize E, the steepest gradient-descent method is considered. To this end, notice that partial derivatives of E, A(k), B(k), W(k), C(k), D(k) are required to update the incremental changes of each parameter along its negative gradient direction. That is,ΔW(k)=−∂E∂W(k),ΔA(k)=−∂E∂A(k),ΔB(k)=−∂E∂B(k),ΔC(k)=−∂E∂C(k)andΔD(k)=−∂E∂D(k)then, the tuning update parameter becomes:(16)W(k+1)=W(k)+μWΔW(k)(17)A(k+1)=A(k)+μAΔA(k)(18)B(k+1)=B(k)+μBΔB(k)(19)C(k+1)=C(k)+μCΔC(k)(20)D(k+1)=D(k)+μDΔD(k)which minimizes cost function (14) along variations of parameters and coefficients. That is, (16)–(20) ensures the convergence of (15), then (14) can be considered as a Lyapunov candidate function, in sampled domain, for global asymptotic convergence to the unique equilibrium to zero, i.e.ei(k)=yi(k)→yiˆ(k)as k→∞. This shows the function approximation capabilities of the proposed algorithm.Canonical observable realization of the discrete domain equations of the robot suggests, in view of previous subsection, that the following models the unknown robot, which is useful to derive a wavenet schemes as follows. Consider(21)y(k+1)=Φ[Y(k),U(k)]+Γ[Y(k),U(k)]·u(k)when terms Φ and Γ are exactly known, computed torque or inverse dynamics algorithms provides the following controller u(k) that ensured convergence to a desired output yref(k+1) as follows:(22)u(k)=Γ−1[Y(k),U(k)](yref(k+1)−Φ[Y(k),U(k)])Thus, the closed-loop equation (21) and (22) produces, ideally y(k+1)=yref(k+1). However, it is assumed that such realization (21) is not known, but observability of robot dynamics implies that there exist basis function that approximates (21). Then, (21) is estimated as follows(23)yˆ(k+1)=Φˆ[y(k),ΘΦ]+Γˆ[y(k),ΘΓ]·u(k)System (23) is estimated by two wavenet functions as follows(24)Φˆi[y(k),ΘΦ]=∑j=1Ndi,jyˆ(k−j)v(k)(25)Γˆi,q[y(k),ΘΓ]=∑q=1p∑l=0Mci,lzi(k−i)uq(26)zi(k)=∑l=1Lwi,lψl(k)with adjustable parameters ΘΦ and ΘΓ, for functionΦˆiandΓˆi,qrepresenting the i component ofΦˆand the (i, q)-element of the matrixΓˆ, respectively. Therefore, since nonlinear wavenet functionsΦˆ(k)andΓˆ(k)estimate Φ(k) and Γ(k), as k→∞, then errorei(k)=yi(k)→yiˆ(k)can be used as a Lebesgue measure useful to tune feedback gains.Now, the following discrete PID controller is proposed(27)uσ(k+1)=uσ(k)+kpσ(k)[ɛσ(k)−ɛσ(k−1)]+kdσ(k)[ɛσ(k)−2ɛσ(k−1)+ɛσ(k−2)]+kiσ(k)ɛσ(k)wherekpσ(k),kiσ(k)andkdσ(k)stand for strictly positive definite proportional, integral and derivative feedback gains, respectively; u(k) is the controller at instant k, and error is defined as(28)ɛσ(k)=yrefσ(k)−yσ(k)for σ=1, 2, 3, …, p. Each feedback gain is tuned according to the corresponding error they affect in (27) and modulated byΓˆ, the input matrix of (23).Due to the gainskpσ,kiσandkdσare considered within the cost function (14), those can be updated similar to (16)–(20). Letkpσ(k)=kpσ(k−1)+μpeσ(k)Γˆi,q(k)[ɛσ(k)−ɛσ(k−1)]kiσ(k)=kiσ(k−1)+μieσ(k)Γˆi,q(k)ɛσ(k)kdσ(k)=kdσ(k−1)+μdeσ(k)Γˆi,q(k)[ɛσ(k)−2ɛσ(k−1)+ɛσ(k−2)]whereΓˆis defined in (25). Notice that learning rates μ are designer parameters, in this paper we propose a fuzzy inference system for its online computation.Remark 1The controller qualifies as a self-tuning PID controller with continuous and variants learning rates of feedback, based on basis functionΓˆ. Clearly, as any gradient descend algorithm, it is quite sensible to μ, which can be designed using in terms of fuzzy-based arguments, it is one of the main contribution of the paper.Consider Fig. 4. We assume that the intervals[μpmin;μpmax],[μimin;μimax]and[μdmin;μdmax], of the learning rates are known, where learning rates are defined as follows:μp∈[μpmin;μpmax],μi∈[μimin;μimax]andμd∈[μdmin;μdmax]. For convenience, let μp, μiand μdbe normalized in the interval zero to one with the following linear transformations:(29)μp′=μp−μpminμpmax−μpmin(30)μi′=μi−μiminμimax−μimin(31)μd′=μd−μdminμdmax−μdminwhereμp′,μi′andμd′are the update parameters. Now, assuming that the inputs for the fuzzy system are ɛσ(k) andɛσm(k), let the fuzzy rules IF–THEN have the Sugeno's structure as follows:(32)IFɛσ(k)isAlANDɛσm(k)isBlTHENμp′isCl,μi′isDl,μd′isElwhere Aland Blstands for the fuzzy sets with triangular memberships for the inputs, and Cl, Dland Elare the consequences of order zero for the rule l, with l=1, 2, …, M. In the same manner, the learning rates for neural network of the identification process are(33)IFei(k)isAlANDeim(k)isBlTHENμA′isMl,μB′isNl,μC′isOl,μD′isPl,μW′isQlwhere Aland Blare the fuzzy sets triangular memberships for inputs, and Ml, Nl, Ol, Pland Qlare the consequences of order zero for the rule l with l=1, 2, …, M. This fuzzy sets can be triangular, trapezoidal or other memberships, which are typically tuned heuristically to introduce knowledge-base of the experience user.A real-time platform is considered to evaluate the implementation of the proposed controller in a three degrees of freedom robotic system, wherein the robot stands for a high-end 3D force reflecting and positioning device.Consider a haptic interface PHANToM Premium 1.0A [14] whose haptic device is a joint nonlinear robot of three degrees of freedom, which although shows purposely low apparent inertia at its end-effector, there arises strong nonlinear coupling and it is subject to joint friction and gravitational torques.The SDK contains the necessary tools to implement straightforwardly a nontrivial open architecture to command the current loop of its motors, running in its own DSP mode, obtaining a soft-real time capabilities. The SDK contains•Application programming interface (Open haptics 2.0) is considered.Input and output handlers for system control and data acquisition.Kinematics and differential kinematics models is validated.Code in Visual C++ for protection.A DSpace-based real-time data acquisition subsystem in Visual C++ handles interruption and data flow of signals through the PC-based communication interface. Experiments are run at [K=1ms] or a sampling frequency of 1KHz.The robot is composed of•Pentium computer 4, with a 1.4GHz Intel dual processor and 1GB of RAM.PHANToM 1.0 (type A, from Sensable Technologies(r)).Remote cable-driven actuation, without flexibilities nor remote actuation problems.Software features is under OS Windows XP, running a compiler Vsual C++ 2008 under Matlab 2010 core and a API of Open Haptics 2.0.For the experimental validation the device performs the structured tracking of a closed trajectory (circumference). The experiment is defined by the following parametric equations:(34)xref=h+r*cos(wt)zref=h+r*sen(wt)yref=0where h represent its center, r the radius,w=2πf(rad/s)corresponds to the angular velocity, f is the frequency and finally T=1/f corresponds to the period. The experimental parameters for the wavenet neural network are seen in Table 1.Parameters are tuned according to bounds established in the stability proof, while others using heuristic intuition of plant and intrinsic properties of desired tasks to tune them, as it is usually the case in Lyapunov-based control. For the wavenet neural network, parameters are given in Table 1, for initial values shown on Table 2.

@&#CONCLUSIONS@&#
In this paper, a novel identification and control scheme for nonlinear MIMO systems based in wavenet with IIR filter, as pruning of irrelevant nodes, and RASP1 daughters wavelets is proposed for an efficient inverse dynamics approximation scheme. Such approximation capabilities and the basis of the input matrix is used to design a time-varying feedback gains such that recurrent discrete tuning of PID feedback gains occurs without any a priori knowledge of the robot. Contrary to most neural network controllers, approximation of inverse dynamics are not used for stabilization but for tuning feedback gains of a simple PID controller. Global convergence is obtained as iteration increases. Experiments show the viability of the proposed scheme for practical implementation, where typically the exact model is now known, in particular, it captures the essential full and real nonlinear dynamics, without any linearization nor idealization of non-linear robotics. Experiments on a nonlinear 3D highly coupled robotic system in real-time shows the relevance of the proposed control scheme.