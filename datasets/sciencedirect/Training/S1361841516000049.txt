@&#MAIN-TITLE@&#
Groupwise connectivity-based parcellation of the whole human cortical surface using watershed-driven dimension reduction

@&#HIGHLIGHTS@&#
Group-wise parcellation of the cortical surface.Clusters defined by homogeneous dMRI-based connectivity profiles.Parcellation of the whole cortex with an iterative patch by patch strategy.Clustering without any anatomical prior constraints.Complete validation on a new dataset of 79 healthy subjects.

@&#KEYPHRASES@&#
Connectome,Clustering,Structural connectivity,Diffusion tensor imaging,

@&#ABSTRACT@&#
Segregating the human cortex into distinct areas based on structural connectivity criteria is of widespread interest in neuroscience. This paper presents a groupwise connectivity-based parcellation framework for the whole cortical surface using a new high quality diffusion dataset of 79 healthy subjects. Our approach performs gyrus by gyrus to parcellate the whole human cortex. The main originality of the method is to compress for each gyrus the connectivity profiles used for the clustering without any anatomical prior information. This step takes into account the interindividual cortical and connectivity variability. To this end, we consider intersubject high density connectivity areas extracted using a surface-based watershed algorithm. A wide validation study has led to a fully automatic pipeline which is robust to variations in data preprocessing (tracking type, cortical mesh characteristics and boundaries of initial gyri), data characteristics (including number of subjects), and the main algorithmic parameters. A remarkable reproducibility is achieved in parcellation results for the whole cortex, leading to clear and stable cortical patterns. This reproducibility has been tested across non-overlapping subgroups and the validation is presented mainly on the pre- and postcentral gyri.

@&#INTRODUCTION@&#
Diffusion-weighted magnetic resonance imaging (DW-MRI) is a non-invasive technique providing in vivo information about human brain white matter fiber organization. Tractography algorithms allow the modeling of the white matter fiber organization exploring local orientation information. Cortical neurons are connected via such fibers, so that knowledge of the fiber tracts allows, in turn, the apprehension of the cortical areas according to their connectivity. The exploration of a large connectivity database, performed on macaque brains, showed that each cortical functional area has its own connectional fingerprint (Passingham et al., 2002). A connectivity-based structural parcellation seems therefore appropriate to extend the knowledge of the brain’s functional organization (Behrens and Johansen-Berg, 2005; Knösche et al., 2011). It should be noted that the expected results will probably be different from a parcellation from cytoarchitectonic information. Indeed, Brodmann areas are not necessarily homogeneous in terms of connectivity profiles.Connectivity-based parcellation techniques rely on clustering methods, dividing an input cortical region into a set of areas according to the connectivity homogeneity (Cloutman and Ralph, 2012; de Reus and Van den Heuvel, 2013). Each anatomical element of the input region is associated to a connectivity profile, representing the weights of its connections with a set of target regions. In this context, there are different approaches regarding the nature and the number of input anatomical elements and target brain regions. Global blind methods compute the connectivity with each voxel of the whole brain (Johansen-Berg et al., 2004; Anwander et al., 2007; Tomassini et al., 2007; Beckmann et al., 2009; Mars et al., 2012). In these methods the targets used to characterize the connectivity profile of one anatomical element are voxels, and we will speak about voxel-based connectivity profile or voxel-based connectivity. Such methods have the advantage of avoiding prior information on the anatomical organization. However, they are difficult to extend to groupwise parcellation, because of the huge dimension of the connectivity profiles. Moreover, at the voxel level the interindividual anatomical variability is difficult to estimate. Indeed, there are multiple sources of variability of the connectivity data across subjects, including: the artifactual variability created by weaknesses of the tractography, imperfect spatial registration, and the actual anatomical variability of the functional regions and distribution of fibers inside each region. The second class of methods use predetermined target regions, based on anatomical or functional atlases facilitating groupwise parcellation (Jbabdi et al., 2009; Broser et al., 2011). In these methods, the targets used to construct the connectivity profile of one anatomical element are regions defined a priori, and we will speak about a priori region-based connectivity profile or a priori regional connectivity. However, this approach depends on the prior information used to define the target regions and has been applied to only limited brain regions such as the supplementary motor area and thalamus (Jbabdi et al., 2009). Nevertheless, it makes it easier to establish structure-function relationships.The main contribution of this study is to propose and apply on a group of 79 subjects an alternative approach of group-wise connectivity-based human cortex parcellation, using an adaptive way to define the connectivity profiles. In terms of spatial resolution, our method is a trade-off between a priori regional connectivity and blind voxel-based connectivity approaches. Its originality is to define the target regions directly from the connectivity data, at the level of the group of subjects (Roca et al., 2010). For a given input region, these target regions are identified as being strongly connected to this input region in a reproducible way across subjects. In this context, we cannot directly parcellate the whole cortical surface in one step but we divide this surface into several patches of interest. We chose gyri as the base units for the parcellation in this study. The parcellation procedure thus proceeds with one gyrus at a time, and performs a whole brain parcellation by concatenating the per-gyrus results, but it could be applied to any other cortical segmentation defining regions on the cortical surface. Whereas the majority of methods are performed in the volume, our approach is based on a surface-based representation of the cortex, more adapted to its spherical topology. A surface-based registration of individual cortical surfaces, followed by a geodesic smoothing of connectivity data, is a first way to overcome cortical and connectional interindividual variabilities. A second complementary way consists in performing a group analysis defining the cortical target regions with reproducible connectivity to the input region.Another aspect of this study was to validate the results on a new set of high quality data, the ARCHI database (Duclap et al., 2013; Assaf et al., 2013), composed of 79 healthy subjects. For this purpose, the method has been fully automated, parallelized and implemented in the BrainVisa framework (Geffroy et al., 2011), including a generic way to tune the parameters according to any starting region and type of tracking (deterministic or probabilistic). The reproducibility of the proposed method has been tested on several partitions of subjects with similarity metrics calculated on all gyri or on a subregion, in order to prove the high reproducibility and stability of the method.The proposed method provides, at the level of the group of subjects, one connectivity-based parcellation of the whole cortical surface by concatenating results obtained from input patches. A flowchart of the groupwise parcellation method is shown in Fig. 1and will be detailed step by step in the following sections.The analyses were applied to the ARCHI database (Duclap et al., 2013; Assaf et al., 2013) composed of 79 subjects (32 females, mean age 23.65 years, SD = 5.16) with high quality T1-weighted images and diffusion data, acquired on a Magnetom TimTrio 3T MRI System (Siemens Healthcare, Erlangen, Germany). The MRI protocol used in this study included anatomical T1-weighted images at one millimeter isotropic spatial resolution, a B0 fieldmap to correct for susceptibility artifacts, and a high angular resolution diffusion imaging (HARDI) dataset along 60 optimized directions at a b value of 1500 s/mm2 with an isotropic spatial resolution of 1.7 × 1.7 × 1.7 mm3. The imaging parameters were as follows: T1-weighted data: 160 slices, FOV 256 mm, Phase FOV 93.8%, slice thickness, 1.1 mm, TE/TR=2.98/2300 ms, TI=900ms, FA = 9°, matrix 256 × 240, RBW = 240 Hz/pixel; diffusion data: 70 slices, field of view 220 mm, phase FOV 100%, slice thickness 1.7 mm, TE = 93 ms, TR = 14 s, flip angle FA = 90°, matrix 128 × 128, read bandwidth RBW = 1502 Hz/pixel, echo spacing ES = 0.75 ms, 1 excitation, partial Fourier factor PF = 6/8, parallel acceleration factor GRAPPA=2,total scan time 16 min 46 s.In order to take into account the interindividual cortical variability, a surface-based registration was done to align the main cortical folds across subjects. From T1-weighted images, cortical surfaces have been extracted using FreeSurfer 5 (Dale et al., 1999; Fischl et al., 1999b). For each subject, the cortical surface of each hemisphere was defined as the gray/white matter interface. The main advantage of using FreeSurfer here is that it provides a point-to-point correspondence on the cortical surface across subjects, allowing direct group studies (Fig. 2). In addition, a first parcellation into gyri allows overcoming the computational complexity of a parcellation of the whole cortex (Desikan et al., 2006). For each subject, the resulting cortical surfaces of the right and left hemispheres were then merged to form what we will call the individual cortical surface. In practice, this surface is composed of a set of aboutn=80,000nodes or vertices. In addition, for visualization purpose, a slightly inflated inter-subject average cortical surface was also created (Fischl et al., 1999a).The HARDI dataset was processed using BrainVISA and Connectomist 2.0 (Duclap et al., 2012). It was first corrected for artefacts using a threefold strategy: a detection and correction of spikes and signal dropouts, a correction of the geometrical distortions induced by susceptibility effects using a further fieldmap calibration providing a non linear deformation to be applied along the phase axis, and a joint correction for eddy currents and motion for each diffusion-weighted volume (each diffusion direction was corrected using the rotation stemming from the rigid motion of each DW volume) (Dubois et al., 2014). Then the analytical Q-ball model (Descoteaux et al., 2007) was computed to obtain Orientation Diffusion Functions fields for all the subjects. A robust brain mask defining the main domain of propagation of fibers was computed using the approach of (Guevara et al., 2011) relying on a T1-weighted segmentation that does not involve the use of empirically thresholded fractional anisotropy maps. Finally a streamline probabilistic tractography was performed on the entire brain mask using a propagation step size of 0.4 mm and a dense sampling (27 seeds per voxel at the T1 image resolution) leading to, on average, 30 million fiber tracts per subject. To evaluate the robustness of the proposed method with regards to the input tractography algorithm, a deterministic streamline tractography was also performed with 27 seeds per voxel. Next, each tractography dataset was filtered in order to remove tracts shorter than 30 mm, representing approximately 20 percent of the overall fiber tracts. Below that threshold, the short fibers may be less dense and more diffuse than large association fibers. Thus we chose to only deal with major fibers, to avoid a possible source of bias. Finally, each subject has a set of about 25 million tracts.The definition of the patches was based on the gyri segmentation computed using Freesurfer. This set of 70 gyri forms a partition of the whole cortical surface. In addition, we illustrated our method with two main patches corresponding to the pre- and postcentral gyri defined by Freesurfer (see Fig. 2). One additional study area was defined as the union of pre- and postcentral gyri, and called brain central region (BCR). In practice, pre- and postcentral patches are both composed of aboutm=2000vertices.For each subject, the cortical connectivity matrix of each patch was computed using tractography results and its individual cortical surface by counting the fibers connecting vertices of the patch to all the other vertices of the cortical surface (Cathier and Mangin, 2006; Roca et al., 2010). In this process a k-d tree is used in order to quickly find for a given fiber point its nearest vertex on the cortical surface.This matrix was then smoothed over the surface by solving the heat equation (equivalent to a Gaussian kernel of 3 mm). This smoothing, while preserving the total number of connections, accounts for a reasonable uncertainty on the tracking result, and ensures a better behavior with a small number of vertices in the input cortical surface. Moreover, it could help to stabilize the results for a smaller number of subjects in the group, by reducing the interindividual variability of the connectivity profiles. Thus a patch cortical connectivity matrix Cg, s, g ∈ [1, G], s ∈ [1, S] of shape (m × n) was obtained for each subject (see Fig. 1-Step 1). G denotes the number of patches and S is the number of subjects. m is the number of vertices in the processed patch, and n is the number of vertices in the cortical surface. In practice, the size of the patch connectivity matrix was approximately (2000×80,000) for the pre- or postcentral gyrus. Theithline of the patch connectivity matrix corresponds to the connectivity profile of theithvertex of the patch, representing its connections with each vertex of the cortical surface (Fig. 3).The objective of this part was to compress the cortical connectivity profiles in a way that maximizes the similarities across subjects. We projected the patch connectivity data of each subject onto a common sub-space, overcoming part of the inter-subject variability. In this context, the cortical connectivity profile of each vertex of the patch was reduced in four steps (Fig. 1. Step 1–4):For each subject, the cortical connectivity profile of the patch Pg, swas computed independently, e.g., by summing the cortical connectivity profiles over all patch vertices (or lines of the patch cortical connectivity matrix). This projection can be summarized as follows:Pg,s=∑i=1mCig,s,where Pg,sis a vector of size n andCig,sis the line i of Cg, s. Each individual profile was thresholded to keep only vertices with at least 1% of the maximum connections value of the profile.An intersubject mask is built by keeping vertices where at least one-half of the subjects possess a non-null value in the thresholded individual profile. The patch vertices are dropped from this mask in order to remove the internal connections. This mask is applied to these patch thresholded individual profiles. A joint patch cortical connectivity profilePgroupgwas computed by summing these masked profiles over the subjects (Fig. 1. Step 2). This joint profile was then normalized by its total number of connections. For each patch, the resulting joint connectivity profile was mapped onto the average cortical surface (Fig. 4). A watershed was then computed on this profile in order to split the cortical surface into catchment basins (Roca et al., 2009). Small basins are agglomerated to larger ones based on their depth and area. In practice, we obtained around 10–20 basins or target regions. Each region catches a set of tracts supposed to connect the patch to a specific cortical area. This idea justifies the use of this set of regions to collapse the profiles in an optimal way regarding the connectivity variability. Indeed, as seen in Fig. 4, the regions with a strong connection to the input patch (appearing in the connectivity profile of each subject) do not match perfectly across subjects when they are mapped onto the average cortical surface: the vertex V1 corresponds to a maximum of connection for subject 1, but not for the other subjects, where the maximum is spatially shifted. When these profiles are summed over the subjects, the previous regions are grouped together to form a unique region (see the average connectivity profile in Fig. 4). The watershed algorithm can then isolate this region as a single region (target region R1 in Fig. 4 for example).The previous joint target regions (basins) were used to reduce the dimension of the connectivity profiles (see Fig. 4). Indeed, for each subject independently, the columns of the cortical connectivity profile of each point (of size n) were collapsed using the watershed basins. Back projecting this information on the individual connectivity matrices reduces the dimensionality of the problem. Moreover, one part of the interindividual variability was then integrated inside these joint target regions. As illustrated in Fig. 4, the connectivity information resulting from each brain area represented by a catchment basin was summarized by one single weight. Local connectivity maxima with a reproducible location across the group of subjects (the 40 subjects of subgroup B1 here (as defined in Section 2.4.1)) are then merged in a single local maximum in the joint patch connectivity profile (third line, column 5). It is the case for the maxima belonging to the first nine cells of the grid, corresponding to the target region R1 (1 local maximum for subject1, 2 maxima for the other subjects). On the contrary, local connectivity maxima not reproducible across subjects are ignored: the local maxima of subject2 on point V2 (11th cell of the grid) is not comprised in a target region and will be ignored in the reduced connectivity profile (crossed area in the reduced connectivity profiles CR).Therefore, the spatial shifts between connections across subjects inside each of these basins, resulting from the interindividual variability, are then integrated by the dimension reduction. For each subject, a reduced connectivity matrixCreducedg,swith shape (m, n′), n′ < <n was obtained. n′ denotes the number of basins or target regions, the outcome of the watershed algorithm. In order to have comparable connectivity profiles between subjects, for each subject the individual connectivity profile of each vertex of the patch was normalized (L1 norm). With this normalization, each individual connectivity profile represents the distribution of the connections between each target region, and does not depend on the number of tracts of the vertex: only the proportion of each connection in the total number of connections of the vertex is kept for each target region.Using the point-to-point correspondence of the individual cortical surfaces, the individual reduced connectivity matrices were then averaged over the subjects, in order to obtain a joint patch connectivity matrixCgroup,reducedg,reflecting the connectivity data at the level of the group of subjects. This step can be summarized as follows:Cgroup,reducedg=(1/S∑s=1SCreducedg,s)of size (m, n′).In order to parcellate the whole cortical surface, we performed the previous steps with the 70 gyri of Freesurfer segmentation as the input patches. The joint connectivity matrix of each gyrus was computed as described above. Each gyrus was then clustered using the classical k-medoids algorithm (PAM for Partition Around Medoids (Kaufmann and Rousseeuw, 1990)) applied to the Euclidean distance matrix between the joint connectivity profiles (Fig. 1-Step 5). For the whole cortex parcellation presented in this paper, we clustered each gyrus for different numbers of clusters: 2 toKmax.Kmaxwas set equal to the surface area of the gyrus divided by 2 cm2. According to Van Essen and Dierker (2007), we expect clusters of 6 cm2 on average, so we chose aKmaxbeyond this value. Finally, the number of clusters maximizing the average silhouette width (defined more precisely in Section 2.4.2) was chosen as the optimal one.In order to validate the method, we evaluated the reproducibility of the results in two ways. First, we performed the group-wise connectivity-based parcellation on the whole cortex independently for two non-overlapping subgroups of subjects randomly chosen (40 subjects for A1 subgroup, and 39 subjects for A2 subgroup), forming a partition of our database.Then, on a restricted subregion of the cortex (pre- and postcentral gyri), we proceeded further: we defined several partitions of the database into two subgroups (partition A with subgroups A1 and A2, partition B with subgroups B1 and B2, partition C with subgroups C1 and C2). In each partition, the first subgroup was built by randomly drawing without replacement 40 subjects out of 79 and the second subgroup, with the 39 remaining subjects. A comparison of the obtained parcellations across partitions can then be performed in order to evaluate the degree of stability of the cluster patterns.In addition, we studied the influence of different parameters on the parcellation results (smoothing, number of clusters, tractography algorithm, and minimum fibertract length). The reproducibility was also tested in smaller groups of 10 subjects.The optimal number of clusters was evaluated by computing the average silhouette width measure (Kaufmann and Rousseeuw, 1990). This criterion gives an idea of how the samples (here the connectivity profiles) in the same cluster are homogeneous, and well-separated from other clusters. For each sample, the silhouette width is calculated using the mean intra-cluster distance a from the given sample and the mean nearest-cluster distance b, and is defined as follows:(1)s=b−amax(a,b)where b is the average distance between a sample and the samples from the nearest cluster that the sample is not a part of.The average silhouette width is the average of silhouette widths over all samples (here the connectivity profiles of all the vertices of a patch). The best value is 1 and the worst value is−1. Values near 0 indicate overlapping clusters. Negative values generally indicate that a sample has been assigned to the wrong cluster.We used different quantitative criteria to compare two parcellation results: the Dice coefficient and the Rand index. Unlike the average silhouette width, these measures reflect only the spatial consistency between the parcellations and do not compare the connectivity profiles.The Dice coefficient between two clusters c1 and c2 is defined as the size of their intersection divided by the average of their sizes and compares the similarity of two clusters:(2)D=2|c1∩c2||c1|+|c2|On our parcellations, the Dice coefficient was measured to compare the cluster c1 of a subgroup and the similar cluster c2 in the complementary subgroup.The Rand index (RI) (Hubert and Arabie, 1985) computes a similarity measure between two clusterings by considering all pairs of samples and counting pairs that are assigned in the same or different clusters in the two clusterings. The raw Rand index score is then “adjusted for chance” using the following scheme:(3)ARI=(RI−expectedRI)(max(RI)−expectedRI)The adjusted Rand index (ARI) is thus ensured to have a value close to 0 for random labeling independently of the number of clusters and samples and exactly 1 when the clusterings are identical.

@&#CONCLUSIONS@&#
In this study, we showed that our group-wise connectivity-based parcellation method can be applied to the whole cortex and on a large number of subjects, with a remarkable reproducibility of the results, even without using prior knowledge for the dimension reduction. Moreover, this reduction has the advantage of taking into account the interindividual variability. The method has been implemented in a complete pipeline which proves to be robust to various parameters. These first results are very encouraging even if additional improvements may be made. Applications of this groupwise connectivity-based cortex parcellation could include graph-based analyses of the connectome, where the graph nodes will be the clusters resulting from our method (Zalesky et al., 2010). Finally, the method could be applied in clinical or neuroscientific research, in order to compare the parcellations of two populations of subjects.