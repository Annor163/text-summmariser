@&#MAIN-TITLE@&#
Computation of the optimal tolls on the traffic network

@&#HIGHLIGHTS@&#
The aim is a search of an optimal solution of a fuzzy bilevel optimization problem.The problem is interpreted as a traffic network problem.Solution approach is based on stability regions and a switch between two problems.By examining all regions of stability we obtain the global optimal solution.

@&#KEYPHRASES@&#
Fuzzy optimization,Bilevel optimization,Toll problem,

@&#ABSTRACT@&#
The present paper is devoted to the computation of optimal tolls on a traffic network that is described as fuzzy bilevel optimization problem. As a fuzzy bilevel optimization problem we consider bilinear optimization problem with crisp upper level and fuzzy lower level. An effective algorithm for computation optimal tolls for the upper level decision-maker is developed under assumption that the lower level decision-maker chooses the optimal solution as well. The algorithm is based on the membership function approach. This algorithm provides us with a global optimal solution of the fuzzy bilevel optimization problem.

@&#INTRODUCTION@&#
We discuss hierarchical problems of two decision makers, in which one – the so-called leader – has the first choice and the other one – the so-called follower – reacts optimally on the leader’s selection. It is important to note, that each decision-maker maximizes his/her own benefits independently, but is affected by actions of the other decision-maker (through externalities). The formulation of the bilevel programming problem for crisp (i.e. with exactly known and fixed) data can be found in, e.g. (Dempe, 2002).Since its first formulation by Heinrich von Stackelberg in market economy (in the context of unbalanced economic markets), bilevel optimization has successfully been applied to many real world problems. For the past twenty years transportation problems have been benefiting from the formulation of advances in bilevel programming: (Ben-Ayed, Blair, Boyce, & LeBlanc, 1992; Brotcorne, Labbé, Marcotte, & Savard, 2001; Dempe, Fanghänel, & Starostina, 2009; Kim & Suh, 1988; Labbè, Marcotte, & Savard, 1998; Migdalas, 1995), which cover issues like network design, revenue management and other traffic control problems (where the transportation problem is on the lower level, depending on the parameter selected from the upper level).Considering the inherently difficult nature of bilevel problems due to their nonconvexity, nonsmoothness and implicitly determined feasible set, it is difficult to design convergent algorithms, and the few algorithms that converge appear to be very slow most of the time. The reason that a global optimal solution of the bilevel optimization problem is difficult to compute is due toNP-hardness of this problem (see Ben-Ayed & Blair, 1990; Blair, 1992).More often than not we have to make decisions without being able to rely on precise information. Thus, it makes perfect sense to speak about fuzzy optimization problems from a vague predicate approach, as it is understood that this vagueness arises from the way we express the decision-makers’ knowledge and not from any random event. These problems proved to be very useful in many applied sciences, such as engineering, economics, applied mathematics, physics, as well as in other disciplines: (Chanas & Kuchta, 1996; Jiménez, Cadenas, Sánchez, Gómez-Skarmeta, & Verdegay, 2006; Peidro, Mula, Jiménez, & Botella, 2010; Shih & Lee, 1999; Weber, Werners, & Zimmerman, 1990; Zimmermann, 1976).While some convergent algorithms for crisp bilevel problems already exist in the literature (see e.g. Bard, 1982; Bard & Moore, 1990; Bialas & Karwan, 1984; Dempe, 1987; Ishizuka & Aiyoshi, 1992; Önal, 1993; Tuy & Ghannadan, 1998; Wen & Huang, 1996; White & Anandalingam, 1993; Wu, Chen, & Marcotte, 1998), solution strategies for fuzzy bilevel programming problems are an emerging new field with a wide range of practical applicability.The present work is devoted to the computation of optimal tolls on a traffic network that is described as a fuzzy bilevel optimization problem. As a fuzzy bilevel optimization problem we consider bilinear optimization problem with crisp upper and fuzzy lower levels.An effective algorithm for computation optimal tolls for the upper level decision-maker is developed under assumption that the lower level decision-maker chooses the optimal solution as well.The algorithm is based on the membership function approach (Dempe & Ruziyeva, 2012). The lower level fuzzy optimization problem is solved by a method of level-cuts (see Dempe & Ruziyeva, 2011; Ruziyeva & Dempe, 2012 for nonlinear case). Elements of the Pareto set of the corresponding biobjective optimization problem are interpreted as potential optimal solutions of the lower level fuzzy optimization problem on a certain level-cut. The optimal solution is selected due to the highest membership function value.Then, this solution is used on the upper level such that, with respect to its region of stability, the optimal solution of the leader is found. For computation the regions of stability, Yager ranking indices are used (Liu & Kao, 2004; Ruziyeva & Dempe, 2013). Comparing all optimal solutions with respect to the upper level function value, the global optimal solution is found.The roadmap of the present paper is the following. In Section 2 the general formulation of the fuzzy bilevel traffic network problem is given.In Section 3 the solution approach to a fuzzy bilevel optimization problem is described.The structured algorithm is presented in Section 4.In Section 5 an illustrative example is solved with the help of the proposed approach.The conclusions are presented in Section 6.Let us assume that the government – as an upper level decision-maker – wants to restrict the traffic flow for the trucks on some streets near a certain landmark (e.g. a school, cultural heritage sites). One possible way is the use of tax-policy on some streets near this landmark. Certainly, the users of the network – the lower level decision-maker – try to minimize the overall costs and choose the cheaper path. But the price does not depend only on the taxes, but on, e.g. fuel, etc.The mathematical model of this problem is the following. There the functionF(ctoll,x)=(ctoll)Txmeasures the collected money (ctoll∈Ctoll⊂R+|E|) through a traffic networkG=(V,E)consisting of a node set V for junctions and an edge set E containing all streets connecting the junctions.Assume that the functionf∼(ctoll,x)measures the quality of the traffic flow x and depends on the crisp toll chargesctolland the fixed usual user’s fuzzy costs such as, e.g. fuelc̃. Possible realization isf∼(ctoll,x)=(ctoll+c̃)Tx.Computing the system optimum in the traffic network means that we maximize the collected money for the leader (the government) as the upper level objective function valueF(ctoll,x)and minimize the total costs for the travel of all the users (that we describe as one follower) in the network as the lower level objective function valuef∼(ctoll,x). Clearly these costs do not only depend on the fuzzy costsc̃efor traversing the edgee∈Ebut also on the collected toll chargescetoll. LetCtoll≔{cetoll:e∈E}and assume thatcetoll⩾0. If for somee0∈Ece0toll=0we say, thate0is a toll-free path.Using this problem a user equilibrium traffic flow can be computed provided that the costsc̃eare approximately known, i.e. have fuzzy values, and depend on the flow over this edge. Using fuzzy travel costs, the computation of the traffic flow reduces to a fuzzy network flow problem.Assume that v units of a certain commodity should be transported with minimal for the users (follower) overall costs from the origins∈Vto the destinationd∈Vthrough the traffic network G. The problem on the lower level is to compute optimal amounts of transported commodities on the streets of the network.Letxe=xkldenote the amount of transported units over the edgee=(k,l)∈E, that connects two vertices k and l (k,l∈V). LetOk(Ik) denote the set of all edges leaving (entering) the node k.Assume that the streets may have different capacities and let the flowxeon the edge e be bounded by the capacityue. This is expressed in the inequality (3) given below. The constraint (4) is used to guarantee that the total incoming flow is equal to the total outgoing flow. Moreover, the outgoing flow in the origin equals to v (see (5)).In given terms it is formulated as follows.(1)F(ctoll,x)=∑e∈Tcetollxe→maxcetoll∈Ctoll(2)subject toxsolvingf∼(ctoll,x)=∑e∈E∑e∈Tcetollxe+c∼exe→minx(3)xe≤ue∀e∈E(4)∑k∈Ilxkl-∑i∈Olxli=0,∀l∈V⧹{s,d}(5)∑k∈Isxks-∑i∈Osxsi=-v,(6)xe≥0It is easy to see, that (1)–(6) is a fuzzy bilevel optimization problem. Let us pose (1)–(6) in a compact form of(7)F(ctoll,x)→minctoll∈Ctolls.t.f∼(ctoll,x)→minx∈X,where polytope X is a set of solutions of (3)–(6)Ψ(ctoll)=argminxf∼(ctoll,x):x∈Xis the optimal solution set of lower level problem (2)–(6).There exist only few possibilities to deal with bilevel optimization problem. Namely,1.Assume that the follower always selects the optimal decisions which give the worst values ofF(ctoll,x). This is the pessimistic or strong approach (Dempe, 2002), which is used when the leader is not able to influence the follower and is forced to choose an approach bounding the damage resulting from an unfavorable selection by the follower. The resulting problem is:minctoll∈Ctollϕp(ctoll),whereϕp(ctoll)=maxx∈Ψ(ctoll)F(ctoll,x).Assume that the leader is able to influence the follower, so that the last one always selects the variables x to provide the best value ofF(ctoll,x). This results in the so-called optimistic or weak approach (Dempe & Starostina, 2007), where the resulting problem is stated asminctoll∈Ctollϕo(ctoll),whereϕo(ctoll)=minx∈Ψ(ctoll)F(ctoll,x).In the case when none of the assumptions described earlier can be conceded, selection function approach (Dempe & Starostina, 2006) can be applied to the initial fuzzy bilevel optimization problem.The selection approach 3. is quite new and it seems to be more appropriate for our needs. Let us denote some element ofΨ(ctoll)byx(ctoll)and assume, that this choice is a fixed selection function for all possiblectoll∈Ctoll(see Dempe & Starostina, 2006). The vector of parametersctolldescribes the “environmental data” for the fuzzy lower level problem.To compute the selection function the fuzzy linear optimization problem on the lower level has to be solved. We assume that an optimal solution of the fuzzy optimization problem has to be fuzzy and solve problem (2)–(6) using the membership function approach described in Dempe and Ruziyeva (2012) in detail.The preferable optimal solution on the lower levelxˆis supposed to have a maximal membership function valueμ(xˆ), i.e. according to Chanas and Kuchta (1994), the solution has the highest potential being realized by the follower. An algorithm for computation of values of the membership function of the elements of the fuzzy solution of the fuzzy linear optimization problem is also presented in Dempe and Ruziyeva (2012). With this innovative approach the decision-maker obtains a collection of some basic solutions, each accompanied by a measure of the extent to which it is the optimal solution of the fuzzy linear optimization problem on the lower level.We are interested only in basic solutions of the fuzzy linear optimization problem (on the lower level) in view of the followingRemark 1Let two neighboring verticesx1andx2in polytope X have membership function valuesμ(x1)andμ(x2), respectively. Then the membership function value for each pointx3on the face in between these two vertices (x3∈conv{x1,x2}) is equal toμ(x3)=min{μ(x1),μ(x2)}.For computation regions of stability of each solution we have to compare fuzzy vectors. A problem of incomparability of the fuzzy vectors is solved by using Yager ranking indexes approach (Ruziyeva & Dempe, 2013).Definition 1Liu and Kao, 2004For a fuzzy numberd∼∈C∼the Yager index is computed as(8)I(d∼)=12∫01[dL(α)+dR(α)]dα,where[dL(α),dR(α)]is anα-cut of the fuzzy numberd∼.The optimization problem on the upper level is a crisp linear optimization problem. Thus, it can easily be solved (see e.g. Bertsimas & Tsitsiklis, 1997).Using of stability regions and a switch between two problems it is possible to find an optimal vector of coefficients at the upper level of the fuzzy bilevel optimization problem such that the chosen solution on the lower level stays optimal in the fuzzy bilevel programming problem. By examining all possible regions of stability, as it is proved below, we obtain the global optimal solution.Setk≔1andR≔Ctoll. Fix a random fuzzy vectorck∈Ctolland a level-cutα∈(0,1).STEP 1. For the fixedckandαcompute an optimal solutionx^k≔x^(ck)of the fuzzy lower level problem with a maximal membership function value.STEP 2. Find the region of stabilityR(x^k)=ctoll:I(f∼(ctoll,x))⩽I(f∼(ctoll,xi))∀i∈B,ctoll∈R,where I stays for Yager ranking index and B for the set of basic solutions.STEP 3. Solve the upper level optimization problem(9)F(ctoll,x^k)→minctoll∈R(x^k).Denote an optimal solution of problem (9) throughc^k. Retain the pair(c^k,x^k).STEP 4.R≔R⧹R(x^k). IfR=∅, then STOP. Else fixck+1∈int(R)and go to STEP 1 withk≔k+1.STEP 5. Compare the pairs(c^1,x^1),…,(c^n,x^n), where n is number of iterations, and choose(c^,x^)– the best pair with respect to the upper level functionF(ctoll,x).If there exist two different pairs(c^i,x^i)and(c^j,x^j)such that(c^i,x^i)≠(c^j,x^j)with the same upper level function valueF(c^i,x^i)=F(c^j,x^j), we suggest to choose such a pair that has a best second component, i.e. ifμ(x^i)>μ(x^j), then the pair(c^i,x^i)is better (more preferable) than(c^j,x^j).At STEP 2 it is possible to compute the regions of stability directly asR(x^)={c∼:c∼x^⪯c∼xi∀i∈B,c∼∈C∼}.ThenR(x^)is a fuzzy set and problem (9) is a fuzzy optimization problem. This type of fuzzy bilevel optimization problem is solved in Ruziyeva (2013).At STEP 4 the notionint(R)is used for the interior of the set R.A region of stability is a convex connected set.If a region of stability of some solutionx0∈Xis a point, then the solutionx0is nonstable.The algorithm is convergent.The feasible set X has a finite number of vertices, and according to Remark 1 we are interested only in the basic solutions. Let the total number of basic solutions be N. It is clear thatN<∞. Thus, for each best solution on the lower level we obtain its region of stability. The total number of the regions of stability cannot exceed N. Taking into consideration Corollary 1 and Remark 5, the theorem is proved.□The pair(c^,x^)is a global optimal solution.The proof of this fact is obvious with the rule of contraries. Suppose that there exist other global optimum, e.g. the pair(c0,x0)such thatF(c0,x0)<F(c^,x^). In consideration of STEP 4 and its STOP criteria the region of stabilityR(x0)of the solutionx0of the lower level problem is considered in one of the iterations. But the assumption of the theorem is following. Since after all the comparisons at the STEP 5 of the algorithm the best solution is(c^,x^), consequentlyF(c^,x^)<F(c0,x0). This is contradiction to the assumption that(c0,x0)is a global optimal solution.□To accomplish the discussion it is interesting to explain the results by giving a special example – the traffic problem with fuzzy cost coefficients.Description of a numerical example is the following:F(ctoll,x)=c13tollx13+c23tollx23+c34tollx34→maxCtoll=[0,5]3f∼(ctoll,x)=3∼x12+(3∼+c13toll)x13+(3∼+c23toll)x23+7∼x24+(3∼+c34toll)x34→minxx12+x13=900⩽x12≤90x24+x34=900⩽x13≤90with demandand capacity0⩽x23≤60x12=x23+x240⩽x24≤30x13+x23=x340⩽x34≤90The corresponding traffic network is illustrated in Fig. 1.Let here fuzzy numbers be defined as continuous triangular fuzzy numbers:3∼=(1,3,5)and7∼=(5,7,9).As we will see later, the investigated problem has on the lower level has three basic solutions, namely,x^1=(30,60,0,30,60)T,x^2=(0,90,0,0,90)Tandx^3=(90,0,60,30,60)T.Fix some toll parametersc1toll=(c13toll,c23toll,c34toll)≔(5,4,0)∈Ctoll=:R.STEP 1 (Iteration 1). For this fixed parameter we compute an optimal solution of the lower level problem with the following objective functionf∼(c1toll,x)=3∼x12+8∼x13+7∼x23+7∼x24+3∼x34,where8∼=(6,8,10). As soon as the solutionx^1has a maximal membership function value, we take it for the further consideration.STEP 2. For this solution we compute its region of stability. The solutionx^1is an optimal one untilctoll∈R(x^1)=ctoll:ctoll∈R,I(f∼(ctoll,x^1))⩽I(f∼(ctoll,x^2)),I(f∼(ctoll,x^1))⩽I(f∼(ctoll,x^3))=ctoll:ctoll∈R,I(3∼·30+(3∼+c13toll)60+7∼·30+(3∼+c34toll)60)⩽(3∼+c13toll)90+(3∼+c34toll)90,I(3∼·30+(3∼+c13toll)60+7∼·30+(3∼+c34toll)60)⩽I(3∼·90+(3∼+c23toll)60+7∼·30+(3∼+c34toll)60)=ctoll:ctoll∈R,I(7∼-3∼)⩽c34toll+c13toll,c13toll⩽I(3∼)+c23toll=ctoll:ctoll∈R,4-c34toll⩽c13toll⩽3+c23toll.STEP 3. Now we solve the following upper level problem:F(ctoll,x^1)=c13toll60+c23toll0+c34toll60→maxctoll∈R(x^1),where the optimal solution iscˆ1toll=(5,4,5).The pair(cˆ1toll,x^1)is a local optimal solution of the initial fuzzy bilevel programming problem. That means, that this solution is optimal within a neighboring set of solutions, namely inR(x^1)×Xwith the upper level function value equal to 600.STEP 4. According to the algorithm, as soon asR≔R⧹R(x^1)={ctoll:ctoll∈R,4-c34toll⩾c13toll}∪{ctoll:ctoll∈R,c13toll⩾3+c23toll}≠∅, we select another vector in R, e.g.c2toll≔(1,5,2)and go to STEP 1.STEP 1 (Iteration 2). For thisc2tollwe have a different lower level problem with the following objective functionf∼(c2toll,x)=3∼x12+4∼x13+8∼x23+7∼x24+5∼x34,where4∼=(2,4,6)and5∼=(3,5,7). A solution with a maximal membership function value isx^2T=(0,90,0,0,90).STEP 2. A region of stability of this solution isR(x^2)={ctoll:ctoll∈R,4-c34toll⩾c13toll}∩{ctoll:ctoll∈R,10+2c23toll⩾3c13toll+c34toll}.STEP 3. Solve now the following upper level problem:F(ctoll,x^2)=c13toll90+c23toll0+c34toll90→maxctoll∈R(x^2),that has an optimal solutioncˆ2toll=(1,5,4).The pair(cˆ2toll,x^2)is a local optimal solution of the initial fuzzy bilevel programming problem with the upper level function value equal to 450.STEP 4. As soon asR≔R⧹R(x^2)≠∅, we select another vector in R, e.g.c3toll≔(5,0,3)and go to STEP 1.STEP 1 (Iteration 3). Then the objective function on the lower level isf∼(c3toll,x)=3∼x12+8∼x13+3∼x23+7∼x24+6∼x34,where6∼=(4,6,8). A solutionx^3T=(90,0,60,30,60)has a maximal membership function value.STEP 2. Analysing sensitivity ofx^3we obtain that the region of stability for this solution isR(x^3)={ctoll:ctoll∈R,c13toll⩾3+c23toll}∩{ctoll:ctoll∈R,10+2c23toll⩽3c13toll+c34toll}.STEP 3. It is easy to obtain that the problem on the upper levelF(ctoll,x^3)=c13toll0+c23toll60+c34toll60→maxctoll∈R(x^3)has an optimal solutioncˆ3toll=(5,0,5).The pair(cˆ3toll,x^3)is a local optimal solution of the initial fuzzy bilevel programming problem with the upper level function value equal to 300.STEP 4. As soon as now we covered all the leader’s feasible set with the regions of stability, i.e.R≔R⧹R(x^3)=∅, we STOP.Now we have to compare the pairs(cˆ1toll,x^1),(cˆ2toll,x^2)and(cˆ3toll,x^3)with respect to the upper level functionF(ctoll,x). Thus, the pair(cˆ1toll,x^1)with the upper level function value equal to 600 is the global optimal solution of the initial problem.

@&#CONCLUSIONS@&#
In the present paper the algorithm solving the problem of optimal tolls on the traffic network is described. The problem itself is presented as the bilinear fuzzy bilevel optimization problem. At the lower level the fuzzy optimization problem is solved by methods of the level-cuts.The optimal solution on the certain level is selected due to the highest membership function value as the best solution. Then, this solution is involved in a switch between upper and lower level problems such that, with response to the region of stability, the described algorithm gives a global optimal solution of the fuzzy bilinear bilevel optimization problem. Thus, the leader can see correlation of the tolls on the certain paths with solution of the follower.This method is illustrated with the example of the traffic problem with given fuzzy costs. As the leader we can see the government that can use the tolls to motivate the users of the network to avoid certain regions, such as UNESCO world heritage sites on the path(2→3). On the other hand, using the toll policy it is also possible to oblige the users to choose the certain path(1→2→4,1→3→4).