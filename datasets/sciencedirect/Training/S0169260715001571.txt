@&#MAIN-TITLE@&#
R-peaks detection based on stationary wavelet transform

@&#HIGHLIGHTS@&#
This work makes a R-peaks detection based on stationary wavelet transform (SWT).It has the same sampling time of the signal.It inherently leads to more accurate estimation of the QRS fiducial points.It detect R peaks over different types of arrhythmias and types of noise.Only one scale of SWT is applied, in order to reduce the computational complexity.

@&#KEYPHRASES@&#
ECG,Wavelet transform,R-peaks detection,Stationary wavelet transform (SWT),

@&#ABSTRACT@&#
Automatic detection of the QRS complexes/R-peaks in an electrocardiogram (ECG) signal is the most important step preceding any kind of ECG processing and analysis. The performance of these systems heavily relies on the accuracy of the QRS detector. The objective of present work is to drive a new robust method based on stationary wavelet transform (SWT) for R-peaks detection. The decimation of the coefficients at each level of the transformation algorithm is omitted, more samples in the coefficient sequences are available and hence a better outlier detection can be performed. Using the information of local maxima, minima and zero crossings of the fourth SWT coefficient detail, the proposed algorithm identifies the significant points for detection and delineation of the QRS complexes, as well as detection and identification of the QRS individual waves peaks of the pre-processed ECG signal.Various experimental results show that the proposed algorithm exhibits reliable QRS detection as well as accurate ECG delineation, achieving excellent performance on different databases, on the MIT-BIH database (Se=99.84%, P=99.88%), on the QT Database (Se=99.94%, P=99.89%) and on MIT-BIH Noise Stress Test Database, (Se=95.30%, P=93.98%). Reliability and accuracy are close to the highest among the ones obtained in other studies. Experiments results being satisfactory, the SWT may represent a novel QRS detection tool, for a robust ECG signal analysis.

@&#INTRODUCTION@&#
The electrocardiogram (ECG) is one of the most important tools in the diagnosis of heart diseases. In the ECG, QRS complex may be the most significant feature among all ECG features. This explains the fact that its automatic detection is the most important step preceding any kind of ECG processing and analysis (classification, some denoising algorithm, etc.). The performances of these systems heavily rely on the accuracy of the QRS complexes/R-peaks detector. However, due to the non-stationary of the ECG signal, the physiological conditions and the presence of many artifacts, finding a robust and general algorithm for ECG feature detection is a tough task. Therefore, many researchers have proposed a number of methods of the QRS complexes detection in the ECG in the past years, but none of them proves universally acceptable accuracy. Thus, efforts are constantly deployed for their enhancement. For instance, methods based on the wavelet transform (WT) [1–7].The wavelet transformation is used for the signal decomposition, localized simultaneously in time and frequency by inducing a change of basis for the signal in question. Generally, in this approach, the R peak is located at a point being the local maxima of several consecutive dyadic wavelet scales [2]. Based on this principle, many other researches were published on the beat detection using a WT filtering step [1,3–7].There are two kinds of wavelet transform, the Continuous Wavelet Transform (CWT) and the Discrete Wavelet Transform (DWT). The continuous wavelet transform contains redundant signal information. In addition, a consumption calculation of the CWT made in [8] showed that it is four times more power consuming than the digital wavelet computing. Although this fact would give priority to the use of the discrete wavelet transform in real-time automatic R peaks detection applications, DWT suffers from three major limitations; (1) shift sensitivity, (2) poor directionality, and (3) absence of phase information. In addition, when employing the wavelet transform for detection purposes, this approach has two important drawbacks, the lack of shift invariance and the loss of resolution at coarse scales. These problems can be avoided by using an overcomplete wavelet transform. The so-called stationary wavelet transform[9] achieves this by taking timeshifts equal to all integer values instead of two. Even if the use of the stationary wavelet transform (SWT) in the ECG signal denoising is subject of particular interest in recent research [10,11]. Its use in the ECG signal waves detection was rarely investigated. Hence, we propose in this paper, a robust method based on SWT for QRS complex detection. The obtained results are promising the algorithm is able to detect R peaks over different databases and outperforms the other algorithms evaluated on the same database, according to recent publications.The paper is organized as follows: Section 2 provides details on the proposed algorithm, including an accurate description of the choice of the decision parameters such as the choice of the wavelet, the desired level of signal decomposition and the coefficients detail selection. This section also includes presentation of the SWT based QRS/R-peaks detection method. The proposed method is tested in Section 3, followed by the results discussion in Section 4. Finally, Section 5 concludes the paper.To further evaluate the proposed algorithm and allow comparison with other studies, manually annotated ECG signals from various databases are used. The MIT-BIH Arrhythmia Database (MITDB) [12], the QTDB [14] and the MIT-BIH Noise Stress Test Database (NSTDB) [13]. In addition to the 48 records (109,494 beats) as in [1] from MITDB and the 12 records (25,590 beats) from NSTDB, 105 records (86,892 beats) from the QTDB are used. Each record of QTDB contains 2 ECG channels digitalized with a sampling frequency of 250Hz.The SWT is also known by a variety of names in the literature including the dyadic wavelet transform (i.e. dyadic in scales), maximal overlap transform and the redundant wavelet transform. SWT is an offshoot of DWT whereby the scales are dyadic but the time steps are not subsampled at each level and hence are not dyadic. In terms of redundancy, the SWT is an intermediate representation of the high redundancy CWT and the nonredundant DWT. It maintains a dyadic sampling of the scales, and therefore maintains a non-redundancy frequency, but carries an almost continuous and uniform sampling time [15]. It has an interest in our study because; unlike the DWT, the redundant representation of SWT makes it shift-invariant and suitable for applications such as edge detection, denoising and data fusion. Since the decimation of its coefficients at each level of the transformation algorithm is omitted, more samples in the coefficient sequences are available, with equal length wavelet coefficients at each level, and hence a better detection can be performed. The DWT cannot provide this feature. Which is critical for a robust detection of the QRS complexes. The SWT has a similar tree structured implementation as DWT [16], without any decimation (sub-sampling) step as shown in Fig. 1. We can write a general transformation equation of SWT based on the coefficients cj,kcalculated as follows:(1)cj,k=∑n∈zx(n)ψ′j,k(n),whereψ′j,k(l)is the discrete wavelet defined by:(2)ψ′j,k(l)=2−(j/2)ψ0,0(2−j(l−k)),The wavelet coefficients are given by caj,kand cdj,k, which represent the approximate (scaling) coefficients and detail (wavelet) coefficients respectively, generated through the convolution chain of the original signal sequence x(n) and level-adaptive size-varying highpass filter h1 and lowpass filter g1 respectively, as shown in Fig. 1.Thus, the first scale and detail coefficients ca1,kand cd1,kof the SWT can be calculated from a convolution of the input signal x(n) with highpass filter h1 and lowpass filter g1 respectively, as:(3)ca1,k(n)=∑h1(n−τ)x(τ),cd1,k(n)=∑g1(n−τ)x(τ).This can be generalized to the different coefficients scales by:(4)caj,k(n)=↑2j−1h1*caj−1,k=∑hj(n−τ)caj−1,k(τ),cdj,k(n)=↑2j−1g1*caj−1,k(k)=∑gj(n−τ)adj−1,k(τ).where↑2j−1h1=hj(n)is the over-sampling of the low-pass filter hj−1(n) coefficients and↑2j−1g1=gj(n)is the over-sampling of the high-pass filter gj−1(n) coefficients, which are given by:(5)gi(2n)=gi−1(n)gi(2n+1)=0hi(2n)=hi−1(n)hi(2n+1)=0One can clearly see from the previous equation, that the highpass filter h1 and lowpass filter g1 are upsampled by a factor of two at each stage. Therefore, the decomposition coefficients (approximation and detail) have the same length Nc as the original signal x(n), where Nc=2j, making the output signal more accurate than the one obtained with DWT.Although a large variety of wavelets, are available, not all of them are suitable for peaks detection. There is no absolute rule for the choice of wavelets, but it is of utmost importance that the wavelet function corresponds closely to the processed signal [17].In this work, the Daubechies2 wavelet is chosen because of its similar shape to the QRS complex and because of its energy spectrum is concentrated around the low frequencies [18]. The wavelet decomposition structure of MITDB record 100 up to 8 detail coefficients using Daubechies2 wavelet performed in [11] for denoising, is shown in Fig. 2.A comparison between the original ECG signal and the reconstructed signal is also shown in Fig. 4.The level of the wavelet transform affects the number and location of peaks in a signal. Choosing the desired level of decomposition is connected to the frequency components necessary for the signal analysis over a given number of samples. Since SWT requires that the number of signal sample is a power of two, the following relationship must be satisfied:2N=nwhere N=the total number of decomposition levels and n is the total number of the signal samples. Since most of the ECG signal energy is located within the first and fifth scale [11], the eighth scale is chosen in this study.While the mother wavelet can easily be chosen based on its characteristics and resemblance with a QRS wave, the ideal scale(s) at which the QRS are matched is harder to guess a priori. Thus, the several selections of detail coefficients for the detection of QRS complexes were proposed in the literature. In [19] Mahmoodabadi suggests the selection of details d3–d5 for R peaks detection. Saxena [18] in turn, uses the detail signal d4 for QRS peak detecting, while in the work of [20,1] five levels of wavelet, d1–d5, were used with a dyadic decomposition. Note that in all these works, DWT is used. In our case, the choice of detail coefficients is based on the following analysis.Most of the normal ECG signal energy is concentrated in a time interval of the QRS complex of about 80ms, and in a frequency band ranging from 3Hz to 40Hz [19].Fig. 3shows the plot of the mean energy of the eight scales of the entire MITDB record database. One can see that it has a maximum at the level of the detail coefficient cd4, which means that cd4 detail coefficient is a good candidate to be used in QRS complex detection.Here, we look for the frequency components of the detail signals that is correlated with that of the QRS complex. For this, the Fourier transform of each detail signal is carried out. From Fig. 4, we observe that the bandwidth of the cd4 detail signal happens to be within 2.5–39.5Hz, which is similar to that of the QRS complex.According to this frequency distribution of the ECG signal, it can be noted that the high-frequency components of the ECG signal decreases as the lower order details removed from the original signal.In addition to the above two analyses, the mean cross-correlation analysis between all detail signals and the original ECG signal of the entire MITDB record database was performed. This gives us a relationship in the time domain between the original QRS and the decomposed signals (signal details). The results are shown in Fig. 5.From this figure, we can notice that the cross-correlation coefficient of detail cd4 has the highest value, which means that the detail coefficient signal cd4, is the best placed to approximated the QRS signal in the time domain. Finally, we can conclude that the detail coefficient cd4 is the best choice to be used for QRS detection.

@&#CONCLUSIONS@&#
In this paper, a discrete stationary wavelet transform for the automatic detection of R-Peaks in ECG is introduced. The algorithm exploits the translations invariance of the SWT, which preserves the important time aspect of the non-stationary ECG signal, and is effective because it takes into account the nonstationarity of the signal. In order to reduce the computational complexity, only the coefficients at scale 24 obtained by the SWT is applied to detect the R-Peaks. It has the advantage, to have a same sampling time of the signal with respect to the DWT.The performance of the proposed method is promising. It has been tested on different databases, with the MITDB and the QTDB for the R-peaks detection and QRS-complex delineation and the NSTDB for the noise sensitivity. The presented method achieved excellent performance on the MITDB (Se=99.84%, P=99.88%). The validation results with QTDB are good enough to meet the demand for QRS-complex detection (Se=99.94%, P=99.89%). Evaluation results on the NSTDB indicate that the algorithm is effective (Se=95.30%, P=93.98%). This confirms that the SWT filtering is sufficient for effective QRS detection in signals contaminated with higher noise amplitudes. Thus, this reliable robustness against strong noise, artifacts and probable severe arrhythmia(s) of NSTDB can be mentioned as important merits and capabilities of the proposed algorithm.This new algorithm also exhibited very good accuracy in QRS delineator on QTDB, where the mean error between automatic and manual annotations was lower than 1 samples for all the characteristic points, and the associated average standard deviations outperforms the other algorithms evaluated on the same database, according to recent publications.