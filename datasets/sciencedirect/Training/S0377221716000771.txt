@&#MAIN-TITLE@&#
Multiplicity of equilibria in conjectural variations models of natural gas markets

@&#HIGHLIGHTS@&#
The gas market is represented by a partial equilibrium model including market power.We demonstrate that some prices and flows are not unique in general.The gas flows to consumers are unique for traders exerting market power.We conclude that the entire solution space has to be considered for interpretation.We discuss the economical meaning of parameter value changes which enforce uniqueness.

@&#KEYPHRASES@&#
OR in energy,Conjectural variations,Existence and uniqueness of solutions,Natural gas market,Linear complementarity program,

@&#ABSTRACT@&#
Spatial partial equilibrium models incorporating conjectural variations are widely used to analyze the development of oligopolistic multi-agent markets, such as international energy and raw material markets. Although this model type can produce multiple equilibria under commonly used assumptions, to the best of our knowledge, the consequences for the interpretation of the model results have not yet been explored in detail. To this end, we derive a linear complementarity model for the gas market and discuss under which assumptions on the model structure a component of the solution is unique. In particular, we find that the gas flow between a trader and a consumer is unique whenever the trader is modeled to exert market power in the consumer’s market. We demonstrate our findings by computing the extreme points of the polyhedral solution space and show that erroneous conclusions could be drawn whenever only one (arbitrary) point in the solution space is picked for interpretation. Furthermore, we discuss whether economically meaningful parameter value changes exist which would enforce uniqueness in all components of the solution.

@&#INTRODUCTION@&#
Spatial partial equilibrium models including conjectural variations (SPE-CV models) are a popular tool to investigate oligopolistic markets, such as fossil fuel or electricity markets (Díaz, Villar, Campos, & Reneses, 2010; Kamiński, 2011; Neuhoff et al., 2005). These markets are characterized by a high capital intensity as a result of high exploration costs, long lead times, large distances between producing and consuming regions, or expensive infrastructure requirements. This creates high barriers to entry and limits the competition, which allows major traders to exert market power over consumers.In SPE-CV models, multiple traders are distinguished to represent the impact of market power exertion. As a consequence, one of the model outcomes are the sales of the individual traders to consumers, which is of interest in practice, because it indicates which two parties are likely to trade in a given situation. Unfortunately, this representation may also introduce redundancies to the model, mathematically corresponding to the existence of multiple solutions for a given set of parameters, and economically to the existence of multiple market equilibria in a single situation. This is problematic when it comes to the interpretation of the model results, since one could not determine which, of the possibly many, equilibria proposed by the model become reality.In the presented study we investigate SPE-CV models for gas markets. Several variants have been proposed in the past, including the special cases of Cournot and Bertrand competition. The most prominent examples are the dynamic GASTALE model by Lise and Hobbs (2008), and the World Gas Model(WGM) by Egging, Gabriel, Holz, and Zhuang (2008): both models assume international gas traders to exert market power over consumers, and compete perfectly for infrastructure services such as transmission or storage capacity. The dynamic GASTALE model (de Joode & Özdemir, 2010; Lise, Hobbs, & van Oostvoorn, 2008) and the WGM (Egging, 2013; Egging, Holz, & Gabriel, 2010; Egging, 2010; Gabriel, Rosendahl, Egging, Avetisyan, & Siddiqui, 2012; Gabriel, Zhuang, & Egging, 2009; Huppmann, 2013; Moryadee, Gabriel, & Avetisyan, 2014; Zhuang & Gabriel, 2008) were expanded successively and used for various case studies.However, in most articles, the multiplicity of solutions is not discussed. Exceptions include (Gabriel, Kiet, & Zhuang, 2005), who analyzed a predecessor of the WGM and derived uniqueness criteria for the intermediate and wholesale prices, and Egging (2010), who presented an example in which non-unique service prices can arise in the WGM. To the best of our knowledge, the remaining variables, particularly the volume flows, have not yet received any attention. The contribution of this article is to analyze the multiplicity of all variables by exploiting the information hidden in the mathematical structure of the problem. For the non-unique variables, we discuss whether uniqueness is relevant for interpretation in the first place, and investigate how uniqueness could be achieved based on changes in the model’s parameter values.The remainder of this article is structured as follows. In the next section, we introduce a SPE-CV model for the gas market. In Section 3, we substantially reduce the number of equations by expressing (infrastructure) service prices and volume flows explicitly. Service cost functions are affine or quadratic in the volume flows, allowing the model to be represented as a linear complementarity problem. Subsequently, we carry out the mathematical analysis concerning the multiplicity of solutions. In Section 4, we demonstrate our findings via a numerical example. In Section 5, we discuss our theoretical and numerical results, and in Section 6, we summarize and conclude our work.The structure of our SPE-CV model comprises nodes and arcs, and distinguishes multiple time periods within a year. The nodes represent countries or regions, in which gas is produced, stored, and sold to consumers. The arcs represent the gas flow capacities from one region to another. The differentiation of time periods allows a distinction of multiple levels of demand. The geographical and temporal granularity and range of the model can be adjusted to fit the requirements of a specific case; in the numerical example presented in Section 4, the world-wide gas trade over a year is represented by 50 nodes, 291 arcs, and 2 time periods (summer and winter half-year).While SPE-CV models are certainly able to capture the main properties of the gas market such as limited production, restricted transport capabilities, large seasonal demand fluctuations, and market power exerting traders, they do not provide any information on the status of the gas market within a node, implicitly assuming that the gas is distributed well and prices are uniform. If the region mapping to a node is chosen sufficiently small, this weakness can be compensated to some extent. Since publicly available data for some of the parameters, particularly production capacities and wholesale prices, is mostly limited to country-level, a finer granularity is rarely aimed for with SPE-CV models. Other types of models, such as the TIGER model (Dieckhöner, Lochner, & Lindenberger, 2013; Lochner, 2011a, 2011b; Lochner & Dieckhöner, 2012), or the model introduced by Carvalho et al. (2014), circumvent this data constraint by assuming a fixed and therefore price-independent demand; this eliminates the need for accurate wholesale price data and hence allows a higher model resolution.The mathematical formulation is inspired by other models in the field, particularly the deterministic version of the WGM proposed by Egging (2010), except that we refrain from modeling investments over time. In comparison to the WGM, we aim for a more compact representation of the overall model to facilitate the mathematical analysis, and therefore choose a more general notation for the individual components of the model to emphasize their similarity. The notation is introduced as we formulate the model, and summarized in Tables A.1–A.5. An exemplary model with two interconnected nodes is depicted in Fig. 1.The nodesn,m∈N,n≠mrepresent countries or regions, and the time periods are denotedt∈T. In each node n, a consumer Cn, a gas producing company Pn, a storage operator Sn, a liquefaction plant operator Ln, and a regasification plant operator Rnmay be located. The storage operator Snprovides two services: injection of gas (In), and extraction of gas (Xn). A transmission system operator Anmmanages the flows in the pipelines from n to m, and a shipping company Bnmtransports liquefied natural gas(LNG) from n to m. To simplify notation in the remainder of this paper, we introduce Zzas a placeholder for a producer or an infrastructure service Z in a node/arc z, thus Z ∈ {P, I, X, L, R, A, B}, andz∈Z,whereZis the corresponding subset of nodes/arcs in which a service11Although producers are not an infrastructure service, we henceforth include them in our notion of services.of type Z is active. Note that each service Zzrepresents all companies of type Z in a node/arc z, even if in reality multiple firms carry out this activity in the geographical region of z. Similarly, Cnrepresents the aggregated demand of all consumers located in node n.In most of the large companies, gas is produced in one division, and then internally transferred to the trading-arm of the company, which deals with the (international) trade and distribution. Each of these companies’ trading-arm is modeled by a trader Fn, which receives gas only from the producer Pnlocated in its home-node. Each Fnspreads out from his home-node through the network, thereby competes with the other traders for service capacities (except production capacities), and finally sells gas in the consumer markets, where it again competes with the other traders for market shares. While we assume all services to be price-takers, the traders exert market power in the consumer markets, which is modeled based on a conjectural variations approach. Note that since we only introduce traders which are associated with a producer, and gas is not resold among traders, arbitrage is limited and depends on the market power of the traders.The traders and service providers have perfect and complete information about the market. Therefore, the decision processes of the traders and the service providers can be modeled as (deterministic) optimization problems. In the following, we introduce the optimization problem of the traders (Section 2.2.1), the optimization problem of the service providers (Section 2.2.2), and the market clearing conditions (Section 2.2.3).The goal of each trader f is to maximize profitΠfF,which is equal to total revenueTRfFfrom sales to the consumers, minus the total costTCfFarising from using services:(2.1)ΠfF=TRfF−TCfF.f∈Frepresents an arbitrary trader in the set of all traders (whereas Fnis the specific trader whose home base is in node n). The total revenue of trader f reads(2.2)TRfF=∑t∈T∑n∈C(f)[(1−θfntC)λntC+θfntCΛntC(·)]qfntC.The decision variables are all theqfntCwhich represent the total amount of gas sold to the consumers in node n and period t. The quantity is multiplied by the corresponding wholesale price, and the product is summed over all periodsTand over the set of nodesC(f)in which the trader f and a consumer are present. The wholesale price comprises the weighted sum of two quantities: the price on the wholesale marketλntC,which is determined by the market clearing conditions and is exogenous to the trader; and the inverse demand functionΛntC,a function of the total demand∑f∈F(n)qfntC,on which the trader has influence via its decision variableqfntC. The weightθfntC∈[0,1]is referred to as the behavioral parameter of market power (Tremblay and Tremblay, 2012, Chapter 12) of trader f over consumers located in node n in period t: ifθfntC=1for all traders f, the market n in period t is characterized by a Cournot equilibrium, whereasθfntC=0for all traders f indicates a competitive equilibrium. Conceptually following the setting used by Egging et al. (2010) for the WGM, we also allow values0<θfntC<1,representing intermediate stages of the traders’ conjectures about the other traders’ behaviors.22There are different propositions how values ofθfntCdifferent from 0 and 1 should be interpreted, see for example (Perloff, Karp, and Golan, 2007, Chapter 3) for a discussion. In this work, we follow the interpretation of Tremblay and Tremblay (2012, Chapter 12) and think ofθfntCas “toughness of competition”, where decreasingθfntCindicates increasing competition.However, we do not allowθfntC>1and hence exclude cartelization of multiple traders.The inverse demand function in node n and period t is defined as(2.3)ΛntC(·):=INTntC+SLPntC∑f∈F(n)qfntC.INTntCrepresents the intercept of the inverse demand function, which corresponds to the maximum willingness to pay of consumers at node n in period t,SLPntCis the slope and is assumed strictly negative. These parameters are derived from the reference willingness to payWTPntC,reference demandDMDntC,and price elasticity ηnt, which in turn is calculated from the price elasticities of the residential and commercial, industrial and power sectors and their reference sharesSHRnd,·Cin consumption.(2.4)INTntC=(1−1ηntC)·WTPntC≥0(2.5)SLPntC=WTPntCDMDntC·ηntC<0(2.6)ηntC=ηnt,resC·SHRnt,resC+ηnt,indC·SHRnt,indC+ηnt,elC·SHRnt,elC<0All parameters can vary in n and t if the respective data is available. Following previous works of Lise et al. (2008) (dynamic GASTALE model) and Egging et al. (2010) (WGM), the inverse demand function is chosen affine; for a market analysis including more general structures of inverse demand functions we refer to Abolhassani, Bateni, Hajiaghayi, Mahini, and Sawant (2014).For each trader f, the total cost arising from service utilization can be written as(2.7)TCfF=∑Z∈{P,A,R,B,L,I,X}∑t∈T∑z∈Z(f)λztZqfztZ,where theqfztZare the decision variables of the traders and represent the volume flows between trader f and service provider Zz,λztZis the market price for using the service Zz(exogenous to the trader), andZ(f)is the set of nodes/arcs at which the trader f and a service provider of type Z are both present. Note thatqfntL≡∑m∈B(n)qfnmtBLOSSnL,andqfmtR≡∑n∈B(m)LOSSnmBqfnmtB,whereqfntL,qfnmtB,andqfmtRare the flows at arrival at the service providers, andLOSSnLandLOSSnmBare the loss factors from liquefaction and shipment;qfntLandqfmtRwill therefore be substituted for the remainder of this work.Each trader’s profit maximization is subject to several volume balances to ensure that the solution is reasonable: per trader f, all inflows have to match the outflows in each node n and each period t, and the yearly inflows into a storage unit have to be equal to the outflows in each node n.(2.8)hfntF1=qfntP+qfntX+∑m∈A(n)LOSSmnAqfmntA+∑m∈B(n)LOSSmnBLOSSnRqfmntB−qfntI−qfntC−∑m∈A(n)qfnmtA−∑m∈B(n)qfnmtBLOSSnL=0(ϕfntN)∀n,t(2.9)hfnF2=∑t∈TLOSSnIqfntI−∑t∈TqfntX=0(ϕfnS)∀nSome incoming and outgoing flows are multiplied and divided, respectively, byLOSSzZ∈(0,1],to account for incurring transaction losses.ϕfntNandϕfnSare the associated dual variables (Lagrange multipliers).Finally, all the decision variablesqfntCandqfztZcan be upper and lower bounded due to contracts, certain policies, sanctions, etc. We state these equations in the following, but for simplicity of notation will neglect them for the remainder of the paper.(2.10)qfntC≤UPPfntC(ξ¯fntC)∀f,n,t(2.11)qfntC≥LOWfntC(ξ̲fntC)∀f,n,t(2.12)qfztZ≤UPPfztZ(ξ¯fztZ)∀f,z,t(2.13)qfztZ≥LOWfztZ(ξ̲fztZ)∀f,z,tEach service provider Zzdetermines the total volume contracted to traderssztZby maximizing profitsΠzZover all time periods t:(2.14)maxsztZ≥0ΠzZ=∑t∈T(λztZsztZ−cztZ(sztZ))(2.15)s.t.gztZ1=CAP¯ztZ−sztZ≥0(αztZ)∀t(2.16)gzZ2=CAP¯zZT−∑t∈TsztZ≥0(αzZT).cztZ(sztZ)are the costs arising for the service provider Zzby contractingsztZand are assumed to be convex and twice differentiable,CAP¯ztZandCAP¯zZTare the service providers’ capacity limits per time period t and per year, andαztZandαzZTare the dual variables associated with the capacity constraints. As stated above,λztZis the market price for using the service and is exogenous to the service provider.Note thatgnX2can be used to model the working gas volume of a storage:CAP¯nXT−∑t∈TsntX≥0,whereCAP¯nXTis the maximum storable working gas in node n. Limiting the total extractable gas is equal to limiting the total storable gas under the assumption that the injection and extraction periods are separated, and the maximum storage level is reached at most once per year. This is clearly true when modeling up tot¯=3periods per year, but mostly also holds fort¯>3in reality. Also, the traders have perfect foresight over the entire simulation period, and therefore it is not necessary to specify whether the withdrawal or the injection period is first in the simulation. It suffices to ensure that the storage levels are equal or higher at the end of a storage cycle than before, which is guaranteed in equilibrium by Eqs. (2.9) and (2.16). To model the storage more accurately, additional constraints can be introduced in the formulation without affecting the theoretical conclusions, as long as they are affine in the decision variables.These conditions couple the decision variables of the traders (qfztZ) and the service providers (sztZ). By enforcing market clearance in every node n and period t, the dual variables of these equations, the market pricesλztZ,are determined:(2.17)hztM1=sztZ−∑f∈F(z)qfztZ=0(λztZ).Furthermore, in all nodes n and periods t we enforce clearing of the wholesale markets:(2.18)hntM2=λntC−ΛntC(·)=0(λntC).We derive the Karush–Kuhn–Tucker conditions of the optimization problems of the traders and service providers, and complement them with the market clearing conditions. This leads to Problem (2.19) which takes the format of a mixed non-linear complementarity program.(2.19a)0≤−∂ΠfF∂qfztZ−∑n′∈N(f)∑t′∈Tϕfn′t′N∂hfn′t′F1∂qfztZ−∑n′∈N(f)ϕfn′S∂hfn′F2∂qfztZ⊥qfztZ≥0∀f,z,t(2.19b)0≤−∂ΠfF∂qfntC−∑n′∈N(f)∑t′∈Tϕfn′t′N∂hfn′t′F1∂qfntC−∑n′∈N(f)ϕfn′S∂hfn′F2∂qfntC⊥qfntC≥0∀f,n,t(2.19c)0=hfntF1⊥ϕfntN(free)∀f,n,t(2.19d)0=hfnF2⊥ϕfnS(free)∀f,n(2.19e)0≤−∂ΠzZ∂sztZ−∑t′∈Tαzt′Z∂gzt′Z1∂sztZ−αzZT∂gzZ2∂sztZ⊥sztZ≥0∀z,t(2.19f)0≤gztZ1⊥αztZ≥0∀z,t(2.19g)0≤gzZ2⊥αzTZ≥0∀z(2.19h)0=hztM1⊥λztZ(free)∀z,t(2.19i)0=hntM2⊥λntC(free)∀n,tA solution to Problem (2.19) is simultaneously an optimal solution to the problems of all the traders and service providers. The solution represents a Nash equilibrium, in which all traders and service providers optimize their volume flows given the other traders’ and service providers’ decisions, and no party has an incentive to move away from the equilibrium.In this section, we address the mathematical characteristics of Model (2.19), particularly the existence and uniqueness properties of its solution. Before we start, we restate the model in a more compact way by eliminating superfluous variables, specifying the cost functions, and setting all loss factorsLOSSzZ=1.First, we want to reduce the number of variables and equations by substituting the decision variables of the service providerssztZand the service pricesλztZand eliminating Eqs. (2.19e) and (2.19h). This saves programming time, simplifies maintenance, and potentially reduces calculation times. SincehztM1=0for all arcs/nodes z and time periods t, we can immediately setsztZ:=∑f∈F(z)qfztZfor all z, t and eliminate Eq. (2.19h). The wholesale pricesλztCand Eq. (2.19i) could be substituted/eliminated in a similar way, however, we refrain from applying these changes to obtain a more favorable mathematical representation of the model for the derivation of our results.Eliminating the service pricesλztZand Eq. (2.19e) is somewhat more involved. We consider the complementarity constraint (2.19e) and distinguish two cases: for a specific z, t, either(i)sztZ>0⇒λztZ=dcztZ(sztZ)dsztZ+αztZ+αzZT,orsztZ=0⇒λztZ≤dcztZ(sztZ)dsztZ+αztZ+αzZT=dcztZ(sztZ)dsztZ|sztZ=0,the marginal costs for service provider Zzat zero throughput.αztZ=0andαzZT=0under the assumption thatCAP¯ztZ>0andCAP¯zZT>0,which is reasonable, since otherwise the variablesztZwould not have been introduced in the first place.Hence, we set the service priceλztZ:=dcztZ(sztZ)dsztZ+αztZ+αzZTfor all z, t regardless of the contracted volume flowsztZbeing greater or equal to zero. This is an easily justifiable change to the model, since the only expected change in the output is that the service priceλztZis also unambiguous for nonoperating services Zz.Second, for homogeneity of notation we relax Equalities (2.19c), (2.19d), and (2.19i) tohfntF1≥0,hfnF2≥0,andhntM2≥0,and simultaneously force non-negativity on the respective dual variables. This reformulation does not change the outcome of the model: we expecthfntF1=hfnF2=0in equilibrium, because the trader would otherwise be wasting gas, which is never optimal because production costs are assumed positive. Furthermore, in equilibrium we either havehntM2=0and wholesale pricesλntC≥0(as before), orhntM2>0andλntC=0(instead ofhntM2=0andλntC<0). But since it is never optimal for traders to sell gas atλntC≤0due to production cost being larger than zero, the second situation never arises. In reality, these assumptions may not always hold: it may be cheaper for a supplier to flare superfluous gas or sell gas at negative prices than reducing production. However, in our framework we do not impose any constraints which would lead to such behavior (as for instance ramp constraints), and thereforehfntF1≠0,hfnF2≠0,andhntM2≠0never result in our model, even after relaxation.Third, we define the cost functions of the service providerscztZ(sztZ)such that sufficiency and necessity of the Karush–Kuhn–Tucker conditions is preserved. Hence,cztZ(sztZ)have to be convex and differentiable. In recent studies (Chyong & Hobbs, 2014; Gabriel et al., 2012; Moryadee, Gabriel, & Rehulka, 2014) we find that the cost functions are chosen affine, except for production for which a quadratic and a logarithmic term is added to represent the sharp increase in cost close to the capacity limit. (The quadratic and the logarithmic term are both convex.) We adopt these cost structures, except that we omit the logarithmic term in the production cost functions. This allows the problem to be represented as linear complementarity problem while maintaining strict convexity in the production cost function. The derivatives of our cost functions read(3.1)dcztZ′(sztZ′)dsztZ′=LINCztZ′,Z′∈Z∖{P}∀z,t,(3.2)dcntP(sntP)dsntP=LINCntP+QUACntPsntP(3.3)=LINCntP+QUACntPqfntP∀n,t,whereLINCztZandQUACztZare the linear and quadratic cost function terms for service Z located at node/arc z in period t. Note that the last equality holds because every trader has only one associated producer (Section 2.1).We state the full problem including all mentioned changes in Appendix B. After dividing the left-hand side of Eq. (B.1k) by the slope of the inverse demand curveSLPntC,the problem can be brought into the following form:(3.4a)Mx+b⪰0,(3.4b)x⪰0,(3.4c)xT(Mx+b)=0,(3.4d)M:=[D−ET−FT−GTE000F000G00H],x:=[qαϕλ],b:=[bqbαbϕbλ],whereM∈Rp×p,x∈Rp,andb∈Rp. As usual, ≽, ⪯, ≻, ≺ are interpreted component-wise. The components of x are defined as(3.5)q=[qPqIqXqAqBqC],α=[αZαZT],ϕ=[ϕNϕS],λ=[λC],where each sub-component of q, α, ϕ and λ is again a vector containing all variables of its respective type, for example the vector qPcontains all the produced volumesqfntPand is of appropriate dimension. The first block row of M and bqcorresponds to Eqs. (B.1a)–(B.1f) and contains the stationarity conditions of the traders’ optimization problems (with substituted service pricesλztZ).Eq+bαcorresponds to Eqs. (B.1i) and (B.1j), and consists of the primal feasibility constraints of the service providers’ problems (with substituted decision variablessztZ).Fq+bϕcorresponds to Eqs. (B.1g) and (B.1h), comprising the primal feasibility constraints of the traders’ problems.Gq+Hλ+bλcorresponds to the wholesale market clearing conditions contained in Eq. (B.1k). Note that the inverse demand functionsΛntC(·)have to be affine for all n and t to represent Model (2.19) by Eq. (3.4). Some of the sub-matrices of M and b have special properties: D is diagonal and positive semi-definite, E ≽ 0, G ⪯ 0, H is diagonal and positive definite, bq≽ 0, bα≻0,bϕ=0,and bλ≺0.According to Cottle, Pang, and Stone (1992, Theorem 3.1.2), a solution to Problem (3.4) exists if(i)M is positive semi-definite,a vector x exists satisfying Eqs. (3.4a) and (3.4b).Since(3.6)xTMx=[qαϕλ][DEFG−ET000−FT000−GT00H][qαϕλ](3.7)=qTDq+λTHλ,Condition (i) is satisfied if D and H are positive (semi-) definite, which is indeed the case.Condition (ii) is proven by construction. We begin withx0=0,and by exploiting the structure of M and b we subsequently alter the components of x until we find x satisfying Eqs. (3.4a) and (3.4b).x0 is not feasible, because−GTq0+Hλ0+bλ=bλ≺0. Therefore, we setλ1=−H−1bλ⇒λntC=SLPntC·INTntCSLPntC=INTntC≥0. Hence, the components of x1 are:q1=0,α1=0,ϕ1=0,λ1=INTC,where INTCis the vector containing the intercepts of the inverse demand curvesINTntCat the positions corresponding to the indices n, t of the wholesale prices λ ≡ λC.We now consider the first block-row of inequalities:Dq1+Eα1+Fϕ1+Gλ1+bq=G·INTC+bq¬⪰0,because we cannot guaranteebq⪰−G·INTC. We setϕ2N:=INTC(again, INTCis a vector containingINTntCat the corresponding indices), which gives usq2T=0,α2T=0,ϕ2N=INTC,ϕ2S=0,λ2=INTC.Since F has both positive and negative entries, we have Fϕ2 ⪯ 0 for some lines of the first block-row. Since E ≽ 0, and at least one entry on each conflicting line is greater than zero (this can be deduced from the Problem formulation (B.1)), we can compensate for Fϕ2 ⪯ 0 by setting the corresponding components of α sufficiently large:α3:=INTC⇒Eα⪰|−Fϕ2|. This leads to a feasible x3:q3=0,α3=INTC,ϕ3N=INTC,ϕ3S=0,λ3=INTC,which completes the proof of Condition (ii).As stated in Cottle et al. (1992, Theorem 3.3.7), Problem (3.4) attains a unique solution for all vectors b if and only if M is aP-matrix.33A matrix is aP-matrix if it has square form and all its principle minors are positive. This is the most general class of matrices for which the linear complementarity program (3.4) attains a unique solution for all vectors b. We refer to Cottle et al. (1992, Chapter 3.3) for an in-depth discussion onP-matrices.This is clearly not the case as some diagonal elementsMii=0independent of the parameter value choices. However, givenM+MTis diagonal, we can guarantee uniqueness of the solution x in component i if the corresponding element Mii> 0; see Appendix C for a proof. The converse is not necessarily true: ximay be unique even ifMii=0because the component is sufficiently constrained by M and b.Consequently, results are unique in at least the produced volume qP, the sold volumeqfntCif the corresponding market power parameterθfntC>0,and the wholesale price λC. Furthermore, from Eq. (2.18) and the properties of the inverse demand function (2.3)–(2.6), we can deduce that the total consumption in a node and time period∑f∈F(n)qfntCis unique. By combining these results, we can conclude that the total sales of perfectly competitive traders in a node and time period∑f∈{F(n)|θfnt=0}qfntCare unique, including the special case ofqfntCbeing unique independently of θfntif there is only one trader f in the market in node n and time period t. Finally, unique produced volumes qPimply that the sold volumeqfntCis unique if trader f only sells gas in one node and one time period.To determine uniqueness of xifor all i for specific instances of M and b we analyze the solution space of the problem: Since M is positive semi-definite, the solution spaceSis a convex polyhedron (Cottle et al., 1992, Theorems 3.1.7 and 3.1.8) of the form(3.8)S={x∈R+p:Mx+b⪰0,bT(x−x^)=0,(M+MT)(x−x^)=0},wherex^is an arbitrary solution. We have shown in Section 3.2 that a solutionx^always exists, hence the solution space can always be described byS.We are now interested in the extreme points ofS,particularly those attaining maximum or minimum values in (at least) one component: Letxi,+,xi,−∈Sbe vectors (extreme points) attaining the maximum and minimum values ofSin component i. Clearly, the solution to Problem (3.4) is unique in component i if and only ifxi,+=xi,−.To computexi,+andxi,−for all i for a specific M and b, we first calculate an arbitrary solutionx^by solving Problem (3.4). Second, we solve 2p Linear Programs of the form(3.9)minx∈S(ci,±)Tx,whereci,±∈Rpis ± 1 in component i and 0 in all other components.As noted in Section 1, lack of uniqueness may have profound implications for the interpretation of the solutions to Problem (3.4). These implications will be discussed in detail in Section 5, after we provide an example.In this section, we demonstrate the multiplicity of solutions via a numerical example. Based on the data sources listed in Appendix D, we set up Model (B.1) to replicate the global gas market in 2012. The model comprises 50 nodes and 291 arcs, distinguishes the summer and winter half-year, and covers 97 percent of the global gas production and consumption. We refrain to go into the details of the modeling and calibration process, as any parameters fulfilling the criteria listed in the previous sections would qualitatively lead to the same outcome and therefore the exact values of the parameters are not relevant for the demonstration of the solution properties. The reason for underlying the simulations with real data is merely to generate results which are in the order of magnitude typically seen in gas market analyses.We simulated two cases, a Base Case (BC) and a Counterfactual (CF), allowing for the comparison of (i) multiple solutions in one case, and (ii) the solution spaces of the two cases. In BC, we increased the market power parameterθfntCto 0.01 if the calibrated value was less than 0.01, while leaving allθfntC∈[0.01,1]at their calibrated values. This allowed testing whetherqfntCattains a unique result ifθfntC>0(Section 3.3), while avoiding conflicts with the solver’s tolerances44We used the standard settings of the Gurobi solver for Quadratic Programs (Version 5.6.3).on one hand, and keeping the impact on the underlying market behavior low on the other hand. In CF, we changed the traders’ market power parametersθfntC=0for all f, n, t. CF corresponds to the (hypothetical) situation of perfect competition among all traders in all markets and time periods which is often taken as benchmark in case studies. We followed the procedure described in Section 3.3 to determine the solution spaces of BC and CF. The results are shown in Tables 4.1and 4.2.Table 4.1 provides the maximum differences between all possible market equilibria in BC and CF, grouped by similar variables. We observe that the solution is unique in the produced volumes qP, the dual variables associated with the capacity constraints of the services α, the wholesale prices λC, the volume flows contracted by the service providers sZ, and the service prices λZ. However, the solution is not unique in the other volume flows (corresponding to the remaining components of q), and the dual variables associated with the volume balances of the traders ϕ. Compared to BC, the maximum differences in CF for the LNG volumes qBand sold volumes qCswitch from zero to non-zero, while all other components remain unique/non-unique. Also, in CF the maximum differences of the volumes q are larger. The maximum difference in ϕ is also shown for the sake of completeness, although this result is not of interest in interpretation.Table 4.2 compares the minimum and maximum values achieved,xi,−andxi,+,in BC and CF for selected components i. The examples show that the market equilibrium in CF can be higher or lower than in BC for the sold volumes qC. For the injected, extracted and piped volumes qI, qX, and qA, which are ambiguous in BC and CF, the examples demonstrate that the solution intervals overlap. Thus, in none of the presented examples a prediction of the market equilibrium is possible when moving from BC to CF.

@&#CONCLUSIONS@&#
In this paper we introduced a SPE-CV model for the natural gas market. We specified affine costs for the service providers, quadratic costs for gas production, and affine inverse demand, and hence represented our model as linear complementarity problem. We proved that a solution to the given problem always exists and derived criteria for uniqueness of the individual components. Finally, we presented a numerical example confirming our theoretical findings and illustrating the main difficulties for the interpretation of the results.Our findings indicate that most of the relevant variables for decision-making are unique in the presented model setting. However, one has to be particularly careful when drawing conclusions about the volume flows between the traders contract with the service providers, and the traders sell to the consumers if the traders do not exert market power, since in these cases the model allows multiple market equilibria for a fixed set of parameter values. The obtained set of solutionsSisolates the possible market equilibria, but which of the equilibria will materialize in practice cannot be predicted without further specifying the traders’ preferences.The situation is even more difficult when one tries to compare market equilibria computed under different sets of parameter values: different results for the above quantities may not be due exclusively to the different parameter values, but also to non-uniqueness of the solution for each set of parameter values. In the worst case, the direction of change of some variables is ambiguous, and therefore no trend can be predicted from the simulation results.Fortunately, we can guarantee uniqueness in the gas sales of individual traders to consumers qC, perhaps the most important non-unique variable in the model, by assuming that all traders exert at least some market power. Moreover, we showed that a trader exerting market power over a group of consumers is mathematically equivalent to a trader diversifying its consumers. Since most of the traders in the real world aim for some consumer diversification, we conclude that this is a practicable approach to enforce uniqueness in qC, and that the computed qCis sensible from an economic perspective.Sinceour findings are linked to the mathematical structure of the model, they are not limited to gas markets in particular. Instead, they apply to any other oligopolistic market which is representable by the introduced model formulation. In fact, the results also hold if the presented structure is part of a larger model, for instance one including multiple energy carriers as proposed by Huppmann and Egging (2014), and therefore may be useful in a large field of applications.