@&#MAIN-TITLE@&#
Relating the spectrum of cardiac signals to the spatiotemporal dynamics of cardiac sources

@&#HIGHLIGHTS@&#
We analyze the spectral manifestation of cardiac rhythms and the spectral effects of lead systems.We relate analytically cardiac spectrum, lead characteristics and cardiac rhythms.Lead systems can have distorting effects on the envelope of cardiac spectrum.Hence, spectral features that do not depend on the spectral envelope are robust.For correlated rhythms, an inverse relationship exists between bandwidth and spatial resolution.

@&#KEYPHRASES@&#
Cardiac spatiotemporal dynamics,Fibrillation,Spectral analysis,Dominant frequency,Lead systems,Measurement sensitivity distribution,

@&#ABSTRACT@&#
An increasing number of studies use the spectrum of cardiac signals for analyzing the spatiotemporal dynamics of complex cardiac arrhythmias. However, the relationship between the spectrum of cardiac signals and the spatiotemporal dynamics of the underlying cardiac sources remains to date unclear. In this paper, by following a multivariate signal analysis approach we identify the relationship between the spectrum of cardiac signals, the spatiotemporal dynamics of cardiac sources, and the measurement characteristics of the lead systems. Then, by using analytical methods and computer simulations we analyze the spectrum of cardiac signals measured by idealized lead systems during correlated and uncorrelated spatiotemporal dynamics. Our results show that lead systems can have distorting effects on the spectral envelope of cardiac signals, which depend on the spatial resolution of the lead systems and on the degree of spatiotemporal correlation of the underlying cardiac sources. In addition to this, our results indicate that the spectral features that do not depend on the spectral envelope behave robustly against different choices of lead systems.

@&#INTRODUCTION@&#
Fibrillation is a complex cardiac arrhythmia whose spatiotemporal characteristics remain poorly understood. Traditionally, fibrillation has been described as random and disorganized, since it induces highly irregular traces in the electrocardiogram (ECG) signal. However, with the application of nonlinear dynamics theory to the investigation of cardiac arrhythmias and the development of optical and electrical mapping techniques, it has been suggested that fibrillation can possess some degree of spatiotemporal regularity [1,2]. This view has led in a natural way to study fibrillation based on the spectrum of cardiac signals such as the ECG and intracardiac electrograms (EGM). Spectral features of cardiac signals have been proposed as experimental indices for detecting ventricular fibrillation (VF) [3], for quantifying the degree of spatiotemporal organization of atrial fibrillation (AF) [4] and for predicting the success of defibrillation shocks [5–7]. Also, intracardiac mapping techniques have been combined with dominant frequency (DF) analysis to study the spatiotemporal characteristics of fibrillation. This method, known as DF mapping, has revealed spatiotemporal regularities during AF in both animal models [8–10] and in patients [11,12] and it is currently regarded as a potential technique to guide AF ablation therapies [13].Despite the increasing number of studies that use spectral techniques to analyze fibrillation, the meaning of the spectrum of cardiac signals remains to date elusive. Even though individual spectral features of cardiac signals have been linked to spatiotemporal characteristics of cardiac rhythms [14–16], the relationship between the spectrum of cardiac signals and the spatiotemporal characteristics of cardiac rhythms has not been thoroughly investigated. In addition to this, the effects of lead systems on the spectrum of cardiac signals are not well understood, and consequently it is not clear how the spectra of cardiac signals measured by different lead systems relate to one another. The elucidation of the relationship between the spectra of cardiac signals measured by different lead systems is of technical and clinical interest in the context of fibrillation, since it would contribute to the development of novel, improved methods of DF cardiac mapping, such as non-contact intracardiac electrical mapping [17,18] and non-invasive surface ECG mapping [19].In this paper, we develop a mathematical formalism for investigating, in a systematic way, the spectral manifestation of different cardiac rhythms and the spectral effects of lead systems. By following a multivariate signal analysis approach, we identify the connection between the spectrum of cardiac signals and the spatiotemporal dynamics of the underlying cardiac rhythms. Our formalism allows us to derive theoretical results which are relevant for the analysis and interpretation of the spectrum of cardiac signals, and for devising spectral methods for investigating the spatiotemporal dynamics of cardiac rhythms.The organization of this paper is as follows. In Section 2 we develop our mathematical formalism and connect the spectrum of cardiac signals to the spatiotemporal dynamics of the underlying cardiac rhythms. Physiologically meaningful cases are studied analytically in Section 3, and in a computer simulation environment in Section 4. Finally, Section 5 contains the conclusions of our investigation and the discussion.In this section we present the mathematical formalism for investigating the spectrum of cardiac signals. Firstly, we introduce the lead-field bioelectric model of cardiac sources and signals. Then, we define the autocorrelation and the spectrum of cardiac sources. Finally, we identify the relationship between: the spectrum of cardiac signals, the spatiotemporal dynamics of cardiac sources and the measurement characteristics of lead systems.Throughout this paper the following notation is used: 〈·〉tdenotes time-average,F[·]is the Fourier Transform operator, (*) denotes convolution and δ(·) is the Dirac's delta. We use the following vector definitions: 1=[1, 1, 1]Tand 0=[0, 0, 0]T.Cardiac sources are the bioelectric processes generated by the heart during contraction. There exist different, equivalent mathematical paradigms to model the activity of cardiac sources, such as the monopole field and the dipole field [20]. In this study, we model cardiac sources as a time-varying dipole field, i.e. as a spatial distribution of time-varying dipolesJ(v,t)=[Jx(v,t),Jy(v,t),Jz(v,t)]Ton a volume V, wherevdenotes a point located inside V and t denotes the time instant.The time-varying activity of cardiac sources can be measured by lead systems, producing cardiac signals. Taking the dipole field as our reference description for cardiac sources, we follow a lead-field approach to model cardiac signals [20]. According to the lead-field theory, the cardiac signal c(t) that is induced at a lead system by a dipole fieldJ(v,t)can be expressed as(1)c(t)=∫VLT(v)J(v,t)dv,where the vector fieldL(v)=[Lx(v),Ly(v),Lz(v)]Tis the measurement sensitivity distribution (MSD) and describes the ability of the lead system to measure cardiac dipoles located atv∈V. In words, cardiac signals are a weighted linear combination of the underlying cardiac sources.The autocorrelation of a cardiac source,ρ(v,w,τ),∀v,w∈V, is defined as the collection of the cross-correlations between all pairs of dipoles in V. Since cardiac dipoles are vectorial entities, the cross-correlation between two dipoles consists of the cross-correlations between all three components of each dipole [21]. In order to define the autocorrelation of a cardiac source, the average dipole fieldJ¯(v)needs to be introduced:(2)J¯(v)=〈J(v,t)〉t=[〈Jx(v,t)〉t,〈Jy(v,t)〉t,〈Jz(v,t)〉t]T.Based onJ¯(v), we define the zero-average dipole fieldJ′(v,t)=J(v,t)−J¯(v), so that〈J′(v,t)〉t=0. The cross-correlation matrix between two cardiac dipolesJ(v,t)andJ(w,t), wherev,w∈V, is then defined as(3)ρ(v,w,τ)=〈J′(v,t+τ)J′T(w,t)〉t=ρxx(v,w,τ)ρxy(v,w,τ)ρxz(v,w,τ)ρyx(v,w,τ)ρyy(v,w,τ)ρyz(v,w,τ)ρzx(v,w,τ)ρzy(v,w,τ)ρzz(v,w,τ).Therefore, each entry ofρ(v,w,τ)contains the cross-correlation between one component ofJ(v,t)and one component ofJ(w,t). For instance, matrix entryρzy(v,w,τ)is〈Jz′(v,t+τ)Jy′(w,t)〉t. Also, the average power of dipole componentJx′(v,t)is by definitionPx(v)=ρxx(v,v,0), and analogous expressions can be obtained for the average power of dipole componentsJy′(v,t)andJz′(v,t).The spectrum of a cardiac source,σ(v,w,f),∀v,w∈V, corresponds to the collection of the cross-spectra between all pairs of dipoles in V, and is defined as(4)σ(v,w,f)=F[ρ(v,w,τ)]=σxx(v,w,f)σxy(v,w,f)σxz(v,w,f)σyx(v,w,f)σyy(v,w,f)σyz(v,w,f)σzx(v,w,f)σzy(v,w,f)σzz(v,w,f),where the operatorF[·]is applied toρ(v,w,τ)on a component-by-component basis. For instance,σzy(v,w,f)isF[ρzy(v,w,τ)].We also define the total cross-correlationRJ(v,w,τ)between two cardiac dipolesJ(v,t)andJ(w,t)as the sum of the entries ofρ(v,w,τ)and the total cross-spectrumSJ(v,w,f)as the Fourier Transform ofRJ(v,w,τ). Mathematically, they can be expressed as(5)RJ(v,w,τ)=1Tρ(v,w,τ)1,(6)SJ(v,w,f)=1Tσ(v,w,f)1.Finally, we define the normalized cross-correlationρˆ(v,w,τ)as the matrix of entries(7)ρˆab(v,w,τ)=ρab(v,w,τ)ρaa(v,v,0)ρbb(w,w,0)where a, b∈{x, y, z}, and the normalized total cross-correlationRˆJ(v,w,τ)as(8)RˆJ(v,w,τ)=RJ(v,w,τ)maxτ{RJ(v,w,τ)}.Let c(t) be a cardiac signal measured by applyingL(v)to a cardiac source of autocorrelationρ(v,w,τ)and spectrumσ(v,w,f)in V. Define c′(t) as the cardiac signal c(t) minus its time-average valuec¯=〈c(t)〉t,(9)c′(t)=c(t)−c¯.The autocorrelation function Rc(τ) of the cardiac signal c(t) is defined as the following average [21]:(10)Rc(τ)=〈c′(t+τ)c′(t)〉t,and its power spectrum Sc(f) is defined as the Fourier Transform of its autocorrelation function,(11)Sc(f)=F[Rc(τ)].Based on (1), the following relationships can be derived between Rc(τ) andρ(v,w,τ), and betwen Sc(f) andσ(v,w,f)(see Appendix A):(12)Rc(τ)=∫V×VLT(v)ρ(v,w,τ)L(w)dvdw,(13)Sc(f)=∫V×VLT(v)σ(v,w,f)L(w)dvdw.Eqs. (12) and (13) reflect the linear relationship between cardiac signals and sources [c.f. (1)], and can be used to gain insight into the nature of the autocorrelation and spectrum of cardiac signals. According to (13), two factors determine the spectrum of cardiac signals. The first factor is the spectrumσ(v,w,f)of cardiac sources. It is worth noting that this is the sole feature of the spatiotemporal dynamics of cardiac sources that manifests on the spectrum of cardiac signals. The second factor is the MSD of the lead system,L(v). SinceL(v)is specific for each lead system, (13) reveals that cardiac signals measured by different lead systems will in general have different spectra for the same underlying spatiotemporal dynamics.In this section we study analytically the spectral manifestation of two second-order models of cardiac sources, namely the fully correlated (FC) source and the fully uncorrelated (FU) source. The FC and FU models are physiologically meaningful and can be used to describe the dynamics of, respectively, highly organized and highly disorganized cardiac rhythms.We firstly define the autocorrelation and the spectrum of the following models of spatiotemporal dynamics: identically distributed (ID), FC and FU. The ID model is introduced for facilitating the comparison of the spectrum of cardiac signals measured during FC and FU dynamics. Secondly, we define a simple, idealized model of MSD, namely the pulse model. Because of its simplicity, the pulse model is used in the analytical derivations and in the simulation experiments throughout this study. Finally, we derive analytically the spectrum of cardiac signals measured by pulse MSD during FU and FC dynamics.We subsequently present the three second-order models of spatiotemporal dynamics that we use in this study, namely the ID, the FC and the FU models.In this model of spatiotemporal dynamics all cardiac dipoles have the same autocorrelation and spectrum,(14)ρ(v,v,τ)=ρ(τ),(15)σ(v,v,f)=σ(f).By substituting (14) and (15) respectively into (5) and (6), it can be proved that the total autocorrelation and total spectrum of all the dipoles are also identical,(16)RJ(v,v,τ)=RJ(τ)=1Tρ(τ)1,(17)SJ(v,v,f)=SJ(f)=1Tσ(f)1.Note that this model only describes the activity of cardiac dipoles individually, and does not specifyρ(v,w,τ)norσ(v,w,f)forv≠w.This model of spatiotemporal dynamics corresponds to highly regular rhythms, such as sinus rhythm, in which the activity of one dipoleJ(w,t)can be expressed as a delayed version of the activity of another dipoleJ(v,t),(18)J(w,t)=J(v,t−ζ(v,w)),whereζ(v,w)is defined as the time delay between the activities of dipolesJ(v,t)andJ(w,t). Based on (18), it can be proved (see Appendix B) that FC dynamics are also ID,ρ(v,v,τ)=ρ(τ)andσ(v,v,f)=σ(f)[cf. (14) and (15)], and that the autocorrelation and the spectrum of FC sources can be expressed as:(19)ρ(v,w,τ)=ρ(τ−ζ(v,w)),(20)σ(v,w,f)=σ(f)exp[−j2πfζ(v,w)].Consequently, FC sources are completely characterized by ρ(τ), σ(f) andζ(v,w).This model of spatiotemporal dynamics constitutes an idealization of highly irregular and disorganized rhythms, such as fibrillation, in which there is no second-order relationship between the temporal activity of any pair of cardiac dipoles. The autocorrelation and the spectrum of a FU source are defined as(21)ρ(v,w,τ)=ρ(v,v,τ)δ(v−w),(22)σ(v,w,τ)=σ(v,v,τ)δ(v−w).In words, the cross-correlation between two cardiac dipolesJ(w,t)andJ(v,t), wherev≠w, is null.In this section we define one simple, idealized model of MSD, namely the pulse model. The pulse model describes a lead system that measures with the same sensitivity every dipole within a region V0 of the volume source V, while rejecting the rest. Mathematically, this model is defined as(23)LV0(v)=1ifv∈V00otherwiseThe pulse model can be treated as an approximation of physical MSD that effectively concentrate their measurement in a region V0.For the subsequent analysis it is also convenient to quantify the spatial resolution (SR) of pulse leads. The SR can be defined as the region of the cardiac source that contributes the most to the measured signal. In this study we quantify the SR of pulse leads by introducing the notion of the lead equivalent volume (LEV), which is defined as the relative size of V0 to the size of V,(24)LEV=∫V0dv∫Vdv=MV0MV,whereMV0and MVare the sizes of V0 and V respectively. Thus, for local measurements the LEV is close to zero, whereas for global measurements where V0≃V, the LEV is close to one.We subsequently derive the spectrum of cardiac signals measured by pulse leads during FC dynamics. By substituting (23) and (20) into (13) and using (17), we can express the spectrum Sc(f) in terms of the total spectrum SJ(f) and the time-delayζ(v,w):(25)Sc(f)=∫V×VLV0T(v)σ(v,w,f)LV0(w)dvdw=∫V0×V01Tσ(f)exp[−j2πfζ(v,w)]1dvdw=1Tσ(f)1∫V0×V0exp[−j2πfζ(v,w)]dvdw=SJ(f)∫V0×V0exp[−j2πfζ(v,w)]dvdw.We can integrate (25) with respect to ζ by introducing the time-delay density function (TDDF) over V0,FV0(ζ). The TDDFFV0(ζ)describes the frequency that a time-delay ζ is observed between two dipoles in V0, and can be calculated as follows. Consider all the pairs of dipoles that reside in V0. Given a time delay ζ1, select all the pairs of dipoles whose activities are delayed by ζ1. Then, the quantityFV0(ζ1)corresponds to the density (fraction) of those pairs of dipoles, with respect to all the pairs of dipoles in V0. Based onFV0(ζ), we can express (25) as(26)Sc(f)=SJ(f)∫−∞∞exp[−j2πfζ]FV0(ζ)dζ=SJ(f)F[FV0(ζ)]=SJ(f)SV0(f).In words, the spectrum of cardiac signals during FC dynamics is a filtered version of the total spectrum of cardiac dipoles. In general, time delays ζ are expected to be short for small V0, i.e. for small LEV [c.f. (24)]. Hence, the smaller V0, the more concentratedFV0(ζ)around ζ=0 and the broaderSV0(f). Therefore, (26) reveals that cardiac signals from local measurements (small LEV) during FC dynamics have broad bandwidths, whereas cardiac signals from global measurements (large LEV) have narrow bandwidths. Eq. (26) is a natural result, since the integral in (1) averages delayed signals at different points within the effective measurement region V0. As a result, when the LEV is large the lead system acts as a low-pass filter. By contrast, when V0 is small little averaging is performed and the distortion introduced by the lead system is low.We now derive the spectrum of cardiac signals measured by pulse leads during FU dynamics. By substituting (22) and (23) into (13), and using (6), the spectrum can be written as(27)Sc(f)=∫V×VLV0T(v)σ(v,w,f)LV0(w)dvdw=∫V01Tσ(v,v,f)1dv=∫V0SJ(v,v,f)dv.In words, the spectrum of cardiac signals measured during FU dynamics is an average of the total spectra of the dipoles contained within V0. If the FU dynamics is also assumed to be ID (ID-FU), thenSJ(v,v,f)=SJ(f)[cf. (17)] and (27) reduces to(28)Sc(f)=∫V0SJ(f)dv=SJ(f)MV0Hence, except for a scaling factor (MV0), the spectrum of cardiac signals measured by pulse leads during ID-FU dynamics is identical to the total spectrum SJ(f).In this section we present the results obtained in a computer simulation environment, designed for investigating the spectral manifestation of cardiac rhythms and the spectral effects of lead systems. Firstly, we describe the following aspects of our simulation experiments: the cardiac source model, how we simulated FC and FU dynamics, and how we synthesized cardiac signals. Secondly, we use multivariate signal analysis to characterize the simulated FC and FU dynamics. Thirdly, we analyze the TDDF of the simulated FC dynamics and its relationship with the spectrum of measured cardiac signals. Finally, we analyze the effects of different pulse leads on the spectrum of cardiac signals during FC and FU simulated dynamics.Cardiac activity was modeled by following a probabilistic cellular automata approach proposed in [22] which allows simulating complex spatiotemporal dynamics such as fibrillatory conduction and rotors. Based on this model, a 2D homogeneous sample of cardiac tissue consisting of 101×101 cells was defined and two types of spatiotemporal dynamics were simulated. The first type of dynamics was generated by periodically stimulating one side of the tissue sample at a rate of 1Hz. This resulted in a FC dynamics consisting of a regular train of plane excitation waves traveling along the x axis (Fig. 1 (a)). The second type of dynamics was generated by simulating a two pulse S1–S2 stimulation protocol on a sample of cardiac tissue with short action potential duration and conduction velocity values. This resulted in a short-lived spiral pattern whose arms quickly fragmented and degenerated into multiple excitation wavelets, traveling randomly in every direction (Fig. 1 (b)). This simulated activity constituted our computer model of FU dynamics. In both FC and FU dynamics the total simulation time was set to T=20s and the time step to Δt=0.002s.By computing the voltage difference between neighboring cells, a 2D time-varying distribution of cardiac dipolesJ(v,t)=[Jx(v,t),Jy(v,t)]Twas simulated. The amplitude of the simulated cardiac dipoles was highest at the wavefronts, where the voltage gradient is largest, and their direction was as expected aligned with the direction of propagation of excitation waves. In order to synthesize cardiac signals, eight square pulse MSD An, 1≤n≤8, of increasing size and centered at the middle of the tissue sample were implemented. Table 1 shows the LEV of each pulse MSD and Fig. 2(b) depicts for illustrative purposes pulses A5 and A8. Finally, a set of cardiac signals cn(t) were synthesized by applying each pulse Anto the simulated time-varying dipole distributions.In order to analyze the spatiotemporal characteristics of both simulated dynamics, we obtained the average power of each dipole component, together with the normalized cross-correlation [c.f (7)] and the normalized total cross-correlation [c.f (8)] between every pair of dipoles.In this dynamics, the normalized autocorrelation and total autocorrelation were found to be approximately the same for every cardiac dipole,ρˆ(v,v,τ)≃ρˆ(τ)andRˆJ(v,v,τ)≃RˆJ(τ). Accordingly, the dynamics were classified as ID [c.f. (14) and (16)]. Also, the average powerPx(v)was found to be twice as high asPy(v). This observation is in agreement with the fact that most of the dipoles were aligned with the direction of propagation of the excitation waves, namely the x axis.Fig. 1(c) shows the normalized cross-correlations between the x and y components of dipolev1, and dipolesv1(itself),v2andv3. As expected,ρˆxx(v1,v1,τ)revealed a high degree of periodicity, which could be approximated by a regular train of impulses of period 1s. This resulted in a local activation rate across the tissue sample of 1Hz, which agrees with the simulated stimulation rate. By contrast,ρˆyy(v1,v1,τ)showed a lower degree of periodicity, sinceJy(v,t)components were activated in a more sporadical manner. The normalized cross-correlationsρˆxx(v1,v2,τ)andρˆxx(v1,v3,τ)also consisted of a regular train of impulses of period 1s and additionally, their maximum values occurred at τ=0.004s and τ=0.048s respectively. These delays corresponded to the traveling times of the excitation waves fromv1tov2and fromv1tov3, respectively. Thus,ρˆxx(v1,v2,τ)≃ρˆxx(v1,v1,τ−0.004)≃ρˆxx(τ−0.004)andρˆxx(v1,v3,τ)≃ρˆxx(v1,v1,τ−0.048)≃ρˆxx(τ−0.048). In general, the maximum value of the cross-correlation between any two dipoles occurred at a time delay ζ that corresponded to the traveling time of the excitation wave from one dipole to the other, and alsoρˆxx(v,w,τ)≃ρˆxx(v,v,τ−ζ)=ρˆxx(τ−ζ). This observation confirmed that this simulated dynamics followed a FC model [c.f. (19)]. Finally, we observed thatRˆJ(τ)also exhibited a high degree of periodicity (Fig. 1 (e)), which was mostly due to the highly periodic activity ofρˆxx(v1,v1,τ). Accordingly, SJ(f) consisted of a sequence of harmonic frequencies separated by 1Hz (Fig. 2(c)).In this dynamics, all the dipoles shared approximately the same normalized autocorrelation and total autocorrelation,ρˆ(v,v,τ)≃ρˆ(τ)andRˆJ(v,v,τ)≃RˆJ(τ). Thus, this dynamics could be classified as ID [c.f. (14) and (16)]. Furthermore,ρˆ(τ)andRˆJ(τ)could be approximated by a single impulse located at τ=0, as illustrated in Fig. 1 (d) and (f), and the measured local activation rate across the tissue sample was 15.6±3.3Hz. As opposed to the FC dynamics,Px(v)andPy(v)were approximately the same. This observation is in agreement with the fragmented and random nature of this simulated dynamics, in which dipoles were oriented with equal probability in every direction.The cross-correlation between dipoles decreased rapidly with the distance that separated them. Fig. 1(d) shows thatρˆyy(v1,v2,τ)consisted of a small but distinct spike, whereasρˆxx(v1,v3,τ)andρˆyy(v1,v3,τ)were practically zero. In other words, this dynamics exhibited highly localized spatiotemporal correlations. Accordingly, although this dynamics was approximately FU, it could be more accurately described as partially correlated (PC). We estimated the region whose dipoles showed a high degree of correlation with the dipole atv1, and found it corresponded approximately to the region covered by pulse A1. Interestingly,ρˆxx(v1,v2,τ)≃0, and the maximum ofρˆyy(v1,v2,τ)occurred at τ=0, as seen in Fig. 1(d). In words, only the y components of dipoles atv1andv2were correlated and they showed frequent simultaneous activities. The explanation for this observation is the following. Dipoles atv1andv2shared the same x coordinate and they were simultaneously activated whenever local excitation wavefronts traveled along the y direction, which favored the generation of y dipole components. As a consequence, the y components of cardiac dipoles atv1andv2were often activated simultaneously and hence,ρˆyy(v1,v2,τ)showed its maximum at τ=0.Following (26), the spectrum of cardiac signals measured by pulse MSD during FC dynamics can be expressed as the product of the total spectrum by the Fourier Transform of the TDDF. We used our simulations to compare the spectrum of synthesized cardiac signals during FC dynamics,Scn(f), and the spectrum predicted by (26). Firstly, we estimated spectraScn(f)by applying to cn(t) Welch's method [23], with a 2048-samples Hamming window and 50% overlap. The number of FFT points coincided with the length of the Hamming window. This configuration resulted in a high spectral resolution suitable to identifying the harmonic structure of cn(t). We subsequently built the time-delay functionζAn(v,w)for each An, by computing the difference between the excitation times of each pair of cells within An. Then, we obtained the TDDFFAn(ζ)fromζAn(v,w), and we calculated its Fourier Transform,SAn(f). Finally, we obtained the spectrum predicted by (26) by estimating the total spectrum of a single dipole SJ(f) and multiplying it bySAn(f). In all cases, the spectrum obtained by virtue of (26) matched the spectrum of synthesized cardiac signals.We illustrate these results with pulse MSD A5 and A8. Fig. 2 (a) shows, on an isochronal map of cell excitations, the regions covered by A5 and A8. The excitation times of four isochrones are also indicated, namely t=0.01, 0.05, 0.07 and 0.11s. According to this map, the earliest excitation time in pulse A5 (A8) was te=0.05s (te=0.01s), whereas the latest excitation time was tl=0.07s (tl=0.11s). Thus, the maximum time delay between excitations in pulse A5 (A8) was ζmax=tl−te=0.02s (ζmax=tl−te=0.1s). Also, since the time delay function satisfiesζ(v,w)=−ζ(w,v), the minimum time delay in A5 (A8) was ζmin=−0.02s (ζmax=−0.1s) and thus, the possible values of time delays within A5 (A8) lied in the range |ζ|≤0.02s (|ζ|≤0.1s).The generated TDDF,FA5(ζ)andFA8(ζ), are shown in Fig. 2(b). Because of the propertyζ(v,w)=−ζ(w,v), they were symmetric around zero. In addition to this, they exhibited a triangular shape andFA5(ζ)=0(FA8(ζ)=0) for time delays |ζ|≥0.02s (|ζ|≥0.1s). In all cases, we found thatFAn(ζ)had a triangular shape, which is a consequence of the constant speed of the excitation wave. We also observed that the smaller An, the narrowerFAn(ζ), since the maximum difference of time delays was also smaller. Accordingly, the Fourier Transform of the TDDFSAn(f)had a square-sinc shape and the smaller Anthe broaderSAn(f). As illustrated in Fig. 2(c), SJ(f),Sc5(f)andSc8(f)shared the same harmonic structure, which consisted of harmonic frequencies located at multiples of 1Hz. This is in agreement with the fundamental periodicity imposed by the simulated stimulation rate. Fig. 2 (c) also shows that the envelopes ofSc8(f)andSc5(f)conformed respectively toSA8(f)andSA5(f).According to (26) and (28), the spectral effects of pulse MSD are qualitatively different during FC and ID-FU dynamics. During the former, the spectrum of cardiac signals can be expressed as a filtered version of the total spectrum of a single dipole, whereas during the latter it is identical. Hence, during FC dynamics the spectral envelope of cardiac signals is affected, whereas during FU dynamics it remains unchanged.In order to explore our analytical results, we compared the spectra obtained from each pulse MSD during the simulated FC and FU dynamics. We analyzed the bandwidth of the spectrum of simulated cardiac signals to quantify differences in the spectral envelope, and extracted three spectral features, namely the peak frequency (PF), the fundamental frequency (FF) and the DF, to assess whether they were affected by the characteristics of the lead system. We defined the bandwidth as the 95% power bandwidth (BW) of the spectrum, which was estimated by using Welch's method with a 512-samples Hamming window and 50% overlap. The number of FFT points was set to 512. This configuration presented a low spectral resolution which was suitable to study the spectral envelope. As for the PF, the FF and the DF, they were extracted from a spectral estimation that used Welch's method with a 2048 Hamming window as described in Section 4.3. This configuration presented a higher spectral resolution which allowed us to study finer spectral details such as the harmonic structure of cardiac signals. The PF, the FF and the DF were defined as follows. The PF was defined as the frequency where the maximum of the power spectrum occurs. The FF corresponded to the separation between consecutive harmonic frequencies. Since simulated signals from FU dynamics did not show a harmonic structure, the FF was only extracted from simulated cardiac signals during FC dynamics. Finally, The DF was obtained by using a widely-used non-linear method proposed by Botteron and Smith [24]. The results are summarized in Table 1.During FC dynamics, we observed that as the size of the pulse MSD increased, the BW of synthesized cardiac signals decreased accordingly. As shown in Figs. 2(c) and 3(a) (a), the larger the region covered by the pulse MSD, the higher the concentration of power at low frequencies. This behavior is summarized in Table 1, which shows that during FC dynamics, the larger the LEV, the narrower the BW. By contrast, during FU dynamics the spectrum remained approximately unchanged across the different leads, except for the smallest pulses, A1 and A2 (Fig. 3(b)). Accordingly, the BW remained approximately unchanged and discrepancies were only observed for the smallest LEV (Table 1). The changes in the spectrum of cardiac signals synthesized by pulse MSD with small LEV during FU dynamics could be ascribed to the previously identified, localized spatiotemporal correlations [c.f. Section 4.2.2]. Within small regions of the cardiac source, it could no longer be assumed that the activities of the dipoles were uncorrelated and hence, signals measured by pulse MSD whose LEV was small enough, would exhibit a spectrum dependency on the LEV characteristic of correlated sources. In our simulations, the estimated volume of correlation during FU dynamics was close to A1 and so, the effects of local correlations manifested more clearly in A1 and A2.The dependence of the PF with the LEV was similar to dependence observed for the BW. In the case of FC dynamics, the PF decreased as the LEV of the corresponding pulse MSD increased. In the case of FU dynamics, it remained approximately unchanged for large LEV. This dependence with the LEV could be expected from the fact that the PF is determined by the spectral envelope. The FF and the DF had similar values during FC dynamics, specifically 1Hz. This value corresponded to the simulated stimulation rate and to the local activation rate across the tissue sample. It is worth noting that the PF obtained from each simulated cardiac signal during FC dynamics corresponded to a multiple frequency of the FF, i.e. to a harmonic frequency. The values of DF during FU dynamics remained approximately constant across different LEV values. Interestingly its value was similar to the PF values obtained from large LEV and to the average local activation time across the tissue sample.In this paper we have presented a mathematical formalism for investigating the spectrum of cardiac signals. Our formalism reveals that the spectrum of cardiac signals can be expressed in terms of the spectrum of the underlying cardiac source and the MSD of the lead system [c.f. (13)]. Two main conclusions can be drawn from (13). Firstly, the information contained in the spectrum of cardiac signals is limited to the second-order characteristics of cardiac sources. And secondly, for the same underlying spatiotemporal dynamics, different lead systems will, in general, produce cardiac signals with different spectra. Although the distortion introduced by the lead system follows in a natural way from the linearity of the measurement (1), to the best of our knowledge this has not been formulated before.To gain understanding of the spectrum of cardiac signals, we have further analyzed (13) for specific models of MSD and cardiac sources. Our analytical results show that the spectral effects of pulse lead systems is qualitatively different during FC and ID-FU dynamics. During FC dynamics the spectrum of cardiac signals depends on the lead SR, which we quantified with the LEV [c.f. (26)]. Specifically, the spectral envelope of cardiac signals from local measurements (small LEV) is broad, whereas the spectral envelope from global measurements (large LEV) is narrow. By contrast, during FU dynamics the spectrum of cardiac signals is a volume average [c.f. (27)] and hence, during ID-FU dynamics it remains the same irrespective of the LEV [c.f. (28)].We have further explored the spectral manifestation of FC and FU dynamics in a simulation environment and our simulation results are in agreement with the analytical ones. Specifically, spectral features which depend on the spectral envelope, namely the PF and the BW, were affected by the characteristics of the lead system, whereas those features that depend on the harmonic separation, namely the FF, were insensitive to the characteristics of the lead system. In our simulations the DF also showed a robust behavior. In the case of FC dynamics, our simulations showed identical values for the FF and for the DF.Based on our simulation experiments, we could also explore the spectral manifestation of PC sources. In the analysis of the spatiotemporal characteristics of simulated FU dynamics, we observed localized spatiotemporal correlations which allowed us to more accurately describe the simulated dynamics as PC. Also, when analyzing the spectrum of cardiac signals synthesized from this dynamics, we observed spectral distortions for small LEV. These observations could be explained as follows. For large LEV, lead systems measure uncorrelated dipoles, and no spectral distortions are observed. However, for small LEV lead systems focus within regions where the dipoles are in fact correlated and accordingly, some distortions on the spectrum of cardiac signals are expected. Our observations encourage us to speculate that in general, irrespective of the type of MSD, the lead SR is a major factor in determining the spectrum of cardiac signals. We have derived analytically this result for idealized pulse MSD during FC and FU dynamics, but not for generic MSD nor for PC dynamics. We can speculate that in those scenarios where the LEV is larger than the volume of correlation, PC dynamics can be treated as FU, whereas whenever the LEV is within the volume of correlation, PC dynamics can be treated as FC. Nevertheless it remains to further study the spectrum of cardiac signals for generic lead systems and generic spatiotemporal dynamics. The formalism that we have presented constitutes a convenient mathematical framework for investigating the spectrum of cardiac signals measured during generic spatiotemporal dynamics. Within our formalism, a meaningful definition of the degree of spatiotemporal correlation and the volume of correlation could be proposed, and by using (13) its effects on the spectrum of cardiac signals could be thoroughly investigated.Our analysis could support, from a theoretical standpoint, recent experimental studies in which the robustness of spectral features of cardiac signals was assessed. In [25] it was reported that the values of the DF obtained from unipolar and bipolar cardiac signals correlate highly with the DF values obtained from optical signals. Other studies have compared the DF values obtained from cardiac signals measured by contact and non-contact intracardiac mapping systems, and have found good agreement between the DF values obtained from each mapping system [17,18]. A high correlation between DF values from intracardiac EGM and surface ECG signals was found in [26,27]. Finally, in [28] the PF, the DF, the median frequency (MF) and one organization index (OI) were extracted from unipolar and bipolar intracardiac leads, and it was found that spectral features depending on the spectral envelope (namely the PF, the MF and the OI) were affected by the choice of lead system, whereas the DF remained unaffected. In summary, these experimental studies are in agreement with our theoretical results.A deeper understanding of the nature of the spectrum of cardiac signals would pave the ground for developing novel spectral techniques for diagnosing and managing cardiac arrhythmias. For instance, non-contact, intracardiac DF mapping systems [17,18] and non-invasive, surface DF mapping systems [29] have been used for analyzing atrial fibrillation. These systems present some benefits over intracardiac sequential DF mapping, although the relationship between the DF maps produced by each system remains to date unclear. By using our formalism, the relationship between DF maps could be analyzed and potential spectral distortions could be evaluated and corrected.

@&#CONCLUSIONS@&#
