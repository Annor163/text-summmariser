@&#MAIN-TITLE@&#
A new rule for source connection problems

@&#HIGHLIGHTS@&#
The source connection problems are defined.A group of agents need a service that could be only provided by a source.A rule that shares the cost of the tree connecting agents to the source is defined.An axiomatic characterization of the rule is provided.

@&#KEYPHRASES@&#
Game theory,Cost sharing,Source connection problems,Painting rule,Axiomatization,

@&#ABSTRACT@&#
In this paper we study situations where a group of agents require a service that can only be provided from a source, the so-called source connection problems. These problems contain the standard fixed tree, the classical minimum spanning tree and some other related problems such as the k-hop, the degree constrained and the generalized minimum spanning tree problems among others. Our goal is to divide the cost of a network among the agents. To this end, we introduce a rule which will be referred to as a painting rule because it can be interpreted by means of a story about painting. Some meaningful properties in this context and a characterization of the rule are provided.

@&#INTRODUCTION@&#
Situations in which a set of individuals should be connected to a source that provides a particular service are common in many fields, including telecommunications, water supply, etc. There are two approaches frequently associated with these problems. The first approach relates to how to build a network connecting all individuals to the source in order to fulfill a number of requirements that may be varied in nature, such as technical or economic. The second tackles the problem of how the total cost of the network should be divided between individuals. In this second approach, it seems reasonable that the distribution of costs among individuals who are connected to the source should be made somehow taking into account the network finally built. With this in mind, in the present paper we introduce and analyze a new rule for cost sharing for a wide range of source connection problems. In our model, in addition to considering the set of agents, the source and the cost matrix, we include a tree t, connecting all agents to the source. Let us draw attention to some well-known problems that fit into our general setting:The classical minimum cost spanning tree problem. In this case t is a tree with minimal cost, computed for instance, with the algorithms of Kruskal (1956) or Prim (1957). Bird (1976), Granot and Huberman (1981), Bergantiños and Vidal-Puga (2007a), Sánchez-Soriano et al. (2010), among others, have studied the problem of how to divide the cost among the agents.The generalized minimum spanning tree problem was introduced by Myung et al. (1995) where it is proved that it is NP hard. Given a graph whose nodes are partitioned into several clusters, it consists of finding a minimum cost tree with exactly one node from each cluster when the arcs are defined only between nodes which belong to different clusters. Pop et al. (2006) and Pop et al. (2011) present different procedures to find solutions within this class of problems. To the best of our knowledge, in this case how to share the cost of the tree among the agents has not been tackled up until the present time.In the k-hop problem t is a tree where the number of arcs from the source to any agent cannot be more than a given constant k. In this class, the computation of a tree with minimal cost is NP hard, see Gouveia (1995) and Althaus et al. (2005). In fact, withk=2it includes a particular facility location problem when the facilities coincide with the agents, opening a facility at location of agent i is associated with the inclusion of arc(0,i)in the tree (in this case agent i is assigned to that same facility and no additional cost is involved) and agent j is served by facility i when the arc(i,j)belongs to the tree. The problem of sharing the cost of the k-hop tree among the agents has only been studied in Bergantiños et al. (2012).A degree-constrained spanning tree is a spanning tree where the maximum node degree is limited to a certain number k. In this case, t is a tree where the number of adjacent arcs to any node cannot be more than k. While the unconstrained minimum spanning tree problem can be solved in polynomial time, this problem is NP hard, cf. Garey and Johnson (1979). In Narula and Ho (1980) three procedures to construct such a tree are proposed. As far as we know, the problem of sharing the cost of the tree among the agents has not yet been studied.Standard fixed tree networks are studied by Granot et al. (1996). In this type of problems the unique tree is t. Granot et al. (1996), Maschler et al. (2010), Koster et al. (2001), and among others, give attention to the problem of sharing the cost in these situations.In all the above-mentioned problems, a tree to be constructed is finally selected. In our model we assume that the tree to be constructed is selected among those satisfying certain conditions or constraints, but without modeling how to do it. The tree constructed could be the cheapest one, but not necessarily (the problem could be NP hard). Therefore our model lies somewhere in between the fixed tree model (when alternative trees are not taken into account) and other models like the minimum cost spanning tree problem where the selected tree depends directly on the cost matrix and it is always the cheapest one.In Bergantiños et al. (2012) a rule for dividing the cost of a tree among the agents in the k-hop minimum cost spanning tree is proposed. This rule, even it satisfies some nice properties, does not depend on the structure of the tree constructed, only on the total cost of the tree. It seems reasonable that the way of distributing the cost of building this tree, should be related to the structure of the tree itself. In this paper we propose a rule for dividing the cost of a tree among the agents in a general setting. Our rule is based on a painting story, like some other rules for fixed tree problems.Besides, we present an axiomatic characterization of the rule using the next properties: isolated agents, cost monotonicity, equal treatment inside(C,t)-components and cone-wise additivity. An agent is isolated when he is very far (in terms of cost) from the other agents in such a way that there are not savings if this agent connects to the source through the others and viceversa. Isolated agents must pay his connection cost to the source. Cost monotonicity says that, if the tree to be constructed does not change, thus the rule should be monotonic on the cost matrix C. Equal treatment inside(C,t)-components says that agents that are connected through a path of cost 0 in t, must pay the same. Cone-wise additivity says that the rule should be additive in cones.The cost monotonicity property has some implications to be highlighted. This property could be considered as a solidarity property because it says that if some cost increases or decreases, all agents should be affected in the same way (nobody should pay less when the cost increases and nobody should pay more when the cost decreases). Besides, it implies that the cost shares will only depend on the tree finally built. This fact makes the solution easier to compute but has some drawbacks, for example, the no consideration of the cost of the links outside the tree constructed means that we ignore much of the information and hence we lose interesting information about the negotiation power or threats of agents involved. Then, this property is more adequate when there is a central authority deciding the cost shares of the agents than when the agents should decide the cost shares through a bargaining procedure among themselves.Finally, we think that our approach is suitable in a broad context, which includes as particular cases, the generalized minimum cost spanning tree problem, the k-hop problem and the degree-constrained spanning tree problem.The rest of the paper is organized as follows. In Section 2 we recall some basic notions for the source connection problems and introduce our model. Section 3 is devoted to the introduction of the new rule. In Section 4 we present some meaningful properties and provide a characterization of our rule, which coincides with the folk rule in the classical minimum cost spanning tree problem. Thus, a new characterization of the folk rule is obtained, together with an easy way of calculating it. Section 5 concludes.In this section we introduce the model we are interested in and the notation used throughout the paper.LetN={1,2,…}be the set of all possible agents (nodes). Consider a setN⊂Nof agents who are interested to be connected to a source, denoted by 0, in order to obtain a certain service. LetN0=N∪{0}andN={1,…,|N|}, where|N|denotes the number of elements of the set N.A network g overN0is a subset of{(i,j):i,j∈N0}and its elements are calledarcs. Given a network g and a pair of different nodes i and j, a path from i to j(in g) is a sequence of different arcs{(is-1,is)}s=1pthat satisfy(is-1,is)∈gfor alls∈{1,2,…,p},i=i0andj=ip. It is said thati,j∈Nare connected (in g) if there is a path from i to j.S⊂N0is connected (ing) if each pair of agentsi,j∈Sare connected ingS={(i,j)∈g:i,j∈S}.A tree, t is a network where for each pair of nodesi,j∈N0there is a unique path in t from i to j. We denote the set of all networks overN0asGNand the set of all trees asTN. Given a tree t,the predecessor set of a node i in t isPre(i,t)={j∈N0:jis in the unique path from i to the source }. We assume thati∉Pre(i,t)and0∈Pre(i,t)wheni≠0. For notational convenience,Pre(0,t)=∅. The immediate predecessor of node i in t, denoted asi0, is the node that comes immediately before i in the unique path from 0 to i, that is,Pre(i,t)={i0}∪Pre(i0,t). Following this definition, we usually writet={(i0,i)}i∈N.A cost matrixC=(cij)i,j∈N0inN0represents the cost of each arc between any pair of nodes. We assume thatcij=cji⩾0for alli,j∈N0and thatcii=0for alli∈N0. We denote the set of all cost matrices overN0asCN. GivenC,C′∈CNwe say thatC⩽C′ifcij⩽cij′for alli,j∈N0.A cost matrix C is simple ifcij∈{0,x}withx∈R+for alli,j∈N0. From Theorem 1 in Norde et al. (2004), for each cost matrix C there is a family{Cr}r=1αof simple matrices satisfying three conditions:1.C=∑r=1αCr.For eachr∈{1,…,α}there is a networkgrsuch thatcijr=xrif(i,j)∈grandcijr=0otherwise.There isσ:{(i,j)}i,j∈N0,i<j→{1,2,….,|N|(|N|+1)2}such that ifi,j,k,l∈Nwithi<j,k<l, andσ(i,j)⩽σ(k,l), thencij⩽cklandcijr⩽cklrfor allr∈{1,…,α}.Given a pair(N0,C)andg∈GN, we define the cost associated with g asc(N0,C,g)=m(i,j)∈gcij.When there is no ambiguity, we will writec(g)orc(C,g)instead ofc(N0,C,g).Our goal is to connect all agents to the source, directly or indirectly, through a tree which fulfills certain conditions. Let T denote the set of all trees inTNwith these conditions. The objective is, first, to select a tree t in T and, then, to divide the cost among the agents. We should select a tree t in T with minimal cost. Depending on the set T this tree t could be exactly computed or approximated (cf. Gupta and Könemann (2011) for a survey on approximation algorithms for network design).Formally a source connection problem, scp, is a triple(N0,C,t), where N is the set of agents, 0 is the source, C is the cost matrix andt∈Tis the tree connecting all agents to the source to be constructed.A rule for source connection problems is a mapping f associating with each problem(N0,C,t)a vectorf(N0,C,t)∈RNsatisfying that∑i∈Nfi(N0,C,t)=c(t).Given an scp, once a tree to be constructed is selected, a rule specifies the way in which the cost of the tree is shared among the agents. The problem of selecting the tree t which minimizes the cost has been widely studied in the literature. In this paper we focus on the second part: How to divide the cost of t among the agents.In order to simplify the notation for the rest of the paper, we will usually denote an scp as a pair(C,t)where C is the matrix cost andt∈Tis the tree to be constructed. We avoid the explicit reference toN0because it will always be fixed.In this section we introduce a rule for this class of problems by means of a story about painting. One advantage of using this approach is that it provides a very intuitive interpretation of the cost shares. The same ideas can be found, for instance, in Maschler et al. (2010) and Koster et al. (2001) for a different kind of problems and rules.Let t be the tree that is to be built. We define a rule for sharing the cost of t among the agents through a multi-stage procedure. Firstly, we explain this in an intuitive way. Later, we compute it in a graphical example. Finally, the formal definition is provided and the exact calculations for the example are given.In order to illustrate the procedure used to obtain the rule, assume that the nodes represent the houses of the different agents and the arcs are the canals which connect them to an irrigation point. These canals need painting and there is only one machine to do this for each one. The machines cannot be moved to another canal and all of them work at the same speed. At every stage, each agent is assigned to an arc while the path from his house to the source has not been completely painted. The canals in t have painters assigned to them if the painting has not been completed. In each step, the agents assigned to an arc which is not completely painted share equally the time the painting machine is in operation. This can be read as their paying the same cost in that segment. At stage 1, each agent is assigned to the first arc in the unique path in t from his house to the source. At stage s, each agent is assigned to the first unpaid arc in this unique path. If all arcs in such a path have already been paid for in the previous stages, then this agent has finished his job. The procedure ends when all arcs have been paid for completely.Example 1Consider the source connection problem with four agents, where the tree t to be built is depicted in the following picture:Stage 1, the black dotted lines:AgentsArc assignedCost paid1(0,1)22(0,2)23(2,3)24(3,4)2Then(3,4)is already paid.Stage 2, the black lines:AgentsArc assignedCost paid1(0,1)22(0,2)23(2,3)14(2,3)1Notice that(2,3)is fully paid.Stage 3, the grey lines:AgentsArc assignedCost paid10,1320,2130,2140,21In this case the arc(0,2)is completely paid. Now agents 2, 3, and 4 are already connected to the source through the path{(0,2),(2,3),(3,4)}, which has already been paid. Thus, they do not have to pay more.Stage 4, the grey dotted line:AgentsArc assignedCost paid1(0,1)12∅03∅04∅0Then, each agent pays:AgentsAmount paid12+2+3+1=822+2+1+0=532+1+1+0=442+1+1+0=4Now, we formally present this procedure.Stage 0. Consider:•ai0(C,t)=∅for alli∈N. In general,ais(C,t)denotes the arc of t assigned to agent i at stage s. Agent i will pay part of the cost of this arc.c0(C,t)=0andcs(C,t)represents the part of the cost of each arc that it is paid at stage s.A0(C,t)=twithAs(C,t)equal to the set of unpaid arcs at stage s.pi0(C,t)=0, for alli∈N, andpis(C,t)is the cost that agent i pays at stage s.When no confusion arises we will writeaisorais(C)instead ofais(C,t). We will do the same withcs(C,t),As(C,t), andpis(C,t).Assume that stage r is defined, for allr⩽s-1.Stage s.•For eachi∈N, letaisbe the first arc in the unique path in t from i to 0 belonging toAs-1. If all arcs in such path are not inAs-1, takeais=∅.For all(i,j)∈As-1, defineNijs=k∈N:aks=(i,j)andcs=mincij-∑r=0s-1cr:(i,j)∈As-1.Denote byAs=(i,j)∈As-1:∑r=0scr<cij.For eachi∈N, define(1)pis=csNaissifais≠∅0otherwise.Some comments related to the previous procedure:1.Lett={(i0,i)}i∈N. Then,ai1=(i0,i)for eachi∈N.For each stage s and every(i,j)∈As-1, we have thatNijs≠∅(becauseNijs-1⊂Nijs).At each stages,cisjs=∑r=0scrfor at least some arc(is,js)∈As-1.This procedure ends whenAs=∅. SinceA0=t,As⊂As-1, andAs≠As-1the procedure finishes in a finite number of stages (at most|N|), denoted byγ(C,t)(γ(C)orγwhen no confusion arises).For each scp(C,t)and eachi∈N, the painting rule P isPi(C,t)=∑s=1γpis,wherepisis defined as in (1).We formally compute the painting rule in Example 1. Let(C,t)be such thatN={1,2,3,4},t={(0,1),(0,2),(2,3),(3,4)},c01=8,c02=7,c23=4,c34=2, andcij=100otherwise.Stage 1: The black dotted part in the picture.•a11=(0,1),a21=(0,2),a31=(2,3), anda41=(3,4).N011={1},N021={2},N231={3}, andN341={4}. Then,c1=minc01,c02,c23,c34=min{8,7,4,2}=2.A1={(0,1),(0,2),(2,3)}pi1=2for alli∈N.Stage 2: The black part in the picture.•a12=(0,1),a22=(0,2),a32=(2,3), anda42=(2,3).N012={1},N022={2}andN232={3,4}. Then,c2=minc01-c1,c02-c1,c23-c1=min{8-2,7-2,4-2}=2.A2={(0,1),(0,2)}.p12=2;p22=2; andp32=p42=22=1.Stage 3: The grey part in the picture.•a13=(0,1),a23=(0,2),a33=(0,2)anda43=(0,2).N013={1},N023={2,3,4}. Then,c3=min{c01-(c1+c2),c02-(c1+c2)}=min{8-4,7-4}=3.A3={(0,1)}.p13=3,p23=p33=p43=33=1Stage 4: The grey dotted part in the picture.•a14=(0,1), andai4=∅for eachi=2,3,4.N014={1}andc4=c01-(c1+c2+c3)=8-7=1.A4=∅.p14=1andpi4=0for alli=2,3,4.Thus,P1(C,t)=2+2+3+1=8,P2(C,t)=2+2+1=5,P3(C,t)=2+1+1=4,andP4(C,t)=2+1+1=4.We should point out that our rule is different from those in Koster et al. (2001) for fixed tree problems because, for instance, they always consider the same (tarring) speed for each individual. This can be read as if the agents when they finish an arc, move to the next unpaid arc in the path to the source together with the machine they used, which is not our case.To complete our analysis of the painting rule for source connection problems, we introduce some properties of the rules in this context and later, using some of these properties we give an axiomatic characterization of our painting rule.A rule f for source connection problems satisfies:Cost monotonicity(CM). For all scp(C,t)and(C′,t)such thatC′⩾C, then,fC′,t⩾f(C,t).This means that if a certain number of connection costs increase, the rest of the connection costs (if any) remain the same, and the tree t we construct is the same in both problems, no agent can be better off. This property has already been used in other papers, for instance in Tijs et al. (2006) and Bergantiños and Vidal-Puga (2007a), but in a stronger version. They claim this even when the tree to be built is different. Cost monotonicity can be motivated as a solidarity property (it is called solidarity in Bergantiños and Vidal-Puga (2007a)). Suppose that a shock (good or bad) occurs for the group of agents, namely some connection costs decrease and the rest remain the same or some connection costs increase and the rest remain the same, then all agents should be affected in the same way (if the shock is good no agent pays more and if the shock is bad no agent pays less). This motivation could be specially interesting when there is a central authority who must decide the way in which the total cost is divided among the agents. An implication of cost solidarity is that the cost shares must depend only on the tree to be constructed, which have good and bad implications. On the good implications we can mention that the cost shares will be easier to compute (we need only the information related with the tree) and to explain to the agents (their cost shares depend on the links they use and not on the cost of links they are not using). On the bad implications we should mention that we ignore relevant information of the problem (the cost of the links that are not in the tree constructed). This could be not suitable when the cost shares come from a bargaining procedure between the agents instead of a decision of a central authority. For instance, an agent has not the same “bargaining power” if the cost of his links not belonging to the tree constructed are relatively small or very large.In order to introduce the next property we need the following definition:An agent i is referred as isolated ifcij=xi, for allj∈N0⧹{i}, andcjk⩽xi, for all{j,k}⊂N0⧹{i}.Isolated agents(IA). For all scp(C,t)and every isolated agenti∈N,fi(C,t)=xi.If agent i is isolated, then he obtains no benefit from connecting to the source through agents inN⧹{i}. Thus agent i should not contribute to the connection of agents inN⧹{i}to the source. Besides agents inN⧹{i}get no benefits from connecting to the source through agent i. Therefore, the agents inN⧹{i}should not contribute to the connection of agent i to the source. A rule satisfies isolated agents when agent i pays exactlyxi.Branzei et al. (2004) consider a property which assures that agents that are connected through a path of cost 0 should pay the same. We apply the same idea to scp but considering only the costs in t (instead of all costs as in Branzei et al. (2004)) and when agents are symmetric. It is said thatS⊂N0is a(C,t)-component if two conditions hold. First, for alli,j∈S, there is a path g in t from i to j satisfying thatci′j′=0for all(i′,j′)∈g. Second, S is maximal, i.e. ifS⊊T, then T does not satisfy the first condition. Clearly, the set of(C,t)-components is a partition ofN0.It is said thati,j∈N0are symmetric in(C,t)ifcik=cjk,for eachk∈N0⧹{i,j}.Equal treatment inside the(C,t)-components (ET). For each scp(C,t), each(C,t)-component S, and eachi,j∈S, such that iand jare symmetric, we have thatfi(C,t)=fj(C,t).Cone-wise additivity(CA). Let(C,t)and(C′,t)be two scp satisfying that there is an orderσ:{(i,j)}i,j∈N0,i<j→1,2,…,|N|(|N|+1)2such that for alli,j,k,l∈N0satisfying thatσ(i,j)⩽σ(k,l), thencij⩽cklandcij′⩽ckl′. Thus,fC+C′,t=f(C,t)+fC′,t.This property was introduced in Branzei et al. (2004) and it is a linearity property in cones.The property of core selection guarantees that no group of agents can obtain on their own account something better than that which the rule proposes. Bergantiños et al. (2012) prove that in the k-hop problem no efficient rule satisfies core selection. Thus, the same holds in our more general setting. We should emphasize that in some subclasses of our problems the core could be non-empty. For instance, in the classical minimum cost spanning tree problem, Bird (1976) proves that the core is always non-empty. Therefore, we introduce a weaker version of core selection which says that, when only arcs in t are allowed to be constructed, no group of agents can obtain by themselves something better than that proposed by the rule.t-Core selection(t-CS). Let(C,t)be an scp. For eachS⊂N, letS′be the smallest set satisfying thatS⊂S′⊂N0and every agent of S is connected to the source intS′. Then,∑i∈Sfi(C,t)⩽ctS′.The following result shows that the painting rule satisfies all the above-mentioned properties. To this end, first we introduce a simpler way of computing the rule in a particular case.Let(C,t)be a simple problem such thatcij∈{0,x}for alli,j∈N0. Let{S0,S1,…,Sq}be the partition ofN0in(C,t)-components where0∈S0.It is easy to see thatPi(C,t)=x|Sk|,ifi∈Skandk∈1,…,q,0,ifi∈S0.This expression will often be used in the sequel.Theorem 1The painting rule satisfies isolated agents, cost monotonicity, equal treatment inside(C,t)-components, cone-wise additivity and t-core selection.Because of its definition, it is obvious that P satisfies equal treatment inside(C,t)-components.Part 1. P satisfies cone-wise additivity.Let(C,t),(C′,t)and(C+C′,t)be as in the definition of the property andσthe related order.Case 1. We assume that for alli,j,k,l∈N0satisfying thatσ(i,j)<σ(k,l), thencij<cklandcij′<ckl′. Thus,cij+cij′<ckl+ckl′.Without loss of generality, we assume thatt={(i0,i)}i∈Nandci0i<cj0jwheni<j, and compute P in these three problems.Stage 1.•ai1(C)=ai1(C′)=ai1(C+C′)=(i0,i)for alli∈N.Ni0i1(C)=Ni0i1(C′)=Ni0i1(C+C′)={i}for alli∈N. Then,c1(C)=mini∈Nci0i=c101,c1(C′)=mini∈Nci0i′=c101′,andc1(C+C′)=mini∈Nci0i+ci0i′=c101+c101′.A1(C)=A1(C′)=A1(C+C′)=t⧹{(10,1)}.For alli∈N,pi1(C)=c101,pi1(C′)=c101′,andpi1(C+C′)=c101+c101′.Notice thatpi1(C+C′)=pi1(C)+pi1(C′)for alli∈N.Stage 2:•Since whenσ(i,j)<σ(k,l), thencij<cklandcij′<ckl′we deduce thatai2(C)=ai2(C′)=ai2(C+C′)for alli∈N.Ni0i2(C)=Ni0i2(C′)=Ni0i2(C+C′)for alli∈N. Then,c2(C)=mini∈N⧹{1}ci0i-c1(C)=c202-c101,c2(C′)=mini∈N⧹{1}ci0i′-c1(C′)=c202′-c101′,andc2(C+C′)=mini∈N⧹{1}ci0i+ci0i′-c1(C)+c1(C′)=c202+c202′-c101+c101′.A2(C)=A2(C′)=A2(C+C′)=t⧹{(10,1),(20,2)}.For alli∈N,pi2(C)=c202-c101Nai2(C)2,pi2(C′)=c202′-c101′Nai2(C′)2,andpi1(C+C′)=c202+c202′-c101+c101′Nai2(C+C′)2.Notice thatpi2(C+C′)=pi2(C)+pi2(C′)for alli∈N.Repeating this argument we can prove thatγ(C)=γ(C′)=γ(C+C′). Besides, for each stager=1,…,γ(C), and eachi∈Nwe have thatpir(C+C′)=pir(C)+pir(C′).Thus,P(C+C′)=P(C)+P(C′).Consider the general case:σ(i,j)<σ(k,l), thencij⩽cklandcij′⩽ckl′.LetCεandC′εbe such that:1.For eachi,j∈N0,cij-ε⩽cijε⩽cij+εandcij′-ε⩽cij′ε⩽cij′+ε.Ifσ(i,j)<σ(k,l), thencijε<cklεandcij′ε<ckl′ε.For instance, ifN={1,2},c01=1,c02=2,c12=3,c01′=1,c02′=1andc12′=7, then we can takeCε=Candcij′ε=1+εwhen(i,j)=(0,2)andcij′ε=cij′otherwise.SinceCεandC′εare in the conditions of case 1, we can derive thatPCε+C′ε=P(Cε)+P(C′ε).Taking into account the definition of P it is clear thatlimε→0P(Cε)=P(C),limε→0P(C′ε)=P(C′), andlimε→0P(Cε+C′ε)=P(C+C′). Thus,P(C+C′)=P(C)+P(C′), which means that P satisfies cone-wise additivity.Part 2. P satisfies isolated agents.Let(C,t)be an scp andi∈Nan isolated agent. Let(i0,i)be the first arc in the unique path in t from i to 0. It is straightforward to see thatais(C,t)=(i0,i), for all s, andajs(C,t)≠(i0,i), for all s andj≠i. From the definition of P it is obvious thatPi(C,t)=ci0i=xi.Part 3. P satisfies cost monotonicity.Let(C,t)and(C′,t)be two scp such thatC′⩾C.It is enough to prove thatP(C′,t)⩾P(C,t)when there isi′,j′∈N0such thatci′j′′>ci′j′andcij′=cijotherwise.Letσ:{(i,j)}i,j∈N0,i<j→{1,2,…,|N|(|N|+1)2}be an order satisfying that ifi,j,k,l∈Nwithi<j,k<l, andσ(i,j)⩽σ(k,l), thencij⩽ckl.Let{Cr}r=1αbe such thatα=|N||N|+12and for eachr=1,…,αcijr=cσ-1(r)-cσ-1(r-1),ifσ(i,j)⩾r,0,otherwise,whereσ-1(0)=0. Thus,C=∑r=1αCris as in Norde et al. (2004). Moreover, ifi,j,k,l∈Nwithi<j,k<l, andσ(i,j)⩽σ(k,l), thencijr⩽cklrfor allr∈{1,…,α}.Letr′=σ(i′,j′). Several cases can arise:Case 1.ci′j′′⩽cσ-1(r′+1). LetC′aandC′bbe such thatcij′a=cσ-1(r′)′-cσ-1(r′),ifσ(i,j)⩾r′,0,otherwise,cij′b=cσ-1r′+1-cσ-1(r′)′,ifσ(i,j)⩾r′+1,0,otherwise.Thus,C′=∑r=1r′Cr+C′a+C′b+∑r=r′+2αCr.Notice that this decomposition ofC′is done under the conditions established in Norde et al. (2004) considering also the orderσ.Since P satisfies CA, we have thatP(C′,t)⩾P(C,t)if and only ifP(C′a,t)+P(C′b,t)⩾P(Cr′+1,t).LetCabe such thatcija=cσ-1(r′)′-cσ-1(r′),ifσ(i,j)⩾r′+1,0,otherwise.Note thatCr′+1=Ca+C′band the decomposition also holds under the same hypothesis of Norde et al. (2004) when considering the orderσ. Thus,P(C′a,t)+P(C′b,t)⩾P(Cr′+1,t)if and only ifP(C′a,t)⩾P(Ca,t).It is obvious thatC′a⩾Ca. For eachi,j∈N0we have thatcij′a∈0,cσ-1(r′)′-cσ-1(r′)andcija∈0,cσ-1(r′)′-cσ-1(r′). Letπ=S0,S1,…,Sqbe the partition ofN0inCa,t-components0∈S0and letπ′=S0′,S1′,…,Sq′′be the partition ofN0inC′a,t-components0∈S0′. Taking into account thatπ′is finer thanπ(for eachSl′∈π′, there isSl∗∈πsuch thatSl′⊂Sl∗), it is easy to check thatPC′a,t⩾PCa,tbased on the expression of P for simple problems.Case 2.cσ-1(r′+1)<ci′j′′⩽cσ-1(r′+2). LetC1be such thatci′j′1=cσ-1(r′+1)andcij1=cijotherwise. SinceC1and C are under the hypothesis of case 1 we deduce thatP(C1,t)⩾P(C,t). SinceC′andC1are under the hypothesis of Case 1, we deduce thatP(C′,t)⩾P(C1,t). Thus,P(C′,t)⩾P(C,t).Case 3.cσ-1(r′+2)<ci′j′′⩽cσ-1(r′+3). LetC2be such thatci′j′2=cσ-1(r′+2)andcij2=cijotherwise. SinceC′andC2are under the hypothesis of case 1, we can deduce thatP(C′,t)⩾P(C2,t). On the other hand,C2and C are under the hypothesis of case 2, so we can derive thatP(C2,t)⩾P(C,t). Thus,P(C′,t)⩾P(C,t).If we continue with this procedure we will obtainP(C′,t)⩾P(C,t)for each possible valueci′j′′>ci′j′. Thus, P satisfies cost monotonicity.Part 4. P satisfies t-core selection.Let(C,t)be an scp wheret={(j0,j)}j∈NandS⊂N. LetS′be the smallest set satisfying thatS⊂S′⊂N0and every agent of S is connected to the source intS′. ThusS′=⋃i∈SPre(i,t)andtS′={(j0,j)}j∈S′⧹{0}From the definition of P it is known that, for eachs=1,…,γ,ais=(js0,js)for somejs∈Pre(i,t)⧹{0}. Thus,∑i∈SPi(C,t)⩽c(tS′), which means that P satisfies t-core selection.The next theorem closes the axiomatic characterization of the painting rule.Theorem 2The painting rule is the unique rule satisfying isolated agents, cost monotonicity, equal treatment inside(C,t)-components and cone-wise additivity.FromTheorem 1we know that P satisfies all these properties, what remains to be proved is the uniqueness. By cone-wise additivity andTheorem 1inNorde et al. (2004)it is enough to prove it in simple problems(C,t)wherecij∈{0,x}.Let f be a rule satisfying these properties. We will show thatf(C,t)=P(C,t).Let{S0,S1,…,Sq}be the partition ofN0in(C,t)-components where0∈S0. For eachr∈{0,1,…,q}, consider the simple problems(Cr,t)and(C′r,t)wherecijr=cij,ifi,j∈Sr,x,otherwise,andcij′r=0,ifi,j∈Sr,x,otherwise.Note that fori,j∈Srwith(i,j)∈t,cijr=0. For eachr∈{0,1,…,q}and each agenti∈N⧹Srwe know that i is isolated in(Cr,t)and(C′r,t). Since f satisfies isolated agents,fi(Cr,t)=fi(C′r,t)=xwheni∈N⧹Sr. Two cases can arise:1.r=0. Sincec(C′r,t)=|N⧹Sr|x, we obtain that∑i∈S0⧹{0}fi(C′r,t)=0.Since f satisfies equal treatment inside(C,t)-components and all agents inS0⧹{0}are symmetric, we deduce thatfi(C′r,t)=fj(C′r,t)for alli,j∈S0⧹{0}. Thus,fi(C′r,t)=0for alli∈S0⧹{0}.AsC′r⩽Cr,c(C′r,t)=c(Cr,t)=|N⧹Sr|x, and f satisfies cost monotonicity, we obtain thatf(Cr,t)=f(C′r,t).FromC⩽Crand cost monotonicity of f, it can be derived thatfi(C,t)⩽0for alli∈S0⧹{0}.r∈{1,…,q}. Sincec(C′r,t)=(|N⧹Sr|+1)x, we obtain that∑i∈Srfi(C′r,t)=x.Since f satisfies equal treatment inside(C,t)-components and all agents inSrare symmetric, we deduce thatfi(C′r,t)=fj(C′r,t)for alli,j∈Sr. Thus,fi(C′r,t)=xSrfor alli∈Sr.AsC′r⩽Cr,c(C′r,t)=c(Cr,t)=(|N⧹Sr|+1)x, and f satisfies cost monotonicity, we obtain thatf(Cr,t)=f(C′r,t).FromC⩽Crand cost monotonicity of f, it can be derived thatfi(C,t)⩽x|Sr|for alli∈Sr.Asc(C,t)=qxwe conclude thatfi(C,t)=0for alli∈S0⧹{0}andfi(C,t)=x|Sr|for allr∈{1,…,q}and alli∈Sr. Then f coincides with P.□The next result shows that the properties used in Theorem 2 are independent. We should mention that we demonstrate that they are independent when we move into the domain of all the agents and all the trees; into certain subdomains they can be independent or not. For example, if in t all agents are connected to the source, thenIA,ETand CM are a consequence of t -CS.Proposition 1The properties used inTheorem 2are independent.Proof ofProposition 1:Claim 1Moulin and Laigret (2011)define the equal need solution. We adapt their definition to scp. For each arcj,k∈tletNj,kbe the set of agents who need arcj,kto be connected to the source in t. Namely,For eachi∈Nwe defineENi(C,t)=∑(j,k)∈t,i∈N(j,k)cjk|N(j,k)|.EN satisfiesCM,ET,CA, but fails IA.ProofIt is trivial that EN satisfiesET,CA, and CM. The following example shows that EN fails IA: letN={1,2},c01=2,c02=c12=10andt={(0,1),(1,2)}. In this case, 2 is an isolated agent withx2=10butEN(C,t)=(1,11). □The Bird ruleBi(C,t)=ci0i,∀i∈NsatisfiesIA,CM,CA, but fails ET.It is easy to check that B satisfiesCA,IAand CM. The following example shows that B fails ET: letN={1,2,3},c01=c02=1,c12=0,c13=c23=2andc03=100. Assume that the tree to be constructed ist={(0,1),(1,2),(2,3)}. In this situation,B(C,t)=(1,0,2). Agents 1 and 2 form a(C,t)-component and they are symmetric, howeverB1(C,t)≠B2(C,t). □The efficient minimal arc rule is defined asIt is easy to prove that EMA satisfiesIA,ETand CA. The following example shows that it does not fulfill CM: letN={1,2,3},c01=1,c12=0,c23=2andcij=100otherwise. Suppose that the treet={(0,1),(1,2),(2,3)}is the one to be built. Then,EMA(C,t)=13,13,73.Assume now that the cost between agents 1 and 2 increases andc12′=1withcij′=cijotherwise. The selected tree is againt={(0,1),(1,2),(2,3)}. In this case,EMA(C′,t)=1,1,2. Therefore,EMA3(C′,t)<EMA3(C,t). □The rulef(C,t)=minc01,c12+c012,maxc12,c012,if|N|=2andt={(0,1),(1,2)},P(C,t),otherwise,It is easy to check that f satisfiesIA,CM, and ET. The following example shows that it does not fulfill CA: letN={1,2}and let C andC′be two matrices such thatc01=3,c12=0,c02=50andc01′=1,c12′=1andc02′=50. Assume that the treet={(0,1),(1,2)}is constructed in both problems. In this case,f(C,t)=(1.5,1.5)andf(C′,t)=(1,1). On the other hand, consider the problem(N,C+C′)and assume thatt={(0,1),(1,2)}is also constructed in this problem. Now,f(C+C′,t)=(3,2). Then,f(C,t)+f(C′,t)≠f(C+C′,t). □As pointed out in the introduction, there are several well-known problems that fit into our model. To end the analysis of the source connection problems we will show that the painting rule is related to an outstanding rule in one of these classical problems.A minimum cost spanning tree problem, more briefly referred to as an mcstp, is a pair(N0,C)whereN⊂Nis a finite set of agents, 0 is the source, andC∈CNis the cost matrix. An mcstp could be considered as an scp(N0,C,T)where T is the set of all trees overN0.An important rule in mcstp is the folk rule, which was introduced in Feltkamp et al. (1994) and studied later in Branzei et al. (2004), Bergantiños and Vidal-Puga (2007a, 2007b, 2009, 2010). The folk rule can be defined in several ways, we will focus here on the definition provided by Bergantiños and Vidal-Puga (2007a).Given an mcstp(N0,C)and a tree t with minimal cost, Bird (1976) defined the minimal network(N0,Ct)associated with t as follows:cijt=max(k,l)∈gij{ckl}, wheregijdenotes the unique path in t from i to j. Moreover,cijtis independent of the chosen t andCt⩽C.Given an mcstp(N0,C), Bird (1976) associates with it a cooperative game with transferable utility(N,vC)where for eachS⊂N,vC(S)=c(S0,C,tS)withtSrepresenting a minimal cost spanning tree for the mcstp(S0,C).The folk rule F of an mcstp is the Shapley value of the gameN,vCt, where t is any tree with minimal cost in(N0,C).The next proposition show that the painting rule is a generalization of the folk rule.Proposition 2Let(N0,C)be an mcstp and t a tree with minimal cost in(N0). Then,P(C,t)=FN0,C.Proof ofProposition 2:Given an scp(C,t)we consider the ruleF(C,t)=F(N0,C).By Theorem 2 it is enough to prove that F satisfies isolated agents, cost monotonicity, equal treatment inside(C,t)-components and cone-wise additivity.□We prove that F satisfies isolated agents. Leti∈Nbe an isolated agent. Bergantiños and Vidal-Puga (2007a) prove that each marginal contribution of agent i in the gameN,vCtbelongs to the setcijtj∈N0⧹i. From the definition ofCtit is easy to check thatcijt=xi, for eachj∈N0⧹{i}. It is well-known that the Shapley value is a weighted average of all marginal contributions, therefore the folk rule assignsxito agent i.Bergantiños and Vidal-Puga (2007a) show that the folk rule satisfies a property called strong cost monotonicity, which says that ifC′⩾C, thenFN0,C′⩾F(N0,C). Thus,F(C′,t)=FN0,C′⩾F(N0,C)=F(C,t),which means that F satisfies cost monotonicity.Branzei et al. (2004) prove that the folk rule satisfies Property 2 of their paper. Using arguments similar to those used with cost monotonicity, it is easy to check that F satisfies equal treatment inside(C,t)-components.These authors demonstrate that the folk rule fulfills Property 4 in Branzei et al. (2004). Then, F satisfies cone-wise additivity.Using Proposition 2 we can provide a characterization of the folk rule in mcstp.A rule f in mcstp satisfies symmetry if for each mcstp(N0,C)and each pair of symmetric agents in(N0)we havefi(N0,C)=fj(N0,C). The properties of cost monotonicity, isolated agents and cone-wise additivity could easily be adapted to mcstp simply by deleting the tree t from its definition.Corollary 1The folk rule is the unique rule in mcstp satisfying isolated agents, cost monotonicity, symmetry, and cone-wise additivity.ByProposition 2the folk rule satisfies all properties but symmetry,Bergantiños and Vidal-Puga (2007a)prove that the folk rule satisfies symmetry.Following a similar line of reasoning to that used to show the uniqueness in Theorem 2, we can derive that the folk rule is the unique rule satisfying these properties.□There are several characterizations of the folk rule in the literature. That which we have obtained can be seen as a variation of the characterization given by Bergantiños and Vidal-Puga (2009), where we use weaker versions of Restricted Additivity and Separability but compensate by adding Cost Monotonicity. Not only a characterization is derived, but a new and very intuitive way to calculate the folk rule has also been provided. In Example 1.1 (page 328), Bergantiños and Vidal-Puga (2007a) give an explanation for choosing this rule, which can be computed easily through the painting procedure, instead of those proposed by Kar (2002), Bird (1976), and Dutta and Kar (2004).On the other hand, Bergantiños et al. (2012) introduce a new cost allocation rule based on bankruptcy rules for k-hop minimum cost spanning tree problems and point out one shortcoming of this rule, namely that it is not based on the structure of the k-hop tree constructed. The painting rule overcomes this shortcoming. Finally, as mentioned before in the case of fixed tree problems, where there is a huge amount of literature on the subject of cost sharing, our painting procedure provides an allocation which can be computed in polynomial time and has a very intuitive interpretation of how the agents cooperate in a joint project.In this paper we have addressed a problem that encompasses many source connection situations. The philosophy is to take into account several potential trees - depending on how the set of trees is, we are faced with different problems, some well-known (mcstp) others not – and the tree that the decision maker chooses is what is built. The underlying idea is that the cost paid by the agents is related to the chosen tree contrary to Bergantiños et al. (2012), where the rule proposed is not based on the structure of the k-hop tree constructed. Therefore we are considering that a close connection between what agents pay and what is being built must exist. In our case, the structure determines the distribution, thus, in this sense it has a resemblance to fixed tree problems. In fact, we named our proposed rule a painting rule because it can be interpreted by means of a story about painting as in Maschler et al. (2010). But, as we have seen throughout the paper, it is different from those in the literature (c.f. Maschler et al. (2010) and Koster et al. (2001)). Likewise, in standard fixed tree problems the tree is fixed from the beginning. In our case, we first determine a tree among a set of possible trees satisfying certain constraints and, as it has been pointed out, depending on the set of possible trees different types of problems arise. Therefore our model lies somewhere in between the fixed tree model (when alternative trees are not taken into account) and other models like the minimum cost spanning tree problem where the selected tree depends on the cost matrix. Other problems are studied in the literature, where the goal is also to connect agents to a source, but in which the optimal network is not a tree (see Quant et al. (2006)). In that case, the painting rule cannot be applied to distribute the cost among the agents.

@&#CONCLUSIONS@&#
