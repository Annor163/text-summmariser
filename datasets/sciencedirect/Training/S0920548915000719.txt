@&#MAIN-TITLE@&#
Fully secure fuzzy identity-based encryption for secure IoT communications

@&#HIGHLIGHTS@&#
We proposed a new fuzzy identity-based encryption (FIBE) scheme.We prove that our new FIBE scheme is secure in the full model without random oracles.Our proposed FIBE scheme is more efficient than previous schemes.

@&#KEYPHRASES@&#
Fuzzy identity-based encryption,Tight reduction,Standard model,Secure communications,Internet of things,

@&#ABSTRACT@&#
How to securely transmit data is an important problem in Internet of Things (IoT). Fuzzy identity-based encryption (FIBE) is a good candidate for resolving this problem. However, existing FIBE schemes suffer from the following disadvantages: rely on random oracle models, merely secure in selective-ID model, long public parameters, and loose security reduction. In this paper, we propose a new FIBE scheme. Our scheme is secure in the full model without random oracles, and at the same time has a tight security reduction and short public parameters. This means that our scheme is quite suitable for secure transmitting data in IOT.

@&#INTRODUCTION@&#
In the past few years, Internet of Things (IoT) [1] has been widely used in our daily life. IoT can be viewed as a physical and logical extension of the current internet, populated by billions of intelligent networked devices or “things” [2]. Since the devices in IoT are physically vulnerable and are often left unattended, IoT applications are usually vulnerable to security attacks. Thus the security problems gain more and more attention in IoT. In particular, how to securely transmit data in IoT systems is an important problem. Encryption is a potential technique which can be used for secure communications in IoT. It is worth noting that, traditional encryption technique cannot be trivially used in IoT systems, since the devices in IoT are usually source-constrained, and hence the encryption scheme should be quite efficient. In addition, errors would usually occur during the data transmission, and hence the encryption scheme should provide the feasibility of correcting the errors, i.e., error-tolerance.Identity Based Encryption (IBE), introduced by Shamir [3] in Crypto 1984, is a public key encryption mechanism where an arbitrary string (such as a user's phone number, email address, identity number, etc.) can serve as the public key. The ability to use identities as public keys can naturally eliminate the need for certificates as used in the traditional pubic key infrastructure (PKI), and hence IBE is more desirable than traditional public key encryption in PKI. IBE has attracted great interests in the past few years, and many IBE schemes and the variants have been proposed in the past years [4–12]. However, IBE cannot provide the property of error-tolerance. To address this problem, in Eurocrypt'05, Sahai and Waters [13] introduced a new notion named fuzzy identity-based encryption (FIBE). In a FIBE scheme, a user with a private key for an identity ID is able to decrypt a ciphertext encrypted with an identity ID' if and only if ID and ID' are within a certain distance of each other as judged by some metrics. This means that FIBE is error-tolerant.In Eurocrypt'05, Sahai and Waters [13] presented two constructions of FIBE systems. The first construction (SW-I for short) only allows for limited attributes, and the second one (SW-II) is a large universe construction that uses all elements in ℤp⁎ as attributes. Both schemes are only secure in a weak security model named selective-ID model, in which the adversary must commit the target identity (which the adversary wants to attack) ahead of the system setup. Besides, the public parameters in both constructions are somewhat long, that is, the public parameters size in SW-I grows linearly with the number of possible attributes in the universe, and in SW-II it grows linearly in a parameter which is fixed as the maximum size identity one can encrypt to.As mentioned above, Sahai-Waters FIBE systems are only secure in the selective-ID model. As shown in [13], suppose that all identities are composed of n attributes andUis the universe of attributes, then to achieve the full security, these schemes will introduce a security degradation ofUn. We stress that, a loose security reduction implies a lower security or the requirement of larger keys and ciphertext sizes to obtain the same security level, and thus make the system inefficient. Hence a stronger requirement for our FIBE system proposed in this paper is to be secure in the full model (i.e., the adversary can commit the target identity at any time), and yet the security reduction is tight.Baek et al. [14] presented another FIBE scheme with short public parameters in the random oracle model.11In a previous work [15], Pirretti et al. also observed that Sahai-Waters construction can be implemented more efficiently if the random oracle is employed.However, a proof in the random oracle model can only serve as a heuristic argument and does not imply the security in the real world [16–19]. Thus FIBE schemes secure in the standard model (i.e., without random oracles) are more desirable.Ren et al. [20] proposed a new FIBE scheme, and claimed that their scheme is secure in the full model without random oracles. Unfortunately, Wang et al. [21] and Tian et al. [22] independently present attacks against Ren et al's FIBE scheme, and indicated that Ren et al.'s scheme is insecure in the full model. Other works have been devoted to FIBE. Pirretti et al. [15] examined methods for applying the Sahai-Waters FIBE systems into practice and presented an implementation of these constructions. Chase [23] gave a multi-authority construction of FIBE which allows any polynomial number of independent authorities to monitor attributes and distribute secret keys. They also showed how to apply their techniques to achieve a multi-authority version of the large universe KP-ABE.In this paper, we propose a new FIBE scheme. Unlike previous selective-ID secure FIBE schemes, our proposed scheme is secure in the full model without random oracles. In addition, our scheme has the advantage of tight security reduction. Thus in contrast to previous FIBE schemes with loose security reduction, our scheme needs not to enlarge the keys size and ciphertext sizes to obtain the same security level. Our scheme also enjoys the advantage of constant size of public parameters. All of these indicate that our FIBE scheme is more efficient that previous schemes, and hence is more suitable for secure IoT communications.The rest of this paper is organized as follows. Section 2 gives an introduction to bilinear pairings and some complexity assumptions. In Section 3, we review the definition and security notion for FIBE. We present our FIBE scheme in Section 4. The security proof for our scheme and a comparison between our FIBE scheme and some other FIBE schemes are also given in this section. Finally, Section 5 concludes this paper.Throughout this paper, let ℤpdenote the set {0,1,2,⋯,p−1}, and ℤp⁎ denote ℤp\{0}. For a finite set S, we let |S| denote the cardinality of S, andx←$Smeans choosing an element x from the set S with a uniform distribution.LetGbe a cyclic multiplicative group of prime order p, andGTbe a cyclic multiplicative group of the same order p. A bilinear pairing is a mape:G×G→GTwith the following properties:•Bilinearity:∀g1,g2∈G,∀a,b∈ℤp*, we have e(g1a,g2b)=e(g1,g2)ab;Non-degeneracy: there existg1,g2∈Gsuch that e(g1,g2)≠1;Computability: there exists an efficient algorithm to compute e(g1,g2) for∀g1,g2∈G.As shown in [24], bilinear parings can be obtained from the Weil pairing or Tate pairing over supersingular elliptic curves or Abelian varieties.The security of our constructions is based on a variant of the q-bilinear Diffie–Hellman exponent (BDHE) assumption. We here first recall the q-BDHE assumption, which has been used to construct an efficient HIBE scheme in [4] and a broadcast encryption scheme in [25]. The q-BDHE assumption is stated as follows: given a vector of 2q+1 elementsg',g,gα,gα2,⋯,gαq,gαq+2,⋯,gα2q∈G2q+1as input, outputeg,g'αq+1. Since the input vector is missing the termgαq+1, the bilinear map does not seem to help computeeg,g'αq+1.For convenience, hereafter, we use giand g'ito denotegαiandg'αirespectively. Gentry [6] defined an almost identical assumption named q augmented bilinear Diffie–Hellman exponent (q-ABDHE) assumption: given a vector of 2q+2 elementsg',g'q+2,g,g1,g2,⋯,gq,gq+2,⋯,g2q∈G2q+2as input, output e(gq+1,g'). Introducing the additional term g'q+2 still does not appear to help compute e(gq+1,g'), since the termgα‐1is missed in the input vector.We here further modify the q-ABDHE assumption by introducing another additional term g2q+1. That is, given a vector of 2q+3 elementsg',g'q+2,g,g1,g2,⋯,gq,gq+2,⋯,g2q,g2q+1∈G2q+3as input, output e(gq+1,g'). Again, introducing the additional term g2q+1 still does not appear to help compute e(gq+1,g'), since the input vector is missing the termg'α‐q. We refer to this modified assumption as q modified bilinear Diffie–Hellman exponent (q-MBDHE) assumption. Our proposed systems are based on the decisional q-MBDHE assumption. Formally,Definition 1The decisional q-MBDHE problem in groupsGGTis, given a vectorg',g'q+2,g,g1,g2,⋯,gq,gq+2,⋯,g2q,g2q+1∈G2q+3for unknownα←$ℤp*and the random elementZ←$GT, to decide whether Z=e(gq+1,g'). For a probabilistic polynomial-time adversaryB, we define his advantage against the decisional q-MBDHE problem in groupsGGTasAdvB,GGTq−MBDHE≜PrBg',g'q+2,g,g1,g2,⋯,gq,gq+2,⋯,g2q,g2q+1,egq+1,g'=1−PrBg',g'q+2,g,g1,g2,⋯,gq,gq+2,⋯,g2q,g2q+1,Z=1,where the probability is taken over the random bits consumed byB, the random choices ofg,g'∈G,α∈ℤp*andZ∈GT.We say that the (t,ϵ) decisional q-MBDHE assumption holds in groupsGGT, if no t-time adversaryBhas advantage at least ϵ in solving the decisional q-MBDHE problem inGGT.Decisional q-MBDHE is a new and non-standard problem. However, it can be verified that it belongs to the general Diffie–Hellman exponent problems mentioned in [25]. Boneh et al. [25] have given the complexity lower bound for these general Diffie–Hellman exponent problems in generic groups. According to their results, we can see that the complexity lower bound of our decisional q-MBDHE assumption is only about 3 times than that of the well-studied BDDH assumption. However, we emphasize that this comparison may not hold in the real world, since the fastest algorithms for solving these assumptions are likely non-generic.Like traditional identity-based encryption (IBE) systems, a FIBE consists of four algorithms: Setup, Extract, Encrypt, and Decrypt. In a FIBE system, however, the identity is viewed as a set of attributes. A message encrypted under a set w' of attributes can be decrypted by a secret key associated with a set w of attributes, if and only if w' and w are within a certain distance of each other as judged by some metric. More precisely, a FIBE system consists of the following algorithms.Setup (κ,d): takes as input a security parameter κ and an error tolerance parameter d. It generates the public parameters param and the corresponding master secret key msk.ExtractmskID: takes as input the master secret key msk, an identityIDwith a set of attributes. It outputs the secret keyskIDfor identityID.Encryptm,param,ID': takes as input a message m, the public parameters param and an identityID'. It outputs a ciphertext CT.Decryptparam,skID,CT: takes as input the public parameters, a ciphertext CT encrypted under an identityID', and an identityIDsuch thatID∩ID'≥d. It decrypts this ciphertext and returns the resulting plaintext.We here define the security model for FIBE system. This model is very similar to the model for standard IBE system, with the exception that the adversary is only allowed to query for secret keys for identities which have less than d overlap with the target identity. Concretely, the IND-ID-CCA2 security for FIBE systems is defined by the following game between an adversaryAand a challengerC.Setup the challengerCrunsSetupκto obtain the public parameters param and the corresponding master key msk.Cgives param to adversaryA, and keeps msk himself.Phase 1 adversaryAadaptively issues queries q1,⋯,qmwhere qiis one of the following:•Secret key queryID: challengerCfirst runs algorithm Extract to obtain a secret keyskIDfor identityID. Then it returnsskIDtoA.Decryption queryCTID: challengerCfirst runs algorithm Extract to obtain a secret keyskIDfor identityID. Next, it runsDecryptparam,CT,skIDto obtain a plaintext m. Finally, m is returned toA.Challenge: adversaryAsubmits a target identityID*and two equal length messages m0 and m1. It is required that all the identities queried in Phase 1 have less than d overlap with the target identityID*. ChallengerCflips a fair coin b ϵ{0,1}, and encrypts mbunderID*. The ciphertext CT* is given to adversaryA.Phase 2: the same as in Phase 1 with the restrictions that: (i)Acan not issue a secret key query for an identityIDsuch thatID∩ID*≥d; (ii)Acan not issue a decryption query forCT*,IDsuch thatID∩ID*≥d.Guess: finally,Aoutputs a guess b'ϵ{0,1} and wins if b'=b.We refer to such an adversaryAas an IND-ID-CCA2 adversary. We defineA's advantage in attacking scheme Π asAdv∏,AIND‐ID‐CCA2=Prb=b'−12,where the probability is taken over the random coins consumed by the challenger and the adversary.Sahai and Waters [13] defined a weak selective-ID model for FIBE systems, where the adversary must commit ahead of time the target identity. Such an adversary is termed as IND-FSID-CCA2 adversary.Definition 3We say that a CP-ABE scheme Π is (t,qs,qd,ϵ)-IND-ID-CCA2 (resp. IND-FSID-CCA2) secure if for any t-time IND-ID-CCA2 (resp. IND-FSID-CCA2) adversaryAwho makes at most qssecret key queries and at most qddecryption queries, we have thatAdvΠ,AIND‐ID‐CCA2<ϵ(resp.AdvΠ,AIND‐FSID‐CCA2<ϵ).The chosen-plaintext security for a FIBE system Π can be defined as the preceding game, except that adversaryAis disallowed to issue any decryption query. This security notion is termed as IND-ID-CPA (or IND-FSID-CPA in the case of a selective-ID adversary).Definition 4We say that a FIBE system Π is (t,qs,ϵ)-IND-ID-CPA (resp. IND-FSID-CPA) secure if Π is (t,qs,0,ϵ)-IND-ID-CCA2 (resp. IND-FSID-CCA2) secure.LetGandGTbe two groups with prime order p of size κ, and let e be a bilinear map such thate:G×G→GT. The proposed FIBE system consists of the following algorithms:Setup (κ,d): the setup algorithm first randomly picksβ←$ℤp*andw,w2,h1,h2←$G. Next, it sets w1=wβ. The public parameters and the master secret key areparam=ww1w2h1h2,msk=β.ExtractmskID: to generate a secret key for identityID=μ1⋯μnϵℤp*n, it first randomly generates a (d−1)-degree polynomial q such thatq0=1β. Next, choose rifor i=1,⋯,n. The secret key forIDis defined as(1)skID=Di=w2qμi⋅h1h2μiri,Ri=w1rii∈1⋯n.Encryptm,param,ID': to encrypt a messagem∈GTunder an identityID'=μ1,⋯,μ'n'∈ℤp*n', it picks←$ℤp*and define the ciphertext asCT=ID',C'=m⋅eww2s,C''=w1s,Ci=h1h2μisi∈1,⋯,n'.Decryptparam,skID,CT: suppose that a ciphertext CT is encrypted under identityID'and we have a secret keyskIDfor identityIDsuch thatID∩ID'≥d. This algorithm first parses the ciphertext asCT=ID',C',C'',Cii∈1,⋯,n'and the secret key asskID=DiRii∈1⋯n. Next, it chooses an arbitrary setS⊆ID∩ID'such that |S|=d. Finally, the ciphertext can be decrypted asm=C'⋅∏i∈SeCiRiΔμi,S0e∏i∈SDiΔμi,S0,C''.Indeed, for a valid ciphertext, we haveC'⋅∏i∈SeCiRiΔμi,s0e∏i∈SDiΔμi,s0,C''=m⋅eww2s⋅∏i∈Seh1h2μisw1riΔμi,s0e∏i∈Sw2qμi⋅h1h2μiΔμi,s0,w1s=m⋅eww2s⋅e∏i∈Sh1h2μiri⋅Δμi,s0,w1se∏i∈Sw2qμi⋅Δμi,s0,w1s⋅e∏i∈Sh1h2μiri⋅Δμi,s0,w1s=m⋅eww2sew2∑i∈sqμi⋅Δμi,s0w1s=m⋅eww2sew2q0w1s=m⋅eww2sew21βwβ=m.Theorem 1Assume that the (t,ϵ) decisional 2-MBDHE assumption holds inGGT. Then the proposed FIBE scheme is (t',qs,ϵ')-IND-ID-CPA secure witht'≤t+Oqs⋅im⋅te,ϵ'=ϵ,where qsdenotes the number of secret key queries, imis the maximal number of attribute in an identity queried in the secret key queries, and tedenotes the running time of an exponentiation inG.Suppose there exists a (t',qs,ϵ') adversaryAagainst the IND-ID-CPA security of our FIBE scheme. UsingA, we can construct an algorithmBthat solves the (t,ϵ) decisional 2-MBDHE assumption inGGT. Taking as input a random decisional 2-MBDHE challenge (g',g'4,g,g1,g2,g4,g5,Z), AlgorithmBworks by interacting withAin the IND-ID-CPA game as below:Setup: to generate the public parameters forA, using a trick similar to that in [6], algorithmBworks as follows:1.Pickδ←$ℤp*. Again, we assume that δ≠α. A random 2-degree polynomial F1(X)∈ℤp[X] is also generated.Set w=g,w1=g1g−δ=wα−δandw2=gF1αg‐F1δ.Pickv1,v2←$ℤp*, and seth1=w1v1,h2=w1v2. The public parameters param=(w,w1,w2,h1,h2) are sent toA.Observe that these public parameters are well-formed and have identical distributions as those in the real construction.Phase 1: in this phase,Aissues a series of secret key queries. Upon receiving a secret key query on an identityID=μ1⋯μn∈ℤp*n,Bconstructs a secret key forTas follows.1.Construct a random (d−1)-degree polynomial q such thatq0=1βas follows: Pickai←$ℤpfor i=1,⋯,d‐1 such that ad‐1≠0. Now, the polynomial q is implicitly set to beqX=1β+∑j=1d−1αj⋅Xi.Note that1βis unknown toB.Let F2(X) denote the 1-degree polynomialF1X−F1δX−δ. For each i∈{1,⋯,n}, pickri←$ℤp*and define the corresponding secret key component to beDi=gF2α⋅w2∑j=1d‐1aj⋅μij⋅h1h2μiri,Ri=w1ri.Return the secret keyskID=DiRii∈1⋯ntoA.Observe thatskIDis indeed a valid secret key for identityID, sinceq0=1βand for each i∈{1,⋯,n},Di=gF2α⋅w2∑j=1d‐1aj⋅μij⋅h1h2μiri=gF1α−F1δα−β⋅w2∑j=1d‐1aj⋅μij⋅h1h2μiri=w21α−δ⋅w2∑j=1d‐1aj⋅μij⋅h1h2μiri=w21β+∑j=1d‐1aj⋅μij⋅h1h2μiri=w2qμi⋅h1h2μiri.Challenge: whenAdecides that Phase 1 is over, it outputs a target identityID*=μ1*⋯μn*and two equal-length messagesm0,m1∈GT. Let F3(X)=X4 and letF4X=F3X−F3δX−δ, which is a polynomial of degree 3. Let F5(X)=(F1(X)−F1(δ))⋅F4(X), and express F5(X) as F5(X)=∑i=05F5,iXi. AlgorithmBpicksb←$0,1and defines the challenge ciphertext asCT*=ID*,C'*=mb⋅ZF5,3⋅eg',∏i=0i≠35giF5,i,C''*=g'F3α−F3δ,Ci*=C"*v1+μi*⋅v2i=1n.which is returned toA.Phase 2:Aissues a series of secret key queries, andBresponds as in Phase 1.Guess: finally, adversaryAreturns a guess b'∈{0,1} toB. If b=b', thenBoutputs 1 indicating Z=e(g3,g'). Otherwise, it outputs 0 indicating Z is a random element inGT.Analysis: From the description of the simulation, we can see that the public parameters are well-formed and have an indistinguishable distribution as in the real environment. The responses toA's secret key queries are also perfect. Moreover, if Z=e(g3,g'), then CT* is a valid ciphertext for mbunder the challenge access structureA*. To see this, let s=(loggg')⋅F4(α), we haveC'*=mb⋅eww2s,C''*=w1s,andCi*=C''*v1+μi*⋅v2=w1sv1+μi*⋅v2=w1v1+μi*⋅v2s=h1h2μi*s,∀i∈1⋯n.So, when Z=e(g3,g'), the simulation provided forAis indistinguishable from the real environment. Hence we see thatPrBg',g'4,g,g1,g2,g4,g5,eg3,g'=1=12+ϵ.On the other hand, when Z is uniform and independent inGT, the challenge ciphertext C* is independent of b in the adversary's view. Thus we havePrBg',g'4,g,g1,g2,g4,g5,Z=1=12.Therefore, algorithmBhas an advantage ϵ'=ϵ in solving the decisional 2-MBDHE challenge.In the simulation, the time complexity ofBis dominated by the exponentiations in the secret key queries. Since there are at mostOimexponentiations in each query, we know thatB's time complexity ist'≤t+Oqs⋅im⋅te. This concludes the proof of this theorem.In this subsection, we compare our FIBE scheme with previous FIBE schemes including SW scheme [13] and BSZ Scheme [14]. Since Ren et al.'s scheme [20] has been found insecure, we do not consider their scheme here. Detailed comparisons are given in Table 1, in which “W.R.O.” means without random oracles and “T.S.R.” means tight security reduction. The comparison results indicate that our scheme outperforms other schemes.The security proof of our FIBE system is given in the chosen-plaintext model. Similar to Goyal et al.'s attribute-based encryption scheme [26], our construction can be extended to the chosen-ciphertext model by applying Sahai's technique [27], which uses the simulation-sound NIZE proofs to achieve chosen-ciphertext security. Furthermore, the delegation mechanism in our scheme can be used with the techniques in [17,28,29] to achieve a more efficient CCA2 secure system.

@&#CONCLUSIONS@&#
With the rapid development of IoT, many security problems had emerged, and how to securely transmit data in IoT is one of these important problems. To deal with these problem, we presented a new fuzzy identity-based encryption (FIBE) scheme, and proved the semantically security of the proposed scheme under the 2-MBDHE assumption. Compared with existing FIBE scheme, our proposed scheme has a number of advantages: (i) it is semantic secure in the full model; (ii) its security is tight, and it does not rely on the random oracle model; (iii) it has short public parameters, and hence is quite efficient. Thus compared with previous FIBE schemes, our scheme is more suitable for the secure communications in IoT.