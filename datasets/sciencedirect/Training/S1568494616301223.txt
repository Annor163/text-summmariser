@&#MAIN-TITLE@&#
A hybrid framework combining data-driven and model-based methods for system remaining useful life prediction

@&#HIGHLIGHTS@&#
A hybrid/fusion prognostics framework to predict remaining useful life by combining the data-driven methods and model-based methods.Introduce a data-driven method to estimate the measurement model in a model-based particle filter framework.Introduce a data-driven method to predicted future measurement in long term prediction in a model-based particle filter framework.Shown improved prediction accuracy using battery as a case study.

@&#KEYPHRASES@&#
Condition monitoring,Hybrid method,Predictive maintenance,Prognostics,Remaining useful life prediction,

@&#ABSTRACT@&#
Remaining useful life prediction is one of the key requirements in prognostics and health management. While a system or component exhibits degradation during its life cycle, there are various methods to predict its future performance and assess the time frame until it does no longer perform its desired functionality. The proposed data-driven and model-based hybrid/fusion prognostics framework interfaces a classical Bayesian model-based prognostics approach, namely particle filter, with two data-driven methods in purpose of improving the prediction accuracy. The first data-driven method establishes the measurement model (inferring the measurements from the internal system state) to account for situations where the internal system state is not accessible through direct measurements. The second data-driven method extrapolates the measurements beyond the range of actually available measurements to feed them back to the model-based method which further updates the particles and their weights during the long-term prediction phase. By leveraging the strengths of the data-driven and model-based methods, the proposed fusion prognostics framework can bridge the gap between data-driven prognostics and model-based prognostics when both abundant historical data and knowledge of the physical degradation process are available. The proposed framework was successfully applied on lithium-ion battery remaining useful life prediction and achieved a significantly better accuracy compared to the classical particle filter approach.

@&#INTRODUCTION@&#
Prognostics technology covers many aspects such as yielding advanced warning of impending failures and estimating remaining useful life (RUL), etc., which ultimately result in increased availability, reliability and safety as well as reduced maintenance and logistics cost. As defined in ISO13381-1 [1], prognostics is ‘an estimation of time to failure and risk for one or more existing and future failure modes.’ RUL was defined as ‘the length from the current time to the end of the useful life’ in [2]. RUL prediction has been applied to many systems such as military and aerospace systems, manufacturing equipment, and structure, power systems and electronics. In general, there exist two main types of RUL prediction methods, namely date-driven methods and model-based methods.Data-driven methods rely only on previously observed data to predict the projection of systems’ state or match similar patterns in the history to infer RUL. Data-driven methods include but are not limited to statistical methods, reliability functions, and artificial intelligence methods. Statistical methods such as Hidden Markov Models (HMM) have been applied for prognostics as proposed in [3] for bearing RUL prediction. Statistical methods can further utilize time-series regression techniques such as auto-regressive moving average as mentioned in [4] for lithium-ion battery RUL prediction. Reliability functions such as Weibull distributions have also been used for data-driven prognostics. Guo et al. [5] presented a three-parameter Weibull failure rate function for wind turbine reliability assessment. Artificial intelligent methods such as neural networks were presented by Li et al. [6] using an enhanced fuzzy-filtered neural network method for material fatigue prognostics. Yu [7] proposed a self-organizing maps method for machine health assessment. Data-driven methods derive models only from historical data and are applicable when data is abundant. Similar methods can be applied to different systems without understanding the complex system physics. The output generated from real monitoring data tends to give more precise information than expert experience or maintenance feedback. However, most results of data-driven methods are not easy to explain or relate to any physical meaning. In prognostics applications, there are also challenges in determining thresholds, defining data to describe normal behavior, and solving overfitting issues, etc.Model-based or physics-based methods are approaches that involve the knowledge of a system's failure mechanisms (e.g. crack growth) to build a mathematical description of the system's degradation process in order to estimate the RUL. The mathematical models quantitatively characterize a system's behavior using the first principles, e.g. Zhao et al. [8] presented a prognostics method for remaining useful life prediction for gears. The method was based on a first-principle degradation model (Paris’ law) whose parameters were updated within a Bayesian framework. When available and sufficiently complete, behavioral models tend to significantly outperform other types of models [9]. Additionally, changes in model outputs as described by the residuals tend to have a direct (or easily translatable) physical meaning [10]. However, model-based methods may not be applicable to complex systems due to the lack of understanding of all failure modes and behaviors under a range of operating conditions. Model parameter identification also requires extensive experiments. In addition, a model-based method is often built case by case. Hence, it is not generally applicable to a different system without significant amount of effort.There is no universally the best prognostics method since each method has its advantages and disadvantages and sometimes case specific. It is intuitive to use a fusion approach via combining data-driven methods and model-based methods to leverage their strengths and improve the RUL prediction performance. There are generally four types of fusion approaches reported in the literature, which are listed as follows:•Use a data-driven method to infer a measurement model and a model-based method to predict RUL (e.g. [11]): This method makes it possible to use a mathematically sound model-based approach to predict system state, especially when the system state itself is not directly measurable or can not be measured accurately. The data-driven model builds a mapping from the measurement to the system state, which ideally requires the life cycle data to establish an exhaustive mapping. This is costly for some applications, while it is also reasonable to build the mapping using data collected when incipient fault is detected.Use a data-driven method to replace a system model in a model-based RUL prediction method (e.g. [12]): Building a system model or fault growth model is prohibitive for a complex system, because it may involve detailed finite element analysis. Using a data-driven method to replace the system model provides an alternative to reduce modeling effort. However, data exhaustiveness cannot always be met to build such a model. For example, data in multiple temperature conditions for battery life prediction requires a significant amount of effort to collect.Use a data-driven method to predict future measurements which are used within a model-based method (e.g. [13]): This method overcomes the hurdle of measurement availability during long-term prediction which assumes the system parameters to be constant in the future. The trade-off is that only accurate measurement prediction can help correct the system model. Otherwise, the prediction accuracy may not be ensured.Combine a data-driven method and a model-based method for prediction by “averaging” their results (e.g. [14]): This method shares similar advantages and disadvantages with the data-driven methods and the model-based methods as mentioned earlier. The benefit is potentially rewarding, while it requires more engineering effort and it is not trivial to design the “averaging” mechanism.It was found out that a lot of research has been concentrated on the fusion approach of combining data-driven methods and model-based methods. The above mentioned methods have been proposed to fuse the two types of models with different interfaces. These fusion methods addressed the fusion mechanism from different aspects with a single interface (e.g. use a data-driven model to replace the system degradation model as an interface to a model-based method which eventually predicts the RUL). However, it is not clear how to fuse different types of models with multiple interfaces to improve the prediction accuracy, especially when data becomes abundant. The proposed fusion prognostics framework uses data-driven methods both to predict future measurements and to infer the measurement model within a model-based method for RUL prediction. The content was organized as follows: Section 2 described the proposed data-driven method and model-based method fusion framework in detail. Section 3 firstly described the goal of a battery RUL prediction case study and the dataset that was used. Secondly, the prediction results of a traditional model-based method and the proposed fusion approach were analyzed. Finally, a conclusion and discussion of further improvements were given in Section 4.The proposed fusion prognostics framework estimated remaining useful life by combining the data-driven methods and model-based methods. The model-based method described the system degradation in the form of an analytical system equation (degradation model). The degradation model should accurately describe the general progression of degradation, however, there might always be deviations from this model in real applications. Data-driven prediction methods that incorporate historical data from both comparable systems and the very system under test can contribute to the prediction in a way that improves the prediction accuracy and lowers the uncertainty boundaries. The detailed interface between the data-driven methods and the model-based method was shown in Fig. 1followed by a detailed descriptions of each method.The novelty of the proposed method is to introduce two data-driven methods into the classical model-based particle filter framework to improve prediction accuracy. The novelty can be summarized as follows:•Introduce a data-driven method to estimate the measurement model;Introduce a data-driven method to predicted future measurement in long term prediction.The proposed hybrid prognostics framework generalizes the Bayesian state estimation by introducing two data-driven methods within a model-based method, which is particle filter in this case. The internal system state Xk(e.g. degradation) of a complex system is usually not directly accessible to the measurements Ykfrom sensors. Hence, inference needs to be made from measurements to indirectly estimate the internal system state, which is predicted by a model-based method. While the classical Bayesian state estimation relies on an analytical measurement modelYk=h(Xk)+vk, there are numerous cases where such analytical representation of the measurement model is unavailable. Consequently, a data-driven method (trained on historical data) fulfills this function (first data-driven method). Using the estimated data-driven measurement model, state tracking can be performed as usual using the system degradation modelXk=f(Xk−1)+wk. During the state prediction phase, the classical model-based particle filter applies the system degradation model to extrapolate the internal system state. In the proposed fusion prognostics framework, a second data-driven method is utilized at this stage to predict future measurementsYˆk+1=g(Yk,Yk−1,…)+uk+1which are fed back into the particle filter algorithm. Using these predicted “measurements”, the state prediction phase is accomplished in the same way as the state tracking phase and the particles and their weights can be further updated. The case study in Section 3 demonstrated that the proposed fusion prognostics framework significantly improved the RUL prediction accuracy while lowering the uncertainty at the same time, compared to the classical particle filter. This framework can be used in many application where knowledge about the degradation process and historical data is abundant.Two data-driven methods were included in the proposed method fusion framework. One is to use the data-driven method to build a measurement model which was used to establish the mapping from the indirectly measurable internal state to the measurement. The other one was to use a data-driven method, which was trained from historical data, to predict future measurements.•Data-Driven Method for Estimating Measurement Model A measurement model can be generally described as:(1)Yk=h(Xk)+vk,where Ykis the measurement at step k, Xkis the system state at step k, h(·) denotes the measurement model function, andvkis the uncertainty term which generally pertains to model error and training data quality and can be estimated through a large number of simulations. A data-driven method is used to estimate h(·), reflecting the mapping between Ykand Xk.For example, support vector regression (SVR) can be adopted to build the measurement model, i.e. h(·) represents the SVR model. The SVR model was created as an epsilon-SVR with a Gaussian radial basis function kernel k(xi, xj)=exp(−γ∥xi−xj∥2), with γ>0. Historical datasets (ideally run-to-failure tests) can be used for model training; i.e. the vibration level measurements of a roller bearing can be used as training targets and the corresponding internal system state, e.g. crack length, can be used as training instances. Since the precision of the SVR model highly depended on the extent and completeness of the training data (the training data needed to cover the range of testing instances sufficiently), adequate training data samples were important to ensure the model accuracy. Many other data-driven methods, such as adaptive neuro-fuzzy interference system (ANFIS) models [15] and Classification and Regression Tree (CART) [16], can also be used to build the measurement model.Data-driven method for predicting future measurements The prediction of future measurements can be generally described as to build the following model:(2)Yˆk+1=g(Yk,Yk−1,…)+uk+1,whereYˆk+1is the predicted measurements at step k+1, Yk, Yk−1, … are the historical measurements, g(·) is the measurement prediction model, and uk+1 is the noise term. The predicted values served as new “measurements” that were fed into the model-based method (e.g. particle filter) during long-term prediction. Many data-driven methods mentioned in Section 1 can be used to predict future measurements. However, most of these methods require a training phase, which can be computationally intensive, to learn the patterns from historical data. When new data is available, a new training phase is generally necessary to retrain the model in order to adapt to the new dataset. In reality, the training phase cannot be easily done without adequate knowledge of the algorithm unless an adaptation mechanism is well designed with the algorithm.In our case, a similarity-based prediction method, as a variation of the method proposed in [17], was proposed to predict the future measurements. Unlike many other machine learning algorithms, the proposed prediction method does not require a training phase. The method rather searches for the historical datasets for a system that is the most similar to the current measurement series (over time) of the very system under test up to time t. The measurement at time t+Δt is determined by the measurement of the selected system's historical measurements at time t+Δt. Furthermore, each of the historical measurement datasets can be assigned a weight corresponding to the similarity to the measurement series of the system under test. The measurement at time t+Δt is then calculated by the weighted average of all historical measurements at time t+Δt. The similarity between the historical sets of measurements and the current measurements can be defined by a distance measure, e.g. Euclidean or Mahalanobis distance. If a new dataset is available, the algorithm automatically incorporates for the extra dataset and calculates the prediction result. The pseudocode of the similarity-based prediction algorithm is shown in Algorithm 1.Algorithm 1A similarity-based prediction procedureThe model-based method was used to predict the future system state, which can be generally described as follows:(3)Xk=f(Xk−1)+wk,where Xkis the system state at current step k, Xk−1 is the system state at the previous step, andwkis the noise term.Particle filter can be adopted for both system state tracking and prediction. The system degradation was assumed to be a first-order Markov process, i.e. the current state was only dependent upon the last state. Ensuing from the definition of the initial state probability density function (pdf) p(X0), the state probability transition density p(Xk|Xk−1) and the marginal filtering density p(Xk|Y1:k), the latent system state was estimated by the following equations [18]:(4)p(Xk|Y1:k−1)=∫p(Xk|Xk−1)p(Xk−1|Y1:k−1)dXk−1,p(Xk|Y1:k)=p(Yk|Xk)p(Xk|Y1:k−1)p(Yk|Y1:k−1),p(Yk|Y1:k−1)=∫p(Yk|Xk)p(Xk|Y1:k−1)dXk.Since the system equation was nonlinear, it was not obvious to derive the closed-form solution to the recursive Bayesian state estimation problem (Eq. (4)). Sequential Monte Carlo sampling (particle filter) was employed to calculate an approximation of the posterior marginal filtering density p(Xk|Y1:k) by a weighted set of particlesπk1,…,πkM, i.e.(5)p(Xk|Y1:k)≈∑i=1Mπkiδ(Xk−Xki),∑i=1Mπki=1,where M denoted the number of particles and δ was the Dirac delta distribution. When new measurements became available, the weights were recursively updated using importance sampling, i.e. the likelihood of the observation (measurement) given the state of each particle was used for updating:(6)πki∝πk−1ip(Yk|Xki).To avoid the degeneracy problem of the particle filter algorithm (a single particle has a weight of (close to) one while all the other particles have weights of (close to) zero [19]), resampling can be performed in every iteration step (bootstrap particle filter) with systematic resampling scheme. This generic particle filter approach was adapted to the application by identifying the measurement model, the system model and the initial state distribution as well as the noise terms.In summary, the model-based method (e.g. standard particle filter) performed state tracking in parallel with parameter identification of the system model during the state tracking phase when actual measurements were available. The state prediction was accomplished based on the last estimated state by using the system equation (degradation model). The proposed approach was similar to the standard particle filter during the state tracking, however, the state prediction was different. For the state prediction, new “measurements” were provided through a data-driven prediction method. A similarity-based prediction method (trained on run-to-failure datasets) predicted the measurements during the prediction phase to provide new “measurements”. This provided the possibility to update the particle weights during the prediction phase and thus corrected an imperfect model-based degradation model or highly varying measurements at the end of the state tracking phase. Otherwise, the significant prediction error of the internal state can lead to wrong RUL prediction results. The presented fusion framework expanded the framework presented by Liu et al. [18] in the way that a measurement model was introduced, which differed from the canonical representationYk=Xk+vk, i.e. that accounted for those cases, where the internal state was not directly accessible/measurable. Consequently, a model-based method with data-driven prediction of new “measurements” and a data-driven measurement model can gap the bridge between purely data-driven prediction methods that do not account for the physical degradation process, and the model-based method, that only relies on the potentially imperfect degradation model for state prediction.The proposed data-driven and model-based methods fusion framework was applied to a battery degradation case study in order to show the potential benefit of the fusion method.The determination of the state of charge (SOC) as well as the determination and prediction of the state of health (SOH) of batteries plays an increasing role to ensure the reliability and safety of various battery powered and supported devices. The SOC ranges from SOC=0% (empty) to SOC=100% (full) and indicates the current charge level of the battery while being in use. The SOH is a figure of merit to assess the battery's current health state within its life cycle and thus can be used as a precursor for an approaching failure. One of the possibilities to define the SOH is based on the internal battery parameters (e.g. resistance). Fig. 2depicts a lumped parameter battery model for lithium-ion cells. The model parameters change with various aging and fault processes like plate sulfation, passivation, and corrosion [20]. The changes of the internal battery parameters are used to track the battery degradation process and assess the current SOH. The aim of a prognostics approach is to identify and predict the health parameters and give an estimation of the RUL. We identified the batteries’ internal resistance as implied by the lumped parameter model as a suitable health indicator and failure precursor and conducted RUL predictions based on the evolution of this resistance.The proposed fusion framework was applied for RUL predictions of lithium-ion batteries using datasets provided by the Prognostics CoE at NASA Ames [21]. The lithium-ion batteries were run through a sequence of charge, discharge and impedance tests at different temperatures and the capacity as well as the voltage and current curves were measured in each discharging cycle. The selected set of batteries was tested at temperatures of 4°C and 24°C, respectively. Discharging was carried out in a constant current mode (fixed current load) at 2A until the voltage dropped from initial 4.2V to 2.2V, 2.5V and 2.7V, receptively. The tests were repeated until the capacity faded to 1.4Ah and 1.6Ah, respectively (end of life).Although the internal battery resistance was accessible through electrochemical impedance spectroscopy (EIS), the measurement was complex and expensive and thus not always available in industrial applications. Therefore, the internal resistance was derived from the discharge curve logged during each discharge cycle based on the model presented by Luo et al. [22]:(7)E(t)=E0−I(t)(RW(t)+RCT(t)+RE(t)),with(8)RW(t)=α1exp(−α2/t)…Warburgimpedance,RCT(t)=α3exp(−α4t)…chargetransferresistance,RE(t)=α5t+α6…electrolyteresistance,and the open circuit voltage E0.The model considered a lumped parameter model for non-dynamic battery applications and incorporated the three resistances as well as the dual layer capacitance of the battery. The model parameters α1, …, α6 were derived from the discharge curves using nonlinear curve-fitting in the least-squares sense with a trust region algorithm. Since the order of magnitude of the model parameters distinctly varied, it was favorable to supply an analytical expression of the first derivative of the model function rather than a numerical approximation in order to avoid numerical errors. The lower boundary for all parameters to be estimated within the trust region optimization was set to zero in order to constrain the results to physically meaningful values. The six degrees of freedom of the model function resulted in many local minima of the cost functionS=∑i=1N(E(i)−E(t=ti))2. Therefore, an optimization algorithm like simulated annealing that is capable of escaping from local minima and is more likely to find the global minimum can be used to find initial values for the parameters and subsequently perform curve fitting starting with these initial values. The internal battery resistance was eventually calculated by summarizing the resistances RCT and RE at the end of the discharge cycle, i.e. Zk=RCT(tend)+RE(tend). Note that only the voltage and current measured at each discharge cycle were required to estimate the internal battery resistance. While the battery aging proceeded, the internal resistance evolved according to an exponential degradation model [18], which was utilized in the model-based method (particle filter) as described in Section 2.2:(9)Zk=Zk−1exp(Λk−1)+wk,Λk=Λk−1+ωk,Xk=[Zk;Λk],Yk=h(Xk)+vk,where Z denotes the internal battery resistance and Λ denotes the exponential decay parameter (model parameter). Xkis the system state. The noise termswk, ωkandvkare zero mean normal distributions.During the state tracking phase, the battery's capacities were provided as measurements, which necessitated a measurement model (Yk=h(Xk)+wk) that derived the battery's capacity from its internal resistance. Support vector regressions (SVRs) with training on five batteries were adopted to build the measurement model. Datasets of run-to-failure tests from five batteries were used for model training, i.e. the capacities measured for each discharge cycle were used as training targets and the corresponding internal resistances derived from the discharge curves were the training instances (the capacity was measured within the same discharge cycles). The trained SVR model was eventually used to estimate the capacity of the test battery from the internal resistance obtained from particle filter. One major source of uncertainty and potential deviation of the estimated capacity from the real, measured capacity (ground truth) was introduced by the SVR model. It is certainly possible to map the testing resistances with the training database of resistances in the sense of finding the closest resistance (nearest neighbor) from the training data base in terms of a certain distance measure, e.g. Euclidean distance. The corresponding capacity of the selected resistance from the training database of resistances was then the estimated capacity for the testing case. However, this model had the major drawback of possibly non-monotonic outputs for a monotonic set of input (testing) resistances. The trained SVR model overcame this pitfall and yield a smooth, monotonic output for the actual range of training data and a certain interval around it (reserve margins). Hence, the SVR model was preferred especially in those cases where the training data and the corresponding labels were highly varying and a straightforward mapping would introduce inadvertent fluctuations.The similarity-based prediction method as proposed in Section 2.1 was used to predict the future measurements of the battery capacity based on historical measurements. The predicted capacity values served as new “measurements” that were fed into the particle filter algorithm. State prediction was eventually performed in the exact same way as particle filter state tracking/estimation. The similarity measure was chosen as the Euclidean distance in this case and the same historical set of (capacity) measurements as used for the SVR model training was used for similarity-based prediction.The prediction performance of the standard particle filter, a data-driven method, and the proposed fusion prognostics method was evaluated based on an average of 50 RUL estimations for each prediction starting from cycle 25 to the end of life (EOL). The data-driven method used here is similar to the similarity method described in Algorithm 1. Instead of predicting the measurement, we use the algorithm to predict the RUL by weighting the RUL of different dataset based on the similarity of past state degradation pattern. Fig. 3showed an exemplary result of the RUL pdfs for predictions starting at cycle 41. The RUL pdfs were assumed to follow a normal distribution and the corresponding mean (RUL estimation) and standard deviation (confidence boundaries) were derived. The vertical lines indicated the mean values of the RUL pdfs and the real RUL (ground truth), respectively. The RUL pdf of the proposed fusion prognostics method was not only centered closer to the real RUL but also had a smaller standard deviation and hence narrower confidence boundaries. The RUL estimations of the proposed fusion prognostics method, the standard particle filter, and the data driven method were 1cycle early, 4cycles early, and 11cycles late, respectively, and the standard deviations were 7cycles, 20cycles, and 7.23cycles, respectively. The proposed fusion method outperformed the standard particle filter method and the data driven method in terms of both a RUL estimation closer to the real RUL and narrower confidence boundaries.To assess the overall RUL prediction performance, the results for different prediction starting points were shown in Figs. 4–6for the standard particle filter, the data-driven method, and the proposed fusion prognostics method, respectively. The starting point of prediction varied from the 25th cycle up to the 105th cycle (EOL). The mean value and standard deviation were calculated from 50 runs of RUL estimations starting at the 25th cycle until the EOL. Because the data-driven method is deterministic, the mean value and standard deviation were calculated from all the datasets used for prediction. The shaded areas indicated the mean standard deviations that were derived from the RUL pdfs under the assumption of a normal distribution. The light blue area showed the three sigma tolerance interval that covered 99.7% of the RUL pdf at each cycle. The intermediate area showed the two-sigma tolerance interval that covered 95.4% of the RUL pdf at each cycle, and the dark blue area in the center showed the one-sigma tolerance interval that covered 68.2% of the RUL pdf at each cycle, respectively. The dark blue line in the center was the average mean value for each cycle and hence represented the actual estimated RUL. The red line represented the real RUL (ground truth).The following two criteria were used to assess the prediction performance in terms of both prediction accuracy and confidence boundaries. The comparison of the prediction result is shown in Table 1.•Mean absolute error MAE [23]: The mean value of the absolute difference of the predicted and the real RUL was calculated for the particle filter method (MAE=9.8334cycles), the data-driven method (MAE=10.1857cycles), and the proposed fusion prognostics method (MAE=3.3309cycles). The mean absolute errors of the particle filter method and the data-driven method were 295.22% and 305.79% higher than that of the proposed fusion prognostics method, respectively.Mean one standard deviation (one σ) tolerance interval S: The mean value of the one standard deviation tolerance interval ([μ−σ, μ+σ]) was calculated for both the particle filter (S=28.5845cycles), the data-driven method (S=20.9411cycles), and the proposed fusion prognostics method (S=12.5627cycles). The confidence boundaries of the particle filter method and the data-driven method were 227.53% and 166.69% higher than that of the proposed method, respectively. While the RUL confidence boundaries of the standard particle filter method and the data-driven method narrowed with a later starting point of prediction, the proposed fusion prognostics method did not exhibit this behavior since resampling is performed either when degeneration of the particles occurs or after every step (bootstrap particle filter), which led the particles distribute around the most likely state vector and hence narrowed the confidence boundaries.The prognostics performance metrics for both prediction techniques clearly showed that the proposed fusion prognostics method had a superior prognostics performance over either the standard particle filter method or the data-driven method. Not only were the RUL estimations of the proposed method closer to the real RUL, but also did this method narrow the confidence boundaries of the RUL estimations considerably.

@&#CONCLUSIONS@&#
