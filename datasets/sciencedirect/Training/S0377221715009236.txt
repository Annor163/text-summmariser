@&#MAIN-TITLE@&#
A branch-and-cut algorithm for the profitable windy rural postman problem

@&#HIGHLIGHTS@&#
We study a hard arc routing problem with profits.We provide an integer programming formulation for the problem.The associated polyhedron is partially described.We implement a branch-and-cut algorithm based on the partial description.Extensive computational results show that the exact algorithm outperforms existing heuristics in time and quality.

@&#KEYPHRASES@&#
Windy rural postman problem,Arc routing,Profits,Branch-and-cut algorithm,Polyhedron,

@&#ABSTRACT@&#
In this paper we study the profitable windy rural postman problem. This is an arc routing problem with profits defined on a windy graph in which there is a profit associated with some of the edges of the graph, consisting of finding a route maximizing the difference between the total profit collected and the total cost. This problem generalizes the rural postman problem and other well-known arc routing problems and has real-life applications, mainly in snow removal operations. We propose here a formulation for the problem and study its associated polyhedron. Several families of facet-inducing inequalities are described and used in the design of a branch-and-cut procedure. The algorithm has been tested on a large set of benchmark instances and compared with other existing algorithms. The results obtained show that the branch-and-cut algorithm is able to solve large-sized instances optimally in reasonable computing times.

@&#INTRODUCTION@&#
Routing problems with profits have been widely studied in recent years. They deal with situations where the customers to be served are not known a priori but have to be selected from a set of potential customers that have an associated profit that is collected if the customer is served. Basically, they consist of finding one or more routes that (jointly) serve the selected customers in such a way that an objective function of the profit and/or the cost is optimized.If the customers are represented as nodes in a graph we have the so called node (or vehicle) routing problems with profits. In Feillet, Dejax, and Gendreau (2005a) these problems are classified according to their objective functions. A problem is called profitable when it consists of finding a tour that maximizes the difference between the total collected profit and the traveling cost. In the orienteering problem, the objective is to maximize the collected profit with the constraint that the cost of the tour does not exceed a given limit. Finally, in the prize-collecting problem, we look for a minimum cost tour collecting at least a given amount of profit. A good number of papers are available on node routing problems with profits. Among them, we refer the reader to the surveys Feillet et al. (2005a) and Vansteenwegen, Souffriau, and Oudheusden (2011), and the more recent one Archetti, Speranza, and Vigo (2014, chapter 10). In this last paper, several classes of applications that can be modeled by means of a routing problem with profits are presented.Arc routing problems with profits refer to those problems where the customers are represented as arcs and/or edges of a graph. Similarly to node routing problems, they can be classified as profitable, prize-collecting or orienteering arc routing problems (see Archetti and Speranza, 2014, chapter 12). Although the number of published papers on arc routing problems with profits is smaller than for their node routing counterparts, this is a growing area that has recently attracted a good number of researchers that have studied many of its variants.As far as we know, Malandraki and Daskin (1993) were the first authors to study such a problem. They introduced the Maximum Benefit Chinese Postman Problem on a directed graph. In this problem, several profits are associated with each arc, one for each time the arc is traversed with a service, and the objective is to find a tour with maximum profit. In Pearn and Chiu (2005) and Pearn and Wang (2003), some heuristic algorithms for its solution on directed and undirected graphs are proposed, while in Corberán, Plana, Rodríguez-Chía, and Sanchis (2013), the polyhedron associated with the problem defined on an undirected graph is studied and a branch-and-cut algorithm is proposed. Archetti and Speranza (2014, chapter 12) suggest a new name for the Maximum Benefit Chinese Postman Problem more according to the recent classification, the Profitable Rural Postman Problem with Multiple Visits (PRPPMV). We also think it is a more appropriate name. In the Prize-Collecting Arc Routing Problem (also called Privatized Rural Postman Problem) only the edges in a given subset have an associated profit, which can be collected just once. This problem was introduced in Aráoz, Fernández, and Zoltan (2006) and an exact algorithm for solving it on undirected graphs is described in Aráoz, Fernández, and Meza (2009). Note that this problem, which should be called the (Undirected) Profitable Rural Postman Problem (PRPP), is a special case of the PRPPMV when some of the edges have a positive profit while the remaining ones have zero profit. In Schaeffer, Ríos-Mercado, and Fernández (2014), Schaeffer et al. describe an ant-colony heuristic for the same problem defined on a windy graph. Authors call this problem the Windy Prize-Collecting Rural Postman Problem, but, according to Archetti and Speranza (2014, chapter 12), it should be called the Profitable Windy Rural Postman Problem, which is the name we have used in this article.Other arc routing problems with profits with a single vehicle are those studied in Aráoz, Fernández, and Franquesa (2009), Guastaroba, Mansini, and Speranza (2009), Corberán, Fernández, Franquesa, and Sanchis (2011), Vansteenwegen et al. (2011), Aráoz, Fernández, and Franquesa (2013), Black, Eglese, and Wøhlk (2013), Archetti, Guastaroba, and Speranza (2014), Benavent, Corberán, Gouveia, ao, and Pinto (2015), Colombi and Mansini (2014), and Archetti, Corberán, Plana, Sanchis, and Speranza (2015). If multiple vehicles are available, we find the papers Feillet, Dejax, and Gendreau (2005b), Archetti, Feillet, Hertz, and Speranza (2010), Euchi and Chabchoub (2011), Zachariadis and Kiranoudis (2011), Cura (2013), Archetti, Corberán, Plana, Sanchis, and Speranza (2014), and Archetti, Corberán, Plana, Sanchis, and Speranza (2013). The reader is referred to the survey Archetti and Speranza (2014, chapter 12) for more details on the problems described in the above papers.Here we study the Profitable Windy Rural Postman Problem (PWRPP). This problem is a generalization of the well known Rural Postman Problem (RPP), which consists of finding a minimum cost tour in an (undirected) graph traversing at least once all the edges in a subset of required edges. If we consider a windy graph, in which each edge has two costs corresponding to the two directions of traversal, the problem is known as the Windy RPP. If, in addition to the required edges, there is a subset of (required) vertices to be visited, the problem is known as the Windy General Routing Problem (WGRP). Both problems have been extensively studied (see Corberán, Plana, & Sanchis, 2007; 2008; Plana, 2005). Moreover, some real-life applications have been modeled as pure WRPPs or variants. We refer the reader to the recently published book on arc routing problems (Corberán & Laporte, 2014) for more details on this. We just want to mention the recent papers by Dussault, Golden, Groër, and Wasil (2013) and Dussault, Golden, and Wasil (2014) on practical extensions of the WRPP in the context of snow plowing. The first work is motivated by the fact that deadhead travel over streets that have already been plowed is significantly faster than the time it takes to plow the street. Moreover, on some steep streets, it is much more difficult, or impossible, to plow uphill. This problem, called the Plowing with Precedence Problem, differs from most arc routing problems because the cost of traversing a street changes depending on the order of the streets on a route. The second paper deals with the problem of determining a set of routes for snow plows that minimize the maximum route length.While in the WRPP there is a fixed subset of edges that have to be traversed by the vehicle, in the PWRPP the route does not have to traverse any specific subset of edges. Instead, there is a profit associated with some edges that is collected the first time the edge is traversed. The objective is to find the route that maximizes the sum of the profit collected minus the traversal costs. In this article, we first give a precise definition of the problem and model it as an integer program. In Section 3, we study the polyhedron associated with the PWRPP and propose several families of facet-defining inequalities. Section 4 describes the branch-and-cut algorithm we have designed and implemented for the PWRPP solution, while Section 5 presents the computational results obtained on a large set of benchmark instances. Finally, some conclusions are presented in Section 6.The profitable windy rural postman problem can be defined as follows. LetG=(V,E)be an undirected connected graph, where vertex 1 represents the depot and there are two non-negative costs, (cij, cji), associated with each edgee=(i,j)∈E,corresponding to the costs of traversing e from i to j and from j to i, respectively. Moreover, associated with each edge e in a subset EB⊆ E, there is a profit be> 0, which is collected the first time e is traversed (serviced). The objective is to find a closed walk on G, starting and ending at the depot, that maximizes the net profit (the total collected profit minus the total traversal cost).We will use the following notation. Given two vertex sets S, T ⊆ V we define:(S:T)={e=(i,j)∈E:i∈S,j∈Tori∈T,j∈S},δ(S)=(S:V∖S),E(S)={(i,j)∈E:i,j∈S}.The above sets can be referred only to the edges in EBas (S: T)B, EB(S) and δB(S).In order to formulate the problem, we introduce the following variables:•For each edgee=(i,j)∈E,xijand xjidenote the number of times e is traversed from i to j and from j to i, respectively,For each edgee=(i,j)∈EB,yeis a binary variable that takes value 1 if e is serviced and 0 otherwise.Hence, to each closed walk for the PWRPP we associate an incidence vector(x,y)∈Z2|E|+|EB|. In what follows we use the word “tour” to refer to both the closed walk and to its incidence vector. Given F ⊆ E, we definex(F)=∑(i,j)∈F(xij+xji),and given S, T ⊆ V,x(S,T)=∑i∈S,j∈Txij.In particular,x(δ+(S))=x(S,V∖S)andx(δ−(S))=x(V∖S,S)denote the sum of the variables in x ‘leaving’ and ‘entering’ in S, respectively.Then, the PWRPP can be formulated as follows:Maximize∑e∈EBbeye−∑(i,j)∈E(cijxij+cjixji)s.t.:(1)x(δ+(i))=x(δ−(i)),∀i∈V(2)xij+xji≥ye∀e=(i,j)∈EB(3)x(δ+(S))≥ye,∀S⊂V∖{1},∀e∈EB(S)∪δB(S)(4)xij,xji≥0,∀(i,j)∈E(5)0≤ye≤1∀e∈EB(6)xij,xji,yeinteger,∀e=(i,j)∈EEq. (1) are the well known symmetry conditions. Traversing inequalities (2) guarantee that each serviced edge is traversed, while connectivity inequalities (3) force the solution to be connected and connected with the depot. Finally, conditions (4)–(6) assure that variables xijare non-negative and integer and variables yeare binary.Note that the trivial solution (0, 0) is a feasible solution of the above formulation, as well as solutions (x, y) satisfyingxij+xji≥1whileye=0,for an edgee=(i,j)∈EB. This is not possible in an optimal solution (considering be> 0). The formulation also allows feasible solutions (x, y) having some cycles not connected to the depot formed with edges in E∖EBbut, again, these solutions cannot be optimal.Let us denote by PWRPP(G) to the convex hull of all the vectors (x, y) satisfying (1)–(6) above. It is easy to see that PWRPP(G) is an unbounded polyhedron.Theorem 1If G is connected, the dimension of PWRPP(G) is2|E|+|EB|−|V|+1.PWRPP(G) is a polyhedron inZ2|E|+|EB|whose points satisfy the |V| Eq. (1),|V|−1of which are linearly independent. Thus, dim(WGRRP(G))≤2|E|−|EB|−|V|+1holds.Let us consider the WGRP instance defined on G with set of required edges EBand the depot as required vertex. It is known (Corberán, Plana, and Sanchis, 2008, see) that, if G is connected, dim(WGRP(G))=2|E|−|V|+1. Then, there arek+1affinely independent WGRP toursx1,⋯,xk+1,k=dim(WGRP(G)), traversing all the edges in EBand visiting the depot.From these WGRP tours we define the PWRPP tours(x1,0),⋯,(xk+1,0). Moreover, for each e ∈ EB, we define the vector yeasyee=1andyae=0for a ≠ e. Thus, the vector (x1, ye) is also a tour for the PWRPP on G.It can be seen that thesek+1+|EB|tours for the PWRPP on G are affinely independent and, therefore, dim(PWRPP(G))=2|E|+|EB|−|V|+1.□If edge (i, j) ∈ E is not a bridge of G, the inequalities xij≥ 0 (and xji≥ 0) are facet-inducing for PWRPP(G).Consider again the WGRP instance withER=EBand 1 ∈ VR. If (i, j) is not a bridge of G, the inequality xij≥ 0 defines a facet of the WGRP polyhedron (Corberán et al., 2008, see). Therefore, there arex1,⋯,xkaffinely independent WGRP tours (k=2|E|−|V|+1) satisfyingxij=0. Note that if (i, j) ∈ EB, these WGRP tours traverse edge (i, j) from j to i. As before, the vectors(x1,0),⋯,(xk,0)are in PWRPP(G). For each e ∈ EB, we define the vector yeas above. Then, the vector (x1, ye) is also a tour for the PWRPP on G. So, we have2|E|+|EB|−|V|affinely independent tours for the PWRPP on G satisfyingxij=0.□Inequalities ye≥ 0 and ye≤ 1 define facets of PWRPP(G) for all e ∈ EB.The proof is similar to those of the previous theorems and is omitted here for the sake of brevity.□If edgee=(i,j)∈Eis not bridge of G, the inequalityxij+xji≥yeis facet-inducing for PWRPP(G).Consider again the WGRP instance withER=EBand 1 ∈ VR. Ife=(i,j)is not a bridge of G, the inequalityxij+xji≥1defines a facet of the WGRP polyhedron (see Corberán et al., 2008). Therefore, there arex1,⋯,xkaffinely independent WGRP tours (k=2|E|−|V|+1) satisfyingxij+xji=1. For each e ∈ EB, we define the vector yeas before. The vectors(x1,ye),⋯,(xk,ye)are PWRPP tours. For each edge a ∈ EB∖{e}, the vector(x1,ye+ya)is also a PWRPP tour. The above2|E|−|V|+1+|EB|−1tours satisfyxij+xji=ye=1. Finally, as the trivial solution (0, 0) also satisfiesxij+xji=yij,we have2|E|−|V|+1+|EB|−1+1=dim(PWRPP(G)) affinely independent vectors of PWRPP(G) satisfyingxij+xji=yij.□Connectivity inequalities(3)are facet inducing for PWRPP(G), ∀ S ⊂ V∖{1} and  ∀e ∈ EB(S) ∪ δB(S), if graphs G(S) and G(V∖S) are connected.Let S ⊆ V∖{1} such as G(S) and G(V∖S) are connected and let e ∈ EB(S) ∪ δB(S).Let us suppose first thate=(i,j)∈EB(S). In this case we consider the WGRP instance defined on G withER=EB∖δB(S)and 1 ∈ VR. It is known (see Corberán et al., 2008) that connectivity inequalities for the WGRP,x(δ+(S))≥1,are facet inducing if G(S) and G(V∖S) are connected. Therefore, there arex1,⋯,xkaffinely and linearly independent WGRP tours on G satisfyingx(δ+(S))=1,and the PWRPP tours(x1,ye),⋯,(xk,ye)satisfyx(δ+(S))=yeand are linearly independent. For each a ∈ EB∖δ(S), a ≠ e, we define(x1,ye+ya)and we have|EB∖δ(S)|−1additional PWRPP tours. It is shown in Corberán et al. (2008) that, for eacha=(p,q)∈δB(S),there is at least one of the k previous WGRP tours, x1 for example, satisfyingxpq+xpq≥1. Then,(x1,ye+ya)is a PWRPP tour satisfyingx(δ+(S))=ye. Then we havek+|EB∖δ(S)|−1+|δB(S)|=2|E|−|V|+|EB|=dim(PWRPP(G))-1 linearly independent vectors of PWRPP(G) satisfyingx(δ+(S))=yeand, hence, the inequality is facet inducing.Let us suppose now thate=(i,j)∈δB(S). Consider two WGRP instances. The first one is defined on graph G(V∖S) withER=EB(V∖S)and VRincluding the depot and all the vertices incidents with edges in δ(S). The second WGRP instance is defined on graph G(S) withER=EB(S)and VRincluding all the vertices incidents with edges in δ(S).If we consider the first WGRP instance, we can findx11,⋯,x1k1+1(k1=2|E(V∖S)|−|V∖S|+1)affinely independent WGRP tours on G(V∖S), and we can assume that k of them, sayx11,⋯,x1k1,are linearly independent. After completing them with zeros for the edges in E∖E(V∖S), the resulting vectors can be considered closed walks in G. Then,(x11,0),⋯,(x1k1,0)are PWRPP tours on G satisfyingx(δ+(S))=0=ye. Furthermore, we will also consider the tour resulting from completingx11with zeros, traversing edge e once in each direction, and adding vector ye.For the second WGRP instance, there arex21,⋯,x2k2+1(k2=2|E(S)|−|S|+1)affinely independent WGRP tours on G(S), and again we can considerx21,⋯,x2k2to be linearly independent. If we combinex11with eachx2i,i=1,⋯,k2,we add edge e traversed once in each direction, and add vector ye, we obtain k2 PWRPP tours satisfyingx(δ+(S))=ye=1.Associated with each a ∈ EB(V∖S), we define(x11,ya). For each a ∈ EB(S) we combinex11withx21,we add edge e traversed once in each direction, and add the vectorye+ya. Finally, for each a ∈ δ(S)∖{e} we define the following two or three tours:1.We combinex11andx21and we add a cycle traversing the cutset δ(S) exactly once in each direction, using edge e from V∖S to S and edge a from S to V∖S. Then we add vector ye, thus obtaining a PWRPP tour satisfyingx(δ+(S))=ye.We combinex11andx21and we add a cycle traversing the cutset δ(S) exactly once in each direction, using edge a from V∖S to S and edge e from S to V∖S. Then we add vector ye, thus obtaining a PWRPP tour satisfyingx(δ+(S))=ye.If a ∈ δB(S), we define a third tour by choosing one of the previous two tours and adding ya.If we express all these tours as rows in a matrix, we obtain the matrix in Fig. 1, whereOrepresents a null matrix,Idenotes the identity matrix and an * symbol denotes a submatrix that does not need to be specified. This matrix hask1+1+k2+|EB(V∖S)|+|EB(S)|+2|δ(S)|−2+|δB(S)|−1=2|E|+|EB|−|V|rows and it can be seen that the matrix is full rank. Therefore we have dim(PWRPP(G))−1 linearly independent tours satisfying the inequality as an equality and hence connectivity inequalities (3) are facet-inducing.□Given an edge cutset δ(S), consider F ⊆ δB(S) with |F| odd. Since any tour must cross any given cutset an even number of times, the parity inequalityx(δ(S))≥2y(F)−|F|+1is valid for the PWRPP. The following theorem proves that parity inequalities are also facet-inducing for PWRPP(G).Theorem 6Parity inequalities(7)x(δ(S))≥2y(F)−|F|+1∀S⊂V,∀F⊆δB(S),|F|oddare facet-inducing for PWRPP(G) if graphs G(S) and G(V∖S) are connected.Consider a WGRP instance whereER=EB(S)∪EB(V∖S)∪Fand the depot is a required vertex. Since δ(S) contains an odd number of required edges (those in F), the R-odd cut inequalityx(δ(S))≥|F|+1defines a facet of the WGRP polyhedron (see Corberán et al., 2008). Therefore, there are k affinely independent WGRP toursx1,…,xksatisfyingx(δ(S))=|F|+1. From them, we define the PWRPP tours(x1,yF),…,(xk,yF),where yFis the incidence vector of the edges in F, that satisfyx(δ(S))=|F|+1=2y(F)−|F|+1.For eache=(i,j)∈EB(S)∪EB(V∖S),we define(x1,yF+ye),which also satisfiesx(δ(S))=|F|+1=2y(F)−|F|+1.Given an edge e ∈ δB(S)∖F, it can be seen that there is a WGRP tour, that will be called xe, traversing the edge e at least once and satisfyingxe(δ(S))=|F|+1. Hence,(xe,yF+ye)will be a vector for the PWRPP satisfyingx(δ(S))=|F|+1.For any edge e ∈ F, since |F∖{e}| is even, it is possible to find a WGRP tour in G that traverses cutset δ(S) exactly|F|−1times using exactly once each edge in F∖{e}. This tour is completed withyF−yeto obtain a PWRPP tour satisfyingx(δ(S))=|F|−1=2(|F|−1)−|F|+1.We must prove that the incident vectors of the above|E|−|V|+1+|EB|tours are affinely independent. If we express them as the rows of a matrix, we obtain the first matrix in Fig. 2, where a block with 1 in it represents a submatrix with all its entries equal to 1. By subtracting the first row from all the other rows, we obtain the second matrix in Fig. 2, which is full rank. Therefore, we have|E|−|V|+1+|EB|tours affinely independent satisfyingx(δ(S))=2y(F)−|F|+1.□K–C inequalities were introduced in Corberán and Sanchis (1994) for the undirected RPP. In this section we generalize them to the PWRPP.A K–C inequality is defined by a partition of V intoK+1sets{M0,M1,M2,…,MK−1,MK},with K ≥ 3. Let F ⊆ (M0: MK)Bbe such that |F| is an even number greater than or equal to 2.For eachi∈{1,⋯,K−1}we assume that either Micontains the depot or there is an edge ei∈ EB(Mi). Let H denote to the set of such edges ei. We call(8)F(x)=∑(i,j)∈Abijxij≥c0,a K–C inequality, where the coefficients arebij={K−2if(i,j)∈(M0:MK)|r−s|if(i,j)∈(Mr:Ms),{r,s}≠{0,K}0otherwise,and c0 is given by:c0={(K−2)(2y(F)−|F|)+2y(H),ifthedepotisinMKorM0(K−2)(2y(F)−|F|)+2y(H∖{ej})+2,ifthedepotisinMj.Theorem 7K–C inequalities(8)are valid for PWRPP(G).Let us suppose that the depot is in M0 ∪ MK. The proof for inequalities with the depot in any other Miis similar. If a tour traverses all the edges in F ∪ H, theny(H)=K−1,y(F)=|F|and the right-hand side of inequality (8), c0, is2(K−1)+(K−2)|F|. In this case, the tour must traverse the edges in F (with a cost, at least, of(K−2)|F|) and visit the setsM1,M2,…,MK−1(with a cost, at least, of2(K−1)) andF(x)≥2(K−1)+(K−2)|F|holds.If the tour traverses all the edges in H except one of them and all the edges in F, then it must visit the setsM1,M2,…,MK−1except, perhaps, one of them (with a cost, at least, of2(K−2)) andF(x)≥2(K−2)+(K−2)|F|holds. Note that, in this case,2(K−2)+(K−2)|F|is the right-hand side of (8).If the tour traverses all the edges in F except one of them and all the edges in H, theny(F)=|F|−1and the right-hand side of the inequality (8) is2(K−1)+(K−2)(|F|−2). In this case the tour must traverse the|F|−1edges it services in F at least once (with a cost, at least, of(K−2)(|F|−1)) and visit the setsM1,M2,…,MK−1. Given that|F|−1is odd, the cheapest way to visit them, with a cost K, is to begin in M0, then M1, M2, and so on until MK. Hence,F(x)≥K+(K−2)(|F|−1)=2(K−1)+(K−2)(|F|−2).It is easy to see that the inequality is also satisfied when the tour traverses any other number of edges in F ∪ H.□The K–C inequalities are facet-inducing for PWRPP(G) if•The induced graphs G(Mi),i=1,…,K−1and G(M0 ∪ MK) are connected, and(Mi:Mi+1)≠∅,i=0,..,K−1.As above, let us suppose that the depot is in M0 ∪ MK. In this case, the K–C inequality isF(x)≥(K−2)(2y(F)−|F|)+2y(H).Consider a WGRP instance whereER=F∪Hand the depot is a required vertex. It can be seen that all the conditions for the corresponding K–C inequalityF(x)≥(K−2)|F|+2(K−1)to be facet-inducing for the WGRP polyhedron (Corberán et al., 2008, see) hold. Then, there arek=|E|−|V|+1affinely independent WGRP toursx1,…,xksatisfyingF(x)=(K−2)|F|+2(K−1). Now we define the PWRPP tours(x1,yF∪H),⋯,(xk,yF∪H),where yF ∪ His the incidence vector of the edges in F ∪ H. All of them satisfyy(F)=|F|,y(H)=|H|and, hence,F(x)=(K−2)(2y(F)−|F|)+2y(H).We construct |EB| additional PWRPP tours satisfying the K–C inequality as an equality as follows: for each edge e ∈ EB∖F ∪ H, it can be seen that there is a tour xesatisfyingF(xe)=(K−2)|F|+2(K−1)and traversing e. Then(xe,yF∪H+ye)is a PWRPP tour satisfying the K–C inequality as an equality.For each edge e ∈ F, it can be seen that there is another tour xeon G traversing all the edges in H ∪ F∖{e} that does not traverse e and satisfiesF(xe)=(K−2)(|F|−1)+2(K−1). Then(xe,yF∪H−ye)is a PWRPP tour satisfying the K–C inequality as an equality.For each edge e ∈ H, it can be seen that there is another tour xeon G traversing all the edges in F ∪ H∖{e} that does not traverse e and satisfiesF(xe)=(K−2)|F|+2(K−2). Then(xe,yF∪H−ye)is a PWRPP tour satisfying the K–C inequality as an equality.Then, we have a total of|E|−|V|+1+|EB|PWRPP tours satisfying the K–C inequality as an equality. If we express them as rows in a matrix, we obtain the matrix in Fig. 3. After subtracting the first row from the remaining ones, we obtain a matrix with rank|E|−|V|+|EB|,which proves the result.□In this section we present a branch-and-cut algorithm that uses separation algorithms for connectivity, parity, and K–C inequalities, and a heuristic algorithm to obtain a lower bound.To obtain lower bounds that can help prune the branch-and-cut tree, we have implemented a simple heuristic based on the optimal solutions provided by the LP relaxations.Consider the fractional LP solution x* obtained at a certain node of the branch-and-cut tree. From the values of x*, we construct the following graph G*: for each (i, j) ∈ EBsuch thatxij*≥0.7,we put⌈xij*⌉copies of arc (i, j) in G*. In addition, ifxij*,xji*<0.7butxij*+xji*≥0.7andbij≥cij+cji,we add one copy of the arc (i, j) or (j, i) associated with the maximum value ofxij*andxji*. For each (i, j) ∈ E∖EBwe put⌈xij*−0.7⌉copies of arc (i, j) in G*.We solve a minimum cost flow problem on G* to obtain a symmetric graph. If the number of connected components is four or lower, we add the arcs of some shortest paths in G connecting them. If the number of connected components is greater than four, we use an alternative strategy starting again from graph G*. Before making G* symmetric, we connect its connected components by means of a minimum cost directed spanning tree. Then the resulting graph is made symmetric by means of a minimum cost flow.The graph obtained in this way gives a vector with the values of the x variables, which is completed withye=1for each edgee=(i,j)∈EBsuch thatxij+xji≥1. In this way we obtain a PWRPP solution that provides a lower bound for the exact procedure.In this section, we present the separation algorithms that have been used to identify the inequalities that are violated by the current LP solution at any iteration of the cutting plane algorithm.Given an LP solution(x¯,y¯),we define its associated weighted graphG¯=(V,E,x¯),wherex¯e=x¯ij+x¯jiis the weight associated with each edge e ∈ E. This weighted graph is the input to the separation procedures to find K–C and connectivity inequalities violated by(x¯,y¯).It is not known if the problem of separating K–C inequalities can be solved in polynomial time or not, but our guess is that this problem isNP-hard. Given the support graphG¯,we label the depot and the edges e ∈ EBsuch thaty¯e>1−γas ‘required’, where γ is a given parameter. We then apply the heuristic algorithm described in Plana (2005) for the WGRP to obtain the setsM0,M1,M2,⋯,MK. Set F is formed by the edges in M0 ∪ MKlabeled ‘required’. If 1 ∈ M0 ∪ MK, for each set Mj,j=1,…,K−1,we select the edge ej∈ EB(Mj) with maximum y value and defineH={e1,e2,⋯,eK−1}and check the corresponding inequality (8) for violation. On the other hand, if 1 ∈ Mi, i ≠ 0, i ≠ K, we define the set H as above except for edge ei, and check the corresponding inequality (8) for violation. If no violated inequality is found, we try to shrink the K–C configuration by merging some sets Mj. Several values for γ have been tried. After some computational testing, we finally decided to setγ=0.2.It is well-known that connectivity inequalities (3) can be exactly separated. For each edge e ∈ EB, such thaty¯e>0,compute the minimum cut in graphG¯separating edge e from the depot. If the weight of this cut is less than2y¯e,then the corresponding inequality (3) is violated (see Belenguer and Benavent, 1998 for details).Since the above exact algorithm is quite time consuming, we have also used a simple heuristic consisting of computing the connected components of a graph constructed asG¯,but including only those edges e ∈ E such thatx¯e>ɛ. For each connected component of this graph that does not include the depot, inequality (3) is checked for the set S of nodes in the component and the edge e ∈ EB(S) with maximum value ofy¯e. The procedure is applied with the values ofɛ=0,0.25,0.5,and 0.75.Parity inequalities (7) can be exactly separated with a polynomial algorithm similar to the one proposed by Padberg and Rao (1982) (see the details in Benavent, Corberán, & Sanchis (2000)) or with the more efficient algorithm proposed by Letchford, Reinelt, and Theis (2004). However, these procedures are quite time consuming, and thus we have not used them. Instead, we have implemented a fast and simple heuristic that works as follows. First we build the graph G′ induced by the edges in EBfor whichx¯e−y¯e>βand those edges in E∖EBfor whichx¯e>β. Then we compute the connected components of this graph. For each of these cutsets, we determine the subset F ⊆ δB(S) of odd cardinality as follows. For each e ∈ δB(S), we include e in F ify¯e≥0.5. If |F| is odd, we are done, otherwise, a simple check can determine the edge to be removed from or added to F. Then, the corresponding inequality (7) is checked for violation. This heuristic is applied forβ=0,0.25,and 0.5.The initial LP relaxation contains symmetry Eq. (1), traversing inequalities (2), and trivial inequalities (xij≥ 0 and 0 ≤ yij≤ 1). At each iteration of the cutting plane algorithm the separation procedures are called in the following order and the violated inequalities found are added to the LP relaxation.1.Connectivity separation heuristic withɛ=0,0.25,0.5,0.75. A value of ε is tried only if no violated inequalities have been found with the previous value.Parity separation heuristic algorithm withβ=0,0.25,0.5. Again, a value of β is tried only if no violated inequalities have been found with the previous value.Exact connectivity separation if the corresponding heuristics have failed.Heuristic algorithms for separating K–C inequalities if no violated connectivity inequalities have been found.The above cutting plane procedure is applied at each node of the search tree until no new violated inequalities are found. When this happens we branch, using the Strong Branching strategy Applegate, Bixby, Chvátal, and Cook (1995) implemented in Cplex. Priority in the selection of branching variables is given to y variables based on preliminary computational experience.The heuristic algorithm for finding feasible solutions is executed at the end of the ten first nodes of the branch-and-cut tree. After that and until node 50, it is executed only once every two nodes. From node 50 on, it is executed only once every ten nodes.In this section we present the computational results obtained with the proposed branch-and-cut algorithm on a large set of instances. The procedure has been coded in C/C++ using the Cplex 12.6 MIP Solver with Concert Technology 2.9 on a single thread of an Intel Core i7 at 3.4 Gigahertz with 16 Gigabyte RAM. Cplex heuristic algorithms were turned off. The optimality gap tolerance was set to zero, and strong branching (Applegate et al., 1995) and the best bound strategies were selected. All the experiments were carried out with a time limit of one hour.As far as we know, the only paper dealing with the PWRPP is the one by Schaeffer et al. (2014). In this paper, authors report computational results on instances with asymmetric costs (pure windy instances) and others with symmetric costs (which would correspond to the undirected Profitable Rural Postman Problem, PRPP).There are two families of instances with symmetric costs. The first family of instances, denoted as Set1, corresponds to those proposed in Aráoz et al. (2009) which are based on 118 well known Rural Postman Problem and General Routing Problem benchmark instances divided in five groups. The first group contains two problems obtained from the Albaida (Spain) graph (see Corberán & Sanchis, 1994). The second group contains the 24 instances (labeled P) of Christofides, Campos, Corberán, and Mota (1981). The last three groups contain instances (labeled D, G and R) from Hertz, Laporte, and Nanchen (1999). Table 1depicts information on these instances, that have been grouped according to their characteristics and to their sizes. The cost of the edges is the same as in the original RPP instance. The profits have been randomly generated in the interval [ce, 3ce] if e is a required edge, and in [0, ce] if e is non required.The second family of instances with symmetric costs, Set2, was generated from 40 GRP instances. The profits of these instances were randomly generated in [ce, 3ce] for the required edges, while it is 0 for the non-required ones. The characteristics of these instances are reported in Table 2.The instances with asymmetric costs, Set3 and Set4, correspond to the same instances in Set1 and Set2 but modified by Schaeffer et al. in order to get asymmetric costs.We have compared the results obtained with our branch-and-cut algorithm with those obtained by Schaeffer et al. (2014) with their ant-colony heuristic on these four sets of instances. Furthermore, when the costs of the edges in the graph are symmetric, the PWRPP reduces to the PRPP (also called Prize-Collecting RPP in Aráoz et al. (2009)), which is a special case of the Profitable RPP with Multiple Visits (or MBCPP in Corberán et al. (2013)). Therefore, for the symmetric instances in Set1, we have been able to compare our results with those published in Aráoz et al. (2009) and in Corberán et al. (2013).Table 3 reports the computational results obtained by the ant-colony heuristic described in Schaeffer et al. (2014) (denoted SRF), our exact algorithm (denoted ACPS), and the branch-and-cut algorithm in Corberán et al. (2013) (denoted CPRS) on the instances of Set1. It also reports the results obtained by the exact procedure proposed in Aráoz et al. (2009) (denoted AFM) on the equivalently generated instances described in that paper. The instances used to test the AFM algorithm are not exactly the same as those used with the other procedures. The underlying graphs are the same, but the profits, although generated with the same strategy, may differ. However, we think that they are similar enough to be used to compare the results.All the instances were solved to optimality by the three exact procedures. Columns labeled “#inst” and “#opt” show the number of instances in each group and the number of optimal solutions found by the SRF heuristic. The heuristic was ran ten times for each instance and the best solution found is used to compute the average values given in the column “Heur. Sol.”. The average of the optimal solutions in each group is reported in column “Optimum”. Finally, the last four columns show the average time, in seconds, employed by the heuristic and the three exact procedures. The times of the heuristic corresponds to only one execution of each instance. Note that these times correspond to different machines. The SFR algorithm was ran on a MacBook Pro laptop, the ACPS algorithm was ran on an Intel Core i7 at 3.4 Gigahertz with 16 Gigabyte RAM using only one core, while CPRS was executed on an Intel Core 2 at 2.40 Gigahertz and 2 Gigabyte RAM. The times from the AFM algorithm were obtained with a much slower machine (Sun ULTRA 10 at 440 Megahertz, 1 Gigabyte RAM).Tables 4show the results obtained on the instances of Set2, Set3, and Set4, respectively. Again, our algorithm has been able to find the optimal solution on all the instances of these families in very short computing times. As before, the results reported for the heuristic algorithm have been calculated using the best one out of ten runs. Note that these instances seem to be easy for our branch-and-cut algorithm. Indeed, the instance that took the longest to be solved to optimality was “Madr_3_1”, that took 24 seconds.Additionally, we have generated two last sets, Set5 and Set6. Set5 instances have been generated from WRPP instances described in Corberán et al. (2007). The profits have been randomly generated in the interval [u, 3u), where u is a value computed in the three different ways suggested in Schaeffer et al. (2014):•u=min{cij,cji},u=(cij+cji)/2,andu=max{cij,cji}.Therefore, we have three different PWRPP instances associated with each original WRPP instance. However, after executing our algorithm on all of them, we have not observed any significant difference between the three sets, and therefore we will report only the results corresponding to the instances whose profits have been generated with the second strategy. The characteristics of these instances can be seen in Table 7.Since there are no larger WRPP instances available, instances in Set6 have been generated from 8 larger ones of the Windy Postman Problem (WPP) presented in Corberán et al. (2013). Given a WPP instance, each edge is assigned to set EBwith probability p ∈ {0.25, 0.5, 0.75}. The profit for each edge is randomly chosen in [u, 8u] ifp=0.25,in [u, 4u] ifp=0.5,and in [u, 3u] ifp=0.75,whereu=(cij+cji)/2again. These intervals have been chosen in order to ensure that the instance has solutions with positive net profit. For each WPP instance, we have generated one instance with each value of p. The characteristics of these instances can be found in Table 8.All the PWRPP instances presented in this paper and their optimal solutions (or best solution found), as well as the original instances from which they were generated, are available at, Corberán Plana, and Sanchis.The algorithm solved all the instances in Set5 but one to optimality in the time limit of one hour. The results obtained are shown in Table 9, where column “Gap0” gives the average gap between the upper bound at the end of the root node and the optimal solution, while column “Nodes” reports the average number of nodes in the branch-and-cut tree. These two columns, as well as the average time column, report the data only for the optimally solved instances. The only unsolved instance was instance D421, for which we obtained an upper bound at the root node of 6596.83, a final upper bound after 965 nodes of 6528.04, and a best solution of 5347. It can be seen that the upper bounds at the root node are very close to the optimal values, which shows that the polyhedral description is tight. This leads us to thinking that the difficulty with the unsolved instance D421 was that the algorithm was not able to find a good feasible solution.The performance of the algorithm was not that good on instances of Set6. These instances are larger, with 1500 vertices and up to 4656 edges, and were generated with the aim of finding the limits of the branch-and-cut procedure. As it can be seen in Table 10, only 8 out of 24 instances could be solved to optimality in one hour. Nevertheless, the gap at the root node does not exceed 1.6 percent except for the instances of subset WB153, which are less dense. Two instances in particular are specially difficult. The algorithm does not finish the cutting-plane procedure at the root node in one hour, and the gaps are 9.2 percent and 16.6 percent. Although we are not completely sure, we suspect again that these gaps are large because we do not have good feasible solutions. In addition to the information given in previous tables, Table 10 also reports the final gap (column ‘Gap’), which is the average gap of the instances that were not solved to optimality.In order to check the contribution of the heuristic algorithm described in Section 4.1, we have run the branch-and-cut algorithm without this procedure on the instances of Set6. The results are given in Table 11. The values reported in columns ‘Gap0’ and ‘Gap’ have been computed using the best solution found for each instance (which is always obtained by the version of the branch-and-cut that uses the heuristic algorithm). As it can be seen, the number of optimal solutions obtained reduces from 8 to 6, and the number of instances where no feasible solution was found after an hour of computing time is 17 out of 24 (column ‘No feas.’). This shows that the contribution of the heuristic algorithm is crucial in order to solve optimally or approximately large-size PWRPP instances. The remaining data in Table 11 show no significant difference with respect to those shown in Table 10.

@&#CONCLUSIONS@&#
Routing problems with profits consist of designing vehicle routes in situations where the customers can be served or not depending on an associated profit that is collected only if the customer is served. These problems are being increasingly studied because of the large number of applications that new technologies are enabling.In this paper we have proposed a formulation for the profitable windy rural postman problem, studied its associated polyhedron, and designed and implemented a branch-and-cut algorithm for its solution that has been tested on a large set of benchmark instances. From the computational results obtained, we can conclude that the proposed algorithm is capable of optimally solving instances with up to 1000 vertices efficiently, and even some instances with 1500 vertices, in reasonable computing times, outperforming existing heuristics in time and quality.Some things that could be tried in order to be able to solve larger instances are: obtaining new valid inequalities, improving the heuristic algorithm to find better feasible solutions and designing more efficient separation algorithms for some of the inequalities described in this paper. Finally, we think that the study and resolution of this problem when a fleet of vehicles is available would be very interesting, specially considering the possible practical applications of this problem.