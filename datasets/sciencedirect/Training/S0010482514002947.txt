@&#MAIN-TITLE@&#
Fast generation of T2⁎ maps in the entire range of clinical interest: Application to thalassemia major patients

@&#HIGHLIGHTS@&#
Fast generation of T2⁎ maps achieved by the weighted linear fitting of the logarithm of the signal (WLSL) method.Automatic truncation of signal decay curves allowed the extension of the WLSL method to the whole clinical range of T2⁎ values.Validation performed on synthetic images and on 60 thalassemia major patients with different levels of myocardial iron overload.

@&#KEYPHRASES@&#
T2⁎ mapping,Iron overload,Relaxometry,Magnetic resonance imaging,Thalassemia,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Quantitative assessment of the tissue relaxation time has several applications in magnetic resonance imaging (MRI) [1], including the detection of superparamagnetic iron oxides [2] and the characterization of myocardial tissue in several pathologic conditions such as myocardial edema [3]. Inverse correlation between T2 and T2⁎ values and the iron content was fully demonstrated [4,5], and T2⁎ relaxometry represents the only widely available, non-invasive methodology for cardiac, hepatic, and pancreatic iron overload (IO) assessment in patients with primary or secondary hemochromatosis [6–8]. To calculate the relaxation time, the MRI signal is monitored by acquiring images at several echo times (TEs) and the measured signal decay is fitted to a mathematic model.Two main approaches have been proposed to fit the signal decay to the model: region-of-interest (ROI) approach and pixel-wise approach. In the ROI-based fit, the signal values of all the pixels within a ROI are averaged for each TE and the fitting is performed on the averaged decay curve, leading to a single relaxation time value taken as representative of the whole ROI. The procedure can be iterated among several ROIs to assess the spatial distribution of the T2/T2⁎ values, such as in the eight liver segments [9] or in the 16 left ventricle (LV) wall segments to obtain standardized LV segmentation [10,11]. The main advantage of the ROI-based approach is the increase of the signal-to-noise (SNR) ratio of the decay curve that improves the fitting quality. Moreover, as one or few fitting operations are performed, the processing time is low and the fitting quality can be visually assessed by plotting the decay curve together with the model.In the pixel-wise approach, the fitting is performed on the signal decay curves extracted from each pixel, yielding a complete relaxation time map. The obtained map allows for the visualization of the T2/T2⁎ distribution with the same spatial resolution of the acquired images. To obtain a relaxation time measurement from a defined district, a ROI is defined on the map and the T2/T2⁎ value of the ROI is obtained by computing the mean or the median of the T2⁎ values inside the ROI. In the pixel-wise approach, the T2/T2⁎ variations can be assessed with pixel-size resolution, exposing focal areas of artifact or pathology that might be missed using a ROI-based approach. The primary drawbacks of the pixel-wise approach are that it is computationally intensive, as the fitting operation must be performed for each pixel, and that the signal-to-noise (SNR) ratio for each individual decay curve is relatively poor. The difference in measurements performed by the ROI-based and pixel-wise approaches was demonstrated to be clinically irrelevant if the same signal decay model is adopted [12–14].The simplest decay model adopted in the relaxation time computation is a pure exponential decay. The adoption of this model overcomes some of the drawbacks of the pixel-wise approach, allowing for the direct computation of the relaxation time value by a linear fitting of the logarithm of the signal [15]. The use of a simple two-parameter model also improves the convergence of the fitting algorithm in presence of a low SNR. However, the single exponential decay model is adequate only if the SNR is high enough at all TEs to neglect the background signal associated with the MR noise [16]. This condition is generally satisfied in quantitative T2 studies, as the T2 value in tissues is typically large. In T2⁎ relaxometry, at low T2⁎ relaxation times the signal at later TEs may collapse on the background MR signal, leading to a large T2⁎ overestimation error [12,13]. Two main approaches were proposed in the literature to address this issue. The first approach (truncation model) consists of manually limiting the mono-exponential equation to few echo times [17]. The second approach consists of a non-linear fitting of the signal to an exponential plus a constant offset model that compensates for the noise plateau [12]. A more recent study includes the Rician distribution of the MRI noise in the fitting model. The method could improve the fitting procedure performance when the noise component is dominant, as in liver images of patients with severe iron overload [18]. Truncation and offset models were well validated in ROI-based analysis, but they present important issues in T2⁎ map generation as the manual truncation of the pixel-related decay curves is impractical due to the number of curves to be processed and the need for the non-linear fitting of the pixel-wise decay curves will dramatically increase the processing time. In this study we propose a method for T2⁎ map generation that exploits a linear fitting algorithm with automatic truncation of later TEs for low T2⁎ values. The method was validated on a generated synthetic phantom mimicking real MR data and on thalassemia major patients with different levels of iron overload.Images from 60 patients (34 males, age 29.4±6.8 yrs) enrolled in the Myocardial Iron Overload in Thalassemia (MIOT) network [6,19] were retrospectively analyzed. The study was approved by the local ethics committee and have therefore been performed in accordance with the ethical standards laid down in the 1964 Declaration of Helsinki and its later amendments. All patients involved gave their informed consent prior to their inclusion in the study.Cardiac MR acquisition followed a previously published protocol [6]. Briefly, multislice multiecho T2⁎ MR was performed using a 1.5-T MR scanner (General Electric Healthcare, Waukesha, WI) at the MIOT network core-lab. An eight-element cardiac phased-array receiver surface coil was used for signal reception. Three parallel short-axis views (basal, middle, and apical) of the left ventricle were obtained by a T2⁎ GRE, ECG triggered, multiecho sequence [10]. Each single short-axis view was acquired at ten echo times (2.0–22ms, with an echo spacing of 2.26ms) in a single end-expiratory breath hold to ensure image alignment. The acquisition time covered the end-diastolic phase, which was when the heart motion can be negligible. The image analysis procedure employed in the MIOT network (HIPPO MIOT software) [10] involved the calculation of segmental T2⁎ values in the left ventricle wall following the AHA 16-segments standardization [20]. The global heart T2⁎ value was obtained by averaging all segmental T2⁎ values and the T2⁎ value in the mid-ventricular septum was obtained by averaging T2⁎ values in the mid-anterior septum and the mid-inferior septum. Segmental T2⁎ values were calculated by ROI-based analysis and fitted to a pure exponential model with manual truncation. On the basing of the global T2⁎ value, three groups of 20 thalassemia major patients each were identified using the T2⁎ value thresholds adopted in clinical practice [21]: patients with no myocardial iron overload (MIO) (global T2⁎ value >20ms), patients with mild to moderate MIO (global T2⁎ value between 20 and 10ms), and patients with severe MIO (global T2⁎ value <10ms).As the true relaxivity value in tissues is generally unknown, a synthetic phantom was developed in order to assess the accuracy of the algorithm examined in this study. The synthetic phantom was composed by a sequence of images mimicking real signal intensities of myocardial tissue at different TEs using the patients’ data set involved in the study as base of knowledge for the realization of the model. To generate the sequence, each pixel in the image was characterized by its T2⁎ value and S0 value, where S0 was defined as the theoretical MR signal value at TE=0. The S0 value was randomly drawn from a Gaussian distribution with the mean and standard deviation (SD) inferred from measurements on real MR images of the patients. Signal decay in tissues was modeled by a pure exponential: S=S0 exp (–TE/T2⁎) and sampled at N echo times. Generalized Rician noise was simulated for an 8-channel coil, with noise statistics inferred from measurements in the background of MR images of the patients [22]. The resulting signals were approximated to the nearest integer value to meet the DICOM format specifications used in real MR images. Hence, the developed phantom was able to simulate realistic decay curves dependent upon imposed T2⁎ and image background SD values.The process for T2⁎ map computation is schematized inFig. 1. The relaxation time map computation follows an iterative process and includes three main steps. At the beginning of the procedure, each image pixel is classified as “in process” and the related signal decay curve is extracted (Fig. 1a). In the first step (background filtering, Fig. 1b), a procedure described in the following tests if the pixel should be classified as a background pixel (i.e., a pixel without a significant MR signal) or not. The background pixels are marked as “background pixels”, a conventional T2⁎ value (e.g., 0) is written in the T2⁎ map, and are no further processing occurred. If the pixel is not classified as background, then step 2 is executed (Fig. 1c). The relaxivity value of the pixel is then computed, exploiting the whole range of the TE samples, by fitting the decay curve extracted from the pixel with an appropriate model and by computing the fitting error (Fig. 1d). A threshold (Emax) for the fitting error is defined and, based upon the fitting error, the pixel is classified as “processed” (if the fitting error is below Emax) or it then remains in the “in process” state (if the fitting quality is unacceptable). If the “processed” state is reached, the T2⁎ value of the pixel is written in the T2⁎ map (Fig. 1e). If the pixel is still “in process”, the last TE sample is excluded and the relaxivity value computation is performed again (Fig. 1f). The procedure is iterated until the fitting error becomes lower than the Emaxvalue (the pixel state moves to “processed” and the T2⁎ value is added to the map) or the number of used TEs is equal to three. If the pixel is still in the “in process” state at the end of step 2, then step 3 is executed (Fig. 1g) to assign a relaxivity value at the pixel (i.e., the “best” T2⁎ value depending upon the fitting error that will explained in the following).After the step 1, the “in process” pixel set will correspond to the “non-background” pixels. At the end of the iterative procedure, all non-background pixels will have a relaxivity value assigned.The objective of the first step is to exclude background pixels from the computation of the relaxivity map. The signal of the background pixel is dominated by noise, so it would be expected to be low and piecewise linear among the TEs. In these pixels, the fitting operation would fail, as the signal does not follow the decay model, and unpredictable values would be generated. Hence, background pixels should be excluded from the computation of the relaxivity map to save computation time and to improve the final map appearance. A conventional value (e.g., 0) is assigned to the background pixel depending upon the color map used in the visualization. To exclude background pixels, an appropriate thresholdSthis defined and a pixel is classified as background if the maximum value of the MR signal among TEs is belowSth:(1)maxiS(TEi)≤Sthwhere i=1,…,N and N is the number of TE samples. To defineSth, it should be noted that the signal in the image background will assume values following a Rayleigh distribution [16,23] determined by the image noise σ:(2)f(S;σ)=Sσ2e−S2/2σ2,S≥0,hence, the signal thresholdSththat assures a P=0.01 probability to exclude a pixel outside the “no signal” areas of the image results in:(3)Sth=σ2ln(100)σ can be estimated from the standard deviation (SD) of the MR signal measured in the image background σbk, as σ=k×σbk, where k is a factor dependent on the coil geometry [22]. The value of k reaches the maximum for a single coil acquisition system (k=1.56) and decreases with the number of coils (k=1.42 for a 32 coils array). To evaluate σbk, an “SD map” of the first TE image is constructed by a 3×3 kernel. Hence, the histogram of the SD map is calculated and the maximum of the first peak (corresponding to SD measurements in the image background) is identified. The maximum value of the first peak represents a good estimate of σbk. To generalize the procedure, by imposing k equal to its maximum value, the threshold for the background estimation can be calculated asSth=4.73σbk.In the second step, the relaxivity value for the “in process” pixel set is computed by WLSL [15], assuring accuracy and a low processing time. By WLSL, the relaxivity value T2⁎ is directly estimated as:(4)1T2⁎=R2⁎=−1Δ[∑i=1Nwi∑j=1NwjTEjlnSj−∑i=1NwiTEi∑j=1NwjlnSj]where:Δ=∑i=1Nwi∑j=1NwjTEj2−(∑i=1NwiTEi)2The weights wicompensates for the uncertainty of the signal logarithm, which increases as the signal decreases. wivalues are estimated as the logarithm of the signal variance as wi=Si2. The computational complexity of the WLSL algorithm is O(N2) where N is the number of TEs.After T2⁎ estimation by the WLSL algorithm, pixels are marked as “processed” or not based upon the fitting error that was computed as the normalized mean root square error (MRSQ) between the decay curve related to the current pixel and the optimal model found by the WLSL algorithm. If the fitting error is less than the Emaxthreshold, the pixel is classified as “processed”; if not, the pixel remains in the “to process” state, and its relaxivity value is recomputed in the next iteration. In the next iteration, the range of used TEs is modified excluding the last TE from computation. A minimum number of three TEs is preserved during the process, as the use of two TEs would always lead to a null fitting error. Hence, the maximum number of iterative steps is N−2.At the end of the step 2, the “to process” pixel set may be not empty if any tried combination of TEs led to a fitting error greater than Emax. The relaxivity value of these pixels is set to the one corresponding to the TEs combination associated with the lower fitting error. To perform this task, the “optimal” relaxivity value for each pixel was recorded during the process when the fitting error reached its minimum on the specific pixel, even if the fitting error was higher than Emax. This approach allows for the “best” relaxivity value to be stored at the end of the iterative process with no further fitting operations needed. Hence, the computational complexity of step 3 is negligible.The maximum computational complexity of the proposed algorithm can be evaluated as:(5)NPO(∑k=3Nk2)<NPO(N33)whereNPis the number of image pixels and N the number of TEs. In fact in the worst case, if all of the pixels had proceeded to step 3, the WLSL algorithm is applied N−2 times to a decay curve of decreasing dimension for each pixel.A simplified version of the previously described process can be applied to the analysis of decay curves extracted from a ROI by averaging the MR signal value in the ROI for each TE sample. As the selection of the ROI is typically done manually, a test for the background signal can be avoided and only step 2 and step 3 (if needed) have to be performed.Fig. 2 depicts the progression of the developed procedure applied to an image set from a patient with severe cardiac IO (myocardial T2⁎ value approximately 4.5ms). The first row (#TEs=10) reports the results of the procedure at the first iteration of the second step, where the background region is identified and the T2⁎ is computed by the WLSL algorithm exploiting all TEs. The T2⁎ values in the myocardium appear greatly overestimated (see the T2⁎ map with the rainbow color map) and the fitting error in the myocardium is high (more than 20%, see the fitting error map). The fitting error is instead acceptable in regions with high T2⁎ values, as blood pools. For comparison, the last column shows segmental T2⁎ values in the six cardiac segments and the logarithm of the decay curve related to the antero-septal segment as obtained by the HIPPO MIOT software used in clinical assessment of IO in the patient.Clearly, the decay curve collapses early on the background noise, diverging from the mono-exponential decay. The linear fitting of the logarithm of the signal failed leading to a high fitting error. Note that the fitting error in the liver instead is low and the evaluation of the hepatic T2⁎ value (higher than the cardiac T2⁎ value in this patient) is correct at this point. The algorithm progress by decreasing the number of used TEs in the pixels with a high associated fitting error (#TEs=8, #TEs=6, #TEs=4 are shown). The corresponding ROI-based curves are shown in the last column. At the final step (#TEs=3), the fitting error in the inner myocardium is low and the T2⁎ value was correctly evaluated.The proposed algorithm was implemented in the IDL 8.2 environment (Exelis Visual Information Solutions, Boulder, CO, USA). Experiments were conducted on an iMac 1.3GHz dual-core Intel i5.All data were analyzed using the Medcalc 12.7 (MedCalc Software, Ostend, Belgium) statistical package. All continuous variables are expressed as the mean and standard deviation. The reproducibility of the measurements was calculated by the coefficient of variation (CoV), defined as the standard deviation of the differences divided by the mean and expressed as percentage. Correlation analysis was performed using Spearman’s test. A two-tailed P<0.05 was considered statistically significant.

@&#CONCLUSIONS@&#
The proposed method has proven to be effective in producing T2⁎ maps in a short time for the entire range of T2⁎ values of clinical interest. T2⁎ value measurements were consistent with those of expert readings. The proposed method allows to safely and accurately apply fast T2⁎ mapping in quantifying MIO iron deposition in iron overload patients. Therefore this approach could be easily incorporated into T2⁎ analysis software to be spread into the clinical arena for the development of a fully automated myocardial tissue iron quantification.The authors declare that they have no conflict of interest.The MIOT project receives “no-profit support” from industrial sponsorships (Chiesi Farmaceutici S.p.A., ApoPharma Inc. and Bayer-Shering). This study was also supported by: “Ministero della Salute, fondi ex art. 12 D.Lgs. 502/92 e s.m.i., ricerca sanitaria finalizzata anno 2006” e “Fondazione L. Giambrone”.Dr. Pepe Alessia received speaker’s honoraria from Chiesi, ApoPharma Inc. and Novartis.The authors declare that they have no competing interests. Sponsors have no role in the study design, in the collection, analysis and interpretation of data, in the writing of the manuscript, and in the decision to submit the manuscript for publication.