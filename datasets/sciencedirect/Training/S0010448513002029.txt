@&#MAIN-TITLE@&#
Iterative refinement of hierarchical

@&#HIGHLIGHTS@&#
An iterative refinement strategy for generating hierarchicalT-meshes is proposed.The required ordering of line-segments which form aT-mesh is specified.The construction of spline basis functions is obtained.The proposed algorithm includes standard hierarchicalB-splines.

@&#KEYPHRASES@&#
Hierarchical,T,-mesh,Spline space,Local refinement,

@&#ABSTRACT@&#
In this paper we propose a strategy for generating consistent hierarchicalT-meshes which allow local refinement and offer a way to obtain spline basis functions with highest order smoothness incrementally. We describe the required ordering of line-segments during refinement and the construction of spline basis functions. We give our strategy for generating consistent hierarchicalT-meshes over any shape of a two-dimensional domain.

@&#INTRODUCTION@&#
Local mesh refinement algorithms are useful for their ability to localize changes in the set of control points to a limited region; due to their construction, basic tensor-product representation does not allow local refinement. If we allow a row of control points to terminate at aT-junction, we can refine an underlying domain locally. The spline representations based on aT-mesh as an underlying structure appear to be efficient for surface modeling and isogeometric analysis introduced in 2005 by T.J.R. Hughes et al. [1,2]. For the interested reader, let us give a short overview of some of the results related to the spline representation techniques usingT-meshes.T-splines were introduced in 2003 by Sederberg et al.  [3]. A practicable refinement algorithm ofT-splines is described in  [4]. The issue of the linear independence ofT-splines  [5], which is relevant to usingT-splines in isogeometric analysis  [6], has been resolved lately by considering analysis-suitableT-splines by Li et al.  [7]. The refinement algorithm for analysis-suitableT-splines is presented in  [8]. Dual-compatibleT-splines, which include analysis-suitableT-splines, have been introduced in  [9].MultilevelB-splines for surface modeling were originally introduced in 1988 by Forsey and Bartels  [10]. In 1995 Kraft  [11] suggested a selection mechanism for hierarchicalB-splines, which ensures their linear independence while permitting local control of refinement. Kraft’s construction has been further elaborated in [12,13]. Dokken et al.  [14] have lately proposed locally refinable splines (LR-splines) and the refining process based on so-called hand-in-handLR-refinement which starts with a tensor-product mesh.Polynomial splines overT-meshes were introduced in 2005 by Deng et al.  [15].PHT-splines  [16], which are bicubic polynomial splines with the order of smoothness(1,1)overT-meshes, were introduced in 2006. For applications ofPHT-splines in surface modeling and isogeometric analysis see e.g.  [17,18]. Bases of spline spaces of bi-degree(m,m′)with the order of smoothness(r,r′)(if it is supposed thatm⩾2r+1andm′⩾2r′+1) overT-meshes have been constructed in terms of the Bernstein–Bézeier representation by Schumaker et al.  [19].The issue of describing splines of bi-degree(m,m′)with the order of smoothness(r,r′)(if it is supposed thatm<2r+1andm′<2r′+1) over an arbitraryT-mesh seems hardly solvable in a simple and regular way. The dimension of the spline space may itself depend on the geometry of aT-mesh, and not only on its topology  [20,21]. Therefore, it is desirable to gain an insight into the topology ofT-meshes which admit a practicable algorithm for generating spline basis functions.In this paper we will focus on a certain type ofT-meshes with a multilevel structure. In particular, we will describe an iterative strategy to construct consistent hierarchicalT-meshes for splines with highest order smoothness; namely, for splines of bi-degree(m,m)with the order of smoothness(m−1,m−1). Wu et al. [22,23] have recently introduced consistent hierarchicalT-meshes. A consistent hierarchicalT-mesh is generated by a sequence of edge insertions such that each new edge insertion into the mesh satisfies the so-called surjection condition; in essence that means that one is able to add all new basis functions of a spline space with highest order smoothness at each iteration of edge insertion. The concept of a consistent hierarchicalT-mesh seems to offer natural way to add spline basis functions incrementally. A consistent hierarchicalT-mesh might be generated for any shape of two-dimensional domain, and not just for rectangular domains. However, the generation of a consistent hierarchicalT-mesh and the ordering of the edges or line-segments remain open questions. As an implementation of a consistent hierarchicalT-mesh, Wu et al.  [22] suggest a particular type of crosswise hierarchicalT-mesh that contains a nested sequence of domains.The essence of our iterative strategy can be described as follows. At each iteration step, the portion of aT-mesh to be refined is chosen to be as follows: it creates a partition of some domain into cells of a tensor-product mesh. The partition of this domain into cells is of restricted configuration and the constraint on configuration will be given in terms of offset region and curve, which have been recently introduced by Giannelli and Jüttler  [24]. We will determine the ordering of the line-segments to be inserted at each iteration step and give the construction of spline basis functions. This strategy provides a framework in which the concept of consistent hierarchicalT-meshes is feasible. We will show that particular classes of consistent hierarchicalT-meshes  [22] can be obtained by applying this strategy.Overall, this paper is in the scope of the methods and tools introduced in  [22,24,25], and as a consequence the results presented can be considered as an extension of the construction of classical hierarchicalB-splines originally introduced in  [11].The rest of this paper is organized as follows. In Section  2 we provide the background needed to explain our strategy, which we then introduce at the beginning of Section  3. We describe the required ordering of line-segments and the construction of spline basis functions for splines of degrees 2 and 3 in Sections  3.1 and 3.2 respectively. We make necessary remarks and discuss the relevant modifications of our strategy in Section  3.3. We conclude the paper in Section  4.AT-meshTis formed by a set of horizontal and vertical line-segments that creates a partition of a closed domainΩinto axis-aligned boxes, called the cells of theT-mesh, in whichT-junctions are allowed  [15]. We do not assume that the boundary∂ΩofΩis rectangular. However, we assume that aT-meshTis regular (see  [19, Definition 2.2]); or, in other words, we assume that the boundary∂Ω, which is a collection of piecewise-linear curves, is free of self-intersections.An example of aT-mesh is shown in Fig. 1. In Fig. 1,v1,…,v5andb1,…,b11are the vertices of aT-mesh. An edge of aT-mesh is a line-segment connecting two adjacent vertices. In Fig. 1,b8v5andv1v2are examples of horizontal edges andb2v1andv4v5are examples of vertical edges. The boundary of aT-mesh is the boundary∂Ωof its domainΩ. Thus in Fig. 1 the boundary is the piecewise linear closed curveb1b3b11b10b8b7b5b4. A vertexblies on the boundary ifb∈∂Ω; other vertices are called inner vertices.A maximal segment of aT-mesh is the longest possible line-segment that can be constructed from several collinear edges; in Fig. 1 the line-segmentsb4b6,b2b10are maximal. A maximal interior segment is a maximal segment that does not intersect with the boundary∂Ω; in Fig. 1v3v4andv2v5are maximal interior segments.In Section  2.1 we will state the results that will be used in the analysis of spline space with highest order smoothness defined as follows.Definition 1[15]LetS(m,m,m−1,m−1)(T)be a space of functionsf(x,y)of classCm−1,m−1(Ω)which are polynomials of bi-degree(m,m)inxandy, defined in each cell of aT-meshT.To analyze the dimension and basis functions of a spaceS(m,m,m−1,m−1)(T), we follow the smoothing cofactor method [20,26,27].For a given elementf(x,y)∈S(m,m,m−1,m−1)(T)and inner vertexv(x0,y0), the conformality factorkvis defined as follows. Suppose that the bivariate functionf(x,y)is respectively equal to the polynomialsP1(x,y),P2(x,y),P3(x,y),P4(x,y)in each of four cells which form a neighborhood ofv(x0,y0)(see Fig. 2). In the case ofT-junction the corresponding polynomials are supposed to be the same.Provided that the functionf(x,y)is of classCm−1with respect toxandy, the following equalities hold:(1)P2−P1=λ1,2(x)(y−y0)m,(2)P3−P2=λ2,3(y)(x−x0)m,(3)P4−P3=λ3,4(x)(y−y0)m,(4)P1−P4=λ4,1(y)(x−x0)m,for some univariate polynomialsλ1,2(x),λ2,3(y),λ3,4(x)andλ4,1(y)of degreem. From Eqs. (1) to (4), we can assert:(5)P2−P1+P4−P3=(λ1,2(x)+λ3,4(x))(y−y0)m=−(λ2,3(y)+λ4,1(y))(x−x0)m.Thus, for some constantkvwe obtain:(6)λ1,2(x)+λ3,4(x)=kv(x−x0)m,λ2,3(y)+λ4,1(y)=−kv(y−y0)m.In addition, the constantkvcan be represented in terms of the derivatives on the left-hand side of (5). Indeed, from (5) and (6) we can obtain the following representation forkv:(7)kv=1(m!)2∂2m(P2(x,y)+P4(x,y)−P1(x,y)−P3(x,y))∂xm∂ym|x=x0,y=y0.This means thatkvis uniquely defined for a givenf∈S(m,m,m−1,m−1)(T)and inner vertexv.Suppose thatEis a maximal horizontal interior segment with endpoints at the verticesv1,vn, and at the inner verticesv2,…,vn−1(see Fig. 3). For a given functionf∈S(m,m,m−1,m−1)(T), letPij(x,y),i=1⋯n,j=1⋯4denote the polynomials that correspond to the verticesvi, following Fig. 2.We can then note the following relation:(8)∑i=1nPi2−Pi1+Pi4−Pi3=0.From Eqs. (5), (6) and (8), we obtain the zero identity:(9)∑i=1nkvi(x−xi)m≡0,wherexi,i=1⋯nis thex-coordinate of the vertexvi. This identity (9) is equivalent to the following linear system in terms of the conformality factorskvi,i=1⋯n:(10){∑i=1nki=0,∑i=1nkixi=0,⋯∑i=1nkixim=0.An analogous linear system for a maximal vertical interior segment can be derived:(11){∑i=1nki=0,∑i=1nkiyi=0,⋯∑i=1nkiyim=0.Definition 2[22]For a givenT-meshT, letv1,…,vNbe vertices ofTbelonging to maximal interior segments ofT. The conformality vector spaceW[T]is the space of conformality factorskv1,…,kvNwhich satisfy the linear systems (10) and (11) for all horizontal and vertical maximal interior segments.Note that, unlike the similar definition given elsewhere  [22,23], this does not involve the conformality factors of boundary vertices.Thus, by virtue of (10) and (11), and using the direct formula (7), it is possible to define a linear map correctly  [22,23]:(12)K:S(m,m,m−1,m−1)(T)⟶W[T].The definition of a conformal vector space in the univariate case is the following:Definition 3[22]Given a univariate knot vector(x1,…,xn)without repeated knots, and the corresponding line-segmentE=[x1,xn],W[E]is the space of conformality factorsk1,…,knwhich satisfy the linear system (10).Note that the spaceW[E]is isomorphic to the space of functions of the classCm−1which are polynomials of degreemwithin each segment[xj,xj+1],j=1⋯n−1and identically zero outside the segmentE=[x1,xn]; following previous authors  [22,23], we call this spaceS¯(m,m−1)(E). If we further suppose thatf(x)∈S¯(m,m−1)(E)such thatf(x)=Pj(x), whenx∈[xj,xj+1],j=1⋯n−1andf≡0, forx∈R∖[x1,xn]. Sincef(x)is of classCm−1, we can write(13)P1−0=k1(x−x1)m,P2−P1=k2(x−x2)m,…,Pn−1−Pn−2=kn−1(x−xn−1)m,0−Pn−1=kn(x−xn)m.This implies that∑i=1nki(x−xi)m≡0; and the conformality factorsk1,…,kncan be obtained by solving the linear system (10). Note thatdimW[E]=n−m−1ifn>m+1, anddimW[E]=0ifn⩽m+1.Definition 4[22]LetEbe a maximal interior segment in theT-meshT. Then we definePE:W[T]→W[E]to be the projection that preserves the conformality factors of the vertices belonging toE.For a maximal interior segmentEof a givenT-meshT, letT′denote the newT-mesh that is obtained fromTby removing line-segmentE. Assume that there is a set of functionsf1,…,fl∈S(m,m,m−1,m−1)(T)such that the conformality vectorsPE(K(f1)),…,PE(K(fl))form the basis of a subspacePE(imK)⊂W[E], whereimK⊂W[T]. Then the spline spaceS(m,m,m−1,m−1)(T)can be expressed as follows:S(m,m,m−1,m−1)(T)=S(m,m,m−1,m−1)(T′)⨁span{f1,…,fl}.ProofThe equalityS(m,m,m−1,m−1)(T′)∩span{f1,…,fl}=0follows from the simple observation thatPE(K(f′))=0for anyf′∈S(m,m,m−1,m−1)(T′). It is then only necessary to represent the spline functionf∈S(m,m,m−1,m−1)(T)as the sum of a spline functiong∈S(m,m,m−1,m−1)(T′)and some linear combination off1,…,fl.For a given functionf∈S(m,m,m−1,m−1)(T), the corresponding projectionPE(K(f))is a linear combination ofPE(K(fi)),i=1⋯l; thus, for somec1,…,cl, the projectionPE(K(f−∑i=1lcifi))=0. Thus the functiong=f−∑i=1lcifiis an element ofS(m,m,m−1,m−1)(T′). Indeed, sincePE(K(g))=0, all the conformality factors ofK(g)belonging toEare zero. Without loss of generality, we may suppose thatEis the horizontal maximal interior segment that traverses the verticesv1,…,vn(see Fig. 3), and that all its conformality factorskv1,…,kvnare zero. Following Fig. 2,Pij,i=1⋯n,j=1⋯4are polynomials representingfin the neighborhoods of the verticesv1,…,vnrespectively. Since theT-meshThas aT-junction at the vertexv1,P13−P14=0and, by virtue of (5) and (6),P12−P11=0, or equivalentlyP23−P24=0; sincekv2=0, a similar argument yieldsP22−P21=0. Going further, to the vertexvn, we see thatgis of classC∞with respect toyalong the whole line-segmentE. Thusg∈S(m,m,m−1,m−1)(T′)andf=g+∑i=1lcifi. The Lemma 1 is proved.□Remark 1Note that, if the projectionPE:imK→W[E]is surjective, thenspan{f1,…,fl}is isomorphic toW[E].Corollary 1Suppose that for a givenT-meshT, there is an ordered sequence of maximal interior segmentsE1≺⋯≺En, such that successive deletion ofEn≻⋯≻E1from theT-meshTproduces theT-meshT0; let theT-meshTi,i=1⋯n−1be obtained by successive deletion of the line-segmentsEn≻⋯≻Ei+1fromT; and letTn=T. Suppose that all the projectionsPEi:imKi→W[Ei],i=1⋯nare surjective, where linear mapsKi:S(m,m,m−1,m−1)(Ti)→W[Ti]are given by   (12). Let{fi1,…,fili}⊂S(m,m,m−1,m−1)(Ti),i=1⋯nbe a set of spline functions such that the projectionsPEi(Ki(fij)),j=1⋯liform the basis ofW[Ei]. Then, by virtue ofLemma  1:(14)S(m,m,m−1,m−1)(T)=S(m,m,m−1,m−1)(T0)⨁i=1nspan{fi1,…,fili}.One consequence of Corollary 1 is a method of constructing basis functions of a spline space for those classes ofT-meshes that satisfy the conditions of the corollary.This approach to the construction of basis functions, provided by Corollary 1 but originally introduced by Wu et al.  [22], has been formulated  [23] there in terms of ordered sequence of edges, rather than maximal interior segments. But in demonstrating their concept of consistent hierarchicalT-meshes, Wu et al.  [23] refer only to a particular class of hierarchicalT-meshes  [22]. In the next section we will discuss the problem of generatingT-meshes to satisfy the conditions of Corollary 1, and then to construct basis functions of the corresponding spline space.Definition 5[25]For a given ordered sequence of maximal interior segmentsE1≺⋯≺El, letλ(Ei)be the number of vertices ofEiwhich are not on a maximal interior segment of index greater thani.LetTbe aT-mesh on some rectangular domain. Assume that, for a given order of its maximal interior segments, the following inequality holds:λ(Ei)⩾m+1,for every maximal interior segmentEi,i=1⋯l. Then,(15)dimS(m,m,m−1,m−1)(T)=(m+1)2C−m(m+1)E0+m2V0,whereCis the number of cells,E0is the number of inner edges, andV0is the number of inner vertices ofT.In Section  2.2 we will recall Giannelli and Jüttler’s definition  [24] of the offset region and curve from a domainΩthat will be necessary to describe the refinement strategy in Section  3. In addition, we will state the results that will be used in Lemmas 3 and 4 in Sections  3.1 and 3.2, respectively.Suppose thatΩis a domain formed by the cells of an infinite tensor-product mesh (see Fig. 4). The offset regionRkcan be defined recursively as follows: an offset regionRk+1is defined to be the set of cells⊈⋃j=0kRjwhich have at least one point in common with the boundary∂⋃j=0kRj; the zero offset regionR0is defined to beΩ. The offset curve from a domainΩis the piecewise linear curve defined as follows:Definition 6[24]The offset curveC0at a distance 0 from a domainΩis defined to be its boundary∂Ω. Given the offset regionsRkandRk+1, for a nonnegative integerk, then:1.We say thatΩadmits an offset at a distancek+12if any cell inRk+1is related toRkby one of the three connections shown in Fig. 5; then the offset curve at a distancek+12, writtenCk+12, is a piecewise linear curve obtained by collecting together the contributions of every cell, as shown in Fig. 5.We say thatΩadmits an offset at a distancek+1if the relationship between any cell inRk+1andRkfalls into one of the three cases shown in Fig. 6; then the offset curve at a distancek+1, writtenCk+1, is the piecewise linear curve that forms the exterior boundary ofRk+1, as shown in Fig. 6.We say thatΩdoes not admit an offset at a distance greater than or equal tok+12ork+1if the above conditions 1 or 2 respectively are not satisfied.In Definition 6 the conditions 1 or 2 respectively allow us to be sure that the offset curvesCk+12orCk+1are free of self-intersections. Fig. 7shows an example of the offset regionR1from the domainΩ(shown in Fig. 4 as well) and the corresponding offset curveC12(dashed red lines). Note that the definition above means thatΩin Fig. 7 does not admit an offset at a distance greater or equal than 1.Definition 6 constrains the configuration of a domainΩin a way which makes it relatively easy to specify the basis functions of a spline space over aT-mesh.Theorem 1[24]LetTbe aT-mesh which subdivides a bounded domainΩinto cells of a tensor-product mesh (seeFig.  4). For a given integerm⩾2, suppose thatΩadmits an offset at a distancem−12. LetBbe a set of tensor-productB-splines generated from the given tensor-product mesh. Then, the following set provides the basis of the spline spaceS(m,m,m−1,m−1)(T):{τ|Ω:τ∈B∧suppτ∩intΩ≠∅}.The following definition of the configuration of a domainΩ, which is the dual of Definition 6, will be used extensively in the next section.Definition 7Letmbe an integer⩾2. We say that a domainΩadmits an inner offset at a distancem−12if its complementR2∖Ωadmits an offset at a distancem−12. We say that a domainΩdoes not admit an inner offset at a distance greater than or equal tom−12if its complementR2∖Ωdoes not admit an offset at a distance greater than or equal tom−12. The inner offset curve ofΩat a distancem−12isCm−12ofR2∖Ω.A condition thatΩadmits an inner offset at a distancem−12allows us to be sure that the inner offset curve ofΩat a distancem−12is free of self-intersections. Examples of domains which admit inner offset at distances12and 1 are shown in Fig. 8, together with domains which do not admit an inner offset at distances greater than or equal to12and 1.We can make the following simple observation about a domain which admits an inner offset:Proposition 1For a given integerm⩾2, suppose that a domainΩadmits an inner offset at a distancem−12. Further suppose that the corresponding tensor-product mesh is refined by inserting a lineL. Then,Ωadmits an inner offset at a distancem−12for the refined tensor-product mesh as well.Proposition 1 is illustrated, form=2, in Fig. 9. The following proposition plays a significant role in proving lemmas in the next section.Proposition 2LetT′be aT-mesh andΩbe a domain composed by a subset of cells ofT′. Suppose that the set of cells comprisingΩis a subset of cells of some tensor-product mesh. For a given integerm⩾2, we suppose thatΩadmits an inner offset at a distancem−12. Suppose further thatT′is refined by the line-segmentE⊂Ωsuch thatEis a maximal interior segment of the refinedT-meshT=T′⋃E. Then we can assert:S(m,m,m−1,m−1)(T)=S(m,m,m−1,m−1)(T′)⨁span{f1,…,fl},wheref1,…,flare tensor-productB-splines which have supports within the domainΩ.ProofBefore proving Proposition 2 let us illustrate its nature, for the casem=3, in Fig. 10. We will prove the proposition form=3; the proof for other positive integersmis analogous. Following Lemma 1, we need to provide tensor-productB-splinesf1,…,fl∈S(m,m,m−1,m−1)(T)such thatPE(K(f1)),…,PE(K(fl))form a basis ofPE(imK)⊂W[E]. Without loss of generality, we assume thatEis the vertical maximal interior segment, and lety1<⋯<ykbe they-coordinates of its knots. Ifk⩽4, thenW[E]=0and there is nothing to prove. Ifk>4, then there arel=k−4tensor-productB-splinesf1,…,flfrom the spline spaceS(m,m,m−1,m−1)(T), such thatPE(K(f1)),…,PE(K(fl))form a basis ofW[E]. Let us consider a column of four adjacent cells divided byEand the corresponding line-segmentVwith knots(y1,y2,y3,y4,y5).SinceΩadmits an inner offset at a distance 1, then at least one of the three configurations shown in Fig. 11must occur. Consider the following tensor-productB-spline having a support within the domainΩ(see Fig. 11):(16)f(x,y)=N[x1,x2,x3,x4,x5](x)N[y1,y2,y3,y4,y5](y);thenPE(K(f(x,y)))is a nontrivial element(k1,…,k5)of the one-dimensional space of conformality factorsW[V]⊂W[E]. Indeed,ki≠0,i=1⋯5, because otherwise(k1,…,k5)=0and then, as we saw in the proof of Lemma 1,f(x,y)would be of classC∞with respect toxalong the line-segmentE, which contradicts the definition off(x,y)in (16). From this simple treatment, it is readily apparent that the conformality vectorsPE(K(fi)),i=1⋯lfor theB-splinesfi,i=1⋯lcorresponding to all rows of four consecutive cells divided byE, form a basis of the spaceW[E]. Proposition 2 is proved.□We now describe general refinement strategy that satisfies the conditions introduced in Corollary 1, which allow spline basis functions to be constructed incrementally. We will concentrate onm=2andm=3. However, we will start by describing the generic inductive refinement procedure.Definition 8Letmbe an integer⩾2. We say that aT-meshTis of typemif it is derived from an initialT-meshT0by repeating step 2 of the following algorithm fromj=0untilj=N−1andT=TN, for some integerN⩾1.1.The initialT-meshT0occupies the domainΩ0, which is composed of the cells of a tensor-product mesh and admits an offset at a distancem−12.Induction from anyj⩾0toj+1proceeds as follows. For a givenT-meshTj, it is necessary to find domainsΩ̂j⊂Ωjwhich satisfy the following assumptions: domainsΩ̂jandΩjare both constructed from the cells of some tensor-product mesh, such that each cell inΩjis also a cell of theT-meshTj; andΩjadmits an inner offset at a distancem−12. The refinedT-meshTj+1is derived fromTjby dividing each cell of the domainΩ̂jfollowing the rule illustrated in Fig. 12, such that the line-segmentsEj1,…,EjnjrefiningTjhave endpoints on∂Ω̂j. It is supposed that the line-segmentsEj1,…,Ejnjare maximal interior segments of theT-meshTj+1, i.e.Ej1,…,Ejnjdo not intersect with the boundary∂Ω0.A step 2 for an iteration fromjtoj+1form=3is shown in Fig. 13. The examples of realization of the refinement strategy are demonstrated in Remarks 2 and 3 below for the casesm=2andm=3, respectively.SinceΩ0admits an offset at a distancem−12, the basis functions of a spline spaceS(m,m,m−1,m−1)(T0)can always be obtained using Theorem 1. In order to show that aT-meshTof typemsatisfies the conditions of Corollary 1, we only need to prove that the induction step (step 2 in the refinement strategy above) satisfies those conditions. We start with the casem=2.LetT=TNbe aT-mesh of type 2 for some integerN⩾1(see Definition 8). We consider the induction step fromTjtoTj+1, for a given0⩽j⩽N−1, such thatTj+1is derived fromTjby refining with maximal interior segmentsEj1,…,Ejnj, in compliance with step 2 of the algorithm in Definition 8. For a given order of the line-segmentsEj1≺⋯≺Ejnj, theT-meshTji,1⩽i⩽njis derived fromTjby successive introduction of the line-segmentsEj1,…,Eji; in particular,Tjnj=Tj+1.In the following lemma we omit the indexjto simplify the notations, observing that the proof is the same for any0⩽j⩽N−1; thusTicorresponds toTji,EitoEji,Ω̂andΩtoΩ̂jandΩjrespectively. In formulating the basis functions, we will presume that the cells of the domainΩare of the same size and any line-segment that divides a cell of the domainΩ̂connects the mid-points of opposite edges of that cell.Lemma 3There exists an ordered sequence of maximal interior segmentsE1≺⋯≺Enwhich refineT0such that the projectionsPEi:W[Ti]→W[Ei]are surjective for alli=1⋯n, so for anyi=1⋯nthere is a set of spline functions{fi1,…,fili}⊂S(2,2,1,1)(Ti), such that{PEi(Ki(fi1)),…,PEi(Ki(fili))}forms a basis ofW[Ei], whereKi:S(2,2,1,1)(Ti)→W[Ti]is given in   (12). Moreover, these spline functions can be chosen such that their supports are contained withinΩ.ProofThe proof could be found in Appendix A.□Remark 2Wu et al.  [22] describe a special classesTm,mof hierarchicalT-meshes. Ifm=2, thenT2,2is the ordinary class of crosswise hierarchicalT-meshes with a level structure, which is the same to one used forPHT-splines  [16]. The following procedure, shown in Fig. 14, can be used to generate aT-mesh of classT2,2. We begin with a tensor-product mesh over a rectangular domain (the cells of this mesh are defined to be of level 0). In order to generate a cell at levelj+1, a cell at leveljmust be subdivided into four subcells (which are defined to be at levelj+1). A cell is divided by two line-segments connecting the mid-points of opposite edges.We observe that a hierarchicalT-mesh of classT2,2is of type 2, following Definition 8. LetTbe a hierarchicalT-mesh of classT2,2. The domainΩ̂j, which is to be divided to obtain cells at levelj+1, is composed of cells at levelj. We create a domainΩj⊃Ω̂jby unifying all the cells at levelj. Ifj⩾1, then the construction ofTmeans thatΩjis composed of 2×2 blocks of cells at levelj(each corresponding to a single cell at levelj−1). In order to prove thatΩjadmits an inner offset at a distance12, we need to show thatR2∖Ωjadmits an offset at a distance12. The domainR2∖Ωjis also composed of 2×2 blocks of cells. It is apparent that the cells from the offset regionR1of a domainR2∖Ωjare related toR2∖Ωjthrough the connections shown in Fig. 5. This observation implies thatR2∖Ωjadmits an offset at a distance12. Ifj=0, then it suffices to suppose that the original tensor-product mesh extends at least 2 cells in both coordinate directions to guarantee thatΩ0admits an inner offset at a distance12. We assume that the cells at level 0 having common edges with the boundary ofTare not divided, i.e. starting at level 1, all introduced line-segments will be maximal interior segments ofT. Thus, by Definition 8,Tis of type 2. The spline basis functions ofS(2,2,1,1)(T)can be obtained by Lemma 3.LetT=TNbe aT-mesh of type 3 for some integerN⩾1(see Definition 8). As we did in the previous subsection, we will consider the induction step fromTjtoTj+1, for a given0⩽j⩽N−1, which allows us to deriveTj+1fromTjby refining theT-meshTjby introducing maximal interior segmentsEj1,…,Ejnj, as we did in step 2 of the algorithm in Definition 8. For a given ordering of the line-segmentsEj1≺⋯≺Ejnj, theT-meshTji,1⩽i⩽njcan be derived fromTjthrough the consistent refinement by the line-segmentsEj1,…,Eji; in particular,Tjnj=Tj+1.In the following lemma we will omit the indexj. In addition, we will suppose that the cells of the domainΩare of the same size and any line-segment that divides a cell of the domainΩ̂connects the mid-points of opposite edges of that cell, as we did in Lemma 3.Lemma 4There exists an ordered sequence of maximal interior segmentsE1≺⋯≺Enwhich refineT0such that the projectionsPEi:W[Ti]→W[Ei]are surjective for alli=1⋯n, so for anyi=1⋯nthere is a set of spline functions{fi1,…,fili}⊂S(3,3,2,2)(Ti)such that{PEi(Ki(fi1)),…,PEi(Ki(fili))}forms a basis ofW[Ei], whereKi:S(3,3,2,2)(Ti)→W[Ti]is given in   (12). Moreover, these spline functions can be chosen such that their supports are contained withinΩ.ProofThe proof could be found in Appendix B.□Remark 3Let us briefly revisit the construction ofT-meshes of classT3,3, as described by Wu et al.  [22], and illustrated in Fig. 15. Their procedure starts with a tensor-product mesh over a rectangular domain (containing cells that are defined to be at level 0). In order to generate a cell at levelj+1, one has to subdivide a quad of four neighboring cells at leveljinto sixteen subcells (which are defined to be at levelj+1). Any two 2×2 blocks of cells at leveljwhich are to be subdivided must either have two common boundary edges, one common boundary vertex, or no common vertices. It must also be assumed that each cell is subdivided by two straight lines connecting the mid-points of the two opposite edges.We see from Definition 8 that a hierarchicalT-mesh of classT3,3is of type 3. LetTbe a hierarchicalT-mesh of classT3,3. The domainΩ̂j, which is to be divided to obtain cells at levelj+1, is composed of 2×2 blocks of cells at levelj. We can create a domainΩj⊃Ω̂jby unifying all the cells at levelj. Ifj⩾1, then, because of the way in whichTwas constructed,Ωjis composed of 4×4 blocks at levelj(originally the 2×2 blocks at levelj−1). In order to prove thatΩjadmits an inner offset at a distance 1, we need to show thatR2∖Ωjadmits an offset at a distance 1. The domainR2∖Ωjis also composed of 4×4 blocks of cells. It is apparent that the cells from the offset regionR1of a domainR2∖Ωjare related toR2∖Ωjthrough the connections shown in Fig. 6. This observation implies thatR2∖Ωjadmits an offset at a distance 1. Ifj=0, then it suffices to suppose that the original tensor-product mesh has at least 3 cells in both coordinate directions to guarantee thatΩ0admits an inner offset at a distance 1. We assume that the cells at level 0 having common edges with the boundary ofTare not divided, i.e. starting at level 1, all introduced line-segments will be maximal interior segments ofT. Thus, by Definition 8,Tis of type 3. From Lemma 4 we have that for theT-meshT, the line-segments, which are used to divide the cells of levelj, may be arranged in the following simple way. The line-segments of length⩾4need not be ordered. Then, the remaining line-segments, which are of length 2, may also be ordered arbitrarily, except for isolated quads (see Fig. 22, right), which can simply be ordered in a clockwise direction. The spline basis functions ofS(3,3,2,2)(T)can be obtained by Lemma 4.From the proof of Lemma 4, we see that spline basis functions can be obtained; but, for example, this may involve the sophisticated construction shown in Fig. 21 (center). It is more practical to use configurations in which the line-segments can be ordered in a simple or even arbitrary way. From this point of view, it is reasonable to assume that all maximal interior segments are of length⩾m. This latter assumption ensures us that the correspondingT-mesh is regular, defined as in Mourrain  [25].This assumption enables us to order the line-segments within a step 2 of the refinement strategy in an arbitrary way. Moreover, it enables us not to assume that the line-segmentsEj1,…,EjnjrefiningTjhave endpoints on∂Ω̂j. In addition, we do not need to assume that each cell ofΩ̂jis divided following the rule illustrated in Fig. 12; we may admit that a cell ofΩ̂jis divided by several line-segments in both directions. A step 2 of this modified refinement strategy is illustrated in Fig. 16. From the proofs of Lemmas 3 and 4 we see that the spline basis functions are tensor-productB-splines except probably those which correspond to the line-segments intersecting in vertices that are close enough to the boundary∂Ωj. In order to guarantee that all the spline basis functions are tensor-productB-splines, we need to extend the line-segments intersecting in each vertexZ, for whichfZcannot be represented as a tensor-productB-spline, until the boundary of a domainΩZ(see e.g. Fig. 20).

@&#CONCLUSIONS@&#
We have described an iterative strategy for generating consistent hierarchicalT-meshes. It is based on the concept of a domain of restricted configuration, which is composed of the cells of a tensor-product mesh, and which is divided in successive steps. We have described the required ordering of line-segments during refinement, and the construction of basis functions for splines of degree 2 and 3.We have shown that hierarchicalT-meshes of classesT2,2andT3,3are produced by this strategy for degrees 2 and 3 respectively. We have described the relevant modifications of our strategy which substantially simplify the ordering of line-segments and the corresponding construction of basis functions.The concept of consistent hierarchicalT-meshes is promising for applications as long as they allow local refinement and offer a simple way for describing spline basis functions. Our iterative strategy provides a feasible framework for generating consistent hierarchicalT-meshes. We believe that the results of this paper might help in selection and processing of possible implementations of consistent hierarchicalT-meshes. In our future work we intend to propose analogues of consistent hierarchicalT-meshes for trivariate case and offer a strategy for generating of such meshes.