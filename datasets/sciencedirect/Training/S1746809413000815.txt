@&#MAIN-TITLE@&#
Sleep apnoea detection from ECG using features extracted from reconstructed phase space and frequency domain

@&#HIGHLIGHTS@&#
We proposed a combinational feature extraction approach based on some nonlinear features extracted from Electro Cardio Graph (ECG) Reconstructed Phase Space (RPS) and usually used frequency domain features for detection of sleep apnoea.Here 6 nonlinear features extracted from ECG RPS are combined with 3 frequency based features to reconstruct final feature set.The nonlinear features consist of Detrended Fluctuation Analysis (DFA), Correlation Dimensions (CD), 3 Large Lyapunov Exponents (LLEs) and Spectral Entropy (SE).The final proposed feature set show about 94.8% accuracy over the Physionet sleep apnoea dataset using a kernel based SVM classifier.The data consist of 70 records, divided into a learning set of 35 records and a test set of 35 records.

@&#KEYPHRASES@&#
Sleep apnoea,Reconstructed phase space,Electrocardiogram,

@&#ABSTRACT@&#
Sleep apnoea is a very common sleep disorder which is able to cause symptoms such as daytime sleepiness, irritability and poor concentration. This paper presents a combinational feature extraction approach based on some nonlinear features extracted from Electro Cardio Graph (ECG) Reconstructed Phase Space (RPS) and usually used frequency domain features for detection of sleep apnoea. Here 6 nonlinear features extracted from ECG RPS are combined with 3 frequency based features to reconstruct final feature set. The nonlinear features consist of Detrended Fluctuation Analysis (DFA), Correlation Dimensions (CD), 3 Large Lyapunov Exponents (LLEs) and Spectral Entropy (SE). The final proposed feature set show about 94.8% accuracy over the Physionet sleep apnoea dataset using a kernel based SVM classifier. This research also proves that using non-linear analysis to detect sleep apnoea can potentially improve the classification accuracy of apnoea detection system.

@&#INTRODUCTION@&#
Sleep apnoea is defined as the momentary cessation or absence of breathing when one is sleeping [1]. Apnoeas are def ined as distinct pauses in human breathing where each breathing pause exceeds from 10s [2]. Sleep apnoea can be determined by using a sleep study or in clinical terms, polysomnography (PSG). The true cause of sleep apnoea is still unknown simply can be occurred if the airway of patient is too narrow then there will be a likelihood of obstruction. There are three types for Sleep apnoea consists of obstructive sleep apnoea (OSA), central sleep apnoea and mixed sleep apnoea. OSA is the most common. Central sleep Apnoea (CSA) is a neurological condition, which causes the loss of all respiratory effort during sleep and is also usually marked by decreases in blood oxygen saturation. With CSA the airway is not necessarily obstructed. Mixed sleep apnoea combines components of both CSA and OSA, where an initial failure in breathing efforts allows the upper airway to collapse.Heart rate variability (HRV) varies from wakefulness to sleep due to normal changes in the autonomic system activities. Sympathetic tone drops from wakefulness over Non Rapid Eye Movement (NREM) sleep stages, while it shows an increase in Rapid Eye Movement (REM) sleep [3]. Based on literature, it was recognized that the events of sleep apnoea are accompanied by concomitant cyclic variations in heart beat intervals of ECG signals [4], which consists of bradycardia during apnoea followed by tachycardia upon its cessation [5]. This pattern had been successfully used to detect sleep apnoea in patients with clinical symptoms for sleep apnoea. Several studies confirmed the finding that several new methods could recognize sleep apnoea from heart rate variability (HRV) changes [6–9]. As the dynamic pattern of HRV with OSA is by no means stationary, HRV analysis with wavelet decomposition was reported to be an efficient tool for screening OSA [7]. Apart from HRV analysis, complementary information can be obtained from the measure of variations in the QRS amplitude of ECG signals. As we breathe, positions of the ECG electrodes relative to heart change, thus modulating the amplitude of ECG signals. From this fact, surrogate respiration signal can be extracted, which is referred to as ECG derived respiration (EDR) [10]. Analysis of such signal was found to be useful in apnoea monitoring because absence or attenuation of respiratory effort is caused by obstruction of upper airway OSA [11,12]. A comparative study [11] on different algorithms for apnoea detection based on ECG signals reported that the concatenation of parameters of HRV and the EDR signal gave the best classification results. Several machine learning techniques, i.e., Linear and Quadratic Discrimant model [12], CART method [7], Bayesian hierarchical model [13] have been used for automatic recognition of OSA subjects based on the selected subset of parameters derived from HRV and EDR signals. However, one limitation of those studies is that these models did not allow for estimating relative severity of OSA.Recent researches [14] suggest that signal fluctuations could have non-random specifications and could play an important role in the determination of generating complex system dynamic. Cardiovascular system is a very complex system that generates ECG signal. Poor prognosis for cardiological patients with diminished heart rate variability (HRV) is clinically confirmed. Fluctuations in the frequency and time domain of ECG signal may reveal appropriate information on the dynamic characteristics lost with routine averaging or linear spectral methods. ECG signal is a quasi-periodic signal. So, we expect that we could extract useful information from ECG signal reconstructed phase space that are absent in usual frequency domain analysis.In this research, in order to have the benefits of spectral domain analysis and reconstructed phase space simultaneously, we combined the spectral features with phase domain features to have better classification results for detection of sleep apnoea. Three spectral parameters are combined with 6 nonlinear parameters extracted from ECG signal. The resulted 9 dimensional feature vector is fed to a kernel based Support Vector Machine (SVM) system for classification.As aforementioned, the proposed approach is based on the concatenation of frequency features and nonlinear features and classification of final feature set using a SVM based classifier. Fig. 1shows the overall structure of proposed approach. As shown in Fig. 1, three dimensional frequency features have been combined with 6 dimensional non-linear RPS-based features. In next step, SVM classifier is applied to 9 dimensional final feature set and final label input data will be selected as healthy or Apnoea. Six nonlinear features have been used are Detrended Fluctuation Analysis (DFA), Correlation Dimension (CD), 3 Large Lyapunov Exponents (LLE's) and Spectral Entropy (SE). In Section 3, our feature set will be described completely.In this section, our feature extraction approach will be described. In first part, the non-linear RPS-based features are explained and then introduced spectral domain features will be described.Using non-linear analysis will help us to understand dynamical specifications of ECG signals. The first step in nonlinear analysis of time series is phase space reconstruction (state-space embedding), so we define ECG phase space reconstruction and then non-linear features are introduced. The main step in an embedding approach is obtained from Sauer and Yorke [15] work. They considered the Takens work and some other similar theories to show that every time-delay map with sufficient dimension is an embedding and guarantees the topological equivalence with the original generating system dynamic. In addition, they found that if d0 be the dimension of the attractor obtained from a system using box-counting method, choosing d>2d0 guarantees that the reconstructed phase space of such a map is topologically the same as the true dynamics of the original system where d is the dimension of the reconstructed space [16]. Based on such a strong theory, we could use a time-delay based mapping from one-dimensional signal to the reconstructed phase space attractor. Suppose the samples of the ECG signal are given by S={s1, s2, …, sn}, and X={x1, x2, …, xN} shows the trajectory points resulted from the embedding process, using time-delay based mapping(1)X(n)=S(n),S(n−τd),…,S(n−(d−1)τd)where τddefines time lag value and d defines embedding dimension. So, to perform the embedding process, we have to properly estimate d, τd. We could estimate τdfrom the correlation among ECG samples. Narayanan [17] suggested using the mutual information measure for estimation of time lags between ECG samples as given by(2)I(T)=∑n=1N−TP(s(n),s(n+T)).log2P(s(n),s(n+T))P(s(n))P(s(n+T))where s(n) denotes ECG samples, P means probability function and I is the mutual information measure. The first minimum of I(T) is the optimum time lag value. We found τd=10 as the best value for time lag. Fig. 2shows the I(T) calculated across the various time delay values. To obtain the best value of τd, we analyzed all ECG signals from database and the dominant value is selected as the best value of time lag parameter. After fixing τd=10, we have to determine the value of embedding dimension. We use the false neighbor's measure to determine the embedding dimension. False neighbors are points on reconstructed phase space, initially far apart to come near to each other. We should select embedding dimension in a manner that false neighbor's percentage becomes minimum [18]. Using this measure, we found d=8 as the best value for embedding dimension of ECG signal. Fig. 3shows a 3D reconstructed phase space attractor for a sample ECG Signal from our dataset.The Detrended Fluctuation Analysis (DFA) is used to quantify the fractal scaling properties of short interval R-R interval signals. This technique is a modification of the root–mean–square analysis of random walks applied to non-stationary signals [19]. The root–mean–square fluctuation of an integrated and detrended time series is measured at different observation windows and plotted against the size of the observation window on a log–log scale. The root-mean square fluctuation of this integrated and detrended series is calculated using the equation(3)F(n)=1N∑k=1Ns(k)−sn(k)2The quantitative measure of the nature of trajectory is called Correlation dimension (CD) and the ranges of CD signify various diseases [20]. The CD of the attractor is calculated for HRV data using the following formula:(4)CD=limr→0logC(r)log(r)where the correlation integral C(r) is given by(5)C(r)=1N2∑x=1N∑y=1,x≠yNΘr−Xx−Xywhere Xxand Xyare points of the trajectory in the phase space, N is the number of data points in phase space, r is the radial distance around each reference point Xiand Θ is the Heaviside function. Fig. 4shows logC(r)/log(r) for an ECG Signal from a patient with apnoea. The slope of the line determines the CD parameters.We could define Lyapunov exponent of a system as the value of the rate of separation of two close trajectories in the phase space with initial separation δZ0 diverge(6)δZ(t)≈eλtδZ0where λ is the Lyapunov exponent of the system. As the rate of separation is sensitive to initial condition, we could use the maximum Lyapunov exponent as the final measure.There are several proposed schemes for calculation of Lyapunov exponents. One approach is presented in [18]. This method is based on projecting the data points in each neighborhood into the most densely populated regions of the phase attractor. Usual methods for estimating Lyapunov exponents are difficult to implement and unreliable for short length data. So, we followed a method proposed by [21] which is fast and reliable. Next to embedding process, we locate the nearest neighbors of each point in reconstructed phase space by searching for the points with minimizes the Euclidian distance to the point of interest.(7)dj(0)=minXjXj−XjˆLLE is then estimated from the mean separation rate of the nearest neighbors.(8)λ1(i)=1i⋅Δt⋅1(M−i)∑j=1M−ilndj(i)dj(0)where dj(i) is the pair of close points after i discrete-time steps, and Δt is the inverse of sampling frequency. In this paper, three largest Lyapunov exponents of the involved ECG signals are used. As the best dimension of reconstructed phase space was selected as 8, to obtain three largest Lyapunov exponents we should calculate 8 Lyapunov Exponents from Eq. (8) and then select three largest exponents. These three features were selected based on Fischer Discrimination Analysis. Linear discriminant analysis and the related Fisher's linear discriminant are methods used in statistics and machine learning to ﬁnd a linear combination of features which characterize or separate two or more classes of objects or events. The resulting combination may be used by a linear classiﬁer or more commonly for dimensionality reduction of features before applying to a more complex classiﬁer. Fisher discriminator analysis for a two-class problem leads to Eq. (9) which evaluates Fisher's measure or F-ratio,(9)Fratio(W)=WTSBWWTSWWwhere SBis the between class scatter matrix, SWis the sum of scatter matrixes and W is consisted of the largest eigenvectors of SW−1SB. Fisher's measure or “F-ratio” deﬁnes the ratio between classes scattering to within class scattering of data points. Higher value of F-ratio for a group of samples from different classes implies more discrimination power among the involved classes. So F-ratio value could be a measure to ﬁnd a properly pruned version of the original features. So, in order to choose appropriate Lyapunov exponents with maximum discrimination ability, a complementary test was done to conﬁrm the results obtained by this measure. By deleting Lyapunov exponents which have the smaller F-ratio, we could reduce the size of the LE's feature vector. Using this measure, finally three largest Lyapunov exponents were selected.Spectral entropy quantifies the spectral complexity of the time series. Application of Shannon's channel entropy gives an estimate of the spectral entropy of the process, where entropy is given by(10)E=∑kpklog1pkwhere pkis the probability density function (PDF) value at frequency k. The spectral entropy E (0<E<1) describes the complexity of the HRV signal. This spectral entropy E was computed for the various types of cardiac signal [22].Different researches verify that heartbeat intervals show significant fluctuations based on physical activities of the brain stem cardiovascular centers [23,24]. During sleep stage, especially deep sleep, the influence of internal parameters such as spontaneous body movements and rapid eye movement on the cardiovascular centers is minimal.Togo et al. [25] divided Heart Rate Variation (HRV) signal into three main categories: Very Low Frequency band (VLF: .003–.04Hz), Low Frequency Band (LF: .04–15Hz) and High Frequency Band (HF: >0.15Hz). By using wavelet analysis, they founded both stationary and non-stationary periodic patterns in the VLF range, the presence of which has been discussed but has not been fully established. Although, they explained that there is an endogenous rhythmic component in human HRV in the VLF range. Fig. 5shows three different frequency bands for ECG signals of a patient with apnoea.Based on this idea, we calculated spectral density for these three bands as our three spectral features. In order to achieve better classification results, we normalized these features and called them NVLF, NLF and NHF. As will be described in experiments results, these spectral features show good discrimination performance between patients with apnoea and healthy one.In order to discriminate Apnoeas from healthy ones, Support Vector Machine (SVM), which is known as a useful technique in the ﬁeld of statistical learning theory [25], is employed. This technique has been widely used in different signal processing, pattern recognition and classiﬁcation applications [26,27]. Classifying data is a common task in machine learning. Suppose some given data points each belong to one of two classes, and the goal is to decide which class a new data point will be in. In the case of support vector machines, a data point is viewed as a p-dimensional vector, and we want to know whether we can separate such points with a (p−1)-dimensional hyperplane. This is called a linear classifier. There are many hyperplanes that might classify the data. One reasonable choice as the best hyperplane is the one that represents the largest separation, or margin, between the two classes. So we choose the hyperplane so that the distance from it to the nearest data point on each side is maximized. If such a hyperplane exists, it is known as the maximum-margin hyperplane and the linear classifier it defines is known as a maximum margin classifier. After choosing the maximum margin hyperplane and margins, data Samples on the margin are called the support vectors. Because of SVM good performance, especially in the case of two-class discrimination problems, this technique has been selected as the classification method in this research for discrimination of apnoea. If the training data with k number of samples is represented by {xi, xj}, i=1, 2, …, k where x∈Rnis n-dimensional vector and y∈{+1, −1} is the class label of data. In SVM, the goal is to find a hyper-plane that separates the data with the minimum error. In this research, a kernel–SVM formulation, with Gaussian radial basis kernel functions [28] is used. Gaussian radial basis functions flexible kernels that allow smooth, curved decision boundaries. Gaussian radial basis kernel is defined as(11)k(xi,xj)=e−λxi−xj2,λ>0Sometimes this kernel parameterized asλ=12σ2

@&#CONCLUSIONS@&#
