@&#MAIN-TITLE@&#
Maximum and minimum stock price forecasting of Brazilian power distribution companies based on artificial neural networks

@&#HIGHLIGHTS@&#
We predict maximum and minimum day stock prices of power companies.The methodology is based on attribute selection and time series prediction.The most relevant attributes are determined by correlation analysis.The actual time series prediction is carried out by neural networks.The proposed methodology provides very good results.

@&#KEYPHRASES@&#
Stock price forecasting,Time series,Artificial Neural Network,Power distribution company,

@&#ABSTRACT@&#
Time series forecasting has been widely used to determine future prices of stocks, and the analysis and modeling of finance time series is an important task for guiding investors’ decisions and trades. Nonetheless, the prediction of prices by means of a time series is not trivial and it requires a thorough analysis of indexes, variables and other data. In addition, in a dynamic environment such as the stock market, the non-linearity of the time series is a pronounced characteristic, and this immediately affects the efficacy of stock price forecasts. Thus, this paper aims at proposing a methodology that forecasts the maximum and minimum day stock prices of three Brazilian power distribution companies, which are traded in the São Paulo Stock Exchange BM&FBovespa. When compared to the other papers already published in the literature, one of the main contributions and novelty of this paper is the forecast of the range of closing prices of Brazilian power distribution companies’ stocks. As a result of its application, investors may be able to define threshold values for their stock trades. Moreover, such a methodology may be of great interest to home brokers who do not possess ample knowledge to invest in such companies. The proposed methodology is based on the calculation of distinct features to be analysed by means of attribute selection, defining the most relevant attributes to predict the maximum and minimum day stock prices of each company. Then, the actual prediction was carried out by Artificial Neural Networks (ANNs), which had their performances evaluated by means of Mean Absolute Error (MAE), Mean Absolute Percentage Error (MAPE) and Root Mean Square Error (RMSE) calculations. The proposed methodology for addressing the problem of prediction of maximum and minimum day stock prices for Brazilian distribution companies is effective. In addition, these results were only possible to be achieved due to the combined use of attribute selection by correlation analysis and ANNs.

@&#INTRODUCTION@&#
Time series forecasting consists in a research area designed to solve various problems, mainly in the financial area [1–14]. It is noteworthy that this area typically uses tools that assist in planning and making decisions to minimize investment risks. This objective is obvious when one wants to analyse financial markets and, for this reason, it is necessary to assure a good accuracy in forecasting tasks. As mentioned in [15], the improvements on prediction models are not only very important, but also compelling. In this sense, we highlight the Autoregressive (AR), Moving Average (MA), Autoregressive Moving Average (ARMA) and the Autoregressive Integrated Moving Average (ARIMA) models, which have become widespread methods for time series forecasting.Nonetheless, when considering the analyses of processes or systems represented by time series, it is common to verify that the data presents a nonlinear behavior. In this context, intelligent systems, such as Artificial Neural Networks (ANN) [1–5,8,11,12,16–18], Fuzzy Inference Systems [6,9], and Neural-Fuzzy Systems [10,13,14,19] are considered useful approaches for addressing problems of time series forecasting.Regarding the forecast of stock market indexes, in [5], a comparison of intelligent systems to forecast the NASDAQ stock exchange index is presented. The intelligent systems used were: Dynamic Artificial Neural Network (DAN2), ANN with Multilayer Perceptron (MLP) architecture; and Generalized Autoregressive Conditional Heteroskedasticity (GARCH) combined with DAN2 and MLP. The authors used data set cross-validation in the training and testing stages, and it was noted that the MLP provides more reliable results than the other intelligent systems used in this comparison.In [12], the authors argue that time series of stock prices are non-stationary and highly-noisy. Thus, this has led the authors to propose the use of a Wavelet De-noising-based Backpropagation (WDBP) neural network to predict the monthly closing price of the Shanghai Composite Index. To prove the effectiveness of using WDBP for such predictions, the results provided by the WDBP approach were compared to the ones provided by the conventional backpropagation training algorithm for MLPs. This approach based on the combination of Wavelet Transform (WT) and backpropagation algorithm was designed intending to use the frequency decomposition characteristic of WT to extract the noise of the time series. The authors used data from January 1993 to December 2009; nevertheless, 80% of this data were used in the training stage and the remaining 20% were used for validation. After the validation stage, it was possible to notice that WDBP presented a MAPE (Mean Absolute Percentage Error) of 19.48%, while the MLP with conventional backpropagation achieved a MAPE of 24.92%.In [10], an Adaptive Network-based Fuzzy Inference System (ANFIS) was employed to predict the closing price of the Zagreb Stock Exchange Index Crobex (CRO). In this paper, the authors used historical data comprising a period beginning in November 2010 and ending in January 2012. Based on these data, the featured approach predicts the close for CRO in the five subsequent days. It was observed that the predictions have their errors increased for each day ahead, i.e., the 5th day presents, in terms of RMSE (Root Mean Square Error), an error of 0.5 greater than the 1st day.Due to inherent difficulties in forecasting closing prices, the authors in [4] propose forecasting the direction of change of the Brazilian oil company Petrobras (PETR4) stock price by means of ANNs. Such a prediction is not only an alternative to closing price forecastings, but also a very suitable prediction strategy for stock exchange transactions. The authors propose the use and construction of neural models based on MLP to predict the behavior of PETR4 closing price on the São Paulo Stock Exchange BM&FBovespa in a short-term horizon. Thus, this paper conducts a series of empirical tests to determine which variables will influence the prediction of the change of direction. By means of this methodology, it was possible to validate the ANNs with data acquired from January 2012 to November 2012, where a MAPE of 26.47% was obtained.Besides the above mentioned papers, other invaluable contributions to the field may be summarized in Table 1.From Table 1, it is possible to notice that most papers in the literature provide methodologies for determining closing prices and/or directions of change of specific stocks. Besides this, many of them use of intelligent systems due to the non-linearity of time series. In this context, it is possible to notice that ANNs are tools widely employed to forecast stock prices and then assist investors’ decision-making. Therefore, this paper is focused on predicting the maximum and minimum day stock prices of Brazilian power distribution companies as an alternative to closing prices and direction of change estimations (due to the difficulties in establishing trusted forecasts to home brokers and small investors), since it may help minimizing the investment risks of day-trades. This study aims at both using and analysing the response of the ANN, as well as defining the variables that most influence the maximum and minimum day stock prices forecast of the following Brazilian power distribution companies CPFL (CPFE3), CEB (CEBR3) and COSERN (CSRN3). It is noteworthy to mention that the selected companies have different stakes in the stock market and this is a factor that cannot guarantee the same influence of all the determined variables.This paper is organized as follows: Section 2 briefly differs classic from intelligent systems-based methods applied to time series forecasting; Section 3 introduces the proposed methodology and also presents the numerical results and discussions; and, at last, the main contributions of this paper are summarized and highlighted in Section 4.According to [15], forecasting based on a time series represents a means of providing information and knowledge to support a subsequent decision. Thus, the analysis of time series focuses on achieving dependency relationships between their historical data. For this reason, a time series may also be referred as a sequence of data specified at regular time intervals during a period. Consequently, the time series analysis is used to determine structures and patterns in historical data and, from this analysis, develop a model that predicts their behavior. So, prediction models aims at determining future values and/or trends of a time series, which are normally treated by means of regression models.There are some well-known statistical models that can be applied to time series forecasting. Among these models, we highlight the AR, MA, ARMA models that are commonly used to represent stationary time series. Stationary time series consists of data sets that have constant mean and variance along time. However, not every time series can be considered stationary, e.g., most of those found in industry, business and finance [15]. Based on this fact, the ARIMA model emerged and it can be considered as a generalization of ARMA, where the main consideration is taken when defining the polynomial AR model as a unit root model.As commented above, the ANNs have been widely applied in the forecasting of stock prices. Moreover, among the ANN architectures, the MLP is the most used due to the possibility of employing it in prediction problems [28]. Thus, it is noticeable that the proposed architecture is suitable for the maximum and minimum day stock prices forecast of Brazilian power distribution companies.One of the main characteristics of ANNs is their capacity of not only learning by means of examples, but also generalizing from the learned information. ANNs with multilayer perceptron architecture were employed in this work.The artificial neuron in Fig. 1consists of a mathematical model with n input terminals (x1, x2, …, xn−1 and xn, representing the dendrites) and a single output terminal (y, representing the axon). The synaptic behavior is simulated by means of synaptic weights (w1,w2,…,wn−1andwn), whose values can be either positive or negative. The neuron bias is represented by a threshold value (b). The activation function g is responsible for processing the received information (weighted received inputs and the neuron threshold value) and providing an output for the neuron. The artificial neuron operates in the following manner:1.signals are submitted to the inputs;each signal is multiplied by its respective synaptic weight;a sum between the weighted input signals and the neuron threshold value is calculated;this information is processed by the neuron activation function, producing an output.Mathematically, the output value of an artificial neuron is obtained as follows:(1)y=g∑i=1nwixi+b,where y is the output; g(·) is the activation function; n is the number of inputs; xiis the ith input;wiis the weight associated with the ith input; and b is the neuron threshold value.Many algorithms are found in the literature for the training process of ANNs; nonetheless, an algorithm denominated Levenberg-Marquardt has provided better results for the estimation of maximum and minimum day stock prices (Fig. 2).The activation function for artificial neurons in the hidden layer was the sigmoid function:(2)g1(u)=21−e−2u−1,whilst the activation function for the artificial neuron in the output layer was linear:(3)g2(u)=u.Fig. 3presents a block diagram that summarizes the methodology proposed in this paper. It is possible to notice that the method is initialized by the composition of a database and finalized by the evaluation of maximum and minimum day stock price forecasts of Brazilian power distribution companies.The block “Historical Data” represents the historical values of each stock price (Fig. 4), IBovespa (Fig. 5) and IEE (Electric Energy Index) (Fig. 6) indexes, and American dollar quotes (Fig. 7). The IBovespa is the most important index in the Brazilian stock market, which includes the fluctuation of all stock prices of the companies listed at BM&FBovespa; while IEE is a sectorial index whose objective is to measure the performance of the Brazilian electricity sector. Both indexes are considered here because IBovespa provides a general picture of the Brazilian stock market, while IEE provides a specific picture of the Brazilian electricity sector. It is worth mentioning that for all historical data was considered a horizon that begins in January 2008 and ends in September 2013.This data was submitted to a pre-processing stage, where a Weighted Moving Average (WMA) was calculated for a window of business days in the last 30 days, which corresponds to an average of 21 days. The purpose of this calculation is to filter possible fluctuations and then evidence trends in the stock prices. Thus, in this paper, we use a WMA for n terms mathematically expressed by:(4)WMAM=∑n=1Mnpn∑n=1Mn,where M=21 due to the number of days considered in the WMA. So, pncorresponds to the value M−n days before the current day. The objective of this WMA is to provide a quantitative analysis of the time series in a short-term, and the WMAs were calculated for the IBovespa and IEE indexes, the American dollar quote, and the stock prices (maximum and minimum day prices, opening price, closing price, bid price, and best ask price). All of these attributes are shown in Table 2.It should be understood from Table 2 that D is the current day whose values of maximum and minimum day stock prices will be predicted. In the proposed methodology, the only D-day attribute considered as a possible input for the ANNs is the stock's opening price. All the other possible inputs regard D−i-day attributes, where i varies from 1 to 5 in order to represent, at most, five days before day D. At last, due to the large participation of foreign investors in these companies, American dollar quotes were also considered as a possible input attribute. Thus, there is a total of 40 possible input attributes and two outputs of interest (minimum and maximum day prices).As a result, a pre-processing stage is extremely important to reduce the number of attributes and, then, use only the most relevant attributes in the forecast. Thus, an attribute selection based on a correlation analysis between a possible input attribute and the desired output is performed, in which the attributes with the highest correlation with the output are considered to predict the maximum and minimum day prices for each stock. The results of these correlation analysis for each stock are shown in Tables 3–5.After determining of all relevant attributes, the database was divided into two subsets, which were designated to train (composed by 75% of the total data) and validate (composed by the 25% of the remaining data) the ANNs. The training and validation stages were conducted off-line, because only the matrices of adjusted synaptic weights are important for the prediction task.Concerning the ANNs training stage, it can be observed that many algorithms are found in the literature. The best-known algorithm is the backpropagation. The main characteristic of this technique is the computation of gradient descent. However, in [29], an algorithm denominated Levenberg–Marquardt was proposed, which consists of an approximation of the Newton method. In this algorithm, an optimized iterative process of synaptic weights adjustment provide quicker convergence when compared with conventional backpropagation.Defined the training algorithm, each neural network was configured to reach a minimum mean square error of about 10−12 or a maximum number of epochs of about 250. Moreover, for all ANNs, we test topologies with one and two hidden layers. However, the ANNs with only one hidden layer were tested using 5, 10, 15, 20, 25 and 30 neurons. In contrast, the ANNs with two hidden layers were tested combining the neurons of the first and second hidden layers. The first hidden layer could assume 5, 10, 15, 20 and 25 neurons and the second hidden layer could assume 10, 15, 20, 25 and 30 neurons. For all neurons of hidden layers we use the sigmoid function for their activation and, in relation to the output layer (just one neuron), a linear function.To improve the forecasting process, one ANN was trained for each stock. All of the ANNs employed in this study were configured using the Neural Network Toolbox in Matlab.After training the ANNs, they were validated. In this way, the performance of each neural network was analysed by means of calculations of MAE (Mean Absolute Error), MAPE and RMSE, which are, respectively, shown in Eqs. (5)–(7):(5)MAE=1N∑i=1NPi−Pi¯,(6)MAPE=100N∑i=1NPi−Pi¯Pi,(7)RMSE=1N∑i=1NPi−Pi¯2.These calculations will be used below to evaluate the performance of each ANN in the task of predicting maximum and minimum day stock prices.As previously mentioned, the effectiveness of the ANN estimations were evaluated by the calculations of MAE, MAPE and RMSE. Thus, the best ANNs with one and two hidden layers are shown in Table 6(for prediction of maximum day prices) and Table 7(for prediction of minimum day prices); the pair in column “Number of Neurons” represents, respectively, the number of neurons in the first and second hidden layers. The results highlighted in bold on Tables 6 and 7 represent the best obtained results. It is noteworthy that both of them were determined with topologies that use just one hidden layer and only five neurons.Graphical results for the best ANNs that predicted the maximum and minimum day stock prices are respectively shown in Figs. 8and 9.The same analyses were carried out for the ANNs responsible to predict the CEBR3 maximum and minimum day stock prices. Tables 8and 9show the results for MAE, MAPE and RMSE, and the results highlighted in bold represent the best ones obtained.Figs. 10and 11show the graphical results obtained by the ANNs that could best predict CEBR3 maximum and minimum day stock prices.At last, these analyses were also carried out to predict the CSRN3 maximum and minimum day stock prices. Tables 10and 11show the results for MAE, MAPE ans RMSE, and the results highlighted in bold represent the best ones obtained.Notice that only the CSRN3 minimum day stock price forecast presented a better result without the attribute selection. However, the difference between MAPEs for the best ANN (with and without attribute selection) is smaller than 0.6%, and when analysing the overall performance of the proposed methodology by means of MAPE, we observed that the forecast is more effective with the correlation analysis among attributes.Figs. 12and 13show the graphical results obtained by the ANNs that could best predict CSRN3 maximum and minimum day stock prices.By means of these best ANN responses, it is noteworthy the importance of using correlation analysis among attributes as a pre-processing stage. Therefore, the proposed methodology, based on attribute correlation analysis and ANNs, is quite effective in forecasting such maximum and minimum day stock prices.

@&#CONCLUSIONS@&#
The proposed methodology for addressing the problem of prediction of maximum and minimum day stock prices for Brazilian distribution companies presents good results. So, it is important to note that the forecast results (considering the MAPE) for Maximum Day Stock Prices were lower than 0.9%. In contrast, the results obtained for Minimum Day Stock Prices were lower than 2.1%. These results were only possible to be achieved due to the combined use of attribute selection based on correlation analysis and MLP ANNs (except for predictions of Minimum Day Stock Prices of CSRN3). In this sense, we conclude that when working with time series for predicting maximum and minimum day stock prices, it is important to investigate what types of attributes should compose the database, i.e., what factors may influence the estimation by a time series.For this reason, indexes such as IBovespa and IEE were taken as possible input attributes, since they provide an indication of the general behavior of both the stock exchange and the electricity sector. Moreover, due to the large participation of foreign investors in these companies, American dollar quotes were also considered as a possible input attribute. Therefore, this paper also contributes to demonstrate that due to the different profiles of investors of power distribution utilities, their stocks can be influenced by different variables. Thus, it is extremely important to determine attributes that are relevant to the prediction of such stock.Another important aspect is the chronological organization of the database because the time factor is crucial to the predictability by means of a time series. Finally, the analysis of several ANNs topologies with the use of the Levenberg–Marquardt training algorithm allowed to obtain good results for all selected stocks (CPFE3, CEBR3 and CSRN3). Therefore, one can say that the preparation and preliminary analysis of data for the ANNs can be considered as an effective methodology for estimating the range of variation (maximum and minimum prices) of these stock prices, which can be used to assist and guide the investments in the electricity sector for day-trades.