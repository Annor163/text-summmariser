@&#MAIN-TITLE@&#
Parallel-type fractional zero-phase filtering for ECG signal denoising

@&#HIGHLIGHTS@&#
The fractional differintegral is used to enhance the compromise capability between ECG signal denoising and ECG signal information retention.The center Grüsnwald–Letnikov differintegral filtering technique is used to obtain zero-phase effect.The proposed technique exhibits excellent performances on visual sense and quantitative comparison.

@&#KEYPHRASES@&#
Fractional filtering,Zero-phase filtering,Parallel-type filter,Center Grünwald–Letnikov differintegrator,Electrocardiogram signal denoising,

@&#ABSTRACT@&#
In this paper, a parallel-type fractional zero-phase filtering technique based on the center Grünwald–Letnikov differintegrator is proposed. We first present a left and a right Grünwald–Letnikov differintegrators, which are generalized magnitude-and-phase modulations. By using them in parallel we obtain a center Grünwald–Letnikov differintegrator, essentially a parallel-type fractional zero-phase filter. And then a center symmetrical convolution mask is constructed to implement the proposed fractional zero-phase filter. The method presented eliminates the phase distortion while offering a better compromise between signal denoising and signal information retention than conventional filtering methods. To illustrate this, the differintegrator and conventional filters were applied to electrocardiogram signals. The results indicate that the method we propose has superior performance compared with conventional denoising methods.

@&#INTRODUCTION@&#
In recent years, computer-aided electrocardiogram (ECG) analysis has established itself as one of the most active research areas in health informatics [1–5]. Prior to automated analysis, the noises present in ECG signal need to be eliminated for accurate diagnosis. In real situations, an ECG recording is often corrupted by various kinds of noise and artifacts, e.g., power line interference, electromyographic (EMG) noise due to motion artifacts and muscle contraction, baseline wanders due to respiration and perspiration, instrumentation noise, etc [6]. Some of these contaminations severely affect the worth of ECG signal, especially when computer-aided algorithms are utilized. In general, power line interference is highly possible removed via analog filters. However, reliance on the analog components alone will not be sufficient to suppress noise from other sources. Specifically, analog filters introduce nonlinear phase shifts and their performance depends on instrumentations such as resistance, temperature and design. But in comparison, digital filters, being more precise and less erroneous, possess more advantages over them. Scholars have designed many signal denoising filters including order statistics filter, low-pass filter, Kalman filter, Wiener filter, etc. [7–10], and all of them can remove noises in varying degrees. However, these filters could lose signal details in the filtering process and cause blurring. The reason for the phenomenon of signal blurring is that all the above filters make use of integer-order integral to build their corresponding denoising model directly or indirectly, which seriously weakens the high frequency information in the original signal [11]. Hence, this leads to a loss of detailed information during signal denoising.Fractional calculus has been attracting the attention of scientists and engineers since long time ago, which helps the development of multiple applications. Since the 1990s, fractional calculus has been rediscovered and applied in an increasing number of fields, for instance, in several areas of digital signal processing [12–16], digital image processing [11,17–19], and digital filter design [20,21]. The biggest advantage of fractional integral of signal over traditional integral is that it is characterized by infinite memory, which helps to preserve the high frequency content when smoothing the signal [17]. Thus, when applied to digital signal, fractional integral could remove noises and preserve signal details. In the past, several definitions of fractional calculus (e.g., Riemann–Liouville, Caputo, Riesz, and Grünwald–Letnikov) have already coexisted [22,23]. Specifically on one hand, most of the theoretical setups of fractional calculus were done by mathematicians that paid their attention preferably to the so-called Riemann-Liouville and/or Caputo derivatives, but at the end they compared their models by using a numerical approach based on a finite number of terms from the series that define the Grünwald–Letnikov derivative. On the other hand, the available literature deals mainly with the left (causal) derivative. And it is common to use the Riesz potential [24] in situations where no preferred direction exists. As the Grünwald–Letnikov derivative is defined by limited discrete points, and digital signal is composed of discrete values, it is adopted by many researchers and scholars. Additionally, the Grünwald–Letnikov derivative, which is a straight generalization of the classic one, leads to formulae and equations that recover the classic ones when the order becomes integer [23–26]. Thus, there are inherent advantages to denoise digital signal through the integral under Grünwald–Letnikov definition. A detailed account of the origin of the Grünwald–Letnikov definition and its applications can be found in the monograph by Ortigueira [23].As we know, causal filtering typically introduces a phase shift in the result. In the case of FIR filter, it is possible to design linear phase shift filter which, when applied to data (using filter or convolution), simply delays the output by a fixed number of samples. As to IIR filter, however, the phase distortion is usually highly nonlinear [7]. The phase shift introduced by a causal filter sometimes can be a nuisance. By comparison, a zero-phase distortion is more desirable. Consequently, apart from magnitude, phase should also be considered when dealing with digital filter design. Zero-phase filtering helps preserve features to reappear at the exact location, where they occurred in the original waveform. But note that a zero-phase filter cannot be causal. Luckily, in many “off-line” applications, causality is not a requirement, and zero-phase filters are often preferred. In batchwise signal processing, there exist such a possibility that one can not only filter a signal forward in time, but also apply the filter backward on the filtered signal. From the phase point of view, backward filtering essentially generates phase which compensates the phase delay caused by forward filtering, and thus the result has precisely zero phase distortion [27]. And this procedure is referred to as forward-backward filtering. In [28], an average window is used as a zero-phase filter. Forward-backward filtering technique has been used in [29] to extract small biological signals from noises. Thanks to the reverse phase characteristics of backward filtering, an overall zero-phase effect can be achieved by cascading a fractional forward filtering with a fractional backward filtering, and vice versa [30]. The proposed fractional zero-phase filter [30] can not only effectively suppress the phase distortion in the filtering process but also better enhance the compromise capability between signal denoising and signal information retention than the conventional filtering methods do. Note that the forward-backward (cascade-type) filtering algorithms [27–30] can be expressed as the following processing scheme: first, the signal is filtered in the forward direction. Second, the filtered sequence is then reversed to produce a new sequence. Third, the new sequence is filtered once more. Finally, the output of the third step is reversed again. In this paper, a simple and skillfully designed parallel-type fractional zero-phase filter, which is a weighted linear combination of the left and the right Grünwald–Letnikov differintegrators, is proposed.The rest of the paper is organized as follows. Section 2 presents necessary theoretical background of the left and the right Grünwald–Letnikov differintegral. A parallel-type fractional zero-phase filter is designed in Section 3. Section 4 constructs a center symmetrical convolution mask to implement the proposed fractional zero-phase filter. ECG signal denoising experiments are conducted in Section 5 and the paper is concluded in Section 6.In this section, we introduce some basic concepts inherent in Grünwald–Letnikov derivative (also called Grünwald–Letnikov differintegral) [22,23] to facilitate the understanding of the steps in the subsequent sections.In our notation the first-order left (causal) derivative of f(t) calculated with increasing t can be written as(1)Dlf(t)=limh→0f(t)−f(t−h)h.We introduce the operatorDlnto represent the nth-repetition of the derivative. It is not a difficult task to repeat the procedure for successively increasing orders to obtain a general expression(2)Dlnf(t)=limh→01hn∑k=0n(−1)knkf(t−kh)where(3)nk=n!k!(n−k)!are the binomial coefficients, which can be replaced by(4)νk=ν(ν−1)(ν−2)⋯(ν−k+1)k!for non-integer n, i.e., ν. Therefore the expression (2) is readily extended to the νth-order left Grünwald–Letnikov differintegral(5)Dlνf(t)=limh→01hν∑k=0[(t−a)/h](−1)kνkf(t−kh)where the upper limit of the summation goes to infinity as the integer part [(t−a)/h] Molecular : t−a Denominator: h gets bigger (where t and a are the upper and lower limits of the differintegral, respectively). Left Grünwald–Letnikov definition unifies both nth differential and n-fold integral. Meanwhile, it generalizes this case to non-integer one (ν>0 means differentials while ν<0 means integrals). This is the reason for the term “differintegral”.The Fourier transform of the νth-order left Grünwald–Letnikov differintegral [31] can be expressed as(6)F[Dlνf(t)]=(iω)νfˆ(ω).The frequency function of the νth-order left Grünwald–Letnikov differintegral is(7)Hlν(eiω)=(iω)ν=|ω|νeiνπsgn(ω)/2.The magnitude response and the phase response are(8)Alν(ω)=|ω|νφlν(ω)=νπ2sgn(ω)respectively.On the contrary, the first-order right (anti-causal) derivative of f(t) calculated with decreasing t can be written as(9)Drf(t)=limh→0f(t)−f(t+h)h.Using similar deduction, we can write the νth-order right Grünwald–Letnikov differintegral as(10)Drνf(t)=limh→01hν∑k=0[(b−t)/h](−1)kνkf(t+kh)where b and t are the upper and lower limits of the differintegral, respectively. The Fourier transform of the νth-order right Grünwald–Letnikov differintegral [31] can be expressed as(11)F[Drνf(t)]=(−iω)νfˆ(ω).The frequency function of the νth-order right Grünwald–Letnikov differintegral is(12)Hrν(eiω)=(−iω)ν=|ω|νe−iνπsgn(ω)/2.The magnitude response and the phase response are(13)Arν(ω)=|ω|νφrν(ω)=−νπ2sgn(ω)respectively.From (8) and (13), we know that the left and the right Grünwald–Letnikov differintegratorsDlνandDrνare generalized magnitude-and-phase modulations. The magnitude response of the left Grünwald–Letnikov differintegratorDlνchanges with the frequency and the fractional power exponent, which is the same as that of the right Grünwald–Letnikov differintegratorDrνdoes. The phase response of the left Grünwald–Letnikov differintegratorDlνis delayed by νπsgn(ω)/2, which is the generalized Hilbert transform of frequency. It means that the left Grünwald–Letnikov differintegratorDlνis a fractional linear phase delay filter. However, the phase response of the right Grünwald–Letnikov differintegratorDrνis leaded by −νπsgn(ω)/2, which is contrary to that of the left Grünwald–Letnikov differintegratorDlν. It means that the right Grünwald–Letnikov differintegratorDrνis a fractional linear phase lead filter.Based on the relation between (8) and (13), we can design a fractional zero-phase filter through putting a left Grünwald–Letnikov differintegratorDlνand a right Grünwald–Letnikov differintegratorDrνin parallel.Definition 3.1We define the νth-order center Grünwald–Letnikov differintegratorDcνas a weighted linear combination of the νth-order left Grünwald–Letnikov differintegratorDlνand the νth-order right Grünwald–Letnikov differintegratorDrν(14)Dcν=12cos(νπ/2)(Dlν+Drν),ν≠2n+1,n∈ℤ.In this case, the νth-order center Grünwald–Letnikov differintegral can be expressed by the operatorDcνas(15)Dcνf(t)=12cos(νπ/2)limh→01hν∑k=0N(−1)kνk[f(t−kh)+f(t+kh)]where N= max{[(t−a)/h], [(b−t)/h]}.Remark 3.1The center Grünwald–Letnikov differintegral is more general than the Riesz potential(16)Iνf(t)=12Γ(ν)cos(νπ/2)∫−∞∞f(u)|t−u|1−νduν>0, ν≠1, 3, ⋯ and is a generalization of the classic symmetric derivative.Theorem 3.1The center Grünwald–Letnikov differintegratorDcνis a νth-order zero-phase filter.Proof: Suppose that the center Grünwald–Letnikov differintegratorDcνis applied to a finite input signal sequence f(t), i.e.,(17)Dcνf(t)=12cos(νπ/2)[Dlνf(t)+Drνf(t)].We can construct the Fourier identity as(18)F[Dcνf(t)]=12cos(νπ/2)[(iω)ν+(−iω)ν]fˆ(ω)and since(19)(±iω)ν=cosνπ2±isgn(ω)sinνπ2|ω|ν,the frequency response of the center Grünwald–Letnikov differintegratorDcνisHcν(eiω)=12cos(νπ/2)[(iω)ν+(−iω)ν]=|ω|ν.The magnitude response and the phase response are(20)Acν(ω)=|ω|νφcν(ω)=0respectively. Therefore, any signal going throughHcν(eiω)will have identically zero phase shift, that is, the center Grünwald–Letnikov differintegratorDcνis a νth-order zero-phase filter.Remark 3.2Input signal is filtered by a νth-order left Grünwald–Letnikov filter and a νth-order right Grünwald–Letnikov filter simultaneously. From the phase point of view, the fractional linear phase delay of the νth-order left Grünwald–Letnikov filtering and the fractional linear phase lead of the νth-order right Grünwald–Letnikov filtering mutually cancel and thus the result has precisely zero phase distortion.Remark 3.3The center Grünwald–Letnikov differintegratorDcνis actually a singular low-pass (ν<0) filter, or a singular high-pass (ν>0) filter (Fig. 1).Thus, to enhance the compromise capability between signal denoising and signal information retention, fractional zero-phase filterDcνcan be tuned by adjusting the differintegral order ν, superior to conventional zero-phase filters.Now, let us study how to use the left Grünwald–Letnikov differintegratorDlνand the right Grünwald–Letnikov differintegratorDrνto implement the center Grünwald–Letnikov differintegratorDcν. Based on formula (14), the structure of using a left Grünwald–Letnikov filterHlν(eiω)and a right Grünwald–Letnikov filterHrν(eiω)to implement the center Grünwald–Letnikov fractional zero-phase filterHcν(eiω)is shown in Fig. 2.Digital signal processing is based on discrete signals. Thus, the derivatives of a digital function are defined in terms of differences, i.e., h=1. When N (denotes [(t−a)/h] or [(b−t)/h]) is big enough, one can get rid of the limit symbols and the difference definitions of the left, the right and the center Grünwald–Letnikov differintegral are respectively expressed as(21)▵lνf(t)=∑k=0N(−1)kνkf(t−k),(22)▵rνf(t)=∑k=0N(−1)kνkf(t+k)and(23)▵cνf(t)=12cos(νπ/2)∑k=0N(−1)kνk[f(t−k)+f(t+k)]whereν≠2n+1,n∈ℤ.Note that the definitions (21)–(23) are approximate expressions, which simplify the left, the right, and the center Grünwald–Letnikov differintegral for multiplication and summation. Let(24)(−1)kνk=(−1)kν(ν−1)⋯(ν−k+1)k!≜ak.To compute the left fractional difference (21), one can spatially truncate the defined▵lνto form a convolution mask(25)Mlν=[am⋯a2a11]where the length of the maskMlνis m+1. We can therefore write the expression for the left fractional difference (21) as the convolution of f(t) andMlν(26)▵lνf(t)=f(t)★Mlν.Homoplastically, to compute the right fractional difference (22), one can truncate the defined▵rνto form a convolution mask(27)Mrν=[1a1a2⋯am]where the length of the maskMrνis m+1. Therefore the expression for the right fractional difference (22) is the convolution of f(t) andMrν(28)▵rνf(t)=f(t)★Mrν.The center fractional difference operator▵cνis applied to a finite input signal sequence f(t), i.e.,(29)▵cνf(t)=12cos(νπ/2)[▵lνf(t)+▵rνf(t)]or(30)▵cνf(t)=12cos(νπ/2)[f(t)★Mlν(t)+f(t)★Mrν(t)]or, given the distributivity of the convolution product(31)▵cνf(t)=f(t)★12cos(νπ/2)[Mlν(t)+Mrν(t)]or(32)▵cνf(t)=f(t)★Mcν(t)where the center symmetrical convolution mask (length 2m+1) of the center fractional difference operator▵cνis defined as(33)Mcν=12cos(νπ/2)[am⋯a2a12a1a2⋯am].Fig. 3shows the curves of the convolution mask (33) with ν=−0.5 and ν=0.5, respectively when m=100. Specifically, the left halves show the scaled curves of the convolution mask (25) and the right halves show the scaled curves of the convolution mask (27), respectively when ν=−0.5 and ν=0.5. We can also see that the two curves are even symmetrical and tend to zero at the left and the right ends, which are the two inherent properties of any zero-phase filter. Note that the symmetry where zero-phase comes is of great importance. And the latter property ensures a reasonable level of computational complexity.Remark 4.1Note that the magnitude response of the νth-order zero-phase filterDcνchanges with the frequency and the non-odd-integer power exponent. In the following ECG signal denoising experiments, the difference order ν belonging to the range of (−1, 1) is cautiously selected.Remark 4.2Theoretically the center fractional difference operator▵cνis only an approximation, for the length 2m+1 of the maskMcνis finite. The longer the mask is, the more accurate the result is, and the more complex the computation is. To get the trade-off between efficiency and complexity of the proposed fractional zero-phase filter, the length 2m+1≜L of the maskMcνis set to be 15 in the following experiments.In this section, we focus on investigating the performance of the parallel-type fractional zero-phase filter (FZP) at different fractional orders and then with different signal contaminations. The proposed algorithm is tested on the first channel of the visually clean ECG signal record 115, which comes from the MIT/BIH database [32].To investigate the performance of the FZP filter at different fractional orders, 50-Hz power line interference simulated sinusoidal noise [6](34)N(t)=A×sin(2×π×f×t)is added to the ECG signal, and the noisy signal is presented to the FZP filter at different orders. The parameter ν of the proposed FZP filter is selected to maximize the Signal-to-noise ratio (SNR) and minimize the mean-square error (MSE) of the ECG signal [30]. SNR and MSE are expressed as(35)SNR=10log10∑n=1Npx(n)2∑n=1Np(y(n)−x(n))2and(36)MSE=1Np∑n=1Np(y(n)−x(n))2respectively, where Npis the sampling points, x(n) is the original input signal, and y(n) is the output signal of digital filters. On one hand, from the energy point of view, SNR can be seen as the power ratio of signal to the noise. Thus, a larger SNR indicates that the background noise is less noticeable, which represents better performance of the signal denoising. On the other hand, MSE is a measurement of the tracking accuracy of the filtered signal to the original signal. And the smaller MSE is, the better the signal information retention performance is.The following sample uses the ECG signal corrupted by a 50-Hz disturbance whose noise level corresponds to the peak-to-peak amplitude of 0.15 mV, and filters the noisy waveform using FZP filtering at different orders. Table 1presents the comparison of SNR and MSE using FZP filtering at different orders. Note that, with the integral order ν decreasing to −1, the denoising capability (high-frequency noise) of the proposed FZP filter becomes stronger (Fig. 1). Nevertheless, in this sample, the maximum SNR and minimum MSE can be achieved by setting ν=−0.7. As is mentioned above, all the phenomena mean that lower order zero-phase filtering can lead to the loss of a lot of detailed information in the process of signal denoising and cause blurring. Thus, −0.7-order is suitable for this ECG filtering application. In addition, Fig. 4presents ECG signal with a 50-Hz disturbance noise and filtered signal using FZP (ν=−0.7, L=15). From Fig. 4, we know that the FZP-based method is effective in denoising the ECG signal with a 50-Hz disturbance noise.To compare the performance of different filtering methods, 50-Hz power line interference simulated sinusoidal noise, EMG interference simulated random noise, and synthetic interference simulated white Gaussian noise are respectively added to the ECG signal, and the noisy signals are presented to different filtering methods. As is known, Riemann-Liouville (RL) integrator and Grünwald–Letnikov (GL) integrator are the two commonly used fractional order smoothing filters because of their invaluable fractional linear phase shift properties [11,15,17]. Similarly, zero-phase Butterworth filter (BZP) and zero-phase average window filter (AZP) are the two commonly used cascade-type zero-phase smoothing filters [27–29,33,34]. Therefore, we present the application of RL (ν=−0.7, L=15), GL (ν=−0.7, L=15), BZP (12-order Butterworth low-pass filter with cut-off frequency of 40Hz is used as forward and backward filter), AZP (10 point averaging filter is used as forward and backward filter) and the proposed FZP (ν=−0.7, L=15) in the next quantitative comparison (QC) experiments.In Table 2, we can see the comparison of the results of the mentioned filters tested on ECG signal with a 50-Hz disturbance noise. It can be shown that SNR of the proposed FZP method is the largest among all the filters, while MSE of the proposed FZP method is the smallest. The denoising result of FZP has a better balance between smoothness and accuracy than the other four filters.EMG interference is due to muscle contractions and transient variance and duration of bursts which can be simulated by adding random noise to ECG signal[6]. Output SNR and MSN of the mentioned filters tested on ECG signal with random noise (μ=0, σ=0.15) are listed in Table 3, where we can see that the proposed FZP filter outperforms other smoothing filters in terms of SNR and MSE.Since white Gaussian noise has been widely implemented as synthetic interference to evaluate filter performance [8,35,36], all the above filters are tested on ECG signal with it (15dB), whose results are listed and compared in Table 4. From it, it is apparent that our method has advantages on two evaluation indices, SNR and MSE values.Tables 2–4 show that the proposed FZP filter provides better filtering results and achieves better immunity-to-noise performance than the other tested filters on the studied ECG signal, which further demonstrate an excellent compromise capability of the FZP filtering in tracking accuracy and filtering noisy ECG. This method may therefore serve as an effective framework for the model-based filtering of noisy ECG recordings.

@&#CONCLUSIONS@&#
