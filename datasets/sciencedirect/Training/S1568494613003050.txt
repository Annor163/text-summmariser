@&#MAIN-TITLE@&#
Neuro evolutionary model for weld residual stress prediction

@&#HIGHLIGHTS@&#
Modeling is done to predict weld quality using three intelligent tools.Performance is measured in terms of computational speed and accuracy.Results review that neural network trained with NN–GA–PSO outperforms other models.Developed model enhances industrial automation.

@&#KEYPHRASES@&#
Finite element method,Neural network,Genetic algorithm,Particle swarm optimization,Residual stress,X-ray diffraction,

@&#ABSTRACT@&#
Welding is an efficient reliable metal joining process in which the coalescence of metals is achieved by fusion. Localized heating during welding, followed by rapid cooling, induce residual stresses in the weld and in the base metal. Determination of magnitude and distribution of welding residual stresses is essential and important. Data sets from finite element method (FEM) model are used to train the developed neural network model trained with genetic algorithm and particle swarm optimization (NN–GA–PSO model). The performance of the developed NN–GA–PSO model is compared neural network model trained with genetic algorithm (NN–GA) and neural network model trained with particle swarm optimization (NN–PSO) model. Among the developed models, performance of NN–GA–PSO model is superior in terms of computational speed and accuracy. Confirmatory experiments are performed using X-ray diffraction method to confirm the accuracy of the developed models. These developed models can be used to set the initial weld process parameters in shop floor welding environment.

@&#INTRODUCTION@&#
Weld residual stress is a significant parameter in evaluating the quality of weldments. Quality of weld plays an important role in the performance of a welded product as it improves fatigue strength, corrosion resistance, creep life and reduces scrap and rework.However during welding, a substantial residual stress field may be induced, as it necessarily involves large temperature gradients from weld metal to bulk material. As residual stress affects the fatigue life of the welded component [10,11], it is essential to have precise knowledge of the variation of residual stress across the weld. Different experimental methods for measuring welding residual stresses are available like neutron diffraction [20], X-ray diffraction [17], deep hole drilling [19] holographic interferometry [15] magnetic barkhausen noise technique [5] and focused ion beam [7]. All these methods need special equipments and are expensive. These techniques are limited in obtaining the entire picture of the residual stress distribution in weldment.Finite element method [16,21] was applied to analyze residual stress during welding. Although the finite element method has emerged as one of the most attractive approach for computing residual stresses in welded joints, its application to practical analysis and design problems has been hampered by computational difficulties and also this method of obtaining residual stresses is not feasible for all welding parameters. Mathematical modeling methods such as analytical modeling [23] and numerical modeling [22] were applied to determine weld residual stress. Due to the inability of the mathematical models to explain the nonlinear properties existing between the input and output parameters, intelligent techniques such as Artificial Neural Network (ANN), fuzzy logic and expert system have emerged. ANN technique [13] can handle nonlinear problems efficiently since neural networks were reported to have the ability to learn based on examples and to predict output based on their learned knowledge. Artificial Neural Networks with back-propagation learning algorithm [2] has been used to predict weld residual stress. ANN trained with back-propagation learning algorithm cannot guarantee an optimal solution since it may converge to a set of sub-optimal weights from which it cannot escape [6]. Development of hybrid model can address this issue. Prompted by the weaknesses inherent in the two technologies and their complementary strengths, researchers have looked at ways of combining neural networks with other techniques such as genetic algorithm, particle swarm optimization algorithm, etc. Genetic algorithm [3] and particle swarm optimization [4] are being attempted in guiding the weight updating process in the networks for weld quality prediction. This paper addresses the development of a neuro evolutionary hybrid model (NN–GA–PSO model) for weld residual stress prediction.For the application of problems such as weight optimization in real world situations ANNs require large dimensions and time complexity is critical. Hence the idea of a hybrid model will be a suitable option. Employing genetic algorithm to search for the initial weights of neural network helps it to get optimized values [28]. The most obvious way of using GA based optimization in neural network is to use the GA to search the weight space of a neural network with a predefined architecture [13]. It is shown that the performance level of neuro-genetic hybrid techniques far exceeds the commonly used backpropagation type neural network [27]. Using the GA to train the neural network allows the network to be more versatile in its modeling capabilities. It is found that the genetically trained neural network outperforms the randomly initialized neural network [26].Like GA, PSO is used instead of backpropagation algorithm in neural network for the prediction of tool life [14]. GA and PSO are much similar in their parallel characteristics and to obtain both their excellent features a PSO–GA based hybrid is proposed [9]. GA model iteratively searches for several good individuals in the population, and make the population to emulate the best solutions found in that generation through reproduction, crossover and mutation operators. Hence it requires substantial computational time to perform decision making process [1]. The major problem with PSO is that it is premature convergence to sub-optimal weights. The basic concept behind this is that for global optimization PSO, particles converge to a point between the best of global and local best position is the same. For the local optimum it is not guaranteed. One reason of this problem is due to the flow of information between particles runs faster, leading to formation of similar particles to the loss of diversity, increasing the possibility of trapped in local optimal [24]. To overcome the limitations of individual tools and with the scope of enhancing efficiency neuro evolutionary hybrid approaches are proposed and developed.Construction of NN–GA–PSO model undergoes three stages of development. They are (a) data collection by finite element simulation, (b) building NN–GA–PSO model and (c) validation of the developed model.Finite element model for the prediction of residual stress of the butt weld joint is proposed, developed, tested and validated for various weld conditions and presented. Two mild steel plates of dimensions 100mm×45mm×10mm are modeled to form a butt weld and simulated using finite element analysis software ANSYS. Assumptions followed during the thermal and stress analysis are listed below:(i)The welding process is modeled as a single pass weld.Bottom surface of the weld area is fixed to prevent body movement.No penetration and overfill of the weldments are considered.Material properties of weld metal, bead metal and heat affected zone are both temperature and temperature-history dependent as in Fig. 1. A non-linear transient thermal analysis is conducted first to obtain the global temperature history generated during the welding process. Convention and radiation boundary conditions are applied to the model.The heat flux is applied over the weld bead as the load input to the thermal analysis. Eq. (1) gives the arc heat input.(1)q=ηa×V×IAwhere q is the arc heat flux in W/m2, ηa is the arc efficiency, V is the arc voltage in volts, I is the arc current in amps and A is the weld bead area in m2. Area of the weld bead is calculated by the empirical relations for the corresponding welding current, arc voltage and welding speed [12]. Welding speed is incorporated in the analysis using load step options. The governing differential equation for two dimensional transient heat transfer during welding is given in Eq. (2).(2)−∂qx∂x+∂qy∂y+Q=ρcp∂T∂twhere qxand qyare the components of heat flow rate vector per unit area in the plate (x; y), Q the heat generation, ρ the density, cpthe specific heat and (∂T/∂t) represents the temperature distribution with respect to time which is expected as the output from thermal analysis [18].The model is meshed with thermal element PLANE 55 for the weld bead region and PLANE 35 for the work piece. The quadrilateral shape of PLANE 55 and the triangular shape element of PLANE 35 make the developed finite element model properly meshed with suitable thermal, structural and material properties. The convection and radiation surfaces are meshed with Link34 and Link31. The real constant for the convection and radiation elements are specified. For the structural analysis, the thermal elements are converted to its corresponding structural elements i.e. Solid Quad 4 node 42 and Triangle 6 node 2. These elements are capable of exhibiting structural property without change in mesh structure used for thermal analysis. Four welding parameters are given as the input for this analysis and they are arc efficiency, voltage, current and welding speed. The working ranges of the parameters were taken from the American Welding Society handbook. The amount of heat input to the model is found as the product of arc efficiency, voltage, and current. A non-linear transient thermal analysis is conducted first to obtain the global temperature history generated during the welding process. In thermal analysis heat flux is given as the load (arc heat) to the workpiece incorporating welding speed in terms of load step time. At the end of the heat load an extra load step with time equal to the cooling time is added without any heat input. In the solution phase, this part of the analysis gives temperature distribution as the output and this result is stored in a separate file. The temperature distribution over time at a user-defined node is obtained. The defined node is in the workpiece or in weld bead. The mesh used in the stress analysis is identical to that in the thermal analysis and the meshed workpiece is shown in Fig. 2.Stress analysis is carried out with the temperatures obtained from the thermal analysis as the loading to the stress model. The output obtained out of this analysis is residual stress distribution over the workpiece after cooling. Residual stress is obtained at the required nodes using the time history postprocessor and recorded in the weld bead and in the workpiece/weld bead interface as shown in Fig. 3. Time-history postprocessor, enables to review stress analysis results at specific points in the model as a function of time. From Fig. 3 it is evident that the maximum residual stress is 62.2MPa (dark area) for a typical weld input.Results in Table 1results are used to train and test the proposed hybrid models.In the development of the NN–GA–PSO model used for this study, the weight initialization of the NN is done by GA and the training of the network is carried out by PSO, rather than the conventional backpropagation algorithm. GA technique is used for the determination of initial weights in the neural network. In GA, random values are generated and are considered to be the chromosomes of the initial population. Weights are extracted from the chromosomes using Eqs. (3) and (4). The extracted weights are applied to the neural network and the average error is compared with the fitness value for the optimum solution. If the average error is within the particular limits, that weights are considered as best fit weights else crossover operation or mutation is performed in the current population and repeat the same procedure until best fit weights are obtained. The flowchart of genetic algorithm used for weight initialization is shown in Fig. 4. Steps involved in weight initialization of neural network by genetic algorithm are given below.Step 1: Generate chromosomes randomlyStep 2: Equation to calculate weights Wkin each link of a typical neural network (2–2–2) from the randomly generated chromosomes is given in Eqs. (3) and (4)[25].(3)Wk=+Xkd+210d−2+Xkd+310d−3+…X(k+1)d10d−2,if5≤Xkd+1≤9(4)Wk=−Xkd+210d−2+Xkd+310d−3+…X(k+1)d10d−2,if0≤Xkd+1≤5where x1, x2, …, xnrepresents a chromosome, xkd+1, xkd+2, …, x(k+1)drepresent the kth gene in the chromosome and d represents gene lengthStep 3: Calculate the output in neural network for each chromosome and find out the absolute error between the target and output.Step 4: If the average error of all the chromosomes is with in a particular limit of fitness value, store the weights as best fit weights else perform crossover operation in the above chromosomes and repeat steps from step 2 to 4 until best-fit weights obtained.PSO is be used to replace back propagation algorithm of neural network. Thus the complexity of training using back propagation can be reduced with PSO and the speed and efficiency is improved in training the neural network.In PSO, particles remember its own past best position and the entire group's best overall position. Each individual Xi=(xi1, xi2, …, xid) in PSO flies in the search space with a velocity which is dynamically adjusted according to its own flying experience. For each particle (xid), calculate the fitness value. If it is better than the pBest (best fitness value in history), set current value as the new pBest. The particle with the best fitness value of all the particles is selected as gBest.In PSO algorithm, best fit weights obtained from GA are assigned in each link of neural network for each particle. pBest is the location of the best solution of a particle has achieved so far. gBest is the location of the best solution that any neighbor of a particle has achieved so far. Initially the best fit weight from GA is also considered as pBest and present weights. Velocity is calculated using Eq. (5) and added with the present weight in each link of neural network. For each particle, the newly calculated weights are compared with the pBest weights and the minimum error produced weights are stored in pBest. Initial velocity V is assumed to be 1 and gBest is the weights of minimum error produced particle. In Eq. (5), w is the inertia weight, rand1 and rand2 are random numbers, C1 and C2 are learning factors. Its values are assumed to be w=0.5, C1=C2=2.The flowchart of the proposed neural network training by particle swarm optimization algorithm, for residual stress prediction is given in Fig. 5. The steps followed in training of neural network by PSO algorithm is given below.Step 1: Assign the best fit weights obtained from GA to pBest and present weights.Step 2: For each particle, find out the absolute error by taking the difference between the predicted neural network output and desired (experimental) output.Step 3: Find out the particle with minimum error. Store the corresponding weights in gBest.Step 4: Find velocity of the particle using Eq. (5).(5)Velocity[]=wVelocity[]+C1rand1(pBest[]−present[])+C2xrand2(gBest[]−present[])Step 5: Add velocity to the present weights to get new weights.Step 6: Repeat steps 4 and 5 for other weights in that particle.Step 7: Calculate the network output and error with the new weights.Step 8: Compare the error produced by the new weights with the error produced by the pBest weights.Step 9: If the errors produced by the new weights are less, store the newly generated weights in pBest.Step 10: Assign the velocity of current particle to the initial velocity of next particle.Step 11: Repeat steps from 4 to 10 for all particles.Step 12: Find out the minimum error produced particle and store its weights in gBest and store its error in gBest error.Step 13: Compare gBest error with the goal. If goal is reached, the weights stored in the gBset are used for testing and on-line prediction.Step 14: If goal is not reached, repeat the steps from 4 to 13 until goal reached or maximum iteration reached.For training the network, maximum epochs were set to 30,000 and goal was set to 0.0001.The efficiency of prediction is determined by the percentage deviation of single sample data (Φi) and average percentage deviation (Φ′), defined asΦi=Rsm−RspRsm×100%Φ′=∑i=1mΦimwhere Rsm is actual residual stress by X-ray diffraction, Rsp is predicted residual stress by NN–GA–PSO model and m is number of sample data.Confirmatory experiments are done using X-ray diffraction method to prove the effectiveness of developed NN–GA–PSO model. Residual stress on the weldment after cooling was determined by an advanced solid state X-ray stress AST X2001 analyzer which works on solid state X-ray camera’ principle. AST X2001 analyzer uses a modified ψ-inclination technique [8] to measure residual stresses. Stresses were measured with Cr-Kct radiation yielding Cr 21 l-reflection at an angle of 2θ=145°81″. X-ray voltage is 30kV and the X-ray current is 5.8mA. The calibration distance ‘D’ is 49.49mm. Experimentation was carried out at Welding Research Institute, Tiruchirappalli, South India. Results from confirmatory tests are shown in Table 2.

@&#CONCLUSIONS@&#
