@&#MAIN-TITLE@&#
Structural topology optimization based on system condensation

@&#HIGHLIGHTS@&#
We present the topology optimization scheme combined with the system reduction.Design sensitivity based on the reduction system is evaluated.Proposed topology optimization scheme includes the mode tracking method.

@&#KEYPHRASES@&#
Topology optimization,Reduction system,Modal assurance criterion (MAC),Design sensitivity,Improved reduced system (IRS),

@&#ABSTRACT@&#
Topology optimization problem requires repeated evaluations of the objective function and design sensitivity in the design domain with various density distributions. A repeated computations in the optimization process, requires a large amount of computing time and resources. These issues have inspired the development of optimization techniques combined with a system reduction. In order to reduce the system, this study employs a system dynamic condensation method based on selected primary degrees of freedom. Based on a system reduction, this study performs a topology optimization to maximize the eigenvalue and linear summation of each eigenvalue. In the optimization procedure, mode tracking method, called MAC, is used to pursue target modes, and the design sensitivity is calculated by a method of the rigid body mode separation assuring the reliability of sensitivity regardless of the design variable perturbation size. Each result of the numerical examples based on the reduction system is compared to that of the full system. Through a few numerical examples, it is demonstrated that the proposed method can provide efficient and reliable results in topology optimization.

@&#INTRODUCTION@&#
Traditionally, the size and shape optimization has been the main stream in the structural optimization field. Besides these two kinds of optimization fields, topology optimization came into the limelight within decades. The definition of topology in mathematics stands for the invariant of spatial one-to-one mapping, which is continuous and includes the inverse mapping. However, size optimization, which treats the coefficient of a cross section, has a disadvantage, which is optimized within a given shape. Shape optimization, which deals with the modification of external shape, has a disadvantage in that the distorted mesh should be regenerated when elements are distorted during the optimization process. However, topology optimization has nothing to do with these disadvantages but is applicable for design without a basic layout.Topology optimization originated as layout optimization by Rozvany and Prager in the 1960s. After this outstanding work, Bendsøe and Kikuchi et al. developed topology optimization to minimize compliance in static problems [1–3]. Then, topology optimization for maximizing eigen-frequency has been studied by Ma and Kikuchi [4,5]. Even though many applications of topology optimization have been studied regarding to the static problem, topology optimization of dynamic problem has been limited for some reasons. The change of mode sequence during optimization of eigen-frequency makes the cost function non-smooth. Moreover, the sensitivity analysis of the cost function could be discontinuous and the optimization process of a vibration problem could be non-convex. The main root of these problems is related to the mode tracking conditions during the optimization process of eigen-frequency. If the optimization does not pursue reliable mode tracking, a proper sensitivity analysis is not guaranteed so that the improper mode tracking becomes the main obstacle in optimization. Then, it is required to pursue the correct target mode during the process of the topology optimization. Eldred et al. have proposed two kinds of the mode tracking methods for eigenvalue problem [6]. One is the higher order eigen-pair perturbation algorithm and the other is the cross-orthogonality check method. Even if the higher order eigen-pair perturbation algorithm guarantees quite accurate mode, it is not conformable to use the intermediate process of topology optimization [7]. In this paper, the cross-orthogonality check method, called modal assurance criterion (MAC), is used to track target eigenmode. MAC verifies the correlation between experimental and numerical mode shape [8]. For the application of MAC to the presented mode tracking in topology optimization, we aim at a standard eigenmode shape as a target mode shape at initial configuration. And, we compute the MAC value of the candidate eigenmodes of the updated structure configure to track the target mode shape in each iteration.The optimization process of eigen-frequency needs many repeated analyses in dynamic problems. In particular, the analysis of a large scale structure takes enormous computing time. To make up for this trouble, this study employs the reduction system, which is efficient in terms of calculating time and reliable in terms of accuracy. We propose for the first time a methodology of topology optimization combined with the dynamic condensation system. The reduction system has been applied to various research fields, such as eigenvalue analysis, sub-structuring schemes and structural optimization based on sub-domain [9–11]. The reduction system has been developed to improve the problems that consume excessive computing time and computer resources in large-scale analysis. There are two kinds of methods based on the primary degrees of freedom (PDOFs) and the mode-based structural reduced order model (ROM) in the reduction system. We use the reduction method, so called, condensation method, based on PDOFs which we selected by a two-level condensation scheme (TLCS) [9].The key issue in this study is how to perform the structural topology optimization by combining it with the reduction system. This study proposes an efficient topology optimization based on the system reduction. Section 2 briefly introduces the construction of the reduction system based on the PDOFs. Section 3 presents the general topology optimization including the mode tracking method. Section 4 evaluates the formulation of the sensitivity in topology optimization. Section 5 presents the maximization of the eigen-frequencies of a beam and plate by the proposed optimization method. Through numerical examples, the efficiency and reliability of the proposed method are demonstrated when the reduced system is applied to the topology optimization. The accuracy and efficiency of the reduced system approach for each example is compared to that of full system.In the process of the topology optimization, the eigenvalue and its design sensitivity is obtained by the reduction system based on PDOFs. Because the accuracy of the reduction system is highly dependent on the choice of PDOFs, the TLCS, which was verified by previous research, was used for the proper selection of the PDOFs. This scheme consists of two steps, the selection of the candidate area and PDOFs. In the first step, the scheme selects the candidate area by Rayleigh energy ratio. In the second step, the sequential elimination method (SEM) [12] is applied to determine the final PDOFs.Fig. 1 is the overall schematic of the TLCS [9]. Fig. 1(a) is the model configuration for analysis and Fig. 1(b) shows the selected candidate area, while Fig. 1(c) shows the PDOFs selected by the SEM. This method, which is based on the Improved Reduced System (IRS, [13]) was proposed for an efficient reduction system by Kim and Cho [9]. Section 2.1 and Section 2.2 briefly introduce the formulation of the two steps for constructing the reduction system. In the first step, in which the candidate regions for PDOFs are selected, the modified Rayleigh quotient considering the density of elements is evaluated to consider the void element in topology optimization.To obtain the Ritz vectors, an initial static vector{x1⁎}is calculated by static analysis as Eq. (1a). The first Ritz vector {z1} is obtained by the mass-normalization procedure of this static vector as shown in Eq. (1b).(1){{x1⁎}=[K]−1{F1}(a){z1}={x1⁎}/{x1⁎}T[M]{x1⁎}(b)where the entity of {F1} is the diagonal term of the mass matrix.The first Ritz vector which obtained from Eq. (1b) is used to find the next static vector in Eq. (2a). The ith static vector{xi⁎}which calculated in Eq. (2a) becomes Mass-orthogonal to the previously obtained Ritz vectors by the Gram–Schmidt procedure of Eq. (2b). Then, ith Ritz vector {zi} is obtained by the mass-normalization procedure of Eq. (2c).(2){[K]{xi⁎}={Fi},{Fi}=[M]{zi−1}(i>1)(a){xi⁎}={xi⁎}−∑k=1i−1[{xi⁎}T[M]{zk}]{zk}T(i>1)(b){zi}={xi⁎}/{xi⁎}T[M]{xi⁎}(c)Using the Ritz vectors obtained from the above procedure, the Rayleigh quotient λjof jth element can be calculated. To consider the void element in topology optimization, we modified the Rayleigh quotient of each element by dividing the density of the element as follows:(3)λj=∑i=1m{zji}T[Kj]{zji}{zji}T[Mj]{zji}×1ρjwhere ρjis the density of the jth element and the design variable. ‘m’ is the total number of Ritz vectors used for the calculation of Rayleigh quotient. [Kj], [Mj] are the stiffness and mass matrices of jth element, respectively.{zji}is the components connected with jth element in the ith Ritz vector. It is supposed to select n master elements. The Rayleigh quotient λjof jth element can be obtained as summing the Rayleigh quotient calculated by each Ritz vector from 1st to mth. After estimating λjfor all the elements in the full domain, the n elements with the smallest Rayleigh quotient λjare selected as candidate region for PDOFs.After process two, the DOFs inside of the selected area is defined as PDOFs and the remaining DOFs become the secondary degrees of freedom (SDOFs). With the PDOFs and SDOFs, a general eigenvalue problem is divided into PDOFs and SDOFs as Eq. (4).(4)[KppKpsKspKss]{φpφs}=λ[MppMpsMspMss]{φpφs}where {φp} and, {φs} are the vectors consist of PDOFs and SDOFs, respectively. The transformation relation between PDOFs and SDOFs is given in Eq. (5).(5){φ}={φpφs}=[ITIRS]T{φp}=[T]{φp}where[TIRS]=−[Kss]−1[Ksp]+[Kss]−1([Msp]−[Mss][Kss]−1[Ksp])[MG]−1[KG]and [KG], [MG] is Guyan’s reduction matrix [14]. By the transformation relation of Eq. (5), the final form of the reduction system is given in Eq. (6).(6)[KR]{φp}=λR[MR]{φp}where[KR]=[Kpp]+[TIRS]T[Ksp]+[Kps][TIRS]+[TIRS]T[Kss][TIRS][MR]=[Mpp]+[TIRS]T[Msp]+[Mps][TIRS]+[TIRS]T[Mss][TIRS].In the second step, the SEM is applied to the reduced candidate region of the system that was constructed from the first step. The SEM eliminates the SDOFs successively by removing the DOFs of which the ratio of stiffness to mass given as {Kii/Mii} is the highest. After removing SDOFs, the reduction system is obtained as Eq. (7).(7)[KIRS(m)]{φp}=λR[MIRS(m)]{φp}where[KIRS(m)]=[T(m)]T[KppKpsKspKss][T(m)],[MIRS(m)]=[T(m)]T[MppMpsMspMss][T(m)]and ‘m’ indicates the mth iteration. The transformation relation of Eq. (7) is given in Eq. (8).(8)[T(m)]=[ITIRS(m)]T[TIRS(m)]=−[Kss(m)]−1[Ksp(m)]+[Kss]−1([Msp(m)]−[Mss(m)][Kss(m)]−1×[Ksp(m)])[MG(m)]−1[KG(m)]In Eq. (8),[KG(m)],[MG(m)]is Guyan’s reduction matrix of mth iteration. After selecting the PDOFs through the second step, the final reduction system is constructed by the same procedure as in Eqs. (4)–(6). The detailed procedure is presented in Ref. [9].In the general topology optimization, the design variable is the density of each element or material property of the design domain. A solid element or void element is determined by the cost function and restriction conditions. From the view point of the structural design, there are two kinds of methods in topology optimization. One is the homogenization design method and the other is the solid isotropic material with penalization (SIMP). Even if the homogenization design method has an advantage, which is relaxation of the concept and domain in the continuum field, it is hard to implement the computational program. On the other hand, because SIMP has the same essence as the homogenization design method: It is easy to implement the computational program. Because of this advantage of SIMP, many researchers have employed the SIMP method for topology optimization. Topology optimization by SIMP chooses the density of elements as a design variable in the finite element method. The range of the design variable is defined between 0 (a void element) and 1 (a solid element) to express the exact density of each element. The material property is defined in proportion to the density of each element. The material property could be expressed as Eq. (9).(9)Ee(ρ)=E0ρepwhere E0 is the given material property of the structure, ρestands for the density of the element, and p is a penalization parameter. Because the design domain is continuum structure, ρehas a value from 0 to 1 and p has a value from 2 to 3. The material property can be varied as the penalization parameter p inFig. 2.The objective function of the present problem is to find an optimal topology maximizing the eigenvalue corresponding to the target eigenmode shapes subject to a mass constraint. The objective function is(10)Minimizef=−∑j=1mwjλj+cp∑e=1Nρe(1−ρe)Subjectto∑e=1N∫ΩeρedΩ−M0≤0In Eq. (10), λjand wjdenote the squares of the target eigenvalue and the corresponding weighting factors, respectively. cpis an additional penalty function to help convergence in the topology optimization. The design variable ρeis the density of the eth element and is subject to the following constraint:(11)0≤ρe≤1,e=1,2,⋯,Nwhere N is the total number of elements in the design domain.Eq. (11) states that the whole mass should be less than the prescribed mass M0, and that is bounded by M0. This topology optimization requires the solution of the eigenvalue problem. A general eigenvalue problem is given as follows:(12)[K]{φ(v)}=λ[M]{φ(v)}[K]=∑e=1Nρen[K0],[M]=∑e=1Nρen[M0]where [K] and [M] are the stiffness matrix and the mass matrix and λ and {φ(v)} are the eigenvalue and the corresponding eigenvector. The exponent n is defined as 2.For maximizing the eigenvalue, the mode tracking method is needed for good following target modes. In this paper, MAC is employed to pursue the reference mode shape. The definition of MAC is given as follows [8]:(13)MAC({φref},{φcan})=|{φref}T{φcan}|2({φref}T{φref})({φcan}T{φcan})where {φref} represents the reference of eigenmode shape and {φcan} represents the candidate eigenmode shape. The value range of MAC is between 0 and 1. If the value of the MAC is close to around 1, that means that {φcan} exactly satisfies the eigenmode shape of {φref}. On the other hand, the correlation of two eigenmodes decreases as the MAC value comes close to zero.For the optimization problem defined in Eq. (10), the numerical implementation of our study employs the feasible direction method, which is one of the direct search methods. To update the design variables during the optimization process, the derivatives of the objective and the constraint function with respect to the design variables must be calculated. In Eq. (10), differentiation of the objective function with respect to the design variable ρeyields Eq. (14).(14)f=−∑j=1mwjλj+cp∑e=1Nρe(1−ρe)⇒∂f∂ρe=−∑j=1mwj∂λj∂ρe+cp∑e=1N(1−2ρe)where ‘e’ is the number of the element, λjis the jth eigenvalue and wjmeans a weighting factor of the jth eigenvalue.The first term of the right side is the sensitivity of the eigenvalue regarding the design variable ρe. For the sensitivity analysis of the eigenvalue, we use the improved semi-analysis method (ISAM), which separates the rigid body mode of the vector field in a reduced manner. Previous research has confirmed that ISAM has a stable convergence rate in the sensitivity of displacement, stress and eigen-pair. In addition, it is also independent of the perturbation size [15,16]. Moreover, it would be highly efficient to employ the reduced system approach in a large-scaled eigenvalue problem [9]. It can remarkably save computing time for eigenvalue analysis and computer resource for storage. By the reduction system of Eq. (6), the eigenvector relative to PDOFs is obtained. The eigenvector information of SDOFs can be recovered by the transformation relation of Eq. (5). The full eigenvector system recovery process from the reduced PDOF eigenvector set is straightforward and it does not take computing time since only simple matrix multiplication is required. After recovering the full eigenvector from the reduction system, it is applied to the general eigenvalue problem of Eq. (12). Differentiating Eq. (12) with respect to a design variable v, the sensitivity of the eigenvalue is given as Eq. (15).(15)dλjdv=∑e=1N{φje}T([Ke]′−λj[Me]′){φje}{φje}T[Me]{φje}where ‘j’ is mode number and{φje}is the components connected with eth element in the jth Ritz vector.{φje}is decomposed into the pure deformation part{φje}εand rigid body mode part αk{rk}. It is presented in Eq. (16).(16){φje}={φje}ε+∑k=1rαk{r}k,αk={φje}ε⋅{rk}{rk}⋅{rk}where ‘r’ is the total number of the rigid body modes.By inserting Eq. (16) into Eq. (15), the derivative term of the stiffness matrix can be decomposed into two parts, that is, the pure deformation part and the exact rigid body mode part. It is evaluated as Eq. (17).(17)({φje}εT+αk{rk}T)[Ke]′({φje}ε+αk{rk})={φje}εT[Ke]′{φje}ε+∑k=1rαk{rk}T[Ke]′{φje}ε−∑k=1rαk{φje}εT[Ke]{rk}′−∑k=1r(αk)2{rk}T[Ke]{rk}′Considering these conditions [Ke]{rk}=0 and[Ke]′{rk}+[Ke]{rk}′=0, Eq. (17) can be simplified as Eq. (18).(18)({φje}εT+∑k=1rαk{rk}T)[Ke]′({φje}ε+∑k=1rαk{rk})={φje}εT[Ke]′{φje}ε−∑k=1r2αk{φje}εT[Ke]{rk}′As a result, the sensitivity of the jth eigenvalue with respect to the design variable v is evaluated as follows:(19)dλjdv=∑e=1N{φje}εT[Ke]′{φje}ε−∑k=1r2αk{φje}εT[Ke]{rk}′−λj{φje}T[Me]′{φje}{φje}T[Me]{φje}In general topology optimization process, the design variable is the density of each element, ρe. Considering Eq. (12) and Eq. (19), the sensitivity of the eigenvalue of Eq. (19) is evaluated as Eq. (20).(20)dλjdρ=∑e=1N[(nρe)⋅{φje}εT[Ke]{φje}ε−λj{φj}T[Me]{φj}{φj}T[Me]{φj}−∑k=1r2αk{φje}εT[Ke]{rk}′{φj}T[Me]{φj}]Here, ρeis the density of eth element and the derivative of the rigid body mode is evaluated by the chain rule as follows:(21){rk}′=∂{rk}∂x1∂x1∂ρe+∂{rk}∂x2∂x2∂ρe+∂{rk}∂x3∂x3∂ρe+∂{rk}∂x4∂x4∂ρeThen, the sensitivity of the objective function is given as Eq. (22).(22)∂f∂ρ=−∑j=1mwj∑e=1N[(nρe)⋅{φje}εT[Ke]{φje}ε−λj{φj}T[Me]{φj}{φj}T[Me]{φj}−∑k=1r2αk{φje}εT[Ke]{rk}′{φj}T[Me]{φj}+cp(1−2ρe)]In this section, two kinds of numerical examples that illustrate the characteristics and effectiveness of the proposed method are discussed. In the present study, we employ the four nodes hybrid stress shell element with drilling degree of freedom [17]. This element shows good performance in various problem such as dynamic analysis, eigenvalue problem and sensitivity calculation. Moreover, the performance of this mixed shell element is not sensitive to the mesh distortions. A benchmark problem maximizes the eigenvalue of a beam and a plate. The specific procedure of the topology optimization combined with system reduction and mode-tracking is given inFig. 3.This example maximizes the first eigenvalue and the second eigenvalue of the beam, respectively. The boundary is simply supported at the middle position on both sides. The configuration and material property for analysis is presented inFig. 4. For constructing the reduction system, 60 Ritz vectors are extracted to define the candidate region at the first step. About 20% of the total elements is selected as candidate areas through energy estimation by the extracted Ritz vectors. In the second step, 60 PDOFs are selected from the candidate area and the reduction system is constructed with the selected PDOFs.When the objective function maximizes the first eigenvalue,Fig. 5 shows the candidate area and PDOFs every-5-iteration until the 20th iteration process. The candidate area selected through the first step is shown in Fig. 5(a). The selected DOFs obtained from the second step are presented in Fig. 5(b). The nodes associated with the selected DOFs are depicted by black points.The sensitivity of the eigenvalue is calculated by the ISAM which separates the rigid body mode from the vector field as evaluated in Section 4. The ISAM guarantees the convergence of the sensitivity of the eigenvalue regardless of the perturbation size. The reliability of the ISAM is confirmed in Refs. [15,16]. Based on the sensitivity result, the topology optimization is performed by a sequential linear program (SLP).Fig. 6 shows the MAC values in each iteration. It can be confirmed that the MAC value is located near 1.0 which means a high correlation during the whole 30th iteration.As a result of optimization,Fig. 7 shows the first eigenvalue is maximized to 22.0. The final optimized configuration is given inFig. 8. It shows that the reduction system can assures the result of the topology optimization through a comparison between the reduction system and the full system.Fig. 9 shows the candidate area and PDOFs every 5-iteration when the second eigenvalue is to be maximized. The second eigenvalue is maximized to 266 as shown inFig. 10 and the final configuration is optimized showing the identical result between the full system and the reduction system as shown inFig. 11.The example of this section maximizes the linear summation of the first eigenvalue and the second eigenvalue of a beam. Here, λiindicates the ith eigenvalue and widenotes the weighting factor of the ith eigenvalue. To perform the topology optimization of the sum of each eigenvalue, the weighting factor for each eigenvalue should be defined. Thus, the weighting factors are defined as w1=1.0, w2=0.4. The candidate areas and PDOFs every 10-iteration is shown inFig. 12. From the result of the topology optimization shown inFig. 13, it is assured that the topology optimization based on the reduction system can be performed with reliability. This tendency is also shown in the next examples provided in Section 5.2.The next example is the application for a plate with a concentrated mass. It is constrained on each side by the fixed boundary conditions. The analysis conditions are given inFig. 14. A total of 384 plate elements with 432 nodes are used in the analysis.In the process of the reduction system, the total number of 60 Ritz vectors is extracted to define the candidate areas in the first step. Ten percent of the total elements are selected as candidate areas. Then, 60 PDOFs are selected out of the candidate area. After that, the reduced system based on IRS is constructed with the selected PDOFs. Every 15-iteration, the candidate area and PDOFs are shown inFig. 15. As a result of optimization, the first eigenvalue was maximized from 118.34 to 348.05 (Fig. 16). In this process, the MAC value was located between 0.9988 and 1.0, which means the target mode was followed well until the configuration was optimized. After 50 iterations, the configuration converged and its result is presented inFig. 17. Compared to a full system, the reduction system can guarantee the same result of topology optimization as the full system does.This example maximizes the linear summation of the first eigenvalue, the second eigenvalue and the third eigenvalue. The entire procedure is the same as that of previous numerical examples. After defining the candidate area with the Ritz vector, PDOFs are extracted from the candidate area. Then, the reduction system based on IRS is constructed with the PDOFs. The candidate areas and PDOFs every 20-iteration is given inFig. 18. λ1, λ2, λ3 stand for each sequential eigenvalue of a plate and w1, w2, w3 indicates the weighting factor of each eigenvalue. In this optimization, the weighting factor is defined as w1=1.0, w2=w3=0.05. Through the 60th iteration, the final optimal configuration is converged as shown inFig. 19.In this section, the computing time used in Sections 5.1 and 5.2 is compared between the reduction system and full system. The comparison cases of the computing time are the full system analysis, the candidate areas with 20% of the elements, the candidate areas with 10% of the elements, and the jumping scheme, which selects PDOFs every 5-iteration after the 10th iteration. Because the topology of the analysis model is remarkably changed up to the 10th iteration, the reduction system is updated every iteration up to the 10th iteration. After the 10th iteration, the jumping scheme is applied and the information on the PDOFs is updated using the TLCS every 5-iteration. The computing time of each analysis type is compared in theTable 1.In the result, the reduction method just requires 15–70% of the computing time of a full system. Then, through the comparison result, the reduction method does not only assure a reliable optimization result, which has only a marginal difference compared to the full system but it is more effective than a full system considering the computation time.

@&#CONCLUSIONS@&#
