@&#MAIN-TITLE@&#
Superconvergent second derivative recovery technique and its application in a nonlocal damage mechanics model

@&#HIGHLIGHTS@&#
A nonlocal finite element technique is proposed that is based on the superconvergent second derivative recovery methods.A way to construct element-based patches is proposed that is suitable for unstructured meshes.The proposed technique is implemented with a simplified Hessian matrix computation process.The proposed technique is verified by the recovery of the equivalent strains in a nonlocal damage mechanics model.

@&#KEYPHRASES@&#
Super-convergent patch,Nonlocal damage mechanics,Strain gradients,Finite element method,

@&#ABSTRACT@&#
This study proposes a nonlocal finite element technique that is based on the super-convergent patch (SCP) second derivative recovery methods. The SCP second derivative recovery methods are proven effective in evaluating the Laplacian of the equivalent strains at C0 linear elements. The element-based patches and their construction criteria are defined. Other patch-based techniques either are limited to structured meshes or only utilize nodal based patches for first derivative recoveries. The SCP technique has not previously been used to recover higher order (2nd and higher) strain derivatives. The proposed technique can deal with unstructured meshes with various element types and the patches are constructed in a fashion that greatly accelerates the evaluation of Hessian matrices. A numerical example of a strain gradient damage mechanics problem is given at the end. The results show that the proposed technique is capable of evaluating the Laplacian of the equivalent strains and has the potential for even higher order derivative recovery.

@&#INTRODUCTION@&#
The simulation of materials with softening behavior is generally a challenging topic, including damage mechanics, softening plasticity, etc. Classical continuum mechanics may fail in this regard when the ellipticity of the governing equations is lost, i.e., post peak mesh-dependent numerical solutions are usually seen. As a remedy, continuum models with nonlocal formulations have been introduced. There are two main types of nonlocal formulations, i.e., the integral type and the gradient type. Both formulations have been widely studied numerically. However, the difficulty in their finite element implementation still remains.Typically, in an integral type formulation, the nonlocal form F(x) of a local state variable f(x) is expressed as(1)F(x)=∫Ωα(x,ξ)f(ξ)dξwhere α(x,ξ) is a spatial weight function defined in the three-dimensional Euclidean space Ω. The weight function is normalized with(2)∫Ωα(x,ξ)dξ=1forx∈ΩThe nonlocal elasticity theories of Eringen and Edelen [1] were among the first to be implemented in finite element methods. Their nonlocality is usually incorporated into the stiffness matrices obtained from the material constitutive relation. Bazant and Chang [2], Pijaudier-Cabot and Bazant [3] also proposed an imbricate finite element procedure for the simulation of the strain-softening materials with similar ideas. However, it was reported that the imbricate finite element approach could fail due to zero energy modes instability. Similar approaches with nonlocal stiffness matrices can also be found in Refs. [4–6].Recently, Stromberg and Ristinmaa [7] proposed a way to obtain the nonlocal field through a spatial averaging process. The weighted integral is evaluated through the numerical integration of each finite element. Similarly, Jirasek and Marfia [8] also advocated a way to calculate the nonlocal quantity through a weighted spatial averaging process through the neighboring integration points in the mesh. This method is implemented in Refs. [9–11] as,(3)F(xk)=∑l=1NGPwlJlα(xk,xl)f(xl)(4)α(xk,xl)=α0(||xk−xl||)∑n=1NGPwnJnα0(xk,xl)where wland Jlare the integration weights and element Jacobian at the Gauss point xl. An approximate weight function with a cut-off radius needs to be determined for efficiency.On the other hand, gradient type formulations are also widely implemented. Typically, the nonlocal form F(x) can either be expressed in a local state variable f(x) and its gradients explicitly as,(5)F(x)=f(x)+c∇2f(x)or implicitly as,(6)F(x)−c∇2F(x)=f(x)where c is a constant related to the intrinic material length scale. The early attempts to implement gradient enhanced formulation in finite element methods usually treat a scalar nonlocal variable as an additional nodal parameter [12,13]. Hence, an additional equation with appropriate boundary conditions is combined with the local governing equations to form a coupled finite element formulation. (i.e., [14–25]) The main difficulty faced by a coupled formulation is to define an appropriate boundary condition for this additional equation. That boundary is usually a moving boundary. This topic is discussed in Ref. [26]. Sometimes, the moving boundary condition is relaxed to the external boundary of the whole body [18].In order to overcome this difficulty, Abu Al-Rub and Voyiadjis [27] proposed a way to evaluate the nonlocal variable through a so-called super element. Their idea is to evaluate the strain derivatives at each integration point by least square fitting the local strains at a structured set of neighboring integration points. Later, Abu Al-Rub and Voyiadjis [28] successfully applied this technique to an anisotropic damage model for a concrete fracture analysis. However, this method is only limited to a structured mesh.Later, Han et al. [29] also proposed a finite element approach that can recover the strain derivatives by using nodal based patches. The patch least square fitting process is conducted to obtain the nodal nonlocal values. The benefit of this method is that it is no longer limited to structured meshes, however, only the nodal based patches are built in this method and it is so far only be utilized to evaluate the first derivatives of the strain, besides, no unstructured mesh examples were tested.This paper proposes a nonlocal unstructured finite element technique that is based on the super-convergent patches (SCP). Therefore, a brief review on the related SCP techniques is also given below.Zienkiewicz and Zhu [30–32] were among the first to introduce the idea of obtaining a smooth variable field by utilizing patches of elements in the finite element methods. For each patch of elements, the discontinuous derivative field is sampled at the super-convergent points inside each element and a set of local least square fit nodal variables are obtained to yield the continuous derivative field. Zienkiewicz and Zhu [30] verified that the above mentioned least square fit process would give a first derivative estimation that is accurate at least to the order of O(hp+1), where h is the size of the element and p is the order of the interpolation function. Therefore, this patch recovery process is widely known as the super-convergent patch recovery. They also showed that this process is numerically effective in its applications in a posteriori error estimates.Wiberg and coworkers [33–35] later improved the SCP technique by least square fitting the higher-order derivatives at the superconvergent points. They showed a higher accuracy of the first derivative recovery than Zienkiewicz's approach by using one-order higher polynomials. Most recently, Jefferson [36] and Akin [37] further extended the SCP technique to recover the second derivatives, and various element-based patches were tested. Error estimations and adaptive element methods were also developed to achieve a high accuracy of the second derivatives recovery.The present work establishes a new nonlocal finite element technique that is based on the super-convergent patch recovery technique of the second order derivatives. The SCP element-based patches are defined and implemented. Algorithms are developed to recover the second derivatives of the equivalent strain through a local least square fitting process at each SCP patch. The algorithm is implemented in an F95 program — library MODEL [37]. The second derivatives of the scalar equivalent strain are recovered from the element-based patches. The proposed recovery technique allows an unstructured mesh with arbitrary element types and arbitrary, but compatible polynomial patch degrees.A scalar variable based nonlocal rate-independent isotropic damage model is utilized to test the proposed technique as introduced in Jirasek [38]. The damage densityωis controlled by the damage evolution function g(κ) as,(7)ω=g(κ)where κ is the damage threshold. In this paper, g(κ) is defined to have an exponential softening behavior as,(8)g(κ)={0κ≤ε01−ε0κexp(−κ−ε0εf−ε0)ε0≤κ≤εfwhereε0is the limit elastic strain andεfis a scalar parameter that controls the softening behavior. The nonlocal equivalent strainε˜eqis expressed explicitly from the local equivalent strainεeqand its Laplacian as,(9)ε˜eq(ε)=εeq(ε)+l2∇2εeq(ε)where l is a intrinsic material length scale.Instead of using higher order inter-element continuity elements (i.e., C1 and C2 elements), the proposed technique will recover the second order strain gradients from a patch of neighboring elements through a least square fitting process. In this regard, C0 elements suffice. The patch has its own interpolation functions and nodes, just like a larger size element.Fig. 1 shows the three element gathering criteria that can be used to construct a patch, i.e., element-based, face-based, and nodal-based. The selection of the patch element shape is based on the shape of its parent element.Upon input of an unstructured mesh, the connection topology is examined to create the list of all element neighbors of each and every element in the mesh. That list is also flagged to denote a subset of those elements share a “face” with the element. The element neighbor list is used to define that element's patch members and that element is named as the patch's parent element. The elements in the patch are assumed to be C0, but they can be different parametric types (such as a mixture of linear triangles and bi-linear quadrilaterals) and have different interpolation functions.As shown inFig. 2, the patch or the parametric patch element (PPE) is first selected to be the same as the parametric shape as the parent element in the patch (a square, right triangle, brick, wedge, etc.). The interpolation degree of the PPE is set to be one or two degrees higher than the interpolation degree of the parent element at the center of the patch. The size of the PPE mapping into physical space is defined by the space occupied by the element and either the full neighbor list or just the “facing” neighbors. This is achieved by specifying the outmost coordinates of the element nodes in that patch.So long as the mesh connectivity does not change, each PPE and it's Jacobian, remains unchanged. If the problem involves large deflections only the PPE Jacobian (and its inverse) needs updating. That is done by using the updated coordinates of the nodes in the patch.After a solution has been obtained for the primary variables (displacements), an element loop is executed to obtain their first derivatives (and strains) at each quadrature point in each element. Those data are stored for later use in plotting and/or for error estimation and/or for second derivative estimations. A second loop over all the elements is executed for the later calculations. One could estimate the second physical derivatives, in the parent element of the patch, by taking the first parametric derivatives of the PPE interpolation of the first physical derivatives and scaling them to physical values by using the inverse of the constant diagonal Jacobian of the PPE.To carry out the least square fit there must be more quadrature points in the elements in the patch than the number of nodes used for the PPE interpolations. Since each element type in the patch has an assigned number of quadrature points it is easy to count the number of data points in the active patch. If that number is sufficiently large, then the degree of the PPE interpolation could be increased by one or two. That is, a parametric element with more nodes could be selected to be the PPE. In the current application, the degree of the PPE is usually one degree higher than that of the primary variable interpolation. The fit to the patch quadrature point data is done using a singular value decomposition algorithm.The relationship between the second parametric derivatives and the second physical derivatives is obtained as,(10){∂2∂ξ2∂2∂η2∂2∂ξ∂η}=[∂2x∂ξ2∂2y∂ξ2∂2x∂η2∂2y∂η2∂2x∂ξ∂η∂2y∂ξ∂η]{∂∂x∂∂y}+[(∂x∂ξ)2(∂y∂ξ)22∂x∂y∂ξ∂ξ(∂x∂η)2(∂y∂η)22∂x∂y∂η∂η∂x∂ξ∂x∂η∂y∂ξ∂y∂η∂x∂η∂y∂ξ+∂x∂ξ∂y∂η]{∂2∂x2∂2∂y2∂2∂x∂y}Eq. (10) shows that the Hessian matrix is usually nonsymmetrical. However, the patches are constructed such that their local coordinate systems are parallel to the global coordinate system. For example, as shown in Fig. 2, the quadrilateral PPE is built such that its sides are parallel to the global axis x and y. The triangular PPE is built as a right triangle such that its legs are parallel to the global axis. Such an alignment of the patch elements offers a linear mapping between the local coordinates and the global coordinates. The patch Jacobian is constant and diagonal in this case. Therefore, the first rectangular matrix on the right hand side of Eq. (10) is zero. If in addition, the Jacobian is diagonal, then,(11)∂x∂η=∂y∂ξ=0Therefore, for the patch construction process given above, Eq. (10) reduces to(12){∂2∂ξ2∂2∂η2∂2∂ξ∂η}=[(∂x∂ξ)2000(∂y∂η)2000∂x∂ξ∂y∂η]{∂2∂x2∂2∂y2∂2∂x∂y}Then, we just need to calculate the inverse of the diagonal square matrix on the right hand side to obtain the physical second derivatives. The computation of the Laplacian from the diagonal Hessian matrix for the two-dimensional patches is finally simplified as,(13){∂2∂x2∂2∂y2}=[(∂x∂ξ)−200(∂y∂η)−2]{∂2∂ξ2∂2∂η2}To compute the Laplacian, one does not need the second cross derivative. Since other applications may require them they are calculated. For numerical approximations, the cross derivatives may not be identical (∂2/∂x∂y≠∂2/∂y∂x), so their average values are retained.It has been shown that the gradient type nonlocal damage mechanics involves the evaluation of the second derivatives (Laplacian) of the equivalent strain. For each patch, a local least square-fitting problem is to be solved. Eq. (9) is rewritten with the incremental nonlocal equivalent strainΔε˜eq(x)as,(14)Δε˜eq(x)=Δεeq(x)+l2∇2Δεeq(x)The local least square-fitting problem to be solved is(15)min||Δε^eq−Δεeq||For example, in a two-dimensional problem, the patches are utilized to construct a smooth surfaceΔε^eq(x)by approximating the local equivalent strain field. If [H(x,y)] is the patch interpolation function, and {d} is the nodal value of the patch fitted equivalent strain increments, then(16)Δε^eq(x,y)=[N(x,y)]{d}The local equivalent strain increments are usually sampled at all the nqpquadrature points in the patch,(17)Δεeq={a}={Δεeq1,⋯,Δεeqnqp}TThe corresponding normal equation to be solved for Eq. (15) can be expressed as the summation over the quadrature points in the patch as,(18)(Σq=1q=nqp[H(xq,yq)]T[H(xq,yq)]){d}=(Σq=1q=nqp[H(xq,yq)]Taq)The patch nodal solution is obtained as,(19){d}=(Σq=1q=nqp[H(xq,yq)]T[H(xq,yq)])−1(Σq=1q=nqp[H(xq,yq)]Taq)Therefore, the Laplacian∇2Δεeq(x)are evaluated from the continuous surface obtained as(20)∇2Δεeq=[∇2H(x,y)]{d}where(21)[∇2H(x,y)]=[∂2H(x,y)∂x2+∂2H(x,y)∂y2]To calculate the Laplacian, two second partial derivatives are required and thus saved, they are(22)∂2Δε^eq∂x2=[∂2H(x,y)∂x2]{d}and∂2Δε^eq∂y2=[∂2H(x,y)∂y2]{d}After looping over all the patches in the mesh, every node within the mesh would receive multiple values of the strain gradients. Therefore, a nodal averaging process is necessary to obtain the unique smoothed strain gradients at each element node, and then the strain gradients are interpolated back to the quadrature points in each element and the Laplacian of the equivalent strains are calculated subsequently.A classical three point bending test previously done by Jirasek [38] is simulated in this paper to test the proposed nonlocal finite element technique. The concrete beam tested has a square cross section area of 100×100mm2. The span of the beam is 450mm. For the beam with a notch, a 5mm wide and 50mm deep notch is set at the center of the beam throughout its thickness.Fig. 3 shows the two-dimensional plane stress model used for the simulation. Assume an exponential softening material as defined in Eq. (8). The Young's modulus E=20GPa and the Poisson's ratio γ=0.2. The damage parameters are kept the same as in Ref. [38] with ε0=9.0e−5 and εf=7e−3.The bending tests are run on both notched and unnotched beams. For each case, three meshes with different element sizes are built. As shown inFig. 4, the notched beam's mesh sizes are 5mm, 2.5mm and 1.6mm; while those of unnotched beam are 15mm, 7.5mm and 5mm. The elements used are the bi-linear four node quadrilaterals (Q4) with a standard 2×2 Gauss quadrature rule. For Q4 elements, the patches are constructed as bi-quadratic quadrilateral elements (Q9).

@&#CONCLUSIONS@&#
A nonlocal finite element technique was developed for the implementation of a strain gradient type nonlocal damage mechanics model. The SCP based second derivative recovery method is proven effective for evaluating the Laplacian of the equivalent strains at C0 linear elements.The Laplacian of the equivalent strains are recovered through a nodal averaging process. Generally, after the patch looping, all element nodes receive multiple second derivative values; therefore, an additional nodal averaging process was utilized to get the arithmetic mean of all the received second derivatives. Other nodal averaging criteria can also be considered.The proposed technique performs better for the domains with smooth boundaries. For domains with sharp corners like notches, the elements used to consist the patches at that corner may not evenly spreads the patch which would introduce inaccuracy for the patch least square fitting process.Secondly, the proposed technique is only tested for explicit type nonlocal formulations. The implementation in an implicit type nonlocal formulation will be different since that is generally a boundary value problem to be solved. Future study in these two regards is highly recommended.