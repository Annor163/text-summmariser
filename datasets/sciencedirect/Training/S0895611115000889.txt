@&#MAIN-TITLE@&#
Classification of multiple sclerosis lesions using adaptive dictionary learning

@&#HIGHLIGHTS@&#
We classify multiple sclerosis lesions using adaptive dictionary learning.Separate dictionaries are learned for the healthy brain tissues and lesion classes.Tissue-specific information is incorporated by learning dictionaries for each tissue.Adapting dictionary sizes based on complexity of data gives better classification.

@&#KEYPHRASES@&#
Sparse representations,Adaptive dictionary learning,Computer aided diagnosis,Magnetic resonance imaging,

@&#ABSTRACT@&#
This paper presents a sparse representation and an adaptive dictionary learning based method for automated classification of multiple sclerosis (MS) lesions in magnetic resonance (MR) images. Manual delineation of MS lesions is a time-consuming task, requiring neuroradiology experts to analyze huge volume of MR data. This, in addition to the high intra- and inter-observer variability necessitates the requirement of automated MS lesion classification methods. Among many image representation models and classification methods that can be used for such purpose, we investigate the use of sparse modeling. In the recent years, sparse representation has evolved as a tool in modeling data using a few basis elements of an over-complete dictionary and has found applications in many image processing tasks including classification. We propose a supervised classification approach by learning dictionaries specific to the lesions and individual healthy brain tissues, which include white matter (WM), gray matter (GM) and cerebrospinal fluid (CSF). The size of the dictionaries learned for each class plays a major role in data representation but it is an even more crucial element in the case of competitive classification. Our approach adapts the size of the dictionary for each class, depending on the complexity of the underlying data. The algorithm is validated using 52 multi-sequence MR images acquired from 13 MS patients. The results demonstrate the effectiveness of our approach in MS lesion classification.

@&#INTRODUCTION@&#
Multiple sclerosis is a chronic, autoimmune disease of the central nervous system (CNS). It is characterized by the structural damages of axons and their myelin sheathes. Magnetic resonance imaging is the best paraclinical method for the diagnosis of MS, assessment of disease progression and treatment efficacy [1,2]. These images are analyzed to find the number and spatial patterns of the lesions, appearance of new lesions and the total lesion load, which are key parameters in the current MS diagnostic setup. Manual segmentation of MS lesions, however, is a laborious and time consuming task, pertaining to the requirement of analyzing large number of MR images. Furthermore, it is prone to high intra- and inter-expert variability. Several MS lesion segmentation methods have been proposed over the last decades, with an objective of handling large variety of MR data and which can provide results that correlate well with expert analysis. These methods are based on supervised or unsupervised approach and use different image features and classification strategies to model lesions [3,4].Over the last few years, sparse representation has evolved as a model to represent an important variety of natural signals using a linear combination of a few atoms of an over-complete dictionary. Dictionary learning, a particular sparse signal model, aims at learning a non-parametric dictionary from the underlying data. The representation of data in such a manner has led to the use of sparse representations and dictionary learning in many image processing applications such as image restoration [5,6], inpainting [7], face recognition and texture classification [8,9].The ability of sparse representations to approximate high-dimensional images using a few representative signals in a low-dimensional subspace and the development of efficient sparse coding and dictionary learning techniques offer a great advantage in medical image analysis. Recent publications have demonstrated the effectiveness of sparse representation techniques in medical applications such as shape modelling [10], constructing a structural brain network model [11] and predicting cognitive data from medical images [12]. In addition, the dictionary learning framework has been used in deformable segmentation [13], image fusion [14], super-resolution analysis [15], denoising [16,17], deconvolution of low-dose computed tomography perfusion [18,19] and low-dose blood-brain barrier permeability quantification [20]. In each of these applications, the dictionaries are learned from the underlying data so that they are better suited for representation of the signal of interest. On the other hand, the discriminative dictionary learning approaches proposed for image segmentation focus on learning dictionaries which are representative as well as discriminative [21,22]. In this paper, we propose a novel algorithm, for classification of multiple sclerosis lesions, which incorporates discrimination in the dictionary learning framework by adjusting the size of the dictionaries according to the complexity of the underling data. Previous works [23,24] have also reported the effects of the dictionary size in image classification. We investigate this in the particular case of classification.In the past, Weiss et al. [25] proposed dictionary learning based MS lesion segmentation method by learning a single dictionary with the help of healthy brain tissue and lesion patches. The lesions are treated as outliers and lead to a higher reconstruction error when decomposed using this dictionary. There are several shortcomings in this method. The method uses only FLAIR MR images for analysis of clinical data. However, MS lesions appear in different intensity patterns in various MR sequences, which include T1- (T1-w MPRAGE), T2- (T2-w) and Proton Density-weighted (PD-w). The complementary information in these MR images can further assist in classifying MS lesions. We, therefore, build our analysis using multi-channel MR data.The former method also uses an unsupervised approach and it was observed that one of the crucial parameters used in this approach is the threshold on error map. This parameters drives the segmentation results and is not easy to tune. Furthermore, it could lead to worse segmentation results for small errors in the brain extraction procedure. We suggest a solution to this problem by proposing a fully automatic supervised classification method that eliminates this parameter. As outlined in many classification approaches using dictionary learning, we learn class specific dictionaries for the healthy brain tissues and the lesions that promote the sparse representation of the healthy and lesion patches, respectively. The lesion patches are well adapted to their own class dictionary, as opposed to the other. Thus, we can use the reconstruction error derived from the sparse decomposition of the test patch on to these dictionaries for obtaining the classification.There exist several MS lesion segmentation methods that use tissue segmentation to help segment the lesions [26]. We can thus further enrich our model by taking into account the tissue specific information and learning dictionaries specific to different tissue types, such as white matter (WM), gray matter (GM) and cerebrospinal fluid (CSF), as opposed to learning a single dictionary for healthy tissue patches. We explore the fact that various tissues as well as lesions appear in different intensity patterns in distinct MR modality images. For example, WM appears as the brightest tissue in T1-weighted image, but the darkest in T2-weighted images. Therefore, learning class specific dictionaries for individual tissues should further discriminate between lesion and non-lesion classes.The dictionaries learned for each class are aimed at better representation of an individual class. However, if there exists differences in the data-complexity between classes, the relative under- or over-representation of either class will lead to worse classification. One idea for better classification could be to learn the dictionaries with adaptive sizes, in order to take into account the data variability between different classes. Thus, in addition to the dictionary learning strategy mentioned above, we also investigate the effect of modifying the dictionary sizes, leading to the proposition of adaptive dictionary learning. The basic idea is to learn the class specific dictionaries which are better adapted to the data and also complexity of the data.The main contributions of this paper can be outlined as follows: (1) Supervised classification approach is developed using multi-channel MR data by learning dictionaries for the healthy brain tissues and the lesion classes. (2) Tissue-specific information is incorporated by learning dictionaries specific to each tissue class as opposed to learning a single dictionary for representation of the healthy brain tissue class. (3) The dictionary sizes are adapted according to the complexity of the underlying data so that the dictionaries are better suited for representation of each class data as well as classification of MS lesions.This paper is organized as follows. We first describe sparse coding and dictionary learning in Section 2. The materials and methods are explained in Section 3, followed by results and discussions in Section 4, and conclusion in Section 5.Sparse representation of the data allows decomposition of signals into linear combination of few basis elements in the over-complete dictionary. Consider a signalx∈ℝNand an over-complete dictionaryD∈ℝN×K. The sparse coding problem can be stated asminaa0s.t. x=Da orx−Da22≤ɛ, wherea0is l0 norm of the sparse coefficient vectora∈ℝKand ɛ is error in the signal representation. The efficient solvers for sparse coding include matching pursuit, orthogonal matching pursuit and basis pursuit, where the later solves the convex approximation of the problem above by replacing l0 norm with l1 norm, which also results in a sparse solution [27–29]. The sparse coding problem can be given by(1)minax−Da22+λa1where λ is called sparsity induced regularizer and balances the trade-off between the reconstruction error and the sparsity of the coefficient vector a.The fixed dictionaries like wavelets can be efficient, but over the past years, the dictionary learning from underlying data has produced exciting results with greater data adaptability. For a set of signalsxii=1,…,m, the dictionary learning problem is to find D such that each signal can be represented by sparse linear combination of its atoms. This can be stated as the following optimization problem(2)minD,aii=1,..,m∑i=1mxi−Dai22+λai1The optimization is carried out as an iterative two-step process: (i) sparse coding with a fixed D, and (ii) the dictionary update with a fixed a.Among the methods available in the literature for learning the dictionary, KSVD, MOD and online dictionary learning are widely used algorithms [30–32].The proposed approach involved MR dataset of 14 MS patients acquired via Verio 3T Siemens scanner. T1-w MPRAGE, T2-w, PD-w and FLAIR modalities were chosen for the analysis. The volume size for T1-w MPRAGE and FLAIR was 256×256×160 and voxel size was 1×1×1mm3. For T2-w and PD-w, the volume size was 256×256×44 and voxel size was 1×1×3mm3. Annotations of the lesions were carried out on T2-w volume by an expert neuroradiologist. These manual segmentation images are referred to as ground truth lesion masks.The overview of the method proposed is shown in Fig. 1. MR images for all patients are first preprocessed for noise-reduction and the elimination of extracranial brain tissues. The images are then registered into the same space. We represent image volumes as patches of a predefined size and normalize these extracted patches. This is followed by labeling patches in two ways: (i) Healthy brain tissue patches and lesion patches, using manual segmentation images and (ii) WM, GM, CSF or lesion patches, with the help of manual lesion segmentation and tissue segmentation images. The patches are then divided into the training and test dataset. For various classification strategies, we learn the dictionaries, using training data, in different configurations as follows: a single dictionary, two separate dictionaries for the healthy and lesion classes, or the class specific dictionaries for the lesions and each healthy brain tissue – WM, GM, CSF. For the last two approaches, we also study the role of the dictionary size in the classification. Finally, for a given test subject, we developed a reconstruction error based patch-classification method, which is followed by the voxel-wise classification. The following subsections briefly describe these steps.The noise introduced during MR acquisition is removed using non-local means and intensity inhomogenity (IIH) correction [33,34]. To ensure the spatial correspondence, the images are registered with respect to T1-w MPRAGE volume [35] and are processed further to extract the intra-cranial mask [36]. We limit our further analysis to this brain region.For local image analysis in the dictionary learning framework, the images are divided into the overlapping patches. Each patch is then represented as a signal in the dictionary learning process. We follow this patch-based approach and divide the whole intracranial MR volume for each patient into 3-D patches, with a patch around every 2 voxels in each direction. The individual image patches of each MR modality are then flattened to form a vector and are concatenated together. The patches so obtained are normalized for a unit l1 norm.Next step is to label the normalized patches obtained from every patient. We label them in two different ways for the experiments to be preformed next. Firstly, the patches are labeled as belonging to either healthy or lesion class, using the manual segmentation image. If the number of lesion voxels in the corresponding image block of the manual segmentation image exceeds a pre-defined threshold TL, we assign this patch to the lesion class. Otherwise, it is labeled as a healthy patch. The image patches obtained in this manner form the dataset for the classification approaches which use a single dictionary or two class specific dictionaries. For other classification methods, the patches are labeled as either WM, GM, CSF or lesion class. We use the same rule, as explained above, to label the patch to the lesion class. In addition, the patch is now assigned to either WM, GM or CSF class, depending on the maximum number of voxels that belong to corresponding class in the brain tissue segmentation image obtained using Statistical Parametric Mapping (SPM) [37].The labeled image patches are then divided into training and test data, and the experiments are performed by following Leave-One-Subject-Out-Cross-Validation (LOSOCV).Let n be the number of voxels per patch. For each class c, we write patches as vectorsxic∈Rn. Learning an over-complete dictionary Dc∈Rn×kthat is adapted to m patches, with sparsity parameter λ, is addressed by solving the optimization problem, similar to Eq. (2).(3)minDc,aici=1,..,m∑i=1mxic−Dcaic22+λaic1The subsections below detail the different strategies adopted while learning these dictionaries and the scheme of patch based classification. In every method, we obtain the sparse codes for the test patches using Eq. (1), knowing the dictionary Dcfor the class c.In the context of MS lesion classification, the simplest idea, similar to [25], could be to use a single dictionary learned from the healthy and lesion class patches. Such dictionary is mainly representative of the healthy brain image patches, based on the fact that the number of lesion patches is very small as compared to that of the healthy class.As lesions are outliers with respect to the healthy brain intensities, the decomposition of the lesion patch using such dictionary would result in a higher representation error than that for the healthy tissue patches. Thus, for a given test patch, we calculate the sparse coefficients with appropriately chosen sparse penalty factor and the reconstruction error. The test patch with representation error greater than chosen threshold would be classified as a lesion patch. For calculation of the threshold, we used the histogram of the error map, as proposed by the authors [25].In this method, we learn the class specific dictionaries Dcof the same size, for the healthy (c=1) and lesion (c=2) class. The dictionaries learned in this manner are better suited to represent the corresponding class data. The decomposition of the test patch using other class dictionary would give rise to a higher representation error.For a given test patch yi, the classification is performed by calculating the sparse coefficientsaicfor each class and the test patch is then assigned to the class with a minimum representation error.(4)cpred=argmincyi−Dcaic22.The dictionaries learned using above-mentioned approach do not take into account the data variability between two classes. The size of the dictionary plays a major role in data representation. The healthy class data is associated with more variability as compared to the lesion class, because it represents complex anatomical structures such as white matter, grey matter and cerebrospinal fluid. The number of training samples for the healthy class also outnumber the lesion class training samples. To account for more variability and the number of training samples, we allow larger dictionary size for the healthy class and study its effect on MS lesion classification.As explained before, the healthy brain tissues contain anatomically different regions such as WM, GM and CSF. The fact that every tissue, WM, GM and CSF, appears in different intensity pattern in each MR modality, using a single dictionary for representing the healthy brain tissues might not be as effective as learning separate dictionaries for each tissue. Adding tissue specific information in the dictionaries used for the classification would enhance the prior knowledge in the learning step, thus highlighting the differences between individual tissues and also improving the lesion classification.After learning class specific dictionaries for WM, GM, CSF and lesion, we perform classification based on reconstruction error in a similar manner, as mentioned in Section 3.5.2. Each dictionary is representative of its own class and the reconstruction of the test data using true class dictionary would give a minimum reconstruction error.Here, we experiment with different dictionary sizes for WM, GM, CSF and lesion classes, for the similar reasons mentioned in Section 3.5.3.As already stated, we classify the patches centered around every 2 voxels in each direction. For voxel-wise classification, we assign each voxel to either of the classes by using majority voting. The voxel is assigned to a class using majority votes of all patches that contain the voxel.Finally, in the context of lesion classification, we record the number of voxels that belong to True Positives (TP), False Negatives (FN) or False Positives (FP), and calculate percentage sensitivity (SEN)=(TP×100)/(TP+FN), percentage Positive Predictive Value (PPV)=(TP×100)/(TP+FP) and percentage dice-score (Dice)=(2×TP×100)/(2×TP+FP+FN).

@&#CONCLUSIONS@&#
