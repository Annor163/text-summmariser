@&#MAIN-TITLE@&#
Predictive control of multizone heating, ventilation and air-conditioning systems in non-residential buildings

@&#HIGHLIGHTS@&#
A model-based predictive approach is proposed to manage multizone HVAC systems.The predicted mean vote (PMV) index is used as a thermal comfort indicator.Low-order ANN-based models are developed and used as controller's internal models.The optimization problem is solved using a genetic algorithm.HVAC operation is optimized and thermal comfort constraints are met.

@&#KEYPHRASES@&#
Multizone HVAC,Non-residential building,Predictive mean vote,Predictive control,Feedforward neural networks,Genetic algorithm,

@&#ABSTRACT@&#
In France, buildings account for a large part of the energy consumption and carbon emissions. Both are mainly due to heating, ventilation and air-conditioning (HVAC) systems. Because older, oversized or poorly maintained systems may be using more energy and costing more to operate than necessary, new management approaches are needed. In addition, energy efficiency can be improved in central heating and cooling systems by introducing zoned operation. So, the present work deals with the predictive control of multizone HVAC systems in non-residential buildings. First, a real non-residential building located in Perpignan (south of France) has been modelled using the EnergyPlus software. We used the predicted mean vote (PMV) index as a thermal comfort indicator and developed low-order ANN-based models to be used as controller's internal models. A genetic algorithm allowed the optimization problem to be solved. In order to appraise the proposed management strategy, it has been compared to basic scheduling techniques. Using the proposed strategy, the operation of all the HVAC subsystems is optimized by computing the right time to turn them on and off, in both heating and cooling modes. Energy consumption is minimized and thermal comfort requirements are met. So, the simulation results highlight the pertinence of a predicitive approach for multizone HVAC systems management.time index (–)predicted mean vote in the room j of the building (–)difference between the heat produced and the heat lost in the room j of the building (Wm−2)occupants’ metabolic activity in the room j of the building (Wm−2)external work in the room j of the building (Wm−2)heat loss by diffusion through the skin in the room j of the building (Wm−2)heat loss by sweating in the room j of the building (Wm−2)heat loss by latent respiration in the room j of the building (Wm−2)heat loss by dry respiration in the room j of the building (Wm−2)heat loss by radiance in the room j of the building (Wm−2)heat loss by convection in the room j of the building (Wm−2)air temperature in the room j of the building (°C)radiant temperature in the room j of the building (°C)relative humidity in the room j of the building (%)air speed in the room j of the building (ms−1)clothing thermal insulation in the room j of the building (clo)outdoor temperature at 6a.m. (°C)outdoor temperature (°C)consumption of electrical power in the room j of the building (kW)occupancy in the room j of the building (–)HVAC temperature set-point in the room j of the building (°C)HVAC temperature set-point in the room l of the building (°C)HVAC temperature set-point in the room m of the building (°C)value ofTjspallowing to obtainPMVjspin the room j of the building (°C)PMV set-point in the room j of the building (in the present study,PMVjsp=0) (–)right time to turn the HVAC susbsytem in the room j of the building on or off (–)vector bringing the optimal HVAC switching times together (–)forecast horizon (–)thermal comfort threshold (in the present study,PMVjmin=−0.5) (–)thermal comfort threshold (in the present study,PMVjmin=+0.5) (–)crossover fraction (genetic algorithm) (–)amount of mutation (genetic algorithm) (–)sum over all the output neurons of the magnitude of the correlation between Veand Ee,o(–)partial derivative of C with respect to each of the incoming weigths of the candidate unit (–)value of the candidate unit for example e (–)averaged value of V over all the training examples (–)residual output error measured at neuron o (–)averaged value of Eoover all the training examples (–)correlation between the value of the candidate unit and neuron o (–)derivative of the candidate's activation function with respect to the sum of its inputs (for example e) (–)input received by the candidate unit from unit i (for example e) (–)

@&#INTRODUCTION@&#
Within non-residential buildings, almost half of the energy consumption is due to heating, ventilation and air-conditioning (HVAC) systems [1]. In addition, older, oversized or poorly maintained systems may be using more energy and costing more to operate than necessary. As a consequence, new approaches dealing with energy ressources management are needed to make HVAC systems more efficient. First, energy efficiency can be improved in central heating and cooling systems by introducing zoned operation. This allows a more granular application of heat and each HVAC subsystem can be controlled independently. Another key point is thermal comfort. Thermal comfort can be defined as “that condition of mind which expresses satisfaction with the thermal environment” [2]. It is mainly related to indoor conditions and impacted by both the effectiveness of the building envelope and the way the HVAC system is used.Many research studies focusing on improving the operation of centralized or zoned HVAC systems have been conducted over the last few years. Recently, Haniff et al. provided a detailed review of basic, conventional, and advanced HVAC scheduling techniques [3]. First, the “interruption”, “early switch-off” (ESO), “pre-heating (or pre-cooling) in the demand reduction” (DR), and “alternate switch-on/off” (ASOO) basic scheduling techniques are discussed. The “interruption” technique consists in suspending the HVAC operation for several hours during occupancy periods. In opposition, in case of the ESO technique being used, the HVAC system is (usually) stopped 2h before people leave the building. The DR technique is about pre-heating (or pre-cooling, depending of the season of the year) a building during off-peak periods (i.e. non-occupancy periods). Finally, the ASOO technique is based on alternately switching on and off the HVAC system during office hours [4].Usually, with a conventional scheduling technique, the HVAC system operates 24h a day and the “night setback” mode allows energy saving objectives to be achieved. Note that, due to its simplicity, the “baseline” approach is widely used in HVAC management. With such an approach, the setpoint temperature value is chosen to be at the lower boundary of the thermal comfort zone during occupancy periods whereas the “night setback” mode is applied during innocupancy [5].Advanced scheduling techniques can also be considered in HVAC management. So, Lee and Braun used short-term measurement data to determine demand-limiting control setpoint trajectories [6]. The authors developed three different methods, named “semi-analytical” (SA), “exponential setpoint equation-based semi-analytical” (ESA), and “load weighted-averaging” (LWA) methods, respectively. Each method gives an estimate of a building-specific setpoint trajectory that gives a “flat” cooling load profile during a specified demand-limiting period [7]. Another possible technique is the “5-period division” scheduling [8]. Using this technique, the day is divided into five periods, according to occupancy, with specific operation in each period. One can also talk about the “extended pre-cooling with zone temperature reset” technique [9]. Such an approach is based on varying the temperature setpoints and shifting the heating/cooling loads from daytime to night time [10]. The last advanced scheduling technique one can highlight is the “agressive duty cycling” technique [11]. Based on occupancy, the HVAC system is turned on and off many times in a day and, as a result, an efficient real-time detection of people is needed.One can also highlight efficient approaches based on artificial intelligence tools. In Ref. [12], Gouda et al. proposed an efficient fuzzy controller for HVAC systems by taking into account a wide range of human comfort criteria in the control action formulation. In Ref. [13], Dounis and Caraiscos developed a multi-agent control system in order to manage air quality as well as thermal and illuminance comfort. As another interesting approach, Bermejo et al. designed a thermal comfort adaptive system based on fuzzy logic and on-line learning [14]. In most cases, these approaches require to turn the HVAC system on then off at fixed times. Consequently, this can impact thermal comfort negatively if the system is started too late or energy consumption if triggering happens too soon.Another interesting option in HVAC management lies in considering predictive control techniques. As it has been highlighted by many other studies, these advanced techniques can take advantage of the intermittent use of non-residential buildings and allows the behaviour of the considered system to be anticipated [15]. In this sense, Paris et al. developed a model predictive controller (MPC) in order to control indoor temperature and minimize energy consumption in multi-energy buildings (buildings that use several sources of energy) [16]. In Ref. [17], Moroşan et al. proposed a distributed predictive approach to control several areas simultaneously, while taking into account thermal transfers. In this approach, thermal comfort is defined on the basis of a reference temperature. The proposed algorithm is useful but on-line optimization is needed and computation time is extensive. Because predictive control is well adapted to the management of energy resources, we recently developed a new approach allowing the HVAC operation in a non-residential building to be optimized by turning the subsystems on and off at the right time [18]. Only one operation mode (in that case, heating) has been considered. We used the predicted mean vote (PMV) index as a thermal comfort indicator and focused on satisfying constraints. The algorithm offers very good performance (taking the strategy currently used in the building as a reference, thermal comfort is better while the consumption of electrical power is lower) and does not require on-line optimization. As a result, it is computationnaly tractable and can be implemented in an embedded system with limited resources. However, its main limitation is that all the HVAC susbsystems are turned on then off at the same time. That is why the present paper focuses on improving this predicitive approach by optimizing for each room of the building the operation time of its HVAC subsystem. Both heating and cooling modes are now considered. We decided for a genetic algorithm (GA) so as to solve the optimization problem [19] and used feedforward (multi-layer) artificial neural networks trained with the cascade-correlation algorithm to develop the controller's internal models. Note that genetic algorithms have been already used in energy resources and thermal comfort management. In Ref. [20], Attia et al. reviewed the current trends in simulation-based building performance optimisation (BPO) and outlined criteria for both the selection and evaluation of optimization tools, including evolutionary algorithms. In Refs. [21,22], thermal comfort is managed into a unique room by using a genetic algorithm, without considering heat transfer with the other rooms in the building. Note that Liu et al. also used this kind of algorithm to optimize HVAC operation by searching for optimal control settings [23].The present paper is organized as follows: Section 2 is about the non-residential building we modelled thanks to the EnergyPlus software. This building is located in Perpignan (France). In Section 3, the predicted mean vote (PMV) is defined. We used it as a thermal comfort indicator. Next, the predictive strategy as well as the low-order ANN-based models we developed and used as controller's internal models are described (Section 4). Finally, the simulation results we obtained in both heating and cooling modes are analyzed and compared with the results given by basic scheduling techniques (Section 5). The paper ends with a conclusion and an outlook to future work.In order for the proposed management strategy to be evaluated, the thermal behaviour of a real non-residential building has been modelled using the EnergyPlus software, which is able to perform accurate building simulations. In Ref. [24], Henninger et al. highlighted (using the IEA HVAC BESTEST E100-E200 series of tests) its ability in simulating both the thermal behaviour of buildings and the operation of HVAC systems.The considered building is a 1000m2 two-storey structure, built in 2008 and located in Perpignan (France). It is facing south and agrees with the French Thermal Regulation of year 2005. About a dozen employees work in the offices at the ground and first floors (the green (R1) and yellow (R2) areas in Fig. 1). The red area in the first floor (R3) is a manufacturing area where six persons work seated or in a standing position. This room is composed of an open space of 230m2 and three unheated storage rooms of 110m2. The last room in the ground floor is a warehouse (the blue area (R4) in Fig. 1) which is not heated. For both the warehouse and the manufacturing area, ceiling height is 3.90m. In the offices, a suspended ceiling stands at 2.70m. All the materials used in the building as well as their main properties are listed in Table 1. For each material, its thickness (cm), thermal conductivity (Wm−1K−1), density (kgm−3), and specific heat (Jkg−1K−1) are given. The exterior walls consist in several layers. From the outside to the inside, a brick layer, heavy weight concrete, an insulation board, and a gypsum board are juxtaposed. The interior walls are composed of two gypsum boards, for a total thermal resistance of 2.2m2KW−1. The south face and a part of the west face of the building are made of glass. Note that glass is treated to filter infrared radiation. This avoid overheating in summer. The other glasses consist in 3mm double glazed bays.The present study focuses on managing the HVAC subsystems in the three following rooms of the building: the offices on both floors (R1, R2) and the manufacturing area (R3). For R3, only the (heated) open space is taken into consideration. These rooms are equipped with air and radiant temperature sensors. Note that no heat transfer between the warehouse (R4) and the other rooms is explicitly taken into account (considered as a system disturbance). Heating is handled by a zoned electrical HVAC system consisting in several subsystems, one for each area, where only the temperature set-points can be adjusted. Each subsystem is managed by a local controller. All units have a coefficient of performance equal to 3.8. The characteristics of the rooms R1, R2, R3 and R4 are listed in Table 2.As previously stated in the paper (Section 1), the proposed management strategy is based on a model predictive controller that will supervise the HVAC subsystems and optimize their operation times (Fig. 2).The predicted mean vote (PMV) index is used as a thermal comfort indicator. It has been developed by Fanger in 1973 [25], before to be standardized by international organizations. The PMV index allows the thermal sensation of people in their environment to be evaluated. This sensation is described by a scale ranging from −3 to +3. 0 is for a neutral thermal sensation, which is often associated with the state of (thermal) comfort (Table 3). The exchange of heat between the human body and its surroundings strongly governs thermal comfort. It is highly subjective and can be considered as perfect when the sum of exchanges is zero. The PMV index is computed as follows, in the room j, ∀j∈〚1;3〛 (1):(1)PMVj=[0.303exp−0.036Mj+0.028]×Ljwith Lj, ∀j∈〚1;3〛, the difference between the heat produced and the heat lost (2):(2)Lj=Mj−Wj−Hj,1−Hj,2−Hj,3−Hj,4−Hj,5−Hj,6Mjand Wj(Wm−2) are the metabolic activity and external work in the room j, respectively. Hj,1, …, Hj,6 are the heat loss coefficients (Wm−2). Hj,1 is the heat loss by diffusion through the skin and Hj,2 is the heat loss by sweating. Hj,3 and Hj,4 are the losses by latent and dry respiration, respectively. Finally, Hj,5 is the heat loss by radiance and Hj,6 is the heat loss by convection. To calculate these heat loss coefficients, several parameters about environment and occupants are taken into account, ∀j∈〚1;3〛: air temperature (Tja, expressed in °C), radiant temperature (Tjr, expressed in °C), air speed (vja, expressed in ms−1), relative humidity (HRj, expressed in %), metabolic activity, and clothing thermal insulation (ICLj, expressed in clo). Note that air speed is not taken into account in the EnergyPlus software. However, this missing information is not critical at all because air speed has no influence on the PMV index as long as it remains below 0.1ms−1. This is mostly the case within the considered non-residential building. Moreover, metabolic activity is supposed to be constant and only depends on the room. In the offices of the building (rooms R1 and R2), people work most of the time in a sitting position and, as a result, Mj, ∀j∈〚1;3〛, is set to 70Wm−2 (i.e. 1.2met). Activity in the manufacturing area (R3) is much more dynamic and Mjis set higher to 116Wm−2 (i.e. 2 met). Moreover, depending on outdoor temperature, people dress differently. Consequently, clothing thermal insulation in the room j (ICLj), ∀j∈〚1;3〛, varies over time [26]. It is defined, each day, from the outdoor temperature observed at 6a.m., noted T6 (Table 4):As previously mentioned in the paper, each room in the building has its own HVAC subsystem, handled by a local controller (Fig. 2). Simulation is carried out using the EnergyPlus building model we developed and the predicitive control strategy is implemented thanks to Matlab®. The MLE+ interface enables both tools to communicate in real time [27]. As a key point, we used feedforward neural networks trained with the cascade-correlation algorithm in order to develop the controller's internal models. Hidden and output neurons use sigmoid and linear activation functions, respectively.During the past decade, artificial neural networks have been widely used to solve complex real-world problems. A key point in using such tools is to find the adequate topology of the network used to solve a given problem (basically, the number of hidden layers as well as the number of units, or neurons, to be put on them) and, secondly, to optimize its parameters using training examples. Training aims at establishing a satisfactory relationship between input and output patterns. The cascade-correlation algorithm [28] is an adaptive (or constructive) learning algorithm used with self-growing feedforward neural networks (with one hidden layer only, what proved to be enough to approximate a large class of functions) [29]. Compared with a neural network trained with the conventional backpropagation algorithm [30], a cascade-correlation neural network does not have a fixed size (i.e. a fixed number of units in its hidden layer). A cascade-correlation neural network grows from an initial topology with no hidden units. So, each input is connected to each output neuron and the network is trained using learning data (training examples). These data have to be fully representative of all the features the network is intended to learn. When there is no significant reduction in the approximation error, the training phase is terminated and all the weights obtained are frozen. Then, hidden units will be dynamically added and trained one by one until a given performance criterion is satisfied (Fig. 3). Usually, a new hidden neuron is chosen from a pool of candidates with different initial weights. The new hidden units are so cascaded with the neural network inputs as well as existing hidden units. During the training process, the weights affected to the connections between these new units and both the network's inputs and preexisting hidden units (“input” weights) are adjusted by maximizing C, which is the sum over all the network's output neurons of the magnitude of the correlation between Vp, the value of the candidate unit for example e, and Ee,o, the residual output error measured at neuron o. A gradient ascent is performed in order to maximize C, with C formulated in the following way (3):(3)C=∑o∑e(Ve−V¯)(Ee,o−Eo¯)V¯andEo¯are the respective averaged values of V and Eoover all the training examples. In order to maximize C(3), the partial derivative of C with respect to each of the incoming weigths of the candidate unit (wi) has to be computed.∂C/∂wican be expressed as follows (4):(4)∂C∂wi=∑e,oσo(Ee,o−Eo¯)fe′Ii,eσois the the correlation between the value of the candidate unit and output o,fe′is the derivative of the candidate's activation function with respect to the sum of its inputs (for example e), Ii,eis the input received by the candidate unit from unit i (for example e). When the process discribed above is finished, the adjusted “input” weights are also frozen. Weights affected to the connections between the new hidden units and output neurons (called “output weights”) are further updated using the above-mentioned backpropagation algorithm with the aim of minimizing the network output error. This iterative procedure is of involving more and more hidden neurons and is repeated so as to achieve a good approximation performance [31].We used a total of six self-growing artificial neural networks so as to model at time step k+1, ∀j∈〚1;3〛, the air (Tja) and radiant (Tjr) temperatures ((5) and (6)) as well as the electrical power consumed by the building's HVAC subsystems (Pj) (7), for both operation modes (heating, from November 1 to March 31, and cooling, from June 1 to September 30) and the three considered rooms (the offices on both floors and the manufacturing area):(5)Tja(k+1)=fj1(Tout(k),SR(k),Oj(k),…Tja(k),Tjr(k),Tjsp(k),Tlsp(k),Tmsp(k))(6)Tjr(k+1)=fj2(Tout(k),SR(k),Oj(k),…Tja(k),Tjr(k),Tjsp(k),Tlsp(k),Tmsp(k))(7)Pj(k+1)=fj3(Tout(k),SR(k),Oj(k),…Tja(k),Tjr(k),Tjsp(k),Tlsp(k),Tmsp(k))Estimation is carried out from the following inputs (at time index k): outdoor temperature (Tout), solar radiation (SR), room occupancy (Oj),Tja,Tjr,Tjsp, and the HVAC temperature set-points in the two adjacent rooms (TlspandTmsp) of room j, ∀j, l, m∈〚1;3〛 such as j≠l≠m (Fig. 4).We identified all the parameters and found the optimal topologies of the networks through a training phase, resorting to the cascade-correlation algorithm and data generated by the building's EnergyPlus model. Depending on the neural model, the cascade-correlation algorithm decided for 18–24 hidden neurons. Validation has been performed using 2-month data sets, one for each of the two parts of the simulation period (November 1 to March 31 and June 1 to September 30). Note that, whatever the operation mode (heating or cooling) and the room (R1, R2 or R3), the correlation coefficient is higher than 0.8 whereas the mean relative error is lower than 6% (Tables 5and 6). Figs. 5and 6show estimates of P3 and PMV3 (manufacturing area) for two periods of eight days in winter (heating mode) and summer (cooling mode). The black line is for values provided by the EnergyPlus software whereas the red line deals with estimated values. Using (1) (see Section 3), PMVj(k+1) is computed among others fromTja(k+1)andTjr(k+1), ∀j∈〚1;3〛 (see Fig. 4). Note that Mj(the occupant's metabolic activity) and HRj(relative humidity) are supposed to be constant over the simulation period (i.e. from June 1 to September 30 and from November 1 to March 31) and over the forecast horizon, respectively. ICLj(clothing thermal insulation) is computed from t6 (Table 4) and considered as constant over 24h, from 6a.m. (day d) to 6a.m. (day d+1). In addition, it is the same whatever the room in the building. Finally,vja(air speed) and Wj(the external work) are supposed to be null.This subsection of the paper depicts the proposed control strategy. This predictive approach is based on three blocks (Fig. 7): a calculation block, an optimization block, and a decision block. It also includes a standard forecasting unit allowing outdoor temperature (Tout) and solar radiation (SR) to be accurately forecasted.During occupancy periods, the calculation block (Fig. 7) defines at time step k the temperature set-pointT˜jsp, ∀j∈〚1;3〛, for which the thermal comfort constraints are met in R1, R2 and R3. In other words,T˜jspis defined so as to obtainPMVjsp(in the present study, we decided forPMVjsp=0). So, the calculation block aims at solving the following Eq. (8) numerically, at time index k, using the secant method [18], with θjbringing togetherTjr(the radiant temperature), HRj(relative humidity),vja(air speed), Mj(the metabolic activity), Wj(the external work) and ICLj(clothing thermal insulation), ∀j∈〚1;3〛:(8)PMV(T˜jsp,θj(k))=PMVjspThe optimization block (Fig. 7) deals with searching for the right time tjto turn the HVAC subsystem on or off in the room j of the building, ∀j∈〚1;3〛, with the aim of minimizing the total consumption of electrical power (9) while satisfying the constraints of thermal comfort. Vectort¯brings the optimal switching times (integer values) of the considered HVAC subsystems together. Remember that the low-order ANN-based models we developed are used as controller's internal models (see Section 4.2). At time step k, in the room j of the building, ∀j∈〚1;3〛, the control action is taken according toTja(the air temperature),Tjrand HRj. The optimization problem (9) is solved using a genetic algorithm (see Section 4.4):(9)J★=mint¯∈ℕJ(t¯)=∑k=1p∑j=13Pj(tj,k)t¯0<t¯<t¯p,witht¯=[t1t2t3]andptheforecasthorizonPMVjmin<PMVj(k)<PMVjmax,∀Oj(k)≠0,∀j∈〚1;3〛Low−orderANN−basedmodelsPMVjminandPMVjmaxare thermal comfort thresholds defined for the room j of the building, ∀j∈〚1;3〛, in the presence of people. In the present study, we decided forPMVjmin=−0.5andPMVjmax=0.5. Note that these two thresholds can be adjusted in order to meet specific users’ needs and preferences.The HVAC temperature set-point in the room j is set by the decision block (Fig. 7), according to tj(provided by the optimization block) andT˜jsp(provided by the calculation block), ∀j∈〚1;3〛. So, in case of an HVAC subsystem to be turned on (resp., turned off) now (i.e. at tj=k),Tjspis set equal toT˜jsp(resp., equal to zero),   ∀j∈〚1;3〛 (10):(10)iftj=kandTjsp(k−1)=0(resp.,Tjsp(k−1)≠0)thenTjsp(k)=T˜jsp(resp.,Tjsp(k)=0)However, in case of an HVAC subsystem to be turned on (resp., turned off) later (i.e. at tj≠k),Tjspis set equal to zero (resp., equal toT˜jsp), ∀j∈〚1;3〛 (11):(11)iftj≠kandTjsp(k−1)=0(resp.,Tjsp(k−1)≠0)thenTjsp(k)=0(resp.,Tjsp(k)=T˜jsp)Outdoor temperature (Tout) (12) and solar radiation (SR) (13) are forecasted over a horizon (p) set to 8h, using previous day values corrected by current values. Room occupancy (Oj, ∀j∈〚1;3〛) is known in advance and, as a result, can be anticipated easily. Note that the proposed forecasting approach is computationally tractable and efficient. Over the simulation period we consider in the present study (November 1 to March 31 and June 1 to September 30), the MRE (mean relative error) in SR forecasting is 5.9% whereas the MAE (mean absolute error) in Toutforecasting is 1.7°C:(12)Tout(k+p)=Tout(k+p−24h)+Tout(k)…−Tout(k−24h)(13)SR(k+p)=SR(k+p−24h)

@&#CONCLUSIONS@&#
