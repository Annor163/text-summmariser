@&#MAIN-TITLE@&#
A dynamic simulation–optimization model for adaptive management of urban water distribution system contamination threats

@&#HIGHLIGHTS@&#
Dynamic simulation is performed to model water distribution system contamination.Dynamic optimization is used to track time-varying optimal response protocols.Dynamic models provide adaptive decision support for public health protection.

@&#KEYPHRASES@&#
Evolutionary computations,Water distribution system,Contamination,System dynamics,Dynamic optimization,Emergency management,

@&#ABSTRACT@&#
Urban water distribution systems hold a critical and strategic position in preserving public health and industrial growth. Despite the ubiquity of these urban systems, aging infrastructure, and increased risk of terrorism, decision support models for a timely and adaptive contamination emergency response still remain at an undeveloped stage. Emergency response is characterized as a progressive, interactive, and adaptive process that involves parallel activities of processing streaming information and executing response actions. This study develops a dynamic decision support model that adaptively simulates the time-varying emergency environment and tracks changing best health protection response measures at every stage of an emergency in real-time. Feedback mechanisms between the contaminated network, emergency managers, and consumers are incorporated in a dynamic simulation model to capture time-varying characteristics of an emergency environment. An evolutionary-computation-based dynamic optimization model is developed to adaptively identify time-dependant optimal health protection measures during an emergency. This dynamic simulation–optimization model treats perceived contaminant source attributes as time-varying parameters to account for perceived contamination source updates as more data stream in over time. Performance of the developed dynamic decision support model is analyzed and demonstrated using a mid-size virtual city that resembles the dynamics and complexity of real-world urban systems. This adaptive emergency response optimization model is intended to be a major component of an all-inclusive cyberinfrastructure for efficient contamination threat management, which is currently under development.

@&#INTRODUCTION@&#
Safe and reliable drinking water is vital to every community. Approximately 90% of the US population receives water from one of 170,000 public water utilities. These drinking water distribution systems (WDSs) are inherently vulnerable to natural or malicious contamination because of their ubiquity, multiple points of access, the aging infrastructure, and the increased risk of terrorism. Chemical or biological contaminates may be introduced to a water distribution systems accidentally through treatment plants malfunction, backflow events, cross-connections, etc. or intentionally via the acts of malevolence, vandalism, etc. [1]. The plethora of past contamination incidents and foiled attempts further demonstrates the vulnerability of municipal water supply systems [2,3]. Title IV of the Public Health Security and Bioterrorism Preparedness and Response Act of 2002 [4] mandates all community water systems that serve more than 3300 people to prepare or revise emergency management plans.WDS contamination emergency management is based on risk assessments and includes four major phases of hazard mitigation, emergency preparedness, emergency response, and disaster recovery [5]. This study is particularly more focused on emergency response phase. A contamination emergency response phase is initiated when an actual (or potential) injection of contaminant is propagated (or will propagate) over a WDS, and it extends until the situation is stabilized (e.g., when the risk of health consequences has returned to normal conditions). Emergency response decision aid tools have been devised in previous studies to assist water utility operators in making better decisions for public health protection against contamination events. Genetic algorithms (GA), decision trees, and heuristic approaches have been used for guiding contaminant containment and flushing operations [6–8]. Agent-based models have been developed and coupled with a GA to optimize routing of siren vehicles to best warn and protect consumers from exposure [9,10]. Multiobjective simulation–optimization has been applied to help utility operators achieve conflicting response objectives such as health protection and WDS service interruption prevention [11–16].Previous studies have generally applied static optimization approaches to find optimal response protocols on the implicit assumption that the optimization problem is fixed during the course of an emergency. From an optimization perspective, this assumption implies that the response optimization fitness functions (e.g., minimization of ultimate health impacts) are temporally constant. In other words, fitness of a particular response protocol is not changing during the optimization process once it is started. In reality, however, the fitness functions are feedback-influenced by many uncertain and dynamic factors, i.e., projected spread of contaminant and actions taken by the utility operators and consumers [17,18]. Under the effect of these unpredictable factors, the search domain may repeatedly change over time, and the current best response protocol might be no longer optimal moments later. The decision support model should thus explicitly account for this unpredictably time-varying system behavior to accurately reproduce the reality and identify best contamination impact reduction decisions in a timely manner.Dynamic optimization has been successfully applied in different disciplines for solving optimization problems in changing environments. Dynamic optimization methods methodically exploit and transfer useful knowledge from older environments and maintain adaptability to guide and speed up the exploration in emergent environments [19,20]. Some recent successful applications include products pricing [21], contaminant source characterization [22], vehicle routing [23], military mission planning [24], electric power supply optimization [25], video-based face recognition [26], and dynamic traveling salesman problem [27]. Despite this rich record of successful applications, however, dynamic optimization has not been employed to solve the crucial problem of dynamic water contamination emergency management yet. This study focuses on this unexplored research area and develops dynamic simulation–optimization models for adaptive management of drinking water networks contamination emergencies.We investigate the application of dynamic modeling for adaptive emergency response to disasters in the scope of drinking WDS contamination events. A dynamic simulation–optimization scheme is developed to identify and track time-dependant optimal response protocols to provide emergency managers with adaptive decision support in real-time. The adaptive simulation model accounts for multiple uncertainty factors that contribute to the unpredictable time-varying system behavior, including time-dependant perceived contamination source attributes, consumers’ actions, and emergency response operations. This dynamic optimization scheme uses an evolutionary-computation-based multiobjective approach, which methodologically preserves diversity in the search process for enhanced adaptation against the effect of changes.In what follows, the structure and elements of the dynamic simulation model developed to simulate the dynamic emergency environment are first described. These comprehensive descriptions are mainly intended for readers with insufficient background on WDS hydraulics and security. This is followed by the formulation of the time-varying optimization fitness function and decision variables and a brief overview of existing dynamic optimization techniques. The evolutionary-computation-based algorithm used here for the dynamic optimization of health protection response protocols is then described. The proposed adaptive simulation–optimization model is then evaluated and discussed on a virtual city, Mesopolis, which possesses the spatial and temporal complexity of real-world cities. The results are analyzed to illustrate the system behavior during an emergency and investigate model performance. The paper concludes with a number of recommendations for enhancing applicability and efficiency of the proposed decision support model in the future.A WDS contamination emergency threat starts with an actual (or potential) release of contaminant that propagates across the network, and it extends until the risk of health impacts has returned to pre-event levels. Under an unfolding contamination threat, the system might exhibit an uncertain and irregular behavior that could radically deviate from normal operation conditions. Knowledge of contaminant source attributes that dictate emergency response decisions evolves as more information streams in over time. As the event progresses, emergency managers take response actions based upon their current knowledge of the state of the system and these actions change the state of the contamination in the WDS and alert consumers. Alerted and exposed consumers may subsequently alter their water consumption choices, which consequently affect network hydraulics and contaminant plume spread [17]. Conceptualizing and modeling these different sources of variability is crucial for realistic simulation of system behavior and effective reduction of contamination impacts.This section first defines a contamination scenario and how the emergency managers’ perception of an occurred scenario evolves as more information streams in over time. Then, it describes the two particular emergency response mechanisms considered in this study (i.e., contaminant flushing through opening hydrants and public warning through food-grade dye injection) and how their implementation contributes to the system dynamics. It is followed by a description of consumers’ behavior during a contamination emergency and its influence on the state of the contamination and health consequences. The last part of this section describes the hydraulic model used in this work to simulate WDS hydraulics and contaminant propagation during a contamination event.A contamination scenario is defined by a set of attributes (e.g., contaminant injection location and duration) and corresponds to a specific level of ultimate consequences [28]. The attributes of a contamination scenario are estimated through integrated assessment of different system observations and evidence. This information may stream from physical security alarms, supervisory control and data acquisition (SCADA) system, and consumers’ complaints. Bayesian and optimization models can be applied to process the streaming data in real-time and update estimated scenario attributes using existing and incoming information [22,29–32]. Helpful guidelines and information on WDS sensor technology and networks can be found in [33,34].Since the perceived contamination scenario dictates the effectiveness of the health protection strategies taken, the optimization process needs to adapt to scenario updates to be capable to continuously track the optimum in a time-varying search space. Perceived scenario attributes are thus treated here as time-varying parameters opposed to past studies that assume the perceived contamination scenario is fixed while the optimization is being performed. It should be emphasized that the true contamination scenario has already occurred and is thus not time-varying, but it remains unknown to the emergency managers. During the course of an emergency, the streaming data is processed adaptively at every stage and perceived contamination scenario is updated to better estimate the true scenario.Development of an adaptive scenario characterization model is not the focus of this study and the proposed dynamic response optimization model is thus demonstrated on an arbitrary scenario update timeline without loss of generality. The adaptive simulation–optimization scheme proposed here should be ideally coupled with a dynamic source identification model [22] that continuously updates the perceived contamination scenario using streaming data. A general framework for dynamic integration of these analytical modules for development of an adaptive cyberinfrastructure for threat management is described in [35].In the event that a contaminant is introduced to a WDS, water utility operators may take different preventive and protective actions to protect public health. The decisions on timing and frequency of response actions are made with consideration of threat observations credibility and unintended adverse response side effects (e.g., system service interruptions and false public warnings). The actions taken by the utility managers would change the normal hydraulic conditions, and thus the propagation of the contaminant plume in the system. Implementation of response actions thus alters ultimate public health consequences and affects efficacy of future response decisions. Moreover, effectiveness of consequence reduction measures expectedly degrades as time passes due to wider contaminant spread and prolonged public exposure to the contaminant. The simulation model developed here adaptively reevaluates response actions considering the increasing response execution time delay and the effect of actions that are already executed or being executed on system behavior. Without loss of generality, two particular response mechanisms of hydrant operation for contaminant flushing and food-grade dye injection for public warning are included in the model.Contaminant flushing is most commonly performed through opening fire hydrants to discharge a large volume of contaminated water from the system. Flushing operations should be arguably performed at locations where contaminant concentration is relatively higher. Otherwise, it may possibly worsen the consequences through unintentionally diverting the contaminant plume to uncontaminated regions [United States Environmental Protection Agency] [36,37]. This urges utilization of a methodological optimization model to inform contaminant flushing decisions and prevent inadvertent increase in health consequences.Food-grade dye injection is a novel emergency response mechanism for WDS contamination consequence management [36]. It acts as a warning mechanism that discourages public consumption of contaminated drinking water and has been computationally demonstrated as a potentially effective response mechanism for public health protection [15]. Allura Red dye (also known as “Red 40” and “E129”) is chosen in this study among different available food-grade dyes because it has an intense red color and is approved by the U.S. Food and Drug Administration [38]. Food-grade dye injection has certain inadvertent side consequences such as false public alarms and ruined laundry and thus should be implemented when contamination trigger events are credible enough. A complete description of this response strategy and a detailed discussion on its advantages and limitations are provided in [15] and is thus not repeated here.Different consumers ingest varying amounts of contaminant depending upon time-dependant concentration of the contaminant and dye in their tap water, and the water consumption choices they make under an unfolding contamination incident. The exposure model used here assumes consumers ingest tap water at the typical starting times for the three main meals (7:00, 12:00, and 18:00) and times halfway between these meals (9:30 and 15:00). Alternative probabilistic ingestion timing models [17,39] may be used to more accurately reproduce the real ingestion behaviors. The tap water ingestion rate for every consumer is set to 0.93L/day here based upon comprehensive studies performed by USEPA [40].Consumers cease drinking tap water when they become aware that their tap water is contaminated. This happens when they are sickened and assume tap water is the cause or when they observe intense dye color in their tap water. A series of rules needs to be defined for modeling consumers’ reactions and their water usage changes. A consumer will experience symptoms once a threshold dose (i.e., toxic dose (TD)) has been ingested. It is assumed that the exposed consumer changes water usage patterns and stop drinking water within a time period, which is set to 1h here, after TD has been consumed. The contaminant agent used here is arsenic with minimum, average, and maximum estimated TD of 2.45, 3.5, and 4.97mg for a body weight of 70kg [41]. Consumers may also become alerted through observation of dye. It is presumed that they become alerted and cease drinking water for the rest of contamination incident once the dye concentration exceeds a relatively high threshold. This threshold is set here to the concentration of Allura Red in commercial soft drinks – roughly 25mg/L as reported by Lopez-de-Alba et al. [42]. The simulation model checks this observation of high-intensity dye only at the daily ingestion times described in the time-of-ingestion model.These water usage reduction choices made by the alerted consumers influence the hydraulic state of the network, and thus the spread of the contaminant plume in the system. Consumers may suspend contact uses, such as hand washing, dishwashing, and bathing after they become alert to the contamination. Other non-consumptive uses, however, may continue, such as toilet flushing, landscape watering, and pipe leaks. Such uses are assumed to comprise on average 60%, 51%, and 43% of the total demand for low, medium, and high density residential demands, respectively, using the information reported by Vickers [43] for urban water use. It is assumed the residential users reduce their water usage to these fractions after they are alerted. Industrial users are assumed to maintain 96% of their total water usage. A more complex model may be developed to more realistically reproduce system's behavior through incorporation of consumers’ mobility and word-of-mouth communication [17,44–46]. A more realistic modeling, however, would be often achieved at the price of longer simulation time.EPANET software is used for hydraulic simulation of the WDS. It is an open-source hydraulic and water quality modeling program developed by USEPA [47]. EPANET provides an integrated computational environment for an extended-period hydraulic and quality simulation of WDSs within pressurized pipe networks.To simulate a network hydraulics, EPANET solves two sets of governing equations. The first are a set of nnode linear conservation of mass equations for nnode junctions, which state that mass must be conserved as the net sum of inflows and outflows at every junction node i:(1)∑l∈JinQl−∑l∈JoutQl=qiwhere qiis the external water demand at node i, Jinand Joutare the set of pipes supplying and carrying flow from node i, respectively. The second are a set of npipe nonlinear conservation of energy equations for npipe pipes, which state that energy must be conserved between inlet node A and outlet node B of any pipe l:(2)HA−HB=KlQlnwhere HAand HBare the total energy at nodes A and B, Qland n are flow rate in pipe l and the exponent from the used head loss equation (e.g., 1.85 for Hazen–Williams equation), respectively, and Klis the head loss equation, which for instance for Hazen–Williams equation in English units is:(3)Kl=4.73LpCp1.85Dp4.87where Lp, Cp, and Dpare pipe length, roughness coefficient, and diameter, respectively.The above system of nnode+npipe equations are solved to simultaneously find total unknowns of nnode energy heads and npipe flow rates. The Newton–Raphson method is used to deal with the nonlinearities introduced by the energy equations [50]. Further details may be found in pages 187–193 of EPANET Users Manual [47]. A complete numerical demonstration for a four-pipe example network using gradient method is also provided in pages 5–38 of [70].To simulate a network water quality, EPANET solves a coupled system of differential/algebraic equations including conservation of mass and reaction kinetics equations using a Lagrangian time-based approach and finds concentrations in pipes and nodes. A complete description of water quality modeling in EPANET can be found in pages 193–198 of EPANET Users Manual [47].Demand-driven analysis (DDA) hydraulic modeling approach is used in this study. A basic premise of DDA models is that nodal water demands are fully satisfied during the simulation so that nodal head and pipe flow rates can be estimated through solving a system of quasi-linear equations [48]. This premise holds true in this study due to the fact that considered response strategies of hydrant operation and food-grade dye injection do not cause significant increase in demands or disconnection of demand nodes from pressurized water supply. No pressure-deficit conditions were also occurred during model application phase. Implementation of other response strategies (e.g., valve closure), however, may lead into abnormal pressure-deficit conditions where accuracy of DDA results is questionable. Under such conditions, replacement of the DDA network solver with a pressure-driven solver [14,49] is recommended.The optimum of a time-dependant optimization problem is a time-varying solution. Therefore, solving a time-dependant optimization problem requires optimization algorithms to not only search for the optimum, but also continuously track the optimum over time. This section first describes the time-dependant optimization problem of identifying time-varying optimal contamination response protocols during an emergency. This includes a description of the time-dependant objective function of minimizing ultimate health impacts and optimization decision variables of contaminant flushing and public warning. It is followed by a brief introduction of four different groups of dynamic optimization algorithms. The particular dynamic evolutionary algorithm applied in this study is finally described in detail.Emergency response decisions of hydrant operation and food-grade dye injection should be ideally optimized for effective reduction of the public health consequences, water services interruptions, false alerts, etc. This study focuses on health impacts but methodologies presented by [14–16] can be used for incorporation of other criteria as well. The health impacts for a given solution xkare expressed here mathematically as the ultimate total ingested mass (UTIM) of contaminant by all consumers during the course of a contamination incident:(4)minUTIM(xk)=∑i=1Np∑j=1NIVi,j(xk)×Ci,j(xk)where Np=size of population served by the WDS, NI=number of water ingestion events for each individual, Vi,j=volume of water ingested by individual i at ingestion event j, and Ci,j=concentration of contaminant in water volume ingested by individual i at ingestion event j. Vi,jis assumed to be zero after an individual is alerted or gets sick. The clock time at which a consumer is alerted is determined by the EPANET toolkit extended-period hydraulic and quality run for simulation of dye propagation in WDS. Spatial and temporal distribution of contaminant concentration (Ci,j) are a function of network characteristics, contamination scenario, and response protocol xiand are the output of EPANET toolkit extended-period run that simulates contaminant propagation in WDS. Therefore, every simulation for the determination of UTIM requires two EPANET toolkit runs; one for dye propagation and one for contaminant transport.As described in the previous section, there exist multiple time-varying system parameters whose changing patterns are not known a priori because they are influenced by previous system states. Thus, Eq. (4), which indicates the “predicted” value of ultimate health impacts at every stage of the emergency, represents a time-varying fitness function. Static optimization algorithms are insufficient for dealing with such changing objective functions. They need to be modified to adapt rapidly to changes in environment for generation of effective response protocols at every phase of the emergency. Obviously, the simplest approach to respond to a change in the environment is to consider each change as the emergence of a new optimization problem that needs be solved from scratch. Given sufficient time, this is obviously a feasible approach. However, the time available for re-optimization is normally short during an emergency and changes may occur frequently or even continuously. Moreover, this approach presumes that a change in the environment can be identified, which is not always true. Dynamic optimization techniques systematically reuse information from previously explored environments to accelerate optimization process in emerging environments.Decision variables that should be optimized to minimize UTIM are the elements of response mechanisms of contaminant flushing and dye injection. In this paper, they include the locations for opening hydrants and injecting dye across the city and this will be called a response protocol. Hydrants of Mesopolis network are located on the intermediate nodes (i.e., zero-demand nodes that may connect to a series of terminal demand nodes) and are treated here as a possible location for contaminant discharge or food-grade dye injection. Total number of flushing (nFL) and dye injection (nIL) locations is set a priori, and depends on availability of labor and equipment. Due to this limitation of resources during emergencies as well as inevitable contamination detection and response delay, there are always people who are exposed before a response is implemented. Contamination thus can be minimized but cannot be zeroed. Remaining contaminant residuals in the system should be cleaned up through system flushing during a comprehensive recovery phase after the emergency response.Evolutionary algorithms (EAs) resemble natural biological evolution, and since evolution is a continuous adaptation process in nature, they are promising candidates for tackling dynamic optimization problems [51]. To solve dynamic optimization problems, static EAs should be modified to adapt and recover from the changes during the evolution process. Major modifications in the static EAs are necessary for a timely adaptation to the changing environment to balance between convergence and exploration. Compared to static EAs, higher emphasis should be placed on exploration after a change occurs, so that the algorithm can react rapidly to the change and track the moving optimum. Different methods have been proposed to deal with this issue, which can be classified into four groups [24,51]:(1)Boost diversity after a change: the EA is initially run in standard fashion. As soon as a change in the environment is identified, explicit strategies are implemented to generate diversity in the population. A common technique is hypermutation [52], where the mutation rate is significantly increased for a limited number of generations after the change event is detected and then decreased over time. A very high mutation rate essentially results in a re-initialization of the population, whereas a very low mutation rate does not boost sufficient diversity of the population.Maintain diversity throughout the run: convergence is limited through constant diversification hoping that a diverse population is more promising to adapt to time-varying changes. Thermodynamic genetic algorithm [53], where the original objective function is replaced with an entropy-based value, and multiobjective-based method [54], where an artificial objective is used to promote diversity, are representatives of this approach. The multiobjective-based approach is used in this current study and is described in detail in Section 3.2 below.Memorize good solutions: the algorithm retains good solutions from past generations. This strategy provides diversity and helps the algorithm retrieve the optimum in repetitive environments. Diploidy approach [55], where redundant representations are used to generate solutions, is a popular instance of memory-based approaches.Use multiple subpopulations: the population is clustered into multiple subpopulations that evolve together to explore multiple promising regions of the decision making space. Some representative methods are self-organizing scouts [56] and finder-tracker multi-swarm particle swarm optimization [57].This study employs the multiobjective-based diversity preservation approach, which has been demonstrated as a robust and efficient method by previous research [54,58]. The main advantage of this technique is that it eliminates the need for defining a priori the proper diversity preservation parameter. The proper balance between convergence and exploration is systematically preserved during the process through treating diversity as a secondary (artificial) objective, which is optimized simultaneously with the main (true) optimization objective, as schematically illustrated in Fig. 1.The multiobjective-based diversity preservation approach used here multiobjectivizes[59] this classic single-objective optimization problem to a bi-objective optimization problem. Health impacts are minimized with simultaneous maximization of diversity hoping this increased diversity of the GA population helps tracking the time-dependant optimum. Once the multiobjectivization is performed, a traditional multiobjective optimization algorithm may be used to solve the constructed bi-objective optimization problem.The artificial diversity-preservation metric may be mathematically expressed in different ways. Three following formulations are examined here:(1)Distance from the nearest neighbor (DNN): The artificial objective for a solution xiis defined as the distance from xito its nearest neighbor in the optimization decision space. Therefore, a pair of individuals that are very similar in the decision space will have a relatively poor artificial objective value, and thus diversity in population is encouraged over the search space.(5)DNN(xi)=mind(xi,xj),j=1,...,Ngpj≠iwhere Ngpis the GA population size and d(xi, xj) is the distance between two GA solutions (response protocols) in the optimization decision space. Selection of DNN as the artificial objective function implies that the model increases diversity through maximizing the minimum distance between solutions.Average distance from all solutions (ADS): Diversity is quantified as the average distance of xito all other individuals in the GA population. This formulation prefers solutions at the edge of population to boost the spread of the population over the search space.(6)ADS(xi)=1Ngp∑j=1Ngpd(xi,xj)Distance from the best solution in the current population (DBS): The diversity metric is expressed as the distance from xito the current best solution in the GA population (with respect to the true objective function) to avoid any likely trap caused by local optima.(7)DBS(xi)=d(xi,xbest)A major difference between DBS and the two other metrics is that it accounts for the dissimilarities in the objective space through comparing xiwith the solution with minimum true objective space.Each response protocols is defined by a string of total nFL+nILlocations for opening hydrants and injecting dye. To find d(xi, xj), differences between geographical coordinates of one-to-one pair of kth locations in solutions xiand xj(i.e., ΔXkand ΔYk) are first consecutively calculated, and the calculated differences are then summed up:(8)d(xi,xj)=∑k=1nFL+nIL(ΔXk+ΔYk)The bi-objective optimization problem defined by Eq. (4) and any of Eqs. (5)–(7) may be solved using a multiobjective optimization algorithm. Non-dominated Sorting Genetic Algorithm II (NSGA-II) [60] is among the most popular algorithms for solving both classic water resources problems and emergent dynamic optimization problems [61–66]. NSGA-II is an elitist multiobjective evolutionary algorithm, which uses a fast strategy for non-dominated sorting and does not need any user-defined parameter for preservation of diversity in solutions. On the basis of the general concept of dominance in multiobjective optimization [67], response protocol x1 dominates x2 if two conditions are met: (1) x1's UTIM is smaller than or equal to x2's UTIM and x1's diversity is greater than or equal to x2's diversity, and (2) x1's UTIM is smaller than x2's UTIM or x1s diversity is greater than x2's diversity or both.The best response protocol in each time step that is reported to the emergency managers is the minimum-UTIM solution in that time step. The particular algorithm applied in this study uses simulated binary crossover [68], and polynomial mutation [67] for reproduction of offspring response protocols (i.e., contaminant flushing and dye injection locations). A genetic algorithm chromosome representation of a response protocol is shown in Fig. 2. Each flushing or injection node ID has a set geographical location represented by its latitude and longitude coordinates. To explore new locations, reproduction operation is performed on coordinates of the parent solutions and the closest intermediate node in the WDS is chosen for the offspring solution. Acceptable range of coordinates are determined by coordinates of the nodes in the network with the minimum and maximum latitudes and longitudes.A virtual city, Mesopolis, with a population of nearly 147,000 is used to demonstrate the proposed dynamic framework [69]. In what follows, a general description of Mesopolis, considered contamination scenario and updates, and model settings are provided at first. Dynamic simulation–optimization model is then applied to identify and track time-dependant optimal response protocols. The performance of the three different diversity preservations metrics and response mechanisms of contaminant discharge and food-grade dye injection are evaluated and compared. A thorough analysis is then performed to understand how the different factors that contribute to the unpredictable time-varying system behavior affect the time-dependant optimal response protocols during an emergency individually and in combination.Mesopolis is developed using a historical development timeline to incorporate as many attributes of a true city as possible. The WDS includes one reservoir, two water treatment plants (WTP), 13 tanks, 65 pumps, 876 hydrants, and 2062 water mains and is shown in Fig. 3. The East WTP distributes water across almost the entire city, while the West WTP supplies water only to western Mesopolis. Different types of consumers exist in Mesopolis such as residential, commercial, and industrial consumers. Water demands associated with different consumers fluctuate during the day. This temporal variability in demand is incorporated through defining distinct diurnal demand patterns for different consumers, as shown in Fig. 4.An arbitrary contamination emergency timeline is defined and used here as shown in Fig. 5. It is assumed that the true contamination scenario is accurately identified at time 10:00, and perceived scenario is updated twice until then as described in Table 1. This updating practice is performed to analyze the effect of changes in perceived source attributes. Consideration of only two updates of perceived scenario attributes in this application example is for the sake of a more clear and understandable assessment and discussion. Without a need for any modifications, this model could be equally applicable when scenario is updated more frequently or even continuously.The EPANET hydraulic time step is set to 1h. The simulation duration is 24h and the dynamic optimization model run starts after a 6-h response delay after the injection starts, i.e. at 06:00. The underlying assumption here is that public exposure becomes comparatively negligible after the first day as the emergency managers take a comprehensive set of response actions including contaminant containment, discharge, public warning, etc.The UTIM values associated with the time-varying perceived contamination scenario are reported in Table 2for the conditions that consumers’ reactions are ignored or considered. The observation that the ingested contaminant mass over injected load ratio is very small is explained by the fact that only an extremely small fraction of total urban water consumption is used for drinking. Table 2 indicates that smaller TD reduces the UTIM more because the individuals become sick earlier and cease drinking contaminated water, and this consequently decreases the ingested amount of contaminant by every individual and the entire population as a whole.The values of UTIM listed in Table 2 indicate the ultimate value of total ingested mass (TIM) of contaminant by the entire population. In other words, as the optimization fitness function represented by Eq. (4) also indicates, UTIM is equal to TIM at the end of emergency period, i.e. at 24:00. This projected accumulation of TIM over time for the contamination scenarios perceived at different time periods during the emergency is shown in Fig. 6. Fig. 6(a), (b), and (c) show the projected time series of TIM at time periods of 06:00–08:00, 08:00–10:00, and 10:00–24:00, respectively, using the perceived scenarios associated with each period. It is observed that no contaminant mass is ingested until after hour 06:00 although the injection starts at 00:00. This is because the first daily water ingestion event happens at 07:00, as described in Section 2.3. The decreases in perceived injected contaminant mass from 300kg to 250kg during the emergency causes the UTIM and the overall slope of the TIM time series to decrease as observed in Fig. 6(a)–(c). The uncertainty bound of TIM due to the uncertainty in TD also widens as the perceived injected mass decreases.The number of hydrants and dye injectors depend upon availability of resources and personnel during an emergency and are each set to 3 in this study. Sensitivity analyses on the effect of these two parameters on the effectiveness of response measures are provided in [14,15]. Hydrants remain open for 5h once they are opened for flushing and are closed afterwards. The emitters section of the EPANET toolkit is utilized to realistically model the hydrants within the WDS. During the contaminant discharge period, the emitter discharge coefficient is set to 166.5gpm/psi0.5, which is associated with a 3-in. diameter connection fire hydrant. The amount of dye injected per each injector is set to 100kg and the injection duration is 1h based upon conclusions made by [15] that shorter injection durations are more effective for reducing the impacts. The NSGA-II population size is set to 50. Crossover and mutation rates are 0.85 and 0.04, and simulated binary crossover distribution and polynomial mutation indices are set to 15 and 10, respectively. Acceptable range of geographical coordinates are (32,871.17, 120,349.13) to (160,866.94, 195,463.80) in feet.All model runs in this application example are performed using a single core of a Dell Precision T5500 Workstation with Xeon® CPU running at 2.40GHz and 6 GB RAM. Application of a supercomputer equipped with multi-level parallel processing software might significantly improve the computational efficiency, which helps identifying better response protocols at every time during an emergency. In this study, however, use of an ordinary desktop computer is preferred to account for the fact that most water utilities do not posses such advanced computational resources.As described earlier, changes in emergency environment are due to multiple contributing factors including perceived scenarios updates, actions implemented by the utility operators, and reactions made by the alerted or sick consumers. The effect of these factors is neglected at first to investigate how performance of the identified optimal response protocol degrades as time passes. The effect of other contributing factors will be taken into account in later sections.Fig. 7indicates the UTIM time series associated with the best response protocol that is identified and updated recurrently by the dynamic simulation–optimization model as the emergency proceeds. This can be interpreted as the evolution plot of the optimal (i.e., minimum-UTIM) response protocol during the optimization process as the emergency proceeds. As the formulation of the true objective function (Eq. (4)) explains, these time series indicate the ultimate value of total ingested mass after the emergency ends and not the value of total ingested mass during the emergency. This explains why the no-response UTIM time series shown in Fig. 7 is a flat horizontal line. The response time series indicates how much UTIM can be reduced at every time during the event if the optimal response protocol identified at that time is implemented. Because the last daily water ingestion event happens at 18:00 and UTIM thus remains constant afterwards, the horizontal axis is cut at 18:00. The distinctive behavior of this evolution plot when compared with the common plots for static minimization problems (where the objective function exhibits a constant decreasing trend) is due to the fact that the global optimal response protocol here is a time-varying and generally degrading solution.The horizontal axis in Fig. 7, which denotes time, starts from 06:00 because the response delay is set here to 6h. In other words, the model run is started with a lapse of 6h after the contaminant intrusion starts to account for the time that it takes the emergency managers to learn about the contamination threat. Some contaminant mass has been thus ingested by the consumers before the managers respond. After the dynamic optimization model is run, the quality of optimal response protocols suggested by the model changes over time. Longer time allows the model to better explore the search domain and converge to the current global optimal solution more. This extended time, however, may reduce the effectiveness of the current global solution because of the prolonged exposure of the public to the contaminant and wider spread of the contamination. As time passes, public are more exposed to the contaminant and this degrades effectiveness of the current global solution. The observation that UTIM decreases during the first hour implies that model convergence outstrips global optimal solution degradation during the very early stages.The UTIM time series follow a stepwise pattern with 1-h increment jumps. This is because the hydraulic analysis time step is set to 1h in the EPANET hydraulic simulation model. A shorter time step favorably increases simulation accuracy and leads to a smoother curve but adversely increases computational time. Convergence of model to better solutions during the emergency may be clearly observed during every 1-h time increment where UTIM gradually and consistently decreases. Hourly sudden jumps in UTIM indicate the reduction in response protocol performance as contaminant spreads more and the smooth decreasing trends are evidence of increased convergence to current optimum.To analyze the performance of different diversity measures, separate model runs are performed using DNN, DBS, and ADS measures one for each complete run. The UTIM time series shown in Fig. 7 visually demonstrate that DNN can most effectively reduce the UTIM at each time step. Numeric comparison may be also performed through calculating the area confined by each time series and the no-response line – a larger area indicates a better performance. The calculated areas associated with ADS, DBS, and DNN are 153.2, 129.4, and 189.5gh, respectively. Conclusively, both quantitative and visual comparisons indicate that DNN outperforms ADS and DBS and will be thus used for the remaining analyses in this study. The number of function evaluations is slightly different for different cases. Total number of function evaluations for the DNN, DBS, ADS cases in Fig. 7 are equal to 14,950 (299 generations×50 solutions), 14,850, and 15,000, respectively. Total runtime of the optimization process, however, is dictated by the emergency response time period and is thus the same (12h here) for all the cases in this paper regardless of their complexity. The average function evaluation time is thus approximately 2.9s for DNN case, as an instance.As it was previously explained and schematically illustrated in Fig. 1, the balance between convergence and exploration in multiobjectivization approach used here is methodologically maintained via simultaneous maximization of diversity (artificial) and minimization of health impacts (true) optimization objectives. Fig. 8illustrates a numerical example of the evolution of this non-dominated front corresponding to DNN distance measure and ignoring the effects of perceived scenario update, response protocol execution, and consumers’ demand changes. It corresponds to the UTIM time series curve associated with DNN shown in Fig. 7. The nonconventional evolution trend observed is due to the simultaneous degradation of global minimum-health-impact response protocol and convergence of the model to this time-varying protocol over time.The performance of the hydrant operation and dye injection response mechanisms can be compared individually in the dynamic model. Fig. 9shows the time series for the minimum-UTIM response protocol offered by the optimization model using hydrant operation, dye injection, or both. The minimized health impacts reduce during the first hour and generally increase afterwards for all three cases. Visual inspection shows dye injection outperforms hydrant operation, and best performance is achieved when both strategies are implemented in combination. The areas confined by no-response and the response UTIM time series are 71.0, 147.8, and 189.5gh for time series corresponding to hydrant operation, dye injection, and both strategies, respectively. This quantitatively confirms the visual judgment outcome. This finding is specific to the particular response protocol settings described earlier (e.g., injected mass of dye and flushing duration) and may not be necessarily generalizable.Besides the response execution delay, the effectiveness of optimal response protocols identified at every time step depends on the perceived scenario updates, previous response protocols executed by emergency managers, and changes in alerted or sick consumers’ water demands. Fig. 10shows how the UTIM time series changes as the effects of these contributing factors are taken into account individually or in combination.Fig. 10(a) indicates the UTIM time series when only the effects of perceived scenario updates, which are explained in Tables 1 and 2, are considered. Scenario updates significantly change the optimization search domain and the model adapts to these changes to track the moving optimum. This is evidenced by the observation that the drops and jumps in the no-response and response UTIM time series match each other. Further insight may be obtained through the illustration of moving optimum in the decision space as the perceived scenario is updated. Fig. 10 shows the spatial distribution of ultimate ingested contaminant mass at 07:59 (i.e. right before the first update) and 11:05 (i.e. 2h after the first update). At 07:59 (when UTIM is 195.4g), the East WTP is perceived as the contaminant injection location and this explains why the projected impact area is larger than 11:05 (when UTIM is 186.7g) when the perceived injection location is Node IN654, which is an intermediate node. Fig. 11also shows that the currently identified optimal response protocol significantly changes in response to the perceived scenario updates. Suggested optimal locations for contaminant discharge and dye injection noticeably match the projected impact areas at each of considered clock times. The genetic algorithm chromosome representation of the response protocol suggested at time 07:59 is also shown in Fig. 2(b).As it was shown in Fig. 5, the managers execute the current best minimum-UTIM response protocols at clock times 09:00 and 12:00 for the emergency timeline example application presumed here. Consequences of these actions are manifested in the UTIM time series shown in Fig. 10(b) by a decreasing trend in UTIM starting from each execution time. Observation of extended decrease rather than a sudden drop is because the response protocols are implemented over a period of time – dye is injected over 1h and hydrants are open for 5h. The adaptive model takes into account the effect of these actions when later actions are evaluated. This means the response protocol is now optimized given one or more optimal response protocols are already executed or are being implemented. In other words, the model superposes current response protocols onto the previously executed ones. The reason no-response curve is different from Fig. 10(a) is that the effects of perceived scenario updates are not considered in Fig. 10(b).Compared to Figs. 7 and 9, Fig. 10(b) shows that the originally increasing trend of the time series transforms into a flat line after the response protocols are executed at 09:00 and 12:00. This is because the contaminant concentrations are much reduced in the WDS due to previous contaminant discharge and public warning actions that together reduce public exposure risk. This also may imply that the increased quality of solutions due to convergence now neutralizes the degradation in solutions performance due to the prolonged contaminant spread time.Fig. 10(c) indicates the UTIM time series when the effect of changes in consumers’ water consumption behavior, i.e. ceasing drinking tap water and reducing water demands, is taken into account. UTIM time series are presented for three different TD estimations for both when response is taken or not. In general, the UTIM time series are very similar in trend to when the demand changes effects are not considered (Fig. 9). Consideration of changes in consumers’ behavior lowers the ultimate health impacts because ceasing to drink tap water reduces the possibility of ingesting more amount of the contaminant. This is also in agreement with the observation that setting TD to smaller values leads to a larger reduction in UTIM. When TD is smaller, the ingested contaminant mass exceeds TD for a larger number of consumers faster. This subsequently reduces UTIM as more consumers stop drinking contaminated water. Reduction in water use by different residential, commercial, and industrial consumers also alters WDS hydraulics, and thus contaminant and dye propagation. This effect consequently changes the global optimal response protocol at different times during the event.The UTIM time series for the most realistic representation of the system dynamics is shown in Fig. 10(d). This time series accounts for all the contributing factors including temporal variability of perceived contaminant spread, response actions taken by the emergency managers, and water ingestion and demand changes by the alerted or sick consumers. This inclusive time series is understandably similar in trend and intensity to a time series that one may envision through the superposition of the time series associated with each of the contributing factors individually (Fig. 10(a)–(c)). Sudden changes in UTIM at times 08:00 and 10:00 are due to updates made to the perceived contamination scenario at these times. Implementation of optimal response protocols at 09:00 and 12:00 reduces the UTIM as expected. This is accompanied by general decrease in UTIM throughout the entire time period as more alerted and sick consumers stop drinking contaminated water.

@&#CONCLUSIONS@&#
An innovative modeling approach to contamination threat management in drinking water networks was presented by taking into account the unpredictable time-varying factors such as perceived contaminant source attributes and the feed-back mechanisms between the hydraulic network, consumers, and managers. Through the incorporation of these random factors, the dynamic simulation provides a more realistic picture of the uncertain contamination emergency environment than the static approaches that presume complete knowledge about present and future conditions. Once integrated with a dynamic optimization algorithm that methodologically preserves adaptation, the resulting dynamic simulation–optimization model was able to identify and track time-varying optimal health-protection measures to serve the needs of utility operators during the course of an emergency. Demonstration of the proposed adaptive scheme on a virtual city using a regular desktop computer indicates this model can be used as a helpful decision support tool by water utilities to reduce water contamination health impacts.There is no claim that the response protocols identified by the proposed dynamic optimization scheme are globally optimal as with any static or dynamic EA-based model. Nevertheless, because EAs mimic natural evolution and evolution is an adaptation process in nature, they are fitting candidates for solving nonlinear optimization problems in changing environments. Future studies may examine performance of other types of dynamic EA-based schemes described in this paper for a more efficient optimization of response protocols during a contamination emergency.Hypothetical contamination events were used in this study to investigate the applicability of proposed adaptive framework for protecting public health against contamination threats. Although complete validation of the model is not feasible because data is not available about real intentional WDS contamination incidents, the proposed modeling framework is useful for analyzing what-if scenarios to enhance the state of preparedness. Knowledge about the degradation of the optimal response protocols performance over time for different intrusion scenarios can be obtained and illustrated as time series of optimal reduction in ultimate health impacts. These informative plots are useful for estimation of the added value of rapid response once an intrusion scenario occurs and identification of critical scenarios. They can be utilized to guiding risk mitigation and emergency preparedness decisions.The multiobjective-based dynamic optimization algorithm used in this study defines and maximizes an artificial objective function for preserving diversity to enhance adaptability to changing environments. The performance of three different diversity preservation measures (distance from the nearest neighbor, average distance from all solutions, and distance from the best solution in the current population) were investigated. Visual and quantitative comparisons indicated the distance from the nearest neighbor measure would provide higher quality response protocols during an emergency.This study used multiobjective-based algorithm to solve dynamic emergency response optimization problem. Future efforts are encouraged to apply alternative dynamic optimization algorithms such as hypermutation and self-organizing scouts as well to this complex but critical optimization problem. Comparative analyses will help identification of methods that are capable of finding more effective water contamination response protocols in a shorter time during contamination emergencies where every single second counts.The adaptive simulation–optimization model described in this paper is intended to be a major component of a cyberinfrastructure for drinking water network contamination threat management. This cyberinfrastructure will include multiple modules such as real-time SCADA data processing schemes, adaptive contaminant source identification models, graphical user interfaces, among others. Work is underway to construct and embed these modules. This adaptive cyberinfrastructure can be used both as a realistic emergency simulator for training the water utility operators during the preparedness phase and also as a valuable decision support system for an intelligent and informed emergency response in the event of a real contamination threat.