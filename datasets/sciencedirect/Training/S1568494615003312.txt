@&#MAIN-TITLE@&#
A telemedicine tool to detect pulmonary pathology using computerized pulmonary acoustic signal analysis

@&#HIGHLIGHTS@&#
Respiratory sound signals are prepossessed and respiratory cycles are segmented.S-transform based statistical features were extracted.The features were classified using KNN, SVM and ELM classifier.Accuracy of 94.99%, 96.85% and 98.52% for KNN, SVM and ELM, respectively.Telemedicine software was developed using ELM classifier.

@&#KEYPHRASES@&#
Breath sounds,S-transform,Extreme learning machine,Health care,Telemedicine,

@&#ABSTRACT@&#
BackgroundDetection and monitoring of respiratory related illness is an important aspect in pulmonary medicine. Acoustic signals extracted from the human body are considered in detection of respiratory pathology accurately.ObjectivesThe aim of this study is to develop a prototype telemedicine tool to detect respiratory pathology using computerized respiratory sound analysis.MethodsAround 120 subjects (40 normal, 40 continuous lung sounds (20 wheeze and 20 rhonchi)) and 40 discontinuous lung sounds (20 fine crackles and 20 coarse crackles) were included in this study. The respiratory sounds were segmented into respiratory cycles using fuzzy inference system and then S-transform was applied to these respiratory cycles. From the S-transform matrix, statistical features were extracted. The extracted features were statistically significant with p<0.05. To classify the respiratory pathology KNN, SVM and ELM classifiers were implemented using the statistical features obtained from of the data.ResultsThe validation showed that the classification rate for training for ELM classifier with RBF kernel was high compared to the SVM and KNN classifiers. The time taken for training the classifier was also less in ELM compared to SVM and KNN classifiers. The overall mean classification rate for ELM classifier was 98.52%.ConclusionThe telemedicine software tool was developed using the ELM classifier. The telemedicine tool has performed extraordinary well in detecting the respiratory pathology and it is well validated.

@&#INTRODUCTION@&#
Electronic Health (eHealth) is a health care related information exchange tool, which uses information and communication technology (ICT). Telemedicine is one such eHealth tool. Telemedicine is of two types namely, asynchronous and synchronous telemedicine. The asynchronous telemedicine is also known as store and forward telemedicine. The synchronous telemedicine is also known as real-time telemedicine. In store and forward telemedicine, data are collected and sent electronically to a medical professional for further analysis and diagnosis. Synchronous telemedicine is real time and interactive and is usually done by videoconference with the audio and visual consultation augmented by distant examination [1]. In recent years a number of studies have highlighted the importance of telemedicine tool for patients with respiratory related illness. Respiratory related illness is currently fourth most common cause of mortality worldwide [2]. It was reported that patients with Asthma using self-monitoring tool at home obtain accurate results compared to that of results collected by medical professional [3]. It was also found that the use of telemedicine tool has not affected the quality of care in patients with Asthma [4]. In another study it was observed that use of self-monitoring tool reduce the frequencies of hospitalization in patients suffering from COPD [5]. It also reduces the cost implications of hospitalization. Another study revealed that the frequency of hospitalization was reduced in patients with COPD due to web-based call centers [6]. The advantages of using telemedicine tools in respiratory related illness include but are not limited to improve access to patients in remote areas, reduce frequent hospitalization, reduce the cost incurred in traveling to hospital and the doctor's consultation fees and also reduce the shortage of health care professionals. Auscultation is the process of listening to sounds heard over the human body, which gives vital information on the present state of the internal organs. Listening to the respiratory sounds can lead to diagnosis of respiratory pathologies [7]. Auscultation is the basic and primary physical examination done by all medical professionals. Auscultation mainly relies on the hearing perception of the medical professional and it may vary for each individual [8]. Hence it is required to develop a computerized respiratory sound analysis system which can accurately detect the respiratory pathology. Studies on computerized respiratory sound analysis started to appear in the literature in the early 80s [9]. Table 1lists few recent researches in computerized respiratory sound analysis. However there is not any telemedicine tool with application to detection of respiratory related illness.This study intends to develop and evaluate an asynchronous telemedicine tool to detect pulmonary pathology using computerized respiratory sound analysis and store the analysis output and forward it to a predefined doctorsThe proposed system has four processing stages namely data acquisition, pre-processing, feature extraction and classification. In the data acquisition stage, the data required for developing the telemedicine tool and also the data required to validate the telemedicine tool are collected. In the pre-processing stage, the breath sounds are filtered to remove heart sounds and other artefacts followed by breath sound phase segmentation. In the feature extraction stage, S-transform is applied to the breath sound cycles followed by statistical features extraction from the S-transform matrix. In the classification stage, the respiratory pathology is detected using a two-stage classification. The block diagram of the proposed work is illustrated in Fig. 1.The breath sound signals were recorded at the department of pulmonary medicine, Kempegowda Institute of Medical Sciences (KIMS), Bangalore, India. The ethical clearance was granted by the institutional ethics committee of KIMS and all the subjects involved gave written informed consent. The research was performed in accordance with the principles of the Declaration of Helsinki.The protocol for breath sound acquisition used in this study was formulated from CORSA (Computerized Respiratory Sound Analysis) which is a standard developed by European Respiratory Society (ERS) [20]. The recording type is a short-term recording (20s recording from each auscultation point). The subjects were asked to be in a sitting position with their hands on the thighs to avoid contact of arms to the auxiliary areas. The data were recorded using WISE digital stethoscope from three locations (trachea, left and right posterior base of the lung) sequentially. A pictorial illustration of the auscultation location is depicted in Fig. 2. The wireless digital stethoscope acts as an air-coupled sensor. This involves the movement of the diaphragm exposed to the pressure wave induced by the movement of the chest wall during respiration. This type of recording is termed an acoustic approach [21]. The respiratory manoeuvre performed by subjects in this study during recording is tidal breathing. For this research work two sets of data were collected. The first set was used for developing the telemedicine tool and the second set was used for the validation of the telemedicine tool. In the first set, the subjects were all adults (both male and female) with an age difference of 48±13. The first set comprises of total 72 subjects in which 29 were female and 43 were male subjects. The wide variation in age and gender does not have any effect on the breath sounds [22,23]. In these 72 subjects, 24 where control subjects, 24 were continuous respiratory sounds and 24 discontinuous respiratory sounds. The 24 subjects with continuous respiratory sounds are further divided into 12 wheeze and 12 rhonchi. Similarly, the 24 subjects with discontinuous respiratory sounds are further divided into 12 fine crackles and 12 coarse crackles. The above mentioned breath sound acquisition protocol was performed for five times (number of trials) for each subject in each auscultation point at different time of the day. In total, 360 samples from trachea, 360 samples from left and 360 samples from right posterior base of the lung were recorded for this study. For each case (controls or continuous and discontinuous respiratory sounds), 120 recordings from trachea, 120 recordings from left and 120 recordings from right posterior base of the lung were used in this study. For validation purpose the same data acquisition protocol was used and data were collected. In the validation data set, the subjects were all adults (both male and female) with an age difference of 41±08. In which data were collected from 48 subjects. These 48 subjects comprise of 16 control subjects, 16 continuous respiratory sounds and 16 discontinuous respiratory sounds. The 16 subjects with continuous respiratory sounds are further divided into 8 wheeze and 8 rhonchi. Similarly, the 16 subjects with discontinuous respiratory sounds are further divided into 8 Fine crackles and 8 coarse crackles. In total, 225 samples from trachea, 225 samples from left and 225 samples from right posterior base of the lung were recorded for this study. For each case (controls or continuous and discontinuous respiratory sounds), 75 recordings from trachea, 75 recordings from left and 75 recordings from right posterior base of the lung were used in this study.The original sampling rate of the breath sound recordings was 10kHz which was then down sampled to 8kHz as per CORSA standards. Following the down sampling, the breath sounds were filtered using high-pass filter at 7.5Hz to remove DC offset (1st order Butterworth filter) and low-pass filter at 2.5kHz to avoid aliasing (8th order Butterworth filter). The breath sounds are then filtered using 4th order Butterworth bandpass filter (150–2000Hz) to remove the heart sounds [1]. The breath sounds were segmented using the fuzzy inference system into respiratory cycles [12]. First five respiratory cycles were segmented from each breath sound recordings for further processing. The segmented respiratory cycles are then transformed to time-frequency domain using S-transform.Time-frequency analysis is being extensively used in signal processing due to its ability to characterize non-stationary signals. The respiratory sounds have non-stationary and non-linear characteristics [24]. This study intends to investigate the performance of S-transform based statistical features in the classification of respiratory sound signals. The S-transform is chosen for the analysis as it posses different advantages. S-transform is a continuous wavelet transform with a phase correction. It combines the frequency dependent resolution of the time-frequency phase and absolutely referenced local phase information. S-transform provides good frequency dependent resolution while the relationship with the Fourier transform is preserved. The window of the S-transform becomes shorter as the frequency increases. Hence, it has a good frequency localization, superior time and frequency resolution at low frequencies and high time resolution at high frequencies. The combination of STFT features with the advantages of wavelet function in S-transform (ST) makes it ideal feature extraction algorithm to analyze the non-stationary signals such as the respiratory sounds [25].The mother wavelet function of a continuous wavelet transform for signal x(t) is given(1)Wτ,d=∫−∞∞xtwt−τ,ddtThe ST of x(t) signal is defined as phase factor multiplied with specific mother wavelet as shown in Eq. (2).(2)Sτ,f=ei2πfτwτ,dwhere the mother wavelet for this particular case is defined as(3)wt,f=f2πeτ−t2f22e−i2πftdtwhere d is the scale parameter which is the inverse of the frequency f. Eq. (3) does not satisfy the admissibility condition for zero mean of a wavelet, Eq. (2) is not strictly a continuous wavelet transform. Therefore, the continuous ST can be obtained using Eq. (4).(4)sτ,f=∫−∞∞xtf2πeτ−t2f22e−i2πftdtThe x(t) signal is defined in discrete form as x(kT) where T is the sampling interval, the total sampling number N, k=0,1,…,N−1. The discrete Fourier transform of x(kT) is obtained as(5)xnNT=1N∑k=1N−1xkTe−i2πnkNwhere n=0,1,…,N−1.Using Eq. (5), the ST of discrete time series x(kT) is given by letting τ→jT and f→n/NT as(6)sjT,nNT=∑m=0N−1xm+nNTe−2π2m2n2ei2πmkN,n≠0For n=0, it is equal to the constant defined as(7)sjT,0=1N∑m=0N−1xmNTThe transformation method yields an m×n ST-matrix whose rows corresponds to frequency and the columns to time. The elements in the ST-matrix are in complex form. The ST-matrix is obtained as:(8)AkT,f=SkT,n/NTFrom the ST matrix, statistical features (mean and standard deviation) were extracted. The mean and standard deviation of the ST matrix was extracted by using the mathematical expressions in Eqs. (9) and (10).(9)Mean(μx)=1n∑i=1nxi(10)Standarddeviation(σx)=1n−1∑i=1nxi−μx212where xirepresents the S transform matrix and n is the number of elements in the sampleThe classification stage comprises of three classification models. The first classification model detects whether the respiratory sounds is normal or continuous or discontinuous respiratory sound. If it is continuous respiratory sounds then the features are forwarded to the second classification model to detect whether it is wheeze or rhonchi. If it is discontinuous respiratory sounds then the features are forwarded to the third classification model to detect whether it is fine crackles or coarse crackles. The classification was performed using KNN, SVM and ELM classifiers. A detailed description on KNN and SVM classifiers can be found in the works of Palaniappan et al. [16]. However ELM classifiers need further explanation. ELM are single layer feedforward neural networks (SLFN) [26]. In ELM a continuous probability density function is used to assign the weights between the input and hidden neurons, while the hidden and output layer weight is analytically assigned [27]. ELM classifier has computationally efficient structure and rapid classification ability. The activation function used in this work is sigmoidal (sig) activation function as shown in Eq. (11).(11)sig=11+exp−xThe number of hidden neuron for the experiments was kept constant at an optimal level of 360, after experimental trials.A standalone software prototype was developed after the validation was carried out using the best performing classifier. Based on the performance of the classifier in terms of classification accuracy the best classifier was used in developing the software tool. Fig. 3shows the front end of the telemedicine tool. The front end comprises of five panels namely, control panel, sensor placement panel, display panel and measurement panel. The control panel comprises of various controls to operate the software prototype. There are tabs to record the respiratory sounds and also to load existing respiratory sounds in the computer. When the record tab is clicked, the sensor placement panel appears below the control panel. The sensor placement panel displays the place where the sensor should be placed while recording. There is a patients information tab, when clicked will open the patients information window. The patient's information window is displayed in Fig. 4. The patient's information window saves a copy to use it when it is forwarded to the doctor. When the forward through email tab is clicked, the recorded respiratory sounds (trachea, right lung base and left lung base) along with the patient's information and the print screen of the front end will be sent to the predefined doctor's and also a copy is sent to our own The control panel also allows us to listen to sounds, by using the play, stop, pause, resume tabs. There is a reset tab in the control panel which reset the software to the blank front end. There is a save tab which on clicking saves the recordings along with the patients information and also the patients diagnosis report. We have also included error messages for certain tasks such as interrupting while recording by clicking other tabs. There is a status bar below the control panel which always displays the current status of the software. The display and analysis panel displays the original signal plot, spectrogram of the original signal and power spectral density plot of the original signal. There is a pop-up menu in the display panel to move between the recordings (trachea, right lung base and left lung base). The measurement panel displays the diagnosis output such as normal or abnormal, continuous or discontinuous lung sounds, wheeze or rhonchi or fine crackles or coarse crackles and the respiratory rate. There is a product help tab above the measurement panel which opens a .pdf file which explains how to use the software prototype. The software prototype also comprise of a library of respiratory sound files for the purpose of learning auscultation which will benefit medical students. The respiratory sound library comprises of 1800 sound recordings of normal and various pathology. The developed tool can be used as a differential diagnosis tool by medical professionals, Education tool for medical students to learn auscultation, self-management and self-diagnosis tool for patients in rural areas and also as a telemedicine tool. The software prototype is designed in a more user friendly manner. The developed software prototype is designed to work in a PC with windows operating system. Nevertheless the software prototype still needs more improvements in the terms of patient's information and patient's history which are more vital for medical professionals.

@&#CONCLUSIONS@&#
In conclusion, the results indicate that the developed telemedicine software prototype provides valid diagnosis of respiratory pathology with S-transform based statistical features and Extreme learning machine classifier. The overall classification accuracy of KNN classifier with k-value 1 was 94.99%. The overall classification of SVM classifier with RBF kernel was 96.85% and for the ELM classifier with RBF kernel the overall classification accuracy was 98.52%. The time taken to train the model was also less in ELM classifier compared to SVM and KNN classifiers. Based on the classification accuracy and the time taken to train the model ELM classifier was used. The developed tool can be used as a telemedicine tool by patients in rural areas. The developed tool can also be used as a tool to learn auscultation. The prototype can also be used as a self-management tool for patients.Rajkumar Palaniappan, Kenneth Sundaraj, Sebastian Sundaraj implemented algorithms, carried out analysis and drafted the manuscript, N. Huliraj, S.S. Revadi participated in the design of the study, data validation and coordination.