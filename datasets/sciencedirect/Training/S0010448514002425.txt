@&#MAIN-TITLE@&#
Tolerance analysis by polytopes: Taking into account degrees of freedom with cap half-spaces

@&#HIGHLIGHTS@&#
In tolerance analysis, sets of constraints can be compliant with operand polyhedra.These operands are generally unbounded due to the inclusion of degrees of freedom.Cap half-spaces are added to each polyhedron to make it compliant with a polytope.The influence of the cap half-spaces on the topology of polytopes must be controlled.It is necessary to ensure the compliance of a mechanism in terms of requirements.

@&#KEYPHRASES@&#
Tolerance analysis,Degree of freedom,Polyhedron,Polytope,Cap half-spaces,Minkowski sum,

@&#ABSTRACT@&#
To determine the relative position of any two surfaces in a system, one approach is to use operations (Minkowski sum and intersection) on sets of constraints. These constraints are made compliant with half-spaces ofRnwhere each set of half-spaces defines an operand polyhedron. These operands are generally unbounded due to the inclusion of degrees of invariance for surfaces and degrees of freedom for joints defining theoretically unlimited displacements. To solve operations on operands, Minkowski sums in particular, “cap” half-spaces are added to each polyhedron to make it compliant with a polytope which is by definition a bounded polyhedron. The difficulty of this method lies in controlling the influence of these additional half-spaces on the topology of polytopes calculated by sum or intersection. This is necessary to validate the geometric tolerances that ensure the compliance of a mechanical system in terms of functional requirements.(36)P3,4/1,4=P3,4/2,4⊕P2,4/2,0⊕[(P2,0/2,1⊕P2,1/1,1⊕P1,1/1,0)∩(P2,0/2,2⊕P2,2/1,2⊕P1,2/1,0)∩(P2,0/2,3⊕P2,3/1,3⊕P1,3/1,0)]⊕P1,0/1,4hyperplane ofR6negative closed half-space associated toHinR6positive closed half-space associated toHinR6kthcap half-space inR6;Hk¯−thekthnon-cap half-space inR6number of non-cap half-spaces in a polytope ofR6number of cap half-spaces in a polytope ofR6kthnon-cap half-space of polytopei.kthcap half-space of polytopei.normal fan of polytopePinormal fan of the polyhedron containingPi.dual cone associated to vertexvijjthvertex of polytopePi.functional polyhedrondimension of the tolerance zone containing the surfacei,jtranslation at point N alongx-axisrotation alongx-axiscross product of vectorsNiMandr

@&#INTRODUCTION@&#
A first approach to handling geometric tolerancing is generally a parametric approach  [1]. Parametric approaches, especially those used in the various commercial tools, formalize the relative position of any two surfaces of a mechanism at a specific point by a simple relation (linear or non-linear) between parameters of position (translation and/or rotation). This relation is obtained using either an analytical method  [2–5] or a Monte Carlo method  [6]. Several works on this subject are based on TTRS and MGDE concepts  [7]. The GapSpace approach has been proposed to ensure the assembly conditions  [8].This type of approach does not take into consideration the dependencies between the limits of rotation parameter and translation parameter. Nor does it support the redundancy of suppressing degrees of freedom (hyperstatism) between two parts.A solution to address these limitations is to introduce sets of constraints  [9–15]. These sets of constraints define the boundaries of relative displacements between two surfaces of the same part (geometric constraints) and boundaries of relative displacements between two surfaces of two separate parts, but which are potentially in contact (contact constraints). In general the sets of constraints manipulated by clearance space are not linear  [11]. This article focus on the approach by constraints and more precisely on bounded sets of constraints made up of linear constraints  [12].Sets of geometric and contact constraints are generally operand sets which can be made compliant with finite sets of half-spaces ofRn[12]. The boundaries of relative displacements between two surfaces result from the intersection of the half-spaces ofRnof an operand set, defining an operand polyhedron. A polyhedron is not usually bounded, due to the degree of invariance of a surface or to the degree of freedom of joints defining theoretically unlimited displacements  [16,17].The relative position between any two surfaces of a mechanism is determined by operations on these operand polyhedrons (Minkowski sum and intersection),  [17–19]. To solve these operations, and in particular the Minkowski sums inRn, one method is to delimit the intersection of the half-spaces of an operand set and thus transform a polyhedron ofRninto a polytope ofRn, as a polytope ofRnis a bounded polyhedron ofRn[20]. This method is justified by the algorithmic complexity of summing polyhedra ofRn, requiring the development of algorithms to compute tolerance analysis of the Minkowski sums of polytopes  [21–23].The main contribution of this article is to introduce the concept of “cap” half-spaces to bound operand polyhedra. They are added to the operand set and in this way determining the relative position of two surfaces of a mechanical systems is based solely on operations on operand polytopes generating a calculated polytope  [24].By checking that a calculated polytope is included within a functional polytope the conformity of a mechanical system can be simulated with respect to a functional requirement  [12], see Fig. 1.The addition of cap half-spaces to the operand sets will affect the topology of a calculated polytope. Hence it has to be possible to differentiate among all the facets of a calculated polytope between those that are generated by the cap half-spaces and the others generated by half-spaces that derive from geometric and contact constraints. This is essential in order to validate the geometric tolerances that ensure that a mechanical system is compliant in relation to a functional requirement.This article describes how to identify the facets generated by the cap half-spaces of a polytope resulting from a Minkowski sum or an intersection between two operand polytopes.In the following, we limit ourselves to 6-dimension polyhedra and polytopes: the half-spaces arising from the geometric and contact constraints are linear inequalities in six variables: three rotation variables and three translation variables  [24].In the first part, some properties of polyhedra and polytopes are considered; the second part looks at determining the cap half-spaces which set boundaries to the half-space intersections resulting from geometric and contact constraints.The third part deals with the two methods of identifying the dependent facets of cap half-spaces in a summation and an intersection respectively. An example of an application of tolerance analysis illustrating these two methods is described at the end of the article.For the application used as an example, we put forward the following physical hypotheses:•no form defect in the real surfaces,no local strain in surfaces in contact,no deformable parts.We first set out some definitions and properties of polyhedra and polytopes to ensure a proper understanding of the rest of the article. These are taken from  [20].A hyperplane is an affine subspace of dimension 0, 1, 2 or(n−1)inRncalled point, line, plane and hyperplane respectively. A hyperplane of dimension(n−1)is denoted a(n−1)-hyperplane.Let us considerHa hyperplane in someRn:a1x1+⋯+aixi+⋯+anxn=b.(1)H={x∈Rn:aTx=b}withaT=(a1,…,an)∈Rn,x=(x1,…,xn)T∈Rnandb∈R.For each hyperplaneHwe define the positive closed half-spaceH¯+by:(2)H¯+={x∈Rn:aTx=a1x1+⋯+aixi+⋯+anxn≥b}and the negative closed oneH¯−similarly:(3)H¯−={x∈Rn:aTx=a1x1+⋯+aixi+⋯+anxn≤b}In the following any manipulated constraint will be written in terms ofH¯−denoted simply:(4)H¯−={x∈Rn:aTx≤b}.A polyhedronPis the intersection of a finite number of closed half-spaces ofRn. We define:(5)P=⋂i=1mHi¯−={x∈Rn:aiTx≤bii=1,…,m}={x∈Rn:Ax≤b},A∈Rm×nwhereaiTis theithline ofAandbitheithcomponent ofb.This definition characterizes theH−description ofP, see Fig. 2(a),  [20,25] and  [26].A hyperplaneHis said to be a support hyperplane for polyhedronPif and only if:(6)P∩H≠0̸andP⊂H¯−.A faceFofPis the intersection of the polyhedronPwith one of its support hyperplanes. The faces of ad-polyhedronPare convex sub-sets of dimensionk,0≤k≤d−1.A face of dimensionkis calledk-face. A 0-face is a vertex, a 1-face is an edge and a(d−1)-face is a facet ofP.If the polyhedronPis bounded, it is called a polytope. A polytope of dimensiondis denotedd-polytope inRn(n≥d), see Fig. 2(b).By duality, a polytopePcan be defined by the convex hull of a finite number of points ofRn.Let us considerVa finite set of points ofRn:(7)P=conv(V).Definition (7) is theV-description ofP[9] and   [26].Hence a polytope can be defined by its vertices.In this article we consider only convex polyhedra and convex polytopes, which we call simply polyhedra and polytopes.Associated to each vertexvof polytopeP, is a primal cone and a dual cone such that:•the primal cone consists of the set ofp-faces of the polytope derived from this vertex withp=0to dim(P) (see Fig. 2(c)),the dual (or normal) cone is constructed such that eachp-face of the primal cone is normal to a (dim(P)-p)-face of the dual cone•each non-empty face of a cone ofFis also a cone ofF,the intersection of two cones ofFis a face common to the two cones.IfC1,C2,…,Ckare the dual cones of a polytopeP, thenFis the normal fan of polytopePdenotedN(P).Fig. 2(d) and (e) illustrate the normal fans for a polyhedron and a polytope respectively.The common refinement of two fans is defined by the intersection of pairs of cones from the two families  [25]:(8)F1∧F2={C1∩C2:C1∈F1,C2∈F2}.Whatever manufacturing processes are employed, and whatever materials are used, a manufactured part is never geometrically perfect. The geometric features of a manufactured part will never be exactly the same as the nominal characteristics of which they are a specific physical realization. Generally, variations in production processes generate geometric deviations from a geometric model produced by a Computer Assisted Design tool (CAD). These deviations, also called defects, may compromise the expected performance of a mechanical system. Tolerancing sets an acceptable range of deviation using geometric specifications while still guaranteeing that the mechanical system will function as required. These limits are mainly given in the form of tolerance zones, or zones within which the surfaces being produced must be included.In mathematical terms, the displacement limits for a surface in a tolerance zone are defined by a set of geometric constraints. A tolerance zone is defined by its dimensiontand two deviationsdinfanddsup(dsup−dinf=twithdinf≤dsup)which position is in relation to the nominal surfaceS0. Each real surface is modeled by a substitution surface (i.e. one which is perfect) withS1representing a specific physical representation of the nominal surfaceS0(see Fig. 3). If|dinf|=|dsup|=t2, the nominal surface is combined with the median surface of the tolerance zone.The set of geometric constraints is defined in the following equation  [12]:(9)S1⊆ZT⇔∀Ni∈S0:dinf≤tNi.ni≤dsupwheretNiis the translation displacement ofS1in relation toS0at pointNi,niis the unit outward pointing vector normal to the surfaceS0inNi.By discretizing the surfaceS0intonpointsNigivesnEq. (9) with1≤i≤n.Using small displacement torsors, Eq. (10) can be written for every pointMof the Euclidean space  [27]:(10)tNi=tM+NiM×rwhere:r: rotation vector ofS1in relation toS0,tM: translation vector ofS1in relation toS0at pointM.Developing Eq. (10) gives (11):(11)tNi.ni=(tM+NiM×r).ni=ni.tM+(MNi×ni).r=(MNi×nini)T(rtM).We define the components of the following vectors in an(x,y,z)base:tM(tM–xtM–ytM–z),Ni(xiyizi),M(xMyMzM),ni(nixniyniz)andr(rxryrz).Thus Eq. (11) can be written in the(x,y,z)base in accordance with (12):(12)tNi.ni=(MNi×ni).r+ni.tM=(niz(yi−yM)−niy(zi−zM)nix(zi−zM)−niz(xi−xM)niy(xi−xM)−nix(yi−yM)nixniyniz)T(rxryrztM-xtM-ytM-z)=aiTx.We propose:A′=(MN1×n1⋯MNi×ni⋯MNn×nnn1⋯ni⋯nn)T=(a1⋯ai⋯an)T∈Rn×6,A″=−A′,x=(rtM)∈R6,(13)b′=(dsup)n∈Rnandb″=(−dinf)n∈Rn.Finally, Eq. (9) definingngeometric constraints can be written in accordance with (14) from (12) and (13):(14)S1⊆ZT⇔tNi.ni≤dsupand−tNi.ni≤−dinf⇔A′x≤b′andA″x≤b″⇔Ax≤bwithA=(A′A″)andb=(b′b″).Using Eq. (14), it is possible to make Eq. (9) compliant as anH-description of a polyhedronPofR6[20]. It defines2nhalf-spacesHk¯−with1≤k≤2n. The intersection of the2nhalf-spacesHk¯−defines a polyhedronPofR6.(15)P={x∈R6:A′x≤b′,A″x≤b″}=(⋂k=1k=nHk′¯−)∩(⋂k=1k=nHk″¯−)={x∈R6:Ax≤b}=⋂k=1k=2.nHk¯−.Let us consider the example of Fig. 4(a) which shows the definition of an ISO specification for the location of a plane surface. This location implies that any manufactured surfaceS1, a specific physical realization of the nominal square plane surfaceS0with dimensionb, must be located within a tolerance zone defined by two parallel planes att1distance apart: see Fig. 4(b). In the(x,y,z)base, points A, B, C and D, vertices of the square(b×b), have the following respective coordinates:(−b2b20),(b2b20),(b2−b20)and(−b2−b20).The geometric constraints inherent in the location ofS1are defined by eight half-spaces as in Eq. (15)   [12]:(16)P={x=(rx,ry,rz,tN-x,tN-y,tN-z)T,Ax≤b}with:A=(b/2b/20001b/2−b/20001−b/2b/20001−b/2−b/20001−b/2−b/2000−1−b/2b/2000−1b/2−b/2000−1b/2b/2000−1)∈R8×6and,b=(t12)8∈R8.The intersection of the eight half-spaces, expressed at the center N of the square(ABCD)with surfaceS0and generated by this location specification, generates a 3-dimension polytope in the affine space constructed on the(rx,ry,tN-z)base, see Fig. 4(c).If the contour line is not rectangular, we proceed to its discretization. If the surface is not a plane, a mesh of the surface is generated and the constraints are written for the mesh nodes.For the location tolerance of the axis of a cylinder, the two extremities are considered; the constraints are written for these points.The constraints could be defined for a given direction (case of a tolerance zone made up of 2 parallel planes) or for discretized directions (case of a cylindrical zone).One can generalize the writing of the constraints for any toleranced curve by discretization.Like the geometric constraints described in 3.1, non-interferences by surfaces potentially in contact are characterized by contact constraints. Definition (9) can be specialized by writing:(17)∀Ni∈Ec:dinf≤tNi.ni≤dsupwith:•Ec: contact element (see Fig. 5) which may be along a surface, a line or defined by a point,tNi: translation displacement at pointNiof surface 1 in relation to surface 2 between two parts potentially in contact,ni: unit vector normal to a plane tangent to the two surfaces at pointNi, oriented towards the outer material in relation to surface 2,dinfanddsupare defined according to the type of contact:dinf=−J2anddsup=+J2in cases where the joints are in bilateral contact (generally the case with a cylindrical pair, ball-and-cylinder pair, spherical pair), whereJ(J=dimension of hole - dimension of shaft) is clearance in the joint, the definition ofJis compliant with that given in the ISO standard  [28].A contact element is the element consisting of all possible points of contact between two surfaces. It derives from the intersection of two surfaces potentially in contact in the specific configuration where the two surfaces merge and there is no clearance.For example, the contact element of a cylindrical pair joint is a cylinder. This cylinder is the intersection of two cylinders that are coaxial and have the same diameter. Fig. 5 shows the contact elements for planar pair and cylindrical pair joints (surface contact elements), cylinder-and-plane pair and ball-and-cylinder pair joints (line contact element), and ball-and-plane pair joint (punctual contact element). This non-exhaustive list gives the main types of joint used in tolerance analysis.As for geometric constraints, pointsNiare obtained by discretization of the contact element and in this way, the writing of the contact constraints is generalized.The definition of a contact polyhedronPis similar to that in Eq. (15).In cases of unilateral contact (usually ball-and-plane pair joint, cylinder-and-plane pair or planar pair joints), we have the specific case where:•dinf=0,dsupis not defined.The result is that only equationsdinf≤tNi.nidefined in (14) are generated by the contact constraints. The polyhedron is defined as follows:(18)P={x∈R6:A″x≤b″}=⋂k=1k=nHk″¯−.Generally, the relative position of any two surfaces of a mechanical system derives from the sum and intersection ofR6polyhedra. Due to the algorithmic complexity of Minkowski sums, we chose to manipulate only geometric polytopes and contact polytopes, in other words bounded sets. A geometric polytope is defined as a bounded geometric polyhedron. Similarly, a contact polytope is a bounded contact polyhedron. In the next two sections we show how geometric and contact polyhedra are made compliant with geometric and contact polytopes respectively.Geometric polyhedra defined previously in (15) are not generally bounded as their surfaces usually have degrees of invariance  [7]. The degree of invariance of a surface will hereafter be writtendinv. These polyhedra are therefore notR6polytopes.In this article, we propose to put boundaries on these polyhedra by the addition ofncHck¯−half-spaces, called cap half-spaces, to all the half-spaces resulting from the geometric constraints. The degree of invariance of a surface depends on the class of surface  [7]; it defines a theoretically unlimited displacement which leaves the toleranced surface in the Euclidean space invariant overall. A displacement may have two boundaries, each one characterizing a cap half-space. Thus, two cap half-spaces per degree of invariance are added to the half-spaces defining the polyhedron (see Table 1). Generally inR6, the geometric polytope derived from this addition ofnc=2.dinvcap half-spaces can be defined by the expression:(19)P=(⋂k=1k=2.nHk¯−)∩(⋂k=1k=2.dinvHck¯−)where:dinvis the degree of invariance of the surface.The cap half-spaces are additional half-spaces so that aR6polyhedron can be made compliant with a 6-polytope while still retaining the geometry and the topology of the polyhedron, i.e. the polyhedron faces. This polytope defines:•displacements of the surface inside a tolerance zone,displacements limited by the cap half-spaces that leave the surface invariant overall.Half-spaces identified in Eq. (19) can be written:(20)Hk¯−=akTx≤bk,bk=dsuporbk=−dinfHck¯−=ckTx≤C,C∈]0,+∞[.The second members of the half-spaces correspond to the distances of their respective hyper-planes from the origin of the displacements, see Fig. 6.The second member of a half-space generated by a geometric constraint depends ondsupordinfthat is to say on the dimension of the tolerance zonetand the position of the tolerance zone in relation to the nominal surface, see Fig. 6.The second member of a cap half-spaceHck¯−, identified asC, is a strictly positive value.The cap half-spaces are introduced for the sole purpose of facilitating the calculation of the sums and intersections of the polyhedra (unbounded sets) by transforming them into polytopes (bounded sets). The value ofCmust be large enough to distinguish bounded displacements from unbounded ones, while not affecting the final result. The choice of the value ofCwill be considered in further detail later in the article.Theckcoefficients depend on the classes of the surfaces and the displacements leaving the surfaces invariant overall.A(u,v,w)base is associated to each surface according to the displacement axes, leaving it invariant overall. The cap half-spaces enabling them to be limited are defined on the basis of these axes: see Fig. 7.Let us return to the example in Fig. 4: this shows a plane surface wheredinv=3. InR6,2.dinv=6cap half-spaces at least are required to set boundaries to the intersection of the half-spaces resulting from geometric constraints (15). In a(u,v,w)base linked to the plane surface such thatwis normal to the surface, displacements leaving the surface invariant overall are limited as follows, withC>0and N the point of definition of half-spacesH¯k−:(21){r.w≤CtN.u≤CtN.v≤C,−r.w≤C−tN.u≤C−tN.v≤C.Equations at (21) can be made compliant with 6 cap half-spaces ofR6in the same way as those at (20). We now define the following projections for any(x,y,z)base:(22)u(uxuyuz),v(vxvyvz)andw(wxwywz)the 6 cap half-spaces are then defined such that:(23){rx.wx+ry.wy+rz.wz≤C−rx.wx−ry.wy−rz.wz≤CtN-x.ux+tN-y.uy+tN-z.uz≤C−tN-x.ux−tN-y.uy−tN-z.uz≤CtN-x.vx+tN-y.vy+tN-z.vz≤C−tN-x.vx−tN-y.vy−tN-z.vz≤C.Fig. 8shows the limits of surface displacements in the(rx,ry,tN-x)base where displacement according totN-xis unbounded and the corresponding cap half-spaces.Cap half-spaces are similarly defined for classes of surface: spherical, cylindrical, revolution or prismatic.The contact polyhedra defined above are generally unbounded as the joints have degrees of freedomdmob. Just as the limits of surface displacement in a tolerance zone can be defined, displacement limits for two surfaces potentially in contact can be modeled in the case of bilateral contacts. Cap half-spaces limit the displacements inherent in the degrees of freedom of the joints.The number of cap half-spaces in this case depends on the type of joint (see Table 2).Each degree of freedom defines a theoretically unbounded displacement which is limited by two cap half-spaces. Finally,2.dmobcap half-spaces are added to the half-spaces generated by contact constraints, by analogy with the2.dinvcap half-spaces added to the half-spaces generated by geometric constraints according to (19).In the specific case of joints with unilateral contact, each contact constraint limits displacement in a single direction (18). Contact constraints generate onlynhalf-spaces ofR6instead of2n. In order to set boundaries on the intersection of thesenhalf-spaces,nother constraints are added so as to suppress the unilaterality of the contact. Thesenconstraints formnextra cap half-spaces in addition to themcap half-spaces limiting displacements resulting from the degrees of freedom according to Eq. (24) wheredmobcorresponds to the degree of freedom of the joint:(24)P=(⋂k=1k=nHk″¯−)∩(⋂k=1k=m+nHck¯−)withm=2.dmob.In this case, the polyhedron (18) is defined solely by matrixA″. To suppress the unilaterality of the contact, we propose to addnconstraints identified by matrixA′(dimensionn) opposite to matrixA″. Next, themcap half-spaces are added, according to the degrees of freedom.Just as for the cap half-spaces for the geometric polytopes, the value ofCfor the second members should be selected with care so as not to affect the final result.An operand polytope will then be defined as follows:(25)P=(⋂k=1k=nncHk¯−)∩(⋂k=1k=ncHck¯−)withnnc+nc=2n+mwhereHk¯−is the set ofnnchalf-spaces (ncfor non-cap) resulting from the geometric or contact constraints andHck¯−is the set ofnccap half-spaces. The intersection of thennchalf-spaces defines a polyhedron.We now propose the following properties:Property 1: a j-face of a polytope is described as a non-capj-face if and only if it is included in aj-face of the corresponding polyhedron.Property 2: anyj-face that is not a non-capj-face is cap.For geometric or contact polytopes, the non-cap facets are thus included in the hyper-planesHk, boundaries of the half-spacesHk¯−resulting from the geometric or contact constraints.Fig. 9shows a synthesis of the tolerance analysis procedure by polytopes. From the tolerance zones on the one hand and the joints on the other, the geometric and contact constraints can be written respectively.These constraints usually define unbounded sets, or polyhedra.Cap half-spaces are added to the polyhedra in order to set boundaries and transform them into polytopes. The sums and intersections of these polytopes can then be calculated to simulate geometric variations according to the structure of the mechanism by a resulting polytope. From this, the boundaries of the functional defects of the mechanism can be identified and we are thus able to determine whether the limits set out in the specifications are respected.The next paragraph describes the methods used to differentiate among all the facets of a polytope resulting from a sum or an intersection, those facets that are generated by cap half-spaces from the others.Let us define polytopeP3resulting from the Minkowski sum of two polytopesP1andP2ofRnas follows:(26)P3=P1⊕P2={p1+p2|p1∈P1,p2∈P2}.We shall try to define the faces of polytopeP3which are independent from the cap half-spaces of operandsP1andP2by manipulating the polytopes using a double description (i.e. by theirV-description and theirH-description).Fukuda has shown that every face of the sumP3of twon-polytopesP1andP2can be decomposed in only one way into the sum of two faces of operandsP1andP2[26].Let us propose the following:Property 3:the faces ofP3resulting from the sum of two non-cap faces ofP1andP2are the non-cap faces ofP3. All the other faces ofP3are called cap faces.Fig. 10shows a classic example of the Minkowski sum of two polytopesP1andP2inR2in geometric tolerancing. PolytopeP1is made up of four non-cap facetse11,e12,e13ande14(solid line in Fig. 10). PolytopeP2is made up of two non-cap facetse21ande23(solid line in Fig. 10) and two cap facetse22ande24(dotted line in Fig. 10).All the vertices ofP1are non-cap whereas all the vertices ofP2are cap. In fact, polytopeP1is identical to the corresponding polyhedron and the vertices ofP1are therefore vertices of the polyhedron, and hence are non-cap, according to 1 given in Section  3.4. The vertices ofP2do not exist on the corresponding polyhedron: they are therefore cap, according to properties 1 and 2 given in Section  3.4.We will now consider two examples of sums of faces (edges or vertices) in this example. The first is the sum of the two non-cap edgese12ande23. The result is edgee33ofP3where:e33=e12⊕e23.e33is a non-cap edge according to property 3, see Fig. 10.The second example is the Minkowski sum of a non-cap edgee11ofP1and a cap vertexv2aofP1andP2respectively. The result is a cap edgee31ofP3wheree31=e11⊕v2a.e31is a cap edge according to property 3, see Fig. 10.The second example shows that a non-cap facet of an operand polytope can be translated into a cap facet in the polytope sum. In other words, a cap facet in the first operand can modify the attribute (from non-cap to cap) of a facet in the polytope sum, as a result of the translation of a facet from the second operand.InR6, the algorithmic application of the property posited by Fukuda in  [26] requires all thed-faces(0≤d≤5)of operandsP1andP2to be determined in order to identify all the cap facets inP3. This is very complex to implement with dimensions greater than 3 and is prohibitive in terms of algorithmic complexity and hence in calculation time.For this reason we decided to manipulate the polytopes by theirV-description and theirH-description, i.e. with a double description  [12,22]. This guarantees the traceability of the specifications in operations used in geometric tolerancing  [22], however it is then difficult to distinguish cap faces and non-cap faces since property 3 cannot be applied.The method proposed here uses the normal fans of operand polytopes and the normal fans of associated operand polyhedra. To show how cap faces can be identified through normal fans, we first describe the basis of the algorithm used to determine the Minkowski sum of polytopes.The topology of polytopeP3=P1+P2is defined by its normal fanN(P3)resulting from a common refinement of the normal fans of operand polytopes  [25]:(27)N(P3)=N(P1)∧N(P2).Determining the common refinement of two fansN(P1)andN(P2)involves calculating the union of all the intersections of the polyhedric cones of fansN(P1)andN(P2)taken two by two   [20].PolytopeP1is characterized by its verticesv1iwherev1iis theithvertex ofP1.Similarly:•P2is characterized by its verticesv2jwherev2jis thejthvertex ofP2,P3is characterized by its verticesv3kwherev3kis thekthvertex ofP3.We have shown in  [22] the property (28) inRn:(28)dim(DualCone(v1i)∩DualCone(v2j))=n⇒v1i+v2j=v3k.DualCone(v1i)∩DualCone(v2j)=DualCone(v3k)where  the  edges  of  DualCone(v3k)are  normal  to  the facets  ofP3that  converge  atv3kEqs. (26) and (27) can be generalized to polyhedra. IfP1andP2are polyhedra,P3is also a polyhedron; the normal fansNR(P1),NR(P2)andNR(P3)are not complete, i.e. they do not partitionRn. The normal fan of a polyhedron is a regular Gröbner fan  [29,30].In general,N(P1)designates the normal fan of polytopeP1andNR(P1)designates the normal fan of the polyhedron containingP1.To identify cap and non-cap facets, we define the following property:Property 4:The normals of the non-cap facets ofP3are the result of the common refinement of the normal fansNR(P1)andNR(P2)of the corresponding operand polyhedra.Fig. 11(a) shows the normal fanN(P3)of polytopeP3, resulting from the common refinement of fansN(P1)andN(P2). The edges of the dual cones that make upN(P3)are the normal of the facets ofP3: see Fig. 10 and Fig. 11(a).Note:the normal fans shown are normalized normal fans, in other words, they are intersected with the unit sphere  [31].Fig. 11(b) shows the normal fanNR(P3), common refinement of the normal fansNR(P1)andNR(P2)of the polyhedra associated withP1andP2respectively. The polyhedron associated withP1results from the intersection of the half-spaces definingP1without its cap half-spaces. Likewise for the polyhedron associated withP2.In the example in Fig. 10, the polyhedron associated withP1and polytopeP1are identical, sinceP1has no cap half-spaces. The same is true for their normal fans. The normal fanNR(P2)of the polyhedron associated withP2is reduced to two rays (two 1 dimension cones). Similarly for the common refinementNR(P1)∧NR(P2).The edges of the normal fanNR(P3)are normals of the facets of the polyhedron Minkowski sum of the polyhedra associated withP1andP2respectively.From this we deduce that the normals of the non-cap facets ofP3correspond to the edges ofN(P3)which are common to the edges ofNR(P3), i.e. edgese33ande36, see Fig. 10 and Fig. 11(b).The non-cap vertices ofP3are easy to identify.From Eq. (28) and property 1 taken from the work of Fukuda  [26], we can deduce Eqs. (29) and (30):(29)ifv1iandv2jare  non-cap  vertices,dim(DualCone(v1i)∩DualCone(v2j))=n⇒v1i+v2j=v3kwherev3kis  a  non-cap  vertex(30)ifv1iorv2jis  a  cap  vertex,dim(DualCone(v1i)∩DualCone(v2j))=n⇒v1i+v2j=v3kwherev3kis  a  cap  vertex .The intersection of two operand polytopesP1andP2is defined as the intersection of the set of half-spaces from theH-descriptions of the two operands:(31)P1∩P2=(⋂k=1k=n1H1,k¯−)∩(⋂k=1k=n2H2,k¯−)withP1=⋂k=1k=n1H1,k¯−andP2=⋂k=1k=n2H2,k¯−.According to definition (25), we have:(32)Pi=(⋂k=1k=nnciHi,k¯−)∩(⋂k=1k=nciHci,k¯−)withnnci+nci=niwhere:nnciis the number of non-cap half-spaces denotedHi,k¯−andnciis the number of cap half-spaces denotedHci,k¯−.In geometric tolerancing, we need to determine the intersection of the displacements defined by the geometric and/or contact constraints. This intersection derives from the intersection of the non-cap half-spaces of operandsP1andP2, i.e. polyhedraP1(R)andP2(R)containingP1andP2respectively, see Fig. 12(a). In order to make this intersection compliant with a polytopeP3(i.e. a bounded set), a set of non-cap half-spaces must be added, see Fig. 12(b). PolytopeP3is defined by Eq. (33) in accordance with (25):(33)P3=(⋂k=1k=nnc1H1,k¯−)∩(⋂k=1k=nnc2H2,k¯−)∩(⋂k=1k=nc3Hc3,k¯−)whereHc3,k¯−denotes a cap half-space ofP3.It is no easy matter to determine cap half-spacesHc3,k¯−. The topology of polytopeP1∩P2depends on the choice of second memberCof the cap half-spaces of the operandsP1andP2.Thus as a general rule:P3≠P1∩P2, see Fig. 12(c).In the next section we propose a method to truncate a hyper-parallelepiped, to determine displacements limited by the non-cap half-spaces resulting from the intersection of two operand polytopes.One method to determineP3consists of determining the intersection between:•a right hyper-parallelepiped circumscribed at the union of the vertices ofP1andP2,the non-cap half-spaces of operandsP1andP2.The facets of polytopeP3where the hyper-planes contain the facets of the right hyper-parallelepiped are the cap facets ofP3, which can be used to define(⋂k=1k=nc3Hc3,k¯−)introduced into Eq. (33). All the other facets are non-cap. In addition, all the vertices ofP3located on a hyper-plane containing one of the facets of the initial right hyper-parallelepiped are cap vertices. All the other vertices are non-cap.Fig. 13(a) shows the determination of a circumscribed right hyper-parallelepiped (a rectangle in this example) at the union of the vertices ofP1andP2.The circumscribed right hyper-parallelepiped must not be a minimal volume. If this were the case, then this may result in a hyper-parallelepiped of which one facet might be confused with a facet ofP1orP2. It would then not be possible to detect whether such a facet is cap or non-cap.To avoid this, a right circumscribed hyper-parallelepiped is determined at an intervaldfrom the minimal volume circumscribed right hyper-parallelepiped, whered>0: Fig. 13(a).Fig. 13(b) shows polytopeP3resulting from the intersection between a circumscribed right hyper-parallelepiped with verticesP1andP2and the non-cap half-spaces of operandsP1andP2.We shall now apply the methods for identifying cap half-spaces in the sums and intersections of polytopes using a simulation to ensure that a functional condition is fulfilled in a simple mechanical system, illustrated in Fig. 14. This system is made up of three parts: support 1, bearing 2 and shaft 3. No degree of mobility is allowed between support 1 and bearing 2. Two degrees of mobility are allowed between the shaft 3 and the bearing 2: rotation and translation alongx.A functional condition FC is defined across the distancedbetween point M of the shaft 3 and the support 1:(34)dmin≤d≤dmax.Consideringd0the nominal value ofd,dev,devinfanddevsupsuch that:dev=d−d0devinf=dmin−d0devsup=dmax−d0.The equation can still be written:(35)devinf≤dev≤devsup.The variabledevis the deviation in translation alongyof point M on shaft 3 in relation to support 1, with a lower bound ofdevinfand an upper bound ofdevsup.The purpose of this application is to simulate the compliance of the mechanical system in terms of the functional condition FC, given the geometric variations assigned to parts 1, 2 and 3.This example will be considered in the normal planezcontaining point M. Thus each displacement will be defined by three parameters: rotation alongz, translation alongxand translation alongy. The polytopes manipulated will be 3 dimension and can be represented graphically.Parts 1, 2 and 3 are made up solely of plane and cylindrical surfaces.We write the surface j of part i as i, j.Surfaces 2, 4 and 3, 4 are cylindrical; surfaces 1, 1; 1, 2; 1, 3; 1, 4; 2, 1; 2, 2 and 2, 3 are plane surfaces, see Fig. 15.The topological structure of the mechanical system is set out in a graph  [32], see Fig. 15.For each surface i, j there is a corresponding vertexi,jon the graph. Vertices 1, 0; 2, 0 and 3, 0 correspond to nominal models of parts 1, 2 and 3 respectively: see Fig. 15.An edge connected to a vertex designatedi, 0 (i=1, 2 or 3) corresponds to position deviations of a surface i, j in relation to its nominal position.A geometric polytope is associated to each edge connected to a vertex designatedi, 0 (i=1, 2 or 3). This polytope characterizes the variations in position of a surface i, j in relation to its nominal surface inside a tolerance zone of dimensionti,j.For a plane surfacei,j,ti,jis the distance between two parallel planes arranged symmetrically in relation to a nominal plane as shown in Fig. 4.For a cylindrical surface,ti,jis the diameter of a coaxial cylinder with the axis of the corresponding nominal cylinder.Parts 1, 2 and 3 are positioned according to four contact specifications  [33] so that:•contact between surfaces 1, 1 and 2, 1 is “unilateral”, planar pair type, contact element normal planey, nature of contact is sliding (i.e. clearanceJ1between 1, 1 and 2, 1 is null).The two contacts between surfaces 1, 2 / 2, 2 and 1, 3 / 2, 3 respectively are unilateral, cylinder-and-plane pair type, contact element is a straight line parallel tozcontained within a normal planex, nature of contact: floating.contact between 3, 4 and 2, 4 is bilateral, cylindrical pair type, contact element is a cylinder with director vectorx, nature of contact is floating (clearanceJ4between 2, 4 and 3, 4 is such that:J4=D2,4−D3,4withJ4>0).An edge between two surfaces of two distinct parts corresponds to the position deviations between two surfaces potentially in contact.A contact polytope is associated to each edge connected between two surfaces of two distinct parts. The four contact polytopes of the system studied here derive from the four contact specifications formulated above; they will be described in more detail in the following section.Finally, an additional edge, labeled FC defines the functional condition between surfaces 3, 4 and 1, 4. A “functional polyhedron” is associated to this edge, derived from the functional constraints defined in Eq. (35).The different points (I, J, L, M, N …) marked in Fig. 16define the geometric constraints, contact constraints and cap half-spaces needed to characterize operand polytopes.Table 3summarizes the definition of geometric polytopes associated to the respective surfaces identified in Fig. 15, and according to the procedure described in Section  3.3.1.For geometric polytopes associated to surfaces 2, 2 and 2, 3 respectively, we considerL4=L5, see Fig. 16.We designate asPi,j/i,0the geometric polytope characterizing position variations between surface i, j and its nominal model i,0. Table 4summarizes the definition of contact polytopes associated respectively to the four contact specifications of the system studied, according to the procedure described in Section  3.3.2.We designate asPi,j/u,vthe contact polytope characterizing the position variations between surface i, j and surfaceu,v.Because of the topological structure of the graph it is possible to define the operations required between operand polytopes to determine polytopeP3,4/1,4characterizing variations in position between surfaces 3, 4 and 1, 4  [12,24].PolytopeP3,4/1,4is defined by the equation given in Box I.For easier writing and in accordance with the method described in Section  5, the operator∩designates an operation to determine the intersection between:•a circumscribed right hyper-parallelepiped at the union of the operand vertices,the non-cap half-spaces of the operand polytopes.The compliance of the mechanical system is validated by including the calculated polytopeP3,4/1,4in the functional polyhedronP3,4/1,4faccording to the resultant of the FC condition defined in:(37)P3,4/1,4⊆P3,4/1,4f.The equation can be written as:(38)P3,4/1,4=P3,4/2,4⊕P2,4/2,0⊕P1,0/1,1⊕(P1∩P2∩P3)with:P1=P2,0/2,1⊕P2,1/1,1⊕P1,1/1,0P2=P2,0/2,2⊕P2,2/1,2⊕P1,2/1,0P3=P2,0/2,3⊕P2,3/1,3⊕P1,3/1,0.Firstly, polytopesP1,P2andP3are determined by applying the method described in Section  4. PolytopesP2∩P3andP1∩P2∩P3are then determined using the method described in Section  5. Lastly, polytopeP3,4/1,4is deduced fromP1∩P2∩P3and other operands by applying the method in Section  4.To simplify the graphs, the following points have been considered:•the dimensions of the tolerance zonesti,jare all equal one with another, withti,j>0,clearanceJ4is such that:J4=ti,j.•facets shown in shaded mode are non-cap facets,facets shown in wireframe mode are cap facets.PolytopesP1,1/1,0andP2,1/2,0are identical and their center of symmetry is the origin of the displacements; only facets orthogonal to directiontM−xare cap facets: see Table 3. PolytopeP2,1/1,1may be considered as a polytope reduced to a single vertex corresponding to the origin of the displacements, given the contact constraints defined in Table 3. Definitions of geometric polytopes.Fig. 17(a) shows the determining of polytopeP1(P1=P2,0/2,1⊕P2,1/1,1⊕P1,1/1,0) inR3whereP2,1/1,1, a neutral element of the Minkowski sum, is not shown. Fig. 17(b) shows a projection of polytopeP1inR2, in the plane(rz,tM−y). In this example, the topology of polytopeP1is identical to the topologies ofP1,1/1,0andP2,1/2,0given that the Minkowski sum between two isometric polytopes resembles a homothety coefficient of 2  [20]. Only the facets ofP1orthogonal to directiontM−xare cap facets.PolytopesP1,2/1,0andP2,2/2,0are identical and their center of symmetry is the origin of the displacements, see Table 3. The non-cap facets ofP1,2/1,0andP2,2/2,0are those which are orthogonal to directiontM−y.PolytopeP2,2/1,2is not centered at the origin of the displacements and has only one non-cap facet corresponding to its only contact constraint, see Table 3.By applying the method developed in Section  4, we can deduce polytopeP2(withP2=P2,0/2,2⊕P2,2/1,2⊕P1,2/1,0) shown inR3in Fig. 18(a).Fig. 18(b) shows a projection of polytopeP2inR2, in the plane(rz,tM−y).PolytopeP2has only one non-cap facet resulting from the only non-cap facet of contact polytopeP2,2/1,2.Similarly, Fig. 19(a) shows the determination ofP3(P3=P2,0/2,3⊕P2,3/1,3⊕P1,3/1,0)inR3and Fig. 19(b) shows a projection ofP3inR2, in the plane(rz,tM−y).We shall apply the method described in Section  5 to determineP2∩P3.Let us define a circumscribed right parallelepiped at the union of the vertices ofP2andP3: see Fig. 20.The intersection of this parallelepiped with the non-cap half-spaces ofP2andP3generatesP2∩P3: see Fig. 20.This example shows that ifP2∩P3is calculated with a conventional intersection algorithm, the result will be different and will not correspond to the expected result in a tolerance analysis problem.The determination ofP1∩(P2∩P3)is an unusual case, where the intersection of the non-cap half-spaces of the operands generates a bounded set. The resulting polytope contains no cap half-spaces, see Fig. 21.In this case, the intersection of a circumscribed right hyper-parallelepiped at the union of the vertices of operandsP1and(P2∩P3)with the non-cap half-spaces of these operands gives the same result as the intersection of the non-cap half-spaces: see Fig. 21.Determination ofP3,4/1,4is shown in Fig. 22. Note that polytopesP3,4/2,4andP2,4/2,0are identical ast2,4=J4according to the hypotheses put forward at the beginning of Section  6.3. All the operand polytopes(P3,4/2,4,P2,4/2,0,P1,0/1,1,P1,P2andP3)and hence polytopeP3,4/1,4are centered at the origin of the displacements.By applying the method described in Section  4 it can be seen that polytopeP3,4/1,4is made up of two cap polyhedra shown in wireframe in Fig. 22. This means that it is not possible to control geometric variations at point M in translation along directionxbetween surfaces 3, 4 and 1, 4.This specific feature is due to:•the mobility in translation alongxbetween parts 3 and 1,the displacements in translation alongxleaving surfaces 3, 4 and 1, 4 invariant.Fig. 23shows a calculated polytopeP3,4/1,4included in the functional polyhedron defined in Eq. (35). Using the descriptors “cap” and “non-cap” for the vertices and facets of polytopes in operations applied here it is clear that this inclusion does not depend on cap half-spaces. From this we deduce that the position variations at point M in translation alongybetween surfaces 3, 4 and 1, 4 can be controlled. As a result, the functional condition FC defined in Eq. (35) is respected.In this example, the operand polytopes have been computed with the following numerical values:ti,j=J4=0.1mm ,L1=150mm ,L2=80mm .The extreme displacementseminandemaxat point M in translation alongy-axis(tM−y)are equal to −0.758 mm and+0.758 mm respectively.The mechanical system is compliant with the functional condition FC defined by (35) if:(39)devinf≤emindevsup≥emax.The extreme displacementseminandemaxobtained by a classical 1d stack-up are equal to −0.25 mm and+0.25 mm respectively.The difference between the results (0.508 mm) is due to the rotation effects.In the first part of this article, we showed how geometric constraints characterizing the displacements of a surface within a tolerance zone can be made compliant with a geometric polyhedron. In the same way, contact constraints characterizing relative displacements between two surfaces potentially in contact can be made compliant with a contact polyhedron. Cap half-spaces were introduced to be able to delimit geometric polyhedra to transform them into geometric polytopes. These cap half-spaces limit the unbounded displacements of a surface within a tolerance zone. In the same way, contact polyhedra were delimited by cap half-spaces to give contact polytopes. These half-spaces limit the unbounded displacements between two surfaces potentially in contact.Thus the relative position of any two surfaces of a mechanical system can be formalized by operations, Minkowski sum and intersection, on operand polytopes ofR6. The reason for using cap half-spaces to delimit polyhedra so they become polytopes is related to the algorithmic complexity of Minkowski sums of polyhedra ofRn.In the second part the mechanisms to identify the cap half-spaces of a Minkowski sum and an intersection were described. The influence of cap half-spaces on the topology of a polytope obtained by summation or intersection is paramount to validate the compliance of a mechanical system in terms of a functional requirement.The third part demonstrated how operations on polytopes are carried out to simulate compliance of a simple mechanism in terms of a functional condition.Although the sample application is treated as a plane problem where only polytopes ofR3could be handled, the mechanisms to identify cap half-spaces in the sums and intersections can be used inR6with no restrictions.A prototype of tolerance analysis software is currently being developed based on the concepts of algorithmic geometry presented in this article. With this tool it will be possible to calculate the sums and intersections of polytopes ofR6and ensure that cap half-spaces are identified. In future it should be possible to use this tool to experiment on complex mechanical systems.If the calculated polytope is not included in the functional polyhedron, or does not fill the functional polyhedron, the values of the tolerances and clearances have to be optimized.Using the tool presented here it will be possible to determine the contributing constraints from the operands on the critical vertices of the resultant polytope. It is hoped to extend this work in future and develop the tolerance allocation from knowledge of the contributing constraints

@&#CONCLUSIONS@&#
