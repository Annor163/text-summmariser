@&#MAIN-TITLE@&#
Fuzzy logic in the gravitational search algorithm enhanced using fuzzy logic with dynamic alpha parameter value adaptation for the optimization of modular neural networks in echocardiogram recognition

@&#HIGHLIGHTS@&#
Approach for the optimization of modular neural networks with the gravitational search algorithm using fuzzy logic for pattern recognition.The proposed method is applied for the recognition of medical images.In this case, we are using a database of echocardiograms that contains images of disease and healthy patients to test the approach.

@&#KEYPHRASES@&#
Modular neural network,Gravitational search algorithm,Pattern recognition,Echocardiograms,GSA,Fuzzy logic,

@&#ABSTRACT@&#
In this paper the main goal is to find the optimal architecture of modular neural networks, which means finding out the optimal number of modules, layers and nodes of the neural network. The fuzzy gravitational search algorithm with dynamic parameter adaptation is used for optimizing the modular neural network in a particular pattern recognition application. The proposed method is applied to medical images in echocardiogram recognition. One of the most common methods for detection and analysis of diseases in the human body, by physicians and specialists, is the use of medical images. Simulation results of the proposed approach in echocardiogram recognition show the advantages of using the fuzzy gravitational search in the optimization of modular neural networks. In this case the proposed approach provides a very good 99.49% echocardiogram recognition rate.

@&#INTRODUCTION@&#
In recent years, the interest in algorithms inspired by natural phenomena has grown considerably. It has been shown by many researchers that these algorithms are well suited to solve complex problems. For example genetic algorithms (GAs) are inspired on Darwinian evolutionary theory [33], ant colony optimization (ACO) mimics the behavior of ants foraging for food [13], and particle swarm optimization (PSO) simulates the behavior of flocks of birds [8,19]. In addition, simulated annealing (SA) is designed by use of thermodynamic effects [20], the artificial bee colony algorithm (ABC) is an optimization algorithm based on the intelligent foraging behavior of a honey bee swarms [18]. On the other hand, the bat algorithm (BA) is inspired by the echolocation behavior of microbats [39], etc. In this paper we consider the gravitational search algorithm (GSA), which is a metaheuristic optimization method based on the laws of gravity and mass interactions [26]. There exists different works concerning the gravitational search algorithm, but only the most important and relevant for this paper will be considered [14,24,40]. There also exists a previous proposal of a fuzzy gravitational search algorithm (FGSA), and its application to the optimal design of multimachine power system stabilizers (PSSs). The FGSA based-PSS design is validated for two multimachine systems: a 3-machine 9-bus system and a 10-machine 39-bus. In this case, fuzzy logic is used to speed up the final stages of the process and find the accurate results in a shorter time, even for very large problems. In the proposed GSA the fuzzy-based mechanism and fitness sharing are applied to aid the decision maker to choose the best compromise solution from the Pareto front [42]. However, we have proposed in this work a new and different fuzzy gravitational search algorithm (FGSA) to dynamically change the alpha parameter values and give a different gravitation and acceleration values to each agent in order to improve its performance, which is presented in [29]. This approach is now considered here in this paper to design optimal modular neural networks (MNNs) for pattern recognition, which has not been considered previously in other works.Research in medical imaging has grown considerably in the last years as it is normally a non-invasive diagnosis method. Therefore, we are considering the application of the FGSA method to design the optimal architecture of modular neural networks (MNNs), which means finding out the optimal number of modules, layers and nodes of the neural network designed for echocardiogram recognition. In this case, we are using a database of echocardiograms that contains images of disease and healthy patients. This paper focuses on the field of nature inspired computation and several approaches have been previously proposed for the optimization of modular neural networks [21,22,25,34,36,37]. A modular neural network for medical diagnosis is presented in [12,27], a MNN for pattern recognition is also shown in [16,23], preprocessing and segmentation techniques of medical images are presented in [38,41] and finally some medical applications using echocardiograms are presented in [1,9,11,30].The main problem in these medical applications is that normally there are many speckle noise points on the ultrasound images. So the resulting images are contaminated with this noise that corrodes the borders of the cardiac structures [5]. This characteristic turns difficult to perform image processing, and even more achieving the level of accuracy for pattern recognition needed in these applications. Besides this kind of noise, other factors influence the outcome of ultrasound image recognition. However, the disease recognition problem is complicated by the heart's non-rigid motion. Furthermore, the poor imaging quality of 2D echo videos due to low contrast, speckle noise, and signal dropouts, also cause problems in achieving image interpretation [17].As illustration we show in Fig. 1(right), the image of a heart with cardiac amyloidosis, which is a myocardial disease characterized by extracellular amyloid infiltration throughout the heart. The cardiac amyloidosis has a wide spectrum of clinical manifestations, but the most frequent presentation is heart failure. We also show in Fig. 1 (left) the image of a healthy heart.This paper presents an approach using fuzzy logic in the gravitational search algorithm (FGSA) for optimal architecture design of MNNs. This means finding out the optimal number of layers and nodes of the neural network to recognize if the image corresponds to a person with a heart disease or is an image of a person with a normal heart. The FGSA method was originally applied to 15 benchmark mathematical functions in [29] and now it is applied in pattern recognition using MNNs. In this paper, as a difference to other papers in echocardiogram recognition, which use an active shape model (ASM) to model shape and texture information in an echo frame, we use modular neural networks to directly perform this same task. The motion information derived by tracking ASMs through a heart cycle is then projected into the Eigen-motion feature space of the viewpoint class for matching [7].The rest of the paper describes this approach in detail and is organized as follows. In Section 2, we describe some of the works related to image recognition in echocardiography and basic concepts related to this subject. In Section 3 we describe the modular neural network architecture and the database of echocardiograms for recognition and the pre-processing of the databases that are used. In Section 4 the experimental results are presented. Finally, in Section 5 the conclusions of this work are offered.There are different recent works about echocardiograms [2,32,35], but only the most important and relevant (based on their goals and methodology) for the subject of this paper will be mentioned in this section as related work.As related work we can find the use of modular neural networks for person identification using segmentation and the iris biometric measurement. In this case the modular neural network architecture is used as a system for identifying persons based on the human iris. In this system, the human iris database is enhanced with image processing methods, and the coordinates of the center and radius of the iris are obtained to make a cut of the area of interest by removing the noise around the iris [16].Shahram et al. proposed an approach for the automatic identification of the views of the heart from the content of echocardiogram videos. In this approach the structure of the heart is represented by the combination of its parts (chambers) under the different views. The statistical variations of the parts in the constellation and their spatial relationships are modeled using Markov Random Fields models [28].Jacob et al. [3] proposed a shape-space-based approach for tracking myocardial borders and quantifying regional the left-ventricular function applied in echocardiography. They present a new semi-automatic method for quantifying the regional heart function from two-dimensional echocardiography.Sugioka et al. [31] proposed a method based on patterns to detect cardiac structures using active contours in echocardiographic images.Comaniciu [10] proposed a methodology for tracking cardiac edges in echocardiographic images using information extracted from the images. In this work it was proposed a formulation with a complete fusion of all the information for achieving robust shape tracking, and optimally resolving uncertainties from the system dynamics.Shams et al. [43] proposed a novel version of GSA, named clustered-GSA, and it was proposed to reduce complexity and computation of the standard GSA. This algorithm originated from calculating the central mass of a system in nature and improves the GSA by reducing the number of objective function evaluations. The clustered GSA is evaluated on two sets of standard benchmark functions and the results are compared with several heuristic algorithms and a deterministic optimization algorithm.There is also previous work on a fuzzy gravitational search algorithm (FGSA), for optimal design of multimachine power system stabilizers (PSSs). The FGSA based-PSS design is validated for two multimachine systems: a 3-machine 9-bus system and a 10-machine 39-bus. Therefore, fuzzy logic is used to speed up the final stages of the process and find the accurate result in a shorter time, this even for very large problems. In the proposed GSA the fuzzy-based mechanism and fitness sharing are applied to aid the decision maker to choose the best compromise solution from the Pareto front [42].In this paper we propose an approach to find the optimal architecture of modular neural networks, which means finding out the optimal number of modules, layers and nodes of the neural network with the fuzzy logic gravitational search algorithm. The FGSA is initially considered with dynamic increase of the alpha value. In addition the fuzzy gravitational search algorithm is also considered with a decrease alpha value approach, which means that the alpha values are decreased as the number of iterations increase. The proposed approach, as well as its use differs from the previous mentioned related works. The proposed method is applied for recognition of medical images.Echocardiography is an important diagnostic aid in cardiology for the functional assessment of the heart. During an echocardiogram exam, a sonographer images the heart using ultrasound by placing a transducer against the patient's chest. Reflected sound waves reveal the inner structure of the heart walls and the velocity of blood flow. Since these measurements are typically made using 2D slices of the heart, the transducer position is varied during an echo exam to capture different anatomical sections of the heart from different viewpoints [6].Echocardiography is often used to help diagnose cardiac diseases related to regional and wall motion as well as valvular motion abnormalities. It also provides images of cardiac structures and their movements giving detailed anatomical and functional information about the heart [7].Speckle is a characteristic phenomenon in laser, synthetic aperture radar images, or ultrasound images. Its effect is a granular aspect in the image. Speckle is caused by interference between coherent waves that, backscattered by natural surfaces, arrive out of phase at the sensor [4,15]. Speckle can be described as random multiplicative noise. It hampers the perception and extraction of fine details in the image. Speckle reduction techniques can be applied to ultrasound images in order to reduce the noise level and improve the visual quality for better diagnosis [17].Artificial neural networks were originally developed by researchers who were trying to mimic the human brain by combining many simple computing elements (neurons or units) [12]. A schematic diagram for a system based on an artificial neural network model, is shown in Fig. 2. More specifically, feedforward neural networks are a class of flexible nonlinear regression, discriminant and data reduction models. Backpropagation refers to the method for computing the gradient error for a feedforward network [12].There are numerous algorithms available for training neural network models; most of them can be viewed as a straightforward application of optimization theory and statistical estimation. Neural networks are trained by previous experience (reflected on input–output data), and when an unknown input is applied to the network it can generalize from past experiences and produce a new result.Modular neural networks have several advantages: each module often addresses a simpler task, and hence can be trained in less number of iterations than the monolithic neural network. Each module is smaller, with fewer weights than the monolithic neural network, and for this reason the time needed for training each module is also smaller. Modules can often be trained independently, in parallel to each other and then at the end the results of the modules have to be combined in some way.Several general advantages of modularity have led to the development of modular systems:•Reducing model complexity, as a way to reduce training time.Combination of techniques. More than one method or class of network can be used as building block.Learning different tasks simultaneously. Trained modules may be shared among systems designed for different tasks.Robustness and incrementality. The combined network can grow gradually and can be made fault-tolerant.Isaac Newton proposed the law of gravity stating that “The gravitational force between two particles is directly proportional to the product of their masses and inversely proportional to the square of the distance between them” [26]. The gravity force is present in each object in the universe and its behavior is called “action at a distance”, and this means gravity acts between separated particles without any intermediary and without any delay. The law of gravity is represented by the following equation:(1)F=GM1M2R2where F=is the magnitude of the gravitational force, G=is a gravitational constant, M1 and M2=are the masses of the first and second particles respectively and, R=is the distance between the two particles.The gravitational search algorithm furthermore to be based on Newtonian gravity law it is also based on Newton's second law of motion, which says “The acceleration of an object is directly proportional to the net force acting on it and inversely proportional to its mass” [26]. The second law of motion is represented by the following equation:(2)a=FMwhere a=is the magnitude of acceleration, F=is the magnitude of the gravitational force and, M=is the mass of the object.The GSA (gravitational search algorithm) was proposed by Rashedi et al. as an approach based on gravitational forces based on populations and at the same time it takes as fundamental principles the law of gravity and motion, which are applied to find the optimal solution by a set of agents called masses and their performance is measured by their corresponding mass. All these objects are attracted to each other by the gravity force, and this force causes a global movement of all objects. The masses cooperate using a direct form of communication, through gravitational force; an agent with heavy mass corresponds to a good solution and therefore moves more slowly than lighter ones. Finally the gravitational and inertial masses are determined using a fitness function [26]. To describe the GSA, consider a system with N masses in which the position of the ith mass is defined as follows:(3)Xi=(Xi1,…,Xid,…,Xin)fori=1,2,…,N,whereXidpresents the position of ith agent in the dth dimension.The mass of each agent is calculated after computing the current population's fitness as follows;(4)Mai=Mpi=Mii=Mi,i=1,2,…,N,(5)mi(t)=fiti(t)−worst(t)best(t)−worst(t)(6)Mi(t)=mi(t)∑j=1Nmj(t)where Mi(t) and fiti(t) represent the mass and the fitness value of the agent i at time t respectively. For a minimization problem, worst(t) and best(t) are defined as follows:(7)best(t)=minj∈{1,…,N}fitj(t)(8)worst(t)=maxj∈{1,…,N}fitj(t)If we want to use GSA for a maximization problem we only have to change Eqs. (7) and (8) as follows,(9)best(t)=maxj∈{1,…,N}fitj(t)(10)worst(t)=minj∈{1,…,N}fitj(t)The stochastic characteristic of this algorithm is based on the idea of the total force that acts on agent i in a dimension d can be a randomly generated number. Weighted sum of dth components of the forces exerted from other agents (Eq. (11)),(11)Fid(t)=∑j=i,j≠iNrandjFijd(t)where randjis a random number in the interval [0,1]. The acceleration now is shown as (Eq. (12)),(12)aid(t)=FidMii(t)where Miiis the inertial mass of the ith agent. To determine the velocity of an agent we consider it as a fraction of its current velocity added to its acceleration.(13)Vid(t+1)=randixVid(t)+aid(t)where randiis a uniform random variable in the interval [0,1]. We use this random number to give a randomized characteristic to the search.The position of the agents could be calculated as the position in a specific time t added to its velocity in a time t+1 as follows,(14)Xid(t+1)=Xid(t)+Vid(t+1)where randiand randjare two uniformly distributed random numbers in the interval [0,1], Rij(t) is the Euclidean distance between two agents i and j, defined as ||Xi(t), Xg(t)||2(15)Rij(t)=Xi(t),Xg(t)2(16)Fid(t)=∑j∈Kbest,j≠1randiFijd(t)Kbest is the set of first K agents with the best fitness value and biggest mass, which is a function of time, initialized to K0 at the beginning and decreasing with time. In this case the gravitational constant G is initialized at the beginning and will be reduced with time to control the search accuracy. The corresponding Equation is:G(t)=G0e−αt/TThe idea of enhancing the GSA using fuzzy logic was inspired from the exploration and exploitation principle in meta-heuristics; in early iterations we have to provide a small alpha value in the search algorithm, because we need a high G value in order to apply a force and acceleration in large quantities, helping the exploration of the algorithm. On the other hand, in the last iterations we have to give a high alpha value, because we need a small value in G to help the algorithm with the exploitation task. Therefore we developed a fuzzy system that will help us with this objective, and it is shown below.First, an initial population is generated, next the fitness of each agent is evaluated, thereafter the update of the gravitational constant G is performed, and then the best and worst individuals of the population are found. The next step is calculating the mass and acceleration of each agent. At this point, if we meet the end of the iterations, in this case the maximum number of iterations, then we return the best solution; else we execute the same steps starting from the fitness evaluation.It is in the third step of the algorithm (Fig. 3), where we apply the modification in this algorithm using fuzzy logic. This modification allows to dynamically changing the alpha parameter values during execution and correspondingly to update the G values and help the GSA to achieve a better performance. Particularly for the G update, we show in Fig. 3a representation of where we use a fuzzy system to obtain the values of the alpha parameter and thus updating the corresponding value of G.We are using iteration as the input variable, which represents the total number of iterations as a percentage from 0% to 100%, and the output variable is the alpha value. We have three fuzzy rules in the system, and more details are shown below. The “And method” was used as the minimum, the “Or method” was used as the maximum, the implication is the minimum, and the aggregation is the maximum, and the type of defuzzification is the centroid.The output is the alpha value, which is granulated as Low [−50 0 50], Medium [0 50 100] and High [50 100 150], although the values of the membership functions range from the lowest of −50, and the highest of 150. We restricted the variation of the fuzzy system output to only positive values to be used by the alpha value. This range, from −50 to 150, was defined in order to provide a wider range for searching the appropriate alpha values. The membership functions are of triangular type as in [29].The fuzzy rules are expressed as follows:1.If (Iteration is Low) then (Alpha is Low).If (Iteration is Medium) then (Alpha is Medium).If (Iteration is High) then (Alpha is High).The Fuzzy rules are designed based on the knowledge that “if iterations are low then the alpha value should be low” because we need more gravity and acceleration for better search space exploration. Moreover, in the last (high) iterations we need a large alpha value to reduce the gravitation and acceleration of the agents, in order to exploit the search space. We have the same situation when the percentage of iterations is medium, because we propose a “median amount” of gravitation for the agents [29].The parameters settings in the gravitational search algorithm using a fuzzy system to increase or decrease the alpha value are as follows: N=20; number of agents, max_it:10; maximum number of iterations.A general case study of the proposed algorithm for general optimization of modular neural networks is presented initially to illustrate the proposed ideas. This case study will prove the practicality of the proposed method so that it will attract other researchers for utilizing the method. One advantage of the proposed method is that we are not depending on a feature extraction phase and the complete images can be used directly with good results.The case study for the proposed algorithm is the problem of Iris recognition. The human iris database from the Institute of Automation of the Chinese Academy of Sciences (CASIA) was used to test the proposed approach with this benchmark case. The database is structured as follows: the information of 241 persons with 5 images per person, are presented. The image dimensions are 200 150, in JPEG format [44]. Only the first 100 persons are used in this test. The 5 images of each person are divided as follows: 3 images are used for training and 2 for testing.Fig. 4shows an image after applying preprocessing steps to the images, which is done before they are introduced to the neural network, and consists of the following steps:•Convert the color images to gray scale.Making a cut in the Iris to capture only the important information.Resize the cut of the iris to 80–80, in BMP format.Convert images from vector to matrix form, this vector contains the number of images of iris and all features, we do not use feature extraction.We are using a modular neural network and its architecture is described as follows: it consists of 2 modules, where each module has one layer for the input data, 2 hidden layers and one layer for the output. Then the modular neural network has an integrator to combine the outputs of the two modules, and finally, the recognition of the iris in the last block. This architecture is illustrated in Fig. 5.The main challenge is to find the optimal architecture of this type of MNNs, which means finding out the optimal number of modules, layers and nodes of the neural network with the fuzzy logic gravitational algorithm to increase the alpha value in a pattern recognition application. In addition, we are also providing the fuzzy gravitational search algorithm with a decreasing alpha value approach to compare results. We are using a modular neural network in this paper and Fig. 6shows the architecture used for this work that can be described as follows: we have two modules, where each module has one layer for the input of the data, two hidden layers are used and one layer in the output of the modular neural network and finally, the recognition of the echocardiogram in the last block with this architecture.This database has the following characteristics: it contains data from 18 individuals (disease patients and healthy patients), and there are 10 images per individual. We are using the www.CardiologyImages.com database with 180 images in the BMP format of 18 subjects, captured on September 30, 2014. In this case 10 images of each subject are used for training the MNN and 6 images are used for recognition. Fig. 7shows a sample of the images from the echocardiograms in the database for using in the recognition process.Fig. 8shows an image after using preprocessing, and we reduced the image size from 200×125 to 80×80 pixels.bmp using only the region of interest (ROI) to eliminate noise as much as possible.

@&#CONCLUSIONS@&#
To have a general case study of the proposed algorithm for general optimization of modular neural networks for person recognition, we initially considered a benchmark database of human iris images. Three types of learning algorithms (gradient descent with adaptive learning (GDA), gradient descent with adaptive learning and momentum (GDX) and scaled conjugate gradient (SCG)) are used for testing with different sizes of the cut in iris images. In analyzing the results in each module we arrived to the conclusion that best learning algorithm in this case is the scaled conjugate gradient (SCG) method.The comparison between the gravitational search algorithm using fuzzy logic to increase the alpha values and the gravitational search algorithm using fuzzy logic for decreasing the alpha values (with the method gradient descent with adaptive learning rate backpropagation) shows that the proposed gravitational search algorithm using fuzzy logic to increase the alpha value method is superior, although the difference is not sufficient to statistically prove it. However, the important thing is that any of the fuzzy approaches improves the traditional GSA to provide better results. The results obtained with the method are good; in this case the gradient descent with adaptive learning rate backpropagation (GDA) produces a 99.4% recognition rate with the gravitational search algorithm using fuzzy logic to increase the alpha value. On the other hand, the results obtained with the gradient descent method with adaptive learning rate backpropagation (GDA) produces a 99.02% recognition rate with the gravitational search algorithm using fuzzy logic for decreasing the alpha value. The obtained results are good, however, other methods could be used to improve even more the results, and for example we can apply another kind of preprocessing technique. Furthermore, the poor imaging quality of echo videos due to low contrast, speckle noise, and signal dropouts also cause problems in image interpretation. In summary, this is an important area of application with many possibilities for future research work.