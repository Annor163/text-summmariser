@&#MAIN-TITLE@&#
Characterization of analysis-suitable T-splines

@&#HIGHLIGHTS@&#
We study the analysis suitable T-spline spaces as a piecewise polynomials space.We characterize the difference between two neighboring polynomial expressions.We study when the space can be described by smoothness conditions.

@&#KEYPHRASES@&#
T-splines,Piecewise polynomial characterization,Smoothness conditions,Isogeometric analysis,Computer aided design,

@&#ABSTRACT@&#
In this article we provide the characterization of analysis suitable T-spline spaces (Beirão da Veiga et al., 2013) as the space of piecewise polynomials with appropriate linear constrains on the subdomain interfaces. We describe AST-meshes for which the linear constrains are equivalent to smoothness conditions and provide examples showing that this is not always the case.

@&#INTRODUCTION@&#
IsoGeometric Analysis (IGA) is a recent numerical technique for solving partial differential equations (PDEs) proposed by T.J.R. Hughes et al. (2005). The key feature of IGA is that the PDE solution is approximated by B-splines or Non-Uniform Rational B-Splines (NURBS) that are commonly used to represent the domain geometry in Computer Aided Design (CAD). Many recent papers in the engineering literature deal with IGA in different applicative areas such as fluid dynamics, structural mechanics, and electromagnetics (see Cottrell et al., 2009 and the references therein). Smoothness of B-splines and NURBS shape functions is also beneficial for PDE approximation, compared to classicalC0continuity of standard finite elements, and it allows new methods enjoying properties which would be hard to obtain with finite elements (e.g., see Buffa et al., 2011 and Evans and Hughes, 2013a, 2013b, 2013c).Tensor-product B-splines or NURBS, often adopted in CAD and IGA, limit flexibility in mesh generation and refinement. However, local refinement strategies in IGA are possible thanks to the non-tensor product extensions of B-splines, such as T-splines (Sederberg et al., 2004, 2003), LR-splines (Dokken et al., 2013), hierarchical splines (Vuong et al., 2011) and polynomial splines over T-meshes (Deng et al., 2008). The focus of this paper is on T-splines. T-spline shape functions are constructed from a T-mesh, they are individually tensor-product of univariate B-splines, but the T-mesh breaks the global tensor-product structure by allowing so-called T-junctions.T-splines have been recognized as a promising tool for IGA in Bazilevs et al. (2010) and have been the object of growing interest in the literature: Beirão da Veiga et al. (2011), Buffa et al. (2010), Dörfel et al. (2010), Li and Scott (2011), Li et al. (2012), Scott et al. (2012), Wang et al. (2011). More recently, in Li et al. (2012)analysis-suitable (AS) T-splines have been defined: AST-splines are a sub-class of T-splines having fundamental mathematical properties needed in a PDE solver. Linear independence of AST-splines blending functions has been first shown in Li et al. (2012) for the bi-cubic case. In Beirão da Veiga et al. (2013), AST-splines are generalized to arbitrary degree and it is shown that the condition of being AS, which is mainly a condition on the connectivity of the T-mesh, is equivalent to the fact that the T-spline basis functions admit a dual basis that can be constructed as in the tensor-product setting. As a corollary, the T-spline space enjoys the optimal approximation properties of standard (tensor-product) B-splines spaces. Still, one key part of the theory of T-splines is incomplete: the characterization of the T-spline space is known only for the special case of T-meshes with simple lines (Li and Scott, 2014).By characterization here we mean the identification of the T-spline space as the space of piecewise polynomial with respect to a mesh (the so-called polynomial-mesh) with some constraints at the mesh edges, for example smoothness constraints. Our goal in this paper is to prove this result.T-spline characterization is an important mathematical target per se but it is also a useful tool for other results. For example, the isogeometric vector fields proposed in Buffa et al. (2014) for electromagnetic problems are based on AST-splines and their properties depends on the characterization. Furthermore, a complete theory of approximation properties of T-spline spaces in the context if isogeometric analysis will benefit from the characterization proposed here, see Beirão da Veiga et al. (2014).For our T-spline characterization we adopt a general technique that is based on the previous works of Billera (1988) and Mourrain (2014) and Pettersen (2013). The main tool is homology, first used in Billera (1988) to study the dimension of spline spaces on triangular meshes, later generalized by Mourrain (2014) to rectangular elements and by Pettersen (2013) to higher dimension cubes. The results of Mourrain (2014) and Pettersen (2013) have been extensively used in Dokken et al. (2013) to study LR-splines. In this paper we further extend Mourrain (2014), Pettersen (2013) in order to represent more general smoothness conditions that arise with T-splines.The outline of the paper is as follows. After some preliminary notation and definitions of Section 2, we introduce the concept of T-mesh, AST-mesh, T-splines in Section 3. In Section 4 we define a space of piecewise polynomial functions with constraints at the mesh lines. These constraints may represent smoothness properties or more general conditions. Then we express the dimension of such a space in terms of the dimension of a homology space, and then we are able to show that, for the kind of constraints that are of interests when dealing with T-spline spaces, we can prove that the dimension of the homology space is indeed zero. Therefore the formula simplifies and the dimension of the piecewise polynomial space is related to the T-mesh topology. In Section 5 we show that the dimension of the T-spline space is the same, and finally that the T-spline space coincides with the piecewise polynomial space. Section 6 contains some example in which the proposed characterization is computed explicitly. In Section 7 we discuss some cases where the characterization can be simplified to smoothness conditions on the inter-element edges. The details are in Theorem 7.1.Unluckily our result is technical and the proof is decomposed in many small lemmas. In order to facilitate the comprehension of the main ideas of the proof we include a map in Fig. 1.In this section we cover the background material on meshes and B-splines. It is also a review of the notation used afterwards. In this paper we study spaces of bivariate piecewise polynomials. For our purposes the degree of the polynomials can be considered fixed at the beginning. We denote byPp=P(px,py)the space of polynomials inx,yof degreepxwith respect of x andpywith respect of y. We will usePpto denote the space of univariate polynomials of degree p.In order to avoid writing tedious specifications of the behavior of the piecewise polynomials on the interfaces between subdomains we will consider them as representatives of a class of Lebesgue-measurable functions.Definition 2.1A knot-vector Θ is a finite non-decreasing sequence of real numbers[θ1≤θ2≤⋯≤θn+1]. The multiplicity of ζ in Θ ismΘ(ζ)=#{i:θi=ζ}.A knot-vector is said to be p-open when for all ζ, it holds0≤mΘ(ζ)≤p+1andm(θ1)=m(θn+1)=p+1. A local-knot-vector of degree p is a knot-vector Θ composed ofp+2knots[θ1≤θ2≤⋯≤θp+2]such thatθ1<θp+2. A knot θ is internal to a knot-vectorΘ=[θ1,…,θn+1]ifθ≠θ1andθ≠θn+1.Note that given a p-open knot-vectorΘ=[θ1≤θ2≤⋯≤θn+1]then all the sub-knot-vectors of the form[θi≤θ2≤⋯≤θi+p+1]are local-knot-vectors of degree p. All the knot vectors considered in this paper will be sub-vectors of a p-open knot-vector and thus all their sub-sequences ofp+2knots will be local-knot-vectors.Definition 2.2Two knot-vectors[θ1,…,θs]and[ξ1,…,ξt]overlap if there exists a sequence of real numbersa1≤⋯≤anand two integers k, l such thatθi=ai+k,1≤i≤sandξi=ai+l,1≤i≤t.Univariate B-splines are piecewise polynomial functionsR→Rassociated to local knot-vectors. There exist different, but equivalent definitions of B-splines. In Chapter IX of de Boor (2001) they are defined using a recurrence relation; in Chapter 4 of Schumaker (2007) they are defined using divided differences. The important properties of the B-splineB[Θ]associated toΘ=[θ1,…,θp+2]are1.for alli:θi<θi+1it holds thatB[Θ]|[θi,θi+1]∈Pp;the support ofB[Θ]issuppB[Θ]=[θ1,θp+2];for allζ∈R,B[Θ]isCk(ζ)wherek=p−m(ζ)and by conventionC−1means discontinuous.Definition 2.3The spline space associated to a knot-vectorΘ=[θ1≤θ2≤⋯≤θn+1]isSΘ=span{B[θi,…,θi+p+1]:i=1,…,n−p}.The restriction to each non-trivial interval[θi,θi+1]of the spline space of degree p associated to a knot-vectorΘ=[θ1,…,θn+1]is a subspace ofPp. We can characterize it explicitly as(1)SΘ|[θi,θi+1]=span{ψj+:j≤i}∩span{ψj−:j≥i+1},whereψi+=(x−θi)p−#{j<i:θj=θi}andψi−=(x−θi)p−#{j>i:θj=θi}.Bivariate B-spline functions of degreep=(px,py)are defined as a product of two univariate B-splines respectively of degreepxandpy:B[θ1,…,θpx+2][ξ1,…,ξpy+2](x,y)=B[θ1,…,θpx+2](x)B[ξ1,…,ξpy+2](y).Definition 2.4A box inR2is a Cartesian product[a,b]=[a1,b1]×[a2,b2]where[ai,bi]is a closed interval (can be empty). Boxes can have different dimensions: 2 for rectangles, 1 for vertical or horizontal edges, 0 for vertexes. The boundary of a boxη=[a,b]is∂η={{a1,b1}×[a2,b2]∪[a1,b1]×{a2,b2}dim⁡η=2{(a1,a2),(b1,b2)}dim⁡η=1∅dim⁡η=0The interior of box η isη0=η∖∂η.Usually boxes are denoted by Greek letters such asα,β,γ,η.Definition 2.5LetΩ=[a1,b1]×[a2,b2]then a box-meshQon Ω is a collection of boxes with the following properties. LetFk(Q)={η∈Q:dim⁡η=k}then1.they cover Ω:⋃η∈F2(Q)η=Ω;boxes of the same dimension do not overlap:∀η1,η2∈Fk(Q),η10∩η20=∅;the edges are compatible with the rectangles:⋃η∈F1(Q)η=⋃η∈F2(Q)∂ηand∀η1∈F1(Q),η2∈F2(Q),η1∩η2is either ∅,η1or a vertex;the vertexes are compatible with the edges:⋃η∈F0(Q)η=⋃η∈F1(Q)∂ηand∀η0∈F0(Q),η1∈F1(Q),η0∩η1is either ∅ orη0;Due to the difference betweenpxandpywe need to distinguish between horizontal and vertical edges. Let the sets of horizontal edges beF1h(Q)and that of vertical edges beF1v(Q). The corresponding sets of internal edges areF1I,h(Q)andF1I,v(Q).Definition 2.6The valence ofβ∈F0(Q)isV(β)=#{α∈F1(Q):β⊂α}. For allβ∈F0(Q)its valence is in{2,3,4}.IfV(β)=2and β is not a corner of Ω then β is said to be a valence 2 T-junction. It can be either horizontal or vertical depending on whether the missing incident edges are horizontal or vertical.IfV(β)=3then β is said to be a T-junction. It can be either horizontal or vertical depending on whether it misses a horizontal, respectively vertical, incident edge.Definition 2.7The horizontal skeleton of a partitionQisSKh(Q)=⋃η∈F1h(Q)∪F0(Q)η.The vertical skeleton isSKv(Q)=⋃η∈F1v(Q)∪F0(Q)η.The skeleton of a partition isSK(Q)=SKh(Q)∪SKv(Q).Note that horizontal valence 2 T-junctions correspond to isolated points inSKh(Q), but are not seen inSK(Q)as they are contained in some edge. Thus it is impossible to recoverQfromSK(Q)while it is possible if bothSKh(Q)andSKv(Q)are provided.Definition 2.8A maximal horizontal line ℓ for a box-meshQis a maximal edge (can be degenerate i.e. a vertex) contained inSKh(Q). The set of maximal horizontal lines isLh(Q). We define similarly maximal vertical lines andLv(Q). The set of maximal lines isL(Q)=Lh(Q)∪Lv(Q).Note that maximal lines can either be maximal edges ofSK(Q)that ends with two T-junctions or degenerate edges that correspond to valence 2 T-junctions. Vice versa each T-junction is an extreme of a maximal line and each valence 2 T-junction is a maximal line.Definition 2.9A box-meshQ1is a refinement ofQ2when they are defined on the same domain,SKh(Q1)⊃SKh(Q2)andSKv(Q1)⊃SKv(Q2).Definition 2.10Given a box-meshQand a segment α such that∂α⊂SK(Q)defineQ+αto be the coarsest refinement ofQwhose skeleton isSK(Q)∪α. Given a vertexβ⊂SKh(Q)∖SKv(Q)(respectivelyβ⊂SKh(Q)∖SKh(Q)) defineQ+βto be the coarsest refinement ofQfor whichSKv(Q)⊃β(respectivelySKv(Q)⊃β).When describing a T-spline space we will use three different meshes: the index T-meshes, the extended index T-meshes and the polynomial mesh. All of these are box-meshes. Given a partitionPof Ω in rectangles we canonically associate to it the coarsest box-mesh whose rectangles are inP. More precisely the mesh defined byQ={ηq:q∈Ω},whereηq=⋂η∈P∪{∂Ω}:q∈ηη.Note that the canonical construction provides always box-meshes that do not have any valence 2 T-junction.T-spline spaces are usually described in the physical domain. This is not appropriate for our purposes and thus we restrict our description to the index-T-mesh. Index T-meshes are box-meshes whose skeleton is contained inZ×Z. They are instrumental in the description of a T-spline space because the generators of the space are associated to topological features of the index-T-mesh: the anchors. More details can be found in Beirão da Veiga et al. (2013).Definition 3.1An index-T-mesh is a pairMT=(Q,Ξ)where1.Qis a box-mesh onΩ=[1,nx]×[1,ny]such that all vertexesβ∈F0(Q)are contained inZ2and satisfying{1,…,px+1,nx−px,…,nx}×[1,ny]⊂SK(MT),[1,nx]×{1,…,py+1,ny−py,…,ny}⊂SK(MT);Ξ is a continuous functionR2→R2of the form:Ξ(x,y)=(Ξx(x),Ξy(y)), whereΞx,Ξy:R→Rare monotone increasing functions such thatΞx([1,2,…,nx])is apx-open knot-vector andΞy([1,2,…,ny])is apy-open knot-vector.Since we will never deal with T-meshes in the physical domain we will drop the index specification in the next sections; i.e., by convention we write T-mesh and we mean index-T-mesh. We will useQand Ξ as conventional names for the components of all index-T-meshes and they will be specified only when their name differs. We will also use symbols and operations that are defined for box-meshes when dealing with index-T-meshes. In these cases we mean that they are applied to the underlying box-mesh. For instance we will useFk(MT)instead ofFk(Q),SK(MT)instead ofSK(Q)andMT+αfor the index-T-mesh(Q+α,Ξ).Definition 3.2The active region of an index-T-meshMTisAR(MT)=[1+⌈px2⌉,nx−⌈px2⌉]×[1+⌈py2⌉,ny−⌈py2⌉].Definition 3.3Given an index-T-meshMTthe corresponding set of anchors isA(MT)={{η∈F0(MT):η⊂AR(MT)}px,pyare odd{η∈F1h(MT):η⊂AR(MT)}pxeven,pyodd{η∈F1v(MT):η⊂AR(MT)}pxodd,pyeven{η∈F2(MT):η⊂AR(MT)}px,pyare evenWe also assume the following properties for all index-T-meshes. While the assumptions are not strictly necessary they allow for simpler definitions and reduce the number of special cases. The following assumptions also exclude the possibility that two different index-T-meshes have the same set of anchors.Assumption 3.41.ifpxis odd no element contains two horizontal facing T-junctions at the same ordinate (either of valence 2 or 3), similarly ifpyis odd no element contains two vertical facing T-junctions at the same abscissa;ifpxis even there is no horizontal valence 2 T-junction, similarly ifpyis even there is no vertical valence 2 T-junction;there is no T-junction η (either of valence 2 or 3) contained inΩ∖AR(MT)except for the extremes of the lines in Definition 3.1.To each anchor is associated a bivariate B-spline whose local knot-vectors are defined as follows.Definition 3.5Letη=[a1,b1]×[a2,b2]be an anchor inA(MT). The B-spline associated to η isBη(x,y)=B[Ξx(Ix)][Ξy(Iy)](x,y)whereIxis the horizontal local index vector and is defined by1.∀x∈Ix,{x}×[a2,b2]⊂SKv(MT);#{x∈Ix:x<a1}=#{x∈Ix:x>b1}=⌈px2⌉;max⁡Ix−min⁡Ixis minimal;Definition 3.6The T-spline space associated to an index-T-meshMTisT(MT)=span{Bη}η∈A(MT).Definition 3.7The polynomial-mesh associated to an index-T-meshMTis the coarsest box-meshMPonΞ(Ω)such that for allf∈T(MT),e∈F2(MP)it holdsf|eis a polynomial inPp.To avoid confusion between the meshes in index space and those in the parameter spaces (index-T-meshes and polynomial-meshes) we use different font styles. The same polynomial-mesh and T-spline space can correspond to many different index-T-meshes. When this happens we say that the index-T-meshes are equivalent. This is formalized in the following definition.Definition 3.8Two index-T-meshesMTandMT′are equivalent when there exists an invertible mapΘ:R2→R2such that1.Q′={Θ(η):η∈Q};AR(MT′)=Θ(AR(MT));∀η∈F0(MT),Ξ(η)=Ξ′∘Θ(η).Conditions 1, 2 imply that there is a one-to-one correspondence of the anchors, and condition 3 implies that the same B-spline is associated to two corresponding anchors. Based on the definition of equivalent index-T-meshes is the definition of refinement of index-T-meshes.Definition 3.9An index-T-meshMT′is a refinement ofMTwhen there existsMT¯equivalent toMTand such thatQ′is a refinement ofQ¯.Analysis-suitable T-meshes are a class of T-meshes for which fundamental properties are guaranteed on the associated T-spline spaces. These are the T-meshes adopted in isogeometric analysis. We need the preliminary concept of extensions of T-junctions.Definition 3.10Letℓ=[a,b]×{y¯}be a maximal horizontal line inLh(MT). Ifa≠1andb≠nxwe define the begin extension begℓ and the end extension endℓ as the horizontal edges (possibly degenerate) with ordinatey¯having the following properties:1.the end points of begℓ and endℓ are in the mesh skeleton, i.e.∂begℓ,∂endℓ⊂SKv(MT);#{α∈F1h(MT+begℓ):α⊂begℓ}=#{α∈F1h(MT+endℓ):α⊂endℓ}=px;letα1,…,αpxthe edges contained in begℓ, then#{αi:αi⊂{(x,y):x≤a}}=⌈px2⌉;letα1,…,αpxthe edges contained in endℓ, then#{αi:αi⊂{(x,y):x≥b}}=⌈px2⌉.Note that the extensions of a maximal line are well defined only under Assumption 3.4. Otherwise more care would be needed for lines whose end points are outside of the active region. In the T-spline literature the extensions are often defined as the union of two pieces: the face extension and the edge extension. This is not needed here.Definition 3.11The extended-mesh associated to an index-T-meshMTis the box-meshMEwhose horizontal and vertical skeletons are respectivelySKh(ME)=⋃ℓ∈Lh(MT)extℓ,SKv(ME)=⋃ℓ∈Lv(MT)extℓ.By constructionMEdoes not contain any valence 2 T-junctions.Definition 3.12An index-T-meshMTis analysis-suitable when for all pairs of maximal linesℓh∈Lh(MT)andℓv∈Lv(MT)the intersections of their extensions is empty:(begℓh∪endℓh)∩(begℓv∪endℓv)=∅.Analysis-suitable index-T-mesh is shortened in AST-mesh.Contrarily to general T-meshes, AST-meshes provide important guarantees on the associated spline space. For instance the existence of continuous uniformly bounded dual functionals on the set of generators (Beirão da Veiga et al., 2013). This fact has many consequences. Those necessary for our characterization are reported in the following theorem. We refer to Beirão da Veiga et al. (2013) for the proof.Theorem 3.13For all AST-meshMT, the following hold:1.the set{Bη:η∈A(MT)}is a basis ofT(MT);the polynomial-meshMPassociated toMTis the box-mesh associated to the following partition ofΞ(Ω)P={e=Ξ(η):η∈F2(ME)anddim⁡e=2}.In this section we will introduce a general framework for the description of piecewise polynomial spaces with linear constrains at the mesh edges. In particular we define constraints that characterize AST-spline spaces. The characterization will be proved in Section 5.Definition 4.1LetMPbe a box-mesh on Ω andJa function from the set of internal edges (i.e.F1I(MP)) to the set of subspaces ofPp. Then we defineS(MP,J)={f:Ω→R,∀e∈F2(MP),f|eis a polynomial inPp,∀e1,e2∈F2(MP),a∈F1I(MP):a=(e1∩e2)f|e1−f|e2∈J(a)}wheref|eis the globally defined polynomial that equals f on e.As an example consider a partition consisting in two rectanglese1=[−1,0]×[0,1]ande2=[0,1]×[0,1]and letQbe the associated box-mesh. ThenF1I(Q)contains onlya={0}×[0,1]. With the choiceJ(a)=Ppthe spaceS(Q,J)is the space of discontinuous piecewise polynomials. On the other extreme forJ(a)={0}we obtain the space of global polynomials on[−1,1]×[0,1]. The space ofC0piecewise polynomial is obtained by settingJ(a)={ψ(x,y)∈Pp:ψ(0,y)=0}={xψ(x,y):ψ∈P(px−1,py)}. Higher orderCksmoothness across a can be expressed byJ(a)={ψ(x,y)∈Pp:ψ(s)(0,y)=0,∀s≤k}={xk+1ψ(x,y):ψ∈P(px−k−1,py)}. Conditions that do not correspond toCksmoothness can be obtained with different choices ofJand will be used to characterizeT(MT).In this section we associate a mapJto an AST-meshMTin such a way thatT(MT)=S(MP,J). The proof of the equality in Section 5 is the main result in this paper. We computeJfor some AST-meshes in Section 6.Remember form Theorem 3.13 that for AST-meshes the polynomial-meshMPis obtained by mapping the extended-meshMEthrough Ξ. When definingJon edges ofMPwe will consider the set of edges ofMEwhose image through Ξ contains it. More in detail we start by associating the polynomial spaceJℓ(α)to every pair(α,ℓ)withα∈F1(ME)andℓ∈L(MT). Then we defineJ(a)fora∈F1I(MP)by combining all the spaces associated to pairs(α,ℓ)withΞ(α)⊃ain a way that mimics the multiplicity of knots in the knot-vector.We need to use pairs because an edgeα∈F1(ME)can be contained in the extension of many extended maximal lines. The simplest example is when two T-junctions face one another at the same ordinate as in the following picture.More complex example can be drawn. In general the maximal number of horizontal maximal linesℓisuch that extℓ contains a given edge α depends on the degree and is⌊px+22⌋. The limit case forpx=5is illustrated in the following picture where the horizontal span of each extended maximal lines is highlighted by a corresponding line at a lower ordinate.Given a horizontal maximal lineℓ∈Lh(MT)we define an auxiliary functionJℓ:{α∈F1I,h(ME)}→{subspaces ofPpx}. Similarly to each vertical maximal lineℓ∈Lh(MT)we associateJℓ:{α∈F1I,v(ME)}→{subspaces ofPpy}.Definition 4.2Letℓ∈Lh(MT),{(x1,y¯)},…,{(xn+1,y¯)}, withx1<…<xn+1, be the vertexes ofMEcontained in extℓ andαibe edge inF1(ME)between{xi,y¯}and{xi+1,y¯}. Letθi=Ξx(xi)andΘℓ=[θ1,…,θn+1]. Then for allα∈F1I(ME)(2)Jℓ(α)={{0}α⊄extℓ∨dim⁡Ξ(α)<1SΘℓ|[θi,θi+1]α=αi∧dim⁡Ξ(α)=1whereSΘℓisspan{Bi(x)=B[θi,…,θi+px+1](x)}i=1,…,n−px. We define similarlyJℓfor vertical lines.From the above definition it follows that(3){0}⊊Jℓ(αi)⊊Ppx⇔αi⊂(begℓ∪endℓ).When there is only an edgeα∈F1(ME)such thatΞ(α)⊃awe are describing the jump of T-spline functions through a multiplicity one mesh line, thus the jump is contained inPpx⊗span{(y−y¯)py}and more precisely in∑ℓ∈Lh(MT)Jℓ(α)⊗span{(y−y¯)py}When more edges α ofF1I,h(ME)are mapped onto the same a then the jump of the polynomial expression of a T-spline across a can have lower order in(y−y¯). For instance in the tensor product case the jump of the polynomial expression of the T-space generators across a is contained inPpx⊗span{(y−y¯)py+1−k:k=1,…,μ(y¯)}.In our setting the problem is complicated by the fact that we want to be sharp in order to characterize the space. Thus we want to count different multiplicity for different subspaces ofPpx. To achieve this we first prove that givena∈F1(MP)we can express all theJℓ(α)withΞ(α)⊃aas generated by a subset of common basis. In this way we can associate the multiplicity to the elements of the common basis and obtain a coherent definition ofJ(a).Lemma 4.3LetMTbe an AST-mesh anda∈F1I,h(MP)be an edge. Letα1,…,αn∈F1I,h(ME)be the edges such thatΞ(αi)⊃a. Then there exists a basis Ψ ofPpxsuch that for allℓ∈L(MT)andk=1,…,n(4)Jℓ(αk)=spanΨℓ,kwhereΨℓ,kis a subset of Ψ. Similarly for a vertical edgeg∈F1I,v(MP)andγ1,…,γm∈F1I,v(ME)there exists a basis Φ ofPpysuch that for allℓ∈Lv(MT)andk=1,…,m(5)Jℓ(γk)=spanΦℓ,kwithΦℓ,k⊂Φ.ProofThe proof is detailed for a horizontala=[a,b]×{y¯}.For many pairs(αi,ℓ)the choice of Ψ is not relevant. This is the case ofαi⊄ℓandαi⊂ℓ∖(begℓ∪endℓ)that correspond respectively toJℓ(αi)={0}andJℓ(αi)=Ppx.For each ℓ andαi⊂begℓ∪endℓthe spaceJℓ(αi)is the restriction to[a,b]of the spline spaceSΘℓwhereΘℓis the knot-vector described in Definition 4.2. Using the characterization in Equation (1) of the restriction of spline spaces we deduce thatJℓ(αi)depends only on the knots corresponding to vertexes lying in the extensions of ℓ that containαi. LetΘ˜ℓbe the knot-vector containing these knots.The existence of Ψ is implied by the fact that all theΘ˜ℓoverlap i.e. that there exists a knot-vector Θ such that all theΘ˜ℓare formed by consecutive knots of Θ andSΘ|[a,b]=Ppx. We prove this property by contradiction.Assume there are two maximal linesℓ1andℓ2inLh(MT)for whichΘ˜ℓ1does not overlap withΘ˜ℓ2. Thenℓ1andℓ2cannot have the same ordinate. Otherwise the vertexes contained in the intersection of the extensions would be the same. SinceΘ˜ℓ1does not overlap withΘ˜ℓ2then either there exists an internal knot (Definition 2.1)θ¯inΘ˜ℓ2withmΘ˜ℓ2(θ¯)<mΘ˜ℓ1(θ¯)or vice versa. In the first case it follows that there is a vertex inF0(ME)contained inextℓ1and corresponding toθ¯that is not vertically aligned with any vertex contained inextℓ2. This is impossible because this vertex is on a horizontal extension and thus cannot be on any vertical extension. SinceΞy([1,…,ny])is apy-open knot-vector (Definition 3.1) there are at mostpy+1integers inΞy−1(y¯)and thus there is not enough space for a vertical extension (py+1vertexes) to be contained inΞ−1(a)∖(extℓ1∪extℓ2). It follows that there is a corresponding vertex contained inextℓ2. Similarly in the other case.From the above reasoning it follows that Θ can be constructed by taking the image byΞxof the abscissa of the vertical lines that intersect the extensions of horizontal lines ℓ such thatΞ(extℓ)⊃aand then completing it to apx-open knot-vector. Other choices of Θ are possible and will be used to guarantee additional properties of the common basis. □We will use the notation of Lemma 4.3 as a convention. Given a horizontal edgea∈F1h(MP)we will callα1,…,αnthe edges inF1h(MP)whose images contain a. Ψ will be used for common basis associated to horizontal edges,Ψℓ,kas its subset that generatesJℓ(αk). Similarly given a vertical edgeg∈F1v(MP)we will callγ1,…,γmthe edges inF1v(MP)whose image contains g. Φ will be the name of common basis associated to vertical edges,Φℓ,kits subset that generatesJℓ(γk). We also defineΨk⊂ΨandΦk⊂Φby(6)Ψk=⋃ℓ∈Lh(MT)Ψℓ,k,(7)Φk=⋃ℓ∈Lv(MT)Φℓ,k.Note that in Equations (6) and (7) the unions are disjoint. Considerαkand two horizontal linesℓ1,ℓ2and letΘ1andΘ2are the knot-vectors from Definition 4.2. If there is a basisψ∈Ψℓ1,k∩Ψℓ2,kit follows that the knots in the local-knot-vector of ψ are contained in bothΘ1andΘ2. Thus the correspondingpx+2vertexes are contained in bothextℓ1andextℓ2and thus (since the extensions containpx+1vertexes)ℓ1andℓ2are not disjoint and are the same maximal line. It follows that for allψi∈Ψ#{(ℓ,k):Ψℓ,k∋ψi}=#{k:Ψk∋ψi},and similarly for allϕi∈Φ#{(ℓ,k):Φℓ,k∋ϕi}=#{k:Φk∋ϕi}.The above remark justify the following definition.Definition 4.4Leta=[a,b]×{y¯}∈F1I,h(MP),Ψ={ψ1,…,ψpx+1}andΨk⊂Ψas in Equation (6) then(8)J(a)=span{ψi(x)(y−y¯)t}i=1,…,px+1;py≥t≥py+1−#{k:Ψk∋ψi}.Similarly forg={x¯}×[a,b]∈F1I,v(MP)define(9)J(g)=span{(x−x¯)sϕj(y)}px≥s≥px+1−#{k:Φk∋ϕj}j=1,…,py+1.Note that for alla∈F1I(MP)the dimension ofJ(a)equals the sum of the dimensions of theJℓ(α), more precisely ifEa={(α,ℓ):α∈F1(ME):Ξ(α)⊃a,ℓ∈L(MT)}then(10)dim⁡J(a)=∑(α,ℓ)∈Eadim⁡Jℓ(α).Indeed, assuming a is horizontal,dim⁡J(a)would be smaller only if for some i#{k:Ψk∋ψi}>py+1. This is impossible because there are at mostpy+1integers inΞy−1(y¯).We now provide a dimension formula for spaces of the formS(MP,J). We follow the approach introduced by Billera (1988) in order to study the dimension of spline spaces on triangular meshes. Mourrain and Pettersen extended Billera theory to rectangular elements (and higher dimension cubes) (Mourrain, 2014; Pettersen, 2013). In this paper we further extend the theory in order to represent the more general smoothness conditions that are needed to deal with AST-spline spaces. In the resulting formula there are homological terms that we prove to be 0 our case, i.e. whenJis defined from and AST-mesh as in Definition 4.4. To study the dimension ofS(MP,J)we construct a set of auxiliary vector spaces, linear maps, and then use homological techniques.The first step is to define, fori∈Zthe vector space(11)Ri=Pp⊗FiI(MP)≅⨁η∈FiI(MP)Pp.Thus an element ofRiis a vector of polynomials inPpin which each component corresponds to a box inFiI(MP). It follows thatRiis {0} fori>2ori<0. Equivalently it is possible to think of an element ofRias a mapping fromFiI(MP)toPp. This justify our abuse of the restriction operator to indicate the component corresponding to a rectangle, edge or vertex. For instance, givenf∈R2,f|eis the polynomial component of f corresponding to the rectangle e. Similarly giveng∈R1,g|ais the polynomial corresponding to the edge a.Definition 4.5The boundary operatorδi:Ri→Ri−1is the linear operator defined on the basis byδiψ⊗e=∑a∈Fi−1I(MP):a⊂eσe,aψ⊗a,wheree∈FiI(MP),ψ∈Ppandσe,ais either 1 or −1 depending on the orientation. LetHebe the lowest dimensional affine subspace ofR2containing e andHabe that containing a. Let n be the outward normal of e on a insideHe. LetKa,Kebe the ordered tuples of the canonical basis ofHaandHe. Then theσe,ais 1 when(Ka,n)is oriented asKe, −1 otherwise.The linear operatorδ2associates to an element ofR2the element ofR1having in each internal edge the difference between the polynomials associated to the two adjacent rectangles. Similarlyδ1:R1→R0gives at each vertex the sum of the differences between the polynomials associated to the vertical and horizontal edges.Let consider again a partition of Ω in two rectanglese1on the left ande2on the right witha=e1∩e2. In this caseF11(MP)contains a single edge a andR1is isomorphic toPp. Givenf∈R2thenδ2fisδ2f=σe1,af|e1+σe2,af|e2=f|e2−f|e1.Indeed since a is vertical we have to control the orientation of(e2,n). The outward normal ofe1ise1and thusσe1,a=−1because(e2,e1)has the opposite orientation of(e1,e2). The outward normal ofe2is instead−e1and thusσe2,a=1because(e2,−e1)is oriented as(e1,e2). A complete description of the maps δ can be extrapolated from its definition on the following mesh.In this case they hold:δ2(ψ1⊗e1+ψ2⊗e2+ψ3⊗e3+ψ4⊗e4)=(ψ2−ψ1)⊗g1+(ψ4−ψ3)⊗g2+(ψ1−ψ3)⊗a1+(ψ4−ψ2)⊗a2,δ1(ψ1⊗a1+ψ2⊗a2+ψ3⊗g1+ψ4⊗g2)=(ψ1−ψ2+ψ3−ψ4)⊗b.An important property is thatδi−1∘δiRi={0}, that is, the sequence of spacesRiand mapsδiform a complex. The only non-trivial case is fori=2, that isδ1∘δ2R2={0}. Consider a rectanglee∈F2(MP)and a vertexb⊂∂e. Let a and g be the two edges contained in∂eand containing b. Thenδ1∘δ2(f⊗e)|b=(σe,aσa,b+σe,gσg,b)f.When a and g are aligned thenσe,a=σe,g. Moreoverσa,b=−σg,band thusδ1∘δ2(f⊗e)|b=0. Otherwise b is a vertex of e and the four cases can be checked explicitly.We adopt the standard notation:R⁎=…⟶δi+1Ri⟶δiRi−1⟶δi−1…whereR⁎denotes the whole complex. We associate the conditions expressed byJto a subspaceJ1ofR1:J1=∑a∈F1I(MP)J(a)⊗a.We then build a sub-complexJ⁎ofR⁎J⁎=…⟶δi+1Ji⟶δiJi−1⟶δi−1…where(12)Ji={∑a∈F1I(MP)J(a)⊗ai=1∑b∈F0I(MP)∑a∈F1I(MP)b⊂aJ(a)⊗bi=0{0}otherwiseSinceJ⁎is a sub-complex it is possible to take the quotient complexS⁎=…⟶δ˜i+1Si⟶δ˜iSi−1⟶δ˜i−1…where(13)Si=Ri/Jiandδ˜iis the map induced byδion the equivalence classes.With this constructionJ⁎,R⁎andS⁎form a short exact sequence of complexes0→J⁎→R⁎→S⁎→0. This means that the following diagram commutes and that fori=2,1,0it holdsker⁡πi=ιi(Ji).SinceR2≅S2, we have the following important identifications(14)S(MP,J)≅{g∈R2:δ2g∈J1}≅ker⁡δ˜2≅H2(S⁎),whereH2(S⁎)is the 2-th homology group forS⁎, and in general the i-th homology group of a complexC⁎isHi(C⁎)=ker⁡δiδi+1Ci+1.From the commutative diagram above (with exact columns), a standard homology result is that the following long homology sequence is exact (see for example Spanier, 1981):(15)Some of the homology groups in the long sequence are explicitly known: sinceJ2={0}, then(16)H2(J⁎)≅{0};moreover, the homology ofR⁎can be computed as in Dokken et al. (2013) (the assumption is that the domain Ω is simply connected, which is our case)(17)H2(R⁎)≅Pp(18)H1(R⁎)≅{0}(19)H0(R⁎)≅{0}.From (15), and (18)–(19) we get{0}→H1(S⁎)→H0(J⁎)→{0}, that is,(20)H1(S⁎)≅H0(J⁎);similarly, from (15) and (19) we have{0}→H0(S⁎)→{0}, that is(21)H0(S⁎)≅{0}.Another homological result is(22)∑i=02(−1)idim⁡Si=∑i=02(−1)idim⁡Hi(S⁎).In conclusion, using (14), (22) and then (20)–(21) we have(23)dim⁡S(MP,J)=dim⁡H2(S⁎)=dim⁡H1(S⁎)−dim⁡H0(S⁎)+∑i=02(−1)idim⁡Si.dim⁡S(MP,J)=dim⁡H0(J⁎)+∑i=02(−1)idim⁡Si.In order to use (23) for computingdim⁡S(MP,J)we need to evaluatedim⁡H0(J⁎). We now prove thatdim⁡H0(J⁎)=0whenJis defined as in Definition 4.4.The homology group is by definitionH0(J⁎)=ker⁡δ0δ1J1=J0δ1J1and thus its elements are classes of elements ofJ0corresponding to the equivalence relationa≈b⇔a−b∈δ1J1.To prove that the homology is trivial (H0(J⁎)={0}) we will use some relations between the polynomial spaces involved in the definition ofJ1andJ0. In order to unify the treatment for all type of vertexes (valence 4, 3 and 2) we define some generic symbols and extend the definition ofJtoF1I(MP)∪{∅}by settingJ(∅)={0}.Definition 4.6Givenb∈F0I(MP)letab,1,ab,2,gb,1,gb,2be respectively the edges inF1I(MP)in the position described by the following scheme. If the corresponding edge does not exist inF1(MP), we define them to be ∅.Remember from the definition ofJ0(Equation (12)) thatJ0|b=J(ab,1)+J(gb,1)+J(ab,2)+J(gb,2).The above can be refined as stated in the following proposition.Proposition 4.7For allb∈F0I(MP)it holdsJ0|b=J(ab,2)+J(gb,2).The proof of this proposition for general AST-meshes is reported in Appendix A. Here we only show a simpler proof for AST-meshes without repeated lines i.e. such thatΞx,Ξyare strictly monotone on the active region.Proof for AST-meshes without repeated linesIn this case there is a one-to-one correspondence between the boxes of the polynomial-meshMPand those of the extended meshME. Let β be the preimage of b, fori=1,2letαβ,ibe the preimage ofab,iandγβ,ibe that ofgb,i. Consider anℓ∈Lh(MT)and the correspondingJℓ(αβ,2),Jℓ(αβ,1)that are subspaces ofPpx. From the description ofJℓas a restriction of a spline space (see Definition 4.2 and Equation (1)) it follows thatJℓ(αβ,1)⊂Jℓ(αβ,2)+span{(x−x¯)px}.Moreover since the lines are single lines thenJ(ab,2)=(∑ℓ∈Lh(MT)Jℓ(αβ,2))⊗{(y−y¯)py}.Merging the two results above givesJ(ab,1)⊂J(ab,2)+span{(x−x¯)px(y−y¯)py},and by symmetryJ(gb,1)⊂J(gb,2)+span{(x−x¯)px(y−y¯)py}.From the fact that the mesh is analysis suitable it follows that eitherαβ,2orγβ,2is not contained in any extension. Without loss of generality we can assume thatαβ,2is not contained in any extension. This is equivalent toJ(ab,2)=Ppx⊗span{(y−y¯)py}and implies both of the following:•J(ab,1)⊂J(ab,2);J(ab,2)∋(x−x¯)px(y−y¯)pyand thusJ(ab,2)+J(gb,2)⊃J(gb,2)+span{(x−x¯)px(y−y¯)py}⊃J(gb,1).Theorem 4.8For all AST-meshMTthe homology of theJ⁎complex isH0(J⁎)={0}and thus the dimension formula in Equation(23)simplifies to(24)dim⁡S(MP,J)=∑i=02(−1)idim⁡Si.ProofThe proof is inductive and based on an ordering of the vertexes ofMPfrom bottom to top and from left to right. Letb1,b2∈F0I(MP)then we say thatb1⪯b2when there exista1,…,ak∈F1I(MP)such that•⋃i=1kaiis a polygonal path with extremesb1andb2;fori<jand any two points(x,y)∈ai,(x′,y′)∈ajx≤x′∧y≤y′; i.e. when going fromb1tob2following theaithe direction is always up or right.Now, givenρ∈J0letZ(ρ)be the set of internal vertexes on which ρ is null and that precede by the above relation the support of ρ:Z(ρ)={b∈F0I(MP):ρ|b=0∧∄b′∈F0I(MP):ρ|b′≠0∧b′≺b}.Considerρ∈J0be given and letb∈F0I(MP)be a minimal vertex for ⪯ such thatρ|b≠0. By Lemma 4.7 there existϕa∈J(ab,2)andϕg∈J(gb,2)such thatρ|b=ϕa+ϕg.Thus settingρ′=ρ+δ1(ϕa⊗ab,2+ϕg⊗gb,2)it followsZ(ρ′)⊃Z(ρ)∪{b}.We have shown that allρ∈J0,ρ≠0, are equivalent to aρ′∈J0such thatZ(ρ′)⊋Z(ρ)and thus withZ(ρ′)containing more vertexes. Since the number of vertexes is finite and ≈ is transitive then allρ∈J0are equivalent to 0 and thusH0(J⁎)={0}. □In this section we prove the main result of the paper. Namely the following characterization theorem.Theorem 5.1For all AST-meshesMTit holds(25)T(MT)=S(MP,J),whereJis defined inDefinition 4.4.We begin by proving the following inclusionLemma 5.2LetMTbe an AST-mesh, then(26)T(MT)⊂S(MP,J).ProofConsider an elementBηof the basis ofT(MT), where η is the corresponding anchor. LetΘx=[θx,1,…,θx,px+2]be the horizontal local-knot-vector ofBηandΘy=[θy,1,…,θy,py+2]be its vertical local-knot-vector. A vertical lineℓicorresponds to each horizontal knotθx,i(see the definition of local index vector Definition 3.5). Since the T-mesh is analysis-suitable (Definition 3.12), using Beirão da Veiga et al. (2013, Lemma 3.2.(c)) we also have[θy,1,θy,py+2]⊂Ξy(extℓi). This is enough to conclude that for all theℓiandγ∈F1I,v(ME),γ⊂extℓiit holdsJℓi(γ)⊃span{B[θy,1,…,θy,py+2]|Ξy(γ)}.This implies, counting the multiplicities, that for allg∈F1v(MP)contained insuppBηthe jump of polynomial definition ofBηthrough g is inJ(g). Since that holds for all vertical and (by symmetry) horizontal edges we conclude thatBηis inS(MP,J). Since it holds for allBηthen the thesis holds. □The proof of the characterization is completed by showing that(27)dim⁡T(MT)=dim⁡S(MP,J).In order to prove that the two dimension are equal it is necessary to prove that(28)dim⁡T(MT)=#A(MT)=dim⁡S(MP,J)=∑i=02(−1)idim⁡Si.This is done in two steps by introducing a subsetE(ME)ofF0(ME)and proving the two following equalities(29)#E(ME)=#A(MT)and(30)∑i=02(−1)idim⁡Si=#E(ME).A subsection is dedicated to each of the above equalities.Definition 5.3We say that a vertexβ∈F0(ME)is effective for a lineℓ∈L(MT)ifβ∈extℓ∖endℓ.We say that β is horizontally effective when there existsℓh∈Lh(MT)such that β is effective forℓh. We say that β is vertically effective when there existsℓv∈Lv(MT)such that β is effective forℓv. We say that β is effective when it is both horizontally and vertically effective and it is contained in[1,nx−px]×[1,ny−py].The condition of being contained in[1,nx−px]×[1,ny−py]is necessary because of the lack of a proper extensions of the lines outside the active region. Without this constrain there would be spurious effective vertexes near the corners.Note that ifβ∈F0(ME)is contained in a horizontal extension then it must be vertically effective because it cannot be contained in any vertical extension. Similarly if β is contained in a vertical extension it must be horizontally effective. As a consequence all vertexes are either horizontally or vertically effective and also the following holds(31)β∈begℓ∖endℓ⇒βis effective.Definition 5.4We define the following set of effective vertexes:(32)E(ME)={β∈F0(ME):βis effective}(33)Eℓ={β∈E(ME):βis effective forℓ}.Definition 5.5To every anchorη=[a1,b1]×[a2,b2]∈A(MT)we associate its bottom left cornerβη={(a1,a2)}.Note that to different anchorsη1≠η2∈A(MT)corresponds different vertexesβη1≠βη2. Using vertexes associated to anchors instead of the anchors allows us to write an argument that is independent of the degree p.Definition 5.6We define the following two sets of vertexes associated to anchors:(34)BA(ME)={βη:η∈A(MT)}(35)BAℓ={βη:η∈A(MT)∧βη⊂ℓ}.The two setsBAℓandEℓfor a horizontal line ℓ and different degrees p are represented in Fig. 2. The figure is designed in order to highlight the differences between the two sets.A vertexβη∈BA(ME)is always contained in a unique lineℓ∈Lh(MT). ThusBA(ME)is the disjoint union onℓ∈Lh(MT)ofBAℓ. SimilarlyE(ME)is the disjoint union onℓ∈Lh(MT)ofEℓ. It is thus possible to write the difference in cardinality as a sum over the horizontal lines.(36)#A(MT)−#E(ME)=∑ℓ∈Lh(MT)(#BAℓ−#Eℓ)=∑ℓ∈Lh(MT)(#(BAℓ∖Eℓ)−#(Eℓ∖BAℓ))It is possible to decomposeBAℓ∖Eℓin two disjoint sets(37)(BAℓ∖Eℓ)=Dendℓ+∪Dℓ+,Dendℓ+∩Dℓ+=∅,whereDendℓ+contains the vertexes contained in endℓ andDℓ+those that are effective for ℓ, but not effective(38)Dendℓ+={β∈BAℓ:β⊂endℓ},(39)Dℓ+={β∈BAℓ:β⊄endℓ∧β∉Eℓ}.Similarly we splitEℓ∖BAℓin two disjoint sets(40)(Eℓ∖BAℓ)=Dbegℓ−∪Dℓ−,Dbegℓ−∩Dℓ−=∅,where(41)Dbegℓ−={β∈Eℓ:β⊂begℓ∖ℓ},(42)Dℓ−={β∈Eℓ:β⊂ℓ∧β∉BAℓ}.Note for allℓ∈Lh(MT)the vertexes inDendℓ+andDbegℓ−are in bijection: the leftmost vertex ofDbegℓ−ismax⁡{k+(pxmod2),⌈px2⌉}edges to the left of the leftmost vertex inDendℓ+, where k is the number of edges ofMEcontained in ℓ. In particular(43)#Dendℓ+=#Dbegℓ−=min⁡{k+(pxmod2),⌈px2⌉}.Using Equations (36), (37), (40) and (43) we rewrite#A(MT)−#E(ME)as(44)#A(MT)−#E(ME)=∑ℓ∈Lh(MT)(#Dℓ+−#Dℓ−).Since theDℓ+andDℓ−are disjoint, then#A(MT)−#E(ME)=#(⋃ℓ∈Lh(MT)Dℓ+)−#(⋃ℓ∈Lh(MT)Dℓ−).LetD+=⋃ℓ∈Lh(MT)Dℓ+andD−=⋃ℓ∈Lh(MT)Dℓ−, we want to prove that#D+=#D−. The vertexes inD+andD−can either be contained in the area near the corners(45)ΩC=([1,px+1]∪[nx−px,nx])×([1,py+1]∪[ny−py,ny])or in the vertical stripe(46)ΩS=[px+2,nx−px−1]×[1,ny].The number of vertexes inD+andD−contained inΩCdoes not depend on the AST-mesh but only on the degree. The following table details the number of vertexes ofD+contained in the regions near the corners of Ω:Area#D+[1,px+1]×[1,py+1]0[1,px+1]×[ny−py,ny]⌈px+12⌉⌊py+12⌋[nx−px,nx]×[ny−py,ny]⌊px+12⌋⌊py+12⌋[nx−px,nx]×[1,py+1]⌊px+12⌋⌈py+12⌉ΩC(px+1)(py+1)−⌈px+12⌉⌈py+12⌉The corresponding table forD−is:Area#D−[1,px+1]×[1,py+1](px+1)(py+1)−⌈px+12⌉⌈py+12⌉[1,px+1]×[ny−py,ny]0[nx−px,nx]×[ny−py,ny]0[nx−px,nx]×[1,py+1]0ΩC(px+1)(py+1)−⌈px+12⌉⌈py+12⌉It follows that#{β∈D+:β⊂ΩC}=#{β∈D−:β⊂ΩC}.We group the vertexes ofD+andD−contained inΩSby their abscissa. LetDx¯+={β={(x¯,y)}∈D+}Dx¯−={β={(x¯,y)}∈D−}.We prove that for allx¯∈[px+2,nx−px−1]the setsDx¯+andDx¯−have the same cardinality:(47)#Dx¯+=#Dx¯−.From this it follows#{β∈D+:β⊂ΩS}=#{β∈D−:β⊂ΩS}and thus#D+=#D−and thus#A(MT)=#E(ME).Our proof is based on the fact that all the vertexes inDx¯+andDx¯−are contained in vertical extensions (see Fig. 2). Letℓ1v,…,ℓkv∈Lv(MT)be the maximal vertical lines atx¯.Dx¯+contains the vertexes associated to anchors that are not vertically effective. Thus it contains all the vertexes associated to the anchors that are contained in a vertical end extension, but not contained in any vertical begin extension:Dx¯+=⋃i=1k(Dendℓiv+∖⋃j=1kDbegℓiv−).The union inside the parenthesis is a disjoint union as a vertex can be vertically effective for a unique vertical line. Thus the cardinality ofDx¯+is#Dx¯+=∑i=1k#Dendℓiv+−∑i,j=1k#(Dendℓiv+∩Dbegℓjv−).SimilarlyDx¯−contains all the effective vertexes contained in vertical begin extensions but not contained in any vertical line (non-extended) and thus not inDendℓiv+for any i:Dx¯−=⋃i=1k(Dbegℓiv−∖⋃j=1kDendℓiv+).Again the union inside the parenthesis is a disjoint union as a vertex can only be contained in a single vertical line. Thus remembering that#Dbegℓiv−=#Dendℓiv+(Equation (43)) and settingI={1,…,k}it follows#Dx¯−=∑i=1k#Dbegℓiv−−∑i,j∈I#(Dbegℓiv−∩Dendℓjv+)=∑i=1k#Dendℓiv+−∑i,j∈I#(Dbegℓiv−∩Dendℓjv+)=#Dx¯+.This completes the proof of#A(MT)=#E(ME).In order to understand the link between the dimension formula in Equation (24) and the effective vertexes of the extended mesh it is appropriate to rewrite the dimension formula as a sum over the internal vertexes of the polynomial-mesh. This is achieved by using the following three facts:1.dim⁡Si=∑e∈FiI(MP)dim⁡Si|e=∑e∈FiI(MP)(dim⁡Ri|e−dim⁡Ji|e);dim⁡J0|b=dim⁡J1|ab,2+dim⁡J1|gb,2−dim⁡(J1|ab,2∩J1|gb,2);#F2I(MP)−#F1I(MP)+#F0I(MP)=1.Using the aboves we can rewritedim⁡S(MP,J)as a sum of terms depending only on the dimensions of the components ofJ1.(48)dim⁡S(MP,J)=(px+1)(py+1)#F2I(MP)−∑a∈F1I,h(MP)[(px+1)(py+1)−dim⁡J1|a]−∑g∈F1I,v(MP)[(px+1)(py+1)−dim⁡J1|g]+∑b∈F0I(MP)[(px+1)(py+1)−dim⁡J0|b]=(px+1)(py+1)(#F2I(MP)−#F1I(MP)+#F0I(MP))+∑b∈F0I(MP)(dim⁡J1|ab,2+dim⁡J1|gb,2−dim⁡J0|b)+∑b∈F0(MP)∖F0I(MP)dim⁡J1|ab,2+∑b∈F0(MP)∖F0I(MP)dim⁡J1|gb,2=(px+1)(py+1)︸Pv+∑b∈F0I(MP)dim⁡(J1|ab,2∩J1|gb,2)︸Pb+∑b∈F0(MP)∖F0I(MP)dim⁡J1|ab,2︸Pa+∑b∈F0(MP)∖F0I(MP)dim⁡J1|gb,2︸Pg.Note that inPawe are actually considering only the internal horizontal edges that touch the left boundary ofΞ(Ω). Similarly inPgwe are considering the vertical edges that touch the bottom boundary ofΞ(Ω).We prove the following equalities(49)Pv=#{β∈E(ME):β⊂[1,px+1]×[1,py+1]},(50)Pa=#{β∈E(ME):β⊂[1,px+1]×[py+2,ny]},(51)Pg=#{β∈E(ME):β⊂[px+2,nx]×[1,py+1]},(52)Pb=#{β∈E(ME):β⊂[px+2,nx]×[py+2,ny]},that together implydim⁡S(MP,J)=Pv+Pa+Pg+Pb=#E(ME). Equation (49) follows from the fact that all vertexes in the area are effective. The proof of Equations (50) and (51) are in Lemma 5.7 and the proof of (52) is in Lemma 5.10.Lemma 5.7Equations(50)and(51)hold.ProofAs usual we only detail the horizontal case: Equation (50). Recall Equation (10)dim⁡J1|a=dim⁡J(a)=∑ℓ,αdim⁡Jℓ(α)whereℓ∈L(MT)andα∈FI,h(ME)is such thatΞ(α)⊃a. It is thus sufficient to prove that for each ℓ(53)dim⁡Jℓ(α)=#{β⊂[1,px+1]×[py+2,ny]:βis effective forℓ}.From Equation (1) we deduce thatdim⁡Jℓ(α)ismin⁡{vl,px+1}+min⁡{vr,px+1}−px+1wherevlis the number of vertexes in extℓ on the left of α andvrthe number of those on the right of α (including the extremes of α). Since a touches the left boundary ofΞ(Ω)thenα=[px+1,b]×{y¯}and thusdim⁡Jℓ(α)=vl+min⁡{vr,px+1}−px+1.On the other hand the leftmostvl+vr−px+1vertexes contained in extℓ are effective for ℓ and this proves the thesis. □Before the proof of Equation (52) we recall Definition 4.4 and present an interesting case that simplifies it. Consider an edgea=[a,b]×{y¯}inF1I,h(MP)and letα1,…,αn∈F1(ME)be the edges inF1I,h(ME)such thatΞ(αi)⊃a. Let Ψ be the common basis associated to a andΨkas in Equation (6) be the subset of Ψ corresponding to the edgeαk:spanΨk=∑ℓ∈Lh(MT)Jℓ(αk).Then according to Definition 4.4:J(a)=span{ψi(x)(y−y¯)t}i=1,…,px+1;py≥t≥py+1−#{k:Ψk∋ψi}.When theΨiare ordered by inclusion, i.e.(54)i≥j⇒Ψi⊃Ψj,we can renameΨ1,…,ΨntoΨt0,…,Ψpy(t0=py+1−n) and rewrite Definition 4.4 as(55)J(a)=∑t=t0py(spanΨt⊗span{(y−y¯)t}).Our proof of Equation (52) relies on the validity of Equation (54) for both theΨkcorresponding toab,2and theΦkcorresponding togb,2, where b is an internal vertex ofMP. This condition is not satisfied in general, but we will show that can be assumed for a vertex at a time.Definition 5.8LetMTbe an AST-mesh,b={(x¯,y¯)}∈F0I(MP),αt0,…,αpybe the edges inF1(ME)such thatΞ(αi)⊃ab,2andγs0,…,γpybe the edges inF1(ME)such thatΞ(γi)⊃gb,2. Let Ψ be the common basis ofPpxassociated to a as in Lemma 4.3, Φ be the common basis associated to g, andΨk,Φkas in Equations (6) and (7). ThenMTis said to be canonical forb when the following hold:1.i≥j⇒Ψi⊃Ψj, and thusJ(ab,2)=∑t=t0py(spanΨt⊗span{(y−y¯)t});i≥j⇒Φi⊃Φj, and thusJ(gb,2)=∑s=s0px(span{(x−x¯)s}⊗spanΦs).A mesh is thus canonical forb={(x¯,y¯)}∈F0(MP)when the spaces associated to the edgesα1,…,αn∈F1h(ME)such thatΞ(αi)⊃ab,2correspond to the decomposition ofJ(ab,2)based on the divisibility order with respect of(y−y¯)and, at the same time, the spaces associated to the edgesγ1,…,γm∈F1v(ME)such thatΞ(αi)⊃gb,2correspond to the decomposition ofJ(gb,2)based on the divisibility order with respect of(x−x¯). In general an AST-mesh is not canonical for any vertex but givenb∈F0I(MP)we can modifyMTinto a canonical mesh for b, while preservingJ(ab,2),J(gb,2)and#{β∈E(ME):β⊂Ξ−1(b)}.Lemma 5.9For every AST-meshMT=(Q,Ξ)and vertexb={(x¯,y¯)}∈F0I(MP)there exists an AST-meshM˜T=(Q˜,Ξ)such that:1.b∈F0I(MP˜)andM˜Tis canonical for b;J(a˜b,2)for the meshM˜TequalsJ(ab,2)forMT;J(g˜b,2)for the meshM˜TequalsJ(gb,2)forMT;#{β∈E(ME):β⊂Ξ−1(b)}=#{β∈E(M˜E):β⊂Ξ−1(b)}.ProofWe obtainM˜Tby a sequence of modification ofMT. Both the number of effective vertexes contained inΞ−1(b)and the spacesJ(ab,2)andJ(gb,2)depend on a subset of the maximal lines ofMT. Thus the purpose of the first modifications is to simplify the mesh and allow the following modifications.Step 1: LetLbthe set of lines whose extension intersectsΞ−1(b)andLb′be the set of lines not inLbthat intersect the extensions of the lines inLb:Lb={ℓ∈L(MT):extℓ∩Ξ−1(b)≠∅}Lb′={ℓ∈L(MT)∖Lb(MT):∃ℓˆ∈Lb:extℓˆ∩ℓ≠∅}.We prolong the lines inLb′till the span the whole domain. We can now remove all lines that are not inLb∪Lb′. Equivalently we can start from the coarsest tensor product mesh whose skeleton contains the lines inLb′and add the lines inLb. With these operations we obtain a mesh that have the same structure aroundΞ−1(b), but that is simpler elsewhere. Note that the extension of the lines inLbcan be modified, but only if the considered extension does not intersectΞ−1(b), and thus the quantities in 2, 3, 4 are preserved.Step 2: We simplify the mesh further by removing the linesℓ∈Lbsuch thatΞ(extℓ)⊅ab,2∧Ξ(extℓ)⊅gb,2. Indeed their intersection withΞ−1(b)is contained in their end extension and thus no vertex can be effective for them, nor they do influence the spacesJ(ab,2)andJ(gb,2).Step 3: We prolong the remaining lines in order to reduce the number of extensions intersectingΞ−1(b). Ifℓ∈Lh(MT)andΞ(endℓ)⊅ab,2then we can prolong ℓ to the right tillnx−⌈px2⌉. IfΞ(begℓ)⊅ab,2then begℓ reach the left boundary ofΞ−1(b)and thus prolonging ℓ to the left till1+⌈px2⌉does not change the set of vertexes contained inΞ−1(b)that are effective for ℓ. By doing the same to vertical lines we have thus reducedMTto a simpler mesh where all the extensions are either contained in the preimage of the boundary or are such that their images contain eitherab,2orgb,2.Step 4: We reorder the lines inLb: move horizontal lines ℓ that contains a vertex in(ℓ∖(begℓ∪endℓ))∩Ξ−1(b)(and thus can intersect a vertical extensions) towards the top, similarly we move vertical lines that can intersect horizontal extensions toward the right. Letyt0<…<ypxbe the ordinates of the horizontal lines inLb. Letxibe the abscissa of the rightmost vertexβi={(xi,yi)}⊂Ξ−1(b)that is contained in an edgeα∈F1h(ME)that is not contained in any horizontal extensions; −∞ if such vertex does not exist. We can rearrange the horizontal lines in such a way that the mapyi→xiis monotone non-decreasing. First moving to the bottom the lines atyi, i such thatxi=−∞gives an AST-mesh that preserve the required quantities. Indeed the definition ofJdoes not depend on the order, sincexi=−∞all the vertexes with ordinateyiare also contained in horizontal extensions and (consequently) all vertical extensions are contained in{(x,y):y>yi}thus the number of effective vertexes contained inΞ−1(b)does not change nor intersections between horizontal and vertical extensions are introduced. Second swapping the ordinates of two set of lines at different ordinatesyi<yj,i,jsuch thatxi>xjalso preserves the required quantities. Indeed all the vertical extensions reaching belowyjare at an abscissa that is strictly less thenxj. Thus it is not possible to introduce intersections between horizontal and vertical extensions. The effectivity of vertexesβ={(a,b)}witha≥xidepends only on the horizontal effectivity as they cannot be contained in any vertical extension. Thus after the reordering they are swapped as the group of lines. The effectivity of vertexesβ={(a,b)}witha<xiis not altered by swapping the lines as it depends only on the vertical effectivity (they are not contained in horizontal extensions). We reorder vertical lines in a similar way.Step 5: The last step is to modify the lines in order to obtain a canonical mesh for b. Letαt0,…,αpy∈F1(ME)be the edges such thatΞ(αi)⊃ab,2andytm<…<ypybe their ordinate. Recalling Lemma 4.3 we can construct a basisΨ={ψ1,…,ψpx+1}ofPpxsuch that for allαi∈F1(MT)andℓ∈L(MT)it holdsJℓ(α)=spanΨℓwhereΨℓis a subset of Ψ. The construction in Lemma 4.3 is to defineψito be the restriction ofB[θi,…,θi+px+1]to[θpx+1,θpx+2]whereΘ=[θ1,…,θ2px+2]is a suitable knot vector such that[θpx+1=x¯,θpx+2]is the horizontal span ofab,2. Here we define Θ to be the image byΞxof the abscissas of some of the vertical lines. The abscissas are denoted againxi, but they are not related to those in Step 4. Letxs0<…<xpx+1be the abscissa of the vertical lines that intersectΞ−1(b)in a point outside of their extensions;x1<…<xs0−1be those of the nearest vertical lines on the left ofxs0andxpx+2<…<x2px+2those of the nearest vertical lines on the right ofxpx+1. By building Θ using only abscissas of vertical lines settingθi=Ξx(xi)we obtain a canonical basis Ψ for which the following are equivalent(56)Jℓ(αi)∋ψk⇔extℓ⊃[xk,xk+px+1]×{yi}⇔ℓ⊃[xk+⌈px2⌉,xk+⌈px+12⌉]×{yi}⇔{(xk,yi)}is horizontally effective forℓ.Then the mesh is not canonical if and only if there arei<jand k such that{ψk∈Ψiψk∉Ψj.By the above equivalences we can remedy this by replacing[xk+⌈px2⌉,xk+⌈px+12⌉]×{yi}with[xk+⌈px2⌉,xk+⌈px+12⌉]×{yj}. What remains to be checked is that this operation cannot introduce intersections between horizontal and vertical extensions nor change#{β∈E(ME):β⊂Ξ−1(b)}.Consider first the case ofpxeven, i.e. whenk+⌈px2⌉=k+px2andk+⌈px+12⌉=k+1+px2so that the second line in Equation (56) isℓ⊃[xk+px2,xk+1+px2]. Fromψk∉∑ℓ∈L(MT)Jℓ(αj)we deduce that{(xk,yj)}is either contained in a horizontal end extension or it is not a vertex of the mesh and the horizontal lines atyjare contained in{(x,yj):x>xk}.When{(xk,yj)}is contained in a horizontal end extension all vertical extension reaching belowyjmust be contained in{(x,y):x<xk}and thus the replacement cannot introduce intersections between vertical and horizontal extensions. Moreover the only vertexes whose effectivity can change are{(xk,yi)}and{(xk,yj)}. By the ordering and by the fact thatψk∈Ψiwe deduce that also{(xk,yi)}is contained in a horizontal extension. Thus both vertexes are vertically effective. This means that their effectivity is equivalent to their horizontal effectivity that is swapped by the replacement. Thus the total count of effective vertexes is unaltered.When{(xk,yj)}is not a vertex inF0(ME)then we deduce that fromψk∈Ψithat{(xk,yi)}is a vertex contained in a horizontal begin extension. It follows (using the ordering from Step 4) that all vertical extension reachingyjmust have an abscissa strictly less thanxk. We can now conclude as before.Whenpxis odd then replacing the vertex{(xk+⌈px2⌉,yi)}with{(xk+⌈px2⌉,yj)}can possibly require the deletion and the insertion of additional edges in order to fulfill Assumption 3.4. In particular when removing{(xk+⌈px2⌉,yi)}also all the horizontal edges inF1(MT)containing it must be removed, and when adding{(xk+⌈px2⌉,yj)}the edges[xk+⌈px2⌉,xk+1+⌈px2⌉]×{yj}and[xk−1+⌈px2⌉,xk+⌈px2⌉]×{yj}must be added depending on the presence inF0(MT)of respectively{(xk+1+⌈px2⌉,yj)}and{(xk−1+⌈px2⌉,yj)}. The preservation of the number of effective vertexes is the same as for the even case.Applying the same procedure to vertical lines provides a canonical mesh. □We remark that canonical meshM˜Tconstructed in the above proof is very different fromMT. In fact the only preserved properties are the domain Ω, the map Ξ and those stated in the lemma. Note for example that, for the mesh in Fig. 3,J(a˜b,1)≠J(ab,1). This is not a problem as (52) is implied by∀b∈F0I(MP),(57)dim⁡(J1|ab,2∩J1|gb,2)=#{β∈E(ME):β⊂Ξ−1(b)}.Thus we can use a different canonical meshM˜Tfor each vertexb∈F0I(MP).Lemma 5.10Equation(52)holds.ProofSince all theβ⊂[px+2,nx−px−1]×[py+2,ny−py−1]are contained in the preimage of someb={(x¯,y¯)}∈F0I(MP)then Equation (52) is implied by Equation (57). To prove Equation (57) for a vertex b we can assume thatMTis canonical for b (see Definition 5.8 and Lemma 5.9). Letαt0,…,αpybe the horizontal edges ofMEsuch thatΞ(αt)⊃ab,2andytbe the ordinate ofαt. Similarly letγs0,…,γpxbe the vertical edges such thatΞ(γs)⊃gb,2andxsbe the abscissa ofγs. From the properties of canonical meshes we know{J(ab,2)⊂Ppx⊗span{(y−y¯)t}t0≤t≤pyJ(gb,2)⊂span{(x−x¯)s}s0≤t≤px⊗Ppyand thusJ(ab,2)∩J(gb,2)⊂span{(x−x¯)s(y−y¯)t}s0≤s≤px;t0≤t≤py.LetI=span{(x−x¯)s(y−y¯)t}s0≤s≤px;t0≤t≤py.The proof is done in three steps:•we construct a basisB={Bs,t}s=0,…,px;t=0,…,pyofPpsuch thatI=span{Bs,t}s=s0,…,px;t=t0,…,py;we show thatJ(ab,2)∩J(gb,2)is generated by a subsetBa,b⊂B;we show that∀s=s0,…,px,t=t0,…,py, we haveBs,t∈Ba,b⇔{(xs,yt)}∈E(ME).Step 1 LetΨ={ψ1,…,ψpx+1}be the common basis associated toab,2constructed in the proof of Lemma 5.9. This construction is required in order to have the equivalent of Equation (56). Letmxbemin⁡{s:∃t:βs,t∈F0(ME)∧βs,tis contained in a horizontal extension}orpxif no vertex is contained in a horizontal extension.Choose a permutation σ of(1,…,px+1)such that•it fixes{mx+1,…,px+1}i.e.σ(i)=ifori=mx+1,…,px+1;letct=#Ψt∩{ψ1,…,ψmx}then for allt=t0,…,py{ψσ(1),…,ψσ(ct)}=Ψt∩{ψ1,…,ψmx}.Step 2 The important consequence of the construction in Step 1 is that for allt=t0,…,pyspanΨt=span{ψˆ1,…,ψˆct}+span{ψs∈Ψt:s≥mx}=span{ψˆ1,…,ψˆct}+span{ψˆs:ψs∈Ψt∧s≥mx}.LetΨˆtbe the set of theψˆsthat generates the same space asΨt. ThenJ(ab,2)can be written as(60)J(ab,2)=∑t0≤t≤pyspanΨˆt⊗span{(y−y¯)t}From the order of theΨtwe deduce thati<j⇒Ψˆi⊂Ψˆj.This means that(61)ψˆs(y−y¯)t∈J(ab,2)⇒∀j=t,…,py,ψˆs(y−y¯)j∈J(ab,2)⇒∀j=t,…,py,Bs,j=ψˆs+1ϕˆj+1∈J(ab,2).Recalling Equations (58), (59) and (60) we deduce that it holdsBs,t=ψˆs+1ϕˆt+1∈J(ab,2)⇒∀j=t,…,py,ψˆs+1(y−y¯)j∈J(ab,2).It follows thatJ(ab,2)is generated by a subsetBa⊂B. From the symmetric result about the existence ofBg⊂Bthat generatesJ(gb,2)we deduce thatJ(ab,2)∩J(gb,2)=span(Ba∩Bg). Thus the intersection is generated by a subset ofB, contained in{Bs,t}s=s0,…,px;t=t0,…,py.Step 3 We now show thatBs,t∈Ba∩Bgif and only ifβs,t={(xs,yt)}is inE(ME)and thus#{β∈E(ME):β⊂Ξ−1(b)}=#(Bg∩Ba)=dim⁡(J(ab,2)∩J(gb,2)).We start by showing that(62)Bs,t∈Ba∩Bg⇐βs,t∈E(ME).Ifβs,tis a horizontally effective vertex ands≥mxthenψˆs+1=Cψs+1withC∈Rand thusψs+1∈Ψt⇔ψˆs+1∈Ψˆt. By the construction of Ψ as in Lemma 5.9 it follows that the analogous of Equation (56) holds (with a shift by one in the indexes of thexi) and thus there is a relation between the horizontal effectivity ofβs,tand the span of the horizontal lines atytand with the elements ofΨt. In particular we deduce thatψˆs+1∈Ψˆt. Recalling Equations (60) and (61) we conclude thatBs,t=ψˆs+1ϕˆt+1∈J(ab,2).Ifβs,tis horizontally effective ands<mxthenβs,tis not contained in any extension and thusΨtcontainsψ1,…,ψs+1. It follows from its definition in Step 1 thatψˆs∈spanΨt. Again by Equations (60) and (61)Bs,t=ψˆs+1ϕˆt+1∈J(ab,2).Concluding for alls=s0,…,pxit holds that the horizontal effectiveness ofβs,timplies thatBs,t∈J(ab,2). Similarly for allt=t0,…,pyit holds that the vertical effectiveness ofβs,timplies thatBs,t∈J(gb,2)and thus Equation (62) is proved.Remember that allβ∈F0(ME)are either horizontally or vertically effective, then ifβs,t∉E(ME), there are three cases:1.βs,tis not horizontally effective, but it is vertically effective;βs,tis not vertically effective, but it is horizontally effective;βs,tis not a vertex inF0(ME), and thus it is not horizontally nor vertically effective.In the third case then eitherβs,tis not contained in any extended horizontal line or it is not contained in any extended vertical line. If it is not contained in any horizontal line thenΨt⊂span{(x−x¯)i}i=s+1,…,pxand thus thatBs,t∉Ba. Similarly if it is not contained in any vertical lineΦs⊂span{(y−y¯)j}j=t+1,…,pyans thusBs,t∉Bg. Concluding ifβs,tis not inF0(ME)thenBs,t∉Ba∩Bg. □In this section we collect some examples that illustrate the polynomial spaces associated to edges of the polynomial-mesh. Since the definition ofJuses some information that is contained in the AST-mesh we will use a representation that mimics the polynomial-mesh while preserving the information of the index-T-mesh.We decided to limit the examples to the case of bi-cubic AST-splines as this is the most commonly used degree. The examples are ordered by complexity. Example 1 is a simple tensor-mesh, but it is used to make the graphical representation and the method clear.In this example we analyze a simple tensor-mesh consisting of three elements divided by a single and a double line. As usualMTis(Q,Ξ)whereQis a box-mesh of[1,8]×[1,11]with vertexes having integer coordinates. ToMTcorrespondsMEthat is a finer partition where the line extensions are added. For AST-meshes the polynomial-meshMPisΞ(ME). In order to make the representation more compact we use a hybrid representation in the examples that shows the underlying structure of the extended mesh inside the polynomial-mesh. In Fig. 4we show the extended mesh (left), the polynomial mesh (center) and the hybrid representation (right).There are two internal edges inMP:a1anda2. The edgea1is contained in the image of two edges ofME:α1andα2whilea2is contained only in the image ofα3. In this case eachαiis contained in a unique extended line, let it beextℓi∈L(MT).In order to computeJ(a2)it is necessary to computeJℓ3(α3). Sinceα3is not contained inbegℓ3∪endℓ3it follows from Equation (3) thatJℓ3(α3)=Ppxand thusJ(a2)=Ppx⊗span{(y−Ξy(5))3}.This is the condition forC2continuity acrossa2.Sincea1is contained inΞ(α1)andΞ(α2)thenJ(a1)depends on the values ofJℓ1(α1)andJℓ2(α2). Since neitherα1norα2is contained in any extension the associated spaces areJℓ1(α1)=Jℓ2(α2)=Ppx.In this case we can choose any basisΨ={ψ1,…,ψpx+1}ofPpxas a common basis. Then by definitionJ(a1)=span{ψi(y−Ξx(5))k}i=1,…,px+1;k=2,3=Ppx⊗span{(y−Ξy(5))2,(y−Ξy(5))3}.This isC1continuity acrossa2.This example is a simple AST-mesh that is not a tensor-mesh as there are three maximal linesℓ1,ℓ2andℓ3that are shorter then the horizontal span of the mesh. See Fig. 5.Reasoning as in Example 1 it is possible to computeJ(a2)=Ppx⊗span{(y−Ξy(7))3},J(a3)=Ppx⊗span{(y−Ξy(5))3},J(a5)=Ppx⊗span{(y−Ξy(5))2,(y−Ξy(5))3}.Sincea1is contained only inΞ(α1)it followsJ(a1)=Jℓ1(α1)⊗span{(y−Ξy(7))3}.By definitionJℓ1(α1)=SΘ1|[Ξx(6),Ξx(7)]whereΘ1=[Ξx(5),Ξx(6),…,Ξx(12)](in this specific case all indexes are present). Using Equation (1) we can conclude thatSΘ1|[Ξx(6),Ξx(7)]=span{(x−Ξx(5))3,(x−Ξx(6))3}and thusJ(a1)=span{(x−Ξx(5))3,(x−Ξx(6))3}⊗span{(y−Ξy(7))3}=span{(x−Ξx(5))3(y−Ξy(7))3,(x−Ξx(6))3(y−Ξy(7))3}.To computeJ(a4)we needJℓ2(α4)andJℓ3(α5). Sinceextℓ1andextℓ2contain vertexes at the same abscissa then the corresponding knot vector is the same andJℓ2(α4)=Jℓ1(α1). Sinceα2is not contained in any extension thenJℓ3(α5)=Ppx. The common basisΨ={ψ1,…,ψ4}is obtained by restricting the canonical basis ofSΘ2to[Ξx(6),Ξx(7)]whereΘ2isΘ2=[Ξx(5),Ξx(5),Ξx(5),Ξx(6),Ξx(7),Ξx(8),Ξx(8),Ξx(8)].It contains all the knots corresponding to vertexes in the extensions ofℓ2andℓ3and, in this case, the first and the last knots are repeated in order to have a basis ofPpx(see Lemma 4.3).NowJℓ2(α4)=span{ψ3,ψ4}and thusJ(a4)=span{ψ1(y−Ξy(5))3,ψ2(y−Ξy(5))3,ψ3(y−Ξy(5))3,ψ4(y−Ξy(5))3,ψ3(y−Ξy(5))2,ψ4(y−Ξy(5))2,}.Using Equation (1) it is possible to rewriteJ(a4)asPpx⊗span{(y−Ξy(5))3}+span{(x−Ξx(5))3,(x−Ξx(6))3}⊗span{(y−Ξy(5))2}.The conditions expressed byJ(a1)do not correspond toC2continuity acrossa1nor do those expressed byJ(a4)correspond toC1. In spite of thisT(MT)is the space of piecewise polynomials that areC2onΞ(extℓ1)∪a3andC1onΞ(extℓ2). This will be discussed in more detail in the next section.This example shows that different structures in the index-T-mesh can represent the same type of condition on the polynomial-mesh. In the mesh of Fig. 6the edgea1is contained in the image of a unique edge of the T-mesh, contrarilya2is contained in the image of two distinct edges, but the associated spaces differ only because of the different ordinate. For the reason discussed in the next session the gluing conditions corresponding toa1anda2are not equivalent to smoothness conditions. This trait is shared by those corresponding toa3.Hereα1is contained in two extended horizontal lines:extℓ1andextℓ2. Thus in order to computeJ(a1)we need bothJℓ1(α1)andJℓ2(α1). They are respectivelyJℓ1(α1)=SΘ1|[Ξx(6),Ξx(7)],Jℓ2(α1)=SΘ2|[Ξx(6),Ξx(7)],whereΘ1=[Ξx(1),…,Ξx(8)],Θ2=[Ξx(6),…,Ξx(16)].A common basis forPpxisΨ={ψ1,…,ψ4}given by the restrictions of the canonical basis ofS[Ξx(5),Ξx(5),Ξx(5),Ξx(6),Ξx(7),Ξx(8),Ξx(9),Ξx(9)]. It follows thatJℓ1(α1)=span{ψ4},Jℓ2(α1)=span{ψ1,ψ2},and thusJ(a1)=span{ψ1,ψ2,ψ4}⊗span{(y−Ξy(8))3}.To computeJ(a2)we needJℓ3(α3)andJℓ4(α2). The couple(ℓ3,α3)corresponds to(ℓ1,α1)by a vertical translation and thusJℓ3(α3)=Jℓ1(α1). SimilarlyJℓ4(α2)=Jℓ2(α1)and thusJ(a2)=span{ψ1,ψ2,ψ4}⊗span{(y−Ξy(6))3}.Note how the same type of continuity condition can be encoded with a different number of edges: one forJ(a1)and two forJ(a2).The space associate toa3isJ(a3)=span{(x−Ξx(10))3(y−Ξy(5))3}.In all previous examples all the vertical extended lines span the whole mesh and correspond toCksmoothness conditions. In this example we consider a more general case where both horizontal and vertical T-junctions are present. The mesh is in Fig. 7.Here a is contained inΞ(α1),Ξ(α2),Ξ(α3)andΞ(α4). To find a common basis for the spaces associated toαiby the operatorsJℓwithℓ∈Lh(MT)we use the restriction of the basis ofSΘwhere Θ is[Ξx(5),Ξx(5),Ξx(6),Ξx(8),Ξx(9),Ξx(10),Ξx(11),Ξx(11)].Note howΞx(7)does not appear in Θ. Indeed there is a horizontal extension that does not intersect any line at 7. LetΨ={ψ1,ψ2,ψ3,ψ4}be the common basis then by reasoning as in the previous examples we obtainJ(a)=span{ψ1(y−Ξy(5))3,ψ2(y−Ξy(5))3,ψ3(y−Ξy(5))3,ψ4(y−Ξy(5))3,ψ1(y−Ξy(5))2,ψ2(y−Ξy(5))2,ψ3(y−Ξy(5))2,ψ4(y−Ξy(5))2,ψ2(y−Ξy(5))1,ψ3(y−Ξy(5))1,ψ4(y−Ξy(5))1}Also g is contained in the image of four vertical edges:Ξ(γ1),Ξ(γ2),Ξ(γ3)andΞ(γ4). In this case the common basisΦ={ϕ1,ϕ2,ϕ3,ϕ4}ofPpyis the canonical basis ofS[Ξy(6),Ξy(6),Ξy(6),Ξy(8),Ξy(9),Ξy(10),Ξy(11),Ξy(11)]restricted to[Ξy(8),Ξy(9)]. The condition associated to g isJ(g)=span{(x−Ξx(5))3ϕ1,(x−Ξx(5))3ϕ2,(x−Ξx(5))3ϕ3,(x−Ξx(5))3ϕ4,(x−Ξx(5))2ϕ1,(x−Ξx(5))2ϕ2,(x−Ξx(5))2ϕ3,(x−Ξx(5))2ϕ4,(x−Ξx(5))1ϕ1,(x−Ξx(5))1ϕ2,(x−Ξx(5))1ϕ3,ϕ3}.The characterization of the AST-spline space provided in Section 5 uses complex gluing conditions on the inter-element boundaries. In some cases the same piecewise polynomial space can be equivalently defined in terms of required smoothness on the internal edges. This is possible also when the two conditions are not equivalent on edge by edge basis. In this section we describe a subset of AST-meshes for whichTis characterized by smoothness condition. We then apply the content of this section to the examples from the previous section.Theorem 7.1If the preimageΞ−1(b)of every vertexb∈F0(MP)intersect only extensions of the same type (i.e. horizontal begin extension or horizontal end extension or vertical begin extension or vertical end extension) and each extension intersects all the orthogonal segments contained inΞ−1(b)(seeFig. 8) thenT(MT)is the space of all piece-wise bivariate polynomials of degreepx,pyonMPwith the same smoothness as the AST-spline functions at the mesh lines. More precisely, fora∈F1h(MP)letJ˜(a)be(63)J˜(a)=Ppx⊗span{(y−y¯)k:k=k¯a,…,py}wherek¯a−1is the minimal degree in(y−y¯)of the functions inJ(a), or equivalentlypx−k¯ais the number of horizontal edges ofMEwhose image contain a. DefineJ˜similarly for vertical edges. ThenT(MT)=S(MP,J)=S(MP,J˜).Note thatS(MP,J˜)is the smallest piecewise polynomial space defined by smoothness conditions and containingT(MT). In particular the condition in Equation (63) corresponds toCk¯a−1smoothness across a. Note also thatJ˜can be defined as in Definition 4.4 by changingJℓtoJ˜ℓ(α)={{0}α⊄extℓ∨dim⁡Ξ(α)<1Ppxα=αi∧dim⁡Ξ(α)=1.ProofThe main idea is to compare the dimension ofT(MT)with that ofS(MP,J˜). In order to simplify the proofs it is convenient to introduce an intermediate step where only the conditions associated to horizontal edges are changed. LetJˆ(a)={J(a)a∈F1v(MP)J˜(a)a∈F1h(MP)andJˆ,Sˆbe the complexes associated toJˆ. We prove thatdim⁡S(MP,Jˆ)=dim⁡S(MP,J); the proof thatdim⁡S(MP,J˜)=dim⁡S(MP,Jˆ)is similar and is not detailed.Both the dimension ofS(MP,J)anddim⁡S(MP,Jˆ)can be expressed with Equation (23) and their difference is:(64)dim⁡S(MP,Jˆ)−dim⁡S(MP,J)=dim⁡H0(Jˆ⁎)+∑i=02(−1)i(dim⁡Sˆi−dim⁡Si).First we prove thatH0(Jˆ⁎)={0}. We identifyJ⁎with a sub-complex ofJˆ⁎. This is possible becauseJˆ(a)⊃J(a)for alla∈F1I(MP). Then we show that allρ∈Jˆ0are equivalent to aρ′∈J0and thus, by Theorem 4.8, to 0. We can assume that for allρ∈Jˆ0the following holds: for eachb∈F0I(MP)(65)ρ|b∈Jˆ(ab,1)+Jˆ(ab,2).IndeedJˆ0|b=Jˆ(ab,1)+Jˆ(ab,2)+J(gb,1)+J(gb,2), butJ(gb,1)+J(gb,2)is contained inJ0and thus it is equivalent to 0 (Theorem 4.8).We decompose ρ inρ=∑ℓ∈Lh(MP)ρℓwhere for allb∈F0(MP)not contained in ℓρℓ|b=0. Consider ℓ fixed and lety¯be its ordinate. We can further decomposeρℓinρℓ=∑k=0pyρkwhere for each b,ρk|b∈Ppx⊗span{(y−y¯)k}. We prove that eachρk≈0.To prove this we decomposeJˆ⁎|ℓasJˆ⁎|ℓ=⨁k=0pyJˆ⁎,kwhereJˆi,k|e=Jˆi|e∩Ppx⊗span{(y−y¯)k}for eache∈Fi(MP). Letℓkbe the subset of ℓ where the associated smoothness condition (in the vertical direction) is at leastCk−1: i.e.ℓkis a union of the edgesa∈F1(MP)contained in ℓ and such thatJˆi,k|e≠{0}. Let alsoVk={b∈F0I(MP):b⊂lk}andEk={a∈F1I(MP):a⊂ℓk}. Assume thatℓkis connected, otherwise what follows applies to the restriction ofJˆi,kto each connected component ofℓk. Since for eacha∈Ek,Jˆ(a)⊃Ppx⊗span{(y−y¯)j:k≤j≤py}the homology classes ofH0(Jˆ⁎,k)are described byρk≈ρk′⇔∃θ∈Jˆ1,k:ρk=ρk′+δ1θ⇔∑b∈Vkρk′|b=∑b∈Vkρk|b.Recalling Equation (1) and noting that eachℓkcontains at least the image ofpx+1edges of the extended mesh we deduce that for eachq∈Ppx⊗span{(y−y¯)j:k≤j≤py}there existsρk′∈J0supported inℓkand such that∑b∈Vkρk′|b=q. Thus the restriction ofρktoℓkis equivalent toρk′and thus by Theorem 4.8 to 0. From Equation (65) we deduce that there is no vertexesb∈Vknot included inℓkfor whichJˆ0,k|b≠{0}and thus thatρk≈0. Since this applies to allρkthen alsoρ|ℓ≈0and in the same wayρ≈0. Concluding allρ∈Jˆ0are in the same homology class andH0(Jˆ⁎)={0}.Second we check thatdim⁡S(MP,Jˆ)=dim⁡S(MP,J). Expanding Equation (64) we get(66)dim⁡S(MP,Jˆ)−dim⁡S(MP,J)=∑b∈F0I(MP)(dim⁡J0|b−dim⁡Jˆ0|b)−∑a∈F1I,h(MP)(dim⁡J1|a−dim⁡Jˆ1|a).By our assumptions the preimage of each vertexb∈F0(MP)intersects only extensions of the same type. When it does not intersect any extension thenJ1|ab,1=Jˆ1|ab,1;J1|ab,2=Jˆ1|ab,2;J0|b=Jˆ0|b.WhenΞ−1(b)intersects horizontal begin extensions thendim⁡Jˆ0|b−dim⁡J0|b=dim⁡Jˆ1|ab,2−dim⁡(Jˆ1|ab,2∩J0|b)From the hypothesis that all horizontal extension intersect all vertical lines inΞ−1(b)and the fact thatJ(gb,1)=J(gb,2)=span{(x−x¯)s:px+1−my≤s≤px}⊗Ppywheremyis the number of vertical lines, we deduce thatJˆ(ab,2)∩J(gb,1)=span{(x−x¯)s(y−y¯)t:px+1−my≤s≤px,py+1−mx≤t≤pz}=J(ab,2)∩J(gb,1).ThusJˆ1|ab,2∩J0|b=J1|ab,2and(67)dim⁡Jˆ0|b−dim⁡J0|b=dim⁡Jˆ1|ab,2−dim⁡J1|ab,2.Similarly ifΞ−1(b)intersects horizontal end extensions then(68)dim⁡Jˆ0|b−dim⁡J0|b=dim⁡Jˆ1|ab,1−dim⁡J1|ab,1.From Equations (67) and (68) we deduce that Equation (66) holds. Indeed while considering the horizontal edges and vertexes contained in the same maximal line ℓ there is a one-to-one correspondence between addenda of opposite sign. Thusdim⁡S(MP,Jˆ)=dim⁡S(MP,J).By the same argument withJ˜in place ofJˆ,Jˆin place ofJand vertical lines in place of horizontal lines we conclude thatdim⁡S(MP,J˜)=dim⁡S(MP,Jˆ)=dim⁡S(MP,J)=T(MT).□We now return briefly to the examples in the previous section and discuss the applicability of Theorem 7.1. The hypothesis of the theorem hold true for the mesh in Example 2. In this case the double characterization means that for any piecewise polynomial that isC2onΞ(extℓ2)it holds that the difference of the polynomial expressions in the rectangles above and belowa1is not only contained inPpx⊗span{(y−Ξy(7))3}, but it is also contained inJ(a1).The mesh in Example 3 does not allow for an equivalent characterization. We can first note that the hypothesis of the theorem is not satisfied: indeed the preimages of(Ξx(6),Ξy(6)),(Ξx(7),Ξy(6)),(Ξx(8),Ξy(6))and(Ξx(6),Ξy(8)),(Ξx(7),Ξy(8)),(Ξx(8),Ξy(8))intersect extensions of different types (begin and end horizontal extensions). Moreover the preimage of(Ξx(10),Ξy(5))intersects an extension that does not intersect all vertical segments. This is not enough to conclude that a characterization based on smoothness condition is impossible, but we can analyze each of the three horizontal lines separately.It is not possible to replace the gluing condition onΞ(extℓ1)∩Ξ(extℓ2)with aC2condition. Indeed aC2condition corresponds to replacingℓ1andℓ2with a single lineℓ=[3,15]×{8}. With this change the vertex{(7,8)}becomes an anchor and thus the space dimension increases.Similar considerations hold for the condition onΞ(extℓ3)∩Ξ(extℓ4). Indeed theC2condition corresponds to replacingℓ4with[7,15]×{7}or alternativelyℓ3with[3,7]×{6}. With both modification a new anchor is introduced:{(7,7)}or{(7,6)}respectively and thus also in this case the condition is more restrictive thenC2continuity. Remark that replacingℓ4with[7,15]×{7}allows for an equivalent characterization withC2smoothness conditions acrossΞ(extℓ3)∩Ξ(extℓ4)even if the modified mesh does not satisfy the hypothesis of Theorem 7.1.Also the condition on the end extension ofℓ5is stricter that theC2condition. Indeed by prolongingℓ5to[3,11]×{5}the obtained conditions are still weaker thanC2smoothness acrossa3, but we obtain three new anchors ({(9,5)},{(10,5),{(11,5)}}) and thus a bigger space.

@&#CONCLUSIONS@&#
