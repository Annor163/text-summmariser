@&#MAIN-TITLE@&#
Piecewise Whittle estimator for trabecular bone radiograph characterization

@&#HIGHLIGHTS@&#
Taking into account the nature of the trabecular bone data on radiographs, we use an appropriate model.We propose a new effective method of the Hurst exponent which better consider the nature of the data.Different estimators are compared to discriminate two different populations composed of healthy controls and osteoporotic patients.Results show that our new proposed estimator provides effective results in terms of discrimination of the two populations.

@&#KEYPHRASES@&#
Fractional Brownian motion,Whittle estimator,Bone X-ray,Osteoporosis,

@&#ABSTRACT@&#
Osteoporosis is a disease in which low bone mass and microarchitectural deterioration of bone tissue lead to increased bone fragility and a consequent increase in fracture risk. The objective of this paper is to develop and validate a new method to assess bone microarchitecture on radiographs. Taking into account the piecewise fractal nature of bone radiograph images, an appropriate fractal model (piecewise fractional Brownian motion) is used to characterize the trabecular bone network. Based on the Whittle estimator, a new method for calculating the Hurst exponent H is developed to better consider the piecewise fractal nature of the data. Different estimators are used and compared to the proposed method to discriminate two populations composed of healthy controls and osteoporotic patients. Our findings demonstrate that the new estimator proposed here provides effective results in terms of discrimination of the subjects and is better adapted to bone radiograph image analysis.

@&#INTRODUCTION@&#
Osteoporosis is defined as a skeletal disorder characterized by compromised bone strength predisposing to an increased risk of fracture [1]. The most common method for osteoporosis diagnosis is to estimate Bone Mineral Density (BMD) by dual-energy X-ray absorptiometry [2]. However, BMD alone represents only 60% of fracture prediction. The characterization of trabecular bone microarchitecture has been recognized as an important factor and completes the osteoporosis diagnosis using BMD [3], but it cannot be routinely obtained by noninvasive methods and requires a bone biopsy with histomorphometric analysis. This is why several attempts have been made to characterize trabecular bone microarchitecture by noninvasive methods [4–6].The main question is how to improve the early diagnosis of osteoporosis and judge the porosity of the bone on X-ray radiographs. For this purpose, different methods have been extensively explored; some of them present certain limitations and are still under investigation [7–9]. Many models have been proposed to characterize and estimate parameters linked to bone fragility in order to discriminate people with and without osteoporosis. For several years, many researchers have considered models for describing irregular processes that are relevant to this issue. The advent of fractals to describe complex structures in biology and medicine such as trabecular bone has been recognized as an effective tool [10–12]. Fractal objects are characterized by a high degree of complexity but also by self-similarity represented by a repetition of patterns or statistical properties over different scales. This property of self-similarity enables the characterization of complex images by a unique parameter: the fractal dimension D. Among these models, the fractional Brownian motion (fBm) model has shown potential usefulness for the characterization of gray level images.FBm has been shown to be well suited for the fractal analysis of trabecular bone texture on calcaneus radiographs [13–15]. Several studies have modeled the trabecular bone texture using fractals, but without considering the nature of the data (fractal or not fractal) and the adequacy of the fBm model for the characterization of bone texture on radiographs. An increasing number of papers provide a theoretical basis for calculating the fractal behavior of cancellous bone in radiographs, but to the best of our knowledge very few studies deal with the selection of the processing and calculation methods which can provide a consistent and reliable determination of the fractal dimension.These empirical findings suggest that it is necessary to find suitable tools taking into account situations where the classical fBm model shows its limits. This is the case of generalized multifractal motion where H can evolve over time [16]. However, this process does not have stationary increments. Another generalization of fBm was proposed and called fBm of order n[17]. The H parameter of this process varies between n−1 and n, where n is a positive integer. On double self-similarity, a first approach in this direction was proposed in [18] and was called fractal signature. But this approach has no established theoretical basis. Other approaches based on fBm models were proposed in [19,20]. They consist of filtering or generalizing the fBm from its structure function [21]. However, these models have a complex analytic definition, and some difficulties arise in the range of variation of the process parameters or in the choice of the filter. A new model known as asymptotic fBm enables short- and long-term correlation effects to be controlled independently [22]. However, the H parameter which governs the long-term dependency can evolve only between 0.5 and 1. Moreover, the link between this model and fBm is not direct.One of the present authors introduced a model called piecewise fractional Brownian motion model (p-fBm) which appears to be more appropriate for bone radiograph characterization [23]. The p-fBm model is governed by 3 parameters: Ho at low frequencies, Hi at high frequencies, and a cut-off frequency γ which separates the two regimes. For Ho=Hi=H, the p-fBm process is reduced to the classical fBm. The p-fBm makes it possible to generalize the class of fBm signals and thus provides a more suitable tool for bone characterization. Indeed, as can be seen in Fig. 2, in a log–log scale, the Power Spectral Density (PSD) of the derivative of the lines of bone radiograph images presents two different fractal regimes.The use of any model involves finding estimators for the parameters of the model. Different estimators have been used to calculate the H parameter. Istas and Lang developed an efficient estimator (ILE) [24] based on the generalization of the quadratic variations of the Gaussian process; this estimator provides good results. The box counting [25,26] and the mathematical morphology methods [27] are based on the properties of geometric fractals. They consist in measuring a geometrical parameter at different scales, and regression in a log–log scale is then used to find a fractal dimension. These methods are biased, suffer from problems related to sampling and are not well suited for trabecular bone characterization [28]. Among the other techniques which provide promising results, the Wavelet Estimator (WE), a multi-scale approach, is efficient in terms of estimated average, but the variance is rather large [29,30]. In the frequency domain, two approaches can be deduced from the properties of the fBm model: the Brownian Spectral Estimator (BSE) and the Gaussian Spectral Estimator (GSE) [31]. These kinds of methods provide poor results due mainly to the non-stationarity of the process. The second estimator (GSE) uses the increments of the fBm and provides better results than the BSE, both in terms of bias and of variance. In the temporal domain, the maximum likelihood estimator (MLE) [32] was proposed; it is based on the statistical properties of the fBm model. The MLE is theoretically efficient in terms of bias and variance and has demonstrated competitive performances. An efficient approximation of the MLE called the Whittle Estimator (WhE) in the frequency domain was developed in [33]. This method is fast and provides good results in terms of bias and variance.The objectives of this paper are twofold: first, to use a model better suited for the characterization of trabecular bone texture, namely, the piecewise fractional Brownian motion model (p-fBm) [23]; second, to propose a new variant of the efficient Whittle Estimator that is well adapted for p-fBm processes. This new estimator called the piecewise Whittle Estimator (p-WhE) makes it possible to estimate the two parameters Ho and Hi of the p-fBm. Our objective is to compare the p-WhE method to different estimators to discriminate two populations composed of 80 osteoporotic (OP) patients and 80 control (CT) subjects.This paper is organized as follows: Section 2 presents the theory, where the classical fBm and the p-fBm models are introduced. The different estimators are also described. In Section 3, the comparison of different methods and the proposed estimator on trabecular bone texture is presented. The results are given in Section 4. A discussion and some conclusions with guidelines for further work are presented in Section 5.This section presents the theory of the classical fractional Brownian motion model and introduces the piecewise fractional Brownian model.FBm is a stochastic fractal process that models 1/f spectrum, long-range dependence, and self-similar behaviors developed by Mandelbrot and Van Ness [34] as a generalization of classical Brownian motion (H=0.5) [34]. This process is governed by a unique parameter, the Hurst exponent H (0<H<1) which is linked to the fractal dimension by H=E+1−D, where E is the Euclidian dimension.The spectral representation of fBm, BH(t) is given by [35]:(1)BH(t)=12π∫−∞+∞1(iω)H+1/2(eitω−1)dB(ω).It is a Gaussian, continuous, centered, and non-stationary second-order process. With the initial condition BH(0)=0, its covariance function, denoted r, is given by:(2)rBH(i,j)=E[BH(i)BH(j)]=a2VH2(|i|2H+|j|2H−|i−j|2H),where E[.] is the mathematical expectation, a is a constant and VHa function of H defined as [36]:(3)VH=Γ(1−2H)cos(πH)πH,where Γ is the gamma function.The main property of fBm is its statistical self-similarity, which means that the same properties can be observed at different scales. It is expressed as:(4)BH(km)≡kHBH(m);∀kandm>0As fBm is a non-stationary process, it is more convenient to study its increments, called fractional Gaussian noises (fGn), which are stationary. The fGn, Gm, is defined as the derivative of fBm at a resolution m:(5)Gm(i)=BH(i)−BH(i−m)The covariance function, r, fully describes the fGn process, with:(6)rGm(τ)=E[Gm(i)Gm(i+τ)]=σm22|m|2H(|τ+m|2H−2|τ|2H+|τ−m|2H)whereσm2=a2VH|m|2His the variance of Gm.For 0<H<0.5, the correlation is negative. For H=0.5, this process is the Gaussian white noise; and for 0.5<H<1, the correlation is positive. Moreover, for high values of τ, the covariance function varies as τ2H-2. In this case we refer to long memory or long dependence processes [37].The power spectral density (PSD) of the fGn can be calculated from Eq. (6), and when m→0, a normalized spectrum of the fGn can be defined [30]:(7)PSDGm(f)∝|f|1−2HIn a log–log scale, the PSD of an fBm process is a line of slope (1−2H).As shown in Section 3, for trabecular bone texture, the PSD presents several fractal regimes with different slopes, hence the interest of the piecewise fractional Brownian motion model (p-fBm) presented in the next section.In classical fBm, the Hurst parameter H corresponding to one frequency regime describes the process completely, but a unique frequency regime or self-similar behavior is not sufficient for certain data observed since the process 1/f cannot be present in practice for both very low and very high frequencies. In practice, we study only a limited zone in 1/f. In some cases such as in bone radiographs, there is not one, but two areas of fractal parameters: Ho for low frequencies and Hi for high frequencies. These two areas are separated by a cut-off frequency γ. Such processes can be modeled by the p-fBm model, denoted BHo,Hi,γand defined by 3 parameters, Ho, Hi and γ, 0<Ho<1, 0<Hi<1 and γ>0. The p-fBm is given by:(8)BHo,Hi,γ(t)=12π∫−∞+∞FHo,Hi,γ(ω)(eitω−1)dB(ω)where(9)FHo,Hi,γ(ω)=1[0,γ)(|ω|)(iω)Ho+1/2+γHi−Ho1[γ,ω)(|ω|)(iω)Hi+1/21I(ǀωǀ) is the indicator function over the interval I (i.e. 1I(ǀωǀ)=1 if ω∈I, 1I(ǀωǀ)=0, otherwise). The continuity in γ is ensured by the factor γHi−Ho. p-fBm is a Gaussian, continuous and non-stationary process. When H=Ho=Hi ∈]0, 1[, the p-fBm is reduced to the classical fBm of parameter H.As for fBm, the increment processes of p-fBm, denoted byGHo,Hi,γuand called piecewise fractional Gaussian noises (p-fGn), are defined as:(10)GHo,Hi,γu(t)=BHo,Hi,γ(t+u)−BHo,Hi,γ(t)where the lagu∈Ris fixed. Their covariancerHo,Hi,γu,vis given by [23]:(11)rHo,Hi,γu,v(τ)=12π∫−∞+∞2sinωu22sinωv2e(i(u−v)ω)/2|FHo,Hi,γ(ω)|2eiωτdω.when u=v, the PSD of the p-fGn is:(12)PSDGHo,Hi,γu(ω)∝4sin2ωu2|FHo,Hi,γ(ω)|2The p-fBm process has two asymptotic self-similarity regimes [23]. For a large scale of observation, the process behaves like a self-similar process with parameter Ho, and for a closer scale of observation, the process is governed by the self-similar parameter Hi.Different estimators have been used to estimate the H parameter of the fBm. They are divided into temporal, multi-scale, spectral, and fractal-geometry-based groups and differ in bias and variance of the results produced. Our objective is not to present an exhaustive list of the different estimators but rather to demonstrate the relevance of our proposed method to access osteoporosis on bone radiographs. For this reason we have chosen four estimators commonly used by the scientific community which provide efficient results in terms of discrimination of different populations for bone diagnosis.The ILE was developed by Istas and Lang [24] and is based on the generalization of the quadratic variations of the Gaussian process. If {BH(p/N)}p=0,…,N, denotes the discretized fBm process, the quadratic variation of the process is given by:(13)V˜N=∑p=0N−1BHk+1N−BHkN2Guyon and Léon [38] have shown thatN2H−1V˜Nconverges asymptotically to a strictly positive deterministic constant c when N→+∞; therefore,(14)H˜N=121+logV˜NlogNconverges asymptotically to H when N→+∞. In order to obtain a standard Central Limit Theorem for all the values of H ɛ]0, 1[, Istas and Lang proposed replacing the Quadratic VariationV˜Nby a Generalized Quadratic Variation (GQV). For example,(15)VN=∑p=0N−2BHp+2N−2BHp+1N−BHpN2By making use of GQV, Istas and Lang constructed asymptotically normal estimators of Hurst exponents for a wide class of Gaussian stationary increment processes, which includes fBm.Wavelet-based approaches are used in several domains and have provided efficient results. Wavelet decomposition shows that the non-stationarity of the process is found only in the low frequency signal. The signals of the details are stationary and decorrelated [30]. When split to dyadic wavelets, the variance of signals of details djat a scale j follows the law:(16)Var(dj[n])∝(2j)2H+1and(17)Log2(Var(dj[i]))=−(2H+1)j+constantThe H parameter can be estimated by linear regression using Eq. (17). Any Daubechies wavelet [39] with more than two zero moments is suitable. For the effective implementation of this method, the edge effects due to filtering can result in wrong values. The polluted samples are ignored in calculations. To reduce these edge effects, we chose a wavelet as small as possible (a Daubechies wavelet with 4 coefficients).This method has the common characteristic of relying on the overall shape of 1/f spectra of the increments of the fBm. The final step is a regression in log–log scale to estimate the H parameter.Eq. (7) shows that the PSD follows a law in |f|1−2H. In a log–log scale, the PSD function of the frequency is a line of slope 1−2H. The H parameter can be estimated by linear regression. With regard to the implementation, the average spectrum is estimated by the square of the modulus of the Fourier transform obtained by the Fast Fourier Transform (FFT) algorithm.In the temporal domain, the maximum likelihood estimator (MLE) [32] is based on the statistical properties of the fBm model. This estimator provides efficient results in terms of bias and variance. Nevertheless, for medical applications, it is preferable to use fast algorithms with real time execution. The MLE method is time and memory consuming and is hence hardly applicable for large sized samples. For these reasons an efficient approximation called Whittle in the frequency domain was developed [33] which is asymptotically efficient for the increments of fBm [40]. The Whittle approximation of the Likelihood Function (LF) calculates the LF in the spectral domain. It involves looking for the minimum distance between the spectra of the characterized process and that of the theoretical model. If x is the vector of increments supposed to be an fGn, the Whittle Likelihood Function (WLF) of x can be written in the discrete case as [37]:(18)WLF(x;H,c)=∑j=1m−Ln[T(j;H,c)]−P(j)T(j;H,c)where ⌊m⌋ is the integer part of (N−1)/2, T is the theoretical power spectral density of the fGn process, P is the periodogram of the vector x and c is a proportionality constant.To find the maximum of the WLF function, T is decomposed as cT′ and taking the derivative relative to c to zero, we get:(19)c=∑j=1mP(j)∑j=1m*T′(j,H)The H parameter estimated by the WhE,HˆWEis given by:(20)H⌢WhE=Max0<H<1∑j=1m−LncT′(j;H)−P(j)cT′(j;H)T′ can be calculated from the PSD of the fGn or as the Fourier transform of the covariance matrix of the fGn. The computational complexity of the WhE is O(NLogN) and the memory required is O(N), which is more convenient than the classical MLE.Contrary to fBm which is governed by a unique parameter, H, p-fBm is governed by 3 parameters: Ho for low frequencies, Hi for high frequencies, and γ, a cut-off frequency which separates the two regimes. Taking into account the two regimes and based on the classical Whittle Estimator, we propose a new estimator that is more convenient for p-fBm processes, the piecewise Whittle Estimator (p-WhE). In this case, the piecewise Likelihood Function (pWLF) to be minimized is:(21)pWLF(x,Ho,Hi,γ,co,ci)=∑j=1γ−Ln[To(j;Ho,co)]−Po(j)To(j;Ho,co)+∑j=γm−Ln[Ti(j;Hi,ci)]−Pi(j)Ti(j;Hi,ci)To and Ti are respectively the theoretical power spectral densities of the pfGn process in low and high frequencies, Po and Pi are respectively the periodograms of the vector x in low and high frequencies, and coand ciare two proportionality constants in low and high frequencies respectively.To find the maximum of the pWLF function, To and Ti are decomposed as coTo′ and ciTi′ respectively. Taking the derivatives relative to coand cito zero, we get in low frequencies:(22)co=∑j=1γPo(j)∑j=1γTo′(j,Ho)and in high frequencies:(23)ci=∑j=γmPi(j)∑j=γmTi′(j,Hi)The Ho and Hi parameters estimated by the maximum likelihood of Whittle (p-WhE) are:(24)H⌢opWhE=Max0<Ho<1∑j=1γ−Ln[coTo′(j;Ho)]−Po(j)coTo′(j;Ho)(25)H⌢ip-WhE=Max0<Hi<1∑j=γm−Ln[ciTi′(j;Hi)]−Pi(j)ciTi′(j;Hi)The cut-off frequency γ corresponds to the peak of the periodogram (Fig. 2d) and is computed as the maximum of the global periodogram including the low and the high frequencies. To′ and Ti′ can be calculated from the PSD of the fGn or as the Fourier transform of the covariance matrix of the fGn, in low frequencies (for To′) and in high frequencies (for Ti′). In the next section, we give further details of the proposed approach to estimate Ho and Hi parameters on bone radiograph images.This section describes the protocol of the clinical study, the data acquisition and the application of the described methods to characterize the data. Two populations composed of osteoporotic (OP) patients and control (CT) subjects were involved in this study.All the OP patients (fracture cases) and CT subjects voluntarily entered the study after written informed consent. Patients were systematically screened from all women attending the bone densitometry unit for routine clinical care and from patients hospitalized in the rheumatology, orthopedic and geriatric units. For each fracture case recruited, we enrolled control cases paired for age (±5 years) and Body Mass Index (BMI) (±2kg/m2). This study involved 160 women, 80 controls aged 68.93±9.78 SD and 80 osteoporotic fracture cases aged 71.34±10.55 SD. BMI values were 25.73±4.10 SD and 26.21±4.38 SD for the CT and OP populations, respectively. No significant difference was found either for the age (p-value NS) or for the BMI (p-value NS).All the patients filled out an osteoporosis risk questionnaire that included: age, personal and family history of fracture, tobacco (yes or no) and alcohol (yes or no) consumption, menopausal status (time since menopause), use of hormone replacement therapy (HRT) (yes or no, treatment duration), treatment by oral corticosteroids (yes or no, dose and duration), other medication and other diseases (rheumatoid arthritis, etc.). Participants were also asked if they needed to use their arms to assist themselves in standing up from a sitting position and what physical activity they took (less or more than two hours per week for the following activities: walking, gardening, sport, etc.). Patients treated with corticosteroids, fluoride, bisphosphonates, HRT, or calcitonin for more than six months in the previous year were excluded from the study. We also excluded patients with known diseases which could interfere with bone metabolism: osteomalacia, bone cancer, myeloma, Paget's disease, hyper parathyroidism, untreated hyperthyroidism, severe renal or hepatic insufficiency, prolonged immobilization (more than two months in the previous year). CT cases were excluded in the case of treatment or disease which could interfere with bone metabolism.Images were obtained on calcaneus bone with a direct digital X-ray prototype (BMA™, D3A Medical Systems, Orleans, France) [13]. We used the calcaneus because of the limited soft tissues surrounding this bone. Soft tissues could increase the variability of the method. The study of the calcaneus seems relevant because it contains 90% of trabecular bone [41] and is a good predictive site of fracture in terms of bone mineral density [41].The devices for the study were cross-calibrated. The cross-calibration procedure has been described in [42]. The same radiographic parameters were used for the prototypes. Focal distance was set at 1.15m. The X-ray parameters were 55kV and 20mAs for all patients. Scanning the heel permitted the selection of a similar measurement site (ROI) for each subject by using anatomical landmarks as previously described [43]. These anatomical landmarks were localized by the operator on the image, allowing positioning of the ROI (1.6×1.6cm2) performed by the software device (Fig. 1). Then the H parameter which describes the texture was calculated using different approaches on the ROI to evaluate the bone microarchitecture quality.Fig. 2illustrates an example of a line extracted from a calcaneus texture ROI of a patient; we can notice the non-stationarity of the signal (Fig. 2b). As recalled above, the increments of fBm are easier to study due to their stationarity; this can be observed in Fig. 2c.Bone trabeculae are organized so as to supply a mechanical resistance adapted to various constraints. Trabeculae in the directions undergoing weak constraints are less numerous and less thick. A precise analysis of the mean periodogram of the increments of the lines extracted from the ROI is presented in Fig. 2d. As can be seen, due to the complexity of the trabecular bone structure, the periodogram reveals two fractal areas separated by a cut-off frequency γ. Thus, the fBm model is not well adapted for the characterization of such data. For this reason we propose to employ the p-fBm model to better characterize these data. In this case, the first area, in the low frequencies, is governed by Ho, while the second area, in the high frequencies, is ruled by Hi.

@&#CONCLUSIONS@&#
