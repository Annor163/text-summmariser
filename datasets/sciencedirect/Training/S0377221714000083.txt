@&#MAIN-TITLE@&#
The multi-item newsvendor model with cross-selling and the solution when demand is jointly normally distributed

@&#HIGHLIGHTS@&#
We model the multi-item newsvendor problem considering cross-selling effect.We derive the first-order optimality conditions for the centralized model.The pure-strategy Nash equilibrium conditions of the competitive model are developed.Develop efficient algorithms to solve the centralized and the competitive models.Provide insights into the influences of cross-selling on newsvendor decision.

@&#KEYPHRASES@&#
Inventory,Multi-item newsvendor,Cross-selling,

@&#ABSTRACT@&#
Products are often demanded in tandem because of the cross-selling effect. The demand for an item can increase if sales of its cross-selling-associated items are achieved or decrease when the associated items are out of stock, resulting in lost sales. Therefore, a joint inventory policy should be pursued in a cross-selling system. This paper introduces customer-driven cross-selling into centralized and competitive newsvendor (NV) models by representing an item’s effective demand as a function of other items’ order quantities. We derive first-order optimality conditions for the centralized model in addition to pure-strategy Nash equilibrium conditions and uniqueness conditions of the equilibria for the competitive model. We further develop gradient-based (GB) and iteration-based (IB) algorithms to solve the centralized and competitive models, respectively. A computational study verifies the effectiveness of the proposed algorithms. The computational results show that a larger cross-selling effect leads to a larger order quantity in a centralized NV model but a smaller order quantity in a competitive NV model, and a larger positive correlation between items’ demands leads to higher profits with smaller order quantities in both models. Moreover, NVs will order more items if the demand variance is greater, however resulting in lower profits. In a competitive situation, one will prefer smaller order quantities than in a centralized decision situation.

@&#INTRODUCTION@&#
The classical newsvendor (NV) model is a single-period problem that maximizes the expected profit under stochastic demand by determining a product’s optimal order quantity. The NV model typically assumes that inventory remaining at the end of a planning period can be disposed of at a price lower than the unit purchasing cost. In recent decades, the academic literature on single-period inventory management has been replete with newsvendor problems, although new models continue to emerge. A comprehensive review of newsvendor research prior to 1999 is available in Khouja (1999), and a recent review that extends the work of Khouja (1999) by considering several specific extensions can be found in Qin, Wang, Vakharia, Chen, and Seref (2011).There are two types of models that extend the classical NV model to analyze multi-item inventory systems. One is a NV model with constraints, e.g., storage, budget, or weight constraints, integrating multiple items together for a joint decision (Abdel-Malek & Montanari, 2005a, 2005b; Chen & Chen, 2010; Khouja & Mehrez, 1996). The other type of model considers the demand relationships between items. One of the most popular topics is the newsvendor problem with substitutions. However, cross-selling was rarely introduced into newsvendor formulations, even though it creates an important mutual relationship between items. This paper investigates the newsvendor problem by introducing cross-selling into multi-item NV models. As an initial comparison, we briefly review the NV model with substitutions.An unsatisfied customer may select another product that is similar to the original choice in function, color, style, size, or price as a substitute. Assuming that each item is a substitute for another item, Parlar and Goyal (1984) proposed a two-item newsboy model. Khouja, Mehrez, and Rabinowitz (1996) developed the lower and upper bounds of order quantities for a two-item NV model and presented a numerical algorithm employing a Monte Carlo simulation. Rajaram and Tang (2001) proposed a service rate heuristic for solving the centralized NV model with normally distributed demand for substitutable items. Parlar (1988) extended the problem to consider the competitive situation and proposed a two-item competitive model with substitutions. Lippman and McCardle (1997) further developed the multi-item competitive NV model with substitutions and proved the existence of the pure-strategy Nash equilibrium. Netessine and Rudi (2003) derived first-order conditions for both the multi-item centralized and competitive NV models with demand substitutions and proved the uniqueness of the Nash equilibrium. Huang, Zhou, and Zhao (2011) reinvestigated the competitive NV model with demand substitutions by considering the shortage penalty cost and proposed an iterative algorithm. For more extensive literature related to this topic, please see Bitran and Dasu (1992), Bassok, Anupindi, and Akella (1999), Smith and Agrawal (2000), Mahajan and van Ryzin (2001), and Dutta and Chakraborty (2010).As for the mutual effect among the demands for different items, the ability to substitute is obviously a promoting factor for the substitutable item when original choices are out of stock. However, the existence of cross-selling may produce opposing effects in contrast to the substitution. Cross-selling implies that “a customer who has purchased a particular product may also be willing to purchase a related product” (Shen & Su, 2007) or that some items are always purchased together due to their unknown interior associations (Anand, Hughes, Bell, & Patrick, 1997). If one of a set of jointly demanded items is out of stock, the sales pattern for the associated items will be altered and demand for the other item in this set may decrease as a result (Wong, Fu, & Wang, 2005; Zhang, 2012; Zhang, Kaku, & Xiao, 2011). Cross-selling can be seen as a type of complementary pattern that is the distinct opposite of substitution.Although the cross-selling effect may result in sales losses when some items are out of stock, one can also take advantage of the cross-selling effect to create new sales opportunities (Kamakura, Ramaswami, & Srivastava, 1991; Knott, Hayes, & Neslin, 2002; Kotler & Connor, 1977). In this case, the cross-selling is driven by vendors. Many studies on cross-selling have emerged in subject areas such as sales marketing, financial services, customer behavior, and data mining. One can refer to Yasar and Andy (2002), Kamakura, Wedel, de Rosa, and Mazzon (2003), Ansell, Harrison, and Archibald (2007), Salazar, Harrison, and Ansell (2007), Chuang and Lin (2008), Günes, Akşin, Örmeci, and Özden (2010), and Li, Sun, and Montgomery (2011) for the related topics. However, academic research on cross-selling in operations management does not account for a substantial proportion of the literature.Akşin and Harker (1999) explored the trade-offs between service and sales in the operation of call centers in retail banking. They indicate that “cross-selling can have detrimental effects on customer service due to the additional load it creates on the system”. Güneş and Akşin (2004) further studied the worth of undertaking a value-creation initiative such as cross-selling. Byers and So (2007) proposed a queuing model for optimizing control policies for cross-selling in telephone service centers, where the probability of a successful cross-sale for the existing customer is uniformly distributed. Gurvich, Armony, and Maglaras (2009) investigated a call center with cross-selling capability and studied the operational decisions for staffing, call routing, and cross-selling according to various forms of customer segmentation. They assumed that the probability of a customer accepting a cross-selling offer was an arbitrary non-increasing continuous function of the customer wait time. Aksin, Armony, and Mehrotra (2007) administered a state-of-the-art survey and reported that cross-selling activities were a prevalent practice in call center operations management.Some studies proposed selling bundled items as multi-product packets (packaged goods) because of negative correlations in demand and complementary consumption with the same outcome as cross-selling. Ernst and Kouvelis (1999) investigated a business practice where two items could not directly substitute for each other, while packaged goods could substitute for individual items and vice versa. Netessine, Savin, and Xiao (2006) researched the revenue management problem of cross-selling products or services in an e-commerce setting, assuming that the probability of a customer buying a two-item packet was a function of the synthetic price of the two packaged items. However, these studies focused on bundled goods being substitutable and did not correlate the cross-selling effect among the individual items.Research on cross-selling is sparse in the existing literature on inventory management. Zhang et al. (2011) presented a deterministic two-item EOQ model with correlated demand caused by cross-selling, which was later extended to a case of multiple items (Zhang, 2012). These papers showed that lost sales of the major item can affect the demand for the minor item, wherein they introduced cross-selling into the EOQ model of inventory management.Another relevant paper is the Netessine and Zhang (2005) investigation of the newsvendor problem with complementary items. In their paper, the demand for an item can be increased by the sale of other items, which is defined as complementarity. Thus, the effective demand for an item is equal to the sum of its original demand and the demand derived by the sales of its complementary items. Their model assumes that the original “bare” demand must be distinguishable from the derived demand. This is a rigorous condition that is not easily satisfied in the cross-selling environment in practice (this point will be examined in Section 2.1). This paper investigates NV models in the cross-selling environment without identifying original demand.The paper contributes in the following aspects: (1) we investigate the centralized newsvendor problem with cross-selling and propose optimality conditions, bounds on the optimal solution, and a gradient-based (GB) algorithm for solving the model; (2) we propose bounds on the equilibrium order quantities for a competitive NV model and an iteration-based (IB) algorithm; and (3) we conduct numerical experiments to establish how the parameters affect newsvendor decisions in the cross-selling environment.The structure of this paper is as follows. Section 2 formulates the centralized NV model with cross-selling, develops the first-order conditions for optimality, and proposes the lower and upper bounds of the optimal order quantities. Section 3 presents the competitive version of the model, develops the first-order and uniqueness conditions for the Nash equilibrium, and establishes the lower and upper bounds of the equilibrium order quantities; theoretical comparisons between the two models are subsequently presented. Section 4 presents the gradient-based (GB) and iteration-based (IB) algorithms for the centralized and competitive models, respectively. Section 5 conducts a computational study through extensive numerical examples and provides some observations. Section 6 concludes the paper.Suppose that two items, i and j (i, j=1,…,n), are associated with each other because of cross-selling. Let Didenote the total demand for item i with the probability function Pr(Di) and the probability density function f(Di) (we assume that Pr(Di) and f(Di) are continuous). Total demand implies that no items are out of stock over the entire planning horizon, where the demand for an item will not be decreased because of losing the cross-sales associated with its cross-selling items. In a situation when cross-selling is driven by customers, some of item i is sold together with item j and vice versa. Therefore, if item j is out of stock and results in lost sales, some of item i is no longer in demand in comparison with total demand Di(Zhang, 2012; Zhang et al., 2011). Let rjirepresent the cross-selling coefficient, i.e., the decreased demand for item i caused by a lost sale of one unit of item j, and Qiindicate the order quantity of item i. Denoting that x+=max(x,0), the effective demand for item i over a single-period planning horizon is represented as(1)Die=Di-∑j=1j≠inrjiDj-Qj+,where (Dj−Qj)+ represents the shortage of product j.In Eq. (1), order quantity Qjcan be either larger or smaller than Dj, depending on the NV’s decision. In case of Qj<Dj, item j is out of stock and the demand for item i is decreased because of losing the cross-sales associated with item j. Thus, if Qjis given, the quantity of item i in demand is equal toDieand not equal to the total demand Di. From this point, we callDieeffective demand. However,Dieis observable only when Qjhas been determined, soDieis also unknown before the decision is made. To address this difficulty, we can observe the total demand {Di}i=1,…,nwhen no items are out of stock and then formulate NV models based on the effective demand of Eq. (1).Another parameter in Eq. (1) is the cross-selling coefficient rji. This can be estimated with the loss rulei→♢jthat provides the probability of whether the customer will not select item i because of the lost sales of item j. Consider that whenever a customer buys item i, he/she also buys item j with a certain probability. Assuming that this pattern of purchasing behavior will not change even if item j is removed from the inventory, then the probability that the customer will not select item i because of the lost sales of item j is calculated as follows (Wong et al., 2005):conf(i→♢j)=thenumberoftransactionscontaining{i,j}thenumberoftransactionscontainingj.The cross-selling coefficient can be determined as the product ofconf(i→♢j)and the average number of item i in the transaction containing item set {i, j}. This paper assumes that the cross-selling coefficient can be obtained by using the above loss rule with data mining techniques.It should be noted that although the loss rule reflects the impacts when an item is out of stock, the item need not be actually out of stock when we calculate the probabilityconf(i→♢j); the only information required is the transaction records/database (Wong et al., 2005). Therefore, the model of the effective demand can be based on the total demand Dj. In other words, we need not await the emergence of stock depletion for estimating the cross-selling coefficient. This is more applicable than the model in Netessine and Zhang (2005), and we will revisit this at the end of Section 2.1.If demand is random, thenDieis a stochastic variable. Thus, it is more reasonable to formulate effective demand asDi+=Di-∑j≠irjiDj-Qj++, though this will result in intractable mathematics. In contrast, Eq. (1) is more tractable and practical: in reality, cross-selling never reduces an item’s demand into the negative, meaning that the realistic decision on Qjand the actual values of the parameters can ensure the non-negativity ofDiein practice. Thus, Eq. (1) is preferred for tractability. As a substitute forDi+, it is reasonable to assume thatEDie>0when Qj=0 for all j≠i. This defines Assumption 1, as follows:Assumption 1μi-∑j≠irjiμj>0for all i, where μiis the expectation of Diand Di>0.Let pi, ci, and sidenote the unit price, the unit purchasing cost, and the unit salvage value of item i, respectively. The following assumption should hold:Assumption 2pi>ci>siand rii=0 for all i.As previously mentioned, Netessine and Zhang (2005) proposed a model for describing the effective demand with complementarity, which is similar to cross-selling. Let direpresent the individual/original demand for item i while no cross-selling products exist. Denote αij⩾0 as the proportion of customers willing to purchase item i who will also purchase item j when cross-selling products are sold together. The effective demand for item i is then modeled asdie=di+∑j≠1αjimin(dj,Qj). Their model assumes that the original demand diis independent and can be distinguished from the increased demand caused by the sales of other items. However, it is difficult for a manager to distinguish the original “bare” demand from the sales because it is rare that all items except one are out of stock. The most easily obtained information is total demand (Diand Djin Eq. (1)), which can be extrapolated from sales when there are no stock depletions in the inventory system. It is also unrealistic to assume that all items are always in stock, and we cannot know the total demand solely from sales. In this case, we suggest a demand estimation method considering unobservable lost sales, which will obtain the total demand (Agrawal & Smith, 1996; Nahmias, 1994). Otherwise, we could conduct a marketing census and integrate the known sales quantity to improve the total demand information. Therefore, we assume that the total demand can be known without requiring the information of the original “bare” demand, which is suitable for formulating a NV model in a cross-selling environment where lost sales occur.Using effective demandDiein Eq. (1), the expectation of the total profit for a newsvendor that deals with n items in cross-selling is formulated as(2)π=E∑i=1npiminQi,Die-ciQi+siQi-Die+.ConsideringminQi,Die=Qi-Qi-Die+, Eq. (2) can be rewritten as(3a)π=E∑i(pi-si)minQi,Die-(ci-si)Qi,or(3b)π=E∑iuiDie-uiDie-Qi+-oiQi-Die+,where ui=pi−ciand oi=ci−si. According to Leibniz’s rule of the differentiation under the integral sign, we can obtain the first derivative of function π with respect to Qias(4)∂π/∂Qi=∑j=1j≠inrij(uj+oj)PrQj>Dje,Qi<Di+ui-(ui+oi)PrDie<Qi.Note that in Eq. (1), for a particular sample path ϖ∈Ω (Ω is the sample space), −(Dj(ϖ)−Qj)+ is concave in Qjand the summation of concave functions preserves the concavity. Thus, a sample point ofDie, denoted byDie(ϖ), is concave in Q⧹i={Q1,…,Qi−1, Qi+1,…,Qn}, where the subscript “⧹i” means that item i is not included. Because sample pointDie(ϖ)is concave in Q⧹i, it is easy to show thatminQi,Die(ϖ)is concave. Summation and expectation will maintain the concavity so that, from Eq. (3a), π is concave in Q={Q1,…,Qn}. Thus, ∂π/∂Qi=0 yields the first-order sufficient and necessary conditions of the optimality as Proposition 1.Proposition 1Qici=1,…,nis the optimal order quantity for the centralized NV model iff:(5a)PrDie<Qic-∑j=1j≠inuj+ojui+oirijPrQjc>Dje,Qic<Di=uiui+oi,i=1,…,n.Note that the above equations are not dependent on specific distributions of demand. Even if the distributions of demand are provided, it is still difficult to derive a closed-form solution from Eqs. (5a) and (5b) becauseDieis a function of decision variable Qj, resulting in intractability in calculating the probabilities in the equations. However, Eqs. (5a) and (5b) can be used to develop bounds for the optimal order quantity, which is beneficial in numerically solving the model. Moreover, we can also analyze the impact of cross-selling from Eq. (5b), thus providing managerial insights.Without the second and third terms on the left-hand side, Eq. (5b) becomes the solution to the simple newsvendor problem without cross-selling. We can see that the simple NV model is generally not optimal under a cross-selling situation. It is easy to see from Eq. (1) thatPr(Di<Qi)⩽PrDie<Qi. The optimal order quantity of product i is therefore decreased by the lost sales caused by the unsatisfied demand for other items (the second term on the left-hand side). Thus, the higher the cross-selling effect from other items to item i, i.e., a larger rji, the smaller the quantity ofQicone would expect to order. We can see that cross-selling ruins the sales of items if any one item is out of stock. This is entirely contrary to the substitution situation, where a higher degree of substitution stimulates a larger order quantity. Furthermore, based on the third term on the left-hand side of Eq. (5b), the optimal order quantity can also be increased due to the possibility that the stock depletion of itemiQic<Dimight result in lost sales of the other itemsQjc>Dje. This follows that the higher the cross-selling effect from item i (a larger rij), the largerorder quantity of item i. This is also different from substitution, where one would expect to order less of item i if the degree of substitution from product i is higher.Eqs. (6) and (7) give the lower and upper bounds on the optimal order quantities for the centralized model.Proposition 2The lower boundQic̲and the upper boundQic‾of the optimal order quantities for the centralized NV model are given by Eqs.(6) and (7), respectively.(6)PrDi-∑j≠irjiDj<Qic̲=uiui+oi,i=1,…,n,(7)PrDi<Qic‾=ui/(ui+oi)+∑j≠irij(uj+oj)/(ui+oi)1+∑j≠irij(uj+oj)/(ui+oi),i=1,…,n.See Appendix A. □Consider a competitive situation where each of n items is sold by a given firm, forming a non-cooperative inventory game. Suppose that each firm has complete information on cross-selling among all the items. Therefore, for a newsvendor that makes the decision individually, the expected profit can be easily written asπi=EpiminQi,Die-ciQi+siQi-Die+, i.e.,(8)πi=EuiDie-uiDie-Qi+-oiQi-Die+.According to Leibniz’s rule, we have∂πi/∂Qi=ui-(ui+oi)PrDie<Qiand∂2πi/∂Qi2=-(ui+oi)fDie(Qi)<0. Thus, πiis concave in Qiso that the game has a pure-strategy Nash equilibrium in inventory quantitiesQidi=1,…,n. If ∂πi/∂Qi=0, then we can obtain the first-order conditions for the pure-strategy Nash equilibrium as Eq. (9a), which is equal to Eq. (9b):(9a)PrDie<Qid=uiui+oi,i=1,…,n,(9b)PrDi<Qid+PrDie<Qid<Di=uiui+oi,i=1,…,n.Eqs. (9a) and (9b) are intractable for deriving a closed-form equilibrium solution. We will use them to develop bounds of the equilibrium order quantity for numerically solving the model and analyze managerial insights when newsvendors play games in the cross-selling environment. From Eq. (9b), we can see that the simple newsvendor solution is again suboptimal relative to the individual decision. It is obvious that the equilibrium order quantity of item i will be adjusted downward due to the lost sales of other items (see the termPrDie<Qid<Diin Eq. (9b)) because of the cross-selling effect. It is notable that thelargerthe cross-selling effect on item i, thesmallerthe order quantityQid. It is intuitive that if a newsvendor is highly affected by others, she will adopt a relatively conservative policy by ordering fewer items.In addition,Dieis increasing in Qj(see Eq. (1)). This implies that an increase in any player’s order quantity increases the marginal payoff of all the other players. Therefore, if a player chooses a higher order quantity, then the other players will have an incentive to raise their order quantity. The players’ strategies are complementary to each other and the game is supermodular.LetQid̲andQid‾represent the lower and upper bounds of the equilibrium order quantities for the competitive model, respectively. ConsideringPrDie<Qi⩽PrDi-∑j≠irjiDj<Qi,PrDi<Qid<ui/(ui+oi), and Eqs. (9a) and (9b), Proposition 3 providesQid̲andQid‾as follows:Proposition 3The lower and upper bounds of the equilibrium order quantities for the competitive NV model can be determined by Eqs.(10) and (11), respectively.(10)PrDi-∑j≠irjiDj<Qid̲=uiui+oi,i=1,…,n,(11)PrDi<Qid‾=uiui+oi,i=1,…,n.The upper bound of the equilibrium order quantity is equal to the optimal order quantity of the single-item NV model. This means that in the competitive environment, a firm willneverexpect to stock at a single-item NV level. However, in the centralized model, Eq. (7) shows that it is possible for the optimal order quantity to belargerthan the order quantity in the single-item model. In the centralized model, one can coordinate the order quantities across all items and minimize the sales loss caused by cross-selling, leading to a larger effective demand. However, in a competitive situation, it is difficult to coordinate decisions across all firms. Thus, each firm conservatively replenishes its inventory by predicting that the effective demand may be decreased by the shortages of other firms’ items because of the cross-selling effect. Proposition 4 provides the uniqueness conditions of the equilibrium.Proposition 4The pure-strategy Nash equilibrium is unique for the game (Qi, πi, i=1,…,n) if∑j≠irji<1or∑i≠jrji<1for all i, j=1,…,n.See Appendix A. □The difference between Eqs. (5b) and (9b) is that the third term on the left-hand side of Eq. (5b) does not emerge in Eq. (9b). As previously mentioned, the third term in Eq. (5b) represents the possibility that the stock depletion of item i may result in lost sales of other items. However, in a competitive situation, firm i does not make a joint decision on other firms’ businesses; therefore, the joint probability of including lost sales of other items, i.e.,PrQjc>Dje,Qic<Di, does not directly influence the decision for item i.DenoteDieQjcas the effective demand in the centralized NV model andDieQjdas the effective demand in the competitive NV model. In comparing Eq. (5a) with Eq. (9a), we note thatPrDieQjc<Qic⩾PrDieQjd<Qid, meaning that while centralized inventory management can achieve a higher level of fill rate, customer fulfillment in the competitive situation will worsen.Moreover, Netessine and Zhang (2005) proved that if the centralized model solutionQicis unique, thenQic⩾Qidholds for all of the firms, which is also correct in this paper. They further asserted that each retailer received less profit in competition than in the centralized situation, i.e., πi(Qd)⩽πi(Qc) for all i. However, in our computational experiments, we find that some cases exist where πi(Qd)>πi(Qc), showing that more sales do not mean higher profits. In the centralized situation, the manager can sell some unprofitable items to increase the total profit because sales of these unprofitable items may increase demand for profitable items due to cross-selling. However, the decrease in profit of the unprofitable items may be even lower than in the competitive situation.Deriving a closed-form solution for a multi-item newsvendor problem with arbitrary distributions of demand remains a challenge because analytically solving the first-order conditions is complex. This paper employs an approximation of effective demand to define the probability ofDieand applies this method to the model with jointly normally distributed demand to develop efficient algorithms for the solution.To address substitutable demand, Rajaram and Tang (2001), Hopp and Xu (2008), and Huang et al. (2011) proposed using a specific probability distribution to approximate effective demand and avoid the multiple integrals. The basic idea for developing an approximation of effective demand is introducing a service rate, i.e., the expected proportion of the satisfied demand. Let γi(Qi) represent the expected service rate for item i, which is defined by:(12)γi(Qi)=E[min(Di,Qi)]/E[Di].IfDi∼Nμi,σi2is normally distributed, we then haveE[min(Di,Qi)]=E[Di-Di-Qi+]=μiPr(Di⩽Qi)+QiPr(Di⩾Qi)-σi2fDi(Qi).Therefore, γi(Qi) can be determined from Eq. (12) when Qiis given. Subsequently, effective demand for item i is approximated by a new random variableD^ie, defined asDie≈D^ie=Di-∑j=1j≠inrjiDj[1-γj(Qj)],whereD^ieis an unbiased estimation ofDie. Note that γj(Qj) is a constant if Qjis given. For conciseness, we will write γj(Qj) as γj. In the numerical examples, we assume that demand for all items is jointly normally distributed. Therefore, as a linear combination of multiple normally distributed variables,D^ieis also normally distributed. The expectation and variance ofD^ieare provided by Eqs. (13) and (14), respectively.(13)μˆie=μi-∑j≠irjiμj(1-γj),(14)σˆie2=σi2-2∑j=1j≠inρjirjiσiσj(1-γj)+∑j=1j≠in∑k=1k≠inrjirkiρjkσjσk(1-γj)(1-γk)where ρijis the demand correlation coefficient of Diand Dj.Because the profit function of the centralized NV model is concave in order quantities, the model can be solved through convex optimization techniques such as the descent/ascent method. In the descent/ascent method, an important component is the linear search along the descent/ascent direction. LetQic,ti=1,…,nrepresent the solution to the centralized model obtained by tth iteration of the algorithm andP(t)=P1(t),…,Pi(t),…,Pn(t)Tbe the normalized search direction at pointQic,ti=1,…,n. The linear search must determine a step λ that maximizes the functionπ(λ)=E∑i=1nuiDie(λ)-uiDie(λ)-Qic,t+1+-oiQic,t+1-Die(λ)+whereQic,t+1=Qic,t+λPi(t)andDie(λ)=Di-∑j≠irjiDj-Qjc,t+λPj(t)+. Because we do not know the exact distribution ofDie(λ), minimizing π(λ) is still intractable. We therefore approximate the objective function at pointQic,ti=1,…,nby usingD^ie(λ)=D^ie=Di-∑j≠irjiDj1-γjQjc,t+, and the problem is converted tomaxλπˆ(λ)=E∑i=1nuiD^ie-uiD^ie-Qic,t+λPi(t)+-oiQic,t+λPi(t)-D^ie+.Proposition 5 presents the approach of determining the optimal value of λ for problemmaxλπˆ(λ).Proposition 5The optimal value of step λ in the linear search is equal to the limit of the sequence {λτ} given by Eq.(15), provided that {λτ} is convergent.(15)λτ+1=λτ+∑iPi(t)ui-∑iPi(t)(ui+oi)PrD^ie<Qic,t+λτPi(t)∑iPi(t)2(ui+oi)fDˆieQic,t+λτPi(t)See Appendix A. □Note that Eq. (15) is the solution to the first-order conditionπˆ′(λ)=dπˆ(λ)/dλ=0of the problemmaxπˆ(λ)that is yielded by the Newton–Raphson method (see the proof of Proposition 5 in Appendix A). To accelerate the convergence of the sequence {λτ}, the initial value of λτ(denoted by λ0) should be as close as possible to the solution of equationπˆ′(λ)=0. We will thus adopt a naïve heuristic to determine the initial value of λτ.Randomly select an initial value for λ0, sayλ0=λ0(0)=0. Without loss of generality, we assume thatπˆ′λ0(0)>0. It is easy to verify that equationπˆ′(λ)=0has at least one real root and that functionπˆ′(λ)is decreasing in λ. Thus,πˆ′(λ)<0holds if λ is sufficiently large. This allows us to generate a series of pointsλ0(0)<,…,<λ0(k′),…,<λ0(k)<λ0(k+1)whereπˆ′λ0(k)>0andπˆ′λ0(k+1)<0. To accelerate this procedure, we adopt a pattern search to increase the value ofλ0(k′), i.e.,λ0(k′+1)-λ0(k′)=2λ0(k′)-λ0(k′-1). The initial value of λτis then determined by the last two points, i.e.,λ0=λ0(k+1)+λ0(k)2. The computational study in Section 5 shows that this naïve method can provide a good initial value for λ.The remaining component of the algorithm is to determine the search direction, i.e.,P(t)=P1(t),…,Pi(t),…,Pn(t)T. We can directly use a gradient to develop a gradient-based (GB) algorithm. However, even when the order quantities are provided, we cannot analytically calculate the gradient because the probability density functions in Eq. (4) are not integrable. Thus, we must again useD^ieto approximate the effective demandDie, and the probabilityPrDie<Qicin Eq. (4) can be easily determined by the distribution ofD^ie. Regarding the joint probabilityPrQjc>Dje,Qic<Diin Eq. (4), we provide Proposition 6 as follows:Proposition 6Suppose that demands {Di}i=1,…,nare jointly normally distributed. If {Qi}i=1,…,nis given, thenD^jeand Disubject to a bivariate joint normal distribution and the correlation coefficient is given by Eq.(16).(16)ρDˆje,Di=[ρijσj-rij(1-γi)σi-∑k=1k≠i,jnrkjρkiσk(1-γk)]/σˆjeSee Appendix A. □Proposition 6 allows us to calculate the joint probabilityPrQjc>Dje,Qic<Dithrough the bivariate normal distribution ofD^jeand Di. We employ the algorithm and the open source code provided by Genz (2004) to calculate the probability of the bivariate joint normal distribution, thus calculating the gradient.If the relative improvement of the objective function is smaller than a small positive number δ for q consecutive iterations when implementing the gradient-based (GB) algorithm, then stop. This paper sets δ=0.01 and q=10.Topkis (1998) suggested a so-called “simultaneous optimization” method to solve a supermodular game. Based on this method, Huang et al. (2011) proposed an iterative algorithm for solving a competitive NV model with substitution. This paper develops a similar algorithm to solve a competitive NV model with cross-selling.To solve the competitive model, we must determine the order quantities that satisfy Eq. (9a), that cannot be precisely realized by numerical algorithms. We introduce a relative precision factor εito recast the equilibrium conditions as(17)PrDie<Qid-uiui+oi=εi·uiui+oi,i=1,…,n,where εiis a small positive real number. We consider the case of∑j≠irji<1and∑i≠jrji<1for all i and j, i.e., the problem exhibits a unique equilibrium.Suppose that the incumbent solution obtained by the iteration-based (IB) algorithm in the tth iteration isQid,ti=1,…,n. The effective demand can then be approximated asDie,t≈D^ie,t∼Nμˆie,t,σˆie,t2, whereμˆie,tandσˆie,tare determined by Eqs. (13) and (14), respectively. We calculate the equilibrium order quantitiesQid,t+1for the t+1th iteration fromPrD^ie,t<Qid,t+1=ui/ui+oiand determineD^ie,t+1from Eqs. (13) and (14). We then calculate the value of∑i=1,…,nεi2/nfrom Eq. (17). If∑i=1,…,nεi2/ncannot be further improved by the iteration process, then stop the algorithm. The IB algorithm is detailed as follows:Step 1InitializeQidi=1,…,n=Qid,0i=1,…,n.In the tth iteration, determineD^ie,t∼Nμˆie,t,σˆie,t2for all i from Eqs. (13) and (14).DetermineQid,t+1fromPr(D^ie,t<Qid,t+1)=ui/ui+oifor all i. Moreover, with a givenQid,t+1, updateDieasD^ie,t+1based on Eqs. (13) and (14). Calculate εifrom Eq. (17) for all i, substitutingD^ie,t+1andQid,t+1forDieandQid, respectively.When the relative change of∑i=1,…,nεi2/nis smaller than δ for q consecutive iterations, stop; otherwise, repeat steps 2–3. In this paper, we set δ=0.01 and q=10.To facilitate the convergence, it is suggested that the initial order quantities,Qid,0i=1,…,n, for IB are set to be the optimal order quantity of the single-item NV model, meaning thatPrDi<Qid,0=ui/(ui+oi)for all i=1,…,n.Because of the calculation error, solving the problem with multiple equilibria through numerical methods is not appropriate. If the equilibrium is not unique, then any solution that satisfies∑i=1,…,nεi2/n⩽δis accepted as the equilibrium, where δ is a small positive real number. However, in our pilot computational experiments, we found that a small change of δ can yield disparate multiple equilibria if we enumerated a sufficiently large number of solutions. This means that the inequality∑i=1,…,nεi2/n⩽δdoes not have the ability to numerically discriminate multiple equilibria. Therefore, in the computational study, we only consider the case where the equilibrium is unique.To evaluate the performances of the GB and IB algorithms, we use a grid search (GS) to enumerate possible values of the order quantities based on a predetermined step, providing solutions as a comparison. Solving the problem through GS, we first select values on the interval of order quantities bounded by the lower and upper bounds. If the predetermined precision of the order quantities is Δ, then the GS algorithm will need to check∏i=1,…,n⌈(Qi‾-Qi̲)/Δ⌉points, where ⌈X⌉ represents the smallest integer not smaller than X.To solve the centralized model, we need only find the order quantities under which the total expected profit reaches the maximum value. For the competitive model, the solution with the smallest∑i=1,…,nεi2is accepted as the equilibrium.Let∑j≠irji<1and∑i≠jrji<1hold for all i and j, ensuring that the equilibrium is unique. We then generate two-item, three-item and four-item problems with asymmetric parameters, as well as two-item and three-item problems with symmetric parameters. In the two-item symmetric examples, the demand is correlated to each other and we let the demand correlation coefficient change from −1 to 1. For the other examples, the demand is independent. All the numerical examples are detailed below.Suppose that the demand is independent and normally distributed. Set μ1=100, u1=250 and o1=150. Let σ1=0.2μ1, 0.5μ1, 0.8μ1, representing the changes in the variance from low to high. Let μ2=50, 100, 300 and u2=50, 250, 500. Set σ2=0.2μ2, 0.5μ2, 0.8μ2 and o2=0.2u2, 0.5u2, 0.8u2, changing from low to high, respectively. Let r12 and r21 change from 0 to 1 in steps of 0.1. Consideringμi-∑j≠irjiμj>0, we can generate a total of 18,711 two-item asymmetric problems.Demand Di∼N(μi, σi) is independently distributed. Let μi∼U[20×i,50×i] and ui∼U[50,250], where U[a, b] is the uniform distribution on interval [a, b]. For each example, let σi∼U[0.2μi,0.8μi] and oi∼U[0.5ui,1.5ui], respectively. rijis generated from rij∼U[0,μj/μi]. We randomly generated 200 three-item examples where∑j≠irji<1and∑i≠jrji<1for all i and j andμi-∑j≠irjiμj>0for all i.Changing parameters as in the three-item asymmetric examples, we generate 100 qualified four-item examples while keeping∑j≠irji<1and∑i≠jrji<1for all i and j andμi-∑j≠irjiμj>0for all i.In this set of parameters, we change the demand correlation coefficient in order to observe the influences of the demand correlation on the solutions. To this end, let Di∼N(μ, σ) and set μi=μ=200 and ui=u=300 for all i. For each {μi, ui}i=1,2, we set σi=σ=50, 100, 200, oi=o=50, 100, 250 and rij=r=0.2, 0.5, 0.8, respectively, representing the variance, the unit disposing cost, and the cross-selling coefficient change from low to high. For each {μi, σi, ui, oi, rij}i=1,2, we change the demand correlation coefficient ρ from −1 to 1 in steps of 0.1, producing a total of 3×3×3×21=567 numerical examples.Let Di∼N(μ, σ) be subject to independent and identical distributions. Set μi=μ=50, 100, 300, σi=σ=0.2μ, 0.5μ, 0.8μ, ui=u=50, 250, 500 and oi=o=0.2u, 0.5u, 0.8u. In the symmetric examples, Assumption 1 yields (n−1)r<1, which requires r<0.5 for the case of n=3. Thus, we let rij=r change from 0 to 0.5 in steps of 0.1, yielding a total of 3×3×3×3×6=486 examples.We will use all examples to evaluate the performance of the algorithms (Section 5.2) and investigate how the single-item NV model deviates from the optimal and the equilibrium solutions, respectively, when cross-selling exists (Section 5.3). In Section 5.4, the numerical examples are used for (1) observing the influence of cross-selling on optimal and equilibrium solutions based on (but not limited to) the two-item asymmetric examples, (2) investigating the influence of the demand correlation based on the two-item symmetric examples, (3) observing the influence of demand variance from the two-item and three-item symmetric examples, and (4) comparing the centralized NV model with the decentralized NV model based on the two-item asymmetric examples.We set the grid search step Δ=1 to solve all the numerical examples through GS and compare the results with those yielded by GB and IB. All of the algorithms are coded in Visual C++ and run on a computer with a 2.83gigahertz Intel Core 2 Quad Q9500 CPU and 4G of memory. Table 1presents the computational time of the three algorithms.Table 1 shows that when the item number is smaller, GS performs much better than GB. However, the computational time of GS increases rapidly as the item number becomes larger. For some 4-item examples, GS requires more than two hours to solve the NV model. Thus, for larger scale problems, it will be very difficult for GS to obtain the solution within a reasonable time. In contrast, the computational time of GB increases relatively slowly over the item number. However, IB is the most efficient algorithm; its computational time is less than one second and does not significantly increase as the item number increases. Therefore, GB and IB are competent for solving larger scale examples of the NV model.For the centralized model, we compare the deviations of the optimal profit and the optimal order quantities between GB and GS. Let πGBdenote the best profit obtained by the GB algorithm and πGSrepresent the best profit obtained by the GS method. The relative deviation is then calculated by (πGB−πGS)/πGS. For the optimal order quantities, letQiGBandQiGSdenote the optimal order quantities solved by GB and GS, respectively. The deviation of order quantities is then evaluated by∑iQiGB-QiGS2∑iQiGS2. Table 2presents the deviation between the two algorithms.It can be observed that the optimal order quantities of the two algorithms are very close to each other and the optimal profit obtained by GB is better than GS on average. This means that GB can provide high-quality solutions.For the competitive model, we investigate the deviations of the first-order equilibrium conditions when solving the competitive model by IB and GS, respectively. Let εIBrepresent the value of∑i=1,…,nεi2/nof the IB algorithm and εGSrepresent the value of∑i=1,…,nεi2/nin the GS algorithm. Table 3presents the average, maximum, and minimum values of εIBand εGS.In Table 3, the deviations of the first-order conditions of the two algorithms are very close to 0, meaning that they both can provide high-quality equilibrium solutions. However, the deviation of GS becomes larger when the item number increases. In contrast, the deviation of IB becomes smaller when the item number increases. Thus, the IB algorithm is more effective and competent in yielding high-quality equilibrium solutions for the competitive NV model.Because the GB and IB algorithms are more effective and efficient than GS, we will use the computational results obtained by GB and IB to obtain managerial insights from the numerical examples in the following sections.We first define average cross-selling as the average value of cross-selling coefficients, calculated asr¯=∑i∑jrij/n, i.e., the summation of all the cross-selling coefficients divided by the item number. The average cross-selling can be used to comprehensively represent the strength of the cross-selling effect.If the NV makes decisions without consideration of the cross-selling effect, then the order quantity of item i, denoted byQis, will be determined by the single-item NV model asPrDi<Qis=ui/(ui+oi). Note that the cross-selling actually exists, so the total profit, which is denoted by πs, should be determined by substitutingQisi=1,…,ninto Eq. (3b). If the NV considers the cross-selling effect, the optimal order quantity under centralized decision isQicas determined by Eq. (5a), which is not equal toQis. The optimal profit, denoted by πc, should be larger than πs. The relative deviation of πsfrom πcis (πc−πs)/πcand the relative deviation ofQisfromQicisQic-Qis/Qic.The above deviations represent how low the profit will be if the NV ignores the cross-selling effect when she makes decisions in a cross-selling environment. The average and maximum relative deviations of profit and order quantity under different values of the average cross-sellingr¯are presented in Table 4.Table 4 shows that the decision of the single-item NV model significantly deviates from the optimal solution of the centralized NV model if cross-selling exists among items. The average deviation becomes larger as the cross-selling effect becomes stronger. The maximum deviation of the profit reaches more than 40% if the average cross-selling is greater than 0.4. This proves that the stock depletion of one item will significantly affect the sales of its cross-selling items and that the cross-selling effect cannot be ignored when items are strongly complementary to each other.We investigate how far the solution of the single-item NV model deviates from the equilibrium of the competitive NV model when cross-selling exists. Obviously, the relative deviation between the order quantities isQid-Qis/Qid, whereQisis the order quantity determined by the single-item NV model andQidis the equilibrium order quantity of the competitive NV model under cross-selling. SubstitutingQisi=1,…,ninto Eq. (8) yields the profit of newsvendor i, denoted byπis.πisis the profit that newsvendor i can obtain under cross-selling while she determines the order quantity by ignoring the cross-selling. The relative deviation of the single-item NV profit from the equilibrium profit is thenπid-πis/πid. Table 5presents the average and maximum relative deviations under different values of the average cross-sellingr¯.We can see that the solution to the single-item NV model also deviates from the equilibrium of the competitive NV model. The average and maximum deviations become larger when the cross-selling effect is stronger. It is observed that the deviation become considerably large when the average cross-selling is greater than 0.6, implying that under decentralized competitive decision, we must seriously consider cross-selling effects.We define the ending value of the expected service rate asγiQi∗=Emin(Di,Qi∗)/E[Di], whereQi∗can beQiC,QidorQiS, depending on the specific NV model. Obviously, a smaller corresponds to a smallerγiQi∗, which implies a larger amount of lost sales. To observe how the lost sale will occur under different cross-selling effects, we calculate the average of the ending value of the expected service rate for the NV model under different cross-selling effects, as shown in Table 6.When the cross-selling coefficient is equal to 0, the result represents the decision of the single-item NV model without the cross-selling effect; thus, the first column represents the expected service rate of the single-item NV model. In the case of a centralized decision (the first row in Table 6), the average service rate increases with respect to the average cross-selling coefficient; the newsvendor can sufficiently facilitate the cross-selling effect to increase the sales if she can deal with all items and avoid too many lost sales.If the cross-selling effect is high, a newsvendor will be confronted with a huge decrease in demand in a competitive environment because of lost sales caused by cross-selling from other newsvendors. The crux in the decentralized decision is that the newsvendor cannot force others to increase order quantities to avoid possible lost sales. Thus, the effective demand will be lower than that in the centralized decision; the greater the cross-selling effect, the more lost sales caused by the decreased cross-selling will occur. Therefore, the newsvendor under a decentralized decision will order fewer items as the cross-selling effect becomes greater (the second row in Table 6).As a visual illustration, the upper half of Fig. 1presents the order quantities of two-item numerical examples with parameters {μ1, σ1, u1, o1}={100,50,250,150} and {μ2, σ2, u2, o2, r21}={100,20,50,40,0.1}, as well as r12 changes from 0 to 1 in steps of 0.1. In the lower half, r12 is fixed to 0.5, but r21 changes from 0 to 1 in steps of 0.1.Fig. 1 shows thatQ1c(the lines with squares) is increasing in r12 and remains almost unchanged in r21.Q2c(the lines with diamonds) increases in r21 but decreases in r12. Moreover,Q1d(the lines with square frames) andQ2d(the lines with diamond frames) decrease in both r12 and r21. We can also observe that the decreasing quantity ofQ2dis greater than that ofQ1dwhen r12 increases, and the decreasing quantity ofQ1dis greater than that ofQ2dif r21 increases. This is summarized in Observation 1.Observation 1For the numerical examples, the optimal order quantitiesQicof the centralized model are increasing in rij. The equilibrium order quantitiesQidof the competitive model decrease either in rijor in rji, and the decreasing quantity ofQjdare greater than those ofQidas rijincreases.Recall that in the competitive NV model with substitutions, the higher the substitution fraction, the higher the order quantities and expected profits of the equilibrium (Huang et al., 2011). Nevertheless, the above numerical results show that cross-selling results in entirely opposite effects on the equilibrium. In addition, Eq. (1) shows that the expectation of the effective demand decreases in rji. In contrast, the variance of the effective demand increases with respect to rjifor independent demand (see Eq. (14)). Thus, the expected profit decreases in cross-selling.Fig. 2shows the order quantities and the expected profits under different values of the demand correlation coefficient of two-item examples where {μi, σi, ui, oi}={200,200,300,50} and rij=r=0.2, 0.5, 0.8.It can be observed that a larger demand correlation coefficient corresponds to a smaller order quantity but a higher profit. This is in fact induced by the decrease ofσˆieas ρ increases, where smaller order quantities can satisfy the demand when the variance is smaller.In addition, we also observe that the solution changes more in the demand correlation coefficient if the cross-selling effect is stronger, e.g.,QicandQidchange more in ρ under r=0.8 (the line with triangles) than in r=0.2 (the line with rectangles). Checking all the examples, the common phenomena are concluded in Observation 2.Observation 2The order quantities of both models decrease but the total expected profits increase as the demand correlation coefficient increases. Moreover, an inventory system with stronger cross-selling effect is more sensitive to the demand correlation.Fig. 3presents the order quantities and the expected profits of three-item symmetric examples where {μi, ui, oi}={100,250,50} and σi=σ=20, 50, 80 with a cross-selling coefficient rij=r changing from 0 to 0.5 in steps of 0.1.As expected, the right half of Fig. 3 shows that a larger demand variance will lead to lower profits (the lines of σ=80 are below the lines of σ=20). However, the left half of the figure shows that a larger demand variance correlates to higher order quantities (the lines of σ=80 are located above those of σ=20). Thus, in a situation with higher demand variance, regardless of a centralized or competitive decision, one will order more to avoid possible lost sales. Fig. 3 also shows that with the change of the cross-selling coefficient, the solution changes more if the demand variance is larger, e.g.,QicandQidchange more under σ=80 than under σ=20.Fig. 4plots the ratio of the order quantity to the expectation of demand (Qic/μiandQid/μi) of two-item symmetric examples with {μi, ui, oi, rij}={200,300,50,0.8} and σi=σ=50, 100, 200 as the demand correlation coefficient changes from −1 to 1.Fig. 4 shows that an order quantity under σ=200 (the line with triangles) decreases more than one under σ=50 (the line with squares) as the demand correlation increases. The influences of the demand variance on decision results are summarized in Observation 3.Observation 3A larger demand variance leads to higher order quantities but lower profits, making an inventory system more sensitive to either the cross-selling effect or the demand correlation.We compare the order quantity and the profit of the centralized and the competitive NV models, which is summarized in Observation 4.Observation 4For any item, the order quantity of the centralized NV model is always larger than that of the competitive NV model. The total expected profit of the centralized model is larger than that of the competitive model, but this is not the case in terms of individual items.If cross-selling effects exist across items, a centralized decision-maker can order a larger inventory to prevent losing too many sales as a consequence of unsatisfied demand due to cross-selling. However, a competitive decision-maker will select a more conservative strategy, i.e., order less inventory because she does not know whether rivals are willing to collaborate to increase their inventory to avoid losing sales.As an illustration of the relationship between the profits of the two models, Fig. 5presents the values ofπic/πidand πc/πdfor two-item numerical examples with {μ1, σ1, u1, o1, r12}={100,50,250,150,0.5} and {μ2, σ2, u2, o2}={50,10,50,25}, with r21 changing from 0 to 1 in steps of 0.1.We see that πc/πd⩾1 always holds (the line with triangles), but in some cases the expected profit of item 2 in the centralized decision is smaller than that of the competitive decision (π2c/π2d<1in the line with diamonds). This observation means that the profit loss of the unprofitable item can be offset by other profitable items in the centralized model because the sales of the unprofitable item can considerably increase the sales of the profitable item through cross-selling, therefore leading to more profit. However, the decision of the competitive model is made individually, where the manager is not willing to lose profit to promote the demand for the profitable item of other newsvendors through cross-selling. Thus, the competitive system cannot make the extra profit by sacrificing unprofitable items, leading to a smaller total profit.

@&#CONCLUSIONS@&#
There have been numerous NV models based on multi-item inventory problems with substitutions. While cross-selling is a frequent practice, it has rarely been introduced into NV models as a complementary relationship among items. This paper developed multi-item centralized and competitive NV models for a newsvendor problem considering the cross-selling effect. The first-order optimality conditions of the centralized model and the equilibrium conditions of the competitive model show that the effect of cross-selling is opposite to the substitution. We also developed lower and upper bounds of the optimal order quantities and the equilibrium order quantities, respectively, for the two models.In the case of jointly normally distributed demand, we presented a gradient-based (GB) algorithm to solve the centralized model and an iteration-based (IB) algorithm to solve the competitive model. A large number of numerical examples were produced and solved, verifying the effectiveness of the proposed algorithms. The computational results showed that a greater cross-selling effect correlates to a larger order quantity in the centralized NV model, but a smaller order quantity in the competitive NV model. The positive demand correlation is favorable for profit, but a greater demand variance leads to a lower profit with a larger order quantity. We also observed that competition makes decision-makers more conservative in determining the order quantity.In a cross-selling environment, it is highly possible for newsvendors to cooperate in constructing a centralized decision system for facilitating the cross-selling effect. To this end, they must reach an agreement on the allocation of the total profit of the entire inventory system. Reaching this agreement will lead to a cooperative game problem of the NV model with cross-selling, which can be an extension of this paper.