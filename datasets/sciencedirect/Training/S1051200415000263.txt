@&#MAIN-TITLE@&#
Effective composite image detection method based on feature inconsistency of image components

@&#HIGHLIGHTS@&#
Feature inconsistency of image components is used to obtain tampering detection.The proposed method can obtain accurate tampered regions in composite images.Image-component-based composite image detection is first proposed.

@&#KEYPHRASES@&#
Composite image,Tampering detection,Image component,Feature inconsistency,Sensor pattern noise,

@&#ABSTRACT@&#
This paper proposes an effective composite image detection method that uses the feature inconsistency of image components of the composite image to detect tampered regions. The composite image is first divided into image components. Next, the variance of the noise remaining after de-noising in each image component is calculated and used as a feature. Finally, tampered regions are detected using this feature based on a tampering detection rule. Experimental results show that the proposed method has good composite image detection performance.

@&#INTRODUCTION@&#
Digital images have become ubiquitous. With the availability of powerful image processing technology and digital image editing tools, digital images have become easier to duplicate and manipulate without degrading quality or leaving obvious visual clues. Image forgery has become a serious problem, and thus the authentication of images has become increasingly important. Therefore, accurate and robust detection of image forgery is desirable.Image forensic methods can be roughly divided into those based on active and passive technologies [1–3]. The active forensic approach is a non-blind approach that extracts prior inserted information from a digital image (e.g., digital watermarks or signatures) to determine authenticity. The image is recognized as having been tampered when the embedded information has changed. Image watermarking [4–6] is a popular active technique among non-blind approaches. Image watermarking embeds a hidden watermark at recording time that is extracted later to verify image authenticity. Hu et al. [7] proposed a novel image forgery detection method that uses the difference of singular values based on discrete wavelet transform (DWT)-discrete cosine transform (DCT)-singular value decomposition (SVD)-based image watermarking [8] and alpha mattes [9,10] to determine the tampered foreground or background image. This method works well for images manipulated using image matting.The passive forensic approach is a blind approach with no supplementary information used. That is, blind approaches determine the feature consistency of an image without the use of embedded information. Region duplication detection, a common type of image forgery detection, includes copy–move forgery detection [11–14] and composite image detection [15–21]. Compared to active forensic approaches, passive ones can authenticate an image without a priori knowledge. Therefore, passive forensic approaches are more practical.In passive forensic approaches, copy–move forgery detection and composite image detection are commonly considered. Copy–move forgery detection usually uses a block-based scheme to detect image forgery. An image is first divided into fixed-size overlapping blocks and then features of the blocks are extracted and represented as feature vectors. Next, the feature vectors are sorted in lexicographical order to make similar blocks close to each other. Finally, duplicate blocks are filtered out using a similarity measure. Chang et al. [22] proposed a forgery detection algorithm that uses a multi-region relation for copy–move forgery detection. It works well for images manipulated using image inpainting.Composite image detection has no reference regions for checking duplicate regions. In general, a composite image is created by taking a region from a source image and pasting it into a target image after performing geometric operations (such as scaling, rotation, and morphing). The composite image contains tampered and untampered regions. Feature inconsistency is used for the tampering detection, such as feature inconsistency based on noise [15,16,29], JPEG compression [17–20], and shadows [21]. Composite image detection is more difficult than copy–move forgery detection.Mahdian and Saic [15] proposed a composite image detection method based on local noise level inconsistencies. One-level DWT is first applied to the composite image to obtain the HH sub-band image. Next, the obtained HH sub-band image is divided into fixed-size non-overlapping blocks. The noise standard deviation of each block is calculated using the widely used median-based method. The homogeneity condition is used to segment the image into several homogeneous sub-regions based on the obtained noise standard deviation of each block. Finally, the region merging algorithm is applied to neighboring blocks based on block similarity with a given threshold to detect tampered regions. Compared to the method proposed by Popescu [16], the method in [15] uses a more precise estimation of noise level. The main drawback of Popescu's method is that in order to estimate the local noise variance of a single-channel image, the local kurtosis values of the noiseless image need to be known. The estimation of kurtosis introduces numerical errors and decreases performance. However, in the method in [15], additive white Gaussian noise is necessary, and the accuracy of tampering detection is influenced by the given threshold and additive noise level. Furthermore, based on the authors' suggestion [15], this method is useful as a supplement to other forgery detection methods rather than a standalone forgery detector.Fan et al. [29] proposed a new tool for manipulation detection, which correlates statistical image noise features with selected features from three EXchangeable Image File format (EXIF) header features. Each EXIF feature is formulated as a weighted sum of selected statistical image noise features based on sequential floating forward selection, the weights are then solved as a least squares solution for modeling the correlation between the intact image and the corresponding EXIF header. Image manipulations like brightness and contrast adjustment can affect these noise features and lead to enlarged numerical difference between each actual and its estimated EXIF feature from the noise features. However, EXIF-noise-based tampering detection method is only useful on EXIF images.Zuo et al. [17] proposed a composite image detection method based on the traces of re-sampling and JPEG compression. An image is first divided into overlapping blocks. Next, a block measure factor is defined and evaluated. The block measure factor contains both the re-sampling characteristics and JPEG compression characteristics of each block. Finally, the block measure factor is applied to detect tampered regions. Unlike other JPEG image forgery detection methods [18–20], when the quality factor of double compression is smaller than the primary quality factor, the method in [17] can still work well. However, based on the authors' suggestion [17], this method becomes ineffective when the composite image is composed of two uncompressed images, and the tampered regions are not subjected to geometric operations.Liu et al. [21] proposed a composite image detection method based on the photometric consistency of illumination in shadows. The color characteristics of shadows measured in terms of the shadow matte value are first formulated. Next, the shadow boundaries and the penumbra shadow region of the image are extracted. Then, the shadow matte values for each of the sampled shadows in an image are estimated and tested. Finally, the feature consistency is used to detect image tampering. Because this method assumes a single distant light source, its application is limited. Furthermore, this method fails when the composite shadows are consistent with the real target shadows. Moreover, based on authors' suggestion [21], although this method can identify whether an image is tampered, it cannot determine which part of the composite image has been doctored.Compared to above mentioned methods based on feature inconsistency with noise, JPEG compression, or shadows, sensor pattern noise (SPN) is the result of the imperfection of digital image acquisition equipment and it is relatively stable feature. SPN can be considered as a sort of camera fingerprint and used as such to accomplish forgery detection or image identification tasks. SPN can be estimated using the method developed by Lukáš et al. [23]. SPN is the difference between the original image and its de-noised version. Therefore, SPN-based feature inconsistency is used to obtain tampering detection in this paper.The noise calculation is an important issue in SPN-based tampering detection methods. It is crucial for the detection performance. However, in the presented SPN-based tampering detection methods, the non-overlapping blocks are usually used as image segmentation, but they would obtain tampered regions with jagged shapes. To obtain more accurate tampered regions, a suitable form of image segmentation is necessary to obtain more relational regions for detecting fine contours of tampered regions. Image component is a kind of image segmentation. Therefore, image-component-based tampering detection method is proposed in this paper to obtain fine contours of tampered regions. It is worth mentioning that image-component-based composite image detection is first proposed.The present study proposes an effective composite image detection method based on the feature inconsistency of image components. In the proposed method, an image is first divided into image components using the adaptive component detection method [10]. Next, the variance of the noise remaining after de-noising in each image component is evaluated. The variance of the remaining noise is a kind of SPN. Finally, tampered regions are detected using the variance of the remaining noise of image components based on a tampering detection rule. The proposed method can obtain fine contours of tampered regions, unlike methods based on non-overlapping blocks, which obtain rough contours. Experimental results show that the proposed method performs well in terms of composite image detection.The rest of this paper is organized as follows. The proposed image-component-based composite image detection method is described in Section 2. Section 3 presents experimental results and their evaluations. Finally, conclusions are given in Section 4.Because composite image detection has no reference regions for checking duplicate regions, feature inconsistency is usually used to detect tampered regions. Sensor pattern noise (SPN) is the result of the imperfection of digital image acquisition equipment and is relatively stable. Therefore, the variance of the remaining noise is used as the feature to obtain the tampering detection, where the variance of the remaining noise is a kind of SPN. Image-component-based tampering detection is proposed to obtain fine contours of tampered regions. Fig. 1shows a block diagram of the proposed composite image detection method.In the proposed method, the image components are obtained using the adaptive component detection method [10]. The mean shift algorithm [24] and spectral segmentation with the k-means algorithm based on the eigenvectors of the matting Laplacian matrix [25] are used for adaptive component detection.The mean shift algorithm is briefly described below. A special class of radially symmetric kernels satisfyingK(x)=ck,dk(‖x‖2)is used, whereck,d>0is chosen such that:(1)∫0∞K(x)dx=∫0∞ck,dk(‖x‖2)dx=1k(x), the profile of the kernel, is a monotonically decreasing function defined only forx≥0. Given the functiong(x)=−k′(x)for a profile, the kernelG(x)is defined asG(x)=ck,dg(‖x‖2).For n data pointsxi,i=1,…,n, in the d-dimensional spaceRd, the mean shift is defined as in (2), where x is the center of the kernel (window) and h is a bandwidth parameter.(2)mh,G(x)=(∑i=1nxig(‖x−xih‖2)/∑i=1ng(‖x−xih‖2))−xThe mean shift method is guaranteed to converge to a nearby point where the estimate has the zero gradient. The center position of kernel G can be updated iteratively using (3), wherey1is the center of the initial position of the kernel.(3)yj+1=∑i=1nxig(‖yj−xih‖2)/∑i=1ng(‖yj−xih‖2),j=1,2,…The number of clusters in the image is used to obtain the image components by using spectral segmentation with the k-means algorithm based on the eigenvectors of the matting Laplacian matrix. The matting Laplacian matrix is defined as a sum of matricesL=∑qAq, each of which contains the affinities among pixels inside a local windowwq, whereδijis the Kronecker delta;μqis a3×1mean color vector in the windowwqaround pixel q;∑qis a3×3covariance matrix in a given window;|wq|is the number of pixels in a given window;I3×3is a3×3identity matrix;IiandIjare3×1color vectors in the windowwq; and ε is a small positive constant.(4)Aq(i,j)={δij−1|wq|(1+(Ii−μq)T(∑q+ε|wq|I3×3)−1(Ij−μq)),(i,j)∈wq0,otherwiseThe adaptive component detection method has an accuracy of about 94% under low-, medium-, and high-complexity image segmentation [10], where accurate component detection is defined as each detected component being only a part of the foreground or background. Fig. 2shows the image components obtained using adaptive component detection. As can be seen, the eagle was accurately segmented.The algorithm of the proposed image-component-based composite image detection is given below.Step 1:Transform image I from the RGB color space into the HSV color space to obtain image.Apply adaptive component detection to imageIVto obtain image componentsIVk,k∈[1,n].Apply down-sampling toIVkto obtainIV,downk.Apply the one-level DWT to imageIVto obtain sub-band imageIV,HH.Apply the lower–upper–middle (LUM) filter [26] to imageIV,HHto obtain the de-noised image(IV,HH)denoise.Calculate the remaining noise using (5).(5)(IV,HH)R=IV,HH−(IV,HH)denoiseCalculate the variance of the remaining noise in each image componentVarre_noisekbased onIV,downkand(IV,HH)R.Calculate the measure quality (MQ) using (6), wheremax⁡(Varre_noisek)is the maximum one within allVarre_noisek. IfMQ≥ThQ, then the tested image is a tampered image and go to Step 9; otherwise it is not a tampered image and go to Step 13.(6)MQ=max⁡(Varre_noisek)/1n∑k=1nVarre_noisekApply the normalization to the obtained variances of the remaining noise of image components to obtainV˜arre_noisek, that is,0≤V˜arre_noisek≤1. Fig. 3shows theV˜arre_noisekfor Fig. 2(b).Select the image component with maximumV˜arre_noisek(V˜arre_noisek=1)as the tampered image component, and select image components withV˜arre_noisek≥ThCas candidate tampered image components.If candidate tampered image components are adjacent to tampered image components, mark them as tampered and removed them from the list of candidate tampered image components.Collect all the tampered components and then apply up-sampling to obtain the tampered regions in image I.Show the result of composite image detection.In the proposed algorithm of image-component-based composite image detection, down-sampling operation in Step 3 is applied to obtain the same size of sub-band image obtained using one-level DWT operation in Step 4. And, up-sampling operation in Step 12 is applied to obtain the original size of tested image I. Furthermore, the reason of calculatingVarre_noisekusingIV,downkand(IV,HH)Ris that these two images are with same size (that is, they are both 1/4 tested image I) and it can effectively reduce computational cost. Besides, thresholdsThQ=4.0andThC=0.3are set from experience, where the value ofThCis decided the numbers of candidate tampered image components.Because the image components are obtained using spectral segmentation with the k-means algorithm based on the eigenvectors of the matting Laplacian matrix, there will be broken or incomplete tampered regions. Therefore, a refinement scheme is proposed to obtain more complete tampered regions. Object region refinement with a3×3mask is used to scan the results of tampering detection. Each pixel of untampered regions is checked for whole image to obtainM1image if the up and down pixels of tested pixel are both the pixels of tampered regions, and this pixel is remarked as a pixel of tampered regions. Each pixel of untampered regions is checked for whole image to obtainM2image if the left and right pixels of tested pixel are both pixels of tampered regions, and this pixel is remarked as a pixel of tampered regions. Next,M1andM2are merged using the “OR” operator. Next, a hole-filling scheme is used to fill the holes in tampered regions. The results of this procedure contain only tampered regions and residual small regions. In this paper, the residual small regions are defined as noise regions. The fast 4-connected component labeling method [27] is used to label each isolated region, whose size is calculated. An isolated region is removed if its area is smaller than the given thresholdThr. The residual small regions are thus removed, leaving only tampered regions. Fig. 4shows the results obtained using the proposed tampering detection method. As shown, the proposed refinement scheme effectively produces more complete tampered regions.

@&#CONCLUSIONS@&#
