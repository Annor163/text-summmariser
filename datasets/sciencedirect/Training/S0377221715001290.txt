@&#MAIN-TITLE@&#
Stronger multi-commodity flow formulations of the Capacitated Vehicle Routing Problem

@&#HIGHLIGHTS@&#
We present several new formulations for the classical “Capacitated Vehicle Routing Problem”.We survey other previous flow-based formulations.We show that our new formulations have desired properties.We prove that the linear programming relaxations of the new formulations give better bounds.We analyse computational results to compare the known and new formulations.

@&#KEYPHRASES@&#
Vehicle routing,Multi-commodity flows,Integer programming,

@&#ABSTRACT@&#
The Capacitated Vehicle Routing Problem is a much-studied (and stronglyNP-hard) combinatorial optimization problem, for which many integer programming formulations have been proposed. We present two new multi-commodity flow (MCF) formulations, and show that they dominate all of the existing ones, in the sense that their continuous relaxations yield stronger lower bounds. Moreover, we show that the relaxations can be strengthened, in pseudo-polynomial time, in such a way that all of the so-called knapsack large multistar (KLM) inequalities are satisfied. The only other relaxation known to satisfy the KLM inequalities, based on set partitioning, is stronglyNP-hard to solve. Computational results demonstrate that the new MCF relaxations are significantly stronger than the previously known ones.

@&#INTRODUCTION@&#
Vehicle Routing Problems (VRPs) are classic problems in operational research and logistics, and have also received a great deal of attention from the combinatorial optimization community. A huge number of papers have been written on the theory and applications of VRPs, and on exact and heuristic solution methods for them (see, e.g., the edited volumes Ball, Magnanti, Monma, and Nemhauser, 1995; Golden, Raghavan, and Wasil, 2008; Toth and Vigo, 2001.)This paper is concerned with the Capacitated VRP (CVRP), which Dantzig and Ramser (1959) defined as follows. A fleet of identical vehicles, with limited capacity, is located at a depot. There are n customers that require service. Each customer has a known demand. The cost of travel between any pair of customers, or between any customer and the depot, is also known. The task is to find a minimum-cost collection of vehicle routes, each starting and ending at the depot, such that each customer is visited by exactly one vehicle, and no vehicle visits a set of customers whose total demand exceeds the vehicle capacity.Letchford and Salazar-González (2006) surveyed and compared several integer programming formulations of the CVRP. These included the so-called two- and three-index formulations, the single-, two- and multi-commodity flow formulations, and the set partitioning formulations. At present, the most successful exact algorithms for the CVRP are based on the two-index formulation (e.g., Lysgaard, Letchford, and Eglese, 2004) or on set partitioning formulations (e.g., Fukasawa et al., 2006, Baldacci, Christofides, and Mingozzi (2008)).One way to measure the strength of an alternative formulation is to project the feasible region of its continuous relaxation into the space of the natural (two-index) formulation. Gouveia (1995) showed that, in the case of the single-commodity flow formulation, the projection satisfies a family of valid inequalities now known as generalized large multistar (GLM) inequalities. Letchford and Salazar-González (2006) showed that the projection of the set partitioning formulation (with only elementary routes permitted) satisfies the so-called knapsack large multistar (KLM) inequalities, defined by Letchford, Eglese, and Lysgaard (2002). The KLM inequalities include the GLM inequalities and the so-called subtour elimination (SE) inequalities as special cases. Unfortunately, the continuous relaxation of the set partitioning formulation is itself stronglyNP-hard to solve.This paper has four main contributions. First, we show how to strengthen the two best multi-commodity flow (MCF) formulations, by adding only a polynomial number of additional constraints. Second, we show that the projections of our two formulations satisfy the GLM and SE inequalities. Third, we show that the new formulations can be further strengthened, in pseudo-polynomial time, in such a way that all of the KLM inequalities are satisfied. (We remark that no polynomial or pseudo-polynomial time separation algorithm is known for the KLM inequalities themselves.) Finally, we present some computational results that demonstrate that the new MCF formulations are significantly stronger than the previously known ones.As mentioned above, the current best algorithms for the CVRP are based on two-index or set partitioning formulations. The contribution of this paper may therefore appear to be only of theoretical interest. We would like to point out, however, that there exist variants of the CVRP for which it is natural, or even essential, to use additional commodity-flow variables. This includes, for example, the problem described by Hernández-Pérez and Salazar-González (2009), in which several distinct products have to be picked up and delivered at various locations, and the one described by Kara, Kara, and Yetis (2007), in which the cost of traversing an arc is an increasing function of vehicle load. Potentially, our results could be used to derive better formulations and algorithms for such problems.The structure of the paper is as follows. The literature is reviewed in Section 2. The strengthened MCF formulations are presented and analysed in Section 3. The result on KLM inequalities is given in Section 4. Some computational results are given in Section 5, and some concluding remarks are made in Section 6.Throughout the paper, we use the following notation. We have a complete directed graph G with node setV={0,1,…,n}and arc set A. Node 0 represents the depot, and nodes1,…,nrepresent customers. We sometimes write Vcfor V∖{0}, the set of customer nodes. The (positive integer) demand of customer i ∈ Vcis qi. The (positive integer) vehicle capacity is Q. The (non-negative integer) cost of traversing arc (i, j) ∈ A is cij. (Our approach can easily be adapted to the case of symmetric costs and/or the case in which the number of vehicles is restricted.)

@&#CONCLUSIONS@&#
