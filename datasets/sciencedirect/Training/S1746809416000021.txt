@&#MAIN-TITLE@&#
Feedback control of heart rate during outdoor running: A smartphone implementation

@&#HIGHLIGHTS@&#
A smartphone-based system for heart rate control for running outdoors is proposed.Important for prescription of exercise intensity for fitness training.Highly accurate tracking of target heart rate with RMS error less than 2bpm.Robustness demonstrated despite substantial plant variability.Feedback control of heart rate while running outdoors is deemed feasible.

@&#KEYPHRASES@&#
Cardiorespiratory systems,Physiological control systems,Exercise prescription,Feedback control,

@&#ABSTRACT@&#
The aim was to develop and to investigate the technical feasibility of a novel smartphone-based mobile system for feedback control of heart rate during outdoor running. Accurate control is important because heart rate can be used for prescription of exercise intensity for development and maintenance of cardiorespiratory fitness.An Android smartphone was employed together with wearable, wireless sensors for heart rate and running speed. A simple feedback design algorithm appropriate for embedded mobile applications was developed. Controller synthesis uses a low-order, physiologically-validated plant model and requires a single bandwidth-related tuning parameter.Twenty real time controller tests demonstrated highly accurate tracking of target heart rate with a mean root-mean-square tracking error (RMSE) of less than 2 beats per minute (bpm); a sufficient level of robustness was demonstrated within the range of conditions tested. Adjustment of the tuning parameter towards lower closed-loop bandwidth gave markedly lower control signal power (0.0008 vs. 0.0030m2/s2, p<0.0001, low vs. high bandwidth), but at the cost of a significantly lower heart rate tracking accuracy (RMSE 1.99 vs. 1.67bpm, p<0.01).The precision achieved suggests that the system might be applicable for accurate achievement of prescribed exercise intensity for development and maintenance of cardiorespiratory fitness. High-accuracy feedback control of heart rate during outdoor running using smartphone technology is deemed feasible.

@&#INTRODUCTION@&#
The prescription of exercise intensity for development and maintenance of cardiorespiratory fitness in adults is based on either heart rate (HR) or oxygen uptake [1,2]. With heart rate, intensity can be expressed as a percentage of either maximum heart rate or of heart rate reserve (HRR), the latter being defined as the difference between an individual's maximum and resting heart rates, i.e. HRR≜HRmax−HRrest. For most adults, training is recommended for 20–60min on 3–5d/week at a moderate to vigorous intensity; using heart rate reserve, moderate intensity is defined as 40–59% of HRR and vigorous intensity as 60–89% of HRR [1]. It is therefore of high interest to investigate feedback methods for accurate control of heart rate during exercise.Because of the convenience of measuring heart rate, automated heart rate control has been implemented in different exercise devices including treadmills [3,4] and cycle ergometers [5], both within commercial devices and in the scientific research literature. Feedback controllers within commercial products seem to be based mainly on conservatively-tuned proportional-integral (PI) controllers and give very poor heart rate tracking performance. Controllers described in the literature tend, on the other hand, to be based on sophisticated non-linear modelling/identification [6] and control design techniques (e.g. [7–10]); to the best of our knowledge, no data have been presented which compare such methods with well-designed robust linear-time-invariant (LTI) controllers.The primary contribution of this work is the development of a system which enables feedback control of heart rate during free-running outdoor exercise. Hitherto, no system with this capability has been demonstrated, but state-of-the-art smartphone and wearable sensor technologies present the potential to address this lack: smartphones are now available with appropriate open-source programming and operating system environments (e.g. Java, Android) and wireless communication systems (e.g. ANT+); simple, accurate and cost-effective sensors are available for real-time measurement and wireless transmission of heart rate and running speed.A second contribution of the present work is the employment of analytical feedback design methods which use physiologically-accepted models of the heart rate response to changes in exercise work rate: we assume at the outset that the plant can be modelled by a mono-exponential (first-order) response with operating-point dependent gain and time-constant parameters, which is the usual and physiologically-validated assumption in the exercise sciences [11].This starting point led to the development of a simple and transparent feedback design algorithm appropriate for embedded mobile applications: controller synthesis based on the low-order, physiologically-validated plant model requires only a single bandwidth-related tuning parameter. It transpires that, despite its simplicity, the algorithm gives high-precision and robust heart-rate tracking performance. A similar approach has previously been employed in the context of rehabilitation robotics [12,13].The aim of this work was to develop and to investigate the technical feasibility of a novel smartphone-based mobile system for feedback control of heart rate during outdoor running by automatically calculating a target speed for the runner.

@&#CONCLUSIONS@&#
