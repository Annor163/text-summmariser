@&#MAIN-TITLE@&#
Integrated construction and simulation of tool paths for milling dental crowns and bridges

@&#HIGHLIGHTS@&#
Integrated approach of tool path generation and simulation for milling in the field of dental technology.Implicit representations of surfaces and solids by means of level-sets.Isoplanar/isoparametric and isogeodesic sampling for finishing milling.GPU-based implementation of predictive feed rate optimization and tool path evaluation.

@&#KEYPHRASES@&#
Dental milling,Tool path construction,Tool path simulation,Implicit representations,

@&#ABSTRACT@&#
The paper presents an integrated and therefore novel approach of tool path generation and simulation for milling in the field of dental technology. Both the geometry of the dental implants and the characteristics of the cutter, machine and raw material have an immediate influence on the stability of the milling process and the quality of the result. Regarding this issue, the paper focuses on the construction of tool path segments on a triangulated surface using an isoparametric and isogeodesic approach. The segments are subsequently chained and simulated in order to provide an optimized tool path in terms of path length and feed rate. The simulation particularly evaluates a tool load to guide feed rate selection and the distance error of the machined surface. Implicit representations of surfaces and solids by means of level sets are applied where appropriate in order to increase robustness and universality of tool path construction.

@&#INTRODUCTION@&#
As in many other industries, production stages are increasingly becoming automated in dental technology  [1]. As the price of dental laboratory work has become a major factor in treatment planning and therapy, automation could enable more competitive production in high-wage areas like Western Europe and the USA. As advances in computer technology significantly speed up calculations, using budget-priced hardware enables a cost-effective production of individual pieces.Computer assisted and fully automatic manufacturing of dental implants offers many benefits compared to conventional manual manufacturing, including: high precision, reproducibility, efficient exploitation of raw material, unified workflow for a variety of models and materials, short processing time, efficient utilization of working steps via pipelining and low manufacturing costs.For a common dental office/lab to profit from these benefits in daily use, as well as for broad acceptance to be obtained, computer assisted manufacturing systems must fulfill both common technical as well as end-user ergonomic requirements. Technical requirements are, e.g., compliance with a predefined precision, minimization of calculation as well as machining times and error robustness. User ergonomic requirements are e.g. universality, an obvious and intuitive course of action, minimization of mandatory interaction and modularity of the production sequence.A schematic representation of a production sequence of dental implants is shown in Fig. 1. At the beginning a point cloud is produced by a scanner facing the dental region of preparation. The scanning can be performed as extraoral (indirect) or intraoral (direct) sampling and by using an optical or a mechanical scanner. The complex geometry of the replacement body parts including additional fixation bars is modeled in the CAD (Computer Aided Design) module. Afterwards the resulting model of the replacement body can be manufactured by a CAM (Computer Aided Manufacturing) module, which uses the surface of the model as the basis for tool path calculation  [2]. Fig. 2shows conceptual components of the CAM module described in this paper.Compared to classical machining, the surface approximation error of tool paths in dental implant machining plays a slightly less important role on a microscopic scale, since the models to be machined emerge from scanned point clouds, which are in turn both discrete and defective. Furthermore, path generation relies on discrete surfaces (triangle meshes) instead of analytical representations, which rigorously restricts geometric concepts and operators needed for classical machining, like fundamental forms, curvatures and offsets. Tool pose computation and collision avoidance become a problem of interpolation and search, rather than differential geometry. Therefore path planning strategies for continuous and discrete object representations naturally differ. An essential aspect of the latter is universality and robustness, since many degenerate cases may emerge from manipulating an arbitrary (and possibly defective) triangle mesh. To account for arbitrary evolving shapes, level set representations become increasingly popular, which are used in this paper to represent surfaces and tool paths.In dental applications, the majority of CAM processes employ ball-end tools for the following reasons: an economic and efficient usage of raw material and tools requires material waste and unnecessary chipping to be minimized—therefore, multiple objects are machined from a single blank with each cut region outline fitting tightly to the target object (cf. Fig. 4(a)). Furthermore small-sized and low-priced machines with only 4 or 4.5 axes are popular, but they also have a reduced freedom of movement. Both issues strongly restrict the accessibility of the target surface in terms of tool orientation. These facts render a tangential tool contact impossible in general, and make it convenient to employ tools whose shaping does not depend on the working angle.Due to this circumstance, the presented tool path generation is optimized for ball-end tools, by subdividing it into a tool location sampling phase and a tool orientation optimization phase.For a general survey of cutter path construction techniques we refer to  [3,4]. A review of the status and future perspectives of dental CAD/CAM is given by  [5]. While constant scallop tool paths are state of the art in freeform surface machining  [6], the restrictions on surface representation mentioned above apply to their applicability to dental implant machining. Especially the transformation from cutter contact to gouge-free cutter location points is cumbersome and error-prone with arbitrary triangular meshes. This fact renders the offset–surface based calculation of cutter location paths  [7–9] more attractive than an explicit construction and transformation of cutter contact paths. The approach described in this paper furthermore overcomes difficulties and error sources of conventional offset–surface based tool path calculations by representing relevant surfaces and curves implicitly by means of distance fields, which applies to both the generation as well as simulation of tool paths. Implicit representations are highly topical in the context of CAM  [10–13]. Since the computation of tool positions is only a small piece of an end-user solution to dental implant machining, this paper describes a chain of methods whose aim is the incorporation of the geometry of arbitrary dental implants as well as characteristics and influences of the milling machine and raw materials. The integrated consideration of these facts is denoted by Computer Aided Process Planning (CAPP), which is the interface between CAD and CAM and considers both geometrical and non-geometrical circumstances  [14].The first step of dental implant machining is the automatic arrangement of a set of implant models onto the currently available blank space. This arrangement step constitutes a two-dimensional nesting problem and bases on no-fit polygons to minimize the occupied blank space–and therefore the material waste–by means of heuristic optimization. This step is not within the scope of this publication.The paper is organized as follows: Section  2 specifies the problem of tool path generation and Section  3 presents its proposed solution. The latter is divided into different strategies of subpath sampling for roughing (Section  3.1) and finishing (Section  3.2), as well as subpath chaining and tool orientation optimization (Section  3.3). Section  4 focuses on path simulation and feed control, and Section  5 shows some exemplary results. Section  6 concludes with some remarks on the current state and further development.After arranging a set of models in the blank, tool paths are generated and executed to machine the models, in which machining is divided into a roughing and finishing step.Tool paths can be formalized by means of the configuration spaceC, whose dimension equals the machine’s degrees of freedom and which contains every tool configuration that does not lead to a damage of the machined object or the machine itself. A configurationc∈Cin turn defines the tool’s position, orientation, feed rate and spindle speed. Since the current work employs 4- and 5-axis machining,Cis a subspace ofR6orR7. Tool path generation now denotes the problem of selecting an “appropriate” finite ordered sequenceTP=(c0,c1,…,cN−1)ofNtool configurations withci∈C(cf. Fig. 3).Since there is no unique solution, a tool pathTPhas to fulfill specific conditions of optimality, consisting of the accuracy of fit to a given object, machining time, and machine lifetime. These generic terms in turn depend on a multitude of technical conditions like path length, path pattern, number and homogeneity of configurations, cut volumes, feed rate, direction of rotation, etc. A joint optimization of these contradicting and diffusely specified conditions using the entire configuration spaceC–supplemented by arbitrary permutations of selectedci’s–would turn tool path generation into a task too complex to manage efficiently, which is why demands on a resulting path pattern are typically specified to guide the selection of configuration sequences. In compliance with such a demand, conditions of optimality can be more easily concretized, e.g., isoplanar tool paths with a given accuracy of fit, minimal Euclidean length and given direction of rotation. In terms ofC, specifying a desired path pattern can be regarded as restricting configuration selection to subspaces ofC, e.g.ci+1is restricted to fulfill a predefined relation toci, like having isoplanar locations. Furthermore, predefining a path pattern allows the path generation to be divided into common subproblems, which consecutively compute the coordinates of each configuration, as employed in the current work:1.Identify a set of admissible potential tool configurations, that specify which locations the tool shall visit and various alternatives to achieve this, along with a partial ordering of configurations by means of so called partial (or sub-) paths.Concatenate an appropriate subset of configurations from step 1 into an admissible path, ensuring each location is visited once.Schedule feed rates and cutting speeds.Tool path generation is divided into subpath-sampling and subpath-chaining. The former is a geometric problem, the latter mainly is a problem of combinatorial optimization. Depending on the domain and strategy underlying the subpath-sampling, either roughing or finishing tool paths emerge, as shown in the following.The aim of rough machining is a quick removal of material to uncover a solid that will become the target object after finishing. Therefore, tool paths must not accurately adapt to a target surface, but systematically traverse the entire cutting region in order to make sure that no material is left offside the target object, except a predefined least residual stock material thickness of about 0.05–0.1 mm, dependent on the material.This can be easily accomplished by sampling the cutting region by means of a regular grid, which defines a set of cutter location points (clp) by means of inflated and translated versions of a reference subpathpref. Choosingprefto resemble the outlining polygon of the cutting region, allows an accurate compliance of the machined cutting region with the specified one, since its boundary can be reproduced exactly. Sampling the reference path’s offset along thez-axis as well as its inflation via a predefined path distance, yields subpaths that reproduce the cutting region outline at varying heights and sizes.After sampling the cutting region, each clp that has a least distance of less than tool radiusrto the object surface is removed from its subpath. Removing a clp from a subpath splits it up into two subpaths, each containing the clps preceding and succeeding the split, respectively. Fig. 4(a) shows an exemplary cutting region, which is defined by extruding a two dimensional outlining polygon along thez-axis. Fig. 4(b) shows the result of systematically filling this region with cutter location points. As can be seen, bars connected to the target object leave the cutting region to fix the machined object after surrounding material has been removed.Up to now, only the positional coordinates of the roughing tool path were defined. The calculation of remaining coordinates as well as path chaining are described in Section  3.3.While roughing aims at removing material from non-object regions of the blank and uncovering a coarse approximation of the target object, finishing aims at accurately shaping the object’s surface, requiring the tool path’s cutter contact points (ccp) to be exactly adapted to the target surface.The current text describes two complementary strategies to sample the object surface by means of contact points, namely isoparametric and isogeodesic sampling. A cutter contact point (ccp) specifies the position at which shaping of a given target surface by means of the cutting tool shall take place. A ccp is inaccessible, if each tool configuration that allows shaping at the ccp will result in a damage of the target surface or the machine itself. Otherwise, the ccp is accessible by one or more corresponding tool configurations, each consisting of a tool position (cutter location point—clp) and tool orientation, which make shaping at the ccp taking place (speeds neglected). Therefore, each desired contact point has to be transformed to an appropriate tool configuration to allow for shaping the surface at the desired ccp, whereas inaccessible ccps have to be discarded. The transformation from ccp to tool configurations has to resolve direct and indirect collisions, which denote a remote penetration of the target surface via either the tool end or the tool shaft, respectively. In general, there is a multitude of tool configurations corresponding to an accessible ccp, since it is reachable in more than one way. In that case, an appropriate configuration has to be selected by means of an optimality condition on the entire path, e.g. optimal work angle or least variations of orientation (cf. Section  3.3).Due to the restriction to ball-end tools, the computation of clps is divided into the positional and orientational part: while the position of clps which yield an adequate sampling of the object surface is performed by sampling the offset surface, the orientation of clps is optimized independently. This allows for a more efficient minimization of the total path length and machining time (cf. Section  3.3). With a non-ball-end tool, orientation affects offset as well as sampling, and therefore requires a joint optimization of surface sampling and path length, which is beyond the scope of this paper.Due to the restricted accessibility of the target surface as mentioned in Section  1, the tool’s cutting region can only restrictedly be controlled by means of tool inclination, even with 5-axis machining. This issue raises the risk of zero-velocity cuts near the center of the tool. In fact, the resulting potential increase of tool wear turns out to be less disadvantageous to the field of application than an increase of material waste and machining time, which would otherwise accompany an arbitrary control of tool orientation.The target surface is represented implicitly by means of a signed distance functionΦ(q)∈R, which assigns each pointq=(x,y,z)Tits signed minimal distance to the object surface  [11]. This way, using the isosurfaceΦ=r(set of pointsqsatisfyingΦ(q)=r) as target surface to be sampled avoids the need for handling ccps and their transformation explicitly, sinceΦassures that every pointqsatisfyingΦ(q)=ris a clp of some contact point(s) on the object surface—direct collisions are avoided by construction, while indirect collisions are resolved in a subsequent step.Intersecting a plane with the target surfaceΦ=ryields isoplanar curves that are sampled to get an ordered sequence of clps, also denoted as a subpath. The essential part remains the selection of planes to sample the target surface according to a predefined accuracy of fit. Besides planes, more general parametric sectional functions may be used to generate isoparametric subpaths as shown below.The proposed approach, as given by Algorithms 1 and 2, uses a global strategy to uniformly cover the object: the sampling of the target surface by means of subpaths is recursively refined and coarsened. Due to the recursive trimming of subpaths, it contrasts with conventional isoparametric path planning. The algorithm–denoted PlacePathIsoplanar–initializes with two sectional planes bordering the processed region from opposite sides (step 1 and Fig. 5(a)). Then it recursively inserts a further sectional plane in between each pair of bordering planes as long as the resulting accuracy within the bordered region is insufficient (step 2 and Algorithm 2). A predefined accuracy is given by means of a distancedtreshbetween subpaths of neighboring planes. In fact, ifdtreshis exceeded somewhere along the subpaths of two neighboring planes, at least one more intermediate plane is needed to refine sampling (Algorithm 2 steps 2–5). Since, in general, a subpath resulting from the insertion of a middle plane in step 3 of Algorithm 2 will not be entirely necessary, the algorithm eventually trims each subpath where the path distance is unnecessarily low (Algorithm 2 step 6): a pointxof an intermediate subpathp3is considered unnecessary, if the sum of the least distances betweenxand the bordering subpathsp1andp2is less thandtresh. In this case, a maximum path distance ofdtreshbetweenp1andp2will not be exceeded even if the “interstation”xonp3is removed. In this sense, every unnecessary point of the intermediate pathp3is removed in order to reduce path length by preventing oversampling. Fig. 5 shows the first three stages of the recursive sampling and Fig. 6shows an exemplary resulting path.The recursive sampling is generalizable, in that other implicit functions than a plane can be used to generate subpaths. Thus, the isoplanar sampling turns into an isoparametric one, and the (iso-)parameter refers to the employed sectional function. An example is shown in Fig. 7, in which spheres instead of planes are used to generate subpaths.The disadvantage of isoparametric path planning is a non-uniform relation between the (iso-)parameter of the sectional function and the target surface. In general, this fact causes the sampling accuracy to vary and the path length to be unnecessarily long. However, its advantage is a uniform and strictly predefined path pattern, which may by beneficial on certain machines.Isogeodesic path planning does not use an external sectional function to systematically construct partial paths, instead partial paths are exclusively defined by the target surface itself. Since each potential clp resides on a two-dimensional manifoldSconsisting of the set of points{q|Φ(q)=r}, it can in principle be specified by means of two parametric coordinatesq=S(u,v). A partial pathpiis then defined via the property that every pointqof the path has a constant geodesic distanceνito a predefined reference pointqrefor reference pathpref. More specifically, there is a two-dimensional geodesic distance functionϕ(u,v)defined on the surfaceS, with the result thatpiis defined by a set of points satisfying{q=S(u,v)|ϕ(u,v)=νi}. By equidistantly sampling the distanceνiby means of a predefined step sizedtresh, the resulting side step between neighboring partial paths is by constructiondmin=dmax=dtresh.The geodesic distance functionϕ(u,v)is numerically approximated by firstly interpolating and triangulating the offsetΦ=rby means of marching cubes  [15]. Secondly, each resulting vertex of the triangulation is assigned its distance to the reference path or point, in which the latter is computed using the approach described in  [16]. The level setϕ=νican now be extracted by means of marching triangles. Therefore, a concrete parametrization of the offset surfaceΦ=ris not necessary for the representation and propagation of tool location pathsϕ=νi, and was solely used for notational purposes.Since the height of the resulting scallop between neighboring pathsϕ=νiandϕ=νi+1depends on the side step as well as the surface curvature in step direction, a constant (geodesic) step size does not necessarily result in a constant scallop height. More precisely, the relation between the scallop heighthand the side step sizeΔν=(νi+1−νi)on an offset surface with curvatureκin the side step direction can be approximated by  [9](1)Δν=8hrκκ−r.Sinceϕis a distance function, its level sets propagate in the direction given by∇ϕ, which corresponds to the conventional side step. Denoting the curvature in propagation direction asκ(∇ϕ)a modulation of the initial distance functionϕproportional toκ(∇ϕ)is sufficient to convert isogeodesic into isoscallop sampling. Due to the discrete representation ofϕ, its adjustment consists of approximating∇ϕas well asκ(∇ϕ)at each vertex numerically and adjusting the vertex distance accordingly. The definition and calculation of an appropriate distance adjustment is part of current development and beyond the scope of this paper. Note that due to the implicit representation of tool location paths by means ofΦandϕ, no external guide surface is needed.Fig. 8(a) visualizes an exemplary geodesic distance fieldϕ(u,v)defined on the offset surfaceΦ=rof the object in Fig. 6 by means of vertex coloring. The reference pointqrefis chosen to be the highest point of the surface. Fig. 8(b) shows the resulting partial paths corresponding to a step sizedtresh=0.2, i.e.ϕ=νiwithνi=0.2i.Until now, either the entire cutting region (in the case of roughing), or its two-dimensional subspace constituting the offset surface (in the case of finishing) has been sampled by means of a setPof partial pathsP={p0,…,pM−1}, in which each pathpiis an ordered sequence of configurations solely specifying tool location. The final working step consists of defining the remaining dimensions of each configuration and sortingP. Therefore, the following five steps have to be solved, which will only shortly be described below since they are technically rather than conceptually interesting:1.for each desired location, identify configuration candidates that are free from indirect collisionssplitPinto two setsPtopandPbottomcontaining configurations to be machined from top or bottom side, respectivelyselect a final tool configuration at each desired location according to an optimality condition, and discard locations which exclusively induce indirect collisions (since tool orientation was deferred, see above)order the set of paths to minimize global path lengthinsert detours to remove collisions from path joints.Step 1 explores a discretized subspace of the configuration spaceC, containing only the orientational component of a tool configuration, and the positional part being fixed (for efficiency reasons, the position was computed previously by means of surface sampling, cf. Sections  3.2.1 and 3.2.2). The GPU and OpenGL is employed to accelerate exploration by means of multithreading. The result is a so-called point visibility map at each desired location—a Boolean vector (4-axes) or matrix (5-axes) indicating the occurrence of a collision at a specific orientation. Assuming 4-axis machining, Fig. 9shows the visibility vectors along three exemplary partial paths concatenated into a so called path visibility map—a matrix in case of 4-axis machining.Step 2 is justified twofold: typically the work area of miniature milling machines is too low to machine a blank at every possible work angle without penetrating the construction. Turning the blank therefore involves moving the spindle to a safe position at first, which is very time consuming. Secondly, material is removed solely in a small region around an object to save expensive raw material and avoid unnecessary cutting, which in turn prevents a fluent passage between the object’s top and bottom side.Step 3 uses a graph search approach to find a path through each path visibility map (cf. Fig. 9) that minimizes the total number of orientation adjustments. Instead, other objective functions than total variation could be used, which incorporate an optimal work angle regarding the current surface patch, e.g. sturz milling. However, since this optimal work angle will generally not be usable due to indirect collisions or kinematic restrictions (4-axes), it is ignored.Step 4 considers each partial pathpias a node of a complete directed graph. The cost of each edge of the graph is the directed distance between the corresponding nodes. More specifically, the cost of an edge(pi,pj)is the length of a connecting path that safely moves the tool from the last point of partial pathpito the first point ofpj, including detours required to avoid collisions. The straight Euclidean distance between the end and starting point is an insufficient measure of cost, since it underestimates distance by assuming a typically unsafe connection betweenpiandpj. The shortest possible global path is now given by means of a round trip with minimal costs (TSP). Since the computation of edge costs is time consuming due to the need for computing a potential detour, greedy search is used to compute an approximately optimal trip. Since reversing or shifting the partial pathspiorpjcorresponding to an edge(pi,pj)may significantly reduce edge cost, there are also shifted versions (in case of a closed path) or a reversed version (in case of an open path) of each partial path included into the greedy search.Given an ordered sequence of partial paths, step 5 employs a GPU-assisted detour planning to compute additional tool configurations that safely connect the end of a preceding and the beginning of a succeeding partial path if there would otherwise be a collision. Similarly, indirect collisions may occur on a change of tool orientation or after deletion of inadmissible configurations within a partial path, which are handled the same way.The calculation of an ordered sequence ofNtool configurationsc0,…,cN−1according to Section  3 does not provide a complete parametrization of the machine’s degrees of freedom, since the speed of transition between configurations (feed rate or axial speed), as well as the tool’s number of revolutions (cutting speed or spindle speed) remained unconsidered until now in order to make tool path calculation tractable. This neglect may be unproblematic if a predefined constant speed is applicable and the tool’s maximum load will not be reached. Nevertheless, a workload-adaptive feed rate may reduce processing time in this case by using an increased speed where appropriate. If, in contrast, a constant speed causes the tool to reach its mechanical or thermal maximum load, controlling the tool’s load by means of an adaptive feed rate is essential in order to avoid damages of the tool or machined surface.Basically, two types of speed control are distinguishable, namely a predictive control based on a preliminary offline-simulation of the machining process, and a reactive control based on measurements of appropriate features (e.g. electric current, temperature, force) during the machining process. The former denotes an open loop control, the latter a closed loop control, whereby both types are naturally combinable within an automatic manufacturing system  [17].The current section describes an implementation of a predictive feed rate optimization in the context of dental implant machining using miniature milling machines. Besides feed rate computation, the simulation essentially serves the purpose of tool path validation, evaluation and visualization. A reactive speed control, supplemented by a tool-breakage recognition, is furthermore part of current work.In order to achieve a universal approach that robustly allows the machined surface to change shape and topology arbitrarily, the simulation is based on an implicit representation of the material volume and the tool’s range of influence by means of level sets. The material volume needs to be approximated numerically due to its shape evolving arbitrarily in time, whereas the tool’s range of influence is specified analytically to allow for an efficient update of the material surface.For this purpose, the cutting region is discretized by means of a grid, in which each grid point maintains the (scaled and shifted—c.f. Eq. (6)) least signed distance to the material surface. Denoting this distance field byΨ(q), the material surface is consequently given via the isocontourΨ=ν, for an appropriately chosenνwhich depends on scaling/shifting. For each pair of consecutive tool configurations(ci,ci+1)the sweep volume, as induced by moving the (cutting part of the) tool fromcitoci+1, is specified analytically by means of a distance functionΘi(q).Note the following advantages over conventional approaches:•using level sets (i.e. signed distance fields) instead of Boolean voxels  [18] results in a superior approximation quality of the material surface with less grid points, since resulting isosurfaces are smoothly interpolated instead of piecewise constantscaling and shifting the distance values (cf. Eq. (6)) reduces the amount of memory per grid point to a single byte (instead of 4 byte floats)using a sparse level set representation (e.g.  [19]) instead of a dense grid to approximateΨsignificantly reduces memory usage and decouples it from the cutting region size; the concrete representation ofΨis beyond the scope of this paperspecifying the tool’s transition fromcitoci+1analytically as described below results in a superior approximation quality and efficiency of the sweep volume compared to e.g. sampling the tool configuration at isolated intermediate points  [18]evolving the material surface to account for each tool path segment(ci,ci+1)can be massively parallelized using OpenCL, since only grid points of the scalar field need to be updated.By using a combination of analytical and numerical implicit representations of relevant shapes, the focus of the presented simulation is most likely comparable to that of  [13], while the latter uses a basically different approach to computeΘi(q), i.e. the signed distance to the swept volume.As mentioned above, the material volume within the cutting region is captured by a scalar functionΨ(q)∈R, which in turn is numerically approximated by a set of grid points. In this paper, an equidistant grid is simplistically assumed, defined by(x0+mxΔx,y0+myΔy,z0+mzΔz)T∈R3with0≤mx≤Mx−1,0≤my≤My−1,0≤mz≤Mz−1. The constants(Δx,Δy,Δz)control the resolution of the cutting region,(Mx,My,Mz)its size and(x0,y0,z0)its position in space.The raw material volumeMVis a subset ofR3given by(2)MV={q=(x,y,z)T∈R3|Ψ(q)≥ν},while the surrounding volumeSV(e.g. air, cooling fluid) is the complement ofMV:(3)SV=MVC={q=(x,y,z)T∈R3|Ψ(q)<ν}.The machined material surface is given by the subsetΨ=ν.The simulation abstracts from real life chipping insofar as a point(x,y,z)T∈R3within the cutting region “looses” material as soon as it is located within the range of influence of the tool at some timet. This range of influence in turn depends on the tool’s pose, geometry and direction of movement. More precisely, the transition from configurationcitoci+1at timetiinduces a sweep volume defining the range of influenceRIiof the tool. Representing this sweep volume implicitly by means of a signed distance functionΘi(q)∈Ryields the following subset ofR3:(4)RIi={q=(x,y,z)T∈R3|Θi(q)≤0},in whichΘiassigns each point in space its distance to the (boundary of the) range of influence at timeti. Notes on the computation ofΘiare given below.The intersection ofRIiand the raw material volumeMViat timetiyields an approximation of the cut volume, i.e. the removed material volume at the corresponding path segment(ci,ci+1). Three exemplary sweep volumes are shown in Fig. 10. The material volume at the subsequent point in timeti+1is given by subtracting the sweep volume from the material volume at timeti:(5)MVi+1=MVi−RIi=MVi∩RIiC.Due to an implicit representation ofMV(scalar fieldΨ) andRIi(distance functionΘi), updating the material volumeMVat path segment(ci,ci+1)reduces to an easily parallelizable update of the cutting region grid points:(6)Ψi+1(q)=min(Ψi(q),(Θi(q)+ν)si).Given a contour valueν, the equation ensures the coincidence of the evolved region of the material surfaceΨ=νand the boundary of the range of influenceΘi=0. Scaling the value range ofΘiby the factorsiallows to better exploit the (restricted) value range ofΨin order to capture the relevant material boundary in more detail. Choosing e.g.ν=127.5andsi=Θi/r+1results in linearly scaling the boundary region−r≤Θi≤rof the tool’s range of influence to the entire interval[0,255], with the material surface being given byΨ=127.5. Beyond this boundary region, exact distances toΘ=0are irrelevant and set to 0 (Θ<−r) or 255 (Θ>r). This way, the scalar fieldΨis directly visualizable using methods of direct volume visualization, e.g. ray casting  [15].The essential part remains the analytical specification of the sweep volumes. The functionΘiassigns each pointq∈R3in space its distance to the boundary of the tool as it transitions fromciintoci+1. Since it is unknown at which intermediate configurationc∗along the path segment the tool will be coming closest to the pointq, this task is more complicated than just sampling fixed intermediate configurations and neglecting any movement in between. However,Θiyields a notably smoother approximation of the true cut volume, since a continuous transition is assumed. Given any pointqand a path segment(ci,ci+1), the proposed approach to computeΘi(q)consists of the following three steps. For the explanation, let each tool configurationc=(u,n)denote a tuple of a tool positionu∈R3and normal vectorn∈R3(tool orientation).1.Guess a configurationcthat corresponds toqby interpolating the tool positionuwhich is closest toq: presupposing linear movement,uis given by projectingqonto the line segment(ui,ui+1)that connects the tool positions atciandci+1; the same weight is then used to interpolate the orientationnto yield the guessc.Dependent on the guessed pose(u,n), correctuby displacement along the line segment(ui,ui+1):u∗=u+du(ui+1−ui). The displacementdu∈Rdepends on the tool geometry, the angle betweennand(ui+1−ui)and the relative location ofq. Use the interpolation weight ofu∗to computen∗to yield the revisionc∗.Use the revised interpolated tool posec∗=(u∗,n∗)along with the (analytically specified) tool geometry to compute the distance between the tool boundary andq, e.g. a point-cylinder distance in case of a flat end cutter. As usual, more complicated geometries are subdivided into simpler primitives.A more detailed treatment of this approach on continuous implicit sweep volumes is beyond the scope of this paper and dedicated to a separate publication. Especially steps 1 and 2 are novel in the context of tool path simulation, while step 3 is common (e.g.  [18]). Step 2 treats the fact that if the tool is inclined in moving direction, the pose which corresponds to the tool positionuclosest toq(in euclidean sense), does generally not induce the least distance betweenqand the tool boundary. In other words, the tool boundary comes closest toqeither before or after passing the guessed tool positionu, which is why the latter is corrected by a displacementdu. Fig. 11depicts the idea of computingΘi(q)using the presented approach of predictor–corrector interpolation. If, e.g.,nis orthogonal to the moving direction, the cutter shape is convex, and certain requirements on the rate of change of tool orientation are met, thendu=0.If a ball-end tool is used and no cutting is performed by the tool shaft,duis always 0 and step 2 is omitted to reduce runtime. This is the usual setting for finishing tool paths in dental applications - cf. the simplification without shaft depicted in Fig. 10(c).Choosing a step function with thresholdν=127.5as opacity transfer function in conjunction with a standard raycaster yields the exemplary results shown in Fig. 12.While, in principle, Eq. (6) concerns all grid points ofΨ, a potential movement of the material surface at timetiis restricted to the vicinity ofRIi. Therefore, to make sure the material surface is captured completely, it suffices to update the grid points ofΨwithin the bounding box ofRIiextended in each direction by the grid point spacing. This significantly reduces the number of evaluations ofΘiand unnecessary updates ofΨ.In the simulation, moving the material surface by subtracting a cut volume corresponds to an update of a subset of grid points, while in reality, mechanical work has to be performed to cut off a chip from raw material. Literature offers various approaches to transfer a concrete cut volume along with tool property definitions into physical features like force or tool deflection, which in turn allows to quantify a workload  [20–23].Simplistically, the current work assumes the loadability of a tool to be sufficiently captured by a single scalar feature, which defines the amount of material volume the tool is able to cut per second. A deviation of the true cut amount from the given reference value must result in a feed rate update to prevent an over- or underload of the tool. Every tool path segment(ci,ci+1)with a transition lengthli=|ui+1−ui|is assigned an amount of cut material volumevi, which is computed from the set of grid points satisfyingΘi≤0. The specification of a material removal ratemrras mentioned above allows a target feed ratefrito be computed by(7)fri={liΔti=limrrviifvi>0frmaxifvi=0,in whichΔtidenotes the desired time lapse of the transition fromcitoci+1, yielding an optimal tool workload in terms of the predefined material removal ratemrr. Note thatfrias given in Eq. (7) is valid only ifciandci+1contain different tool positions, since only in that caseli>0. This corresponds to allowing cutting solely by means of the translational component of the path segment(ci,ci+1)and to prohibit cutting by means of a sole change of orientation.

@&#CONCLUSIONS@&#
