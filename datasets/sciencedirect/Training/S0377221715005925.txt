@&#MAIN-TITLE@&#
Tracking the market: Dynamic pricing and learning in a changing environment

@&#HIGHLIGHTS@&#
We study dynamic pricing in an unknown, changing, market environment.We show how a price manager can hedge against changes in the market.We provide analytical bounds on the performance of this policy.We apply our method to the well-known Bass model, and to oligopoly pricing.

@&#KEYPHRASES@&#
Dynamic pricing,Learning,Varying parameters,

@&#ABSTRACT@&#
Dynamic pricing of commodities without knowing the exact relation between price and demand is a much-studied problem. Most existing studies assume that the parameters describing the market are constant during the selling period. This severely reduces their practical applicability, since, in reality, market characteristics may change all the time, without the firm always being aware of it. In the present paper we study dynamic pricing and learning in a changing market environment. We introduce a methodology that enables the price manager to hedge against changes in the market, and provide explicit upper bounds on the regret - a measure of the performance of the firm’s pricing decisions. In addition, this methodology guides the selection of the optimal way to estimate the market process. We provide numerical examples from practically relevant situations to illustrate the methodology.

@&#INTRODUCTION@&#
Firms selling products or delivering services face the complex task of determining which selling price to charge to their customers. Generally, firms aim at choosing selling prices that maximize certain performance indicators, such as revenue, profit, market share, or utilization rate. An intrinsic property of this decision problem is lack of information: the seller does not know how consumers respond to different selling prices, and thus does not know the optimal price. The problem of the firm is not merely about optimization, but also about learning the relation between price and market response.The presence of digitally available and frequently updated sales data makes this problem essentially an online learning problem: after each sales occurrence, the firm can use the newly obtained sales data to update its knowledge (for example, via statistical estimation methods). If, in addition, selling prices can quickly be modified, without much costs or effort - as often is the case in web-based sales channels or in brick-and-mortar stores with digital price tags - the firm can immediately exploit its improved knowledge on consumer behavior by appropriately adapting the selling prices.Optimal pricing policies for these type of problems have been researched extensively. Here we only list a sample of the recent OR/MS literature; for a more elaborate discussion, including relevant studies from the economics literature, we refer to den Boer (2015).Lobo and Boyd (2003), Carvalho and Puterman (2005b), Carvalho and Puterman (2005a), Bertsimas and Perakis (2006), Besbes and Zeevi (2009), Broder and Rusmevichientong (2012), den Boer and Zwart (2014) and Keskin and Zeevi (2014) are all studies that assume that the price-demand relation belongs to a parametric family, estimate the unknown parameters by classical estimation methods (such as linear regression or maximum likelihood estimation), and study optimal pricing policies. Similar approaches with Bayesian estimation methods, can be found in Lin (2006), Araman and Caldentey (2009), Farias and van Roy (2010) and Harrison, Keskin, and Zeevi (2012). Robust or nonparametric approaches are taken by Kleinberg and Leighton (2003), Cope (2007), Lim and Shanthikumar (2007), Eren and Maglaras (2010) and Besbes and Zeevi (2009).A main conclusion from this stream of literature is that, in general, firms should properly balance learning and instant optimization. That means that not always the price should be chosen that is optimal according to current parameter estimates, but some price variation should be induced to guarantee sufficient quality of future parameter estimates.All these studies have the assumption in common that the relation between price and expected sales is stable during the time horizon under consideration: the unknown parameters that describe this relation do not change. This is a rather strong assumption, which makes these studies less applicable in practical situations. Markets are generally not stable, but may vary over time, without the seller immediately being aware of it (cf. Dolan and Jeuland, 1981; Wildt and Winer, 1983, and Section 2 of Elmaghraby and Keskinocak, 2003). These changes may have various causes: shifts in consumer tastes, competition (Wildt & Winer, 1983), appearance of technological innovations (Chen & Jain, 1992), market saturation and product diffusion effects related to the life cycle of a product (Bass, 1969; Dolan & Jeuland, 1981; Raman & Chatterjee, 1995), marketing and advertisement efforts (Horsky & Simon, 1983), competitors entering or exiting the market, appearance of new sales channels, and many more.Wildt and Winer (1983) argued already in 1983 that “constant-parameter models are not capable of adequately reflecting such changing market environments”. In fact, this issue has been known since longtime in the historical literature on statistical economics, as illustrated by the following quotation of Schultz (1925) on the law of demand:“The validity of the theoretical law [of demand] is limited to a point in time. But in order to derive concrete, statistical laws our observations must be numerous; and in order to obtain the requisite number of observations, data covering a considerable period must be used. During the interval, however, important dynamic changes take place in the condition of the market. In the case of a commodity like sugar, the principal dynamic changes that need be considered are the changes in our sugar-consuming habits, fluctuations in the purchasing power of money, and the increase of population.” page 409 of Schultz (1925).Although the literature on dynamic pricing and learning has increased rapidly in recent years, models with a varying market have hardly been considered. This motivates the current study of dynamic pricing and learning in a changing environment.In the present paper we study the problem of dynamic pricing and learning in a changing environment. We study the situation where a monopolist firm is selling a single type of product with unlimited inventory. We consider an additive demand model, where the expected demand for the product in a certain time period is the sum of a stochastic market process and a known function depending on the selling price. The characteristics of this stochastic process are unknown to the firm. Its value at a certain point in time may be estimated from accumulated sales data; however, since the market may be changing over time, estimation methods are needed that are designed for time-varying systems. We deploy two such estimators, namely estimation with a forgetting factor, and estimation based on a “sliding window” approach. For both estimators we derive an upper bound on the expected estimation error.Next, we propose a simple, intuitive pricing policy: at each decision moment, the firm estimates the market process with one of the just mentioned estimators, and subsequently sets the next selling price equal to the price that would be optimal if the firm’s market estimate were correct. This is a so-called myopic or certainty equivalent policy: at each decision moment the firm acts as if being certain about its estimates. To measure the quality of this pricing policy, we define AverageRegret(T), which measures the expected costs of not choosing optimal prices in the first T periods, and LongRunAverageRegret, which equals the limit superior of AverageRegret(T) as T grows large. We derive upper bounds on AverageRegret(T) and LongRunAverageRegret. These bounds are not only stated in terms of the variables associated with the used estimation method (the forgetting factor, or the size of the sliding window), but also in terms of a measure of the impact that market fluctuations have on the estimation error. Clearly, if the market is very unstable and inhibits very large and frequent fluctuations, the impact may become extremely large, which negatively affects the obtained revenue.The novel, key idea of this study is that (i) this impact can be bounded using assumptions on the market process that the firm makes a priori, (ii) the resulting upper bounds on AverageRegret(T) and LongRunAverageRegret can be used by the firm to determine the optimal estimator of the market (i.e. the optimal value of the forgetting factor or window size), (iii) this provides the firm explicit guarantees on the maximum expected revenue loss. This framework enables the firm to hedge against change: the firm is certain that the expected regret does not exceed a certain known value, provided the market process satisfies the posed assumptions. These assumptions may be very general and cover many important cases; for example, bounds on the probability that the market value changes in a certain period, bounds on the maximum difference between two consecutive market values, or bounds on the maximum and minimum value that the market process may attain. We provide numerical examples to illustrate the methodology, in two practically relevant settings: in the first we make use of the well-known Bass model to model the diffusion of an innovative products; and in the second we consider an oligopoly where price changes by competitors causes occasional changes in the market. The application of our methodology on the Bass model makes this the first study that incorporates learning and pricing in this widely used product-diffusion model; thus far, only deterministic settings (Dolan & Jeuland, 1981; Kalish, 1983; Robinson & Lakhani, 1975), or random settings where no learning is present (Chen & Jain, 1992; Kamrad, Lele, Siddique, & Thomas, 2005; Raman & Chatterjee, 1995) have been considered in the literature.Summarizing, in one of the first studies on dynamic pricing and learning in a changing environment, our contributions are as follows.(i)We introduce a model of dynamic pricing and learning in a changing market environment, using a very generic description of the market process.We discuss two estimators of time-varying processes, and prove upper bounds on the estimation error.We propose a methodology that enables the decision maker to hedge against change. This results in explicit upper bounds on the regret, and guides the choice of the optimal estimator.We show the application of the methodology in several concrete cases, and offer numerical examples to illustrate its use and performance. These examples show that incorporating the changing nature of the market process can significantly improve a firm’s revenue.The combination of dynamic pricing and learning in a changing market is a rather unexplored area. Chen and Jain (1992) consider optimal pricing policies in models where the demand not only depends on the selling price, but also on the cumulative amount of sales; in this way diffusion effects are modeled. In addition, the demand is influenced by an observable state variable, which models unpredictable events that change the demand function, and whose dynamics are driven by a Poisson process. Apart from these random events, the demand is fully deterministic and known to the firm, and learning by the firm is not considered. Hanssens, Parsons, and Schultz (2001) and Section 2.3 of Leeflang et al. (2009) discuss several dynamic market models, as well as estimation methods, but do not integrate this with the problem of optimal dynamic pricing. Besbes and Zeevi (2011) study a pricing problem where the willingness-to-pay (WtP) distribution of the customers changes at some unknown point in time. The WtP distribution before and after the change are assumed to be known, only the time of change is unknown to the seller. Lower bounds on the worst-case regret are derived, and pricing strategies are developed that achieve the order of these bounds. Besbes and Sauré (2014) consider dynamic pricing with finite selling season and finite inventory that cannot be replenished. The demand function is unknown and subject to abrupt changes. The authors focus on the trade-off between gaining revenue before and after the change-point, and derive in various settings structural properties of the optimal price policy. Perhaps closest to our work is Keskin and Zeevi (2013), who study learning-and-earning in a setting similar to ours, but with different assumptions on the information known to the seller. The authors consider asymptotically optimal policies in different settings, and prove lower and upper bounds on the regret. A relevant study from the control literature is from Godoy, Goodwin, Aguero, and Rojas (2009). They consider an estimation problem in a linear system, where the parameters are subject to shock changes, and analyze the performance of a sliding-window linear regression method. A major assumption is that the controls are deterministic. This differs from pricing problems, where the prices (the controls) usually depend in a non-trivial way on all previously observed sales realizations. We also refer to recent work by Garivier and Moulines (2011) on multi-armed bandit problems with time-varying parameters. Two differences between their and our work are (i) they consider a discrete action set, whereas, in our setting, prices can be chosen from a continuum, and (ii) they restrict themselves to abruptly changing environments, whereas our analysis is more generic, including slowly changing environments. Finally, we mention the recent work by Rana and Oliveira (2014), who consider dynamic pricing of a finite inventory in a non-stationary environment. The authors propose two variants of Q-learning to learn the optimal price policy, and compare the performance of these learning algorithms using Monte-Carlo simulations.The rest of this paper is organized as follows. Section 2 introduces the model, discusses estimation methods for the market process, gives bounds on the estimation error, and provides a discussion on various model assumptions. Section 3 introduces the methodology for hedging against change: we formulate the pricing myopic policy and provide performance bounds in Section 3.1, we show in Section 3.2 how assumptions on the market process can be used to find the optimal estimator that minimizes these regret bounds, and provide in Section 3.3 three examples of the methodology. The results of two numerical studies are described in Section 4, and conclusions and directions for future research are discussed in Section 5. All mathematical proofs are contained in Section 6.We consider a monopolist firm selling a single type of product. In each time periodt∈N,the firm decides on a selling price pt∈ [pl, ph], where 0 ≤ pl< ph< ∞ denote the lowest and highest admissible price. After choosing the price, the seller observes demand dt, which is a realization of the random variable Dt(pt). Conditional on the selling prices, the demand in different time periods is independent. The expected demand in period t, against a price p, is of the form(1)E[Dt(p)]=M(t)+gt(p).Here(M(t))t∈Nis a stochastic process called the market process, unobservable for the firm, and taking values in a (possibly infinite) intervalM⊂R. LetFtbe the σ-algebra generated byd1,p1,M(1),…,dt,pt,M(t),F0the trivial σ-algebra, and writeϵt=dt−gt(pt)−M(t); then we assume that M(t) andϵtareFt−1-measurable, for allt∈N. In addition we impose the following mild conditions on the moments of M(t) andϵt: there are positive constants σMand σ, such that(2)supt∈NE[M(t)2∣Ft−1]≤σM2a.s.andsupt∈NE[ϵt2∣Ft−1]≤σ2a.s.The functions gtin (1) model the dependence of expected demand on selling price. They are assumed to be known by the seller. After observing demand, the seller collects revenue ptdt, and proceeds to the next period. The purpose of the seller is to maximize expected revenue.Letrt(p,M)=p·(M+gt(p))denote the expected revenue in periodt∈N,when the market process equals M and the selling price is set at p. The price that generates the highest amount of expected revenue, given that the current market equals M, is denoted bypt*(M)=argmaxp∈[pl,ph]rt(p,M).We impose some mild conditions to ensure that this optimal price exists and is uniquely defined. In particular, we assume that for all admissible prices p and allt∈N,gt(p) is decreasing in p, and twice continuously differentiable w.r.t. p, with first and second derivative denoted bygt′(p)andgt′′(p). These two properties immediately carry over to the expected demand, and in fact are quite natural conditions for demand functions to hold. In addition, we assume that for allM∈Mand allt∈Nthe revenue function rt(p, M) is unimodal with unique optimumpt#(M)∈Rsatisfyingrt′(pt#(M),M)=0,and in addition(3)sup{rt′′(pt#(M),M)∣t∈N,M∈M,pt#(M)∈[pl,ph]}<0,wherert′(p,M)andrt′′(p,M)denote the first and second derivative of rt(p, M) w.r.t. p.The value of the market process and the corresponding optimal price are unknown to the seller. As a result, the decision maker might choose sub-optimal prices, which incurs a loss of revenue relative to someone who would know the market process and the optimal price. The goal of the seller is to determine a pricing policy that minimizes this loss of revenue. With a pricing policy we here mean a sequence of (possibly random) prices(pt)t∈Nin [pl, ph], where each price ptmay depend on all previously chosen pricesp1,…,pt−1and demand realizationsd1,…,dt−1.To assess the quality of a pricing policy Φ, we define the following two quantities.(4)AverageRegret(Φ,T)=1T−1∑t=2TE[rt(pt*(M(t)),M(t))−rt(pt,M(t))],(5)LongRunAverageRegret(Φ)=lim supT→∞AverageRegret(Φ,T).Each term in the summand of (4) measures the expected revenue loss caused by not using the optimal price in period t. The expectation operator is because both ptand M(t) may be random variables. We start measuring the average regret from the second period. This simplifies several expressions that appear in further sections; in addition, in the first period, no data is available to estimate M(1), and minimizing the instantaneous regret encountered in the first period is not possible. Furthermore, note that AverageRegret(Φ, T) and LongRunAverageRegret(Φ) are not observed by the seller, and thus can not directly be used to determine an optimal pricing policy.Estimating the value of the market process gives vital information that is needed to determine the selling price. Since the market may change over time, the firm needs an estimation method that can handle such changes. In this section we describe two such methods: (I) estimation with forgetting factor, and (II) estimation with a sliding window.(I) Estimation of M(t) with forgetting factor. Let λ ∈ [0, 1] be the forgetting factor, to be determined by the decision maker. The estimateM^λ(t),with forgetting factor λ, based on demand realizationsd1,…,dtand pricesp1,…,pt,is equal to(6)M^λ(t)=argminM∈R∑i=1t(di−M−gi(pi))2λt−i.The factorλt−iacts as a weight on the data (pi, di)1≤i≤t. Data that lies further in the past gets a lower weight; data from the recent past receives more weight (unlessλ=1,in which case all available data gets equal weight, orλ=0,in which case only the most recent observation is taken into account). This captures the idea that the longer ago data has been generated, the likelier it is that the corresponding value of the market process differs from its current value. Accordingly, data from longer ago is assigned a smaller weight than data from the more recent past. Whether this intuition is true depends of course on the specific characteristics of M(t).By differentiating the righthandside of (6) w.r.t. M, we obtain the following explicit expression forM^λ(t):(7)M^λ(t)=∑i=1t(di−gi(pi))λt−i∑i=1tλt−i.(II) Estimation of M(t) with a sliding window. LetN∈N≥2∪{∞}be the window size, determined by the decision maker. The estimateM^N(t),with sliding window size N, based on demand realizationsd1,…,dtand pricesp1,…,pt,is equal to(8)M^N(t)=argminM∈R∑i=max{t−N+1,1}t(di−M−gi(pi))2.Here only data from the N most recent observations is used to form an estimate. All data that is generated longer than N time periods ago, is neglected (ifN=∞,then all available data is taken into account). Similar to the estimate with forgetting factor, the rationale behind the estimateM^N(t)is the idea that for data generated long ago, it is more likely that the corresponding market value differs from its current value. This is captured in the fact that only the N most recent observations are used to estimate M(t). Whether this idea is correct depends again on the specifics of M(t).Differentiating the righthandside of (8) w.r.t. M, we obtain the following expression:(9)M^N(t)=1min{N,t}∑i=max{t−N+1,1}t(di−gi(pi)).Remark 1Both estimation methods (I) and (II) depend on a decision variable (λ resp. N) that can be interpreted as a measure for the responsiveness to changes in the market. A high value of λ resp. N means that much information from the historical data is used to form estimates; this is advantageous in case of a stable market, but disadvantageous in case of many or large recent changes in the market process. Similarly, a low value of λ resp. N implies that the estimate of M(t) is mainly determined by recent data; naturally, this is more beneficial in a volatile market than in a stable market.Market fluctuations influence the accuracy of the estimatesM^λ(t)andM^N(t). The following quantities Iλ(t) and IN(t) measure this impact of market variations on the estimates. Observe that this impact is not solely determined by the market process, but also by the choice of λ and N:Iλ(t)=E[|(1−λ1−λt1(λ<1)+1t1(λ=1))∑i=1t(M(i)−M(t+1))λt−i|2],IN(t)=E[|1min{N,t}∑i=1+(t−N)+t(M(i)−M(t+1))|2].The following proposition gives a bound on the expected estimation error of (I) and (II), in terms of λ, N, and the impact measures Iλ(t) and IN(t).Proposition 1For allt∈N,(10)E[|M^λ(t)−M(t+1)|2]≤2σ2×[(1−λ)(1+λ)(1+λt)(1−λt)1(λ<1)+1t1(λ=1)]+2Iλ(t)and(11)E[|M^N(t)−M(t+1)|2]≤2σ2min{N,t}+2IN(t).If the processes(ϵt)t∈Nand(M(t))t∈Nare independent, then(12)E[|M^λ(t)−M(t+1)|2]≤σ2×[(1−λ)(1+λ)(1+λt)(1−λt)1(λ<1)+1t1(λ=1)]+Iλ(t)and(13)E[|M^N(t)−M(t+1)|2]≤σ2min{N,t}+IN(t),with equality in(12)and(13)if the disturbance terms are homoscedastic, i.e.E[ϵt2∣Ft−1]=σ2for allt∈N.The first terms of the righthandsides of (10)–(13) are related to the natural fluctuations in demand. The lower these fluctuations, measured by σ2, the lower this part of the estimation error becomes. The second terms of the righthandsides of (10)–(13) relate to the impact that market fluctuations have on the quality of the estimate of M(t). These terms are nonnegative, and equal zero if the market value does never change.Our demand model is of the additive formE[Dt(p)]=M(t)+gt(p),where M(t) is unknown and gt(p) is known. The term M(t) can be regarded as capturing various time-varying aspects of the true demand model, with possibly complex behavior that is not fully known or understood by the decision maker. If we would only assume that M(t) lies in some known uncertaintyM,then a typical approach would be to optimize the price given the worst-case value of M(t) inM. A disadvantage of this robust optimization approach is that the accumulating observations of(M(t))t∈Nare not used by the firm to improve its price decisions. Our work distinguishes itself from the ‘static’ robust optimization approach by allowing some way learning or tracking the market process.An alternative way of viewing the demand model is to regard gt(p) as the firm’s local approximation of a more complex demand model, and M(t) as the time-dependent deviation between this approximation and the true demand. In this way M(t) may capture (unavoidable) model errors made by the firm.Note that instead of an additive model one could also assume a multiplicative demand model, where the expected demand is the product of the two parts:E[Dt(p)]=M(t)·gt(p). An advantage of a multiplicative model is that, under some additional assumptions, the aggregate demand in a time period may be explained in terms of the buying behavior of individual customers. For example, one could assume that individual customers have a willingness-to-pay (WtP) distribution F(p): if the selling price equals p, a randomly selected customer buys a product with probability1−F(p). If there are M(t) customers present, and their buying-decisions are mutually independent, then the expected aggregated demand E[D(p)] has the multiplicative formM(t)·(1−F(p)). Such demand model can thus be explained in terms of the behavior of individual customers, but only using the strong assumptions that the customers behave independently and buy only a single product. In our setting it would be inappropriate to pose such strong assumptions on consumer behavior: we study how a seller can handle a volatile, unstable market while making only minor assumptions on its behavior.Another motivation for the additive demand model is related to the optimal price. By differentiating the revenue function w.r.t. p, one can easily show that the optimal price in a multiplicative demand model is the solution to the equationpgt′(p)/gt(p)=−1. This equation is independent of the market process, and as a result, the firm does not need to know or estimate the market in order to determine the optimal selling price. Intuitively it is clear that for many products such a model does not accurately reflect reality.An important subclass of our demand model is the setting wheregt(p)=g(p),i.e. the expected demand is the sum of a time-dependent part and a price-dependent time-homogeneous part. Such demand models appear frequently in the literature: for example, in models that incorporate competition (Cooper, de Mello, & Kleywegt, 2014; Puu, 1991; Tuinstra, 2004), or models that capture market diffusion and saturation effects (Section IV of Chen and Jain (1992), Section 4.3 of Raman and Chatterjee (1995), Section 3.3.1 of Kalish (1983)). Some of the numerical examples in Section 4 apply our pricing policy to these two settings.The fact that the price-dependent part gt(p) is assumed to be known by the seller is an arguably strong assumption made in this study. In practice, sellers may have some level of ambiguity about gt. An alternative approach could be to estimate gtfrom data; for example, one could assume a parametric formgt(p)=−btp,for some bt> 0, estimate btwith least-squares linear regression, and analyze pricing policies similar to those proposed in this paper. The main drawback of this approach, however, is that it may be possible to derive upper bounds on the regret, as in Theorem 1, but it is very difficult to show, analogous to Proposition 2, that these bounds are sharp. We are able to derive these sharp results; this comes at the expense of stronger assumptions.The technical assumptions on gtand rtare fairly standard conditions on demand and revenue functions, and ensure that the revenue function is locally strictly concave around the optimum. Clearly, ifpt#(M)lies in the interval [pl, ph] thenpt*(M)=pt#(M),and ifpt#(M)∉[pl,ph],thenpt*(M)is the projection ofpt#(M)on the interval [pl, ph]. It is not difficult to show that the conditions on gtare satisfied for the linear demand model withgt(p)=−bpfor some b > 0. For nonlinear demand functions withgt(p)=−bpcfor some b > 0, c > 0, c ≠ 1, orgt(p)=−blog(p)for some b > 0, the conditions are satisfied if the market process is bounded.In this section we show how a price manager can hedge against changes in the market. The key idea is that a simply myopic policy can be used (which means that one always chooses the price that is optimal according to current estimates of the market process), but that the parameter λ of the market estimatorM^λ(t)(or N, for the estimatorM^N(t)) is chosen in a smart way.As already alluded to in Section 2.2, the optimal value of λ or N depends on the nature of changes in the market process. If changes are frequent and/or large, λ and N should be chosen small, whereas in case of infrequent and small changes in the market one intuitively expects that λ should be chosen close to one, and N large.Thus, in order to find a good choice of λ resp. N, the firm needs assumptions on the type of changes in the market that it is anticipating. Such assumptions can be translated into bounds on the behavior of the influence measures Iλ(t), IN(t), which in turn lead to bounds on the regret of the myopic policy. These regret bounds depend on λ or N, and minimizing them leads to the optimal value of λ or N w.r.t. the assumptions on the market imposed by the firm.The following two subsections elaborate this approach. Section 3.1 formulates the myopic policy and studies how the regret depends on the influence measures Iλ(t), IN(t). Section 3.2 explains the methodology in more detail, and Section 3.3 provides three illustrative examples.We consider the following simple, myopic pricing policy: at each decision moment the seller estimates the market value with one of the two estimation methods described in Section 2.2, and subsequently chooses the selling price that is optimal w.r.t. this estimate. In other words, the seller always acts as if the current estimate of the market is correct.We denote this policy by Φλif the market is estimated by method (I), with forgetting factor λ, and by ΦNif the market is estimated by method (II), with sliding window of size N. The formal description of Φλand ΦNis as follows.Myopic pricing policyΦλ/ΦNInitialization: Chooseλ∈[0,1]orN∈N≥2∪{∞}.Setp1∈[pl,ph]arbitrarily.For allt∈N:Estimation: LetM^·(t)denote eitherM^λ(t)(for policyΦλ) orM^N(t)(for policyΦN).Pricing: Setpt+1=pt+1*(M^·(t)).The following theorem provides upper bounds on the (long run) average regret for the myopic pricing policies, in terms of the influence measures Iλ(t) and IN(t).Theorem 1There is a K0 > 0 such that for all T ≥ 2,AverageRegret(Φλ,T)≤2K0σ2[1−λ1+λ+2T−1×(λlog(λ)+(1−λ)log(1−λ)(1+λ)log(λ))]1(λ<1)+2K0σ2[1+log(T−1)T−1]1(λ=1)+2K01T−1∑t=1T−1Iλ(t),andAverageRegret(ΦN,T)≤2K0σ2[log(min{T−1,N})T−1+1min{N,T−1}]+2K0T−1∑t=1T−1IN(t).Consequentially,(14)LongRunAverageRegret(Φλ)≤2K0[σ21−λ1+λ+lim supT→∞1T∑t=1TIλ(t)],for all λ ∈ [0, 1], and(15)LongRunAverageRegret(ΦN)≤2K0[σ21N+lim supT→∞1T∑t=1TIN(t)],for allN∈N≥2∪{∞},where we write1/∞=0.The main idea of the proof is to show that there is a K0 > 0 such that for any M and M′, the instantaneous regret in period t satisfiesrt(pt*(M),M)−rt(pt*(M′),M)≤K0(M−M′)2. Subsequently we apply the bounds derived in Proposition 1.Remark 3By (12) and (13), if the processes(ϵt)t∈Nand(M(t))t∈Nare independent, then all four inequalities of Theorem 1 are still valid if all righthandsides are divided by 2.An explicit expression for K0 is derived in the proof of Theorem 1. To obtain the most sharp bounds, one could also define K0 directly asK0=supt∈NinfM≠M′(rt(pt*(M),M)−rt(pt*(M′),M))/(M−M′)2. For the important special case of a stationary linear demand function, withgt(p)=g(p)=−bpfor some b > 0 and M(t) > 0 for allt∈N,it is not difficult to showpt*(M)=min{max{M/(2b),pl},ph}andK0=1/(4b).In dynamic pricing and learning studies that assume a stable market, one often considers the asymptotic behavior ofRegret(Φ,T)=(T−1)·AverageRegret(Φ,T),where Φ denotes the pricing policy that is used. Typically one proves bounds on the growth rate of Regret(Φ, T) for a certain policy, e.g.Regret(Φ,T)=O(T)orRegret(Φ,T)=O(log(T)). A policy is considered ‘good’ if the speed of convergence of the regret is close the best achievable rate, cf. Broder and Rusmevichientong (2012), Keskin and Zeevi (2014) and den Boer and Zwart (2014). In the setting with a changing market, a simple example makes clear that one cannot do better thanRegret(Φ,T)=O(T)orAverageRegret(Φ,T)=O(1). Suppose M(t) is a Markov process taking values in{M1,M2}∈R+2,with M1 ≠ M2, and supposeP(M(t+1)=Mi∣M(t)=Mj)=12,for all i, j ∈ {1, 2} andt∈N. Letgt(p)=g(p)=−bpfor some b > 0 and allt∈N,and choose [pl, ph] such thatpt#(Mi)=Mi/(2b)∈(pl,ph),fori=1,2. Then for allt∈N,the instantaneous regret incurred in period t satisfiesE[rt(pt*(M(t)),M(t))−rt(pt,M(t))]≥infp∈[pl,ph][12(rt(pt*(M1),M1)−rt(p,M1))+12(rt(pt*(M2),M2)−rt(p,M2))]≥b2infp∈[pl,ph][(p*(M1)−p)2+(p*(M2)−p)2]≥b4(pt*(M1)−pt*(M2))2≥116b(M1−M2)2>0,which implies that no policy can achieve a sub-linearRegret(Φ,T)=o(T). In fact, any pricing policy achieves the optimal growth rateRegret(Φ,T)=O(T). Thus, the challenge of dynamic pricing and learning in such a changing environment is not to find a policy with optimal asymptotic growth rate, but rather to make the (long run) average regret as small as possible.In view of the remark above, the question raises whether the bounds from Theorem 1 are sharp. The following proposition answers this question for the case of a linear stationary demand function with homoscedastic disturbance terms independent of the market process.Proposition 2Supposegt(p)=g(p)=−bpfor some b > 0 and allt∈N,E[ϵt2∣Ft−1]=σ2for allt∈N,the processes(ϵt)t∈Nand(M(t))t∈Nare independent, and M(t) ∈ [2bpl, 2bph] a.s. for allt∈N. Then, withK0=1/(4b),(16)LongRunAverageRegret(Φλ)=K0[σ21−λ1+λ+lim supT→∞1T∑t=1TIλ(t)],for all λ ∈ [0, 1], and(17)LongRunAverageRegret(ΦN)=K0[σ21N+lim supT→∞1T∑t=1TIN(t)],for allN∈N≥2∪{∞},where we write1/∞=0.The bounds on the regret that we derive in Theorem 1 are stated in terms of the influence measures Iλ(t) and IN(t). That means that the seller can get an explicit upper bound on the regret in terms of λ, N, if it can find upper bounds on the influence measures in terms of λ, N; subsequently, an optimal choice of λ, N can be found by minimizing these upper bounds on the regret.More precisely, the firm should translate its assumptions on the market process into (non-random) upper bounds on the terms1T−1∑t=1T−1Iλ(t)and1T−1∑t=1T−1IN(t). By plugging these bounds into Theorem 1, it obtains bounds on AverageRegret(Φλ, T) and AverageRegret(ΦN, T) in terms of λ and N. The optimal choices of λ and N are then determined by simply minimizing these bounds with respect to λ and N. In some cases an explicit expression for the optimal choice may exist, otherwise numerical methods are needed to determine the optimum.The resulting optimal optimal λ and N may depend on the length of the time horizon T. This may be undesirable to the firm, for instance because T is not known in advance, or because the time horizon is infinite. In this case it is more appropriate to minimize the LongRunAverageRegret. If the firm can translate its assumptions on the market process into upper bounds on the termslim supT→∞1T−1∑t=1T−1Iλ(t)andlim supT→∞1T−1∑t=1T−1IN(t),then these upper bounds can be plugged into (14) and (15), and the optimal λ and N can be determined by minimizing the resulting expression.Remark 6Observe that the optimal choices of λ and N are independent of the functions gt. The relevant properties of gtare captured by the constant K0, but its value does not influence the optimal λ and N. In a way this separates optimal estimation and optimal pricing: the first is determined by the impact of the market process, while only the latter involves the functions gt. On the other hand, the variance of the demand distribution, related to σ2, does influence the optimal λ and N. In addition, note that by Remark 3, the factor 2 on the righthandsides of (14) and (15) can be removed if the processes(ϵt)t∈Nand(M(t))t∈Nare independent. In practice, it may not always be known to the decision maker whether this condition is satisfied; but, fortunately, this does not influence the optimal choice of λ and N.The above presented methodology of hedging against change has some similarities with robust optimization. There, one usually considers optimization problems whose optimal solutions depend on some parameters. These parameters are not known exactly by the decision maker, but assumed to lie in a certain “uncertainty set” which is known in advance. The optimal decision is then determined by optimizing against the worst case of the possible parameter values. An improvement of our methodology compared to robust optimization is that we allow for many different types of assumptions on the market process, as illustrated by the three examples described in Section 3.3. In contrast, robust optimization generally only assumes a setting of an uncertainty set. In addition, in robust optimization there is usually no learning of the unknown parameters, whereas our methodology allows using accumulating data to estimate the unknown process; in several instances this enables us to “track” the market process.To illustrate the methodology, we look in more detail to three examples of assumptions on the market process: (i) bounds on the range of the market process, (ii) bounds on the maximum jump of the market process, and (iii) bounds on the probability that the market changes.In this section we consider the assumption that the market process is contained in a bounded interval.Proposition 3Ifsupt∈NM(t)−inft∈NM(t)≤da.s., for some d > 0, then(18)LongRunAverageRegret(Φλ)≤2K0[σ21−λ1+λ+d2],(19)LongRunAverageRegret(ΦN)≤2K0[σ21N+d2],for all λ ∈ [0, 1],N∈N≥2∪{∞},where we write1/∞=0.The righthandsides of (18) and (19) are minimized by takingλ=1andN=∞.At first sight it may seem somewhat surprising that it is beneficial to take into account all available sales data to estimate the market, including ‘very old’ data. This can be explained by noting that in a periodt+1,all preceding values of the marketM(1),…,M(t)may differ by d from the current valueM(t+1). In such a volatile market situation, it is best to ‘accept’ an unavoidable error caused by market fluctuations, and instead focus on minimizing the estimation error caused by natural fluctuationsϵ1,…,ϵtin the demand distribution. This is best done when all available data is taken into account; hence the optimality of choosingλ=1andN=∞.In this section we consider the assumption that the one-step changes of the market process are bounded.Proposition 4Ifsupt∈N|M(t)−M(t+1)|≤da.s., for some d > 0, then(20)LongRunAverageRegret(Φλ)≤2K0[σ21−λ1+λ+d21(1−λ)2],(21)LongRunAverageRegret(ΦN)≤2K0[σ21N+14d2(N+1)2],for all λ ∈ [0, 1],N∈N≥2∪{∞},where we write1/∞=0.Consider the upper bound (20). The derivative ofσ2(1−λ)(1+λ)+d2(1−λ)−2w.r.t. λ ∈ (0, 1) is zero if and only if(σ/d)2(1−λ)3=(1+λ)2. Since(1−λ)3is decreasing and(1+λ)2is increasing in λ, we have the following possibilities:1.(σ/d)2 ≤ 1. Thenσ2(1−λ)(1+λ)+d2(1−λ)−2is increasing on λ ∈ (0, 1), and the righthandside of (20) is minimized by takingλ=0.(σ/d)2 > 1. Then there is a unique λ* ∈ (0, 1) that minimizesσ2(1−λ)(1+λ)+d2(1−λ)−2. Although an explicit expression exists for λ*, it is rather complicated, and it is not informative to state it here. The value of λ* can be computed by solving a cubic equation.Now consider the upper bound (21). The expressionσ2N+14d2(N+1)2on the righthandside of (21) is minimized by choosing N as the solution toN2(N+1)=2(σ/d)2,which follows by taking the derivative w.r.t. N and some basic algebraic manipulations. It can easily be shown that there is a unique solution N* > 0, at which the minimum is attained, and thatσ2N+c(N)is minimized by choosing N equal to either ⌊N*⌋ or ⌈N*⌉. If (σ/d)2 ≤ 10/4 then the optimal N equals 1, if (σ/d)2 > 10/4 then the optimal N is strictly larger than 1. Fig. 1shows the relation between (σ/d)2 and the values of λ*, N* that minimize the righthandside of (20) and (21).The quantity (σ/d)2 serves as a proxy for the volatility of the market process(M(t))t∈Nrelative to the variance of the disturbance terms(ϵt)t∈N. Both for Φλand ΦNone can show that the optimal choice of λ and N is monotone increasing in this quantity (σ/d)2. The larger the volatility of the market compared to the variance of the disturbance terms, the fewer data should be used to estimate the market. If (σ/d)2 is sufficiently small, then the market fluctuations are quite large relative to the variance of the disturbance terms, and it is optimal to take only the most recent data point into account to estimate the market.In this section we consider assumptions on the maximum probability that the market value changes.Proposition 5IfP(M(t+1)≠M(t))≤ϵfor allt∈Nand someϵ≥0,and in additionsupt∈NM(t)−inft∈NM(t)≤dfor some d > 0, then(22)LongRunAverageRegret(Φλ)≤2K0[σ21−λ1+λ+d2ϵ1(1−λ2)],(23)LongRunAverageRegret(ΦN)≤2K0[σ21N+d2ϵ(N+1)(2N+1)6N],for all λ ∈ [0, 1],N∈N≥2∪{∞},where we write1/∞=0.Consider the upper bound (22). The derivative ofσ2(1−λ)(1+λ)+d2ϵ(1−λ2)−1w.r.t. λ ∈ (0, 1) is zero if and only ifσ2d2ϵ(1−λ2)2=λ(1+λ)2; this follows from basic algebraic manipulations. Since(1−λ2)2is decreasing andλ(1+λ)2is increasing in λ, we have the following possibilities:1.σ2d2ϵ≤1. Thenσ2(1−λ)(1+λ)+d2ϵ(1−λ2)−1is increasing on λ ∈ (0, 1), and the righthandside of (22) is minimized byλ=0.σ2d2ϵ>1. Then there is a unique λ* ∈ (0, 1) that minimizesσ2(1−λ)(1+λ)+d2ϵ(1−λ2)−1. It is the unique solution in (0, 1) of the quartic equationσ2d2ϵ(1−λ2)2=λ(1+λ)2,which can easily be solved numerically.Now consider the upper bound (23). The expressionσ2N+d2ϵ(N+1)(2N+1)6Nis minimized onR++by choosingN*=3σ2d2ϵ+12,and the optimal N is equal to either ⌊N*⌋ or ⌈N*⌉. In addition, one can show that the optimal N equals 1 ifσ2d2ϵ≤12,and is strictly larger than 1 ifσ2d2ϵ>12.The quantityσ2d2ϵserves as a proxy for the volatility of the market process(M(t))t∈Nrelative to the variance of the disturbance terms(ϵt)t∈N. The effect ofσ2d2ϵon λ* and N* is shown in Fig. 2. It shows that the smaller the volatility of the market relative to natural fluctuations of demand (e.g. the largerσ2d2ϵ), the more data should be taken into account to estimate the market process.In this section, we describe two numerical experiments that illustrate the method of hedging against changes outlined in Section 3. In the first we consider pricing with the Bass model for the market process. In the second we consider pricing in a setting with price-changing competitors.The Bass model (Bass, (1969)) is a widely-used model to describe the life-cycle or diffusion of an innovative product. An important property of this model is that the market process M(t) is dependent on the realized cumulative sales up to time t.The model for M(t) isM(t)=max{0,a+b∑i=1t−1di+c(∑i=1t−1di)2},cf. Eq. (4) of Dodds (1973). We choosea=33.6,c=−10−6andb=0.0116,and setgt(p)=g(p)=−pfor allt∈N,pl=1andph=50. Let(ϵt)t∈Nbe i.i.d. realizations of a standard normal distribution. The characteristic shape of the market that arises from this model is depicted in Fig. 3. The solid lines denote a sample path of M(t), the dashed lines a sample path of the estimatesM^λ(t)andM^N(t).For eachλ∈{0.05,0.10,0.15,…,0.90}we run 1000 simulations of the policy Φλ, and for allN∈{2,3,4,…,25},we run 1000 simulations of ΦN.

@&#CONCLUSIONS@&#
