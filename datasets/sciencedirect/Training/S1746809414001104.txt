@&#MAIN-TITLE@&#
Nonlinear neural network for hemodynamic model state and input estimation using fMRI data

@&#HIGHLIGHTS@&#
We implemented NARX networks to estimate the hemodynamic states.The method has been used to estimate the neural activity.We optimized the structure of the NARX networks.Blocked and event-related BOLD real data were used.The method is accurate and robust even in the presence of signal noise.

@&#KEYPHRASES@&#
Nonlinear autoregressive with exogenous input (NARX),Neural networks,fMRI,BOLD,Hemodynamic model,Neural activity,State estimation,Event-related,Block design,

@&#ABSTRACT@&#
Originally inspired by biological neural networks, artificial neural networks (ANNs) are powerful mathematical tools that can solve complex nonlinear problems such as filtering, classification, prediction and more. This paper demonstrates the first successful implementation of ANN, specifically nonlinear autoregressive with exogenous input (NARX) networks, to estimate the hemodynamic states and neural activity from simulated and measured real blood oxygenation level dependent (BOLD) signals. Blocked and event-related BOLD data are used to test the algorithm on real experiments. The proposed method is accurate and robust even in the presence of signal noise and it does not depend on sampling interval. Moreover, the structure of the NARX networks is optimized to yield the best estimate with minimal network architecture. The results of the estimated neural activity are also discussed in terms of their potential use.

@&#INTRODUCTION@&#
Functional magnetic resonance imaging (fMRI) has become the standard technique in functional brain imaging. It is a noninvasive, radiation-free technique that has good temporal and spatial resolution. The fMRI technique is based on detection of the decrease in deoxyhemoglobin concentration at the site of neuronal activity, which causes a local increase in the magnetic resonance signal. This effect has been termed the blood oxygenation level dependent (BOLD) contrast mechanism [1,2]. In essence, blood serves as its own contrast agent in fMRI and allows identification of active brain sites. BOLD fMRI generally capitalizes on the difference between two states: an active on-state in which stimulus related neural activity is generated and a passive off-state in which stimulus-related neural activity is absent or kept to a minimum. By comparing the active on-state to the passive off-state, the resultant difference defines the site, volume, and level of fMRI activation. FMRI data go through two main processing stages. First, BOLD activity is detected as a result of neural activity using a general linear model (GLM). These models are convolution models in which known experimental inputs are convolved with a canonical hemodynamic response function (or basis set) to produce a predicted BOLD response. The inversion of these general linear models produces the parameters that describe the BOLD response to experimental input. Because this model is a convolution model, its inversion corresponds to a (least squares) deconvolution. The second stage usually addresses the connectivity among brain regions in terms of functional or effective connectivity. Effective connectivity is generally assessed with some form of dynamic causal modeling. This is in general Bayesian deconvolution procedure that estimates both the parameters of the hemodynamic response function and connectivity parameters among different brain areas. Another approach to estimating connectivity is called psychophysiological interaction analysis. In this analysis, the effect of one experimental variable on the influence between two regions is assessed in terms of the interaction between the experimental variable and the physiological activity of a modulatory region. In many instances, this requires an estimate of the underlying neuronal activity and some form of deconvolution [3]. In the application of the GLM and related deconvolution procedures, the choice of the convolution kernel can be problematic because the hemodynamic response function (HRF) varies across subjects, tasks and brain regions [4,5]. Moreover, the standard convolution model used in most analyses does not assume a single canonical HRF but a basis set composed of two or three basis functions [6]. This enables a regionally specific estimation of the effective hemodynamic response function. Many techniques have been proposed to address the estimation of the HRF from the BOLD signal [7–10]. All these methods are blind to the underlying physiological changes and neural activity which are driving the BOLD signal. This has motivated researchers to find nonlinear biophysical models that provide insight to the brain as hidden dynamics, which gives rise to the second processing stage. The pioneering work of Buxton et al. [11] proposed the balloon model that relates blood flow and volume to blood oxygenation and observed BOLD fMRI signal. The balloon model was validated and extended by Friston et al. [12] to include the effect of neural activity on cerebral blood flow (CBF). The extended model, known as the hemodynamic model, is described by a system of first-order differential equations. The measured BOLD signal is a nonlinear combination of the model states.In the exploratory-based fMRI data analysis, the objective is to estimate the model parameters, states, and, ultimately, the hidden neural activity. Different techniques have been proposed to solve this problem. Bayesian estimation framework was proposed [13] to estimate posterior distribution of the hemodynamic model parameters, which falls under the expectation maximization (EM) implementation of the Gauss–Newton method. To account for physiological noise, a stochastic model was introduced [14]. Using a local linearization filter (LLF), the hidden states and parameters of the hemodynamic model were estimated. In contrast to the Bayesian framework [13], which assumes that the neural input is known, the LLF approach estimates the hidden neural activity using a fixed number of radial basis functions. However, in order for this to work, a priori information about the neural input was used to constrain the ill-posed inverse problem. Thus, another method based on particle filtering was developed [15] that accounts for the nonlinearities of the model and estimates hidden states and model parameters. This method demonstrated robustness, accuracy, and superiority to the LLF. Similar work using two-pass particle filter, which includes a backward smoother, was utilized [16]. Particle filters, a global optimization approach, are computationally expensive. To ameliorate this, an Unscented Kalman filter (UKF) was used to infer model states and parameters [17]. The drawback of these reported methods is that they are incapable of complete deconvolution with the exception of one [14]. Therefore, dynamic expectation maximization (DEM), a variational Bayesian technique, was used to estimate hidden neural input in addition to model parameters and states [18]. DEM was shown to be more robust than the extended Kalman and particle filters. However, it was shown that Cubature Kalman filter (CKF) [19] and its square root form outperforms the DEM [20]. Most of the methods reported above either use high precision on the parameters’ prior variance or assume known neural input, which indicates low parameter identifiability.Additionally, most of these methods require prior knowledge about the shape, duration, and amplitude of the neural activity in the brain, which is not easy to infer for complex event-related fMRI experiments. It is important to ensure the predictive aspect of the estimation models.In this paper, we describe a nonlinear neural network procedure for hemodynamic deconvolution. In other words, we propose a nonlinear alternative to general linear convolution models that estimates the underlying neuronal input generating observed hemodynamic or BOLD responses. This is potentially important because procedures like psychophysiological interaction analysis depend upon an accurate deconvolution. Furthermore, analyses of functional connectivity (the correlation among different brain areas) could, in principle, use the estimated neuronal activity as opposed to the hemodynamic signals per se.Our work is the first to apply nonlinear autoregressive with exogenous input (NARX) neural networks (NN) for the estimation of the hemodynamic states and neural activity from simulated BOLD signal and two real fMRI data sets. NARX NN are, by nature, predictive and have demonstrated powerful modeling abilities in many fields [21], especially for nonlinear time series predictions [22]. Also, it was shown that NARX NN have faster convergence and better generalization than other networks architectures [21,23]. For these reasons, NARX NN offer a flexible platform to capture the full dynamics of the hemodynamic system and do not impose any constraints in the form of linearization as in [14], or a priori. Also, the performance of NARX NN is independent of integration step size.The paper is organized as follows. First, in Section 2, the hemodynamic model is presented with a discussion of the model parameters’ values. Then, basic principles behind NARX NN are explained and followed by a section which illustrates the steps for applying NARX NN to fMRI state estimation. Finally, we present our results for both simulated and real fMRI data along with discussions and comments.

@&#CONCLUSIONS@&#
