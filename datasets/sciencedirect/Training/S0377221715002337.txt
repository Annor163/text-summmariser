@&#MAIN-TITLE@&#
Variance swap with mean reversion, multifactor stochastic volatility and jumps

@&#HIGHLIGHTS@&#
Consider the asset dynamics with mean reversion, multi-factor volatility and jumps.We derive the multivariate characteristic function of log-asset values at different discrete time points.We derive closed-form solutions to various types of discrete variance swaps.Numerical examples confirm the accuracy and efficiency of the solution.Empirical study shows that the second volatility factor is significant to variance swaps.

@&#KEYPHRASES@&#
Pricing,Variance swap,Multi-factor stochastic volatility,Mean reversion,Jump diffusion,

@&#ABSTRACT@&#
This paper examines variance swap pricing using a model that integrates three major features of financial assets, namely the mean reversion in asset price, multi-factor stochastic volatility (SV) and simultaneous jumps in prices and volatility factors. Closed-form solutions are derived for vanilla variance swaps and gamma swaps while the solutions for corridor variance swaps and conditional variance swaps are expressed in a one-dimensional Fourier integral. The numerical tests confirm that the derived solution is accurate and efficient. Furthermore, empirical studies have shown that multi-factor SV models better capture the implied volatility surface from option data. The empirical results of this paper also show that the additional volatility factor contributes significantly to the price of variance swaps. Hence, the results favor multi-factor SV models for pricing variance swaps consistent with the implied volatility surface.

@&#INTRODUCTION@&#
The management of volatility risk has gained increased attention in financial markets since the onset of the recent global financial crisis. Variance swap is a typical financial tool for managing this risk. Numerous researches have been done on variance swaps (Carr & Madan, 1998; Demeterfi, Derman, Kamal, & Zou, 1999). However, none of them consider the discrete monitoring principle or the use of stochastic volatility model. Until recently, Zhu and Lian (2011) solve the discretely sampled variance swap pricing formula under the Heston’s stochastic volatility (SV) model using a partial differential equation (PDE) approach. Zheng and Kwok (2012) consider the stochastic volatility simultaneous jump (SVSJ) model in the valuation of various types of variance swap contracts using a probabilistic approach. They also include saddle-point approximation in Zheng and Kwok (2013a) and Fourier transform algorithms in Zheng and Kwok (2013b), respectively, in variance swap pricing under Lévy processes.In this paper, we generalize these recent advances in variance swap pricing to a wider class of models that incorporates the following well-known features of financial asset dynamics: mean reversion in asset price, multi-factor SV and simultaneous jumps in price and volatility factors. Therefore, the model considered embraces the Heston SV and SVSJ models as its special cases. Mean reversion is a well-known feature in commodity markets. A list of empirical studies supporting the existence of mean reversion can be found in Fusai, Marena, and Roncoroni (2008). Their model is extended to incorporate jumps by Chung and Wong (2014). Wong and Lo (2009) propose an option pricing model with mean reversion and the Heston SV to capture information contained in the term structure of futures prices. The Wong and Lo model is also found to be a special case of our model.Another well-known empirical finding is that the implied volatility surface solved by matching market option prices and the Black–Scholes formula shows a smiling pattern. Numerous models have been proposed to capture this pattern, including the SV models. Empirical evidence, however, shows that the level of implied volatility is independent of the slope of the volatility smile. Although a one-factor SV model can generate a steep smile or a flat smile for a given volatility, it fails to generate both patterns for a given parameterization. Using the Black–Scholes implied volatility for S&P 500 options over 15 years, the empirical study by Christoffersen, Heston, and Jacobs (2009) shows that a two-factor SV model is sufficient to model the stock return volatility based on a principal component analysis. The empirical study by Li and Zhang (2010) confirms the existence of the second volatility factor using a nonparametric test. Therefore, we consider a two-factor SV model in this paper.Apart from mean reversion and multifactor SV, jumps in the return process and volatility factors have also received a great deal of research attention. Jacod and Todorov (2010) discover that the prices of most of the constituent stocks in the S&P 500 index jump together with their volatilities. Duffie, Pan, and Singleton (2000) compare an SV model without jumps, an SV model with jump in price and an SVSJ model and show that the SVSJ model is able to produce an implied volatility smile closest to the one observed in the market. Wong and Zhao (2010) apply a model with mean reversion and two SV factors to currency option pricing. However, they do not incorporate jumps nor investigate the implications of their model for variance swap pricing.In this paper, we value various types of discretely monitored variance swaps under the proposed model. We follow Zheng and Kwok (2012) in using the square of the geometric return of the underlying asset to represent the realized variance in the variance swaps. The solution for the fair strike price in the variance swap contract, or the variance swap price, relies on the analytic joint characteristic function of the log asset prices at two different time points. We obtain this characteristic function by first deriving the joint characteristic function of the log asset price and its volatility at a particular time point. Then, we transform the payoff function of the variance swap into an exponential function. This enables the variance swap price to be deduced from the characteristic function.The remainder of this paper is organized as follows. The proposed model is presented in Section 2, where we also derive the joint characteristic function of the log asset price and the volatility. The analytical formulas for various types of variance swap contracts are obtained in Section 3. Empirical and numerical experiments are conducted in Section 4. Specifically, the empirical experiments illustrate the effect of the second volatility factor on variance swap prices. Section 5 concludes the paper.Under the risk-neutral measure, we postulate that the underlying asset Stand its two volatility factors V1tand V2tjointly evolve as follows. Let St= exp (Xt).(1)dXt=[θ(t)−mXt−V1t+V2t2]dt+V1tdWt1+V2tdWt3+JtXdNt1,dV1t=[a1(t)−b1V1t]dt+σ1V1t[ρ1dWt1+1−ρ12dWt2]+JtV1dNt1,dV2t=[a2(t)−b2V2t]dt+σ2V2t[ρ2dWt3+1−ρ22dWt4]+JtV2dNt2,whereWt1,Wt2,Wt3andWt4are independent standard Wiener processes;Nt1andNt2are independent Poisson processes with constant intensities λ1 and λ2, respectively; andJV2,JV1and JXare independent random variables that represent random jump sizes and which are independent of the Wiener processes and Poisson processes.This model (1) embraces most of the important derivatives pricing models in the literature. The simultaneous jumps on asset return and its volatility considered by Zheng and Kwok (2012) are reflected by the Poisson processNt1,whileNt2models jumps in the volatility process independent of the asset return. The constant m is the mean-reversion speed of the log asset, the deterministic function θ(t) is related to the equilibrium mean level of the log asset at time t and JXdenotes the random jump size of the log asset. Similarly, the constant biis the mean-reversion speed of the ith volatility factor, the deterministic function ai(t) is related to the equilibrium mean level of the ith volatility factor at time t, the constant σiis the volatility coefficient of the ith volatility factor process andJVidenotes the random jump size of the ith volatility factor for i = 1, 2. Notice that it is not necessary to know the explicit form of θ(t) since we will show in later part that this term can be calibrated with futures as a whole. If there is no jump, the model is reduced to the mean reversion model with two-factor SV in Wong and Zhao (2010). If the mean-reversion speed m is further set to zero, it becomes the two-factor SV model proposed by Christoffersen et al. (2009).The payoff of variance swaps depends on the underlying asset prices realized at time points 0 < t1 < ⋅⋅⋅ < tn. Thus, the valuation needs the joint distribution of asset prices at these time points. We thus derive the multivariate characteristic function of log-spot prices,lnSt1,…,lnStn,under the proposed model and then apply the results to the variance swap pricing in the next section.This section is organized as follows. We begin with a mean reversion model with a one-factor SV and extend it to incorporate the second SV factor. As shown in the later analysis, the process with two SV factors can be written as the sum of two independent processes with one SV factor. As the building block for the later analysis, the following lemma presents the joint characteristic function of the log-asset value and its variance under the mean reversion model with a one-factor SV process and simultaneous jumps. Afterward we derive the joint characteristic function of the log-asset values under the model (1).Lemma 2.1Consider the mean reversion model with SV and simultaneous jumps:(2)dXt=[θ(t)−mXt−Vt2]dt+VtdWt1+JtXdNt,dVt=[a(t)−bVt]dt+σVt[ρdWt1+1−ρ2dWt2]+JtVdNt,whereWt1andWt2are independent standard Wiener processes; Nt is a Poisson process with constant intensity λ independent of the two Wiener processes; andJtXandJtVare random jump sizes of the log asset price and volatility, respectively.JtXandJtVare independent of the two Wiener processes and the Poisson process. Then, the joint characteristic function of Xt and Vt is given by(3)f(x,v,t;ϕ,φ)=E[exp(iϕXT+iφVT)|Xt=x,Vt=v](4)=exp[A(T−t;ϕ)x+B(T−t;ϕ,φ)v+C(T−t;ϕ,φ)],where T ≥ t andi=−1,A(τ;ϕ)=iϕe−mτ,B(τ;ϕ,φ)=U(e−mτ)+e−bτV(e−mτ)1iφ−U(1)+σ22m∫1e−mτybm−1V(y)dy,C(τ;ϕ,φ)=∫T−τT[θ(s)A(T−s;ϕ)+a(s)B(T−s;ϕ,φ)+λE[exp(A(T−s;ϕ)JX+B(T−s;ϕ,φ)JV)−1]]ds,U(y;ϕ)=2myσ2(1−ρ2−ρi)σϕ2mΦ(a*,b*,yω(ϕ))+a*b*ω(ϕ)Φ(a*+1,b*+1,yω(ϕ))Φ(a*,b*,yω(ϕ)),V(y;ϕ)=Φ2(a*,b*,1ω(ϕ))Φ2(a*,b*,yω(ϕ))eσϕm(1−y)1−ρ2,a*=(ρ2−1+ρ)b*2+σ4mρ2−1,b*=1−bm,ω(ϕ)=−mσϕ1−ρ2,and Φ( ·, ·, ·) is the degenerated hypergeometric function.The Feynman–Kac formula states that f(x, v, t) is governed by the following partial integro-differential equation (PIDE):{−∂f∂t=[θ(t)−mx−v2]∂f∂x+[a(t)−bv]∂f∂v+v2∂2f∂x2+σ2v2∂2f∂v2+ρσv∂2f∂x∂v+λE[f(x+JX,v+JV,t)−f(x,v,t)],f(x,v,T)=exp(iϕx+iφv).From the affine structure of our model, we postulate f(x, v, t) admitting the form (4). Substituting (4) into the above PIDE gives the following system of ordinary differential equations for A, B and C:(5)∂A∂τ=−mA(τ),∂B∂τ=σ22B2(τ)−[b−ρσA(τ)]B(τ)−12A(τ)[1−A(τ)],(6)∂C∂τ=θ(t)A(τ)+a(t)B(τ)+λE[exp(A(τ)JX+B(τ)JV)−1],with the initial conditions A(0) = iϕ, B(0) = iφ and C(0) = 0, where τ = T − t and (5) is known as the Riccati equation. It is trivial to solve for A(τ) and the explicit formula is displayed in this lemma. Substituting A(τ) into (5) gives:{∂B∂τ=σ22B2(τ)−[b−ρσiϕe−mτ]B(τ)−12(iϕe−mτ+ϕ2e−2mτ),B(0)=iφ.Following the results of Wong and Lo (2009), we can write the analytical formula of B(τ) where the initial condition of B(τ) is iφ instead of 0. Having obtained A(τ) and B(τ), C(τ) is then obtained by integrating both sides of (6).□An explicit formula of C(τ) in Lemma 2.1 can be obtained once the distributions of JVand JXare specified. Observe that if JVand JXare independent of each other, the last expectation in the above expression can be calculated directly by using the marginal characteristic functions of JVand JX, respectively. However, to allow for a more flexible modeling, we consider a more complicated structure for JVand JX. Specifically, we employ the dependent structure in Zheng and Kwok (2012) thatJV∼exp(η),JX|JV∼N(ν+ρJJV,δ2).The expectation in C(τ) can be computed as follows:E[exp(A(τ;ϕ)JX+B(τ;ϕ,φ)JV)−1]=exp[A(τ;ϕ)ν+12A2(τ;ϕ)δ2](1−[ρJA(τ;ϕ)+B(τ;ϕ,φ)]η)−1−1.In particular for JX≡ 0, the expectation is equal to (1 − B(τ; ϕ, φ)η)−1 − 1. As the result in Lemma 2.1 is frequently used in the remaining text with different parameters, we introduce the following notation.Definition 2.1The one-factor SV model considered in Lemma 2.1 is denoted as M(Θ; JX, JV), where Θ = {θ(t), m, a(t), b, σ, ρ, λ} is the parameter set characterizing the model except for the jump sizes.The joint characteristic function of the log asset pricesX=(Xt1,…,Xtn)is defined as(7)FX(x0,v10,v20;u1,⋯,un)=E[exp(iu1Xt1+⋯+iunXtn)∣X0=x0,V10=v10,V20=v20],where u1, …, unare real numbers. The following theorem holds.Theorem 2.1Under model (1), the multivariate characteristic function ofXdefined in (7) is given byFX(x0,v10,v20;u1,u2,…,un)=exp[∑k=1nC1(tk−tk−1;ϕk,φ1,k)+B1(t1;ϕ1,φ1,1)v10+iϕ1e−mt1x0]×exp[∑k=1nC2(tk−tk−1;ϕk,φ2,k)+B2(t1;ϕ1,φ2,1)v20],whereϕk=uk+ϕk+1e−m(tk+1−tk),k=1,…,n−1;ϕn=un,φj,k=−iBj(tk+1−tk;ϕk+1,φj,k+1),k=1,…,n−1;φj,n=0,forj=1,2,Θ1={θ(t),m,a1(t),b1,σ1,ρ1,λ1},Θ2={0,m,a2(t),b2,σ2,ρ2,λ2},in which B1, B2are the function B in Lemma2.1under the modelM(Θ1;JX,JV1)andM(Θ2;0,JV2),respectively. Similarly, C1, C2are the function C in Lemma2.1under the modelM(Θ1;JX,JV1)andM(Θ2;0,JV2),respectively.We only prove the case of n = 2. The case with an arbitrary n can be shown by the same principle or by induction. Given the initial values x0, v10 and v20, we decompose {Xt} into the sum of two random processes {Yt} and {Zt}, i.e. Xt= Yt+ Zt, such that(8){dYt=[θ(t)−mYt−V1t2]dt+V1tdWt1+JtXdNt1,Y0=x0,dV1t=[a1(t)−b1V1t]dt+σ1V1t[ρ1dWt1+1−ρ12dWt2]+JtV1dNt1,V10=v10,(9){dZt=[−mZt−V2t2]dt+V2tdWt3,Z0=0,dV2t=[a2(t)−b2V2t]dt+σ2V2t[ρ2dWt3+1−ρ22dWt4]+JtV2dNt2,V20=v20.From model (1), it is clear that {Yt} and {Zt} are independent processes. Then the bivariate characteristic function is given byFXt1,Xt2(u1,u2)=E[exp(iu1Xt1+iu2Xt2)]=E1·E2,whereE1=E[exp(iu1Yt1+iu2Yt2)]andE2=E[exp(iu1Zt1+iu2Zt2)].Notice that {Yt} and {Zt} follow modelsM(Θ1;JX,JV1)andM(Θ2;0,JV2),respectively. By Lemma 2.1,E1=exp[C1(t1;ϕ1,φ1,1)+C1(t2−t1;ϕ2,φ1,2)+iϕ1e−mt1x0+B1(t1;ϕ1,φ1,1)v10],andE2=exp[C2(t1;ϕ1,φ2,1)+C2(t2−t1;ϕ2,φ2,2)+B2(t1;ϕ1,φ2,1)v20].This shows the bivariate case while the multivariate case follows by induction.□As a concrete example, consider the exponential jump sizes for the volatility factors,JV1∼exp(η1),JV2∼exp(η2),and the normal jump size for the log asset return conditional onJV1and independent ofJV2:JX|JV1∼N(ν+ρJJV1,δ2).This consideration is consistent with Zheng and Kwok (2012). Therefore, the joint characteristic function of log-asset prices is obtained in an explicit closed-form solution, which is useful in examining distributional properties and rendering an efficient pricing scheme for financial derivatives. As this paper focuses on variance swap contracts, the explicit pricing formulas are provided in the next section.11Although pricing formulas are derived for the general model considered, our empirical studies only use special cases of the general model, depending on the nature of the asset class.In practice, the characteristic function is often expressed in terms of observed market forward (futures) prices. This is known as the super-calibration of the model by enforcing it to be consistent with the market prices of futures contracts.Corollary 2.1Under the model (1), a forward price of the underlying asset with maturity T is given byG(T)=E[eXT∣X0=x0,V10=v10,V20=v20]=exp[e−mTx0+B1(T;−i,0)v10+B2(T;−i,0)v20+C1(T;−i,0)+C2(T;−i,0)]where the functions involved are defined in Theorem2.1.The result follows by setting G(T) = F(x0, v10, v20; −i) in Theorem 2.1.□To express the characteristic function in terms of observed market forward (futures) prices, we link the common terms in Corollary 2.1 and Theorem 2.1.∫0Tθ(s)e−m(T−s)ds=ln[G(T)]−B1(T;−i,0)v10−B2(T;−i,0)v20−e−mTx0−C˜1(T;−i,0)−C2(T;−i,0),where(10)C˜1(τ;ϕ,φ)=∫T−τT[a1(s)B1(T−s;ϕ,φ)+λ1E[exp(A1(T−s;ϕ)JX+B1(T−s;ϕ,φ)JV1)−1]]ds.This enables the characteristic function to be super-calibrated to futures prices in the market. Specifically, using the property:∫tk−1tkθ(s)e−m(tk−s)ds=∫0tkθ(s)e−m(tk−s)ds−e−m(tk−tk−1)×∫0tk−1θ(s)e−m(tk−1−s)ds,the following corollary is straightforwardly obtained, where the θ disappears in the joint characteristic function.Corollary 2.2Under the model (1), the multivariate characteristic function ofXsuper-calibrated to the term structure of future prices is given byFX(u1,u2,…,un)=∏k=1n[G(tk)G(tk−1)e−m(tk−tk−1)]iϕk×exp[∑k=1nC˜1(tk−tk−1;ϕk,φ1,k)+B1(t1;ϕ1,φ1,1)v10]×exp[∑k=1nC2(tk−tk−1;ϕk,φ2,k)+∑k=1nB2(t1;ϕ1,φ2,1)v20+iϕ1e−mt1x0]×exp[−∑k=1niϕk(ΔkC˜1+ΔkC2+v10ΔkB1+v20ΔkB2)].where G(T) is the forward price with maturity T, Bj, C2, φj, k, ϕk, j = 1, 2, k = 1, …, n are defined inTheorem 2.1,C˜1is defined in (10) andΔkC˜1=C˜1(tk;−i,0)−e−m(tk−tk−1)C˜1(tk−1;−i,0)ΔkC2=C2(tk;−i,0)−e−m(tk−tk−1)C2(tk−1;−i,0)ΔkBj=Bj(tk;−i,0)−e−m(tk−tk−1)Bj(tk−1;−i,0),j=1,2Corollary 2.2 is practically useful. In particular, when the underlying asset is not traded but its futures and options are, standard results can be applied to calibrated risk-neutral parameters. By substituting risk-neutral parameters into Corollary 2.2, various variance swaps values can be obtained as shown in a later section. However, if no option data are available to calibrate the risk-neutral parameters, it is interesting to explore the use of estimated physical parameters to infer the risk-neutral dynamics as well as fitting to the futures term structure. A possible remedy is to super-calibrate θ(t) with the physical parameters through the change of measure technique. We detail this proposal in Appendix A. Section 4 demonstrates the implementation procedure empirically.Variance swaps enable investors to trade on the variance of an underlying asset. By specifying the sampling dates of a variance swap, for example 0 = t0 < t1 < ⋅⋅⋅ < tN= T, the payoff of the contract at maturity T is defined as(11)AFN∑k=1Nwk(lnStkStk−1)2−K,where wkis the weight put on the return over the period [tk − 1, tk]. The constant K is the strike price the long side of the variance swap will pay at the end of the contract. The constant AF is the annualized factor. For instance, if we consider daily sampling for the contract, that istk−tk−1=1252,then AF = 252. This section examines the analytic pricing for vanilla variance swaps, gamma swaps, corridor variance swaps and conditional variance swaps.Vanilla variance swaps are the simplest form of variance swap. Their payoffs are obtained by putting all the weights wk= 1 in (11).The fair strike price K is set in such a way that the contract has zero value at the initial time. Under the market-implied pricing measure, the no-arbitrage strike price becomesK=E[AFN∑k=1N(lnStkStk−1)2],which is often called the variance swap price/rate. Because AF and N are constants once the tenor structure for the contract is specified, the above expectation is indeed taken on each of the squared log returns one by one. By the property of characteristic function, the expectation for each term inside the above summation, which is essentially the second moment, is calculated as:E[(lnStkStk−1)2]=∂2∂ϕ2FXtk−1,Xtk(iϕ,−iϕ)|ϕ=0.This gives the closed-form solution for the vanilla variance swap price.When mean reversion and jumps are absent in model (1), the explicit formulas for the vanilla variance swap prices using one-factor and two-factor SV models are summarized in the following proposition. This result is used in the subsequent empirical analysis on the contribution of the second volatility factor.Proposition 3.1If the log-asset price X(t) follows the one-factor SV model (namely Heston model, i.e. M(Θ; 0, 0) with Θ = {θ, 0, a, b, σ, ρ, 0}), then the variance swap with monitoring dates 0 = t0 < t1 < ⋅⋅⋅ < tN= T has the fair price: VS1(x, v, T, N; Θ) = k1v2 + k2v + k3, wherek1=AF4b2N∑k=1Ne−2btk−1(e−b(tk−tk−1)−1)2,k2=AFN(1b−ρσb2+σ22b3)(1−e−bT)+AFN(ρσb2−σ22b3)∑k=1Nbe−btk(tk−tk−1)−1b(θ−a2b)AFN∑k=1N(e−btk−1−e−btk)(tk−tk−1)−2a+σ2bk1,k3=AFN(ab−aρσb2+aσ24b3)T+AFN(aρσb3−aσ24b4)∑k=1N(1−e−b(tk−tk−1))+AFN(r−a2b)2∑k=1N(tk−tk−1)2−abk2−2a2+aσ22b2k1.Alternatively, if X(t) follows the two-factor SV model, i.e. m = 0 andJtX,JtV1,JtV2≡0in model (1), then the vanilla variance swap price is given byVS2(x,v1,v2,T,N)=VS1(x,v1,T,N;Θ1)+VS1(0,v2,T,N;Θ2)+I(v1,v2),whereI(v1,v2)=2AFN(k4v1v2+k5v1+k6v2+k7),Θ1={θ,0,a1,b1,σ1,ρ1,0},Θ2={0,0,a2,b2,σ2,ρ2,0},k4=14b1b2∑k=1N(e−b1tk−e−b1tk−1)(e−b2tk−e−b2tk−1),k5=−a2b2k4−a22b2h(b1),k6=−a1b1k4+(θ−a12b1)h(b2),h(b)=12b∑k=1N(e−btk−e−btk−1)(tk−tk−1),k7=a1a2b1b2k4+a1a22b1b2h(b1)−a2b2(θ−a12b1)h(b2)−a22b2(θ−a12b1)∑k=1N(tk−tk−1)2.In addition, by taking the asymptotic limit: maxk(tk− tk − 1) → 0 andAFN=1T,the two formulas respectively converge to their continuously monitoring counterparts:VS1(x,v,T,∞;Θ)=1−e−bTbTv−a(1−e−bT)b2T+ab,VS2(x,v1,v2,T,∞)=VS1(x,v1,T,∞;Θ1)+VS1(0,v2,T,∞;Θ2).The proof follows the previous discussion and simple calculation.□Remark: Similar explicit formulas can be derived for models with jumps. As the corresponding expression is rather long, we put it in the Appendix B and provide the Mathematica code upon request.Proposition 3.1 shows that the fair vanilla variance swap price is a quadratic function of initial volatility and independent of the initial asset price. In fact, the same conclusion applies to cases with jumps (see Appendix B). When the log-asset price has mean reversion, the log-asset price appears in the drift term of the SDE, which causes the pricing formula to depend on the initial asset price. If the underlying asset is liquidly traded, the drift term can be delta-hedged away, which eliminates the mean reversion effect under a risk-neutral measure. However, if the underlying asset is not traded as a commodity, mean reversion remains in the market-implied pricing dynamic and should be taken into account in the variance swap pricing formula. In this latter situation, we expect the variance swap price to be dependent on the initial asset price.Gamma swaps are variance swaps with weightswk=StkSt0in (11). One motivation to trade gamma swaps is to protect the swap sellers from crash risk because the weights of gamma swaps inherently dampen the downside variance. The fair strike price for a gamma swap is defined asK=E[AFN∑k=1NStkSt0(lnStkStk−1)2].The valuation requires the weight to be included in the expectation and we again use a property of the characteristic function. Specifically,E[StkSt0(lnStkStk−1)2]=E[e(Xtk−Xt0)(Xtk−Xtk−1)2]=e−X0∂2∂ϕ2E[eϕ(Xtk−Xtk−1)+Xtk−1]|ϕ=1=e−X0∂2∂ϕ2FXtk−1,Xtk(iϕ−i,−iϕ)|ϕ=1.This offers the closed-form gamma swap price through the characteristic function. When mean reversion and jumps are removed from the model (1), the explicit formulas for the gamma swap prices under the one-factor and two-factor SV models are given in the following proposition.Proposition 3.2If the log-asset price X(t) follows the one-factor SV model, the gamma swap price with monitoring dates: 0 = t0 < t1 < ⋅⋅⋅ < tN= T is GS1(x, v, T, N; Θ) = n1v2 + n2v + n3, wheren1=AF4b*2N∑k=1Ne(θtk−2b*tk−1)(1−e−b*(tk−tk−1))2,b*=b−ρσ,n2=AFN∑k=1N(1b*(θ+a2b*)(tk−tk−1)+(1b*+ρσb*2+σ22b*3))(e−b*tk−1−e−b*tk)eθtk−AFN(ρσb*+σ22b*2)∑k=1Ne(θ−b*)tk(tk−tk−1)−2a+σ2b*n1,n3=AFN(ab*+aρσb*2+aσ24b*3)∑k=1Neθtk(tk−tk−1)−AFN(aρσb*3+aσ24b*4)∑k=1Neθtk(1−e−b*(tk−tk−1))+AFN(θ+a2b*)2∑k=1Neθtk(tk−tk−1)2−ab*n2−2a2+aσ22b*2n1.Alternatively, if X(t) follows the two-factor stochastic volatility model, then the gamma swap price isGS2(x,v1,v2,T,N)=GS1(x,v1,T,N;Θ1)+GS1(0,v2,T,N;Θ2)+J(v1,v2),where Θ1and Θ2are defined in Proposition3.1,J(v1,v2)=2AFN(n4v1v2+n5v1+n6v2+n7),b1*=b1−ρ1σ1,b2*=b2−ρ2σ2,n4=14b1*b2*∑k=1Neθtk(e−b1*tk−1−e−b1*tk)(e−b2*tk−1−e−b2*tk),n5=−a2b2*n4+a22b2*g(b1*),n6=−a1b1*n4+(θ+a12b1*)g(b2*),g(b)=12b∑k=1Neθtk(e−btk−1−e−btk)(tk−tk−1),n7=a1a2b1*b2*n4−a1a22b1*b2*g(b1*)−a2b2*(θ+a12b1*)g(b2*)+a22b2*(θ+a12b1*)∑k=1Neθtk(tk−tk−1)2.By taking maxk(tk− tk − 1) → 0 andAFN=1T,the above two formulas respectively converge to their continuously monitoring counterparts:GS1(x,v,T,∞;Θ)=1−e(−b+ρσ)T(b−ρσTv−a(1−e(−b+ρσ)T)(b−ρσ)2T+ab−ρσ,GS2(x,v1,v2,T,∞)=GS1(x,v1,T,∞;Θ1)+GS1(0,v2,T,∞;Θ2).Interestingly, the gamma swap prices remain independent of the initial log-asset price whenever there is no mean reverting effect in the asset return. Explicit formula for models with jumps is rather long. Due to the page limit, we omit here but provide the Mathematica code upon request.The structure of corridor variance swaps is similar to that of vanilla variance swaps except that the underlying asset price must fall within a specified corridor for that period’s squared log return to be included in the variance. A typical corridor variance swap setswk=1{L<Stk−1≤U}in (11).Corridor variance swaps allow investors to take view on a particular interval of the implied volatility smile because only the realized variance within the corridor is included. A downside-variance swap sets L = 0 while an upside-variance swap lets U → ∞. In general, the payoff of various corridor variance swaps can be spanned by downside-variance swaps and vanilla variance swaps. Hence, it is sufficient to consider the pricing of downside-variance swaps. The fair strike price for a downside-variance swap is given byK=E[AFN∑k=1N(lnStkStk−1)21{Stk−1≤U}].The random part here is the squared log return and the indicator function. The expectation for each term in the summation is calculated as follows.(12)E[(lnStkStk−1)21{Stk−1≤U}]=∂2∂ϕ2E[eϕ(Xtk−Xtk−1)1{Xtk−1≤u}]|ϕ=0,where u = ln U.When k = 1, the value for the above indicator function is immediately known at the initial time point. Hence,E[(lnSt1St0)21{St0≤U}]=∂2∂ϕ2E[eϕ(Xt1−Xt0)1{Xt0≤u}]|ϕ=0=∂2∂ϕ2E[eϕXt1]e−ϕXt01{Xt0≤u}|ϕ=0=∂2∂ϕ2FXt0,Xt1(iϕ,−iϕ)1{Xt0≤u}|ϕ=0.When k ≥ 2, the expectation in (12) needs the Fourier transformation technique to deal with the indicator function. We first transform the indicator function1{Stk−1≤U}into1{Xtk−1≤u}and consider the generalized Fourier transform on the indicator function1{Xtk−1≤u},which is a function of u.∫−∞∞1{Xtk−1≤u}e−iuwdu=∫Xtk−1∞e−iuwdu=e−iXtk−1wiw.The complex variable w in the Fourier transform is written as w = wr+ iwi. Then, the Fourier transform exists for wi∈ (− ∞, 0). By taking the inverse Fourier transform, the quantity1{Xtk−1≤u}can be expressed in the Fourier integral form:1{Xtk−1≤u}=12π∫−∞∞eiuwe−iXtk−1wiwdwr.By replacing1{Xtk−1≤u}in (12) with its Fourier integral expression, the following result holds.E[(lnStkStk−1)21{Stk−1≤U}]=E[∂2∂ϕ2eϕ(Xtk−Xtk−1)12π∫−∞∞eiuwe−iXtk−1wiwdwr]|ϕ=0=e−uwiπ∫0∞Re(eiuwriwr−wi∂2∂ϕ2E[eϕXtk−(ϕ+iw)Xtk−1]|ϕ=0)dwr=e−uwiπ∫0∞Re(eiuwriwr−wi∂2∂ϕ2FXtk−1,Xtk(iϕ−w,−iϕ)|ϕ=0)dwr.This integration can be efficiently made by utilizing the fast Fourier transform (FFT) technique, a numerical technique introduced in Carr and Madan (1999). This procedure is repeated for k = 2, …, N. We compute the fair corridor variance swap price by summing up all the individual terms obtained in the early computation and then multiplying the sum with the constantAFN.A conditional variance swap is similar to a corridor variance swap, except that the summation of the squared log return is divided by D, the number of asset prices that fall within the corridor, rather than N. The final payoff is then adjusted by the factorDN. Therefore, the conditional variance swap payoff is[AFN∑k=1N(lnStkStk−1)21{Stk−1≤U}−K′]+(K′−KDN),whereD=∑k=1N1{Stk−1≤U}and K′ is the fair corridor variance swap price.Conditional variance swaps offer an alternative to trade variance within a corridor other than the corridor swap. A possible advantage of using conditional variance swaps is that their strikes are adjusted byDN,hence the profit is immune from the time the underlying asset is within the corridor. The payoff structure however shows that the conditional variance swap can be fully replicated by a corridor variance swap and a range accrual note (RAN). Hence, it remains for us to compute the RAN,E(D),with the proposed model. Then,K=K′NE(D).The calculationE(D)can be made by summing upE(1{Stk−1≤U})for k = 1, …, n. For k = 1,E(1{St0≤U})=1{St0≤U}.For k ≥ 2, we express1{Stk−1≤U}=1{Xtk−1≤u}in a Fourier integral form. Hence,E(1{Stk−1≤U})=E(12π∫−∞∞eiuwe−iXtk−1wiwdwr)=e−uwiπ∫0∞Re(eiuwriwr−wiFXtk−1,Xtk(−w,0))dwr.The conditional variance swap price is then obtained by combining the corresponding corridor variance swap price and value ofE(D).This section investigates the accuracy and efficiency of the pricing solution and demonstrates the potential application of the theoretical results. The accuracy of our analytical pricing methodology is benchmarked against a simulation. We also show that many practically useful models are special cases of our consideration and our general result applies. Our first empirical study examines the contribution of the second volatility factor without mean reversion in the asset return. We examine the effect of monitoring frequency on the fair strike and the effect of the second volatility factor on variance swap prices when the model is calibrated to the volatility surface implied by the market prices of options. The empirical results favor the two SV model. Due to the page limit, the price sensitivities of the variance swaps to mean reversion and jumps are included in the online supplement material. Our second empirical example illustrates the super-calibration with mean-reversion by considering a one-factor SV model. This second example shows the empirical use of the model in the commodity market when the underlying asset is nottraded on exchange but its futures contracts are.The numerical comparison is based on the four aforementioned types of variance swaps under different sampling frequencies. The MC simulation adapts the Euler–Maruyama discretization scheme, where the dynamics for the log asset price and the two stochastic factors are discretized as follows.Vjtk=max(Vjtk−1+(aj−bjVjtk−1)δt+σjVjtk−1δtZj+JVjYj,0),j=1,2,Xtk=Xtk−1+(θ−mXtk−1−V1tk−1+V2tk−12)δt+JXY1+V1tk−1δt(ρ1Z1+1−ρ12Z3)+V2tk−1δt(ρ2Z2+1−ρ22Z4),where δt is the simulation time step;JV1andJV2are independent exponential random variables with means η1 and η2, respectively;JX|JV1∼N(ν+ρJJV1,δ2); and Z1, Z2, Z3 and Z4 are independent standard normal random variables. The independent Bernoulli random variables Y1 and Y2 with parameters λ1δt and λ2δt approximate Poisson processes with arrival rates of λ1 and λ2, respectively. To match the monitoring frequency specified in the variance swap contracts, the time step is set such that the sets of monitoring dates are subsets of the set of dates of simulated prices. Specifically, the simulation divides the one year maturity of the variance swaps into 252 × 26 = 3276 subintervals for daily monitoring contracts when there are 252 trading days a year. More precisely, the simulation usesδt=13276and 1 million sample paths. Table 1 summarizes the parameter values used in the numerical experiment. These parameter values are obtained by rescaling the empirical two-factor SV parameters in Table 3 to retain the first two moments. For simple illustration, we use a constant θ, a1 and a2.Table 2 compares the analytic and simulated fair strike prices for the variance swaps under different sampling frequencies. The analytic results in Zheng and Kwok (2012) are included for comparison. The simulation standard deviations are in parentheses. The fair strike values and standard deviations are measured in variance points, which equal the realized variance multiplied by 1002. The same expression is used for the remaining parts of the paper. The relative errors of the analytic solutions against the simulated solutions in Table 2 show that they closely match for all cases, verifying the accuracy of the analytic solution. However, the analytical pricing procedure is much more efficient. Specifically, the execution time for the analytical solution of vanilla and gamma swaps are 0.02–0.3 percent of that to simulate one price, depending on the monitoring frequency. The execution time of corridor swap is higher but still much faster than the simulation.To empirically show the effect of the second volatility factor on variance swaps, the computation is based on parameters calibrated to real option data. Christoffersen et al. (2009) calibrated the one-factor and two-factor SV models to S&P 500 index option prices. Their calibration results are reported in Table 3, where we supplement some of the missing values with our own efforts. We remark here that the Feller conditions for SV factors should be imposed within the calibration. Based on this set of option prices, Christoffersen et al. (2009) report that the two-factor model offers better in-sample and out-sample fits than the one-factor model.When these calibrated parameters are fed into the pricing formulas, range differences in variance swap prices can be observed between the two SV models. The prices for the variance swaps under the different models are shown in Table 5. The relative price difference is measured as the price from the two-factor model less the price from the one-factor model and then divided by the price of the one-factor model. It can be seen from Table 5 that the variance swap prices are very different under the different models. Typically, the one-factor SV model overestimates various types of variance swap prices by more than 17 percent for all cases compared to the two-factor SV model. As the two-factor SV model better captures the implied volatility surface, derivative traders who use implied volatility information in their daily work may consider the variance swap prices from the one-factor SV model as too expensive. The second volatility factor offers a reason to lower the price to better integrate the information on implied volatility into the valuation. We also observethe relative error increases with the monitoring frequency. This is because a two factor volatility model explains the volatility surface significantly better than a single factor volatility model. This makes the price under the two models evolves very differently. When the monitoring frequency increases, more sample points are included and the difference is more obvious.We further compare the variance swap price differences between our model and the model of Zheng and Kwok (2012). We continue to use the parameters in Table 3, except for the jump part we follow the values in Table Table 1. Results are given in Table 6. We see that the price differences between the two models are huge but the price patterns across monitoring frequency are similar.In this section, we demonstrate the use of our model with mean reversion. The function θ(t) in our model is super-calibrated to futures, while other parameter values are estimated with historical returns. The transformation between physical and risk-neutral parameters is detailed in Appendix A. The characteristic function obtained is then expressed in terms of the future price curve, and is applied to value variance swaps.Specifically, our illustrative example considers the mean reversion model with a single SV factor for wheat price. We first take the physical parameters estimated by Lahiani, Nguyen, and Vo (2013) using a VAR-GARCH model. Some missing values are supplemented by our own forces. Table 4 reports the estimates. We take the continuous-time limit of the GARCH to infer physical parameter values of our model. We then calibrate the θs using the recursive formula (A.3) by the future price curve observed on 19th November 2013. The futures price with maturity112,13,12,23,56and1312are 646.6, 656.2, 659.4, 657, 665 and 676.5 respectively. The resulting{θk}k=16(θ(t)=∑k=16θk1{t∈(tk−1,tk]})are 2.2976, 5.3308, 5.3231, 5.2848, 5.3955, 5.4199. The risk-neutral parameters a and b are obtained by (A.1). Using these parameters, the fair strikes for vanilla variance swaps and gamma swaps with the monitoring dates same as the futures maturity dates are 3800.5 and 3112.0 (in variance points), respectively.

@&#CONCLUSIONS@&#
