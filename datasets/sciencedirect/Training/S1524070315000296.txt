@&#MAIN-TITLE@&#
Biharmonic fields and mesh completion

@&#HIGHLIGHTS@&#
A volumetric mesh repair algorithm, based on bi-harmonic fields.The pre-computation of a volume mask to over-constrain the boundary conditions.A discrete solution of the bi-harmonic equation based on a quadratic optimization.A fully automatic algorithm for massive hole repair in very large triangle meshes.The ability to handle complex hole topologies having islands and general shapes.

@&#KEYPHRASES@&#
Model repair,Thin-plate energy,Volumetric methods,

@&#ABSTRACT@&#
We discuss bi-harmonic fields which approximate signed distance fields. We conclude that the bi-harmonic field approximation can be a powerful tool for mesh completion in general and complex cases. We present an adaptive, multigrid algorithm to extrapolate signed distance fields. By defining a volume mask in a closed region bounding the area that must be repaired, the algorithm computes a signed distance field in well-defined regions and uses it as an over-determined boundary condition constraint for the biharmonic field computation in the remaining regions. The algorithm operates locally, within an expanded bounding box of each hole, and therefore scales well with the number of holes in a single, complex model. We discuss this approximation in practical examples in the case of triangular meshes resulting from laser scan acquisitions which require massive hole repair. We conclude that the proposed algorithm is robust and general, and is able to deal with complex topological cases.

@&#INTRODUCTION@&#
Repairing mesh holes in very large geometric models is nowadays still a challenge. Mesh completion algorithms should be automatic, stable and robust, to cope with a huge number of unrepaired regions having unpredictable topologies.The motivation of this paper came from a cultural heritage project aiming at the acquisition and 3D reconstruction of the entrance of the Ripoll Monastery in Spain. The monument is also known as the “Portalada”, and is the main Romanic sculpture in Catalonia, dating back to the 12th century. The total size of the mesh after registration was in the vicinity of 173 M triangles, presenting 14,622 holes of different sizes. More details on the project can be found in [1]. Holes and cracks were automatically detected through a search for cycles of border edges, and simple holes could be repaired by projecting their boundary onto a suitable plane and triangulating the projection without adding Steiner points. Classical mesh repair algorithms, however, were not able to handle some large holes or holes with complex boundaries, as discussed later in the paper.In this paper, we present a novel algorithm that solves and repairs complex hole configurations without user intervention. Our approach is based on several ideas. We compute a suitable approximation of the signed distance field to the mesh in a volumetric data structure, in the vicinity of a hole. Other authors (see [2]) have used diffusion equations or other variational formulations to obtain smooth signed distance fields. We choose to find a 3D thin-plate solution of the bi-harmonic equation to guarantee C1 continuity with the mesh around the repaired area. The repairing surface is then obtained as the zero-isosurface of the scalar bi-harmonic field. The algorithm starts by computing a volume mask which defines a region where the signed distance to the mesh around the hole can be computed robustly, and uses this distance field in that region to over-constrain the boundary conditions of the bi-harmonic equation. A discrete approximation of the bi-harmonic field is obtained by solving a quadratic optimization problem with a multigrid adaptive solver. One of the remarkable features of our approach is that it is able to successfully address complex topologies with disconnected mesh regions in a robust way. Our algorithm provides a means to automatically repair holes in very large triangle meshes with a smooth blending at the boundaries. Obviously, it is possible to construct intricate examples for which the proposed algorithm would fail – or at least fail to match our intuition – but our extensive tests using real data from laser scans show that the algorithm does consistently handle them in a very satisfactory way without supervision.Our approach was also inspired by [2]. However, as discussed in the next Section, they used the heat diffusion equation which results in a C0 field. To reach C1 continuity with the hole border regions, they included a heuristic step in each iteration by adding a heat source term after each diffusion step. We claim that in order to obtain general volume-based solutions for the mesh repair problem, the heat equation is not sufficient. Instead, we show that bi-harmonic fields do provide acceptable results.The main contributions of the presented algorithm are:•A volumetric mesh repair algorithm, based on the local computation of a bi-harmonic field approximation of the signed distance field. A key ingredient in the solution is the pre-computation of a volume mask to delimit a region where the signed distance is well-defined, and can be used to over-constrain the boundary conditions of the bi-harmonic equation over the whole domain.A discrete solution of the bi-harmonic equation based on a quadratic optimization, with a multi-grid adaptive repair algorithm. As a direct consequence of using the biharmonic equation, we obtain tangent continuity and we don’t have to include extra empirical steps like in previous approaches.A fully automatic algorithm for massive hole repair in very large triangle meshes, including the detection of mesh areas with holes, their repair and post-processing.The ability to handle complex hole topologies having islands and general shapes.The next two Sections present an overview of the prior art and of our proposed algorithm. Section 4 details the generation of the initial distance field and our bi-harmonic field approximation, while Section 6 discusses the acceleration of the computation and adaptive solutions that have been implemented. The last two sections present and discuss the results and detail the conclusions of the paper.The need to repair surface models has always been present regardless of their source. Since the general repair problem is inherently ill-posed (due to ambiguities), production in this subfield has been ongoing. The first algorithms developed to address this challenge attempted to characterize all possible defects (gaps, holes, self-intersections, degeneracies, loss of sharp features, noise, topology problems, …). Various surveys detail these problems and many of the contributions that have been proposed to solve them until now [3,4]. It would also be possible to apply solutions designed for the reconstruction of point cloud models to these problems, even though that would imply discarding the connectivity information available in the model. Point-cloud solutions also place less emphasis than our algorithm on preserving the geometric information of the original mesh. A good overview can be found in Berger et al. [5], which contains an extensive analysis of these techniques.The first solutions focused on directly repairing meshes. Liepa [6] proposed a step-based algorithm in which the holes were identified, triangulated, the resulting mesh patch refined, and finally, smoothed. More recently Bac et al. [7] introduced a similar method where refining the mesh and minimizing bending energy were alternated. Both methods share their inability to deal with holes with “islands” (see Fig. 7(p) for an example of holes with islands and how it is handled by our algorithm).Another group of approaches to the problem used a different strategy. Solutions known as volumetric methods start from a model to be repaired (a mesh or point cloud) and transform it into a volume where multiple defects can be treated uniformly. Volumetric methods also guarantee surfaces free of self-intersections. The main differences within this group of methods come from the process used to transform the input model into a volume and the algorithm applied to complete the repair if the first step is insufficient.Some of these volumetric techniques build an octree to represent the surface and use it to help in the repair of the entry model. For example, in [8], Ju computes signs for the vertices of the octree nodes consistently with the intersections between the triangles of the mesh and the edges of the octree. These signs serve later to extract an isosurface without defects, but that only approximates the original mesh. Instead, in [9] the user provides a maximum tolerance error for the corresponding octree construction ensuring that the final mesh does not deviate beyond this distance. This approach excels at repairing CAD models, but is not applicable to models resulting from a scan, since the holes can be hundreds of times greater than the average edge size.Other techniques compute a signed distance field. Davis et al. [2] calculate an initial signed distance field near the surface, over which they alternate the application of a low-pass filter with a composition operator. This solution is based on a perturbed heat diffusion simulation. The authors use a 3 × 3 × 3 heat kernel to diffuse high confidence signed distance values to the area missing data. However, and after each diffusion step, the authors add an empirical source term into each node, representing the addition of heat to the system. These diffusion and addition steps correspond to their convolution and compositing steps. The final patches interpolate the edges of the hole adequately but empirical steps must be tuned in order to achieve normal continuity. Nooruddin and Turk [10] throw rays in multiple directions counting the number of intersections with the model. Using the parity rule on the resulting data they compose a distance field that represents the repaired model, but they require that all defects are treated simultaneously which may be inefficient for larger objects. Other authors attempt to calculate an initial field, extending the distance values obtained using some interpolation technique, and the help of an expert user in the case of complex shapes. In particular, Masuda [11] used quadratic functions to perform this extension of the distance field. Brunet et al. [12] also use an iterative algorithm that alternates smoothing steps – based on B-splines – and fitting steps, but their method requires an initial triangulation of the detected holes, which could adversely affect the outcome.These previous works often focus on closed meshes with some imperfections, and therefore try to complete all boundaries. Thus, a direct comparison with our framework is not possible. In order to compare them, we have completed one of our sample holes with a portion of its bounding box, and run those algorithms on the resulting closed – but defective – mesh. The results are shown in Fig. 1. In this example, Nooruddin and Turk [10] delete a portion of the original mesh (Fig. 1(d)), Liepa [6] does not blend smoothly at the boundary (Fig. 1(e)), and Ju [8] produces triangles that are too large (Fig. 1(f)), and all three solutions join the boundary with only C0 continuity. Fig. 1(g) shows the result of Kazhdan and Hoppe [13] which maintains the continuity, but still presents anomalous protuberances and cavities. Since Kazhdan and Hoppe [13] compute the surface adding the input point cloud data to the optimization as restrictions, noise at the hole boundary strongly influences the result.There are also algorithms that get rid of the requirement of using signed distances in order to handle point clouds directly. Hornung and Kobbelt [14] propose immersing the point data in a voxelization so an unsigned distance field can be computed. The resulting distance values can be interpreted as inverse-likelihoods of the voxel being visited by the surface. Feeding this information into a min-cut algorithm yields a classification of the voxels’ faces. This algorithm has the potential of producing a manifold boundary from the vertices alone, but does not respect the initial data points. Instead, it resamples the data at the frequency of the highest resolution used.Other authors have used bi-harmonic solutions to extend geoemtry, like Jacobson et. al. [15], although their focus was on developing modeling techniques.The methods above have a tendency to use smooth patches to fill holes surrounded by complex patterns, another set of proposals attempt to reproduce the original shape of the model – in a plausible way. One possibility is to apply principles similar to those used in texture synthesis and fill the holes with pieces of geometry that fit in from the model itself. Sharf et al. [16] use local implicit approximations in order to measure the similarity between two patches. These patches are put in place using first a rigid transformation followed by an iterative closest point procedure with non-rigid transformations. The underlying assumption in all of these methods is that an appropriate shape continuation can be inferred from the acquired sample points only, using generic smoothness or self-similarity priors for missing parts of the model. Kraevoy and Sheer [17] use instead template-based completion techniques. Their method computes a mapping between the incomplete input mesh and the template to correctly close gaps and holes.An advantage of our algorithm is the fact that we can minimize the distance from the computed to the original mesh. This allows us to use pieces of the resulting isosurface to close the holes (as done in [12]), while preserving the original geometry elsewhere.

@&#CONCLUSIONS@&#
We have presented an algorithm to automatically repair complex hole configurations without any user intervention. Our approach is based on several ingredients. We solve a volumetric problem in the vicinity of each mesh hole to compute a suitable approximation of the signed distance field. The algorithm is based on computing a 3D thin-plate solution of the bi-harmonic equation that guarantees C1 continuity with the previous mesh around the repaired area, and obtains the repairing surface by computing the zero-isosurface of the scalar bi-harmonic field.A key ingredient of the algorithm is a volume mask such that the signed distance field to the mesh around the hole can be reliably computed in the mask domain. The rest of the algorithm uses this distance field to over-constrain the boundary conditions of the bi-harmonic equation over all of BH. A discrete approximation of the bi-harmonic field is obtained by solving a quadratic optimization problem, with a multigrid adaptive solver.Unlike some previous approaches, our algorithm does not require an initial triangulation of the holes. The computation of the bi-harmonic field is driven by the mask and the signed distance field in its domain.Our approach is able to successfully address complex topologies with disconnected mesh regions in a robust way. Thus, our proposed algorithm affords an automatic solution for hole repair in very large triangle meshes that provides a smooth blending at the boundaries and is able to act on holes locally, so that it scales well to very large meshes with multitude of holes, as are typically given by large 3D scanning projects.The resulting meshes can be post-processed to propagate into the new patch a roughness similar to the mesh surrounding it, statistically synthesizing similar details. This would be helpful in practical cases where we want to conceal the repaired portion and make it pass as original.In the future, it would be interesting to explore ways to find more general, optimal masks, that would extend the applicability of the technique to other domains with even more involved configurations.