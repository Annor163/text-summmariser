@&#MAIN-TITLE@&#
Prediction of ground motion parameters using randomized ANFIS (RANFIS)

@&#HIGHLIGHTS@&#
Prediction of ground motion parameters using hybrid soft computing technique.The neuro-fuzzy inference system uses Sugeno type fuzzy rules with a randomized fuzzy layer and a linear neural network output layer.Faster prediction of peak ground acceleration, velocity and displacement with increased accuracy.

@&#KEYPHRASES@&#
ANFIS,Random weight vector,Prediction,Ground motion parameter,

@&#ABSTRACT@&#
In this paper, a novel neuro-fuzzy learning machine called randomized adaptive neuro-fuzzy inference system (RANFIS) is proposed for predicting the parameters of ground motion associated with seismic signals. This advanced learning machine integrates the explicit knowledge of the fuzzy systems with the learning capabilities of neural networks, as in the case of conventional adaptive neuro-fuzzy inference system (ANFIS). In RANFIS, to accelerate the learning speed without compromising the generalization capability, the fuzzy layer parameters are not tuned. The three time domain ground motion parameters which are predicted by the model are peak ground acceleration (PGA), peak ground velocity (PGV) and peak ground displacement (PGD). The model is developed using the database released by PEER (Pacific Earthquake Engineering Research Center). Each ground motion parameter is related to mainly to four seismic parameters, namely earthquake magnitude, faulting mechanism, source to site distance and average soil shear wave velocity. The experimental results validate the improved performance of the machine, with lesser computation time compared to prior studies.

@&#INTRODUCTION@&#
Among all the natural calamities, earthquakes are the most threatening natural calamity, due to tremendous destructive property. Seismic hazard is anything associated with an earthquake like strong ground shaking, landslides, liquefaction, faulting etc. that may affect the normal activities of the people. The risk or damage of an earthquake to built-in environment is termed as seismic risk. Ground motion parameters are vital for designing earthquake resistant structures and seismic hazard (risk) analysis [1–4]. The commonly used ground motion parameters in time domain are peak ground acceleration (PGA), peak ground velocity (PGV) and peak ground displacement (PGD).Conventionally, the ground motion parameters are estimated based on ground motion prediction equations (GMPEs) which are developed using the traditional regression analysis method. These predictive equations relate the ground motion parameter in terms of independent variables such as earthquake magnitude, source to site distance, site conditions, seismic wave propagation and earthquake source characteristics [5]. The drawback of using regression analysis for the development of predictive equations is that, the high nonlinearity and inhomogeneity among the independent variables directly affect the coefficients of the independent variables in the developed regression equation. Moreover, in regression analysis the model is developed based on a predefined linear or nonlinear equation, with the hypothesis of normality of residuals for testing the developed model. Hence the developed predictive equation based on regression analysis is highly uncertain due to both computational uncertainties and the uncertainties of independent variables [5]. Thus, there is a huge need for the modelling of ground motion parameters using newer techniques so as to reduce the existing errors in the ground motion parameter estimation.With the recent advances in the field of artificial intelligence (AI) and soft computing techniques, many researchers are working to merge these techniques with the field of seismology and earthquake engineering. In [6], multi-layer feedforward neural networks were used for predicting the PGA in three different directions (vertical, east-west, and north-south) at the stations along the high speed railway line in Taiwan, using the seismic parameters and the historical earthquake data. The estimated values were compared to the microtremor measurements of the respective station. In [7], a remarkable effort was made to develop an attenuation relationship based on the strong motion data on the Turkey region using artificial neural networks (ANN). Though the correlation between the observed and the predicted PGA raised many questions [8], the attempt made indicated that neural networks could be applied in the field of seismology. Subsequently, an increase in neural network applications in the field of seismology and earthquake engineering were reported mainly because of the ability of ANN to learn and generalize interactions among many variables.The study presented in [9] used Lagramge equation discovery system for modeling PGA. The Lagramge equation discovery system is a machine learning technique which uses context free grammar (CFG) for generating equation structures which best describes the given data. The system gives a fair correlation between the observed and the predicted PGA values. The equation for the PGA estimation, developed by Lagramge equation discovery system has lesser complexities compared to the GMPEs. In [10], peak ground acceleration for the Turkey region was predicted using a new approach called the gene expression programming (GEP) and conventional regression method. GEP is a genetic approach with the capability to generate prediction equations that can be easily manipulated in practical circumstances. The best model is selected by ranking the models using likelihood based estimation. The model is said to have a fair validation when compared to the existing attenuation relationship for the region. In [11], an attenuation relationship was developed for the Turkey region using genetic programming (GP), for the prediction of the PGA. For the same database, the developed model in comparison to the other existing models database gives better correlation results. The advantage of using GP for the modelling of the PGA is that the functions are not predefined as in the case of the traditional regression analysis.A new GMPE model which uses a hybrid model of genetic programming and orthogonal least squares (GP/OLS) was developed in [12] to formulate principal ground-motion parameters PGA, PGV and PGD. The developed model gives a fair correlation value with lower MSE values and is better when compared to the existing GMPEs. The model developed is advantageous as the equations developed for the ground motion prediction are comprehensible compared to the existing GMPEs. In [13], a hybrid model which combines ANN with simulated annealing (ANN/SA) is used to predict the principal ground motion parameters PGA, PGV and PGD. This model provides better prediction performance than the benchmark models, but the training time is large due to the introduction of simulated annealing.Conventional neural networks have always been a popular machine learning technique widely used over the decades, and many researchers are constantly working for the advancement in the architecture and training speed of neural networks. One major improvement in the existing neural net architecture was the claim that the weights of the output layer are more relevant than the weights of the hidden layer [14]. This claim was well justified with feedforward network with a single hidden layer, where the weights of the hidden layer were randomly assigned and only the weights of the output layer were calculated using the pseudo inverse technique. The same concept of random weight vector assignment was further extended into the implementation of functional link (FL) neural networks [15]. The random vector FL nets are similar to backpropogation (BP) or generalized delta rule (GDR) net with the difference that in FL nets the weight vectors are not learned but assumed randomly. In this architecture, the hidden layer neurons are randomly assumed, with direct links from input to output neurons and the output layer weight vector are obtained using pseudo inverse. A similar architecture of single hidden layer neural network is presented in [16] uses an instant learning algorithm that rapidly decides the weights of the neural network. The paper also provides the upper bound of the number of the hidden nodes to be able to solve the output layer weight matrix exactly. Related works on radial basis function (RBF) networks with randomly selected RBF centers and suitably selected RBF width were presented in [17,18]. Once the centers had been chosen, the adjustable weights of the output layer were determined by linear least-square optimization.The recently proposed extreme learning machines (ELM) [19] are analogous to the above discussed architectures with minor variations [20]. ELM uses sigmoid activation functions in the hidden layer as in [14–16] or radial basis functions as in [17,18]. In ELM, the bias of the output neuron is set to zero, while the bias of the output neuron in [14] could be any value. Comparing ELM further with [15,16] it is observed that the only improvement in the ELM architecture is that there is no direct link from input to output neurons. The ELM-RBF architecture is a slight variation of RBF net [17,18] such that RBF neurons widths are also randomized for all RBF neurons along with the RBF neuron centers. But this variation could not be seen as an improved architecture because it has been proved that RBF networks are universal approximators irrespective of having same or different RBF neuron width [21]. In fact, it was shown in [22] that SLFN with arbitrary bounded and non constant activation function are universal approximators [22].Adaptive neuro fuzzy inference system (ANFIS) is yet another soft computing technique which is gaining popularity as a computational intelligent system. ANFIS [23] is an integrated hybrid architecture of fuzzy logic with neural networks, such that the knowledge gained by the fuzzy logic is used by the learning algorithm of the neural network. The initial fuzzy model is derived with the rules from the data, and the neural network learns and trains the rules to get the final model. The hybrid learning algorithm used in ANFIS consists of gradient descent for the fuzzy layer and least square estimate (LSE) for the linear output layer. This architecture has been implemented in various domains such as geotechnical engineering [24], prediction problems [25–28], control systems [29,30], and decision support system [31]. Although ANFIS architectures are widely used, it has a major drawback of high computational complexities, which makes the algorithm slow, with higher number of membership functions.In this paper, a new learning algorithm called RANFIS is used to develop a prediction model for forecasting the parameters of ground motion [32,33]. It is an improved conventional ANFIS, overcoming the computational overhead of the hybrid learning algorithm (HLA) algorithm used for the learning in ANFIS. RANFIS is a hybrid algorithm combining the advantages of random assumption of the weight vector for the hidden layer in feedforward nets and the adaptive network based fuzzy inference system (ANFIS). The proposed RANFIS algorithm is simpler and faster than the conventional ANFIS.The remainder of this paper is organized as follows. Section 2 presents the intricate description of the architecture of the RANFIS algorithm. Section 3 details the steps of modelling including the data preprocessing. The comprehensive study of the prediction model and the experimental results are discussed in Section 4 and finally Section 5 presents the concluding remarks of the work done.In randomized single layer feedforward neural network (SLFN), hidden layer weights and biases are randomly chosen. The linear output layer weights are determined analytically reducing the computational cost. To solve this classification problem, consider a conventional SLFN with hidden nodes and activation function g(x). Consider a training dataset with N samples (xi, ti) where xi=[xi1, xi2, …, xin]Tand ti=[ti1, ti2, …, tim]T.The output of the linear layer ojcan be obtained as∑i=1N˜βigi(xj)=∑i=1N˜βig(wixj+bi)=ojforj=1,…,Nwherewi=[wi1,wi2,…,win]Tis the weight vector between the input nodes and the ith hidden node, βi=[βi1, βi1, …, βim] is the weight vector for the linear output nodes and biis the threshold of the ith hidden node. This network can approximate the given problem with N samples with zero error. That means there exist parameters βi, wiand bisuch that∑i=1N˜βig(wixj+bi)=tjfor j=1, …, N, where t is the target.The above N equations may be written as(1)Hβ=TwhereH=g(w1⋅x1+b1)…g(wN˜⋅x1+bN˜)⋮⋱⋮g(w1⋅xN+b1)⋮g(wN˜⋅xN+bN˜)N×N˜β=β1T⋮βN˜TN˜×mandT=t1T⋮tNTN×mGiven a training set, the number of hidden nodes and hidden node activation functions, the algorithm for single layer feedforward network with random hidden weights is given as follows:Step 1: The weights between hidden nodes and input nodes wiand the threshold of the hidden nodes biare randomly assigned.Step 2: Calculate the hidden layer output matrix H.Step 3: Calculate the output linear layer weights usingThe structure of randomized ANFIS is same as that of conventional ANFIS [23] and is shown in Fig. 1. The architecture uses Sugeno type fuzzy inference rules. It is assumed that two rules are used for the knowledge representation. A two rule Sugeno ANFIS network has rules of the form:IfxisA1andyisB1THENf1=p1x+q1y+r1IfxisA2andyisB2THENf2=p2x+q2y+r2where x and y are crisp inputs, Ai, Biare linguistic variables.The top part of Fig. 1 has three layers and represents the premise part of the fuzzy rules and the bottom part has two layers and represents the consequent part. In the top part, the nodes in the first layer represent the fuzzy membership functions. The output of each node is:μAi(x)fori=1,2μBi−2(y)fori=3,4where μ(x) is the membership grade for input x and μ(y) is the membership grade for input y. Fixed nodes are used in the second layer. The product t-norm is used to ‘and’ the membership grades of premise parameters, as it gives a smoothing effect. Firing strengths wiof the fuzzy rules are calculated as(3)wi=μAi(x)⋅μBi(y),i=1,2Normalized firing strengthsw¯iare calculated in the third layer which also consists of fixed nodes.(4)w¯i=wiw1+w2The first layer in the bottom part of Fig. 1 represents a linear neural network with pi, qiand rias weight parameters. These weight parameters are adaptive and are learned using least square estimation method. Assuming normalized firing strengths of fuzzy rules and weight parameters are known, the output of this is given as(5)w¯ifi=w¯i(pix+qiy+ri)The second layer in the bottom part computes the overall output as:(6)t=∑iw¯ifi=w¯1(p1x+q1y+r1)+w¯2(p2x+q2y+r2)Bell shaped membership functions are used in the premise part, to provide smoothness in membership grade and flexibility in the core of membership functions. The Eq. (7) gives the mathematical representation of bell shape membership function.(7)μA(x)=11+x−cjaj2bjwhere the premise parameters aj, bj, and cjare position and shape deciding parameters.If the sample size of the two dimensional (x and y) data in Fig. 1 is N, the targets t1, t2, …, tNcan be found out using (6). The N linear equations can be expressed in matrix form ast1t2...tNN×1=w¯1xw¯1yw¯1w¯2xw¯2yw¯2..............................N×6p1q1r1p2q2r26×1The above matrix equation completely describes the two-rule RANFIS structure shown in Fig. 1. The premise parameters aj, bjand cjand the consequent parameters pi, qiand riare to be evaluated using the RANFIS algorithm which is explained in the next subsection.In the general case, if there are N training data pairs, the N linear equations can be represented in matrix form as(8)TN×1=HN×mn(n+1)βmn(n+1)×1where m is the number of membership functions, n is the dimension of input data and mnis the maximum number of rules used.In the conventional ANFIS, the premise parameters are determined using gradient descent methods like backpropagation algorithm. Consequent parameters are learned using linear network's training methods like least mean squares estimation [23]. In this type of hybrid learning algorithm (HLA), in the forward pass, the input patterns are applied, assuming fixed premise parameters,the optimal consequent parameters are calculated by an iterative least mean square procedure. In the second pass called as backward pass the patterns are propagated again, and in this epoch, back propagation is used to change the premise parameters to reduce the training error, while the consequent parameters remain fixed. This procedure is continued until the training error is minimized. In RANFIS, the strategy of random assumption of weights is applied to tune the premise parameters of the fuzzy rules. These parameters (aj, bj, and cj) are randomly selected with some constraints on the ranges of these parameters. The randomness is controlled in RANFIS due to the explicit knowledge embedded in the linguistic variables in the premise part of the fuzzy rules. Once the premise parameters for all the inputs are selected, the H matrix in (8) can be easily determined. Then the unknown linear network parameters can be determined as(9)β=H−1TConsider the training data, with n dimensional inputs and one dimensional target asX1X2..Xn;TFor input membership functions, the range of each input function is defined as(10)rangei=max{Xi}−min{Xi}fori=1,2,…,nIf there are m uniformly distributed membership functions, then the default parameters (aj*,bj*,cj*) of the jth membership function are given by(11)aj*=rangej2m−2The default value ofbj*is 2 andcj*is the center of uniformly distributed membership function.With these details, the RANFIS algorithm can be summarized in the following steps:Step1: Randomly assign the premise parameters (aj, bj, cj) within the following ranges.aj∗2≤aj≤3aj∗2cj∗−dcc2<cj<cj∗+dcc2where dcc is the distance between two consecutive centers and bjis selected from the range 1.9–2.1.Step2: Calculate the premise layer output matrix H in (8).Step3: Calculate the linear network parameter matrix β using (9).Step 4: Training runs are repeated for 50–70 times to select the best model.The following example would substantiate the advantage of RANFIS over the conventional ANFIS [33]. Let Z be 2 input (x,y) sinc function given in (12). Let the range of x and y be [−10,10]. RANFIS and conventional ANFIS algorithm are used for modeling the function. For training and testing the algorithm, 121 and 100 equally spaced pairs are chosen respectively from this range. Four membership functions and hence 16 rules are used for adapting the parameters of both algorithms. Both algorithms are implemented and tested on C and MATLAB R2012 b platform with a 3.30GHz Intel Core i3-3220 processor with 4GB RAM.(12)Z=sinc(x,y)=sin(x)x*sin(y)yFigs. 2 and 3show the final membership functions of x and y obtained after training the conventional ANFIS and RANFIS respectively. From Table 1, it is clearly observed that the proposed RANFIS algorithm is faster with better testing accuracy compared to the hybrid learning algorithm of conventional ANFIS. It is also observed that with the increase in the number of membership functions, there is a drastic increase in the training time for conventional ANFIS whereas for RANFIS, the training time is comparatively much lesser. Hence the proposed RANFIS algorithm is simple compared to the computation involving HLA in conventional ANFIS and is faster and efficient [32,33]. The qualitative knowledge embedded in the premise part of the fuzzy rules reduces the randomness of the first layer parameters.The three ground motion parameters that are modelled are peak ground acceleration (PGA), peak ground velocity (PGV) and peak ground displacement (PGD). The developed ground motion parameter prediction model is expressed in terms of earthquake magnitude, faulting mechanism, site conditions and source to site distance. The other geophysical parameters like rupture length and rupture area of the fault, its direction, stress drop, etc. are generally not considered as they only reflect the uncertainties.The database used in this study is a subset of the strong motion database systematized as part of a project named PEER-NGA project [34,35]. This same database named NGA flatfile V 7.3 was used to develop few worldwide existing ground motion prediction equations (GMPE) models [36–39]. The database includes a very large set of ground motions recorded worldwide (3551 records), consisting of shallow crustal earthquakes in active tectonic regimes. The database is comprehensive having sets of metadata, including different distance measure (column 48 to column 53 of NGA flatfile V 7.3), various site characterizations, earthquake source data, etc.In this study an attempt is made to model the principal ground motion parameters (Y) as follows(13)ln(Y)=f(M,F,V,ln(D))where Y is PGA (g), PGV (cm/s) and PGD (cm), M is Earthquake magnitude, F is the style of faulting, V is the average shear wave velocity and D is the distance.After the preprocessing of the database, the number of records used for the modelling is narrowed down to 2815. The four geophysical variables selected from the 116 geophysical variables of the original database form the input variables in the model. Fig. 4shows the flowchart describing the entire steps of data preprocessing. The input variables are selected from the knowledge gained by the literature survey of the related work and also in the study done on the influence of various geophysical parameters of the ground motion. The input variables hence chosen are:a.Earthquake magnitude (M): In this study the moment magnitude (M0) of the earthquake is represented by this variable.Faulting Mechanism (F): In this study this variable is used to represent the basic three types of faulting that occur during the earthquake rupture process. Table 2represents the values for F used in this study.Velocity (V): In this study this variable represents the average shear wave velocity in the top 30m layers at the site. This geophysical parameter is highly significant in contributing to the site effects [5], as it represents the site influence on seismic signal.Distance (D): There are 6 different types of measured distances as given in the database. From the literature survey, it is observed that Epicentral distance, Joyner–Boore distance and closest distance are relatively more significant [9,11–13]. The distance measure used in this paper is closest distance.Fig. 5shows the modelling scheme of the equation given in (13) using the new hybrid architecture described in Section 2. It is implemented and tested on C and MATLAB R2012 b platform with processor Intel(R) core(TM) i3-3220 and 4GB RAM. The number of membership functions is taken as 3. The input parameters to the model are earthquake magnitude, faulting mechanism, average shear wave velocity and closest distance. The output is principal ground motion parameter (Y), Y being PGA, PGV and PGD respectively. Hence the model is executed three times independently for PGA, PGV and PGD respectively. The model is analyzed based on two sets of data, namely training data set and testing data set. These two datasets are extracted from the database such that they are in the ratio of 4:1. The segregation of entire 2815 records into these two data sets should be such that the statistical parameters of the variables used in the analysis are consistent. In this paper the statistical criteria considered for segregation of data are maximum value, minimum values, median and standard deviation. Table 3shows the statistical criteria of the parameters used in this study.The data sets used for the analysis in this paper are normalized. There are several methods for the normalization of the data. In this paper the Eqs. (14)–(16) represent the method of normalization used. Let Z be the variable and Zmax, Zmin represent the maximum and minimum values of the variable respectively. Let the range within which the variable is to be normalized be [P, Q]. In this paper the range of normalized data is set as (0.05, 0.95) [13]. Let Znbe the normalized value for variable and it is defined as follows(14)Zn=cZ+dwhere(15)c=(Q−P)(Zmax−Zmin)(16)d=Q−(c*Zmax)There are various standard methods used for measuring the performance of the developed model. Table 4represents the various criteria used in this paper, which acts like a yardstick for analyzing the performance measure of the developed model. The criteria are valid for both training and testing data sets. In Table 4, k, obsi, predi, avg(obsi), and avg(predi) represent the total number of records, observed output, predicted output, the average value of observed output and the average value of the predicted output respectively.The prediction potential of the developed model is gauged based on the criteria mentioned in Table 4. There exists a well reasoned presumption that if |R|>0.8 and error percentage is minimum; there is a high correlation between the predicted and the observed values [40]. Hence, the developed model is efficacious. For the better justification of the obtained results, this section, is further divided into subsections. Section 4.1 details the comprehensive analysis of the developed model. Section 4.2 compares the developed model with the other existing models in the same database. The comparison of the developed model with existing GMPEs in the same database is done in Section 4.3. Section 4.4 checks the validity of the developed model.The modelling parameters of the developed RANFIS prediction model are given in Tables 5 and 6. Table 5 lists the values of the premise parameters (a, b, c) for each of the four input variables of PGA, PGV and PGD prediction models. The consequent parameter matrix is of the order 81×5 and hence in Table 6 only the maximum and minimum value is listed. The best result is obtained for 100 epochs with number of membership functions equal to 3, and the developed prediction model takes 183s to attain the best MSE value. The performance of the developed RANFIS prediction model is gauged in terms of prediction accuracy and the error percentage. The performance of the developed model is described in Figs. 6–8for both training and testing datasets. Fig. 6 shows the results obtained for the prediction of peak ground acceleration. Figs. 7 and 8 represent the results obtained for the prediction of peak ground velocity and peak ground displacement respectively. It is observed from Figs. 6–8 that the developed prediction model, for the prediction of PGA, PGV and PGD respectively, are efficacious as the models gives high prediction accuracy with lesser error percentage.The developed RANFIS prediction model is compared with two other models, namely ANN/SA (a hybrid model of artificial neural network coupled with simulated annealing [13] and GP/OLS (a hybrid model of Genetic programming coupled with orthogonal least squares [12], developed in the same database. The experimental results are tabulated in Tables 7–9. In the tables, where the corresponding values are missing, it is denoted by the symbol n/a. Table 7 represents the comparison of the developed RANFIS model with the existing models for the prediction of peak ground acceleration. Tables 7 and 8 shows the comparison between the developed model and the existing models, for the prediction of PGV and PGD respectively. It is observed from Tables 7–9, that the RANFIS model gives comparatively higher prediction accuracy with extremely small error percentage. Furthermore, it is observed that the RANFIS model is faster. The RANFIS model takes 183s with 100 epochs to attain the best MSE value, whereas the ANN/SA prediction model [13] takes 364 epochs with 240s to attain the minimum MSE value. The ANN/SA architecture has a single hidden layer with 8 nodes and is implemented using Neural-Lab program version 3.1. The specification of the machine on which RANFIS is implemented is discussed in Section 3.2.It is clearly observed from Tables 7–9, that the RANFIS model is efficient compared to other existing models. The developed RANFIS model is further compared with few existing GMPEs to prove the efficacy of the RANFIS model. There are numerous attenuation relationships for the prediction of principal ground motion parameter and comparing with all of them is not feasible. Hence the developed RANFIS model is compared with the few GMPEs developed in the same database. The criterion for comparison is the error percentage in the prediction of each of the principal ground motion parameters (PGA, PGV, and PGD) for the testing dataset (563 records). It is observed from Table 10, that the developed RANFIS model gives better precision as the error percentage is extremely less. Another advantage of the developed RANFIS model is that it is much simpler as compared to GMPEs as the RANFIS prediction model includes only 4 geophysical parameters as input, whereas GMPEs include many geophysical parameters.To further validate the potential of the developed RANFIS model, it is tested on another database having the same statistical properties as that of the database used for the training of the model. The database used for developing the model is the NGA database, which was compiled in 2003 and is popularly known as NGA WEST 1. This database was used to develop new GMPEs [34]. NGA WEST 2 [41] is an extension of NGA WEST 1 database, and it consists of 21,539 events, whereas the latter had 3551 events. Thus, out of 17,988 events which are not included in the NGA WEST 1 database, 140 events are selected, and is named as NGA WEST 2 testing dataset. The data preprocessing for NGA WEST 2 testing dataset is as mentioned in Section 3.1. The NGA WEST 2 testing dataset is used to further test the efficacy of the developed RANFIS prediction model. Figs. 9–11describe the response of the developed RANFIS model to the NGA WEST 2 testing dataset. Fig. 9 shows the results obtained by the developed RANFIS prediction model for the prediction of peak ground acceleration. Figs. 10 and 11 represent the results obtained for the prediction of peak ground velocity and peak ground displacement respectively. It is observed that the model gives a high correlation between the predicted and the observed values. Thus, this further validates the efficacy of the developed model.

@&#CONCLUSIONS@&#
