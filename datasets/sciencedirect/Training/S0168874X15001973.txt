@&#MAIN-TITLE@&#
Blending isogeometric and Lagrangian elements in three-dimensional analysis

@&#HIGHLIGHTS@&#
A method is proposed to blend NURBS and finite elements in 3D isogeometric analysis.The interfacing facets of a NURBS patch are transformed to Lagrangian form.Transformation from NURBS to Lagrangian can preserve the original geometry.Connection between higher order NURBS and lower order finite elements is discussed.A blended model of an intricate geometric gear is built and analyzed.

@&#KEYPHRASES@&#
Isogeometric analysis,Finite element analysis,NURBS,Blended element,Lagrangian transformation,

@&#ABSTRACT@&#
A method for blending three-dimensional Non-Uniform Rational B-Splines (NURBS) elements and Lagrangian elements is proposed. In the blended element, selected boundary facets of a NURBS patch are presented in Lagrangian form, enabling the patch to be directly connected to standard Lagrangian elements. The transformation from NURBS to Lagrangian preserves the original geometry and thus retains the geometric exactness. The transformation is utilized to develop blended models wherein a part of the domain is described in NURBS while the remaining domain is in traditional finite elements. A simply supported beam is used as the benchmark example to test the convergence of the 3D blended element model. The utility of the blended model is also demonstrated with an example of a gear with intricate geometry. The stress solutions are compared with those of the pure finite element model and the validity of the blended analysis is demonstrated.

@&#INTRODUCTION@&#
Finite element method (FEM) has been the most widely used numerical method in engineering analysis. In FEM a material body is represented by a topological mesh which discretizes the body into a collection of elements. The mesh is an additional geometric entity, and one that is disconnected from an underlying geometric model. To better integrate geometric modeling and analysis, Hughes [1] put forward the concept of isogeometric analysis (IGA). The basic idea of the IGA is to unify the geometric basis, using the geometric language for both design and analysis. Currently the NURBS [2] and T-Splines [3] are the primary geometry languages used in isogeometric analysis [4–6]. NURBS is the de-facto standard in Computer Aided Design (CAD); thus using NURBS enables a direct integration between CAD and analysis. Compared with the standard FEM, the IGA has some remarkable merits [7–9]: (1) It provides a more accurate description for complicated geometries, and in particular, common shapes such as circle, cylinder, sphere, and ellipsoid can be represented exactly [10,11]. (2) The original geometry is preserved in h- p- and k-refinement [12]. (3) It offers up to Cp−1 continuity between elements [13], in contrast to the C0 continuity in FEM, and (4) it facilitates an integration of analysis, design, and optimization at the geometry level.While the theoretical foundation of IGA has been firmly established, the development of IGA computer code, especially general purpose programs such as existing ones in FEM, is still at the early stage. One of hurdles has been to automatically convert a 3D CAD model into NURBS meshes. While significant advances have been made in recent years [14–17], generating NURBS meshes for complicated 3D geometries remains a challenge. We envision that, for the time being there is a need for blended models which admit both traditional Lagrangian elements and NURBS/T-spline isogeometric elements. Conceivably, for some problems it is unnecessary to describe the entire domain in NURBS or T-Splines. One could leave a part of the domain in FEM while describing some crucial regions in NURBS. Similar situations can arise in the analysis of multi-component structures where some components are supplied in FE meshes while others are in NURBS. It would be convenient to keep both representations in the analysis, giving rise to a blended model. This blended modeling enables the advantages of both methods to be exploited. Perhaps more importantly, it enables one to incorporate isogeometric features in well-developed finite element programs.A key step in blending Lagrangian and NURBS elements is to develop interface elements containing mixed representations. Fortunately, interfacing NURBS to Lagrangian elements is straightforward, as both are polynomial based representations. B-spline basis functions and Lagrangian polynomials are mutually expressible because both are polynomial basis. Based on this observation, Lu et al. [18] proposed a blending technique; the basic idea is to represent some edges or facets of a NURBS element in Lagrangian form. However, in our previous 2D model we have not discussed the blended-element (a quadratic NURBS element with a quadratic Lagrangian element and a quadratic NURBS element with a linear finite element) simulation. In addition, three dimensional models have not been developed. In [18] the parent elements are in NURBS. A NURBS-enhanced finite element method (NEFEM) was proposed by Sevilla et al. [19]. There the parent element was Lagrangian, and selected boundaries were transformed into NURBS. A similar setting was adapted by Corbett et al. [20] in contact analysis where NURBS representation was used on contact surfaces to improve the smoothness of geometric representation. In a different front, efforts have been devoted to coupling isogeometric analysis and meshfree methods [21–23]. The development in [18] and similar contributions hinges on the idea of inter-representation between splines and other polynomial basis. In isogeometric analysis, this idea can be traced back to [24,25]. Therein the authors introduced the concept of Bézier extraction which represents each element (a non-empty knot span or tensor product of such) in terms of Bernstein polynomials defined over the element. A Bézier element contains a fixed set of basis functions, just like regular Lagrangian elements. Recently, the concept of Lagrange extraction was proposed by Schillinger et al. [26] representing all elements in a NURBS domain in Lagrangian form. This establishes a direct link between splines and nodal finite element basis functions.In this paper, we will develop the 3D blended isogeometric and Lagrangian elements. We will introduce the geometric representation of blended elements, and discuss how much representations are constructed. While the essential idea remains the same as the previous work in 2D, the details of the geometric representation need to be worked out. This paper is organized as follows: in Section 2 the geometric basis for transforming a NURBS curve or surface into a Lagrangian form is reviewed. The construction of three dimensional blended elements, including the treatment of interfacing elements of different polynomials degrees, is presented in Sections 3 and 4. Numerical examples are introduced in Section 5 to demonstrate the application of the proposed approach.A p-order NURBS curve is specified by a knot vectorU={u1,u2,…,un+p+1}, a set of control points and corresponding weights{Qi,ωi}i=1n. The curve is expressed as(1)C(u)=Σi=1nNi,p(u)ωiQiΣi=1nNi,p(u)ωiwhereNi,p(u)are the B-spline basis functions that are determined by the knot vector and the degree p.A NURBS curve is a composition of polynomial segments (or elements), each corresponding to a non-empty knot interval. A polynomial segment can be represented using Lagrangian interpolation. To this end, consider the segment[uk,uk+1](k≥p+1)and introduce p+1 interpolation pointsu¯l+i=(1−i/p)uk+(i/p)uk+1,i=0,…,p.These points determine a set of Lagrangian basis{Li,p}i=ll+p. We seek to express the segment in a rational Lagrangian form(2)C(u)=Σi=ll+pLi,p(u)ϖiPiΣi=ll+pLi,p(u)ϖiwhere{Pi}i=ll+pare Lagrangian nodes and{ϖi}i=ll+pare the corresponding weights. The Lagrangian nodes and weights are determined by setting the numerators and denominators to be equal in both forms:(3)∑i=k−pkNi,p(u)Qiω=∑i=ll+pLi,p(u)Piϖ∑i=k−pkNi,p(u)ωi=∑i=ll+pLi,p(u)ϖiwhereQiω=ωiQiandPiϖ=ϖiPi.Due to the interpolation property of the Lagrangian basis, the nodesPiis nothing but the value of curve atu¯i. It follows that(4)[PlϖPl+1ϖ⋮Pl+pϖ]=M[Qk−pωQk−p+1ω⋮Qkω](5)[ϖlϖl+1⋮ϖl+p]=M[ωk−pωk−p+1⋮ωk]whereM=[Nk−p,p(u¯l)Nk−p+1,p(u¯l)⋯Nk,p(u¯l)Nk−p,p(u¯l+1)Nk−p+1,p(u¯l+1)⋯Nk,p(u¯l+1)⋮⋮⋮⋮Nk−p,p(u¯l+p)Nk−p+1,p(u¯l+p)⋯Nk,p(u¯l+p)]These two sets of equations completely determine the Lagrangian weights{ϖi}i=ll+pand the weighted nodesPiϖ. The values of the physical nodes follow the following formPi=Piϖ/ϖi,i=l,…,l+p. Note that, by construction, this transformation preserves the original geometry.It should be emphasized that this transformation is defined at the element level. It depends only on the knot vector and the placement of Lagrangian knots, not the control points. The transformation for each element can be pre-computed and stored. The transformation is invertible, and the inversion gives a linear transformation between the basis functions:(6)[Lp,lLp,l+1⋮Lp,l+p]=M−1[Nk−p,pNk−p+1,p⋮Nk,p]This relation allows us express the Lagrangian basis in terms of the B-spline basis over a segment. The relation will be used later.The transformation to NURBS surface proceeds in the same way. Let us consider an element in ap×qdegree NURBS mesh. Let{Qij}and{ωij},i=1,p+1;j=1,q+1, be the element control points and weights, respectively. The element is represented as(7)S(u,v)=Σi=1p+1Σj=1q+1Ni,puNj,qvωijQijΣi=1p+1Σj=1q+1Ni,puNj,qvωijWe seek to represent it as(8)Su,v=Σi=1p+1Σj=1q+1Li,puLj,qvϖijPijΣi=1p+1Σj=1q+1Li,puLj,qvϖijwhereLi,p(u)andLj,q(v)are Lagrangian polynomials defined in the u- and v-parametric coordinates. The Lagrangian nodes in the parametric coordinates are taken to be uniformly placed,u¯1+i=(1−i/p)up+1+(i/p)up+2,i=0,…,p, andv¯1+j=(1−j/q)vq+1+(j/q)vq+2,j=0,…,q. Evaluating the two representations at the Lagrangian nodes, we obtain(9)[P1,1,1ϖP2,1,1ϖ⋮Pp+1,1,1ϖPp+1,2,1ϖ⋮Pp+1,q+1,1ϖ]=M[Q1,1,1ωQ2,1,1ω⋮Qp+1,1,1ωQp+1,2,1ω⋮Qp+1,q+1,1ω](10)[ϖ1,1,1ϖ2,1,1⋮ϖp+1,1,1ϖp+1,2,1⋮ϖp+1,q+1,1]=M[ω1,1,1ω2,1,1⋮ωp+1,1,1ωp+1,2,1⋮ωp+1,q+1,1]where(11)M=[N1,p(u¯1)N1,q(v¯1)N2,p(u¯1)N1,q(v¯1)⋯Np+1,p(u¯1)N1,q(v¯1)Np+1,p(u¯1)N2,q(v¯1)⋯Np+1,p(u¯1)Nq+1,q(v¯1)N1,p(u¯2)N1,q(v¯1)N2,p(u¯2)N1,q(v¯1)⋯Np+1,p(u¯2)N1,q(v¯1)Np+1,p(u¯2)N2,q(v¯1)⋯Np+1,p(u¯2)Nq+1,q(v¯1)⋮⋱⋮⋮⋰⋮N1,p(u¯p+1)N1,q(v¯1)N2,p(u¯p+1)N1,q(v¯1)⋯Np+1,p(u¯p+1)N1,q(v¯1)Np+1,p(u¯p+1)N2,q(v¯1)⋯Np+1,p(u¯p+1)Nq+1,q(v¯1)N1,p(u¯p+1)N1,q(v¯2)N2,p(u¯p+1)N1,q(v¯2)⋯Np+1,p(u¯p+1)N1,q(v¯2)Np+1,p(u¯p+1)N2,q(v¯2)⋯Np+1,p(u¯p+1)Nq+1,q(v¯2)⋮⋰⋮⋮⋱⋮N1,p(u¯p+1)N1,q(v¯q+1)N2,p(u¯p+1)N1,q(v¯q+1)⋯Np+1,p(u¯p+1)N1,q(v¯q+1)Np+1,p(u¯p+1)N2,q(v¯q+1)⋯Np+1,p(u¯p+1)Nq+1,q(v¯q+1)]This is the 3D version of the transformation in Eq. (9). We write it symbolically as(12)P=MQFor a NURBS patch containing multiple elements, the transformation is applied element by element to obtain a global Lagrangian form.A 3D NURBS element in the parametric space is a tensor product domain of non-empty knot that spans in three parametric dimensions. A 3D NURBS patch can contain multiple elements, and each element can be defined by a set of local knot vectors and a set of control points. Let us assume that the degrees in the three parametric directions are p, q, and r, respectively, and write the element knot vector (numbered locally) asU={u1,u2,…,u2(p+1)},V={v1,v2,…,v2(q+1)},W={w1,w2,…,w2(r+1)}Note that the length of the knot vectors is 2(p+1), 2(q+1), and 2(r+1), respectively. The physical element is expressed as(13)V(u,v,w)=Σi=1p+1Σj=1q+1Σk=1r+1Ni,p(u)Nj,q(v)Nk,r(w)ωijkQijkΣi=1p+1Σj=1q+1Σk=1r+1Ni,p(u)Nj,q(v)Nk,r(w)ωijkBelow we will give blended representation when some of the facets are transformed into Lagrangian form.As mentioned earlier the transformation takes place only on a boundary facet of a NURBS patch. We assume that the NURBS patch is defined by open knot vectors, so the interpolatory properties hold for the end knots. Consider, for example, the facetw=w1. On this surfaceN1,r(w1)=1whileN2,r(w1)=⋯=Nr+1,r(w1)=0. The NURBS representation reduces to(14)S1(u,v)=Σi=1p+1Σj=1q+1Ni,p(u)Nj,q(v)ωij1Qij1Σi=1p+1Σj=1q+1Ni,p(u)Nj,q(v)ωij1The Lagrangian transformation is applied to convert the facet representation to yield(15)S1(u,v)=Σi=1p+1Σj=1q+1Li,p(u)Lj,q(v)ϖij1Pij1Σi=1p+1Σj=1q+1Li,p(u)Lj,q(v)ϖij1Having the facet transformed, the 3D element can be expressed in a blended form, as(16)V(u,v,w)=∑i=1p+1∑j=1q+1∑k=2r+1Ni,p(u)Nj,q(v)Nk,r(w)ωijkQijk+∑i=1p+1∑j=1q+1N1,r(w)Li,p(u)Lj,q(v)ϖij1Pij1∑i=1p+1∑j=1q+1∑k=2r+1Ni,p(u)Nj,q(v)Nk,r(w)ωijk+∑i=1p+1∑j=1q+1N1,r(w)Li,p(u)Lj,q(v)ϖij1When two adjacent facets, for exampleu=u1andv=v1, are converted, they are transformed individually first. On the facetu=u1, we obtain a bi-variant Lagrangian form(17)S(u1,v,w)=∑j=1q+1∑k=1r+1Lj,q(v)Lk,r(w)ω¯1jkQ¯1jkOn the facetv=v1, we obtain(18)S(u,v1,w)=∑i=1p+1∑k=1r+1Li,p(u)Lk,r(w)ω¯i1kQ¯i1kThe common edge is then parameterized as∑k=1r+1Lk,r(w)ω¯11kQ¯11k. The 3D element is expressed as(19)Vω(u,v,w)=∑k=1r+1L1,p(u)L1,q(v)Lk,r(w)ω¯11kQ¯11k+∑j=2q+1∑k=1r+1N1,p(u)Lj,q(v)Lk,r(w)ω¯1jkQ¯1jk+∑i=2p+1∑k=1r+1Li,p(u)N1,q(v)Lk,r(w)ω¯i1kQ¯i1k+∑i=2p+1∑j=2q+1∑k=1r+1Ni,p(u)Nj,q(v)Nk,r(w)ω¯ijkQ¯ijkNote that some of the interior control parameters are also modified because the presence of the tri-Lagrangian basisL1,p(u)L1,q(v)Lk,r(w). It is shown in Appendix A that the new interior control parameters areQ¯ijkω=Qijkω−cidjQ11kω,i=2,…,p+1,j=2,…,q+1ω¯ijk=ωijk−cidjω11k,i=2,…,p+1,j=2,…,q+1whereci,djare the coefficients that satisfyL1,p(u)=∑i=1p+1ciNi,p(u),L1,q(v)=∑j=1q+1djNj,q(v). These coefficients can be obtained from the transformation (6), and it can be shown thatc1=1,cp+1=0,d1=1,dq+1=0. Due to these properties the modification is applied only to the interior nodes of the element. The control parameters of the opposite facetsu=um+p+1andv=vn+q+1remain intact.While three facets with a vertex, for exampleu=u1,v=v1andw=w1are converted simultaneously. On the facetu=u1, we obtain a bi-variant Lagrangian form(20)S(u1,v,w)=∑j=2q+1∑k=2r+1Lj,q(v)Lk,r(w)Q¯1jkωOn the facetv=v1, we obtain(21)S(u,v1,w)=∑i=2p+1∑k=2r+1Li,p(u)Lk,r(w)Q¯i1kωOn the facetw=w1, we obtain(22)S(u,v,w1)=∑i=2p+1∑j=2q+1Li,p(u)Lj,q(v)Q¯ij1ωThe three common edges are then parameterized as∑i=2p+1Li,p(u)Q¯i11ω,∑j=2q+1Lj,q(v)Q¯1j1ω, and∑k=2r+1Lk,r(w)Q¯11kω. respectively. On the common vertex, we obtainQ¯111ω=Q111ω. Thus, the 3D element is expressed as(23)Vω(u,v,w)=L1,p(u)L1,q(v)L1,r(w)Q¯111ω+∑i=2p+1Li,p(u)L1,q(v)L1,r(w)Q¯i11ω+∑j=2q+1L1,p(u)Lj,q(v)L1,r(w)Q¯1j1ω+∑k=2r+1L1,p(u)L1,q(v)Lk,r(w)Q¯11kω+∑j=2q+1∑k=2r+1N1,p(u)Lj,q(v)Lk,r(w)Q¯1jkω+∑i=2p+1∑k=2r+1Li,p(u)N1,q(v)Lk,r(w)Q¯i1kω+∑i=2p+1∑j=2q+1Li,p(u)Lj,q(v)N1,r(w)Q¯ij1ω+∑i=2p+1∑j=2q+1∑k=2r+1Ni,p(u)Nj,q(v)Nk,r(w)Q¯ijkωIt is shown in Appendix B that the new interior control parameters are(24)Q¯ijkω=Qijkω+2cidjekQ111ω−djekQi11ω−ciekQ1j1ω−cidjQ11kωω¯ijk=ωijk+2cidjekω111−djekωi11−ciekω1j1−cidjω11kwhere the coefficientsci,dj,eksatisfy the following conditions:L1,p(u)=∑i=1p+1ciNi,p(u),L1,q(v)=∑j=1q+1djNj,q(v),L1,r(w)=∑k=1r+1ekNk,r(w)Again they are available from the transformation matrix in (6). Notably, in this case only the control parameters of the vertex opposite to the vertex three transformed facets intersect, and its three facets are left intact, while other control points are modified.Fig. 1 shows an example. Fig. 1(a) is the 3D original NURBS element, Fig. 1(b) is the blended element with a single facet converted, Fig. 1(c) is the blended element with two adjacent facets converted and Fig. 1(d) is the blended element with three facets and only one vertex converted.For a multi-element NURBS patch the transformation proceeds element-by-element. When a single facet is converted, only the control parameters on the facet need to be modified, while interior parameters remain unchanged. An example is shown inFig. 2.When two intersecting facets are converted, the control parameters{Q1jk,ω1jk}j=1,k=1n,l,{Qi1k,ωi1k}i=1,k=1m,lof the two facets should be transformed into Lagrangian form{P1jk,ϖ1jk}j=1,k=1n1,l1,{Pi1k,ϖi1k}i=1,k=1m1,l1, while the interior control parameters are modified accordingly. In order to confine the change to a minimum range,up+2is inserted in the knot vector repeated p−1 times andvq+2is inserted in the knot vector repeated q−1 times. Therefore, a row of Bézier–Bernstein elements[up+1,up+2]×[vq+1,vq+2]×[w1,…,wl]appears in the boundary curve of the adjacent facets, as shown in Fig. 2(c). In this way, the internal control parameters modified are limited only in the Bézier–Bernstein elements, while the others are unchanged. The same example patch with two adjacent facets converted is shown in Fig. 2(d).While three intersecting facets are converted simultaneously, the control parameters of the three facets{Q1jk,ω1jk}j=1,k=1n,l,{Qi1k,ωi1k}i=1,k=1m,l,{Qij1,ωij1}i=1,j=1m,nare transformed into the Lagrangian form{P1jk,ϖ1jk}j=1,k=1n1,l1,{Pi1k,ϖi1k}i=1,k=1m1,l1,{Pij1,ϖij1}i=1,j=1m1,n1. Some internal parameters also need to be modified. As mentioned above,up+2is inserted in the knot vector repeated p−1 times andvq+2is inserted in the knot vector repeated q−1 times,wr+2r−1 times. As expected, three rows of Bézier–Bernstein elements are generated on the three boundary curves of the facets, as demonstrated in the example in Fig. 2(e). Similar to the above two adjacent facets converted, the modified parameters are limited only in the Bézier–Bernstein elements, while the others remain unchanged. The multi-element NURBS patch with three facets and only one vertex converted are shown in Fig. 2(f).When more intersecting facets are involved, just repeat the steps above.Once the basis functions of the blended element are established, the computation of stiffness matrix and force vector can proceed in the usual way in the isoparametric setting. For small strain problems, the stiffness matrix can be obtained simply by a transformation. Here we will discuss the transformation and related issues.As alluded before we assume that the parent element is in NURBS element, and the stiffness matrix in NURBS is K0.(25)K0=∫VBTDBdVwhere B is strain matrix and D is elasticity matrix.B=[B1,B2,B3,…,B26,B27]. The equivalent nodal force in NURBS are originally computed asF0=∫VNTfdV+∫SNThdSwherefis the body force andhis the boundary surface force,Nis the NURBS basis function matrix.At the element level Eq. (12) for the transformation between the original NURBS control point Q and the blended nodes P which include both intact control points and transformed Lagrangian nodes can be expresses as(26)Q=M−1P:=TPwhere the linear mapping M stands for the Lagrangian transformation in Eq. (4) for 2D and Eq. (9) for 3D.In the light of this transformation, the stiffness matrix of a blended element can be obtained as(27)K=TTK0TSimilarly, the equivalent nodal force of a blended element can also be calculated by(28)F=TTF0Transforming a NURBS facet to Lagrangian form always results in a tensor-produce patch of nodes. In particular, when a bi-quadratic NURBS surface is converted, the ensuing Lagrangian elements have nine nodes on the surface. This is not compatible with an 8-node quadrilateral facet. To connect the element to an 8-node surface, the middle node must be eliminated. Similarly, the polynomial degree of a Lagrangian facet may need to be reduced in order to connect a higher order NURBS to a trilinear finite element. Here, we discuss two common cases.Consider the situation where a bi-quadratic NURBS element is to be interfaced to a four-node finite element through a common edge. When the connecting edge on the NURBS side is transformed, it is still quadratic having three nodes. The middle node is subsequently eliminated to obtain a line edge. The process is described as follows.After the connecting edge is transformed into Lagrangian, the basis functions of the NURBS element can be expressed asN=[N1,N2,N3,N4,N5,N6,N7,N8,N9]The middle node (node 2 in this demonstration) is eliminated by forcing P2 to be the middle point of P1 and P3,[P1,P1+P32,P3,P4,P5,P6,P7,P8,P9]And thus the element is parameterized by 8 nodes,[P1,P3,P4,P5,P6,P7,P8,P9]. This is equivalent to the following adjustment on basis function:N′=[N1+0.5N2,N3+0.5N2,N4,N5,N6,N7,N8,N9]The transformation on basis functions is illustrated inFig. 3.We can define that the basis functions in the u-parametric coordinate are R1(u), R2(u) and R3(u), and the basis functions in the v-parametric coordinate are R1(v), R2(v) and R3(v). Thus{N1=L1(u)*R1(v)N2=L2(u)*R1(v)N3=L3(u)*R1(v)The rest of the basis functions are the same as the normal NURBS basis functions. Assuming that the element in Fig. 3(b) is a Bézier element, the ensuing basis functions are shown inFig. 4.If P′ represents the set of reduced nodes, one can write the reduction asP=RP′Thus,Q=M−1P=M−1RP′=TP′The stiffness matrix in Eq. (27) is computed with this modified transformation matrix.The same technique can be used in 3D to interface a NURBS element with a Lagrangian element of the same or a reduced order. Consider the example shown in Fig. 7. The system contains a quadratic 3D NURBS element (upper) and a 20-node brick (lower) connected at a common facet. After Lagrangian transformation, the connecting facet of the NURBS element still has nine nodes which is incompatible with the 8-node facet of the Lagrangian element. LetN=[N1,N2,N3,N4,N5,N6,N7,N8,N9,…,N24,N25,N26,N27]be the (mixed) basis functions of the NURBS element after the application of Lagrangian transformation. Here, nodes 1 through 9 are on the connecting facet, with node 5 at the center, 2, 4, 6 and 8 at the middle of edges, and 1, 3, 5, 7 the vertices. The middle node is eliminated by enforcing the constraintP5=12(P2+P4+P6+P8)−14(P1+P3+P5+P7)The redistributed basis functions areN′=[N1-0.25N5,N2+0.5N5,N3-0.25N5,N4+0.5N5,N6+0.5N5,N7-0.25N5,N8+0.5N5,N9-0.25N5,…,N24,N25,N26,N27]Consider further the interfacing of a tri-quadratic 3D NURBS element and a tri-linear 8 node brick, as shown in Fig. 8(a). First the 9 nodes to 8 nodes reduction described above is applied. During this process the middle node (node 5) is eliminated and the basis functions of the remains nodes on the facet are modified. Next, the middle nodes on each edge are eliminated by taking each of them to be the average of its two neighboring vertices. The resulting basis functions areN′′=[N1+0.5N2+0.5N4+0.25N5,N3+0.5N2+0.5N6+0.25N5,N7+0.5N4+0.5N8+0.25N5,N9+0.5N6+0.5N8+0.25N5,…,N24,N25,N26,N27]The planar model inFig. 5(a) is composed of a quadratic NURBS element and a quadratic finite element connected through a common edge in the middle. The upper nine-node square element is a quadratic NURBS element whose lower edge is transformed into Lagrangian and the element at the bottom is an eight-node Lagrangian element. Both the length and width of the NURBS element are 10mm, while the length and width of the finite element are 10 and 5mm respectively. The plane stress condition is assumed, and the material parameters are: Young’s modulus E=2.1E5MPa, Poisson׳s ratio v=0.3. A uniform vertical pressure of 1MPa is applied at the top edge of the model. The vertical degree of freedom at the bottom and the horizontal degree of freedom at the lower left corner are constrained. The stress contour and the displacement contour are shown in Fig. 5(b) and (c). Clearly a uniform stress distribution and a linear y-displacement field are obtained, as expected. The proposed formulation satisfies the compatibility condition across NURBS elements and C0 finite elements. The displacement is continuous and the stress is C0 continuous.Next we test a quadratic NURBS element connecting to a linear finite element inFig. 6. The material property, domain, type of plane, load and boundary constraints remain the same. Again the exact solution is obtained.The solid model inFig. 7(a) is composed of a tri-quadratic NURBS element and a 20-node brick element. The length, width and height of the NURBS element are 10, 10 and 5mm respectively, same as the finite element. The material parameters are: E=2.1E5MPa, v=0.3. A uniform vertical pressure of 1MPa is applied at the top facet of the model. The vertical displacement at the bottom surface is constrained, and the structure is constrained against rigid body motion otherwise. The stress contour and z-displacement contour are displayed in Fig. 7(b) and (c), showing a uniform stress field and a linear displacement field.Fig. 8(a) shows the results of a modified model where the bottom element is an 8-node brick. Under the same material property, domain, loading and boundary conditions, the stress contour and z-displacement contour are shown in Fig. 8(b) and (c). Again the exact solutions are obtained.A 3D simply supported beam is used here as the benchmark example to test the convergence of the blended element model. The length, width and height of the beam are L=1000mm, t=200mm, and H=200mm respectively. A uniform vertical pressure of 1MPa is applied at the top surface of the beam. The system is shown inFig. 9. The material parameters are: Young’s modulus E=2.1E5MPa, Poisson ratio v=0.3. The exact solution of the normal stress in the x-direction is given byσx=6qy(L2/4−x2)/H3+qy(4y2/H2−3/5)/H. The exact value ofσxat the point x=0, y=100mm and z=0 is 18.95MPa. A half-half discretization as shown inFig. 10 is used, where the left and right half domains are approximated by the quadratic Lagrangian elements and quadratic NURBS elements respectively. Several levels of mesh refinement are considered. The comparison of numerical results and exact solution is shown inTable 1. The relative error ofσxat the point x=0, y=100mm and z=0 is plotted inFig. 11. The pure NURBS model exhibits a higher rate of convergence than both the blended model and the Lagrangian element model, while the blended model has a higher rate of convergence than the Lagrangian element model. This is expected because the basis functions are complete to quadratic order and are globally smooth.Fig. 12 depicts the stress distributions along the bottom edge y=100mm and z=0, computed in the finest mesh wherein the number of element divisions in the x-, y- and z-direction is 64⁎8⁎8. The results of the blended model agree well with the analytical solution, especially on the right half edge where the domain are approximated by the quadratic NURBS elements.Gears are common mechanical parts. In gear operations, the magnitude of contact stress on the tooth depends on the shape of the surface. In simulation, the geometric accuracy becomes a crucial issue. If FE modeling is used, the mesh on the surface must be fine enough in order to capture the geometry. If the blended approach is used, the tooth surface can be parameterized in NURBS which can exactly describe the geometry at any refinement level.Fig. 13 illustrates a blended model of a gear and the procedure of the blended model is derived. Due to symmetry, the procedure is demonstrated using a single tooth. The blended model is established in the following steps:(1)The tooth is modeled using NURBS elements in Fig. 13(a). Tri-quadratic elements are used.The facet to be transformed in Fig. 13(b) and the associated control parameters are selected.The selected surface is reparameterized in Lagrangian elements in Fig. 13(c).The remaining domain is modeled using quadratic Lagrangian elements.By repeating the above steps for each tooth the blended model is yielded as shown in Fig. 13(e). For reference the CAD model in shaded form is plotted side by side shown in Fig. 13(f).A single tooth is chosen to perform a stress analysis. A uniform line load of 1N/mm at a 20o pressure angle is applied on one top side of the tooth. The lateral surfaces of the tooth are constrained. The resulting stress and displacement are shown inFig. 14(a) and (b). The stress contour and displacement contour of finite element model under the same condition is shown in Fig. 14(c) and (d).The blended model uses a small number of degrees of freedom and an exact description of the tooth geometry is achieved. The maximum stress and maximum displacement values of the blended model which uses 2260 elements to preserve the original geometry are close to those of the finite element model which uses 6280 elements, as shown inTable 2. Comparing the contours of the two models, it is shown that the stress distribution from NURBS is smoother. Thus, the use of NURBS elements, despite only regionally, still contributes to improve the stress predictions.A method of constructing 3D blended element is presented, wherein selected boundary facets of NURBS elements are transformed into Lagrangian form. These blended elements can be used as interface between a NURBS domain and standard finite element domain. Blending NURBS and finite element in analysis allows one to selectively model some subdomain in NURBS while leaving the others in FEM, and thus to fully exploit the advantages of both. A 3D simply supported beam and a gear examples were used to demonstrate the method. The blended approach opens a pathway for analyzing large scale practical engineering problems partially using NURBS elements, and does so on the platform of existing finite element programs. Future work includes implementing this blended technique in commercial software such as ABAQUS to analysis large-scale, complex problems.

@&#CONCLUSIONS@&#
