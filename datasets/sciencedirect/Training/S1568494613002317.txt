@&#MAIN-TITLE@&#
Parameter estimation for five- and seven-parameter photovoltaic electrical models using evolutionary algorithms

@&#HIGHLIGHTS@&#
Five and seven parameter photovoltaic electrical models used.Model parameter estimation using evolutionary algorithms.New hybrid algorithms proposed.Comparison of model results with models reported in literature.

@&#KEYPHRASES@&#
Photovoltaic,Five parameter model,Parameter estimation,Equivalent circuit model,Evolutionary algorithms,Hybrid evolutionary algorithms,

@&#ABSTRACT@&#
Equivalent electric circuit modeling of PV devices is widely used to predict PV electrical performance. The first task in using the model to calculate the electrical characteristics of a PV device is to find the model parameters which represent the PV device. In the present work, parameter estimation for the model parameter using various evolutionary algorithms is presented and compared. The constraint set on the estimation process is that only the data directly available in module datasheets can be used for estimating the parameters. The electrical model accuracy using the estimated parameters is then compared to several electrical models reported in literature for various PV cell technologies.modified diode ideality factor (V)diode ideality factorair massangle of incidenceirradiance (W/m2)band-gap energy of PV cell material (eV)fill factorfraction of diffuse radiation absorbed in the modulePV module output current (A)light current (A)diode reverse saturation current (A)Boltzmann's constant, 1.38066E−23 (J/K)irradiance dependence parameter for ILtemperature dependence parameter for anumber of cells in series in a module's cell-stringnumber of cell-strings in parallel in modulenumber of cells in series in a module's cell-stringelectrical power (W)elementary charge, 1.60218×10−19 (coulomb)series resistance (Ω)shunt resistance (Ω)plane-of-array absorbed solar radiation at operating conditions (W/m2)temperature (°C)voltage (V)Temperature coefficient of maximum power point currenttemperature coefficient of short circuit currenttemperature coefficient of open circuit voltagetemperature coefficient of maximum power point voltagethermal voltage per cell at temperature Tctemperature coefficient of open circuit voltageoverall diode ideality factor of PV modulereference cell conditionambientbeam radiationPV celldiffuse radiationeffective radiation; experimentalmodule back surface; modeledmaximum power pointopen circuit pointreference cell conditionshort circuit pointIV point at module voltage equal to half of open circuit voltageIV point at module voltage equal to average of max. power and open circuit voltagesambient

@&#INTRODUCTION@&#
Accurate modeling tools are a key to designing efficient and cost-effective PV systems. In total, three different models are required to model the electrical power output of a PV system for given irradiance and ambient temperature. These include a thermal model for finding the PV cell temperature, a radiation model for finding the solar energy absorbed in the PV cells and an electrical model for calculating the electrical characteristics of the PV system for the calculated absorbed radiation and cell temperature. Over the years, electrical models for varied complexities and accuracies have been developed for PV system. These include analytical models based on PV cell physics, empirical models and a few models which combine these two approaches.An empirical model was developed by King et al. [1] capable of predicting the electrical current and voltage of a PV device at five key points on the I–V curve. Hishikawa et al. [2] and Marion et al. [3] used interpolation techniques for determining the I–V curves at the input conditions using the I–V curves at known conditions. A different approach for modeling PV devices is to represent it by an equivalent electric circuit. Any PV device can be modeled using the equivalent circuit model by using the correct model parameters (IL, Io, a, Rs, Rsh). Townsend [4] presented an electric circuit model called the Four Parameters model for predicting the performance of PV devices in which he assumed the shunt resistance (Rsh) to be infinite which reduced the nonlinearity of the model. Duffie and Beckman [5] improved the model by Townsend by including an additional parallel resistance in the electric circuit. Their five parameters model gave improved prediction accuracies for thin film PV cell types. De Soto et al. [6] developed a methodology for finding these five model parameters using only manufacturer data. Valerio et al. [7] modified the five parameters model to capture changes in operating temperature and solar irradiance more accurately.In order to use the electric circuit models, the model parameters (IL, Io, a, Rs, Rsh) which are different for every PV device need to be first determined. A variety of techniques have been used to find these electrical model parameters. For the single diode five parameters model, De Soto et al. [6] and Boyd et al. [8] used a specialized non-linear equation solver to get a solution. Villalva et al. [9] explicitly defined one parameter, a, and then solved for the remaining parameters by minimizing the error in the maximum power prediction. Townsend [4] simplified the model by assuming the shunt resistance to be infinite which reduces the non-linearity of the system. He then solved for the remaining parameters iteratively. Carrero et al. [10] used an iterative procedure to find all five parameters, (IL, Io, a, Rs, Rsh). Their method only requires the I–V data of three points i.e. the short circuit, open circuit and maximum power points. Their method uses simplified forms of the I–V equation written at the three points and provides fast convergence.Various optimization techniques also been used for determining the five model parameters. Ikegami et al. [11] used the Levenberg–Marquardt multi-variable optimization technique with experimentally determined I–V curve to determine the model parameters. The objective function used by Ikegami et al. was the error in the current prediction at known voltages as calculated by Eq. (1).(1)error=∑i=1n(Im(Vi)−Ie(Vi))2nSiddiqui [12] used the simplex search algorithm to find the five mode parameters by minimizing the fitness function defined by Eq. (2). The objective function calculates two errors whose sum is minimized. First, the currents (I) at short circuit, maximum power point and open circuit conditions are calculated using Eq. (4) and known voltages from the module datasheet.(2)error=∑i=13(Im(Vi)−Ie(Vi))23+dPdVMPPWith the recent advancement in computing, the use of intelligent computing techniques has increased greatly. Intelligent techniques include Fuzzy control [13–18], evolutionary algorithms [19–21] and Neural Networks [22,23] which are being applied to engineering problems ranging from control to optimization with impressive success. For the estimation of PV electrical model parameters, genetic algorithm is the most widely used evolutionary algorithm [24–26]. The objective function used in all these works was the error in the current prediction at known voltages. Moldovan et al. [24] and Zagrouba [26] carried out similar works in which they used genetic algorithm to minimize the error in the current prediction at known voltages. Jervase [25] used genetic algorithm to find seven parameters for the two-diode electric circuit model. Ishaque et al. [27,28] used several evolutionary algorithms to find the model parameters for a two-diode equivalent electric circuit PV model and found that penalty-based differential evolution showed good accuracy and consistency of solution, good speed of convergence and required very low control parameters.For their Seven Parameters model, Siddiqui [12] used the simplex-search algorithm to first find the five parameters. The two additional parameters m and n were found using a secondary optimization in which the original five parameters did not change. Eq. (3) was used as the objective function for the secondary optimization process.(3)error=(Pm−Pe)2Low Irradiance+(Pm−Pe)2High TemepratureIn this paper, a methodology to estimate the model parameters using only manufacturer supplied electrical performance data is presented and the effectiveness of various evolutionary algorithms, including standard evolutionary algorithms as well as hybrid methods, in estimating the model parameters is evaluated. Finally, the accuracy of the parameter estimation methodology is checked by comparing the results of the electrical model to other models from literature as well as the same model using different parameters estimation methodologies.Any PV device can be represented by an equivalent electric circuit [5]. The equivalent circuit, shown in Fig. 1, comprises of a light dependent current source, a p-n junction diode and two resistances.I–V relationship in the equivalent circuit of Fig. 1 is governed by Eq. (4). The characteristic of any PV device are included in the model by five model parameters (IL, Io, a, Rs and Rsh). The model that describes the electrical performance of a PV device represented by Fig. 1 using Eq. (4) is called the five parameter model.(4)I=IL−Io⋅expV+I⋅Rsa−1−V+I⋅RsRshAs stated before, the five model parameters are vary with each PV device. Once the parameters at the reference condition are known, they can be used to calculate the I–V characteristics of the PV system at any other condition. Eqs. (5)–(9) are used to calculate the parameters at conditions other than reference. Using these parameters, Eq. (4) can be used to predict the performance of the PV system at any temperature and irradiance.(5)a=arefTcTref(6)IL=SSref(IL,ref+μIsc(Tc−Tref))(7)Io=Io,refTcTref3e((NCS.Tref/aref)((Eg,ref/Tref)−(Eg/Tc)))(8)Rsh=SrefSRsh,ref(9)Rs=Rs,refThe subscript ref represents the parameters at STC, T is the temperature of the PV panel, S is the absorbed solar radiation, μIsc is the temperature coefficient of short circuit current, NCS is the number of cells connected in series and Eg is the band-gap energy of the PV cell material. Eq. (10) can be used to calculate Eg at the new temperature. The constant 0.0003174 is for mono-crystalline silicon and De Soto [6] has suggested that this value can be used for all technologies with little error.(10)Eg=Eg,ref1−0.0003174TcTrefSiddiqui [12] modified Eqs. (5) and (6) based on the results of a sensitivity analysis to improve the accuracy of the electrical model. Eqs. (11) and (12) are the modified translation equations for parameters IL and a.(11)IL=GGrefm(IL,ref+μIsc(Tc−Tref))(12)a=arefTcTrefnEvolutionary algorithms provide enhanced optimization performance for non-convex problems. The objective functions used for finding the electrical model parameters are non-convex. Therefore, evolutionary algorithms are expected to provide better performance than conventional optimization techniques this estimation problem.The fitness function used in the algorithms is given by Eq. (13) and is equal to the sum of absolute errors in current and voltage predictions at short circuit, open circuit and maximum power points and the slope of the power-voltage curve at maximum power condition.(13)normalized error=absIMP,mod−IMP,expIMP,exp+absVMP,mod−VMP,expVMP,exp+absIsc,mod−Isc,expIsc,exp+absVoc,mod−Voc,expIMP,exp+abs(Ioc)+absdPdVMPIn order to compare various evolutionary algorithms, a test case with known parameters was assumed. The electrical characteristics at the reference condition were calculated using the parameters. Various evolutionary algorithms were used to estimate the parameters using the electrical characteristics at the reference condition and their performance was compared. The assumed parameters for the PV module and its characteristics at the reference condition are given in and respectively (Table 1).Using the test case developed in section 3, the performance of various standard and hybrid evolutionary algorithms was evaluated and compared. For comparison, several runs of each algorithm were performed and the value of the fitness function and its standard deviation was compared.Using the data available in Table 2, the electrical model parameters were estimated using genetic algorithm [29], differential evolution [30] and particle swarm optimization [21]. The population size was set to 500 members and the maximum allowable generations were set to 500 as well. The simulation parameters used for the three algorithms are listed in Table 3. It is worth mentioning that these parameters are the best among several trials.Five runs were conducted for each algorithm to check its accuracy and repeatability. The results are presented in Table 4. The best performance was shown by differential evolution with an average fitness function value of 0.004208 at the end of 500 iterations. It was also the most consistent with the lowest standard deviation of the three algorithms. Genetic algorithm showed the worst performance of the three with an average fitness function value of 0.03429 while particle swarm optimization was the most inconsistent with highest standard deviation value of 0.005288. The simulation time taken by the three algorithms with the simulation parameters of Table 3 were 1302.1s, 1015.1s and 3720.7s for GA, PSO and DE respectively.In order to further improve the accuracy of the estimation process, three hybrid techniques were tried. The objective was to further reduce the value of the objective function while not increasing the simulation time significantly. In total, three hybrid algorithms were developed by hybridizing Tabu Search [20] with differential evolution and particle swarm optimization with differential evolution.The problem faced during the estimation process was that the optimal solution remained unchanged for many generations thus wasting valuable computational time. In order to avoid this, Tabu Search was incorporated in the differential evolution algorithm. In addition to the differential evolution parameters and Tabu Search parameters, two additional parameters needed to be defined. These were the number of unchanged optimal solution iterations to start Tabu Search and the number of top solutions to include in Tabu Search. The methodology of the TS DE algorithm is presented below. The process flowchart is presented in Fig. 2.1.Start conventional DEMutate and crossover to generate trial solution.Form new population using conventional DE methodology.Update optimal solution if required. Else, update counter for unchanged iterations.If the optimal solution remains unchanged for a certain pre-determined number of generations, ntabu,start, call Tabu Search. Tabu Search is activated with each of the top ntabu,pop solutions in the current DE generation as the starting point for TS.In the PSO assisted DE algorithm, the PSO algorithm is activated after every 5 generations. The fraction of the best solutions in the current generation is passed to the PSO algorithm as the initial population and the PSO algorithm returns the final population at the end of the algorithm. In order to diversify the population, the worst 5% solutions in every generation are replaced in random solutions during every iteration. The process flow chart of the PSO assisted DE algorithm is shown in Fig. 3.In the differential evolution assisted Tabu Search algorithm, differential evolution is used to search for the optimal solution within a subset of the whole search space while the Tabu Search is used to move the local search within the global space. The process flowchart of the technique is shown in Fig. 4. The main steps of the algorithm are as follows.1.The algorithm starts by assuming an initial solution xcurrent within the global limits of the variables.The local gene limits are adjusted to be around xcurrent. A local population is generated within the local gene limits. The current solution xcurrent and the global optimal point are included in the population since they may include important genetic features.The differential evolution algorithm is called to determine the local optimal point.If local optimal point is better than previous global optimal point, the global optimal point is set equal to the local optimal point.The local optimal point is set as xcurrent.The process is repeated until a stopping criterion is met.All three hybrid techniques were used to estimate the model parameters using the data in Table 2. The process was repeated five times for each of the algorithms. The simulation parameters for the three hybrid techniques are listed in Table 5.The simulation results are presented in Table 6. All three techniques provided lower average fitness values than the standard techniques and with higher consistencies. Between the three techniques, DE assisted TS technique provided the lowest fitness values and the highest consistency. The simulation time taken by TS assisted DE and PSO assisted DE using the parameters of Table 5 were 4079.9s and 3135.1s, respectively, which are comparable to the simulation time for conventional DE. On the other hand DE assisted TS algorithm took 240.0s for completion.In order to validate the proposed parameter estimation methodology and to compare its accuracy with the accuracy of models available in literature, a total of six PV modules, three crystalline silicon modules and three thin film modules, were selected. The I–V curves available in the datasheets of the modules were digitized and five key I–V points were extracted from each curve. These points are short circuit (SC), open circuit (OC), maximum power point (MPP), point with voltage equal to half the voltage at maximum power point (X) and point with voltage equal to the average of maximum power point voltage and open circuit voltage (XX).The PV modules selected for model validation are listed below. The manufacturer supplied electrical performance characteristics of the modules at STC and the I–V points extracted from the I–V curves on the module datasheets are listed in Appendix A. The selected modules and their cell technologies are listed below.1.Astro Power AP110 (mc-Si)Shell Solar S36 (pc-Si)Kyocera KC-40T (pc-Si)Shell Solar ST36 (CIS)Solarex MST43LV (2-a-Si)Unisolar PVL-124 (3-a-Si)Before the electrical performance of the modules can be simulated, the model parameters for the modules were determined. The five model parameters for the selected PV modules were estimated using the DE assisted TS algorithm using the PV module electrical characteristics from Table A1 and are listed in Table 7. The two additional parameters for the seven parameters model were then estimated in a secondary optimization routine in the first five parameters remained fixed. The estimated values of the additional parameters are listed in Table 8.Five electrical performance models were selected for comparison with the five parameter model using the proposed parameters estimation methodology.The selected models are:1.Four parameter electric circuit model [4]Sandia Labs model [1]Villalva et al. electric circuit model [9]Five parameter model by Siddiqui [12]Seven parameter model by Siddiqui [12]It is important to note here that two of the models selected for comparison, four parameter electric circuit model and Villalva et al. electric circuit model, are variations of the five parameter model and differ from the proposed modeling methodology in either the assumptions involved or the parameter estimation process.Four parameter model, developed by Townsend [4] assumes that the shunt resistance is high enough to be considered infinite and neglected. This assumption greatly simplifies the parameter estimation process by reducing the model nonlinearity. The I–V characteristics in the simplified electrical circuit of the four parameter model is described by Eq. (14).(14)I=IL−I0expq(V+IRS)γkTC−1The parameters IL, Io and Rs are the same as in the five parameter model. The parameter γ is related to the parameter a in the 5 parameter model by the relation a=γkTc/q. The parameter estimation process can be found in [31] and the estimated model parameters are listed in Table B1.King et al. [1] while working at the Sandia National Labs developed an empirical model to accurately predict the electrical performance of PV devices. The model includes its own thermal model and takes into account the solar spectral and optical effects for photovoltaic modules. The electrical characteristics at any operating conditions are predicted in terms of five I–V points on the I–V curve using Eqs. (15)–(21). The model parameters have been taken from Sandia Labs database and are listed in Table B3.(15)Isc=Isc0.f1(AMa)Ebf2(AOI)+fdEdiffE0{1+αisc(Tc−T0)}(16)Imp=Imp0{C0Ee+C1Ee2}{1+αimp(Tc−T0)}(17)Voc=Voc0+Nsδ(Tc)ln(Ee)+βvoc(Ee)(Tc−T0)(18)Vmp=Vmp0+C2Nsδ(Tc)ln(Ee)+C3Ns{δ(Tc)ln(Ee)}2+βvmp(Ee)(Tc−T0)(19)Pmp=ImpVmp(20)Ix=Ix0{C4Ee+C5Ee2}{1+αisc(Tc−T0)}(21)Ixx=Ixx0{C6Ee+C7Ee2}{1+αimp(Tc−T0)}Villalva et al. [9] developed a parameter estimation methodology for the five parameters model based on the equivalent electric circuit of Fig. 1. In order to simplify the estimation process, one of the five parameters, aref, was explicitly specified. The remaining parameters were then found out by minimizing the error in maximum power prediction. The methodology to find the model parameters can be seen in [9]. The estimated model parameters are listed in Table B2.Like Villalva et al., Siddiqui [12] developed a methodology for finding the model parameters for the five parameters model. The used a simplex search optimization technique to minimize the objective function represented by Eq. (2) which is sum of the slope of the power–voltage curve and the errors in current predictions at short circuit, open circuit and maximum power points.Siddiqui [12], based on the results of a sensitivity analysis, improved the equations to vary two of the five parameters for changing input conditions based on the results of a sensitivity analysis. The sensitivity analysis showed that the five parameters model was much more sensitive to variations in IL and a than the other three parameters. The modified translations equations are given by Eqs. (11) and (12). The two additional parameters were found using the objective function given by Eq. (3).The accuracies of the various models were compared using two metrics, the root mean square error and the mean bias error, given by Eqs. (22) and (23), respectively. In these equations, y is the modeled value, x is the measured value and n is the number of values.(22)RMSE=(1/ntotal)∑i=1ntotal(yi−xi)2(1/ntotal)∑i=1ntotalxi(23)MBE=(1/ntotal)∑i=1ntotal(yi−xi)(1/ntotal)∑i=1ntotalxi

@&#CONCLUSIONS@&#
In the current work, evolutionary algorithms were used to estimate the model parameters for the five and seven parameters model. The models using the estimated parameters were then used to predict the electrical performance of six PV modules. The prediction accuracies were compared with the prediction accuracies of five other electrical models from literature. From the current work, the following conclusions were drawn.1.The differential evolution assisted Tabu Search optimization algorithm developed in the current work provided the lowest values of objective function at the end of the algorithm and therefore its estimated parameters are the most accurate of the evolutionary algorithms.A comparison of the accuracy of the electrical model using the parameters estimated by the proposed methodology and the electrical model using parameters estimated by a conventional optimization algorithm showed that prediction accuracy improved for all modules when the proposed methodology was used.The electrical model using the parameters estimated by the proposed methodology also showed better results than several models from literature.