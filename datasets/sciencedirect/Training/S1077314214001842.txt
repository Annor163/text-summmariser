@&#MAIN-TITLE@&#
A new method to analyse mosaics based on Symmetry Group theory applied to Islamic Geometric Patterns

@&#HIGHLIGHTS@&#
New method to analyse mosaics based on the mathematical principles of Symmetry Groups.The method includes a higher level of knowledge based on objects.Extraction of objects and their main features of patterns with a Wallpaper Group (WG).Classification of objects according to their shape and obtaining their isometries.The extraction of the WG of the pattern using the relationships between objects.

@&#KEYPHRASES@&#
Mosaics,Symmetry Groups,Wallpaper Groups,Point Groups,Image understanding,Tiles,Islamic Geometric Patterns,Pattern classification,

@&#ABSTRACT@&#
This article presents a new method for analysing mosaics based on the mathematical principles of Symmetry Groups. This method has been developed to get the understanding present in patterns by extracting the objects that form them, their lattice, and the Wallpaper Group. The main novelty of this method resides in the creation of a higher level of knowledge based on objects, which makes it possible to classify the objects, to extract their main features (Point Group, principal axes, etc.), and the relationships between them. In order to validate the method, several tests were carried out on a set of Islamic Geometric Patterns from different sources, for which the Wallpaper Group has been successfully obtained in 85% of the cases. This method can be applied to any kind of pattern that presents a Wallpaper Group. Possible applications of this computational method include pattern classification, cataloguing of ceramic coatings, creating databases of decorative patterns, creating pattern designs, pattern comparison between different cultures, tile cataloguing, and so on.

@&#INTRODUCTION@&#
This paper proposes a method to get the understanding generally present in any kind of pattern that presents a Wallpaper Group (WG), which describes the arrangement of a set of objects repeated from a set of isometries. Unlike other existing works, which only identify the WG (the so-called “structure”), this method obtains the objects present in the pattern, allowing them to be classified and their symmetries obtained. Moreover, the information extracted from the objects is used to obtain the isometries that constitute the WG. An important contribution is the possibility of approaching the pattern analysis in two ways: by discarding the colour of each object as a discriminating feature, which allows a different WG to be obtained when there are objects with the same shape and different colour, and second by obtaining the WG of each object class, apart from the WG of the entire pattern, thus obtaining all the WG present in the pattern. This method has been implemented through an application, using the Image Processing and Pattern Recognition techniques and the mathematical principles of Symmetry Groups, and has been tested and validated on Islamic Geometric Patterns (IGP) and a number of alternative datasets (mainly from http://en.wikipedia.org/wiki/Wallpaper_group, and other paving slabs and fabrics).The main terms used in this article are defined as follows:•Region: set of neighbouring pixels in the image with similar colour, which are perceived as a unit.Object: geometric figure matching a region with a closed contour and a series of properties (colour, area, perimeter, etc.).Shape: description of the object depending on the points or parts making up the outer contour and how they are interrelated in terms of positions, orientations and relative sizes [1]. Shape is the main feature of an object and in this work shape and contour are used interchangeably.Object class: set of objects with the same shape, size and colour.Isometries: geometric transformations which, when applied to an object, do not change its shape. The isometries are: translations, rotations and reflections (symmetry axes). A glide reflection is the combination of a reflection relative to a symmetry axis and a translation in the direction of the same axis.Pattern: a repeated set of elements. In this work the elements are the objects, and they are duplicated and combined by means of isometries without overlap, covering a flat surface.Primitive Cell (PC) or Unit Lattice: the minimum part of the pattern that can generate the whole pattern by making copies and displacements. The Primitive Cell may be an object or a set of objects.Piece or Tile: fragment of thin ceramic material, with the outer face glazed, used to cover floors and walls.Islamic Geometric Patterns (IGP) or Islamic Mosaics: basic decorative elements of Islamic architecture consisting of a pattern formed by a set of small pieces with simple shapes (straight lines and arcs). In this work, for the purposes of the image processing of IGPs, the pieces are considered as objects.A Symmetry Group (SG) is the set of all isometries σ, which transforms a set of objects S into itself (σS=S). There are four types of Symmetry Groups: Point Groups, Frieze Groups, Wallpaper Groups and Crystallographic Groups, depending on whether they have 0, 1, 2 or 3 independent translations [2–4]. This paper deals with Point Groups and Wallpaper Groups.The Point Group (PG) describes the group of all isometries under which an object is invariant. The classes of PG are the following:•Rotational symmetry (also called n-fold rotational symmetry or cyclic symmetry): cyclic groups C1, C2,…, Cn, where Cn(of order n) consists of all rotations about a fixed point (the centroid) by multiples of 360°/n (Fig. 1a Cyclic Group C3 with 120° rotations).Reflection symmetry (also called mirror symmetry or dihedral symmetry): dihedral groups D1, D2,…, Dn, where Dn(of order 2n) consists of the rotations in Cntogether with reflections in n symmetry axes that pass through the centroid (Fig. 1b Dihedral Group D2 with 180° rotation and two symmetry axes).The WG describes the arrangement of a set of objects which are repeated to form a pattern, from a set of isometries that always include two translations. There are 17 different WG [3]. The two smallest independent translations in the pattern define the lattice. The PC is the smallest part of the pattern repeated by lattice translations. Fig. 1 shows the output of the application developed for two different objects and two patterns. Fig. 1c shows a WG CMM with glide and non-glide symmetry axes and 180° rotations, and Fig. 1d shows a WG P3 with 120° rotations and without any kind of symmetry axes. The two patterns are shown with the Primitive Cell.The scientific literature contains research studies that generate or analyse IGP based on SG, and some others based on different geometric approaches. Among the SG-based works, there are many examples of pattern generation [5,6] and the development of computer-aided design allowed the creation of software for generating patterns [7,8], but this is straightforward, since it just consists in geometric transformations applied repetitively. As for analysing IGP, special mention should be made of the theoretical approach by [9], who roughly described the steps to be followed in pattern analysis, i.e. identifying the PC and obtaining the WG. In [10], the authors presented an application which obtains the translations, symmetry axes and centres of rotation of an image via image correlations with itself translated, reflected or rotated, respectively, to determine the PC and WG using heuristic methods. This computer application is one of the most comprehensive contributions in the area of image analysis based on SG, although precisely due to its simplicity (it does not deal with objects), no information can be obtained beyond that deduced from just the colour of pixels. Instead of correlations, [11] extracted the lattice of patterns using Distance Matching Functions (DMFs). Much like previous works, [12,13] also obtained the PC and the WG, but using Wavelets and a Nearest Neighbour classifier. In [14], the authors used Liu’s method described in [10] to obtain the PC, and the WG in order to detect defects in patterns. As they pointed out, the WG cannot be obtained if the number of defects is relevant. On the other hand, [15] analysed IGP obtaining their Point Group (for rosettes), Frieze Groups (for friezes) or Wallpaper Groups, and in order to obtain the isometries of patterns of the image itself, correlations between translations, reflections or rotations were performed. The final description of an IGP was a feature vector including the Symmetry Group of the pattern and a colour histogram of the Primitive Cell (patterns with Frieze or Wallpaper Groups) or Fold (patterns with Point Group) but did not consider objects, the only contributions being the use of rosettes, friezes and the colour histogram.With respect to the non SG-based works, there are many different methods for generating patterns, for example from rosettes [16] or from two of the most common pieces used in IGP called Zohreh and Sili [17]. A review of the different methods can be found in [18]. For analysing Islamic Geometric Patterns [19] proposed a theoretical method based on two features that were defined as Minimum Number of Grids (MNG) and Lowest Geometric Shape (LGS). [20] also proposed a method for analysing Islamic Patterns, which presented a Point Group (rosettes), based on the decomposition of a square image into a quadtree structure searching for symmetries at different levels of abstraction; this method resembled the work of the ancient artisans consisting in drawing the motif on a folded paper and then unfolding it.Not all the research papers cited that present proposals for the classification of IGP come with software tools, and those that do include them only operate at pixel level, but do not retrieve the objects that form the pattern. Therefore, it is impossible to obtain their symmetries, and image cataloguing is performed using only colour information. Hence, they are not able to find alternative WG in patterns when there are identical objects that differ in colour, which frequently occurs. In fact, in [19], the authors criticised the methods based on Symmetry Groups because they did not reflect the way of thinking of the artisans (how to combine the pieces) and were a rather general approximation that failed to explore edition capabilities (to generate new patterns). Such criticism can be applied to the methods proposed in [10–12].Thus, in this paper we propose a new method for analysing images of Islamic Geometric Patterns, and its key feature is the incorporation of a higher level of abstraction: the objects forming the pattern. This method has led to the development of an application. The information found can be used to generate new patterns. Earlier versions of the method have been reported in [21–23]. The main contributions of this research are the following:•Pattern analysis is more comprehensive: the objects are obtained and classified, and their Point Group is also obtained.Obtaining the isometries, and therefore the WG, not only from the colours of the pixels, but also from features extracted from the objects (considering colour, shape, Point Group and orientation). Thus, the colour can be discarded when classifying objects, so if there are objects with the same shape and different colours, patterns with more than one WG can be found.The WG is obtained for each class of objects. So, if there are objects with different WG, they can be found.The paper is organised as follows. In Section 2 a brief description of the proposed method is presented. Sections 3–5 offer a detailed description of the different levels of the method: Image Level, Object Level and Structure Level. Section 6 presents the results of the application of the proposed method on a set of IGP samples, the parameters of each stage and the computational cost, and the results on other sets containing Wikipedia WG samples and some images of paving slabs from public constructions and fabrics, in order to show the flexibility of the method. Finally, Section 7 reports the conclusions and further work.The method is based on stages according to three levels of knowledge that they include: (a) Image or pixel-oriented level, in which the image is segmented to obtain the different regions of interest; (b) Object-oriented level, in which the regions obtained correspond to objects and their features extracted including the contour and Point Group; and (c) Structure Level, in which the translations, rotations and symmetry axes existing in the pattern, that is, the structure or Wallpaper Group, are found. Fig. 2shows the scheme of the methodology proposed. All the process that supports this methodology is entirely automatic, except the tuning of the parameters used and the configuration of the Image Level (i.e. the segmentation method applied in Section 3.2).The initial values of the parameters have been obtained using an implementation of the optimisation algorithm Simulated Annealing described in [24], using a set of patterns with different Wallpaper Groups to determine a set of optimal values for the parameters. The final adjustments to obtain successfully the complete results (all classes of objects with their Point Group) require in some specific cases fine manual adjustment after outcome. The computational cost, the parameters used and the intermediate graphical results of the algorithm at each stage are described in Section 6.2.This level is a pixel-oriented level, and its purpose is to extract the different regions of interest in the image, which is achieved by means of pre-processing, segmentation and morphological operations.A pre-processing stage is performed to reduce noise present in the image. This stage is performed using two different low-pass filters: Gaussian blur or Median.The next stages of the application depend greatly on the quality of the segmentation. A wide variety of image segmentation approaches have been reported in the literature [25–27].Two different ways to segment the images have been implemented in this work. The first is through a clustering technique based on the Mean-Shift algorithm [28,29], which is appropriate when the edges between regions are well defined. The second method consists in an edge-based technique, like the Watershed algorithm [30], which is more appropriate for images with weak edges between the regions because it emphasises the edges.Later, operations like Erosion, Dilation, Opening and Closing have been applied in order to remove small regions and holes or to separate linked regions [31], so the remaining regions will be considered the objects of the image. Finally, Hu moments [32] were used to calculate the properties of the objects like area, centroid, angle and size of principal axes that will be used in the following stages.The result after applying the operations included in the Image Level consists of m regions. At the end of this level, an object Okcontains only the properties of its corresponding region: Ok, k∈[0, m−1] is described using a tuple Ok=(Rk, colourk, pkc, Ak, φkmin, Ikmin, Ikmax), where:•Rk={pi}, i∈[0, n−1]: set of n pixels belonging to the region.colourk: average colour of pixels of Rk.pkc=(xc, yc): centroid of the region.Ak: area (number of pixels of Rk).φkmin: angle of major axis.Ikmin, Ikmax: length of principal axes.The goal of this level is to complete the objects by extracting the shape (contour) of the regions found on the previous level, to classify them, and to obtain the Point Group for each class of objects.In order to extract the contour of each region, a boundary-following algorithm [33] has been used, thus the contour C is a closed sequence of 8-connected points defined as following: C={pi}, i∈[0, m−1], where piare the contour points and m is the number of points of such a contour.Unlike industrially manufactured objects, in IGP, the objects found in the images are repeated with slight differences between them due to fact that they are handmade. These differences can affect both the shape and the orientation, and hence in order to obtain a classification of the objects these two features must be taken into account. In this article, the classification methodology is based on an all-against-all comparison process (each object is compared to all other objects) using a coarse-to-fine strategy (first a quick comparison to discard obvious cases and later a precise comparison to detect smaller differences) in order to optimise the computational cost. Firstly, each pair of objects is compared using the area and the length of the principal axes. If the two objects are geometrically similar in this coarse comparison, they are compared using a ‘fine’ process to obtain a measurement of their dissimilarity [34].The works presented in [35,36] also perform a process of fine comparison using the Canny edge detection algorithm to extract objects and then to obtain features like relevant points, type of sides, relative lengths, orientation and concavity/convexity, colour information and also the topological relationships among them. Dissimilarity was calculated by comparing one-by-one the types of sides between the relevant points that were found, and also by using the relative information about size and orientation, in a similar way to how [37] compared contours looking for tangencies, concentricity, parallelism, etc. The problem with this technique is the noise typically present in the images of IGP, which makes it difficult to obtain all of these characteristics with accuracy.To deal with this problem, in this work, the fine comparison has been performed by using the contour-based method described in [38]. In particular, by assuming the contour of the objects to be a discrete and periodic function f[n]=(xn, yn), n∈[0, N−1]:1.The contours were filtered by means of a discrete convolution using a 1D Gaussian filter.The contours were re-sampled to 256 equidistant points because they must have the same number of points to be compared properly.The coordinates of the points in each contour were converted so as to be relative to the centroid of its region.Then, the dissimilarity d(f1, f2) between the contours of two objects O1 and O2 was defined as:(1)d(f1,f2)=minα,q1N∑n=0N-1(f1[n]-Rα·f2[n+q])2where N is the number of points on the two contours (256 after resampling), q is the starting point of contour f2 to compare to f1, q∈[0, N−1], and Rαis a rotation of angle α. Except in some cases, it is enough to consider the multiples of 30° since in all cases the angles of rotation in Wallpaper Groups are 180°, 120°, 90° and 60°. The above expression is minimised with respect to q (starting from any point) and α (orientation).Since an object can also appear reflected in the image, the same process is repeated but taking the second contour reflected about the horizontal axis passing through the centroid of the object fR[n]=(xn, −yn), n∈[0, N−1], thus obtaining the dissimilarity of the reflected objects dR(f1, f2)=d(f1, f2R). Finally, those pairs of objects in the image are considered as belonging to the same class if d(f1, f2)<u or dR(f1, f2)<u, where u is a user-chosen threshold in the range [0.1…1]. If dR(f1, f2)<d(f1, f2), the objects are reflected. See Fig. 3.The fine comparison method described above is used to compute the PG of an object but, in this case, to compare each object to itself the following aspects have been considered:•The order of rotational symmetry Cnof an object O1 with contour f1 is the number of local minima (under a threshold) of d(f1, f1).The order of reflection symmetry Dnof an object O1 with contour f1 is the number of local minima (under a threshold) of dR(f1, f1), where the angles of reflection are: βi=(αi/2), i=0, 1,…n−1, where αiis each rotation angle which minimises dR(f1, f1). These angles are equally spaced according to the order of the Symmetry Group: βi=β0+i(180/n), i=0, 1,…n−1.The sample in Fig. 4a d(f1, f1) has three minima below the threshold (0.05), but the minima of dR(f1, f1) are always above the threshold. The minima are separated 120°, which means cyclic symmetry C3. In Fig. 4b there are two local minima (0° and 180°) below the threshold, which means dihedral symmetry D2 with axes of 0° and 90°.For each object class, a representative object is randomly chosen as a relative reference, and the rotation and/or reflection of the other objects in the class with respect to it are then stored.In the same way that an object with symmetry Cnor symmetry Dnwith order n has n rotations (being invariant in all of them), there are n rotations that relate the representative of the class with any other object in the class: αi=α0+i(180/n), i=0, 1,…n−1.The result after applying the operations included on the Object Level is a description of each object as a tuple Ok=(Rk, colourk, pkc, Ak, φkmin, Ikmin, Ikmax, Ck, classk, reflectionk, αk, pgk, βk), where the new features added are:•Ck: contour (closed sequence of 8-connected points).classk: class of the object.reflectionk: boolean value to indicate whether the object orientation is reflected with respect to the object selected as a reference in the class.αk: orientation of the object with respect to the object selected as a reference in the class.pgk: order n for Point Group (negative when Dnand positive when Cn).βk: angle of one reflection axis, whether the object has reflection symmetry.This is the highest level, and its purpose is to obtain the Primitive Cell and Wallpaper Group. For each pair of objects of a class, there will be one or more isometries that relate them. If the same isometry is fulfilled for several pairs of objects, it is an isometry of the Wallpaper Group. The isometries can be the following:Rotation isometryFor each pair of objects O1 and O2 belonging to the same class, with centroids (x1, y1) and (x2, y2), reflection1=reflection2 and pg=C1 or D1, there is a rotation of angle γ=α1−α2, radius r and centre C which relate them, being:(2)r=(x2-x1)2+(y2-y1)2/2sin(γ/2)(3)C(cx-x1)2+(cy-y1)2=r2(cx-x2)2+(cy-y2)2=r2where the true centre C keeps the sign of the rotation angle, and when γ=0° and r=∞, then the isometry is a translation. Thus, for two objects of the same class with pg=Cnor Dn, the number of angles that relate both objects through rotation should be n2, yet the angles are repeated, so there are n rotations of angle γ=(α1−α2)+l(360/n), radius r1 and centre C1, which relate them (see Fig. 5a). In the case of Fig. 5b, γ3=0° so there is a rotation of radius r3=∞ which corresponds to a translation.Translation isometryFor two objects O1 and O2 of the same class, with centroids (x1, y1) and (x2, y2), reflection1=reflection2 and pg=Cnor Dn, there is a translation which relates them if there is a rotation angle γ=(α1−α2)+l(360/n)=0°.The translation vector is the difference between the centroids of the objects: D1–2=(x1−x2, y1−y2).Glide and non-glide reflection isometriesFor two objects O1 and O2 of the same class, with centroids (x1, y1) and (x2, y2), pg=Cnand reflection1≠reflection2, there are n symmetry axes of angle δ1, a point E (which is the midpoint between the centroids and is the same for all axes) and a glide glide1 which relate them, being:(4)δ1=(α1+α2)/2+l(180/n),l∈[0,n-1](5)E=(ex,ey)=x2+x12,y2+y12(6)glide1=(x2-x1)·cosδ1+(y2-y1)·sinδ1where (6) are the projections of the vector between the centroids over the axis. If glide1≈0 the symmetry axis is non-glide, otherwise it is a glide symmetry axis.Thus, for two objects O1 and O2 of the same class, with centroids (x1, y1) and (x2, y2), with pg=Dn, there are n symmetry axes of angle δ1=(β1−β2)/2+l(180/n), point E and glide glide1 which relate them.As happens with rotations, there are only n values for δ1 that generate different angles, and therefore the number of symmetry axes is n. The two examples in Fig. 6a and b show the symmetry axes between two pairs of objects of the same class with pg=C1 (calculated from object rotations, Fig. 6a) and pg=D1 (calculated from their internal symmetry axes, Fig. 6b). On the other hand, Fig. 7shows the two symmetry axes between two objects of the same class with pg=D2. Each symmetry axis is calculated from the combination of the internal axes represented with the same colour.The lattice is defined by the translations in the pattern (see Fig. 8) and thus, as defined in Section 1.1, the PC is the smallest part of the pattern that is repeated by translations of the lattice.Two approaches can be used to obtain the lattice: from Image Level operations and from a set of Scattered Elements. In the first case, some works have been carried out using techniques such as autocorrelation [39,40], Markov Random Field (MRF) and Mean Shift Belief Propagation (MSBP) [28] to obtain the points forming the lattice, while others choose the directions which define the Primitive Cell using techniques such as Hough Transform [10]. If the lattice is obtained from a set of Scattered Elements, as for instance in [41,42], some kind of visual similarity is performed in order to determine which elements are equal and then an optimisation of the existing translations is performed. This latest approach has been used in this work since it better suits the kind of objects found at the Object Level.For each class of objects, the translation vectors between the objects with the same orientation are obtained. All vectors that are a linear combination of any pair of smaller vectors are then removed. Finally, only one pair of vectors remains (L1 and L2) as the basis of a vectorial space defined by the positions of objects with the same rotation and reflection. Hence, the PC is defined by the vectors L1 and L2.When more than one lattice is found, they are not independent so that the objects do not overlap. Therefore, the largest PC is chosen because it includes the others and it is the only one that is valid for the entire pattern. In Fig. 8b the PC including the brown and green objects is the only one valid for the entire pattern and includes the other ones.Table 1shows the diagram of the 17 Wallpaper Groups that exist together with their isometries and the classic nomenclature as well as the shape of their more generic PC [3]. The complexity of the isometries increases from left to right (order of rotation centres) and from top to bottom (presence of more symmetry axes). The solid black line of PC is not represented if it matches the symmetry axes, which are represented using a blue dashed line for non-glide axes and a red dashed line for glide axes and rotation centres (order 2: circumference, order 3: triangle, order 4: square, order 6: hexagon).Table 1 shows three characteristics (Primitive Cell, Rotation Centres and Symmetry axes) that allow the WG to be detected for each class of objects in a pattern. These three characteristics and how to obtain them are explained in the next three subsections.The shape of a PC may be a generic parallelogram, rectangle, square, rhombus or equilateral rhombus. The type of shape discards some Wallpaper Groups (e.g. if the PC is a generic parallelogram, the Wallpaper Group can only be a P1 or P2). This shape is obtained from translations by comparing the size and the angles of the sides of the PC (Fig. 9). Due to the hierarchy among them, a WG may take the shape indicated, and all those derived more restrictively.Each rotation centre is obtained from the rotations between objects of the same class, by matching their centres. The main feature is the order |360°/γmin|, γminbeing the smaller rotation angle γl.Each symmetry axis is obtained from the reflections, between objects of the same class, with the same angle δland aligned; the symmetry axis glide is the lowest from all the symmetry axes between pairs of objects (if glide≈0, the symmetry axis is non-glide). The main features are:•If the angle δlis parallel or orthogonal to the sides and diagonals of PC (see Fig. 9).If it is a glide symmetry axis or non-glide symmetry axis.As each object class can generate a different PC, it can generate different rotation centres and symmetry axes and, consequently, different WG. Therefore, the WG for each object class is obtained separately, and the least restrictive one is chosen, i.e. the one whose isometries are present in the others, which is the only one valid for the entire pattern. In the pattern shown in Fig. 10, WG P4 is the least restrictive one, its rotation centres are present in P4M (Fig. 10a), but the symmetry axes of P4M are not included in P4 (Fig. 10b), so P4 is the only one that is valid for the entire pattern.The pattern structure contains all the isometries, and it is contained in a tuple E=(O, V1, V2, PC, WP, θ), where:•O: origin of Primitive Cell.V1, V2: vectors of Primitive Cell sides.PC: shape of Primitive Cell (generic parallelogram, rectangle, square, rhombus, equilateral rhombus).WP: Wallpaper Group (P1, PM, PG, CM, P2, PMM, PMG, PGG, CMM, P3, P31M, P3M1, P4, P4M, P4G, P6, P6M).θ: angle of an axis (with respect to PC elements: sides or diagonals) for Wallpaper Groups PM, PG, CM and PMG. This is necessary because in the PM and PG groups the symmetry axes may be parallel to one side or another, in the CM group the symmetry axes may be parallel to one diagonal or another, and in the PMG group non-glide symmetry axes may be parallel to one side or another.

@&#CONCLUSIONS@&#
