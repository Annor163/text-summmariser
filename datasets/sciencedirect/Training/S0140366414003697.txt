@&#MAIN-TITLE@&#
Resource allocation in multi-relay multi-user OFDM systems for heterogeneous traffic

@&#HIGHLIGHTS@&#
Resource allocation with subcarrier-pairing under coexistence of RT and NRT traffic.Optimization of relay-user selection, subcarrier-pair assignment and power allocation.Flexible QoS guarantee of real-time traffic by system parameter adjustment adaptively.Total power constraint uses power resource better than individual power constraints.

@&#KEYPHRASES@&#
Resource allocation,OFDM systems,Multi-relay,Heterogeneous traffic,Subcarrier-pairing,

@&#ABSTRACT@&#
Resource allocation is an important issue that has not been well resolved in multi-relay multi-user Decode-and-Forward (DF) OFDM systems with subcarrier-pairing at relays in the presence of heterogeneous flows, i.e., simultaneous real-time (RT) and non-real-time (NRT) traffic. In this paper, we address the issue by first formulating it as a joint optimization problem of relay-user pair selection, subcarrier-pair assignment and power allocation and then solving it through dual decomposition and subgradient methods. Asymptotic optimal iterative algorithms with polynomial complexity are proposed with the objective of maximizing sum-transmission-rate of NRT traffic while providing quality-of-service (QoS) guarantee for RT traffic, in two cases: (i) with total network power constraint and (ii) with individual power constraints. Effective selections of initial dual variables and stepsize for the subgradient method are also presented. Simulation results are provided in multiple scenarios and they show that: (i) the proposed algorithms outperform the existing schemes in terms of providing QoS requirements of RT users and maximizing sum network transmission rates; (ii) algorithms designed under total power constraint exploit the power resource much better than those under individual power constraints.

@&#INTRODUCTION@&#
The ever-increasing heterogeneous wireless applications with diverse quality-of-service (QoS) requirements impose a great challenge on the design of future wireless communication networks due to increasing traffic loads and flow diversity. In addition, wireless channels are prone to impairments, such as fading and frequency selective characteristics. Therefore, it is crucial to allocate limited system resources adaptively according to channel state information (CSI) and differentiated QoS requirements to provide desirable wireless system performance. Orthogonal Frequency Division Multiplexing (OFDM) is a leading multicarrier modulation technique which provides various configurable system resources, such as subcarriers, power and modulation levels. Due to its superior performance, OFDM has been adopted by a few communication standards including IEEE 802.16j that supports relay-assisted cooperative communication, which is a very promising networking paradigm considered in this paper. However, efficient resource allocation in relaying OFDM systems is even more challenging as compared with traditional single-hop OFDM systems.In single-hop OFDM systems, resource allocation refers mainly to subcarrier assignment and power allocation, as well as bit loading. Much work on this issue has been reported in the past decade [1]. However, the resource allocation problem in relaying OFDM systems, especially in multi-relay scenarios, is more complex; it involves more variables, such as subcarrier permutation (i.e., subcarrier-pairing) [2] and even network coding at relay stations [3,4]. Furthermore, subcarrier assignment in multi-relay systems often involves relay selection, which is not considered in single-hop or single-relay OFDM systems.In general, relay selection in multi-relay OFDM systems falls into three categories [5]: symbol-based, subcarrier-based and subcarrier-pairing relay selections. Such three relay selections and their advantages or disadvantages can be briefly described as follows:Symbol-based relay selection: only one relay out of multiple available relays is selected based on the channel condition of the whole OFDM symbol. Here, the channel condition often refers to the end-to-end equivalent channel gain which can be calculated as the minimum of the channel gains of the first and the second hops if Decode-and-Forward (DF) relaying strategy is applied at relays, or as the harmonic mean of both channel gains if Amplify-and-Forward (AF) is adopted at relays. Thus, the symbol-based relay selection chooses the relay with the highest equivalent end-to-end channel gain as the best relay. Such scheme is usually not efficient since the differences of channel conditions among different subcarriers at multiple relays are not exploited.Subcarrier-based relay selection: one best relay for each subcarrier is selected [6], i.e., each subcarrier is assigned to one relay at which the subcarrier has the highest end-to-end equivalent channel condition among all available relays. In such scheme, signals received on one subcarrier in the first hop is decoded if DF is adopted (or amplified if AF is used) and forwarded by the relay on the same subcarrier in the second hop. Compared with symbol-based relay selection, subcarrier-based relay selection can exploit frequency diversity and node (or relay) diversity; and hence, it is likely to achieve better system performance. However, such scheme is still not optimal since the same subcarrier is used over the two hops when relaying signals.Subcarrier-pairing relay selection: the system performance of the subcarrier-based relay selection can be enhanced by permuting and pairing subcarriers in the first and the second hops according to their channel conditions, resulting in the subcarrier-pairing relay selection. Therefore, the subcarrier in the second hop can be changed when forwarding signals at a relay, so as to exploit the independent frequency selective fading feature of the channels over the two hops. Such scheme can achieve optimal system performance by using ordered subcarrier pairing [7] for AF relaying system. In DF relaying system, ordered subcarrier pairing is also optimal if the relays do not buffer and reschedule packets over multiple time slots [3,8,9] or if one relay cannot change the number (or set) of subcarriers it used [10]; or else, the system performance can be further improved by rescheduling or re-packetizing. For the latter case, however, the implementation complexity and cost of relay station are likely higher than the subcarrier-pairing based system.In all, the subcarrier-pairing scheme usually outperforms symbol-based or subcarrier-based schemes, and fully utilizes relay- and frequency-diversity, making this scheme more attractive. Note that, the symbol-based scheme can also employ subcarrier pairing but only at the selected relay, which is different from the subcarrier-pairing scheme where multiple relays are utilized.Several results on resource allocation with subcarrier-pairing in relaying OFDM systems have been published recently. In basic three-node relaying systems, authors in [2,7] investigated the optimal power allocation problem to maximum system capacity under total power constraint, and proved sorted subcarrier pairing is optimal for both AF and DF OFDM relay systems. Further, if assuming the relay which adopts DF relaying can forward message on a subset of available subcarriers, authors in [10] found that joint optimization of subcarrier pairing and subcarrier set selection can enhance the system capacity under individual power constraints. In complex network scenarios, authors in [5] studied the joint optimization problem of subcarrier-pairing, relay selection and power allocation with the objective of maximizing sum transmission rates for multi-relay one-way single-user AF OFDM systems. Such a joint optimization problem was also studied in multi-relay two-way AF OFDM systems [11]. These works mainly concerned pure capacity maximization.Moreover, Authors in [12] took the assumption that the proportional fairness [13] among relays and users are pre-configured to satisfy QoS requirement of each individual user, and developed a fairness-aware resource allocation scheme with the aim of capacity maximization for multi-relay multi-user one-way OFDM systems. Considering that different subcarriers may carry data from different services, authors in [14] formulated the optimization of subcarrier-pairing and power allocation as a weighted sum-rate maximization problem for a single-relay single-user DF OFDM system; wherein, the weighting factor reflects different priorities or QoS requirements. Such weighted factor is often adopted in two-way relaying systems to prioritize different users [4] or downlink and uplink sessions [3]. Although these works take the QoS requirements of traffic into account, the characteristics of heterogeneous traffic, i.e., real-time (RT) traffic and non-real-time (NRT) traffic, are not differentiated explicitly, resulting in insufficient support for RT traffic when the weights allocated to RT traffic are not fitting its requirements. To some extent, the proportional fairness or weighted strategy used can be viewed as solely homogeneous traffic support or weak support for heterogeneous traffic.In this paper, we investigate the joint optimization problem of subcarrier-pair assignment, relay-user pair selection and power allocation issues with emphasis on heterogeneous traffic support in a two-hop multi-relay multi-user DF OFDM system. The major contributions of this paper are as follows:(i)Formulating a new problem: different from the works so far which focus on either pure capacity maximization without consideration of traffic characteristics or weak support for heterogeneous traffic, we aim at providing optimal solutions to support the transmission of heterogeneous traffic in multi-relay multi-user scenarios. We formulate the problem with the objective to maximize the sum-rate of all NRT traffic while providing QoS guarantee for individual RT traffic. Such formulation can differentiate the heterogeneous traffic requirements explicitly; and thus, it may result in a resource allocation scheme with flexible and strong support of heterogeneous traffic.Presenting joint optimization problems under two types of power constraints: when formulating the optimization problem, we jointly consider relay-user selection, subcarrier-pairing assignment and power allocation altogether, in two cases: total power constraint and individual power constraints. Hence, the resulting resource allocation schemes by solving these problems can exploit radio resources fully; and they can be potential candidates served for scenarios with different power configurations respectively.Proposing optimal resource allocation schemes: the formulated optimization problems are mixed integer programming problems that are non-convex. Due to the high exponential complexity of the original problems, as shown in Sections 3 and 4, we resort to the dual decomposition approach [15] to develop asymptotic optimal schemes with polynomial complexity. In particular, the problems can be solved in three phases and the complexity of the resulting algorithms is polynomial in the number of subcarriers.The remainder of this paper is organized as follows. We describe the system model and formulate the problem under total power constraint in Section 2, and propose an iterative asymptotic optimal resource allocation algorithm using dual decomposition and subgradient methods in Section 3. We then reformulate the problem under individual power constraints and provide the solution in Section 4. In Section 5, we evaluate the convergence performance, and the system performance in terms of end-to-end transmission rates for RT and NRT traffic in various cases with different network configurations. We conclude the paper in Section 6.We consider a multi-relay downlink OFDM system with one base station (BS), K relay stations (RS), and M subscribed mobile stations (MS) located at the cell edge including MrtRT users and (M−Mrt) NRT users, as shown in Fig. 1; here we assume there are no direct links between BS and MSs due to the large distances between them. We refer to RT users as those with RT traffic, and to NRT users as those with NRT traffic. In this one-way system, relay stations operate in a time-division duplexing (TDD) model, applying the DF relaying scheme in two phases. In the first phase, the BS broadcasts its data to RSs, and then in the second phase, each RS decodes the received data, processes the data and forwards them to the target MSs. In particular, in the first phase while all RSs listen, BS sends one OFDM frame with traffic destined to different RSs on pre-assigned subcarriers (i.e., n∈{1,…,n} shown in Fig. 1); in the second phase, BS keeps silent, while RSs decode the received data on their pre-assigned subcarriers and forward the data in a synchronous fashion on the paired subcarriers (i.e., n′∈{1,…,n} shown in Fig. 1) as in OFDMA schemes. Then, MSs could decode data forwarded by RSs on their allocated subcarriers. This process defines subcarrier-pair (n,n′) which is associated with the RS k (k∈{1,…,K}) assigned to forward data to the MS m (m∈{1,…,M}) and as such determining a relay-user pair (k,m). Note that a relay can have several subcarrier-pairs.We suppose each frequency-selective channel/link is divided into N orthogonal subcarriers with flat fading and the channel frequency responses remain constant during the span of the two phases. We denoteHsknandHkmn′the channel frequency gains for subcarrier pair (n,n′),∀n,n′∈{1,…,N}, over the two-hop path (s,k,m), respectively. Here, (s,k,m) refers to the end-to-end transmission path (BS→RS k→MS m), i.e., transmission from BS to RS k and from RS k to MS m. We assume the additive Gaussian noise power at relays and mobile stations to be independent of subcarrier index; and over single subcarrier they are denoted asσr2andσm2, respectively. For a given subcarrier pair (n,n′) assigned to relay k and user m, we denotepsknandpkmn′the allocated power for subcarrier n and n′. Then, the end-to-end instantaneous rate of subcarrier pair (n,n′) over path (s,k,m) can be represented as [16](1)Rkmnn′=12log21+minpsknγskn,pkmn′γkmn′whereγskn≜|Hskn|2/σr2andγkmn′≜|Hkmn′|2/σm2are the corresponding channel-to-noise ratios. In Eq. (1), the rateRkmnn′is normalized to unit bandwidth; and the factor of12results from using two phases to send the data from BS to MSs via RSs. Here, we assume that the channel-to-noise ratios of all links in the network, i.e., CSI, are perfectly known at a central controller embedded within the BS, and the resulting resource allocation information, including subcarrier pairing, relay-user pair and power allocation, can be sent to associated stations via a separate reliable control channel. Such assumption is widely adopted in the literature [2–5]; and the resource allocation schemes proposed under such assumption can serve as upper bounds and provide benchmarks for designing schemes when the negative effects of imperfect CSI [17–20] are considered.In this paper, heterogeneous traffic including NRT and RT traffic is considered. The QoS requirement for RT traffic can usually be regarded as the minimum transmission rate requirement [21,22]. Although authors in [20] impose average maximum delay constraint on the RT traffic, they transform it into minimum required scheduled rate constraint in their optimization problem based on the characteristics of RT traffic, under the assumption of Poisson arrival distribution. On the other hand, NRT traffic has no QoS requirement; therefore it can be treated as best-effort service [20]. In this paper, we prioritize RT traffic requirements through guaranteeing the required rate constraint for RT traffic with the needed system resources, while we service NRT traffic by utilizing the remaining resources.In this paper, we formulate the problem as a joint optimization for resource allocation of subcarrier pairs, relay-user pairs and power with the objective of maximizing the sum rates of NRT users (in the user set {Mrt+1,…,M}, shown in Fig. 1) while having the required rate of each RT user (in the user set {1,…,Mrt}). Mathematically, we first consider total network transmit power constraint, given by PT, and we formulate the optimization problem as:(2)max{ρ,δ,p}∑m=1+MrtM∑k=1K∑n=1N∑n′=1Nρnn′δkmnn′Rkmnn′subject to:(3)∑n=1Nρnn′=1,∑n′=1Nρnn′=1,ρnn′∈{0,1},∀n,n′(4)∑k=1K∑m=1Mδkmnn′=1,δkmnn′∈{0,1},∀n,n′(5)∑m=1M∑k=1K∑n=1N∑n′=1Nρnn′δkmnn′pnn′km⩽PT(6)∑k=1K∑n=1N∑n′=1Nρnn′δkmnn′Rkmnn′⩾Rmreq,∀m∈{1,…,Mrt}whereρ={ρnn′},δ={δkmnn′}andp={pnn′km}denote the sets of optimization variables, andρnn′andδkmnn′are indicator functions for subcarrier pair (n,n′) and the associated relay-user pair (k,m), respectively. Eqs. (3) and (4) define the subcarrier pairing constraint and the relay-user pair assignment constraint. Constraint in (5) imposes the limit on the total network transmit power, wherepnn′kmrefers to the allocated transmit power for subcarrier pair (n,n′) which is assigned to relay-user pair (k,m). Here,pnn′kmsatisfiespnn′km=pskn+pkmn′,pskn⩾0,pkmn′⩾0. Relation in (6) is the transmission rate constraint, whereRmreqis the required transmission rate of the RT traffic for user m i.e., RT user m.This optimization problem is solved in the next section. We then reformulate the problem in (2) under individual power constraints instead of total power constraint and provide its solution in Section 4. Note that, the total power constraint refers to the total network transmit power constraint, i.e., the sum transmit powers of BS and RSs as shown in the downlink relaying transmission model considered in Fig. 1. Such constraint can be used in scenarios where the BS and RSs share the same power (or, energy) pool, and it regulates the maximum overall power supplied to all transmit stations including BS and RSs. However, the individual power constraint refers to the maximum transmit power constraint for each station, and it can be applied to scenarios where the BS or each RS has separate power/energy source.Due to the use of the binary variable parameters ofρnn′andδkmnn′, the problem in (2) is a mixed integer programming problem. Its complexity isO((K·M)N!)if exhaustive search is employed, which is extremely high when N is large. Authors in [15] found that non-convex resource allocation optimization problem in multicarrier systems can be solved by using dual methods, and the duality gap is nearly zero when the number of subcarriers is sufficiently large. In this paper, we adapt the dual decomposition method in [15,23] to solve the problem in (2).First, we define D as the set of all possibleρandδsatisfying (3) and (4), respectively, and P as the set of all possible power allocation p for the given (ρ,δ) that satisfiespnn′km>0forρnn′δkmnn′=1, andpnn′km=0forρnn′δkmnn′=0. Then, the dual objective function of the primal problem of (2) can be defined as(7)g(β,μ)≜supp∈P(ρ,δ){ρ,δ}∈DL(ρ,δ,p,β,μ)with the Lagrangian(8)L(ρ,δ,p,β,μ)=∑m=1+MrtM∑k=1K∑n=1N∑n′=1NRkmnn′+βPT-∑m=1M∑k=1K∑n=1N∑n′=1Npnn′km+∑m=1Mrtμm∑k=1K∑n=1N∑n′=1NRkmnn′-Rmreqwhere β⩾0 andμ=(μ1,μ2,…,μMrt)⪰0are the dual variables. Note that g(β,μ) is the supremum of the Lagrangian, i.e., it can reach its maximum when the Lagrangian is finite; otherwise, g(β,μ)=∞ if the Lagrangian is unbounded. We assume the Lagrangian is always finite in our problem.To solve g(β,μ), the optimal value of primal variables (ρ,δ,p) should be first determined given dual variables (β,μ). Specifically, denoting (ρ∗,δ∗,p∗) as the optimal primal variables for given (β,μ), the dual function is then g(β,μ)=L(ρ∗,δ∗,p∗,β,μ).To obtain the optimal primal variables (ρ∗,δ∗,p∗) for given dual variables, we first decompose the dual function into KN2 independent functions as follows:(9)g(β,μ)=maxp∈P(ρ,δ){ρ,δ}∈D∑k=1K∑n=1N∑n′=1NLnn′,km-∑m=1MrtμmRmreq+βPTwhere(10)Lnn′,km≜∑m=1+MrtMRkmnn′-β∑m=1Mpnn′km+∑m=1MrtμmRkmnn′Then, with fixed dual variables (β,μ), we optimize the primal variables (ρ,δ,p) by solving (9) and (10).Given subcarrier pair (n,n′) assigned to relay-user pair (k,m), i.e.,ρnn′δkmnn′=1, the optimal power allocation over transmission path (s,k,m) can be determined by solving the following problem(11)maxpLnn′,km,subject top⪰0In considering the DF relaying scheme, the maximum achievable rate for a given total powerpnn′kmover path (s,k,m) can be given by [7]:(12)Rkmnn′max=12log21+γsknγkmn′γskn+γkmn′pnn′km=12log21+γnn′kmpnn′kmwhereγnn′km≜γsknγkmn′γskn+γkmn′. Note thatpskn=γkmn′γskn+γkmn′pnn′km,pkmn′=γsknγskn+γkmn′pnn′km.With this result, we can rewrite (10) as(13)Lnn′,km=∑m=1+MrtM12log2(1+γnn′kmpnn′km)-β∑m=1Mpnn′km+∑m=1Mrtμm12log21+γnn′kmpnn′kmIt can be seen thatLnn′,kmis concave with respect topnn′km. Therefore, Karush–Kuhn–Tucker (KKT) conditions [24] are satisfied. DifferentiatingLnn′,kmin (13) with respect topnn′kmand applying KKT conditions, we can obtain the optimal power allocation(pnn′km)∗as(14)pnn′km∗=μm2βln2-1γnn′km+,m∈{1,2,…,Mrt}12βln2-1γnn′km+,m∈{Mrt+1,Mrt+2,…,M}where (x)+≜max(x,0).After obtaining optimalp∗=pnn′km∗, we can start to determine optimal (ρ∗,δ∗). Substituting (14) into (13) to eliminate the power variable, we then have(15)Lnn′,km=∑m=1Mμm‾12log2μm‾γnn′km2βln2+-βμm‾2βln2-1γnn′km+whereμm‾≜μm,m∈{1,…,Mrt}1,m∈{Mrt+1,…,M}.Now, taking (ρ,δ) into consideration, we can redefine (9) as(16)g(β,μ)=max{ρ,δ}∈D∑m=1M∑k=1K∑n=1N∑n′=1Nρnn′δkmnn′Hnn′,km-∑m=1MrtμmRmreq+βPTwhereHnn′,km≜μm‾12log2μm‾γnn′km2βln2+-βμm‾2βln2-1γnn′km+, which has the same form as the inner part of (15) for a particular transmission path (s,k,m).Given subcarrier pair (n,n′), i.e., whenρnn′=1, we can determine the optimal relay-user pair usingHnn′,km. To maximize g(β,μ) for givenρand fixed (β,μ), we can maximizeHnn′,km, i.e., select the relay-user pair, as follows:(17)δkmnn′∗=1,(k,m)∗=argmax{k,m}Hnn′,km0,otherwisewhere (k,m)∗ is the optimal relay-user pair for a particular subcarrier pair (n,n′). Thus, the optimal relay-user pair assignment can be obtainedδ∗={(δkmnn′)∗}.Next, we can determine the optimal subcarrier-pairρ∗. Using (17), we can rewrite (16) as(18)g(β,μ)=max{ρ}∈D∑n=1N∑n′=1Nρnn′Hnn′-∑m=1MrtμmRmreq+βPTwhereHnn′≜Hnn′,(k,m)∗. This problem is equivalent to maximizingHnn′, which turns out to be a classic two-dimensional assignment problem and can be solved using the well-known Hungarian algorithm [25] in polynomial time of O(N3).Once optimal primal variables (ρ∗,δ∗,p∗) for given dual variables are determined, we can obtain the dual function g(β,μ), and then the standard dual optimization problem can be expressed as(19)min{β,μ}g(β,μ)subject toβ⩾0,μ⪰0.Since the problem in (19) is a convex optimization problem [24], a gradient-type search algorithm can be adopted which is guaranteed to converge to the global optimum. However, g(β,μ) is not necessarily differentiable, resulting in nonexistence of its gradient. In this case, subgradient methods or ellipsoid methods [15] can be valid candidates. Ellipsoid methods converge faster than subgradient methods, but require more computational time and memory when updating dual variables. Subgradient methods are of lower complexity and less cost than ellipsoid methods, and are amenable to distributed implementations [26]. Thus, we adopt subgradient methods in this paper.By definition, a subgradient of function g at x is a vector h satisfying the following inequality:(20)g(y)⩾g(x)+hT(y-x),∀yWith the inequality in (20), we can see that the set of subgradient of g at x is the subdifferential of g at x, i.e., h∈∂g(x). Then, with the substituted optimal primal variables (ρ∗,δ∗,p∗), a subgradient of g at some (β,μ) can be obtained as:(21)hβ=∂g∂β=PT-∑m=1M∑k=1K∑n=1N∑n′=1N(pnn′(k,m)∗)∗hμm=∂g∂um=∑k=1K∑n=1N∑n′=1NRkmnn′∗-Rmreq,m∈{1,…,Mrt}where(Rkmnn′)∗=12log21+γnn′(k,m)∗pnn′(k,m)∗∗,m∈{1,…,Mrt}.With the subgradient in (21), the dual variables (β,μ) in (19) can be updated at each iterative step using the following projected subgradient method:(22)βl+1=βl-sβlhβl+μml+1=μml-sμmlhμml+,m∈{1,…,Mrt}where{sβl,sμml}and{hβl,hμml}are the stepsizes and the subgradients at the lth iteration, respectively. (⋅)+ projects (β,μ) to the nonnegative orthant to satisfy the constraints of the dual problem in (19).To implement the above subgradient method, one important issue is to select good initial values of (β,μ). Inappropriate initial values may yield infeasible solution or unexpected oscillation in the course of iterations. One suitable choice of the initial values can be found in Proposition 1 as below:Proposition 1The dual variables (β,μ) can be initialized as(23)μm0∈(1,2),m∈{1,…,Mrt}β0=12ln2·μm0NPT+∑n=1N1(γn)MAXwhere (γn)MAX is the maximum of allγnn′kmfor given subcarrier n.Assume the dual problem in (19) is feasible, i.e., there is a dual point (β,μ) satisfying the constraints in (19) and g(β,μ)<∞, and there exists a primal-dual feasible pair (β,μ,ρ∗,δ∗,p∗). Then, at a primal-dual feasible pair, the total power constraint is satisfied. Thereby, with (14), for all active subcarrier pairs (n,n′) with each of which is assigned to its optimal relay-user pair and is allocated to some positive amount of power, we have(24)∑n=1Nμm‾2βln2-1γnn′km-PT⩽0Solving the inequality with respect to β, we obtain(25)β⩾12ln2·∑n=1Nμm‾PT+∑n=1N1γnn′km□If we start the iteration from a dual point satisfying (25), the distance between the starting point and the optimal point if exists is narrow, which facilitates convergence process. This inequality must be satisfied for the chosenγnn′kmassociating with the active subcarrier pair and the optimal relay-user pair. Since the information of the chosenγnn′kmis unknown before solving the dual problem of (19); in reality, we can relax the above inequality to its upper bound when initializing dual variable β:(26)β0⩾supγnn′km∈γ12ln2·∑n=1Nμm‾PT+∑n=1N1γnn′km=12ln2·∑n=1Nμm‾PT+∑n=1N1(γn)MAXwhereγdenotes the set of allγnn′km.Furthermore, the required transmission rateRmreqfor each RT user m must be satisfied at a primal-dual feasible pair. This implies that RT users prioritize to NRT users. Meanwhile, a user can obtain resources, including subcarrier pairs, relays and power, if and only if it is selected in the process of relay-user pairing by the rule of (17). Hence, we can setμm0>1for RT user m so as to increase its opportunity to be chosen. However, ifμm0is too large, NRT users are hardly to be chosen. Hence, we simply setμm0∈(1,2)for all RT users as a tradeoff.DenoteNm(⩽N)as the number of subcarrier pairs assigned to user m,∀m∈{1,…,M}, together withμm0∈(1,2),∀m∈{1,…,Mrt}, we have(27)∑n=1Nμm‾=∑m=1Mrt(μm0Nm)+∑m=Mrt+1M(1·Nm)⩽μm0·NThus, we can further relax the inequality (26) and set β0 with lower computational complexity as follows:(28)β0=12ln2·μm0NPT+∑n=1N1(γn)MAXAnother important issue is the selection of stepsize. There are many ways to choose the stepsize in subgradient methods. A basic one is to apply the nonsummable diminishing stepsize [26], e.g.,sl=θlwhere θ is a small enough constant, which satisfies these conditions:liml→∞sl=0,∑l=1∞sl=∞,sl⩾0. Such a stepsize rule converges to zero as l→∞, making the subgradient method converges. We use this stepsize selection approach for the updating process of all dual variables (β,μ), i.e.,sβl=sμml=sl,∀m∈{1,…,Mrt}. To make it work efficiently, θ should be selected properly, which is also the initial value of stepsize. Proposition 2 provides a method for the selection.Proposition 2The initial stepsize for the above nonsummable diminishing stepsize selection in this paper is recommended as:(29)θ=α·minβ0PT,β0PT,α∈(0,1)and it can be reset as(30)θ=α·minβl(|hβl|PT),βl·(|hβl|PT),α∈(0,1)if the power constraint is violated.Observing (14), (21) and (22), we can see that if βl=0 at the lth iteration, βl+1 turns into positive infinity; this value is then held at the ensuing iterations, yielding infeasible solution to the dual problem in (19). To avoid this from happening, βlshould be higher than zero, which is equivalent to(31)βl+1=(βl-sβlhβl)+=βl-sβlhβl>0□In inequality (31),sβl>0always holds for finite iterations. However,hβlcan be zero or negative. We discuss all the three cases ofhβlas follows.Case 1: ifhβl>0, (31) yieldssβl<βl/hβl. Since the sum allocated power at lth iteration is nonnegative, the subgradienthβlin (21) satisfieshβl⩽PT. Hence, a minimum open upper-bound ofsβlcan be obtained:βlsup(hβl)=βlPT. Because θ is suggested to be small enough but not too small, we can initialize it as:θ=α·minβ0PT,β0PT,α∈(0,1). The scaling factor α can be set to a value near 1, contributing to faster convergence compared with smaller α. Note that,β0PTcan be regarded as a minimum open upper-bound of the stepsize, which thus can be used as the upper-bound value for initializing the stepsize to ensure the stepsize is not “too small”. But,β0PTmay be not “small enough” or even very large when the PTis far less than 1. Thus, we adoptminβ0PT,β0PTinstead ofβ0PTto make the initialized stepsize small enough but not too small; where, to some extent, PTcan be interpreted as a scaling factor in the stepsize initialization to regulate the initialized value properly.Case 2: ifhβl=0, (31) yields βl+1=βl, implying that dual variable β reaches or likely approaches to its stable optimal value.Case 3: ifhβl<0, (31) yields βl+1>βl, which is an ascendent searching direction, resulting from the violation of power constraint. In this case, the stepsize should be small enough to maintain moderate variations of β, avoiding sharp oscillation. To this end, we can reset and scale θ using|hβl|as:θ=α·minβl(|hβl|PT),βl·(|hβl|PT),α∈(0,1).Sinceμmlcan be regarded as a private factor for RT user m and is affected by βlindirectly, the stepsizesμmlcan be set equal tosβlfor simplicity.Since the duality gap is not zero when N is insufficiently large, the optimal solution to the dual problem of (19) may be infeasible for the primal problem of (2). To solve this problem, we can refine the power allocation to satisfy constraints (5) and (6) using the optimal primal variables (δ∗,ρ∗) obtained in the dual problem as the active relay-user pairs and subcarrier pairs. Specifically, denoting Akmas the set of active subcarrier pairs for relay-user pair (k,m), we can convert the primal problem to the following problem:(32)maxp∑m=1+MrtM∑k=1K∑(n,n′)∈Akm12log2(1+γnn′kmpnn′km)subject to:(33)∑m=1M∑k=1K∑(n,n′)∈Akmpnn′km⩽PT(34)∑k=1K∑(n,n′)∈Akm12log2(1+γnn′kmpnn′km)⩾Rmreq,∀m∈{1,…,Mrt}Since this problem is a convex optimization problem, it can be solved using the dual method with zero duality gap [17]. Applying KKT conditions and the subgradient method described in Section 3.2, the optimal primal variablep∗ for (32) can be readily obtained. Note that, since subcarrier pairs and relay-user pairs have been determined in Sections 3.1 and 3.2, we can initialize dual variable β using the right-hand part of inequality (25) instead of the corresponding estimated value in (23).The overall procedure of the proposed resource allocation solution can be summarized as the algorithm in Algorithm 1. The algorithm is asymptotically optimal when N is sufficiently large. Due to lack of a good stopping criterion, subgradient methods are usually used in practice without any formal stopping criterion [26,27]. Hence, we terminate the iteration process when the number of iterations reaches configured preset maximum value IMAX. In this case, the worst computational complexity of the proposed algorithm is on the order of O(IMAX⋅(N2KM+N3)), where N2KM comes from the optimal relay-user pair selection for all possible subcarrier pairs and N3 comes from the Hungarian algorithm to find the optimal subcarrier-pairs. If considering simple unrefined stopping criteria, we can stop the iteration process in advance if the maximum interval of every other dual variables or dual objective function values is less than ε, i.e.,max{|βl+2-βl|,|μml+2-μml|}⩽,∀m∈{1,…,Mrt}or |gl+2−gl|⩽ε, provided that the required number of iterations is less than IMAX.Algorithm 1: Proposed iterative resource allocation algorithm under total power constraint1:Initialize: (β0,μ0) and stepsize using (23) and (29), respectively; set l=0.2: Computeγnn′kmfor each (n,n′) and (k,m) pair, respectively.3:Repeat:4:Obtain relay-user pair matrix(δkmnn′)∗using (17) with matrixγnn′kmfor each (n,n′).5:Obtain subcarrier pair matrix(ρnn′)∗using Hungarian algorithm withHnn′in (18).6:Obtain power allocation matrix(pnn′km)∗using (14) for each paired (n,n′) in subcarrier pair matrix over its associated (k,m)∗ pair.7:Reset stepsize using (30) if the power constraint is violated.8:Update (βl,μl) using (22), then (l←l+1).9:Until: (βl,μl) satisfies the stopping criterion, or l==IMAX.10:Setδ∗,ρ∗ obtained in the dual domain as the final optimal relay-user pair assignment and subcarrier pairing, respectively.11: Refine power allocation and obtain optimal power allocationp∗ by solving (32) at given (δ∗,ρ∗).In the previous section, we solved the joint optimization of relay-user pair selection, subcarrier-pairing and power allocation under the total power constraint in (5), and proposed an iterative resource allocation algorithm shown in Algorithm 1. In this section, we solve the same problem formulated in Section 2.3 except that individual power constraints are considered. The optimization problem is presented as follows:(35)max{ρ,δ,p}∑m=1+MrtM∑k=1K∑n=1N∑n′=1Nρnn′δkmnn′Rkmnn′subject to: (3), (4), (6), and,(36)∑k=1K∑n=1Nρnn′δkmnn′pskn⩽Ps(37)∑m=1M∑n′=1Nρnn′δkmnn′pkmn′⩽Pk,∀k∈{1,…,K}where Psand Pkrepresent the power limits for BS and RS k, respectively.The problem in (35) can also be solved by using the dual decomposition method; and, the solution is very similar to that in Section 3. We present the solving procedure briefly as follows.The dual objective function of the primal problem of (35) is defined as:(38)g(β,μ)≜supp∈P(ρ,δ){ρ,δ}∈DL(ρ,δ,p,β,μ)with the Lagrangian(39)L(ρ,δ,p,β,μ)=∑m=1+MrtM∑k=1K∑n=1N∑n′=1NRkmnn′+βsPs-∑k=1K∑n=1Npskn+∑k=1KβkPk-∑m=1M∑n′=1Npkmn′+∑m=1Mrtμm∑k=1K∑n=1N∑n′=1NRkmnn′-Rmreqwhereβ=(βs,β1,…,βK)⪰0 andμ=(μ1,μ2,…,μMrt)0are the dual variables. Parameters {ρ,δ,D,P} inherit the corresponding definitions to those in Sections 2.3 and 3, butpis changed to the set of {pskn,pkmn′} instead of{pnn′km}. Like in Section 3, we assume the Lagrangian here is always finite, and then g(β,μ)<∞.The dual optimization problem is then given by(40)ming(β,μ),subject toβ⪰0,μ⪰0For given dual variables, i.e., fixed (β,μ), we have(41)g(β,μ)=maxp∈P(ρ,δ){ρ,δ}∈D∑m=1M∑k=1K∑n=1N∑n′=1NLnn′,km+βsPs+∑k=1KβkPk-∑m=1MrtμmRmreqwithLnn′,km=μm‾Rkmnn′-(βspskn+βkpkmn′), whereμm‾=μm,m∈{1,…,Mrt}1,m∈{Mrt+1,…,M}.To obtain the value of g(β,μ) in (41),Lnn′,kmshould be maximized for a given transmission path (s,k,m) with subcarrier pair (n,n′), which is equivalent to solving the following problem:(42)maxLnn′,km,subject topskn⩾0,pkmn′⩾0The optimal solution to (42) is(43)pskn∗=μm‾2βs+γsknγkmn′βkln2-1γskn+pkmn′∗=γsknγkmn′pskn∗=μm‾2βk+γkmn′γsknβsln2-1γkmn′+ProofDenotingp1=pskn,p2=pkmn′,γ1=γskn,γ2=γkmn′,R=Rkmnn′,L=Lnn′,kmto facilitate presentation, we haveL=μm‾R-(βsp1+βkp2)andR=12log2(1+min{p1γ1,p2γ2}). Next, we consider two cases:Case 1: Forp1γ1⩽p2γ2, we getp2⩾γ1γ2p1,γ1>0,γ2>0. Hence, we haveL⩽μm‾R-(βsp1+βkγ1γ2p1),βs⩾0,βk⩾0, whereR=12log2(1+p1γ1). It implies that L gets its maximumLMAX={μm‾R-(βsp1+βkγ1γ2p1)}whenp2=γ1γ2p1. Then, the problem in (42) is equivalent tomaxLMAX,subject top1⩾0The solution can be obtained easily by differentiating LMAX respect to p1 and applying KKT conditions, i.e.,μm‾2ln2·γ11+p1∗γ1-βs+βkγ1γ2=0We can getp1∗=μm‾2(βs+βkγ1γ2)ln2-1γ1. Due to the constraintp1⩾0, we have the optimal valuep1∗=μm‾2(βs+βkγ1γ2)ln2-1γ1+, and thenp2∗=γ1γ2p1∗. Thus, the optimal solution in (43) follows.Case 2: For p1γ1>p2γ2, we haveR=12log2(1+p2γ2)andL⩽μm‾R-(βkp2+βsγ2γ1p2). Using the method in Case 1, we can get the same results forp2∗andp1∗.□With the results in (43), the optimal power allocationp∗={(pskn)∗,(pkmn′)∗}is obtained. Also, we can obtain the optimalLnn′,kmassociated with a given path as(44)(Lnn′,km)∗=μm‾2log2μm‾γskn2Bln2+-μm‾2ln2-Bγskn+whereB=βs+γsknγkmn′βk.After attaining the optimalLnn′,kmfor each possible given path, we can determine the optimal relay-user pair for a given subcarrier pair (n,n′) as(45)(δkmnn′)∗=1,(k,m)∗=argmax{k,m}Hnn′,km0,otherwisewhereHnn′,km=(Lnn′,km)∗, and (k,m)∗ is the optimal relay-user pair for a given (n,n′). Thus, we have the optimal relay-user pairδ∗={(δkmnn′)∗}.Then, by maximizingHnn′(=Hnn′,(k,m)∗), which can be solved by using the Hungarian algorithm, we can get the optimal subcarrier-pairρ∗.With (ρ∗,δ∗,p∗), the value of g(β,μ) in (41) can be obtained finally. Then, the dual optimization problem in (40) can be solved by updating dual variables (β,μ) using the subgradient method like that in Section 3.2, with a subgradient as(46)hβs=∂g∂βs=Ps-∑k=1K∑n=1Npskn∗hβk=∂g∂βk=Pk-∑m=1M∑n′=1Npkmn′∗hμm=∂g∂um=∑k=1K∑n=1N∑n′=1NRkmnn′∗-Rmreq,m∈{1,…,Mrt}We then perform the power allocation refinement and get the final solution to (35), with the overall procedure similar to Algorithm 1.

@&#CONCLUSIONS@&#
