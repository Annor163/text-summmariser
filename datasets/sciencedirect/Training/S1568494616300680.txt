@&#MAIN-TITLE@&#
A new algorithm for identity verification based on the analysis of a handwritten dynamic signature

@&#HIGHLIGHTS@&#
We propose a new algorithm for the dynamic signature verification.The algorithm implements a new way of signatures division – hybrid partitioning.Hybrid partitions are associated with time and dynamics of the signing process.The algorithm compares test signatures to the reference ones in interpretable way.The algorithm works independently for each signer.

@&#KEYPHRASES@&#
On-line signature,Dynamic signature,Identity verification,Computational intelligence,Fuzzy system,Interpretability,

@&#ABSTRACT@&#
Identity verification based on authenticity assessment of a handwritten signature is an important issue in biometrics. There are many effective methods for signature verification taking into account dynamics of a signing process. Methods based on partitioning take a very important place among them. In this paper we propose a new approach to signature partitioning. Its most important feature is the possibility of selecting and processing of hybrid partitions in order to increase a precision of the test signature analysis. Partitions are formed by a combination of vertical and horizontal sections of the signature. Vertical sections correspond to the initial, middle, and final time moments of the signing process. In turn, horizontal sections correspond to the signature areas associated with high and low pen velocity and high and low pen pressure on the surface of a graphics tablet. Our previous research on vertical and horizontal sections of the dynamic signature (created independently) led us to develop the algorithm presented in this paper. Selection of sections, among others, allows us to define the stability of the signing process in the partitions, promoting signature areas of greater stability (and vice versa). In the test of the proposed method two databases were used: public MCYT-100 and paid BioSecure.

@&#INTRODUCTION@&#
Security of IT systems is related to, among others, effective identity verification of system users. This verification may be performed using various methods based on: (a) something you have (e.g. chip card), (b) something you know (e.g. password), (c) something you are (e.g. biometric features). The third approach is the most convenient for people whose identity is verified and the most difficult to forge for potential forgers. Therefore, it is very interesting and it creates possibilities for the development of new solutions. The biometric features used in this approach are divided into two categories: (a) physiological – related to the construction of the human body (e.g. fingerprint, iris, hand geometry, face) and (b) behavioural – related to the human behaviour (e.g. signature, gait, keystrokes). A handwritten signature occupies a special place among behavioural characteristics, its acquisition is not controversial and it is commonly socially acceptable.In the literature there are two main approaches to signature analysis. The first one uses so-called static (off-line) signature and it is based on an analysis of geometric features of the signature, such as shape and size ratios, etc. (see e.g. [1–6]). The other approach is based on an analysis of the dynamics of signing process and it uses so-called dynamic (on-line) signature. Some authors have also presented a methods based on both these approaches (see [7,8]). The most commonly used signals, which are the basis of the dynamic signature analysis, are pen pressure on the tablet surface and pen velocity. Velocity signal is determined indirectly on the basis of pen position signals on the tablet surface. The dynamic signature verification is much more effective than the static one because: (a) dynamics of signing is a very individual characteristic feature of the signer, (b) it is difficult to forge, (c) waveforms describing the dynamics of the signature (even if you have them) are difficult to translate into the process of signing, but they are relatively easy to analyse. It should also be emphasized that the algorithms for the analysis of the dynamic signature can be relatively easily used in other areas of application in the field of biometrics, which are based on the analysis of dynamic behaviour (see e.g. [9,10]).In the literature there are four main approaches to the dynamic signature analysis: (a) global feature-based approach (see e.g. [11–15]), (b) function-based approach (see e.g. [16–21]), (c) regional approach (see e.g. [22–29]) and (d) hybrid approach (see e.g. [30–32]). Among these approaches to the dynamic signature analysis, the methods based on signature regions are very interesting and effective. In the literature in this field one can find, among others, new methods of selection of the signature regions characteristic of the signer, new ways of interpretation of these signature regions and new ways of signature classification based on selected regions. Many authors use Hidden Markov Models (see e.g. [25]). Other authors propose ways of classification adapted to their methods. In [26] signatures are segmented into strokes and for each of them the reliability measure is computed on the basis of the feature values which belong to the current stroke. In [27] a stroke-based algorithm that splits velocity signal into three bands has been proposed. This approach assumes that low and high-velocity bands of the signal are unstable, whereas the medium-velocity band is useable for discrimination purposes. A more detailed review of the literature on the dynamic signature verification has been presented in our previous papers (see e.g. [22,23]).Our experience with different methods for the dynamic signature verification based on the regional approach induced us to prepare the method presented in this paper. In [23] we propose a method which determines the importance of each time moment of signing process individually for each signer. The method takes into account stability of signing in the considered time moments. The stability is determined using reference signatures. In our other paper i.e. [22] we propose a method, which allows one to select some typical areas in the signature of the user, created as a result of an analysis of pen velocity and pen pressure signals. These areas are associated with high and low pressure and high and low velocity. The proposed methods work with high accuracy and they also have several other important advantages (determination of weights of areas, taking into account all the regions and their weights in the signature verification, signature classification based on the fuzzy classifier), so we have decided to develop a new method that would be a combination of those two methods. Initial attempts to introduce this method are outlined in [33]. However, the algorithm presented in the mentioned paper required an iterative determination of the so-called border of inclusion of reference signatures. In this paper we managed to eliminate this procedure and thus greatly simplify evaluation of the similarity of test signatures to their reference signatures. Thanks to this fact, the system to evaluate the similarity of test signatures to their reference signatures is a full one-class classifier. Moreover, interpretation of the partitions selected by the method described in [33] is different from the interpretation in the algorithm proposed in this paper and the partition analysis in the mentioned method is less precise. Different interpretation of the partitions resulted in the need to change the work of the algorithm in every step. Thus, the algorithm for signature verification proposed in this paper is a new one, which has not been presented in the literature so far.The following features (see Table 1) distinguish the proposed method from the others:-It uses fuzzy sets and fuzzy systems theory in evaluation of the similarity of test signatures to their reference signatures. Character of such similarity is not precise and it is difficult to describe it using the classical theory of sets and two-valued logic. In the proposed method we used “high similarity” and “low similarity” fuzzy sets to describe similarity values (see [36]). Next, we formulated fuzzy rules and we used approximate inference. Thanks to this we obtained a complete fuzzy system used in the phase of the test signature verification. In the rules description the system takes into account the weights of importance of selected partitions.It allows to interpret the knowledge accumulated in the system used for signature verification. These possibilities result from the fact that: (a) The construction of the fuzzy rules takes into account interpretability criteria of the clear fuzzy rules described in the literature (e.g. in [37]). (b) For all signers we used consistent structure of the fuzzy classifier, in which only the values of the rules’ parameters change, but the reasoning scheme remains unchanged. (c) Input and output signals of the fuzzy classifier and the parameters of its rules have a specific interpretation, referring to the similarity of test signatures to their reference signatures. Thanks to this, the parameters (i.e. the parameters of membership functions and importance weights of the rules) can be determined analytically and the system does not require a learning process.It selects partitions of the signature which have the following interpretation: high and low velocity in the initial, middle and final time moments of signing, high and low pressure in the initial, middle and final time moments of signing.It determines values of weights of importance for each partition. Weights values are proportional to the stability of reference signatures in the partitions. Thanks to this, the proposed method uses all partitions in the evaluation of signature similarity (with varying intensity).It bases on four types of signals: a shape signal of the trajectory x, a shape signal of the trajectory y, a pressure signal of the pen z and a velocity signal of the penv. They are available as a standard for graphics tablets: the first three of them are acquired directly from the graphics tablet and the velocity is the first derivative of a signature trajectory. Various types of tablets may have different sampling frequency, so in this case acquired signals are subject to the standard normalization procedure. In addition, the signatures should be pre-processed using other standard methods to match their length, rotation, scale and offset.It allows to flexibly adjust a set of signals describing the dynamics of the signature to specific areas of application and hardware capabilities. There are two most common variants of the method. The first assumes that a graphics tablet is used in the training phase and in the verification phase. In this case the precision of the proposed method is the highest, because the signals describing not only the shape of the signature, but also its dynamics, are used in both phases. The second variant assumes that in the training phase the graphics tablet is available and in the verification phase we have a stand-alone (not connected to the computer) device with a touch screen (e.g. a smartphone, a tablet, etc.), from which it is impossible to obtain information about the pen pressure. In this case, the partitions are determined in the training phase on the basis of velocity and pressure. Verification phase takes into account only the shape of the signature. In the description of the method we took into account the second variant, assuming that in the signature verification phase the signals describing the dynamics of the signature may not be available. Obviously, in practice there may be also indirect modes of action (e.g. based on the generation of velocity trajectories in the training phase without knowing the pressure trajectory or using the angle of the pen to the tablet surface during the signing process), but the proposed method can be adapted to each of them.In summary, the proposed new algorithm for identity verification based on the analysis of a handwritten dynamic signature is mainly characterized by new definition of the dynamic signature features (so-called hybrid partitions of the dynamic signature), new way of their processing and use of authorial one-class neuro-fuzzy classifier, whose structure is determined individually for each user without using forged signatures. Due to the above-mentioned mechanisms, the proposed algorithm works very precisely and individually for each user.To test the proposed method we used two databases of the signatures: public MCYT-100 (see [38]) distributed by the Biometric Recognition Group – ATVS (see [39]) and paid BioSecure (BMDB) distributed by the BioSecure Association (see [40]).This paper is organized into 4 sections. Section 2 contains a detailed description of the algorithm. The simulation results are presented in Section 3. The conclusions are drawn in Section 4.The proposed algorithm for the dynamic signature verification based on hybrid partitioning works in two phases (see Fig. 1): the training phase (Section 2.1) and the test phase (Section 2.2). In both of them a procedure of signature normalization is performed (see Fig. 2). In this procedure for each user the most typical reference signature, called base signature, is selected. It is one of the reference signatures collected in the acquisition phase, for which the distance to the other reference signatures is the smallest. The distance is calculated according to the adopted distance measure (e.g. Euclidean). Training or test signatures are matched to the base signature using the Dynamic Time Warping algorithm (see e.g. [41–43]), which operates on the basis of matching velocity and pressure signals. The result of matching the two signatures is a map of their corresponding points. On the basis of the map, trajectories of the signatures are matched. Matching by way of using DTW could not be done directly with the use of trajectories, because this would remove the differences between the shapes of the signatures. It would have a very negative impact on training. Elimination of differences in rotation of the signatures is performed by the PCA algorithm which in the literature is commonly used to make image rotation invariant (see e.g. [44]). The scale and offset are compensated by standard geometric transformations. Various normalization techniques are described in detail in the literature, so their description will not be included in this paper (see e.g. [17,34,45,46]).At the beginning of the training phase partitioning of the reference signatures of each user is realized (Section 2.1.1). Partitions are hybrid because they are created from a combination of vertical and horizontal sections. Vertical sections are time intervals indicating the initial, middle and final phase of signing. Horizontal sections are created in each vertical section. In this process signals describing the dynamics of a signature are taken into account. If the velocity signal is partitioned as first (order of signal processing is arbitrary), then in each time interval the average value of the velocity is determined (averaging discrete values of the velocity). Next, in each time interval two partitions are created: (a) the one associated with the velocity lower than the average and (b) the other one associated with the velocity higher than the average. The procedure is analogous for the second available signal – pen pressure. As a result, the following partitions are created: high and low velocity at the initial, middle and final moment of signing, high and low pen pressure on the graphics tablet surface at the initial, middle and final moment of signing. The number of time moments which affects the number of partitions is a parameter of the algorithm, which may be greater than or equal to 1. Each partition is physically a subset of points of the trajectory x or y, which describes the shape of a signature. After creation of the partitions, determination of the templates of the reference signatures is performed. Each template is associated with a separate partition (Section 2.1.2). With the reference signature templates, the values of partition importance weights can be determined (Section 2.1.3). For example, the weight of importance of the first partition depends on the similarity of the points of the reference signatures from the first partition to the corresponding components of the first template. This similarity is dependent on the value of the Euclidean distance. Higher value of the partition importance weight means that a specified part of the reference signatures associated with this partition was created in a more stable way (with similar value of the velocity or the pressure). Moreover, a greater value of the weight means that in the test phase fragments of the test signatures associated with this partition will be more important in evaluation of the similarity of the test signature to the reference signatures. After creation of the partitions of the reference base signature, creation of the reference signatures templates and calculation of the weights of importance, parameters of the flexible fuzzy one-class classifier are determined in the learning phase (Section 2.1.3). The classifier is used in the test phase to evaluate the similarity of the test signature to the reference signatures. Obviously, partitions of the base signature, the templates of the reference signatures, the weights of importance and the parameters of the classifier are determined individually for each user and they must be stored in a database.Each reference signature j (j=1, 2, …, J, where J is the number of reference signatures) of the user i (i=1, 2, …, I, where I is the number of users) is represented by the following signals:-Signals describing the shape of a signature. Signalxi,j=xi,j,k=1,xi,j,k=2,…,xi,j,k=Kidescribes the movement of the pen in the two-dimensional space along the x axis, where Kiis the number of signal samples. The number of samples Kiresults from the sampling frequency of the graphics tablet and performance of the DTW algorithm in the normalization phase. Thanks to the signature normalization, all trajectories describing the signatures of the user i have the same number of samples Ki. Movement of the pen along the y axis can be described in a similar way:yi,j=yi,j,k=1,yi,j,k=2,…,yi,j,k=Ki. In order to simplify the description of the algorithm we used the same symbolai,j=ai,j,k=1,ai,j,k=2,…,ai,j,k=Kito describe both shape trajectories, wherea∈x,y.Signals describing the dynamics of a signature. Signalvi,j=vi,j,k=1,vi,j,k=2,…,vi,j,k=Kidescribes velocity of the pen and trajectoryzi,j=zi,j,k=1,zi,j,k=2,…,zi,j,k=Kidescribes the pen pressure on the surface of the graphics tablet. In order to simplify the description of the algorithm we used the same symbolsi,j=si,j,k=1,si,j,k=2,…,si,j,k=Kito describe both dynamics signals, wheres∈v,z.The purpose of the partitioning is to assign each point of the signal vi,jBaseand the signal zi,jBaseof the reference base signature to a single hybrid partition, resulting from a combination of the vertical and the horizontal section, wherejBase∈1,…,Jis an index of the base signature. As already mentioned, the base signature is taken into account during partitioning as the most typical reference signature of the user i. Therefore, it is selected from a set of reference signatures and it is not generated by averaging or grouping signals describing reference signatures.The idea of partitioning is shown in Fig. 3. At the beginning of the partitioning, the vertical sections of the signals vi,jBaseand zi,jBaseare created. Each of them represents a different time moment of signing: (a) initial or final for the case P{s}=2, (b) initial, middle or final for the case P{s}=3, (c) initial, first middle, second middle or final for the case P{s}=4. The vertical sections are indicated by the elements of the vectorpvis=pvi,k=1s,pvi,k=2s,…,pvi,k=Kisdetermined as follows:(1)pvi,ks=1for0<k≤KiP{s}2forKiP{s}<k≤2KiP{s}⋮P{s}for(P{s}−1)KiP{s}<k≤Ki,wheres∈v,zis the signal type used for determination of the partition (velocityvor pressure z), i is the user index (i=1, 2, …, I), j is the reference signature index (j=1, 2, …, J), Kiis the number of samples of normalized signals of the user i (divisible by P{s}), k is an index of the signal sample (k=1, 2, …, Ki) and P{s} is the number of the vertical sections (P{s}≪KiandPs=Pv=Pz). A number of the vertical sections can be arbitrary, but its increase does not increase interpretability and accuracy of the method (see Section 3).After creation of the vertical sections of the signals vi,jBaseand zi,jBase, horizontal sections are created. Each of them represents high and low velocity and high and low pressure in individual moments of signing. Horizontal sections indicated by the elements of the vectorphis=phi,k=1s,phi,k=2s,…,phi,k=Kisare determined as follows:(2)phi,ks=1forsi,j=jBase,k<avgvi,p=pvi,kss2forsi,j=jBase,k≥avgvi,p=pvi,kss,where jBase is the base signature index,avgvi,psis an average velocity (whens=v) or an average pressure (when s=z) in the section indicated by the index p of the base signature jBase:(3)avgvi,ps=1Kvi,p∑k=p−1·KiP{s}+1k=p·KiP{s}si,j=jBase,k,whereKvi,pis the number of samples in the vertical section p, si,j=jBase,kis the sample k of the signals∈v,zdescribing dynamics of the signature.As a result of partitioning, each samplevi,jBase,kof the signal vi,jBaseof the base signature jBase and each sample zi,jBase,kof the signal zi,jBaseof the base signature jBase is assigned to the vertical section (assignment information is stored in the vectorpvis) and horizontal section (assignment information is stored in the vectorphis). The intersection of the sections forms the partition. Fragments of the shape trajectories xi,jand yi,j, created by taking into accountpvisandphis, will be denoted asai,j,p,r{s}=ai,j,p,r,k=1{s},ai,j,p,r,k=2{s},…,ai,j,p,r,k=Kci,p,rs,a{s}. The number of samples belonging to the partitionp,r(created as an intersection of the vertical section p and the horizontal section r, included in the trajectoryai,j,p,r{s}) of the user i associated with the signal a (x or y) and created on the basis of the signal s (velocity or pressure) will be denoted asKci,p,rs,a. It should be noticed that∑p=1Ps∑r=1RsKci,p,rs,a=Kifora∈x,yands∈v,z. The number of partitions of the base signature of the user i is equal toPv·Pz·4. The partitions are used to determine the reference signature templates.The following parameters are considered when determining reference signature templates: (a) all J reference signatures of the user i, (b) two shape trajectories of the reference signatures, i.e. xi,jand yi,jand (c) partitions created for the reference base signature, resulting from the intersection of the vertical sections (indicated bypvis) and horizontal sections (indicated byphis) (Fig. 4). The templates of the signatures are averaged fragments of the reference signatures represented by the shape trajectories xi,jor yi,j. The number of the templates created for the user i is equal to the number of the partitions. Each templatetci,p,rs,a=tci,p,r,k=1s,a,tci,p,r,k=2s,a,...,tci,p,r,k=Kci,p,rs,as,adescribes fragments of the reference signatures in the partitionp,rof the user i, associated with the signal a (x or y), created on the basis of the signal s (velocity or pressure), where:(4)tci,p,r,ks,a=1J∑j=1Jai,j,p,r,k{s}.After determination of the templatestci,p,rs,a, parameters of the fuzzy system for evaluating the similarity of the test signatures to the reference signatures are determined.The test signature verification is based on the answers of the fuzzy system for evaluating the similarity of the test signatures to the reference signatures. Parameters of the system must be selected individually for each user from the database. Moreover, the algorithm for signature verification should: (a) work independently of the number of users (its accuracy should not depend on the number of users in the database), (b) have the ability to easily add the signatures of new users, (c) not take into account signatures of other users in the training and verification phase of the signature. This limits the use of known methods e.g. from the field of non-linear classification and machine learning (evolutionary or gradient). In this paper we propose a new structure of the flexible neuro-fuzzy one-class classifier, whose parameters depend on the reference signature descriptors. They are determined analytically (not in the process of supervised learning) and individually for the user (his/her reference signatures).The first group of parameters of the proposed system are the parameters describing differences between the reference signatures and the templates in the partitions. They are used in the construction of fuzzy rules described later (see (9)) and determined as follows:(5)dmaxi,p,rs,a=δiJ·Kci,p,rs,a∑k=1Kci,p,rs,a∑j=1Jai,j,p,r,k{s}−tci,p,r,k{s,a},δiis a parameter which ensures matching of tolerance of the system for evaluating similarity in the test phase (it is assumed that the test signatures can be created in less comfortable conditions than the reference signatures, thus δi≥1). Thus, values of the parameters describing differences between the reference signatures and the templates in the partitions of the user i take into account the average similarity of the reference signature shape to the templates in the partitions.The second group of parameters of the proposed system are weights of the partitions. They are used for evaluation of the similarity of the test signatures to the templates of the reference signatures of the user i. A high value of the weight means a small dispersion of the shape signal values from the templatetci,p,rs,afor the reference signatures of the user i. A consequence of the high value of the partition weight is lower tolerance of the system for similarity evaluation in the test phase.Determination of the weightswi,p,rs,astarts from determination of a dispersion of the reference signatures signals. The dispersion is represented by a standard deviation. Average standard deviation for all samples in the partition is determined as follows:(6)σ¯i,p,rs,a=1Kci,p,rs,a∑k=1Kci,p,rs,a1J∑j=1Jai,j,p,r,k{s}−tci,p,r,k{s,a}2.With the average standard deviationσ¯i,p,rs,a, normalized values of the partition weights are determined:(7)wi,p,rs,a=1−σ¯i,p,rs,amaxp=1,2,…,Psr=1,2σ¯i,p,rs,a.Normalization of the weights adapts them for use in the one-class flexible fuzzy system used for evaluation of the similarity of the test signatures to the reference signatures. This evaluation is the basis for recognition of signature authenticity.At the beginning of the test phase (Fig. 1) the user: (a) creates one signature, which will be verified and (b) claims to be a specific user from the database. Then parameters of the considered user, stored earlier in the database, are downloaded and the signature verification is performed. The list of the parameters is as follows: (a) trajectories of the base signature xi,jBase, yi,jBase, vi,jBaseand zi,jBase, (b) vectors of allocation to the sectionspvisandphis, (c) templates of the reference signaturestci,p,rs,a, (d) weights of the partitionswi,p,rs,a(p=1,2,…,Ps, r=1, 2) and (e) the parameters describing differences between the reference signatures and the templates in the partitionsdmaxi,p,rs,a.The first step of the verification phase is acquisition of the test signature. This signature is pre-matched to the reference base signature, represented by the trajectories xi,jBase, yi,jBaseand the signals vi,jBase, zi,jBase. This is done analogously as in the case of the reference signatures in the training phase (Fig. 2). Normalized test signature is represented by two shape trajectories:xtsti=xtsti,k=1,xtsti,k=2,…,xtsti,k=Kiandytsti=ytsti,k=1,ytsti,k=2,…,ytsti,k=Ki. Their structure is analogous to the shape trajectories xi,jand yi,jof the reference signatures used in the training phase, but they do not have the index j pointing to the signature.The second step of the verification phase is partitioning of the test signature. As a result of partitioning of the shape trajectories xtstiand ytstitheir fragments denoted asatsti,p,r{s}=ai,p,r,k=1{s},ai,p,r,k=2{s},…,ai,p,r,k=Kci,p,rs,a{s}are obtained. During the partitioning the vectorspvisandphisare used. They are determined in the training phase and their signals indicate sections, in which signals of the vectors xtstiand ytstishould be placed. It was carried out in a similar way in the training phase.The third step of the verification phase (realized after partitioning) is determination of the similarity of fragments of the test signature shape trajectoriesatsti,p,r{s}to the templates of the reference signaturestci,p,rs,ain the partitionp,rof the user i associated with the signal a (x or y) created on the basis of the signal s (velocity or pressure). It is determined as follows:(8)dtsti,p,rs,a=1Kci,p,rs,a∑k=1Kci,p,rs,aatsti,p,r,k{s}−tci,p,r,k{s,a}.After determination of the similaritiesdtsti,p,rs,a, total similarity of the test signature to the reference signatures of the user i is determined. A decision on the authenticity of the test signature is taken on the basis of this similarity. The structure of the system for evaluation of the overall similarity is described in Section 2.2.1, evaluation of the signature reliability is described in Section 2.2.2 and interpretability aspects of the system rules are presented in Section 2.2.3.The system evaluating similarity of the test signature to the reference signatures works on the basis of the signalsdtsti,p,rs,aand takes into account the weightswi,p,rs,a. Its response is the basis for the evaluation of the signature reliability. The proposed system works on the basis of two fuzzy rules presented as follows:(9)R1:IFdtsti,1,1v,xisAi,1,11v,xwithwi,1,1v,xAND……ANDdtsti,Pz,2z,yisAi,Pz,21z,ywithwi,Pz,2z,yTHENyiisB1R2:IFdtsti,1,1v,xisAi,1,12v,xwithwi,1,1v,xAND……ANDdtsti,Pz,2z,yisAi,Pz,22z,ywithwi,Pz,2z,yTHENyiisB2,where-dtsti,p,rs,a(i=1, 2, …, I,p=1,2,…,Ps, r=1, 2,s∈v,z,a∈x,y) are input linguistic variables describing similarity of the shape trajectories’ fragmentsatsti,p,r{s}of the test signature to the templates of the reference signaturestci,p,rs,a. “High” and “low” values taken by these variables are Gaussian fuzzy setsAi,p,r1v,x,Ai,p,r2v,x(see Fig. 5) described by the following membership functions:(10)μAx=exp−1x−aσ2,where a is the centre of the Gaussian function and σ is its width (see e.g. [47]). In the used system the value of the parameter a for the ruleR1from the rule base (9) is equal to 0 and for the ruleR2is equal to the value of the border of inclusion of the reference signaturesdmaxi,p,rs,acalculated by the formula (5). The value of the parameter σ for both rules from the rule base (9) is determined as follows:(11)σ=dmaxi,p,rs,alogμmin,where μmin>0 is a small positive number resulting from the intersection of the Gaussian function (10) with a straight line, described by the equationμx=μmin, at the pointdmaxi,p,rs,a,μmin. This approach results from the specificity of the Gaussian function, which tends asymptotically to the value 0 (this is the case, in which μmin=0) but never reaches it. Moreover, it is worth noting that the specific approach to the fuzzification block of the system, and in particular the use of the singleton type fuzzification (see e.g. [47]), allowed us to simplify the rules notation (9). The simplification involves replacing the names of linguistic variables by the names of the signals determined using the formula (8).yi(i=1, …, I) is output linguistic variable meaning “similarity of the test signature to the reference signatures of the user i”. “High” value of this variable is the fuzzy set B1 of γ type (see Fig. 5), described by the following membership function (see e.g. [47]):(12)μB1x=0forx≤ax−ab−afora<x≤b1forx>b.“Low” value is the fuzzy set B2 of L type (see Fig. 5) described by the following membership function (see e.g. [47]):(13)μB2x=1forx≤ab−xb−afora<x≤b0forx>b.In our system value of the parameter a for both rules from the rule base (9) is equal to 0 and value of the parameter b is equal to 1.wi,p,rs,aare weights of the partition associated with the templatetci,p,rs,aof the user i, calculated by the formula (7). Introduction of the weights of importance distinguishes the proposed flexible neuro-fuzzy system from typical fuzzy systems.In the proposed method the test signature is recognized as belonging to the user i (genuine) if the assumptiony¯i>cthiis satisfied, wherey¯iis the value of the output signal of neuro-fuzzy system described by the (9):(14)y¯i≈T*μAi,1,11v,xdtsti,1,1v,x,…,μAi,Pz,21z,ydtsti,Pz,2z,y;wi,1,1v,x,…,wi,Pz,2z,yT*μAi,1,11v,xdtsti,1,1v,x,…,μAi,Pz,21z,ydtsti,Pz,2z,y;wi,1,1v,x,…,wi,Pz,2z,y+T*μAi,1,12v,xdtsti,1,1v,x,…,μAi,Pz,22z,ydtsti,Pz,2z,y;wi,1,1v,x,…,wi,Pz,2z,y,where-T*·is the weighted t-norm (see [47]) in the form:(15)T*a1,a2;w1,w2=T1−w1·1−a1,1−w2·1−a2=e.g.1−w1·1−a1·1−w2·1−a2,where t-normT·is a generalization of the usual two-valued logical conjunction (studied in classical logic),w1andw2∈0,1mean weights of importance of the argumentsa1,a2∈0,1. Please note thatT*a1,a2;1,1=Ta1,a2andT*a1,a2;1,0=a1.cthi∈0,1- coefficient determined experimentally for each user to eliminate disproportion between FAR and FRR error (see e.g. [48]). The values of this coefficient are usually close to 0.5.The formula (14) was established by taking into account the following simplification resulting from the spacing of the fuzzy sets shown in Fig. 5:(16)μB10=0,μB11=1μB20=1,μB21=0.Detailed information about the system described by the rules (9), which allow us to easily derive the relationship (14) on the basis of the assumption (16), can be found e.g. in [49–54]. It is worth noting that description of the considered neuro-fuzzy system given in this paper is sufficient for its implementation. In our previous papers we have dealt in detail with its derivation (it is known in the literature as flexible neuro-fuzzy system of the Mamdani type), gradient and evolutionary learning and applications. The novelty of the algorithm proposed in this paper is a new way of using the system for (a) assessment of the overall similarity of the test signature to the reference signatures and (b) verification of the test signatures. This method does not require a learning step. It allows for a specific interpretation of each parameter of the system and it takes into account the specificity of a considered problem of the dynamic signature verification.In the literature one can find the conditions for the readability of the fuzzy systems rules. For example, in [37] 4 levels of interpretability are shown: Q1: complexity at the rule base level (it takes into account number of rules and number of conditions), Q2: complexity at the level of fuzzy partitions (it takes into account number of membership functions, number of features or variables), Q3: semantics at the rule base level (it takes into account rules fired at the same time), Q4: semantics at the fuzzy partition level (it takes into account completeness or coverage, normalization, distinguishes ability and complementarity). It should be emphasized that the rules of the form (9) meet all the defined levels.Moreover, it is worth noting that in the proposed method: (a) all parameters of the rules are determined analytically and they have a specific interpretation, (b) all rules have the same form for all users, but they differ in the values of the parameters.Aspects of interpretability used in the method are based on our previous experience with interpretability of rule-based systems (see e.g. [51,55]).Simulations were performed using authorial test environment written in C# for two dynamic signature databases:-MCYT-100 database. MCYT-100 database contains signatures of 100 users, acquired using a digitizing tablet. The set of each user contains 25 genuine signatures from one signature contributor and 25 skilled forgeries from five other contributors.BioSecure database. Simulations were performed using commercial DS2 Signature database which contains signatures of 210 users. The signatures were acquired in two sessions using a digitizing tablet. Each session contains 15 genuine signatures and 10 skilled forgeries per person.In Section 3.1 the course of the simulation is described in detail. In Section 3.2 tables and figures with the results of the simulation are published. In Section 3.3 computational complexity of the proposed algorithm is described. In Section 3.4 conclusions from the simulations are presented.For each user from the MCYT-100 and BioSecure databases we repeated 5 times the training phase and the test phase, according to the block diagram shown in Fig. 1. The results obtained for all users have been averaged. In each of the five performed repetitions we used a different set of training signatures. The described method is commonly used in evaluating the effectiveness of the methods for the dynamic signature verification, which corresponds to the standard crossvalidation procedure. The method of selection of the reference and test signatures for each user was as follows:-During the training phase we used 5 randomly selected genuine signatures of each signer. These signatures were used to perform the partitioning, determination of the templates and calculation of the parameters of the system for evaluating the test signatures similarity to the reference signatures.During the test phase we used 15 genuine signatures and 15 forged signatures for the MCYT-100 database. For the BioSecure database we used 10 remaining genuine signatures and all 10 forged signatures.The results of the simulations are presented as follows:-Values of the errors FAR (False Acceptance Rate) and FRR (False Rejection Rate) for the database MCYT-100 are presented in Table 2and for the BioSecure database are presented in Table 4. These errors are used in the literature to evaluate the effectiveness of biometric methods. They have been designated for a different number of partitions. Other (less popular) effectiveness measures of biometric methods may also be used (e.g. the ones described in [56]), but in this case it would be difficult to compare the obtained results with the results of other authors.Comparison of the accuracy of different methods for the signature verification for the MCYT-100 database is presented in Table 3and for the BioSecure database is presented in Table 5. It is also noteworthy that Table 1 presents main characteristics of the algorithms for the on-line signature verification based on the regional approach.Weights of importance of the partitions for the MCYT-100 database are presented in Fig. 6and weights of importance of the partitions for the BioSecure database are presented in Fig. 7. Each weight value is the average value of the weights of all users, determined as follows:(17)w¯p,rs,a=∑i=1Iwi,p,rs,a.The proposed algorithm does not require high computational complexity (Table 6), because it does not require machine learning and does not use any iterative procedures. The methods proposed in our previous papers (see e.g. [22,23]) also do not require high computational complexity but they contain an iterative procedure for the purpose of selecting the so-called border of inclusion of the reference signatures. Elimination of this procedure from the proposed algorithm required a change in the approach to the evaluation of the test signature similarity to the reference signatures.Low complexity of our algorithm is very important in the verification of the test signature genuineness. It enables the system to immediately take into account the signatures of new users.It has been achieved by eliminating the machine learning, which usually requires anti-patterns (in the signature verification they are descriptors of false signatures, represented by e.g. genuine signatures of other users). Moreover, in this case a greater number of users in the database causes a greater variety of signatures, which provides better learning results. This is a consequence of a more representative learning sequence. In the proposed algorithm the number of users in a database is not relevant.The proposed algorithm can be evaluated as follows:-For both considered databases it received the highest accuracy in the case of division of the signature into two partitions associated with time moments of signing (initial and final) (see Tables 2 and 4). By analysing the results presented in Tables 2 and 4 it can also be seen that the accuracy of the proposed algorithm does not result from increasing the number of sections.It allowed to select the partitions of the signature in which the reference signatures have been created in the most stable way. These partitions had the highest weight value and the lowest value of the parameters describing differences between the reference signatures and the templates in the partitions. It is associated with the lowest tolerance in evaluation of similarity of the test signatures to the reference signatures. For the MCYT-100 database it was the partition associated with the shape trajectory x, the initial time moment of signing and the high value of velocity (see Fig. 6). In turn, for the BioSecure database it was the partition associated with the shape trajectory x, the initial time moment of signing and the low velocity value (see Fig. 7). Different results for the two test databases confirm the validity of the proposed algorithm, which adapts its operation to the specificity of the reference signatures, individually for each user.For the MCYT-100 database our algorithm promoted partitions associated with the shape trajectory x, because they had higher weight values (see Fig. 6). This shows that for the MCYT-100 database the horizontal movement of the pen was more characteristic during the creation of the reference signatures. In the case of the BioSecure database the algorithm promoted partitions associated with the shape trajectory x for the signalvand the partitions associated with both shape trajectories (x and y) for the signal z (see Fig. 7). This shows that for the BioSecure database the most characteristic for the users are combinations of (a) the horizontal movement of the pen and the velocity signal value and (b) the vertical movement of the pen and both signals value.For both considered databases it promoted partitions associated with the velocity signal, because they had higher weights values (see Figs. 6 and 7). It shows that the most characteristic signal describing dynamics of the reference signatures was the velocity signal.For both considered databases the algorithm worked with good accuracy in comparison to other methods for the dynamic signature verification (see Tables 3 and 5). Taking into account the additional benefits of the algorithm presented in Table 1, it can be said that it is an interesting method for the dynamic signature verification.

@&#CONCLUSIONS@&#
In this paper we proposed the new algorithm for the dynamic signature verification using partitioning. The algorithm uses signals available as a standard in graphics tablets. It can be also easily adapted to the specific capabilities of used hardware, e.g. standard device with a touch screen, which is not a graphics tablet. Created partitions are associated with the areas of the signature characterized by: high and low pen velocity and high and low pen pressure on the graphics tablet surface at initial, middle and final moment of signing process. The algorithm assigns to the partitions weights of importance, which are used in the evaluation of the similarity of test signatures to reference signatures. The evaluation is realized using the new flexible fuzzy system for the evaluation of signature similarity. It uses clear fuzzy rules which allow us to interpret operation of the system. Parameters of the system are determined analytically. It is realized individually for each user and it does not require signatures of other users and so-called skilled forgeries. Our algorithm has been tested for two signature databases: MCYT-100 and BioSecure. A good accuracy of the signature verification has been achieved for both databases used; however, it worked significantly better for the BioSecure database. Achieved accuracy combined with the additional advantages of the proposed algorithm makes it an interesting solution for identity verification based on the analysis of a handwritten dynamic signature.The weakness of the proposed algorithm is its sensitivity to changes of a handwritten signature occurring over a very long period (over a number of years). This is a characteristic of most biometric methods based on the behavioural attributes. We are planning to develop a method which will update the templates during the test phase to determine the trend of signature changes. Moreover, we are also planning to simplify the mechanism of the similarity evaluation by using only the most characteristic partition for each user. For this purpose we should, among others, investigate a dependence between the accuracy of the method and the number of used partitions. We should also develop an effective mechanism for the selection of the partitions.