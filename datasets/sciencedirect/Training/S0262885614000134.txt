@&#MAIN-TITLE@&#
Fast stereo matching using adaptive guided filtering

@&#HIGHLIGHTS@&#
HghlightsA novel local stereo matching algorithm with linear complexity is proposed.The overall algorithm generates the state-of-the-art results.“Two-level local adaptation” is introduced to guide the adaptive guided filtering.The novel post-processing method handles both occlusions and textureless regions.A parallel algorithm is proposed to speed up the algorithm on GPU.

@&#KEYPHRASES@&#
Stereo vision,Local method,Adaptive guided filtering,Parallel integral image,Weighted propagation,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Stereo matching is one of the key problems in computer vision, and it plays a significant role in many 3D applications. However, the binocular stereo correspondence problem itself is ill-posed. The captured stereo scenes are disturbed by noise from the surrounding environment, e.g. light variations and sensor noise in image formation. Some inherent ambiguities in stereo scenes, such as textureless region and occlusion, also make the problem much more challenging. Various methods have been proposed, but the problem is still not fully solved.Many methods are proposed under certain assumptions and constraints, among which, the local smoothness assumption is the most widely used. According to the exhaustive review [1], most stereo matching algorithms can be categorized into two major classes: global methods and local methods. Global methods explicitly incorporate smoothness assumption into an energy function and formulate the problem in an energy-minimization framework, and the disparity map is determined by finding a solution that minimizes the global energy. Although global optimization techniques currently produce the best results, almost all the state-of-the-art global methods utilize image segmentation to ensure sharp depth edges [2]. In addition, iteration is inevitable in these algorithms, so they are relatively slow and do no scale well to high-resolution images.In local methods, data term plays a dominant role, and cost aggregation is performed in local support windows. One implicit assumption embedded in cost aggregation is that, pixels in the support window are of the same disparity. An alternative view of cost aggregation in local methods is to regard it as filtering on the cost-volume. Data costs are locally smoothed by some specific filtering approaches [3,4]. Well performed edge preserving filters [5,6] (and their variations) can perform proper cost filtering as well as keep fine edges. It is believed that local stereo matching will play a more significant role in the future, since with the development of cameras, it will be much easier to obtain high-quality images with high resolution. Nevertheless, existing cost filtering based local algorithms usually utilize fixed-size kernel windows, which are not scalable to objects with different sizes in the same scene. They perform even worse in textureless regions due to the restriction of the fixed kernel size. Moreover, many cost filtering approaches are time-consuming [7].In this paper, we propose a new cost-volume filtering method, whose weight kernel is a more general form of the one proposed in [6]. A novel concept named “two-level local adaptation” is introduced to guide the proposed filtering approach. Not only are the assigned support weights locally adaptive to the local patches, the sizes of local patches are also adjusted adaptively. A novel post-processing method is also proposed to handle occlusions and textureless regions. The proposed stereo matching algorithm ranks the 10th among about 152 algorithms on the Middlebury stereo evaluation benchmark, and takes the 1st place in all local methods. Moreover, a novel algorithm based on parallel scan is proposed to efficiently calculate an integral image on GPU. And the overall stereo matching algorithm can achieve over 30million disparity estimates per second (MDE/s).11The measurement of million disparity estimates per second (MDE/s) corresponds to the product of the number of pixels times the disparity range times the obtained frame-rate.The rest of this paper is organized as follows. In Section 2, related works on local stereo methods are reviewed. In Section 3, we present the proposed adaptive guided filtering approach and the overall stereo matching algorithm proposed in this paper is described in Section 4. At the end of each section, the computational complexity is analyzed. In Section 5, a hardware implementation of the cost filtering with CUDA is introduced. We report experimental results and give some discussions in Section 6, and conclusions are drawn in Section 7.

@&#CONCLUSIONS@&#
In this paper, a new local stereo matching algorithm was introduced. The algorithm used the proposed adaptive guided filtering method, which is designed following the novel concept “two-level local adaptation”. A parallel algorithm was designed to speed up the basic computing element of adaptive guided filtering, which improved the efficiency of disparity estimation significantly. We also presented a novel post-processing algorithm based on weighted propagation, which could handle both occlusions and textureless regions efficiently. The experimental results demonstrated that the proposed local algorithm can generate state-of-the-art results while preserving linear complexity.