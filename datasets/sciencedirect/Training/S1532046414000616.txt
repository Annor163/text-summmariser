@&#MAIN-TITLE@&#
Application of time series discretization using evolutionary programming for classification of precancerous cervical lesions

@&#HIGHLIGHTS@&#
We present a novel application of time series discretization.Evolutionary programming is used to search for a good discretization scheme.Temporal patterns observed in colposcopy are used as predictors of cervical cancer.The discrete representation is as efficient as the raw data for this application.

@&#KEYPHRASES@&#
Times series discretization,Evolutionary algorithms,Classification,Cervical cancer detection,

@&#ABSTRACT@&#
In this work, we present a novel application of time series discretization using evolutionary programming for the classification of precancerous cervical lesions. The approach optimizes the number of intervals in which the length and amplitude of the time series should be compressed, preserving the important information for classification purposes. Using evolutionary programming, the search for a good discretization scheme is guided by a cost function which considers three criteria: the entropy regarding the classification, the complexity measured as the number of different strings needed to represent the complete data set, and the compression rate assessed as the length of the discrete representation. This discretization approach is evaluated using a time series data based on temporal patterns observed during a classical test used in cervical cancer detection; the classification accuracy reached by our method is compared with the well-known times series discretization algorithm SAX and the dimensionality reduction method PCA. Statistical analysis of the classification accuracy shows that the discrete representation is as efficient as the complete raw representation for the present application, reducing the dimensionality of the time series length by 97%. This representation is also very competitive in terms of classification accuracy when compared with similar approaches.

@&#INTRODUCTION@&#
Many real-world applications related with information processing generate temporal data [14]. The temporal databases generated require enormous data storage. It is therefore desirable to compress this information while maintaining the most informative features. Previous work on this topic has been mainly focused on data compression. However, they do not rely on significant information measured with entropy [13,15]. In those approaches, the dimensionality reduction is given by the transformation of time series of length N into a dataset of n coefficients, where n<N[10]. The two main characteristics of a time series discretization scheme are as follows: the number of segments in which the time series length has to be partitioned (word size) and the number of intervals required to represent its amplitude expressed by continuous values (alphabet). Fig. 1shows a time series with a grid that represents the cut points for word size=9 and alphabet=7. Using this transformation each time series is discretized and represented as a string.Among the approaches proposed to deal with time series data discretization we find those which work with one time series at a time, such as the one proposed by Mörchen and Ultsch [17]. His algorithm is centered on the search of persistent states (the most frequent values) in time series. However, such states are not common in many real-world applications for time series. Another representative approach was proposed by Dimitrova et al. [7], where a multi-connected graph representation for time series was employed. The links between nodes have Euclidean distance values which are used under this representation to eliminate links in order to obtain a path that defines the discretization scheme. Nonetheless, this way to define the discretization process could be disadvantageous because not all the time series in a data set will necessarily have the same discretization scheme.Keogh et al. [15] proposed the Symbolic Aggregate Approximation (SAX) approach. This algorithm is based on the Piecewise Aggregate Approximation (PAA), a dimensionality reduction algorithm [11]. After PAA is applied, the values are then transformed into categorical values through a probability distribution function. Although SAX is an improvement of PAA, both algorithms require the alphabet and the word size as inputs, which is their main disadvantage because it is not clear how to define them for a given time series dataset.There are other approaches based on search algorithms, for example García-Lopez et al. [6] proposed EBLA2, which in order to automatically find the word size and alphabet performed a greedy search looking for entropy minimization. The main disadvantage of this approach is the sensitivity of the greedy search leads it to get trapped in local optima. Therefore, they used simulated annealing as a search algorithm and the results were improved. Finally, in [1], a genetic algorithm was used to guide the search; however the solution was incomplete in the sense that the algorithm considered the minimization of the alphabet and the word size as two sequential and independent processes. In this way some solutions could not be generated and the obtained solution is not global. In order to avoid it, we developed an algorithm that automatically finds both parameters at the same time [5].This is the most important contribution of our approach, since most of the discretization algorithms require, as an input, the parameters of word size and alphabet [12,15]. However, in real-world applications it might be very difficult to know in advance their best values. Hence, their definitions require a careful analysis of the time series data set. In this work, we introduce the main ideas behind our discretization approach in which both the word size and the alphabet are calculated automatically, and how this approach can be applied to the medical field in the classification of precancerous cervical lesions.Cervical cancer is the second leading cause of death for women worldwide. If it is detected early, the probability of cure is very high. After Pap smear test, colposcopy is the most used technique to diagnose this disease due to its higher sensitivity and specificity. Colposcopy allows us to visualize the uterine cervix using a microscope fitted with a light source. During the colposcopic test, the appearance of the cervix is observed while a solution of acetic acid is spread on the epithelium, which produces a change from the usual pink tissue to a whitish color due to the coagulation of proteins in the cellular nucleus. This phenomenon is called acetowhitening, and its effect is more evident at the wavelet of 525±15 (green) due to the hemoglobin absorption made by the stroma. Acetowhitening disappears in less than 10min and is more evident in precancerous lesions due to an altered nucleus to cytoplasm ratio (Fig. 2).The primary problem with this technique is the intrinsic subjectivity of the test, i.e., the amount and speed of color change perceived could be different for various observers; this fact may produce high variability on the diagnoses made by experts. Therefore changes in the mechanisms to quantify the amount of acetowhite change and the speed changes are needed to improve the test. Some researchers have suggested using the temporal patterns intrinsic to the color changes, which we called Aceto-White Response Functions (AWRF).Costas J. Balas et al. proposed the use of spectroscopy to study the correlation between aceto-white patterns and precancerous cervical lesions [2]. Although some efforts have been made to characterize precancerous cervical lesions using aceto-white temporal patterns, to the best of our knowledge there is not a complete understanding of how to automatically analyze colposcopic images using aceto-white temporal patterns for classification of cervical tissue. In our previous work [3,4], we compared the shape of the temporal patterns to establish relationships among similar shapes, and the correlation of those patterns with certain types of tissue.In the present work we apply to these temporal patterns our discretization approach in order to compress and analyze the structural properties of the intrinsic dynamics involved in the aceto-white phenomenon. In order to find a competitive discretization scheme that provides a suitable word size and alphabet, and considering its simplicity with respect to other evolutionary algorithms, evolutionary programming (EP) is adopted as a search algorithm: no recombination and parent selection mechanisms are performed and just mutation and replacement need to be designed. In a previous work the efficiency of this approach was assessed using 20 time series databases of the UCR Time Series Classification/Clustering repository [5].The main contribution of this work is the application of our discretization approach to a medical domain in order to contribute to the solution of one of the most important health problems. The contents of this paper are organized as follows: Section 2 introduces the context in which the application is motivated. After that, Section 3 exposes the main ideas behind the proposed discretization approach. Section 4 presents results. Finally, Section 5 draws some conclusions and prospects for future work.Two hundred women were included in this study, within the total number of patients, in 100 cases a tissue sample or biopsy was obtained because some changes in the appearance of the cervical epithelium were observed by the colposcopist and these alterations led to suspicion of a lesion. In the other 100 patients, the specialist did not find changes that suggested the presence of a lesion and due to clinical protocols a biopsy was not taken. Of the total quota, 93 cases were positive for precursor lesions of cervical cancer and 107 negative. Before the test, the patients signed an informed consent.Subsequently, during the colposcopic test a set of digital images were obtained. The acquisition was performed using a colposcope Vasconcellos CP-M1225 with an STC-N63BJ camera. Because in previous research [2] it has been reported that the acetowhitening effect is higher at the wavelet of 525±15 (green), and the image acquisition was made using a green optical filter. The dimension of the images was 352 × 240 pixels with a sampling frequency of 1 frame/second. The images were stored as separated files in the BMP format. A tool was developed for the acquisition and it was implemented in MATLAB 7.0. Before the application of three milliliters of 3% acetic acid solution, 10 images were obtained as a reference to calculate the percentage of color change in the tissue. Then, 180 images were acquired during a period of 3min (60×3). When the acquisition process was completed, the colposcopist selected the region where the biopsy was obtained on one image of the sequence. As the images were acquired using a green filter, they did not have chromatic components other than different saturations of green hue. For simplicity, and given our previous experience in [3], image analysis was done in grayscale. The misalignment on the image sequences produced by subject́s movements was corrected using a normalized cross-correlation registration method [3,20].The colposcopic image sequence can be represented as a sequence of t 2D images It(x,y) with acquisition time t. The color variation over time of each pixel in the image provides a time series. The resulting image sequence can be viewed as a 3D image block I(x,y,t) defined on the spatio-temporal domain. Let ImageBlock(x,y,t) represent a stack of t images of size (x,y). Thus there are (x*y) pixels, each of which is a time series of length t. Let p(i,j) represent the intensity of the pixel (i,j), i=1,…,x, j=1,…,y. The intensity value of each pixel over time is used to construct an AWRF (Fig. 3).As was mentioned in Section 2.1, after the acquisition of the images, the colposcopist selected the region where a biopsy was obtained on one representative region of the tissue type. Using these regions of interest defined by the expert, the mean time series of each region was used to construct a database where each row contains the AWRF of each subject with their corresponding tissue type. Then, the size of our time series database (TSDB) is 200 rows (subjects) by 180 columns (time series points), plus one column that identifies the class label (+○−). The classification task consists of finding similar temporal patterns with regular shapes belonging to the same type class.Although the purpose of our approach is discretization and not only dimensionality reduction, a principal component analysis (PCA) was developed in order to compare the classification accuracy of both methods.PCA was developed over the complete database of AWRF (TSDB). The objective of the analysis was to find the first n principal components (PC) which explain the shapes of the AWRF contained in the TSDB. The four principal components were selected to explain the 98.06% of the variance (see Fig. 4).Consider the linear model: TSDB=θ*PC+e, where TSDB is the time series database of AWRF, PC is the matrix of regressors (represented by the four first principal components), θ is the parameter matrix corresponding to the projections of each AWRF over the PC, and e is a normally distributed noise vector. The parameter estimation can be easily done using linear regression:(1)θ=TSDB*PCPC*PCFor illustrative purposes, Fig. 5shows four representative AWRF and their corresponding adjusted models and parameters theta.

@&#CONCLUSIONS@&#
We presented a novel application of time series discretization algorithm based on EP. The proposed algorithm was able to automatically find the parameters for a suitable discretization scheme considering the optimization of accuracy, complexity and compression rate. A simple mutation operator was able to sample the search space by generating new and competitive solutions. Our EP algorithm is easy to implement and our results show that the EP algorithm is able to create suitable discretization schemes that reaches statistically equivalent classification error than the raw data.On the particular application of classification of precancerous cervical lesions using a temporal approach, we showed that the discretized version of the continuous raw data is able not only to reduce the dimensionality of data but also to maintain the classification accuracy. This research is one step toward the development of an automatic classification system for cervical cancer detection. As a difference with other well-known time series discretization algorithms like SAX, EP automatically finds a suitable parameter for word and alphabet size. Although PCA representation was as competitive as EP, in terms of classification accuracy and compression, it does not produce a discrete representation and the interpretation of this representation is not straightforward.As a future work we consider a further analysis of the EP algorithm such as the effect of the weights in the search as well as the number of changes in the mutation operator. Other nature-inspired approaches like Particle-Swarm Optimization need to be tested. Pareto dominance will be explored with the aim of dealing with the three objectives considered in the fitness function [18]. Also, the discretized representation of the temporal patterns could let the application of other classification techniques (besides -nearest neighbors) that work with categorical data, e.g., decision trees or Bayesian networks.Finally, the segment information extraction can be extended to identify not only the most informative segments, but also the most informative cells. Using this information a graphical model of classification such as decision trees can be constructed; where the internal nodes are the identification of the word segment, the arcs are the values of the alphabet segment that identifies a particular cell, and the leaf nodes are the class values.Under this approach we could easily show graphically the most important segments on the time series (see Fig. 14).