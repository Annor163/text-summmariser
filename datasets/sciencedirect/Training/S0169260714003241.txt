@&#MAIN-TITLE@&#
A machine learning approach to multi-level ECG signal quality classification

@&#HIGHLIGHTS@&#
A five-level ECG signal quality classification algorithm using a machine learning approach was proposed.13 signal quality metrics were derived from segments of ECG waveforms.The algorithm was trained and tested on a simulated dataset and was validated using data from the MIT-BIH arrhythmia database.A classification accuracy of 80.26% and a single class overlap accuracy of 98.60% on the test set were obtained by selecting 10 metrics model.A classification accuracy of 88.07±0.32% and a single class overlap accuracy of 99.34±0.07% were gained on the validation fold of MITDB.

@&#KEYPHRASES@&#
ECG,Signal quality,Multi-level classification,Machine learning,Support vector machine,

@&#ABSTRACT@&#
Current electrocardiogram (ECG) signal quality assessment studies have aimed to provide a two-level classification: clean or noisy. However, clinical usage demands more specific noise level classification for varying applications. This work outlines a five-level ECG signal quality classification algorithm. A total of 13 signal quality metrics were derived from segments of ECG waveforms, which were labeled by experts. A support vector machine (SVM) was trained to perform the classification and tested on a simulated dataset and was validated using data from the MIT-BIH arrhythmia database (MITDB). The simulated training and test datasets were created by selecting clean segments of the ECG in the 2011 PhysioNet/Computing in Cardiology Challenge database, and adding three types of real ECG noise at different signal-to-noise ratio (SNR) levels from the MIT-BIH Noise Stress Test Database (NSTDB). The MITDB was re-annotated for five levels of signal quality. Different combinations of the 13 metrics were trained and tested on the simulated datasets and the best combination that produced the highest classification accuracy was selected and validated on the MITDB. Performance was assessed using classification accuracy (Ac), and a single class overlap accuracy (OAc), which assumes that an individual type classified into an adjacent class is acceptable. An Ac of 80.26% and an OAc of 98.60% on the test set were obtained by selecting 10 metrics while 57.26% (Ac) and 94.23% (OAc) were the numbers for the unseen MITDB validation data without retraining. By performing the fivefold cross validation, an Ac of 88.07±0.32% and OAc of 99.34±0.07% were gained on the validation fold of MITDB.

@&#INTRODUCTION@&#
Electrocardiogram (ECG) recordings are often corrupted by large amounts of noise and artifacts that can be within the frequency band of useful cardiac data and can manifest with similar morphologies to the ECG waveform itself [1]. Not only does the presence of noise and artifact interfere with the correct recognition of QRS, P and T waves of the ECG, but also increases the rate of false alarms for cardiac monitors [2].Some earlier published works have described ECG signal quality assessment and noise estimation methods, generally as part of a general approach to ECG analysis. Moody and Mark used the residual after projecting a QRS complex onto the first five principal components (PCs) of an ensemble of QRS complexes, or the Karhunen–Loève transform [3]. Standard noise measurement methods for ECG, which can be used as individual signal quality indices (SQIs), were reviewed by Clifford et al., including the root mean square (RMS) power in the isoelectric region, the ratio of R-peak to noise amplitude in the isoelectric region, the Crest factor or peak-to-RMS ratio and the ratio between in-band (5–40Hz) and out-of-band spectral power [1]. Li et al. developed four SQIs which included the ratio of power in various bands of the spectrum, the degree of agreement between different QRS detectors, the degree of agreement between beat detection on different leads, and the kurtosis of the ECG [4]. These quality measures were calibrated to provide a mapping between a normalized SQI and an expected error in the heart rate (HR). The normalized SQI was then used as a weighting factor in the procedure of HR estimation by fusing the HR traces from the ECG and arterial blood pressure with a Kalman filter. This SQI-weighted HR estimation method provides an accurate HR estimate even in the presence of high levels of persistent noise and artifact, and during episodes of extreme bradycardia and tachycardia. Redmond et al. used signal masking methods to determine artifacts and the degree of missing information in the ECG [5]. Only three feature masks were described in their work: (1) a rail contact mask was used to mark the saturation to 0 or rail voltage; (2) a high-frequency mask was obtained by using a fifth-order high-pass elliptic forward–backward filter with a cut-off of 40Hz (with a fixed threshold in order to detect muscle and electrode-tissue contact noise) and (3) a low power mask was employed by using an IIR filter with a pass band of 0.7–33Hz and a fixed threshold to locate low power segments in the ECG signal. The algorithm yielded a sensitivity of 89% and a specificity of 98% although the fixed thresholds required manual tuning for different signal sources and it was not tested on an independent test set. Moreover, the analysis was not performed on a standard or public database and so the results cannot be compared to any other published method, nor can the results be considered to apply to any data outside their application. Their selection of noise sources was also not comprehensive.The 2011 PhysioNet/Computing in Cardiology (PCinC) Challenge was to develop an efficient algorithm able to run on a mobile phone and provide useful feedback to indicate if an ECG is of adequate quality for interpretation [6,7]. The Challenge data were standard 12-lead ECG recordings with full diagnostic bandwidth (0.05–100Hz). Each lead was sampled at 500Hz with 16-bit resolution. The leads were recorded simultaneously for a minimum of 10s. Every ECG was reviewed by a group of annotators with varying amounts of expertise in ECG analysis, in blinded fashion for grading and interpretation. Between 3 and 18 annotators, working independently, examined each ECG channel, assigning it to a letter and a numerical rating (A (0.95): excellent; B (0.85): good; C (0.75): adequate; D (0.60): poor; or F (0): unacceptable) for signal quality. The average numerical rating,s⌢, was calculated in each case, and each record was assigned to one of three groups [6,8]:•Group 1 (acceptable): ifs⌢≥0.70, and NF≤1.Group 2 (indeterminate): ifs⌢≥0.70, and NF≥2.Group 3 (unacceptable): ifs⌢<0.70.(NF is the number of grades that were marked as F.) Approximately 70% of the collected records were assigned to group 1, 30% to group 3, and fewer than 1% to group 2, reflecting a high degree of agreement among the annotators. A total of 1500 12-lead ECGs were divided into two sets, in a ratio of 2:1. The larger set of 1000 ECGs was used for training (Set-A), for which binary annotations (acceptable or unacceptable) were available. A smaller set of 500 ECGs was available for testing (Set-B), although competition entrants were blinded to the annotations. Several algorithms from the Challenge were then published in a special focus issue of Physiological Measurement (“Signal Quality in Cardiorespiratory Monitoring”) [8–15]. Hayn et al. explored the use of four criteria; a no signal detector, a spike detector, a lead crossing point analysis and a measure of the robustness of QRS detection. An accuracy of 93.3% was achieved on the training set and 91.6% on the test set [9]. Xia et al. developed twelve signal quality heuristics and calculated these for each of the 12 ECG leads, yielding a 12 by 12 matrix. The elements were then summed and a threshold applied to provide a classification for a given 12 lead ECG. After optimization of the threshold, the authors achieved an accuracy of 95%, with a sensitivity of 88% and specificity of 97% on the training set, but the authors did not report the performance on an independent test set [10]. Clifford et al. used a series of SQIs (based on morphological, statistical and spectral characteristics) and a support vector machine (SVM) or multilayer perceptron neural network to combine the SQIs and provide a quality estimate [8]. A classification accuracy of 98% on the training set and 97% on the test set was achieved. Only Clifford et al. studied the effect of the SQIs on arrhythmic data, and showed that arrhythmias led to a drop in accuracy to 93% indicating that algorithms may need retraining for some rhythms [8]. Subsequent work by the same research group showed that classification accuracies of up to 99% on training and test sets were obtained for normal sinus rhythm and up to 95% for arrhythmias on training and test sets [16].These studies provided a two-class mapping for ECG signal quality: acceptable or unacceptable (as shown in PCinC website, the score is the fraction of group 1 and group 3 ECGs in set-B that were correctly classified by the participant's algorithm). However, clinical usage may demand much more specific signal quality levels according to different requirements [15]. Vaglio et al. studied different noise levels to help the cardiologist to define the set of ECGs that need a manual review after the automatic ECG measurements such as QT, PR and QRS intervals [17]. Vaglio points out that three signal quality bins will be satisfactory: low, average and good quality. ECGs flagged as low-quality will need manual reading, ECGs flagged as average-quality will need cardiologist over-read and good quality ECGs won’t need any further review process. Redmond et al. classified the ECG quality into three categories based on the determinability of heart rate: good (HR is easy to determine); average (HR is difficult, but possible to determine); bad (HR cannot reliably be determined) [15]. To analyze low amplitude characteristic segments such as the P wave or ST segment, more levels of signal quality were required. Quesnel et al. used five signal-to-noise ratio (SNR) levels to gate alarms for myocardial ischemia by indicating ST deviations in ambulatory ECG [18]. Annotation of noise is also marked in some public domain ECG databases, such as MIT-BIH arrhythmia database (MITDB) [19,20], but no further sub-level of noise was made. Fig. 1shows two ECGs marked as noisy in MITDB where the noise levels and types of the two ECGs are quite different.In this paper, we present a five-level ECG signal quality classification algorithm using a machine learning approach. A total of 13 signal quality metrics were derived from segments of ECG waveforms and were presented to a support vector machine to perform training on a simulated dataset and validated on the MIT-BIH arrhythmia database.

@&#CONCLUSIONS@&#
