@&#MAIN-TITLE@&#
An emboli detection system based on Dual Tree Complex Wavelet Transform and ensemble learning

@&#HIGHLIGHTS@&#
Embolic signals are used for the identification of active embolic sources in stroke-prone individuals.Dual Tree Complex Wavelet Transform (DTCWT) is used as a new feature extractor from forward and reverse Doppler ultrasound signals.The features acquired from forward and reverse flow directions of the blood are fed into k-NN and SVMs.The individual predictions of classifiers are combined using ensemble stacking method considering that the forward and reverse blood flow coefficients carry different characteristics.The results show that the DTCWT is superior to the DWT and FFT.

@&#KEYPHRASES@&#
Dual Tree Complex Wavelet Transform,Embolic signals,Dimensionality reduction,Support vector machines,Stacked generalization,Ensemble learning,

@&#ABSTRACT@&#
The traditional visual and acoustic embolic signal detection methods based on the expert analysis of individual spectral recordings and Doppler shift sounds are the gold standards. However, these types of detection methods are high-cost, subjective, and can only be applied by experts. In order to overcome these drawbacks, computer based automated embolic detection systems which employ spectral properties of emboli, speckle, and artifact using Fourier and Wavelet Transforms have been proposed. In this study, we propose a fast, accurate, and robust automated emboli detection system based on the Dual Tree Complex Wavelet Transform (DTCWT). Employing the DTCWT, which does not suffer from the lack of shift invariance property of ordinary Discrete Wavelet Transform (DWT), increases the robustness of the coefficients extracted from the Doppler ultrasound signals. In this study, a Doppler ultrasound dataset including 100 samples from each embolic, Doppler speckle, and artifact signal is used. Each sample obtained from forward and reverse blood flow directions is represented by 1024 points. In our method, we first extract the forward and reverse blood flow coefficients separately using DTCWT from the samples. Then dimensionality reduction is applied to each set of coefficients and both of the reduced set of coefficients are fed to classifiers individually. Subsequently, in the view that the forward and reverse blood flow coefficients carry different characteristics, the individual predictors of these classifiers are combined using ensemble stacking method. We compare the obtained results with Fast Fourier Transform and DWT based emboli detection systems, and show that the features extracted using DTCWT give the highest accuracy and emboli detection rate. It is also observed that combining forward and reverse coefficients using stacking ensemble method improves the emboli and artifact detection rates, and overall accuracy.

@&#INTRODUCTION@&#
The transcranial Doppler ultrasound, which enables monitoring the middle cerebral artery, is a commonly used method to detect asymptomatic embolic signals (ES) in the cerebral circulation [1]. In certain conditions, such as carotid artery stenosis, cardiac valvular disease and atrial fibrillation, asymptomatic ES are used for the identification of active embolic sources in stroke-prone individuals and the selection of high-risk patients for appropriate treatment [2]. Therefore, for these patients, accurate detection of asymptomatic ES has a significant clinical importance.Traditionally, for detecting ES, visual detection by using individual spectral recordings and acoustic detection by hearing the Doppler shift sound by human experts are the gold standards. These types of detection techniques are time consuming (recordings of the patients may last for 1h or more) and subject to observer's experience. As a consequence of these drawbacks, an automated system is required for a reliable and clinically useful emboli detection technique.A Doppler ultrasound signal detected by the transcranial Doppler ultrasound system contains two more signal types other than the ES. These signals are the Doppler speckle (DS) (signals caused by red blood cell aggregates) and the artifacts (signals caused by tissue movement, probe tapping, speaking, and any other environmental effects). ES are the results of the reflection of transmitted Doppler ultrasound signals from emboli which are bigger than red blood cells. Therefore, ES have some distinctive characteristics when compared to DS and artifacts. ES appear as increasing and then decreasing in intensity for a short duration, usually less than 300ms and their bandwidth is usually much narrower than that of DS. Therefore, ES can be considered as narrow-band signals relative to DS [3].The outputs of a Doppler ultrasound system employing quadrature detection are in-phase and quadrature-phase components. The information concerning blood flow direction is encoded in the phase relationship between these two components; forward and reverse blood flow signals are obtained by using various methods [4,5]. Unlike the artifacts, ES and DS are unidirectional.Generally, the aim of automated emboli detection systems is to distinguish ES from artifacts and DS using Doppler ultrasound. For this purpose, an automated system is aimed to be built up by extracting features from these signals using various methods followed with classification. After the feature extraction step, any dimensionality reduction method such as principal component analysis (PCA) or linear discrimination analysis (LDA) can be applied to deal with the curse of dimensionality problem [6]. A preferred method is to obtain the spectra of audio recordings via complex discrete Fourier transform and use PCA to make it easy for a classifier such as support vector machines (SVM) to identify whether the signal contains ES or not [7].Considering the narrow-band assumption, frequency analysis based methods are frequently used as feature extraction step in ES detection systems [8]. In [9] a spectrogram analysis based detection method is proposed. Along with these techniques, Fast Fourier Transform (FFT) is also commonly used in feature extraction. However, continuous wavelet transform (CWT) based methods perform better than FFT in describing ES [10]. Another approach is to use DWT to extract features from signals, for instance in [11], an automated system using DWT to derive several parameters for detecting ES was proposed. In [11], Doppler ultrasound signals were decomposed into an optimum number of frequency bands and then these bands were reconstructed. From these reconstructed bands several parameters were obtained and used in detection algorithm.Dual Tree Complex Wavelet Transform (DTCWT), which is an improved version of ordinary DWT with limited redundancy, can also be used in the analysis of ES. The DTCWT was developed to overcome the lack of shift invariance property of ordinary DWT [12,13]. This property of DTCWT can be very important when the wavelet coefficients are used as features in machine learning algorithms to detect emboli, because the emboli information is encoded in the phase relationship of the in-phase and quadrature-phase components and any phase-distortion during the analysis steps can reduce the discriminative power of wavelet features. In literature, the success of DTCWT in the analysis of non-stationary signals such as ES was proved in [14,15].In our study, a Doppler ultrasound dataset consisting of 100 samples from each embolic, DS and artifact 1024-point signal pairs – forward and reverse direction – is used. Exemplary time-domain representations of ES, artifact and DS in both forward and reverse directions can be seen in Fig. 1. FFT, DWT and DTCWT are applied to these 300 signal pairs in order to extract features. Thereafter, the dimensionality (1024 in this case) of resulted coefficients is reduced with a dimensionality reduction method for removing signal components that do not carry useful information. Dimensionality reduction is a critical preprocessing step in machine learning problems especially when the dimensionality of the dataset is high when compared with the number of samples such as the Doppler ultrasound dataset dealt with in this paper [16]. The dimensionality reduction techniques can be categorized into two groups: (1) unsupervised techniques that do not utilize the class labels (PCA), and (2) supervised techniques (linear discriminant analysis – LDA) that incorporate the class labels into their frameworks [17]. Even though mainly the PCA is used in this work, the LDA is also used to visualize the samples according to their classes.Ensuing the feature extraction and dimensionality reduction phases, the features acquired from forward flow direction of the blood are fed into k-NN and SVM. Additionally, in order to increase the classification accuracy, the information extracted from the features acquired from reverse flow direction of the blood is also used. However, these features are not combined in a conventional way. First, the features from forward and reverse directional signals are fed to classifiers separately since forward signals are suitable for three-class classification (embolic signal, speckle or artifact) whereas the reverse signals are for two-class classification (artifact or non-artifact). Then, the outputs of these two classifiers are combined using the stacking ensemble combination technique. The obtained individual and combined results are presented and compared for each feature extraction method in detail. The results indicate that the proposed emboli detection system is superior to related studies in terms of emboli detection rate (in [9,18,19] the emboli detection rates are 86.6%, 87% and 87.6%, respectively).The remaining of the paper is organized as follows: Section 2 gives the description of the Doppler ultrasound dataset, presents the theory of signal processing methods used, and declares brief information about feature extraction and dimensionality reduction methods. Additionally, in Section 2 individual and combined emboli detection systems are explained. Section 3 provides the experimental results on the Doppler ultrasound dataset. Lastly, Section 4 is the discussions and conclusions.

@&#CONCLUSIONS@&#
As visual analysis and detection of ES by experts are very time-consuming and also subjective to observer's experience, development of computer-based decision support systems that aim to discriminate ES from artifacts and noisy samples are very popular in the field of biomedical engineering. A robust ensemble emboli detection method is proposed in this paper. Employing the proposed method, a Doppler ultrasound dataset containing 100 samples of embolic, DS and artifact signal pairs in both forward and reverse directions are transformed using Dual Tree Complex Wavelet Transform (DTCWT). Then PCA is applied to both forward and reverse set of coefficients to reduce the dimensionality and the reduced sets of features are fed to classifiers separately. Finally the probability estimates of individual classifiers obtained from forward and reverse directional signals are combined using ensemble stacking method. The success of DTCWT features are compared with those of Fast Fourier Transform (FFT) and Discrete Wavelet Transform (DWT). First of all, we must note that SVM based detection methods achieves higher accuracy and emboli detection rate when compared to k-NN based methods due to the known generalization problem of k-NN classifier. Additionally, both DWT and DTCWT based extracted features give higher overall classification and emboli detection accuracies than the FFT based features due to the well localization property of wavelets in both time and frequency.The results show that the DTCWT is superior to the DWT due to its shift-invariance property. Besides, combining the coefficients extracted from different directions of blood flow, namely forward and reverse, using ensemble stacking enhances the accuracy of the classifier. This shows that using the reverse directional signals as an additional data source increases the performance of the proposed emboli detection system since reverse blood signals also include significant and unique discriminative information. As a future direction, the proposed method can be implemented in real time to build an online emboli detection system.