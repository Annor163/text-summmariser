@&#MAIN-TITLE@&#
Clustering based multiple model control of hybrid dynamical systems using HJB solution

@&#HIGHLIGHTS@&#
Hamilton–Jacobi–Bellman (HJB) equation based stabilized optimal control of hybrid dynamical systems (HDS) is presented.The fuzzy validity based method is used to find the number of linear models present in the HDS.Stability proof for the event wise and generalized HJB solution based optimal control is proposed.The proposed modeling and control algorithm have been applied on two HDSs.

@&#KEYPHRASES@&#
HJB equation,Optimal control,Hybrid dynamical systems,Event wise linearized models,Lyapunov stability,

@&#ABSTRACT@&#
This paper deals with Hamilton–Jacobi–Bellman (HJB) equation based stabilized optimal control of hybrid dynamical systems (HDS). This paper presents the fuzzy clustering based event wise multiple linearized modeling approaches for HDS to describe the continuous dynamic in each event. In the present work a fuzzy clustering validation approach is presented for the selection of number of linearized models which span entire HDS. The method also describes how to obtain event wise operating point using fuzzy membership function, which is used to find the event wise model bank by linearizing the first principles model. The event wise linearized models are used for the formulation of the optimal control law. The HJB equation is formulated using a suitable quadratic term in the objective function. By use of the direct method of Lyapunov stability, the control law is shown to be optimal with respect to objective functional and stabilized the event wise linearized models. The global Lyapunov function is proposed with discrete variables which stabilized the HDS. The proposed modeling and control algorithm have been applied on two HDSs. Necessary theoretical and simulation experiments are presented to demonstrate the performance and validation of the proposed algorithm.

@&#INTRODUCTION@&#
In the process industries, many operations involve logical discrete dynamics along with continuous state dynamics for flexible processing. The hybrid dynamical systems (HDS) have interaction of both discrete dynamics and continuous dynamics [1–3]. The HDS and their applications have received a lot of attention from the control and computer science societies [4]. Thus, several researchers have focused on model analysis and control techniques of the HDS.Modeling of such systems is a challenge problem in the fact that the systems parameters depend on the discrete event. The mathematical models for such systems should not be too complex to understand and not too simple; otherwise, it is inaccurate from the real systems. The main difficulties in the monitoring and control of HDS lay in the fact that model parameters depend on the discrete event. A modeling framework for the HDS like linear complementarity (LC) systems [1], mixed logical dynamical (MLD) systems [4,5], piecewise affine (PWA) systems [6–10] and multiple linear model [11,12] have been largely used for identification and control applications. However, in [11] and [12] the multiple linear model based approach is used to describe the behavior of the HDS. In [11], no guideline was provided for the selection of a number of linear models. As the number of linear models is selected more it deteriorates the performance of the overall control system and also increase the computation burden [13].However, when too less number of linear models may not sufficiently expand the span of all the events of the HDS. To fill this gap, the present work proposes the approach to obtain linear models that span all discrete events present in the HDS. The proposed method consists of formulating of event wise linear model bank. In this paper, the linearized models are obtained at specified operating points derive from fuzzy c-means (FCM) clustering based approach. The number of discrete events presents in the HDS is identified using a fuzzy based approach given in [10].Several control algorithms have been designed for different types of HDS models with different types of HDS, e.g. [2–5,9,14,15]. In this work, event wise multiple partially linearized models based optimal control framework is used. The stability has been analyzed using Lyapunov functions for discrete event system in [16] and switched system in [17–19]. However, no guidelines are provided for the number of discrete and switching events. The quadratic stability concept based Lyapunov functions were independent of the discrete parameter of the system. The optimal control problem can be formulated into the linear quadratic regulator by assuming a solution of Hamilton–Jacobi–Bellman (HJB) equation proposed in [20]. The neural network based HJB solution is also used to find the solution of the optimal control law [21]. The Lyapunov function and HJB solution are the major analytical concept for the stability of the multi model systems. In the present work it is assumed that the solutions of HJB equation exist and develop the optimal control law without any constraint on the control input. Moreover, it is proved that the event wise Lyapunov function gives guaranteeing stability of the HJB equation solution. For the HDS it is also proved that the combined Lyapunov functions also stabilize the HJB equation solution. Compared with the existing research literature, the contributions of this paper are summarized as follows:(1)By using a fuzzy clustering validation technique, the proposed multiple model optimal control approach does not need to assume that the number of discrete events should be given a priori as in [11,16–19,22].The local operating points are derived using clustering methods to obtain eventwise linearized models, which was lacking in literatures [10,12,22].Based on HJB solution optimal control law is formulated for the HDS.The proposed optimal control scheme is supported by necessary theoretical and simulation results on two HDSs.The paper is organized as follows. In Section 2, event wise linearized modeling framework has been described for the HDS. The approach for the estimation of discrete events is stated along with method to find the operating point of the system. The event wise Lyapunov function based HJB solution is derived with the theoretical results along with solution to find optimal control law such that it stabilized the HDS is described in Section 3. In Section 4, simulation experiments are given to validate proposed approach.The HDS is defined by the equations:(1)x˙=fi(x,u)y=gi(x,u)forxu∈φiwhere x(t)∈Rnis referred to as the continuous time state variable vector, y(t)∈Rpis a measured output, u(t)∈Rmis an input vector, fi:Rn×Rm→Rn, i=1, …, s, are continuous nonlinear state transition function form a global flow-field of the HDS and gi:Rn×Rm→Rp, i=1, …, s, are output function. Theφidef̲̲xu:Kixx+Kiuu≤Hi,i=1,…,s,are assumed to be convex polyhedron partitions in state and input space. Kix, Kiuand Hiare the corresponding real coefficient matrices of appropriate dimensions. The value of s indicates number of discrete event present in the NHDS. The polyhedral partition φiform a complete bounded polyhedron partition of φ (i.e.φ=⋃i=1sφi) and φi∩φj=ϕ;∀i≠j. The defined HDS in Eq. (1) change its continuous dynamic as the discrete events are generated as state of the system across some threshold value known as a state event (SE) and due to manipulating of the inputs known as control events (CE). The switching law between the defined HDS in Eq. (1) is specifying by the rule: ifxu∈φi, the ith event related nonlinear dynamic is active and generated appropriate y. The following steps are used to simplify the optimal control problem,(i)evaluate the number of discrete events present in the HDS;for each discrete event estimation of operating points;obtain event wise linearized models of the original HDS Eq. (1);formulate optimal control solution of the linearized model.In the following subsections detail of each of the above steps is discussed.To obtain a linearized model of a finite of experimental data is a complex problem which required techniques to estimate the number of discrete events at the same time classification of the experimental data according to its discrete events. In the first step is it requires to collecting a finite set of experimental data by applying an input excitation signal such that it excited all discrete events of the HDS. Xie–Beni [23] based cluster validity index used to find the number of cluster centers present in fuzzy clustering. Still, this algorithm is not much explored for the HDS. In the present work, to evaluate the number of discrete events present in the HDS, via experimental input-output data set, Xie-Beni cluster validity index is used as in [10]. The main objective of presenting the HDS in Eq. (1) is to find s discrete events present in the system from the given N finite observation data setw(t)={y(t),x(t),u(t)}t=1N. The fuzzy clustering algorithm is an unsupervised; it required number of clusters present in the given data set. However, the fuzzy clustering algorithm is more efficient for the overlapping clustering problem [10,24]. The proposed algorithm starts with inializing the value of fuzziness m, termination criteria of the algorithm ɛ∈[0,1] and maximum number of discrete events present in the given HDS denoted by smaxand can be described by the following given steps.1.Initialize k points for 2<k≤smaxas the initial number of cluster centers (means) denoted by (c(1)j, …, c(k)j).Now, for the randomly selected cluster centers compute the element of membership matrixUj=[μitj]and(2)μitj=∑l=1k||w(t)−c(i)j||2||w(t)−c(l)j||21/(m−1)−1where μit∈[0, 1], 1≤i≤k, 1≤t≤N and elements of μitmust fulfill the constraints:(3)∑i=1kμit=1,1≤t≤NUpdate the vector elements of cluster center C=c(i) using the membership function(4)c(i)j+1=∑Nt=1(μitj)mw(t)∑Nt=1(μitj)mNow, update the elements Ujto Uj+1 until ||Uj+1−Uj||≤ɛ. Obtain final value of C and U=[μit].Calculate compactness index as(5)δ(C,U)=1N∑i=1k∑t=1N(μit)m||w(t)−c(i)||2Calculate separation index as(6)σ(C,U)=mini≠j||c(i)−c(j)||2Final validity index as(7)ρ(C,U)=δ(C,U)σ(C,U)Repeat steps 2–7 until k≤smax.Number of discrete events s=min{ρ(C, U)}.In step 5, Eq. (5) of δ(C,U) is defined as the global compactness of fuzzy partitions of a given data set as in [25]. The compactness index is combined with fuzzy membership function along with the distance between data set and cluster center, which will give more weight to the data set nearer to the cluster center and less weight to far away data set. The value of δ(C,U) must be small to achieve better partition between cluster center and data set and more compact within the cluster. In step 6, the separation index σ(C,U) of Eq. (6) shows the amount of separation between the cluster centers. As the larger value of separation index indicates clear partitioning between the clusters. Finally, the validity index denoted as ρ(C,U) is the ratio of compactness and separation index defined by Eq. (7) as defined in [10,23,26]. The smallest value of validity index for giving the number of cluster centers indicates the correct number of discrete events present in the data set.After the selection of the number of discrete events which give the number of submodels presents in the HDS, the next step to obtain the operating points to linearize the nonlinear dynamics and separate the data set according to its discrete events. In this phase, fuzzy c-means (FCM) clustering algorithm is used to solve above mentioned problems. Since the FCM clustering algorithm is unsupervised, it required the number of cluster centers or partitions present in the data set. The FCM clustering algorithm allows one data set belong to two or more cluster center with the degree of belongingness [27]. This method (developed by Dunn in 1973 and improved by Bezdek in 1974) is frequently used in pattern recognition [28] and piecewise affine model identification [10,29–31]. FCM clustering algorithm aims to get partition into s subsets of cluster centers C such that it minimize the within-cluster Sum of Squares (WCSS). The cost objective function for FCM algorithm minimizes the Euclidian distance between the dataset and cluster centers and expressed as:(8)J(C)=∑i=1s∑t=1N(μit)m||w(t)−c(i)2||where:N: number of data points;s: number of discrete events;w(t): tth measure data set;c(i): ith cluster center set;μit: degree of membership function for data set w(t) in the ith cluster;m∈[1,∞]: weighting exponent which determines the degree of fuzziness in the resulting clusters;||.||: second order norm expressing distance between data set and a cluster center.For FCM clustering using the derived value of the cluster center from Section 2.1 as k=s and repeat steps 2–4 of Section 2.1. The final clustering result is obtained with the location of the cluster center C and normalizing membership function U which is used to classify the data. The membership function U indicates the degree of belongings of each data set to all cluster centers. The highest value of the membership function indicates the data set is belongs to that cluster. The FCM clustering algorithm classified the data set into s partitions and also gives the location of the cluster center for each partition. The location of cluster centers for each partition is used as the operating point of the HDS denoted as{yoi,xoi,uoi}i=1saround which we identify the linearized model.In this phase, event wise linear models are obtained by linearizing the actual HDS Eq. (1) around the derived operation points from Section 2.2. for each region. Now, linearized Eq. (1) using Taylor series expansion with first order approximation around the ith operating point (yoi, xoi, uoi) in the ith region φiand the solution is:(9)δx˙=Aiδx+Biδuδy=Ciδx+Diδuforxu∈φiwhere:δx=x−xoi;δu=u−uoi;δy=y−yoi;Ai=∂fi(x,u)∂x(xoi,uoi);Bi=∂fi(x,u)∂u(xoi,uoi);Ci=∂gi(x,u)∂x(xoi,uoi);Di=∂gi(x,u)∂u(xoi,uoi).Hence, the linearized model at operating point (xoi, uoi) using Taylor series expansion with first order approximation is(10)fi(xoi,uoi)=Aiδx+Biδufor the ith event.Now, The HDS decomposed into several local operating point regions according to its discrete events and linearized models built for each of these regions. In the next section, develop an optimal control scheme for control of HDS for multiple linearized models is developed.In this section, the optimal control problems for HDS are formulated for multiple linearized models.Optimal control is a form of state feedback structure, where the value of manipulating variable is determined using optimal solution. Now, find the manipulating variable that minimize the following cost function in ith event:(11)Ji(x,u)=∫t∞Hi(x,u)dτwhere t is the current time and Hi(x,u) is characterized quadratic cost function for ith event defined as:(12)Hi(x,u)=xTQix+uTRiuIn Eq. (12)Qi=QiT≥0andRi=RiT>0are positive semi definite symmetric state and input weighting matrices, respectively. To find the optimal solution of above Eqs. (11) and (12) following assumption will be made.Assumption 1Assuming that there exists a quadratic cost function for ith event Vi(x,u):(13)Vi(x,u)=Hi(x,u)where Vi(x,u) is a positive semi definite symmetric function.According to Hamilton–Jacobi–Bellman (HJB) solution for the Eqs. (11) and (13) optimal control input must satisfy the equationminu(t)∈RmHi(x,u)+∂Vi∂xTδx˙=0From Eqs. (9) and (12), the above equation can be express as(14)minu(t)∈RmxTQix+uTRiu+∂Vi∂xT(Aiδx+Biδu)=0When xTQix+uTRiu+(∂Vi/∂x)T(Aiδx+Biδu)=0, solution for given problem to find optimal control input is(15)u=−12Ri−1BiT∂Vi∂xAssuming that there exists Vi(x,u) and the solution of corresponding HJB equation Eq.(14). Using this solution, control law given by Eq.(15)ensures close loop stability of the HDS Eq.(9)for ith event.We can show that there exists Vi(x,u) Lyapunov function of Eq. (9) for the ith event of HDS.(16)Vi(x,u)>0forx,u≠0andVi(x,u)=0forx,u=0Now to show that Vi(x,u)<0 for x, u≠0,V˙i(x,u)is defined asV˙i(x,u)=∂Vi∂xTx˙From Eqs. (1) and (10) for ith event around the operating points(17)V˙i(x,u)=∂Vi∂xTfi(xoi,uoi)=∂Vi∂xT[Aiδx+Biδu]From HJB Eq. (14) above Eq. (17) reduced to(18)V˙i(x,u)≤−xTQix−uTRiuBecause Qi≥0 and Ri>0, the Lyapunov cost function is monotonically nonincreasingV˙i(x,u)≤0. AsV˙i(x,u)is bounded below by zero means that as x→0 and u→0 at t→∝ leads toV˙i(x,u)→0at t→∝. Therefore, from the Lyapunov stability theorem system Eq. (15), which is a solution of HJB Eq. (14), will stabilize the HDS in the ith event linearized model.Theorem 1 guarantees that the local control law in Eq. (15) steered the state of the HDS in ith event toward the zero equilibrium point. The motivation behind the proposed methodology using event driven optimal control law is to transfer original optimal control of the HDS problem which includes all discrete events. Let us assume that the global Lyapunov function for the HDS is defined as(19)V(x,u)=∑i=1saiVi(x,u)where ai∈{0, 1}, ∀i=1, …, s, are discrete variables. In Eq. (19), ai=1 when ith event dynamic is active and corresponding local cost function is working as a global cost function of the HDS. The other cost functions have zero weight as their dynamics are not active. As only one event dynamic is active at any particular time, the discrete variables must satisfy the exclusive-or condition such that∑i=1sai=1.Assuming that there exists V(x,u) as per Eq.(19)than control law given by Eq.(15)ensures close loop stability of the HDS given by Eq.(1).We can show that there exists V(x,u) Lyapunov function of Eq. (1) for the HDS. As Vi(x, u)>0 forx, u≠0andVi(x, u)=0 forx, u=0 for the ith event, complete Lyapunov function defined by Eq. (19)V(x, u)>0 forx, u≠0andV(x, u)=0 forx, u=0.(20)V˙(x,u)=dV(x,u)dt=ddt∑i=1saiVi(x,u)=ai∑i=1sddtVi(x,u)=ai∑i=1sV˙i(x,u)From Theorem 1 as a local Lyapunov function for ith linearized model isV˙i(x,u)≤0the global Lyapunov function is alsoV˙i(x,u)≤0as ai∈{0,1}. Hence, from the Lyapunov stability theorem there exist optimal control input vector u which will stabilize the HDS has given in Eq. (1).In this section, simulation experiments to show the effectiveness of the proposed eventwise linearize model based optimal control approach on benchmark systems often used in the literature. The performance of the proposed control scheme is assessed using regulating and tracking control responses.A schematic of the single tank HDS is shown in Fig. 1, whose modeling has been reported in literature [8,29].In the single tank HDS, the input flow rate is denoted by u and output flow rate is denoted by q. The nonlinearity results from the relationship between the output flow rate q and the level of the tank h. The system has state hybrid nature due to an area of the tank change according as the level inside the tank crosses 0.3m. The Mass balance and Bernoulli law for the single tank HDS is given by Eqs. (21) and (22):(21)Adhdt=u−k2ghifh<0.3(22)3Adhdt=u−k2ghifh≥0.3where, A=0.0154m2 is the cross-section area of the tank and k=2×10−4m2 is the cross-section of the outlet hole and g=9.18m/s2 is the gravity constant. A hybrid automaton of the given single tank system is shown in Fig. 2.In this hybrid system discrete state event occurs due to the level of the water inside the tank move the continuous nonlinear dynamics from one location to the other. For the estimation of the discrete event the data set of 1000 samples was generated. This data set is used to estimate the number of discrete events and operating point for event wise linearization. The data set was obtained by sampling time Ts=1s with random input flow rate between 0 and 0.001m3/s. The generated level signal along with an input flow rate is shown in Fig. 3(a) and (b).Proposed methods for estimation of the discrete event is applied on the data setw(t)={h(t),u(t)}t=11000with m=2, ɛ=0.00001 and smax=10. From the proposed steps in Section 2.1, the value of the validity index ρ(C,U) for different values of the cluster center shown in Fig. 4. From the result, the number of discrete events present in the given single tank HDS are two which is matched with the actual number of events. Once the number of discrete events is obtained, the operating points are selected using the FCM clustering algorithm. The two dimensions result of the FCM clustering is shown in Fig. 4 along with the operating points for each event. In the Fig. 5, □ and O symbols indicate the location of operating points for the h<0.3 and h≥0.3 discrete events, respectively.Obtained event wise operating points for linearization are:(i)Model-I:(ho1, uo1)=(0.2569, 0.0004179)Model-II:(ho2, uo2)=(0.3382, 0.0005296)Model-I corresponds to a level below the 0.3m while Model-II corresponds to a level above the 0.3m.Now to find linearized Model-I, Eq. (21) is linearized using Taylor series first order approximation around the operating points (ho1, uo1) as:(23)dhdt=h˙=12A2u−kh12gho1−k2gho1Put steady state operating point value h=ho1, u=uo1 andh˙=h˙o1=0in Eq. (21) and hence it reduces to(24)h˙o1=0=1A(uo1−k2gho1)Now, subtract Eq. (24) from Eq. (23) reduce the given nonlinear equation in Eq. (17) in the form as below:(25)h˙−h˙o1=1A−kg2ho1(h−ho1)+(u−uo1)The above equation can be represented as a linearized form given in Eq. (9) by substitutingδh˙=h˙−h˙o1and δu=u−uo1 in Eq. (25)(26)δh˙=A1δh+B1δuwhereA1=−(k/A)(g/2ho1)and B1=1/A. Eq. (26) shows the linearized Model-I around the operating point where level is less than 0.3m.Once the linearized model of the HDS for I-th event is obtained, we can move on to establishing the input matrix for state feedback control with cost function as:(27)J1(h,u)=∫t∞(hTQ1h+uTR1u)dτwhereQ1=Q1T≥0andR1=R1T>0are chosen as positive definite symmetric states and inputs weighting matrices, respectively. To find the optimal control input flow rate for Model-I assume that there exist a quadratic cost function for I-th event V1(h,u):(28)V1(h,u)=hTQ1h+uTR1uNow, according to HJB solution for Eqs. (27) and (28) optimal control input must satisfy the equation(29)minu(t)∈RmhTQ1h+uTR1u+∂V1∂hT(A1δh+B1δu)=0(30)V˙1(h,u)=∂V1∂hT1A(u−k2gh)=∂V1∂hT1A−kg2ho1(h−ho1)+(u−uo1)+1A(u−k2gh)−1A−kg2ho1(h−ho1)−(u−uo1)=∂V1∂hT1A−kg2ho1(h−ho1)+(u−uo1)When hTQ1h+uTR1u+(∂V1/∂h)T(A1δh+B1δu)=0, put in above Eq. (30)(31)V˙1(h,u)=−hTQ1h−uTR1u≤0Therefore, as from the Lyapunov stability theorem and Theorem 1 the optimal control input is(32)u=−12R1−1B1T∂V1∂hNow to find linearized Model-II, Eq. (22) is linearized using Taylor series first order approximation around the operating points (ho2, uo2) as:(33)dhdt=h˙=16A2u−kh2gho2−k2gho2Put steady state operating point value h=ho2, u=uo2 andh˙=h˙o2=0in Eq. (22) and hence its reduces to(34)h˙o2=0=13A(uo2−k2gho2)Now, subtract Eq. (34) from Eq. (33) reduce the given nonlinear equation in Eq. (22) in the form as below:(35)h˙−h˙o2=13A−kg2ho2(h−ho2)+(u−uo2)The above equation can be represented as a linearized form given in Eq. (9) by substitutingδh˙=h˙−h˙o2and δu2=u−uo2 in Eq. (35)(36)δh˙=A2δh+B2δuwhereA2=−(k/3A)(g/2ho2)and B2=1/3A. Eq. (48) shows the linearized Model-II around the operating point where level is more than 0.3m.As the linearized model for II-th event is obtained, now to find the input matrix for state feedback control with objective cost function as:(37)J2(h,u)=∫t∞(hTQ2h+uTR2u)dτwhereQ2=Q2T≥0andR2=R2T>0are chosen as positive definite symmetric states and inputs weighting matrices, respectively. To find the optimal control input flow rate for Model-II assumes that there exist a quadratic cost function for II-th event V2(x,u):(38)V2(h,u)=hTQ2h+uTR2uNow, from HJB solution for Eqs. (37) and (38) optimal control input matrix must satisfy the equation(39)minu(t)∈RmhTQ2h+uTR2u+∂V2∂hT(A2δh+B2δu)=0(40)V˙2(h,u)=∂V2∂hT13A(u−k2gh)=∂V2∂hT13A−kg2ho2(h−ho2)+(u−uo2)+13A(u−k2gh)−13A−kg2ho2(h−ho2)−(u−uo2)=∂V2∂hT1A3−kg2ho2(h−ho2)+(u−uo2)When hTQ2h+uTR2u+(∂V2/∂h)T(A2δh+B2δu)=0, put in above Eq. (40)(41)V˙2(h,u)=−hTQ2h−uTR2u≤0From the Lyapunov stability theorem and Theorem 1 the optimal control input is(42)u=−12R2−1B2T∂V2∂hThe Lyapunov function for the complete single tank HDS including both events as(43)V(h,u)=α1V1(h,u)+α2V2(h,u)As from Eqs. (43) and (53) Lyapunov functionV˙1(x,u)≤0andV˙2(x,u)≤0for the respective events, then complete Liapunov function for the single tank HDS isV˙(h,u)≤0. From the Theorem 2, there exists an optimal control input vector u such that it stabilizes the entire single tank HDS.Now, closed loop simulation studies have been carried out on the single tank HDS to demonstrate the proposed optimal control approach to regulate the states of systems from any initial value to zero stationary point. The state and input weighting matrices for both the discrete events are selected as follows:Model-I:Q1=1×10−5×I1×1andR1=1.5×I1×1Model-II:Q2=1×10−5×I1×1andR2=0.3×I1×1We have assumed that h(0)=0.5m at t=0. Fig. 6(a) shows variation in level. It has been observed that the level converges to the equilibrium point. Variations in control effort are shown in Fig. 6(b). From Fig. 6(c) and (d), it can be observed thatV˙(x,u)≤0andV˙(x,u)≤0for all the value of level, which ensure It shows the solution of HJB equation stabilize the single tank HDS.In order to check the tracking performance of the proposed approach in performance cost function Eqs. (27) and (37) the deviation of the tank level h from the desired reference level hris considered and given byJ1(e,u)=∫t∞(eTQ1e+uTR1u)dτJ2(e,u)=∫t∞(eTQ2e+uTR2u)dτwhere e=h=hr. The value of the states and inputs weighting matrices asModel-I:Q1=1×10−5×I2×2andR1=1.5×I1×1Model-II:Q2=1×10−5×I2×2andR2=0.3×I1×1In Fig. 7(a), the reference level signal is shown along with the actual level response of the single tank HDS. Variations in controller effort as input flow rate are shown in Fig. 7(b). Corresponding evaluated complete Lyapunov function and its derivative for all values of level are shown in Fig. 7(c) and (d). It can be observed that the solution of the HJB equation for tracking problem, stabilize the single tank HDS. A comparison of the proposed eventwise optimal control approach based level response with the single event Model-I and Model-II based optimal control based level responses are shown in Fig. 8(a). In (a), the red line indicates the reference level hr, the blue solid line indicates obtained response of level inside the tank and control input flow rate using proposed eventwise optimal control approach, the blue dash line indicates the height of tank and control input response using only Model-I based optimal control and the blue dot line indicates the height of tank and control input response using Model-II based optimal control. The responses show that the proposed approach provides good tracking response as compared to single model based response.We will demonstrate proposed modeling and control approach efficiency by a linear spring mass damper mechanical HDS [32]. In Fig. 9, an input force u(t) is applied on the mass m to move it from its initial position to new displacement z. It is assumed that two discrete modes present in this system as the friction co-efficient f changes from f1 to f2 as the magnitude of velocity more than Vs. Take m=2.5kg is the mass of mechanical system, k=1N/m is the stiffness constant of the system and the friction coefficients are f1=1.2Ns/m and f2=0.0012Ns/m for simulation purpose.The differential equation of motion with respect to applied input force u(t) in Mode-I given by(44)Mode-I:mz¨(t)+f1z˙(t)+kz(t)=u(t)for|v(t)|<VsAnd the differential equation of motion of the system in Mode-II is given by(45)Mode-II:mz¨(t)+f2z˙(t)+kz(t)=u(t)for|v(t)|≥VsThus, the system transition from Mode-I to Mode-II will occur when the magnitude of the velocity|v(t)|≥VsAnd the transition from Mode-II to Mode-I will occur when|v(t)|≥Vs. It is assumed that the switch magnitude of velocity Vsis 0.3m/s. The velocity function of the given system in terms of potion is defined as(46)v(t)=dz(t)dtwhere, Mode-I and Mode-II is separable by the sign ofv2(t)−Vs2which has nonlinear discriminant separation of the region. The Mode-II is divided into two Submode-IIa and IIb for positive and negative sign of the separation region, respectively. It is assumed all the springs and dashpots are linear and both the displacement z(t) and velocity v(t) are available as output y(t). There are two state variables present in the given system and denoted by(47)x=x1x2=zz˙The equation of the motion given in Eqs. (44) and (45) can be re-written in terms of state variable form as(48)Mode-I:x˙1x˙2=01−km−f1mx1x2+01mu=A1x+B1u(49)Mode-II:x˙1x˙2=01−km−f2mx1x2+01mu=A2x+B2uNow, to find number of discrete events present in the given system, input-output data set was obtained for 1000s by applying a pseudorandom binary input signal u(t) between [−11] such that both the modes of the mechanical HDS are excited. The obtained position and velocity responses are shown along with applied input force in Fig. 10(a)–(c). Now, proposed methods for estimation of the discrete events is applied on the data setw(t)={yt,u(t)}t=11000with m=2, ɛ=0.00001 and smax=10. The obtained validity index ρ(C,U) for the different values of cluster center using proposed steps in Section 2.1 is shown in Fig. 11. From the result, the number of discrete events present in the given mechanical HDS is three which is matched with the actual number of discrete events. Now, FCM clustering algorithms used to obtain the operating points for each discrete event. The two dimensions result of the FCM clustering is shown in Fig. 12along with the operating points for each event. In the Fig. 12, the symbol □, O and + indicate the location of operating points for the Mode-I, Submode-IIa and Submode-IIb, respectively.Obtained event wise operating points for linearization are:(i)Mode-I:(zo1,z˙o1,uo1)=(0.0918,0.0924,0.0725)Submode-IIa:(zo2a,z˙o2a,uo2a)=(1.0050,1.0038,0.7144)Submode-IIb:(zo2b,z˙o2b,uo2b)=(−0.5696,−0.5665,−0.44010)Now, find a linearized model for Mode-I using Taylor series first order approximation of Eq. (44) in terms of deviation state variables form. Obtained equation of motion in Mode-I is(50)δx˙1δx˙2=01−km−f1mδx1δx2+01mδu=A1δx+B1δuwhereδx1=z−z˙o1.,δx2=z˙−z˙o1and δu=u−uo1. Now, find the input force matrix for state feedback control of Mode-I with objective function defined as:(51)J1(x,u)=∫t∞(xTQ1x+uTR1u)dτwhereQ1=Q1T≥0andR1=R1T>0are chosen as positive definite symmetric states and inputs weighting matrices, respectively. To find the optimal control input flow rate for Mode-I assume that there exists a quadratic cost function V1(x,u):(52)V1(x,u)=xTQ1x+uTR1uNow, to obtained optimal control input force matrix using HJB solution for Eqs. (51) and (52) must satisfy the equation(53)minu(t)∈RmxTQ1x+xTR1x+∂V1∂xT(A1δx+B1δu)=0A derivative of Liapunov function given in Eq. (52) with respect to state variable given by(54)V˙1(x,u)=∂V1∂xT[A1x+B1u]=∂V1∂xT[A1δx+B1δu+A1x01+B1u01]where x01 indicate the operating point state vector whose elements is operating points of state variables in Mode-I. In Eq. (48) put value of operating points x=x01, u=u01 andx˙=x˙01, Eq. (54) reduce to(55)V˙1(x,u)=∂V1∂xT[A1δx+B1δu+x˙01]Hence, It is assumed that x01 is the steady state operating point such that x01=0. As from Eq. (53),xTQ1x+uTR1u+∂V1∂xT(A1δx+B1δu)=0, derivative of Lyapunov function will be(56)V˙1(x,u)=−xTQ1x−uTR1u≤0From the Lyapunov stability theorem and Theorem 1 the optimal control input force in Mode-I is(57)u=−12R1−1B1T∂V1∂xAs Mode-II divided in two submodes but the parameters for both the submodes are same, so we can find a linearized model for either of the operating points of Submode-IIa or Submode-IIb. From the Taylor series first order approximation of Eq. (45) in terms of deviation state variables around the operating point of Submode-IIa derived as(58)δx˙1δx˙2=01−km−f2mδx1δx2+01mδu=A2δx+B2δuwhere δx1=z−zo2a,δx2=z˙−z˙o2aand δu=u−uo2a. Now, find the input force matrix for state feedback control of Mode-II and objective function defined as:(59)J2(x,u)=∫T∞(xTQ2x+uTR2u)dτwhereQ2=Q2T≥0andR2=R2T>0are chosen as positive definite symmetric states and input weighting matrices, respectively. It is assumed that there exists a quadratic cost function V2(x,u):(60)V2(x,u)=xTQ2x+uTR2uUsing HJB solution obtained optimal control input force matrix for Eqs. (59) and (60) which must satisfy the equation(61)minu(t)∈RmxTQ2x+xTR2x+∂V2∂xT(A2δx+B2δu)=0(62)V˙2(x,u)=∂V2∂xT[A2x+B2u]=∂V2∂xT[A2δx+B2δu+A2x02a+B2u02a]where x02aindicate the operating point state vector whose elements is operating points derived for Submode-IIa. As in Eq. (49) substitute x=x02a, u=u02aandx˙=x˙02a, Eq. (62) reduce to(63)V˙2(x,u)=∂V2∂xT[A2δx+B2δu+x˙02a]Hence, it is assumed that x02ais the steady state operating point such thatx˙02a=0. From Eq. (61),xTQ1x+uTR1u+∂V1∂xT(A1δx+B1δu)=0, derivative ofV˙2(x,u)will be(64)V˙2(x,u)=−xTQ2x−xTR2x≤0As from the Lyapunov stability theorem and Theorem 1 the optimal control input force in Mode-IIa is(65)u=−12R2−1B2T∂V2∂xAs the parameter of the both the Submode-IIa and Submode-IIb are same the Lyapunov functions are same. It is assumed that for Submode-IIb Lyapunov function V3(x, u)=V2(x, u). The complete Lyapunov function for the mechanical HDS defined as(66)V(x,u)=α1V1(x,u)+α2V2(x,u)+α3V2(x,u)From the derived Eqs. (56) and (64) Lyapunov functionV˙1(x,u)≤0,V˙2(x,u)≤0andV˙3(x,u)≤0for the respective event complete Lyapunov function for the mechanical HDS isV˙(x,u)≤0. From the Theorem 2, there exists an optimal control input force vector u such that it stabilizes the mechanical HDS has given in Fig. 10.Now, to regulate the mechanical HDS using proposed optimal control approach from given value x(0) to zero the states and inputs weighting matrices are selected as follows:Mode-I:Q1=0.1×I2×2andR1=1×I1×1Mode-IIa&Mode-IIb:Q2=0.1×I2×2andR2=1×I1×1We have assumed that initial value of z(0)=0.5m andv(0)=0.5m/s. From Fig. 13(a), it can be observed that both the states converge to the zero equilibrium position. The corresponding controller action is shown in Fig. 13(b). The derived values of the Lyapunov function and its derivative is shown in Fig. 13(c) and (d) which ensure the closed loop stability of the system. The corresponding phase plane trajectory of both the state variables is shown in Fig. 14. It shows variation in all the states of mechanical HDS converge to zero equilibrium position.The tracking performance of the proposed eventwise optimal control approach with performance cost function is given byJ1(e,u)=∫t∞(eTQ1e+uTR1u)dτJ2(e,u)=∫t∞(eTQ2e+uTR2u)dτwhere deviation in terms of state vector e=x−xr, xrconsists of desired state of state variables. The desired position for the tracking problem is assumed zrand corresponding desired velocity is assumed to be zero. For the simulation result value of the states and inputs weighting matrices selected asMode-I:Q1=0.1×I3×3andR1=1×I1×1Mode-IIa&Mode-IIb:Q2=0.1×I3×3andR2=1×I1×1The tracking response of all the states of the mechanical HDS is shown in Fig. 15(a). It can be observed that designed eventwise optimal control law solution able to track the reference trajectory satisfactory. The variation in the control effort in terms of the applied force is shown in Fig. 15(b). From Fig. 15(c) and (d), it can be observed that corresponding variations in Lyapunov function V(x, u)≥0 andV˙(x,u)≤0for all the values of state variables. Results show that obtained state variable responses converges to the desired trajectory and ensures stabilized optimal control for the mechanical HDS. A comparative simulation study of the proposed event wise stabilized optimal control approach with the single event using Mode-I and Mode-II based optimal control is shown in Fig. 16. The setpoint tracking results of all the states are shown in Fig. 16(a) with event wise multiple model and single Mode-I and Mode-II along with the reference trajectory of position. In Fig. 16(b) corresponding controller efforts using all three optimal control approach are shown. The responses show that the proposed eventwise optimal control approach provides good tracking response as compared to single model based response for the mechanical HDS.

@&#CONCLUSIONS@&#
The contribution of this paper is a framework for designing optimal controllers for HDS along with cluster validation based selection of number of discrete event. The framework uses event wise partially linearized model structure to represent HDS. In this work, a systematic cluster validation approach is presented to address the issues of determining the number of discrete events that must be spanned entire HDS. The issues related to selection of operating points according to discrete events are also presented by used of clusering method. In addition, to this approach is systematic and involves less parameters to be specified as compare to parameters required in [12]. For optimal control law design the HJB solution has been adopted. In particular, the Lyapunov quadratic function which is the solution of the HJB equation for the event wise linearized model guaranteeing the stability of the system.The proposed modeling and control approach is validated through two simulation experiments. The results of validity index show that framework accurately finds the number of multiple model present in the HDS. The regulatory and tracking responses show that the performance of proposed control law along with the stability of the system. The tracking results show that the proposed multiple model based control law able to track the reference trajectory efficiently as compare to single model based control law. To validate control performance on hardware and apply robust control algorithm [33] are considered as a future research in the area of controlling of the HDS.