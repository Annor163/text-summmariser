@&#MAIN-TITLE@&#
Improvement of automated image stitching system for DR X-ray images

@&#HIGHLIGHTS@&#
A new stitching method was proposed for X-ray images of full-spine and lower limb.The multi-time phase correlation solves the problem of inaccuracy of overlapping region.The overlapping region is less than 30% that can also be stitching successfully.It can tackle problem as image translation and rotation.The proposed method has a higher accuracy and a shorter average stitching time compared with previous methods.

@&#KEYPHRASES@&#
X-ray images,Improved phase correlation,Automated stitching,Fast automated stitching of spine,Digital detection imaging,

@&#ABSTRACT@&#
The full bone structure of X-ray images cannot be captured in a single scan with Digital radiography (DR) system. The stitching method of X-ray images is very important for scoliosis or lower limb malformation diagnosing and pre-surgical planning. Based on the image registration technology, this paper proposes a new automated image stitching method for full-spine and lower limb X-ray images. The stitching method utilized down-sampling to decrease the size of image and reduce the amount of computation; improved phase correlation algorithm was adopted to find the overlapping region; correlation coefficient was used to evaluate the similarity of overlapping region; weighted blending is brought in to produce a panorama image. The performance of the proposed method was evaluated by 40 pairs of images from patients with scoliosis or lower limb malformation. The stitching method was fully automated without any user input required. The experimental results were compared with previous methods by analyzing the same database. It is demonstrated that the improved phase correlation has higher accuracy and shorter average stitching time than previous methods. It could tackle problems including image translation, rotation and small overlapping in image stitching.

@&#INTRODUCTION@&#
In the clinical diagnosis, it is often necessary to produceÂ panoramic X-ray images with the purpose of observing the full bone structure of the patient, such as full-spine and lower limb. However, the existing Digital radiography (DR) system can only image part of the structure in a single scan; it is important to stitch several radiographs into a panoramic image. Currently, the commonly used technology in image stitching is based on grids [1], in which the grids are attached to the image detector. The images acquired by this method are shaded by the grids, which may misinform the doctors with their observation and diagnosis results, or even lead to misdiagnosis. Another stitching method is on account of exterior characteristic [2], by which markers are set on CR cassettes and then the overlapping area of the two images are marked. Though this method is simple, it is not applicable for DR X-ray equipments. In addition to that, there are some stitching methods based on X-ray ruler [3,4], which is placed along the edges and is parallel to the bones. All of this kind of methods depend on X-ray ruler which could affect observation and diagnosis. Parallax-free long bone stitching method was proposed by Wang and Traub [5] using a C-arm rotating around its X-ray source. This method can generate a parallax-free panoramic X-ray image without the requirement of any overlapping in the X-ray images. However, the method is based on C-arm system and needs a planar marker pattern. In other words, it is not applicable for CR systems.Recently, many researchers use stitching software to stitch X-ray images of chest [6] or use template matching [7]; it is slow and not applicable for full-spine or leg. Grieser et al. [8] also adopt image stitching program to stitch full-spine images and a significant blending line in images was produced which could lead to false diagnosis. Supakul et al. [9] take on metallic ruler as a marker and Philips software to stitch the images, whereas this method does not improve the performance of image stitching for full-spine X-ray images, and stitching software results in assessed anatomical errors in digitally stitched scoliosis films. Apart from stitching software, Kumar et al. [10] propose a stitching method for X-ray images using histogram matching and mutual information, the problem is that their technique has increased complexity and does not satisfy rotation invariant. Samsudin et al. [11] bring in minimum average correlation energy filters to identify and merge pairs of X-ray images of hand. They claim that their proposed method outperforms the normalized cross-correlation (NCC) method [12] in classifying and merging the overlapping and non-overlapping medical images, but their method needs overlapping area between adjacent images not less than 30% for stitching and the experiment images are hand X-ray medical images. Therefore, their performance of stitching of full-spine X-ray images needs further verification.Phase correlation is a fast method for image registration which combines Fourier transform and cross-power spectrum to estimate the relative translation between two images with overlapping region [13]. The phase correlation method is resilient to noise and can be extended to determine rotation and scaling differences between two images by converting the images to log-polar coordinates, where the rotation and scaling parameters can be measured in a manner invariant to translation [14,15]. However, the Fourier transform assumes a periodic function and the image will be truncated which will impair the performance of the method. It is important to employ a window function, like the Hanning window, during the Fourier transform to reduce edge effects [16].Correlation coefficient (CC) has been used widely in medical images registration as template matching techniques [17]. The CC value is always in the range [0,1] which denotes the similarity between two images. It can cope with noisy images and change the brightness of objects [18].On account of phase correlation and CC, we propose an X-ray images stitching method for full-spine and lower limb. The proposed algorithm employs phase correlation several times to find overlapping region in two X-ray images, and CC is used to determine the similarity of overlapping region, then the two images will be blended seamlessly by the weighted blending algorithm to produce a panorama image. In the experiment, the overlapping region of all images ranges from 16% to 32%. Our method is relatively stable with high accuracy. The main algorithm accompanied with its performance will be presented and discussed in the following sections.

@&#CONCLUSIONS@&#
This paper proposes an automated image stitching technique with the ability of stitching full-spine and lower limb X-ray images. During the image registration stage, improved phase correlation algorithm is adopted to determine the best-matched position. Compared with previous methods, our proposed technology can tackle translation and rotation problems in the image. Even the reference image only has an overlapping region with the size of 16% to the original image, the proposed method can accomplish the stitching successfully. The average stitching time is decreased by down-sampling with sampling factor K. Those preprocessed methods would enhance the precision of peak value position of phase correlation algorithm. The results show that the proposed method has a high accuracy of 90% in image stitching while previous methods have an accuracy of 80% in comparison. According to the experimental results and performance evaluation, the proposed algorithm is simple, fast, and with high accuracy for full-spine and lower limb X-ray images. The best-matched position maybe acquired by using the algorithm once. Despite the success of the proposed method in stitching X-ray images, there may be some cases, such as the significant exposure differences, which would cause failure in detecting overlapping region. To overcome these difficulties, histogram matching or window function can be used before the phase correlation. In addition, the patient should hold breath during the image acquisition stage in order to achieve higher accuracy when the machine scans quickly.None declared.