@&#MAIN-TITLE@&#
Using proportional navigation and a particle swarm optimization algorithm to design a dual mode guidance

@&#HIGHLIGHTS@&#
A dual mode guidance is developed for solve nonlinear missile guidance problem.Switch Law for detecting and switching from PNG to the IPSOG is also presented.PN-IPSOG has good guidance performance in miss distance and lateral accelerations.

@&#KEYPHRASES@&#
Proportional navigation (PN),Particle swarm optimization (PSO),Improved PSO guidance (IPSOG),Line-of-sight (LOS),Guidance law,Missile,

@&#ABSTRACT@&#
Graphical abstractImage, graphical abstract

@&#INTRODUCTION@&#
Missiles have become important in combat and during the writing of this paper many missile guidance laws were researched. These included proportional navigation (PN) guidance [1], ideal proportional navigation (IPN) guidance [2], and pure proportional navigation (PPN) guidance [3]. With the spread of artificial intelligence (AI) and machine learning, intelligent missile guidance is becoming more widespread. For example, Dalton et al. [4] designed a neural network controller which used the notion of an adaptive critic to solve the pursuit-evasion problem. Lin [5] proposed a fuzzy logic based missile terminal guidance in which the fuzzy rule was based on the line-of-sight (LOS) rate, LOS angular acceleration and relative distance. Li et al. [6] developed a fuzzy logic guidance based on PN guidance, and utilized a genetic algorithm to optimize the fuzzy rule base.In 2013, particle swarm optimization guidance (PSOG) was proposed by Kung et al. [7], and made its debut in the missile guidance field. The PSOG was based on a particle swarm optimization (PSO) algorithm, and optimized the lateral acceleration at each time-step. Afterward, the performance was improved by Chen et al. [8], which is called the improved PSOG (IPSOG). The concept was that the LOS rate is close to zero at each time-step. In other words, the IPSOG was similar to parallel navigation. The IPSOG has the advantages of a robustness and fast reaction; however, the lateral acceleration has severe variations in the initial phase. The attitude of a missile does not only become unstable, but also affects the structure. As for PN guidance, the lateral acceleration had a slight variation in the initial phase. In the terminal phase, it usually varied with a target's maneuvering. Thus, miss distance (MD) might not only be greater, but the final lateral acceleration also might fall in saturation.In this paper, we propose a dual mode guidance, which is called the PN-IPSOG. The concept is derived from the guidance method of a medium-range missile. In the initial phase, the lateral acceleration is given by the PN guidance. Meanwhile, the switch law (SL) is used to detect the switch timing. When the switch timing arrives, the PN-IPSOG would switch from the PN guidance to the IPSOG. We expect that the PN-IPSOG will not only maintain the advantages of the IPSOG, but will also take the advantages of the PN guidance to replace the disadvantages of the IPSOG.This paper is organized as follows: Section 2 gives mathematical models; Section 3 describes the PN guidance, the IPSOG, and the details of the SL; simulation experiments are shown in Section 4; Finally, Section 5 is the conclusion.Fig. 1shows the aerodynamic vectors of a missile. The equations of a missile dynamic [9] are as follows:(1)x˙m=Vmcosγmcosψm(2)y˙m=Vmcosγmsinψm(3)z˙m=Vmsinγm(4)V˙m=Tm−Dmmm−gsinγm(5)γ˙m=ap−gcosγmVm(6)ψ˙m=ayVmcosγm(7)a˙p=apc−apτm(8)a˙y=ayc−ayτm(9)Dm=k1Vm2+k2apc2+ayc2Vm2where xm, ym, zmare x-, y-, z-coordinates, respectively; γmand ψmare the flight path angle and the azimuth angle, respectively; Vm, Tm, Dm, and mmare the velocity, the thrust, the drag, and the mass, respectively; τmis a time constant; Both k1 and k2 are the drag coefficients; apcand aycare the lateral accelerations of the y- and z-axis, respectively; g is the gravity force.Fig. 2shows the aerodynamic vectors of a target. The equations of a target dynamic [10] are as follows:(10)x˙t=Vtcosγtcosψt(11)y˙t=Vtcosγtsinψt(12)z˙t=Vtsinγt(13)V˙t=g(nx−sinγt)(14)γ˙t=gVt(nzcosnϕ−cosγt)(15)ψ˙t=gnzsinnϕVtcosγtwhere xt, yt, ztare x-, y-, z-coordinates, respectively; Vtis the velocity; γtand ψtare the flight path and the azimuth angle, respectively; nx, nz, and nϕare the three variables which can be transformed into the thrust, the pitch force, and the rolling angle, respectively.Due to the inertia factor, the dynamic delay model for the three variables (nx, nz, and nϕ) are as follows:(16)nx=nxc1+τts(17)nz=nzc1+τts(18)nϕ=ωn2s2+2ωnξs+ωn2×nϕcwhere nxc, nzc, and nϕcare the command variables of the thrust, the pitch force, and the rolling angle, respectively; τtis a time constant; ωnis the natural frequency; ξ is the damping ratio.In this section, we introduce PN guidance and the IPSOG. We also explain details of the SL, and the whole flow chart is given as Fig. 4.The technique of PN guidance is that the lateral acceleration is proportional to the LOS rate. Until recent years, PN guidance is still in use since it is simple to implement. Generally, the equations [11] of the PN guidance are as follows:(19)apc=NpVmϕ˙+gcosγm(20)ayc=NyVmθ˙where Npand Nyare two navigation constants;ϕ˙andθ˙are the vertical and the horizontal of the LOS rate, respectively.PSO algorithm that was presented by Kennedy et al. [12] in 1995 were widely used to solve the optimization problem. The concept was that the social foraging behavior of a bird swarm is affected by the experience of an individual bird and bird swarm. Here, an individual bird is regarded as an individual particle in the PSO algorithm.Generally, a particle has two components. One of the two components was a candidate solution which is called the “position”. Another was a mutation value (or evaluation value) which is called the “velocity”. The evaluation function would evaluate the fitness value from the candidate solution. TypicalEqs. (21) and (22)[13] of the PSO algorithm then calculates the particle's “velocity” and updates the particle's “position”, respectively.(21)Vi,j=wPSOVi,j+c1rand1(Pbesti,j−Xi,j)+c2rand2(Gbesti−Xi,j)(22)Xi,j=Xi,j+Vi,jwhere Vi, jis a particle's velocity; wPSO is an inertial weight which represents a confidence of the current velocity; Both c1 and c2 are two positive constants which represent two confidences of an individual particle's and particle swarm's experience; Both rand1 and rand2 are two random values between zero and one; Pbesti, jis a best experience of individual particle; Gbestiis a best experience of the particle swarm; Xi, jis a particle's position; the subscript i is a generation number; the subscript j is a number of a particle in the particle swarm.The IPSOG, which is based on a PSO algorithm and the concept of parallel navigation, is one kind of intelligent missile guidance. The implementation steps were as follows:Step 1. Preset the parameters of the PSO algorithm, including wPSO, c1, c2, V1, j, the maximum generation number imax , the swarm size n, the best fitness value of the individual particle PbestJ1, j, and the best fitness value of the particle swarm GbestJ1.Step 2. Let X1, jbe a set of the lateral accelerations of the y- and z-axis. The X1, jis initialized within a random distribution, and is distributed in four-quadrants. The boundary is limited within the acceleration extremum amax .Step 3. Let the apcand aycbe equal to the set of Xi, j. The apcand aycthen substituted intoEqs. (1)–(9), and can be solved by the Runge–Kutta method. Thus, Xi, jcan be converted to the missile's dynamic.Step 4. A LOS is a virtual straight line between a missile and a target. The LOS rate is the rotation rate of the LOS. In the IPSOG, an objective value is a LOS rate. The Eqs. (23) and (24) [14] are utilized to calculate LOS rates.(23)ϕ˙i,j=z˙ri,j(xri,j2+yri,j2+zri,j2)−zi,j(xri,jx˙ri,j+yri,jy˙ri,j+zri,jz˙ri,j)xri,j2+yri,j2(xri,j2+yri,j2+zri,j2)(24)θ˙i,j=xri,jy˙ri,j−x˙ri,jyri,jxri,j2+yri,j2where xri, j, yri, j, and zri, jare the relative distances of x-, y-, and z-axis between a missile and a target, respectively;ϕ˙i,jandθ˙i,jare the horizontal and the vertical LOS rate of the individual particle, respectively.Step 5. Based on parallel navigation, the lateral acceleration and the curvature of the missile's trajectory are smaller than others when each LOS is parallel to each other. In other words, theϕ˙i,jand theθ˙i,jshould be equal to zero at each time-step. According to above, the Eqs. (25)–(27) are used to evaluate if the Ji, jis equal to zero or not.(25)Ji,j=[|ϕ˙i,j||θ˙i,j|]T(26)Pbesti,j=Xi,j(min(Ji,j))andPbestJi,j=min(Ji,j),ifPbestJi,j>min(Ji,j)(27)Gbesti=Pbesti,j(min(PbestJi,j))andGbestJi=min(PbestJi,j),ifGbestJi>min(PbestJi,j)where Ji, jis a set of two fitness values; PbestJi, jis the best fitness value of the individual particle; Pbesti, jis redefined as the best lateral accelerations of the y- and z-axis of the individual particle; GbestJiis the best fitness value of the particle swarm; Gbestiis redefined as the best lateral accelerations of the y- and z-axis of the particle swarm.Step 6. Eq. (21) calculates Vi, j, and Eq. (22) then updates Xi, j.Step 7. Calculate the standard deviations of the particle swarm. If the standard deviations are greater than the tolerance or i equals to imax , output Gbesti. Otherwise, set i equal to i plus one, Vi, jequal toVi−1,j, Xi, jequal toXi−1,j, PbestJi, jequal toPbestJi−1,j, GbestJiequal toGbestJi−1, Pbesti, jequal toPbesti−1,j, and Gbestiequal toGbesti−1. Then return to Step 3.The concept is derived from the step-response of automatic control theory. Fig. 3a is a typical step-response of a 2nd order system. The other is the variation of the LOS rate of PN guidance. If we look at Fig. 3b, in the red frame, the variations of the angle μ that is between the tangent of the current LOS rate and the horizontal reference line are greater than the variations of another μ. This can be understood that the guidance law is still adjusting the missile's attitude. As time passes, the variation of μ trends to convergence. This can be understood as the adjustment of the missile's attitude is nearing completion. Soon afterwards, the variation of μ, in the green frame, is approaching a constant. If we look back at Fig. 3.a, a typical step response of a 2nd order system can be divided into two states. One of these is the steady-state where the output of a system arrives and stays in a specified value. The other is the settling-time where the output of a system does not satisfy the definition of a steady-state. In other words, the output of a system is still in adjustment. Through observing Fig. 3, we can understand that (b) is similar to (a). The red frame in Fig. 3.b presents a settling-time, and the green frame presents a steady-state. We utilize this viewpoint, that is, let the variation of the LOS rate be a step-response of a 2nd order system. Therefore, the switch timing is between the settling-time and the steady-state. In other words, it is the timing to switch from the PN guidance to the IPSOG when the adjustment of the missile's attitude nears completion. According to above, the PN-IPSOG utilizes the Eqs. (28)–(31), which is called the SL, to detect the switch timing, and switches from the PN guidance to the IPSOG.(28)μH=|tan−1(λ˙H−λ˙H−1ɛ)|(29){ac=aPN,ifmean([μHμH−1⋯μH−q])≤ηςstart=H&Eq.(30),ifmean([μHμH−1⋯μH−q])>η(30){{wReplace=P(H−ςstart)ac=aIPSOGwReplace+aPNG(1−wReplace),ifwReplace<1Eq.(31),ifwReplace≥1(31)ac=aIPSOGwhereλ˙is the LOS rate; ɛ is a time-step, and is defined as the horizontal reference line; aPNG are the lateral accelerations from the PN guidance; acare the lateral accelerations for a missile; η is a threshold; ςstart is a variable which is the switch timing; P is a constant; wReplaceis a weight; aIPSOG are the lateral accelerations from the IPSOG; Both H and subscript H are a number of iterations; the subscript q determines the amount of μ in a mean function.When the missile pursues a maneuvering target, the lateral accelerations are first given by the PN guidance. Meanwhile, Eq. (28) calculates μ at each time-step, and Eq. (29) detects the switch timing. When the switch timing arrives, ςstart equals H. In order to switch stably, Eq. (30) would be used to calculate the lateral accelerations. Next, the lateral accelerations are given by Eq. (31) when wReplaceis greater than one.Although the lateral accelerations of y- and z-axis use the same SL, detecting and switching process are carried out independently.The initial conditions are shown in Table 1. The parameters of the missile's dynamic are set as follows: Tm, mm, k1, and k2 refer to Kim and Kim [15]; Both Npand Nyrefer to Yanushevsky [16], and both are equal to 3. The parameters of the target's dynamic are set as follows [10]: ωnequals 10; ξ equals 0.7. The parameters of the IPSOG are set as follows: n equals 100; imax  equals 700; wPSO equals 0.5; Both c1 and c2 are equal 1; Both Xi, jand Vi, jare initialized randomly between amax ; The convergent tolerance equals10−2. Others are set as follows: Both τmand τtare equal 0.1; Hmax  equals 700; amax  equals ± 25g; η equals10−3; The subscript q equals 6. The simulation would stop at minimal MD.The three kinds of common evasion strategies are taken to verify the guidance performance of the PN-IPSOG. Evasion strategy 1 is a maximum g-force left turn flight, and the control variables are set as 0, 9, and π/2, respectively. Evasion strategy 2 is a maximum g-force S-curve maneuvering. The control variables are set as 0, 9, and π/2 in the first 5 seconds, and are set as 0, 9, and−π/2at other times. Evasion strategy 3 is a maximum g-force downward flight, and the control variables are set as 0, −3, and 0, respectively.The trajectories were illustrated in Figs. 5–7, and the variations of the lateral acceleration were illustrated in Fig. 8. The simulation results were summarized in Table 2–4.Although the time-to-go (Tgo) of the PN-IPSOG was the same as the PN guidance, the results indicated significant guidance performances, which the PN-IPSOG was better than the PN guidance, for the lateral acceleration at the final stage and the number of saturation. No significant guidance performances were found at MD and mean lateral acceleration; however, the PN-IPSOG was smaller than the PN guidance. On the other hand, the smaller MD in the PN-IPSOG showed that the PN-IPSOG had better accuracy than the PN guidance. The smaller lateral acceleration in the PN-IPSOG revealed that the PN-IPSOG reserved more kinetic energy than the PN guidance. Especially, compared the PN-IPSOG with the PN guidance, the lateral acceleration appeared to be very close to zero at the final stage. These might imply that the PN-IPSOG had the ability to pursue a high maneuvering target.The more detailed understanding of the variation of the lateral acceleration can be gained from Fig. 8. Two points are worth making about Fig. 8. In the initial and medium phases, which are during the first 9 seconds, the variation of the PN-IPSOG's lateral acceleration was similar to the PN guidance. The results were what were expected. In other words, the severe variation of the lateral acceleration of the IPSOG was improved by the PN guidance. After 9 seconds, which is the second point, the lateral acceleration of the PN guidance trended to saturation; however, the PN-IPSOG still kept a slight variation and trended to zero. These revealed that the PN-IPSOG had stable lateral acceleration, that is, the PN-IPSOG was not affected by the target's maneuvering. The saturation numbers were also consistent with this viewpoint in Tables 2–4. In addition, these might imply that the PN-IPSOG had better accuracy than the PN guidance. Furthermore, the PN-IPSOG was more stable than the PN guidance at the final stage.As a brief summary, the simulation results revealed that the PN-IPSOG had a better performance than the PN guidance at MD, and lateral acceleration.

@&#CONCLUSIONS@&#
