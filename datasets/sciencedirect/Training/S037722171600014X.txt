@&#MAIN-TITLE@&#
Optimal pipe-sizing problem of tree-shaped gas distribution networks

@&#HIGHLIGHTS@&#
Algorithm to minimize investment cost for tree-shaped gas distribution networks.Minimum cost obtained by converting the original tree into a single equivalent arc.Optimal continuous pipe diameters are converted to discrete approximate diameters.The algorithms are suitable for designing real gas distribution networks.

@&#KEYPHRASES@&#
OR in energy,Nonlinear programming,Heuristics,Gas distribution networks,

@&#ABSTRACT@&#
This study addresses the optimal pipe-sizing problem of a tree-shaped gas distribution network with a single supply source. An algorithm was developed with the aim of minimizing the investment for constructing a gas distribution network with a tree-shaped layout in which demands are fixed.The construction cost is known to depend on the pipe diameters used for each arc in the network. However, under the assumption that pipe diameters are continuous, we prove that it is possible to obtain the minimum construction cost directly and analytically by an iterating procedure that converts the original tree into a single equivalent arc. In addition, we also show that expanding the converted single arc inversely to the original tree computes the optimal continuous pipe diameter for each arc. Following this, we present an additional heuristic to convert optimal continuous pipe diameters into approximate discrete pipe diameters.The algorithms were evaluated by applying them to sample networks. The numerical results obtained by comparing the approximate discrete diameters with the optimal discrete diameters confirm the efficiency of our algorithms, thereby demonstrating their suitability for designing real gas distribution networks.

@&#INTRODUCTION@&#
Gas distribution network systems are widely used in major cities around the world. City gas systems in Japan currently consist of 246,147 kilometer (The Japan Gas Association, 2013) of pipes with a thickness of at least 50 millimeter to supply not only wholesale, but also retail customers, such as industrial, commercial, and residential consumers.The construction of a new distribution network is usually preceded by a process consisting of several phases; for example, De Corte and Sörensen (2013) identified four different phases for new water systems:1.Layout phase: define the structure of the network.Design phase: choose the type (diameter and material) of each pipe.Programming phase: set up a priority order for consumers.Planning phase: decide a daily operation.As gas supply systems have similar characteristics to water supply systems, these four phases would be equally applicable to gas supply systems.Based on the above process, the first phase of our optimization would require us to decide whether to use the layout shown in Fig. 1.1 or that in Fig. 1.2 when supplying gas from source node 1 to demand nodes 2--7. After deciding the layout, we would need to choose the pipe sizes in the design phase. This would require us to keep the following facts in mind. The gas pressure supplied at the source node drops as the distance to the demand nodes increases, because of the friction with the walls of the pipes. Furthermore, a reduction in the diameter of the pipes leads to a rapid decrease in pressure. Every gas utility has a duty to supply gas within a predetermined pressure range at each demand node. If gas utilities select pipes with larger diameters, they would be able to increase the pressure at each demand node, but this would increase the construction cost. Therefore, in the design phase, it would be necessary to select commercial pipe sizes such that the construction cost of the network is minimized, while ensuring that the required pressure bound is satisfied at each demand node. In this study, we refer to this problem as the optimal pipe-sizing problem of distribution networks (OPi).The problem OPi has been studied for over forty years, and during this time three types of diameters have been considered: (i) the discrete diameter, where a pipe consists of one commercially available diameter, (ii) the split-pipe diameter, where a pipe consists of different commercially available diameter segments that are serially connected, and (iii) the continuous diameter, where a pipe diameter is continuous. Note that the formulation of OPi is almost the same for gas and water distribution systems (Hansen, Madsen, & Nielsen, 1991). Earlier studies mostly assumed the split-pipe and continuous diameter types, for which a number of techniques were proposed by De Wolf and Smeers (1996), Hansen et al. (1991), Osiadacz and Gorecki (1995), and Wu, Lai, and Liu (2007) for gas supply systems, whereas reviews of previous studies of water supply systems were presented by Bhave (2003) and Mays (1989). In contrast, the problem of sizing with discrete diameters has mainly been addressed using meta-heuristic techniques. The interested reader is referred to De Corte and Sörensen (2013), Haghighi, Samani, and Samani (2011), Mora-Melia, Iglesias-Rey, Martinez-Solano, and Fuertes-Miquel (2013), and Sheikholeslami, Kaveh, Tahershamsi, and Talatahari (2014) for water supply systems. André, Bonnans, and Cornibert (2009) applied a branch and bound scheme to obtain the discrete diameters after they solved a continuous relaxation of the problem for gas transportation networks. In addition, Bragalli, D'Ambrosio, Lee, Lodi, and Toth (2012) applied the mixed integer linear programming (MILP) and nonlinear programming approach and Raghunathan (2013) applied a linearization-based approach for the mixed integer nonlinear programming (MINLP) problem after they showed that OPi for a discrete diameter was an MINLP problem. Note that OPi for the discrete diameter is NP-hard (Yates, Templeman, & Boffey, 1984). These studies were mainly devoted to solving networks that contain cycles, such as the network depicted in Fig. 1.1.On the other hand, in this paper, we focus on tree-shaped networks, such as that shown in Fig. 1.2. In general, layouts such as that shown in Fig. 1.2 are superior to that shown in Fig. 1.1 from the viewpoint of the construction cost. Bhaskaran and Salzborn (1979) actually proved that a cost-minimized layout requires a tree where the pipe diameter is continuous and the construction cost is proportional to the γ( < 8/3)-th power of the diameter. In reality, gas utilities design networks of this type (Ebrahimi, 2010 and Mohajeri, Mahdavi, Mahdavi-Amiri, & Tafazzoli, 2011). When Japanese gas utilities design a new medium-pressure gas distribution network (from 0.1 to 1 megapascal), the layout tends to be tree-shaped as customers are geographically dispersed. In addition, determining the layout and the pipe diameters for a network containing cycles, some researchers (Afshar, 2007, André et al., 2013, Bhave, 2003, Rothfarb, Frank, Rosenbaum, Steiglitz, & Kleitman, 1970, and Saleh & Tanyimboh, 2013) proposed a technique enumerating all spanning trees, including the source node and all the demand nodes, and computing a construction cost for each tree. Note that OPi for a tree-shaped network becomes an integer programming (IP) problem for the discrete diameter because the flow rate is computed for each pipe of a tree a priori, but it is still NP-hard (Yates et al., 1984). Therefore, it is necessary to develop an efficient method that determines optimal pipe sizing for a tree-shaped layout in short computational time and with high accuracy.Tree-shaped networks have previously been studied. One of these studies was conducted by Mohajeri et al. (2011), who applied the ant colony optimization to a discrete diameter pipe. Assuming the split-pipe diameter, Karmeli, Gadish, and Meyers (1968) showed that linear programming can be employed to determine a global optimal solution. Furthermore, assuming the continuous diameter, Deb (1974) showed that the problem can be expressed as a set of nonlinear simultaneous equations, whereas Fujiwara and Dey (1988) developed the Lagrange multiplier method in which each Lagrange multiplier can be obtained by using only arithmetic operations.In this paper, we propose efficient algorithms to solve the optimal pipe-sizing problem for the discrete diameter where the problem is given by a tree consisting of a single source node and a number of demand nodes. At first, under the assumption of continuous pipes, we directly calculate the minimum construction cost by iterating the contraction of the tree. We also present a computational algorithm to obtain the optimal continuous pipe diameter for each arc and the optimal pressure at each node by iterating the expansion to the original tree. Following this, we introduce a heuristic where we use the optimal continuous diameter to assign a discrete diameter for each pipe. Our solution methods do not require mathematical programming software and find optimal continuous diameters without computing Lagrange multipliers as in Fujiwara and Dey (1988).The remainder of this paper is organized as follows: Section 2 briefly states the optimal pipe-sizing problem for tree-shaped gas networks. Section 3 introduces the algorithm that obtains the minimum cost and optimal continuous diameters analytically where the diameters are continuous, and the heuristic that assigns the approximate discrete diameters. Our solution methods are applied to two sample networks to compare the optimal and approximate discrete diameters in terms of accuracy and computation time in Section 4. In the final section, we present a conclusion.Consider a situation, in the above-mentioned design phase, where a gas utility constructs a new distribution network to supply a number of customers from a single supply facility. The network is given by a tree-shaped layout, in which the customers and gas facility are represented by nodes and the pipes by arcs linking the nodes. The gas utility now wishes to select the commercial pipe diameter to minimize the construction cost, on the one hand, and by ensuring the required pressure bound for each customer, on the other.LetT=(N(T),A(T))be a tree with a node set N(T) and a directed arc set A(T). The nodes are divided into a single source node, demand, and junction nodes. Junction nodes are assigned to either branch or bend pipes at street corners because pipes are placed under the road.Let r ∈ N(T) be the single source node, which forms the root of the tree. Let δibe the demand corresponding to node i ∈ N(T)/{r}. δiis a non-negative constant and clearly δi> 0 for demand nodes andδi=0for junction nodes.Each arc (i, j) ∈ A(T) is characterized by the flow rate qij, diameter dij, and pipe length lijfrom node i to j. Directed arcs indicate the flow direction. Let Δjdenote the set of nodes consisting of j and its descendants. As a network is a tree, qijis a positive constant that can be computed asqij=∑k∈Δjδk. In addition, lijis a positive constant and dijis a decision variable.The pressure for each node is assumed as follows:(a)The pressure at the source node r is pmax.The pressure pifor i ∈ N(T)/{r} is not less than pmin.Here, pmax is either described in the terms and conditions of each local gas utility or decided as the physical upper bound of the pipes and pmin (pmin < pmax) is described in the terms and conditions. Gas utilities are duty-bound to supply gas within the range pmin ≤ pi≤ pmax to every customer.(c)The pressure drop (pi2−pj2) for (i, j) ∈ A(T) in a medium pressure gas distribution network is computed as(1)pi2−pj2=μlijqijαdijβ,∀(i,j)∈A(T),There exist three decision variables in (1), dij, pi, and pj, but we can eliminate piand pjby combining assumptions (a)–(c). Let V⊆N(T) be the set of leaves of T and Prvthe r-v-path from r to v ∈ V. For a tree-shaped network the r-v-path is unique. The supplied pressure pmax at r gradually decreases along the r-v-path, which means that the pressure at v is more than or equal to pmin as a result. Therefore, as an alternative way of stating (a)-(c) is that a decrease in the pressure drop from r to v ∈ V does not exceedpmax2−pmin2, Eq. (1) is rewritten as∑(i,j)∈A(Prv)μlijqijαdijβ≤πmax,∀v∈V,where we defineπmax=pmax2−pmin2(>0).Finally, we discuss the construction cost per unit length for (i, j) ∈ A(T), for which there are two models, (i)aijdij2+bijdij+eijand (ii)cijdijγ+eij, where cijis a positive constant, aijand eijare non-negative constants dependent on the conditions of construction, and γ is a positive constant, which normally assumes values in the range 0 < γ ≤ 2 depending on the material and burial depth. André et al. (2009) states (i) is the most used for natural gas pipelines (see De Wolf & Smeers, 1996 and Parker, 2005), but we believe that these are mainly applied to gas transmission networks (above 1 megapascal). With regard to gas distribution networks, Boyne (1972) assumes (ii) witheij=0,cij=0.06(pound/inch) andγ=1.3for a low-pressure (less than 0.1 megapascal) network and Osiadacz and Gorecki (1995) also support (ii) for low and medium (0.1 megapascal to 1 megapascal) pressure. As our network is a medium-pressure gas distribution network, we chose (ii) for this study. Note that if the cost function is linear (Castello, Tzimas, Moretto, & Peteves, 2005),cijdij+eij, both (i) and (ii) are satisfied.Then, the total construction cost is(2)∑(i,j)∈A(T)(cijlijdijγ+lijeij).Note that∑(i,j)∈A(T)lijeijis a constant for a tree-shaped network. Therefore, when formulating the problem OPi, we can eliminate lijeij, as the optimal diameter does not depend on it.We now present OPi for a given tree T. Under the assumption that dijis the discrete diameter, we can formulate the IP problem with a decision variable dijthat is selected from a range of commercial diametersdτ(τ=1,2,…,m). In this study, we refer to this problem as OPi for the discrete diameter (OPiD):(3)φD=min∑(i,j)∈A(T)cijlijdijγ,(4)s.t.∑(i,j)∈A(Prv)μlijqijαdijβ≤πmax,∀v∈V,(5)dij∈{d1,d2,…,dm},∀(i,j)∈A(T).The global optimal solution is denoted bydijD*, referred to as the optimal discrete diameter in this study, and the minimum cost by φD* which corresponds todijD*.Meanwhile, assuming that dijis relaxed to a non-negative continuous diameter, our problem is formulated as a nonlinear programming problem, which we refer to as OPi for the continuous diameter (OPiC):(6)φC=min∑(i,j)∈A(T)cijlijdijγ,(7)s.t.∑(i,j)∈A(Prv)μlijqijαdijβ≤πmax,∀v∈V,(8)dij≥0,∀(i,j)∈A(T).The global optimal solution is denoted bydijC*, referred to as the optimal continuous diameter in this study, and the minimum cost by φC* which corresponds todijC*.In this section, we present the procedure to obtain the minimum cost and optimal continuous diameters for OPiC shown in (6)–(8). An iterating procedure that contracts a tree converts the original tree into a single equivalent arc, thereby facilitating the computation of the minimum cost. In addition, we introduce an inverse procedure to compute the optimal continuous diameter for each arc of the original tree and present an algorithm to convert this optimal continuous diameter into an approximate discrete diameter as the solution of OPiD shown in (3)–(5).Let πijbe a pressure drop (pi2−pj2) of (i, j) ∈ A(T) with the following conversion:(9)πij=μlijqijαdijβ.Substituting (9) into (6)–(8) converts the original problem with the continuous variable dijinto a problem with the continuous variable πij. Let wijbe the weight of (i, j) ∈ A(T) shown in (10):(10)wij=cijμγβlijβ+γβqijαγβ.The converted problem is defined as follows:(11)φC=min∑(i,j)∈A(T)wijπij−γβ,(12)s.t.∑(i,j)∈A(Prv)πij≤πmax,∀v∈V,(13)πij>0,∀(i,j)∈A(T).In this study, we refer to the problem (11)–(13) as the optimal pressure problem of a gas distribution network for the continuous diameter (OPrC). Clearly, the minimum costs of OPiC and OPrC are equivalent.With regard to OPrC, we prove Lemma 1 and 2.Lemma 1OPrC has a feasible solution.ProofLet |A(T)| and |A(Prv)| be the number of arcs in A(T) and A(Prv), respectively. We poseπij=πmax/|A(T)|, which satisfies (13). Because |A(Prv)| is not greater than |A(T)| for every r-v-path of the trees, (12)∑(i,j)∈A(Prv)πij≤∑(i,j)∈A(T)πmax|A(T)|=πmax,∀v∈V,is satisfied. This completes the proof of the lemma. Q.E.D.With regard to (13), ifπij=0for (i, j) ∈ A(T),wijπij−γ/βbecomes infinite as 0 < γ ≤ 2 and 4.8 ≤ β ≤ 5.3. Lemma 1 shows that the optimal solutionπij*is never equal to zero. Therefore, even if we relax (13) to πij≥ 0, the optimal solutions of the original problem and the relaxed problem are equivalent.Lemma 2Expression (12) holds with equality for the optimal solution of OPrC.ProofSuppose that there exists a path A(Prv) for the optimal solutionπij*of OPrC that satisfies∑(i,j)∈A(Prv)πij*<πmax,∃v∈V.Subsequently, we can increaseπuv*for (u, v) ∈ A(Prv) until (12) holds with equality. It also decreases the term of the objective functionwuv(πuv*)−γ/βas it is a decreasing function ofπuv*, because 0 < γ ≤ 2 and 4.8 ≤ β ≤ 5.3. This is a contradiction because our improved procedure is able to decrease the construction cost. Therefore, this completes the proof.Q.E.D.Note that the cost increases with increasing diameter according to (6). Therefore, it is obvious that the minimum possible diameter must be chosen and thus the upper bound on the pressure drop constraint (7) must be active.From the above results, OPrC can be transformed into (14)–(16). The problem (14)–(16) is a strictly convex programming problem for πij> 0 whereπij*is the unique globally optimal solution:(14)φC=min∑(i,j)∈A(T)wijπij−γβ,(15)s.t.∑(i,j)∈A(Prv)πij=πmax,∀v∈V,(16)πij≥0,∀(i,j)∈A(T).In the following sections, we introduce the tree contraction algorithm to obtain the minimum cost φC* and the tree expansion algorithm to obtain the optimal continuous diameterdijC*with analytical expressions. Here we opt to improve the conciseness of our explanation by defining a parent of u ∈ N(T) asu−and a child asu+. In addition, we denote a set of parentsNT−(u)and childrenNT+(u)as follows:NT−(u)={u−∈N(T)|(u−,u)∈A(T)},NT+(u)={u+∈N(T)|(u,u+)∈A(T)}.Note that|NT−(u)|=1for all u ∈ N(T)∖{r} whereas|NT+(u)|≥0because we assume the network is a tree. We employ different tree contraction/expansion algorithms for|NT+(u)|=1and|NT+(u)|>1, respectively.In this section, we show the contraction and expansion procedure for a given tree. As the procedure differs according to the type of tree, two types of tree, A and B, are presented.(1) Contraction and expansion for a “type A” treeIn this study, a tree is referred to as “type A” if there exists a node u ∈ N(T) satisfying|NT+(u)|=1. In addition, a procedure involving the replacement of arcs incident to the node u to transform T1 into T2  as an example of type A shown in Fig. 3.1 is referred to as “Contraction procedures A.” Then, the following lemma is established between T1 and T2.Lemma 3The tree T1contains a node u ∈ N(T1) that satisfies|NT1+(u)|=1. As Contraction procedures A, we define the tree T2where(u−,u)and(u,u+)are replaced by(u−,u+)with weightwu−u+aswu−u+=(wu−uββ+γ+wuu+ββ+γ)β+γβ,Then, the minimum costs of OPrC for T1and T2are equivalent.ProofWe implement the Lagrange function LR(λ, π) to solve OPrC of T1 as follows:(17)LR(λ,π)=∑(i,j)∈A(T1)wijπij−γβ−∑v∈Vλv(πmax−∑(i,j)∈A(Prv)πij),Karush–Kuhn–Tucker conditions can be written in the following equivalent form which contains variables relating to(u−,u)or(u,u+).−γβwu−uπu−u−β+γβ+∑(u−,u)∈A(Prv)∧v∈Vλv=0,−γβwuu+πuu+−β+γβ+∑(u,u+)∈A(Prv)∧v∈Vλv=0.Because every path passing through(u−,u)also passes through(u,u+)as shown in Fig. 3.1,∑(u−,u)∈A(Prv)∧v∈Vλv=∑(u,u+)∈A(Prv)∧v∈Vλvis established. Therefore, we can obtain (18).(18)wu−uπu−u−β+γβ=wuu+πuu+−β+γβ.Further, we define T2 where(u−,u)and(u,u+)are replaced by(u−,u+)from T1. For(u−,u+)∈A(T2), we define the pressure dropπu−u+as(19)πu−u+=πu−u+πuu+,by using (15) and the weightwu−u+as(20)wuu+πuu+−β+γβ=wu−u+πu−u+−β+γβ,(21)wu−uπu−u−β+γβ=wu−u+πu−u+−β+γβ,by using (18).Therefore we can obtain (22) from (19)–(21)(22)wu−u+=(wu−uββ+γ+wuu+ββ+γ)β+γβ.This completes the proof. Q.E.D.With regard toT2=(N(T2),A(T2))that is constructed according to Contraction procedures A, N(T2) is identical to (N(T1)∖{u}) and A(T2) is identical to(A(T1)∖{(u−,u),(u,u+)})∪{(u−,u+)}Rearranging (20) gives(23)πuu+=wuu+ββ+γwu−u+ββ+γπu−u+.Substituting (22) into (23) gives(24)πuu+=wuu+ββ+γwu−uββ+γ+wuu+ββ+γπu−u+,and substituting (24) into (19) givesπu−u=wu−uββ+γwu−uββ+γ+wuu+ββ+γπu−u+.Therefore, if we obtain the optimal pressure dropπu−u+*for(u−,u+)∈A(T2), we can also computeπu−u*andπuu+*for(u−,u),(u,u+)∈A(T1), i.e., T1 is inversely created by expanding T2. We refer to these procedures as Expansion procedures A.For example, for a path graph, i.e., a graph in which none of the nodes has more than one child, as shown in Fig. 3.2, the minimum cost and the pressure drops can easily be obtained by iterating Contraction procedures A and Expansion procedures A, respectively.(2) Contraction and expansion for a “type B” treeIn this study, a tree is referred to as “type B” if there is at least one parent with two or more children as its leaves. In addition, a procedure involving the aggregation of the children of u to transform T3 into T4 as an example of type B shown in Fig. 3.3 is referred to as “Contraction procedures B.” Then, the following lemma is established between T3 and T4.Lemma 4The tree T3shown inFig. 3.3has a node u that satisfies|NT3+(u)|>1and where allu+∈NT3+(u)are leaves. As Contraction procedures B, we define tree T4that is obtained from tree T3by deleting allu+∈NT3+(u)and(u,u+)∈A(T3), inserting a new node u”, joining u and u” and defining weightwuu′′as(25)wuu′′=∑(u,u+)∈A(T3)wuu+.Then, the minimum costs of OPrC for T3and T4are equivalent.ProofWe defineA0={(u,u+)|u+∈NT3+(u)}. Then, the problem (14)–(16) for T3 is expressed as(26)φC=min∑(i,j)∈A(T3)∖A0wijπij−γβ+∑(u,u+)∈A0wuu+πuu+−γβ,(27)s.t.∑(i,j)∈A(Prv)πij=πmax,∀v∈V∖NT3+(u),(28)(∑(i,j)∈A(Pru)πij)+πuu+=πmax,∀u+∈NT3+(u),(29)πij≥0,∀(i,j)∈A(T3).Letπuu′′=πmax−(∑(i,j)∈A(Pru)πij). Then, by (28) and (29), it is obvious that(30)πuu+=πuu′′,∀u+∈NT3+(u).(31)πuu′′≥0.Substituting (25) and (30) into (26)–(29) converts the problem as follows:φC=min(∑(i,j)∈A(T3)∖A0wijπij−γβ)+wuu′′πuu′′−γβ,s.t.∑(i,j)∈A(Prv)πij=πmax,∀v∈V∖NT3+(u),(∑(i,j)∈A(Pru)πij)+πuu′′=πmax,πij≥0,∀(i,j)∈A(T3)∖A0,πuu′′≥0.Because the above converted OPrC for T3 becomes equivalent with OPrC for T4, the proof is complete. Q.E.D.With regards toT4=(N(T4),A(T4)), which is constructed according to Contraction procedures B, N(T4) is identical to(N(T3)∖NT3+(u))∪{u′′}and A(T4) is identical to (A(T3)\A0)∪{(u, u″)}.Note that if we obtain the optimal pressure dropπuu′′*for (u, u″) ∈ A(T4), we can also computeπuu+*for all(u,u+)∈A(T3)by the proof of Lemma 4, as(32)πuu+*=πuu′′*,u+∈NT3+(u).This implies that T3 is inversely created by expanding T4. These procedures are referred to as Expansion procedures B.For example, for a star graph, i.e., the tree shown in Fig. 3.4, in which all the demand nodes are children of the source node, the minimum cost and the optimal pressure drop can be obtained by using Contraction procedures B and Expansion procedures B for only one iteration, respectively.In this section, we show that the minimum cost φC* can easily be obtained, because iterating both Contraction procedures A and B converts an original tree into a single arc connecting the root to a single node. When arcs are contracted by applying Contraction procedures A or B, the weight of every arc in the contracted tree can be expressed by a formula of weights in the original tree. In addition, a pressure drop for every arc in the original tree can be expressed by a formula of a pressure drop in the contracted tree. Hence, we state Theorem 1.Theorem 1The minimum cost φC* and the optimal continuous diameterdijC*of OPiC in the tree T can be represented as an analytical expression.ProofLet T1 be the original tree. A search is performed to find v, the leaf with the maximum of |A(Prv)|. In addition, u ∈ N(T1) is defined as a parent of v.At this time, if |A(T1)| ≥ 2, the following procedure is used to transform T1 into T2.•If|NT1+(u)|=1, we apply Contraction procedures A.If|NT1+(u)|>1, we apply Contraction procedures B.Note that because|NT2+(u)|=1if Contraction procedures B are applied to T1, the tree T3 can be constructed from T2 by Contraction procedures A.Subsequent to performing these procedures for Λ(where Λ ≤ |A(T)|) iterations, we obtain the treeTΛ+1, which has only one arc (|A(TΛ+1)|=1) connecting the root r and its only childr+. OPrC ofTΛ+1can be expressed as follows:φC=minwrr+πrr+−γβ,s.t.πrr+=πmax,(r,r+)∈A(TΛ+1).The minimum cost φC* is clearlywrr+πmax−γ/β. The weight of each arc forTk+1is expressed by the weight of each arc for Tkthrough Contraction procedures A or B. Thus, becausewrr+is expressed analytically by Lemma 3 and 4, we can also express φC* in analytical form. In addition, as a pressure drop for each arc of Tkis expressed by the weight of the arcs of Tkand the pressure drop of the arcs ofTk+1through Expansion procedures A or B, a pressure dropπij*for (i, j) ∈ A(T1) is also expressed in analytical form. As substitutingπij*into (9) also shows that an optimal continuous diameterdijC*is also in analytical form, this completes the proof. Q.E.D.Note that the proof implies the minimum cost φC* of OPiC is proportional toπmax−γ/β.We establish the tree contraction-expansion algorithm in Algorithm 1 to compute the minimum cost φC* and the optimal continuous diameterdijC*.As mentioned in the proof of Theorem 1, after Contraction procedures B are applied to Tk, Contraction procedures A are applied toTk+1unless|A(Tk+1)|=1(expressed as “u ≠ r” in Step 2.3). Then, we can formulate Steps 2.2 and 2.3. Furthermore, we installU(k),u(k),u(k)′′,u(k)+, andu(k)−to store nodes in the k-th contraction procedure. Computing the optimal pressure drops for arcs in Tk, we can decide whether to use Expansion procedures A or B by U(k) and restore arcs by usingu(k),u(k)′′,u(k)+, andu(k)−. Application of the tree contraction–expansion algorithm to the network in Fig. 1.2 enables us to obtain the minimum cost φC* and the optimal pressure dropπij*shown in Fig. 3.5after running five iterations for each.In the previous section, we obtained the optimal continuous diameters as the solutions of OPiC. In this section, we find the approximate discrete diameters from the optimal continuous diameters as the solutions of OPiD.In this study, we establish the following heuristic to allocate the optimal continuous diameter to the feasible discrete diameter for each arc. In this study, we assumedijC*≤dm, because dmis sufficiently large in reality. At first, we assign the initial discrete diameter by rounding down the continuous diameterdijC*. Thereafter, we increase the discrete diameter in the ascending order of a specified index for each arc (i, j) ∈ A(T) until the pressure is at least pmin for every leaf. The index is the difference between the γ-th powers of the discrete diameter obtained by rounding updijC*and the γ-th powers ofdijC*. However, this procedure may select an unnecessary arc for a diameter increase. For example, if every leaf in all paths including a selected arc has already exceeded pmin, we need not increase the diameter for this arc. Then, we seek the possibility of a diameter reduction for every arc whose diameter has been increased. As this algorithm does not guarantee the global optimal solution, letd^ijD*denote the approximate discrete diameters obtained by this algorithm andφ^D*the approximate cost corresponding tod^ijD*. In addition, we install τijto enable us to store an index of discrete diameters(τ=1,2,…,m)chosen for (i, j) ∈ A(T).We then show the approximation discrete diameter algorithm in Algorithm 2. Note that we assign the smallest discrete diameter d1 for (i, j) ifdijC*is smaller than d1 as an initial value in Step 1.1 and we decide the order in which the diameter of the arcs are increased by ρijin Step 2. Steps 3.1 and 3.2 of this algorithm increment the discrete diameter. Note that a feasible solution is always obtained by Step 3 because the discrete diameter is not less than the continuous diameter for every arc when every (i, j) ∈ A(T) satisfying τij< m is selected in Step 3. In Step 4, we examine whether it would be possible to reduce the diameter of every arc whose diameter was increased in Step 3. We decrease the diameter for an arc at first. Then, if the pressure for at least one node drops below pmin, the diameter of the arc is restored to its original size before the reduction. By these steps, the approximate discrete diameter for each arc is obtained in Step 5.In the next section, we evaluate our proposed combination of algorithms. As mentioned in Section 2, our problem, OPiD for a tree-shaped network, is an IP problem. When Raghunathan (2013) solved OPiD with cycles formulated as an MINLP problem, they found the global optimal solution using IBM-ILOG-CPLEX as MILP solver by iteratively linearizing the problem to an MILP problem in a reasonable computation time. Bragalli et al. (2012) also employed IBM-ILOG-CPLEX as an MILP solver to solve OPiD with cycles. Thus, we used their results as a benchmark with which to compare the performance of our algorithms by running the IP solver Gurobi 5.6.2. to show that our algorithms are capable of performing the approximation with high accuracy and in a much shorter computation time.In this section, both our algorithms (Algorithms 1 and 2) are used in combination for the evaluation of two sample networks in practice.We now present the first sample network, which was obtained by modifying data from the real network shown in Fig. 4.1. In Fig. 4.1 (a), there exists a supply node (1), demand nodes (2,…,14), junction nodes (15,…,36) and roads beneath which pipes can be laid. The distance between adjacent nodes is 1000 (meter). As the demand nodes are geographically dispersed as shown in Fig. 4.1 (a), we have selected the tree-shaped layout T, as shown in Fig. 4.1 (b) for the layout phase.The layout T consists of 19 arcs and 20 nodes. Each arc is labelede(e=1,…,19)and has a length of 1000 (meter), respectively. The consumption for each demand node is presented in Table 4.1.With regard to α, β, and μ, there are many values in practice (Osiadacz, 1987). In this study, we apply Cox's equation (The Japan Gas Association, 2011) that uses the parametersα=2andβ=5and setμ=1/4.46. The Japan Gas Association (2011) introduces two different classifications for medium pressure pipelines referred to as an upper medium pressure (0.3 to 1 megapascal) and a lower medium pressure (0.1 to 0.3 megapascal). Accordingly, we assume pmax=1 (megapascal) and pmin=0.3 (megapascal) as an upper medium pressure network. In addition, we assign the commercial diameters dτlisted in Table 4.2.With regard to the construction cost (thousands of USD /meter), we assumecij=0.01,γ=1, andeij=0for all (i, j) ∈ A(T). That is, the construction cost is a linear function of the diameter.In this study, after obtaining the optimal continuous diameterdijC*for the sample network by the tree contraction–expansion algorithm (Algorithm 1), the approximation discrete diameter algorithm (Algorithm 2) is applied to assign the approximate discrete diameterd^ijD*. Following this, we compared^ijD*with the optimal discrete diameterdijD*computed by using Gurobi 5.6.2. The original treeT1(=T)becomes T19 after 18 iterations of Contraction procedures A or B, which enables us to compute the minimum costφC*=29,230 of OPiC. Reverting T19 to T1 and performing iterations of the Expansion procedures A or B provides the optimal continuous diametersdijC*and the optimal pressure dropsπij*shown in Table 4.3.Furthermore, the approximate discrete diametersd^ijD*are listed in Table 4.3, and we compute the minimum costφ^D*=32,000 shown in Table 4.4. The computation time for obtaining the minimum construction costφ^D*, which was computed by writing code using Python2.7a, was 0.002(s) on a Lenovo IdeaPad U310 (CPU: 1.7GHz, RAM: 4 GB). As the value that was computed ford^ijD*is equal todijD*for every (i, j) ∈ A(T), as shown in Table 4.3, and the time that was required to compute φD* by using Gurobi 5.6.2 is 2.77(s) on the same computer, we find that our algorithms for OPiD are capable of performing the approximation with high accuracy in a short time. As mentioned in Section 1, for the solution of OPiD in a network with cycles, several researchers have suggested enumerating all spanning trees in the network, which requires a time-efficient algorithm for tree-shaped networks. Combined with this enumeration technique our results indicate that our algorithm is well suited to provide an approximate solution for the OPiD that includes cycles.Our algorithms were evaluated using a second sample network shown in Fig. 4.2, which is a modified example based on a real network in the greater Tokyo area. The network consists of a single supply node, 22 demand nodes, 23 junction nodes, and 45 arcs. Fig. 4.2 shows the length (kilometer) of each arc (underlined) and the specified consumption (cubic meters per hour) for each demand node in parentheses.For this sample network, we also apply Cox's equation to provide the commercial diameters dτshown in Table 4.2, and assumecij=(0.01)γandeij=0as a construction cost (thousands of USD /meter) for all (i, j) ∈ A(T). In addition, we assume pmax=0.2 (megapascal) and pmin=0.1 (megapascal) as a lower medium pressure network.Our algorithms were evaluated by comparing the costφ^D*, which corresponds to the approximate discrete diameters, with φD*, which corresponds to the optimal discrete diameter for the casesγ=0.7,1,and1.3. The computation ofφ^D*was performed by writing code by using Python2.7a, whereas Gurobi 5.6.2 was used to obtain φD* on a Lenovo IdeaPad U310 (CPU: 1.7 gigahertz, RAM: 4 gigabyte).The results are shown in Table 4.5and in Figs. 4.3and Fig. 4.4. The computation time is nearly identical for different values of γ. In addition, regardless of the value of γ, the difference betweenφ^D*and φD* is very small, being less than 0.7%, and the time required to computeφ^D*was much shorter than that required for φD*. Therefore, this demonstrates that our algorithms are capable of finding the discrete diameter with high accuracy in very short computation time for a large gas network.this paper presents the development of the tree contraction–expansion algorithm for the problem OPiC. It iterates the contraction of a tree to compute the minimum cost analytically; further, it iterates the expansion from the contracted tree to the original tree to compute the optimal diameter for each arc where the diameter is a continuous variable. An algorithm for converting the optimal continuous diameters to the approximate discrete diameters as solutions of OPiD was also developed.The efficiency of our proposed algorithms was demonstrated for two sample networks, for which the parameters were computed with high accuracy in a short computation time. It should therefore be possible to use our algorithms to design a gas distribution network in practice.

@&#CONCLUSIONS@&#
