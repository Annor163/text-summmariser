@&#MAIN-TITLE@&#
Multimodal therapy for complete regression of malignant melanoma using constrained nonlinear optimal dynamic inversion

@&#HIGHLIGHTS@&#
Complete regression of malignant melanoma cancer in two months.Automatic selection of different combination of drug dosages (chemotherapy and immunotherapy).Control design is based on nonlinear feedback design ‘optimal dynamic inversion’.Toxicity limits of drug dosages are considered.Computationally simple and can be implemented online.

@&#KEYPHRASES@&#
Chemotherapy,Immunotherapy,Multimodal therapy,Automatic drug delivery,Optimal drug dosage,Treatment of melanoma,Regression of melanoma,

@&#ABSTRACT@&#
Using a realistic nonlinear mathematical model for melanoma dynamics and the technique of optimal dynamic inversion (exact feedback linearization with static optimization), a multimodal automatic drug dosage strategy is proposed in this paper for complete regression of melanoma cancer in humans. The proposed strategy computes different drug dosages and gives a nonlinear state feedback solution for driving the number of cancer cells to zero. However, it is observed that when tumor is regressed to certain value, then there is no need of external drug dosages as immune system and other therapeutic states are able to regress tumor at a sufficiently fast rate which is more than exponential rate. As model has three different drug dosages, after applying dynamic inversion philosophy, drug dosages can be selected in optimized manner without crossing their toxicity limits. The combination of drug dosages is decided by appropriately selecting the control design parameter values based on physical constraints. The process is automated for all possible combinations of the chemotherapy and immunotherapy drug dosages with preferential emphasis of having maximum possible variety of drug inputs at any given point of time. Simulation study with a standard patient model shows that tumor cells are regressed from 2×107 to order of 105 cells because of external drug dosages in 36.93 days. After this no external drug dosages are required as immune system and other therapeutic states are able to regress tumor at greater than exponential rate and hence, tumor goes to zero (less than 0.01) in 48.77 days and healthy immune system of the patient is restored. Study with different chemotherapy drug resistance value is also carried out.

@&#INTRODUCTION@&#
Melanoma is a malignant skin tumor from melanocytes, which are the cells that produce dark pigment melanin, responsible for the color of the skin. It is fatal and causes the majority (approximately 75%) of deaths related to skin cancer [1,2]. In current practice of cancer therapy, which is based on the inferences drawn from ‘open-loop’ clinical studies, high dosages of drugs are given at different points of time. However, this strategy has serious drawbacks. First, since it is based on mere open loop studies, the success rate turns out to be not high as the drug dosage is not patient condition specific in a closely monitored sense. Toxicity levels can cross the maximum prescribed values, leading to potentially dangerous side effects. A high dosage of chemotherapy drugs can kill the immune system cells as well. Instead of the currently practiced strategy, if a patient condition dependent (i.e., state feedback) low dosages of drugs are infused to the patient's body on a continuous basis, then the treatment strategy will be substantially more effective with much lesser side effects. However, frequent monitoring of the patient condition, followed by carefully computed low dosage of various drugs magnitude is possible only when the entire process is made automatic. Such an automated system will compute the appropriate quantity of drug dosages which needs to be given at that point of time, depending upon the patient's condition throughout the treatment period, resulting in a feedback control system mechanization. In this work, we propose a state feedback solution which ensures (i) complete regression of tumor and (ii) drug dosages are given within their toxicity limits. These two points are not concurrently taken care by current clinical practice.Typical treatment procedures for solid tumors include treatment with chemo and immunotherapy drugs, after surgical removal of the tumor and/or radio therapy (which are not within the scope of this paper). The immune system has shown notable role in fighting against tumor [3–6]. Effect of immunotherapy on tumor growth is studied in [7–9]. Mathematical model for chemotherapy and immunotherapy effect on tumor growth is presented in [10]. In fact, recently attempts are being made to propose control theory based regimens for tumor control with chemo and immuno therapies. Optimal control of bang bang type is applied for tumor control with chemotherapy [11]. In another approach, for tumor control with chemotherapy, optimal control is considered with linear and quadratic cost functional [12]. However, the proposed optimal control solutions in [11,12] are in ‘open loop’. To make it operate on a feedback scheme, a nonlinear model predictive control (NMPC) has also been proposed in the literature [13]. In [14], nonlinear tumor model is approximated by sequence of linear time varying models and then, state dependent Riccati equation (SDRE) based nonlinear suboptimal controller has been proposed. Optimal control based control solutions offer several advantages. However, they also suffer from several potential drawbacks, one being the fact that they are computationally quite intensive. Hence they are not easy to implement in embedded microchips, which can be a potential limitation if the ultimate aim is to implement the drug infusion through portable devices with limited computational power and energy source. More importantly, there is the big dilemma of either to take into account the nonlinear dynamics and land up with an ‘iterative’ solution scheme or to take approximate linearized dynamics, thereby degrading the solution quality.In this paper, on the other hand, we propose an alternate drug infusion strategy based on the nonlinear state feedback control design philosophy called ‘optimal dynamic inversion’ (exact feedback linearization with static optimization), which leads to a closed form expression of the controller in state feedback form, which has previously been used for a treatment strategy for ‘chronic myelogenous leukemia’ [15]. However, one substantial improvement in this paper is to implement control constraints and to ensure that computed drug dosages does not violate the toxicity limits at any point of time. Furthermore, the lymphocyte population after recovery should develop towards a natural count (a finite positive value), thereby ensuring a healthy state of the patient (in control theory language, the internal dynamics must remain stable and bounded). To ensure that tumor cells are driven to zero without crossing drug toxicity limits, the problem has been formulated in the framework of optimal dynamic inversion [15], which in turn is based on the philosophy of feedback linearization [16] (feedback linearization is known as dynamic inversion in aerospace community). One should also note that drug input design is carried out using a ‘outer loop–inner loop’ philosophy (see Fig. 1; described in Section 3.1), which is inspired from what is routinely done in synthesizing guidance and control loops in aerospace technology. This essentially exploits the cause-and-effect relationship in the model extensively, making the proposed drug design approach very effective. Moreover, it avoids the important issue of instability of ‘internal dynamics’ [17]. This essentially correlates to the dynamics (Eqs. (1)–(6)) of natural killer cells (N), CD8+T cells (L) and circulating lymphocytes (C) in this problem, which must remain bounded at all time. To drive number of tumor cells to zero, outermost loop is formulated with T*=0 (T* is desired tumor value). Thus, tumor goes to zero asymptotically at exponential rate, see Fig. 2in Section 3. It can be shown from theoretical analysis (see Section 3 for details) that when T=0 and external inputs, υL=υM=υI=0 (Eqs. (1)–(6)), both M, I→0 and, subsequently, all other remaining states that constitute the internal dynamics (i.e., N, L and C) remain bounded. This has been validated from simulation results as well. Note that, optimal dynamic inversion is applicable, provided: (i) the model is in control affine form, i.e., the control variables (drug input terms) should appear linearly and (ii) number of control variables should be greater than or equal to the number of performance outputs (outputs to be controlled) that must be driven towards an objective. The model considered here satisfies both of these requirements as there is one output variable (tumor cell population) and three control variables (drug dosages).There are a few more additional constraints as well, such as: (i) drug dosages and the number of cells must be represented by non-negative real values and (ii) drug magnitudes are constrained by positive real values due to toxicity limits. To ensure these additional but important constraints to meet, necessary additional algebra is carried out, which can be summarized as follows (see Fig. 3). There are three different drug administrations in the model. Therefore, at every control update different combinations of drug dosages are possible (3 or 2 or 1 or 0). First priority is given to select all three drug dosages. However, if it is not possible at any given point of time, then the idea is to switch to two drug dosages. There are three such possibilities and all possible combinations are explored. If none of the three combinations is possible to implement, then the idea is switch to one drug dosage. However, if none of that is possible, then no drug dosage is selected for that point of time. Note that the condition set implemented is ‘exhaustive’ and hence the process operates in an ‘automatic manner’. Note that finally it gives closed form solution for the controller. Hence it is computationally quite inexpensive, which can be implemented easily in microprocessors with limited capability. Simulation study shows that tumor cells are regressed from 2×107 to order of 105 cells because of external drug dosages in 36.93 days. After this no external drug dosages are required as immune system and other therapeutic states are able to regress tumor at greater than exponential rate and hence, tumor goes to zero (less than 0.01) in 48.77 days and healthy immune system of the patient is restored. Since patient(s) can have different initial values of tumor and immune cells at initiation of the treatment, studies with different initial conditions has also been carried out to demonstrate the effectiveness of the proposed approach. Chemotherapy drug resistance is also taken into consideration.The model and its parameters are as proposed in [10]. It consists of ordinary differential equations, which describes the kinetics of tumor cells, three types of immune cells and two drug concentrations in the bloodstream. It can be written as the following system of coupled nonlinear equations.(1)dTdt=aT(1−bT)−cNT−DT−KT(1−e−zM)T(2)dNdt=eC−fN+gT2h+T2N−pNT−KN(1−e−M)N(3)dLdt=−mL+jD2T2k+D2T2L−qLT+(r1N+r2C)T−uNL2−KL(1−e−M)L+pILIgI+I+υL(t)(4)dCdt=α−βC−KC(1−e−M)C(5)dMdt=−γM+υM(t)(6)dIdt=−μII+υI(t)where D=d(L/T)l/[s+(L/T)l].In (1)–(6), T(t), N(t), L(t), C(t) represent the tumor cell population, total natural killer (NK) cell population, total CD8+T (cytotoxic T-cell) population and number of circulating lymphocytes, respectively. M(t) and I(t) represent the chemotherapy drug concentration in bloodstream in mgkg−1 and immunotherapy drug concentration in bloodstream in I.U.kg−1. υL(t), υM(t) and υI(t) represent the tumor infiltration lymphocytes (TIL) drug dosage rate in cellsday−1, chemotherapy drug dosage rate in mgkg−1day−1 and immunotherapy interleukin-2 (IL-2) drug dosage rate in I.U.kg−1day−1, respectively. Parameters [10] are described in Table 1.In this model the tumor growth rate is assumed to be logistic i.e., GT=aT(1−bT) and tumor cells are affected after its interaction with the NK cells and CD8+T cells, represented by the terms, −cNT and −DT, respectively. These interactions represents competition for space, nutrients and regulatory actions. NK cells are present in the body even when no tumor is present. NK cells are part of the immune system, and its growth rate is represented by eC. It has natural death rate, −fN. When tumor is present, there is an increase in NK cells, represented by recruitment term,gT2/[h+T2]N, it is of modified Michaelis–Menten form. NK cells are not effective in controlling tumor, after its several interactions with tumor cells, represented by −pNT. CD8+T cells are present in large quantities when tumor is present. Recruitment of CD8+T cells is represented byjD2T2/[k+D2T2]. CD8+T cells also get recruited by dead tumor cells, which are destroyed by NK cells, it is represented by term, r1NT. When tumor is present, it interacts with circulating lymphocytes, it results in recruitment of more CD8+T cells, represented by r2CT. CD8+T cells gets activated by interleukin-2 (IL-2), represented by Michaelis–Menten term, pILI/(gI+I). Death rate of CD8+T cell is given by −mL. After several interactions with tumor, CD8+T cells are not effective, it is represented by, −qLT. If CD8+T cells are present in large numbers and not effective, then it undergoes elimination, represented by, −uNL2. Circulating lymphocytes are produced at constant rate and also have natural death rate, represented by, α−βC. Chemotherapy drug concentration is only due to the external drug dosages, hence, it has only decay term proportional to its concentration, thus, GM=−γM. Similarly, for immunotherapy drug IL-2, GI=−μII. The chemotherapy drug kills the different cells. It is represented by FMφ=−Kφ(1−e−M)φ, for φ=T, N, L, C and z=1. Thus, chemotherapy effect is linear for small concentration, it effects becomes constant as concentration is increased. CD8+T cells are boosted by the tumor infiltration lymphocyte (TIL) drug intervention term, υL(t). Note that the equilibrium point of model ((1)–(4)) corresponding to zero tumor is, [TE, NE, LE, CE]=[0, eα/βf, 0, α/β]. More details about the model can be found in [10].The main objective of the control design is to drive tumor cell count to zero by computing different drug dosages using philosophy of dynamic inversion. In this problem, number of outputs are lesser than number of inputs, hence, after using dynamic inversion philosophy, drug dosages can be selected in optimized way by formulating a control minimization problem with linear constraints, where drug dosage constraints and different drug combinations (3 or 2 or 1 or 0) are evaluated. Control synthesis is done in inner and outer loops, which is greatly inspired from challenging guidance and control synthesis problems in aerospace engineering. There are essentially four loops: T-loop, L-loop, M-loop and I-loop. Philosophical and block diagram representation for different loops in control design is shown in Fig. 1. Cause and effect relationship between inputs and output through different states is shown in philosophical diagram, Fig. 1a. First outer loop (T-loop) is synthesized, by enforcing T to track T* (here T* is desired value of tumor cells and T*=0), from which desired values L* and M* are obtained. Then, by enforcing L to track L*, the desired values of υL(a control variable) and I* are obtained. Finally, the objective is to force state I and M to track I* and M* respectively, from which the desired values of υIand υMare obtained. States which are connected in this input to output configuration are shown in Fig. 1a and other states are not shown. Other than T-loop, all are inner loops. T-loop corresponds to (1) with blocks: T, L and M in Fig. 1a. L-loop corresponds to (3) with blocks: L, υLand I in Fig. 1a. M-loop corresponds to (5) with blocks: υM(t) and M in Fig. 1a. I-loop corresponds to (6) with blocks: I andυI(t) in Fig. 1a. Fig. 1b shows block diagram representation for T-loop. Objective of T-loop is to drive error T−T* to zero, controller output will be L* and M*. Note that L* and M* are obtained from ULand UMrespectively (UMand ULare described in Section 3.2, ULand UMare pseudo control variables as these are functions of states L and M respectively and hence not shown in block diagram). Also note that tuning parameter value forrT2(described in Section 3.2) is assumed to be chosen for block diagram representation. Controller needs information of states N and T for computation of ULand UMwhich gives L* and M*, respectively. Fig. 1c shows block diagram representation for L-loop. Objective of L-loop is to drive error L−L* to zero. Here, L* is desired value of L-loop, which is obtained from ULof T-loop. Controller output will be I* and control, υL(t). I* is obtained from UI(UIis described in Section 3.2, UIis pseudo control variable and is function of state I), tuning parameter value forrL2(described in Section 3.2) is assumed to be chosen for block diagram representation. Controller needs information of states T, N, C and M. Fig. 1d shows block diagram representation for M-loop. Objective of M-loop is to drive error M−M* to zero. Here, M* is desired value of M-loop, which is obtained from UMof T-loop. Controller output will be control, υM(t) and controller needs information of state M. Fig. 1e shows block diagram representation for I-loop. Objective of I-loop is to drive error I−I* to zero. Here, I* is desired value of I-loop, which is obtained from UIof L-loop. Controller output will be control, υI(t) and controller needs information of state I. Note that υL(t), υM(t) and υI(t) are physical control variables, whereas UM, ULand UIare functions of states M, L and I, respectively, and hence they are pseudo control variables. Dependence of controller on different states can be understood from (1)–(6) and after going through Section 3. Control computation is based on states and tuning parameters. Some of the tuning parameters (namelyrT2andrL2in Section 3) are chosen such that they are dependent upon the state values.Note that when T=0 and υM(t),υL(t) and υI(t)=0 (i.e., drug inputs are stopped), then it can be mathematically shown that there will be no recurrence of the tumor cells and, moreover, all other states either develop towards zero or remain bounded. To show this, let t0 be the time when T=0 and υM(t), υL(t) and υI(t)=0. Then, from (1), it is immediately clear thatT˙=0∀t≥t0. Hence, T(t)=0, ∀t≥t0. Next, from (5) and (6), it is immediately clear that M, I→0, as t→∞. With these conditions in place, from (2), (3) and (4), the dynamics of N, L and C reduce toN˙=eC−fN,L˙=−mL−uNL2,C˙=α−βC, respectively. Since β>0, it is clear from the linear C equation that the homogeneous solution will decay out and C→Css=(α/β) as t→∞, where Cssis the steady state solution of C. Putting this solution back in theN˙equation, it can then be argued that theN˙=eCss−fNand hence it is a linear equation as well. Moreover, since f>0, it is clear that the homogeneous solution will decay out and N→Nss=(eCss/f) as t→∞, where Nssis the steady state solution of N. Next, after some algebra, it can be shown that the solution ofL˙=−mL−uNssL2satisfiesL/m+nL=ke−mt, where n=uNssand k is a constant. Hence, since m>0, L/(m+nL)→0 as t→∞, which means L→0 as t→∞. It is worth mentioning here that the steady state values as predicted from this analysis are indeed observed from the simulation studies.T-loop: Here, the objective for the control design, is to force state T to track T* value i.e., T→T*. Principle of dynamic inversion is used to attain this objective. Using the stable linear error dynamics condition, enforcing,(7)E˙T+kTET=0where, ETis instantaneous error between T and T*, ET=(T−T*), kT>0, is a control design gain, that needs to be tuned appropriately to obtain satisfactory results. The analytical solution of (7) is, ET(t)=ET(0)e−kTt, ast→∞, ET(t)→0, and hence, T(t)→T*(t). Thus, if T* is assumed to be zero, then, tumor population will go to zero in infinite time, i.e., asymptotically as shown in Fig. 2. (7) can be written as,(T˙−T˙*)+kT(T−T*)=0,where,T˙*=0andT*=0hence,(8)T˙=−kTTfrom (1),(9)T˙=fT(T)+GT1(T)UM+GT2(T)ULwhere,fT(T)=aT(1−bT)−cNT,GT1=−KTT,GT2=−T, and UM=(1−e−zM), UL=D=dLl/(sTl+Ll)from (8) and (9),fT(T)+GT1(T)UM+GT2(T)UL=−kTT,therefore,(10)GT1(T)UM+GT2(T)UL=bTwhere, bT=−kTT−fT(T). In (10), control variables (υL(t), υM(t), υI(t)) are not appearing explicitly, however variables ULand UMare functions of states L and M which are driven by control variables, υL(t)andυM(t), respectively ((3), (5)). Eq. (10) has infinite solutions, as, there is one equation and two free variables, UMand UL. To get meaningful solution, we define static optimization problem, to select UMand ULsuch that the following cost function subject to constraint (10) is minimized,(11)JT=12(rT1UM2+rT2UL2)whererT1>0andrT2>0, are the weights for the pseudo control inputs UMand UL. Static optimization problem ((11) and (10)), can be solved using Lagrange multiplier method [19].(12)J¯T=12(rT1UM2+rT2UL2)+λ[GT1(T)UM+GT2(T)UL−bT]where, λ is Lagrange multiplier, solving,∂J¯T/∂λ=0,∂J¯T/∂UM=0, and∂J¯T/∂UL=0, we get,(13)UM=bTGT1rT1(GT12/rT1)+(GT22/rT2)(14)UL=bTGT2rT2(GT12/rT1)+(GT22/rT2)Thus, we get the values for UMand UL. Then, the desired value for M-loop(M*) and L-loop(L*) is computed. As,UM=1−e−zM,UL=dLl/[sTl+Ll],solving these two equations individually,(15)M*=−1zln(1−UM)(16)L*=ULsTld−UL(1/l)here, UMand ULare substituted by (13) and (14), respectively.L-loop: Here, objective is to drive state L, such that, L→L*. Similarly, as in T-loop, we impose first order error dynamics, therefore,(17)E˙L+kLEL=0where, EL=L−L*, therefore,E˙L=L˙−L˙*, assumingL˙*=0, hence, from (17), we get,(18)L˙=−kL(L−L*)from (3) and (18) we get,(19)UI+υL=bLwhere, bL=−fL(T)−kL(L−L*),fL(T)=−mL+jD2T2k+D2T2L−qLT+(r1N+r2C)T−uNL2−KL(1−e−M)L,and(20)UI=pILIgI+I(19) has two free variables, UIandυL, thus, static optimization problem can be formulated, so as to minimize,(21)JL=12rL1UI2+rL2υL2subject to constraint (19). Again as in T-loop, we use Lagrange multiplier method, therefore,(22)UI=bLrL1(1/rL1)+(1/rL2)(23)υL=bLrL2(1/rL1)+(1/rL2)from (20), we get desired value for the I-loop I*, as,(24)I*=gIUIpIL−UIhere, UIis given by (22).M-loop: Here, objective is to drive state M, such that, M→M*. Enforcing, first order error dynamics, we get,(25)E˙M+kMEM=0where, EM=M−M*, therefore,E˙M=M˙−M˙*, assumingM˙*=0, hence, from (25) we get,(26)M˙=−kM(M−M*)from (26) and (5), we get,(27)υM(t)=γM−kM(M−M*)I-loop: Here, objective is to drive state I, such that, I→I*. Enforcing, first order error dynamics,(28)E˙I+kIEI=0where, EI=I−I*, therefore,E˙I=I˙−I˙*, assumingI˙*=0, from (28), we get,(29)I˙=−kI(I−I*)using (29) and (6),(30)υI(t)=μII−kI(I−I*)Conditions on variables (UM, UL, UI, υL, υM, υI) (which also gives conditions on tuning parametersrT2andrL2) are considered in Sections 3.6 and 3.7.When all the three drug dosages cannot be given simultaneously, then, we switch to two drug control. This happens because the physical constraints corresponding to all three drug dosages are not satisfied and computed value for one of the drug dosages has unrealistic value and therefore, its value is taken as zero. The control design for the drug dosages in two drug case is different from the three drug case because, the final output, that is tumor value will be driven by different loops which correspond to those two drug dosages. There are three different drug dosages, therefore, three distinct combination of two drug dosages are possible at any point of time, i.e., (a) υM(t) and υL(t); (b) υL(t) and υI(t); (c) υI(t) and υM(t). Objectives of different loops and rationale of the equations are same as that of corresponding loops and equations in three drug control. Therefore, instead of repeating similar derivation, equation/s which are different is discussed for one of the cases, i.e., (b) υL(t) and υI(t). It has three loops T-loop, L-loop and I-loop (Fig. 1). T-loop: here, equation of ULis given by,(31)UL=1T[aT(1−bT)−cNT−KT(1−e−zM)T+kTT]because, in this case υM(t) is not considered. As in (10), UMwill not come inT˙equation, and term, (1−e−zM) will be regarded as free state variable. Also, there is no need of optimization in T-loop and ULequation is obtained directly. L-loop and I-loop are same as that in three drug control.Two drug dosages are switched to one drug dosage, when one of the drugs shows unrealistic value. There are three different drug dosages, hence, three different combinations occur, i.e., (a) υM(t) (consists of T-loop and M-loop); (b) υL(t) (consists of T-loop and L-loop) and (c) υI(t) (consists of T-loop, L-loop and I-loop). In one drug control, most of the equations are same as that for three drugs and two drugs control, therefore, those equations are not repeated. While switching from two drug control to one drug control, the drug dosage which shows realistic values in two drug dosage is used as a drug in one drug case. Now, the control design for that particular drug is used to compute the control.In order to get the best possible results, we have to fine tune the control design parameters. As, we are using first order error dynamics, where, relationship between time constant (τ) and settling time (tss) (for 2% steady state error) is: τ=(1/tss) [20]. Settling time for the tumor is chosen to be 45 days and therefore, tuning parameter (time constant) for T-loop is kT=4/45. Outer loop is driven by the inner loops, hence, inner loop variables must reach faster to their desired values, as compared to corresponding outer loop variables, otherwise, objective will not be achieved. Tuning parameter of L-loop, kL>0, and M-loop, kM>0, is chosen which must be faster than kT>0, and tuning parameter of I-loop, kI>0, is chosen which must be faster than kL>0. We have selected kL=5×kT, kM=5×kTand kI=5×kL.Values of the tuning parametersrT1,rT2,rL1,rL2are selected based on physically meaningful conditions such that the desired values of state variables, M*, L*, I* cannot have imaginary values and the control variables should not have negative or imaginary values (as these are the external drug dosages). These conditions are taken care by deriving conditions on the tuning parameters. If the values of tuning parameters are chosen to be fixed then, it may violate the derived conditions. Hence, for each control update, tuning parameter value is selected, so that the conditions get satisfied. From (11) and (21), it can be seen that the ratio(rT1/rT2)or(rL1/rL2)matters.rT1andrL1are selected as,rT1=rL1=1, and conditions are derived forrT2andrL2.(1) Condition onrT2for using υM(t): From (15), to get real M* values, we have,(32)UM<1Externaldrugscannotbenegativehence,(33)υM(t)≥0Case I: Assuming bT≤0; substituting UMfrom (13) in (15) to get M*, using this M* in (27) and substituting in (33),(34)rT2≥GT22rT1bTGT1/[1−ezM((γ/kM)−1)]−GT12where, bT=−kTT−aT(1−bT)+cNT, similarly, using (13) in (32),(35)rT2<GT22rT1bTGT1−GT12Let,A=GT22rT1bTGT1/[1−ezM(γ/kM−1)]−GT12andB=GT22rT1bTGT1−GT12thus from (34) and (35), we get, condition for using υM(t) with bT≤0 as,(36)A≤rT2<BCase II: Assuming bT≥0; Similarly, as in Case I, condition onrT2can be derived as,(37)A≥rT2>B(36) and (37) are the conditions onrT2for using υM(t).(2) Conditions onrT2for using υL(t): from (16), L* to have real values: UL≥0; d−UL>0; since, d is positive parameter value, combing these conditions,(38)0≤UL<dCase I: Assuming bT≤0; using (14) in (38)(39)C<rT2≤Dwhere,C=rT1/GT12(bTGT2/d)−GT22and D→∞Case II: Assuming bT≥0; Similarly, as in Case I, condition onrT2can be derived as,(40)C>rT2≥DAs υL(t) is the external drug dosage,(41)υL(t)≥0using (23) in (41),(42)bLrL2(1/rL1)+(1/rL2)≥0rL1andrL2are always chosen to be positive, we want,(43)bL≥0where bL=−fL(T)−kL(L−L*), in whichfL(T)=−mL+jD2T2k+D2T2L−qLT+(r1N+r2C)T−uNL2−KL(1−e−M)Lusing (14) and (16) and using it in (43), we get,rT2≤(sTl+Pl)/dPlbTGT2−GT22GT12rT1Let,E=(sTl+Pl)/dPlbTGT2−GT22GT12rT1, hence,(44)rT2≤Ewhere,(45)P=L+1kL−mL+jD2T2k+D2T2L−qLT+(r1N+r2C)T−uNL2−KL(1−e−M)L(39), (40) and (44) are the conditions onrT2for using υL(t).(3) Conditions onrL2for using υI(t) from (24), for I* to have real values, UI≠PIL using (22) in (24),rL2≠pILrL1bL−pIL, let,F=pILrL1bL−pIL, hence,(46)rL2≠FAs υI(t) is external drug dosage, we want,(47)υIt≥0Case I: Assuming bL≤0; using (22) in (24) and using it in (30). Thus, (47) gives,rL2≤rL1bLgII1−(μI/kI)+bLpIL−1,let,G=rL1bLgII1−(μI/kI)+bLpIL−1, hence,(48)rL2≤GCase II: Assuming bL≥0; similarly, as in Case I, condition can be derived, however it comes up with one more condition as given below,(49)rL2≥Gand,(50)pIL1+rL1rL2−bL>0(46), (48), (49) and (50) are the conditionsrL2for using υI(t).rT2is applicable in three drug control and in two drug control with υM(t)andυL(t); and υM(t)andυI(t).rL2is applicable with three drug control and in two drug control with υL(t)andυI(t). In case of one drug control,rT2andrL2are not applicable, the only condition on the control value is that, it should be positive. If this condition is not satisfied, then control value is taken as zero.From (36), (37), (39), (40), (44), (46), (48)–(50), it can be seen that, for different drug dosages, we have different conditions onrT2andrL2. These conditions are dependent on state values, therefore,rT2andrL2may or may not satisfy all of these conditions at each control update. Therefore, it is always not possible to select all the three drug dosages. Conditions which can occur at each control update are, (i) all the three drug dosages do not violate the condition: all three drug dosages are selected; (ii) one drug dosage violates the condition: other two drug dosages are selected; (iii) two drug dosages violate the condition: remaining one drug dosage is selected; (iv) all the three drug dosages violate the condition: no drug dosage is selected. As, there are three different drug dosages, therefore, any one out of seven possible combinations (all 3 or any 2 or any 1) is possible at each control update. At each control update, first priority is to select all the three drug dosages, hence,rT2andrL2values are selected such that it should satisfy all the conditions onrT2andrL2, and drug dosages are computed as given in Section 3.2. If it is not possible to selectrT2andrL2in this manner, then the drug dosages for which the inequality is satisfied are computed as given in Section 3.3, thus, we switch to two drug control and other drug dosage is taken as zero. Also if two drug control fails, then we switch to one drug control, it is computed as given in Section 3.4 and conditions for it is checked i.e., drug dosage should be positive or zero, and other two drug dosages are taken as zero. Finally, if no combination works then no drug dosage is given. Thus, (i) all tuning parameters should be positive; (ii) condition for using υM(t): Case I: bT≤0,A≤rT2<B; Case II:bT≥0,A≥rT2>B. (iii) Condition for using υL(t): Case I: bT≤0,(C<rT2≤D)and(rT2≤E);Case II:bT≥0,(C>rT2≥D)and(rT2≤E).(iv) Condition for using υI(t):Case I:bL≤0;(rL2≤G)and(rL2≠F).Case II: bL≥0;(rL2≥G);(rL2≠F)andpIL1+(rL1/rL2)−bL>0.rT2andrL2are selected in such a way that all the three drug dosages can be used and also they must be positive. Computation, ofrT2:for the casebT≤0is described. We have four numbers A, B, C, E (Section 3.6.1) which are the functions of states (T, N, L, C, M, I) and D→∞. Thus from (36), (39) and (44),rT2is selected as follows,(51)rT2=max(A,C)+min(B,E)2if,rT2happens to be negative, then,(52)rT2=min(B,E)2again, if it is negative, then, drug dosages associated withrT2, i.e., υM(t)andυL(t) are not selected. Similarly, for the case bT≥0, corresponding inequalitiesareused to computerT2.Computation ofrL2: for the case bL≤0; from (48),(53)rL2=G−2if,rL2=Fthen, from (46),rL2is recomputed as,(54)rL2=G−1when, bL≥0, from (49)(55)rL2=G+2if (50) is not satisfied then,rL2=G+1;ifrL2=F, thenrL2=G+0.5.After selecting the tuning parameters values, drug dosages are computed as in Section 3. Therefore, tuning parameters’ values select the combination of drug dosages, summarized in Fig. 3.Tuning parameters weights can be adjusted to increase or decrease control variable values. However, particular tuning parameter values should also satisfy the control objective. Here, there are three controls (one chemotherapy and two immunotherapies). Chemotherapy is most effective but at the same time it has most side effects. Therefore, control designer can select tuning parameter values according to the requirement. There are four tuning parametersrT1,rT2,rL1andrL2.rT1andrT2are related to UMand UL, respectively.rL1andrL2are related to UIand υL, respectively. UMis related to υM; ULis related to both UIand υL; and UIis related to υI. Note that υL, υMandυIare actual control variables and tuning parametersrT1,rT2andrL1are related to pseudocontrol variables, UM, ULand UI, respectively. It is observed that pseudocontrol variables and their related actual control variable have monotonic relationship (which can be verified by plotting (plots are not shown): υMwith respect to UM; UIand υLwith respect to UL; and υIwith respect to UI). Therefore, actual control variable values can be increased or decreased by adjusting its tuning parameter value or tuning parameter value of related pseudocontrol variable. For example, to increase υM: decreaserT1or increaserT2; to increase υL: decreaserT2so that ULincreases, then decreaserL2.High dose rate of drug dosages can be toxic to the patient. Hence, it is important to put bound values to these drug dosage rate. Let lower and upper bound values of υL(t), υM(t), υI(t) be υLL, υML, υILand υLU, υMU, υIU, respectively. Proposed design is nonlinear feedback control, where control variables can be manipulated at each point of time. Therefore, if control variable/s violate their bound/s then at that time instant, their value is fixed at their bound value/s. It is summarized as follows:a)if υL(t)<υLL, then υL(t)=υLLif υL(t)>υLU, then υL(t)=υLUif υM(t)<υML, then υM(t)=υMLif υM(t)>υMU, then υM(t)=υMUif υI(t)<υIL, then υI(t)=υILif υI(t)>υIU, then υI(t)=υIUNote that in three and two drug control design (Sections 3.2 and 3.3), lower bounds (i.e., positive or zero drug dosage rate) for υL(t), υM(t)andυI(t) is implemented using tuning parameters (Section 3.6), here only upper bounds for controls as mentioned above will be required. However, in one drug control design (Section 3.4), control bounds using Section 3.6 will not be applicable, therefore all the control bounds as mentioned above will be considered in design. Control bounds values for υL(t), υM(t)andυI(t) are given in Table 2.From (1) tumor growth rate is given by aT(1−bT) and a is positive parameter, thus tumor will should increase in its value. However, (1) also has other components in the form of state variables N, L and M, out of which N and L are because of natural immune system, in which L can also be changed therapeutically. M is only due external therapeutic agent υM(t). It is shown in [10] that system (1)–(4) has equilibrium point [TE, NE, LE, CE]=[0, eα/βf, 0, α/β], which is unstable. Thus, small value of tumor will grow to larger value near its equilibrium point. Note that, at equilibrium point T and L are zero whereas N and C have finite number. Suppose L also has some finite number then its effect on tumor is studied in [10]. Hence, in [10] basin of attraction plot between L and T is shown, by observing this plot we can say that when L is greater than 800 cells then tumor of order 105 gets regressed without any therapy, here N and C are kept at their equilibrium values. [10] also shows a plot for healthy immune system where tumor is regressed without any therapy, here initial values for states T, N, L and C were T0=106, N0=105, L0=100 and C0=6×1010. In this work first order linear error dynamics is imposed i.e.,E˙T+kTET=0, where, ET=T−T*, T*=0 andT˙*=0, we get,(56)T˙=−kTTFrom (56) we get,(57)T(t)=T(0)e−kTtIt is shown in Section 3 thatT˙contains control and from (57) tumor decays at exponential rate. We have also observed that, when tumor is of order of 105 then it does not need any external drug dosages (υL(t)=υM(t)=υI(t)=0). Thus we claim that for certain values of tumor cells and immune cells, no therapy is required and moreover tumor decays at a rate which is more than exponential rate because after imposing first order linear error dynamics control gives unrealistic values. To strengthen this claim, at each time step following condition is checked,(58)T˙<−kTTif (58) is satisfied then no need for control design i.e., υL(t)=υM(t)=υI(t)=0, as tumor will regress at a rate faster than exponential rate. By imposing (58) before control design at each time step we found that (58) is satisfied for all tumor values, when tumor is of order 105 or less (exact values are shown in Section 4. Simulation results). However, some of the tumor values above 105 also obeyed (58) due to which there was chattering in control. To get smoother control profile instead of (58) following two conditions are imposed,(i) Let tkbe current time step and tk−1 be previous time step.Suppose at tk−1 atleast on one of controlsυM(tk−1),υL(tk−1),υI(tk−1)is positive and at tkT˙(tk)<−2kTT(tk), then υM(tk)=υL(tk)=υI(tk)=0. Hence, no need of control design.Note thatT˙(tk)is computed from right hand side of (1), using state values at tk.(ii) Suppose at tk−1 all the controlsυM(tk−1),υL(tk−1),υI(tk−1)are zero andT˙(tk)>−kTT(tk), then control is computed as shown in Section 3.On of the conditions where tumor decay depends on the dynamic properties of the immune system/tumor cells is described. From (1),(59)dTdt=aT(1−bT)−cNT−DTAssuming cN+D≈cN+d and further assuming, a(1−bT)≪cN+d. Thus, (59) can be written as,(60)dTdt=−(cN+d)TNote that (60) is linear equation in T by assuming N(t) as time varying parameter. N(t) is always positive, c and d are positive numbers. This system has negative eigen value. Hence it is stable [17].The parameters of the model are adopted from [10] (human parameters, patient 9 data).Parameter values are given in Table 1. Initial conditions are taken as, tumor cell population (T) as 2×107, NK cells (N) as 1×104, CD8+T cells (L) as 100 and circulating lymphocytes (C) as 1×109. The initial conditions of the control variables (υL(t), υM(t), υI(t)) are taken as zero. Immune cells should always be present in a particular range. Higher values of immune cells will produce toxicity, whereas, in lower values immune system will not function properly against foreign cells or microorganisms [24]. Bound values for control variables are critically considered (Table 2).As shown in Fig. 4, in case of humans, tumor cells (T) goes to zero in 48.77 days (note that tumor value less than 0.01 is assumed as zero). There is change in the nature of plot, after 36.93 days (highlighted in subplot of Fig. 4). Because after 36.93 days, external boost of drugs (υL(t), υM(t), υI(t)) is zero (Figs. 8–10). Tumor value at end of 36.93 days is 7.506×105 (indicated by data point in subplot of Fig. 4). These values of tumor cells at 36.93 day are substantial, then also after 36.93 days system dynamics is independent of control (external boost of drugs). As first order linear error dynamics is imposed i.e.,E˙T+kTET=0which givesT˙=−kTT(asT*=T˙*=0). Thus, this control design ensures exponential decay of tumor. At 36.93 days and thereafter, values of states (T, N, L, C, M, I) are such that after applying principle of dynamic inversion (Section 3 by excluding Section 3.8) control design gives unrealistic control values which cannot be applied, hence they are taken as zero i.e., (υL(t)=υM(t)=υI(t)=0). Thus we claim that at 36.93 days and thereafter tumor is getting regressed by other state variables at rate which more than exponential rate. It is also evident from Fig. 4, as there is change in nature of plot at 36.93 days and after 36.93 days plot is more steeper. To justify this claim, in Section 3.8, we have given some conditions in whichT˙is checked at each time step. At initial conditions of tumor and immune cells, immune system is not able to control tumor growth (which can be verified by using υM(t)=υL(t)=υI(t)=0, and then either simulating system (1)–(4), or by just checking (1), which will give positiveT˙value). As (8) is used in the control design, whereT˙is proportional to T. Initially, tumor has large value, therefore T is large and to meet this large value we get positive values for control variables. As the time goes tumor load decreases, and immune system becomes strong. It can be seen from Fig. 6that state N and C are increasing continuously. Because external drug dosages (υL(t), υM(t), υI(t)) are countering tumor load and also state M (which has negative effects on all cells) has very low value towards 36.93 days and thereafter (Fig. 7). At 36.93 days and thereafter, N and C becomes so strong that states N, L, C, M and I are able to regress tumor at a rate more than exponential rate. Also note that state I is zero at 38.69 days (Fig. 7, its value is below 0.01, hence it is described as zero) and state M is zero at 40.96 days (Fig. 7, its value is below 0.01, hence it is described as zero). Thus, from 36.93 to 38.69 days, states N, L, C, M, I are able to regress tumor, from 38.69 to 40.96 days states N, L, C, M are able to regress tumor and from 40.96 days and thereafter states N, L, C are able to regress tumor, at 40.96 days tumor value is 3.002×104 (Fig. 4). If the system would not have exhibited such characteristics of tumor getting regressed at a rate faster than exponential rate then control would have been applicable till end. Also, such characteristics depend up on the parameters and initial conditions.Fig. 5shows the variation of the CD8+T cells (L). CD8+T cells (L) depletes due to its interaction with the tumor cells and chemotherapy. Initially tumor load is large, as CD8+T cells (L) is the specific immune response, its value is going to get increase, also in this period as there is external boost of TIL and IL-2 (Figs. 8 and 10), which also helps in increase of CD8+T cells. As tumor load starts decreasing, less amount of CD8+T cells are required for exponential decay, therefore, there is no increase of CD8+T cells up to 30 days. After 30 days, there is increase in CD8+T cells up to 39.73 days, because chemotherapy effect on these cells decreases (Fig. 7). After 39.73 days, it is decreasing, as there are no external drug dosages (Figs. 8–10) and tumor load is also present. When tumor goes to zero at 48.77 days, at that time CD8+T cells (L) have value in the range of 104, as it is the specific immune response, it should go to zero after tumor is eliminated and the same can be observed in Fig. 5. At 105.2 days CD8+T cells (L) are below 0.01 hence it is described as zero. Also note that plots of CD8+T cells (L) are up to 120 days to show that CD8+T cells (L) go to its zero value. It can also be inferred from the zero tumor equilibrium of the system that CD8+T cells (L) are zero at equilibrium. Variation of NK cells (N) and circulating lymphocytes (C) are shown in Fig. 6, we have shown a data point to indicate that the plot is starting from nonzero value. NK cells (N) get affected due to its interaction with the tumor cells and chemotherapy. Hence, when the tumor and chemotherapy are present in the system, it does not show any rise, also, it does not show decrease because of the recruitment and growth terms. As tumor and chemotherapy are eliminated, it shows sudden rise in its value and eventually it reaches a steady value. Plot is shown up to 800 days, value at 800 days is near to its theoretical zero tumor equilibrium value. Circulating lymphocytes (C) has constant growth rate, and it gets depleted due to its death rate and chemotherapy. When the chemotherapy is eliminated from the body, circulating lymphocytes (C), goes to its steady state value, which can also be inferred from its theoretical zero tumor equilibrium value. Also, note that in Fig. 6 plots are for 800 days, to show the steady state values for NK cells (N) and circulating lymphocytes (C). For patient to be healthy circulating lymphocytes (C) should be not go below 108[10], it can be observed from Fig. 6 that circulating lymphocytes (C) are in order of 1010, hence we conclude that patient is always in the healthy state. Variation of chemotherapy drug concentration (M) and immunotherapy drug concentration (I) are shown in Fig. 7. Initially, tumor load is large, therefore chemotherapy is required, which depletes not only tumor cells but also other immune cells. Maximum value of M is 0.8428mgkg−1 at 13.5 days, after this M starts decreasing as tumor load has substantially reduced and immune system (N and C) has also gained strength. When M decreases, natural decay rate of M is more than its boosting rate υM(t). Chemotherapy drug concentration M, gets eliminated from the body in around 40.96 days. Note that value of M at 40.96 days is below 0.01mgkg−1 hence it is described as zero. Immunotherapy drug concentration (I) is not required initially for small duration, because, to begin with, we have considered healthy immune system. Thereafter, immune system gets depleted and IL-2 comes into picture. IL-2 helps in boosting CD8+T cells (L). We have considered bound values for υI(t) (Table 2), hence, IL-2 shows the constant value from 1.61 to 36.93 days, after that I decreases because υI(t) is zero and I is eliminated from body at 38.69 days. Note that value of I at 38.69 days is below 0.01I.U.kg−1 hence it is described as zero.Figs. 8–10, shows the variation of external drug dosages: υL(t), υM(t)andυI(t). Between 0 and 0.7 days, υM(t) and υL(t) are present, υI(t) is zero. This is because we are starting with high tumor value and healthy immune system. Also, both υM(t) and υL(t) are associated with the tuning parametersrT1andrT2, out of whichrT1is fixed at 1, and, forrT2we are able to get a value which satisfies the inequality forrT2.rL2cannot be selected such that inequality corresponding torL2is satisfied in this duration. After 0.7 day, immune strength decreases, therefore, all the three drug dosages are operational up to 36.92 days. After 36.92 days no drug dosages are required, because, at this point of time the immune system has become strong enough, such that tumor gets regressed (because of states N, L, C, M and I up to 38.69 days, and because of states N, L, C, M and N, L, C and M up to 40.96 days, and because of states N, L and C till tumor elimination). Note that I and M are eliminated from body at 38.69 and 40.96 days. As shown in Table 2, υM(t) is bounded above, therefore, whenever υM(t) crosses its upper bound value, it is taken as 2mgkg−1day−1. So, we are getting the different combinations of drug dosages regimen, 3 or 2 or 0, depending on the tumor state and immune system strength. In actual scenario, patients can have different initial conditions of tumor and immune cells. Therefore, different initial conditions study is carried out. Fig. 11shows the tumor population with four different initial conditions. Initial conditions of states considered are, T:106to108, N:0%to±20%of nominalN(0), L:0%to±20% of nominal L(0), C:0% to ±20% of nominal C(0) (e.g., if N is changed by 20%, then its value is 1.2×104). 500 different cases are considered, it is observed that the success is 100%. Tumor sometimes develops resistance towards chemotherapy drug, this can lead to treatment failure. Chemotherapy drug resistance is accounted by using variable z[18] in the model (z is taken as 1 in [10], [18] is one of the references of [10]). Figs. 12–14show the variation of tumor cells and different control variables with different z values. As per [18], higher values of z will offer lesser drug resistance, therefore lesser value of chemotherapy drug dosages will be required. This is also seen in Figs. 12–14. In Fig. 12, z is 1 and highest value υM(t) is in the range of 0.5–1mgkg−1day−1. In Fig. 13, z is 0.5 and highest value υM(t) is in the range of 1.5–2mgkg−1day−1. In Fig. 14, z is 0.1 and highest value υM(t) is 2mgkg−1day−1. Also, note in Figs. 12–14, tumor takes more time to go to zero when z is lesser. This is happening because some of the control variables are hitting their bound values. If control variables would have been unconstrained or if they would have not hit their bound values, then, for different values of z, tumor will go to zero at same time.

@&#CONCLUSIONS@&#
