@&#MAIN-TITLE@&#
Development of electroencephalographic pattern classifiers for real and imaginary thumb and index finger movements of one hand

@&#HIGHLIGHTS@&#
Decoding accuracy of real and imaginary finger movements was explored by ANN and SVM.Real and imaginary movement of thumb/index fingers of one hand was used for decoding.The SVM was better for trial accumulation, ANN - for single-trial discrimination.Decoding of imagined movements through individual time intervals is promising for BCI.

@&#KEYPHRASES@&#
Electroencephalography,Symbolic regression,Support vector machine,Artificial neural network,Motor imagery,Finger movements,Brain–computer interface,

@&#ABSTRACT@&#
ObjectiveThis study aimed to find effective approaches to electroencephalographic (EEG) signal analysis and resolve problems of real and imaginary finger movement pattern recognition and categorization for one hand.Methods and materialsEight right-handed subjects (mean age 32.8 [SD=3.3] years) participated in the study, and activity from sensorimotor zones (central and contralateral to the movements/imagery) was recorded for EEG data analysis. In our study, we explored the decoding accuracy of EEG signals using real and imagined finger (thumb/index of one hand) movements using artificial neural network (ANN) and support vector machine (SVM) algorithms for future brain–computer interface (BCI) applications.ResultsThe decoding accuracy of the SVM based on a Gaussian radial basis function linearly increased with each trial accumulation (mean: 45%, max: 62% with 20 trial summarizations), and the decoding accuracy of the ANN was higher when single-trial discrimination was applied (mean: 38%, max: 42%). The chosen approaches of EEG signal discrimination demonstrated differential sensitivity to data accumulation. Additionally, the time responses varied across subjects and inside sessions but did not influence the discrimination accuracy of the algorithms.ConclusionThis work supports the feasibility of the approach, which is presumed suitable for one-hand finger movement (real and imaginary) decoding. These results could be applied in the elaboration of multiclass BCI systems.

@&#INTRODUCTION@&#
Interest in developing non-invasive brain–computer interfaces (BCIs) has grown remarkably due to the application of new methods of brain activity registration and analysis and the development of new hardware and software for BCI systems. Non-invasive BCIs allow subjects to communicate without using their peripheral nervous system. This feature is crucial for patients with severe brain and brain stem injuries, for whom normal communication is difficult or even impossible. Non-invasive BCIs also might be implemented for various uses, including rehabilitation, artificial limbs and wheelchair control. The development of these systems for clinical applications is being conducted by different research groups worldwide [1–4]. Furthermore, non-invasive BCI applications for non-medical purposes are also possible, including the control of technical devices under extreme environmental conditions and the real-time estimation of subject states [5].The amount of research devoted to BCIs has grown considerably over the last few years. More than 1500 articles on the development of BCIs have been indexed in the USA National Library of Medicine at the National Institutes of Health (www.pubmed.com) during the last 10 years. Non-invasive BCI systems may be based on various types of brain activity recordings, including electroencephalography (EEG) [6], magnetoencephalography (MEG) [7], functional magnetic resonance imaging and near-infrared spectroscopy [8,9]. Among these applications, EEG seems to be the most affordable and available.One of the promising measures for EEG-based BCIs is the brain activity associated with imagery movement acts. Different signals have been used during BCI studies to classify EEG patterns associated with the imaging of certain movements. These include event-related desynchronization/synchronization of mu or beta rhythms in the sensorimotor cortex and evoked potential parameters [10].The primary challenge during EEG-based BCI development is extraction of the classifying signal, which provides high discriminative accuracy in motor imagery pattern classification [11]. For example, mu and beta rhythms are used to extract the classifying signal [12].Several BCIs have been developed based on sensorimotor rhythm, e.g., the Wadsworth BCI [13] in which users control a cursor on the computer screen through imagined movements of their hands and entire body. The Graz BCI [14,15] is based on the discrimination of simple imagined movements of the hands and legs; it can be used to manage a cursor, virtual keyboard or orthopedic device for a paralyzed arm.The Berlin BCI [5] is based on the discrimination of imagined movements of the right and left hands for computer application management. Doud and colleagues [16] used imagined movements of the hands, legs and tongue for continuous BCI control of a three-dimensional helicopter model. Similar BCI systems are used by research groups to manage robotized artificial limbs and control wheelchairs [17].More recent studies are dedicated to the imagined movements of large body parts, such as hands, legs, wrists [18] and elbows [19]. However, the ability to use the imagined movements of fine body parts increases the degrees of freedom for BCIs and supports the likelihood of practical use.Signals corresponding to different finger movements can be extracted from electrocorticographic (ECoG) signals despite distributed and overlapped representations in the motor cortex [20,21]. Miller et al. [21] described broadband signals recorded on appropriate cortex areas that were specific to single finger movements. Analysis of the ECoG potentials recorded during the real finger movements revealed that just before the initiation of finger movement, there is a characteristic decrease in power at lower frequencies (alpha/beta range) and a spectrally broad but spatially focal increase in power at higher frequencies (above 40Hz). A principal component analysis of these changes revealed robust, characteristic motifs, which were consistent and reproducible across all subjects and electrodes in the hand motor cortex during finger movements. The relative strength of the main principal spectral component varied according to the neighboring cortical location, indicating separable individual finger somatotopy among the subjects [21].Few reports have been dedicated to BCIs based on the EEG patterns of imagined and real movements of fine human body parts. Xiao and Ding [22] evaluated the discrimination performance of three types of EEG features: spectral features obtained from PCA, alpha/beta band power changes, and EEG temporal data for decoding the individual finger movements of one hand. The experimental results demonstrate the feasibility of applying a broadband EEG feature to the discrimination of individual fingers. The highest decoding accuracy was 45% among all investigated EEG features, and EEG temporal data and spectral principal component features demonstrate similar decoding accuracies. However, alpha/beta power changes (regularly used for large body part movement discrimination) do not contain sufficient information for decoding fine individual finger movements [22].The EEG signals corresponding to the real finger movements of one hand were classified with a similar accuracy by [23], with MEG data providing more robust classification of the same cases [23]. The study demonstrated that the information available from simultaneously recorded EEG was not sufficient for robust classification. Furthermore, it showed that the slow amplitude modulations of the time series were more predictive than was the power of the time–frequency representation of different frequency bands when decoding single finger taps. This finding indicates that important information is captured in the precise, spatiotemporal pattern of movement-related magnetic field dynamics. However, implementation of the MEG method is restricted by the complexity of the recording process required.The principal barrier to the practical implementation of BCI systems is the lack of robust, fast and accurate EEG pattern classification methods. Most of studies in the field of EEG-based BCI systems have been dedicated to the development of these methods.Another problem is signal nonstationarity [24]. Nonstationarity of the EEG signal is observed at the transition from the calibration stage to real-time application [25] and can be caused by fatigue and other uncontrolled factors. Explanations for nonstationarity can include external noises, a high-dimension EEG signal [26] and changes in the background activity of the user [27]. The problem of EEG signal nonstationarity during the implementation of BCI systems is the subject of future BCI development [24].This study aimed to find effective approaches for EEG signal analysis to resolve problems with pattern recognition and categorization. Feature generation methods based on distinct signal regression (numerical and symbolic) approaches across various time domains can avoid the loss of information due to the time localization of features. The artificial neural network (ANN) classifier and support vector machine (SVM) classifiers were chosen for EEG pattern recognition.The experiments were performed during motor execution and imagination to assess the effectiveness of the classifiers. The EEG signals obtained during imagined and real movements of the fingers of one hand were used as the initial data. The results assessed the possibility of recognizing EEG patterns corresponding to real and imagined finger movements. The results were also used to estimate the ANN and SVM classifier accuracy.The methods of EEG data acquisition, feature extraction and classification are described in the ensuing section. The classification results and discussion are presented in Sections 3 and 4. Finally, a brief conclusion is given.A total of 8 healthy, right-handed participants (3 male, 5 female, mean age: 32.8 [SD=3.3] years) participated in the study. The subjects participated in a different number of repeated sessions, and 17 separate EEG registrations were performed on different days. No participant reported a history of any medical or neurological disorder, and all had normal or corrected vision. All procedures were carried out in accordance with the Helsinki declaration (1974). The participants gave their written consent after receiving a detailed explanation of the experimental procedure.Participants had to perform 4 types of tasks: 2 motor and 2 mental (imagining motor activity). In the motor tasks, subjects had to press a button with the thumb (1st motor task) and index finger (2nd motor task) of their right hand. In the imagery tasks, they had to use their kinesthetic sense [15] to imagine moving the thumb and index finger of their right hand. All tasks were performed with open eyes. The subjects fixated their vision on a point in the center of the screen and voluntarily “reacted” with movement/imagining when a cross appeared. The tasks were performed with a block design (100 trials per block, 2350ms duration per trial). The block-based design was used due to several reasons. First, it was applied to eliminate the influence of the presented stimulus type on the ensuing EEG activity. In the case of imaginary movements, the type of the movements might be encoded by the stimulus cue during the training trial set (increasing the trial and entire session length) or by the instruction to the subjects in the block-based approach. Second, the block design was used for the future accumulation of the sequenced trials for real-time applications when subjects might imagine movements several times to receive device feedback.The model of the voluntary/imaginary tapping is presented in Fig. 1.The blocks of trials of imaginary and real movements were counterbalanced both across subjects and across different sessions with the same subjects. Between-trials intervals inside each block of trials were randomized from 700 to 2500ms.Monopolar EEG was registered from 19 derivations (Fp1, Fp2, F7, F3, Fz, F4, F8, T3, C3, Cz, C4, T4, T5, P3, Pz, P4, T6, O1, and O2 according to the 10–20 system) and a reference at the earlobe with a Mitsar electroencephalograph (St. Petersburg, Russia). The bandpass filter was set to 0.53–30Hz with a notch filter set to 45–55Hz using WinEEG software (Ponomarev, V.A., Kropotov, Ju.D., registration no. 2001610516 at 08.05.2001). The electrode impedance was less than 5kΩ. The sampling rate per channel was 2000Hz. The raw EEG data were transformed to a weighted average reference montage (WAR montage) and digitized at sampling rate 500Hz. The WAR montage produces a spatial filtering effect and diminishes the influence of a common reference in the EEG signal. In comparison to common averaged reference montage, the WAR montage greatly reduces the topographic displacement of a widespread potential, such as alpha rhythms [28]. To control a situation of involuntary movements, electromyography (EMG) was registered from the thumb and index finger during imaginary task, and trials with any movements during imaginary tasks were excluded from further analysis.The EEG signal was bandpass filtered (0.53–30Hz) for comparative ANN and SVM classification. Because we used real motor and motor imagery tasks, there was a possibility that the distinguished features of the finger movements and movement imagery could be represented in both low and high frequency bands in the sensorimotor zones. A real button press is accompanied by desynchronization in the sensorimotor cortex of the contralateral hemisphere at a frequency of more than 10Hz [29,30] preceded by a slow negative wave (800–500ms duration) [31,32]. Evidence from the field of BCI research also supports the value of high frequency signals [23] for motor imagery discrimination.Extra high and slow frequency activities were automatically marked as artifacts and excluded from further analysis. The thresholds were set as follows: (1) 50μV for slow waves in the 0–2Hz band and (2) 35μV for fast waves filtered in the 20–35Hz band. Those corrections were applied to mark artifacts without changes in the native EEG signals and could be successfully applied in future real-time experiments. After artifact correction, the data from each person were merged into one time series and analyzed in sequence using the trial time beginning data.Because people exhibit rather rhythmic patterns of activity, we hypothesized that differences may exist for imagery and motor tasks during the nearby time period (1600ms length interval, 450ms after the cross presentation and 750ms after the trial started). The structure of a trial is shown in Fig. 1. The data from the first 450ms following the cross presentation were excluded from analysis to eliminate the possibility of event-related potentials connected with the visual presentation of the cross. Although we analyzed distinct zones than those involved with visual perception, we wanted to minimize the influence of any possible components of visual perception and processing. The subjects were asked to generate motor behaviors and kinesthetic imagined movements [15]. The areas of interest were in the sensorimotor (Cz and C3 derivations) cortex, which are important to motor and kinesthetic imagery task discrimination [15,33].Most BCIs based on various approaches have similar feature extraction steps:1.allocating areas in the observed EEG channels where the signal is expected;transition to spectral analysis using a Fourier transform;categorization of signal patterns using ANN or SVM classifiers [17,34,35].The disadvantage of transitioning to a spectral analysis is the loss of information regarding the time localization of the features. Therefore, in this study, the signal analysis methods (based on various signal regressions (numerical and symbolic)) were implemented to generate space in time domains.The difficulty of optimizing a parametric regression model remains a highly relevant problem in the field of pattern recognition despite a long history of research. The group method of data handling is widely used and according to this method, is the model that delivers the best approximation in a variety of scenarios [36].In the present paper, a symbolic regression method is used. Symbolic regression is a method of automatic regression models constructed by iterating through arbitrary superpositions of functions from a given data set. Genetic programming is used to construct a superposition of functions and to find the optimal regression model. The search for models is implemented under the iterative scheme “generation – choice” in accordance with certain rules of model generation and criteria for their selection. The sets of competing models are consistently generated, with each model acting as a superposition of a given set of smooth parametric functions. The best models are selected from a set for subsequent modification.Let us pose the problem of finding a symbolic regression model from several independent variables. Let there be n independent variables,Xi,i=1,n¯, and one dependent variable, Y. Additionally, a sample of values, X∈RN×n, of independent random variables is given,X1=xk,1,X2=xk,2,…,Xn=xk,n,k=1,N¯:X=x1,1x1,2⋯x1,nx2,1x2,2⋯x2,n⋮⋮⋮⋮xN,1xN,2⋯xN,n,The vector, Y∈RN, of corresponding values of the dependent random variable isY(X1=xk,1,…,Xn=xk,n)=yk,k=1,N¯:Y=y1y2⋮yN.Additionally, a set of smooth functions is specified: G={g(x, y, z, …)|g:R×⋯×R→R}.The functions,gx,y,z,…∈G, have a finite non-zero number of arguments. Both the values of the independent variables from the matrix, X, and the resulting values of another function, g′∈G, can be used as arguments for g∈G.Consider the set of all possible superpositions of not more than r∈R functions g∈G:Ωr={ω(x)=g1∘g2∘⋯∘gk(x)|gi∈G,i=1,k¯,k≤r}. Each element of the set, ω∈Ωris the smooth function of the vector of independent variables:ω=ω(x),x=x1,…,xnT.The regression modelfr,d(w,x)is specified as follows:(1)fr,d(w,x)=wT⋅1Ω¯dr=w0+w1ω1x+⋯+wdωd(x),where d∈R;w=(w0,…,wd)T∈Rd+1are the vector of parameters of the model; x=(x1, …, xn)T∈Rnis the independent variables vector;Ω¯dr=[ω1(x),…ωd(x)]T,ωi(x)∈Ωr,i=1,d¯is the vector whose components are superpositions of smooth functions in the set Ωr.Finally, we define the set of all regression models:(2)Φr,z={fr,d(w,x)|d≤z}.We define the residual function of the regression modelfr,d(w,x)as follows:(3)p(fr,d)=1N∑k=1N(fr,d(w˜,Xk)−yk)2where Xkis a string of independent variables values matrix X; ykis a component of vector Y, which is the corresponding value of the dependent variable;w˜is a vector of optimal parameters for linear regression modelfr,d(w,x), which is found using the least squares method:(4)w˜=argminw∈Rd+112∑k=1N(fr,d(w,Xk)−yk)2Finally, it is necessary to find a regression modelfr,d(w˜,x)∈Φr,zthat minimizes the residual functional:pfr,d:fr,d(w˜,x)=argminfr,d∈Φr,zp(fr,d).The symbolic regression method was applied to the analysis of EEG signals recorded during imagined and real finger movements. The automatic evolutionary algorithm was shown to be capable of regression analysis of the complicated time series of EEG signals. Consequently, the regression models were developed in the analytical form. Examples of EEG signals corresponding to the imagined movements of the thumb and index fingers and obtained regression models are shown in Figs. 2 and 3.The obtained regression model of the imagined movement of the thumb had the following structure: 0.049x+1.39sin(√(−1.718x))+1.086sin(1.449−0.116x)+0.617sin(12.49x)−1.129√(1.718x1−32.7)−1.15sin(−0.09154x1−1.442)+10.14.The obtained regression model of the imagined movement of the index finger had the following structure: 0.045x+2.79sin(0.86x/√x)−2.084sin(sin(0.124x))+1.557sin(2x/√x)−0.006x√x+0.00016x2−1.132.The obtained models (in analytical form) demonstrate the significance of the sinus component in the regression analysis of bioelectrical signals. The experiments demonstrated the poor accuracy of classical polynomial regression models. The fixed structure of regression models is necessary for applying their coefficients as classifying features. In this case, a concrete form of the model is defined by the coefficients of the fixed terms. A description of the selected structure is provided in the next section.Following experiments on the selection of a regression models structure, the minimum required number of terms for a model was evaluated using the sum of sinus functions: a1*sin(b1*x+c1)+a2*sin(b2*x+c2)+···+a8*sin(b8*x+c8), where ai, bi, ciare the regression model coefficients, i=1:8.An example of an EEG signal corresponding to an index finger movement and the obtained regression model in the form of the sum of sinus functions is shown in Fig. 4.Signal decomposition in the form of the sum of sinus functions presents opportunities for EEG signals to feature space generation.Data analysis in the time domain was shown to be an efficient means of EEG pattern evaluation. The symbolic regression of EEG signals corresponding to mental commands is considered to represent the transition from numerical data to analytical, functional analysis. The key advantage of the proposed method is the automatically generated regression model in an analytic form that represents the structure of brain activity patterns.During the first step, a symbolic regression method was implemented to the entire EEG data sets of imaginary and real movements to find the models of the signals in analytical form. The obtained models indicate the significance of the sinus component in the regression analysis of bioelectrical signals.The regression model of the complicated time series was evaluated in the form of the sum of sinus functions. The resulting coefficients were used as classifying features or as indicators for selecting an optimal time window size.The optimal regression model structure and coefficients were used as indicators for the selection of the time window size for feature calculation. The time window must have a size that is sufficiently large to contain a significant image (at least two local extrema of the superposition of eight sinus functions) and sufficiently small to isolate features of this image.Time windows are required for characterizing the time localization of EEG features. In this study, feature space was generated exclusively within the time domain. This approach was required to isolate the time intervals of the signal, which contributed (more than the other parameters) to the classification accuracy. In this manner, an individual approach can be applied for feature generation within the time domain for each subject.The classification accuracy of a complicated time series, such as EEG signals, depends on the combination of the generated features and the applied classifier. To perform a comparative analysis of various approaches, two variants of feature generation (single-trial and accumulated-trial) and two classifiers (ANN and SVM) were applied.Trial accumulation was generated by summing several trials of the same type, which increased the signal-to-noise ratio (weakened the signal). Therefore, this operation required the extraction of a weak signal. The approach was based on the facts that the evoked potential was repeated during the trial series and that the mathematical expectation of the background signal spread converges to zero. In this study, several variants of trial accumulation were applied (accumulations of 3, 5, 10, 20 trials, as well as a single-trial approach). To this end, it should be noted that trial accumulation exhibits regression properties, which level the individual features of a signal and leave only a common trend.The features for transfer to the classifier were calculated in three steps. In the first step, the pre-processed signals of the C3 and Cz sites, which accumulated according to the variant of the experiment, are divided into overlapping 160ms time windows. The size of the overlapping windows was equal to half that of the time window. In the second step, the area under the curve of the signals in each window is calculated. In the third step, the obtained results are concatenated into one feature vector, which is transferred to the classifier. The first part of the vector was formed with the features of the C3 site signal, and the second part was formed with the features of the Cz site signal.Currently, ANNs are widely implemented for practical analysis in statistics and signal processing. ANNs are based on the principle of non-linear, distributed, parallel and local processing and adaptation.Our study employed ANNs with the backward propagation of errors, one input layer, two hidden layers and one output layer. The sigmoid (hyperbolic tangent) function was used as an activation function for the neurons in the hidden layers, and a linear function was used for neurons in the output layer. ANN topology with two hidden layers was chosen by taking into account the large number of EEG examples that must be accumulated into an associative memory of the network. However, according to Kolmogorov's theorem, we know that every function of n variables can be described as the superposition of 2n+1 one-dimensional functions. Consequently, it is not necessary to use more than 2n+1 hidden elements, where n is the number of input elements. In our case, the input vector consists of features calculated during overlapping time windows in two channels. Thus, we tried to strike a balance between the generalization capability and the goal of taking into account the maximum possible number of curve features.The learning process was performed until the assigned classification accuracy was achieved for the learning sample. The ANN training process was carried out once for each type of movement and for each number of accumulations. The summarized results demonstrated the applicability of the method for complicated time series classification.The original SVM algorithm was invented by Vapnik in 1963 and then further developed with the help of Cortes in 1995 [37]. The SVM was proposed to be a method of linear classification that constructs a hyperplane or set of hyperplanes in a high- or infinite-dimensional space, which can then be used for classification and regression. The optimal hyperplane can be described by the following equation: f(x)=(ω, φ(x))+b, whereω=∑i=1Nλiyiφ(xi), where the coefficient λidepends on a vector of classes yiand on the scalar products (φ(xi), φ(xj)). Consequently, it is necessary to know the values of the scalar products to identify the decision function.Data transformations depend on the kernel function: K(x, y)=(φ(x), φ(y)). When considering linear classifications, the kernel function isK(xi,xj)=xiTxj.However, a method to create nonlinear classifiers by applying the kernel function was proposed in 1992 [38]. The linear kernel function can be replaced by a nonlinear kernel function. This step allows the algorithm to fit the maximum-margin hyperplane in a transformed feature space.In our study, a Gaussian radial basis function was used as the kernel. The corresponding feature space was a Hilbert space of infinite dimensions.The Gaussian radial basis function is indicated by the following:K(xi,xj)=exp(−γxi−xj2), for γ>0.In our work, the SVM classifier was implemented using the LIBSVM package [39]. The regularization parameter and γ were chosen using a “grid-search” with a cross-validation method. The “one-against-one” approach was implemented to realize multiclass classification.Classifiers based on the SVM have become the gold standard in brain activity pattern classification. The main goal of the SVM classifier application in this study was to compare its classifying accuracy with the results of other research groups and with that of the ANN classifier.

@&#CONCLUSIONS@&#
The present study explored the decoding accuracy of EEG signals using real and imagined movements of the thumb and index finger of one hand. The EEG patterns were analyzed using the symbolic regression method to generate automatic regression models in an analytic form. The time windows and feature types were chosen according to the results of the regression analysis.The applied approaches of EEG signal discrimination demonstrated various classification accuracies with various sensitivities to data accumulation. The decoding accuracy of the SVM algorithm based on the Gaussian radial basis function linearly increased with trial accumulation (mean: 45%, max: 62% with 20 trial summarizations). The decoding accuracy of the ANN algorithm was higher for single-trial discrimination (mean: 38%, max: 42%). The empirical guessing level for both approaches was 25%.It was also demonstrated that a high variability in response times did not influence the discrimination accuracy of the algorithms used. These results indicated the possibility of imagined and motor task discrimination using ANN and SVM classifiers and identified the strengths of each classifier.Overall, the classification accuracy of the combination of imagined and real finger movements in our study is comparable to the results of exclusively real finger movements obtained in other EEG studies [23]. The next step will be to use a greater number of fine imagined movements in an attempt to increase the degrees of freedom for noninvasive BCI.Another aim of this study was to isolate the time intervals of the signals that most contributed to the classification accuracy. Using individual, narrow time interval can reduce the duration of training and raise the quality of signal classification. Data analysis of individual, informative time intervals supports the idea of an individual approach, which we consider to be promising for signal analysis and BCI application.The decoding of real and imagined movements of the fingers of one hand is a complicated problem. Because the signal-to-noise ratio of the signals is low, trial accumulation is required to improve the classification accuracy. In practice, it is likely that the subject will have to imagine a movement several times in a row to initiate the corresponding movement of the robotic arm or other real or virtual device. One possible implementation of the results of this study would be a rehabilitation system for subjects after a stroke or with disturbances of the movement system. Our study demonstrated that trial accumulation increases the classification accuracy; we therefore plan to use repeated imagined movements based on a block, possibly rhythmic, paradigm in the future. Repeated imaginary movements in the biofeedback paradigm are proposed to have a healing rehabilitation impact on the above-described subjects. The ability to identify and classify imagined movements based on individual, narrow time intervals is a promising approach for developing adaptive algorithms for BCI.