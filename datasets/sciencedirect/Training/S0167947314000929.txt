@&#MAIN-TITLE@&#
Adaptive likelihood ratio approaches for the detection of space–time disease clusters

@&#HIGHLIGHTS@&#
Fast computational algorithm to detect space–time clusters.Methodology based on adaptive likelihood ratio.Utilizes an adaptive estimator in the configuration space of spatial clusters.The method has a low delay to detect space–time clusters.Allows flexibility in the cluster shape.

@&#KEYPHRASES@&#
Spatial analysis,Space–time clusters,Sequential analysis,Adaptive likelihood ratio,Simulation,

@&#ABSTRACT@&#
A methodology based on adaptive likelihood ratios (ALRs) for the detection of emerging disease clusters is presented. The martingale structure of the regular likelihood ratio is preserved by the ALR. The upper limit for the false alarm rate of the proposed method depends only on the quantity of evaluated cluster candidates. Thus Monte Carlo simulations are not required to validate the procedures’ statistical significance, allowing the construction of a fast computational algorithm to detect clusters. The number of evaluated clusters is also significantly reduced, through the use of an adaptive approach to prune many unpromising clusters. This further increases the computational speed. Performance is evaluated through simulations to measure the average detection delay and the probability of correct cluster detection. We present applications for thyroid cancer in New Mexico and hanseniasis in children in the Brazilian Amazon.

@&#INTRODUCTION@&#
Statistical methods for the analysis of periodic data obtained through surveillance systems (as used in public health, crime and environmental monitoring) are important to detect and locate clusters of cases of diseases in space–time, which may indicate a rapid change in the pattern of observed events. Usually a cluster is an unexpected agglomeration of events in space–time. When the surveillance period is pre-specified and the events are evaluated according to their spatial distribution, a (spatial) cluster is represented by a subset of spatial locations within the study area, where the rate of occurrence is significantly elevated. If the space is ignored in the analysis, the cluster is represented by the group (or sequence) of observations which are associated to the change in the temporal data pattern. However, when both space and time are simultaneously monitored, a space–time cluster is identified by a spatial location/time interval pair where the change occurs.In the spatial scale, the problem of cluster detection may be solved through hypothesis testing. We assume that the geographical map is divided intoLareas (ZIP codes, districts, counties, etc.). For each area, the relative risk is defined as the disease rate of this area divided by the global disease rate. The null hypothesis states that the disease rate is constant over all the map. The alternative hypothesis states that there is a cluster (a connected region with less thanLareas) within the map for which the disease rate is elevated. The location and size of the cluster is considered unknown, thus there are many cluster candidates to be tested. A number of computational algorithms were devised to detect spatial clusters (Cançado et al., 2010; Duarte et al., 2010; Duczmal and Assunção, 2004; Duczmal et al., 2006; Duczmal and Buckeridge, 2006; Duczmal et al., 2007, 2008; Kulldorff, 1997; Kulldorff et al., 2006; Neill, 2012; Patil and Taillie, 2004; Tango and Takahashi, 2005; Takahashi et al., 2008; Yiannakoulias et al., 2007), see Duczmal et al. (2009) for a revision.In the temporal scale, the detection of disease rate change caused by a cluster of observations can be solved employing methods developed for monitoring industrial processes, as for example the CUSUM method (Page, 1954; Roberts, 1966) or the mixture of likelihood ratios (Pollak, 1987); a good revision is presented in Lai (1995). Usually those methods assume that in the control state there is a known rateθ0of disease cases, and under the presence of an epidemic the rate changes toθ1, also known. In practice it is difficult or impossible to maintain these assumptions. As alternative approaches, adaptive (Lorden and Pollak, 2005; Pavlov, 2003; Tartakovsky et al., 2006) and dynamic (West, 1986) methods have been proposed.A space–time cluster is defined by its location in space and its time interval of occurrence. We are interested in the detection of a spatial cluster beginning at some unknown time and still existing in the current time. The Prospective Space–Time Scan Statistic for disease surveillance (Kulldorff, 2001) computes clusters’p-values through Monte Carlo replications. However, thep-value is not adequate to measure the statistical significance of this method. A local Knox statistic combined with cumulative sum methods (CUSUM) using approximations by the normal distribution to monitor space–time cluster in point processes, was proposed elsewhere (Rogerson, 2001). When those approximations are employed, several problems occur (Marshall et al., 2007). Variants of the space–time scan statistic were also devised (Duczmal et al., 2011; Neill, 2011, 2009). Other statistics employed the CUSUM technique (Sonesson, 2007). Based on a partition of the study region, Porter (2007) employs an adaptive version of CUSUM methods and the Shiryaev–Roberts method to detect changes in Poisson processes. Nevertheless, when the outbreak occurs in the boundary between regions, or in a small portion of an area, the detection is compromised due to the inadequacy of the geographic limits of the partition. A variable temporal window method to detect space–time clusters employed the scan statistic combined with a score test (Tango et al., 2011). Cumulative Bayes factors were used to monitor aggregate area map clusters with known disease rate (Lima and Duczmal, 2009, 2012). Adaptive methods for the detection of space–time clusters, combining algorithms for the detection of spatial clusters with temporal monitoring techniques were also presented (Lima, 2011). In general, it is difficult to obtain desirable properties for the methods discussed above which could be useful for disease surveillance. Usual measures like power of detection and significance are not adequate to evaluate the methods, because the process is subject to change during the surveillance (Sonesson, 2007). More precisely, measures such as false alarm rate, false cluster location and detection delay are more adequate in this situation.A possibility should be to monitor space–time clusters using the definition of an ample class of possible spatial candidate clusters and apply the purely temporal methods described above for each possible candidate. However, this procedure is prone to the problem of multiple testing, and eventual methodologies should be adjusted for those multiple comparisons in the space–time domain. In order to present a solution for this problem, we develop a novel methodology, based on adaptive likelihood ratios to compare the null hypothesis (inexistence of clusters) against the alternative hypothesis (presence of an emerging disease cluster). The adaptive likelihood ratio (ALR) preserves the martingale structure of the regular likelihood ratio, which allows the determination of an upper limit for the false alarm rate of our proposed method, which depends only on the quantity of evaluated candidates. This important property allows the use of a relatively fast computational algorithm to determine the cutting point to control the false alarm rate, thus making a viable tool for the detection of emerging space–time clusters in geographical maps. Our developed codes will be available in the public domain and may be requested from the authors.The paper is organized as follows. In Section  2, we formulate the space–time cluster detection problem using likelihood ratio methods. In Section  3, our proposed adaptive likelihood ratio strategy is presented, along with the extension of the adaptive approach to the clusters’ configuration space. A real data application is studied in Section  4. Numerical comparisons are presented in Section  5. Finally, the conclusion remarks are presented in Section  6.Consider a study region represented by a mapSpartitioned intoLcontiguous areasAl, identified by a pointsl, which is the centroid of a polygon delineating the areaAl. LetX={Xt(sl),t=1,2,…andl=1,2,…,L}be the process under surveillance. At each discrete timet≥1we observe a vector withLcomponentsXt=(Xt(s1),Xt(s2),…,Xt(sL))′, such thatXt(sl)represents the number of observed disease cases in thel-th area. LetZbe a connected set of spatial locations (for example, circle) inS,Dn={X1,…,Xn}the set of accumulated data until timenandf(Xt|θt)=fθt(Xt)is a function of known density forXtgiven a chosen value for the parameterθt, for eacht, such thatθt∈Θbelongs to some open set in the finite dimension space. The objective of the surveillance is to verify if an emerging cluster exists. We are interested in detecting a cluster beginning at the unknown timeν≤nwhich is still present at the current timen. The cluster can be understood as the portion of the space–time into which occurs the most significant change from the average pattern of cases of disease, at locationZand at the unknown timeν.The detection of change is obtained through the data evaluation atDnover the collectionZof all possible cluster candidatesZ. The instant of change is the first moment in time for which there is enough evidence to support the belief that a change has occurred in the disease cases pattern. Mathematically, the monitoring is realized using an alarm functionΨn=Ψ(Dn)and control thresholdB, such that the time of alarmτ, indicating a potential change, is given byτ(B)=min{n:Ψn≥B}.If theΨnvalue exceedsB, then there is an indication of possible change in the process, and the alarm is activated. If no change occurs, all the alarms are false. The value ofBis specified in advance.Generally,Zrepresents some regular geometric shape, as circles, ellipses (Kulldorff et al., 2006) or other irregular shapes (Duczmal et al., 2009) such that the cardinality ofZdepends on the shape and size ofZ. Care must be taken to avoid an excessively large cardinality ofZ. Besides, a good monitoring function must be adjusted for the problem of multiple comparisons, have small detection delay, and have the capability to detect correctly at least a substantial part of the emerging cluster.For convenience, denote the event{ν>n}as{ν=∞}. The set of cluster candidatesZ={Zj:j=1,2,…,J}consists of distinct spatial locations inSwhere eachZjwas defined as before. Suppose that{Xt}t=1∞is a sequence of independent vectors with mutually independent components, in the sense thatXt(sl)is independent fromXt(sl′)whenl≠l′and,Xt(sl)is independent fromXt−1(sl). These suppositions are always satisfied whenXtis a Poisson process in aggregated area maps, and also could be relaxed for other probabilistic models. Now introduce the hypotheses:H0:ν=∞andHk,z:ν=k,Z=zwhere the hypothesisH0is such that the baseline cases data corresponds toθ0t={θ0,lt:sl∈S}and underHk,zthe cases distribution after the change timeνinZcorresponds toθ1t={θ1,lt:sl∈Z}∪{θ0,lt:sl∉Z}, withθ0,ltandθ1,ltconsidered fixed (and known) at timet.LetF0andFk,zbe two probability distributions corresponding, respectively, to the hypothesesH0andHk,z, such that underF0the density ofXtis given byf0(Xt)=∏sl∈Sfθ0,lt(Xt(sl)),for allt≥1,and underFk,z, for all1≤k<∞, the density ofXtis given byfk,z(Xt)={∏sl∈Sfθ0,lt(Xt(sl))ift<k∏sl∈zfθ1,lt(Xt(sl))×∏sl∉zfθ0,lt(Xt(sl))ift≥k.That means that if change occurs in the set of locationszat timeν=k, then the pattern of disease cases changes fromθ0,lttoθ1,ltfor allsl∈z. As the vectors are mutually independent and∏sl∈Sfθ0,lt(Xt(sl))=∏sl∈zfθ0,lt(Xt(sl))×∏sl∉zfθ0,lt(Xt(sl))for everyz, then, given the dataDn, the likelihood ratio (LR) between hypothesesHk,zandH0is given by(1)LRn,k(z)=P(Dn|Hk,z)P(Dn|H0)=∏t=kn∏sl∈zfθ1,lt(Xt(sl))∏t=kn∏sl∈zfθ0,lt(Xt(sl)),k≤n.An important property ofLRn,k(z)is that for anyZand (θ0,lt,θ1,lt), underF0the sequence{LRn,k(z),n≥k}is a martingale with expected value equal to one. For a proof, first note thatLRn,k(z)may be written asLRn,k(z)=∏t=kn∏sl∈zfθ1,lt(Xt(sl))×∏sl∉zfθ0,lt(Xt(sl))∏t=kn∏sl∈Sfθ0,lt(Xt(sl))=∏t=knfk,j(Xt)∏t=knf0(Xt).LetE0be the expected value overF0andΛt(z)=∏sl∈zfθ1,lt(Xt(sl))×∏sl∉zfθ0,lt(Xt(sl))∏sl∈Sfθ0,lt(Xt(sl)).Note that for everyt,(2)E0[Λt(z)]=∑xt(∏sl∈zfθ1,lt(xt(sl))×∏sl∉zfθ0,lt(xt(sl))∏sl∈Sfθ0,lt(xt(sl))×f0(xt)),where the sum in (2) is taken over every possible values for the vectorsXt. However,f0(Xt)=∏sl∈Sfθ0,lt(Xt(sl)),implying that(3)E0[Λt(z)]=∑xt∏sl∈zfθ1,lt(xt(sl))×∏sl∉zfθ0,lt(xt(sl))=∑xtfk,z(xt)=1,t≥k,and by the independence of the vectorsXt′s, it follows thatE0[LRn,k(z)]=E0[∏t=knΛt(z)]=∏t=knE0[Λt(z)]=1.Now we obtain(4)E0[LRn+1,k(z)|Xn,…,Xk]=E0[LRn,k(z)×Λn+1(z)|Xn,…,Xk]=LRn,k(z)E0[Λn+1(z)|Xn,…,Xk]=LRn,k(z)E0[Λn+1(z)](by the independence)=LRn,k(z),(by   (3)).Thus, by (3) and (4) it follows that{LRn,k(z)}n≥kis a martingale with mean equal to one. This property of (1) will be important in the construction of the procedure to detect and locate emerging clusters.First we define(5)LRn(z)=max1≤k≤nLRn,k(z)such thatLRn(z)represents the maximum LR value over all possible times for which a change has occurred inz. Letkz=arg[max1≤k≤nLRn,k(z)], then the potential cluster candidates are all cylindersCn(z), whereCn(z)={sl∈S:sl∈z}×[kz,n]represents the emerging cluster in space–time with spatial partzand time part[kz,n]. Obviously, the cluster expresses a change in the distribution of the sub-process{Xt(sl)∈X:sl∈z,t≥kz}.LetCn={Cn(z):z⊂Z}with cardinality|Cn|=|Z|, because the cardinality ofCn, the set of all cylinders with a fixed time interval[kz,n], is the same as the setZof all zones; to see that, observe that for each zonezthere is exactly one cylinderz×[kz,n]∈Cn. Consider now the following procedures as different strategies for the detection of the emerging cluster, according to the choice of the time of alarmτ:•Procedure 1: MAX-LR.(6)τ1(B)=min{n≥1:|Cn|−1max{Cn(z)∈Cn}[LRn(z)]≥B}.The time of alarm is defined as the first instant for which the statistic|Cn|−1max{Cn(z)∈Cn}[LRn(z)]=|Z|−1maxz∈Zmax1≤k≤nLRn,k(z)exceeds the valueBcontrolling the false alarm rate(FAR). It is important to note thatτ1(B)is a natural choice for the detection of emerging clusters, avoiding the problem of choosing different thresholds for each region, because each region may have different change points in time. Note that we assume that the control thresholdBis the same for every potential emerging cluster. We stress the fact that the valueBdepends on the false alarm rate, and if we choose a common valueBfor all candidate solutions then we can guarantee that this rate is the same for every cluster. If there is a valuensuch that the event{|Cn|−1max{Cn(z)∈Cn}[LRn(z)]≥B}occurs, then estimate the emerging cluster by the cylinder(7)Cn̂=Cn(zˆ)=arg(max{Cn(z)∈Cn}[LRn(z)])otherwise, defineτ1(B)=∞formin{0̸}. As long asτ1(B)is based on the maximum value ofLRn(z), it will be called MAX-LR.Procedure 2: MIX-LR.(8)τ2(B)=min{n≥1:|Cn|−1∑Cn(z)∈CnLRn(z)≥B}.Unlike the previous scheme, the procedure based onτ2(B)does not require that every candidate cluster has the same control threshold, because the procedure is based on the sum of the LRs over all candidate clusters. More precisely,τ2(B)is based on a mixture ofLRn(z)with respect to the probability distributionπz=P(Z=z)=|Z|−1=|Cn|−1and for this reason that procedure will be called MIX-LR. Note that∑Cn(z)∈CnLRn(z)=LRn(z1)+LRn(z2)+⋯+LRn(zJ)for allZj∈Z. Larger values ofLRn(z)contribute more to make the alarm ring; thus, if there is some valuensuch that the event{|Cn|−1∑Cn(z)∈CnLRn(z)≥B}occurs, the cluster is then estimated as(9)Cn̂=Cn(zˆ)=arg(maxCn(z)∈Cn[LRn(z)])otherwise, defineτ2(B)=∞formin{0̸}.Procedure 3: W-LR.Define(10)τ3(B)=min{n≥1:|Cn|−1∑Cn(z)∈Cnwn,zLRn(z)≥B}otherwise, defineτ3(B)=∞formin{0̸}. The known valueswn,zrepresent weights supporting the evidence favoring the candidate clustersCn(z)and∑Cn(z)∈Cnwn,z=1, for alln. Here is used the notion of renewed information: different weights are attributed based on the prior information about every possible candidate. The weights are updated when new information is received. Note thatτ2(B)is a particular case ofτ3(B)withwn,z=|Cn|−1. The emerging cluster is estimated by(11)Cn̂=Cn(zˆ)=arg(maxCn(z)∈Cn[wn,zLRn(z)]).Of course, it may not be the same as the cluster estimated usingτ2(B).The procedures for the detection of emerging clusters, based on (6), (8) and (10), produce random time values depending onDn. Desirable procedure characteristics include low false alarm rate(FAR)and reduced delay to detect the cluster.The false alarm rate is defined as Tartakovsky et al. (2006):(12)FAR[τ(B)]=1/E0[τ(B)],whereE0[τ(B)]is the expected value forτ(B) overF0. The quantityFAR[τ(B)]may be interpreted as the average frequency of false alarms. We have the following result:(13)FAR[τi(B)]≤1/B,withi=1,2,3.To prove (13), define firstΨn(z)=∑k=1nLRn,k(z).Note thatΨn(z)is the Shiryaev–Roberts statistic for eachz. Now, underF0the sequence{LRn,k(z),n≥k}is a martingale with expected value equal to one, and consequently{(Ψn(z)−n)}n≥1is a martingale with average equal to zero. This implies that, underF0, the sequence{|Cn|−1∑Cn(z)∈CnΨn(z)−n}n≥1is also a martingale with average equal to zero. In the following, consider two other procedures for the detection of emerging clusters, given by(14)τ4(B)=min{n≥1:|Cn|−1∑Cn(z)∈CnΨn(z)≥B}and(15)τ5(B)=min{n≥1:∑Cn(z)∈Cnwn,zΨn(z)≥B}.Then0=E0(∑Cτ5(B)(z)∈Cτ5(B)wτ5(B),zΨτ5(B)(z)−τ5(B))≥B−E0[τ5(B)]and thusE0[τ5(B)]≥Band analogouslyE0[τ4(B)]≥B. However,τ1(B)≥τ4(B)andτ3(B)≥τ5(B). ThenE0[τ1(B)]≥E0[τ4(B)]≥BandE0[τ3(B)]≥E0[τ5(B)]≥Band by (12)FAR[τi(B)]≤1/B,withi=1,2,3.To show that this result is also valid forτ2(B), it suffices to note thatτ2(B)is a particular case ofτ3(B). LetΔ={τ:FAR[τ]≤α}, for some value0<α<1. AsB=1/α, it implies thatτi(B)∈Δ,i=1,2,3, where0<α<1is the acceptable false alarm rate for the procedure based onτi(B). For example, if we are interested in detecting the emerging cluster using the procedure withτi(B), for a false alarm rate below 0.05, then it suffices to use the valueB=20. The resultτi(B)∈Δ,i=1,2,3is obtained usingB=1/αin the expression (13).In this section we develop the adaptive approach for the parametric spaceΘand also for the space of spatial configurations (the setZ).Although in Section  2.2 it was assumed that the pair (θ0,lt,θ1,lt) is known, this may not occur in practice, because a prior specification for (θ0,lt,θ1,lt) over all possible setsz’s may be impossible to determine. An adaptive approach (Lorden and Pollak, 2005) in the parametric spaceΘwill be adopted to solve this problem.For each possible valuek, let (θˆ0,l[k,t],θˆ1,l[k,t]) be a reasonable estimate for (θ0,lt,θ1,lt) based on{X1=x1,…,Xt−1=xt−1}and define the adaptive likelihood ratio (ALR) as(16)ALRn,k(z)=∏t=kn∏sl∈zfθˆ1,l[k,t](Xt(sl))∏t=kn∏sl∈zfθˆ0,l[k,t](Xt(sl)).By requiring that(θˆ0,l[k,n],θˆ1,l[k,n])does not depend onXn(Lorden and Pollak, 2005), underF0, the sequence(17){ALRn,k(z),n≥k}preserves the martingale structure of (1), such that the upper bound for the false alarm rate given by (13) may be used in the proceduresτ̃i(B)withi=1,2,3for the detection of emerging clusters, where the procedureτ̃i(B)is obtained fromτi(B), just replacingLRn,k(z)byALRn,k(z). A main feature of this approach is that for each fixed parameter value at timet, it is assumed that the pair(fθˆ0,l[k,t],fθˆ1,l[k,t])is a good approximation for(fθ0,lt,fθ1,lt), allowing thatLRn,k(z)be approximated byALRn,k(z).Sinceτ̃i(B)is a function of the adaptive likelihood ratio (ALR), the methodsτ̃1(B),τ̃2(B)andτ̃3(B)are called respectively MAX-ALR, MIX-ALR and W-ALR.Those methods are adaptive, in the sense that, for every timet, the parameters (θ0,lt,θ1,lt) are estimated using only data obtained until timet−1.If those parameters were estimated with data accumulated until timet, we would obviously have a better estimate for (θ0,lt,θ1,lt). However the martingale property would not be valid anymore. In this case, a larger value would be needed for the threshold. This in turn would imply a larger delay for the detection time. The gain thus obtained with the expected reduced delay shows that the adaptive approach is not just a theoretical expedient.Although the valueswn,zare assumed to be known forτ3(B), in practice it is not true. However, definew0,z=w1,z=|Z|−1and, forn≥2, consider an adaptive estimate forwn,zgiven bywn−1,z=(1−ϵ)wn−2,z+ϵALRn−1(z)∑z∈ZALRn−1(z)where0<ϵ≤1is an adaptive factor used to improve the sensitivity of the method in the presence of small changes occurring recently. Sincewn,zis known at timen, the procedure(18)τ̃3(B)=min{n≥1:∑Cn(z)∈Cnwn,zALRn(z)≥B}also belongs to the classΔ, withwn,zsubstituted bywn−1,z. Note that under this formulation the weightswn,zare sequentially updated as soon as we receive new information. The parameterϵis used to control the influence of past information in the evaluation of the surveillance statistic. Whenϵhas larger values, more importance is given to recent changes in the process. Otherwise, for small values ofϵ, a larger weight is given to information coming from more distant past periods of time. For example, usingϵ=0.7the information from two time steps into the past is roughly 30% as important as the current time step. Whenϵ=0we have theτ2statistic. Whenϵ=1only the information from the previous step is used.By definition, the cardinalities ofCnandZare equal. This fact is a potential obstacle for the utilization of the procedures MAX and MIX-ALR because cardinality|Z|of the setZmay be very large if flexibly shaped irregular clusters are included. This implies that the obtained values for MAX and MIX-ALR may be so small that the alarm does not ring, even in the presence of an emerging cluster in the map. To solve this problem, an adaptive procedure is also recommended for the space of spatial configurationsZ.Consider an initial classZ(0)=∪Zl,l=1,2,…,Lwith cardinality|Z0|, whereZl={zl1,…,zlj}. Herezljis thejth set of spatial locations with center insl. For example,zljmay represent a circle centered inslwhose radius increases continuously until it contains 50% of the map spatial locations, or simply may represent a random walk inS, starting atsl. The structure ofZ(0)may be quite general, including both regular and irregular shapes for every setz.With the data accumulated up to the timen−1and centered insl, we use the following estimate forz,(19)zl,n−1∗=arg{maxzjl∈Zl[ARLn−1(zlj)]},and at the present timenwe define the class of spatial configurationsZbyZ(n)={zl,n−1∗:ARLn−1(zl,n−1∗)>1}.If there is not anyzl,n−1∗such thatARLn−1(zl,n−1∗)>1, then defineZ(n)=Z(n−1). That means that, when at timen−1there is not anyzl,n−1∗with valueALRn−1(zl,n−1∗)>1, then the spatial scan is made at timenover all the candidate clusters. Otherwise, if there is at least onezl,n−1∗with valueALRn−1(zl,n−1∗)>1, thenZ(n)represents the most plausible class of candidate spatial configurations to be the spatial part of the emerging cluster. Also note that|Z(n)|≤Lforn>1, and at timenonlyLcandidates must be evaluated. The new classZ(n)is formed by the sets of spatial locations with the largestALRat timen−1, among the collection of all built sets starting from the pointsl,(l=1,2,…,L); further, the sequential analysis over accumulated data is only repeated for the members of this class, speeding up the algorithm and increases sensitivity in the detection of clusters in the methods and MAX MIX-ARL. This approach causes a little loss of accuracy in detection.Noting thatzl,n−1∗=zl,n−1∗(xn−1,…,x1)is measurable at(x1,…,xn−1)(and therefore known at timen), we conclude that{ALRn,k(zl,n−1∗),n≥k}preserves the martingale property of (17).Now, we defineCn∗={Cn(zn∗):zn∗⊂Z(n)}with|Cn∗|=|Z(n)|and as strategies for the detection of the emerging cluster, use the generalized versions of MAX, MIX and W-ALR, with time of alarm given by:•GMAX-ALR.(20)τˆ1(B)=min{n≥1:|Cn∗|−1max{Cn(zn∗)∈Cn∗}[ALRn(zn∗)]≥B}.GMIX-ALR.(21)τˆ2(B)=min{n≥1:|Cn∗|−1∑Cn(zn∗)∈Cn∗ALRn(zn∗)≥B}.GW-ALR(22)τˆ3(B)=min{n≥1:∑Cn(zn∗)∈Cn∗wn,zn∗ALRn(zn∗)≥B}.We present two real data case studies: thyroid cancer in New Mexico and hanseniasis in the Brazilian Amazon.To illustrate the methods developed in the previous sections we consider the thyroid cancer cases for the male population living in theL=32counties of New Mexico state during the 1973–1992 period, see Kulldorff (2001). The average incidence was 2.4 cases per 100000 per year, but varying between counties, ethnicity and age.Assume thatXt=(Xt(s1),…,Xt(sL))′is a Poisson process. LetXt(sl)be the number of disease cases at timetin thel-th areaAlidentified by its centroidsl, and represented in Fig. 1byl=1,…,L=32. ConsiderZl=zrepresenting the circle centered inslwith radius increasing from zero until it contains 50% of the spatial locations. Suppose that under null hypothesisH0we havef0(Xt)=∏sl∈Sμt(sl)Xt(sl)exp{−μt(sl)}/Xt(sl)!and underHk,z, at timetselect a value or a vectorδt,z, and assume thatfk,z(Xt)=∏sl∈S(μt(sl)h[k,t](δt,z)I{t≥k,sl∈z})Xt(sl)exp{−μt(sl)h[k,t](δt,z)I{t≥k,sl∈z}}Xt(sl)!whereI{A}is the indicator function of the eventA, meaning that in the absence of clusters,Xt(sl)has expected valueμt(sl)for allsl∈Sandt≥1, and afterwards, at an unknown timeν=k,1≤k≤n, the process changes to another state with mean levelμt(sl)h[k,t](δt,z)in a setz. The quantityh[k,t](δt,z)>1represents the relative risk and measures the intensity of change in the cluster regionz. Note thatθ0,lt=μt(sl)andθ1,lt=μt(sl)h[k,t](δt,z)for allt≥kandsl∈z.If the intensity of change increases linearly in time, we may assume thath[k,t](δt,z)=δ0+δt,z(t−k),t≥k.For the non-linear case, we defineh[k,t](δt,z)=δ0eδt,z(t−k),t≥k,whereδt,z=(δ0,δt,z), withδ0representing the minimum level of intensity change at timet=k. Without specifying an increasing function, we can also defineh[k,t](δt,z)=δt,zas varying in time, or eitherh[k,t](δt,z)=δzas constant in time. Intensity changes for simple or polynomial regression models were described in Krieger et al. (2003). Using (1), we obtain(23)LRn,k(z)=∏t=kn(h[k,t](δt,z))Xt(z)exp{−μt(z)h[k,t](δt,z)−μt(z)},whereXt(z)=∑sl∈zXt(sl)μt(z)=∑sl∈zμt(sl).Now, using (16) we arrive at(24)ALRn,k(z)=∏t=kn(h[k,t](δz[k,t]))Xt(z)exp{−μz[k,t]h[k,t](δz[k,t])−μz[k,t]},where(μz[k,t],δz[k,t])represents the estimates for(μt(z),δt,z), which depend on the data, through{X1=x1,…,Xt−1=xt−1}.To obtain an estimate forδt,zwe useh[k,t](δt,z)=δz(t−k+1),withδz>1/(t−k+1)representing the increasing risk function in time which is more suitable for detecting emerging clusters (see Tango et al., 2011). UnderHk,z, the maximum likelihood estimator ofδzis∑t=knXt(z)/∑t=kn(t−k+1)μt(z).Defining∑m=kk−1Xm(z)=0, we obtain the maximum likelihood estimate forδzbased on{X1=x1,…,Xt−1=xt−1}, given by(25)δz[k,t]=max{1(t−k+1),∑m=kt−1xm(z)/∑m=kt−1(m−k+1)μm(z)}.This estimate is a function of past data and therefore can capture the temporal correlation between events occurring inZ.For the estimate ofμm(z)withm≤t−1, we note thatμm(z)=∑sl∈zμm(sl)=E0[Xm(z)]=∑sl∈zE0[Xm(sl)]represents the expected number of cases occurring at timeminzunder the assumption of the absence of emerging clusters (it does not depend onk).To adjust the expected number of cases for age and race, definexm,i,r(sl)as the number of cases occurring at timem(1≤m≤t−1)among persons within age groupiand racerin thel-th area, andNm,i,r(sl)as the corresponding population at risk. The estimate of the global disease rate for all areas, restricted to age groupiand ethnicityrat timemis given byλm,i,r=∑sl∈Sxm,i,r(sl)/∑sl∈SNm,i,r(sl). The valueμm,i,r(sl)=Nm,i,r(sl)λm,i,ris an estimate of the number of expected cases for the age groupiand racerat timemunder the hypothesis that there are no emerging clusters. Thus, an estimate of the total number of expected cases in thel-th area at timemisμ[m](sl)=∑i∑rμm,i,r(sl), and, as consequence,μm(z)=∑sl∈zμm(sl). Since under the null hypothesis the expected value ofXt(z)does not depend onk, then we useμz[k,t]=μt−1(z)as the maximum likelihood estimate for the number of expected cases at timet−1.

@&#CONCLUSIONS@&#
In this work we developed a novel method for statistical disease surveillance in aggregated area maps to detect emerging space–time clusters. We combined monitoring techniques originally devised for the temporal scale with adaptive estimation and algorithms for spatial cluster detection, and proposed a novel space–time surveillance method based on the utilization of the adaptive likelihood ratio (ALR). Essentially, the ALR is a genuine likelihood ratio, thus preserving the martingale property, such that the methods developed in this paper do not require the use of Monte Carlo simulations to validate the procedure’s statistical significance. In practice, this greatly reduces the time to compute the solutions.Three alarm functions to detect emerging clusters were defined: the maximum of all ALRs, mixtures of ALRs, and weighted ALRs. We studied one application, with unknown baselines to illustrate our methods. The results obtained for the application were similar to the Prospective Space–Time Scan. However, when the class of cluster candidates was augmented, we observed difficulties in the detection, which motivated the introduction of another adaptive estimator in the configuration space of spatial clusters. Following this approach, we defined generalized versions of the three previous ALR functions: GMAX-ALR, GMIX-ALR and GW-ALR. With those three generalized alarm functions, this novel approach presented two advantages: (i) the computational speed increased, due to the fact that Monte Carlo replications to evaluate the significance of the cluster were not needed; and (ii) the configuration space was reduced, producing more efficient algorithms. Thus, in a map withLareas, the adaptive approach presents the advantage of requiring at mostLcandidates, and the same time controlling the false alarm rate. The flexibility of shape may be used in our adaptive approach, without being necessary to evaluate a very large number of cluster candidates.Although we assume the mutual independence between the random vectors, an important feature of the adaptive approach is the ability to capture the spatial and temporal correlations through the estimation. Although it is virtually impossible to derive the methods’ properties analytically (detection delay and precision), an empirical analysis based on simulations was obtained, with very satisfactory results. Those performance results suggest that the adaptive likelihood ratio strategies, working in both adaptive levels of parametric space and clusters’ configuration space, are very effective in the surveillance of space–time disease clusters.Next are summarized the recommendations for the use of the ALR procedures and the choice of their parameters. The value of the false alarm rate (FAR) depends on the user’s choice. For example, under the null hypothesis, usingFAR=0.05we expect about one false alarm out of every 20 evaluations of the surveillance statistic. The parameterϵis used to control the influence of past information in the evaluation of the surveillance statistic. Larger values ofϵbestow more importance to recent changes in the process. A value ofϵ=0.7gives weight of 70% for one time step before the current time, 21% for two time steps before the current time and 9% for the remaining time steps. For example, in daily surveillance, with a time window of three days, a value ofϵ=0.7orϵ=0.8is recommended. There is a trade-off between delay of detection and spatial location precision. Using the ARL methods we observe smaller delays and reduced PPV values, compared to the prospective scan statistic, as seen in Table 3. The Prospective Scan has the largest delay for all the cases. However, it has the largest (PPV) value, compared to the GMAX, GMIX and GW ALR methods. In epidemiological studies using historical data, the spatial location precision is more relevant; in this case the Prospective Scan is preferred. However, in disease surveillance, the spatial location precision may be sacrificed in order to reduce the delay of detection, which assumes paramount importance, favoring the ALR methods. The best results in our simulations were obtained for the alarm functions GMIX and GW-ALR. Simulations show that when the intensity of change in the process is small the GW-ALR method has the smallest delay; otherwise, for high intensity changes, the smallest delay is attained by the procedure GMIX-ALR.