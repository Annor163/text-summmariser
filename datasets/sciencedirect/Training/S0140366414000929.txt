@&#MAIN-TITLE@&#
Topology management and outage optimization for multicasting over slowly fading multiple access networks

@&#HIGHLIGHTS@&#
We propose a distributed rate allocation scheme for multicasting with network coding.The network is modeled as a collection of slow Rayleigh fading MACs.The rate allocation scheme is based solely on the statistics of the channels.An upper bound is presented for the probability of outage in the fading MAC.The distributed rate allocation scheme is aimed at minimizing the outage probability.

@&#KEYPHRASES@&#
Network coding for multicasting,Wireless networks,Outage capacity,Rayleigh fading,Multiple access channels,

@&#ABSTRACT@&#
This paper examines the problem of rate allocation for multicasting over slow Rayleigh fading channels using network coding. In the proposed model, the network is treated as a collection of Rayleigh fading multiple access channels. In this model, rate allocation scheme that is based solely on the statistics of the channels is presented. The rate allocation scheme is aimed at minimizing the outage probability. An upper bound is presented for the probability of outage in the fading multiple access channel. A suboptimal solution based on this bound is given. A distributed primal–dual gradient algorithm is derived to solve the rate allocation problem.

@&#INTRODUCTION@&#
Network coding extends the functionality of intermediate nodes from storing/forwarding packets to performing algebraic operations on received data. If network coding is permitted, the multicast capacity of a network with a single source has been shown to be equal to the minimal min-cut between the source and each of its destinations [2]. In the past decade, the concept of combining data by network coding has been extensively extended by e.g., [3–5] and it is well known that in order to achieve the multicast rate, a linear combination over a finite field suffices if the field size is larger than the number of destinations. Moreover, centralized linear network coding can be designed in polynomial time [6]. Decentralized linear network coding can be implemented using a random code approach [7]. A comprehensive survey of network coding can be found in e.g., [8,9].Many network resource allocation problems can be formulated as a constrained maximization of a certain utility function. The problem of network utility maximization has been explored extensively in the past few decades [10,11]. We briefly introduce related work on topology management and rate allocation for network coding in multicast over wireless networks. The problem of finding a minimum-cost scheme (while maintaining a certain multicast rate) in coded networks was studied by Lun et al. [12,13]. They showed that there is no loss of optimality when the problem is decoupled into: finding the optimal coding rate allocation vector (also known as subgraph selection) and designing the code that is applied over the optimal subgraph. Moreover, in many cases, optimal subgraphs can be found in polynomial time. If in addition the cost function is also convex and separable, the solution can be found in a decentralized manner, where message passing is required solely between directly connected nodes. This decentralized solution, if coupled with random network coding (e.g., [14,15]) provides a fully distributed scheme for multicast in coded wireline networks. This has prompted many researchers to develop different algorithms that find minimum-cost rate allocation solutions distributively; e.g., [16–19].When addressing the problem of rate allocation for multicast with network coding in wireless networks, Lun et al. [13,20] tackled the problem through the so-called wireless multicast advantage phenomenon. This phenomenon simply comes down to the fact that when interference is avoided in the network (e.g., by avoiding simultaneous transmissions), communication between any two nodes is overheard by their nearby nodes due to the broadcast nature of the wireless medium. In [20], the wireless multicast advantage was used to reduce the transmission energy of the multicast scheme (since when two nodes communicate, some of their nearby nodes get the packet for “free”). Therefore, their wireline minimum-cost optimization problem was updated accordingly (see [20, Eqs. (1) and (40)]). In [19] interference is allowed but is assumed to be limited. Joint optimal power control, network coding and congestion control is presented for the case of very high SINR (signal to noise plus interference ratio). This interference assumption implies that there are some limitations on simultaneous transmissions and this is taken into account in the optimization problem. In [21] the problem of joint power control, network coding and rate allocation was studied. They showed that the throughput maximization problem can be decomposed into two parts: subgraph selection at the network layer and power control at the physical layer. A primal dual algorithm was given that converges to the optimal solution provided that the capacity region is convex with respect to the power control variables (i.e., when interference are ignored). On the other hand, to take interference into account a game theoretic method was derived to approximately characterize the capacity region.In wireless networks, it is reasonable to assume that there is no simultaneous packet transmission or reception by any transceiver. These properties of the wireless medium introduced a new cross-layer interactions that may not exist in the wired network. Sagduyu and Ephremides [22] analyzed and designed wireless network codes in conjunction with conflict-free transmission schedules in wireless ad hoc networks. They studied the cross-layer design possibilities of joint medium access control and network coding. It was shown that when certain objectives such as throughput or delay efficiency are considered, then network codes must be jointly designed with medium access control. The joint design of medium access control and network coding [22] was formulated as a nonlinear optimization problem. In [23] the work reported in [22] was extended and a linear formulation was derived.However, there are certain other considerations that must be taken into account in the search for a rate allocation vector in wireless networks. The wireless medium varies over time and suffers from fading channels due to multipath or shadowing, for example. In [24] the block fading model was introduced. In this model the channel gain is assumed to be constant over each coherence time interval. Typically, fading models are classified as fast fading or slow fading. In fast fading, the coherence time of the channel is small relative to a code block length and as a consequence the channel is ergodic with a well-defined Shannon capacity (also known as the ergodic capacity [25]). In slow fading, the code block length and the coherence time of the channel are of the same order. Hence, the channel is not ergodic and the Shannon capacity is not usually a good measure of performance. The notion of outage capacity was introduced in [24] for transmitting over fading channels when the channel gain is available only at the receiver. In this approach, transmission takes place at a certain rate and tolerates some information loss when an outage event occurs. An outage event occurs whenever the transmitted rate is not supported by the instantaneous channel gain; i.e., when the channel gain is too low for successful decoding of the transmitted message. It is assumed that outage events occur with low probability that reliable communication is available most of the time. A different strategy to deal with slow fading is the broadcast channel approach [26]. In this approach different states of the channel are treated as channels toward different receivers (a receiver for each state). Hence, the same strategy as used for sending common and private messages to different users on the Gaussian broadcast channel can be applied here. When the channel gain is also available at the encoder, the encoder can adapt the power and the transmission rate as a function of the instantaneous state of the channel and thus can achieve a higher rate on average. Moreover, as regards the outage capacity, the transmitter can use power control to conserve power by not transmitting at all during designated outage periods.When dealing with outage capacity for fading MAC, the common outage has a similar definition to the outage event in the point to point case. A common outage event is declared whenever we transmit with rates that are not supported by the instantaneous channel gains. If the channel gains are available at both the decoder and the encoders, additional notions of capacities for the fading MAC need to be taken into account. The throughput capacity region for the Gaussian fading MAC was introduced in [27]. In a nutshell, this is the Shannon capacity region where the codewords can be chosen as a function of the realization of the fading with arbitrarily long coding delays. However, as for the point to point case, this approach is not realistic in slow fading cases since it requires a very long delay to average out the fading effect. Hanly and Tse [28] derived the delay limited capacity for the Gaussian fading MAC (also known as the zero outage capacity). In the delay limited capacity, unlike the throughput capacity, the chosen coding delay has to work uniformly for all fading processes with a given stationary distribution. However, the delay limited capacity is somewhat pessimistic due to the demand to maintain a constant rate under any fading condition. The outage capacity region and the optimal power allocation for a fading MAC were described in [29]. As was pointed out in [29], in a slow fading environment, the decoding delay depends solely on the code-length employed and not on the time variation of the channel.The demand for interference free channels at all nodes means that some level of orthogonality is required between different transmissions in the network. Avoiding interference between all nodes comes at the cost of loss of expensive bandwidth, or alternatively leads to rate degradation in band limited systems. The same argument can be applied to the limited interference model since some orthogonality at a certain radius is required. In [1], the MAC network coding model was introduced. In the MAC network model, in contrast to the wireless broadcast advantage based models, the superposition property of the wireless medium is exploited. The network is treated as a collection of multi access channels, such that each receiver simultaneously receives data from all its in-neighbors.Main contributions: This paper explores the problem of rate allocation for multicasting over slow Rayleigh fading channels using network coding. The problem is examined in a model where the network is treated as a collection of Rayleigh fading multi access channels. In our network model, we assume that links on the network vary faster than the entire network can respond to the variations. Therefore, our goal is to find a rate allocation scheme that is based solely on the statistics of the channels which minimizes the outage probability. This paper differs from prior works at two major aspects. Prior works’ models assume long time averaging of the instantaneous capacity (as in the ergodic capacity approach) or averaging of the packet arrival rate (see e.g., [9]). These assumptions are more suitable for fast fading model while in slow fading model this is unrealistic. Hence, in this paper we design a different rate allocation scheme which is more suitable to the slow fading model. Moreover, in this paper the design of the rate allocation scheme is based solely on the statistics which is desirable in many practical large scale networks, as will be emphasized in Section 4.The communication model is described in detail in Section 2.In Section 3 we present lower and upper bounds for the outage probability of a fading MAC. In Section 4 a suboptimal solution for the rate allocation problem is presented for the MAC network model. The solution is based on an upper bound on the probability of outage in the fading MAC. In Section 5 a distributed solution is derived for the rate allocation problem in the MAC network model. In Section 6 we report some simulation results. We end with concluding remarks.LetG=V,Ebe a directed graph with a set of nodesVand directed edgesE⊂V×V, where transceivers are nodes and channels are edges representing a wireless communication network. In this paper, scalars and random variables are denoted by lower case letters. Vectors and matrices are denoted by boldface lower and upper case letters, respectively. We are abusing of notation a bit by using the same letters to refer to random variables and their realizations. The cardinality of any setAis denoted by|A|. All vectors are columns and inequalities between vectors are defined element-wise; i.e.,v⩽uimpliesvi⩽uifor all i. For any nodej∈V, we denote the in-neighborhood and out-neighborhood of j byI(j)andO(j), respectively, i.e.,I(j)={i:i,j∈E}andO(j)={i:j,i∈E}. The network is treated as a collection of multi access channels, such that each receiver simultaneously receives data from all its in-neighbors. For simplicity, it is assumed that there is no interference between transmissions toward different receivers (see Fig. 1(a)). This can be achieved by orthogonal transmissions e.g., by using a certain frequency reuse pattern or directional antennas. Clearly, this is an improvement over a model where all transmissions are orthogonal. If we consider the MAC network model with deterministic channel gains, a joint power control and rate allocation solution for a (convex) network utility can be found distributively [21]. This is due to the convexity of the capacity region of the multi access channels [30]. The deterministic model can be adapted to deal with fast fading channels in the case of a constant power allocation vector by using the ergodic MAC capacity region instead of the MAC capacity region. This ergodic capacity region is easily obtained by taking the expectations of the capacity constraints [30]. Here, we examine the MAC network model in the case of slow fading channels. We aim to find a rate allocation scheme that is based solely on the statistics of the channels which minimizes the outage probability.The channel gain of link(i,j)is denoted byhi,j.hi,jis a zero mean circular complex normal random variable with variance ofυi,j2. It is assumed that allhi,jare independent of each other. Denote byhj≔hi,j:i∈I(j)and byηj≔|hi,j|2:i∈I(j). The transmission on link(i,j)is denoted byxi,jand it is transmitted with an average powerpi,j. We assume thatσj2is the variance ofξj– the zero mean Gaussian noise at node j. Hence, the received signal at node j is given by:(1)yj=∑i∈I(j)hi,jxi,j+ξj.Fig. 1(b) illustrates the MAC of node 1 in the network of Fig. 1(a). The rate transmitted on a link(i,j)is denoted byri,j, the rate allocation vector is denoted byr=ri,j:(i,j)∈Eand the local rate allocation vector is denoted byrj=ri,j:i∈I(j). When the instantaneous channel gainshi,jare deterministic and known, this is the well-known Gaussian multi access channel [30]. Hence, the instantaneous MAC capacity region is given by:(2)Vjins(hj)≔ri,j:∑i∈M(j)ri,j⩽log21+PM(j),jσj2∀M(j)⊆I(j),wherePM(j),j=∑i∈M(j)pi,j|hi,j|2. However, when dealing with Rayleigh channels, this capacity region may not be a good measure of performance and the outage capacity is a better and more practical alternative. A common outage event is jointly declared for all links whenever we transmit toward a certain node with rates that are not supported by the instantaneous MAC capacity region.Definition 1For a rate vectorrjand for the MAC associated with node j, the common outage event is(3)rj∉Vjins(hj),where the (random) capacity regionVjins(hj)is defined in (2).The probability of outage in the fading MAC of node j is given by(4)Pjout=Prrj∉Vjins(hj).Similar to these definitions, we define an outage event and outage probability for the MAC network model.Definition 3The outage event for the MAC network model is the event for which there exists nodej∈Vsuch thatrj∉Vjins(hj).Hence, the probability of outage in the MAC network model is given by(5)PMACout=Pr⋃j∈Vrj∉Vjins(hj).To complete the description of the local communication model, we associate the codebooks, the encodersFi,j:i∈I(j)and the decodergjthat establish the connection betweenI(j)and j at ratesri,j:i∈I(j)to any node in the network. Obviously, node j shares the appropriate codebooks and encoders with its in-neighbors.The source node is denoted bys∈Vand it is assumed thatI(s)=ϕ. The set of all destinations (sinks) is denoted byDs⊆V⧹{s}. Intermediate nodes are allowed to send out packets that are a combination of their received information and as a result they break the flow conservation by increasing/decreasing the outside rate. However, the main theorem of network coding for multicast is stated in terms of the max-flow (min-cut) between each source and its destinations. Therefore, we distinguish between the flow at an edge(i,j)and the actual rate at that link. Letfi,jdbe the flow at edge(i,j)destined for destinationd∈Ds, and letri,jbe the actual at edge(i,j). The communication parameters are summarized in Table 1.As was mentioned in Section 1, there is no loss of optimality by first finding the optimal rate allocation solution and then designing the coding scheme that realizes the connection. In the following section the rate allocation vector for the MAC network model is given as the solution to an optimization problem and the coding scheme that realizes the connection is assumed to be given. For large scale networks, where global network information is not available, the random network coding shown in [15,14] can be employed. In general, in random network coding, intermediate nodes store all their received packets in their memory and when a packet injection occurs on an outgoing link, the node forms a packet that is a random linear combination of the packets in its memory. In order to enable decoding at the destinations, the random coefficients of the linear combinations are included in the header of the packet as side information. These coefficients are called the global encoding vector of the packet. Decoding is possible if all destinations collect enough packets with linearly-independent global encoding vectors. The algorithm shown in [14] for random packet level network coding was adjusted to the MAC network model in [1].In this section we bound the outage probability of a fading MAC. To do so, we need the following notations and definitions. Consider a (slow) fading MAC with n links each of which is a Rayleigh channel i.e.,hi∼CN(0,υi2)i=1,2,…,n. Denote the variance of the zero mean Gaussian noise at the receiver byσ2. For any matrixB,bi,jdenotes the entry in the ith row and jth column ofB. LetBr∗be a submatrix ofBconstructed by deleting the rth row ofB. Forr=1we denoteB1∗=B∗. For anyn⩾1let1n,0nbe vectors with length n of ones and zeros, respectively. For anyn⩾1, letAnbe a(2n-1)×nmatrix, such that forn=1A1=1and forn⩾2(6)An+1=02n-1,An1,0nT12n-1,An.,i.e., each row ofAnis the binary representation f the row index (for exampleA2=[[0,1]T,[1,0]T,[1,1]T]T). For any scalar a and vectorv∈RK,c=av-1is calculated point-wise; i.e.,ci=avi-1.The probability of outage of a fading MAC is given in Definition 2. Obviously, the probability of outage can be expressed as(7)PrMACnout=1-Prr∈Vins(h),whereh≔h1,h2,⋯,hnandVins(h)is the instantaneous capacity region. As can be seen from (2) the expressionr∈Vins(h)stands for a conjunction of(2n-1)inequalities, each of which is in the form of(8)∑i∈Mri⩽log21+PMσ2,wherePM=∑i∈Mpi|hi|2andMis a subset of{1,2,…,n}. Rewriting (8) in a matrix form yields(9)aMTr⩽log21+aMT1σ2Pη,where,aMis a vector with length n such thatai=1i∈M0otherwise,Pis ann×ndiagonal matrix withp1,p2,…,pnon the main diagonal andη=[|h1|2,|h2|2,…,|hn|2]T. A simple algebraic operation yields that (9) is equivalent to(10)2aMTr-1⩽aMT1σ2Pη.Note that since|hi|2i=1,2,…,nare independent exponential random variables with an expectation of2υi2, the random variableszi=12υi2|hi|2i=1,2,…,nare i.i.d exponential random variables with an expectation of 1. Hence, the event in (10) is equivalent to the event(11)2aMTr-1⩽aMT1σ2Pϒzn,whereϒis a diagonal matrix with2υ12,2υ22,…,2υn2on the main diagonal andzn=[z1,z2,…,zn]Tis a vector of n i.i.d standard exponential random variables;E{zi}=1. Therefore, from (7) and (11), it is implied that the outage probability in a MAC with n links can be written as(12)PrMACnout=1-PrAnDnzn⩾bn,whereDnis a diagonal matrix with1λ1,1λ2,…,1λnon the main diagonal,λi=12υi2σ2piandbn=2Anr-1. For example in a MAC withn=3links we have thatA3=001010011100101110111,b3=2r3-12r2-12r2+r3-12r1-12r1+r3-12r1+r2-12r1+r2+r3-1.Note that when the MAC is with i.i.d links we have thatDn=1λInwhereInis ann×nidentity matrix.Hence, the probability of outage in a MAC is related to the joint distribution of linear combinations of exponential random variables. Huffer and Lin [31] presented an algorithm for the computation of the exact expression of the joint distribution of general linear combinations of spacings1Supposeuii=1,2,…,nare independently and uniformly distributed on the interval (0,1), and letu(1)⩽u(2)⩽⋯⩽u(n)be the corresponding order statistics. The spacingss1,s2,…,sn+1are defined by the successive differences between the order statistics:si=u(i)-u(i-1), whereu(0)≔0andu(n+1)≔1.1by repeated uses of two recursions that reduce the dimensionality of the problem. They also pointed out that the algorithm remains valid as well for linear combinations of exponential random variables. However, this is inaccurate and in this paper we revise result to handle exponential random variables. The new recursion is given in Lemma 6 in Appendix A.By using the algorithm in [31] together with Lemma 6, an exact expression of the probability of common outage can be computed. However, the computation of a symbolic expression becomes extremely complicated in a MAC with more than 2 links. Therefore, we present an upper and a lower bound on that outage probability. To that end, we need the following lemma:Lemma 1Letzbe a vector of n i.i.d exponential random variables with an expectationE{zi}=1. If there exists an entryar,i>0inAsuch thatar,j=0for allj≠iandbr⩾0, the following holdsPrAz>λb=e-λbrar,iPrAr∗z>λbr∗-brar,iar∗.This lemma is an immediate consequence of Lemma 6 (i.e., whenk=1andΨ={j}). □In [32] it was pointed out that the outage probability of a MAC with n i.i.d links is bounded from below by(13)PrMACnout⩾1-e-λSnΓn,λ2Rn-1-Sn(n-1)!,whereΓ(n,x)is the incomplete gamma function,Sn=∑k=1n(2rn-1)andRn=∑i=1nri. In the case of a Rayleigh fading MAC with independent links but with different variances, Theorem 2 gives a lower bound on the probability of outage.Theorem 2Letλi=12ν2σpii=1,2,…,nhave distinct values; i.e.,λi≠λjfor alli≠j, then the probability of a MAC with n independentRayleigh(υi)channeli=1,2,…,nis bounded below by(14)PrMACnout⩾1-∑i=1nγie-βn-λi2Rn-Sn-1,where,γi=∏j≠iλjλj-λi,βn=∑i=1nλi(2ri-1),Sn=∑i=1n(2ri-1)andRn=∑i=1nri.As was explained earlier, the expressionAnDnzn⩾bnin Eq. (12) stands for a conjunction of(2n-1)inequalities. The inequalities that are related to the rows ofAnindexed by2ii=0,1,…,(n-1)stand for the direct instantaneous capacity constraintsri⩽log21+|hi|2piσ2, whereas all the other inequalities refer to constraints that involve more than one link of the MAC capacity region (see Eq. (2)). In particular, the(2n-1)th inequality refers to the constraint∑i=1nri⩽log21+∑i=1npi|hi|2σ2.Obviously,(15)PrAnDnzn⩾bn⩽PrÃnDnzn⩾b̃n,whereÃnis a submatrix ofAnconstructed by taking the rows indexed by{2i:i=0,1,…,(n-1)}∪{2n-1}ofAnandb̃nis a sub-vector ofbnconstructed by taking the appropriate entries ofbn. Note that up to a permutation of the rows, the first n rows ofÃnis the identity matrix. Therefore, we can eliminate these n rows by n uses of Lemma 1. Hence, we have that(16)PrÃnDnzn⩾b̃n=e-βnPr∑i=1nziλi⩾x,wherex=2Rn-Sn-1. The probability of a distinct coefficients linear combination of i.i.d exponential variables is given by Huffer [33](17)Pr∑i=1nziλi⩾x=∑i=1nγie-λix.The claim now follows. □Note that Theorem 2 is valid only whenλ1,λ2,…,λnare all distinct. When we have a MAC with a set of K links with the same value ofλiandn-Klinks with distinct values ofλ, a similar bound can be computed by replacing the probability in (17) by integrating the expression of the pdf derived in [34]. We omit the calculation of this probability here, for the sake of brevity.For simplicity, in the derivation of the upper bound we only consider a MAC with n i.i.d links. Computing the bound for the case where there are independent links with nonidentical variances is much complicated and is considered as future work. The upper bound for a MAC with 3 links is given in Lemma 3 and the upper bound for the general case is given in Theorem 4.Lemma 3The probability of common outage of a MAC with 3 i.i.d links is bounded by(18)PrMAC3out⩽1-e-λ2R3-1G(λα3)whereG(x)=12x2+x+1,λ=12υ2σ2p,R3=∑i=13riandα3=(2r1-1)(2r2-1)(2r3-1).The probability of a successful (non-outage) transmission is given by(19)1-PrMAC3out=PrA3z3⩾λb3.Define the following constantsβi=2ri-1andβi,j=2ri+rj-1. Note that the rows ofA3andb3indexed by{2i:i=0,1,2}satisfy the conditions of Lemma 1. Hence, by three uses of Lemma 1 we can eliminate these rows ofAandb3. These three uses of Lemma 1 are legitimate, since after each use of the lemma the result matrix and vector still satisfy the conditions of Lemma 1 (sinceβi⩾0,βi,j-∑i∈Bβi⩾0and(2R3-1)-∑i=1jβi⩾0, for allB⊆{i,j}andi,j∈{1,2,3}). Therefore, the probability of successful transmission can be rewritten as(20)1-PrMAC3out=e-λS3PrAz⩾λb̃,whereAis a submatrix ofA3constructed by deleting the rows indexed by{2i:i=0,1,2},S3=∑i=13(2ri-1)andb̃=β2,3-β2-β3,β1,3-β1-β3,β1,2-β1-β2,(2R3-1)-β1-β2-β3T. It is easy to see that(21)PrAz⩾λb̃⩾PrÃz⩾λb̃,whereA=011101110111,Ã=010001100111,since the eliminatedz1,z2andz3are non-negative random variables. Note that sinceb̃4-∑i=03b̃i=α⩾0andb̃⩾0, we have thatb̃4-∑i=0jb̃i⩾0for allj∈{1,2,3}. Again, by three uses of Lemma 1, we can eliminate the first three rows ofÃand write(22)PrÃz⩾λb̃=e-λγ̃Prz1+z2+z3⩾λα3,whereγ̃=b̃1+b̃2+b̃3. Note thatZ=z1+z2+z3has anErlang(3,1)distribution and therefore(23)PrZ>z=e-zG(z).Hence, (22) can be rewritten as(24)PrÃz⩾λb̃=e-λγ̃e-λα3G(λα3).Combining (20), (21) and (24) yields(25)1-PrMAC3out⩾e-λα3+γ+γ̃G(λα3).The claim now follows from the fact thatα3+γ+γ̃=2R3-1.□The probability of common outage of a MAC withn⩾3i.i.dRayleigh(υ)channels is bounded by(26)PrMACnout⩽1-e-λ2Rn-1G∼(λαn),whereG(x)=12x2+x+1,Rn=∑i=1nriandαn=∏i=1n(2ri-1).The proof proceeds by induction on n. The claim is true forn=3by Lemma 3. Let the statement be true forn=k. We will now prove the result forn=k+1. From (12) we have that(27)1-PrMACk+1out=PrAk+1zk+1⩾λbk+1.Note thatbk+12k=2r1-1. Also note that by exploiting the structure ofAk+1(see Eq. (6)), the2kth row ofAk+1can be eliminated by using Lemma 1. Hence,(28)1-PrMACk+1out=e-λ(2r1-1)PrÃk+1zk+1⩾λb̃k+1,where(29)Ãk+1=02k-1,Ak12k-1,Akandb̃k+1=2Ãk+1r-1-(2r1-1)02k-1T,12k-1TT. It can easily be verified that(30)PrÃk+1Zk+1⩾λb̃k+1⩾PrAˇk+1Zk+1⩾λb̃k+1,whereAˇk+1=02k-1,Ak02k-1,Ak,sincez1⩾0. Note that for any two vectors02k-1⩽x1⩽x2the following holds(31)PrAˇk+1zk+1⩾x1T,x2TT=PrAkzk⩾x2.Note that(32)2Ãk+1r=2Akγ2r1·2Akγ,whereγ=[r2,r3,…,rk+1]T. Therefore, we have that(33)b̃k+1=2Akγ-12r12Akγ-1.Since2r1⩾1, combining (31) with (33) yields(34)PrAˇk+1zk+1⩾λb̃k+1=PrAkzk⩾λ̃2Akγ-1,whereλ̃=λ2r1. By the induction hypothesis for k, we have that(35)PrAkzk⩾λ̃2Akγ-1⩾e-λ̃2R∼2-1Gλ̃α̃2,whereR̃2=∑i=2k+1riandα̃2=∏i=2k+12ri-1. Combining (28), (30), (34) and (35) yields(36)1-PrMACk+1out⩾e-λ(2r1-1)e-λ̃2R∼2-1Gλ̃α̃2.The claim now follows from the fact thatλ(2r1-1)+λ̃2R∼2-1=λ2Rk+1-1,λ̃α̃2⩾λαk+1and thatG(x)is monotonically increased with x. □Note that the lower bound (13) in the i.i.d case may also be expressed as(37)PrMACnout⩾1-e-λ2Rn-1G∼λ2Rn-1-Sn,where,G∼x=∑k=0n-11k!xk. Hence,(38)G∼(λβn)⩾eλ2Rn-11-PrMACnout⩾G(λαn),whereβn=2Rn-1-Sn.In this section we study the problem of finding the rate allocation vector for the fading MAC network model discussed in the previous sections. In our wireless model we assume a slow fading model with independent Rayleigh fading channels. For simplicity we only consider a network in whichλi,j=λjfor allj∈V⧹{s}. In other words, the network is assumed to be a collection of multiple access channels with i.i.d links (note thatλjj∈V⧹{s}may be distinct). This assumption comes down to the fact that we normalized the transmission power of nodes that connected to the same receiver appropriately to the statistics of the best channel. As was mentioned earlier, the case where there are independent links with nonidentical variances is much complicated and is considered as future work.While it is assumed that the instantaneous channels gain may be available at both the encoders and the decoders, we assume that the rate allocation vector is determined a priori, based solely on the statistics. The rationale for this assumption is that the rate allocation vector is determined based on network considerations, whereas the instantaneous state of each component of the network varies faster than the entire network can respond to the variations. Note that this assumption is practical as well when the power constraints must be satisfied in each encoding block (e.g., when we are under Federal Communications Commission (FCC) regulations).Consider the rate allocation graphG̃=V,E,r(the graph that is obtained by assigning a rateri,jfor each link(i,j)inG). The optimal rate allocation vector that minimizes the probability of outage in the MAC network model while maintaining a multicast rate ofRsis a solution of the following optimization problem:(39)minf,rPr⋃j∈Vrj∉Vjins(hj)subject to(39a)0⩽fi,jd⩽ri,j∀(i,j)∈E,d∈Ds,(39b)∑i∈I(j)fi,jd-∑i∈O(j)fj,id=0j∉{s,d}Rsj=d∀j∈V⧹{s},d∈Ds,where the flow constraints (39a) and (39b) guarantee that any feasible solution of (39) provides a minimum min-cut of at leastRsbetween the source and each destination. Therefore, a multicast rate ofRsis achievable by network coding, see Theorem 1 in [13].Unfortunately, as was mentioned earlier, the computation of the probability of a common outage becomes extremely complicated in a MAC with more than 2 links. Therefore, we present a suboptimal solution to the rate allocation problem in the fading MAC network model. We relax the problem and instead of using the exact expression of the probability of common outage, we minimize an upper bound on the outage probability of a multiple access channel. To that end, consider the following lemma.Lemma 5The probability of common outage of a MAC with n i.i.dRayleigh(υ)channels is bounded byPrMACnout⩽1-e-λ2Rn-1.Forn=1, we have a Rayleigh fading Gaussian channel with outage probability given by:(40)PrMAC1out=1-e-λ2r1-1.Forn=2, a simple computation yields that(41)1-PrMAC2out=e-λ2r1+r2-11+λ2r1-12r2-1⩾e-λ2r1+r2-1.Forn⩾3, the claim follows from Theorem 4 and the fact that for any non-negative x, we haveG(x)⩾1. □The probability of an outage in the MAC network model is given in Eq. (5). By assumption, allhi,jare independent of each other. Therefore, the probability of an outage in the MAC network model can be rewritten as(42)PMACout=1-∏j∈V⧹{s}1-Pjout.Obviously, ifPjoutis bounded above byP̃joutthe following holds(43)PMACout⩽1-∏j∈V⧹{s}1-P̃jout.Although the bound in Lemma 5 is weaker than the one we get from Theorem 4, we used the weaker bound to find a rate allocation vector for the outage MAC model. For everyj∈V⧹{s}denote(44)R∼j≔∑i∈I(j)ri,j.Hence, from Lemma 5 we have(45)PMACout⩽1-∏j∈V⧹{s}e-λj2R∼j-1.Finally, sincee-λ2Rj-1is log-concave the problem becomes computationally tractable:(46)minf,r∑j∈V⧹{s}λj2R∼jsubject to(46a)0⩽fi,jd⩽ri,j∀(i,j)∈E,d∈Ds(46b)∑i∈I(j)fi,jd-∑i∈O(j)fj,id=0j∉{s,d}Rsj=d∀j∈V⧹{s},d∈Ds.In the previous section the rate allocation vector for the MAC network model was given as a solution to the convex optimization problem (46). This problem can easily be solved by a standard convex optimization technique in a centralized fashion. However, the centralized solution requires full knowledge of the network topology and statistics. In this section we discuss how to distributively solve (46).As pointed out in e.g., [13,35,36], if certain conditions are satisfied, convex optimization problems may be solved distributively by a continuous time primal–dual method. This method can be described as follows. The optimization is studied through its Lagrangian where the primal and dual variables are updated simultaneously by a set of gradient laws (dynamic system). These laws define a trajectory in the direction of the respective partial gradients, starting from some initial point. The dynamic system is stated such that the saddle points of the Lagrangian are equilibrium points. Hence, if a strong duality holds for the original convex optimization problem, the algorithm stops updating the variables when it reaches the optimal solution. It is worth mentioning that in contrast to gradient method, in which convergence is guaranteed for convex problems from any initial point (see e.g., Chapter 9 in [37]), the asymptotic behavior of dynamic systems is not immediate in the general case (even though the problem is convex). In other words, convergence to an equilibrium point is not guaranteed in the general case. In this type of problem the existence of Lyapunov functions is used to prove the stability of the equilibrium points. There is no general technique for the construction of these functions. However, in some specific cases the construction of Lyapunov functions is known (see e.g., [38]).As can be easily verified, the cost function in (46) is not strictly convex (and also is not separable in the decision variablesfandr). In problems with a non-strictly convex cost function, it is possible to have more than one optimum point. Hence, in this case the standard primal–dual solution may not converge. In [36] a modified primal dual gradient method was derived for non-strictly convex problems. In that method the solution will converge to one of the optimal points by modifying the constraint set of the convex optimization problem. Following [36], we suggest the following modified convex optimization problem:(47)minf,r∑j∈V⧹{s}λj2R∼j,subject to(47a)ϕ-fi,jd⩽0∀(i,j)∈E,d∈Ds,(47b)ϕfi,jd-ri,j⩽0∀(i,j)∈E,d∈Ds,(47c)ϕqjd⩽0∀j∈V⧹{s},d∈Ds,(47d)ϕ-qjd⩽0∀j∈V⧹{s},d∈Ds,whereR̃jwas defined in (44),ϕ(x)=ex-1and for allj∈V⧹{s},d∈Ds(48)qjd≔∑i∈I(j)fi,jd-∑i∈O(j)fj,id-ψjd,(49)ψjd≔0j∉{s,d},Rsj=d.Note that Theorem 11 in [36] that guarantees convergence for the corresponding dynamic system was proved under the assumption that Slater’s condition holds for the modified convex optimization problem. It is easy to see that Slater’s condition does not hold for (47). However, it can be verified that their proofs remain valid as they are under any other constraint qualification (i.e., whenever strong duality for the modified optimization holds). In Appendix B, we show that strong duality holds for (47). Denote byρi,jd,wi,jd,φjdandμjdthe dual variables of (47) and define(50)Δi,jd≔-φjdeqjd+Ii≠sφideqid+μjde-qjd-Ii≠sμide-qid,whereIi≠s=1ifi≠sand zero otherwise. The primal–dual gradient laws for (47) are given by(51)ṙi,j=τi,j-λjeR∼j+∑d∈Dswi,jdefi,jd-ri,j,(52)ḟi,jd=ki,jdρi,jde-fi,jd-wi,jdefi,jd-ri,j+Δi,jd,(53)ρ̇i,jd=αi,jde-fi,jd-1ρi,jd+,(54)ẇi,jd=θi,jdefi,jd-ri,j-1wi,jd+,(55)φ̇jd=βjdeqjd-1φjd+,(56)μ̇jd=γjde-qjd-1μjd+,whereτi,j,ki,jd,θi,jd,αi,jd,βjdandγjdare some positive scalars and for any two scalars x and p[x]p+=0x<0,p<0xotherwise.The dynamic (51)–(56) can be distributively implemented by associating a processor for each node in the network, excluding the source node. Each node j’s processor keeps track of the variablesφjdandμjdas well as the variables associated with node j’s ingoing links (i.e., the links in{(i,j):i∈I(j)}). Note that message passing is required only between direct neighbors.In this section the probability of outage of the suboptimal algorithm for the MAC network model is presented. In the simulation we consider the networks shown in Fig. 1 where it was assumed that all links are i.i.dRayleigh(υ)channels, withυ=1. We solved (46) for various values ofSNR=Pσ2and the results are shown in Fig. 2. The lower and upper bounds for the outage probability were obtained by calculating (13) and (26) (respectively) for each MAC associated with node j ifI(j)⩾3and the exact expression of the outage probability for each receiver j withI(j)⩽2. As can be seen, up to 6 bits/s/Hz the bounds are quite tight.We compared the performance of the fading MAC network model to the performance of the non-naive TDMA model. The optimal rate allocation scheme that minimizes the probability of outage for the TDMA based model was derived in [1]. The results for the non-naive TDMA model are shown in Fig. 3. Although for low multicast rate demands there is no significant gain in preferring the MAC network model over the Non-naive TDMA model, when we have a demand for a high multicast rate the MAC network model outperforms the TDMA based model. To emphasize this result, note that in the non-naive TDMA model (see Fig. 3) we achieved a multicast rate ofRs≈5.5bits/s/Hz with probability of outage ofPout≈0.1withSNR=30dBwhereas we obtained the same results (i.e.,Rs≈5.5,Pout≈0.1) in the MAC network model withSNR=25dB.Finally, we simulated a discrete time version of the distributed algorithm shown in Section 5. In this version we consider time stepsm=1,2,…and the derivatives were replaced by differences. The scalarsτi,j,ki,jd,θi,jd,αi,jd,βjdandγjdcan be thought as step sizes. We did not optimized these step sizes and they were randomly chosen at the initiation of the simulation (τi,jandki,jdwhere about 10 times larger than the other step sizes). During the simulation, we considered the network sown in Fig. 1 and it was assumed that node 5 was the source node and that the destinations wereDs={1,4,8,10}. The convergence of the algorithm is shown in Fig. 4.

@&#CONCLUSIONS@&#
In this paper we studied the rate allocation problem for multicasting over slow Rayleigh fading channels using network coding. A rate allocation scheme based solely on the statistics of the channels was presented. In the MAC network model, where the network is treated as a collection of slowly Rayleigh fading multiple access channels, we proposed a suboptimal scheme as the solution to a convex optimization problem. This suboptimal solution is based on an upper bound on the probability of outage of a fading multiple access channel. A primal–dual gradient algorithm was derived to solve the problem distributively. In the simulation results, it is shown that the MAC network model outperforms the TDMA based model. The paper provides a practical solution to networks with slow fading channels in which long delays are unacceptable (e.g., in video streaming), with the objective of minimizing outage events throughout the network. As a potential future works, one should consider to derive a bound on the outage probability in the non i.i.d case and extend the problem of statistic-based rate allocation scheme to deal with other than Rayleigh fading model (e.g., Rician or Nakagami models).In this section we present a new version of a recursion that appeared as Eq. (17) in [31]. The lemma in [31] gives a recursion for the computation of the joint distribution of linear combinations of spacings of uniform distribution. The authors in [31] remarked that the recursion remain valid as well for computing the joint distribution of linear combinations of exponential random variables. This is inaccurate and we revise the result to handle exponential random variables. To that end, we need the following notations. LetΨ={i1,i2,…,ik}k⩾1be a set of indices of columns of a matrixAsuch thatiℓ<iℓ+1for allℓand letA-Ψ(m)denote the submatrix of A constructed by deleting the columns ofAindexed by{i1,i2,…,im}.Lemma 6Letz1,z2,…,zN+1be(N+1)i.i.d exponential random variables with expectationE{zi}=1. LetΨ={i1,i2,…,ik},k⩾1be a set of indices of identical columns of matrixA(without loss of generalityiℓ<iℓ+1for allℓ). If there exists a row r inAsuch that (a)ar,i>0fori∈Ψ, (b)ar,i=0fori∉Ψand (c)br⩾0, the following recursion holds(A.1)PrAz>λb=∑m=0k-11m!(λδ)me-λδPrA-Ψ(m)r∗z>λc,whereδ=brar,i1andc=br∗-δai1r∗.As pointed out in [31], since the expressionAz>λbstands for a conjunction of inequalities involving i.i.d random variables,PrAz>λb=PrπAz>λπbandPrAz>λb=PrAπz>λπbhold for any permutation matrixπwith the appropriate dimensions. Therefore, without loss of generality, we assume thatr=1andΨ={1,2,…,k}(see the illustration of such a matrix in Fig. 5). Under these assumptions, the first inequality inAz>λbis(A.2)D=a1,1∑ℓ=1kzℓ>λb1.Clearly,(A.3)PrAz>λb=PrD∩{A∗z>λb∗}.The event D can be written as the union of disjoint eventsD=∪m=0k-1Dm, where(A.4)Dm=∑ℓ=1mzℓ⩽λδ⩽∑ℓ=1m+1zℓ.Therefore,(A.5)PrAz>λb=∑m=0k-1PrDmPrA∗z>λb∗|Dm.Form<k, the rth inequality inAz>λbcan be rewritten as(A.6)∑ℓ=1N+1ar,ℓzℓ>λbr=∑ℓ=1m+1ar,ℓzℓ+∑ℓ=m+2N+1ar,ℓzℓ>λbr=ar,1∑ℓ=1m+1zℓ+∑ℓ=m+2N+1ar,ℓzℓ-ar,1λδ>λbr-ar,1λδ=ar,1∑ℓ=1m+1zℓ-λδ+∑ℓ=m+2N+1ar,ℓzℓ->br-λδar,1=ar,1,ar,m+2,⋯,ar,N+1TTm>br-λδar,1,where(A.7)Tm=∑ℓ=1m+1zℓ-λδ,zm+2,⋯,zN+1T.Therefore,(A.8)PrA∗z>λb∗|Dm=PrA(-m)∗Tm>λb∗-δa∗|Dm.In the following we show that the eventTm|Dmhas the same distribution as(n+1-m)i.i.d exponential random variables. Obviously,Dmis independent withTm∗. Therefore, in order to show thatTm|Dmhas the same distribution as(n+1-m)i.i.d exponential random variables, it suffices to show that∑ℓ=1m+1zℓ-λδ|Dmhas the same distribution aszm+1. Note that(A.9)∑ℓ=1m+1zℓ-λδ|Dm=∑ℓ=1m+1zℓ-λδ|0⩽λδ-∑ℓ=1mzℓ⩽zm+1.Therefore,(A.10)Pr∑ℓ=1m+1zℓ-λδ>x|0⩽λδ-∑ℓ=1mzℓ⩽zm+1=(A.11)Przm+1>x-∑ℓ=1mzℓ+λδ|0⩽λδ-∑ℓ=1mzℓ⩽zm+1.Due to the memoryless property2The memoryless property of an exponential variable means that for anya,b⩾0, we have thatPrZ>a+b|Z>a=PrZ>b, where Z is exponential random variable.2of the exponential random variable we can write(A.12)Przm+1>x-∑ℓ=1mzℓ+λδ|zm+1⩾λδ-∑ℓ=1mzℓ⩾0=(A.13)Przm+1>x-∑ℓ=1mzℓ+λδ-λδ-∑ℓ=1mzℓ=(A.14)Przm+1>x.Therefore, (A.8) becomes(A.15)PrA∗z>λb∗|Dm=PrA(-m)∗z>λb∗-δa∗.Combining (A.5) and (A.15) yields(A.16)PrAz>λb=∑m=0k-1PrDmPrA(-m)∗z>λb∗-δa∗.In order to complete the recursion we need an explicit expression ofPr(Dm).(A.17)Pr(Dm)=Pr∑ℓ=1mzℓ⩽λδ⩽∑ℓ=1m+1zℓ(A.18)=1-Pr∑ℓ=1mzℓ>λδ-Prλδ>∑ℓ=1m+1zℓ(A.19)=Pr∑ℓ=1mzℓ⩽λδ-Pr∑ℓ=1m+1zℓ⩽λδ.Since∑ℓ=1mzℓfollows theErlang(m,1)distribution,3The CDF of Erlang(m,λ)distributed random variable Y is given byFY(y)=1-∑ℓ=0m-11ℓ!(λy)ℓe-λy.3we have that(A.20)Pr(Dm)=1m!(λδ)me-λδ.The claim now follows. □Lemma 7Strong duality holds for(47).Consider the following optimization problem(B.1)minf,r∑j∈V⧹{s}λj2R∼jsubject to(B.1a)ϕ-fi,jd⩽0∀(i,j)∈E,d∈Ds,(B.1b)ϕfi,jd-ri,j⩽0∀(i,j)∈E,d∈Ds,(B.1c)umi∈I(j)fi,jd-∑i∈O(j)fj,id=0j∉{s,d}Rsj=d∀j∈V⧹{s},d∈Ds.Note that the refined Slater’s condition holds for (B.1) and therefore (B.1) has zero duality gap [37], but it does not hold for (47). Obviously, the feasible sets of (46), (47) and (B.1) are all the same and therefore they have identical optimal solutions. We need to show that solving (47) through its Lagrangian yields the same solution. Denote the primal variables byx=(f,r)and the dual variables byζ. Denote the Lagrangians of (47) and (B.1) byL(x,ζ),LM(x,ζ), respectively. The dual function of (47) is given byq(ζ)=minxL(x,ζ). Assume that there existsx̃(ζ)=(f̃,r̃)that is a minimizer ofL(x,ζ)that does not obey the flow conservation constraint (46b). Therefore, there exists nodej∈V⧹{s}such thatqjd≠0. Hence, we have eitherϕ(qjd)>0orϕ(-qjd)>0. Without loss of generality assume thatϕ(qjd)>0. In that case, since the cost function in (47) is bounded below by 0 we can always chooseζsuch that the dual solutionq(ζ)is infinity (by setting allλito zero except the one with the positive coefficientϕ(qjd)>0). This contradicts the feasibility of the primal (47). We conclude by noting thatL(x,ζ)=LM(x,ζ)for anyxobeys the flow conservation constraint (46b). □