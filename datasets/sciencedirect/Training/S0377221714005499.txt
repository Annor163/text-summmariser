@&#MAIN-TITLE@&#
Finding optimal hyperpaths in large transit networks with realistic headway distributions

@&#HIGHLIGHTS@&#
A hyperpath-based transit routing algorithm is developed to handle service irregularity.Using empirical headway data, more than 15,000 headway distributions are fitted.A heuristic greedy algorithm is implemented and compared to the exact method.The proposed algorithm was tested on a large-scale real transit network.

@&#KEYPHRASES@&#
Hyperpath,Headway distribution,Greedy method,Enumeration,Erlang distribution,

@&#ABSTRACT@&#
This paper implements and tests a label-setting algorithm for finding optimal hyperpaths in large transit networks with realistic headway distributions. It has been commonly assumed in the literature that headway is exponentially distributed. To validate this assumption, the empirical headway data archived by Chicago Transit Agency are fitted into various probabilistic distributions. The results suggest that the headway data fit much better with Loglogistic, Gamma and Erlang distributions than with the exponential distribution. Accordingly, we propose to model headway using the Erlang distribution in the proposed algorithm, because it best balances realism and tractability. When headway is not exponentially distributed, finding optimal hyperpaths may require enumerating all possible line combinations at each transfer stop, which is tractable only for a small number of alternative lines. To overcome this difficulty, a greedy method is implemented as a heuristic and compared to the brute-force enumeration method. The proposed algorithm is tested on a large scale CTA bus network that has over 10,000 stops. The results show that (1) the assumption of exponentially distributed headway may lead to sub-optimal route choices and (2) the heuristic greedy method provides near optimal solutions in all tested cases.

@&#INTRODUCTION@&#
Thanks to the revolution in information technology, many transit agencies now have the capability to track their entire fleets, make short-term projections, archive the data and distribute passenger information, all in real time. BusTracker of Chicago Transit Authority (CTA), for example, employs GPS-based automatic vehicle location (AVL) data to project the arrival times of the next transit vehicle at any stop on any route. Similar passenger information systems can be found in other major US cities, such as New York and Washington, DC. These new systems not only enable passengers to use transit information in the real time, but also make available a large amount of operational data that can be used to support better routing and planning decisions. For example, several studies have explored the possibility of using transit AVL data for the purpose of probing traffic conditions (Bertini & Tantiyanugulchai, 2004; Chakroborty & Kikuchi, 2004; Pu & Lin, 2008).This paper will first show that these newly emerging data sources can be used to quantify the irregularities in transit services, in particular headway. Then, a transit routing algorithm that incorporates such empirically observed service irregularities will be implemented and tested to help passengers save travel time and improve travel reliability.The transit routing algorithm developed in this study is built on the notion of hyperpath. A hyperpath represents a sequence of routing strategies rather than a simple path consisting of stops. Routing based on hyperpath promises to make better use of availability of alternative lines in the transit systems. It also offers the flexibility to incorporate real-time information, such as the arrival times of all transit vehicles approaching a stop. It is worth noting that the boarding decision at a stop depends on the waiting time as well as the remaining travel time to the destination once the selected transit line is boarded. This remaining travel time, in turn, is affected by future events such as waiting at subsequent transfers and travel between stops. As a result of service irregularities, the remaining travel time may not be reliably estimated based on the published schedule. Accordingly, decisions have to be made according to what are likely to happen in the future. In light of this observation, the proposed tool copes with uncertainty by choosing an optimal hyperpath to minimize the expected journey time.Hyperpath based transit routing algorithms have been studied extensively in the literature; see the next section for a brief review. Unlike most existing algorithms, however, the proposed algorithm will operate on realistic headway distributions calibrated from archived trajectory data. It has been commonly assumed in the literature that headway is exponentially distributed. With this simplifying assumption all headway distributions can be fully characterized without using any trajectory data, since the standard deviation and mean of the exponential distribution are equal and can be reliably estimated using the scheduled headway. Moreover, exponentially distributed headway reduces the efforts for obtaining expected waiting times and boarding probabilities at transfers to closed form calculation.To validate this assumption, the empirical headway data archived by CTAâ€™s BusTracker Application are fitted into various distributions. The results suggest that the headway data fit much better with Loglogistic, Gamma and Erlang distributions than with the exponential distribution. Accordingly, we propose to model headway using the Erlang distribution in the proposed algorithm. This choice reduces the calculation of expected waiting time and line boarding probabilities to manageable one-dimensional numerical integration. When headway is not exponentially distributed, finding optimal hyperpaths may require enumerating all possible line combinations at each transfer stop, which is tractable only if the number of alternative transit lines is small. To overcome this difficulty, efficient heuristic methods are implemented and compared to the exact method based on enumeration. The algorithms is tested on the CTA bus network, which has over 10,000 stops. We found, among other things, that the assumption of exponentially distributed headway may lead to sub-optimal route choices.The rest of the paper proceeds as follows. Section 2 briefly reviews the literature on the hyperpath problem in transit routing. Section 3 presents the basic analysis of common-lines problem with general headway distributions, as well as the algorithms for finding optimal paths in a transit network. Section 4 describes the sources of headway data and discusses the fitting procedure and results. Section 5 presents the results of numerical experiments, including hyperpath routing in a large-scale CTA bus network. Section 6 concludes the paper.

@&#CONCLUSIONS@&#
