@&#MAIN-TITLE@&#
Optimal hedging when the underlying asset follows a regime-switching Markov process

@&#HIGHLIGHTS@&#
A flexible discrete-time hedging approach for a general regime-switching framework.Minimization of the expected value of any desired penalty function of the hedging error.Backward recursion allows for the sequential construction of an optimal strategy.Efficient numerical implementation is described.

@&#KEYPHRASES@&#
Dynamic programming,Hedging,Risk management,Regime switching,

@&#ABSTRACT@&#
We develop a flexible discrete-time hedging methodology that minimizes the expected value of any desired penalty function of the hedging error within a general regime-switching framework. A numerical algorithm based on backward recursion allows for the sequential construction of an optimal hedging strategy. Numerical experiments comparing this and other methodologies show a relative expected penalty reduction ranging between0.9%and12.6%with respect to the best benchmark.For a derivatives trading and risk management activity to be sustainable, hedging is paramount. In practice, portfolio rebalancing is performed in discrete time and the market is typically incomplete, implying that most contingent claims cannot be replicated exactly. Thus, to implement a hedging policy, the challenge is twofold: a model must be specified and hedging strategy objectives must be set.From a modeling perspective, this article adopts a regime-switching environment. One widely studied class of regime-switching models views log-returns as a mixture of Gaussian variables. These models, introduced in finance by Hamilton (1989), have been shown to improve the statistical fit and forecasts of financial returns. They reproduce widely documented empirical properties such as heteroskedasticity, autocorrelation and fat tails. In this framework, the option pricing problem must deal with incomplete markets and requires the specification of a risk premium. Among significant contributions, Bollen (1998) presents a lattice algorithm to compute the value of European and American options. Hardy (2001) finds a closed-form formula for the price of European options. The continuous-time version of the Gaussian mixture model is studied by Mamon and Rodrigo (2005) who find an explicit value for European options by solving a partial differential equation. Elliott, Chan, and Siu (2005) price derivatives by means of the Esscher transform under the same continuous-time model. Buffington and Elliott (2002) derive an approximate formula for American option prices. Beyond the Gaussian mixture models, extensions address GARCH effects (Duan, Popova, & Ritchken, 2002) and jumps (Lee, 2009a), for example.Several authors study the problem of hedging an underlying asset with its futures under regime-switching frameworks. Alizadeh and Nomikos (2004) and Alizadeh, Nomikos, and Pouliasis (2008) base their hedging strategy on minimal variance hedge ratios. Lee, Yoder, Mittelhammer, and McCluskey (2006), Lee and Yoder (2007), and Lee (2009a, 2009b) extend the dynamics of the underlying asset in Alizadeh and Nomikos (2004) to incorporate a time-varying correlation between the spot and futures returns, GARCH-type feedback from returns on the volatilty, jumps and copulas for the dependence between futures and spot returns. Lien (2012) provides conditions under which minimal variance ratios taking into account the existence of regimes overperform their unconditional counterparts.Option hedging under regime-switching models has recently raised interest in the literature. Rémillard and Rubenthaler (2009) adapt the work of Schweizer (1995) to a regime-switching framework and identify the hedging strategy that minimizes the squared error of hedging in both discrete-time and continuous-time for European options. The implementation of this methodology is presented in Rémillard, Hocquard, and Papageorgiou (2010). Rémillard, Hocquard, Langlois, and Papageorgiou (2012) extend the hedging procedure to American options.Another strand of literature discusses self-financing hedging policies1By contrast, local risk-minimization, which considers hedging strategies that are not self-financing, selects one that minimizes a measure of the costs related to non-initial investments in the portfolio (Schweizer, 1991).1under general model assumptions. A widely known methodology is delta hedging. It consists in building a portfolio whose value variations mimick those of the hedged contingent claim when small changes in the underlying asset’s value occur. In continuous-time complete markets, delta hedging is the cornerstone of any hedging strategy since it allows for perfect replication. Based on the first derivative of the option price with respect to the underlying asset price, it requires a full characterization of the risk-neutral measure. Many authors discuss the implementation of delta hedging in discrete-time and/or incomplete markets (Duan, 1995, among others). It should be stressed, however, that delta hedging is subject to model misspecification. Nevertheless, it stands as a relevant benchmark when it comes to assessing the performance of a hedging strategy.Another approach is super-replication (e.g. El Karoui & Quenez, 1995; Karatzas, 1997). It identifies the cheapest trading strategy whose terminal wealth is at least equal to the derivative’s payoff. Since the option buyer alone carries the price of the hedging risk, the initial capital required is often unacceptably large. Eberlein and Jacod (1997) show that, under many models, the initial capital required to super-replicate a call option is the price of the underlying asset itself.An alternative to super-replication is Global Hedging Risk Minimization (GHRM), which consists in identifying trading strategies that replicate the derivative’s payoff as closely as possible, or alternatively, minimize the risk associated with terminal hedging shortfalls. Xu (2006) proposes to minimize general risk measures applied to hedging errors. Several authors choose more specific risk measures: quantiles of the hedging shortfall (Cvitanić & Spivak, 1999; Föllmer & Leukert, 1999), expected hedging shortfall (Cvitanić & Karatzas, 1999), expected powers of the hedging shortfall (Pham, 2000), Tail Value-at-Risk (Sekine, 2004), expected squared hedging error (Cont, Tankov, & Voltchkova, 2007; Motoczyński, 2000; Rémillard & Rubenthaler, 2009; Schweizer, 1995) and the expectation of general loss functions (Föllmer & Leukert, 2000). Theoretical existence of optimal hedging strategies under those risk measures and their characterization are studied in a general context. However, explicit solutions exist only for some particular cases of market setups and risk measures. The implementation of the preceding methodologies in the case of incomplete markets is often not straightforward, and tractable algorithms computing the optimal strategies have yet to be identified. The presence of regimes adds an additional layer of difficulty in applying those methods.This paper’s contributions are twofold. First, on a theoretical level, we develop a discrete-time hedging methodology with the GHRM objective that minimizes the expected value of any desired penalty function of the hedging error within a general regime-switching framework (possibly including time-inhomogeneous regime shifts). This methodology is highly flexible and generalizes the quadratic hedging approach. It incorporates a large class of penalty functions encompassing usual risk measures such as Value-at-Risk and expected shortfall. The proposed framework can accommodate portfolio restrictions such as no short-selling. Portfolios can be rebalanced more frequently than the regime-switch timeframe. Second, from an implementation perspective, a numerical algorithm based on backward recursion allows for the sequential construction of an optimal hedging strategy. Numerical experiments challenge our model with existing methodologies. The relative expected penalty reduction obtained with this paper’s optimal hedging approach, in comparison with the best benchmark, ranges between 0.9% and 12.6% in the different cases exposed.This paper is organized as follows. In Section 2, the market model and the hedging problem are described. In Section 3, the hedging problem is solved. Section 4 presents a numerical scheme to compute the solution to the hedging problem. Section 5 presents the market model used for the simulations and provides numerical results. Section 6 concludes the paper.Transactions take place in a discrete-time, arbitrage-free financial market. Denote byΔtthe constant time elapsing between two consecutive observations. Two types of assets are traded. The risk-free asset is a position in the money market account with a nominal amount normalized to one monetary unit. The time –nprice of the risk-free asset isSn(1)=exp(rnΔt),n∈{0,1,2,…}where r is the annualized risk-free rate. The price of the risky asset, starting atS0(2), evolves according toSn(2)=S0(2)exp(Yn),whereYnis the risky asset’s cumulative return over the time interval0,n.S→ndenotes the column vectorSn(1),Sn(2)⊤andS→0:nstands for the whole price process up to time n.The financial market is subject to various regimes that affect the dynamics of the risky asset’s price. These regimes are represented by an integer-valued processhnn=0Ntaking values inH=1,2,…,Hwherehnis the regime prevailing during time interval]n,n+1]. The joint process(Y,h)has the Markov property2A stochastic process{Xn}has the Markov property with respect to filtrationFif∀n,x,P(Xn+1⩽x|Fn)=P(Xn+1⩽x|Xn).2with respect to the filtrationFnn=0Nsatisfying the usual conditions, whereFn=σ(S→0:n,h0:n)=σ(Y0:n,h0:n),meaning that the distribution of(Yn+1,hn+1)conditional on informationFnis entirely determined byYnandhn.3Equivalently, the process(S→,h)has the Markov property with respect to filtrationF.3This assumption is consistent with Hamilton (1989) and Duan et al. (2002), among others. Transition probabilities of the regime process h are denoted byPi,j(n)(y)=P(hn+1=j|hn=i,Yn=y)i,j∈H.Because regimes h are not observable, a coarser filtrationGnn=0Nmodeling the information available to investors is required, that is,Gn=σ(Y0:n).A market participant (referred to as the “hedger”) wishes to replicate (or “hedge”) the payoffϕ(SN(2))of a European contingent claim written on the risky asset and maturing at time N, whereϕ(·)is some positive Borel functionϕ:[0,∞)→R. Alternatively, the payoff can be written as a function of the risky asset returnϕ(SN(2))=ϕ̃(YN),for some functionϕ̃(·).To implement the replication, the hedger adoptsG-predictable self-financing4θ={θ→n}n=1Nis a self-financing hedging strategy if∀n⩾1,θ→n⊤S→n=θ→n+1⊤S→n.4hedging strategiesθ=θ→nn=1Nwith time –nvalue5To ease notation,Vn(v0,Y0:n,θ→1:n)is denoted byVn.5Vn(v0,Y0:n,θ→1:n)≔θ→n⊤S→nand initial valueV0≔v0=θ→1⊤S→0. This ensures that all trading decisions are made based on up-to-date price information, regardless of the unobserved regime. Below,θn(k)represents the number of shares of asset k held during period]n-1,n]andθ→nis the column vectorθn(1),θn(2)⊤that characterizes the hedging portfolio.Definition 2.1The set of allG-predictable self-financing hedging strategies satisfying possible additional requirements (such as no short-selling constraints6Or a weaker version of it asking forVnto be positive.6) is denoted byΘ. We refer toΘas the set of admissible hedging strategies.Unobservable regimes and discrete-time trading make perfect replication of the European contingent claim impossible to achieve. The hedger therefore aims to best replicate the payoffϕ̃(YN)according to a certain metric. This justifies the use of a penalty function that sanctions departure of the hedging portfolio’s terminal valueVNfromϕ(SN(2)). Letg·be a Borel functiong:R→Rrepresenting a penalty function. For a given amount of initial wealthv0, the hedger wishes to find an admissible hedging strategy solving(1)minθ∈ΘEgϕSN(2)-VN.The solution is referred to as the optimal hedging strategy. Admittedly,g,ϕ,θandS(2)need to be well-behaved and integrable enough for this expectation to exist.Defining the hedging problem at the terminal date does not require a pricing function for the derivatives, and in particular a characterization of the risk premium. By contrast, hedging strategies considering intermediate dates (option tracking) rely on additional assumptions about the martingale measure.Schweizer (1995) and Rémillard and Rubenthaler (2009) work with the quadratic penality functiong(x)=x2. However, this specification entails that gains and losses on the hedge are penalized equally. In practice, the hedger might be interested in treating gains and losses on the hedge differently. Among asymmetric penalty functions, Pham (2000) investigates the caseg(x)=xp1x>0for a positive constant p, where1·denotes the indicator variable. Another possibility is to chooseg(x)=1x⩾zwhere z is a constant. Such a penalty function induces the minimization of the probability that the hedging shortfall is greater than z. Föllmer and Leukert (1999) and Cvitanić and Spivak (1999) study the hedging problem in continuous time with a similar hedging goal. In this paper, we opt for a general asymmetric penalty function of the form(2)g(x)=α1|x|p1x⩽γ1+α2|x|q1{x>γ2},for some constantsα1,α2,γ1,γ2,p⩾0andq⩾0. This specification encompasses both symmetric and asymmetric penalties and allows different penalty weights to be put on the under- and over-replication of the terminal payoff. Ifq=α1=0andα2=1, the penalty reduces to a Value-at-Risk type of measure. Ifq=α2=1andα1=0, the penalty becomes an Expected shortfall type of measure. The casep=q=2,α1=α2=1andγ1=γ2=0leads to the quadratic penalty.The tools of dynamic programming and the Bellman equation are tailor-made to solve problems of Eq. (1) type if one can invoke the Markov property for the state variables process. However, the observable process Y does not necessarily have the Markov property with respect to the filtrationG, because the cumulative returns depend on the regimes. Indeed, all past values of the cumulative returns path Y give information about the current value of the unobservable regime h. This obstacle is circumvented by defining additional state variables that summarize all the relevant information of Y’s previous path. Those variables allow for the definition of a process that has the Markov property with respect to information flowG.Below,fX→(x→)denotes the joint probability density function (pdf) of a random vectorX→. In some cases, if some components ofX→are discrete-type random variables,fX→(x→)is a mixed pdf. Similarly,fX→|Y→(x→|y→)denotes the pdf ofX→conditional uponY→=y→. All proofs are provided in Appendix A.Definition 3.1The conditional probabilityηi,nof being in regime i at time n given the cumulative returnsY0:nis theGn-measurable functionηi,n≔P(hn=i|Gn)=fhn|Y0:n(i|Y0:n),i∈H.As a special case,ηi,0=P(h0=i)=fh0(i). TheGn-measurable vectorη→n=(η1,n,…,ηH,n)denotes the set of conditional probabilities at time n.Thoseηare the state variables required in the construction of a Markov process with respect to filtrationG. Theorem 3.1 provides a recursion formula allowing for an efficient computation of those probabilities.7An alternative recursion formula is presented in Rémillard et al. (2010). However, the current formula is preferred for two main reasons. First,ηi,nlying in[0,1]makes it numerically more stable. Second, it benefits from a dimension reduction sinceηH,n=1-∑j=1H-1ηj,n.7Theorem 3.1The conditional probabilities are given recursively byηi,n+1=∑j=1Hfhn+1,Yn+1|hn,Yn(i,Yn+1|j,Yn)ηj,n∑j=1H∑ℓ=1Hfhn+1,Yn+1|hn,Yn(j,Yn+1|ℓ,Yn)ηℓ,n.Moreover, ifYn+1andhn+1are conditionally independent uponFn, thenfhn+1,Yn+1|hn,Y0:n(i,Yn+1|j,Y0:n)=Pj,i(n)(Yn)fYn+1|hn,Y0:n(Yn+1|j,Y0:n).Corollary 3.1 states that those conditional probabilities are the natural extension for the cumulative returns to retrieve the Markov property.Corollary 3.1{Yn,η→n}n=0Nhas the Markov property with respect toG.Finally, the next corollary extends the previous one to include the hedging portfolio value. In the general case of predictable hedging strategies, this inclusion unfortunately destroys the Markov property. However, if asset reallocation is solely determined by the information about current cumulative return and portfolio value as well as the recursive conditional probabilities (as defined in Theorem 3.1), then the Markov property can be retrieved. This property is crucial, from a numerical point of view, to obtaining an implementable algorithm.Corollary 3.2For any admissible hedging strategyθ∈Θ, the conditional distribution of(Yn+1,η→n+1,Vn+1)givenGnis the same as if it is conditioned uponσ(Yn,η→n,Vn,θ→n+1). Moreover, if the condition thatθ→n+1isσ(Yn,η→n,Vn)-measurable for any n is added, then{Yn,η→n,Vn}n=0Nhas the Markov property with respect toG.In this section, an optimal hedging strategy is constructed. LetΨN∗be the hedging penalty at time N,(3)ΨN∗≔g(ϕ̃(YN)-VN)and for anyn∈{0,1,…,N-1}, letΨn∗be the smallest possible expected hedging penalty(4)Ψn∗≔minθ→n+1:NEΨN∗|Gnwhereθ→n:N=(θ→n,…,θ→N).Remark 3.1One assumes sufficient regularity ing,ϕand the distribution of{Yn}n=0N, such that, for all n, the minimum in (4) is attained.Eq. (4) is stated as a minimization overN-nportfolio vectors. Theorem 3.2 presents a way to optimize these portfolios one at a time.Theorem 3.2For anyn∈0,1,…,N-1, the smallest expected penalty at time n may be computed using a recursive argument:(5)Ψn∗=minθ→n+1EΨn+1∗Gn.Furthermore, letθ→(n+2):N∗denote one of the possible admissible hedging strategies that minimize the expected penalty at timen+1, that is,θ→(n+2):N∗=arg minθ→n+2:NE[ΨN∗|Gn+1].Then,(6)θ→(n+1):N∗≔arg minθ→n+1EΨn+1∗Gn,θ→(n+2):N∗is a solution to the following equation:θ→(n+1):N∗=arg minθ→n+1:NE[ΨN∗|Gn].This means that the optimal admissible hedging strategy may be built up using a backward induction construction.Eqs. (5) and (6) involve conditional expectations with respect to all past return realizations. Theorem 3.3 shows that it is possible to remove path-dependence and appeal only to conditional expectations with respect to the current state variables(Yn,η→n,Vn).Theorem 3.3Assume that for all n, constraints on the portfolioθ→n+1depend only on the value of(Yn,η→n,Vn). Then,∀n⩽N,Ψn∗isσ(Yn,η→n,Vn)-measurable. Moreover, there exists an optimal self-financing hedging strategyθ→n∗n=1Nthat solves(1)such that∀n⩾0,θ→n+1∗isσ(Yn,η→n,Vn)-measurable. Furthermore,(7)θ→n+1∗=arg minθ→n+1∈σ(Yn,η→n,Vn)EΨn+1∗Yn,η→n,Vn.SinceΨn∗isσ(Yn,η→n,Vn)-measurable, one can writeΨn∗=Ψn(Yn,η→n,Vn). Finally, the next theorem combines Theorems 3.2 and 3.3 to optimize one portfolio vector at a time, searching on the space of hedging strategies for whichYn,η→n,Vnn=0Nhas the Markov property with respect toG. These two features make the algorithm numerically tractable.Theorem 3.4The Bellman EquationThere exists a self-financing hedging strategyθ→n∗n=1Nthat solves problem(1)and the following set of recursive equations:∀n,θ→n+1∗=arg minθ→n+1∈σ(Yn,η→n,Vn)EΨn+1(Yn+1,η→n+1,Vn+1(θ→n+1))|Yn,η→n,Vn.Furthermore, the minimal expected penalty can be computed as follows:(8)ΨN(YN,η→N,VN)=g(ϕSN(2)-VN)=g(ϕ̃(YN)-VN)(9)Ψn(Yn,η→n,Vn)=minθ→n+1EΨn+1(Yn+1,η→n+1,Vn+1(θ→n+1))|Yn,η→n,Vn,n∈0,1,…,N-1.Finally,min{θ→n}∈ΘEgϕSN(2)-VN(θ→1:N)=Ψ0(Y0,η→0,V0).The proof of Theorem 3.4 is a direct consequence of Theorems 3.2 and 3.3 and the definition ofΨn.Analytical solutions to Theorem 3.4’s equations are unlikely to be found for general penalties. Therefore, numerical approximations must be considered in order to implement the algorithm. The numerical application of the hedging algorithm is discussed in this section.Since∑jHηj,n=1, the variableηH,nprovides no additional information. Therefore,η→n=(η1,n,…,ηH,n)can be replaced withη→n≔(η1,n,…,ηH-1,n)in Theorem 3.4. This reduces the dimension of the problem, which is an important numerical issue. Similarly, since for self-financing strategies∑k=12θn+1(k)Sn(k)=Vn, the optimization overθ→n+1is in fact equivalent to optimizing only overθn+1≔θn+1(2).To compute the minimal expected penaltyΨnand optimal portfolio positionθ→n+1from Theorem 3.4, one resorts to a grid whose nodes correspond to a discrete subsample of all possible values of(Yn,ηn,Vn). For each state variable, the largest and smallest values in the grid must be set. One can use the[0,1]bounds forη→since it contains probabilities. VariablesVnandYnare unbounded. Therefore, grid bounds forVnandYnare found numerically using a Monte-Carlo simulation. To this end,105sample paths of cumulative returnsY0:Nare simulated. This yields the approximate distribution ofYnfor all n. The case of the portfolio valueVnis different since the optimal hedging strategy is not yet known. However, a proxyVn(BS)is built forVnusing the Black–Scholes delta hedging as described in Section 5.4.1. LetYn,α, andVn,α(BS)be theαthsample quantiles. DefineYn,mid≔12(Yn,0.25%+Yn,99.75%)andVn,mid(BS)≔12Vn,0.25%(BS)+Vn,99.75%(BS)as the mid-points of two extreme quantiles. For some positive stretching factorsλY(small),λY(large),λV(small),λV(large), the largest and smallest values for the grid at time n are setYn(small)≔1+λY(small)(Yn,0.25%-Yn,mid)+Yn,midYn(large)≔1+λY(large)(Yn,99.75%-Yn,mid)+Yn,midVn(small)≔1+λV(small)Vn,0.25%(BS)-Vn,mid(BS)+Vn,mid(BS)Vn(large)≔1+λV(large)Vn,99.75%(BS)-Vn,mid(BS)+Vn,mid(BS).A numerical algorithm allowing for the computation of the minimal expected penalty and the optimal portfolio position at each time step is given in this section. First, define two grids of different sizes (one finer and one coarser) containing a discrete subset of values for(Yn,η→n,Vn).Assume that(Yn,η→n,Vn)=(y,η→,v). According to Theorem 3.4, the goal is to evaluate Eq. (9) at each node(y,η→,v)of the grid:Ψny,η→,v=minθ→n+1EΨn+1(Yn+1,η→n+1,Vn+1(θ→n+1))|(Yn,η→n,Vn)=(y,η→,v).From Theorem 3.1,η→n+1is a function of(Yn+1,Yn,η→n). Seen from node(y,η→,v), it may be denotedη→n+1y,η→(Yn+1). Because the amount invested in the riskless asset is the value of the portfolio minus the investment in the risky asset, the time –(n+1)value of the hedging portfolio, seen from the grid point(Yn,η→n,Vn)=(y,η→,v), isVn+1(θ→n+1)=θn+1(1)exp(r(n+1)Δt)+θn+1(2)S0(2)exp(Yn+1)=exp(rΔt)v-θn+1(2)S0(2)exp(y)+θn+1(2)S0(2)exp(Yn+1)=Vn+1y,v(θ→n+1,Yn+1).Therefore, the expected penalty at time n and at grid point(y,η→,v)satisfiesΨny,η→,v=minθ→n+1EΨn+1Yn+1,η→n+1y,η→(Yn+1),Vn+1y,vθ→n+1,Yn+1(Yn,η→n,Vn)=(y,η→,v)=minθ→n+1∑j=1Hηj,nEΨn+1Yn+1,η→n+1y,η→(Yn+1),Vn+1y,v(θ→n+1,Yn+1)(hn,Yn,η→n,Vn)=(j,y,η→,v)(fromEq.(20))=minθ→n+1∑j=1Hηj,n∫-∞∞Ψn+1y,η→,vθ→n+1,zfYn+1Yn,η→n,Vn,hn(z|y,η→,v,j)dz=minθ→n+1∑j=1Hηj,n∫-∞∞Ψn+1y,η→,vθ→n+1,zfYn+1Yn,hn(z|y,j)dz(MarkovpropertyandLemma A.1)whereΨn+1y,η→,v(θ→n+1,z)=Ψn+1z,η→n+1y,η→(z),Vn+1y,v(θ→n+1,z).In general, there is no closed-form solution for this integral and it is evaluated numerically. Therefore, the support ofYn+1is partitioned in M intervals with boundaries-∞=z0<z1<⋯<zM-1<zM=∞andzi∗∈zi-1,ziacts as a representative of the interval[zi-1,zi]. Letωiy,j,nbe the following quadrature weights:ωiy,j,n=FYn+1|Yn,hn(zi|y,j)-FYn+1|Yn,hn(zi-1|y,j),FYn+1|Yn,hnbeing the cumulative distribution function ofYn+1given(Yn,hn). Then,(10)∫-∞∞Ψn+1y,η→,vθ→n+1,zfYn+1|Yn,hn(z|y,j)dz=∑i=1M∫zi-1ziΨn+1y,η→,vθ→n+1,zfYn+1|Yn,hn(z|y,j)dz≅∑i=1MΨn+1y,η→,vθ→n+1,zi∗∫zi-1zifYn+1|Yn,hn(z|y,j)dz=∑i=1MΨn+1y,η→,vθ→n+1,zi∗ωiy,j,n.In general, the approximation (10) is good if the distances between theziare small and theΨn+1function is relatively smooth. Theziare chosen to be quantiles of the conditional distributionFYn+1|Yn,hn. To better capture the impact of extreme events, particular attention is paid to the tails of the distribution. The left (right) tail is defined as the smallest (largest) 5% values of the distribution. TheM(1)smallestzi’s correspond to quantiles of levelk5%M(1),k∈{1,2,…,M(1)}. The central part of the distribution is proxied byM(2)quantiles of levelk90%M(2)+5%,k∈{1,2,…,M(2)}, while the right tail is represented byM(3)quantiles whose level lies in]95%,100%]. Consequently, the weightsωiy,j,nare5%M(1),90%M(2)or5%M3depending on which part of the distributionzibelongs to. Among possible specifications,zi∗are chosen as quantiles whose level is the mean between the levels ofzi-1andzi.Because the maximization is time-consuming, especially if it must be done at all nodes of the lattice, the research area is reduced to a discrete setOof values:(11)Ψn(y,η→,v)≅minθ→n+1∈O∑i=1MΨn+1y,η→,vθ→n+1,zi∗ωiy,η→,n.Since the backward induction on time leads to a numerical approximationΨ^n+1ofΨn+1, the latter is replaced by former in Eq. (11) in applications.Step 1: Rough estimate of optimal hedging strategy.A rough estimate of the optimal hedging strategy isθˆn+1y,η→,v=arg minθn+1∈O∑i=1MΨ^n+1y,η→,vθ→n+1,zi∗ωiy,η→,n.By construction, thezi∗do not match the grid’s discretization of next period returnYn+1. For this reason, interpolation is required to evaluate each of theΨ^n+1y,η→,vθ→n+1,zi∗whose arguments most likely lie between the grid nodes. This step proceeds with multivariate linear interpolation.8This approximation ofΨ^n+1is not involved in further iterations. Therefore, while high precision is not a crucial issue at this step, computational speed is.8Step 2: Smoothing of the hedging strategy.From step 1, one gets an approximate portfolio positionθˆn+1∗for every node of the coarse grid at time n. For every value of(y,η→,v)on the finer grid, one computes the hedging portfolio positionϑˆn+1y,η→,vusing smoothing splines based onθˆn+1.ϑˆn+1is now used as the final estimation of the optimal hedging portfolio position.Step 3: Recalculation of the value function.A finer partition of the distribution ofYn+1and the corresponding weights, denoted byz̃i∗andω̃i,i=1,…,M∼, serve for the approximation of the minimal expected penalty function with the new portfolio positionϑˆn+1. Thus, mimicking Eq. (11),Ψ^n(y,η→,v)=∑i=1M∼Ψ^n+1y,η→,vϑˆn+1y,η→,v,z̃i∗ω̃iy,η→,n.The subsequent iteration of the three-step algorithm will call this new approximation forΨˆn. Thus, to minimize the accumulation of errors, the interpolation is performed with natural splines.9Natural splines in three dimensions are implemented through the interp3 matlab function.9As in Hamilton (1989), the regime process is assumed to be a Markov chain, implying that the conditional distribution ofhn+1givenFnis the same as if it were conditioned uponhn. The model can accommodate a regime shift timeframe which is coarser than the rebalancing schedule. In that context,τrepresents the number of periods between two possible regime transitions andhnn=0Nbecomes a time-inhomogeneous Markov chain with probability transition matrixP(n)(y)=Pif(n+1)modτ=0IH×Hotherwise,whereIH×His the identity matrix.A basic model based on two regimes (H=2) serves as benchmark to test the proposed algorithm. Conditioned on the actual regimehn=i, the one-period log-return∊n+1=Yn+1-Ynhas a Gaussian distribution with meanμiΔtand varianceσi2Δt.The application of Theorem 3.4 relies on the following relations:Yn+1=Yn+∊n+1Vn+1=VnerΔt+θn+1S0eYn(e∊n+1-erΔt)η1,n+1=∑j=1HPj,1(n)ηj,nf∊n+1|hn(∊n+1|j)∑u=1H∑j=1HPj,u(n)ηj,nf∊n+1|hn(∊n+1|j),whereη2,n=1-η1,nandf∊n+1|hn(∊n+1|j)is the Gaussian density function(12)f∊n+1|hn(∊n+1|j)=12πΔtσjexp-12(∊n+1-μjΔt)2σ(j)2Δt.The conditional distribution of∊n+1|(Yn,ηn,Vn)is a mixture of two Gaussian distributions:P(∊n+1⩽x|Yn,ηn,Vn)=P(∊n+1⩽x|hn=1)η1·n+P(∊n+1⩽x|hn=2)(1-η1,n)=Φx-μ1σ1η1,n+Φx-μ2σ2(1-η1,n),whereΦis the standard normal cumulative distribution function.Moreover, the following boundaries can be used forηin the algorithm of Section 4:Proposition 5.1For allj,n,mini∈HPi,j(n)⩽ηj,n+1⩽maxi∈HPi,j(n).The proof is in Appendix A.Regime switches potentially occur each week and rebalancing is performed weekly (Δt=1/52,τ=1) or daily (Δt=1/260,τ=5). Maximum likelihood with the Baum–Welch algorithm (Baum, Petrie, Soules, & Weiss, 1970), a particular case of the EM algorithm of Dempster, Laird, and Rubin (1977), is applied to a sample of S&P 500 weekly log-returns from January 1, 2000 to December 31, 2010. Parameter estimates are reported in Table 1.A p-value of34.4%for the Cramer-Von-Mises parametric bootstrap goodness-of-fit test (see Genest & Rémillard, 2008) for the regime-switching process indicates that the model is not rejected. The first (second) regime represents an economy in expansion (recession): returns exhibit a positive (negative) mean with a low (high) volatility. The risk-free rate is set tor=2%.The option to be hedged is a European at-the-money call option with payoffϕ(SN)=max(0,SN-E). The initial index value isS0=1257.64, which is the value of the S&P 500 on December 31, 2010. The option strike isE=1257. The maturity of the option is 12weeks.10That is,N=60periods for daily rebalancing andN=12for weekly rebalancing.10The initial probability of being in regime 1 is set toη0=0.2318. This value is chosen instead of the estimated value on the S&P 500 time series because it leads to the same call option price under the Black–Scholes and Hardy models (see Sections 5.4.1 and 5.4.2, respectively). Thus, both these hedging methodologies use the same initial capital, which makes the numerical results comparable. The initial hedging capital, which is the option price under those models, isV0=62.4316.The following penalty functions are under consideration:(13)g(x)=x2quadratic,(14)g(x)=x21{x>0}shortquadratic,(15)g(x)=x21{x<0}longquadratic,where x represents the hedging errorϕ̃(YN)-VN. The quadratic penalty sanctions departures from the option payoff. The short (long) quadratic penalty is designed for the option seller (buyer), since it does not penalize profits; only losses are sanctioned.The restrictions considered on the portfolio positions are that∀n,θn∈[0,1], thereby preventing short sales and excessive leverage.In order to compare the hedging model presented in this paper, benchmarks must be set. In the following, the optimal hedging strategy presented in Section 3 is referred to as “minimal expected penalty hedging” (MEPH).The most common hedging strategy relies on delta hedging.11The empirical performance of delta hedging under different option pricing models is investigated by De Giovanni, Ortobelli, and Rachev (2008).11In this case, a pricing kernel is required to compute the deltas. The first two benchmarks examine two pricing models.The classic Black–Scholes delta with a modified volatility determines the position held in the underlying asset12Black–Scholes delta hedging under model misspecification is studied in Augustyniak and Boudreault (2012).12:θn+1(BSDH)=Φlog(Sn/E)+(r+.5ζ2)Δt(N-n)ζΔt(N-n),whereζis the asymptotic stationary volatility of log-returns∊nin the caseτ=1:(16)ζ=∑j=1HPj∗(σ(j)2+μ(j)2)+∑j=1HPj∗μ(j)2,P∗is the stationary distribution associated with the transition matrix P. In the caseτ>1, the stationary distribution for the regimes does not exist in general because of the cyclical nature of the Markov chain transition probabilities. Nevertheless, Eq. (16) is used as the presumed market volatility. The characterization of the hedging position is explicit and does not require a lattice approximation.The initial capital used for hedging is the option price given by the Black–Scholes formula with the volatility given by (16). The Black–Scholes hedging methodology can be seen as a naive benchmark that would be applied by a hedger who ignores the presence of regimes in the market.In Hardy’s (2001) two-regime model, the risk-neutral dynamics of one-period log-returns∊n+1follow a mixture of Gaussian distributions. The delta hedging strategy commands that:θn+1(HDH)=∑j=12ηj,nQ∑R=0N-nΦlog(Sn/E)+(N-n)rΔt+Rσ12/2+(N-n-R)σ22/2Δt)Rσ12+(N-n-R)σ22Δtfnj(R),wherefnj(R)is the probability, given current regime i, that the number of periods between times n and N spent in the first regime is R. Probabilitiesfnj(R)can be computed recursively (see Hardy, 2001).ηj,nQis the risk-neutral probability of being in regime j during time interval]n,n+1]given the current partial informationGn. With this benchmark, the initial capital used for hedging is the option price. The hedger acknowledges the existence of regimes, but assigns an arbitrary risk premium to price options.Besides delta hedging, Rémillard and Rubenthaler (2009) propose a global hedging risk minimization approach. The hedging strategyθminimizes the expected terminal squared error of hedging with respect to complete informationF. This implies perfect knowledge of the current and all past regimes. Since in practice the states h are not observable, Rémillard et al. (2010) forecast them with the most likely regime.LetΘ‾be the set of allF-predictable self-financing strategies.13By contrast, the MEPH strategy isG-predictable.13The FRQH strategy solvesminθ∈Θ‾E(ϕ(SN)-VN)2.With this benchmark, the hedging problem is based on the terminal date. Therefore, no assumption related to the risk premium is needed, which implies in particular that this strategy works with any initial capital. However, it comes at the price of using a lattice approach to compute the strategy. The hedger acknowledges the existence of regimes. However, the hedging objective is restricted to the quadratic penalty. Furthermore, the uncertainty surrounding regime forecasts is not taken into account.The grid’s stretching factors are(λY(small),λY(large),λV(small),λV(large))=(.6,.6,1,1). For step 1 of the algorithm in Section 4.3,M(1)=M(3)=100andM(2)=200. For step 3,M∼(1)=M∼(3)=200andM∼(2)=300. Putting more points near the tails is used to better capture the extreme events which contribute more heavily to the hedging penalty. The discrete setOover which theθnare optimized in step 1 of the algorithm isO={j/99|j=0,…,99}.The number of grid nodes for each variable on the finer grid (step 3) is:(17)(#Yn,#ηn,#Vn)=(200,100,200)ifn=N-1(150,100,150)otherwiseMore nodes are put on the first step of the recursion as it can be computed faster because of explicit formulas.14An explicit expression forΨN-1exists for the quadratic penalty. For the short (long) quadratic penalty, an explicit expression forE[ΨN∗(θN)|GN-1]also exists. Details are available on request.14For the coarse grid in step 1, only a subset of the nodes of the finer grid in step 3 are retained. The proportion of nodes kept in the coarse grid from the finer grid across dimensionsYn,ηnandVnis1/3,1/3and1/4.The numerical efficiency of the current paper’s hedging algorithm is validated by means of Monte-Carlo simulations. The MEPH and FQRH strategies are implemented through a lattice. Hedging errorsϕ̃(YN)-VNand hedging penaltiesg(ϕ̃(YN)-VN)are computed forI=106simulated paths of the underlying returns.Table 2reports estimates of the expected penalty and their standard error for each hedging methodology. Note that only the MEPH strategy is affected by the choice of penalty function. For the three benchmarks, the hedging strategy remains the same, but the calculated penalty differs.A first observation is that the MEPH grid estimate is relatively close to the simulated expected penalty. This confirms the accuracy of the numerical implementation.In all six cases considered, the MEPH strategy significantly reduces the expected penalty. The magnitude of the penalty dispersion is comparable across all hedging strategies.As for the quadratic penalty, the MEPH reduces the expected penalty by6.0%in the weekly case and by0.9%in the daily case with respect to the best benchmark, namely BSDH for weekly and FRQH for daily. The short (long) quadratic penalty is specifically designed for the call option seller (buyer). The MEPH reduces the expected penalty by12.6%(3.8%) in the weekly case and by4.5%(3.7%) in the daily case with respect to the best benchmark. The latter differs across penalties and rebalancing frequencies. For the weekly case, the second best strategy is HDH for the long quadratic penalty and BSDH otherwise. In the daily case, as regime forecasts are more accurate, the FRQH method performs better than the other two benchmarks.Hedging errors drive hedging penalties and are therefore worthy of investigation. However, descriptive statistics about hedging errors should not be the sole basis on which to judge the performance of hedging strategies. Nevertheless, analyzing those quantities sheds light on how the penalty performance is achieved. Fig. 1displays the hedging error distributions for the quadratic MEPH and the three benchmarks. All distributions exhibit bimodality with similar mode locations but different frequencies.The distribution behavior, especially in the tails, is better described by Tables 3 and 4. In terms of RMSE, the quadratic MEPH strategy slightly dominates all other benchmarks for both weekly and daily rebalancing. This is consistent with the quadratic objective of reducing the occurrence of large deviations of the hedging portfolio from the derivative. As far as Value-at-Risk (VaR) and Tail Value-at-Risk (TVaR) are concerned, the picture is not as clear. The short quadratic MEPH used by a call seller performs slightly better than the other hedging strategies.15The 95th and 99th percentiles and TVaR are smaller than those of all benchmarks (except for the 99% TVaR of the HDH with daily rebalancing).15For the call option buyer, MEPH is the second best behind HDH for both VaR and TVaR risk measures.Hedgers using the short quadratic penalty perceive the left tail as positive outcomes. Therefore, it is not surprising that left tail VaRs and TVaRs are smaller for the HDH than for the short quadratic MEPH. Furthermore the quadratic MEPH aims at shrinking both tails, but it does not imply that it should beat the HDH on the two tails simultaneously. The right tail is much slimmer for the quadratic MEPH than for the HDH. Therefore the HDH can have a slimmer left tail on the extremes and still be beaten by the quadratic MEPH when the symmetric penalty is considered.More interestingly, the HDH also displays a lower TVaR than the MEPH with long quadratic penalty (although the difference is rather small). This may sound surprising since, by construction, the MEPH with long quadratic penalty aims at reducing the left tail of the hedging error. However, inspection of Fig. 1 reveals that this phenomenon is due to the presence of a hump in the left tail of the HDH hedging errors. Although this hump represents negative outcomes for the hedger using the long quadratic MEPH, it is not located in the extreme part of the left tail and is therefore not taken into account by the VaR and TVaR measures.If a specific risk measure is the ultimate objective, the penalty function should be designed accordingly. Indeed, our methodology precisely permits to adapt the hedging strategy to the desired performance criterion. To illustrate this flexibility, Fig. 2shows the effect of the penalty choice on the MEPH hedging error distribution.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
