@&#MAIN-TITLE@&#
A multiscale finite element technique for nonlinear multi-phase materials

@&#HIGHLIGHTS@&#
Multiscale finite element homogenization technique for modelling deformation in multi-phase materials.Effective macroscopic tangent modulus consistent with the periodic boundary condition in the microstructure.Numerical tests concerning plastic materials with different voids distributions proved the effectiveness of the technique.

@&#KEYPHRASES@&#
Finite Element Method (FEM),Voids,Plasticity,Multiscale,Homogenisation,Condensation technique,

@&#ABSTRACT@&#
This paper presents a multiscale finite element homogenization technique (MFEH) for modelling nonlinear deformation of multi-phase materials. A novel condensation technique to relate force variations acting on the representative volume element (RVE) – involving antiperiodicity of traction forces at RVE corners – and displacement variations on boundary-nodes is proposed. The formulation to accommodate the condensation technique and overall tangent modulus is presented in detail. In this context, the effective homogenised tangent modulus is computed as a function of microstructure stiffness matrix which, in turn, depends upon the material properties and geometrical distribution of the micro-constituents. Numerical tests concerning plastic materials with different voids distributions are presented to show the robustness of the proposed MFEH.

@&#INTRODUCTION@&#
The heterogeneous nature of materials has a significant impact on the observed macroscopic behaviour of multi-phase materials. Their properties depend upon the size, shape, spatial distribution and material parameters of microconstituents and their respective interfaces. For instance, in reinforced composites, stiff and strong phase inclusions of glass, graphite, boron, or aluminium oxide, are added to epoxy resin, steel, titanium, or aluminium matrices to enhance strength, thermal expansion coefficient and wear resistance of structures.From an economical point of view, performing straight forward experimental measures on a number of material samples of different sizes, for various geometrical and physical phase properties, volume fractions and loading paths is hardly feasible task. Therefore, there is a clear need for modelling strategies that provide a better understanding of micro–macro-structure property relations in multi-phase heterogeneous materials. The last four decades have seen a development of improved analytical and numerical models for heterogeneous materials.A transition fro the microscopic properties to their macroscopic counterparts based on an averaging principles is termed homogenisation. The simplest method leading to homogenised modulus of heterogeneous material is based on the rule of mixture. This approach takes only one microstructural characteristic into consideration: the volume ratio of the heterogeneities. A more sophisticated method is the effective medium approximation, as established by Eshelby [1] and further developed by Hashin [2], Mori and Tanaka [3] and more recently by Nan and Clarke [4].Although some work has been done on extension of the self-consistent approach to non-linear cases, significantly more progress in estimating advanced properties of composites has been achieved by variational bounding methods (see [5,6]). The variational bounding methods are based on suitable variational (minimum energy) principles and provide upper and lower bounds for the overall properties of the composite. Another approach is based on mathematical Asymptotic Expansion Homogenization (AEH) theory [7–9]. AEH is a perturbation technique based on the asymptotic series expansion inε, a scale parameter of a primary variable. The scale parameter is a ratio between the length scales, represented by the relation between micro heterogeneities size and a measure of macrostructure. It is represented by a very small positive numberε=l/L⪯¡1, see [10–13]. The asymptotic homogenisation technique gives effective overall properties plus local stress and strain values. However, the considerations are restricted to very simple microscopic geometries and simple material models, mostly at small strains.The unit cell methods represent another way to approach the analysis of multi-phase materials. They appeared due to the complexity of microstructural mechanical and physical behaviour along with the developments of computational techniques. These approaches have been used in a large number of applications, see [14–18]. The unit cell methods provide information on the local microstructural fields and effective material properties. Once the constitutive behaviour becomes nonlinear, it is extremely difficult to make assumption on a suitable macroscopic constitutive format, see [19–21].Most of the homogenisation techniques aforementioned are not suitable for finite deformations or complex loading paths, since they do not account for geometrical and physical changes in the microstructure. In the Finite Element Method (FEM), the use of a single element capturing all microstructural details in a numerical solution of macroscopic BVP becomes impractical. An alternative approach for homogenisation of multi-phase heterogeneous materials, known as Multi-Scale Computational Homogenisation or Micro–Macro Modelling has been gaining considerable popularity in the computational mechanics circles. Since the basic principles for the micro–macro modelling of heterogeneous materials were introduced (see [22,11,23–25]), this technique has proved to be the most effective way to deal with arbitrary physically non-linear and time dependent material behaviour at micro-level. A number of recent works deal with various approaches and techniques for the micro–macro simulation of heterogeneous materials. Among these, the contributions [26,27] are highlighted for analysis of polycrystalline materials. The multiscale modelling techniques above do not lead to closed-form overall constitutive equations. However, they compute the stress–deformation relationship at every macropoint of interest by modelling of the microstructure RVE corresponding to the macroscopic point. The advantages of multiscale techniques are the following:•They do not require constitutive assumptions on the macrolevel.They enable the incorporation of finite deformations and rotations at both micro- and macro-levels.They are suitable for nonlinear material behaviour.They provide the possibility to introduce detailed microstructural information, including geometrical and physical evolution, into the macroscopic analysis.Although our study is confined to the finite element method, they allow any modelling technique on the microlevel.Herein, two of the forces in one node representing antiperiodic traction are condensed. This approach leads to an innovative treatment of the problem. The paper is structured as follows: Firstly, the necessary background is presented. Secondly, the novel condensation technique, associated tangent modulus, etc, are described and formulation is developed in detail. Finally, numerical tests are presented and compared with other results from the literature.A homogenised macro-continuum with locally attached microstructures is considered herein. The microstructure is denoted byB⊂R3with overall properties related to the macrocontinuumB¯⊂R3.A pointx∈B¯of the homogenised macromediumB¯⊂R3is represented as a microstructureB⊂R3. The tensorsσ¯andσμdenote the macro and microCauchy stress tensor atx∈B¯andy∈B, respectively. The Representative Volume Element (RVE) of the microstructureV⊂R3represents the part of the heterogeneous material consisting of the solid partBand the holeH, i.e.V=B∪Hand∂B=∂V∪∂H. It is assumed that the traction field on the surface of the holes in the interior of RVE vanishes, i.e.(1)t(y,t)=0aty∈∂Hwheret≡σμ·non∂Bis the traction field vector on the surface with outward normalnaty∈∂B.A discrete model of the macro and microstructure is considered in Fig. 1. The overall macroscopic deformationϵ¯is prescribed over the discretised RVE. The main idea of this procedure is based on finite element (F.E.) discretisation. At every integration Gauss point of the macrostructure, a discrete RVE microstructure is considered as representation of the macroGauss point. Based on the Finite Elements discretisation of the microstructure, the goal is to develop a procedure for computing the overall tangent modulusC¯and macroscopic average stressσ¯at each macroscopic integration point with locally attached microstructure.The displacement field is divided into two partsu=u⁎+u˜whereu⁎is the so-called Taylor displacement which is expressed in its discrete form as(2)uj⁎≡ϵ¯yjj=1…nfor thennodes of the microstructure RVE. The displacement fluctuationu˜is the unknown for every node of the discretised microstructure unit cell.Henceforth, standard Finite Element matrix notation will be used, where the tensor entities so far used, can be identified now in the form:(3)ϵ¯≡{ε¯11ε¯222ε¯12}anduj≡{u1u2}jwithϵ¯as matrix representation of macrostrain tensor andujis the displacement field at nodejof the discretised unit cellV. Moreover, the averaged stress fieldσ¯and the force vectorfjassociated with the microcell nodej, are also defined in this notation as follows:(4)σ¯≡{σ¯11σ¯22σ¯12}andfj≡{f1f2}jThe Taylor displacementuj⁎of the node j is computed in the following matrix form:(5)uj⁎=DjTϵ¯,j=1⋯n.whereDjis the coordinate matrix at nodejof the microstructure is defined as(6)Dj≡12[2y1002y2y2y1]jA procedure based in a Newton–Raphson scheme is given to find the equilibrium at the microstructure RVE at time step n+1 assuming the system is already in equilibrium at time step n. The general idea consists in taking the microstructure as ‘frozen’ with macroscopic strainϵ¯=constant. Therefore, the variation of the Taylor displacement is zero during the iterationdu⁎=0, because it is applied at the beginning of the process.Before proceeding with description of the scheme, the incremental displacement fieldΔu=un+1−uncan be additively decomposed thanks to the additive properties of the strain tensorϵ¯as follows:(7)Δu=Δu⁎+Δu˜=Δϵ¯y+Δu˜whereΔu⁎is the incremental Taylor displacement andΔu˜is the incremental displacement fluctuation. The general solution procedure is described as follows:1.The initial incremental displacement guessΔu0is given as the incremental Taylor displacement:(8)Δu0=Δu⁎=Δϵ¯yIn other words, the incremental macrostrainΔϵ¯is fully prescribed at the first pseudo step, so that, the Taylor displacement is fully prescribed as the initial guess. This means that the initial displacement guess at time step n+1,un+10, is given by(9)un+10=un+Δu0Using the split displacementu=u⁎+u˜at time step n, the initial guess displacement is then expressed as(10)un+10=un+1⁎+u˜nIn the above it can be observed that the incremental Taylor displacementΔu⁎is prescribed entirely at the beginning of the procedure. Moreover, the initial displacement fluctuation is taken as the converged from the previous time step n. Therefore,u˜n+10=u˜nor in another words the incremental fluctuation is zero during the initial guessΔu˜=0.Computation of the internal forcesfint. This is computed with the incremental displacementΔuand the set of state variables{En+1,αn+1}at microscopic Gauss point level.Check convergence∥r∥<εtolerance. This residual force r depends on the boundary constraint applied on the RVE.•IF∥r∥<εtolerance. EQUILIBRIUM. The solution isun+1k. END OF ITERATIONELSE GO TO NEXT STEPComputation of the incremental internal fluctuation. Let us assume that the differential fluctuation is divided in two parts:(11)δu˜={δu˜rδu˜d}whereδu˜rare the independent d.o.f. andδu˜dare the dependent d.o.f. displacements of the microstructure. Thereforeδu˜dis known onceδu˜ris computed. They are different depending on the micro boundary constraint (Linear or Periodic b.c.). The Newton–Raphson iteration is defined by(12)Krδu˜r=−r→δu˜r=−Kr−1rwhereris the residual force andKris the reduced matrix of the system. In Sections 6.5 and 7.7 particularisations for Linear and Periodic b.c. are given, respectively.The updating of the incremental fluctuation isΔu˜←Δu˜+δu˜and the incremental displacementΔu←Δu+δu˜GO TO step 2.Finally, when the microequilibrium is reached, the macroCauchy stressσ¯n+1is computed from the value of the boundary forces. This macrostress is used to compute the internal forces at the macrolevel.Assuming no body forces in the expression for the average stress, in the discrete setting,tdA→fjext, that is the infinitesimal forcetdAbecomes the finite forcefjextat nodal positionyjon the boundary∂V. Therefore, the average stress degenerates into the discrete sum:(13)σ¯=1|V|∑j=1nbsym[fjext⊗yj]wherenbis the number of nodes on the boundary∂V. Using matrix representation this expression becomes(14)σ¯=1|V|∑j=1nbDjfjextwhereDjis the coordinate matrix (6) evaluated at node j on the boundary of the discretised microstructure RVE∂V. The above expression can be rearranged in the following global expression:(15)σ¯=1|V|Dbfbext,wherefbextis the external nodal force vector of the boundary nodes, andDbis the boundary coordinate matrix defined byDb≡[D1bD2b…Dnbb].In the computational homogenisation approach no explicit form of the constitutive behaviour on the macro-level is assumed a priori, so that the tangent modulus has to be determined numerically by relations between variations of the macroscopic stress and variations of the macroscopic strain at such integration macroGauss point. This can be accomplished by numerical differentiation of the numerical macroscopic stress–strain relation, for instance, by using forward difference approximations as suggested in [27]. Another approach is to condense the microstructural stiffness matrix to the macroscopic matrix tangent modulus. This task is achieved by reducing the total RVE system of equations to the relation between the forces acting on the boundary∂Vand the displacement on the boundary. The innovative modelling of the anti-symmetry traction vectors at the nodes at the corners leads to a nonconventional condensation, obtaining a novel effective macroscopic tangent modulus. It is a direct condensation to obtain a relation between the variation of the forces acting on the boundary (∂V) and the variation of the Taylor displacement on the boundary nodes (du⁎), which depends linearly of the macroscopic strain (dϵ¯). The total microstructural system of equations that gives the relation between the iterative nodal displacementduand iterative nodal external force vectors is(16)Kdu=dfext.With the displacement partitionu=u⁎+u˜the system can be rearranged as follows:Kdu=dfext⇒Kdu⁎+Kdu˜=dfextThe boundary constraints are then applied to this system in the following sections to condense the system. This procedure gives the expression that relates the variation boundary external forcesdfbextagainst the variation of the Taylor displacementdu⁎.Finally, the overall tangent modulusC¯can be computed in its discretised F.E. matrix form, using previous averaged stress expression (15), in the following way:(17)C¯=dσ¯dϵ¯=1|V|Dbdfbextdϵ¯Particularisations of the computation of average macrostress and overall tangent modulus are given for Taylor assumption, Linear b.c. and Periodic b.c. below.In view of the discrete formulation of the boundary conditions outlined, the nodes of the mesh are partitioned into those on the surface∂Vof RVE and those in the interior ofV, see Fig. 2. In this meshnbboundary nodes andniinternal nodes are distinguished.Partitioning of the current nodal displacements and nodal forces is given as(18)u={uiub}≡{LiuLbu}andf={fifb}≡{LifLbf}HereLiandLbare the connectivity matrices, which define the interior contribution and the contributions of the boundary nodes, respectively. These are Boolean matrices, i.e. they consist of integers 0 and 1. Displacementsuiandubare gathered fromu. Using these two vectors, a newuis obtained as shown in (18).In line with (18), the tangent stiffness matrix is rearranged as(19)K=dfintdu=[kiikibkbikbb]≡[LiKLiTLiKLbTLbKLiTLbKLbT]comprising contributions associated with internal nodes and nodes on the surface of the RVE.At each nodejof the boundary∂Vcondition induces the discrete constraint,u˜j=0j=1…nb. These constraints can be represented as a global boundary displacement vectoru˜b=0. Following matrix notation, the global coordinate matrix is defined as follows:(20)Dglobal,l≡[DiDb,l]whereDiandDb,lare the interior coordinate matrix and the boundary coordinate matrix, respectively, given as(21)Di≡[D1iD2i…Dnii]andDb,l≡[D1bD2b…Dnbb].The matricesDiandDb,lare defined in terms of node coordinate matrices (6) for the interior and boundary nodes, respectively. The Taylor displacementu⁎previously defined inu⁎=DglobalTϵ¯for the Taylor assumption, is now representedu⁎=Dglobal,lTϵ¯whereDglobal,lis the global coordinate matrix (20) andϵ¯is the matrix representation of the prescribed macroscopic strain (3). In this model the variation of the Taylor displacement vectordu⁎is represented as(22)du⁎=Dglobal,lTdϵ¯that is, as a function of the variation of the macroscopic average strain vectordϵ¯.For this model the average stress is computed based on the matrix expression for the average stress (15). Making use of the boundary coordinate matrixDb,ldefined in (21) it can be rearranged in the following global expression:(23)σ¯=1|V|Db,lfbextwherefbextis the external nodal force vector of the boundary nodes defined in the partition (18).Using partitioning of the algebraic equations (18) and 19, the system (16) can be rewritten as(24)[kiikibkbikbb]{duidub}={dfiextdfbext}≡Kdu=dfextfor the case whendfiext=0. The general procedure Section 5.2 is leading to the system (24) which is rearranged as(25)⇒Kdu˜=dfext−Kdu⁎where Taylor displacement variationdu⁎is given by (22) for the linear model. By introducing linear displacement constraint in discrete formu˜b=0into system (25), internal nodal displacement fluctuation vector can be computed as(26)du˜i=−kii−1KIdu⁎KI≡[kiikib].From the system (25), the variation of external boundary force vector is calculated(27)dfbext=kbidu˜i+KBdu⁎KB≡[kbikbb].Inserting (26) into (27), thedfbextvector is obtained(28)dfbext=(KB−kbikii−1KI)du⁎in terms of the variation of the Taylor displacementdu⁎. Compacting the right hand side of (28), the variation of the external boundary force vector is expressed as(29)dfbext=KlinBdu⁎where the condensed linear stiffness matrixKlinBis defined as follows:(30)KlinB≡KB−kbikii−1KI.Finally, insertion of the variation of the Taylor displacement (22) for the linear model, into (29) identifies the boundary force vector:(31)dfbext=KlinBDglobal,lTdϵ¯(32)dfbextdϵ¯=KlinBDglobal,lTwhich expresses the variation of the external boundary force vectordfbextwith respect to the variation of macroscopic straindϵ¯.The overall tangent modulusC¯lfor linear b.c., can be computed in its discretised F.E. matrix form following the general expression given in (17) as(33)C¯l=dσ¯dϵ¯=1|V|Db,ldfbextdϵ¯.Substituting (32) into (33), the overall tangent modulus representationC¯lis obtained(34)C¯l=1|V|Db,lKlinBDglobal,lTClearly, the overall tangent modulusC¯lis given as a function of the boundary coordinate matrixDb,ldefined in (21), the condensed linear stiffness matrixKlinB(30) and the global coordinate matrixDglobal,lToutlined in (20).Note that by using (34) the overall tangent modulus can be computed for heterogeneous material with different microstructures. When using this overall tangent modulus the quadratic rate of convergence is attained at macroscopic level.In Section 4 a general solution scheme for microequilibrium was given. In this section, the particularisation of the microequilibrium procedure for linear b.c. is given.The incremental Taylor displacement is given in matrix form as(35)Δu⁎=Dglobal,lTΔϵ¯.The residual forceris taken as the difference between the internal and external force vectors for the interior nodes asr=fiint−fiext. Assuming that in equilibriumfiext=0actual residual used for linear b.c.r=fiint. Therefore, the differential fluctuation is given by the system (12) which now is taking the following form:(36)Kiiδu˜i=−fiint→δu˜i=−Kii−1fiintandδu˜b=0. The updated incremental fluctuation is then given by(37)Δu˜i←Δu˜i+δu˜iandΔu˜b=0. The incremental displacement used to compute the internal force is updated by(38)Δui←Δui+δu˜iandΔubdoes not change.In order to discretise the continuum model of the periodic boundary conditions, the nodes of the mesh are partitioned in four groups outlined in Fig. 3:1.niinterior nodes are distinguished.nppositive boundary nodes which are located at the top and right side of the microstructure surface∂Vof RVE.npnegative boundary nodes which are located at the bottom and left side of the microstructure surface∂Vof RVE.ncnode at the corners.The number of node pairs (positive and corresponding negative nodes) on the boundary∂Vof RVE are(39)np=nb2−2wherenbis the total number of nodes on the boundary of RVE. Also, the number of corner nodes in a 2D rectangular microstructure is four, i.e.(40)nc=4.In this case, the partition of the nodal displacements and forces is as follows:(41)u={uiupunuc}≡{LiuLpuLnuLcu}andf={fifpfnfc}≡{LifLpfLnfLcf}HereLi,Lp,LnandLcare the connectivity matrices which define respectively: (i) the interior contribution, (ii) the contribution of positive boundary nodes, (iii) the contributions from the corresponding negative boundary nodes, and finally (iv) the contribution from the nodes at the corners. In correspondence to (41), the tangent stiffness matrix is partitioned in the following way:(42)K=dfintdu=[kiikipkinkickpikppkpnkpckniknpknnknckcikcpkcnkcc]≡[LiKLiTLiKLpTLiKLnTLiKLcTLpKLiTLpKLpTLpKLnTLpKLcTLnKLiTLnKLpTLnKLnTLnKLcTLcKLiTLcKLpTLcKLnTLcKLcT]At each node pairjon the boundary∂V+∪∂V−, the continuum condition induces the discrete constraint:(43)u˜j+=u˜j−,j=1⋯npThe link between constraints for each pair of nodes can be compactly represented in a global form as(44)u˜p=u˜nThe displacement fluctuation at the corners is prescribed to zero to avoid the rigid body motion:(45)u˜ci=0,i=1⋯ncIt can easily be proved that (45) agrees with the periodic continuum condition. The relation (45) can be represented in a global form:(46)u˜c=0At each node pairjon the boundary∂V+∪∂V−, the continuum antiperiodic traction condition is defined by means of discretisation as(47)f(yj+)=−f(yj−),fj+=−fj−,j=1⋯npAgain these constraints can be represented in compressed form as(48)fpext=−fnextA very important additional equation to take into consideration is equilibrium condition, i.e.(49)∑i=14fciext=0This vectorial equation agrees with the continuum antiperiodic traction condition, although, this is not obvious. The underlying idea relies on the antiperiodicity of force in the corners that come from the different continuum distributions.Using the matrix notation introduced in Section 3, the global coordinate matrix for periodic b.c. is re-defined as(50)Dglobal,p≡[DiDb,p]whereDiis the interior coordinate matrix defined in (21) and theDb,pis the boundary coordinate matrix for Periodic b.c. defined as(51)Db,p=[DpDnDc]whereDp≡[D1pD2p…Dnpp],Dn≡[D1nD2n…Dnpn]andDc≡[D1cD2cD3cD4c]are the positive boundary coordinate matrix, negative boundary coordinate matrix and corner coordinate matrix, respectively.Then, the Taylor displacement and its variation are given by(52)u⁎=Dglobal,pTϵ¯(53)du⁎=Dglobal,pTdϵ¯,Following the general procedure to compute average stress given in Section 5.1, the average stress is computed, based on the matrix expression for the average stress (14), as follows:(54)σ¯=1|V|[∑j=1np(Dj+−Dj−)fj+ext+∑i=14Dcifciext]By using the boundary coordinate matrixDb,pdefined in (51), the expression for the average stress (54) is rearranged in a global expression given by(55)σ¯=1|V|Db,pfbextwhere global matrix notation has been used to gain the compact form (55). Note thatfbextis the external boundary force vector which is obtained by gathering operation of the external force vector to extract the positivefpext, negativefnextand cornerfcextcounterpart as in the expression:fbext={fpextfnextfcext}After gathering and rearranging the displacement nodal vectoru, the external nodal force vectorfextand finally the stiffness matrixK, as defined in (41) and (42), respectively, the general system (16) that relates the variationsduanddfextis rearranged as follows:(56)[kiikipkinkickpikppkpnkpckniknpknnknckcikcpkcnkcc]{duidupdunduc}={dfiextdfpextdfnextdfcext}≡Kdu=dfextwheredfiext=0in equilibrium. Splitting the displacement vectoru=u⁎+u˜and rearranging the system (56), leads to(57)Kdu˜=dfext−Kdu⁎where the variation of Taylor displacementdu⁎is given by (53). Again the general procedure of Section 5.2 is followed to rearrange the system in the way described in Section 5.2. In this system the displacement fluctuation variation vectordu˜is considered as unknown. Applying into the above split system (57) the following conditions: (i) periodic displacement condition (44), (ii) prescribed corners displacement (46), (iii) antiperiodic external force condition (48) leads to the following system:[kiikip+kinkpi+knikpp+kpn+knp+knn]{du˜idu˜p}=−[kiikipkinkickpi+knikpp+knpkpn+knnkpc+knc]du⁎which is described in the following compact form:(58)K2{du˜idu˜p}=−KF2du⁎wheredu˜ianddu˜pare the unknowns. MatricesK2andKF2are defined byK2=[kiikip+kinkpi+knikpp+kpn+knp+knn]KF2=[kiikipkinkickpi+knikpp+knpkpn+knnkpc+knc]Displacementsdu˜ianddu˜pare then obtained by a simple matrix inversion ofK2. Thus, they are obtained in terms of the Taylor displacement variationdu⁎as(59){du˜idu˜p}=−K2−1KF2du⁎Variation of boundary forces can be computed explicitly in terms ofdu˜ianddu˜pand the Taylor displacement variationdu⁎. Firstly, the external positive nodal force vector is(60)dfpext=[kpikpp+kpn]{du˜idu˜p}+[kpikppkpnkpc]du⁎where using the matrix notation:KP1=[Kpikpp+kpn],kP2=[kpikppkpnkpc],the following compact expression fordfpextis obtained:(61)dfpext=KP1{du˜idu˜p}+KP2du⁎Once the positive nodal force vector variation was computed, the negative nodal force vector variationdfnextis also obtained straight away, since the negative and positive vectors are opposite to each other (48). Therefore(62)dfnext=−dfpextwithdfpextpreviously obtained in (61).In addition, the external corner node vector variationdfcextis computed as(63)dfcext=[kcikcp+kcn]{du˜idu˜p}+[kcikcpkcnkcc]du⁎which can be represented in a compact form as(64)dfcext=KC1{du˜idu˜p}+KC2du⁎whereKC1=[kcikcp+kcn]KC2=[kcikcpkcnkcc]However, in the sum of all corner forces (49) a condition has not been taken into consideration so far. This condition implies that one of the corner forces is a dependant variable of the other corner forces. Basically, all corner forces cannot be computed at the same time using (64).Hence, by using (49)dfc1extis computed as(65)dfc1ext=−(dfc2ext+dfc3ext+dfc4ext)The new matrices are definedK^C1andK^C2, respectively. So that, the expression (64) is then reduced to(66)dfcext=K^C1{du˜idu˜p}+K^C2du⁎whereK^C1andK^C2are the direct condensation of matrices. By using (59), the variation external boundary force vectorsdfpext,dfnextanddfcextcan be expressed only in terms of the Taylor displacement variationdu⁎(67)dfpext=(KP2−KP1K2−1KF2)du⁎=KPdu⁎(68)dfnext=−(KP2−KP1K2−1KF2)du⁎=−KPdu⁎(69)dfcext=(K^C2−K^C1K2−1KF2)du⁎=K^Cdu⁎Hence, the boundary force vector variationdfbextcan now be expressed in terms of the Taylor displacement variationdu⁎. By adding (67), (68) and (69) it follows:(70)dfbext≡{dfpextdfnextdfcext}=[KP−KPK^C]du⁎=KperBdu⁎This gives the expression:(71)dfbext=KperBDglobal,pTdϵ¯where the Taylor displacement variation (53) was inserted into Eq. (70). Therefore, the desired expression is gained as(72)dfbextdϵ¯=KperBDglobal,pTwhich gives the variation of external boundary force vectordfbextwith respect to the variation of macroscopic average strain matrixdϵ¯.The overall tangent modulusC¯pfor Periodic b.c., can be computed in its discretised F.E. matrix form following the general expression given in (17), that is(73)C¯p=dσ¯dϵ¯=1|V|Db,pdfbextdϵ¯whereDb,pwas defined in (51).Substituting (72) into (73), the overall tangent modulus matrix representationC¯pis obtained as(74)C¯p=1|V|Db,pKperBDglobal,pTClearly, the modulusC¯pis a function of the boundary coordinate matrixDb,pdefined in (51), the condensed periodic stiffness matrixKperBand the global coordinate matrixDglobal,poutlined in (50). Note that with the above (74), the tangent modulus can be computed for heterogeneous material with different microstructures RVE gaining the desired quadratic rate of convergence, for the Newton–Raphson solution procedure applied to solve the homogenised nonlinear macrostructure, under periodic deformation and antiperiodic traction on the boundary of RVE model.The antiperiodicity is represented by means of forces at the corners as depicted in Fig. 4. The superscripts indicate the following:BBottom (−)Top (+)Left (−)Right (+)The forces at the corners represent the discretisation of the traction coming from the surrounding continuum.•Corner 1 (C1):fc1Bandfc1LCorner 2 (C2):fc2Bandfc2RCorner 3 (C3):fc3Randfc3TCorner 4 (C4):fc4Tandfc4LThere are two forces per corner making a total of 8 at the discretised RVE. These forces must satisfy antiperiodicity. Therefore, the following 4 equations for antiperiodicity at the corners are established as(75)fc1B=−fc4Tfc2B=−fc3Tfc1L=−fc2Rfc4L=−fc3RThe resultant at each corner is also described in Fig. 4. Four additional relations are obtained as follows:(76)fc1B+fc1L=fc1fc2B+fc2R=fc2fc3R+fc3T=fc3fc4L+fc4T=fc4Then, the system formed by Eqs. (75) and (76) is reduced to have only one force per corner. This leads to(77)fc1+fc2+fc3+fc4=0Eq. (77) is the additional condition to apply to the system in order to compute the tangent operator. (77) expresses the continuum antiperiodicity traction constraint and makes the system to be in equilibrium.The equilibrium and antiperiodicity equation at the corners of the discretised RVE is given by (77) which is imposed to compute the overall tangent modulus. The first two rows ofKC1andKC2(corresponding to the 2 dofs offc1) have to be removed and recomputed by adding the other 6 rows (2 by 2) and, then, multiplied by −1. This process is visually described in Fig. 5.In Section 4 a general solution scheme for microequilibrium was given. In this section, the particularisation of the microequilibrium procedure for periodic b.c. is given. The incremental Taylor displacement is given in matrix form as(78)Δu⁎=Dglobal,pTΔϵ¯The residual forceris taken as(79)r={fiintfpint+fnint}−{fiextfpext+fnext}Assuming that in equilibriumfiext=0and antiperiodicity of the boundary traction in discrete formfpext+fnext=0, the residual for periodic b.c. takes the form:(80)r={fiintfpint+fnint}.The differential fluctuation is given by the system (12) which takes the following form for periodic b.c.(81)K2{δu˜iδu˜p}=−{fiintfpint+fnint}→{δu˜iδu˜p}=−K2−1{fiintfpint+fnint}for differential displacement fluctuation for interior and positive nodes. Also taking into consideration (46) and (44), the differential displacement fluctuation for negative and corners is computed as(82)δu˜n=δu˜pandδu˜c=0The updating of the incremental fluctuation is then given by(83)Δu˜i←Δu˜i+δu˜iΔu˜p←Δu˜p+δu˜pΔu˜n←Δu˜pandΔu˜c=0. Finally, the incremental displacement to compute the internal force is updated as(84)Δui←Δui+δu˜iΔup←Δup+δu˜pΔun←ΔupandΔucremains constant.The first numerical test consists of computation of effective elastic material properties. Square microcells, in which fibres are periodically distributed, are considered composed of epoxy matrix with Young׳s modulus E=3.13GPa and Poisson׳s ratio ν=0.34. Glass fibre is embedded in the matrix with Young׳s modulus E=73GPa and Poisson׳s ratio ν=0.2.The test has been carried out under plane strain analysis. In Fig. 6the ratio of effective shear modulus over the matrix modulusG¯/Gmatrixis compared with analytically obtained properties following Nemat–Nasser (Part I, chapter 8) [29].A very similar response can be observed for less than 20% of the inclusion volume fraction. Especially, the periodic assumption seems to be very accurate. Note that the Nemat–Nasser׳s analytical model is effective in predicting equivalent material properties for a low volume fraction of the second phase inclusion. However, Nemat–Nasser׳s model [29] does not cope well with large fibre volumes.The second numerical test considered is an analysis of nonlinear material behaviour in small strain. The test consists of a simulation of the behaviour of an internally pressurised circular metallic plate, see Fig. 7. The analysis is carried out assuming plane stress conditions. Note that the equality between the macroscopic strain and the average of the microscopic strain – imposed as an average on the RVE – is satisfied by means of application of the Hill–Mandel principle or averaging theorem. The von Mises perfect elastoplastic model is used to perform the simulation.The properties of the material are as follows:•Young׳s modulus E=210GPa.Poisson ratio ν=0.3.Uniaxial yield stressσy=0.24GPa(perfect elastoplastic).The mesh for the macrostructure is shown in Fig. 7. Due to symmetry only a quarter of the circular plate is analysed by employing 20 standard 8-noded quadrilateral elements with reduced integration.The pressure, P, prescribed on the inner surface, is increased gradually until collapse (limit) load is reached. For the present problem (see Fig. 8), plastic yielding starts at the inner surface (with radial coordinate r=a) and develops gradually, in the form of a circular plastic front (with radius c), towards the outer face (r=b). Collapse occurs when the plastic front reaches the outer face (c=b) and the entire cylinder can expand indefinitely without further increase in the applied pressure.Initially, the pressure is applied during elastic regime untilP0is reached at which plastic yielding begins. In this region the radial displacement of the outer surface is a linear function of P, given by(85)ub=2PbE(b2a2−1)P<P0A closed-form in the plastic region, has been derived by Lubliner [30]. It relates the applied pressure to the radius c of the plastic front by means of the expression:(86)PY=ln(ca)+12(1−c2b2),where for the von Mises modelY=2σy/3. Plastic yielding begins when c=a, which corresponds to the yielding pressure:(87)P0Y=12(1−a2b2).In the plastic regime (P≥P0), the radial displacement,ub, is given by(88)ub=Yc2EbP<P0where c can be evaluated as an implicit function of P through (86).In the following figures, diagrams showing the applied pressure P versus radial displacement at the outer face of the plate are plotted together with the closed-form solution [30] described above. The following diagrams are displayed:•Single scale analysis: Closed form and FEM analysis.Two multi-scale analyses. RVE: Square microstructure discretised by 8-noded quadrilateral elements with reduced integration. Every cell has a void in the middle with variable shape and volume fraction, as follows:○Microstructure 1: Circular void in the middle of the RVE with 5% volume fraction.nelements=126,nnodes=438.Microstructure 2: Square void in the middle of the RVE with 5% volume fraction.nelements=128,nnodes=448.nelements=128,nnodes=448.Microstructure 3: Circular void in the middle of the RVE with 15% volume fraction.nelements=128,nnodes=448.Microstructure 4: Square void in the middle of the RVE with 15% volume fraction.nelements=160,nnodes=560.These microstructures are depicted in Fig. 9.In Figs. 10–12results are shown for different constraints on the microcell and 5 and 15% void fraction, respectively. Curved denoted Lubliner represents the closed-form solution described above and given in [30]. FEM curve shows a single scale analysis of the problem. The agreement between the closed form and FEM solution is excellent. Furthermore, two scales analysis curves are depicted for Taylor assumption, linear b.c and periodic b.c. The comments are as follows:•Taylor assumption gives the stiffest response. Then comes linear b.c. while the softest response is given by periodic b.c. This was expected from the nature of the constraints.Taylor assumption and linear b.c. show insensitivity at macroscopic level for different void shape. Diagrams for circular and squared void shape are overlapped.Periodic b.c. is the only one which shows sensitivity to the void size. It can be observed that circular void gives slightly stiffer response than the square one, which agrees with the expected response. Moreover, the difference is bigger when the void size is increased.The diagrams (Figs. 10–12) show the results depending upon Taylor assumption, linear b.c., periodic b.c., and void volume fraction. It can be observed that the material response softens when the void volume fraction increases. The Taylor assumption gives less sensitive results than linear b.c. and periodic b.c.In this section several figures representing effective plastic strain distribution are depicted for a quarter of the cylinder with some representative microstructures. The plastic front evolves in a circular way which agrees with the symmetry of the problem and the analytical solution given earlier [30].In Fig. 13a Microstructure 1 is considered under the Taylor assumption. Two different stages are depicted at different values of internal pressure P=140 and P=175MPa, respectively. The circular evolution of the plastic front at macroscale level can be observed. For P=175MPa a slight distortion of the plastic front is visible as the load approaches the limit value.In Fig. 14(a) and (b) the results for the linear b.c. are shown for Microstructure 1 for values of internal pressure of P=100 and P=160MPa, respectively, while Fig. 15(a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=95 and P=150MPa, respectively. The development of shear bands is observed in these figures.In Fig. 16the Microstructure 2 is considered under the Taylor assumption. Again two different stages are depicted for different values of internal pressure P=140 and P=175MPa, respectively. For P=175MPa a slight distortion of the plastic front is visible as the load approaches the limit value.In Fig. 17(a) and (b) the results for the linear b.c. are shown for Microstructure 2 for values of internal pressure of P=100 and P=160MPa, respectively, while Fig. 18(a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=95 and P=150MPa, respectively. The development of shear bands is observed in these figures.In Fig. 19the Microstructure 3 is considered under the Taylor assumption. Two different stages are depicted for different values of internal pressure P=115 and P=160MPa, respectively. The circular evolution of the plastic front at macroscale level is shown. Again, for P=160MPa a slight distortion of the plastic front is visible as the load approaches to the limit value.In Fig. 20(a) and (b) the results for the linear b.c. are shown for Microstructure 3 for values of internal pressure of P=100 and P=130MPa, respectively, while Fig. 21(a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=100 and P=120MPa, respectively. The development of shear bands is observed in these figures.In Fig. 22a Microstructure 4 is considered under the Taylor assumption. Two different stages are depicted for different values of internal pressure P=115 and P=160MPa, respectively. For P=160MPa a slight distortion of the plastic front is visible as the load approaches the limit value.In Fig. 23(a) and (b) the results for the linear b.c. are shown for Microstructure 1 for values of internal pressure of P=90 and P=130MPa, respectively, while Fig. 24(a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=75 and P=115MPa, respectively. The development of shear bands is observed in these figures.In this section tables with the Euclidean normRMof the residual are reported associated with the Newton iterations of the macro- and micro-equilibrium. The residual norm evolution is shown for the microstructure that corresponds to the macroGauss point in the bottom right corner (Tables 1 and 2).In the following tables the Euclidean normRMof the residual is reported associated with the Newton iterations of the macro-equilibrium. The macro-residual is normalised and calculated asRM=100×∥Fint−Fext∥/∥Fext∥. The micro-residual is computed in different ways depending on the constraint. Obviously in Taylor assumption there is no micro BVP so the residuals are not shown.The residual for linear b.c. is evaluated asRμ=100×∥r∥/∥fint∥whereris given asr=fiint. The residual for periodic b.c. is evaluated asRμ=100×∥r∥/∥fint∥whererwas given in (80).Clearly, the quadratic rate of asymptotic convergence can be observed in the macro and microscale for both Linear and Periodic b.c.׳s. Also the Taylor assumption shows quadratic rate of convergence in macroequilibrium.Note that the microstructure in Figs. 14–24 is rotated in order to keep axisymmetric conditions as much as possible. The RVEs are not arbitrarily rotated. They are rotated in such an angle that they have imposed the same relative macroscopic deformation of another RVEs placed at the same distance from the centre of the cylinder. The symmetry is not possible to keep it 100%. In Taylor it is more obvious since it is presented at larger pressure.

@&#CONCLUSIONS@&#
