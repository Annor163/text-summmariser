@&#MAIN-TITLE@&#
A coronary artery segmentation method based on multiscale analysis and region growing

@&#HIGHLIGHTS@&#
A multiscale region growing method for coronary artery segmentation is proposed.The growing rule incorporates both vesselness and local orientation information.Two datasets with different levels of difficulty and two ground truths are used.The evaluation shows good results and robustness to different difficulties.

@&#KEYPHRASES@&#
Coronary artery,Hessian,Segmentation,Region growing,Multiscale,Vesselness,Direction,

@&#ABSTRACT@&#
Accurate coronary artery segmentation is a fundamental step in various medical imaging applications such as stenosis detection, 3D reconstruction and cardiac dynamics assessing. In this paper, a multiscale region growing (MSRG) method for coronary artery segmentation in 2D X-ray angiograms is proposed. First, a region growing rule incorporating both vesselness and direction information in a unique way is introduced. Then an iterative multiscale search based on this criterion is performed. Selected points in each step are considered as seeds for the following step. By combining vesselness and direction information in the growing rule, this method is able to avoid blockage caused by low vesselness values in vascular regions, which in turn, yields continuous vessel tree. Performing the process in a multiscale fashion helps to extract thin and peripheral vessels often missed by other segmentation methods. Quantitative evaluation performed on real angiography images shows that the proposed segmentation method identifies about 80% of the total coronary artery tree in relatively easy images and 70% in challenging cases with a mean precision of 82% and outperforms others segmentation methods in terms of sensitivity. The MSRG segmentation method was also implemented with different enhancement filters and it has been shown that the Frangi filter gives better results. The proposed segmentation method has proven to be tailored for coronary artery segmentation. It keeps an acceptable performance when dealing with challenging situations such as noise, stenosis and poor contrast.

@&#INTRODUCTION@&#
X-ray coronary angiography (XCA) is the gold standard for the assessment of clinically significant coronary artery diseases (CAD) [1]. The angiograms obtained by the XCA enable to reveal the initial CAD symptoms by the morphological features of the coronary arteries such as diameter, length, branching angle, and tortuosity. However, complex vessel structure, image noise, poor contrast and non-uniform illumination make vessel tracking a tedious task. Accurate coronary vessel detection is a fundamental step in various medical imaging applications such as stenosis detection [2], 3D reconstruction [3] and cardiac dynamics assessing [4]. Vessel detection is generally related to two important tasks which are vascular features enhancement and blood vessel segmentation.The enhancement step aims to improve the vessels delineation while reducing background artifacts. So far, a variety of vessel enhancement methods have been proposed [5–13]. Truc et al. [14] distinguish three method classes: linear filtering [15], non-linear anisotropic filtering [16,17] and Hessian-based multiscale filtering [5–10].Linear enhancement methods generally use Gaussian kernels or Gabor filters in order to denoise images. They are inappropriate to complex vascular structures since they blur vessel borders as well as thin vessels.Unlike the linear smoothing filters, non-linear anisotropic diffusion filtering adjusts the filter for local variations by acting mainly along the preferred structure direction [16]. Hence, important features are better preserved during the smoothing process. Those filters are widely applied in many image processing tasks such as fingerprint image filtering [18], optical coherence tomography image denoising [19] and cell membrane enhancement [20]. The main drawback of diffusion based methods is that they usually act at a fixed scale and are therefore unable to detect vessels within a wide range of size.Most of the research on vessel enhancement falls into Hessian-based methods. These methods utilize the second order derivatives matrix (Hessian matrix) of the image intensity in order to detect tubular-like structures. For that, the Hessian matrix at each pixel is computed by convolving the initial image with second-order Gaussian derivatives. Then, the Hessian eigenvalues and/or eigenvectors are often used to propose a vesselness measure which can be interpreted as the probability of belonging to a blood vessel of a pixel. The vesselness generates maximum response at the scale which matches the diameter of the vessel to be detected. The main advantage of methods in this category is that they can perform in a multiscale fashion, thus detecting different sized objects.In [21], the authors compared four different Hessian-based multiscale filters, namely those proposed by Koller [5], Sato [6], Frangi [7] and the vessel enhancing diffusion (VED) filter [17]. VED is a diffusion filter built upon the Frangi filter. It can be seen as a generalization of anisotropic diffusion to iteratively smooth the image, while preserving the vessel structure [17]. This filter was initially proposed by [22] and extended by Manniesing et al. [17] who added a smoothness constraint and an enhanced diffusion scheme. Results of this study showed that the two latter outperform the others with a better background suppression performance and vascular structure enhancement.The second important step in vascular analysis is vessel segmentation. Existing segmentation methods can be divided into two general categories [23]: skeleton based, and non-skeleton based. The principle of skeleton-based techniques is the segmentation of vessels by first detecting the centerlines, then estimating the vessel width. A typical problem with this class is that it can fail to approximate the vessel segments which present stenosis and bifurcations. Non-skeleton-based segmentation techniques, on the other hand, are those that extract the vessels directly. Methods in this category vary from thresholding [24–26,3], fuzzy clustering [27], mathematical morphology [28,29,13], deformable models such as active contour and level set [30–33], graph cuts [34–36] to region growing [37–43]. A more general review on vessel segmentation can be found in [44,45].Region-growing has been widely used for image segmentation [46], and in particular medical image applications such as vessel extraction. The rationale for this popularity is that these methods are based on a connectivity assumption, which is naturally suited to the case of the vascular trees [47,48]. Methods in this class incrementally segment an object by recruiting neighboring pixel starting from seed points or regions located inside a vessel based on some inclusion rule. Defining a robust region growing rule for X-ray vessel segmentation may encounter several difficulties such as image artifacts, lesions, noise and very low contrast between the vessels and the background particularly in thin vessels location. Therefore, classical region growing methods based on grey level values and/or spatial proximity are often sensitive to noise, and inhomogeneous contrast, which often leads to false negative (hole), false positive (leakage) and unwanted stop of region-growing [45].In coronary artery angiograms, several factors such as image artifacts, stenosis and noise may introduce discontinuities, hence region growing may result in holes and over-segmentation. To avoid such problems, the growing process was performed in many frames of the same sequence in [37]. Although discontinuities may be avoided by temporal tracking, other difficulties such as centerline matching and user interaction in each step are necessary in this approach. Instead of using the intensity feature in the growing process, authors in [49] incorporate the Frangi vesselness filter [7] in order to introduce more seed points when the growing process stops. In [41], the authors proposed a novel vesselness function and performed vessels segmentation in two steps. First, large vessels are extracted from the maximum vesselness response by region growing. However, this final vesselness response given by the maximum response among the scale space may present low values for thin vessels, junctions and stenosis location. Thus, discontinuities may occur if the growing process is applied directly on this final vesselness image. That is why a detail repairing process is launched in order to extract thin vessels using a direction information given by the first directional derivatives i.e. image intensity gradient.Combining the vesselness function with a directional information for vessel tracking is certainly a good idea but the image gradient is not, in our opinion, the appropriate direction information descriptor. A more precise direction descriptor would be given by the Hessian matrix eigenvectors. This idea was investigated in [50] where the authors combined the Sato vesselness function [6] with the line direction information given by the first Hessian eigenvector to guide the segmentation of 3D blood vessels. As discussed in [21], the Sato filter is more sensitive to noise than the Frangi filter when applied to 2D X-ray angiograms. Fig. 1shows that background noise is better removed by the Frangi filter than the Sato one.In this paper, a multiscale vessel segmentation method for X-ray coronary angiography images is presented. This method takes advantages from multiscale Hessian analysis strength and aims to overcome the two major problems encountered in region growing techniques which are the difficulty of detection of poorly enhanced vessel segments and the occurrence of false positives [50]. The major contributions of this paper are three-fold: (1) From methodological point of view, we combine both Hessian geometrical features which are eigenvalues and eigenvectors to define a robust new region growing criterion tailored to the coronary artery segmentation problem. This criterion is integrated into a mulitscale region growing algorithm ensuring the detection of different sized vessels. (2) We propose an evaluation database containing two datasets with different challenging degrees, which allow the quantitative evaluation of the method in terms of region overlap, sensitivity and precision. To the best of our knowledge, there is no standard database available for this task. The only database available in the literature was proposed by [36] and was designed to evaluate centerline extraction methods rather than segmentation evaluation. (3) We evaluate our method from two aspects, which are the enhancement filter and the segmentation methods. The remainder of this paper is organized as follows. In Section 2, background concepts related to our approach are reviewed. Section 3 illustrates the proposed method in detail. Experiments are described in Section 4. Some illustrative results are given in Section 5. Section 6 presents discussion and concluding remarks.The idea of multiscale image analysis is to add a new dimension to the analysis which is the image scale. The image is transformed into a set of blurred images, each representing the original image, but at a different scale [51]. These blurred images are obtained by convolving the initial image I0(p)=I0(x, y) with a Gaussian kernel to represent the information at a certain scale.(1)Iσ(p)=Iσ(x,y)=I0(x,y)⊗Gσ(x,y)where Iσis an image of the scale space, p=(x, y) is a pixel location, ⊗ represents the convolution operation and Gσ(x, y) is the 2D Gaussian kernel with standard deviation σ defined as:(2)Gσ(p)=Gσ(x,y)=12πσ2exp−(x2+y2)2σ2where σ∈Σ={σmin, …, σmax}, σminand σmaxare set according to the approximate width of the smallest and largest vessel to be detected [51].In the scale space framework, differentiation is defined as a convolution with derivatives of Gaussian:(3)∂n1+n2I∂xn1∂yn2σ=I⊗∂n1+n2Gσ∂xn1∂yn2Thus, the Hessian matrix which is the second order derivative of an intensity image in the scale space can be obtained at each point by Eq. (4):(4)Hσ(p)=∂2Iσ(x,y)∂x2∂2Iσ(x,y)∂y∂x∂2Iσ(x,y)∂x∂y∂2Iσ(x,y)∂y2.The Hessian matrix is symmetric, therefore has two real eigenvalues λ1 and λ2 and two associated eigenvectors e1 and e2. The signs as well as the relative and absolute magnitudes of eigenvalues characterize the local shape of the intensity in the image. If we assume that we seek to characterize black vessels on a white background, which is the case of the angiographic images, a pixel belonging to a vessel region will be given by small (ideally 0) λ1 and a high positive value of λ2 (with λ1<λ2).Frangi et al. [7] note that the Hessian eigenvalues ordered by magnitude (i.e. |λ1|<|λ2|) are geometrically interpreted as principal vessel curvatures and provide a vesselness measure on the basis of this observation. They introduce two measures to describe structures in images:Rb=λ1λ2is the blob-like structure measure andS=∥H∥F=λ12+λ22, the Frobenius norm of the Hessian matrix, is the second-order structureness measure. These measures were combined in a vesselness function as given by Eq. (5).(5)Vσ(p)=0ifλ2<0exp−Rb22β21−exp−S22c2otherwise,where parameters β and c are thresholds which control the filter's sensitivity to Rband S respectively. The two vesselness termsexp(−Rb22β2)and(1−exp(−S22c2))are combined using their product to ensure that the response of the filter is maximal only if both criteria are fulfilled.According to scale space theory, Vσ(p) will be the maximum only when the width of the vessel in pixel p matches a suitable scale factor σ. Thus, In the multi-scale vessel enhancement algorithm, Vσis computed for different scales then the largest one is taken as the final filter output.(6)Vmax(p)=maxσ∈Σσγ*Vσ(p)The normalization factor σγ[51] is introduced to normalize the intensity values across the scale space. The parameter γ can be adjusted to show preference for particular scales. It is equal to one if no scale is preferred. Taking γ<1 favors small scales while γ>1 favors large ones.The eigenvectors e1 and e2 of the Hessian matrix of Eq. (4) characterize the local shape of the intensity. e1 gives the direction of lower second derivative, i.e. the direction of a potential linear structure, while e2 gives the direction of the stronger second derivative, i.e. the normal direction to a potential linear structure. Thus the proposed direction information Dσcan be simply given by the following expression:(7)Dσ(p)=0ifλ2<0e1otherwise.Fig. 2shows a motivating example of incorporating the direction information. The green circle in Fig. 2(a) shows a stenosis in a coronary artery. When the maximum Frangi vesselness is computed, the filter response significantly decreases in this location. However the first eigenvector ensure the continuity of concerned pixels and their neighbors (see Fig. 2(d)). One can note that neighboring pixels in this location exhibit close direction.Leveraging from the above-mentioned multiscale geometrical information, we design a robust multiscale region growing process able to extract both wide and thin vessels while avoiding undesirable structure overemphasis and early segmentation stop.A general overview of the proposed method is depicted in Fig. 3. First, seed points are selected by seeking for points with the highest Frangi vesselness response (Section 3.1). Most of the automatically generated seed points are located in large vessels, thus the growing is made in a coarse-to-fine scheme in order to ensure a fluid and fast process. Therefore, starting from the highest scale σmax, the vesselness (Vσ) and direction (Dσ) features are computed for each scale. Then a region growing process based upon a specific criterion combining those two features is performed. This criterion will be described in Section 3.2. If all the scales are explored, i.e. σminis reached, the segmented image is obtained else the segmentation process restarts with the next scale σ−σstep. The details of the process evolution over the different scales are described in Section 3.3.Candidate seed points are automatically generated by the Frangi vesselness map analysis. Pixels exhibiting the maximum of vesselness are considered as a good starting point. Since the vesselness is always maximum along the vessels’ centerlines and close to zero outside tube-like regions, the initial seed points are generally located in the center of vascular regions. To avoid points in the peripheral positions with high response, the search is done inside a sub-area excluding the image borders.The red points in Fig. 4(a)–(c) show some automatically generated seeds on three different images. These points are often located in the center of wide vessels. One can see that some regions especially thin vessels with very low illumination may be unreachable. Thus, if the user is interested in thin vessel extraction, he may add some more additional seeds. The added seeds are depicted in green in Fig. 4.The idea behind our approach is to incorporate the vessel direction information with the vesselness response in order to improve the vessel segmentation result. This information has to be included in a way that favors neighbors exhibiting directions close to the direction of a seed point even if their vesselness responses are lower than a given threshold. This will help to ensure the continuity of the segmentation along the artery direction, and reduce the number of broken branches as well. Based on this idea, we propose a region growing algorithm based on the following convergence condition:(8)forallpixelp,ifthereexistsq∈N4(p)suchthatB(q)=1andVσ(p)>η(1−Ωσ(p,q)),thenB(p)←1.Here B is the binary image corresponding to the segmentation,N4(p)is the 4-neighborhood of pixel p, and Ωσis a correlation index between vessel orientations at pixels p and q, defined as follows:(9)Ωσ(p,q)=Dσ(p).Dσ(q)‖Dσ(p)‖‖Dσ(q)‖Ωσ(p, q) becomes one when the two local direction vectors are parallel and becomes zero if they are orthogonal. As a result, the growing process may aggregate pixels with close directions even if their vesselness values are low. The η parameter is a basic threshold of the vesselness value needed to growing the vessel region. If we assume that the vesselness is rescaled in the interval [0,1], η will be between 0 and 1. The smaller value of the parameter η can result in the overgrowth of the vessel region, while the bigger one will limit the extension of the seed point set.A pseudo-code for the MSRG algorithm is given in Algorithm 1. The initial seeds (binary image S) are used to initialize an iterative region growing segmentation process, whose output is the binary image B. Then, at each scale starting from the largest scale σmax, the vesselness (Vσ) and direction (Dσ) features are computed from the original image I. At each scale, the region growing process is implemented using a processing queue Q, which is initialized with the current segmentation image B. Then, the first pixel of the queue (q←Q.first) is picked, its 4-neighbors meeting the growing condition of Eq. (8) are added to the queue and to the segmented image, then q is pulled out of the queue, the new first pixel of the queue is picked, and so on until the queue is empty. If all the scales have been explored, i.e. σminis reached, then the segmented process is done, else it restarts with the next scale σ−σstep.Algorithm 1Multiscale region growing (I, S).Require:S≠01:  B←S2:  σ←σmax3:  whileσ≥σmindo4:    Q←{q;B(q)=1}5:    whileQ≠∅ do6:      q←Q.first7:      for allp∈N4(q)do8:        ifB(p)=0 andVσ(p)>η(1−Ωσ(p, q)) then9:          B(p)←110:          Q←Q∪{p}11:        end if12:      end for13:      Q←Q\{q}14:    end while15:    σ←σ−σStep16:  end while17:  returnB

@&#CONCLUSIONS@&#
