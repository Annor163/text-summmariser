@&#MAIN-TITLE@&#
Robust transmission expansion planning

@&#HIGHLIGHTS@&#
We derive optimal transmission expansion plans for an electric energy system.Uncertainty is accounted for by a two-stage adaptive robust optimization problem.The resulting three-level model is solved by a cutting-plane decomposition method.The transmission plan is very conditioned by the budget and the uncertainty level.The new strategic lines to be built do not follow an incremental order.

@&#KEYPHRASES@&#
Adaptive robust optimization,Complementarity,OR in energy,Transmission expansion,Two-stage,

@&#ABSTRACT@&#
The work reported in this paper addresses the problem of transmission expansion planning under uncertainty in an electric energy system. We consider different sources of uncertainty, including future demand growth and the availability of generation facilities, which are characterized for different regions within the electric energy system. An adaptive robust optimization model is used to derive the investment decisions that minimizes the system’s total costs by anticipating the worst case realization of the uncertain parameters within an uncertainty set. The proposed formulation materializes on a mixed-integer three-level optimization problem whose lower-level problem can be replaced by its KKT optimality conditions. The resulting mixed-integer bilevel model is efficiently solved by decomposition using a cutting plane algorithm. A realistic case study is used to illustrate the working of the proposed technique, and to analyze the relationship between the optimal transmission investment plans, the investment budget and the level of supply security at the different regions of the network.

@&#INTRODUCTION@&#
Within an electric industry context, Transmission Expansion Planning (TEP) refers to the decision-making process faced by a Transmission System Operator (TSO) to resolve on the best way to expand or reinforce an existing electricity transmission network. De Dios et al. (2007) provide an industry perspective of this important decision-making problem. The TSO is the publicly controlled entity in charge of operating, maintaining, reinforcing and expanding the electricity transmission network within a given jurisdiction. TSOs in the different European countries are coordinated through ENTSO-E (ENTSO-E, 2013). In the US, TSOs have generally more limited attributes than TSOs in Europe, and are generally referred to as Regional Transmission Organizations (RTOs). Well-known RTOs in the US are PJM (PJM Interconnection, 2013), and the Midwest Independent System Operator (Midwest Independent System Operator, 2013).The aging of the electrical transmission infrastructure is nowadays apparent in many electric energy systems throughout the world, as pointed out in the MIT technical report (MIT Energy Initiative, 2011). Therefore, it is most needed the development of mathematical models and computation tools to help TSOs to make effective decisions regarding the improvement and updating of the electricity transmission infrastructure. Such decisions have to be made under great uncertainty due to the uncertain nature of both the electrical demand growth and the stochastic production of some generation facilities, such as wind- or solar-based units. This uncertainty has both spatial and temporal dimensions as demands and production facilities are located at different geographical sites, and the demand and the stochastic production are both temporally correlated (Baringo and Conejo, 2013). Additionally, uncertainty pertaining to equipment failure also affects the operation (Bouffard et al., 2005) and thus the expansion/reinforcement planning of the transmission network.Transmission planning decision-making involves usually a planning horizon of approximately 10 years with revisions every 2 years, as described, for instance, in De Dios et al. (2007). Nevertheless, this planning horizon might be shortened or lengthened depending on construction, environmental or policy considerations. Building time for transmission facilities are much shorter that such times for production facilities and range between 6 months and 2 years. Therefore TEP is a medium-term expansion planning problem with a smaller level of uncertainty than that involved in the investment in production facilities. Moreover, the planning exercise should account for the entire life of the infrastructure to be built. However, using a year-by-year representation of investment decisions may result in a very complex and computationally intractable model. In order to ensure tractability while keeping the model accurate enough, one or few target years are usually selected for the planning exercise and annualized investment costs are considered (see for instance De la Torre, 2008; Garcés et al., 2009; Jabr, 2013; Sauma and Oren, 2006). Nevertheless, properly capturing the effect of the uncertain parameters on the investment outcomes is critical to achieve effective transmission investment plans.The pioneering work on transmission expansion planning is reported in Garver (1970), while relevant contributions based on mathematical programming are due to Pereira and his collaborators in Brazil, e.g., Monticelli et al. (1982),Pereira and Pinto (1985) and Binato et al. (2001). Relevant heuristics have been developed by Romero and his collaborators, e.g., Romero (1996). Stochastic programming is used, among other works, in De la Torre (2008) and Villumsen and Philpott (2013). Modeling explicitly a market environment in the decision-making process is addressed in Garcés et al. (2009), while an interesting game-theoretical approach is proposed in Sauma and Oren (2006).Infrastructure is generally designed to be able to operate correctly under the worst plausible condition, e.g., a bridge should withstand a maximum weight under adverse climate conditions and a sea breakwater should withstand the strongest plausible wave. Thus, traditionally, any infrastructure is designed considering solely the worst plausible condition of future operation. In fact, regarding electricity transmission expansion planning, this is common practice.Note that on a daily or hourly basis, the objective in electricity systems is generally minimizing expected operating costs. This is mainly because, in general, the different sources of uncertainty that are present in the system can be predicted accurately in the short-term, e.g., level of demand, wind power production, equipment availability, etc., and thus the probability of occurrence of an unforeseen event, with a high potential damage, is very small.However, this framework drastically changes when the operation of the system is seen years in advance, and planning decisions, like transmission expansion, need to be made. In this case, there is a high uncertainty about which would be the operating conditions within the lifetime of the new infrastructure (30–50 years ahead). Moreover, these investment decisions are in general irrevocable because of their high investment costs.Therefore, infrastructures must be designed so that they perform well under extreme operating conditions. Note that this is generally guaranteed by ensuring the correct functioning of the system under the worst possible operating condition.However, the worst future condition is unknown and we have to cope properly with this uncertainty with real reliability and economic consequences. If we are conservative and design a transmission system around a worse-than-actual condition, we end up building a stronger transmission system than needed at higher cost. If we, conversely, design a transmission system around a better-than-actual worst-case, we build a transmission system unable to withstand the actual worst condition, resulting in collapse or losses. To confront this challenge, we propose describing uncertainty through plausible robust sets. These sets are meant to represent a range of possible worst-case outcomes for use in infrastructure planning.Additionally, we need to ensure that the future transmission system will be able to withstand the worst plausible operation condition, hence we will work on robust optimization approaches, i.e., approaches that guarantee worst case protection within a plausible uncertainty set. Moreover, since the robust sets that we use are parameterized through a set of conservatism parameters, we are able to characterize the critical tradeoff security vs. cost and generate an array of efficient design solutions for the decision-maker to choose.Adaptive robust optimization (ARO) (Bertsimas et al., 2011) allows modeling decision making under uncertainty with recourse. For transmission expansion problems, ARO involves three steps: investment decision making pursuing maximum social welfare, worst uncertainty realization within a plausible uncertainty set that respects the physics of the problem, and operation decision making to mitigate the negative effect to the uncertainty realization and to achieve maximum social welfare. Traditional robust optimization techniques (Soyster, 1973) do not allow for controlling the level of robustness, i.e., conservatism, of the solution attained, which is a major drawback; however the work in Bertsimas et al. (2011) introduces formulations that make it possible to control the level of robustness of the solutions attained. Such formulations allow developing valuable planning tools, which are relevant in practice.ARO has two important advantages with respect to stochastic programming models that generally require a large number of scenarios to represent the uncertainty involved (Gabrel et al., 2013). On one hand, scenarios need not to be generated, and since generating scenarios, based on statistics distributions or others, may entails a crude approximation on the description of the uncertain parameters, not needing scenarios is an advantage. Instead, robust sets are used in ARO models (Bertsimas and Brown, 2009), and constructing such sets is generally much simpler than generating scenarios. On the other hand, an ARO model has commonly a moderate size, which does not grow with the number of scenarios, and thus, computational tractability is not at stake. On the contrary, the size of a stochastic programming model grows with the number of scenarios, which may result in intractability; and often, a large number of scenarios is needed to accurately represent the uncertain parameters.A recent application of ARO to transmission expansion planning is reported in Jabr (2013). This approach is similar to the one presented in this paper but differs in the solution methodology, the technical features of the proposed model, and the type of analysis performed. First of all, a Benders decomposition scheme, which requires the computation of dual variables, is used in Jabr (2013) to solve the ARO problem while we apply a constraint-and-column generation method solely based on primal cuts. Second, the uncertainty budget used in Jabr (2013) limits the number of uncertain parameters that are allowed to change. The subproblem is then simplified assuming that all the uncertain parameters need to be equal to their upper or lower limits in the worst case scenario. However, the uncertainty budget considered in this work is more general since we just limit the level of variation of the uncertain parameters within the robust set, which also allows characterizing regional uncertainty budgets. Third, Jabr (2013) does not account for the investment budget while part of our study is focused on analyzing the effect that this budget has on the optimal transmission planning. Finally, we also study in detail how an increase of the uncertainty level and/or the investment budget reconfigures the optimal set of lines to be built.To tackle the transmission expansion planning problem, we propose a novel adaptive robust optimization model that includes the features below:1.The objective is to minimize the system’s investment cost plus the worst possible operating costs (under different levels of conservatism) over the considered planning horizon.Uncertain parameters involving demand growth, stochastic generation levels and equipment failures are described using a robust set.The level of robustness is controlled using a variety of physically-based budget constraints over the robust set.The three-level decision framework considered involves (i) making investment decisions pursuing minimum total cost, (ii) worst uncertainty realization within the plausible uncertainty set, and (ii) implementation of operation decisions pursuing minimum total cost.Mathematically, the proposed model materializes in a min-max-min problem apparently hard to solve. However, using the optimality condition of the right-hand-side min problem, the two inner problems (max-min) can be merged into a single max problem. This results in a final min-max problem with bilinear terms that can be efficiently linearized and solved until optimality by implementing a decomposition algorithm. A constraint-and-column generation approach is used, as in Zeng and Zhao (2013), which results in an efficient solution algorithm.A relevant feature of the proposed model is that it allows parameterizing the optimal investment plan with respect to both the level of robustness and the available budget. This is an important piece of information for TSO practitioners, as it allows representing the tradeoff among alternative investment policies.The contributions of the model and algorithm proposed in this paper are threefold:1.Adaptive robust optimization is used to efficiently solve the transmission expansion planning problem of an electric energy system.The proposed adaptive robust approach renders an efficient solution algorithm that allows parameterizing the optimal solution as a function of the level of robustness per region of the system and the available investment budget.The analysis carried out on a realistic case study illustrates the relevance of the proposed model to derive informed transmission investment plans, and to characterize the tradeoff risk vs. cost.This document is organized as follows. Section 2 describes a compact formulation of the adaptive robust transmission investment model. A more detailed formulation is presented at Section 3, which explicitly considers the different technical features of the electric energy system and its associated uncertainties. The solution technique adopted to solve the ARO model is introduced in Section 4. Section 5 presents a comprehensive analysis of the results obtained from a realistic case study. Finally, some relevant conclusions are drawn in Section 6.The deterministic version of the transmission expansion problem considered in this paper can be represented by the following linear formulation,(1a)minx,ycTx+bTy(1b)s.t.cTx≤Π(1c)Ax+By=Ed¯(1d)Fx+Gy≤Kd¯(1e)xl∈{0,1}∀lThe objective function (1a) represents the minimization of the system’s total costs, including transmission line investment costs (cTx) and operating costs (bTy). The transmission investment decision variables are gathered in vector x. Note that vector x is binary to represent the build/not-build nature of each investment decision. Similarly, vector y refers to the operating decision variables which are assumed to be continuous. These operating variables include power production from each generating unit, load shedding per node and power line flows. Constraint (1b) ensures that the total investment costs do not exceed the available budget Π. The equality constraints related to the system’s operations (e.g., the power balance at each node of the network) are considered in (1c), while constraint (1d) accounts for the inequality conditions, e.g., upper and lower power outputs for each generating units. It should be emphasized that the operation constraints (1c) and (1d), depend on both x and y, which implies that the transmission investment decisions alter the configuration of the transmission network and thus the operation of the system.To move to a stochastic model, we assume that vector d includes all the model’s uncertain parameters, i.e., demand load levels and available generation resources. These uncertainties influence the operation of the system through constraints (1c) and (1d). Note that in the deterministic model (1) the uncertain vector d is fixed to its expected valued¯.In this section we extend the deterministic formulation (1) by considering the uncertain nature of vector d. Our purpose is to find the optimal transmission expansion planing x, which best performs in terms of costs, but anticipating the worst possible realization of the uncertain vector of parameters d. In particular, we formulate the adaptive robust optimization (ARO) version of problem (1). In broad terms, the adaptive model can be described as follows:1.The best transmission expansion planning x is sought by minimizing the system’s total costs. This is done by anticipating that, right after this decision is made,“nature” will behave in the worst possible manner. Thus, assuming that x is fixed, nature will select the realization of the uncertain parameters d that maximizes the system’s operating cost. This is done by anticipating that, right after the worst uncertainty outcome is realized,the system will try to adapt to it. Thus, assuming that x and d are fixed, the system operator will select the optimal decision variables y in order to minimize the system’s operating costs.It is important to note that this sequence of decisions is consistent with the real-world planning and operations of electric energy systems. In general, transmission investment decisions are the first ones to be made (on a medium-term basis). Then, depending on the operating conditions, which can be identified as the different realizations of the uncertainty, the system operator would select the best actions to minimize the operating costs.The above hierarchical structure is represented by the following three-level optimization problem:(2a)minxcTx+maxd∈Dminy∈Ω(x,d)bTy(2b)s.t.cTx≤Π(2c)xl∈{0,1}∀lThe worst case realization of the uncertainty and the successive adaptive action is considered in the max-min problemmaxd∈Dminy∈Ω(x,d)bTy. Note that d ∈ D defines the uncertainty set and Ω(x, d) = {y: Ax + By = Ed, Fx + Gy ≤ Kd} ensures the feasibility of the operating decision variables y for each x and d.It is important to note that a careful definition of the uncertainty set D is crucial for an effective representation of the uncertainty involved. In order to define D, we consider a polyhedral uncertainty set similar to the one used in Bertsimas and Sim (2002) and Bertsimas and Sim (2004). Such uncertainty set is described by the following constraints:(3a)dk∈[dkmin,dkmax]∀k,(3b)∑k∈Υr|dkref−dk|∑k∈Υr(dkmax−dkmin)≤Γr,∀rwhere dkis the kth component of vector d. Parametersdkminanddkmaxare upper and lower bounds for dk, while Γr is denoted as the uncertainty budget. Index r refers to the region of the transmission network considered, so that k ∈ ϒr denotes the demand loads or generation units k, located at region r.Note that values for Γr lie within the range 0 ≤ Γr ≤ 1. In particular, Γr = 0 impliesdk=dkref∀k,so that no uncertainty is considered, while Γr = 1 allows dkadopting any value within the intervaldkmin≤dk≤dkmax,which can be understood as the maximum level of uncertainty.Parameterdkref∈[dkmin,dkmax]is used as a reference to measure the total amount of deviations of the uncertain parameter. In this paper we have considered that, when modeling demand uncertainty,dkref=dkmin,and for the case of generation capacity uncertainty, thendkref=dkmax. Section 3 shows how this selection results in not using the absolute value in (3b), so that (3) can be formulated as a linear set of constraints. Specifically, Section 3.4 provides some guidelines on howdkminanddkmaxcan be estimated based on historical data. Furthermore, instead of estimating Γr and fix it to a certain value, Γr is used in this paper as a parameter to analyze the impact of different levels of uncertainty in the system’s costs.The detailed adaptive robust formulation of the transmission expansion problem used in this paper is provided below:(4a)minxnmLmaxPjD,PiGmaxminPiG,LSn,δn∑(n,m)∈ΩnewcnmLxnmL+σ(∑iciGPiG+∑npnLSn)(4b)s.t.∑j∈ΨnPjD−∑i∈ΨnPiG+∑mxnmLBnm(δn−δm)=LSn∀n(4c)xnmLBnm(δn−δm)≤PnmLmax∀n,∀m(4d)0≤LSn≤∑j∈ΨnPjD∀n(4e)0≤PiG≤PiGmax∀i(4f)δ1=0(4g)s.t.0≤PiGmax≤P^iGmax∀i(4h)∑i∈Υr(P^iGmax−PiGmax)∑i∈ΥrP^iGmax≤ΓrG∀r(4i)PjDmin≤PjD≤PjDmax∀j(4j)∑j∈Υr(PjD−PjDmin)∑j∈Υr(PjDmax−PjDmin)≤ΓrD∀r(4k)s.t.∑(n,m)∈ΩnewcnmLxnmL≤ΠLmax(4l)xnmL∈{0,1}∀n,∀m(4m)xnmL=xmnL∀n,∀m(4n)xnmL=1∀(n,m)∈ΩoldThe above three-level optimization problem is equivalent to (2), where the different decision variables can be identified as: x ={xnmL},d ={PjD,PiGmax}and y ={PiG,LSn,δn}.Objective function (4a) represents the total system costs: the sum of the total transmission investment costs and the operating ones. ParametercnmLis the annualized investment cost for the line connecting nodes n and m, andxnmLis the binary decision variable of the upper-level problem associated with this line (xnmL=1/0if the line is built/not-built). Total operating costs include: (a) the generation costs from all units, and (b) the load shedding costs associated with all unserved loads. The generating cost of each unit i is computed as the production costciGof that unit i times its produced energyPiG,while the shedding cost at node n is computed as the unserved energy cost pnat that node times the unserved energy at that same node, LSn. Note that σ is a weighting/discount factor to make investment and operation costs comparable.A detailed description of the constraints included on each of the three optimization levels in (4) is presented within the following three subsections.Constraints (4k)–(4n) are equivalent to (2b) and (2c), where ΠLmax is the transmission investment budget. Ωold and Ωnew are the sets of existing and new transmission lines, respectively, e.g., (n, m) ∈ Ωold represents the existing lines connecting nodes n and m.The uncertainty set d ∈ D in (2), which is further described in (3), is represented by constraints (4g)–(4j). As previously indicated, two sources of uncertainty are considered in this work:1.The available production capacityPiGmaxof each generating unit i. We assume that the level of availability of each generating unit depends on several stochastic conditions, such as equipment failures or, if i is a renewable unit, on future weather conditions (sun radiation or wind speed). Constraint (4g) ensures that the available production capacity of unit i is not greater than its total installed capacityP^iGmax. The total deviations of the available capacities with respect to the installed ones is bounded in (4h) by the uncertainty budgetΓrG. Note that this limit is imposed per region r, which allows a more flexible and realistic treatment of the uncertainties, i.e., we distinguish between regions that integrate different production technologies and that are characterized by different uncertainty sources. In these cases, i/j ∈ ϒr identifies the generation units or demand loads that are located in region r. Observe also that a casePiGmax=0corresponds to the failure of unit i.The load levelPjDfor each demand j. Note that this uncertainty is characterized not only by the short-term variabilities of the electricity demand but, since transmission investment is a medium-term decision, it also accounts for longer-term dynamics such as uncertain demand growths. Constraint (4i) enforces the demand load levels to lay between the boundsPjDminandPjDmax. The uncertainty budget for the demand load is also defined per region by (4j) so thatΓrDis the demand uncertainty budget for region r.Comparing (4g)–(4j) with (3) we observe thatdkref∼P^iGmax,for the case of energy generation, anddkref∼PjDminfor the demands. The election of these references to quantify the total generation and demand variations allows not using the nonlinear absolute value in (3b). This can be verified by noticing that the worst realization of “nature” would seek, for a fixed network configuration, to cause the maximum level of load shedding (and thus the maximum operating costs). Therefore, it will try to make the generation capacityPiGmaxto be as lower as possible with respect toP^iGmaxand the demand loadPjDto be as higher as possible with respect toPjDmin.It is important to note that model (4) is general enough to account for complex interactions, including correlation effects among demand loads and generation levels. Moreover, since the demand and production uncertainty sets (4g)–(4j) encompass 1 year of operation, such sets allow accounting simultaneously for hourly, daily, weekly and monthly seasonality.For instance, consider that for region r of a given electric energy system, we have observed from historical data that it is highly improbable to face hours where the wind farms produce at their maximum installed capacity while the demand load is at minimum. To model such circumstance, we can combine the uncertainty budget constraints (4h) and (4j) as follows:(5)∑i∈Υr(P^iGmax−PiGmax)∑i∈ΥrP^iGmax+∑j∈Υr(PjD−PjDmin)∑j∈Υr(PjDmax−PjDmin)≤ΓrGD∀rwhereΓrGDtakes values between 0 and 1, so that, for the considered region r, if the demand deviations are high, then the available capacity deviations need to be low. Similarly, if the available capacity deviations are high, then the demand deviations need to be low.Constraints (4b)–(4f) are equivalent to the set Ω(x, d) in (2), which defines the feasible region for the operating decision variables. These variables are the energy producedPiGby each generating unit i, the load shedding LSn at each node n of the network, the angle δnat node n.Model (4) embeds a dc linear representation of the network energy flows. Equation (4b) imposes the energy balance at each node of the network where Bnmrepresents the electrical susceptance of the line connecting nodes n and m, while δnis the angle of bus n. Ψnis the set of the generation units i and demands j that are located at node n. The maximum capacity of the line connecting nodes n and m, i.e.,PnmLmax,is enforced by (4c). Constraint (4d) ensures that the total load shedding at node n is non-negative and no greater that the total load at that node. Similarly, (4e) bounds the energy production for generating unit i. Finally, (4f) selects the first node as the reference one by fixing its voltage angle to zero.Note that the upper-level decision variables,xnmL,as well as the medium-level ones,PjDandPiGmax,are included in constraints (4b)–(4f) and thus they influence the lower-level problem, i.e., the minimization of the operating costs. Observe also that the investment decision variablexnmLmultiplies the node’s angles δnat (4b) and (4c). However, since the investment decision is a binary variable, these products can be linearized without approximation as follows.Let us define Δnm= δn− δm. The bilinear term to be linearized is thenγnm=xnmLΔnm,wherexnmLis a binary variable. Note that the bilinear termxnmLΔnm,regardless of the sing of Δnm, can be replaced by the following linear constraints:(6a)−xnmLM≤γnm≤xnmLM∀n,∀m(6b)−(1−xnmL)M≤Δnm−γnm≤(1−xnmL)M∀n,∀m,where M is a large enough constant. Note that by implementing this linearization we can linearly formulate Ω(x, d) as stated in (2).The appropriate selection of robust uncertainty sets is currently an active area of research, see for instance Bertsimas and Brown (2009),Bertsimas et al. (2013),Bandi and Bertsimas (2012) and Ben-Tal et al. (2013). These approaches make use of available data (thus, the denomination data-driven) to build uncertainty sets that ensure a probability guarantee, i.e., regardless of the data distribution these approaches guarantee that the resulting set contains the random variable for a given confidence level. However, more often than not the formulation of the resulting sets is complex and often nonlinear, which makes difficult their use in large scale problems. This is specially so for the case for two-stage adaptive formulations, like the model presented in this work. Thus, these techniques are not used in this paper.Nevertheless, it is still possible to define appropriate polyhedral uncertainty sets by using available data. Fig. 1exemplifies how the uncertainty sets can be built based on historical time series. For instance, consider that we seek to expand the transmission network so that the resulting electricity system is robust for year 2020. To this end, we need to estimate the future load intervals PDmin and PDmax for the hourly demand, as well as the maximum installed capacity of the different technologiesP^Gmax. For the sake of simplicity, consider also an electricity generation mix including just wind power units and combined-cycle gas turbines. Fig. 1(a) represents the total hourly demand load in the Spanish electricity system OMIE (OMIE, 2013) for years 2007–2013. Based on this data and applying different statistical techniques (which are out of the scope of this paper) we can estimate the values of PDmin and PDmax for the target year 2020. Additionally, note that ΔD in Fig. 1(a) can be used to account for additional factors that may alter the future demand; for instance, a large scale integration of electric vehicles.Similarly, the data corresponding to the hourly power generation from wind units (Fig. 1(b)) and combined cycle gas turbines (Fig. 1(c)) can be used to estimate their future installed capacityP^Gmax. Note again that ΔG in Fig. 1(b) can be introduced to model unexpected factors altering the installed capacity, such as regulatory changes or random failures.We should emphasize that Fig. 1 represents the aggregate results for the Spanish system. However, similar time series can be obtained, and similar prediction analysis can be carried out, for a given demand node or region, or for a specific generation unit or set of units.From Fig. 1 we can observe that both the demand and the power generation behavior over time are characterized by non-constant mean and variance processes. In particular, it can be shown that these time series are highly influenced by seasonality (daily, weekly and others) and by the current meteorological conditions. Some forecasting tools that can tackle this stochastic nature are ARIMA, GARCH, dynamic factors or transfer function models (Alonso et al., 2011; Nogales and Conejo, 2006, among others). The idea is to use these models to forecast, under different confidence levels, the behavior of both the demand and the production capacities during the considered target year. Then, we can use such predictions to derive appropriate upper and lower bounds: PDmax, PDmin and PGmax (dashed lines in Fig. 1). For instance, PDmax and PDmin can be selected as specific sample distribution quantiles, where the sample includes all the hourly demand predictions for the target year.In general, two-stage adaptive robust models are difficult to tackle because their multilevel optimization structure often renders NP-hard problems. There are several solution algorithms specifically designed to address these problems, which can be viewed as extensions of Benders’ decomposition. In these methods, the fist stage objective function is gradually reconstructed using dual information from the second stage problem (Bertsimas et al., 2013; Jabr, 2013; Jiang et al., 2013; Thiele et al., 2010; Zhao and Zeng, 2012).In this paper we have implemented a cutting plane strategy solely based on primal cuts, i.e., it involves only primal decision variables. Some preliminary studies suggest that this algorithm, usually referred to as constraint-and-column generation method, performs computationally better than a Bender’s algorithm that is based on dual information. Convergence guarantee and other properties of this method are analyzed in Zeng and Zhao (2013),Zhao and Zeng (2012),Jiang et al. (2012),Jiang et al. (2013).Therefore, the three-level adaptive robust transmission expansion problem (4) is solved by decomposing it into a master problem and a subproblem that interchange primal information until convergence to an optimal solution is achieved.For clarity, in the following subsections we use the compact formulation (1) introduced in Section 2.The subproblem associated with (2) is(7)maxd∈Dminy∈Ω(x*,d)bTywhere the investment decisions are assumed to be fixed to x*, which are obtained from the solution of the master problem at each iteration of the algorithm.Bilevel problem (7) can be converted into an equivalent single-level problem by replacing the lower-level problem by its equivalent Karush–Kuhn–Tucker (KKT) conditions (which are necessary and sufficient conditions for optimality since the lower-level problem is linear and thus convex on its decision variables y). The resulting single-level problem is(8a)maxd,ybTy(8b)s.t.Hd≤h(8c)b+GTμ+BTλ=0(8d)Ax*+By=Ed(8e)0≤Kd−Fx*−Gy⊥μ≥0(8f)λ:freewhere λ and μ are the dual variable vectors associated with conditions Ax* + By = Ed and Fx* + Gy ≤ Hd, respectively.Constraint (8b) represents the matrix formulation of the uncertainty set d ∈ D, stated in (4g)–(4j). Equation (8c) results from differentiating the Lagrangian of the lower-level problem (4a)–(4f) with respect to the lower-level variables, and (8d) gathers the equality constraints (4b) and (4f). Constraint (8e) is the complementarity condition, equivalent to the set of constraints: Fx* + Gy − Kd ≤ 0, μ ≥ 0 and μT(Fx* + Gy − Kd) = 0. Note that this nonlinear complementarity condition can be linearized by using the generally well-behaved Fortuny-Amat (Fortuny-Amat and McCarl, 1981) transformation (9), which renders:(9a)0≤Kd−Fx*−Gy≤zM(9b)0≤μ≤(1−z)Mwhere z a vector of binary variables and M a sufficiently large constant.Replacing (8e) by the set of conditions (9) results in a MILP subproblem that can be solve efficiently by using standard branch-and-cut solvers. For the considered problem in this paper, we have experiences no numerical issues using the Fortuny-Amat transformation.Considering a Bender’s framework, the master problem is then formulated as follows:(10a)minx,yp,ηcTx+η(10b)s.t.cTx≤Π(10c)η≥bTyp∀p≤k(10d)Ax+Byp=Edp*∀p≤k(10e)Fx+Gyp≤Kdp*∀p≤k(10f)xl∈{0,1}∀lwhere k is the iteration index and p = 1, …, k.The optimization variables of master problem (10) are the auxiliary variable η, the operating decisions yp, one per iteration of the algorithm, and the investment decisions x. Parametersdp*are considered fixed in the master problem. Note thatdp*is the optimal value of the uncertain parameter, which is obtained from the subproblem at each iteration of the algorithm. For this reason, problem (10) can be viewed as a deterministic problem similar to (1) whered¯∼dp*.Additionally, master problem (10) incorporates a new set of constraints (10c)–(10e) at each iteration k of the algorithm. Note that this is done in a Bender’s decomposition fashion. However, it should be remarked that, opposed to the conventional Benders’ approach, these new constraints only include primal decision variables (primal cuts). Observe also that master problem (10) is a MILP that, similarly to subproblem (8), can be solved efficiently using standard branch-and-cut solvers.By taking into account the master problem and the subproblem defined in the previous subsections, the considered constraint-and-column generation algorithm is described in the following:Step 0Fix the Lower Bound (LB) to LB = -∞, the Upper Bound (UB) to UB = ∞ and the iteration counter to k = 0.If k = 0 solve the master problem (10) without including constraints (10c)–(10e). Otherwise, solve the complete version of master problem (10). Obtain the optimal solution{x*,η*,yp*}and update the lower bound asLB=cTx*+η*.Solve subproblem (8) by considering the optimal value x* obtained in Step 1 as a parameter. Obtain the optimal solution {d*, y*}, and update the upper bound asUB=min{UB,cTx*+bTy*}.If(UB−LB)/UB≤ϵ,return x* and terminate. Otherwise, update k ← k + 1 and setd(k+1)*=d*,where d* is the optimal solution obtained in Step 2. Continue with Step 1.As previously indicated, Zeng and Zhao (2013),Zhao and Zeng (2012) and Jiang et al. (2013) provide a convergence proofs of this type of algorithms, as well as an analysis of its convergence properties.In this section we comprehensively analyze a realistic case-study.The system considered in this case study is based on the 24-node RTS (Grigg et al., 1996), which is depicted in Fig. 2.The system has 24 nodes that are connected through 34 transmission lines. Technical data for these transmission lines is provided in Table 1, which includes their maximum transmission capacity and their electrical susceptance (physical parameter). We assume that the capacities of the lines connecting the northern and southern regions (dashed lines in Fig. 2) of the system are significantly lower than those of the rest of lines. This is purposely done to provoke congestion in these lines and thus obtaining a system that would benefit from investment in transmission facilities.Data regarding candidate lines to be potentially built is provided in Table 2. Note that the last column gives the annualized investment costs for each of these lines.Additionally, 18 production units and 17 demand loads are distributed throughout the system. Table 3provides data for these units and demands. Note that each production unit is characterized by its location on the network (second column), its maximum generation capacityP^iGmax(third column) and its generation costsciG(fourth column). Similarly, each demand load is characterized by its location on the network (sixth column), its expected valueP¯jD(seventh column) and the load shedding cost pnof its corresponding node (eighth column).In this case study, we do not directly implement any of the prediction techniques indicated in Section 3.4 since such techniques are out of the scope of this work, however, to be as general as possible, we assume that the load limits for any demand j are expressed asPjDmax=(1+ɛj)P¯jDandPjDmin=(1−ɛj)P¯jD. In particular, in this case study we consider that ɛ is always fixed to ɛ = 0.25, ∀j, so that the different uncertainty levels, for both generation and demands, are tuned up by varyingΓrGandΓrD,respectively.Moreover, in order to study the impact of uncertainties, we divide the system into two different regions, as depicted in Fig. 2, which are characterized as follows.Region 1(grey area): Significant uncertainty on the demand level, and no uncertainty on the available generation capacity.(white area): No uncertainty on the demand level, and high uncertainty on the available generation capacity.Region 1 may represent a geographical area of the system where most of the generation is already built and the future demand is difficult to predict (e.g., an eventual demand increase due to a city expansion). Conversely, Region 2 may represent a geographical area with almost no demand, or with demand that can be very well predicted (industrial site), and high uncertainty on the generation capacity because of uncertain future availability of production units (e.g., due to failures, environmental regulation, etc.)We fix parameter σ in (4a) to σ = 8760, which is the total number of hours in 1 year. This allows considering the same scale for both operation costs (hourly basis) and annualized investment costs.We consider that, the uncertainty budgets for generation and demand in Region 1 areΓ1G=0andΓ1D=0.4,respectively. Similarly, we consider that Region 2 is characterized byΓ2G=0.4andΓ2D=0. Note that these budgets are coherent with the uncertainty assumptions made for each region.Finally, the adjustment of constants M must take into account that their value should be sufficiently large to properly model the complementarity conditions (8e), but not too large so that the product binary × M does not pose any numerical difficulty. In particular, due to the nature of the linearized constraints, constants M can be classified into two types: (a) the constants M that are used to bound primal variables, whose values can be easily selected based on their physical nature; and (b) the constants M that are used to bound dual variables. This selection can be more complicated since dual variables are usually difficult to interpret. In order to tackle this problem, the heuristic method proposed in Ruiz and Conejo (2009) was implemented to tuned-up these constants.

@&#CONCLUSIONS@&#
A two-stage adaptive robust optimization model is used to derive optimal transmission expansion plans for an electric energy system.The proposed formulation allows representing different degrees of uncertainties affecting different regions of the system, which may involve demand levels, available generation capacities, or a combination of these. Moreover, historical data is used to design realistic uncertainty sets.The resulting optimal transmission expansion plan is the one that minimizes the total system’s costs (investment and operating costs) under the worst possible realization of the uncertain parameters within an uncertainty set.The proposed formulation consists in a mixed-integer three-level optimization problem that can be reformulated as a bilevel one. This is done by replacing the lower-level problem by its KKT optimality conditions.The resulting min-max problem is solved by using a cutting-plane decomposition method. The analysis of the computational burden associated to this method shows that it can be successfully implemented within a transmission expansion framework.Results indicate that the investment decisions on transmission facilities as well as the subsequent operation of the system are highly conditioned by the investment budget, and by the level of uncertainty predicted for the system.In general, a higher level of uncertainty translates into worse possible realizations of the uncertain parameters and thus into higher operating costs, i.e., the load shedding costs are increased by lower available generation capacities and higher demand load levels. However, as the investment budget increases, these negative effects can be mitigated by installing new strategic transmission lines that reinforce the existing transmission network and reduce the level of unserved energy in the system.It is important to note that the selection of these lines does not follow an incremental order, so that a marginal increase on either the uncertainty level or in the investment budget may result in a significantly different set of optimal lines to be built. Thus, the proposed methodology is of interest for transmission system operators to assist them on their decision making.