@&#MAIN-TITLE@&#
The unified discrete surface Ricci flow

@&#HIGHLIGHTS@&#
Give unified framework of Ricci flow for all schemes with all background geometries.Give four novel schemes for discrete surface Ricci flow.Introduce explicit geometric interpretations to discrete Ricci energy for all schemes.Give geometric interpretations to the Hessian of Ricci energy for all schemes.

@&#KEYPHRASES@&#
Unified,Ricci flow,Circle packing,Discrete Ricci energy,Hessian matrix,

@&#ABSTRACT@&#
Ricci flow deforms the Riemannian metric proportionally to the curvature, such that the curvature evolves according to a heat diffusion process and eventually becomes constant everywhere. Ricci flow has demonstrated its great potential by solving various problems in many fields, which can be hardly handled by alternative methods so far.This work introduces the unified theoretic framework for discrete surface Ricci flow, including all the common schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing and discrete Yamabe flow. Furthermore, this work also introduces a novel schemes, virtual radius circle packing and the mixed type schemes, under the unified framework. This work gives explicit geometric interpretation to the discrete Ricci energies for all the schemes with all back ground geometries, and the corresponding Hessian matrices.The unified frame work deepens our understanding to the discrete surface Ricci flow theory, and has inspired us to discover the new schemes, improved the flexibility and robustness of the algorithms, greatly simplified the implementation and improved the efficiency. Experimental results show the unified surface Ricci flow algorithms can handle general surfaces with different topologies, and is robust to meshes with different qualities, and is effective for solving real problems.

@&#INTRODUCTION@&#
Ricci flow was introduced by Hamilton for the purpose of studying low dimensional topology. Ricci flow deforms the Riemannian metric proportional to the curvature, such that the curvature evolves according to a heat diffusion process, and eventually becomes constant everywhere. In pure theory field, Ricci flow has been used for the proof of Poincaré’s conjecture. In engineering fields, surface Ricci flow has been broadly applied for tackling many important problems, such as parameterization in graphics [1], deformable surface registration in vision [2], manifold spline construction in geometric modeling [3] and cancer detection in medical imaging [4]. More applications in engineering and medicine fields can be found in [5].Suppose(S,g)is a metric surface, according to the Gauss–Bonnet theorem, the total Gaussian curvature∫SKdAgequals to2πχ(S), where K is the Gaussian curvature,χ(S)the Euler characteristics of S. Ricci flow deforms the Riemannian metric conformally, namely,g(t)=e2u(t)g(0), whereu(t):S→Ris the conformal factor. The normalized Ricci flow can be written as(1.1)du(t)dt=2πχ(S)A(0)-K(t).whereA(0)is the initial surface area. Hamilton [6] and chow [7] proved the convergence of surface Ricci flow. Surface Ricci flow is the negative gradient flow of the Ricci energy. It is a powerful tool for designing Riemannian metrics using prescribed curvatures, which has great potential for many applications in engineering fields. Surface Ricci flow implies the celebrated surface uniformization theorem as shown in Fig. 1. For surfaces with boundaries, uniformization theorem still holds as illustrated in Fig. 2, where surfaces are conformally mapped to the circle domains on surfaces with constant curvatures.Conformal metric deformation transforms infinitesimal circles to infinitesimal circles as shown in Fig. 3. Intuitively, one approximates the surface by a triangulated polyhedron (a triangle mesh), covers each vertex by a disk of finite size (a cone), and deforms the disk radii preserving the combinatorial structure of the triangulation and the intersection angles among the circles. This deformation simulates the smooth conformal mapping with very high fidelity. Rodin and Sullivan [8] proved that if the triangulation of a simply connected planar domain is subdivided infinite times, the induced discrete conformal mappings converge to the smooth Riemann mapping. The discrete version of surface Ricci flow was introduced by Chow and Luo in [9] in 2003. It is based on the circle packing method.Historically, many schemes of circle packing or circle pattern have been invented. The discrete surface can be constructed by gluing Spherical, Euclidean or Hyperbolic triangles isometrically along their edges. Accordingly, we say the triangle mesh has sphericalS2, EuclideanE2or hyperbolicH2background geometry. Under each background geometry, there are six schemes, tangential circle packing, Thurston’s circle packing, inversive distance circle packing, discrete Yamabe flow, virtual radius circle packing and mixed type scheme. There are 18 combinations in total. Among them, the hyperbolic and spherical virtual radius circle packing and mixed type schemes are first introduced in this work.Most of the existing schemes were invented and developed individually in the past. This work seeks a coherent theoretic framework, which can unify all the existing schemes, and predicts undiscovered ones. This leads to deeper understandings of discrete surface Ricci flow and provides approaches for further generalization. In practice, the theoretic discovery of virtual radius circle packing gives novel computational algorithm; the mixed schemes improves the flexibility; the unified framework greatly simplifies the implementation; the geometric interpretations offer better intuitions.This work has the following contributions:1.This work establishes a unified framework for discrete surface Ricci flow, which covers most existing schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing, discrete Yamabe flow, virtual radius circle packing and mixed type schemes, in Spherical, Euclidean and hyperbolic background geometry. In Euclidean case, our unified framework is equivalent to Glickenstein’s geometric formulation [10]. To the best of our knowledge, the unified frameworks for both hyperbolic and spherical schemes are reported for the first time.This work introduces 4 novel schemes for discrete surface Ricci flow: virtual radius circle packing and mixed type schemes under both hyperbolic and Spherical background geometries, which are naturally deduced from our unification work. To the best of our knowledge, these are introduced to the literature for the first time.This work gives an explicit geometric interpretation to the discrete Ricci energy for all the 18 schemes. The geometric interpretations to 2 Yamabe flow schemes (both Euclidean and Hyperbolic) were first made by Bobenko et al. [11].This work also provides an explicit geometric interpretation to the Hessian of discrete Ricci energy for all the 18 schemes. The interpretation in Euclidean case is due to Glickenstein [10]. To the best of our knowledge, the interpretation in Hyperbolic and Spherical cases are introduced for the first time. Recently, Glickenstein and Thomas discovered the similar result independently [12].The paper is organized as follows: Section 2 briefly reviews the most related theoretic works; Section 3 introduces the unified framework for different schemes of discrete surface Ricci flow, which covers 18 schemes in total; Section 4 explains the geometric interpretation of the Hessian matrix of discrete Ricci energy for all schemes with different background geometries; Section 5 gives a geometric interpretation of Ricci energy; Experimental results are reported in Section 6, different schemes are systematically compared. The work concludes in Section 7, future directions are discussed; Finally, in the appendix, we give the implementation details and reorganize all the formulae.In his work on constructing hyperbolic metrics on 3-manifolds, Thurston [13] studied a Euclidean (or a hyperbolic) circle packing on a triangulated closed surface with prescribed intersection angles. His work generalizes Koebe’s and Andreev’s results of circle packing on a sphere [14–16]. Thurston conjectured that the discrete conformal mapping based on circle packing converges to the smooth Riemann mapping when the discrete tessellation becomes finer and finer. Thurston’s conjecture has been proved by Rodin and Sullivan [8]. Chow and Luo established the intrinsic connection between circle packing and surface Ricci flow [9].The rigidity for classical circle packing was proved by Thurston [13], Marden and Rodin [17], Colin de Verdiére [18], Chow and Luo [9], Stephenson [19], and He [20].Bowers and Stephenson [21] introduced inversive distance circle packing which generalizes Andreev–Thurston’s intersection angle circle packing. See Stephenson [19] for more information. Guo gave a proof for local rigidity [22] of inversive distance circle packing. Luo gave a proof for global rigidity in [23].Luo introduced and studied the combinatorial Yamabe problem for piecewise flat metrics on triangulated surfaces [24]. Springborn et al. [25] considered this combinatorial conformal change of piecewise flat metrics and found an explicit formula of the energy function. Glickenstein [26,27] studied the combinatorial Yamabe flow on 3-dimensional piecewise flat manifolds. Bobenko–Pinkall–Springborn introduced a geometric interpretation to Euclidean and hyperbolic Yamabe flow using the volume of generalized hyperbolic tetrahedron in [11]. Combinatorial Yamabe flow on hyperbolic surfaces with boundary has been studied by Guo in [28]. The existence of the solution to Yamabe flow with topological surgeries has been proved recently in [29,30].The Euclidean virtual radius circle packing first appeared in [5]. The hyperbolic and spherical virtual radius circle packing are introduced in this work.The Euclidean mixed type circle packing appeared in [5] and Glickenstein’s talk [31]. This work introduces hyperbolic and spherical mixted type schemes.Recently Glickenstein [10] set the theory of combinatorial Yamabe flow of piecewise flat metric in a broader context including the theory of circle packing on surfaces. This work focuses on the hyperbolic and spherical unified frameworks.The variational approach to circle packing was first introduced by Colin de Verdiére [18]. Since then, many works on variational principles on circle packing or circle pattern have appeared. For example, see Brägger [32], Rivin [33], Leibon [34], Chow and Luo [9], Bobenko and Springborn [35], Guo and Luo [36], and Springborn [37]. Variational principles for polyhedral surfaces including the topic of circle packing were studied systematically in Luo [38]. Many energy functions are derived from the cosine law and its derivative. Tangent circle packing is generalized to tangent circle packing with a family of discrete curvature. For exposition of this work, see also Luo et al. [39].Recently, Gu et al. established discrete uniformization theorem based on Euclidean [29] and hyperbolic [30] Yamabe flow. In a series of papers on developing discrete uniformization theorem [40–43], Sa’ar Hersonsky proved several important theorems based on discrete harmonic maps and cellular decompositions. His approach is complementary to the work mentioned above.This section systematically introduces the unified framework for discrete surface Ricci flow. The whole theory is explained using the variational principle on discrete surfaces based on derivative cosine law [39]. The elementary concepts and some of schemes can be found in [38] and the chapter 4 in [5].In practice, smooth surfaces are usually approximated by discrete surfaces. Discrete surfaces are represented as two dimensional simplicial complexes which are manifolds, as shown in Fig. 4.Definition 3.1Triangular MeshSupposeΣis a two dimensional simplicial complex, furthermore it is also a manifold, namely, for each point p ofΣ, there exists a neighborhood ofp,U(p), which is homeomorphic to the whole plane or the upper half plane. ThenΣis called a triangular mesh.IfU(p)is homeomorphic to the whole plane, then p is called an interior point; ifU(p)is homeomorphic to the upper half plane, then p is called a boundary point.The fundamental concepts from smooth differential geometry, such as Riemannian metric, curvature and conformal structure, are generalized to the simplicial complex, respectively.In the following discussion, we useΣ=(V,E,F)to denote the mesh with vertex set V, edge set E and face set F. A discrete surface is with Euclidean (hyperbolic or spherical) background geometry if it is constructed by isometrically gluing triangles inE2(H2orS2) (see Fig. 5).Definition 3.2Discrete Riemannian MetricA discrete metric on a triangular mesh is a function defined on the edges,l:E→R+, which satisfies the triangle inequality: on each face[vi,vj,vk],li,lj,lkare the lengths of edges againstvi,vj,vkrespectively,li+lj>lk,lj+lk>li,lk+li>lj.A triangular mesh with a discrete Riemannian metric is called a discrete metric surface.SupposeΣis a discrete metric surface, if each face ofΣis a spherical, (Euclidean or hyperbolic) triangle, then we sayΣis with spherical, (Euclidean or hyperbolic) background geometry. We useS2,E2andH2to represent spherical Euclidean or hyperbolic background metric.Triangles with different background geometries satisfy different cosine laws:1=cosθi+cosθjcosθksinθjsinθkE2cosli=cosθi+cosθjcosθksinθjsinθkS2coshli=coshθi+coshθjcoshθksinhθjsinhθkH2The discrete Gaussian curvature is defined as angle deficit, as shown in Fig. 6.Definition 3.4Discrete Gauss CurvatureThe discrete Gauss curvature function on a mesh is defined on vertices,K:V→R,K(v)=2π-∑jkθijk,v∉∂Mπ-∑jkθijk,v∈∂M,whereθijk’s are corner angle atviin the face[vi,vj,vk], and∂Mrepresents the boundary of the mesh.The Gauss–Bonnet theorem still holds in the discrete case.Theorem 3.5Discrete Gauss–Bonnet TheoremSupposeΣis a triangular mesh with Euclidean background metric. The total curvature is a topological invariant,(3.1)∑v∉∂ΣK(v)+∑v∈∂ΣK(v)+∊A(Σ)=2πχ(Σ),whereχis the characteristic Euler number, and K is the Gauss curvature,A(Σ)is the total area,∊={+1,0,-1}ifΣis with spherical, Euclidean or hyperbolic background geometry.Definition 3.6Circle Packing MetricSupposeΣ=(V,E,F)is a triangle mesh with spherical, Euclidean or hyperbolic background geometry. Each vertexviis associated with a circle with radiusγi. The circle radius function is denoted asγ:V→R>0; a function defined on the vertices∊:V→{+1,0,-1}is called the scheme coefficient; a function defined on edgesη:E→Ris called the discrete conformal structure coefficient. A circle packing metric is a 4-tuple(Σ,γ,η,∊), the edge length is determined by the 4-tuple and the background geometry.In the smooth case, changing a Riemannian metric by a scalar function,g→e2ug, is called a conformal metric deformation. The discrete analogy to this is as follows.Definition 3.7Discrete Conformal EquivalenceTwo circle packing metrics(Σk,γk,ηk,∊k),k=1,2, are conformally equivalent ifΣ1=Σ2,η1=η2,∊1=∊2. (γ1may not equals toγ2.)The discrete analogy to the concept of conformal factor in the smooth case is.Definition 3.8Discrete Conformal FactorDiscrete conformal factor for a circle packing metric(Σ,γ,η,∊)is a function defined on each vertexu:V→R,(3.2)ui=logγiE2logtanhγi2H2logtanγi2S2SupposeΣ=(V,E,F)is triangle mesh with spherical, Euclidean or hyperbolic background geometry. Given a circle packing metric(Σ,γ,η,∊), for an edge[vi,vj]∈E, its lengthlijis given by(3.3)lij2=2ηijeui+uj+εie2ui+εje2ujE2coshlij=4ηijeui+uj+(1+εie2ui)(1+εje2uj)(1-εie2ui)(1-εje2uj)H2coslij=-4ηijeui+uj+(1-εie2ui)(1-εje2uj)(1+εie2ui)(1+εje2uj)S2The schemes are named as follows:SchemeεiεjηijTangential circle packing+1+1+1Thurston’s circle packing+1+1[0,1]Inversive distance circle packing+1+1>0Yamabe flow00>0Virtual radius circle packing−1−1>0Mixed type{-1,0,+1}{-1,0,+1}>0Figs. 7 and 8illustrate all the schemes with for discrete surfaces with Euclidean background geometry.Remark 3.10From the definition, the tangential circle packing is a special case of Thurston’s circle packing; Thurston’s circle packing is a special case of inversive distance circle packing. In the following discussion, we unify all three types as inversive distance circle packing.Definition 3.11Discrete Surface Ricci FlowA discrete surface withS2,E2orH2background geometry, and a circle packing metric(Σ,γ,η,∊), the discrete surface Ricci flow is(3.4)dui(t)dt=K‾i-Ki(t),whereK‾iis the target curvature at the vertexvi.The target curvature must satisfy certain constraints to ensure the existence of the solution to the flow, such as Gauss–Bonnet equation Eq. (3.1), but also some additional ones described in [13,17,9], for instances.The discrete surface Ricci flow has exactly the same formula as the smooth counter part Eq. (1.1). Furthermore, similar to the smooth case, discrete surface Ricci flow is also variational: the discrete Ricci flow is the negative gradient flow of the discrete Ricci energy.Definition 3.12Discrete Ricci EnergyA discrete surface withS2,E2orH2background geometry, and a circle packing metric(Σ,γ,η,∊). For a triangle[vi,vj,vk]with inner angles(θi,θj,θk), the discrete Ricci energy on the face is given by(3.5)Ef(ui,uj,uk)=∫(ui,uj,uk)θidui+θjduj+θkduk.The discrete Ricci energy for the whole mesh is defined as(3.6)EΣ(u1,u2,⋯,un)=∫(u1,u2,⋯,un)∑i=1n(K‾i-Ki)dui.From definition, we get the relation between the surface Ricci energy and the face Ricci energy(3.7)EΣ=∑i=1n(K‾i-2π)ui+∑f∈FEf.The description of the energy in terms of an integral requires the fact that the inside is a closed form so that it is defined independent of the integration path. This follows from the following symmetry lemma, which has fundamental importance. In this work, we give three proofs. The following one is algebraic, more difficult to verify, but leads to computational algorithm directly. The second one is based on the geometric interpretation to the Hessian matrix in Section 4. The third one is based on the geometric interpretation to the discrete Ricci energy. The later two proofs are more geometric and intuitive.Lemma 3.13SymmetryA discrete surface withS2,E2orH2background geometry, and a circle packing metric(Σ,γ,η,∊), then for any pair of verticesviandvj:(3.8)∂Ki∂uj=∂Kj∂ui.From the relation in Eq. (3.7), it is sufficient and necessary to show the symmetry for each triangle[vi,vj,vk]for all schemes,∂θi∂uj=∂θj∂ui.This is proven by finding the explicit formula for the Hessain matrix of the face Ricci energy,(3.9)∂(θi,θj,θk)∂(ui,uj,uk)=-12ALΘL-1D,where(3.10)A=12sinθis(lj)s(lk)the matrix L(3.11)L=s(li)000s(lj)000s(lk)and the matrixΘ(3.12)Θ=-1cosθkcosθjcosθk-1cosθicosθjcosθi-1and(3.13)D=0τ(i,j,k)τ(i,k,j)τ(j,i,k)0τ(j,k,i)τ(k,i,j)τ(k,j,i)0wheres(x)andτ(i,j,k)are defined ass(x)τ(i,j,k)E2x1/2(li2+εjrj2-εkrk2)H2sinhxcoshlicoshεjrj-coshεkrkS2sinxcoslicosεjrj-cosεkrkBy symbolic computation, it is straightforward to verify the symmetry of Eq. (3.9).□This section focuses on the geometric interpretation to Hessian matrix of the discrete Ricci energy on each face forE2,H2andS2cases. This gives the second proof of the symmetry Lemma 3.13.The interpretation in Euclidean case is due to Glickenstein [10] (He [44] in the case of circle packings) and illustrated in [5]. In the current work, we build the connection to the Power Delaunay triangulation and power voronoi diagram.We only focus on one triangle[vi,vj,vk], with corner anglesθi,θj,θk, conformal factorsui,uj,ukand edge lengthslijfor edge[vi,vj],ljkfor[vj,vk]andlkifor[vk,vi].As shown in Figs. 7 and 8, the power of q with respect toviispow(vi,q)=|vi-q|2-∊γi2.The power center o of the triangle satisfiespow(vi,o)=pow(vj,o)=pow(vk,o).The power circle C centered at o with radiusγ, whereγ=pow(vi,o).Therefore, for tangential, Thurton’s and inversive distance circle packing cases, the power circle is orthogonal to three circles at the verticesCi,CjandCk; for Yamabe flow case, the power circle is the circumcircle of the triangle; for virtual radius circle packing, the power circle is the equator of the sphere, which goes through three points{vi+γin,vj+γjn,vk+γkn}, wherenis the normal to the plane.Through the power center, we draw line perpendicular to three edges, the perpendicular feets arewi,wjandwkrespectively. The distance from the power center to the perpendicular feet arehi,hjandhkrespectively. Then it can be shown easily that(4.1)∂θi∂uj=∂θj∂ui=hklk,∂θj∂uk=∂θk∂uj=hili,∂θk∂ui=∂θi∂uk=hjlj,furthermore,(4.2)∂θi∂ui=-hklk-hjlj,∂θj∂uj=-hklk-hili,∂θk∂uk=-hili-hjlj.These two formula induces the formula for the Hessian of the Ricci energy of the whole surface. One can treat the circle packing(Σ,γ,η,ε)as a power triangulation, which has a dual power diagramΣ¯. Each edgeeij∈Σhas a dual edgee¯∈Σ¯, then(4.3)∂Ki∂uj=∂Kj∂ui=|e¯ij||eij|,and(4.4)∂Ki∂ui=-∑j∂Ki∂uj.This gives a geometric proof for the symmetry Lemma 3.13 in Euclidean case.Suppose on the edge[vi,vj], the distance fromvito the perpendicular footwkisdij, the distance fromvjtowkisdji, thenlij=dij+dji, and∂lij∂ui=dij,∂lij∂uj=dji,furthermoredij2+djk2+dki2=dik2+dkj2+dji2.This shows the power circle interpretation is equivalent to Glikenstain’s formulation.Let▵123be a hyperbolic triangle whose vertices are labeled by 1–3. Letr1,r2,r3be three positive numbers associated to the vertices, and∊1,∊2,∊3∈{-1,0,1}be indicators of the type of the vertices.For the mixed type of discrete conformal geometry, the edge length of▵123is given bycoshlk=4ηijsinhri(1-∊i)coshri+1+∊isinhrj(1-∊j)coshrj+1+∊j+cosh∊iricosh∊jrj,where{i,j,k}=1,2,3.Via the cosine law, the edge lengthsl1,l2,l3determine the anglesθ1,θ2,θ3.When∊1=∊2=∊3=0, this is the case of Yamabe flow. There is a circle passing through the three vertices of▵123. It is still called the power circle.When∊1=∊2=∊3=1, this is the case of inversive distance circle packing. Centered at each vertex i, there is a circle with radiusri. Then there is the power circle orthogonal to the three circles centered at the vertices.When∊1=∊2=∊3=-1, this is the case of virtual radius circle packing. Let▵123be on the equator plane of the ball model of the hyperbolic spaceH3. For each vertex i, letii′be the geodesic arc perpendicular to the equator plane with lengthri. Assume1′,2′,3′are above the equator plane. There is a hemisphere passing through1′,2′,3′and orthogonal to the equator plane. The power circle in this case is the intersection of the hemisphere and the equator plane.For a mix type, the power circle can still be defined.For any type, lethibe the distance from the center of the power circle to the edge ij whose length islk.Theorem 4.1Leteui=eri-1eri+1=tanhri2.Then∂θ1∂u2=∂θ2∂u1which equal totanhh3sinh2l32cosh∊1r1cosh∊2r2coshl3-cosh2∊1r1-cosh2∊2r2.This gives a geometric proof for the symmetry Lemma 3.13 in hyperbolic case.We only need to prove the theorem for the case of∊1=∊2=∊3=1. General case can be proved similarly.ProofStep 1. Denote the center of the power circle by o, the radius by r. Letx,y,zbe the distance from o to the vertices 1–3. Then(4.5)coshx=coshrcoshr1,coshy=coshrcoshr2,coshz=coshrcoshr3.Letαbe the angle∠13oandβthe angle∠23o. Thenα+β=θ3. Therefore(4.6)1+2cosαcosβcosθ3=cos2α+cos2β+cos2θ3.By the cosine law,cosα=-coshx+coshzcoshl2sinhzsinhl2,cosβ=-coshy+coshzcoshl1sinhzsinhl1,cosθ3=-coshl3+coshl1coshl2sinhl1sinhl2.Substituting the three formulas into the Eq. (4.6), we obtain a relation between the 6 numbersl1,l2,l3,x,y,z.Substituting the Eq. (4.5) into this relation, we obtain a relation betweenl1,l2,l3,r1,r2,r3and r.Solving for r, we getcosh2r=ND, whereN=1+2coshl1coshl2coshl3-cosh2l1-cosh2l2-cosh2l3,D=cosh2r1(1-cosh2l1)+2coshr2coshr3(coshl2coshl3-coshl1)+cosh2r2(1-cosh2l2)+2coshr3coshr1(coshl3coshl1-coshl2)+cosh2r3(1-cosh2l3)+2coshr1coshr2(coshl1coshl2-coshl3).Step 2. Sinceh3is the height of the triangle▵o12with bottom the edge 12. By the standard formula of height of a hyperbolic triangle, we havesinh2h3=1+2coshxcoshycoshl3-cosh2x-cosh2y-cosh2l3sinh2l3.After substituting the Eq. (4.5) into the above formula, we havetanh2h3=cosh2r(2coshr1coshr2coshl3-cosh2r1-cosh2r2)-sinh2l3cosh2r(2coshr1coshr2coshl3-cosh2r1-cosh2r2).After substituting the equationcosh2r=ND, we havetanh2h3=N(2coshr1coshr2coshl3-cosh2r1-cosh2r2)-Dsinh2l3N(2coshr1coshr2coshl3-cosh2r1-cosh2r2).After substituting the expressions ofNandDin step 1, we havetanh2h3=[(coshl1coshl3-coshl2)coshr1+(coshl2coshl3-coshl1)coshr2-sinh2l3coshr3]2N(2coshr1coshr2coshl3-cosh2r1-cosh2r2).Step 3. By direct calculation, we have∂θ1∂u2=∂θ2∂u1=-1sinθisinhljsinhlk(coshr3-coshl1coshl3-coshl2sinh2l3coshr1-coshl2coshl3-coshl1sinh2l3coshr2)=(coshl1coshl3-coshl2)coshr1+(coshl2coshl3-coshl1)coshr2-sinh2l3coshr3N·sinh2l3.Comparing with the last formula of step 2, we have∂θ1∂u2=∂θ2∂u1=tanhh3sinh2l32coshr1coshr2coshl3-cosh2r1-cosh2r2.□According to a general principle of the relation of hyperbolic geometry and spherical geometry, to obtain a formula in spherical geometry, we only need to replacesinhandcoshin hyperbolic geometry by-1sinandcos.For the mixed type of discrete conformal geometry with spherical background geometry, the edge length of▵123is given bycoshlij=-4ηijsinri(1-∊i)cosri+1+∊isinrj(1-∊j)cosrj+1+∊j+cos∊iricos∊jrj.Via the cosine law, the edge lengthsl1,l2,l3determine the anglesθ1,θ2,θ3.We can define power circles similarly. Lethibe the distance from the center of the power circle to the edge ij whose length islk.Theorem 4.3Leteui=tanri2.Then∂θ1∂u2=∂θ2∂u1which equal totanh3sin2l3-2cos∊1r1cos∊2r2cosl3+cos2∊1r1+cos2∊2r2.This gives a geometric proof for the symmetry Lemma 3.13 in spherical case.This theorem is also proved by using the general principle: replacesinhandcoshin hyperbolic geometry by-1sinandcos.Here we can give the second proof for the symmetry Lemma 3.13 based on the geometric interpretation to the Hessian, which is geometric and intuitive.ProofFormula (4.1) show the symmetry for all schemes with Euclidean background geometry; Theorem 4.1 proves the symmetry for the hyperbolic cases; Theorem 4.3 for the spherical cases.□The geometric interpretation to Ricci energies of Euclidean and hyperbolic Yamabe schemes were discovered by Bobenko et al. in [11]. The interpretation to Ricci energies of Euclidean schemes (without the mixed type) are illustrated in [5]. In the current work, we generalize the geometric interpretations to all the schemes in all background geometries covered by the unified framework, as shown in Fig. 13.We use the upper half space model forH3, with Riemannian metricds2=dx2+dy2+dz2z2the xy-plane is the ideal boundary. Consider a triangle[vi,vj,vk], its Ricci energy is closely related to the volume of a generalized hyperbolic tetrahedron whose vertices can be inH3, truncated by a horosphere or truncated by a hyperbolic plane.In Fig. 9, the generalized hyperbolic tetrahedron has 4 verticesw0,wi,wj,wk. The tetrahedron vertexw0is called the top vertex. The 4 faces of the tetrahedron are hyperbolic planes, the 6 edges are geodesics. The 6 edge lengths of the generalized tetrahedron are-ui,-uj,-ukandλij,λjk,λki. The generalized tetrahedron is uniquely determined by these 6 edge lengths.The followings are the common principles for constructing the generalized tetrahedron for all the schemes,1.For allE2schemes, the top vertexw0is ideal (at infinity) and truncated by a horosphere; for allH2schemes, the top vertex is hyperideal (exceeding the boundary ofH3) and truncated by a hyperbolic plane; for allS2schemes, the top vertex is inH3.Forwi, if the corresponding vertexviis of inversive distance circle packingεi=+1, then it is hyperideal and truncated by a hyperbolic plane; ifviis of Yamabe flowεi=0, then it is ideal and truncated by a horosphere; ifviis virtual radius circle packingε1=-1, then it is inH3. Same results holds forwjandwk.The edges on the truncated tetrahedron, connecting to the top vertex on the original tetrahedron, have lengths-ui,-ujand-ukrespectively.For the edge lengthsλij, there is a unified formula for three geometries: Euclidean, hyperbolic, spherical,(5.1)ηij=12eλij+εiεje-λij.The triangle associated to the top vertexw0is the triangle[vi,vj,vk]. It is obtained by truncating by a horosphere, truncating by a hyperbolic plane or intersecting with a sphere. Given-ui,-uj,-uk,ηij,ηjk,ηki, using cosine law, we can calculate the edge lengths of the triangle[vi,vj,vk]. They are exactly given by the formula Eq. (3.3). That means the triangle[vi,vj,vk]has lengthslij,ljk,lkiand anglesθi,θj,θk.Here we can give the third proof for the symmetry lemma based on the geometric interpretation to the Ricci energy, which is more geometric, intuitive and much easier to verify.ProofAs shown in Fig. 9, for a generalized hyperbolic tetrahedron, the four vertices can have any types. The three vertical edges have lengths-ui,-uj,-ukwith dihedral anglesθi,θj,θk. The bottom edges have lengthsλij,λjk,λkiwith dihedral anglesβij,βjk,βki.Let V be the volume of the generalized hyperbolic tetrahedron. By Schläfli formula(5.2)dV=-12-uidθi-ujdθj-ukdθk+λijdβij+λjkdβjk+λkidβkiDuring the Ricci flow, the conformal structure coefficientsηij,ηjk,ηkiare invariant, soλij,λjk,λkiare fixed. Because the generalized tetrahedron is determined by the edge lengths-ui,-uj,-uk,λij,λjk,λki, during the flow, all dihedral anglesθi,θj,θk,βij,βjk,βkiare functions ofui,uj,uk, the volume V is also the function ofui,uj,uk.Consider the function,(5.3)W(ui,uj,uk)=uiθi+ujθj+ukθk-λijβij-λjkβjk-λkiβki-2Vhence,dW=θidui+θjduj+θkduk+uidθi+ujdθj+ukdθk-λijdβij-λjkdβjk-λkidθki-2dVsubstitute Schläfli formula Eq. (5.2), we havedW=θidui+θjduj+θkdukthereforeW=∫θidui+θjduj+θkduk+c.W in fact, is the discrete Ricci energy on face in Eq. (3.5). This shows the differential 1-form(5.4)θidui+θjduj+θkdukis exact, therefore closed. Namely, the Hessian matrix∂(θi,θj,θk)∂(ui,uj,uk)is symmetric.□The formula Eq. (5.3) represents the Ricci energy on a face as the volume of the generalized hyperbolic tetrahedron with other terms of conformal factors and conformal structure coefficients. This formula was introduced first by Bobenko et al. in [11] for Euclidean and hyperbolic Yamabe flow. In the current work, we generalize it to all 18 schemes. The differential in Eq. (5.4) is independent of the choice of horospheres, since the Schläfli formula is independent of the choice of horospher for an ideal vertex.

@&#CONCLUSIONS@&#
