@&#MAIN-TITLE@&#
Using evolutionary algorithms to determine the residual stress profile across welds of age-hardenable aluminum alloys

@&#HIGHLIGHTS@&#
A method to calculate the residual stress state of an age-hardenable aluminum alloy.The application of an evolutionary algorithm solves a problem not previously addressed.The process is robust allowing solving for different constraints of the material.Evolutionary computation allows us to reach to realistic solutions.

@&#KEYPHRASES@&#
Multi-objective evolutionary algorithm,Real world application,Residual stress determination,

@&#ABSTRACT@&#
This paper presents an evolutionary based method to obtain the un-stressed lattice spacing, d0, required to calculate the residual stress profile across a weld of an age-hardenable aluminum alloy, AA2024. Due to the age-hardening nature of this alloy, the d0 value depends on the heat treatment. In the case of welds, the heat treatment imposed by the welding operation differs significantly depending on the distance to the center of the joint. This implies that a variation of d0 across the weld is expected, a circumstances which limits the possibilities of conventional analytical methods to determine the required d0 profile. The interest of the paper is, therefore, two-fold: First, to demonstrate that the application of an evolutionary algorithm solves a problem not addressed in the literature such as the determination of the required data to calculate the residual stress state across a weld. Second, to show the robustness of the approximation used, which allows obtaining solutions for different constraints of the problem. Our results confirm the capacity of evolutionary computation to reach realistic solutions under three different scenarios of the initial conditions and the available experimental data.

@&#INTRODUCTION@&#
Aluminium Alloys (AA) are used in a plethora of industrial processes. For example, alloys of the AA2xxx series are commonly used in aircraft structures. In many applications, AAs need to be welded, a process which is difficult to control using common fusion welding techniques in comparison to other metals, such as steels. This is due in part to the high thermal conductivity of aluminum. As an alternative to conventional methods, Friction Stir Welding (FSW) [1,2] has proven to solve most of the difficulties associated with the joining of aluminum alloys [3–5].However, the development of a Residual Stress (RS) is, as in other welding procedures, inherent to this joining operation. In FSW the existence of a RS is mainly due to the non-homogeneous nature of the severe plastic deformation phenomenon involved and the heat generated during the welding process. The FSW process also involves significant changes in the microstructure and the mechanical properties of the material. There are various methods for determining residual stresses in a component. We can use destructive techniques, such as “hole drilling”, sectioning or indentation, and nondestructive techniques, such as those based on X-ray and neutron diffraction [6]. These diffraction techniques use the lattice spacing as an atomic probe to measure elastic deformations. By comparing the lattice spacing in the stressed and un-stressed condition, one can determine, first, the elastic deformation and, then, the associated stress using well established linear elasticity theory equations and tabulated elastic constants. One of the advantages of the diffraction techniques is that the full triaxial stress state inside a component can be investigated if one takes advantage of the high penetrating capacity of neutrons and (hard) X-rays [7,8].As it will be shown, the crucial factor to determine the RS state by these methods is the availability of a reliable un-stressed lattice spacing value, d0. When a unique constant, d0 value is sought, conventional analytical procedures can be applied to determine the residual stress state. For the case of age-hardening AA2xxx series alloys, however, d0 is strongly dependent on the amount of atoms in solid solution (such as copper atoms) and, in turn, on the heat treatment imposed to the component. If the heat treatment is uniform through the sample, a constant d0 is expected, and the RS calculation is straightforward. But for the case of welds the heat treatment varies dramatically across the weld and, as a consequence, a variation of d0 should be taken into account. For these cases, conventional analytical procedures are no longer applicable [9,10].Recently, evolutionary algorithms (EAs) have been applied for solving optimization, modeling and identification problems [11–14]. The present investigation addresses the capacity and robustness of EAs to solve the above difficulty. Several scenarios, depending on the initial constraints imposed by the experimental data available from neutron diffraction experiment, are discussed. Specifically, the un-stressed lattice spacing variation under the three scenarios and the resulting RS profile across the weld are obtained. The use of EAs, applied to current used methods to determine residual stress fields, is very appropriate when d0 value is not constant. We solve this optimization problem using a Multi-Objective Evolutionary Algorithm (MOEA). The nature of the problem, where the values for a set of parameters have to be found, allows for a direct encoding of these parameters within a chromosome as in other problems [15]. In summary, the motivation of this research relies on the need of alternative methods to conventional analytical ones in order to find the required information (in this case, the d0 values) to calculate the residual stress profile across welds of age-hardening Al alloys.We have found that the experimental results are metallurgically consistent, allowing the characterization of the residual stress state of the weld.The main contributions of the present work are the following:•We present a method for obtaining the distribution of d0 parameter, based on a MOEA, under different measurement scenarios.We use for the first time the capacity of EAs to calculate the residual stress across a weld of 2024 alloy using neutron diffraction data of the lattice spacing variations.We analyze the robustness of the proposed MOEA.The rest of the paper is organized as follows. A description of the problem is made in Section 2. Section 3 describes the metallurgical experimental details. Section 4 gives the details of the evolutionary algorithm implementation. Section5 presents the experimental results in terms of both the metallurgical solution and the convergence and robustness of the evolutionary approach. Finally, Section 6 summarizes the conclusions of this work.Any forming process used in the industry (rolling, extrusion, welding, deep drawing, etc.) for the fabrication of components leads to the development of a RS which extends over the resulting component. This is because, generally, these procedures are non-homogeneous in nature and the development of a RS is inherent to non-homogeneous dimensional changes of bodies (due to deformation, thermal effects, or both). Because this RS varies throughout the whole piece, it is usually referred to as a macroscopic stress, M-RS, to distinguish it from the microscopic stresses, m-RS, inherent to the material microstructure [16]. Understanding the development of M-RSs and their magnitude is of great importance in structural engineering because it is a key factor in the design of structural components. Disregarding this stress may be critical and the cause of component rupture at stress levels below that at which failure would be expected from the applied stresses alone. As mentioned above, several techniques have been developed in the past decades aimed at determining this stress.Probably, the most successful ones among them are those which make use of the diffraction phenomenon. Given the crystallographic nature of most engineering materials (metals), diffraction allows determining with high precision, lattice spacing values, dhkl. In this way, an expansion or contraction of the given lattice spacing is identified with an elastic strain and, associated to it through the linear elasticity theory, the corresponding internal stress. Determining this expansion/contraction of the lattice spacing with respect to a relaxed value,dhkl0, is, hence, the core of the diffraction methods to calculate internal (and residual) stresses in structural materials and components. The use of diffraction methods implies the use of Bragg's law,(1)2·dhkl·sin(θ)=λwhere θ is the Bragg's angle and λ the wavelength of the incident beam. Bragg's law allows determining dhklfor different spatial directions. Then, by using the formula,(2)ϵ=dhkl−dhkl0dhkl0the elastic strain, ϵ, can be calculated in the same way as macroscopic strains are obtained in conventional mechanical testing with the help of a suitable extensometer. Then, direct use of the generalized Hookes law of elasticity, namely,(3)σi=E(1+ν)·(1−2ν)·[(1−ν)ϵi+ν(ϵj+ϵk)]where σiis the i component of the stress tensor, related to the three strain components, ϵi, ϵjandϵk, E the elastic modulus, and ν the Poisson's ratio provides the stress state of the component under study.Formerly, when only standard laboratory X-rays were available, determining the residual stress in components was limited to the near surface region where a bi-axial stress state should be assumed. Under this approximation, the extra calculation of an un-stressed spacing value is not needed since it can be obtained from the fact that the normal stress component is null.More recently, however, the availability of high penetration capacity of neutrons and synchrotron X-rays has allowed calculating the full tri-axial residual stress state inside materials. In these cases, the extra calculation of an un-stressed lattice spacing value is required. In fact, it is very likely that the most critical issue and a key factor for the determination of this M-RS is, precisely, the availability of an accurate and reliable value ofdhkl0. This is because small fluctuations or experimental errors in this parameter (and of dhklitself) can lead to huge variations of the calculated strain and the resulting stress. For example, a variation of some few 10−14m (or 10−3Å) in the value ofdhkl0, say 2×10−14m, can lead to a variation of the stress in the order of 10MPa for the case of aluminum alloys. This variation increases with an increase of materials stiffness, e.g., titanium or steels. As a consequence, the development of reliable methods to determinedhkl0has been the subject of many efforts. A detailed description of these methods can be found in [17,18]. Here, a brief description of the main ones namely, the powder method, the sample sectioning method, and the use of the equilibrium conditions is given.Powder of the same material under study guarantees a macroscopic un-stressed reference since powder is always free of long range stresses. Furthermore, powder is susceptible to undergo a heat treatment if necessary: it is known that the lattice spacing can be strongly affected by the amount of solid solution elements and, hence, of the precipitation state. This is the case of some age-hardening aluminum alloys. These aluminum alloys, such as those of the 2xxx and 7xxx series, widely employed in the aeronautical an aerospace industries, have the particularity that their mechanical properties are strongly dependent on the thermal history, i.e., their precipitation state. Hence, if powder is to be used as reference fordhkl0determination in components fabricated from one of these alloys, one must be sure that the heat treatment undergone by the alloy powder is the same as that of the component under study. This task is, however, virtually impossible in some cases, for example in welds, where the specific thermal cycle imposed during this process is not known. Furthermore, it may change dramatically across the weld. This implies that the powder method cannot be recommended as a way to determinedhkl0in complex cases such as in welds of age hardening alloys.In the same manner as powder particles do not hold a M-RS, a sample that is cut into small pieces relieves its M-RS. In this way, one can section the sample (or a twin replica if it is not possible to section the sample) such that the size of the pieces is smaller than the expected residual stress variation: The larger the stress gradient or the shorter its range, the smaller the piece dimension to ensure stress relaxation. The use of these small pieces, cut from different parts of the sample, allows determining the specificdhkl0value at the corresponding sample position and avoids errors associated with compositional changes or precipitation variations resulting from possible heat treatments. When large number of pieces are required, as in the case of welds, they can be organized by using “comb” samples. These are samples where the different stress relaxed pieces are maintained together and, hence, “recall” their specific coordinates with respect to those in the original component from which the comb was extracted. Furthermore the exact thermal cycle undergone at each “tooth” in the case of a weld, is kept. This guarantees, in principle, that a reliabledhkl0at each location is available regardless that this un-stressed lattice spacing varies through the component.There are, however, several limitations to the comb method. First one is the procedure itself. Since the comb must be machined out for thedhkl0measurements (after conducting the measurements on the stressed sample), two rounds of neutron diffraction measurements must be carried out in separate experiments. This implies different configuration of the instrument in the two experiments, which can affect the positions of the diffracted peaks appreciably. To avoid this, it is common to extract a comb piece from the sample under study, so that both the sample and the comb can be studied in the frame of the same round of measurements using the same experimental set up [19]. In this case, however, an alteration of the RS state to be studied may occur.Instead, one can prepare two welds such that a similar RS state results in both cases: one of the welds would be used to measure the lattice spacing across the weld and the second one to extract the comb sample. Both the weld and the comb could be measured during the same experiment. Even in this case it is possible that the precipitation and solid solution state differ from one weld to the other. As reported in [20], very small variations in Cu contents greatly modify the lattice spacing of aluminum. Since it is unlikely that the temperature cycle undergone in both welds is identical (due, for example, to a slight difference in the temperature of the backing plate), the possibility to obtain the same microstructural gradient across the weld in both experiments is minimal. This makes the use of a reference comb extracted from a replica weld risky, even when the welding parameters are ostensibly the same.A not sufficiently exploited method which avoids the extra experimental work required by the above two methods to determinedhkl0employs a fully mathematical procedure which makes use of well known principles of Mechanics: These principles are the equilibrium conditions of stresses and bending moments [21,22]. According to these principles, the total force perpendicular to any sample section of a solid and the total bending moment of the in-section forces must be null. They are mathematically expressed as:(4)∫σ⊥dS=0where subindex ⊥ refers to the normal stress component to section S and for the bending moments, M,(5)∫SMdS=0The use of this method avoids, as mentioned, the tediousness and inaccuracies associated with the handling of powders or sample sectioning to obtain an experimentaldhkl0value. On the contrary, it requires many measurements of dhklat different locations on selected sample sections to apply Eqs. (4) and (5) with rigor. In this manner, an analytical solution can be obtained as long asdhkl0remains constant throughout the measured section. However, as we mentioned above, this is not true in many real cases, such as in welds of age hardenable aluminum alloys, where a measurable variation ofdhkl0across the weld is expected. Such a problem cannot be solved analytically by using Eqs. (4) and (5) due to the large number of variables involved. For cases like this, EAs have proven their capacity to arrive to satisfactory solutions [23,24]. In a recent paper [25], an EA has been used to deduce the M-RS profile across a weld conducted between two 10mm thick plates of AA2024 aluminum alloy, a typical aerospace aluminum alloy with elevated mechanical properties. In the present research a detailed description of the EA used to determine thedhkl0profile on the basis of neutron diffraction data and in the context of the equilibrium conditions method is made. Furthermore, the results obtained by the EA under three different scenarios or approximations of the possibledhkl0, according to the different microstructural zones of the weld, are presented.The aluminum alloy investigated, AA2024, is a typical aerospace alloy also used in other applications. It contains Cu atoms as the main alloying element. Cu atoms combine with Al ones leading to precipitates which, under appropriate heat treatments, are semi-coherent with the aluminum lattice. In fact, the strong precipitate-dislocation interaction is the final responsible of the excellent mechanical properties of the alloy. Further information of this alloy, the welding procedure used, the metallographical preparation employed to study the different parts of the weld and the details of the experimental set-up for the neutron diffraction measurements are described in [25]. Here, a brief description of these methods is reported.The two plates of the alloy, of dimensions 10×296×150mm3, were butt welded using the PDS-4 Intelligent Stir FSW machine of the AIMEN Technology Center at Porriño, Spain (http://www.aimen.es/). The RS state across the weld was investigated by measuring, first, the lattice spacing of the 311 planes, d311, using neutron diffraction and applying the Braggs law, Eq. (1). Fig. 1shows the geometry of the welded plate mounted on SALSA diffractometer at the ILL (Institute Laue-Langevin) for the neutron diffraction measurements. In Fig. 2the geometry of the diffraction phenomenon is shown (incident and diffracted beams and the gauge volume generated, where the lattice spacing in the sample is measured).These measurements were made at three different depths of the plate: −2.5, −5 and −7.5mm from the top surface, denoted hereafter as Front, Center and Back zones, respectively. The distance across the weld covered by the measurements extended up to ±85mm on both sides from the center of the weld. In this way, all regions of the weld, namely the nugget, the thermomechanically affected zone (TMAZ), the heat-affected zone (HAZ), and the base material (BM), were covered by the neutron diffraction measurements. Fig. 3is a scheme of the plate showing the section across the weld where the neutron diffraction measurements were conducted at the three depths (marked as dotted lines in the section).After the neutron diffraction measurements, conventional metallographic procedures were used to examine the microstructure of the different regions by optical microscopy after sectioning the welded plate suitability. Finally, hardness measurements were conducted on the cross-section to evaluate the mechanical properties of the different regions across the weld: nugget, TMAZ, HAZ and BM. These measurements were also useful to determine the dimensions of the different regions. The measurements were conducted using a Micromaterials™ nanotest 600 instrumented indenter. Constant displacement mode was used to complete a profile located at the central region, through-the-thickness, along the transverse section of the plate. A 5μm depth indentation, maintaining 1mm distance between successive indentations, was used. In this way, a hardness profile covering a total distance of 120mm was obtained.As stated in Section 2.3, we look for a combination ofdhkl0values across the weld, or adhkl0profile, that minimizes both, the sum of the longitudinal stresses and the bending moments in a transverse section, S, of the welded plate (Eqs. (4) and (5)). Thus, we are dealing with a bi-objective problem. Under these conditions, we have selected NSGA-II (Non-dominated Sorting Genetic Algorithm II), a well-known MOEA, to solve this problem [26]. In a nutshell, NSGA-II is a fast and elitist MOEA based on a non-dominated sorting approach. NSGA-II is an evolution of NSGA which obtains very good results solving problems with up to three objectives [27,28].Besides the algorithm, solving a problem under an evolutionary approach requires additional elements. The first one is the definition of a fitness function, which establishes the quality of the candidate solutions in relation to a given objective of the problem. The fitness function guides the search across the space of solutions. Second, a codification of the candidate solutions (also called individuals) must be defined. The codification consists on selecting how each individual is represented into the algorithm. Finally, given that we use a genetic algorithm, the genetic operators must be selected and configured.Given a set of z zones in section S of the welded plate and a set of measurements of d311 for each one of the z zones, we can define the matrix D as:D=d311Front[0]d311Front[1]⋯d311Front[z−1]d311Front[z]d311Center[0]d311Center[1]⋯d311Center[z−1]d311Center[z]d311Back[0]d311Back[1]⋯d311Back[z−1]d311Back[z]whered311Front[i],d311Center[i],d311Back[i]is the d311 measurement on zone i resulting from the neutron diffraction experiment.The objective is to find a set ofdi0Ljacross the weld, which minimizes F1 and F2 simultaneously, where(6)F1=TLFront+TLCenter+TLBack(7)F2=MFront+MBackwhere T and M denote stress and bending moment, respectively, subindexes Front, Center, and Back, the corresponding region in section S, and subindex L longitudinal stress. F2 can be also expressed in terms ofTNFrontandTNBack. Since MFront and MBack are the bending moments at a distance f of the neutral line11The neutral line is the position of the Center, and f is the Front-Center distance, which is the same as that of the Center-Back distance., and considering that(8)MFront=TNFront·f(9)MBack=TNBack·(−f)we can express Eq. (7) as:(10)F2=TFront·f−TBack·for(11)F2=TNFront−TNBacksince f affects both terms of the right side in Eq. (10). The T values are given by Eqs. (12)–(16).(12)TFront=∑i=0z(C1+C2)·d311Front[i]−di0LFrontdi0LFront+C2·d311Center[i]−di0LFrontdi0LFront+d311Back[i]−di0LFrontdi0LFront(13)TCenter=∑i=0z(C1+C2)·d311Center[i]−di0LCenterdi0LCenter+C2·d311Front[i]−di0LCenterdi0LCenter+d311Back[i]−di0LCenterdi0LCenter(14)TBack=∑i=0z(C1+C2)·d311Back[i]−di0LBackdi0LBack+C2·d311Center[i]−di0LBackdi0LBack+d311Front[i]−di0LBackdi0LBackC1 and C2 being derived from Eqs. (15) and (16), which are functions of the elastic modulus, E (7200 for aluminum) and the Poissons ratio, ν (0.33 for aluminum):(15)C1=E(1+ν)(16)C2=E·(1−2ν)(1+ν)·(1−2ν)As it will be explained in Section 4.4, we will study three different scenarios depending on the data available. Nevertheless, we will use the same codification for all three cases since the unique difference is the number of parameters that describe each scenario. Using the smallest distance between measurement points, the whole transverse section of the welded plate was divided into a number of zones. Depending on the number of zones, we will be on a different scenario.Each zone is specified by three parameters, corresponding to the three depths (Front, Center and Back), and the three components of the stress (L, N and T). Although we need to identify nine parameters, it was assumed that no anisotropic effect on the d0 value exists, i.e. the same d0 value must result irrespective of the sample direction or:(17)d3110LFront=d3110TFront=d3110NFront(18)d3110LCenter=d3110TCenter=d3110NCenter(19)d3110LBack=d3110TBack=d3110NBackFrom the data of neutron diffraction we know thatdzonei0must lie between two limits,1.22·10−15<dzonei0<1.23·10−15In order to limit the number of possible solutions we have restricted the number of decimals used to express the values ofd0i·10−15to five digits. This limit also fits with the precision of our measures. So we look for values ofd0ithat verify the following condition:1.22000·10−15<dzonei0<1.22999·10−15Now the encoding of the individuals is direct. A chromosome is composed by 3·z genes. The first three values of the chomosome represent the parameters for the first zone, i.e.dzone00LFront,dzone00LCenteranddzone00LBack, the next three the parameters for the second one, and so on. In order to decode the actual value ofdzonei0from an individual, we use Eq. (20):(20)dzonei0=(1.22+gene*10−5)*10−15For example, if we assume that we have measureddzonei0LFront,dzonei0LCenteranddzonei0LBackin five zones, we will have 0≤i≤4. Thus, we will represent a solution by 15 genes (5 for Center, 5 for Front and 5 for Back), or fifteendi0Ljvalues, corresponding to 0≤i≤4 and jϵ{Front, Center, Back}. Table 1shows, as an example, the decoding of individual:22−189−123−132−23−23−14−111−122−230−230−230−39−36−45In order to avoid the random bias, we have executed 30 runs of the NSGA-II evolutionary algorithm for each scenario. The genetic operators configuration that we have considered for all runs is the following:•Initial population: randomly generated.Population size: 1000 individuals.Stop criterion: 10,000 as maximum number of generations.Mutation probability: 0.1.Crossover probability: 0.8.Selection: tournament of two individuals.The following are the three possible scenarios considered in the present research. In each one, a potential space of solutions is considered depending on the microstructure of the weld and the different microstructural zones in section S.A first case considers the least restrictive condition for potentialdhkl0values across the weld. In this case, the possibledhkl0values are “selected” by the evolutionary algorithm from the absolute maximum and minimum d values measured in the neutron diffraction experiment. Then, we have to let the EA search into the whole space, seeking for a solution which meets the equilibrium of stresses, i.e. which minimizes F1. In this case a single objective approach is considered.An improved scenario considers the application of Eq. (7) considering every individual measurement position across the transverse section. In this case, it is not needed to determine the dimensions of the microstructural zones. We have 181 homogeneously distributed measurements. In this situation it is possible to establish the maximum and minimum values ofdhkl0for every of these locations as individual limits for thedi0Ljparameter in each location. This allows us reducing the size of the searching space and thus, to make a faster and more effective search.In this case we will consider two possibilities. The first one is Scenario 3a, in which the dimensions of the different microstructural zones in the transverse section, from the weld to the base material, are known. In this situation it is possible to fix precisely, the maximum and minimum d values for every specific microstructural zone. This allows us to reduce the size of the search space and thus, to make an even faster and more effective search. From theoretical considerations of the balance, it is known that the values ofdi0Ljshould be between the maximum and minimum values of the lattice spacing, d311.The second case, Scenario 3b, is an upgraded version of Scenario 3a. Here, the value ofdhkl0in the base material is also known. This single value can be calculated experimentally from measurements conducted on longitudinal sections of the base material plate (perpendicular to the transverse section). Here, the welded region is, thus, avoided.

@&#CONCLUSIONS@&#
