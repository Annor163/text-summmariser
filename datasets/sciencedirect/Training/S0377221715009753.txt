@&#MAIN-TITLE@&#
Two-stage network processes with shared resources and resources recovered from undesirable outputs

@&#HIGHLIGHTS@&#
We measure the efficiency of two-stage system with shared and reused resource.We introduce additive and non-cooperative efficiency measures to this system.A heuristic algorithm is suggested to transform nonlinear model into a linear one.We prove the heuristic algorithm to be a good and effective approach.The new approaches are applied to industrial production processes of China.

@&#KEYPHRASES@&#
Data envelopment analysis,Two-stage processes,Undesirable output,Shared resources,Non-cooperative,

@&#ABSTRACT@&#
Data envelopment analysis (DEA) is an approach for measuring the performance of a set of homogeneous decision making units (DMUs). Recently, DEA has been extended to processes with two stages. Two-stage processes usually have undesirable intermediate outputs, which are normally considered be unrecoverable final outputs. In many real situations like industrial production however, many first-stage waste products can be immediately used or processed in the second stage to produce new resources which can be fed back immediately to the first stage. The objective of this paper is to provide an approach for analyzing the reuse of undesirable intermediate outputs in a two-stage production process with a shared resource. Shared resources are input resources that not only are used by both the first and second stages but also have the property that the proportion used by each stage cannot be conveniently split up and allocated to the operations of the two stages. Additive efficiency measures and non-cooperative efficiency measures are proposed to illustrate the overall efficiency of each DMU and respective efficiency of each sub-DMU. In the non-cooperative framework, a heuristic algorithm is suggested to transform the nonlinear model into a parametric linear one. A real case of industrial production processes of 30 provincial level regions in mainland China in 2010 was analyzed to verify the applicability of the proposed approaches.

@&#INTRODUCTION@&#
Developed by Charnes, Cooper, and Rhodes (1978), data envelopment analysis (DEA) is a non-parametric mathematical approach, which is used to evaluate the relative performance or efficiency of a group of homogenous decision making units (DMUs), especially those with multiple inputs and multiple outputs (Cook, Liang, Zha, & Zhu, 2009; Cooper, Seiford, & Tone, 2007; Liang, Wu, Cook, & Zhu, 2008; Thanassoulis, Kortelainen, Johnes, & Johnes, 2011; Wu & Liang, 2010). In conventional DEA approaches, all DMUs are treated as black boxes and the internal structure is always ignored (Lewis & Sexton, 2004). Recently, a number of research projects have studied DMUs that have a two-stage network structure with intermediate products existing between the two stages.For example, Seiford and Zhu (1999) measured the profitability and marketability of US commercial banks based on a two-stage process. In their paper, the first stage is called the profitability process, which uses inputs of labor and assets to produce outputs of profits and revenue. Those first stage outputs are then used as second stage input resources to output market value, returns, and earnings per share. Zhu (2000) applied the same two-stage processes to Fortune Global 500 companies. Kao and Hwang (2008) studied the efficiency of 24 insurance companies based on a two-stage process where operating and insurance expenses are used to generate premiums in the first stage, and then the underwriting and investment profits are produced in second stage by using the intermediate premiums as a resource. The same two-stage process has been applied in other contexts (An, Yan, Wu, & Liang, 2015; Chen & Zhu, 2004; Chen, Liang, Yang, & Zhu, 2006; Sexton & Lewis, 2003; and many others). All of the above examples, however, use the assumption that the intermediate products are the only inputs to the second stage, i.e., there are no additional independent inputs to that stage. There are, of course, other types of two-stage processes where the second stage has other inputs in addition to those produced by the first stage. For example, Liang, Yang, Cook, and Zhu (2006) use a two-stage process to measure the performance of supply chains with two members. The second stage uses as input not only the first-stage outputs, but also its own additional inputs. Li, Chen, Liang, and Xie (2012) applied this two-stage process to a case of regional research and development in China. In the second stage of the technology market, the inputs include the contract value (CV), a resource not used by the first stage. More detailed reviews of two-stage network structures can be seen in Cook, Liang, and Zhu (2010) and Halkos, Tzeremes, and Kourtzidis (2014).In this paper, we generalize an innovative two-stage network process to account for those settings where some outputs from the first stage are undesirable and may be processed in the second stage to obtain some desirable resources. These desirable resources are immediately fed back into the first stage process as inputs. We assume that the undesirable products of the first stage flow continuously to the second stage as inputs and that the second stage continuously sends its recycled products to the first stage as inputs. This means that the two stages run concurrently and feed each other, as can happen when the two are integrated in the same company. The second stage can be regarded as the purification or recycling of undesirable products (or parts of the undesirable products). Sometimes this processing is called disposal of the undesirable products but it should be noted that in our model “disposal” includes changing some or all of the undesirable products into desirable resources. An example of reusing the undesirable products would be melting down a malformed metal object to reuse the metal. Other examples include selling “factory seconds” (marred but functional products) to get income and taking good components out of bad products to build up supplies for later use in repairs. In our two-stage process, there also exist some shared inputs. Fig. 1shows the framework of this type of process.For further visualization of these concepts in a practical setting, we may consider the mode of circular economy (CE). Proposed by Pearce and Turner (1990), the mode of CE involves transforming the traditional “resource-products-pollutions” mode into “resources-products-regenerated resources” mode, which means turning wastes at one point in a value chain into inputs at another point. CE realized a closed loop of resource and energy flows in economic systems (Mathews & Tan, 2011). In recent literature, Yang and Feng (2008) provided a detailed case study on a circular enterprise, namely Nanning Sugar Co., Ltd., to show the successful transition and their essential impact factors. Hu et al. (2011) discussed the ecological utilization of leather tannery waste in the leather industry. Some CE progress in Dalian has been reviewed by Geng, Zhu, Doberstein, and Fujita (2009) as a regional level example. Finally, Wu, Shi, Xia, and Zhu (2014) indicated that CE framework contained three sub-systems, namely the resource saving and pollutant reducing (RSPR) subsystem, the waste reusing and resource recycling (WRRR) subsystem, and the pollution controlling and waste disposing (PCWD) subsystem. In the WRRR subsystem, some waste such as industrial waste water and solid waste are reused by the production stage process after processing in a disposal stage. Some of the disposal stage's input resources, like labor, are also used in the production stage process, which makes them shared resources in our model.There are some DEA studies of undesirable outputs in two stage frameworks. Lozano and Gutiérrez (2011) proposed a distance approach to deal with network DEA problems in which undesirable outputs are generated. The distance approach was applied to the problem of modeling and benchmarking airport operations. Fukuyama and Weber (2010) considered undesirable outputs for evaluation of bank efficiency in a two-stage series system. Maghbouli, Amirteimoori, & Kordrostami, 2014 proposed a network DEA approach with undesirable intermediate products. In their paper, the undesirable intermediate products are studied either as final outputs or as intermediate outputs used as inputs to the next stage. Song, Wang, and Liu (2014) carried out a systematic study of the SBM model considering undesirable outputs and further expanded the SBM model from the perspective of two-stage networks. Wang, Huang, Wu, and Liu (2014) studied the efficiency of the Chinese commercial banking system in a two-stage network with undesirable non-performing loans.Recently, some further studies of two-stage network processes have begun to involve shared resource flows. The shared resource flow in many production scenarios is defined as the resources which can be shared among different departments. Chen, Du, David Sherman, and Zhu (2010) indicated that in many real world cases, some inputs are actually shared by the two stages and it is impractical to determine the proportion used by each stage. For example, different departments of a university may share equipment and general expenditures (Beasley, 1995). As previously mentioned in Seiford and Zhu (1999), we point out that labor and assets are actually shared inputs for both stages i.e., both stages use the labor and asserts of the bank, and many of these inputs cannot be separated into the elements that are directly used for generating profits and revenues, in contrast to generating market value, returns, and earnings per share. Shared flows have been studied in the DEA literature. For example, Cook and Hababou (2001) developed DEA models to consider shared inputs. However, their models do not take into account the sharing proportions of shared inputs and two-stage network structures. Chen et al. (2010) developed DEA models for measuring the additive efficiency of two-stage processes with shared inputs that cannot be split. Chen's model considered only additive efficiency. Zha and Liang (2010) offered an approach for studying shared flows in a two-stage production process in series. Their approach is based on the assumption that shared inputs can be freely allocated among the different stages. Amirteimoori (2013) divided the shared flows into perfect and imperfect outputs by DEA in a two-stage decision process. Yu and Shi (2014) proposed a two-stage DEA model with additional inputs in the second stage and some of the intermediate products as final output. However, the above three papers all assumed uniform proportions of shared inputs for all DMUs when evaluating the efficiency of a DMU. Wu, Zhu, Chu, Liu, and Liang (2015) set different proportions of each shared resource for different DMUs to evaluate the efficiency of a parallel transportation system.In the existing literature, we have found no paper that discusses the phenomenon of the undesirable intermediate outputs being processed into desirable resources for the first stage, and in fact even shared resources have not been studied in this two-stage structure. Murty, Russell, and Levkoff (2012) formulated DEA specifications of pollution-generating technologies that are a composition of two technologies: an intended-production technology and a residual-generation technology. Their pollution-generating technologies have considered the pollution-abasement activities, namely disposal of unintended outputs. Different with their paper, our paper is based on a two-stage network structure and has discussed the phenomenon of reusing the unintended outputs. The purpose of this paper is to develop an approach for measuring efficiency for DMUs that have a two-stage network process with a shared flow and feedback as shown in Fig. 1. Our two-stage structure is different from previously-studied two-stage processes, and the previous analysis techniques are not suitable for our case. Therefore we firstly proposed a weighted sum efficiency formula, namely additive efficiency (Chen, Cook, Li, & Zhu, 2009), to evaluate the overall efficiency of the two-stage process. Then, considering the difference of the two stages in that stage 1 is always used for production while stage 2 is always used for purification and processing of undesirable outputs, we apply the non-cooperative game (leader-follower) models proposed by Liang et al. (2006) and Liang et al. (2008) in DEA to distinguish the importance of the two stages. In real life, there are many situations corresponding to the leader-follower game. In many traditional factory production processes, the leader is production and the recovery of raw material from bad products or the processing of pollution is always put in second place (Erkman & Ramaswamy, 2003; Yang & Feng, 2008). In contrast, the reuse, recycling, and proper disposal of wastes or pollutants from industrial production are given priority (i.e., considered the leader) in many regions in order to protect the environment (Wu et al., 2014; Xue et al., 2010).The structure of this paper is as follows. Section 2 presents a two-stage network DEA model with a shared flow and feedback, including additive efficiency measures and non-cooperative efficiency measures. Section 3 extends our proposed static two-stage network structure to a dynamic situation in which feedback of recycled waste is delayed. In Section 4, a real world example of 30 provincial level regions in mainland China is analyzed to illustrate our proposed approaches. Finally conclusions and directions for future research are shown in Section 5.The above Fig. 1 illustrates a two-stage network process situation, where each DMU is composed of two sub-DMUs in parallel, and the undesirable products from the stage 1 sub-DMU are an input resource for the stage 2 sub-DMU. The undesirable products used as an input resource for the stage 2 sub-DMU are disposed of to obtain desirable products, which are fed back as input resources for the stage 1 sub-DMU. The structure also shows a generic two-stage network process where some inputs are shared by both sub-DMUs.Suppose that there are n DMUs denoted byDMUj(j=1,…,n), and that for eachDMUj(j=1,…,n)the stage 1 sub-DMU consumes m inputs denoted byX=(X1j,X2j,…,Xmj)T, G inputs denoted byH=(H1j,H2j,…,HGj)T, and K inputs denoted byZ=(Z1j,Z2j,…,ZKj)T=Z1+Z2=(Z11j,Z12j,…,Z1Kj)T+(Z21j,Z22j,…,Z2Kj)Tto produce s desirable outputs denoted byY=(Y1j,Y2j,…,Ysj)Tand D undesirable outputs denoted byF=(F1j,F2j,…,FDj)T. On the one hand, the desirable outputs Y are complete and perfect, and go outside of the system. On the other hand, the undesirable outputs F may be disposed of by the stage 2 sub-DMU using P inputsR=(R1j,R2j,…,RPj)Tand m inputsX=(X1j,X2j,…,Xmj)Tto obtain K desirable outputs denoted byZ2=(Z21j,Z22j,…,Z2Kj)T, which serve as input resources of the stage 1 sub-DMU. Note that the inputs X are used or shared by the both sub-DMUs. We assume that Xijare divided into ∂ijXijand(1−∂ij)Xij,i=1,…,m(0≤∂ij≤1)for eachDMUj(j=1,…,n), corresponding to the portions of shared flows used by the sub-DMUs in stages 1 and 2 respectively. Cook and Hababou (2001) and Chen et al. (2010) suggested that all∂ij,i=1,…,mj=1,…,nshould be required to be within a certain intervals to guarantee that each stage can be allocated a minimum amount of shared resources.In this section, we will discuss the additive efficiency of the sub-DMUs in the two stages. Thus, we propose to combine the two stages in a weighted sum of efficiency scores of stages 1 and 2 as the overall efficiency of the two stages under constant return to the scale (CRS), which can be written as follows:(1)MaxEAdd0=w1×E10+w2×E2oE1j=∑r=1surYrj−∑d=1DφdFdj∑i=1mvi∂ijXij+∑k=1KπkZ1kj+∑k=1KπkZ2kj+∑g=1GwgHgj≤1,j=1,…,nE2j=∑k=1KπkZ2kj∑i=1mvi(1−∂ij)Xij+∑p=1PηpRpj+∑d=1DφdFdj≤1,j=1,…,nur≥0,r=1,…,s;vi≥0,i=1,…,m;φd≥0,d=1,…,D;πk≥0,k=1,…,K;wg≥0,g=1,…,G;ηp≥0,p=1,…,PLi≤∂ij≤Ui,i=1,…,m;j=1,…,nSome further explanations follow:1.We assume that the weights for the variables serving as both input and output in the two-stage network process are same in each stage, soφd=φ1d=φ2d,d=1,…,Dandπk=π1k=π2k,k=1,…,K(Chen et al., 2010; Kao and Hwang, 2008; Liang et al., 2008). We also assume thatvi=v1i=v2i,i=1,…,mfor all common input variables because these are the same types of inputs (Chen et al., 2010; Zha and Liang, 2010; Amirteimoori, 2013).The rationale for the negative sign of the second term of the numerator for the first stage efficiency of model (1) is that the outputs Fjare undesirable and they should be decreased in the production process. In other words, this paper assumes the strong disposability for the undesirable output as same as many other studies did (Badau, 2015; Golany & Roll, 1989; Hua, Bian, & Liang, 2007; Korhonen & Luptacik, 2004; Scheel, 2001; Seiford & Zhu, 2002; Shi, Bi, & Wang, 2010; Yang & Pollitt, 2009). Besides, these undesirable outputs Fjare inputted as desirable resources in the second stage for purification of undesirable resources. Thus, inputs Fjin stage 1 should be considered as ordinary input resources instead of undesirable input resources.w1 and w2 denote the weights of sub-DMUs in the first and second stages respectively, such thatw1+w2=1. E1jand E2jdenote the efficiency of the sub-DMUs in stages 1 and 2 respectively.LiandUiare the lower and upper bounds for shared resourcei,i=1,…,n. These lower and upper bounds are usually given by decision makers based on the assignment of the two stages (Chen et al., 2010; Cook & Hababou, 2001).Definition 1DMUjis said to be overall efficient if and only ifEAddj=1,j=1,…,n.Definition 2The stage k sub-DMU is said to be efficient ifEkj=1,k=1,2j=1,…,n.Proposition 1Notice that these two definitions ensure that DMU0 is overall efficient if and only if each stage is efficient.ProofFor the proof of this proposition, see Appendix B.We use w1 and w2 to represent the relative importance or contribution of the efficiency of each stage to the overall performance of the given DMU in the whole process. In order to start the process of converting model (1) into a linear program, one reasonable weight choice of each stage is the proportion of total resources devoted to each stage, reflecting the relative size and importance of a stage (Chen et al., 2009; Chen et al., 2010; Amirteimoori, 2013). Thus, we definew1=∑i=1mvi∂ioXio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgoAw2=∑i=1mvi(1−∂io)Xio+∑p=1PηpRpo+∑d=1DφdFdoAwhere A represents the total amounts of input resources consumed by the whole process with feedback and shared flow, which can be denoted byA=∑i=1mviXio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo+∑p=1PηpRpo+∑d=1DφdFdo. The expressions∑i=1mvi∂ioXio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgoand∑i=1mvi(1−∂io)Xio+∑p=1PηpRpo+∑d=1DφdFdorepresent the sizes or amounts of the first and second stages, respectively.Thus, the overall efficiency of the whole two-stage network processes with feedback and shared flow for a common DMU0 can be evaluated by solving the following fractional model (2) under CRS.(2)Max∑r=1surYro−∑d=1DφdFdo+∑k=1KπkZ2ko∑i=1mviXio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo+∑p=1PηpRpo+∑d=1DφdFdoE1j=∑r=1surYrj−∑d=1DφdFdj∑i=1mvi∂ijXij+∑k=1KπkZ1kj+∑k=1KπkZ2kj+∑g=1GwgHgj≤1,j=1,…,nE2j=∑k=1KπkZ2kj∑i=1mvi(1−∂ij)Xij+∑p=1PηpRpj+∑d=1DφdFdj≤1,j=1,…,nur≥0,r=1,…,s;vi≥0,i=1,…,m;φd≥0,d=1,…,D;πk≥0,k=1,…,K;wg≥0,g=1,…,G;ηp≥0,p=1,…,PLi≤∂ij≤Ui,i=1,…,m;j=1,…,nModel (2) is a nonlinear program, and we need to transform it into a standard linear program (3) in three steps which are shown in Appendix A. The result is as follows:(3)MaxEAdd0=∑r=1sur′Yro−∑d=1Dφd′Fdo+∑k=1Kπk′Z2ko∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mξijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0,j=1,…,n∑k=1Kπk′Z2kj−∑i=1svi′Xij+∑i=1mξijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1mvi′Xio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo=1Livi′≤ξij≤Uivi′,ξij≥0i=1,…,s;j=1,…,nur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′≥0,p=1,…,PThus we obtain a standard linear program (3) and the optimal distribution proportion∂ij,i=1,…,mj=1,…,n. The dual formulation of model (3) is expressed as follows:(4)Minθ∑j=1nλjHgj≤θHgo∀g∑j=1nλjYrj≥Yro∀r∑j=1nγjRpj≤θRpo∀pλjXij−γjXij+ρij−qij≤0∀i,j∑j=1nγjFdj+∑j=1nλjFdj≤θFdo+Fdo∀d∑j=1nλjXij+∑j=1nqijUi−∑j=1nρijLi≤θXio∀i∑j=1nγjZ2kj−∑j=1nλj(Z1kj+Z2kj)≥Z2ko−θ(Z1ko+Z2ko)∀kλj≥0,γj≥0,ρij≥0,qij≥0i=1,…,m,j=1,…,nwhere θ denotes the overall efficiency of the two stages.Proposition 2The dual model (4) has feasible solutions. (Clearly, the conditionθ=1,λo=γo=1,λj=γj=0,j=1,…,n,j≠o,ρij=0,qij=0is a feasible solution to this problem).Once we obtain an optimal solution to model (3), the additive efficiency scores for the two-stage network processes can be calculated accordingly. However, model (3) may have multiple optimal solutions, so the respective efficiency of the sub-DMUs may not be unique. Therefore, we can choose a set of multipliers which produce the highest first or second stage efficiency score while maintaining the additive efficiency score of the whole network processes proposed by Kao and Hwang (2008). In addition, minimizing the efficiency gap between the two sub-DMUs in the two stages is also a standard strategy for choosing multipliers.In the previous section, we examined additive efficiency measures for the two-stage problem. However, some instances in real life may not conform to this situation because the two sub-DMUs work together to achieve their overall efficiency maximization. For example, in the western part of China, the development of economy should be given priority while the WRRR of CE in environment should be regarded as more important in eastern China. In this section, we consider the two-stage processes from the perspective of the non-cooperative game. The non-cooperative measure is characterized by the leader-follower Stackelberg game (Liang et al., 2006; Liang, Cook, & Zhu, 2008). Two conditions are examined as follows.In this part, we first treat the sub-DMU in stage 1 as the leader whose performance is more important and the stage 2 sub-DMU as the follower whose efficiency is computed subject to the requirement that the efficiency of the first stage has achieved optimization. In this part, in order to reflect the lower and upper bounds for the proportions of shared resources in calculating the efficiency of stage 1, we assume that Xijare divided into (1-∂ij)Xijand∂ijXij,i=1,…,mfor eachDMUj(j=1,…,n), corresponding to the portions of shared flows used by the sub-DMUs in stages 1 and 2 respectively. Thus, the efficiency of the first stage (the leader) for a specific DMU0 is calculated under CRS as follows:(5)MaxE11o=∑r=1surYro−∑d=1DφdFdo∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgoE1j=∑r=1surYrj−∑d=1DφdFdj∑i=1mvi(1−∂ij)Xij+∑k=1KπkZ1kj+∑k=1KπkZ2kj+∑g=1GwgHgj≤1ur≥0,r=1,…,s;vi≥0,i=1,…,m;φd≥0,d=1,…,D;πk≥0,k=1,…,K;wg≥0,g=1,…,G;1−Ui≤∂ij≤1−Li,i=1,…,s;j=1,…,nUsing the aforementioned transformation steps, we can transform model (5) into the following linear model:(6)Max∑r=1sur′Yro−∑d=1Dφd′Fdo∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mvi′Xio+∑i=1mξijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0∑i=1mvi′Xio−∑i=1mξioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo=1(1−Ui)vi′≤ξij≤(1−Li)vi′i=1,…,s;j=1,…,nvi≥0,i=1,…,m;ur′≥0,r=1,…,s;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;In the linear transformation, we setξij=vi′∂ij(j=1,…,n). Note that, if we assume Xijare divided into ∂ijXijand(1−∂ij)Xij,i=1,…,mused by the sub-DMUs in stages 1 and 2 respectively, the constraints(1−Ui)vi′≤ξij≤(1−Li)v′will be removed from model (6), which cannot reflect the proportional constraints of shared resource allocation. If the shared flow can be freely allocated in either of the two sub-DMUs, we have the following Theorem 1.Theorem 1If the shared flow is freely allocated in either of the two sub-DMUs, that is, we have 0 ≤ ∂ij≤ 1, and then the leader sub-DMU is efficient.ProofFor the proof of this theorem, see Appendix B.The corresponding efficiency of the sub-DMU in stage 2 is calculated by the following program:(7)MaxE120=∑k=1KπkZ2ko∑i=1mvi∂ioXio+∑p=1PηpRpo+∑d=1DφdFdo∑r=1surYro−∑d=1DφdFdo∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo=E101☆E1j=∑r=1surYrj−∑d=1DφdFdj∑i=1mvi(1−∂ij)Xij+∑k=1KπkZ1kj+∑k=1KπkZ2kj+∑g=1GwgHgj≤1,j=1,…,nE2j=∑k=1KπkZ2kj∑i=1mvi∂ijXij+∑p=1PηpRpj+∑d=1DφdFdj≤1,j=1,…,nur≥0,r=1,…,s;vi≥0,i=1,…,m;φd≥0,d=1,…,D;πk≥0,k=1,…,K;wg≥0,g=1,…,G;ηp≥0,p=1,…,P1−Ui≤∂ij≤1−Li,i=1,…,s;j=1,…,nwhereE101☆is the optimum efficiency of stage 1 sub-DMU. The transformation method that linearized model (2) will not turn model (7) into a linear program. To solve this problem, we introduce a heuristic method, which is one of the contributions of this paper. To proceed, we setT1=1∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo,T2=1∑i=1mvi∂ioXio+∑p=1PηpRpo+∑d=1DφdFdo,ur′=T1ur,φd′=T1φd,πk′=T1πk,vi′=T1vi,wg′=T1wgφ′′d=T2φd,π′′k=T2πk,v′′i=T2vi,ηp′′=T2ηp.ψij=vi′∂ij(j=1,…,n)Note thatvi′v′′i=φd′φ′′d=πk′π′′k=T1T2=1σ, therefore model (7) can be transformed into:(8)MaxE120=σ∑k=1Kπk′Z2ko∑r=1sur′Yro−∑d=1Dφd′Fdo=E1o1☆∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mvi′Xij+∑i=1mψijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0σ∑k=1Kπk′Z2kj−σ∑i=1mψijXij−∑p=1Pηp′′Rpj−σ∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1mvi′Xio−∑i=1mψioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo=1σ∑i=1mψioXio+∑p=1Pηp′′Rpo+σ∑d=1Dφd′Fdo=1(1−Ui)vi′≤ψij≤(1−Li)vi′i=1,…,s;j=1,…,nσ≥0ur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′′≥0,p=1,…,PConsidering model (8), we know that it is still a nonlinear program. Now, setσηp′=ηp′′. Note that, for a given σ, model (8) is then equivalent to the following model (9):(9)Max∑k=1Kπk′Z2ko∑r=1sur′Yro−∑d=1Dφd′Fdo=E1o1☆∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mvi′Xij+∑i=1mψijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0∑k=1Kπk′Z2kj−∑i=1mψijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1mvi′Xio−∑i=1mψioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo=1σ(∑i=1mψioXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo)=1(1−Ui)vi′≤ψij≤(1−Li)vi′i=1,…,s;j=1,…,nσ≥0ur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′≥0,p=1,…,PIt is true that model (9) is still a nonlinear problem, but we can view it as a parametric linear program, with σ as the parameter. We can search over values of σ and pick values that are optimal for model (9). To proceed, we should give an estimation of the largest σ. Note thatσ=T2T1, so we can solve the following model to obtain the largest σmax.(10)σmax=Maxσ=T2T1=∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo∑i=1mvi∂ioXio+∑p=1PηpRpo+∑d=1DφdFdo∑r=1surYro−∑d=1DφdFdo∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo=E101☆E1j=∑r=1surYrj−∑d=1DφdFdj∑i=1mvi(1−∂ij)Xij+∑k=1KπkZ1kj+∑k=1KπkZ2kj+∑g=1GwgHgj≤1,E2j=∑k=1KπkZ2kj∑i=1mvi∂ijXij+∑p=1PηpRpj+∑d=1DφdFdj≤1,j=1,…,nur≥0,r=1,…,s;vi≥0,i=1,…,m;φd≥0,d=1,…,D;πk≥0,k=1,…,K;wg≥0,g=1,…,G;ηp≥0,p=1,…,P1−Ui≤∂ij≤1−Li,i=1,…,s;j=1,…,nNote that,σ=T2T1=∑i=1mvi(1−∂io)Xio+∑k=1KπkZ1ko+∑k=1KπkZ2ko+∑g=1GwgHgo∑i=1mvi∂ioXio+∑p=1PηpRpo+∑d=1DφdFdois exactly the input resources proportion of first stage to second stage. Using the aforementioned linear transformation steps, we can transform model (10) into the following linear program:(11)σmax=Max1∑i=1mψioXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo⇔Min∑i=1mψioXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo∑r=1sur′Yro−∑d=1Dφd′Fdo=E1o1☆∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mvi′Xij+∑i=1mψijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0∑k=1Kπk′Z2kj−∑i=1mψijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1mvi′Xio−∑i=1mψioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo=1(1−Ui)vi′≤ψij≤(1−Li)vi′i=1,…,m;j=1,…,nur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′′≥0,p=1,…,PTheorem 2The optimal value σmax  of model (11) is the largest σ for which model (9) is feasible.ProofFor the proof of this theorem, see Appendix B.However, for some given σ < σmax, model (9) may be infeasible. Thus, we have the following theorem.Theorem 3For any σ ∈ (0, σmax ], σ is feasible for model (9), and model (9) has optimal solutions and an optimal value.ProofFor the proof of this theorem, see Appendix B.Theorem 4Let E⋆(σ) be the optimal value for any σ ∈ (0, σmax ] from model (9). Then, E⋆(σ) is a non-increasing continuous function of σ.ProofFor the proof of this theorem, see Appendix B.Similarly, we can develop the following programming problem when stage 2 (the leader) is more important. In this part, we assume that Xijare divided into ∂ijXijand(1−∂ij)Xij,i=1,…,mused by the sub-DMUs in stages 1 and 2 respectively for reflecting the proportional constraints of shared resource allocation.(12)MaxE220=∑k=1Kπk′Z2ko∑k=1Kπk′Z2kj−∑i=1svi′Xij−∑i=1mζijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1mvi′Xio−∑i=1mζioXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo=1Livi′≤ζij≤Uivi′,i=1,…,s;j=1,…,nvi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;ηp′≥0,p=1,…,PThe corresponding efficiency of the sub-DMU in stage 1 is calculated by the following program:(13)MaxE21o=β(∑r=1sur′Yro−∑d=1Dφd′Fdo)∑k=1Kπk′Z2ko=E2o2☆∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mζijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0,j=1,…,n∑k=1Kπk′Z2kj−∑i=1svi′Xij+∑i=1mζijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,nβ(∑i=1mζioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo)=1∑i=1mvi′Xio−∑i=1mζioXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo=1Livi′≤ζij≤Uivi′,i=1,…,s;j=1,…,nβ≥0ur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′≥0,p=1,…,PModel (13) can also be treated as a parametric linear program with respect to β. Thus, the optimumE1o2☆can be calculated by searching through the whole interval of 0 < β ≤ βmax  where βmax can be calculated by the following program:(14)βmax=Max1∑i=1mψioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo⇔Min∑i=1mψioXio+∑k=1Kπk′Z1ko+∑k=1Kπk′Z2ko+∑g=1Gwg′Hgo∑k=1Kπk′Z2ko=E2o2☆∑r=1sur′Yrj−∑d=1Dφd′Fdj−∑i=1mψijXij−∑k=1Kπk′Z1kj−∑k=1Kπk′Z2kj−∑g=1Gwg′Hgj≤0,j=1,…,n∑k=1Kπk′Z2kj−∑i=1svi′Xij+∑i=1mψijXij−∑p=1Pηp′Rpj−∑d=1Dφd′Fdj≤0,j=1,…,n∑i=1svi′Xio−∑i=1mψijXio+∑p=1Pηp′Rpo+∑d=1Dφd′Fdo=1Livi′≤ψij≤Uivi′,i=1,…,s;j=1,…,nur′≥0,r=1,…,s;vi′≥0,i=1,…,m;φd′≥0,d=1,…,D;πk′≥0,k=1,…,K;wg′≥0,g=1,…,G;ηp′≥0,p=1,…,PTheorem 5The optimal value βmax  of model (14) is the largest σ for which model (13) is feasible. For any β ∈ (0, βmax ], β is feasible for model (13), and model (13) has optimal solutions and an optimal value. In addition, E⋆(β), the optimal value of∑r=1sur′Yro−∑d=1Dφd′Fdobased on the restraints of model (13) is a non-increasing continuous function of β (The specific proof follows from the proofs of Theorems 2, 3 and 4).Using the above heuristic algorithm, we can obtainE1j1☆,E2j1☆,E2j2☆andE1j2☆respectively for each DMU.Consider a numerical example shown in Table 1 with 10 DMUs. Each DMU has two stages where four inputs are inputted in stage 1 to output one desirable output and one undesirable output. The undesirable output and another three inputs are inputted in stage 2 to produce the feedback, which returns to stage 1 as its input. Here, two kinds of resources are shared by the two sub-DMUs. To find the optimal solutions to models (8) and (13), we can start with a small σ, β (like 0.001) as the initial point and set a small increment Δs(=0.001). Theorems 2 and 5 indicate that we can solve models (8) and (13) for eachσi=0.001+k×0.001,βi=0.001+k×0.001untilσ=σmax,β=βmax.Table 2 shows the results with the assumption of 0 ≤ ∂ij≤ 1. Columns 2 to 5 represent the situation of stage 1 dominating the system, while columns 6 to 9 represent the situation of stage 2 dominating. Table 2 includes the biggest possible values for σ and β as well as the optimal values (i.e. when each affiliated stage achieves optimal efficiency).Based on Table 2, we can give a detailed explanation. For example, DMU1 has a uniqueσ☆=3.814associated with the optimal efficiency ofE211☆=0.5515for model (8) in stage 2 when stage 1 is the leader and has its maximal efficiency scoreE211☆=1, while the biggest σ is 4.578. As shown in Fig. 2, the efficiency of stage 2 increases as σ increases, then starts to decrease when σ reaches 3.814 and when σ > 4.578 model (8) becomes infeasible. As previously mentioned, σ is the input resources proportion of first stage to second stage, so we should give less input resources to stage 2 in order to optimize stage 1’s efficiency. When σ > 3.814, the efficiency of stage 2 drops quickly, so the proportion should not exceed 3.814. Further analysis reveals that the efficiency of stage 2 is associated with a uniqueσ☆=3.814. When the second stage dominates the system, the corresponding biggest and optimal value of β is 0.182 and 0.129 respectively. A uniqueβ☆=0.129has been obtained. Note that, our model has made all leader sub-DMUs efficient, which is a verification of Theorem 1.Multiple σ values are often associated with the same efficiency of stage 2. For example, DMU4 has multiple σ values within [0.976, 0.980] associated with the same efficiencyE241☆=0.1825of stage 2. When σ > 0.980 model (9) may be infeasible where 0.980 is just the biggest value of model (11). The efficiency change of DMU4 corresponding to each σ is shown in following Fig. 3. The results have demonstrated the truth of Theorem 2 and 3.We previously mentioned regarding Theorem 4 that the optimal value of model (9) is a non-increasing continuous function of σ. Therefore, we will show the optimal value changes of different DMUs from model (9) corresponding to each σ in following Fig. 4.In Fig. 4, we illustrate the optimal value changes for four arbitrary DMUs from model (9). They are DMU1, DMU3, DMU4, and DMU9. From the trend of each line, we know the speed of decrease of the optimal value from model (9) is slow at the beginning until it reaches some special σ, at which point it begin to decrease quickly. The results demonstrate Theorem 4.In Section 2, our proposed models are based on a single long static time we view as one entire period. This static structure is appropriate when Stage 1 and 2 can run concurrently and continuously pass outputs to the other stage. For example, as Stage 1 produces waste water, that undesirable output flows immediately to Stage 2 as input. As Stage 2 recycles the water, the purified water immediately and continuously flows back into a reservoir from which Stage 1 is getting its input. It makes sense that in a well-designed production system, some output of Stage 2 will be available to Stage 1 before the end of the period and vice versa, i.e. that the stages feed each other during the production period. Even in situations where the output of either stage or both stages is delayed before becoming input to the other stage, this static model is appropriate when the considered production period is long enough, for example a year when the production and disposal units each run once per day. This static model (e.g., using non-cooperative efficiency measures) may help us to better analyze the efficiency of each subsystem.In this section, we consider a variation in which the output of Stage 2 does not continuously flow to Stage 1. Instead, the Stage 2 output is delayed and is only available to Stage 1 in the next production period. This models situations where the processing of undesirable products must be done only in large batches, in which case it would be natural to consider each batch completion to be the end of a production period.We extend the above static structure to a dynamic situation, which is shown in Fig. 5. This dynamic structure may be better for analysis of the efficiency of each period in the production process.Fig. 5 shows two adjacent periods: t and t+1. In each period, there are two stages which are similar to our previous structure in Fig. 1. The only difference is that the reverse logistics of Stage 2 in period t will flow into period t+1 as Stage 1’s new inputs; that is the undesirable outputs recycled in period t are employed as inputs only in period t+1. Considering model (2) above, we formulate the following model to measure the whole system and process efficiencies for a general series system with T periods.(15)MaxEo=∑t=1Tωt×∑r=1surtYrot−∑d=1DφdtFdot+∑k=1KπktZko2t∑i=1mvitXiot+∑k=1KπktZko1t+∑k=1KπktZko2(t−1)+∑g=1GwgtHgot+∑p=1PηptRpot+∑d=1DφdtFdotE1jt=∑r=1surtYrjt−∑d=1DφdtFdjt∑i=1mvit∂ijtXijt+∑k=1KπktZkj1t+∑k=1KπktZkj2(t−1)+∑g=1GwgtHgjt≤1,j=1,…,n;t=1,…,TE2jt=∑k=1KπkZkj2t∑i=1mvit(1−∂ijt)Xijt+∑p=1PηptRpjt+∑d=1DφdtFdjt≤1,j=1,…,n;t=1,…,Turt≥0,r=1,…,s;vit≥0,i=1,…,m;φdt≥0,d=1,…,D;πkt≥0,k=1,…,K;wgt≥0,g=1,…,G;ηpt≥0,p=1,…,P;t=1,…,TLi≤∂ijt≤Ui,i=1,…,m;j=1,…,nwhereωt,t=1,…,Tare the weights for period t which are set exogenously according to their importance. In order to convert model (1) into a linear program, in a manner similar to the above-mentioned definitions of w1 and w2, we setωt=∑i=1mvitXijt+∑k=1KπktZkj1t+∑k=1KπktZkj2(t−1)+∑g=1GwgtHgjt+∑p=1PηptRpjt+∑d=1DφdtFdjt∑t=1T(∑i=1mvitXijt+∑k=1KπktZkj1t+∑k=1KπktZkj2(t−1)+∑g=1GwgtHgjt+∑p=1PηptRpjt+∑d=1DφdtFdjt), where the denominator represents the total amounts of input resources consumed in the whole period and the numerator represents the amounts of input resources consumed in each period. Following the aforementioned transformation steps, we can transform model (15) into the following linear model:(16)MaxE0=∑t=1T(∑r=1surtYrot−∑d=1DφdtFdot+∑k=1KπktZko2t)∑r=1surtYrjt−∑d=1DφdtFdjt−(∑i=1mξijtXijt+∑k=1KπktZkj1t+∑k=1KπktZkj2(t−1)+∑g=1GwgtHgjt)≤1,j=1,…,n,t=1,…,T∑k=1KπkZkj2t−(∑i=1m(vit−ξijt)Xijt+∑p=1PηptRpjt+∑d=1DφdtFdjt)≤1,j=1,…,nt=1,…,T∑t=1T(∑i=1mvitXiot+∑k=1KπktZko1t+∑k=1KπktZko2(t−1)+∑g=1GwgtHgot+∑p=1PηptRpot+∑d=1DφdtFdot)=1urt≥0,r=1,…,s;vit≥0,i=1,…,m;φdt≥0,d=1,…,D;πkt≥0,k=1,…,K;wgt≥0,g=1,…,G;ηpt≥0,p=1,…,P;t=1,…,TLivit≤ξijt≤Uivit,i=1,…,m;j=1,…,n;t=1,…,TDenoting the optimal solutions of model (16) as(urt☆,vit☆,φdt☆,πkt☆,wgt☆,ηpt☆,ξijt☆), we can then calculate the efficiencies for each period t as:Eot=∑r=1surt☆Yrot−∑d=1Dφdt☆Fdot+∑k=1Kπkt☆Zko2t∑i=1mvit☆Xiot+∑k=1Kπkt☆Zko1t+∑k=1Kπkt☆Zko2(t−1)+∑g=1Gwgt☆Hgot+∑p=1Pηpt☆Rpot+∑d=1Dφdt☆FdotProposition 2DMU0 is efficient (e.g.,Eo=1) during the T periods if and only if it is efficient in each period (e.g.,Eot=1,t=1,…,T).ProofThe proof follows from the proof of Proposition 1.This section proposes a real example about industrial production processes in 30 provincial level regions in mainland China. Since the industrial production includes many production periods during each year and the production subsystem and waste disposal subsystem run concurrently, our focus in this application is to illustrate the static structure model. When the industrial production periods are known in each year, it is also very straight forward to extend this to the dynamic situation. Fig. 6 shows a general two-stage static production process for this application: one is the industrial production subsystem and the other is the waste disposal subsystem.In the industrial production subsystem, the inputs are: labor, capital, energy, and output value of products made from waste water, waste gas and solid waste (OV). The outputs are: gross industrial output value (GIOV), waste water, waste gas, and solid waste. Among them, waste water, waste gas, and solid waste are three kinds of undesirable outputs, which are also inputs to the second stage; these are undesirable intermediate products. The second stage also has inputs of labor, energy, and investment in the treatment of industrial waste water, waste gas, and solid waste. The output of this stage is OV, which as an input resource feeds back to the production system. In this two-stage network process, labor and energy are seen as the shared resources employed in both sub-DMUs. The input-output measures that are used in this process are summarized in Table 3.Table 4 provides the data for the above industrial production process for the 30 provincial level regions in mainland China. The data for the Tibet Autonomous Region are incomplete and are not considered in the current study. The data are derived from the “China Statistical Yearbook, 2011” and “China Energy Statistical Yearbook, 2011”.Table 5 reports the results of additive efficiency measure of sub-DMUs from model (4) for each provincial level region. In this application, we assume the shared labor and energy resources are divided ∂ijto the waste disposal system and set 0.1 ≤ ∂ij≤ 0.3. From the table, three regions are efficient in this example. They are Jiangsu, Jiangxi, and Shandong. There are also some regions with low efficiency, like Shanxi, Guizhou and Ningxia. These regions are really poor in industrial productionTable 6 presents the non-cooperative efficiency measures and the relative efficiencies of the two stages. Columns 2 to 6 present the situation when stage 1 dominates the system, while Columns 7 to 10 present the situation when stage 2 dominates the system. The table also includes the biggest possible σmax  and βmax , and specifies the optimal value σ⋆ (Δs=0.01) and β⋆ (Δs=0.001) when each affiliated stage achieves optimal efficiency. In addition, the optimal allocated proportions for the shared labor resource are presented in the two situations.From Table 6, there are 3 regions that are efficient in both stages. These regions are Jiangsu, Jiangxi, and Shandong, which are exactly the efficient DMUs measured in the additive efficiency model. This result verifies our Proposition 1. When the production system is the leader, there are more efficient regions in eastern China. Maintaining the leader efficiency, we find that all of western regions of China have a low efficiency in waste disposal systems; however, these regions have a high efficiency when the waste disposal system is the leader. Thus, western of China should pay more attention to waste disposal systems on basis of maintaining the optimal efficiency in the production system.We now illustrate the proposed computation procedure in estimating relative non-cooperative efficiencies of the two stages for Hebei Province (DMU3). The maximal efficiency score for its leading sub-DMUs are allE1,31☆=E2,32☆=1based upon models (6) and (12). In order to calculate the efficiency for its following sub-DMUs, we firstly obtainσmax=6.332andβmax=0.370by solving models (11) and (14). After that, letσi=0.01+k×Δσ,βi=0.001+k×Δβ,σi≤σmax,βi≤βmaxand set the step size asΔσ=0.01,Δβ=0.001.Fig. 7shows the change of the optimal efficiency for the sub-DMUs of stage 2 and stage 1 as the follower in models (8) and (13) respectively. When stage 1 is the leader, it can be seen that the efficiency for its following stage 2 increases untilσ☆=5.34(E2,31☆=0.450). When σ > 5.34, the optimal efficiency of stage 2 for Hebei Province (DMU3) starts to decrease untilσ=6.33. After that, we calculate∂1j=0.3and∂2j=0.1for labor and energy respectively, which means Hebei Province should allocate 30% of labor resources and 10% of energy resources to the waste disposal system to maintain optimal efficiency in the production system. When stage 2 is the leader, it can be seen that the efficiency for its following stage 1 increases untilβ☆=0.075(E1,32☆=0.907). When β > 0.075, the optimal efficiency of stage 1 for Hebei Province starts to decrease untilβ=0.370.∂1j=0.13and∂2j=0.12indicate that Hebei Province should allocate 87% and 88% of labor and energy resources respectively to the production system to maintain optimal efficiency in the waste disposal system. The results in Fig. 7 verify Theorem 3. In order to verify our Theorem 2, setσi=σmax+k×0.01,βi=βmax+k×0.001,k=1,2,…, and we find that models (8) and (13) becomes infeasible. Thus, the optimal efficiency for the sub-DMUs of stage 2 and stage 1 as the follower for Hebei Province (DMU3) areE2,31☆=0.450andE1,32☆=0.907respectively.We should point out that we use a heuristic search method, the accuracy of which depends on the selection of step size Δσ and Δβ. Assuming that most of σmax are big enough, we have set the step sizeΔσ=0.01in our computation procedure. For some small σmax, we can set the step sizeΔσ=0.001. The effect of varying the step size for Hebei Province is shown in Fig 6, which shows that the same optimal efficiency is obtained. In fact, we have setΔσ=0.000001and the optimal efficiency remains the same to a resolution of six decimal points.

@&#CONCLUSIONS@&#
In the current paper we measure the relative efficiency of a two-stage network process with shared input resources to both stages and undesirable outputs reused in the system. In particular, we examine the feedback situation where some intermediate products from the first stage are undesirable but can be processed in the second stage to produce some desirable resources to feed back to the initial stage of the process. This feedback for resource reuse gives rise to variables that serve both as input and output (dual-role variables). In reality, many DMUs do have this kind of structure, example being the WRRR system of CE and the reuse of faulty products in factories, as previously discussed in this paper.In order to evaluate the efficiency of this two-stage process, an additive model and a non-cooperative model are proposed. The additive measure has been proved to be a good formulation to illustrate overall performance of DMUs by Chen et al. (2010) and Cooper, Seiford, and Zhu (2011), allowing the optimization of overall efficiency through cooperation among the two stages. The additive measure is inappropriate in some situations where a certain stage is more important than the other. For example, unconstrained by legal requirements, factories usually consider the production system to be more important, but where there are strict environmental policies the waste disposal system may be given priority. To analyze such situations, a non-cooperative Stackelberg game is introduced to evaluate the efficiency of each stage. The non-cooperative model cannot be transformed to a linear program due to the feeding back of resources and to the existence of shared flow to both stages. This paper proposes a heuristic method to transform these nonlinear models into parametric linear programs. This heuristic method is proved to be a good way to find the optimal efficiency for the following stage. In addition, we have considered a dynamic variation of our proposed two-stage network structure. Finally, our proposed approaches are illustrated with a data set for measuring the industrial production performance of 30 provincial level regions in mainland China.Consider extensions of these results. Our models give respective weights for each DMU. A future research goal is to give a common weight for all DMUs. Also, in many actual production systems, usually only portions of all undesirable products produced by stage 1 are reused or disposed in stage 2, and unfortunately real-life data on proportions is difficult to determine. However, we tested the common proportions from 0.1 to 1 for all regions and found that they have little influence on each region's efficiency. Therefore, the results of little influence and test different portion for all regions may need further study or demonstration.