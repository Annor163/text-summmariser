@&#MAIN-TITLE@&#
A novel generalized gradient vector flow snake model using minimal surface and component-normalized method for medical image segmentation

@&#HIGHLIGHTS@&#
We adopt minimal surface function to take the place of Laplace operator in GGVF snake model.We use component-based normalization method instead of the vector-based normalization in the proposed snake model.Precision, Recall and F1 measure are adopted to evaluate the segmentation results objectively.The proposed snake model has better convergence property to enter into long and thin indentations of medical images.

@&#KEYPHRASES@&#
Active contour model,Gradient vector flow,Medical image segmentation,Segmentation accuracy,External force field,

@&#ABSTRACT@&#
Active contours, or snakes, have a wide range of applications in medical image segmentation. Gradient vector flow (GVF) field, generalized GVF field and other external force fields have been proposed to address the problems of traditional snake models, such as low accuracy of segmentation and poor convergence ability in indentations. In order to further solve the two problems, we put forward a novel generalized gradient vector flow snake model using minimal surface and component-normalized method. We adopt minimal surface function instead of Laplace operator to settle the problem of low segmentation accuracy. We also use component-based normalization method instead of conventional vector-based normalization method to improve the ability of snake curve to converge into long and thin indentations. Experimental results and comparisons against other methods indicate that the proposed snake model own the ability to protect weak borders and solve the incorrect segmentation problem effectively. Meantime, our method performs much better than generalized GVF snake model in terms of long and thin indentation.

@&#INTRODUCTION@&#
Medical image segmentation plays a significant role in contemporary medical diagnosis [1–4]. Precise extraction of clinical information from medical images is one of the key problems in computer-assisted medical diagnosis system. Many medical technologies, such as image guided surgery, radiation therapy for cancer, and 3-D model reconstruction, are all based on image segmentation [5–7]. Since the medical images essentially have the features of complexity and diversity, it is a very thorny issue to gain accurate information during the practice. The majority of the previous segmentation methods can be generally categorized into two basic methods, the edge-based and region-based methods [8,9]. The two methods are often complementary. Therefore, a number of approaches have been put forward, such as snakes [10] and level set [11–13], which are all based on the key concepts of these two basic methods. Among them, the snake model is a big improvement in medical image segmentation field [13–15].The premier snake, or traditional active contour model, was introduced by Kass [10] and co-workers in 1987. The contour deforms to minimize the contour energy, which includes the internal and external energy. During the process of deformation, the internal force, defined by the curve itself, is used for restraining the curve's smoothness and tightness. The external force, defined by the gradient of image, is used for driving the deformation curve to evolve into interesting features in the image. Finally, the process of deformation stops when the contour achieves an energy minimum, in other words, the force achieves balance [14–16]. Overall, snake model can be roughly divided into parameter snake model and geometric snake model, whereas, the former is the subject in this paper.Compared with other image segmentation methods, active contour model is self-adapting in the process of minimizing the energy function [17]. The original snake model is proposed as an interactive method, which requires expert guidance on the initialization process and the selection of deforming parameters [18]. It is necessary to comprehend several limitations of the original snake model. First, the initial contour must be very close to the interesting features in an image. Second, the deformation curve is difficult to converge into indentations. Furthermore, conventional snake model cannot change topology during its deformation process without additional mechanism [19]. Considering these limitations, Xu [20] proposed gradient vector flow (GVF) snake model based on an external force field, which is able to expand the capture scope of initial contour and owns the capability to converge into indentations. The generalized gradient vector flow (GGVF) snake model [21], proposed by Xu and Prince, adds two weighting coefficients which can change in the image region. Thus, deformation curve can converge rapidly in the flat field and has certain ability to protect weak borders. However, the second problem of conventional snake model has not been effectively solved. NGVF snake model proposed by Ning [22] decomposes the Laplace operator in the GVF external force field, and only retains normal component. Thereby NGVF further improves the curve's capability in the aspect of indentation converging. Although the tangential component after decomposition has been added to GVF external force field by later NBGVF [23] snake model, the convergence capability of long and thin indentation has not been significantly improved.In addition to these, segmentation methods for medical images have several special problems. The typical difficulties of medical image segmentation include: blur or weak edge, strong edge near the missing edge, profile contour in overlapping objects, complex contour shape with accentuated protrusions and concavities, inhomogeneous interior intensity distribution [18]. As shown in Fig. 1, all these troubles should be considered in the segmentation process using snake model. The medical images are available at [31].In order to settle the problems above, we make several important improvements on the basis of intensive research and put forward a novel snake model. The main contributions of this paper are summarized as follows:(1)The isotropic diffusion characteristics of the GGVF snake model may smooth the weak border in excess, causing low segmentation accuracy phenomenon. To solve this problem, we adopt minimal surface function to take the place of Laplace operator in GGVF snake model. This function has two properties. On the one hand, it has isotropic smoothing effect at locations where the fluctuation of gradient values is relatively small. On the other hand, it has the function to protect weak edge near the strong edge of an image. These two properties make the snake curve own both the characteristics of rapid convergence and protecting the weak borders.Component-based normalization method instead of the vector-based normalization is applied to the proposed snake model. We normalize each component of the initial GGVF vector respect to its own magnitude. Each normalized component takes the same effect on driving snakes. So the proposed snake model has better convergence property to enter into long and thin indentations (LTIs) than GGVF snake model.The rest of this paper is organized as follows. In the next section, conventional snake model is briefly described. Then, the proposed method is given in detail in Section 3. Besides, we implement our methods and other current snake models on medical images. The experimental results are presented and analyzed in Section 4. Finally, we come to a conclusion about this paper in Section 5.Snake, or active contour, is a deformable curve which was constituted by a set of control points, as demonstrated in Fig. 2. The initial contour gradually migrates to target area under the drive of internal and external energy from the image. In the first place, we introduce conventional snake model in this section.According to Kass [10] and co-workers, a traditional snake is a curve, which can be represented byxs=xs,ys,s∈0,1. The final contours are determined by minimizing the following energy function:(1)Esnake=∫0112αsx′s2+βsx″s2+Eextxsdsαsrepresents the elastic coefficient andβsdenotes intensity coefficient. The first two terms represent the internal energy function. The last term represents the external energy function. To minimize the energy function, the following Euler equation must be satisfied:(2)αsx″s−βsx‴′s−∇Eextxs=0Eq. (2) can be regarded as the force equilibrium equation:(3)Fintxs+Fextxs=0whereFint=xs=αsx″s−βsx‴′s,andFextxs=−∇extxs. The external forceFextxscan be defined by users in different situations in order to drive the curve to the desired borders of an image.However, the traditional snake model is limited in practical applications. The main reasons are due to its small capture range and poor performing in the aspect of converging into concavities. To address these problems, Xu and Prince [20] proposed GVF field as a new external force field. GVF field usesυx,y=ux,y,vx,yto replaceFextxs.υx,yis obtained by minimizing the following energy function:(4)E=∬μ∇υ2︸smoothnessenergy+∇f2υ−∇fdxdy︸edgeenergywhere f represents the edge map of image I. ∇f denotes gradient field of f. μ is a parameter controlling the smoothness of GVF field. μ is larger if noise level is higher, and it can be set based on the noise level of an image.Although GVF snake model solves the problem that the curve cannot converge into indentations, it still performs badly in converging into long and thin indentations (LTI). To settle this problem, Xu [21] and co-workers added two weighting coefficients into the iterative equation of GVF external force field in 1998. Thereby a new external force field called GGVF field was obtained and GGVF snake model was put forward. Compared with GVF snake model, GGVF snake model has been improved in the performance of converging into indentation and noise robustness. Energy function of GGVF snake model is defined as:(5)E=∬g∇f∇υ2︸smoothnessenergy+h∇fυ−∇fdxdy︸edgeenergyIncluding:(6)g∇f=e−∇f/k(7)h∇f=1−g∇fThe first item on the right side of (5) is smoothing item, which can produce a vector field. The second item is data item, which can drive vector field υ to close to the gradient ∇f of edge image. Parameter k determines the weighting value to balance smoothing term and data term. The value of k is related to noise strength of an image. The higher the noise level is, the larger value of k is.Considering the importance of boundary information in medical images, the performance of above snake models should be improved in protecting the Region of Interest (ROI), especially preserving weak edges. Smoothing excessively may lose some important information and cause error segmentation. However, the incorrect convergence may add background information into ROI. We take account of these drawbacks in above snake models and put forward a new snake model. The new model takes more attention in protecting weak edges using minimal surface function. Furthermore, the experimental performance on long and thin indentations is improved by adopting component-based normalization method [24] instead of vector-based normalization method.The force fieldυx,y=ux,y,vx,yin GGVF snake model can be represented by the following equation:(8)E=∬g∇fφ∇υ︸smoothnessenergy+h∇fυ−∇fdxdy︸edgeenergyg∇fandh∇fare the same as defined in (5). Now we redefineφ∇υasφ∇υ=1+∇υ2instead of∇υ2in (5). In theory, there are advantages if we make this change mentioned above. We analysis the theoretical characteristics of smoothness energy in (5) and explain the superiority.Now we considerυ=υx,yas a surface defined in the x–y plane. According to the infinitesimal calculus [25], let1+υx2+υy2represent the micro area element. The smoothness item in (8) can be expressed as the following form:(9)Esmooth=∬g∇f1+∇υ2dxdy=∬g∇f1+υx2+υy2dxdyGeneric function (9) not only depicts the continuity of the surface, but also describes the surface area. The minimum surface area of u can be gained through minimizing formula (9). Moreover,1+∇υ2is a measure and the generic function (9) can be explained as the deformation tensor of a thin film regardless of its weight.g∇fcan be considered as tensor coefficient. Thus, minimizing (9) is equivalent to get the minimum value of the thin film's deformation energy which owns uneven tensile force. Meanwhile, energy minimization possesses real physic and geometric meaning, namely, area minimization and deformation minimization [26]. However,∇υ2does not have the explicitly physic and geometric implications mentioned above.According to the calculus of variation [25], the Euler equation corresponding to (9) is expressed as follows:(10)∇⋅φ′∇υ∇υ⋅∇υ=0On the basis of the theory in [9], (10) is a well-conditional diffusion equation. Because it satisfies the necessary and sufficient conditions and the necessary criteria to minimize (9):(11)φ′∞≠0φ′0=0So it cannot cause the staircase effect of ill-posed diffusion equation. Whereas, ifφ∇υ=∇υ, it will not satisfies the condition in (11), Meanwhile, (10) will become a non-differentiable function. The diffusion process in (10) can be decomposed as follows:(12)λ1∇υGv+λ2∇υGp=0Including:(13)λ1∇υ=φ′∇υ∇υλ2∇υ=φ″∇υwhere Gvrepresents vertical direction of gradient and Gprepresents parallel direction of gradient. The smoothness in vertical direction can eliminate noise and preserve edge information. However, in parallel direction, if λ2>0, it has the function to smooth the edge. In GGVF snake model,λ2GGVF=2. But, in proposed snake model, λ2 can be expressed as the following formula.(14)λ2=11+∇υ2Fig. 3gives the comparison of smoothing coefficients in GGVF snake model and proposed snake model. It is obviously that λ2 (pink color) in proposed method is less than 1. However,λ2GGVF=2(blue color) is a constant. According to the two coefficients, GGVF snake model has more serious smoothing effect than the proposed method. Furthermore, in (14), the smoothing effect becomes smaller along with∇υbecoming larger, as shown in Fig. 3. Thus, the proposed snake model can protect the edge better than GGVF snake model.According to calculus of variations and the discussion about (12), the minimal surface gradient vector flow can be achieved by the following equation.(15)∂υ∂t=g∇υ⋅1+∇υ2∇⋅∇υ1+∇υ2−h∇υ⋅υ−∇f∂υ/∂tcan be described by forward difference scheme and the diffusion item can be depicted by central difference scheme:(16)∂υ∂t=υn+1−υnΔt(17)1+∇υ2∇⋅∇υ1+∇υ2=1+υy2⋅υxx+1+υx2⋅υyy−2υxυyυxy1+∇υ2Based on the studies of external force features in GGVF snake model, Qin [24] and co-workers discovered that GGVF and GVF active contours have the similar convergence ability. Generally, GVF and GGVF active contours can converge into indentations with odd pixel width. However, they are difficult to converge into indentations with even pixel width. In the meantime, when GGVF active contour converges into LTI, it still has oblivion and noise problems. The GGVF vectorsυx,y=ux,y,vx,yare normalized with respect to their magnitudes using the following equation.(18)υggvfx,y=υx,yυx,yυx,y≠00,0υx,y=0The method in Eq. (18) is regarded as vector-based normalization. The proposed snake model adopts component-normalized method in external force field instead of vector-normalized method used in GGVF snake model. It normalizes each component of initial GGVF vectors respecting to its own magnitude. The new method is used to replace conventional external force field−∇Eextυswithυcnx,y=ucnx,y,vcnx,y. The components are defined as follows:(19)ucnx,y=1ux,y>00ux,y=0−1ux,y<0(20)vcnx,y=1vx,y>00vx,y=0−1vx,y<0u(x,y) and v(x,y) in (19) and (20) represent the components x and y at point (x,y), respectively. It can be simplified as follows:(21)υcnx,y=sgnux,y,sgnvx,yWe compare the effects of the two normalization methods on an initial vector. As shown in Fig. 4, the initial vector V is indicated in orange and the normalized vector V′ is indicated in aqua blue. Fig. 4(a) shows the normalized vector computed by using the vector-based normalization method. Compared with the initial vector V, the magnitude of V′ changed, but its direction is same with V. Fig. 4(b) displays the normalized external force vector using the component-based normalization method. It is obviously that V′ changes in both magnitude and direction compared with V. In contrast, the impact of the component-normalization on the directional change can be treated as a reduction in the directional resolution [24]. The proposed method adopts component-based normalization method to address the problem that the snake curves are difficult to converge into long and thin indentations. The detailed performance is given in next section.

@&#CONCLUSIONS@&#
