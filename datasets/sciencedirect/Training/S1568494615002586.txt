@&#MAIN-TITLE@&#
Detection of abnormalities in lumbar discs from clinical lumbar MRI with hybrid models

@&#HIGHLIGHTS@&#
Hybrid models which include feature extraction, feature selection and classification for determining the disc abnormalities of the lumbar region have been developed.F-score based feature selection (FSFS) and correlation-based feature selection (CBFS) were used to select best discriminative features.The results obtained suggest that the proposed hybrid models can be safely used in the detection of disc abnormalities.

@&#KEYPHRASES@&#
Lumbar disc abnormality,Lumbar MRI,Lumbar spine,Hybrid models,Hybrid features,Feature selection,

@&#ABSTRACT@&#
Disc abnormalities cause a great number of complaints including lower back pain. Lower back pain is one of the most common types of pain in the world. The computer-assisted detection of this ailment will be of great use to physicians and specialists. With this study, hybrid models have been developed which include feature extraction, selection and classification characteristics for the purpose of determining the disc abnormalities in the lumbar region. In determining the abnormalities, T2-weighted sagittal and axial Magnetic Resonance Images (MRI) were taken from 55 people. In the feature extraction stage, 27 appearance characteristics and form characteristics were acquired from both sagittal and transverse images. In the feature selection stage, the F-Score-Based Feature Selection (FSFS) and the Correlation-Based Feature Selection (CBFS) methods were used to select the best discriminative features. The number of features was reduced to 5 from 27 by using the FSFS, and to 22 from 27 by using the CBFS. In the last stage, five different classification algorithms, i.e. the Multi-Layer Perceptron, the Support Vector Machine, the Decision Tree, the Naïve Bayes, and thekNearest Neighbor algorithms were applied. In addition, the combination of the classifier model (the combination of the bagging and the random forests) has been used to improve the classification performance in the detection of lumbar disc datasets. The results which were obtained suggest that the proposed hybrid models can be used safely in detecting the disc abnormalities.Artificial Neural NetworkActive Shape ModelComputer-Aided DiagnosisCorrelation-Based Feature SelectionCase-Based ReasoningF-Score-Based Feature SelectionGeneralized Regression Neural Networkk-Nearest NeighborMultilayer PerceptronMagnetic Resonance ImagingSelf-Organizing MapSupport Vector MachineUniversity of California, IrvineWorld Health Organization

@&#INTRODUCTION@&#
The injuries related to discs are associated with disc deformations (bulging and rupturing). This condition causes a pain in the lower back or in the feet [4]. Lower back anomalies are mostly detected through lumbar MRI with the studies of radiologists [5]. Radiologists often have to view the sagittal and axial images at the same time in order to be able to make a precise decision as to whether there is any ailment or not. Mostly, it may not be sufficient to consider only the axial or the sagittal images. While signal intensities can be obtained from the sagittal T2-weighted MR images, the deformations of the disc can be viewed from the axial T2-weighted images. The deformations or signal intensities provide significant insights as to whether the disc is normal or not [4]. It is clear that the computer-assisted diagnosis of disc anomalies will provide great convenience for the doctors and specialists.Lower back pain is a common source of discomfort [1]. According to the data of the World Health Organization (WHO), the prevalence of this ailment in the world is about 42%. It is the second most common type of pain after headaches. This disease causes labor loss and limits daily activities. The number of people with this disease increase each year due to occupational accidents [2,3]. Most countries spend a large amount of money on the diagnosis and treatment of this ailment every year. The accurate diagnosis and treatment of diseases and ailments are of vital importance for the world of medicine [4]. In the field of medicine, more attention has recently been paid on the use of machine learning techniques, to facilitate the diagnosis of patients by doctors and specialists.There are 26 vertebral bones in our spine starting from the neck and stretching down to our thighs and further down, forming the spinal canal. Five of these vertebrae are located in the lumbar region. There is a special connective tissue in the form of a disc among these vertebral bones making it easy to move and enabling the spine to be a reliable protective element against impacts [6]. Many researchers have conducted various studies for the identification of vertebral column abnormalities. Among these studies, those that are associated with our study are as follows:Neto and Barreto used the Support Vector Machine (SVM), MLP and Generalized Regression Neural Network (GRNN) for the diagnosis of the pathologies of the vertebral column [7]. The authors used a method that was based on two new Fuzzy Adaptive Resonance Theories (FA) [8] and Self-Organizing Map (SOM) for the classification of the vertebral column dataset obtained from UCI Machine Learning Repository. Neto et al. [9] proposed a combination of the existing options to give a decision on the diagnosis of the vertebral column. A hybrid system that was based on Case-Based Reasoning (CBR) and Artificial Neural Network (ANN) classifier was developed for the diagnosis of the pathology on the vertebral column, and then a classification accuracy of 85% was obtained [10]. Berthonnaud et al. introduced a method to analyze and characterize the global sagittal balance of the human trunk using indexes derived from the shape and orientation of the pelvis and cervical, thoracic, and lumbar spine [11]. Reddy et al. classified the vertebral column data set obtained from the UCI (University of California at Irvine) machine learning database using the Naïve Bayes Classifier[12]. Bounds et al. performed a back pain diagnosis method with artificial neural networks and achieved successful results. Tsai et al. performed a diagnosis of disc herniation by extracting geometrical features from 3D MRIs and CT axial images [13]. Roberts made a classification of lumbar and thoracic areas through the Active Shape Model (ASM) features he obtained from X-ray images. [14]. Alomari et al. developed a Computer-Assisted Diagnosis System (CAD) that performed a classification by taking the ASM and intensity level features from the sagittal T1 and T2 MR images and achieved an average accuracy of 91.7% [15]. Koompairojn et al. developed an automatic feature extraction from the axial MRI and made a classification using these features with MLP. They attained a classification accuracy between 92% and 97% [16]. Unal et al. have proposed an innovative data pre-processing method called the Pairwise Fuzzy C-Means Clustering-based Feature Weighting to improve the classification performance and to determine the vertebral column disorders including disk hernia (DH), spondylolisthesis (SL) and normal (NO) groups automatically [37].The diagnosis of disorders of the lumbar region is often difficult for radiologists if the diagnosis is made only by examining the axial images or only by examining the sagittal images. Generally, the decisions made by considering both the axial and sagittal images are more accurate. Therefore, we have proposed a hybrid feature set including the features extracted from both the axial and sagittal images to detect the abnormalities using MRI. Furthermore, as far as we know, there is no such hybrid system utilizing the features extracted from both axial and sagittal MR images and feature selection algorithms to detect the abnormal discs.In this paper, we present a method of diagnosis for disc abnormalities with hybrid features. In our method, the feature vectors taken from both T2-weighted sagittal and axial lumbar disc are used. These features are the Shape Feature Values containing some sections from the axial images, and the Intensity Values and Appearance Features from the sagittal images. Shape features are derived from the Active Shape Model (ASM). In the classification of the disease, 27 pieces of appearance and shape features obtained from both the sagittal and transverse (axial) images were used together. The proposed hybrid model consists of two stages. In the first stage, in order to select the involved features associated with the class label from the dataset of the 27 features, the F-score and Correlation-Based Feature Selection (CBFS) methods are used. The number of features dropped from 27 to 5 through the use of the F-Score Feature Selection Method; on the other hand, the number of features was reduced from 27 to 22 with the Correlation-Based Feature Selection Method. In the second stage, the classification process was performed after the process of feature selection. As the classification algorithms; Multi-Layer Perceptron (MLP), Support Vector Machine (SVM), decision tree, the Naïve Bayes, and the k- Nearest Neighbor (k-NN) classification algorithms are used. The classification success rates obtained from the dataset with 27 features are 93.45%, 94.54% 92.36%, 93.45%, and 94.18%, using MLP, SVM, the Naïve Bayes, decision tree, and the k-NN (for k=1 value), respectively. The classification success rates obtained in classifying the dataset reduced to 5 features by means of the F-score method are 94.18%, 94.54%, 94.18%, 96% and 95.27%, using the MLP, the SVM, the Naïve Bayes, the Decision Tree, and the k-NN (for k=7), respectively.The classification success rates obtained in classifying the dataset reduced to 22 features through CBFS are 93.98%, 94.73%, 91.72%, 94.36% and 94.54%, using the MLP, the SVM, the Naïve Bayes, the Decision Tree, and the k-NN (for k=1), respectively. The detection of abnormality from the Feature Selection Algorithms and Lumbar MRI can be performed with high accuracy. In addition to these results, we have used the combination of the classifier model (the combination of Bagging and Random Forests) to improve classification performance and to detect the lumbar disc abnormalities with different features (5, 22, and 27 features). The best method is the combination of Bagging and Random Forests with 22 features reduced by CBFS.In this study, T2-weighted sagittal and axial images of 55 patients were used. All the images were collected using the Siemens Magnetom Symphony 1.5Tesla Scanner in the Radiology Department at Amasya Sabuncuoğlu Şerefeddin Research and Application Hospital, Turkey. Fig. 1shows the scanner used in this study. The features of this scanner are given in Table 1.The input images of our study composed of T2-weighted MR images of the lumbar spine in transverse (axial) and sagittal (side) views. The MR images obtained from the Siemens Magnetom Symphony 1.5Tesla Scanner device were transformed into a JPG image with 2D and with a resolution of 256×256 pixels by means of an expert radiologist and Gold Pacs MR image programmer. In this application, we used the 2D lumbar images to detect the abnormalities as a preliminary study. Fig. 2shows the sagittal MRI in transverse (axial) and sagittal (side) views.In our study, both sagittal and axial images were taken from each of the 55 patients. For each patient, one sagittal image was taken, and five axial images were taken totaling 330 intervertebral disc images.From the sagittal images, there were cropped images obtained as shown in Fig. 3with the dimension of 150×200 between the L1-L2, L2-L3, L3-L4, L4-L5, L5-S1 discs. Table 2gives the demographic information belonging to 55 people who participated in this study.In this study, in order to determine the abnormalities in the sagittal and axial lumbar MRI, a 3-Phase Diagnosis Method has been proposed. In the first phase, 27 features were extracted from the sagittal and axial lumbar MRI, and the features extracted were obtained from the formal and structural characteristics of MRI. In the second phase, F-Score Based and Correlation-Based Feature Selection Algorithms were used to select the best of those 27 features obtained. The aim of feature selection methods are both to improve the classification accuracy of the classifier algorithms in the detection of lumbar disc patients based on both the sagittal and axial MRI, and to decrease the computation time of the hybrid systems. By selecting the best discriminative features from all the features, a dataset that is linearly non-separable has been transformed to a linearly separable dataset. By doing so, the classification performance is improved. In the third phase, classification algorithms were utilized in order to classify the dataset prepared using the best discriminative features. The block diagram of the proposed method is given in Fig. 4.In this work, the visible features from axial MR images were extracted manually by an expert radiologist. From the sagittal MR images, 19 formal features were extracted from the point distribution of the ASM. The statistical information of the obtained features is given in Table 3(for normal class). Table 4denotes the statistical evolution of the lumbar disc dataset for the abnormal class. In addition to these tables, Fig. 5shows the box plot representations of normal and abnormal classes of lumbar MRI dataset.If the feature vectors are extracted with great care through medical image processing, the diagnosis becomes easier. The accurate classification of images is possible through the selection of accurate features [17]. Radiologists often have to view the sagittal and axial images at the same time in order to be able to make a precise decision as to whether there is an abnormality. Most of the time, it may not be sufficient to have a look only at the axial or sagittal images [2]. In the identification of disc abnormalities, shape is an important factor. Robust discs have elliptical shapes. In the abnormal discs, however, the shape is deformed and is flattened. On the other hand, the intensity signal levels also give significant clues about the condition of the disc. The intensity signal levels in the abnormal discs are low, whereas they are high in normal ones [15]. Consequently, the sagittal and axial images have been used at the same time, and shape and intensity features have been extracted from these images in our study.The shapes of the disks may give us important clues about their situations. The disks in MR images with sagittal axes are generally in elliptic form. Although there might be very small changes in the shapes of the disks in various situations (i.e. due to the age, and the height of the patient, etc.) they may give us important clues in terms of the robustness of the disks. For instance, healthy disks may be observed as being in the elliptical form; but the shape of the ellipsis is broken in abnormal disks, and the disk becomes flat. For these reasons, the Active Shape Model-based Attribute Extraction Method has been used in this study in order to determine the attributes of the disk shapes.The Active Shape Model (ASM) is a popular method used in positioning and segmentation of the images, discrimination among the objects in the images, attribute extraction and in similar other applications. This method is mostly used in face recognition and is also applied in extracting attributes from the medical images [18,19]The ASM is one of the model-based approaches. It consists of two models, the Shape and the Profile Models. The Shape Model defines the changes in the shapes that are included in the educational set. The Profile Model constitutes the statistical data that represent the grayscale tissue information around each point that constitute the profile shape [18,19].In this study, the tissue information (i.e. the attribute vectors) around the landmark pointers of the normal and abnormal disks are obtained with the help of the Profile Model.In order to define the shape of the object well, landmark points have been evenly distributed. The eight landmark points that represent the shape best are marked in Fig. 6.The attribute vectors have been obtained with the Active Shape Model Method and the following algorithm. Fig. 7shows the algorithmic representation of ASM.In the context of the algorithm given above, 16 attribute vectors have been obtained.The feature vectors were obtained through measuring the spinal features from the axial MR images. The measurements were performed manually by the MRI technician. At first, the boundaries were determined. The boundaries, A, B, C, and D were marked as shown in Fig. 8. Then, eight measurements shown in Fig. 9were performed.The feature vectors corresponding to the numbers in Fig. 8 were the right lateral canal diameter, the left lateral canal diameter, the right canal heights, the antero-posterior diameter, the left canal heights, the upper canal width, the transverse diameter, and the lower canal width [16].The feature selection algorithms are often used for the purpose of selecting the relevant features associated with the output label, and for minimizing the computational time during the classification process. There are mainly two objectives in feature selection: the first one is to minimize the classification cost by reducing the number of features and thus, forming a more compact classification model; and the second one is to improve the classification performance. In this context, two feature selection algorithms, the correlation-based feature selection and the F-score-based feature selection were used.Correlation is a criterion used to measure whether a feature (attribute) is relevant to other features in a dataset and to the outputs (classes) or not. With respect to this idea, we have proposed a feature selection method that is based on correlation coefficients between features incorporating the dataset and the outputs of the dataset. A feature is good if it is relevant to the class but is not redundant to any of the other relevant features. Applied with correlation, the good side of a feature is measured according to whether it is highly correlated with the class or not highly correlated with any of the other features [20,21].In the correlation based feature selection, the p-value has been used as the feature selection threshold. To select the significant features from the dataset in this paper, the threshold p-value is chosen as 0.05. If the p-value of any feature and class label is smaller than 0.05, then, this feature will be selected. Otherwise, that feature will be removed from the dataset. Fig. 10shows the flowchart of the Correlation-Based Feature Selection.Using the Correlation-Based FS method, the number of features was reduced from 27 to 22 features. Table 5denotes the correlation coefficients between the features forming the lumbar disc dataset with the class case.As it is clear in Table 5, number of the features were decreased from 27 features to 22 features by removing the 5 features that have p-values bigger than 0.05. The removed features from the dataset were 5, 9, 12, 17 and 27.F-score method is a simple technique which measures the distinguishing power of features between two classes with real values. In the F-score method, F-score values of each feature in dataset are calculated according to the following equation (Eq. (8)), and then in order to select the features from the dataset, the threshold value is obtained by calculating the mean value of the F-scores of all the features. If the F-score value of any feature is bigger than the threshold value, that feature is added into the feature space. Otherwise, that feature is removed from the feature space. Given training vectors xk, k=1, ...m, if the number of positive and negative instances are n+ and n-, respectively, then the F-score of the ith feature is explained as follows [22,23]:(8)F(i)=(x¯i(+)−x¯i)2+(x¯i(−)−x¯i)21n−+1∑k=1n+(xk,i(+)−x¯i(+))2+1n−−1∑k=1n−(xk,i(−)−x¯i(−))2wherex¯i,x¯i(+),x¯i(−)are the average of the ith feature of the whole, positive, and negative data sets, respectively;xk,i(+)is the ith feature of the kth positive instance, andxk,i(−)is the ith feature of the kth negative instance. The numerator shows the discrimination between the positive and negative sets, and the denominator defines one of each of the two sets. The larger the F-score is, the more discriminative is this feature. But a disadvantage of the F-score method is that it does not take the mutual information between features into account [23,24]. Fig. 11demonstrates the block diagram of the F-Score-Based Feature Selection (FSFS) method. Table 6gives the F-score values of the 27 features of lumbar disc dataset and the average of the F-score values.By means of the F-score-based FS method, the number of the features was reduced from 27 to 5 features. Table 6 gives the F-score values of the 27 features forming lumbar disc dataset and the selected features. As Table 6 demonstrates, the numbers of the features were decreased from 27 features to 5 by removing the 22 features that had bigger averages than the F-score values of all the features. The selected features were 1, 2, 9, 10 and 22.We have used the classifiers including the Multi-Layer Perceptron (MLP), the Support Vector Machine (SVM), the Decision Tree, the Naïve Bayes, and thekNearest Neighbor (k-NN) [42–44] to detect the normal and abnormal images. In addition to classifier algorithms, at the same time, we have used the ensemble of the classifier structure to improve the classification performance of the lumbar disc dataset. The combination of Bagging and Random Forests has been used as the ensemble of the classifier. The ensemble of classifier method has been shown in Fig. 12.The Bagging Method was proposed by Breiman [39]. In the Bagging Method, a training set with N samples is produced from the training set consisting of N samples with random selection substitution technique. In this case, some training samples are not present in the new training set (appr. 33%), while some are present more than once. Each basic learner in the community is trained with training sets that are produced in this method and that include samples that are different from each other, and the results are combined with majority voting system [38,39].The readers can refer to [25–32,38,39,42–44] to get more information on the classifier algorithms and ensemble of classifiers.The classification accuracy, sensitivity, specificity, precision, recall, F-measure, ROC (Receiver Operating Characteristics), AUC (area under the ROC curve), and kappa values have been used in order to test the performance of the proposed method and are explained as follows.The ensemble of the classifier 10-fold cross validation scheme has been used in the training and testing of the classifier models. The principle of 10-fold cross validation is as follows: breaking the data into 10 sets of size n/10, and training 9 datasets and testing on 1. Finally, repeating it 10 times and taking a mean accuracy.For classification accuracy, sensitivity and specificity analyses, precision, recall and F measure, the following expressions have been used based on TP (True Positive), TN (True Negative), FP (False Positive) and FN (False Negative).(11)ClassificationAccuracy(%)=TP+TNTP+FP+TN+FN×100(12)Sensitivity(%)=TPTP+FN×100(13)Specificity=TNFP+TN×100(14)Precision=(TP)/(TP+FP)(15)Recall=TP/(TP+FN)(16)f−measure=2×precision×recallprecision+recallThe Cohen's kappa coefficient is a statistical method which measures the reliability of the comparative agreement between two raters (inter-rater reliability). If Pr (a) is the summing proportion of the observed agreements for the two raters and if the Pr (e) is the probability for this agreement to occur by chance, then the formula to be applied to find out the Cohen's kappa coefficient would be as follows: (Eq. (16)) [34,35]:(17)κ=Pr(a)−Pr(e)1−Pr(e)κ=1: The two raters are in complete agreement.κ=0 : The agreement between the two raters are merely determined by chance and there is no agreement at all in other cases [34,35].

@&#CONCLUSIONS@&#
In this paper, a new feature set was proposed to detect the abnormalities using both sagittal and axial lumbar MRI. This dataset was named as the Hybrid MRI Features and applied to detect abnormalities (ailments). The objective of this study was to determine the diseases of the lumbar region through Computer-Assisted MR images. Disc anomalies give rise to a number of complaints such as the lower back pain. This is one of the most prevalent types of pain observed throughout the world. The diagnosis and treatment of this ailment cause great financial losses. The computer-assisted detection of this disease will be of great use to physicians and specialists. In this study, a diagnosis method was proposed for determining the abnormalities from sagittal and axial lumbar MRI. In the first stage, 27 features were extracted from sagittal and axial lumbar MRI, and these extracted features were obtained from the formal and structural properties of the lumbar MRI. In the second phase, the feature selection algorithms were used in order to select the best of those 27 features obtained. The F-Score Feature Selection and the Correlation-Based Feature Selection Algorithms were used. In the third phase, the classification algorithms were used for classifying the dataset, the feature of which was reduced. In conclusion the proposed system could be used for determining the abnormalities from lumbar MRI in an offline manner. In the future, the proposed system will be performed online in detecting the abnormalities from the lumbar MRI. Again, in the future, we are going to examine 3D images for the same study.