@&#MAIN-TITLE@&#
ADRC or adaptive controller – A simulation study on artificial blood pump

@&#HIGHLIGHTS@&#
An Active Disturbance Rejection Controller was developed for a rotary blood pump.The performance of ADRC was studied in activity and pathology variation.ADRC was easy to design and tune.ADRC demonstrated robust performance with excellent disturbance rejection.

@&#KEYPHRASES@&#
Active disturbance rejection control,Adaptive control,Physiological controller,Rotary blood pump,Left ventricular assist device,

@&#ABSTRACT@&#
Active disturbance rejection control (ADRC) has gained popularity because it requires little knowledge about the system to be controlled, has the inherent disturbance rejection ability, and is easy to tune and implement in practical systems. In this paper, the authors compared the performance of an ADRC and an adaptive controller for an artificial blood pump for end-stage congestive heart failure patients using only the feedback signal of pump differential pressure. The purpose of the control system was to provide sufficient perfusion when the patients’ circulation system goes through different pathological and activity variations. Because the mean arterial pressure is equal to the total peripheral flow times the total peripheral resistance, this goal was converted to an expression of making the mean aortic pressure track a reference signal. The simulation results demonstrated that the performance of the ADRC is comparable to that of the adaptive controller with the saving of modeling and computational effort and fewer design parameters: total peripheral flow and mean aortic pressure with ADRC fall within the normal physiological ranges in activity variation (rest to exercise) and in pathological variation (left ventricular strength variation), similar to those values of adaptive controller.

@&#INTRODUCTION@&#
Rotary blood pump (RBP) is a mechanical pump to restore the perfusion for end-stage heart failure patients. Some studies have showed that the passive variation of pump flow at a fixed speed due to the change of cardiovascular parameters could not match the physiological demands of patients [33]. Physiological controller, which adjusts the pump flow automatically, is critical for the permanent application of RBP and provides better life quality of patients [1]. The controller needs to adjust the pump flow properly for different patients in the situations such as: patients sleep, rest, or exercise slightly (e.g. walking or climbing stairs); and when the recipient’s sick heart gets better or worse. In these conditions, some properties of human circulatory system may change dramatically such as the total peripheral resistance, so is the body need for blood [2]. Many physiological controllers have been proposed for RBP to achieve the robust performance at the presence of large disturbance. The algorithms of those controllers can be classified as two types, model-based controller, and model free controller. Model-based controller design use a simplified mathematical model of plant (i.e. RBP plus cardiovascular system) [3,22,24–28]. Some models include time-varying parameters to accommodate the large variations of circulation system in different physiological conditions with the cost of online computational effort [3]. Because of the dependence on model, the performance of model-based controller is also contingent upon the accuracy of the model. Model-free controllers, use only the input (e.g. pump speed, pump current) and the output (e.g. pump flow, pump pressure rise, heart rate, etc.) information of the RBP plus cardiovascular system, but typically needs extensive tuning of controller in advance because of the nature of the implemented fuzzy logic [28–30]. The exception is the model free adaptive controller proposed by Gao and Chang [31,32], which has four design parameters that are special to the structure of the controller. All these model-based or model-free controllers have demonstrated robust performance at the presence of large disturbance in numerical simulation and/or in-vitro experiments. However, their dependence on model [3,22,24–28], extensive tuning in advance [28–30], multiple design parameters [31,32], or intensive computational effort [3] present challenge for clinical application.Active disturbance rejection controller (ADRC) was proposed by Han [4–6], further simplified and parameterized by Gao [7,8]. The effectiveness of ADRC is evident in many case studies, where the technique is employed to solve a number of benchmark problems in various industrial problems with promising results [9–19]. The applications demonstrate that ADRC provides a very simple controller design but achieves high performance in tracking and disturbance rejection for various complex control problems. The basic idea of ADRC is to use an extended state observer (ESO) to estimate the internal and external disturbances, which can be named as the total disturbance, in real time. The estimated total disturbance is then canceled in the controller in real time. Through disturbance rejection, the originally complex and uncertain plant dynamics is reduced to a simple cascaded integral plant, which can be easily controlled by a PD controller. Three important features of ADRC are: (1) it requires very little model information of the system; (2) it achieves excellent disturbance rejection performance; and (3) it requires only two tuning parameters: controller bandwidth and observer bandwidth. ADRC can be classified as a model-free controller. The focus of this paper is to compare the performance of the designed ADRC and a model-based adaptive controller on artificial blood pump.In this paper, we first give the introduction of human circulation system and artificial blood pump, together with the objectives of the controller. The design of adaptive controller and ADRC controller is presented later, followed by their simulation results in a variety of physiological scenarios.Human circulation system is composed of heart (with four chambers), peripheral arterial system, capillary, peripheral venous system, pulmonary arterial system and pulmonary vein system. The blood circulates from left ventricle to peripheral arterial system, through capillary, peripheral venous system, to right atrium, then to right ventricle, then through pulmonary arterial and venous system, to left atrium, then back to left ventricle. The authors have developed a lumped parameter computational model for human circulation system interacting with RBP functioning as left ventricular assist device (LVAD). Its electrical analog is shown inFig. 1[2]. The detail explanation of each element of this model is listed in the Appendix.In the human circulation system, the heart rate, the contractility of the heart, the resistance of peripheral blood vessels, the resistance of pulmonary blood vessels may change dramatically in different pathological or activity levels [2]. There are also one way cardiac valves to make sure that the blood can only flow in one direction. In summary, human circulation system is a time-varying nonlinear system with large system uncertainty and disturbance.The rotary blood pump is a centrifugal or axial flow pump driven by a small electrical motor. The pump is usually used to aid the more frequently failed left ventricle, with the inlet connected to the left ventricle, and the outlet connected to the aorta, indicated as left ventricular assist device (LVAD) in Fig. 1. So the pressure across the pump is equal to the aortic pressurePAminus the left ventricular pressurePLV.The pump used in this study is Nimbus pump [23], a blood pump with contact bearing. Its hydrodynamic parameters and motor equations are described by(1a)∆P=h0Q+h1Q̇+h2ω2(1b)Jω̇=KI−Bω−g0ω3−g1Qω2where I is the applied current, ω is the pump rotational speed, Q is the volume flow rate of the pump, ΔP is the pressure difference across the pump, i.e.(PA−PLV), J is the inertia of pump. K, B, hi(i=0, 1, 2) and gj(j=0, 1) are constants identified through experiment. If ignoring the small inertia effect of the pump and linearizing Eqs. (1a) and (1b) around the nominal operating speed, we can get:(1c)Q=β1∆P+β2Iwith some linear coefficients β1 and β2[1].The computational model of Fig. 1 was realized in Matlab/Simulink (Mathworks, Navick, MA). This model has been demonstrated to be able to simulate the response of circulation system and rotary blood pump in different activities and different levels of heart failure [2]. Fig. 1 was used as the simulation environment for this paper.The ultimate goal of the physiological controller is to provide sufficient perfusion (i.e. total peripheral flow). Since the total peripheral flow is equal to the mean aortic pressure divided by the total peripheral resistance, this goal can be converted to maintaining the proper mean aortic pressure. However, due to the fact that the available pressure senor is not reliable in long term, aortic pressure cannot be directly obtained [22], but indirectly approximated by Eq. (2) from the pump differential pressure.The aortic pressurePAis proposed to be derived from differential pressure across RBP (ΔP) indirectly by the following equation:(2)P¯A≈ΔPmodifiedwhereP¯Ais the mean aortic pressure,ΔPmodifiedis the processed function of the diastolic portion of ΔP. An example of ΔPmodifiedas compared toPAandPLVis shown inFig. 2. Eq. (2) is based on the following facts. RBP is connected to the left ventricle at the inlet, and the aorta at the outlet. The differential pressure across RBP (ΔP), i.e.(PA−PLV), is accessible through other long term reliable signal, such as the position of the impeller of a magnetically suspended blood pump [1], or through the speed and the current measurement together [23]. The left ventricular pressure varies greatly from the systole to the diastole, typically at a much larger magnitude than the aortic pressure. In diastole, particularly at the beginning of diastole, the left ventricular pressure is very small, so(PA−PLV)at this instance is very close to the value ofPA. The combination of an upper limit ofΔPand a lower limit of ΔP was found to be able to extract the diastolic portion [3] ΔPdiastole. The resultant ΔPdiastolewas processed through a 10-point moving-average filter to obtain a continuous signal ΔPmodified. Because of the delay effect of moving average filter, a lag is expected in this feedback signal as compared toPA. So, in this paper, the objective of physiological controller is formed as a tracking problem, to make the mean aortic pressurePAobtained through ΔPmodifiedto track a specified reference signal. The beating of natural heart is viewed as the disturbance to the circulation system. The magnitude of this disturbance is determined by the heart rate and the contractility (i.e. strength) of the natural heart.In this paper, the reference signal is assumed to be constant, equal to 90mmHg. This value is selected based on previous simulation study of heart failure patient in rest condition considering three factors: (i) within the normal physiological range, between 80mmHg and 120mmHg, (ii) the resulting total peripheral flow falls within the normal physiological range, between 5L/min to 6L/min, and (iii) the aortic flow from the sick natural heart is small, but not equal to 0 to avoid the fusion of aortic valve due to the closure for extended period. Since the focus of this paper is to compare the performance between the adaptive controller and ADRC, constant reference signal was selected to for the purpose of simplification. In reality, the blood pressure of a healthy person may be changing in different scenarios, such as sleep, or exercise.In summary, the objective of the physiological controller in this paper is to regulate the pump current I so that ΔPmodifiedwill track the reference value. The feedback signal used by the controller is ΔPmodified.The authors have developed a linear state space model of the human circulation system with the assistance of RBP [1] to approximate the response of human circulation system, which is given as follows:(3)ẋ=Ax+B1Q+B2δP+B3δm+B1Γ(x1)y=CxwhereA=[−1CLVdRV׳1CLVdRV׳1CA1CVRV′−1CVRV׳1CA+1CV0−1L−TPRL],B1=[−(1CLVd+1CA)−1CA0],B2=[1CLVdRV׳−1CVRV׳0],B3=[001L],C=[−100].This model was demonstrated to track the average value of aortic pressure, but not the instantaneous value. Also, in this model, the peripheral resistance TPR is a time-varying parameter, which may change by more than 50%.In this model, the system elements are: CdLV, compliance of left ventricle during diastole; CA, compliance of systemic arteries; CV, compliance of systemic vein and right atrium; TPR, total peripheral resistance (equivalent resistance accounting for all resistance from the aorta to the systemic vein and right atrium in Fig. 1); L, blood inertia in peripheral circulation; RV’, equivalent resistance of pulmonary vein and left atrium, an artificial parameter which is related to true resistance of pulmonary vein and the pathological and exercise status of natural heart; δm, the pressure disturbance generated by the muscle pump function in exercise [2]; δP, pressure disturbance generated by pulmonary circulation; Q, the pump flow to the circulation system; andΓ(x1), the flow from the natural heart. The states are defined as: x1=PLV− PA, x2=PV− PA, x3=TPF where PLVis the left ventricular pressure; PAis the aortic pressure; PVis the central venous pressure; and TPF is the total flow rate to the circulation system.Eqs. (3) and (1c) together form a 3rd order state space model representation of the circulation system plus RBP used for adaptive estimator and controller design.(4)ẋ=(A+B1Cβ1)x+B1β2*I+B2׳δP+B3δm+B1Γ(x1).y=CxIn Eq. (4), TPR can change dramatically by more than 50% in different exercise states, RV’value may also change within 20% [1]. The rest of the parameters in Eq. (4) are fixed. δm, the pressure disturbance generated by muscle pump function in exercise, is only present in exercise; δPis the pressure disturbance generated by the pulmonary circulation system. δP, δmandΓ(x1)are not accessible. This state space model represented by Eq. (4) is used to develop the adaptive controller, whose scheme is shown inFig. 3. It is worth pointing out that all states of Eq. (4) have physiological meaning, thus may be useful for medical purpose.To regulate the pump current I to meet the proper perfusion, an adaptive estimator was developed online for the time-varying parameter TPR.1.Parameter estimation: From Eq. (4), it follows that:(s3+a2s2+a1s+a0)y(s)=(b2s2+b1s+b0)I(s)(5)+(b2Ps2+b1Ps+b20P)δP(s)+(b2ms2+b1ms+b0m)δm(s)+(b2s2+b1s+b0)Γ(s)for some coefficients aiand bi, bipand bim, i=0, 1, 2. The coefficients of biare determined by the value of TPR. In Eq. (5), δP, δmandΓ(x1)are ignored in the final controller design and the estimation of TPR because they are not accessible.Filtering both sides of Eq. (5) by a 3rd order low-pass filter F(s)=1/Λ(s) with the cutoff frequency of 5rad/s, and arranging the resulting terms, we can derive the parametric equation(6)θ*∅(s)=z(s)forθ*=TPRand some functions∅(s)andz(s)whose denominators are Λ(s) and numerators are the combinations of y(s) and I(s).The estimation error , where θ(t) is the estimator of θ*, and use the following adaptive law to update the estimate θ(t):(7)θ̇(t)=−γϵ(t)∅(t)1+∅2(t),γ>0State observer: The state observer structure for the estimatex^ofx=[x1x2x3]Tin Eq. (4) is a standard one, as given in Eq. (8), with all parameters but TPR known, and δm, δP, andΓ(x1)in Eq. (4) ignored.(8)x^̇=(A+B1Cβ1)x^+B1β2*I+L(y−y⌢)y^=Cx^The adaptive estimate of TPR obtained online from the previous parameter estimation procedure is used to update the value of TPR in Eq. (8), leading to an adaptive observer.Optimal PI controller: The controller developed here is a PI type of controller, as given byKIand K (integral gain, feedback gain vector) both were calculated from an optimal control design procedure to minimize the energy of a weighted function of control output and tracking error, given asW=∫(e2S+I2R)dt. S and R are the selected weighting factors for the ΔP tracking error and the control current I, respectively. The estimate of TPR is used to replace the unknown TPR in the optimal control and the state observation, leading to an adaptive control scheme.The tuning parameters for the Adaptive controller include the adaptive gain γ in Eq. (7), weighting factor ratio S/R, desired poles locations for the observer (3 by 1 vector) in Eq. (8), totally 5 design/tuning parameters. The implementation of the adaptive controller algorithm requires the solution of Riccati equation and inverse of 3 by 3 matrix in each time step, both of which require intense computation.ADRC offers a new and inherently robust controller building block that requires very little information of the plant. By using the extended state observer, this control algorithm actively estimates and compensates for the total disturbance, including internal dynamics and external disturbances, in real time. The estimated information is then canceled in the control law such that the system behaves as a cascade integrator. Such strategy leads to the ditching of the prevailing model requirement in the current design. That is, instead of depending on the model of the plant, the controller draws the information needed to control the plant from the ESO. The ADRC-based control design is shown inFig. 4.Consider expressing human circulation system with RPB in the frame work of ADRC as(10)y⃛=f(t,y,ẏ,y¨,İ,I¨,w)+bdIwhere y is the output (i.e. ΔP); I is the control signal; and bdis the coefficient of the control signal. The value of bdis set to the nominal value of b0 in Eq. (5) using the value of TPR in rest condition. w is an disturbance, which accounts for the total effect of ignored pump dynamics in Eq. (1c), δP, δm, the disturbance caused by the beating of natural heartΓ(x1), and the variation of b0 due to change of TPR in Eq. (5).f(t,y,ẏ,y¨,İ,I¨,w)accounts for all other factors in Eq. (5) except the control signal. Eq. (10) demonstrates a third order dynamic relation between the input I and the output ΔP, which is consistent with the dynamic relation described by the third order state space model in Eq. (4).Letξ1=y,ξ2=ẏ,ξ3=y¨,ξ4=f(t,y,ẏ,y¨,İ,I¨,w)andξ=[ξ1ξ2ξ3ξ4]T. Assuming f is differentiable, the augmented state space form of (9) is(11){ξ̇=Adξ+BdI+Edhy=CdξwhereAd=[0100001000010000],Bd=[00bd0],Cd=[1000],andEd=[0001].In contrast to Eq.(4) whose states all have physiological meaning, the states of Eq. (11) do not have direct physiological meaning except for ξ1. ξ1 is the difference between the aortic pressure and left ventricular pressure, ξ2 is the speed of change of ξ1, ξ3 is the acceleration of change of ξ1, ξ4 is the combined effects of everything else of cardiovascular system. The introduction of ξ2,ξ3,ξ4 is necessary for the framework of ADRC controller design, but they do not need to be monitored.Note thatξ4=f(t,y,ẏ,y¨,İ,I¨,w)is the augmented state andh=ḟ(t,y,ẏ,y¨,İ,I¨,w)is usually unknown but bounded. The idea is that, based on (11), a state observer(12){ξ^̇=Adξ^+BdI+Ld(y−y^),y^=Cdξ^,whereLd=l1l2l3l4Tis the observer gain vector, is designed. The observer gains are chosen such that the characteristic polynomials4+l1s3+l2s2+l3s1+l4is Hurwitz. For tuning simplicity, all the observer poles are placed at−ωo. It results in the characteristic polynomial of (12) to be(13)λo(s)=s4+l1s3+l2s2+l3s1+l4=(s+ωo)4whereωois the observer bandwidth of the ESO andLd=[4ωo,6ωo2,4ωo3,ωo4]T.Generally, the larger the observer bandwidth is, the more accurate the estimation will be. However, a large observer bandwidth will increase noise sensitivity. Therefore a proper observer bandwidth should be selected in a compromise between the tracking performance and the noise tolerance.With a well behaved observer, the observer stateξ^4will closely trackξ4. By canceling the effect of f usingξ^4, ADRC actively compensates for f in real time. The ADRC control law is given by(14)I=k1(r−ξ^1)+k2(ṙ−ξ^2)+k3(r¨−ξ^3)−ξ^4+r⃛bdwhere r is the reference signal andk1k2as well ask3are the controller gain parameters selected to makes3+k3s2+k2s1+k1Hurwitz. For simplicity, letk1=ωc3,k2=3ωc2andk3=3ωc, whereωcis the controller bandwidth. The closed-loop system for RBP becomes(15)y⃛=k1(r−ξ^1)+k2(ṙ−ξ^2)+k3(r¨−ξ^3)+(f−ξ^4)+r⃛.In (15), the term(f−ξ^4)is almost negligible for the well-designed ESO andk1(r−ξ^1)+k2(ṙ−ξ^2)+k3(r¨−ξ^3)+(f−ξ^4)+r⃛represents a PD controller with a feedforward term.In practice, the controller bandwidth,ωc, is tuned based on how fast and steady we want the output to track the set point. A large controller bandwidth generally increases the response speed but it may push the system to its limit, leading to oscillations or even instability. Thus the controller bandwidth should be adjusted based on the competing requirements of performance and stability margin, together with noise sensitivity. In addition, a large controller bandwidth usually increases the magnitude and rate of change in control signal, and therefore the operation cost. The observer is tuned in a similar way: adjusting its bandwidth,ωo, for a tradeoff between tracking performance and noise sensitivity. For the RBP controller,ωcdoes not need to be high because the human circulation system responding speed is low.The primary reason for this particular parameterization and tuning method is practicality: the observer and feedback gains must be easily tunable by most engineers, who are usually familiar with the concept and implications of bandwidth. It is advantageous that engineers could use a completely new design method without losing the critical insight gained from classical control: frequency response.The convergence for the estimation error of the ESO and the closed-loop tracking error of ADRC is shown in [20,21].

@&#CONCLUSIONS@&#
