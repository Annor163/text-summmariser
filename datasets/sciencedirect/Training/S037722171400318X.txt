@&#MAIN-TITLE@&#
Solving the logit-based stochastic user equilibrium problem with elastic demand based on the extended traffic network model

@&#HIGHLIGHTS@&#
This paper proposed a novel model for solving the SUE problem with elastic demand.The SUE problem with elastic demand will be transformed into that with fixed demand.The SUE problem with elastic demand will be converted to a convex programming.A predictor corrector interior point algorithm can be employed to solve it.

@&#KEYPHRASES@&#
Stochastic user equilibrium,Elastic demand,Extended traffic network,Predictor–corrector interior point algorithm,Computational complexity,

@&#ABSTRACT@&#
This paper proposes a novel extended traffic network model to solve the logit-based stochastic user equilibrium (SUE) problem with elastic demand. In this model, an extended traffic network is established by properly adding dummy nodes and links to the original traffic network. Based on the extended traffic network, the logit-based SUE problem with elastic demand is transformed to the SUE problem with fixed demand. Such problem is then further converted to a linearly constrained convex programming and addressed by a predictor–corrector interior point algorithm with polynomial complexity. A numerical example is provided to compare the proposed model with the method of successive averages (MSA). The numerical results indicate that the proposed model is more efficient and has a better convergence than the MSA.

@&#INTRODUCTION@&#
Traffic assignment (TA) is one of the fundamental problems in research of transportation science. Since Wardrop (1952) presented two famous assignment principles, most research on assignment models (Florian, 1977) has been done following Wardrop’s user equilibrium (UE) principle. In the UE principle, all travelers are assumed to have perfect information about the service level of the network, and hence always choose the shortest travel-time route from origin to destination. Since each traveler may perceive a different travel time for the same route, Daganzo and Sheffi (1977) extended the UE principle to the stochastic user equilibrium (SUE). In the SUE, travelers’ route choice behavior is described through more realistic behavioral models, which take into account several sources of uncertainty by assuming the perceived utility of travel alternatives as jointly distributed random variables. To further investigate the behavior of a real-world traffic system, two types of SUE models, namely the logit-based SUE and probit-based SUE, have been proposed in literature. The users’ pre-trip perceived travel times in these two SUE models are follow by Gumbel and normal distributions, respectively. The probit-based SUE is a better representative of the SUE principle in nature, but has difficulty in estimating the stochastic network loading (SNL) (Liu & Meng, 2013). The logit-based SUE has the advantage of relatively low computation cost, especially for large-scale networks, and hence has been widely used by researchers.Furthermore, according to SACTRA (1994), there are a variety of possible behavioral responses to increased congestion. Highway capacity reduction, such as through the implementation of a bus priority scheme, is likely to result in changes in model choice, time of travel and destination choice. As the fixed demand assumption leads to an underestimation of benefit, the SUE model or SUE with elastic demand is becoming an important issue in transportation network analysis and has recently attracted increased awareness (Maher, 2001). Therefore, this study focuses on the logit-based SUE with elastic demand.Although the existence and uniqueness of the solution to SUE problems have been theoretically proven by continuity and monotonicity of cost functions (Cascetta, 2009), a significant amount of research effort is still dedicated in developing efficient approaches to SUE and its extensions. Among these approaches, a well-known solution, proposed by Sheffi and Powell (1982), relies on the method of successive averages (MSA). Although MSA has the disadvantage of slow convergence due to the predetermined sequence of step size, many variations of MSA have been developed for SUE problem and its extensions. Cantarella (1997) presented a theoretical cost averaging (CA) algorithm and demonstrated its convergence for the asymmetric SUE problem associated with elastic demand. Compared with MSA, the CA algorithm updated link travel time rather than link flow at each step with predetermined step sizes.Regarding the problem of SUE with elastic demand, Maher and Hughes (1998) tackled it as a bi-level programming problem. They proposed feasible descent direction algorithms to move iteratively along two separate search directions: one for SUE and the other for elastic demand. Maher et al. also incorporated a Balanced Demand Algorithm (BDA) into a program to search SUE point with elastic demand for a network. Along with the program, the problem of SUE with elastic demand was reduced to a simple modification of a SUE model when the demand was in balance with the flows. Maher and Zhang (2000) further investigated the properties of the objective function of such a program by establishing its local convexity near the optimum. Zhou (2003) proposed another method based on the variation inequality (VI) formulation of SUE with elastic demand.More recently, in order to address the large-scale probit-based asymmetric SUE problem with elastic demand, Meng et al. (2013) developed two hybrid prediction-correction (PC) cost averaging (CA) algorithms using two variational inequality (VI) models coupled with the Monte Carlo simulation-based method. Furthermore, they adopted the distributed computing approaches on the workload partition to accelerate the Monte Carlo simulation method (Liu & Meng, 2013). Due to the large scale of real-world traffic networks, the computational complexity of solving SUE problems has to be considered. An extensive literature review indicates that few studies have been devoted to the development of efficient approaches to the SUE problems with elastic demand in large-scale networks.This study aims to establish an efficient SUE assignment model with polynomial complexity. The Mizuno–Todd–Ye (MTY) predictor–corrector interior point algorithm (Mizuno et al., 1993), which hasOnLiteration complexity, is known as the most efficient interior point method for linear programming. Ye et al. (1993) proved that the duality gap of classical MTY algorithm converged to zero quadratically, which indicated that MTY algorithm had superlinear convergence. Taking the advantage of computational efficiency, a modified MTY predictor–corrector interior point algorithm is proposed to address the logit-based SUE with elastic demand in this study.This study presents a novel extended traffic network model to solve the logit-based SUE with elastic demand. In this model, an extended traffic network is established by properly adding dummy nodes and links to the original traffic network. Based on the extended traffic network, the SUE problem with elastic demand is firstly transformed into the SUE problem with fixed demand. Such problem is then further converted to a linearly constrained convex programming (Lam, Willam, & Zhou, 1999), which is addressed by a modified MTY predictor–corrector interior point algorithm with polynomial complexity.The rest of this paper is organized as follows. Section 2 is devoted to problem description. Section 3 describes the extended network of the SUE problem with elastic demand by which the studied problem is converted into the logit-based SUE problem with fixed demand. Section 4 gives details in addressing the logit-based SUE problem. In order to demonstrate the feasibility and efficiency of the proposed extended traffic network model, a numerical example is presented to compare its performance with the MSA in Section 5. Finally, conclusions are summarized and some directions for future work are discussed in Section 6.First of all, the notations and descriptions for the stochastic user equilibrium problem with elastic demand are as given. Let G=(N,A) be a general directed traffic network defined by a set N of nodes and a set A of directed links. Each link a∈A associates with a flow-dependent cost ca(xa), which is a differentiable and monotone increasing function with respect to flowxaon link a. Wdenotes the set of origin–destination (O–D) pairs and Pwrepresents the set of all paths between O–D pair w∈W. Dwis the traffic demand of O–D pair w∈W.fkwdenotes the flow on path k∈Pw.Ckwandckware the perceived travel cost and the actual travel cost of path k∈Pw, respectively.The following equations of flow conservation will be held:(1)xa=∑w∈W∑k∈pwδakfkw,(2)∑k∈pwfkw=Dwwherefkw⩾0,xa⩾0,Dw⩾0,∀k,w,a, andδak=1if pathkuses linka0otherwise.Assume the probability of path k∈Pwbeing chosen ispkw=PrCkw⩽Ck′w,∀k′∈Pw, where-Ckw=-θckw+εkw, andεkwis a random term associated with the route under consideration. Supposeεkwis identically and independently distributed (i.i.d.) Gumbel variable. Then the choice probabilities are defined as the logit route choice probabilitiespkw=e-θckw∑∀k′∈Pwe-θck′w, therefore a logit-based SUE model is obtained.When SUE is reached, the path flows will satisfyfkw=Dwpkw=Dwe-θckw∑∀k′∈Pwe-θck′w, whereckwdenotes the actual travel cost of path k∈Pwunder path flowfkw,k∈Pw,w∈W.Now assume that the traffic demand Dwis elastic and takes the form(3)Dw=Gw[Sw(cw)]In the equation above, Gw(·) is a given continuously and monotonically decreasing function, which usually has a linear or exponential form as the literature suggests; Sw(cw) is the expected minimum travel cost for O–D pair w, and we have(4)Sw(cw)=Emink∈PwCkw=-1θln∑k∈Pwe-θckw.Furthermore, in order to address the logit-based SUE with elastic demand, we only consider the case of additive costs. Since the additive cost assumption allows the traffic equilibrium problem to be formulated as a mathematical programming, such problem can be solved without the need to store paths. Thus,ckwis as follow:ckw=∑a∈Aδakca(xa),∀w∈W,∀k∈PwLetD‾wdenotes the maximum value of Gw(·). It can be viewed as the maximum traffic demand possible.In order to solve the logit-based SUE problem with elastic demand, this problem is firstly transformed into an equivalent logit-based SUE problem with fixed demand, which has the same solution as the original problem. Such process is described as follows:First, a dummy upstream node is added to each origin node and regarded as one origin node of the extended traffic network. Similarly, a dummy downstream node is added to each destination node and regarded as one destination node of the extended traffic network.Next, dummy links are added that not only connect all new O–D pairs in the extended traffic network, but also connect the dummy origin nodes and dummy destination nodes to the corresponding original ones.Finally, performance functions for the new links in the extended traffic network are established as follows:(1)The performance values of the new links between the dummy ones and the original ones are set as zero.The performance functions of the new link between O–D pair w in the extended traffic network are given by:(5)tkwfkw=Gw-1D‾w-fkw-1θlnfkwD‾w-fkwwhereD‾wdenotes the fixed traffic demand of O–D pair w in the extended traffic network.An example of the transformation can be illustrated by the figures below. Fig. 1is the well-known Nguyen–Dupuis network (Nguyen & Dupius, 1984). It has 13 nodes, 19 links, and four O–D pairs, namely 1–2, 1–3, 4–2, and 4–3. Fig. 2shows the extended traffic network with four new O–D pairs, namely 14–16, 14–17, 15–16, and 15–17.Now, it will be proved in Theorem 1 that the solution of the logit-based SUE with fixed demand in the extended traffic network is also the solution of the original problem.Theorem 1The problem of the logit-based SUE with fixed demand in the extended traffic network is equivalent to the corresponding logit-based SUE with elastic demand in the original traffic network.For a given O–D pair w∈W, k′ denotes the newly added path which goes directly from origin to destination. Then the solution of SUE for the extended traffic network with fixed demand satisfies(6)fk′w=D‾we-θtk′w∑k∈Pw/k′e-θckw+e-θtk′wwheretk′wis the corresponding travel time of path, k′ andckwrepresents other path’s travel times of O–D pair w. Since the values of the link performance functions of links between the new origin (destination) nodes and the old origin (destination) nodes are assumed to be zero, it is obvious thatckwis the travel time of corresponding path k∈Pwin the original traffic network.From Eqs. (5) and (6), it yields(7)fk′w=D‾we-θGw-1D‾w-fk′w+lnfk′wD‾w-fk′w∑k∈Pw/k′e-θckw+e-θGw-1D‾w-fk′w+lnfk′wD‾w-fk′wthusfk′w∑k∈Pw/k′e-θckw+e-θGw-1D‾w-fk′wfk′wD‾w-fk′w=D‾we-θGw-1D‾w-fk′wfk′wD‾w-fk′w.That is(8)e-θGw-1D‾w-fk′w=∑k∈Pw/k′e-θckw.Finally, we obtain(9)fk′w=D‾w-Gw-1θln∑k∈Pw/k′e-θckw.Eqs. (3), (4), and (9) indicate that the solutionfk′wof SUE in the extended traffic network is equal to the difference between the maximal traffic demand and the value of elastic demand function for O–D pair w. Thus, the sum of the other path flows would be equal to the value of elastic demand function.For other path flowsfkwof O–D pair w, they satisfyfkw=D‾we-θckw∑k∈Pw/k′e-θckw+e-θtk′w. Substituting Eq. (5) fortk′w, we can obtain(10)fkw=D‾we-θckw∑k∈Pw/k′e-θckw+e-θGw-1D‾w-fk′w.From Eqs. (8)–(10), we have(11)fkw=D‾w·e-θckw∑k∈Pw/k′e-θckw+∑k∈Pw/k′e-θckw·D‾w-Gw1θln∑k∈Pw/k′e-θckwGw1θln∑k∈Pw/k′e-θckwIt follows that(12)fkw=Gw-1θln∑k∈Pw/k′e-θckwe-θckw∑k∈Pw/k′e-θckwEq. (12) indicates thatfkwis identical to the solution of SUE in the original traffic network. In this sense, the two problems are equivalent.The proof of Theorem 1 is completed.□Since the dummy link performance functions defined in the extended traffic network satisfy the symmetry condition, the solution of the logit-based SUE in the extended traffic network can be determined by the following equivalent minimization programming:(13)min∑w∈W∑k∈Pw/k′fkwlnfkw-1+∑w∈Wfk′wlnfk′w-1+θ∑a∈A′∫0xaca(x)dx+θ∑w∈W∫0fk′wtk′(x)dxs.t.xa=∑w∈W∑k∈Pw/k′δak·fkw,∀a∈A′∑k∈Pw/k′fkw+fk′w=D‾w,∀w∈Wfkw⩾0,fk′w⩾0,∀w∈W,∀k,k′∈Pwwhere A′ is the set of links in the extended traffic network which belong to the original network.Proposition 1The minimization programming(13)is equivalent to the logit-based SUE with elastic demand defined with Eqs.(3) and (4).The Lagrangian function of (13) is:(14)L=∑w∈W∑k∈Pw/k′fkwlnfkw-1+∑w∈Wfk′wlnfk′w-1+θ∑a∈A′∫0xaca(x)dx+θ∑w∈W∫0fk′wtk′(x)dx-∑a∈A′ua·xa-∑w∈W∑k∈Pw/k′δak·fkw-∑w∈Wvw·D‾w-∑k∈Pw/k′fkw-fk′w-∑w∈W∑k∈Pw/k′mkw·fkw-∑w∈Wnk′w·fk′wThe K-K-T conditions of (13) are as follows:(15a)∂L∂xa=θ·ca(xa)-ua=0(15b)∂L∂fkw=lnfkw+∑a∈A′δak·ua+vw-mkw=0(15c)∂L∂fk′w=lnfk′w+θ·tk′fk′w+vw-nk′w=0(15d)ua·xa-∑w∈W∑k∈Pw/k′δak·fkw=0(15e)vw·D‾w-∑k∈Pw/k′fkw-fk′w=0(15f)mkw·fkw=0(15g)nk′w·fk′w=0From Eqs. (15a)–(15f) and (15g), it follows that(16)lnfkw+θ∑a∈A′δakca(xa)+vw=0lnfk′w+θ·tk′fk′w+vw=0For ∀w∈W, we have(17)fkw=e-vw·e-θ·ckwfk′w=e-vw·e-θ·tk′fk′wSumming all path flowsfkwof O–D pair w, we obtain that(18)e-vw·∑∀k∈Pw/k′e-θckw+e-θ·tk′fk′w=D‾wThat is(19)e-vw=D‾w∑∀k∈Pw/k′e-θckw+e-θ·tk′fk′wFrom Eqs. (17) and (19), we can conclude that the optimal solution obtained (13) satisfies the Logit assignment rule for the extended traffic network with fixed demand. Following Theorem 1, we can say that the minimization programming (13) is equivalent to the discussed logit-based SUE with elastic demand.The proof of Proposition 1 is completed.□According to Theorem 1 and Proposition 1, the logit-based SUE problem with elastic demand can be successfully transformed into the mathematical programming, which is a linearly constrained convex programming as shown in (13).Proposition 2Iftkwfkwdefined in Eq.(5)is monotone increasing, the minimization programming of(13)is a convex programming with linear constraints and has a unique solution.The Hessian matrix of the objective function (13) can be given as below.(20)⋱1fkw⋱1fk′w+θ·tk′′fk′w⋱θ·ca′(xa)From the constraints of (13), we havefkw>0andfk′w>0for ∀w∈W, ∀k, k′∈Pw.It is obvious that the Hessian matrix (20) is positive definite, therefore the objective function of minimization programming is strictly convex. Also, the constraints of (13) are linear, thus (13) is a convex programming with linear constraints. Moreover, the uniqueness of solution can be guaranteed by the strict convexity of the objective function (13).This completed the proof of Proposition 2.□The idea behind the MTY type algorithms asserts that iterations in the neighborhoods of the central path reduce the duality gap which is the difference between the objective value of the optimal primal solution and that of the optimal dual solution. If the predictor–corrector iterations reduce the duality gap at least by a constant factor and hold the iteration points in the narrow neighborhood of the central path, the duality gap will converge to zero with polynomial iteration complexity and the approximate solution is obtained. Therefore, the original MTY algorithm has been modified to address convex programming, the linear complementarily problem (LCP) (Fang & Yu, 2011) and so on. Due to their computational efficiency computation, we employ one of the modified MTY predictor–corrector interior point algorithms to solve the logit-based SUE problem with elastic demand.Firstly, the problem of (13) is formalized to a standard linearly constrained convex programming as follows:(P)minf(x)s.t.Ax=b,x⩾0Its dual (DP) is:(DP)max(f(x)-(∇f(x))Tx+bTy)s.t.ATy+z-∇f(x)=0,z⩾0where x∈Rn, A∈Rm×n, Rank (A)=m, T denotes transpose. As indicated in Proposition 2, ∇2f(x) is a positive definite matrix and f(x) is strict convex.We denote S={(x,y,z)∣Ax=b, AT y+z−∇f(x)=0, x⩾0, z⩾ 0}, and define its interior region as S+={(x,y,z)∣ (x,y,z)∈S, x>0, z>0}. We also assume S+≠Φ, and denote X=diag (x), Z=diag (z), e=(1,1,…,1).For every (x,y,z)∈S+, letμ=xTznwhich can form a path of centers, a neighborhood of the path of centers is defined asρ(β)=(x,y,z)∈S+‖Xz-μe‖⩽βμ,μ=xTzn, where β>0 and ∥·∥ represents the Euclidean norm. In our algorithm, we setβ=14to guarantee the polynomial complexity of the algorithm (Maher & Hughes, 1998). The procedure of the modified MTY predictor–corrector interior point algorithm (PCIP) is presented as follows:Step 0: Choose an initial pair of interior point(x0,y0,z0)∈ρ14, and set the accuracy parameter ε>0 and k=0.Step 1: IfxkTzkn⩽ε, then stop the iteration and output.Step 2: Compute the predictor-direction (Δxp,Δyp,Δzp) by solving the system:(21)AΔxp=0ATΔyp+Δzp-∇2f(xk)Δxp=0ZkΔxp+XkΔzp=23μke-XkzkStep 3: Set(xˆk,yˆk,zˆk)=(xk,yk,zk)+Qk(Δxp,Δyp,Δzp), whereQk=min18n,μk8ΔXpΔyp.Step 4: Setr=1-142n, and compute the corrector direction (Δxc,Δyc,Δzc) by solving the system:(22)AΔxc=0ATΔyc+Δzc-∇2f(xˆk)Δxc=0Z^kΔxc+X^kΔzc=rμˆke-X^kzˆkStep 5: Set(xk+1,yk+1,zk+1)=(xˆk,yˆk,zˆk)+(Δxc,Δyc,Δzc), then update k=k+1 and return to Step 1.Theorem 2If the initial point(x0,y0,z0)∈ρ14and the sequence{(xk,yk,zk)}generated by the algorithm are satisfied, then the algorithm hasOnLiteration complexity and is linearly convergent.The presented algorithm is identical to the algorithm proposed by Yu et al. (2005). Therefore, Theorem 2 can be proved in a similar way. The details of the proof can be found in the work of Yu et al. (2005) and Fang and Yu (2011).According to the proof of Theorem 2 in the paper of Yu et al. (2005), the duality gapμkin the modified MTY predictor–corrector interior point algorithm can be reduced by a constant factor1-27142nin each iteration, which can guarantee theOnLiteration complexity and linear convergence for the algorithm.This completed the proof of Theorem 2.□In this section, the Nguyen–Dupuis network, as illustrated in Fig. 1, is adopted to validate the proposed novel extended traffic network model. In this numerical example, the elastic demand function is assumed to take the exponential form as(23)Dw=Gw[Sw(cw)]=D‾wexp(-β·Sw(cw))where β is the sensitive parameter reflecting the traffic demand with respect to the expected minimum travel cost of O–D pair w.From Eqs. (5) and (21), the dummy link performance function for links that directly connect the origin and destination in Fig. 2 is as follow:(24)tkwfkw=1βlnD‾wD‾w-fkw-1θlnfkwD‾w-fkwIn this numerical test, we set β=2 and θ=3.Table 1lists the maximum traffic demands for all O–D pairs and all effective paths of the extended Nguyen–Dupuis network is depicted in Fig. 2. In Table 1, 1(1,10,19) represents that path 1 is comprised by link 1, 10, and 19.In the original Nguyen–Dupuis network in Fig. 1, the following link travel time functions (Guo & Huang, 2009) are adopted(25)Ca(x)=Ua+VaxRa4,a∈Awhere Uaand Raare the free-flow cost and capacity of link a respectively, Vais a positive parameter. These parameters of the link cost functions are given in Table 2.To compare the convergence performance between our PCIP algorithm and MSA algorithm, two algorithms are coded in Matlab 7 and executed on a PC with Intel Core i73.3gigahertz processor and 4gigabyte of RAM. The test example, as shown in Fig. 1, is solved by the PCIP algorithm and MSA algorithm, respectively.Figs. 3 and 4depict the convergence trend of MSA algorithm and PCIP algorithm. In the numerical experiment, the stop criterion of MSA algorithm is set asεk+1=∑a∈Afak+1-fak2/∑a∈Afak⩽0.001. Fig. 3 indicates that the MSA algorithm terminates after 134 iterations. For the PCIP algorithm, the stop criterion is defined byεk=(xk)Tzkn⩽0.001. As shown in Fig. 4, the PCIP algorithm stops after 10 iterations. Although the tolerance errors defined in these two algorithms are different, it is clear that the PCIP algorithm provides a better convergence. Such good performance of the PCIP algorithm is due to the duality gap reduced by a constant factor in each step.According to the numerical results in Table 3, the obtained solution both satisfies the conditions of the logit-based SUE problem and is optimal for corresponding convex programming. Table 3 indicates that the PCIP algorithm offers a better solution with less computation time, as compared to the MSA algorithm. The lower computation cost of the RCIP algorithm is mainly because only two linear equation systems (21) and (22) need to be solved in iterations of the PCIP algorithm and the predictor steps in the PCIP algorithm can produce a larger convergence step with a constant factor in iterations.The numerical experiments indicate that the proposed extended traffic network mode can improve the computational efficiency for solving the logit-based SUE problem with elastic demand. Indeed, interior point methods, especially the class of MTY PCIP algorithms, are well-suited to address very large-scale optimization problems. In the proposed PCIP algorithm, only two linear equation systems need be addressed for obtaining the iterative directions. Therefore, this algorithm has polynomial computational complexity and its computation time does not increase dramatically even for large-scale SUE problems. To deal with these large-scale optimization problems, only two technique related issues need to be dealt with properly. The first, focusing on how to find an initial interior point to start the algorithm for the large-scale problem; the second centered how to solve large-scale linear equation systems effectively for obtaining iterative directions.

@&#CONCLUSIONS@&#
This paper has developed a novel extended traffic network model to solve the stochastic user equilibrium (SUE) problem with elastic demand. In this model, an extended traffic network is established by adding a dummy upstream node to each origin node and using dummy links to connect all new O–D pairs. Based on the extended traffic network, the studied problem is firstly transformed into the SUE problem with fixed demand. Such problem is then further converted to a linearly constrained convex programming, which is addressed by a predictor–corrector interior point algorithm with polynomial complexity.To validate the extended traffic network model, a test problem on the well-known Nguyen–Dupuis network is conducted. According to the numerical results, the obtained solution satisfies the conditions of test problems and is globally optimal. Furthermore, compared with the MSA algorithm, the proposed approach provides faster convergence speed and higher accuracy by taking advantage of the interior point algorithm. Although the proposed extended traffic network model provides a promising way to address the SUE problem with elastic demand, it still has some limitations for future research.Firstly, as one of path-based solution approach, our model requires explicit enumeration of the path choice set, which is truly time-consuming within large-scale networks. Since the logit-based SUE with elastic demand is converted to an equivalent logit-based SUE with fixed demand by extending the origin network with dummy nodes and links, the link-based solutions (Si et al., 2010) may be employed to avoid the difficulty of path enumeration.Secondly, as a multinomial logit (MNL) model, the logit-based SUE with elastic demand has the disadvantage of the MNL model in dealing with the problem of overlapping routes (Chen et al., 2012). To overcome such deficiency, some extensions of the MNL model, such as the C-logit (commonality factor-logit) (Cascetta et al., 1996) can be adopted to extend the proposed model, because C-logit deviates from multinomial logit only in the systematic part of the utilities and is equivalent to consider a path-specific cost component.Thirdly, the application of this study is also restricted by the additive cost assumption (Chen et al., 2001). But the proof of theorem 1 in this paper works entirely on the path costs, so the theorem 1 holds also if costs are non-additive in links. It means that we can transform a SUE with elastic demand into a SUE with fixed demand also when the costs have path-specific components. Furthermore, if a SUE problem using the specific non-additive path cost function can be proved to be equivalent to such a minimization problem that its objective function remains as a convex function, such as the length-based C-logit SUE model (Zhou, Chen, & Bekhor, 2012), our predictor–corrector interior point algorithm may be still applicable to it.Future research can focus on investigating the effectiveness of the proposed extended traffic network model in a variety of real-world networks. Some complex design problems in transportation systems, such as traffic network optimization, signal-control design, and toll design, can be addressed by the proposed model if they can be formulated as bi-level programming problems with SUE assignment as the second-level programming.