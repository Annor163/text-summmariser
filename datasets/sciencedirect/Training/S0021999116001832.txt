@&#MAIN-TITLE@&#
Third-order symplectic integration method with inverse time dispersion transform for long-term simulation

@&#HIGHLIGHTS@&#
We use the inverse time dispersion transform to the 3rd-order symplectic integration.It can greatly reduce the time-dispersion error, especially for long travel times.It is superior to the conventional 2nd- and high-order finite-difference methods.It allows the maximum temporal interval under stability conditions thus is efficient.We can obtain more accurate simulation results but with a lower computational cost.

@&#KEYPHRASES@&#
Inverse time dispersion transform,Time-dispersion error,Pseudospectral method,Symplectic integration method,Long-term simulation,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Seismic modeling is an important foundation for exploration seismology, and synthetic seismograms are helpful for understanding wave phenomena in complex media. High-accuracy seismic modeling schemes are essential for high-resolution seismic interpretations. Seismic modeling methods can be classified into three main categories: direct methods, integral-equation methods, and ray-tracing methods [1]. The direct methods are the most popular since they can handle complicated wave phenomena associated with various structures well. The direct methods include three main kinds: finite-difference (FD) methods [2–4], pseudospectral methods [5–8], and finite-element methods [9]. Some hybrid methods, such as spectral-element methods [10] and finite-volume methods [11] have also been developed to achieve a much higher accuracy in numerical simulations.For direct seismic modeling methods, both space and time variables need to be discretized. A large sampling interval of discretization would bring severe numerical dispersion error; in contrast, a small sampling interval could reduce the numerical dispersion error but would greatly increase the computational cost. Therefore, it is necessary to develop high accuracy methods that can employ course grids in both temporal and spatial discretizations. Conventional FD schemes for spatial discretization lead to space dispersion error when computing the space derivatives of the wave equations. A typical exhibition of the space dispersion error is that the high frequency components of the wavefields do not propagate exactly with the expected velocity [12]. Numerous methods have been developed to eliminate space dispersion: the high-order FD schemes [12–16], optimized FD operators [17–26], the flux-corrected transport technique [27–29], the nearly analytical discrete methods [30,31], the stereo-modeling methods [32], and the pseudospectral methods [5–8].Numerical discretization of temporal derivatives also introduces numerical artifacts, which are called time-dispersion error. The time-dispersion error is not as serious as the space dispersion error since it can be greatly reduced using a fairly small temporal interval. However, in the presence of long-term problems and large-scale models, a small temporal interval would tremendously increase the computational cost; for such cases, we have to use a large temporal interval to avoid overburdened computational cost. Unfortunately, a large temporal interval would introduce strong time-dispersion error as expected. For example, the second-order FD discretization have been widely used [33] due to its simplicity, but an extremely fine temporal interval is needed to minimize the time-dispersion error since its time-dispersion error is the most serious among all known methods.To cope with the time-dispersion error, various methods have been developed, such as high-order time FD schemes [12,34–37], the rapid expansion method [38–41], low rank methods [42,43], Fourier finite-difference methods [44–46], correction methods based on filter and interpolation [47–50], and time dispersion transforms [51,52] as reviewed below.Chen [34] presented three modeling schemes using high-order temporal discretization: the Lax–Wendroff method [1,12,53], the Nyström method [54–56], and the splitting method [57–59]. The splitting method is the same as the third-order symplectic integration method developed by Ruth [57]. Zhang et al. [35] and Zhang and Zhang [37] proposed a one-step extrapolation algorithm. This algorithm formulates the two-way wave equation as a first-order partial differential equation in time without suffering from numerical instability or time dispersion problems, which allows for a large temporal interval. However, their decomposition algorithm, optimized separable approximation [60], is expensive due to too many Fourier transforms [61].Fomel et al. [42] approximated the wave extrapolation operators using the low rank approximation of a matrix operator in the mixed space-wavenumber domain. This method reduces computational cost by optimally selecting reference velocities and weights [61]. Song and Fomel [44] developed a related method, the Fourier finite-difference method, by cascading a Fourier transform operator and an FD operator to form a chain operator. The Fourier finite-difference method may have an advantage in efficiency because it uses only one pair of multidimensional forward and inverse fast Fourier transforms per temporal interval. However, it does not offer flexible controls on the approximation accuracy [43].The rapid expansion method [39–41] incorporates Chebyshev polynomials during the approximation. This method employs many high orders for the temporal discretization (e.g., 8-order [40]) thus is suitable for large temporal intervals using concepts similar to the work presented by Tal-Ezer et al. [38]. Instead of using more terms in the expansion, Etgen and Brandsberg-Dahl [62] generalize the pseudospectral method to obtain pseudo-analytical solutions. They modify the Fourier transform of the Laplacian operator for the constant velocity model in an arbitrary number of space dimensions.The time dispersion has proven to be independent of both the velocity model and the space dispersion model; furthermore, it is predictable since it only depends on the frequency, temporal interval, and propagation time [50]. Therefore, the time dispersion could be handled separately from space dispersion, without considering velocity variations. Liu et al. [49] formulated an explicit time evolution scheme in the time–space domain by introducing a cosine function approximation, in which optimum stencils and least-squares coefficients are introduced. Stork [48] proposed that the time-dispersion error is fully predictable and can be removed with careful filtering after FD modeling. Time dispersion is fixed by applying a time variable filter and interpolation. Dai et al. [50] showed more details and extended the mathematical analyses on Stork's work. Li et al. [47] showed two post-propagation filtering schemes based on the method proposed by Stork [48], and this type of correction method does not affect the computational efficiency much.Wang and Xu [51,52] studied the time dispersion of pseudospectral methods and predicted it in theory. To remove the time-dispersion error, they proposed a time dispersion prediction algorithm (i.e. forward time dispersion transform) and correction algorithm (i.e. inverse time dispersion transform), which works for any order conventional time FD scheme. A relatively large temporal interval is allowed for wave propagation, which can greatly retain the computational efficiency while improving the accuracy [51].For long-term simulations in large-scale seismic exploration and seismology [34,63–65], the conventional FD schemes on discretizing the temporal derivatives are not structure-preserving thus are extremely difficult to avoid error accumulations caused by the time dispersion. We can solve wave equations using symplectic integration methods (or the Hamiltonian dynamical systems) to reduce error accumulations [57,66,67]. On the other hand, a large temporal interval that is approaching the stability upper limit would greatly improve the computational efficiency. However, symplectic integration methods still suffer from error accumulations at fairly long travel times when using large temporal interval.In this paper, we incorporate the inverse time dispersion transform (ITDT) [51,52] into the third-order symplectic integration method to reduce error accumulations when using a large temporal interval. We verify the superiority of our scheme by comparing it with the conventional second-order scheme and the rapid expansion method (8-order [40]). The computational efficiency is greatly improved since the ITDT allows a large temporal interval that is approaching the stability upper limit without suffering from error accumulations.The pseudospectral method is used since its error mainly arises from the temporal discretization [6], which is helpful for verifying the performance of different schemes on reducing the time dispersion. For simplicity we consider the 2D acoustic wave equation(1)∂2u∂t2=c2(∂2u∂x2+∂2u∂z2),whereu(x,z,t)is the wavefield, andc(x,z)is the velocity. The pseudospectral method for equation (1) reads [6](2)∂2u∂t2=c2{Fx−[−kx2Fx+(u)]+Fz−[−kz2Fz+(u)]},whereFx+andFz+are 1D forward Fourier transforms along the x- and z-directions, respectively;Fx−andFz−are 1D inverse Fourier transforms along the x- and z-directions, respectively;kxandkzare wavenumbers along the x- and z-directions, respectively.The symplectic properties guarantee that the numerical solution evolves in the same system as the solution of the original continuous differential equation; thus, the symplectic integration methods have a remarkable capability for long-term simulation [56]. The symplectic integration method consists of several substeps for one-step computation [57–59]. A typical symplectic integration method for equation (2) reads [34](3)vs(i)=vs(i−1)+piΔtc2{Fx−[−kx2Fx+(us(i−1))]+Fz−[−kz2Fz+(us(i−1))]},us(i)=us(i−1)+qiΔtvs(i),i=1,2,⋯,I,where the superscriptss(i)denote that the intermediate result,vs(i)is the intermediate variable, andus(0)=un≈u(nΔt),vs(0)=vn≈v(nΔt),us(I)=un+I≈u[(n+1)Δt], andvs(I)=vn+I≈v[(n+1)Δt]. There are I substeps needed to obtain the results from time level n to time leveln+1. The intermediate variablespiandqiare the coefficients of the symplectic integration method in the i-th substep.We concentrate on the third-order symplectic integration method (i.e.I=3), since it is better in accuracy than the second-order one for long-term problems [34]. The complete expression of equation (3) reads [34](4)vs(1)=vs(0)+p1Δtc2{Fx−[−kx2Fx+(us(0))]+Fz−[−kz2Fz+(us(0))]},us(1)=us(0)+q1Δtvs(1),vs(2)=vs(1)+p2Δtc2{Fx−[−kx2Fx+(us(1))]+Fz−[−kz2Fz+(us(1))]},us(2)=us(1)+q2Δtvs(2),vs(3)=vs(2)+p3Δtc2{Fx−[−kx2Fx+(us(2))]+Fz−[−kz2Fz+(us(2))]},us(3)=us(2)+q3Δtvs(3),wherep1,p2,p3,q1,q2, andq3are the coefficients for the third-order symplectic integration method. The values of the coefficientspiandqiwere first given by Ruth [57]. McLachlan and Atela [68] derived a new set of optimized coefficients based on the minimum truncation error method [69]. Iwatsu [70] gave two new solutions by modifying the solving algorithm that given by Ruth [57]. We call the coefficients given by Ruth [57], McLachlan and Atela [68], and Iwatsu [70] the following names: Ruth, MLA, Iwatsu-A, Iwatsu-B, respectively. These four sets of coefficients are shown in Table 1.We first make a simple variable transformv¯s(i)=Δtvs(i)in order to obtain polynomials in terms ofckΔt. Equation (3) can be expressed as(5)V¯s(i)=V¯s(i−1)−piΔt2c2k2Us(i−1),Us(i)=Us(i−1)+qiV¯s(i),i=1,2,⋯,I,whereV¯and U are the Fourier transformation ofv¯and u, respectively. Equation (5) is equivalent to(6)[V¯s(i)Us(i)]=[1−piΔt2c2k2qi1−piqiΔt2k2]︷Mi[V¯s(i−1)Us(i−1)],i=1,2,⋯,I,where the transformation matrix M is expressed as [70]M=M3M2M1=[1+a11υ2+b11υ4a12υ2+b12υ4+c12υ6a21+b21υ2+c21υ41+a22υ2+b22υ4+c22υ6],witha11=−(p2q1+p3q2+p3q1),b11=p2p3q1q2,a12=−(p1+p2+p3),b12=p1p2q1+p1p3q2+p1p3q1+p2p3q2,c12=−p1p2p3q1q2,a21=q1+q2+q3,b21=−(p2q1q3+p2q1q2+p3q2q3+p3q1q3),c21=p2p3q1q2q3,a22=−(p1q3+p2q3+p1q2+p1q1+p2q2+p3q3),b22=p1p2q1q3+p1p2q1q2+p1p3q1q3+p2p3q2q3,c22=−p1p2p3q1q2q3,υ=ckΔt=ωΔt, andω=2πf(f is the frequency). To obtain the eigenvalue λ of M, we can solve(7)λ2−tr(M)λ+det⁡(M)=0,wheretr(M)is the trace of matrix M, anddet⁡(M)is the determinant of matrix M. The solution of equation (7) is(8)λ=tr(M)2±[tr(M)2]2−det⁡(M),wheretr(M)=2−(p1q1+p2q1+p3q1+p1q2+p2q2+p3q2+p1q3+p2q3+p3q3)υ2+(p1p2q1q2+p2p3q1q2+p1p2q1q3+p1p3q1q3+p1p3q2q3+p2p3q2q3)υ4−p1p2p3q1q2q3υ6,anddet⁡(M)=1.The stability limit for equation (4) is obtained by requiring|λ|≤1. Table 2shows the stability upper limitsυ0of υ for five schemes: (a) the traditional pseudospectral method with the second-order time FD discretization [6], which is abbreviated as ‘2-order’; (b) Ruth; (c) Iwatsu-A; (d) Iwatsu-B; and (e) MLA. Obviously, the stability upper limit of Iwatsu-B is the smallest (even smaller than that of 2-order); and the stability upper limit of MLA is the largest among all of the five schemes.Denoting the amplitude of the wave propagation by a constant vector[A1,A2]T, the expression[V‾n,Un]Tin equation (6) can be decomposed into[V‾nUn]=[A1A2]exp⁡[i(ωt−kxx−kzz)].Similarly,[V‾n+1,Un+1]Tcan be decomposed into[V‾n+1Un+1]=[A1A2]exp⁡[i(ω(t+Δt)−kxx−kzz)]=[V‾nUn]exp⁡(iωΔt).Equation (6) can be rewritten as[V‾n+1Un+1]=M[V‾nUn]=λ[V‾nUn],thus, we haveλ=exp⁡(iωΔt). According toexp⁡(iωΔt)=cos⁡(ωΔt)+isin⁡(ωΔt)=cos⁡(ωΔt)+cos2⁡(ωΔt)−1,which has the same form as equation (8); thus, we can obtain the time dispersion of equation (4) as(9)cos⁡(ωΔt)=tr(M)2.If we consider ωΔt on the left side of equation (9) as a function ofθ(ω,Δt), it should be expressed as [51](10)θ(ω,Δt)=arccos⁡(tr(M)2).Fig. 1(a) shows the comparison between the phase shiftθ(ω,Δt)of different schemes and the theoretical phase shift ωΔt according to equation (10). When the circular frequency ω is low and the temporal interval Δt is small enough,θ(ω,Δt)is close to ωΔt. Fig. 1(b) shows the absolute time-dispersion error|θ(ω,Δt)−ωΔt|, which would grow up with an increasing temporal interval and circular frequency.Table 2 shows the time dispersion upper limits for different schemes when|θ(ω,Δt)−ωΔt|<5×10−4. Obviously, Iwatsu-A has the largest dispersion upper limit among the five schemes, as shown in Table 2. Meanwhile, we can see that MLA has a smaller time-dispersion error at high frequency and large temporal interval (whenωΔt≥1.85) than Iwatsu-A does, as shown in Fig. 1(b) and 1(c). Within the stability conditions, a coarse temporal interval always means less computational cost than a fine one does, especially for long-term simulations. The main drawback of using a coarse temporal interval is that we would encounter a serious problem associated with strong artifacts caused by the time dispersion. Here, we focus on eliminating the time-dispersion error caused by a coarse temporal interval; thus, we select MLA scheme since it has the largest stability upper limit among all four third-order symplectic integration schemes listed (i.e., Ruth, Iwatsu-A, Iwatsu-B, and MLA).Numerical modeling results usually suffer from time-dispersion error, especially for lone-term simulations. This time-dispersion error can be predicted by a forward time dispersion transform [51,52]; thus, we can reduce time-dispersion error by employing the ITDT after numerical modeling. As a post-processing method, the ITDT is applied to each numerically calculated time traceu(t)in three steps as follows [51]:(a)calculatingθ(ω,Δt)by equation (10) for valid frequencies;applying the transform:u′ˆ(ω)=∫u(t)e−i[θ(ω,Δt)/Δt]tdt;applying the inverse Fourier transform:u′(t)=12π∫u′ˆ(ω)eiωtdω,Step (b) can be regarded as a modified version of the Fourier transform, where ω is replaced byθ(ω,Δt)/Δt. As shown in equation (10),θ(ω,Δt)is the newly defined phase shift, which can truly reflect the influence caused by the temporal discretization; thus, the time-dispersion errorθ(ω,Δt)−ωΔtcan be reduced by using this modified transform. A taper function should be used on both ends of the trace to avoid Gibbs phenomena. Usually, a Hanning window with 200 points is good enough in empirical (i.e., 100 points for each end).We perform numerical experiments on a homogeneous medium. Three schemes are selected: MLA, 2-order, and the rapid expansion method (REM) [40]. The wave velocity of a square model isv=3000m/s. The spatial grid interval isΔx=Δz=50m, and the grid number is301×301. The source is a Ricker wavelet with a dominant frequency of 10 Hz, and the source is located atx=0mandz=0m. Using the velocityv=3000m/sand spatial grid intervalΔx=50m, we can obtain the maximum temporal intervals for MLA and 2-order based on the stability upper limits shown in Table 2. The maximum temporal intervals for MLA and 2-order are 16.97 and 7.50 ms, respectively. We test several different temporal intervals:Δt=1and7.5msfor 2-order,Δt=7.5and15msfor both MLA and REM. The total length of travel time for each method is 26 s.The time-dispersion error decreases as the temporal interval becomes smaller. This indicates that a smaller temporal interval can obtain more accurate simulation results [56]. To examine the results obtained by different methods, we performed numerical simulations by MLA with a temporal intervalΔt=1ms, which can be regarded as a theoretical reference to examine the accuracy using larger temporal intervals.We recorded a trace at a fixed point (x=−3000m,z=3000m). Figs. 2(a), 2(c), and 2(e)show the waveforms over the time around 4.5, 13.8, and 23.7 s, respectively; Figs. 2(b), 2(d), and 2(f) show the amplitude errors of different schemes using different Δt (where the reference waveform is obtained by MLA withΔt=1ms). For the same scheme, we can see that the time-dispersion error for a large temporal interval (e.g. MLA withΔt=15ms) is more apparent than a small temporal interval (e.g. MLA withΔt=7.5ms); meanwhile, the time-dispersion error becomes more and more serious with an increasing length of travel time. WhenΔt=7.5ms, 2-order is the poorest and REM is the best among all methods without applying the ITDT. WhenΔt=15ms, REM has visible time-dispersion error while MLA has apparent time-dispersion error, as shown in Fig. 2(f). 2-order does not work whenΔt=15mssince its maximum temporal interval according to the stability upper limit is only 7.50 ms. Even whenΔt=1ms, 2-order has fairly large time-dispersion error, which is worse than that of MLA withΔt=7.5ms; in contrast, REM has no visible time-dispersion error withΔt=7.5ms.Fig. 3shows the waveforms and the amplitude errors of different methods after applying the ITDT. Obviously, the time-dispersion error has been almost perfectly eliminated and the residual error is fairly weak, except for 2-order withΔt=7.5ms. MLA withΔt=15msafter applying the ITDT is more accurate than REM withΔt=15ms. The result of 2-order withΔt=7.5mscorrected by the ITDT show that 2-order, even applying the ITDT, is not suitable for long-term simulations with a coarse temporal interval. In contrast, the third-order symplectic integration methods applying the ITDT are more suitable for long-term simulations because of their low time-dispersion error.Fig. 4shows the snapshots obtained by MLA using different temporal intervals. Figs. 4(a) to 4(d) are the snapshots at 6, 12, 18, and 24 s, respectively. No visible time dispersion appears in the results obtained by temporal intervalΔt=1and 7.5 ms. In contrast, the time-dispersion error becomes apparent in the wavefield computed byΔt=15ms, as shown in Figs. 4(a3), 4(b3), 4(c3), and 4(d3). Fig. 5shows the snapshots obtained by MLA using different temporal intervals after applying the ITDT. Obviously, the time-dispersion error of MLA withΔt=15msis invisible after applying the ITDT.The records obtained on the ground surface further illustrate the performance of the ITDT on reducing the time-dispersion error for various schemes with different temporal intervals, as shown in Fig. 6. Obviously, we can see that MLA withΔt=15msinvolve heavy time dispersion especially at long travel times, since they are far away from the reference waveforms. In contrast, after we apply the ITDT to these numerical simulation results, the time-dispersion error can be significantly reduced. These numerical experiments show that the ITDT is a powerful tool for improving the numerical accuracy of the third-order symplectic integration method.Up to now, the ITDT has shown to be effective on reducing time dispersion. In terms of numerical implementation, however, half of the ITDT could not be implemented effectively since there is no fast algorithm available. Fortunately, the other half of the ITDT would be very fast since it can take advantage of the fast Fourier transform. In fact, it is not necessary to perform the ITDT on all traces. We can only perform the ITDT on those traces for output. This is convenient for numerical simulation since we seldom care about the whole volume of wavefields propagating in the entire model set. On the other hand, a larger temporal interval can be used after we apply the ITDT, which would save a large number of iteration times; thus, the total computational efficiency would be much higher for long-term problems. Fig. 7shows the comparison between the running times using different schemes with different temporal intervals before and after applying the ITDT. The results obtained by MLA withΔt=15msafter applying the ITDT are better than those obtained by 2-order withΔt=7.5msafter applying the ITDT, as shown in Figs. 3(b), 3(d), and 3(f); whereas, the running time of the former is smaller than that of the latter. In addition, with almost the same running time, the results obtained by MLA withΔt=15msafter applying the ITDT are better than those obtained by REM withΔt=15ms.We test the numerical simulation results for a heterogeneous medium, Marmousi model, which is popular in examining the accuracy of numerical methods for wave propagating in complex structures. In Marmousi model, the velocity contrast is strong and the multiples are significant. The velocity range of the complete Marmousi model is from 1500 to 5500 m/s. A Ricker wavelet with a dominant frequency of 10 Hz is used as source, and the source is located at the center of the model. With the grid sizeΔx=Δz=50m, numerical experiments show that apparent artifacts arise in low velocity regions, which would influence the time dispersion. Therefore, we clip the Marmousi model (as shown in Fig. 8) by leaving the minimum velocity of 2440 m/s. The grid number of the model is401×401. The maximum temporal intervals for MLA and 2-order are 9.25 and 4.09 ms, respectively. We useΔt=9and4msinstead for the convenience of numerical comparison. The waveform is recorded atx=1750mandz=1750m, and the total length of travel time is ∼210 seconds.As shown in Fig. 9, the time dispersion is serious at 200 seconds for 2-order withΔt=1and4ms. The ITDT can almost perfectly eliminate time-dispersion error whenΔt=1ms; meanwhile, it can significantly reduce time-dispersion error whenΔt=4ms. The results obtained by REM are accurate whenΔt=1msbut have obvious travel time error whenΔt=4ms. The time dispersion is strong for MLA withΔt=9ms, but it is almost perfectly corrected after applying the ITDT. Obviously, our method is feasible for such an ultra-long travel time, which is ∼40 times as big as general cases (∼5 seconds for most practical applications). This shows that our scheme is helpful for overcoming the time dispersion caused by coarse temporal interval at ultra-long travel time, for both primary and multiple arrivals.

@&#CONCLUSIONS@&#
The symplectic integration method is a traditional high-accuracy numerical scheme for modeling of the acoustic wave equation. However, it still suffers from the time-dispersion error for long-term simulation. We incorporate the inverse time dispersion transform (ITDT) into the third-order symplectic integration method to reduce its time-dispersion error. Both theoretical analyses and numerical experiments show that the ITDT is powerful and significant in eliminating time-dispersion error caused by the symplectic integration method, especially at long travel times. The ITDT allows us to use a much larger temporal interval which is close to the upper limit under stability conditions. This means that we can save a large number of iteration times by using the coarsest temporal interval without suffering from the time dispersion. Therefore, the total computational efficiency after using the ITDT only has a slight increase compared with the original method using small temporal interval and could be even faster.