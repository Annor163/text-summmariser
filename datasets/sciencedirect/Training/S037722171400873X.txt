@&#MAIN-TITLE@&#
The intercept term of the asymptotic variance curve for some queueing output processes

@&#HIGHLIGHTS@&#
Explicit analysis of variance curves of queueing output processes.Explicit analysis of the covariance between queue lengths and flows.Role of the deviation matrix in formulas related to Markovian Point Processes.

@&#KEYPHRASES@&#
Queueing,M/M/1/K queue,M/G/1 queue,Markovian Point Process,Output processes,

@&#ABSTRACT@&#
We consider the output processes of some elementary queueing models such as the M/M/1/K queue and the M/G/1 queue. An important performance measure for these counting processes is their variance curve v(t), which gives the variance of the number of customers in the time interval [0, t]. Recent work has revealed some non-trivial properties dealing with the asymptotic rate at which the variance curve grows. In this paper we add to these results by finding explicit expressions for the intercept term of the linear asymptote. For M/M/1/K queues our results are based on the deviation matrix of the generator. It turns out that by viewing output processes as Markovian Point Processes and considering the deviation matrix, one can obtain explicit expressions for the intercept term, together with some further insight regarding the BRAVO (Balancing Reduces Asymptotic Variance of Outputs) effect. For M/G/1 queues our results are based on a classic transform of D. J. Daley. In this case we represent the intercept term of the variance curve in terms of the first three moments of the service time distribution. In addition we shed light on a conjecture of Daley, dealing with characterization of stationary M/M/1 queues within the class of stationary M/G/1 queues, based on the variance curve.

@&#INTRODUCTION@&#
Many models in applied probability and stochastic operations research involve counting processes. Such processes occur in supply chains, health care systems, communication networks as well as many other contexts involving service, logistics and/or technology. The canonical counting process example is the Poisson process. Generalizations include renewal processes, Markovian Point Processes (see for example Latouche and Ramaswami, 1999, Section 3.5 or Asmussen, 2003, Section XI.1), or general simple point processes on the line (see for example Daley and Vere-Jones, 2003).Sometimes counting processes are used in their own right, while at other times they constitute components of more complicated models such as queues, population processes or risk models. In other instances, counting processes are implicitly defined and constructed through applied probability models. For example, a realization of a queue induces additional counting processes such as the departure process, {D(t), t ≥ 0}, counting the number of serviced customers in the queue until time t.Departure counting processes of queues have been heavily studied in applied probability and operations research. Classic applied probability surveys are Daley (1976) and Disney and Konig (1985). More recent studies in operations research are Hendricks (1992),Tan (1999) and Tan (1997) where the authors consider departures in and within manufacturing production lines. Indeed, from an operational viewpoint, quantification of the variability of flows within a network is key. A similar comment applies to the flows of finished products at the end of the production process. From a theoretical perspective, there remain some open questions about the ability to characterize {D(t)} as a Markovian Point Process, as in Bean and Green (2000),Bean et al. (1998) and Olivier and Walrand (1994). Further, the discovery of the BRAVO effect (Balancing Reduces Asymptotic Variance of Outputs) has motivated research on the variability of departure processes of queues, particularly in critically loaded regimes. Recent papers on this topic are Al Hanbali et al. (2011),Daley (2011),Daley et al. (2014),Nazarathy (2011) and Nazarathy and Weiss (2008).Next to the mean curve,m(t)=E[D(t)],an almost equally important performance measure of a counting processes is the variance curve, v(t) = Var(D(t)). For example, for a Poisson process with rate α, the variance curvev(t)=αtis the same as the mean curve. For more complicated counting processes, the variance curve is not as simple and is not the same as the mean curve. For example, for a stationary (also known as equilibrium) renewal-process with inter-renewal times distributed as the sum of two independent exponential random variables, each with mean (2α)−1, we havem(t)=αt−14+14e−4αt,v(t)=α12t+18−18e−4αt.For the ordinary case of the same renewal process (the first inter-renewal time is distributed as all the rest) the variance curve isv(t)=α12t+116−te−4αt−116e−8αt.These explicit examples are taken from Cox (1962, Section 4.5). In fact, for general, non-lattice, renewal processes (both equilibrium and ordinary), with inter-renewal times having a finite second moment, with squared coefficient of variation c2, and mean α−1, it is well known that,(1)v(t)=αc2t+o(t),as t → ∞ (which is the limiting regime used throughout this paper). However, in general, a finer description of v(t) (through the o(t) term) is typically not as simple as in the examples above.If the third moment of the inter-renewal time is finite, then(2)v(t)={αc2t+54(c4−1)−23(γc3−2)+o(1),fortheequilibriumcase,αc2t+12(c4−1)−13(γc3−2)+o(1),fortheordinarycase,where γ is the skewness coefficient of the inter-renewal time.11The skewness coefficient of a random variable X isE[(X−E[X]Var(X))3].We remind the reader that for exponential random variables (making the renewal process a Poisson process), c2 = 1 and γ = 2, and the ordinary and equilibrium versions of a Poisson process are identical. See Asmussen (2003) and Daley and Vere-Jones (2003) for more background on renewal processes. Eq. (2) appears under a slightly different representation in Cox (1962) and was essentially first found in Smith (1959). Generalizations of renewal processes are in Brown and Solomon (1975),Daley and Mohan (1978) and Hunter (1969).The above examples indicate that, for counting processes in general, it is likely to be fruitful to look for an asymptotic expression for the variance curve of the form(3)v(t)=v¯t+b¯+o(1).We refer tov¯as the asymptotic variance rate and tob¯as the intercept term. A point to observe is that, for a renewal process,b¯depends on the version of the renewal process (ordinary vs. equilibrium) whilev¯does not. Since the latter depends on the initial conditions, we generally employ the notationb¯efor the stationary (equilibrium) system,b¯0for systems starting empty andb¯θfor systems with arbitrary initial conditions.Moving on from renewal processes to implicitly defined counting processes, the variance curve is typically more complicated to describe and characterize. For example, while the output of a stationary M/M/1 queue with arrival rate λ and service rate μ is simply a Poisson process with rate λ (see Kelly, 1979), the variance curve when the system starts empty at time 0 is much more complicated than v(t) = λt. It can be represented in terms of integrals of expressions involving Bessel functions of the first kind, and requires several lines to be written out fully (as in Theorem 5.1 of Al Hanbali et al., 2011). Nevertheless (see Theorem 5.2 in Al Hanbali et al., 2011) the curve can be sensibly approximated as follows:(4)v(t)={λt−ρ(1−ρ)2+o(1),ifρ<1,2(1−2π)λt−λπt1/2+π−24π+o(1),ifρ=1,μt−ρ(1−ρ)2+o(1),ifρ>1,where ρ = λ/μ.As observed from the formula above, it may be initially quite surprising that the asymptotic variance rate is reduced by a factor of 2(1 − 2/π) ≈ 0.73 when ρ changes from being approximately 1 to exactly 1. This is a manifestation of the BRAVO effect. BRAVO was first observed for M/M/1/K queues in Nazarathy and Weiss (2008) in which case, as K → ∞, the factor is 2/3, a fact that we confirm in this paper. It was later analyzed for M/M/1 queues and more generally GI/G/1 queues in Al Hanbali et al. (2011). BRAVO has been numerically conjectured for GI/G/1/K queues in Nazarathy (2011), and observed for multi-server M/M/s/K queues in the many-server scaling regime in Daley et al. (2014).Our focus in this paper is on the more subtle intercept termb¯. For a stationary M/M/1 queue, {D(t)} is a Poisson process and thusb¯e=0. As opposed to that, for an M/M/1 queue starting empty, it follows from (4) thatb¯0=−ρ/(1−ρ)2as long as ρ ≠ 1. When ρ = 1, we see from (4) that the variance curve does not have the asymptotic form (3). This can happen more generally. If, for example, there is sufficient long range dependence in the counting process, then the variance can grow super-linearly (see Daley and Vesilo, 1997 for some examples). This demonstrates that the asymptotic variance rate,v¯,and the intercept term,b¯,need not exist for every counting process. Nevertheless, for a variety of models and situations, bothv¯andb¯exist, and thus the linear asymptote is well-defined. In such cases, having a closed formula is beneficial for performance analysis of the model at hand.We are now faced with the challenge of finding the intercept term for other counting processes generated by queues. In this paper we carry out such an analysis for two models related to the M/M/1 queue: a finite capacity M/M/1/K queue, and an infinite capacity M/G/1 queue. Besides obtaining explicit formulas forb¯e,b¯0andb¯θ,our investigation also pinpoints some of the analytical challenges involved and raises some open questions. Here is a summary of our main contributions.In this case the departure process is a Markovian Point Process. The linear asymptote is then given by formulas based on the matrix Λ− = (1π− Λ)−1, where Λ is the generator matrix of the (finite) birth-death process,πis its stationary distribution taken as a row vector, and 1 is a column vector of 1’s. In the case where ρ = 1, the distributionπis uniform and an explicit expression for Λ− was previously found, which in turn yielded the equilibrium version of the intercept term,b¯e=7K4+28K3+37K2+18K180(K+1)2,in Proposition 4.4 of Nazarathy and Weiss (2008). When ρ ≠ 1, the form of the inverse Λ− is more complicated and an expression forb¯has not been previously known. We are now able to find such an expression for both the stationary version and for arbitrary initial conditions. Our results are based on relating Λ− to the matrixΛ♯=∫0∞(P(t)−1π)dt,where P( · ) is the transition probability kernel of the birth-death process. The matrix Λ♯ is called the deviation matrix (also known as the Drazin inverse of − Λ), and we are able to provide explicit expressions for the entries of this matrix. Our contribution also includes some useful results regarding the asymptotic covariance between the count and phase in arbitrary Markovian Point Processes which, to the best of our knowledge, have not appeared elsewhere.When the third moment of the service time distribution is finite, then it is known that the stationary queue length has a finite variance. When the service time distribution is not exponential, the form ofb¯has not previously been known. Our contribution is an exact expression for theb¯term based on the first three moments of G. We begin withb¯e,after which we employ a simple coupling argument to findb¯θandb¯0.The structure of the rest of the paper is as follows: In Section 2 we present our M/M/1/K queue results forb¯together with a discussion of the deviation matrix and its application to Markovian Point Processes. In Section 3 we present our M/G/1 queue results forb¯,and discuss a related conjecture of Daley, dealing with a characterization of the M/M/1 queue within the class of stationary M/G/1 queues. We conclude in Section 4.We begin our investigation with the M/M/1/K queue, where K denotes the total capacity of the system. In this case, it is well known that the departure process {D(t)} is a Markovian Point Process and is a renewal processes only when K = 1 or K = ∞. Some standard references on Markovian Point Processes are Asmussen (2003, Section XI.1) and Latouche and Ramaswami (1999, Section 3.5).Denote the arrival rate by λ > 0, the service rate by μ > 0 and let ρ = λ/μ be the traffic intensity. The queue length process, {Q(t)}, is a continuous-time Markov chain on the state space {0, 1, …, K}, with generator matrix Λ and stationary distribution (row) vectorπgiven byΛ=[−λλ0μ−(μ+λ)λ⋱⋱⋱μ−(μ+λ)λ0μ−μ],π={1−ρ1−ρK+1[1,ρ,ρ2,…,ρK],forρ≠1,1K+11′,forρ=1.The departure process {D(t)} is a Markovian Point Process of which the phase-process is {Q(t)}, and the event intensity matrix Λ1 is given byΛ1=[000μ00⋱⋱⋱μ000μ0].In brief, Λ1 indicates which transitions of {Q(t)} will count as increments of {D(t)}.The fundamental matrix Λ− ≔ (1π− Λ)−1 is a generalized inverse (that is, a matrix X such that(5)(−Λ)X(−Λ)=(−Λ),see Hunter (1982)) for the negative of the generator Λ of a continuous-time Markov chain. Generalized inverses are not uniquely determined by (5); however, by specifying other relationships, specific classes of generalized inverses can be defined. The deviation matrixΛ♯:=∫0∞(eΛt−1π)dtis the so-called group inverse (or Drazin inverse) of − Λ, which, by definition, is the unique solution of (5), X( − Λ)X = X, and ( − Λ)X = X( − Λ). The deviation matrix can be interpreted as a measure of the total deviation from the limiting probabilities, see for instance Coolen-Schrijner and van Doorn (2002) as well as Koole and Spieksma (2001). The fundamental matrix Λ− and the deviation matrix Λ♯ are related by the expression(6)Λ−=Λ♯+1π.For finite state space continuous-time Markov chains, such as the M/M/1/K queue, the fundamental matrix and the deviation matrix always exist. The deviation matrix satisfies the properties(7)Λ♯1=0,(8)πΛ♯=0,Λ♯Λ=ΛΛ♯=1π−I,as well asΛi,j♯=πj(mje−mi,j),where mi, jis the mean first entrance time from state i to state j, andmjeis the mean first entrance time to state j from the stationary distribution, that is,mi,j=E[inf{t:Q(t)=j}|Q(0)=i],mje=∑i=0Kπimi,j,see Coolen-Schrijner and van Doorn (2002). Note that we take the indices of the matrices and vectors of size K + 1 used here to run on range {0, …, K}.As will be evident below, we are particularly interested in the bottom left entry of the deviation matrix and that of its square,d¯v=ΛK,0♯=∫0∞(P(Q(t)=0|Q(0)=K)−π0)dt=π0(m0e−mK,0),d¯b=(Λ♯Λ♯)K,0=π0∑j=0Kπj(mje−mK,j)(m0e−mj,0).Finding explicit expressions for these quantities is tedious yet possible for the M/M/1/K queue.Lemma 1For the M/M/1/K queue length continuous-time Markov chain, the (K, 0) elements of the deviation matrix and its square aredv¯={−μ−1K(1−ρ)(1+ρK+1)−2ρ(1−ρK)(1−ρ)(1−ρK+1)2,ρ≠1,−μ−1K(K+2)6(K+1),ρ=1.d¯b={−μ−2{[6(1+ρ2)(1+K)2−4ρ(1+6K+3K2)]ρK+1+ρ2(2+3K+K2)(1+ρ2K)2(1−ρ)3(1−ρK+1)3−μ−2−2ρ(3+2K+K2)(1+ρ2(K+1))−K(1+K)(1+ρ2(K+2))2(1−ρ)3(1−ρK+1)3},ρ≠1,−μ−27K4+28K3+37K2+18K360(K+1),ρ=1.For the M/M/1/K queue, a standard application of “first step analysis” leads to the following recurrence equations for mi, j:mi,j={0,i=j,λ−1+m1,j,i=0,j≠i,μ−1+mK−1,j,i=K,j≠i,(λ+μ)−1+λλ+μmi+1,j+μλ+μmi−1,j,otherwise.When ρ ≠ 1, the solution ismi,j={μ−1(ρ−j−ρ−i(1−ρ)2+i−j1−ρ),0≤i≤j,μ−1(ρK+1ρ−j−ρ−i(1−ρ)2+i−j1−ρ),j≤i≤K,and, when ρ = 1, the solution ismi,j={μ−1j(j+1)−i(i+1)2,0≤i≤j,μ−1(K−j)[(K−j)+1]−(K−i)[(K−i)+1]2,j≤i≤K.Averaging overπwe get,mje={μ−1ρ−j−(1+2j)(1−ρ)−[1+2(K−j)](1−ρ)ρK+1−ρ2(K+1)−j(1−ρ)2(1−ρK+1),ρ≠1,μ−1(j2−Kj+K23+K6),ρ=1.Combining the above we get the desired results.□We note that related results were found for a discrete time version of the queue in Koole (1998) and in Koole and Spieksma (2001).When the queue length process {Q(t)} is stationary, the Markovian Point Process {D(t)} is a (time) stationary point process (see Asmussen, 2003). In this case, the asymptotic variance rate,v¯,and the y-intercept,b¯e,are respectively given by(9)v¯=πΛ11−2(πΛ11)2+2πΛ1Λ−Λ11,(10)b¯e=2(πΛ11)2−2πΛ1Λ−Λ−Λ11,see for instance Narayana and Neuts (1992),Asmussen (2003) or the summary in Nazarathy and Weiss (2008). By substituting (6) into (9) and (10) we obtain a simpler expression forv¯andb¯ein terms of the deviation matrix:(11)v¯=πΛ11+2πΛ1Λ♯Λ11=λ*+2πΛ1Λ♯Λ11,(12)b¯e=−2πΛ1Λ♯Λ♯Λ11,whereλ*=limt→∞E[D(t)]t=πΛ11={μρ1−ρK1−ρK+1,forρ≠1,μKK+1,forρ=1.We can go further in the simplification of the expressions by using (7) and (8). Leteidenote the column vector of which the only nonzero entry is the entry corresponding to state i, which is equal to 1 (0 ≤ i ≤ K). First, observe thatπΛ1 and Λ11 take simple forms in our case:πΛ1={μρπ−ρK+11−ρ1−ρK+1μeK′,ρ≠1,μπ−1K+1μeK′,forρ=1.,Λ11=μ(1−e0).Then, sinceπand 1 are respectively the left and right eigenvectors of Λ♯ corresponding to the eigenvalue 0, we obtainπΛ1Λ♯Λ11={μ2ρK+11−ρ1−ρK+1d¯v,forρ≠1,μ21K+1d¯v,forρ=1.We thus obtainv¯={λ*+2μ2ρK+11−ρ1−ρK+1d¯v,ρ≠1,λ*+2μ2K+1d¯v,ρ=1,and similarly,b¯e={−2μ2ρK+11−ρ1−ρK+1d¯b,ρ≠1,−2μ21K+1d¯b,ρ=1.Combining the above with the results of Lemma 1, and manipulating the expressions, we obtain our main result for M/M/1/K queues:Proposition 2For the stationary M/M/1/K queue,v(t)=v¯t+b¯e+o(1)wherev¯={λ(1+ρK+1)(1−(1+2K)ρK(1−ρ)−ρ2K+1)(1−ρK+1)3,ρ≠1λ(23−3K+23(K+1)2),ρ=1,andb¯e={ρK+1{(6(1+ρ2)(1+K)2−4ρ(1+6K+3K2))ρK+1+ρ2(2+3K+K2)(1+ρ2K)(1−ρ)2(1−ρK+1)4ρK+1−2ρ(3+2K+K2)(1+ρ2(K+1))−K(1+K)(1+ρ2(K+2))(1−ρ)2(1−ρK+1)4},ρ≠1,7K4+28K3+37K2+18K180(K+1)2,ρ=1.respectively.Here are some observations:•With the exception ofb¯efor ρ ≠ 1, all of the expressions in Proposition 2 appeared in Nazarathy and Weiss (2008). Yet, while working on Nazarathy and Weiss (2008), the authors were not able to obtainb¯ewhen ρ ≠ 1, as obtained here.We illustrate the intercept term for different values of K and λ in Fig. 1. It is straightforward to see thatlimK→∞b¯e={0,ρ≠1,∞,ρ=1,and further, for ρ = 1,b¯e=O(K2).It is insightful to see the role ofd¯vandd¯bin the above derivations. In fact, the spikes inv¯andb¯that occur at ρ ≈ 1 are are because of similar spikes ind¯vandd¯b.Our derivation ofv¯andb¯eabove is based on (9) and (10) respectively, or alternatively on their deviation matrix based forms, (11) and (12). On route to calculating additional performance measures for the M/M/1/K queue, we first derive some further results for Markovian Point Processes, which to the best of our knowledge have not appeared elsewhere. These results are of independent interest.Consider an arbitrary Markovian Point Process with an n × n irreducible generator matrix Λ = Λ0 + Λ1, where Λ1 is the event intensity matrix and Λ0 is assumed to be non-singular. Such a process corresponds to a two-dimensional Markov chain {(N(t), φ(t)), t ≥ 0}, where N(t) denotes the number of events in the interval [0, t] and φ(t) denotes the phase at time t, taking values in {1, …, n}. We assume that N(0) = 0 almost surely and denote byθthe distribution of φ(0). Further, we denote byπthe stationary distribution corresponding to Λ, or equivalently to the phase process {φ(t)}.Ifθ=πthen N(t) is a time-stationary point process. This implies that for any sequence of intervals (t1, s1), …, (tℓ, sℓ) and for any τ,[N(s1)−N(t1),…,N(sℓ)−N(tℓ)]=d[N(s1+τ)−N(t1+τ),…,N(sℓ+τ)−N(tℓ+τ)],where the equality is in distribution (see Asmussen, 2003, chap. XI, Proposition 1.2).Another interesting initial distribution isα=πΛ1/(πΛ11). This is the invariant distribution of a discrete time jump chain, {Yk} where Ykis the value of φ(t) just after the kth arrival. The probability transition matrix of this Markov chain is−Λ0−1Λ1. As shown in Asmussen (2003, chap. XI, Proposition 1.4), settingθ=αmakes {N(t)} an event-stationary point process. That is, if Tkdenotes the time interval between the (k − 1)st and the kth event in the Markovian Point Process, then the joint distribution of (Tk, Tk + 1, …, Tk + ℓ) is the same as the joint distribution of(Tk′,Tk′+1,…,Tk′+ℓ)for all integer k, k′, ℓ.Sinceθaffects the point process in such a manner, it is natural to ask what is its effect on v(t) and related quantities. We now have the following:Proposition 3For an arbitrary Markovian Point Process with initial distributionθ,Var(N(t))=v¯t+b¯θ+o(1),where the y-intercept is given by(13)b¯θ=b¯e−(2πΛ11θ(Λ♯)2Λ11−2θΛ♯Λ1Λ♯Λ11+(θΛ♯Λ11)2),andv¯andb¯eare respectively given by (11) and (12).The variance curve of an arbitrary Markovian Point Process with initial distributionθis given by(14)Var(N(t))=θM2(t)1+θM1(t)1−(θM1(t)1)2,where M1(t) and M2(t) denote the matrices of the first two factorial moments of the number of events in a non-stationary Markovian Point Process, that is,[M1(t)]ij=E[N(t)1{φ(t)=j}|φ(0)=i][M2(t)]ij=E[N(t)(N(t)−1)1{φ(t)=j}|φ(0)=i].Narayana and Neuts (1992) showed that M1(t) has a linear asymptote in that there exist constant matrices A0 and A1 such that(15)M1(t)=A0t+A1+O(e−ηtt2r−1)ast→∞,where − η is the real part of η*, the non-zero eigenvalue of Λ with maximum real part, and r is the multiplicity of η*. Similarly, M2(t) has a quadratic asymptote in that there exist constant matrices B0, B1 and B2 such that(16)M2(t)=B0t2+2B1t+2B2+O(e−ηtt3r−1)ast→∞.The expressions for the coefficient matrices A0, A1, B0, B1, and B2 given in Narayana and Neuts (1992) are in terms of the fundamental matrix Λ−. After rewriting them in terms of the deviation matrix via the relation (6), we see thatA0=(πΛ11)1π,A1=Λ♯Λ11π+1πΛ1Λ♯,B0=(πΛ11)21π,B1=(πΛ11)Λ♯Λ11π+(πΛ11)1πΛ1Λ♯+(πΛ1Λ♯Λ11)1π,B2=−1π(πΛ1(Λ♯)2Λ11)+Λ♯Λ11πΛ1Λ♯−(πΛ11)(Λ♯)2Λ11π−(πΛ11)1πΛ1(Λ♯)2+1πΛ1Λ♯Λ1Λ♯+Λ♯Λ1Λ♯Λ11π.By injecting (15) and (16) in terms of Λ♯ into (14), and making a few simplifications, we obtain the fact that Var(N(t)) has a linear asymptote whose intercept term isb¯θ=−2πΛ1Λ♯Λ♯Λ11−2πΛ11θ(Λ♯)2Λ11+2θΛ♯Λ1Λ♯Λ11−(θΛ♯Λ11)2,which proves the theorem.□Here are some observations:•Forθ=π, the correction termb¯θ−b¯evanishes as expected.The correction term does not depend only on the variance of the initial distributionθ, as we show to be the case for the M/G/1 queue (see Proposition 7). Indeed, consider n = 3,θ1 = [1, 0, 0] andθ2 = [0, 1, 0] which have the same variance equal to zero; however it is easy to find an example of a Markovian Point Process for which the value ofb¯θ−b¯eis different for the two initial distributions.In the specific case where Λ11 = β1 (where β is a constant), the correction termb¯θ−b¯evanishes for all initial distributionsθbecause of the property (7). This shows thatθ=πis a sufficient but not necessary condition for havingb¯θ=b¯e.A further performance measure of interest is the asymptotic covariance between the number of points and the phase of a Markovian Point Process. As shown in the following proposition, the deviation matrix also plays a role in this asymptotic quantity.Proposition 4Let {N(t)} and {φ(t)} be the number of points in [0, t] and the phase at time t of a Markovian Point Process with initial phase distributionθ. Then,limt→∞Cov(N(t),φ(t))=∑i=1ni(πΛ1Λ♯)i−(∑i=1niπi)θΛ♯Λ11.Further, in the time-stationary case (θ=π), the term with the second sum vanishes.For a Markovian Point Process with initial distributionθ, defineMiθ(t)=E[N(t)1{φ(t)=i}],andMθ(t)=[M1θ(t),…,Mnθ(t)]. From Asmussen (2003, chap. XI, Proposition 1.7), we haveMθ(t)=θ∫0teΛuΛ1eΛ(t−u)du.Let us define the transient deviation matrix asΛ♯(t)=∫0t(eΛu−1π)du=∫0teΛudu−1πt,so that Λ♯ = limt → ∞Λ♯(t). With this,E[N(t)]=Mθ(t)1=θ∫0teΛuduΛ11=πΛ11t+θΛ♯(t)Λ11.Next, note thatE[N(t)φ(t)]=∑i=1niMiθ(t). Therefore, sinceE[φ(t)]=∑i=1ni(θeΛt)i,we obtainCov(N(t),φ(t))=E[N(t)φ(t)]−E[N(t)]E[φ(t)]=∑i=1ni{[θeΛt∫0te−ΛuΛ1eΛudu]i−(πΛ11t+θΛ♯(t)Λ11)[θeΛt]i∫0t}.Finally, we take t → ∞ in the last expression, and we use the fact that limt → ∞θeΛt=π, πe−Λu=π, and∫0teΛudu=Λ♯(t)+1πt. After some algebraic simplifications, we obtain the statement of the proposition.□We now make use of Proposition 3 to investigate the intercept termb¯θof v(t) for an arbitrary M/M/1/K queue where the distribution of Q(0) isθ.In Fig. 2, we show the (scaled) value ofb¯θfor the particular initial distributionsθ=ei′,that is, for M/M/1/K queues which start with i customers at time t = 0 almost surely, for 0 ≤ i ≤ K. We observe that when ρ < 1,b¯θis a monotonically decreasing function of i, while when ρ ≥ 1,b¯θexhibits a minimum. We also observe that for ρ > 1, when K increases and Q(0)/K → 1,b¯θ→0.In Fig. 3, we consider the behavior of the intercept termb¯θin the event-stationary case, that is, whenθ=α. The four graphs show the correction termb¯θ−b¯eas a function of ρ (or, more precisely, as a function of λ for a fixed value of μ) for increasing values of K. We see that the curves have an interesting shape with two local minima centered around ρ = 1. As K increases, the dips become narrow and deep; the correction term converges to zero everywhere, except at ρ = 1 where further computation has shown that it decreases approximately linearly. As a consequence, the effect of event-stationarity on the intercept term becomes indistinguishable from the effect of time-stationarity as K → ∞ for all values of ρ except in the balanced case.Note that the explicit expressions forb¯θwhenθ=ei′orθ=αcan also be obtained, but since they are quite cumbersome and do not bring more information, we do not present these here.Making use of Proposition 4 and the particular structure of the vectorπand the matrix Λ1, in the stationary case, we can express the asymptotic covariance between the number of departures and the queue size explicitly.Corollary 5Consider the stationary M/M/1/K queue with output process {D(t)} and queue level process {Q(t)}. Then,limt→∞Cov(D(t),Q(t))={ρK+1{K2(ρ−1)2(1+3ρK+1)−2ρ(ρK−1)(−2+ρ+ρK+2)2(ρ−1)2(ρK+1−1)3ρK+1+K(ρ−1)(−1+3ρ−7ρK+1+5ρK+2)2(ρ−1)2(ρK+1−1)3},ρ≠1,−K(K+2)/24,ρ=1.We use Proposition 4 with N(t) = D(t) and φ(t) = Q(t), together with the fact that(πΛ1Λ♯)i=−CΛKi♯,whereC={μρK+1(1−ρ)1−ρK+1,forρ≠1,μK+1,forρ=1,andΛKi♯=πi(mie−mK,i).The entriesΛKi♯of the deviation matrix are then computed explicitly for 0 ≤ i ≤ K using the expressions forπand mi, jderived in the proof of Lemma 1.□Note that Proposition 4 indicates that the difference between the stationary and the non-stationary cases is the correction term − (∑iiπi)θΛ♯Λ11, where ∑iiπi= K/2 for ρ = 1, and for ρ ≠ 1,∑i=0Kiπi=ρ(1−(1+K)ρK+Kρ1+K)(1−ρ)(1−ρ1+K).In Fig. 4, we illustrate the asymptotic covariance between D(t) and Q(t) in the stationary case, as a function of ρ and for increasing values of K. We see that the asymptotic covariance curves exhibit a similar behavior to (the negative of) those of the intercept term in the stationary case (see Fig. 1), but in the present case the curves are more skewed with respect to ρ = 1.We now consider the departure process of the M/G/1 queue. In this case, the departure process {D(t)} is generally not a Markovian Point Process, and the analysis is more complicated. Nevertheless we are able to obtain some partial results about the linear asymptote of v(t). Our approach is to first assume the existence of a linear asymptote and then to find an elegant formula for the intercept term under this assumption, generalizing the expression for the M/M/1 queue in (4) for the stable case. Further we conjecture that our assumption holds when the third moment of the service time is finite.Denote the arrival rate by λ, the service time distribution by G( · ) and its kth moment by gk. In this case,μ=g1−1,and we assume that ρ = λ/μ < 1. The squared coefficient of variation and skewness coefficient are given byc2=g2/g12−1andγ=(2g13−3g1g2+g3)/((g2−g12)3/2)respectively.Consider the output from a simulated numerical example in Fig. 5.22We simulated 106 realizations of the queueing process, recording and estimating the variance of D(t) over the grid t = 0, 5, 10, …, 800. Prior to time t = 0 we simulated each realization for 3 × 104 units so as to begin in approximate steady-state. The simulation is coded in C to allow for efficient computation. During the simulation run, roughly 26 × 109 jobs were processed in the simulated M/G/1 queue.It depicts the variance curve and its linear asymptote for a stationary M/G/1 queue with λ = 0.85 and μ = 1 (ρ = 0.85). The service time distribution is taken to be log-normal with c2 = 2. This implies thatγ=10/2. It is visually evident that for non-small t,v(t)≈v¯t+b¯e. Indeed, for the rest of this paper, we shall assume that such a linear asymptote exists. This is stated in the assumption below.Assumption 1There existv¯andb¯θsuch that,(17)v(t)=v¯t+b¯θ+o(1).Theb¯eterm in Fig. 5 was calculated from the formula in Proposition 6 below and is a function of μ, c2 and γ. As is attested by the figure and by further extensive numerical experiments, we believe that such a term exists for all M/G/1 queues with ρ ≠ 1 in which the service time distribution has a finite third moment, yet we have not been able to prove this.Conjecture 1For λ ≠ μ, consider an M/G/1 queue operating under any work-conserving non-pre-emptive policy, in which the service time distribution has a finite third moment. Assume furthermore that the variance of the queue length at time 0 is finite. Then there exists a finiteb¯θsuch that (17) holds, withv¯={λ,λ<μ,μc2,λ>μ.To get insight into the asymptotic variance rate,v¯,in Conjecture 1, consider first the case where λ > μ. In this case, after some time τ which is almost surely finite, the server never stops operating and thus for t > τ, {D(t)} is effectively a renewal process with asymptotic variance rate μc2 (see Eq. (1)). To the best of our knowledge, this intuitive argument cannot easily be made rigorous.For the case λ < μ, consider the relation D(t) = A(t) + Q(0) − Q(t), where D(t) is the number of service completions during [0, t], {A(t)} is the Poisson arrival process, counting arrivals during [0, t], and Q(t) is the number of customers in the system at time t. Taking the variance of both sides of the last equation, observing that A(t) is independent of Q(0), dividing by t, and letting t → ∞, we getlimt→∞v(t)t=limt→∞Var(A(t))t+limt→∞Var(Q(0))t+limt→∞Var(Q(t))t−2limt→∞Cov(Q(0),Q(t))t−2limt→∞Cov(A(t),Q(t))t,whenever the limits exist. Now the first limit on the right hand side equals λ, the second limit vanishes by assumption, the third limit should vanish since the stationary variance is finite (due to a finite third moment – see Eq. (25)), the fourth limit should vanish since in fact Cov(Q(0), Q(t)) vanishes (this is not trivial to establish in general, yet was communicated to us for the FCFS case through personal communication with Brian Fralix), and finally, for the fifth limit observe that|Cov(A(t),Q(t))|≤λtVar(Q(t))=O(t),and thus the limit vanishes. This implies that the departure asymptotic variance equals the arrival asymptotic variance. To get insight into our belief of the importance of g3 < ∞ for the existence ofb¯θ(at least for the case λ < μ), see the proof of Proposition 6 below.Our focus for the rest of this section is on the stable case (λ < μ) in which we are able to find explicit expressions forb¯eandb¯θ(includingb¯0).In Daley (1975) (see also Daley, 1976) Daley found the Laplace–Stieltjes transform (LST) of the variance curve for the stationary case. After some minor rearrangement, Daley’s formula may be written as(18)v*(s)=∫0∞e−stdv(t)=λs+b*(s),where,(19)b*(s)=2λs(G*(s)1−G*(s)(1−sΠ(Γ(s))s+λ(1−Γ(s)))−λs),and the LST exists for ℜ(s) > 0. Here, G*( · ) is the Laplace–Stieltjes transform (LST) of G( · ), Π( · ) is the probability generating function of the stationary number of customers in the system, with(20)Π(z)=(1−ρ)(1−z)G*(λ(1−z))G*(λ(1−z))−z,for ℜ(z) ≤ 1. Further, Γ(s) is the LST of the busy period at s, with ℜ(s) > 0. It is obtained as the minimal non-negative solution of(21)Γ(s)=G*(s+λ(1−Γ(s))).For relevant standard queueing background see for example Prabhu (1998).We now have the following:Proposition 6Consider the stationary M/G/1 queue having g3 < ∞. If Assumption 1 holds, then the intercept term in (17) is given byb¯e=Leρ(1−ρ)2,withLe=(3c4−4γc3+6c2−1)ρ3+(4γc3−12c2+4)ρ2+(6c2−6)ρ6.Letb˜(·)be such thatv(t)=λt+b˜(t).By Assumption 1,limt→∞b˜(t)=b¯e.Since the LST of λt is λ/s and since the LST is a linear operator, we have from (18) that for ℜ(s) > 0 the LST ofb˜(·)isb*(s)=∫0∞e−stdb˜(t).By the Final Value Theorem (see for example Widder, 1959 for a rigorous reference) we have(22)lims→0b*(s)=b¯e.The remainder of the derivation deals with evaluation of the limit (22) by using (19) together with (20) in order to findb¯e. This is a combination of straightforward classic queuing calculations together with five applications of L’Hospital’s rule. It requires us to evaluate the first three moments of the busy period by taking derivatives of (21) and setting s → 0, and we getb1=(1+λb1)g1,b2=λb2g1+(1+λb1)2g2,b3=λb3g1+3λ(1+λb1)b2g2+(1+λb1)3g3,where b1 = −Γ′(0), b2 = Γ′′(0) and b3 = −Γ′′′(0). These values are well known and appear in many queueing texts, yet we present them here for completeness:b1=μ−111−ρ,b2=g2(1−ρ)3=μ−2c2+1(1−ρ)3,b3=g3(1−ρ)+3λg22(1−ρ)5=μ−33c4ρ+c3γ(1−ρ)+3c2(1+ρ)+2ρ+1(1−ρ)5.□Here are some observations:•If G follows an exponential distribution, then c = 1 and γ = 2, yieldingb¯e=0,as is expected since in this case {D(t)} is a Poisson process.Le (and thusb¯e) is monotone increasing in both c and γ.As ρ → 1, Le → (c4 − 1)/2. This gives some insight into the form of the variance curve of heavy traffic systems, showing how the squared coefficient of variation of G plays a role when ρ ≈ 1: When c2 > 1 the intercept term is positive, and when c2 < 1 the intercept term is negative. Further, as typical for heavy traffic systems, only the first two moments of the service time play a role. The skewness coefficient γ does not matter when ρ ≈ 1.In the M/M/1 queue case, v*(s) in (18) is equal to λ/s, which corresponds to the variance curve v(t) = λt. This is expected since, for the stationary M/M/1 queue, {D(t)} is a Poisson process. In Daley (1975), Daley conjectures that the reverse implication is also true:Havingv(t)=λtimpliesthattheservicetimedistributionisexponential.Restated in terms of LSTs using (18), the conjecture is that a b*(s) of the form (19), where G*(s) is the LST of a probability distribution, can be equal to zero only if G*(s) = 1/(1 + sg1) with g1 > 0. Proving Daley’s conjecture would strengthen a result by Finch (1959), stating that all stationary M/G/1 queues with an Poisson output process are M/M/1 queues.Our expression forb¯ein Proposition 6 gives a necessary condition for v(t) = λt:(23)v(t)=λtonlyifLe=0.At this point it is tempting to believe that if Le = 0 (i.e.b¯e=0) then v(t) = λt. This could then be used to disprove Daley’s conjecture, since Le only depends on the first three moments of G and it is known that the exponential distribution is not characterized (within the class of non-negative distributions) by the first three moments. For example, consider a mixture of an exponential random variable with point masses at 1/2, 3/2, 5/2 and 9/2, with LST:G*(s)=1384(19211+s+147e−12s+8e−32s+30e−52s+7e−92s).Elementary calculation yields − G*′(0) = 1, G*′′(0) = 2, − G*′′′(0) = 6, as is the case for a unit mean exponential distribution, and thus Le = 0. However, via numerical evaluation of b*(s) for the case where λ = 3/4 and μ = 1, we verified that b*(s) ≠ 0 and thus v(t) ≠ λt, but rather, v(t) = λt + o(1), where the o(1) term is not identically 0. Note that in this case, Γ(s) was found by iterating (21) for fixed s over a fine grid of s. Thus we conclude that the necessary condition (23) is not sufficient. Daley’s conjecture remains open.We are now able to use the steady state intercept term to obtain the intercept term for a system with an arbitrary distribution of the initial state.Proposition 7Consider the M/G/1 queue with ρ < 1, g3 < ∞ and an arbitrary initial distribution of the number of customers having a finite variance. If Assumption 1 holds, then the intercept term in (17) is given byb¯θ=σ02−σπ2+b¯e,whereσ02=Var(Q(0)),σπ2is the steady state variance of the number of customers in the system, andb¯eis as in Proposition 6.We use a coupling argument. Consider the following two systems 0 and θ under the same sample path of the arrival process and service times. System 0 starts empty and system θ starts with Q(0) customers in the system. Operate system θ by giving low priority to the initial Q(0) customers, that is, these customers are served only when there are no other customers in system and pre-empted if an arrival occurs during their service time. This implies that the first Q(0) customers of System θ are being served only at times that coincide with idle periods of System 0. After a finite time T, the trajectories of the queue lengths of the two systems coincide. Thus for t ≥ T, Dθ(t) = D0(t) + Q(0), where Di( · ) denotes the relevant output counting process. This yieldsλt+b¯θ=λt+b¯0+o(1)+Var(Q(0)).Taking t → ∞ we obtain,(24)b¯θ=b¯0+Var(Q(0)).Now selecting Q(0) to be distributed according to the steady state distribution we get from (24),b¯0=b¯e−σπ2. Applying this again in (24) we obtain the result. Note that a similar coupling argument also holds for the non-preemptive case.□As is well known,σπ2can be obtained directly from Π( · ), yet it is a cumbersome calculation. We state it here for completeness:(25)σπ2=((14c4−13γc3+12c2−112)ρ3+(13γc3−32c2+56)ρ2+(32c2−32)ρ+1)ρ(1−ρ)2.As a result of the above, the intercept term for a system that starts empty is:b¯0=−(1−L0)ρ(1−ρ)2,withL0=(3c4−4γc3+6c2−1)ρ3+(4γc3−6c2−2)ρ2+(−6c2+6)ρ12.Here are some observations:•In the M/M/1 queue, L0 = 0 and thusb¯0=−ρ/(1−ρ)2. As expected, this is in agreement with the case ρ < 1 in (4).As ρ → 1, L0 → (c2 − 1)2/4. This implies that in heavy-traffic, c2 plays a similar role with respect to the sign of the intercept term as it did in the stationary case: In this case when c2 > 3 the intercept term is positive, and when c2 ≤ 3 the intercept term is negative. Compare with the remarks following Proposition 6.

@&#CONCLUSIONS@&#
