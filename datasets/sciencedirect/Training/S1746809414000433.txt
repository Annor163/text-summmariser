@&#MAIN-TITLE@&#
Computer-aided quantification of contrast agent spatial distribution within atherosclerotic plaque in contrast-enhanced ultrasound image sequences

@&#HIGHLIGHTS@&#
We automatize and improve quantification of contrast agent distribution in plaque.We quantify contrast agent spatial distribution in plaque using texture features.Quantitative features can distinguish three qualitative grades of plaques.Our new features show superior performance to the traditional area ratio.The combined area ratio is best for distinction between the grades of plaques.

@&#KEYPHRASES@&#
Computer-aided quantification,Ultrasound image processing,Contrast-enhanced ultrasound (CEUS),Atherosclerotic plaque,Intraplaque neovascularization (IPN),

@&#ABSTRACT@&#
Recent studies have revealed that the contrast-enhanced ultrasound (CEUS) correlates to the presence and degree of intraplaque neovascularization as determined histologically. However, most studies used a qualitative system to visually grade CEUS images. A computer-aided method is proposed for objective and convenient quantification of contrast agent spatial distribution within plaques in CEUS image sequences. It consists of three algorithms including cardiac cycle retrieval and sub-sequence selection, temporal mean image segmentation, and texture feature extraction. The first algorithm automatically retrieves and selects cardiac cycles from CEUS frames without electrocardiogram gating. The second is composed of three steps, i.e., temporal averaging, interactive plaque delineation, and automatic neovascularization segmentation. The third extracts eight texture features from the grayscale temporal mean images and the binary segmented images. The capability of the quantitative features in discriminating between qualitative grades is examined via the t-tests, analysis of variance (ANOVA), Fisher criterion of inter-intra class variance ratio and logistic regression classification with leave-one-out cross-validation. Experimental results on 33 carotid plaques demonstrated that the optimal feature, namely the combined area ratio, exhibited significant difference among three qualitative grades (P<0.001, ANOVA). When distinguishing between low-grade and high-grade plaques, the features improved the area under the receiver operating characteristic curve, sensitivity and specificity by 36.4%, 16.7%, and 11.1%, respectively, contrasted with a classic feature, the traditional area ratio. These results demonstrate the usefulness and advantage of the proposed method in quantifying the spatial distribution of contrast agents in CEUS.

@&#INTRODUCTION@&#
Contrast-enhanced ultrasound (CEUS) is a noninvasive imaging modality, applying microbubble-based contrast agents to traditional medical ultrasound to increase the backscatter of the ultrasound signal [1]. It enables detailed visualization of blood flow and perfusion and thus covers broad medical application.In recent years, the use of CEUS continues to grow in the assessment of carotid atherosclerotic plaques [2–6]. Vulnerable plaques, also known as “rupture-prone plaques,” have a high probability of undergoing rapid progression and rupture, causing local thrombosis and embolism, and thus leading to stroke, one of the major causes of death worldwide [7]. Recent evidence has linked elevated plaque vulnerability with plaque angiogenesis and has demonstrated feasibility of CEUS as a noninvasive way for evaluation of intraplaque neovascularization (IPN) [5]. Therefore, CEUS could be of importance to assess plaque vulnerability and identify vascularized, “high-risk” lesions before rupture [8].For assessment of plaque vulnerability, it is valuable to measure the presence and degree of IPN in CEUS images. The IPN is traditionally measured by applying a qualitative visual approach, usually by using a discrete grading system. Coli et al. [9] categorized the echogenicity as low if no bubbles were detected within plaques and as high if extensive contrast enhancement was depicted. Staub et al. [10] categorized the degree of IPN at CEUS as absent (grade 1), moderate (grade 2), or extensive (grade 3). However, these qualitative methods are subjective and affected by inter-observer and intra-observer variability [11,12]. Thus, it is required to develop computer-aided methods for objective quantification of IPN.There are two categories of computer-aided methods. One is intensity based, and the other is area based. Papaioannou et al. [13] measured the mean and median intensities of pixels in the plaque before and after injection of microbubbles. Huang et al. [14] and Xiong et al. [15] calculated average intensities in the plaque, including the baseline intensity, peak intensity, and enhanced intensity equaling to the peak intensity subtracting the baseline intensity. Furthermore, Xiong et al. [15] calculated the ratio of enhanced intensity in the plaque to that in the lumen. Slightly differently, Moguillansky et al. [3] used the ratio of peak intensity in the adventitia to that in the lumen. However, in all these intensity based studies, the intensity is averaged as the mean or median gray levels of pixels in a region of interest (ROI), so that the information of spatial distribution of contrast agents is neglected. Hoogi et al. [4] proposed an area based method by calculating the ratio of the IPN area to the total plaque area. This area ratio measures the relative extent of contrast agents inside a plaque, with a larger value representing more extensive spatial distribution of contrast agents. It is different from the intensity based quantities, as illustrated with an example in Fig. 1. The area ratio is proved to be correlated well with histopathologic results, demonstrating the great value of incorporating the information of spatial distribution in quantification of IPN on CEUS [4].For the calculation of this area ratio, named the traditional area ratio (AR,H), CEUS images of a plaque are segmented offline frame by frame in a video sequence that is previously acquired in real time during patient examination. The image segmentation is used to detect IPN regions in each frame, and then an accumulation process is performed by integrating these regions from all frames to obtain the total area of IPN. However, there arise four questions.First, CEUS images are corrupted by speckle noise, which makes robust image segmentation a difficult task [16]. It is complicated, cumbersome and time-consuming to segment a CEUS sequence frame by frame. When the accumulation of the segmented frames is conducted to derive the total IPN area, the segmentation error in all frames might also be accumulated. How can we determine the IPN area in a more accurate and efficient way?Second, a CEUS sequence acquired from pre-injection of contrast agents to post-injection usually consists of hundreds and thousands of frames, so that a sub-sequence containing several cardiac cycles needs to be selected from the long sequence to simplify the computing [4,17]. But for an effective and objective analysis, which portion of the long sequence should be selected?Third, it needs electrocardiogram (ECG) gating for the selection of sub-sequence [4,13]. In clinical CEUS examinations, we may not always record ECGs; even if we do, the recorded ECGs may not be synchronized with CEUS. In that case, can we retrieve cardiac cycles from the CEUS data themselves?Finally and most importantly, there is detailed information of contrast agent spatial distribution that both the intensity and area based methods have ignored. Coli et al. [9] stated that the neovascularization should derive mainly from the adventitial vasa vasorum network and, therefore, progressively grow from the external layers toward the plaque core. In addition to the area ratio, the uniformity or nonuniformity of the contrast agents may also reflect the distribution characteristics of contrast agents [18]. Therefore, the degree of neovascularization invading to the plaque core and the uniformity of the contrast agents within the plaque appear to be promising features describing the spatial distribution of contrast agents. From the viewpoint of image processing, these features can be regarded as measures of texture within the plaque [19]. Now the question is: how can we quantify them?The contribution of the paper is twofold. First, aiming at answering the aforesaid first three questions, we propose a computer-aided method for more objective and convenient detection of IPN. Second, in order to answer the last question, we propose extracting texture features to quantify the spatial distribution of contrast agents at IPN areas, including texture features based on grayscale images and binary images.An overview of the methods is summarized in Fig. 2and the details are described in this section. All algorithms were implemented by MATLAB R2007a (The MathWorks, Natick, MA, USA).The in vivo CEUS images were acquired at the Department of Ultrasound, Zhongshan Hospital, Fudan University, Shanghai, China. The study protocol was approved by a local institutional review board and informed consents were obtained from each patient. CEUS examination was performed with the Philips iU22 system (Philips, Bothell, WA, USA) using a convex-array transducer (C5-2). The mechanical index was set at 0.07, and the focal zone was positioned below the area of interest. The contrast agent SonoVue (Bracco, Milan, Italy) was injected intravenously at a dose of 2mL as a bolus, followed by an immediate flush of 5mL of normal saline solution. Simultaneously, the timer was activated so that the harmonic ultrasound images from the start of administration of SonoVue were continuously recorded. During the imaging, the probe was kept still and the patient was instructed to breathe quietly and suspend swallowing and coughing as necessary to prevent motion artifacts. For simplicity of the clinical examination, the image acquisition was performed without ECG-gating.CEUS sequences were captured from 24 patients with 33 plaques. The images were digitized to 480×640 pixels with 256 grayscales and a resolution of 118.8±35.0 pixels/cm at a sampling rate fs=15.8±1.8 (range: 10–18) frames/s, and they were stored on DVDs with the DICOM standard for offline analysis. IPN was categorized with a grading scale [10] by an expert who had 14 years of experience on ultrasound examination and was blinded to the proposed quantification technique. Grade 1 (G1) indicated no appearance of moving microbubbles in the plaque or bubbles confined only to the adjacent adventitial layer; grade 2 (G2) was reserved for images with moderate visible appearance of moving bubbles in the plaque at the adventitial side or plaque shoulder; and grade 3 (G3) indicated extensive IPN, with clear visible appearance of bubbles moving to the plaque core. In our study, there were 9, 11 and 13 plaques categorized to grades 1, 2 and 3, respectively.In a binary grading system, grade 2 and grade 3 were combined as the high grade (G2+G3) characterizing presence of contrast enhancement in the plaque, while grade 1 was the low grade representing the absence of contrast enhancement [9]. The low and high grades were assumed with low and high risk for plaque disruption, respectively.The change of lumen size that accompanies the pulsatile blood pressure causes the average gray level (AGL) of the CEUS images to exhibit a periodic variation during contrast agent perfusion [20]. We proposed a method for cardiac cycle retrieval by utilizing the cyclic AGL changes inside a rectangular ROI, which included the lumen, the plaque, the adventitia and some surrounding tissue. A fixed position and size of ROI in the image sequence was set so that a portion of the lumen and the arterial wall were included in each frame of the sequence. A CEUS image with a typical ROI is shown in Fig. 3a. The changes of the AGL signal over time are due to two main factors in addition to noise: the wash-in and wash-out characteristics of contrast agents and the changes of vessel morphology caused by cardiac motion and pulsatile blood pressure. The former contains the blood perfusion information usually with a low frequency, and the latter carries the cardiac cycle information with a major component at the heart rate, fr, which is around 1Hz and can be determined from the spectrum by using the Fourier transform of the AGL signal [20].The AGL signal can be depicted as a time-intensity curve (TIC) [14,21]. To extract the cardiac cycle information, the TIC was filtered to derive a cardiac cycle curve using a Butterworth bandpass filter, whose passband was from a low edge frequency fL=(1−α)frto a high edge frequency fH=(1+α) fr, where α, 0<α<1, was a factor for defining the half passband width. For extraction of the blood perfusion information, the TIC was filtered to obtain a blood perfusion curve with a Butterworth lowpass filter whose edge frequency of the passband was denoted as fL2=β·fL, where β, 0<β<1, was a scaling coefficient. In this study, α and β were empirically set as 0.1 and 0.25, respectively.From the two filtered TICs, successive frames with NCcardiac cycles were automatically selected as the sub-sequence for further image analysis. The peak in the blood perfusion curve was first detected and its corresponding frame determined the center of cardiac cycles, and then NC/2 cardiac cycles before and after the center were both selected according to the cardiac cycle curve. The NC-value in this paper was set as six. The reason of using the peak frame in the blood perfusion curve as the center of cardiac cycles was that the quantity of microbubbles in that frame arrived maximum in the sequence, ensuring a more legible visualization of the artery and plaque. The entire procedure is illustrated in Fig. 3. The TIC (Fig. 3b) was derived from the ROI defined in the image sequence (Fig. 3a), and it was filtered with the Butterworth lowpass and bandpass filters to obtain a smoothed blood perfusion curve (Fig. 3c) and a cardiac cycle curve (Fig. 3d).We proposed a three-step framework combining an image filtering technique of temporal averaging, an interactive delineation of the plaque in the temporal mean image, and an automatic detection of the IPN.The sub-sequence obtained from the previous section was denoted by Ii(x, y), i=1, 2, …, NF, where NFwas the number of successive frames given by:(1)NF=fs⋅NCfrHere NFframes can be regarded as a set of replicate measurements of signal corrupted by noise. By averaging the temporal series of these replicate measurements, a filtered image with an elevated signal-to-noise ratio (SNR) was produced, named the temporal mean imageI¯[22,23]:(2)I¯(x,y)=1NF∑i=1NFIi(x,y)Though the noise was reduced in the temporal mean image, the plaque in the image presented a high variability in shape and its echogenicity might be very similar to that of the lumen, adventitia and surrounding tissues, which led to the extreme difficulty of automatic segmentation of plaque. Hence, for simplicity, we applied an interactive process for the delineation of plaque borders.The grayscale image was coded and displayed with pseudo colors so that high intensities were mapped to yellow and red colors for better visualization as shown in Fig. 4d. User interactions were as simple as clicks on the image while selecting several points on the border of the plaque instead of tediously tracing the entire borders. The B-spline interpolation of the discrete points was used to get a smooth closed curve [24].The interpolated curve was displayed immediately after clicking, and it allowed the user to revise it by adding, deleting or replacing points. In practice, only a few interactions, usually clicking less than 10 points in less than 10s, were needed to yield satisfactory segmentation for one plaque.After the segmentation of plaque, the ROI was automatically updated for segmentation of IPN. In the temporal mean image, the minimum bounding box of the plaque was detected and extended with ten pixels at both vertical and horizontal dimensions, so that it was centered at the plaque core and included a portion of lumen and adventitia as shown in Fig. 4b.An automatic thresholding technique was utilized for segmentation of IPN. We applied the Otsu's thresholding method [25] to the plaque region to obtain a coarse threshold (T). The thresholding process only took into account the contrast enhancement inside the plaque, neglecting the brightness of the neighboring regions, so that it was sensitive to local disturbance of intensities within the plaque. Therefore, in this paper, the neighboring intensity outside the plaque was incorporated to the thresholding to get a revised and adaptive threshold:(3)Trev=T⋅[1+k(R¯Imax−RImax)]where RImax(0<RImax<1) was the ratio of the maximal intensity in the plaque to the maximal intensity in the ROI,R¯Imaxwas the mean of RImax-values for all plaques and served as a centralization parameter for composing the neighborhood term(R¯Imax−RImax), and k (>0), set as 0.05 in this paper, was a factor controlling the contribution of the neighborhood term. When RImaxwas large, the intensity inside the plaque was high and comparable to that in the ROI, specifically inside the lumen, so the neighborhood term was negative and the threshold was adaptively decreased to detect more contrast agents. When RImaxwas small, the neighborhood term was positive and less neovascularization was detected.After the segmentation of IPN, we got a binary image Ibin which the IPN was white on the black background as depicted in Fig. 4e. We measured the area of IPN (AV) and the area of plaque (AP) and calculated the area ratio (AR) as:(4)AR=AVAPTexture features were extracted from both the grayscale temporal mean imagesI¯and the binary images after segmentation Ib.The standard deviation (SD) and the entropy of the histogram (EtH) were calculated from the temporal mean imageI¯:(5)SD=∑x∑y[I¯(x,y)−I¯m]2N−1(6)EtH=−∑i=0255pilog2(pi)where N denoted the number of pixels in the image,I¯mrepresented the mean ofI¯, and pi, i=0, 1, …, 255, was the probability of the ith grayscale present in the image.Texture features were also calculated from the gray level co-occurrence matrix (GLCM), which had been widely applied in medical images, such as the B-mode ultrasound [26–28], computed tomography [29] and positron emission tomography [30]. In this paper, it was introduced to texture analysis for the CEUS image (I¯). The GLCM determined how often a pixel of intensity i found itself within a certain relationship to another pixel of intensity j. A given cell in the GLCM, denoted by G(i, j), indicated how many pairs of two pixels, separated by a specific distance d and direction θ, had the intensities i and j, respectively. The GLCM was normalized to get the joint conditional probability density function p(i, j)=G(i, j)/[∑i∑jG(i, j)], from which the texture features based on GLCM were derived, including the homogeneity (Hm) and entropy (Et) of GLCM:(7)Hm=∑i∑jp(i,j)(1+|i−j|)(8)Et=−∑i∑jp(i,j)log2p(i,j)The size of GLCM depended on the number of intensities in the imageI¯. To achieve a more efficient representation of the texture,I¯was requantized to 8 intensities from 256 and hence, the size of GLCM was reduced to 8×8. In our practice, the GLCM was calculated at a distance of d=6 pixels and four directions, θ=0°, 45°, 90°, 135°. The GLCM-based texture features were averaged over the four directions [29].Suppose there were npwhite pixels representing IPN in the binary image Ib, three of the texture features were extracted from Ibincluding the center deviation degree (CDD), radial deviation degree (RDD), and dispersion degree (DD). The former two were defined as follows and illustrated in Fig. 5a:(9)CDD=1np∑i=1npdiDi(10)RDD=1np−1∑i=1npdiDi−CDD2where di, i=1, 2, …, np, was the distance between the center of the plaque and the ith white pixel, and Didenoted the distance from the center of the plaque to the point of intersection between the plaque boundary and the extension line from the ith pixel. Here, di/Dican be regarded as a normalized distance between the center of the plaque and the ith pixel. Thus, CDD represents the average normalized distance from the IPN to the plaque core with a value between 0 and 1. And RDD is the standard deviation of the normalized distance, denoting the deviation of IPN along the radial direction from the boundary to the core. For calculation simplicity, di/Diwas computed after transforming the white pixels and plaque boundaries in Cartesian coordinates into those in polar coordinates.The DD was defined as follows and illustrated in Fig. 5b:(11)DD=1R⋅np∑i=1npriwhere ridenoted the distance between the center of the IPN and the ith pixel, and R was the mean radius of the plaque, which could be calculated as the mean distance from the boundary points of the plaque to the plaque center, or the square root of AP/π. DD was also a normalized quantity taking a value between 0 and 1, which measured the average normalized distance from each pixel in IPN to the IPN's center.We also proposed assembling the area ratio ARwith the texture features to get a combined area ratio(12)AR,com=AR·DDCDDBecause this combined feature integrated more information of spatial distribution of contrast agents, we expected it to have better performance for discriminating plaques than any of its member features that composed it.From the above methods, eight texture features were extracted in total.In order to examine the capability of the quantitative features in discriminating between qualitative grades, the features in different grades were compared using the independent two-sample t-tests and the one-way analysis of variance (ANOVA). The significance level of the statistical tests was represented by P-values. The ANOVA was performed among three grades and the t-tests were carried out for each two. Before performing the t-tests and ANOVA, the assumption of the normal distribution of each feature was examined by the Lilliefors test. If a feature did not meet the assumption, it should be transformed by log or other transformations before used in the t-tests and ANOVA.Besides t-tests, we also used the Fisher criterion of inter-intra class variance ratio (Fv) to examine the difference of a feature between two grades [31]:(13)Fv=(mi−mj)2(σi2+σj2)where the subscripts i and j represented two grades, and m and σ denoted the mean and standard deviation of a feature in a grade, respectively.The plaques were also categorized as binary grades, i.e., the low grade (G1) and high grade (G2+G3). We then assessed the classification performance of the quantitative features for identification of high-grade plaques from low-grade, based on the logistic regression classifier with leave-one-out cross-validation.The logistic regression calculated the class membership probability for the high grade (H) in the data set:(14)P(H|x,b)=11+e−xbwherex=[1,x1, x2, …, xNd]Twas a data sample in (Nd+1)-dimensional feature space, andb=[b0, b1, b2, …, bNd]Twas a coefficient vector. We chose a threshold TLR(0<TLR<1) and classified a data point as belonging to the high grade if P(H|x, b)≥TLRand to the low grade otherwise. The leave-one-out cross-validation involved using a single observation from the original 33 samples as the test set of the logistic regression classifier, and the remaining observations as the training set. This was repeated such that each observation in 33 samples was used once as the test set.True positive (TP) was defined as the number of high-grade plaques that were correctly identified, and false negative (FN) as the number of high-grade plaques wrongly classified as low-grade. Similarly, true negative (TN) or false positive (FP) was given by the number of low-grade plaques correctly or wrongly classified. The sensitivity was defined as TP/(TP+FN), the specificity TN/(TN+FP), and the accuracy (TP+TN)/(TP+FN+TN+FP). The threshold TLRin the logistic regression classifier was varied from 0 to 1 with an interval of 0.025, so that the sensitivity and specificity at a certain threshold were obtained and the optimal sensitivity, specificity and threshold were determined as those with the largest accuracy. The sensitivity and specificity at various thresholds composed a receiver operating characteristic (ROC) curve, and the area under the curve (AUC) was calculated for evaluation of classification performance.

@&#CONCLUSIONS@&#
In conclusion, a computer-aided approach is proposed in this paper for objectively and conveniently quantifying the spatial distribution of contrast agents within plaques in CEUS image sequences. It consists of three algorithms, including cardiac cycle retrieval and sub-sequence selection, temporal mean image segmentation, and texture feature extraction. The results on 33 plaques demonstrated the usefulness of the method for objectively and conveniently quantifying the spatial distribution of contrast agents within plaques. Contrasted with the traditional area ratio, statistical tests including t-tests and ANOVA revealed more significant difference of the proposed quantitative features between three qualitative grades as categorized by an expert. Results of logistic regression classification further demonstrated advantage of our quantitative features for distinguishing between low-grade and high-grade plaques.The method only needs a few manual operations, thus leading to objective and convenient description of the IPN. Furthermore, compared with the traditional feature, the proposed quantitative features have found more significant difference between qualitative grades and presented better performance for discriminating grades, which suggests that they can more accurately and comprehensively quantify the characteristics of IPN.Future work includes the accumulation of the plaque samples to evaluate the algorithms on a larger database. Histological studies are also expected to link the proposed quantitative features with histological measurements. The quantification method may contribute to the assessment of plaque vulnerability and to the planning of future therapeutic strategies.