@&#MAIN-TITLE@&#
Deciding kidney-offer admissibility dependent on patients’ lifetime failure rate

@&#HIGHLIGHTS@&#
We provide a flexible model for the kidney allocation problem.The optimal policy changes dramatically between patients.The model can serves both patient and the decision maker.An easy software tool is available.

@&#KEYPHRASES@&#
Organ allocation,Centralized decision making,Patient-choice,Erlang lifetime,Optimal stopping,

@&#ABSTRACT@&#
We use developments in full-information optimal stopping to decide kidney-offer admissibility depending on the patient’s age in treatment, on his/her estimated lifetime probabilistic profile and his/her prospects on the waiting list. We allow for a broad family of lifetime distributions – the Gamma – thus enabling flexible modeling of patients survival under dialysis. We fully automate an appropriate recursive solution in a spreadsheet application. It yields the optimal critical times for acceptance of offers of different qualities, and the ensuing expected value-to-go as a function of time. The model may serve both the organizer of a donation program for planning purposes, and the particular surgeon in making the critical decision at the proper time. It may further serve the potential individual recipient, practicing present-day patient-choice. Numerical results and their discussion are included.

@&#INTRODUCTION@&#
The US UNOS (United Network for Organ Sharing), the ERBP (European Renal Best Practice) and the Eurotransplant organization outline policies by which kidneys of the deceased are allocated locally, regionally and nationally (Eurotransplant manual, 2014; ERBP, European Renal Best Practice; US HRSA/OPTN, 2008a). They emphasize that the final decision to accept a particular organ remains the prerogative of the transplant surgeon and/or physician responsible for the care of the candidate in parallel, apatient choice practice has developed in recent years. Often, the choice is relegated to the patient (See Ahn & Hornberger, 1996; Su & Zenios, 2004a; 2004b; 2006; US HRSA/OPTN, 2008a and references therein). Patient-choice, particularly with regard to transplantation, benefits from hired professional advice. Because minor-quality kidneys are repeatedly refused for transplantation by patients on the waiting list and by their surgeons, excessive organ wastage is generated. To cope with this problem UNOS issued the ECD (Expanded Criteria Donor) policy, so kidneys from marginal donors are reserved for patients who declare in advance their willingness to accept such organs (US HRSA/OPTN, 2008a). Recently, shared decision making in kidney transplantation has been advocated impressively by Gordon et al. (2013). The question to be asked is what scientific and fact-based decision aids exist to help the individual in making such a critical decision, or the organizer of a donation program in assessing the future outlook of a pool of individual patients. The lack of accurate aids is explained by the immense difficulty of the analysis of a regulated dual donor-recipient streams (see Boxma, David, Perry, & Stadje, 2011; Yuan, Feldhamer, Gafni, Fyfe, & Ludwin, 2002; Zenios, Cherow, & Wein, 2000). Consequently, alternative decision-analytic approaches are sought. Such directions are heuristics - but still more analytically sound than the extant point system. For example, Yuan et al. (2002) suggest a fuzzy logic approach. The authors show, by way of example, that the fuzzy logic based policy is closer to an expert’s (a medical practitioner) opinion than the policy attained by the UNOS point system. The authors, Chun and Sumichrast (2006) suggest a “rank based” approach for a selection problem applied to kidney allocation. The model proposed in the present work provides an analytical tool to help bridge the said decision-aid analytical gap, accompanied by an easy to use Excel workbook. The model and the software should prove useful to the individual patient, the consultant, the physician, and the social planner. We focus on the prospects of the individual patient. Optimizing the case of the single candidate (see e.g. Hornberger & Ahn, 1997) applies directly to patient-choice. As we show, it may further serve as a building block in the analysis of the dual (donor-recipient) queueing system at large. We ask for the patient’s optimal, time-dependent, acceptance-rejection policy for kidneys of various quality, as a function of his/her blood-type (ABO) and immunological tissue characteristics (HLA). This policy depends also on the individual’s deteriorating lifetime distribution under dialysis, and we assume that this lifetime distribution is Gamma(α, θ) with the shape parameter α being some integer (Erlang distribution). We use the recent study by Bendersky and David (2015) in full-information optimal stopping to suggest a computational scheme which determines the optimal policy for the patient in question, in terms of critical times. The Gamma has long been popular in survival analysis and in medical research, with practical examples dating back to the 1950’s (Collett, 2003; Lawless, 2011; Lee & Wang, 2003). The two-parameter Gamma family furnishes enough agreement in fitting it to many relevant datasets (Gupta & Kunda, 1999), and it admits ordering in distribution and in hazard rate, with respect to the shape parameter. Yet, due to the fact that the Gamma has no closed form for its cumulative distribution function, researchers preferred sometimes the Weibull or the generalized exponential. Still, in our case we show that letting the shape parameter be a positive integer (the Gamma becoming Erlang) we can compute both the value functions and critical times while providing enough flexibly for the modeling of different profiles of deterioration.Our model relies on the quantification of rewards from each candidate and kidney-donation matching, on the ABO and HLA distribution in the population to which donors belong, and on the donation rate μ. In fact, to pass from the realm of the single candidate to that of the competitive world, we propose, by way of approximation, to use a value of “effective μ” – an expected average rate of future offers which become available to the specific candidate in question. This figure is to be assessed via databases such as UNOS’s or the ERA-EDTA’s. The effective μ will also have to take into account the candidate’s position in the queue. The present exposition is supported by real data regarding the above mentioned factors.In Section 2 we briefly outline the determinants of successful transplantation. Section 3 provides basics of the needed temporal modeling. Section 4 outlines the analysis of the stopping problem for Gamma deterioration, and the single-candidate decision algorithm. Section 5, accompanied with the appendices to this paper, demonstrates the use of the Excel application with numerical examples. These examples are then followed by a discussion, and Section 6 concludes the paper. We emphasize at the outset that the random offer value X in our model may not be based on HLA (Human Leukocyte Antigens, see below) match levels, but rather on any finite set of real values of kidney quality, as perceived by the decision-maker. In particular, it may be based on subjective probabilities or on utilities as perceived by the client and/or his/her advisor within the praxis of patient choice. As the HLA remains a significant factor in the allocation of live kidneys worldwide, and because real-life data with respect to tissue matching are available, we base our presentation on this criterion.We begin by discussing the major factors that influence the success in kidney transplantation. These factors function in most allocation systems in prioritizing the pool of waiting candidates vis-à-vis any pending donor kidney.Human tissue cells contain antigens that vary from person to person and are immunologically relevant to the specific organ. The system of these antigens is known as the HLA system. It can be sub-divided into two groups: Class I that contains A, B or C antigens, which are present in body cells that have a nucleus, and Class II that contains antigens of the types DP, DR and DQ which are present only in the membranes of the cells responsible for triggering the immune system. The A, B,...,DQ antigens are arranged in sites A, B,...,DQ respectively. Every HLA site contains two alleles. Since the 80’s, from the entire HLA genetic complex, sites A, B and DR were considered transplant relevant antigens. If transplanted into another individual, they can cause an immune response that can lead to the rejection of the graft. Yet, different medical centers put different emphases on the three sites, so that the same match combination may score differently. Part of the question is whether the benefit from HLA matching is worth the economic and social costs, including the rationing of fewer donor organs to black recipients (see Held et al., 1994; Vereestraeten et al., 1999). Lefaucheur et al. (2010) is an example for recent years renewed emphasis on the HLA matching for graft survival. In this exposition, we assume that any A, B or DR donor antigens which do not match the recipient can trigger an immune response. The higher the total number of such antigens, the lower the chance of a successful transplant. So, seven possible match-levels are possible - zero (all 6 alleles, aranged in three sites, do match) to six mismatches (none match). In assessing the future prospects of a given candidate, the HLA gene-distribution in the relevant donor population is assumed to be known.One comprehensive source concerning histocompatibility testing is Cecka and Reid (2005).The blood types of the donor and the recipient must also match. In allocation systems worldwide O donors go to O recipients exclusively, except for the case when there is a recipient with a zero antigen mismatch. (UNOS and Eurotransplant have a similar ABO-B rule for donors and recipients). The incorporation of the ABO match probability to the tissue match probability of a random donor to a given candidate is routine (see Barnes & Miettinen, 1972). In our model, this probability may simply multiply the relevant donor arrival rate to yield an effective μ. (Since a Poisson process with rate μ and a probability p of counting any arrival yields a Poisson process with rate μp. See also Section 3.2 below). One may assume statistical independence between tissue classification and blood type.Pediatric patients are allocated extra score points. Also, each extra year on the waiting list credits the candidate with extra points. These two quantifying criteria may also be taken into account by an effective μ. There is an additional determinant factor in transplantation, called PRA (Panel Reactive Antibodies). It refers to a periodical immunological check of each candidate (Cecka & Reid, 2005; Eurotransplant manual, 2014). Although the PRA status is included in allocation systems, we choose not to include it in the present exposition.Let us denote the reward for a given candidate from a random offer by X, a discrete random variable. In this presentation X is a one-to-one function of I, the total number of mismatches in the HLA A, B and DR sites combined. Medical assessments as to how to translate the number of HLA-mismatches I to X vary, mainly because controversy surrounds the question of what gain needs to be measured. See Gold, Siegel, Russell, and Weinstein (1996) for the prevailing notions of QALY (quality-adjusted life-years), QALE (quality-adjusted life expectancy) and discounted-QALY (see also Evans, Tavakoli, & Crawford, 2004 for a critique). The present work adopts an alternative measure, that of (post-transplant) 3-years graft-survival. Table 1below summarizes the distribution of X which is used for the numerical examples in Section 5. The sources of these data are indicated in Section 5.1 and in Appendix A.Obviously, the deteriorating profile of lifetime under dialysis treatment must be reflected in any prescriptive model for acceptance-rejection of a kidney for transplant. David and Yechiali (1985) used dynamic programming to show that if the lifetime of the candidate is Increasing in Failure Rate (IFR), which is certainly the case under kidney failure, then the optimal threshold function λ(t) for accepting an offer is a continuous non-increasing function of time. Further progress is offered in the recent optimal-stopping study by Bendersky and David (2015), which provides an explicit form for λ(t) in the case of any Erlang underlying deterioration and dicrerte random variable X of offer value.The hazard-rate (failure-rate) function of a lifetime is defined byr(t)=limx→01x(1−G¯(t+x)/G¯(t))whereG¯(t)=1−G(t)is the survivor function and G(t) is the lifetime cdf. For the Erlang(n, θ)(1)r(t)=1(n−1)!/∑k=0n−1θk−ntk−n+1k!.(See e.g. Lee & Wang, 2003, p. 152.) The distribution Γ(α, θ) (α=nfor the Erlang case as the shape parameter) is IFR for α ≥ 1 (Barlow & Proschan, 1975). From Eq. (1) it is straightforward thatlimt→∞r(t)=θ. Also, the presentation[r(t)]−1=∫0∞(1+ut)α−1e−θudu(see Barlow & Proschan, 1975 again) gives that if X ∼ Γ(α1, θ1), Y ∼ Γ(α2, θ2) and α1 > α2 > 1 then ifθ1=θ2,rX(t) < rY(t) for all t > 0. For integer α’s it is intuitive that Y is more surviving than X by the interpretation of the Erlang-n as a sum of n memoryless shocks. This observation is useful in comparative interpretation of lifetimes, and in assigning them a Gamma distribution. It is worth noting that if X and Y have the same expectation and α1 > α2 > 1 then θ1 > θ2 and no hazard ordering applies (See Fig. 3 in Section 5.1 below).We assume that the decision maker faces a random Poisson stream of offers, with rate μ. In our examples, below, the original value of μ is modified to account for scaling of time. If an estimated proportion of the offers is discarded, e.g. because kidneys go to preferred candidates on the waiting list, an effective μ may be used, and the stream remains Poisson.In defining V(t, x) — the optimal expected discounted reward from offerX=xat time t and on, V(t) — the optimal expected reward at time t just before a bid arrives, and λ(t) the future expected reward if the offer is arbitrarily rejected at time t while an optimal strategy is applied thereafter, the basic dynamic-programming equation isV(t)=EXV(t,X)=E[max(λ(t),X)].X admits a finite number of values x1 > x2 > ⋅⋅⋅ > xm, with probabilitiesp1,p2,…,pmrespectively. In our casem=7as the number of possible mismatches. x1 is the kidney value forI=0— zero HLA mismatches — down to x7 which is the kidney value forI=6— maximum HLA mismatches. Letti=max{0,λ−1(xi)}. If λ(t) > xifor all t ≥ 0 setti=∞. The ti’s are the critical times.0=t1≤t2≤⋯≤tmbecause λ is non-increasing in t for any IFR lifetime. A region is a period between two consecutive ti’s. Thus, for region i,   1 ≤ i ≤ m, we havexi+1≤λ(t)≤xiandti≤t≤ti+1(withtm+1≡∞). When in region i, only xiand higher offers (xjs.t. j ≤ i ) are acceptable. (i−1and smaller numbers I of mismatches are acceptable). Some regions can be vacuous. Fig. 1provides a schematic depiction of λ(t).In this Section we present needed material from Bendersky and David (2015), and move on to formulate a solution algorithm, applicable to the kidney application.For the Erlang case we have that(2)λ(t)=(Die−Ait+Bi1+Ai∑k=0n−1(1−(−Ai)k−n)tkk!)/∑k=0n−1tkk!for each region i, where Aiand Biare constants depending only on the distribution function of X, FX(x). Diis an integration coefficient. Each region i has its own Ai, Biand Di. The Ai’s and the Bi’s are calculated using the following result:Proposition 4.1Bi={−μq1x1ifi=1−μ[∑j=1i−1qj(xj−xj+1)+qixi]ifi=2,…,mAi=−(1+μqi),i=1,…,mwhereqi=∑j=1ipj,i=1,2,…,m.Proofs for Eq. (2) and Proposition 4.1 are detailed by Bendersky and David (2015).Having Proposition 4.1 we need to determine imax  - the last region attained by λ(t). Since λ(t) is bounded∃limt→∞λ(t)=Land sinceAimax<0,we have from (2) thatDimax=0(otherwise λ(t) does not converge). In dividing the nominator and denominator of (2) bytn−1it follows that(3)L=BimaxAimaxallowing for the determination of imax : by monotonicity of λ(t) there exists exactly one region i for which the ratio in the R.H.S of (3) lies betweenxi+1and xiand this is the rightmost region (in t).imax=i. (See Section 5 below for a numerical example how to obtain imax  and L ). Now,(4)λ(timax)=ximax.timax(the last critical time which is attained by λ(t)) can be found by (2), that is, by solving for t in:(5)ximax=Bimax1+Aimax·∑k=0n−1tkk!(1−(−Aimax)−(n−k))/∑k=0n−1tkk!.Havingtimax,the rest of the critical timesti*,and Di’s , i ≤ imax , are computed by an iterative procedure as explained in Section 4.1 below. This procedure further gives an explicit expression for λ(t) for all t (region dependent).First, determine Ai, Biusing Proposition 4.1 and determine imax  andtimaxby (3) and (5). Next, leti=imax,and specifyDi−1by:(6)Di−1=∑k=0n−1tiketiAi−1k!(xi−Bi−1Ai−1+1(1−(−Ai−1)−(n−k))).ti−1is extracted from solving the equation(7)xi−1=(Di−1e−tAi−1+Bi−1Ai−1+1∑k=0n−1tkk!(1−(−Ai−1)−(n−k)))/∑k=0n−1tkk!in t. Applying (6) and (7) repeatedly by lettingi:=i−1we obtain all the lower critical times. When (7) admits no solution, the process stops. We letimin=iandt1=...=timin−1=0.A pseudocode of this algorithm appears in Appendix B.The optimal policy is determined as follows: when the waiting time t is between tiandti+1the individual accepts only bid xiand higher. Bidsx1,…,ximin−1are always acceptable. Bidsximax+1,…,xmare never acceptable.Based on the results of Section 4 and on the solution algorithm, we present a few numerical examples. The two examples in Section 5.1 emphasize the significance of coping with the general Erlang case in modeling deterioration. It is shown that fitting the life distribution in changing the shape parameter n while maintaining a fixed life expectancy may affect considerably the optimal policy. In Section 5.2 we demonstrate the use of the application in research and planning, by studying the impact of donation rate. (Although numerical figures are presented in 4 decimal places in this paper, subsequent calculations are based on sufficient precision).We choose for the patient under discussion the following HLA antigens: # 2 and # 2 in site A (homozygous), #8 and #35 in site B, and #0 and #4 in site DR. The entire gene distributions for the three sites, for the US population, were taken from UNOS website (see Table A.5 in Appendix A below). For the quantification of the offer value X we use data regarding 3-year survival rate, taken from US HRSA/OPTN-SRTR (2008b). (See Table 5.10a: Unadjusted Graft Survival, Deceased Donor non-ECD Kidney Transplants, Survival at 3 Months, 1 Year, 3 Years, and 5 Years). The probabilities of the seven possible values of XP(I=0),…,P(I=6)are calculated by Eqs. (C.3)–(C.9) in Appendix C below. All combined, the data lead to Table 1, the distribution of kidney values X. The donation rate, as experienced by the decision-maker, is taken to beμ=20annually. The candidate’s life expectancy is taken to be 5 years. This figure relates to lifetime under dialysis which presently pertains to patients in the age group of 60–64 years. (European data, see European Renal Association & Registry, 2008 p. 79). In the first example we assume thatα=2. Thus we may substituteθ=1in the computations andμ=20·2.5=50(2.5 years is a new time unit which complies with a Gamma expectationα/θ=2). Using Table 1 and Proposition 4.1 we arrive at Table 2, which specifies the required constants for the computations.To demonstrate the algorithm and the iterative scheme, we solve this example manually. We start in identifying the maximal-index region in Table 2 which is attained by λ(t). Forimax=6,L≡limt→∞λ(t)=Bimax/Aimax=0.7650. (Indeed, this value is betweenx7=0.75andx6=0.771. See Eq. (3). This identification of imaxand L is easily automated, based on Table 2).So, in [t6, ∞] Eq. (2) takes the simple form(8)λ(t)=b+at1+t,whereb=B6A6(1−1A6)=0.7828anda=B6A6=0.7650. (This is becauseD6=0. Note that n is the Erlang parameter,n=α=2). The determination of tiin this iteration is immediate by inverting (8),t6=λ−1(0.771)=1.9560,which is 4.89 years. Next, the determination of D in the following region (Region 5) is based on the continuity of λ(t) and on the recent knowledge of the rightmost t in that region.D5=2.1458·10−25(substituteA5,B5,t6=1.9560andx6=0.771in the R.H.S. of Eq. (6)). The following step is the inversiont5=λ−1(0.786)=0.2104,which is 0.53 years. Hereλ(t)=(b+at+D5e−A5t)/(1+t)whereb=(B5/A5)(1−1/A5)=0.7914anda=B5/A5=0.7605. For Region 4,D4=6.9913·10−4and we havet4=0. The timest3=0,t2=0,t1=0are set to 0 as well, and we are done. See Fig. 2 and Table 3forα=2.As a second example, consider the case whereα=8while we keep the former life expectancy. Thusθ=1.6. The annual arrival remains the same as before, now translated toμ=12.5withθ=1. Table 1 is still in effect (same recipient with same donor population as before). The obtained critical times are given in Table 3, columnα=8. The calculations are performed using the Excel spreadsheet.It can be seen that in the beginning the lifetime distribution withα=2,the more skewed, is better for the patient than the distribution withα=8. But this preference is reversed as time under dialysis goes by, an outcome might have been anticipated in examining the respective failure rates as functions of time. See Fig. 3.As is frequently the case with spreadsheet applications, various important sensitivity analyses may be easily performed. To illustrate, we check the sensitivity of the critical times to thedonation rate. Table 4below summarizes “reject until” results. They are obtained simply by adjusting the μ input-cell in the main sheet. We raise the value of μ from 10 to 20, 50, 400, 1000 and 10000. For each HLA match level (or, more generally, kidney-candidate matching reward which is distributed as X), the corresponding critical time is stated. As expected, the candidate becomes pickier as μ rises. Equivalently, the candidate becomes less picky with dimmer prospects of future offers, combined with deteriorating life expectancy upon dialysis. However, the exact figures are hardly predictable. Forμ=10a kidney with 3 mismatches is always accepted. If μ is 5 times bigger, the candidate only enjoys some 45 days (0.12 year) of rejecting such a kidney (I=2orI=1are still never rejected). Forμ=1000— only a fictional figure in the present state of affairs — a kidney withI=2will be rejected for about the first 5 months. However, no kidneys with lesser value will be accepted thereafter. Thus, even a candidate with top-priority should not reject a second-best kidney (I=1), after some 2 months. A perfect match in unrelated donor transplantation is a golden opportunity.The spreadsheet shows that ifα=1,the results are always split between accept and reject. This is no surprise, becauseα=1means an exponential, memoryless lifetime. Thus, the threshold function λ(t) is constant over time, a horizontal line in Fig. 1. Temporal modeling in past research assumed the exponential, which proves now to be over-simplistic.It is evident that theX−Pentries (value, or utility, vs. probability) for the algorithm may be arbitrary. In the spreadsheet, one may overwrite the existing formulas for the HLA probabilities, and enter figures as one sees fit. For more than 7 X-values, some programming modification is required. For less than 7 values, the extra lines in theX−Parray may stand for dummy offers, in a straightforward manner. Recall that for applications such as patient choice (not necessarily in context of transplantation), the X distribution may even be tentative or subjective.

@&#CONCLUSIONS@&#
