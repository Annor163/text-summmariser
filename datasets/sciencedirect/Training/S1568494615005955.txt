@&#MAIN-TITLE@&#
Credibilistic multi-period portfolio optimization model with bankruptcy control and affine recourse

@&#HIGHLIGHTS@&#
We propose a fuzzy multi-period portfolio model with bankruptcy control and affine recourse.A hybrid particle swarm optimization is designed for solution.Empirical example is given to express the application of our model.Comparative results demonstrate the effectiveness of the designed algorithm.

@&#KEYPHRASES@&#
Multi-period portfolio optimization,Credibility measure,Bankruptcy control,Hybrid PSO algorithm,

@&#ABSTRACT@&#
Avoiding the possibility of bankruptcy during the investment horizon is very important to multi-period portfolio management. This paper considers a multi-period fuzzy portfolio selection problem with bankruptcy control. A multi-period portfolio optimization model imposed by a bankruptcy control constraint in fuzzy environment is proposed on the basis of credibility theory. In the proposed model, a linearly recourse policy is used to reflect the influence of historical predication basis on current portfolio decision. Three optimization objectives, viz., maximizing the terminal wealth and minimizing the cumulative risk and the cumulative uncertainty of the returns of portfolios over the whole investment horizon, are taken into consideration. For solving the proposed model, a fuzzy programming approach is applied to transform it into a single objective programming model. Then, a hybrid particle swarm optimization algorithm is designed for solution. Finally, an empirical example is presented to illustrate the application of the proposed model and solution comparisons are also given to demonstrate the effectiveness of the designed algorithm.

@&#INTRODUCTION@&#
One of the basic principles of financial investment is diversification where investors should allocate their capital among different assets according to their own preferences. Markowitz [37] originally proposed the well-known mean-variance (MV) model, which laid a fundamental basis for single-period portfolio selection. However, in real life, investors tend to construct multi-period portfolios and they usually need to rebalance their positions from time to time. After Markowitz's pioneering work, numerous researchers extended his work to multi-period case, see for instance in Elton and Gruber [14], Hakansson [20] and Mossin [39].Nowadays, there has been a continuing effort in extending portfolio selection from single-period case to multi-period case by using different approaches. Li and Ng [31] used the same approach to handle the continuous-time setting portfolio selection problem by using the idea of embedding the problem in a tractable auxiliary problem. Then, they obtained breakthrough result, that is, the optimal mean-variance portfolio policy and the corresponding efficient frontier. Cui et al. [11] proposed a mean-variance model for multi-period portfolio selection problem with no shorting constraint. Li et al. [32] presented a dynamic mean-variance model by taking no-shorting constraints into consideration and obtained the efficient frontier and the efficient investment strategies for original mean-variance problem. Yan et al. [53] proposed a class of multi-period semi-variance model and designed a novel hybrid genetic algorithm (GA) with particle swarm optimization (PSO) for solving the proposed model. Calafiore [3] investigated multi-period sequential decision problems for financial asset allocation and proposed a multi-period portfolio selection model with the objective of minimizing a cumulative risk measure over the investment horizon, while satisfying portfolio diversity constraints at each period and achieving or exceeding a desired terminal expected wealth target. Costa and Araujo [10] considered a multi-period generalized mean-variance model with Markov switching in the key market parameters. Several multi-period portfolio optimization models in stochastic market where consists of a riskless asset and several risky assets were explored by Çelikyurt and Özekici [5]. In [22], a multi-period stochastic optimization model was formulated for dynamic asset allocation.As we know, in multi-period investment setting, a bankruptcy may occur when the total wealth of an investor falls below a predetermined “disaster” level in any intermediate or the final time period. Thus, how to control the occurring of bankruptcy in multi-period portfolio selection has become a hot topic in financial risk management. Nowadays, some researchers have investigated the bankruptcy control problems for multi-period portfolio selection under the framework of probability theory, see for example Li and Li [29], Wei and Ye [52] and Zhu et al. [59]. Note that above-mentioned bankruptcy control models used variance as risk measure. However, due to make no distinction between gains and losses, variance risk measure has a distinguished drawback. Specially, when probability distributions on the rates of return on risky assets are asymmetric, variance becomes a deficient risk measure because it may have a potential danger to sacrifice too much expected return in eliminating both low and high return extremes. Yu et al. [55] substituted the classical variance with the absolute deviation as risk measure and proposed a dynamic portfolio optimization model with risk control. Though, it can simplify the computation by using absolute deviation as risk measure. It still cannot distinguish gain and loss. Besides, transaction costs is not incorporated into these bankruptcy control literatures mentioned above, which may lead to an inefficient portfolio. So it is necessary to present a more realistic risk control model for multi-period portfolio selection.Most of literatures were formulated on the basis of probability theory. Though probability theory is one of the main tools for handling the uncertainty in finance, it cannot describe uncertainty completely since there exist many non-probabilistic factors in financial markets such as economic, social, political and people's psychological factors, etc. Thus, the fuzzy uncertainty associated with financial markets cannot be neglected. With the widely use of fuzzy set theory in Zadeh [56], more and more researchers have realized that they could use fuzzy set theory to handle the fuzziness, vagueness or ambiguity in financial markets such as Alimi et al. [1], Ghaffari-Nasab et al [16] and Gharakhani and Sadjadi [17]. Actually, fuzzy portfolio selection problem was researched from 1990s. Based on possibility theory, numerous portfolio selection models had been proposed, e.g., Carlsson et al. [4], Deng and Li [12], Tanaka and Guo [47] and Zhang et al. [58]. Due to the self-dual of possibility measure, Liu and Liu [34] defined a self-dual measure (i.e., credibility measure) to quantify the chance of occurrence of fuzzy events. After that, numerous researchers proposed several portfolio selection models based on credibility measure such as, mean-variance model [23], mean-semivariance model [24], mean-variance adjusting model [57] and so on. Though, various portfolio selection models with fuzzy returns have been proposed. Most of them are single-period portfolio selection models. The research about multi-period portfolio selection in fuzzy environment is still in exploration phase. In 2011, Sadjadi et al. [42] investigated a fuzzy multi period portfolio selection problem with different borrowing and lending rates. Liu et al. [36] and Zhang et al. [63] discussed multi-period portfolio selection problems in fuzzy uncertain economic environment by using possibility theory. Zhang and Liu [62] studied multi-period portfolio selection problem with bankruptcy control in fuzzy environment based on credibility measure. To our knowledge, few researches have considered the influence of historical predication bias on current portfolio decision for multi-period fuzzy portfolio selection problem with bankruptcy control. The purpose of this paper is to discuss the bankruptcy control problem with feedback control policies for multi-period fuzzy portfolio selection. Different from Zhang and Liu [62], we use credibilistic lower absolute deviation as risk measure. Meanwhile, we consider the effect of the uncertainty associated with fuzzy returns on risky assets and use credibilistic entropy to measure them. In addition, we apply linear recourse policies to reflect the control action of historical predication bias on current decision. We propose a credibilistic multi-period portfolio optimization model with bankruptcy control and affine recourse.The remainder of this paper is organized as follows. For the better understanding of the paper, we introduce some basic definitions about fuzzy variables in Section 2. In Section 3, we formulate a credibilistic multi-period portfolio optimization model with bankruptcy control and affine recourse. In Section 4, we first apply the fuzzy programming approach in Zimmermann [61] to transform the proposed model into a single-objective optimization problem. Then, we design a hybrid particle swarm optimization (PSO) to solve it. In Section 5, we give an empirical example to illustrate the application of our model. Meanwhile, solution algorithm comparisons are also given to demonstrate the effectiveness of the designed algorithm. Finally, we conclude the paper in Section 6.In this section, let us first briefly review some concepts of credibility theory, which we need in the following sections. Let ξ be a fuzzy variable with membership function μ(x) and u be a real number. Then, the credibility of {ξ≤u} is defined as (see Liu and Liu [34])(1)Cr{ξ≤u}=12(supx≤uμ(x)+1−supx>uμ(x)),where credibility measure Cr is self-dual, i.e., Cr{ξ≤u}+Cr{ξ≥u}=1. When the credibility value of a fuzzy event achieves 1, it means that the fuzzy event will surely happen. Fuzzy events with credibility values will lead to different occurring chances. The fuzzy event with higher credibility value will have more chance to happen. In this paper, we use credibility measure to quantify the chance of a fuzzy event occurring.For example, if ξ=(a, α, β) is a triangular fuzzy number, its membership function μξ(x) can be expressed as follows (see Fig. 1(a))μξ(x)=x−(a−α)α,ifa−α≤x≤a,a+β−xβ,ifa≤x≤a+β,0,otherwise.From Fig. 1, the following results can be obtained. If μξ(x)=1, then x equals to ξ with degree of membership one. If μξ(x)=0, then x belongs to ξ with degree of membership zero (i.e., ξ∉(a−α, a+β), ξ is too far from a). If μξ(x)∈(0, 1), then x belongs to ξ with an intermediate degree of membership (i.e., is close enough to a).By Eq. (1), the credibility of fuzzy event {ξ≤u} is given by(2)Cr{ξ≤u}=0,ifu≤a−α,u−a+α2α,ifa−α≤u≤a,β−a+u2β,ifa≤u≤a+β,1,otherwise,and the graph for the credibility of {ξ≤u} is illustrated in Fig. 1(b). Cr{ξ≤u} denotes the credibility that the triangular fuzzy variable ξ is no more than u.Definition 1Liu and Liu [34]Let ξ be a fuzzy variable. Then, the expected value of ξ is defined by(3)E(ξ)=∫0∞Cr{ξ≥t}dt−∫−∞0Cr{ξ≤t}dtprovided that at least one of the two integrals is finite.According to Eq. (3), the expected value of triangular fuzzy variable ξ=(a, α, β) is calculated by(4)E(ξ)=a+β−α4.Definition 2Liu and Liu [35]Let ξ be a fuzzy variable, and γ∈(0, 1]. Then, the optimistic and pessimistic functions of ξ are, respectively, defined asξsup(γ)=sup{r|Pos(ξ≥r)≥γ},ξinf(γ)=inf{r|Pos(ξ≤r)≥γ}.Theorem 1Liu and Liu [35]Let ξ be fuzzy variable with finite expected values, and let λ and μ be any given two real numbers. Then, we have(5)E(λξ+μ)=λE(ξ)+μ.By Definition 2 and Theorem 1, the following two theorems can be obtained.Theorem 2Let ξ and η be identically distributed fuzzy variables with finite expected values. Then, for any nonnegative real numbers λ and μ, we have(6)E(λξ+μη)=λE(ξ)+μE(η).ProofBy the decomposition principle of fuzzy number, for any given two ξ and η identically distributed fuzzy variables, we haveξ=∫γ∈[0,1]γ[ξγL,ξγR],η=∫γ∈[0,1]γ[ηγL,ηγR],whereξγL,ξγRandηγL,ηγRdenote the left and right end-points of the γ-level sets of ξ and η, respectively. Then, we haveξ+η=∫γ∈[0,1]γ([ξγL,ξγR]+[ηγL,ηγR]),=∫γ∈[0,1]γ([ξγL+ηγL,ξγR+ηγR]).Thus, ξ, η and ξ+η are identically distributed fuzzy variables. For any given nonnegative λ and μ, by Theorem 4.1 in Liu and Liu [35], we haveE(λξ+μη)=12∫01[(λξ+μη)sup(γ)+(λξ+μη)inf(γ)]dγ=12∫01[(λξsup(γ)+μηsup(γ))+(λξinf(γ)+μηinf(γ))]dγ=12∫01(λξsup(γ)+λξinf(γ))dγ+12∫01(μηsup(γ)+μηinf(γ))dγ=λE(ξ)+μE(η).The proof of the theorem is complete.Theorem 3Let p be a real number with 1≤p<∞, and let ξ and η be identically distributed fuzzy variables with E(|ξ|p)<∞ and E(|η|p)<∞. Then, we have(7)E(|ξ+η|)≤E(|ξ|)+E(|η|).ProofIt is a special case of Theorem 5 in Liu [33] when ξ and η are identically distributed fuzzy variables and p=1.Theorem 4Liu [33]Let ξ be a fuzzy variable. Then, for any given numbers ɛ>0 and p>0, we have(8)Cr{|ξ|≥ɛ}≤E(|ξ|p)ɛp.Similar to the below partial risk measures in Konno et al.[27], we define the credibilistic lower absolute deviation for a fuzzy variable ξ as follows.Definition 3Let ξ be a fuzzy variable with finite expected value E(ξ). Then, its credibilistic lower absolute deviation is defined as(9)LAD(ξ)=E[|(ξ−E(ξ))−|]=∫0∞Cr{(ξ−E(ξ))−≥u}du,where(ξ−E(ξ))−=ξ−E(ξ),ifξ≤E(ξ)0,ifξ>E(ξ).Notice that Eq. (9) only measures the volatility of ξ below its expected value E(ξ). Thus, it can be used as the risk measure for portfolio selection in fuzzy environment. By Definition 3, the lower absolute deviation LAD(ξ) of triangular fuzzy variable ξ=(a, α, β) is computed by(10)LAD(ξ)=(3max{α,β}+min{α,β})264max{α,β}=(3β+α)264β,ifβ≥α,(β+3α)264α,ifα>β.In Li and Liu [30], a fuzzy entropy is defined to measure the difficulty degree of predicting the specific value that a fuzzy variable will take as follows.Definition 4Let ξ be a fuzzy variable with continuous membership function. Then, the fuzzy entropy of ξ is defined as(11)H(ξ)=∫−∞∞S(Cr{ξ=r})dr,where S(x)=−xlnx−(1−x)ln(1−x).By Definition 4, for any given fuzzy variable ξ with continuous membership function μ(x), we have Cr{ξ=x}=μ(x)/2 for eachx∈ℝ. Thus, the fuzzy entropy can be expressed by(12)H(ξ)=−∫−∞∞μ(x)2lnμ(x)2+1−μ(x)2ln1−μ(x)2dr.Thus, by Eq. (12), the fuzzy entropy of triangular fuzzy variable ξ=(a, α, β) is calculated by(13)H(ξ)=β+α2.In this section, we discuss a multi-period portfolio optimization problem with bankruptcy control in fuzzy economic environment. We use affine recourse policies to reflect the influence of historical predication bias on current decision. We propose a credibilistic multi-period portfolio optimization model with bankruptcy control and affine recourse. Before introducing our model, we first give the following assumption and notations.Assume that an investor has an existing portfolio on n risky assets at the beginning period 1. The total wealth on the existing portfolio is W0, which is averagely allocated among n risky assets. The investor intends to construct portfolios in T consecutive investment periods among the n risky assets. Suppose that the investor can reallocate his wealth among the n risky assets at the beginning of each period. In traditional portfolio models, the return rates of risky assets are viewed as random variables. They are proposed under the framework of probability theory based on the assumption that the probability distributions of the return rates on risky assets can be accurately predicted. However, in the real world, the financial markets are affected by many non-random factors such as economic, social, political and people's psychological factors. In many cases, the return rates on risky assets are associated with fuzzy uncertainty. Similar to Chen and Huang [7], the return rates of the n risky assets at each period are assumed to be triangular fuzzy numbers in this paper. For convenience, we first introduce some notations as follows:rt,ithepredictedreturnrateofriskyassetiatperiodt,wherert,i=(at,i,αt,i,βt,i);r(t)thepredictedreturnvectoroftheportfolioatperiodt,wherer(t)=(rt,1,rt,2,…,rt,n);rˆt,itherealreturnrateofriskyassetiatperiodt,whererˆt,iisacrispnumber;rˆ(t)therealreturnvectoroftheportfolioatperiodt,whererˆ(t)=(rˆt,1,rˆt,2,…,rˆt,n);x˜t,itheinvestmentamountofriskyassetiatthebeginningofperiodt;x˜(t)theinvestmentvectoroftheportfolioatthebeginningofperiodt,wherex˜(t)=(x˜t,1,x˜t,2,…,x˜t,n)′;Δx˜t,itherealadjustmentamountonriskyassetiatperiodt;Δx˜(t)therealadjustmentvectoroftheportfolioatperiodt,whereΔx˜(t)=(Δx˜t,1,Δx˜t,2,…,Δx˜t,n)′;Δx¯t,ithenominaladjustmentamountofriskyassetiatperiodt;Δx¯(t)thenominaladjustmentvectoroftheportfolioatperiodt,whereΔx¯(t)=(Δx¯t,1,Δx¯t,2,…,Δx¯t,n)′;x˜t,i+theinvestmentamountafteradjustmentonriskyassetiatperiodt;x˜+(t)theinvestmentvectoroftheportfolioafteradjustmentatperiodt,wherex˜+(t)=(x˜t,1+,x˜t,2+,…,x˜t,n+)′andx˜t,j+=x˜t,j+Δx˜t,jforallj=1,2,…,n;ct,ithetransactioncostsrateofriskyassetiatperiodt,wherect,iisacrispnumber;Wtthewealthattheendofperiodt,t=1,2,…,T.Notice that, at the beginning of period t, the real returns of portfolios at periods 1, 2, …, t−1 have been observed and they are real numbers, while the future returns of portfolios at periods t, …, T are still uncertain. Denote the deviation between the real return vectorrˆ(k)=(rˆt,1,rˆt,2,…,rˆt,n)′and the predicted return vector r(k)=(rt,1, rt,2, …, rt,n)′ at period k(k=1, 2, …, t−1) as(r(k)−rˆ(k))=(rt,1−rˆt,1,rt,2−rˆt,2,…,rt,n−rˆt,n)′. Since r(k)=(rt,1, rt,2, …, rt,n)′ is a fuzzy vector with n variables,(r(k)−rˆ(k))=(rt,1−rˆt,1,rt,2−rˆt,2,…,rt,n−rˆt,n)′is also a fuzzy vector with n variables. By Definition 1 and Theorem 1, we haveE(r(k)−rˆ(k))=E(r(k))−rˆ(k). To simplify the description, we denote E(r(k))=(E(rk,1), E(rk,2), …, E(rk,n))′ asr¯(k)=(r¯k,1,r¯k,2,…,r¯k,n)′in the following sections. Then, the following results can be obtained. Ifr¯k,j>rˆk,j, it means that the return rate of risky asset j(j=1, 2, …, n) at period k is overestimated. Ifr¯k,j=rˆk,j, it means that the return rate of risky asset j(j=1, 2, …, n) at period k is predicted accurately. Ifr¯k,j<rˆk,j, it means that the return rate of risky asset j(j=1, 2, …, n) at period k is underestimated.Because it may have deviations between the predicted return rates of the assets at each period and their real values, there exist the nominal adjustment vectorΔx¯(t)=(Δx¯t,1,Δx¯t,2,…,Δx¯t,n)′and the real adjustment vectorΔx˜(t)=(Δx˜t,1,Δx˜t,2,…,Δx˜t,n)′to reflect the historical information data on current decision. In this paper, the nominal adjustment vectorΔx¯(t)=(Δx¯t,1,Δx¯t,2,…,Δx¯t,n)′represents the adjustment we would make at period t if the market at period t−1 performs as expected. The real adjustment vectorΔx˜(t)=(Δx˜t,1,Δx˜t,2,…,Δx˜t,n)′represents the adjustment we would make at period t when the market at period t−1 not performs as expected. In the following section, we will construct a closed-loop control policy to demonstrate the relation betweenΔx¯(t)andΔx˜(t).As mentioned in previous section, there often exist deviations between the predicted return rates of the assets at each period and their real values. Due to the uncertainty of future markets, an investor usually has no choice but to design his investment strategies on the basis of these historical data information. In this section, we consider the case that the adjustment action at each period is based on the most recent one period historical data information. Similar to Calafiore [3], we construct a closed-loop control policy with a single-stage memory depth to describe the influence of the historical predicted deviation on current decision. Then, the explicit control policy at period t can be expressed as(14)Δx˜(t)=Δx¯(t)+Θ(t−1)(r(t−1)−rˆ(t−1)),t=1,2,…,T,whereΘ(t−1)∈ℝn,n,t=1,2,…,Tare additional decision variables and represent the market reaction matrices, in whichΘ(t−1)=(Θij(t−1))n×nis the market reaction matrix at period t−1(t=1, 2, …, T), and its element Θij(t−1) in row i and column j represents the sensitivity ofΔx˜t,iwith respect to the return rate deviation(rt−1,j−rˆt−1,j).Remark 1The control policy in Eq. (14) can be interpreted as follows. The initial adjustment amount of the portfolioΔx˜(1)is the “here-and-now” action, describing the first “move” to be done by the investor. The subsequent adjustmentsΔx˜(2),Δx˜(3),…,Δx˜(T)are “wait-and-see” variables and represent that the investor can wait and see what progressively happens to the market before actually making adjustment decisions in the following T−1 periods. Their values are assumed to be decomposed into the sum of a nominal decisionΔx¯(t)and a recourse term for t=2, 3, …, T. If the market at period t−1 performs as expected, the nominal adjustment action at period t,Δx¯(t), will be performed. In this case, the returns of portfolios in different investment periods are independent, which is compatible with the classical “efficient market hypothesis” (see for example Fama [15]). Since the market at period t−1 often not performs as expected, the investor usually needs to perform the adjustment decisionΔx˜(t)by correcting the nominal actionΔx¯(t)with a term proportional to the past market deviation from expectation(r(t−1)−rˆ(t−1)). The coefficients of the correction are collected in the market reaction matrix Θ(t−1). In particular, element Θij(t−1) in row i and column j of matrix Θ(t−1) represents the sensitivity of the control action in the ith risky assetΔx˜t,iwith respect to the deviation from expectation of the return rate of the jth risky asset at period t−1.By Eq. (14) above, the investment amount after adjustment on the portfolio at period t can be represented asx˜+(t)=x˜(t)+Δx˜(t)=x˜(t)+Δx¯(t)+Θ(t−1)(r(t−1)−rˆ(t−1)).The above recursions are initialized withΔx˜(1)=Δx¯(1), Θ(0)=0 andr(0)=rˆ(0)=0.x˜(t)is the (pre-transaction) investment amount of the portfolio at the beginning of period t. As assumed in previous section, the return rate of the portfolio at each period is fuzzy number. Thus,x˜(t)is also a fuzzy number for all t=1, 2, …, T. To measure a fuzzy number, defuzzification approach is a common used technique. In this paper, we use the credibilistic expected value of a fuzzy number to measure its crisp value. By Theorem 1, the crisp value of the (post-transaction) investment amount of the portfolio at period t can be represented by(15)x+(t)=E(x˜(t)+Δx˜(t))=x(t)+Δx¯(t)+Θ(t−1)E(r(t−1)−rˆ(t−1))=x(t)+Δx¯(t)+Θ(t−1)(r¯(t−1)−rˆ(t−1)).Then, the real (pre-transaction) investment amount of risky asset i at the beginning of period t can be computed by(16)x˜(t)=G(t−1)x+(t−1),whereG(t−1)=(gij(t−1))n×nis a fuzzy diagonal gain matrix with the element in row i and column i of gii(t−1)=1+rt−1,ifor i=1, 2, …, n.Using Definition 1, the crisp value ofx˜(t)can be represented byx(t)=G¯(t−1)x+(t−1),whereG¯(t−1)=(g¯ij(t−1))n×nis a diagonal matrix withg¯ii(t−1)=1+r¯t−1,ifor i=1, 2, …, n.From Eq. (15), the crisp value of the investment amount after adjustment on risky asset i at period t can be denoted as(17)xt,i+=xt,i+Δx¯t,i+∑j=1nΘij(t−1)E(rt−1,j−rˆt−1,j)=x1,i+∑k=1tΔx¯k,i+∑j=1nΘij(k−1)(r¯k−1,j−rˆk−1,j).As mentioned in most of existing literatures, transaction costs is one of the important factors for making a portfolio decision. In general, the transaction costs of a portfolio is proportional to its absolute adjustment amount. Thus, the transaction costs at period t can be calculated byCt=∑i=1nct,i|E(Δx˜t,i)|,t=1,2,…,T,whereE(Δx˜t,i)>0means that the investor will buy inE(Δx˜t,i)on risky asset i at period t. On the contrary,E(Δx˜t,i)<0means that the investor will sell out|E(Δx˜t,i)|on risky asset i at period t.Assume that the process of the adjustment on the portfolio at each period has no capital injected or withdrawn, expect for possible loss due to paying transaction costs. Then, we have(18)∑i=1nE(Δx˜t,i)+∑i=1nct,i|E(Δx˜t,i)|=0,t=1,2,…,T.Substituting Eq. (14) into Eq. (18), we have(19)∑i=1nΔx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j)+∑i=1nct,i|Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j)|=0.Using Eq. (15), the return of the portfolio at period t can be represented asRP,t=rt′x+(t)=∑i=1nrt,ixt,i+Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j).By Eqs. (18) and (19), the net profit of the portfolio at period t can be denoted as(20)RN,t=rt′x+(t)−Ct=∑i=1nrt,ixt,i+2Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j).The wealth at the end of period t can be expressed by(21)Wt=(1′+rt′)x+(t)−Ct=∑i=1n(1+rt,i)xt,i+∑i=1nΔx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j).Here, 1=(1, 1, …, 1)′ is a vector of ones with n-dimension.Notice that the wealth obtained at the end of period t can also be rewritten as(22)Wt=W0+∑k=1tRN,k,t=1,2,…,T.Solving Eq. (22) recursively, the terminal wealth can be expressed asWT=W0+∑t=1TRN,t. By Theorems 1 and 2, we have(23)E(WT)=W0+∑t=1T(E(RP,t)−Ct),t=1,2,…,T.Thus, the centered value of Wtcan be expressed by(24)Wt−E(Wt)=∑t=1TRP,t−E∑t=1TRP,t,t=1,2,…,T.Since rt,i=(at,i, αt,i, βt,i) is triangular fuzzy number for i=1, 2, …, n and t=1, 2, …, T, the net profit of the portfolio at period t is also characterized by triangular fuzzy variable with the following form(25)RP,t=∑i=1nxt,i+rt,i=∑i=1nxt,i+at,i,∑i=1nxt,i+αt,i,∑i=1nxt,i+βt,i.Using Eqs. (4) and (23), the expected value of the terminal wealth can be computed by(26)E(WT)=W0+∑t=1T∑i=1nat,i+βt,i−αt,i4xt,i+−∑i=1nct,i|E(Δx˜t,i)|.It is well-known that investment risk is one of important factors concerned by investors. Variance is used as risk measure in many literatures such as Calafiore [3], Çelikyurt and Özekici [5], Li and Zhou [32], Wei and Ye [52], etc. However, the main drawback of using variance as risk measure is that it cannot make distinction between gains and losses. To measure the real downside risk of a portfolio, some researchers used semi-variance or lower partial moment to replace variance as risk measure (e.g., Huang [24] and Konno et al. [27]). In contrast with semi-variance risk measure, Speranza [44] measured investment risk by semi-absolute deviation, which reduced the complexity of computation. In fact, as mentioned by Vercher et al. [51], semi-absolute deviation or downside risk measure is a more realistic description for investment risk with the reason that these kinds of risk measures only penalize the downside deviation from its expected value. Taking these facts into consideration, we use the lower absolute deviation of the return rate as risk measure in this paper. From Eqs. (10), (24) and (25), the lower absolute deviation about the return rate of the portfolio at period t can be expressed by(27)LAD(RP,t)=E[|(RP,t−E(RP,t))−|]=[∑i=1nxt,i+(3βt,i+αt,i)]264∑i=1nxt,i+βt,i.It follows that a weighted sum of the lower absolute deviations of portfolios over the whole T investment periods can be represented by(28)V(x)=∑t=1TγtLAD(RP,t)=∑t=1Tγt[∑i=1nxt,i+(3βt,i+αt,i)]264∑i=1nxt,i+βt,i,where γt∈[0, 1] is the weight of the lower absolute deviation about the return rate of the portfolio at period t and it satisfies∑t=1Tγt=1. In particular, γT=1 means that the investor only takes the final-stage risk into account.Due to the complexity of the real financial markets, the return rates of risky assets are affected by many non-probabilistic factors so that the return rates on risky assets are characterized by fuzzy variables in many cases. It can be seen that the uncertainty of the return rate on a risky asset is also an important factor for portfolio selection in a fuzzy economic environment. In 2008, Li and Liu [30] defined a fuzzy entropy based on the notion of credibility distribution to quantify the uncertainty of a fuzzy variable. In this paper, we employ it to measure the uncertainty of multi-period fuzzy portfolio selection.By Eqs. (13) and (25), the uncertainty of the return of the portfolio at period t can be computed by(29)H(RP,t)=12∑i=1nxt,i+(αt,i+βt,i),t=1,2,…,T.Then, the weighted sum of the uncertainty of the returns of portfolios over in the T investment periods can be expressed as(30)H(x)=∑t=1TνtH(RP,t)=12∑t=1Tνt∑i=1nxt,i+(βt,i+αt,i).wherewt∈[0,1]satisfies∑t=1Tνt=1. In this paper, we setν1=ν2=⋯=νT=1T. Namely, we assume that the investor shows indifferent attitude to the uncertainty of the return rate on the portfolio at each period.It is well known that investors may experience loss as well as gain during the process of investment. A bankruptcy may occur when the total wealth of an investor falls below a predetermined “disaster level” in any intermediate or the final period. If an investor is in bankruptcy, then he will be not able to pursue further investment due to his high liability and low credit. Thus, it is necessary to consider bankruptcy control for multi-period portfolio selection.In the following discussion, let us pay close attention to how to control the bankruptcy for multi-period fuzzy portfolio selection. Since the portfolio return at each period is fuzzy variable, we use the theory of credibility measure to quantify the fuzzy bankruptcy event in this paper. Different from the probabilistic bankruptcy control models using absolute deviation or variance as risk control measure, we measure the bankruptcy risk for fuzzy portfolio selection by using the aforementioned lower absolute deviation. Let btand BRtbe the disaster level and the bankruptcy event at period t, respectively. Inspired by probability theory, the credibility of the bankruptcy event BRtcan be expressed byCr(BRt)=Cr{Wt≤bt,Wj>bj,j=1,2,…,t−1},t=1,2,…,T.Without loss of generality, we set bt<E(Wt) in this paper.Proposition 1If bt<E(Wt) andE(|(Wt−E(Wt))−|)E(Wt)−bt≤θt, then Cr(BRt)≤θt.ProofThis result is a special case of Theorem 4.We let |ξ|=|(Wt−E(Wt))−|, ɛ=E(Wt)−btand p=1 in Theorem 4. Since bt<E(Wt) andE[|(Wt−E(Wt))−|]E(Wt)−bt≤θt, the following inequality holdsCr{|(Wt−E(Wt))−|≥E(Wt)−bt}≤E(|(Wt−E(Wt))−|)E(Wt)−bt≤θt.Therefore,Cr(BRt)=Cr{Wt≤bt,Wj>bj,j=1,2,…,t−1}≤Cr{Wt≤bt}≤Cr{|(Wt−E(Wt))−|≥E(Wt)−bt}≤E[|(Wt−E(Wt))−|]E(Wt)−bt≤θt.This completes the proof.By Theorem 3, the following relationship holdsE[|(Wt−E(Wt))−|]=E|∑j=1tRN,j−E∑j=1tRN,j−|≤∑j=1tE(|(RN,j−E(RN,j))−|).Then, we haveE[|(Wt−E(Wt))−|]E(Wt)−bt≤∑j=1tE[|(RN,j−E(RN,j))−|]E(Wt)−bt≡φt.Thus, if we let φt≤θt, then we can control the bankruptcy at period t.In this paper, we set the bankruptcy level at period t as bt=0. It means that a bankruptcy occurs when the investor has no positive wealth. It follows thatCr{Wt≤bt,Wj>0,j=1,2,…,t−1}≤∑j=1tE[|(RN,j−E(RN,j))−|]E(Wt)≤θt.Thus, we have∑j=1tE[|(RN,j−E(RN,j))−|]≤E(Wt)θt,t=1,2,…,T.From Eqs. (26) and (28), we have(31)∑j=1t[∑i=1nxj,i+(3βj,i+αj,i)]264∑i=1nxj,i+βj,i≤W0+∑j=1t∑i=1n4aj,i+βj,i−αj,i4xj,i+−cj,i|E(Δx˜j,i)|θt.To obtain a diversified portfolio, investors usually impose the minimum and maximum investment amounts on an individual asset at each period. In this paper, we assume that the investor requires the adjusted investment amount on risky asset i(i=1, 2, …, n) at period t(t=1, 2, …, T) must be no more than 100λt(λt∈[0, 1]) percent of the total (pre-transaction) wealth at the beginning of the investment period t. Assume that short selling is not allowed during the whole investment horizon. Then, the bound constraints about risky asset i(i=1, 2, …, n) at period t(t=1, 2, …, T) can be expressed as(32)0≤x˜t,i+≤λt∑i=1nx˜t,i,t=1,2,…,T;i=1,2,…,n.Here,x˜t,iis determined by rt−1,iandxt−1,i+. Since rt−1,1, rt−1,2, …, rt−1,nare fuzzy numbers, it can be seen thatx˜t,1,x˜t,2,…,x˜t,nare also fuzzy numbers for all t=1, 2, …, T. Using Definition 1, the crisp form of bound constraint can be expressed as0≤E(x˜t,i+)≤λt∑i=1nE(x˜t,i),t=1,2,…,T;i=1,2,…,n,whereE(x˜t,i+)=xt,i+Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j),∑j=1nΘij(t−1)=0andE(x˜t,i)=(1+r¯t−1,i)xt−1,i+.Remark 2Constraints with fuzzy variablesNotice that the post-transaction investment amountsx˜t,i+(i=1,2,…,n)are fuzzy variables restricted in[0,λt∑i=1nx˜t,i]. To handle these constraints for fuzzy portfolio selection, defuzzification approach is a common used technique to transform fuzzy numbers into crisp values. In this paper, we transform the fuzzy bound constraints into the corresponding crisp forms by the expected value approach. In Eq. (32), the credibilistic expected value of its upper boundλt∑i=1nE(x˜t,i)is “deterministic” because rt−1,iandxt−1,i+have been observed at the beginning of period t. Thus, it can be seen that the search space is finite dimension. Based on the discussion above, we can find that using the defuzzification approach in our paper can guarantee the feasibility of the actual decisions in reality and reduce the computational burden.Assume that the investor wants to seek an optimal investment strategy with the objective to maximize the terminal wealth and minimize the weighted sum of the investment risk and the uncertainty of the returns of portfolios over the whole T investment periods. Meanwhile, he requires that the bankruptcy risk at each period can not exceed the preset level and the investment amount on any asset at each period must satisfy the given bound constraint. Then, we formulate the following multi-period portfolio selection model (P1):(P1)maxE(WT)=W0+E∑t=1TRN,tminV(x)=∑t=1TγtLAD(RP,t)minH(x)=∑t=1TνtH(RP,t)s.t.E(|(Wt−E(Wt))−|)≤E(Wt)θt,∑i=1nE(Δx˜t,i)+∑i=1nct,i|E(Δx˜t,i)|=0,E(Δx˜t,i)=Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j),1′Θ(t−1)=0,Θ(0)=0,xt,i+=xt,i+Δx¯t,i+∑j=1nΘij(t−1)(r¯t−1,j−rˆt−1,j),E(x˜t,i)=(1+r¯t−1,i)xt−1,i+,0≤E(x˜t,i+)≤λt∑i=1nE(x˜t,i),t=1,2,…,T;i=1,2,…,n.Here, λt∈[0, 1] is the upper bound constraint coefficient at period t. In this paper, we set γT=1 andνt=1T(t=1,2,…,T). In other words, we assume that the investor takes the final-stage risk and the average uncertainty of the returns of portfolios over the whole investment horizon into consideration.By Eqs. (17), (19), (26), (28), (30) and (31), the problem (P1) can be rewritten into the following form(P2)maxE(WT)=W0+∑t=1T∑i=1nat,i+βt,i−αt,i4xt,i+−∑i=1nct,i|E(Δx˜t,i)|minV(x)=[∑i=1nxT,i+(3βT,i+αT,i)]264∑i=1nxT,i+βT,iminH(x)=12T∑t=1T∑i=1nxt,i+(βt,i+αt,i)s.t.164∑j=1t[∑i=1nxj,i+(3βj,i+αj,i)]2∑i=1nxj,i+βj,i≤W0+∑j=1t∑i=1n4aj,i+βj,i−αj,i4xj,i+−cj,i|E(Δx˜j,i)|θt,∑i=1nE(Δx˜t,i)+∑i=1nct,i|E(Δx˜t,i)|=0,E(Δx˜t,i)=Δx¯t,i+∑j=1nΘij(t−1)4at−1,j+βt−1,j−αt−1,j4−rˆt−1,j,1′Θ(t−1)=0,Θ(0)=0xt,i+=x1,i+∑k=1tΔx¯k,i+∑j=1nΘij(k−1)4ak−1,j+βk−1,j−αk−1,j4−rˆk−1,j,E(x˜t,i)=1+4at−1,i+βt−1,i−αt−1,i4xt−1,i+,0≤E(x˜t,i+)≤λt∑i=1nE(x˜t,i),t=1,2,…,T;i=1,2,…,n.Note that the model (P2) in previous section is a multi-objective optimization problem. The idea of a solution for the model (P2) can be unclear, because its objectives are conflicting to each other. So, it is impossible to obtain their individual optima at the same time. For solving this kind of problem, some researchers used the idea of Pareto optimality to describe solutions for multi-objective optimization problems, see for example Coello [8] and Coello and Lechuga [9]. However, there are multiple non-dominated solutions for a multi-objective problem. As we know, the investment preference pay an important role in making portfolio decision. Thus, it is often necessary to incorporate decision-maker's preferences for various objectives to determine a single suitable solution. As mentioned by Marler and Arora [38], with a posteriori articulation of preferences, one manually selects a single solution from a representation of the Pareto optimal set. In this paper, we use the fuzzy programming approach in Zimmermann [61] to transform the problem (P2) into a single-objective optimization problem. Then, we design a hybrid particle swarm optimization algorithm for solution. Here, we first introduce the fuzzy programming approach for transforming the proposed model into a single-objective model.Since the financial market is extremely complex, an investment is generally affected by the disturbances of social and economic circumstances. To express investor's intention, a satisfaction approach is much better than an optimization one. In a fuzzy investment environment, an investor always has aspiration levels for his decision objectives. In the real financial management, the expert's knowledge and experience are very important in portfolio selection. Based on an expert's knowledge, the investor may decide the aspiration levels for the decision objectives. In this paper, we utilize the fuzzy programming approach presented by Zimmermann [61] to express investor's aspiration levels for terminal wealth, terminal risk and the average uncertainty of the returns of portfolios in the T investment periods. Here, we summarized the steps of fuzzy programming approach for solving the proposed model as follows.Step 1. Solve the model (P2) as a single objective problem using only one objective at a time and ignoring the others. Then, the ideal and anti-ideal solutions of each objective can be obtained.Step 2. Construct the membership functions about the three objective in (P2) to express investor's aspiration level for each objective as follows(33)μWT(x)=0,ifE(WT)≤E0,E(WT)−E0E1−E0,ifE0≤E(WT)≤E1,1,ifE(WT)≥E1,(34)μV(x)=1,ifV(X)≤V0,V1−V(X)V1−V0,ifV0≤V(X)≤V1,0,ifV(X)≥V1,(35)μH(x)=1,ifH(X)≤H0,H1−H(X)H1−H0,ifH0≤H(X)≤H1,0,ifH(X)≥H1,where E0, E1; V0, V1; H0, H1 represent the minimum and the maximum expected values of terminal wealth, terminal risk and the average uncertainty of the returns of portfolios over T investment periods, respectively.Step 3. Use the weighted sum method to express investor's preference for each objective. Then, the following form of single objective programming problem can be obtained(P3)maxf(x)=η1μWT(x)+η2μV(x)+η3μH(x)s.t.gp(x)≤0,p=1,2,…,l,hq(x)=0,q=1,2,…,m,η1+η2+η3=1,η1,η2,η3∈[0,1].Here, η1, η2, η3 denote as investor's preference weights for terminal wealth, terminal risk and the average uncertainty of the returns of portfolios in the T investment periods, respectively. Different values of η1, η2 and η3 reflect investor's different investment preferences. For example, the larger η1 is, the more important the terminal wealth is for making portfolio decision. In particular, η1=1 indicates that the investor only considers terminal wealth as decision objective. η1=η2=η3=1/3 means that the investor shows indifferent preference to each decision objective.Notice that the transformed model (P3) is a complex fractional programming problem. If using traditional optimization algorithms, it may fail for solution. In this case, it is necessary to introduce an intelligent algorithm to solve our model. PSO is a population based stochastic optimization technique for solving global optimization problems, which was originally presented by Kennedy and Eberhart [26]. In PSO, each individual is assigned with a randomized velocity according to its own and its companions’ flying experiences, and the individuals, called particles, are then flown through hyperspace. As an evolutionary algorithm, PSO has been successfully applied to many fields for its simplicity and effectiveness. However, PSO may suffer from premature convergence as pointed out by Van den Bergh and Engelbrecht [50]. GA is a global optimization algorithm by simulating heredity and process of evolution in environment, which uses three operations (i.e., selection, crossover and mutation) to search the fittest individual. As pointed out by Kuo and Han [28], due to the characteristics of GA and PSO, it is feasible to use the crossover and mutation of algorithm process into PSO. It can effectively integrate the characteristic of global search in GA and the capability of local search in PSO to avoid premature convergence and enhance the search capability. In order to overcome such a drawback, several researchers have proposed some hybrid PSO algorithms, see for example Angeline [2], Deng et al. [13], Tripathi et al. [48] and Yan et al. [53].In this section, we design a novel hybrid PSO algorithm to solve problem (P3). The basic idea of the designed algorithm can be summarized as follows. We integrate the crossover and mutation operators of genetic algorithm (GA) into the original PSO for updating the position and the velocity of a particle. Besides, we add a dynamic inertia weight and acceleration coefficients to control the velocity update process of the particle. Before introducing the novel algorithm, let us first review the basic PSO algorithm.Basic PSO: In original PSO, a population is represented by a swarm, and an individual is represented by a particle. A swarm in PSO consists of a number of particles. Each particle in the swarm is controlled by two vectors, i.e., the velocity vectorVi=(vi,1,vi,2,…,vi,D)′and the position vector Xi=(xi,1, xi,2, …, xi,D)′, where D represents the dimension of the solution space. Each particle represents a potential solution of the optimization problem. Each particle's own best historical position (pbest) is denoted by Pi=(pi,1, pi,2, …, pi,D)′, and the best historical position that the entire swarm has passed (gbest) is denoted by Pg=(pg,1, pg,2, …, pg,D)′. At each iteration, the particles are manipulated by the following two equations:ViG+1=ViG+c1rand1(PiG−XiG)+c2rand2(PgG−XiG),XiG+1=XiG+ViG+1,i=1,2,…,pop−size,where G is the number of generation and pop−size is the population size; c1 and c2 are constants named acceleration coefficients; rand1 and rand2 are two independent random numbers uniformly distributed in the range of [0,1].In the following, we introduce the time variant inertia weight and acceleration coefficients, fitness function, crossover operation, mutation operation, constraint handling and stopping criterion of our algorithm.Time variant inertia weight: To balance the global search and local search, Shi and Eberhart [43] introduced a linearly decreasing inertia weight ω into the original PSO as follows(36)VjG+1=ωVjG+c1rand1(PjG−XjG)+c2rand2(PgG−XjG).After the pioneer work of Shi and Eberhart [43], numerous researchers have proposed some time variant inertia weights to improve the performance of PSO, see for example Chatterjee and Siarry [6], Deng et al. [13], Hajnoori et al. [19] and Yang et al. [54]. In this paper, the non-linear dynamic inertia weight is used as follows(37)ω=ωmax−(ωmax−ωmin)GGmax4,where ωminand ωmaxare the minimum and the maximum inertia weights, respectively; Gmaxis the number of the maximum generation. Similar to Deng et al. [13], Sun et al. [45] and Zhu et al. [60], ωminand ωmaxare set to 0.4 and 0.9, respectively.Time variant acceleration coefficients: To incorporate better compromise between the exploration and exploitation of the search space in PSO, the acceleration coefficients c1 and c2 in Ratnaweera et al. [41] are applied as follows:c1=c1,max−c1,max−c1,minGmax×G,c2=c2,min+c2,max−c2,minGmax×G,where, c1,max, c1,min, c2,maxand c2,minare constants. According to Ratnaweera et al. [40], we set c1,max=2.5, c1,min=0.5, c2,max=2.5 and c2,min=0.5 in this paper.Fitness function: Fitness function is a key index of the designed hybrid algorithm. During the process of iteration, each particle in the swarm is assigned with a fitness value indicating the merit of this particle such that the swarm evolution is navigated by best particles. As pointed out by Jiang et al. [25], the fitness of each particle can be evaluated by the objective function of optimization problem. For more details, one can refer to Deng et al. [13], Sun et al. [45], Zhu et al. [60], etc. In this study, the fitness function is defined by:f(x)=η1μWT(x)+η2μV(x)+η3μH(x).Crossover operation: To increase the search ability of the swarm, the arithmetic crossover operator in GA is integrated into PSO. Define Pcas the probability of crossover. The crossover operation on the current swarm is performed as follows: generate a random number c from interval (0, 1) and the position of particle i, Xi, is selected for crossover operation provided that c<Pc. Repeating this process pop−size times, Pc·pop−size positions are expected to be selected to undergo the crossover operation. The crossover operation on X1 and X2 will generate two offspringsX1′andX2′as follows:(38)X1′=τX1+(1−τ)X2,(39)X2′=(1−τ)X1+τX2,where τ∈[0, 1] is a random number. Similar crossover operation is performed to update the velocities of current swarm. The motivation of this operation is that offspring particles benefit from both parents. Theoretically, crossover operation provides offspring particles opportunity of escaping from local optimum.Mutation operation: To increase the diversity of the population, we use the position displacement of particles to perform mutation operation. The mutation operation at generation G+1 is defined by(40)XiG+1=XiG+νViG+1,where ν is a constriction factor used to control and constrict velocities of particles. In this algorithm, ν is set to 0.4. Here, different from the mutation operation in Yan et al. [53], we assume that the velocity vector of offspring is the same as the one of its parent during the process of iterations.Elitist selection operation: Similar to Goldberg [18], to keep the best solutions in the following generations, we perform elitist selection operation in this algorithm, which preserves the best particle of the previous generation as the last entry of the new population of the current generation. If the best particle of the current generation is worse than the best particle of the previous generation, the latter one would replace the worst particle of the current population.Taguchi method: In this algorithm, to achieve a robust design, Taguchi method in Taguchi et al. [46] is inserted between the crossover and mutation operations of GA. The Taguchi method contains two major tools, i.e., the orthogonal array and the SNR. The first tool, the orthogonal array, is used to represent a set of runs or experiments needed to find a suitable level of each factor to achieve an optimal solution. Here, the general symbol for two-level standard orthogonal arrays is used as followsLm(2m−1),where m=2kis the number of experimental runs; k is a positive integer which is greater than 1; 2 is the number of levels for each factor; m−1 is the number of columns in the orthogonal array. L is the idea of using orthogonal arrays for experiment design having been associated with “Latin square” for the outset. In practice, L4(23), L8(27), L16(215) and L32(231) are the most common used two-level standard orthogonal arrays. In this paper, the value of m is 32. The second tool, SNR, is used to find which level is suitable for each factor. Similar to Tsai et al. [49], for the problem with maximum objective function, the value of SNR is computed bySNRi=(f(xi))2.Here, f(xi) denotes the function evaluation value of experiment i for all i=1, 2, …, n. The effects of the various factors (variables) can be defined asEfl=sumofSNRiforfactorfatlevell,where f is the factor name; l is the level number. In this paper, we set m=32, l=2 and n=28.Constraint handling: Notice that problem (P3) is a nonlinear programming problem with equality and inequality constraints. In this algorithm, a feasibility-based rule is employed to handle its constraints. Since the particles in swarm may escape the search region during the process of iteration, it is necessary to handle the satisfaction of constraints of problem (P3). To check whether each particle satisfies all constraints, we calculate the constraint violation value of an infeasible solution as follows:viol(X)=∑p=1lmax{gp(X),0}+∑q=1mmax{|hq(X)|,0}.Similar to He and Wang [21], in this algorithm,PiGwill be replaced byXiG+1based on any of the following criterions:(1) IfPiGis infeasible andXiG+1is feasible;(2) If bothPiGandXiG+1are feasible, butf(XiG+1)>f(PiG);(3) If bothPiGandXiG+1are infeasible, butviol(XiG+1)<viol(PiG).Similarly, gbest is updated based on the criterions above at each generation.Stopping criterion: The stopping criterion for the iteration is determined by whether the maximum generation Gmaxor no improvement occurs over repeated iterations.The basic procedure of the hybrid PSO can be summarized as follows:Step 1. Set parameters: swarm size pop−size, maximum inertia weight ωmaxand minimum inertia weight ωmin, crossover probability Pc, mutation probability Pm, maximum and minimum cognitive parameters (c1,maxand c1,min), maximum and minimum social parameters (c2,maxand c2,min) and maximum generation Gmax;Step 2. Initialize a swarm of particles in the feasible region with random positions and velocities;Step 3. Calculate the fitness values of all particles, and set pbest of each particle as its current position, and set gbest as the best historical position that the entire swarm has passed;Step 4. Perform the elitist selection operation and keep the better pop−size;Step 5. Perform the crossover operation by crossover probability Pc;Step 6. Select a suitable two-level orthogonal array for matrix experiments. Namely, determine the value of m for the orthogonal array Lm(2m−1);Step 7. Choose randomly two chromosomes at a time to execute matrix experiments;Step 8. Calculate the function values and SNRs of m experiments in the orthogonal array;Step 9. Calculate the effects of the various factors;Step 10. One optimal chromosome is generated based on the results from Step 6;Step 11. Repeat Steps 7 through 10 until the expected number12×pop−size×Pchas been met;Step 12. Perform mutation operation by mutation probability Pm;Step 13. Calculate the fitness values of all particles;Step 14. Compare each particle's current objective value with its pbest. If the former is better, then update pbest and its fitness value with the current position and objective value;Step 15. Determine the best particle of the current swarm with the best fitness value. If the fitness value is better than the fitness value of gbest, then update gbest and set gbest equal to the fitness value of the current best particle;Step 16. Update the velocity and position of each particle;Step 17. Check the stopping criterion. If the optimum is found, quit the iterative operation; if not, return to step 3.Time complexity: According to the steps of the designed algorithm, we can write it into a MATLAB program. Denote TC(n) as the time complexity of the designed algorithm. Then, we haveTC(n)=O(nT*pop−size)+O(Gmax*pop−size)=O(nT*pop−size),ifnT≥Gmax,O(Gmax*pop−size),ifnT<Gmax,where nT is the total variables in the proposed model; pop−size is population size; Gmaxis the maximum iteration number.In this section, we consider an empirical study in Shanghai Stock Exchange to illustrate the idea of the proposed model. A comparative study with the hybrid GA with PSO (HGAPSO) algorithm in Yan et al [53] and the hybrid GA with SA (HGASA) algorithm in Oysu and Bingul [40] are also given to illustrate the effectiveness of the designed algorithm for solving the proposed model.Assume that an investor has an existing portfolio on 4 stocks with exchange codes 600005, 600068, 000858 and 600009. The wealth on the existing portfolio is W0=10000, which is averagely allocated on the 4 stocks. To simplify the description, we denote the 4 stocks by Stocks 1, 2, 3 and 4, respectively. We collect the historical data about their weekly closing prices from January 2008 to January 2011 to predict their future return rates. We set every one year as an observation period to handle these historical data. By using the simple estimation approach in Zhang et al. [58], the possibility distributions of the return rates on the 4 stocks at each period are listed in the following Table 1.In this example, the real return vectors of portfolios at periods 1 and 2 are assumed asrˆ(1)=(0.2200,0.2100,0.1968,−0.0831)andrˆ(2)=(0.1800,0.2400,−0.0839,0.1886), respectively. The bankruptcy levels in the three investment periods are set as θ1=0.10, θ2=0.15 and θ3=0.20, respectively. The values of λ1, λ2 and λ3 are set as 0.5. The value of ci,tis set as 0.003 for all i=1, 2, 3, 4 and t=1, 2, 3. The parameters in the designed algorithm are given as follows. The population size is pop−size=200. The probability of crossover Pcand the probability of mutation are 0.8 and 0.1, respectively. The maximum generation is Gmax=2000. To identify the influence of the preference weight on portfolio decision-making, we consider the following three different preference cases. Case 1: We consider the decision case that the investor pays more attention terminal wealth and shows identical attitudes to the other two objectives. In this case, we assume that the preference weights of the three decision objective are set as 0.15, 0.7 and 0.15, respectively. Namely, η1=0.15, η2=0.7 and η3=0.15. Case 2: We consider the decision case that the investor shows the same attitudes to the three objectives, that is,ηi=13(i=1,2,3). Case 3: We assume that the investor's preference weights for the three decision objective are set to 0.65, 0.25 and 0.1, respectively. Namely, η1=0.65, η2=0.25 and η3=0.1. For the three different decision cases above, we use the designed algorithm to solve them. After running the designed algorithm with 2000 generations, the corresponding investment strategies can be obtained as shown in Table 2.If the investor's preference weight for each objective is set as Case 1, solving our model by the designed algorithm, the optimal policy parameters can be obtained as follows. The nominal adjustment vectors of portfolios at periods 1, 2 and 3 areΔx¯1=(1097.42,712.46,−203.52,−1617.25),Δx¯2=(1964.65,−2016.74,−246.03,271.42)andΔx¯3=(935.58,−1024.19,1217.80,−1154.30), respectively. The market reaction matrices at periods 1 and 2 areΘ(1)=16992.858418.5800−1399.93−16429.4500−201718.17−57706.4100186125.2465717.2800andΘ(2)=33117.998848.2700−3247.97−1119.9100327809.7795890.3900−357679.78−103618.7500, respectively. From Table 2, we can find out that the post-transaction investment amounts on the 4 stocks at period 1 are 3597.42, 3212.46, 2296.48 and 882.75 RMB, respectively. At period 2, the post-transaction investment amounts on the 4 stocks are 5765.32, 1043.65, 0.94 and 3152.50 RMB, respectively. At period 3, the post-transaction investment amounts on the 4 stocks are 6880.52, 0.02, 3056.49 and 0.27, respectively. Then, at the end of period 3, the investor will obtain 16221.85 RMB. In this decision, the net profit is 6159.15 RMB and the total transaction costs is 62.70 RMB.If the investor's preference weight for each objective is set as Case 2, solving our model by the designed algorithm, the optimal policy parameters can be obtained as follows. The nominal adjustment vectors of portfolios at periods 1, 2 and 3 areΔx¯1=(2203.96,1181.39,−923.35,−2482.37),Δx¯2=(−3368.76,91.66,−1242.52,1475.00)andΔx¯3=(2877.89,−2866.76,1080.95,−1126.86), respectively. The corresponding market reaction matrices at periods 1 and 2 areΘ(1)=−2679.03−22419.80008204.31−3104.6900−16355.93−24206.480010830.6649730.9800andΘ(2)=9298.277071.9300−112415.65−76246.150013653.56234444.060089463.82−165269.8400, respectively. The post-transaction investment amounts of the 4 assets over the three investment periods are listed in lines 5, 6 and 7 of Table 2. During the process of investment, the total transaction costs is 63.65 RMB, the terminal wealth is 16497.27 RMB and the net profit is 6433.62 RMB.If the investor's preference weight for each objective is set as Case 3, solving our model by the designed algorithm, the optimal policy parameters can be obtained as follows. The nominal adjustment vectors of portfolios at periods 1, 2 and 3 areΔx¯1=(2008.14,675.00,−208.25,−2491.04),Δx¯2=(1365.30,−1722.69,−1651.20,1984.42)andΔx¯3=(848.69,−1362.09,−126.30,616.13), respectively. The market reaction matrices at periods 1 and 2 areΘ(1)=31225.56−11185.9900−2895.69−515.3400−68327.19−13299.100039997.3125000.4300andΘ(2)=22193.1512057.7600−13426.31−2290.550068546.38387706.8400−77313.21−397474.0600, respectively. In this case, the investor should follow the investment strategies listed in lines 8-10 of Table 2 to allocate his wealth. The terminal wealth, net profit and total transaction costs are 16517.61, 6453.71 and 63.90 RMB, respectively. Based on the discussion above, the following results can be obtained. Our proposed model can express investor's preference freely. Different investment preference weights lead to different investment strategies. The investor can obtain his own investment strategies through setting appropriate objective weights. If he is not satisfied with any of these investment strategies, he could reallocate preference weights to the three objectives by solving (P3).To demonstrate the effectiveness of our designed algorithm, we also use the HGAPSO algorithm in Yan et al. [53] and the HGASA algorithm in Oysu and Bingul [40] to solve our model under the aforementioned three different decision cases. For each algorithm, we run it three algorithms thirty consecutive times. Then, the corresponding average best objective values (ABOV), average running times (ART) and average absolute deviations (AAD) of the three solution algorithms can be obtained as shown in Table 3, where the average absolute deviation of each algorithm under each preference case is calculated by the arithmetic mean value of the absolute deviations between the ABOV and the found 30 best objective values. From Table 3, we can find out that the average best objective value (ABOV) obtained by our designed algorithm under each decision case is larger than the ones obtained by the other two algorithms. For the results about AAD in Table 3, we can find out that our algorithm is more stable than the other two algorithms. Though, in the sense of the average running time, our algorithm is inferior to the HGAPSO algorithm. By comparison, our designed algorithm has greater advantages than the HGAPSO algorithm on calculation accuracy and convergence. Based on the analysis above, we can conclude that the designed algorithm is more effective than the other two solution algorithms for solving the proposed model.

@&#CONCLUSIONS@&#
Based on credibility theory, this paper has investigated a multi-period portfolio selection problem with bankruptcy control and affine recourse in fuzzy investment environment. By taking the return rates of risky assets as fuzzy variables, we use the credibilistic expected value, lower absolute deviation and fuzzy entropy to quantify investment return, investment risk and investment uncertainty. We propose a credibilistic multi-period portfolio optimization model with bankruptcy control and affine recourse. In the proposed model, we assume that the investor has three decision objectives, viz., maximizing the terminal wealth and minimizing terminal risk and the average uncertainty of the returns of portfolios over the whole investment horizon. To take investor's preference for each objective into consideration, we use a fuzzy programming approach to transform the proposed model into a single-objective one. Then, a hybrid PSO algorithm is designed to find the optimal solutions under different preference cases. In addition, solution comparisons and the performance analysis are given to demonstrate the effectiveness of our designed algorithm. The experimental results show that our algorithm is effective for solving the proposed model.As future work, we are planning to add more real constraints in financial market into multi-period portfolio optimization problem. We also intend to compare other heuristic algorithms with the designed algorithm to illustrate its advantage on solving complex multi-period portfolio selection models.