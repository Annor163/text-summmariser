@&#MAIN-TITLE@&#
Direct parametric reconstruction from undersampled (k, t)-space data in dynamic contrast enhanced MRI

@&#HIGHLIGHTS@&#
Direct parametric reconstruction from undersampled (k, t)-space DCE data.Bayesian inference algorithm combined with nuclear norm minimization.Accurate noise model, and priors about the pharmacokinetics and the DCE signal.

@&#KEYPHRASES@&#
Bayesian compressed sensing,Direct reconstruction,Dynamic contrast enhanced,

@&#ABSTRACT@&#
The Magnetic Resonance Imaging (MRI) signal can be made sensitive to functional parameters that provide information about tissues. In dynamic contrast enhanced (DCE) MRI these functional parameters are related to the microvasculature environment and the concentration changes that occur rapidly after the injection of a contrast agent. Typically DCE images are reconstructed individually and kinetic parameters are estimated by fitting a pharmacokinetic model to the time-enhancement response; these methods can be denoted as “indirect”. If undersampling is present to accelerate the acquisition, techniques such as kt-FOCUSS can be employed in the reconstruction step to avoid image degradation. This paper suggests a Bayesian inference framework to estimate functional parameters directly from the measurements at high temporal resolution. The current implementation estimates pharmacokinetic parameters (related to the extended Tofts model) from undersampled (k, t)-space DCE MRI. The proposed scheme is evaluated on a simulated abdominal DCE phantom and prostate DCE data, for fully sampled, 4 and 8-fold undersampled (k, t)-space data. Direct kinetic parameters demonstrate better correspondence (up to 70% higher mutual information) to the ground truth kinetic parameters (of the simulated abdominal DCE phantom) than the ones derived from the indirect methods. For the prostate DCE data, direct kinetic parameters depict the morphology of the tumour better. To examine the impact on cancer diagnosis, a peripheral zone prostate cancer diagnostic model was employed to calculate a probability map for each method.

@&#INTRODUCTION@&#
Dynamic contrast enhanced-magnetic resonance imaging (DCE-MRI) is a common imaging biomarker of vasculature and perfusion. DCE-MRI is mainly used for the diagnosis of cancer in different anatomical regions such as the prostate (Buckley et al., 2004), the head and neck (Agrawal et al., 2012), the breast (Furman-Haran et al., 2013), the cervix (Andersen et al., 2013), the brain (Jain, 2013) and the liver (Armbruster et al., 2014).Briefly, in DCE-MRI a paramagnetic contrast agent (Gadolinium) is administered via intravenous injection, resulting in shortening of the T1 relaxation time from its native value T10.(1)1T1(r,t;w)=1T10(r)+r1·C(r,t⩾t0;w)C(r, t; w)∈CM×Jis the concentration of the contrast agent,ris the spatial coordinate, M is the number of spatial pixels and J is the number of dynamic acquisitions, w(r) are parameters related to the contrast agent kinetics and dictate the enhancement, r1 is the relaxivity and t0 is the arrival time of the bolus at the tissue. The concentration of the contrast agent in the extracellular extravascular space (EES) can be described by the extended Tofts model (Tofts, 1997) using the tracer kinetic parameters w(r)={vp(r), Ktrans(r), ve(r), t0(r)}.(2)C(r,t;w)=vp(r)·Cp(r,t)+Ktrans(r)·∫0tCp(r,τ-t0)⊗e-Ktrans(r)ve(r)(t-τ)dτCp(mmol/L) is the arterial input function (AIF), vpis the blood plasma volume, Ktrans (min−1) is the volume transfer constant between plasma and the EES, and veis the EES volume. If a population average AIF (Parker et al., 2006) is used, the arrival time of the bolus to the tissue is unknown hence the onset time t0 will need to be taken into account.DCE-MRI employs fast T1 weighted sequences for which the received signal can be modelled by(3)S(k,t;w)=∫x(r,t;w)·exp(-j2πk·r)dr=∫S0(r)sin(α)·1-exp-TRT1(r,t;w)1-cos(α)·exp-TRT1(r,t;w)·exp(-j2πk·r)drS(k, t)∈CK×J, is in the spatial frequency domain, K is the number of spatial frequency samples, the modelled enhancement signal is x(r, t; w), S0(r) is the proton density image, TR is the repetition time and α is the flip angle.Some of the important microvascular exchanges occur rapidly hence high temporal resolution is necessary to capture the enhancement process especially immediately after the contrast agent is injected. The temporal resolution of the acquisition can be improved using undersampling techniques in (k, t)-space.Parallel imaging techniques can increase the temporal resolution by reducing the number of phase encoding steps and using knowledge of coil sensitivities in the reconstruction (Pruessmann et al., 1999; Griswold et al., 2002).Compressed sensing (CS) is an emerging theory from signal processing (Donoho, 2006) that can recover images using a non-linear reconstruction from undersampled data by promoting sparsity in an image transform domain. In MRI, the artifacts due to undersampling of the k-space data must be incoherent in the image transform domain. Several CS techniques have been proposed for reconstruction of dynamic MR data, a popular scheme is kt-SPARSE (Lustig et al., 2007), which minimizes an l1-norm objective function(4)minz‖Φz‖1s.t.‖Fuz-y2‖<εwhere ‖⋅‖1 is the l1-norm, Fuis a Fourier sampling operator, y is the acquired signal,Φis an operator that in DCE MRI reconstruction would transform the modelled signal z(r, t) to a sparse representation (i.e. a wavelet transform in the spatial direction and a Fourier transformation in the temporal direction) and ε is a small number usually set at the noise level. Another popular sparse reconstruction algorithm is focal underdetermined system solver (kt-FOCUSS) based on work of Gorodnitsky et al. (1995) and modified by Jung et al. (2007) to become suitable for dynamic MRI applications. A more detailed description of the kt-FOCUSS algorithm follows in the theory section. Dynamic reconstruction can also involve low rank matrix completion techniques which are usually combined with sparsity (Gao et al., 2011; Lingala et al., 2011). A popular rank minimization technique is the kt-SLR algorithm proposed by (Lingala et al., 2011) which minimizes a cost function that involves a rank prior Ψ1(z), and a sparsity prior Ψ2(z).(5)minz‖Fuz-y‖22+λ1Ψ1(z)+λ2Ψ2(z)For more information about temporal acceleration MR reconstruction techniques readers can refer to a review by Tsao and Kozerke (2012).Traditional DCE analysis fits the pharmacokinetic parameters w(r) related to the extended Tofts model so that the modelled enhancement signal x(r, t; w) is close to the reconstructed dynamic MR data z(r, t).In this work we suggest a direct estimation of the kinetic parameters from undersampled dynamic (k, t)-space data with a Bayesian inference algorithm. An overview of the algorithm is shown in Fig. 1.The suggested scheme is evaluated on a simulated DCE MRI abdominal phantom, and on simulated prostate DCE MRI measurements for undersampling acceleration factors of 4 and 8. The performance of the suggested scheme is compared against indirect approaches where dynamic contrast enhanced MR data were reconstructed using zero-filled fast Fourier transformation or kt-FOCUSS and kinetic parameters w(r) were fit to these reconstructed images using the extended Tofts model.kt-FOCUSS is computationally efficient and was shown to recover accurate solutions even for highly undersampled (k, t)-space data. kt-FOCUSS uses a “soft ” sparse constraint suitable for dynamic MR reconstruction, and is implemented as a re-weighted quadratic optimization (Jung et al., 2007). kt-FOCUSS minimizes an unconstrained cost function, which aims to recover the space by frequency r–f image ρ=Hq(6)minq‖FHq-y‖22+λ‖q‖22where λ is the Lagrangian multiplier, F is the 2D Fourier transform along the r–f direction, H is a weighting matrix and q is the solution of the minimization. In other words, q is minimizing the quadratic optimization and H is re-weighting q. The r–f image ρ is initialized from interleaved low-frequency (k, t)-data. The resulting low resolution image is used to initialize the weighting matrix H and this solution is pruned to achieve a sparser image. The image is transformed to the r–f space because it is sparser in that domain, especially if the signal follows a periodic motion. This process is repeated iteratively (Jung et al., 2007).The acquired T1 weighted signal y(k, t)∈CK×J, is in the spatial frequency domain, where K is the number of spatial frequency samples per dynamic, and J is the number of dynamic acquisitions. The acquired signal can be modelled, S(k, t; w) as shown in (3) based on the pharmacokinetic parameters, w(r)={vp(r), Ktrans(r), ve(r), t0(r)} of the extended Tofts model assuming Gaussian noise σ on the acquired signal.(7)y(k,t)∼normal(S(k,t;w),σ)The suggested Bayesian inference algorithm maximizes the posterior probability distribution function p(x(w), σ|y) as a function of w(r) and σ(8)wˆ,σˆ=argmaxw,σp(x(w),σ|y)According to the Bayes theorem p(x(w), σ|y) is given by,(9)p(x(w),σ|y)=p(x(w),σ)·p(y|w,σ)∫w∗,σ∗p(x(w∗),σ∗)·p(y|w∗,σ∗)where•p(y|w, σ) is the likelihood function of y(k, t) given the model parameters w,•p(x(w), σ) is the product of the prior probability distribution functions of x(r, t; w) and σ, i.e. p(x(w), σ)=p(x(w))×p(σ).Prior probability distribution functions p(x; w), p(σ) reflect our prior knowledge about the x(r, t; w) and σ parameters.•a low rank prior on the dynamic enhancement signal x(r, t; w)∈RM×Jin the image domain to promote local coherence in time,p(x;w)=(exp(-λ·‖x(r,t;w)‖∗),‖⋅‖* is the nuclear norm and λ∈R+ is a regularization parameter. The nuclear norm of a matrix is the sum of its singular values,‖·‖∗=‖sing(·)‖1. The nuclear norm is the largest convex function bounded by the rank function.Gaussian prior for the kinetic parameters w(r). We assume that they remain positive and within a certain range,an uninformative Inverse Gamma (IG) prior is used for the unknown variance σ2 of the noise,p(σ2)=IG(σ2|a,b)=(ba/Γ(a))·σ-2(a-1)·exp(-bσ-2),The use of additional sparsity priors in the dynamic enhancement signal (l1 norm of the wavelet or total variation transform) was examined but did not benefit the algorithm.The maximization of the aforementioned posterior probability distribution function p(w, σ|y), would be similar to the problem of minimizing the unconstrained Lagrangian version of the nuclear norm relaxation from undersampled measurements y(k, t),(11)wˆ=argminwh(w)=argminw12‖y(k,t)-Fux(r,t;w)‖22+λ·‖x(r,t;w)‖∗where Fu∈RM×J→CT×Jis a Fourier sampling operator, with T⩽K. Cost function h is strictly convex hence its sub differential at w is(12)∂h(w)={v:h(v)⩾h(w)+uT(v-w),∀v∈RM}where uTis a subgradient of h atw,wˆis the optimal minimizerwˆ∈argminwh(w), iff0∈∂h(wˆ).Theorem 2.1 by Cai et al. (2008) states that the singular shrinkage operatorDλ(x(r,t;w))is the proximity operator ofλ·‖x(r,t;w)‖∗. The singular value shrinkage operator is defined as(13)Dλ(x)=USλ(Σ)V∗Sλ(Σ)=sign(Σ)·max(|Σ|-λ,0)Sλis the shrinkage operator, and x=UΣV∗ is any singular value decomposition of x, where Σ is the rectangular diagonal matrix, and U, V are the left and right singular vectors.Combettes and Wajs (2005) provided a solution to the unconstrained problem of Eq. (11). Cai et al. (2008) described a simplified version of the iterative soft thresholding algorithm (Eq. (2.10)), which in our case can be expressed as(14)x(r,t;wk)=Dλ(x(r,t;wk))(15)wk+1=wk-λ·(∇wx(r,t;wk))·FuT(y(k,t)-Fux(r,t;wk))Updates for each w parameter from the minimization of (11) are employed in the Bayesian scheme and as aforementioned we assume they follow Gaussian distribution.(16)wˆ=normal(w,σw)where σwis the standard deviation for each of the modelled parameters vp(r), Ktrans(r), ve(r), t0(r).The integral∫w∗,σ∗p(w∗,σ∗)cannot be calculated analytically, consequently p(x(w), σ|y) is estimated with the Metropolis–Hastings algorithm, which is a Markov chain Monte Carlo method.From the most recent sample parameters, candidate sample parameters are generated using a proposal density that must be symmetric, and probability space is explored using a random walk. The proposed density was a normal distribution.We first initialize the pharmacokinetic parameters w(r)={vp(r), Ktrans(r), ve(r), t0(r)}, the noise σ of the acquired signal, and the noise of the model parameters, σvp, σKtrans, σve, σt0 respectively as follows.For iteration i=0 and ∀r∈RM×Ji.vp(0)(r)=0.05, σvp(0)(r)=0.1.Ktrans(0)(r)=0.5, σKtrans(0)(r)=0.1.ve(0)(r)=0.7, σve(0)(r)=0.1.t0(0)(r), σt0(0)(r) will depend on the bolus injection time.σ2=IG(a=10−4, b=10−4).The aforementioned initializations have been used throughout the paper.The nuclear norm minimization described in Eq. (3) is employed to generate the recent x(r, t; w(i)), recent model parameters w(i) are estimated separately using Eqs. (14) and (15). The enhancement signal is formulated as a Casorati matrix, which is likely to be low rank because there is an expected correlation between images (columns of the Casorati matrix). This prior is incorporated to ensure that the algorithm can handle undersampled data. If the algorithm was solely a nuclear norm minimization, then the noise of the acquired data would not be modelled and it could not benefit from the convergence properties of the Bayesian inference algorithm used here (Gelman and Shirley, 2011). From each of the model parameters w(i), separate candidate sample parameters w(i+1) were generated using a proposal density Q(w(i+1)|w(i)). Q(w(i+1)|w(i)) must be symmetric and explore probability space using a random walk. Although the selection of proposal density is not trivial and can affect convergence (Rosenthal, 2010), normal proposal distributions usually work well in practice and this is why they were chosen in this scheme.i.vp(i+1)(r)∼normal(vp(i)(r), σvp(i)(r)).Ktrans(i+1)(r)∼normal(Ktrans(i)(r), σKtrans(i)(r)).ve(i+1)(r)∼normal(ve(i)(r), σve(i)(r)).t0(i+1)(r)∼normal(t0(i)(r), σt0(i)(r)).Acceptance thresholds are calculated for each sample parameter separately, and candidate sample parameters are rejected or acceptedthreshold=p(w(i+1), σ(i)|y)/p(w(i), σ(i)|y)If threshold⩽rand then w(i+1)=w(i) (i.e. reject candidate)else if threshold⩾rand then accept candidatewhere rand is a pseudorandom number generated from standard uniform distribution on the open interval (0, 1).Sample σ(i+1) is updated using the probability density function p(σ|w(i+1), y)∼p(σ)×p(y|w(i+1), σ),(17)p(σ|w(i+1),y)∼σ-2(a-1)·σ-kJ·exp-12σ2‖y(k,t)-S(k,t)‖22This is a form of a gamma distribution, G(a*, b*) with(18)a∗=a+K·J2andb∗=b+12‖y(k,t)-S(k,t)‖22The prior probability distribution p(w) depends on hyper-parameters {σvp, σKtrans, σve, σt0} that are tuned automatically. For each hyper-parameter an acceptance probability is defined as the percentage of the times the respective candidate sample parameters (one of vp(r), Ktrans(r), ve(r), t0(r)) has been accepted. If the acceptance probability falls within a certain range [0.3, 0.6] the hyper-parameters are kept the same, otherwise they are modified (scaled).It is assumed that Markov chain reaches the target distribution after a number of iterations (denoted as burn-in iteration); hence the variables from the early iterations are thrown away. To reduce sample correlations, thinning was used and only every thinth draw (thinning iteration) from the Markov chain was kept. If for example the thinning variable is equal to 5, only the samples from the mod(i, 5) equal to zero iteration will be kept.The techniques described were implemented in MATLAB (The Mathworks Inc., Natick, MA).The proposed Bayesian inference algorithm was implemented as a Metropolis–Hastings algorithm. Section 2.2.2 describes how the involved parameters were initialized. The total number of iterations was 500, burn-in iterations were 300, thinning equal to 5, and tune iteration (number of iterations for tuning) was 67.This approach was compared against techniques that fit the modelled enhancement signal to the reconstructed dynamic enhancement images and are denoted as “indirect”. For the indirect techniques, DCE images were reconstructed with either fast Fourier transformation after zero-filling (denoted as “Indirect(ZF-FFT)”), or kt-FOCUSS (denoted as “Indirect(ktFOCUSS)”). The parameter settings for kt-FOCUSS (Jung et al., 2007) were 40 inner iterations, 2 outer iterations, weighting matrix power factor 0.5, and initial estimate corresponding to low-frequency values.The fitting algorithm minimizes the l1-norm (Press et al., 1984) between the reconstructed measured data and the modelled enhancement signal with a simplex algorithm (fminsearch in MATLAB). To avoid local minima, the onset time t0 was randomly initialized 20 times and the pharmacokinetic parameters that best fit the data were reported.A normal volunteer underwent a fast gradient echo DCE-MRI protocol (flip angle 10°, repetition time 2.3ms). Informed consent and ethical approval was obtained.T1-weighted abdominal images were acquired in multiple time frames without contrast injection. The first time-frame was manually segmented into: liver, bowel, right and left heart, aorta, portal vein. Such segmentation was used as a map to simulate contrast enhancement using the extended Tofts model and a population arterial input function (Parker et al., 2006). T1 values were taken from (Tofts, 2010) and pharmacokinetic parameters for each organ were chosen in agreement with a previous study (Melbourne et al., 2008). Fifty DCE images were generated from the ground truth kinetic parameters with temporal resolution 3 s; and were transformed to (k, t)-space with fast Fourier transformation. The noise of complex valued (k, t)-space MR data can be reasonably modelled by an additive white Gaussian distribution on both real and imaginary components (with i.i.d. random variables) (Gudbjartsson and Patz, 2005). The level of noise was adjusted to achieve a signal to noise ratio (SNR) similar to the one reported in liver studies in the literature (Banerji et al., 2012). In practice the SNR is not known and here the SNR of the abdominal images was determined using a noise estimation algorithm (Coupe et al., 2010; Dikaios et al., 2013a). One of the advantages of modelling noise in the acquired (k, t)-space domain is that it does not suffer from spatial variations that are caused by image reconstruction.For the undersampling pattern, phase encoding lines were randomly selected per volume and per time frame from a distribution where the centre of k-space was more densely sampled. Undersampling patterns for 4 and 8-fold acceleration were generated using a Monte-Carlo algorithm to generate a sampling pattern with minimum peak interference (Lustig et al., 2007).The local institutional review board approved the study and waived the requirement for individual consent for the retrospective analysis of patient data collected as part of clinical trials/routine care (R&D No: 12/0195 date: 16/7/2012).A prostate patient with significant peripheral zone prostate cancer (definition for clinically significant cancer was ⩾Gleason 3+4 or ⩾4mm cancer core length) underwent prostatic multi-parametric MRI (T2, DCE and diffusion weighted MRI; Fig. 2) prior to template-prostate-mapping (TPM) biopsies as part of standard of care.Imaging used a 1.5T static magnet (Avanto, Siemens, Erlangen, Germany) and pelvic phased array coil. 0.2mg/kg (maximum 20mg) of spasmolytic (Bucsopan; Boehringer Ingelheim, Germany) was administered intravenously to reduce peristalsis. DCE-MRI was performed with a T1 weighted volumetric FLASH sequence with TR/TE 5.61/2.5ms, flip angle 15°, field of view 269mm, slice thickness 3mm, temporal resolution of 16 s, and number of time points 35.The original DCE images were then projected to (k, t)-space with fast Fourier transformation where normally distributed noise was added; undersampling masks for 4 and 8-fold acceleration were generated as described in Section 3.2. Noise was added directly to (k, t)-space MR data. Note that noise in the original magnitude MR images is considered as signal when used in simulations. Similar to the abdominal data, the level of applied noise was adjusted to match the noise level of prostate images.The proposed direct method was compared with the Indirect(ZF-FFT) and the Indirect(ktFOCUSS) methods. All comparisons were conducted for fully sampled (FS), 4 and 8-fold undersampled (US4 and US8 respectively) (k, t)-data.For the abdominal DCE phantom the kinetic maps from the different methods were compared using an entropy similarity metric (mutual information) to assess which method matches the ground truth kinetic parameters best. Similarly we examined which DCE images (reconstructed with ZF-FFT, kt-FOCUSS or estimated from the parameters w for the direct method) best matched the DCE images generated from the ground truth kinetic parameters.For the prostate data where no ground truth kinetic maps were available, an experienced radiologist assessed the derived kinetic maps to examine which method depicts cancer best.

@&#CONCLUSIONS@&#
