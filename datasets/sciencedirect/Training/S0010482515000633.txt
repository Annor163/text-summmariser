@&#MAIN-TITLE@&#
Reconstruction of optical scanned images of inhomogeneities in biological tissues by Monte Carlo simulation

@&#HIGHLIGHTS@&#
Simulation of multiport optical scanning system.Capable of differentiating the embedded inhomogeneities.Characterization of their optical properties.

@&#KEYPHRASES@&#
Monte Carlo simulation,Photons backscattering and transillumination,Phantoms,Inhomogeneities/tumor,

@&#ABSTRACT@&#
Graphical abstractMonte Carlo simulation is applied to imaging of photons backscattered and transmitted through a tissue phantom, made of heart tissues implanted with adipose or spleen tissues as inhomogeneities. The proposed optical scanning probe consists of nine units. Each unit has one photon injection port and three ports arranged in a straight line at 2, 4 and 6mm to collect backscattered photons emerging from various depths, and one port to collect the transmitted component placed coaxially to the source on the opposite side of the phantom. The figure shows one unit of the optical scanning probe. The backscattered data are collected by first port located at 2mm from the input port. The path-length of photons emerging out of first port is shorter compared to that of photons received by other ports. By collections of scanned signals on the tissue surface the tissues images located at various depths are constructed. By scanning of these images the normalized backscattered intensity (NBI) signals are obtained. By comparison of NBI signals the type of inhomogeneities and their locations are determined. Such data could be helpful in development of scanning devices for early detection of tumor in tissues.

@&#INTRODUCTION@&#
The interaction of laser radiations with biological tissues is a complex process due to involvement of several mechanisms. These include backscattering, transmission and absorption. The backscattering and transmission processes are further associated with collimated and multiple scattered photons, respectively [1,2]. Each process involves the interaction of radiations with structural components of tissues, which depend on their optical parameters, absorption and scattering coefficients and anisotropy parameter. Other parameters which influence this process are refractive index of the medium and wavelength of the light source [3,4]. The tissue parameters vary depending on their composition and functional properties between disease and control.Based on the characteristics of laser radiation, various techniques for clinical applications have been developed. An important application of this is to detect tumor in biological tissues. At present the most prominent screening tool for cancer detection is X-ray mammography, which exposes the patient to ionizing radiation, thus causing risk of cancer induction. The techniques such as positron emission tomography, MRI, ultrasound, and thermography have also contributed significantly in diagnostic medicine. Ultrasound data, based on variation of acoustic impedance, show the presence of tumor at fairly advanced stage after extensive application of computer algorithms. Other techniques require injection of contrast agent and are expensive. In contrast, the optical imaging emerges as an alternative tool in detection of inhomogeneity hidden in soft biological tissues [5,6]. The prominent optical techniques are based on frequency-resolved [6,7], time-resolved [8] and continuous wave procedures, employing different geometries [9,10].During the past three decades, red and near-infrared spectroscopy and imaging, based on backscattering and transmission of radiation have emerged as powerful research and diagnostics tools for both laboratory studies and clinical trials. Some of the applications include imaging of human tissues, measurements of oxygen consumption of muscle, detection of tumor in breast tissues, functional brain mapping and localization of internal organs in thorax region [11,12]. Through his pioneering work on transillumination, Cutler viewed the changes in human breast [13], leading to development of the frequency domain optical mammography, carried out by placing the sandwiched human breast between laser source and set of detectors [14,15]. Recently the transillumination of biological tissues, a time dependent procedure, is carried out by placing the source and detectors on the same surface [16,17].There are various types of tumors such as carcinoma, subcutaneous fat with melanoma, squamous cell carcinoma, adenocarcinoma, fibrosarcoma with their distinct optical properties [18,19]. The development of tumor may not be confined to single layer of tissues below the surface. The imaging of these, either by application of a single probe directly [20] or indirectly by parameter derived from tissue reflectance, is carried out [21]. The optical coherence tomography (OCT) [22] has extensively been used for imaging of biological tissues to a depth limited to around 1.5mm. Other techniques include mapping of tissue optical properties using modulated imaging [23], time-resolved diffuse reflectance with null source-detector separation [24] and log-slope analysis [25]. As these are single beam techniques, the backscattered data are confined to single layer of tissues under one measurement condition. In contrast to single transillumination probe, the image reconstructed by optical tomography provides the cross-sectional details of a single layer which could further be extended to multiple images of respective slices [26] for their 3D image reconstruction [27]. But for routine multilayer imaging of biological tissues, an inexpensive spatially resolved optical system, based on backscattering and transmission of radiation, is required.The analysis of radiation interaction with multilayer inhomogeneous tissues requires not only the optical parameters of individual tissues but also their refractive indices [28]. Experimentally this has been shown that the backscattered photons emerging closer to beam entry point originates from the tissue layers close to surface, whereas, photons received at farther distances emerge from the deeper layers [29]. The surface profile constructed from these backscattered signals is a unique feature of biological tissues and by best-fit of this profile with that as obtained by Monte Carlo simulation, the optical parameters of various tissues are also determined [30,31]. In contrast to this the transmitted signal emerging out on opposite surface carries information on overall composition of tissue structure, which may be valuable for parametric analysis and reconstruction of respective images. For this purpose a detailed analysis of photons interaction in tissue phantoms, with and without inhomogeneities is required. Monte Carlo simulation (MCS), which provides data on scattered photons even close to beam entry point on individual histories, is ideal for this purpose [32]. Thus the objective of the present work, based on the MCS, is to develop an imaging system, which establishes relationship between various optical and tissue phantom related parameters to detect the inhomogeneities in various layers, which are either highly backscattering or absorbing compared to that of control tissues.Fig. 1(a) shows the schematic of the system to measure backscattering and transmission components of radiation after multiple scattering from the control tissue phantom of infinite length and width and thickness 10mm. For imaging purpose a grid of size 30×9mm2 was superposed on the phantom. The origin of the coordinates system of phantom coincided with the center of the grid. The resolution of the grid was 1mm2, the same as size of injection and collection ports. The scanning head, consisting of nine units to inject and receive backscattered and transmitted photons, was initially placed at the left side of the grid. Each unit contained one input port for injection of infinitely narrow beam of photons and three receiving ports located at distance 2, 4 and 6mm from the input port to collect backscattered radiations, placed at the corresponding grid element. Our preliminary studies had shown that the separation between photons injection and collection ports placed in the probe is sensitive to the corresponding depth of tissue layers. Accordingly the nearest receiving port at 2mm received maximum number of backscattered photons from tissue layer located at depth 2mm approximately, whereas, the ports at 4 and 6mm collected photons from deeper layers. The transmitted component in each unit was received by an exit port of area 1mm2, placed coaxially with input port of the phantom.Initially 10 million photons of wavelength 632.8nm were injected at each input port, which after interaction with medium emerged as backscattered and transmitted components. The outline of the ports is shown in Fig. 1(b). The center to center separation between any pair of ports was 2mm. After collection of data at first grid line, the scanning head was moved 1mm away along x-axis. By this process the data from the entire grid of size 30×9mm2 were collected with final position of photon entry port at 24mm.From the number of backscattered photons collected within 1mm2 the normalized backscattered intensity (NBI) was calculated byNBI(%)=Ni,jN0×100N0 is the total number of incident photons and Ni,jis the total number of photons collected at any port.The NBI values as obtained at various locations of grid, along with their positions (i,j), were stored in the computer for further processing [33]. Similarly the number of transmitted photons collected within 1mm2 grid (i,j) was represented as the normalized transmitted intensity, given byNTI(%)=Ti,jN0×100N0 is the total number of incident photons and Ti,jis the total number of transmitted photons collected by the port.The NTI values were stored in the computer along with their positions for further processing.Monte Carlo simulation (MCS), due to its stochastic features, can be applied to any random event in nature. For this study it was used to simulate the light transport by injecting photons or photon packets on a random walk through biological tissues. The photon was treated as a neutral particle and its movement was governed by the mean free path, scattering and absorption coefficients, and anisotropy parameter of the medium [34]. The photons after multiple interactions within the medium, emerged as backscattered and transmitted components on the entry and exit surfaces of the phantom, respectively. The code for MCS is written in C++ language and time taken by 10 million photons at one grid location is 12min on a computer with quad-core processor of speed 3GHz and 2GB RAM. Total time taken for one operation over the grid surface was 12×9×24min=44h.The photons were introduced perpendicular to the surface for maximizing their entry and minimizing the surface reflection. Each photon, out of ten million, was initialized with a weight of unity. The step-size ‘s’ of the photon was calculated by a generated random variable,ς, given by(1)s=−lnςμt,andμt=μa+μswhereμt,μa,andμsare total attenuation, absorption and scattering coefficients of the medium, respectively. The value of the random numberςwas between 0 and 1. The deflection angleθis calculated by(2)cosθ=12g[1+g2−{(1−g2)(1−g+2gς)}2]forg≠0(3)cosθ=2ς−1forg=0where g is the anisotropy parameter of the medium. The azimuthal angle ψ is given by(4)ψ=2πγwhere γ is a random variable between 0 and 1.The path length of first interaction of photon was found, and thereafter this was moved. If the photon has left the tissue, the possibility of its presence at one of the receiving ports was checked. If detected, a counter was incremented to count the photon received by the corresponding port. If the photon was internally reflected, then the photon location was updated and the program continues. With each step the photon weight was reduced due to absorption by the tissue. The amount of weight lost,ΔQin absorption was given by(5)ΔQ=Wμaμtwhere W is the total weight of the photon. The photon weight and direction, after scattering in tissues of matched and mismatched refractive indices, were updated. The new position of the photon (x׳,y׳,z׳) from the previous position (x,y,z) is given by(6)(x׳y׳z׳)=(xyz)+s(sinθcosψsinθsinψcosθ)If the photon weight falls below a minimum threshold (Wc=0.001), then it was subjected to roulette condition to eliminate this. Further details of this simulation are given elsewhere [34].In order to test the optical probe, digital tissue phantoms were made. For this purpose the goat tissues heart, adipose and spleen were chosen, which was based on the optical properties of tumor removed from cancer patients [35]. Heart tissue was used as the control, and adipose and spleen as inhomogeneities, representing abnormal conditions. The optical properties of the tissues are given inTable 1. The refractive indices of heart, adipose and spleen were 1.40, 1.455 and 1.4, respectively [33].Adipose or spleen tissue of size 2mm diameter was located below the center (0, 0, 0) of the control tissue phantom. For first simulation adipose was embedded at depth (0, 0, 2mm), followed by its placement at (0, 0, 4mm) and (0, 0, 6mm). For each position the MCS was performed. Similarly, spleen tissue was also embedded in control phantoms at locations (0, 0, 2mm), (0, 0, 4mm) and (0, 0, 6mm) and their MCS carried out. By same procedure the distribution of the transmitted and backscattered photons in the control tissue, to be used for image subtraction purpose, was also performed.Tissues considered for this work are prepared under in vitro conditions. Hence there is no movement of sub-cellular component, in contrast to proteins molecular dynamics in tissues [36]. Hence the tissues are considered under equilibrium conditions with fixed values of the optical parameters.The optical probe was implemented by performing the MCS of light photon propagation in tissues. The photons out of 10 million that reach the output ports were counted and converted into respective NTI and NBI values. By shifting of scanning head by 1mm in x-axis direction on to next grid line, the MCS for photon transport was repeated. This process was repeated till source port reaches at position x=24mm. Entire data were stored in four files, one for transmission port and three for the backscattering ports.The data acquired were processed separately to obtain transmission and backscattered images by MATLAB.The data acquired by the transmission port was filtered by 5×5 low pass Gaussian filter. The filter function of this in frequency domain is given by(7)H(u,v)=e−D2(u,v)/2D02where D0 is the cutoff frequency and D(u,v) is the distance from the center of the frequency rectangle [37]. This filter reduces noise and produces a smoothed image. The background data, as obtained from control tissue, was subtracted to increase the contrast of the image.To reduce the variability, averaging was performed on the acquired data. For an N×N data the averaged value u(x,y) of NBI, by averaging the predefined neighborhood of f(x,y), was obtained [38]. This is performed by the formula(8)u(x,y)=1M∑n,m∈Sf(n,m)for x,y=0, 1,…., N−1, S is the set of coordinates in the neighborhood of (x,y), M is the total number of neighboring points (=9) taken. This operation forms an averaged image.The background data was subtracted to increase the contrast of the image. The resultant image was median (3×3) filtered to reduce the statistical noise and the noise associated with averaging procedure. In this filtering process, a predefined window consisting of the neighborhood of the data point (x,y) was chosen and the median of the data points within the window was found out. This was repeated for all data points in the image. Thereafter gray level transformation was applied on the resultant image for localization of the embedded tissue. Further details of the image processing procedures are given in [38]. The sequence of various operations applied for image processing is given inFig. 2.Monte Carlo methods follow a pattern when they are implemented without error. To test the developed code a circle inscribed inside a square was considered. The ratio of the area of the circle and square is pi/4. Here the %NBI data obtained for heart tissue, measured by the probe at 2mm, were used. A point p(x,y) is chosen on the xy-plane of the raw image where the reflectance data are present. With p as center and R as radius a circle is drawn and the number of photons reflected within this region is counted. Thereafter with p as center and 2R as length of each side a square is drawn and the number of photons present in this region is counted. The ratio of the number of photons within the circle to that of square region was calculated for each simulation with input of 1000–10 million, were calculated. The ratio varies from 0.798 to 0.7853, with minimum deviation from the actual value, 0.785(pi/4) with an input of 10 million photons.The convergence of the Monte Carlo code was determined by calculating the 95% confidence interval (CI) of the %NBI with respect to the number of photons using the expression [39](9)95%CI=mean−1.96×σm,mean+1.96×σmwhere m (=16) is the number of simulations and σ is the standard deviation of %NBI.Fig. 3 shows the confidence interval calculated for heart tissue for photon numbers ranging from 1000 to 10 million. This shows that the CI converges with increase in the number of photons as used for this simulation.The mean statistical error was calculated using the equation(10)MSE=σmand the results obtained show (Fig. 4) that the error is reduced with increase in number of photons, indicating the convergence of the NBI.Tissues are assumed to be of homogeneous nature. This was further verified by plotting of the surface profiles of heart, adipose and spleen tissues, represented as variation of normalized backscattered intensity with distance along x-axis (Fig. 5). The profiles obtained by this procedure, as shown on the left and right sides, match each other. The analyses carried out in other directions also show similar results, thus confirming the homogeneous nature of tissues.

@&#CONCLUSIONS@&#
