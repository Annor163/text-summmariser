@&#MAIN-TITLE@&#
Unified Dictionary Learning and Region Tagging with Hierarchical Sparse Representation

@&#HIGHLIGHTS@&#
Hierarchical structure among feature points, regions, and images are explored.We add a hierarchical structure to the process of sparse coding.Region sparse reconstruction is guided by the hierarchical structure.Dictionary learning and region tagging are unified into a new framework.Achieve better performance compared with state-of-the-art methods.

@&#KEYPHRASES@&#
Sparse coding,Region tagging,Sparse reconstruction,Unified hierarchical structure,Tree-guided dictionary learning,

@&#ABSTRACT@&#
Image patterns at different spatial levels are well organized, such as regions within one image and feature points within one region. These classes of spatial structures are hierarchical in nature. The appropriate integration and utilization of such relationship are important to improve the performance of region tagging. Inspired by the recent advances of sparse coding methods, we propose an approach, called Unified Dictionary Learning and Region Tagging with Hierarchical Sparse Representation. This approach consists of two steps: region representation and region reconstruction. In the first step, rather than using theℓ1-norm as it is commonly done in sparse coding, we add a hierarchical structure to the process of sparse coding and form a framework of tree-guided dictionary learning. In this framework, the hierarchical structures among feature points, regions, and images are encoded by forming a tree-guided multi-task learning process. With the learned dictionary, we obtain a better representation of training and testing regions. In the second step, we propose to use a sub-hierarchical structure to guide the sparse reconstruction for testing regions, i.e., the structure between regions and images. Thanks to this hierarchy, the obtained reconstruction coefficients are more discriminate. Finally, tags are propagated to testing regions by the learned reconstruction coefficients. Extensive experiments on three public benchmark image data sets demonstrate that the proposed approach has better performance of region tagging than the current state of the art methods.

@&#INTRODUCTION@&#
Image archives on the Web are growing rapidly. According to the report released in August 2011, Facebook has 700million users and 150billion photos. This brings along a great challenge in the research of image retrieval. A considerable number of automatic image annotation (AIA) approaches used in image retrieval have been proposed to meet this challenge [1–4]. However, these image-level tagging methods tend to become less effective because a global image matching approach can hardly handle the diversity and arbitrariness of Web image content. Tagging images in a more fine-grained level can be helpful to improve the performance of image retrieval. Image tag localization, i.e., assigning tags to image regions (namely, region tagging), has become a research direction to solve this problem [5].The first step of region tagging is to obtain the representation of regions (note this paper aims at solving the region tagging problem, therefore, we assume the ground truth of region segmentations for the images have been provided in the dataset and the proposed method focuses on assigning the candidate tags to the ground truth of regions. For this reason, we say that the first step of region tagging is region representation rather than segmentation for an image). Several related methods have been proposed. The bag-of-words (BoWs) model treats an image as a set of unordered appearance descriptors extracted from local patches. Then these descriptors are quantized into discrete “visual words”, thus generating a compact histogram representation for every image. The BoW approach discards the spatial order of local descriptors, which limits the descriptive power of the image representation. To overcome this problem, the spatial pyramid matching (SPM) [6] is proposed. This method partitions an image into2l×2lsegments at different scales l=0,1,2. Then the BoW histogram within each of the 2l segments is computed. Finally the method concatenates all the histograms to form a vector representation of the image. However, it is time consuming to compute the kernel matrix for classification. For this reason, Yang et al. [7] proposed the ScSPM method, which integrates the sparse coding technique into the SPM. Instead of the K-means vector quantization in the traditional SPM, this method computes a spatial-pyramid image representation based on the sparse codes of SIFT features. Furthermore, unlike the original SPM that performs spatial pooling by computing histograms, the ScSPM computes the max spatial pooling that is more robust to local spatial translations. The above three methods assume that the feature points extracted from images are independent from each other when training the dictionary (or visual words), and as such they ignore the relationship among them.However, in real world, patterns at different spatial levels are well organized, such as regions within one image, feature points within one region. These classes of spatial structures are hierarchical in nature, i.e., every region in images contains feature points, some regions constitute the image they belong to, and all the images constitute a root. This hierarchical structure can be naturally represented as a tree, where structured semantic information is encoded. For example, images in the same scene are usually composed of fixed region tags. Correspondingly, two images in one scene should have the same child nodes in a tree. As shown in Fig. 1, both the first image and third image are mainly composed of objects like tree, building and sky. In the past few years, a variety of hierarchical structures have been used for practical applications. For instance, patterns among object parts are used to form compositional models for object recognition [8–10]. The relationship of objects are used to capture semantic contextual information for robust object detection or image labeling [11–13]. The hierarchy of low-level features have been shown to be more discriminative than single features for object recognition [14,15]. These research efforts demonstrate that the utilization of this hierarchically encoded spatial and semantic information can provide rich information to facilitate vision tasks. For this reason, we believe that integrating the hierarchical structure in Fig. 1 into region representations will help us obtain more accurate representation for regions and thus can effectively facilitate region tagging.To this end, we firstly learn a dictionary via sparse coding technique like that in ScSPM, what is different lies that the procedure of dictionary learning here is guided by the hierarchy. Then, we use this tree-guided dictionary to encode feature points to get more accurate region representations. Specifically, sparse coding first solves a regression problem to obtain the regression coefficients on the base of an initialized dictionary. Then, a new dictionary is trained to update the initialized dictionary by minimizing a least squared error function. These two steps are repeated until the optimal dictionary is obtained. In our method, we integrate the hierarchical structure existing among feature points, regions, and images into the regression problem. Thus the regression coefficients are computed, which is guided by this hierarchy. This procedure is called as tree-guided regularization and can be solved by the tree-guided multi-task group lasso [16]. Because the regression coefficients are computed under guidance by the hierarch, the dictionary trained by these hierarchy-guided coefficients also encodes a hierarchical structure information. After that, we use this tree-guided dictionary to encode each feature point to get the sparse codes. To further improve the discrimination of region features, we also compute a spatial-pyramid region representation based on the learned sparse codes like ScSPM. In this way, more accurate region representations can be obtained.With the learned representation of each region, the second step is to assign tags to image regions. Though several related learning based methods [17–20] can be used to predict tags for testing regions, we propose to use the sparse reconstruction method [21–23] to attain such a goal. When using the training regions to reconstruct the testing regions, the traditional sparse reconstruction methods also ignore the hierarchical structure of training regions, i.e., the structure above the red line in Fig. 1. This structure provides context information as it encodes the spatial and semantic information between regions and images. In our method, we also use the tree-guided group lasso to formulate this hierarchical structure into the framework of sparse reconstruction. With this hierarchy-guided sparse reconstruction process, we can get more discriminate reconstruction coefficients. Finally, tags are propagated to testing regions by the learned reconstruction coefficients.One thing to note is that the two hierarchical structures used in two steps correspond to different depths of a unified hierarchical structure, respectively. In region representation, the whole hierarchical structure existing among feature points, regions, and images is integrated to obtain more accurate representations. In region reconstruction, a sub-hierarchical structure between regions and images (the part above the red line in Fig. 1) is used to guide sparse reconstruction to obtain a better performance of region tagging. Fig. 1 illustrates this unified hierarchical structure, and the red line depicts the different depths in the tree.In conclusion, this paper has two main contributions. The first one is to propose the idea that using a unified hierarchical structure to guide the process of region tagging. The second contribution is to propose a region tagging framework of integrating this unified hierarchical structure into dictionary learning and region reconstruction, respectively. In the experiments, we evaluate the proposed framework on three public benchmark image data sets and compare it with the state-of-the-art methods. Experimental results demonstrate that the proposed framework has better performance of region tagging.The remainder of this paper is organized as follows. We first introduce related works in Section 2. Then some preliminaries used in this paper are given in Section 3. The framework of this paper is introduced in Section 4. In Section 4.3, we discuss some computational issues of the proposed method. The experimental analysis and conclusion are given in Sections 5 and 6, respectively.

@&#CONCLUSIONS@&#
