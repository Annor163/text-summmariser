@&#MAIN-TITLE@&#
Low-dose 2D X-ray angiography enhancement using 2-axis PCA for the preservation of blood-vessel region and noise minimization

@&#HIGHLIGHTS@&#
A novel and fast vessel-enhancement method for 2D angiography method is proposed.The results showed that we obtain nature enhanced X-ray images using our method and the processing time is very small.Our method is applicable to 2D angiography procedures such as catheterization, which requires rapid and natural vessel enhancement.

@&#KEYPHRASES@&#
Vessel enhancement,2-Axis PCA,2D angiography,Noise reduction,Vessel segmentation,Energy compaction,

@&#ABSTRACT@&#
Enhancing 2D angiography while maintaining a low radiation dose has become an important research topic. However, it is difficult to enhance images while preserving vessel-structure details because X-ray noise and contrast blood vessels in 2D angiography have similar intensity distributions, which can lead to ambiguous images of vessel structures. In this paper, we propose a novel and fast vessel-enhancement method for 2D angiography. We apply filtering in the principal component analysis domain for vessel regions and background regions separately, using assumptions based on energy compaction. First, we identify an approximate vessel region using a Hessian-based method. Vessel and non-vessel regions are then represented sparsely by calculating their optimal bases separately. This is achieved by identifying periodic motion in the vessel region caused by the flow of the contrast medium through the blood vessels when viewed on the time axis. Finally, we obtain noise-free images by removing noise in the new coordinate domain for the optimal bases. Our method was validated for an X-ray system, using 10 low-dose sets for training and 20 low-dose sets for testing. The results were compared with those for a high-dose dataset with respect to noise-free images. The average enhancement rate was 93.11±0.71%. The average processing time for enhancing video comprising 50–70 frames was 0.80±0.35s, which is much faster than the previously proposed technique. Our method is applicable to 2D angiography procedures such as catheterization, which requires rapid and natural vessel enhancement.

@&#INTRODUCTION@&#
Two-dimensional X-ray angiography is the most commonly used imaging modality for artery diseases monitoring and facilitating catheter-based procedures, such as FFR, IVUS, OCT, stent or peacemaker implantation. Briefly, it provides online two-dimensional projections of considered vessel to the clinician, which manually injects the contrast agent into the vessel since blood itself does not absorb enough amounts of X-rays to be visible. As a consequence, patients and medical staff can be exposed to X-ray radiation for prolonged periods. To minimize this harmful exposure, very low levels of X-ray dosage are used. However, this leads to considerable degradation of image quality through quantum noise [1,2]. Therefore, the ability to enhance images while maintaining a low radiation dose has become an important research topic.There have been a number of studies on vessel enhancement methods. One popular technique is based on the second-order Hessian matrix [3–6]. And there are approaches with other filters that use information from neighboring pixels, such as the directional filter-bank-based method [7,8], the method using morphological connected-set filters [9–11], and the method using curvilinear filters [12]. To use more information, several nonlocal filters have been proposed for both the spatial domain and the frequency domain. Buades et al. [13] proposed a weighted nonlocal filtering in spatial domain. In this method, noises are removed by a pointwise estimate of the image where each pixel is obtained as a weighted average of pixels centered at regions that are similar to the region centered at the estimated pixel. Because all pixels of image can be used for averages, the estimates are non-local. One popular technique that uses a nonlocal filter in the frequency domain is block-matching and 3D filtering (BM3D) [14]. BM3D filter uses a procedure termed grouping and collaborative filtering. Grouping procedure is the step to find mutually similar 2D image patches and stack them in 3D blocks. And collaborative filtering procedure is the step to estimate all grouped 3D blocks by filtering them jointly by using hard-threshold or wiener filter in transform-domain. Video block-matching and 3D filtering (VBM3D) [15] applies BM3D successfully to a video system. In this method, groups are 3D blocks of mutually similar 2D patches extracted from a set of consecutive frames of the video sequence. BM3D and V-BM3D schemes are applied in medical imaging applications [16–18].Using the assumptions related to sparse representation in BM3D, it is possible for noise-free images to be sparsely represented in the transform domain. Even though the temporal Fourier transform is effective in making the signal sparse when the image undergoes periodic motion, other transforms might be more efficient for other types of motion. Unlike the Fourier transform, the principal component analysis (PCA) transform is data dependent. It is well known that the PCA transform gives optimal energy compaction, with most of the energy accounted for by only a few coefficients [19]. Here, energy relates to image information such as the brightness magnitude and the variation of brightness between neighborhoods. Our method is based on these assumptions. The 2D angiography used in clinical practice involves the flow through the blood vessels of a contrast medium, which is a substance used in medical imaging to enhance the X-ray images of fluids within the body. The resulting images will contain more motion, both general and periodic, than those for other video applications. This fact enables sparser and less noisy images to be produced by using the PCA transform and removing low-energy coefficients. In addition, we are obtaining the PCA transform matrix of each vessel region and background region from difference of motion properties, which will preserve important information about the blood-vessel structures.In this paper, we present a novel vessel enhancement method based on removing separately the noise in the extracted vessel region and in the background region within the PCA domain. Conventional approaches enhance images by combining neighboring pixels in a 3D kernel which includes temporal information of those neighboring pixels. However, our method uses only temporal information without the convolution's operation, which decreases the computation time by removing the convolution calculations required in a spatial domain, enhances images non-artificially and reduces the number of parameters to be optimized. Furthermore, we enhance the vessel region and the background region separately in PCA domain. And, it removes noise while preserving the details of vessel structures.The remainder of the paper is organized as follows. Section 2 describes the proposed three-step method for 2D-angiography vessel enhancement. Section 3 presents the results of the application of the proposed method to clinical datasets in comparison with other previous methods. Finally, we discuss results/correctness analysis, novelty and future work in Section 4 and summarize our method in Section 5.The proposed method comprises three main steps, as shown in Fig. 1. First, we extract an approximation of the whole vessel structure from the 2D angiography and partition the whole image into a vessel region and a background region. Second, all pixels are transformed from the spatial domain to the time domain, with all pixels transformed to a new coordinate system having a basis in each region obtained by PCA. Finally, frames are enhanced using a hard threshold in the PCA domain, and each region is converted back from the PCA domain to the spatial domain by an inverse transformation.In this step, we extract an approximate vessel region that will include most of the flowing vessels for each frame of the input 2D angiography. This process is a necessary step in distinguishing between intensity variation caused by noise and that caused by the contrast medium. A blood vessel emphasized by the contrast medium is the most important structure in 2D angiography. The structure should be preserved and distinguished from noise.To extract the vessel region, we construct a digital subtraction angiography (DSA) by subtracting the average of images obtained after injecting contrast medium into the blood vessels from the average of images before the injection. Because the overall noise distribution approximates a Poisson distribution in X-ray imaging, the expectation of noise asymptotically approaches zero. Averaging the images therefore has a denoising effect. We find candidate vessels via the Hessian-based method of multiscale vessel enhancement [3]. We then remove wrongly extracted noise and connect broken vessels by applying a morphological operator. In addition, we make the edges of the vessel region robust by including an area beyond the calculated extent of the blood vessels (see Fig. 2).In this step, we transform N 2D X-ray images (consecutive frames of the angiography) from the spatial domain to the N-dimensional time domain. In other words, if the intensity value of the ith time image at location (x,y) is Ii, each pixel at (x,y) is mapped to (I1, I2, I3,…,IN) in the N-dimensional time domain. Therefore, k pixels (width×height) transform to the time domain by having an N-dimensional feature vector (Figs. 3 and 4).x=I1(1,1)…I1(w,h)⋮⋱⋮IN(1,1)…IN(w,h)where N is the frame number, w is the width, and h is the height.We perform a PCA for pixels belonging to the vessel region, extracted as in Section 2.1, and the background region. The results can be defined as the basis of a new coordinate system because the components are mutually orthonormal. The covariance matrixCofxcan be(1)C=∑k=1NλkψkψkT,whereλkk=1Nandψkk=1Nare the eigenvalues and the corresponding orthonormal eigenvectors (or principal components), respectively. Then(2)y=UTxU=ψ1…ψN,In this step, we enhance the 2D angiography by removing eigenvectors corresponding to eigenvalues below a threshold:(3)ψk=0ifλk<threshold,1≤i≤N,1≤j≤L,whereNis the frame number, andLis the image size.We assume that the true signal is well approximated by a linear combination of just a few basis elements. That is, the signal can be sparsely represented in the PCA transform domain. Therefore, we are able to estimate the true signal effectively by preserving the few high-magnitude PCA transform coefficients that convey most of the true-signal energy and removing the rest, which are mainly caused by noise. This assumption is used by most transform-domain image denoising methods. Fig. 5illustrates the enhancement of 2D angiography and the removal of noise in the PCA domain.In high-dose 2D angiography, the coefficients of most eigenvector bases other than those corresponding to large eigenvalues are small values close to zero. Fig. 6compares coefficients of low-dose 2D angiography with high-dose 2D angiography in the PCA domain. Both low-dose and high-dose 2D angiography have high-magnitude coefficients (i.e., bright) in a basis corresponding to a large eigenvalue. However, in other bases, high-dose angiography is relatively noise free, with coefficients lower (i.e., dark) than for low-dose angiography, which has more noise. This shows that the assumption about energy compaction is reasonable.By using the inverse matrix of the PCA transform matrix obtained from Eq. (2), we transform the enhanced data from the PCA domain back to the time domain, where the data in the time domain represent the 2D enhanced angiography directly. Because the PCA transform matrix is orthonormal, the inverse matrix is the same as the transpose matrix. We can obtain the inverse matrix of the PCA transform matrix easily (Fig. 7):(4)x∗=Uy∗wherey* represents enhanced data in the PCA domain andx* represents enhanced data in the time domain.Algorithm 1 describes the pseudo-code of 2-axis PCA, which summarizes our method in Section 2. The input is matrix of N 2D X-ray images X and threshold value thr. And, the output is matrix of enhanced N 2D X-ray images X*. Each row of matrix X*is the each frame of enhanced 2D X-ray angiograph. The w and h are the width and height of images.Algorithm 1Pseudo-code implementation of 2-axis PCAInput: N 2D X-ray images X∈IN×wh, thrOutput: Enhanced N 2D X-ray images X∗∈IN×whbegin//Step 1: Segmentation of rough blood vesselforall thei∈[1,M] doIBEFORE←IBEFORE+Iiforall the i∈[M,N] doIAFTER←IAFTER+IiIDSA←IAFTER+IBEFORE//Extract vessel region (RV) and background region (RB) by Hessian-based method [3].Rv,RB←IDSA//Step 2: PCA transformation of vessel region and background regionXV←RV∩X, XB←RB∩X//Calculate covariance matrixCV←XV, CB←XBforall thek∈[1,N] do//Calculate eigenvectorsψvk←CVψbk←CB//PCA transformationYV(UV)TXV,Uv←ψv1…ψvnYB(UB)TXB,UB←ψb1…ψbn.//Step 3: Enhancement preserving vessel structureforall thek∈[1,N] doifλvk<thrthenΨvk←0ifλbk<thrthenΨbk←0//Inverse PCA transformation(XV)*←UV(YV), (XB)*=UB(YB)*X*←(XV)*∪(XB)*

@&#CONCLUSIONS@&#
