@&#MAIN-TITLE@&#
Characterization of bivariate hierarchical quartic box splines on a three-directional grid

@&#HIGHLIGHTS@&#
We identify the subspace of “special quartics” generated by quartic box splines.We establish the completeness of hierarchicalC2-smooth quartic box splines.We characterize the hierarchical space using “special quartic” polynomials.We obtain a basis for the hierarchical spline space over type-I triangulations.

@&#KEYPHRASES@&#
Hierarchical splines,Box splines,Completeness,Adaptive refinement,Three-directional grid,Type-I triangulation,

@&#ABSTRACT@&#
We consider the adaptive refinement of bivariate quarticC2-smooth box spline spaces on the three-directional (type-I) grid G. The polynomial segments of these box splines belong to a certain subspace of the space of quartic polynomials, which will be called the space of special quartics. Given a bounded domainΩ⊂R2and finite sequence(Gℓ)ℓ=0,…,Nof dyadically refined grids, we obtain a hierarchical grid by selecting mutually disjoint cells from all levels such that their union covers the entire domain. Using a suitable selection procedure allows to define a basis spanning the hierarchical box spline space. The paper derives a characterization of this space. Under certain mild assumptions on the hierarchical grid, the hierarchical spline space is shown to contain allC2-smooth functions whose restrictions to the cells of the hierarchical grid are special quartic polynomials. Thus, in this case we can give an affirmative answer to the completeness questions for the hierarchical box spline basis.

@&#INTRODUCTION@&#
Box splines and the functions contained in the spaces spanned by them form a very useful class of piecewise polynomial functions on regular grids. They possess a number of useful properties that make them well-suited for applications. It has been shown that box splines have small support (a few cells of the underlying grid), they are non-negative, they form a partition of unity, and that box splines are refinable, i.e., the box spline spaces on refined grids are nested (Böhm, 1983; de Boor and Ron, 2008). Monographs and survey articles about box splines include (de Boor et al., 1993; de Boor and Ron, 2008; Chui, 1988; Prautzsch and Boehm, 2002). Tensor-product B-splines are special instances of box splines also.From the rich literature on box splines, we mention a few representative publications on three specific topics. Firstly, a substantial number of results on the approximation power of box splines is described in the literature, e.g. (Lyche et al., 2008; Ron and Sivakumar, 1993). Secondly, several publications discuss techniques for the efficient manipulation of box spline bases. A general stable evaluation algorithm is devised in Kobbelt (1997). In Kim and Peters (2009) the problem of efficient evaluation of box splines is addressed by making use of the local Bernstein representation of basis functions on each triangle. Also, numerical integration schemes, which are important for applications, based on quasi-interpolation have been considered in Lamberti (2009), Dagnino et al. (2013).Using hierarchical splines is a well-established approach to adaptive refinement in geometric modeling (Forsey and Bartels, 1988) and numerical analysis (Mustahsan, 2011; Schillinger et al., 2012; Vuong et al., 2011). Kraft (1998) introduced a basis for hierarchical tensor-product spline spaces using a selection mechanism for B-splines. More recently, a slight modification of this approach was shown to provide a basis with better properties, such as the partition of unity property, strong stability and full approximation power (Giannelli et al., 2012, 2014; Speleers and Manni, 2015). The hierarchical approach has been extended to Powell–Sabin splines, Zwart–Powell elements and B-spline-type basis functions for cubic splines on regular grids (Kang et al., 2014; Speleers et al., 2009; Zore and Jüttler, 2014).Computations of the dimensions of spline spaces on partitions of a domain and constructions of suitable bases for such spaces are classical problems considered in the theory of multivariate splines (Wang, 2001; Zeng et al., 2015). The completeness question (i.e., how to construct a basis spanning the entire spline space on a partition of a domain) led to the introduction of polynomial splines over hierarchical T-meshes (PHT-splines) (Deng et al., 2006, 2008; Li et al., 2010). Bivariate splines over T-meshes are considered in Schumaker and Wang (2012). A graphical summary of the related literature has been given in Mokriš and Jüttler (2014, Fig. 1). Several publications have addressed the completeness questions for hierarchical spline spaces generated by tensor-product B-splines (Berdinsky et al., 2014; Giannelli and Jüttler, 2013; Mokriš et al., 2014). Given a hierarchical spline space, these publications derive sufficient conditions which guarantee that the associated basis (obtained by Kraft's selection mechanism) spans the entire spline space on the partition of the domain which is determined by the hierarchical space.The paper explores the hierarchical spline spaces generated byC2-smooth quartic box splines on nested type-I triangulations of a bounded domainΩ⊂R2, cf. Fig. 1. These functions form the mathematical basis of Loop's subdivision scheme and are therefore used to construct the regular parts of the corresponding subdivision surfaces, cf. Loop (1987), Stollnitz et al. (1996). Moreover, it is known that anyC2-smooth piecewise polynomial function of degree 4 on a type-I triangulation ofR2can be represented as a linear combination of box splines plus three (globally supported) truncated power (piecewise polynomial) functions of degree 4. However, the box splines suffice for representing all locally supportedC2-spline in the space, cf. Chui and Wang (1984). On each cell of the triangulation, the space generated by the box splines spans a 12-dimensional subspace of quartic bivariate polynomials. This subspace, which will be called the space of special quartics, is known to contain the cubic polynomials. The current manuscript follows the approach presented in Mokriš et al. (2014) in order to establish the completeness of hierarchicalC2-smooth quartic box splines with respect to special quartics.Using a suitable selection procedure, which generalizes the hierarchical B-spline basis introduced by Kraft (1997) to quarticC2-smooth box splines, we define a basis spanning a hierarchical box spline space. We prove that the elements of the space can equivalently be characterized as theC2-smooth functions whose restrictions to the cells of the hierarchical grid (which consists of mutually disjoint cells from different levels covering the entire domain) are special quartic polynomials.The remainder of this paper consists of five sections and an appendix. The next section recalls existing results concerning bivariate spline spaces on regular grids andC2-smooth quartic box splines. It also derives a characterization ofC2-contacts between segments of special quartic polynomials by their box spline coefficients. Section 3 is devoted to the spaces ofC2-smooth functions whose segments are special quartic polynomials on a multi-cell domain, where all cells belong to the same level. For certain multi-cell domains, which are said to be admissible, these spaces are spanned by the associated box splines. These domains are characterized by an offset condition in Section 4. Based on these results, the fifth section discusses the completeness of the hierarchical box spline basis on the associated hierarchical grids. Finally we conclude the paper. The Appendix A proves that the spaces spanned by the special quartic polynomials on each cell are simply restrictions of a globally defined subspace of the space of quartic polynomials.We recall existing results concerningC2-smooth quartic splines on regular type-I triangulations and characterizeC2-smooth contacts between special quartic polynomials on adjacent triangular cells.We consider bivariate splines on a three-directional grid in the planeR2, see Fig. 1. Let us denote byPdthe linear space of polynomials inR[x,y]of degree less thand+1.Furthermore, we consider a partitionGΩof a polygonal domainΩ⊂R2into mutually disjoint cells, where each cell is an open set and the closure of the union of all cells equals Ω. In addition we choose a finite-dimensional linear space T of functions onR2.Definition 1We defineSr(GΩ,T)to be the space ofCr-smooth functions s on Ω with the property that their restrictions (denoted by the vertical bars|△) to any cell△∈GΩyields a function which is obtained by restricting a function in T to the cell, i.e.,(1)Sr(GΩ,T)={s∈Cr(Ω):s|△∈T|△for all cells△∈GΩ},where the linear spaceT|△contains the restrictions of the functions in T to the cell △.We will call the above space a spline space, and its elements spline functions or simply splines. This definition is quite general and applies to any partition of a planar domain inR2and to any linear space T. A typical choice isT=Pd, but other choices are also envisaged in this paper.In a slight abuse of notation we will also use this definition for the caser=−1, where we obtain the spaceS−1(GΩ,T)of disconnected splines onGΩ. Strictly speaking, these spline functions are well-defined only on the interior of the cells,⋃△∈GΩ△, since they may take multiple values on edges and vertices.Example 2IfT=Pd, we obtain the spline space formed by theCr-smooth piecewise polynomials of (total) degree d. Typically, this space is used when considering triangulations of the domain. Alternatively one may consider bivariate tensor-product polynomialsT=Pd⊗Pdof bidegree(d,d), which are used in connection with partitions of the domain into axis-aligned boxes. Clearly, it is also possible to consider trigonometric polynomialsT=span{1,cos⁡kx,sin⁡kx:k=1,…,d}or multivariate versions thereof. In this paper we are interested in a certain subspaceT=PˆofP4which is generated by the polynomial segments ofC2-smooth quartic box splines on type-I triangulations. ◇Throughout this paper, we consider a particular triangulation that allows to construct splines with good properties. More precisely, we consider the bi-infinite grid inR2with linesR×ZandZ×R, and the triangulation obtained by adding the north–east diagonals in the squares of the grid, see Fig. 1. This produces a three-directional grid which we denote by G. The grid G is a set which contains the elementary triangles (which are called cells) as its elements, where each of the triangles is considered as an open subset ofR2.This type of grid is called a type-I triangulation (e.g. Lai and Schumaker, 2007), and spline spaces on triangulations of this type have been studied thoroughly in the rich literature on this subject. In particular, they include box spline spaces, which are interesting due to their elegant construction and simple refinement algorithm.All results concerning splines on type-I triangulation remain valid under affine transformations of the underlying grid G. For instance, these transformations include scalings of the grid (and we will use this fact later when constructing hierarchical spline spaces), but also affine mappings that transform all triangles into equilateral ones, a particular case which reveals the built-in symmetries of these spline spaces.We restrict ourselves to polynomialsP4of degree up to four and we will denote this space simply byP. For each triangle△∈G, let us denote byP|△the linear space formed by the restrictionsf|△of all polynomialsf∈Pto △, i.e.,P|△={f|△:f∈P}.For a given triangle △, any bivariate polynomial can be represented as a linear combination of the associated bivariate Bernstein polynomials on this triangle (Lai and Schumaker, 2007),(2)f|△=∑i+j+k=4cijkBijk4,with real coefficientscijk. Each Bernstein polynomialBijk4has an associated anchor point, which possesses the barycentric coordinates(i/4,j/4,k/4)with respect to the triangle. This representation of the polynomials is quite useful for the efficient evaluation of the functions and their derivatives at a given point (Kim and Peters, 2009; Lai and Schumaker, 2007).The coefficients in Fig. 2, which are placed according to the associated anchor points, define a piecewise polynomial function, whose support is the set of these triangles. The multiple 1/24 of this function is the symmetric quartic box spline (cf. Lai and Schumaker, 2007 for more details). This box spline is aC2-smooth function on the three-direction grid and will be our main object of interest. It will be denoted byB. Note that this box spline forms the mathematical basis of Loop subdivision surfaces (Loop, 1987; Stollnitz et al., 1996).The translatesβij(⋅)=B(⋅−(i,j)),(i,j)∈Z2are known to form a locally linearly independent set(3)B={βij:(i,j)∈Z2}in the following sense: for any open subsetA⊂R2, the translatesBA={βij∈B:supp(βij)∩A≠∅}restricted to A are linearly independent (Lai and Schumaker, 2007). Heresupp(f)denotes the support of the function f.By construction, each translated box splineβijis associated with the lattice point(i,j). For a cell △ in G, let△¯denote the closure of △. We consider the translates whose support contains the given cell △,B△={βij:supp(βij)∩△≠∅}.This set is formed by the 12 translatesβij, which are associated with the vertices of the 1-ring neighborhood of △ in the three directional grid, see Fig. 3.We now consider the linear space spanned by the restrictions of these translates to the given triangle,(4)V△=(spanB△)|△.Since this space is a genuine subset of quartic polynomials (its dimension is only 12), we will call it the space of special quartics on △.Remark 3It can be shown thatV△=Pˆ|△where(5)Pˆ=span(P3∪{x4−2x3y,y4−2xy3}).In particular, it should be noted thatPˆis independent of the chosen cell △. The proof of this observation is postponed to the Appendix A. ◇Any polynomialf|△∈V△has a unique representationf|△(x)=∑β∈B△λ△β(f|△)β(x),x∈△,for certain coefficientsλ△β(f|△)∈R.Now we consider two cells △ and△′which share an edge. The 1-rings around △ and△′have 10 vertices in common, or equivalently,B△, andB△′share 10 elements, see Fig. 4.The following notion of contact will be important in the sequel for the definition of spline spaces.Definition 4We say that two polynomialsf|△∈P△andf′|△′∈P△′have contact of order 2 (and writef|△∼f′|△′), if(6)∀x∈△¯∩△¯′,∂i+j∂xi∂yjf|△(x)=∂i+j∂xi∂yjf′|△′(x)for all i and j with0≤i+j≤2. The derivatives and values at points on the boundary of a triangle are obtained by one-sided limits.This property of contact, or continuity of higher order, is a desired property in applications. The following lemma will help us to characterize the situation of contact of quartic box splines.Lemma 5Consider a domainΩ=△∪△′‾consisting of two triangles meeting on one edge. Thendim⁡S2(GΩ,Pˆ)=14.Letℓ(x,y)be the (implicit) equation of the line that contains the common edge of the two triangles.Let(f|△,f′|△′)∈S2(GΩ,Pˆ), thenf|△−f′|△′=ℓ3(ax+by+c),sinceℓ(x,y)3|(f−f′)is equivalent tof|△∼f′|△′. Therefore(7)f=f′+(Ax+By+C)3(ax+by+c),whereℓ(x,y)=Ax+By+C, forA,B,C∈R.Since the gridGΩhas only three directions, we only need to consider the cases:(A,B,C)=(1,0,t),(0,1,t)or(1,−1,t), fort∈R.If(A,B,C)=(1,0,t), then (7) becomesf=f′+ax4+byx3+p(a,b,c)for a polynomialp∈P3that depends ona,band c. Sincef,f′∈Pˆ, from Remark 3 we deduce thatb=−2a, leading to(8)f=f′+a(x4−2x3y)+p(a,c).The case(A,B,C)=(0,1,t)is analogous to latter due to the symmetry of the generators ofPˆwith respect to x and y.It remains to consider(A,B,C)=(1,−1,t). In this case (7) becomes(9)f=f′+a(x4−3x3y+3x2y2−xy3)+b(yx3−3x2y2+3xy3−y4)+p(a,b,c)for a polynomialp∈P3that depends ona,band c. Sincef,f′∈Pˆ, from Remark 3 we know thatx2y2∉Pˆ, then we deduce thatb=a, leading tof=f′+a(x4−2x3y)−a(y4−2xy3)+p(a,c).Thus, it follows from (8) and (9) thatdim⁡S2(GΩ,Pˆ)=14.  □We now come to the characterization of contact of polynomial pieces.Lemma 6Contact Characterization Lemma (CCL)Consider two special polynomialsf|△∈V△andf′|△′∈V△′on two disjoint triangles△,△′, and assume that the two triangles share an edgee=△¯∩△¯′. The two polynomialsf|△andf′|△′have a contact of order 2 if and only if(10)∀β∈B:β|e≠0|e⇒λ△β(f|△)=λ△′β(f′|△′).Firstly, we observe thatf|△∼f′|△′is equivalent toF=(f|△,f|△′)∈S2(GΩ,Pˆ),whereΩ=△∪△′‾. Secondly, noting that there are 14 box splines inBΩ(see Fig. 4) and in view of Lemma 5, we conclude thatBΩis a basis forS2(GΩ,Pˆ). Consequently,F∈S2(GΩ,Pˆ)if and only if there exist unique coefficientscβ∈Rsuch that(11)F=∑β∈B△∪△′cββ.Thirdly, we consider the restrictions of F to the two triangles,F|△=∑β∈B△λ△β(f)β,F|△′=∑β∈B△′λ△′β(f′)β.Due to the local linear independence of the box splines, the existence of the representation (11) is equivalent toλ△β(f)=cβ=λ△β(f′)forβ∈B△∩B△′.This completes the proof sinceB△∩B△′coincides with the set of box splines that do not vanish on the common edge e.  □Remark 7CCL cannot be generalized to two triangles with vertex–vertex contact. In fact, the dimension of the corresponding spline space, which is 18, is then always larger than the number of box splines (either 16 or 17, depending on the type vertex–vertex contact).We now turn our attention to a domain consisting of a collection of cells and we establish conditions for obtaining a basis of the special quartics on the domain.In the three-directional grid G, we will consider a finite set of cells (triangles)M⊂G. Any such set M corresponds to a bounded domainM, which is the closure of the union of its cells.More precisely, we define the union operator U, which maps any element Q of the power set ofR2to a subset ofR2,(12)U(Q)=⋃c∈Qc‾We can now formally defineMas(13)M=U(M).If the domainMis connected, then we will say that the set M of triangles is also connected. We need a stronger version of connectivity which excludes vertex–vertex contacts of triangles.Definition 8A set M of triangles is said to be ⋆-connected if it is connected and if additionally for any two triangles △,△′in M, which have a common vertex v,△¯∩△¯′⊇{v}, there is a chain of triangles△0,△1,…,△mall in M such that△0=△,△m=△′and△¯i∩△¯i+1=eifor some edgeei∈Mthat contains the vertex v, i.e.v∈ei, fori=0,…,m−1.In particular, two triangles are ⋆-connected triangles if they possess a common edge.We require the following condition.Condition 9The set M is assumed to be a union of finitely many mutually disconnected finite sets of triangles, each of which is ⋆-connected.In particular, this condition on the set of triangles M implies that we do not allow “kissing vertices” in any connected component ofM; or in other words, M is a triangulation of a 2-manifoldMwith boundary.Example 10The domainM=U(M)in Fig. 5has only one component and it is not ⋆-connected. In Fig. 6, the set of triangles M is modified in several ways by adding and deleting triangles and the different components (when more than one) are all ⋆-connected, and hence the domains satisfy Condition 9. ◇In the remainder of the paper, every set M is assumed to satisfy Condition 9. The set of the translates of box splines that act on the triangles M will be denoted asBM={βij∈B:suppβij∩M°≠∅},whereM°denotes the interior ofM, see Fig. 7for an example. These basis functions generate a space which we denote by(14)VM=spanBM|M.In particular, when M contains just the single cell △ thenVM=V{△}=V△=Pˆ|△,as in Remark 3.For a finite set of trianglesM⊂G, we consider the space of disconnected quarticsS−1(M,P), and the space of disconnected special quarticsS−1(M,Pˆ). ForM={△}, these two spaces coincide withP|△and withPˆ|△, respectively. It is obvious thatS−1(M,Pˆ)⊂S−1(M,P)for any choice of M.Given a disconnected special quarticf=(f|△)△∈M∈S−1(M,Pˆ), we have a local representationf|△(x)=∑β∈Bλ△β(f|△)β|△(x),x∈△,in terms of the restriction of the box splines, for any△∈M. However, this representation is generally not available for general disconnected quartics.Lemma 11For a finite set of triangles M, and the corresponding disconnected spaceS−1(M,Pˆ), the spaceS2(M,Pˆ)is preciselyS2(M,Pˆ)={f∈S−1(M,Pˆ):∀△,△′∈M,f|△∼f|△′}where the relation ∼ is defined inDefinition 4.By the definition of the space ofC2splines given in (1), it is easy to deduce thatS2(M,Pˆ)⊂S−1(M,Pˆ). Letf∈S−1(M,Pˆ), thenf∈S2(M,Pˆ)if and only if f is aC2function on M, or equivalently, if and only if for all pair of cells △ and△′in M satisfy (6) in Definition 4.  □The spaceS2(M,Pˆ)will be referred to as the special spline space on M.As we shall see later, the special spline spaceS2(M,Pˆ)can be generated by box splines with support onM, but one may need to use several copies of some of these box splines, as shown in the following Example.Example 12The domain in Fig. 8consists of two ⋆-disconnected triangles. The space of disconnected special quartics consists of pairs of special polynomials, where the first and the second entry of each pair is associated with the first and the second triangle. Since the two triangles are disconnected, the special spline space is equal to the space of disconnected special quartics. Consequently, it has dimension 24 and is therefore not spanned by the 18 box splines whose support intersects this domain. ◇Definition 13For a splineβ∈BM, the coefficient graphΓβassociated to β is defined as follows:•The vertices of the graphΓβare the cells△∈Msuch that△⊆suppβ.Two vertices ofΓβare connected by an edge if the corresponding cells△,△′have a common edge andβ|△¯∩△¯′≠0|△¯∩△¯′.We will write△∈Γβto indicate that △ corresponds to a vertex ofΓβ.Example 14Let us consider the domain in Fig. 9, and the box splinesβi(i=1,2,3). The coefficient graphsΓβicorresponding to these box splines are given in Fig. 10. ◇Proposition 15An elementf∈S−1(M,Pˆ)is inS2(M,Pˆ)if and only if the coefficients satisfyλ△β(f|△)=λ△′β(f|△′), for allβ∈BM, and all pair of cells△,△′belonging to the same component ofΓβ.Supposef∈S2(M,Pˆ), and β inB. If△=△0and△′=△d+1are two cells in M corresponding to vertices in the same component ofΓβ, then there is a chain of verticesv1,…,vdinΓβcorresponding to cells△1,…,△din M, such that△iand△i+1intersect in an edge, fori=0,…,d. By Lemma 6,λ△iβ(f|△i)=λ△i+1β(f|△i+1), and since this is valid for every0≤i≤d, then the same follows for △ and△′.Conversely, from a similar argument as before, if for any pair of triangles △ and△′in M with an edge e in common we have thatλ△β(f|△)=λ△′β(f|△′)for every basis functionβ∈Bsuch thatβ|e≠0, then by Lemma 6 every linear combination of the basis functions β is inS2(M,Pˆ).  □Definition 16For everyβ∈Band every connected component Φ ofΓβwe define the functionβΦ(x)={β(x)ifx∈U(Φ),0otherwise.The set of these functions, for the different connected components of the graphΓβ, is denoted by Λ, more precisely,Λ=⋃β∈B{βΦ|Φis a connected component ofΓβ}.The set Λ, when restricted toM, forms a locally linearly independent basis forS2(M,Pˆ).The proof is analogous to that of Theorem 2.12 in Mokriš et al. (2014).Corollary 18If the intersection of the support of each β with the multi-cell domainMis ⋆-connected, then the functions inBM, when restricted toM, form a basis ofS2(M,Pˆ).If the condition is satisfied, then for eachβ∈BMthe coefficient graphΓβhas either one component or it is empty. The result thus follows from Theorem 17.  □Example 19The graphΓβ, associated to every β with non-empty intersection with the interior ofMin Fig. 7, has only one component. From the previous Corollary, it follows that the functions inBM, restricted toM, form a basis for the special spline spaceS2(M,Pˆ)on the domainM. ◇In view of the discussion in the previous section, we give the following definition.Definition 20A domainM=U(M)is said to be admissible, if the intersection of the support of any box spline withMis ⋆-connected.The following result is then obvious from Corollary 18:Corollary 21For any admissible domainM, the functions inBMwhen restricted toMform a basis ofS2(M,Pˆ).A subset of admissible domains can be characterized by the offsets of their boundaries.Definition 22We define the offset curve of a multi-cell domain M as follows: Consider any cell (triangle) inG∖M. If the boundary of this triangle shares a vertex withM, but both incident edges are not part of the boundary ofM, then the opposite edge is added to the offset curve. We say that a domainMsatisfies the offset condition if its offset is a simple closed curve or a collection of simple closed curves.Proposition 23If a domain satisfies the offset condition, then it is also admissible.ProofThe proof follows from a careful case-by-case analysis.  □Remark 24For the domain on the left in Fig. 11the box splines inBMform a basis forS2(M,Pˆ). In this situation, when the holes in the domain are “sufficiently small”, they do not split the support of any basis functionβ∈BMand the result follows by Corollary 18. Consequently, the offset condition is not necessary for admissibility. ◇We define the special spline spaces on a hierarchical grid and a hierarchical basis. We then prove the completeness of this basis under certain assumptions on the domain hierarchy.Given an integerN≥0, we consider the hierarchical gridsGℓ,ℓ=1,…,Nsuch thatGℓ+1is obtained fromGℓby one global, uniform dyadic refinement step, where the coarsest gridG1=Gis the one with verticesZ2which has been described in Section 2. More precisely, the gridGℓ+1=12Gℓis obtained by dividing all edges of triangles ofGℓinto two edges and adding three new interior edges, thus every triangle is split into four smaller ones, see Fig. 12. The index ℓ will be called the level of the grid, and the number N specifies the number thereof. Each gridGℓis a set of triangles of the same shape, and these triangles are open sets.In addition to the union operator U, see (12), which transforms a set Q of subsets ofR2into the closed subdomainU(Q)⊂R2covered by it, we define the triangulation operatorsTℓwhich restrict the grid of level ℓ to a given subsetQofR2,Tℓ(Q)={△∈Gℓ:△⊆Q}.When applied to subsets of the corresponding grids, these operators are the inverses of the union operator, i.e. for anyMℓ⊂Gℓwe haveTℓ(U(Mℓ))=Mℓ.Let Ω be a domain ofR2aligned with level N. More precisely, its boundary ∂Ω is a union of edges from the gridGN, see the top right of Fig. 13. The hierarchical grid is defined by an inversely nested sequence of subdomainsMℓ=U(Mℓ)thereof,(15)∅=M0⊆M1⊆⋯⊆MN=Ω,which correspond to subsets of the corresponding grids,Mℓ⊂Gℓ. Thus the boundary∂Mℓis a union of edges of the gridGℓof the same level. These subdomains were called rings in Giannelli and Jüttler (2013). They are multi-cell domains (with respect to the grid) of level ℓ.The difference of two successive subdomainsDℓ=Mℓ∖Mℓ−1‾and the associated subsetDℓ=Tℓ(Dℓ)of the grid of level ℓ is called the refinement domain of level ℓ, see Fig. 14. In particular we haveD1=M1andD1=M1.Finally we collect the triangulations of the refinement area and arrive at the hierarchical grid(16)H=⋃ℓ=1NDℓ,see Fig. 15. This hierarchical grid, which collects triangles from all levels, provides a representation of the domainΩ=U(H)as a hierarchical multi-cell domain. We use it to define the hierarchical special spline spaceH=S2(H,Pˆ).Equivalently, the spline functionss∈Hcan be characterized by the fact that their restrictions to the subdomains belong to the corresponding spline spaces:Lemma 25A functions:Ω→Ris an element ofHif and only ifs|Mℓ∈S2(Mℓ,Pˆ).holds for allℓ=1,…,n.The proof of this simple observation has been omitted.We consider the box splinesBℓ, which are associated with the gridsGℓ, and the spaces spanned by them. Similar to the grids, these box splines can be obtained by a dilation,Bℓ+1={β(2⋅):β∈Bℓ}from the coarsest basisB1=Bwhich has been defined in Section 2. For each subdomainMℓwe consider the box splines whose supports possess a non-empty intersection withMℓ,BMℓℓ={β∈Bℓ:suppβ∩Mℓ≠∅}.The hierarchical spline basis is defined by a selection procedure which was proposed by Kraft (1998) for tensor-product B-splines. We select box splines from all levels,Kℓ={βℓ∈BMℓℓ:suppβℓ∩Mℓ−1=∅},and collect them into the hierarchical spline basisK=⋃ℓ=1NKℓ.The linear independence of this set of functions is implied by the local linear independence of the box splines at each level, see Giannelli and Jüttler (2013), Kraft (1998).Finally we provide a sufficient condition for the completeness of the hierarchical spline basis.Theorem 26The hierarchical spline basis K spans the hierarchical spline spaceHif each subdomainMℓis admissible with respect to the grid of level ℓ.The proof follows standard arguments already presented in Giannelli and Jüttler (2013), Mokriš et al. (2014), for the case of hierarchical tensor B-spline bases. Any spline functions∈Hadmits a representations=(h1+⋯+hN)|Ω,wherehℓ∈spanBMℓℓwith the property that(17)hℓ|Mℓ=s|Mℓ−(h1+…+hℓ−1)|Mℓ,forℓ=1,…,N. This is proved by induction with respect to ℓ.For any given level ℓ, all functionshk|Mℓof lower levelsk<ℓare contained inS2(Mℓ,Pˆ), sincespanBMkk|Mℓ⊂S2(Mℓ,Pˆ).Lemma 25 impliess|Mℓ∈S2(Mℓ,Pˆ). Consequently, the right-hand side of Eq. (17) is contained inS2(Mℓ,Pˆ). Since the subdomainMℓis admissible, we conclude thathℓ∈spanBMℓℓaccording to Corollary 21. In particular, choosingℓ=Nin Eq. (17) implies the first equation.Moreover, the construction of the functionshℓensures thathℓ|Mℓ−1=0|Mℓ−1.Since the box splines possess the property of local linear independence we can conclude thathℓ∈spanKℓ. This completes the proof.  □

@&#CONCLUSIONS@&#
