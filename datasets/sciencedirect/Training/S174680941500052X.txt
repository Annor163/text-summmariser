@&#MAIN-TITLE@&#
Robust decentralised control of a hydrodynamic human circulatory system simulator

@&#HIGHLIGHTS@&#
We develop a novel decentralised feedback controller for a hydrodynamic human circulatory system simulator.We present a detailed model of the human circulatory system simulator.Nonlinear simulation and experimental results underline the performance of the proposed controller.In-vitro experiments with a blood-pump show sufficiently fast reference tracking to realise aortic and ventricle pressures.

@&#KEYPHRASES@&#
Mock circulatory loop,Hardware-in-the-loop,Ventricular assist device,Robust control,Multivariable control,

@&#ABSTRACT@&#
A novel feedback controlled hydrodynamic human circulatory system simulator, well-suited for in-vitro validation of cardiac assist devices, is presented in this paper. The cardiovascular system simulator consists of high-bandwidth actuators allowing a high precision hardware-in-the-loop hydrodynamic interface in connection with physiological circulatory models calculated in real-time. The hydrodynamically coupled process dynamics consist of several actuator loops and demand a multivariable control design approach in the face of system nonlinearities and uncertainties. Based on a detailed model employing the Lagrange formalism, a robust decentralised controller is designed. Fixed structural constraints and the minimisation of theH∞-norm necessitate the application of nonsmooth optimisation techniques. The robust decentralised norm-optimal controller is tested in extensive in-vitro experiments and shows good performance with regard to reference tracking and system coupling. In-vitro experiments include multivariable reference step tests and frequency analysis tests of the vascular impedance transfer function.

@&#INTRODUCTION@&#
Cardiac insufficiency is among the most common causes of death in industrialised countries. Approximately 10 million cases of cardiac insufficiency are estimated to exist in Europe and it is the number three cause of death for the overall German population and number two for the female German population [14]. Despite continuous advances in clinical therapy, drug medication, and biomedical technology, the treatment of cardiac insufficiency remains one of the major medical challenges. In cases of severe reduction of cardiac output, mechanical support or replacement with a donor heart might be indicated. These therapeutical measures become inevitable, if conventional drug therapy is no longer sufficient. For this application, heart circulatory mechanical assist technology has been developed and is available as ventricular assist devices (VAD) or total artificial hearts (TAH). The application of VADs or TAHs has been established for different clinical scenarios. For example in “bridge to bridge” a VAD is used to temporarily support the left and/or right heart's pumping function until a final decision for further therapy is made, where in contrast to that in “bridge to recovery” temporary support with the objective of heart recovery is provided. In “bridge to transplant” the heart is supported until a donor heart is available and “destination therapy” is applied if there is no option to obtain a donor heart [8]. Depending on the intended use, the requirements for VADs and TAHs vary. VADs typically support the left and right heart by taking blood from the atrium or the ventricle and ejecting it into the aorta or pulmonary artery. A TAH is a complete replacement of the heart and thus takes over its functionality.All mechanical circulatory support devices, whether designed for intra- or extracorporeal use, have to be validated in in-vitro and in-vivo experiments prior to the application in a human patient. This applies in particular to feedback controlled VADs or TAHs, which are highly safety critical. Therefore, in-vivo tests are usually conducted with animal models. One of the main disadvantages of such procedures, besides being time-consuming, cost-intensive and not reproducible is using an animal as a test platform. As an alternative, hydrodynamic circulatory system simulators, or mock circulatory loops (MCL), were developed to validate VADs or TAHs before application in an animal or clinical scenario. The first MCLs were designed with the requirement to dynamically simulate the human circulatory system, as if seen from the hydraulic impedance transfer function from the heart [11]. The human circulatory system is divided into different compartments, corresponding to ventricles, vascular segments or branches. In MCLs, lumped parameter vascular segments or branches are commonly implemented as hydraulic elements: electro-mechanical pinch valves (flow resistance), pressurised air chambers (vascular compliance), or back-pressure valves (heart valve) [12]. The resulting MCLs are often complicated and, although in sometimes computer-controlled, often not able to precisely simulate the dynamic pressure during ventricular contraction or orthostatic reactions [15]. A trend to include physiological models interacting with MCLs can be observed in the last years leading to hybrid MCLs [10].The principal disadvantage of common MCLs are pneumatically driven air chambers, which have several adverse effects, like leakage, nonlinearity, disturbances on adjustment, and slow parameter adaption. New designs, for example [3], therefore consider the simulation of ventricular contraction with feedback controlled high bandwidth voice coil actuators. In the described MCL, the elastance of the heart is continuously adapted using computer-controlled bellows pumps, connected to a closed hydraulic system. In contrast to that [4] present a MCL based on a fluidic operational amplifier based on a gear-pump output stage. The gear pumps are controlled in order to simulate the impedance of the corresponding active/passive components of conventional MCL. Common to all approaches is a design that is based on hydraulic components and valves to simulate the circulatory dynamics and the heart valves, respectively. However, in modern MCL approaches several aspects of circulation (semi-hybrid) or the full circulation (hybrid) are substituted by a model [10]. In case of the hybrid MCL only a hydraulic interface is needed in combination with a detailed simulation.In this contribution we present an approach based on high bandwidth stiffly coupled voice coil actuators connected to metal bellows and gear pumps. We developed a new MCL that is based on a hardware-in-the-loop (HIL) design idea [6]. The pressure compartments of the MCL are connected to a numerical real-time simulation and have to rely on fast and robust feedback pressure control. Since the actuators and sensors of a compartment represent a multivariable coupled system, we design a robust decentralised controller and an implementation approach with regard to nonlinearities like actuator windup.This paper is organised as follows. Section 2 describes the design of the HIL-MCL for which the dynamic plant model is derived in Section 3. The controller design is presented in Section 4 and the results of an experimental study are given in Section 5. Finally, this paper ends with a conclusion and a discussion.The basic concept of the hydrodynamic circulatory system simulator is a strict separation between dynamic models of the heart or the vascular system and the compartments of the MCL. Heart and vascular system are assigned left and right pressure compartments in the MCL, respectively. An overview of the MCL coupled to the physiological system simulation is given in Fig. 1. The MCL compartments serve as hydraulic interface with the intention of simulating the physiological compartment to which the VAD or the TAH is coupled to. Examples for these compartments can be the left ventricle and the ascending aortic arch. In Fig. 1, the typical setup of two pressure chambers is shown, which is actuated by three gear pumps and two voice coil actuators/metal bellows pumps. A simulation is run in real-time that serves as a reference trajectory generator for compartmental pressures. Nonlinear effects on the compartmental pressure, for example the ventricular contraction, can be successfully calculated in the system simulation. A detailed and fast adaption of VAD's pre- and afterload can be achieved via real-time computer simulation driving the high bandwidth actuators with a feedback control-loop. Cardiac assist device tests with HIL-support can be given to right or left heart VAD or TAH which can be autonomously operated using their driving console. The operation of the VAD or TAH is measured in terms of flow through the VAD “V˙VAD” and fed back to the simulation).Fig. 2(a) shows the integrated MCL with two pressure compartments. Each compartment is extended with a gear pump and a combination of a voice coil actuator (VCA) and a metal bellows pump, attached to the corresponding compartment. The compartments are made out of acrylic glass, containing ports for the VCA and the bellows pump. Both chambers in Fig. 2(a) represent independent modules. In addition to the two gear pumps, a third gear pump is placed between the two pressure compartments and in parallel to the VAD. The reason for the application of this gear pump is twofold: On the one hand, hydraulical valves are avoided because of a guaranteed continuously positive flow from module 1 to module 2. On the other hand, the flow through all three pumps can be adjusted around a stationary setpoint, such that the high bandwidth of the VCA is fully used for compartmental pressure control and only small corrections in disturbance rejection have to be made by the gear pumps. Our design has the inherent advantage of a combination of high bandwidth pressure chamber actuation, while at the same time artifact, reflection and water hammer effects are minimised since no hydraulic valves are used. We emphasise that the decoupling of the two pressurised compartments by the application of a central gear pump does not compromise the realisation of physiological pre- or afterload, but it is a purely technical approach. By assuming a homogenous pressure profile in a compartment we propose, in a similar way to the previous assumption, that the flowsV˙GP1,V˙GP2, andV˙GP1,2are not associated with a physiological representation. The real time capability of the simulation software, the high bandwidth actuators and the high performance pressure control of each component are crucial to realise adequate hydraulic admittances or impedances.The system is modelled using an approach based on the Lagrange formalism applied to electromechanical systems [7]. Consider the set of generalised coordinates(1)qT=q1q2…qi…qMfor the M degrees-of-freedom system. Defining τias the number i of generalised external forces (W external work), the Euler–Lagrange equations follow as(2)ddt∂L∂q˙i−∂L∂qi=τi=∂W∂qi.The Lagrange function L is a scalar function and is defined as the difference of kineticT(qi,q˙i)and potential V(qi) energy(3)L=T(qi,q˙i)−V(qi).In the following model derivation the original physical variables are used instead of the generalised coordinates qi. This is done to avoid confusion between the electrical charge q and the generalised coordinates qi. A table including model parameters is provided in Appendix B.The overall model is shown in a simplified electrical analogue in Fig. 2(b). The principle mode of operation becomes clear, when comparing Fig. 2 to Fig. 1. The MCL fluid is taken from the base tank by the gear pump VGP1 to MCL pressure compartment 1. The fluid supply tube is modelled as a hydraulic resistance of the tubing Rhydr, fluid inertance Lhydr, compliance of the tubing Ct, and a static pressure psdue to the difference in height from the base tank to the MCL. The gear pumps and the voice coil actuators are modelled as current sources generating a flowV˙GPi, i=[1, 2] andV˙GP1,2, where the dynamics of both elements are shown in Fig. 3. All element flows are combined in the hydraulic pressure chamber. Outflows from the pressure chamber consist of the flow through the gear pump 1, 2 and the flow through the VAD. The pressures in the chambers VPC,1,2 are mechanically coupled through the metal bellows pump (in addition to the hydrodynamic coupling).For each pressure chamber, as the central element of the MCL, the potential energy is defined as Taylor approximation for small pressure changes dpPC. Depending on the generalised coordinate pPC, the pressure of the compartment, we write(4)Epot=−12VPCcPCpPC2,where cPCis the bulk modulus of the MCL fluid including the compressibility of the pressure chamber by remaining air inclusion after MCL evacuation and VPCis the volume of the pressure chamber (note thatCPC=VPCcPCdenotes the respective compliance shown in Fig. 2(b)). The derivation of the potential energy of the pressure compartment is given in Appendix A.The sum of external work acting on the system is given by(5)∂W=AbeldxVCApPC+dVGP1pPC−dVGP12pPC−dVDUTpPCwith infinitesimal volume of the gear pump dVGP1, dVGP12, the bellows pump surface Abeland the infinitesimal volume of the device under test (DUT) dVDUT. Rearranging Eqs. (4) and (5) using the Euler–Lagrange Eq. (2) and the subsequent derivative with respect to time leads to(6)dpPCdt=cPCVPC,0(AbelvVCA+V˙GP1−V˙GP12−V˙DUT)in whichvVCAis the speed of the VCA element.The gear pumps and the tubing resistance modelling is shown in Fig. 3(a). The gear pumps consist of a direct-current (DC) motor connected to the tubing system by the rotating shaft and the gearing. Generalised coordinates for the system are given by qGP(the charge in the electric motor circuit), the motor revolution rateφ˙, and the flow through the pumpV˙GP. The kinetic energy of the gear pump subsystem is given by(7)Ekin=12JGPφ˙2+12LGPq˙GP2where JGPis the motor inertia and LGPis the motor inductance. The external work acting on the electrical, mechanical, and hydraulical systems are given by(8)∂W=∂WGP,el+∂WGP,mech+∂WGP,hydrwith(9)∂WGP,el=UGP∂qGP−RGPq˙GP∂qGP−KGP,emfφ˙∂qGP∂WGP,mech=KGP,τq˙GP∂φ˙−τR(φ˙)∂φ˙∂WGP,hydr=−2(rFN)∂φ˙.For the external work acting on the electrical subsystem, UGPis the DC-motor supply voltage, RGPis the resistance of the motor winding and KGP,emfis the back-electromotive force voltage constant. In the mechanical subsystem, the torque constant is KGP,τ=KGP,emfand the gear pump friction isτR(φ˙). The external moment acting on the gear pump drive shaft MGP,L=2(rFN) is due to hydraulic-mechanical coupling and is rearranged by introducing the radii riand rofor inner and outer length of the pump gears and the normal force FNacting on a gear and the corresponding radius r, respectively. Denoting Δp the pressure difference over the gear pump, it follows(10)MGP,L=2(rFN)=2lΔp∫rirordr=l(ro2−ri2)Δp,where l is the width of a single gear. The equations that describe all three gear pumps are exemplarily given for pump ZP1(11)LGPq¨GP=−RGPq˙GP−KGP,emfφ˙+UGPJGPφ¨=KGP,τq˙GP−τR(t)−l(ro2−ri2)Δp.The friction was assumed to be nonlinear, consisting of dry and viscous friction(12)τR(t)=τR0sgn(φ˙)+τR1φ˙.The generalised coordinates for the VCA and bellows pump system consist of the coordinate of the bellows pump xVCAand the electric charge of the VCA qVCA. The system to be modelled consists of an electrical (VCA) and a mechanical (bellows pump) subsystem coupled to the pressure compartment byvVCA=x˙VCAin Eq. (6). An electromechanical equivalent diagram of the system is shown in Fig. 3(b). The potential energy of the bellows pump consists of energy stored in the mass mbeland the elasticity cbel(13)Epot=12cbelxVCA2+mbelgxVCA.The kinetic energy is defined as(14)Ekin=12mbelx˙VCA2+12LVCAq˙VCA2,where LVCAis the inductance of the VCA. The external work can be stated for the VCA - bellows pump system in terms of the electrical system(15)∂WVCA=UVCA∂qVCA−RVCAq˙VCA∂qVCA−KVCA,emfx˙VCA∂qVCA,with UVCAthe VCA supply voltage, KVCA,emfthe back EMF-constant, and RVCAthe ohmic VCA resistance, and in terms of the mechanical system, coupled to the hydraulic pressure compartment by pPCABel(16)∂WBel=KVCA,Fq˙VCA∂xVCA−dBelx˙VCA∂xVCA−pPCABel∂xVCA,where KVCA,F=KVCA,emfis the force-current constant and dBelis the damping of the bellows pump. For the VCA and bellow pump the differential equations follow as(17)LVCAq¨VCA=−KVCA,emfx˙VCA−RVCAq˙VCA+UVCAmbelx¨VCA=−dbelx˙VCA−cbelxVCA+KVCA,Fq˙VCA−AbelpPC−mbelg.The tube dynamics consider the tubing system from the base water tank to the gear pump GP1 or GP2. Equations are exemplarily derived for the gear pump 1. The kinetic energy in the system is given by(18)Ekin=12LhydrV˙hydr12.with Lhydr, the inertance of the tubing system. The potential energy consists of the tube distension only, as the static pressure psis assumed to be constant and therefore acts as an external force on the system(19)Epot=12Ctp˙c2,where Ctis the compliance of the tubing and pcis the pressure in the tubing compartment. The infinitesimal work of the tubing system consists of the hydraulic terms(20)∂Wtub=ρgh∂Vhydr1−RhydrV˙hydr1∂Vhydr1,in which g is the gravitational acceleration, h is the height of the tubing, Rhydris the hydraulic resistance and ρ is the density of the blood substitute. After inserting Eqs. (18)–(20) into Eq. (2) and rearranging, we obtain the following Eqs.(21)Ctdpcdt=V˙hydr1−V˙GPLhydrdVhydr1dt=−pc−RhydrV˙hydr1+ρgh,and the volume flow of the gear pump is given by the product of sucking volume times rotary speedV˙GP=VGP,SVω. Combining Eq. (6) to Eq. (17), the following nonlinear state-space model (22) is derived introducingω=φ˙as the motor revolutionary speed,i=q˙as the electrical current andvVCA=x˙VCAas the bellow pump speed in which the system inputs vector consists of uT=[UVCAUGP], known (measured) disturbances on the system arewT=[V˙GP12V˙DUT]and measured system outputs areyT=[pPCxVCAvVCAV˙GP].(22)ddtφωiGPiVCAxVCAvVCApPCpcV˙hydr1=x=ω−τR(ω)JGP+KGP,τJGPiGP−l(ra2−ri2)JGP(pPC−pc)−KGP,emfLGPω−RGPLGPiGP−RVCALVCAiVCA−KVCA,emfLVCAvVCAvVCAKVCA,FmbeliVCA−cbelmbelxVCA−dbelmbelvVCA−AbelmbelpPC−gcPCAbelVPC,0vVCA+cPCVGP,SVVPC,0ω−cPCRbfVPC,0(pPC−pc)1CtV˙hydr1−VGP,SVCtω+1RbfCt(pPC−pc)−1Lhydrpc−RhydrLhydrV˙hydr1+1Lhydrρgh,+000001LGP1LVCA00000000000UVCAUGP+000000000000−cPCVPC,0−cPCVPC,00000V˙GP12V˙DUTpPCxVCAvVCAV˙GP=y=pPCxVCAvVCAVGP,SVω−1Rbf(pPC−pc),In (22), Rbfis a hydraulical resistance introduced to model the backflow through the gear pump. The model of (22) was trimmed and linearised around an equilibrium point with small deviations (where the disturbance vector w=0, which linearly enters the system)(23)Δu=u−ueqΔx=x−xeqΔy=y−yeqto yield the following state-space model (neglecting terms of order higher than one in the Taylor approximation)(24)dΔxdt=AΔx+BΔu+EwΔy=CΔx,in which A, B, C are the equilibrium point linearised state-space matrices and E is the disturbance input matrix. Note that for the linearisation of (22) the zero velocity equilibrium point perturbed about a small numerical offset, thus leading to a neglection of the discontinuous friction term in the derivative. Appendix Table B2 lists input, output, disturbance and state variables.Following an input-output pairing analysis for decentralised control and subsequent scaling of the linearised system, the controller was designed for robust performance using weighting transfer functions for multiplicative input uncertainty and controller performance.Consider the linearised system Eq. (24) with disturbance input w=0 and reduced output vectoryr=[pPCV˙out]T. The dynamic relative gain array (RGA) for a non-singular square transfer function matrix G(s)=C(sI−A)−1B is defined as [13](25)RGA(G(s))=Λ(G(s))=G(s)×(G−1(s))T,with A, B, C the state-space matrices (24) resulting from system linearisation and reduced output and × denoting the Hadamard or Schur product. Fig. 4shows the magnitude of the RGA elements for the nominal system. Steady-state values (s=0, not shown in Fig. 4) |λ11|=|λ22|=1.43 and |λ12|=|λ21|=2.43 indicate a diagonal pairing, which is confirmed by looking at intermediate frequencies of 1–10Hz. Since Fig. 4 shows only the magnitude, the RGA number is used as an additional measure for available pairing.The RGA number is defined as(26)RGAn=Λ(G(s))−Is∑,where.∑is the sum norm and Isis a matrix that corresponds to a given pairing, for example the identity matrix I for a diagonal pairing. The RGA number of a diagonal pairing is close to zero for intermediate frequencies, where in case of an off-diagonal pairing the RGA number is 4. These results underline a diagonal pairing for decentralised control and the controllers C1(s):uVCA(s)↦ppc(s) andC2(s):uGP(s)↦V˙out(s).In a first step, we reduce multivariable loop-coupling by an output disturbance rejection applied to the pump flow. The new output equation for the pump flow results in(27)V˙out,d=V˙out−Abelv˜VCA−dcorx˜VCA,in whichV˙outis measured pump flow of GP1 and additional terms applied to the controller are measured voice coil positionx˜VCAand velocityv˜VCA. Thus,Abelv˜VCAcorresponds to a flow dependent on VCA control action and dcoris a gain to keep the VCA at zero position by adjusting the pump flow. The parameter was chosen by a trade-off between high gain and large amplification of sensor noise, to correct the VCA position and to minimise sensor noise effects, respectively. We admit that the pump flow reference value cannot be accurately tracked, using Eq. (27) in the controller. However, accurate tracking of the pump flow is not necessary, since compartmental in- and outflow of the centrifugal pumps do not contribute to the heart admittance or the vascular impedance. The new output value is nevertheless used in the design of the controller in order to address stability and performance for changed feedback variable. The newC˜dmatrix is rearranged according to the system output(28)y˜1=pPCVGP,SVω−1Rbf(pPC−pc)−Abelv˜VCA−dcorx˜VCA,to result in the nominal systemG˜(s)=C˜1(sI−A)−1B. In a second step, and for subsequent decentralised control design, the process is scaled at the output(29)Gˆ(s)=DOG˜(s).DOis diagonal scaling matrix defined by the maximum range of each of the output variablesDO=diag(1/pPC,max,1/V˙out,d,max).Uncertainty of the plant is suggested to belong to one of the following classes: parameter uncertainty or unmodelled dynamics at high frequencies. Sensor and actuator uncertainty are negligibly small compared to system uncertainties in for example the tubing, pressure compartment or metal bellow pump. Uncertainties of the hydrodynamic system simulator are mainly due to remaining air bubbles in tubing and bellow pump (if not properly ventilated), changes in the bulk modulus of the blood substitute, and the friction of the metal bellow pump. The system uncertainty is modelled as a lumped unstructured multiplicative input uncertainty for the corresponding family of plants(30)Gp(s)=Gˆ(s)(I+WI(s)Δ(s)),using the complex bound WI(s), the nominal modelGˆ(s)and withΔ(s) satisfying(31)Δ(s)∞≤1.An upper bound is thus chosen to satisfy(32)lI(ω)=supGp(jω)∈ΠGˆ−1(jω)(Gp(jω)−Gˆ(jω))∞,∀ωwith Π denoting the set of possible, perturbed plant models. In order to determine a valid upper bound, model parameters τr(ω), Rhydand cPCare specified as uncertain (real) parameters Eq. (Appendix A). Subsequently, in a numerical loop procedure random models Gp(jω) are generated and lI(ω) is calculated over a number of frequency points using (32). A complex boundwI(s)is then calculated using least-squares frequency fitting for a third order transfer function, leading to a stable complex bound|wI(s)|>lI(ω). Fig. 5shows the singular values for a number of randomly generated plants and the multiplicative scalar bound, which leads toWI(s)=diag(wI(s),wI(s)), with the assumption of diagonal input channel uncertainty.The performance weighting function for the decentralised controller Wp(s)=diag(wp1(s), wp2(s)) was designed as a diagonal transfer function matrix penalising the sensitivity transfer function. Each control channel performance weighting was determined from DC-gain kc1, kc2, cross-over frequency cr1, cr2 and high-frequency gain hc1, hc2, see Appendix B, of the form(33)wp1(s)=hc1zp1s+1pp1s+1,wp2(s)=hc2zp2s+1pp2s+1,where the transfer function pole and zero was determined from(34)zpj=kcj2crj2(1−hcj2)hcj2(kcj2−1),ppj=crj2(1−hcj2)kcj2−1,with j=1, 2 according to Eq. (33).The generalised plant is obtained from the given loop interconnection structure detailed in Fig. 6(a). The transfer function matrix results in(35)P(s)=00WI(s)Gˆ(s)−Wp(s)Wp(s)−Wp(s)Gˆ(s)−II−Gˆ(s),which is partitioned and rearranged, to result in the linear-time invariant minimal realisation state-space model(36)ddtx=Ax+BδwΔ+B1w+B2uzΔ=Cδx+DδδwΔ+Dδ1w+Dδ2uz=C1x+D1δwΔ+D11w+D12uy=C2x+D2δwΔ+D21w+D22u,for which Dδδ=D1δ=D2δ=Dδ1=D12=D22=0, since dimensions for the signal pairings(wΔ,zΔ)∈ℝN×ℝN,(w,z)∈ℝm1×ℝm1and(u,y)∈ℝm2×ℝp2for uncertainty, performance and control-measurement channel, respectively, are given by N=m1=m2=p2=2. Considering the general control configuration, illustrated in Fig. 6(b), a structural restriction for the uncertainty exists in terms of the diagonal control input channel uncertainty(37)Δ:=Δ=diag(δ1,δ2):δ1,δ2∈ℂ.Given a well-posed interconnection structure and Fig. 6, definingΔp:={Δ=Δp∈ℂm1×m1}and assuming internal stability of the unperturbed control-loop robust performance [16](38)Fu(Fl(P(s),C(s)),Δ)∞,<1,∀Δ∞<1,if and only if(39)μΔ(Fl(P(s),C(s)))<1,∀s=jω,ω∈ℝ∪∞,in which Δ is the uncertainty, corresponding to plant perturbantions Δ and performance Δp, Δ=diag(Δ, Δp).A decentralised controller C(s)=diag(C1(s), C2(s)) of fixed order three is designed using μ-synthesis with fixed order dynamic D-scalings. Towards this goal, the uncertainty configuration is rearranged to include the D-scalings into the controller [1]. The closed-loop D-scaled transfer function is rearranged, computing(40)DΔFl(P(s),C(s))DΔ−1=FlPc(s),C(s)000D˜Δ(s)000D˜Δ(s),withD˜Δ=DΔ−INandD˜ΔΔ=ΔD˜Δwhenever DΔ is a commuting matrix. An additional constraint is added for the closed-loop system matrix A(G(s), C(s)), which is nominal stability, incorporated by the spectral abscissaαA(G(s),C(s))and a positive scalar ϵ. The following nonsmooth program leads to theH∞-optimal structured controller(41)minK(s)sups=jω,ω∈ℝ+σ¯Fl(Pc(s),K(s))subjecttoαA(G(s),C(s))≤−ϵK(s):=K(s)000D˜(s)000D˜(s),D˜(s)∈D˜Δ,for which nonsmooth techniques were developed by [2] and a numerical routine is available from the Matlab – Robust Control Toolbox, [9]. The controller designed by using complex diagonal scalings of 5th-order and a full perturbation matrix for the performance weighting Δp, resulted in a structured singular value of μΔ=2.83. The decentralised controllers are obtained as minimal state-space realisationsand, where parameters are given in Eqs. (B.1) and (B.2) the appendix.Decentralised controllers designed in Section 4 were first tested in a nonlinear process model in Matlab/Simulink with a stiff solver of variable step size (ode15s). The model is initialised at a main flow to the pressure compartment ofV˙out=V˙GP1=V˙GP12=8l/min andV˙DUT=0l/min, resulting in an equilibrium condition for the pressure compartment and a resulting flowV˙out,d≈8l/min. In this case, the GP1 flowV˙outis equal toV˙out,d. At the same time, the pressure reference value of ppc,ref=120mmHg is set up by the VCA1 control-loop according to an instantaneous pressure in for example the systolic aortic arch. Two steps are applied to the reference values. At t=4s, a step of −40mmHg is applied to the compartment pressure corresponding for example to the drop in arterial pressure during diastole, shown in Fig. 7. The VCA1-controller response is sufficiently fast, where pressure gradients dpPC/dt of 2000mmHg/s and above can be easily realised without saturating the VCA1. The effects of multivariable coupling are reduced by continuously adjusting the inflow pump according to Eq. (28), and temporarily reducing the flow through the gear pump in order in order to keep the VCA1 at zero position. At t=6s, a reference step of 2l/min is applied to the flow control-loop of the inflow gear-pump (GP1). After an initial transient phase, the flow rateV˙out,dconverges at 8l/min, which is also the current outflow value and can again be explained by the corrective action of the term−dcorx˜VCAin Eq. (28). Thus, process coupling is kept minimal by the control strategy, forcing the VCA1 back to a middle position (which is needed to avoid actuator saturation in the multivariable loop).It should be noted here that a reference step on the flow of GP1, without changing the flow of GP12, is an unusual case and typically does not occur in system simulator operation. The step on the flow reference is shown here to demonstrate the effectiveness of the corrective action terms of Eq. (28). Without the corrective action, the pressure control of VCA1 would not be able to tightly control the chamber pressure pPC1, since the actuation range of VCA1 is limited. This control strategy will be used in a subsequent stage of the multivariable control of multiple compartments, in order to preset pump rates towards a desired absolute pressure in each chamber. For experimental validation, the decentralised controllers were discretised at a sampling time of Ts=0.001s using zero-order-hold and implemented on the dSPACE box (DS 1103, dSPACE GmbH, Paderborn, Germany). The hydrodynamic circulatory system simulator was filled with a monoethylene glycol/aqua mixture (Glysofor N, Wittig Umweltchemie GmbH, Grafschaft-Ringen, Germany), to emulate the rheologic properties of human blood. Pressure (xtrans, CODAN pvb Critical Care GmbH, Forstinning, Germany) and flow (H11XL, Transonic Systems Inc., Ithaca, USA) sensors were attached to the loop, as indicated in Fig. 1. Similar to the multivariable loop simulations, reference steps were applied to each control channel in a steady-state operating point, typical for pressures that occur in the aortic arch.However, to avoid damage to the VCA1 bellow pump, the step on the flow reference is not only applied to GP1 but also to GP12. Transient responses following the steps on the flow references are therefore different to simulations. Fig. 8shows the step responses of the multivariable system. It can be easily seen that the output signals for the flow is disturbed by noise, where the large noise on the flow sensor is due to the use of an ultrasonic measurement technique (no low-pass filter). However, the mock-loop actuator signals, given in the lower part of Fig. 8, are relatively insensitive to sensor noise. This is due to sufficient roll-off at higher frequencies of the controllers. The VCA controller response is sufficiently fast, with approximately 10% overshoot. Multiple experiments were conducted in different operating points underlining the good robustness and multivariable coupling suppression of the controller. We would furthermore like to emphasise that during hydrodynamic system simulator operation a tight control of flow through the gear pumps is not desired. Besides a stable control of pump flow, the goal of the flow control is to keep up a flow through the pressure compartments and to minimise pressure-flow coupling.Finally, frequency response measurements of the controller were conducted in HIL-mode. Here the pressure reference value for the VCA1-controller is calculated by a model of the vascular system. To close the HIL-loop, a medical blood-pump (DeltaStream DP1, Medos AG, Stolberg, Germany), was connected to the pressure compartment and acts as an additional flow source at the aortic arch. The DeltaStream is a blood-pump typically used in extracorporeal support systems. The measured flow is fed to the HIL-model thus changing the pressure reference in the compartment according to the modelled vascular system. Fig. 9shows the frequency responses that were calculated from chirp tests applied to the DeltaStream flow controller and power spectral density computation. A good agreement between vascular impedance of the model and experimentally controlled hydraulical impedance (as seen from the blood-pump) can be observed until frequencies of about 2Hz. For higher frequencies, the flow controller of the DeltaStream which was designed in another project for stationary flow control is not able to sufficiently control the flow and thus the low signal to noise ratio of the flow, measured by an ultrasonic sensor, worsens the frequency measurements, resulting in a coherence function below 10%.To show the performance in the HIL feedback configuration, experiments were conducted with a cardiovascular model [5] connected to the new hydrodynamic human circulatory system simulator. Fig. 10shows exemplary trajectories of the Mock loop with pressures p1 (after-load) and p2 and their respective references. At a time of 5s, a reference step is applied to the rotational speed of the DUT (DeltaStream DP1, Medos AG, Stolberg, Germany), employed as a left VAD (LVAD). New pressure reference trajectories are then calculated according to the measured flow through the DUT in the aorta. The result is a slowly increasing end-diastolic pressure over time, computed by the in-silico cardiovascular model in real-time. The disproportionally higher end-diastolic pressure results from the additional amount of blood pumped into the aorta while the aortic valve is closed. This result is concordant to theory and clinical practice.We conclude that the developed robust decentralised controller is well able to provide sufficiently fast reference tracking of HIL-variables, at the same time minimising multivariable coupling effects. For this, the proposed multivariable control strategy uses an output decoupling of the gear pump as a function of voice coil position leading to changes in the reference values of the pump. Since the absolute value of gear pump compartmental inflow is not of importance, the ouput decoupling is well applicable for control of the hydrodynamic system simulator. The output decoupling was modelled in the controlled plant enabling the design of the decentralised controllers with regard to robust performance. Controller implementation in a detailed nonlinear simulation and in the experimental hydrovascular system simulator underline the achieved control performance. Furthermore, experimental frequency response tests with an external blood pump were conducted. The blood-pump acts as a flow-source (flow-controlled), generating a sinusoidal flow signal of varying frequency over time acting on the pressure compartment. By analysing frequency response data, it could be shown that the feedback controlled system simulator is able to emulate a vascular impedance as given by the HIL-model. Due to limitations of the blood-pump self-designed flow controller of the DeltaStream, the frequency response estimation is only valid up to 2 Hz of bandwidth. Further investigations will be conducted, involving a flow source with a higher bandwidth. Additionally, the control strategy developed for only the vascular compartment will be extended to control heart and vascular compartment. Here, first promising results show that it is possible to reproduce the transition of left ventricle to aorta of 30beats/min up to a fibrillating heart. This and the design and validation of heart-assist device control algorithms will be the subject of future work.We consider a single pressure chamber which is closed on all sides, except the bellow pumps driven by the voice coil actuator. Let ABelbe the area of the bellow pump and pPCbe the pressure of the compartmental fluid. Assuming frictionless fluid compression, the work accomplished in compressing the fluid with remaining air bubbles is(A.1)Epot(pPC)=Abel∫xVCA,0xVCA(p)pPCdxVCA,with xVCA,0 and xVCA(p) are the positions at neutral and pressure chamber pressure, respectively. From the continuity equation follows(A.2)ρ(pPC)VPC(pPC)=ρ0VPC,0,in which ρ(pPC) is the density and VPC(pPC) is the volume at compartmental pressure. Compartmental fluid density depends on pressure and can be modelled as(A.3)ρ(pPC)=ρ01+pPCcPC.Substitution of the densityρ=mPCAbelxVCAin Eq. (A.3) leads to the following equivalent equations(A.4)pPC=cPCxVCA,0−xVCAxVCA;xVCA=xVCA,01+pPC/cPC.Further substitution of Eq. (A.4) into Eq. (A.1) leads to(A.5)Epot(pPC)=cPCAbel∫xVCA,0xVCA,01+pPC/cPCxVCA,0−xVCAxVCAdxVCA,for which the solution is given by(A.6)Epot(pPC)=cPCVPCpPC/cPC1+pPC/cPC−ln(1+pPC/cPC).A Taylor series approximation, neglecting terms of higher than order one, leads to the expression of the potential energy used for the Lagrangian(A.7)Epot=12VPCcPCpPC2.Parameters for the decentralised continuous-time controllersC1(s),C2(s)∈ℂare given in packed matrix form(B.1)and(B.2)See Tables B1–B3

@&#CONCLUSIONS@&#
