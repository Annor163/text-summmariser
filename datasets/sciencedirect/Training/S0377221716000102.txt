@&#MAIN-TITLE@&#
Large-network travel time distribution estimation for ambulances

@&#HIGHLIGHTS@&#
We use a Bayesian method to estimate the distribution of ambulance travel times between any two locations in a city.Our method is parsimonious and computationally tractable for large datasets.Ambulance travel times do not vary substantially throughout the day, in contrast to standard vehicles.Our travel time estimates outperform a recently-published method and a commercial software package.Our method leads to different ambulance management decisions, compared to the recently-published method.

@&#KEYPHRASES@&#
Transportation,Traffic,OR in health services,Travel time estimation,Markov chain Monte Carlo,

@&#ABSTRACT@&#
We propose a regression approach for estimating the distribution of ambulance travel times between any two locations in a road network. Our method uses ambulance location data that can be sparse in both time and network coverage, such as Global Positioning System data. Estimates depend on the path traveled and on explanatory variables such as the time of day and day of week. By modeling at the trip level, we account for dependence between travel times on individual road segments. Our method is parsimonious and computationally tractable for large road networks. We apply our method to estimate ambulance travel time distributions in Toronto, providing improved estimates compared to a recently published method and a commercial software package. We also demonstrate our method’s impact on ambulance fleet management decisions, showing substantial differences between our method and the recently published method in the predicted probability that an ambulance arrives within a time threshold.

@&#INTRODUCTION@&#
Estimates of ambulance travel times on arbitrary routes in a road network are used in ambulance dispatch decisions, base location algorithms, and real-time redeployment methods (Brotcorne, Laporte, & Semet, 2003; Dean, 2008; Goldberg, 2004; Maxwell, Restrepo, Henderson, & Topaloglu, 2010; Schmid, 2012). In many of these applications it is important to capture the uncertainty in the travel time, by predicting the entire travel time distribution rather than just the expected travel time (Ingolfsson, Budge, & Erkut, 2008; Zhen, Wang, Hu, & Chang, 2014). For instance, taking into account uncertainty in the travel time of ambulances to the scene of an emergency can substantially increase the survival rate of cardiac patients, by improving fleet management decisions and thus reducing response times (Erkut, Ingolfsson, & Erdoğan, 2008; McLay, 2010). Also, ambulance fleet performance is measured by the fraction of emergency calls for which the response time is less than a specified threshold, and forecasting this performance measure requires travel time distribution information (Mason, 2005). Travel time distributions are also used in applications for other vehicle fleets, including calculation of driving directions for private vehicles using taxi data (Yuan et al., 2010), allocation of railcars (Topaloglu, 2006), and routing and scheduling of courier vehicles (Potvin, Xu, & Benyahia, 2006).We propose a regression approach for estimating the distribution of an ambulance travel time on an arbitrary route in a road network. The prediction depends on the route and on explanatory variables such as the time of day and day of week. Our method uses information from historical trips on the network, specifically the total travel time and estimated route for each trip. In order to predict the travel time distribution for a particular route, we do not require historical trips that take precisely the same route. Instead, our statistical approach uses information from all the historical trips by learning shared properties like the effects of time of day and types of road traversed. The model we use is intuitive and its parameters are interpretable. Our method is computationally efficient, scaling effectively to large road networks and large historical trip databases.Two features of ambulance travel times motivate our modeling choices. First, ambulances traveling at lights-and-sirens speeds are less affected by traffic than other vehicles (Aladdini, 2010; Kolesar, Walker, & Hausner, 1975; Westgate, Woodard, Matteson, & Henderson, 2013). Therefore, historical ambulance trips are the most relevant source of information for travel times, and real-time traffic flow information from other vehicles is less useful. Second, ambulance trips are comparatively rare, implying that ambulance data is sparse in time and road network coverage. Roads that are not major thoroughfares may have only a few ambulance trips on them per year.To estimate the route taken in the historical trips, we use Global Positioning System (GPS) measurements taken during travel. This source of data is called floating car data or automatic vehicle location data, and is increasingly available for many types of vehicles, including ambulances, taxis, and personal vehicles, via GPS-enabled smartphones or 2-way navigation devices (e.g. Garmin or TomTom) (Hofleitner, Herring, Abbeel, & Bayen, 2012a). Unlike other sources of travel time data, it does not require instrumentation on the roadway, and thus is the only source of data available to estimate travel times that has the prospect of comprehensive network coverage.Despite the rise in availability of floating car data, there are still few methods available to utilize floating car data for travel time distribution prediction. Hofleitner, Herring, and Bayen (2012b) and Hofleitner et al. (2012a) take a traffic flow perspective, modeling at the level of the network link (a road segment between two intersections). They use a dynamic Bayesian network for the unobserved traffic conditions on links and model the link travel time distributions conditional on the traffic state. Their method is applied to a subset of the San Francisco road network with roughly 800 links, predicting travel times using taxi fleet data and validating with additional data sources.In previous work, we introduced a Bayesian model for simultaneous travel time distribution and path estimation for a set of vehicle trips (Westgate et al., 2013). Like Hofleitner et al., we modeled travel times at the link level. Our method was applied to estimate ambulance travel times on a subregion of Toronto.In an early paper, Erkut, Fenske, Kabanuk, Gardiner, and Davis (2001) estimate ambulance and fire truck speeds in St. Albert, AB, Canada, as part of a study to select new locations for a fire station and ambulance base. They use three road classes (freeway, main roads, and residential roads), and also account for time-of-day and season by estimating different speeds for rush hour and non-rush hour and for summer and winter. They estimate average speeds using historical data, interviews with drivers, and road tests. They do not consider the distribution of travel times.Jenelius and Koutsopoulos (2013) propose a framework for estimating the distribution of travel times while incorporating weather, speed limit, and other explanatory factors. They point out that previous approaches such as Hofleitner et al. (2012a, 2012b); Westgate et al. (2013) assume that the link travel times are independent within a vehicle trip, perhaps conditional on the traffic state. This contrasts with empirical evidence suggesting that the link travel times are strongly correlated, even after conditioning on time of day and other explanatory factors (Bernard, Hackney, & Axhausen, 2006; Ramezani & Geroliminis, 2012). Therefore, they capture correlation using a moving average specification for the link travel times. Their framework is applied to estimate travel times for a particular route in Stockholm.In contrast to these approaches, we model travel times at the trip level instead of the link level. This naturally incorporates dependence between link travel times. The ambulance route is taken into account in the specification of the trip travel time parameters, such as the median travel time. This trip-level approach is related to the regression approach of Budge, Ingolfsson, and Zerom (2010b), who model the travel time distribution for an ambulance trip as a function of shortest-path distance between the start and end locations. They assume that the log travel time follows a t-distribution, where the centering and scale parameters are either a nonparametric or parametric function of the shortest-path distance. These functional forms enable their method to be flexible but still interpretable. Like them we take a regression approach, but we also incorporate dependence on the route taken, time of day, and other explanatory factors, justifying our modeling choices empirically. This captures the fact that locations near primary roads can be reached more quickly than other locations, for example. A downside of modeling at the trip level is that travel time predictions cannot be updated to reflect changing conditions while a vehicle is enroute. However, this is not a drawback in the ambulance setting, because travel time estimates are used for ambulance dispatch decisions and base placement, rather than for route selection.We use our method to predict ambulance travel times for the entire road network of Toronto. The size of the road network (68,272 links) is an order of magnitude larger than in previous applications of travel time distribution estimation based on floating car data (Budge et al., 2010b; Hofleitner et al., 2012a; Hofleitner et al., 2012b; Jenelius & Koutsopoulos, 2013; Westgate et al., 2013), and the number of historical vehicle trips (157,283) is also larger than these previous applications. We compare the prediction accuracy of our method to that of Budge et al. (2010b), Westgate et al. (2013), and a commercial software package for mean travel time estimation. We also consider the effect of various simplifications of our model, and investigate the accuracy of our model when the time effect on travel times is artificially inflated.Finally, we evaluate the effect of using our method for ambulance fleet management, relative to that of Budge et al. (2010b). We select a set of representative ambulance posts in Toronto, and calculate which ambulance post is estimated to be the closest in median travel time to each intersection in Toronto. Many intersections have different estimated closest posts, according to the two methods, so the two methods would recommend that a different ambulance respond to emergencies at these locations, if the closest ambulance is dispatched. Next, we calculate the probability that an ambulance is able to respond on time (within a specified time threshold) from the closest post to each intersection of the city. We find substantial differences in these probabilities between the two methods. These appear to arise because our method captures differences in speeds between different types of roads, unlike the method of Budge et al.Commercially available vehicle travel time estimates typically consist of estimated expected travel times rather than distribution estimates, so they cannot be used to calculate the probability an ambulance arrives within a time threshold, or for ambulance deployment algorithms where simulated travel times are needed. Also, these estimates are calculated for standard vehicle speeds, not lights-and-sirens ambulance speeds. However, they are still useful for point estimation performance comparisons, as long as they are corrected for bias. Specifically, we investigate travel time estimates from TomTom, a maker of navigation devices. Bias adjustment does not fully account for the differences between the TomTom context and ours, so our results should not be interpreted as an evaluation of the quality of TomToms estimates.The article is organized as follows. In Section 2, we introduce the data from Toronto and highlight the exploratory data analysis that motivates our modeling choices. In Section 3, we introduce our statistical model and estimation method. In Section 4, we give results and compare to the alternative methods. We draw conclusions in Section 5. In Appendices Appendix A–Appendix C, we give details on data preprocessing, fastest path estimation, and our implementation of the method of Budge et al.We use our method for a study of ambulance travel times in Toronto, Ontario. The goal is to estimate the distribution of time required for an ambulance to drive to the scene of a high-priority emergency, in which case the ambulance uses lights and sirens, and travels at high speed. The data are provided by Toronto EMS (Emergency Medical Services), and include all such ambulance trips in Toronto during the years 2007 and 2008. We analyzed a subset of these data from the Leaside region of Toronto in previous work (Westgate et al., 2013); here we estimate travel times on the entire Toronto road network, which consists of 68,272 links.The data associated with each trip include the approximate start and end times and locations of the trip, as well as sparse GPS location and speed readings during the trip. The GPS measurements are stored every 200 meters or 240 seconds, whichever comes first (typically the distance constraint is satisfied first for lights-and-sirens trips).Cleaning and preprocessing the data is a challenge, due to factors such as human error in recording the start and end times and locations of the trips, the presence of trips where the ambulance doubled back on itself, and the presence of GPS measurement error. These challenges and our preprocessing algorithm are described in Appendix A. After preprocessing we are left with 157,283 ambulance trips, having removed 20,443 trips. The median shortest-path distance between the start and end locations is 2530 meters.To apply our method, we first estimate the path traveled for each ambulance trip, using the GPS data. Many such “map-matching” methods could be used (Lou et al., 2009; Mason, 2005; Quddus, Ochieng, & Noland, 2007; Rahmani & Koutsopoulos, 2013); we use the one introduced in (Westgate, 2013).Here we highlight exploratory analysis of the Toronto EMS data, after trip preprocessing. Results from this analysis motivate the modeling assumptions described in Section 3.1. After preprocessing, each trip consists of a sequence of GPS readings. To assist exploratory analysis of the travel time distribution between any two locations, we map the first and last GPS readings of each trip to the nearest intersections in the network, to use as estimated start/end locations (this differs from our travel time model, in which trips are allowed to start and end in the interior of links). We collect the most common pairs of start/end intersections for the trips in the dataset; there are 10 start/end pairs with at least 40 trips between them.Fig. 1shows normal Quantile–Quantile (Q–Q) plots for the log travel times between the four most common start/end pairs in the dataset. The shortest-path distance between the start and end locations is shown above each Q–Q plot. Also shown on the Q–Q plots are 95 percent pointwise confidence bands, under the null hypothesis that the log travel times are normally distributed. Only 6 percent of the observed travel times in the four plots fall outside the pointwise confidence bands, which suggests that the lognormal assumption is reasonable (if it is correct then we expect roughly 5 percent of the observations to fall outside of the bands). Although nearly all of the points outside the confidence bands occur on a single one of these four plots, this is not surprising because the points on a Q–Q plot are strongly dependent. Similar Q–Q plots have been constructed for the next most common start/end pairs, and they also suggest lognormal travel times.The lognormal distribution has been observed in practice and also used as a model for both link and trip travel times repeatedly in the literature (Aladdini, 2010; Alanis, Ingolfsson, & Kolfal, 2013; Kaparias, Bell, & Belzner, 2008; Mazloumi, Currie, & Rose, 2009). We use the lognormal distribution because it is supported by exploratory data analysis, and also to provide a parsimonious parametric model. Due to the sparseness in data, there are typically few trips between any two locations in the road network. While Budge et al. found that ambulance travel times were heavier-tailed than the lognormal (they used log-t distributions), they did not condition on the start and end locations of the trips. For the Toronto ambulance data, if one does not condition on the start and end locations, the travel time distribution also has heavier tails than the lognormal.We also wish to investigate the variability in travel times for each start/end location pair. Fig. 2shows a scatterplot of the sample variances of the log trip travel times for the 100 most common start/end pairs, plotted against the shortest-path distance between the pair. There is a general decreasing trend in the variance, the shape of which suggests the exponential decay model described in Section 3.1. This is for the log travel times; on the original scale, the variances increase with distance. One can also construct a similar scatterplot where each point represents trips of a similar path distance, not just between specific locations. In this case, we again observe a decreasing trend, but with much less noise than in Fig. 2. This is consistent with the results seen by Budge et al., who observed decreasing coefficient of variation of travel times with increasing distance.Consider a road network with links indexed byj∈{1,…,J}and a set of vehicle trips on that network indexed byi∈{1,…,I}. Let djindicate the length of link j. Assume that each trip i begins and ends at known locations on the road network (not necessarily at intersections), and that the sequence of linksAi={Ai1,…,Aini}traversed by trip i is known. Let fijdenote the known fraction of link j used by trip i. For interior links in the path Ai, this fraction equals 1; for the first and last links, it captures the fraction of the link actually traversed during the trip.Based on the results of exploratory analysis in Section 2.1, we model the travel time Tifor trip i with a lognormal distribution, conditional on the route traveled. Specifically,(1)Ti|Ai,{fij}j∈Ai,{dj}j∈Ai∼LN(μ(i)+log(c+∑j∈Aifijdju(i,j)),σ2(i))conditionally independent across trips i, where the functional forms of μ(i), u(i, j), and σ2(i) are specified appropriately for the context. This model can be rewritten asTi=Ri(c+∑j∈Aifijdju(i,j))for a random lognormal multiplicative factorRi∼LN(μ(i),σ2(i))capturing the travel time variability and trip-level effects. The baseline travel time is given by(c+∑j∈Aifijdju(i,j)),where the term u(i, j) is a unit travel time (inverse of speed) for trip i on link j. The product fijdjis the distance traveled on link j in trip i, so the baseline travel time is a sum of individual link travel times plus an intercept c > 0. One could also include intersection and turn effects in the specification, although we have not pursued this extension.The intercept c captures, for instance, additional time required to get up to speed at the beginning of the trip and to slow down at the end. Its inclusion is similar to the model introduced by Kolesar et al. (1975) and used by Budge et al. (2010b), in which the travel times depend on the square root of the distance for small distances, and grow linearly with the distance for large distances.The unit travel time u(i, j) for link j in trip i can depend on explanatory factors like the road class, speed limit, and whether the road is one-way. Additionally, it can depend on the type of vehicle or the driver. Most simply it can be a link effect, giving the form u(i, j)≜uj. However, if there are links with very few trips, as is the case for ambulance data, this approach yields noisy estimates of the ujparameters. We specify u(i, j) to depend on the road class, taking u(i, j)≜uℓ(j) whereℓ(j)∈{1,…,L}is the road class of link j (highway, arterial road, etc.). One could also partition the road network into R geographic regions, and take u(i, j)≜uℓ(j), r( j) forr(j)∈{1,…,R},to allow downtown arterial roads to be distinguished from suburban arterial roads, for example.The parameters μ(i) and σ2(i) for the trip effect can depend on time, weather, driver, and other explanatory factors (similarly to Jenelius & Koutsopoulos, 2013). We use the time bin as an explanatory factor, setting μ(i)≜μk(i) where the week is divided into time binsk∈{0,1,…,K}and μ0≜0 to ensure model identifiability, i.e. so that each parameter of the model can be uniquely determined given sufficient data.The log scale variance σ2(i) is modeled via an exponential decay in the total trip distancedi≜∑j∈Aifijdj,as suggested by exploratory data analysis (see Section 2.1, Fig. 1). Specifically, we takeσ2(i)≜Me−λdi+δ,for parameters M > 0, λ > 0, and δ > 0. With this choice, the variance of the log travel times approaches δ as the trip distance increases, and equalsM+δfor trips of length zero. The parameter λ controls how quickly the variability decreases towards δ. The unknown parameters in the model are thereforeθ≜(c,u1,…,uL,μ1,…,μK,M,δ,λ).We use a Bayesian formulation to estimate the model parameters, which allows uncertainty in the parameter estimates to be taken into account for travel time predictions. The predictions are based on the posterior distribution of the parameters, which is proportional to the prior density (specified below) times the likelihood function. The likelihood function is equal to the product over trips i of the lognormal density of Ti(see Eq. (1)). We estimate each parameter and relevant function of the parameters by its posterior mean, and summarize our uncertainty with a 95 percent interval estimate, the endpoints of which are the 0.025 and 0.975 quantiles of the posterior distribution. Computation of the posterior distribution is done via Markov chain Tierney (1994).We have found results to be robust to moderate changes in the prior distributions for the unknown parameters(c,u1,…,uL,μ1,…,μK,M,δ,λ),due to the large volume of data. Results are reported for the following prior distributions, with mutually independent parameters:uℓ∼LN(νℓ,ξu2),μk∼N(0,ξμ2),ℓ∈{1,…,L},k∈{1,…,K}c∼Unif(0,∞),M∼Unif(0,∞),δ∼Unif(0,∞),λ∼Unif(0,∞).The constant νℓ is a prior estimate of the unit travel time on the log scale, for road class ℓ. For example, there might be initial speed estimates for each link in class ℓ, or perhaps known speed limits or recorded GPS speed data. In such cases, νℓ can be set equal to the mean of the log inverse speeds. We use GPS speed data recorded during ambulance trips to specify a common νℓ for all ℓ. The constant ξucaptures how strongly we believe our prior estimate νℓ of the log unit travel time. We take ξuto be large, allowing the information in the data to dominate the posterior estimate of uℓ. Specifically, we set ξuso that there is roughly 95 percent prior probability that uℓ is within a factor of two ofeνℓ,which corresponds toξu=(log2)/2. Similarly, ξμcaptures our prior uncertainty in the value of μk, and by the same argument we setξμ=(log2)/2. We have no prior information about c, M, and δ, so we use uniform priors. Although these uniform prior distributions are non-integrable, the posterior distribution is integrable and valid. The uniform priors are on the square root of δ and M, because the square roots of these parameters are on the scale of the standard deviation of the log travel times, and it is more appropriate to put a uniform prior on a standard deviation than on a variance (Gelman, 2006).To estimate the posterior distribution for each parameter, we use a Metropolis-within-Gibbs Markov chain Monte Carlo method (Tierney, 1994). Specifically, we use Metropolis–Hastings (M–H) to update each of the unknown parameters in turn, conditional on the current values of the other unknown parameters. For example, to update the parameter uℓ, we propose a new valueuℓ*∼LN(log(uℓ),ψ2). The proposed sample is accepted with the appropriate M–H acceptance probability, which is the minimum of 1 and the following product of the prior, likelihood, and proposal density ratios:LN(uℓ*;νℓ,ξu2)LN(uℓ;νℓ,ξu2)LN(uℓ;log(uℓ*),ψ2)LN(uℓ*;log(uℓ),ψ2).∏i=1ILN(Ti;μk(i)+log(c+∑j∈Aifijdjuℓ(j)*),Me−λdi+δ)∏i=1ILN(Ti;μk(i)+log(c+∑j∈Aifijdjuℓ(j)),Me−λdi+δ).The variance ψ2 is a constant that may be tuned to control the average acceptance probability, which theoretical evidence suggests should be roughly 23 percent for optimal efficiency (Roberts & Rosenthal, 2001).To obtain the results in this article, we ran each Markov chain for 120,000 iterations, including a burn-in period of 20,000 iterations. To assess the Monte Carlo error, we calculated Monte Carlo standard errors for each of the parameter estimates, using batch means (Kelton & Law, 2000). Standard errors are quite low, roughly 1–2 percent of the parameter estimate for the μkparameters and 0.03–0.2 percent for the other parameters.The computation time for each Markov chain iteration scales linearly with the number of vehicle trips, for a fixed road network. Each Markov chain run for these experiments takes roughly 18 hours on a personal computer, without utilizing parallel computing. Since the likelihood is a product over the terms for each trip, computation time could be decreased by calculating the likelihood terms in parallel batches. The Budge et al. nonparametric method (Budge et al., 2010b) is estimated using maximum (penalized) likelihood (Rigby & Stasinopoulos, 2005) and takes roughly 20 minutes on a personal computer. In practice, however, ambulance travel time estimates are updated infrequently, so increased computation time is not a severe drawback (Westgate et al., 2013).The reduced versions of our method (see Section 4.1) have smaller computation time than the full method. For each set of parameters, the computation time is approximately linear in the number of parameters. For example, the computation time for estimating the road class parameters uℓ is reduced by approximately a factor of 7 for the model with only one road class, compared to the full model with seven road classes. The computation time for estimating the time bin parameters for the model with only one time bin is eliminated entirely, because the first parameter μ0 is always fixed to 0. A model with two time bins has computation time for estimating the time bin parameters reduced by approximately a factor of 3, compared to the full model with four time bins.

@&#CONCLUSIONS@&#
We introduced a parametric model for estimating the distribution of ambulance travel times between any locations in a road network. The method uses data from historical ambulance trips that can be sparse in time and network coverage, and is computationally tractable for large road networks and large datasets of vehicle trips. The model parameters are interpretable, and include effects for the roads traveled by the vehicle and trip-level effects such as time of day. We used a Bayesian formulation and Markov chain Monte Carlo method to estimate the model parameters.We tested the method on a large dataset of ambulance trips from Toronto. Exploratory analysis of the data indicated that the distribution of ambulance travel times between two fixed locations is well modeled by a lognormal distribution, with variability parameter depending on travel distance. These observations influenced our modeling choices. We compared travel time predictions from our method with predictions from a recently-published method by Budge et al. (2010b) and commercially available travel time estimates from TomTom. We found that our method outperformed the alternative methods in both point estimation and distribution estimation. We also compared our method with the method of Westgate et al. (2013) on a subregion of Toronto, and found that our method performed almost as well in point estimation and better in interval estimation, while being far more computationally efficient.We also investigated several reduced versions of our method, to determine which features were the most important. The largest benefit came from the inclusion of parameters for each road class in the city, compared to a model with only one road class. However, there was little benefit in performance from adding multiple time bins across the week vs. a single time bin. In the Toronto dataset, the ambulance travel times do not vary substantially across the day and week, even during rush hour. Because other cities or datasets may be more variable in time, we performed an additional set of experiments by artificially inflating the difference in travel times between time bins. We found that if the travel times during rush hour were increased by at least 20 percent, then time bin factors provided a substantial benefit to estimation.Finally, we investigated operational differences for ambulance fleet management from using our method vs. the method of Budge et al. After fixing a set of representative ambulance posts in Toronto, we calculated the probability that an ambulance arrives at each intersection in the city within 4 minutes, responding from the closest post. We found that for about 10 percent of the intersections in the city, the two methods gave arrival probabilities that differed by more than 15 percentage points.