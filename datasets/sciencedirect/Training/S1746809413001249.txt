@&#MAIN-TITLE@&#
Effects of spatial regularization on kinetic parameter estimation for dynamic PET

@&#HIGHLIGHTS@&#
This paper investigates the effects of spatial regularization on kinetic parameter estimations of dynamic PET.Spatial regularization based on Gaussian Markov random fields is used on kinetic parameter domain.Bias and variance in the estimated kinetic parameters are used to evaluate these effects.A simulated phantom is used at different amounts of noise and spatial regularization was used.

@&#KEYPHRASES@&#
Dynamic PET imaging,Compartmental models,Kinetic parameter estimation,Spatial regularization,

@&#ABSTRACT@&#
Kinetic parameters of the compartment models give important information about the physiology. These kinetic parameters are estimated from the time activity curves (TACs) that are obtained from dynamic positron emission tomography (PET). As the signal to noise (SNR) ratio of dynamic PET is low, the estimated kinetic parameters have low precision. The parametric images are formed by the kinetic parameters that are estimated for each pixel. Typically, the parametric images have large spatial variance due to low SNR and high variance of the estimated kinetic parameters. Many methods have been developed to reduce this variance. These methods concentrate on TAC denoising and population based constraints. Spatial regularization on the kinetic parameter domain is not used commonly, and its effects on the parametric images have not been investigated. The aim of this paper is to investigate the effect of a quadratic spatial regularization that is applied directly on the parametric images in terms of bias and variance. For this objective, bias and variance are investigated using two simulated datasets at different noise and spatial regularization levels. The results on simulated phantom indicate that the effects of spatial regularization on bias and variance depend on the size of the region and the amount of difference in parameter values in the neighbouring regions. Hence, spatial regularization should be used carefully, if the region of interest is small in size and has a large difference in kinetic parameter value with its surrounding regions. In addition, the effects of noise level on the bias and variance of estimated kinetic parameters decrease with the increasing level of spatial regularization.

@&#INTRODUCTION@&#
Positron emission tomography (PET) collects data that is produced by an injected chemical tracer that is labelled with a radioactive isotope. With its high chemical specificity, it is possible to generate images of tracer distribution. Depending on the type of the tracer, physiological information can also be inferred. In dynamic PET imaging, the temporal behaviour can also be measured in addition to the spatial distribution of the tracer. However, in order to understand the underlying physiology, the contribution of the tracer from different physical locations and chemical states should be revealed. Compartment models are used to model the interaction of tracer inside the body. The model has compartments that represent the distinct physical locations (i.e. plasma or tissue) and chemical states (i.e. free or metabolized). In addition, there are connections between these compartments that represent the exchange rate of tracer between the compartments in the model. These exchange rates are called “kinetic parameters”. For more information on compartment models and kinetic parameters for different type of tracers, see [1–3].The kinetic parameters are estimated using dynamic PET data and a measured arterial input function (AIF). The kinetic parameter estimation is described in Section 2. In some cases, the kinetic parameters are estimated for each pixel, and the estimated kinetic parameters form “parametric images”. Generally, the kinetic parameters of a region-of-interest (ROI) is estimated instead of pixelwise estimations.The PET data is inherently noisy, and the signal-to-noise ratio (SNR) of the data is low. When the data is divided into time frames to investigate the temporal behaviour of tracer concentration for dynamic PET, the SNR of the data furthermore decreases. The kinetic parameters that are estimated from this low SNR time-divided dynamic PET data, the estimations may have low precision. Furthermore, if parametric images are formed, these images have large spatial variations. Many methods have been developed in order to increase the precision of the estimated parameters and reduce the spatial variation in parametric images.In ROI analysis, the kinetic parameters are estimated for a region whose pixels have similar kinetic parameters. Therefore, the TACs obtained from the pixels within a region are averaged in order to increase the SNR and the precision of the estimated kinetic parameters.In other methods, TAC are denoised using spatial and/or temporal information. Christian et al.  adapted highly constrained backprojection (HYPR) of time resolved magnetic resonance imaging (MRI) to dynamic PET [4]. This method uses all available data statistics to denoise images that are reconstructed from dynamic PET before kinetic parameter estimation. Similarly, Hong et al.  transforms the dynamic PET data in order to obtain image reconstructions with high SNR [5]. Saad et al.  used TAC region segmentation simultaneously with parameter estimation to eliminate the spatial variance in the kinetic parameters [6]. Qi and Huessman applied spatial regularization in the reconstructed emission images to denoise TAC in the ROI [7]. Wang and Qi extended this work to dynamic PET quantification [8]. In other studies, the images are denoised using low-order approximations using principal component analysis [9,10], singular value decomposition [11], temporal splines [12–14], and wavelets [15–18]. These methods focussed on denoising of the dynamic PET reconstructions so that the TACs extracted from denoised dynamic PET images have higher SNR. Hence the kinetic parameters obtained from these TAC have higher precision and possibly lower spatial variance in parametric images.Besides denoising TAC, it is possible to apply constraints in the parameter domain. O’Sullivan et al.  used ridge regression to penalize the deviations from the physiologically reasonable values [19]. Similarly, Bertoldo et al.  used kinetic parameters obtained from a large population to constraint the estimations [20]. Zhou et al.  used spatially smoothed parametric images to reduce spatial variations in the images [21–23]. Wang and Qi compared spatial regularization based on Markov random fields to ridge regression and pixelwise least squares methods in terms of bias and variance [24]. Despite these studies, spatial regularization that is performed on the parametric images was not investigated in detail.This paper investigate the effects of spatial regularization on the parametric images in terms of bias and variance. The compartmental model and kinetic parameter estimation (with and without spatial variation) is introduced in Section 2, the method used is described in Section 3, and the results of the experiments are shown and discussed in Sections 4 and 5. Finally, Section 6 concludes the paper.In this model, there are two compartments that represent the tracer inside the tissue (shown in Fig. 1). Therefore, this model can be used for tracers that have two distinct chemical states within the tissue. The 2-tissue compartment model can be used for tracers such as 2-deoxy-2-(18F)fluoro-d-glucose (FDG), 11C-raclopride, 18F-fallypride etc. [2,25].The ODEs that describe the tracer dynamics for this model are:(1)ddtCT1(t)=k1CP(t)−(k2+k3)CT1(t)+k4CT2(t)(2)ddtCT2(t)=k3CT1(t)−k4CT2(t).The solution to the ODE's in (1) and (2) is given by(3)CT1(t)=k1α2−α1[(k4−α1)e−α1t+(α2−k4)e−α2t]u(t)*CP(t)(4)CT2(t)=k1k3α2−α1[e−α1t−e−α2t]u(t)*CP(t)where α1 and α2 are real valued constants that result from the subtraction and addition of terms in (5) respectively:(5)α1,α2=(k2+k3+k4)∓(k2+k3+k4)2−4k2k42and * denotes convolution.The activity measured from PET originates partially from the plasma compartment and from the compartments within the tissue:(6)Ctotal(t)=fvCP(t)+(1−fv)∑i=1NCTi(t)SAe−λt.In this equation,fvdenotes the fraction of plasma within the tissue, SAdenotes the initial specific activity of the tracer (i.e. efficiency of radioactive labelling), and λ denotes the decay constant for the radioactive isotope.Lets denote the kinetic parameters of the compartment model using θ=[k1, k2, …, kp] (θ∈ℝp)11In some cases, other parameters such asfvare also estimated from the data besides the kinetic parameters. In such cases, θ includes these parameters as well.. Furthermore, let f(θ, t) denote the forward model that models Ctotal(t) with given θ and t. In practice, the TAC data is obtained at discrete times by averaging the measurements. Let x=[x1, x2, …, xK] denote the vector of TAC measurements that are taken at K discrete times at t=(t1, t2, …, tK), i.e.xk=1/(tk+1−tk)∫tktk+1Ctotal(t)dt.Although there are many kinetic parameter estimation technique in the literature, the most commonly used method is to find the set of kinetic parameters that minimizes the weighted squared error between the measurements (x) and the model output f(θ, t)=[f(θ, t1), f(θ, t2), …, f(θ, tK)]. In this method the kinetic parameters are estimated as:(7)θˆ=argminθ≥0∥x−f(θ,t)∥W2whereθˆis the estimated kinetic parameter, W is the diagonal weighting matrix,∥a∥W2=aTWa, and superscript T denotes matrix transpose. Although, there are different ways to choose the weights, (see [26] for a comprehensive discussion on weight selection) the most commonly used weights are:(8)W=diagΔtkxkwhere xkis the measured activity and Δtkis the scan duration for time frame k.Kinetic parameters estimated for all pixels form a spatial parametric image, Θ=[θ1, θ2, …, θN], where θidenote the kinetic parameters for pixel i, and N denotes the total number of pixels in the parametric image.If the kinetic parameters for each pixel is estimated independently, the resulting parametric image will have very high spatial variance due to low SNR of the dynamic PET data. To control the spatial variance of the parametric images, an extra regularization term is added to the cost function that penalizes the local changes in the parameter values. This method is called kinetic parameter estimation with spatial regularization. Instead of (7):(9)Θˆ=argminΘ≥0∥X−f(Θ)∥W2+βR(Θ).is used. In this equation, X=[x1, x2, …, xN] denotes the TAC for all pixels, R(Θ) denotes the penalty term and β denotes the amount of regularization. When β=0, this will be equivalent to the independent estimation case described above, and when β=∞ a flat parametric image will be obtained. Therefore, a trade-off can be made between bias and variance by adjusting β parameter.In this paper we investigate the effects of a spatial regularization term, that penalizes the local changes:(10)R(Θ)=∑s∑rgsrΨ(θs,θr).In this equation θs(and θr) denotes the kinetic parameters at pixel s (and r), gsrdenotes the penalty weight for the difference in the kinetic parameters of pixel s and r, and Ψ(θs, θr) denotes the function that adjusts the amount of penalty. In order to penalize the local changes only,(11)gsr=1,If{s,r}∈N0,OtherwisewhereNdenotes the set of neighbouring pixel pairs. For Ψ, there are many options. In this paper, we use the L2 norm:(12)Ψ(θs,θr)=∥θs−θr∥Π2,where Π denotes a diagonal matrix that weights the changes in the kinetic parameters. In practice, L2 norm may damage the edges in the kinetic parameters. To avoid this, it is possible to use other functions such as Lpnorm, Huber norm [27] etc.

@&#CONCLUSIONS@&#
In this paper, the effects of spatial regularization on the kinetic parameter images are investigated. Using a phantom with regions of various sizes, a simulation study is performed. Using 2-tissue compartment model TAC are obtained. Using different noise realizations, bias and variance of each kinetic parameter at different regularization and noise level are analysed.It was observed that the effect of spatial regularization on bias and variance depends on the region size and amount of difference in parameter values at the neighbouring regions. The parameter values of pixels that are located at the edge are effected more compared to the remaining pixels of the region. The effect of these edge pixels depends on size of the region. As the region gets large, the relative percentage (and therefore the effect) of edge pixels decrease.The effects of noise on the bias and variance of estimated kinetic parameters decrease with the increasing level of spatial regularization.In accord with these results, the spatial regularization should be used carefully, if the region of interest is small in size and has a large difference in kinetic parameter value with its surrounding regions.