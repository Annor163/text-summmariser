@&#MAIN-TITLE@&#
Numerical computation of fractional Black–Scholes equation arising in financial market

@&#HIGHLIGHTS@&#
We consider a fractional model of Black–Scholes equation.The HPM and HAM are applied to obtain the solution of the problem.The results obtained by HPM and HAM are in excellent agreement.The numerical results show that the techniques are easy to implement and accurate.

@&#KEYPHRASES@&#
Black–Scholes equation,European option pricing,Fractional derivatives,Analytical solution,Homotopy perturbation method,Homotopy analysis method,34A08,35A20,

@&#ABSTRACT@&#
The aim of present paper is to present a numerical algorithm for time-fractional Black–Scholes equation with boundary condition for a European option problem by using homotopy perturbation method and homotopy analysis method. The fractional derivative is described in the Caputo sense. The methods give an analytic solution in the form of a convergent series with easily computable components, requiring no linearization or small perturbation. The methods show improvements over existing analytical techniques. Two examples are given and show that the homotopy perturbation method and homotopy analysis method are very effective and convenient overcomes the difficulty of traditional methods. The numerical results show that the approaches are easy to implement and accurate when applied to time-fractional Black–Scholes equation.

@&#INTRODUCTION@&#
In 1973, Fischer Black and Myron Scholes [1] derived the famous theoretical valuation formula for options. The main conceptual idea of Black and Scholes lie in the construction of a riskless portfolio taking positions in bonds (cash), option and the underlying stock. Such an approach strengthens the use of the no-arbitrage principle as well. Thus, the Black–Scholes formula is used as a model for valuing European (the option can be exercised only on a specified future date) or American (the option can be exercised at any time up to the date, the option expires) call and put options on a non-dividend paying stock [2]. Derivation of a closed form solution to the Black–Scholes equation depends on the fundamental solution of the heat equation. Hence, it is important, at this point, to transform the Black–Scholes equation to the heat equation by change of variables. Having found the closed form solution to the heat equation, it is possible to transform it back to find the corresponding solution of the Black–Scholes PDE. Financial models were generally formulated in terms of stochastic differential equations. However, it was soon found that under certain restrictions these models could written as linear evolutionary PDEs with variable coefficients [3]. Thus, the Black–Scholes model for the value of an option is described by the equation(1)∂v∂t+σ2x22∂2v∂x2+r(t)x∂v∂x−r(t)v=0,(x,t)∈R+×(0,T)where v(x,t) is the European call option price at asset price x and at time t,  K is the exercise price, T is the maturity, r(t) is the risk free interest rate, and σ(x,t) represents the volatility function of underlying asset. Let us denote by vc(x,t) and vp(x,t) the value of the European call and put options, respectively. Then, the payoff functions are(2)vc(x,t)=max(x−E,0),vp(x,t)=max(E−x,0),where E denotes the expiration price for the option and the function max(x,0) gives the larger value between x and 0. During the past few decades, many researchers studied the existence of solutions of the Black-Scholes model using many methods in [4–12]. Many important phenomena are well described by fractional differential equations in electromagnetics, acoustics, viscoelasticity, electro chemistry and material science. That is because of the fact that, a realistic modelling of a physical phenomenon having dependence not only at the time instant, but also the previous time history can be successfully achieved by using fractional calculus. The book by Oldham and Spanier [13] has played a key role in the development of the subject. Some fundamental results related to solving fractional differential equations may be found in Miller and Rose [14], Podlubny [15], Kilbas et al. [16], Podlubny [17].The objective of this paper is to extend the application of homotopy perturbation method (HPM) and homotopy analysis method (HAM) to obtain analytic and approximate solution fractional Black–Scholes equations. The homotopy perturbation method is first proposed and applied by Chinese mathematician He [18–22]. The method was successfully applied to space–time fractional advection–dispersion equation by Yildirim and Kocak [23], fractional Zakharov–Kuznetsov equations by Yildirim and Gulkanat [24], fractional modified Kdv equation by Abdulaziz et al. [25], Fractional Chemical Engineering equation by Khan et al. [26]. One of the highly applicable analytical techniques is homotopy analysis method (HAM), which was introduced and developed by Liao [27–31]. This method is applied to solve many nonlinear problems [32–35] and the references therein to handle a wide variety of scientific and engineering applications: linear and nonlinear as well as homogeneous and inhomogeneous.The fractional Black–Scholes equation can be written as(3)Dtαv+σ2x22Dx2v+r(t)xDxv−r(t)v=0,0<α≤1,equipped with the terminal and boundary condition(4)v(x,T)=max(x−E,0),x∈R+,v(0,t)=0,t∈[0,T]In this section, we mention the following basic definitions of fractional calculus which are used further in the present paper.Definition 1The Riemann-Liouville fractional integral operator of order α > 0, of a functionf(t)∈Cμ,μ≥−1is defined as [15]:(5)Jαf(t)=1Γ(α)∫0t(t−τ)α−1f(τ)ⅆτ,(α>0),(6)J0f(t)=f(t).For the Riemann-Liouville fractional integral we have:(7)Jαtγ=Γ(γ+1)Γ(γ+α+1)tα+γ.The fractional derivative of f(t) in the Caputo sense is defined as [36]:(8)Dtαf(t)=Jm−αDnf(t)=1Γ(n−α)∫0t(t−τ)m−α−1f(m)(τ)ⅆτ,form−1<α≤m,m∈N,t>0.For the Riemann-Liouville fractional integral and the Caputo fractional derivative, we have the following relation(9)JtαDtαf(t)=f(t)−∑k=0m−1f(k)(0+)tkk!.The Mittag-Leffler is defined as [37]:(10)Eα(z)=∑k=0∞zkΓ(αk+1),(α∈C,Re(α)>0).To illustrate the basic idea of the HPM for fractional differential equations, we consider the following problem(11)D∗tαu(x,t)=v(x,t)−Lu(x,t)−Nu(x,t),m−1<α≤m,m∈N,t≥0,x∈RnSubject to the initial and boundary conditions(12)u(i)(0,0)=ci,B(u,∂u∂xj,∂u∂t)=0,i=0,1,2,…,m−1,j=1,2,3,…,nwhere L is a linear operator, while N is a nonlinear operator, v is a known analytical function andD∗tαdenotes the fractional derivative in the Caputo sense [15]. u is assumed to be a causal function of time, i.e., vanishing for t < 0. Also u(i)(x,t) is the ith derivative of u, ci,  i = 0,1,2,…,m−1 are the specified initial conditions and B is a boundary operator.We construct the following homotopy(13)(1−p)D∗tαu(x,t)+p(D∗tαu(x,t)+Lu(x,t)+Nu(x,t)−v(x,t))=0,p∈[0,1]which is equivalent to(14)D∗tαu(x,t)+p(Lu(x,t)+Nu(x,t)−v(x,t))=0,p∈[0,1]The homotopy parameter p always changes from zero to unity. In case p = 0, Eq. (14) becomes(15)D∗tαu(x,t)=0,when p = 1, Eq. (14) turns out to be the original fractional differential equation. The homotopy parameter p is used to expand the solution in the following form(16)u(x,t)=u0(x,t)+pu1(x,t)+p2u2(x,t)+p3u3(x,t)+….For nonlinear problems, we set Nu(x,t) = S(x,t). Substituting Eq. (16) into Eq. (14) and equating the terms with identical power of p, we obtain a sequence of equations of the form(17)p0:D∗tαu0(x,t)=0,p1:D∗tαu1(x,t)=−Lu0(x,t)−S0(u0(x,t))+v(x,t),p2:D∗tαu2(x,t)=−Lu1(x,t)−S1(u0(x,t),u1(x,t)),pj:D∗tαuj(x,t)=−Luj−1(x,t)−Sj−1(u0(x,t),u1(x,t),u2(x,t),…,uj−1(x,t)),j=2,3,4,…The functions S0,S1,S2,… satisfy the following equation(18)S(u0(x,t)+pu1(x,t)+p2u2(x,t)+p3u3(x,t)+…)=S0(u0(x,t))+pS1(u0(x,t),u1(x,t))+p2S2(u0(x,t),u1(x,t),u2(x,t))+….Applying the inverse operatorJtαon both sides of the equation (15) and considering the initial and boundary conditions, the various components of the series solution are given by(19)u0(x,t)=∑i=0n−1citii!,u1(x,t)=−Jtα(Lu0(x,t))−JtαS0(u0(x,t))+Jtαv(x,t),uj(x,t)=−Jtα(Luj−1(x,t))−JtαSj−1(u0(x,t),u1(x,t),u2(x,t),…,uj−1(x,t)),j=2,3,4,....Hence, the HPM solution u(x,t) is given by(20)u(x,t)=∑i=0∞ui(x,t)In order to show the basic idea of HAM, consider the following nonlinear fractional differential equation(21)NF[u(x,t)]=0,where NFis a nonlinear fractional operator, x and t denote the independent variables and u is an unknown function. For simplicity, we ignore all boundary or initial conditions, which can be treated in the similar way. By means of the HAM, we first construct the so-called zeroth-order deformation equation as(22)(1−q)LF[ϕ(x,t;q)−u0(x,t)]=ℏqH(x,t)NF[u(x,t)],whereq∈[0,1]is the embedding parameter, ℏ ≠ 0 is an auxiliary parameter, LFis an auxiliary linear operator, φ(x,t  ;q) is an unknown function,u0(x,t) is an initial guess of u(x,t) and H(x,t) denotes a nonzero auxiliary function. Obviously, when the embedding parameter q = 0 and q = 1, it holds(23)ϕ(x,t;0)=u0(x,t),ϕ(x,t;1)=u(x,t),respectively. Thus as q increases from 0 to 1, the solution φ(x,t  ;q) varies from the initial guess u0(x,t) to the solution u(x,t). Expanding φ(x,t  ;q) in Taylor series with respect to q, we have(24)ϕ(x,t;q)=u0(x,t)+∑m=1∞um(x,t)qm,where(25)um(x,t)=1m!∂mϕ(x,t;q)∂qm|q=0.If the auxiliary linear operator, the initial guess, the auxiliary parameter ℏ, and the auxiliary function are properly chosen, the series (24) converges at q = 1, then we have(26)u(x,t)=u0(x,t)+∑m=1∞um(x,t),which must be one of the solutions of the original nonlinear fractional differential equations. According to the definition (26), the governing equation can be deduced from the zero-order deformation (22). Define the vectors(27)u→m={u0(x,t),u1(x,t),…,um(x,t)}.Differentiating the zeroth-order deformation Eq. (22) m-times with respect to q and then dividing them by m! and finally setting q = 0, we get the following mth-order deformation equation:(28)LF[um(x,t)−χmum−1(x,t)]=ℏH(x,t)ℜm(u→m−1),where(29)ℜm(u→m−1)=1(m−1)!∂m−1NF[ϕ(x,t;q)]∂qm−1|q=0,and(30)χm={0,m≤1,1,m>1.In order to illustrate the advantages and the accuracy of the HPM and HAM for solving fractional Black-Scholes equation with boundary condition for a European option problem, we have applied the methods for two different examples.Example 1We consider the fractional Black–Scholes equation as [12](31)∂αv∂tα=∂2v∂x2+(k−1)∂v∂x−kv,0<α≤1,with initial condition v(x,0) = max (ex−1,  0). Notice that this system of equations contains just two dimensionless parameters k = 2 r/σ2, where k represents the balance between the rate of interests and the variability of stock returns and the dimensionless time to expiry ½σ2T, even though there are four dimensional parameters, E,  T, σ2 and r, in the original statements of the problem.According to the HPM [18–22], we construct the following homotopy(32)Dtαv−p(Dx2v+(k−1)Dxv−kv)=0,where the homotopy parameter p is considered as a small parameterp∈[0,1]. Now applying the classical perturbation technique, we can assume that the solution of Eq. (32) can be expressed as power series in p as given below(33)v=v0+pv1+p2v2+p3v2+…Substituting (33) into (32) and equating the coefficients of like powers of p, we get the following set of differential equations that(34)p0:Dtαv0(x,t)=0,(35)pn:Dtαvn(x,t)=Dx2vn−1(x,t)+(k−1)Dxvn−1(x,t)−kvn−1(x,t),n≥1.The above equations can be easily solved by applying the operatorJtαto (34,35) giving the various components vn(x,t) asv0(x,t)=v(x,0)=max(ex−1,0),v1(x,t)=−max(ex,0)(−ktα)Γ(α+1)+max(ex−1,0)(−ktα)Γ(α+1),v2(x,t)=−max(ex,0)(−ktα)2Γ(2α+1)+max(ex−1,0)(−ktα)2Γ(2α+1),⋮Finally, we approximate the analytical solution v(x,t) by the seriesv(x,t)=limN→∞∑n=0N−1vn(x,t),then we getv(x,t)=max(ex,0)−max(ex,0)(1+(−ktα)Γ(α+1)+(−ktα)2Γ(2α+1)+⋯)+max(ex−1,0)(1+(−ktα)Γ(α+1)+(−ktα)2Γ(2α+1)+⋯)orv(x,t)=max(ex,0)−max(ex,0)∑n=0∞(−ktα)nΓ(nα+1)+max(ex−1,0)∑n=0∞(−ktα)nΓ(nα+1),and in closed form(36)v(x,t)=max(ex,0)(1−Eα(−ktα))+max(ex−1,0)Eα(−ktα).This is the exact solution of the given problem of (31).To solve the Eq. (31) by HAM, we choose the auxiliary operators as followsLF[ϕ(x,t;q)]=Dtα[ϕ(x,t;q)],with the property LF[c1] = 0.Using the above definition, we first construct the zeroth-order deformation equations as(37)(1−q)LF[ϕ(x,t;q)−χmv0(x,t)]=ℏqNF[ϕ(x,t;q)].Obviously, when the embedding parameter q = 0 and q = 1, it holds(38)ϕ(x,t;0)=v0(x,t),ϕ(x,t;1)=v(x,t).Differentiating the zeroth-order deformation Eq. (37) m-times with respect to q and then dividing them by m! and finally setting q = 0, we get the following mth-order deformation equations(39)LF[vm(x,t)−χmvm−1(x,t)]=ℏℜm(u→m−1),where(40)ℜm(v→m−1)=∂αvm−1∂tα−∂2vm−1∂x2−(k−1)∂vm−1∂x+kvm−1.On applying the operatorJtαboth the sides of Eq. (39), we get(41)vm(x,t)=χmvm−1(x,t)+ℏℜm(u→m−1),subsequently solving the mth-order deformation equations one hasv0(x,t)=max(ex−1,0),v1(x,t)=ℏmax(ex,0)(−ktα)Γ(α+1)−ℏmax(ex−1,0)(−ktα)Γ(α+1),v2(x,t)=ℏ(1+ℏ)max(ex,0)(−ktα)Γ(α+1)−ℏ(1+ℏ)max(ex−1,0)(−ktα)Γ(α+1)−ℏ2max(ex,0)(−ktα)2Γ(2α+1)+ℏ2max(ex−1,0)(−ktα)2Γ(2α+1),and so on.Therefore, the HAM series solution is(42)v(x,t)=max(ex−1,0)+ℏmax(ex,0)(−ktα)Γ(α+1)−ℏmax(ex−1,0)(−ktα)Γ(α+1)+ℏ(1+ℏ)max(ex,0)(−ktα)Γ(α+1)−ℏ(1+ℏ)max(ex−1,0)(−ktα)Γ(α+1)−ℏ2max(ex,0)(−ktα)2Γ(2α+1)+ℏ2max(ex−1,0)(−ktα)2Γ(2α+1)+…Taking ℏ = −1, we get the same solution as obtained by HPM.Consider the vanilla call option with parameter [5]σ = 0.2,    r = 0.04,    α = 1,      τ = 0.5 years then k = 2.In this case, we get the solution of Eq. (31)(43)v(x,t)=max(ex,0)(1−e−2t)+max(ex−1,0)e−2t.This is the given exact solution of the standard Black–Scholes equation.In this case, we consider the vanilla call option with parameter [5]σ = 0.2,    r = 0.01,    α = 1,     τ = 1 year then k = 5.We get the solution of Eq. (31)(44)v(x,t)=max(ex,0)(1−e−5t)+max(ex−1,0)e−5t.This is the exact solution for the given case.The numerical results for the fractional Black–Scholes Eq. (31) obtained by using the HPM and HAM for various values of x and t, when α = 1 and k = 2 are shown by Fig. 1. It can be observed from Fig. 1 that ν(x,t) increases with the increase in both x and t.In this example, we consider the following generalized Black–Scholes equation as [6](45)∂αv∂tα+0.08(2+sinx)2x2∂2v∂x2+0.06x∂v∂x−0.06v=0,0<α≤1,with initial condition v(x,0) = max (x−25 e−0.06,  0).We construct the homotopy which satisfies the relation(46)Dtαv+p[0.08(2+sinx)2x2Dx2v+0.06xDxv−0.06v]=0,p∈[0,1].Substituting (33) into (46) and equating the coefficients of like powers of p, we get following set of differential equations(47)p0:Dtαv0(x,t)=0,(48)pn:Dtαvn(x,t)=−(0.08(2+sinx)2x2Dx2vn−1(x,t)+0.06xDxvn−1(x,t)−0.06vn−1(x,t)),n≥1.Consequently, the above system of nonlinear equations can be easily solved by applying the operatorJtαto (47,48) giving the various components vn(x,t), thus enabling the series solution to be entirely determined. The first few components of the homotopy perturbation solution for Eq. (45) are derived as follows:v0(x,t)=v(x,0)=max(x−25e−0.06,0),v1(x,t)=−x(0.06tα)Γ(α+1)+max(x−25e−0.06,0)(0.06tα)Γ(α+1),v2(x,t)=−x(0.06tα)2Γ(2α+1)+max(x−25e−0.06,0)(0.06tα)2Γ(2α+1),⋮and so on.Finally, we approximate the analytical solution v(x,t) by the seriesv(x,t)=limN→∞vN(x,t),wherevN(x,t)=∑n=0N−1vn(x,t),then we get(49)v(x,t)=x(1−Eα(0.06tα))+max(x−25e−0.06,0)Eα(0.06tα).which is analytical solution of the fractional Black-Scholes Eq. (45).To solve the Eq. (45) by HAM, we choose the auxiliary operators as followsLF[ϕ(x,t;q)]=Dtα[ϕ(x,t;q)],with the property LF[c1] = 0.Using the above definition, we first construct the zeroth-order deformation equations as(50)(1−q)LF[ϕ(x,t;q)−χmv0(x,t)]=ℏqNF[ϕ(x,t;q)].Obviously, when the embedding parameter q = 0 and q = 1, it holds(51)ϕ(x,t;0)=v0(x,t),ϕ(x,t;1)=v(x,t).Differentiating the zeroth-order deformation Eq. (50) m-times with respect to q and then dividing them by m! and finally setting q = 0, we get the following mth-order deformation equations(52)LF[vm(x,t)−χmvm−1(x,t)]=ℏℜm(u→m−1),where(53)ℜm(u→m−1)=∂αvm−1∂tα+0.08(2+sinx)2x2∂2vm−1∂x2+0.06x∂vm−1∂x−0.06vm−1.On applying the operatorJtαboth the sides of Eq. (52), we get(54)vm(x,t)=χmvm−1(x,t)+ℏℜm(u→m−1),subsequently solving the mth-order deformation equations one hasv0(x,t)=max(x−25e−0.06,0),v1(x,t)=ℏx(0.06tα)Γ(α+1)−ℏmax(x−25e−0.06,0)(0.06tα)Γ(α+1),v2(x,t)=ℏ(1+ℏ)x(0.06tα)Γ(α+1)−ℏ(1+ℏ)max(x−25e−0.06,0)(0.06tα)Γ(α+1)−ℏ2x(0.06tα)2Γ(2α+1)+ℏ2max(x−25e−0.06,0)(0.06tα)2Γ(2α+1),⋮and so on.Therefore, the HAM series solution is(55)v(x,t)=max(x−25e−0.06,0)+ℏx(0.06tα)Γ(α+1)−ℏmax(x−25e−0.06,0)(0.06tα)Γ(α+1)+ℏ(1+ℏ)x(0.06tα)Γ(α+1)−ℏ(1+ℏ)max(x−25e−0.06,0)(0.06tα)Γ(α+1)−ℏ2x(0.06tα)2Γ(2α+1)+ℏ2max(x−25e−0.06,0)(0.06tα)2Γ(2α+1)+⋯.Taking ℏ = −1, we get the same solution as obtained by HPM.In this study, the HPM and HAM are implemented to solve the time-fractional Black–Scholes equation with boundary condition for a European option problem. They provide the solutions in terms of convergent series with easily computable components in a direct way without using linearization, perturbation or restrictive assumptions. The solution obtained with the help of HAM is more general as compared to HPM solution. We can easily recover all results HPM by assuming ℏ = −1. The results show that the HPM and HAM are powerful and efficient techniques in finding exact and approximate solutions for fractional differential equations. In conclusion, the HPM and HAM may be considered as a nice refinement in existing numerical techniques and might find the wide applications.

@&#CONCLUSIONS@&#
