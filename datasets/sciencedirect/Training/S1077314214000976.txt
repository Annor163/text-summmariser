@&#MAIN-TITLE@&#
Fast and globally convex multiphase active contours for brain MRI segmentation

@&#HIGHLIGHTS@&#
A multiphase active contour model for image segmentation is proposed for brain MRI images.Following a relaxed convex formulation, a fast algorithm using dual minimization is implemented.Compared with other multiphase active contours, the proposed model performs well.Extensive experimental and comparison results indicate the usefulness of the model for brain MRI image segmentation.

@&#KEYPHRASES@&#
Image segmentation,Active contours,Multiphase,Globally convex,Dual formulation,Brain MRI,

@&#ABSTRACT@&#
Multiphase active contour based models are useful in identifying multiple regions with spatial consistency but varying characteristics such as the mean intensities of regions. Segmenting brain magnetic resonance images (MRIs) using a multiphase approach is useful to differentiate white and gray matter tissue for anatomical, functional and disease studies. Multiphase active contour methods are superior to other approaches due to their topological flexibility, accurate boundaries, robustness to image variations and adaptive energy functionals. Globally convex methods are furthermore initialization independent. We extend the relaxed globally convex Chan and Vese two-phase piecewise constant energy minimization formulation of Chan et al. (2006) [1] to the multiphase domain and prove the existence of a global minimizer in a specific space which is one of the novel contributions of the paper. An efficient dual minimization implementation of our binary partitioning function model accurately describes disjoint regions using stable segmentations by avoiding local minima solutions. Experimental results indicate that the proposed approach provides consistently better accuracy than other related multiphase active contour algorithms using four different error metrics (Dice, Rand Index, Global Consistency Error and Variation of Information) even under severe noise, intensity inhomogeneities, and partial volume effects in MRI imagery.

@&#INTRODUCTION@&#
The aim of image segmentation is to obtain meaningful partitions of an input image into a finite number of disjoint homogeneous objects. Active contour models are popular in the regard. Chan and Vese [2] proposed an active contour without edges scheme based on the classical work of Mumford and Shah [3] variational energy minimization model. Since biomedical images typically have multiple regions of interest with different characteristics, deriving a multiphase active contour scheme for efficient segmentation is an important area of research in image processing [4–6].Measuring brain activity and structure using neuroimaging, combined with behavioral and genetic data to characterize human brain connectivity is one of the major goals of The Human Connectome Project (HCP) [7]. Systematic processing and analysis of the MRI (magnetic resonance image) data collected by the HCP for 1200 subjects will be an extremely challenging task. Automated segmentation of multimodal imagery such as T1-weighted, T2-weighted anatomical scans, diffusion imaging, resting state and task-evoked functional MRI will enable quantitative characterization of similarities and differences in structural connectivity and brain activity differences between individuals. Cognitive processes such as memory, language, emotion, decision-making, and social cognition are all being studied as part of the HCP. One of the basic quantitative image analysis tasks that is expected to be necessary in the neuro-informatics data processing workflow is brain region segmentation. The multi-region brain MRI segmentation algorithm developed in this paper will facilitate the large scale efforts underway in functional connectomics and can be adapted for building an activity map of the brain.In MR images, segmentation schemes based on active contours have used the traditional level set method [8]. Active contours can also be improved using region information [9,10], salient features [11], mathematical morphology [12], etc. Traditionally these schemes use a gradient descent formulation to implement the non-convex energy minimization which often converges to undesirable local minima resulting in erroneous segmentations. Moreover, traditional level set based implementations are susceptible to slower convergence due to the well-known re-initialization requirement and discretization errors. Among other techniques for MRI segmentation, we mention fuzzy C-means based models [13–16], fuzzy connectedness [17], automatic labeling [18], adaptive expectation–maximization (EM) [19], Bayesian EM [20], hidden Markov model EM [21], kernel clustering [22], optimum-path clustering [23], anisotropic diffusion combined with classical snakes model [24], discriminant analysis [25], and neural networks [26]. We also refer to [27–29] for reviews about segmentation for medical images in general. The area of MRI image segmentation has seen tremendous research activity and a more detailed review in this particular field can be found in [30].Recently quite a lot of interest is being shown in techniques that can obtain a general convex formulation for active contours schemes based on energy minimization which can alleviate the problem of local minima and at the same time reduce computational complexity [31–37]. In Chan et al. [1] a convex approach to the two phase segmentation is proposed when the piecewise constant values labeling disjoint regions are known. The method relies in replacing the Heaviside functions of level sets (or characteristic functions) by convex and differentiable functions varying in the interval[0,1]which remarkably still yields a solution that is obtained by a simple thresholding procedure. This allows the non-convex Chan–Vese problem [2] to be solved using standard convex optimization methods. There have been efforts to extend the approach of [1] to the more challenging multi-phase problem [5]. Zach et al. [38] and Lellman et al. [39] proposed convex minimization schemes for the multi-phase segmentation without guaranteed global optimum of the original problem. Other approaches due to [40,41] not only use a convex formulation but also a dual formulation of the total variation in order to enforce a convex constraint on the dual variable providing accurate and better numerical solutions, but do not aim at computing a global minimizer of the problem.In this paper, we consider a globally convex version of the four phase piecewise constant energy functional motivated from the seminal work of Chan et al. [1] and based on Bresson et al. [42] which considered the two phase segmentation model. By deriving an approximate novel convex functional we change the original formulation into a binary segmentation problem and utilize a Chambolle’s dual minimization [43] to solve the relaxed formulation [44]. The proposed global methodology avoids the level set re-initialization constraint and other ad hoc techniques [45] used for fixing level set active contour movements throughout the iterations. The proposed approach is used to obtain white matter and gray matter partitions on brain MRI images as can be seen for example in Fig. 1. Fig. 1a is a coronal slice from a normal brain MRI and the binary segmentations capture gray matter/white matter (Fig. 1b white and black regions respectively), and tissue/background (Fig. 1c white and black regions respectively). Fig. 1d show the final segmentation result as contours superimposed on the input image and the color coded regions in Fig. 1e shows that our scheme captures the intermediate regions as well.Our scheme does not involve level sets or re-initialization and instead relies on the relaxed globally convex formulation of the Vese and Chan multiphase active contours [5]. Comparison results on different MRI data sets (real and synthetic) with varying noise and inhomogeneities show that we can obtain better results than traditional level set multiphase schemes [5,46,47] and the primal–dual approach of [48]. Moreover, compared to these traditional level set based implementations we achieve faster convergence due to the use of efficient alternating dual minimization [49]. The proposed approach is general in the sense that we can add domain specific knowledge to improve such active contour schemes further for various tasks [50–55]. The main contribution of our work is twofold: (1) a fast four phase active contour model using a relaxed globally convex minimization approximation; (2) an efficient dual minimization based numerical implementation for performing segmentation on MRI images.The rest of the paper is organized as follows. Section 2 introduces the multiphase variational active contour scheme and provides a globally convex formulation. Section 3 illustrates the segmentation results on various Brain MRI images including comparison of different schemes. Finally, Section 4 concludes the paper with discussion.We first briefly review the classical level set formulation of Chan and Vese [2] which is based on the Mumford and Shah functional [3] with particular emphasis on the piecewise constant model. The Mumford–Shah segmentation energy minimization is given by(1)minc0,c1∈R,Σ⊂ΩMS(Σ,c0,c1)≔Per(Σ)+λ0∫Σ(I-c0)2dx+λ1∫Ω⧹Σ(I-c1)2dxwhereI:Ω⊂R2→Ris the input image,Per(·)denotes the perimeter and∂Σseparates the regionsΣandΩ⧹Σwhere the two valuesc0,c1are taken. This functional is non-convex even if we fix the constantsc0,c1and thus a difficult optimization problem. Chan and Vese proposed to use the level set-based algorithm for solving the functional (1) by representing the boundary∂Σwith the zero level set of an implicit function which models the image. Letϕ:Ω⊂R2→Rbe the level set which defines two regions which are ‘inside’{x∈Ω:ϕ(x)<0}and ‘outside’{x∈Ω:ϕ(x)>0}based on the zero level setϕ=0. Let H is the Heaviside function,(2)H(z)=1ifz⩾0,0ifz<0.Then the Chan and Vese model is given by the following minimization problem,(3)min(c,ϕ)E(c,ϕ)=∫Ωδ(ϕ)|∇ϕ|dx+λ0∫Ω(I-c0)2H(ϕ)dx+λ1∫Ω(I-c1)2(1-H(ϕ))dx,whereδis the Dirac delta function,c=(c0,c1)are the mean intensity values inside and outside regions respectively. The Euler–Lagrange equation with gradient descent formulation results in a nonlinear partial differential equation (PDE),(4)∂ϕ∂t=δ(ϕ)div∇ϕ|∇ϕ|-λ0(I-c0)2+λ1(I-c1)2,along with(5)c0=∫ΩIH(ϕ)dx∫ΩH(ϕ)dx,c1=∫ΩI(1-H(ϕ))dx∫Ω(1-H(ϕ))dx.Chan et al. [1] in their work on finding global minimizers for such segmentation models observed that the following PDE,(6)∂ϕ∂t=div∇ϕ|∇ϕ|-λ0(I-c0)+λ1(I-c1),and the PDE in Eq. (4) has the same steady states and the later PDE (6) can be derived from the following functional,(7)min(c,ϕ)E(c,ϕ)=∫Ω|∇ϕ|dx+∫Ω[λ0(I-c0)2-λ1(I-c1)2]ϕdx.The following theorem which is proven in [1] paves the way for obtaining globally convex version of the two phase Mumford and Shah functional.Theorem 1Theorem 2 in [1]For anyc0,c1∈R, a global minimizer ofMS(·,c0,c1)can be found by carrying out the following minimization:min0⩽u⩽1∫Ω|∇u|dx+∫Ωλ0(I-c0)2-λ1(I-c1)2u(x)dxand then settingΣ={x:u(x)⩾μ}for a.e.μ∈[0,1].Vese and Chan [5] extended the two-phase formulation to multi-phase case based on the observation that n level sets can be used to describe2nphases or regions. Here we restrict our description to the four phase model which is used in segmenting MR images effectively. Letϕ1,ϕ2:Ω⊂R2→Rbe the two level sets.H1=H(ϕ1),H2=H(ϕ2)andH∼1=1-H(ϕ1),H∼2=1-H(ϕ2), representing four regions. Our goal is to solve a minimization problem(8)min(c,Φ)F(c,Φ)withF(c,Φ)=∫Ωδ(ϕ1)|∇ϕ1|dx+∫Ωδ(ϕ2)|∇ϕ2|dx+λ11∫Ω(I-c11)2H1H2dx+λ10∫Ω(I-c10)2H1H∼2dx+λ01∫Ω(I-c01)2H∼1H2dx+λ00∫Ω(I-c00)2H∼1H∼2dxwhereΦ=(ϕ1,ϕ2), and the constant mean valuesc=(c11,c10,c01,c00)can be derived as(9)c11=∫ΩIH1H2dx∫ΩH1H2dx,c10=∫ΩIH1H∼2dx∫ΩH1H∼2dx,(10)c01=∫ΩIH∼1H2dx∫ΩH∼1H2dx,c00=∫ΩIH∼1H∼2dx∫ΩH∼1H∼2dx.Note the zero level setsϕi=0,i=1,2, represent object boundaries and the mean valuescrepresent the expected average pixel values in these objects. Vese and Chan [5] used the corresponding gradient descent equations to implement the active contours [8]. In the numerical implementation of the above PDEs, a non-compactly supported, smooth approximation of the Heaviside functionH∊(x), such thatH∊(x)→H(x)as∊→0is utilized. Since the above minimization (8) is non-convex the time discretized gradient descent PDEs usually require large iterations and small time steps to convergence (typically in 100’s of iterations). Moreover, the final segmentation result may not correspond to the global minimum of the energy function as the gradient descent scheme can be stuck at a local minima of the corresponding energy functional given in Eq. (8).We note the corresponding gradient descent equations (time dependent Euler–Lagrange equations of Eq. (8)) for the level sets functionsϕ1andϕ2,(11)ϕ1t=δ(ϕ1)div∇ϕ1|∇ϕ1|-r1(c)and(12)ϕ2t=δ(ϕ2)div∇ϕ2|∇ϕ2|-r2(c)respectively. Here, the image fitting terms are given by,r1(c)=(λ11(I-c11)2-λ01(I-c01)2)H2+(λ10(I-c10)2-λ00(I-c00)2)H∼2r2(c)=(λ11(I-c11)2-λ10(I-c10)2)H1+(λ01(I-c01)2-λ00(I-c00)2)H∼1.Following, Chan et al. [1], we drop the dirac delta functions (δ(·)in (11) and (12)) allowing us to obtain the minimization(13)min(c,Φ)F(c,Φ)withF(c,Φ)=∫Ω|∇ϕ1|dx+∫Ω|∇ϕ2|dx+∫Ωr1(c)ϕ1dx+∫Ωr2(c)ϕ2dx.Then correspondingly we can derive an energy functional which does not depend on regularized Heaviside functions. Thus, we can solve the following globally convex energy minimization problem,(14)minu=(u1,u2)∈{0,1}2G(c,u)withG(c,u)=∫Ω|∇u1|dx+∫Ω|∇u2|dx+λ11∫Ω(I-c11)2u1u2dx+λ01∫Ω(I-c01)2(1-u1)u2dx+λ10∫Ω(I-c10)2u1(1-u2)dx+λ00∫Ω(I-c00)2(1-u1)(1-u2)dx,where Heaviside functions are replaced byu=(u1,u2)∈{0,1}2which are known as binary partitioning functions. The above modified minimization problem (14) can further be relaxed to the set of functionsu=(u1,u2)∈[0,1]2in order to solve a convex minimization problem. That is, the binary partitioning functions based energy minimization becomes,(15)minu=(u1,u2)∈[0,1]2G(c,u).The following theorem provides the guarantee of finding a global minimizer for the derived functional (14) in terms of the relaxed version in (15). We follow arguments similar to the work of Chan et al. [1,36] to prove the following result.Theorem 2For anyc11,c10,c01,c00∈R, a global minimizer forG(c,·)in(14)can be found by carrying out the convex minimization problem(15).See Appendix A.□The final segmentation is obtained by thresholding the functionsu1andu2with any number in the interval(0,1)for example at0.5, as shown in Fig. 1b and c. Note that the above modified minimization model does not involve level sets and thus can be solved efficiently. Further, we can prove that the above relaxed minimization problem can be solved in a binary variable minimization formulation to find a global minimum. The existence of minimizers of the modified energyGgiven in Eq. (15) is proved using the theory of functions of bounded variation (BV) [56].Theorem 3For a given input gray scale imageI∈L∞(Ω), there exists a minimizer for the functionalGin(15)inR4×BV[0,1](Ω)2.See Appendix B□

@&#CONCLUSIONS@&#
