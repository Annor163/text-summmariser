@&#MAIN-TITLE@&#
Semi-fragile self-recoverable watermarking scheme for face image protection

@&#HIGHLIGHTS@&#
PCA coefficients are used to generate information watermarks, and the authentication watermarks are generated using SVD coefficients.The embedding position is generated by a chaotic map, and it improves the security of the proposed method.Watermarks are embedded into the mid-frequency bands by using our proposed SDPQ method.

@&#KEYPHRASES@&#
Semi-fragile,Self-recoverable,Tamper detection,Face image protection,PCA,

@&#ABSTRACT@&#
Digital watermarking based biometric images protecting has been an active research focus. In this paper, we propose a face image protection scheme based on semi-fragile self-recoverable watermarking. Authentication watermark is generated from the singular value decomposition (SVD) coefficients for each image block, and information watermark is generated from the principal component analysis (PCA) coefficients. Both of them are embedded into wavelet medium frequency coefficients by using the proposed group-based wavelet quantization method. On the authentication side, after identifying the tampered regions, the proposed method can recover the tampered face images by using the hidden information watermark. Experimental results demonstrate that the proposed watermark scheme has high localization accuracy and robustness comparing with the existing techniques, and the recovered PCA coefficients can be used to reconstruct the Eigen-face image or be directly used for recognition system.

@&#INTRODUCTION@&#
Nowadays, with the wide use of biometric recognition system, biometric security is gaining increasing attention. The digital signature can be used to protect the biometric images. However, it has the following limitations: (1) digital signatures can verify whether the biometric images have been tampered but the modifications cannot be indicated; (2) data recovery capability is limited. Although error correction coding could be applied to address these limitations, this method cannot deal with severe modification.Digital watermarking, compared with its pure cryptographic counterpart, can solve the aforementioned limitations to some extent. Protecting biometric images based on digital watermarking has been an active research focus. In [1], Jain–Uludag extended the amplitude modulation watermarking method for biometrics hiding. Majumder et al. proposed a method for embedding two watermarks into fingerprint images based on Discrete Cosine Transform(DCT) [2]. Joshi al. proposed a multilevel semi-fragile watermarking technique for improving fingerprint system security [3]. Al-Ani and Al-Baset [4] extracted the biometric features from the fingerprint images based on discrete wavelet transform(DWT), and embedded it into face images to guarantee the security of the biometric images. In Joshi et al. [5], the authors proposed a multiple reversible watermarking technique for fingerprint authentication in which two reversible watermarks are used to protect fingerprint images from the malicious manipulations. Recently, we proposed a method for tampering detection and self-recovery of face images based on the fragile self-recovery watermarking [6,7]. However, face images maybe suffer from incidental manipulation during transmission and storage, e.g., compression, noise, filtering, smoothing, etc. These manipulations which preserve image contents are thought to be permissible and acceptable. Semi-fragile watermarking scheme tolerates incidental manipulation, but is sensitive to malicious attacks. Besides tamper proofing for authentication of the image, recovering the tamper image is more attractive. Therefore, face image protection using semi-fragile self-recoverable watermarking scheme is a promising research focus.There is a trade-off between the amount of embedded watermarks and robustness for semi-fragile self-recoverable watermarking. If more watermark bits are embedded into host image, the localization accuracy and the quality of recover image are relatively high; otherwise, the robustness of the algorithm will be degraded. If we reduce the amount of embedding watermark bits, the localization accuracy and the quality of the recovered image cannot be guaranteed. The proposed semi-fragile self-recoverable watermarking methods can be found in [8–18], and they generate watermark from the thumbnail or the low frequency wavelet coefficients of the host image, which can reduce watermark embedding amount. For biometric images, there are a lot of redundant information, and can be further compressed. In this paper, we propose a novel semi-fragile self-recoverable watermarking scheme, and apply it for face image protection. The authentication watermarking is generated from SVD coefficients, and the information watermark is generated from PCA coefficients. Both of them are embedded into wavelet medium frequency coefficients by using the proposed group-based wavelet quantization method.The remainder of the paper is organized as follows: Section 2 demonstrates the flowchart of the proposed method; Section 3 describes the proposed semi-fragile self-recoverable watermarking scheme; Section 4 presents the experimental results and analysis; finally, Section 5 concludes.The general framework of the proposed method is illustrated in Fig. 1, and it consists of two parts: one is watermark generation and watermark embedding, the other is tamper detection and recovery. The proposed method generates two watermarks: authentication watermark and information watermark. Information watermark is generated from PCA coefficients. We segment the face region by face detection method [19], and extract its PCA coefficients, then generate the information watermark. In order to improve the robustness, we adopt the group-based wavelet quantization method to embed watermarks. And this process is shown in Fig. 2(a). During the tamper detection and recovery process, the generated watermark from an image block is compared with the extracted watermark from its corresponding image block. If they are not equal, the test image block is denoted as an invalid block. According to the tamper detection results, image blocks are classified into two classes: tampered and un-tampered blocks. We extract the information watermark bits from un-tampered image blocks and convert them into PCA coefficients, and then reconstruct the face image. The tamper detection and recovery process is shown in Fig. 2(b).The proposed watermarking scheme consists of three parts: watermark generation and embedding, tamper detection, and tamper recovery.In order to detect tamper and recover the damaged data, authentication watermark and information watermark are generated, and embedded into the host image. The details are presented as follows:•Information watermark generationFor an input face image, we segment the face region using face detection method and scale it to a given size, then calculate its Eigen-face coefficientsBm(m=1,2,…,T)by PCA, where T is the number of Eigen-face coefficients. An Eigen-face coefficient is converted to a binary stream with size of 16 bits, thus a face image with T PCA coefficients can be represented by a binary stream with size of 16 × T bits,used as information watermark. During the embedding process, two information bits are embedded into an image block. An input image with Nbimage blocks can be embedded into 2 × Nbbits. Therefore, we can embedP=⌊(2×Nb)/(16×T)⌋Eigen-face coefficients copies of a face image into (p × T × 16)/2 image blocks, and the restNb−(P×T×16)/2image blocks are embedded using ‘0’. The information watermark IW can be described asIW=bj1,bj2,…,bjP,0,0,…,0,j=1,2,…,16×T. If one or more copies tampered, we can recover the Eigen-face from the other copies.•Authentication watermark generationIn this paper, the authentication watermark is generated from the SVD coefficients of each image block, and it can be described as follows:Step 1.Image blocks division. The input image X with size M × N is divided into Nbnon-overlapping blocks Xiof 16 × 16 pixels.Singular value decomposition (SVD). Sixteen Eigenvalues λ can be generated by SVD for each image block.Eigenvalue sorting. We can get λ1 ≥ λ2 ≥ ⋅⋅⋅λ16, and select the first m eigenvalue to generate authentication watermark, in this paper, m is selected as 9.Eigenvalue quantization. To further reduce minor variations due to corrupting noise, the eigenvalue,λk,k=1,2,…,m, is quantized according to formula (1):(1)λ¯k=⌊λk/Q⌋where the positive integer Q denotes the number of quantization bins.λ¯i(k)stands for thekthcoefficient of theithimage block.Binary random matrix generation. To improve the security of the generation watermark, we generate random matrixAlk,l=1,2,3,k=1,2,…,musing secret key k1.For any image block Xi, we generate the 3-bits authentication watermarkwil,i=1,2,…,Nb,l=1,2,3from the m coefficients according to formula (2):(2)wil=Parity(∑n∈[0,m−1](Al(n)⊕Al(m−1)))·λ¯(n)))The bit wilis a 3-bits authentication watermark bit of the ith image block.Watermark encryptionFor an image block Xi, we generate 3-bits authentication watermark, and combine 2-bits information watermark to get a 5-bits watermark. In order to improve the security of the proposed method, the generated watermark is encrypted using secret key k2. A random sequence S ∈ {0, 1} is generated by utilizing the logistic chaotic map to encrypt the generated watermarks [20].We split the binary string into the sub-stringSi∈{si1,si2,…,si5},i=1,2,…,Nb. Exclusive-OR operation is used to encrypt information bits by using Eq. (3), and encrypted information bits are used as watermark bitsW={W1,W2,…,WNb}.(3)wi,j=Bij⊕Sijwhere 1 ≤ i ≤ Nb, 1 ≤ j ≤ 5.In order to resist vector quantization (VQ) codebook attack [21] and collage attack [22], we embed the watermark based on a block-chain structure. An indexI1,I2,…,INbis generated as a random position sequence using secret key k3 as described in [23], which is used to select the image block to be embedded. The watermark WI(i) generated from XI(i) is embedded into its next blockXI(i+1),the watermarkWI(i+1)generated fromXI(i+1)is embedded into its next blockXI(i+2),and so on.In order to improve the robustness of the proposed method, the 5-bits watermark is embedded into the peak value of medium frequency in DWT by our proposed group-based wavelet quantization embedding method in [10]. The embedding method is shown in Fig. 2, and can be described as follows:Step 1.We calculate the two-level wavelet coefficients of an image block Xiwith size 16 × 16.(4)DWT{Xi}={LL2i,HL2i,LH2i,HH2i,HL1i,LH1i,HH1i}Each image block has three groups of mid-frequency coefficients, including LH2, HL2, and HH2, in which the size of each group is 4 × 4. Three groups of 4 × 4 mid-frequency coefficients are converted into 16-dimension sequences. Thereafter, we concatenate the sequences into a single sequence IS with 48 coefficients.To enhance the security of the system against local attacks, the sequence IS is permuted as PS by using the secret key k4.The permuted sequence PS is divided into five sub-groups denoted asPS={PSk,k=1,2,…,5}. We adopt our proposed embedding method in [10], namely, the significant difference parity quantization (SDPQ) to embed one bit for each group.For each group k ∈ [1, 5], the significant difference, which refers to the difference of the largest and second largest valuemaxk−seckis modulated according to the watermark bit to be embedded. To embed a “0” or “1” bit watermark, the significant difference is modulated to an even or odd multiple of a quantization step Q . Δkdenotes the original significant difference value of group k, and wkis the corresponding watermark bit. Thus, the embedding procedure can be achieved by the following equations:(5)Δk′=2Q·[Δk+wkQ2Q]−wkQ(6)maxk′=maxk+(Δk′−Δk)where [ · ] is the round operator, andΔk′denotes the quantized significant difference.maxk′is the modulated maximum. Evidently, the upper bound of the modification on the local maximum is Q. The trade-off between fidelity and robustness can be controlled by changing the value of Q .The verification process contains the following steps:Step 1.The test image Y is split into image blocksYi,i=1,2,…,Nb,and watermarks are generated as described in the watermark generation process.AWI(i)*is generated from YI(i);AWI(i+1)*is generated fromYI(i+1),and so on.Two-level wavelet transform is performed for the test image blocks. The middle-frequency coefficients are used to extract watermarks. Each image block has three groups of 4 × 4 mid-frequency coefficients, including LH2, HL2, and HH2. These coefficients are converted into a 48-dimension vector. The sub-band coefficients are shuffled by using the secret key k4, and non-overlapped coefficients are regrouped into five sub-groups.For each coefficient sub-group k ∈ [1, 5], the significant differenceΔk′is computed, and the watermark bitwk′is decoded as the following:(7)wk′=mod{[Δk′Q],2}Therefore, for image blockYI(i+1), a 3-bits authentication watermarkEWI(i)′and a 2-bits information watermarkIWI(i+1)′are extracted. The extracted watermark is decrypted using secret key k2.After the aforementioned watermark generation and extraction, a detection indicator for each test image block is calculated as follows:(8)dI(i)={1,ifWI(i−1)*≠WI(i)′0,otherwiseA tamper detection masks,D={di1,i=1,2,…,Nb}can then be generated.Optimize D using 8-neighborhood characterization. The optimization equation is written as follows.(9)tI(i)={1,if(DI(i)1=1)&(mI(i)8≥mI(i+1)8))0,otherwisewheremI(i)8is the number “1” in the 8-neighborhood of DI(i). As shown in Eq. (9), the inconsistent block is marked as tampered if the block-neighborhood characterization is more than or equal to that of its mapping block. Otherwise, the inconsistent block is genuine.TD={tdi,i=1,2,…,Nb}is iteratively optimized by using eight-neighborhood characterization twice. The optimization equation can be written as follows:(10)tdi={1,if(ti=1&mi8≥3∥(ti=0&mi8≥5))0,otherwisewheremi8is the number of “1” in the eight-neighborhood of ti. The final detection result TD consists of all tdiis obtained.After tamper detection, all image blocks are marked as valid or invalid. The information watermarks are extracted from valid or invalid image block. If the watermarks are extracted from invalid image block, we set the extracted bits to ‘−1’, otherwise, keep unaltered. When all the information watermarks are extracted, the extracted watermarks are rearranged using random position sequence generated by using secret key k3. Then a binary sequenceIW′={bj1,bj2,…,bjP,0,0,…,0},j=1,2,…,16×Tis obtained. For each bit of PCA coefficient, we count the number of element which equals “1” amongbj1,bj2,…,bjP,j=1,2,…,16×T,represents ascj1. And we count the number of elements which equal ’0’, in the same way, and represents ascj0. And the bit-stream of eigen-face can be represented according to Eq. (11):(11)ej={0,ifcj0≥cj11,otherwiseThen, the binary sequenceb1,b2,…,b16×Tis divided into T sub-groups with length 16, and each of them can be converted into a PCA coefficient. Finally, the recovered PCA coefficientsB1′,B2′,…,BT′are obtained.

@&#CONCLUSIONS@&#
In this paper, we proposed a semi-fragile self-recoverable fragile watermarking scheme for face image protection. The main features of our method are summarized as follows: 1) PCA coefficients are used to generate information watermarks, thus it can reduce the amount of the embedding watermarks; 2) The embedding position is generated by a chaotic map. Thus, obtaining the information of the block-mapping sequence is difficult. This feature improves the security of the proposed method. Moreover, security is enhanced by randomly permuting coefficients among a group; 3) Watermarks are embedded into the mid-frequency bands by using our proposed SDPQ method. Therefore, robustness is enhanced by embedding the watermarks in the largest coefficient inside a group.We present the performance comparison of the proposed approach with semi-fragile self-recoverable watermarking scheme in [12,14,18] with respect to tamper detection, robustness to incidental manipulation, etc. Experimental comparisons with existing approaches validate the usefulness of the proposed self-recoverable semi-fragile watermarking approach.