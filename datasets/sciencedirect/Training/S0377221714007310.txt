@&#MAIN-TITLE@&#
Stochastic equilibrium assignment with variable demand: Theoretical and implementation issues

@&#HIGHLIGHTS@&#
Internal approach algorithms significantly outperform external approach ones.Internal algorithm efficiency is not affected by travel demand model parameters.Restarting technique significantly increases the MSA efficiency.Smoothing technique together with restarting technique let MSA-CA outperform MSA-FA.Non-separable and asymmetric arc cost functions do not much affect algorithms efficiency.

@&#KEYPHRASES@&#
Stochastic equilibrium assignment,Fixed-point model,Variable demand,Method of successive averages,Internal approach,

@&#ABSTRACT@&#
Recently, it has been pointed out that transport models should reflect all significant traveler choice behavior. In particular, trip generation, trip distribution, modal split as well as route choice should be modeled in a consistent process based on the equilibrium between transport supply and travel demand. In this paper a general fixed-point approach that allows dealing with multi-user stochastic equilibrium assignment with variable demand is presented. The main focus was on investigating the effectiveness of internal and external approaches and of different algorithmic specifications based on the method of successive averages within the internal approach. The vector demand function was assumed non-separable, non-symmetric cost functions were adopted and implementation issues, such updating step and convergence criterion, were investigated. In particular the aim was threefold: (i) compare the internal and the external approaches; (ii) investigate the effectiveness of different algorithmic specifications to solve the variable demand equilibrium assignment problem through the internal approach; (iii) investigate the incidence of the number of the links with non-separable and/or asymmetrical cost functions. The proposed analyses were carried out with respect to two real-scale urban networks regarding medium-size urban contexts in Italy.

@&#INTRODUCTION@&#
Assignment models play a central role in developing a complete model for a transportation system describing how demand and supply interact with each other. These models allow the calculation of performance measures and user flows for each supply element (network arc), resulting from origin-destination demand flows, path choice behavior, and the interactions between supply and demand. Their results, in turn, are the inputs for the design and/or evaluation of transportation projects.In congested networks the interaction between supply and demand can be modeled through two main approaches: dynamic process or equilibrium (steady-state). The former can rely on a quite consolidated theoretical framework but not on significant applications to real cases. The latter, much more consolidated in literature and applications, holds an important role in strategic planning (long term) and is the most pursued and robust solution to tactical planning (short term). Within-day dynamics, mainly used for control and real time management of a transportation system, will be not addressed in this paper.Most modeling approaches to the equilibrium between demand and supply assume that origin-destination demand flows are known hence path choice is the only behavior explicitly modeled. Such assignment models, known as assignment model with constant (rigid) demand, do not consider the role that some choice dimensions (such as trip production, and/or choice of departure time slice, destination, transport mode, parking type and area) may have on equilibrium configuration (and more broadly on the transport system evolution). In such a context, many government agencies and transport analysts (recently Smith, 2009; see also Commission for Integrated Transport, 2004; COMSIS, 1996; DfT, 2005) point out the need for assignment models with variable (elastic) demand since demand elasticity may be relevant for urban planning over a medium-long term horizon.Assignment with variable demand models supply–demand interaction when path costs due to congested arc costs affect user behavior other than path choice (such as the decision to travel, to which destination, by which mode, etc.). Although the topic has been investigated since the ’70, several theoretical and operational issues are still worth of further methodological and operational analyses. Most applications are mainly based on simple implementation of the external approach which solves a two-level problem where the circular dependence between demand flows and costs is expressed externally to the flow-cost equilibrium. The problem is usually addressed through heuristic methods, mostly on deterministic path choice behaviors, and/or other simplifying assumptions (see Section 2 for an analysis of the state of art). On the other hand, very few papers implement the internal approach which is founded on an extension of the constant demand equilibrium assignment problem.This paper presents a general fixed-point modeling framework, following the internal approach. It allows dealing with multi-user stochastic equilibrium assignment with variable demand. The approach pursued is general enough to be extended to every trip choice dimensions, to accommodate most existing demand models, even non-separable ones, and arc cost functions, even with non-symmetric Jacobian. Moreover, it allows easily defining conditions for solution existence and uniqueness, as well as analysis of algorithm convergence. To authors’ knowledge, existing fixed-point models (Cantarella, 1997) as well as variational inequality models (Meng, 2012, 2014) for SUE are available for separable demand functions only.The main focus was on investigating the effectiveness of internal and external approaches and of different algorithmic specifications within each approach to solve the variable demand equilibrium assignment problem. It is worth highlighting that the vector demand function is assumed non-separable, say the whole vector of demand flows depends on the whole vector of satisfaction variables. This way trip distribution models may also be considered together with mode split ones when the demand function is specified. In addition implementation issues, such updating step and convergence criterion, are discussed.In particular the aim was threefold.i)Compare the internal and the external approaches.The external approach searches the equilibrium between the demand flows resulting from the demand model, and the costs resulting from an equilibrium assignment with constant demand. Equilibrium between flows and costs is computed at the inner level for a given set of demand flows. The outer level computes equilibrium between the costs resulting from the inner level equilibrium assignment and demand flows obtained from demand functions. This approach is very common in practice, presumably since it can easily be implemented. In the internal approach the demand models are embedded within the network loading map, as described by the arc flow function (see Section 3).For both approaches different algorithms based on the MSA were implemented, and two averaging schemes were tested: on arc flows (FA) and on arc costs (CA). The comparisons were also carried out through a sensitivity analysis carried out with respect to trip production index, distribution model parameters, mode choice parameters and path choice model dispersion parameter. Such an analysis aimed to understand the robustness of algorithmic efficiency if links congestion changes due to a travel demand increase or due to change in its geographical or modal distribution.Investigate the effectiveness of different algorithmic specifications to solve the variable demand equilibrium assignment problem through the internal approach.In particular, the following solutions were tested: (i) two different restarting techniques in order to improve convergence speed for both averaging schemes; (ii) a different convergence criterion aimed to improve MSA-CA efficiency; (iii) a technique to smooth the effect of the step length which gets increasingly smaller.Finally, the incidence of the number of the links with non-separable and/or asymmetrical cost functions was investigated.The proposed analyses were carried out with respect to two real-scale urban networks regarding two Italian medium-size urban areas: Salerno (population 150,000) and Benevento (population 60,000). The travel demand was assumed variable up to the destination choice. Path choice, mode choice and destination choice were modeled through discrete choice models founded on the random utility theory and estimated (calibrated) through real data, leading to non-separable demand functions. It must be highlighted that the analyses were performed on two real case studies and not on any of the “test” networks usually adopted in most of existing contributions on traffic assignment (especially with constant demand). Indeed, it is the authors’ opinion that variable demand assignment should rely on real travel demand origin-destination information and on consistent/coherent travel demand models: (i) to rely on realistic demand models, (ii) to test/compare assignment results with the network realistic conditions; (iii) to carry out consistent sensitivity analyses. For simplicity's sake and a better analysis of path choice sets explicit path enumeration was adopted; still results can be easily transferred to more complex case studies without explicit path enumeration, as it will be shown in a future paper.The paper is organized as follows. In Section 2 an analysis of the state of art is carried out. Section 3 describes main definitions and notations, models, and algorithms, respectively. The operational framework is introduced in Section 4; results of applications to real-scale urban network are discussed in Section 5 to support comparison and to address main implementation issues. Section 6 reports the major findings and outlines some research perspectives.

@&#CONCLUSIONS@&#
