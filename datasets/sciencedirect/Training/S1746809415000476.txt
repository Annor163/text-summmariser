@&#MAIN-TITLE@&#
A hierarchical model for automated standard sagittal-view detection from 3D ultrasound data in 11–14 weeks

@&#HIGHLIGHTS@&#
A hierarchical model is proposed for automated standard sagittal-view detection from 3D ultrasound data.Hessian-matrix based filtering is applied for obtaining the plate-structure distribution.The sphere distribution is calculated by convolving sphere detectors with the ultrasound data.The sampling-based Hough transform is performed for the plane detection.

@&#KEYPHRASES@&#


@&#ABSTRACT@&#
The nuchal translucency thickness is an important parameter for the diagnosis of fetal abnormalities during 11–14 weeks. Currently in clinical practice, it first requires manual scanning operations to determine the fetal standard sagittal-view plane and then the measurements can be performed in the corresponding plane images. Besides the difficulty of such standard plane detection, this also leads to the time-consuming and detection-variability problems. In the paper, a hierarchical model is proposed to automatically detect the standard sagittal-view plane based on 3D ultrasound data. In the model, Hessian-matrix based filtering is first applied for obtaining the plate-structure distribution in the data. Then the sphere distribution is calculated by convolving sphere detectors with the ultrasound data. Based on the two prior distributions, the sampling-based Hough transform is further performed for the plane detection. The performance of the proposed model is verified by the experimental results on 3D synthetic data and 241 clinical 3D ultrasound data in 11–14 weeks.

@&#INTRODUCTION@&#
Ultrasound imaging is widely used in the diagnosis of fetuses due to its noninvasive nature, real time display, low cost and continuing image quality improvements. In ultrasound images, the nuchal translucency (NT) which is the accumulation of fluid in the nuchal region can be shown during the first trimester [1]. During 10–14 weeks of the gestation, a high proportion of fetuses with trisomies 13, 18 and 21 as well as Turner's syndrome and triploidies have ultra-sonographically detectable NT thickness of at least 3mm [2]. Even in the presence of a normal karyotype, a bigger value of the NT thickness is also associated with structural defects and genetic syndromes [3]. The NT thickness in the first trimester of pregnancy has proved to be one of the most important parameters [4].The NT thickness is defined as the maximum distance between the upper and lower high-intensity boundaries of the NT region in ultrasound images. Nowadays the measurement of the NT is usually carried out by doctors. Doctors first need to identify the standard sagittal-view plane during the scanning. Then in the image of the sagittal-view plane, the NT region should be further located and finally the NT thickness will be measured. These operations require highly skilled operators and are often time-consuming.Due to the low resolution and the complexity of NT ultrasound images, there are a few studies on the computerized measurement of the NT. Bernadino et al. proposed to use the Sobel operator to help doctors manually detect the border of the NT [5]. Lee et al. proposed a cost function to define the boundary of the NT [6,7]. The cost function consisted of the gradient part and the continuous part. Then the NT boundary was searched by the dynamic programming. Based on this work, Catanzariti et al. improved the performance by further modifying the cost function [8]. Nirmala et al. proposed a method using mean shift segmentation and canny-edge detection to measure the thickness of the NT [9]. All these methods mainly differ in the method of detecting the NT border, and require manually selecting the region of interest (ROI) in the standard sagittal-view plane image in which the NT thickness is measured. Such manual operation makes these methods semi-automated. It may also be time-consuming to some extent for doctors and lead to the variability of detected data due to doctor's experiences.The automated detection of the NT region can solve these problems. Wee et al. trained an artificial neural network to locate the NT region automatically [10]. In our previous work, a hierarchical model has been proposed for the automatic detection of the NT region [11]. However, it still requires doctor's manual identification of the standard sagittal-view plane to acquire the corresponding ultrasound images for NT measurements, which is also important for the entire protocol of NT measurement. Anzalone et al. proposed an approach to detect the sagittal-view plane based on the location of jawbone in video stream data [12]. Wee et al. proposed an interactive computerized approach to support the sagittal-view detection for NT measurements based on three-dimensional (3D) ultrasound data [13]. Since it requires manual interactions with operators, it is still a semi-automated approach. Carneiro et al. [14] proposed an automatic detection method using global/semi-local context and sequential sampling. Sofka et al. [15] proposed a method using sequential estimation and integrated detection network which can automatically detect the sagittal plane. However, both of the automatic detection methods are learning based methods aiming at 3D ultrasound data only containing the fetal head, while annotated 3D ultrasound volumes are used for training.In the paper, we propose a fully automated approach to perform the standard sagittal-view detection based on 3D ultrasound volume data. It is realized by introducing a hierarchical model for the problem, combining a plate structure filter and a sphere detector. The remainder of this paper is organized as follows. Section 2 describes the proposed model in details. In Section 3, the experimental results on synthetic 3D data and 241 clinical fetal 3D ultrasound data are presented. Finally conclusions are drawn in Section 4.The problem is to detect a required plane in the 3D fetal data. The standard sagittal-view plane for NT measurement should be the plane that contains the brain midline region which is a plate structure in the 3D data space [16]. Since it is in the midline region, the fetal head skull should be symmetric referring to the standard sagittal-view plane. Meanwhile, since the structure of fetal head skull could be considered as consisting of several spheres, the standard sagittal-view plane should be the plane that contains the centers of the spheres. Based on these recognitions, the standard sagittal-view detection problem can be considered as finding the plane which should satisfy the above recognitions simultaneously with the probability as high as possible.Such recognition process can be considered as maximizing the joint probability p(Xplane, Xplate, Xsphere|I), where Xplane, Xplate and Xsphere represent the possible plane, the plate structure and the sphere centers, respectively, given the 3D ultrasound data I and are the functions of related location parameters. According to this, we establish a hierarchical model for the standard sagittal-view plane detection as shown as Fig. 1. This graphical model represents the way of the cognitive process. When given a 3D fetal ultrasound data, the standard sagittal-view plane first should possess the plate structure. Meanwhile, the fetal head provide the important structure information that the standard sagittal-view plane should be in the middle of it, which can be translated and considered as containing the centers of the spheres that consist of the fetal head. Considering both of these conditions simultaneously, a plane is further searched and the one with the highest probability is found as the expected sagittal-view plane.Based the graphical model, the joint probability can be further factorized as(1)pXplane,Xplate,XsphereI=pXplateI⋅pXsphereI⋅pXplaneXplate,Xsphere,Iwherep(XplateI)andp(XsphereI)denote the distributions of the plate structure and the sphere structure in the data, respectively.p(XplaneXplate,XsphereI)is the conditional probability that represents the plane search based on the information of plate and sphere structure distributions.By inferring from the hierarchical model based on Eq. (1), an automated approach is proposed in the paper for the standard sagittal-view detection. First, the Hessian-matrix based filtering is performed, which emphasizes the plate structure and the distribution of plate structure is obtained. Then, the sphere distribution is obtained by convolving the proposed sphere detectors with the 3D ultrasound data. By calculating the joint distribution of the two independent distributions, the sampling-based Hough transform is finally applied for the plane detection.According to the proposed hierarchical model, the plate structure filtering is first performed based on the Hessian matrix method [17].A Hessian matrix in 3D space is defined as(2)HI=∂2I∂x2∂2I∂x∂y∂2I∂x∂z∂2I∂y∂x∂2I∂y2∂2I∂y∂z∂2I∂z∂x∂2I∂z∂y∂2I∂z2where I(x, y, z) denotes the data in the coordinates. H(I) is the obtained Hessian matrix which represents the second order local structure of the 3D data. It has been proven that the eigenvalues of the Hessian matrix at one position are related with the local structure shape. Assuming the calculated eigenvalues has the order of λ1≤λ2≤λ3, λ1 and λ2 should have small values and λ3 should have a relatively high value for a plate structure [17].Based on the patterns of different eigenvalues in [17], a function V(cor) referred to [17] is proposed to emphasize the plate structure as following:(3)Vcor=0ifλ3<0(1−e−R12cor/2α2)⋅e−R22cor/2β2⋅(1−e−S2cor/2c2)where cor denotes the coordinates (x,y, z) in the 3D data space. R1 is defined as|λ1|/|λ2|for which if it has a relatively large value, the tubular structure can be excluded and the first term1−eR12cor/2α2would have a value tending to 1. R2 is defined as|λ1|⋅|λ2|/|λ3|for which if it has a relatively small value, the second terme−R22cor/2β2would have a value tending to 1 except the value for a blob structure. S is defined asλ12+λ22+λ32which is as the same as [17] and the high value of1−eS2cor/2c2would emphasize the structure information in the data space. α, β and c are the thresholds which control the sensitivity of the plate structure filtering.It can be seen that a higher value of V(cor) denotes a higher probability of being plate structure at one location of 3D data. Therefore, the normalized V may represent the plate structure distribution for one data.It should be noted that ultrasound data are characterized by granular patterns of abrupt changes of pixel values known as speckle [18], which is considered as the major source of contamination in ultrasound data [19]. To overcome the impact of speckle, the plate structure filtering is performed within a multi-scale approach [17] according to the data settings. For each pixel, the highest filter response of all the scales is used and normalized as the filtered result which represents the distribution of plate structurep(XplateI).To detect the sphere structure in the data, it is required to establish the corresponding detectors. Considering the size of fetal heads at 11–14 weeks and the intervals of ultrasound imaging, several 3D spheres are established with certain diameters as following,(4)Spherei(cor)=0cor−corcenter2≠Diameteri1cor−corcenter2=Diameteriwhere Diameteridenotes the diameter of the ith sphere Spherei. cor denotes the coordinates (x, y, z) in the 3D data space and corcenter is the coordinates of center in the established sphere volume. The voxels of the spherical surfaces are with the intensity of one and other voxels are with the intensity of zero. The setting of multiple spheres with different diameters is to handle the uncertainty of the fetal head size during 11–14 weeks and overcome the scale problem.With one established sphere Spherei, the corresponding sphere detector SDiis further established by convolving it with a 3D Gaussian distribution as following,(5)SDi=Spherei⊗GaussianKernelwhere ⊗ is the operation of convolution. GaussianKernel is with the form of1σ2πe−1/2cor−μ/σ2where σ is the standard deviation and μ denotes the coordinates of the center of the kernel volume. Such Gaussian processing may enhance the robustness of the sphere detectors.For one 3D ultrasound data, established sphere detectors are applied to convolve with it. For each voxel, the highest filter response of different sphere detecting results is recorded as the response of the voxel. For the whole 3D data, voxel responses are further normalized and the result may represent the sphere structure distributionp(XsphereI).With the sphere structure distributionp(XsphereI), the probabilities at different locations are correspondingly multiplied with the probabilities of the plate structure distributionp(XplateI). The result denotesp(XplateI)⋅p(XsphereI)in Eq. (1). For the inference of the proposed hierarchical model, the following processing is to infer the plane shape asp(XplaneXplate)⋅p(XsphereI), which causally represents the standard sagittal-view plane.Hough transform is one method that may infer the shape from a set of data points. The conventional Hough transform has the dilemma of the bin number and the limitation of data points. In Ref. [17], the mean shift method is used for Hough transform which could overcome the problem. Based onp(XplateI)⋅p(XsphereI), the sampling-based Hough transform is proposed for the standard sagittal-view plane detection.Based on the multiplied probability distribution, three points in its 3D space are randomly sampled each time for constructing a plane which is defined as following:(6)z=ax+by+cwhere (x, y, z) denotes the coordinates in the 3D space and a, b and c are the plane parameters which define the Hough space. It can be seen that the sampling processing may represent the prior knowledge of the plate and sphere structure distributions.The corresponding point (a, b, c) in the Hough space for the sampled three points is defined as following:(7)x1y11x2y21x3y31⋅abc=z1z2z3where (xi, yi, zi) denotes the coordinates of the ith sampled point. The solution for (a, b, c) can be conveniently obtained by a closed form with the following equation,(8)abc=ATA−1ATBwhere A is defined asx1y11x2y21x3y31and B is defined asz1z2z3. The three sampled points in the 3D space should not be in one line, which guarantees the invertibility of the matrix ATA.Based on the sampling procedure, the points in the Hough space are generated. For the following processing, the plane detection is equal to locate the position which has the largest density of points in the Hough space. In our work, the mean shift method is applied for such search [20]. One seed point is first randomly picked up and the mean position of the points around the seed point is calculated with a flat kernel. The calculated mean position is used as the new seed point. Then updating the mean position is continuously performed until the algorithm converges and one candidate for the search can be obtained. By removing the already visited points in the Hough space, the search processing is continuous for further candidates until the number of the remained unvisited points is less than a preset threshold.Among all the searched candidates, the one with the largest point density is selected and the corresponding plane in the 3D space can be reconstructed to represent the detected standard sagittal-view plane.

@&#CONCLUSIONS@&#
