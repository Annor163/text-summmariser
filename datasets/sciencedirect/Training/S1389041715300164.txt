@&#MAIN-TITLE@&#
Simulation within simulation for agent decision-making: Theoretical foundations from cognitive science to operational computer model

@&#HIGHLIGHTS@&#
Generic computational model of mental simulation.The architecture proposes three modes – reactivity, predictability, and adaptability.First illustration shows a dog making predictions and testing different strategies.Second illustration is a 3D juggler plays with virtual jugglers, humans and robots.

@&#KEYPHRASES@&#
Decision-making,Internal simulation,Behavioral simulation,Autonomous behavior,Virtual reality,

@&#ABSTRACT@&#
This article deals with artificial intelligence models inspired from cognitive science. The scope of this paper is the simulation of the decision-making process for virtual entities. The theoretical framework consists of concepts from the use of internal behavioral simulation for human decision-making. Inspired from such cognitive concepts, the contribution consists in a computational framework that enables a virtual entity to possess an autonomous world of simulation within the simulation. It can simulate itself (using its own model of behavior) and simulate its environment (using its representation of other entities). The entity has the ability to anticipate using internal simulations, in complex environments where it would be extremely difficult to use formal proof methods. Comparing the prediction and the original simulation, its predictive models are improved through a learning process. Illustrations of this model are provided through two implementations. First illustration is an example showing a shepherd, his herd and dogs. The dog simulates the sheep’s behavior in order to make predictions testing different strategies. Second, an artificial 3D juggler plays in interaction with virtual jugglers, humans and robots. For this application, the juggler predicts the behavior of balls in the air and uses prediction to coordinate its behavior in order to juggle.

@&#INTRODUCTION@&#
For many years, researchers have tended to create virtual environments that provide the opportunity for a human to evolve while interacting with virtual entities. For these virtual worlds to be believable, each entity controlled by the computer must exhibit a behavior giving the illusion of being controlled by another human. This raises the following question: how can an entity be equipped with believable autonomous behavior in a complex virtual environment in which humans participate?Traditional symbolic artificial intelligence techniques have been applied to define these behaviors. However, these techniques have limitations as they are mainly based on predetermined rules of behavior chosen by the designer. Indeed, in complex (open simulation, heterogeneous and participatory) virtual worlds, entities may have unpredictable behavior (behavioral variability of autonomous entities, free will of human users), thus creating new situations. When faced with situations unforeseen by the programmer, entities may display unsuitable behaviors.In this paper, virtual entities are considered at the same level as human, by integrating human characteristics that are currently lacking in existing artificial intelligence mechanisms. To address this issue, we were inspired by ideas and concepts from cognitive science in defining human decision-making. More precisely, our focus is on finding a computational approach to reproduce adaptive behavior in an intelligent agent, inspired from the human’s anticipation ability and capacity to adapt while interacting. We will then be able to examine the use of such concepts into an artificial entity’s decision-making process.This paper is organized as follows. After presenting the concepts from cognitive science which highlight simulation as being an essential aspect of cognition and from which the presented approach is inspired, Section 2 analyzes related works in computational models. Although studies from cognitive science suggest that mental simulation is central to decision making and arguably other important aspects of reasoning, existing approaches do not offer a generic computational model of this paradigm.To address this issue, in this paper we present a generic computational model of mental simulation. Thus Section 3 describes a conceptual framework where the entity possesses an autonomous world of simulation within the simulation. In this internal world, the entity is able to simulate itself (using its own model of behavior) and also simulate its environment (using its representation of other entities). The entity also has the ability to anticipate and to learn using internal simulations. In our previous works, the concept of internal simulation has been studied, for test purposes, in two applications described in previous publications (Buche, Chevaillier, Nédélec, Parenthoën, & Tisseau, 2010; Buche & De Loor, 2013; Buche, Jeannin-Girardon, & De Loor, 2011). These applications illustrated the applicability of mental simulation paradigm to decision-making, but connections between decision/anticipation/learning were ad hoc for each specific application and required complete architectural modifications to be applied to a new domain.To test the genericity of the computational model, we have reused these examples in Section 4. The key idea is to show that it is possible, using our architecture, to switch from one domain to the other without making changes to processes binding decision/anticipation/learning. First, we illustrate our approach through an example that simulates dogs gathering sheep. To simulate sheep behavior, the dog uses fuzzy cognitive maps (FCM) of prey. The dog can therefore simulate the sheep’s motion in order to make predictions and to test different strategies. Without changing the architecture, we illustrate our proposal by an artificial 3D juggler playing with virtual jugglers, humans and robots. For this application, the juggler predicts the behavior of balls in the air and coordinates its own behavior accordingly, in order to juggle. The virtual juggler uses neural networks to simulate ball motion. The proposed architecture allows the agent to adapt to changes introduced by adding other agents and human users to launch balls that the virtual juggler can catch while juggling, which was not the case in the original application described in Buche and De Loor (2013). Without changing the architecture, we were able to switch from FCMs to neural networks as a controller for the prediction process. Finally, Section 5 concludes and introduces future work.There is a growing body of literature in cognitive science advocating the simulation process as being central in cognition (Decety & Grèzes, 2006; Hesslow, 2002, 2012; Pezzulo, Candidi, Dindo, & Barca, 2013). Contrary to the classical cognitive approach, in these simulative theories, perceptual, cognitive and motor process are not considered as being part of separate domains but rather that sensorimotor processes are fundamental to cognitive activities.Despite different views of the concept of simulation, one central common point is that simulation corresponds to the reactivation of actions that were formerly executed and stored in memory (Decety & Grèzes, 2006). For example, in his simulation theory (ST), Hesslow (2012) proposed three main assumptions: (1) simulation of action, (2) simulation of perception and (3) anticipation.The simulation of action (1) implies that brain areas recruited when performing an action are similar to the ones activated when covertly (i.e., when the action is not executed) reactivating the action. In this way, one can consider that a simulated action corresponds to an unexecuted action. The second statement (2) means that perceptual activity may occur in absence of external stimuli. Like during the simulation of action, activation in the brain is similar when perceiving external information and when imaging perceiving this information. Finally (3), Hesslow (2012) proposed the existence of some associative mechanisms allowing both behavioral and perceptual activity that could produce activation in the sensory areas of the brain. The direct consequence is the possibility to generate perceptual activation from simulated action similarly to obtaining this activation from the actual execution of the real action.In sum, one can simulate both action and perception. When doing so, the recruited brain areas are the same as the ones activated when actually performing the action or actually perceiving external information. Moreover, action simulation can elicit perceptual activity similar to the one which would have occurred if the action were actually performed. The benefit of this anticipation mechanism is twofold. First, one can be prepared to respond to the consequence of one’s own action. Second, one can evaluate in advance the consequence of an action and thus select the most appropriate behavior to achieve the indented goal (Hesslow, 2002; Pezzulo et al., 2013).The simulation theories are not limited to studying how humans deal with their own actions but they extend to the social domain by taking into account how individuals process other’s behavior. The proposition here is that, when observing others acting, one would simulate oneself performing the action (Berthoz, 1997; Jeannerod, 1994). This idea has been reinforced by the discovery, in monkeys, of mirrors neurons which are sensorimotor neurons that fire both when an action is performed and when the same action is observed to be executed by someone else (Rizzolatti, Fadiga, Gallese, & Fogassi, 1996). Since, several observations have supported the existence of a Mirror Neuron System in humans, with shared neural substrates for action identification and action execution ((Rizzolatti & Craighero, 2004) for a review).Simulating the actions of others would contribute to understanding and anticipating their consequences (Gallese & Goldman, 1998). It has also been proposed that these simulation mechanisms would be significantly involved in more general and higher level social cognition and possibly underlie the capacity of inferring mental states of others, known as Theory of Mind (Gallese & Goldman, 1998; Goldman, 2002). According to the simulation theory (Goldman, 2002, 2005), in order to attribute mental states to others we have to use our own mental mechanisms. In other words, in order to read others’ minds, we have to adopt their perspective.Cognitive science research has also studied how people use simulation mentally represent mechanical systems Hegarty (2004) and reason about how they evolve. Moreover, it has been suggested that there exists a common network in the brain that is responsible for episodic memory, navigation, theory of mind and prospection abilities in humans Buckner and Carroll (2007).To sum up this section, several propositions in the cognitive science domain consider simulation as a fundamental process of cognition. Through simulation, the brain can anticipate events in the environment, either if they are a consequence of its own action or another’s behavior. Thus, simulation mechanisms allow individuals to anticipate future events, so that they can adjust to their ever changing environment. Following this conception, the focus of our work is to study how internal simulation can enable a virtual agent to adapt to the dynamics of its environment.An analysis of state of the art computational approaches to internal simulation is provided in the following section. The conclusions of this study allows us to then sketch a conceptual framework which is arguably able to encompass the results of previous approaches and provide a more generic computational solution for building internal simulation based agents. For clarity and tractability, the test scenarios used in this work are considerably simpler than real world human abilities such as reasoning about other people’s beliefs and desires, but still preserve highly dynamic behavior, where we evaluate our agents’ ability to adapt.Computational applications of mental simulation are relatively recent and limited to specific scenarios. Results have been obtained by complementing existing systems with prediction and viewpoint adoption capabilities in contexts such as navigation (Bongard, Zykov, & Lipson, 2006; Kennedy, Bugajska, Harrison, & Trafton, 2009; Svensson, Morse, & Ziemke, 2009), sensory integration (Cassimatis, Trafton, Bugajska, & Schultz, 2004), object manipulation (Roy, yuh Hsiao, & Mavridis, 2004; Kunze, Dolha, Guzman, & Beetz, 2011), human-agent interaction (Breazeal, Gray, & Berlin, 2009; Buchsbaum, Blumberg, Breazeal, & Meltzoff, 2005) and goal recognition (Gray & Breazeal, 2005; Rao, Shon, & Meltzoff, 2004), which indicate that mental simulation is advantageous over traditional techniques in these chosen scenarios.In Polceanu and Buche (2013a), we have examined related works in various contexts of using mental simulation for decision-making. Two main directions that can be distinguished in simulation-based approaches to artificial decision-making, anticipation and learning (cf Table 1):1.Behavioral internal simulation: predict the consequences of actions on behavior to infer knowledge about othersEnvironmental internal simulation: predict the consequences of actions on the physical environment (for example, in the case of a domino scenario, the use of mental simulation would allow the agent to anticipate different sequences of falling pieces)Taken together, these existing approaches cover all areas of interest in using mental simulation as an anticipation and decision-making technique, however there exists no implementation that addresses all of them on its own. The majority of implementations have begun in virtual reality (Buche & De Loor, 2013; Kunze et al., 2011; Polceanu & Buche, 2013b; Svensson et al., 2009), but fewer have taken the leap to robotic embodiments due to dependencies on specific information about their environment. Those that do however pass into the real world (Cassimatis et al., 2004; Kober, Glisson, & Mistry, 2012; Roy et al., 2004) are either limited in the actions they can perform or rely heavily on repositories of actions that are abstracted for the use within a higher-level framework.Focus is placed on solving only a subset of the cognitive functions associated with mental simulation, and this is done using specific models of the task at hand. Hence, not many elements are taken into account into mental simulation, for example anticipating trajectories but not collisions (Breazeal et al., 2009; Cassimatis et al., 2004; Kennedy, Bugajska, Adams, Schultz, & Trafton, 2008; Kennedy et al., 2009; Svensson et al., 2009; Ustun & Smith, 2008), or focusing on only one of the environmental and behavioral aspects of the environment, although they are generally interdependent.To conclude, current approaches are constrained to function in relatively specific setups, far away from a generic perspective. Although approaches exist that function in real time, online learning is used only for specific tasks. The mechanism of the simulation paradigm, such as continuous imagination-reality comparison in complex environments and imaginative behavior, are not yet fully exploited.To overcome these shortcomings, in the next section we present a generic framework to model virtual entities that are able to use internal simulation paradigm to anticipate, learn, take decisions and act in dynamic environments where the agent’s actions can be influenced or interrupted by other agents or humans.Our proposal is based on the theory of internal simulation. The idea is to use this concept as the mechanism to control a virtual entity with the ability to predict and learn. In this section, we first propose a generic framework to model virtual entities (Section 3.1). Constraints and methods regarding the implementation will be discussed afterwards (Section 3.2).Following the reasoning expressed in previous sections, we represent three modes to model virtual actor, as follows:1.Reactive mode evolving in the virtual world (Section 3.1.1);Prediction mode evolving in the imaginary world (Section 3.1.2);Learning mode evolving in the abstract world (Section 3.1.3).A virtual world is a classical simulation with autonomous entities evolving in interaction. A virtual actor is an agent with sensors for perceiving, effectors for acting and a behavioral model to perform decision-making.While acting within the virtual world, each entity can make predictions in its imaginary world. This process consists in simulating the entity’s own behavior (with its own behavioral model), and that of the environment it inhabits (using the representation that it has of the behavior of other entities). This simulation occurs a phase ahead of the original simulation, enabling the entities to make predictions. This imaginary space, unique to each entity, functions in parallel with its activity within the virtual world, asynchronously so as not to block the behavioral animation. This imaginary world is a universe of simulation within the simulation (Fig. 1).Prediction in the imaginary world implies a representation of the external world and of its dynamic. To obtain this representation can be a hard challenge because a world adapted to this approach is open: unpredictable interactions can appear at any time and thus the dynamic properties can be disturbed. So, learning mechanisms are a good way to learn the dynamics of the world. In our proposal, predictions in the imaginary world are improved by observing the virtual world online. The virtual actor will then modify its representations of other entities using a learning mechanism. It must be noted that this observed world can also be populated with other actors, or with human-controlled avatars (Stoffregen, Gorday, Sheng, & Flynn, 1999). Similarly, for the approach to be generic, it is important for the control of the behavioral model to be independent of the learning mechanism, so that the model might be piloted by any decisional mechanism. The development of learning adds an entirely new dimension to our model.In the examples given within this work, virtual entities evolve in a virtual world (first dimension: the virtual world), simulate the representation of behaviors in an imaginary world (second dimension: the imaginary world), and adapt the representation of behaviors through learning (third dimension: the abstract world). The challenge here is therefore to identify the three dimensions and to understand their interactions (Fig. 2). The three worlds evolve in parallel and correspond to three different levels of abstraction. Nevertheless, they are all related and share information. The virtual world provides the necessary information to the imaginary world in order to simulate an approximate representation of the virtual world. Furthermore, it provides the abstract world with data for adapting its models. The imaginary world feeds back information, particularly concerning the choice of strategies or predictions.

@&#CONCLUSIONS@&#
