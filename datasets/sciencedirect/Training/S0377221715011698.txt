@&#MAIN-TITLE@&#
Forecasting day-ahead electricity load using a multiple equation time series approach

@&#HIGHLIGHTS@&#
A multiple equation time series model is built to forecast electricity load.Interactions in seasonal patterns are given special prominence.The model is easily estimated by repeated application of ordinary least squares.The model achieves a mean absolute percentage error of 1.36% in day-ahead forecasting over 11 years.Forecasts outperform the industry standard by about a third.

@&#KEYPHRASES@&#
Short-term load forecasting,Modelling seasonality,Intra-day load correlation,

@&#ABSTRACT@&#
The quality of short-term electricity load forecasting is crucial to the operation and trading activities of market participants in an electricity market. In this paper, it is shown that a multiple equation time-series model, which is estimated by repeated application of ordinary least squares, has the potential to match or even outperform more complex nonlinear and nonparametric forecasting models. The key ingredient of the success of this simple model is the effective use of lagged information by allowing for interaction between seasonal patterns and intra-day dependencies. Although the model is built using data for the Queensland region of Australia, the method is completely generic and applicable to any load forecasting problem. The model’s forecasting ability is assessed by means of the mean absolute percentage error (MAPE). For day-ahead forecast, the MAPE returned by the model over a period of 11 years is an impressive 1.36%. The forecast accuracy of the model is compared with a number of benchmarks including three popular alternatives and one industrial standard reported by the Australia Energy Market Operator (AEMO). The performance of the model developed in this paper is superior to all benchmarks and outperforms the AEMO forecasts by about a third in terms of the MAPE criterion.

@&#INTRODUCTION@&#
The national electricity market (NEM) in Australia, introduced in December 1998, operates one of the worlds largest interconnected power systems which comprise five regions, namely New South Wales, Victoria, Queensland, South Australia and Tasmania. The focus of this paper is short-term pre-dispatch (up to 24 hours ahead) load forecasts for the Queensland region of the NEM, using half hourly data for the period from 12 July 1999 to 27 November 2013. The reasons for the importance of accurate short-term load forecasting differ for each of the players in the market. From the perspective of the market operator (NEM), forecasting is crucial to the scheduling and dispatch of generation capacity; for the electricity generators, the strategic choices involved in bidding and rebidding of capacity depend critically on load forecasts; and for the electricity retailers, load forecasting affects decisions about the balance between hedging and spot acquisition of electricity. For these reasons, short-term load forecasting remains a problem of central interest and one which has generated a large literature.Statistical models for short-term load forecasting fall very naturally into three main categories. First, single equation time series models model the trajectory of load using traditional time series methods (Amaral, Souza, & Stevenson, 2008; Darbellay & Slama, 2000; Hagan & Behr, 1987; Hahn, Meyer-Nieberg, & Pickl, 2009; Pedregal & Young, 2008; Taylor, 2003). The efficacy of this approach derives from the strong seasonal patterns in electricity load. Second, semi-, or non-parametric methods which emphasise the non-linearity of load (Amjady, 2006, 2007; Fan & Hyndman, 2012; Hippert, Pedreira, & Souza, 2001; Park, El-Sharkawi, Marks, Atlas, & Damborg, 1991; Zhang, Eddy Patuwo, & Hu, 1998). Third, multiple equation time series models have enjoyed some popularity in the literature but their influence has waned in recent years. In this approach, each period of the day (usually each half hour or hour) is treated as a separate forecasting problem with its own equation (Espinoza, Joye, Belmans, & De Moor, 2005; Peirson & Henley, 1994; Ramanathan, Engle, Granger, Vahid-Araghi, & Brace, 1997; Soares & Medeiros, 2008).The central aim of this paper is to demonstrate that the multiple equation approach has the potential to achieve a very competitive forecast accuracy. The major advantage of the proposed approach is that the model remains linear in parameters, so that ordinary least squares can be used to estimate the parameters of the model and traditional test may be used to assess the significance of the explanatory variables. The seminal paper on the multiple equation approach to load forecasting is that of Ramanathan et al. (1997) in which the advantage of the multiple equation approach was first demonstrated in the context of the Californian electricity market. In the Australian electricity market, a Bayesian approach is employed by Cottet and Smith (2003) to a multiple equation model in a case study of the regional market of New South Wales. Perhaps the most insightful multiple equation model is that of Cancelo, Espasa, and Grafe (2008) who build a model of load in the Spanish electricity market.What distinguishes the proposed model in this paper from its predecessors in the multiple equation time series tradition is the way in which the daily and weekly patterns in electricity load interact and also the recognition of the importance of intra-day correlation in load. It turns out that allowing for a distinct weekly pattern in the coefficients governing one-day lagged load is a crucial advance on previous work. The efficacy of this innovation in dealing with seasonality is demonstrated by comparison with two traditional ways of dealing with seasonality, namely the double seasonal ARIMA (Taylor & McSharry, 2007) and the double seasonal Holt-Winters exponential smoothing approach (Gould et al., 2008). After these refinements are incorporated into the final preferred multiple equation model, its superior forecast performance is demonstrated by comparison with the multiple equation model of Cancelo et al. (2008) and the semi-parametric approach used by AEMO.Fig. 1 , plots the average half-hourly load over a day and average half-hourly load over the period of a week using Queensland data with the average taken over the entire sample period from 12 July 1999 to 27 November 2013. Diurnal and weekly patterns, both well documented features of electricity load (Engle, Granger, & Hallman, 1989; Harvey & Koopman, 1993; Taylor, 2010), are clearly evident.Load picks up very quickly between the hours of 06:00 and 08:00 from the overnight low and remains high during the daylight hours. The daily peak in the load profile usually occurs at 18:00 before tailing off once more. The weekly pattern in load is also quite pronounced with a regular load profile evident from Monday through Thursday, but with significant differences on Friday, Saturday and Sunday. While it is tempting to seek to model the trajectory of load making use of these well defined features, in fact this turns out to be a sub-optimal strategy. The averaging process involved in computing the quantities in Fig. 1 smooths out much of the half-hourly variation in load and it is this variation that a good forecasting model must capture.A structure that captures half-hourly variability in load and respects the features of the load profile in Fig. 1 is one in which each half hour is modelled separately. Let the logarithm of the load at half hour h and day d be given by Lhd, then, the ARMA structure of the prototype model for a given half hour period isLhd=θh0+θh1Lhd−1+θh2Lhd−7+ϕh1ɛhd−1+ϕh2ɛhd−7+ɛhd,in whichh=1,…,48and εhdis the disturbance term. So for each half-hour, h, the parameters are estimated based on a subset of the data which only contains the observations for that half-hour interval. In this way, the partial correlation between load and lagged load is allowed to differ in a daily pattern by the different parameter values across equations. A minimal lag structure requires Lhdto be explained by load in the same half hour on the previous day,Lhd−1and the load in the same half hour of the same day in the previous week,Lhd−7. For the same reasoning, the unexpected changes in load in the same half hour on the previous day,ɛhd−1and the previous week,ɛhd−7,are included.It is important to factor in the effects of public holidays into the load forecasting equation, something which is accomplished quite parsimoniously using dummy variables following Cottet and Smith (2003) and Espinoza et al. (2005). To economise on the number of parameters to be estimated, these special days are categorised into six distinct groups. Good Friday, Easter Monday, Christmas Day and New years are the four unique special days. The remaining two groups are a local Brisbane (the capital city of Queensland) only holiday and all the single day public holidays.It is a well established fact that load is related to temperature. There is also some evidence to suggest that the response of load to temperature is nonlinear in nature and the challenge is to model this nonlinear response but at the same time maintain a model specification that is linear in parameters. A piecewise linear specification following Cancelo et al. (2008) is adopted with linear responses in four different temperature ranges: 9–15 degree centigrade, 9–20 degree centigrade, 22–26 degree centigrade and 22–30 degree centigrade. Temperatures between 20 degree centigrade and 22 degree centigrade are regarded as comfortable and having no extra effect on load. Also the temperatures beyond 9 degree centigrade and 30 degree centigrade are also treated as having no extra effect since the demand is ultimately limited by the capacity of temperature controlling devices, an effect termed as exhaustion. If temperature in half hour h on day d is denoted by Thd, then to implement the piecewise linear specification four variables must be constructed which represent the changes in the relevant temperature ranges. For the cooling degree temperature ranges the following two variables are defined:C1hd={0Thd≤22Thd−2222<Thd≤3030−2230<Thd,C2hd={0Thd≤26Thd−2626<Thd≤3030−2630<Thd.Similarly, for the heating degree temperature ranges, another two variables are defined:H1hd={015≤Thd15−Thd9≤Thd<1515−9Thd<9,H2hd={020≤Thd20−Thd9≤Thd<2020−9Thd<9.These variables together admit a piecewise linear response of load to temperature, which is similar in spirit to the flexible spline method used by Harvey and Koopman (1993). While not reported here, the piecewise linear fit appears almost identical to a nonparametric kernel regression of the conditional expectation of load given temperature. The advantage of the piecewise linear specification is that it accommodates nonlinearity but does so within a model that remains linear in parameters. Experiments with different combinations of knots for specifying the temperature variables were tried, but discarded in favour of the current specification.Incorporating the special days and temperature variables into the model yields the baseline model against which all the refinements in later sections will be judged. The model is(1)Lhd=θh0+θh1Lhd−1+θh2Lhd−7+ϕh1ɛhd−1+ϕh2ɛhd−7+fhdS+fhdT+ɛhd,(2)fhdS=∑j=16(αjh1Sjhd+αjh2Sjhd−1),(3)fhdT=∑k=12(βkh1Hkhd+βkh2Ckhd+βkh3Hkhd−1+βkh4Ckhd−1),wherefhdSandfhdTare the special day and temperature effects respectively,Sjhdis the jth type of special day at half-hour interval h of day d. Following Ramanathan et al. (1997), the effect of one day lagged special days,Sjhd−1,is also considered. The reasoning is that when the load on special days (which is typically lower than on a normal day) is used as one day lagged load,Lhd−1,to infer load on normal days, the effect can be suitably adjusted. This adjustment is found to be significant and is therefore maintained. The effect of one week lagged special holidays is also investigated but discounted because the improvement was found to be insignificant.In this section two extensions to the prototype model in (1) are proposed. The first extension addresses the important interaction between daily and weekly load patterns, and the second deals with intra-day load dependency by treating the equations as a recursive system.Although the design of the lag structure in Eq. (1) is based on the observed load profile, it does not completely capture its seasonal features in that load during Saturdays and Sundays is significantly over-predicted (negative bias in the errors). This stems from the fact that the generally higher load on a weekday is being used as one-day lagged load in generating the forecast for weekends. Similarly, when Sunday load is used in generating the forecast for Monday, significant under-prediction occurs (positive bias in the errors). Essentially this bias is due to the fact that the coefficients on one-day lagged load do not differentiate between days of the week. A simple way to deal with this issue is to interact the one-day lagged load with day-of-the-week dummy variables,Wdp,p=1,…,7. Attempts to reduce the number of dummy variables in the specification, for example by using one for weekdays and one for weekends, or defining the dummy variables in terms of whether the day before and after is a weekday or in weekend, produced inferior results.It is also possible that there is an annual pattern in the load, despite the sub-tropical nature of the Queensland climate. Similar to the treatment of the weekly pattern where the effect is channelled via the coefficient onLhd−1,the annual pattern is specified in such a way that it enters the model via the coefficient onLhd−7. Accordingly Fourier polynomials with annual cycles are interacted with the one-week lagged load,Lhd−7. The degree of the Fourier polynomials in the series expansion is four. While this choice is not tested formally, experimentation showed that little is to be gained by increasing the degree of the polynomials.11In principle, the weekly pattern previous discussed can also be modelled using Fourier polynomials. The dummy variable specification is preferred because it allows a natural interpretation of the coefficient estimates.Incorporating the adjustments for the weekly and annual cycles gives the extended model(4)Lhd=θh0+θhd1Lhd−1+θhd2Lhd−7+ϕh1ɛhd−1+ϕh2ɛhd−7+ɛhd+fhdS+fhdT+ɛhd,(5)θhd1=∑p=17ηhpWdp,(6)θhd2=τh1+∑q=14[τh2qsin(2qπ(t17472))+τh3qcos(2qπ(t17472))],in which t is a simple time index (that runs from 1 to the total number of observations in the sample) andfhdSandfhdTare defined in Eqs. (2) and (3), respectively.Thus far the information set used in the load models is defined at a daily resolution, namely, atd−1. One important piece of information which is ignored is the observed load in the last half-hour period of the day prior to making a forecast,L48d−1. This is particularly important for the first half hour period of the forecast, as this lagged load is observed in the immediately preceding half hour. In addition it is also reasonable to posit that load in consecutive half hours will be correlated so that in addition to observed load in last half-hour period of the day prior to the making a forecast,L48d−1,each equation should contain the lagged load from the immediately preceding half hour,Lh−1d. Additional lags of consecutive half-hour periods were tried but the improvement in forecast performance was minimal. Consequently, the final multiple equation time series model is now(7)Lhd=θh0+θhd1Lhd−1+θhd2Lhd−7+θh4L48d−1+θh5Ih>1Lh−1d+ϕh1ɛhd−1+ϕh2ɛhd−7+fhdS+fhdT+ɛhd,where Ih > 1 denotes an indicator function which is equal to 1 when h > 1 and 0 otherwise,fhdS,fhdT,θhd 1 and θhd 2 are defined in Eqs. (2), (3), (5) and (6), respectively. This modification turns the 48 equations for the half hours of a day into a recursive system.To demonstrate the contribution made by including,L48d−1only, a restricted version of (7) is estimated (this involves the restrictionθh5=0). This model will be referred to as model (7*).The multiple equation model in all its variants can be estimated equation-by-equation using iterative ordinary least squares (Spliid, 1983). Each equation is initially estimated ignoring the moving-average error terms and the regression residuals stored. The equations are then re-estimated using the regression residuals from the previous step as observed moving average error terms. This process is then iterated until convergence which is defined as the difference in parameter values in successive iterations being less than a user supplied tolerance, in this case the square root of machine precision for floating-point arithmetic.To assess forecast performance, a 3-year rolling window of data is used for model estimation. The day-ahead forecast is produced starting from 00:00 and uses the information available at the time of making the forecast with the exception of the temperature variables. To avoid having to provide forecasts for temperature, the actual data are used in all forecasting evaluations unless specified otherwise. Moreover, as the next-day temperature forecasts are very accurate in general, any loss in accuracy of load forecast is expected to be very small when the actual temperature is replaced with a forecast. The models are re-estimated every week. In total, a period of over 11 years from July 2002 to December 2013 is used for forecast evaluation. MAPE is used as the main criterion for assessing forecast accuracy.Detailed forecast performance results are reported in Table 1, in which the models in Eqs. (1), (4), (7*) and (7) are compared. It can been seen that the most significant improvement is obtained due to the introduction of the weekly dummy variables interacting with the lagged load,Lhd−1,in Eq. (4). In particular, the percentage of large errors (Absolute Percentage Error (APE) ≥ 5 percent) decreases by around two-thirds on normal days when moving from the specification in the prototype model (1) to the weekly dummy variable specification in (4). In addition, incorporating the most recent information in (7*), or using the full recursive system for intra-day correlation, Eq. (7), also improve accuracy but the size of the improvement is not as large. Overall, comparing the final model in (7) with the prototype model in (1), the reduction in the percentage of large APE is over 70 percent in all bands, and the overall MAPE drops from 2.24 percent to 1.36 percent.To get a feel for how the MAPE varies over the course of the day, half-hourly MAPEs for each of the models in (1), (4), (7*) and (7) are plotted in Fig. 2. Overall, the results for (7) show that half-hourly day-ahead MAPEs are all below 2 percent, with an overall MAPE of 1.36 percent. Half-hourly MAPE reaches its lowest point during the night hours, increases to a small peak at around 08:00 and then rises continually to the daily maximum at around 16:00. The preferred specification of the multiple equation model in (7) shows a significant improvement over the earlier version in Eq. (1), both in every half-hour period and also for the overall MAPE recorded (1.36 percent versus 2.24 percent). The restricted version of the full model, which is referred to as (7*), yields a forecast performance equivalent to the unrestricted version during the early part of the day, but the unrestricted version performs better during the peak period between 14:00 and 18:00.It is also readily apparent in Fig. 2 that it is the inclusion of seasonal patterns on the coefficients of lagged load which accounts for a major improvement in forecast accuracy. Furthermore, it can be seen in Table 1 that the most significant improvements achieved using the extended model in (4) are found in the forecasts on normal days and weekends. The percentage of large forecast errors, again defined as the APE being greater than 5 percent, is reduced by around 68 percent. In summary, by interactingLhd−1andLhd−7with the weekly dummy variables and annual cycles, respectively, the overall MAPE of the forecast improves by 0.68 percent in comparison with the prototype model in Eq. (1).A set of representative parameter estimates for the interactive dummy variablesWdp,p=1,…,7and their 95 percent confidence intervals from a 3-year rolling window estimation are plotted in Fig. 3. The largest coefficient values are seen to occur on Monday because the weekend load, which is substantially lower than weekday load, is being used to generate the Monday forecast. The smallest coefficient values are found on the weekends. This is exactly the opposite effect to that noted for Monday; higher weekday loads are now being used to generate forecasts of lower weekend loads.Another discernible pattern is to be found in the coefficients for different weekdays. In off-peak half-hourly intervals shown in Fig. 3, the coefficients have a very similar magnitude with, in some instances, overlapping confidence intervals across different weekdays. During peak load half-hourly intervals, however, the values of the coefficients are substantially different across different weekdays. This indicates clearly that there is an interaction between daily and weekly patterns in load, a characteristic which tends to be ignored in the load forecasting literature. While periodic models such as Taylor and McSharry (2007) and Amaral et al. (2008) do permit time-variation in the impact of the regressors, they do so in a restrictive manner. Although not reported here, a comparison of the multiple-equation model with the periodic model of Taylor and McSharry (2007), shows that the former is to be preferred. Furthermore, allowing for interactions between daily and weekly patterns in the periodic model does lead to improved forecasts, but the multiple equation model is still superior in terms of forecast accuracy.22Results are available on request from the corresponding author.The extensions proposed in Section 3 are designed to effectively model the detailed seasonality in electricity load. In this section, the extended model in Eq. (7) is compared with two popular methods commonly used in the literature for dealing with seasonality. In order to focus the comparison on modelling seasonality alone, the models in this section use only lagged load information and all other information, such as temperature and special days, are ignored. Two models are used for comparative purposes, a single equation double seasonal ARIMA model and the double seasonal Holt-Winters exponential smoothing model.ARIMA typemodels for load forecasting have been widely used in the literature (Kim, 2013; Taylor, 2012). Here a model with daily and weekly cycles is implemented. Alternatively, the Holt-Winters exponential smoothing (HWES) is another common choice for modelling seasonality in load (De Livera, Hyndman, & Snyder, 2011; Gould et al., 2008; Taylor, 2012). The intra-day cycles, double seasonal HWES approach of Gould et al. (2008) is implemented here, which includes an unconstrained seasonal updating scheme with 7 daily sub-cycles in a week and additive seasonal components. The specifications implemented here are outlined in the Appendix.Fig. 4 plots the half-hourly MAPEs of the day-ahead forecasts produced by the three models for the period from July 2002 to December 2013. The efficacy of the proposed multiple equation model for modelling seasonality in the load is obvious. The half-hourly MAPEs and overall MAPE for the proposed approach are clearly lower than those produced by the two competing approaches. In short, the proposed methodology is flexible in accommodating not only the daily and weekly patterns in load, but also the interaction between the two in a way that leads to significantly improved forecast accuracy as shown in Fig. 4. In the double seasonal ARIMA, neither daily nor weekly patterns are allowed in the parameter governing lagged load. In the double seasonal HWES, the intra-day smoothing parameter is assumed to be fixed.In this section, the forecastperformance of the preferred model in (7) is compared with 12-hour ahead forecasts made publicly available by the market operator AEMO in pre-dispatch IS reports for the next trading day.33See, http://www.nemweb.com.au/REPORTS/CURRENT/PreDispatchIS_Reports/.The 12-hour ahead forecasts are chosen because they provide important information for dispatch planning for the next day and because the monthly averaged MAPE of 12-hour ahead forecasts are reported by AEMO as a benchmark for assessing the forecasting performance.44See, http://www.aemo.com.au/Electricity/Data/PreDispatch-Demand-Forecasting-Performance.Although the details of the specification of the AEMO forecasting procedure are not available, it is known to be based on the semi-parametric specification of Fan and Hyndman (2012) and as the main forecasting model chosen by the market operator, may be taken to be representative of the state of art performance of load forecasting models.55See,http://www.aemo.com.au/Electricity/Planning/Forecasting/National-Electricity-Forecasting-Report-2012.The proposed model is also compared with the multiple equation model proposed by Cancelo et al. (2008), hereafter CEG. In this model, the seasonality of load is dealt with using a seasonal ARIMA specification, which results in a non-linear specification requiring estimation by maximum likelihood. Forecasts from the models are generated using an identical procedure and the same set of variables defined in Section 2.A first comparison involves only the preferred model, (7), and CEG given that the AEMO forecast errors are only available for a shorter period. The results are illustrated in Fig. 5. It can been seen that the forecast accuracy of proposed model (7) is superior to that of CEG. An important anomaly in the CEG model is that when making a forecast it only utilises information available 24 hours previously. Even in the first 12 hours when forecasts from the two models are based on the same available information, the lower MAPEs obtained from proposed model (7) shows the advantages of using the latest observed load together with the recursive structure developed in Section 3.2. Note that in the case of 12-hour ahead forecasts, the variableL48d−1in (7) is replaced withLhd=Ih≤24L48d−1+Ih>24L24d. This is responsible for the marked decrease in half-hourly MAPEs shown in Fig. 5 starting from 12:00 when the most recent load information is updated.A more detailed comparison of the performance of the two models is shown in columns 2 and 3 of Table 2 where CEG produces inferior forecasts under all criteria. Since CEG only utilises information at a daily resolution, the results shown in column 2 for the CEG forecasts over the whole period can also be compared with the 24-hour ahead forecast from model (7) shown in row 5 of Table 1. The 1.36 percent overall MAPE of proposed model (7) is 0.25 percent lower than the one obtained from CEG (1.61 percent) and similar superior performance of the former is observed in all the criteria.Given the limited history of publicly available data from AEMO, the period from July 2012 to November 2013 is used for subsequent comparison. Although this period is only 17 months, the advantage of the proposed model is shown clearly in Fig. 6 and columns 5 to 7 of Table 2, with the monthly MAPEs well below the AEMO forecasts and with an improvement of around 0.67 percent in the overall MAPE over the AMEO forecasts. Since AEMO forecasts are based on temperature forecasts instead of real temperature, the results from the proposed model obtained by omitting all temperature information for the forecast period are also reported. While there is a fall in accuracy relative to the situation when actual temperature is used, Fig. 6 demonstrates that this effect is very small and the model is still more accurate than the AEMO forecast under all criteria (0.51 percent lower in the overall MAPE). The advantage of model (7) over CEG (which uses actual temperature data in the forecast) is also shown in Fig. 6 and columns 4 to 6 of Table 2, where either with or without actual temperature, the proposed model in (7) is seen to outperform CEG under all criteria.

@&#CONCLUSIONS@&#
