@&#MAIN-TITLE@&#
A dynamic program for valuing corporate securities

@&#HIGHLIGHTS@&#
We design and implement a dynamic program for valuing corporate securities.Our setting accommodates arbitrary junior and senior corporate debts.We consider an extended balance-sheet equality and a reorganization process.We compute the term structure of yield spreads and default probabilities.

@&#KEYPHRASES@&#
Option theory,Structural models,Corporate securities,Corporate bonds,Dynamic programming,

@&#ABSTRACT@&#
We design and implement a dynamic program for valuing corporate securities, seen as derivatives on a firm’s assets, and computing the term structure of yield spreads and default probabilities. Our setting is flexible for it accommodates an extended balance-sheet equality, arbitrary corporate debts, multiple seniority classes, and a reorganization process. This flexibility comes at the expense of a minor loss of efficiency. The analytical approach proposed in the literature is exchanged here for a quasi-analytical approach based on dynamic programming coupled with finite elements. To assess our construction, which shows flexibility and efficiency, we carry out a numerical investigation along with a complete sensitivity analysis.

@&#INTRODUCTION@&#
The option-based approach for valuing corporate bonds goes back to Merton (1974). He considers a model for a firm with a simple capital structure made of a pure bond and a common stock (equity). He interprets the stock as a European call option on the firm’s assets, whose value follows a geometric Brownian motion, as set by Black and Scholes (1973). The option’s expiry date and strike price are the bond’s maturity date and principal amount, respectively. Then, he evaluates the debt and equity in closed form. Merton’s pioneering paper has given rise to an extensive literature, known as the structural model, where corporate securities are expressed as derivatives on the firm’s asset value. The default event at a given payment date occurs when the state variable falls under a certain default barrier.Black and Cox (1976) extend Merton’s model in two ways, and solve the structural model in closed form. They propose an exogenous default barrier to cover the pure bond’s holders against severe decreases on the firm’s asset value before maturity. They also consider uncovered bond portfolios made of a pure senior bond and a pure junior bond with the same maturity. Geske (1977) uses the theory of compound options, and further extends Merton’s model to arbitrary corporate-bond portfolios. However, his analytical approach remains questionable when the number of coupon dates increases. Leland (1994) considers a continuous coupon perpetuity, which results in a constant default barrier over time. Next, by maximizing the present value of equity, he solves for the so-called endogenous default barrier in closed form. He accounts for tax benefits under the survival event and bankruptcy costs under the default event. These frictions allow Leland to discuss the notions of maximum debt capacity and optimal capital structure. The latter is a break-down of the Modigliani–Miller conjecture, which states that, in pure and perfect capital markets, the firm’s asset value is independent of its capital structure.The aim of this paper is to design and implement a unified dynamic-programming framework for valuing corporate securities and computing the term structure of yield spreads and default probabilities. This model extends Merton (1974), Black and Cox (1976), Geske (1977), and Leland (1994), for it accommodates arbitrary corporate debts, multiple seniority classes, payouts, tax benefits, bankruptcy costs, and a reorganization process. The latter is fulfilled through an augmentation of the state process, which now includes not only the firm’s asset value but also the number of grace periods called for by the firm before the current date. The reorganization and liquidation (default) barriers inferred at payment dates are completely endogenous, and follow from an optimal decision process. These extensions come at the expense of a minor loss of efficiency. The analytical approach of the above-mentioned authors is exchanged here for a quasi-analytical approach based on dynamic programming coupled with finite elements.Further extensions to Merton’s seminal paper in the literature are twofold. The first research stream assumes a very simple firm’s capital structure and solves the structural model in closed form. Longstaff and Schwartz (1995), then Briys and de Varenne (1997), consider a pure bond in Black and Cox’ setting with a Gaussian risk-free rate. Their papers differ on the form of their exogenous default barriers. Collin-Dufresne and Goldstein (2001) extend Longstaff and Schwartz’s settingand allow for a Gaussian exogenous default barrier. Along the same lines, Hsu, Saá-Requejo, and Santa-Clara (2010) evaluate the pure bond in closed form when the firm’s asset value is completely independent from the risk-free rate, which moves as a square-root process. In case of dependence, they use Monte Carlo simulation for valuation purposes. Nivorozhkin (2005a; 2005b) introduce bankruptcy costs for uncovered bond portfolios in Black and Cox’ setting. Starting from Leland’s framework, Leland and Toft (1996) consider a finite-maturity coupon bond that is renewed as long as the firm’s survives. Chen and Kou (2009) exchange the pure-diffusion dynamics of the firm’s asset value of Leland and Toft for a double-exponential jump-diffusion process. Then, they evaluate the debt in closed form. Several authors extend the analytical approach to analyze reorganization processes, especially under Black and Cox-like settings (Abinzano, Seco, Escobar, & Olivares, 2009; Ericsson & Reneby, 1998) or Leland-like settings (Bruche & Naqvi, 2010; François & Morellec, 2004; Mella-Barral & Perraudin, 1997; Shibata & Tian, 2012).The second research stream refers to numerical methods: numerical integration (Moraux, 2004), finite differences (Anderson, Sundaresan, & Tychon, 1996; Brennan & Schwartz, 1978; Fan & Sundaresan, 2000), binomial trees (Anderson & Sundaresan, 1996; Broadie, Chernov, & Sundaresan, 2007; Broadie & Kaya, 2007), dynamic programming (Annabi, Breton, & François, 2012a; 2012b), and Monte Carlo simulation (Galai, Raviv, & Wiener, 2007; Zhou, 2001). Except for Brennan and Schwartz (1978) and Zhou (2001), the rest of these papers consider reorganization processes. Our paper differs from this body of literature in that it handles an arbitrary debt portfolio and several endogenous barriers for monitoring the reorganization process, depending on the firm’s capital structure, debt seniority, and reorganization design. Most of these papers build on Black and Cox (1976) or Leland (1994) assumptions. Although Broadie et al. (2007) assume a cash-flow-based framework and a consol debt, their binomial tree resembles to our dynamic program in that it handles a double endogenous barrier. Finally, our model differs from Annabi et al. (2012a; 2012b) in two ways. Firstly, as claimed earlier, our setting accommodates arbitrary debt portfolios, while theirs assumes a continuous perpetuity. Secondly, our reorganization process focuses on the optimal number of grace periods a firm can call for, while theirs focuses on the negotiation in between claimholders under default.Among other objectives, the structural model attempts to explain the observed yield spreads and default frequencies. Despite its parsimony, the simplest structural model (Merton, 1974) compares extremely well to the classic statistical approach for bankruptcy prediction (Hillegeist, Keating, Cram, & Lundstedt, 2004), and, to a lesser extent, to the neural-network approach (Aziz & Dar, 2006). A hybrid approach can be developed, where some of the statistical risk factors are inferred from the structural model, e.g. the distance to default (Benos & Papanastasopoulos, 2007). More complex structural models have further explained the observed yield spreads and default frequencies (Collin-Dufresne & Goldstein, 2001; Delianedis & Geske, 2001; 2003; Eom, Helwege, & Huang, 2004; Huang & Huang, 2012; Leland, 2004; Suo & Wang, 2006). According to Delianedis and Geske (2001), the most important components of credit risk are default, recovery, tax benefits, jumps, liquidity, and market factors.On the one hand, closed-form solutions, where available, are obviously preferred to approximations. They are extremely efficient; they assure the highest accuracy at a very low computing time. Closed-form solutions explicitly link the unknown parameters to their input parameters and, thus, allow for a direct sensitivity analysis. However, they rely on very simplified assumptions. On the other hand, more realistic models are solved by means of numerical procedures. Our dynamic program is an acceptable compromise in terms of flexibility and efficiency.Dynamic programming is widely used for modeling and solving several optimal Markov decision processes in finance. Examples include Kraft and Steffensen (2013) and Fu, Wei, and Yang (2014) for optimal portfolios and Gamba and Triantis (2008) for financial flexibilities.This paper is organized as follows. Section 2 presents the model and provides several properties of the debt- and equity-value functions, and Section 3 proposes a reorganization process. Section 4 is a numerical investigation, which replicates reported results from the literature and carries out a complete sensitivity analysis. Section 5 concludes. The dynamic program is resolved in the Appendix A.Consider a public company with thefollowing capital structure: a portfolio of senior and junior bonds and a residual claim, that is, a common stock (equity). LetP={t0,t1,…,tn,…,tN=T}be a set of payment dates. At timetn∈P, the firm is committed to payingd0s+d0j=d0≥0anddns+dnj=dn>0,forn=1,…,N,to its creditors (bondholders), wherednsanddnjare the outflows generated at tnby the senior and junior bonds, respectively. The total outflow dnincludes interest as well as principal payments. The interest payments are indicated bydnint. The amountsdns,dnj,anddnint,forn=0,…,N,are known to all investors from the very beginning. The last payment dates of the senior and junior debts, both inP,are indicated by Tsand Tj, respectively. Several authors consider a senior coupon bond and a junior coupon bond with a longer maturity, that is,0≤Ts<Tj=T. Senior bondholders are therefore assured payment before junior bondholders. This realistic case is embedded in our setting.Assume that the firm’s asset value {A} is lognormal with A0 > 0, for t ∈ [0, T]. The present value of tax benefits, bankruptcy costs, senior debt, junior debt, and equity are indicated by TBt(a), BCt(a),Dts(a),Dtj(a),and St(a), respectively, wherea=At. The total debt value is indicated byDt(a)=Dts(a)+Dtj(a). These quantities are interpreted herein as financial derivatives on the firm’s assets. Tax benefit, as a claim, is characterized by a known cash-flow stream of tbn=rncdnint,under survival at tn. The raternc∈[0,1]is the periodic corporate tax rate over[tn,tn+1],forn=0,…,N−1; it is considered as a known constant. Bankruptcy cost, as a claim, is characterized by a cash flow ofwAτunder default, where τ is the hitting time at which the firm defaults. The proportionwcan be interpreted as a write-down or a loss-severity ratio, and1−was a recovery rate; it is considered a known constant.The state process {A}, that is, the firm’s asset value adjusted upward at payment dates, is an exogenous, strictly positive Markov process, for which the following transition parameters are supposed to be known in closed form:(1)TabcΔ0=E*[I(b<Au≤c)∣At=a]=P*(Au∈(b,c]∣At=a),and(2)TabcΔ1=E*[AuI(b<Au≤c)∣At=a],wheretn<t≤u≤tn+1,Δ=u−t,and a, b, andc∈R+*. Here,E*[·∣At=a]represents the conditionalexpectation symbol under the risk-neutral probability measure P*(·), andI(·)the indicator function. For time-heterogenous Markov processes, the transition parameters also depend on t. These truncated moments can be seen as the minimum information required for the Markov process {A} to play the role of a state process. Ben-Ameur, Breton, and François (2006) use the transition tables T0 and T1 to evaluate installment options under the geometric Brownian motion assumption.The conditions (1)–(2) accommodate a large family of pure-diffusion, jump-diffusion, and more general Markov processes. Examples include Zhou (2001) and Chen and Kou (2009), who develop under Gaussian and double-exponential jump diffusions, respectively. We focus herein on the geometric Brownian motion, which verifiesAt0>0andAu=Ate(r−δ−σ2/2)(u−t)+σu−tZn+1,fortn<t≤u≤tn+1,where r is the risk-free rate, δ the firm’s payout ratio, σ the volatility of the firm’s asset value, andZn+1a standard normal random variable independent of the past of {A} till time t. These parameters are considered as known positive constants.The model builds on Leland (1994) extended balance-sheet equality:(3)a+TBt(a)−BCt(a)=Dt(a)+St(a),fort∈[0,T],where the left-hand side of Eq. (3) is the total value of the firm anda=Atits exogenous component. However, we consider an arbitrary debt portfolio with a multiple seniority, instead of the Leland’s specific perpetuity. We herein enforce the strict priority rule under default, while other sharing rules between claimholders can be easily introduced.Proposition 1All value functions at time t ∈ [0, T] depend ona=At. They are continuous and verify the balance-sheet equality inEq. (3)Moreover, the debt and equity value functions at time t are increasing functions ofa=At. Default is likely to happen only at a payment date in the form{a=Atn≤bn*},wherebn*is the endogenous default barrier attn∈P,forn=0,…,N.We propose a proof by induction. To start with, we showthat Proposition 1 holds at  tN. Then, we assume that it holds at a certain future payment datetn+1,and show that it holds att∈(tn,tn+1), then at tn.Consider the following cases at tNthat result from Eq. (3).Case 1: The firm survives at timetN=T,that is,(4)StN(a)>0ora>dN−tbN=bN*,wherea=AtN. One hasTBtN(a)=tbN,BCtN(a)=0,DtNs(a)=dNs,DtNj(a)=dNj,StN(a)=a+tbN−DtN(a)=a+tbN−dN>0.Senior and junior bondholders are fully paid; whatever remains belongs to equityholders.Case 2: The firm defaults at timetN=T,that is,(5)a≤bN*,wherea=AtN. One hasTBtN(a)=0,BCtN(a)=waDtNs(a)=min(a(1−w),dNs)DtNj(a)=max(0,a(1−w)−DtNs(a))StN(a)=0.Senior bondholders are partially paid and junior bondholders are not whenDtNs(a)=a(1−w),that is,a(1−w)<dNs. The former are fully paid and the latter are partially paid whenDtNs(a)=dNs,that is,a(1−w)≥dNs. Clearly, all value functions at maturity are functions ofa=AtN,and the balance-sheet equality in Eq. (3) holds in all cases. Moreover,DtNs(·),DtNj(·),andStN(·)are increasing functions ofa=AtN.Clearly, Proposition 1 holds at maturitytN=T. Now, combining both cases, we can interpret the stock as a call option on the firm’s assets as in Merton (1974), that is,StN(a)=max(0,a−(dN−tbN)),for all a > 0.Suppose now that Proposition 1 holds attn+1. No-arbitrage pricing gives(6)TBtn+(a′)=E*[ρTBtn+1(Atn+1)∣Atn+=a′]BCtn+(a′)=E*[ρBCtn+1(Atn+1)∣Atn+=a′]Dtn+s(a′)=E*[ρDtn+1s(Atn+1)∣Atn+=a′]Dtn+j(a′)=E*[ρDtn+1j(Atn+1)∣Atn+=a′]Stn+(a′)=E*[ρStn+1(Atn+1)∣Atn+=a′],wherea′=Atn+,a=Atn,anda′=a+tbn, andρ=e−r(tn+1−tn)is thediscount factor over(tn+,tn+1]. Given the properties of the conditionalexpectation operator, all value functions attn+depend ona′=Atn+. The balance-sheet equality attn+1gives(7)E*[ρ(Atn+1+TBtn+1(Atn+1)−BCtn+1(Atn+1))∣Atn+=a′]=a′+TBtn+(a′)−BCtn+(a′)=E*[ρ(Dtn+1s(Atn+1)+Dtn+1j(Atn+1)+Stn+1(Atn+1))∣Atn+=a′]=Dtn+s(a′)+Dtn+j(a′)+Stn+(a′),which results in the balance-sheet equality attn+. The same equality holds at any timet∈(tn,tn+1]at which default cannot happen since, by assumption,P*(Stn+1(Atn+1)>0)=P*(Atn+1>bn+1*)>0. Moreover,Dtn+s(·),Dtn+j(·),andStn+(·)are increasing functions since, by assumption,Dtn+1s(·),Dtn+1j(·),andStn+1(·)verify the same property. Now, we can adjust Eq. (7) and move backward fromtn+to time tn. In case of survival at tn, one has(8)a+(tbn+TBtn+(a′))−BCtn+(a′)=a+TBtn(a)−BCtn(a)=Dtn+s(a′)+Dtn+j(a′)+Stn+(a′)=(dns+Dtn+s(a′))+(dnj+Dtn+j(a′))+(Stn+(a′)−dn)=Dtns(a)+Dtnj(a)+Stn(a),where the inequality(9)Stn(a)=Stn+(a′)−dn>0characterizes the survival event at tn. Thus, the firm survives at tnif, and only if, the equity’s present value just after tn, computed on the basis of its future potentialities, exceeds the due payment at tn. As stated by Black and Cox (1976), debt cannot be financed by selling part of the firm’s assets; rather, it is financed by issuing new shares of stock. This covenant applies here under survival sinceStn(a)=Stn+(a′)−dn>0. Seniorand junior bondholders are fully paid; whatever remains belongs to equityholders. Thus, default can happen at the payment date tnand, sinceStn(·)is an increasing function, the default event at tncan be written as{a=Atn≤bn}.Our construction preserves the balance-sheet equality and shows that all value functions at tndepend ona=Atn. Equity is often called the residual claim because it’s treated the last. In case of default at tn, one has(10)Stn(a)=0.The strict priority rule results inTBtn(a)=0,BCtn(a)=waDtns(a)=min(a(1−w),dns+Dtn+s(a))Dtnj(a)=max(0,a(1−w)−Dtns(a))Stn(a)=0.Under default, tax benefits have no current nor future potentialities, and bankruptcy costs have current but no future potentialities. Senior bondholders are fully paid and junior bondholders are partially paid whendns+Dtn+s(a)<a(1−w);else, senior bondholders are partially paid and junior bondholders are not.The present value of senior bondholders,Dtn+s(a), is computed as if no payment were made at tn. Again, our construction preserves the balance-sheet equality and shows that all value functions at tndepend ona=Atnand thatDtns(a),Dtnj(a),andStn(a)are increasing functions ofa=Atn. Continuity can be worked out through the proof based on the Lebesgue’s dominated theorem (Cramér, 1946).□In all cases,Dtn(a)=a(1−w)under default. The casea∈[bn**,bn*]reports the balance-sheet equality under default, when senior bondholders are fully paid and junior bondholders are partially paid. This event collapses whenbn**=bn*. The intuition is that, under high bankruptcy costs, it may happen that junior bondholders are never partially paid under default.Table 1a presents all value functions under survival as well as under default.Proposition 2For t ∈ [0, T], the debt value function Dt(·) verifies the propertieslima→0Dt(a)=0andlima→∞Dt(a)=Mt=∑tn≥tdne−(tn−t)r.Thus, for a large enougha=At,the company is seen as risk free. The required yield on the debt, y ∈ (r, ∞), assumes survival till maturity, and sets at zero the net present value of the debt, that is,(11)D0(a)=∑n=1Ne−ytndn,which, in turn, defines the yield spread asy−r≥0. The required yield can be seen as an internal rate of return on the corporate debt. Along the same lines, the required yield and the yield spread can be defined either for an individual bond or a class of bonds.We propose a proof by induction.First, we show that the property holds at maturitytN=T. Next, we assume that the property holds at a certain future datetn+1,and we show that it holds att∈(tn,tn+1),then at tn. Obviously, the property holds attN=T; see Eqs. (4)–(5). Suppose now that the property holds attn+1. By Eq. (6), one hasDt(a)=E*[e−r(tn+1−t)Dtn+1(Atn+1)∣At=a]=E*[e−r(tn+1−t)Dtn+1(ae(r−σ2/2)(tn+1−t)+σtn+1−tZ)],fort∈(tn,tn+1),where Z follows the standard normal distribution. Again, by Lebesgue’s dominated theorem and the continuity ofDtn+1(·),one haslima→0Dt(a)=E*[e−r(tn+1−t)lima→0Dtn+1(ae(r−σ2/2)(tn+1−t)+σtn+1−tZ)]=0,andlima→∞Dt(a)=E*[e−r(tn+1−t)lima→∞Dtn+1(ae(r−σ2/2)(tn+1−t)+σtn+1−tZ)]=E*[e−r(tn+1−t)Mtn+1]=e−r(tn+1−t)Mtn+1,where the last two steps come from the induction hypothesis at timetn+1. Clearly, the same result holds when t → tnand t > tn. Finally, by Eq. (10), one haslima→0Dtn(a)=0,and by Eq. (9), one haslima→∞Dtn(a)=e−r(tn+1−tn)Mtn+1+dn=Mtn.□The literature reports two definitions for the notion of default probability,one is unconditional and the other is conditional on late survival. The first, known as the total default probability up to time tn, isTDPn=P*(Defaultatt1or…orDefaultattn)=P*(∪i=1n{Ati≤bi*})=1−P*(∪i=1n{Ati≤bi*}¯)=1−P*(∩i=1n{Ati>bi*}),=1−P*(At1>b1*,…,Atn>bn*),and the second, known as the conditional default probability up to time tngiven late survival tilltn−1,isCDPn=P*(Defaultattn|Survivaltilltn−1)=P*(At1>b1*,…,Atn−1>bn−1*,Atn≤bn*)P*(At1>b1*,…,Atn−1>bn−1*)=1−P*(At1>b1*,…,Atn>bn*)P*(At1>b1*,…,Atn−1>bn−1*),forn=1,…,N.TDPnand CDPn, forn=1,…,N,define the term structure of default probabilities, total and conditional respectively.These default proportions can be computed under the risk-neutral or the physical probability measure. Delianedis and Geske (2003) claim that the differences over time in the risk-neutral default probabilities are powerful predictors of corporate bankruptcy. They ignore the drift parameter of the state process {A} under the physical probability measure, known to carry a high estimation sampling error. Although less rigorous, the (total) default probabilities are generally preferred to the conditional default probabilities. The reason lies in the fact that conditional default probabilities, given late survival, are informative only for the very near future. Later on, given survival at time tn, the firm will likely survive at timetn+1.As well, we can define the senior term structure of loss probabilities bySTDPn=1−P*(At1>b1**,…,Atn>bn**),andSCDPn=1−P*(At1>b1**,…,Atn>bn**)P*(At1>b1**,…,Atn−1>bn−1**),forn=1,…,N.Proposition 3Let {Y} be a geometric Brownian motion with an initial positionYt0,a drift μ, a volatility σ, andc1,…,cn∈R. One hasP(Yt1>c1,…,Ytn>cn)=Φ(c1′,…,cn′),wherecm′=log(Yt0/cm)+(μ−σ2/2)tmσ,form=1,…,n,and Φ(·) is the cumulative distribution function of the multivariate normal lawN(0,Σ=CCT)withC=[t1−t00000t1−t0t2−t1000⋯⋯⋯00t1−t0t2−t1⋯tn−1−tn−20t1−t0t2−t1⋯tn−1−tn−2tn−tn−1].The proof is based on the fact thatYtm=Yt0e(μ−σ2/2)tm−σWtm=Yt0e(μ−σ2/2)tm−σ(t1−t0Z1+⋯+tm−tm−1Zm),where {W} is a standard Brownian motion, and(Z1,…,Zn)T∈Rnfollows the standard normal lawN(0,In),whereInis the identity variance-covariance matrix of size n. Form=1,…,n,the event{Ytm>cm}is equivalent to{t1−t0Z1+⋯+tm−tm−1Zm≤cm′},that is,{ThemthrowofCZ≤cm′}.□The quasi-closed-form solution in Proposition 3 is applicable for sub-models without tax benefits, when the process {A} is continuous; else, Monte Carlo simulation is used, given the default barriersbn*andbn**obtained by dynamic programming. Then, Monte Carlo simulation is improved via correlation induction, that is, antithetic and control variates, based on ± Zmand the quasi-closed-form solution in Proposition 3, respectively.To date, we have assumed that a default is immediately followed by a liquidation. This contrasts with most of corporate bankruptcy laws; a reorganization process oftentakes place before liquidation. The rational for a reorganization process is to partially discharge a firm under default in an attempt to extend its business life, save its job positions, and reinforce its future reimbursements and potentialities. Discharging the firm is usually reported in terms of grace periods and grace payments, which increases the present value of equity.In the absence of frictions, that is,rc=ω=0,a reorganization process cannot result in a surplus. Thus, what is gained by a claimholder is lost by the other. The balance-sheet equality isa=D0(a)+S0(a),so that, an increase in S0 results in a decrease in D0, whilea=A0remains constant. In this context, Abinzano et al. (2009); Galai et al. (2007); Moraux (2004) propose alternative reorganization processes, under Black and Cox (1976) setting.In the presence of frictions, the balance-sheet equality isa+TBt(a)−RCt(a)−BCt(a)=Dt(a)+St(a),where RCt(a) is the present value of the reorganization cost at time t whena=At. Similarly to bankruptcy costs, we assume a proportional reorganization cost with a parameterwr<w. A discharge at default leads to a longer life for the firm; it usually results in a cumulativesurplus from an increase in tax benefits and a decrease in bankruptcy costs. Thus, the total value of the firmA¯0=a+TB0(a)−RC0(a)−BC0(a)usually increases, while its exogenous componenta=A0remains constant. In this context, a reorganization process is viable since it allows the firm to share out the surplus between claimholders. We assume debtors-in-possession under reorganization and the strict priority rule under liquidation. Our setting is close to the court-supervised methods of bankruptcy resolution as opposed to private informal reorganization outside the court system.Our reorganization design depends on two parameters,that is, the maximum number of grace periods a firm can call for, indicated byg¯∈{0,1,…,N},and the part of the due payment forgiven by obligors over a grace period, η ∈ [0, 1]. The casesg¯=0and/orη=0refer to our dynamic program without reorganization. All value functions have to be reworked to depend not only on time and the current level of the adjusted firm’s asset value, but also on the number of grace periods called for by the firm before the current date. The generic value functionvt(a)in Eq. (3) is exchanged forvtg¯η(a,g),whereg=gt≤g¯is the number of grace periods called for by the firm before time t. These value functions are expressed in Table 1b under survival, reorganization, and liquidation at timetn∈P.For ease of notation, the barriersbnr(g¯),bnl(g¯),andbn**(g¯)are indicated bybnr,bnl,andbn**. The highest barrier bris called the reorganization barrier and the lowest barrier blthe liquidation barrier. The event{bn**≤a=Atn<bnl}means that senior bondholders are fully paid and junior bondholders are partially paid under liquidation at time tn. The barriersbnr,bnl,andbn**verify respectivelyStn+(a′,g)−dn=0,Stn+(a′′,g+1)−(1−η)dn=0,a(1−w)−(dns+Dtn+s(a,g))=0,where the variables a′ and a′′ are obtained from the state variablea=Atnas follows:a′=a+tbnanda′′=(1−wr)a+(1−η)tbn.In the absence of a reorganization process, that is,g¯=0,η=0,andwr=0,setbr=bl=b*,Table 1a and Table 1b coincide.The optimal reorganization process can be defined as the solution of(12)max(g¯,η)S0(a,g),or(13)max(g¯,η)A¯0,or(14)max(g¯,η)S0(a,g)u.c.D0(a,g)≥D0(a),wherev0(a,g)stands forv0g¯η(a,g)andg=g0for the number of grace periods called for by the firm before the origin.We first compareDP values to selected closed-form solutions in the literature, and show that DP is a viable alternative to the analytical approach. DP is flexible and efficient. Next, we perform a sensitivity analysis of main value functions with respect to their input parameters. The results are interpreted according to the corporate finance theory. Assume no payment at t0, that is,d0=0,in the following cases.The code is written in the C language, compiled with the GCC compiler, and executed under Windows 7 and a laptop computer running with a speed of 2.5 GHz and a RAM of 6 Go. The GSL library (Galassi et al., 2009) is used to achieve specific computing tasks, and the CUBATURE software package (Hahn, 2005) to compute default probabilities. It is worth noticing that CPU times account for a fixed cost associated with the transition parameters and a linear cost associated with the backward recursion, and that the fixed cost is usually the highest.Table 2 is based on information from Nivorozhkin (2005b), and compares DP values to Black and Cox (1976). SetT=1(year),N=1(period),A0=$100,d1s=$70,d1j=$30,andr=10%(per year). This is a portfolio made of a senior pure bond and a junior pure bond, both maturing in one year. B&C stands for Black and Cox and DP refers to dynamic programming.Table 2 shows a clear convergence of DP values to their analytical (B&C) counterparts, as the DP grid size increases. The DP procedure shows accuracy at the sixth digit, while only four digits are reported. Default probabilities are mostly supported by junior bondholders. For example, forμ=0.1andσ=0.1,junior bondholders support a probability of 17.11% of losing value, while senior bondholders are almost safe. For a grid size ofp=2000,average CPU time per case is 1.78 seconds forD0sandD0jand 1.82 seconds for the overall results.Table 3 is based on information from Anson, Fabozzi, Choudhry, and Chen (2004), and compares DP values to Geske (1977). SetT=2(years),N=2(periods),A0=$200,d1=$100,d2=$100,andr=5%(per year). This is a portfolio of two (senior) pure bonds, one maturing in one year and the other in two years.Again, Table 3 shows a clear convergence of DP values to their analytical (Geske) counterparts, as the DP grid size increases. The DP procedure is still accurate at the sixth digit. For a grid size ofp=2000,average CPU time per case is 1.92 seconds for D0 and 1.98 seconds for the overall results. While default probabilities for the first year are significant, they collapse for the second year, given survival the first year. This fact characterizes the structural model.Delianedis and Geske (2003) point out that default frequencies are more explained by the differences overtime in the risk-neutral default probabilities than by the default probabilities themselves. Thus, such an analysis should be done on a regular basis to keep track of the default probability movements over time.Table 4 compares DP values to Geske (1977). SetT=2(years),N=2(two periods of one year each),A0=$100,d1s=$70,d2j=$30, andr=10%(per year). This is a portfolio made of a senior pure bond maturing in one year and a junior pure bond maturing in two years.DP competes well against the analytical approach of Geske. The accuracy of the DP procedure is still at the sixth digit. For a grid size ofp=2000,average CPU time per case is 1.91 seconds forD0jandD0sand 2.02 seconds for the overall results. Even though the nominal debt structure is mostly senior, default risk is almost entirely supported by junior bondholders. Given survival at year one, default probabilities drastically decrease.Table 5 compares DP to Leland (1994). SetA0=$100,r=6%(per year),rc=35%(per year), andw=0.5. The debt is a perpetuity that promises a regular coupon cforever (in dollars per day). To make the parallel with the associated continuous perpetuity with a coupon C (in dollars per year), we use the relationshipc=C×Δt,experiment withΔt−1∈{1,12,365},and report DP values withΔt−1=365. For the DP procedure to run, we fix the debt maturity at 100 years. DP values come closer to Leland’s ones as Δtdecreases. For grid sizesp=2000andp=4000,average CPU times per case to compute all value functions are 1 h 21 min and 5 h 34 min, respectively.Overall, DP is a viable alternative to the analytical approach not only because it shows convergence, robustness, and efficiency, but also for it shows great flexibility. DP allows one to perform realistic numerical and empirical investigations in a quasi-closed form.To start with, we consider a coupon bond and, next, a corporate debt made up of a senior coupon bond and a junior coupon bond with a longer maturity. We conduct a sensitivity analysis with respect to the (junior) bond’s coupon rate c (in % per year) and, then, to the firm’s asset valuea=A0(in dollars). In all cases, when c increases or, equivalently, a decreases, ceteris paribus, the firm moves from a healthy to a distressed situation.We report the value functions of corporate securities for several values of the firm’s asset volatilityσ∈{15percent,30percent,45percent}(per year), the risk-free rater∈{4percent,6percent,8percent}(per year), and the bankruptcy-cost parameter ω ∈ {0, 0.25, 0.5}. The payment d0, the payout rate δ, and the reorganization parametersg¯,g0, and η are set at zero, except for Figs. 25–26.Figs. 1, 2, 3, 4, 5, 6, 7, and 8 represent the 1- equity value, 2- bond value, 3- yield spread, and 4- total value of the firm at the origin, as functions of the bond’s coupon, whenrc=0andw=0. The results show that, in the absence of frictions, the higher the coupon, the lower the equity and the higher the bond value, while the total value of the firm remains flat. The last result indicates that the total value of the firm, which reduces to its exogenous component, is independent of the firm’s capital structure. Thus, in the absence of frictions, the Modigliani–Miller conjecture holds.The bond value is subject to two conflicting mechanics when the coupon increases. First, a higher coupon increases the bond’s future cash flows, and has a positive impact on the bond value. Second, a higher coupon increases the default probability, and has a negative impact on the bond value. In the absence of frictions, the overall impact of these two conflicting mechanics is positive; the first is dominant.The bond’s required rate y (in percent per year) is unbounded, as a function of the bond’s coupon rate c (in percent per year), since it sets at zero the bond’s net present value, assuming that its promised cash flows occur with certainty:D0=[∑n=1Nc×e−y×n+e−y×N]×P(indollars),where P and c are the bond’s principal amount and coupon rate. This is explained by the fact that D0 is bounded.Next, when the firm’s asset volatility σ rises, the equity value increases and the bond value decreases, while the total value of the firm remains constant. A substitution effect is possible in all cases, that is, shareholders benefit from any increase in the risk of the firm’s operations at the expense of bondholders. Thus, in the absence of frictions, bondholders must be protected by special covenants against a potential substitution effect.Furthermore, the results suggest the following:limc↑S0=0andlimc↑D0=A0.Finally, the firm’s default probability is an increasing function of the firm’s asset volatility σ for a healthy company, e.g.,c=4percentper year, and a decreasing function for a distressed company, e.g.,c=12percentper year. The last case is not reported in our analysis. This relationship is not monotone for intermediate coupon rates, e.g.,c=10percentper year.Figs. 9, 10, 11, 12, 13, 14, 15, and 16, follow the same pattern as Figs. 1, 2, 3, 4, 5, 6, 7, and 8, and represent a more realistic situation. We setrc=35percent(per year) andw=0.25. The equity value is still a decreasing function of the bond’s coupon. Conversely, in the presence of frictions, the bond value first increases, and then decreases. The optimum can be seen as the maximum debt capacityof the firm. Clearly, a position right of the optimum is suboptimal; the company agrees to pay a high coupon for a given debt, while a much lower coupon would suffice. Similarly, the total value of the firm first increases, and then decreases. The maximum represents the optimal capital structure. This result indicates that the total value of the firm depends on the firm’s capital structure. Thus, frictions break down the Modigliani–Miller conjecture.This analysis triggers the following question: how far is a given public company from its maximum debt capacity and optimal capital structure? This question is not easy to answer in real life since the company is represented by a single point but not a complete curve. Combining the structural model and the statistical approach is probably the right way to address this important issue.The bond value is still subject to two conflicting mechanics. An increase in the coupon rate results in an increase in the bond’s future cash flows as well as the default probability. Their overall impact is positive for low coupons, and negative for high coupons. The substitution effect is still feasible only for investment-grade bonds. For high-yield bonds, though, an increase in the risk of the firm’s operations, measured by σ, benefits both shareholders and bondholders. Protective covenants against the substitution effect are no longer valuable for bondholders under financial distress. The same two conflicting mechanics explain the shape of the tax-benefit and bankruptcy-cost curves.The results suggest the following:limc↑S0=0,limc↑D0=limc↑A¯0=(1−w)A0limc↑TB0=0,limc↑BC0=wA0.Main value functions, as functions of the firm’s leverageL=D0/A¯0,show a similar pattern, as if they were reported as functions of the bond’s coupon. This investigation is motivated by the fact that the firm’s leverage is an increasing function of the bond’s coupon. The figures are not reported here.The frictions introduced here, that is,rc=35percent(per year) andw=0.25, makes the firm healthier with respect to the first scenario, which assumesrc=0(per year) andw=0. For a coupon ratec=10percent(per year), the default probability becomes an increasing function of the firm’s asset volatility σ.We also let the risk-free interest rater∈{4percent,6percent,8percent}vary instead of the firm’s asset volatility σ. A relevant result is that, unlike riskless bonds, the value of a risky bond may be positively related to the risk-free interest rate. This is the case with high-yield bonds. Rather, investment-grade bonds behave as riskless bonds. This result is consistent with Longstaff and Schwartz (1995), but the explanation differs; the result arises more from frictions in a one-factor model than from market factor interactions in a two-factor model. Figures are available upon request from the authors.We also consider a bond portfolio made up of a senior coupon bond and a junior coupon bond with a longer maturity. We report the values of corporate securities as functions of the junior coupon rate cj(in percent per year), and, for each value function, we vary the bankruptcy-cost parameter ω ∈ {0, 0.25, 0.5}. Equity, tax benefits, junior default barriers, and default probabilities do not depend on the bankruptcy-cost parameter ω. This is a direct consequence of the strict priority rule, which sets the equity value and tax benefits at zero whenever the firm defaults. The parameter ω plays the role of a sharing parameter under default. This result is consistent with Leland (1994). Figures are available upon request from the authors. Figs. 17, 18, 19, and 20 show that senior bondholders are almost always protected by junior bondholders, except for high levels ofw. Thus, for low and moderate levels of ω, costly junior debts do not alter senior bondholders’ position. Alternatively, when ωrises, senior default barriers and default probabilities converge to their junior counterparts, since, for high levels ofw,junior bondholders are never partially paid under default (see Table 1a).The results suggest the following:limcj↑S0=0,limcj↑D0=limcj↑A¯0=(1−w)A0limcj↑TB0=0,limcj↑BC0=wA0.Figs. 21, 22, 23, and 24 follow the same pattern as the previous scenario, but report the value functions of corporate securities as functions of the firm’s asset value. The equity and bond value are both increasing. Leland (1994) claims that, in the presence of frictions, the equity value can switch to a concave function. We have searched for such a pattern without success. Unlike the equity value, the bonds’ values are bounded and convergent, as shown in Proposition 2,lima→∞D0s=[∑n=157%×e−6%×n+e−6%×5]×70=72.3951(indollars),andlima→∞D0j=[∑n=11010%×e−6%×n+e−6%×10]×30=38.3538(indollars).Bondholders take advantage of an increase in the firm’s asset value up to a certain limit. Tax benefits and bankruptcy costs behave similarly as in Figs. 9, 10, 11, 12, 13, 14, 15, and 16, where a low (high) coupon rate corresponds to a high (low) firm’s asset value. This suggests the following properties:lima→∞TB0=∑n=157%×70×35%×e−6%×n+∑n=11010%×30×35%×e−6%×n=14.8495(indollars),andlima→∞BC0=0(indollars).Figs. 25–26 show that equity value is an increasing function ofg¯and η. Thus, the solution of pb. (12) is always(g¯,η)=(N,100%). All in all, if the main objective is to increase equity value, forgive all the time at the maximum rate. This solution is feasible at the theoretical level since bondholders can adjust their prices consequently, but it is not at the practical level since it obviously results in severe conflicting situations. Although the solution is case sensitive, a general property arises from our sensitivity analysis. For a fixed grace rate η∈ [0; 1], the first call period has the most important impact on equity value. Then, the latter quickly saturates. The solution of pb. (14) is usually obtained atg¯=1. This result supports the shortening of the average time under the U.S. bankruptcy law from three years to one year (Sheppard, 1995). Alternatively, the solution of pb. (13)or pb. (14) is not always a corner solution. The optimal reorganization process of pb. (14) is attractive, but it comes up against the unobserved value function D0(A0). For each case, we set in bold the solutions to pb. (12)–(14).

@&#CONCLUSIONS@&#
