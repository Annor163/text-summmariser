@&#MAIN-TITLE@&#
An efficient level set method for simultaneous intensity inhomogeneity correction and segmentation of MR images

@&#HIGHLIGHTS@&#
We propose a novel method for simultaneous intensity inhomogeneity correction and segmentation.Energy functional includes total variation regularization for bias field and level set function.The minimization procedure searches the global minimum and does not depend on initialization.The method was tested on synthetic and real images and evaluated qualitatively and quantitatively.The approach produces results, similar or superior in quality compared to other techniques.

@&#KEYPHRASES@&#
MRI,Segmentation,Bias field,Intensity inhomogeneity,Level set,

@&#ABSTRACT@&#
Intensity inhomogeneity (bias field) is a common artefact in magnetic resonance (MR) images, which hinders successful automatic segmentation. In this work, a novel algorithm for simultaneous segmentation and bias field correction is presented. The proposed energy functional allows for explicit regularization of the bias field term, making the model more flexible, which is crucial in presence of strong inhomogeneities. An efficient minimization procedure, attempting to find the global minimum, is applied to the energy functional. The algorithm is evaluated qualitatively and quantitatively using a synthetic example and real MR images of different organs. Comparisons with several state-of-the-art methods demonstrate the superior performance of the proposed technique. Desirable results are obtained even for images with strong and complicated inhomogeneity fields and sparse tissue structures.

@&#INTRODUCTION@&#
Intensity inhomogeneity is a common artefact that often occurs in medical images and is caused by imperfect image acquisition. For example, radio frequency field inhomogeneities appear due to either a non-uniform field itself or a non-uniform sensitivity of the receiver and transmitter coils. Such artefacts lead to undesired intensity variations in the same tissue types across the image. They hinder successful automated image segmentation, especially if the segmentation algorithms rely only on image intensities [15]. Therefore, efficient and reliable techniques for intensity inhomogeneity correction are required.In general, there are two main directions in this area [18,47]. First, the correction can be done prospectively based on adjustments of hardware and acquisition methods, such as phantom-based calibration and multichannel transmit scanning. Such techniques can remove scanner-dependent inhomogeneities. Nonetheless, they are not applicable for already acquired data. Second, the retrospective correction is done on a post-processing level. Such methods are rather general and mainly rely on the information from acquired images and prior knowledge about imaged anatomies, including methods based on filtering, histogram analysis, surface fitting, statistical modeling, and segmentation [18]. Approaches that allow for simultaneous image segmentation and bias field correction are especially attractive, since the processes of segmentation and correction are interleaved to benefit from each other [47].Level set methods, which are based on calculus of variations and partial differential equations, are naturally able to represent contours with complex topology and to change their topology during evolution. In the last decade, level set methods have become increasingly popular in image processing for segmentation [22,42,43], denoising, and enhancement [23,45]. Region-based level set models [22,37] aim to evolve the contour such that a certain region of interest is identified. A classical example is the well-known Chan and Vese model [7], which uses a region homogeneity assumption. Other methods based on piecewise smooth models might overcome the problem of intensity inhomogeneity. However, they are usually more computationally expensive and sensitive to initialization [27].In this paper, we propose a novel region-based level set method, which allows for simultaneous intensity inhomogeneity correction and two-phase image segmentation. Using a generally accepted model of images with intensity inhomogeneity, we apply a local intensity clustering property proposed by Li et al. [26] and extend the energy functional to enable an explicit regularization of the bias field component. The functional consists of two parts related to segmentation and bias field correction. We reformulate the level set functional using a convexification procedure [6] and minimize each part with the Split Bregman algorithm [3,14], which attempts to find the global minimum and does not depend on initialization. The algorithm is implemented with CUDA [36], a general-purpose computing platform on graphics processing units (GPGPU), to guarantee fast computations.The paper is organized as follows. First, a review of related works is given in Section2. In Section3, we shortly introduce the model and the basic level set formulation. In Section4, we present our extended functional. The level set formulation and the minimization procedure are described in Section4.3. The implementation is elaborated in Section4.4. The results and findings are discussed in Section5. This paper is summarized in Section6.

@&#CONCLUSIONS@&#
We present a variational level set method for simultaneous segmentation and intensity inhomogeneity correction. We formulate an energy by applying a generally accepted model for images with intensity inhomogeneities and a local coherent clustering criterion. We extend this criterion to include an explicit manipulation of the bias field component. The novel functional is minimized using the efficient Split Bregman method. It attempts to find the global minimum and is not sensitive to initialization for both contour segmentation and bias field extraction.Our method has been tested on synthetic and real examples and compared to state-of-the-art methods. The proposed approach with the flexible bias field component model produces promising results, which are similar to the results from the other methods or superior in quality, even for images with strong and complicated inhomogeneity gradients and sparse tissue structures. We observe that level set based approaches usually produce smooth and rather accurate contours. However, the results and convergence speed of the level set based procedures depend on the location of initial contours. Moreover, due to the classical gradient descent based minimization, level set methods usually find a local minimum. Our method overcomes these limitations.As future work, we will extend the method to three dimensions and consider multi-phase level sets, since the main limitations of the presented approach are that it operates only in 2D and is able to segment just two classes. Moreover, we also plan to investigate the influence of different versions of the minimization procedure on the results.