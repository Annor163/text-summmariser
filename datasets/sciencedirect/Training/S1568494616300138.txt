@&#MAIN-TITLE@&#
Artificial 3-D contactless measurement in orthognathic surgery with binocular stereo vision

@&#HIGHLIGHTS@&#
A learning mechanism eliminating the need of surgeon marking the teeth location.Pre-operative 3-D images trained with artificial methods could aid locate the teeth.The artificial contactless repositioning ensures statistically acceptable accuracy.Help the process of quality inspection throughout the operation.A good alternative to manual measurements which are prone to high error rates.

@&#KEYPHRASES@&#
Contactless measurement,3-D coordinate measurement,Stereo vision systems,3-D image-guided orthognathic surgery,Soft computing,

@&#ABSTRACT@&#
Stereo vision systems are utilized since it provides contactless measurements of objects in 3-D (three-dimensional). Orthognathic surgery is a very sensitive operation that requires very high accuracy in measurements. The reduction of measurement error is an essential problem in orthognathic surgery. Moreover, quality inspection of the process during the course of operation aids the surgeon to avoid or minimize the mitigating circumstances. In this paper, artificial intelligence methods (neural network and neuro-fuzzy system) are used in order to increase the accuracy of positioning of jaws during the real-time practice. The comparison of artificial measurements with the real measurements shows that a statistically acceptable accuracy is achieved in 3-D positioning of teeth.

@&#INTRODUCTION@&#
Reliable perception of visual images is one of the challenging and complex problems in computational modeling with applications to real life cases. Traditionally, measurements are performed through contacting the objects. However, a growing number of cases (e.g., industrial applications) require measurements to be done in contactless environment [1].Orthognathic surgery is a correctional operation on lower and upper chin [2]. The success of the operation relies on the sound diagnostics and planning for the preliminary preparation [3]. According to this planning, chins should be placed at their correct locations so that it is physiologically, anatomically and esthetically right fit for the patient [4]. However, the study of orthognathic surgery operations shows that there is a significant difference between the locations of chins that are planned and corrected in the pre- and post-operations, respectively [5]. The main reason for this mismatch is because of not properly transferring the measurement data to the patients chin due to the lack of impreciseness in manual measurements during the operation. This adversely affects the success rate of the operation. Major error sources are application related human limitations, recording, technical and photographic related errors [6]. Therefore, the process of quality inspection is getting throughout the operation ensuring the statistically acceptable accuracy and minimizing the mitigating circumstances.The 3-D (three-dimensional) measurement of the upper and lower chins is very important for computer imaging systems. Stereo vision has become very popular recently in different applications thanks to providing more info than other comparable sensors [7,8]. Recent developments in computer aided imaging has made it possible to build or reconstruct the models of the pictures or the objects in 3-D with a high resolution [9]. To reconstruct the 3-D model of an object from its 2-D (two-dimensional) image has been made easy if you just have a digital camera. There is no need for a special equipment. Special devices like laser scanners, provides extra info to reconstruct the 3-D model. Nevertheless, they are expensive and may be harmful for the humans [10].Conventional pre-operational planning includes by taking the photos from the frontal and profile views [11]. These methods do provide some limited means to capture the 3-D nature, but fails to provide the full-picture of the complete orthognathic surgery planning. Recently, different computerized tomographic devices have been presented in the literature such a Computed Tomography (CT), Cone-beam Computed Tomography (CBCT), Multi-slice Computed Tomography (MSCT), and Three-Dimensional-Computed Tomography (3-D-CT) [12,13]. All these technologies are useful for evaluating the 3-D pictures of the chin, preoperational planning and providing the data for exact locations of the chins. Therefore, 3-D model of a skull can be built and hence providing dependable data before the actual surgery [14,15]. One other prediction system is suggested by Tatsunari Shimonagayoshi et al., a CT 3-D imaging system works in synch with closed chin position. It provides an opportunity for adjustment while recording [16]. Another approach presented by Mazzoni et al., processes 3-D images part by part separately during the operation for the benefit of the patient [17]. This method shows the repeatability of the simulations. However, with all advantages said, these devices have certain disadvantages such as radiation, high cost, impracticality and low precision levels. These errors will affect the success of the surgery negatively by reluctant surgeons that try to avoid using these expensive equipment. At the time of this report, the corrected position of the chin's new locations are typically spotted with surgery needles. Although there is no widespread application procedures, as suggested by Schramm et al., the needle applied to the upper chin is useful and it helps to get better pictures for the operation's success [18,19].In this study, a stereo vision assisted 3-D method of orthognathic surgery support system is developed. Here, binocular stereo vision, as compared to the other methods, proven to be harmless for the human body. It is also suitable for continuous and excessive usage, and shorter in duration and less expensive. Like several previous studies, the proposed method first matches different epipolar scan line pairs independently, detects occlusions simultaneously with a disparity map, using the Sum of Absolute Differences Correlation method of stereo vision in order to realize the reconstruction of the depth information of the image, in other words to get Z values [20–24]. The proposed method guides the operator-dentist during the operation to help adjust the irregularities in the patient's chins to be corrected in the right position and angle as well as constructing the 3-D image for accurate relocation and fine tuning for the final cut positions. It is reported that artificial intelligence methods can be used to improve the accuracy of existing manual measurements [25]. In addition to the stereo vision method, artificial contactless measurements are performed using two different soft computing methods. Various applications have been proposed in the literature using soft computing methods particularly on medical and surgical research [26–31]. The former method is artificial neural networks and the latter method is adaptive network inference system. Artificial methods based on the pre-operative 3-D stereo vision images helped to automatically locate the teeth, eliminating manual guidance by the operator surgeon, and kept the statistical acceptable accuracy.The rest of the paper goes as follows: Section 2 introduces preliminary measurement operation steps of stereo vision systems. Methods used for 3-D artificial contactless measurement are presented in the Section 3. Experimental setup and measurements are given in the Section 4. Experimental results, analysis and discussion are presented in Sections 5 and 6, respectively. Finally, the Section 7 provides the conclusion part of the paperThis section introduces preliminary measurement operation steps of stereo vision systems. These are calibration, image acquisition, disparity maps. A practical visual user interface program is developed to measure points to be selected in 3-D on the image that aids the surgeon in a real operation enabling him/her to manually locate the teeth.The calibration of the binocular stereo camera is needed initially for the system imaging and pre-measurement operations. Algorithms in the literature are developed specifically to obtain 3-D depth information of objects in stereoscopic pictures and approximate relocation values.The stereo processing is implemented by three main steps [32]:i.Define the feature relationships between the pictures from different view angles.For each picture taken, calculate the coordinate related changes.By using the camera geometry, locate the specific 3-D points linked with the camera.The image acquisition which is always the first step in image processing is described as retrieving an image from a source like camera. In this process, pre-calibrated binocular camera (BumbleBee2 – Point Grey Research, Inc. [33]) which has 1032×776 maximum pixels and in parallel alignment with the baseline of 120mm (millimeter) is used. The camera includes 6-pin IEEE-1394a OHCI PCI Host Adapter for camera control and video data transmission. A pixel by pixel matching algorithm is used for processing the acquired images [24].Images captured from horizontally placed cameras form the same scene from different perspectives. These images are used to detect objects placed in the environment. This relative placement is defined as disparity (Fig. 1a) [34]. Disparity is one of the key factors for finding the depth information (Fig. 1b).The two image sensors of binocular stereo vision system are placed on different horizontal coordinates on the same line. Thus any point in 3-D projection maps will have two different locations on the image-sensors. The disparity between coordinates of the same point on the right and left image will be the disparity of any point on the same image. Following equations are used in mathematical computations;(1)d(A)=X(Aleft)−X(Aright)(2)d(B)=X(Bleft)−X(Bright)where d(A) is disparity of point A, d(B) is disparity of point B, X(Aleft) is the x coordinate of the point Aleft, X(Bleft) is the x coordinate of the point Bleft, X(Aright) is the x coordinate of the point Arightand X(Bright) is the x coordinate of the point Bright[32].The sum of Absolute Differences Correlation method of stereo vision is used for disparity calculations (3). This approach enables to do the following steps:i.Fetching a pixel from the right image.Finding a neighboring pixel from left image for a pixel from the right image.Comparison of more than one neighbor points along the same row.Choosing the best map for disparity map.The comparisons of neighbors or masks are computed with (3)[32]:(3)mind=dmindmax∑i=−(m/2)m/2∑j=−(m/2)m/2(|Iright[x+i][y+j]–Ileft[x+i+d][y+j]|)In this equation, dminand dmaxare defined as the minimum and the maximum disparities of d, m is the mask size, Irightand Ileftare the right and left images, x and y are the coordinates in images [24].In this study, 3-D depth information of an object is obtained by stereo triangulation principle. This principle is based on location differences perceived between two images due to changing perspectives. One of the crucial processes in 3-D algorithms is the accurate conversion of image data into real world Cartesian coordinates (Fig. 2) [1].The triangulation given in (4) is based on the similarities between the triangles.(4)BZ=B−(Xl−Xr)Z−f=Xl−Xrf=dfwhere d (d=Xl−Xr) is the disparity, f is the focal length, B is the baseline, Xland Xrare the column position data on the left and right image of the measured object P respectively as shown in Fig. 2a.Simplification of (4) into (5) enables to calculate the distance Z. Thus depth measurements are carried out with (5) as long as the 3-D depth map is obtained in one sub-image (Fig. 1b);(5)BZ=df→Z=fBdThe base line of B is specified as the distance between the centers of two cameras. The focus distance of f is determined priorly for the cameras. The accuracy of the system is increased based on B base line and the resolution is based on the camera positions [35]. The relation between the distance and disparity is shown in Fig. 2b. After the Z value is determined, X and Y values can be computed in the following:(6)X=uZf(7)Y=vZfwhere u and v are the pixel locations on the 2-D image, and X, Y, and Z are the actual positions on 3-D image.As a result, a 3-D depth map can be prepared from the disparity map. The final positions depending of the movements of lower and upper jaws on X, Y, and Z axis are reported to surgeon with the developed user interface software.This section introduces the two different methods that will be used for the 3-D artificial contactless measurements. They are namely, neural networks and neuro-fuzzy systems. Artificial methods based on the pre-operative 3-D stereo vision images helped to automatically locate the teeth, eliminating manual guidance by the operator surgeon. Fig. 3shows the block diagram of the proposed the artificial contactless measurement system and the flow of tasks leading the quality inspection.The artificial neural network is a feed-forward back-propagation neural network that is formed of layers. It is difficult to set the proper artificial neural networks (ANN) configuration such as determining the number of hidden nodes or type of activation functions for each layer. One common approach to set these parameters is the trial and error method. The correct configuration could be obtained after comparing the results of different ANN models. To validate each model, it is important to generate training and testing data sets properly. Training data set is used to learn the parameters of the ANN. The connection weights between multi-layer perceptron are updated during the training. The test data set, however, is used for the evaluation of the ANN system.As shown in Fig. 4, the ANN setup is composed of one input, one output and one hidden layer. In this research study, the proposed ANN is formed of eight inputs, one output and a number of hidden nodes. The inputs are the 3-D coordinates of stereo vision (X, Y, Z), R–G–B (Red–Green–Blue) values of each pixel and 2-D coordinates of right camera image (u=columns, v=rows) whereas the output is the contactless location estimation of the tooth in the operation image to aid the surgeon in correcting the jaw with high precision. The number of hidden nodes is determined based on the configurations revealed at the end of the iterative learning procedure (or epoch). Twenty hidden layer nodes and logarithmic sigmoid transfer function in our ANN setup yielded the best performance. The algorithm used was the Levenberg–Marquardt training algorithm and the training iteration is ended after 1000 epochs.Adaptive network fuzzy inference system (ANFIS) is a type of Takagi–Kang–Sugeno fuzzy system inspired from the feed-forward neural network and provides an architecture for the modeling of systems. ANFIS combines two algorithms in the learning process. First algorithm is the back-propagation and the second one is the least square estimation. One advantage of ANFIS is its fast learning process with an acceptable accuracy. An example of if-then rule-base can be in the following form:R1:ifXisμ1XandYisμ1Y…andvisμ1vtheny1=f(X,Y,Z,R,G,B,u,v)R2:ifXisμ2XandYisμ2Y…andvisμ2vtheny2=f(X,Y,Z,R,G,B,u,v)…Rr:ifXisμrXandYisμrY…andvisμrvthenyr=f(X,Y,Z,R,G,B,u,v)where r is the number of rules, X, Y, Z, R, G, B, u, and v are the inputs, μ1, μ2, …, μrare the fuzzy sets and y1, y2, …, yrare the linear functions for the rule outputs. The architecture of the neuro-fuzzy system with r rules is depicted in Fig. 5. However, in this research the rules in the rule-base varied between twelve and fourteen rules for each teeth measured. The antecedent and consequent parameters of the fuzzy system updated iteratively aiming at error minimization. During the training two kinds of processes takes place. The former is the forward pass where the values of antecedent parameters are fixed and the values of consequent parameters are modified. The latter is the backward pass where the values of consequent parameters are fixed and values of the antecedent parameters are modified by the error signals propagated.In this section, the preparation of dental plaster model, ensuring the quality of images by rotation, partitioning and finally calculating distance will be studied. The articulator (SAM 3 made by SAM Präzisionstechnik GmbH [36]), similar to the function of a caliper, aids to locate and translocate the 3-D position of one's jaw, teeth or face.In orthognathic surgery, the jaw models shaped with lower and upper teeth using the dental plaster models are obtained prior to the dental operation. The stereo vision system is applied in this research study and its performance is be compared to the traditional approach which is the dental plaster model.First, articulator device is used to form the plaster models of lower and upper jaws as shown in Fig. 6a. Prior to the operation, the positions of lower and upper jaws of patient are fixed. Accordingly, dental surgeon marks the teeth positions on fixed jaws with a red ink. The marks indicate the proper positions of teeth that should be located after the operation. Finally, the dental surgeon specifies the positional difference between pre- and post-operations in millimeters as shown in Fig. 6b and c. In order to validate and improve the success of positional translocation, pre- and post-measurements are repeated three times. The mean of the three independent measurements is computed for the comparison purposes.The dental surgeon measures the marked X, Y, and Z teeth positions in the lower and upper jaws using a manual mechanic caliper (Fig. 7a). The coordinate values of eight teeth are measured and recorded based on a reference point. These teeth are determined as first and seventh tooth for left/right sides (L1, L7, R1, and R7) of lower/upper jaws. The same similar process is performed for the stereo vision systems (Fig. 7b).The difference between the initial and final positions is used to calculate the new coordinate values of individual tooth is locations. Then, the error rates of the traditional manual system is compared with the stereo vision system.It should be noted that the starting locations of the device and camera cannot be preserved during the experimental study. The rotations are observed on the final image at X and Y axis. In order to prevent the error that may be caused from the rotation of image in θ degrees, the starting and the final images are mapped on top of one another (Fig. 8).The angle of rotation angle is calculated using a matrix. The starting positions of X and Y values (2-D vector) is multiplied with the rotation matrix in θ degrees in order to find the final positions of X and Y values (8) and (9):(8)R(θ)=cosθ−sinθsinθcosθ(9)x′y′=cosθ−sinθsinθcosθ.xywhere x’ and y’ are the calculated final coordinates of the pixel. The x’ and y’ values can be formulated as (10) and (11)[37];(10)x′=x⋅cosθ−y⋅sinθ(11)y′=x⋅sinθ+y⋅cosθIn order to validate, the results of the stereo vision, the average value of three independent traditional manual measurements are used. The X, Y, and Z positions of marked points are measured manually based on the reference point using a mechanical caliper. This operation is repeated three times in order to minimize the error rates of the manual measurements. The selected points are marked on the image. Due to the zoom effect and low resolution of image, the selected points on the image may change. In order to eliminate this error and specify points precisely, a threshold value should be defined. The marked 9×9 matrix area is used to determine the R–G–B (Red–Green–Blue) values of the neighboring points. The points that have R–G–B values beyond threshold are excluded from the marked area. After the partitions are defined, the geometrical center of each of the XY, XZ, and YZ planes of the shape is marked. This process ensures better precision (Fig. 9).The final positional distances of both jaws are calculated from the marked points on the pre- and post-operation images. The positional changes on X, Y, and Z coordinate values can be calculated as:(12)Movement(X)=|PostOperation(X)−PreOperation(X)|(13)Movement(Y)=|PostOperation(Y)−PreOperation(Y)|(14)Movement(Z)=|PostOperation(Z)−PreOperation(Z)|Cronbanch's alpha confidence is widely used to specify the statistical stability of the experiments [38]. In this research study, a statistical package for social sciences (SPSS v21.0) is used to obtain the confidence intervals for Cronbanch's alpha from the measured values. The statistical stability of the conducted measurements can be analyzed with the use of consistency levels as shown in Table 1. The alpha value is expected to be high for the experiments. If the alpha value is less than 0.5, then the experiments are meant to be not acceptable.The plaster model of moveable lower and higher jaws are prepared for the experimental measurements as shown in Fig. 6. The plaster model is used in order to measure approximately how much in millimeters (mm) a jaw should be moved throughout the (X, Y, Z) coordinates. The calculation of the positional difference between the manual measurements using the caliper and the measurements performed with the stereo vision system or artificial contactless measurements indicates an error. In this research study, manual measurements performed by the dental operator will be accepted as reference measurements.3-D error rates of chosen teeth (1st and 7th) for each jaw and their coordinate variations for the selected points are provided in Tables 2 and 3, respectively. In order to declare how much an operation reached to a success with the selected method, the error rate should be less than 1mm which is an acceptable error rate. The statistical analysis (mean and standard deviation) of repositioning measurement errors for 3-D coordinates are shown in Table 4.The measurements performed with stereo vision system are validated using the reference measurements. The error rates obtained for the X, Y, and Z coordinates are 0.17mm, 0.23mm, and 0.25mm, respectively. In addition, the standard deviation values for the X, Y, and Z axis are also calculated and they are 0.12, 0.17, and 0.15, respectively. The measurements are statistically acceptable as the experimental results obtained are 0.17±0.12mm, 0.23±0.17mm, and 0.25±0.15mm, respectively.The artificial contactless measurements are validated using the reference measurements. As it can be seen from Tables 2–4, the artificial repositioning measurements are very close to the reference measurements and ensure the statistical acceptable accuracy.For the measurements performed with neural networks, the error rates obtained for the X, Y, and Z coordinates are 0.42mm, 0.65mm, and 0.50mm, respectively. In addition, the standard deviation values for the X, Y, and Z axis are also calculated and they are 0.21, 0.27, and 0.24, respectively. The measurements are statistically acceptable as the experimental results obtained are 0.42±0.21mm, 0.65±0.27mm, and 0.50±0.24mm, respectively.For the measurements performed with neuro-fuzzy systems, the error rates obtained for the X, Y, and Z coordinates are 0.55mm, 0.47mm, and 0.68mm, respectively. In addition, the standard deviation values for the X, Y, and Z axes are also calculated and they are 0.43, 0.38, and 0.47, respectively. The measurements are statistically acceptable as the experimental results obtained are 0.55±0.43mm, 0.47±0.38mm, and 0.68±0.47mm, respectively.The measurements clearly present that the error rates are within the clinically acceptable rates (less than 1mm) [39]. In order to interpret the experimental results in detail, the values of manual and stereo vision measurements are compared to each other. The results of the analysis are summarized in Table 5. As shown in table, the alpha values suggest acceptable rates which are greater than 0.6 and yielded an excellent rate of 0.9 for X axes. These can also be interpreted that experimental results obtained are stable.

@&#CONCLUSIONS@&#
