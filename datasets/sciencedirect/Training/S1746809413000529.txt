@&#MAIN-TITLE@&#
Automatic image segmentation of nuclear stained breast tissue sections using color active contour model and an improved watershed method

@&#HIGHLIGHTS@&#
A modified geometric active contour model is used for multiple contour detection of the different nuclear staining in the breast cancer tissue images.A touching nuclei separation method based on watershed algorithm and concave vertex graph is proposed to quantify the total number of cancer nuclei in each class.The proposed methods are tested on two datasets of breast cancer cell images containing different level of malignancy.Results show the superiority of the proposed methods when compared with other existing classification and segmentation methods.On the complete image database, the segmentation accuracy in term of cancer nuclei number is over than 97%, reaching an improvement of 3–4% over earlier methods.

@&#KEYPHRASES@&#
Medical image analysis,Breast cancer,Nuclei segmentation,Active contours,Watersheds,Graph theory,

@&#ABSTRACT@&#
Automatic image segmentation of immunohistologically stained breast tissue sections helps pathologists to discover the cancer disease earlier. The detection of the real number of cancer nuclei in the image is a very tedious and time consuming task. Segmentation of cancer nuclei, especially touching nuclei, presents many difficulties to separate them by traditional segmentation algorithms. This paper presents a new automatic scheme to perform both classification of breast stained nuclei and segmentation of touching nuclei in order to get the total number of cancer nuclei in each class. Firstly, a modified geometric active contour model is used for multiple contour detection of positive and negative nuclear staining in the microscopic image. Secondly, a touching nuclei method based on watershed algorithm and concave vertex graph is proposed to perform accurate quantification of the different stains. Finally, benign nuclei are identified by their morphological features and they are removed automatically from the segmented image for positive cancer nuclei assessment. The proposed classification and segmentation schemes are tested on two datasets of breast cancer cell images containing different level of malignancy. The experimental results show the superiority of the proposed methods when compared with other existing classification and segmentation methods. On the complete image database, the segmentation accuracy in term of cancer nuclei number is over than 97%, reaching an improvement of 3–4% over earlier methods.

@&#INTRODUCTION@&#
Typically, cancer diagnosis is made by pathologists using visual inspection of morphological and chromatic nuclei features in a stained tissue sample. This task is not trivial. Moreover, it is time consuming and error prone. The effectiveness of this approach is highly dependent on the attention and the experience of pathologists. Advances in computer technology now make computer-assisted diagnosis a possibility [1–3]. Automated analysis of cancer cell images does not replace the pathologist, but it may assist him or her to get consistent, objective and rapid diagnoses. Thousands of people die each year due to various types of cancer. Among these, breast cancer is one of the main causes of death among women. Therefore, automatic techniques to segment and to classify microscopic breast cancer images by level of disease can potentially make a significant contribution to health care [1–3]. The major aim of these segmentation methods is to identify the different types of malignancy and to detect the real number of malignant cell nuclei in order to give quantitative and accurate measures to pathologists in the cancer diagnosis process [1–3,9–12].Breast tissue specimens are prepared using the immunohistochemistry (IHC) technique. The breast cancer tissue is stained with this method to demonstrate the estrogen receptor (ER) biomarker including cancer nuclei. The stained nuclei are classified into three types according to their color and shape features, i.e. positive cancer nuclei (P), negative cancer nuclei (N) and benign nuclei (B). Positive cancer nuclei are marked by red or brown color according to the chromogen used in IHC staining while negative and benign nuclei are labeled by blue color. Benign nuclei such as lymphocytes, plasma cell nuclei are identified with their small size and elliptic shape (see Fig. 1(a) and (b)). These non-tumor nuclei are not required in the cancer diagnosis process. In fact, the doctor's medical planning and treatment are based on the ratio of the number of positive nuclei to the total number of cancer cell nuclei in the whole image. Many inherent characteristics of cancer tissue images can be met in nuclear segmentation such that staining inhomogeneity, stains superposition, uneven background, and spurious cells [1,2]. In Fig. 1 for example, we show that there are color and intensity variations both in cancer nuclei and in the background [14,15]. It is clear that nuclear morphological changes in shape and in size are especially prominent in malignant cases (P). So, in this framework, we are dealing with two segmentation problems. The first one is related to the classification of stained nuclei in the image. In other words, only P and N cancer nuclei regions should be extracted from the background. Then, clustered and touching nuclei should be separated in order to get the total number of cancer nuclei in each class. Consequently, segmentation of stained breast cancer cell images becomes a challenging task and motivates the use of ad hoc segmentation approaches.Recently, several promising segmentation techniques are proposed in literature which can reliably overcome histological noise and segment cancer cell nuclei in breast tissue microscopy images. Pixel based approaches are the simplest used ones for nuclear segmentation [2]. They rely on the information of the pixel value (gray level, color, texture…). The separation between the different objects (e.g. nuclei, cytoplasm, stroma, and background) is done either by automatic multithresholding using image histogram or by pixel classification into groups of object having similar features (clustering based methods). For thresholding techniques, one or more thresholds must be determined to satisfy some criteria or to optimize certain objective functions to extract significant objects in IHC images [1,4,5]. Such techniques tend to work only on high-contrast images and do not produce stable results if there is large variability within image sets [2,3]. Clustering based methods are divided into two classes according to the availability of prior knowledge relative to the object features. The first class includes supervised algorithms that can be applied to build a classifier by a pre-labeled set of training instances. Some of the most well-known methods are artificial neural networks [17,18], support vector machine (SVM) [6], Bayesian learning [7], and decision trees. On the other side, unsupervised approaches, such as K-means [8], fuzzy c-means, ISODATA clustering, Meanshift [31], and self-organizing map, can be used to group image pixels to different objects without a set of labeled samples [1].Other popular approaches for cell and nuclei segmentation are active contours and watershed algorithms [15,16,31,41,42,44,46]. Our approach relies partly on active contours methods (Snakes), which have become powerful tools used for edge detection, medical image segmentation and object tracking [25]. Snakes can be classified into two categories: parametric snakes and geometric active contours [28]. Parametric snakes are explicitly represented as parameterized curves in Lagrange formulation [28]. One shortcoming they have is sensitivity to initialization and lack of ability to handle changes in the topology of the evolving curve. Geometric active contours were introduced more recently and are based on the theory of curve evolution and geometric flows [26]. Their numerical implementation is based on the level set method proposed by Osher and Sethian [26] and allows segmenting multiple objects automatically at the same time. The classical level set methods [27,28] need to compute a stopping function based on the gradient of the image, so these models can detect only external boundaries of objects defined by the gradient image. Chan and Vese [29] proposed an active contour model without edge (CV model) which is able to detect interior and exterior borders of objects without using an edge function. Some other geodesic active contour models are proposed in [32,33], which combine the classical active contour model and the two-region segmentation model in order to improve the segmentation accuracy of color images even for discrete and fuzzy edges. None of these models can reliably detect desired objects in the image (i.e. inclusion of other irrelevant objects from the background), and they suffer from slow convergence due to their computational complexity. Moreover, the level set function used in the major active contour formulations is restricted to the separation of two regions. Only few works focus on level set based segmentation in the case of more than two regions [34,35]. A significantly different method was proposed by Pi et al. [36] to detect desired objects in color images. The proposed model is a combination of geodesic active contour model and a modified CV model (MGACV model). A discrimination function based on principal components analysis (PCA) and interval estimation [24] was applied to estimate desired object regions. This discrimination function is included in the energy functional of the CV model and it is also used to compute the initial curve and the stopping function. This guarantees that the evolving curve will stop near the object boundaries in reasonable time.Watershed methods are frequently used for clustered and touching nuclei separation which is considered as a critical step for segmentation of IHC images since it has a great impact on breast cancer nuclei quantification. Indeed, classical watershed algorithm suffers from the major drawback of over-segmentation due to the presence of a multitude of regional minima which is typically a consequence of noise. Several techniques are proposed in the literature to reduce the noise sensitivity of the algorithm, such as marker-controlled watershed [39], region merging-watershed [40], and watershed method using prior shape [43]. All these solutions can partially solve this issue, but they still present many implementation difficulties and require explicit prior knowledge of the image structure. Other promising techniques are presented recently in the literature providing higher accuracy of separation results than classical methods for various types of microscopic images [42,44,45]. A combined method based on geodesic active contour and a marker-watershed transform was proposed by Cheng and Rajapakse [44]. First, initial segmentation is obtained using the CV model. Then, a marker-controlled watershed transform is applied on the segmented image using a new marking function based on shape markers. A different segmentation approach is proposed in [45] to automatically separate touching lymphocytes. First, the boundaries of touching cells are detected using robust estimation and a color gradient vector flow (GVF) snake. Second, a concave vertex graph is constructed from concave points and inner edges. Finally, the optimal path in the graph, which separates clustered cells, is computed by minimizing a cost function based on morphological features.In this paper, we propose a fully automatic method which can reliably segment breast cancer nuclei in IHC images for ER evaluation. For initial segmentation, we provide a modified geometric active contour model to detect positive and negative nuclear staining. The model is based on the classical level set method and a modified Bayes error functional. A discrimination function is constructed to estimate desired stained nuclei using a trained multilayer neural network combined with Fisher linear discriminant preprocessing (FLD-MNN). Then, inspired by the idea of Pi et al. [36], this function is included in the region term of energy functional and the stopping function of the model to improve the segmentation accuracy of detected nuclei in each class. In addition, the initial contour and controlling parameters of the proposed model are computed also with this decision function in order to increase the speed of convergence of the evolving curve. The second part of our approach is devoted to clustered and touching nuclei separation. Touching nuclei regions are extracted from the pre-segmented image using high concavity points of nuclei boundaries. Then, the separation problem is solved by applying the watershed algorithm to a gradient-weighted distance transform followed by an optimal selection of the most significant inner edges using a concave vertex graph. This separation approach is applied on both negative and positive nuclei staining. At the end, benign nuclei are identified by their morphological characteristics and they are removed from the segmented image in order to quantify cancer cell nuclei in the image.The remaining part of the paper is organized as follows: Section 2 describes the proposed segmentation method in details. Section 3 presents experimental results on two large datasets of breast cancer images obtained by IHC staining with two different reaction products. Then, we compare the proposed method to other segmentation methods from the technical literature. Finally, conclusions are provided in Section 4.

@&#CONCLUSIONS@&#
In this paper, we proposed a fully automatic segmentation method which can be used for cancer nuclei scoring in stained breast tissue images. First, stained breast nuclei are classified into two classes according to their color information using a multilayer neural network combined with Fisher linear discriminant preprocessing. A modified geodesic active contour model was then used to extract nuclei boundaries in each class and to improve the segmentation quality of the pre-segmented images. The proposed model gives a good estimation of cancer nuclei regions and smooth borders when compared to existing contour detection techniques.Second, we have proposed an automated method that can accurately separate the clustered and touching nuclei. High concavity points are extracted from the nuclei contours and used then to select only clustered nuclei regions for the separation step. Touching nuclei regions are first segmented with the watershed algorithm applied after a hybrid distance transform. Then, a concave vertex graph is constructed from inner edges and concave points followed by an optimal path selecting procedure to get the final separation results. We compared the proposed method with existing improved watershed algorithms such as region merging-watershed and marker-controlled watershed to demonstrate improvement of separation accuracy. The experiments show that the presented method can reliably segment clustered and touching nuclei even in complex morphological cases. Moreover, we have shown that the performance of the new method is insensitive to its parameters. In contrast, performances of marker-controlled watershed and region merging-watershed are not consistent when applied to the two image datasets and they occasionally suffer from over-segmentation or under-segmentation problem.In conclusion, our results demonstrated that the proposed automatic segmentation method is robust and powerful, since there is a high agreement between the scoring results of the method and pathologists as well as its ability to overcome the limitations of some state of the art approaches.FLD is a multivariate statistical technique which is used to produce a linear combination of the original variables which maximize the ratio of between-class variation to within-class variation [17,23]. FLD can also be applied to image segmentation problems by treating segmentation as classification [31]. In our problem, FLD is used to analyze the training dataset and to produce c-1 independent components which are generally more suitable for classification purposes than PCA, where c is the number of classes. The original variables are the R, G, B and S values of n sample pixels composing the input training set Xin=(p1,p2,…pn). The input dataset Xinis divided into three subsets corresponding to P nuclei, N&B nuclei and background. The aim of the FLD preprocessing is to find an orthonormal basis w that maximizes the between-class measure while minimizing the within-class measure in the input data. This is done by maximizing Fisher criterion J(w) defined by:(A.1)J(w)=wTSbwwTSwwwhere Sbis called the between-class scatter matrix:(A.2)Sb=∑j=1c=3(μj−μ)(μj−μ)Tand μjis the mean of class j while μ is the mean of all classes. Swis called the within-class scatter matrix:(A.3)Sw=∑j=1c=3∑i=1Nj(pij−μj)(pij−μj)Twherepijis the ith sample pixel in the class j and Njis the number of samples in the class j. The linear transformation w is obtained by the eigenvector ofSw−1Sb. The dimension of the training data set is reduced to c-1 variables (i.e. two components F1 and F2). The new feature data set Fin=(F1, F2) is obtained using the following transformation:(A.4)Fin=Xinw