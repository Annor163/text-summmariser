@&#MAIN-TITLE@&#
TDHB-splines: The truncated decoupled basis of hierarchical tensor-product splines

@&#HIGHLIGHTS@&#
The paper introduces a novel basis for multivariate hierarchical tensor-product spline spaces.It uses the truncation mechanism and the idea of decoupling.The truncation mechanism ensures the partition of unity property.The idea of decoupling allows us to obtain a richer set of basis functions than previous approaches.The construction guarantees the completeness property of the novel basis for large classes of multi-level spline spaces.

@&#KEYPHRASES@&#
Hierarchical B-splines,T-mesh,Dimension of splines,Completeness,Truncation,Decoupling,

@&#ABSTRACT@&#
We introduce a novel basis for multivariate hierarchical tensor-product spline spaces. Our construction combines the truncation mechanism (Giannelli et al., 2012) with the idea of decoupling basis functions (Mokriš et al., 2014). While the first mechanism ensures the partition of unity property, which is essential for geometric modeling applications, the idea of decoupling allows us to obtain a richer set of basis functions than previous approaches. Consequently, we can guarantee the completeness property of the novel basis for large classes of multi-level spline spaces. In particular, completeness is obtained for the multi-level spline spaces defined on T-meshes for hierarchical splines of (multi-)degree p for example (i) with single knots and p-adic refinement and (ii) with knots of multiplicitym≥(p+1)/3and dyadic refinement (where each cell to be refined is subdivided into2dcells, with d being the number of variables) without any further restriction on the mesh configuration. Both classes (i), (ii) include multivariate quadratic hierarchical tensor-splines with dyadic refinement.

@&#INTRODUCTION@&#
A subdivision of a domain in d-dimensional space into axis-aligned boxes is called a box-mesh, in particular a T-mesh for dimensiond=2. The analysis of the dimensions and the construction of bases of multivariate (with focus on bivariate) spline spaces on box meshes and T-meshes has been the topic of a substantial number of publications.One of the earliest publications (Chui and Wang, 1983) included not only the dimension formula for splines on simple cross-cut grid partitions but also a detailed study on bivariate splines with rectangular grid partitions. More recently, Deng et al. (2006) proposed a method based on Bézier nets to calculate the dimension of a spline function space over a T-mesh, in particular in the case when the order of smoothness is less than half the degree of the spline functions, which corresponds to knot multiplicities satisfyingm≥(p+1)/2. We will refer to this class of functions – that allows to decouple the degrees of freedom – as splines with reduced smoothness.The dimension of bivariate splines with reduced smoothness was reconsidered by Huang et al. (2006a), who derived an equivalent dimension formula using the smoothing cofactor method. A further extension was presented by Huang et al. (2006b). The dimension of trivariate splines on hierarchical box meshes for the case of reduced smoothness was investigated by Li et al. (2006b). Considering again the bivariate case, Li et al. (2006a) used the method of smoothing cofactors to derive a dimension formula for splines with reduced smoothness.The splines of reduced smoothness have been used for surface modeling and reconstruction by Li et al. (2007) and Deng et al. (2008), where they were called PHT splines (Polynomial splines over Hierarchical T-meshes). See also Li et al. (2009) for the bicubic splines on general T-meshes. The extension to surfaces of arbitrary topology (i.e., including vertices of arbitrary valency) has been presented by Li et al. (2010). Wang et al. (2011) described the generalization to the case of piecewise rational functions and presented an application to numerical simulation using the novel approach of isogeometric analysis (cf. Cottrell et al., 2009). Isogeometric analysis with PHT splines was also studied by Nguyen-Thanh et al. (2011). Schumaker and Wang (2012) studied the approximation power of polynomial splines on T-meshes. This includes PHT splines as a special case. Also the dimension formula from Deng et al. (2006) and Huang et al. (2006b) is confirmed there.In the general case (i.e., non-reduced smoothness), Li and Chen (2011) and Berdinsky et al. (2012) observed that the dimension of the spline space may depend on the geometry of the T-mesh. Mourrain (2014) presented a general approach based on homological algebra to analyze the dimension of bivariate splines on T-meshes. The resulting formula includes certain correction terms that are difficult to evaluate in general. For a special class of meshes, which are called diagonalizable T-meshes, Li (2012) provided a general dimension result that depends only on the topology of the T-mesh but not on its geometry. Wu et al. (2013) studied another special class of T-meshes and used Mourrain's approach to obtain a dimension formula. Wu et al. (2012) proposed a method for the construction of hierarchical bases of a bivariate spline space with the highest order smoothness over a consistent hierarchical T-mesh. Deng et al. (2013) investigated the dimension of bivariate biquadratic spline spaces over T-meshes.In these publications, the analysis of the spline space was performed independently on a specific construction of a basis (or, more generally, of a generating system). There exist three additional approaches, which start from the construction of a basis (or a generating system). These approaches are T-splines (see Scott et al., 2012 and the references cited therein), LR splines (Dokken et al., 2013) and hierarchical B-splines. We are interested in the latter approach, in particular we will consider the completeness question: Given a basis of a spline space, does the space spanned by it include all piecewise polynomial functions of the given degree and smoothness on the underlying T-mesh or box-mesh?The construction of hierarchical splines was introduced by Forsey and Bartels (1988). About ten years later, Kraft (1997) presented a construction of a basis for this space. The completeness question for hierarchical B-splines was first investigated by Giannelli and Jüttler (2013) for bivariate splines of maximal smoothness. Meanwhile, these results have been extended to the trivariate case and to the case of non-uniform degrees and lower smoothness (Berdinsky et al., 2013, 2014a). A basis for bivariate spline spaces with maximal smoothness has been presented by Berdinsky et al. (2014b).We summarize the development and the dependencies between some of these contributions in Fig. 1. The arrows indicate the citations, where we omitted arrows that can be replaced by compositions of other arrows in order to keep the graph as simple as possible.The present paper introduces a novel basis for multivariate hierarchical tensor-product spline spaces. Our construction combines the truncation mechanism (Giannelli et al., 2012) with the idea of decoupling the basis functions (Mokriš et al., 2014). Since the truncation mechanism may produce linearly dependent systems of functions, we use the novel framework for the truncation developed by Zore and Jüttler (2014) that applies to generating systems also. Moreover, we employ recent results on completeness obtained by Mokriš et al. (2014) and use them to characterize the completeness of the new basis.The truncation mechanism ensures the partition of unity property, which is essential for geometric modeling applications. Using decoupling allows us to obtain a richer set of basis functions. Consequently we can guarantee the completeness property for large classes of multi-level spline spaces.The remainder of this paper consists of five sections. First we introduce the notation and recall the notion of the multi-level spline space on the box mesh that is determined by a construction of hierarchical B-splines. Then we introduce decoupled splines, which form a new generating system for the spline functions on a multi-cell domain. Section 4 invokes the framework of Zore and Jüttler (2014) in order to obtain the basis of truncated decoupled hierarchical B-splines (TDHB-splines), which forms a nonnegative partition of unity. The following section identifies conditions that guarantee the completeness of TDHB splines. Finally, we conclude the paper.We consider hierarchies of tensor-product spline functions defined on the d-dimensional spaceRdwith coordinatesx=(x1,…,xd). Given a number of levels N, we assume that a strictly increasing bi-infinite sequence of (grid) nodes(gi,jℓ)j∈Z,gi,jℓ<gi,j+1ℓis given for each coordinatexi,i=1,…,dand for each levelℓ=0,…,N. We require that these sequences are nested, i.e.,(gi,jℓ)j∈Zis a subsequence of(gi,jℓ+1)j∈Z. These nodes define grid hyperplanes of level ℓ,{x∈Rd|xi=gi,jℓ}(i=1,…,d;j∈Z)that form the grid of level ℓ. Fig. 2illustrates these notions by a bivariate example.The grid nodesgi,jℓand the grid hyperplanes defined by them have associated multiplicities. In principle, these multiplicities could depend on the level ℓ, the index of the coordinate direction i and on the index j in the sequence of nodes. In order to keep the notation simple, we shall assume that the multiplicities are independent of j. Consequently, we denote them bymℓ=(m1ℓ,…,mdℓ). However, most of the results presented in the remainder of the paper can be generalized to the case of non-uniform multiplicities.The grid hyperplanes subdivide the d-dimensional spaceRdinto cells of level ℓ,cjℓ=⨉i=1d[gi,ji−1ℓ,gi,jiℓ],where ⨉ denotes simply the Cartesian product andj=(j1,…,jd)∈Zd. LetCℓbe the set of all cells of level ℓ. Any union of finitely many cells fromCℓwill be called a multi-cell domain of level ℓ.Let Ω be a bounded open domain inRdand consider open setsΩℓ,ℓ=0,…,N+1satisfyingΩ=Ω0⊇Ω1⊇⋯⊇ΩN+1=∅.This nested sequence of open domains will be called the domain hierarchy. In addition, we will consider the complementary hierarchy of the so-called ringsΔℓ=Ω0∖Ωℓ+1¯(ℓ=0,…,N),which satisfyΔℓ⊆Δℓ+1. The following assumption will be essential:(A1)EachΔℓis a multi-cell domain of level ℓ, i.e., a union of cells of level k withk≤ℓ.In order to define a hierarchy of spline spaces, we consider a sequence of (multi-)degreespℓ=(p1ℓ,…,pdℓ)and multiplicitiesmℓ=(m1ℓ,…,mdℓ)that are assumed to satisfy(A2)1≤miℓ≤piℓ,piℓ+1−piℓ≤miℓ+1−miℓ, andpiℓ≤piℓ+1.For each level ℓ and each coordinate directionxiwe use the nodesgi,jℓand the associated multiplicitiesmiℓto define a bi-infinite knot sequence, simply by repeating each nodemiℓtimes. Further we denote withBiℓthe basis of B-splines with variablexithat are defined on these knot sequences. More precisely, each tuple ofpiℓ+2adjacent knots defines a B-spline, e.g., by the well-known B-spline recurrence formula (see Prautzsch et al., 2002). The collection of these B-splines forms the basisBiℓ. The knot multiplicities do not exceed the degrees, hence all B-splines are continuous.For each level ℓ we denote with⨂i=1dBiℓthe set of tensor-product B-splines that are obtained by multiplying d univariate B-splines, one from eachBiℓ. Moreover, we collect the tensor-product B-splines that are not equal to the null function on Ω,{γℓ∈⨂i=1dBiℓ|γℓ|Ω≠0}.In the remainder of the paper we will consider only the restrictions of these B-splines to Ω and denote them simply byγiℓ. They form the (tensor-product) B-spline basis vectorGℓ=(γ1ℓ,…,γnℓℓ)Tand we denote its size bynℓ(note that ℓ is an upper index, not a power). The elements of this vector span the spaceVℓ=spanGℓ|Ω.The assumption (A2) concerning degrees and multiplicities together with the nestedness of the sequences of grid nodes imply that these spaces are nested,Vℓ⊆Vℓ+1. Furthermore, there exist refinement matricesRℓ=(rijℓ)such that(1)Gℓ=Rℓ+1Gℓ+1(ℓ=0,…,N).These matrices can be generated with the help of the knot insertion algorithm for B-splines, see Prautzsch et al. (2002). Due to the linear independence and the partition of unity property of tensor-product B-splines, these matrices are left stochastic,11Here we extend the notion left stochastic to non-square matrices. Products of left stochastic matrices are again left stochastic.i.e., all their entries are nonnegative and the column vectors sum to one. Indeed, Eq. (1) combined with(2)1=1ℓGℓ=1ℓ+1Gℓ+1implies1ℓRℓ+1=1ℓ+1, where1kdenotes the row vector of dimensionnkwith all its elements being equal to 1.Given an open setD⊂Rd, we denote withΠp(D¯)the linear space of multivariate polynomials of degree p on its closureD¯and withCs(D¯)the linear space of all functions with the property that all their partial derivatives up to orders=(s1,…,sd)exist at all points of D and they can be continuously extended to the closureD¯.Definition 1For each ringΔℓwe define the spline space of level ℓ,Sℓ={s:Δℓ→R|s∈Cpℓ−mℓ(Δℓ)and∀c∈Cℓ,c⊆Δℓ:s|c∈Πpℓ(c)}.Further, we define the multi-level spline spaceS={s:Ω→R|∀ℓ=0N:s|Δℓ∈Sℓ}.The remainder of this paper discusses the construction and some properties of a basis for the multi-level spline space under certain assumptions concerning the domain hierarchy.We enrich the B-spline bases by introducing a decoupling mechanism. This mechanism will allow us to split the B-splines inGℓinto several independent components according to the connectivity of the intersection of their support with the corresponding ringΔℓ.We consider the support of functions defined on Ω,(3)suppf={x∈Ω¯|f(x)≠0}.Given a functionγiℓ∈Gℓ, we consider its representation with respect to the basis functions of the next level,(4)γiℓ=∑j=1nℓ+1rijℓ+1γjℓ+1=riℓ+1Gℓ+1.The coefficient vector in this equation is the i-th row vector of the refinement matrixRℓ+1in Eq. (1). The decoupling graphΓiℓis defined as follows:•The basis functionsγjℓ+1with nonzero coefficientsrijℓ+1≠0are vertices ofΓiℓ.Two verticesγjℓ+1andγj′ℓ+1are connected by an edge if and only ifsuppγjℓ+1∩suppγj′ℓ+1∩Δℓ≠∅.Fig. 4shows a decoupling graph of a quintic B-spline with uniform knots. In this example, the graph has 7 vertices, 7 edges and three connected components. Uniform dyadic refinement splits the quintic B-splines into 7 finer ones, thus the graph has 7 vertices. The supports of the first four finer B-splines (green dashed lines) mutually intersect each other withinΔ0, hence the corresponding vertices are connected by edges and form a connected component of the graph. Similarly, the supports of the last two finer B-splines (blue and dashed) intersect each other withinΔ0, hence the corresponding vertices are connected by edges and form another connected component of the graph. The remaining finer B-spline (red) corresponds to an isolated vertex of the decoupling graph. See also Example 3.Definition 2We define the decoupled B-splinesδi,Φℓof level ℓ by(5)δi,Φℓ=∑j=1,…,nℓ+1γjℓ+1εΦrijℓ+1γjℓ+1(ℓ=0,…,N;i=1,…,nℓ;Φ∈Ξiℓ).A similar definition was presented in Mokriš et al. (2014). However, we did not consider the isolated vertices of the decoupling graph there.Each of the B-splines of level ℓ is split into one or more decoupled B-splines, one for each connected component of the decoupling graph. Each decoupled B-spline is a linear combination of B-splines of levelℓ+1, with coefficients inherited from the B-spline refinement equation. Note that the decoupled B-splines are not necessarily different from each other. In particular, each B-splineγjℓ+1of levelℓ+1withsuppγjℓ+1∩Δℓ=∅, which is therefore an isolated vertex of the decoupling graphs, may be present as a decoupled B-spline (scaled differently) several times.Example 3Fig. 4 shows the decoupling graph and the decoupled B-splines which are obtained from a single quintic B-spline of degree 5 with uniform knots(…,−0.2,0,0.2,…)and dyadic refinement. Choosing the domainΩ1=(0.4,1)leads to three decoupled B-splines.In order to describe the relation between B-splines and decoupled B-splines in detail, we collect the decoupled B-splines of level ℓ in a column vectorGˆℓ=(γˆ1ℓ,…,γˆnˆℓℓ)Tof dimensionnˆℓ=∑i=1nℓ|Ξiℓ|.Here|Ξiℓ|denotes the number of elements of the setΞiℓ, i.e., the number of connected components of the decoupling graphΓiℓ.Each of the functionsδi,Φℓfrom Definition 2 defines exactly one element of the vectorGˆℓ,γˆk(i,Φ)ℓ=δi,Φℓ,where the indexk=k(i,Φ)is determined by the index i of the original B-splineγiℓand by the connected component Φ of the decoupling graph. A suitable ordering ofGˆℓwill be suggested in the next section.Example 4It is possible that the decoupled B-splinesGˆℓare linearly dependent. As an example, we consider bi-quartic B-splines with single knots on a uniform grid and dyadic refinement. Fig. 5shows two functions (top left and top right; both represented by their supports). The refined grid has been omitted. For both functions, the decoupling graph consists of two connected components that possess edges and a number of isolated vertices (see Fig. 6). The supports of the decoupled functions obtained from the first two components are shown in the center of the top row and in the bottom row, left and right. The isolated vertices of both graphs produce 16 decoupled B-splines, which are the same (though scaled differently) for both functions; the union of their supports is shown in the center of the bottom row. Consequently,Gˆℓis linearly dependent.The refinement equation between B-splines and decoupled B-splines,(6)Gℓ=DℓGˆℓ,can be formulated with the help of a left stochastic matrixDℓ,(7)1ℓDℓ=1ˆℓ,where1ℓand1ˆℓdenote the row vectors of dimensionsnℓandnˆℓ, respectively, with all elements equal to 1. Indeed, since any B-spline is split into a sum of decoupled B-splines, all entries of this matrix are zero except for one entry per column, which is equal to 1.The refinement equation between the decoupled B-splines and the B-splines of the next finer level takes the form(8)Gˆℓ=Xℓ+1Gℓ+1,whereXℓ+1is a left stochastic matrix. Eqs. (2), (6) and (7) give1=1ℓGℓ=1ℓDℓGˆℓ=1ˆℓGˆℓ=1ˆℓXℓ+1Gℓ+1=1ℓ+1Gℓ+1,hence we conclude by comparing the coefficients that1ˆℓXℓ+1=1ℓ+1, as the elements ofGℓ+1are linearly independent. In fact, the entries of each row of the refinement matrix in Eq. (1) are distributed into several rows of the matrixXℓ+1, one for each connected component of the decoupling graph.The next lemma summarizes several properties of decoupled B-splines.Lemma 5We consider the decoupled B-splinesGˆℓof level ℓ.(i)The sum of the decoupled B-splines derived from a B-spline is the B-spline itself,∑Φ∈Ξiℓδi,Φℓ=γiℓ.In particular, ifsuppγiℓ⊆Δℓ, thenγiℓdecouples into exactly one functionδi,Φℓ=γiℓ.IfΦ≠Φ′, thensuppδi,Φ∩suppδi,Φ′∩Δℓ=∅.The decoupled B-splines possess the property of local linear independence onΔℓ. More precisely, for any open setD⊂Δℓ,0|D=∑j=1nˆℓξjγˆjℓ|D⇒∀j=0,…,nˆℓ:ξj=0∨suppγˆjℓ∩D=∅.ProofThe first two properties follow directly from Definition 2. In order to prove the third observation, we note that the decoupled B-splines form a decomposition of each B-spline into several functions with disjoint supports onΔℓ. Since the B-splines possess the property of local linear independence, this is also true for the decoupled B-splines onΔℓ.  □Note that the local linear independence ofGˆℓonΔℓdoes not imply its linear independence on Ω, cf. Example 4.Proposition 6The decoupled B-splines form a nonnegative partition of unity,1=∑i=0nˆℓγˆiℓand∀x∈Ω:γˆiℓ(x)≥0ProofSince the matrixXℓ+1is left stochastic, we get1ˆℓXℓ+1=1ℓ+1.The B-splines of levelℓ+1form a nonnegative partition of unity,1ℓ+1Gℓ+1=1.The proof can be completed by combining both observations.  □Proposition 7The vectors of decoupled B-splines satisfy the refinement equationsGˆℓ=Rˆℓ+1Gˆℓ+1(ℓ=0,…,N−1),where all matricesRˆℓ+1are left stochastic.ProofEqs. (6) and (8) implyRˆℓ+1=Xℓ+1Dℓ+1.The product of two left stochastic matrices is again left stochastic.  □Example 8In case of biquadratic splines with dyadic refinement and single knots each basis function fromGℓhas a support consisting of3×3cells. The possible shapes of the supports of decoupled functions are shown in Fig. 7(up to rotations and symmetries). An example of a mesh with all these basis functions is shown in Fig. 8.We define hierarchical and truncated hierarchical decoupled splines. Our construction generalizes the results of Kraft (1997) and Giannelli et al. (2012). However, since the systems of decoupled B-splines are not guaranteed to be linearly independent, we use the approach that was developed in Zore and Jüttler (2014).This approach is based on the observation that we may split each of the vectorsGˆℓof decoupled B-splines into three sub-vectorsGˆAℓ,GˆBℓandGˆCℓ,(9)Gˆℓ=(γ1ℓ⋮γnˆℓℓ)=(GˆℓAGˆBℓGˆCℓ)such thatγiℓis an element ofGˆAℓ⇔suppγiℓ⊈Ωℓ,γiℓis an element ofGˆCℓ⇔suppγiℓ⊆Ωℓ+1,γiℓis an element ofGˆBℓotherwise.More precisely, we assume that the order of the decoupled B-splines within the vectorsGˆℓhas been chosen so that this splitting into sub-vectors becomes feasible.Clearly, the three sub-vectors have mutually different entries, since the domainsΩℓare assumed to be nested. Also, it should be noted that not all sub-vectors are present at all levels. For instance, bothGˆA0andGˆCNare void.The elements of the two sub-vectorsGˆAℓandGˆBℓare linearly independent. This is due to the fact thatGˆℓpossesses the property of local linear independence onΔℓ(see Lemma 5(iii)) and these two subvectors contain exactly the decoupled B-splines that do not vanish onΔℓ.The refinement equation from Proposition 7 can now be formulated with a matrix consisting of3×3blocks,(10)Gˆℓ=(GˆℓAGˆBℓGˆCℓ)=(RAAℓ+1RABℓ+1RACℓ+1RBAℓ+1RBBℓ+1RBCℓ+10RCBℓ+1RCCℓ+1)(GˆAℓ+1GˆBℓ+1GˆCℓ+1)=Rℓ+1Gˆℓ+1.The lower left block-matrix is a null matrix 0, sinceRℓ+1has nonnegative entries, the decoupled B-splines are nonnegative, andsuppGˆCℓ⊆Ωℓ+1.Definition 9We define the decoupled hierarchical B-splinesK=(GˆBℓ)ℓ=0Nand the truncated decoupled hierarchical B-splinesT=(Tˆℓ)ℓ=0N,whereTˆℓ=RBAℓ+1(∏k=ℓ+2NRAAk)GˆAN(ℓ=0,…,N−1)andTˆN=GˆBN.The following results have been derived in the general setting, see Zore and Jüttler (2014):•The two systems of functionsKandThave the same number of elements and they span the same space.When restricted toΔℓ, the functions inGˆBℓandTˆℓare identical,GˆBℓ|Δℓ=Tˆℓ|Δℓ.BothKandTare linearly independent. This follows directly from the fact that the decoupled B-splinesGˆℓpossess the property of local linear independence onΔℓ, see Lemma 5(iii).The truncated decoupled hierarchical B-splines form a nonnegative partition of unity,∑ℓ=0N∑i=1nˆBℓτˆiℓ=1andallτˆiℓ≥0onΩ,whereTˆℓ=(τˆ1ℓ,…,τˆnˆBℓℓ)TandnˆBℓis the size ofGˆBℓ. This fact is implied by Proposition 6.Example 10We continue Example 3 and compare the effects of truncation and decoupling in Fig. 9. First we apply only truncation, thus we obtain only one function. The upper picture shows the functions obtained after truncation with respect to level 1 (blue, dashed) and after truncation with respect to both levels 1 and 2 (blue, solid). The bottom picture shows the corresponding decoupled functions.We identify conditions that guarantee the completeness of (truncated) decoupled hierarchical B-splines, i.e., conditions that allow to represent any piecewise polynomial function of the given degree and smoothness on the hierarchical grid determined by the hierarchies of spaces and domains. First we recall a result from Mokriš et al. (2014):Proposition 11Consider the setssuppδ∩Δℓ, where δ is any element ofGˆAℓorGˆBℓ. If all these sets are connected, then the elements of the two vectorsGˆAℓandGˆBℓform a basis of the spline spaceSℓ.ProofConsider the decoupled basis functions that are derived from a given B-spline γ. When restricted toΔℓ, these functions have mutually disjoint supports. On each connected component ofsuppγ∩Δℓ, exactly one of them is equal to the B-spline γ, while the remaining functions vanish identically. These properties are implied by Lemma 5(i) and (ii). Consequently, each of the decoupled B-splines fromGˆAℓorGˆBℓ, restricted toΔℓ, is equal to exactly one of the functions that form the basis described in Mokriš et al. (2014, Theorem 2.12).  □Note that a ringΔℓmay contain kissing edges, kissing vertices, etc. If such a kissing feature is contained in the support of a decoupled function, then the intersection of the support withΔℓis connected across that feature, sinceΔℓis a closed set.Now we formulate the main result of the paper.Theorem 12If the assumptions ofProposition 11are satisfied for allℓ=0,…,N, then each of the systemsKandTforms a basis ofS. Moreover,Tis a nonnegative partition of unity.ProofThe proof is fairly similar to the proof of Theorem 20 in Giannelli and Jüttler (2013). Nevertheless, since there are a few subtle differences and in order to make this paper self-contained, we repeat it here in a compact form.We consider a functions∈S. We will show that there existN+1functions(11)sℓ∈span(GˆℓAGˆBℓ)(ℓ=0,…,N)such that(12)sℓ|Δℓ=(s−∑i=0ℓ−1si)|Δℓ,using induction with respect to ℓ.Forℓ=0this follows directly from Proposition 11 and from the definition ofS. According to the latter,s∈Simpliess|Δ0∈S0. Recall thatGˆA0is void. Now, in order to proceed fromℓ−1to ℓ, we first prove that the right-hand side of Eq. (12) belongs toSℓ. Once again, according to the definition ofS,s∈Simpliess|Δℓ∈Sℓ. Consequently, Proposition 11 guarantees thats|Δℓcan be represented by a linear combination of functions fromGˆAℓandGˆBℓ. In addition, sincesk∈span(GˆkAGˆBk)(k=0,…,ℓ−1)there exist row vectorscksuch thatsk=ckGˆk=ckRˆk+1Gˆk+1=⋯=ck∏j=k+1NRˆjGˆℓ.Here we used the refinement equations (7) in order to express eachskwith respect to the decoupled B-splines of level ℓ. The definition of the sub-vectors in (9) now implies thatsk|Δℓ∈span(GˆℓAGˆBℓ)|Δℓ(k=0,…,ℓ−1).Thus, we can findsℓsatisfying (11) and (12). This completes the induction step.Analyzing the right-hand side of Eq. (12) confirms thatsℓ|Δℓ−1=0. Therefore, the local linear independence of the decoupled B-splines (Lemma 5(ii)) and the definition of the sub-vectors in (9) imply that the coefficients with respect toGˆAℓare zero, and thussℓ∈spanGˆBℓ.Finally, if we rewrite (12) forℓ=N, we obtains=s|ΔN=∑ℓ=0Nsℓ|ΔN,which proves thatK=(GˆBℓ)ℓ=0NspansS. BothKandTare known to be linearly independent and to span the same space, see Section 4. MoreoverTis known to be a nonnegative partition of unity.  □One of the motivations for introducing the decoupled basis is to relax the assumptions on the ringsΔℓthat are sufficient to guarantee the completeness ofKandT. More precisely, we obtain the following result.Theorem 13A sufficient condition for the assumption ofProposition 11to be satisfied is that none of the basis functions from the finer level (i.e., fromGℓ+1) intersectsΔℓin more than one connected set.ProofThe proof follows immediately from the fact that the support of each decoupled B-spline fromGˆAℓ∪GˆBℓis the union of supports of B-splines from the next level that are vertices of one connected component of the decoupling graph obtained for one B-spline of level ℓ, see Lemma 5(i).  □Now we are going to discuss several cases where this assumption is satisfied.Corollary 14Suppose that the degrees are independent of the level,pℓ=p, and all knots possess multiplicity 1. When usingp-adic refinement (i.e., each cell of level ℓ is split intop1×⋯×pdcells of levelℓ+1), the basisTspans the entire spaceSand this basis forms a nonnegative partition of unity.ProofUnder this assumption, the support of each function fromGℓ+1is contained in(p1+1)×⋯×(pd+1)cells of levelℓ+1. This guarantees that its intersection withΔℓis always connected and the claim follows from Theorem 13. Alternatively, we may notice that the support of each function fromGˆℓis contained in2×⋯×2cells of level ℓ and refer directly to Theorem 12.  □An example is shown in Fig. 10.The following corollary relaxes the assumption2mℓ≥pℓ+1,1=(1,…,1)T, characterizing the case of reduced smoothness that is considered frequently in the literature, e.g., by Deng et al. (2006) or Schumaker and Wang (2012).Corollary 15If the cells in level ℓ are refined by splitting them into2dcells of levelℓ+1(dyadic refinement) and the multiplicities satisfy3mℓ≥pℓ+1,thenTis a basis ofSand it forms a nonnegative partition of unity.ProofUnder this assumption concerning knot multiplicities, the support of each function fromGℓ+1is contained in3×⋯×3cells of levelℓ+1. This implies that its intersection withΔℓis always connected and we may again use Theorem 13.  □See Fig. 11for an example.Remark 16Note that both results are valid for any dimension, but they apply only to box-meshes that are obtained by p-adic/dyadic refinement. More general configurations have also been studied in the literature, mostly in the bivariate case. We mention the recent results on bivariate splines on more general T-meshes (but with slightly lower smoothness) by Schumaker and Wang (2012). This analysis also includes results concerning the approximation power and the stability properties.Finally we consider the case of maximum smoothness and uniform degrees.Corollary 17Consider the cased=2ord=3with dyadic refinement, uniform degreespℓ=(p,…,p)and uniform knots of multiplicity 1 at all levels. If the offsets for all distances up top−14with respect to the grid size of level ℓ (that is, the offsets for all distances up top−12with respect to the gridsize of the finer mesh) of each ringΔℓdo not have any self-intersections, thenTis a basis ofSand forms a nonnegative partition of unity.Here we consider the offset with respect to the maximum norm. We refer to Mokriš et al. (2014) for the precise definition. Fig. 12shows an example ford=2.Remark 18Multivariate quadraticC1-smooth splines on meshes with dyadic refinement (where each box is refined into2dsmaller boxes) are covered by all three corollaries. The offset condition from Corollary 17 is then automatically fulfilled.Interestingly, not all the edges (or, more generally, interfaces between adjacent edges) are necessarily being used by some of the basis functions. Fig. 13shows an example of a T-mesh with “passive” edges.

@&#CONCLUSIONS@&#
We presented the construction of truncated decoupled hierarchical B-splines. It generalizes the classical hierarchical construction and it keeps some of the desirable properties of B-splines (e.g., linear independence, nonnegative partition of unity) while simultaneously providing a richer set of basis functions.Further work may include investigation of approximation properties of this basis, derivation of an explicit dimension formula and practical applications in Isogeometric Analysis and Geometric Modeling.