@&#MAIN-TITLE@&#
Adjoint shape design sensitivity analysis of fluid–solid interactions using concurrent mesh velocity in ALE formulation

@&#HIGHLIGHTS@&#
Accurate adjoint shape design sensitivity for coupled FSI problems.Efficient shape sensitivity analysis using converged tangent from nonlinear FSI analysis.Variational equation includes the moving boundary of fluids in ALE formulation.Concurrent mesh velocity determined from a displacement-loaded pseudo-structural problem.A fast convergence of total solution due to consistent fluid mesh, interface, and solid mesh.

@&#KEYPHRASES@&#
Fluid–solid interaction (FSI),Arbitrary Lagrangian–Eulerian (ALE),NURBS,Displacement-loaded system,Adjoint shape sensitivity,Shape optimization,

@&#ABSTRACT@&#
A coupled variational equation for fluid–solid interaction (FSI) problems is derived using a steady state Navier–Stokes equation for incompressible flows, an equilibrium equation for geometrically nonlinear solids, a traction continuity condition at interfaces, and a pseudo-equilibrium equation for mesh velocity. The moving boundary in arbitrary Lagrangian–Eulerian (ALE) formulation is included in the variational equations by the mesh velocity obtained from a displacement-loaded pseudo-structural problem at a concurrent configuration, which eventually facilitates to derive shape design sensitivity. A continuum-based adjoint shape sensitivity is derived under ALE formulation, which turns out to be very accurate and efficient due to the utilization of converged tangent and the linearity of both adjoint and sensitivity equations. Through numerical examples, the obtained sensitivity is verified in terms of accuracy and efficiency compared with finite difference sensitivity and further applied to the shape optimization problem of finding a stiff structure while satisfying a volume constraint.

@&#INTRODUCTION@&#
In many engineering disciplines such as aerospace, marine, automotive, and wind engineering fields, the consideration of FSI systems is substantial for quality engineering analysis and thus its necessity is continuously increasing [1]. Nevertheless, the prohibitive amount of computations has been one of the major issues in the coupled FSI analysis. When intended to design optimization for the large scale transient dynamic problems, it is impractical to employ finite difference sensitivity to perform shape design optimization of the coupled FSI problems. Furthermore, the inaccuracy of finite differencing could result in either convergence difficulty or premature results during the design optimization [2].For the kinematical description of fluid domain, the difficulty of severe mesh distortion is inevitable if a Lagrangian approach is employed. On the other hand, the mesh distortion can be handled easily in an Eulerian approach. However, the treatment of moving boundaries and interfaces is challenging. A unified Lagrangian–Eulerian kinematical description of fluid domain is developed by Hughes et al. [3] so that the grid points are displaced independently of fluid motion, where the moving boundary is described by the movement of the reference frame. Several algorithms have been proposed to control the movement of fluid mesh. An ALE kinematical description of fluid domain is adopted [4] so that grid points can be displaced independently of fluid motion. They imposed the mesh velocity by averaging grid velocities of neighboring nodes at the previous time step. For the shape sensitivity analysis in updated Lagrangian [5] or ALE formulation, the design velocity field needs to be updated at every configuration [6, Section 2.3]. In this paper, we employ a moving mesh method where the domain is considered as an elastic body subjected to a prescribed motion on its boundary.To handle the moving boundary and interface of FSI problems, Farhat et al. [7] developed a non-matching discretization method that uses different grids to analyze two fields allowing the incompatibility at interfaces. In shape design optimization, the approximation to obtain the geometric information such as tangent and normal could result in inaccuracy issues in transferring the load and motion of boundary at each time step. Chiandussi et al. [8] proposed a mesh update method based on this approach. The mechanical properties of elements are properly selected to minimize the mesh distortion. Yoshida and Kawahara [9] performed a shape optimization using ALE FEM. The oscillating motion of rigid body was expressed by mesh displacements. They obtained the mesh velocity using an iterative scheme. Also, a space–time Piola transformation method [10] is developed to treat the compatible interfaces, where the equations of motion are described in a reference domain. Recently, using a NURBS-based isogeometric analysis method that preserves geometrical exactness for the spatial discretization, Bazilevs et al. [11] present a fully coupled monolithic formulation of the FSI problems on a moving domain with nonlinear hyperelastic solids. Heinrich et al. [12] performed a shape design optimization of FSI problem which is solved by using the isogeometric approach. They used a gradient-free optimizer due to the expensive cost for the DSA.In the early stage of theoretical development for the coupled FSI problems, many research efforts have been devoted to iterative methods [13] where both disciplines are solved independently in a staggered way at each time step. When it is extended to complicated nonlinear problems, however, some difficulties in convergence and efficiency could occur. To overcome these difficulties, Ghattas and Li [14] proposed a fully coupled method that solves two fields at the same time, using a unified tangent matrix that shares the same solution space for a traction continuity equation at interfaces. The surface traction expressed in terms of 1st Piola–Kirchhoff stress at the undeformed interface is identical to the surface traction expressed in terms of the Cauchy stress at its image on the deformed interfaces. Also, a domain decomposition method is used for the sensitivity analysis of nonlinear aeroelasticity [15]. In a similar way, Lund et al. [16] performed the shape design optimization of FSI problems using semi-analytical sensitivity. Fernandez and Moubachir [17] proposed a shape design sensitivity analysis method and the corresponding linearized equation using ALE formulation and direct differentiation method for aeroelastic systems. Monolithic ALE framework is also used in deriving adjoint shape sensitivities for the goal-oriented adaptive mesh-refinement [18,19]. In this paper, to obtain efficient and accurate shape sensitivity for the coupled FSI problems, we derive continuum-based shape sensitivity. The obtained adjoint shape sensitivity is utilized to develop a shape optimization method.In Section 2, considering a Navier–Stokes equation for incompressible fluids, an equilibrium equation for geometrically nonlinear solids, and traction continuity conditions at interfaces, a coupled variational equation for the FSI problems is derived and solved using the FEM and Newton–Raphson scheme. Second Piola–Kirchhoff stress and Green–Lagrange strain tensors are used to handle the finite deformation of solids in total Lagrangian formulation. A no-slip condition is imposed at the interfaces: the surface traction expressed in terms of the first Piola–Kirchhoff stress at the undeformed interfaces is assumed to be identical to the one expressed in terms of the Cauchy stress at its image on the deformed interfaces [14].In Section 3, an adjoint shape DSA method based on material derivative concept [20] is developed for steady state FSI problems. Even though the cost is very expensive for the response analysis due to the nonlinear nature of problems, the computation cost is trivial for the DSA since the converged solution and the tangent in the response analysis are readily available [21]. Using the developed DSA method, a shape optimization method is formulated for the FSI problems. The objective is to either maximize the stiffness of solids or minimize the drag on the solids while satisfying a constraint of allowable volume. Traditionally, the design and analysis are performed iteratively to produce an optimal design. However, in recent years, the integration of CAD, analysis, and design optimization become more important [22]. Thus, the whole domain including fluids, solids, and interfaces is parameterized to facilitate the shape variations using NURBS patches whose control points are considered as design variables. Akbari et al. [23] showed that if the same discretization, numerical integration, and linear design velocity fields as used in the response analysis are employed, the sensitivities obtained from the continuum–discrete and the discrete–discrete approaches are theoretically equivalent.In Section 4, through numerical examples, the accuracy and efficiency of the developed DSA method is compared with finite difference sensitivity. The critical issue in a shape optimization of FSI problems is the computing cost for the analysis of coupled problems that include nonlinearity in each discipline. Thus, finite difference sensitivity is not practical for the shape design optimization, compared to a fully analytical one. However, the developed shape DSA method is extremely efficient and shown to be applicable to the FSI problems. Together with the shape parameterization method, the developed DSA method is applied to the shape optimization of FSI problems. The optimization process is shown to be very efficient and yields very reasonable results in a physical point of view.Consider a continuum body composed of solids and fluids, which is described by multiple domains and boundaries as shown in Fig. 1. The subscripts F, S, I, andI0in the domain Ω and boundary Γ are used to denote the fluid, solid, deformed, and undeformed interfaces, respectively. The superscripts n and d in the boundary Γ are used to denote the Neumann and Dirichlet types, respectively. The whole domain Ω is composed ofΩ¯FandΩ¯Swhich are respectively the complete domains of fluids and solids, and they share an interface boundaryΓI0as(1)Ω¯F=ΩF∪ΓF∪ΓI0and(2)Ω¯S=ΩS∪ΓS∪ΓI0.In isothermal incompressible flows, an incompressibility condition is written as(3)∇·u=0inΩFand the conservation of linear momentum is described in the ALE formulation as(4)∇·σF+bF=ρF(u·∇)u−ρF(v·∇)uinΩF,whereσF,bF,ρF, u, and v denote the Cauchy stress, body force intensity, fluid density, fluid velocity, and mesh velocity in the ALE formulation, respectively [3,4]. The constitutive relation of Newtonian fluids and the strain–velocity relation are given by(5)σF=−pI+2μFdand(6)d=12(∇u+∇uT),whereμFis the fluid viscosity. Natural and essential boundary conditions are given, respectively, by(7)σFnF=t^FonΓFnand(8)u=u^onΓFd,wheret^Fandu^are the prescribed traction and velocity on the fluid boundaries, respectively. Using virtual pressurep¯and velocityu¯, variational equations for Eqs. (3)–(8) can be written in abstract forms, neglecting the body force for simplicity, as(9)b(p¯,u)=0,∀p¯∈P¯and(10)a(u,u¯)+b(p,u¯)+c(u,u¯)+e(u,v,u¯)=∫ΓIu¯·σFnIFdΓ,∀u¯∈U¯,where(11)a(u,u¯)≡∫ΩF12μF(∇u+∇uT):(∇u¯+∇u¯T)dΩ,(12)b(p,u¯)≡−∫ΩFp∇·u¯dΩ,(13)c(u,u¯)≡∫ΩFρFu¯·(u·∇)udΩand(14)e(u,v,u¯)≡−∫ΩFρFu¯·(v·∇)udΩ.The variational spaces are defined by(15)U¯={u¯|u¯∈H1(ΩF),u¯=0onΓFd}and(16)P¯={p¯|p¯∈L2(ΩF)}.In elastic solids, an equilibrium equation can be written in undeformed configuration as(17)∇0·P0+b=0inΩS,where b is the body force intensity. Using the deformation gradient P and the relation between 1st Piola–Kirchhoff stressP0and 2nd Piola–Kirchhoff stress S, Eq. (17) is rewritten as(18)∇0·(F·S)+b=0inΩS.Natural and essential boundary conditions for the solid domain are given by(19)P0nS0=(F·S)nS0=t^SonΓSnand(20)z=z^onΓSd.Using virtual displacementz¯, variational equations for Eqs. (18)–(20) can be written in total Lagrangian formulation [21], neglecting the body force term, as(21)d(z,z¯)≡∫ΩSε⌢(z;z¯):C:ε(z)dΩ=∫ΓI0z¯·(F·S)nISdΓ,∀z¯∈Z¯,where(22)Z¯={z¯|z¯∈H01(Ω),z¯S=0onΓSd,z¯F=0onΓFd}.The Green–Lagrange strain and the virtual strain tensors are defined as(23)ε(z)=12(∇0z+∇0zT+∇0z·∇0zT)and(24)ε⌢(z;z¯)=12(∇0z¯+∇0z¯T+∇0z¯·∇0zT+∇0z·∇0z¯T).Assume that the surface traction expressed in terms of 1st Piola–Kirchhoff stress at a points′on the undeformed interface is identical to the surface traction expressed in terms of the Cauchy stress at its images″on the deformed interface [14]. Thus, we may write the following:(25)P0(s′)nIS(s′)=σS(s″)nIS(s″).The virtual displacementz¯(s′)on the undeformed interface belongs to the same function space for the virtual velocityu¯(s″)on the deformed interface. Thus, the followings hold:(26)∫ΓI0z¯·(F·S)nISdΓ=∫ΓIu¯·σSnISdΓ=−∫ΓIu¯·σFnIFdΓ.The following traction continuity condition should be satisfied at the interfaces:(27)σSnIS+σFnIF=0.Using Eq. (26), the weak forms of Eqs. (10) and (21) are combined into(28)a(u,u¯)+b(p,u¯)+c(u,u¯)+d(z,z¯)+e(u,v,u¯)=0,∀u¯∈U¯,∀z¯∈Z¯.Also, the continuity condition is written as(29)b(p¯,u)=0,∀p¯∈P¯.If the mesh velocity is given by averaging the grid velocities of neighboring nodes at the previous time step [4], the design velocity field of the mapping rate between original and perturbed designs should be updated at every configuration [6] and the sensitivity can be obtained only through a time integration procedure. To obtain the sensitivity without any time integrations, the mesh velocity should be determined together with the variational equations of Eqs. (28) and (29)at a concurrent time step. Also, to avoid mesh entanglement due to the deformation in solids and fluids, consider a pseudo-structural problem for the fluid field to obtain the mesh velocity v in Eq. (28). In steady state flows, mesh velocity v is approximated asv^that is change of interface displacement per unit time:(30)vI≈zI−zI0t=zI=v^I.To maintain the consistency of the whole response field, the pseudo-structural domain is also formulated in the same way as used in the elastic solid body that is formulated in total Lagrangian approach. A variational equation is formulated to determine the mesh velocity:(31)dm(v,v¯)=0,∀v¯∈V¯,where(32)dm(v,v¯)=∫ΩFε⌢(v;v¯):Cm·ε(v)dΩandCmis an artificial material tensor to reduce the mesh distortion. The function spaces for Eq. (31) are defined as(33)V={v∈H1(ΩF):v=zonΓI,v=0onΓF}and(34)V¯={v¯∈H1(ΩF):v=0onΓI∪ΓF}.The pseudo-structural problem includes a displacement-loaded system that satisfies the non-homogeneous boundary conditions on the interface [21]. Thus, mesh velocity v is decomposed into w and y that satisfy the non-homogeneous and homogeneous boundary conditions, respectively:(35)v=w+y,w∈Vandy∈V¯.Also, the virtual mesh velocity is decomposed into(36)v¯=w¯+y¯=y¯,y¯∈V¯.The second equality holds since bothw¯andy¯are arbitrary functions that satisfy homogeneous boundary conditions in the spaceV¯.The formsc(•,•)andd(•,•)in Eq. (28) are nonlinear with respect to the fluid velocityuand solid displacementz, respectively. Consider Eqs. (28), (29) and (31) at the current configuration (n+1):(37)a(un+1,u¯)+b(pn+1,u¯)+c(un+1,u¯)+d(zn+1,z¯)+e(un+1,vn+1,u¯)=0,∀u¯∈U¯,∀z¯∈Z¯,(38)b(p¯,un+1)=0,∀p¯∈P¯,and(39)dm(vn+1,v¯)=0,∀v¯∈V¯.The nonlinear formc(un+1,u¯)in Eq. (37) is linearized, usingΔ(•)=(•)n+1−(•)n, as(40)c(un+1,u¯)=c(un,u¯)+c⌢(un;Δu,u¯),where(41)c⌢(un;Δu,u¯)=∫ΩFρFu¯·[(un·∇)Δu+(Δu·∇)nu]dΩ.The nonlinear formd(zn+1,z¯)in Eq. (37) is also linearized as(42)d(zn+1,z¯)=d(zn,z¯)+d⌢(zn;Δz,z¯),where(43)d(zn,z¯)=∫Ωε⌢(zn;z¯):C:ε(zn)dΩand(44)d⌢(zn;Δz,z¯)=∫Ωε⌢(zn;z¯):C:ε⌢(zn;Δz)dΩ+∫Ωη⌢(Δz;z¯):C:ε(zn)dΩ.Note that the formdm(•,•)in Eq. (32) is nonlinear with respect to the mesh velocity v.At the current configuration(n+1), the mesh velocityvn+1can be decomposed into a prescribed functionwn+1that is identical to the interface displacement and an arbitrary functionyn+1that satisfies a homogeneous boundary condition on the interface:(45)vn+1=wn+1+yn+1=vn+Δw+Δy.The tri-linear forme(•,•,•)in Eq. (37) can be linearized as(46)e(un+1,n+1v,u¯)=e(un,vn,u¯)+e(Δu,vn,u¯)+e(un,Δw,u¯)+e(un,Δy,u¯).Since the operatorsa(•,•)andb(•,•)are linear, the linearized forms of Eqs. (37) and (38) are rewritten, using Eqs. (39), (42), and (46), as(47)a(Δu,u¯)+b(Δp,u¯)+c⌢(un;Δu,u¯)+d⌢(zn;Δz,z¯)+e(Δu,vn,u¯)+e(un,Δw,u¯)+e(un,Δy,u¯)=−a(un,u¯)−b(pn,u¯)−c(un,u¯)−d(zn,z¯)−e(un,vn,u¯),∀u¯∈U¯,∀z¯∈Z¯and(48)b(p¯,Δu)=−b(p¯,un),∀p¯∈P¯,wherec⌢(un;•,•)andd⌢(zn;•,•)represent bilinear forms linearized at an n-configuration solution. The nonlinear formdm(•,•)in Eq. (31) can be linearized as(49)dm(vn+1,v¯)=dm(vn,v¯)+d⌢m(vn;Δw,v¯)+d⌢m(vn;Δy,v¯)=0or(50)d⌢m(vn;Δw,v¯)+d⌢m(vn;Δy,v¯)=−dm(vn,v¯),∀v¯∈V¯.At configuration(n), the mesh velocityvncan be decomposed into a prescribed functionwnthat is identical to the interface displacementzInand an arbitrary functionynthat satisfies a homogeneous boundary condition on the interfaceΓI:(51)vn=wn+yn=zIn+yFn,wn∈Vandyn∈V¯.In the fluid domain, the following can be defined for the discretized virtual velocityU¯F:(52)U¯FT(JUFnχF+nJUIχI+JUMnχM)≡a(Δu,u¯)+c⌢(un;Δu,u¯)+b(Δp,u¯)+e(Δu,vn,u¯)+e(un,Δy,u¯)+e(un,Δw,u¯)=−a(un,u¯)−b(pn,u¯)−c(un,u¯)−e(un,vn,u¯)≡−U¯FTfUn,∀u¯∈U¯,whereJndenotes a tangent matrix at n-configuration:(53)χFT={ΔUFTΔPFTΔPIT},(54)χI=ΔZIand(55)χM=ΔYF.Note that throughout the paper, capital letters are used to represent the discretized quantities. Also, the following can be defined for the discretized virtual pressureP¯T={P¯FTP¯IT}(56)P¯T(JPFnχF)≡b(p¯,Δu)=−b(p¯,un)≡−P¯TfPn,∀p¯∈P¯.Eqs. (52) and (56) are restated, in a matrix form, as(57){U¯FP¯}T[JUFnJUInJUMnJPFn00]{χFχIχM}=−{U¯FP¯}T{fUnfPn}.Combining two rows in Eq. (57) usingχ¯FT={U¯FTP¯T}andfFTn={fUTnfPTn}, the following is obtained:(58)χ¯FT[JFFnJFInJFMn]{χFχIχM}=−χ¯FTfFn.Note that the fluid velocity on the interfaceUIis eliminated by the no-slip condition. In the solid domain, takingχS=ΔZS, the following holds for the virtual displacementZ¯S:(59)Z¯ST(JSSnχS+JSInχI)≡d⌢(zn;Δz,z¯)=−d(zn,z¯)≡−Z¯STfSn,∀z¯∈Z¯.On the interface, using the fact thatU¯I=Z¯I, the following holds:(60)Z¯IT(JIFnχF+JISnχS+JIInχI+JIMnχM)≡−Z¯ITfIn.For the discretized mesh velocity, the following can be written:(61)V¯T(JMInχI+nJMMχM)≡d⌢m(vn;Δw,v¯)+d⌢m(vn;Δy,v¯)=−dm(vn,v¯)≡−V¯TnfM,∀v¯∈V¯.The linearized variational equation at the previous configuration(n)seeks for the solution at the current configuration(n+1). Thus, Eqs. (58)–(61) are expressed, in an iterative algebraic form, as(62)[JFFn0JFInJFMn0JSSnJSIn0JIFnJISnJIInJIMn00JMInJMMn](i−1){χFχSχIχM}(i)=−{fFnfSnfInfMn}(i−1).Using the Newton–Raphson iterative method, the steps are repeated until the difference between the external and the internal virtual work is negligible within a certain convergence measure.Consider a variation of domain as shown in Fig. 2. Suppose that only one parameter τ defines the mapping T. The process of deforming Ω toΩtauby the mapping T may be viewed as a dynamic process of deforming a continuum, with τ playing the role of time. At initial timeτ=0, the domain is Ω. The trajectories of pointsx∈Ωbeginning atτ=0can now be followed. The initial point x moves to the pointxτ=T(x,t). Thinking of τ as time, a design velocity can be defined as(63)V(xτ,τ)≡dxτdτ=dT(x,τ)dτ=∂T(x,τ)∂τ,since the initial point x does not depend on τ. Supposezτ(x)is the solution of the boundary value problem onΩτ. It is evaluated at a point x. The point-wise material derivative atx∈Ωis defined as(64)ż=ż(x;Ω,V)≡ddτzτ(x+τV(x))|t=0=z′(x)+∇zTV(x),wherez′and∇zare the partial derivative with respect to the design and the gradient∇z=[z,1z,2z,3], respectively. Taking the first order variations of Eqs. (37)–(39) and using Eq. (64), the following are derived:(65)[a(un+1,u¯)]′+[b(pn+1,u¯)]′+[c(un+1,u¯)]′+[d(zn+1,z¯)]′+[e(un+1,vn+1,u¯)]′=a(u̇n+1,u¯)+a(un+1,u¯̇)+aV′(un+1,u¯)+b(ṗn+1,u¯)+b(pn+1,u¯̇)+bV′(pn+1,u¯)+c⌢(un+1;u̇n+1,u¯)+c(un+1,u¯̇)+cV′(un+1,u¯)+d⌢(zn+1;żn+1,z¯)+d(zn+1,z¯̇)+dV′(zn+1,z¯)+e(u̇n+1,vn+1,u¯)+e(un+1,n+1v̇,u¯)+e(un+1,vn+1,u¯̇)+eV′(un+1,vn+1,u¯)=0,(66)[b(p¯,un+1)]′=b(p¯̇,un+1)+b(p¯,u̇n+1)+bV′(p¯,un+1)=0and(67)[dm(vn+1,v¯)]′=d⌢m(vn+1;n+1v̇,v¯)+dm(vn+1,v¯̇)+dVm′(vn+1,v¯)=0.Sinceu¯̇∈U¯,p¯̇∈P¯,z¯̇∈Z¯, andv¯̇∈V¯, the following holds:(68)a(un+1,u¯̇)+b(pn+1,u¯̇)+c(un+1,u¯̇)+d(zn+1,z¯̇)+e(un+1,vn+1,u¯̇)=0,∀u¯̇∈U¯,∀z¯̇∈Z¯,(69)b(p¯̇,un+1)=0,∀p¯̇∈P¯and(70)dm(vn+1,v¯̇)=0,∀v¯̇∈V¯.Thus, Eqs. (65)–(67) are rewritten as(71)a(u̇n+1,u¯)+b(ṗn+1,u¯)+c⌢(un+1;u̇n+1,u¯)+d⌢(zn+1;żn+1,z¯)+e(u̇n+1,vn+1,u¯)+e(un+1,n+1v̇,u¯)=−aV′(un+1,u¯)−bV′(pn+1,u¯)−cV′(un+1,u¯)−dV′(zn+1,z¯)−eV′(un+1,vn+1,u¯),∀u¯∈U¯,∀z¯∈Z¯,(72)b(p¯,u̇n+1)=−bV′(p¯,un+1),∀p¯∈P¯and(73)d⌢m(vn+1;v̇n+1,v¯)=−dVm′(vn+1,v¯),∀v¯∈V¯,where, since C1 regularity is assumed in the solution and velocity fields,(74)aV′(un+1,u¯)=−a(∇n+1uTV,u¯)−a(un+1,∇u¯TV)+aex′(un+1,u¯)=−12∫ΩFμF(ui,kVk,j+uj,kVk,i)(u¯i,jn+1+u¯j,in+1)dΩ−12∫ΩFμF(ui,j+uj,i)(u¯i,kn+1Vk,j+u¯j,kn+1Vk,i)dΩ+12∫ΩF[μF(ui,j+uj,i)(u¯i,jn+1+u¯j,in+1)Vk,k]dΩ,(75)bV′(pn+1,u¯)=−b(∇n+1pTV,u¯)+bex′(pn+1,u¯)=∫ΩF(u¯i,kVk,ipn+1−u¯i,ipn+1Vk,k)dΩ,(76)cV′(un+1,u¯)=−c⌢(un+1;∇n+1uTV,u¯)−c(un+1,∇u¯TV)+cex′(un+1,u¯)=−∫ΩFρF(u¯iujn+1ui,kn+1Vk,j+u¯i,kVk,jujn+1uin+1−u¯iujn+1ui,jn+1Vk,k)dΩ,(77)dV′(zn+1,z¯)=−d⌢(zn+1;∇n+1zTV,z¯)−d(zn+1,∇z¯TV)+dV′(zn+1,z¯)−12∫ΩSCijkl[zk,mn+1Vm,l+zl,mn+1Vm,k+zi,mn+1Vm,kzi,mn+1+n+1zi,lzi,mn+1Vm,l]ε⌢ij(zn+1;z¯)dΩ−12∫ΩSCijklεkl(zn+1)[z¯i,mVm,j+z¯j,mVm,i+z¯k,mVm,izk,jn+1+zk,in+1z¯k,mVm,j+z¯k,izk,mn+1Vm,j+zk,mn+1Vm,iz¯k,j]dΩ+∫ΩSCijklεkl(zn+1)ε⌢ij(zn+1;z¯)Vm,mdΩ,(78)eV′(un+1,vn+1,u¯)=−e(∇n+1uTV,vn+1,u¯)−e(un+1,vn+1,∇u¯TV)+eex′(un+1,vn+1,u¯)=∫ΩFρF(u¯ivjn+1ui,kn+1Vk,j+u¯i,kVk,jvjn+1uin+1−u¯ivjn+1ui,jn+1Vk,k)dΩand(79)dVm′(vn+1,v¯)=−d⌢m(vn+1;∇n+1vTV,v¯)−dm(vn+1,∇v¯TV)+dexm′(vn+1,v¯)=−12∫ΩFCijklm[vk,qn+1Vq,l+vl,qn+1Vq,k+vs,qn+1Vq,kvs,ln+1+vs,kn+1vs,qn+1Vq,l]ε⌢ij(vn+1;v¯)dΩ−12∫ΩFCijklmεkl(vn+1)[v¯i,qVq,j+v¯j,qVq,i+v¯s,qVq,ivs,jn+1+vs,in+1v¯s,qVq,j+v¯s,ivs,qn+1Vq,j+vs,qn+1Vq,iv¯s,j]dΩ+∫ΩFCijklmεkl(vn+1)ε⌢ij(vn+1;v¯)Vq,qdΩ.The converged mesh velocityv(i)nbecomes the initial velocity at configuration(n+1):(80)vn+1=wn+1+yn+1=zn+1+yFn+1,wn+1∈Vandyn+1∈V¯.In the fluid domain, the following can be defined for the discretized virtual velocityU¯F:(81)U¯FT(JUFn+1χ̇F+JUIn+1χ̇I+JUMn+1χ̇M)≡a(u̇n+1,u¯)+c⌢(un+1;u̇n+1,u¯)+b(ṗn+1,u¯)+e(u̇n+1,vn+1,u¯)+e(un+1,ẏn+1,u¯)+e(un+1,ẇn+1,u¯)=−aV′(un+1,u¯)−bV′(pn+1,u¯)−cV′(un+1,u¯)−eV′(un+1,vn+1,u¯)≡−U¯FTf˜Un+1,∀u¯∈U¯,and for the discretized virtual pressureP¯T={P¯FTP¯IT}(82)P¯T(JPEn+1χ̇F)≡b(p¯,u̇n+1)=−bV′(p¯,un+1)≡−P¯Tf˜Pn+1,∀p¯∈P¯,where(83)χ̇FT={U̇FTn+1ṖFTn+1ṖITn+1},(84)χ̇I=ŻIn+1and(85)χ̇M=ẎFn+1.Eqs. (81) and (82) are restated, in a matrix form, as(86){U¯FP¯}T[JUFn+1JUIn+1JUMn+1JPEn+100]{χ̇Fχ̇Iχ̇M}=−{U¯FP¯}T{f˜Un+1f˜Pn+1}.Combining two rows in Eq. (86) usingχ¯FT={U¯FTP¯T}andfFTn={f˜UTnf˜PTn}, the following is obtained:(87)χ¯FT[JFFn+1JFIn+1JFMn+1]{χ̇Fχ̇Iχ̇M}=−χ¯FTf˜Fn+1.In the solid domain, takingχ̇S=ΔŻS, the following holds for the discretized virtual displacementZ¯S:(88)Z¯ST(JSSn+1χ̇S+JSIn+1χ̇I)≡d⌢(zn+1;żn+1,z¯)=−dV′(zn+1,z¯)≡−Z¯STf˜Sn+1,∀z¯∈Z¯.On the interface, using the fact thatU¯I=Z¯I, the following holds:(89)Z¯IT(JIFn+1χ̇F+JISn+1χ̇S+JIIn+1χ̇I+JIMn+1χ̇M)≡−Z¯ITf˜In+1.For the discretized mesh velocity, the following can be written:(90)V¯T(JMIn+1χ̇I+JMMn+1χ̇M)≡d⌢m(vn+1;ẇn+1,v¯)+d⌢m(vn+1;ẏn+1,v¯)=−dVm′(vn+1,v¯)≡−V¯Tf˜Mn+1,∀v¯∈V¯.Eqs. (87)–(90) are expressed, in an algebraic form, as(91)[JFFn+10JFIn+1JFMn+10JSSn+1JSIn+10JIFn+1JISn+1JIIn+1JIMn+100JMIn+1JMMn+1]{χ̇Fχ̇Sχ̇Iχ̇M}=−{f˜Fn+1f˜Sn+1f˜In+1f˜Mn+1}.Note that Eq. (91) is a linear system of equations for the sensitivity{χ̇Fχ̇Sχ̇Iχ̇M}T. The tangent in Eq. (91) is obtained from the converged tangent in Eq. (62).Consider a general performance measure for the FSI problem that can be written in an integral form at the final equilibrium configuration(n+1):(92)ψ=∫ΩFfF(un+1,pn+1,vn+1)dΩ+∫ΩSfS(zn+1,∇zn+1)dΩ+∫ΓFgF(un+1,pn+1,vn+1)dΓ+∫ΓSgS(zn+1,∇zn+1)dΓ+∫ΓIgI(un+1,pn+1,vn+1,zn+1,∇zn+1)dΓ.The first order variation of Eq. (92) is obtained by(93)ψ′=∫ΩF(fF,uu̇n+1+fF,pṗn+1+fF,vv̇n+1)dΩ+∫ΩS(fS,zżn+1+fS,∇z∇żn+1)dΩ+∫ΓF(gF,uu̇n+1+gF,pṗn+1+gF,vv̇n+1)dΓ+∫ΓS(gS,zżn+1+gS,∇z∇żn+1)dΓ+∫ΓI(gI,uu̇n+1+gI,pṗn+1+gI,vv̇n+1+gI,zżn+1+gI,∇z∇żn+1)dΓ−∫ΩF{fF,u∇uTn+1V+fF,p∇pTn+1V+fF,v∇vTn+1V−div(fFV)}dΩ−∫ΩS{fS,z∇zTn+1V+fS,∇z∇∇zTn+1V−div(fSV)}dΩ−∫ΓF{gF,u∇uTn+1V+gF,p∇pTn+1V+gF,v∇vTn+1V−(∇gFTn+HgF)VTn}dΓ−∫ΓS{gS,z∇zTn+1V+gS,∇z∇∇zTn+1V−(∇gITn+HgI)VTn}dΓ−∫ΓI(gI,u∇uTn+1V+gI,p∇pTn+1V+gI,v∇vTn+1V+gI,z∇zTn+1V+gI,∇z∇∇zTn+1V)dΓ+∫ΓI(∇gITn+HgI)VTndΓ.To construct an adjoint system, consider Eqs. (71)–(73) at configuration(n+1). Changing the variables,u̇n+1→ξ¯,u¯→ξ,ṗn+1→ϕ¯,p¯→ϕ,żn+1→ζ¯,z¯→ζ,v̇n+1→φ¯,v¯→φsince each pair of them belongs to the same function space, the internal virtual work can be defined as(94)a(ξ¯,ξ)+b(ϕ¯,ξ)+c⌢(un+1;ξ¯,ξ)+d⌢(zn+1;ζ¯,ζ)+e(ξ¯,vn+1,ξ)+e(un+1,φ¯,ξ)+b(ϕ,ξ¯)+d⌢m(vn+1;φ¯,φ),whereξ¯,ϕ¯,ζ¯, andφ¯are the virtual velocity, pressure, displacement, and mesh velocity, respectively. Also, changing the variables,u̇n+1→ξ¯,ṗn+1→ϕ¯,v̇n+1→φ¯,żn+1→ζ¯in the implicit dependence terms in Eq. (93) since each pair belongs to the same function space, an adjoint load can be defined as(95)∫ΩF(fF,uξ¯+fF,pϕ¯+fF,vφ¯)dΩ+∫ΩS(fS,zζ¯+fS,∇z∇ζ¯)dΩ+∫ΓF(gF,uξ¯+gF,pϕ¯+gF,vφ¯)dΓ+∫ΓS(gS,zζ¯+gS,∇z∇ζ¯)dΓ+∫ΓI(gI,uξ¯+gI,pϕ¯+gI,vφ¯+gI,zζ¯+gI,∇z∇ζ¯)dΓ.The adjoint system of expressions (94) and (95) consists of a linear system of equations for the adjoint variables. Its tangent can be directly obtained from the converged tangent at configuration(n+1)in Eq. (62). The mesh velocityφin adjoint system is decomposed into a prescribed functionωthat is identical to the interface displacementζIand an arbitrary functionλthat satisfies a homogeneous boundary condition on the interfaceΓI:(96)φ=ω+λ=ζI+λF,ω∈Vandλ∈V¯.Also, the virtual mesh velocity can be decomposed into two virtual functions as(97)φ¯=ω¯+λ¯=λ¯,ω¯andλ¯∈V¯.In the fluid domain, the following can be defined for the discretized virtual velocityΞ¯F:(98)Ξ¯FT(JUFn+1ΛF+JUIn+1ΛI)≡a(ξ¯,ξ)+c⌢(un+1;ξ¯,ξ)+b(ϕ,ξ¯)+e(ξ¯,vn+1,ξ)=∫ΩFfF,uξ¯dΩ+∫ΓFgF,uξ¯dΓ+∫ΓIgI,uξ¯dΓ≡Ξ¯FTf^Un+1,where(99)ΛFT={ΞFTΦFTΦIT}and(100)ΛI=ZI.VectorsΞ,Φ, and Z (capital zeta) denote the discretized adjoint velocity, pressure, and displacement respectively. And over-bar denotes the corresponding discretized virtual functions. Also, the following can be defined for the discretized virtual pressureΦ¯T={Φ¯FTΦ¯IT.}:(101)Φ¯T(JPFn+1ΛF)≡b(ϕ¯,ξ)=∫ΩFfF,pϕ¯dΩ+∫ΓFgF,pϕ¯dΓ+∫ΓIgI,pϕ¯dΓ≡Φ¯Tf^Pn.Eqs. (98) and (101) are restated, in a matrix form, as(102){Ξ¯FΦ¯}T[JUFn+1JUIn+10JPFn+100]{ΛFΛIΛM}={Ξ¯FΦ¯}T{f^Un+1f^Pn+1}.Combining two rows in Eq. (102) usingΛ¯FT={Ξ¯FTΦ¯T}andf^FTn+1={f^UTn+1f^PTn+1}, the following is obtained:(103)Λ¯FT[JFFn+1JFIn+10]{ΛFΛIΛM}=Λ¯FTf^FTn+1.In the solid domain, takingΛS=ZS, the following holds for the discretized adjoint virtual displacementZ¯S:(104)Z¯ST(JSSn+1ΛS+JSIn+1ΛI)≡d⌢(zn;ζ,ζ¯)=∫ΩS(fS,zζ¯+fS,∇z∇ζ¯)dΩ+∫ΓSgS,zζ¯dΓ+∫ΓI(gI,zζ¯+gI,∇z∇ζ¯)dΓ≡Z¯STf^Sn+1.On the interface, using the fact thatΞ¯I=Z¯I, the following holds:(105)Z¯IT(JIFn+1ΛF+n+1JISΛS+JIIn+1ΛI+JIMn+1ΛM)≡Z¯ITf^In+1.For the discretized adjoint virtual mesh velocityΠ¯, the following can be written:(106)Π¯T(JMFn+1ΛF+n+1JMIΛI+JMMn+1ΛM)≡e(un+1,φ¯,ξ)+d⌢m(vn+1;φ¯,φ)=∫ΩFfF,vφ¯dΩ+∫ΓFgF,vφ¯dΓ+∫ΓIgI,vφ¯dΓ≡Π¯Tf^Mn+1,where(107)ΛM=ΘF.In Eq. (107),Θis the discretized vector ofλ. Finally, Eqs. (103)–(106) are expressed, in an algebraic form, as(108)[JFFn+10JFIn+100JSSn+1JSIn+10JIFn+1JISn+1JIIn+1JIMn+1JMFn+10JMIn+1JMMn+1]{ΛFΛSΛIΛM}={f^Fn+1f^Sn+1f^In+1f^Mn+1}.Note that the tangent in the adjoint equation (108) is the transpose of tangent for the sensitivity analysis in Eq. (91). Since Eqs. (94) and (95) are identical, the implicit dependence terms in Eq. (93) can be expressed as(109)−aV′(un+1,ξ)−bV′(pn+1,ξ)−cV′(un+1,ξ)−dV′(zn+1,ζ)−eV′(un+1,vn+1,ξ)−bV′(ϕ,un+1)−dVm′(vn+1,λ).Plugging expression (109) into Eq. (93) leads to(110)ψ′=−aV′(un+1,ξ)−bV′(pn+1,ξ)−cV′(un+1,ξ)−dV′(zn+1,ζ)−eV′(un+1,vn+1,ξ)−bV′(ϕ,un+1)−dVm′(vn+1,λ)−∫ΩF{fF,u∇uTn+1V+fF,p∇pTn+1V+fF,v∇vTn+1V−div(fFV)}dΩ−∫ΩS(fS,z∇zTn+1V+fS,∇z∇∇zTn+1V−div(fSV))dΩ−∫ΓF{gF,u∇uTn+1V+gF,p∇pTn+1V+gF,v∇vTn+1V−(∇gFTn+HgF)VTn}dΓ−∫ΓS{gS,z∇zTn+1V+gS,∇z∇∇zTn+1V−(∇gITn+HgI)VTn}dΓ−∫ΓI(gI,u∇uTn+1V+gI,p∇pTn+1V+gI,v∇vTn+1V+gI,z∇zTn+1V+gI,∇z∇∇zTn+1V)dΓ+∫ΓI(∇gITn+HgI)VTndΓ.Note that Eq. (110) is expressed in terms of only explicit dependence terms on the design.Using a Newton type iterative method, the ALE-based FSI problem should be solved simultaneously in fluid and solid domains at a specific time. Also, the required mesh velocity needs to be determined in a consistent way with the obtained solutions. Thus, a correct tangent for the systems of equations is crucial for the convergence and efficiency of the solutions. Consider a flow in a symmetric channel (shaded regions in Fig. 3) made of an elastic material whose properties are Young׳s modulusE=10,000, Poisson ratioν=0.3, mass densityρ=1, Lamé constantμ=0.1, and the thickness of elastic wall t=1.0. The fluid flows in the channel from the left-hand side of fluid domain. The profile of the prescribed flow velocity (u0=0.8) with the Reynolds number Re=288 and the geometry of the model are shown in Fig. 3. The units are non-dimensionalized and artificial material properties are selected to magnify the coupling effects between the fluids and solids. Due to the symmetry of the model, a half model is considered. The magnitude of the prescribed velocity is divided into 10 steps, which are applied in an incremental way. Fig. 4shows the deformed shape of solid and the contours for pressure and velocity vector whose direction and magnitude are expressed by the arrows.For the stability of fluid analysis, the fluid velocity and the pressure fields are discretized using a biquadratic and a bilinear quadrilateral shape functions (i.e., Q2/Q1), respectively. To meet the requirement that the virtual displacementz¯(s′)at the undeformed interface is equal to the virtual velocityu¯(s″)at the deformed interface, an identical shape function is utilized for the displacement in solids and the velocity in fluids.The whole load is divided into 10 load steps. The convergence criterion for j-th load step is usually expressed in a normalized form as(111)∥Δχj∥/∥χj∥≤10−5.In the j-th load step, a prescribed velocity of (j/10)u0is applied and all the incremental solutions such as displacementz, velocity u, pressure p, and mesh velocity v are plotted in a log scale. In all the loading steps, the ratio∥Δχi+1∥/‖Δχi‖2falls between 0.0112 and 0.5826. Fig. 5shows a quadratic convergence order in all kinds of solution such as the displacement in solids, the velocity and pressure of fluid, and the mesh velocity for ALE formulation, which implies that the excellent convergence and stability of solution are due to the accurate tangent of system matrix and the fact that the Q2/Q1 pair satisfies the Ladyzhenskaya–Babuska–Brezzi stability condition [24].To verify how accurately the derived analytical sensitivity is implemented, we compared the adjoint shape sensitivity with the finite difference one. In Fig. 6, the design domain is parameterized by cubic NURBS curves that include 10 control points. The x and y coordinates of arbitrarily selected three control points (#2, #5, and #8) are perturbed by the same amount in each direction. To determine the appropriate amount of perturbation in finite differencing, we performed the step size analysis for the shape design sensitivity of strain energy in solids. The design is perturbed byδb=10−5bas shown in Fig. 6(b) since the acceptable parameter of design perturbation is determined as10−5–10−8. The perturbed design in the figure is exaggerated by5×104times to distinguish the original and the perturbed designs. Taking the strain energy in solids as a performance measure,(112)ψ2=12∫ΩScijklεkl(zn+1)εij(zn+1)dΩ,and an adjoint system is defined from the expressions (94) and (95) as(113)a(ξ¯,ξ)+b(ϕ¯,ξ)+c⌢(un+1;ξ¯,ξ)+d⌢(zn+1;ζ¯,ζ)+e(ξ¯,vn+1,ξ)+e(un+1,φ¯,ξ)+b(ϕ,ξ¯)+d⌢m(vn+1;φ¯,λ)=d(zn+1,ζ¯).Using the adjoint responses obtained from Eq. (113), the first order variation of strain energy is derived as(114)ψ2′=−aV′(un+1,ξ)−bV′(pn+1,ξ)−cV′(un+1,ξ)−dV′(zn+1,ζ)−eV′(un+1,vn+1,ξ)−bV′(ϕ,un+1)−dVm′(vn+1,λ)+ψ2,V′(zn+1),where(115)ψ2,V′(zn+1)=−12∫ΩSCijklεkl(zi,tVt,j+zj,tVt,i+zp,tVt,izp,j+zp,izp,tVt,j−εijVt,t)dΩ.Table 1shows the shape design sensitivity of strain energy in solids. In Table 1, the forward difference method is used for the finite difference sensitivityΔψ2=ψ2(b+τδb)−ψ2(b), τ=1. Compared with the finite difference sensitivity, the adjoint sensitivity turns out to be very accurate. To verify the shape design sensitivity of solution, 3 representative nodes are selected as shown in Fig. 7. The adjoint variable method (AVM) results are compared with the finite difference sensitivities for all the degrees of freedom (DOF) of the selected nodes. The solutionχn+1at the positionx^in the domain can be expressed in an integral form as(116)ψ1=χn+1(x^)=∫Ωδ(x−x^)χn+1(x)dΩ,whereδ(x)is a Dirac delta function. Taking the first order variation of Eq. (116),(117)ψ1′=χ̇n+1(x^)=∫Ωδ(x−x^)χ̇n+1(x)dΩ,and the following adjoint equation can be defined, from Eqs. (94) and (95), as(118)a(ξ¯,ξ)+b(ϕ¯,ξ)+c⌢(un+1;ξ¯,ξ)+d⌢(zn+1;ζ¯,ζ)+e(ξ¯,vn+1,ξ)+e(un+1,φ¯,ξ)+b(ϕ,ξ¯)+d⌢m(vn+1;φ¯,λ)=∫Ωδ(x−x^)ι¯dΩ,whereι¯=ξ¯,ϕ¯,ζ¯,φ¯ifχ(x)=ui, p,zi,vi, respectively. Since there are no explicitly dependent terms in Eq. (117) on the design, the shape design sensitivity of the performance measure is obtained by(119)ψ1′=−aV′(un+1,ξ)−bV′(pn+1,ξ)−cV′(un+1,ξ)−dV′(zn+1,ζ)−eV′(un+1,vn+1,ξ)−bV′(ϕ,un+1)−dVm′(vn+1,λ).Table 2shows the shape design sensitivity of the solution. The developed shape DSA method is accurate and efficient compared with the finite difference. For all the DOFs, the adjoint design sensitivity (b) matches well with the finite difference one (a).Table 3shows the comparison of computation costs for the DSA. The forward finite difference method (FDM) requires as much computing costs as the response analysis. However, the adjoint variable method (AVM) requires only 2% of the analysis time.Consider the problem of flows in a channel (gray region). The fluid flows in the system from the bottom-left with a prescribed velocity and flows out of the system from the bottom-right, which is surrounded by the elastic walls as shown in Fig. 8. Artificial material properties are selected to magnify the coupling effects between the fluids and solids. The material properties, the prescribed velocity, and the Reynolds number of the flow are given in Table 4.A design optimization problem is formulated to obtain the optimal shape of solid structure in a channel under steady state incompressible viscous fluid flow. To find an optimal shape of stiff structure, the optimization is formulated to minimize the strain energy of solid under the constraint that the volume of fluid is bigger than the allowable volume:(120)minimizeψ2=12∫ΩScijklεkl(zn+1)εij(zn+1)dΩ,(121)subjecttoVFluid≥Vallowable,and the side constraints are given byblower≤bi≤bupper, whereblowerandbupperare the lower and upper bounds for the design variables, respectively. The outer solid region is a designable domain and the inner solid region is assumed to be non-designable. The outer solid and the fluid regions are parameterized by NURBS surfaces as shown in Fig. 9(a). The blue dots denote the control points, actually the design parameters. Through the design parameterization and mesh generation algorithm, a finite element model is obtained as shown in Fig. 9(b), where the red and blue lines denote the solid elements and the fluid elements, respectively. The interface is described by the cubic NURBS curve that consists of 10 control points. 18 design variables are selected as the coordinates of the control points as shown in Fig. 10. For the performance measure of strain energy in solids and the 18 design variables, the shape design sensitivity is obtained using the adjoint variable method (AVM) and compared with the finite difference sensitivity (FDM). Excellent agreement is observed for all of the design variables (Table 5).Table 6shows the comparison of computation costs for the DSA. The forward finite difference method (FDM) requires 18 times of the computing costs of the response analysis. However, the adjoint variable method (AVM) requires 46% of the analysis time for 18 design variables. To solve the nonlinear mathematical programming problem of Eqs. (120) and (121), a gradient-based optimization algorithm of MMFD (modified method of feasible direction) [25] is utilized. After the design optimization under the constraint of 100% allowable volume, the analysis results at the deformed configuration in the fluid domain for the original and the optimal designs are compared in Fig. 11. The arrows and contours represent the velocity vector and the pressure fields, respectively. Notice that the velocity changes more smoothly and the pressure value gets smaller after the shape optimization. The kinks of interface are smoothed to minimize the gradient of fluid velocity. Also, to minimize the inertial effects, the breadth of fluid gets smaller for the inlet and larger for the outlet, which is easily expected in an intuitive design. Also, the analysis results in the solid domain are compared in Fig. 12, where the dotted black line and the solid red line represent the un-deformed and the deformed shapes, respectively. Compared with the original design, the optimal one shows much smaller deformations in the solid domain. Fig. 13shows the history of the shape optimization problem. For the purpose of visualization, a log scale is used for the vertical axis since there is a significantly diminished decrease of objective function after 5th iterations. The strain energy in solids is decreased from 86.81839 to 0.422066, which is 0.5% of the initial value. Notice that the convergence is monotonic and its speed is quite fast, which implies that the derived tangent for the FSI analysis and the obtained adjoint shape design sensitivity are accurate and consistent with each other. During the optimization process, 126 response analyses and 24 design sensitivity analyses are required. If the finite difference sensitivity is used in this optimization problem, it is very time-consuming and could be impractical for large scale problems.

@&#CONCLUSIONS@&#
A coupled variational equation for FSI problems is derived using a steady state Navier–Stokes equation for incompressible flows, an equilibrium equation for geometrically nonlinear solids, a traction continuity condition at interfaces, and a pseudo-equilibrium equation for mesh velocity. The moving boundary in ALE formulation is included in the variational equations by the mesh velocity obtained by solving a displacement-loaded pseudo-structural problem at a unified configuration, which eventually facilitates to derive shape design sensitivity. To obtain the shape sensitivity without any time integrations, the mesh velocity should be determined together with the variational equations at a concurrent time step. Based on material derivative concept, a continuum-based adjoint shape sensitivity is derived under the ALE formulation, which turns out to be very accurate and efficient due to the utilization of converged tangent and the linearity of both adjoint and sensitivity equations. The computation for the response analysis is very time-consuming and expensive due to the nonlinearity of problems. However, the computing cost for the design sensitivity is trivial since the converged solution and the tangent in the response analysis are readily available. Using the developed adjoint DSA method, a shape design optimization problem is formulated for the FSI problems. To facilitate the shape variations, the whole domain including the fluids, solids, and interfaces is parameterized using NURBS surfaces. Through numerical examples, the accuracy and efficiency of the developed DSA method is verified using the finite difference sensitivity. The optimization process is shown to be very efficient and the computing cost for the shape design optimization is significantly reduced due to the obtained adjoint sensitivity.