@&#MAIN-TITLE@&#
Segment dependent dynamic multi-histogram equalization for image contrast enhancement

@&#HIGHLIGHTS@&#
This work utilizes the concept of histogram equalization.It introduces the new concept of even expansion of histogram bins.More emphasis has been given on avoidance of intensity saturation problem.New full dynamic range allocation of narrow segments has been introduced.New normalization function has also been introduced.

@&#KEYPHRASES@&#
Histogram equalization,Brightness preservation,Contrast enhancement,Multiple segmentation,Intensity saturation,

@&#ABSTRACT@&#
Histogram equalization (HE) method proved to be a simple and most effective technique for contrast enhancement of digital images. However it does not preserve the brightness and natural appearance of the images, which is a major drawback. To overcome this limitation, several Bi- and Multi-HE methods have been proposed. Although the Bi-HE methods significantly enhance the contrast and may preserve the brightness, the natural appearance of the images is not preserved as these methods suffer with the problem of intensity saturation. While Multi-HE methods are proposed to further maintain the brightness and natural appearance of images, but at the cost of contrast enhancement. In this paper, two novel Multi-HE methods for contrast enhancement of natural images, while preserving the brightness and natural appearance of the images, have been proposed. The technique involves decomposing the histogram of an input image into multiple segments based on mean or median values as thresholds. The narrow range segments are identified and are allocated full dynamic range before applying HE to each segment independently. Finally the combined equalized histogram is normalized to avoid the saturation of intensities and un-even distribution of bins. Simulation results show that, for the variety of test images (120 images) the proposed method enhances contrast while preserving brightness and natural appearance and outperforms contemporary methods both qualitatively and quantitatively. The statistical consistency of results has also been verified through ANOVA statistical tool.

@&#INTRODUCTION@&#
The use of cellphones and other portable multimedia devices equipped with high definition (HD) cameras are becoming popular. Although these devices are quite effective, however they fail to capture clearer pictures in low light environments such as twilight, dawn and sunset/sunrise. The low contrast images are also noticed in shade and overcast environment. Under low light conditions, light emitting diodes (LEDs) are an alternative to capture images within a short range. Therefore, in general, the images captured under low-light conditions are hardly of any use unless processed to enhance the contrast.A simple, popular and most effective technique for contrast enhancement is the histogram equalization (HE) [1]. The HE works on the cumulative distribution function based mapping of intensity levels. It flattens and stretches the dynamics range of the imageʼs histogram to achieve overall contrast enhancement [2]. HE has been successfully applied in various fields such as medical and satellite image processing. Despite of its popularity, conventional HE (CHE) is not suitable for implementation in consumer electronics devices, such as mobile phones and digital cameras being used to capture natural images. This is because of the fact that the HE normally introduces some undesirable artifacts in the processed images due to saturation of intensities. That is, some uniform regions in the processed image may saturate with very bright or very dark intensities. Thus, for the implementation of contrast enhancement in such devices, it is advisable that the processed image should retain the brightness and natural appearance of the input image [3]. Many solutions have been suggested to overcome this drawback of conventional HE. Most of these suggestions are based on multiple HE and can be broadly classified in two groups namely Bi-HE [4–8] and Multi-HE [8–15].The brightness preserving bi-histogram equalization (BBHE) method has been one of the earliest works in this direction [4]. It divides the histogram of input image into two sub-histograms using the mean intensity as threshold and then each sub-histogram is equalized independently. A similar approach referred to as dualistic sub-image histogram equalization (DSIHE) has also been developed, according to which histogram division is based on the median intensity value [5]. It has been claimed that DSIHE is better than BBHE in terms of preserving brightness and entropy of the image. An improved, although complex brightness preserving method, known as minimum mean brightness error bi-histogram equalization (MMBEBHE) has been reported in [6]. It is based on the minimum absolute mean brightness error (AMBE) between input mean value and output mean value, as a threshold intensity level. Recently, the improved versions of BBHE have been suggested [7,8]. Such methods are based on setting the plateau limits in order to avoid intensity saturation. If the frequency of occurrence of intensity exceeds the plateau limit, corresponding frequency is replaced by a plateau limit, else remain the same as the original bin. Depending upon mean and median based plateau limits, these methods have been referred to as bi-histogram equalization plateau limit (BHEPL) [7], and bi-histogram equalization median plateau limit (BHEPL-D) [8]. Further, it is claimed [7,8] that the resultant image will be prevented from intensity saturation and is free from problems of over-enhancement. However in the present study, it is believed that the intensity saturation is not the sole problem that needs to be avoided, but the expansion of intensity levels (after HE process) also plays an important role.To further preserve the brightness and natural appearance of the input image, the histogram may be segmented into more than two sub-histograms, and each sub-histogram may be equalized independently. This approach referred to as Multi-HE in literature, has been proved to be quite effective for contrast enhancement while preserving brightness and natural appearance. The basic idea in Multi-HE is to segment the histogram into large number of segments; the segment boundaries (threshold) are determined using mean [9], median [10] and variance [11]. The Multi-HE methods preserve the brightness, as each histogram segment (when equalized) yield lesser shift in the brightness compared to Bi-HE and conventional HE methods [9]. Due to this reason, the Multi-HE methods are expected to preserve both brightness and natural appearance of the processed image. Among the Multi-HE methods, recursive mean-separate histogram equalization (RMSHE) [9] and recursive sub-image histogram equalization (RSIHE) [10] are the respective extensions of BBHE and DSIHE methods. These methods use either mean or median intensity of an image as a threshold value to segment its histogram into two parts, each segment is then separated into two parts and process is repeated recursively, resulting in2γsegments (where γ is a positive integer, representing the number of iterations). Two minimum-within-class-variance based histogram segmentation methods have been developed that preserve the brightness to some extent, however it suffers a poor performance in terms of contrast enhancement [11]. A hybrid Multi-HE scheme has also been developed, that uses image mean (at first level) and within-class-variance (at subsequent levels) as threshold values for histogram segmentation, and then equalizes each segment independently [12]. The scheme is further modified in [13], which uses Gaussian filters for smoothing the histogram of input image before segmenting and equalizing each segment independently. The Multi-HE methods [9–12] are expected to have better brightness preservation property for the larger values of integer ‘γ’. However, for relatively larger values of integer ‘γ’, the histogram of processed image tends to be similar to input histogram while the processed image tends to be a copy of the input image without any contrast enhancement [16].In Multi-HE methods discussed above [9–13], the segment boundaries usually cluster around larger probability regions of histogram, as evident from Fig. 1(a). As a result many narrow range segments may be observed, which are separately shown in Fig. 1(b). The conventional HE, when applied to these narrow ranged segments, may not expand their dynamic range effectively thereby resulting in poor contrast of the processed image. To overcome this problem, Dynamic HE (DHE) method has been suggested [14]. DHE segments the histogram of input image using local minima of histogram, and a new dynamic range is assigned to each segment based on the original dynamic range and the number of pixels in the corresponding segment. However, under low light conditions DHE suffers with intensity saturation problems and produces undesirable artifacts [15]. Also, DHE gives emphasis on contrast enhancement without preserving the brightness [17]. Other Multi-HE based dynamic equalization approaches are dynamic quadrants histogram equalization plateau limit (DQHEPL) [8], and quadrants dynamic histogram equalization (QDHE) [15]. These techniques use DHE and plateau based clipping to avoid intensity saturation problem. It is worth noting that, these methods rely on the assumption that natural appearance of images can be preserved by avoiding the intensity saturation problem only; which is not true. It is observed that in order to maintain the natural appearance of the processed image, not only the intensity saturation should be avoided but also it is necessary that HE on each segment should expand the intensity levels evenly. This fact can be verified by observing the images processed by DQHEPL method. Despite the negligible intensity saturation problem in this algorithm, the processed images do not have the natural appearance. This is due to the fact that the HE on each segment expands the intensity levels un-evenly. To overcome the problems of brightness shift, visual artifacts and intensity saturation in the processed image, many other HE methods have also been proposed in the literature [18–25].In this paper we propose a novel method, which ensures that pixel intensities within each segment are expanded evenly while avoiding intensity saturation problem, resulting into preservation of brightness and natural appearance of the image. The proposed method segments the histogram of input image into sub-histograms using mean and median as thresholds. The image having narrow peaks in the histogram, when segmented may result into many narrow segments (sub-histograms). The HE over these narrow ranged segments may not be able to enhance the contrast until they are expanded efficiently. This work proposes allocates full dynamic range to the narrow segments before HE process, as shown in Fig. 1(c). The proposed method, named as Segment Dependent Dynamic Multi-Histogram Equalization (SDDMHE), because it allocates new full dynamic range only to narrow ranged segments, after that HE is applied to each segment independently. The final step involves the application of normalization function, so that the saturation as well as un-even expansion of intensities can be avoided and natural appearance can be preserved more precisely. The proposed SDDMHE method is likely to produce better images as compared to other methods.Remainder of the paper is organized as follows: The conventional HE is described in Section 2. Section 3 presents overview of histogram segmentation process. Section 4 presents the details of proposed method. Simulation results and discussion are given in Section 5, and finally paper is concluded in Section 6.This section reviews the basic concept of conventional HE method for contrast enhancement of images. It maps the input intensity levels to new levels using the cumulative distribution function (cdf) as a transformation function. Consider the input imageI(i,j)of dimensionu×vhaving L discrete intensity levelsX0,X1,…,XL−1(for 8-bit image,L=256). For simplicity kth intensity levelXkis denoted by k. The probability distribution function (pdf) for kth intensity level is defined as:(1)p(Xk)=n(Xk)/(∑k=0L−1n(Xk))=n(Xk)/Nwhere, k is an integer in the range 0 toL−1i.e.k∈[0,L−1],n(Xk)is number of pixels with kth intensity level, andN(=u×v)is total number of pixels in the image. The histogram of an image,H[Xl,Xu]is simply the plot ofn(Xk)vs.Xk, whereXlandXuare lower and upper intensity levels respectively. The cumulative distribution function (cdf) is defined as:(2)c(Xk)=∑q=0kp(Xq)∀k∈[0,L−1]where,c(Xk)is the cdf at the kth intensity level. It may be noted thatc(XL−1)will always be unity. The conventional HE method maps the input image I (having dynamic range(Xl,Xu)) into the entire range (X0,XL−1) by using the cdf as a transformation function. Let T be the transformation function which maps the input intensity levelXkinto output intensity levelT(Xk)is defined as:(3)T(Xk)=X0+⌊(XL−1−X0)×c(Xk)⌉where,⌊x⌉is the integer nearest to x. It can be noticed from (3), that the transformation function T is the scaled version of cdf. The HE therefore, uses the histogram of the input image to obtain the transformation function. Thus the output imageO(i,j)can be obtained as:(4)O(i,j)=T[I(i,j)]∀(i,j)∈ISince the contrast enhancement of HE is proportional to the height of the histogram, the intensity levels with large number of pixels (high peaks) are expanded to a larger range as compared to the intensity levels with lower number of pixels [26]. Although HE method efficiently utilizes display intensities, it tends to introduce visual artifacts and loss of natural appearance in the processed image. Also as mentioned earlier, HE tends to shift the mean brightness of the image to the mid-intensity level (i.e.L/2), which is not desirable.The brightness preservation is commonly achieved by applying HE over multiple segmented histograms (sub-histograms), instead of global histogram [4,5]. Various approaches which select the threshold values (boundaries) for histogram segmentation have been suggested in the literature [9–11]. To explain the concept of histogram segmentation, letH[Xl,Xu]be the global histogram of the input imageI(i,j), whereXlandXuare lower and uppermost intensities of the image. LetH[Xl,Xu]be segmented into n sub-histograms i.e.(5)H[Xl,Xu]=⋃r=1nHr[Xlr,n,Xur,n]where,Hrrepresents rth segment of H.Xlr,nandXur,nrepresent lower and uppermost boundaries of rth (out of n) segment respectively. It should be noted thatXl1,n=XlandXun,n=Xu. In literature, HE with two segments (n=2) and more than two segments (n>2) are referred to as Bi-HE and Multi-HE respectively. Each of the segmented histogramsHrrepresents a sub-imageIr,nhavingXlr,nandXur,nas lower and upper intensity levels respectively. The segment boundariesXlr,nandXur,ndepend on the criterion used for the segmentation. Two common criteria for histogram segmentation are the mean [4] and median [5] which are described below.For the imageI(i,j)having histogramH[Xl,Xu]or its pdfp(Xk)as defined in (1), the mean intensity value (m) of the image is defined as:(6)m=⌊∑k=XlXuXk.p(Xk)⌉The mean intensity value (m) is then selected as the threshold for decomposing the image histogram into two segments i.e.H1[Xl1,2,Xu1,2]andH2[Xl2,2,Xu2,2], where each segment represents a sub-image. Note thatH1[Xl1,2,Xu1,2]consists of{Xl,Xl+1,…,m}intensity levels andH2[Xl2,2,Xu2,2]consists of{m+1,m+2,…,Xu}intensity levels. The corresponding sub-images may be represented as:(7)I1,2={I(i,j)|I(i,j)⩽m,∀(i,j)∈I}(8)I2,2={I(i,j)|I(i,j)>m,∀(i,j)∈I}Alternative to mean-based segmentation, the median based segmentation has also been attempted [5]. Assume that A is an array consisting of image pixels in the ascending or descending order, andN(A)is the number of elements in that array. IfXkis the middle index of A, then median intensity ‘μ’ is defined as:(9)μ={A(Xk)ifN(A)is odd(A(Xk)+A(Xk+1))/2ifN(A)is evenThe corresponding sub-images may be represented as:(10)I1,2={I(i,j)|I(i,j)⩽μ,∀(i,j)∈I}(11)I2,2={I(i,j)|I(i,j)>μ,∀(i,j)∈I}where,Ir,nis the rth sub-image out of total n sub-images.The above segmentation approaches can be extended to higher levels by applying them iteratively on each segment [9,10], resulting in Multi-HE methods. In Bi-HE and Multi-HE, each of the segmented histograms (Hr) are equalized independently. Since HE has the tendency to shift the mean brightness towards mid-point of allowed range of intensities for equalization, therefore the output images of Bi-HE (n=2) methods likely to have their mean brightness in the middle of input mean intensity andL/2intensity levels. As n increases, the mean brightness of processed image approaches towards mean intensity of input image, and therefore suitable for preserving the brightness. However n should not be increased too much, as it increases the complexity and reduces contrast enhancement performance.

@&#CONCLUSIONS@&#
