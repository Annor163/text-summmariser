@&#MAIN-TITLE@&#
A comprehensive performance analysis of EEMD-BLMS and DWT-NN hybrid algorithms for ECG denoising

@&#HIGHLIGHTS@&#
Six signal processing methods for denoising ECG signals are proposed and compared.The hybrid methods EEMD-BLMS, EEMD-LMS and WNN produced the best denoising results.Specific residual noise characteristics are observed in each method.Performances of the methods deteriorated when the signal and noise spectra overlap.

@&#KEYPHRASES@&#
Electrocardiogram (ECG),Denoising,Ensemble empirical mode decomposition (EEMD),Block least mean square (BLMS),Discrete Wavelet Transform (DWT),Neural Networks (NN),

@&#ABSTRACT@&#
Electrocardiogram (ECG) is a widely used non-invasive method to study the rhythmic activity of the heart. These signals, however, are often obscured by artifacts/noises from various sources and minimization of these artifacts is of paramount importance for detecting anomalies. This paper presents a thorough analysis of the performance of two hybrid signal processing schemes ((i) Ensemble Empirical Mode Decomposition (EEMD) based method in conjunction with the Block Least Mean Square (BLMS) adaptive algorithm (EEMD-BLMS), and (ii) Discrete Wavelet Transform (DWT) combined with the Neural Network (NN), named the Wavelet NN (WNN)) for denoising the ECG signals. These methods are compared to the conventional EMD (C-EMD), C-EEMD, EEMD-LMS as well as the DWT thresholding (DWT-Th) based methods through extensive simulation studies on real as well as noise corrupted ECG signals. Results clearly show the superiority of the proposed methods.

@&#INTRODUCTION@&#
Electrocardiogram (ECG) is a measure of the electrical activity of the heart, and is obtained by surface electrodes at standardized locations on the subject's chest. During acquisition, various artifacts/noises such as the baseline wander, power-line interference, muscle contraction and electrode movements obscure the ECG. It is important that these artifacts are minimized for the clinicians to make better diagnoses on heart problems.Conventional filters such as the finite impulse response (FIR) [1,2], infinite impulse response (IIR) [3,4], filter banks [5], polynomial filter [6] and Wiener filter [7] have been proposed in the literature to minimize artifacts. Other approaches for ECG denoising include adaptive filters, namely the least mean square (LMS), recursive least square (RLS) and their variants such as the block LMS (BLMS), normalized sign-sign LMS (NLMS) etc., [8–20]. Adaptive Kalman filter and extended Kalman filter were also suggested by some researchers [21–24]. Promising performances were obtained by nonlinear methods such as the Bayesian filtering and nonlinear projective filtering [25,26].Methods of decomposing the signals into sub-components for noise reduction have become popular and were proposed for denoising the ECG signals. They include the independent component analysis (ICA), singular value decomposition (SVD), empirical mode decomposition (EMD), and ensemble EMD (EEMD) [27–31]. Soft, hard and adaptive thresholding methods have also been proposed on EMD and EEMD schemes [32]. Wavelet transformation (WT) has been shown to be a powerful tool for denoising signals in the frequency domain [33,34] and has been proposed for ECG denoising [35–41]. It has conventionally been used by applying soft or hard thresholds on the obtained discrete WT (DWT) coefficients [42,43]. A combination of DWT with Wiener filtering has been proposed by Kesler et al [44]. Recently, hybrid schemes have been proposed to improve the denoising performance. For example, in [9], the EMD and EEMD methods were used to provide the reference inputs to the BLMS adaptive filter. In another scheme, the DWT and Neural Networks (NN) are combined to minimize the noise in ECG and have shown to provide better performances than conventional wavelet methods [45–47].In this paper, a comprehensive analysis of the performances of two hybrid schemes for denoising ECG signals is presented. They are: (i) the EEMD based method in conjunction with the BLMS adaptive filter, namely the EEMD-BLMS approach, and (ii) the DWT based method combined with the NN, named as the Wavelet NN (WNN) approach. These methods are compared to the conventional EMD (C-EMD), conventional EEMD (C-EEMD), EEMD-LMS, and Discrete Wavelet Transformation thresholding (DWT-Th) methods [42] by performing extensive simulation studies on real as well as simulated noise corrupted ECG signals. These six methods are interesting as they are able to adapt to the time varying nature of ECG and minimize the noises with a minimum signal distortion [31]. Furthermore, these methods are able to separate the noise components from the recorded ECG signals automatically, and can therefore be used in situations where ECG data from only one lead is available, like in an ambulatory ECG.The remainder of the paper is organized as follows: Section 2 describes the six ECG denoising approaches proposed in this study followed by a detailed discussion of the results on simulated and real data in Section 3. The paper concludes with some final remarks in Section 4.The proposed ECG denoising approaches are briefly described in this section. First of all, the observed ECG signal is modelled as,(1)x(n)=d(n)+v(n),where d(n) represents the desired ECG signal, andv(n)is the noise which corrupts the desired signal.C-EMD is an iterative process by which a signal is decomposed into subcomponents, namely the intrinsic mode functions (IMFs) [48]. From the observed signal x(n), the lower and upper envelopes (envl(n) and envu(n)) are found by interpolating the local maxima and minima with cubic splines. The average of these envelopes provides an approximation of the lowest frequencies present in the signal x(n), which is subtracted from the signal to produce,(2)x˜(n)=x(n)−12envl(n)+envu(n).This process is repeated onx˜(n)and the subsequent signals until the mean value found by the envelopes are close to zero, and the number of maxima and minima are equal or differ utmost by one. The resulting signal at this point is the first IMF (IMF1(n), representing the highest frequencies). The second IMF is found by performing the same process on the residue signal, r1(n)=x(n)−IMF1(n). For each repetition of the process, a new IMF and residue are obtained, and the process is stopped when the residue becomes monotonic. At this point, a certain number of (say K) IMFs have been obtained, and the original signal could then be synthesized as,(3)x(n)=rK(n)+∑i=1KIMFi(n),where rK(n) is the residue after the extraction of IMFK.In the literature, C-EEMD is described as a “noise assisted data analysis method”, wherein the mode mixing problem associated with EMD is reduced through averaging multiple EMD results [29]. It is achieved by simulating several white noise variants and adding them to the signal x(n) to generatexv(n)(v=300−1000) as shown in Eq. (4) and performing EMD on each of them.(4)xv(n)=x(n)+ɛwv(n),where ɛ controls the amplitude of the added white noise. An average of these 300–1000 sets of IMFs ofxv(n)'s produce the final IMFs. In both the C-EMD and C-EEMD approaches, the denoised ECG signals are obtained by subtracting the IMFs corresponding to the noise components from the observed ECG signals [29–31].Adaptive filtering schemes require the primary (desired signal + noise) and reference (noise which is correlated to the noise in the primary input) inputs. In this work, only the primary input (x(n)) is available. The IMFs derived from x(n) using the C-EEMD method are used as reference inputs to the LMS and BLMS filters.The framework for both the LMS and BLMS adaptive filtering is illustrated in Fig. 1. Here, IMFk(n); k=1, 2, …, K is used as the kth reference input,yˆk(n)is the corresponding noise estimate from the filter, andek(n)=ek−1(n)−yˆk(n)is the error signal witheK(n)=dˆ(n)=x(n)−vˆ(n). Here the estimate of the noise componentv(n)in the primary input is given by,vˆ(n)=∑k=1Kyˆk(n).In the BLMS filters, the filter coefficients are updated block-wise, unlike in the conventional LMS filters where the coefficients are updated in a sample-by-sample fashion. The computational steps for the BLMS filter (say the kth filter in Fig. 1) is described here. First, the signal inputs to the BLMS filters are partitioned into non-overlapping blocks of length L. These blocks are then filtered by a FIR filter of length P. The filter coefficients are kept fixed for each block of data, and the adaptation of the coefficients are performed block-wise [49]. Let m=0, 1, … denote the block index and the filter coefficient vector for mth block of the kth filter be,(5)wk(m)=[w0k(m),…,wP−1k(m)]T,m=0,1,…With the original sample index, n=mL+i, i=0, 1, …, P−1, and ∀m, the input vector to the kth adaptive filter at sample index n can be written as,(6)uk(n)=[IMFk(n),IMFk(n−1),…,IMFk(n−P+1)]TThe corresponding filter outputyˆk(n)=wkT(m)uk(n)is the noise estimate and the error signal is,ek(n)=ek−1−yˆk(n)with e0(n)=x(n). Filter weights wk(m) are updated as [49]:(7)wk(m+1)=wk(m)+μkblms∑i=0L−1uk(mP+i)e(mP+i).Hereμkblmsis the step-size parameter and is chosen as,(8)0<μkblms≤2P∑i=1Pλi,whereλi′sare the eigenvalues of the input covariance matrix. If the filter length P is chosen to be equal to L, the update rule can be written as,(9)wk(m+1)=wk(m)+μkblms∑i=0L−1uk(mL+i)ek(mL+i).The conventional LMS filter can be seen as a special case of the BLMS filter with a block length L=1. Hence, the block index m can be replaced by the sample index n and thereby the update rule for the kth LMS filter is given by Eq. (10):(10)wk(n+1)=wk(n)+μklmsuk(n)ek(n).The step-sizeμklmsfor the LMS filters are chosen as,(11)0<μklms≤2λmax,where λmaxis the maximum eigenvalue of the input covariance matrix. A flowchart of the EEMD-BLMS algorithm can be seen in Fig. 2.DWT is used to obtain the frequency information over time for the given signal x(n). It has the inherent property of increasing the temporal resolution for high frequencies, and increasing frequency resolution for low frequencies making it a suitable tool for analyzing biological signals. Given x(n), its DWT can be derived as follows:Let ψ=[ψ(0), ψ(1), …, ψ(N−1)]Tand φ=[φ(0), φ(1), …, φ(N−1)]Tbe two orthogonal basis functions and let j0=0, N=2j, j=0, 1, …, J−1 and q=0, 1, …, 2j−1. Here, j represents different scale levels, and q represents the translation in each scale level. The wavelet coefficients (Wφ− approximation and Wψ− detail) corresponding to x(n) are given by,(12)Wφ(j0,q)=1N∑n=0N−1x(n)φj0,q(n),∀q,(13)Wψ(j,q)=1N∑n=0N−1x(n)ψj,q(n),∀q,∀j>j0.Most wavelet denoising approaches rely on wavelet thresholding, by imposing a soft or hard threshold either globally or on the individual coefficients [43]. The outputs of hard and soft thresholding are described by Eqs. (14) and (15), respectively.(14)zj(q)=Wψ(j,q)ifWψ(j,q)>Tj0ifWψ(j,q)<Tj.(15)zj(q)=Wψ(j,q)−TjifWψ(j,q)>Tj0ifWψ(j,q)<Tj.Tj's in the equations are the desired thresholds [50]. We use Daubechies-8 (Db8) in this study to find the DWT of x(n) [51] and the thresholds are found manually from the first set of x(n) (observed ECG signal) by finding a constant Q proportional to the coefficients power, such that:(16)Tj=QjCj,j=0,1,…,11,where Cjis the power of the detail coefficient at the jth scale level. The threshold is then applied to all ECG signals as per Eq. (15) and subsequently the inverse DWT (IDWT) is performed to reconstruct the denoised ECG signal [42].In the WNN approach, wavelet decomposition is performed on x(n), and the resulting coefficients (detail and approximation) are fed to the NN for the estimation of d(n). The signal x(n), n=0, 1, …, N−1, of length N samples is first zero padded (256 zeros in the beginning and in the end) to generate a new signal (x′(n)) of length N+512. To mitigate the varying effect of zero-padding, a sliding window approach for extracting wavelet coefficients is adopted. From x′(n), using a sliding window (with an overlap of 512 samples), N smaller data segments of length 513 samples are extracted. Each of these smaller segments are subjected to DWT which results in 513 sets of 14 wavelet coefficients (13 detail (Wψ) and 1 approximation(Wφ)) which are arranged in a matrix of dimension 14×513. From these wavelet coefficients matrices, the 14 coefficients corresponding to specific smaller data segments (for example, x(n)) is extracted as the 257th column of the respective matrices. The corresponding input vector xDWT(n) (of length 154=14×11) to the NN is obtained by concatenating 11 columns (252:262) of the respective wavelet coefficient matrix. The incorporation of wavelet coefficients of the ten neighboring samples of x(n) into xDWT(n) provides the NN with temporal information and thereby improves its performance. A multilayer perceptron (MLP(154:38:38:1)), trained using the Bayesian regularization backpropagation (BRBP) algorithm, is used in this study [52,53]. A flowchart describing the steps in the DWT-NN algorithm can be seen in Fig. 3.

@&#CONCLUSIONS@&#
