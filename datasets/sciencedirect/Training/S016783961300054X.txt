@&#MAIN-TITLE@&#
Splines and unsorted knot sequences

@&#HIGHLIGHTS@&#
The definition of a B-spline is extended to unordered knot sequences. The resulting smooth piecewise polynomial of minimal support is named U-spline.U-splines can be negative and locally linearly dependent.Yet, linear combinations of U-splines share many B-spline properties including smoothness, polynomial reproduction, and evaluation by recurrence.

@&#KEYPHRASES@&#
Spline,Unsorted knot sequence,de Boor,Recurrence,Basic interval,

@&#ABSTRACT@&#
The definition of a B-spline is extended to unordered knot sequences. The added flexibility implies that the resulting piecewise polynomials, named U-splines, can be negative and locally linearly dependent. It is therefore remarkable that linear combinations of U-splines retain many properties of splines in B-spline form including smoothness, polynomial reproduction, and evaluation by recurrence.

@&#INTRODUCTION@&#
A univariate spline of degree d consisting ofn+dpolynomial pieces is defined by n B-spline coefficients andn+d+1real-valued scalarstj, called knots. By convention, these knots are listed in non-decreasing order. It is natural to ask what advantages or drawbacks arise if we drop this convention and define splines using an unsorted knot sequence. Unsorted knot sequences appear, for example, as a special case of splines with complex knots (Goldman and Tsianos, 2011) and arise in interpolation problems for linear reproduction, as shown in Example 3.2 of this paper. One approach to splines, polar forms (Ramshaw, 1989), lists ordering-independence as one of its fundamental properties; however, all detailed discussions and lecture notes assume either sorted knots or non-repeated knots. Of the many interactive online illustrations of splines only a small number, four at current counting, allows manipulating the knots. Of these, all but one either block knots from passing one another or re-sort the knot sequence (e.g. the nice applet (Kilian et al., 2013)). Only one illustration (Kraus, 2013) allows for full flexibility of knots, but encounters singularities. Apart from applications, the motivation for exploring U-splines is to probe and re-enforce the notions, proofs and properties underlying splines.The first hint of what splines for unordered knot sequences might look like arose from a Gedankenspiel by Carl de Boor, Malcolm Sabin and the author a decade ago, that, fortj>tj+1, the analogue of a B-spline of degree 0 might be defined as the negative of the characteristic function of the interval[tj+1..tj]. Ten years on, this ansatz is substantiated by U-splines.Overview. In Section 2, U-splines are defined for unsorted, but ‘collocated’ knot sequences. A collocated knot sequence repeats knot values only consecutively or sufficiently spaced apart. As is customary for B-splines, the ith U-spline of degree d is associated with the subsequenceti:i+d+1:=(ti,ti+1,…,ti+d+1), but now of the unsorted knot sequencet0:n+d. A useful insight, Lemma 2.1, is that any U-spline can be expressed as a multiple of the B-spline with the same, but sorted subsequence of knots. Alternatively we derive, again for unsorted, collocated knot sequences, a U-spline of higher degree by recurrence from U-splines of lower degree. The recurrence is that of B-splines, but it starts from signed characteristic functions.In Section 3 we characterize the space spanned by U-splines. To this end, we need to ‘complete’ finite knot sequences and clarify, for U-splines, the notion of ‘basic interval’. The notion appears, in deceptively simple form, when analyzing splines in B-spline form. On a basic interval, the U-splines form a partition of unity, Marsdenʼs identity holds, they have linear precision and we can compute derivatives via differences of coefficients. But since U-splines may take on negative values, they can be locally linearly dependent.Section 4 shows that a slight variant of de Boorʼs algorithm evaluates splines with collocated, unsorted knots. Prior to evaluation, any U-spline whose first knot equals its last knot has to be removed and, in the final step of the modified algorithm, the values of multiple intervals containing the point of evaluation have to be summed. Knot insertion is well-defined but does not imply variation diminution as for B-splines. Finally, Section 5 gives an example of knots that are not collocated. For the example no two-term evaluation recurrence with convex weights can correctly evaluate the associated spline. This points to collocated sequences as a maximal practical generalization of non-decreasing knot sequences.We start by characterizing an important sub-class of all unsorted knot sequences.Definition 2.1Collocated knot sequenceLett0:n+dbe an unsorted sequence of real scalars called knots hereafter. This knot sequence is d-collocated if(L)∀0<j⩽d,ti=ti+j⇒ti=ti+1=⋯=ti+j.That is, if any knot of a collocated sequence is repeated after fewer than d entries then all intermediate knots must have the same value.Whenever the degree d is clear from the context, we simply say that the knot sequence is collocated. A collocated sequence appears to be necessary to establish basic properties and apply algorithms that make splines useful (see (1), (9), (18), (21), Section 5 of this paper).For collocated knot sequences, we define U-splines analogous to B-splines via a table of divided differences(ti:j). For a sufficiently smooth univariate real-valued function h with kth derivativeDkh,(1)(ti)h:=h(ti),(ti:j)h:={((ti+1:j)h−(ti:j−1)h)/(tj−ti),ifti≠tj,Dj−ih(j−i)!(ti),ifti=tj,j∈{i+1,…,i+d+1}.Since for collocated knots,ti=tjimplies thatti=ti+1=⋯=tj, the definition is consistent in that the second case of (1) is the limiting case of the first whenti→tj.Definition 2.2U-spline from divided differencesLetti:i+d+1be an unsorted, d-collocated knot sequence. Then the piecewise polynomial of degree d defined by(2)U(x|ti:i+d+1):=(ti+d+1−ti)(ti:i+d+1)(max{(⋅−x),0})d,is called a U-spline.Ifti:jis a non-decreasing sequence then its knots are automatically collocated andU(x|ti:j)is a B-splineB(x|ti:j)as defined in de Boor (2001, IX(2)).The constructive definition of divided differences is typically arranged in the form of a divided difference table as in recurrence (1). An alternative is to define(ti:j)has the leading coefficient of the polynomial that interpolates h at the knotsti:j(Conte and de Boor, 1980, p. 42). This equivalent definition is clearly invariant under re-ordering ofti:j:=(ti,…,tj). Therefore, together with (2), we have the following useful Lemma 2.1, first suggested in this form by Carl de Boor.Lemma 2.1Re-ordering of knotsIfsi:jis any re-ordering ofti:jthen(3)(sj−si)U(x|ti:j)=(tj−ti)U(x|si:j).In particular, for any re-orderingsi:jofti:j, and end-knots p and q of the knot sequence,(4)U(x|p,ti:j,q)=U(x|p,si:j,q),(5)U(x|p,ti:j,q)=−U(x|q,ti:j,p),(6)U(x|q,ti:j,q)=0.Eq. (6) explains why property (L) need not rule out U-splines whose first and last knots are equal: when dealing with linear combinations of U-splines, the contributions of U-splines of the formU(x|p,…,q)withp=qare anyhow zero.Since a U-spline with a sorted, non-decreasing knot sequence is a B-spline with that sequence, Lemma 2.1 implies that we can express any U-spline with non-constant sequenceti:jas a B-spline(7)U(x|ti:j)=tj−tisj−siB(x|si:j),wheresi:j:=sort(ti:j).Therefore, the space of U-splines is spanned by the B-splinesB(x|si:j)and it inherits the piecewise polynomiality and continuity of these B-splines.Sorting the whole knot sequence t of a spline can however introduce subsequences of lengthd+2that do not occur when separately sorting the knot subsequences of t. Consider for examplet:=(0,1,1,0)andd=1. All U-splines corresponding to t are a multiple ofB(x|0,1,1), while the sorted sequences:=sort(t)=(0,0,1,1)gives rise toB(x|0,0,1)andB(x|0,1,1). That is, global sorting of the knots changes the spline space. Lemma 3.3 will characterize the relation in more detail.U-splines via recurrence. An alternative approach to B-splines is to construct higher-degree B-splines from lower degree ones. Since the recurrence relations for B-splines are based on the divided difference representation, the recurrence applies equally well to U-splines. Only the initialization differs. For a U-spline the initialization has to reflect property (5) thatU(x|p,q)=−U(x|q,p).Lemma 2.2U-spline recurrenceFor a collocated knot sequencet0:n+d,x∈Rand integers i, j, k,(8)U(x|ti:i+1)={1ifti⩽x<ti+1,−1ifti+1⩽x<ti,0otherwise;(9)U(x|tj−1,tj:k,tk+1):={x−tj−1tk−tj−1U(x|tj−1,tj:k)iftk≠tj−10otherwise}+{tk+1−xtk+1−tjU(x|tj:k,tk+1)iftk+1≠tj0otherwise}.Property (L) ensures that setting summands to zero is the correct limiting behavior: the denominator and the leading linear factor of U in definition (2) cancel one another and the remaining divided difference is, by (L) and (1), well-defined as a derivative of orderk−j+1of a polynomial of degree at mostk−j. Irrespective of the case distinction at the recurrence start, the proof, that the recurrence (9) yields the U-splines defined in Definition 2.2, is identical to that for B-splines (de Boor, 2001, IX(13)), i.e., it is based on Leibnizʼ formula applied to the divided differences.The support ofU(x|ti:i+k)is evidently[min(ti:i+k)..max(ti:i+k)].To analyze the space spanned by U-splines, we need to generalize some notions that are rarely emphasized for B-splines but that are crucial for the analysis of splines with non-decreasing knot sequences.Complete knot sequences. When t is a non-decreasing sequence, then extending it to a biinfinite (non-decreasing) knot sequence avoids a specialized discussion of the first and last d intervals. Alternatively, one may repeat the first knot of the non-decreasing sequence k times and the last knot k times.For unsorted knots, neither approach, making the knot sequence biinfinite or repeating knots, yields the same benefits. A biinfinite sequence may still jump back and forth and the repeated knots may lie anywhere in the original interval of supportI:=[min(t0:n)..max(t0:n)]. We therefore define an augmented knot sequence that encloses I as follows.Definition 3.1d-complete knot sequenceGiven the unsorted knot sequencet0:n,n⩾k:=d+1>0and its sorted re-orderings0:n, lett<0andt>nbe two sequences of k knots each such thatmax(t<0)⩽s0andsn⩽min(t>n). Then(t<0,t0:n,t>n)is a complete knot sequence for the intervalI:=[s0..sn].Partition of 1. Traversing a complete knot sequence in its order on the real line implies that I is traversed one more time in increasing order, froms0tosn, than in decreasing order: all contributions of negative and positive characteristic functions due to reversals of traversal direction cancel one another, except for one non-decreasing sequence required to connects0tosn. By (8), ford=0, this implies on I that(10)∑iU(x|ti:i+1)=1.Expanding the sum of higher-degree splines in terms of lower-degree ones according to (9), as is well-defined for a complete, collocated sequence on I, we see that the resulting two sums add up to a sum of U-splines of one degree lower:∑iU(x|ti:i+d+1)=∑i(x−titi+d−ti+ti+d−xti+d−ti)U(x|ti:i+d)=∑iU(x|ti:i+d).Together with (10), this establishes that U-splines of a given fixed degree form a partition of 1. The partition of 1 property implies affine invariance,A∑iciU(x|ti:i+k)+a=∑i(Aci+a)U(x|ti:i+k),ci,a∈Rdim,A∈Rdim×dim,for curves based on U-splines. However, since individual U-splines can be negative, the local convex hull property,∑j∈JcjU(x|tj:j+k)=∑j∈Jcjαj(x)for∑j∈Jαj=1,αj⩾0,#J=k, need not hold for x in the support of allU(x|tj:j+k). We can salvage some aspect of the property by allowing−1⩽αj⩽1in place of0⩽αj⩽1.Polynomial reproduction. For B-splines, Marsdenʼs identity implies that all polynomials of degree d or less are linear combinations of B-splines of degree at least d. The proof of Marsdenʼs identity (de Boor, 2001, IX(30)) requires only partition of 1 and valid recurrence relations (9) as implied by property (L). In particular, the proof does not depend on the knot ordering. We can therefore apply the argument of de Boor (2001, IX(30)) directly, starting with the signed characteristic functions (8) as the base case, to prove the following identity.Lemma 3.1Marsdenʼs identity for U-splinesLett0:nbe a d-collocated knot sequence and(t<0,t0:n,t>n)a d-complete knot sequence forI:=[mint0:n..maxt0:n]. For anyτ∈Randx∈I,(x−τ)d=∑iψti:i+d+1(τ)U(x|ti:i+d+1),ψti:j(τ):=(ti+1−τ)⋯(tj−1−τ).Example 3.1Reproduction requires complete knot sequencesTo see that Lemma 3.1 fails when the knot sequence is not complete consider the incomplete knot sequencet0:4:=(0,1,2,0,1)andd=1. Then(11)∑i=02ψti:i+2(τ)U(x|ti:i+2)=(t1−τ)B(x|0,1,2)+(t2−τ)−12B(x|0,1,2)+(t3−τ)−12B(x|0,1,2)=(1−τ−12(2+0−2τ))B(x|0,1,2)=0.On the other hand, for the completed sequencet−2:6:=(−2,−1,0,1,2,0,1,3,4)and its non-decreasing subsequencet˜:=(−2,−1,0,1,3,4), as expected,(12)∑i=−24ψti:i+2(τ)U(x|ti:i+2)=(t−1−τ)B(x|−2,−1,0)+(t0−τ)B(x|−1,0,1)+(t4−τ)B(x|0,1,3)+(t5−τ)B(x|1,3,4)=∑ψt˜i:i+2(τ)B(x|t˜i:i+2)=(⋅−τ),where the first equality follows from Lemma 2.1 and (11), the second by definition, and the last from Marsdenʼs identity for B-splines.Basic interval. To establish properties of linear combinations of B-splines of degree d, requires focus on intervals where a full complement ofk:=d+1B-splines is supported. For non-decreasing knotst:=t0:n+d, all but the first d and the last d intervals are automatically in the support of exactlyk:=d+1B-splines. Therefore, for non-decreasing knots, it makes sense to define the basic interval asIn:=[td..tn]and prove properties on this interval.For establishing analogous properties of linear combinations of U-splines, the definition ofInabove does not work. For example, the knot sequencet:=(0,1,2,0,1)of Example 3.1 andd=1yields, according to interpretation, eitherIn=[t1..t3]=[0..1], or, sincet2=2>t3,In=[0..2]. In either case, the three U-splines defined onInbefore completion are by (3) each a multiple of just one B-splineB(x|0,1,2)(cf. (11)), i.e. do not span the space of piecewise polynomials of degreed=1onIn. To obtain the necessary empty set as basic interval in this setting, we have to explicitly remove all support intervals of U-splines that are added by completion, namelyB(x|−2,−1,0),B(x|−1,0,1),B(x|0,1,3)andB(x|1,3,4). Since all ofInis in the support ofB(x|−1,0,1)andB(x|0,1,3)the basic interval is empty.Definition 3.2Basic intervalForn⩾k:=d+1>0, let(t−k:n+d+k)be a completion of the unsorted, collocated knot sequencet:=t0:n+d. Letsd:n:=sort(td:n). ThenIb:=[sd..sn]\([min(t−k:d)..max(t−k:d)]∪[min(tn:n+d+k)..max(tn:n+d+k)])is the basic interval of t.Lemma 3.2B-splines per basic intervalLetn⩾k:=d+1>0andt:=t0:n+dan unsorted, collocated knot sequence with basic intervalIb. Then every interval[sj−1..sj]⊆Ib,j∈{d+1,…,n}, is in the support of k linearly independent B-splines with knots int.ProofFor each interval[sj−1..sj]⊆Ib, we form a setTjof k knot subsequences by selecting forℓ=1,…,k, the subsequenceti:i+kof t with least index i that contains exactly ℓ knots greater or equal tosj. Forℓ=1, such a subsequence exists since, by assumption,t¯, the first occurrence ofsj, is inIband there exist k elements less thansjand listed beforet¯in t: ifta⩾sjfor some a,0⩽a⩽d, then[sj−1..sj]⊆[min(t−k:d)..max(t−k:d)]contradicting the definition ofIb. Forℓ>1, such a subsequence exists since k elements oft¯:n+dare greater or equal tosj: if not then there exists atn¯∈tn:n+dsuch thattn¯<sj, implyingtn¯⩽sj−1and hence[sj−1..sj]⊆[min(tn:n+d+k)..max(tn:n+d+k)]contradicting the definition ofIb.Subsequences for different ℓ inTjhave distinct, non-constant sorted re-orderings, possibly just differing by the multiplicity of knots. Therefore the B-splines obtained by (3) from the U-splines with knot sequences inTjare linearly independent.  □By the same argument as for B-splines (de Boor, 2001, IX(34)), Marsdenʼs identity implies for the basic interval that for any polynomial p of degree d (or less) and anyτ∈R,(13)p=∑i(λi:i+d+1p)U(⋅|ti:i+d+1)(14)withλi:i+d+1:p↦1d!∑ν=0d(−D)νψi:i+d+1(τ)Dd−νp(τ).We note thatψi:i+d+1and henceλi:i+d+1does not depend on the ordering of the indices and thatλi:i+d+1depends linearly onψi:i+d+1.Knot averages. For any linear polynomial ℓ andd>0, (13) implies that(15)ℓ(x)=∑iℓ(ti:i+d+1⁎)U(x|ti:i+d+1),ti:i+d+1⁎:=ti+1+⋯+ti+ddsinceDkℓ=0fork>1and the linear polynomial(Dd−1ψti:i+d+1)(τ)=(−)d(τd−∑ti)vanishes at the Greville siteτ=ti:i+d+1⁎.Example 3.2Linear representation of linear dataIn Fig. 1,n=4points are marked on a straight line. Correspondingly, we might like the graph of a low-degree interpolating function f to have a linear segment. To linearly trace out this linear segment by the graph of a spline function f of degreed>1, Eq. (15) suggests matching the points by the splineʼs control points(ti:i+d+1⁎,ci). That is, we want to find knotst0:n+d:=(t0,t1,…,tn+d)so that for giventi:i+d+1⁎(16)ti+1+⋯+ti+dd=ti:i+d+1⁎,i=1,…,n.Since there ared+1more knots than Greville abscissae, the system (16) of n equations is underconstrained and, by its structure, solvable.But if we additionally require that the knots be non-decreasing,tj⩽tj+1, then there may not exist a solution. In Fig. 1 the challenge is to fit a quadratic spline to the valuesy⁎:=(0,1,5,6)at its Greville abscissaet⁎=y⁎. That is, the challenge is to find knotstjso that(ti+ti+1)/2=ti⁎:(17)t1+t2=0,t2+t3=2,t3+t4=10,t4+t5=12.If we assume non-decreasing knots then−t1=t2⩾0and sincet3=2−t2we havet4=10−t3⩾8+t2⩾8but alsot5=12−t4⩽4−t2⩽4. Butt4>t5contradicts the assumption that the knot sequence is non-decreasing. Reparameterizationti↦αti+βdoes not change this outcome. So there is no choice of non-decreasing knots that yields the hoped-for ‘linear precision’. Fig. 1 shows a quadratic spline interpolant, made possible by unsorted knots. The interpolant is linear forx∈[0..6]and, as expected, the graph is not linear outside this interval.Differentiation. The (proof of the) differentiation formula(18)D(∑ici:i+d+1U(x|ti:i+d+1))=d∑ici:i+d+1−ci−1:i+dti+d−ti−1U(x|ti:i+d)does not depend on sorted knots, but does require a collocated knot sequence for the limit asti+d→ti−1to be well-defined. As an example of differentiation, the spline defined in Fig. 1 has two U-splines whose knot sequencestj:j+3coverx=3. As expected for the example, the derivative atx=3computes toD(U(⋅|1,−1,3,7)+5U(⋅|−1,3,7,5))(3)=25−17−(−1)U(3|−1,3,7)=1.Sorting and spline space. For a non-decreasing knot sequencet:=t0:n+d, we denote byΠd,tthe space of piecewise polynomials of degree d partitioned by t and such that, at each knot of t, the polynomial pieces are connected with continuous derivatives at least d minus the consecutive multiplicity of that knot. We can retain this definition for unsorted, collocated knots t noting that the multiplicity of any knot and hence the removal of smoothness constraints between polynomial pieces is at most the maximum consecutive multiplicity in the sequence t. By construction, either by Definition 2.2 or Lemma 2.2, the space of U-splines over t is a sub-space ofΠd,t. The next lemma addresses globally sorting t.Lemma 3.3U-splines as a sub-space of a B-spline spaceLets:=sort(t)be a sorted, non-decreasing re-ordering oft:=t0:n+d. A linear combination of U-splines over the knot sequencetcan be represented as a linear combination of B-splines over the knot sequences.ProofSince s contains all knots of t, and since sorting can only increase the multiplicity of any knot in a knot subsequence of lengthd+1, the space of U-splines over t is a sub-space of the less constrained spaceΠd,s. By the Curry–Schoenberg theorem (de Boor, 2001, IX(44)), on the basic interval,Πd,sequals the B-spline space over s.  □While Lemma 3.2 hints that U-splines may span the piecewise polynomial space corresponding to a modifiedsort(t)where the multiplicity of any knot is at most the maximum multiplicity in t, the part of the Curry–Schoenberg theorem that states that the B-splines form a basis cannot hold for U-splines. The following example illustrates that U-splines, as opposed to B-splines, can be locally linearly dependent.Example 3.3Local linear dependenceLetd=0. Thent=(−1,1,0,2)is a collocated knot sequence complete for the interval[0..1]but(19)f(x):=U(x|−1,1)+2U(x|1,0)+U(x|0,2)vanishes on the interval[0..1].The example can be daisy-chained as∑iU(x|i,i+2)+2U(x|i+1,i)to show linear dependence on any subset ofR. (The simpler example∑iU(x|0,1)+U(x|1,0)=0does not cover much ground.)Local linear dependence also implies that U-splines need not satisfy the inequality that establishes good condition of a basis.A spline represented by a linear combination of U-splines can be evaluated by evaluating each U-spline separately. For example, we can use Lemma 2.1 to convert each U-spline to B-spline form, and then sum the terms. However, this is not very efficient. Famously, splines were made practical by providing a stable evaluation algorithm (de Boor, 1971, 1972; Cox, 1972) in terms of the coefficients of their representation in B-form,(20)∑ici:i+d+1B(x|ti:i+d+1).Reversing the construction of higher-degree B-splines from lower ones (de Boor, 2001, Ch. X(26)) or applying Ramshawʼs blossoming approach (Ramshaw, 1989), yields the following recurrence relation for the B-spline coefficients.(21)Fori<kandx∈[ti..tk],cti:k:=tk−xtk−ticti−1:k+x−titk−ticti:k+1.Recurrence (21), the de Boor recurrence, is equally well-defined and has non-zero denominators for an unsorted knot sequence whenever the knot sequence is collocated. The only change in the case of unsorted sequences is in the final step. In the final step, potentially several contributionscti:i+1from intervals[ti..ti+1]covering x are summed with signs according to (8), i.e., negative ifti+1<ti. Recurrence (21) is efficient for evaluation if we apply it only to coefficients whose associated U-spline is non-zero at the point x of evaluation. For sorted knots, at the recursion level associated with polynomials of degree d, exactlyk:=d+1consecutive B-spline support intervals cover x; and the recurrence only forms convex combinationstk−xtk−ti,x−titk−ti∈[0..1]. For U-splines, the lack of knot ordering allows more than k intervals to cover and combinations are only affine: at the final recurrence level of constant U-splines, all coefficients need to be summed whose interval covers the evaluation point; and wherex<ti<tk, the fractionx−titk−tiin (21) is negative.Example 4.1Recurrence for U-spline coefficientsConsider the quadratic splinef(x):=12U(x|3,4,1,5), all of whose coefficients are zero except forc3,4,1,5=12. To evaluate f atx=2by recurrence, we computec3,4,1=2−31−312=6,c4,1,5=5−25−412=36,c3,4=2−34−3c3,4,1=−6,c4,1=1−21−4c3,4,1+2−41−4c4,1,5=2+24=26,c1,5=5−25−1c4,1,5=27.Since x lies outside the interval[3,4], inside the decreasing interval[4,1]and inside the increasing interval[1,5], the value off(2)=27−26=1. Alternatively, by Lemma 2.1,12U(x=2|3,4,1,5)=5−35−112B(2|1,3,4,5)=6/6=1.The next example shows that, as assumed throughout, we need to remove all (coefficients of) U-splines with equal first and last knot at the outset, before evaluation via recursion (21).Example 4.2Removal of zero-valued U-splines is necessaryFirst, we apply the recurrence (21), which only looks at subsequences, to the splinef:=U(⋅|0,2,2,2,0)withc0,2,2,2,0=1and all other coefficients zero. Evaluating f by recurrence atx=1yieldsc0,2,2,2=1−02−0,c2,2,2,0=0−10−2,c0,2,2=121−02−0,c2,2,0=0−10−2,c0,2=14,c2,0=−12.The summation of coefficients associated to intervals coveringx=1yields34. However the correct value according to (6) isf(1)=U(x|0,2,2,2,0)=0.Each level of the recurrence corresponds to knot insertion. Lettˇbe the knot sequence after inserting an extra knot into the sequence t. The relation (de Boor, 2001, XI(21)), between functionalsλi:i+d+1before and after knot insertion, does not depend on ordering and implies for∑jcj:j+d+1U(⋅|tj:j+d+1)=∑jcˇj:j+d+1U(⋅|tˇj:j+d+1)that (de Boor, 2001, XI(23))(22)cˇj:j+d+1=(1−ωˇjd(x))cj−1:j+d+ωˇjd(x)cj:j+d+1,ωˇjd(x):={0,forx⩽tj;x−tjtd−tj,fortj<x<td;1,fortj+d⩽x.But since the weights of knot insertion are not restricted to[0..1]as they are in the sorted case, the standard observation (de Boor, 2001, XI(28)) concerning variation diminution does not hold for U-splines. For example, the splinef(x):=2U(x|1,2,0)+3U(x|2,0,3)=−B(x|0,1,2)+B(x|0,2,3)evaluates to(f(0),f(1),f(2),f(3))=(0,−1/2,1,0), i.e. changes sign, even though the coefficient sequence(2,3)does not. Interestingly, Property xii, called variation diminution in de Boor (2001, XI(29)), holds for the example:f(1)f(2)<0,2U(1|1,2,0)f(1)=1/2>0and3U(2|2,0,3)f(2)=1>0.At the outset, we stipulated that sequences have to be collocated. This was necessary to avoid division by zero in the relations of definition (2), Lemma 2.2 and (21). But divided differences need not be defined by recursion (1). What if we dropped the assumption that the sequence be collocated? The example below shows that this requires at the very least some rethinking of key algorithms such as de Boorʼs recurrence.Example 5.1Convex recurrence requires collocated knotsWe consider the spline f of degreed=4that is a multiple of a U-spline with knots(0,0,2,2,0,2). The knots are not 4-collocated. Letc0,0,2,2,0,2=8and all other coefficients be zero. For the recursion, whenever the denominators in (21) are zero because the first and last knot agree, we choose an affine combination with as of yet undetermined weightski∈Randki′:=1−kiin lieu oftj−xtj−tiandx−titj−ti. Evaluation atx=1yields the following recurrence:c0,0,2,2,0=8k1,c0,2,2,0,2=2−12−08=4,c0,0,2,2=8k11−02−0=4k1,c0,2,2,0=8k1k2′+4k2,c2,2,0,2=4k3′,c0,0,2=4k11−02−0=2k1,c0,2,2=2−12−0(4k1+8k1k2′)+1−02−04k2=2k1+4k1k2′+2k2,c2,2,0=0−10−2(8k1k2′+4k2)+1−20−24k3′=4k1k2′+2k2+2k3′,c2,0,2=4k3′k4′,c0,2=2k12−12−0+1−02−0(2k1+4k1k2′+2k2)+2−12−04k3′k4′=k1+k1+2k1k2′+k2+2k3′k4′,c2,0=0−10−2(4k1k2′+2k2+2k3′)+1−20−24k3′k4′=2k1k2′+k2+k3′+2k3′k4′.For convex weights0⩽ki⩽1, the recurrence yields the valuec0,2−c2,0=2k1−k3′<3. But, by Lemma 2.1,f(1)=8U(x=1|0,0,2,2,0,2)=8U(1|0,0,0,2,2,2)=3.That is, the recurrence cannot yieldf(1)if all averages are convex.A new notion, collocated knots, proved to be both necessary and sufficient to define splines for unsorted knot sequences. We saw, by a concrete example, that, if the knots are not collocated, no two-term recurrence with convex weights for stable evaluation is readily available. This points to collocated knot sequences as a maximal practical generalization of non-decreasing knot sequences.U-splines were constructed both via divided difference tables and via recurrence. Given a collocated knot sequence, the paper proved that any individual U-spline can be represented as a multiple of a B-spline. Establishing properties of the space spanned by linear combinations of U-splines forced a fresh and detailed look at the notions by which Carl de Boor put B-splines on their solid foundation. For example, the deceptively simple definition of the basic interval for linear combinations of B-splines has to explicitly state the basic intervalʼs role of providing a spanning set.From the outset, U-splines lacked positivity and local linear independence. It is therefore remarkable that linear combinations of U-splines retain so many useful properties familiar from B-splines and non-decreasing knot sequences.

@&#CONCLUSIONS@&#
