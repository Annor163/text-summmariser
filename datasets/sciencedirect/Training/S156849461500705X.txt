@&#MAIN-TITLE@&#
Adaptive threshold based on wavelet transform applied to the segmentation of single and combined power quality disturbances

@&#HIGHLIGHTS@&#
An adaptive threshold is determined for segmentation of power quality signals.The power quality signals are based on mathematical models and acquired in field.Wavelet transforms are used to decompose the signals.The intersections between the adaptive threshold and the wavelet transform detail curves determine the start and the end of the segments.The adaptive threshold was accurate in more than 96 percent of the signals.

@&#KEYPHRASES@&#
Electrical power system,Power Quality,Signal segmentation,Discrete Wavelet Transform,

@&#ABSTRACT@&#
Detecting discontinuities in electrical signals from recorded oscillograms makes it possible to segment them. This is the first step in implementing automated methods which will ensure disturbances in electrical power systems are detected, classified and stored. In this context, this paper presents a way of determining an adaptive threshold based on the decomposition of electrical signals through the Discrete Wavelet Transform (DWT) using Daubechies family filter banks, allowing for the segmentation of signals and, as a consequence, the analysis of disturbances related to Power Quality (PQ). Considering this, the proposed approach was initially evaluated for signals originating from mathematical models representing short-term voltage fluctuations, transients (impulsive and oscillatory) and harmonic distortions. In the synthetic signal database, either single or combined occurrences of more than one disturbance were considered. By applying the DWT, the amount of energy and entropy of energy were then calculated for the leaves of the second level of decomposition. Based on these calculations, a unique adaptive threshold could be determined for each analyzed signal. Afterwards, the amount of existing intersections between the threshold and the curve of details obtained for the second level of decomposition was then defined. Thus, the intersections determine the beginning and end of the segments. In order to validate the approach, the performance of the proposed methodology was analyzed considering the signals obtained from oscillograms provided by IEEE 1159.3 Task Force, as well as real oscillograms obtained from a regional distribution utility. After these analyses, it was observed that the proposed approach is efficient and applicable to automatic segmentation of events related to PQ.

@&#INTRODUCTION@&#
Significant technological developments in recent years have dramatically changed Power Systems. In this scenario, monitoring and analysis of supplied Power Quality (PQ) has proved to be of fundamental importance to regulate the electricity sector [1,2]. Therefore, any variations in the supply of electricity can result in poor operation or failure of consumers’ equipment (whether residential, commercial and/or industrial), causing damage, instability and reduced useful life, among other undesirable situations [1–4]. However, in order to have significant improvements in the quality of power supplied to customers, the reasons and causes of disturbances should be constantly analyzed so that preventive and corrective actions can be used efficiently [5]. Thus, automatic tools to support the detection, classification, location and proper storage of records (oscillograms) regarding disturbances are essential [4].In the above context, a number of related studies has focused on monitoring power systems [6–8], mainly concerning Smart Grids. Due to this, allocating Smart Meters is extremely relevant and important for Smart Grids. In contrast, the amount of electrical signals to be recorded and analyzed later can make the monitoring process costly, since these tests are commonly performed without automatising the process. Thus, automatic methods focusing on feature extraction and classification of electrical signals are increasingly necessary for utilities [9–13]. Furthermore, it is desirable that these methods, besides being automated, can handle large volumes of data in order to perform time detection of occurrence and classify various disturbances related to PQ [14–17].It can be observed that various papers in the literature focus on the classification of PQ disturbances. Considering this, the authors of [18] presented an approach for automatic classification of PQ disturbances based on Wavelet Transform (WT) and Support Vector Machines. However, it is worth mentioning that a segmentation process was used before the feature extraction and classification stages. In [19], the main contribution is a fast variant of the discrete S-Transform to detect, segment and extract features of synthetic signals. Therefore, a decision tree classifier was used to identify the PQ disturbances.The paper made reference to in [20] presents segmentation pre-processing based on WT, which is followed by a k-Means feature selection and a Support Vector Machine classifier. An integrated rule based approach of discrete WT with Fast Fourier Transform is proposed by Deokar and Waghmare [21] for detection, feature extraction and classification of PQ disturbances, considering noiseless and noise conditions.A detailed review of detection and classification of PQ disturbances is presented in [22]. According to the authors, the segmentation process can be divided into stationary and non-stationary parts. Due to the disturbances located between transition segments, a triggering method is required to obtain the start and end time instants. Moreover, the authors comment that the segmentation methods can be divided into parametric and non-parametric categories. Parametric category methods include the Kalman filter and Auto-regressive models. On the other hand, non-parametric methods include Short-Term Fourier Transform and WT.Taking this into account, it can be observed that the WT has been used in various areas of knowledge such as image compression, acoustic and mechanical vibration [23–26]. This broad application is due to its ability to denoise and accurately detect discontinuities and sharp changes in the signals under consideration. In view of these characteristics, WT proves to be a valuable tool for feature extraction and identification of power system disturbances [14–16]. Its success is also due to the fact that disturbances can be detected in the time-frequency domain for cases where there are transient phenomena in power systems. This property provides support to the WT for signal analysis containing disturbances that occur in the voltage, current and/or frequency [3,27–29].It is important to mention that there is still no consensus about the best Wavelets family to identify electrical disturbances. However, many authors emphasize that wavelets with the Daubechies filter banks operate properly to detect most disturbances [30–32].An initial idea about an adaptive threshold methodology to detect and segment PQ signals was introduced by de Andrade et al. [33]. This method was analyzed for synthetic signal cases of only 6 single disturbances. However, this method needed to be analyzed in cases where there are flickers and notches, combined disturbances and real signals (oscillograms) in order to verify its robustness. As can be seen from the results, the contribution of this paper is a complete analysis concerning the use of an adaptive threshold to perform PQ disturbance segmentation. This contribution is based on results obtained from analysing 8 synthetic signals with single disturbances (flicker, harmonics, impulsive transient, oscillatory transient, interruption, sag, swell and notch), 6 synthetic signals with combined disturbances (sag with harmonics, sag with flicker, swell with harmonics, swell with flicker, sag with oscillatory transient and swell with oscillatory transient) and 6 real oscillograms (harmonics, oscillatory transient, swell, interruption, impulsive transient and sag with oscillatory transient). Additionally, a general analysis regarding the performance of the adaptive threshold method for the case of all analysed signals is presented in the results.Considering what has been presented, the work in question is intended to define a threshold that is adaptive and allows the segmentation of electrical signals containing disturbances. Thus, it is intended that this threshold is defined based on the decomposition of electrical signals by DWT, using the Daubechies family filter banks for this purpose. For this threshold to be defined in an acceptable manner, first of all the electrical signals generated containing synthetic disturbances were analyzed, i.e., according to the parametric equations presented in [34]. Voltage sags, voltage swells, voltage interruptions, transients, harmonic distortions, flickers and notches are among the generated disturbances [31,35,34].In addition, synthetic signals of combined disturbances were also generated, such as: voltage sag with flicker, voltage swell with flicker, voltage sag with harmonics, voltage swell with harmonics, transient with voltage sag and transient with voltage swell. After applying the proposed method for the segmentation of synthetic signals, it was analysed for the case of real oscillograms, where the efficiency of the procedure could also be observed, as shown later.This paper is organized into five sections, which are as follows: in Section 2 some theoretical aspects of WT are presented. Section 3 describes the estimation method of adaptive threshold in detail. In Section 4, the results for the segmentation of signals are presented and discussed and, finally Section 5 presents the conclusions and final comments about the research conducted so far.WT has been widely used due to its most important property, which is to examine a signal simultaneously in the time–frequency domain. WT emerged in the 1980s, however it only started being used to solve engineering problems in the 1990s [36]. It should be emphasized that WT can be used in continuous or discrete modes. Nevertheless, regarding the detection and classification of disturbances relating to PQ, it is usually applied in its discrete form, i.e., DWT [37,38]. The decomposition of a signal is illustrated in Fig. 1so that the DWT can be better understood.Fig. 1 illustrates the decomposition of a discrete-time signal (Original Signal), where its outputs are detail coefficients (Detail 1) and approximation (Approximation 1). In turn, the approximation coefficients store information regarding the low frequency components, while the detail coefficients store the high frequency information. This decomposition procedure can be repeated until the maximum level of decompositions is reached, i.e., there is only approximation and detail leaves containing just one coefficient. It is also worth mentioning that this procedure is performed by applying a downsampling of 2, i.e., the signal is divided by two until the maximum level of decomposition is achieved. For this reason, it is desirable that the original signal to be decomposed is sampled by a power of 2 (number of points). At the end of the decomposition, either to the maximum degree of decomposition or otherwise, there is a wavelet decomposition tree, with two leaves at each level, one of detail and the other one of approximation, including their respective coefficients. As shown in Fig. 1, decomposition starts from level 1 to level N, where the denoised signal is decomposed into other levels from the approximation coefficient leaf. As shown in Fig. 1, the number of leaf samples of the level to be generated is half of the coefficients of its previous leaf. This process leads to a decrease in resolution in the time domain. However, there is an increase in the resolution of the frequency domain. This resolution increase is favorable for detecting discontinuities in the signals, so that PQ disturbances can be identified.For a consistent determination of the adaptive threshold, a database was generated, composed of 1400 disturbances patterns, which were divided into 800 individual disturbance patterns (voltage sag, voltage swell, voltage interruption, transients, harmonic distortion, flicker and notch) and 600 combined disturbance patterns (voltage sag with flicker, voltage swell with flicker, voltage sag with harmonics, voltage swell with harmonics, transient with voltage swell and transient with voltage sag).Each of the patterns takes into account parameters such as duration, amplitude and location of disturbances, randomly determined, but in accordance with the limits indicated in the related literature [39].Thus, for each of the analyzed patterns, an adaptive threshold was calculated based on the signal energy and entropy of energy for its best adjustment and to enable segmentation in order to identify the segments containing disturbances.Whereas the total energy (ET) is the quadratic sum of each component of each decomposed detail leaf (Ej) the percentage of energy can be obtained by Eq. (1)[40]:(1)ET(%)=Energy=∑j=1N(Ej)2×100.The entropy of a given energy level of decomposition can be obtained according to Eq. (2)[40]:(2)WEE=Entropy=−∑j=1NEjET×logEjET.Eq. (3) was empirically determined (based on the threshold behavior for the 1400 analyzed patterns), according to Eqs. (1) and (2), which determine the adaptive threshold used in the segmentation of signals:(3)Threshold=|ET3/5×WEE|.The energy value and, in consequence, the energy entropy value, are directly related to the intensity of a particular disturbance [32,40]. In order to illustrate this behavior, Fig. 2shows a graph that relates the amplitude versus the value of the adaptive threshold obtained for signals that contain voltage sags. Note that the more severe the sag is, the higher the value of the observed threshold is, which accounts for using an adaptive threshold.Fig. 3also illustrates the behavior that relates the amplitude and the adaptive threshold value for signals containing transients. As in the case of the voltage sag, the behavior of the threshold is adjusted according to the intensity of the oscillatory transient [31,35], i.e., the sharper the transient is, the higher the observed threshold value is.Furthermore, with the intention of showing that the adaptive threshold values have increased and that they follow the severity of the disturbance, Fig. 4illustrates the relationship between the signal amplitudes containing harmonic distortions and the adaptive threshold [31,35].It should be emphasized that the other disturbances considered in this study were also analyzed according to the same procedure shown for voltage sags, transients and harmonics, which has proven that the energy value and the entropy of energy value are directly related to their intensity. Considering the intensity of the events and the definition of thresholds that are pertinent to each situation (i.e., to every pattern under analysis), it was ensured that there were intersections between the adaptive threshold and the detail curves obtained by the wavelet decomposition for all the analyzed signals. Figs. 5and 6, as well as the figures presented in Section 4, show the same standard layout. The first graph (solid red wave) of each of these figures illustrates the voltage signal with disturbances. Their horizontal axis presents the duration of the signal (given in seconds) and the vertical axis presents the amplitude (give per.unit.) of the voltage. The second graph illustrates the detail curve (blue solid line) obtained after the Wavelet decomposition and the adaptive threshold (red dashed line) calculated. Thus, their intersections can be observed, which define the initial and final points of the disturbance. Moreover, their horizontal axis presents the duration of the signal (given in seconds) and the vertical axis presents the threshold value.Fig. 5 shows the initial (0.04s) and final points (0.14s) of the occurrence of a notch, which are highlighted in the second decomposition level graph. Thus, the threshold (dotted line) calculated according to Eq. (3) enables the signal segmentation.Fig. 6 illustrates this characteristic for the case of combined voltage sag and harmonic distortions. The more severe the voltage sag or harmonic distortion is, the higher the threshold value calculated, which accounts for using an adaptive threshold. The initial and final points of the voltage sag occurrence (0.02s and 0.12s respectively) and harmonic distortion (0.065s and 0.15s respectively) are highlighted in the second level of the wavelet decomposition graph.Once a specific threshold is determined (red dashed line) to intersect at these points, the signal can be segmented to separate the segments containing the disturbances of its normal portions.It is important to mention that individual and combined disturbances were generated as found in [31,35] using Mathworks Matlab. It is re- ported that disturbance signals can be found at most 0.2s (10 cycles) with amplitudes between −1 and 1 p.u. in steady-state.The Daubechies families were analyzed during the segmentation task of disturbances, because they are more appropriate when identifying these disturbances, according to [30]. Furthermore, in [30] it is stated that Daubechies with support 4 and 6 are best suited to detect short and rapid transient disturbances. In contrast, Daubechies 8 and 10 are most effective to detect the slow transients. However, the authors explain that the most appropriate Wavelet is determined without prior knowledge of the features of the disturbances that may occur in signals, which is a challenging task.In this regard, a 0.2s (10 cycles) total time window of the synthetic signal was considered to determine the behavior of the adaptive threshold for each one of the analyzed disturbances. Moreover, the characteristic intensity values were analyzed at each situation, in accordance with the stated threshold. That is, for the voltage sags from 0.1 to 0.9 p.u., for voltage swells from 1.1 to 1.8 p.u. and for transients from 1.1 p.u. to 1.8 p.u. In the case of Total Harmonic Distortion, percentages were used between 7% and 20% [39]. All the analyzed signals were sampled at a rate of 128 points per cycle (7680Hz), considering the fundamental frequency of 60Hz. The sampling rate of 128 samples per cycle used in this research come from the authors’ previous work [41].The resulting signals (synthetically generated) were convolved with Gaussian noise, with signal-to-noise ratio (SNR) of 20dB, for previous filtering through Symlets Wavelets. The Symlets were chosen because they had better results in this task than the other families analyzed, namely Daubechies and Coiflets.As previously mentioned, by using Mathworks Matlab, a database of 1400 individual and combined disturbance patterns was generated according to [31,35],respecting the parameters established according to [39]. Then, an algorithm was developed to calculate the adaptive threshold. A simplified flowchart illustrating this can be seen in Fig. 7.The first stage of the flowchart consists of reading files with data concerning generated disturbances. Afterwards, the signal decomposition is made by using WT to extract the coefficients of this decomposition so that the energy value of each coefficient found in the decomposition may be obtained. Following this, the total energy and entropy of the energy are calculated. Finally, the adaptive threshold is computed according to Eq. (3).

@&#CONCLUSIONS@&#
In this study, a method to determine adaptive thresholds to segment signals with disturbances associated to Power Quality was adopted, which was based on calculating energy and entropy of the energy resulting from wavelet decomposition. Therefore, synthetic signals were evaluated, which were created based on parametric models found in related literature [31,35], signals found in the online document of the IEEE P1159 [42] and signals from real oscillograms recorded by a Brazilian utility.It is important to mention that the synthetic signals were convolved with Gaussian noise so that they were similar to real signals. Thus, for the cases where there were synthetic signals and oscillograms, a denoising step was used to mitigate the noise. This denoising was performed by the WT using Symlets family filter banks.Once the detail curves of the decomposition were plotted by WT and the adaptive threshold was calculated, the temporal detection of segments according to their intersection points was defined. Thus, the performance of the adaptive threshold was analyzed for all 1,400 cases of the synthetic database. The adaptive threshold correctly indicated the detection of disturbances in 100% of cases where there were impulsive transients, interruptions, oscillatory transients, voltage sags, voltage swell, voltage sags with oscillatory transients and voltage swell with oscillatory transients.The adaptive threshold correctly indicated the initial points of the disturbances in 100% of the cases of flicker, harmonic distortion, voltage sage with flicker and voltage sage with harmonic distortion. As for detecting the end of these disturbances, the adaptive threshold presented a hit ratio above 90%. In the case of voltage sags with flicker, voltage sags with harmonic distortion and notch, the adaptive threshold had a hit rate from 95% to 99%. In conclusion, the calculation of the adaptive threshold was easy to be implemented and performed extremely well in case of synthetic signals, of signals obtained from [42] and of real oscillograms recorded by a Brazilian utility.