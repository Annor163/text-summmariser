@&#MAIN-TITLE@&#
Pricing of fluctuations in electricity markets

@&#HIGHLIGHTS@&#
Fluctuations in the demand typically result in nontrivial ancillary costs.Marginal cost pricing may not achieve social optimality.We propose a pricing mechanism that properly charges for the effects of demand on ancillary cost.This mechanism is approximately socially optimal, when the number of consumers is large.

@&#KEYPHRASES@&#
OR in energy,Electricity market,Game theory,Dynamic pricing,Social welfare,

@&#ABSTRACT@&#
In an electric power system, demand fluctuations may result in significant ancillary cost to suppliers. Furthermore, in the near future, deep penetration of volatile renewable electricity generation is expected to exacerbate the variability of demand on conventional thermal generating units. We address this issue by explicitly modeling the ancillary cost associated with demand variability. We argue that a time-varying price equal to the suppliers’ instantaneous marginal cost may not achieve social optimality, and that consumer demand fluctuations should be properly priced. We propose a dynamic pricing mechanism that explicitly encourages consumers to adapt their consumption so as to offset the variability of demand on conventional units. Through a dynamic game-theoretic formulation, we show that (under suitable convexity assumptions) the proposed pricing mechanism achieves social optimality asymptotically, as the number of consumers increases to infinity. Numerical results demonstrate that compared with marginal cost pricing, the proposed mechanism creates a stronger incentive for consumers to shift their peak load, and therefore has the potential to reduce the need for long-term investment in peaking plants.

@&#INTRODUCTION@&#
Our motivation stems from the fact that fluctuations in the demand on conventional thermal generating units typically result in significantly increased, and nontrivial, ancillary costs. Today, such demand fluctuations are mainly due to time-dependent consumer preferences. In addition, in the future, a certain percentage of electricity production is required by law in many states in the U.S. to come from renewable sources (Barbose, Wiser, Phadke, & Goldman, March 2008). The high volatility of renewable energy sources may aggravate the variability of the demand for conventional thermal generators and result in significant ancillary cost. More concretely, either a demand surge or a decrease in renewable generation may result in (i) higher energy costs due to the deployment of peaking plants with higher ramping rates but higher marginal cost, such as oil/gas combustion turbines, and (ii) the cost associated with resource redispatch22A certain level of reserve must always be maintained in an electric power system. Local reserve shortages are usually due to the quick increase of system load rather than a capacity deficiency. If the increase of system load makes the system short in reserves, the system redispatches resources to increase the amount of reserves available. Redispatch generally increases the generation cost and results in higher prices. The redispatch cost can be very high (cf. Section 2.3.2 of ISO New England Inc., 2010).that the system will incur to meet reserve constraints if the demand increase (or renewable generation decrease) causes a reserve shortage.There is general agreement that charging real-time prices (that reflect current operating conditions) to electricity consumers has the potential of reducing supplier ancillary cost, improving system efficiency, and lowering volatility in wholesale prices (Chao, 2010; Spees & Lave, 2008; US Department of Energy, 2006). Therefore, dynamic pricing, especially real-time marginal cost pricing, is often identified as a priority for the implementation of wholesale electricity markets with responsive demand (Hogan, 2010), which in turn raises many new questions. For example, should prices for a given time interval be calculated ex ante or ex post? Does real-time pricing introduce the potential for new types of market instabilities? How is supplier competition affected? In this paper, we abstract away from almost all of these questions and focus on the specific issue of whether prices should also explicitly encourage consumers to adapt their demand so as to reduce supplier ancillary cost.To illustrate the issue that we focus on, we note that a basic model of electricity markets assumes that the cost of satisfying a given level Atof aggregate demand during period t is of the form C(At). It then follows that in a well-functioning wholesale market, the observed price should more or less reflect the marginal cost C′(At). In particular, prices should be more or less determined by the aggregate demand level. Empirical data do not quite support this view. Fig. 1plots the real-time system load and the hourly prices on February 11, 2011 and on February 16, 2011, as reported by the New England ISO (ISO New England Inc., 2011). We observe that prices do not seem to be determined solely by Atbut that the changes in demand, At− At−1, also play a major role. In particular, the largest prices seem to occur after a demand surge, and not necessarily at the hour when the load is highest. We take this as evidence that the total cost over T + 1 periods is not of the form∑t=0TC(At),but rather of the form(1)∑t=0T(C(At)+H(At−1,At)),for a suitable function H.We take the form of Eq. (1) as our starting point and raise the question of the appropriate prices. We note that wholesale electricity prices set by an OPF (optimal power flow)-based approach is simply the highest marginal cost of active generating units (Sioshansi, Oren, & O’Neill, 2010; Wu, Rothleder, Alaywan, & Papalexopoulos, 2004): at time t, At−1 has already been realized, and taking its value for granted, a consumer is charged a unit price equal to(2)C′(At)+∂∂AtH(At−1,At),which is the supplier’s marginal cost at stage t. We refer to this simple approach as “marginal cost pricing” (MCP), which is essentially the one used in the price calculation processes implemented by the California ISO (2009), New England ISO (Litvinov, 2011), and NYISO (cf. Section 17.1 of NYISO, 2012). However, a simple argument based on standard mathematical programming optimality conditions shows that for system optimality to obtain, the demand At−1 should also incur (after Atis realized) a unit price of (Sioshansi et al., 2010):(3)∂∂At−1H(At−1,At),This is in essence the pricing mechanism that we analyze in this paper.33In current two-settlement systems, the real-time prices are charged only on the difference of the actual demand and the estimated demand at the day-ahead market. However, the two-settlement system provides the same real-time incentives to price-taking consumers, as if they were purchasing all of their electricity at the real-time prices (cf. Chapter 3–2 of Stoft, 2002).The actual model that we consider will be richer from the one discussed above in a number of respects. It includes an exogenous source of uncertainty (e.g., representing weather conditions) that has an impact on consumer utility and supplier cost, and therefore can incorporate the effects of volatile renewable electricity production44The value of demand response on mitigating the variability of renewable generation has received some recent attention (Rahimi & Ipakchi, 2010; Stadler, 2008).. It allows for consumers with internal state variables (e.g., a consumer’s demand may be affected by how much electricity she has already used). It also allows for multiple consumer types (i.e., with different utility functions and different internal state dynamics). Consumers are generally modeled as price-takers, as would be the case in a model involving an infinity (a continuum) of consumers. However, we also consider the case of finite consumer populations and explore certain equilibrium concepts that are well-suited to the case of finite but large consumer populations. On the other hand, we ignore most of the distinctions between ex post and ex ante prices. Instead, we assume that at each time step, the electricity market clears. The details of how this could happen are important, but are generic to all electricity markets, hence not specific to our models, and somewhat orthogonal to the subject of this paper. (See however Appendix A for some discussion of implementation issues.)The ancillary cost function H(At−1, At) is a central element of our model. How can we be sure that this is the right form? In general, redispatch and reserve dynamics are complicated and one should not expect such a function to capture all of the complexity of the true system costs; perhaps, a more complex functional form such as H(At − 2, At−1, At) would be more appropriate. We believe that the form we have chosen is a good enough approximation, at least under certain conditions. To argue this point, we present in Appendix B an example that involves a more detailed system model (in which the true cost is a complicated function of the entire history of demands) and show that a function of the form H(At−1, At) can capture most of the cost of ancillary services.Before continuing, we provide here a roadmap of the paper together with a summary of our main contributions.(a)We provide a stylized (yet quite rich) model of an electricity market, which incorporates the cost of ancillary services (cf. Section 2).We provide some justification of the form of the cost function in our model, as a reasonable approximation of more detailed physical models (cf. Appendix B).We propose and analyze a pricing mechanism that properly charges for the effects of consumer actions on ancillary services (cf. Section 3).For a continuum model involving non-atomic price-taking consumers, we consider Dynamic Oblivious Equilibria (DOE), in which every consumer maximizes her expected payoff under the sequence of prices induced by a DOE strategy profile (Section 4). We show that (under standard convexity assumptions), a mechanism that properly charges for the effects of consumer actions on ancillary services maximizes social welfare (cf. Theorem 2 in Section 6).We carry out a game-theoretic analysis of the case of a large but finite number of consumers. We show that a large population of consumers who act according to a DOE (derived from an associated continuum game) results in asymptotically optimal (as the number of consumers goes to infinity) social welfare (cf. Theorem 2in Section 6), and asymptotically maximizes every consumer’s expected payoff (this is an “asymptotic Markov equilibrium” property; cf. Theorem 1 in Section 5).We illustrate the potential benefits of our mechanism through a simple numerical example. In particular, we show that compared with marginal cost pricing, the proposed mechanism reduces the peak load, and therefore has the potential to reduce the need for long-term investments in peaking plants (cf. Appendix E).There are two streams of literature, on electricity pricing and on game theory, that are relevant to our work, and which we now proceed to discuss, while also highlighting the differences from the present work.Regarding electricity markets, the impact of supply friction on economic efficiency and price volatility has received some recent attention. Mansur (2008) shows that under ramping constraints, the prices faced by consumers may not necessarily equal the true supplier marginal cost. In a continuous-time competitive market model, Cho and Meyn (2010a) show that the limited capability of generating units to meet real-time demand, due to relatively slow ramping rates, does not harm social welfare, but may result in extreme price fluctuations. In a similar spirit, Kizilkale and Mannor (2010) construct a dynamic game-theoretic model to study the tradeoff between economic efficiency and price volatility. Cho and Meyn (2010b) construct a dynamic newsboy model to study the reserve management problem in electricity markets with exogenous demand. The supplier cost in their model depends not only on the overall demand, but also on the generation resources used to satisfy the demand. For example, a quickly increasing demand may require more responsive and more expensive resources (e.g., peaking generation plants). Wang, Negrete-Pincetic, Kowli, Shafieepoorfard, Meyn, and Shanbhag (2012) study a somewhat related dynamic competitive equilibrium that includes ancillary services with ramping constraints. Closer to the present paper, Sioshansi et al. (2010) suggest that wholesale electricity prices should explicitly account for intertemporal ramping constraints.To study the impact of pricing mechanisms on consumer behavior and load fluctuations, we construct a dynamic game-theoretic model that differs from existing dynamic models for electricity markets and incorporates both the consumers’ responses to real-time price fluctuations and the suppliers’ ancillary cost incurred by load swings55Some major differences between our model and existing ones are discussed at the end of Section 2.. Our main results validate the suggestion made in Sioshansi et al. (2010), from a demand-response (DR) perspective: wholesale electricity prices should properly charge for the effects of consumer actions on ancillary services, because proper price signals will encourage consumers to adapt their consumption so as to offset the variability of demand on conventional units.On the game-theoretic side, the standard solution concept for stochastic dynamic games is the Markov perfect equilibrium (MPE) (Fudenberg & Tirole, 1991; Maskin & Tirole, 1988), involving strategies where an agent’s action depends on the current state of all agents. As the number of agents grows large, the computation of an MPE is often intractable (Doraszelski & Pakes, 2007). For this reason, alternative equilibrium concepts, for related games featuring a non-atomic continuum of agents (e.g., “oblivious equilibrium” or “stationary equilibrium” for dynamic games without aggregate shocks), have received much recent attention (Adlakha, Johari, Weintraub, & Goldsmith, 2011; Weintraub, Benkard, & Van Roy, 2008).There is a large literature on a variety of approximation properties of non-atomic equilibria (Al-Najjar, 2004; 2008; Mas-Colell & Vives, 1993). Recently, Adlakha et al. (2011) have derived sufficient conditions for a stationary equilibrium strategy to have the Asymptotic Markov Equilibrium (AME) property, i.e., for a stationary equilibrium strategy to asymptotically maximize every agent’s expected payoff (given that all the other agents use the same stationary equilibrium strategy), as the number of agents grows large. Their model includes random shocks that are assumed to be idiosyncratic to each agent. However, in the problem that we are interested in, it is important to incorporate aggregate shocks (such as weather conditions) that have a global impact on all agents. In this spirit, Weintraub, Benkard, and Van Roy (2010) consider a market model with aggregate profit shocks, and study an equilibrium concept at which every firm’s strategy depends on the firm’s current state and on the recent history of the aggregate shock. Finally, for dynamic oligopoly models with a few dominant firms and many fringe firms, Ifrachy and Weintraub (2012) propose and analyze a new equilibrium concept, moment-based Markov equilibrium (MME), in which each firm’s action depends on the aggregate shock, the exact states of the dominant firms, and a few aggregate statistics on the distribution of fringe firm states.For a general dynamic game model with aggregate shocks, Bodoh-Creed (2012) shows that a non-atomic counterpart of an MPE, which we refer to as a Dynamic Oblivious Equilibrium (DOE) in this paper, asymptotically approximates an MPE in the sense that as the number of agents increases to infinity, the actions taken in an MPE can be well approximated by those taken by a DOE strategy of the non-atomic limit game. However, without further restrictive assumptions on the agents’ state transition kernel, the approximation property of the actions taken by a DOE strategy does not necessarily imply the AME property of the DOE, and we are not aware of any AME results for models that include aggregate shocks. Thus, our work is different in this respect: for a dynamic non-atomic model with aggregate shocks, which is a simplified variation of the general model considered in Bodoh-Creed (2012), we prove the AME property of a DOE.The efficiency of non-atomic equilibria for static games has been addressed in recent research (Bodoh-Creed, 2011; Milchtaich, 2004; Roughgarden & Tardos, 2004). For a dynamic industry model with a continuum of identical producers and exogenous aggregate shocks, Lucas and Prescott (1971) show (under convexity assumptions) that the expected social welfare is maximized at a unique competitive equilibrium. In a similar spirit, in this paper we show (under convexity assumptions) that the proposed pricing mechanism maximizes the expected social welfare in a model involving a continuum of (possibly heterogeneous) consumers. We also consider the case of a large but finite number of consumers, and show that the expected social welfare is approximately maximized if all consumers act according to a non-atomic equilibrium (DOE). For large dynamic games, the asymptotic social optimality of non-atomic equilibria (DOEs) established in this paper seems to be new.We consider a (T + 1)-stage dynamic game with the following elements:1.The game is played in discrete time. We index the time periods with t = 0, 1, …, T. Each stage may represent a five minute interval in real-time balancing markets where prices and dispatch solutions are typically provided at five minute intervals.There are nconsumers, indexed by 1, …, n.At each stage t, letst∈Sbe an exogenous state, which evolves as a Markov chain and whose transitions are not affected by consumer actions. The setSis assumed to be finite. In electricity markets, the exogenous state may represent time and/or weather conditions, which impact consumer utility and supplier cost. It may also represent the level of renewable generation.For notational conciseness, for t ≥ 1, lets¯t=(st−1,st),and lets¯0=s0. We useS¯tto denote the set of all possibles¯t. We refer tos¯tas the global state at stage t.Given an initial global state s0, the initial states (types) of the consumers,{xi,0}i=1n,are independently drawn according to a probability measureηs0over a finite setX0. We use X to denote the cardinality ofX0.The state of consumeri at stage t is denoted by xi, t. At t = 0, consumer i’s initial state, xi, 0, indicates her type. For t = 1, …, T, we have xi, t= (xi, 0, zi, t), wherezi,t∈ZandZ=[0,Z]is a compact subset ofR. The variables{zi,t}i=1nallow us to model intertemporal substitution effects in consumer i’s demand.We useXtto denote a consumer’s state space at stage t. In particular, at stage t ≥ 1,Xt=X0×Z.At stage t, consumer i takes an actionai, tand receives a non-negative utility66At t = 0, U0 is a mapping fromX0×S×Ato [0, ∞), while for t ≥ 1, Utis a mapping fromX0×Z×S×Ato [0, ∞).Ut(xi, t, st, ai, t).Each consumer’s action space isA=[0,B],where B is a positive real number. (In the electric power context, B could reflect a local transmission capacity constraint.)We useAt=∑i=1nai,tto denote the aggregate demand at stage t.Given consumer i’s current state, xi, t, and the next exogenous state st + 1, the next state of consumer i is determined by her action taken at stage t, i.e., xi, t + 1 = (xi, 0, zi, t + 1), where zi, t + 1 = r(xi, t, ai, t, st + 1), for a given function r.Let Gt= At+ Rtbe the capacity available at stage t, where Rtis the system reserve at stage t. For simplicity, we assume that the system reserve at stage t depends only on the current aggregate demand, At, and the current exogenous state st. That is, we have Rt= g(At, st) for a given function of g that reflects the reserve policy of the system operator.At stage t, letC¯(At,Rt,st)be the total conventional generation cost, that is, the sum of the supplier’s cost to meet the aggregate demand Atthrough its primary energy resources, e.g., coal-based and nuclear power plants, and the cost to maintain a system reserve Rt. Since Rtusually depends only on Atand st, we can writeC¯(At,Rt,st)as a function of Atand st, i.e., there exists a primary cost functionC:R×S→[0,∞)such thatC(At,st)=C¯(At,Rt,st). We assume that for anys∈S,C( ·, s) is nondecreasing.At stage t ≥ 1, letH¯(At−1,At,Rt−1,Rt,st)denote the ancillary cost incurred by load swings77In general, the supplier ancillary cost may depend on the entire history of system load and global states. However, ancillary cost functions with the simple formH¯(At−1,At,Rt−1,Rt,st)can serve as a good approximation of the supplier’s true ancillary cost (cf. Appendix B).. Since Rtusually depends only on Atand st, we can writeH¯(At−1,At,Rt−1,Rt,st)as a function of At−1, At, st−1, and st, i.e., there exists an ancillary cost functionH:R2×S2→[0,∞)such thatH¯=H(At−1,At,s¯t). The ancillary cost at stage 0 is assumed to be a function of s0 and A0.At stage 0, the total supplier cost is of the form(4)C(A0,s0)+H0(A0,s0),and for t = 1, …, T, the total supplier cost at stage t is given by(5)C(At,st)+H(At−1,At,s¯t).In contrast to existing dynamic models for electricity markets with an exogenous demand process (Cho & Meyn, 2010a; 2010b), our dynamic game-theoretic model incorporates the consumer reactions to price fluctuations, and allows us to study the impact of pricing mechanisms on consumer behavior and economic efficiency. Through a dynamic game-theoretic formulation, Kizilkale and Mannor (2010) study the tradeoff between economic efficiency and price volatility. Our model is different from the one studied in Kizilkale and Mannor (2010) in the following respects:1.Our model allows the generation cost to depend on an exogenous state, and therefore can incorporate supply-side volatility due to uncertainty in renewable electricity generation. As an example, consider a case where the exogenous state, st, represents the electricity generation from renewable resources at stage t. Then the demand for conventional generation is At− st. For example, the system reserve can be set as the maximum of the minimum system reserve requirement88Conventionally, the minimum system reserve is usually defined by the biggest online generator (Wang, Redondo, & Galiana, 2003). Since renewable generation causes important fluctuations, reserves should also be allowed to depend on the level of renewable generation (that is incorporated by the global state st).R¯(st)and a certain fraction of the current system load, say, δAtfor some constant δ > 0. The cost function,C¯(At,Rt,st),then depends only on the output of conventional generating units, At− st, and the system reserve,max{R¯(st),δAt}. Furthermore, the ancillary cost incurred at stage t depends on the system reserve and the outputs of conventional generating units at stages t − 1 and t, and is therefore a function of At−1, At, st−1, and st.More important, instead of penalizing each consumer’s attempt to change her own action across time, the ancillary cost function in our model penalizes the change in the aggregate demand by all consumers. The change in a single consumer’s action may harm or benefit the social welfare, while aggregate demand volatility is usually undesirable.The main feature of our model is the ancillary cost function H, which makes the supplier cost non-separable over time. In an electric power system, the ancillary cost function models the costs associated with the variability of conventional thermal generator output, such as the energy cost of peaking plants. Note that the ancillary cost is not necessarily zero when At≤ At−1, because thermal generating units have ramping-down constraints, and because a decrease in renewable electricity production may lead to an increase of the system reserve, even if At≤ At−1. The presence of the ancillary cost function makes conventional marginal cost pricing inefficient (cf. Example 1 in Section 3).To keep the model simple, we do not incorporate any idiosyncratic randomness in the consumer state evolution. Thus, besides the randomness of consumer types (initial states), the only source of stochasticity in the model is the exogenous state st.To effectively highlight the impact of pricing mechanisms on consumer behavior, as well as on economic efficiency and demand volatility, we have made the following simplifications and assumptions for the power grid:(a)As in Cho and Meyn (2010a), we assume that the physical production capacity is large enough so that the possible changes of the generation capacity are not constrained.Transmission capacity is large enough to avoid any congestion. We also assume that the cost of supplying electricity to consumers at different locations is the same. Therefore, a common price for all consumers is appropriate.We use a simplified form of ancillary cost functions,H(At−1,At,s¯t),to approximate the supplier ancillary cost. In Appendix B, we discuss this approximation and present a numerical example to justify it.Actual power systems and markets are quite complex and our model does not necessarily capture all relevant aspects in a realistic manner. For example, the assumption of two types of generators may not be satisfied in real power systems. However, we make such assumptions for specificity, and in order to avoid an exceedingly complex model, while still being able to develop our main argument, which is somewhat orthogonal to such issues.The marginal cost pricing mechanism discussed in Section 1 charges a time-varying unit price on each consumer’s demand. As demonstrated in the following example, a time-varying price that equals the supplier’s instantaneous marginal cost may not achieve social optimality in a setting that includes ancillary costs. For this reason, we propose a new pricing mechanism that takes into account the ancillary cost associated with a consumer’s demand at the previous stage.Example 1This example shows that at an efficient competitive equilibrium (between one supplier and one consumer), the per-unit price charged to the consumer does not equal the supplier’s instantaneous marginal cost. Consider a two-stage deterministic model with one consumer and one supplier. At stage t, the consumer’s utility function is Ut: [0, ∞) → [0, ∞). Let atdenote the demand at stage t, and let a = (a0, a1). Let gtdenote the actual generation at stage t, and let g = (g0, g1). Two unit prices, p0 and p1, are charged on the consumption at stage 0 and 1, respectively. Let p = (p0, p1). The consumer’s payoff-maximization problem is(6)MaximizeaU0(a0)−p0a0+U1(a1)−p1a1.Let H0 be identically zero, and let the ancillary cost function at stage 1 depend only on the difference between the supply at the two stages. That is, the ancillary cost at stage 1 is of the form H(g1 − g0). The supplier’s profit-maximization problem is(7)Maximizegp0g0+p1g1−C(g0)−C(g1)−H(g1−g0).The social planner’s problem is(8)Maximize(a,g)U0(a0)+U1(a1)−C(g0)−C(g1)−H(g1−g0)subjecttoa=g.Now consider a competitive equilibrium, (a, g, p), at which the vector a solves the consumer’s optimization problem (6), the vector g solves the supplier’s optimization problem (7), and the market clears, i.e., a = g. Suppose that the utility functions are concave and continuously differentiable, and that the cost functions C and H are convex and continuously differentiable. We further assume that H′(0) = 0, and that for t = 0, 1,Ut′(0)>C′(0),Ut′(B)<C′(B). Then, there exists a competitive equilibrium, (a, g, p), which satisfies the following conditions:(9){U0′(a0)=p0,U1′(a1)=p1,{C′(a0)−H′(a1−a0)=p0,C′(a1)+H′(a1−a0)=p1.We conclude that the competitive equilibrium solves the social welfare maximization problem in (8), because it satisfies the following (sufficient) optimality conditions:(10)U0′(a0)=C′(a0)−H′(a1−a0),U1′(a1)=C′(a1)+H′(a1−a0),a0=g0,a1=g1.However, we observe that the socially optimal price p0 does not equals the supplier’s instantaneous marginal cost at stage 0, C′(a0). Hence, by setting the price equal to C′(a0), as would be done in a real-time balancing market, we may not achieve social optimality. More generally, marginal cost pricing need not be socially optimal because it does not take into account the externality conferred by the action a0 on the ancillary cost at stage 1, H(a1 − a0). At a socially optimal competitive equilibrium, the consumer should pay(C′(a0)−H′(a1−a0))a0+(C′(a1)+H′(a1−a0))a1,i.e., the price on a0 should be the sum of the supplier marginal cost at stage 0, C′(a0), and the marginal ancillary cost associated with a0,−H′(a1 − a0), which is determined at the next stage, after a1 is realized.Before describing the precise pricing mechanism we propose, we introduce a differentiability assumption on the cost functions.Assumption 1For anys∈S,C( ·, s) and H0( ·, s) are continuously differentiable on [0, ∞). For any(A′,s¯)∈A×S2,H(A,A′,s¯)andH(A′,A,s¯)are continuously differentiable in A on [0, ∞).99At the boundary of the domain, 0, we require continuity of the right-derivatives of C, H0, and H.Inspired by Example 1, we introduce prices(11)pt=C′(At,st),t=0,…,T,and(12)qt=∂H(At−1,At,s¯t)∂At−1,wt=∂H(At−1,At,s¯t)∂At,t=1,…,T.At stage 0, we let q0 = 0 andw0=H0′(A0,s0). Under the proposed pricing mechanism, consumer i’s payoff at stage t is given by(13)Ut(xi,t,st,ai,t)−(pt+wt)ai,t−qtai,t−1.Note that pt+ wtis the supplier marginal cost at stage t (including the marginal ancillary cost). The proposed pricing mechanism charges consumer i an additional price qton her previous demand, equal to the marginal ancillary cost with respect to ai, t − 1.We now define some of the notation that we will be using. For t = 1, …, T, let yi, t= (ai, t − 1, xi, t) be the augmented state of consumer i at stage t. At t = 0, let yi, 0 = xi, 0. For stage t, letYtbe the set of all possible augmented states. In particular, we haveY0=X0,andYt=A×Xt,for t = 1, …, T.Let Δn(D) be the set of empirical probability distributions over a given set D that can be generated by n samples from D. (Note that empirical distributions are always discrete, even if D is a continuous set.) Letft∈Δn(Yt)be the empirical distribution of the augmented state of all consumers at stage t, and letf−i,t∈Δn−1(Yt)be the empirical distribution of the augmented state of all consumers (excluding consumer i) at stage t. We refer to ftas the population state at stage t. Letut∈Δn(A)denote the empirical distribution of all consumers’ actions at stage t, and letu−i,t∈Δn−1(A)be the empirical distribution of all consumers’ (excluding consumer i) actions at stage t.For a given n, it can be seen from (11) and (12) that the prices, and thus the stage payoff in (13), are determined by the current global state,s¯t,consumer i’s current augmented state, yi, t, and current action, ai, t, as well as the empirical distributions, f−i, tand u−i, tof other consumers’ current augmented state and action. Hence, for a certain function π( · ), we can write the stage payoff in (13) as(14)π(yi,t,s¯t,ai,t,f−i,t,u−i,t)=Ut(xi,t,st,ai,t)−(pt+wt)ai,t−qtai,t−1.To study the aggregate behavior of a large number of consumers, we consider a non-atomic game involving a continuum of infinitesimally small consumers, indexed by i ∈ [0, 1]. We assume that (under state s0) a fractionηs0of the consumers has initial state x. In a non-atomic model, any single consumer’s action has no influence on the aggregate demand and the prices. We consider a class of strategies (dynamic oblivious strategies) in which a consumer’s action depends only on the history of past exogenous states, ht= (s0, …, st), and her own current state1010Note that a dynamic oblivious strategy depends only on the consumer’s current state, instead of her augmented state. As we will see in Section 4.2, in a continuum model, since any single consumer i has no influence on the prices, a best response or equilibrium strategy need not take into account the action ai, t − 1 taken at the previous stage., i.e., of the formai,t=ν¯t(xi,t,ht).Suppose that consumer i uses a dynamic oblivious strategyν¯=(ν¯0,…,ν¯T). Since there is no idiosyncratic randomness, given a history ht, the state xi, tof consumer i at stage t depends only on her initial state xi, 0. That is, there is a mappinglν¯,ht:X0→Xt,such thatxi,t=lν¯,ht(xi,0). Therefore, we can specify the action taken by a dynamic oblivious strategy in the alternative form(15)ai,t=νt(xi,0,ht)Δ=ν¯t(lν¯,ht(xi,0),ht).We refer to ν = (ν0, …, νT) as a dynamic oblivious strategy, and letVbe the set of all such strategies.An alternative formulation involving strategies that depend on consumer expectations on future prices would lead to a Rational Expectations Equilibrium (REE), an equilibrium concept based on the rational expectations approach pioneered by Muth (1961). In our continuum model, since the only source of stochasticity is from the exogenous state st, future prices under any given strategy profile, are completely determined by the history ht. Therefore, it is reasonable to expect that strategies of the form (15) will lead to an equilibrium concept that is identical in outcomes with a REE (cf. the discussion in Section 4.2).Before formally defining a Dynamic Oblivious Equilibrium (DOE), we first provide some of the intuition behind the definition. In a continuum model, if all consumers use a common dynamic oblivious strategy ν, the aggregate demand and the prices at stage t depend only on the history of exogenous states, ht= (s0, …, st). A dynamic oblivious strategy ν is a DOE (cf. the formal definition in Section 4.2) if it maximizes every consumer’s expected total payoff, under the sequence of prices that ν induces. In Section 4.3, we associate a continuum model with a sequence of n-consumer models (n = 1, 2,…), and specify the relation between the continuum model and the corresponding n-consumer model.Let ht= (s0, …, st) denote a history up to stage t, and letHt=St+1denote the set of all possible such histories. Recall that in a continuum model, given an initial global state s0, the distribution of consumers’ initial states isηs0. Therefore, under a history ht, if all consumers use the same dynamic oblivious strategy ν, then the average demand is(16)A˜t∣ν,ht=∑x∈X0ηs0(x)·νt(x,ht).We now introduce the cost functions in a continuum model. LetC˜:R×S→[0,∞)be a primary cost function. LetH˜:R2×S2→[0,∞)be an ancillary cost function at stage t ≥ 1, and letH˜0:R×S→[0,∞)be an ancillary cost function at the initial stage 0.Given the cost functions in a continuum model, we define the sequence of prices induced by a dynamic oblivious strategy as follows (cf. Eqs. (11)–(12)):(17)p˜t|ν,ht=C˜′(A˜t|ν,ht,st),q˜0|ν,h0=0,w˜0|ν,h0=H˜0′(A˜0|ν,h0,s0),and for t ≥ 1,(18)q˜t|ν,ht=∂H˜(A˜t−1|ν,ht−1,A˜t|ν,ht,s¯t)∂A˜t−1|ν,ht−1,w˜t|ν,ht=∂H˜(A˜t−1|ν,ht−1,A˜t|ν,ht,s¯t)∂A˜t|ν,ht.In this subsection we define the concept of a DOE. Suppose that all consumers other than i use a dynamic oblivious strategy ν. In a continuum model, consumer i’s action does not affect the prices. If all consumers except i use a dynamic oblivious strategy ν, consumer i’s oblivious stage value (the stage payoff in a continuum model) under a history htand an action ai, t, is(19)π˜i,t(yi,t,ht,ai,t∣ν)=Ut(xi,t,st,ai,t)−(p˜t|ν,ht+w˜t|ν,ht)ai,t−q˜t|ν,htai,t−1,where the prices,p˜t|ν,ht,w˜t|ν,ht,andq˜t|ν,ht,are defined in (17) and (18). Since a single consumer’s action cannot influenceq˜t,the last term in (19) is not affected by the action ai, t, and the decision ai, tat stage t need not take ai, t − 1 into account, but should takeq˜t+1into account.Consumer i’s oblivious stage value under a dynamic oblivious strategyν^,is1111Recall that the initial state (the type) of consumer i, xi, 0, is included in its state xi, t, as well in its augmented state yi, t, for any t.(20)π˜i,t(yi,t,ht∣ν^,ν)Δ=π˜i,t(yi,t,ht,ν^t(xi,0,ht)∣ν).In particular, we useπ˜i,t(yi,t,ht∣ν,ν)to denote the oblivious stage value of consumer i at stage t, if all consumers use the strategy ν. Given an initial global state s0 and an initial state of consumer i, xi, 0, her oblivious value function (total future expected payoff function in a continuum model) is(21)V˜i,0(xi,0,s0∣ν^,ν)=E{∑τ=0Tπ˜i,τ(yi,τ,hτ∣ν^,ν)},where the expectation is over the future global states,{sτ}τ=1T.Definition 1A strategy ν is a Dynamic Oblivious Equilibrium (DOE) ifsupν^∈VV˜i,0(xi,0,s0∣ν^,ν)=V˜i,0(xi,0,s0∣ν,ν),∀xi,0∈X0,∀s0∈S.A DOE is guaranteed to exist, under suitable assumptions, and this is known to be the case for our model (under our assumptions), and even for a more general model that includes idiosyncratic randomness (Bergin & Bernhardt, 1992). The DOE, as defined above, is essentially the same concept as the “dynamic competitive equilibrium” studied in Bodoh-Creed (2012), which is defined as the non-atomic equivalent of an MPE, in a continuum model. At a DOE, the beliefs of all consumers on future prices are consistent with the equilibrium outcomes. Therefore, a DOE is identical in outcomes with a Rational Expectations Equilibrium (REE).Note that to compute a DOE one has to keep track of the entire history of shocks, and that consumers may not have the rationality or computational power to calculate a DOE. However, in future electricity markets, consumers may receive price estimates from utilities and/or the independent system operator (ISO) through advanced metering infrastructures. (In Appendix A, we provide some discussion of a possible implementation of the proposed real-time pricing mechanism.) If utilities and/or the ISO could make accurate estimates (contingent on future history of the exogenous state) of the prices1212We note that several recent works show that a reasonably accurate approximation could be achieved even if the agents’ strategy depends only on the recent history (as opposed to the full history) of the aggregate shock (Bodoh-Creed, 2012; Weintraub et al., 2010). These results suggest that utilities may be able to obtain accurate price estimates by taking into account only the recent history of the aggregate shock., a REE (equivalently, a DOE) will be a plausible outcome of such a market. Furthermore, we will show (Theorem 2) that under the proposed pricing mechanism, and under certain convexity assumptions, a DOE is socially optimal for the continuum model.We would like to take the cost functions in a continuum model to approximate the cost functions in an n-consumer model. Since the continuum of consumers is described by distributions over [0, 1], the demand given in (16) can be regarded as the average demand per consumer. To capture this correspondence, we assume the following relation between the cost functions in a continuum model and their counterparts in a corresponding n-consumer model.Assumption 2For anyn∈N,anys∈S,and anys¯inS2,we haveCn(A,s)=nC˜(An,s),H0n(A,s)=nH˜0(An,s),andHn(A,A′,s¯)=nH˜(An,A′n,s¯),where the superscript n is used to indicate that these are the cost functions associated with an n-consumer model.Assumption 2 implies that(Cn)′(A,s)=C˜′(A/n,s),(H0n)′(A,s)=H˜0′(A/n,s),s∈S,and for anys¯∈S2,∂Hn(A,A′,s¯)∂A=∂H˜(A/n,A′/n,s¯)∂(A/n),∂Hn(A,A′,s¯)∂A′=∂H˜(A/n,A′/n,s¯)∂(A′/n),so that there is a correspondence between the marginal cost in the continuum model (evaluated at the average demand) and in the corresponding n-consumer model.In this section, we consider a sequence of dynamic games, and show that as the number of consumers increases to infinity, a DOE strategy for the corresponding continuum game is asymptotically optimal for every consumer (i.e., an approximate best response), if the other consumers follow that same strategy. In the rest of the paper, we often use a superscript n to indicate quantities associated with an n-consumer model.Suppose that all consumers except i use a dynamic oblivious strategy ν. Given a history htand an empirical distributionf−i,tn,we usev(ht,f−i,tn,ν)to denote the empirical distribution,u−i,tn,of the actions taken by consumers excluding i. In an n-consumer model, suppose that consumer i uses a history-dependent strategyκn={κtn}t=0Tof the form(22)ai,t=κtn(yi,t,ht,f−i,tn),while the other consumers use a dynamic oblivious strategy ν. LetKndenote the set of all possible history-dependent strategies κnfor the n-consumer model. Note that since all other consumers use the oblivious strategy ν,f−i,tnis completely determined by ν,f−i,0n,and ht.The stage payoff received by consumer i at time t is(23)πi,tn(yi,t,ht,f−i,tn∣κn,ν)=πn(yi,t,s¯t,ai,t,f−i,tn,v(ht,f−i,tn,ν)),whereai,t=κtn(yi,t,ht,f−i,tn),and the stage payoff function on the right-hand side is given in (14). Given an initial global state, s0, and consumer i’s initial state, xi, 0, consumer i’s expected payoff under the strategy κnis(24)Vi,0n(xi,0,s0∣κn,ν)=E{∑t=0Tπi,tn(yi,t,ht,f−i,tn∣κn,ν)},where the expectation is over the initial distributionf−i,0nand over the future global states,{st}t=1T. In particular, we useVi,0n(xi,0,s0∣ν,ν)to denote the expected payoff obtained by consumer i if all consumers use the strategy ν.Definition 2A dynamic oblivious strategy ν has the asymptotic Markov equilibrium (AME) property (Adlakha et al., 2011), if for any initial global states0∈S,any initial consumer statexi,0∈X0,and any sequence of history-dependent strategies {κn}, we havelim supn→∞(Vi,0n(xi,0,s0∣κn,ν)−Vi,0n(xi,0,s0∣ν,ν))≤0.We will show that every DOE has the AME property, under the following assumption, which strengthens Assumption 1.Assumption 3We assume that:3.1.The following four families of functions, ofA,{C˜′(A,s):s∈S},{H˜0′(A,s):s∈S},{∂H˜(A,A′,s¯)/∂A:(A′,s¯)∈A×S2},and{∂H˜(A′,A,s¯)/∂A:(A′,s¯)∈A×S2},are uniformly equicontinuous on [0, ∞).1313A sufficient condition for this assumption to hold is to require a universal bound on the derivatives of the functions in each family.The marginal costs are bounded from above, i.e.,|C˜′(A,s)|≤P,|H˜0′(A,s)|≤P,∀(A,s)∈A×S,and|∂H˜(A,A′,s¯)∂A|≤P,|∂H˜(A′,A,s¯)∂A|≤P,∀(A′,s¯)∈A×S2,where P is a positive constant.The utility functions,{Ut(x,s,a)}t=0T, are continuous in a and bounded from above, i.e.,Ut(x,s,a)≤Q,t=0,…,T,∀(x,s,a)∈Xt×S×A,where Q is a positive constant.Combining with Assumption 2, Assumption 3.1 implies that for any ε > 0, there exists a δ > 0 such that for any positive integer n, if|A−A¯|≤nδ,then for everys∈S,(25)|(Cn)′(A,s)−(Cn)′(A¯,s)|≤ɛ,|(H0n)′(A,s)−(H0n)′(A¯,s)|≤ɛ,and for any(A′,s¯)∈A×S2,(26)|∂Hn(A,A′,s¯)∂A−∂Hn(A¯,A′,s¯)∂A¯|≤ɛ,×|∂Hn(A′,A,s¯)∂A−∂Hn(A′,A¯,s¯)∂A¯|≤ɛ.Note that the boundness of the cost function derivatives implies the Lipschitz continuity of the cost functions. Combining with Assumption 2, for any pair of real numbers(A,A¯),any positive integer n, and for everys∈Swe have(27)|Cn(A,s)−Cn(A¯,s)|≤P|A−A¯|,|H0n(A,s)−H0n(A¯,s)|≤P|A−A¯|,and for any(A′,s¯)∈A×S2,(28)|Hn(A,A′,s¯)−Hn(A¯,A′,s¯)|≤P|A−A¯|,|Hn(A′,A,s¯)−Hn(A′,A¯,s¯)|≤P|A−A¯|.The following theorem states that a DOE strategy approximately maximizes a consumer’s expected payoff (among all possible history-dependent strategies) in a dynamic game with a large but finite number of consumers, if the other consumers also use that strategy.Theorem 1Suppose that Assumptions2–3hold. Every DOE has the AME property.Theorem 1 is proved in Appendix C. Various approximation properties of non-atomic equilibrium concepts in a continuum game have been investigated in previous works. Sufficient conditions for a stationary equilibrium (an equilibrium concept for a continuum game without aggregate uncertainty) to have the AME property are derived in Adlakha et al. (2011). For a continuum game with both idiosyncratic and aggregate uncertainties, Bodoh-Creed (2012) shows that as the number of agents increases to infinity, the actions taken in an MPE can be well approximated by some DOE strategy of the non-atomic limit game. Note, however, that in a general n-consumer game, even if all consumers take an action that is close to the action taken by a DOE strategy of the non-atomic limit game, the population states and the prices in the n-consumer game can still be very different from their counterparts in the non-atomic limit game. Therefore, without further assumptions on the consumers’ state transition kernel (e.g., continuous dependence of consumer states on their previous actions), the approximation property of a DOE on the action space does not necessarily imply the AME property of the DOE.In Section 6.1, we define the social welfare associated with an n-consumer model and with a continuum model. In Section 6.2, we show that for a continuum model, the social welfare is maximized (over all symmetric dynamic oblivious strategy profiles) at a DOE, and that for a sequence of n-consumer models, if all consumers use the DOE strategy of the corresponding continuum model, then the social welfare is asymptotically maximized, as the number of consumers increases to infinity.In an n-consumer model, let xt= (x1, t, …, xn, t) and at= (a1, t, …, an, t) be the vectors of consumer states and actions, respectively, at stage t. Leta¯t=(at−1,at)for t ≥ 1, anda¯0=a0. For t = 1,…, T, the social welfare realized at stage t is(29)Wtn(xt,s¯t,a¯t)=−Cn(At,st)−Hn(At−1,At,s¯t)+∑i=1nUt(xi,t,st,ai,t),and at stage 0, the social welfare is(30)Wtn(x0,s0,a¯0)=−Cn(A0,s0)−H0n(A0,s0)+∑i=1nU0(xi,0,s0,ai,0).Because of the symmetry of the problem, the social welfare at stage t depends on xtand atonly through the empirical distribution of state-action pairs. In particular, under a symmetric history-dependent strategy profileκn= (κn,…, κn) (cf. the definition of a history-dependent strategy in Eq. (22)), we can write the social welfare at time t (with a slight abuse of notation) asWtn(ftn,ht∣κn). Given an initial global state s0 and an initial population statef0n,the expected social welfare achieved under a symmetric history-dependent strategy profileκnis given by(31)W0n(f0n,s0∣κn)=W0n(f0n,s0∣κn)+E{∑t=1TWtn(ftn,ht∣κn)},where the expectation is over the future global states{st}t=1T. In particular, we useW0n(f0n,s0∣νn)to denote the expected social welfare achieved by the “symmetric dynamic oblivious strategy profile”,νn= (ν,…, ν).In a continuum model, suppose that all consumers use a common dynamic oblivious strategy ν. Given an initial global state s0, the expected social welfare is(32)W˜0(s0∣ν)=W˜0(s0∣ν)+E{∑t=1TW˜t(ht∣ν)},where the expectation is over the future global states,{st}t=1T. Here,W˜t(ht∣ν)is the stage social welfare under history ht:(33)W˜t(ht∣ν)=−C˜(A˜t|ν,ht,st)−H˜(A˜t−1|ν,ht−1,A˜t|ν,ht,s¯t)+∑x∈X0ηs0(x)Ut(lν,ht(x),st,νt(x,ht)),t=1,…,T,wherelν,htmaps a consumer’s initial state into her state at stage t, under the history htand the dynamic oblivious strategy ν. The social welfare at stage 0 is given by(34)W˜0(s0∣ν)=−C˜(A˜0|ν,h0,s0)−H˜0(A˜0|ν,h0,s0)+∑x∈X0ηs0(x)U0(x,s0,ν0(x,s0)).We now define some notation that will be useful in this subsection. Since there is no idiosyncratic randomness, given a history ht, the state of consumer i at stage t depends only on her initial state xi, 0, and her actions taken at τ = 0,…, t − 1. At stage t ≥ 1, the history htand the transition function zi, t + 1 = r(xi, t, ai, t, st + 1) define a mappingkht:X0×At→Z:(35)zi,t=kht(xi,0,ai,0,…,ai,t−1),t=1,…,T.Given an initial state xi, 0, consumer i’s total utility under a history htcan be written as a function of her actions taken at stages τ = 0,…, t:(36)U¯ht(xi,0,ai,0,…,ai,t)=U0(xi,0,s0,ai,0)+∑τ=1tUτ(xi,0,khτ(xi,0,ai,0,…,ai,τ−1),sτ,ai,τ).Before proving the main result of this section, we introduce a series of assumptions on the convexity and differentiability of the cost and utility functions.Assumption 4We assume the following:4.1.For anys∈S,C˜(·,s)is convex; for anys¯∈S2,H˜(A,A′,s¯)is convex in (A, A′).For anyhT∈HTand anyxi,0∈X0,the function defined in (36) is concave with respect to the vector (ai, 0, …, ai, T).For any t ≥ 1, anyht∈Ht,and anyxi,0∈X0,the functionkhtdefined in (35) is monotonic in ai, τ, for τ = 0, …, t − 1; further, its left and right derivatives with respect to ai, τexist, for τ = 0, …, t − 1.For t ≥ 1, and for any(x,s,a)∈X0×S×A,the left and right derivatives of the utility function Ut(x, z, s, a) in z exist.We note that supplier cost functions are generally not convex (because, for example, of start-up costs), and that there is a substantial literature on the pricing of non-convexities in electricity markets (Araoz & Jörnsten, 2011; Motto & Galiana, 2004; O’Neill, Sotkiewicz, Hobbs, Rothkopf, & Stewart, 2005). The convexity assumption (Assumption 4.1) results in a tractable analytical setting that can be used to provide some theoretic results, and is often used in the literature on optimal power flow (OPF) (Lavaei & Low, 2012; Wu et al., 2004) and on energy market economics (Baldick, Grant, & Kahn, 2004; Sioshansi & Oren, 2007). We finally note that even for non-convex cost functions, the proof of Theorem 2 (in Appendix D) shows that in a non-atomic game, a DOE corresponds to a local optimum of the social welfare. This is the best one could wish for since a local optimal cannot be improved unless a significant fraction of the consumers change their action simultaneously.For concave utility functions (with respect to a), Assumption 4.2 requires that the transition functionkhtpreserves concavity (a linear function would be an example). Assumptions 4.1 and 4.2 guarantee that in both models (a dynamic game with a finite number of consumers, and the corresponding continuum game), the expected social welfare (consumer i’s expected payoff) is concave in the vector of actions taken by all consumers (respectively, by consumer i). Assumptions 4.3 and 4.4 ensure the existence of left and right derivatives of the expected social welfare given in (32), with respect to the actions taken by consumers. An example where Assumptions 4.2–4.4 hold is given next.Example 2We show in this example that Assumptions 4.2–4.4 hold for a large category of deferrable electric loads. For appliances such as Plug-in Hybrid Electric Vehicles (PHEVs), dish washers, or clothes washers, a customer usually only cares whether a task is completed before a certain time.Given an initial state (type) of consumer i, xi, 0, let D(xi, 0) and T(xi, 0) indicate her total desired demand and the stage by which the task has to be completed, respectively. Under a given history ht, the total utility accumulated by consumer i until time t is assumed to be of the formU¯ht(xi,0,ai,0,…,ai,t)=Z(xi,0,min{D(xi,0),∑τ=0min{T(xi,0),t}ai,τ}),for some function Z. If for everyxi,0∈X0,Z(xi, 0, · ) is nondecreasing and concave, then Assumption 4.2 holds. At stage t = 0, we haveU0(xi,0,s0,ai,0)=Z(xi,0,min{D(xi,0),ai,0}).For t = 1, …, T(xi, 0), we letzi,t=∑τ=0t−1ai,τ,andUt(xi,0,zi,t,st,ai,t)=Z(xi,0,min{D(xi,0),ai,t+zi,t})−Z(xi,0,min{D(xi,0),zi,t}).For t ≥ T(xi, 0) + 1, we let zi, t= D(xi, 0), and let Ut(xi, t, st, ai, t) be identically zero. Suppose that for everyxi,0∈X0,the right and left derivatives of Z(xi, 0, · ) exist. Then, Assumptions 4.3 and 4.4 hold.Suppose thatAssumptions 2–4hold. Let ν be a DOE of the continuum game. Then, the following hold.(a)In the continuum game, the social welfare is maximized (over all dynamic oblivious strategy profiles) at the DOE, i.e.,1414Note that we are only comparing the social welfare under different symmetric dynamic oblivious strategy profiles, where all consumers are using the same dynamic oblivious strategy (ν or ϑ). This is no loss of generality because under Assumption 4, the social welfare in a continuum game is a concave function of the collection of consumer actions taken under the different histories. Hence, it can be shown that the optimal social welfare can be achieved by a symmetric dynamic oblivious strategy profile.W˜0(s0∣ν)=supϑ∈VW˜0(s0∣ϑ),∀s0∈S,whereVis the set of all dynamic oblivious strategies.For a sequence of n-consumer games, the symmetric DOE strategy profile,νn= (ν, …, ν), asymptotically maximizes the expected social welfare, as the number of consumers increases to infinity. That is, for any initial global state s0, and any sequence of symmetric history-dependent strategy profiles {κn}, we have1515Under Assumption 4, the social welfare in an n-consumer game is a concave function of the collection of consumer actions taken under the different histories. Therefore,supκn∈KnW0n(f0n,s0∣κn)is also the maximum social welfare that can be achieved by a (possibly non-symmetric) history-dependent strategy profile.lim supn→∞E{W0n(f0n,s0∣κn)−W0n(f0n,s0∣νn)n}≤0,where the expectation is over the initial population state,f0n.The proof of Theorem 2 is given in Appendix D.In an electric power system, load swings may result in significant ancillary cost to suppliers. Motivated by the observation that marginal cost pricing may not achieve social optimality in electricity markets, we propose a new dynamic pricing mechanism that takes into account the externality conferred by a consumer’s action on future ancillary costs. Besides proposing a suitable game-theoretic model that incorporates the cost of load fluctuations and a particular pricing mechanism for electricity markets, a main contribution of this paper is to show that the proposed pricing mechanism achieves social optimality in a dynamic non-atomic game, and approximate social optimality for the case of finitely many consumers, under certain convexity assumptions.To compare the proposed pricing mechanism with marginal cost pricing, we have studied a numerical example in which demand increases sharply at the last stage (cf. Appendix E). In this example, the proposed pricing mechanism creates a stronger incentive (compared to marginal cost pricing) for consumers to shift their peak load, through an additional negative price charged on off-peak consumer demand. As a result, compared with marginal cost pricing, the proposed pricing mechanism achieves a higher social welfare, and at the same time, reduces the peak load, and therefore has the potential to reduce the need for long-term investments in peaking plants.We believe that the constructed dynamic game-theoretic model, the proposed pricing mechanism, and more importantly, the insights provided by this work, can be applied to more general markets with friction. As an extension and future work, one can potentially develop and use variations of our framework to a market of a perishable product/service where demand fluctuations incur significant cost to suppliers. Examples include data centers implementing cloud services that suffer from the switching costs to toggle a server into and out of a power-saving mode (Lin, Wierman, Andrew, & Thereska, 2011), and large organizations such as hospitals that use on-call staff to meet unexpected demand.

@&#CONCLUSIONS@&#
