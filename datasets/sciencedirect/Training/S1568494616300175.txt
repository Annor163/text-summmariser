@&#MAIN-TITLE@&#
On the performance of nature inspired algorithms for the automatic segmentation of coronary arteries using Gaussian matched filters

@&#HIGHLIGHTS@&#
Nature inspired algorithms are used for the optimal parameter selection of Gaussian filters.Comparative analysis shows that differential evolution is efficient to work with GMF.The proposed GMF-DE method achieved a detection rate of 0.9402 on a training set.GMF-DE achieved a coronary artery segmentation rate of 0.9134 on a test set.The proposal reports the highest performance compared with state-of-the-art methods.

@&#KEYPHRASES@&#
Automatic segmentation,Coronary angiograms,Gaussian matched filters,Medical imaging,Nature inspired algorithms,Vessel detection,

@&#ABSTRACT@&#
This paper presents a comparative analysis of four nature inspired algorithms to improve the training stage of a segmentation strategy based on Gaussian matched filters (GMF) for X-ray coronary angiograms. The statistical results reveal that the method of differential evolution (DE) outperforms the considered algorithms in terms of convergence to the optimal solution. From the potential solutions acquired by DE, the area (Az) under the receiver operating characteristic curve is used as fitness function to establish the best GMF parameters. The GMF-DE method demonstrated high accuracy with Az=0.9402 with a training set of 40 angiograms. Moreover, to evaluate the performance of the coronary artery segmentation method compared to the ground-truth vessels hand-labeled by a specialist, measures of sensitivity, specificity and accuracy have been adopted. According to the experimental results, GMF-DE has obtained high coronary artery segmentation rate compared with six state-of-the-art methods provided an average accuracy of 0.9134 with a test set of 40 angiograms. Additionally, the experimental results in terms of segmentation accuracy, have also shown that the GMF-DE can be highly suitable for clinical decision support in cardiology.

@&#INTRODUCTION@&#
Coronary angiography is an X-ray imaging procedure designed to help cardiologists in diagnosing and treating coronary artery abnormalities. In recent years, the application and development of computational methods for automatic segmentation of coronary arteries has become essential for systems that perform computer-aided diagnosis (CAD) in cardiology. The two main challenges in X-ray coronary angiograms are the uneven illumination and the weak contrast between blood vessels and image background, which are illustrated in Fig. 1. Since the nonuniform illumination along vessel structures produces multimodal histograms, the vessel segmentation problem has been frequently addressed in two stages. The first stage is vessel detection, also called enhancement, which is used to enhance vessel-like structures while removing noise from the angiogram, and the second stage focuses on applying a classification technique over the enhanced angiogram to discriminate vessel and nonvessel pixels.Due to the importance of the automatic vessel segmentation problem, a number of computational methods have been introduced for different types of medical images. In literature, a few methods in the image frequency domain have been proposed such as Gabor filters [1–3], and wavelet transform [4]. Most of the proposed methods are computed in the spatial image domain including single-scale top-hat operator [5], multiscale top-hat operator [6,7], hit-or-miss transform [8], region-growing with differential-geometry [9], Hessian matrix [10–14], and Gaussian matched filters (GMF) [15], which have been successfully applied in retinal imaging studies [16,17].The GMF method represents a template matching technique used for detecting vessel-like structures in the spatial image domain. GMF assumes that by using a Gaussian curve as matching template, the shape of blood vessels can be detected. Generally, the Gaussian template is rotated at different orientations, and then convolved with the input image to form a filter bank. The maximum response at each pixel is preserved to acquire the enhanced image. The appropriate performance of the GMF directly depends of four parameters, which have to be tuned in order to increase the vessel detection rate. The first parameter L determines the length of the vessel segment to be detected. The second parameter σ defines the spread of the intensity profile. The third parameter T determines the position in which, the Gaussian curve trails will cut, and the last parameter κ defines the number of evenly spaced filters with angular resolution θ.This vessel detection technique has been successfully applied as a preprocessing stage in diverse automatic segmentation and registration methods. Chanwimaluang and Fan [16] applied the GMF as detection method followed by the local entropy thresholding technique as classification procedure to segment vessels in retinal fundus images. Subsequently, Chanwimaluang et al. [17] applied the above mentioned method, as part of a system for retinal image registration. Kang et al. [18] applied the GMF in a fusion strategy with the morphology-based top-hat operator to detect vessels in coronary angiograms. This fusion strategy was also used by Kang et al. [19,20] by applying the degree segmentation method to classify vessel pixels.Since the GMF method was introduced by Chaudhuri et al. [15], different values for each parameter of the detection filter have been proposed. Kang et al. [18–20] proposed different values for σ and number of oriented filters κ. Cinsdikici and Aydin [21] used the original parameters of the method, just modifying the parameter of number of oriented filters κ. Al-Rawi et al. [22] proposed to apply an exhaustive search over an extended range of the variables L, T, and σ, keeping constant the number of filters. This method obtains better detection results than the aforementioned methods, taking into account the area (Az) under the receiver operating characteristic (ROC) curve. Al-Rawi and Karajeh [23] proposed to apply the population-based technique of genetic algorithms (GAs) instead of the exhaustive search to select the optimal L, T, and σ values. According to the tests, the performance of the genetic algorithm working together with the GMF method provided better detection results than the empirically determined methods.The population-based methods have become very popular to solve optimization problems in discrete and continuous spaces. These methods consist of a set of potential solutions, which are gradually improved by using a fitness function until a stopping criterion is satisfied. Recently, nature inspired algorithms such as particle swarm optimization (PSO), differential evolution (DE), and estimation of distribution algorithms (EDAs) have begun to attract more attention for solving optimization problems with a fast convergence including parameter estimation in computational biology [24], image segmentation [25], and cancer classification [26].Considering the relevance of the Gaussian matched filters to remove image noise while enhancing vessel-like structures, an optimization process to avoid an exhaustive search for selecting the optimal GMF parameters plays an essential role. In this paper a comparative analysis of four nature inspired algorithms to improve the training stage of the GMF method through the optimal parameter selection is presented. In this approach, the optimization process is carried out over the L, T, and σ parameters whose values are computed by using GAs, EDAs, DE or the PSO algorithm by using the area Azunder the ROC curve. These algorithms are experimentally compared based on the statistical significance of the number of evaluations, dispersion, and computational time. Finally, the coronary artery segmentation results obtained from the GMF method are compared with those obtained with six, previously mentioned, state-of-the-art vessel segmentation methods using the measures of sensitivity, specificity, and accuracy.The remainder of this paper is organized as follows. In Section 2, the database of X-ray coronary angiograms, and the fundamentals of the GMF and considered nature inspired methods along with the optimization problem are introduced. The experimental results are presented and discussed in Section 3, and conclusions are given in Section 4.Due to the suitable performance of genetic algorithms to select the optimal parameters of the Gaussian matched filters for blood vessel detection [23], a comparative analysis with estimation of distribution algorithms, differential evolution, and particle swarm optimization is of interest in the present work; these methods are described in detail in the present section.The database used in the present research is composed of 80 X-ray coronary angiograms of 27 different patients. Each angiographic image is of size 300×300 pixels. To evaluate the performance of the computational methods, the database has been divided into two subsets, 40 of the 80 angiograms are used as training set, and the remaining 40 angiograms are used as test set. The ground-truth angiograms were hand-labeled by a specialist, and ethics approval was provided by the cardiology department of the Mexican Social Security Institute, UMAE León.The Gaussian matched filters method was proposed by Chaudhuri et al. [15] for detecting vessel-like structures in different types of medical images. The GMF method is founded on the fact that the shape of blood vessels in the spatial image domain can be detected by applying a Gaussian curve as matching template, which is defined as following:(1)G(x,y)=−exp−x2+y22σ2,|y|≤L/2,where L represents the length (in pixels) of the vessel segment to be processed, and σ is the average width of the vessel-like structures. Since the Gaussian curve has infinitely long double sided trails; the trails are commonly truncated at u=±3σ. A neighborhood N is defined as following:(2)N={(u,v),|u|≤T,|v|≤L/2}where T is a discrete parameter (in pixels) used to define the position where the Gaussian curve trails will cut. In order to detect blood vessels at different orientations, the Gaussian kernel G(x, y) is rotated at different angles (θ) using κ=180/θ oriented filters as in Eq. (3), where κ is the number of evenly spaced filters in the range[−π2,π2]. These oriented kernels are convolved with the original image, and pixels with the maximum response over all orientations are conserved to generate the final filtered image.(3)κ=cosθi−sinθisinθicosθi.Moreover, the process of selection of the optimal parameters of the GMF method plays a vital role for each application. To select the highest vessel detection performance of the method, one continuous parameter (σ), and three discrete parameters (L,T,θ) have to be determined.In Fig. 2, an X-ray coronary angiogram along with its ground-truth image drawn by a specialist are illustrated. Fig. 2(c) presents the Gaussian kernel originally proposed by Chaudhuri et al. [15] as L=9, T=13, κ=12, and σ=2.0. Fig. 2(d) and (e), introduce the matching templates acquired from the Gaussian kernel oriented at θ=0°, and θ=45°, respectively. The final enhanced image obtained from the above mentioned parameters of the GMF method is given in Fig. 2(f).Genetic algorithms (GAs) are from the family of evolutionary computation (EC) techniques that emulate genetic evolution. GAs are population-based methods to solve optimization problems that can be considered as stochastic global search strategies [27,28]. GAs use a set of individuals (potential solutions) called population, which is gradually improved until a stopping criterion is satisfied (e.g., number of iterations). For each iteration also called generation, the individuals are evaluated according to an objective function, and by applying the evolutionary operators of selection, crossover, and mutation. The selection operator is used to obtain the best individuals at each generation to form a base for a new improved population. The crossover operator is used to exchange information between two or more selected individuals. Finally, the mutation operator is often applied to introduce randomly information in the population.According to the above description, GAs can be implemented by using the following procedure:1.Establish number of generations G, population size Np, crossover rate CR, and mutation rate MR.Initialize the individuals within the search space.Evaluate population in the objective function.For each generation g={1, …, G}:(a)Select a subset of the best individuals;Generate new individuals by applying the crossover and mutation operators;Evaluate new individuals in the objective function;Update population by replacing worst individuals with the best new individuals.Stop if the convergence criterion is satisfied (e.g., stability or number of generations).EDAs represent a family of population-based methods that incorporate statistical information of potential solutions to solve optimization problems in discrete and continuous domains [29,30]. Similar to EC techniques, EDAs use selection operators, binary or real encoding, and a population of potential solutions to perform the optimization task. The key feature of EDAs resides in the fact that the crossover and mutation operators are not required, since the new individuals are created by building a probabilistic model based on global statistical information of promising solutions at each generation. In the present work, the univariate marginal distribution algorithm (UMDA) has been adopted because it works ideally for linear problems with not many significant dependencies [31,32].UMDA employs a binary codification of the problem, and it generates a probability vector p=(p1, p2, …, pn)T, where piis the marginal probability for the i variable empirically computed, and it is used for simulating new potential solutions for each variable independently. The fundamental idea of UMDA is to approximate the probability distribution of the individuals inℙtas the product of the univariate frequencies calculated from selected solutions assuming that all the variables are independent [33]. The evolutionary process of UMDA can be summarized in the steps of selection of promising individuals, estimation of probability distribution, and generation of new potential solutions. In the selection step, the individuals within the search space Ω are arranged according to fitness value, then a proportional selection s is computed as follows:(4)ℙs(x)=ℙ(x)f(x)∑x˜∈Ωℙ(x˜)f(x˜).The second step consists in the estimation of the univariate marginal probabilitiesℙ. The probability model for independent variables can be stated as follows:(5)ℙ(x)=∏i=1nℙ(Xi=xi),where x=(x1, x2, …, xn)Tis the binary value of ith bit in the individual, and Xiis the ith random value of the vector X. In the last step of UMDA, new individuals are generated through the estimated probability distribution and evaluated by the fitness function at each generation. Finally, these three steps are performed until a convergence criterion is satisfied.According to the above description, UMDA can be implemented by the following procedure:1.Establish number of n individuals and number of generations t.Initialize the individuals within the search space.Select a subset of individuals S of m≤n according to a selection method.Calculate the univariate marginal probabilitiespis(xi,t)of S.Generate n new individuals by applyingp(x,t+1)=∏i=1npis(xi,t).Stop if convergence criterion is satisfied (e.g., stability or number of generations), otherwise, repeat steps (3)–(5).Differential evolution (DE) is a stochastic real-parameter technique introduced by Storn and Price [34,35] for numerical global optimization problems. DE uses a set of Np randomly initialized individuals X={x1, x2, …, xNp}, which are gradually improved according to an objective function and the evolutionary principles of mutation, crossover and selection. The mutation operator generates a mutant vector Vi,g+1 at each generation g based on the distribution of the current population {Xi,g|i=1, 2, …, Np} by applying the following mutation strategy:(6)Vi,g+1=Xr1,g+F(Xr2,g−Xr3,g),r1≠r2≠r3≠i,where r1, r2 and r3 are the indexes of three individuals from the current population mutually different and uniformly selected from the set {1,…,Np}, g indicates the current generation of the evolutionary process, and F is the differentiation factor also known as mutation parameter. The second step corresponding to the crossover operator is used to create a trial vector Ui,g+1 as follows:(7)Ui,g+1=Vi,g+1,ifr≤CRXi,g,ifr>CRwhere r represents a uniform random value on the interval [0, 1], which is compared with the crossover rate, CR∈[0, 1]. The CR is a constant value that controls the rate of parameters values that are copied from the mutant vector, and it also controls the diversity of solutions in the population. If the value of r is bigger than CR, the current individual Xi,gis preserved, otherwise, the mutant vector Vi,g+1 is copied to the trial vector Ui,g+1. Commonly, a low CR value leads to a slow convergence to the optimal solution and it poses challenges for multi-modal problems. On the other hand, a high CR value provides high diversity to the pool of candidate solutions, which is useful for the present work. The CR value was determined statistically in the range [0, 1] in steps of 0.5, using the training set. Finally, the selection operator uses the best one between the individual Xi,gand the trial vector Ui,g+1 to replace the current individual in the next generation.(8)Xi,g+1=Ui,g+1,iff(Ui,g+1)<f(Xi,g)Xi,g,otherwiseAccording to the above description, the DE algorithm can be implemented by the following procedure:1.Establish number of generations G, population size Np, differentiation factor F and crossover rate CR.Initialize each individual Xiby generating random solutions within the search space.For each individual Xi,g, where g={1, …, G}:(a)Compute Vi,g+1 using the mutation operator (6);Assign Ui,g+1 applying the crossover operator (7);Update Xi,g+1, if Ui,g+1 is better than Xi,gemploying the selection operator (8).Stop if the convergence criterion is satisfied (e.g., stability or number of generations).PSO is a computational intelligence technique proposed by Eberhart and Kennedy [36], and improved by Shi and Eberhart [37] to solve numerical optimization problems. PSO consists of a set of potential solutions known as swarm, where each solution also called particle represents a point in an N-dimensional space Xi={xi1, xi2, …, xiN}. At each iteration, the particles move through hyperspace to a new position using the following velocity equation:(9)vi(t+1)=φvi(t)+κr1(Pbest−xi(t))+κr2(Pgbest−xi(t)),where xiis the particle in the time (t) andviis its current velocity, φ represents the inertia weight, κ is the learning factor, and r1, r2∼U(0, 1) are random values from a uniform distribution. Pbestrepresents the best solution found by the current particle, and Pgbestis the best solution of the whole swarm. The last step of the PSO model consists in updating the current position of the particle within the search space according to the position equation as follows:(10)xi(t+1)=xi(t)+vi(t+1).Moreover, the PSO algorithm described above can be implemented through the following procedure:1.Establish number of particles of the swarm, inertia weight and learning factor.Initialize position and velocity of each particle within the search space.Evaluate each particle in objective function to update its Pbest, if the new fitness is better.Find the best particle in the whole swarm to update the Pgbest, if the fitness value is better.Stop if the convergence criterion is satisfied (e.g., stability or number of iterations).Update velocity and position of the whole swarm by using (9) and (10), respectively, then repeat steps 3–5.Since the detection performance of the GMF method directly depends of four parameters, many researchers have proposed different values for each parameter. According to the work of Chaudhuri et al. [15], these parameters can be set as L=9, T=13, σ=2.0, and θ=15 acquiring κ=12 evenly spaced filters. Kang et al. [18–20] modified the angular resolution of the original work to θ=30°, obtaining 6 oriented templates, and the average vessel width to σ=1.5, in order to be applied on coronary angiograms. Cinsdikici and Aydin [21] modified the angular resolution to θ=10° obtaining κ=18 oriented templates. This method was applied in a hybrid model with the ant colony algorithm on ophthalmoscope images. Al-Rawi et al. [22] modified the GMF method by extending the range of the variables to L={7, 7.1, …, 11}, T={2, 2.25, …, 10}, σ={1.5, 1.6, …, 3}, and keeping constant the number of evenly spaced filters to κ=12. In this method, an exhaustive global search was performed over all possible combinations of the extended parameters, and the best detection rate was determined through the area (Az) under the receiver operating characteristic curve. To avoid the exhaustive global search, Al-Rawi and Karajeh [23] applied the population-based technique of genetic algorithms (GAs) to select the optimal L, T, and σ values in retinal images. The GMF based on GAs obtained superior performance than the previous empirically methods in terms of blood vessel detection, and also it reduced the number of evaluations regarding the exhaustive search method.Based on the appropriate performance of the evolutionary method, in the present work a comparative analysis of four population-based methods has been performed to select the optimal parameters of the GMF method while reducing the number of evaluations of the objective function. The search space of the GMF method was defined taking into account the above described methods and the dataset of X-ray coronary angiograms. The search space of the parameters was established as L={8, 9, …, 15}, T={8, 9, …, 15}, and σ=[1, 5] with an step size of Δ=0.01 (25,664 possible solutions). The parameter of number of oriented filters was established as κ=12, since similar results were obtained with κ=15, 20, 30, 45, and 60 oriented filters. For further analysis, κ=12 with angular resolution of θ=15° was applied.To perform the optimization task, the area Azunder the ROC curve has been used as the objective function to be maximized. The receiver operating characteristic (ROC) curve is a plot that represents the true-positive fraction (TPF) against false-positive fraction (FPF). TPF is the rate of vessel pixels correctly detected by the computational method regarding the ground-truth image. FPF is the rate of nonvessel pixels incorrectly classified as vessel pixels by the method. The Azvalue is in the range [0, 1], where 1 is perfect detection, and 0 otherwise.On the other hand, to assess the vessel and nonvessel pixel classification, the measures of sensitivity, specificity, and accuracy have been adopted.The sensitivity measure, also called (TPF), is defined as the fraction of vessel pixels hand-labeled by the specialist that are correctly detected by the method as follows:(11)Sensitivity=TPTP+FN,where TP is the fraction of vessel pixels correctly classified as such by the method, and FN represents the fraction of vessel pixels incorrectly classified by the method.The specificity measure is defined as the fraction of nonvessel (background) pixels that are correctly classified as such by the method, and can be computed as follows:(12)Specificity=TNTN+FP,where TN is defined as the fraction of nonvessel pixels correctly classified as such by the method, and FP represents the fraction of nonvessel pixels that are incorrectly classified.The accuracy measure indicates the fraction of correctly classified pixels, i.e., the sum of TP and TN divided by the number of pixels in the image, as follows:(13)Accuracy=TP+TNTP+FP+TN+FN.The measures of sensitivity, specificity, and accuracy are in the range [0, 1], where 1 is perfect classification, and 0 otherwise. These measures are used to evaluate the vessel classification performance according to the vessels hand-labeled by the specialist.In Section 3, the segmentation results obtained from the proposed method using X-ray angiographic images are presented and analyzed by the evaluation metrics.

@&#CONCLUSIONS@&#
