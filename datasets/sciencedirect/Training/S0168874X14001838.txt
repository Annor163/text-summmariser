@&#MAIN-TITLE@&#
3D robust iterative coupling of Stokes, Darcy and solid mechanics for low permeability media undergoing finite strains

@&#HIGHLIGHTS@&#
Robust method to couple iteratively Stokes, Darcy and solid mechanics.Application to industrial composite manufacturing (finite deformations, thin pure fluid layer, low permeability down to 10−15m2 and complex shapes).Solution for key issues for Stokes Darcy coupling with low permeability (mass conservation).Iterative fluid/solid coupling method based on Terzaghi principle and explicit permeability computation through solid mechanics volume changes.

@&#KEYPHRASES@&#
Stokes–Darcy coupled problem,Fluid–solid interaction,Iterative coupling,P1+/P1,Manufactured Exact Solution Method,Composites,

@&#ABSTRACT@&#
Stokes, Darcy and solid mechanics coupling is a matter of interest in many domains of engineering such as soil mechanics, bio-mechanics, and composites. The aim of this paper is to present a robust iterative method to deal with this coupling for low permeability media within the framework of industrial simulation, and especially for composite manufacturing processes. Stokes and Darcy problems are solved using a mixed velocity–pressure finite element using a mini-element formulation, and coupled together by the so-called Beavers–Joseph–Saffman conditions through their interface. This fluid formulation is then coupled to a non-linear solid mechanics formulation in finite deformations using Terzaghi׳s law at the pore level, and an explicit dependence of permeability with respect to porosity that is exactly computed from the solid mechanics kinematics. Then, those formulations are validated with test-cases and by the Method of the Manufactured Exact Solution (MMES) (Knupp and Salari, 2003[1]). Finally, a 3D curved transient example of application is presented.

@&#INTRODUCTION@&#
This paper presents an iterative method to strongly couple Stokes and Darcy flows, in low permeability media, with finite strain solid mechanics in order to deal with fluid seepage into and out from low permeability media undergoing finite strains. It is applied here to complex manufacturing processes for composites in an industrial framework. It represents an improved extension of the work presented by Celle in [2,3] to 3D and complex shapes with low permeability down to10−15m2, opening the possibility to deal with industrial cases. In this approach two main problems have to be tackled, first the coupling between Stokes (pure fluid) and Darcy (flow through low permeability porous medium) flows and second, the fluid/structure interaction. In the case of low permeability media, the couplings are quite tricky to handle numerically especially due to the system conditioning where, for example, penalty coefficients will combine with very low contributions. Special attention will be paid, in this paper, to validate the numerical development in this framework.Stokes and Darcy coupling has recently been a matter of interest for many researchers in various domains of application such as bio-mechanics [4], environment (river flow) [5,6] or composite processing [2,3,7]. From those works, one can identify two strategies to deal with Stokes–Darcy coupling, a unified approach [4,7,8] relying on a monolithic formulation of the so-called Brinkman problem (Stokes + Darcy), and an iterative one [3,9] based on two formulations interacting through boundary/interface conditions.As for the fluid structure interaction, it is usually considered at a scale of observation where the porous medium can be seen as homogeneous. Then, the corresponding solid–fluid mechanical formulation is seen as ‘smeared-out’ and corresponds to poroelasticity which has been widely used and therefore developed in soil mechanics [10–12] and bio-mechanics [13,4]. In this case as well, different ways are presented in the literature to deal with fluid–structure interaction. First, simplified fluid–solid mechanics frameworks can be considered, introducing in 1D models some relationships relating explicitly interstitial fluid pressure with thickness variation [14–18], therefore limiting the domain of interest to simplistic processes. Second, in a more general framework, some researchers chose to solve a fully three dimensional solid–fluid mechanical formulation either through heavy monolithic approaches [19] or using an iterative method based on permeability and stress updates depending on displacement–velocity considerations [2,3]. In any case, all these coupling methods between fluid flow and solid mechanics within porous media rely on Terzaghi׳s principle [10].The originality of the proposed method is that it remains robust and accurate even for real severe physical parameters such as low permeability values, thin pure fluid layer, large deformations and complex geometries which are often discarded in recent publications but definitively more relevant with respect to industrial applications. Second, the proposed industry-targeted method feature stands in its global approach which yields well-founded mechanistic relationship between flows and deformations. All the phenomena (pure and porous flows, and solid mechanics) are fully simulated and strongly coupled iteratively together. This permits to minimize the number of physical parameters which are required for describing the coupling mechanisms, somehow tricky and expensive to characterize within industrial context. Indeed, this approach does not require to perform compression test on wet fiber beds, only the constitutive law of the dry preforms is required. Moreover, the use of three independently formulated formulations makes it easy to use one, two of them, or the whole package to simulate all kinds of processes based on the same physical phenomena and to add, in the future, other formulations such as thermo-physico-chemical aspects, to simulate more complex coupled phenomena and processes.This paper will present first the FE formulation for the fluid problem, in Stokes, Darcy, and coupled regimes, in Section 2. This coupled flow formulation will be then validated using test cases along with the Method of the Manufactured Exact Solution (MMES) [1] in Section 3. Second, the finite strain solid mechanics formulation will be exposed (Section 4) and coupled with the fluid flow problem (Section 5) and validated. Eventually, examples of fluid infiltration into 3D compacting orthotropic porous media will be given.Let us formulate first the stabilized Stokes, Darcy, and Stokes–Darcy coupled problems. As depicted in Fig. 1, for the fluid flow one may split the whole domainΩto be studied, into two areas.The purely fluid regionΩSis governed by the Stokes equations system:(1)|∇̲·(2ηD̲̲(v̲S))−∇̲pS=0∇̲·v̲S=0where η is the fluid dynamic viscosity,vS̲the fluid velocity, p the fluid pressure andD̲̲(v̲)=12(∇̲̲v̲+∇T̲̲v̲)the Eulerian strain rate associated with the velocity fieldv̲. The porous medium areaΩDis governed by the Darcy equations system:(2)|v̲D=1ηK̲̲(−∇̲pD+ρg̲)∇̲·v̲D=0wherev̲Dis the Darcy velocity or the macroscopic mean velocity of the fluid with respect to the preforms, p the pore pressure,K̲̲the permeability tensor assumed diagonal in the element frame, η the fluid viscosity and ρ the volumetric mass of the fluid. The two domains are separated by an interfaceΓ=ΩS∩ΩDthrough both mass conservation and normal stress continuity must be fulfilled (see Fig. 1). In addition, it is chosen to control the tangential velocity jump with a drag coefficient α leading to the Beavers–Joseph–Saffman [20] condition. Since Darcy׳s law assumptions imply that shear is neglected (σ̲̲D=−pDI̲̲), the normal stress continuity is equivalent to a Dirichlet boundary condition on the hydrostatic pressure when using the primal formulation of Darcy system (5), leading to the following system of conditions onΓ:(3)|v̲S·n̲=v̲D·n̲2n̲·D̲̲(v̲S)·τi̲=−αKii(v̲S−v̲D)·τi̲pD=pSwheren̲=n̲S=−n̲Dis the outward normal vector of Stokes/Darcy interface, τirefers to the unit tangential vectors to the interface and Kiiare the corresponding permeabilities.Numerically, there are several ways to formulate the coupled problem. Indeed, the form of the Darcy problem allows us to separately solve for pressure and velocity fields [17]. Those methods consist in finding the pressure field and then post-treating the velocity with Darcy׳s law. However, those approaches imply velocity discontinuities if permeability changes within the domain, leading to mass conservation issues. This is even more drastic for Stokes/Darcy coupling where velocities may strongly differ in the vicinity of the Stokes/Darcy interface proportionally to the permeability jump. As for the Stokes equations, they are ideally solved using a mixed velocity/pressure formulation to ensure mass conservation. For those reasons, a mixed velocity/pressure formulation is chosen for both Stokes and Darcy problems. These formulations can take two different forms in which velocity and pressure boundary conditions appear as Dirichlet or Neumann conditions. A convenient choice for our approach is the dual mixed formulation for Stokes and primal mixed formulation for Darcy [2,3] presented below.The dual mixed velocity/pressure formulation of Stokes equation writes as follows:(4)|Find(v̲,p)∈Ev̲×L2(ΩS)|∀(δv̲,δp)∈Eδv̲×L2(ΩS),∫ΩS2ηD̲̲(δv̲):D̲̲(v̲)dv−∫ΩSp∇̲·δv̲dv=∫∂ΩS,t2ηδv̲·D̲̲(δv̲)·n̲ds−∫∂ΩS,tpδv̲·n̲ds︸∫∂ΩS,tδv̲·σ̲̲·n̲ds∫ΩSδp∇̲·v̲dv=0Eδv̲={δv̲∈H1(ΩS)|δv̲=0̲on∂ΩS,v̲}Ev̲={v̲∈H1(ΩS)|v̲=v̲don∂ΩS,v̲}where∂ΩS,tis a boundary of the Stokes domain submitted to normal stresst̲=σ̲̲n̲and∂ΩS,v̲is the complementary boundary submitted to a prescribed velocityv̲d.The primal mixed velocity/pressure formulation of Darcy equation writes as follows:(5)|Find(v̲,p)∈L2(ΩD)×Ep|∀(δv̲,δp)∈L2(ΩD)×Eδp,∫ΩDδv̲ηK̲̲v̲dv+∫ΩDδv̲∇̲pdv=∫ΩDδv̲ρg̲dv∫ΩDv̲∇̲δpdv=∫∂ΩD,vδpv̲n̲dsEδp={δp∈H1(ΩD)|δp=0on∂ΩD,p}Ep={p∈H1(ΩD)|p=pdon∂ΩD,p}where∂ΩD,pis a boundary of Darcy domain submitted to an imposed pressure pdand∂ΩD,v̲is the complementary boundary submitted to a prescribed normal velocityv̲nd=v̲·n̲.When discretizing those formulations with a velocity-based finite element method, stability problems appear due to the fluid incompressibility. In order to avoid non-physical pressure modes due to this instability, one must consider to choose elements that fulfill the Brezzi–Babuska condition [21]. A good way to respect this condition is to ensure that the degree of approximation for the velocity field is larger than the pressure one [22]. In the literature two families of elements can be found. The first one is the Taylor–Hoods elements type (P2/P1 or P1/P0) [23,24]. The second type corresponds to standard finite element formulations stabilized with the so-called multi-scale stabilization method that consists in formulating the problem on a coarse scale (nodes) and a fine scale (center of the element), the fine scale being possibly condensed in a stabilization term. Among those approaches one can find the Hughes variational multi-scale (HVM) method [7,8] and the mini-element [2,3,25]. In the present work, the mini-element is selected for its robustness and simplicity of implementation. Indeed, it is based on the same degree of interpolation for both pressure and velocity and there is no constant to introduce and to calibrate in the stabilization term contrary to HVM [8] or ASGS methods [26,27].In what follows, is described the practice of the stabilization for the dual mixed formulation of Stokes problem, the same procedure is applied to stabilize the primal mixed Darcy formulation. The mini-element stabilization method stands on the enrichment of the velocity field approximation by the introduction of an extra node in the center of the element (see Fig. 2). Since the velocity field degree of interpolation is higher than the pressure one, the Brezzi–Babuska condition is fulfilled avoiding pressure parasitic modes [21].Let us introduce the superscript h to distinguish the approximated fields from the exact ones. The extra velocity degree of freedom leads to the following decomposition for the velocity approximation (v̲h(x̲)) and the corresponding weighting function (δv̲h(x̲)), taken in the functional spaces described in Eq. (8):(6)v̲h(x̲)=v̲lh(x̲)+v̲bh(x̲)=∑i=1ne[Ni(x̲)]{v̲lih}+[be(x̲)]{v̲bh}δv̲h(x̲)=δv̲lh(x̲)+δv̲bh(x̲)=∑i=1ne[Ni(x̲)]{δv̲lih}+[be(x̲)]{δv̲bh}whereNi(x̲)are the shape functions of the element equal to 1 at node i and 0 at the other nodes, neis the number of nodes in the element and beis the bubble shape function that vanishes on the edge of the element (see Fig. 2). The following decomposition for the pressure approximation (ph(x̲)) and the corresponding weighting function (δph(x̲)) is proposed (functional spaces are described in Eq. (8)):(7)ph(x̲)=∑i=1neNi(x̲)pihδph(x̲)=∑i=1neNi(x̲)δpihIntroducing the previous discretization in system (4), the weak form of the Stokes problem writes as follows:(8)|Find(v̲lh,v̲bh,ph)∈Ev̲lh×Ev̲bh×L2(ΩS)|∀(δv̲lh,δv̲bh,δph)∈Eδv̲lh×Eδv̲bh×L2(ΩS),∫Ω2ηD̲̲(δv̲lh):D̲̲(v̲lh+v̲bh)dv−∫Ωph∇̲·δv̲lhdv=∫∂Ωtδv̲lh·σ̲̲·n̲ds∫Ω2ηD̲̲(δv̲bh):D̲̲(v̲lh+v̲bh)dv−∫Ωph∇̲·δv̲bhdv=0∫Ωδph∇̲·v̲lhdv+∫Ωδph∇̲·v̲bhdv=0Eδv̲lh={δv̲lh∈H1(ΩS)|δv̲lh=0̲on∂ΩS,v̲lh}Ev̲lh={v̲lh∈H1(ΩS)|v̲lh=v̲lhdon∂ΩS,v̲lh}Eδv̲bh=Ev̲bh={v̲bh∈H1(ΩS)|v̲bh=0̲on∂ΩS,v̲bh}After few mathematical steps described in [21], the discrete stabilized Stokes system can be written under the following form:(9)[[Kll][Klp]T[Kpl][Cpp]]{{v̲l}{p}}={F̲0̲}where[Cpp]=−[Kpb][Kbb]−1[Kbp]Tis the stabilization term. Finally, one can summarize the method to the introduction of a stabilization term[Cpp]inversely proportional to the viscosity η that relaxes the fluid incompressibility constrain. In the same way, one can stabilize the Darcy formulation with a term proportional toK̲̲/η[2,3].This stabilization method has been validated on test cases in [2,3] for hierarchical bubble functions (P1+, see Fig. 2) and its good rate of convergence verified with the method of the manufactured exact solution (MMES) proposed in [28]. In Section 3, are presented an analytical validation of the coupled problem and an illustration of the MMES validation.The solution selected for coupling Stokes and Darcy flows consists in dealing with two sub-meshes, respectively for Stokes and Darcy domains, non-necessarily structured but matching at the interface. The flows are solved individually, in an iterative scheme, until equilibrium is reached at their interface. Practically, normal velocity taken from Darcy׳s domain,v̲D·n̲, is imposed by a penalty method into Stokes equations through a Dirichlet boundary condition in velocity, and the hydrostatic pressure taken in the Stokes׳ domain, pS, is prescribed into Darcy equations as a Dirichlet boundary condition in pressure (see points2and3in Fig. 12). Convergence is reached when both pressure and velocity corrections tend toward zero, lower than a given admissible bound.Numerically, the coupling methods introduced imply to pay attention in the construction of the global system to be solved, let us say[κ]{u}={F}. First of all, the kinematic boundary conditions (tangential and normal velocity) prescribed by penalty method lead to the following system for a general interface defined by its normal components(n̲=nx·x̲+ny·y̲+nz·z̲):(10)(⋯⋯⋯⋯⋯⋯ABC⋯⋯D+QnxE+QnyF+Qnz⋯⋯GHI⋯⋯⋯⋯⋯⋯){⋮vxivyivzi⋮}global={⋮LM+Qv̲D·n̲N⋮}where Q is a penalty coefficient usually taken as108−12max(κij). However, on one hand high values of Q ensure that the condition is well fulfilled, while on the other hand they will lead to an ill conditioned system due to extra out-of diagonal terms for which iterative solvers poorly behave. To ensure a good conditioning, the Dirichlet conditions can be prescribed by penalty but in a local reference system attached to the nodes where normals to the frontier (or the interface) have to be considered as one of the axes of this local reference system (see Fig. 3). In practice, the velocity degrees of freedom are locally rotated. For an interface of normaln̲=nxx̲+nyy̲the system at the elementary level will become(11)[[I][0][0][R]]T[κe][[I][0][0][R]]{{Vg}{Vl}}=[[I][0][0][R]]T{fe}where[R]is the rotation matrix from the global to the local reference system,{Vg}is the unknown nodal velocity vector expressed in the global reference system and{Vl}is the unknown nodal velocity vector expressed in the local reference system. The local problem thus writes now in a dominant-diagonal form(12)(⋯⋯⋯⋯⋯⋯Any−BnxAnx+BnyC⋯⋯Dny−EnxDnx+Eny+QF⋯⋯Gny−HnxGnx+HnyI⋯⋯⋯⋯⋯⋯){⋮vxivyivzi⋮}local={⋮LM+Qv̲D·n̲N⋮}After solving the system, the velocity needs to be post-treated to be expressed in the global reference system. It must be noted that due to the relatively small permeabilities considered in this study, the Darcy velocity to impose as Dirichlet boundary conditions in Stokes formulation is small. So in order to penalize properly the system, the penalty coefficient Q should be chosen regarding permeability to ensureM≪Qv̲D·n̲. It was verified for permeabilities down to10−15m2thatQ=105/KforK<10−6m2leads to satisfactory results [27,28].Secondly, an important issue concerns the use of the mini-element P1+/P1. Indeed, as shown in Section 2.1, the stabilization method relies on the relaxation of the fluid incompressibility constrain equivalent to(13)∇̲·v̲+βp=0with β the stabilization term proportional to1/ηfor Stokes and toK̲̲/ηfor Darcy. When considering a regular Stokes flow β is sized by the viscosity (η) and remains sufficiently low to considerβpnegligible, ensuring the fluid incompressibility (∇̲·v̲≈0). However when this Stokes׳ flow is coupled to a porous flow with low permeability, the Darcian normal velocity to be imposed into the Stokes formulation can be extremely low, down to10−13ms−1, implying small velocities over the whole domain. In such a case, typical in composite process simulation, the stabilization termβpmay not be negligible at all, leading to a non-zero velocity divergence in Stokes domain. The incompressibility constrain cannot be enforced anymore. To ensure an acceptable value of the velocity divergence, it may be necessary to introduce an artificial viscosity in the computation of the stabilization term β in Eq. (13) or[Cpp]in the global system (9). It has been found that an artificial viscosity equal to 10 times the real one guarantees good results down to permeability values of10−15m2. This is another improvement proposed in this paper, since it allows us to deal with real severe physical applications as shown in validation cases and in the final example of Section 7.In order to demonstrate the benefit of the artificial viscosity a comparison was made on a simple test case. This test case is described in Fig. 4and consists of a flow perpendicular to the Stokes/Darcy interface. Given the boundary conditions, this case has a simple analytic solutionv̲=−1.76×106Kyy. Fig. 5shows the ratio of simulated velocity magnitude over analytical velocity magnitude without and with artificial viscosity for different permeability values.To validate the Stokes/Darcy coupling, we investigate the test case of a flow parallel to the interface in a steady state, presented in Fig. 6. Let us consider a porous medium of permeabilityK=10−15m2and dimensionsHD=2mand L=5m crossed by a fluid of viscosity η=1Pas submitted to a pressure differential ofp1−p0=10Pain contact with a pure fluid layer of thicknessHS=1mand submitted to the same pressure differential. The remaining boundaries are considered as impervious wallsv̲·n̲=0. This test case has an analytical solution [7]:(14)|vx=−K2η(λ2+2αλ1+αλ)dPdx(1+αKy)+12η(y2+2αyK)dPdxfor0≤y≤HSvx=−Kη(p1−p0L)fory<0vy=0foranyywithλ=HS/K,dP/dx=(p1−p0)/Land α being the drag coefficient.Fig. 7shows the results obtained for four values of α, the coefficient controlling the tangential velocity on the Stokes/Darcy interface (Eq. (3)). It confirms the good implementations of the coupling methods. One can verify the effect of this coefficient leading to Poiseuille׳s flow in the extreme case (α large). Finally, one can remark that α should be chosen regarding permeability, in the present case we choseα=0,α=K,α=102Kandα=104K. In Fig. 8, the pressure and velocity fields computed forα=0, corresponding to Fig. 7(a) case, are presented.The numerical simulations were performed over a mesh of 3094 triangles made up of two non-necessarily structured meshes matching at the interface. The convergence, corresponding to Stokes/Darcy equilibration, was reached (for the four cases) in three iterations with a relative error between the two last iterations of the order of 10−9.The proper implementation of the coupling algorithm was verified with the method of the manufactured exact solutions (MMESs) [1]. This method consists in building an analytical solution, that is then introduced into the analytical system of PDE to be solved, to deduce the corresponding source term. Finally, the finite element problem is loaded with this source term, and solved for the discrete solution that can be compared with the exact analytical one, to assess the accuracy.Let us consider a domainΩ=(0,1)×(0,2)m2divided into two subdomainsΩS=(0,1)×(1,2)m2governed by the Stokes׳ equation andΩD=(0,1)×(0,1)m2governed by Darcy׳s law in contact along the interfaceΓ=ΩS∩ΩD. The pressure and velocity fields proposed by Discacciati in [6] are considered:(15)|v̲S·x̲=−cos(π/2y)sin(π/2x)v̲S·y̲=cos(π/2x)sin(π/2y)−1+xps=1−x(16)|v̲D·x̲=sin(π/2x)cos(π/2y)+yv̲D·y̲=cos(π/2x)sin(π/2y)+x−1pd=2/πcos(π/2x)cos(π/2y)−y(x−1)Let us consider regular meshes constructed with squares of sizeh×hsplit into two triangles. Each computation was made over a more refined mesh (h is divided by 2) than the previous one starting with h=0.1 down to h=0.0125. For the sake of simplicity we chose η=1Pas and K=1m2 as proposed in [6]. Fig. 9shows isovalues of the numerical solution for pressure and for velocity, for h=0.0125.For every mesh and each numerical solution vhand ph, the errors are calculated using the L2 norm:(17)∥u∥0,Ω=(∫Ωu2dΩ)1/2and H1 norm:(18)∥u∥1,Ω=(∥u∥0,Ω2+∑j=1d∥∂u∂xj∥0,Ω2)1/2Errors thus calculated permit to compare the numerical rates of convergence to the theoretical ones. Stokes rate of convergence should verify [29]:(19)∥v̲−vh̲∥1,ΩS+∥p−ph∥0,ΩS≤C1h(∥v̲∥2,ΩS+∥p∥1,ΩS)and Darcy rate of convergence should verify [29]:(20)∥v̲−vh̲∥1,ΩD+∥p−ph∥0,ΩD≤C2h(∥v̲∥2,ΩD+∥p∥1,ΩD)where C1 and C2 are some constants. Convergence of the solution was studied and computed errors for pressure and velocity for the different mesh sizes are presented in Tables 1 and 2for Stokes and Darcy domain respectively. Fig. 10shows that pressure and velocity converge respectively with rates of 1.8 and 2.2 in Stokes domain and with rates of 2 and 1.4 in Darcy domain. These results correspond to the theoretical and numerical convergence rates determined in [29] with Eqs. (19) and (20).Finally, the good convergence rates and the good agreement with analytical results allow us to validate the implementation of the coupling algorithm and to confirm its robustness.The solid mechanics problem is non-linear on two counts, first due to the non-linear response of the porous medium and second due to the finite deformations. An updated Lagrangian formulation in displacement is adopted here [2,3] which writeswhereS̲̲is the second Piola–Kirchoff stress tensor,δE̲̲is the virtual Green–Lagrange tensor,f̲sare the contact forces acting on the solid surface andδu̲is the virtual displacement field. This formulation relies on a Newton–Raphson scheme to deal with those non-linearities. Actually, the hyper-elastic orthotropic constitutive relationship is solved in a local reference system for each element to take into account the material orientations. The procedure consists of a first elastic prediction:(22)[MT({0})]{u0}={R}where[MT({0})]is the initial tangent matrix computed with the stiffness taken at the origin of the constitutive law and{u0}is the unknown displacement at the prediction iteration. Then convergence is checked with the relative residual as follows:(23)∥[MS({ui−1})]{ui−1}−{R}∥∥{R}∥≤rfori≥1where[MS({ui−1})]is the current secant matrix computed from the constitutive response,{ui−1}the displacement at previous iteration and r the target component residual value. If convergence is not reached, a correction increment is computed:(24)|[MT({ui−1})]{Δui}=[MS({ui−1})]{ui−1}−{R}{ui}={ui−1}+{Δui}where{Δui}is the correction increment at iteration i,{ui}is the displacement at iteration i. This procedure is encapsulated in the block1and4of the global algorithm (see Fig. 12) used to solve the entire fluid–solid problem.In addition, the porous medium is represented by an equivalent homogeneous medium composed of rigid fibers, so that each macroscopic strain is reflected by fiber rearrangements at the microscopic scale (see Fig. 11). Therefore the porosity can be directly computed from the mechanical rate of deformations.Indeed, mass conservation of the homogeneous porous medium writes as follows:(25)DDt(m(Ω))=DDt∫Ωtρdv=0whereD/Dtis the particular derivative with respect to time and ρ is the density of the porous medium. This porous medium is actually a biphasic medium constituted of fibers and fluid. Using the mixture low and noting that there is no mass transfer between the fluid and the fibers Eq. (25) leads to(26)|DDt∫Ωtρs(1−ϕ)dv=0DDt∫Ωtρrϕdv=0with ρsbeing the fiber density, ρrthe fluid density and ϕ the porosity or fluid fraction corresponding to micro- and macro-voids in Fig. 11, i.e.,ϕ=1−Vfwith Vfbeing the fiber fraction. The first equation of system (26) is actually the mass conservation of the solid phase, i.e., the fibers. This equation will be used to update the porosity (ϕ) from the displacement field. Using a Lagrangian approach, this equation can be written in the reference configuration as follows:(27)DDt∫Ωrefρs(1−ϕ)JdVref=0where J denotes the Jacobian of the transformation between the reference configuration Ωrefand the current configuration Ωtand dVrefis the elementary volume defined on Ωref. Since, the mechanical problem is also treated with a Lagrangian approach, the reference domain is the domain of the material particles, so, the convective velocity is zero. In addition, we can note that dVrefis constant over time. So Eq. (27) becomes(28)∫Ωref∂∂t(ρs(1−ϕ)J)dVref=0Furthermore, we consider that the fibers are incompressible, so(29)∂ρs∂t=0leading to(30)∫Ωref∂∂t((1−ϕ)J)dVref=0Finally, Eq. (30) means that the product(1−ϕ)Jis constant over time, so it can be reduced to the following relation:(31)J(x̲,t+Δt)(1−ϕ(x̲,t+Δt))=J(x̲,t)(1−ϕ(x̲,t))where J is the Jacobian of the transformation,x̲the position vector and ϕ the porosity of the porous medium, i.e.,ϕ=1−Vfwith Vfbeing the fiber volume fraction. This approach proposed by Celle et al. in [2,3] and also used later in [19] does not restrict the analysis to one dimension, as it is usually the case in the literature when using semi-empirical laws expressing porosity or thickness variation as a function of pressure [14–16]. Moreover, it allows us to use any constitutive law for the porous medium (elastic or hyper-elastic and isotropic or orthotropic). This is one of the major feature of the presented global approach, opening new prospects in terms of industrial outcomes.This formulation has been validated on analytical test cases and by comparison with the commercial solver Abaqus [2,3]. In the present paper, we focus on the fluid/structure validation (see Section 5.1).The fluid/structure strong coupling is treated iteratively in a quasi-static context (see Fig. 12). Indeed, the Stokes/Darcy coupled problem (see points2and3in Fig. 12) is solved on a fixed grid (i.e. rigid porous medium), the fluid influence on the porous medium being taken into account through pore (interstitial) pressure by Terzaghi׳s law [10]:(32)σtot̲̲(ϵ̲̲)=σeff̲̲(ϵ̲̲)+SpI̲̲whereσtot̲̲is the overall stress applied to the system,σeff̲̲is the effective stress in the fibers,I̲̲is the unity tensor, p is the hydrostatic pressure and S is the saturation factor of the pore. Let us notice that the updated Lagrangian scheme adopted for the solid mechanics problem permits us to use the quasi-Eulerian stress field to compute the corresponding Terzaghi stress tensor [2,3]. The non-linear finite strain mechanical problem (see point4in Fig. 12) is then solved considering a given pore pressure (i.e. for a Terzaghi equivalent behavior) acting as an internal load. Then, the deformation is reflected by the porosity variation modifying the permeabilityK̲̲of the medium. The permeability can be computed with any porosity dependent measurement or model. Here, for the example, the Carman–Kozeny׳s law [30] can be considered:(33)K̲̲=df216h̲kϕ3(1−ϕ)2where dfis the fiber diameter,h̲kthe Kozeny constant and ϕ the porosity. Finally, convergence is verified by a relative error computation on both fluid velocity and pressure fields of fluid, and solid displacement between two iterations.Using an analytical approach based on Airy׳s functions (see Appendix A), it is possible to build a test case for Terzaghi׳s principle which has an analytical solution in the case of linear elastic preforms. The test case represents the compaction of a porous medium submitted simultaneously to an internal loading due to the pressure of the fluid present in the pores (see Fig. 22) [2,3] and an external loading acting on the upper side.We consider an isotropic material of Young׳s modulus E=266kPa and Poisson׳s ratioν=0.3. The plate is submitted to an external loadPimp=104Pa, a linear internal loadPint(y)=−5×105y+104Pa. Dimensions of the domain areH=2×10−2mandL=4×102m. The analytical solution is(34)|ux(x,y)=1+νE[(1−2ν)(ay+b)x+νGx]uy(x,y)=1+νE[(1−2ν)(a2y+b)y+(ν−1)Gy−1−2ν2ax2]whereG=aH+b+Pimp,a=−5×105andb=104.Fig. 13shows the perfect agreement between analytical and numerical results.There are several methods for tracking the flow front, such that the level-set method and the FE-CV method [31]. As part of this work, we did not study these methods but have used the filling algorithm already present in PAM-RTM™ [32,33]. This algorithm is based on a division of the transient regime in a series of quasi-static states. New elements filled between two time steps are determined from the flow rate calculated at the last known time step. A filling factor varying from 0 to 1 is associated with each element. In the case of flow in deformable porous medium, porosity changes over time. Because the time increment is determined before the calculation, it is necessary to correct it so that the total amount of resin present in the system corresponds to the volume of saturated pore. The following correction is proposed:(35)Δt=ΔtalgoVt+ΔtVtwhereΔtis the corrected time increment,Δtalgois the time increment given by the filling algorithm,Vtis the volume of resin that would have been injected in the system during the time step with no deformation andVt+Δtis the actual injected volume of resin during the time step.In order to demonstrate the ability of the approach to handle industrial cases, the complete infusion simulation of a “T” stiffened panel is presented. The geometry, proposed by Daher-Socata within the INFUCOMP project, consists of the assembly of a380×280×3mm3plate and a “T” stiffener which is made of a two 3mm thick “L” preforms as described in Fig. 14.Infusion condition is presented in Fig. 15. One distribution medium is located between the panel and the mould and a second one is placed on the top of the “T” under the vacuum bag. Resin inlet is located in the center of the plate under the mould while the vent is in the center of the second distribution medium on the top of the “T”.Preforms are made of 48,302 woven fabric from Hexcel Reinforcements constituted of T700 12k carbon fibers. Orthotropic permeability measured by Hexcel Reinforcements is(36)|Kp=9.76×10−12m2intheplaneofthefabricsKt=6.75×10−13exp(−9.8Vf)m2inthetransversedirectionwhere Vfis the fiber volume fraction. The resin used for this infusion is the RTM6, epoxy from Hexcel whose viscosity is 0.033Pas at 120°C.Due to the symmetry of the problem, we simulate only one-quarter of the geometry as described in Fig. 17(a). The mesh used is composed of 8100 tetrahedrons and 1884 nodes. The distribution medium at the bottom of the preform is represented by a pure resin flow (Stokes area) and is 1mm thick. It is considered as non-deformable. The preform is considered as an equivalent porous homogeneous medium (Darcy area), whose constitutive law has not been studied. However, for the example, we will assume that it obeys to the same behavior as fabric G1157 (UD plain) from Hexcel Reinforcement that has been extensively studied in [34–36]. The constitutive law is presented in Fig. 16. The behavior of a stack of UD, not preformed (G1157 tested by P. Wang), is much more flexible than a preform held in shape by an epoxy powder (industrial preforms), so deformations presented in the results are larger than the ones usually observed. Injection is represented by a pressure boundary condition of 1bar and the vent by a pressure boundary condition of 0bar. Finally, the other boundary conditions are impervious walls (v̲·n̲=0). The boundary conditions are summarized in Fig. 17(b) and (c).Figs. 18 and 19show the filling ratio at times t=63s, t=273s and t=550s. The results reflect a fast filling of distribution medium (1s), then a transverse infusion of the plate. When the resin starts to infuse the plate, beginning of the swelling can be identified (see Fig. 20). After about one minute, the plate is completely filled, the pressure is balanced in its extremities and the preform swells back to its initial thickness (see Fig. 19 at t=69s). Then, the resin begins to migrate in the base of the “T”, first in the transverse direction, and then, when it reaches the curvature, in the plane of the plies (see Fig. 18 at t=273s). Finally, resin finishes impregnating the upper part of the “T” and the filling ends after 550s.Fig. 20 shows the variation of the thickness during the infusion. It may be noted that the areas of the part that have been impregnated in the in-plane direction (curvature and upper part of the T) present a linear swelling along time, while the plate and the base of the T, which have been impregnated transversely, have three distinct phases. Indeed, one can observe a first phase of filling with a small swelling. Then, when resin reaches the vacuum bag (top of the plate), a sharp increase of thickness occurs. Finally, the preform continues to swell linearly during the end of the infusion.

@&#CONCLUSIONS@&#
