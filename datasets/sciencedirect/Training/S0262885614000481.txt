@&#MAIN-TITLE@&#
Data-driven hair segmentation with isomorphic manifold inference

@&#HIGHLIGHTS@&#
Similar coarse hair probability maps should correspond to similar segmentations.Data-driven Isomorphic Manifold Inference is proposed to exploit the shape priors.We integrate the inferred shape, color and texture into a unified framework.Besides hair segmentation, we also validate our IMI on horse class segmentation.Experiments on hair and horse databases show impressive performances.

@&#KEYPHRASES@&#
Hair segmentation,Data driven,Shape model,Isomorphic manifold inference,

@&#ABSTRACT@&#
Hair segmentation is challenging due to the diverse appearance, irregular region boundary and the influence of complex background. To deal with this problem, we propose a novel data-driven method, named Isomorphic Manifold Inference (IMI). The IMI method assumes the coarse probability map and the binary segmentation map as a couple of isomorphic manifolds and tries to learn hair specific priors from manually labeled training images. For an input image, firstly, the method calculates a coarse probability map. Then it exploits regression techniques to obtain the relationship between the coarse probability map of the test image and those of training images. Finally, this relationship, i.e., a coefficient set, is transferred to the binary segmentation maps and a soft segmentation of the test image will be achieved by a linear combination of those binary maps. Further, we employ this soft segmentation as a shape cue and integrate it with color and texture cues into a unified segmentation framework. A better segmentation is achieved by the Graph Cuts optimization. Extensive experiments are conducted to validate effectiveness of the IMI method, compare contributions of different cues and investigate the generalization of IMI method. The results strongly encourage our method.

@&#INTRODUCTION@&#
Hair segmentation has attracted increasing interest, since it can benefit face retrieval [1], gender classification [2], head detection [3], skin segmentation [4] and glasses trying on [5]. Besides the above applications, hair segmentation can also contribute to computer graphics and virtual reality, such as hairstyle synthesis [6] and animation [7]. Especially, hairstyle trying on (See Fig. 1) and retrieval of pedestrians with specific hair color or style in video surveillance are two interesting applications. However, hair segmentation is a very challenging problem, as shown in Fig. 2. First, hair color is very diverse and often non-uniform especially for young people, which implies building a universal prior color model is very hard. Second, texture of hair region is hard to model since the hair may be complicated with many crimps. What's more, in case of low resolution, texture feature might disappear. Third, as a kind of flexible object, the outer contour of the hair region may be very irregular. Finally, the background or the clothes might be quite similar to the hair region in color or texture, which occurs very often in video surveillance.Generally speaking, hair segmentation belongs to a special type of image segmentation, i.e., class-specific object segmentation. There have been many researchers addressing the problem [8–14], by using either supervised or unsupervised methods. In these works, class-specific shape prior has proven to be valuable for segmentation. Some of these methods [10,11,13,14] extract the specific class by using image fragments, which is suitable merely for structured objects. Veksler [15] introduces a prior specific to the “star shape” objects, which additionally requires knowing the shape center. Other representative approaches to learn object shape prior include Active Shape Model [16] and Active Appearance Model [17], which learn point distribution model of object landmarks. However, it is infeasible to define semantic landmarks for hair contour due to its irregularity and diversity.As an instance of class-specific segmentation problems, hair segmentation is first posed, to our knowledge, by Liu et al. [18]. Later Kampmann [19] adopts a skin color model and facial location features to segment a head into face, ears, neck and hair regions. Wang et al. [20] proposed an exemplar-based model, which cannot deal with multi-pose cases. Moreover, most recently proposed methods [1,4,21,22] perform hair segmentation via three steps: 1) Finding initial hair pixels (seeds) that are surely in hair regions; 2) Building image-specific hair color model and predict the probability of each pixel being hair/background; 3) Performing segmentation based on the probability. Nevertheless, the above methods often fail to work when the neighboring regions are similar to hair regions in color or texture, e.g. clothes with similar colors to hair or trees as shown in Fig. 2.To solve the problem, our idea is to explore hair-specific shape priors to reject ‘impossible’ hair shapes and false regions. The method in [5] employs active contour [23] to fit the upper hair shape model, but the landmark definitions are not so accurate and it can only get the upper hair parts. In [22] and [4], the methods are apt to apply average shape models on all images, which neglect the peculiarity of different instance shapes. Although they can reject some ‘impossible hair shapes’, it may also reject some true hair shapes occurring not frequently.In all, the study on hair segmentation is still in an exploratory stage and current methods cannot work well in complex cases. Although image-based (bottom-up) methods like Graph Cuts [24] have been employed, very few works on learning hair-specific prior, like ‘how to infer segmentation’, from a set of training samples, have been addressed.For an input image, if we firstly calculate a coarse Hair Probability Map (see Fig. 3) based on low level cues (e.g., color and location), human can easily obtain the ground truth segmentation according to their knowledge. That is because human have seen many data about what is hair like and have the prior knowledge of hair shapes. Therefore, perceptually, the segmentation can be inferred from coarse HPM by seeing many training samples. Our target is to automatically learn the segmentation priors from training images and their segmentations. Specifically, we propose the Isomorphic Manifold Inference (IMI) method to learn the prior.As shown in Fig. 3, given a training set containing head-shoulder images and ground truth, we want to infer the segmentation for a test image by implicitly or explicitly exploiting the hair-specific prior in the training set. First, for an input image and each sample in the training set, we calculate a coarse hair probability map (Coarse HPM) by exploring the information of the detected face and hair color model. Then the problem can be converted to how to infer segmentation from the Coarse HPM. Motivated by the observation that Similar Coarse HPMs correspond to similar ground truth segmentations, we formulate the Coarse HPM and Optimal HPM (i.e., ground truth segmentation) as a couple of manifolds that are isomorphic. The manifold formulation is valid because the hair contour is irregular and even unkempt, thus forms a non-linear distribution. This allows us to exploit the relationships between Coarse HPMs to infer relationships between ground truth segmentations.Specifically, the IMI method first employs some regression techniques [25] to pursue the relationship between the Coarse HPM of the test image and those of the training images. Then, it transfers this relationship, i.e., a set of coefficients, to the desirable segmentations of the test image and those of training images. Finally, a Refined HPM of test image can be obtained by linearly combining the segmentations of the training samples.Since this Refined HPM is a linear combination of ground truth segmentations, it can assure the segmentation shape is globally hair-like. Thus we say, in some sense, our IMI method is a ‘noise-filtering’ procedure and the Refined HPM can be seen as a kind of shape cue.In this paper, we further integrate the shape cue with color and texture cues into a unified framework. The final segmentation can be achieved by Graph Cuts optimization.A preliminary version of this work appeared as a conference paper in [26]. The conference paper proposed the method of Isomorphic Manifold Inference (IMI) for hair segmentation. In this journal version, differences fall in three main folds. Firstly, texton-based features are further exploited to learn the hair texture prior, which is integrated into a unified energy function together with the shape prior learnt by our IMI method and the color prior. Corresponding experiments are also added to validate the effectiveness of texture prior and compare contributions of different priors. Secondly, to validate the generalizability of the proposed approach, we further apply it to horse segmentation by evaluating on a public horse dataset. Thirdly, experimental comparisons with two recent hair-specific methods in [20,27] are added and our method shows remarkable superiority.The rest of the paper is organized as follows: Section 2 presents the IMI method and Section 3 introduces texton-based hair model and formulates shape, texture and color model into a unified segmentation framework. Then Section 5 gives extensive experiments to validate the effectiveness and the generalizability of the proposed method. Finally, Section 5 concludes the paper.

@&#CONCLUSIONS@&#
