@&#MAIN-TITLE@&#
Adaptive sliding mode control with moving sliding surface

@&#HIGHLIGHTS@&#
The paper presents an improvement of control performance of sliding mode control.The proposed method reduces duration of the undesirable approaching phase.The control parameters are tuned by fuzzy logic rules.The performance improvement was confirmed by simulation study.

@&#KEYPHRASES@&#
Sliding mode control,Fuzzy logic control,Variable structure control,

@&#ABSTRACT@&#
A continuous sliding mode control with moving sliding surface for nonlinear systems of arbitrary order is presented in this paper. The sliding surface is moved repetitively toward the target sliding surface in order to ensure that the system trajectory is close to the actual surface during the whole control process. The parameters of sliding mode control are tuned by a fuzzy logic. The proposed procedure reduces the time when the system operates in the approaching phase during which the control performance is deteriorated since the system is more susceptible to external disturbances and model uncertainties. The effectiveness of the presented approach is demonstrated on a control of a flexible robot manipulator arm.

@&#INTRODUCTION@&#
Since its introduction sliding mode control (SMC) [1] has become one of the most popular approach to control of nonlinear systems. The main reason is its high robustness and easy design and implementation that have resulted in a big number of applications (see e.g. [2–7]). The fundamental idea of SMC consists in transferring a nonlinear system to a state from which it can be easily driven to the equilibrium. All those states including the equilibrium are described by a first order linear differential equation and create a sliding surface. Hence SMC consists from two phases – first one when the system approaches the sliding surface from the initial state (approaching phase) and the second one when the system is sliding along the sliding surface to the final state (sliding phase). Unfortunately, due to the presence of model imprecision and disturbances, the control law has to be discontinuous across the sliding surface. Since the associated control switchings represented by a signum function in control law are imperfect undesirable chattering of control signal arises.Theoretical research concerning SMC has been focused mainly on overcoming two crucial shortcomings: the chattering of control action and unknown behavior during the approaching phase. The chattering of control action is usually reduced by introduction of a boundary layer where the signum function is approximated by the saturation function. Unfortunately the boundary layer deteriorates the tracking performance and the robustness against disturbances. The problem of precisely unknown dynamics and reduced robustness during the approaching phase which becomes more serious if the initial condition is far from the target sliding surface is typically eliminated by a time-varying sliding surface. One possibility is to move the sliding surface such that the current state of the system is not far from it.Shifting and rotating sliding surface for second order systems was proposed in [8] with a modification in [9] and an application on position control of a direct current (DC) motor described in [10]. The procedure was generalized for nth order systems in [11]. Unfortunately, the sliding surface may become unstable for some periods during which the performance is decreased. In [12] an optimal switching sliding surface for hard disk drives control is under investigation. A time-varying sliding surface scheduled with respect to the reference signal is proposed in [13]. Improvement of disturbance attenuation and chattering elimination under presence of actuator saturation is presented in [14,15]. In [16] dynamic sliding surface with an H∞ bound is derived. Fuzzy self-tuning mechanism for adaptation of SMC parameters reducing chattering was proposed in [17].In past few years fuzzy logic has become a commonly used approach to improve performance of SMC since it allows to adjust its parameters to get faster response with reduced chattering. Adaptive learning algorithm based on fuzzy logic estimating dynamics of multi-input multi-output plant was introduced in [18]. In [19] fuzzy SMC was applied on fast and slow dynamics of controlled plant separately. Neural fuzzy network approximating unknown nonlinear dynamics was used for complementary SMC in [20]. Adaptive PD (proportional-derivative) controller together with fuzzy logic based approximation was successfully applied in [21].Some results have been also achieved in moving the sliding surface based on fuzzy logic approach. Fuzzy rules for rotating and shifting of second order sliding surfaces are proposed in [22,23] using Mamdani type fuzzy systems and in [24] using Takagi-Sugeno fuzzy systems. The former approach is applied in decoupled moving sliding mode control in [25,26]. Again, stability of sliding surface is not guaranteed in all time instants. In [27] an extra term tuned by fuzzy logic added to the classical sliding mode control law is utilized. Takagi-Sugeno fuzzy models of nonlinear systems are applied for chattering elimination in [28,29].In this paper a switching sliding surface using rotation and shift for SMC of nonlinear systems of an arbitrary order is proposed. The method has two main advantages. First, unlike the existing results the method guarantees stability of the sliding surface at each time instant. Secondly, it enables by tuning the fuzzy sets to the user to specify both the frequency of switching and the speed the trajectory approaches the sliding surface with and thus to set a compromise between the control activity and the speed of the response.The paper is organized as follows. In Section 2 the basic principles of SMC are summed up. In Section 3 the main idea of the paper consisting in improving SMC by shifting and rotating the sliding surface and the proposed algorithm are introduced. In Section 4 the proposed method is illustrated on control of a flexible joint manipulator. The concluding remarks are summarized in Section 5.Consider a general class of single-input single-output (n+1)th order nonlinear systems in the following form:(1)x˙1=x2x˙2=x3⋮x˙n=xn+1x˙n+1=f(x,t)+g(x,t)u(t)+d(t)y=xwherex=[x1,x2,…,xn+1]T=[x,x˙,…,x(n)]T∈Rn+1is the state vector of the system which is assumed to be available for measurement, f(x, t) and g(x, t) are unknown but bounded nonlinear functions,u∈Randy∈Ris the input and output of the system, respectively, d(t) is unmeasurable bounded external disturbance. The upper bound of the disturbance d(t) is D, that is |d(t)|≤D<∞. The nonlinear system (1) is controllable and the input gain g(x, t)≠0. Without loss of generality, we assume that g(x, t)>0. The control objective is to design a control law for the state x to track a desired reference state trajectoryxd=(xd,xd˙,…,xd(n))in the presence of model uncertainties and external disturbances. The tracking error is defined as(2)e=x−xd=[e,e˙,…,e(n)]T∈Rn+1.Let us consider the sliding surface in the error state space defined as(3)s=s(k,e)=k0e0+k1e1+⋯+kn−1en−1+en=kTewherek=[k0,k1,…,kn−1,1]T∈Rn+1is the vector of the coefficients of a Hurwitz polynomial k(p)=pn+kn−1pn−1+…+k0 where p is the Laplace operator and ei=e(i), i=0, …, n. The value of s(k, e) can be seen as a distance of the current value of the tracking error to the sliding surface. If it is equal to zero the state of the system is on the sliding surface. For the zero initial condition e(0)=0, the tracking problem x=xd can be considered as keeping the error state vector on the sliding surface s=0 for all t≥0. A sufficient condition to guarantee that the trajectory of the error vector e will approach to the sliding surface in finite time is to choose the control strategy such that(4)12ddt(s2)≤−η|s|,η>0.The system is controlled in such a way that it always moves toward the sliding surface and hits it. The sliding process includes two phases: the first one is the approaching phase (s≠0) and the second one is the sliding phase (s=0). The sliding mode control guarantees the convergence of the nominal system to the equilibrium point, i.e. e(t)→0 as t→∞.Consider the control problem of the nonlinear system (1). If f(x, t) and g(x, t) are known, the following SMC control law u* satisfies the sliding condition (4):(5)u*=1g(x,t)−∑i=0nkie(i)−f(x,t)+xd(n+1)−Ksgn(s)where K>D+η and sgn denotes the signum function. Introducing a boundary layer the signum function sgn(s) is approximated by the saturation function sat(s/ϕ) where ϕ>0 is the thickness of the boundary layer andsat(s)=s,|s|≤1,sgn(s),|s|>1.As it was said before, during the approaching phase the advantages of sliding mode control are deteriorated – the closed-loop dynamics depends on how precisely we are able to identify the model of the nonlinear system and the robustness against the disturbances is decreased as well. Let us try to decrease those effects by shifting and rotating the sliding surface in time under the condition that at each time the sliding surface remains stable. The flow chart of the whole procedure is depicted in Fig. 1.Suppose that the target sliding surface is specified,(6)s=s(c,e)=c0e0+c1e1+⋯+cn−1en−1+en=cTewherec=[c0,c1,…,cn−1,1]T∈Rn+1corresponds to a Hurwitz polynomial c(p)=pn+cn−1pn−1+⋯+c0. The initializing sliding surfacek¯j=[k¯0j,k¯1j,…,k¯n−1j,1]T∈Rn+1in step j is chosen as the one passing through the current error state vector e(tj)=[e0(tj), e1(tj), …, en(tj)]T and being the closest one to the target surface c in terms of the distance in the n-th dimensional Euclidean space, i.e.(7)k¯j=mink∈Rn∥k−c∥s.t.∑i=0n−1k¯ijei(tj)=−en(tj).The norm ∥·∥ is represented by the standard Euclidean norm defined as(8)∥k∥=∑i=0n−1ki21/2.The problem (7) represents a simple optimization problem whose solution is given in [11],(9)k¯j=c−en(tj)+∑i=0n−1(ciei(tj))∥e(tj)∥2e(tj).If the associated polynomial(10)k¯j(p)=pn+k¯n−1jpn−1+⋯+k¯0jis Hurwitz stable the procedure will continue by testing if rotating the surface corresponding tok¯jtoward the target surface (6) is feasible (see Section 3.2). If the polynomial (10) is not Hurwitz the surface in the step j is determined by shifting the target surface (see Section 3.4).The sliding surface will be rotated or shifted just when it will be reached by the error state vector and remains unchanged until it is reached again, i.e. if the time instants of reaching the subsequent sliding surfaces are denoted as tjand tj+1,s(kj,e(tj))=0,s(kj+1,e(tj+1))=0,the sliding surface for tj<t≤tj+1 stays on s(kj+1, e(t)).If the sliding surface (9) is stable we try to design a strategy how to rotate it toward the target surface (6). In [11] the design was conditioned by stability of the interval polynomial bounded by the coefficients of the initial and target surfaces, i.e. the set of polynomials(11)A(p)=pn+an−1pn−1+⋯+a0,ai∈[min{k¯ij,ci},max{k¯ij,ci}],using Kharitonov test. The fundamental disadvantage of the design is that the condition of stability of the whole set (11) is too conservative, especially for higher order systems and in the case when the vectorsk¯jand c are far each from the other, i.e. when the initial condition is far from the target sliding surface.The strategy for rotating the sliding surface proposed in this paper is based on the line segment connecting the surfaces (9) and (6), i.e. the candidates for the coefficients of the rotated sliding surfaces will be chosen from the set(12)Kj=[k¯j,c]=λk¯j+(1−λ)c,λ∈[0,1].To guarantee stability of all rotated sliding surfaces we have to test stability of the set of polynomials(13)Kj(p)=[k¯j(p),c(p)]=λk¯j(p)+(1−λ)c(p),λ∈[0,1].Let us use the frequency properties of the polynomialsk¯j(p)and c(p) and writek¯j(jω)=k¯evenj(ω)+jωk¯oddj(ω)c(jω)=ceven(ω)+jωcodd(ω),ω≥0.Segment lemma[30]. The set of polynomials (13) is Hurwitz stable if and only if there exists no real ω>0 such that1.k¯evenj(ω)codd(ω)−k¯oddj(ω)ceven(ω)=0,2.k¯evenj(ω)ceven(ω)≤0,3.k¯oddj(ω)codd(ω)≤0.If the line segment (13) is stable the sliding surface will be rotated until it reaches the boundary layer of the target surface using the procedure described in Section 3.3. If the line segment is not stable the surface in the step l+1 is determined by shifting the target surface (see Section 3.4).Suppose that in the lth iteration the algorithm described in Section 3.1 computed the sliding surfacek¯lsuch that the line segment[k¯l(p),c(p)]is stable and that the trajectory of the system in the error stare space reaches the corresponding sliding surface in the point e(tl) at the time tl, i.e.s(k¯l,e(tl))=0.The sliding surface in the (l+m)th step is designed such that(14)|s(kl+m,e(tl+m−1))|=δr,m=1,2,…where δr is the design parameter and such thatkl+m∈[k¯l,c],m=1,2,…in order to guarantee stability of the corresponding sliding surface.Writekl+m=λmk¯l+(1−λm)c,λm∈[0,1]and substituting into (14) gives(15)|en(tl+m−1)+∑i=0n−1(λmk¯il+(1−λm)ci)ei|=δrfrom which λmcan be easily determined.To avoid chattering the rotation is stopped when the error vector e reaches the boundary layer, i.e. when s(c, e(t))≤ϕ where ϕ is the thickness of the boundary layer. Afterwards control continues in the sliding phase.Alternatively, the designer may specify the maximum number of rotations (nr) and just takeλm=mnr,m=1,…,nr.In order to guarantee sufficiently short time between reaching subsequent sliding surfaces to improve the performance by shortening the approaching phase we propose a Mamdani type fuzzy system for tuning the gain K in (5). Since to achieve a shorter interval Δτ=tl+m−tl+m−1 a higher gain K and higher number of rotations are needed the parameters nr and Δτ were chosen as the inputs to the proposed fuzzy system. The gains gr, gτand gK are used to normalize the variables and to tune the response of the system:n¯r=gr·nr,Δτ¯=gτ·Δτ,K=gK·K¯.The membership functions for the inputsn¯randΔτ¯are depicted in Fig. 2a (S – small, M – medium, B – big), the output membership functions corresponding toK¯are shown in Fig. 2b (VS – very small, S – small, M – medium, B – big, VB – very big). The rules are summarized in Table 1. Product inference engine and center of gravity defuzzification were used for the implementation of the fuzzy system.If the line segment (13) is not stable and thus the rotated sliding surface may become unstable the subsequent sliding surface will be obtained by shifting the target surface. The shifted surface remains parallel to the target surface:(16)s(c,e,kshift)=en+∑i=0n−1ciei+kshiftwhere kshift is to be determined. Even though shifting guarantees stability of the sliding surface it is not preferred because in sliding phase the trajectory does not converge to the origin.Suppose that the current error vector e(t)=e(tl). The shifted sliding surface will be determined such that(17)|s(c,e(tl),kshiftl+1)|=δswhere δs is the design parameter. Substituting (16) into (17) the shiftkshiftl+1for the sliding surface in step l+1 can be computed as(18)kshiftl+1=δs−en(tl)−∑i=0n−1ciei(tl),ifs(c,e(tl))>0,−δs−en(tl)−∑i=0n−1ciei(tl),ifs(c,e(tl))<0.Similarly to rotating the sliding surface a fuzzy logic tuning the gain K is used to guarantee sufficiently short time Δτ=tl+m−tl+m−1. The membership functions for the normalized inputsδs¯,δs¯=gs·δs, andΔτ¯and the normalized outputK¯are depicted in Fig. 2, the rule base is shown in Table 2. As in the previous case, product inference engine and center of gravity defuzzification were used for the implementation of the fuzzy system.As in the case of rotation shifting is stopped when the error vector e reaches the boundary layer, i.e. when s(c, e(t))≤ϕ.The nonlinear dynamic equations for a single-link manipulator with flexible joints (Fig. 3), damping ignored, are given by [31](19)Iq¨1+MgLsin(q1)+k(q1−q2)=0Jq¨2−k(q1−q2)=uwhere q1 and q2 are angular positions (q1 is the output of the system), I and J are moments of inertia, k is the spring constant, M is the total mass, L is a distance and u is the torque input. As the state space variables x1=q1,x2=q˙1, x3=q2,x4=q˙2are chosen.The Eq. (19) can be transformed to the standard form:(20)z˙1=z2z˙2=z3z˙3=z4z˙4=−MgLIcosz1+kI+kJz3+MgLIz32−kJsinz1+kIJuwhere z1=x1, z2=x2,z3=−MgLIsinx1−kI(x1−x3),z4=−MgLIx2cosx1−kI(x2−x4); x1=q1,x2=q˙1, x3=q2,x4=q˙2, y=x1.The numerical values are: k=31 [Nm/rad]; I=0.031 [kgm2]; J=0.004 [kgm2]; g=9.81 [m/s2]; M=0.4 [kg]; L=0.2 [m].Comparison of the proposed method with δs=0.1, nr=10, Δτ=0.1, gr=0.08, gs=9, gτ=10, gK=2·105 and original sliding mode control with boundary layer on tracking the reference xd(t)=sin(2.5t) with the initial condition [z1(0), z2(0), z3(0), z4(0)]=[0.5, 1, 2, 0.3] is depicted in Figs. 4 and 5. In upper part of Fig. 4 the reference signal and the output of both methods are shown, in the lower part the tracking errors for both methods are depicted. In upper part of Fig. 5 control signal for both methods is compared whereas in the lower part the current value of target sliding surface is shown for both methods. Let us remind that that value is equivalent to the distance of the tracking error to the target sliding surface. One can see that the convergence of the proposed solution is better, the error signal reaches zero value in a shorter time than in the standard solution with fixed sliding surface.In the next simulation a disturbance signal d(t)=0.2sin(1.5t) is considered while tracking the reference xd(t)=sin(2.5t)+cos(7t) (see Figs. 6 and 7, the meaning of the figures is the same as in previous case). From those figures we can deduct that in the presence of disturbance the benefit of the proposed method is even more significant, both important quantities s(c and e) are approaching the zero values much faster in the case of moving sliding surface. In both cases the target surface polynomial c(p) was chosen as (p+0.5)3.

@&#CONCLUSIONS@&#
