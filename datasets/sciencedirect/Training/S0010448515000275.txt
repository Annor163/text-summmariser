@&#MAIN-TITLE@&#
Canal surfaces with rational contour curves and blends bypassing the obstacles

@&#HIGHLIGHTS@&#
The rationality of generalized contours on rational canal surfaces is studied.The contour method is used for computing PN blends between two canal surfaces.The constructed blends can easily satisfy certain constrains, e.g. avoiding obstacles.Only one SOS decomposition for all canal surfaces with the same silhouette is needed.

@&#KEYPHRASES@&#
Canal surfaces,Rational parameterizations,Contour curves,Blends,Polynomial SOS,Bypassing obstacles,

@&#ABSTRACT@&#
In this paper, we will present an algebraic condition, see (20), which guarantees that a canal surface, given by its rational medial axis transform (MAT), possesses rational generalized contours (i.e., contour curves with respect to a given viewpoint). The remaining computational problem of this approach is how to find the right viewpoint. The canal surfaces fulfilling this distinguished property are suitable for being taken as modeling primitives when some rational approximations of canal surfaces are required. Mainly, we will focus on the low-degree cases such as quadratic and cubic MATs that are especially useful for applications. To document a practical usefulness of the presented approach, we designed and implemented two simple algorithms for computing rational offset blends between two canal surfaces based on the contour method which do not need any further advanced formalism (as e.g. interpolations with MPH curves). A main advantage of the designed blending technique is its simplicity and also an adaptivity to choose a suitable blend satisfying certain constrains (avoiding obstacles, bypassing other objects, etc.). Compared to other similar methods, our approach requires only one SOS decomposition for the whole family of rational canal surfaces sharing the same silhouette, which significantly simplifies the computational complexity.

@&#INTRODUCTION@&#
Silhouette curves are planar curves enclosing the projection of a spatial object into plane. They not only help to create a first visual perception of the shape of the studied object but they have also many practical applications—for instance, in reconstruction of the 3D object from a 2D image, in rendering, in computing the visible area, when deleting invisible curves. There exist two types of silhouettes—parallel (corresponding to the viewpoints at the infinity) and perspective (corresponding to the real viewpoints at a finite distance). The preimages of the silhouette curves on the studied 3D object are called contour curves. We recall that in some papers the notion silhouette curves is used simultaneously also for the contour curves — however, we will strictly distinguish it in what follows. More details about silhouettes/contours and their computation and related topics can be found e.g. in  [1–4].Silhouette and contour curves are very complex even for simple surfaces and in most cases it is difficult to represent them accurately (and finding their NURBS representation, if it exists, is even more complicated). In this paper, we will focus only on one of the most important classes of technical surfaces, namely on the rational canal surfaces, whose silhouettes were already studied e.g. in  [5–7]. We will investigate the contour curves (solely with respect to the parallel projection) from the point of view of their rationality. In addition, we will show that they are very useful e.g. for the construction of adaptive blending surfaces between two canal surfaces satisfying some given constraints (for instance avoiding obstacles). This approach is based on the construction of a single rational silhouette curve which is common for a whole family of different rational canal surfaces and then choosing a suitable surface with prescribed properties with help of a certain distance function.Let us recall that the canal surfaces, see e.g.  [8], are defined as envelopes of one parameter families of spheres in 3-space. Nowadays they are very popular in Computer-Aided Design as they can be used for constructing simple blends between two given surfaces, see  [9] and references therein for a detailed overview of blending techniques. Among others, all surfaces of revolution belong to canal surfaces. For a constant radius of moving spheres we speak about pipe surfaces. A special (and probably the most investigated) subfamily of the canal surfaces are Dupin cyclides which can be defined as the envelopes of all spheres touching three given spheres, see e.g.  [10–13].It was proved in  [14] that any canal surface with a rational spine curve (a set of all centers of moving generating spheres) and a rational radius function has a rational parameterization. This result followed an equivalent result from  [15] for pipe surfaces. A technique for computing rational parameterizations of canal surfaces was presented in  [16]. Minimal rational parameterizations of canal surfaces were thoroughly studied in  [17]. Let us emphasize that although the canal surfaces with rational spine curves and rational radii always possess exact rational parameterizations, approximate parameterization techniques are also investigated in connection with them, see e.g.  [18]. This is caused by the computational difficulty of decomposing a rational function into a sum of two squares (SOS) over reals, which is a necessary part of the parameterization algorithm from  [16] (and we will see that the SOS decomposition will occur also in the approach presented in this paper when exact rational parameterizations are required).Recently a ‘contour method’ for parameterizing (some classes of) canal surfaces has been introduced in  [18,19]. This approach is based on the main idea that if the parameterizations of the spine curve and one curve on the canal surface (different from the characteristic circles) are known and they are corresponding in parameter we can easily find a rational parameterization of the canal surface by rotating the points of the given curve along the tangents of the spine curve. In  [19], a condition guaranteeing the rationality of the special curves on canal surfaces called contour curves, which were then used for a computation of parameterizations of canal surfaces, was investigated. The presented approach extended the results about rational spatial Minkowski Pythagorean hodograph curves and the associated planar (Euclidean) Pythagorean hodograph curves from  [20] and related them with the contour curves of canal surfaces given by their medial axis transforms.In this paper we will follow the approach from the aforementioned papers and extend the notion of ‘contour curves’ (originally related to the coordinate planes and coordinate axis directions only) to general planes and general directions, too. This allows us to apply the contour method to a broader class of canal surfaces and hence a main drawback of the original method (dependence on the choice of a suitable coordinate system) is eliminated. We will formulate a condition on the medial axis transform of the canal surface which guarantees the rationality of the contour curves with respect to a given general direction (viewpoint at infinity), and thus also the rationality (and the rational offsets property) of the obtained canal surface parameterizations. In addition, we will mention the existence of real contour curves which, of course, do not have to exist for a chosen direction and a chosen part of the given canal surface, in general.The remainder of this paper is organized as follows. Section  2 summarizes some fundamental facts concerning the canal surfaces, contour curves and SOS decomposition problem. As a motivation, in Section  3 we recall several results about contour curves on implicitly given canal surfaces. In Section  4, general contour curves are introduced and the condition which must be satisfied by the MAT and that guarantees the rationality of the contour curves is derived and discussed. The main part of the paper is devoted to the low-degree cases such as quadratic and cubic MATs that are especially useful for practical applications. In Section  5, the polynomial quadratic and cubic medial axis transforms are thoroughly studied from the point of view of the rationality of the associated contour curves. We will show how to find a suitable viewpoint which guarantees the rationality of the contour curves on this type of canal surfaces (i.e., with quadratic or cubic MATs). Special investigations will be devoted to pipe surfaces with low-degree MATs. In Section  6 we will focus on the operation of blending with rational contours. A simple direct method (which does not require in most cases another advanced modeling technique as e.g. modeling with MPH curves) for computing rational offset blends between two canal surfaces based on the contour method will be formulated. A main advantage of the designed blending technique is its simplicity and especially its usefulness for constructing blends satisfying certain constrains, e.g. when avoiding obstacles or bypassing other objects is required. Compared to other methods our approach needs only one SOS decomposition for the whole family of rational canal surfaces sharing the same silhouette, see  Fig. 1. The designed algorithms are presented in several examples. In Section  7, we conclude the paper.We start with short recalling some fundamental properties of canal surfaces which will be used in the following sections. We also mention the problem of sum of squares decomposition of non-negative polynomials over reals playing an important role in our method.A canal surfaceSis the envelope of a 1-parameter family of spheresFwhose centers trace a curveminR3and possess radiir, i.e.,(1)F(t):‖x−m(t)‖2−r(t)2=0,t∈I,wherex=(x,y,z)⊤. The curvemis called the spine curve andrthe radius function ofS. For constantrwe obtain a pipe surface. The defining equations for the canal surfaceSare(2)F(t)=0,F′(t)=0,whereF′is the derivative ofFwith respect tot. When we eliminate the parametertfrom (2) one can get the corresponding implicit equationf(x)=0ofS. The linear equationF′=0describes the plane with the normal vectorm′, i.e., perpendicular to the spine curvem. Thus the canal surfaceScontains a one parameter set of the so called characteristic circlesF∩F′and canal surfaces belong to the so called ringed surfaces. It can be proved that the envelope (i.e., the canal surface) is real iff the condition(3)‖m′(t)‖2−r′2(t)≥0is fulfilled for allt∈I.By appending the corresponding sphere radiirto the points of the spine curve (or the skeleton, or the medial axis) we obtain the medial axis transform MAT, i.e., the curvem¯. For the sake of clarity, we identify the canal surfaceS⊂R3with its medial axis transformm¯=(m,r)⊤⊂R3,1, see  [14,21], whereR3,1is the 4-dimensional Minkowski space serving as the natural ambient space for MATs of canal surfaces, cf. (1). We recall that the squared norm of a vectoru∈R3,1with respect to the indefinite Minkowski inner product〈u,v〉=u⊤Jv, given byJ=diag(1,1,1,−1), can be positive, negative or zero. Hence, we distinguish three types of vectors: a vectoruis called space-like if〈u,u〉>0, time-like if〈u,u〉<0, and light-like (or isotropic) if〈u,u〉=0. Considering their tangent vectors we analogously speak about space-, light-, or time-like curves. So condition (3) expresses that the medial axis transformm¯⊂R3,1is not a time-like curve.For computing a parameterization of the canal surfaceSwe apply the method used e.g. in  [18,19] based on rotating the points of a curveconS(different from the characteristic circles) around the tangents of the spine curvem, i.e., we arrive at(4)s(t,u)=m(t)+(ϱ(u),m′(t))⋆(0,c(t)−m(t))⋆(ϱ(u),−m′(t))(ϱ(u),m′(t))⋆(ϱ(u),−m′(t)),whereϱ(u)is a rational function and⋆is the operation of quaternion multiplication(5)(a,a)⋆(b,b)=(ab−a⊤⋅b,ab+ba+a×b),see  [22,23] for more details about quaternions. Any rational choice ofϱgives a rational parameterization of a canal surface—for the sake of simplicity we chooseϱ=ufor the low rational degree ofsinu, andϱ=2u/(1−u2)for a relatively uniform distribution of thet-parameter lines.Let us emphasize that when using the spine curvemand another curveconSfor the computation of the rational parameterization ofSwe have to have guaranteed that their parameterizations correspond in parameter, i.e., it must hold(6)c′(t)⊤⋅(c(t)−m(t))=0,for allt∈I.In other words, it has to be ensured that the pointc(t)lies at the characteristic circle ofScorresponding to the sphere centered atm(t)and with the radiusr(t), for allt∈I.In  [18,19], we introduced the so-calledz-contour curveCzof a given canal surfaceSas a curve consisting of all the points at which the normals ofSare orthogonal to thez-axis (equivalently to the vectork=(0,0,1)⊤) and used this curve for computing the parameterization ofS. It was shown that the parameterizations of the two branches of thez-contour curve possess the form(7)ck±=m−r‖m▿′‖2(r′m▿′±‖m▿′‖2−r′2m▿′⊥),wherem=(m1,m2,m3)⊤,m▿′=(m1′,m2′,0)⊤andm▿′⊥=(−m2′,m1′,0)⊤.Sum of squares (SOS) problem is closely connected with solving polynomial equations, for more details see e.g.  [24,25]. A polynomialτ(t)over reals is said to be positive semidefinite (PSD), or positive definite (PD) ifτ(t)≥0, orτ(t)>0for allt∈R. We say thatτis a sum of squares if the degree ofτis even and it can be written as a sum of squares of other polynomials. It is obvious that SOS decomposition ofτimplies its nonnegativity. However, the converse is not true in general—the construction of PSD polynomials which are not sums of squares was first described by Hilbert in 1888.For the sake of brevity, we recall only elementary notions dealing with the univariate polynomials where the situation becomes much easier than in the general case. It can be shown that every PSD univariate polynomial is a sum of just two squares. In this section we show how the decomposition of a polynomialτ∈R[t]can be computed, i.e., we want to find two polynomialsf,g∈R[t]such that(8)τ=f2+g2.Let us recall that a real polynomial in one variable is PSD iff its leading coefficient is positive and its roots are either complex in conjugate pairs or real with even multiplicity. Of course, the SOS decomposition (8) is by no mean unique; for an arbitraryφthe polynomials(9)fφ=cosφg−sinφfandgφ=cosφf+sinφgsolve the problem as well, i.e., formula (9) generates an equivalence class of decompositions. For a polynomialτof degree2n, there exist2n−1non-equivalent classes of decompositions, see  [16]. Hence in order to obtain all possible decompositions we have to compute2n−1particular non-equivalent decompositions and use formula (9) to generate all of them.Of course, it is not easy to get the initial decomposition(f,g), because we are not able to compute the exact roots, in general. And another limitation appears when we want to work only with polynomials with rational coefficients, when the SOS decomposition may include more than two squares. Nonetheless, in this paper we are going to decompose quadratic and quartic polynomials, only, and thus the computation of a SOS decomposition can be achieved symbolically. In particular we can obtain a decomposition (8) with the help of the roots ofτwhich can be computed using the discriminant for quadraticτand so called Ferrari’s formulas for quarticτ.Example 2.1Ifτis a quadratic PSD polynomial, we can write its factorization as follows(10)τ(t)=λ(t−α−βi)(t−α+βi),whereα,β∈Randλ∈R+. Then there exists only one equivalence class of the decomposition generated e.g. by(11)f(t)=λ(t−α),g(t)=λβ.Example 2.2For a quartic PSD polynomial(12)τ(t)=λ(t−α−βi)(t−α+βi)(t−γ−δi)(t−γ+δi),whereα,β,γ,δ∈Randλ∈R+we use Fibonacci’s identities(13)(a2+b2)(c2+d2)=(ac±bd)2+(ad∓bc)2and obtain two non-equivalent decompositions in the form(14)f1,2(t)=λ(δ(t−α)±β(t−γ));g1,2(t)=λ((t−α)(t−γ)∓βδ).We recall that in  [18,26] a method for computing approximate parameterizations of implicitly given canal surfaces based on approximating their classical contour curves by polynomial cubics was introduced. The algorithm starts with computing approximate parameterizations of the both branches of thez-contour curve of the given canal surfaceS. From these parameterizations an approximation of the spine curve ofSis reconstructed and then an approximate parameterization ofSis computed.A drawback of this method lies in the fact that it produces parameterizations with the high rational bidegree. This is caused by the quality of the reconstructed spine curve which is rational of degree seven. Hence the improvement of the method producing the polynomial cubic spine curve, which leads to the canal surface having the rational degree(7,4)in the first parameter and(2,2)in the second parameter, is presented in  [26]. The main idea of the method is based on computing the parameterizationscx=(cx1,cx2,cx3)⊤,cy=(cy1,cy2,cy3)⊤andcz=(cz1,cz2,cz3)⊤(corresponding in parameter) of the contour curvesCx,CyandCz, respectively. Then the parametric description of the spine curve is easily derived in the form(15)m=(cx1,cy2,cz3)⊤.Of course, both methods are not independent of the coordinate system.Unfortunately, when a canal surface is in a special position the methods from  [18,26] may lead to some difficulties (see Example 3.1). These problems can be easily avoided considering the contour curves w.r.t. a general viewpoint. When a canal surface is given by its implicit equationf(x)=0then the contour curve w.r.t. the parallel projection given by the vectorvis determined as the complete intersection of two algebraic surfaces defined by the polynomials(16)f(x)and∇f(x)⋅v,where∇fstands for the gradient off.Analogously to  [18], now we consider three contour curves w.r.t. three arbitrary linearly independent directions and using them we reconstruct the spine curve. More precisely, we compute the parameterizationscv1,cv2andcv3(corresponding in parameter) of three different contour curves onSw.r.t. the vectorsv1,v2andv3, respectively. Then the spine curve possesses the parameterizationm=(v1v2v3)−1⋅(v1⋅cv1v2⋅cv2v3⋅cv3).Example 3.1Let us consider the canal surfaceSimplicitly given by the polynomialf=2304x6+6912x4y2+768x4z2+4608x4z−1296x4+6912x2y4+1536x2y2z2−4608x2y2z+2592x2y2−1280x2z4+3072x2z3+1632x2z2−1440x2z+216x2+2304y6+768y4z2−9216y4z−1296y4−1280y2z4−8704y2z3+4512y2z2+288y2z−216y2+256z6−1536z5+2672z4−1056z3−24z2+72z−9.We want to compute an approximate parameterization ofS(of a low degree) in some prescribed bounding boxB. The method based on the classical contour curves cannot be applied as thez-contour curveCzlying inBis closed and thus cannot be used for parameterizing the whole part ofS, see Fig. 2(top). An easy way to overcome this problem is considering other three viewpoints, see Fig. 2 (bottom).Hence, the aforementioned considerations and Example 3.1 lead us to the motivation to study the silhouettes and the contour curves w.r.t. a general viewpoint in more detail and also for the canal surfaces given by their medial axis transforms.In this section we will introduce the general contour curves with respect to an arbitrary directionv. Then we will investigate the conditions guaranteeing their rationality and show how they can be efficiently used for computing rational parameterizations of (some special) canal surfaces.Definition 4.1A general contour curveCvw.r.t. the vectorvof the canal surfaceSis a curve onSdifferent from its characteristic circles and consisting of all the points at which the normals ofSare orthogonal tov.A general contour curveCvw.r.t. the vectorvcorresponds to the silhouette of the given canal surface when projecting it to the plane with the normal vectorv, see Fig. 3. Without loss of generality, we may assume in what follows thatvis a unit vector. When a canal surface is given by its implicit equationf(x)=0then the general contour curve w.r.t. the vectorvis determined as the complete intersection of two algebraic surfaces defined by (16).For computing parameterizationscv±of the both branches of the general contour curveCvon the canal surface given by its MAT, we orthogonally project the spine curvemto a planeνvgoing through the origin and having the normal vectorv. Then we compute the parameterization of the projection of the contour curve and lift it back.The orthogonal projectionπv:R3→νvis realized as follows:(17)πv(m)=m−(m⊤⋅v)v.According to (7) the general contour curve w.r.t. the vectorvcan possess the following parameterization(18)cv±=m−rr′πv(m)′±(πv(m)′×v)‖πv(m)′‖2−r′2‖πv(m)′‖2.After some simplifications we obtain(19)cv±=m−rr′m′−(m′⊤⋅v)v‖m′‖2−(m′⊤⋅v)2±r(m′×v)‖m′‖2−(m′⊤⋅v)2−r′2‖m′‖2−(m′⊤⋅v)2.Proposition 4.2The general contour curve   (19)   of the canal surface defined by the medial axis transformm¯=(m,r)⊤is rational iff there exists a rational functionσsuch, that(20)‖m′‖2−(m′⊤⋅v)2−r′2=σ2.Moreover, since the unit normal vectors of the given canal surface alongcv±are of the form(21)nv±=cv±−m‖cv±−m‖=−r′m′−(m′⊤⋅v)v‖m′‖2−(m′⊤⋅v)2±(m′×v)‖m′‖2−(m′⊤⋅v)2−r′2‖m′‖2−(m′⊤⋅v)2the parameterization of the canal surface yields the associated Pythagorean normals (i.e., it is a PN parameterization guaranteeing rational offsets,  [27]); see the following propositionProposition 4.3The parameterizationss±of the canal surface defined bym¯=(m,r)⊤computed by rotating the points of the contour curvecv±around the tangents ofmis PN iff there exists a rational functionσsuch, that condition   (20)   is satisfied.Using explicit formula (21) for the unit normal vectors of the given canal surface alongcv±we can immediately write down a parameterization of the given canal surface derived from quaternion formula (4) in the form(22)s±=m+rϱ2nv±+2ϱ(m′×nv±)‖m′‖2+ϱ2+m′×(m′×nv±)−r′m′‖m′‖2+ϱ2.Remark 4.4The curves inR3,1satisfying condition (20) are actually the Pythagorean hodograph (PH) curves, see  [28], in 4-dimensional space w.r.t. the inner product defined by the matrix(23)A=(I−v⋅v⊤oo⊤−1),whereo=(0,0,0)⊤. Thus we can write(24)m¯′⊤⋅A⋅m¯′=‖m′‖2−(m′⊤⋅v)2−r′2.Remark 4.5Forz-contour curves, i.e., for the contour curves w.r.t. the vectork=(0,0,1)⊤, condition (20) degenerates to the following simple one, which was presented in  [19].(25)m1′2+m2′2−r′2=σ2.Example 4.6We recall the approach from  [19] wherez-contour curves were studied and used for parameterizing (special types of) canal surfaces. If we apply the method from this paper to the canal surface given by the following quintic MAT(26)m(t)=(1225(−24t5+65t3+15t2−150t),1225(−57t5−80t3−105t2−75t),190(6t5+10t3−15t2+60t))⊤and(27)r(t)=130(−6t5+10t3+15t2)we arrive at the conclusion that the classical contour curves (i.e., the contour curves w.r.t. the axis directions) are not rational since(28)mi′2+mj′2−r′2≠σ2for anyi,j∈{1,2,3},i≠j. However, using the unit vectorv=(−2/3,−1/3,2/3)⊤we get(29)‖m′‖2−(m′⊤⋅v)2−r′2=(2t3+t2)2,and hence the associated general contour curve w.r.t. the vectorvis rational and can be immediately used for computing a rational parameterization of the given canal surface.Although the main role in this paper plays canal surfaces with polynomial MATs the following example shows that the theory holds for the canal surfaces with rational MATs, in general.Example 4.7Let us consider the canal surface given by the rational quadratic MAT(30)m=(t2−tt2+1,2tt2+1,t2+2tt2+1)⊤,r=t2t2+1.Then for the vectorv=(−1/3,2/3,2/3)⊤we obtain(31)‖m′‖2−(m′⊤⋅v)2−r′2=[42t(3t2+1)2]2.Hence, the contour curve w.r.t.vis rational, i.e.,(32)cv±=(−42t2+7t2∓17t17(t2+1),2(32t2+t2∓17t)17(t2+1),2(22t2+5t2±17t)17(t2+1))⊤,and an exact rational parameterization of the corresponding canal surface can be obtained symbolically just by substituting to (4).In this section, we will investigate the existence of rational general contour curves over reals for canal surfaces defined by the polynomial MATs. Let the spine curvem∈R3[t]and the radius functionr∈R[t]be given. Then the problem is to find a unit vectorv∈S2and a polynomialσ∈R[t]such that Eq. (20) is fulfilled. After denotingτ=‖m′‖2−r′2we have(33)τ=(m′⊤⋅v)2+σ2.As the first consequence we see a necessary condition on(m,r)⊤—namely the polynomialτmust be PSD. So our goal is to find an SOS decomposition ofτ=fφ2+gφ2(cf. (9)) and a unit vectorvsuch that(34)m′⊤⋅v=gφ,which impliesσ=fφand therefore the associated contour curve is rational. We will writep=[p0,…,pn]⊤for the coordinate vector of a polynomialp=∑i=0npiti. With this notation, (34) can be rewritten as(35)M⋅v=cosφf+sinφg,whereMis the matrix with the columns being the coordinate vectors ofm′andfandgare the coordinate vectors of the polynomials from some particular SOS decomposition ofτ. This is a matrix withdegm′+1=degmrows and 3 columns. Thus together with the parameterφand the conditionv⊤⋅v=1we obtaindegm+1equations with 4 unknowns. From this, we can see that no solution can be generally expected fordegm>3. In what follows the analysis of the low degree cases will be provided.The canal surfaces with linear MATs are rotational surfaces, namely cylinders and cones. They contain rational contour curves w.r.t. all unit vectors (except the vector parallel to the axis of the cylinder or the cone) and the branches of these contour curves are straight lines.The canal surfaces with quadratic and cubic MATs are more interesting, cf. Sections  5.1 and 5.2.Firstly, we recall that the canal surfaces defined by quadratic MATs (i.e., their rational parameterizations of minimal degree, Bézier representations and implicit equations) were thoroughly studied in  [29]. In this section we will focus only on properties dealing with the rationality of their general contour curves.Since all quadratic polynomial curves are parabolas and the rationality of the contour curve does not obviously depend on isometries, scaling and reparameterizations, we may assume w.l.o.g. that a real quadratic MAT is in the following canonical form(36)m¯(t)=(t22,at,0,b2t2+ct+d)⊤,wherea,b,c,d∈Randa≠0(otherwise the spine curve is not a parabola). All the solutions of (35) are then given by(37)v(φ,ψ)=(f2cosφ+g2sinφ,f1cosφ+g1sinφa,ψ)⊤,wheref=(f1,f2)⊤,g=(g1,g2)⊤are the associated coordinate vectors of the decomposition ofτandφ∈[0,2π),ψ∈R. In order to find rational contour curves we need to identify all unit vectors in (37). Geometrically it is equivalent to find the intersection of the elliptic cylinder (37) with the unit spherev⊤⋅v=1. We will show that the intersection consists of two great circles, i.e., the ellipse(38)e(φ)=(f2cosφ+g2sinφ,f1cosφ+g1sinφa)⊤has to have the unit semi-major axis. Implicitizing ellipse (38) and substituting the following decomposition ofτ(39)f=1−b2(t−bc1−b2),g=a2(1−b2)−c21−b2,yields(40)(c2−a2)x2−2abcxy+a2(b2−1)y2−a2(b2−1)−c2=0and the associated canonical form of (40) is(41)λ1x2−a00+λ2y2−a00=1,whereλ1,λ2are the eigenvalues of the matrix of the quadratic terms(42)(c2−a2−abc−abca2(b2−1))anda00=−a2(b2−1)−c2is the absolute term in Eq. (40). Hence, we arrive at the following canonical form of the ellipse (40)(43)x21+y21−b2−c2a2=1and we can immediately formulate:Theorem 5.1For any canal surfaceSwith a quadratic MAT satisfyingτ=‖m′‖2−r′2≥0, there exist two  1-parameter families of vectorsv, corresponding to two great circles on the unit sphere, which yield rational contour curvesCvonS.Forb=c=0the canal surface becomes a pipe. In this case two great circles are coincident and all the solutions lie in the plane parallel to the plane of parabola.Proposition 5.2For any pipe surfaceSwith a quadratic spine curvemand radiusr, there exists exactly one rational contour curve, namely(44)cv±=m±rn,wherenis a unit vector perpendicular to the plane of the parabolic MAT.Remark 5.3Considering the 1-parameter family of vectorsv(cf. Theorem 5.1), which yield rational corresponding contour curvescv±, one can require some additional extra criterion when choosing a particularv. As a natural condition can be taken for instance the minimal arc length of the obtained contour curve since the contour curves with the minimal arc lengths do not wind too much around the canal surfaces. This guarantees a better distribution of the parameter lines on the canal surface. In Fig. 4, the plus branch of some arbitrary rational contour curve (top) and the plus branch of a rational contour curve with the minimal arc length (bottom) on a given canal surface are shown.We have already answered the question which unit vectors yield rational contour curves on a canal surface given by a quadratic MAT. In addition, another interesting question is which unit vectors give at least real contour curves (regardless of their rationality), i.e., for whichv∈S2the following condition is satisfied(45)ρ=‖m′‖2−(m′⊤⋅v)2−r′2≥0.Using canonical form (36) of a quadratic MAT and denotingv=(x,y,z)⊤, we arrive at(46)ρ(t)=ρ2t2+ρ1t+ρ0,where(47)ρ0=a2(1−y2)−c2;ρ1=−2(axy+bc);ρ2=1−b2−x2.The necessary and the sufficient conditions of non-negativity of the quadratic polynomialρare the positivity of the coefficient of the quadratic term ofρ, i.e.,ρ2>0and the non-positivity of the discriminant ofρ, i.e.,(48)D=(c2−a2)x2−2abcxy+a2(b2−1)y2−a2(b2−1)−c2≤0.Hence the boundary curves enclosing the region on the unit sphere corresponding to the vectors giving the real contour curves are defined as(49)D=0andx2+y2+z2=1,which are exactly the curves onS2corresponding to the vectors giving the rational contour curves, see (40). Then by parameterizing the ellipseD=0and substituting this parameterization toρ2(only itsx-coordinate is sufficient) we obtain the inequality of the form(50)p2(s)(1−b2)q2(s)>0,wherep(s),q(s)are some polynomials ins. This condition is always satisfied since the positivity of1−b2follows from condition (3) and it can be shown that for1−b2being positivep(and thus alsoρ2) is never zero. Hence the conditionρ2>0is satisfied for all vectors satisfying the conditionD≤0.Theorem 5.4For any canal surfaceSwith a quadratic MAT satisfyingτ=‖m′‖2−r′2≥0, the great circles on the unit sphereS2corresponding to the vectors giving the rational contour curves delimit the region onS2corresponding to the vectors giving the real contour curves.Example 5.5Let us consider the canal surfaceSdefined by the quadratic MAT, where(51)m(t)=(t2,t,0)⊤andr(t)=t22+t2+1.The canal surface fulfills non-degenerative condition (3), i.e.,τis PSD, and hence it contains two 1-parameter families of real rational contour curves corresponding to two great circles on the unit sphere, see Fig. 5(left). These great circles are simultaneously the boundary curves delimiting the region onS2corresponding to the vectors giving the real contour curves—i.e., the parts of the sphere lying inside the cylinder. For the pipe surface defined bymfrom (51) andr=const., there exists 1-parameter system of unit vectors corresponding to one great circle on the unit sphere all giving one rational contour curve, see Fig. 5 (right) and of course all vectors fromS2give real contour curves.For a spatial cubic spine curve (we omit the planar case), the matrixMis 3×3 and regular. Hence, the solution of (35) has the form(52)v=M−1⋅gφ.Moreover, asvis a unit vector we obtain(53)gφ⊤⋅(M−⊤M−1)⋅gφ=1.The matrixG=M−⊤⋅M−1is regular and symmetric. Thusx⊤⋅G⋅x=1describes a regular quadric inR3with the center at the origin. So, we can transform (34) to the problem of intersection of the quadricx⊤⋅G⋅x=1with a curve parameterized asx(φ)=cosφf+sinφg, which is a conic section. For the sake of simplicity we denotec≔cosφands≔sinφ. Thus, we solve the system(54)(cf+sg)⊤⋅G⋅(cf+sg)=1,c2+s2=1,which leads to the homogeneous quadratic equation(55)c2(f⊤⋅G⋅f−1)+2cs(f⊤⋅G⋅g)+s2(g⊤⋅G⋅g−1)=0.Denoting(56)A≔f⊤⋅G⋅f,B≔f⊤⋅G⋅g,C≔g⊤⋅G⋅gwe arrive at the following solution(57)c=±λ1,2λ1,22+1,s=±1λ1,22+1,where(58)λ1,2=−B±B2−(A−1)(C−1)A−1,and(59)v=±M−1⋅λ1,2f+gλ1,22+1.Thus we can formulateTheorem 5.6For a canal surface with the cubic MAT satisfyingτ=‖m′‖2−r′2≥0, there exists a vectorvsuch thatcvis rational over reals iff at least for one (of two non-equivalent) decomposition ofτ(60)B2−(A−1)(C−1)≥0,whereA,B,Care defined in   (56).Computing the vectors ensuring rational contour curves for canal surfaces with cubic MAT leads to two quadratic equations (which correspond to two non-equivalent decompositions ofτ, see (14)) and, as shown above, each of them possesses four (generally complex) solutions. So we can formulate the following proposition.Proposition 5.7For a canal surface with the cubic MAT there exist at most  8  different real vectors ensuring the rationality of the corresponding contour curve.Example 5.8Let us consider the canal surfaceSgiven by the cubic MAT, where(61)m(t)=(3t3−4t2−4t,3t3+4t2+4t,3t−5t2)⊤,and(62)r(t)=3t3+3t2−5t.Since condition (60) is satisfied for both non-equivalent classes of decomposition there exist 8 vectors yielding the rational contour curves onS, see Fig. 6(left). For the pipe surface given bymfrom (61) andr=const., there exist 4 vectors ensuring the rationality of the corresponding contour curves, see Fig. 6 (right).Now, let us focus on pipe surfaces. As in the quadratic case we can write a canonical representative of all cubically parameterized real polynomial spine curves (up to similarities and a reparameterization) in the form(63)m(t)=(t33+at,bt22+ct,dt)⊤,wherea,b,c,d∈Randb,d≠0(otherwise the spine curve is not a spatial cubic as required at the beginning of this section). Then the discriminants of (55) are of the form(64)D1=[(β−δ)2−b2]2[(α−γ)2+b2][(β+δ)2−b2];D2=[(β+δ)2−b2]2[(α−γ)2+b2][(β−δ)2−b2],whereα±βi,γ±δi(α,γ∈R,β,δ∈R+)are the roots ofτ(forr′=0), i.e.,(65)τ(t)=t4+(2a+b2)t2+2bct+a2+c2+d2=(t−α−βi)(t−α+βi)(t−γ−δi)(t−γ+δi).Hence the non-negativity of the discriminantsD1andD2depends only on the polynomials(66)h1=(β+δ)2−b2,h2=(β−δ)2−b2,respectively. Solving (65) as a system of equations for coefficients ofτyieldsa=12(−2α2−b2+β2+δ2),c=α(β−δ)(β+δ)b,(67)d=−(4α2+b2)[(β+δ)2−b2][(β−δ)2−b2]2band sincempossesses real coefficients(68)[(β+δ)2−b2][(β−δ)2−b2]has to be a non-positive polynomial. Henceh1is a non-negative andh2a non-positive polynomial, in general. We arrive at the following conclusion:Proposition 5.9For any pipe surface with the cubic spine curve, there exists a real vector (at most  4  different vectors) ensuring the rationality of the corresponding contour curve.This section is devoted to presenting two simple algorithms for the computation of a blending canal surface with the polynomial MAT of degrees 2 and 3 between two prescribed canal surfaces. Such a blending surface shall smoothly join two given canal surfaces. Hence, if we consider the MAT representation of the given canal surfaces and the blending surface inR3,1this problem can be transformed into theG1/C1Hermite interpolation of data in 4-dimensional space. The designed algorithms will be consequently modified for constructing family of blends with the same silhouettes, i.e., without necessity of further SOS decompositions.To have guaranteed the PSD property of the polynomialτassociated to a quadratic or cubic MAT of the constructed blending canal surface, which is a necessary condition for using SOS decompositions, we will assume in what follows that the given Hermite data{p1,p2;t1,t2}span a hyperplaneζ=〈p1;p2−p1,t1,t2〉such that the angle between this hyperplaneζand the coordinate hyperplaner=0is less than or equal toπ/4. Then the angle between all lines inζ, including the tangents of the constructed MAT, and the hyperplaner=0is also less than or equal toπ/4, which implies condition (3). These input data are called admissible data. To decide if the input Hermite data{p1,p2;t1,t2}are admissible it is enough to consider the normal vectornζof the hyperplaneζwhich must be non-space-like, i.e., it must hold(69)〈nζ,nζ〉≤0,wherenζ=(p2−p1)×t1×t2.Remark 6.1Quadratic MATs (i.e., parabolas) are planar and cubic MATs are lying in 3D space. Hence the requirement that the given Hermite data are admissible (in our sense) guarantees that the constructed interpolating parabolas/cubics (contained inζ) satisfy the PSD property. Of course, working only with the admissible data is a condition which is satisfactory but not necessary. However, our tests showed that in the majority of practical situations given data are of this type.In Section  5.1 we showed that for a quadratic MAT (satisfying the PSD property of the polynomialτ) there always exist two 1-parameter families of vectors yielding the rational contour curves. Hence we design a method for constructing a blending canal surface having quadratic MAT between two other canal surfaces. Since parabolas can interpolate only planar data we have to use quadratic biarcs11In this paper, the notion biarc is not reserved only for circular biarcs but we consider it as a shape composed of two arcs of any curve, in our case of two parabolic arcs, with an identical tangent vector at the connecting point.which can interpolate spatialC1data. In particular, for the pointsp1,p2and the tangent vectorst1,t2at these points ({p1,p2;t1,t2}are admissible data), we construct two Bézier quadratic curves (parabolas)(70)a¯(t)=∑i=02aiBi3(tμ),t∈[0,μ],b¯(t)=∑i=02biBi3(t−μ1−μ),t∈[μ,1],whereaiandbi,i=0,1,2are the control points and(71)Bin(t)=(ni)ti(1−t)n−i,i=0,1,…,n,are the Bernstein basis polynomials. To interpolate the input data the conditionsa¯(0)=p1,a¯′(0)=t1,b¯(1)=p2andb¯′(1)=t2must be satisfied. Hence we arrive at(72)a1=p1,a2=p1+μ2t1,b2=p2−1−μ2t2,b3=p2.In addition, to guarantee theC1continuity at the connecting point (a¯(μ)=b¯(μ)anda¯′(μ)=b¯′(μ)) we have(73)a3=b1=(1−μ)p1+μp2+μ(1−μ)2(t1−t2).Hence, we can formulate Algorithm 1.Example 6.2Let us consider two canal surfaces given by the following MATs:(74)m¯1(t)=(t,t2−3,−t2,1/4(t2+1))⊤,t∈[1/3,1];m¯2(t)=(t2,t2+3t,t3−3,t2+t+1)⊤,t∈[0,1/2].We interpolate the admissible HermiteC1datam¯1(1),m¯1′(1),m¯2(0),m¯2′(0)inR3,1by a quadratic biarch¯i,i=1,2and for eachh¯iwe compute the vectorviensuring the rationality of the corresponding contour curveci. Rotating the points ofciaround the tangents ofhiyields a piecewise PN parameterization of the blending surface (composed of two parts) between the given canal surfaces, see Fig. 7.In Section  5.2, it was shown that for a real canal surface defined by the cubic MAT the rational contour curve exists if condition (60) is fulfilled. Hence in such cases we can use canal surfaces with cubic MAT for the blending process, see Algorithm 2.Remark 6.3If condition (60) is not fulfilled (step 3 of Algorithm 2), then the constructed canal surface does not have a rational general contour curve and the contour method cannot be used. Of course, Algorithm 1 or the technique from  [19] can be still applied in this case. Nevertheless, our experiments show that for the majority of admissible data condition (60) is satisfied.Example 6.4We construct a blending canal surface with a cubic MAT between two non-rational canal surfaces defined as(75)m¯1(t)=(sin(t)−1,cos(t),et−3,2t−2)⊤,t∈[1/2,1];m¯2(t)=(tan(t),−4t,sin(t)−1,3t)⊤,t∈[0,1/3].Thus we compute Ferguson’s cubich¯matching the admissible HermiteC1datam¯1(1),m¯1′(1),m¯2(0),m¯2′(0). Since condition (60) is fulfilled we can compute the rational contour curvecv±w.r.t. a suitable vectorv. Finally, by rotating the points of e.g.cv+around the tangents ofhwe arrive at the PN parameterization of the blending surface, see Fig. 8.In this subsection we will deal with the problem of constructing a blending surface between two given canal surfaces which satisfies a certain constraint, in particular it is required that the constructed blend shall bypass some obstacle(s). We will see an advantage of the contour method which allows us to generate at once a whole family of rational canal surfaces having the same projection of the contour curve (the silhouette) w.r.t. some vectorv, see Fig. 1.Firstly, we construct a classical blending surface, see Sections  6.1 and 6.2. For instance, we use Algorithm 1 and obtain a blending canal surface that is described by a quadratic medial axis transformm¯=(m,r)⊤—thus the rationality of its contour curvecvw.r.t. the vectorvis generally guaranteed. Then we construct a new spine curve and a new contour curve in the form(76)m∗=m+vf,cv∗=cv+vf,obtained from the original spine curvemand the original contour curvecvusing some suitable rational distance functionfcontinuous on(0,1)and satisfying the conditions(77)f(0)=0,f′(0)=0,f(1)=0,f′(1)=0.The distance functionfenables to modify the blending canal surface in thev-direction and thus to satisfy the constraints. We emphasize that the original and also the new canal surfaces possess the same projection w.r.t. the directionv, both have the contour curve being rational w.r.t. the directionv, and both are blending the given canal surfaces.The natural question reads how to choose the aforementioned distance functionf. A suitable non-zero function of the lowest degree satisfying (77) and one extra-conditionf(μ)=ξcan be e.g. the following function of degree 4(78)f(t)=ξ(μ−1)2μ2(t−1)2t2.In what follows we will use a different function composed of the two parts which is of degree 3 only. Moreover, it is ensured that[μ,ξ]is an extreme off, see Fig. 9,(79)f(t)={ξμ3t2(3μ−2t),t∈[0,μ];ξ(1−μ)3(t−1)2(2t−3μ+1),t∈[μ,1].Remark 6.5For the modification of the adaptive blends presented in Fig. 1 we have used the distance functionsf1,f2,f3,f4whose graphs are shown in Fig. 10.Example 6.6A rational blending canal surface between two given canal surfaces was computed by the designed contour method, see Fig. 11(left). Hence, its spine curvem, the radius functionrand the rational contour curvecvare known. Now, the task is to modify this blending surface such that it bypasses a sphere which is given by its centerxand the radiusR.We construct a new blending surface (bypassing the given sphere) with the same silhouette, see Fig. 11 (middle, right). This can be simply done by computing a new spine curvem∗and the corresponding contour curvecv∗according to (76), where the functionfis chosen as in (79). A right choice of the valuesμandξshall guarantee that the new blending surface does not intersect the given sphere—in particular it must hold for allt∈[0,1](80)‖m∗(t)−x‖>r(t)+R.Remark 6.7Let us note that it is not guaranteed in general that the constructed blending canal surface (between two given canal surfaces) avoids the prescribed obstacle (e.g. when the obstacle is too large or too close to the given canal surfaces). The reason is that the freedom in modifying the shape of the canal surfaces is quite restricted since these are the envelopes of one parameter families of spheres. Moreover, we can modify them (for our blending purposes) only in some directions (guaranteeing rational contour curves). For these situations e.g. the ringed surfaces are more convenient, cf.  [30]. However, when it is possible it is better to use canal surfaces (for the blending purposes) since these blends are of more natural shapes.Example 6.8In this example we consider the problem of constructing two different blending surfaces between two pairs of given canal surfaces such that the constructed blends bypass each other, i.e., they do not intersect. Using the contour method we can easily (and independently) construct the blending surfacesB1andB2and then we modify them suitably (to ensure that they do not intersect), see Fig. 12. The non-intersection of the constructed canal surfaces can be verified e.g. by the methods from  [31].Remark 6.9Let us discuss one detail of the above presented approach. When using the quadratic-biarc-method for the computation of the blend avoiding a given obstacle we have to, in fact, compute rational parameterizations of two canal surfaces (since the blend is composed of the two parts). Hence for each part we have to find a vector giving the rational contour curve. Nevertheless, when modifying the double-blend to bypass the given obstacle it must be satisfied that the both parts possess the rational contour curve with respect to the same direction. However, this can be always done since for each canal surface with the quadratic MAT there exist two one-parameter families of vectors corresponding to the two great circles on the unit sphere giving the rational contour curves. And the great circles always intersect in the real points.

@&#CONCLUSIONS@&#
