@&#MAIN-TITLE@&#
A branch-price-and-cut method for the vegetable crop rotation scheduling problem with minimal plot sizes

@&#HIGHLIGHTS@&#
We address a vegetable production problem with sustainability considerations.We propose an integer programming formulation and a branch-price-and-cut method.The method relies on subadditive valid inequalities and a strong branching rule.1 percent-optimality was proven for all instances within reasonable computational times.

@&#KEYPHRASES@&#
OR in agriculture,Crop rotation scheduling,Branch-price-and-cut,Strong branching,Subadditive valid inequalities,

@&#ABSTRACT@&#
Crop rotation plays an important role in agricultural production models with sustainability considerations. Commonly associated strategies include the alternation of botanical families in the plots, the use of fallow periods and the inclusion of green manure crops. In this article, we address the problem of scheduling vegetable production in this context. Vegetables crop farmers usually manage a large number of crop species with different planting periods and growing times. These crops present multiple and varied harvesting periods and productivities. The combination of such characteristics makes the generation of good vegetable crop rotation schedules a hard combinatorial task. We approach this problem while considering two additional important practical aspects: standard plot sizes (multiples of a base area) and total area minimisation. We propose an integer programming formulation for this problem and develop a branch-price-and-cut algorithm that includes several performance-enhancing characteristics, such as the inclusion of a family of subadditive valid inequalities, two primal heuristics and a strong branching rule. Extensive computational experiments over a set of instances based on real-life data validate the efficiency and robustness of the proposed method.

@&#INTRODUCTION@&#
Sustainable agricultural production and distribution models have gained attention in the literature in recent years (Alfandari, Lemalade, Nagih, & Plateau, 2011; Bachinger & Zander, 2007; Detlefsen & Jensen, 2007; Haneveld & Stegeman, 2005). In particular, we have been interested in the use of crop rotation as a pest control and conservation of productive resources strategy in the farming of vegetables. The scheduling of vegetable crop rotation, especially when the goal is to supply a given demand, presents several complicated characteristics associated with the fact that crops with very different planting, growing and (multiple and coupled) harvesting times must be addressed simultaneously.In the past decade, a few mathematical formulations have been proposed in the literature with the purpose of considering ecologically based constraints. Santos (2009) developed an integer programming model by considering the following three ecological based criteria: (i) crops of the same botanical family cannot be grown one after another in the same land plot, (ii) a green manure crop must be periodically grown in each plot and (iii) there are requirements in terms of fallowness that must be respected. These criteria aim at reducing the population growth of pests and weeds; recovering of the physical, chemical and biological soil properties; increasing soil fertility and incorporating nitrogen into the system through biological fixation (Altieri, 1995; Dias, Dukes, & Antunes, 2014; Wezel et al., 2013). They have been used in a number of follow-up articles addressing variants of the model proposed in Santos (2009), including, for instance, concerns regarding the supply of demands (Santos, Costa, Arenales, & Santos, 2010), the management of perishable stocks (Costa, Santos, Alem, & Santos, 2014) and the extension of these ecologically based constraints to avoid growing crops from the same botanical family simultaneously in neighbouring plots (Santos, Arenales, Costa, & Santos, 2010; Santos, Michelon, Arenales, & Santos, 2011). These problems have been solved with variants of a column generation algorithm (Lübbecke & Desrosiers, 2005; Vanderbeck & Wolsey, 2010) in which the generated columns carry the crop planting schedule information.The articles mentioned above deal with the sizing of the plots, but following two different approaches. Either they assume that the plot size is an exogenous parameter (Santos, Arenales et al., 2010; Santos et al., 2011) or they let the optimisation model to freely decide on plot sizes by using endogenous variables (Costa et al., 2013; Santos, Costa et al., 2010). While both approaches might have their applicabilities, they also have limitations. Fixing candidate plot sizes a priori reduces the solution space and might, therefore, lead to sub-optimal configurations. On the other hand, imposing no sizing constraints usually lead to a large number of plots, with very different and frequently small areas. This is contrary to what is expected in practice, where plot size standardisation is a welcome characteristic because it eliminates the need of dealing with very small plots (with sizes smaller than the base area) and also facilitates farming management. Indeed, many caring techniques, such as irrigation, are planned for or more suitably used in plots with standard sizes.In this paper, we focus on a crop rotation scheduling problem that deals with the sizing of the plots endogenously, while imposing that they are multiples of a base area. We also consider the ecological based criteria mentioned earlier and an explicit area minimisation objective. The idea of area minimisation has been already addressed in Alfandari et al. (2011) and has clear advantages, such as the reduction of infrastructure and operational costs and the facilitation of the maintenance of conservation spaces with wider environments, thus reducing the pressure on areas that are more susceptible to degradation. To tackle this problem, we propose an integer programming model that minimises the planting area while guaranteeing that the obtained plot sizes are multiples of a base value and supply a given demand. Since the proposed model corresponds to an extensive formulation, we develop a branch-price-and-cut (BPC) algorithm.BPC algorithms have shown to be a powerful tool for solving hard combinatorial problems (Barnhart, Johnson, Nemhauser, Savelsbergh, & Vance, 1998; Vanderbeck & Wolsey, 2010). In the context of crop scheduling, we are aware of two other applications of the method, which deal with crops with different growth cycles (Santos, Arenales et al., 2010) and equal growth cycles (Alfandari, Plateau, & Schepler, 2015). In Santos, Arenales et al. (2010), the authors propose a BPC for a vegetable crop rotation (using criteria (i)–(iii)) with additional adjacency constraints imposing that crops of the same botanical family cannot be grown simultaneously in neighbouring areas. Plots locations and sizes were determined a priori, allowing the model to be reformulated as a pure 0–1 master problem. In Alfandari et al. (2015), the authors use a BPC algorithm to solve a crop rotation problem that select plots from a candidate list in order to minimise the combined area of chosen plots while meeting a given demand. They deal with crops that have a single growing cycle (and therefore, one harvest period) and only two possible planting periods per year, following the same ideas proposed in Alfandari et al. (2011). These crop characteristics allow the feasible crop rotations to be expressed by means of a clever transition graph, so the subproblems can be solved by using a shortest path algorithm. In both Santos, Arenales et al. (2010) and Alfandari et al. (2015), the models are defined using a set of potential plot sizes chosen a priori. This allows the use of binary variables associated with the selection of scheduling sequences for each plot and the efficient use of traditional branching rules.The BPC algorithm proposed in this paper is structurally different from those proposed in Santos, Arenales et al. (2010) and Alfandari et al. (2015). Indeed, since the model includes decisions on both plot sizes and schedules simultaneously, the decision variables must be defined as general integers, i.e., they are allowed to take any positive integer value. To be effective in such context, the BPC has to rely on branching rules based on sets of variables, aided with a strong branching strategy. In addition, we aim at tackling practical situations that involve up to 20 crops with diverse characteristics and have to follow a fine granularity of the time discretisation (each year represented as 48 time periods). These features lead to large instances which require a number of further performance-enhancing characteristics, such as the use of a set of newly developed family of valid inequalities, which improve the quality of the bounds obtained by the column generation subroutine, and two primal heuristics.To verify the performance of the proposed BPC algorithm in practice, we have run an extensive set of computational experiments using instances based on real-life data. For all instances, the proposed method was able to prove 1 percent-optimality within very reasonable computational times. The results also indicate the positive effect of the proposed performance-enhancing features.The remainder of this paper is organised to present this whole set of ideas coherently. Section 2 defines the problem and presents the developed mixed-integer model. The solution methodology is then described in Section 3, in which we detail, in order, the column generation procedure, the branching strategy, the proposed valid inequalities, and the primal heuristic procedures that compose our branch-price-and-cut method. Section 4 presents the results of the computational experiments while Section 5 ends this paper with conclusions and suggested routes for further investigation.Let N be the number of different available crops and M be the number of time periods (days, weeks, months, etc.) in which the growing of these crops is going to be scheduled to satisfy a given known demand. The crop rotation scheduling problem (CRSP) consists of determining schedules for the crop rotation activity such that the production of each crop at each period is sufficient to satisfy its corresponding demand, while respecting a set of ecological criteria and biological methods. We consider that the main objective is to minimise the size of the planting area. In addition, we assume that the planting area is divided into plots, which have a predefined minimum size denoted by amin and that the size of any plot can only be a multiple of this value. Consider the following additional parameters:Ca set of crops that are planted to satisfy the demand;a set of crops that are available for green manuring;total number of crops, i.e., cardinality of C ∪ G;index of a fictitious crop, representing the presence of fallow;number of botanical families;set of crops from the botanical family p, p = 1, …, NF;production time for crop i, including soil preparation and harvesting;set of time periods in which crop i can be planted;minimum time interval to wait between planting two crops from the same botanical family.We can write linear constraints forcing a single plot schedule to respect the ecologically based criteria mentioned previously. Indeed, using binary variables:xij={1,ifcropiisplantedintimeperiodj,0,otherwise,fori=1,⋯,N+1and j = 1, … , M, these constraints read (Santos, Costa et al., 2010):(1)∑i=1N+1∑r=0ti−1xi,j−r≤1,j=1,…,M,(2)∑i∈F(p)∑r=0ti−1+tfxi,j−r≤1,p=1,…,NF,j=1,…,M,(3)∑i∈G∑j∈Iixij=1,(4)∑j=1MxN+1,j=1,(5)xij∈{0,1},i=1,…,N+1,j∈Iiwhere j − r < 0 is replaced by j − r + M in constraints (1) and (2). Constraints (1) ensure that at most one crop is planted at each time period (including fallow), whereas constraints (2) forbid planting crops from the same botanical family in a time interval smaller than tf. Constraint (3) imposes that a crop must be planted for green manuring and constraint (4) guarantees the presence of fallow. Both constraints (3) and (4) can be easily modified to incorporate the need of more fallows or green manure crops during the rotation period (Santos, 2009).The right-hand side in constraint (4) enforces the requirement of a single period of fallow. This is not a limitation of the model, but a choice that follows our experience with vegetable farmers in Brazil. The common practice among these farmers is to make intense use of the land. In addition, we base this requirement on the recent literature that addresses the effect of a single short fallow on crop yield (Babu, Rao, & Veeraraghavaiah, 2014; Dias et al., 2014; Gabriel & Quemada, 2011; Hunt & Kirkegaard, 2012) and on the fact that we also consider green manuring as a way of recovering soil chemical and physical properties and interrupting the population growth of pests and weeds (Allen, Pikul, Waddell, & Cochran, 2011; Kröbel et al., 2014; Manyanga, Mafongoya, & Tauro, 2014; Miller et al., 2011).Let X be the set of all feasible schedules that satisfy constraints (1) to (5). Additionally, let S be the set of indices associated with the schedules in X, such that each schedule in X can be denoted by xsfor a unique s ∈ S. Given a schedule xs, we are interested in determining the production that results from the use of such schedule in a given plot. To obtain this information, the following parameters are needed:pirtotal production of crop i on its rth harvesting;time interval between the period crop i is planted and the period of its first harvesting.The production of crop i at time period j in an area of size equal to the base area, when using schedule xs, is then given by(6)aijs=∑r=1ti−oi−1aminpirxi,j−oi−rs,where amin stands for the base plot area.Relationship (6) converts schedule-based information to crop production values. This is crucial for obtaining the following model, which aims at finding schedules with a combined production that meets the required demand while minimising the total planting area:(7)min∑s∈Sus(8)s.t.∑s∈Saijsus≥dij,i∈C,j=1,…,M,(9)∑s∈Sus≤L,(10)us∈Z+,s∈S,where u is the vector of decision variables such that each component usis the number of base-area plots of size amin that is assigned to schedule s ∈ S. Parameter dijis the demand of crop i in time period j, for i ∈ C and j = 1, … , M, and therefore constraints (8) ensure that the required demand is met. Constraint (9) imposes that the number of base-area plots does not exceed the upper limit L. This constraint can be tightened by changing L in (9) to any known upper bound on the solution of the problem. As we have observed in preliminary computational experiments, this strategy was helpful to speed up the proposed solution method. We assume that planting area is homogeneous, as in practice the plots used to grow the vegetable crops have typically similar characteristics, as a result of years of similar cropping management. The model can be easily extended to cope with heterogeneous areas (see, for instance Santos, Arenales et al., 2010; Santos, Costa et al., 2010).The usual large number of possible schedules and the integrality of variables usmakes the resolution of such a model a difficult challenge. The following section describes the method that has been proposed for this purpose.

@&#CONCLUSIONS@&#
Here, we have addressed a sustainable vegetable crop rotation scheduling problem with the goal of minimising the planting area while supplying the given demands and respecting standardised plot sizes. The production of vegetables usually occurs in coupled sequential harvesting periods, which differentiates this situation from other multi-period scheduling problems, such as the cutting stock problem. The existence of multiple harvests, in which a single planting might supply the demands for various future periods, is associated with the need to use integer variables to model the requirement of standard plot sizes and the fact that real-life instances usually address a large number of periods, making this a very difficult combinatorial problem. To solve this problem, we have proposed a branch-price-and-cut method that incorporates enhanced features, such as a strong branching strategy using branching sets, a family of newly developed subadditive valid inequalities, and primal heuristics procedures.To verify the performance of the proposed method, we randomly generated four classes of instances based on real-life data. The results of the computational experiments on these instances suggest that the resulting method is efficient and robust to demand variation. Most of the instances could be solved to optimality. The relative gap of the 16 instances for which optimality was not achieved was less than 1 percent. In addition, we analysed the impact of the main features of the method on its overall performance. Our analyses indicate that the column generation combined within a MIP-based rounding heuristic at the root node could be used to provide high quality solutions and are probably sufficient in practice. Nevertheless, branching could improve both lower and upper bounds for a number of instances. The strong branching technique and the proposed valid inequalities contributed significantly to the improvement of the performance of the branch-price-and-cut method. Furthermore, primal heuristics were shown to be crucial to the accelerated convergence of the method.Future research in this area should incorporate additional aspects that might make the obtained solutions even more suitable in practice, including a multi-objective analysis of factors as total area, number of plots and other ecologically based criteria.