@&#MAIN-TITLE@&#
Multidimensional extended spatial evolutionary games

@&#HIGHLIGHTS@&#
Introducing time-varying payoff matrices in mean-field games.New possibilities for more accurate and complex game theoretic simulation.Spatial lattice with simulation of interaction between cells and environment.Heterogeneity of individuals (poly-phenotypic players) in spatial games (MSEG).More precisely biological phenomena, especially for cancer cell populations.

@&#KEYPHRASES@&#
Evolutionary games,Biomathematical modeling,Cellular automata,Sensitivity,Polymorphism,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Evolutionary game theory (EGT) proposed by John Maynard Smith and George Price [1] initiated new viewpoints in numerous areas of biology like genetics, ecology, and etiology. Since game theory is linked to Darwinian fitness and species evolution, it is a useful and efficient methodology for analysis and simulation of the dynamics of changes within different biological subpopulations in a biological population, where individuals with different phenotypes (strategies, approaches) compete or cooperate with others according to their evolutionary traits without any rationality following their instincts and encoded behaviour, and decision-making is a key factor. The result is a change of the degree of evolutionary adjustment by achieving better access to food supplies, females, or life space. This change is termed a payoff and the evolutionary adjustment is termed fitness. Due to different adjustments to the environment and interactions between individuals, the phenotypic consistency of a population may tend to stabilize its structure and achieve a stable monomorphic or polymorphic equilibrium. The stable (in the sense of its phenotypic content) population is called the Evolutionary Stable Strategy (ESS) or Evolutionary Stable State [2]. The former is a phenotype that has been adapted by the majority of the population and cannot be repressed by other phenotypes. However, the opposite situation is possible; ESS may coexist stably with other phenotypes or even suppress them and dominate in the population. The latter is the situation when more than one phenotype exists in the final, stable population, that is resistant to the inflow of mutants or to environmental changes.In this paper we expand theoretical evolutionary game models (both mean-field and spatial) by including parallel changes of the phenotypes’ adjustment during transient generations within the population. These changes are performed by varying the parameters in the payoff matrix, which determine fitness (payoff, adjustment) resulting from different interactions between players, taking into account both the benefits and the costs of particular actions and strategies. Alteration of these parameters changes them into functions that simulate (within this model) changes in the environment and define their different impacts on the fitness. Simulation of environment changes could be considered, for instance, as a relevant resource such as water, food or space which is accessible for the individuals inhabiting this particular environment. In spatial games, these functions are represented by an additional lattice where another and parallel game based on cellular automata is performed. We introduce a new category of spatial games termed mixed spatial evolutionary games (MSEG) that allow introduction of the heterogeneity not only of the population, but also of the particular individuals that may use different strategies, i.e., have different and mixed phenotypes in the evolutionary sense. Here we apply these ideas to the hawk and dove model, but more complex simulations for other models, for instance tumour evolution, should be feasible.EGT allows to foresee if a population tends to be heterogeneous or rather if one phenotype survives and dominates. To follow the dynamics of phenotypes replicator equations may be used [3] which describe the behaviour of the population in time during successive generations starting from the initial frequency of occurrence until the equilibrium defined by the Evolutionary Stable State is reached (however, it may happen that there are not any stable states). Due to the main assumption about perfect mixing of the phenotypes in the population, the results are in some way global and averaged and consequently the impact of local spatial arrangement and internal interactions in the neighbourhood cannot be analysed. This simplification has been overcome by spatial evolutionary game theory (SEGT) [4].To properly introduce SEGT it is necessary to return to mean-field (not spatial) EGT and one of its applications. In 1997 Tomlinson and Bodmer [5] proposed the use of game theory methods in modelling interactions and communication between tumour cells. Their work initiated a series of other papers studying different kinds of phenotypes and tumour populations (see [6,7] for surveys) in one of which Bach and co-workers [4] proposed an algorithm for spatial analysis of the phenomena of carcinogenesis using SEGT, which appears to be an appropriate and useful approach to take into account another factor, allocation of space and players. Consequently, spatial games have become very popular recently although their origins are in cellular automata [8] combined with classical game theory.The main assumption of the spatial games presented in [4] is that each cell on the lattice is represented by a player following only one strategy. The local payoff for each player is the sum of payoffs due to interactions with cells in the neighbourhood according to the payoff matrix. We refer to this approach here as the standard, classical one or SEGT. Alternatively, cells on the spatial lattice can also be considered as heterogeneous instead of homogeneous, so that each particular player may contain mixed phenotypes. Spatial games of the type which we proposed in [9] to model interaction of cells in the, so called, bystander effect are termed mixed spatial evolutionary games (MSEG). In MSEG it is important to mention the definition of the phenotype, which is the set of traits or characteristics of an organism [10] and hence different degrees of playing a particular strategy are treated as different characteristics that define different phenotypes. It may happen that within the population, all of the players have diverse phenotypes, which is probably an more appropriate description for biological phenomena. For the sake of simplicity and following the manner of reasoning in SEGT, these strategies and traits still correspond to phenotypes and a general, collective point of view is defined as a player’s phenotypic composition. In fact, the game is performed on a multidimensional lattice (dependent on the number of defined phenotypes in the model), where each layer represents a particular phenotype (as the frequency of occurrence) of the player. For the computation of the local adaptation, the sum of the payoffs between each phenotype (within two players) multiplied by their rate of occurrence is calculated first, followed by summing these values for each player in the neighbourhood.When performing a spatial game, in every single iteration one global algorithm is used on the lattice, forming a torus. The algorithm is basically the same for both spatial approaches, and contains:−payoff updating—the local fitness of each player is calculated taking into account the local neighbourhood.cell mortality—10% of the players are removed from the lattice at every generation.reproduction—chosen players interact with their neighbours.The payoff updating step has been already described while introducing SEGT and MSEG, and a more detailed view will be provided below in a concrete model. The next stage takes into account cell mortality, a term used in the original algorithm [4] which has a slightly different meaning in MSEG; players are not removed from the lattice, but interact with their neighbours which may result in changes of the player’s phenotypic composition. In this paper semi-synchronous updating is used, and 10% of the players from the lattice are chosen to play this role. Alternatively, synchronous updating (all cells are removed/chosen within one iteration) or asynchronous updating (only one cell is removed/chosen within one iteration) may be applied, but these kinds of mortality are not considered in this paper, because their interpretation in biological systems is not always clear. The authors of SEGT proposed two kinds of reproduction:−deterministic—the winner is the strongest player.probabilistic—the player’s local adaptation is further divided by the sum of the local payoffs in the neighbourhood.Classical SEGT has been extended by two other reproductions (switching and quantitative) and studied in [11]. However, for the purposes of MSEG we focus on only deterministic and probabilistic reproductions, because they are simple to apply in games of this type.A different approach for the player interpretation (polyphenotypic description) allows creation and use of other reproductions:−weighted mean of the strongest players—in accordance with the players’ payoffs, the weighted mean from phenotypes is computed for the players with the highest scores.weighted mean of the best interval—players are divided into intervals in accordance with their payoffs. The weighted mean is computed only for the players from the best interval.Another difference between SEGT and MSEG is that in the former a tie (when payoffs are equal) is settled randomly, while in the latter the average between phenotypic compositions is computed. Spatial games are complex due to the vast amount of different methods and parameters. An additional possibility to achieve different results is to consider diverse neighbourhood sizes and types (for instance von Neumann or Moore type).The extension of spatial games which we describe here is a development of our previous studies [9,11], which were based on the work of Bach and co-workers [4] and on the ideas presented in [12] where hawk–dove games were revisited taking into account spatial aspects. In another spatial approach with the use of mixed strategies [13] the Prisoner’s Dilemma game is played on a spatial lattice with synchronous and asynchronous players’ choice and with a deterministic reproduction termed by the authors “imitation max”. But the use of the mixed-strategies is completely different than mixed-phenotype used by us. The mixed strategy in [13] describes the probability of pure strategy’s choice and when chosen (step called action updating) is used for the payoff computation. In our approach it describes the phenotypical composition of the player (individual) not followed by the choice of the strategy but used for the payoff computation. Yet another approach to multiple layers in evolutionary games can be found in [14], where the Prisoner’s Dilemma problem is studied in this context as a game performed on a network of interactions.The application of evolutionary games to simulate processes involved in tumour development was a starting point for this class of spatial evolutionary games. This approach, however, could also be used for the one of the first evolutionary models. Maynard–Smith [15] proposed a model with two kinds of behaviour, fight or avoid, within a population of one species which is a symbolic representation of the ritual conflicts of two different strategies that have arisen in the process of evolution. Within a population consisting of such individuals, conflicts may be performed for resources, territory, food, or females.─Phenotypes:−Hawk – fighting strategy – escalates and continues until receiving an injury or the opponent escapesDove – avoiding strategy – retreats or shares with another doveParameters:−v—the benefit that may be obtained during the contestc—the cost of escalationThe payoff matrix (Table 1) should be read vertically. The maximum feasible profit is 2v and can be gained by a hawk while interacting with a dove, and therefore the dove’s payoff is 0. When the same strategies interact between each other, it is necessary to share the maximum feasible profit and hawks additionally bear the cost of escalation.The conditions for stable polymorphism (coexistence between all phenotypes) can be determined by the Bishop–Canning theory [16] which states that the phenotype’s mean payoff in the population shall be equal:(1)E(H)=H×(v−c)+D×2v(2)E(D)=H×0+D×vwhere H and D are the frequencies of occurrence of the phenotypes in the population for the mean-field (not spatial) game. Due to the fact that the sum of H and D equals 1 and E(H) equals E(D), the expected frequencies of occurrence are:(3)H=vcandD=1−vcHence to achieve a stable polymorphic result v must be less than c (Fig. 1a), or otherwise the population is dominated by hawks (Fig. 1b).Our results for this model are independent of the initial frequencies of occurrence (Fig. 1, red asterisks). We will use the mean-field results for a comparison with those of spatial games.Having introduced the model, we are led to details with examples for a better understanding of the spatial algorithms and methods.The model contains two phenotypes and therefore two layers (two lattices) are used to define the player’s phenotypic composition (Fig. 2). The sum of particular frequencies of occurrence equals 1, exactly as for the mean-field model. For example, for two individuals: A (hawk: 60%, dove: 40%) and B (hawk: 30%, dove: 70%) the local payoff for the interaction between A and B is:(4)60%×30%×(v−c)+60%×70%×2v+40%×30%×0+40%×70%×vSince each player may exhibit a mixed phenotype, the graphical representation on the spatial lattice should take this into account. InFig. 3, starting with pure green for players that are 100% doves the colour is changed linearly into pure blue that represents 100% of hawks.The payoff matrix does not have to remain constant during the game; the parameters may change depending on other factors (e.g. changes in the environment or any other external influence).The model of hawks and doves may be extended by yet another parameter r (Fig. 4) that represents the amount and the availability of resources like territory, food, etc. Following the reasoning discussed by Maynard–Smith [15] the parameter r will be treated rather like territory, but without division or additional effects of being an invader or owner.For such games we can define some general, basic rules:−Hawks, being more aggressive, tend to be better adjusted when r is relatively small.Doves do better (or at least not worse than in a classical game) when resources are greater, providing opportunities for instance to “steal” food or to find it without interaction with another individual in the vast area.Even if r is relatively large, hawks still bear the cost of escalation and doves still share the benefits. The exact value of r, however, may affect the intensity of escalation or distribution of resources.We consider two different models that extend the basic model. The payoffs for particular interactions are now functions dependent on r, which are linear and are presented in the form of payoff values for r equals 0 and 1 (Table 2). Red font indicates the changes in comparison with the original model (Table 1).The assumption of this model is that for r=0 the payoff matrix is the same as that in the basic model. With increasing r, more chances and better adjustment are gained by doves (note the red numbers in Table 2). Therefore doves do not have to share the benefits, and in the case of interaction with hawks it is possible to gain some profits.The next alteration (Table 3) concerns the interaction between hawks, which in the case of r=0 they bear a double cost of escalation (due to limited resources), but when r=1 the cost is divided by two (red values in Table 3).Spatial games give the opportunity to change r for a group of cells or even for each cell separately, whereas for mean-field games r is changed simultaneously for the entire population and does not depend on its current composition. For the spatial application we choose MSEG games, since they provide more possibilities to define different rules for the resources simulation. Here another lattice is needed, where a different game with different rules is performed. The rules are:1)Individuals who are more hawks take from those who are less aggressive an amount of resources that results from the difference between the hawk’s frequency of occurrence.A dove divides its resources with those doves that have more resources according to the dove’s frequency of occurrence.The resources are limited to the (0, 1) interval.An example describes this idea in a clearer way. The players are:A–H=80%,D=20%,r=0.7B–H=30%,D=70%,r=0.5Player A: the first rule requires that 50% of player B’s resources shall be added to player A. Thus in the next iteration r for player A is equal to 0.95 and for player B to 0.25. The second rule does not have an application here. If the difference between hawks is larger and for instance 0.4 of the resources should be transferred from player B to player A, then this value shall be limited to 0.3 (hence, player B loses only 0.3).Player B: the first rule does not have an application here, since it is dependent on the frequency of occurrence of hawks. Due to the fact that player A has got more resources, rule 2 can be applied. The difference between resources shall be multiplied by 70%, which gives 0.14 to be added to player B (r=0.39) and subtracted from player A (r=0.81).

@&#CONCLUSIONS@&#
Mixed spatial evolutionary games provide additional possibilities of reproductions and general game realization. For both SEGT and MSEG it is feasible to provide an additional layer where a parallel game is performed. We have chosen MSEGs due to their interpretation of the player and the possibility of rule creation for parallel games based on a phenotype’s frequency of occurrence. In MSEGs these phenotypes are stored on different layers, and yet another layer simulates the environment (resources), in fact giving a multidimensional game. Regardless of the already existing immense amount of parameters and possible configurations of games, they may be modified further by different payoff matrices. We have shown two different models that include parameter changes during the simulation. Hence, the payoff matrix is not stable and it differs for different players. This leads to yet another difficulty in spatial games analysis, since it is disputable to predict the results or even to compare them between MSEG and a multi-layered game. In fact, an additional layer modifies the model significantly, creating a new game. What is interesting is that the spatial allocation factor and new approach seem to give unpredictable results in comparison with those that may be achieved by analysis of payoff matrices. Moreover, changes of the parameters (v and c) and different enhancement models appear to have different effects on different reproductions. So effects observed for one reproduction due to different game configurations (values of parameters, payoff matrices etc.) may have no qualitative (but quantitative) counterparts within other reproductions due to the same changes. Studies of the sensitivity of spatial games are far from being complete, since we neglected some of the possible configurations like different initial lattices, different neighbourhoods, or different numbers of best players or intervals (for weighted mean games). We believe that modelling tumour heterogeneity on the cell level and taking into account the two suggested factors (changes in frequencies and interactions between cells) may fit well as an application to the so called evolutionary double bind model [24], where two different anticancer therapies are used sequentially.New approaches of spatial evolutionary games have been introduced using the classical hawk and dove model. We hope that MSEG models may contribute to a new generation of mathematical and computational models of carcinogenesis and progression of cancer, based on recent biological findings. These findings were summarized in two famous papers listing the “hallmarks of cancer” [25,26] by Hanahan and Weinberg. These include the “Original Hallmarks”: limitless replicative potential, tissue invasion and metastasis, insensitivity to anti-growth signals, self-sufficiency in growth signals, evading apoptosis and sustained angiogenesis. The “New Generation Hallmarks” include the Enabling Characteristics, such as genome instability and mutation and tumour-promoting inflammation, and Emerging Hallmarks, such as deregulation of cellular energetics and avoidance of immune destruction. The most urgent and obvious question which emerges from this summary is how it is possible that such complex strategies (behaviours) as those observed in cancer could have emerged. Indeed, as stated in a recent review by Ben-Jacob et al. [27], “Despite decades of a much improved understanding of cancer biology, we are still baffled by questions regarding the deadliest traits of malignancy: metastatic colonization, dormancy and relapse, and the rapid evolution of multiple drug and immune resistance”.Similarly to evolution of organisms, population of cancer cells can be also regarded as evolving system including the stage of mutations’ introduction and selection [28,29]. In comparison to genomes of normal cells, the cancer genomes are characterized by more frequent point mutations, small deletions and insertions, gene fusions and amplifications [30,31]. In [32] over 136000 coding mutations found in 4803 genes were already reported. In addition to that cancer genomes are subjected to large-scale genome alternations, chromosomal rearrangements, translocations and lesions [30,31]. The presence of these ‘catastrophic’ events indicates that cells can tolerate to some extent such changes or even obtained a selective advantage from them. The largest scale alterations in tumour cells lead to the whole genome polyploidizations which result in changes in copy number of chromosomes and to unbalanced number of genes. Our idea to treat individuals as representatives of phenotypes which are mixtures of basic traits with almost continuous spectrum of possible strategies is, in our opinion, one of reasonable approximations of these observations. On the other hand it has been demonstrated in many papers [33,34] that it is necessary to include spatial distribution of signalling among cells as well as competition and cooperation to reproduce essentially random multifocality phenomenon in early cancer.An important part of the problem we address in this paper is related to the role of environment (resources) modelled by yet another layer of the game. We hope that it may help in answering one of fundamental questions of modern genetic oncology: whether the genetic heterogeneity in cancer cells exists ab initio (i.e., before diagnosis or intervention), and is modified by selection when treatment is applied, or, does it evolve following the treatment and as a result of the intervention.