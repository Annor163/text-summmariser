@&#MAIN-TITLE@&#
Optimal savings management for individuals with defined contribution pension plans

@&#HIGHLIGHTS@&#
A pension product should be tailored to a customer.Annuity and life insurance decisions are as important as investment decisions.We combine stochastic programming and stochastic optimal control approaches.We generate scenario trees with asset returns and events of death.

@&#KEYPHRASES@&#
Finance,Pensions,Utility theory,Stochastic programming,Stochastic optimal control,

@&#ABSTRACT@&#
The paper provides some guidelines to individuals with defined contribution (DC) pension plans on how to manage pension savings both before and after retirement. We argue that decisions regarding investment, annuity payments, and the size of death sum should not only depend on the individual’s age (or time left to retirement), nor should they solely depend on the risk preferences, but should also capture: (1) economical characteristics—such as current value on the pension savings account, expected pension contributions (mandatory and voluntary), and expected income after retirement (e.g. retirement state pension), and (2) personal characteristics—such as risk aversion, lifetime expectancy, preferable payout profile, bequest motive, and preferences on portfolio composition. Specifically, the decisions are optimal under the expected CRRA utility function and are subject to the constraints characterizing the individual. The problem is solved via a model that combines two optimization approaches: stochastic optimal control and multi-stage stochastic programming. The first method is common in financial and actuarial literature, but produces theoretical results. However, the latter, which is characteristic for operations research, has practical applications. We present the operations research methods which have potential to stimulate new thinking and add to actuarial practice.

@&#INTRODUCTION@&#
Recent years have seen a decided worldwide shift from defined benefits (DB) pension plans toward defined contribution (DC). The number of participants in DC plans is quickly expanding because these plans are not only easier and cheaper to administer, but also more transparent and more flexible. Furthermore they can better capture the individual’s needs. However, DC plans also pose some challenges, namely, the participants often do not know how to manage their saving and investment decisions.In some countries, such as the United States, most DC decisions are made by the individual with little advice from the employer. In contrast, in countries such as Denmark, the sponsoring organizations, including life insurers, suggest a dynamic investment strategy suitable to the individual’s age and risk preferences. Individuals in most of the countries also have to decide on how to spend the amount accumulated on their pension savings account. Should they follow a certain withdrawal rate rule, or should they purchase annuities that will provide with regular payments during retirement? This task is not easy, especially when life insurers offer a wide variety of annuity products (e.g. fixed or variable, deferred or immediate, term or whole-life). How can the individuals know, which product is best for them?There is one more decision they have to keep in mind. Namely, what to do with the savings in case of their death? Do they want to bequeath the savings to their heirs, or maybe purchase an annuity product combined with a life insurance policy? What level of death sum should they choose?We argue that aforementioned decisions should differ for each individual and should account for the following factors: (1) economical characteristics – such as current value on the pension savings account, expected pension contributions (mandatory and voluntary), and expected income after retirement (e.g. retirement state pension), and (2) personal characteristics – such as risk aversion, lifetime expectancy, preferable payout profile, bequest motive, and preferences on portfolio composition.To help the individuals manage the savings and investment decisions we build an optimization-based financial planning model. Because such a model can be complicated and difficult to solve, we propose to combine two popular methodologies: multi-period stochastic programming (MSP) and stochastic optimal control (SOC), also referred to continuous-time and state dependent dynamic programming. The latter method is common in financial and actuarial literature, and its main advantage is the analytical form of the optimal solution, which is easy to understand and implement. See, for example, Yaari (1965), Samuelson (1969), Merton (1969, 1971), Richard (1975) and Campbell and Viceira (2002), for optimal decisions regarding investment, consumption and sum insured. However, the main drawback of this approach is that the explicit solution in many cases does not exist.On the contrary, MSP, which is characteristic for operations research, has practical application and complement SOC approach, especially in terms of adding realistic constraints and modeling more complicated processes. In stochastic programming approach we model the possible outcomes for the uncertainties in a scenario tree, and numerically compute the optimal solution at each node of the tree. See, for example, Carino, Myers, and Ziemba (1998) and Carino and Ziemba (1998), who formulate a financial planning model for one of the biggest Japanese property and casualty insurer, Mulvey, Simsek, and Pauling (2003), who present a multi-period stochastic network model for integrating corporate financial and pension planning, and Mulvey, Simsek, Zhang, Fabozzi, and Pauling (2008) who expand this work by adding the borrowing decisions. The applications of MSP to individual asset-liability management can be found, for example, in Ziemba and Mulvey (1998), Kim, Mulvey, Simsek, and Kim (2012) and Konicz and Mulvey (2013). However, the main drawback of this optimization method is the limited ability to handle many periods under enough uncertainty about future asset returns and human lifetime. Especially, modeling the entire lifetime of an individual is challenging in terms of computational tractability.To benefit from both optimization approaches and to avoid the aforementioned drawbacks, we combine multi-stage stochastic programming and stochastic optimal control into one mathematical framework. We solve the problem using MSP approach up to some horizon T, and to ensure that the model accounts for the entire lifetime of an individual, we insert the end effect in the objective function of MSP. The end effect is determined by the optimal value function calculated explicitly via SOC technique. This function covers the period from the horizon T to the individual’s death. Combining these two optimization approaches is new and has only been investigated in Geyer, Hanke, and Weissensteiner (2009) and Konicz, Pisinger, Rasmussen, and Steffensen (2014). The presented MSP framework can be posed and solved with reasonable efficiency, while providing reliable and robust insights. These policy rules can further be implemented using Monte Carlo simulations, which are simpler and more likely to be employed in practice than complicated stochastic models, see, e.g., Mulvey et al. (2008).The paper is organized as follows. Section 2 describes the economical and personal characteristics that we take into account when advising on how to manage the pension savings. Section 3 presents the financial planning model. Section 4 explains the intuition behind the optimal solution obtained from MSP model. Section 5 includes numerical examples illustrating the application of the model for different individuals. Section 6 concludes. Finally, Appendix A introduces multi-stage stochastic programs and Appendix B presents details of the explicit solution derived via SOC approach.We argue that management of savings in DC pension plan should account for economical and personal characteristics, and it should be tailored to a customer. Our model takes into account the following factors.The value of the individual’s account, Xt, develops according to the initial savings x0, contributed premiums, capital gains including dividends, insurance coverage, accredited survival credit and the benefits paid after retirement—all these elements are described below.Until retirement the individual contributes to the savings account. The premiumsPttotconsist of a fixed percentage pfixed of the labor income lt, which is in many countries mandatory and decided by the employer, and the additional voluntary contributions, pvollt. The latter may be of interest of an individual who wishes to increase the future benefits.Pttot=(pfixed+pvol)lt,pfixed∈[0,1],pvol∈[0,1−pfixed].The labor income ltis deterministic and increases with a salary growth rate yl,lt=l0eylt,where l0 is the level of the labor income at the current time t0. Both the premiums and the labor income are positive only until retirement, t < TR; otherwise 0.After retirement the individual has no other income than state retirement pension,btstate. This income is typically financed on a pay-as-you-go basis from general tax revenues, and ensures a basic standard of living for old age. It often depends on the level of the individual’s income before retirement, but not on the income from the DC plan. We assume that the state retirement pension consists of the life long, yearly adjusted payments.The individual is risk averse and obtains a utility u from the total pension benefitsBttotand from leaving money upon death to the heirs, Beqt. The utility function is characterized by a constant relative risk aversion (CRRA) 1 − γ and time dependent weights wt:u(t,Bttot)=1γwt1−γ(Bttot)γ,u(t,Beqt)=1γwt1−γ(Beqt)γ,where γ ∈ ( − ∞, 1)∖{0}, whereas γ = 0 implies the logarithmic utility. Time dependent weights wtinclude an impatience weighted interest factor ρ,wt=e−ρt/(1−γ),which allows the individual to specify how important the benefits and the death sum are at the present moment relatively to how important these payments would be in the future. Thus, ρ = 0 implies that the current and future payments are equally important for the individual, and ρ > 0 reflects that the weight on the future payments decreases exponentially with time.The individual has uncertain lifetime, which we model with two kinds of mortality rates: μtand νt. The first function denotes the subjective mortality rate and reflects the individual’s expectation about her mortality rate. The lifetime expectancy is either based on the individual’s lifestyle and health status or simply on the individual’s opinion. For example, does she live a healthy lifestyle and therefore expect to live longer than others? Is she a regular smoker or maybe seriously ill? Does she expect to live longer than an average individual despite a smoking habit? The choice of the subjective mortality rate μtaffects the decisions regarding the payout profile as well as the decision about purchasing life insurance.The second function, νt, also referred to pricing mortality, is used by life insurers for calculating the price of their life contingent products. Especially in European countries, due to legislation, both the survival credit and the price for life insurance are calculated under unisex criteria, and the individual is not even subject to health screening, see Rocha, Vittas, and Rudolph (2010). A person with a cancer disease, heart attack, a regular smoker or an overweight person has the right to the same benefits as a healthy individual. Pricing mortality rates are typically reported in the actuarial life tables.Upon retirement, the individual starts receiving retirement income consisting of two types of benefits: the state retirement pensionbtstate,and the benefits from the DC plan Bt:Bttot=btstate+Bt,t≥TR.The benefits from the DC plan, also known as the labor market pension (occupational pension, 2nd pillar) and the individual retirement accounts (private pension, 3rd pillar), are one of the most important decision variables in the optimization problem. Individuals can choose among the following possibilities:•Duration of the payments. Is the individual interested in receiving a lump sum benefit upon retirement, regular payments over a period of 10 or 25 years (term annuity), or regular payments as long as she is alive (life annuity)? We can control the duration in the model by choosing the appropriate value ofT˜,which denotes the time of receiving the last benefit.Payout curve. If interested in annuities, does the person prefer to receive constant, increasing or maybe decreasing payments? By inserting the right parameters in the utility function: the impatience weighted interest factor ρ and risk aversion 1 − γ, we can control the payout curve. Another important factor to consider is the lifetime expectancy, which depends on the subjective mortality rate μt. A person with health problems might want to spend more of her savings during the first years of retirement, whereas a person who expects to live long would want to make sure she would never outlive her resources.Size of the payments. To increase the size of the benefits, the individual can either increase the premiums or choose a more aggressive investment strategy, for example, by choosing equity-linked (variable) annuities, as defined in, e.g., Blake, Cairns, and Dowd (2003). These products differ from traditional fixed rate annuities that offer a constant level of payments during retirement in a way that their size is regularly adjusted to account for capital gains and losses. This adjustment is necessary to avoid the danger of running out of the resources before death. However, equity-linked annuities are directly linked to market returns, therefore are risky.Not surprisingly, the marital status and dependants play a crucial role in the choice of the pension product. A single individual would be interested in a life annuity. In this type of contract an individual agrees to give up the savings upon death, which are then inherited by the life insurer. Thus, in contrast to other products, life annuities provide an additional return arising from mortality risk sharing. This return is often called a survival credit and is proportional to the value of the individual’s savings, i.e. νtXt.The individual with dependants would bequeath some death sum Beqtto her heirs. We assume that upon death, life insurer inherits the value of the savings, but pays out Beqtto the dependants. The size of death benefit can be proportional to the value of the account through a factor inst,Beqt=instXt,or can be a decision variable in the program. In the latter case, we introduce an additional parameter k, which defines the strength of the bequest motive relatively to the received benefits. The actuarially fair price for the insurance coverage is equal to νtBeqt. Because choosing larger death benefit leads to lower annuity payments, and vice versa, it is not easy to find the right balance between the level of annuity payments and the level of death sum.Retirement savings can be allocated to a number of financial assets. In the United States the individuals have lots of flexibility and can invest in leveraged financial products. In countries such as Denmark, the individuals have a limited list of assets to choose from. For example, life insurers offering unit-linked products allow for investments within their own list of mutual funds and ETFs, which replicate stock indices for different regions and industries, corporate and government bonds with different maturities, commodities, etc.Our model allows the individual to include her preferences regarding asset allocation. For simplicity, we consider portfolios composed of positions in three asset classes: cash (corresponding to a 3-month short rate), an aggregate bond index including both government and corporate bonds with different durations, and a stock index.Stochastic programming is a general purpose framework for modeling optimization problems. We include a brief introduction to stochastic programming in Appendix A, whereas more details can be found in the classical books on the subject, for example, Birge and Louveaux (1997), Zenios (2008), and Shapiro, Dentcheva, and Ruszczynski (2009). Appendix B includes a description of the mortality model necessary for generating the scenario trees.The range of possible outcomes for the uncertainties is modeled by a scenario tree, which consists of nodesn∈Ntuniquely assigned to stages t = 1, …, T. Each node has a probability probn, so that∀t∑n∈Ntprobn=1. At the first stage we have only one root node n0, whereas the number of nodes at other stages corresponds to possible values of random vector ξt. Every noden∈Nt,t > t0, has a unique ancestor n−, and every noden∈Nt,t < T, has children nodes n+. The nodes with no children are called the leaves. A scenarioSnis a set of all predecessors of a leaf n: n−, n−−, …, n0, or equivalently, a single branch from the root to the leaf. The number of scenarios in the tree equals the number of leaves.When applying stochastic programming one often speaks of the curse of dimensionality. The size of the tree grows exponentially with the number of periods, and the problem quickly becomes too large to be computationally tractable. Therefore, to solve the problems with a long-term horizon T, the scholars often choose longer intervals between the stages, see, e.g., Carino et al. (1998) and Dempster, Germano, Medova, and Villaverde (2003), gradually reduce the number of scenarios, see, e.g., Heitsch and Römisch (2009a); 2009b), or, as applied in this paper, approximate the problem upon horizon by solving a simplified model via stochastic optimal control approach, see, e.g., Geyer et al. (2009) and Konicz et al. (2014).A considerable amount of literature focuses on scenario generation methods for stochastic programming. Among different approaches we can distinguish sampling, simulation, scenario reduction techniques and moment matching methods. For the purpose of our study we have chosen the technique that matches the statistical properties (the first four moments and the correlations) of the underlying processes. This approach has been introduced by Høyland and Wallace (2001) and Høyland, Kaut, and Wallace (2003), who suggest solving a nonlinear optimization problem that minimizes the distance between the properties of the generated tree and of the underlying process. Both the asset returns and the probabilities of each node are the decision variables in this formulation.During recent years several authors have been investigating possible improvements of the moment matching approach. Ji, Zhu, Wang, and Zhang (2005) show that if one can predetermine the outcomes of the asset returns (e.g. by simulation) and choose the probabilities of the nodes to be the only variables in the model, then it is possible to match the statistical properties of the underlying process with a linear optimization problem. This method is further improved by Xu, Chen, and Yang (2012) who combine the simulation, the K-means clustering approach, and the linear moment matching, and by Chen and Xu (2013), who remove the simulation component and applies the K-means clustering method directly onto the historical dataset.For the purpose of our study, we have to generate a scenario tree that includes the uncertainties of both the assets returns and the individual’s lifetime. We are not familiar with any literature that explains how to combine two independent sources of uncertainty into one scenario tree, nor how to include the events of death in a scenario tree, therefore, we developed a new algorithm to generate the scenario trees. We have already applied this procedure in Konicz and Mulvey (2013), however we did not explain it in detail.1.Generate a tree based on a chosen structure (number of periods and branching factors).Randomly choose the nodes at which death occurs. Denote them byn∈Ntdeadand remove all their children nodes. All other nodes belong to the setNtaliveas shown on Fig. 1.Assign the transition probabilitiesprob^nto nodesn∈Ntdead. These probabilities define the chances of a person dying between the two stages and express the individual’s lifetime expectancy. We follow the standard actuarial notation and denote the probability that a y + t-year old individual survives the next period byp˜y+tand the probability that a y + t-year old individual dies between stages t and t + 1 byq˜y+tso thatp˜y+t+q˜y+t=1. (For the mortality rate model see Eq. (B.1) in Appendix B.) Thus, for eachn∈Nt,the children nodes at which death occurs,n+∈Nt+1dead,must satisfy∑n+∈Nt+1deadprob^n+=q˜y+t.Having fixed the transition probabilitiesprob^nof nodesn∈Ntdead,∀t, we can choose any of the aforementioned moment matching algorithms and add the asset returns. Let the transition probabilities of nodesn∈Ntalive,∀t, be random variables in the optimization program. Then, either let the asset returns be random variables and apply Høyland and Wallace (2001), or predetermine the asset returns and apply the algorithms presented in Xu et al. (2012) or Chen and Xu (2013). (The parameters for the asset returns are shown in Table B.4in Appendix B.)After specifying the transition probabilitiesprob^nand the asset returns at each node, we can calculate the probability of each scenario in the tree as a product of the transition probabilities of all the nodes in a given scenario, see Fig. 1. Specifically, assuming that the individual is y-years old at the initial stage t0, the probability of the individual surviving until stage t + 1 is equal top˜y·…·p˜y+t−1·p˜y+t=tp˜y·p˜y+t=t+1p˜y,and the probability of the individual dying between stages t and t + 1 is equal top˜y·…·p˜y+t−1·q˜y+t=tp˜y·q˜y+t. In what follows,∑n∈Nt+1aliveprobn=t+1p˜y,∑n∈Nt+1deadprobn=tp˜y·q˜y+tand∑n∈(Nt+1alive+Nt+1dead)probn=tp˜y.To ensure that the asset returns are independent from the events of death, repeat the algorithm for a larger number of trees.The presented approach can be applied in various financial optimization problems. For example, one can follow the same procedure to generate a scenario tree with the uncertainty around the labor income (given that the labor income is independent of the asset returns).Once generating a scenario tree, we can calculate the investment, annuity payout and bequest decisions. The optimal solution depends on the possible future realizations of the asset returns and death events, and on the decisions made in the previous stage. For example, as illustrated in Fig. 2, the yearly returns on bonds and stocks at node n2 are 0.103 and 0.261, respectively, whereas the yearly returns on bonds and stocks at node n3 are − 0.013 and − 0.138, respectively. The optimal benefits at these nodes are EUR 41,900 and EUR 34,200, and the optimal bequest amount is EUR 209,300 and EUR 171,000, respectively. The optimal asset allocation is similar at both nodes (61 percent and 39 percent versus 60 percent and 40 percent in bonds and stocks, respectively), however to rebalance the portfolio to the given allocation, at each node the individual sells different amounts of the assets.We define the optimization model by introducing the following parameters and decision variables depending on the period t ∈ [t0, T], noden∈Nt,and asset classi∈I:ParametersTRretirement timethe end of decision horizon and the beginning of the remaining period modeled by the end effectexpiration of the contract, i.e. the last benefit is paid outprobability of being at node ninitial value of savingsminimum level of savings upon horizon Tstate retirement pension received at time tminimum level of benefits received at time tlabor income at time tfixed percentage of the labor income defining the mandatory premiumsfixed percentage of the labor income defining the maximum voluntary premiumsproportion of the savings defining the death sumweight on the bequest motive relatively to the size of the benefitsprobability that a y-year-old individual dies during the following period (individual’s expectation)probability that a y-year-old individual dies during the following period (insurer’s expectation)return on asset i at node n corresponding to stage t.Decision variablesXi,t,n→amount allocated to asset class i, at the beginning of period t, at node n, before rebalancing and any cash-flowsamount allocated to asset class i, at the beginning of period t, at node n, after rebalancing and any cash-flowsamount of asset class i purchased for rebalancing in period t, at node namount of asset class i sold for rebalancing in period t, at node nbenefits (annuity payments) from the DC pension plan received in period t, node ntotal benefits received in period t, node ntotal premiums (mandatory and voluntary) paid in period t, node ndeath sum paid to the heirs upon the individual’s death in period t, node nThe objective function, Eq. (1), which we aim to maximize, consists of three terms: (i) the expected utility of total retirement benefits paid while the person is alive, (ii) the expected utility of death sum paid to the heirs upon the individual’s death, and (iii) the end effect described in detail in Appendix B. The budget constraint, Eq. (2), specifies the cash-flows accompanying the savings account: the incoming payments (capital gains, the amount gained from the sales of the securities, premiums, and survival credit) and the outgoing payments (the amount spent on the purchase of new securities, annuity payments, and insurance coverage). The next constraint, (3), defines the asset inventory balance. We first account for the returns earned during the previous period, Eq. (4), and then rebalance the amount by purchasing or selling a given asset. In (5) we define the total premiums paid to the savings account as the sum of the mandatory and voluntary contributions. Constraint (6) defines the total benefits as the sum of the state retirement pension and the annuity payments received from the DC plan. By including Eqs. (7) and (8), we ensure that the benefits and the value of the savings do not fall below the certain pre-specified levelsbtminandxTmin,respectively. Constraint (9) defines the death benefit as a fraction of the savings, whereas (10) defines the actuarially fair survival credit that the individual receives for each period she survives. If the individual wishes to bequeath exactly the value of the savings, i.e. inst= 1, then the survival credit is equal to the price of the death benefit, and the last two terms in the budget constraint (2) cancel out. In a case when the individual is interested in the optimal death sum, constraint (9) is no longer necessary and should be removed. Eqs. (11) and (12) define the limits on portfolio composition. These can reflect the regulatory constraints, for example, the individual is not allowed to either hold a short position in a given asset i or to borrow money to invest in this asset (di= 0 and ui= 1), or they can reflect the individual’s preferences on portfolio composition. Finally, we include Eq. (13) to distinguish between the purchases and sales, and to ensure that the annuity payments and the death sum are positive.(1)maximize∑s=max(t0,TR)T−1∑n∈Nsaliveu(s,Bs,ntot)·probn+∑s=t0T−1∑n∈Nsalivekq˜y+s×u(s,Beqs,n)·probn+∑n∈NTaliveV(T,∑iXi,T,n→)·probn,subject to(2)X1,t,n=X1,t,n→+∑i≠1Xi,t,nsell−∑i≠1Xi,t,nbuy+Pt,ntot1{t<TR}−Bt,n1{t≥TR}+Rt,nsurv−qy+tBeqt,n,t∈{t0,…,T−1},n∈Ntalive,(3)Xi,t,n=Xi,t,n→+Xi,t,nbuy−Xi,t,nsell,t∈{t0,…,T−1},n∈Ntalive,i≠1,(4)Xi,t,n→=(1+ri,t,n)Xi,t−1,n−,t∈{t1,…,T},n∈Ntalive,i∈I,(5)Pt,ntot≤(pvol+pfixed)lt,t∈{t0,…,T−1},n∈Ntalive,(6)Bt,ntot=Bt,n+btstate,t∈{t0,…,T−1},n∈Ntalive,(7)Bt,ntot≥btmin,t∈{t0,…,T−1},n∈Ntalive,(8)∑iXi,T,n→≥xTmin,n∈NTalive,(9)Beqt,n=inst∑iXi,t,n→,t∈{t0,…,T−1},n∈Ntalive,(10)Rt,nsurv=qy+t∑iXi,t,n→,t∈{t0,…,T−1},n∈Ntalive,(11)Xi,t,n≤ui∑iXi,t,n,t∈{t0,…,T−1},n∈Ntalive,i∈I,(12)Xi,t,n≥di∑iXi,t,n,t∈{t0,…,T−1},n∈Ntalive,i∈I,(13)Xi,t,nbuy≥0,Xi,t,nsell≥0,Bt,n≥0,Beqt,n≥0,t∈{t0,…,T−1},n∈Ntalive,i∈I.Expression 1{( · ) = t} denotes an indicator function equal to 1 if ( · ) = t and 0 otherwise.Stochastic programming is a general purpose framework for modeling optimization problems where an objective function can take a variety of forms. Rather than finding a generic optimal policy, the optimal decisions are computed numerically at each node in the scenario tree. MSP can easily address realistic considerations and constraints, as long as they have an algebraic form, see, e.g., Carino et al. (1998) and Carino and Ziemba (1998), who formulate a financial planning model for one of the biggest Japanese property and casualty insurer. However, the numerical solution may be difficult to interpret.On the contrary, the analytical form of the optimal solution is the main advantage of a stochastic optimal control approach. SOC, however, is best applicable for simple models because deriving the explicit solution for many problems is not trivial (as, for example, for the problem presented above). Nevertheless, to gain more insights about the optimal solution for our model, we take a closer look at the explicit formulae obtained via SOC approach for a simplified model.Specifically, to be able to derive the explicit solution we have to simplify the model by introducing the following assumptions: (i) a continuous-time setting, (ii) no upper or lower bounds on the variables (such as those in Eqs. (7)–(8) and (11)–(13)), (iii) a risk-free return on cash, and (iv) either a deterministic or optimal death benefit. Otherwise, obtaining the analytical solution is non-trivial. Because the explicit solution for the case with two sources of retirement income (state retirement pension and benefits from the DC plan) has not been presented in the literature, we derive the optimal decisions in Appendix B.The optimal investment decision for the presented model is of the form obtained by Richard (1975). Equation (B.9) for optimal proportion in risky portfolioΠt*,indicates that the optimal investment decision depends on the risk aversion, the market parameters, the value of the savings, and the present value of the expected retirement state pension gt; whereas Eq. (B.10) for the proportions between the risky assets θispecified by the mutual fund theorem, indicates that these proportions depend on the expected returns of the risky assets, their volatilities, and the correlations between them. If the individual expects no retirement state pension, the optimal strategy suggests a fixed-mix portfolio, as shown by Merton (1969, 1971). Otherwise the individual should decrease the percentage in the risky portfolio as gtdecreases.Not less important is to determine the optimal annuity payments. In particular, we investigate whether there exists a withdrawal rate, according to which the accumulated savings should be spent, as in, e.g., Bengen (1994) and Horneff, Maurer, Mitchell, and Dus (2008).To understand formula (B.6) for the optimal benefits sumBt*,let us focus on the individual upon retirement (i.e. 65-year old), and let us assume the risk-free investment, so we can separate the annuity payments decision from the investment decision. Given that the subjective mortality rate is equal to the pricing mortality rate, μt= νt, the payout curve is: constant if the impatience weighted interest factor is equal to the risk-free rate, ρ = r, decreasing for impatient individuals, ρ > r, and increasing for patient ones, ρ < r. The parameter γ controls the slope of the payout curve. For the less risk averse individuals (such as γ = −2), the difference between the benefits received at the beginning and at the end of retirement is bigger than for moderately risk averse persons with γ = −4. The optimal payout profile for different choices of γ and ρ is illustrated on Fig. 3(a). None of these payout profiles is better than the other; they are all optimal for individuals with different preferences.Investing in risky assets directly affects the size of annuity payments. To avoid the danger of running out of the resources before the individual’s death, the benefits must be adjusted each year to account for the capital gains and losses. Nevertheless, despite these adjustments, we can still control the expected payout curve; we can choose parameters (γ, ρ, μt) such that the expected payout curve is constant, increasing or decreasing. Given the optimal investment strategy, Eq. (B.9), we obtain constant expected annuity payments forρ=r+(2−γ)(α−r)22σ2(1−γ)and μt= νt. Any other choice of ρ and μtleads to either increasing or decreasing payout curve, as shown in Fig. 3(b) and (d).Following this argumentation, one can recognize that formula (B.6) defines equity-linked annuity payments. The more aggressive investment strategy, the higher expected benefits. A person interested in a constant payout curve should expect: EUR 51,500 given γ = −2 and ρ = 12.6 percent, EUR 39,700 given γ = −4 and ρ = 11.4 percent, and EUR 24,800 given the risk-free investment, ρ = r and any choice of γ. Formula (B.6) also shows, that indeed there exists an optimal withdrawal rate1/a¯t*that depends on the constants γ and ρ characterizing the individual’s risk tolerance and impatience, and on the subjective mortality rate μt. Interestingly, the withdrawal rate is not only a fraction of the savings at a given time, but also of the present value of the expected retirement state pension. Accordingly, the size of the benefits expected from the state retirement pension affects the optimal size of the payments from the DC plan. The optimal withdrawal rates for different values of γ, ρ and μtare presented in Table 1.Finally, Fig. 3(c) and (d) shows how the subjective lifetime expectancy affects the optimal payout curve. The choice of μt= 5νtindicates that the individual expects to die earlier than an average individual assumed by the life insurer. Specifically, for the chosen mortality model, such a choice of μtcorresponds to the expected lifetime of 78.7 years, with 70.2 percent chances of survival until age 75 and only 18.5 percent chances of survival until age 85 (given that the individual is alive at age 65). Independently of the choice of γ and ρ, the payout curve is no longer constant, but decreases proportionally to the probability of survival. This result indicates that a life annuity with a decreasing payout curve is preferable than, for example, a term annuity, which pays constant benefits for 10 or 25 years. A similar conclusion has been drawn by Milevsky and Huang (2011), who argue that “the optimal ...behavior in the face of personal longevity risk is to consume in proportion to survival probabilities—adjusted upward for pension income and downward for longevity risk aversion—as opposed to blindly withdrawing constant income for life”.Eq. (B.7) for the bequestBeqt*shows that the optimal death sum is a linear function of the optimal annuity payments. Both decisions are proportional by the factor (kμt/νt)1/(1 − γ), which changes with the strength of the bequest motive k, risk aversion, and the relation between the subjective and pricing mortality rates. Therefore, similarly as expected annuity payments, the expected death sum can be constant, increasing or decreasing, whereas the actual size of the death sum depends on the realized portfolio returns. Formula (B.7) defines moreover the optimal death sum rate as a proportion1/a¯t*(kμt/νt)1/(1−γ)of the current savings and the present value of expected state retirement pension.To present the application of the model we have chosen a number of individuals with different economical and personal characteristics. Even small-scale optimization problems, such as problems based on 2160 scenarios (four periods with branching factors {10,6,6,6}) with 12,075 constraints and 9546 variables, are sufficient to present the applications of the model. The MSP formulation can be implemented on a personal computer and takes only a few seconds to run. We implemented the program on a Dell computer with an Intel Core i5-2520M 2.50  GHz processor and 4GB RAM, using MATLAB 8.2.0.713 (R2013b), and GAMS 24.1.3 with non-linear solver MOSEK 7.0.0.75. The optimization module can also be solved with a linear or quadratic solver, such as CPLEX, but the objective function has to be linearly or quadratically approximated. Furthermore, to check the robustness of the results, we rerun the model for 50 different scenario trees. Thus, the results are based on 2160 × 50 = 108, 000 scenarios.The numerical examples provide some guidelines to individuals in DC pension plans on how to manage their savings both before and after retirement. These guidelines can also be used by life insurers for designing pension products that are highly customized to the individuals’ needs. We show that pension savings management is based on three important decisions: investment, annuity payments and the level of death sum, and that these decisions vary substantially for individuals with different economical and personal preferences. Furthermore, the optimal decisions depend on the realizations of the risky assets, and are regularly adjusted to account for the changes in the financial market.Because the optimal solution incorporates the investment in risky assets while guaranteeing income as long as the person is alive, it defines optimal equity-linked life annuities. Depending on the time of the purchase of the product, we distinguish between immediate and deferred annuities. Both products start paying out the benefits upon retirement, but deferred annuity is purchased when the individual is still employed. Furthermore, during the deferment period the premiums are invested according to the optimal investment strategy, and the life insurance policy is effective.We start with a 65-year old female.11We follow the approach common for the most European countries, where the price of annuities does not depend on the gender, i.e. even though women are expected to live longer, they are entitled to receive the same benefits as men.She is just retiring and is interested in purchasing an immediate equity-linked life annuity. She has saved x0 = 650, 000 (EUR) on her pension account, has moderate risk aversion 1 − γ = 5, and has an expected lifetime as assumed by the insurer (μt= νt), i.e. on average until age 89.1. During retirement she expects the benefits from the state,btstate=4000(EUR). When asked about the preferable payout profile, she chooses life long increasing payments. Such a payout curve can be obtained for, e.g., ρ = 0.04. She has a bequest motive but is not sure how much money to bequeath to her heirs, and how it will affect the level of the annuity payments. Therefore, we investigate three cases: no bequest motive, k = 0, the death sum equal to the level of savings, inst= 1, and the death sum equal to the sum of the benefits received over 5 years (obtained for k = 51 − γνt/μt= 3125). The life insurer does not allow for having a short position in any asset or for borrowing money to invest in any asset, thus di= 0 and ui= 1.Sections (a), (b) and (c) in Table 2present the optimal decisions for a person with such characteristics. The first 10 years of the retirement are modeled using MSP approach with the intervals between the decisions of Δt = {1, 3, 3, 3} years. Thereafter, we approximate the model with its simpler continuous-time version that can be solved explicitly using SOC approach.Reading Table 2, we can observe three important facts. First, the optimal investment strategy is almost identical for the considered different weights on the bequest motive. This result can be surprising at first, but Eq. (B.9) for the optimal investment in risky assets, states that the only parameters that influence the investment decisions are the market parameters, risk aversion, the current level of savings, and the present value of expected retirement state pension. The majority of savings upon retirement is invested in bonds (57 percent) and stocks (40 percent), and these proportions change slowly so that the individual invests less in risky assets as the present value of expected state retirement benefits decreases.Second, as chosen by the individual, the expected annuity payments increase. A person without a bequest motive would receive the highest payments, not only because she does not pay for the insurance coverage, but also because she receives a survival credit for each year she survives. Upon retirement our individual will obtain on average the total yearly benefits of EUR 42,700, 36,200 and 37,100, respectively for the cases without a bequest motive, with a death sum equal to the level of savings, and with an optimal death sum given k = 3125. Twenty years after retirement the payments are expected to increase to EUR 56,800, 47,600 and 49,400, respectively.Third, looking closer at the case with the optimal death sum, we find that the death benefit increases with time, and that it is much lower than the value of savings. As explained in Sec. 4, the optimal death sum is proportional to the annuity payments by a factor (kμt/νt)1/(1 − γ) = 5. Therefore, increasing annuity payments imply increasing death benefit. Furthermore,Beqt*is much lower than the value of savings for most of the retirement; it is higher than the value of savings only during the very late years (e.g. later than age 95), when the individual has already spent most of her savings.Recall that Table 2 presents the means across the nodes assigned to each time period, across the scenarios, and across different scenario trees. Equity-linked payments depend on the realizations of the risky assets, and their payments may vary significantly, especially after a longer period such as 10 years. Even though the expected benefits are increasing, if for 10 years in a row the risky assets bring losses, our individual may receive a significantly lower amount than expected. Fig. 4(a) (left) emphasizes this fact and shows that in the worst case scenario the individual with an optimal death sum may end up only with EUR 23,800 upon age 75 instead of expected EUR 42,500. On the other hand, after a long period of higher asset returns than assumed, the benefits may even be twice as high as expected.To mitigate the risk of receiving too low payments, we can add a lower limit on the benefits’ size by adding constraints (7) and (8) in the MSP formulation. The results in Table 2, section (d), and Fig. 4(b), show that these constraints affect the optimal decisions. The asset allocation is more conservative during the first years of retirement, and leads on average to lower annuity payments and death sum. Other studies have shown that adding the guarantees to pension products increases the life insurer’s liabilities, and thus prevents them from offering greater investment opportunities, see e.g., Guillén, Konicz, Nielsen, and Peréz-Marín (2013). In this example, a guarantee that the minimum payment never falls belowbtmin=27,000(EUR) is only added for the first 10 years after retirement. Nevertheless, such a guarantee reduces the expected yearly benefits from EUR 37,100 and 49,400 (upon ages 65 and 85) to EUR 36,300 and 49,100, respectively.Finally, what can we recommend if our individual has a bad health condition and expects to die earlier than an average individual? To illustrate such a case, we choose μt= 5νt, that is, the expected lifetime of our individual is 78.7 years, which is approximately 10 years shorter than what the insurer assumes. Given that as in many European countries the survival credit and the price for life insurance are calculated under unisex criteria and are not subject to health screening, the individual should spend more savings during the first years of the retirement. The optimal solution (Table 2, section (e)) clearly suggests to change the payout curve so that the expected benefits decrease proportionally to the probability of survival,tp˜y,and to increase the death sum. The optimal investment strategy remains similar as in the case with the average lifetime expectancy.This section focuses on the decisions that an individual faces during the accumulation phase (i.e. before retirement). Our person is a 45-year old female with initial savings of x0 = 130, 000 (EUR) and pension contributions of 10 percent of her salary. The yearly salary, lt= 50, 000 (EUR), increases every year with yl= 2 percent. Having an average lifetime expectancy and anticipatingbtstate=4000(EUR) from the retirement state pension, she would like to purchase an annuity that starts constant payments in 20 years (upon her retirement). She describes herself as moderate risk averse (e.g. γ = −4), therefore would like to invest some of her savings in risky assets. She has no further preferences on the portfolio composition but she faces short sales constraints on all assets.The optimal decisions in this example are the investment strategy before and after retirement and the annuity payments after retirement. We also investigate the cases with and without a bequest motive. We divide the period of 20 years into four periods of 5 years each—we make the decisions every fifth year. The solution after retirement is calculated analytically using Hamilton–Jacobi–Bellman techniques for the simplified model.Table 3shows that, similarly to the previous case, the bequest motive has a minor effect on the optimal asset allocation. The overall investment strategy suggests to decrease the risk as the individual ages. The optimal portfolio consisting of 0 percent in cash, 41 percent in bonds, and 59 percent in stocks, (upon age 45), smoothly changes to {1 percent, 59 percent, 40 percent}, respectively, upon age 75. For the period [t0, T), we assume that cash has a volatility of 3.8 percent and that the individual is not allowed to have a short position in any asset or to borrow money to invest in any asset, whereas for the period[T,T˜)the model is simplified: cash is assumed to be risk-free and no constraints on the portfolio allocation are imposed. Otherwise finding the analytical solution is non-trivial. This difference in the assumptions causes the fluctuations in cash holdings between the periods covered by two different optimization approaches.The bequest motive affects the level of annuity payments, but not the payout curve: the expected benefits are constant. A person without a bequest motive will receive the highest benefits,E[Bttot*]=47,900(EUR) per year, a person with a death sum equal to the value of savings (inst= 1) will receive payments of EUR 41,600 per year, and a person with an optimal death sum given parameter k = 51 − γ= 3125 will receive payments of EUR 41,800 per year. Notice how small the difference between the annuity payments in the last two cases is. Because the probability that a 45-year old person survives until age 65 is high, the price for the life insurance is low. Therefore, the value of savings upon retirementXT*is similar in both cases, and implies the annuity payments of approximately the same level. After retirement the optimal death sum is constant and proportional to the annuity payments by factor 5.Nevertheless, the numbers in Table 3 are the means across the scenarios, whereas their actual values depend on the realizations of the asset returns. Figure 5(a) (left) shows the probability distribution of the savings upon retirement for the case with the optimal death sum (for one scenario tree). After contributing to the pension account for 20 years and allocating the portfolio according to the optimal investment strategy, the individual should expect to save up EUR 596,700 upon retirement. This amount gives the expected total benefits of EUR 41,800, which is almost 60 percent of the individual’s salary level upon retirement.However, this amount can be much lower: in a scenario with long periods of negative returns, the person may end up with only EUR 200,000 on her savings account, which would provide the yearly retirement income of EUR 17,600. Thus, she may choose to increase the premiums by additional 5 percent and add a lower limit on the size of the savings upon retirement, for example,xTmin>290,000(EUR). This limit corresponds to the minimum level of benefitsbtmin=23,100(EUR). As illustrated in Table 3 and Fig 5(b), both the probability distribution of savings and the optimal asset allocation change. The probability distribution has shifted to the right and the investment strategy implies slightly more conservative portfolio.Is it possible to choose a higher limitxTminsolely by adjusting the investment strategy? The answer depends on the available assets and their returns’ distribution. To be certain that the value of savings will not fall below a pre-specified limit, we must employ a more conservative investment strategy. However, if the strategy is too conservative, it may not be possible to reach this level. For example, for the choice of the parameters as in Fig. 5(b), the program returns an optimal solution for all the considered 50 different scenario trees. If we increasexTminto EUR 350,000, the problem is feasible only for 15 out of 50 different scenario trees (30 percent), whereas forxTmin=380,000(EUR) the problem is feasible only for 2 percent of the scenario trees.Finally, are optimal deferred life annuities still attractive if one expects to die earlier than an average person? We investigate the case for μt= 5νt, i.e. the expected lifetime of the individual is 78.7 years and the probability that she survives until age 85 is only 18 percent. A closer look at the optimal decisions (Table 3, section (e)) reveals that it is optimal for the person to invest in deferred life annuities only if the payout curve is decreasing. The optimal withdrawal rate is proportional to the probability of survival, therefore she should spend more savings in the beginning of retirement. The initial payment is EUR 4000 higher than in the case with the average lifetime expectancy (compare with Table 3, section (c)), and the optimal death benefit increases significantly and stays above EUR 300,000 until age 72.

@&#CONCLUSIONS@&#
This paper provides some guidelines to individuals with defined contribution pension plans. We argue that the decisions regarding the asset allocation, the annuity payments, and the size of death sum should be highly customized. With several numerical examples we have illustrated how the optimal decisions depend on: (1) economical characteristics—such as current value on the pension savings account, expected pension contributions (mandatory and voluntary), and expected income after retirement (e.g. retirement state pension), and (2) personal characteristics—such as risk aversion, lifetime expectancy, preferable payout profile, bequest motive, and preferences on portfolio composition.To help individuals manage their pension savings, we have built a model that combines two optimization techniques: multi-stage stochastic programming and stochastic optimal control. This mixed approach has practical applications and generates results that are not only consistent with common knowledge about life-cycle asset allocation, but are also realistic. The presented model is flexible and can be applied either by financial advisers in countries where individuals have lots of flexibility in managing their pension savings, or by life insurers in countries where individuals are less involved in the savings and investment decisions. The framework can also be applied to discover reliable and robust policy rules, which can further be employed in practice using Monte Carlo simulations. Because the operations research methods are not common in the actuarial literature, we argue that the presented optimization approach has potential to stimulate new thinking and add to actuarial practise.Even though the paper shows an application of decision making in pension plans, it includes several contributions to the current literature focusing on optimization methods. First, we have further developed the approach of combining multi-stage stochastic programming and stochastic optimal control. Only a few papers have been investigating this approach, and this area is fairly unknown. Second, we defined a procedure for generating scenario trees with two independent sources of uncertainty: time of death and asset returns. Third, by including another source of retirement income in the objective function, we expanded the classical problem of optimal investment, consumption and life insurance, and (using SOC method) derived the explicit solution.This work could be improved in various ways. Investigation of the impact of the administration costs, transaction costs and taxes is definitely relevant from a practical point of view. Taxes are especially important, since in many countries life annuities are tax deferred investment vehicles, and therefore preferred to personal investment. Furthermore, one could incorporate in the model other sources of uncertainty such as stochastic mortality risk and uncertain salary progression.This appendix briefly introduces a multi-stage program with recourse. For a more detailed theory, see, e.g., Birge and Louveaux (1997), Zenios (2008) and Shapiro et al. (2009).To start with, let us formulate a two-stage version of the problem with recourse. We keep the notation from the aforementioned books, and define(Ω,F,P)to be a probability space, ω is an element (outcome) of a sample space Ω, and ξ = ξ(ω) is a random vector which belongs to the probability space with supportΞ={ξ∈RN|0≤ξ<∞}. We need two vectors for decision variables to distinguish between the anticipative and adaptive policy:•y0∈Rn0– a vector of first-stage decisions, which are made before the random variables are observed; the decisions do not depend on the future observations but anticipate possible future realizations of the random vector,y1(ξ)∈Rn1– a random vector of second-stage decisions which are made after the random variables have been observed. They are constrained by decisions y0 and depend on the realizations of the random vector ξ.Once a first-stage decision y0 has been made, some realization of the random vector can be observed. Then, the second-stage problem seeks a decision vector y1(ξ) that optimizes the function f1(y1(ξ); ξ) for a given value of the first-stage decision y0 and the random parameters {T0, 1(ξ), W1(ξ), h1(ξ) | ξ ∈ Ξ}. Combining both stages, the two-stage problem with recourse is an optimization problem in the first-stage variable y0, which maximizes the function f0(y0) and the expected value of the function f1(y1) of the second-stage decision:(A.1)maxy0f0(y0)+E[maxy1f1(y1(ξ);ξ)|F],s.t.W0y0=h0,T0,1(ξ)y0+W1(ξ)y1(ξ)=h1(ξ),y0≥0,y1(ξ)≥0.The recourse problem can be extended to a multi-period stochastic program, where observations and decisions are made at T different stages, which correspond to time instances when some information is revealed and a decision can be made. Let the random variable ξ have support Ξ1 × Ξ2 × ⋅⋅⋅ΞTand the observations are captured in the information sets{Ft}t=1TwithF1⊂F2⊂⋯⊂FT. For each stage t = 1, …, T,yt(ω)∈Rntdenotes the recourse decision variable vector optimizing the random objective function ft(yt(ξt); ξt), given the random parameters {Tt − 1, t(ωt), Wt(ωt), ht(ωt) | ξt∈ Ξt}. Then, the following actions are taken at each stage:decisiony0→observationξ1:=(T0,1,W1,h1)→decisiony1→⋯→observationξT:=(TT−1,T,WT,hT)→decisionyT,which can be formulated as the following multi-stage program:(A.2)maxy0f0(y0)+E[maxy1f1(y1;ξ1)+⋯+E[maxyTfT(yT;ξT)|FT]⋯|F1],s.t.W0y0=h0,Tt−1,t(ξt)yt−1(ξt−1)+Wt(ξt)yt(ξt)=ht(ξt),t=1,⋯,T,y0≥0,yt(ξt)≥0,t=1,⋯,T.By the tower property of conditional expectation we can rewrite the objective function of the above problem as:(A.3)maxy0,y1,⋯,yTf0(y0)+∑t=1TE[ft(yt;ξt)|F1].Finally, if the random vector ξthas a discrete distribution with a finite numbern∈Ntof possible realizations ξt, nwith the corresponding probabilities probn, the Eq. (A.3) can be rewritten as follows:(A.4)maxy0,y1,⋯,yTf0(y0)+∑t=1T∑n∈Ntft(yt,n;ξt,n)·probn,where yt, nis the decision variable corresponding to time t and realization n.The main drawback of multi-stage stochastic programs is the limited ability to handle many time periods under sufficient uncertainty. The scenario tree grows exponentially with each time period, therefore solving the problem becomes soon computationally intractable. To ensure, that the optimization problem covers the decisions for the entire lifetime of the individual, we incorporate the end effect in the objective function of the MSP formulation, Eq. (1). The end effect is equal to the optimal value function, which can be calculated explicitly using stochastic optimal control (Hamilton–Jacobi–Bellman techniques), and covers the remaining years, i.e. the interval[T,T˜). However, to be able to derive the explicit solution, we have to simplify the model by introducing the following assumptions: (i) a continuous-time setting, (ii) no upper or lower bounds on the variables (such as those in Eqs. (7)–(8) and (11)–(13)), (iii) a risk-free return on cash, and (iv) either a deterministic or optimal death benefit; as it has been done in the classical literature on optimal consumption and investment, Merton (1969, 1971), and life insurance, Richard (1975) and Kraft and Steffensen (2008).Assume that the economy is represented by a standard Brownian motion W defined on the measurable space(Ω,F),whereFis the natural filtration of W. The space is equipped with the equivalent probability measures: objective measurePand the martingale measureP*. The latter is used by the insurer to price the financial assets and life insurance, and to calculate the level of the benefits. The individual invests the proportion 1 − Πtof her savings in a risk-free asset (cash) with a constant interest rate r, and the proportion Πtin a mutual fund consisting of N − 1 assets, which prices are log-normally distributed. Then, the mutual fund follows the dynamics dSt= αStdt + σStdWt, whereα=∑i=1N−1θiαi,σ2=∑i=1N−1∑j=1N−1θiθjσij,dW=∑i=1N−1θiσiσdWi,θiis the proportion of asset i in the mutual fund, and {αi, σij} define the physical distribution of the returns. The assets are correlated with the coefficient corrij, thus σij= σiσjcorrij.The individual has an uncertain lifetime modeled by a time-heterogeneous continuous-time Markov chain Z, defined on a measurable space (Ω,F). The process Z has two states {0, 1} = {alive, dead}, indicating whether the person is alive or not. For s > t, the transition probabilities between the states are given by[P(Zs=0|Zt=0)P(Zs=1|Zt=0)P(Zs=0|Zt=1)P(Zs=1|Zt=1)]={[sp˜t1−sp˜t01],underP,[spt1−spt01],underP*,wheresp˜t=e−∫tsμτdτ,spt=e−∫tsντdτ,and μτand ντare the jump intensities of the process Z, i.e.,limdt→0P(Zt+dt=0|Zt=0)dt={1−μt,underP,1−νt,underP*,limdt→0P(Zt+dt=1|Zt=0)dt={μt,underP,νt,underP*.The mortality rates μτand ντare assumed to be continuous, deterministic, and satisfying μt→ ∞ and νt→ ∞, which further implies thatlimt→∞P(Zt=1)=limt→∞P*(Zt=1)=1. We have calibrated νtto the Danish mortality rates and obtained a satisfactory curve fit for a function(A.1)νt=a1exp(−(t−b1c1)2)+a2exp(−(t−b2c2)2),where constants a1, b1, c1, a2, b2, c2 are defined in Table B.4. Data, which include the mortality improvements, can be downloaded from Danish Financial Supervisory Authority website, see Finanstilsynet (2012). We further assume that the subjective mortality rate μtis proportional to νt.During retirement, T ≥ TR, the savings develop according to the incoming and outgoing payments. The incoming cash-flows are determined by the capital gains earned on the investment and the survival credit νtXtpaid by the life insurer. The outgoing payments consist of continuously paid premiums νtBeqtfor the death sum Beqt, and the benefits Bt. Upon death the life insurer inherits the value of savings Xtbut pays out the lump sum Beqtto the heirs. Therefore, the dynamics of the savings account, while the person is alive, are given by(A.2)dXt=(r+Πt(α−r))Xtdt+ΠtσXtdWt−νtBeqtdt+νtXtdt−Btdt,X0=xT,where (Xt, Bt, Beqt) are continuous-time variables corresponding to variables (∑iXi, t, n, Bt, n, Beqt, n) defined in the MSP formulation. Note that in the continuous-time framework we do not distinguish between the value of the savings before and after rebalancing. Moreover, rather than keeping the track of the traded amounts, we calculate the optimal asset allocation Πtin the portfolio directly.The objective is to maximize the expected utility of total benefits and bequest, given that the individual is alive at time t and has Xt= xton her savings account:V(t,x)=sup(Πt,Bt,Beqt)∈Q[t,T˜)Et,x[∫tT˜sp˜y+t(u(s,bsstate+Bs)+μsku(s,Beqs))ds],V(T˜,x)=0.The expression Et, xdenotes the conditional expectation underP,whereasQis the set of control processes that are admissible at time t. Both utilities are multiplied by the subjective probability that a y-year-old individual survives until time s > t, given she has survived until time t,sp˜y+t=e−∫tsμy+τdτ.The utility of bequest is moreover multiplied by the probability of dying shortly after surviving until time s, μs. Parameter k denotes the weight on the bequest motive relatively to the benefits, andT˜is a fixed time point at which the individual is dead with certainty.This simplified problem can be solved explicitly using the Hamilton–Jacobi–Bellman techniques. In this appendix we derive the optimal value function and the optimal controls only for the period after retirement, t ≥ TR. The case for t < TR is slightly more complicated but can be derived in a similar way.Based on the savings dynamics, Eq. (B.2), the HJB equation for the considered period is defined as follows,∂V(t,x)∂t−μtV+sup(Πt,Bt,Beqt){1γwt1−γ(Bt+btstate)γ−Bt∂V(t,x)∂x+μtk1γwt1−γBeqtγ−νtBeqt∂V(t,x)∂x+(r+Πt(α−r)+νt)x×∂V(t,x)∂x+12Πt2σ2x2∂2V(t,x)∂x2}=0,V(T˜,x)=0.We guess the solution(A.3)V(t,x)=1γft1−γ(x+gt)γ,where ftand gtare deterministic functions of time satisfyingfT˜=0andgT˜=0,and verify that our guess is correct. To derive the functions ftand gtwe plug in the derivatives of the function V(t, x) to the HJB equation,1−γγft−γ∂ft∂t(x+gt)γ+ft1−γ(x+gt)γ−1∂gt∂t−μt1γft1−γ(x+gt)γ+1γwt1−γ(wtft(x+gt))γ−(wtft(x+gt)−btstate)ft1−γ(x+gt)γ−1+μt1γkwt1−γ(kμtνt)γ/(1−γ)wtγftγ(x+gt)γ−νt(kμtνt)1/(1−γ)×wtft(x+gt)ft1−γ(x+gt)γ−1+(r+νt)xft1−γ(x+gt)γ−1+11−γ(α−r)22σ2ft1−γ(x+gt)γ=0.We further rewrite the term x(x + gt)γ − 1 = (x + gt)γ− gt(x + gt)γ − 1 and set the coefficients of the independent x terms of order (x + gt)γ − 1 and (x + gt)γto 0, i.e.,(x+gt)γ−1:ft1−γ(x+gt)γ−1∂gt∂t+btstateft1−γ(x+gt)γ−1−(r+νt)gtft1−γ×(x+gt)γ−1=0(x+gt)γ:1−γγft−γ∂ft∂t(x+gt)γ−μt1γft1−γ(x+gt)γ+1γwt1−γ×(wtft(x+gt))γ−wtftft1−γ(x+gt)γ+μt1γkwt1−γ(kμtνt)γ/(1−γ)×wtγftγ(x+gt)γ−νt(kμtνt)1/(1−γ)wtftft1−γ(x+gt)γ+(r+νt)ft1−γ×(x+gt)γ+11−γ(α−r)22σ2ft1−γ(x+gt)γ=0and obtain respectively(A.4)gt=∫tT˜spy+te−r(s−t)bsstateds,(A.5)ft=∫tT˜(sp˜y+t)1/(1−γ)(spy+t)−γ/(1−γ)eγ/(1−γ)φ(s−t)×[ws(1+(kμsνsγ)1/(1−γ))]ds,wherespy+t=e−∫tsνy+τdτandφ=r+(α−r)22σ2(1−γ). Beginning the determination of the three optimal controls, the total optimal benefits and the optimal size of the death sum are given by:(A.6)∂∂B:wt1−γ(Bt+btstate)γ−1−∂V(t,x)∂x=0⇒Bt*+btstate=wtft(x+gt)=1/a¯t*(x+gt),(A.7)∂∂Beq:μtkwt1−γBeqtγ−1−νt∂V(t,x)∂x=0⇒Beqt*=(kμtνt)1/(1−γ)wtft(x+gt)=(kμtνt)1/(1−γ)×1/a¯t*(x+gt),where(A.8)a¯t*=∫tT˜e−∫ts(μ¯τ+r¯)dτ(1+(kμsνsγ)1/(1−γ))ds,andr¯=11−γρ−γ1−γφandμ¯t=11−γμt−γ1−γνt.The optimal proportion of the savings invested in the mutual fund is given by(A.9)∂∂Π:(α−r)x∂V(t,x)∂x+Πtσ2x2∂2V(t,x)∂x2=0⇒Πt*=α−r(1−γ)σ2x+gtx,and the proportions between the risky assets in the mutual fund are specified by the mutual fund theorem, see Merton (1969) and Richard (1975):(A.10)∀i=1,⋯,N−1θi=∑j=1N−1[σij]−1(αj−r)∑k=1N−1∑j=1N−1[σkj]−1(αj−r),∑iθi=1.