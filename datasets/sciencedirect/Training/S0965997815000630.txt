@&#MAIN-TITLE@&#
Automatic surface repairing, defeaturing and meshing algorithms based on an extended B-rep

@&#HIGHLIGHTS@&#
A new data structure that combines the continuous and discrete surface representations is proposed.A sequence of repairing, defeaturing and meshing algorithms that can exploit the strengths of both representations is developed.The repairing algorithm is defined on the discrete model but can output a correct B-rep.The output mesh is loyal to the input continuous model and therefore more geometrically accurate.

@&#KEYPHRASES@&#
Mesh generation,Repairing,Defeaturing,Boundary representation,Virtual topology,Face clustering,

@&#ABSTRACT@&#
This paper presents an extended surface boundary representation (B-rep), where each topology entity can have dual geometric representations to accommodate various defects (e.g., gaps and overlaps) commonly present in CAD models. Keeping a uniform B-rep and the unsuppressed geometry data enables the use of various existing repairing, defeaturing and meshing algorithms to process CAD models with small gaps and overlaps on surface boundaries. The continuous geometry of the input model remains untouched in the repairing, defeaturing and meshing process, and the output mesh is loyal to this geometry. Such feature is often desirable in numerical simulations that require meshes with high geometry fidelity.

@&#INTRODUCTION@&#
To facilitate a numerical simulation, one needs to first prepare a geometry model and then discretise this model into a mesh. These two steps together are called the pre-processing of the simulation. For a simulation with complex geometry configuration, both steps are major performance bottlenecks because of intensive manual interactions. Recent advances of automatic mesh generation technologies relieve the burden of mesh generation to some extent. However, in many cases, creating qualified geometry inputs for mesh generation remains an outstanding challenge [1,2]. For instance, it was reported that, in Sandia National Laboratory, geometry preparation and mesh generation account for about 60% and 20% of overall simulation time, respectively, while only 20% of the overall time is actually devoted to numerical simulation [3].Most analysis models come from Computer Aided Design (CAD) systems. The original CAD models rarely meet the requirement of mesh generation and they need to be processed following a two-step procedure. Firstly, a CAD model is often contaminated by geometry errors, which if not rectified may collapse or invalidate the meshing procedure. Therefore, a repairing procedure is required to clean the CAD model and remove such geometry errors. Secondly, the input CAD model may contain many details for manufacturing or other purposes, but the meshing algorithm may fail to recognise them and generate badly shaped elements under larger mesh sizes than the geometry scales of the fine details. Even if the meshing algorithm captures these details and generates a mesh with acceptable quality, the total element number may increase massively due to small element sizes defined around the details. Therefore, a defeaturing step is indispensable to remove the details with minor analysis significance and ensure the output mesh can define a cost-effective analysis model.Mesh generation starts from surface meshing. In most cases, the subsequent volume meshing [4] relies on the surface mesh only and does not access the CAD model. Therefore, to some extent, the most important step of geometry preparation is to define a clean and defeatured surface model. In the CAD and Computer Graphics (CG) communities, many methods have been proposed to depict a surface. However, the continuous representation based on NURBS, Bézier and Coons patches and the discrete representation based on triangular facets presently dominate in the community of Computer Aided Engineering (CAE). Accordingly, techniques for surface repairing and defeaturing can be categorised into two groups: those applied directly to the continuous model and those to the discrete model.Geometry computations defined on a discrete model are very efficient because the edges and facets that depict the surface have linear equations. In contrast, a continuous surface has a high-order irreversible parametric representation. Many computations define on it depend on numerically instable iterative procedures, hence more time-consuming and less reliable. Nevertheless, the continuous surface has its own strengths. Firstly, the design of most industry products is based on continuous surfaces. If the computational mesh is defined on a discrete model, the simulation accuracy may degrade due to the geometry inaccuracy of the mesh. Secondly, the continuous surface is usually organised with a boundary representation (B-rep). Many efficient defeaturing and meshing algorithms have been developed by utilising the topology entities of the B-rep [5–9]. These algorithms cannot be applied on a pure discrete model that is internally organised with some edge-based data structures.In this study, we propose a new data structure namely the hybrid surface B-rep. It combines the continuous and discrete representations of surfaces. Each topology entity of the surface B-rep has a dual geometry representation in default. In addition, the mappings are maintained between the topology entities (faces, curves and points) of the B-rep and their counterparts (facets, edges and vertices) on the discrete model. The primary motivation of developing this data structure is to enrich our choices of geometry repairing, geometry defeaturing and mesh generation algorithms to serve different application purposes better. Upon this data structure, we can combine different types of algorithms in one pre-processing workflow. In contrast, most of the existing pre-processing approaches are solely based on either the discrete or the continuous model. As a result, they can only employ one type of geometry repairing, geometry defeaturing and mesh generation algorithms.To demonstrate the benefit of the proposed data structure, a novel pre-processing workflow is proposed for CAD models with small gaps and overlaps on surface boundaries. These errors are common in CAD models due to translation errors, numerical inaccuracies and tolerance settings. For such CAD models, the existing pre-processing approaches prepare the mesh model by one of the following two approaches.(1)The continuous model based approach. This approach is adopted by many commercial tools [10]. It first repairs the gaps of the input model directly by redefining the curves and surfaces in the neighbourhood [11]. No matter real[12] or virtual operations [5–7,13,14] are executed in the following defeaturing step, the final mesh is always generated on a modified CAD model.The discrete model based approach. This approach repairs the tessellated dual of the input CAD model [15–17] and if needed, the repaired discrete model can be further simplified [18]. All of these steps modify the geometry and take the risk of degrading the geometry accuracy of the final mesh.The proposed approach combines the discrete model based geometry-repairing algorithm [15,16] and the continuous model based defeaturing algorithm [6] in one pre-processing workflow. Firstly, it repairs the discrete dual of the input model, and updates the topology entities of the B-rep. Next, the repaired B-rep is defeatured by combining neighbouring faces. The defeatured B-rep contains two types of faces: the real faces and the virtual faces. The real face has a unique counterpart in the input model and its continuous model is meshed directly by a mapping-based surface mesher. However, the virtual face, i.e. a combination of many faces, has no intrinsic parametric space. Its discrete model is meshed instead and then the interior mesh points are projected onto the continuous model. The final output is a combination of the meshes generated on real and virtual faces.Compared with the algorithms solely based on the discrete or the continuous models, the advantages of the proposed approach are:(1)Most geometry computations are performed on the discrete model, avoiding the tedious, expensive and unreliable calculations on the continuous model.The input continuous model is not modified, and the output mesh is loyal to the input model rather than a discrete one or a modified one due to the repairing and defeaturing algorithms. This feature is often much desirable in simulations that require meshes with high geometry fidelity.The repairing algorithm not only removes geometry errors on the discrete model, but it also generates a correct B-rep. Therefore, the defeaturing and meshing algorithms that rely on a valid B-rep input can be directly applied.

@&#CONCLUSIONS@&#
A new data structure named hybrid surface B-rep is proposed to represent a composite surface model. In this extended B-rep, each topology entity has a dual geometric representation in default, i.e., a continuous representation and its discrete counterpart. The inclusion of dual geometry data enables a sequence of repairing, defeaturing and meshing algorithms for an input CAD model with small gaps and overlaps on its surface boundaries. The continuous input geometry remains untouched in the entire process, and the output mesh is loyal to the input model. This feature is desirable in many simulations that require meshes with high geometry fidelity. Meanwhile, most geometry computations are defined on the discrete model in the proposed approach, avoiding their tedious, expensive and unreliable counterparts defined on the continuous model.