@&#MAIN-TITLE@&#
Spitzer identity, Wiener-Hopf factorization and pricing of discretely monitored exotic options

@&#HIGHLIGHTS@&#
We deal with the finite time distribution of the discrete extrema for a Lévy process.We propose a procedure based on the combined use of Hilbert- and z-transforms.Our results solve in an efficient and accurate way a long-standing problem.Our results are relevant in many fields: Operational research, finance, insurance, engineering, physics.As a concrete application, we contribute to the option pricing literature.

@&#KEYPHRASES@&#
Path-dependent options,Hilbert transform,Lévy process,Spitzer identity,Wiener-Hopf factorization,

@&#ABSTRACT@&#
The Wiener-Hopf factorization of a complex function arises in a variety of fields in applied mathematics such as probability, finance, insurance, queuing theory, radio engineering and fluid mechanics. The factorization fully characterizes the distribution of functionals of a random walk or a Lévy process, such as the maximum, the minimum and hitting times. Here we propose a constructive procedure for the computation of the Wiener-Hopf factors, valid for both single and double barriers, based on the combined use of the Hilbert and the z-transform. The numerical implementation can be simply performed via the fast Fourier transform and the Euler summation. Given that the information in the Wiener-Hopf factors is strictly related to the distributions of the first passage times, as a concrete application in mathematical finance we consider the pricing of discretely monitored exotic options, such as lookback and barrier options, when the underlying price evolves according to an exponential Lévy process. We show that the computational cost of our procedure is independent of the number of monitoring dates and the error decays exponentially with the number of grid points.

@&#INTRODUCTION@&#
This paper provides a new procedure to determine the finite-time distribution of the discrete extrema and of the hitting times of one or two barriers for a process with independent and identically distributed increments, such as a Lévy process. Spitzer (1956) provided a closed formula for the z-transform (or moment generating function or discrete Laplace transform) of the characteristic function of the extrema of a random walk observed on a set of discrete dates. Up to now the concrete application of the Spitzer identity has been difficult because it requires the Wiener-Hopf (WH) factorization of a function defined in the complex plane, a mathematical problem that concerns a variety of fields in applied mathematics. Indeed, this factorization cannot be achieved analytically except in few cases, or its computation turns out to be very demanding requiring the numerical evaluation of a multidimensional integral in the complex plane. In addition, with regard to a general Lévy process, little is known for the two-barriers case.The key contributions of our paper are the following. First of all, we provide a constructive procedure for performing the WH factorization. More precisely, we express the WH factors arising in the Spitzer identity in terms of the Plemelj–Sokhotsky relations, which allow us to compute the WH factors through the Hilbert transform. The latter is then approximated via a sinc function expansion (Stenger, 1993), which guarantees an exponential decay of the approximation error on the number of grid points.Moreover, our methodology can deal with both a single and a double barrier. The solution in the second case is of interest in itself because it solves a long-standing problem related to an efficient computation of the WH factors in the presence of two barriers. The double-barrier case did not admit a simple feasible solution up to now, except under few special assumptions on the structure of the Lévy process. One has to solve two coupled integral equations, which can be achieved by factorizing a 2 × 2 matrix of functions, but a general analytical method for this more difficult problem has not been found yet (Jones, 1991). Here, as the second main contribution of the paper, we constructively propose a fixed-point algorithm based on an extension of the single-barrier case that achieves a fast convergence.As a concrete application, we contribute to the mathematical finance literature related to the pricing of exotic options, such as barrier and lookback. Pricing derivatives, especially exotic options, is a challenging problem in the operations research literature (to cite a few, see Cai, Chen, & Wan, 2009; Date & Islyaev, 2015; Dingeç & Hörmann, 2012; Feng & Linetsky, 2008b; Giesecke & Smelov, 2013; Jin, Li, Tan, & Wu, 2013; Sesana, Marazzina, & Fusai, 2014; Wang & Tan, 2013). The application of transform techniques in mathematical finance is rather recent. The first and most important contributions are probably the articles by Heston (1993) and Carr and Madan (1999), where the authors show how to price European options with non-Gaussian models exploiting the Fourier transform. Similar techniques were developed later for path-dependent derivatives (e.g. Cai et al., 2009; Feng & Linetsky, 2008a; Green, Fusai, & Abrahams, 2010). Our paper provides a unified framework and a fast operational method for pricing barrier and lookback (or hindsight) options when the underlying asset evolves as an exponential Lévy process. In addition, the monitoring condition, e.g., the event that the underlying asset value falls below a given barrier for a down-and-out barrier option, is assumed to be controlled at discrete time intervals. Our procedure, based on the new WH factorization method, has a computational cost independent of the number of monitoring dates. This is possible because the inversion of the discrete Laplace transform is performed via the Euler acceleration, which bounds from above the number of WH factorizations to be computed. Moreover, at least with regard to single-barrier and lookback options, the method provides exponential order of convergence due to the fact that the factorization is performed remaining in the complex plane. The existing pricing methods are based on the backward recursive formula (e.g. Fusai, Longo, Marena, & Recchioni, 2009; Fusai, Marazzina, Marena, & Ng, 2012; Fusai & Recchioni, 2007; Jackson, Jaimungal, & Surkov, 2008; Lord, Fang, Bervoets, & Oosterlee, 2008), and on exploiting the convolution structure of the transition density of the Lévy process by performing the computations efficiently and fast using the FFT, which leads to a CPU time that grows asO(MlogM),where M is the number of grid points. However, all the above cited methods are characterized by a polynomial decay of the error with M. This order of accuracy is related to the fact that the backward procedure for barrier options involves a convolution, that can be computed in the complex plane, and a projection, which is applied in the real plane, to take into account the presence of the barrier. A noticeable exception was presented by Feng and Linetsky (2008a, 2009), who reformulated the backward procedure for barrier and lookback options in terms of the Hilbert transform, so that all steps are performed in the complex plane. Computing the Hilbert transform with a sinc function expansion, they achieved an exponential decay of the error. However, the computational cost of all these methods, including the one by Feng and Linetsky, increases linearly with the number of monitoring dates.Finally, the factorization procedure introduced here is quite general and can also be applied, without any additional complication, to continuously-monitored contracts. Even the best available method listed above, i.e., that by Feng and Linetsky, does not have this feature.Even if the Spitzer identity has already been used in option pricing (e.g. Atkinson & Fusai, 2007; Borovkov & Novikov, 2002; Green et al., 2010; Lewis & Mordecki, 2008) and the present paper is mainly focused on this kind of applications, our method goes well beyond option pricing and opens up the way to a more extensive use of the Spitzer identity and the WH factorization in a variety of non-financial fields; for physics, see a recent review by Bray, Majumdar, and Schehr (2013). In this regard we would like to mention the applicability to queuing theory due to the strict connection between random walks and queues, see Lindley (1952) for pioneering contributions as well as Cohen (1975), Prabhu (1974) and Asmussen (1987); 1998). Further applications include insurance (Gerber, Shiu, & Yang, 2013) and sequential testing (Siegmund, 1985). Finally, the WH factorization arises in many branches of engineering, mathematical physics and applied mathematics. This is testified by the thousands of papers published on the subject since its conception. A review of the different applications is given by Lawrie and Abrahams (2007).The structure of the paper is the following. Section 2 introduces the Spitzer identity and its relationship with the WH factorization, proposing, via the interpretation of the Plemelj–Sokhotsky relations as Hilbert transforms, a new operational method to perform the factorization and therefore to compute the distributions of the minimum and the maximum of a Lévy process, as well as the joint distributions of the process at maturity and of its minimum or maximum over the whole time interval. Section 3 shows how the proposed general methodology can be implemented efficiently and accurately computing the Hilbert transform via a sinc expansion; we also discuss the inversion of the z-transform and its acceleration through the Euler summation rule to make the computational cost independent of the number of monitoring dates. Section 4 deals with the pricing problem for lookback and barrier options, describing how our procedure is fast as well as accurate. This is validated numerically in Section 5 with a variety of numerical experiments.We consider a Lévy process X(t), i.e., a stochastic process withX(0)=0and independent and identically distributed increments. The Lévy–Khincine formula states that the characteristic function of the process is given byΨ(ξ,t)=E[eiξX(t)]=eψ(ξ)t,where ψ is the characteristic exponent of the process,(1)ψ(ξ)=iaξ−12σ2ξ2+∫R(eiξη−1−iξη1|η|<1)ν(dη).The Lévy–Khincine triplet (a, σ, ν) fully defines the Lévy process X(t).In several applications in queueing theory, insurance and financial mathematics, the key point is the determination of the law of the extrema of the Lévy process observed on an equally-spaced gridXn=X(nΔ),n=0,…,N,where Δ > 0 is the time step, i.e., the distance between two consecutive monitoring dates, which is assumed constant. We define the processes of the maximum MNand of the minimum mNup to the Nth monitoring date as(2)MN=maxn=0,⋯,NXnandmN=minn=0,⋯,NXn.To distinguish the present case, where the above processes, albeit evolving in continuous time, are recorded only at discrete times, the terminology discrete versus continuous monitoring is used.In particular, besides the distribution PX(x, N) of the Lévy process at maturityT=NΔ,we will need the distributions Pm(x, N) of the minimum and PM(x, N) of the maximum over the whole set{n=0,…,N},as well as the joint distributions PX, m(x, N) or PX, M(x, N) of the process at maturity and of its minimum or maximum over the interval with respect to a lower (upper) barrier l (u), and the joint distribution of the triplet (XN, mN, MN), PX, m, M(x, N). These distributions are defined as(3)dPX(x,N)=pX(x,N)dx=P[XN∈[x,x+dx)](4)dPm(x,N)=pm(x,N)dx=P[mN∈[x,x+dx)](5)dPM(x,N)=pM(x,N)dx=P[MN∈[x,x+dx)](6)dPX,m(x,N)=pX,m(x,N)dx=P[XN∈[x,x+dx),mN>l](7)dPX,M(x,N)=pX,M(x,N)dx=P[XN∈[x,x+dx),MN<u](8)dPX,m,M(x,N)=pX,m,M(x,N)dx=P[XN∈[x,x+dx),mN>l,MN<u].We define the Fourier transform of a function g(x) asg^(ξ)=Fx→ξ[g(x)]:=∫−∞+∞g(x)eiξxdxand its inverse withg(x)=Fξ→x−1[g^(ξ)]:=12π∫−∞+∞g^(ξ)e−ixξdξ.In some cases, for compatibility with previous literature, we use an upper-case letter instead of a lower-case letter with a hat, i.e., G(ξ) instead ofg^(ξ). As an exception to these notations, the above defined characteristic function Ψ of the Lévy process is the Fourier transform of the probability density function f of the Lévy process,Ψ(ξ,Δ)=Fx→ξ[f(x,Δ)],where the transition probability thatX(t+Δ)=xwhenX(t)=x′has densityf(x−x′,Δ)for any t > 0.11We recall thatpX(x,N)=f(x,NΔ)and thusp^X(ξ,N)=Ψ(ξ,NΔ).The convolution form of the density function is due to the assumption of independent increments.Next, we define the z-transform (or generating function) of a discrete set of functions v(x, n),n∈N0,asv˜(x,q)=Zn→q[v(x,n)]:=∑n=0∞v(x,n)qn,withq∈C(in a more common definition,z−1is used in place of q). It is a discrete version of the Laplace transform of a function c(x, t), which is obtained for Δ → 0 settingq=e−sΔ,v(x,n)=Δc(x,nΔ)andnΔ=t. The original function v(x, n) can be recovered through the complex integral(9)v(x,n)=Zq→n−1[v˜(x,q)]=12πρn∫02πv˜(x,ρeiu)e−inudu,where ρ must be within the radius of convergence (Abate & Whitt, 1992).Using combinatorial arguments, Spitzer (1956) derived formulas for the z-transforms of the characteristic functions of the distributions defined in Eqs. (3)–(8), the celebrated Spitzer identities. We recall them here. Let Φ± be two functions which are analytic in the overlap of two half planes including the real line such that(10)Φ(ξ,q):=1−qE[eiξX(Δ)]=1−qΨ(ξ,Δ)=Φ+(ξ,q)Φ−(ξ,q).Φ±(ξ, q) are the positive and negative WH factors of1−qΨ(ξ,Δ).22The WH factors are not uniquely defined: given a factorizationΦ(ξ,q)=Φ+(ξ,q)Φ−(ξ,q),alsoaΦ+(ξ,q)and1aΦ−(ξ,q)are WH factors for any constant a ≠ 0.The Spitzer identities express the desired characteristic functions through the inversion of a moment-generating function involvingΦ,Φ+andΦ−:(11)p^˜X(ξ,q)=Zn→q[p^X(ξ,n)]=Zn→q[E(eiξXn)]=1Φ(ξ,q)(12)p^˜m(ξ,q)=Zn→q[p^m(ξ,n)]=Zn→q[E(eiξmn)]=1Φ+(0,q)Φ−(ξ,q)(13)p^˜M(ξ,q)=Zn→q[p^M(ξ,n)]=Zn→q[E(eiξMn)]=1Φ+(ξ,q)Φ−(0,q)(14)p^˜X,m(ξ,q)=1Φ(ξ,q)−eilξP−(ξ,q)Φ+(ξ,q)=eilξP+(ξ,q)Φ+(ξ,q)(15)p^˜X,M(ξ,q)=1Φ(ξ,q)−eiuξQ+(ξ,q)Φ−(ξ,q)=eiuξQ−(ξ,q)Φ−(ξ,q)(16)p^˜X,m,M(ξ,q)=1Φ(ξ,q)−eilξJ−(ξ,q)Φ(ξ,q)−eiuξJ+(ξ,q)Φ(ξ,q),whereP(ξ,q):=e−ilξΦ−(ξ,q)=P+(ξ,q)+P−(ξ,q)andQ(ξ,q):=e−iuξΦ+(ξ,q)=Q+(ξ,q)+Q−(ξ,q).Notice that the joint probabilities in Eqs. (14)–(16) are given by the probability of the process at maturity, Eq. (11), minus the probability to hit a barrier; the latter vanishes if the barrier moves to ± ∞. Similar identities exist for the continuous-monitoring case too, where the quantity to be factorized becomeslimΔ→0Φ(ξ,q)/Δ=s−ψ(ξ)=:ϕ(ξ,s); see Section D of the online supplemental material. Full technical details are given in Greenwood and Pitman (1980), Kyprianou (2006) and Sato (1999).The double-barrier problem, which is more difficult than the others, was not examined by Spitzer himself, but by Kemperman (1963). Unfortunately he did not present a constructive procedure for the determination of the quantitiesJ+(ξ,q)andJ−(ξ,q)in Eq. (16). The problem was later solved in the Gaussian case by Green et al. (2010, Section 2.4). Here we generalize the latter construction to Lévy processes. In particular, Green et al. (2010) proved thatJ+(ξ,q)andJ−(ξ,q)are the solution of the coupled integral equations(17)J−(ξ,q)Φ−(ξ,q)+12πi∫−∞+∞ei(u−l)ξ′J+(ξ′,q)(ξ−ξ′)Φ−(ξ′,q)dξ′=12πi∫−∞+∞e−ilξ′(ξ−ξ′)Φ−(ξ′,q)dξ′,(18)J+(ξ,q)Φ+(ξ,q)+12πi∫−∞+∞ei(l−u)ξ′J−(ξ′,q)(ξ−ξ′)Φ+(ξ′,q)dξ′=12πi∫−∞+∞e−iuξ′(ξ−ξ′)Φ+(ξ′,q)dξ′,where Im ξ′ > Im ξ in the first equation (smile integral; Im is the imaginary part) and Im ξ′ < Im ξ in the second (frown integral).As proved by Krein (1963), the decomposition of a complex functionf^(ξ)=f+^(ξ)+f−^(ξ)can be computed through the Cauchy-type integralsf+^(ξ)=12πi∫−∞+∞f^(ξ′)ξ−ξ′dξ′,Imξ′<Imξ,f−^(ξ)=12πi∫−∞+∞f^(ξ′)ξ−ξ′dξ′,Imξ′>Imξ.Therefore Eqs. (17) and (18) can be rewritten asJ−(ξ,q)Φ−(ξ,q)+[ei(u−l)ξJ+(ξ,q)Φ−(ξ,q)]−=[e−ilξΦ−(ξ,q)]−,J+(ξ,q)Φ+(ξ,q)+[ei(l−u)ξJ−(ξ,q)Φ+(ξ,q)]+=[e−iuξΦ+(ξ,q)]+,or(19)J−(ξ,q)Φ−(ξ,q)=[e−ilξ−ei(u−l)ξJ+(ξ,q)Φ−(ξ,q)]−,(20)J+(ξ,q)Φ+(ξ,q)=[e−iuξ−ei(l−u)ξJ−(ξ,q)Φ+(ξ,q)]+.The solution of Eqs. (19) and (20) is related to the difficult problem of a matrix WH factorization; a solution for the kind of matrix arising in this case has not been found yet. Therefore, we propose the following fixed-point algorithm that achieves a fast convergence: starting from a guess functionJ+(0)(ξ,q)=0,forj=1,…(a)Decompose(21)P¯(j)(ξ,q):=e−ilξΦ−(ξ,q)−ei(u−l)ξJ+(j−1)(ξ,q)Φ−(ξ,q)=P¯+(j)(ξ,q)+P¯−(j)(ξ,q)and computeJ−(j)(ξ,q)=P¯−(j)(ξ,q)Φ−(ξ,q).Decompose(22)Q¯(j)(ξ,q):=e−iuξΦ+(ξ,q)−ei(l−u)ξJ−(j)(ξ,q)Φ+(ξ,q)=Q¯+(j)(ξ,q)+Q¯−(j)(ξ,q)and computeJ+(j)(ξ,q)=Q¯+(j)(ξ,q)Φ+(ξ,q).If the distance between the new and old functionsJ±(j)andJ±(j−1)is greater than a given tolerance, increase j and return to Step (a), otherwise stop and setJ−=J−(j),J+=J+(j).The above fixed-point algorithm will be used to price double-barrier derivatives in Section 4.3.To make all the above expressions usable, we need to factorize (or decompose) a complex function, defined in a strip containing the real axis, into a product (or sum) of two functions which are analytic in the overlap of two half planes, including the real line, where they are defined. Once this has been done and the relevant quantities in Eqs. (11)–(16) have been obtained, we must compute numerically an inverse z-transform, followed by an inverse Fourier transform. The latter is done in a standard way using the FFT. The inversion of the z-transform is rather easy too. It has been discussed in detail by Abate and Whitt (1992), who showed that it can be well approximated by(23)v(x,n)=Zq→n−1[v˜(x,q)]≈12nρn[v˜(x,ρ)+2∑j=1n−1(−1)jv˜(x,ρeijπ/n)+(−1)nv˜(x,−ρ)].The more challenging part is the factorization of Φ in Eq. (10), as well as the decomposition of P and Q (P¯(i)andQ¯(i)in the double-barrier case). In general, this problem can be described as follows. Given a smooth enough functionf^(ξ),analytic in a strip around the real axis, we need to computef±^(ξ)such that(24)f^(ξ)=f+^(ξ)f−^(ξ);f+^(ξ)is such that its inverse Fourier transformf+(x)=0for x < 0, whilef−^(ξ)is such thatf−(x)=0for x > 0. Taking logarithms, this can be accomplished by the decomposition(25)logf^(ξ)=logf+^(ξ)+logf−^(ξ).The conditions under which the above factorization or logarithmic decomposition gives proper results have been given by Krein (1963); the most important requirement is thatf^(ξ)is not zero anywhere.In general neither the factorization nor the decomposition can be done analytically. With continuous monitoring, an analytical treatment becomes possible for a Brownian motion or if we impose strong restrictions on the structure of the considered Lévy process (Le Courtois & Quittard-Pinon, 2008; Rogers, 2000), such as the assumption that it is spectrally one-sided, i.e., jumps are either always up or always down. Another assumption that makes the factorization feasible is if the jumps are of phase type (Asmussen, Avram, & Pistorius, 2004), which includes the Kou double exponential jump model Kou (2002) as a special case. In these cases the WH factorization is tractable becauseϕ(ξ,s)=s−ψ(ξ)is a rational function and its decomposition in upper/lower factors is quite immediate. For example, Jeannin and Pistorius (2009) approximate different Lévy models by the class of generalized hyper-exponential models, which have a tractable WH factorization. A similar idea is pursued by Asmussen, Madan, and Pistorius (2007) and Cai (2009). A quasi-analytical WH factorization has been achieved by Kuznetsov (2010) when the characteristic exponent is a meromorphic function. In this case, WH factors can be expressed as infinite products and require the solution of transcendental equations. Unfortunately, with discrete monitoring, even under the above assumptions the factorization is not doable analytically, becauseΦ(ξ,q)=1−qΨ(ξ,Δ)=1−qeψ(ξ)Δis not a rational function. In addition, all the above mentioned methods consider only the single-barrier case. An exception was given by Boyarchenko and Levendorskii (2002), who obtained exact analytical pricing formulae in terms of WH factors, and, under additional conditions on the process, derived simpler approximate formulae. For the general difficulty in computing the factors, with reference to the important financial engineering problem of pricing barrier options, Carr and Crosby (2010) state: “Pricing barrier options for arbitrary Lévy processes is far from trivial. There are, in principle, some results ... based on Wiener-Hopf analysis although they involve inversion of triple Laplace transforms and it is open to debate as to whether this could be done efficiently enough for use in a trading environment.” Similarly, Cont and Tankov (2004), a popular reference text for applications of Lévy processes in finance, states: “The Wiener-Hopf technique is too computationally expensive and we recommend Monte Carlo simulation or numerical solution of partial integro-differential equations.” These remarks are based on the representation of the WH factors for the continuous-monitoring case as double integrals (Cont and Tankov, 2004, Chapter 11.3). With reference to financial applications, attempts to compute the WH factors have been done by Boyarchenko and Levendorskii (2002) and Kuznetsov, Kyprianou, Pardo, and van Schaik (2011), among others.A more convenient representation of the WH factors can be found using the Hilbert transform and the Plemelj–Sokhotsky relations (King, 2009). The Hilbert transform of a functionf^(ξ)is defined as(26)Hξ[f^(ξ)]=p.v.1πξ*f^(ξ)=p.v.1π∫−∞+∞f^(ξ′)ξ−ξ′dξ′,where * denotes convolution and p.v. the Cauchy principal value,p.v.1π∫−∞+∞f^(ξ′)ξ−ξ′dξ′=limϵ→0+1π(∫ξ−1/ϵξ−ϵf^(ξ′)ξ−ξ′dξ′+∫ξ+ϵξ+1/ϵf^(ξ′)ξ−ξ′dξ′);the latter assigns a value to an improper integral which would otherwise result in the indefinite form+∞−∞. The convolution theorem(27)f^(ξ)*g^(ξ)=Fx→ξ[f(x)g(x)],which maps a convolution to a product via a Fourier transform, together with the inverse Fourier transformp.v.Fξ→x−1[1πξ]=−isgnx,enables to express the Hilbert transform through an inverse Fourier transform (fromf^(ξ)to f(x)) and a direct Fourier transform,(28)iHξ[f^(ξ)]=Fx→ξ[sgnxf(x)].Thus a fast method to compute the Hilbert transform numerically consists simply in evaluating Eq. (28) through an inverse and a direct FFT.Define the projections of a function f(x) on the positive or the negative half-axis through the multiplication with the indicator function of that set,Px+[f(x)]:=1x>0f(x)=f+(x),andPx−[f(x)]:=1x<0f(x)=f−(x).Now substitutesgnxf(x)=(1x>0−1x<0)f(x)=f+(x)−f−(x)into Eq. (28), obtaining the remarkable property(29)f+^(ξ)−f−^(ξ)=iHξ[f^(ξ)].Together with the identity(30)f+^(ξ)+f−^(ξ)=f^(ξ),this allows to achieve a decomposition of a functionf^(ξ),and thus a factorization ofexpf^(ξ),via its Hilbert transform. To this end, Eqs. (29) and (30) are conveniently rearranged to the Plemelj–Sokhotsky relations(31)f+^(ξ)=12(f^(ξ)+iHξ[f^(ξ)]),f−^(ξ)=12(f^(ξ)−iHξ[f^(ξ)]).Obtaining the WH factors ofexpf^(ξ)through Eq. (31) with the Hilbert transform computed in a straightforward way by Eq. (28) corresponds to performing in sequence an inverse Fourier transform, a projection on the positive or negative half axis and a Fourier transform,f+^(ξ)=Fx→ξ[Px+Fξ→x−1f^(ξ)],f−^(ξ)=Fx→ξ[Px−Fξ→x−1f^(ξ)],i.e., to the schemef^⟶F−1f↗P+↘P−P−f+⟶Ff+^f−⟶Ff−^.This factorization is fast because it can be accomplished numerically with two FFTs and one projection (Henery 1974 & Rino 1970). On the other hand, switching back and forth between Fourier and real space, the application of the projection causes a loss of accuracy; in the end this procedure turns out to have only quadratic accuracy.A numerically more accurate approach consists in the computation of the Hilbert transform, and thus of the Plemelj–Sokhotsky relations, using a sinc expansion approximation to analytic functions. This approach uses two FFTs too to multiply Toeplitz matrices with vectors and thus has a computational cost ofO(MlogM),but it does not leave Fourier space and its discretization error decreases exponentially with respect to M; see Section 3.1 for details.We stress here the similarities and differences with the approach followed by Feng and Linetsky (2008a, 2009). In the mentioned papers the Hilbert transform is applied in the backward-in-time pricing procedure. In practice, the projection step is performed in Fourier space using the Hilbert transform; greater details on how this is possible are given in the online supplementary material. This transform is computed at a high degree of accuracy via sinc expansion. No direct relationship of their procedure with a WH factorization can be devised. The analogy is that we are able to express WH factors via a Hilbert transform and then we can exploit their idea of performing this transform with a sinc expansion. At the end, we are able to achieve the same accuracy as their method, but with a significant saving of computational time, because our procedure has a cost independent of the number of monitoring dates N, whilst in all existing methods, including the one by Feng and Linetsky (2008a), the cost increases linearly with N.For the sake of truth, an advantage of the Feng and Linetsky method with respect to our procedure is that, like all backward-in-time recursive methods, it can easily deal with non-equally spaced monitoring dates. On the other side, our methodology can cope with the continuous monitoring case, as shown in the online supplementary material, whilst the Feng and Linetsky approach, and other Fourier methods, cannot.The new approach proposed in the present paper is therefore summarized in the following procedure: (1) we perform the WH factorization through the Plemelj–Sokhotsky relations (31), and (2) we compute the Hilbert transform in Fourier space using sinc functions as described in detail in the next section. The inversion of the z-transform is performed exploiting the Euler acceleration technique. The detailed procedure is discussed in Section 3. Applications to different exotic options are considered in Section 4.The implementation of the proposed procedure to estimate the distributions in Eqs. (3)–(8) consists of two steps: an efficient implementation of the WH factorization exploiting sinc functions, and an inverse z-transform combined with the Euler summation. The numerical implementation is detailed in this section.The Hilbert transform can be efficiently computed using the sinc expansion approximation of analytic functions. The use of sinc functionsSk(z,h)=sin(π(z−kh)/h)π(z−kh)/h,k∈Z,has been deeply studied by Stenger (1993), who showed that a function f(z) analytic on the whole complex plane and of exponential type with parameter π/h, i.e., |f(z)| ≤ Ceπ|z|/h, can be reconstructed exactly from the knowledge of its values on an equispaced grid of step h, as f(z) admits the sinc expansion (Stenger, 1993, Theorem 1.10.1)f(z)=∑k=−∞+∞f(kh)Sk(z,h).Now, asFz→ζ[Sk(z,h)]=heikhζ,and (Feng & Linetsky, 2008a, Corollary 6.1)Hz[Sk(z,h)]=1−cos(π(z−kh)/h)π(z−kh)/h,also the Fourier and Hilbert transforms of f(z) admit the sinc expansionsf^(ζ)=h∑k=−∞+∞f(kh)eikhζif|ζ|<π/h,f^(ζ)=0if |ζ| ≥ π/h, as functions analytic on the whole plane and of exponential type have Fourier transforms that vanish outside of the finite interval(−π/h,π/h)(Stenger, 1993, Theorem 1.10.1), andHz[f(z)]=∑k=−∞+∞f(kh)1−cos(π(z−kh)/h)π(z−kh)/h.The integrals of f and |f|2 can be written as sinc expansions too,∫Rf(x)dx=h∑k=−∞+∞f(kh),∫R|f(x)|2dx=h∑k=−∞+∞|f(kh)|2.The above results show in particular that the trapezoidal quadrature rule with step size h is exact.This holds true for a function f(z) that is analytic in the whole complex plane. However, this can be used also to approximate a function that is analytic only in a strip including the real axis, which is the case considered in this article. More precisely, Stenger (1993, Theorems 3.1.3, 3.1.4 and 3.2.1) states that in this case the trapezoidal approximation has an error that decays exponentially with respect to h.The computation of the Hilbert transform via a sinc expansion can be performed using the FFT (Feng & Linetsky, 2008a, Section 6.5). A discrete Hilbert transform requires matrix-vector multiplications involving Toeplitz matrices. As is well known, this kind of multiplications can be performed exploiting the FFT, once those matrices are embedded in a circulant matrix (Feng & Linetsky, 2008a, Appendix B) (Fusai et al., 2012). In particular, Feng & Linetsky, with respect to the computation of the Hilbert transform (Feng & Linetsky, 2009, Theorem 3.3) and of the whole Plemelj–Sokhotsky formulas (31) (Feng & Linetsky, 2008a, Theorem 6.5) (Feng & Linetsky, 2009, Theorem 3.4) with sinc functions, proved the following convergence result: if a function is analytic in a suitable strip around the real axis, then the discretization error of its numerical factorization or decomposition decays exponentially with the number of grid points M. Matlab code to perform the Hilbert transform via sinc functions and therefore the WH factorization is provided in the online supplementary material.In order to recover the probabilities in Eqs. (11)–(16) once the WH equations have been solved, we need an inverse z-transformZq→n−1. The latter is performed according to Eq. (23), where ρ ∈ (0, 1) is a free parameter; settingρ=10−6yields a10−12accuracy of the option price (Abate & Whitt, 1992; Fusai et al., 2012). Moreover, we apply the Euler summation, which is a convergence-acceleration technique well suited to evaluate alternating series (O’Cinneide, 1997). The idea of the Euler summation is to approximateZq→n−1[v˜(ξ,q)]by the binomial average, also called Euler transform, of its partial sums bkfromk=nEtok=nE+mE,i.e.,(32)Zq→n−1[v˜(ξ,q)]≈12mEnρn∑j=0mE(mEj)bnE+j(ξ),wherebk=∑j=0k(−1)jajRev˜(ξ,ρeijπ/n),witha0=0.5,aj=1,j=1,…,nE+mE,and nE and mE are suitably chosen such thatnE+mE<n. Thus the number of parametersq=ρeijπ/nto be considered in Eq. (23) drops fromn+1tonE+mE+1. Numerical tests suggest to setnE=12andmE=20.In conclusion, the combined use of the numerical Hilbert transform and the numerical inverse z-transform has a computational cost ofO((min{n,nE+mE}+1)MlogM),and a discretization error which exponentially decays till it reaches an accuracy of about10−12. This is confirmed in the numerical experiments reported in Section 5 to price derivatives. The only exception is for the double-barrier case, and therefore when we deal with the probability dPX, m, M, where the error decay turns out to be only polynomial, due to the use of the fixed-point algorithm. On the other hand, the iterative numerical scheme solves a long-standing problem related to an efficient computation of the WH factors in the double-barrier case.In mathematical finance Lévy processes X(t) are used to describe the evolution of an asset price S(t) according toS(t)=S0eX(t),S0=S(0)being the initial spot price. The stock price dynamics is directly specified under the so-called risk-neutral measure, so that in Eq. (1)a=r−δ−12σ2−∫R(eη−1−η1|η|<1)ν(dη),where r is the risk-free interest rate and δ the asset dividend rate.To price path-dependent options such as barrier and lookback options, the relevant quantities are the maximum MNand the minimum mNregistered at discrete timest=nΔ,n=0,…,N,up to maturityNΔ=T,Δ being the constant time interval between two subsequent monitoring dates. For a fixed-strike lookback option we need the distribution PM(x, N) of the maximum or Pm(x, N) of the minimum. For a single-barrier option we need the joint distribution PX, M(x, N) or PX, m(x, N) of the Lévy process at T and of its maximum (up-and-out case) or minimum (down-and-out case) over all monitoring datesn=0,…,N. For a double-barrier option we need the joint distribution PX, m, M(x, N) of the triplet (XN, mN, MN).In pricing the above mentioned contracts, we are interested in the truncated damped payoff for a call and a put option(33)ϕ(x)=eαxS0(ex−ek)+1x≤uandϕ(x)=eαxS0(ek−ex)+1x≥l,respectively, wherek=log(K/S0)is the rescaled log-strike of the option, andl=log(L/S0)andu=log(U/S0)are the rescaled lower and upper log-barriers. The damping factor eαxwith a suitable choice of the parameter α makes the Fourier transform of the payoff well defined.The option price is obtained discounting the expectation value of the undamped payoff with respect to the appropriate distribution; this expectation can conveniently be computed through the Parseval/Plancherel relation (Lewis, 2001) by a product in Fourier space and an inverse Fourier transform,(34)E[ϕ(x)e−αx]=∫−∞+∞ϕ(x)e−αxp(x)dx=12π∫−∞+∞ϕ^(ξ)p^*(ξ+iα)dξ=12π∫−∞+∞ϕ^*(ξ)p^(ξ+iα)dξ=Fξ→x−1[ϕ^*(ξ)p^(ξ+iα)](0),wherep(x)=pM(x,N)or pm(x, N) for lookback options (to be synthetic, in the following we will consider only fixed-strike lookback options written on the minimum),p(x)=pX,M(x,N)or pX, m(x, N) for single-barrier options, andp=pX,m,M(x,N)for double-barrier options. The introduction of a damping factor in the payoff is compensated by a shift of the Fourier transform of the probability density function.While it is known that the Fourier transform of the truncated damped payoff for a barrier option is(35)ϕ^(ξ)=S0(eb(1+α+iξ)−ea(1+α+iξ)1+α+iξ−ek+b(α+iξ)−ek+a(α+iξ)α+iξ)witha=max(l,k),b=ufor a call option anda=min(k,u),b=lfor a put option (Green et al., 2010, Eq. (3.26)), the main problem in evaluating path-dependent options is the computation of the characteristic functions of the (joint) probability densities defined in Eqs. (5)–(8). Here we exploit the Spitzer identity and the factorization procedure previously described. So let us assume for the moment that the quantities appearing on the right-hand side of Eqs. (12)–(16) are known; then if we take their inverse z-transform defined in Eq. (9) we finally obtain the option price through the double inverse transform(36)v(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Zq→N−1[p^˜(ξ+iα,q)]],evaluated forx=0.33The Fourier transform and the z-transform, and also their inverses, can be interchanged because the z-transform is a power series in q which converges uniformly in a closed and bounded set given by the radius of convergence ρ (Fusai, Abrahams, & Sgarra, 2006). In Eq. (36) the inverse z-transform is performed before the inverse Fourier transform to minimize the computational cost. The reason is that the inversion operatorZq→N−1is well approximated by a sum ofN+1terms (ornE+mE+1if the Euler acceleration is considered). Therefore, from a computational point of view it is advantageous to do a single inverse Fourier transform of the sum instead of a separate transform of each of the addends.A few little improvements, discussed later on, can be adopted in order to enhance the numerical accuracy of the final result.In this case, without loss of generality we consider only a fixed-strike lookback put on the minimum, where it is natural to assume K ≤ S0, so that the contract can or cannot be exercised at maturity. The pricing formula (36) readsv(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Zq→N−1[1Φ+(0,q)Φ−(ξ+iα,q)]]evaluated forx=0; however, assuming a number of monitoring dates N > 1, it is convenient to modify the above pricing formula intov(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Ψ(ξ+iα,Δ)×Zq→N−1−1[1Φ+(0,q)Φ−(ξ+iα,q)]].The conjugated Fourier transform of the payoff function is smoothed by the multiplication by the characteristic function Ψ, giving it the required regularity to ensure an exponential decay of the error. This procedure computes the distribution Pmnot starting from time 0, but moving one step forward with a convolution procedure. This corresponds to multiplying by Ψ the Fourier transform of the Dirac delta function, i.e., the value of the probability at time 0, and then applying the Spitzer identity. Indeed(37)Fx→ξ[pm(x,N)]=Zq→N−1[1Φ+(0,q)Φ−(ξ,q)]=Zq→N−1−1[Ψ(ξ,Δ)Φ+(0,q)Φ−(ξ,q)]for any x < 0.44The hypothesis K ≤ S0 implies thatϕ(x)=0if x ≥ 0, therefore we are only interested in the distribution of the minimum for negative values of x.The algorithm can be summarized by the schemeϕ⟶Fϕ^δ⟶F1⟶ΨΨ↘↗A⟶ZSv^N⟶F−1vNwhere the operatorZSis defined asZS[ϕ^(ξ),Ψ(ξ,Δ)]=ϕ^*(ξ)Ψ(ξ+iα,Δ)×Zq→N−1−1[1Φ+(0,q)Φ−(ξ+iα,q)].The conjugate operator applied toϕ^is due to the Parseval relation. Therefore, the full procedure consists of the steps:1.For each q necessary to invert the z-transform, factorizeΦ(ξ,q):=1−qΨ(ξ,Δ)=Φ+(ξ,q)Φ−(ξ,q)and compute the Spitzer identityR(ξ,q):=1Φ+(0,q)Φ−(ξ,q).We recall thatp^m(ξ,N)=Zq→N−1[R(ξ,q)]=Ψ(ξ,Δ)Zq→N−1−1[R(ξ,q)]due to Eq. (37).Apply the inverse z-transformZq→N−1−1toR(ξ+iα,q)and multiply the result byϕ^*(ξ)Ψ(ξ+iα,Δ),obtainingv^(ξ,N).Apply the inverse Fourier transform tov^(ξ,N)and pick the value forx=0,obtaining the option price.A similar procedure is valid for fixed-strike lookback call options written on the maximum, wherep^˜M(ξ,q)is used in place ofp^˜m(ξ,q)and the additional hypothesis K ≤ S0 is replaced by K ≥ S0.Without loss of generality, let us consider the case of a down-and-out barrier option. The pricing formula (36) readsv(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Zq→N−1[eilξP+(ξ+iα,q)Φ+(ξ+iα,q)]];however, assuming a number of monitoring dates N > 2, it is convenient to modify it intov(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Ψ(ξ+iα,Δ)×Zq→N−2−1[eilξ+iαP¯+(ξ+iα,q)Φ+(ξ+iα,q)]]whereP¯(ξ,q):=Ψ(ξ,Δ)e−ilξΦ−(ξ,q)=P¯+(ξ,q)+P¯−(ξ,q).More precisely, we reduce the number of monitoring dates by one and multiply the payoff function by the characteristic function to smooth it. From a financial point of view, this is equivalent to price an option withN−1monitoring dates and payoffv1=v(x,1),where v(x, n) is the value of the option with log-price x at time(N−n)Δ. From a technical point of view, this corresponds to applying a first step of the convolution pricing procedure; see the supplementary material, Section C.1. Then we proceed as for lookback options. Our algorithm can be summarized by the scheme(38)ϕ≡v0⟶Fv^0⟶Ψ*v^1aaaaaδ⟶F1⟶ΨΨ↘↗A⟶ZSv^N⟶F−1vNwhere in this case we denote withZSthe operatorZS[v^1(ξ),Ψ(ξ,Δ)]=v^1*(ξ)Zq→N−2−1[eilξP¯+(ξ+iα,q)Φ+(ξ+iα,q)].The substitution of P withP¯is again a smoothing procedure necessary to achieve the regularity required to ensure an exponential decay of the error. This substitution is related to the procedure sketched in Eq. (38): in computing the distribution PX, mwe do not start from time 0, but we move one step forward via a convolution, which corresponds to multiplying by Ψ the Fourier transform of the Dirac delta function. Then we apply the Spitzer identity. Moreover, notice that the procedures given by Eq. (38) are performed backward and forward-in-time, as one (starting point: payoff at time T) is related to the price of the derivative, while the other (starting point: Dirac delta at time 0) to the probability distribution of the log-price.55We recall that the Fourier transform of the backward-in-time transition density isΨ*(ξ,Δ)=Fx→ξ[f(−x,Δ)],where f(x, Δ) is the forward-in-time transition density and Ψ(ξ, Δ) its Fourier transform.Therefore, for a down-and-out barrier option we perform the steps:1.For each q necessary to invert the z-transform, factorizeΦ(ξ,q):=1−qΨ(ξ,Δ)=Φ+(ξ,q)Φ−(ξ,q),decomposeP¯(ξ,q):=Ψ(ξ,Δ)e−ilξΦ−(ξ,q)=P¯+(ξ,q)+P¯−(ξ,q),and compute the Spitzer identity(39)R(ξ,q):=eilξP¯+(ξ,q)Φ+(ξ,q).The function R(ξ, q) is related top^˜X,m(ξ,q)in Eq. (12): more precisely,Zq→N−1−1[R(ξ,q)]=Zq→N−1[p^˜X,m(ξ,q)]=p^X,m(ξ,N).Apply the inverse z-transformZq→N−2−1and then the inverse Fourier transform, obtaining the option price fromv(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Ψ(ξ+iα,Δ)×Zq→N−2−1[eil(ξ+iα)P¯+(ξ+iα,q)Φ+(ξ+iα,q)]]evaluated forx=0.For the double-barrier option pricing problem the missing piece is the computation of the factorsJ+andJ−in Eq. (16). This requires the solution of a system of two integral equations, and we apply here the new fixed-point algorithm presented in Section 2.Starting from Eqs. (17) and (18), as for the single-barrier case we assume a number of monitoring dates N > 2 and we move one step forward in the computation of the probability dPX, m, Mvia convolution. So we replace Eqs. (19) and (20) with(40)J−(ξ,q)Φ−(ξ,q)=[e−ilξΨ(ξ,Δ)−ei(u−l)ξJ+(ξ,q)Φ−(ξ,q)]−,(41)J+(ξ,q)Φ+(ξ,q)=[e−iuξΨ(ξ,Δ)−ei(l−u)ξJ−(ξ,q)Φ+(ξ,q)]+.To compute J± we consider the iterative procedure presented in Section 2, dealing withP¯(j)(ξ,q):=e−ilξΨ(ξ,Δ)Φ−(ξ,q)−ei(u−l)ξJ+(j−1)(ξ,q)Φ−(ξ,q)=P¯+(j)(ξ,q)+P¯−(j)(ξ,q)Q¯(j)(ξ,q):=e−iuξΨ(ξ,Δ)Φ+(ξ,q)−ei(l−u)ξJ−(j)(ξ,q)Φ+(ξ,q)=Q¯+(j)(ξ,q)+Q¯−(j)(ξ,q),instead of Eqs. (21) and (22), respectively. Once J± are obtained via the fixed-point algorithm, we compute(42)R(ξ,q):=Ψ(ξ,Δ)Φ(ξ,q)−eilξJ−(ξ,q)Φ(ξ,q)−eiuξJ+(ξ,q)Φ(ξ,q).The function R(ξ, q) is related top^˜X,m,M(ξ,q)in Eq. (16): more precisely,Zq→N−1−1[R(ξ,q)]=Zq→N−1[p^˜X,m,M(ξ,q)]=p^X,m,M(ξ,N).Therefore the scheme for the computation of the option price is:1.For each q necessary to invert the z-transform, factorizeΦ(ξ,q)=1−qΨ(ξ,Δ)=Φ+(ξ,q)Φ−(ξ,q),and compute R(ξ, q) via the iterative scheme.Apply the inverse z-transformZq→N−2−1toR(ξ+iα,q)and then the inverse Fourier transform, obtaining the option price inx=0from(43)v(x,N)=e−rTFξ→x−1[ϕ^*(ξ)Ψ(ξ+iα,Δ)Zq→N−2−1[R(ξ+iα,q)]].Thus, the methodology to price a double-barrier option is close to the one proposed for single-barrier contracts and consists of the same steps as sketched in Eq. (38), with a different R(ξ, q) inside the operatorZS[v^1(ξ),Ψ(ξ,Δ)]=v^1*(ξ)Zq→N−2−1[R(ξ,q)],i.e. the R(ξ, q) computed from Ψ(ξ, Δ) and q via the fixed-point algorithm defined in Eq. (42) instead of the one in Eq. (39). Even if the factorization is performed with a sinc function expansion of the Hilbert transform as described in Section 3.1, our numerical experiments show that, due to the fixed-point algorithm for R(ξ, q), this pricing algorithm provides a quadratic convergence of the error instead of the exponential one of single-barrier (and lookback) options.In this section we compare the proposed pricing techniques with others presented in the literature. We consider:•Z-S, i.e., the new fast method presented in this article.CONV, i.e., the convolution method of Lord et al. (2008) described in the supplementary material, Section C.1.HILB, i.e., the recursive method of Feng and Linetsky (2008a) based on the Hilbert transform and described in the supplementary material, Section C.1.REC-QUAD, i.e., the recursive method based on the trapezoidal quadrature rule and described in the supplementary material, Section C.2.Z-QUAD, i.e., the method of Fusai et al. (2012) based on the z-transform and the trapezoidal quadrature rule, described in the supplementary material, Section C.3.The Z-QUAD algorithm requires to solve several WH integral equations via quadrature formulas. Another possibility consists in relating the Spitzer-WH factorization to the solution of these integral equations. Indeed, the well-known methodology to solve a WH integral equation also requires the knowledge of the WH factors. Therefore, we also consider the following new method•Z-WH, i.e., a new method which improves Z-QUAD exploiting WH factorization via the Hilbert transform and sinc functions; see the supplementary material, Section C.3.All the numerical experiments have been performed with Matlab R2013b running under Windows 7 on a personal computer equipped with an Intel Core i7 Q720 1600 MHz processor and 6 GB of RAM. We would like to stress that with lookback and single-barrier options and with all Fourier-based methods we have unbounded domains. Therefore, we use a domain truncation based on a moments bound with tolerance10−8(Fusai et al., 2012); thus the truncation error is constant, but, according to numerical experiments (Fusai et al., 2009; Fusai et al., 2012), it does not affect the first significant decimal digits.First of all, we consider a down-and-out call barrier option assuming that the underlying asset evolves according to a Merton jump diffusion process with the same parameters as in Feng and Linetsky (2008a), including the procedure to choose the damping parameter α. The lower barrier isL=0.8,the initial spot price S0 and the strike price K are both set to 1, and the time to maturity isT=1. The underlying asset has a dividend rateδ=0.02and the risk-free interest rate isr=0.05.In Fig. 1we consider the case withN=100andN=252monitoring dates: we report in double logarithmic scale the pointwise absolute error, computed at the spot priceS0=1,taking as exact solution the price computed with the HILB method and a grid of 216 points. The CONV, REC and Z-QUAD methods have a polynomial convergence; moreover the REC and the Z-QUAD algorithms show a similar polynomial accuracy. Our newly proposed methods, Z-S and Z-WH, and the HILB algorithm exhibit an exponential convergence due to the use of the sinc expansion and to the fact that all computations are performed in Fourier space, as already described by Feng and Linetsky (2008a). As expected, both the Z-S and Z-WH methods rapidly reach the maximum accuracy allowed by the approximation used to invert the z-transform, i.e.,10−12.In Fig. 2 we report the pointwise absolute error against the CPU time necessary for the price computation for different numbers of monitoring dates. It is clear that the Z-S, the Z-WH and the HILB methods are the most accurate. Their exponential convergence enables them to be used with a limited number M of grid nodes. The Z-S and the Z-WH methods are able to compute option prices with an accuracy of10−12in less than a quarter of a second. Notice that increasing the number of monitoring dates from 252 to 504 or 1260, the computational costs of the methods based on the z-transform do not change because of the Euler acceleration technique. From these experiments it appears that, among the methods proposed in this paper, Z-S and Z-WH are preferable when the number of dates is large. However, if a greater accuracy is necessary and the number of monitoring dates is not too large, the HILB method by Feng and Linetsky (2008a) should also be considered.To complete the numerical tests on single-barrier options, Table 1shows results for a down-and-out barrier call option, assuming that the underlying asset evolves according to a NIG process with the same parameters as in Feng and Linetsky (2008a). All the other parameters are as before. These results confirm the good performance of the Z-S and Z-WH algorithms when the number of monitoring dates increases. Moreover, it is not possible to state which method between Z-S and Z-WH should be preferred, as they are comparable in accuracy and computational cost. This is not surprising, as the two algorithms are made of the same building blocks, even if they have been developed from two different relations, i.e., the Parseval equation for Z-S and the recursive approach for Z-WH.In Fig. 3we consider a double-barrier option and we plot the pointwise absolute error for the fixed-point algorithm presented in Section 4.3. We use the Kou double exponential model Kou (2002), again with the same parameters as in Feng and Linetsky (2008a). The lower (upper) barrier isL=0.8(U=1.2), the initial spot price isS0=1and the strike price isK=1.1. A one year daily monitoring is assumed, i.e.,T=1andN=252. The error is again computed considering as exact the solution computed with the HILB method andM=216grid points. The numerical experiments show that the orders of convergence of the newly proposed algorithms, Z-WH and Z-S, are no more exponential as in the single-barrier case, but approximately quadratic. We would like to stress that the average number of fixed-point iterations necessary to reach a tolerance of10−12is as low as 3. Moreover, the newly proposed methods are still slightly more accurate than the CONV, REC and Z-QUAD ones.Finally, in Table 2 we price a fixed-strike lookback call option written on the maximum and a put option written on the minimum, both withN=50monitoring dates andS0=K=1. We assume that the underlying asset evolves as a geometric Brownian motion with the same parameters as in Feng and Linetsky (2009), i.e.,σ=0.3,r=0.1,T=0.5. We report the option price and the computational cost of the Z-S approach for different numbers of grid points M. From this table we notice the same exponential convergence of the algorithm as in the single-barrier case.

@&#CONCLUSIONS@&#
In this article we presented a fast and accurate constructive procedure to perform the Wiener-Hopf factorization of a complex function. As a concrete application we considered the pricing of barrier and lookback options, when the monitoring is discrete and the underlying evolves according to an exponential Lévy process. Our procedure is based on the combined use of Hilbert and z-transforms. The numerical implementation exploits the fast Fourier transform and the Euler summation. The computational cost is independent of the number of monitoring dates. In addition, the error decays exponentially with the number of grid points. For the double-barrier case we also introduce a new iterative algorithm based on the Wiener-Hopf factorization. Applications to pricing of exotic derivatives confirm the exponential accuracy of the proposed method. Extensions to other exotic derivatives, like perpetual Bermudan, occupation time, quantile and step options are straightforward combining our method with the Wendel-Port-Dassios identity (Dassios, 1995). Applications of the proposed procedure to other fields such as insurance, queuing theory and fluid mechanics are currently under investigation.