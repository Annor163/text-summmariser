@&#MAIN-TITLE@&#
Monte-Carlo simulations of clinically realistic respiratory gated 18F-FDG PET: Application to lesion detectability and volume measurements

@&#HIGHLIGHTS@&#
We create a dataset of clinically realistic Monte-Carlo respiratory PET data.We validated the realism of the simulated data.We evaluated the lesion detectability regarding their location, volume and contrast.Respiratory-gating of 18F-FDG PET images improves the accuracy of volume estimates.

@&#KEYPHRASES@&#
PET,Monte-Carlo simulation,Respiratory gating,Image segmentation,

@&#ABSTRACT@&#
In PET/CT thoracic imaging, respiratory motion reduces image quality. A solution consists in performing respiratory gated PET acquisitions. The aim of this study was to generate clinically realistic Monte-Carlo respiratory PET data, obtained using the 4D-NCAT numerical phantom and the GATE simulation tool, to assess the impact of respiratory motion and respiratory-motion compensation in PET on lesion detection and volume measurement. To obtain reconstructed images as close as possible to those obtained in clinical conditions, a particular attention was paid to apply to the simulated data the same correction and reconstruction processes as those applied to real clinical data. The simulations required 140,000h (CPU) generating 1.5 To of data (98 respiratory gated and 49 ungated scans). Calibration phantom and patient reconstructed images from the simulated data were visually and quantitatively very similar to those obtained in clinical studies. The lesion detectability was higher when the better trade-off between lesion movement limitation (compared to ungated acquisitions) and image statistic preservation is considered (respiratory cycle sampling in 3 frames). We then compared the lesion volumes measured on conventional PET acquisitions versus respiratory gated acquisitions, using an automatic segmentation method and a 40%-threshold approach. A time consuming initial manual exclusion of noisy structures needed with the 40%-threshold was not necessary when the automatic method was used. The lesion detectability along with the accuracy of tumor volume estimates was largely improved with the gated compared to ungated PET images.

@&#INTRODUCTION@&#
PET using 18F-FluoroDeoxyGlucose (18F-FDG PET) is a useful adjunct to Computed Tomography (CT) for radiotherapy planning. It yields a better delineation and discrimination of tumor tissues especially in patients with Non-Small Cell Lung Cancer (NSCLC). When combined with CT planning images, it often leads radiation oncologists to modify the definition of the Gross Tumor Volume (GTV) [1]. Using 18F-FDG PET also decreases inter and intra observer variability in tumor delineation [2]. However, in PET/CT thoracic imaging, respiratory motion has been reported as a limiting factor reducing image quality and biasing lesion volume measurement. It introduces blurring, reduces contrast and leads to the underestimation of activity concentrations and overestimation of lesion volumes in PET data [3]. The commercially available solution consists in performing respiratory gated PET acquisitions, so that the respiratory cycle is segmented in multiple phases for which movement is limited [4]. Validation of such approach requires a perfect knowledge of the image parameters (such as organ motions, lesion contrast and volume, activity concentration). To that end, the Monte-Carlo simulations are the ideal tool since it allows a complete description of the data not accessible in the case of patient studies [5].The first aim of this study was to generate clinically realistic respiratory gated 18F-FDG-PET images. We focused our work on the data post-processing (correction and reconstruction) to produce realistic images. We used these simulated data to evaluate the contribution of respiratory gating on tumor volume and GTV definition knowing all image parameters. We also investigate the impact of respiratory gated images on tumor uptake estimation regarding the lesion location and displacement.Other authors have already proposed the simulation of PET respiratory gating datasets. However, none of them have proposed to create a whole set incorporating multiple lesion positions, size and contrast or different respiratory bin sampling [6–8]. Since one single case, will not be sufficient to address the problem of respiratory gating, we had to use a scenario allowing the creation of multiple dataset based on the creation of a lesion-free patient and of multiple lesion varying in location and size.First, the simulations were validated using a static cylindrical phantom mimicking the commercially available Jaszczak Deluxe® phantom and comparing simulated and real, phantom and patient data. Second, the tumor volume (TV) and the displacement volume (DV), corresponding to the volume covered by the lesion during breathing, (i.e. to the volume to be considered for non-gated radiotherapy treatment planning), were compared depending on whether they were derived from ungated or respiratory gated PET acquisitions. Segmentation of these volumes (TV and DV) was performed using an automatic iterative and adaptive method [9] and a fixed threshold of 40% of the maximum intensity within the lesion.Geant4 Application for Emission Tomography (GATE) [10] was used to perform the simulations. The SIEMENS Biograph Sensation 16 Hi-Rez PET scanner corresponding to that used in the Department of Nuclear Medicine of the Henri Becquerel Center and Rouen University Hospital was modeled [11–13]. Its physical characteristics are given in Table 1.The acquisition bed was also modeled. To mimic the limited energy and temporal resolution of a real scanner, the energy and detection time associated with each particle were blurred using Gaussian functions (FWHMenergy=15% at 511keV and FWHMtime=1.15ns). We also implemented a 500ns delayed coincidence window (4.5ns) used for random correction, applying a correction process similar to that used in the real scanner. The scanner dead-time was not considered. Sinograms were modified to account for the light sharing in the detector block, by spreading the detected events over the surrounding detectors, considering a Gaussian probability distribution. The Gaussian full-width at half maximum (FWHM) was derived by comparing simulated (FWHMs=1.43 pixels) and experimental (FWHMe=1.89 pixels) spatial resolutions in the sinogram of an 18F-FDG PET point source.Acquisitions were simulated in 3D mode and run on the CRIHAN supercomputer (http://www.crihan.fr). Prompts and delayed coincidences were recorded, as well as singles detected inside the energy window.Two types of numerical phantoms were used. First, a cylindrical phantom containing 21 spheres with volumes ranging from 0.20 to 200mL (i.e. 0.20, 0.43, 0.71, 0.99, 1.5, 2.1, 2.9, 3.8, 6.4, 9.0, 11.6, 15.4, 19.3, 23.6, 27.9, 43.0, 58.1, 77.7, 97.3, 148.6 and 200.0mL) was defined. The simulations were performed considering 9 source-to-background activity ratios (S/B) ranging from 2.0 to 20.6 (i.e. 2.0, 2.7, 3.4, 4.9, 6.3, 7.7, 12.0, 16.3 and 20.6) and for 4 acquisition durations (1, 2, 3 and 4min), corresponding to different noise levels, for each S/B. These durations yielded for example 17, 33, 50 and 66 million prompts for the lowest S/B (2.0). These simulations were used to calibrate the iterative segmentation algorithm described in Section 2.5.Realistic 18F-FDG PET thoracic scans were also simulated. The voxelized thoracic 4D NCAT phantom [14] of 128×128×86 isotropic voxels (size 4.68mm) was used to simulate both cardiac and respiratory motions (see Fig. 2). The phantom covered 402mm, that is approximately 2.5 times the axial FOV and was centered on the upper border of the diaphragm. The arms were numerically removed to mimic clinical situations (patient with arms above the head). To take into account the contributions of randoms and multiple events coming from regions outside the FOV, head and neck, part of the abdomen (232mm in length and 204mm in diameter) and pelvis (255mm in length and 330mm in diameter) were also modeled. These body parts were modeled analytically (instead of using a voxelized description) to reduce computation time, since GATE allows the combination of analytical (using parametric functions) and voxelized description of the simulated objects. The whole simulated model is shown in Fig. 1. The geometric parameters of these analytical volumes of interest (VOIs) (volume, thickness, etc.) were derived from the NCAT phantom and/or from measurements (considering the median) performed in 10 patients with morphology close to that used for the design of the NCAT phantom (i.e. a 90kg man). Fourteen different functional organs and structures were defined: bladder, blood pool (left and right atria/ventricle chambers, arteries and veins), brain, heart myocardium, kidney, liver, lungs, ribs, soft tissues/muscle, spine bone, spleen, stomach and urethra. 18F-FDG activity concentrations were obtained from median measurements performed in the same set of 10 patients. These data are summarized in Table 2.For tissue attenuation, 5 different media were considered: air, lungs, spine bone, ribs and soft tissues. A breathing cycle of 4s with a motion amplitude of 2cm for the diaphragm in the axial direction and of 1.2cm in the anterior–posterior direction was defined. This model was first used to initially simulate tumor-free patient data, consisting of a set of 8 emission and transmission frames throughout the respiratory cycle with acquisition duration of 1min for each frame (i.e. 13 million prompts). Then, spherical lesions (1, 2, 3, 4cm in diameter) were simulated independently in 5 different locations (see Fig. 2): lower part of the middle and inferior lobes of the right lung, upper and lower part of the inferior lobe of the left lung, upper part of the right lobe of the liver, considering 4 S/B (2, 4, 6, 8). These S/B were defined according to the background activity surrounding the lesion (i.e. lungs and liver tissue respectively).In these simulations, most of the computation time is due to the simulation of the photons coming from healthy organs, compared to those coming from the tumors. To reduce the simulation time and reuse the simulated data in different configurations, we generated respiratory-gated 18F-FDG PET thoracic scans of the patients (P) by simulating independently a healthy subject (HS) and only a tumor (TO). A particular attention was paid to the corrections and reconstruction of the recombined data as explained in Sections 2.3 and 2.4.Finally, the simulated data were recombined as a function of the prompts time tag, to obtain 2 additional respiratory cycle sampling (RCS) in 5 (mimicking our clinical protocol) and 3 frames. Four RCS were therefore created: ungated, gated in 3, 5 and 8 frames. Transmission maps corresponding to each frame of the considered RCS were generated for attenuation correction purpose only.To obtain reconstructed images as close as possible to those obtained using the Biograph in clinical conditions, a particular attention was paid to apply the same type of reconstruction and correction processes on the simulated data as on clinical data. First, the normalization factors appropriate for the simulated tomograph (accounting for geometric effects, crystal efficiencies, dead time, etc.) were derived as one would do for real data.Crystal efficiencies were assumed to be constant for all detectors and dead time was not considered because it was not simulated. Therefore, only the geometric effects (gap filling, cylindrical and spherical scanner geometry) were considered and directly obtained from the scanner normalization file. Although the random and scatter contributions could be determined using Gate, their corrections were actually performed using the same type of methods used in the real scanner. Random correction was performed by subtracting an estimate of the randoms from the prompt. A variance reduced estimation of the random events recorded in the delay time window was obtained using the exact single-plane Casey method [15] expanded to 3D mode. Scatter was corrected following the algorithm proposed by Watson [16]. For attenuation correction, the NCAT transmission frames were smoothed in 3D to remove tissue transition artifacts, using a point spread function corresponding to the simulated Biograph PET image resolution. The FHWM parameters of the Gaussian function were 5.8 and 4.0mm in the transaxial and axial direction respectively. Whatever the respiratory cycle sampling that was considered, each emission frame was corrected for attenuation with its corresponding transmission map to avoid biasing the attenuation correction. For each RCS, the attenuation map was generated, weighting the attenuation map with the time ratio between the considered RCS and the original simulated RCS (8 frames of 60s). For example, when considering an RCS of 5 frames of 96s (8×60/5), the 5 following attenuation maps were generated:5Att1=60/96×8Att1+36/96×8Att25Att2=24/96×8Att2+60/96×8Att3+12/96×8Att45Att3=48/96×8Att4+48/96×8Att55Att4=12/96×8Att5+60/96×8Att6+24/96×8Att75Att5=36/96×8Att7+60/96×8Att8As a result, both CT and PET acquisitions were considered to be gated.A data recombination approach similar to the one published recently [8] was used to generate the final simulated 18F-FDG respiratory gated PET thoracic scans of the patient. The recombination consists in creating the patient prompt sinogram (P) by merging that of the healthy subject (HS) with that of the tumor only (TO). In lung lesions, the attenuating tissue at the location of the simulated lesion was not the same in the HS and TO data (lungs and soft tissue respectively). This difference has to be taken into account during the recombination and correction process of the summed prompt sinograms. Actually, neither the HS nor the TO attenuation maps can be directly used to accurately correct the merged data. To solve this issue, a method, consisting in 4 steps, was used [17,18] (Fig. 3). This approach was applied for each respiratory frame.(1)In the HS sinogram, all prompts coming from the future tumor location were identified and removed. The resulting HS sinogram thus had no activity coming from the lung lesion location.HS and TO prompt sinograms were corrected for normalization, randoms, scatter and attenuation independently. The contributions of scatter and attenuation were estimated using respectively the HS and TO attenuation maps.Both previously corrected sinograms were added to generate that of the patient including the lesion.Finally, images were reconstructed into 81 slices of 168×168 voxels (4.06mm×4.06mm×2mm) using Fourier rebinning (FORE) and attenuation weighted ordered subsets expectation maximization (AW-OSEM) iterative algorithms with the TO attenuation map (equivalent to the patient one). As performed for real clinical data, AW-OSEM was used to reduce the bias introduced by pre-correcting the sinograms for attenuation before reconstruction. Reconstruction parameters of 4 iterations, 8 subsets and a 3D post-reconstruction filtering of FWMH=5mm were chosen to match the clinical reconstruction protocol. To check the consistency of the whole procedure, images obtained from the combination of a 4cm lung tumor with S/B=1 and the HS were compared to those of the HS reconstructed directly with the standard clinical procedure.Using our simulated data, we investigated the accuracy of tumor segmentation methods. The segmentation was applied on each frame of the gated data. Two methods were considered to segment the tumors. The first used a constant threshold of 40% of the maximum intensity within the lesion (M40%), as described in [19]. An automatic adaptive and iterative thresholding approach derived from a method previously proposed by Daisne et al. [20] and modified to be applicable to clinical data [9] was also used (MAut). It is known that the optimal threshold ThOpt to accurately measure the true tumor volume from PET images depends on the local lesion contrast (ContLocMeas). In MAut, ThOpt and ContLocMeas were iteratively updated until convergence using: ThOpt=A1+A2/ContLocMeas where A1 and A2 are 2 constants previously adjusted from the cylindrical phantom data described in Section 2.2.ThOpt was defined according to an averaged maximum intensity voxel value within the lesion (MaxAvg, computed within a pseudo-spherical region of 0.5mL, large enough to reduce the influence of noise and small enough to be used on small lesions) to limit the influence of noise. ContLocMeas corresponds to the contrast between MaxAvg and the local background of the lesion, estimated inside a shell surrounding the segmented volume. The method is decomposed in 4 steps. Once the user has selected one voxel within the lesion, the first step creates a volume of interest (VOIinit) including the lesion and computes both MaxAvgwithin the lesion and the initial threshold Thi=0 of the iterative process. From this threshold value, the second step extracts the largest 3D volume, VOIi=0, of connected voxels in VOIinit. The third step calculates ContLocMeasbetween VOIiand surrounding tissues. In the last step, the threshold value Thiis optimized in an iteration loop to get ThOpt. In addition, morphological mathematical operations were used before and during the segmentation process to avoid the integration of noisy or neighboring structures in the segmented volume and ensure its connexity, which is particularly important for small and/or low contrast lesions. A more comprehensive description of MAut can be found in [9,21].The impact of respiratory gating on GTV definition was assessed by measuring the DV, corresponding to the volume covered by the lesion during breathing, using the different datasets. As illustrates in Fig. 4, for a given gated acquisition, DV was computed by taking the union of the different segmented volumes obtained in each frame, using one of the approaches described in Section 2.5. Four estimates of the DV were performed depending on RCS (5 frames and ungated data) and threshold method considered (TM: MAut, M40%): DV_5MAut, DV_UnMAut, DV_5M40% and DV_UnM40%.When MAut was used, A1 and A2 parameters were defined using the calibration data corresponding to the acquisition duration closest to that of each frame of the RCS. Knowing the simulated lesion size and displacement, we were able to determine the true DV (DVTr) for each lesion and displacement. The accuracy of DV estimate was then evaluated by computing the average error between each DV_RCSTM and its true associated DV: ErrDV=DV_RCSTM−DVTr.

@&#CONCLUSIONS@&#
