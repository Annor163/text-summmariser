@&#MAIN-TITLE@&#
Evaluation of matched control algorithms in EHR-based phenotyping studies: A case study of inflammatory bowel disease comorbidities

@&#HIGHLIGHTS@&#
Appropriate control selection is essential to the success of population studies.Heterogeneous populations in observational data require novel matching methods.In EHR studies, matching by healthcare utilization improves comorbidity detection.Controls matched to inflammatory bowel disease patients identified likely comorbidity.

@&#KEYPHRASES@&#
EHR,Controls,Matching,Comorbidity,Inflammatory bowel disease,

@&#ABSTRACT@&#
The success of many population studies is determined by proper matching of cases to controls. Some of the confounding and bias that afflict electronic health record (EHR)-based observational studies may be reduced by creating effective methods for finding adequate controls. We implemented a method to match case and control populations to compensate for sparse and unequal data collection practices common in EHR data. We did this by matching the healthcare utilization of patients after observing that more complete data was collected on high healthcare utilization patients vs. low healthcare utilization patients. In our results, we show that many of the anomalous differences in population comparisons are mitigated using this matching method compared to other traditional age and gender-based matching. As an example, the comparison of the disease associations of ulcerative colitis and Crohn’s disease show differences that are not present when the controls are chosen in a random or even a matched age/gender/race algorithm. In conclusion, the use of healthcare utilization-based matching algorithms to find adequate controls greatly enhanced the accuracy of results in EHR studies. Full source code and documentation of the control matching methods is available at https://community.i2b2.org/wiki/display/conmat/.

@&#INTRODUCTION@&#
In the United States, electronic health record (EHR) adoption has increased dramatically in recent years. In 2012, 44% of hospitals reported having an operational EHR, up from 8.8% in 2008 [1]. The growth of EHRs has created large longitudinal data sets that enable a variety of population studies. EHRs have been shown to provide important strengths over other data sources, including large, diverse populations representing real-world patterns of disease and treatment with a wide variety of data types [2–4]. Investigators have leveraged these data sources for testing targeted hypothesis of drug-adverse effect associations [5–7] and comparing effectiveness of established therapies [8]. More recently, researchers have also aimed to identify novel genetic associations to EHR-derived phenotypes [9]. In these studies, institutions establish a biorepository of discarded blood samples which are linked to EHR data. DNA is extracted from collected samples and used to conduct genotype–phenotype association studies [3,10,11].Many of these EHR-based observational studies employ a case-control design where a case population of patients with a disease are identified and a set of control patients are used for statistical comparisons. The validity of theses designs are quite sensitive to the methods used to select a comparison group. In an optimal scenario, selected controls should represent the population of individuals who would have been identified and included as cases had they also developed the disease used to define the cases [13]. One limitation of the EHR-based data sources, however, is data may be sparse and unequally collected across patient populations. This effect is determined, in part by the health status of the patient, since patients who are very ill and have been seen for longer periods of time have more information in the EHR than healthier people. This effect introduces a serious ascertainment bias [12,13] that may adversely impact the proper interpretation of EHR-based studies. For example, a case patient with a history of chronic disease X is much more likely to have recorded comorbidities or other potential study outcome than a control patient selected based on the absence of that chronic disease who may have had few encounters with the healthcare system due to lack of a recorded disease.Thus the primary aim of a control matching algorithm relying on EHR data should be to find proper controls in the context of a heterogeneous patient population and inconsistent data collection that may confound results [14]. However, many case-control studies relying on EHR or insurance claims data only employ traditional methods to match based on patient age and gender [5]. Furthermore, the authors have been unable to identify methods for matching controls specifically targeted to EHR data in the published literature.In this work we aim to investigate varying control matching approaches to improve the selection of controls in the EHR of a large health system. Cases are matched to 4 control groups of varying complexity ranging from randomly selected matches to matching based on a combination of demographic and healthcare utilization features. We evaluate our control matching methods by analyzing the comorbidity profile of two diseases related to inflammatory bowel disease (IBD): ulcerative colitis (UC) and Crohn’s disease (CD) using a reference standard created by a subject matter expert as well as by comparing distribution of comorbidities when comparing the cases against each control group. The detailed methods and source code of the matching algorithms evaluated in this work are made publicly available as open source software implemented on the Informatics for Integrating Biology and the Bedside (i2b2) platform.The Partners HealthCare electronic health record (EHR) includes sociodemographic data, billing codes, laboratory results, problem lists, medications, vital signs, procedure reports and narrative notes from Massachusetts General Hospital (MGH) and Brigham and Women’s Hospital (BWH), as well as from community and specialty hospitals that are part of the Partners HealthCare system in Boston (Massachusetts, USA). All patients with at least one ICD-9 diagnosis code between January 1998 and April 2012 at MGH or BWH were selected for inclusion in a data set (referred to as a data ‘mart’), yielding 2.8million patients drawn from about 5million unique patients in the Partners system. The data mart consists of all electronic records for the study patients and can be managed with the i2b2 server software (i2b2 v1.6, Boston, MA, USA) [15,16]. The Partners Institutional Review Board approved all aspects of this study.EHR phenotyping algorithms for Crohn’s disease (CD) and ulcerative colitis (UC) developed by Ananthakrishnan using the same data source were utilized to evaluate the matching algorithms in this study [17]. A sample of 1200 patients’ charts with a diagnoses of CD (ICD-9 555.∗) or UC (ICD-9 556.∗) were reviewed by a clinical expert to determine true disease status. Using the chart review results as a training dataset, a classification model for UC and CD was developed using coded data as well as structured elements derived from narrative notes through natural language processing (NLP). The CD and UC algorithms predicted cases with a fixed specificity of 97%, yielding a sensitivity of 69% and a positive predictive value of 98% for CD and a sensitivity of 79% and a positive predictive value of 97% for UC. The trained models were applied to the full population yielding 5506 patients with CD and 5522 patients with UC.A set of 2,688,958 patients without a diagnosis of UC or CD in their medical record were selected for inclusion into a control pool. Each matching algorithm will randomly match case patients to patients selected from the control pool using the specified matching criteria.For each patient in the case and control pool sets we extracted 3 demographic variables: age (A), gender (G), and race (R). In addition, 3 variables of healthcare utilization in the study period were calculated: number of facts (N), year of the first encounter in the healthcare system (F) and year of most recent encounter in the healthcare system (L). The number of facts refers to number of distinct encounters with the medical system and is a measure of health care utilization. For example, an office visit, a medication prescription, and a diagnosis code each contribute 1 fact. Gender and race groups were treated as categorical variables and matched exactly to control patients. Age was grouped into bins of decades of life (e.g. 0–9, 10–19). Healthcare utilization variables N, F and L were treated as continuous variables and divided into 8 quantile bins of uniform distribution (Table 1).Each case patient was then matched to one patient in the control pool (1:1) using 3 different paired matching algorithms: age, race and gender (AGR), number of health “facts” and first and most recent observation (NFL); and all matching factors (AGRNFL). For each matching process, patients selected from the control pool were only matched to one case patient (1:1 matching) without replacement into control pool. Each case-control matched pair was then assigned a pair identifier for the matching analysis. Where there were insufficient controls to match all factors, the non-categorical matching factors were relaxed iteratively until an appropriate control is found. Since the control sampling uses a greedy algorithm – cases matched first are more likely to find an exact matched control – the order in which the cases were matched was also randomized.For illustration, a hypothetical case patient that is 85years old, male, of Asian descent, with an observation period of 2001–2008 and 390 healthcare facts who is unable to find a control with the exact parameters would iteratively relax the matching parameters as follows: the age bin is relaxed downward one decile bin in an attempt to find a control aged 70–79 with other exact matching parameter bins. If none is found, the age bin is relaxed upward to find a control aged 90–99 with other exact parameter bins. Bins are only adjusted by 1 in either direction. If still no control is found, the number of facts bin is relaxed down one bin and then up one bin in the same way. The parameters are relaxed in this way until a control is found. If no control is found the case patient is discarded from the analysis. While a user can configure the algorithm to assign which parameters to relax, in which order and the number of bins to relax, for this paper we relax only the continuous parameters in the order A, N, F, L. Maximum adjustment of 1bin is used.A detailed diagram of the matching protocol is described in the flowchart included in Fig. 1. In addition, full source code and documentation for implementing the control matching methods in the i2b2 framework is available at https://community.i2b2.org/wiki/display/conmat/. The documentation contains additional details on methods utilized in this paper.As an additional control, we randomly sampled patients from the control pool without any matching on factors. In this group, control patients were unmatched to the cases (random). As a sensitivity analysis and for additional comparisons patients were also matched by each factor alone.A disease grouping file developed as part of the PheWAS research was downloaded in May 2013 [18]. PheWAS groupings are manually curated disease categories that generally follow the 3-digit code groupings within the ICD9 code system itself but modified to include semantically related groups. For example, all hypertension codes (401–405) are grouped together as one PheWAS grouping. For the purposes of this study, we pruned the PheWAS groups to exclude comorbidities with a frequency of less than 5 patients in either the cases or the matched controls were excluded from the analysis due to limited power to detect a true association. A total of 806 PheWAS groups were selected for inclusion in the analysis.The magnitude of the association between the IBD-related diagnosis and a given comorbidity is based on the relative risk (RR) between the disease and comorbidity calculated by constructing 2×2 contingency tables for each PheWAS group. Statistical significance and 95% confidence intervals were calculated using the chi-squared test [19].In order to evaluate each matching algorithms’ ability to discern clinically meaningful comorbidity association, a board-certified gastroenterologist (ANA) reviewed the full list of PheWAS disease groupings to indicate whether there existed prior literature demonstrating an association between the diagnosis and IBD in general. Identified comorbidities may have included associations due to IBD-related treatments to account for problems such as infections that are not directly associated with IBD, but could be associated with the immunosuppression medications taken for IBD. The resulting list was used as a reference set to empirically compare the results of our case-control analyses across the disease spectrum.Each control set was compared to UC or CD case sets based on the matching parameters as well as selected common comorbidities in the general population. In addition, the distributions of all comorbidity relative risks (RR) were visualized and compared across control sets. The distributions of comorbidities reaching statistical significance by Bonferroni-adjusted p-value for each control set were also reported. The ability of each case-control experiment to detect likely comorbidity associations was evaluated by transforming the estimated RR and associated standard error into a binary indicator depending on whether the 95% confidence interval for the RR excluded or included unity. The transformed binary classifier was compared to the expert-derived reference and the sensitivity (SE), specificity (SP) and positive predictive value (PPV) was computed on the basis of statistical significance at alpha=0.05 and alpha=0.000062 (equal to Bonferroni correction for multiple comparisons across all 806 comorbidities).

@&#CONCLUSIONS@&#
