@&#MAIN-TITLE@&#
High-order curvilinear meshing using a thermo-elastic analogy

@&#HIGHLIGHTS@&#
We present a method to generate curved meshes using a thermo-elastic model.A linear elastic analogy is amended to include thermal stress terms.These terms ‘heat’ or ‘cool’ elements to allow for increased deformation.Both isotropic and anisotropic forms of the thermal stress tensor are presented.The method is demonstrated to have benefits in both two and three dimensions.

@&#KEYPHRASES@&#
High-order curvilinear mesh generation,Elastic mesh deformation,Pseudo-thermal stresses,Mesh validity,Mesh quality control,

@&#ABSTRACT@&#
With high-order methods becoming increasingly popular in both academia and industry, generating curvilinear meshes that align with the boundaries of complex geometries continues to present a significant challenge. Whereas traditional low-order methods use planar-faced elements, high-order methods introduce curvature into elements that may, if added naively, cause the element to self-intersect. Over the last few years, several curvilinear mesh generation techniques have been designed to tackle this issue, utilizing mesh deformation to move the interior nodes of the mesh in order to accommodate curvature at the boundary. Many of these are based on elastic models, where the mesh is treated as a solid body and deformed according to a linear or non-linear stress tensor. However, such methods typically have no explicit control over the validity of the elements in the resulting mesh. In this article, we present an extension of this elastic formulation, whereby a thermal stress term is introduced to ‘heat’ or ‘cool’ elements as they deform. We outline a proof-of-concept implementation and show that the adoption of a thermo-elastic analogy leads to an additional degree of robustness, by considering examples in both two and three dimensions.

@&#INTRODUCTION@&#
The generation of high-order finite element meshes, in which faces and edges of elements curve to align with the underlying geometry, is presently an open topic. The difficulty in generating curved meshes lies in striking a balance between obtaining a sufficiently coarse mesh, whilst introducing curvature in such a way as to prevent the self-intersection of elements. There are also additional challenges in terms of producing good quality high-order elements, so that discretized operators on the solution field are well-conditioned and CFL restrictions on the time-marching scheme, where present, are ​minimized. Many of the most promising approaches that are currently being used to tackle this problem adopt a strategy of mesh deformation in their formulation. In this approach, the mesh is treated as a solid body and a model is used to determine a displacement field, which is consequently used to move the position of nodes without altering the connectivity of the elements. This technique is by no means new, having been used in the linear mesh generation community to improve the quality of elements and incorporate boundary layers into existing meshes. Some of the most popular methods include, for instance, Laplacian smoothing  [1,2], Winslow smoothing  [3,4], elastic mesh deformation  [5,6,4] and mesh optimization  [7]. More recently however, these techniques have been extended to be used in the generation of high-order meshes. The approaches to date have fallen into two general categories. The first is mesh optimization, in which regularization  [8,9] and logarithmic barriers  [10,11] have been used to define a functional which is then minimized over the domain. The second approach utilizes linear  [6,12] or non-linear  [13] elasticity analogies, where the mesh is deformed according to a stress–strain relationship. The difference in these techniques, and the resulting meshes that are generated, lies in the strategy they adopt. In the minimization of a functional, which hopefully incorporates a measure of quality of the element, the goal of the optimization procedure should not only untangle an initially invalid mesh, but add an additional degree of robustness and produce high-quality elements. Elasticity models, on the other hand, start from an initially-valid straight sided mesh, but only have ‘passive’ control over the quality and validity of elements. We note that the non-linear dependence on the determinant of the deformation mapping ensures that the creation of invalid elements is penalized. However no explicit measure of quality is generally adopted in these models.In this work, we introduce a new technique to improve the robustness and quality of elements that are obtained using elastic analogies. We extend the linear elastic equations with a term that can be interpreted as a thermal stress. The aim of this term is to counteract the distortion of elements that arises from introducing curvature at the boundary of the domain. The derivation of this term relies on a measure of the mesh quality, which will therefore allow us to control the validity and quality of elements as the mesh is deformed. We note that a precursor to this idea was presented in the work by Palmerio  [1] for linear elements where a pseudo-pressure term was used to ensure the area of the elements in the mesh remained positive through the smoothing process. The penalty term proposed in  [1] can be seen as a particular case of the linear isotropic thermal stresses in the current formulation. Our formulation is however more general; it provides a physical interpretation of the additional terms that control mesh validity and quality, and it can be generalized to account for mesh anisotropy.We note that this work is an extension of the initial implementation introduced in  [14]. The goal of this work is to give a detailed derivation of the thermal stress terms, which differs from  [14] in the choice of the isoparametric mapping that is used to determine the thermal stress. We additionally outline an extension to three dimensions, considering a simple extruded annulus and a more complex mesh of a sphere contained within a cube to demonstrate the viability of the method for more complex configurations.We begin by describing the governing equations of elasticity, which incorporate body forces and thermal stresses in Section  2. Section  3 presents the derivation of the proposed form of the thermal stresses. An outline of the numerical discretization of the equations of elasticity using spectral/hpelements is given in Section  4. Section  5 proposes some forms of the tensor of thermal stresses and illustrates with practical examples that the modifications to the elasticity equations proposed here permit a higher degree of deformation whilst maintaining the validity of the underlying high-order elements.We seek to deform a mesh of straight-sided high-order elements to accommodate curved boundaries. To achieve this, we adopt a linear elasticity formulation in terms of the displacement,u, of points in the domain,Ω⊂Rn, caused by imposing a prescribed displacement,uˆ, at the points in the boundary of the domain,∂Ω. This is illustrated in Fig. 1.The elastic formulation, see for instance  [15], starts with the equilibrium of forces represented by the equation(1)∇⋅S+f=0inΩwhereSis the stress tensor andfdenotes a distributed force. The force will be, in general, a function of the position, i.e.f(x)withx∈Rn.We further assume that the stress tensorSincorporates both elastic and thermal stresses, so that it can be written asS=Se+St,where the subscriptseandtdenote the elastic and thermal terms respectively.We adopt the usual linear form of the elastic stress tensor asSe=λTr(E)I+μE,whereλandμare the Lamé constants,Erepresents the strain tensor, andIis the identity tensor. For small deformations, the strain tensorEis given as(2)E=12(∇u+∇ut).The boundary conditions required to close the problem consist of prescribed displacements at the boundary∂Ω, i.e.(3)u=uˆin∂Ω.We further express the Lamé constants in terms of the Young’s modulusEand Poisson ratioνasλ=νE(1+ν)(1−2ν),μ=E2(1+ν).Note that the elastic parameters of the problemλandμ, or equivalentlyEandν, might be considered to be functions ofx. This is a strategy used for instance in reference  [5] where smaller elements are made stiffer to permit larger deformations.The main idea of the paper is to use the thermal stresses terms to control the validity of the mesh and its quality. If the displacement of the boundary nodes is causing an element to distort, we could increase or decrease the temperature to locally expand or contract, respectively, the element so as to prevent the element becoming invalid. We will discuss some potential forms of the thermal stresses for the purpose of controlling mesh validity and quality in Section  3. However, in this work we will assume that they do not depend onu.In this section, we will outline two possible choices for the thermal stress terms: a simple isotropic case in which each spatial direction receives an equal stress contribution, and a more complex anisotropic term based on the elemental metric tensor.The simplest model of thermal stresses is that of a linear isotropic material and the corresponding thermal stress tensor is of the formSt=β(T−T0)IwhereTis the temperature,T0is the temperature of the stress-free state, andβis a thermal coefficient. We will consider the temperature to be a function of the position, i.e.T=T(x).The main drawback of this term is when considering elements that are highly stretched, such as those found in boundary layer meshes. In these cases, the thermal stress being equal in each spatial direction may result in suboptimal results. To counteract this, in the following sections we define an anisotropic stress form which is designed to take into account stretched elements.Let us start by introducing the notation to be used in this section to describe the mappings involved in the definition of the thermal stresses. For the purposes of interpolation, a high-order element, denoted byΩe, is represented as the image of a standard element,Ωse, by a mappingM. Here we will also introduce an additional auxiliary mapping,A:Ωse→Ωre, whereΩrdenotes a reference element.M⋆=A−1∘M:Ωre→Ωewill be later used as a key ingredient to measure the element quality. The notation is illustrated in Fig. 2for a high-order triangular element.We note that this formulation differs to the anisotropic term presented in  [14], in which the mapping termMfrom the standard element toΩewas used. The use of the mappingM∗permits us a greater degree of flexibility in what we define as a ‘good quality’ high-order element. As an example, it may very well be the case that boundary layers of thin, highly stretched elements, are to be deformed. In this case, the use of quality measures that are based onMwill always see these elements as ‘bad quality’. On the other hand, the straight sided element will naturally be thin and elongated. SinceM∗measures the distortion of the element under the imposed curvature, measures of quality based on this mapping will still consider these elements ‘good quality’ and allow us to minimize the distortion which occurs from the curvature of the element.We will discuss some of the properties in the following with a view to devising an expression of the thermal stresses suitable to control the validity of the mesh by counteracting the deformation caused by the deformation induced by the displacement of the boundary.Following the notation of Fig. 3, the small displacement,δx, in the reference space is transformed by the mappingM⋆into the (also small) displacement,δy, in the physical space. Using a truncated Taylor series expansion, we writey(x)+δy=y(x+δx)≈y(x)+Jδx→δy≈JδxwhereJis referred to as the Jacobian matrix of the mapping or as the deformation gradient tensor in solid mechanics  [15], and is given byJ=∂y∂x≡Jij=∂yi∂xj;i,j=1,…,nwherenis the number of dimensions of the domain.The determinant of the Jacobian matrix,J=detJ, hereafter referred to as the Jacobian, relates (small) areas (n=2) and volumes (n=3) in the reference and physical elements, or any other pair of elements. A valueJ≤0indicates that the element is inverted with negative or zero area and thus it is invalid for computation.The transformation of the length of small displacements is given by‖δy‖2=δytδy=δxtJtJδx→‖δy‖2=‖δx‖2utGuwhereuis a unit vector parallel toδxandG=JtJis the metric tensor or, in solid mechanics, the right Cauchy–Green deformation tensor. It provides measures of distortion of the physical element, with respect to the reference element, that can be used to determine the validity of the element and used to assess its quality. The metric tensor also contains directional information that will allow us to account for anisotropy in elemental distortion.We are seeking the extrema of the ratioρ=‖δy‖2/‖δx‖2subject to‖u‖=1. Using Lagrange multipliers, we minimizeρˆ=utGu+λ(1−‖u‖2)with respect touand this leads to∂ρˆ∂ui=2∑j=1nGijuj−2λuj=0;i=1,…,n≡(G−λI)u=0.The metric tensor is symmetric and positive definite if the Jacobian matrix is non-singular. IfJ>0then the metric tensor has two real and positive eigenvalues that correspond to the maximum and minimum values ofρˆ. The metric tensor can be written as(4)G=RDR−1whereRis the matrix of eigenvectors andDis a diagonal matrix that contains the eigenvalues. Following the notation of Fig. 4, a two-dimensional interpretation of the deformation generated by the mapping is that a circle of radiusLis transformed into an ellipse of semi-axesL1andL2aligned with the eigenvectors of the tensorG.In general, the strains in the principal directions associated with the mapping deformation areei=Li−LL=λi−1;i=1,…,nwhereλiare the eigenvalues ofG. We want the thermal stresses to counteract these strain so we propose a tensor of pseudo-thermal stresses of the form(5)St=−αERDtR−1;Dti=eiwhereαis a user-defined constant that controls the amount of thermal stresses being added.Now that we have defined some potential forms of the thermal stresses, in the following section we discuss specific details of our implementation for the system defined by Eq. (1).

@&#CONCLUSIONS@&#
