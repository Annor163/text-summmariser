@&#MAIN-TITLE@&#
Modeling and estimation of single-trial event-related potentials using partially observed diffusion processes

@&#HIGHLIGHTS@&#
Continuous-time partially observed diffusion modeling of single-trial ERPs.Improved modeling of hidden continuous dynamics and irregularly spaced ERPs.Ornstein–Uhlenbeck and Cox, Ingersoll & Ross process (to capture abrupt changes).Incorporate single-trial trend component and stochastic volatility noise process.Better single-trial estimates of auditory brainstem responses & wave V detection.

@&#KEYPHRASES@&#
Diffusion models,Non-linear state-space models,Particle filters,Event-related potentials,

@&#ABSTRACT@&#
This paper proposes a new modeling framework for estimating single-trial event-related potentials (ERPs). Existing studies based on state-space approach use discrete-time random-walk models. We propose to use continuous-time partially observed diffusion process which is more natural and appropriate to describe the continuous dynamics underlying ERPs, discretely observed in noise as single-trials. Moreover, the flexibility of the continuous-time model being specified and analyzed independently of observation intervals, enables a more efficient handling of irregularly or variably sampled ERPs than its discrete-time counterpart which is fixed to a particular interval. We consider the Ornstein–Uhlenbeck (OU) process for the inter-trial parameter dynamics and further propose a nonlinear process of Cox, Ingersoll & Ross (CIR) with a heavy-tailed density to better capture the abrupt changes. We also incorporate a single-trial trend component using the mean-reversion variant, and a stochastic volatility noise process. The proposed method is applied to analysis of auditory brainstem responses (ABRs). Simulation shows that both diffusions give satisfactory tracking performance, particularly of the abrupt ERP parameter variations by the CIR process. Evaluation on real ABR data across different subjects, stimulus intensities and hearing conditions demonstrates the superiority of our method in extracting the latent single-trial dynamics with significantly improved SNR, and in detecting the wave V which is critical for diagnosis of hearing loss. Estimation results on data with variable sampling frequencies and missing single-trials show that the continuous-time diffusion model can capture more accurately the inter-trial dynamics between varying observation intervals, compared to the discrete-time model.

@&#INTRODUCTION@&#
Event-related potentials (ERPs) are bioelectrical responses of the brain to specific stimulus, which provide useful information about neurological processing. The problem is to extract the ERPs hidden behind various noise sources e.g. background electroencephalogram (EEG) and non-neural artifacts, typically in poor signal-to-noise ratio (SNR) condition. Conventional ensemble averaging of time-locked single-trials obtained by repeated stimulations can cancel out random background noise, but implies loss of information related to trial-to-trial variability due to different degree of fatigue, habituation, or attention levels of subjects [1]. Auditory brainstem response (or evoked potentials) (ABRs or ABEPs), a particular type of ERPs is the early portion of the auditory evoked potentials. The major waves of ABR are important for hearing and neurological assessment and exhibit variability across trials. Estimation of inter-trial variability and common trend of major waves for these small-amplitude potentials obscured by various noise and artifacts, poses a challenge to this study.Various approaches were proposed to solve single-trial based estimation of ERPs which is also the focus of this study. State-space approach was recently proposed for single-trial dynamical ERP estimation in [1–4] and our work [5]. Within the state-space framework, the underlying dynamics of clean ERPs are modeled as a discrete-time first-order Markov process i.e. a simple Gaussian random-walk process in the state equation, which is observed in additive Gaussian noise as single-trial measurements in the observation equation. The latent ERP process is then estimated recursively using Kalman filter (KF) [1], which is optimal in the mean-square sense. Extension using Kalman smoother [2] further improves the performance in tracking of ERP changes. Similar study [3] proposed a particle filter (PF) for the estimation and uses wavelet coefficients, instead of measurement samples, as ERP parameters [1] to reduce the state dimension and hence the computational effort. This study was extended in [4], which models the ERP subcomponent waveforms using shifted Gaussian functions, which can directly characterize important ERP morphological features such as the peak amplitudes and latencies. The Gaussians are also less inclined to capture the abruptly changing random noises, except the usually smooth ERP waves. The parameter estimation is done by Rao–Blackwellised PF (RBPF). However, the above-mentioned studies [1–5] assume discrete-time modeling which is inappropriate to describe the single-trial ERPs, the underlying physiological processes which are typically of continuous nature. Besides, the discrete-time models are unable to handle the irregularly sampled data problem which is common in practice, where the ERP measurements are unequally spaced with some single-trials occasionally missing, probably due to sensor failures. Moreover, these studies use a Gaussian noise model with constant variance, which fails to describe adequately the actual observational noise process whose volatility typically changes over time.We develop a new framework for modeling the inter-trial dynamics of ERPs based on continuous-time partially-observed (PO) diffusion process, with applications to estimation of single-trials corrupted by noise. Our approach is rooted in the state-space framework of the aforementioned studies, but offers several enhancements over the existing models, by relaxing the inadequate discrete-time and constant noise-volatility modeling assumptions and incorporating additional, important features of ERPs which have not so far been accounted for, such as the trend of the single-trials. In particular, we decompose the single-trial observations into three components: (1) latent clean ERP component, (2) observational noise component and (3) trend component, each described by a separate stochastic process. For the first component, we propose to use continuous-time processes to model the underlying dynamics of the latent clean ERPs. The continuous-time models have been applied extensively in physics, biology, econometrics [6,7] and engineering [8], due to their advantages over their discrete-time counterparts. This also forms our motivation of applying it for modeling single-trial ERPs, with the following reasons. First, it seems more natural and appropriate to use continuous-time modeling to describe real-world dynamical phenomena [7], such as the continuous physiological process underlying the single-trial EPRs considered here. Despite that the observations are always available only at discrete-time points; it is more adequate to assume that they are generated from continuous processes. Secondly, the continuous-time models can deal with variably or irregularly sampled data problem efficiently [8,9], due to their flexibility in defining implicitly and consistently over observation intervals of any length, with their adjustable parameter space estimated independently of the data sampling interval. However, the discrete-time models are specified in relation to a particular sampling interval, and therefore are fixed once estimated and only valid for this chosen sampling rate. Thus, the variable sampled data needs to be incorporated explicitly through model re-estimation. We illustrate these advantages of the continuous-time approach over its discrete-time counterpart, on two real situations in ERP estimation: (1) Estimation with variably sampled (down-sampled) single-trials, which can save computational effort without affecting the overall estimated dynamic pattern of ERPs; and (2) Estimation with irregularly spaced single-trials with missing observations where some trials contains very low (sometimes zeros) signals, which are currently solved only by direct elimination [10].We consider the commonly used continuous-time model i.e. the diffusion process driven by Brownian noise. Diffusion processes governed by the stochastic differential equations (SDEs) can accommodate random disturbances in the deterministic behavior, and are widely used for modeling physical and biological dynamical systems disturbed by noise [11]. Besides, the diffusion process is a continuous-time Markovian process to be contrasted with the discrete-time random-walk process used previously in [1–5]. Various variants of diffusion models with rich modeling properties have been proposed. To accommodate the discrete-time observation scheme of single-trial ERPs, we use a particular family of PO diffusion processes where the continuous-time diffusions are discretely observed [11], possibly further with noise [12]. Such formulation is suitable to describe the continuous dynamics underlying ERPs which are observed only as discrete-time noisy single-trials. Specifically, the hidden continuous dynamic changes in the ERP Gaussian mixture parameters are assumed to follow a multivariate diffusion process, which is only partially observed at discrete times with additive background noise as single-trial data in the observation model. To the authors' knowledge, there are no studies applying this kind of models for analyzing ERPs and its use for bio-signals in general is still very limited.A simple special case of diffusion process is first considered, i.e. the Ornstein–Uhlenbeck (OU) process. The use of OU model in its linear Gaussian form, assumes marginal inter-trial ERP changes that can be captured by its normal transition density. However, this assumption is inconsistent with the presence of both smooth and abrupt changes in the actual ERP dynamics, which implies a non-Gaussian behavior. The OU model is unable to capture both of these changes simultaneously, where a small variance of the normal transition density fails to detect rapidly the abrupt changes, while large variance tends to produce noisy estimates. This Gaussian modeling problem has been addressed in [13] and our earlier work [14] for other types of models in discrete-time. Another limitation of the OU model is that it allows for a negative process which is unsuitable for the non-negative latency and width parameters of the Gaussian ERP components. To accommodate these non-Gaussian dynamics of ERPs, we further propose an enhancement over the linear Gaussian OU process by considering a non-linear diffusion process of Cox, Ingersoll & Ross (CIR) [15]. The non-Gaussian heavy-tailed transition density of CIR process, a noncentral chi-squared density can capture both abrupt and smooth ERP parameter changes, hence providing more accurate single-trial estimates than the OU model. We use the Gaussian OU process which can take negative values to model the amplitude parameters, and the non-negative CIR process for the latency and width parameters. Moreover, both diffusions are stationary and thus produce more stable ERP estimates than the non-stationary random-walk models of [1–4].To incorporate the single-trial trend component, we proceed to use the mean-reverting variant for both diffusion processes, which approaches a stationary asymptotic distribution in long run. The advantage is that the asymptotic mean of the stationary distribution can represent the underlying trend of the trial-varying ERPs, revealing more clearly the overall morphology of the ERP waveform. To capture more accurately the changing-volatility in the noise component in order to achieve better noise-reduction, we allow the observational noise variance to be varying over trials instead of a constant one. We consider the stochastic volatility (SV) modeling [16] where the trial-varying variance is modeled directly as a latent stochastic process, which is flexible and easy to generalize to multivariate case. The idea of incorporating SV noise models for denoising of single-trial ERPs has been explored in our recent work [17]. Preliminary evaluation on normal ERPs of a single-subject showed more accurate estimates of inter-trial dynamics compared to the constant noise variance. The evolution of both the trend and noise components is assumed to follow a simple random-walk process.The proposed PO diffusion model of ERPs is then reformulated and estimated under the state-space framework. Estimation of the non-linear processes of latency and width parameters admits no closed-form solution and has to resort to simulation-based PF methods. Considering that the linear Gaussian process of amplitudes can be estimated analytically by KF, the partially-nonlinear ERP model is re-formulated in conditionally-linear Gaussian state-space form to enable estimation using the more efficient RBPF. Although our RBPF framework is based on [4], its implementation to the diffusion process is not as straightforward as to the discrete-time models, which requires explicit solution to the continuous-time SDEs and closed-form transition densities for the processes. Both OU and CIR diffusions considered here have transition densities in closed-form obtained via Ito integration, for which RBPF can be applied directly. We consider time-varying parameter estimation by augmenting the model parameters to state vector followed by simultaneous estimation by the generic PF [17].We apply the proposed methods to single-trial ABR estimation, for extracting inter-trial dynamics from noise and detecting the wave V component of ABR, critical for hearing problem assessment. We demonstrate the advantages of our model over the conventional discrete-time random-walk model based on evaluation using simulated and real data, particularly in handling irregularly spaced data in ABR estimation. We also investigate the effect of the model parameter choices on the estimation performance which was not addressed much in the previous works [1–4].Thus, in common with the previous studies [1–4], we attempt the state-space method for dynamical estimation of single-trial ERPs. In contrast to the discrete-time Gaussian random-walk modeling, we develop an enhanced framework for modeling and estimating single-trial ERPs based on continuous-time PO diffusion process. The main contributions of this paper are summarized as follows•We introduce continuous-time diffusion processes for improved modeling of the underlying continuous dynamics of single-trial ERPs and handling of irregularly spaced data, compared to the existing discrete-time approach.We consider OU and CIR process which are stationary and produce more stable ERP estimates than the random-walks. The heavy-tailed density of CIR can also capture the abrupt changes better than the Gaussian models.We incorporate a single-trial trend model for better representation of major ERP morphology and a stochastic volatility noise model to enhance noise reduction.We apply the methods to estimation of single-trial ABRs and detection of wave V for hearing-loss diagnosis, with evaluation across different subjects, stimulus intensities and pathological case, instead of normal cases only as in the previous studies [1–5].The d-dimensional vector of single-trial ERP parametersotis assumed to follow a multivariate continuous-time diffusion process solution to an SDE of the form(1)dot=b(ot,θ)dt+σ(ot,θ)dWtwhere functionsb(ot,θ)andσ(ot,θ)are drift and diffusion coefficients respectively, which depend on unknown parameter vectorθ.Wtis a d-dimensional standard Brownian motion. Letyn=[yn(1),yn(2),…,yn(k)]Tbe measurement samples of length k of a single-trial ERP at trial n, and observationsy1,y2,…,ynoccur at discrete time points0≤t1<t2<…<tn. The continuous process (1) is only discretely observed at timetn, denoted asotn=Δon, with further noise sourcevnand through mappingh(.)as noisy single-trialsyn:(2)yn=h(on,vn,θ).Refer to [12] for various observation schemes for PO diffusions.We use a special case of observation model (2), an additive noise model as in [1–4] with the following decomposition(3)yn=h(on)+vn,vn∼N(0,R)wherevnisk×1Gaussian white noise with mean zero and diagonal covariance matrixR=σv2IkwhereIkdenotes ak×kidentity matrix. The noise componentvncan represent the background EEG and artifacts.The vector functionh:Rk×Rd→Rkmaps the ERP parametersonto the observationsyn. The termy¯n=Δh(on)is the clean or denoised single-trial of ERP. Since ERP waveform consists of subcomponents with approximately Gaussian shape,y¯ncan be modeled as a mixture of M Gaussians using a non-linear mapping function for h with each element given as [4](4)hk(on)=hk(an,bn,cn)=∑m=1Man(m)e−(k−bn(m))2/(2cn2(m))wherean(m),bn(m),cn(m)are respectively the amplitude, latency and width parameters of the m-th Gaussian component for trial n. Thus, a clean single-trial ERPy¯ncan be represented by the set of Gaussian mixture model parameters, in a compact formon=Δ(an,bn,cn)wherean=[an(1),…,an(M)]T,bn=[bn(1),…,bn(M)]T, andcn=[cn(1),…,cn(M)]T. Note that these subcomponent parameters are allowed to be trial-varying to model the inter-trial variations of ERPs.A simple model for the trial-varying ERP parameters is the discrete-time random walk [4](5)[anbncn]=[an−1bn−1cn−1]+[ηanηbnηcn],[ηanηbnηcn]∼N([000],[σa2IM000σb2IM000σc2IM])Instead of discrete-time models, it is more natural and advantageous to assume that they are generated by underlying continuous transients which can be described by continuous-time models such as (1). We consider two diffusions: a Gaussian OU process for amplitude parameters and a non-linear CIR process for the latencies and widths.The amplitude parametersanare assumed as discretely observed samples of an M-dimensional mean-reverting OU processatsolution to the SDE(6)dat=β(μa−at)dt+σadWtwhereβ>0is speed of reversion,μais long run equilibrium level of processat,σa2is the process variance. The process tends to drift in direction towards equilibrium levelμawith speed determined by β. Refer to [19,20] for details of OU process. By Ito formula, the explicit solution ofatcan be obtained as(7)at=a0e−βt+μa(1−e−βt)+αtεtwhere the initiala0is normally distributed andεtis assumed as a Gaussian white noise with mean zero and covariance matrixP=σa2IMwithαt=(1−e−2βt)/2β. The process has a Gaussian marginal distribution with mean and variance [19](8)E[at]=e−βtE[a0]+μa(1−e−βt)→μaast→∞Var[at]=e−2βtVar[a0]+σa22β(1−e−2βt)I→σa22βIast→∞Note thatatapproaches a normal stationary distributionat∼N(μa,σa2/2βI)ast→∞. For the dynamical estimation of ERPs, the componentμacan be used to capture the underlying static trend of the dynamics ofat, and thus provides an alignment for the ERPs which vary across trials.We denote bytnthe time point at which the n-th observationynis sampled. LetΔt=tn+1−tnbe the time interval between two consecutive observations. Then, discretization of (7) gives [21](9)an=an−1e−βΔt+μa(1−e−βΔt)+αεan,εan∼N(0,σa2IM)withα=(1−e−2βΔt)/2β. The transition density which follows directly from (9) is normal(10)an|an−1∼N(an−1e−βΔt+μa(1−e−βΔt),σa2α2IM)The dynamics of latency and width parameters can assume OU process as well with discretization(11)[bncn]=[bn−1cn−1]e−βΔt+[μbnμcn](1−e−βΔt)+α[εbnεcn],[εbnεcn]∼N([00],[σb2IM00σc2IM])which however is likely to generate negative values. To ensure their positivity, we use the CIR process which was originally proposed as a model for financial interest rate by [15]. Besides, the process has a non-Gaussian transition density ideally suited for both abrupt and gradual changes, which are unable to be captured by the Gaussian one in (10) whose variance can only be set either too small or too large. The latencybn, similarly forcnis assumed to be generated from an M-dimensional mean-reverting CIR process, which has a linear drift term as the OU but with a square-root diffusion, specified by a non-linear SDE [21](12)dbt=β(μb−bt)dt+σbbtdWtwhere β is the mean-reversion speed,μbis the long-term mean andσb2is the volatility, similar to that of the OU process. However, the non-linear termbtsuppresses the variance term to zero asbtapproaches zero, preventing the process to become negative. The process also has a Gamma marginal density. Refer to [21] for the discretized model of the process.Lets assume that elements ofbnare mutually independent. The discretized transition density for univariate casep(bn|bn−1)can be easily obtained from its transformp(sbn|sbn−1)wheresbn=2cbnwithc=2β/(σb2(1−e−βΔt)). The transformed transition densityp(sbn|sbn−1)follows a noncentral chi-squared distribution with degree of freedomν=4μbβ/σb2and non-centrality parameterλ=sbn−1e−βΔt,sbn|sbn−1∼χv′2(λ)[20]. The noncentralχ2conditional density can predict the rare abrupt parameter changes to high values by its heavier right-tails as well as the smooth changes by its relatively narrow central region.Use of continuous-time modeling offers several benefits over the discrete-time models both in theoretical and practical perspectives [6–9]. The rationale for using continuous-time models for natural data, as for the ERPs as an example, is founded on the assumption that the underlying dynamic system is continuous e.g. the physiological dynamics behind the single-trials. Analytically, differential-equation models are more easily handled than the difference models [6], owing to the stochastic calculus.The practical advantage of continuous-time method is that it is well-suited for modeling variably or irregularly spaced data [8,9], due to its flexibility in defining inter-observation time Δt of any length consistently. The solution of a differential equation such as (7) which is based on the integral of the continuous variables yields a continuous sample path that can explain the dynamics for any time-intervals. The discrete-time observations can be seen as generated by the underlying continuous process.The parameter space of the continuous-time models is more extensive and adjustable to capture the dynamics between varying observation intervals. However, the discrete-time model parameters are fixed and inflexible to account for possible changes in Δt. In fact, the discrete-time models are approximations to their continuous counterparts, where the parameters of a discrete model are discrete samples of those of the underlying continuous model [7]. For example, the OU process of (7) is a continuous-time analogue of the discrete-time AR(1) process in a recursive form. The discretized version of OU process in (9) taken at a particular regular interval of Δt forms an AR(1) process [22]. The OU process parameters, the mean-reversion coefficiente−βΔtand noise variance scaling parameter α in (9) are time-varying according to Δt, instead of being fixed as in the ordinary discrete-time AR model [23]. As Δt increases, α becomes larger to predict parameter changes for larger region of uncertainty due to a longer period of dynamics. Thus, the parameters of the continuous models can be specified and analyzed independently of the observation intervals of the samples used for estimation [6–8]. A continuous model estimated or pre-defined for data with a particular sampling interval can be used to analyze data of any intervals consistently. This is in contrast with the fact that the discrete models once fitted to a specific sampling rate, are rigidly fixed and invalid for other sampling intervals. It requires re-estimation of the models for every different sampling interval. Therefore, the continuous-time models have this built-in capability to handle variable sampled data which is also present in the ERP estimation, where measurements are spaced variably at different intervals, which the discrete-time model fails to deal with.The relatively static3M×1trend components (μa,μb,μc) are assumed to follow a stable dynamics by adding a small noise [24]. Here we consider random-walk models with i.i.d. Gaussian noise(13a)μan=μan−1+uan,uan∼N(0,σua2IM),(13b)[μbnμcn]=[μbn−1μcn−1]+[ubnucn],[ubnucn]∼N([00],[σub2IM00σuc2IM]).For the noise component in (3), we allow the variance (squared volatility) to vary over trials i.e.vn∼N(0,Rn)withRn=σvn2Ikto better model the changing-volatility characteristics of real noise process in ERPs. However, we still assume the variance as locally stationary within a short-segment of single-trial (i.e. identical entries in the diagonal ofRn). We propose to use SV modeling forvnwhere the trial-varyingσvn2is modeled directly by a separate latent stochastic process, which we assume here as a Gaussian random-walk model(14)ϕvn=ϕvn−1+ξn,ξn∼N(0,σϕv2)whereϕvn=Δlog⁡σvn2to ensure positivity ofσvn2.The models are formulated in a discrete-time conditionally-linear Gaussian state-space form with observation and state equation respectively as(15)yn=An(θn)xn+vn,vn∼N(0,Rn(θn))(16)xn=B(θn)xn−1+C(θn)wn,wn∼N(0,Q(θn))(17)θn∼p(θn|θn−1)whereθnis a vector of unknown model parameters. It is assumed for the initial statex0∼N(xˆ0|0(θ0),P0|0(θ0)). Similar to [4], by defining a concatenated state vectorxn=[anT,μanT]Twithμan=[μan(1),…,μan(M)]T, the observation model defined by (3) can be written in a compact linear Gaussian form of (15) whereAnis ak×2Msystem matrix denoted in terms of latency and width parametersAn=[g1(bn(1),cn(1))…g1(bn(M),cn(M))01×Mg2(bn(1),cn(1))…g2(bn(M),cn(M))01×M⋮⋮⋮gk(bn(1),cn(1))…gk(bn(M),cn(M))01×M]with nonlinear termsgk(bn(m),cn(m))=e−(k−bn(m))2/(2cn2(m)). The discretized linear Gaussian OU model ofan(9) and the model for its trend (13a) can be formulated in state equation (16) with2M×2Msystem matricesB=[e−βΔtIM(1−e−βΔt)I0IM],C=[αIM00IM]and2M×1state noisewn=[εnuan]∼N([00],[σa2IM00σua2IM]).Note that to formulate the linear Gaussian observation equation (15) from the non-linear form of (4),anand (bn,cn) are treated separately as state and model parameters. The trial-varying parameters of latencybnand widthcninAn, their trends, and observation noise varianceσvn2, denoted here byθn=[bnT,cnT,μbnT,μcnT,σvn2]T, are assumed unknown and need to be estimated. The model parameters (β,σa2,σua2) are assumed fixed and pre-specified.For the estimation of the time-varying model parameters, we consider a Bayesian approach whereθnare augmented to the state vectorxnaszn=[θnT,xnT]Twith the joint posterior densityp(z1:n|y1:n)estimated using standard PF methods, as in [18,4]. To formulate a state-space model for the augmented statezn, the models for the time-evolution ofθn(17) are pre-specified, as already in (11)–(12) and (13b)–(14). The hyper-parameters of these processes (σb2,σc2,σub2,σuc2σϕv2)are assumed fixed and known. The initial stateθ0is assumed to be distributed according to a densityp0(θ)which can be tailored by available prior information. Conditional on the non-linear CIR processes ofθn, (15)–(16) is a linear Gaussian state-space model.The process ofθn(17) together with the original state-space model (15)–(16) constitutes the complete augmented state-space model forznwith all parameters summarized in Table 1. Thus, the proposed model is now fully specified. The objective is to estimate sequentially the parameters of the Gaussian ERP components for each trial n, and hence to uncover the de-noised ERPy¯n.Let denotey1:n={y1,…,yn}. The inference problem here involves estimating sequentially in time the posterior densityp(z1:n|y1:n)=Δp(x1:n,θ1:n|y1:n)where{x1:n,θ1:n}withx1:n={x1,…,xn}andθ1:n={θ1,…,θn}contains the underlying clean ERPs and model parameters. We focus on estimation of its marginal, filtered densityp(zn|y1:n)=Δp(xn,θn|y1:n). Generic PF methods can be applied directly to estimate the joint densityp(xn,θn|y1:n)[18,24]. However, sampling from a high-dimensional density is inefficient due to large number of samples required for accurate approximation, which increases computational complexity. The aforementioned conditionally-linear Gaussian model structure can be utilized to facilitate the implementation of RBPF [25,26], a more efficient variant of PF. The algorithm is based on Rao–Blackwellization method where some of the state-space variables in linear Gaussian form, which is thexnhere, can be marginalized out analytically to reduce the state-space dimension and hence the variance of the sampling estimates. This method has been used for online estimation of clean speech signals [27] and ERP subcomponents [4]. We follow the approach of these studies for the filtering of our model.We describe here how to use the RBPF to estimatep(xn,θn|y1:n)in our model; refer to [25–27] and [4] for further details. We observe that(18)p(xn|y1:n)=∫p(xn|θn,y1:n)p(θn|y1:n)dθnwherep(xn|θn,y1:n)∼N(xˆn|n(θn),Pn|n(θn))in which{xˆn|n(θn),Pn|n(θn)}can be computed analytically by the KF. Then, estimatingp(xn,θn|y1:n)only needs to sample from a lower dimensionalp(θn|y1:n). If we obtain by PF, an approximation ofp(θn|y1:n)(19)pˆ(θn|y1:n)=∑i=1NWn(i)δθn(i)(θn),Wn(i)=w˜n(i)/∑j=1Nw˜n(j)whereWt(i)andw˜t(i)are the normalized and un-normalized weights associated with samplesθn(i). Then,p(xn|y1:n)can be approximated as a mixture of Gaussian distributions(20)pˆ(xn|y1:n)=∑i=1NWn(i)N(xn;xˆn|n(θn(i)),Pn|n(θn(i)))To obtain estimates (19) sequentially, we use sequential importance sampling (SIS) algorithm [25,28], whereθn(i)are sampled recursively from some importance functionπ(θn|θn−1,y1:n)givenθn−1(i), with associated weights updated recursively to [27](21)w˜n(i)=w˜n−1(i)p(yn|θn(i),y1:n−1)p(θn(i)|θn−1(i))π(θn(i)|θn−1(i),yn).Prior importance functionπ(θn|θn−1,y1:n)=p(θn|θn−1)is used here with weightsw˜n(i)=w˜n−1(i)p(yn|θn(i),y1:n−1). To overcome weight degeneracy problem, re-sampling step [28] is applied when the effective sample size is less than a specified thresholdESS=(∑i=1N(Wt(i))2)−1<NT.Sampling from conditional densityp(θn|θn−1)of our model is performed hierarchically according toϕvn|ϕvn−1∼N(ϕvn−1,σϕv2),(μbn,μcn)|(μbn−1,μcn−1)∼N([μbn−1μcn−1],[σub2IM00σuc2IM])and(bn,cn)|(bn−1,cn−1)∼N([bn−1cn−1]e−βΔt+[μbnμcn](1−e−βΔt),α2[σb2IM00σc2IM]),for the OU model or for the CIR model through its transform(22)sbn|sbn−1∼χ4μbβ/σb′22(sbn−1e−βΔt),scn|scn−1∼χ4μcβ/σc′22(scn−1e−βΔt)for each dimension based on independence assumption. Let(23)p(xn|θn,y1:n)=N(xn;xˆn|n(θn),Pn|n(θn)),p(xn|θn,y1:n−1)=N(xn;xˆn|n−1(θn),Pn|n−1(θn))andp(yn|θn,y1:n−1)=N(yn;yn|n−1(θn),Sn|n−1(θn))denote respectively filtering, one-step ahead prediction, and predictive densities conditional onθn, which are estimated by KF. For notational convenience, we writexˆn|n(θn)=xˆn|n,Pn|n(θn)=Pn|nand similarly for other terms. The RBPF used in this paper to estimatep(xn,θn|y1:n)is summarized in Algorithm 1. The algorithm requires N recursions of KF at each iteration. Instead of computing N ‘full’ KF recursions, we calculate only oncePn|n(θn(i))=Pn|nandPn|n−1(θn(i))=Pn|n−1fori=1,…,N, as observed in [29].The mean of the filtered joint densityE[xn,θn|y1:n]is the optimal estimator of (xn,θn). Given respective approximations in (19) and (20), the means of the marginal densitiesp(θn|y1:n)andp(xn|y1:n)can be approximated(24)E[θn|y1:n]≈∑i=1NWn(i)θn(i)and(25)E[xn|y1:n]≈∑i=1NWn(i)E[xn|θn(i),y1:n]=∑i=1NWn(i)xˆn|n(θn(i)).The marginal likelihood ofy1:Jis given as [24](26)ℓ(y1:J|λ)=∏n=1Jp(yn|y1:n−1)where, given approximation of the one-step ahead predictionpˆ(θn|y1:n−1)=∑i=1NWn−1(i)δθn(i)(θn)[25], the predictive likelihood can be estimated by(27)pˆ(yn|y1:n−1)=∫p(yn|θn,y1:n−1)p(θn|y1:n−1)dθn=∑i=1NWn−1(i)p(yn|θn(i),y1:n−1)=∑i=1Nw˜n(i)

@&#CONCLUSIONS@&#
