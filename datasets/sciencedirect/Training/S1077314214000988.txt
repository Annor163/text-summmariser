@&#MAIN-TITLE@&#
SHOT: Unique signatures of histograms for surface and texture description

@&#HIGHLIGHTS@&#
This paper presents a local 3D descriptor for surface matching dubbed SHOT.Our proposal includes a repeatable local reference frame as well as a 3D descriptor.It enables seamless description of shape and color data from RGB-D sensors.It is validated in object recognition, 3D reconstruction and shape retrieval scenarios.SHOT offers superior effectiveness with remarkably good computational efficiency.

@&#KEYPHRASES@&#
Surface matching,3D descriptors,Object recognition,3D reconstruction,

@&#ABSTRACT@&#
This paper presents a local 3D descriptor for surface matching dubbed SHOT. Our proposal stems from a taxonomy of existing methods which highlights two major approaches, referred to as Signatures and Histograms, inherently emphasizing descriptiveness and robustness respectively. We formulate a comprehensive proposal which encompasses a repeatable local reference frame as well as a 3D descriptor, the latter featuring an hybrid structure between Signatures and Histograms so as to aim at a more favorable balance between descriptive power and robustness. A quite peculiar trait of our method concerns seamless integration of multiple cues within the descriptor to improve distinctiveness, which is particularly relevant nowadays due to the increasing availability of affordable RGB-D sensors which can gather both depth and color information. A thorough experimental evaluation based on datasets acquired with different types of sensors, including a novel RGB-D dataset, vouches that SHOT outperforms state-of-the-art local descriptors in experiments addressing descriptor matching for object recognition, 3D reconstruction and shape retrieval.

@&#INTRODUCTION@&#
Automatic recognition of shapes in 3D data, also referred to as surface matching, attracts growing interest in the research community, with application to areas such as shape retrieval, 3D reconstruction, object recognition/categorization, manipulation and grasping, robot localization and navigation. A key enabling factor for the development of this technology is represented by the availability of low-cost 3D sensors. Moreover, the majority of such sensors can acquire not only the 3D shape of the scene, but also its texture (the so-called RGB-D data): this is the case, e.g., of stereo sensors, structure-from-motion systems, certain laser scanners as well as the recently introduced Microsoft Kinect and Asus Xtion devices.Surface matching is usually tackled either by means of a global or a local approach. According to the former, a feature describes the whole surface, whereas the latter relies on local keypoints and regional feature descriptions to determine point-to-point correspondences between surfaces. Borrowing a denomination typical of the face recognition community [1], we refer here to these two approaches as, respectively, holistic and feature-based. While the holistic approach is popular in the context of 3D shape retrieval (see for example [2–4]), feature-based methods are inherently more effective for 3D object recognition due to the ability to withstand clutter and occlusions.Feature-based methods may rely on 3D keypoints extracted from surfaces. This task is accomplished by 3D detectors [5–7], whose aim is to single out points that are distinctive, to allow for effective description and matching, as well as repeatable with respect to vantage point variations and noise. A characteristic scale may also be associated to each keypoint, so as to provide the following description stage with a local neighborhood size [5,8–11]. A performance evaluation of 3D keypoint detection algorithms has been recently proposed in [12]. Information within the local neighborhood of each keypoint is encoded by means of a 3D descriptor, so as to obtain a compact local representation of the input data invariant up to a predefined transformation (rotation, translation, scaling, point density variations, etc.). The majority of descriptors relies on a repeatable local Reference Frame (RF), whose importance for the overall descriptor performance has been demonstrated in the preliminary version of this work [13] as well as in another recent work, entirely devoted to the study of local RFs [14]. Descriptors are then matched across different views to attain point-to-point correspondences.In this paper we first propose a categorization of the main proposals for 3D description (Section 2), by dividing state-of-the-art methods between Signatures and Histograms. We then present our proposal for a robust local RF that is unique and repeatable (Section 3). Starting from the analysis of state-of-the-art descriptors provided in our taxonomy, in Section 4 we propose the Signature of Histograms of OrienTations (SHOT) descriptor as an attempt to leverage on the benefits of both Signatures and Histograms. We then present the generalization of SHOT to the case of RGB-D data, by showing how its formulation can seamlessly and efficiently incorporate the description of color channels. Finally, we provide a thorough experimental evaluation of our proposal, addressing tasks such as descriptor matching in presence of noise, clutter, occlusion and point density variations, automatic 3D reconstruction from multiple unordered views and 3D shape retrieval. Throughout the experiments, we compare SHOT to several state-of-art methods and consider datasets acquired with different sensors. As part of our evaluation methodology, we also propose a new RGB-D dataset with ground-truth comprising a large number of scene and model views acquired by a Kinect device.This paper extends and consolidates the research work previously presented in [13,15]: the two algorithms are now presented together as a unique algorithm and all the details and pseudo-code to reproduce the method are provided; we enrich and revise the taxonomy of 3D descriptor and, for the sake of clarity and generalization, drop the distinction between unique and unambiguous local RFs as well as highlight the ability of each proposal to handle RGB-D data; we extend the comparative evaluation concerning description matching experiments by including three additional prominent proposals, i.e. FPFH [16], MeshHoG [11] and KP [5]; descriptor matching experiments are carried out also by comparing all methods using the same algorithm to compute the local RF, so as to better highlight the contribution given by both the proposed local RF as well as the proposed descriptor; we propose a novel RGB-D dataset with ground-truth, acquired with the Kinect sensor, on which we compare our descriptor to other shape and color descriptors; we demonstrate full-3D reconstruction from unordered views based on Kinect data, which are noisier than those used in [13]; we also address a Shape Retrieval scenario to evaluate and compare quantitatively our proposal with respect to other descriptors in another relevant application.In Table 1we propose a categorization of the main approaches for 3D description. As shown in the second column, we divide 3D descriptors into two main categories, namely Signatures and Histograms (Fig. 1). The methods in the first category, which mostly includes earliest works on this subject, describe the 3D surface neighborhood of a given point (hereinafter support) by defining an invariant local reference frame and encoding, according to the local coordinates, one or more geometric measurements computed individually at each point of a subset of the support. Signatures are potentially highly descriptive thanks to the use of spatially well-localized information, but small errors in the definition of the local RF or small perturbations in the encoded trait can substantially modify the final descriptor. On the other hand, Histograms describe the support by encoding counters of local topological entities (e.g. vertices, mesh triangle areas) into histograms according to a specific quantized domain (e.g. point coordinates, curvatures, normal angles). If the descriptor domain is based on coordinates, then also histogram-based methods require the definition of a local RF (e.g. 3D Shape Context [17], Tensor [18]). For other domains, e.g. angles between normals as in LSP or cylindric coordinates as in Spin Images [19], only a repeatable Reference Axis (RA) is required. In broad terms, when compared to Signatures, Histograms trade-off descriptive power for robustness by compressing information into bins.As far as Signatures are concerned, one of the first proposals is Structural Indexing[20], which builds up a representation based on either a 3D curve or a Splash depending on the characteristics of the 3D support. The former encodes the angles between consecutive segments of the polygonal approximation of edges (corresponding to depth or orientation discontinuities) on the surface. The latter encodes as a 3D curve the local distribution of surface orientations along a geodesic circle centered on the point. In Point Signatures[21] the signature is given by the signed height of the 3D curve obtained by intersecting a sphere centered at the point with the surface. 3D Point Fingerprint[22] encodes normal angle variations and contour radius variations along different geodesic circles projected onto the tangent plane. The work in [8] proposes a descriptor that encodes the components of the normals within the support by deploying a 2D parametrization of the local surface based on the exponential mapping. In [5], the signature is given by the third coordinate of each vertex of the support expressed in the local RF. This scheme has been recently extended to a hybrid scheme, by computing a SIFT descriptor out of the resulting depth image [23]. Finally, Ref. [24] extends the successful SURF descriptor [25] to 3D data, by voxelizing the 3D mesh so as to efficiently compute Haar wavelets and use their responses as signature trait.As for Histograms, those relying on the definition of just a RA are typically based on the feature point normal. For example, Spin Images[19] computes 2D histograms of points falling within a cylindrical volume by means of a plane that “spins” around the normal. Within the same subclass, Local Surface Patches[6] computes histograms of normals and shape indexes[26] of the points belonging to the support. As for methods relying on the definition of a full local RF, 3D Shape Context[17] modifies the basic idea of Spin Images by accumulating 3D histograms of points within a sphere centered at the feature point. Intrinsic Shape Signatures[7] proposes an improvement of 3D Shape Context based on a different partitioning of the 3D local volume as well as on a different definition of the local RF. Point Feature Histograms (PFH) [27] and Fast Point Feature Histograms (FPFH) [16] accumulate in a 3D histogram three angular values computed between pairs of points falling within the support and their respective normals. Finally, Ref. [18] accumulates 3D histograms (Tensors) of mesh triangle areas within a cubic support.Although not explicitly grounded on our taxonomy, the recent MeshHoG (MH) 3D descriptor [11] shares the same hybrid structure as SHOT. It encodes several histograms of gradients of a scalar function defined at each vertex (e.g. the mean curvature) ordered according to a local RF. Moreover, likewise SHOT and differently from all the other methods reviewed here, MeshHog allows for inclusion of both color as well as 3D shape information within the descriptor. Another hybrid descriptor is the recent Rotational Projection Statistics (RoPS) [28], which encodes robust statistics (central moments and entropy) of the distributions of vertices of the mesh, rotated along the RF axes, and projected and quantized on the 2Dxy,yz, and zx planes.A few descriptors, though, can be interpreted neither as Signatures nor as Histograms. Among them, the most relevant proposal is the Heat Kernel Signature [29]. The descriptor is obtained by a restriction of the heat kernel to the time dimension. The heat kernel fully characterizes the underling manifold up to isometries. The descriptor is inherently multi-scale and does not make use of a local Reference Frame.The definition of a local RF, invariant to translations and rotations and robust to noise and clutter, has been the preferred option to endow a 3D descriptor with invariance to the same sources of variations, similarly to the way rotation and/or scale invariance is injected into 2D descriptors. On the other hand, the definition of such a canonical frame is challenging. As highlighted in the third column of Table 1, none of current local RF proposed together with descriptors is unique, except that of MeshHoG, RoPS, and 3D SURF. However, the local RF defined within the MeshHoG descriptor is highly sensitive to noise, as shown in [14]. As pointed out in [30], also the local RF of 3D SURF is not robust, so that its deployment in a voting scheme á la ISM [31] requires casting votes for multiple locations in order to counteract its low repeatability. Resorting to multiple local RFs, hence multiple descriptions of the given neighborhood, is suboptimal as it implies a higher cost associated with the description process in terms of both execution time and memory occupancy. Moreover, the matching stage becomes more ambiguous and slower.We have designed and extensively tested a variety of novel local RFs in order to get to a unique and robust proposal. We present here the method that turned out the most robust in our experimental evaluation. Unlike a recent study on local RFs addressing partial views registration [14], the design and evaluation of our algorithm has been tailored mainly to surface matching in presence of clutter and occlusions. It builds on a well known technique presented in [32,33], where the problem of normal estimation in presence of noise is specifically addressed. A Total Least Squares (TLS) estimation of the normal direction is obtained in Hoppe’s and Mitra’s works [32,33] by EigenValue Decomposition (EVD) of the covariance matrix,M, of thek-nearest neighborspiof the point:(1)M=1k∑i=0k(pi-pˆ)(pi-pˆ)T,pˆ=1k∑i=1kpi.In particular, the TLS estimation of the normal direction is given by the eigenvector corresponding to the smallest eigenvalue of M. Finally, they perform the sign disambiguation of the normals globally by means of sign consistency, i.e. by propagating the sign from a seed chosen heuristically. While this has proven to be a robust and effective technique for surface reconstruction of a single object, it cannot be as effective for local surface description since in the latter case signs must be repeatable across any possible object pose as well as in scenes with multiple objects, so that a local rather than global sign disambiguation method is mandatory. Moreover, Hoppe’s sign disambiguation concerns the normal only, hence it leaves ambiguous the signs of the remaining two axes.In our proposal, we modify (1) to assign distant points smaller weights, so as to increase repeatability in presence of clutter. Then, to improve robustness to noise, all points laying within the spherical support (of radius R) which are used to compute the descriptor are also used to calculateM. For the sake of efficiency, we neglect the centroid computation, replacing it with the feature pointp. Therefore, we calculate M as a weighted linear combination,(2)M=1∑i:di⩽RR-di∑i:di⩽R(R-di)(pi-p)(pi-p)Twheredi=‖pi-p‖2. Our experimental evaluation indicates that the eigenvectors ofMdefine repeatable, orthogonal directions in presence of noise and clutter. It is worth pointing out that, compared to [32,33], in our proposal the third eigenvector no longer represents the TLS estimation of the normal direction and sometimes it notably differs from it. However, this does not affect performance, as in local surface description the definition of a highly repeatable and robust triplet of orthogonal directions is more important than its geometrical or topological meaning.Eigenvectors of (2) provides repeatable directions for the local RF axes, but they need to be disambiguated to yield a unique local RF. The problem of sign disambiguation for EVD and SVD has been recently addressed in [34]. Their proposal basically reorients each singular vector or eigenvector so that its sign is coherent with the majority of the vectors it is representing. We determine the sign on the localxandzaxes according to this principle. In the following we refer to the three unit eigenvectors in decreasing eigenvalue order as thex+,y+andz+axis, respectively. Withx-,y-andz-, we denote instead the opposite unit vectors. LetM(k)be the subset of points within the support whose distance from the feature point is among the k closest to the median distancedm, i.e.(3)M(k)≐i:|m-i|⩽k,m=argmedianjdj.Then, the final disambiguatedxaxis is defined as(4)Sx+≐i:di⩽R∧(pi-p)·x+⩾0(5)Sx-≐i:di⩽R∧(pi-p)·x->0(6)S∼x+≐i:i∈M(k)∧(pi-p)·x+⩾0(7)S∼x-≐i:i∈M(k)∧(pi-p)·x->0(8)x=x+,|Sx+|>|Sx-|x-,|Sx+|<|Sx-|x+,|Sx+|=|Sx-|∧|S∼x+|>|S∼x-|x-,|Sx+|=|Sx-|∧|S∼x+|<|S∼x-|To disambiguate the EVD also at those points where|Sx+|=|Sx-|, we consider only an odd number k of vertices inM(k), yielding the subsetsS∼x+andS∼x-, and we reorient the eigenvector so that its sign is coherent with the majority of such vectors. The same procedure is used to disambiguate thezaxis. Finally, theyaxis is obtained asz×x.In Section 2, we classified 3D descriptors as either histograms or signatures. We have designed our proposal following this intuition and aiming at a local representation that is efficient, descriptive, robust to noise and clutter as well as to point density variation. The point density issue is peculiar to the 3D scenario, wherein a given real world 3D volume may be represented with different amounts of vertices in its mesh approximation, e.g. due to the use of different 3D sensors (stereo, ToF cameras, LIDARs, etc.) and/or different sensing distances.Beside our taxonomy, another source of inspiration has been the related field of 2D feature descriptors, which has reached a remarkable maturity during the last years. By analyzing SIFT [35], arguably the most successful and widespread proposal among 2D descriptors, we have singled out the major reasons behind its effectiveness. Histograms are used in several steps of the algorithm, from the definition of the local orientation to the descriptor itself, and contribute to the robustness of the method. As a single histogram computed on the whole patch would be not descriptive enough, SIFT relies on a set of local histograms that are computed on specific subsets of pixels defined by a regular grid superimposed on the patch. The use of this coarse geometric grid creates a signature-like structure. Finally, the local histograms encode first order derivatives of the signal, i.e. intensity gradients.Based on these considerations, we propose a 3D descriptor that encodes histograms of the normals within the support (i.e. first-order differential entities). The discriminative power of the descriptor is enhanced by introducing geometric information concerning the location of the points within the support, thereby mimicking a signature. This is done by computing a set of local histograms over the 3D volumes defined by a 3D grid superimposed on the support. The grid is aligned with the axes defined by the local RF introduced in the previous section. Since our descriptor lays at the intersection between Histograms and Signatures, we dub it Signature of Histograms of OrienTations (SHOT).For each of the local histograms, we accumulate a point into bins according to the cosine of the angleθqbetween the normal at the point,nq, and the localzaxis at the feature point,zk. The reason to use the cosine is twofold: it can be computed rapidly, sincecosθq=zk·nq; an equally spaced binning oncosθqis equivalent to a spatially varying binning onθq, whereby a coarser binning is created for directions close to the reference normal direction and a finer one for orthogonal directions. In this way, small differences in orthogonal directions to the normal, i.e. presumably the most informative ones, cause points to be accumulated in different bins leading to different histograms. Moreover, in presence of quasi-planar regions (i.e. not very descriptive ones) this choice limits histogram differences due to noise by concentrating counts into a fewer number of bins.As for the signature structure, we use an isotropic spherical grid that encompasses partitions along the radial, azimuth and elevation axes, as sketched in Fig. 2. Since each volume of the grid encodes a very descriptive entity represented by the local histogram, we can use a coarse partitioning of the spatial grid and hence a small cardinality of the descriptor. In particular, our experimentations indicate that 32 is a proper number of volumes, resulting from 8 azimuth divisions, 2 elevation divisions and 2 radial divisions (though, for better clarity, only 4 azimuth divisions are shown in Fig. 2). Combined with the fact that our tuning experiments indicate a proper number of bins for the internal histograms to be 11, we obtain a total descriptor length of 352, a value that allows for faster indexing and matching with respect to the length of 3DSC (1980) or ISS (595). We are aware of an allegedly more effective, proposal for sphere subdivision presented in [7]. However, the author ascribes the higher effectiveness of her method to the absence of degenerating points in the division, which instead are present at the poles and center of the subdivision in Fig. 2. Since our proposal requires much less bins and, as explained below, we use interpolation among bins, we found degenerating points to represent a minor issue.Since our descriptor is based upon local histograms, it is important to avoid boundary effects, as pointed out e.g. in [19,35]. Furthermore, due to the signature structure, boundary effects may also occur due to perturbations of the local RF. Therefore, for each point being accumulated into a specific local histogram bin, we perform quadrilinear interpolation with its neighbors, i.e.the neighboring bin in the local histogram and the bins having the same index in the local histograms corresponding to the neighboring subdivisions of the grid. In particular, each bin is incremented by a weight of1-dfor each dimension. As for the local histogram, d is the distance of the current entry from the central value of the bin. As for elevation and azimuth, d is the angular distance of the entry from the central value of the volume. Along the radial dimension, d is the Euclidean distance of the entry from the central value of the volume. Along each dimension, d is measured in units of the histogram or grid spacing, i.e. it is normalized by the distance between two neighbor bins or volumes. Fig. 3provides a graphic description of the quadrilinear interpolation process.To achieve robustness to point density variations, we normalize the whole descriptor to have Euclidean norm equal to 1. This is preferable to the solution proposed in [17], i.e. normalizing each bin by the inverse of the local point density and bin volume. In fact, while [17] implicitly assumes that the sampling density may vary independently in every bin, and thus discards as not informative the differences in point density among bins, we assume global (or at least regional) variations of the density and keep the local differences as a source of discriminative information.Algorithm 1The SHOT descriptorF={feature points}Sp={points in the sphere of radius R around p}RGBData=a boolean indicating RGB-D datacompute normalnifor every pointiifRGBDatathenconvertRGBitoLabifor every pointiendifforp∈Fdo//Computation of the local Reference FrameM=0forq∈Spdod=∥p-q∥2M=M+(R-d)(p-q)(p-q)TendforM=VDV-1,V=[x+y+z+]//Compute EVD//Disambiguate axesx=x+if|Sx+|⩾|Sx-|elsex-z=z+if|Sz+|⩾|Sz-|elsez-y=z×x//Computation of the signature of histogramsforq∈Spdocompute local coordinates(qx,qy,qz)ofqwrt[xyz]quantize(qx,qy,qz)wrt to the spatial gridθ←nq·zquantizeθwrt to the shape histogram binsifRGBDatathenγ←∥Labq-Labp∥1quantizeγwrt to the texture histogram binsendifquadrilinear interpolation to accumulateqendfornormalize the descriptor to Euclidean norm 1endforIn this section we show how the design of the SHOT descriptor can be generalized seamlessly to incorporate texture information. This results in a particularly interesting approach for carrying out surface matching tasks based on the output of modern 3D sensors capable of delivering both shape and color (usually referred to as RGB-D sensors).In the proposed generalization (Fig. 4), 2 signatures of histograms encoding, respectively, shape and texture information are computed in the spherical support and chained together in order to build the descriptorDkat feature point k:(9)Dk=Dshapek∪DtexturekAs for the shape descriptor, we use the previously introduced approach, i.e. in every histogram we accumulate point counts according to the cosine of the angle between normals. To obtain the texture descriptor, we have to define both the point-wise trait to be compared between feature k and every point within the support as well as a suitable metric to compare two such texture-related values.The most intuitive choice for the texture-based point-wise trait is the RGB triplet associated with each vertex. To properly compare RGB triplets, one option is to deploy again the approach taken to describe shape, i.e. computation of the dot product. Alternatively, we have tested a metric based on theLpnorm between two triplets. In particular, we have implemented the operator based on theL1norm, which consists in the sum of the absolute differences between the triplets. Moreover, we have investigated on using different color spaces rather than RGB. We have chosen the CIELab space given its well-known property of being more perceptually uniform than the RGB space [36]. Hence, as a different solution, the point-wise color is represented by color triplets computed in this space. Comparison between Lab triplets can be done using the same approaches as those adopted for RGB triplets, i.e. the dot product or theL1norm. In addition, we have also investigated on the use of more specific metrics defined for the CIELab color space. In particular, we have considered two metrics, known as CIE94 and CIE2000, that were defined by the CIE Commission in 1994 and 2000 respectively (for their definitions the reader is referred to [36]). According to a thorough experimental study described in [15], the best property-metric pair turned out to be the Lab color space together with theL1norm. Hence, in the reminder of this paper we will refer to the SHOT descriptor enriched with texture information as to this particular configuration.Given the different nature of the two signatures of histograms embedded into the extended SHOT descriptor, it is useful to allow for a different number of bins in the two histogram types. Thus, the extended descriptor includes an additional parameter, which specifies the number of bins in each texture histogram and is referred to as Color Step (SC, see Fig. 4). As discussed for shape, it is important to deal with boundary effects and spurious descriptors differences due to point density variations when encoding texture: hence, the quadrilinear interpolation and final normalization are carried out also in the SHOT descriptor for RGB-D data. The overall algorithm for computing the SHOT descriptor both for 3D and RGB-D data is reported in Algorithm 1.

@&#CONCLUSIONS@&#
