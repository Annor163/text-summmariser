@&#MAIN-TITLE@&#
Thalamic segmentation based on improved fuzzy connectedness in structural MRI

@&#HIGHLIGHTS@&#
An improved fuzzy connectedness based thalamic segmentation method was proposed.Image local gradient was incorporated in calculation of fuzzy affinity.The weight of intensity and local gradient can be automatic adjusted.Confidence connectedness was used in automatic ROI update.Only one seed point was needed.

@&#KEYPHRASES@&#
Thalamic,Segmentation,Fuzzy connectedness,Magnetic resonance imaging (MRI),

@&#ABSTRACT@&#
Thalamic segmentation serves an important function in localizing targets for deep brain stimulation (DBS). However, thalamic nuclei are still difficult to identify clearly from structural MRI. In this study, an improved algorithm based on the fuzzy connectedness framework was developed. Three-dimensional T1-weighted images in axial orientation were acquired through a 3D SPGR sequence by using a 1.5T GE magnetic resonance scanner. Twenty-five normal images were analyzed using the proposed method, which involved adaptive fuzzy connectedness combined with confidence connectedness (AFCCC). After non-brain tissue removal and contrast enhancement, the seed point was selected manually, and confidence connectedness was used to perform an ROI update automatically. Both image intensity and local gradient were taken as image features in calculating the fuzzy affinity. Moreover, the weight of the features could be automatically adjusted. Thalamus, ventrointermedius (Vim), and subthalamic nucleus were successfully segmented. The results were evaluated with rules, such as similarity degree (SD), union overlap, and false positive. SD of thalamus segmentation reached values higher than 85%. The segmentation results were also compared with those achieved by the region growing and level set methods, respectively. Higher SD of the proposed method, especially in Vim, was achieved. The time cost using AFCCC was low, although it could achieve high accuracy. The proposed method is superior to the traditional fuzzy connectedness framework and involves reduced manual intervention in time saving.

@&#INTRODUCTION@&#
Many putative targets for deep brain stimulation (DBS) exist [1,2]. With the wide application of DBS, the precise identification of thalamic nuclei is a key issue that can improve the accuracy of the electrode placement. Moreover, the accurate localization of thalamic nuclei can help investigate the morphology of these nuclei and their mechanism across a range of diseases. Thalamus facilitates the understanding of human brain connectivity, and most of the sensory information coming from the neurons and into the cortex goes through this structure [3]. Thus, thalamic segmentation is a meaningful task for both patients and healthy subjects.Currently, identifying thalamic structures from structural MR images with insufficient contrast is still difficult because thalamic structures have relatively smaller sizes and significant shape variations. The primary methods for brain structure segmentation include principal component analysis (PCA) [4–6], fuzzy logic control [7–9], level sets [10–12], and registration-based framework [3,13–16]. However, applying these methods on the thalamic nuclei leads to unsatisfactory results and requires improvement.Several techniques have recently been proposed to improve the accuracy of subcortical structure identification. The value of nonlinear registration for automated atlas-based subcortical target identification in functional neurosurgery was demonstrated using a new digital atlas of the basal ganglia and thalamus [17]. Thereafter, multiple templates were used to improve the segmentation accuracy for subcortical structures, including the hippocampus [18]. In addition, high-resolution anatomic MRI with 7T provided an advanced method for thalamic nucleus identification [19,20]. Recent work focused on the differences in diffusion characteristics from diffusion MRI [21–23]. Thalamic sub-regions were identified based on connections from the thalamic voxels to various cortical regions; this approach is called alternative “probabilistic tractography” method [24,25]. Several methods have been used to enhance thalamic nucleus visualization [26–28]. In particular, a method for identifying sub-regions within the thalamus based on the differences between T1 and T2 values was explored [29].In practice, T1-weighted MRI is among the most commonly used examinations for patients. Based on traditional MRI, studies using multiple algorithms were conducted to improve the effect of substructure segmentation, and results from such studies will be helpful to clinicians. For example, knowledge-based methods that combined neuro-anatomical information with the requirement for user interaction in deformable models showed high accuracy in many segmentation tasks, such as corpus callosum and knee bone from MR image [30,31]. Similarly, He et al. combined k-means clustering and deformable models [32]. Amini et al. proposed a mixed method incorporating fuzzy clustering theory with dynamic condition theory [33].Thalamic nuclei are small, and the boundaries of the substructures are blurred in structural MRI. However, the neighboring subcortical structures have some degree of spatial dependence. Based on our previous work, fuzzy connectedness described this relationship and measured the degree of dependence [34]. Rosenfeld first proposed the fuzzy connectedness theory in 1979 [35]. Then, Udupa et al. established the fuzzy connectedness theoretical framework [36]. Fuzzy connectedness is an emerging framework in image segmentation. The intensities of object regions are heterogeneous because the object materials are different. However, a knowledgeable observer could identify a certain object even when their intensities vary. Fuzzy connectedness is a fuzzy topological notion describing the way how image elements hang together spatially. The concept of fuzzy connectedness was first exploited by Dellepiane et al. [37] and Udupa et al. [38] to facilitate image segmentation. In the past decade, fuzzy connectedness has been successfully applied to image segmentation. For example, Harati et al. identified brain tumors using an improved fuzzy connectedness algorithm, in which the seed point is automatically selected [39]. The segmentation evaluation results indicated higher performance than conventional methods.In this study, an improved method based on fuzzy connectedness framework was proposed to realize semi-automatic segmentation of thalamic nuclei. A local gradient was incorporated to increase accuracy, and confidence connectedness involving a single seed point was used to decrease manual intervention.The remainder of this paper is organized as described in the following statements. First, the image data used in this study and the proposed methodology are presented. The experimental results, discussions, and conclusions are provided.The structural MRI data were acquired from PLA NAVY General Hospital. MRI was conducted using a 1.5T GE magnetic resonance scanner. 3D T1-weighted images in axial orientation were acquired using a 3D SPGR sequence (TR/TE=2957/9ms, flip angle=15°, FOV=24cm, slice thickness=1.25mm, spacing between slices=1.0mm, pixel spacing=1.0mm×1.0mm) with a 256×256 in-plane resolution.First, bias field correction was performed using non-parametric non-uniform gray normalization [40]. Second, brain tissue was extracted from the original image. Non-brain tissues, such as scalp and skull tissues, were removed using a brain extraction tool. These two steps were performed using Medical Image Processing, Analysis, and Visualization (MIPAV, http://mipav.cit.nih.gov/) software [41].In this study, a morphology-based method with White and Black top-hat transformation was performed to improve the image contrast [42].White top-hat transformation refers to the subtraction of the result of opening operation from the image itself. By contrast, Black top-hat transformation refers to the subtraction of the image from the result of closing operation. The two above mentioned transformations (White and Black top-hat) are illustrated in Eqs. (1) and (2), respectively. In these equations,IGrepresents the image andSErepresents the structuring element, as follows:(1)Wtop-hat(IG)=IG-(IG∘SE)(2)Btop-hat(IG)=(IG∙SE)-IGA structuring element with a size of 5×5×5 voxels was used (see Section 3 for more details in size selection). After White and Black top-hat transformations were performed, the edges between the tissues became clearer (seeFig. 1). As a result, the structures could be easily identified from the surrounding tissues.In this study, an algorithm based on improved fuzzy connectedness was proposed. First, confidence connectedness was used in an automatic ROI selection. During the fuzzy connectedness calculation, image gradient was an important feature in the calculation of the fuzzy affinity besides image intensity. Moreover, an adaptive weight control was used. The algorithm for implementing the proposed algorithm is as follows:Select seed point according to the relative criterion (see details in Section 2.3.1).Repeat the following steps until no more neighboring pixel could be accepted:Calculate the range of intensitym-lσ,m+lσwithin the current ROI.Accept and add the neighboring pixel as the element of updated ROI if its intensity falls into the above mentioned range.Within the final update ROI:Calculate the fuzzy connectedness between each pixel and the seed point,If the fuzzy connectedness is higher than the threshold,Label the corresponding pixel as the target.Otherwise,Label the corresponding pixel as the background.The details of the flowchart will be represented as the following parts. Two primary steps were included, namely, ROI selection and developed calculation of fuzzy affinity.The experimental results showed that segmentation based on traditional fuzzy connectedness should have more than one seed point to achieve a satisfactory result in thalamic nucleus applications (seeFig. 2). In addition, the region for fuzzy affinity calculation needs to be manually defined. To solve these problems, confidence connectedness was used in the proposed method.First, the criteria of seed point selection should be as follows. For the thalamus, the point within the distance of 3–5 pixels around its centroid was chosen. For the Vim and subthalamic nucleus (STN), choosing the point within the distance of 1–2 pixels around its centroid was ideal. The initial ROI was the region sized by 3×3×3 voxels centered from the seed point. Then, it could be updated automatically using confidence connectedness.The concept of confidence connectedness is very similar to the region-based segmentation method (see Section 2.4 for details of classification of intensity image segmentation) [43–45]. The concept was based on the clustering of voxels by computing the intensity meanmand standard deviationσin the current ROI. The calculation started from a seed point indicated by the user. First, the mean and standard deviation of image intensity was computed in the initial ROI. Then, a pre-defined multiple factorlwas used to acquire the range, which was[m−lσ,m+lσ]. Neighboring voxels with intensities within this range were included in the region. Then, the ROI was updated. After the first iteration, the intensity mean and standard deviation were re-calculated within the updated ROI. A new inclusion range was acquired, and the procedure was repeated. The iteration step was performed until no more voxels were added into the region or the maximum number of algorithm iterations was reached.The acceptance criteria for a neighboring voxelXto be included in the update ROI could be represented by the following equation, whereI()is the image region containing voxelX:(3)I(X)∈[m−lσ,m+lσ]For the value selection of multiple factorl, experiments were performed to achieve the best results. If the value was too low, only the pixels whose intensities were very near were clustered to construct the ROI. In this case, the size of ROI was regular, and ROI update was difficult during the calculation. However, if the value was too high, the acceptance condition for ROI update would be too lenient, thereby leading to mis-segmentation, and the separate structures would be segmented as one target. In this study,lwas set at 2.5 (the details of the value selection are presented in Section 3).From the above mentioned discussion, only one seed point was needed, and the ROI could be updated automatically.Segmentation based on fuzzy connectedness began by setting a seed point in ROI. The fuzzy connectedness between the characteristics of the seed point and the other points was calculated. The points with higher fuzzy connectedness than the predetermined threshold were highlighted in the object region. The detailed steps are represented as follows:(1)The function of fuzzy connectedness and the fuzzy affinity of space elements were defined;the fuzzy affinity value of each fuzzy connection pair was calculated;the seed point c was identified;the paths between the seed point c and other points were defined;the minimum fuzzy affinity of each path was calculated; andthe map of fuzzy connectedness was acquired.The fuzzy affinity of two points c and d can be illustrated as follows:(4)μk(c,d)=μα(c,d)1+k|f(c)−f(d)whereμα(c,d)is a monotonic increasing function of the distance between the points c andd, andkis a constant. Both of these two terms ranged from 0 to 1. Commonly,(5)μα(c,d)={1,if‖c−d‖≤10,othersThe fuzzy connectedness between pointscanddis defined as follows:(6)μξ(c,d)=maxp∈Pcd[μχ(p)]wherepis the sequence of space elements〈c1,c2,...,cm〉,m≥2from pointcto pointd; andc1=c,cm=d.μχ(p)is the strength of one path from pointsctod, which is defined as the minimum value of the fuzzy affinity for any two points on this path. Therefore, fuzzy connectedness is the maximum strength among all the strengths of the paths.In Eq. (3),f(c)andf(d)are the functions of pointcandd, respectively, and represent the image features located at the two points. Traditionally, image intensity was used. However, the use of a single feature often resulted in mis-segmentation or under-segmentation.In this study, image gradient was also regarded as an important feature because of the blurred boundaries of thalamic nuclei. The features that can extract information on the edges should be considered to improve the identification effects. Accordingly, the fuzzy affinity is redefined as follows:(7)μκ(c,d)=μα(c,d)[ω1h1(f(c),f(d))+ω2h2(f(c),f(d))]in which(8)h1(f(c),f(d))=e−12[(f(c)+f(d))/2−m1s1]2(9)h2(f(c),f(d))=e−12[(f(c)−f(d))−m2s2]2whereh1andh2represent the Gaussian measurement of image intensity and image gradient in ROI, respectively;m1is the mean of the image intensity;m2is the mean of the image gradient;s1ands2are the standard deviations of the image intensity and gradient, respectively.Meanwhile, determining the weight of the two terms was a key issue in the computation of fuzzy connectedness. An automatic adaptive weight assignment was used in the present study, and the equation was as follows:(10)ω1=h1h1+h2,ω2=1−ω1Therefore, with Eq. (9), we avoided using the same weight parameter for the whole image, and we may describe the fuzzy connectedness accurately. Accordingly, the calculation of fuzzy affinity should be as follows:(11)μκ(c,d)=μα(c,d)[h12(f(c),f(d))+h22(f(c),f(d))h1(f(c),f(d))+h2(f(c),f(d))]For convenience, we called the method of fuzzy connectedness based on this adaptive fuzzy affinity AFC (adaptive fuzzy connectedness), and the proposed hybrid algorithm proposed was called AFCCC (adaptive fuzzy connectedness combined with confidence connectedness).

@&#CONCLUSIONS@&#
Thalamic segmentation is a key issue in DBS. An improved fuzzy connectedness algorithm based on the traditional structural MRI was proposed in this study. Image gradient was incorporated with the exception of a single image feature, which was only based on the image intensity used in the traditional framework. Moreover, the weight of each image feature was adjusted during the calculation of fuzzy connectedness. Meanwhile, only one seed point was needed by using confidence connectedness for automatic ROI update. Thus, manual intervention was reduced. Experimental results demonstrated that the proposed method achieved higher accuracy with decreased manual intervention than the traditional method. Furthermore, effective image features may be incorporated to improve the performance of the proposed method.None declared.