@&#MAIN-TITLE@&#
Endogenous production capacity investment in natural gas market equilibrium models

@&#HIGHLIGHTS@&#
The natural gas equilibrium model in Egging (2013) excludes endogenous production capacity expansion.Investment in production capacity is added to the profit maximization problem of a supplier.This yields a convex problem and can easily be included into state-of-the-literature equilibrium models.

@&#KEYPHRASES@&#
Natural gas,Equilibrium model,Endogenous investment,Capacity expansion,Logarithmic cost function,

@&#ABSTRACT@&#
The large-scale natural gas equilibrium model applied in Egging, 2013 combines long-term market equilibria and investments in infrastructure while accounting for market power by certain suppliers. Such models are widely used to simulate market outcomes given different scenarios of demand and supply development, environmental regulations and investment options in natural gas and other resource markets.However, no model has so far combined the logarithmic production cost function commonly used in natural gas models with endogenous investment decisions in production capacity. Given the importance of capacity constraints in the determination of the natural gas supply, this is a serious shortcoming of the current literature. This short note provides a proof that combining endogenous investment decisions and a logarithmic cost function yields a convex minimization problem, paving the way for an important extension of current state-of-the-art equilibrium models.

@&#INTRODUCTION@&#
The natural gas model applied in Egging (2013) is one of the latest in a series of equilibrium models for this particular fuel. The interest stems from several potentially game-changing trends: liberalization of natural gas markets, carbon dioxide emission constraints and an expected replacement of coal by relatively clean natural gas in Europe (EC Energy Roadmap, 2011); unconventional reserves in North America and other regions (IEA, 2011); and frequent concerns regarding supply security and European dependence on a small number of suppliers (cf. Leveque et al., 2010).Hence, a number of equilibrium models have been developed over the past decade to provide numerical analysis of different scenarios regarding future supply and demand patterns, environmental regulation and infrastructure investment options. Two large-scale natural gas equilibrium models are the GASTALE model, developed by ECN (Lise & Hobbs, 2008), and the World Gas Model (WGM), joint work by the University of Maryland and DIW Berlin (Egging, Holz, & Gabriel, 2010).1Both models were published in different versions and used extensively for scenario simulations; only one recent publication for each model is cited here.1These models share a number of characteristics, similar to the model in Egging (2013): they are spatial partial equilibrium models with a detailed geographic disaggregation, allowing for analysis and comparison of different pipeline and LNG export/import options; they consider seasonality within a year and explicitly model storage to shift natural gas between low- and high-demand seasons; they are multi-period models and endogenously determine optimal investment in infrastructure2GASTALE implements a rolling-horizon investment model, while WGM is an open-loop equilibrium model.2; and they allow for oligopolistic behavior by (a subset of) suppliers, i.e., Cournot competition. Furthermore, all these models apply a logarithmic cost function, as first proposed by Golombek, Gjelsvik, and Rosendahl (1995), in order to capture the specific characteristics of natural gas production: sharply increasing costs when producing close to full capacity.However, none of these models allows for endogenous investment in production capacity; instead, the production capacity in future periods is defined exogenously. Given that production capacity is a significant determinant of results and that these models simulate price and quantity trajectories for several decades into the future, this omission is certainly a major drawback. It is owed, in all likelihood, to the rather complicated functional form when including investment decision variables in the logarithmic cost function. This paper provides the proof that this extension yields a convex problem, which is a prerequisite for solving this problem as an equilibrium model.Let me also mention one other recent natural gas model: the GaMMES model was developed by EDF and IFPEN (Abada, Gabriel, Briat, & Massol, 2013). In contrast to the models presented above, it distinguishes between spot market sales and long-term contracts. It also assumes a slightly different formulation of the logarithmic cost function: production costs are not increasing relative to capacity utilization, as in the other models, but relative to remaining reserves. This is an interesting approach, but differs from what is discussed here.All these models are formulated as Mixed Complementarity Problems (MCP). The optimization problems of different players subject to engineering and other constraints are solved simultaneously by deriving their respective Karush–Kuhn–Tucker (KKT) conditions, combined with market clearing constraints. The MCP framework is convenient for this type of exercise, as it allows to include Cournot market power for certain suppliers, in contrast to welfare maximization or cost minimization problems. In addition, these models can easily be extended to include stochasticity (e.g., Gabriel, Zhuang, & Egging, 2009) or two-level problems such as Stackelberg competition (e.g., Siddiqui & Gabriel, 2013).Assume a supplier with decision variables qy(production quantity) and ey(production capacity expansion/investment). The periods are denoted byy∈{1,…,y¯}. In order to keep the notation concise, y denotes both a period as well as its position in the set. Hence,y¯stands for both the last period as well as the number of periods in the set. Following this logic, I use y′<y for “all periods y′ prior to period y” in sums and indices, and y′>y for the inverse statement. The price at which the produced quantity is sold is denoted by py, and the initial production capacity isq¯.Production costs cy(·) are determined by a logarithmic cost function as introduced by Golombek et al. (1995) related to capacity utilization (see Eq. (3a) below).3The production cost function is not explicitly specified in Egging (2013), but it is discussed in detail in the dissertation referenced in the article.3This function is illustrated in Fig. 1: marginal production costs increase sharply when operating close to capacity. Hence, if capacity is expanded, marginal production costs for the same quantity decrease.In line with the literature cited above, capacity investment costs are assumed to be linear. The parameters of the cost function are denoted by greek letters and may vary by period: αy, βy, γyare the parameters for the production cost function; κyis the (linear) unit production capacity investment cost. All cost parameters are non-negative. Discounting of future profits may be implicitly included in the price and cost parameters. For now, I abstract from Cournot market power and other considerations such as reserve horizon or maximum investment constraints. These extensions are briefly discussed below.Furthermore, I assume that γyis strictly positive. As a consequence, the production quantity qyis implicitly bounded from above; this is explained in more detail below. I can therefore omit an explicit production capacity constraint. Otherwise, the problem would reduce to a quadratic optimization problem under linear capacity constraints, and hence convexity would hold trivially.The profit maximization problem of the supplier can then be written as follows, converted to a minimization problem:(1)minq,ef(q,e)=∑y-pyqy+cy(qy,e1,…,ey-1)+κyeys.t.q,e∈R+y¯This yields the following Karush–Kuhn–Tucker (KKT) conditions:(2a)-py+∂cy(·)∂qy⩾0⊥qy⩾0(2b)∑y′>y∂cy′(·)∂ey+κy⩾0⊥ey⩾0This optimization problem relates to Eq. (3.1.1) in Egging (2013). The KKT condition concerning the production quantity relates to Eq. (3.7.16).It is straightforward to see that there will never be investment in the last period; the KKT condition reduces to 0+κy⩾0, implying ey=0 if κy>0. This variable and the associated equation can thus be omitted from further consideration.The production cost function and its partial derivatives are listed below. In order to make the notation more concise, the sum of previous investments,∑y′<yey′, is replaced by e(y) for the remainder of this work.(3a)cy(·)=(αy+γy)qy+βqy2+γy(q¯+e(y)-qy)ln1-qyq¯+e(y)(3b)∂cy(·)∂qy=αy+2βyqy-γyln1-qyq¯+e(y)(3c)∂cy(·)∂eyˆ=γyln1-qyq¯+e(y)+γyqyq¯+e(y)ifyˆ<y(3d)∂2cy(·)∂qy2=2βy+γy1q¯+e(y)-qy(3e)∂2cy(·)∂eyˆ∂eỹ=γyqy2(q¯+e(y)-qy)(q¯+e(y))2ifyˆ<y∧ỹ<y(3f)∂2cy(·)∂qy∂eyˆ=-γyqy(q¯+e(y)-qy)(q¯+e(y))ifyˆ<yGiven this cost function and assuming γy>0 ∀y, marginal production costs tend to infinity when the produced quantity tends to initial capacity plus expansions in previous periods. Hence, production quantity qyis implicitly bounded by capacity. Mathematically speaking, for any py>0, there exists a quantity qywith∂cy(·)∂qy⩾pyandqy<q¯+e(y). Hence, an explicit production capacity condition is not required as a constraint in the optimization problem (1).4Since Egging (2013) does not assume γy>0 for all suppliers and years, the capacity constraint is included there explicitly (Eqs. (3.1.2) and (3.7.17)).4Marginal production costs∂cy(·)∂qyare non-negative, while the effect of an expansion on costs∂cy(·)∂eyis non-positive.5Note that capacity utilizationqyq¯+e(y)∈[0,1]for any feasible quantity qy. Since ln (1−x)+x⩽0 ∀x∈[0,1], that statement holds.5A capacity expansion today reduces total cost in subsequent periods for any fixed quantity (cf. Fig. 1). In contrast, in a model with linear or quadratic production cost functions and endogenous capacity expansion, only the dual (or shadow price) to the capacity constraint in future periods determines the investment; hence, only the possibility of producing a higher quantity drives capacity expansion decisions.Theorem 1Any solution to the KKT system (2) is a global optimum of the supplier profit maximization problem(1).Sufficiency of the KKT conditions can be established by showing convexity of the objective function f(q,e), which is equivalent to its Hessian matrix being positive semidefinite for any feasible vector (q,e). As shown earlier, investment in the last period can be omitted. The matrix has the following form:(4)H(f(q,e))=fqqfqe(fqe)Tfee=(5)=∂2ci(·)∂qi2ij,i=ji∈{1,…,y¯}j∈{1,…,y¯}∂2ci(·)∂qi∂ejij,i>ji∈{1,…,y¯}j∈{1,…,y¯-1}∂2cj(·)∂ei∂qjij,i<ji∈{1,…,y¯-1}j∈{1,…,y¯}∑k>max{i,j}∂2ck(·)∂ei∂ejiji∈{1,…,y¯-1}j∈{1,…,y¯-1}This matrix is symmetric and all its diagonal entries are positive, but it is not necessarily diagonally dominant; hence, we cannot apply a standard result to show positive semidefiniteness. Nevertheless, the partial derivatives of the cost function have a certain structure which can be exploited to show xTMx⩾0 for allx∈Rn.Definex∈R2y¯-1as follows: x=[(ay),(by)]T, where ayrelates to the quantity variables and byrelates to the investment variables. Since there is no investment in the last period, the variableby¯is omitted from x.(6)(ay)y∈{1,…,y¯}(by)y∈{1,…,y¯-1}TH(f(q,e))(ay)y∈{1,…,y¯}(by)y∈{1,…,y¯-1}=(7)=ay∂2cy(·)∂qy2+∑yˆ<ybyˆ∂2cy(·)∂eyˆ∂qyy∈{1,…,y¯}∑yˆ>yayˆ∂2cyˆ(·)∂qyˆ∂ey+∑yˆbyˆ∑k>max{y,yˆ}∂2ck(·)∂ey∂eyˆy∈{1,…,y¯-1}T(ay)y∈{1,…,y¯}(by)y∈{1,…,y¯-1}=(8)=∑yay2∂2cy(·)∂qy2+∑yay∑yˆ<ybyˆ∂2cy(·)∂eyˆ∂qy+∑yby∑yˆ>yayˆ∂2cyˆ(·)∂qyˆ∂ey+2∑yby∑yˆ<ybyˆ∑k>y∂2ck(·)∂ey∂eyˆ+∑yby2∑k>y∂2ck(·)∂ey2Inserting the partial derivatives stated above and rearranging terms yields the following:(9)∑yay22βy+γy1q¯+e(y)-qy-2∑yay∑yˆ<ybyˆγyqy(q¯+e(y)-qy)(q¯+e(y))+2∑yby∑yˆ<ybyˆ∑ỹ>yγỹqỹ2(q¯+e(ỹ)-qỹ)(q¯+e(ỹ))2+∑yby2∑ỹ>yγỹqỹ2(q¯+e(ỹ)-qỹ)(q¯+e(ỹ))2=(10)=2∑yay2βy+∑yγyq¯+e(y)-qyay2-2ay∑yˆ<ybyˆqyq¯+e(y)+∑yˆ<y2byˆ∑ỹ<yˆbỹ+byˆ2qy2q¯+e(y)2︸⊛(y)For positive semidefiniteness of the Hessian and hence convexity of the optimization problem, we require that the above term is non-negative for every feasible vector (q,e). For the first part,∑yay2βy, that is straightforward for any vector (a). The termγyq¯+e(y)-qyis non-negative in every period y, as otherwise the implicit production capacity constraint would be violated. For the last part, note that this term can actually be written as⊛(y)=ay-∑yˆ<ybyˆqyq¯+e(y)2,hence it is always non-negative. Eq. (10) is thus non-negative for any non-negative cost parameter vector β, a strictly positive vector γ and any vectorx∈R2y¯-1.□The proof allows one additional interesting observation: the upper left part of the Hessian matrix is positive definite for strictly positive cost parameters βy, indicating that the quantity produced in equilibrium is unique in these cases. However, depending on the parameters, the part of the matrix pertaining to the investment decision may be either positive definite or positive semidefinite. This can be interpreted that there may be cases when the timing of the investment does not matter.The following three corollaries show that the supplier’s optimization problem with endogenous expansion decision variables can be easily included in the framework of the models discussed in the introduction: the assumption of price-taking behavior (i.e., exogenous price py) may be relaxed and replaced by Cournot market power; engineering and other constraints may be considered in the optimization problem; and several suppliers may compete non-cooperatively, possibly in a richer equilibrium model with other types of players and price-sensitive demand.Corollary 2The exogenous price parameter pymay be replaced by an inverse demand function Py(·), if it is linear and downward sloping. ThenTheorem 1remains valid.The Hessian matrix of this extended problemf̃(q,e)is as follows:H(f̃(q,e))=H(f(q,e))+diag-2Py′(·)y∈{1,…,y¯},(0)y∈{1,…,y¯-1}SincePy′(·)<0, the second part of the extended Hessian is positive semidefinite. The sum of two positive semidefinite matrices is again positive semidefinite.□Constraints of the form g(q,e)⩽0, h(q,e)=0 may be added to the supplier’s profit maximization problem(1)if g(q,e) is convex and h(q,e) is affine. ThenTheorem 1remains valid.The KKT conditions of an optimization problem of the formminxf(x)s.t.g(x)⩽0,h(x)=0,with f(x), g(x) convex and h(x) affine are both necessary and sufficient.□Equilibria between several suppliers with endogenous investment decisions and other players can be solved simultaneously as an MCP by taking the respective KKT conditions of each player, combined with appropriate market-clearing conditions, given that the other players’ optimization problems are of a form such that their KKT conditions are sufficient for optimality.Cf. Facchinei and Pang (2003).□This short note points out the omission of endogenous investment decisions in production capacity in the natural gas equilibrium model applied in Egging (2013) and similar models. Instead, they rely on exogenously determined capacity increases for future periods. I propose a mathematical formulation to incorporate capacity investments into the state-of-the-literature equilibrium models with logarithmic cost functions and show that this formulation is indeed a convex problem.Nevertheless, implementing this formulation in a large-scale equilibrium model will increase the number of non-linear terms in the KKT conditions. While any solution obtained will indeed be an equilibrium, the logarithmic terms may lead to numerical problems and increased computation time. Therefore, the proposed formulation shall be integrated into a large-scale equilibrium model to test the numerical properties of this approach. In the future, the endogenous consideration of production capacity expansions may significantly improve the scope and validity of scenario simulations of the natural gas as well as other energy and resource markets.

@&#CONCLUSIONS@&#
