@&#MAIN-TITLE@&#
Secondary Laplace operator and generalized Giaquinta–Hildebrandt operator with applications on surface segmentation and smoothing

@&#HIGHLIGHTS@&#
Two new geometric operators are introduced based on the second fundamental form.The new operators, SLO and GGHO, are sensitive to the curvature-related features.A segmentation method is introduced based on the SLO eigenfunctions.A geometric flow method is developed based on the GGHO for surface smoothing.

@&#KEYPHRASES@&#
Secondary Laplace operator,Generalized Giaquinta–Hildebrandt operator,Eigenfunction,Concave and convex feature,Surface segmentation,Geometric flow,

@&#ABSTRACT@&#
Various geometric operators have been playing an important role in surface processing. For example, many shape analysis algorithms have been developed based on eigenfunctions of the ​Laplace–Beltrami operator (LBO), which is defined based on the first fundamental form of the surface. In this paper, we introduce two new geometric operators based on the second fundamental form of the surface, namely the secondary Laplace operator (SLO) and generalized Giaquinta–Hildebrandt operator (GGHO). Surface features such as concave creases/regions and convex ridges can be captured by eigenfunctions of the SLO, which can be used in surface segmentation with concave and convex features detected. Moreover, a new geometric flow method is developed based on the GGHO, providing an effective tool for sharp feature-preserving surface smoothing.

@&#INTRODUCTION@&#
Geometric operators are the basis for many algorithms in surface processing. Based on the first fundamental form of the surface, the Laplace–Beltrami operator (LBO) is defined and its eigenfunctions are well-known for their property of capturing shape behavior and structural feature of an object  [1–4]. They vary along the object surface and are invariant to different poses, which makes them ideal for applications in pose-invariant Reeb graph construction  [4], shape matching  [1] or registration  [5], the Shape-DNA  [3], and surface quadrangulation or parameterization  [6–10]. Another important application of the LBO eigenfunctions is surface segmentation. The distribution of eigenfunctions is used together with isocontours  [2,11,12] and point clustering  [13–15] to segment surface into several components. In practice, different methods were employed to improve the performance of LBO eigenfunctions [16,17]. To detect concavities, eigenfunctions from a concavity-aware Laplacian  [11] were used to generate a single segmentation field.Besides computing eigenfunctions, geometric operators are also used in various geometric flows for surface fairing and smoothing  [18–23]. The mean curvature and Gaussian curvatures are usually used to design geometric operators  [22,24]. Generally, geometric flows smooth surfaces and remove noise by moving nodes in the normal direction, while the tangential movement regularizes the elements. The tangential movement can also help strengthen surface features, which was seldom considered in the existing methods.In this paper, we introduce two new operators, namely the secondary Laplace operator (SLO) and generalized Giaquinta–Hildebrandt operator (GGHO), based on the second fundamental form of the surface. Different from the LBO eigenfunctions, the SLO eigenfunctions can capture concave and convex surface features which can be used to segment concave and convex regions. The main contribution of this paper includes1.Two new geometric operators (SLO and GGHO) are introduced based on the second fundamental form of the surface;Surface segmentation methods are developed based on the SLO eigenfunctions with concave creases/regions and convex ridges detected; andA new geometric flow method is developed based on the GGHO for surface smoothing, which preserves and strengthens sharp features on the surface.The remainder of this paper is organized as follows. Section  2 reviews the definition of several existing geometric operators and eigenfunction computation. Section  3 introduces the SLO and its application on surface segmentation. Section  4 talks about the GGHO and a new geometric flow method. Section  5 shows the results. Finally, Section  6 draws conclusions and points out the future work.Before introducing our new operators, we first briefly review definitions of several existing geometric operators. More detailed descriptions can be found in  [25]. Eigenfunctions of different operators can be computed using isogeometric analysis (IGA) based on Catmull–Clark basis functions  [26].LetS={x(u,v),(u,v)∈Ω⊂R2}be a smooth parametric surface inR3.(u,v)can also be written as(u1,u2)for convenience. The coefficients of the first fundamental form ofSare defined asgαβ=〈xuα,xuβ〉(α,β=1,2), wherexuα=∂x∂uαandxuβ=∂x∂uβ. The coefficients of the second fundamental form ofSare defined asbαβ=〈n,xαβ〉, wherexuαuβ=∂2x∂uα∂uβandn=(xu×xv)/‖xu×xv‖. Letg=det[gαβ],[gαβ]=[gαβ]−1, and[bαβ]=[bαβ]−1. We have the following geometric operators.Curvatures. The mean curvatureHand the Gaussian curvatureKare defined as(1)H=b11g22−2b12g12+b22g112gandK=b11g22−b122g.Tangential gradient operator. Letf∈C1(S), the tangential operator∇acting onfis given by(2)∇f=[xu,xv][gαβ][fu,fv]T=gu∇fu+gv∇fv,where∇f∈R3,gu∇=1g(g22xu−g12xv)andgv∇=1g(g11xv−g12xu).Second tangential operator (STO). Letf∈C1(S), the STO◊acting onfis defined as(3)◊f=[xu,xv]K[bαβ][fu,fv]T=gu◊fu+gv◊fv,where◊f∈R3,gu◊=1g(b22xu−b12xv)andgv◊=1g(b22xv−b12xu).Tangential divergence operator. Letvbe aC1smooth vector field on a surfaceS, the tangential divergence operatordivSacting onvis defined by(4)divS(v)=1g[∂∂u,∂∂v][g[gαβ][xu,xv]Tv].Laplace–Beltrami operator (LBO). Letf∈C2(S), the LBO acting onfis given by(5)Δf=divS(∇f)=1g[∂∂u,∂∂v][g[gαβ][fu,fv]T].Giaquinta–Hildebrandt operator (GHO). Letf∈C2(S), the GHO acting onfis given by(6)□f=divS(◊f)=1g[∂∂u,∂∂v][gK[bαβ][fu,fv]T].Letf∈C2(S), the eigenfunctions of LBO and GHO should satisfy(7)Δf=−λlfand□f=−λgfrespectively, whereλlandλgare the eigenvalues. According to the Green formula, for∀f∈C2(S)and∀h∈C1(S)we have(8)∫S(hΔf+〈∇f,∇h〉)dA=0and(9)∫S(h□f+〈∇f,◊h〉)dA=0.Therefore, we plug Eq. (7) into Eqs. (8)–(9) and obtain(10)∫S〈∇f,∇h〉dA=λl∫ShfdAand(11)∫S〈∇f,◊h〉dA=λg∫ShfdA.Let{φi}i=1Nbe a set of basis functions defined on the surface andφi∈C2(S),fcan be approximately represented asf=∑i=1Nwiφi. Leth=φj(j=1,2,…,N), then we have∑i=1Nwi∫S〈∇φi,∇φj〉dA=λl∑i=1Nwi∫Sφi⋅φjdAand∑i=1Nwi∫S〈∇φi,◊φj〉dA=λg∑i=1Nwi∫Sφi⋅φjdAfor the LBO and GHO, respectively. LetmijL=∫S〈∇φi,∇φj〉dA,mijG=∫S〈∇φi,◊φj〉dA, andcij=∫Sφi⋅φjdA. The eigenfunctions of LBO and GHO can be obtained by solving the eigenproblems(12)MLW=λlCWandMGW=λgCW,whereML=[mijL],MG=[mijG],C=[cij], andW=[w1,w2,…,wN]T. Embedding the eigenvectorWon the surface, we obtain an eigenfunction of the specific geometric operator.In this paper, we focus on the two new operators based on the second fundamental form of the surface, and a cubic or higher order surface representation is required. While many other methods can also be used, we choose the cubic Catmull–Clark subdivision surface due to its wide adoption  [26]. As shown in Fig. 1, for the input triangular surfaces we use cross field-based surface parameterization  [27,7] to generate semi-structured quadrilateral meshes with only a few extraordinary nodes. Triangle subdivision schemes such as the Loop subdivision can also be used to study SLO and GGHO, but attentions should be paid to the number and placement of extraordinary nodes. Fig. 2(a)–(b) shows the first four eigenfunctions of the LBO and GHO for the Elk model, respectively. The LBO eigenfunctions vary smoothly on the surface following the main structure of the model, but it is hard to detect curvature-related features (e.g., the concave creases connecting the four wheels, the horn and the main Elk body) because the LBO is defined based on the first fundamental form of the surface, see Fig. 2(c) for the segmentation result using the LBO eigenfunctions. On the contrary, the GHO eigenfunctions hardly reveal any geometric feature of the object. This is because◊fis almost zero in the planar regions, which makes the matrixMGclose to singular. To better detect curvature-related features, we define two new geometric operators (SLO and GGHO) in the following two sections.Based on the second fundamental form of the surface, we generalize the definition of the STO, and introduce a new geometric operator named the SLO. Different from the LBO eigenfunctions, the SLO eigenfunctions are sensitive to concave creases/regions and convex ridges, providing a powerful basis for surface segmentation.We generalize Eq. (3) by replacingKwithΨ, and define ageneralized STO (GSTO),(13)◆f=[xu,xv]Ψ[bαβ][fu,fv]T=gu◆fu+gv◆fv,wheregu◆=Ψb(b22xu−b12xv)andgv◆=Ψb(b11xv−b12xu).Here we chooseΨ=1,eKore−Hfor different purposes in surface segmentation, see Section  3.2 for details. From Eq. (13),∀f,h∈C1(S), we can derive that(14)〈◆f,◆h〉=[fu,fv]Ψ2[bαβ][gαβ][bαβ][hu,hv]T=[fu,fv]A[hu,hv]T,whereA=Ψ2[bαβ][gαβ][bαβ]=[aαβ],witha11=Ψ2b2(b222g11−2b22b12g12+b122g22),a12=−Ψ2b2(b22b12g11−(b11b22+b122)g12+b11b12g22),a22=Ψ2b2(b112g22−2b11b12g12+b122g11).To detect curvature-related features, we define a new geometric operator based on the second fundamental form of the surface, namely thesecondary Laplace operator (SLO). Givenf∈C2(S), the SLO▴is defined implicitly which satisfies(15)∫S(h▴f+〈◆f,◆h〉)dA=0,∀h∈C1S. The inner product offand▴fis(16)∫S(f▴f)dA=−∫S〈◆f,◆f〉dA=−∫S‖◆f‖dA≤0,therefore the SLO is a semi-negative definite geometric operator. The SLO eigenfunctions should satisfy(17)▴f=−λsf,whereλsare the eigenvalues. By plugging Eq. (17) into Eq. (15), we have(18)∫S〈◆f,◆h〉dA=λs∫ShfdA.Similar to Eq. (12), the eigenfunctions of SLO can be obtained by solving an eigenproblem(19)MSW=λsCW,whereMS=[mijS]andmijS=∫S〈◆φi,◆φj〉dA. Note that the explicit definition of the SLO is not required during the eigenfunction computation.As defined using the second fundamental form of the surface, the SLO eigenfunctions are sensitive to curvature changes on the surface. By choosing different values forΨ, different surface features such as concave creases/regions and convex ridges can be detected using the SLO eigenfunctions. In the following, we introduce three different choices ofΨfor surface segmentation.Due to the second fundamental form in the definition of SLO, its eigenfunctions reflect the curvature-related surface features, which provide a convenient basis for surface segmentation. Basically, surface segmentation consists of two main steps: computing eigenfunctions and mapping vertices onto ak-dimensional space using the firstkmodes; and clustering vertices into a series of groups or surface patches. In this paper, point clustering is fulfilled using Prediction Analysis for Microarrays (PAM)  [28]. The clustering result can be evaluated using the Davies–Bouldin value  [29], which determines the optimal group number.With different choices ofΨ, the SLO eigenfunctions tend to emphasize different types of surface features such as concave creases/regions and convex ridges. In this section, we use the mean curvatureHand Gaussian curvatureKto defineΨ. To avoid generating singular matrices, we restrictΨ={ψlifΨ<ψlψuifΨ>ψu,whereψlandψuare the lower and upper bounds, respectively. Here we chooseψl=0.5andψu=10in the computation. Three different values are adopted in this paper:1.Ψ=1for segmenting smooth faces with both concave creases and convex ridges. For example in Fig. 3, the three cylindrical components contain concave creases at the root and convex ridges at the top. WhenΨis a constant, the eigenfunction value varies intensively across both concave creases and convex ridges and stays similar in smooth regions surrounded by them, so each smooth region can be segmented as a patch. Since the choice of the constant value does not change the distribution of eigenfunctions, we simply chooseΨ=1in this paper;Ψ=eKfor segmenting components with concave creases only. In many objects, components with physical meanings are usually connected with concave creases rather than convex ridges. For example in Fig. 4, the connection regions between the horn, four wheels and the body of the Elk model are all concave creases. These concave creases have negativeKwhile convex ridges have positiveK. In addition, the SLO eigenfunctions tend to be more sensitive to regions with a smallerΨ, where the eigenfunction value varies intensively. For the regions with a largerΨ, the eigenfunction value stays similar. Therefore, we chooseΨ=eK, so the intensive variation of eigenfunctions only happens across concave creases and the regions surrounded by them are segmented as patches; andΨ=e−Hfor segmenting concave regions from smooth surfaces. Some concave regions we want to segment may not be surrounded by obvious concave creases or convex ridges, such as the three shallow concave regions in the Disk model in Fig. 3. These concave regions have negativeH, so we chooseΨ=e−Hto set a largeΨin them and a smallΨfor the remaining surface. As a result, the eigenfunction value stays similar inside the concave regions, and we segment each of them as a patch.Compared with the LBO eigenfunctions in Fig. 2(a), the SLO eigenfunctions in Fig. 4(a), (b) are more sensitive to the variation of surface curvatures, which perform better in determining the patch boundaries in the segmentation results in (c), (d). For a certain object, the choice ofΨdepends on specific purposes. For example whenΨ=1, the horn of Elk is separated into two planar regions in (c), which may be desired for design or manufacturing. But for structure recognition, the result in (d) may be preferred because the horn is a single solid component.Analogy to the definition of GHO in Eq. (6), we introduce ageneralized Giaquinta–Hildebrandt operator (GGHO), which is defined as(20)■f=divS(◆f).Then we have(21)■f=1g[∂∂u,∂∂v][gΨ[bαβ][fu,fv]T].Letv=(v1,v2,v3)T∈R3be a vector field, we define■v=(■v1,■v2,■v3)T∈R3. Acting the GGHO on the coordinates of the surface point, we have(22)■x=1g([∂∂u,∂∂v][gΨ[bαβ][xu,xv]T])T=1g([∂∂u,∂∂v]ΨK[gK[bαβ][xu,xv]T])T=ΨK1g([∂∂u,∂∂v][gK[bαβ][xu,xv]T])T+([∂∂u(ΨK),∂∂v(ΨK)][K[bαβ][xu,xv]T])T=ΨK□x+◊(ΨK)=2Ψn+◊(ΨK),wherenis the normal. A geometric flow can be defined as(23)∂x∂t=■x+λvT,wherevTis a vector in the tangential direction regularizing the quadrilateral elements, andλcontrols the strength of regularization (e.g.λ=0.05).vTis usually defined based on the geometric center of the 1-ring neighborhood of a node, but features might be blurred in this way. In this paper, we define an anisotropy in the 1-ring neighborhood based on the principal curvature directions, andvTis an weighted average of the neighbors. Let Nodejbe a neighbor of Nodei, andκj1andκj2be the principal curvature directions. The feature directionκjis defined as the larger one betweenκj1andκj2. The weight of Nodejis defined as(24)wij=|〈κi,κj〉⋅〈ni,nj〉|+εA,whereεAis a predefined parameter and here we chooseεA=0.05in our computation. We obtain similar weights for the neighbors with a weak anisotropy, such as the flat regions. We have(25)vT=∑j∈N(i)wijxj∑j∈N(i)wij−xi,whereN(i)is the 1-ring neighborhood of Nodei. With Eq. (24), large weights are assigned to the neighbors located along the same concave or convex edge with Nodei. Nodes across concave or convex edges have little influence to each other. If Nodeiis not on the sharp edge,vTwill be the geometric center of its 1-ring neighbors.■xconsists of two components in the normal and tangential directions, respectively.To strengthen concave creases and convex ridges on the surface, we chooseΨ=HK2K2+δ2in this paper. In this way, these creases and ridges can be characterized by the sign ofψ, negative for concave creases and positive for convex ridges. Then we have(26)■x=2HK2K2+δ2⋅n+◊(HKK2+δ2),whereδis a small constant (e.g.δ=0.1). Since GGHO is defined based on the second fundamental form of the surface, it is more sensitive to the curvature-related features compared with LBO, which is defined based on the first fundamental form. Fig. 5shows the smoothing results for the Moai model based on the LBO and GGHO. Compared with LBO, some sharp edges such as the lower jaw and the eyebrow are preserved and sharpened using GGHO.

@&#CONCLUSIONS@&#
