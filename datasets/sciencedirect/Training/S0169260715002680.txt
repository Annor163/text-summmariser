@&#MAIN-TITLE@&#
Software for computerised analysis of cardiotocographic traces

@&#HIGHLIGHTS@&#
A software for automatic CTG analysis which could be a useful clinical tool is shown.The software provides important classical and nonlinear parameters.Simulated and real CTG traces were analysed to test software reliability.The software showed good performance, in fact all simulated events were detected.On real CTG: sensitivity equal to 93%, positive predictive value 82%, accuracy 77%.

@&#KEYPHRASES@&#
Computerised cardiotocography,Foetal heart rate variability,Nonlinear indices,FHR clinical analysis,Software performance,Matlab,

@&#ABSTRACT@&#
Despite the widespread use of cardiotocography in foetal monitoring, the evaluation of foetal status suffers from a considerable inter and intra-observer variability. In order to overcome the main limitations of visual cardiotocographic assessment, computerised methods to analyse cardiotocographic recordings have been recently developed. In this study, a new software for automated analysis of foetal heart rate is presented. It allows an automatic procedure for measuring the most relevant parameters derivable from cardiotocographic traces. Simulated and real cardiotocographic traces were analysed to test software reliability. In artificial traces, we simulated a set number of events (accelerations, decelerations and contractions) to be recognised. In the case of real signals, instead, results of the computerised analysis were compared with the visual assessment performed by 18 expert clinicians and three performance indexes were computed to gain information about performances of the proposed software. The software showed preliminary performance we judged satisfactory in that the results matched completely the requirements, as proved by tests on artificial signals in which all simulated events were detected from the software. Performance indexes computed in comparison with obstetricians’ evaluations are, on the contrary, not so satisfactory; in fact they led to obtain the following values of the statistical parameters: sensitivity equal to 93%, positive predictive value equal to 82% and accuracy equal to 77%. Very probably this arises from the high variability of trace annotation carried out by clinicians.

@&#INTRODUCTION@&#
At the end of pregnancy, assessing of foetal well-being depends on the evaluation of multiple parameters, many of them correlated to characteristics of foetal heart rate (FHR) signals recorded by means of Cardiotocography (CTG). This technique, widely used both in the antepartum and intrapartum period [1], consists of the simultaneous recording of FHR and uterine activity (generally referred as uterine contractions signal – UC) [2,3]. Both FHR and UC are simultaneously recorded and printed onto a paper strip. In the classical approach, clinicians, whose task is to classify the signal patterns, visually interpret this graphical representation. Many parameters of FHR signals need to be interpreted for the evaluation of foetal health status: the basal level of FHR signal (also called baseline), FHR variability (FHRV) and transient increases (accelerations) or decreases (decelerations) of the FHR. FHRV represents the beat-to-beat effect of foetal sympathetic and parasympathetic nervous systems and its changes may be also the result of the foetal sleep-wake cycle, drugs, umbilical cord compression, foetal hypoxia and such severe conditions as foetal acidemia [4]. Accelerations are the result of foetal movements and identify the foetal well-being, while decelerations are the symptom of foetal distress usually indicating the risk of foetal hypoxia [5], even if their interpretation is difficult and associated to different aspects such as shape, superimposed variability and delay with respect to UC [6].Visual analysis of CTG recordings (sometimes here called CTG traces or only CTG) has a well-demonstrated poor reproducibility [7] due to the complexity of physiological phenomena affecting foetal heart rhythm [8] and being related to clinician's experience. A sufficiently high level of disagreement was noted between observers as well as for the same observer [9–11]. This great intra- and inter-observer variation negatively affects sensitivity and specificity in reading CTG traces [12]. Besides, abnormal patterns can be recorded both in case of foetal distress and in foetal well-being but during quiet periods of the foetus. Therefore, establishing foetal state is often a difficult issue in clinical practice and the erroneous evaluation of CTG may lead to unjustified invasive medical interventions. This is not just an ethical issue since in some countries CTG recording is a medical report with legal value [13–15].In order to decrease the subjective nature of foetal state evaluation, the visual interpretation is more and more often replaced by automated computerised analysis, which has the theoretical advantage of providing a reproducible and objective interpretation of CTG traces and quantifying parameters that are difficult to assess by the human eye, such as short- and long-term variability [7,16]. Furthermore, it has been demonstrated that computerised CTG has also a great potential to improve the diagnosis of foetal asphyxia in labour [17]. Computerised systems are also able to provide an easily accessible means for storage, review and transmission of data and enhance the constitution of databases, with important clinical and research applications [7]. They have been developed since the late 1970s but the interest in this field is still alive since computerised CTG systems have not yet gained very wide clinical acceptance. This may be related to the limited demonstration of their validity and efficacy, as well as to the poor practicality of their routine clinical use [16]. At the same time, it is difficult to implement the heuristic rules used by clinicians during the diagnostic inference in signal processing algorithms [5]. Up to now, the basic idea in automatic CTG analysis has been the assessing of parameters historically and habitually used by clinicians for the diagnosis such as the baseline, followed by the detection of events like accelerations and decelerations, considering and measuring some morphological characteristics in the same way as the clinicians do by eye inspection [18]. Nevertheless, this is not a simple task; in particular, there is currently no consensus on how computer estimation of the FHR baseline should be performed [19], although the baseline is considered as one of the fundamental features of the FHR pattern because it can influence overall tracing interpretation and most of the other features rely on its estimation [20,21]. Besides, there is not still a unique criterion for defining accelerations, and analogous disagreement between authors can be found in establishing criteria for the detection of decelerations and contractions. Thus, developing a software that can be really helpful for clinicians in foetal monitoring represents a remarkable purpose.The aim of this study is to present the main characteristics and potentiality of a new software for computerised analysis of antenatal CTG developed mainly for research purposes, which, although does not represent a diagnostic tool, can be also a useful technical support for clinicians. It has been the result of a research study of some previous automated systems for FHR analysis present in literature in order to join the estimation of the most relevant parameters for a more objective analysis. First target of the proposed computerised analysis system is to make automatic the procedure for measuring the parameters which are historically and still nowadays employed in daily clinical practice. Then, since many works highlight the usefulness of nonlinear techniques in the study of heart rhythm [22–25], other less traditional parameters are involved in order to enlarge information amount related to FHR.In this section an overall description of CTG recordings, software features and tests carried out is given; a more detailed analysis is reported in Appendix A. The software was completely developed in Matlab ver. R2011a. Concerning classical parameters, the implementation of the algorithm started from the indications by Mantel et al. [26,27], because they seem to be the most complete and detailed.CTG traces here used to test software performances are part of a database which includes almost 400 signals recorded from 2000 to 2009 in clinical environment. All CTG were recorded during daily routine foetal monitoring in clinical environments from women between 31st and 41st week of gestation, both in antepartum and in intrapartum period; they last at least 20min. The patients laid down in a rest position. Neonatal parameters such as Apgar score and new-born weight and other information such as eventual maternal pathologies had been also collected when available. Based on the available data, about 55% of pregnant women had a caesarean section and 35% a spontaneous delivery. In addition, 45% of births were male and 35% female.Cardiotocographic signals were acquired using HP-135x or Sonicaid cardiotocographs equipped with an ultrasound Doppler probe to detect FHR signal and an external pressure transducer to record UC signal. In HP cardiotocographs, FHR and UC signals are internally stored at 4Hz (corresponding to a sampling interval of 250ms). On the contrary, in Sonicaid cardiotocographs, FHR and UC signals are unevenly stored.Digital signals were acquired from the CTG devices to the computer's serial port via a standard computer cable, using a RS232 protocol. An interface (not described for sake of brevity) was developed by the authors in C language only for CTG acquisition, storing in files and real-time visualisation.For considering at least 30 signals, initially, 40 CTG were randomly extracted from that database. Then, in order to involve only CTG signals by healthy foetuses and of acceptable quality, were excluded from the study signals that did not meet all the following requirements:•a length of at least 20minutes;a percentage of signal loss lower than 10%;a percentage of outliers lower than 5% (we judged a signal with too many outliers poorly reliable);acquired from singleton pregnancy;spontaneous delivery or elective caesarean, without complications;correspondence with a healthy newborn (Apgar at least 7, birth weight appropriate for gestational age).Some of these informations, such as percentage of signal loss and outliers, are provided by the pre-processing (Section 2.2).After this check, 34 CTG signals, with different levels of interpretation difficulty, were considered in the study.This section of the software is not object of our tests and is briefly described only for sake of completeness, its functioning and performances were previously reported [14,28]. It is blind to the operator and has as main purpose to make available for further analysis FHR and UC signals with similar characteristics regardless from the device used for CTG acquisition (the algorithm can process CTG signals recorded with HP/Philips, Sonicaid or Coronometrics devices).The software devoted to the pre-processing processes files in output from the interface. Main steps of the algorithm are:•signal reading and assignation of the variables: FHR, toco (uterine contractions) and quality;recognition of the signal tracts having good and bad quality (these last including tracts of signal loss).For each segment of good quality:•recovery of the real uneven FHR series when CTG output is evenly spaced (case of HP/Philips cardiotocographs) [14];processing of outliers [28]:∘detection and substitution of isolated outliers;detection of consecutive outliers, whose quality is posed equal to zero.interpolation of signal tracts of poor quality (according to an index provided by the equipment) or signal loss which last maximum 3s, in order to avoid an excessive fragmentation of the signal.These operations, actually necessary only for FHR signals, were simultaneously adopted also for UC signals in order to maintain the alignment between them.Besides, a time axis in seconds is constructed summing from time to time the reciprocal of FHR samples, expressed in beats per minute (bpm), multiplied by 60.In output, the algorithm provides also other information useful to increase the reliability of successive processing, such as quality of FHR samples, duration of the more length segment of good quality, position of samples corresponding to substituted outliers, percentage of remaining outliers, position and percentage of interpolated samples and percentage of loss or bad quality tracts in the output FHR signal.CTG traces populating the data set described in Section 2.1 are output of the pre-processing.This part of the analysis is the core of our software since it provides the estimation of the main clinical-interest parameters in foetal monitoring [29].About this analysis, it is worth highlighting the absence of widely accepted definitions and/or quantitative criteria to be directly implemented in computerised CTG. For example, concerning accelerations, events more easily recognisable, according to Mantel et al. [27], an acceleration should have a peak >10bpm above the baseline and should last for more than 10s. FIGO guidelines [30] and the National Institute of Child Health and Human Development (NICHD) [31], instead, proposed a definition of acceleration like an increase of 15bpm from the baseline with a duration longer than 15s. Other examples could be reported, such as the introduction of small and prolonged accelerations [31,32]. Even about the definition of the normal range of FHR there is still an open debate [33].In this scenario, our algorithm for the identification of classical parameters is based on a mixture of rules based on FIGO guidelines, other literature indications [2,13,26,27,31,34] and experimental choices (please see Appendix A for details).Following Mantel criteria and FIGO guidelines, the baseline is defined as current average of the heart rate in absence of accelerations and decelerations [26,30]. In particular, the baseline is computed in five steps. At first, a low pass filter on the FHR signal is used in order to obtain a starting baseline estimation. Secondly, a lower (20bpm below the previous estimated baseline) and a higher (20bpm above the baseline) threshold is set to remove FHR variations that exceed this range and a low pass filter is adopted afterwards for evaluating the baseline of the new FHR. This second step is reiterated three times changing only the higher threshold value, which is reduced by 5bpm for every iteration.The algorithm for the identification of accelerations provides the total number of accelerations, their classification (big, small or very small) and, on demand, all their numerical characteristics (start and end, duration, maximum amplitude, area).It is divided into three main phases. First, preliminary identification of candidate accelerations (based on criteria concerning maximum amplitude with respect to the baseline and duration). Secondly, control of the gap (lowering of the heart rate below a certain threshold within the same acceleration) and, in case, division in two or more candidate accelerations, which could be not considered in the subsequent steps if they do not satisfy fixed rules. Finally, elimination of accelerations containing too many interpolated values within them (on the basis of an accepted maximum value heuristically set).The algorithm for the identification of the deceleration is similar to that of the accelerations. It has the same logical flowchart but, of course, adopted criteria are different for all the phases.On the basis of a previous work of the authors [35], the floatingline estimation was implemented by means of a nonlinear filtering, using the cubic smoothing spline and varying the smoothing parameter (corresponding to different cut-off frequencies) to obtain a curve that comes closest to the definition of floatingline, median line of the FHR. In particular, the filter band is different in presence or absence of accelerations (which enlarge the frequency band of the floatingline). After that, just for visual inspection, the various tracts of bad quality are linearly interpolated.With regard to the detection of uterine contractions, a reference is calculated (a kind of basal tone) with an algorithm very similar to that developed for the calculation of the baseline; then, uterine contractions are detected by evaluating their duration and amplitude with respect to the computed basal tone.In addition to the features described above, the software provides the value of FHR mean, the length in minutes of the signal and the total percentage of interpolated samples.With regard to the graphics, in addition to the typical display of Matlab (default visualisation), the user can choose to view the CTG trace according to clinical standards. In this case, the software simulates the CTG paper running speed of 1 centimetre (cm) per minute and displays trace segments of 25cm for every page. The FHR range is 50–210bpm and UC range is 0–100a.u.In order to distinguish the different features, we choose various colours for each of them: FHR and UC signals are printed in black, baseline in magenta, floatingline in yellow, accelerations in green, decelerations in blue, contractions in cyan.In addition, accelerations lasting from 3 to 10min, or decelerations lasting from 2 to 3min, i.e. those that do not meet FIGO definitions, are highlighted with a message and green (or blue for decelerations), black-bordered triangles. Finally, it is possible to point out signal tracts containing interpolated values, highlighted with red crosses. Also in this case, if the number of continuous interpolated samples exceeds a certain value, a legend warns the clinician about their presence.In order to complete the analysis and to enlarge the data set of CTG features to be supplied to the user, the software estimates other FHR parameters obtained with different techniques: Time and Frequency Domain analyses, recognised as important tools for assessment of foetal well-being, and the more recent Symbolic Dynamics.Short term variability (STV) of FHR refers to the continuous variation in difference between successive inter-beat intervals and it is difficult to interpret reliably with the naked eye. This parameter is important since permits to investigate foetal reactions to internal or external stimuli. In general, large variability reflects a healthy autonomic nervous system (ANS) and, for this reason, STV can represent a valid support to diagnose foetal health.In agreement with a previous study of the authors, the software assesses STV as standard deviation of the FHRV, obtained after subtraction of the floatingline from the FHR signal [36]. The computation is carried out on sliding windows of length M (with M covering 30s), with an overlap of M−1 samples; then, for providing an overall STV index of the signal, the mean of all STV values is computed.According to the literature and methodologies previously used by the authors [37–40], the power spectral density (PSD) of the FHRV is estimated by means of the Short Time Fourier Transform (STFT) using a sliding Hamming window of length L (where L corresponds to 32s), with an overlap of L−1 samples, after removal of the floatingline [41]. For each shift of the window, the software computes a new PSD. To be able to use the STFT, the FHR signal is previously interpolated by means of a cubic interpolation and re-sampled at 4Hz [42]. The main frequency bands of FHR, chosen after a careful study of different literature works [43–46], are set from 0Hz up to 0.05Hz for very low frequencies (VLF); from 0.05Hz up to 0.2Hz for low frequencies (LF); from 0.2Hz up to 1Hz for high frequencies (HF). Then, the software computes the power in these bands (respectively named VLFp, LFp and HFp) by means of a simple integral rule and the sympato-vagal balance index (SVB), as ratio between LFp and HFp.Although it has been demonstrated that the cubic interpolation minimises the errors introduced in the PSD, in order to avoid this operation, the Lomb method is also employed to compute the PSD [47–50]. This method, in fact, was suggested for HR signals in adult subjects by Laguna et al., just to be applied directly on the uneven series; even if it has the disadvantage to be very time consuming. For a more detailed description of the technique, please refer to specific literature or to previous works of the authors [41,42]. After the PSD evaluation, the same frequency parameters are computed (VLFp, LFp, HFp, SVB).The Symbolic Dynamics analysis (SDA) is a nonlinear technique here introduced since in the last decades it has been used in adult HRV analysis for its potentiality in highlighting nonlinear mechanisms involved in heart rhythm control and it has already obtained some success [51,52]. Although in a less widespread, it has been employed also in foetal field providing promising results [22], which indicate that it could represent a helpful additional tool in foetal monitoring.For providing a very brief description, main steps of SDA are: encoding of a series using symbols chosen by a previously set alphabet and defined rules, generation of words of fixed, adequate length and classification of the words.Recently, the authors have proposed an index, computed analysing the distributions of words with similar characteristics, as an alternative and complementary index to estimate the variability of FHR signals and to study the relationship between FHRV and neonatal wellbeing [53–55]. This index, named V.I. (Variability Index), is included in the set of parameters provided by the software.A graphic interface, enforced with Matlab Graphical User Interface Development Environment (GUIDE), allows clinicians to interact with the software by means of simple buttons. The different analysis, classical, time domain, frequency domain and nonlinear are independent.Besides, the operator can modify the baseline smoothing value (of course a default value is set). When the user chooses this option, he is warned that, as consequence, results of classical analysis will change and, in any case, changes will apply only for the current session.The results of the analysis by default are shown at monitor but, of course, can be also printed and/or saved.In order to verify the agreement between software results and specifications, we carried out tests on synthetic CTG signals.According to previous works, an artificial R–R tachogram with R–R samples expressed in seconds and with specific power spectrum characteristics, proper for FHR, was generated using an inverse Fourier transform. In particular, we fixed central frequencies of the spectral bands, the bandwidths and the ratio between power of low and high frequency bands. Then, the FHR signal was computed using the known formula FHR=60/RR, and fixing FHR mean value and standard deviation of its peak-to-peak amplitude. After that, accelerations and decelerations were simulated by using Gaussian-like signal tracts and setting a priori waveform's features and parameters, such as for example amplitude, position and duration (for a more detailed explanation about how these synthetic signals were generated, please refer to previous works of the authors [14,36,56]).UC signals were simulated directly in time domain. The basal UC signals were simulated by low-pass filtering a white noise and, as for the FHR, a sinusoidal basal tone can be superimposed. Then, it is possible to simulate the contraction events with a procedure similar to that used for the accelerations.In this way we knew exactly how many and what events were present, i.e. we had a gold standard with which compare software results, hence we could evaluate its performances.In case of real signals, because of the lack of a gold standard to be used for the validation of the software, we decided to compare the results of Section 3.5 with the visual assessment performed by a team of 18 expert clinicians who referred mainly to FIGO guidelines. All them had more than 10 years experience in CTG analysis and continue to use this technique during their daily clinical activities almost all in the most important hospital of South Italy. In order to avoid a possible source of error, CTG signals printed in way to be compatible with the usual clinical format (please, see Section 2.3.7) were submitted to their analysis. Of course obstetricians did not know results of computerised analysis.This kind of comparative analysis is not unusual, in fact, traditional CTG inspection is widely considered an important basis to test the reliability of computerised systems [4,19–21,32,57,58], even though the subjectivity of visual assessment and the lack of an objective measure of foetal condition cause an unavoidable inter-observer variability [9,27].The comparison was conducted submitting all 34 CTG traces to be analysed, to all experts and to software.We focused our attention specifically on events detection (accelerations, decelerations, contractions). Basically, we compared the number of the events recognised through our software with the ones identified by means of visual inspection, regardless of the instants of beginning and end, and then we computed three indexes representing measures of our software technical performance (for details see following Section 2.8).We neglected baseline and floatingline testing because despite to their importance they generally are not directly estimated by clinicians, even if baseline is the reference used to detect accelerations and decelerations.The other analyses were excluded from the tests because in most cases they can be executed only in numeric way and some of them are not so familiar for clinicians.After an initial, qualitative evaluation of the comparison results, we noted that many divergences between obstetricians and software results were due to a different approach in some situations.Therefore, as consequence of some discussions with clinicians and a deepened analysis of the events, we decided to exclude from the study the following categories of events:•events occurring at the initial or final tract (length heuristically set at 1min) of CTG signals were neglected by clinicians;in case of two or more consecutive, very close or overlapped accelerations (distance of about 6s or lower), only one event is usually considered by clinicians whereas the other ones are not taken into account because they do not provide additional information to the recognised foetal activity;still concerning the accelerations, those classified by the software as “non FIGO” were excluded because of unclear definition;about UC signals, some obstetricians recognised also spikes, identified as foetal movements and hence considered of prognostic meaning. Nevertheless, these events (with duration lower than 20s) were did not involved in the study since they do not meet literature definition of contractions neither of foetal movement (at the best of our knowledge a definition of foetal movement is completely missing and entrusted only to the physician experience).In the following Fig. 1, some examples of excluded events are shown.In the above illustrated CTG trace, it is possible to observe an example of two consecutive FHR accelerations between the 4th and the 5th min of recording with an estimated distance of about 3s, which are well identified by the software but, at the same time, are treated as only one overall event by clinicians inspecting the signal. Moreover, within the same recording, it is clearly displayed a spike at about the 13th min of UC signal, which obstetricians considered as a foetal movement. Both those events were excluded from the study.Due to the high inter-observer variability (found also in this study, as reported in Section 3), different methodologies there exist in recent literature to specifically evaluate agreement computer-observer or among observers [59–61]. Nevertheless, there is no a reference gold standard to establish the true positive events.In this study, we defined a weight factor (W in Eq. (1)) representing the probability that an event is true in accordance with the number of obstetricians who recognised it.Then, we set two thresholds on the basis of two percentages of agreement between clinicians who examined the recordings, Perc1 and Perc2, respectively equal to 15% and 85% in this study. We considered W=1 if the percentage of agreement is at least Perc2 and W=0 for a percentage lower than Perc1. Between Perc1 and Perc2, W is linearly varying.(1)W=N−round(Perc1×NG)round(Perc2×NG)−round(Perc1×NG)where NG=total number of clinicians involved in the study; N=number of clinicians who identified a specific event; Perc1=percentage of identification leading to consider W=0; Perc2=percentage of identification leading to consider W=1.In order to have an index limited between 0 and 1, we set at 0 all negative results and at 1 all W values greater than 1.Finally, we defined three performances indexes associated to the events classified as true positive, false positive and false negative (as known, events not detected by the software), respectively named IPTP, IPFP and IPFN, computed according to the following formula:(2)IPTP=∑E×WIPFN=∑E¯×WE=∑E×(1−W)where IP=Index of Performance; E=1 if the software identifies the event, 0 otherwise;E¯=complementofE; W=weight factor; TP=true positive; FN=false negative; FP=false positiveAs last step, we evaluated some statistical parameters in order to verify the overall potentiality of the software.We computed sensitivity, positive predictive value and accuracy (see formula below) substituting numbers of true positives, false negatives and false positives by the corresponding performance indexes.(3)SENSITIVITY=true positivetrue positives+false negatives×100POSITIVE PREDICTIVE VALUE=true positivestrue positives+false positives×100ACCURACY=true positivestrue positives+false positives+false negatives×100

@&#CONCLUSIONS@&#
