@&#MAIN-TITLE@&#
Blind audio source counting and separation of anechoic mixtures using the multichannel complex NMF framework

@&#HIGHLIGHTS@&#
The tasks of audio source counting and separation for a stereo anechoic mixture of audio signals are addressed.A novel approach is introduced for estimating the number of sources as well as the channel mixing coefficients based on evaluating a 2-D spectrum.An extension of a single channel complex matrix factorization method to multichannel is developed to extract the individual source signals.A model order selection method is proposed to infer the optimal number of the components required for modeling each source.The separation performance improvement over the conventional methods is investigated by calculating BSS evaluation metrics.

@&#KEYPHRASES@&#
Blind Source Separation (BSS),Complex Non-negative Matrix Factorization (CNMF),Binary masking,Anechoic mixture,

@&#ABSTRACT@&#
In this paper, we address the tasks of audio source counting and separation for a stereo anechoic mixture of audio signals. This will be achieved in two stages. In the first stage, a novel approach is introduced for estimating the number of sources as well as the channel mixing coefficients. For this purpose, a 2-D spectrum is evaluated against both the phase and amplitude differences of the two channels. Hence, obtaining the peak locations of the spectrum yields the number of the sources and the corresponding channel coefficients. In the second stage, an extension of a single channel complex matrix factorization method to multichannel is developed to extract the individual source signals. We find primary estimates of the sources via binary masking and then apply the complex factorization to the complex spectrogram of each source. The obtained factors are then utilized as initial values in the complex multichannel factorization model. We also suggest a method for estimating the number of required components for modeling each source. The separation performance improvement over the conventional methods is investigated by calculating BSS evaluation metrics. The comparison is also carried out in terms of source counting and localization with the recently proposed DeMIX-Anechoic method.

@&#INTRODUCTION@&#
Most audio signals are mixtures of several sources which might be active concurrently. Separation of audio signals is required for several audio processing tasks such as speech recognition, speaker identification, and polyphonic music transcription.When no prior information of the sources or channel mixing system is available, the task is called Blind Source Separation (BSS). When the mixing coefficients are real value gains, the mixture is termed instantaneous. However in real environments, the mixing process consists of a linear time-invariant filtering of the source signals as(1)xi(t)=∑j=1J∑τ=−∞∞aij(τ)sj(t−τ),i=1,2wheresj(t),j=1…J, are the source signals andaij(τ)denotes the mixing filter. If the length of the filters aijare sufficiently smaller than the window length, (1) can be represented in the frequency domain as the following approximation:(2)Xft=A(f)SftwhereXft=[X1ftX2ft]Tindicates the mixture signal complex STFT coefficients on two channels.A(f)represents the2×Jmatrix containing the channel mixing coefficients andSft=[S1ft…SJft]Tdenotes the complex spectrogram coefficients of the sources. For the case of anechoic mixtures where no reflection is assumed from the objects existing in the environment, the complex valued coefficients of matrix A have frequency independent magnitudes while their phase varies with frequency depending on the microphone array arrangement and the source location w.r.t. the array. The Fourier transform of the mixing filter coefficients can be parameterized as [12](3)aij(f)=κije−i2πfτijκij=14πrijandτij=rijCswhere rijspecifies the distance between jth source and ith microphone and Csis the sound propagation velocity.In a more realistic environment, there are several paths besides the direct path from which the signals impinge on the microphones. The mixtures of this scenario are called convolutive and the A coefficients cannot be assumed frequency independent anymore in this case.In this paper, we propose a framework for anechoic mixtures but we also apply it to the mixtures in moderate reverberant environments. We confirm the effectiveness of the model even in the presence of multipath propagation.Many methods have been developed for blind source separation. They either work based on a known channel mixing system or they try to estimate the mixing system in advance. Most of the channel mixing estimation techniques are based on time difference of arrival (TDOA) estimation in every time–frequency (TF) cell of the STFT representation of the mixture which is followed by clustering of the obtained estimates [1]. In Yilmaz and Rickard [32], Winter et al. [31], and Saab et al. [22], a clustering algorithm is used for finding the clusters around the actual mixing vectors. Besides some drawbacks associated to the spatial aliasing issue, most of these approaches suffer from an important deficiency which is the need that the number of clusters or sources be known in advance. Moreover, the assumption of strong sparsity is an essential requirement of most of these methods. It means that there should be only one dominant active source in each TF cell of the mixture STFT representation. However, the sparsity can be violated either in the presence of noise or when the sources overlap.Due to the above mentioned disadvantages, we do not opt for clustering based methods. Instead, we obtain a 2-D spectrum against the amplitude and phase differences of the two channels as described in Section 2. The peak locations of this spectrum correspond to the mixing coefficients. This way, we have relaxed the above mentioned sparsity assumption in the sense that we require a sufficient number of sparse TF cells for acquiring clear spectrum peaks corresponding to each source.Independent Component Analysis (ICA) is a well-known BSS approach. Generally, ICA assumes that source signals are independent and it involves the so-called permutation problem since ICA is applied to separate frequency cells of the STFT representation. Hence, the source orders should be determined per frequency. This issue has been considered and solved in [13,23,19,25]. But ICA is just applicable to over-determined problems where the number of sensors is at least as large as the number of the sources. Under-determined mixtures are more often separated using TF masking techniques [32,21] or classical sparse approaches such as l1-norm [6] or lp-norm [27] minimization.Recently, Non-negative Matrix Factorization (NMF) has been applied extensively to several source separation scenarios in a single channel [26,14,30,8,5] and multichannel [20,10,11,18] setting. NMF or Non-negative Tensor Factorization (NTF) is generally applied to the magnitude spectrogram domains. One of the shortcomings of these structures is that they disregard the phase information of the signal in the sense that they try to approximate the power or magnitude spectrogram of the mixture signal as a product of two non-negative matrices containing spectral components and time activations. Moreover, the number of the sources as well as components modeling each source should be known in advance.In Kameoka et al. [15], a complex NMF model is introduced defining a mixing model in the complex-spectrogram domain. This model is able to provide a sparse representation of acoustic signals in a single-channel scenario. Utilizing this framework for the source separation task, we still need to know the model order in terms of the number of the sources and the components required for modeling each source.In our present work, we have extended the method in Kameoka et al. [15] to the multichannel case. Our method differs from that of Sawada et al. [24,4] in the sense that they have proposed techniques for source separation in reverberant environment based on modeling the spatial covariance matrix. In Arberet et al. [4], the contribution of each source to the mixture channels in the time–frequency domain is modeled by a zero-mean Gaussian random vector with a full rank covariance matrix composed of two terms: a variance which represents the spectral properties of the source and which is modeled by a non-negative matrix factorization model and another full rank covariance matrix which encodes the spatial properties of the source contribution in the mixture. The extended complex NMF model in Sawada et al. [24] has been developed to factorize the covariance matrix and the spatial property is associated with each NMF basis. However our proposed method is directly applied to the complex spectrogram of the mixture signal, thus it involves less computation. The estimates of the number of the sources and channel mixing given by the previous stage are exploited as known parameters in our developed model. A primary estimate of each source complex spectrogram is obtained through binary masking. Then, the complex NMF approach proposed in Kameoka et al. [15] is applied for decomposing these spectrograms to the non-negative spectral components and time activation matrices along with a tensor containing the phase information. The obtained factors are then utilized as initial values of the parameters in our proposed multichannel complex NMF approach. We have also developed a scheme for estimating the number of components required for modeling each source. This is achieved through log-likelihood evaluation against different model order values and taking the knee point which can be found by using Bayesian Information Criterion (BIC) metric as the optimal order value.The novel aspects of our proposed approach can be summarized as follows:•We have developed a new scheme for estimating the channel mixing coefficients in the anechoic case based on a 2-D spectrum. Applying this approach, both the phase and attenuation differences between the responses of two channels are inferred for each source from the mixture complex spectrograms. Moreover, the number of the peaks emerging in the spectrum provides an estimate of the number of sources.The complex NMF model is extended and reformulated to the multichannel case for extracting the individual source signals.The optimal model order is chosen based on log-likelihood evaluation against different numbers of model components and applying the BIC metric as the order selection criterion.Several algorithms have already been proposed for channel mixing system estimation for different scenarios of instantaneous, anechoic or convolutive mixtures. The common assumption of most of them is the sparsity of the audio source signals. It means that the source representations in the TF domain do not overlap. This assumption is not necessarily valid for all mixtures. Most of the mentioned methods find the channel estimates through clustering the coefficients obtained for each TF cell. As stated in Section 1, our proposed method is not clustering based and enables us to infer the number of sources as well. In the anechoic case, not only the phase difference between the signals received from two channels should be taken into account, but also the amplitude difference due to the different attenuation of the paths should be considered in the model. While most of the far-field models disregard the difference in the received signal amplitude and just consider the phase difference, we develop a 2-D spectrum for estimating both the phase and amplitude of the channel coefficients. This would be essential especially in the case where the source distances to individual microphones differs considerably.Our goal is finding a 2-D spectrum against(Rg,θ)from which we can obtain the channel coefficients (magnitude and phase) corresponding to each source. Toward this goal, the subsequent procedures followed. First, τgis defined as(4)τg=dmsin(θ)Cswhere dmis the distance between the microphones. θ denotes the angle of arrival of the signal impinging on the array w.r.t. the array broadside which is assumed uniformly aligned in the interval[−π/2π/2]. In fact, τgdetermines the TDOA between the received signals of the two channels. Rgis used for inferring the ratio of the absolute values of the channel coefficients. We assign uniformly aligned values between [0 1] to Rg. Subsequently, a complex valued functionAgcan be defined as below:(5)Ag(Rg,τg,f)=Rgexp(i2πτgf)We can also define a corresponding metric A21 as(6)A21(f,t)=cos(atan(|X2ft||X1ft|)).exp(i(∠X2ft−∠X1ft))which specifies the phase difference as well as the ratio of the magnitudes of the two channels. A21 is defined to be located inside the unit circle such that it is comparable with the Agparameter.Xift, i = 1, 2 denotes the complex valued STFT coefficients of channel i in the frequency bin f and time frame t.The following cost function is then evaluated in each TF cell to give us an estimate of the actual amplitude and phase characteristics of the mixing system:(7)M(Rg,θ,f,t)=|Ag−A21|2For increasing the resolution, a monotonically decreasing non-linear function in the range[0,1]is applied to the M metric inspired from Loesch and Yang [17] which leads to sharper peaks in the derived spectrum:(8)P(Rg,θ,f,t)=1−tanh(αM(Rg,θ,f,t))where α indicates the non-linearity parameter. The 2-D spectrum is then derived by taking summation over all frequency bins and maximization over all time frames:(9)Γ(Rg,θ)=maxt∑fP(Rg,θ,f,t)Consequently, the phase and amplitude difference measures of two channels can be obtained through finding the peak locations of this 2-D spectrum. Two constraints are applied to the peak finder algorithm. First, the minimum peak distances in terms of angle of arrival(θ)should not exceed 5°. The second constraint is imposed on minimum peak height which should not be smaller than half of the maximum peak value in the spectrum. This way, we have also achieved an estimate of the number of sources in the mixture signal according to their diverse positions which lead to separate peaks emerging in the spectrum. Notice that the peak heights are not proportional to the source signal strengths but to the number of time–frequency cells in which a source is dominant. This can be seen from (9): the derived 2-D spectrum is computed as the sum over all frequencies of values between 0 and 1, measuring agreement of data and hypothesis, and this at the time t where the source can produce the best match. This motivates our choice of threshold for the minimal peak height; implying sources should at some point in time be dominant in at least half the number of cells compared to the most dominant source. The minimal angular distance between peaks is set based on the practical consideration that sources are spatially distributed.The inferred peak values of the 2-D spectrum will provide us with the correspondingθjand Rgjassociated to the jth source. Subsequently, we can express the estimated channel mixing coefficients with the following form taking the first channel as the reference:(10)Aestj(f)=[1tan(acos(Rgj))·exp(i2πτgjf)]T,j=1…J,τgj=dmCssin(θj)where J indicates the total estimated number of sources.A sufficient degree of sparseness is required for our approach to lead to the sharp peaks corresponding to the true channel coefficients. This means that there should be a sufficient number of TF cells with one dominant source in the mixture STFT.Primary estimates of the individual source spectrograms are obtained through binary masking as explained in Section 3.1. Then, the factors of this primary source spectrograms are obtained using the complex NMF scheme proposed in Kameoka et al. [15]. These factors are then exploited as initial values in our proposed multichannel complex framework to extract the source signals. This framework is described in Section 3.2.For constructing binary masks, the estimated channel characteristics from Section 2 are exploited in this stage. The active source in each TF cell is decided based on the inferred channel coefficients in the previous stage. The mixture STFT coefficientsXftare projected onto the subspace spanned by each mixing vectorAestj(f)and the source j⁎ whose projection has largest l2-norm is recognized as the active source. The contribution of this source in the given TF cell is taken equal to the channel 1 coefficient,Sj⁎ftbm=X1ftand that of the other sources is set to zero.Then, the framework proposed in Kameoka et al. [15] is applied to each source complex spectrogram to extract the recurrent patterns of magnitude spectra and the phase estimates of the constituent components. In contrast to Kameoka et al. [15], the number of components for modeling each source is not taken predefined and is inferred through applying the BIC order selection metric to log-likelihood values calculated against a different number of components. This is discussed more explicitly in Section 4. Furthermore, we do not assume a sparse prior for time activations in the model because it might not fit to the actual behavior of the parameters.The following generative model is assumed for the estimated source spectrogram coefficientsSj⁎ftbm:(11)Sjftbm=∑k∈KjWfkbmHktbmeiϕkftbm+nftwhere Kjis the set of indices corresponding to the components used for modeling the jth source. In this model, the columns of theWbmmatrix denote the magnitude spectral components and the rows of theHbmmatrix represent the time-varying activation coefficients of these components.Φbmaccounts for the time-varying phase spectrum of the components. nftis assumed to be complex Gaussian white noise with mean 0 and variance σ2. The update algorithm presented in Kameoka et al. [15] can be used for obtaining the set of unknown parametersZbm={Wbm,Hbm,Φbm}through maximizing the likelihood function without imposing sparsity to theHbmelements.The total number of components,|Kj|, required for modeling source j can be inferred via evaluating the likelihood against different order values and choosing the optimal model order using the BIC metric. The factors obtained from binary masked source estimates are utilized in the next stage as initial values of the parameters.We propose to extend the above complex factorization model to the stereo case as follows. The mixture signal is assumed to follow a similar generative model:(12)Xft=∑k=1KWfkHkteiϕkftAestpk+nftpk=j∀k∈Kj,j=1…Jwhere K represents the total number of components (K=∑j|Kj|). For later use, we define the vectorsYftsuch thatYft=∑k=1KWfkHkteiϕkftAestpk. The idea behind this framework is that the same model components be assumed for both channels. The estimated channel coefficients account for the phase and attenuation difference between channels for individual sources.nftis the vector representing the reconstruction error on two channels and is presumed with zero-mean Gaussian distribution for both channels independent from each other. Hence, the likelihood of the parametersZ={W,H,Φ}is obtained as below:(13)p(Xft|Z)=∏i,f,t1πσ2exp(−|Xift−Yift|σ2)An iterative algorithm for maximizing the likelihood function is now developed. The derivation steps can be found in Appendix A. The update relations are obtained as follows:(14)Wfk=∑i,tHktβkftRe[X¯ikft⁎eiϕkftAest,ipk]∑i,tHkt2|Aest,ipk|2βkft,Wfk←Wfk∑fWfk(15)Hkt=∑i,fWfkβkftRe[X¯ikft⁎eiϕkftAest,ipk]∑i,fWfk2|Aest,ipk|2βkft(16)sin(ϕkft)=Q1kftQ1kft2+Q2kft2cos(ϕkft)=Q2kftQ1kft2+Q2kft2where the parameters βkft,X¯ikft,Q1kftandQ2kftare defined in Appendix A.The βkftparameter is set toβkft=WfkHkt/∑kWfkHktat each iteration.To avoid scaling ambiguity, the columns of W are normalized. The iterative algorithm steps are executed in the following order:(1)The initial values of the set of parametersZare set to those obtained via factorizing the primary source estimatesZbm.X¯is updated according to (A.5) in the appendix.The parametersZ={W,H,Φ}are updated according to Eqs. (14)–(16).βis updated.The complex spectrogram of the individual sources is ultimately reconstructed according to the following expression:(17)Sjft=∑k∈KjWfkHkteiϕkftThe time-domain source signals can easily be derived by applying inverse STFT operation to (17).

@&#CONCLUSIONS@&#
