@&#MAIN-TITLE@&#
Construction of a new BRB based model for time series forecasting

@&#HIGHLIGHTS@&#
A new BRB based forecasting model that can use the hybrid information is proposed.A model selection criterion is defined to determine the delay step of the BRB based forecasting model.An optimal algorithm for training the parameters of the forecasting model is further developed.A case study is examined to demonstrate the ability of the newly proposed forecasting model.

@&#KEYPHRASES@&#
Model selection,Belief rule base,Time series forecasting,Bayesian reasoning,Akaike's information criterion,

@&#ABSTRACT@&#
It is important to predict the future behavior of complex systems. Currently there are no effective methods to solve time series forecasting problem by using the quantitative and qualitative information. Therefore, based on belief rule base (BRB), this paper focuses on developing a new model that can deal with the problem. Although it is difficult to obtain accurately and completely quantitative information, some qualitative information can be collected and represented by a BRB. As such, a new BRB based forecasting model is proposed when the quantitative and qualitative information exist simultaneously. The performance of the proposed model depends on the structure and belief degrees of BRB simultaneously. Moreover, the structure is determined by the delay step. In order to obtain the appropriate delay step using the available information, a model selection criterion is defined according to Akaike's information criterion (AIC). Based on the proposed model selection criterion and the optimal algorithm for training the belief degrees, an algorithm for constructing the BRB based forecasting model is developed. Experimental results show that the constructed BRB based forecasting model can not only predict the time series accurately, but also has the appropriate structure.

@&#INTRODUCTION@&#
It is important to predict the future behavior of complex systems. For example, in nuclear power station and missile control loop, it is necessary that system behavior patterns that may lead to the faults can be predicted and avoided before they occur [1]. In order to predict the system behavior, methods for time series forecasting have received more and more attention.For predicting the linear and stationary time series, the autoregressive (AR) model and autoregressive moving average (ARMA) model were proposed [2,3]. However, most of time series are non-linear and non-stationary in engineering. In order to predict this type of time series, some methods were developed. For example, the autoregressive integrated moving average (ARIMA) model was employed to forecast the reliability and health condition of machine [4–6]. The gray method was used to predict the performance of air cooled water chillers [7]. The neural network was also adopted to predict the time series, respectively [8–10]. Moreover, some hybrid methods were employed in the time series forecasting. For example, the hybrid method based on the gray theory and ARMA model was used to predict the gyro drift [11]. The hybrid method based on fuzzy theory and neural network (i.e. fuzzy neural network) was used to solve the time series forecasting problem [12–14].The above forecasting methods mainly use the quantitative (numerical) information, but cannot incorporate the qualitative (judgmental) information. To handle the quantitative and qualitative information with uncertainty in complex system modeling [15,16], a generic rule-base inference methodology using the evidential reasoning (RIMER) approach was proposed to establish a nonlinear relationship between antecedent attributes (or inputs of the system to be modeled) and an associated consequent (or output) [17–20]. In RIMER, a rule base, which is designed on the basis of a belief structure, is called belief rule base (BRB). As such, a new BRB based forecasting model is proposed in order to use the quantitative and qualitative information to predict the system behavior in this paper. The performance of the proposed BRB based forecasting model depends on its structure and parameters at the same time. Moreover, the structure of BRB is determined by the delay step of the forecasting model. In order to determine the delay step, a model selection criterion is developed on the basis of Akaike's information criterion (AIC) [21]. Furthermore, combining the model selection criterion with the optimal model for training the parameters of BRB which was proposed by Yang et al. [22], an algorithm for constructing the BRB based forecasting model is proposed. Using the proposed algorithm, the constructed BRB based model can not only predict the time series accurately, but also has the appropriate structure.This paper is organized as follows. In Section 2, the problem of time series forecasting is formulated on the basis of BRB. Section 3 proposes an algorithm for constructing the BRB based forecasting model. An experimental case study for leak forecasting is presented to verify the proposed algorithm in Section 4. The paper is concluded in Section 5.Given data{xi}i=1t−1, a one-step time series forecasting problem amounts to predicting future time series value xt. In this paper, x mainly denotes a variable that is chosen to reflect the system behavior. Let x(t−1)≜[x(t−1), …, x(t−τ)]Tand τ denotes the delay step. The model for solving time series problem can be represented as follows.(1)xˆ(t)=g(x(t−1),…,x(t−τ),V)=g(x(t−1),V)wherexˆ(t)denotes the estimated value of x at time instant t. g denotes a nonlinear function that reflect the relationship between past and future data. V denotes a vector that is composed of the parameters of the forecasting model.In the above model for forecasting the time series as given in Eq. (1), the inputs are the past observations of the data series and the output is the future value after one step. In order to establish the forecasting model, the following three problems should be solved:1)Choose the appropriate model.Determine the delay step τ.Determine the parameter vector V.The first two problems belong to structure identification of the forecasting model. The third is mainly to identify the model parameters. In general, the performance of a forecasting model is determined by its structure and parameters simultaneously.However, for some complex systems, it is difficult to obtain complete and accurate data beforehand to construct and train the forecasting model. For example, the gyro that is an important unit in the navigation system can provide the location information. But the price of the gyro is high and the useful life is short, so it is difficult to obtain a lot of complete and accurate testing data that can reflect the running state of the gyro. Fortunately, some knowledge in qualitative forms and partial historical information about the system behaviors, may be given by the experts. These knowledge and information can be converted into belief rules [17]. In order to establish the forecasting model of the variable x, a belief rule base (BRB) consisting of a collection of belief rules is defined as follows:(2)Rk:Ifx(t−1)isA1k∧x(t−2)isA2k∧⋯∧x(t−τ)isAτkthenx(t)is{(D1,β1,k),…,(DN,βN,k)}where Rkdenotes the kth belief rule. x(t−m) is the mth antecedent attribute and m=1,…,τ. τ denotes the delay step.Amk(k=1,…,L)is the referential value of the mth antecedent attribute in the kth rule andAmk∈D. D={D1, …, DN} is a set of referential values for the mth antecedent attribute. βj,k(j=1, …, N, k=1, …, L) is the belief degree assessed to Djwhich denotes the jth consequent and Dj∈D. Note that “∧” is a logical connective to represent the “AND” relationship.Let V denote the parameter vector of the newly proposed BRB based forecasting model and there is V=[β1,1, …, βN,1, …, β1,L, …, βN,L]T. It is noted that every antecedent attribute has N referential values and there are τ antecedent attributes in BRB, so the number of belief rule L is calculated by L=Nτ. Moreover, there are N belief degrees in every belief rule, so the number of belief degree in the whole BRB based forecasting model is(3)n=N×L=Nτ+1where n denotes the number of belief degree. Eq. (3) shows that the number of belief degree n is determined by the delay step τ.The above BRB based forecasting model is composed of a series of belief rule (2). From above analysis, it can be seen that BRB is an appropriate model to establish the forecasting model that can use the quantitative and qualitative information. Thus, the first problem to choose the appropriate model is solved. Therefore, the other two problems that determine the delay step τ and the parameter vector V will be mainly considered in the following sections. But there may exist two problems:1)The delay step τ should be determined firstly. In engineering, τ is often given in advance. But the performance of the forecasting model may not be well if τ is chosen irrelevantly.If τ is given, according to Eq. (3), the number of belief degree can also be obtained. In engineering, the values of βj,k(j=1, …, N, k=1, …, L) are given by experts and are usually inaccurate.Therefore, the objective of this paper is to choose the optimal belief degrees and the appropriate delay step τ according to the available information. In the following section, an algorithm for constructing the BRB based forecasting model will be developed further.From above analysis, the proposed BRB based forecasting model consists of a series of belief rules as shown in (2). In order to combine belief rules to generate the final output, the evidential reasoning (ER) approach that was proposed by Yang et al. [17] can be applied. However, the ER approach is a complex nonlinear mapping between the inputs and outputs of a system. Therefore, the calculated speed of the ER based algorithm for training the BRB parameters is slow, which cannot satisfy the real-time requirement in engineering. Compared with the ER approach, the Bayesian reasoning approach that is linear in nature is simpler. As such, under some assumptions as given in [23,24], the Bayesian reasoning approach was used as the inference tool. Furthermore, the Bayesian reasoning based recursive algorithm for online updating the BRB parameters was developed [24]. In this paper, the structure and parameters of the forecasting model need to be estimated at the same time, so the Bayesian reasoning approach is chosen as the inference tool to generate the output of forecasting model in order to decrease the calculation complexity.In Eq. (2), it is assumed that the linguistic set D is mutually exclusive and collectively exhaustive [25,26]. Moreover, the belief degrees satisfy the following equality and inequality constraints:(4)∑j=1Nβj,k=1(5)0≤βj,k≤1where j=1,…,N, k=1,…,L.Therefore, the belief degrees can be treated as the conventional probabilities. Thus, the belief rule in Eq. (2) can be further expressed in the form of conditional probability as follows [23,24,27,28]:(6)GivenA1k∧⋯∧Aτk,thenp(D1)isβ1,k,…,p(DN)isβN,kwhere there areAmk∈D, D={D1, …, DN} and k=1, …, L. p(·) denotes the probability.Eq. (6) can also be written as the following conditional probability.(7)p(Ds|A1k,…,Aτk)=βs,k,s=1,…,NBased on the probability expression of a belief rule, the Bayesian reasoning approach can be used to combine rules and generate final conclusions, i.e. the marginal probabilities of Ds(s=1, …, N) which can be calculated as(8)p(Ds)=∑k=1Lp(Ds|A1k,…,Aτk)∏m=1τp(Amk)Remark 1In Eq. (8), the prior probabilityp(Amk)(m=1,…,M,k=1,…,L)is needed. In the probability based methods, it is very difficult to decide these probabilities [27,29–31]. In this paper, it is assumed that the linguistic set D={D1, …, DN} is mutually exclusive and collectively exhaustive, so the prior probabilityp(Amk)is equal to the belief degree to the referential valueAmkfrom Eq. (6), whereAmk∈D. Here the belief degree, i.e.p(Amk), can be calculated using the rule based information transformation technique when the antecedent attributes are available [32]. Thus,p(Amk)can be obtained. Xu et al. has given the detail example about how to calculate the belief degree [33].As mentioned in Section 2, there are Nτ+1 belief degrees that need to be determined when the delay step τ is given. These belief degrees can be trained according to the principle as proposed in Fig. 1[22].In Fig. 1, it is desirable that ξ(V) is as small as possible. The optimal learning process can be represented as the following nonlinear objective function:(9)minξ(V)s.t.∑j=1Nβj,k=1,0≤βj,k≤1,k=1,…,Lwhereξ(V)=(1/T−τ)∑t=τ+1T(x(t)−xˆ(t))2is the total mean squared error.xˆ(t)denotes the forecasting value generated by the BRB based forecasting model as shown in Eq. (1) according to the information from time instant (t−τ) to (t−1).Eq. (9) is therefore an Nτ+1 variable and (L+1)×N constraint continuous nonlinear optimization problem, can be solved using existing optimization software package, such as the Matlab Optimization Toolbox [18].As mentioned in Section 2, the performance of the proposed BRB based forecasting model is determined by the parameter vector V and the delay step τ at the same time. Therefore, it is necessary to consider the influence of τ in the objective function (9).The objective function in (9) measures the fitting accuracy of the BRB based forecasting model to the data. Moreover, it is necessary to set a penalty for model over-fitting [21]. Therefore, similar to [21], the following nonlinear objective function is adopted on basis of Akaike's information criterion (AIC) in order to balance model fitting and model parsimony.(10)minAIC(τ)s.t.τ=1,2,...where AIC(τ)=lnξ(V)+(2n/T−τ). ξ(V) is the total mean squared error. T denotes the number of testing data. n denotes the number of parameters in the BRB based forecasting model.The objective function as shown in (10) can also be seen as a model selection criterion. According to Eq. (3), Eq. (9) can be written as follows:(11)AIC(τ)=lnξ(V)+2Nτ+1T−τHere the delay step τ is a positive integer, i.e. τ∈{1, 2, …}. When τ is given, the belief degrees can be determined by solving the nonlinear objective function (9) firstly. Then AIC(τ) can be calculated. When AIC(τ)<AICnormal, the optimal structure of forecasting model is obtained, where AICnormal denotes a given threshold. It is noted however the threshold AICnormal is chosen for the following reason:Because the delay step τ is discrete and the elements of V are continuous, minimizing the objective function (10) is equal to solve an optimal problem with discrete and continuous variables in nature. Although the objective function (10) may be minimized by using the dedicated optimal algorithm, the optimal value of τ may be large and the structure of the proposed BRB based forecasting model will be complex. In order to solve the problems, a threshold AICnormal is chosen. When AIC(τ)<AICnormal, it can ensure that τ is appropriate and the forecasting precision of trained BRB based model can satisfy the given requirements. Therefore, the threshold AICnormal should be chosen according to the requirements of forecasting precision in engineering and the model complexity.Remark 2Because the model fitting and model parsimony are considered in the model selection criterion as shown in (10) simultaneously, the constructed BRB based forecasting model can not only predict the time series accurately, but also has the appropriate delay step, which ensures that the structure of the proposed BRB based forecasting model is not too complex.In [34], the comparative studies between AIC and some modified formulas such as AICC and AICU were presented. Apart from AIC as shown in Eq. (11), the modified formulas of AIC as proposed in [34] can also be adopted according to the special requirements. For example, when the ratio between the number of parameters and sample sizes is below 40, i.e. Nτ+1/(T−τ)<40, the AICC that is represented asAICC=AIC+2Nτ+1(Nτ+1+1)T−τ−Nτ+1−1can be chosen.As a result of the discussion in the previous subsection, the procedure of the algorithm for construction the BRB based forecasting model may be summarized as follows:Step 1. Let the delay step to be τ=1. According to Eq. (3), the number of belief degree can be determined. Assign initial values to Nτ+1 belief degrees β1,1, …, βN,L.Step 2. Since the testing data are available, the nonlinear programming problem as given in (9) can be constructed and solved to obtain the optimal estimations of β1,1, …, βN,L.Step 3. According to Eq. (11), AIC(τ) can be calculated. When the objective function in (10) is minimized, i.e. AIC(τ)<AICnormal, the optimal value of τ can be obtained. Then the optimal structure of forecasting model can be determined, and go to 4. Otherwise, Let τ=τ+1 and go to Step 1.Step 4. When the structure of forecasting model is determined, the Bayesian reasoning based recursive algorithm for online updating the parameters of forecasting model proposed in [24] can be used directly when the new observations are available.From above analysis, it can be concluded that the main contributions of this paper are as follows:1)In order to use the quantitative and qualitative information, a new BRB based forecasting model is proposed.In order to identify the structure and parameters of the BRB based forecasting model, an algorithm is developed to balance model fitting and model parsimony.A numerical example is studied in this Section to show the implementation and the effectiveness of the proposed method for constructing the BRB based forecasting model. Furthermore, in order to demonstrate the potential application of the proposed BRB based forecasting model in engineering, we apply the scheme to build a model for forecasting leak size from an oil pipeline using data taken from an operational long distance oil pipeline installed in Great Britain.It is noted however, MATLAB is chosen as the software used for calculations in this Section. By using MATLAB, the following works are mainly completed: (1) training the BRB based model, (2) testing the trained BRB based model, (3) calculating the error, and (4) the comparative studies.Here we choose to analyze the continuous stirred tank reactor (CSTR) to demonstrate the implementation and validity of the proposed method for constructing the BRB based model. The discrete-time CSTR model with two outputs (reactant concentration CAand reactant temperature T) and one input is given by(12)x(t+1)=x(t)+Δt⋅g(x(t),u(t))+w(t)y(t+1)=x(t+1)+v(t+1)with x(t+1)=[CA(t+1), T(t+1)]T, u(t)=Tc, y(t+1)=[y1(t+1), y2(t+1)]Tand(13)g(x(t),u(t))qV(CAf−x1(t))−k0exp−ERx2(t)x1(t)qV(Tf−x2(t))+−ΔHρCpk0exp−ERx2(t)x1(t)+UAVρCp(u(t)−x2(t))where the parameters are shown in Table 1.The control objective of the system is to track the reactant concentration setting pointx1d(t)=0.2. For simplicity, a numerical PID controller is used. The controller is in a recursive form as(14)u(t)=u(t−1)+A0ε(t)−A1ε(t−1)+A2ε(t−2)(15)ε(t)=xˆ1(t|t)−x1d(t)(16)A0=Kp1+dtTi+Tddt,A1=Kp1+2Tddt,A2=KpTddtwhere Kp=100, Ti=0.4, Td=0.1 and u(0)=419.Here the sampling interval is chosen as dt=0.2 min, the initial states are x1(0)=0.22 mol/L and x2(0)=447 K, w(t) is Gaussian noise with covariance matrix0.062000.052and v(t+1) is Gaussian noise with covariance matrix0.0012000.052.It is assumed that the fed-in flow rate of the reactant q changes as follows:(17)q(t)=100,t≤40100−(t−40)×0.4,40<t≤74q(74)−(t−74)×0.9,t>74Fig. 2shows the simulated data of reactant temperature T when q changes according to Eq. (17). Here the simulated data of T is a non-stationary time series in nature. In order to demonstrate the validity of the proposed method, based on the simulated data of reactant temperature, one part of the data will be used to construct the BRB based forecasting model, and another part to test the forecasting model. Moreover, the first 85 and the last 15 temperature data are used as the training and testing data, respectively.In order to construct BRB, for the reactant temperature T, three referential points which include low (L), medium (M) and high (H) are used, i.e.(18)D=(D1,D2,D3)=(L,M,H)The referential points defined above for T are in linguistic terms and need to be quantified. The quantified results are given in Table 2.From Eq. (2), the kth belief rule of BRB used for forecasting T can be constructed as follows:(19)Rk:IfT(t−1)isA1k∧T(t−2)isA2k∧⋯∧T(t−τ)isAτkthenT(t)is{(D1,β1,k),(D2,β2,k)(D3,β3,k)}In order to determine the delay step τ, the training data and the proposed algorithm are used to train BRB. Table 3gives the value of AIC under different delay step. It is obvious that when τ=2, AIC(τ) is minimized and there is AIC(τ)=3.4018. Thus, the structure of BRB can be determined and there are 9 belief rules in BRB. When τ=2, the initial belief degrees of BRB are listed in Table 4. Moreover, the trained belief degrees of the constructed BRB are given as Table 5.Fig. 3gives the training data and the forecasting values generated by the constructed forecasting model when τ=2. From Fig. 3, it can be seen that the constructed BRB based model can forecast the training data of reactant temperature accurately.In order to examine the forecasting ability of the constructed BRB based model, the testing data is used. Fig. 4gives the testing data and the forecasting values when τ=2. Fig. 5gives the absolute error (AE) between the testing data and the forecasting values. Moreover, the mean square error (MSE) between the testing data and the forecasting values is calculated and the MSE is 0.8790.From Figs. 4 and 5 and the calculated MSE, it can be concluded that the BRB based model constructed by the proposed algorithm can forecast the reactant temperature accurately. Because the delay step is small and there are 9 belief rules in BRB, the structure of the BRB based model constructed by the proposed algorithm is appropriate and not too complex.When a leak develops in a pipeline, the leak rate that is denoted by LeakSize is used as the leak data. In the leak trial, 326 sample leak data were collected at the rate of 10s per sample from no leak to 25% leak. Note that 25% leak denotes that if there is 100kg oil in the pipeline, the leak will be 25kg oil. Fig. 6shows the curve for LeakSize when the leak changes from 0 to 25% [33]. The leak data is the non-linear and non-stationary time series in nature.In order to verify the proposed model and algorithm, based on the collected leak data, one part of the leak data will be used to construct the BRB based forecasting model, and another part to test the forecasting model. Moreover, the first 300 and the last 27 leak data are used as the training and testing data, respectively. In this case study, the calculating results generated by MATLAB are plotted by using the EXCEL software.In order to construct BRB, for LeakSize, three referential points which include zero (Z), medium (M) and high (H) are used, i.e.(20)D=(D1,D2,D3)=(Z,M,H)The referential points defined above for LeakSize are in linguistic terms and need to be quantified. The quantified results are given in Table 6.From Eq. (2), the BRB used for forecasting LeakSize can be constructed as follows:(21)Rk:IfLeakSize(t−1)isA1k∧LeakSize(t−2)isA2k∧⋯∧LeakSize(t−τ)isAτkthenLeakSize(t)is{(D1,β1,k),…,(D3,β3,k)}In order to determine the delay step τ, the training data and the proposed algorithm are used to train BRB. Table 7gives the value of AIC under different delay step. It is obvious that when τ=2, AIC(τ) is minimized and there is AIC(τ)=−7.7149. Thus, the structure of BRB can be determined and there are 9 belief rules in BRB. When τ=2, the initial belief degrees of BRB are listed in Table 8. Moreover, the trained belief degrees of the constructed BRB are given as Table 9.Fig. 7gives the training data and the forecasting values generated by the constructed forecasting model under the different delay step. Table 10gives the mean squared error (MSE) between training data and forecasting values under different delay step. From Fig. 7 and Table 10, it can be seen that the MSE is minimal when τ=2.In order to examine the forecasting ability of the constructed BRB based model, the testing data is used. Fig. 8gives the testing data and the forecasting values under different delay step. Fig. 9gives the absolute error (AE) between the testing data and the forecasting values under different delay step. Table 11lists the MSE between the testing data and the forecasting values under different delay step.From Figs. 7–9 and Tables 10 and 11, it can be concluded that compared with the constructed BRB based forecasting models under other delay step, the model is more desirable when τ=2. Because the delay step is small, the structure of the BRB based model constructed by the proposed algorithm is appropriate and not too complex.In fact, the current methods for nonlinear time series forecasting can mainly be divided into two types: time series analysis method and intelligent method. In this Section, the autoregressive integrated moving average (ARIMA) model that is a typical time series analysis method and two intelligent methods that includes BP neural network and fuzzy neural network (FNN) are used to establish the forecasting model of the leak in order to validate the proposed BRB based model.In the subsection, the ARIMA model is firstly adopted to predict the leak and the following three steps are included.1)The AIC and the training data are adopted to determine the order of ARIMA model. When the AIC value is minimized, the order of ARIMA model is 2.Based on the training data, the parameters of ARIMA model are trained by using the least square (LS) method. Fig. 10gives the training data and the forecasting values. It can be seen that the ARIMA model can be used to establish the forecasting model of the leak data.The constructed ARIMA model is used to predict the leak size. Fig. 11gives the testing data and the forecasting values. The MSE between the testing data and the forecasting values is 1.0532. Compared with Table 11, it can be seen that the MSE generated by the ARIMA model is greater than one produced by the BRB based model.In this subsection, two intelligent methods that include three-layer BP and FNN are adopted further to establish the forecasting model of leak and the following two steps are included.1)Based on the training data, the parameters in BP and FNN are trained. Fig. 12gives the training data and the forecasting values generated by the trained BRB based model, BP and FNN. It can be seen that BP and FNN can also be used to establish the forecasting model of the leak data.The trained BP and FNN are used to predict the leak size, respectively. Fig. 13gives the testing data and the forecasting values. The MSE between the testing data and the forecasting values generated by BP is 0.0624. Moreover, the MSE between the testing data and the forecasting values generated by FNN is 0.0384. Compared with Table 11, it can be seen that the MSEs generated by the intelligent methods are also greater than the MSE produced by the BRB based model.From above analysis, it can be concluded that the constructed BRB based model, the ARIMA model, BP, and FNN can all be used to establish the forecasting model of leak data, but the forecasting precision of BRB based model is highest. The reasons may be as follows:1)The last three models are in essence the black-box modeling approaches and their internal structures do not allow the explicit representation of subjective expert knowledge. Therefore, the last three models can be appropriate when the quantitative information is sufficient.When a lot of quantitative information is not available, the expert knowledge can capture the change trend of the leak data and the expert knowledge is used reasonably when the BRB based forecasting model is constructed. In other words, the quantitative and qualitative information can be used synthetically and simultaneously in the newly proposed BRB forecasting model, which is also a main contribution of this paper.

@&#CONCLUSIONS@&#
