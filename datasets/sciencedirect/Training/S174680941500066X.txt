@&#MAIN-TITLE@&#
Automated detection of the onset and systolic peak in the pulse wave using Hilbert transform

@&#HIGHLIGHTS@&#
Hilbert transform method can be used for detecting both the onset and systolic peak in pulse wave signals.It achieves good performance and precision when compared to expert annotation.It is robust when noise and interference are present in pulse wave and also.Shows a low detection error rate.It is computationally simple.

@&#KEYPHRASES@&#
Onset,Systolic peak,Photoplethysmography,Hilbert transform,

@&#ABSTRACT@&#
Pulse transit time (PTT) and pulse wave velocity (PWV) are the markers most widely used to evaluate the vascular effects of aging, hypertension, arterial stiffness and atherosclerosis. To calculate these markers it is necessary to determine the location of the onset and systolic peak of the arterial pulse wave (APW). In this paper, a method employed for electrocardiography (ECG) R peak detection, with a slight modification, is applied for both the onset and systolic peak detections in APW. The method employs Shannon energy envelope (SEE) estimator, Hilbert transform (HT) and moving average (MA) filter. The minimum value and the positive zero-crossing points of the odd-symmetry function of the HT correspond to the locations of the onset and systolic peak respectively. The algorithm was evaluated using expert's annotations, with 10 records of 5min length and different signal-to-noise ratios (15, 12 and 9dB) and achieved a good performance and precision. When compared to, expert's annotation, the algorithm detected these fiducial points with average sensitivity, positive predictivity and accuracy of 100% and presented errors less than 10ms. In APW signals contaminated with noise in both cases the relative error is less than 2% respect to pulse wave periods of 800ms. The performance of algorithm was compared with both foot approximation and adaptive threshold methods and the results show that the algorithm outperforms theses reported methods with respect to manuals annotation. The results are promising, suggesting that the method provides a simple but accurate onset and systolic peak detection and can be used in the measurement of pulse transit time, pulse wave velocity and pulse rate variability.

@&#INTRODUCTION@&#
Photoplethysmography (PPG) is a simple and low-cost optical technique that can be used to detect blood volume changes in peripheral artery such as finger, toe, ear and forehead [1–5]. It has been applied in many different clinical settings, including clinical physiological monitoring, vascular assessment and autonomic function [1]. There are little differences in PPG waveform according to where it is measured, despite of all they have an onset and systolic peak points in common. The onset represents minimum blood volume changes, which corresponds to the beginning of ventricular contraction and blood ejection, and the systolic peak describes the maximum blood volume changes, which means the end of blood ejection.The onset and systolic peak detection on PPG signals is used to obtain relevant diagnostic markers such as pulse transit time (PTT) and pulse wave velocity (PWV). These parameters are indicators that enable to measure the propagation of the pulse wave in the blood system. PTT and PWV are widely used to evaluated the arterial stiffness [6,7], heart rate [8,9], blood pressure [10–14] and atherosclerosis [15]. The quality of the PPG signal depends on the location and the properties of the subject skin under measurement, including the individual skin structure, the blood oxygen saturation, blood flow rate, skin temperatures and the measuring environment [16]. The process used to detect the onset and systolic peak of PPG waveform is complicated due to these factors generate several types of additive artifact which may be contained within the PPG signals. The morphology of the pulse wave is also influenced by some physiological conditions and disease processes that in some cases can lead to not enough clarity in the determination of the onset and the systolic peak of the PPG signal.Several methods have been developed for this detection with different levels of complexity which include adaptive threshold [17], feature extraction [18], computer-based filtering [19], intersection of one and two tangent lines and derivative calculation [20]. In most cases the detection of the onset and the systolic peak of the PPG waveform are done separately, there are very few methods that are used for both detections [21,22]. These methods include derivative calculation combined with amplitude thresholds [21] and adaptive threshold derived from the envelope of the PPG signal and filtering process [22]. In some cases these methods are assisted by electrocardiographic (ECG) signal, which provides a cost increment of medical equipment and makes difficult its clinical applications in the Primary Health System. Moreover, given the technical requirements of ECG measurements (electrodes and others), the signal may not always be available in accident and catastrophe sites or battlefields, or it may be beset with electrical interferences [23].Hilbert-transform (HT) has been widely used for the detection of R peak in ECG signal [24–28]. In spite of the different morphologies of the QRS complex and different types of noise and artifacts containing ECG signals, these methods achieved an accuracy, sensitivity and positive predictive of detection greater than 98% [24]. Despite the benefits, there are not reported works about onset and systolic peak detection on PPG signals employing HT. The aims of the present work are: (i) propose a new application of the HT for automatic onset and peak detection in the PPG signal, (ii) evaluate the application with annotated records by trained observers, with others published methods [17,20] and noise robustness.The new application for the onset and systolic peak detection is based on the Shannon energy envelope estimator and a simple peak-finding logic using the HT and moving average (MA). This methodology was firstly proposed by Sabarimalai et al. [24] for the detection of R peak in ECG.The rest of this paper is organized as follows. In Section 2, the four-stage onset and systolic peak detections methodology is described in detail. We introduce here the preprocessor and the automatic onset and systolic peak finding. The Section 3 shows details about database and Section 4 describes the methodology employed for the validation of the new application of HT. The experimental results that demonstrate the effectiveness of the onset and systolic peak finding schemes are presented in Section 5. Finally, in Section 6, we conclude our study.The method for the automatic onset and systolic peak detection in pulse wave involves four stages, namely, (1) linear digital filtering, (2) Shannon energy envelope extraction, (3) onset and systolic peak finding logic, and (4) real onset and systolic peak locator. This methodology is the same that proposed by Sabarimalai et al. [24] for the ECG R peak detection but with some additions in finding logic. Eqs. (1)–(5) in this section are the same that Eqs. (1), (2), (6), (7), (9) of Ref. [24] respectively. The block diagram of the proposed onset and systolic peak detection method is shown in Fig. 1.Stage 1. Linear digital filtering. In this stage the method includes a bandpass filter, an amplitude normalization and first-order forward difference operation to remove the noise and baseline distortion in PPG signal. The digital filtering is constructed using the 4th order Chebyshev type I bandpass filter for the bandwidth of 0.5–16Hz then the first-order differentiation is calculated.The first derivative of the PPG signal (dPPG) is calculated to provide information about the slope of pulse wave. The differentiation of the filtered PPG is implemented as(1)d[n]=f[n+1]−f[n]which acts as a high-pass filter.After the band-pass filtering and differentiation, we normalize the differentiated PPG (dPPG) signal, d(n), by(2)d˜[n]=d[n]maxn=1N([d[n]])where N denotes the number of samples in PPG segment.Stage 2. Shannon energy envelope extraction. Considering that in the Ref. [24] was shown to Shannon energy leads to better detection of the R peaks, in our case, after differentiation the dPPG signal is passes through this nonlinear transformation. The main objective of transformation is to use single-sided threshold mechanism and to enhance the onset and systolic peak of the PPG signal. The Shannon energy envelope of a normalized differentiated (dPPG) signal,d˜[n], is computed applying(3)s[n]=−d˜2[n]log(d˜2[n])Then the Shannon energy envelope is filtered to smooth out the spikes and noise bursts that is implemented using a rectangular impulse response, h(k) of length M. Here, the filtering operation is performed in both the forward and reverse directions, i.e., conv(s, h)→s′→ reverse the data→s′r→conv(s′r,h)→s′′→reverse the data →y[24].This zero-phase filtering provides sharp peaks around onset and systolic peak regions and smooth out spurious spikes. The smoothness depends on the filter length L. The length of the filter is found empirically. For sampling rate of 1000 samples/s, the filter length of 155 (samples) is found in this study. Experimental results demonstrate that local maximum in a smooth Shannon energy envelope, s[n], indicate approximate locations of the systolic peaks in a PPG signal.Stage 3. Onset and systolic peak finding logic. The proposed onset and peak-finding technique is developed based on the Hilbert transformation, drift removal, zero-crossing point (ZCP) detection and minimum value (MV) detection. The HT is widely used for analyzing the instantaneous amplitude and frequency of the signal. The HT of a real signal x(t) is computed using(4)xˆ(t)=H[x(t)]=1πt×x(t)=1π∫−∞∞x(τ)t−τdτor it can be calculated according(5)xˆ(t)=IFT[(Xˆf)]where IFT denotes the inverse Fourier transform X(f) is the (Fourier transform) of the signal x(t).In Ref. [24] the authors showed that positive zero-crossing (or negative-to-positive transition) points of the odd-symmetry function correspond to locations of the peaks in the envelogram of the HT and the performance of the peak-finding logic is excellent. In our case, the method identifies accurate locations of the local maximum by detecting positive zero-crossing points in HT of the SE envelope as in Ref. [24] and identifies the local minimum by detecting minimum value in HT of the SE envelope. To remove the low frequency (LF) drift due to the large peak-amplitude variation and the baseline shift is applied a moving average (MA) filter. The LF drift is removed by subtracting the filter output of the MA filter from the original input. For our sample rate of 1000 samples/s, the MA filter length (L) is 2501 samples equivalent to 2.5s. Here we showed that the positive zero-crossing points of the odd-symmetry function and the minimum value in Hilbert-transformation correspond to locations of the systolic peak and the onset in PPG signal respectively.Stage 4. Real onset and systolic peak locator. The locations of the local minimum and maximum are used as guides to find accurate locations of the onset and systolic peak in PPG signals respectively. The location of candidate onset and systolic peak may differ slightly from the time instants of true onset and systolic peaks in an original PPG signal. To eliminate this difference, a true locator is incorporated that finds the correct time instants of the onset and systolic peak in a PPG signal by searching minimum amplitude and the largest amplitude within ±25ms of the identified location of the candidate onset and peak respectively in the previous step. Fig. 2shows the original signal and the detected onset and systolic peak using the proposed four-stage methodology.The database is composed by the signals from ten volunteers, who participated in the experimental protocol and provide informed consent in accordance with institutional policy and the basic and operational principles of the Helsinki Statement. Each subject remained in rest during five minutes in the supine position. Previously, personal and clinical data were collected from each volunteer to the test. Table 1shows the age and vital signs of the subjects. Acquisition was performed by an experimental station, which collected physiological signals of each person.Acquisition was performed by a multichannel experimental station, this station simultaneously acquires an ECG channel with bandwidth of 0.15–150Hz and two PPG channels with bandwidth of 0.5–16Hz. PPG sensors have an infrared diode (wavelength of 780nm) and photodiode for sensing the blood volume changes by reflection mode. All channels were sampled to 1000 samples/s and the experimental station was developed by Centro de Biofísica Médica and approved by their ethical committee.To assess the accuracy and precision of the algorithm, the records obtained during the experimental protocol were scored by two trained observers blind to the method. First, one expert noted the correct location of the R points on the ECG signal using software designed to view and edit (add, move and delete fiducial points) ECG signals and PPG. Then, each observer scored on PPG signal the onset and systolic peak of the pulse wave corresponding to each valid pulse rate and noted in the ECG signal. A total of 2286 annotation were made. The onset and systolic peaks annotated by the experts were considered to be the gold standard against which the onset and systolic peaks predicted by the algorithm were compared.The concordance of the notes of the observers, as well as the accuracy and precision of the new application of the HT were evaluated by analyzing the absolute error, standard deviation and the Bland–Altman method.On the other hand, the performance of the method was compared with two different automatic methods: foot approximation [20] for the onset detection and adaptive threshold [17] for the systolic peak detection. These methods are the most often used because of their good performance. Foot approximation method achieves high precision and low error rate for different noise levels [18,20] and adaptive threshold shows a sensitivity and positive predictivity over 98% [17].In order to quantify the performance of the algorithm, the sensitivity (S), positive predictivity (+P), the detection error rate (DER) and the accuracy (AC) were calculated using the following equations, respectively(6)Se=TPTP+FN×100%(7)+P=TPTP+FP×100%(8)DER=FP+FNTP×100%(9)Accuracy(Acc)=TP(TP+FP+FN)×100where (TP) is the true-positive when a onset and systolic peak is correctly detected by the algorithm, (FN) is the false-negative when a onset and systolic peak is missed, and (FP) is the false-positive when a noise spike is detected as systolic peak and motion artifact is detected as onset.Eqs. (6)–(9) in this section are the same of Eqs. (10)–(13) of Ref. [24] respectively.To validate the noise robustness, the methodology used in [20] was used. Each signal of the database was blurred for three signal-noise ratios (SNR) 15, 12 and 9dB with 30 realizations. After, the method was applied to detect onset and systolic peaks for each realization. Finally, the average error and standard deviation of detected onset and systolic peaks position of the PPG signal blurred with respect to PPG signal without noise were calculated.

@&#CONCLUSIONS@&#
