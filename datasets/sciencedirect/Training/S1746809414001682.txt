@&#MAIN-TITLE@&#
An image despeckling approach using quantum-inspired statistics in dual-tree complex wavelet domain

@&#HIGHLIGHTS@&#
We apply quantum theory on image despeckling problem.We use both inter-scale and intra-scale characteristics of wavelet coefficients.We propose a novel QSP-based thresholding function.We achieve better performance on simulated and in vivo medical ultrasound images.

@&#KEYPHRASES@&#
Ultrasound image,Despeckling,Quantum signal processing,

@&#ABSTRACT@&#
This paper presents a novel despeckling algorithm to enhance image quality of medical ultrasound images. The proposed approach exploits coefficients in the dual-tree complex wavelet transform (DTCWT) domain to develop a new quantum-inspired thresholding function. The inter-scale correlation among the coefficients of different subbands and the intra-scale variance between the coefficient and its neighborhood in the same subband are utilized to develop a new thresholding function, which is further incorporated into a Bayesian framework to perform adaptive image despeckling. Experiments are conducted using both artificially generated and real-world medical images to demonstrate that the proposed approach outperforms the conventional image despeckling approaches.

@&#INTRODUCTION@&#
Ultrasonography is one of the most important modalities of low-cost and non-invasive medical imaging system [1,2]. However, they usually suffer from speckle noise, which significantly degrades the image quality and makes it difficult to discriminate fine details of the images in diagnostic examinations.Many image despeckling algorithms have been developed in the literature to enhance the quality of medical ultrasound images; such as the Kuan filter [3], Frost filter [4], Lee filter [5], non-log transformed generalized likelihood (GenLik) ratio based wavelet-domain denoising method [6], and partial differential equation based Perona–Malik [7] method and speckle reducing anisotropic diffusion (SRAD) [8]. Although these filters perform well for removing speckle from the noisy image, they cannot preserve sharp features of the original image very well. The block-matching and 3D filtering (BM3D) method [9] is the state-of-the-art denoising method specifically designed for additive white Gaussian noise, which cannot effectively remove speckle noise from the images. Discrete wavelet transform (DWT) based approaches also have been utilized in despeckling [10]. However, it cannot provide phase information, which makes DWT less suitable for handling the medical ultrasound images [11]. Shearlet transform is also a directional representation system extending the wavelet transform and can better sparsely approximate the multivariate signals such as images [12]. Dual-tree complex wavelet transform (DTCWT) is used for the follow-up work to avoid the shortcoming introduced by DWT. In our early study, a quantum-inspired despeckling method [13] has been proposed to obtain fairly good despeckling performance. However, the method developed in [13] lacks the adaptability to determine the parameters of the statistical models for wavelet coefficients of different images.To tackle the above challenges, a new approach is proposed in this paper by exploiting a quantum-inspired thresholding function based on characteristics of wavelet coefficients. More specifically, the proposed approach exploits two statistics of the coefficients in the DTCWT domain: (i) the inter-scale correlation among the parent and child subbands; and (ii) the intra-scale variance between the coefficient and its neighborhood in each individual subband. This differs from the conventional despeckling methods that smooth the image at all pixels to the same degree.The rest of paper is organized as follows. Section 2 presents the proposed approach. Section 3 presents the experimental results using both artificially generated speckled images and real-world speckled images. Finally, Section 4 concludes this paper.In order to study the image despeckling problem, a mathematical problem formulation is presented in this paragraph. A speckled medical ultrasound imageY˜is modeled asY˜=N˜X˜, whereX˜is the ground truth andN˜is the independent speck noise random field. In the DTCWT domain, the log-transformed ultrasound image can be modeled as Y=X+N, where Y=Yr+iYi, X=Xr+iXiand N=Nr+iNiare the complex wavelet coefficients ofY˜,X˜andN˜, respectively, r and i indicate real and imaginary parts, respectively. With such formulation, the objective of image despeckling is to remove the speck noise from the observed noisy image.The Bayesian inference framework has been justified to be effective in image despeckling [10]. First, the distribution of log-transformed speckle noise is close to a Gaussian probability density function (PDF) as(1)pn(N)=12πσn2exp−Nr2+Ni22σn2in which σnis the standard deviation of the PDF. On the other hand, a non-Gaussian statistical model of the complex wavelet coefficients is used for original image wavelet coefficients as(2)px(X)=32πσ2exp−3σXr2+Xi2exp(K)where σ is the standard deviation and K is a smoothing factor which controls the degree of shrinkage. The maximum likelihood estimate of X is(3)Xˆ(y)=argmaxxpx|y(x|y)According to Bayes’ theorem, (3) can be rewritten as(4)Xˆ(y)=argmaxx[pn(y−x)px(x)]the maximum likelihood estimate of the despeckled image X can be obtained based on (1) and (2). After applying log-transformation on (4), we can obtain the estimator that makes the estimated wavelet coefficients’ derivative equals zero, which is(5)Xˆ=Yr2+Yi2−3expKσn2σ+×Y/Yr2+Yi2where the algebra operation (f)+ is defined as max(f, 0). The estimator defined in (5) is the traditional soft thresholding function, where the parameters σ and K are defined in (2), and σnis estimated as(6)σn=medianYr45°/0.6745whereYr45°denotes the magnitudes of the wavelet coefficients in 45° direction subband at the first scale.The conventional shrinking function (5) shrinks all the wavelet coefficients to the same degree. In view of this, an extra threshold ΔT, which exploits the statistics of coefficients in the DTCWT domain, is added to the traditional threshold to avoid modifying the coefficients of high frequency signal of images. The proposed estimator of X is defined as(7)Xˆ=Yr2+Yi2−3exp(K)σn2σ+ΔT+×Y/Yr2+Yi2The image despeckling problem boils down to the shrinkage function defined in (7), where the key challenge is the choice of the adaptive threshold ΔT. For that, a modified quantum-inspired shrinkage function is proposed as follows.The definition of the proposed threshold ΔT exploits both the inter-scale and intra-scale statistics of coefficients in the DTCWT domain, together with the principle of the quantum signal processing, as follows.•The first motivation of the proposed threshold ΔT relies on the inter-scale correlation among the coefficients in the DTCWT domain. The magnitudes of high frequency signal coefficients have stronger correlation than those of noise coefficients across scales. To be more specific, if a parent coefficient of signal yields large modulus, then its children are much more likely to be large too. Products of coefficients and their parents are exploited to distinguish between signal and noise in the high frequency subbands as(8)Cdir=Y1dir×Y2dirwhere dir is the orientation of the subbands,Y1dirandY2dirdenote the modulus of DTCWT coefficients at first and second scale, respectively. According to the principle of quantum signal processing [14], the state of Cdiris expressed as(9)Cdir=p00+p11where p0 and p1 are probability amplitudes of ground states0and1, andp02,p12are the measurement probability of noise state0and signal state1, respectively,p02+p12=1. p0 and p1 are defined as(10)p0=cosNCdir×π2(11)p1=sinNCdir×π2Then the matrix Cdiris normalized to obtain NCdir, which reflects the power of high frequency signal. In the quantum computing, the quantum interference is presented by the unitary transformation U of quantum gate, which is formulated as(12)Input_state=U×Output_stateIn which, quantum rotation gatecosθ−sinθsinθcosθis used as the unitary transformation U. Eq. (9) can be rewritten as(13)Cdirm,n=cosNCdir×π20+sinNCdir×π21The second motivation of the proposed threshold ΔT is determined by the intra-scale variance of the coefficient and its neighborhood. This is also inspired by the principle of quantum signal processing. According to observer effect in quantum mechanics, the measurement (statistics of the coefficients studied in the DTCWT domain) of the system (noisy image) affects the end state of the system (the denoised image). If the system measurement (the observed noisy coefficient in the image) is less similar to the environment (neighboring coefficients in the DTCWT domain), the observer is more conscious (a stronger shrinkage of the wavelet coefficients needs to be imposed). Motivated by this, the entropy and coefficients of variation of the wavelet coefficients are used to determine the degree of the shrinkage in the proposed approach.To summarize, based on the aforementioned motivations, the proposed adaptive threshold in (7), which exploits both the inter-scale correlation and the intra-scale variance among the DTCWT coefficients, is defined as(14)ΔT=cos2NCdir×π2×e1dir−e2dir×ncv×numdirThe first two terms of (14) exploit the inter-scale statistics in the DTCWT domain, and the first one is derived from the inter-scale DTCWT statistics using (13), the e1 and e2 are the entropy for DTCWT coefficients modulus at first and second scale in corresponding orientation, respectively. They are defined as(15)er=∑i=0255pr,ilogpr,iwhere pr,iis the probability of the appearance of gray level i in the rth scale of DTCWT decomposition. The last two terms of (14) exploit the intra-scale statistics in the DTCWT domain as follows.cvm,n=μ(w)/(σ(w))and w is a sub-window (with a size of 11×11) in the observed noisy image centered at (m, n),ncvrefers to the normalized matrix of the variation coefficientcv, num is the roughly estimated number of speckled pixels as(16)num=count(NCdir<[median(NCdir)/2.22])/nallwhere nallis the total number of coefficients in the NCdir.Furthermore, the other challenge of the proposed shrinkage function (6) is the estimation of the parameters σ and K. Optimized parameters can define a PDF curve of despeckled image wavelet coefficients approximate to the original one. For that, the least square method is used to estimate these two parameters iteratively as follows. First, the initial estimation of the parameters is obtained asσ=3/(2πPmax), where Pmaxis the maximum of the real parts of the second scale DTCWT coefficients PDF, and K is empirically between 1 and 4. Then the parameters σ and K are refined iteratively as(17)σ(t+1)=σ(t)+Δσ(18)K(t+1)=K(t)+ΔKwhere t is an iteration number. The parameters σ and K are estimated using the wavelet coefficients in 45° direction subband at the second scale. The increments Δσ and ΔK are both set to be 0.01. The iteration is terminated at an experimentally selected iteration number 500.The proposed image despeckling approach is summarized as follows:(1)Conduct a log-transformation followed using a DTCWT transform on the observed speckled ultrasound image.Calculate the noise variance σnusing (6).Perform shrinking function on the complex wavelet coefficients using the proposed quantum-inspired adaptive threshold function (7).(a)Estimate σ, K using the least square curve fitting method.Compute ΔT using (14).Update each wavelet coefficient using (7).Apply inverse DTCWT and an exponential transformation on the estimated coefficients to obtain the despeckled image.Experiments are conducted to evaluate the performance of the proposed approach using both artificially generated speckled image and the real-world speckled image. The proposed approach is compared with six conventional approaches [3,6,9,11,13,15].The first experiment is conducted using artificially generated speckled images. The objective image quality performance is evaluated using two criterions: (i) signal to noise ratio (SNR) and (ii) edge preservation measure [10]. The edge preservation measure is defined as(19)β=ΓΔF−ΔF¯,ΔFˆ−ΔFˆ¯Γ(ΔF−ΔF¯,ΔF−ΔF¯)⋅Γ(ΔFˆ−ΔFˆ¯,ΔFˆ−ΔFˆ¯)whereΓ(F1,F2)=∑i=1KF1⋅F2, F,Fˆrepresent original and despeckled image, respectively, and ΔF,ΔFˆrepresent the high-pass filtered versions of F,Fˆ, respectively, obtained with a 3×3 pixel standard approximation of the Laplacian operator. Larger SNR and larger edge preservation measure indicts better speckle suppression and details preservation performance. The speckle simulation software is obtained from http://telin.ugent.be/∼sanja/. Fig. 1compares the visual quality of the experiments on standard boat image contaminated by simulation speckle (sigma=0.9). Fig. 2presents the objective performance evaluation. Four ground truth images are used to artificially generate speckled noisy images with different noise standard deviations, which vary from 0.1 to 1 with a step of 0.1. As seen in these figures, the proposed approach achieves better visual quality to obtain better performance on the images with higher degrees of speckle. Especially on the images that have more edge details like Boat and Crowd image, the proposed method achieves the largest SNR and best edge preservation performance.The second experiment is to justify the proposed thresholding function (14), which exploits two statistics of DTCWT coefficients. The proposed function (14) exploits each statistic independently to perform image denoising; which is further compared with that incorporates both two statistics. The same Boat image as the first experiment is used as ground truth. The performance of image despeckling is evaluated using the SNR as the criterion. As seen in Table 1, the proposed thresholding function (14) with the incorporation of both two statistics achieves the best despeckled image results in terms of the highest SNR performance when the noise standard deviations vary from 0.8 to 1, which are similar to those in real-world ultrasound speckled images.The third experiment is conducted using the real-world ultrasound speckled image. Since there is no ground truth available in this experiment, the image quality is evaluated using the criterion equivalent number of looks (ENL). ENL=(μ/σ)2, where μ and σ are mean and standard deviation of a selected homogeneous region in the image, respectively. The larger ENL indicate better speckle suppression performance. Table 2presents the ENL performance comparison. Fig. 3compares various denoised images of different denoising methods, in which the result of our method can maintain image details and remove speckle noise much more than the other methods.The last experiment is to evaluate the computational complexity performance of the proposed approach in terms of run-time. The image denoising approaches are implemented using Matlab programming and run on a 2.90GHz Intel Pentium G2020 PC. Table 2 compares the averaged run-time (10 times for each approach), where the proposed method yields fairly short computational time.

@&#CONCLUSIONS@&#
An adaptive DTCWT-based image despeckling method using the quantum-inspired adaptive threshold function has been proposed in this paper. The proposed approach utilizes a quantum-inspired adaptive thresholding function by exploiting both inter-scale and intra-scale statistics of coefficients, together with the quantum inspired theory. Experimental results using both artificially generated and real-world medical images demonstrate that the proposed method has a competitive performance of suppressing speckle noise and preserving details for medical ultrasound images with a fairly low computational complexity.