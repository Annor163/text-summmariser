@&#MAIN-TITLE@&#
Optimal dynamic procurement policies for a storable commodity with Lévy prices and convex holding costs

@&#HIGHLIGHTS@&#
A firm aims at meeting a random demand at the end of a random time interval.The firm increases inventory buying on a spot market and maximizes expected profits.We take exponential Lévy spot prices and a general convex holding cost function.First order conditions completely characterize the optimal procurement policy.An analytic explicit solution is provided for linear holding costs.

@&#KEYPHRASES@&#
Continuous time inventory,Lévy price process,Monotone follower problem,First order conditions for optimality,Base inventory level,

@&#ABSTRACT@&#
In this paper we study a continuous time stochastic inventory model for a commodity traded in the spot market and whose supply purchase is affected by price and demand uncertainty. A firm aims at meeting a random demand of the commodity at a random time by maximizing total expected profits. We model the firm’s optimal procurement problem as a singular stochastic control problem in which controls are nondecreasing processes and represent the cumulative investment made by the firm in the spot market (a so-called stochastic ‘monotone follower problem’). We assume a general exponential Lévy process for the commodity’s spot price, rather than the commonly used geometric Brownian motion, and general convex holding costs.We obtain necessary and sufficient first order conditions for optimality and we provide the optimal procurement policy in terms of a base inventory process; that is, a minimal time-dependent desirable inventory level that the firm’s manager must reach at any time. In particular, in the case of linear holding costs and exponentially distributed demand, we are also able to obtain the explicit analytic form of the optimal policy and a probabilistic representation of the optimal revenue. The paper is completed by some computer drawings of the optimal inventory when spot prices are given by a geometric Brownian motion and by an exponential jump-diffusion process. In the first case we also make a numerical comparison between the value function and the revenue associated to the classical static “newsvendor” strategy.

@&#INTRODUCTION@&#
This paper contributes to the literature related to inventory management policies in the presence of price and demand uncertainty. Usually, the two main procurement mechanisms are the spot market, characterized by a negligible lead time, and long-term contracts, that offer the opportunity to procure the good for future use and with no payment prior to the delivery. In recent years the role of the spot market in procurement decisions has become prominent. That is also due to the raising of online spot markets such as memory chips, chemical, energy etc. (see Seifert, Thonemann, & Hausman, 2004). As a consequence the pertinent literature has experienced an increasing interest in mathematical models for the spot market and its role in procurement decisions (see Benkherouf, 2007; Guo, Kaminsky, Tomecek, & Yuen, 2011; Sato & Sawaki, 2010, among others). For example, in Xiao-li (2009) and Xinga, Wangb, and Liu (2012) the optimal procurement policies are obtained for a business-to-business (B2B) spot market. The optimal replenishment policy for an inventory model that minimizes the total expected discounted costs over an infinite planning horizon is studied in Benkherouf (2007) and Sato and Sawaki (2010) in the setting of impulsive control. In Benkherouf (2007) the demand is driven by a Brownian motion with drift, whereas in Sato and Sawaki (2010) the demand is assumed to be deterministic and the market price of the good follows a geometric Brownian motion.A model falling in the class of singular stochastic control problems (that is, a problem in which the controls are the cumulative amounts of the purchased/sold commodity and they are possibly singular with respect to the Lebesgue measure as functions of time) may be found in Guo et al. (2011). There the authors study the inventory problem of a firm facing a random demand at the end of a random time interval. The firm may buy or sell the good in the spot market at any instant prior to the demand time. Trading the commodity in the spot market provides the immediate delivery of the good at a price modeled by a geometric Brownian motion. The firm aims at maximizing total net expected profits under linear holding and shortage costs. Holding costs are due to inventory storage, whereas shortage costs are incurred in when the demand exceeds the available stock. In fact, in such case the firm has a loss of revenue from not meeting the demand, and a loss of future business due to reputation lowering. On the other hand, there might be an excess of inventory at terminal time. That may be salvaged at a price possibly lower than the purchasing one through, for example, a discounted sale. It is shown that the spot market may be used to hedge against both supply costs and demand price uncertainty, although in the classical literature the firm usually enters the spot market when the demand exceeds the inventory level.In this paper we essentially adopt the setting of Guo et al. (2011) but we take exponential Lévy prices and convex holding costs, and we assume that the commodity deteriorates over time at an exponential rate. However, we do not allow selling and we do not have inventory level’s constraints. Our control problem is a so-called ‘monotone follower problem’ since selling is not allowed and the control process represents the cumulative amount of commodity purchased by the firm. We model the commodity spot price P by an exponential Lévy process to take into account the fact that, empirically, the market is non Gaussian but it exhibits significant skewness and kurtosis. We thus drop the assumption of normally distributed increments, while keeping a convenient Markovian structure. Our setup also includes the case of jump processes (like the Poisson process) or that of jump-diffusion processes, and of course the Brownian case typically assumed in the literature. As in Guo et al. (2011), we take a random demand D fully described by a general absolutely continuous distribution function FDwith finite mean, a random demand time Θ exponentially distributed, and we assume D and Θ both independent of the price process. Such independence allows to rewrite the firm’s problem in terms of an equivalent concave, monotone follower problem with infinite time horizon (some classical references on monotone follower problem are El Karoui & Karatzas, 1991; Karatzas, 1981; 1983; Karatzas & Shreve, 1984).We show existence and uniqueness of the optimal inventory policy by exploiting the concavity of our problem and by a suitable version of Komlós’ Theorem (cf. Kabanov, 1999). Hence we characterize it by a set of necessary and sufficient first order conditions similar to those in Bank (2005); Bank and Riedel (2001); Chiarolla, Ferrari, and Riedel (2013); Ferrari (2015); Riedel and Su (2011) and Steg (2012), among others. Such conditions may be thought of as an infinite-dimensional, stochastic generalization of the classical Kuhn–Tucker conditions. They represent a valid alternative to the Hamilton–Jacobi–Bellman (HJB) approach, especially in non Markovian settings.We show that the optimal policy requires to keep the inventory above a base inventory levelℓt*,at each time t. The process ℓ* represents the maximal inventory level for which it is not profitable to delay the commodity’s purchase to any future time, and hence it is characterized in terms of a family of optimal stopping problems (see also Bank & Föllmer, 2002, for a relation with Gittins’ indices in continuous time). At times when the firm’s inventory level is strictly aboveℓt*,it is optimal to wait as at those times the firm faces excess of inventory. On the other hand, when the inventory is belowℓt*,then the firm should instantaneously invest in order to reach the levelℓt*. Hence, as expected in monotone follower problems, the optimal inventory policy behaves as the solution of a Skorohod’s reflection problem at the (random) moving boundary ℓ*. Such a structure of the optimal policy is very natural from the point of view of inventory theory (see, e.g., Porteus, 1990) and it is well known in other contexts as well. See for example models with durable goods (cf., e.g., Bank & Riedel, 2003), irreversible investments (cf. Chiarolla & Haussmann, 2009; Riedel & Su, 2011) and consumption with memory (cf. Bank & Riedel, 2001). We point out that there is a specific condition on the parameters of our model under which the optimal procurement policy consists in not investing at all, whatever random demand D and convex holding costs function one picks (see Proposition 5.3 below).An explicit form of the optimal investment policy is obtained in Section 6 in the particular case of linear holding costs and exponentially distributed demand. The base inventory level is determined there by solving a backward stochastic equation in the spirit of Bank and El Karoui (2004) and, as expected, it turns out to be price-dependent. Moreover in such setting we provide a probabilistic representation of the value function. In the case of spot prices given by a geometric Brownian motion or by an exponential jump-diffusion process we make computer drawings of the optimal inventory level. Finally, we numerically compare the revenue associated to a modified version of the classical “newsvendor” model, in which the commodity is purchased only once and at the initial time, with the value function of our model in the case of geometric Brownian motion prices. The results suggest that our optimal inventory strategy, dynamically acting over the entire given time interval, provides a higher revenue than that corresponding to the optimal static newsvendor one. Moreover, an increase in price volatility makes the difference among the two revenues increase. Therefore, although firms may prefer long term contracts when the commodity price is highly fluctuating, our results suggest that in order to increase the revenue the commodity must be dynamically procured in the spot market.The rest of the paper is organized as follows. In Section 2 we set the firm’s optimal procurement problem, and in Section 3 we derive an equivalent concave singular stochastic control problem. In Section 4 we prove the existence of optimal procurement policies and in Section 5 we obtain a characterization of them. Finally, Section 6 contains some explicit examples and computer drawings.Consider a firm choosing a dynamic procurement policy of a single commodity to meet a random demand D at a prescribed future random time Θ. Each unit of demand satisfied gives rise to a profit depending on the spot price at time Θ, PΘ. At any time t ∈ [0, Θ) the firm can instantaneously increase its inventory but it cannot buy inventory at terminal time Θ to meet demand. In case the inventory at time Θ is lower than the demand, then the firm incurs in a shortage cost proportional to PΘ. On the other hand, when the inventory at time Θ exceeds the demand, the excess of inventory is salvaged by selling it in the spot market at price αsPΘ, for some 0 < αs≤ 1. The costs associated to a procurement policy are the ordering cost given by the purchase of the commodity in the spot market, and the holding cost of storaging the commodity up to time Θ.To introduce the model fix a complete probability space(Ω,G,Q)and let the demand time Θ be a positiveG-measurable random variable. Consider a spot market in which the commodity may be traded at any time t ∈ [0, Θ) at a price Pt. Here {Pt, t ≥ 0} is an exogenous positive stochastic process on(Ω,G,Q)and{Ft,t≥0}is the filtration generated by Pt. We assume forFthe usual hypotheses of completeness and right-continuity.Definition 2.1The price process Pthas the following exponential Lévy structure(2.1)Pt=eδt−ζXt−π(−ζ)t,t≥0,whereδ,ζ∈R,X is a Markov process withX0=0,right-continuous sample paths, stationary, independent increments, and finite Laplace exponent π(·) given byE[eζXt]=eπ(ζ)tfor allζ∈Rand t > 0.The constant δ may be seen as an interest rate, whereas ζ as a market price of risk.Remark 2.2(1)There is no loss of generality in considering structure (2.1) since commonly used price dynamics may be cast in form (2.1) by adjusting δ, through the Laplace transform of X. Such structure (2.1) usually arises in a financial market affected by a Markov uncertainty process X (see, e.g., Duffie, 1992, Ch. 6, for a discussion in a Brownian setting).The uncertainty process X is much more general than the Brownian one, commonly assumed in the literature. Indeed we drop the assumption of normally distributed increments, while keeping a convenient Markovian structure. Our setup also covers the case of jump processes, like the Poisson process, or that of jump-diffusion processes (see Section 6), as well as the deterministic case obtained by settingζ=0.For the positive,G-measurable random variables Θ and D we make the following (see also Guo et al., 2011, Section 3.1)Assumption 2.31.Θ is independent of the filtration{Ft}and D.Θ is exponentially distributed with rate λ > 0.D is independent of Θ and{Ft},and its distributionFD(y)=Q(D≤y)is absolutely continuous with densityfD(y)=FD′(y). MoreoverE[D]<∞.In particular Assumptions 2.3, point (2) implies that the average demand time is 1/λ.We denote by r > 0 the firm’s manager discount factor and we assume for the firm’s inventory Yy, νthe following dynamics(2.2){dYty,ν=−ɛYty,νdt+dνt,t>0,Y0y,ν=y,where ε ≥ 0 is the commodity deterioration rate, y ≥ 0 is the initial inventory amount, and νtis the cumulative amount of commodity purchased up to time t. In fact, we takeν∈AwithA:={ν:Ω×R+→R+nondecreasing,left-continuous,{Ft}-adapteds.t.ν0=0Q-a.s.}.Then the explicit solution of (2.2) is(2.3)Yty,ν=e−ɛt[y+ν¯t],t≥0,with(2.4)ν¯t:=∫[0,t)eɛsdνs,t≥0.The mappingA∋ν↦ν¯∈Adefined by (2.4) is one-to-one and onto. Left-continuity of ν captures the restriction that no commodity may be purchased at time Θ. The fact that ν is{Ft}-adapted guarantees that any investment decisions is taken on the basis of all the information on the price process up to time t.The net gain function at the demand time Θ is given byPΘG(YΘy,ν,D),where the ‘revenue multiplier’ G is defined by(2.5)G(y,D):=αmin{y,D}−αp[D−y]++αs[y−D]+,for any inventory level y ≥ 0. Notice that[D−YΘy,ν]+represents the amount of unsatisfied demand at time Θ and αp≥ 0 is a penalty factor. Similarly[YΘy,ν−D]+is the excess amount of inventory at time Θ cleared in the spot market at a price possibly lower than PΘ, according to the factor αs∈ (0, 1]. Finally, α ≥ 1 represents a premium factor for the amount of demand satisfied. Notice thatα+αp−αs≥0.The cost of increasing the inventory at time t ∈ [0, Θ) by a quantity dνtis Ptdνt, whereas the cost of holding the inventory for an infinitesimal time interval(t,t+dt)⊂[0,Θ)isc(Yty,ν)dt. Hence, for any admissible procurement policy ν, the total expected discounted return to the firm isJ(y,ν)=netexpecteddiscountedgainatdemandtimeΘ−totalexpecteddiscountedholdingcosts−totalexpectedorderingcosts;that is,(2.6)J(y,ν)=E[e−rΘPΘG(YΘy,ν,D)−∫0Θe−rtc(Yty,ν)dt−∫[0,Θ)e−rtPtdνt].The following standing assumption shall hold throughout the paperAssumption 2.4The holding cost functionc:R+→R+is convex, strictly increasing, continuously differentiable withc(0)=0and(2.7)∫0∞e−rtc′(ye−ɛt)dt<∞,foranyy≥0.1.Notice that the requirementc(0)=0is without loss of generality, since ifc(0)=K>0then one can always setc^(y):=c(y)−c(0)and writec(y)=c^(y)+K,so that the firms’s optimization problem (cf. (2.13) below) remains unchanged up to an additive constant.Convexity of c(·) together withc(0)=0imply c(y) ≤ yc′(y) for any y ≥ 0, and therefore(2.8)∫0∞e−rtc(ye−ɛt)dt≤y∫0∞e−(r+ɛ)tc′(ye−ɛt)dt<∞,where finiteness of the last term in (2.8) is due to (2.7).Natural examples of cost functions satisfying Assumption 2.4 arec(x)=β1xorc(x)=β2x2,for β1, β2 > 0.One could also allow proportional trading costs in the spot market, which amounts to a cost K > 0 for each unit of commodity purchased, under suitable further conditions.The firm aims at picking a procurement policy in order to maximize the total expected discounted return (2.6). For the well-posedness of the problem some integrability condition is needed. In fact, we define the setSof admissible procurement policies(2.9)S:={ν¯∈A:E[∫0∞e−βtPtν¯tdt]<∞}with(2.10)β:=r+ɛ+λ.Now in terms ofν¯(cf. (2.4) and (2.3)) we may rewrite (2.6) as(2.11)J(y,ν)=J˜(y,ν¯)=E[e−rΘPΘG(e−ɛΘ(y+ν¯Θ),D)−∫[0,Θ)e−(r+ɛ)tPtdν¯t−∫0Θe−rtc(e−ɛt(y+ν¯t))dt],and by using the independence of D, Θ and P (cf. Assumptions 2.3), we have(2.12)J˜(y,ν¯)=E[∫0∞λe−(r+λ)tPt(∫0∞G(e−ɛt(y+ν¯t),z)fD(z)dz)dt−∫[0,∞)e−(r+λ+ɛ)tPtdν¯t−∫0∞e−(r+λ)tc(e−ɛt(y+ν¯t))dt].Hence the firm’s optimization problem is(2.13)V(y)=supν¯∈SJ˜(y,ν¯),y≥0.From a mathematical point of view, problem (2.13) falls into the class of singular stochastic control problems of monotone follower type (see the Introduction for some classical references), which allows controls possibly singular (as functions of time) with respect to the Lebesgue measure. If the performance criterion is concave (or convex) it is well known that the optimal control policy consists in keeping the state process at or above a certain threshold. In mathematical terms, the optimal control is the solution of a Skorohod reflection problem at a moving boundary (see, e.g., El Karoui & Karatzas, 1991; Karatzas, 1981; 1983; Karatzas & Shreve, 1984). Problem (2.13) may be rewritten in terms of a new functional for which is easy to check concavity. This is accomplished in the following section (see Proposition 3.9 below).Since the ‘revenue multiplier’ G has a singular point (i.e. a point in which it is not differentiable), we prefer to switch to a more regular function. In fact, we rewrite the functional in (2.12) by borrowing some ideas and arguments from Guo et al. (2011).Define the random fieldΓ:Ω×R+×R+→R(3.1)Γ(ω,t,y):=e−(r+λ)t[λPt(ω)H(e−ɛty)−c(e−ɛty)],with the functionH:R+→Rgiven by(3.2)H(y):=αsy−(αp−αs)∫y∞zfD(z)dz+(α+αp−αs)y(1−FD(y))+α∫0yzfD(z)dz,or equivalently(3.3)H(y)=αsy+αE[D]−(α+αp−αs)∫y∞(z−y)fD(z)dz.The following lemma shows that Γ is continuously differentiable and concave in y.Lemma 3.1The following properties hold,(i)H is continuously differentiable, strictly increasing, and concave inR+with(3.4)H(y)≤αsy+αE[D],H(y)≥−(αp−αs)E[D];y ↦ Γ(ω, t, y) is continuously differentiable and concave for any(ω,t)∈Ω×R+;(ω, t) ↦ Γ(ω, t, y) is{Ft}-progressively measurable for any y ≥ 0.From (3.2) one has that(3.5)H′(y)=αs+(α+αp−αs)(1−FD(y)),which shows that y ↦ H(y) is continuously differentiable and strictly increasing asα+αp−αs≥0. Moreover(3.6)H′′(y)=−(α+αp−αs)fD(y),which implies concavity of H(·). The first of (3.4) follows from (3.3) recalling thatα+αp−αs≥0; whereas the second one follows from the fact that H(·) is increasing andH(0)=−(αp−αs)E[D]. As for (ii) clearly y ↦ Γ(ω, t, y) is continuously differentiable and concave for any(ω,t)∈Ω×R+since so are H(·) and−c(·)(cf. Assumption 2.4). Finally, to show (iii) it suffices to notice that progressive measurability of (ω, t) ↦ Γ(ω, t, y), for any y ≥ 0, is implied by the fact that P is{Ft}-progressively measurable being{Ft}-adapted with right-continuous paths (cf. Definition 2.1).□As in Guo et al. (2011), Theorem 4, we obtain the decomposition of the optimal total expected discounted return V(y) in terms of the value function of a new optimization problem and the expected value of the demandE[D]. To obtain such decomposition we need the followingAssumption 3.2r+λ−δ>0.Notice that Assumption 3.2 is equivalent to require thatE[e−rΘPΘ]<∞,i.e. the expected discounted price of a unit of commodity at the demand time is finite.Proposition 3.3UnderAssumption 3.2the optimal total expected return is(3.7)V(y)=W(y)−λαsr+λ−δE[D],where(3.8)W(y):=supν¯∈SJ^(y,ν¯)and(3.9)J^(y,ν¯):=E[∫0∞Γ(t,y+ν¯t)dt−∫[0,∞)e−βtPtdν¯t].SinceE[∫0∞λe−(r+λ)tPt(∫0∞G(e−ɛt(y+ν¯t),z)fD(z)dz)dt]=E[∫0∞e−(r+λ)tλPtH(e−ɛt(y+ν¯t))dt]−λαsr+λ−δE[D]by Assumption 3.2, then the proof follows from (3.1).□In order to show that the new value function W of (3.8) is concave and proper we need a further assumption and some preliminary lemmas.Assumption 3.4β−δ−λαs>0.Such assumption may be rewritten asE[e−rΘe−ɛΘαsPΘ]=λαsr+ɛ−δ+λ=λαsβ−δ<1and its economic interpretation is the following. At time Θ one unit of excess of inventory purchased at time 0 amounts toe−ɛΘ(due to deterioration) and such amount is sold at the clearing price αsPΘ(due to penalization), hence its expected discounted value at time 0 isE[e−rΘe−ɛΘαsPΘ]and we require that such value is less than 1, i.e. less than the unitary price at time 0.Recall thatβ=r+ɛ+λ(cf. (2.10)) and notice that β > δ.Lemma 3.5UnderAssumption 3.2the discounted price processe−βtPtis a positive{Ft}-supermartingale with right-continuous sample paths, such thatlimt→∞e−βtPt=0Q−a.s.The properties of the Markov process X (cf. Definition 2.1) together with β > δ imply the right-continuous supermartingale property ofe−βtPtsince(3.10)E[e−βtPt|Fs]=e−(β−δ)(t−s)e−βsPs,t≥s≥0.Then Fatou’s Lemma, (3.10) and β > δ imply0≤E[limt→∞e−βtPt]≤lim inft→∞E[e−βtPt]=limt→∞E[e−βtPt]=0.This together withlimt→∞e−βtPt≥0Q-a.s. (cf. Karatzas & Shreve, 1988, Ch. 1, Problem 3.16) givelimt→∞e−βtPt=0Q-a.s.□From now on we will denote by τ any{Ft}-stopping time with values in [0, ∞] and, in light of Lemma 3.5, we will adopt the followingDefinition 3.6e−βτPτ:=limt→∞e−βtPt=0on{τ=∞}.UnderAssumption 3.2one has(3.11)E[∫0∞e−βtPtdt]=1β−δand, for any stopping time τ ∈ [0, ∞],(3.12)E[∫τ∞e−βtPtdt|Fτ]=e−βτPτβ−δ.Applying Tonelli’s Theorem and using the definition of P (cf. Definition (2.1)) imply (3.11). As for (3.12) notice that for any stopping time τ ∈ [0, ∞]E[∫τ∞e−βsPsds|Fτ]=e−βτ∫0∞e−βtE[Pt+τ|Fτ]dt=e−βτPτ∫0∞e−βtE[Pt+τPτ|Fτ]dt=e−βτPτ∫0∞e−βtE[Pt]dt=e−βτPτβ−δ,where the third equality follows by the exponential form of the price process and the properties of the Markov process X (cf. Definition 2.1), whereas the last equality from (3.11).□UnderAssumption 3.2, for any admissible procurement policyν¯∈Sit holds(3.13)E[∫0∞e−βtPtν¯tdt]=1β−δE[∫[0,∞)e−βtPtdν¯t].Fixν¯∈S,then by Tonelli’s Theorem one has∫0∞e−βtPtν¯tdt=∫0∞e−βtPt(∫[0,t)dν¯s)dt=∫[0,∞)(∫s∞e−βtPtdt)dν¯s.Taking expectations one obtainsE[∫0∞e−βtPtν¯tdt]=E[∫[0,∞)E[∫s∞e−βtPtdt|Fs]dν¯s]=1β−δE[∫[0,∞)e−βtPtdν¯t],where the first equality follows from Dellacherie and Meyer (1979), Ch. VI, Theorem 57, whereas the last equality follows from (3.12) withτ=s.□UnderAssumptions 3.2and3.4, the new value function W(·) is concave and proper. Moreover(3.14)W(y)≤λαsyβ−δ+λαr+λ−δE[D].Recall that Γ is concave by Lemma 3.1. Then, using the affine property ofYy,ν¯in the control variable (cf. (2.3)), for any λ ∈ (0, 1),y1,y2∈R+andν¯1,ν¯2∈Swe haveW(λy1+(1−λ)y2)≥J^(λy1+(1−λ)y2,λν¯1+(1−λ)ν¯2)≥λJ^(y1,ν¯1)+(1−λ)J^(y2,ν¯2)and concavity of W(·) follows.We now show that W is proper, that is |W(y)| < ∞ for any y ≥ 0. In fact(3.15)W(y)≥J^(y,0)=E[∫0∞λe−(r+λ)tPtH(ye−ɛt)dt−∫0∞e−(r+λ)tc(ye−ɛt)dt]≥−E[λ(αp−αs)E[D]∫0∞e−(r+λ)tPtdt+∫0∞e−(r+λ)tc(ye−ɛt)dt]>−∞,where we have first used the second inequality in (3.4), then we have applied (2.8), Assumptions 2.3 and 3.2 to get the last inequality.On the other hand, to show W(y) < ∞ for y ≥ 0, we fix an arbitraryν¯∈Sand we use the first inequality in (3.4) and the fact that c is positive to obtain(3.16)J^(y,ν¯)≤E[∫0∞λe−(r+λ)tPt[αse−ɛt(y+ν¯t)+αE[D]]dt−∫[0,∞)e−βtPtdν¯t]=E[∫0∞λαse−βtPt(y+ν¯t)dt−∫[0,∞)e−βtPtdν¯t]+λαr+λ−δE[D]=λαsyβ−δ−(β−δ−λαs)E[∫0∞e−βtPtν¯tdt]+λαr+λ−δE[D]where the last step follows from Lemma 3.8. Then passing to the supremum overν¯∈Sin (3.16) implies (3.14) sinceβ−δ−λαs>0by Assumption 3.4.□Existence of a solutionν¯*of concave (convex) singular stochastic control problems may be obtained by a suitable version of Komlós’ Theorem (see, for example, Karatzas, Wang, Menaldi, Sulem, & Rofman, 2005; Riedel & Su, 2011). In its classical formulation Komlós’ Theorem (cf. Komlós, 1967) states that if a sequence of random variables{Zn,n∈N}is bounded from above in expectation, then there exists a subsequence{Znk,k∈N}which converges a.e. in the Cesàro sense to some random variable Z. Hence, if a maximizing (minimizing) sequence of admissible controls is Komlós compact, then due to concavity (convexity) the limit provided by Komlós’ Theorem turns out to be an optimal control policy. These arguments also work in our setting thanks to our assumptions. Moreover, if c is strictly convex, thenJ^(y,·)of (3.9) is strictly concave inν¯for y ≥ 0 fixed, and hence if a solution to (3.8) exists, then it is also unique.Theorem 4.1LetAssumptions 3.2and3.4hold. Then, for each fixed y ≥ 0, there exists an optimal procurement policyν¯*for problem(3.8), i.e.J^(y,ν¯*)=W(y). Moreover, if c(·) is strictly convex then the optimal policy is unique (up to undistinguishability).Take a maximizing sequence{ν¯(n)}n∈N⊂S; i.e. a sequence such thatlimn→∞J^(y,ν¯(n))=W(y). Without loss of generality, we may takeJ^(y,ν¯(n))≥W(y)−1n. Recallβ−δ:=r+λ+ɛ−δ>0and use arguments similar to those in (3.16) to obtain, for anyn∈N,W(y)−1n≤J^(y,ν¯(n))≤λαsyβ−δ+λαr+λ−δE[D]−(β−δ−λαs)E[∫0∞e−βtPtν¯t(n)dt],hence also(β−δ−λαs)E[∫0∞e−βtPtν¯t(n)dt]≤λαsyβ−δ+λαr+λ−δE[D]−W(y)+1nand(4.1)supn∈NE[∫0∞e−βtPtν¯t(n)dt]≤1β−δ−λαs(λαsyβ−δ+λαr+λ−δE[D]−W(y)+1)where the right hand side is finite due to properness of W (cf. Proposition 3.9). Then by Lemma 3.8 we obtain(4.2)supn∈NE[∫[0,∞)e−βtPtdν¯t(n)]≤β−δβ−δ−λαs(λαsyβ−δ+λαr+λ−δE[D]−W(y)+1).Now we make a change of probability. In fact we define the equivalent probability measureQ˜onFtby setting(4.3)dQ˜dQ|Ft=e−δtPt,t≥0,and we denote byE˜[·]the expectation underQ˜. Then, in terms of the new probability measure, (4.2) becomes(4.4)supn∈NE˜[∫[0,∞)e−(β−δ)tdν¯t(n)]≤β−δβ−δ−λαs(λαsyβ−δ+λαr+λ−δE[D]−W(y)+1).Then the sequence of nondecreasing, left-continuous, adapted processesZt(n):=∫[0,t)e−(β−δ)sdν¯s(n)satisfies(4.5)supn∈NE˜[Z∞(n)]<∞.The mappingν¯(n)↦Z(n)is one to one and onto, and its inverse givesν¯t(n):=∫[0,t)e(β−δ)sdZs(n).By a version of Komlós Theorem for optional random measures11LetVTdenote the space of positive finite measures on [0, T], T ∈ (0, ∞], with the topology of weak-*convergence. Recall that an optional random measure is simply aVT-valued random variable Z such that the process Zt(ω) ≔ Z(ω; [0, t)) is adapted.(see Lemma 3.5 in Kabanov, 1999) there exists a subsequence{Z(nk)}k∈N⊂{Z(n)}n∈Nand an optional random measure Z* such thatZ(nk)converges weakly in the Cesàro sense to Z* a.s.; that is,(4.6)limj→∞1j∑k=1j∫[0,∞)fsdZs(nk)=∫[0,∞)fsdZs*,Q˜−a.s.for any bounded functionf:R+↦R+which is continuous dZ*-a.e. inR+. Then we may setν¯t*:=∫[0,t)e(β−δ)sdZs*=∫[0,∞)1[0,t)(s)e(β−δ)sdZs*and rewrite (4.6) as(4.7)limj→∞ξt(j)=ν¯t*,Q˜−a.s.withξt(j):=1j∑k=1jν¯t(nk). Since each ξ(j) is a convex combination of the first j elements of the subsequence of{ν¯(n)}n∈N,we have(4.8)lim infj→∞E˜[∫0∞e−(β−δ)tξt(j)dt]<∞by (4.1). Moreover,t↦ν¯t*is nondecreasing and hence the set of its points of discontinuity has zero Lebesgue measure; therefore Girsanov Theorem (cf. (4.3)), Fatou’s lemma and (4.7) together with (4.8) yieldE[∫0∞e−βtPtν¯t*dt]=E˜[∫0∞e−(β−δ)tν¯t*dt]<∞.It is possible to show thatν¯*admits a left-continuous modification which we still denote byν¯*. We conclude thatν¯is admissible, i.e.ν¯∈S.In order to prove thatν¯*is optimal, it suffices to show that(4.9)J^(y,ν¯*)≥W(y).We start from(4.10)J^(y,ξ(j))=E[∫0∞(Γ(t,y+ξt(j))−(β−δ)e−βtPtξt(j))dt]where we have used Lemma 3.8. Then, under the new probability measureQ˜(cf. (4.3)), we have(4.11)J^(y,ξ(j))=E˜[∫0∞Φ(ξt(j))dt]whereΦ(ξt(j)):=eδtPtΓ(t,y+ξt(j))−(β−δ)e−(β−δ)tξt(j).Also, for eachj∈N,Φ(ξt(j))≤λαsye−(β−δ)t+λαe−(r+λ−δ)tE[D]Q˜−a.s.,by (3.1), the first inequality in (3.4), c(·) ≥ 0 (cf. Assumption (2.4)), and Assumption 3.4. Therefore, by applying the reverse Fatou Lemma, (4.6), concavity ofJ^(y,·)and Cesàro Mean Theorem, we obtain(4.12)J^(y,ν¯*)≥lim supj→∞J^(y,ξ(j))≥lim supj→∞1j∑k=1jJ^(y,ν¯(nk))=W(y),henceν¯*is optimal. As a subproduct, we also have that{ξ(j)}j∈Nis itself a maximizing sequence of policies.It remains to show that the optimal policy is unique (up to undistinguishability) if c(·) is strictly convex. Letν¯*,1andν¯*,2be two optimal strategies and define the admissible procurement strategyν^:=12ν¯*,1+12ν¯*,2. We then have0≥J^(y,ν^)−W(y)=J^(y,ν^)−12J^(y,ν¯*,1)−12J^(y,ν¯*,2)=E[∫0∞(Γ(t,y+ν^t)−12Γ(t,y+ν¯t*,1)−12Γ(t,y+ν¯t*,2))dt]≥0,where the last inequality follows by concavity of Γ(t, ·) (cf. Lemma (3.1)). Thus the inequalities above must be equalities and again by concavity of Γ(t, ·) it must beΓ(t,y+ν^t)=12Γ(t,y+ν¯t*,1)+12Γ(t,y+ν¯t*,2),Q−a.s.fora.e.t≥0.Henceν¯t*,1=ν¯t*,2,Q-a.s. for a.e. t ≥ 0, by noticing that the assumption of strictly convexity of c(·) implies the strict concavity of Γ(t, ·). Therefore, by left-continuity ofν¯*,i,i=1,2,we conclude thatν¯*,1andν¯*,2are indistinguishable.□Notice that the existence of an optimal procurement strategy may be obtained for random demand times Θ with continuous density more general than the exponential one as long as their hazard rate htsatisfies the conditionht<r+ɛ−δαs,needed to prove properness of the value function W(y). Such condition is a quite strong requirement on the hazard rate ht, which is often unbounded, although it is satisfied by some well known distributions as the log-normal or the log-logistic distributions for suitable parameters.Theorem 4.1 provides the existence of an optimal policyν¯*∈Sfor the procurement problem without giving any information about its nature. In this section we provide a complete characterization of the optimal procurement policy through generalized stochastic first order conditions. Such approach does not need a priori smoothness of the value function, neither of the boundary between the investment and the no-investment regions, in order to determine the optimal policy. Therefore it allows to overcome the regularity issues dealt with in the HJB quasi-variational inequality approach arising from our two-dimensional setting with state process (Yt, Pt).Characterizing the optimal controls by first order conditions appeared in Bertola (1998) for a profit maximizing firm with Cobb–Douglas operating profit function and uncertainty given by a geometric Brownian motion. Such concept was then developed in Bank and Riedel (2001) in the case of a static budget constraint, in Bank (2005) in the case of a stochastic dynamic finite-fuel constraint, in Steg (2012) in a capital accumulation game of sequential irreversible investment, and in Chiarolla et al. (2013) for an optimization problem involving N firms. In Riedel and Su (2011) a stochastic first order conditions approach was employed to obtain the optimal policy through the solution to a backward stochastic equation.For any admissible ν the super-gradient process∇J^(y,ν)is defined as the unique optional22A stochastic process is optional if it is measurable with respect to the optional sigma-algebraOon Ω × [0, T]. The optional sigma-algebraOis generated by, e.g., the right-continuous and adapted processes (see, e.g., Dellacherie & Meyer, 1979).process satisfying(5.1)∇J^(y,ν¯)(τ):=E[∫τ∞Γy(t,y+ν¯t)dt|Fτ]−e−βτPτ,for any{Ft}-stopping time τ ∈ [0, ∞], withβ:=r+λ+ɛ(cf. (2.10)) and Γy≔ ∂Γ/∂y. The super-gradient (5.1) may be interpreted as the marginal expected net profit resulting from the purchase of an extra unit of commodity at time τ.Theorem 5.1Let Assumptions3.2and3.4hold and fix y ≥ 0. Then, for an admissible policyν¯*,the following first order conditions(5.2){∇J^(y,ν¯*)(τ)≤0a.s.forallstoppingtimesτ∈[0,∞],∫0∞∇J^(y,ν¯*)(t)dν¯t*=0a.s.are necessary and sufficient for optimality ofν¯*in problem(3.8).Setkt:=e−βtPtand apply Steg (2012), Proposition 3.2 which requires the three conditions of his Assumption 3.1. Our Lemma 3.1 and Proposition 3.9 guarantee the first two; as for the third one, it asks for y ↦ Γy(ω, t, y) strictly decreasing but it is easily checked that it suffices concavity of Γ(ω, t, ·) to prove optimality of the first order conditions.□The intuition of the first order conditions is that when the gradient is positive at some stopping time, a small extra investment is profitable.Remark 5.2The first order conditions (5.2) can be thought of as a stochastic infinite-dimensional generalization of the classical Kuhn–Tucker conditions. In real analysis, if one deals with an optimization problem of the form maxx ≥ 0f(x), for some smooth concave real function f, then it is well known that the Kuhn–Tucker conditions for optimality of x* are(5.3)f′(x*)≤0,x*f′(x*)=0.Roughly speaking, in our setting the nonnegativity constraint x ≥ 0 is replaced by the irreversibility constraintdν¯t≥0for all t ≥ 0,Q−a.s., and the role of the first derivative f′(·) is played by the super-gradient process∇J^(y,ν¯). Then (5.2) is a generalization of (5.3).The following proposition shows with the help of Theorem 5.1 that it is optimal not to exercise the investment option at all ifβ−δis sufficiently large.Proposition 5.3UnderAssumptions 3.2and3.4, ifβ−δ≥λ(αp+α)then, for any y ≥ 0, it is never optimal to invest in the commodity, i.e.ν¯*≡0for any t ≥ 0Q−a.s. HenceW(y)=E[∫0∞Γ(t,y)dt]=∫0∞e−(r+λ)t[eδtλH(e−ɛty)−c(e−ɛty)]dt.For any admissible procurement policyν¯and any stopping time τ ≥ 0 we have(5.4)∇J^(y,ν¯)=E[∫τ∞Γy(t,y+ν¯t)dt|Fτ]−e−βτPτ=λ(αp+α)E[∫τ∞e−βtPtdt|Fτ]−λ(α+αp−αs)E[∫τ∞e−βtPtFD(e−ɛt(y+ν¯t))dt|Fτ]−E[∫τ∞e−βtc′(e−ɛt(y+ν¯t))dt|Fτ]−e−βτPτ<λ(αp+α)E[∫τ∞e−βtPtdt|Fτ]−e−βτPτ=e−βτPτ(λ(αp+α)−(β−δ)β−δ),withβ:=r+ɛ+λ,where the inequality in the third step follows from the nonnegativity ofα+αp−αs,of FD(·) and of c′(·) (cf. Assumption 2.4), whereas the last equality follows from (3.12). It follows that ifλ(αp+α)≤β−δ,then the super-gradient is always strictly negative for any admissible procurement policyν¯and any stopping time τ ≥ 0, and hence it is never optimal to purchase commodity (cf. Theorem 5.1).□Theorem 4.1 guarantees the existence of an optimal investment policy for any y ≥ 0, and the first order conditions (5.2) completely characterize it. However, such conditions are not necessarily binding and hence they do not always explicitly determine the optimal policies. For that, we follow Riedel and Su (2011), Section 3, or Steg (2012), Proposition 3.3, and we obtain the optimal procurement policies in terms of a process33Notice that in Riedel and Su (2011), Section 3, or Steg (2012), Section 3.2, such process is referred to as base capacity process.l*, which we refer to as base inventory process, representing a desirable value of inventory that the firm aims to reach at every time. Recall thatβ:=r+λ+ɛ.Theorem 5.4Assume thatAssumptions 3.2and3.4hold. Then there exists an optional process ℓ*taking values in [0, ∞) and satisfying, for t ≥ 0,(5.5)ℓt*=sup{z∈R+|essinfτ≥tE[∫tτΓy(s,ze−ϵs)ds+e−βτPτ|Ft]=e−βtPt}∨0,Q-a.s.,such that, for any y ≥ 0, the procurement policy(5.6)ν¯t*:=sup0≤u<t(eɛuℓu*−y)∨0,t≥0,is optimal for(3.8), if it is admissible.Since Theorem 4.1 provides the existence of an optimal procurement policy ν* for any y ≥ 0, it suffices to apply Steg (2012), Proposition 3.3 (which may be easily adapted to our case with depreciation rate ε ≥ 0).□The base inventory process ℓ* is the maximal inventory level for which it is not profitable to delay marginal purchase of the commodity to any future stopping time. Also, for any t ≥ 0,ℓt*is uniquely defined if y ↦ Γy(t, y) is strictly decreasing, i.e. if the holding cost function c(·) is strictly convex (cf. (3.1)). The optimal procurement policy provided by (5.6) consists in keeping the inventory levelYy,ν¯*always at or aboveℓt*. If the inventory level at time t is such thatYty,ν¯*>ℓt*,then the firm faces excess inventory and should wait to buy more commodity. If the inventory level is belowℓt*,then the firm should investν¯t*=ℓt*−Yty,ν¯*in order to reach the levelℓt*. Such property of the optimal policy is quite natural in inventory theory (see, e.g., Porteus, 1990).The signal processℓt*may be characterized as the unique optional positive solution of a backward stochastic equation related to (5.2) (cf. the Bank-El Karoui’s representation problem in Bank and El Karoui (2004), Theorems 1 and 3). In the context of stochastic irreversible capacity expansion problems, such backward equation has been obtained in Chiarolla and Ferrari (2014); Ferrari (2015); Riedel and Su (2011) (here the backward equation is actually an integral equation) under the Inada conditions on the corresponding Γ (cf. Inada, 1963), i.e.limy↓0Γy(t,y)=∞andlimy↑∞Γy(t,y)=0fort≥0.In the present setting, although our Γ (cf. (3.1)) does not satisfy the Inada conditions, we adapt some of their arguments to characterizeℓt*through a backward stochastic equation, which we actually manage to solve in the case of linear holdings costs and exponentially distributed demand (cf. Section 6.1 below).Proposition 5.5If there exists a progressively measurable process ℓ*solving the backward stochastic equation(5.7)E[∫τ∞Γy(t,supτ≤u<t(eɛuℓu*))dt|Fτ]=e−βτPτ,a.s.foranystoppingtimeτ∈[0,∞],then the procurement policy(5.8)ν¯t*:=sup0≤u<t(eɛuℓu*−y)∨0,ν¯0*=0,is optimal for problem(3.8), if it is admissible.We borrow arguments from Bank and Riedel (2001) (or Riedel & Su, 2011). It suffices to show that the process(5.9)Yt*:=Yty,ν¯*=e−ɛt[y+ν¯t*]=ye−ɛt∨sup0≤u<t(e−ɛ(t−u)ℓu*)satisfies the first-order conditions for optimality (5.2). For any stopping time τ, (5.1) together with concavity of Γ(t, ·) imply(5.10)∇J^(y,ν¯*)(τ)=E[∫τ∞Γy(t,y∨sup0≤u<t(eɛuℓu*))dt|Fτ]−e−βτPτ≤E[∫τ∞Γy(t,supτ≤u<t(eɛuℓu*))|Fτ]−e−βτPτ=0,since ℓ* solves (5.7).To prove the second condition in (5.2), notice that for any τ ≥ 0 at which the purchase of the commodity takes place (i.e. wheredν¯τ*:=ν¯τ+ɛ*−ν¯τ*>0,for every ε > 0) we haveYt*=e−ɛtsupτ≤u<t(eɛuℓu*)fort>τ,by (5.9). Thereforey+ν¯t*=supτ≤u<t(eɛuℓu*)for t > τ, hence at times τ carrying the random Borel measure dν* we have∇J^(y,ν¯*)(τ)=0by (5.7).□Clearlyν¯*of (5.8) is nondecreasing and left-continuous; it is{Ft}-progressively measurable (since l* is so, cf. Dellacherie and Meyer (1979), Theorem IV.33), hence also{Ft}-adapted. Thereforeν¯*is admissible if and only if the integrability conditionE[∫0∞e−βtPtν¯t*dt]<∞holds. Such condition must be checked on a case by case basis but it is usually satisfied if β is sufficiently large.Notice that, as discussed in Section 3 of Riedel and Su (2011), (5.7) shows clear similarities with the first order conditions (5.2). In fact, by considering the first order conditions for a firm that starts investing at time τ, we may take the supremum from time τ on in the inventory that tracks the base inventory ℓ* (cf. (5.6)) and then plug it into the supergradient (5.1). Then the first order conditions are binding for the firm and thus we obtain an equality as in (5.7).In applications Proposition 5.5 turns out to be very useful as it provides a constructive method to find ℓ* and hence solve problem (3.8). In fact, (5.7) may be at least found numerically by backward induction on a discretized version of problem (5.7) (see Bank & Föllmer, 2002, Section 4). In the next section we explicitly solve the backward stochastic equation (5.7) in the case of an exponentially distributed demand (Lariviere & Porteus, 1999; Zhang, Nagarajan, & Sošić, 2010, cf.) for the use of the exponential distribution in inventory management literature) and linear holding costs (cf. Guo et al., 2011; Tarima & Kingsman, 2004; Zhang, 2010, among others).Throughout this section Assumptions 2.3, 2.4, 3.2 and 3.4 still hold true. We also assume, as in Guo et al. (2011), linear holding costs, i.e.c(x)=cxfor some c > 0, and zero deterioration rate, i.e.ɛ=0. Moreover, we assume that D is exponentially distributed with parameter γ > 0; that is,fD(z)=γe−γz. Within this setting one hasβ=r+λand (cf. (3.2))(6.1)H(y)=αsy+αγ−(αp+α−αs)γe−γy,and (cf. (3.1))(6.2)Γ(t,y)=e−βtλPt[αsy+αγ−(αp+α−αs)γe−γy]−e−βtcy.Then,(6.3)Γy(t,y)=e−βt[λPt(αs+(α+αp−αs)e−γy)−c].We now find, in our general exponential Lévy setting, the explicit form of the optimal procurement policy, which turns out to be bounded. To the best of our knowledge, such explicit result appears here for the first time.Proposition 6.1Withβ=r+λ,let τβ be an exponentially distributed random time, independent of P, with parameter β, and set(6.4)κ:=E[inf0≤u≤τβ(PτβPu)],(6.5)a:=(β−δ−λαs)λ(α+αp−αs),b:=cλκ(α+αp−αs),(6.6)ℓt*=−1γln(a+bPt).Thenℓt*44The logarithm in (6.6) is well defined sincea:=(β−δ−λαs)λ(α+αp−αs)>0,by Assumption 3.4 and by the nonnegativity ofα+αp−αs,and b > 0 since κ ∈ [0, 1].solves the stochastic backward equation(6.7)E[∫τ∞Γy(t,supτ≤u≤tℓu*)dt|Fτ]=e−βτPτ,a.s.foranyτ≥0,and hence the optimal procurement policy for problem(3.8)is(6.8)ν¯t*:=sup0≤s<t(ℓs*−y)∨0,ν¯0*=0.Substitute (6.3) in (6.7), make a change of variable in the integral, and use (3.12) to obtain(6.9)E[∫τ∞Γy(t,supτ≤u≤tℓu*)dt|Fτ]=e−βτE[∫0∞e−βs(λαsPs+τ−c)ds|Fτ]+λ(αp+α−αs)e−βτE[∫0∞e−βsPs+τe−γsup0≤u≤s(ℓu+τ*)ds|Fτ]=e−βτ(λαsβ−δPτ−cβ)+λ(α+αp−αs)e−βτE[∫0∞e−βsPs+τeinf0≤u≤s(−γℓu+τ*)ds|Fτ].Therefore we may rewrite (6.7) in the equivalent form(6.10)E[∫0∞e−βsPs+τeinf0≤u≤s(−γℓu+τ*)ds|Fτ]=1λ(α+αp−αs)[Pτ(1−λαsβ−δ)+cβ].Now we make a guess for the solution and we try with(6.11)ℓt*=−1γln(a+bPt),for some positive a and b. In fact the left-hand side of (6.10) becomes(6.12)E[∫0∞e−βsPs+τeinf0≤u≤sln(a+bPu+τ)ds|Fτ]=E[∫0∞e−βsPs+τeln(inf0≤u≤s(a+bPu+τ))ds|Fτ]=E[∫0∞e−βsPs+τinf0≤u≤s(a+bPu+τ)ds|Fτ]=aE[∫0∞e−βsPs+τds|Fτ]+bE[∫0∞e−βsinf0≤u≤s(Ps+τPu+τ)ds|Fτ]=aPτβ−δ+bβE[∫0∞βe−βsinf0≤u≤s(PsPu)ds]=aPτβ−δ+bβκ,therefore (6.10) holds (cf. (6.5)).Now optimality of (6.8) follows from Proposition 5.5 if we show thatν¯*is admissible. Clearlyν¯*is{Ft}-adapted and left-continuous. Alsoν¯t*≤(−1γln(a)−y)∨0by monotonicity of ln  and b > 0. ThereforeE[∫0∞e−βtPtν¯t*dt]≤(−1γln(a)−y)∨0β−δ<∞by (3.11), and henceν¯*∈S.□The result of Proposition 6.1 is remarkable in its own right. In fact, to the best of our knowledge, it is one of the rare examples of explicit solution to a backward stochastic equation like (5.7) involving the function Γy(t, ·) (cf. (6.3)) not satisfying the classical Inada conditions.Remark 6.2Notice that ifβ−δ≥λ(αp+α),then a ≥ 1 (cf. (6.5)) and thereforeℓt*<0for any t ≥ 0 (cf. (6.6)). It thus follows from (6.8) thatν¯t*=0for all t ≥ 0, and this is in line with Proposition 5.3.In order to obtain explicitly the constant κ of (6.4), we now restrict the price P dynamics to the class of Lévy processes with no positive jumps.Proposition 6.3Assume that X is a Lévy process with no positive jumps if ζ > 0 and with no negative jumps if ζ < 0. Set(6.13)X˜u:=−δu+π(−ζ)u+ζXu,so thatPt=e−X˜t(cf.(2.1)), and denote byπ˜(·)the Laplace exponent ofX˜. Then the constant κ of(6.4)is(6.14)κ=ξ1+ξ,with ξ uniquely determined by the equationπ˜(ξ)=β.Starting from (6.4) we haveκ=E[einf0≤u≤τβ(X˜u−X˜τβ)]=E[e−X˜τβ−sup0≤u≤τβ(−X˜u)]=E[einf0≤u≤τβ(−X˜u)]=E[e−sup0≤u≤τβ(X˜u)]=ξ1+ξ,since−X˜τβ−sup0≤u≤τβ(−X˜u)∼inf0≤u≤τβ(−X˜u)in distribution by the Duality Theorem for Lévy processes, andsup0≤u≤τβ(X˜u)is exponentially distributed with parameter ξ, with ξ as defined above (cf. Bertoin, 1996, Ch. VII), due to the assumption of no positive jumps forX˜.□Similar findings in the case of positive and negative jumps might be obtained by using the results in Kou and Wang (2003) on double exponential jump diffusion processes.In the special setting of Section 6 we are able to provide a probabilistic representation of the value function (3.8).Proposition 6.5Letτβ−δand τβ be two independent, exponentially distributed random times with parametersβ−δand β, respectively. Then the value function(3.8)admits the representation(6.15)W(y)=y+λαγ(β−δ)−λ(αp+α−αs)γ(β−δ)E˜[e−γ(y+ν¯τβ−δ*)]+(λαsβ−δ−1)E˜[y+ν¯τβ−δ*]−cβE[y+ν¯τβ*],in terms of the optimal controlν¯*of(6.8)and the expectationsE[·],andE˜[·]under the equivalent martingale measure of(4.3).Recall (6.1), (6.2) and thatβ=r+λ. Then(6.16)W(y)=J^(y,ν¯*)=E[∫0∞e−βtλPt[αs(y+ν¯t*)+αγ−(αp+α−αs)γe−γ(y+ν¯t*)]dt−c∫0∞e−βt(y+ν¯t*)dt−∫0∞e−βtPtdν¯t*].By Lemma 3.8 and by introducing τβandτβ−δ,two independent, exponentially distributed random times with parameters β andβ−δ,respectively, arguments similar to those employed in the proof of Proposition 6.1 allow us to rewrite the terms on the right hand side of (6.16) as follows,λαsE[∫0∞e−βtPt(y+ν¯t*)dt]=λαsβ−δE˜[y+ν¯τβ−δ*];λαγE[∫0∞e−βtPtdt]=λαγ(β−δ);λ(αp+α−αs)γE[∫0∞e−βtPte−γ(y+ν¯t*)dt]=λ(αp+α−αs)γ(β−δ)E˜[e−γ(y+ν¯τβ−δ*)];cE[∫0∞e−βt(y+ν¯t*)dt]=cβE[y+ν¯τβ*];E[∫0∞e−βtPtdν¯t*]=(β−δ)E[∫0∞e−βtPtν¯t*dt]=E˜[ν¯τβ−δ*].Hence (6.15) follows after some simple algebra.□Notice that, if the processX˜of (6.13) has no negative jumps, the expectations in (6.15) may be evaluated (at least numerically). Indeed, recalling (6.8), (6.6) andPt=e−X˜t(cf. (2.1)), and letting τρbe an independent, exponentially distributed random time with arbitrary (positive) parameter ρ, we have(6.17)y+ν¯τρ*=y∨sup0≤u≤τρ(−1γln(a+bPu))=y∨[−1γln(inf0≤u≤τρ(a+bPu))](6.18)=y∨[−1γln(a+beinf0≤u≤τρX˜u)]=y∨[−1γln(a+be−sup0≤u≤τρ(−X˜u))]=:y∨(−1γln(a+be−M˜τρ−)),whereM˜t−:=sup0≤u≤t(−X˜u). Now, since−X˜has no positive jumps, thenM˜τρ−is exponentially distributed (cf. Bertoin, 1996, Ch. VII) with parameter ξ uniquely determined by the equationπ˜−(ξ)=ρ,whereπ˜−(ξ)is the Laplace exponent of−X˜at ξ (and clearly depends on the probability under which we are taking expectations,QandQ˜).Here we provide computer drawings of the optimal inventory level for spot prices driven by a geometric Brownian motion or by an exponential jump-diffusion process. In order to do that, we find the explicit form of κ (cf. (6.14)), needed to obtain the base inventory ℓ* (cf. (6.5) and (6.6)) and hence the optimal procurement strategy (6.8). Then we compare the optimal expected return of our model with that of a modified version of the classical newsvendor model.In the computer drawings below we assume the following parameters: the firm’s manager discount factorr=0.05,the initial inventory levely=0(in line with the initial condition of the newsvendor model), the parameter of the exponentially distributed demand timeλ=5,the unitary holding costc=1,the premium factors in the revenue multiplier G (see (2.5))α=1.2,αp=0.8,αs=0.7,the parameter of the exponentially distributed demandγ=0.05.As in Guo et al. (2011), we take(6.19){dPt=Pt(μdt+σdBt)P0=1,whereμ∈Rand σ > 0 are constants and {Bt, t ≥ 0} is an exogenous one-dimensional standard Brownian motion. ThenPt=exp{(μ−σ22)t+σBt},which is of type (2.1) withX:=−B,δ ≔ μ, ζ ≔ σ andπ(−ζ)=σ22. In this caseX˜u=(12σ2−μ)u−σBu,hence (cf. Proposition 6.3 and (6.14))(6.20)κ=E[e−sup0≤u≤τβX˜u]=θ+1+θ+,whereθ+is the positive root ofσ22x2+(σ22−μ)x−β=0(this is a well known result for a Brownian motion with drift). As shown in Fig. 1, the commodity is purchased at times at which the current inventory becomes lower than the base inventory ℓ* of (6.6).Since most spot prices exhibit significant skewness and kurtosis, they are not so well described by purely diffusive processes. Here we assume that the spot price evolves according to the jump-diffusion process(6.21){dPt=Pt−(μdt+σdBt+dMt)P0−=1,with μ and σ real constants, {Bt, t ≥ 0} an exogenous one-dimensional standard Brownian motion, anddMt:=∑j=1NtUj,where {Nt, t ≥ 0} is a Poisson process with constant intensity ψ ≥ 0, {Uj}j ≥ 0 is a sequence of i.i.d. random jumps with values in [0, ∞) and such thatU0=1a.s. Moreover, B, N, U are independent. Clearly this model includes deterministic growth models (forσ=0) and pure jump models (forσ=0and ψ > 0) (Fig. 2).The explicit solution of (6.21) isPt=exp{(μ−σ22)t+σBt}∏j=1Nt(Uj+1)=exp{(μ−σ22)t+σBt+∑j=1NtZj}whereZj:=ln(Uj+1)are i.i.d. HencePt=exp{−X˜t}whereX˜t:=−(μ−σ22)t−σBt−∑j=1NtZjis a Lévy process without positive jumps and with Laplace exponentπ˜(u)=σ22u2+(σ22−μ)u+ψ(E(e−uZ1)−1),for any u such thatE(euX˜t)<∞. If we take the Zj’s exponentially distributed with parameter l > 1, then we getπ˜(u)=σ22u2+u(σ22−μ−ψl+u),and by solving the equationπ˜(ξ)=βfor ξ, we may get κ (cf. (6.14)) and henceν¯*(cf. (6.6)).As it is shown in Fig. 2, the optimal inventory is kept equal or higher than the base inventory(6.6), and purchases take place only when the current inventory becomes lower than the base inventory.The newsvendor model is a classical model in the literature on inventory management (see, for example, Porteus, 1990). It studies the problem of controlling the inventory of a single item with stochastic demand over a single period, in the presence of overage and underage costs when the newsvendor orders too much or too little, respectively. The newsvendor aims to choose the size of a single order that maximizes the expected profit. As Guo et al. (2011) observe, the newsvendor model provides a solution for a firm’s manager who is not interested in repeatedly buying in the spot market, but who purchases the commodity only once at time zero (the so called ‘newsvendor procurement strategy’). Such strategy belongs to our set of admissible strategies (2.9). In the setting of this section (cf. beginning of Section 6), the firm’s total expected discounted return associated to the purchase of y units of commodity at time zero is given (cf. (2.6)) by(6.22)L(y):=E[e−rΘPΘG(y,D)−(1+cr(1−e−rΘ))y],and the newsvendor value function ismaxy≥0L(y).Recalling thatFD(z)=1−e−γz,γ > 0, simple calculations give that the optimal newsvendor procurement strategy isy*=max{0,FD−1(η)},whereη=(α+αp)E[e−rΘPΘ]−(1+cr(1−E[e−rΘ]))(α+αp−αs)E[e−rΘPΘ].Assuming the geometric Brownian motion of (6.19) withμ=0.7for the spot price, we use the probabilistic representation (6.15) to plot the difference between the value function V(0) (cf. (3.7) withy=0) and the newsvendor value function L(y*) as the volatility σ varies from 0.05 to 50 (see Fig. 3). Notice that when σ → 0 our value function V(0) tends to the newsvendor’s one L(y*). On the other hand, when the volatility increases, the optimal revenue starts rapidly becoming larger than the newsvendor revenue. That means, the more the market gets riskier the more profitable the optimal dynamic procurement strategy becomes.We have studied the optimal procurement problem of a firm aiming at meeting a random demand at a random time Θ. The firm buys inventory on a spot market and maximizes expected profits under exponential Lévy spot prices and general convex running holding costs. The problem is modeled as a monotone stochastic control problem in which the cumulative inventory up to time t is the control.We prove existence of an optimal procurement policy and we characterize it through stochastic first order conditions. As expected in singular stochastic control, it is optimal for the firm to invest in the spot market just enough to keep, at any time, the inventory level above a certain lower bound. In fact, in the present case the lower bound is the base inventory process, which is random and time dependent.In the case of linear holding costs and an exponentially distributed random demand, we obtain a closed form solution for the optimal procurement policy, which we use to provide computer drawings for two examples of exponential Lévy prices. In particular, for geometric Brownian motion prices Fig. 3 shows that, as the volatility increases, the optimal procurement strategy becomes more and more profitable than the static newsvendor’s one.The results of this paper are based on a quite recent and powerful stochastic first order condition approach, known in the mathematical finance literature (see, e.g., Bank & Riedel, 2001; Riedel & Su, 2011), but still rarely employed in the operational research context. In this sense our paper contributes to the literature on continuous time inventory management policies. The new method of solution provides new insights into the optimal procurement under Lévy prices and general convex holding costs.There are many directions in which it would be interesting to extend the present study as, for example, relaxing the independence assumption between prices and demand and introducing some form of correlation between them, or assuming diffusive dynamics also for the demand D (that would give raise to a daunting three-dimensional singular stochastic control problem in (Pt, Dt, Yt)). It would be also interesting to allow the firm to buy and sell in the spot market, i.e. to allow bounded variation stochastic controls. Finally, one could introduce fixed inventory ordering costs. That would naturally lead to a challenging impulse control problem in which a strategy of S–s type (see Porteus, 1990) is expected to be optimal. More drastically, one could try to drop the Markovian setting. In such case, the stochastic first order conditions might still hold, but it would be almost impossible to find explicit solutions.

@&#CONCLUSIONS@&#
