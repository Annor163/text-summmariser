@&#MAIN-TITLE@&#
A fully automatic computer aided diagnosis system for peripheral zone prostate cancer detection using multi-parametric magnetic resonance imaging

@&#HIGHLIGHTS@&#
A fully automatic CAD system is presented to detect prostate cancer using MRI.The reference standard was established using whole-mount pathological slices.A registration step was included to align MR datasets.The area under the ROC curve is 0.89 in discriminating normal from malignant voxels.A per-patient sensitivity of 97% is reached, with a median number of FP=3.

@&#KEYPHRASES@&#
Prostate cancer,Multiparametric MRI,Computer aided detection,Image analysis,SVM classifier,

@&#ABSTRACT@&#
Multiparametric (mp)-Magnetic Resonance Imaging (MRI) is emerging as a powerful test to diagnose and stage prostate cancer (PCa). However, its interpretation is a time consuming and complex feat requiring dedicated radiologists. Computer-aided diagnosis (CAD) tools could allow better integration of data deriving from the different MRI sequences in order to obtain accurate, reproducible, non-operator dependent information useful to identify and stage PCa. In this paper, we present a fully automatic CAD system conceived as a 2-stage process. First, a malignancy probability map for all voxels within the prostate is created. Then, a candidate segmentation step is performed to highlight suspected areas, thus evaluating both the sensitivity and the number of false positive (FP) regions detected by the system. Training and testing of the CAD scheme is performed using whole-mount histological sections as the reference standard. On a cohort of 56 patients (i.e. 65 lesions) the area under the ROC curve obtained during the voxel-wise step was 0.91, while, in the second step, a per-patient sensitivity of 97% was reached, with a median number of FP equal to 3 in the whole prostate. The system here proposed could be potentially used as first or second reader to manage patients suspected to have PCa, thus reducing both the radiologist's reporting time and the inter-reader variability. As an innovative setup, it could also be used to help the radiologist in setting the MRI-guided biopsy target.

@&#INTRODUCTION@&#
Multiparametric magnetic resonance imaging (mp-MRI) combines morphological and functional information and is being increasingly used to detect cancer. One of the most promising applications of mp-MRI is to detect prostate cancer (PCa) [1–3]. Current indications of mp-MRI include patients with rising levels of prostatic-specific-antigen (PSA) after one or more negative transrectal ultrasound guided (TRUS) biopsies [4,5]. One good reason why mp-MRI has not yet progressed to becoming a front-line imaging modality to detect PCa is because it is a labour-intensive examination and has a steep learning curve. Indeed, interpretation requires experienced radiologists capable of analysing data extracted from the different MR sequences [5,6].Computer aided detection (CAD) systems have the potential to support the radiologist by indicating suspicious regions and reducing oversight and perception errors [7]. In addition, some CAD applications have been shown to be time efficient [8]; however, this may be accomplished only if minimal or no human interaction is required in post-processing.The implementation of a fully automatic CAD system is not a trivial problem. Chan et al. first implemented in 2003 a CAD system for the diagnosis of peripheral zone (PZ) PCa, using a support vector machine (SVM) classifier [9]. Vos et al. [6] developed in 2012 a CAD scheme using multiple sequential steps, including initial blob detection on apparent diffusion coefficient (ADC) maps followed by a local feature analysis by a supervised classifier. Similarly, Niaf et al. [10] used a SVM classifier combined with a t-test feature-selection method, and achieved an area under the ROC curve (AUROC) equal to 0.82. Finally, Litjens et al. [5] included different stages in their CAD system, investigating a novel voxel classification step in combination with a candidate classification stage.None of the described studies has adopted a fully automatic registration step to align both the Dynamic Contrast Enhanced (DCE-MR) and the Diffusion Weighted (DW) to the T2-weighted (T2w) image. In this study, we present a fully automatic CAD system for PCa detection, which seeks to overcome the limitation of previous related works. Training and testing of the CAD scheme is performed using whole-mount histological sections as the reference standard.This was a single institution study. We enrolled all individuals that complied with the following inclusion criteria: (a) biopsy-proven prostate adenocarcinoma, (b) mp-MRI examination between April 2010 and November 2012, including axial T2w, DW, and DCE-MR sequences, (c) radical prostatectomy (RP) within 3 months of MRI, and (d) a clinically significant PZ lesion (tumour volume ≥0.5ml) [11] at the whole-mount histopathologic analysis. The local Ethics Committee approved the study and participants in the study signed informed consent forms. This study was in accordance with the Helsinki Declaration.Images were acquired with a 1.5T scanner (Signa Excite HD, GE Healthcare, Milwaukee, Wisconsin, USA) using a four-channel phased-array coil combined with an endorectal coil (Medrad, Indianola, Pa). Axial T2w images were obtained using the following protocol: slice thickness, 3mm; field of view (FOV), 16×16cm; NEX, 2; acquisition matrix, 384×288; reconstruction matrix, 512×512; TR/TE, 3020/85ms. DW imaging was obtained using axial Echo-Planar Imaging sequences as follows: slice thickness, 3mm; FOV, 16×16cm; acquisition matrix, 128×128; reconstruction matrix, 256×256; NEX, 6; TR/TE, 7000/101ms; b-values, 0 and 1000s/mm2. Finally, a 13s time resolution DCE study was performed, with an axial 3D Spoiled Gradient echo (SPGR) sequence using the following parameters: TR/TE/FA, 3.6ms/1.3ms/20°; FOV, 20×20cm; slice thickness, 3mm; acquisition matrix, 224×192; reconstruction matrix, 512×512. Scanning started simultaneously with the intravenous injection of 0.1mmol/kg gadobutrol (Gadovist, Bayer Schering, Berlin, Germany) through a peripheral line at 0.7ml/s, using a power injector (Medrad Spectris, Maastricht, The Netherlands), followed by infusion of 20cm3 normal saline at same rate. Twenty-six contrast-enhanced frames were obtained. The average time to complete the whole MR exam, including two additional T2w scans in the sagittal and coronal plane, was 40min. Overall imaging parameters satisfied the minimal scanning requirements [4].The prostate specimen was step-sectioned at 3mm intervals perpendicular to the long axis (apical-basal) of the gland [12]. This confidently reproduces the inclination of axial T2w images, which were acquired perpendicular to the rear gland surface. The bases and the apexes were cut parasagittally. Five μm sections were then obtained and coloured with hematoxylin eosin. The pathologist (E.B., with 24 years of experience in pathology, 20 attending uropathology) outlined each clinically significant peripheral tumour on microscopic slices and assigned a pathological Gleason Score (pGS). The radiologist (F.R., with an experience of more than 500 prostate mp-MRI studies interpreted per year for 6 years) in consensus with the pathologist, established the reference standard for PCa on T2w images drawing freehand regions of interest (ROIs) on cancer foci, following the outlines drawn by the pathologist on digital images of the pathologic slices. When pathological microslices and axial T2w images were not perfectly overlapped, usually due to modified prostate shape soaked by formaldehyde, the radiologist and the pathologist established the locations of tumours with respect to identifiable anatomic landmarks (e.g., adenoma nodule, urethra, ejaculatory ducts, and benign prostatic hyperplasia). If a lesion extended into more than one histopathologic slice, a ROI was drawn on each corresponding MR slice. For each patient a ROI, with extension similar to the tumoural region, was also drawn on normal gland located in the contralateral PZ.The pipeline of the CAD system is shown in Fig. 1; it is conceived as a 2-stage process. First, a parametric colour-coded map of the prostate gland is created; colours are assigned to the map based on the probability of each voxel to be cancerous (Fig. 1A). Then, a candidate segmentation step is performed to highlight suspected areas (Fig. 1B). Different fully automatic steps, thoroughly described in the following subsections, compose each of these stages. All methods are implemented using C++ and the ITK libraries [13].Image registration has been described in detail elsewhere [14]. Registration is an important step as it allows to correctly align different types of images so that features, derived from all the MR sequences and referring to the same pixel or group of pixels, may be compared and studied. Before applying the registration methods, both the DCE volumes and the DW images have been upsampled to the T2w image resolution, and the DCE volumes were also automatically cropped to match the same FOV of the T2w image. The algorithm first aligns DW to the T2w images, by applying a non-rigid registration step. In particular, the deformation field is modelled as a linear decay field along the vertical direction (1), assuming that the pixel shifts caused by magnetic field inhomogeneities occur particularly in the phase encode direction and decrease linearly with distance from the coil (1).(1)Ty=dl−k*y0<y<dik0y>dikMoreover, the DCE images are aligned to the T2w sequence using a multi-resolution rigid registration algorithm. In this case, the registration is solved as an optimization problem with the goal of finding the optimal transformation T:(x,y,z)→(x′,y′,z′) which maps any point in the moving DCE dynamic image sequence I(x,y,z,t) at time t into its corresponding point in the reference image I(x,y,z,t0), i.e., the T2w. The mutual information, which is a measure of statistical dependency between two datasets, has been used as similarity metric and the regular step gradient descent algorithm has been used as optimizer [14].The segmentation of the prostate is of key importance to reduce the computational burden of the CAD system. In our method we first automatically identify on each slice a rectangular region of fixed size (i.e., width=7cm, height=6cm). The rectangle is automatically generated in such a way that its posterior border is in contact with the anterior profile of the coil, which is segmented using the Hough transform on the T2w image. It may confidently enclose both a normal (size=4×2×3cm) and an enlarged prostate [15]. Then, we extract the ADC map on this rectangular region and we apply, on the selected region, the multi-level Otsu threshold [16], i.e., 3 levels. This method is able to select different threshold values by maximizing the between-class variance in a gray level image, thus separating the prostate from the darker background and the brighter coil. Once the thresholding has been applied, a 3-values map is provided, representing the three different classes.Finally, we select all voxels belonging to the second class, which represents the prostate, and we apply some morphological operations to fill holes, i.e. the darker voxels within the prostate, without enlarging the segmented prostate.For all the voxels belonging to the segmented prostate, we extract anatomical and pharmacokinetic features, as detailed below.One of the major issues complicating MR image analysis is the absence of standardized signal intensity values, like the Hounsfield units in computed tomography. This usually means that an algorithm will give different results as scanners, sequences or even sequence parameters change [5]. To reduce this potential limitation, in this study we adopt two standardized measurements.First, the pixel-wise ADC values are calculated with in-house C++ algorithms, developed using ITK open source libraries [13], by using a monoexponential model [17].Second, we normalize the T2w signal intensity by using the signal intensity of the obturator muscle, automatically segmented by our system as previously described [18]. However, before applying image normalization, we correct the image inhomogeneities by using a variant of the popular non-parametric non-uniform intensity normalization (N3) algorithm introduced by Tustison et al. [19], with the following parameters: FWHM=0.5, Wiener=0.1, convergence threshold=0.001.Before extracting any parameters, the curve S(t) was normalized to the first DCE volumes, as following detailed: (S(i)−S(0))/S(0), where S(i) is the signal intensity at time ith and S(0) is the signal intensity at time 0, i.e., the first DCE frame. Then some model-free features are derived from the normalized time-intensity curve S(t): (a) maximum uptake (MU), (b) time to peak (TTP), defined as the frame index at which the maximum enhancement occurs, (c) wash-in rate (WI) defined as MU/TTP, (d) washout rate (WO) defined as(2)WO=MU−StENDtEND−TTPwhere tEND is the time at the last contrast-enhanced volume, (e) area under the curve S(t) (AC), and (f) and area under the curve S(t) computed within the first 60s after the contrast agent injection (iAC).These parameters are related to the curve type method approach commonly used by the radiologists [4], however they have some limitations, i.e. they are scanner and patient dependent, and they do not use all information present in the curve S(t) [5].To overcome these limitations, we decided to extract the maximum number of information from DCE curves, exploiting different approaches in quantifying tissue perfusion [10,20].Therefore, we implemented both the well-known Tofts pharmacokinetic model to account for physiological parameters, and two empirical functions used to fit the normalized S(t) without making assumption on tumour physiology [21,22].Using the bicompartmental Tofts model [23] we extracted: (a) Ktrans, which is the transendothelial transport of contrast medium from vascular compartment to the tumour interstitium, (b) kep, which represents the transport parameter of contrast medium back into the vascular space, and (c) vp, which is the plasma volume fraction. To model the arterial input function we have used a literature-based function [24], while the conversion of MR signal to contrast concentration curve is performed according to Medved et al. [25], by using the signal intensity of the obturator muscle as reference tissue (T1=1026ms).Tofts pharmacokinetic model provides a better understanding of the interaction between contrast agent and tissues, but it suffers from complexity, because of the required conversion of MR signal intensities into contrast agent concentration. Therefore, the following two empirical functions have been also used to fit the normalized S(t): the Weibull function (3), and the Phenomenological Universalities (PUN) approach [22,26](4):(3)yweib(t)tEND=Atexp−tB(4)yPUN(t)=exprt+1βa0−rexpβt−1The nonlinear curve fitting has been solved in the least-squares sense with the Levenberg–Marquardt algorithm, starting from an initial guess estimated with a grid parameters search. Upper and lower bounds are also chosen to reflect physiological behaviour normally found in healthy and tumoural tissues [27]. Advantages of non-parametric techniques are: (i) no need to convert MR signals to contrast agent concentration, and (ii) the ability to analyse the whole enhancement curve cycle from wash-in to wash-out phases.Feature selection is a process of choosing a subset of original features to reduce dimensionality, remove irrelevant data, increase learning accuracy, and improve result comprehensibility [28]. To reduce the number of parameters, we use the feature selection method based on the correlation matrix. For each feature, we evaluate its ability in discriminating between normal and tumoural voxels, by measuring the AUROC curve (Table 1). Then, we compute the correlation matrix between the features, to detect which pairs are highly correlated. When a couple of features show a correlation ≥0.8, we discard the feature with the lower AUROC (Table 1). At the end of this step, for each voxel a 9-dimensional vector of features has been obtained, including ADC and T2w signal intensity, Ktrans of Tofts model, A and B of Weibull function, β of PUN model, AC, TTP, and WO. Finally, a voxel classification is performed, which results in a likelihood between 0 and 1 per voxel, 0 indicating no suspicion of PCa and 1 indicating very high suspicion of PCa.Some pilot experiments have been conducted to evaluate the best classifier, and its best setting. The SVM classifier [29], which uses the radial basis kernel, yielded the best results and has been therefore chosen over both the Bayesian and the Linear Discriminant Analysis classifier. Parameter C and γ have been set to 2 and 0.002, respectively, after performing, on a preliminary dataset, a “grid search” using cross validation. To speed up training, thereby shortening the time for model selection, we have implemented a sampling strategy, that selects a small portion of the training data, taking into account the differences due to the heterogeneity of the tumour between different slices. Therefore, a reduced training dataset has been created by sampling the dataset with a step size of 50 voxels.On the likelihood map obtained during the previous step, we apply the second stage of the CAD pipeline to extract 3D candidates highly suspected to be cancers and reduce the number of false positives (FP) voxels.First, voxels having probability higher than 60% to be malignant are extracted from the voxel-wise malignancy probability map, and connected regions with a size <100mm2 are discarded (see Fig. 2). This size represents 60% of the volume of the smallest clinically significant PCa, i.e. 0.5cm3[11], therefore it has been chosen in order not to discard tumours that might have been only partially segmented.Then, for each of the remaining voxels we compute the time-intensity curves from the DCE-MR dataset, previously smoothed with a median filter having kernel size of 11×11×0, and normalized to the first contrast-enhanced frame. Some heuristic criteria, inferred from a preliminary dataset, have been used to discard some voxels, thus reducing the number of FP: (a) MU between the 5th and 6th enhanced frame <1, (b) average signal intensity from the 12th and the last contrast-enhanced frame <1, and (c) increase or decrease of the signal intensity (ɛ)>60%, computed as(5)ε=S¯tEND,tEND−1−S¯t4,t5S¯t4,t5whereS¯(tEND,tEND−1)s the average of the signal intensity of the last and the second to last contrast-enhanced frame, andS¯(t4,t5)is the average of the signal intensity of the 4th and the 5th contrast-enhanced frame.To evaluate the performance of the system we used the leave-one-out method (LOO), which involves training on all but one case, estimating the likelihood of malignancy of the pixels belonging to the left-out patient, and repeating the procedure until each case has been tested individually. Both the voxel classification and the candidate selection steps have been evaluated.The ROC analysis was used to evaluate the ability of the system in discriminating between normal and malignant tissue. Since the LOO strategy has been used, the median value of the AUROC, the median sensitivity and the median specificity have been provided.The ROC analysis, however, misses information about the number of FP candidates. Therefore, the method may have a high discriminative performance though it presents many FP candidates. Therefore, for the candidate selection step, we provided the per-lesion and per-patient sensitivity, and the number of FP in both the peripheral zone and the whole prostate for each patient. A 3D connected region was considered a true positive (TP) if the segmentation lays within the ROI drawn by the radiologist, vice versa it was considered a FP. We evaluated the system both for the detection of all tumours and the detection of high-grade tumours (pGS≥7).

@&#CONCLUSIONS@&#
