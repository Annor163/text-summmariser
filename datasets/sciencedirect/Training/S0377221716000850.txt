@&#MAIN-TITLE@&#
Queue length estimation from probe vehicles at isolated intersections: Estimators for primary parameters

@&#HIGHLIGHTS@&#
Stochastic models for queue lengths at isolated intersections are derived.Cycle-to-cycle and steady-state behavior of primary parameter estimators are given.Estimators use location, time, and count information from probe vehicles.Cycle-to-cycle errors for queue length estimations are presented.Models are evaluated using VISSIM microscopic simulations.

@&#KEYPHRASES@&#
Point estimation,Probe vehicles,Traffic signals,Queue length,Maximum likelihood,

@&#ABSTRACT@&#
This paper develops estimators for market penetration level and arrival rate in finding queue lengths from probe vehicles at isolated traffic intersections. Closed-form analytical expressions for expectations and variances of these estimators are formulated. Derived estimators are compared based on squared error losses. Effect of number of cycles (i.e., short-term and long-term performances), estimation at low penetration rates, and impact of combinations of derived estimators on queue length problem are also addressed. Fully analytical formulas with unknown parameters are derived to evaluate how queue length estimation errors change with respect to percent of probe vehicles in the traffic stream. Developed models can be used for the real-time cycle-to-cycle estimation of the queue lengths by inputting some of the fundamental information that probe vehicles provide (e.g., location, time, and count). Models are evaluated using VISSIM microscopic simulations with different arrival patterns. Numerical experiments show that the developed estimators are able to point the true arrival rate values at 5% probe penetration level with 10 cycles of data. For low penetrations such as 0.1%, large number of cycles of data is required by arrival rate estimators which are essential for overflow queue and volume-to-capacity ratios. Queue length estimation with tested parameter estimators is able to provide cycle-to-cycle errors within ±5% of coefficient of variations with less than 5 cycles of probe data at 0.1% penetration for all arrival rates used.Queue length (QL) is an important measure for the performance of signalized intersections which can be used to estimate delays and travel times (Feng, Head, Khoshmagham, & Zamanipour, 2015; Gartner, Pooran, & Andrews, 2002; Lee, Wong, & Li, 2015; Mirchandani & Zou, 2007). The models based on these traffic parameters can be utilized for control, design, and planning purposes where the accuracy of such models becomes important. This study focuses on the estimation of low level-primary parameters for queue length models from probe vehicles (PVs) (i.e., vehicles equipped with tracking technologies). Simple analytical closed-form expressions are developed for parameter estimators and queue length estimations (QLE) by deriving probability distributions of basic PV information types (e.g., count, location, and time). Cycle-to-cycle and steady-state behavior of parameter estimators, QLs, and their errors are formulated based on the works of Akçelik (1980) and Viti (2006). The models are evaluated with a microscopic simulation environment-VISSIM. Additional results are presented to the author’s previous work. In these studies, QL estimators are developed using location and time information with known parameters (Comert, 2013b; Comert & Cetin, 2009, 2011) and the effect of incorporating stop-line detection into the estimations is formulated (Comert, 2013a). This research specifically provides ability to estimate real-time queue lengths at isolated intersections, intersections with moderate to low volume-to-capacity ratios, or wherever Poisson arrivals can be assumed. Several estimators for arrival rate λ and market penetrate rate p parameters are derived that only assume simple information from probe vehicles. Single cycle and multi-cycle performance of the estimators are also presented. The study gives detailed insights about the distributions of PV information types that can be utilized for more complex models (e.g., multilane intersections) and estimating delays for signal control parameters. The results can also possibly be used as input for queue lengths/delay approximations in new signal control strategies (Comert, Cetin, & Nichols, 2009; Goodall, Smith, & Park, 2013; Smith et al., 2010).The ultimate research problem investigated in this study can simply be explained as estimating the total queue length N given the information from PVs (i.e., the number of probes in the queue, locations, and queue joining time instants). The estimation error of this conditional expectation from the actual N is derived. For a basic illustration, Fig. 1shows a snapshot of a signalized intersection approach at the end of red phase (R) in any given cycle (C). Solid cars in the figure represent PVs. For simplicity, locations of vehicles in the queue are measured in terms of number of vehicles (i.e., order of a vehicle in the queue).Despite the fact that the fixed time signal phase lengths are used in the examples for the models, they can be applied to varying phase durations. From the practical view, developed estimators can be used for fixed or variable red phase lengths or any time interval that contains stopped probe vehicles as the PV data can be obtained with a snapshot of the intersection at the end of red or cycle duration. Therefore, R in the formulas can be replaced by the time of estimation synced by the signal. Developed models can also be used in multilane settings given the ability of which lane level detection for probe vehicles. Then, utilizing them for finding maximum queue lengths, determining the signal timing, average overall queue length, and delay. The following notation is used throughout the paper:R and CRed and cycle durations respectively.Number of PVs in the queue (e.g., 3 in Fig. 1).the location (or the spot) of the last PV (e.g., 8) in order of vehicles from stop-bar.The time instant at which the last PV joins the back of the queue (e.g., 35 seconds that is 8th vehicle (the last probe) joins the back of the queue 35 seconds after the red duration begins timing).The queue joining time of the last PV in the overflow queue.The total QL that is estimated in real-time at the end of red phase based on PV information.The overflow queue which cycle-to-cycle overflows, i.e., queue at the beginning of red duration.Queue from the new red duration arrivals.Queue until the location of the last probe vehicle (up toL=l).Queue after the location of the last probe vehicle (between R and T).The difference between the actual queue length and the estimated queue length.The decision function or estimator of a parameter.Arrival rate in unit vehicle per second (vps).Probe proportion level(0 ≈ p ≤ 1), θ =(1−p)λis arrival rate of nonprobe vehicles which is used for simplicity in the derivations.The capacity, e.g., 24 vehicles per cycle.Volume-to-capacity ratio 0 < ρ ≈ 1,λCX.Coefficient of variation,V(D)/E(N)For simple analytical models, the point queue model is assumed where waiting lane has infinite capacity and vehicles can accelerate and decelerate instantaneously. However, all developed models are evaluated using VISSIM which provides microsimulations with realistic vehicle movements and queuing dynamics. In addition, as described in Appendix E, different lengths of intersection approaches and random seeds facilitate evaluation of developed models under close to real data processing scenarios and arrival patterns. VISSIM estimation errors are calculated by recording vehicle data from the simulation and processing them in Excel Visual Basic for Applications (VBA). Apart from obvious horizontal versus vertical queuing, some discrepancies are expected among VISSIM, point queue simulations in C++, and analytical evaluations due to:(i)The car following in VISSIM, for a long approach lane vehicles tend to form bunches as they move downstream which makes the arrival profile not exactly Poisson (Viti, 2006).The arrival pattern difference can also be viewed as an advantage since VISSIM evaluations show under which scenarios analytical models are accurate since platoon arrivals are expected at closely spaced intersections.The number of runs in VISSIM are relatively low to express true steady-state behavior.In queue definition is not optimized here. Default values are used in VISSIM (see Appendix E).VISSIM estimations use discrete time values in seconds for T where analytical formula takes continuous time random variables.VISSIM simulations involve the information process of identifying probe vehicles, their identities, and tracking them until discharged from the intersection similar to Hao, Ban, Guo, and Ji (2014).Other assumptions in the paper include that the arrivals follow a Poisson distribution, vehicles accumulate in a vertical (point) queue, and PVs are able to accurately provide their locations and queue joining time information (timestamps). Poisson distribution is commonly utilized to describe arrivals at isolated intersections and the vehicles accumulate in a vertical (point) queue (Boon, Adan, Winands, & Down, 2012; Kang, 2000; Lu & Yang, 2014; Mirchandani & Zou, 2007; Zheng, 2011). Limitations for Poisson models are discussed in these references. In summary, it is stated that the arrivals are correctly modeled to an isolated intersection for low volume-to-capacity ratios typically ρ ≤ 0.70 for single channel traffic (Newell, 1982). For two or more lanes with allowed overtaking, Poisson arrivals can also be considered as an arrival process (Buckley, 1962). Furthermore, theoretical attractiveness of the Poisson arrival assumption is discussed in other fields (e.g., Paxson & Floyd, 1995) where relatively lower demand processes of connection arrivals and user generated File Transfer Protocols (FTP) are shown to be well-modeled by Poisson distribution. In another computer network modeling application, Poisson arrivals of packets to nodes are found to be suitable (Cantieni, Ni, Barakat, & Turletti, 2005; Garetto & Chiasserini, 2005). Likewise, the results presented here are also applicable to those cases where vehicle arrivals can be described by a Poisson model. The assumption certainly limits the applicability. However, the study aims to show closed-form equations. Derived models can be used as simple decision tools under given assumptions. They can also be used as references in the formulations for complex intersections.Even though locating vehicles on a link is assumed to be satisfied possibly with differential GPS (DGPS) systems (Du & Barth, 2008; Herrera & Bayen, 2010; Patire, Wright, Prodhomme, & Bayen, 2015; Qing, Bertini, Lint, & Hoogendoorn, 2011), current accuracy may not be sufficient for field implementations especially in which lane level. Suppose that the position and the time of a vehicle waiting on the link are accurately known, the number of vehicles ahead of the observed vehicle can be estimated by an average length/spacing per vehicle. The concept of using average or effective vehicle length is common in estimating density and speed based on occupancy (i.e., percentage of time the detector is occupied/activated) measured by inductive loop detectors (e.g., Dailey, 1999; Hellinga, 2002; Coifman & Kim, 2009; Li, 2010). Although identical type is assumed, multiple vehicle classes can be incorporated to the models by selecting the average vehicle length to be representative of different vehicle types. Multiple vehicle classes could also be added through specifying arrival rates for each vehicle type. Most certainly, processing the probe data in real life implementations can get very complex. Determination of whether a PV is in the queue or not (i.e., waiting or moving) is partially dealt with in VISSIM simulations (see Appendix E). This is usually decided by vehicle speed, acceleration and selected thresholds (e.g., Quiroga & Bullock, 1998). The paper also does not discuss information flow architecture and the exact nature of data processing needed to obtain the location or the time of PVs in the queue. However, with connected vehicle testbeds, there is a growing interest on addressing specific protocols, secure vehicle identification, the packet drop rates, effective market penetration rates, and signal fading effects through micro and macro vehicle communication network simulations (Su, Lee, & Park, 2016). These factors as well as latency and high accuracy are especially important for safety critical applications.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
In this paper, stochastic models for queue length estimation with unknown primary parameters from PVs at traffic intersections are derived. Developed models use only primary signal parameters and probe information. Several alternatives for arrival rate λ and probe proportion p are given asλ^1=m/pR,λ^2=l/R,λ^3=l/t,λ^4=(l−1)/t,λ^5=l/(t+p(R−t)),λ^6=(l−m)/t+m/Randp^1=m/(λR),p^2=m/l,p^3=1/(λ(R−t)),p^4=t/[(R−t)(l−1)],p^5=mt/(mt+(l−m)R). Numerical results show thatλ^4andλ^6provide the lowest errors for all true λ tested for p ≤ 5% levels with 10 cycles of data. For probe proportion, estimatorsp^2andp^5are found to be better alternatives. Instead, simple biased onesp^2andλ^2can be used for any true p and λ values after p > 5%. For low p values such as 0.1%, large number of cycles of data is required byλ^s which are essential to estimate overflow queue and volume-to-capacity ratios. Estimators for p do not demand these conditions. When there is no probe in the queue simplyp^= 0. They are able to point true p at low penetration levels. Performance of the estimators for multiple cycles of data is also discussed whenever no probe information is available. Cycle-to-cycle queue estimators are able to capture the exact errors within ±5% of coefficient of variations with less than 5 cycles of probe data at p = 0.1% for all λ levels. The differences further reduces as p increases. Especially for high ρ values, estimators follow true values closely as likelihood of a probe vehicle being in the queue is greater. Some of the future work can be listed as evaluating other possible estimators, and different arrival distributions.