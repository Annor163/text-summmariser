@&#MAIN-TITLE@&#
Theoretical and empirical estimates of mean–variance portfolio sensitivity

@&#HIGHLIGHTS@&#
Closed-form formulas for estimation errors of Markowitz portfolio weights.Relative impact of mean estimation error is market specific and easy to estimate.Efficient bootstrap-based method for empirical assessment of estimation errors.

@&#KEYPHRASES@&#
Investment analysis,Asset allocation,Mean–variance portfolio,Estimation error,Bootstrap,

@&#ABSTRACT@&#
This paper studies properties of an estimator of mean–variance portfolio weights in a market model with multiple risky assets and a riskless asset. Theoretical formulas for the mean square error are derived in the case when asset excess returns are multivariate normally distributed and serially independent. The sensitivity of the portfolio estimator to errors arising from the estimation of the covariance matrix and the mean vector is quantified. It turns out that the relative contribution of the covariance matrix error depends mainly on the Sharpe ratio of the market portfolio and the sampling frequency of historical data. Theoretical studies are complemented by an investigation of the distribution of portfolio estimator for empirical datasets. An appropriately crafted bootstrapping method is employed to compute the empirical mean square error. Empirical and theoretical estimates are in good agreement, with the empirical values being, in general, higher.

@&#INTRODUCTION@&#
The mean–variance framework, introduced by Markowitz (1952), opened a new era in asset management. The selection of optimal portfolio was formulated as seeking a balance between the risk, measured by the variance of the portfolio return, and the gain, measured by the expectation of the return. A mean–variance investor maximizes the objective function (utility)(1)B(w)=μTw-γ2wTΣw,where w denotes portfolio holdings specified in terms of fractions of the wealth, and the constant γ>0 is the investor’s risk aversion parameter. It is assumed implicitly that future excess returns of risky assets have a known multidimensional distribution with the vector of means denoted by μ and the covariance matrix denoted by Σ. This assumption is not satisfied in practice. Estimation of parameters of future asset returns is an essential step in the application of the mean–variance paradigm in practical finance. The impact of estimation errors on the Markowitz optimization procedure has been intensively studied for over 30years. The literature can be split into two areas. The first one is concerned with the performance of the estimated portfolio, e.g., the loss of utility, i.e., the difference between the value of the objective function for the true optimal portfolio and its estimate (see Frost & Savarino, 1986; Kan & Zhou, 2007). The second area studies statistical properties of portfolio estimators.Our paper belongs to the strand of literature which directly addresses the distribution of the optimal portfolio estimator. The first result in this direction is due to Dickinson (1974), who finds approximate confidence intervals for portfolio weights in a two-asset framework. These results are extended by Jobson and Korkie (1980), who derive approximate asymptotic distributions of the Sharpe efficient portfolio (the tangency portfolio). Monte Carlo verification of these results shows that the expectations of the computed asymptotic distributions are close to the finite sample quantities whereas the variances and covariances are burdened with a significant error. Statistical tests based on finite-sample distributions, in the model without a riskless asset, are collected in Jobson and Korkie (1989), and Britten-Jones (1999).A view from a different angle on the stability of portfolio weights is promoted by Best and Grauer (1991a, 1991b). Their analytical formulas estimate the change of optimal portfolio weights caused by a deterministic perturbation of the mean of asset returns. They show that the sensitivity of portfolio weights to the changes in asset means depends not only on the smallest eigenvalue of the covariance matrix but also on the ratio of the largest to the smallest eigenvalue. We extend these results by studying the effect of the estimation errors of the mean and covariance matrix given by their exact sample distributions, instead of fixed perturbations.This paper approaches the estimation of portfolio weights with three main questions in mind: How to measure errors of a portfolio estimator so that the performance of various estimators can be easily compared? What are the main sources of estimation errors? And finally, what is the influence of the estimator of the covariance matrix on the stability of the portfolio estimator?We take a view of an investor who rebalances his portfolio regularly following recommendations given by a solution to the mean–variance optimization problem with the mean of excess returns and their covariance matrix estimated from market data. Such an investor either follows the recommendations blindly or employs statistical tests to detect times when the rebalancing of portfolio is necessary due to a change of the asset return distribution. Portfolio estimation errors cause unnecessarily large and frequent trading and blow up confidence intervals for portfolio weights lowering the power of statistical tests of portfolio optimality. The stability of the optimal portfolio estimator is, therefore, of paramount importance. We design a measure that combines errors of separate portfolio weights into a single number: we take the expected squared distance of the estimated portfolio from the optimal one. Despite its simplicity, this measure provides a good proxy for the variability of separate weights. Empirical tests for a number of practical datasets show that this measure is proportional to the average size of confidence intervals for single weights. It is also closely related to the turnover which is proportional to the transaction costs levied on an investor rebalancing the portfolio on a regular basis.1We use the framework for portfolio rebalancing and the definition of turnover presented in DeMiguel, Garlappi, and Uppal (2009).1This paper makes three contributions. The first contribution is the derivation of closed-form formulas that relate the stability of portfolio estimator to the mean and the covariance matrix of asset returns (analogous formulas in the model without a riskless asset can be derived from results in Mori, 2004; Okhrin & Schmid, 2006). Our results rely on finite sample distributions of the mean and covariance estimators. Using exact distribution of portfolio weights, we are able to extend the findings of Best and Grauer (1991a, 1991b). Their sensitivity analysis revealed important culprits of the portfolio weight instability: the smallest eigenvalue of the covariance matrix and the ratio of the largest to the smallest eigenvalue. We show that this relation is more intricate and depends on the whole spectrum of the covariance matrix as well as on the vector of the means.Our second contribution is the quantification of the impact of estimation errors of the means on the portfolio weights. It is a common wisdom that the means play the main role in the destabilization of the portfolio weights (see Best & Grauer, 1991a, 1991b, 1992). Chopra and Ziemba (1993) claim that “errors in means are 11 times as damaging as errors in variances and over 21 times as damaging as errors in covariances”. This view is further supported by DeMiguel et al. (2009). In our extensive study of eight datasets2Six datasets of stock prices come from Kenneth French’s data library. Two datasets comprise bond market data, the courtesy of Merrill Lynch & Co.2ranging from domestic to international bond and stock markets with as few as 5 assets to as many as 17 assets, estimation errors of the covariance matrix account typically for 14% of the variability of portfolio weights with weekly sampling and 28% with monthly sampling of historical prices (and these quantities are independent of the number of samples).3These values were obtained under the assumption that the Sharpe ratio of the market portfolio equals 1. If this Sharpe ratio is lowered to 0.5, estimation errors of the covariance matrix account for around 7% (weekly sampling) and 15% (monthly sampling) of portfolio weights variability.3This implies that the improvement of the sample mean estimator, for example, by shrinkage or Bayesian techniques (see Jorion, 1991; Kan & Zhou, 2007), must still leave a great deal of instability in the Markowitz optimization procedure (empirical results supporting this view can be found in DeMiguel et al., 2009).A by-product of our analysis is the observation that the relative impact of estimation errors of the covariance matrix on the variability of portfolio weights is market specific. The main driving forces are the Sharpe ratio of the market portfolio and the frequency of asset price sampling. The fraction of the variability of portfolio weights caused by the covariance matrix estimation errors is well approximated by a parameter (CCF) which is a function of the market portfolio’s Sharpe ratio, the sampling frequency and the sample size.Our third contribution is the assessment of the impact of assumptions about asset returns distribution on properties of portfolio weights estimator. Our theoretical results require that asset returns are serially independent and multivariate normally distributed. These assumptions are common in statistical literature on portfolio estimators, but they have been heavily criticized for decades (especially for higher sampling frequencies of returns, see, e.g., Fama, 1965; Pagan, 1996; McNeil, Frey, & Embrechts, 2005). Using the block bootstrap methodology (Härdle, Horowitz, & Kreiss, 2003), we explore the empirical distribution of the portfolio estimator. This method preserves not only the marginal distribution but also the serial correlation in the time series of asset returns. Surprisingly, the unrealistic distributional assumptions have very limited effect on the results on portfolio weight stability: empirical and theoretical computations are generally in good agreement.The rest of the paper is organized as follows. In Section 2, we present the mean–variance optimization framework and estimators of the mean and covariance matrix of asset returns. In Section 3, we introduce a measure of stability of portfolio weights and derive exact analytical formulas quantifying this stability. These results and their conclusions are verified by empirical studies in Section 4. In the Electronic Supplement, Section A quotes less known statistical results required for the proof of the main theorem in Section B. Section C provides details about the data used in empirical studies.The market comprises p risky assets and a riskless asset. Future excess returns of the risky assets, i.e., the returns over the return of the riskless asset, are modeled by a normally distributed vector R=(R1,…,Rp)Twith the expectation μ and the non-singular covariance matrix Σ=[σij]. An investor describes his portfolio by a vectorw=(w1,…,wp)T∈Rpof fractions of the total capital invested in risky assets. The proportion1-wT1, where1is the vector of ones, is invested in the riskless asset. The expected excess return of the portfolio equals μTw and its variance is wTΣw. According to Markowitz mean–variance framework, an investor looks for a portfolio that balances the return with the risk, see (1). In the present setting this leads to the maximization of the objective functionB(w)=μTw-γ2wTΣwover portfolio weightsw∈Rp. This problem has a unique solution:(2)w∗=1γΣ-1μ.In practice, true moments of the distribution of future excess return R are unknown to investors and are estimated from the market data. The data from time 0 to T is used for the estimation and the time from T to T+1 is the investment period, i.e., the time is measured in units equal to the length of the investment period. Let n+1 be the number of equidistant sampling times: 0,Δ,2Δ,…,nΔ, where Δ=T/n. Denote by rithe logarithmic return over period [(i−1)Δ,iΔ], i=1,…,n. Assume that returns are multivariate normally distributed N(Δμ,ΔΣ) and independent. The mean and the covariance matrix of R (per unit time) are approximated via maximum-likelihood estimators:(3)μˆΔ=1nΔ∑t=1nrt,(4)Σ^Δ=1nΔ∑t=1n(rt-μˆΔ)(rt-μˆΔ)T.Theorem 3.2.2 in Anderson (2003) implies that the estimatorμˆΔis normally distributed N(μ,Σ/(nΔ))=N(μ,Σ/T) and independent fromΣ^Δwhich has a Wishart distribution1nWp(Σ,n-1).The sample mean (3) and the sample covariance matrix (4) are the building blocks of estimators of optimal portfolio weights discussed in the next section.In this section we present theoretical results on statistical properties of estimated portfolio weights. Unlike the papers by Mori (2004) or Okhrin and Schmid (2006), we do not provide the full covariance matrix of the portfolio weight estimator (although it can be computed using similar methods). Instead, we study a simpler quantity (the MSE introduced below) which is a single number allowing for straightforward comparison between estimation methods and, as we show in Section 4, offers a good proxy for the variability of portfolio weights.Mean square error is a well-established method of measuring the statistical error (see, e.g., Hocking, 2003 and, in the context of mean–variance portfolio theory, Broadie, 1993). In the framework of portfolio optimization the mean square error is given by the formulaMSE(wˆ)=E{‖wˆ-w∗‖2},where w∗ is the optimal portfolio (see (2)),wˆis the estimated portfolio and‖w‖=(∑i=1pwi2)1/2denotes the Euclidean norm. The average (expectation) is taken over the distribution of the data sample used for the estimation of the mean and the covariance matrix. The MSE measures the sensitivity of the optimization procedure to the estimation errors: a high value corresponds to a low precision of the portfolio weights estimates.The mean square error can be decomposed into a sum of two terms:MSE(wˆ)=E{‖wˆ-Ewˆ‖2}+‖Ewˆ-w∗‖2.The first term is the sum of variances of the portfolio weights estimatorwˆ, i.e., the trace of the covariance matrix ofwˆ(Mori (2004) and Okhrin & Schmid (2006) derive formulas for this covariance matrix in the case without a riskless asset). The second term of the above formula is the squared norm of the biasEwˆ-w∗. We will restrict our attention to unbiased estimators, hence this term will vanish.There are many methods (e.g., APT or the Black–Litterman approach) that deliver estimators of the mean of future returns which are much more stable than the maximum-likelihood estimatorμˆ. An insight into improvements these methods can offer for the stability of portfolio weights is gained by studying the portfolio optimization problem of an investor who knows the true future expected returns vector μ and uses past returns to estimate the covariance matrix only.An unbiased estimator of the optimal portfolio weights, provided the true mean is known and the covariance matrix is approximated via maximum-likelihood estimator, is given by the formula (see Theorem B.1 in the Electronic Supplement)wˆμ=1γn-p-2n(Σ^Δ)-1μ.The factorn-p-2nremoves the bias from the estimatorΣ^Δ-1of the inverse of the sample covariance matrix. Theorem B.1, in the Electronic Supplement, implies the following formula for the mean square error of the above estimator:(5)MSE(wˆμ)=n-p(n-p-1)(n-p-4)‖w∗‖2+1γ2n-p-2(n-p-1)(n-p-4)tr(Σ-1)μTΣ-1μ.This error decreases to zero as the number of samples n grows to infinity, but it is independent of the sampling time interval Δ. By decreasing Δ and increasing n, one can makeMSE(wˆμ)arbitrarily close to zero. Unfortunately, for high sampling frequencies (small Δ) the serial correlation of empirical returns increases and their distribution diverges from the normal distribution (see, e.g., Fama, 1965; McNeil et al., 2005, Chapters 3 & 4), which invalidates not only the above formula but also the estimation procedure of parameters of future returns.If the mean–variance optimal portfolio is computed with the mean and the covariance matrix estimated from market data, an unbiased estimator of the optimal portfolio weights is given by the formula(6)wˆ=1γn-p-2n(Σ^Δ)-1μˆΔ.The mean square error for this estimator is provided by the following expression (see Theorem B.1 in the Electronic Supplement):(7)MSE(wˆ)=n-p(n-p-1)(n-p-4)‖w∗‖2+1γ2n-p-2(n-p-1)(n-p-4)tr(Σ-1)μTΣ-1μ+(n-p-2)2γ2nΔ(n-p-1)(n-p-4)tr(Σ-1)1+pn-p-2.The sum of the first two terms of the above formula is equal to the mean square error for a portfolio estimator using the true mean. The third term combines errors due to the use of the estimated mean. Notice that this term sees hardly any improvement when the frequency of sampling is increased (Δ is decreased and n is increased) since, approximately (for large n), it equals1γ2nΔtr(Σ-1)=1γ2Ttr(Σ-1).To compute the mean square error, formulas (5) and (7), one has to know the true parameters of future returns as well as the true optimal portfolio. These are liable to large estimation errors and, in effect, result in imprecise estimates of the mean square error. In this subsection we show that the mean μ of the future returns and the true optimal portfolio w∗ can be replaced by appropriate statistics for the market portfolio (which are much easier to compute from market data).In an ideal situation, when all investors assume the same parameters of the future returns distribution and use the mean–variance criterion for choosing their portfolios (possibly with different risk-aversion coefficients), the mutual fund theorem implies that they divide their wealth between the market portfolio wm(also called the tangency portfolio) and the riskless asset. Denote by γm>0 the market risk aversion (the risk aversion for which wmis the optimal portfolio, i.e., the investment in the riskless asset is nil). It is then easy to verify that the following identities hold:μ=γmΣwm,w∗=γmγwm,andμTΣ-1μ=γm2wmTΣwm.Inserting these values into (5) gives(8)MSE(wˆμ)=γm2γ2n-p(n-p-1)(n-p-4)‖wm‖2+n-p-2(n-p-1)(n-p-4)tr(Σ-1)wmTΣwm.The mean square error is proportional to the squared ratio of the market risk aversion and the investor’s risk aversion. The first term depends on the number of risky assets, the number of samples and the norm of the market portfolio. In practical applications the market portfolio has non-negative weights (see Litterman, 2003, Chapter 8), which implies ∥wm∥⩽1. The second term depends on the variance of the market portfoliowmTΣwmand the trace of the inverse of the covariance matrix (the sum of inverses of eigenvalues of Σ).The mean square error (7), when both parameters of future returns are estimated from the data, can be written in the following way:(9)MSE(wˆ)=MSE(wˆμ)+(n-p-2)2γ2nΔ(n-p-1)(n-p-4)tr(Σ-1)1+pn-p-2.The additional term depends only on the trace of the inverse of Σ, being independent of the properties of the market portfolio.Assume first that assets are independent and, without loss of generality, ordered from the most to the least risky. The covariance matrix has its eigenvalues, from the largest λ1 to the smallest λp, on the diagonal and zeros off diagonal. The first term of the formula (8) depends on the market portfolio composition and the sample size. The covariance matrix affects only the second term which can be rewritten in the following way:(10)γm2γ2n-p-2(n-p-1)(n-p-4)tr(Σ-1)wmTΣwm=γm2γ2n-p-2(n-p-1)(n-p-4)∑i=1p1λi∑i=1pwm,i2λi.First two factors do not depend on the covariance matrix. The third factor is mostly determined by the inverses of smallest eigenvalues. The last factor is a sum of the eigenvalues multiplied by the squares of portfolio weights. The main contribution to this value comes from the products of large eigenvalues and portfolio weights. A wide range of eigenvalues should therefore lead to a high mean-square error. Indeed, one has∑i=1p1λi∑i=1pwm,i2λi⩾wm,12λ1/λp. This shows that the ratio of the largest to the smallest eigenvalue is one of the driving factors of the mean-square errorMSE(wˆμ).4The valuewm,12λ1/λpis of the same order of magnitude as(∑i=1p1λi)(∑i=1pwm,i2λi)if ∣wm,1∣ is not significantly smaller than the absolute value of weights of other assets in market portfolio. Otherwise, one finds such an asset j for whichwm,j2λjassumes the largest value. Then the quantitywm,j2λj/λpprovides a good approximation (and a lower bound) for the product∑i=1p1λi∑i=1pwm,i2λi.4The above analysis can be extended to a model with dependent assets. To this end, we rewrite the expressiontr(Σ-1)wmTΣwmin the eigenbasis of Σ:tr(Σ-1)wmTΣwm=trΣD-1wDTΣDwD,where ΣDis a diagonal matrix of eigenvalues of Σ and wD=V wmis the market portfolio in the eigenbasis of Σ with V denoting a matrix composed of the eigenvectors of Σ. Therefore, a lower bound fortr(Σ-1)wmTΣwmhas the formwD,12λ1/λp. This formula is similar to the one derived for the model with independent assets. The difference is only in that the square of the first coordinate of the market portfoliowm,12is replaced by the first coordinate of the market portfolio expressed in the eigenbasis of the covariance matrixwD,12.It is quite common in practical applications to encounter covariance matrices with eigenvalues differing by a few orders of magnitude. This property, not the absolute size of the eigenvalues, destabilizes the estimation procedure of the portfolio weights with the known mean. Examples of such unstable models comprise bonds (low volatility and highly correlated assets) and medium to large-size portfolios of stocks (high volatility and low correlation of assets).In this section we investigate properties of the optimal portfolio estimator for a number of empirical datasets. In particular, we compare theoretical results derived under assumptions of normality and serial independence of asset returns with the ones obtained for empirical distributions.Datasets considered in this section (see Table 1) can be divided into three groups:•US equity market – industry indices (datasets 1–4);US equity market – stock portfolios (datasets 5–6);bonds indices: US market (dataset 7) and international market (dataset 8).These datasets cover major areas of practical portfolio optimization ranging from equities (high riskiness) to bonds (low riskiness). All datasets contain weekly excess returns of corresponding assets. Equity datasets (1–6) are computed using the data from Kenneth French’s data library. Last two datasets, (7–8), hold bond returns. Dataset B6 contains excess returns for US bonds divided into six maturity sectors. Dataset B12 comprises currency hedged excess returns of bonds in three markets – USD, EUR, GBP (four maturity sectors in each currency) – with USD being the domestic currency. The hedging of the currency risk is crucial to keep the riskiness of the domestic and foreign bond investments on a similar level (the foreign exchange market is more volatile than the bond market). Apart from the currency hedged bonds, dataset B12 contains excess returns of holding foreign currency (cash invested short-term on the LIBOR market). The reader interested in the details of investment in international markets is referred to Black (1990) and Litterman (2003, Chapter 6). More information concerning sources and processing of the data are provided in Appendix C in the Electronic Supplement.The datasets span the period between January 1999 and June 2007. The choice of this time interval has been motivated by two facts. First, we wanted to exclude the distortion of the data by the crisis of 2008–2009 (signals of which were visible on the market since August 2007). Second, we wanted to include a new currency for the European Union, the euro, in the international bond portfolio – it was introduced in January 1999.Our detailed empirical studies are performed on the data from the period April 2003–June 2007. The whole dataset is used to verify the robustness of results in SubSection 4.5.To promote coherency between results for different datasets, we assume that the investor’s risk aversion γ is equal to the market risk aversion γm. We determine γmusing the approach due to Bevan and Winkelmann (1998) (see also Litterman, 2003). They advocate that the market risk aversion be such that the market portfolio’s Sharpe ratio is between 0.5 and 1 – we fix it at 1 for all datasets. This corresponds to the risk aversion equal to the inverse of the standard deviation of the market portfolio excess return. Table 2lists estimates of the standard deviations of market portfolios. Equity markets enjoy the stability of this statistic – the risk aversion corresponding to the unit Sharpe ratio is around 9. The estimated standard deviations for bond markets are significantly lower than for the equities. Appropriate risk aversions are 27 for B6 and 43 for B12. Unlike the equities, these two values do not agree. Unsurprisingly, as B6 represents a one-currency market (as all equity datasets), whereas assets in B12 are spread between three countries.5We do not study international stock markets because weekly returns are not provided in (widely accessible) Kenneth French’s library. Results for international stock markets, using monthly returns, are on a par with our findings in SubSection 4.5.5Computations of the mean square error (MSE) can be carried out if one knows the covariance matrix of the future asset returns, the market portfolio and the market risk aversion (see (8) and (9)). However, the exploration of other properties of the optimal portfolio estimator requires the knowledge of the mean μ of the future returns. Direct estimation of this quantity from the market data is subject to a substantial error. We, therefore, go for a “lesser evil” and assume that the estimated market risk aversion and the estimated covariance matrixΣ^(per annum) are the true values. The mean excess return μ is then uniquely determined asμeq=γmΣ^wm,where wmis the market portfolio. We will refer to this μeqas the vector of equilibrium returns (see, e.g., Litterman, 2003). Notice that formulas (5) and (7), with μ=μeq, are identical to formulas (8) and (9).Theoretical results of Section 3 require that time series of excess returns be serially independent and multivariate normally distributed. Empirical time series of asset returns do not satisfy these assumptions (see Fama, 1965; McNeil et al., 2005). We will evaluate the impact of these simplifications by comparing theoretical mean square errors with empirical results. The latter are computed with a bootstrapping technique.Bootstrapping is a statistical procedure used to estimate the distribution of an estimator (see Gentle, Härdle, & Mori, 2004). A standard bootstrapping technique, which samples single returns, breaks the dependence between consecutive samples. We employ a moving block bootstrap method, which samples blocks of data preserving the dependence structure. Proof of asymptotic consistency of the resulting estimators together with detailed statement of assumptions can be found in Hall, Horowitz, and Jing (1995) (see also the review paper by Härdle et al., 2003, and the book by Gentle et al., 2004).The implementation of the block bootstrap method in our framework is as follows. Data consists of 216 weekly returns r1,…,r216. We construct 205 blocks of 12 consecutive returns (12weeks): Bk=(rk,rk+1,…,rk+11) for 1⩽k⩽205. We draw 18 blocks independently with replacement from the set of all blocks. These blocks are concatenated in the same order as they were drawn forming a time series of 216 returns. Estimates of the mean vector and covariance matrix are calculated. Inserted into (6), they provide an approximation for optimal portfolio weights.Portfolios obtained by independent repetitions of the above algorithm can be treated as samples from the distribution of the portfolio weights estimator with returns time series drawn from the true (market) distribution (see Hall et al., 1995, for the justification of this statement). The MSE is, therefore, estimated by the trace of the empirical covariance matrix of the portfolio weights estimator.Convergence results for bootstrap methods are asymptotic, i.e., for the size of the sample growing to infinity. We supplement the empirical bootstrap results with Monte Carlo simulations, in which returns are simulated from the normal distribution with the mean μeqand the covariance matrixΣ^(see SubSection 4.1). This allows us to observe the error of the bootstrap method due to the finite size of the empirical sample. Specifically, we simulate 216 weekly returns by sampling independently from the distributionN(μeq/52,Σ^/52)and compute the mean square error via the moving block bootstrap. This is repeated 100 times to remove the bias due to a particular realization of the returns series. The average of the square roots of the computed MSEs is reported in Table 3(the column “MC bootstrap”). These values are generally larger than the true quantities (in the column “Theoretical”) due to a known finite-sample bias6This bias is of order 1/(sample size) and it vanishes as the sample size grows to infinity.6in the bootstrap estimation of the covariance matrix (see Efron & Stein, 1981). We can, therefore, expect that the values computed for the empirical datasets are slightly upward biased.Theoretical values of the mean square error reported in Table 3 are in close agreement with the empirical bootstrap results; when taking into account the upward bias of the block bootstrap method (i.e., comparing the results of the empirical bootstrap procedure with the Monte Carlo bootstrap simulations), the relative error does not exceed 10% for all datasets but B6.7Empirical estimate of the mean square error for the dataset B6 is significantly larger than the theoretical and MC bootstrap values (the increase is by 30%). This seems to be an isolated case. We do not observe such discrepancies for other estimation windows, see, e.g., SubSection 4.5.7This confirms that, although obtained with unrealistic assumptions in place (serial independence and normal distribution of returns), our theoretical results offer a good proxy for the assessment of the estimation errors of portfolio weights. The robustness of the above claim is verified in SubSection 4.5.To confirm the relevance of the mean square error as a measure of portfolio sensitivity to estimation errors, we compute 95% confidence intervals for portfolio weights and compare their sizes with the mean square error. The estimation of the confidence interval requires many independent realizations of the portfolio weight estimator (to have enough values around the 2.5% and 97.5% quantiles). This can be achieved by a Monte Carlo simulation. In each run we simulate 216 weekly returns by sampling independently from the distributionN(μeq/52,Σ^/52)and compute portfolio weights for the two cases: with the known mean vector (equal to μeq) and the mean estimated from the data. The widths of confidence intervals are averaged over assets in the dataset and reported in columns two and four in Table 4. These values are compared with the square root of the average mean square error per asset, i.e., withMSE/p, where p is the number of assets. Columns three and five display the ratio of the average width of confidence intervals toMSE/p. These quantities remain, to a great extent, constant, although the average size of the confidence interval changes from dataset to dataset. This confirms that the square root of the mean square error is a good approximation for the portfolio weights estimation error.8Similar agreement has been obtained for other lengths of the estimation period.8It is widely believed that the contribution of the estimation error of the mean to the estimation error of portfolio weights is at least of an order of magnitude larger than that of the estimation errors of the covariance matrix (see, e.g., Chopra & Ziemba, 1993). This subsection offers insights into the validity of this claim and shows that the relative contribution of the covariance matrix estimation errors is, to a great extent, market specific.It was argued in the previous subsection that the square root of the mean square error is a good measure of the stability of portfolio weights. The influence of the estimation errors of the covariance matrix can, therefore, be assessed by comparing the mean square error in the case when the true mean is known (the estimatorwˆμ) with the mean square error for the estimator when both the mean and the covariance matrix are estimated from the data (the estimatorwˆ).Table 5displays the square roots ofMSE(wˆμ)andMSE(wˆ)(columns two and three) and their ratio (column four). This ratio is around 7.4 for all datasets meaning that around 1/7.4≈13.5% of the variability of portfolio weights can be attributed to the estimation errors of the covariance matrix. We will show that this ratio stays roughly constant when the length of the estimation period is changed, but it grows if Δ, the distance between sampling times, increases. In particular, when the sampling frequency is changed to monthly, the relative importance of covariance estimation errors becomes substantial: the ratio of MSEs lowers to around 3.5, i.e., 28% of the portfolio weights estimation error is due to the covariance matrix (see SubSection 4.5).To gain better understanding of the market characteristics determining the degree of the influence of the covariance matrix estimation errors on the stability of estimated portfolio weights let us return to formulas (5) and (7). Define the covariance contribution factor as the ratio of the third to the second term of (7):CCF=nΔn-2μTΣ-1μ-1.If one assumes that the first term of (5) and (7) is small in comparison to the other terms (this is very likely as this term is approximately equal to the ratio between the norm of the market portfolio – bounded by 1 due to the lack of negative positions – and the number of samples) thenMSE(wˆ)≈MSE(wˆμ)(1+CCF).This relation is market-specific. Indeed, the covariance contribution factor can be written asCCF=nΔn-2γm2wmTΣwm-1=nΔn-2(SRm)2-1,where SRmis the Sharpe ratio of the market portfolio. The relative benefit of knowing the mean is shared by all mean–variance investors irrespective of their risk aversion. The driving force in the covariance contribution factor is the Sharpe ratio of the market portfolio multiplied by Δ, the length of the time interval between subsequent samples.9This explains almost identical values in column 5, Table 5, as in our experiment we assumed Sharpe ratio of market portfolio approximately 1 for all datasets.9The factor n/(n−2) is close to 1 for practically viable number of samples n. This implies that varying n results in negligible change in the balance between the influence of the estimation errors of the mean and the covariance matrix on the stability of portfolio weights estimator.In general, without the assumption that the first term of (5) and (7) is negligible, the benefit of knowing the true mean in the optimization process can only be bounded by the covariance contribution factor CCF:(11)MSE(wˆ)MSE(wˆμ)=A+1+CCFA+1⩽1+CCF,where A>0 equals the ratio of the first to the second term of (5). The quantity1/1+CCFunderestimates the influence of the covariance matrix estimation errors on the stability of portfolio weights.We argued before that the first term of (5) is usually small relative to the other terms. Hence, the value A in (11) is small and the right-hand side of the inequality provides a good approximation for the ratio of mean square errors. Indeed, the last column of Table 5 lists1+CCFfor all datasets. These values are in very good agreement with the exact quantities displayed in column four. This shows that CCF, which can be easily derived from the properties of the market portfolio, is a good gauge for the impact of the estimation errors of the covariance matrix on the stability of estimated portfolio weights.Portfolio estimation errors diminish its performance. The loss of utility is examined by Kan and Zhou (2007). Following DeMiguel et al. (2009) we study the turnover. We compute the portfolio turnover by averaging over 100 rolling horizon simulations with weekly rebalancing of portfolio. There are 200 rebalancing times in which the portfolio is estimated using 216 past weekly returns. A simulation study spanning a number of datasets and risk aversion coefficients shows that the ratio of square roots of mean square errors has 99% correlation with the ratio of expected turnovers implied by strategies computed with the known mean and with the mean estimated from the market data.The robustness of the analysis presented in the previous subsections is verified in two directions: the extension (doubling) of the estimation period to January 1999–June 2007 and the decrease of the sampling frequency (from weekly to monthly data). The extension of the estimation period results in the increase of standard deviations of market portfolios for the equity datasets, see Table 6(sampling frequency has little impact on these values). This can be explained by the inclusion in the dataset of over a year of the build-up of the dot-com bubble which was followed by the bust initiated in March 2000. On the other hand, the estimated standard deviations for bond markets are on the same level as for the shorter period. To stay in agreement with the rule that the Sharpe ratio of the market portfolio is 1, we adjust the risk aversion for equities to 6 and keep it unchanged for bond markets, i.e., the risk aversion equals 27 for B6 and 43 for B12.Table 7displays theoretical and empirical mean square errors for the portfolio weight estimator calculated from 8years of weekly and monthly returns. Both values are in a good agreement for the weekly data. In the case of monthly returns, the empirical mean square errors are visibly larger than the theoretical values. This discrepancy can be explained by the finite-sample bias of the block bootstrap estimators (the convergence of bootstrap estimators is only asymptotic, i.e., when the sample size tends to infinity). Indeed, a significant difference (especially for bond portfolios and C10) between the bootstrap estimator and the theoretical value for a small sample (there are only 102 monthly returns) greatly decreases when the sample size grows (there are 432 weekly returns).The validity of the claim that1+CCFoffers a good approximation for the ratio of square roots of the mean square errors for portfolio weights computed with estimated μ (the estimatorwˆ) and with the true μ (the estimatorwˆμ) (see SubSection 4.4) is strengthened by the data in Table 8. Good agreement between the exact and approximate values holds across datasets and sampling frequencies. This implies that the contribution of the estimation errors of the covariance matrix to the portfolio weight estimation error shows little dependence on the sample size and investor’s risk aversion: compare column four in Table 5 (4years of weekly data) and column two in Table 8 (8years of weekly data).The examination of results obtained for 8years of weekly and monthly data, Table 8, reveals that the values for weekly data are approximately twice as large as the values for monthly data. This fits our theoretical finding that the value of CCF is inversely proportional to the length of the sampling interval (sampling interval for monthly data is approximately 4 times larger than for weekly data, hence the impact of the error coming from the estimation of the covariance matrix is twice as large as for weekly data). The relative contribution of the estimation errors of the covariance matrix to the portfolio weight estimation error, i.e., the ratioMSE(wˆμ)/MSE(wˆ), is, therefore, around 28% for monthly data and around 14% for weekly data.We provide analytical formulas linking parameters of the return distribution with the stability of portfolio weight estimators. Our results are exact, i.e., they are based on the true, not asymptotic, distributions of the estimators of the mean and covariance matrix of asset returns. The variability of portfolio weights is measured by the mean square error which combines estimation errors of separate portfolio weights into a single number. This facilitates the comparison of various estimation methods and allows for the identification of factors influencing the estimation procedure. We show that the relative contribution of estimation errors of covariance matrix to estimation errors of portfolio weights is market specific and determined mostly by the Sharpe ratio of the market portfolio and the frequency of asset price sampling. This gives solid grounding for the verification of the long-standing belief that the covariance matrix related errors are of one order of magnitude lower than those coming from the estimation of the mean. Our empirical study shows that this is approximately true if the data is sampled weekly (around 14% of the error is due to the covariance matrix), but is clearly false for the monthly data (the contribution of covariance related errors grows to 28%).Our theoretical results are complemented by a thorough study of eight datasets of equities and bonds with varying sizes. We demonstrate that our theoretically computed mean square error of the portfolio estimator is in good agreement with the mean square error estimated from the empirical distribution of the real market data. The latter was obtained via an appropriate adaptation of the block bootstrap methodology, which preserves not only the distribution of returns but also their serial correlation. We believe that this methodology should gain wider popularity as a tool for assessing properties of portfolio estimators.Further research could attempt to provide an analysis of portfolio weights estimation error for other settings: Bayesian and shrinkage estimators and the Black–Litterman model. The extention of our theoretical results to the market model without riskless asset is straightforward. The mean square error can be derived from the results of Mori (2004) or Okhrin and Schmid (2006), but the simplification of these formulas so that the factors influencing the behavior of the optimal portfolio estimator can be detected is rather complicated. Our preliminary computations show that the removal of the riskless asset does not provide a remarkable change of the error. Another line of research could seek to quantify the effect of growing number of available assets (see Leung, Ng, & Wong, 2012 and references therein) and transaction costs.

@&#CONCLUSIONS@&#
