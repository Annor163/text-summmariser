@&#MAIN-TITLE@&#
Defocus-aware Dirichlet particle filter for stable endoscopic video frame recognition

@&#HIGHLIGHTS@&#
We propose a method for smoothing recognition results of NBI endoscopic video frames.It is robust to defocused frames by using defocus information extracted from frames.We develop a particle filter with the Dirichlet distribution.The Rayleigh distribution is used for the defocus information and the likelihood.Experimental results are shown with synthetic and real NBI endoscopic videos.

@&#KEYPHRASES@&#
Particle filter,Dirichlet distribution,Defocus information,Endoscopy,Colorectal cancer,

@&#ABSTRACT@&#
Background and objectiveA computer-aided system for colorectal endoscopy could provide endoscopists with important helpful diagnostic support during examinations. A straightforward means of providing an objective diagnosis in real time might be for using classifiers to identify individual parts of every endoscopic video frame, but the results could be highly unstable due to out-of-focus frames. To address this problem, we propose a defocus-aware Dirichlet particle filter (D-DPF) that combines a particle filter with a Dirichlet distribution and defocus information.MethodsWe develop a particle filter with a Dirichlet distribution that represents the state transition and likelihood of each video frame. We also incorporate additional defocus information by using isolated pixel ratios to sample from a Rayleigh distribution.ResultsWe tested the performance of the proposed method using synthetic and real endoscopic videos with a frame-wise classifier trained on 1671 images of colorectal endoscopy. Two synthetic videos comprising 600 frames were used for comparisons with a Kalman filter and D-DPF without defocus information, and D-DPF was shown to be more robust against the instability of frame-wise classification results. Computation time was approximately 88ms/frame, which is sufficient for real-time applications. We applied our method to 33 endoscopic videos and showed that the proposed method can effectively smoothen highly unstable probability curves under actual defocus of the endoscopic videos.ConclusionThe proposed D-DPF is a useful tool for smoothing unstable results of frame-wise classification of endoscopic videos to support real-time diagnosis during endoscopic examinations.

@&#INTRODUCTION@&#
Colorectal endoscopy (or colonoscopy), i.e. endoscopic examination using a narrow-band imaging (NBI) system, is widely used to diagnose colorectal cancer [1]. A computer-aided diagnosis system for colonoscopy would be an extremely helpful tool for supporting diagnosis during examinations. Processing a video stream plays an important role in providing such support because endoscopists typically specify the region of a tumor and capture a video frame to diagnose the tumor's condition. However, intra/inter-observer variability [2–4] shows that diagnosis can be subjective and depends on the endoscopist's experience. Hence, a computer-aided system that provides an objective measure for diagnosis on a screen would be of great assistance [5]. One straightforward means of providing an objective real-time diagnosis might be frame-wise classification, i.e., using a machine-learning-based classifier trained off-line with training image patches to recognize a part of every endoscopic video frame and showing classification results (labels or probabilities) on a screen. However, the problem then arises that we do not see when we independently classify training image patches. Fig. 1shows a typical result obtained from a frame-wise classification with three classes. The three curves of posterior probabilities represent the classification results of every frame and are shown to visualize the confidence of the classifier. Although this video sequence continues to capture the same tumor, the classification results are highly unstable, and it would be difficult for endoscopists to understand the output during an examination.One of the principal causes for this instability is scene blur, or defocus, due to the narrow depth of field (see Fig. 2). Since operating an endoscope requires expert skill, and the intestinal wall continues moving, it is difficult to maintain focus on a tumor for a long time. Features extracted from defocused frames cause unstable results because the classifier has not been trained with such features. Our preliminary experiments also demonstrate that classifying defocused image patches performs worse than classifying well-focused ones (see Section 5.2). Removing defocused frames from a video stream [7] would not be helpful in such an application because results on the screen would frequently stop or disappear.To overcome this problem, we propose a method for smoothing probability curves, or sequences of posterior probabilities, such as those shown in Fig. 1, by incorporating information representing the degree of defocus from each frame in the framework of particle filtering with a Dirichlet distribution [8]. We call the proposed method the defocus-aware Dirichlet particle filter (D-DPF). There are two reasons why we need to develop our own method for smoothing probability curves.First, smoothing techniques use only given signals; therefore, it is difficult to recover from failures in frame-wise classification owing to the defocus of frames. In such a case, it is reasonable to use additional information which represents defocus of each frame; smoothing results tend to follow the observation of the current frame if the frame is in focus, and to keep the results from the previous frames otherwise. Our proposed method uses isolated pixel ratio (IPR) (see Section 4.2.1) as defocus information in the likelihood of the particle filter so as to show the confidence of the classification result at each frame.Second, smoothed results obtained by existing smoothing methods must typically be renormalized at each frame to sum to one, leading to inconsistency between frames as this has no probabilistic significance. Our system outputs confidence values at each frame, i.e., posterior probabilities for the results when classifying a patch in each frame into three classes (type A, B, and C3), on the basis of NBI magnification findings[9,4] (see Section 2.1). Therefore, we developed a probabilistic framework with a particle filter to perform “smoothing of probabilities” using the Dirichlet distribution (see Section 3.2) in such a way that defocus information is incorporated.The remainder of this paper is organized as follows. Section 2 reviews the relevant medical background regarding colorectal cancer, NBI magnification findings, and related work. We formulate the problem as a particle filter with a Dirichlet distribution in Section 3. Section 4 introduces additional defocus information into the likelihood of the particle filter. Section 5 shows several experimental results using real and synthetic data. We conclude the paper in Section 6.Colorectal cancer is one of the major causes of cancer related deaths worldwide [10]. Colonoscopy is the most popular and widely used inspection method for such cancer. During colonoscopy, endoscopists observe a tumor displayed on a monitor to determine whether treatment and resection are necessary. Recently, the development of NBI [11–13] has enabled endoscopists to perform examinations in less time. NBI enables the enhancement of microvessel structures by using two light sources of specific wavelengths that are absorbed by hemoglobin in the blood vessels. NBI magnification findings have been proposed as a diagnostic criterion by the Hiroshima University Hospital [9,4], which categorizes appearances of tumors into types A, B, and C, with type C further subclassified into C1, C2, and C3 on the basis of microvessel structures (see Fig. 3). Based on the NBI magnification findings, Tamaki et al. [6] proposed a recognition method that classifies NBI images into three types, A, B, and C3.11The reason to exclude types C1 and C2 is the inherent difficulty to distinguish between subtypes C1, C2, and C3 due to large inter/intra-observer variability [4]. Therefore a poor classification performance is obtained for a five-class classification problem (see [6] for details).Tamaki et al. [6] proposed a prototype computer-aided diagnosis system for NBI endoscopy image patches. They used the bag-of-visual words (BoW) framework with a scale invariant feature transform (SIFT), followed by support vector machine (SVM) classifiers. In their experiments, they achieved a recognition rate of 96% on 908 NBI image patches with 10-fold cross validation. Through the use of this method, a frame-wise classification for NBI videoendoscopy, which classifies a part of each endoscopic video frame in a frame-by-frame manner, could be developed. One instance of such frame-wise classification is shown in Fig. 1, which is unstable as mentioned above. In order to make the classification results stable over time, in this paper we propose a method for smoothing sequences of the frame-wise classification results.

@&#CONCLUSIONS@&#
