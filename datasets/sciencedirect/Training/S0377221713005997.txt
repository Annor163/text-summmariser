@&#MAIN-TITLE@&#
The directed profitable location Rural Postman Problem

@&#HIGHLIGHTS@&#
We studied a location-routing problem with profits.We propose a mathematical formulation and a branch-and-cut algorithm.We discuss in detail an application in the strategic planning of freight transportation.We developed an example of the application and solve it through the branch-and cut.We analyze the properties of the problem.

@&#KEYPHRASES@&#
Freight transportation,Rural Postman Problem,Facility location,Arc routing with profits,Integer programming,

@&#ABSTRACT@&#
In this paper we introduce an extension of the well known Rural Postman Problem, which combines arc routing with profits and facility location. Profitable arcs must be selected, facilities located at both end-points of the selected arcs, and a tour identified so as to maximize the difference between the profit collected along the arcs and the cost of traversing the arcs and installing the facilities. We analyze properties of the problem, present a mathematical programming formulation and a branch-and-cut algorithm. In an extensive computational experience the algorithm could solve instances with up to 140 vertices and 190 arcs and up to 50 vertices and 203 arcs.

@&#INTRODUCTION@&#
In this paper, we present a model to address a network design problem that calls for selecting, in a way that is economically sound, terminals and asymmetric connections. Given a directed graph with a set of profitable arcs, with fixed costs associated with end-points, the problem consists in choosing a subset of profitable arcs in such a way that the difference between the profit collected and the total cost is maximized. The total cost includes the cost to open facilities at the end-points of the selected arcs and the traveling cost. We assume that enough capacity is available to satisfy the demand that originates from the selected connections. This assumption can however be removed by introducing an adequate constraint in the integer programming model. We call this problem the Directed Profitable Location Rural Postman Problem (DPLRPP).To the best of our knowledge, the DPLRPP was never studied in the literature. However, strongly related problems were addressed, like the Eulerian Location Problems (ELP), treated in Ghiani and Laporte (1999), and the Location-Arc Routing Problems (L-ARP), studied in Ghiani and Laporte (2001) and Liu, Jiang, Chen, Liu, and Liu (2008): these are arc routing problems with costs located at nodes and connections, but without profits. In Ghiani and Laporte (2001) and Liu et al. (2008), the authors present applications of the L-ARP to those routing and delivering problems that require specific facilities like vehicle depots, relay boxes, dump sites, or transfer/replenishment points. In the DPLRPP costs are located at both nodes and connections, like in ELP and L-ARP. However, contrary to ELP and L-ARP, the problem is with profits.The application domain is mid/long range passenger/freight transportation, e.g., long-distance coach services, airlines, and interstate trucking. In these cases, companies identify a set of potential connections on the basis of demand estimate. The problem is to choose the connections on which to open a service. Unlike local or regional services, and unlike (Ghiani & Laporte, 1999, 2001; Liu et al., 2008), an important characteristic of mid/long range applications is that the company has to bear arc costs, related to transportation service provision, and also node costs, related to passenger/freight service (ticketing, check-in, waiting rooms, warehousing etc.) at both terminals. Terminals and connections form a network, the features of which depend on the specific domain. In the case of interstate freight transportation (e.g., the European TIR, Transports Internationaux Routiers) connections are typically asymmetric, because asymmetry is introduced by import–export imbalances.The paper is organized as follows. We first describe the problem in Section 2, provide an example of application and review the literature. In Section 3 we state the complexity of the problem and survey a few basic properties while in Section 4 we present an integer linear programming formulation with a number of constraints that grows exponentially with ∣V∣. Based on this formulation, a branch-and-cut algorithm is then presented together with computational results in Section 5.The DPLRPP is an extension of the well known Rural Postman Problem that combines facility location and arc routing with profits, and is defined as follows.Let G=(V, A) be a directed connected graph with V={0,1,…,n} and A⊆V×V vertex and arc set, respectively. Vertex 0 is the depot. Each vertex v∈V is associated with the cost fvof installing a facility in v. Each arc (u, v)∈A is associated with the (non-negative) cost cuvof traversing (u, v). Moreover, a subset of profitable arcs R⊆A is defined. Each of these arcs is associated with a non-negative profit puvand an integer demand duv: the profit is gained only if (u, v) is traversed at least duvtimes.A tour on G is a sequence of arcs T=((0, u),(u, v),…,(w, 0)) starting and ending at 0. The sequence is not necessarily simple, that is, T may contain repeated copies of the same arc of G. If the tour traverses (u, v)∈R at least duvtimes, then profit puvis gained. However, unlike costs, which are paid whenever an arc is traversed, a profit can be collected only once. Also, profits are asymmetric, that is, if u and v are connected in both directions, the profit gained when traversing (u, v) may differ from that gained when traversing (v, u). In the following, we use the term ‘served’ to indicate a profitable arc (u, v) that is traversed at least duvtimes. In order for T to be feasible, facilities must be located at each vertex incident to a profitable arc served by T. Let U(T)⊆V be the set of these vertices.The DPLRPP is the problem of finding a tour T that maximizes the total net profitp¯(T)given by the difference between the profit p(T) returned from the arcs of R served by T and the cost of T (including both traveling and fixed costs):(1)p¯(T)=p(T)-∑(u,v)∈Tcuv-∑v∈U(T)fvConsider a company interested in offering transportation facilities and services to a set of potential customers, e.g. industries, scattered in a geographical area over a given time period. Suppose that the company is based in Bremen.Let V be the set of all relevant nodes of the area. Vertex 0 corresponds to the city of Bremen. The potential customers are located at nodes u∈V and express a need to deliver freight to their own customers located at nodes v∈V. Freight has to be delivered duvtimes from u to v. We say that the potential request of service from u to v has demand duv. A profit puvis gained if the demand is served, that is if the freight is transported from u to v the requested number of times. A profitable arc is associated with each of these potential requests of service. We indicate by R the set of all profitable arcs. The set of arcs A is formed by all oriented links (u, v) which define connections between pairs of nodes, that is links a truck can travel. The set of arcs A contains the set of profitable arcs R and other non-profitable arcs. In practice, profitable and non-profitable arcs are selected from a road map filtering inadequate (e.g., too long or too expensive) connections.The leftmost table in Fig. 1gives a set of potential requests of service, with the associated profit puvand demand duv. Using real travel times and filtering off connections requiring more than Tmax=360minutes, we obtain the graph of Fig. 2. For ease of representation, in Fig. 2 we drew profitable links as directed arcs. Non-profitable connections are represented by edges meaning that the connection between the corresponding pair of cities can be traversed in both directions. Note that profitable arcs can also be traversed in the opposite direction.In order to make a business plan, the company wants to find the most profitable tour in G. The elements of this tour – terminals and connections – are chosen on the basis of costs and profits.The most important cost sources, measured on a long-term base, are of two types:•costs fvallocated to terminals, to be covered in order to provide terminal services, such as warehousing: these costs may include infrastructure availability (e.g., premises rental) and fixed operational costs, and do not depend on the number of connections served;mileage-toll costs cuvallocated to links, depending on the link length and on highway tariffs. Mileage costs not only include fuel consumption, but also the relevant quote of driver/hours, fleet maintenance, etc.Costs cuvare estimated on the basis of the length of the link (u, v) and reported in Fig. 3. The cost fvof setting up a terminal at v is indicated for each city in the rightmost table of Fig. 1.Fig. 4shows the optimal tour that gives a net profit estimate of 1,797,472euros, over a total cost of 5,083,137euros (2,351,000 for terminal set-up and 2,732,137 for routing). The solution selects 18 profitable arcs out of 22 (82%). This solution has been found through the branch-and-cut algorithm described in Section 5.

@&#CONCLUSIONS@&#
The scientific literature reporting studies on integrated modeling of problems that have been previously treated independently is constantly increasing, due to the progress in technology and in algorithm design. This paper represents a first contribution to the integration of facility location and arc selection decisions within an arc routing setting.In this paper we introduced a new problem in the class of arc routing problems with profits that incorporates facility location, arc selection and routing decisions. The problem, which is proved to be NP-hard even under strongly simplifying assumptions, models long/mid-range network planning. Its formulation differs significantly from the ones used in the literature for arc routing with profits. A branch-and-cut algorithm was implemented and tested on a large set of instances. We tested two classes of instances. The first class has up to 140 vertices and 190 profitable arcs, the second has up to 102 vertices and 203 profitable arcs. The computational results show the effectiveness of the algorithm which allowed us to solve 487 instances out of 516 within 1hour.