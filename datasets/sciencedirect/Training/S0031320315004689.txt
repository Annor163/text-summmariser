@&#MAIN-TITLE@&#
A semi-automatic method for robust and efficient identification of neighboring muscle cells

@&#HIGHLIGHTS@&#
We evolve the threshold selection method.We decompose the histogram distribution into different layers by Fourier transform.We select the optimal threshold based on the practical needs.We evolve the ultimate erosion theorem to achieve high accuracy.

@&#KEYPHRASES@&#
Segmentation,Threshold selection,Morphological erosion,Morphological dilation,Muscle cell/fiber,

@&#ABSTRACT@&#
Segmentation and identification of muscle cells robustly and efficiently is of considerable importance in determining the muscle’s physiological conditions. It is challenging due to frequently occurring artifacts, indistinct boundary between adjacent cells, the arbitrary shape and large number of cells. Currently, the widely used segmentation and quantification tools are usually manual or semi-automatic, which is time-consuming and labor intensive. In this paper, a semi-automatic method is proposed to segment the muscle cells robustly and efficiently. The proposed approach utilizes and evolves three fundamental image processing techniques, threshold selection, morphological ultimate erosion and morphological dilation. Experimental results verified the effectiveness of the proposed method.

@&#INTRODUCTION@&#
Image segmentation [1–4] plays important roles in many computer vision applications. With the rapid development of microscopy imaging [5], many new scientific applications are brought forth in the areas of physics, chemistry and biology [6,7]. Among them, cell segmentation is the most studied and popular one. Many methods were proposed and claimed to be superior in segmenting a class of cell images, e.g. watershed method [8], region growing method [9], morphological method [10], neural network method [11], graph method [12] and machine learning and modeling method [13,14]. In this paper, we propose a method to segment the muscle cell/fiber image which usually contains a lot of cells/fibers and would cost great labor and time for manual or semi-automatic methods. Hence, image processing techniques that is capable of segmenting the neighboring cells and identifying their boundaries robustly and efficiently becomes very important. Past efforts in segmenting the muscle cell/fiber images include: (1), active contour based method [15,16,18]; (2), GVF method [17]. Experimental results indicate that our proposed method is superior to them in efficiency and accuracy.There are two general properties of the muscle cell images, intensity and intensity gradient and they are identified mainly by their intensity gradients and local intensities. It is difficult for one to notice the global intensity variations of these images accurately because of lateral inhibition. Hence, we enhance the boundary of all the cells and use the segmented intensity gradients as constraint for the segmentation with a global threshold. To segment the enhanced gradient image robustly, we calculate the threshold based on the slope variation of the histogram distribution [19]. The threshold is selected as the point with greatest variation, which is more accurate than the state of art threshold selection methods [20–34]. After the image was segmented by the selected threshold, some neighboring cells are still connected. Thus, further processing is needed to separate them from each other. To separate them, we propose an iterative erosion method based on an area threshold that can distinguish the area of the cell and the area of the noise which is prevalent in image processing applications [35]. The area threshold is computed on line. After the cell is identified, its boundary is delineated by dilating the segmented seed toward its edge until part of it reaches the edge.The segmentation comprises three parts. The first part is segmentation of the original image by a global threshold. The second part is producing the gradient image and segmenting it by a global threshold. The third part is combining the first part and second part for the final segmentation based on the characteristics of the muscle cell images.For the first part of segmentation, we need to compute a threshold from the original image. An improved threshold selection method is proposed in this paper based on our previous study [15]. The histogram distribution of the original image is calculated and then transformed into the Fourier domain. The first term of the Fourier transform corresponds to the DC value of the histogram distribution. The second term of the Fourier transform corresponds to the sketchiest global information of the histogram distribution. Suppose the image contains the object and the background and their gray-scales are Gaussian distributed, the second term of Fourier transform corresponds to a sketchy overlay of two Gaussian distributions. Hence, a global variation peak exists between these two Gaussian distributions to separate them roughly. This global variation peak is detected automatically and it is then used as the benchmark threshold to segment the original image. The threshold selection method contains the following steps:Step 1: Re-arrange the gray-scale values of the image in the interval [1, 255] and compute its normalized histogram distribution, P(x):(1)P(x=i)=NiNj;i=1,2,...,255(2)j=argmax{Nk}k∈[1255]where Nidenotes the frequency of the gray-scale i and Njdenotes the maximum frequency which occurs at j in the interval[1255].Step 2: Transform P(x) by the Discrete Fourier Transform (DFT):(3)F(k)=∑x=1255P(x)e−i2πkx255;k=1,2,...,255Step 3: After DFT, choose the first term and second term of the low frequency parts and eliminate the other parts by the following equation:(4)F′(k)={F(k);k=1,2;F(k);k=254,255;0;k=3,…,253Step 4: Transform from the frequency domain back into spatial domain to get the smoothed histogram.(5)P′(x)=1T∑k=1255F′(k)ei2πxk255;x=1,…,255Step 5: There are two slopes for each point on P′(x), one on the left and the other on the right. They are computed by fitting a line model with 15 adjacent points at each side. All the reasonable numbers from 3 to 81 are tested on a variety of images and it is found that the numbers from 7 to 21 are the most effective parameters for the histogram range from 1 to 255. So we choose 15 for all the experiments. The line model is formulated as:(6)yi=axi+b(7)[a,b]T=(BTB)−1BTY(8)B=[x1x2⋮x1511⋮1](9)Y=[y1,y2,…,y15]TTwo slopes at pointi, a1(i) and a2 (i), are then obtained from Eq. (7).Step 6: Compute the slope difference, s(i), at point i:(10)s(i)=a2(i)−a1(i);i=16,17,...,240Find the positions in the slope difference distribution that meet the following conditions:(11)s(i)−s(i−1)=0We get the valleys Vi;i=1, 2,...,Nvwith greatest local variations and the peaks Pi;i=1, 2,...,Npwith greatest local variations of the slope difference distribution. Suppose there are two histogram peaks, P1 and P2 corresponding to the centers of the two Gaussian distributions, we choose the position where the valley Vibetween P1 and P2 as the benchmark threshold Tb. Then the original image,Iis binarized as follows:(12)SI={1;I≥Tb0;I<TbFor the second part of segmentation, we need to form the gradient image from the original image. The Sobel operator is used to detect the intensity gradient in the row direction and column direction respectively and get two gradient images Ixand Iy. Then the gradient magnitude image is computed as follows:(13)Ig(k,j)=Ix2(k,j)+Iy2(k,j)where(k,j)denotes the index of the pixel position.The gradient image is then segmented with a global threshold to obtain the edge image,SE. We need the segmented edges to be as complete as possible for the subsequent processing. Unfortunately, none of the state of art threshold selection methods [20–34] could yield acceptable accuracy. Hence, we use the same criteria to select the threshold as [19] and it contains the following steps.Immediately following the first two steps, Step 1 and Step 2 described above.Step 7: Choose the low frequency parts and eliminate the high frequency parts by the following equation.(14)F′(k)={F(k);k=1,2,…,10;F(k);k=246,…,254,255;0;k=11,…,245k is chosen from 1 to 10 to keep more details of the image. As a result, the selected threshold could segment the image and keep the edge more complete. Transform from the frequency domain back into spatial domain by the following equation.(15)P′(x)=1T∑k=1255F′(k)ei2πxk255;x=1,…,255P′(x) is the smoothed histogram distribution.Step 8: Repeat the above Step 5 and Step 6. We get the valleys Vi;i=1, 2,...,Nvof the slope difference distribution with local variation peaks. There are valleys adjacent to the benchmark threshold Tb, some on the left and the others on the right. The valley on the left is selected to make the segmented edge to be as complete as possible. Accordingly, the gray-scale value corresponding to the left valley is selected as the optimal threshold,To.The edge image is obtained by the following equation.(16)SE={1;Ig≥To0;Ig<ToWith the two segmentation results, SEand SI, we calculate the final segmentationSfin two cases due to the vast variety of muscle cell types. The user decides which case to choose for one specific type of muscle cell images. There are muscle cell images with many overlapping neighboring boundary while the segmented edge for each cell is not closed, which is true in most cases. For this kind of cell images (Case 1), we define the following segmentation method that utilizes the segmentation results of both the edge image and original image, SEandSI.(17)Sf={1;if(SI=1)and(SE=0)0;elseThere are also cell images with many overlapping neighboring boundary while the segmented edge for each cell is closed, which is true occasionally. For this kind of cell images (Case 2), we define the following segmentation method that utilizes the segmentation results of the edge image, SEonly.(18)Sf={1;if(SE=0)0;elseIn the final segmentation,Sf, some cells are separate from others while some cells are connected with each other. To separate the connected cells and identify the cell individually, we propose the following iterative morphological erosion method based on the online computed area threshold.Step 9: Initialization of the seeds of all the cells as the final segmentation, Sf.(19)Ib1=SfStep 10: Use the structuring elementB={(0,0)}to erode the seeds,Ib1morphologically with the following equations. The structuring element used in this study is a disk with the size of one pixel.(20)Ib'=IbiΘB={z|(B)z⊆Ibi}(21)(B)z={c|c=a+z,a∈B}where z is the translation vector and a represents the points in the structuring element B. The translation ofBis kept insideIbiwhileBmoving insideIbito get the erosion.Step 11: Compute the union of all the separated cells based on their sizes and save them as seeds (separated and identified cells).(22)Ici+1=⋃C(j˜);j˜=argjarea(C(j))<S0(23)Ibi+1=Ib'−Ici+1S0 is the area threshold to distinguish the area of the cell and the area of noise blob and it is computed as the mean area of all the blobs in the eroded image,Ib′after 10 times of erosion of the final segmentation,Ib1withB={(0,0)}and Eqs. (20) and (21).Step 12: Repeat step 10 and step 11 until the area of each segmented cell is smaller than S0 . Then the seeds of all the cells are formulated as:(24)Is=⋃i=1NIciAfter all the cells are identified, the position,(xck,yck)ofkthcell is computed as:(25)xck=1M∑j=1Mxjk(26)yck=1M∑j=1Myjkwherejdenotes the pixel index of the identified cell andMis the total number of pixels contained in the segmented cell.The proposed iterative morphological erosion method is based on the well-known ultimate erosion theorem. Given two sets A and B,B⊆A, the union of the connected components of A that have a nonempty intersection with B is denoted asρA(B).The ultimate erosion for the setXof overlapping convex components is defined as:(27)Ult(X)=⋃nϵN[(X⊖nB)\ρX⊖nB(X⊖(n+1)B)]Two facts make the ultimate erosion fail in segmenting the overlapping neighboring cells. Firstly, the shapes of the muscle cells are irregular. Thus, the ultimate erosion will produce more seeds than the actual number if no area threshold is used to constrain the erosion process. Secondly, ultimate erosion could not distinguish the real cells and the noise blobs. Consequently, there will be a lot of clutter seeds detected if applying ultimate erosion directly.Fig. 1 demonstrates the poor performance of ultimate erosion in separating overlapping circles. There are actually 13 circles while ultimate erosion calculates 17 seeds in Fig. 1(b) (To present the seeds clearly, we show the dilated version of the seeds). Two seeds in the middle of the image are connected due to their small distance. Fig. 1(c) shows the detected seeds with controlled area threshold for comparison purpose.In summary, the proposed iterative erosion method is significantly superior to the ultimate erosion theorem in solving practical problems.To delineate the boundary of each identified cell, authors in [17] use GVF method [36]. A circle with the radius ofnpixels from the center of the seed is drawn. Then the circle is pushed toward the edge of the cells by gradient vector field which is defined as the vectorV(x,y)=(u(x,y),v(x,y))that minimizes the energy function:(28)E=∫∫μ(ux2+uy2+vx2+vy2)+|∇f|2|V−∇f|2dxdywhere f is the edge map derived by applying edge detection on the smoothed image which was obtained by convolving the original image with a Gaussian kernel. µ is the regularization parameter which adjusts the trade-off between the first and second term of the integrand.When the initial circle is too large or too small compared to the real size of the cell, the GVF will not converge correctly. Another drawback of the GVF method is that it is easily affected by the incorrect edge information. In addition, it takes time to converge and especially time-consuming when the number of cells is huge. A significantly more efficient method to identify the cell border is proposed as follows.Step 13: Start the loop to dilate the first identified cell seed by the following equation.(29)Cji+1=Cji⊕B={z|(Bs)z∩Cji≠∅}whereB={(0,0)}andBsdenotes the symmetric or supplement of B.Cj1denotes the jth identified cell seed in Section 2.2.Step 14: Immediately following each dilation, compute the intersection of the dilated cell with the binarized edge image SEcomputed in Section 2.1.(30)S=Cji+1∩SEIf the size of the intersection S is greater than the predefined value, 10, break the loop started in Step 1. If not, repeat Step 1 and Step 2 untilS>10.Step 15: Extract the boundary of the dilated cell seed by the following equation.(31)Dj=Cji+1−CjiStep 16: Repeat Steps 13–15 for the next identified cell seed until all the seeds are processed.Please note that the proposed fast method works because the seeds are obtained by erosion while it tries to dilate the seeds back to their original sizes.

@&#CONCLUSIONS@&#
