@&#MAIN-TITLE@&#
Fuzzy classification of pre-harvest tomatoes for ripeness estimation – An approach based on automatic rule learning using decision tree

@&#HIGHLIGHTS@&#
Red-green color difference has the good classification capability than that from individual components R, G, B or red-green ratio in RGB color space.Adaptive segmentation technique segments the unripe tomato images from the background with a good effect.Decision trees for automatic rule learning repudiate the need of a human expert.Automatic fuzzy partitioning of the feature space to over linguistic terms.High true positive rate and lower false positive rate for the proposed fuzzy rule base classification. High classification accuracy achieved by the proposed system over learning algorithms.

@&#KEYPHRASES@&#
Fuzzy rule based classification,Tomato ripeness,Decision trees,Automatic rule learning,Machine vision,Image retrieval,

@&#ABSTRACT@&#
Tomato (Solanum lycopersicum) ripeness estimation is an important process that affects its quality evaluation and marketing. However, the slow speed, subjectivity, time consumption associated with manual assessment has been forcing the agriculture industry to apply automation through robots. The vision system of harvesting robot is responsible for two-tasks. The first task is the recognition of object (tomato) and second is the classification of recognized objects (tomatoes). In this paper, Fuzzy Rule-Based Classification approach (FRBCS) has been proposed to estimate the ripeness of tomatoes based on color. The two color depictions: red-green color difference and red-green color ratio are derived from extracted RGB color information. These are then compared as a criterion for classification. Fuzzy partitioning of the feature space into linguistic variables is done by means of a learning algorithm. A rule set is automatically generated from the derived feature set using Decision Trees. Mamdani fuzzy inference system is adopted for building the fuzzy rule based classification system that classifies the tomatoes into six maturity stages. Dataset used for experiments has been created using the real images that were collected from a farm. 70% of the total images were used for training and 30% images of the total were used for testing the dataset respectively. Training dataset is divided into six classes representing the six different stages of tomato ripeness. Experimental results showed the system achieved the ripeness classification accuracy of 94.29% using proposed FRBCS.

@&#INTRODUCTION@&#
India is an agriculture-based country. Agriculture plays a crucial role in the economy and is the prime source for country's national income. Fundamental factor responsible for consistent marketing of crops is its quality. For many crops, the main indicator of quality is its ripeness. The consumer (wholesaler or retailer) observes the quality of fresh fruits and vegetables from their visual or external appearance. The visual appearance of the crop is used to judge its ripeness, which is measured, by color, size, and shape. Out of these three factors, color is the most important factor. It has high influence on quality and consumers’ preference. For many agricultural products, certain colors are preferred and demand higher selling prices. This is true for apples [1], broccoli [2], and cranberries [3]. Color is one of the most commonly used feature to evaluate maturity for various fruits, vegetables like tomatoes [4], watermelons [5], bananas [6], and dates [7]. Harvesting of fruits and vegetables at proper stage of maturity is of paramount significance for attaining desirable quality. The level of maturity helps in estimation of shelf life, selection of storage methods, and selection of processing operations for value addition. The maturity has been divided into two categories i.e. physiological maturity and horticultural maturity [8]. Horticultural (pre-harvest) maturity refers to the stage of development when a crop is ready for harvest. Physiological (post-harvest) maturity is the stage when a crop is capable of further development or ripening after it is harvested i.e. ready for eating or processing. Quality characteristics such as flavor, texture, and color are sustained when the fruit is harvested at an optimal stage of maturity. Therefore, ripeness monitoring and controlling has become a very important issue in crop industry.Tomato is one of the most important food crops in India, which is marketed all over the country. It is a climacteric fruit i.e. it continues ripening even after it has been harvested. Quality of tomato is judged by its ripeness. Arbitrating the level of ripeness is feasible by analyzing the color of the tomato surface [9]. A classification chart by USDA (United States Department of Agriculture) discriminates six stages of ripening based on color namely green, breaker, turning, pink, light red, red [10]. Fig. 1shows the different ripening stages of tomatoes. The harvesting time depends on the purpose and the distance over which they are to be transported. Tomato should be picked at mature green stage (turning stage) for long distance transport and at later stages of ripeness for short distance transport.Until now, human graders usually estimate optimal harvest date and period of storage life visually with the help of classification chart and through practical experience. However, manual interpretation is subjective. It can also be affected due to tiredness. For the big farms and greenhouses, it is a time-consuming task. Hence, automation of ripeness assessment process is a big gain for agriculture industry. Automatic machine vision can eliminate the inconsistencies in ripeness estimation due to manual evaluation. Machine vision is known to be a useful tool for external feature measurements i.e. size, shape, color and defects.Research on fruits and vegetable harvesting robots has been reported more than 20 years ago but none of them has been practically used so far [9,11–13]. The reason is that operational speed of robots is almost same or slower than the manual speed. Besides, the hardware requirement is too expensive. But with the advancement in data acquisition and storage techniques, the research on harvesting robots has again picked up the momentum and is an exciting research area among researchers [14–17]. Recent developments in agriculture industry have led to the demand for innovative methods that leave the crop intact and do not interfere in its natural growth [15].This study has been conducted with a view to develop a machine vision system for the harvesting robot that performs the recognition of all the ripeness stages of tomatoes specially during turning stage. The proposed approach considers natural lighting conditions and does not interfere in the usual growth of tomatoes. This section further introduces the two tasks of the vision system of harvesting robot.The primary task of the vision system of harvesting robot is the recognition of tomatoes that is done by segmenting the tomatoes from the captured image. In this process, two major difficulties are faced by the harvesting robot. Firstly, it has to work under natural illumination condition and secondly, the background is complicated consisting of branches of leaves, plants and the tomatoes may be connected, overlapped, in bunch, or partially covered by branches and leaves. The segmentation process should be intelligent enough to separate the tomatoes from the complicated background. This process includes two parts. The first part deals in selection of color space to identify the required pixels i.e. pixels that are part of tomato and second considers clustering algorithms to cluster those identified pixels in an image.Color spaces commonly used by harvesting robots include RGB [18], HSI [19], L*a*b* and others. Statistical Hue feature of HSI color space is generally used but the disadvantage of variation in illumination is associated with this color space. Advantage of using RGB color space is that there is no need to do conversion operations since CCD (charged coupled device) signals are made of RGB components only. Whereas, L*a*b* color space makes more sense as it depicts the way, how humans visualize the color. Some approaches have been proposed that are based upon chromatic aberration of an image [20] which is the difference of red band and green band (RG difference) in RGB color space.After the required pixels are identified, they are now clustered together. Common clustering algorithms include constant threshold segmentation, automatic threshold segmentation based on Otsu's threshold, K-means clustering and neural network.Authors Yin et al. [21], proposed an automatic segmentation technique based on RG difference of an image for segmenting multi-tomatoes under complicated natural background. Authors Xiang et al. [20], examined and relatively evaluated three segmentation algorithms based on RG, normalized RG, and multi-band ratio. Authors Yin et al. [22] used L*a*b* color space and k-means clustering to segment the ripen tomato. Authors Wang et al. [23], compared two color spaces viz. hue average and RG difference and suggested that results were better for RG difference of image. Almost all these studies were done for recognition of ripe tomatoes. Since there are unripe tomatoes with ripe tomatoes on a plant, so it is necessary, that algorithm recognizes ripe tomatoes and unripe tomatoes both. Researchers Arefi and Motlagh did the classification of ripe tomato and unripe tomato using Artificial Neural Network (ANN) [24]. The background was removed using RG difference. The biggest disadvantage associated with RG difference method is that it is unable to segment green tomatoes from the background. Authors [25] proposed a segmentation technique that can segment ripe and unripe tomato from the complicated background under natural illumination. During background removal, the specular reflection highlights (white pixel) on the surface of the tomato, were also removed. Therefore, the algorithm interpolates the colored pixels in the neighborhood of the white pixel region to maintain the color integrity of the tomato. In our work, this technique has been used to segment the required objects (tomato) from the captured image.After the recognition of tomatoes, the next step is to classify them into different ripeness stages. Classification process is a comprised of two sub-processes: color feature representation and color categorization.Color must be represented in such a way that it can be categorized. Color representation methods include color histograms, RGB, Hue Saturation Intensity (HSI), CIE Lab [26].Color categorization is performed to classify the colors. Different methods include simple thresholding, color mapping [27], statistical analysis [23,28], fuzzy logic [29], neural networks [24].Authors Choi et al. [9], developed a tomato maturity index (TMI) based on hue value to indicate the degree of maturity. Tomatoes were picked at different maturity stages and images were taken under an experimental setup. RGB values obtained were converted to HSI color vales. A tomato maturity index (TMI) was developed to estimate the degree of maturity within each stage and to provide a continuous index over all maturity stages. The TMI was derived from the aggregated percent surface area below certain hue angles. Algorithm was tested on 120 tomatoes that were classified into six different stages. Classification results agreed with human grading in 77.5% of the tested results. Most of the misclassification occurred between green and breakers stages, between turning and pink, and between light red and red stages.Takahashi et al. [30] proposed a robot system that used an easy operation human interface accompanied with a personal computer display to pick a tomato automatically. The hand of the proposed robot system was composed of scissor and CCD camera that can be actuated in the three orthogonal directions. RGB values of the images were analyzed and the relation between red-blue (R-B) and red-green (R-G) component was formulated as B≤0.8972R and G≤0.8972R respectively. If tomato satisfies these conditions, then it was judged as of red color, and was automatically picked by the robot system.Also, Gezima et al. [28] judged the tomato maturity level using statistical technique and did the comparative study between L*a*b* and RGB color space. Tomatoes were classified into five different maturity stages: 10–20% of full maturity, 30–40% of full maturity, 50–60% of full maturity, 70–80% of full maturity, and full maturity. Unripe stage of tomatoes was not considered during classification. Images were taken under artificial background using an experimental setup containing CCD camera, high-frequency switching setup, monitor, PC, tomato and black carpet. Initially, background was removed and converted to white pixel using R<2 in RGB or b*<−3 in L*a*b* color spaces. Correlation was obtained between histogram of each color system and maturity. In the study, highest value were showed at G(36) and R(35) in RGB color space and at L(50) in L*a*b* color space. The experiments also revealed that with increase of maturity the level of a* increases and b* remains unchanged. 70% accuracy was achieved using RGB color space and 96% by utilizing a* mean.Zhang et al. [17] sorted the tomatoes into defective and healthy sample based on shape, maturity (color), size, surface defects. Color analysis was done based on the average values of red, green, and blue components. Overall accuracy of the system was 90.61%.Syahrir et al. [4] estimated the shelf life of tomato by judging their maturity. Images of tomato were taken from top using PC camera under artificial background. Before extracting a* values, images were enhanced in spatial domain using image filtering and thresholding techniques. Using the a* values the expiry date of tomato was predicted [28]. 50 samples were used in testing and classified as rotten or not rotten. Successful rate of 90% was achieved in estimating the tomato maturity.Yin et al. [31] assertively discussed tomato maturity under natural conditions. Difference between area percentage of red and yellow-green component was used to represent the color feature. Neural network was established to decide the maturity and its accuracy was 95.26%. Lee et al. [27] used third order polynomial to map three-dimensional RGB values to one-dimensional value for quality evaluation of tomato and dates. System achieved 95% accuracy in case of tomato maturity detection.Wang et al. [23], compared and analyzed RGB and HSI color models as a criterion for maturity judgment of tomato. Tomato image samples were taken under natural illumination in the greenhouse using a CCD camera. Samples collected were divided into 5 different stages: breaker, turning, pink, light red, and red. In the preprocessing stage, the RGB image was converted to gray image using red-green color difference after which the Otsu's method was implemented for segmentation and extraction of tomato fruit region. It was shown that hue component was more appropriate than saturation and intensity for judging the maturity stage of tomato. In addition, the hue average tends to decrease progressively with change of maturity. In HSI model, the average accuracy rate achieved was 93%. Whereas in RGB color model, red-green color difference mean seems more assuring than average R, G, B values for judging the maturity. In addition, the red-green color difference value tends to increase with increase in maturity. The average accuracy rate achieved for this model was 96%. However, for both the models the error was reported mainly at the pink stage of maturity.The work discussed above mainly used statistical analysis. However, as compared to statistical classifiers artificial neural networks (ANNs) are considered more flexible in modeling a problem more accurately and are relatively much easier. They have the advantage of changing inputs and outputs, interpolation and exploration, fault tolerance and noise immunity [32]. The work done by authors [33] compared Bayesian learning & NN classifiers for grading carrots showing that the NN approach performed better than Bayesian learning. But if the features are normally distributed, statistical learning can perform equally well or better as ANNs does [34]. The biggest disadvantage of ANN model is that it lacks a profound theoretical basis for its designing. For a given problem, it is difficult to choose the best topological structure i.e. the number of hidden layers, nodes in each hidden layer, and types of transfer function in neurons of different hidden layers. One needs to try different settings for the problem to give the best result.Authors Elhariri et al. [35], investigated the multiclass support vector machine (SVM) approach and random forest (RF) for the estimation of tomato and bell pepper ripeness. A dataset of total 250 images for tomato and 175 images of bell-pepper has been collected from farm. This proposed approach consists of three phases; namely pre-processing, feature extraction, and classification phases. In preprocessing phase, image was resized and background was removed. Next, feature vector was formed as a combination of 1D 16X4X4 HSV histogram and nine color moments for each channel of HSV using a technique namely principal component analysis (PCA). One-against-One multi-class support vector machine (SVM) and random forest (RF) using 10-fold cross validation were compared for ripeness stage classification. Experimental results showed that SVM achieved higher accuracy than RF. System [35] achieved the accuracy of about 92.72% and 93.89% for tomato and bell-pepper respectively.In contrast with the traditional learning techniques, the human experience of generating multidimensional decisions using imprecise and ambiguous information is better simulated by fuzzy logic. Based on membership functions, knowledge base can be built in the way that is more practical. Many practical classification problems have been found to be suitable in fuzzy logic for food equality evaluation, grading of fruits such as apples, mango etc. with computer vision. A fuzzy classifier was developed for sorting apples based on watercore severity using solidity feature [36]. Another interesting application of fuzzy logic was used for grading of mozafati dates using fuzzy inference system (FIS) [37]. In a research paper [38], fuzzy rule based classification approach was used to judge the ripeness stage of mango.Fuzzy logic is also explored for estimating the various ripening stages of tomatoes. Authors [39], proposed the tomato quality rating method based on fuzzy model. Visual attributes like size, color, shape, defects, and abnormalities were obtained using image processing. A fuzzy method was proposed by mapping various fuzzy consumer aspects to overall quality classes. Iraji et al. [29], compared two methods, Fuzzy Mamdani Inference and Adaptive Fuzzy Neural Network (ANFIS) for classification of tomatoes. Images of tomatoes in RGB color space were taken on black background. Seven factors based upon shape, size and texture were taken to classify the tomatoes into nine classes. In their proposed system, ANFIS reported less error and more accuracy.Concisely, learning techniques such as artificial neural network (ANN), statistical learning, fuzzy logic, decision trees, SVM have been applied progressively for crop quality evaluation using computer vision (CV) in recent years. However, ANN and statistical learning remains the prime methods [32]. ANN has limitation on generalization of the results that can over-fit the data. SVM has high classification accuracy for crisp data. In the problem that is studied, the nature of level of ripeness stages is itself fuzzy in nature.Fuzzy logic is capable of dealing with vague, ambiguous and incomplete information. It models the problem in the way, as humans perceive it. Moreover, fuzzy classifier takes less time as compared to ANN and SVM.Nature of agriculture systems creates the need for modeling systems that are robust, interpretable, noise tolerant, takes less time, and are extensible. Fuzzy logic has these characteristics and is being examined for use in control and modeling in many agriculture systems. Fuzzy rule based classification system (FRBCS) is a useful tool based on fuzzy logic to deal with classification problems [40]. These systems are used for good performance. They have capability to build interpretable model that uses common linguistic terms for use in problem domain. FRBCS allows the mingling of information from different sources i.e. expert knowledge, mathematical models or empirical measures. The rules are close to nature of human thinking process. Disadvantage associated with fuzzy logic is that its performance is based upon how well it was tuned and is difficult to model in case of n-dimensional problem. It is difficult to determine the membership function (MF) because the same can be defined in different ways by different people [41]. Therefore, for classification we have proposed fuzzy rule based classification system (FRBCS), which proves to be more promising than other learning algorithms. The proposed fuzzy classification system automatically detects the pre-harvest ripeness of tomato without interfering in its growth under natural conditions.The research of tomato maturity evaluation is generally conducted using an artificial background that interferes with the natural growth of the fruit. This may result in harvesting of under-grown or over-grown fruits. The issues relating to tomato identification under natural and complicated background have not been put forward earlier. Moreover, generally three levels of maturity (under-ripe, ripe, and overripe) have been selected by the existing literatures. However, there is need to classify them into six different stages especially the turning stage which is the deciding factor for harvesting, under natural conditions and background without interfering with their natural growth.The paper is organized as follows. Section 2 explains the concepts of FRBCS, decision trees, fuzzy inference system (FIS). Section 3 presents the methodology adopted for the proposed system in detail. Section 4 discusses the experimental results. Section 5 presents the conclusion and the future research directions.This section gives the brief overview of the concepts of fuzzy rule based classification systems (FRBCS), decision trees, and fuzzy inference system.It is one of the most prevalent approaches used in pattern classification problems due to its advantage of interpretability. FRBCS have been recently applied in classification problems for medical applications, geographical systems etc. Fuzzy logic helps in quickly transforming the expert knowledge into the computer program in form of simple if-then-rules. Moreover, expert knowledge reduces the search space when optimizing the system. The process of designing a fuzzy rule based classification system involves the following steps:•Step 1: define the input and output attributes.Step 2: feature space fuzzy partitioning or construct membership functions (MFs).Step 3: generate fuzzy rule base for the system.Step 4: feed the MFs and rule base to fuzzy inference system (FIS).Step 5: defuzzify the output.A decision tree (DT) is a tree-based exemplification of knowledge used to represent the classification rules [42]. Internal nodes of tree represents test on an attribute, each branch represents outcome of test and leaf node represents class label. Traversing the branch from root to leaf node decodes the information enclosed in the form of if-then statements and each branch leads to the single rule [43]. Therefore, DT can be exploited to automatically generate the rules without the need of a human expert. Advantages of using DT are that first, it does not require data normalization and blank values to be removed. Second, it is able to handle both numerical and categorical data. Third, the description for the condition is easily explained by Boolean logic, which is desirable. Fourth, it performs well with large datasets and analyzes those using standard computing resources in reasonable time. Moreover, the rules are automatically modified based on the experimental dataset provided to the decision trees.A fuzzy inference system (FIS) is a system that uses fuzzy set theory to map inputs (features) to outputs (classes). Two types of FIS are Mamdani and Sugeno. Mamdani's fuzzy inference method [44] is the most commonly seen fuzzy methodology proposed in 1975 by Ebrahim Mamdani. It is based on Lotfi Zadeh's work on fuzzy algorithms for complex systems and decision processes. Mamdani-type inference, expects the output membership functions to be fuzzy sets. Advantage of Mamdani system is that it has widespread acceptance and is well suited to human input. Whereas, Sugeno-type systems are similar to Mamdani-type systems except that the output membership functions are either linear or constant. Further, Mamdani FIS is briefly discussed further as it has been used in the proposed system. FIS uses a collection of fuzzy membership functions and rules for reasoning data. The most commonly used membership functions are: triangular, trapezoidal, bell curves, Gaussian, and sigmoidal. Of these, the simplest is the triangular membership function, and it has the function name trimf. It is a collection of three points forming a triangle. The rules are of the form:if p then q, where p and q are fuzzy statementsThe set of rules in a FIS is known as knowledge base. The functional operations in FIS proceed as follows: fuzzification of the input, fuzzy inference (apply implication method), aggregation of all outputs, and defuzzification. MATLAB fuzzy logic toolbox provides facility for the development of fuzzy-logic systems using both the graphical user interface (GUI) tools and command line functionality. The FIS GUI tool can be started in MATLAB using the command fuzzy. The FIS Editor GUI tool allows editing the features of the fuzzy inference system, such as the number of input and output variables, the defuzzification method used. It consists of five primary tools:-•Fuzzy Inference System (FIS) EditorMembership Function EditorRule EditorRule ViewerSurface Viewer

@&#CONCLUSIONS@&#
