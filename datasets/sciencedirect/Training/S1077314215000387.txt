@&#MAIN-TITLE@&#
Spectral gradient fields embedding for nonrigid shape matching

@&#HIGHLIGHTS@&#
An embedding of 3D-shapes using spectral gradient fields (GFs).It is based on the inner and external products of pairs of eigenfunctions.The embedding naturally defines a distance measure between nonrigid shapes.The method achieves state-of-the-art performance on correspondence benchmarks.

@&#KEYPHRASES@&#
Correspondence,Laplace–Beltrami operator,Shape embedding,

@&#ABSTRACT@&#
A popular approach for finding the correspondence between two nonrigid shapes is to embed their two-dimensional surfaces into some common Euclidean space, defining the comparison task as a problem of rigid matching in that space. We propose to extend this line of thought and introduce a novel spectral embedding, which exploits gradient fields for point to point matching. With this new embedding, a fully automatic system for finding the correspondence between shapes is introduced. The method is demonstrated to accurately recover the natural maps between nearly isometric surfaces and shown to achieve state-of-the-art results on known shape matching benchmarks.

@&#INTRODUCTION@&#
The embedding of manifolds into some Euclidean space is often used for simplifying matching and comparison procedures [1–3]. A useful property of such a target metric space is that corresponding points of different isometric shapes are mapped to nearby points in the target space. In that case, the embedding of multiple isometric shapes into this common target space naturally leads to a distance between shapes that is easy to compute. Recently, attention has been given to the spectral type of embedding that use the eigenvalues and eigenfunctions of the Laplace–Beltrami operator of the shape as a target space [2,4–6]. The fact that the Laplace–Beltrami operator is invariant to isometric deformations makes spectral embedding well suited for comparing the same object in different poses and expressions.Bérard et al. [1] exhibited the spectral embedding of Riemannian manifolds by their heat kernel. They embedded manifolds into a compatible common target space (infinite Hilbert space) and used the Hausdorff distance in that space to define a metric between isometry equivalent classes of Riemannian manifolds. It means, in particular, that two manifolds are at zero distance if and only if they are isometric.Rustamov [4] introduced the global point signature (GPS) of a point on a shape. It encodes both the eigenvalues and the eigenfunctions of the Laplace–Beltrami operator evaluated at that point. The GPS kernel is, in essence, the integration over all scales of the heat kernel on the surface [7]. The GPS kernel coincides with the Green’s function, and in some sense measures the extent to which two points are geometrically connected. He showed that the GPS embedding of a surface without self-intersections has no self-intersections as well.A different approach was introduced by Sun et al. [5] Their signature, called the heat kernel signature (HKS), is defined for every point of the shape, by observing the heat kernel in that point over time. The set of all HKS on a shape characterizes a given surface up to an isometry under the condition that the eigenvalues of the Laplace–Beltrami operator are non-repeating. The invariance of the heat kernel signature to isometric deformations ensures that this signature can be used to find correspondence between different poses of the same shape.We propose a novel spectral embedding, using gradient fields (GFs) of the Laplace–Beltrami operator eigenfunctions, for correspondence detection. We call the gradient fields of the eigenfunctions, spectral gradient fields (or spectral GFs), and refer to the proposed embedding as the spectral gradient fields embedding. As Laplace–Beltrami eigenfunctions computed independently for different shapes are often incompatible with each other, the aim of our construction is to embed the shapes using the eigenfunctions that correspond to the lowest eigenvalues. While existing methods [1,4] use the eigenfunctions themselves to define the target space, we embed the shapes using pairs of eigenfunctions. Thereby, more information is being extracted from the interaction between the relatively stable first few eigenfunctions.We propose to find correspondence by embedding the shapes using a point-wise feature vector, which is based on the inner and external products between the GFs of pairs of eigenfunctions. For each pair of eigenfunctions ϕi, ϕj, that correspond to the eigenvalues λi, λj, we calculate their respective gradient fields ∇ϕi, ∇ϕj, and compute the inner product 〈∇ϕi, ∇ϕj〉, and the external product taken as the cross product in the normal direction((∇ϕi×∇ϕj)·n). Fig. 1presents two eigenfunctions and their corresponding spectral GFs inner and external products. Because the inner and external products depend on the eigenfunctions and the gradient operator, they are relatively stable under isometric deformations, different poses and articulations. These features enable us to extract fine geometric information from a pair of eigenfunctions, as well as obtaining the global structure of an object. For the human shape shown as an example in Fig. 1, the inner product (third column and enlarged figure) distinguishes between the neck’s left and right sides, while the external product (fourth column) partitions the body’s front and back.The proposed feature vector defines an embedding of shapes into Euclidean space. To the best of our knowledge, this is the first time that spectral gradient fields are used for such an embedding (see Table 1 for a summary of existing embedding methods). We prove that the proposed spectral gradient fields embedding is injective. Therefore, it naturally induces a distance function between any two points on the surface. In this metric space a distance between shapes is relatively simple to compute. We define such a distance measure, which we refer to as the spectral gradient fields distance, in a way similar to the definition of the spectral embedding distance defined by Bérard et al. [1]. In the classic spectral embedding, the target space is described by the eigenfunctions of the Laplace–Beltrami operator. In the proposed target space, we embed the shapes into a much richer space, by using the conformal-based inner product between GFs of the eigenfunctions [8]. We describe the properties of the proposed distance measure, and prove that it is a pseudometric.A metric space (X, dX) is a pair, where X is a set anddX:X×X→R≥0is a well defined distance function, satisfying the symmetry propertydX(x1,x2)=dX(x2,x1), the identity propertydX(x1,x2)=0iffx1=x2, and the triangle inequalitydX(x1,x3)≤dX(x1,x2)+dX(x2,x3)for any x1, x3 ∈ X. If the distance dX(x1, x2) between two distinct points can be zero, then (X, dX) is called a pseudometric space.Suppose A, B ∈ X are two closed subsets of a common bigger metric space (X, dX), and we want to compare A to B in order to decide whether they represent the same object or not, one might compute the Hausdorff distancedH(A,B)between A and BdH(A,B)≡APTARANORMALmax(supa∈Ainfb∈BdX(a,b),supb∈Binfa∈AdX(a,b)),and designate two objects A, B ∈ X as being identical, ifdH(A,B)=0.A different approach to compare objects, is to treat them as metric spaces, and check if these metric spaces are isometric or not. We say the metric spaces (X, dX) and (Y, dY) are isometric when there exists a bijective mapping φ: X → Y such thatdX(x1,x2)=dY(φ(x1),φ(x2))for all x1, ∈X. Such a φ is an isometry between (X, dX) and (Y, dY). In other words, an isometry between two shapes is a map between their two dimensional surfaces that preserves the distances between any two points.For example, when considering shapes as two-dimensional Riemannian manifolds embedded in the three dimensional Euclidean space, and if one is interested in invariance to deformations of a surface that preserve the geodesic metric, then the surfaces can be treated as metric spaces equipped with the geodesic distances of the Riemannian manifold [9,10].Let X be a Riemannian manifold. For any smooth functionf:X→Rthe gradient of f is the vector field ∇f defined through the Riemannian manifold’s inner product, such that for any vector field U,〈∇f(x),U(x)〉=∂Uf(x),where ∂Uf(x) is the directional derivative of f at x ∈ X, in the direction U(x).The Laplace–Beltrami operator, denoted by Δ, is the divergence of the gradientΔf≡div0.35em0exgrad0.12em0exf,and can be considered as a generalization of the standard notion of the Laplace operator to compact Riemannian manifolds [11–13]. The Laplace–Beltrami operator is invariant to geodesic-preserving deformations because it is defined in terms of the surface metric tensor which is isometry invariant.The eigendecomposition of−Δconsists of nonnegative eigenvalues0=λ0<λ1≤⋯≤λi≤⋯, satisfying−Δϕi≡λiϕi.The set of corresponding eigenfunctions given byΦ≡{ϕ0,ϕ1,⋯,ϕi,⋯},forms an orthonormal eigenbasis, such that∫Xϕi(x)ϕj(x)dV=δij, where dV is the volume element on the manifold X.Bérard et al. [1] used the spectral properties of the heat operator etΔto define a metric between two Riemannian manifoldsX,Y∈M. Here,Mis the set of all closed (i.e. compact without boundary) Riemannian manifolds of dimension n. Given a Riemannian manifoldX∈Mwith volume Vol(X) and some t > 0, they based their metric on the eigendecomposition of the heat kernel and defined the spectral embeddingItΦ:X→ℓ2from the Riemannian manifold X into the Hilbert space ℓ2 of real valued square-summable sequencesItΦ(x)≡{Vol(X)e−λit/2ϕi(x)}i≥1,utilizing the eigenfunctions ϕiand eigenvalues λiof the Laplace–Beltrami operator Δ.Given a pair of eigenbases ΦX, ΦY, they embedded the two Riemannian manifolds X and Y intoItΦXandItΦY, respectively. Then, they measured the Hausdorff distancedHbetween the manifolds in the common ℓ2 space. Bérard et al. defined the distancedtEMB:M×M→R≥0between the manifolds X, Y, as the upper-bound of the Hausdorff distance between any eigenbasis ΦXand its closest counterpart ΦY.dtEMB(X,Y)≡APTARANORMALmax(dIt(X,Y),dIt(Y,X)),dIt(X,Y)≡sup{ΦX}inf{ΦY}dH(ItΦX,ItΦY).We calldtEMB(X,Y)the spectral embedding distance (for a detailed description of the spectral embedding distance, we refer the reader to [1]). They showed that for any fixed t > 0, the spectral embedding distancedtEMBis a metric between isometry classes of Riemannian manifolds. In particular,dtEMB(X,Y)=0if and only if the Riemannian manifolds X and Y are isometric.A spectral gradient field is a tangent vector field defined as the gradient of an eigenfunction ∇ϕi. The feature vector we define is based on the inner product between two spectral gradient fields,ωi,j:X→Rfor all i, j ≥ 1, where(1)ωi,j(x)≡Vol(X)(λiλj)−1〈∇ϕi(x),∇ϕj(x)〉.For the special case that the Riemannian manifold is an oriented two-dimensional manifold embedded inR3, we enrich the feature vector by using the cross product between two spectral GFs in the normal direction,νi,j:X→Rfor all i, j ≥ 1, where(2)νi,j(x)≡Vol(X)(λiλj)−1((∇ϕi(x)×∇ϕj(x))·n(x)).Let us study the embedding and the distance between shapes that are induced by this feature vector. We limit our analysis to the inner product between the gradients of the eigenfunctions. Thus, we define the spectral GFs embeddingJtΦ:X→ℓ2asJtΦ(x)≡{e−(λi+λj)t/2ωi,j(x)}i,j≥1,1em0ext>0.Proposition 1Let x1, ∈X be two distinct points on the Riemannian manifoldX∈M. Then, there exists a smooth function f, such that∇f(x1)0.25em0ex≠0.25em0ex0, and∇f(x2)=0.The proof of Proposition 1 is given in A.Theorem 1For a Riemannian manifoldX∈M, the embeddingJtΦ:X→ℓ2is injective, i.e.x10.25em0ex≠0.25em0exx2⇔JtΦ(x1)0.25em0ex≠0.25em0exJtΦ(x2).The proof is motivated by Rustamov’s analysis of his GPS embedding [4]. Suppose that for two different points x1, ∈X, we haveJtΦ(x1)=JtΦ(x2). This means that for all i, j ≥ 1, we have〈∇ϕi(x1),∇ϕj(x1)〉=〈∇ϕi(x2),∇ϕj(x2)〉. Now, any smooth scalar functionf:X→Rcan be represented as a linear combination of the eigenbasisf=∑iaiϕi. We can thereby write the norm of the gradient as∥∇f(x1)∥2=∑i,jaiaj〈∇ϕi(x1),∇ϕj(x1)〉=∑i,jaiaj〈∇ϕi(x2),∇ϕj(x2)〉=∥∇f(x2)∥2.On the other hand, using Proposition 1, there always exists a smooth function f, such that∥∇f(x1)∥0.25em0ex≠0.25em0ex∥∇f(x2)∥, a contradiction. Therefore,JtΦ(x1)0.25em0ex≠0.25em0exJtΦ(x2).□The family of maps{JtΦ}t>0is invariant to global scaling of the metric.See Appendix B for a proof of this Theorem.Given a Riemannian manifoldX∈M, the embeddingJtΦ:X→ℓ2induces a metricd˜X:X×X→R≥0on the manifold, in a way that the distance between any two points x1, ∈X coincides with the distance between the images of these points in the ℓ2 spaced˜X(x1,x2)≡∥JtΦ(x1)−JtΦ(x2)∥ℓ2.The metricd˜X(x1,x2)is a well defined distance function which is invariant to the choice of the orthonormal eigenbasis Φ.LetX,Y∈Mbe the two closed Riemannian manifolds we would like to compare, and let us be given some t > 0. Given a pair of eigenbases ΦX, ΦY, we embed the two Riemannian manifolds X and Y intoJtΦXandJtΦY, respectively, and measure the Hausdorff distancedHbetween the manifolds in the common ℓ2 space. We define the spectral gradient fields distance, denoted bydtGF:M×M→R≥0, as the supremum of the Hausdorff distance between any eigenbasis ΦXand its closest counterpart ΦY.dtGF(X,Y)≡APTARANORMALmax(dJt(X,Y),dJt(Y,X)),dJt(X,Y)≡sup{ΦX}inf{ΦY}dH(JtΦX,JtΦY).We say that X, Y are spectral gradient fields equivalent, if the metric spaces(X,d˜X),(Y,d˜Y)are isometric and ifdtGF(X,Y)=0.Theorem 3The spectral GFs distancedtGFis a pseudometric between spectral GFs equivalent classes of Riemannian manifolds.The proof of Theorem 3 is given in C.RemarkThe use of the spectral GFs external product((∇ϕi×∇ϕj)·n(x))is obviously restricted to oriented two-dimensional surfaces embedded in the three-dimensional Euclidean space. Although the cross product of two tangent vectors is extrinsic in nature, its projection in the normal direction is invariant to isometric deformations. Consequently, for a two-dimensional surface embedded inR3, adding the elementse−(λiX+λjY)t/2νi,jfor all i, j ≥ 1 to the embeddingJtΦ, leaves the above analysis unchanged. Hence, the statements of Theorems 1–3 hold for the extended feature vector as well.The spectral GFs distancedtGFis a metric between spectral GFs equivalent classes of Riemannian manifolds.We consider Conjecture 1 in C. We believe that a proof of this conjecture is beyond the scope of this paper and leave it to future work.

@&#CONCLUSIONS@&#
A new feature vector for embedding nonrigid shapes was introduced and integrated into a holistic shape matching system. The embedding, which is proved to be injective, induces a distance between points on the surface, and can be defined to measure a distance between shapes. We have demonstrated the effectiveness of the proposed approach by achieving state-of-the-art results on shape matching benchmarks.In the future, we plan to examine the properties of the GFs embedding in conjunction with compatible functions on the two shapes, that are different from the eigenfunctions. For example, one may use the heat kernel signature (HKS), wave kernel signature (WKS) [6] or the heat kernel maps (HKM) [20] set with landmark correspondences. These options seem particularly useful when the shapes are noisy, or the deformations are large, making the eigenfunctions incompatible.