@&#MAIN-TITLE@&#
A switching hybrid control method for automatic blood glucose regulation in diabetic Göttingen minipigs

@&#HIGHLIGHTS@&#
Presentation of a new hybrid switching control method for blood glucose control in diabetic Göttingen minipigs.Explanation of animal trials: Göttingen minipigs, diabetes induction, protocol for controller-based and manual insulin therapy.Introduction of a switching control method and controller design by means of two mathematical models of the porcine glucose metabolism.Experimental evaluation of control method by animal trials taking into account control performance and technical limitations.Results: controller-based insulin therapy is superior to manual insulin treatment.

@&#KEYPHRASES@&#
Blood glucose control,Switching control method,Impulsive control process,Diabetic Göttingen minipigs,

@&#ABSTRACT@&#
A new hybrid control method for blood glucose concentration is developed which switches between two operation modes. The effects of meal-induced disturbances on blood glucose concentrations are expected to be more serious than the time-varying behaviour of glucose metabolism during nocturnal phases. Thus, the control method determines insulin impulses (boli) as a manipulated variable during the day and calculates continuous insulin infusion (basal rates) at night. To test the controller-based insulin therapy in vivo, animal trials with diabetic Göttingen minipigs are used as a proxy for human studies. The controller parameters are selected by in silico studies based on mathematical minipig models, and the resulting individualised controllers are experimentally verified. For this, two control performance requirements must be taken into account: blood glucose concentrations below the critical threshold of 50mg/dl have to be avoided, and blood glucose peaks caused by ingestion of minipig diet have to be quickly counteracted. Results from these animal experiments show that the closed-loop system satisfies both control requirements and improves insulin therapy compared with a standard therapeutic protocol.

@&#INTRODUCTION@&#
In healthy subjects, the blood glucose concentration is stabilised by the pancreas in the physiological normal range of 80–120mg/dl. In the case of type 1 diabetes patients, the natural mechanism for blood glucose control is damaged. This means that, in particular, the β-cells in the pancreas which normally produce and release the glucose-reducing hormone insulin are destroyed. Therefore, in the absence of any form of insulin therapy, the fasting blood glucose concentration in type 1 diabetes patients increases to an unphysiologically high level compared to nondiabetic steady-state glucose concentration.Until now, the diabetic patients are challenged by having to manually adjust the required insulin doses in a discrete-time process, whilst also estimating potential metabolic disturbances, e.g. carbohydrate ingestion or physical activity. To reduce blood glucose variability and related health risks, the control process needs to be transformed into a continuous-time system, which has been termed an ‘artificial pancreas’ (Fig. 1). In this case, the blood glucose concentration is measured continuously by means of an implanted sensor and insulin is infused continuously via a pump. A control algorithm between the sensor and actuator calculates the insulin dose required by the patient, thereby implementing a true closed-loop system.In recent decades, the growth rate in the incidence of diabetes has stimulated efforts to refine insulin therapy and improve blood glucose regulation, thereby preventing secondary complications of diabetes. To this end, many ideas concerning therapy devices and control algorithms have been published, as reviewed e.g. in [1,2]. Different simulation platforms, including a mathematical diabetic patient model, were developed and are used to test control algorithms [3–6]. Recently, some research groups have focused on clinical closed-loop studies [7–11]. However, the risk of insulin overdose remains; this can lead to hypoglycaemia (low blood glucose concentration) with a potential life-threatening situation for the patient, due to the following uncertainties related to both the signal and process:•The continuous glucose measurement systems (CGMS) which are commercially available provide a low-pass filtered glucose signal due to the subcutaneous measurement; this may not be reliable enough for control application [12,13].Commercially available insulin pumps deliver insulin subcutaneously resulting in a time delay between insulin application and arrival in blood.The metabolic response to insulin is time-variant; this results in uncertainties regarding the effect of insulin on the blood glucose concentration.To develop a reliable therapy system which can be applied to diabetic humans in everyday situations, diabetic animals represent a proxy of type 1 diabetes patients for the initial control tests. Here, animal trials can be regarded as an intermediate step between in silico and in vivo control evaluations to test therapy systems under realistic conditions [14,15].The present project focuses on the development of an artificial pancreas for diabetic Göttingen minipigs; the metabolism of these pigs is comparable to that in humans [16]. To present the new control method and the corresponding strategy for control design, this paper1briefly introduces the animal trials and two mathematical models of porcine glucose metabolism (Section 2, see also [17]),explains the control challenges and limitations, and introduces a hybrid switching control algorithm for blood glucose stabilisation in the animals (Sections 3–5), andexperimentally evaluates the control performance (Section 6).In n=8 Göttingen minipigs an acute diabetes mellitus was chemically induced, see [18]. Subsequently, the impulse response behaviour of the porcine diabetic glucose metabolism to external glucose and insulin stimuli was analysed by means of blood glucose measurements. For manual and controller-based insulin application an insulin pump for human therapy (Accu-Chek® Combo Spirit, Roche Diagnostics, Rotkreuz, Switzerland) was applied, and for continuous glucose monitoring in the subcutaneous space a CGMS (G4™ Platinum, Dexcom™, San Diego, CA, USA) was used. Via two central venous lines, blood samples were drawn manually for reference measurement of blood glucose with a blood gas analyser (ABL 810 Flex, Radiometer Medical ApS, Herlev, Denmark). Due to different aims of the trials and to the individually varying clinical conditions of the animals, the controller tests were performed in minipig (MP) 7 and MP 8 only. For detailed information see [18,17].The entire study protocol was approved by the Animal Care and Use Committee of the State Agency for Nature, Environment and Consumer Protection, North Rhine-Westphalia, Germany.To approximate the glucose metabolism of diabetic minipigs by a mathematical model, the nonlinear complex human model of Sorensen [5] was used as a basis. This is the only model that includes subsystems for glucose as well as for both of the counteracting hormones, insulin and glucagon. The Sorensen model was extended and the model parameters were adapted to diabetic Göttingen minipigs as a new species. For more information on the resulting 16th-order model, see [17].For controller design and initial selection of the controller parameters, the nonlinear complex model was reduced to a 5th-order linear model which consists of a disturbance transfer function Gyd(s) and a command transfer function Gu(s) (Fig. 2). The model parameters were determined by minimising the difference between calculated blood glucose trajectories of the nonlinear model and its linear approximate resulting from impulse-shaped input signals of oral glucose uptake Doral(t) or subcutaneous insulin dosage Usc(t). Here, the function fminsearch of the MATLAB/Optimization toolbox was applied, and the impulse responses of the nonlinear model served as reference signals. The model simplification was performed twice for MP 7 due to the different physiological conditions and once for MP 8. The resulting disturbance and command signal transfer functions are described in the following sections with the corresponding parameters shown in Table 1.Disturbance transfer function. The effect of orally uptaken glucose on the blood glucose concentration is approximated by an IT1-element(1)Gyd(s)=Kds·(Td·s+1).Here, Tdcan be interpreted as the glucose transient time through the gastro-intestinal tract and Kdas the glucose bioavailability. To determine the parameters Kdand Td, the glucose trajectory of the nonlinear minipig model resulting from a disturbance impulse of(2)Doral(t)=1gGlucose·δ(t)was used as a reference signal. δ(t) is the dirac function.Command transfer function. The effect of subcutaneously applied insulin on the blood glucose concentration is comparable to a PT3-behaviour given by the command transfer function Gu(s)(3)Gu(s)=Ku(Tu·s+1)3.For the sake of simplification, a triple pol was chosen atTu−1. Here, Tucan be interpreted as the time constant between insulin delivery and its effect on the blood glucose concentration and Kuas insulin sensitivity. The insulin sensitivity describes the amount of glucose which is transported into the muscle cells related to the amount of insulin that is present. The smaller the amount of insulin necessary for the transport of the same amount of glucose, the more sensitive the muscle cells.The response behaviour of the nonlinear minipig model to a subcutaneously injected insulin impulse of(4)Usc(t)=1IUInsulin·δ(t)is used as reference with IU being the abbreviation of international units.Several closed-loop performance requirements, R, and control constraints, C, limit the flexibility of the control algorithm; these are addressed separately in the following section. In the control system, the blood glucose concentration GP(t) [mg/dl] is the control variable, the subcutaneous delivery rate of insulin Usc(t) [mIU/min] is the manipulated variable, and the ingestion rate of pure glucose is the process disturbance signal Doral(t) [mg/min] (see Fig. 2).Acceptable steady-state range. The normo-physiological range of the blood glucose concentration in nondiabetic subjects is 80–120mg/dl. The glucose metabolic behaviour is affected by a time-varying insulin sensitivity and disturbances such as ingestion or physical activity. Due to these uncertainties, the acceptable steady-state range for diabetes is(5)GP,diab=[70,…,180]mg/dl.On the long-run, high blood glucose concentrations(6)GP(t)>180mg/dlmay cause secondary complications. In contrast, low blood glucose concentrations(7)GP(t)<70mg/dlmay induce acute critical situations, such as a sudden loss of consciousness. Hence, the most important closed-loop performance requirement is to prevent a drop in blood glucose below the critical threshold(8)R−1:GP(t)>!GP,crit.As minipigs have a slightly lower normoglycaemic range than humans, the critical threshold was adjusted to(9)GP,crit=50mg/dl.Disturbance response. In nondiabetic subjects ingestion causes a fast but very brief increase in blood glucose despite a natural feed-forward control mechanism which is activated by the nervous system [19]. The height of the glucose peak varies depending on the carbohydrate content of the food. Hence, a diabetic subject with a defective control system also has to manually replace the defective feedforward-feedback control mechanism. The aim is to counteract a meal-induced glucose rise as quickly as possible. For the animal trials, the blood glucose settling time was set to(10)R-2:Tset≤180minso that the acceptable blood glucose range for diabetic subjectsGP,diabis reached before the next meal is uptaken.The following control constraints arise because the closed-loop system was experimentally tested in animal trials.Control variable. Currently, no continuously measuring glucose sensor is commercially available which reliably determines the blood glucose concentration to realise control applications. For this reason, either subcutaneous glucose sensors have to be used, or blood glucose has to be measured by means of blood samples. With respect to application in animal studies, the second method was chosen which proved to be much more precise and accurate in swine. Due to a manual protocol, the blood sampling time T0 is defined to be at least(11)C-1:T0=15min+x,|x|<5minallowing small variations x. With respect to animal welfare guidelines, the total blood sampling per day is limited to a given volume relative to the animal's body weight.Control input. The insulin infusion rate as control input of the closed-loop system is physically bounded to(12)C-2:Usc(t)≥0IU/min.In addition, due to technical limitations of the insulin pump used, the control input signal Usc(t) is not fully continuous. Instead, it has to be quantised to step sizes of(13)C-3:ΔUsc=0.1IU.Depending on the sampling frequencyT0−1of the control variable, the step size ΔUsc might be in the same range as the absolute value of the control input signal.Finally, insulin is delivered subcutaneously. This mode of application induces a maximum delay of the insulin effect on the blood glucose concentration of about(14)C-4:TscI,max≈55min.Process dynamics. A process parameter which has a strong effect on the metabolism is the time-varying insulin sensitivity of the muscle cells(15)C-5:kIS=f(t).Depending on the genes, obesity and environment, large diurnal inter-individual and intra-individual variations of insulin sensitivity exist [19,20], which were also observed in diabetic minipigs during manual insulin therapy protocols (see Section 7.2). This variation in insulin sensitivity leads to uncertainties with respect to the control input signal.According to Bellman [21], a drug application mode can be regarded as an impulse control process at discrete administration times tk, k=0, 1, 2, …, N≤∞. Insulin is generally given by so-called boli (impulses). Therefore, the control task for blood glucose control is a specific application example of an impulse control process.Taking all these control constraints, C, and performance requirements, R, into account, the following controller structure has been developed:•Switching structure to distinguish between variation in blood glucose, which are assumed to be more serious during the day than at night.Impulsive insulin delivery during the day, which can be triggered at the insulin pump by remote control with a relatively high frequency.Continuous insulin delivery at night, which has to be set manually at the insulin pump requiring a low adaptation frequency.Command signal generator to vary the setpoint value, depending on the time of day.PI-algorithm as a basic control law to guarantee closed-loop robustness.Fig. 3depicts the entire closed-loop system including the control constraints C-1 to C-5. The glucose sampling is symbolised by the switches, and the technical limitations of the insulin pump are considered by the saturation and quantisation symbols. ‘CSG’ is the command signal generator. In contrast to common discrete-time control systems, the zero-order holds (ZOHs) are located in front of the two different controllers. In this way, a continuous-time signal of the manipulated variable can be realised, and the control law responds to slight frequency variations which occur due to a manually performed control protocol. The dirac function symbol in the upper path represents the impulsive application of insulin during the day. The different aspects of the control laws are explained in detail below.In diabetic minipigs, high blood glucose variations are expected during the day due to several glucose ingestion times; at night, in the sleeping phase, no disturbances are assumed. Hence, the controller has to rapidly respond to meal-induced increases in blood glucose during the day, but a slower reaction in nocturnal phases is expected to be sufficient. In the absence of a continuously measuring glucose sensor, the controller switches between two blood sampling intervals(16)T0day=15min,T0night=60min.In doing so, it also reduces the blood volume drawn per day with respect to the animal's welfare. The switching times are coordinated with the daily light-dark shifts in the animal housing which are scheduled as follows:(17)Tday=[7a.m.…7p.m.)(18)Tnight=[7p.m.…7a.m.).In parallel, the controller gain and the command signal generator are changed (see below).As the insulin pump allows remote-controlled release of insulin boli, an impulse-shaped signal is chosen as control input during the dayTdaywhich is manipulated four times per hour. With subcutaneous insulin application, the appearance of insulin in blood is delayed with the time constant for maximum insulin action ofTscI,maxdue to a diffusion process. As the sampling time during the dayT0dayis smaller thanTscI,max, impulse-shaped and continuous-time insulin application modes have similar effects on the control variable.The impulsive day controller is implemented as a continuous-time function with a constant setpoint value GP,sp. It assumes a blood sampling at constant time points(19)kT0day,k=0,1,2,…,N≤∞.Due to possible variations in sampling time tk(Fig. 4), the controller may overestimate or underestimate the insulin impulse heightuˆday(tk)which is calculated as an integral over the estimated subsequent time interval(20)[tk…(k+1)T0day]beginning at the current sampling time tk(Eq. (22)). For comparison, the amount of insulin really required is given by uday(tk) (Eq. (23)). The correction factor Δu(tk−1) takes into account the insulin oversupply or undersupply of the preceding control step k−1 (Eq. (27)).The resulting control law for the impulsive day controllerGPIday(s)is given as follows:(21)Usc(t)=∑k=0Nuˆday(tk)·δ(t−tk),t∈Tday,k=0,1,2,…,N≤∞(22)uˆday(tk)=∫tk(k+1)T0dayfday(τ′)dτ′+Δu(tk−1)(23)uday(tk)=∫tktk+1fday(τ′)dτ′+Δu(tk−1)(24)fday(τ′)=Kday·ek+1TI∫tkτ′ekdτ+uIk(25)ek=GP,sp−GP(tk)(26)uIk=T0TI∑i=0i=kei,uI0=uI(tinit)(27)Δu(tk−1)=0fork=0,1uday(tk−1)−uˆday(tk−1)else.δ(t) indicates the dirac function, the control error is ekat time tk(Eq. (25)), and uIkis the initial value of the integral (Eq. (26)) which is defined in Eq. (41).At night, instead of insulin boli, the continuous insulin basal rate is calculated at reduced blood sampling times(28)kT0night,k=0,1,2,…,N≤∞,as the basal rate has to be set manually at the insulin pump. The continuous night control law which consists of step functions σ(t) is given by:(29)Usc(t)=∑k=0Nuˆnight(tk)(k+1)T0night−tk·(σ(t−tk)−σ(t−tk+1))t∈Tnight,k=0,1,2,…,N≤∞(30)ek=GP,sp−GP(tk)(31)uˆnight(tk)=∫tk(k+1)T0nightKnight·ek+1TI∫tkτ′ekdτ+uI(tk)dτ′(32)unight(tk)=∫tktk+1Knight·ek+1TI∫tkτ′ekdτ+uI(tk)dτ′(33)uIk=T0TI∑i=0i=kei,uI0=uI(tinit).Again,uˆnight(tk)is the controller estimated amount and unight(tk) the amount of insulin really required. The pump does not infuse the insulin continuously, but injects small insulin boli every 3min. As the manual process from blood sampling to basal rate setting generally takes ≤3 min, re-adjustment of the control input signal to slight sampling variations (Eq. (27)) is neglected for the night controller. Both the integral initialization uIkand the control error ekare the same as stated for the impulsive realisation, and uIkis initialised according to Eq. (41).Due to varying insulin sensitivity (see C-5), a command signal generator is included. During the day, the setpoint valueGP,spdayis set to a commonly used glucose level in human blood glucose control tests [22,23]. At night, the setpoint valueGP,spnightis slightly increased to reduce the probability of a drop in blood glucose below the critical threshold GP,crit(34)GP,spday=130mg/dl∈GP,diab(35)GP,spnight=150mg/dl∈GP,diab.The corresponding command signal GP,sp(t) is given(36)GP,sp(t)=pfall(t)ift∈TfalldayGP,spdayift∈Tprise(t)ift∈TrisedayGP,spnightift∈Tnightwith(37)T=Tday∖{Tfallday∪Triseday}(38)Tfallday=[7a.m.…8a.m.](39)Triseday=[6p.m.…7p.m.].It consists of the two setpoint values, and two 3rd-order polynomial functions pfall(t) and prise(t), which describe the transient behaviour between the constant setpoints (see dashed line in Fig. 9)To design a robust controller with respect to measurement noise, sampling frequency variation, and uncertain effects of the input signal caused by the varying insulin sensitivity, a PI-controller is chosen as basic control law(40)GR(s)=KR·xK+1TI·xT·s.Here, KRand TIare selected by classical loop shaping criteria, when xK=xT=1. Afterwards, xKand xTare re-adjusted by means of virtual control trials (see Section 5.3) whilexK=xKdayis increased during the day andxK=xKnightreduced at night to amplify or reduce the effect of the controller integral, respectively.In total, the control algorithm is based on discrete-time blood glucose measurements at varying frequency and calculates either an impulse-shaped or continuous-time signal of the manipulated variable Usc(t). During the day, an impulsive control law is used which is given in Eqs. (21)–(27); at night, a continuous control law is given, see Eqs. (29)–(33). To accelerate the controller response at the beginning of the control trial, the integral is initialised by the blood glucose concentration which is measured at tinit 1h before the start of the test GP(tinit)(41)uI(tinit)=1TI·(GP,sp(t0)−GP(tinit))·(t0−tinit),tinit<t0.The time of the controller start is t0.Table 2summarises the algorithm for control design, and Fig. 5depicts the control design strategy. After having performed the glucose and insulin impulse tests with the diabetic minipig [17], the behaviour of the diabetic glucose metabolism is approximated by a nonlinear model of 16th order which, in turn, is reduced to a linear 5th-order model. By applying loop-shaping strategies in the frequency domain of the open-loop Bode plot, the controller parameters KRand TIare selected. Subsequently, the parametersxKday,xKnightand xTare re-adjusted by in silico closed-loop trials with the nonlinear minipig model. The performance of the resulting controller can now be experimentally evaluated in animal studies.Assuming that the closed-loop system can be approximated by a 2nd-order system, the following loop-shaping criteria for the open-loop Bode plot including the PI-controller (Eq. (40)) can be applied to select the initial controller parameters:•The disturbance response has to be damped to avoid blood glucose undershoots (see R-1); i.e. the crossover frequency ωshas to be reduced which increases the phase margin ϕR, and the controller becomes more robust.Increases in blood glucose due to glucose ingestion have to be rapidly counteracted (see R-2); i.e. the crossover frequency ωshas to be increased which decreases the phase margin ϕR.Both performance requirements cause a conflict in control design. Because blood glucose undershoots below the critical threshold (see R-1) were considered to be more serious, the crossover frequency ωsof the open-loop Bode plot was shifted to the left, which also guarantees robustness (xK=xT=1):1The controller gain KRwas chosen so that the phase margin of the open-loop system was ϕR≈65−−70°.The time constant of the controller TRwas selected so that the PI-controller had no effect on the amplitude of the open-loop system for high frequencies(42)TR=(0.1·ωs)−1.To re-adjust the amplification factors of the controller parametersxKday,xKnightand xT, virtual closed-loop control studies according to the experimental control protocol (Fig. 7, upper panel) were performed with the nonlinear minipig model. The aim was to satisfy both performance requirements: no decreases in blood glucose below the critical threshold (see R-1) and fast blood glucose reduction after ingestion (see R-2). Table 3summarises the resulting controller parameters which were selected twice for MP 7 due to changed physiological conditions, and once for MP 8.The new switching hybrid control method was experimentally evaluated in diabetic minipigs. In total, seven controller tests were run: four tests with MP 8 and three with MP 7 (Table 4). Each controller test was carried out manually including blood sample drawing, glucose determination by means of a blood gas analyser (BGA), controller-based calculation of the insulin dose, and insulin application via a pump (see Fig. 6).The control performance was investigated for at least 48h (see Fig. 7, upper panel). At 8a.m. of the first day, a new glucose sensor was subcutaneously inserted which served as a glucose monitor but was not used for control action. One hour before the controller start (tinit), the blood glucose concentration was determined once for controller initialisation (see Eq. (41)), and at tstart=6p.m., the controller was started. During the following 48h, two feedings of minipig diet per day were allowed at 8a.m. and 4p.m. (indicated by D). These feeding times correspond to the daily routine in the animal's housing. At tend=7p.m. of the third day, the controller was stopped.For comparison of control performance, a manual (open-loop) therapy was also carried out for 48h once per animal (Fig. 7, lower panel). Here, a previously defined constant basal insulin rate was infused with 80% of the day rate given at night. From 7a.m. to 7p.m., in 3h-intervals, additional insulin boli were calculated according to a standard therapy protocol and applied subcutaneously (indicated by arrows with U).To evaluate the performance of the controller-based therapy and the manual therapy, the measured blood glucose concentrations are classified according to physiological acceptance (see also Section 3.1):(43)GP,low:GP(t)<70mg/dl(44)GP,diab:70≤GP(t)<180mg/dl(45)GP,high:GP(t)>180mg/dl.Additionally, the mean values during the dayG¯Pdayand at nightG¯Pnightare calculated, and the number of blood glucose values below the critical threshold GP,crit which required glucose interventions are counted.Table 4 summarises the evaluation results of the control trials (CT) and the open-loop therapy (OT) protocol. Here, N is the number of blood glucose measurements per trial,GP,low,GP,diabandGP,highgive the measurement points in the corresponding classes relative to N, “Hypo” indicates the numbers of critical drops in blood glucose, and “Note” specifies the controller modes if they differ from those presented in Section 4.6.Fig. 8show two control performance examples for MP 8 with a constant setpoint value GP,sp and for MP 7 including the command signal generator (see Eq. (36)), respectively. Fig. 10presents exemplarily the results of the open-loop insulin therapy in MP 8. In all plots, the measured blood glucose concentration (circles) is given in the upper panel including the setpoint value (dashed line), the critical threshold (thick solid line), and the diabetic acceptable range (horizontal grey area). The carbohydrate uptakes (CHO) are marked by triangles. The lower panel shows the applied insulin rate distinguishing between boli (thin bars) and basal rates (thick bars). Please note that the basal rates are divided by four for easier comparison with the applied insulin boli in the plots; the sum of four boli corresponds to the same amount of insulin given by the basal rate for 1h.Overall, none of the seven controller tests had to be terminated due to a critical situation. Technical problems such as occlusion of the insulin catheter caused a delayed controller start in trial CT1 and an earlier stop in trial CT5. Blood glucose concentrations slightly below the critical threshold of 50mg/dl were measured once in each animal and were corrected with 100g extra minipig diet.Due to fewer blood glucose measurements at night to save drawing of blood, the insulin basal rate is not adapted to the current blood glucose concentration as often as the insulin boli during the day. Therefore, reductions in blood glucose at night which were induced by an unexpectedly large variation in insulin sensitivity could not be responded as quickly as would physiologically be essential (see below). Consequently, the controlled mean blood glucose concentrations were higher during the day than during the night (136–159mg/dl vs. 129–147mg/dl). However, the performance requirement R-2 was satisfied. Moreover, as only 4% of the measured values were below the diabetic acceptable range of 70mg/dl (including two incidents below the critical threshold GP,crit) performance requirement R-1 was also satisfied.In contrast, one critical drop in blood glucose occurred during the open-loop insulin therapy OT2 in MP 7; this resulted from a generally low blood glucose concentration. About 13% of the measured values were below the diabetic acceptable range. The manual insulin therapy OT1 of MP 8 showed results comparable to those of the controlled blood glucose trajectory.Overall, due to immediate counteraction to the food-induced rise in blood glucose by means of extra insulin boli, the manually adjusted blood glucose concentrations were closer to the critical threshold without controller than the controlled blood glucose (6.4–12.8% vs. 1.6–8.7% below 70mg/dl). In contrast, blood glucose measurements above the acceptable steady-state range for diabetic subjects GP(t)>180mg/dl occurred more rarely during open-loop therapy than in control trials (4.8–14.4% vs. 11.5–31.0%). As performance requirement R-1 was defined to be more important than R-2 (see Section 5.2), all control algorithms showed desired performances and the results of the controller tests are superior to the open-loop therapy protocol.Fig. 10 shows that the blood glucose variation at night is in the same range as the meal-induced glucose rises during the day. Despite a constant insulin basal rate and no additional insulin boli, the blood glucose concentration fluctuates in the period from 11p.m. to 7a.m. (vertical grey areas). Because the minipig slept throughout the night and did not move around, a likely explanation for the variations in blood glucose is a varying insulin sensitivity; however, as no information on the behaviour of porcine glucose metabolism was found in the literature, this idea needs to be investigated in further studies. To our knowledge, no publications on comparable protocols in humans are available that show similar nocturnal variations in blood glucose. With respect to control applications, insulin sensitivity remains a considerable challenge and requires control robustness.Several control constraints had to be considered during the controller design. Also, unexpectedly large variations in insulin sensitivity at night represented additional challenges for the controller. However, the switching hybrid control algorithm improved the open-loop insulin therapy. In particular, taking into account no announcements of meals or additional process information, and based only on rare blood glucose values, the controller stabilised blood glucose concentrations within the diabetic acceptable range in a promising way. Unfortunately, due to infections of the central venous lines, only seven controller tests could be performed with the diabetic animals.

@&#CONCLUSIONS@&#
A new control method for automatic blood glucose regulation has been developed. The switching hybrid control algorithm was virtually designed based on two mathematical models of diabetic glucose metabolism and was then experimentally evaluated in diabetic minipigs. Overall, the controller improved the insulin therapy with respect to a reduction in critical drops in blood glucose, and satisfied the performance requirements R-1 and R-2.In the future, blood sampling needs to be further reduced and glucose determinations should be extended by commercially available CGM systems. Also, individual closed-loop robustness has to be analysed and feed-forward control strategies should be taken into account for improved disturbance responses. Finally, the control algorithm has to be tested for human applicability in clinical studies.