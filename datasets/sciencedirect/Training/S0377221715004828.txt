@&#MAIN-TITLE@&#
Vehicle-ID sensor location for route flow recognition: Models and algorithms

@&#HIGHLIGHTS@&#
Four mathematical formulations for the addressed sensor location problem are given.Our formulations improve existing ones since the feasible region is better defined.Two heuristic approaches, still missing in the literature, are proposed.The solution shows very good performances on an extensive set of instances.

@&#KEYPHRASES@&#
Sensor location,Traffic flow estimation,Greedy algorithm,Tabu search,

@&#ABSTRACT@&#
We address an important problem in the context of traffic management and control related to the optimum location of vehicle-ID sensors on the links of a network to derive route flow volumes. We consider both the full observability version of the problem, where one seeks for the minimum number of sensors (or minimum cost) such that all the route flow volumes can be derived, and the estimation version of the problem, that arises when there is a limited budget in the location of sensors. Four mathematical formulations are presented. These formulations improve the existing ones in the literature since they better define the feasible region of the problem by taking into account the temporal dimension of the license plate scanning process. The resulting mathematical formulations are solved to optimality and compared with the existing mathematical formulations. The results show that new and better solutions can be achieved with less computational effort. We also present two heuristic approaches: a greedy algorithm and a tabu search algorithm that are able to efficiently solve the analyzed problems and they are a useful tool able to find a very good trade-off between quality of the solution and computational time.

@&#INTRODUCTION@&#
The problem of locating sensors on the network to determine traffic flow volumes has been object in the past few years of growing interest. Problems in this class differentiate according to the type of sensors that need to be located (counting sensors, path-ID sensors, vehicle-ID sensors or a combination of them) and flows of interest (origin/destination flow volumes, arc flow volumes, route flow volumes, or a combination of them). Following the classification defined in the recent survey by Gentili and Mirchandani (2012), two main classes of problems can be identified in this context: (i) locating sensors to fully observe flow volumes on the network (Sensor Location Flow-Observability Problems), and (ii) locating sensors to estimate flow volumes on the network (Sensor Location Flow-Estimation Problems). This division derives from the observation that the location of sensors on a network (either on the nodes or on the links) can be translated into a system of linear equations where the set of variables corresponds to the unknown flows and the set of equations comes from the deployed sensors. When the resulting system has a unique solution, we say the system is fully observable and therefore, under the assumption of error free data, all the flows involved in the system are known (that is they are observable). The resulting location problem consists in determining the optimum deployment of sensors on the network that results in an observable system (Sensor Location Flow-Observability Problems) and therefore it allows to determine all the flow volumes of interest. Observability problems arise, for example, when either path-ID sensors or vehicle-ID sensors need to be located on the links of the network to determine route flow volumes or link flow volumes (Castillo, Gallego, Menéndez, & Rivas, 2010; Castillo, Calvino, Menendez, Jimenez, & Rivas, 2013; Castillo, Conejo, Menéndez, & Jiménez, 2008; Castillo, Conejo, Pruneda, & Solares, 2007; Castillo, Jiménez, Menéndez, & Conejo, 2008; Castillo, Nogal, Rivas, & Snchez-Cambronero, 2013; Gentili & Mirchandani, 2011, 2012, 2005; Hu, Peeta, & Chu, 2009; Mínguez, Sánchez-Cambronero, Castillo, & Jiménez, 2010; Ng, 2012; xue He, 2013). On the other hand, when the system is not observable (that is, it is underspecified), it admits an infinite number of solutions. The related location problem consists in determining how to optimally deploy sensors on the network so that the derived flow estimates are the best possible. Generally, underspecified systems arise when one is interested in determining origin-destination flow volumes by locating counting sensors on the links of the network or when there is a budget constraint that limits the number of sensors that can be located. This problem has been hugely studied in the literature (see for example, Chootinan, Chen, & Yang, 2005; Eisenman, Fei, Zhou, & Mahmassani, 2006; Elhert, Bell, & Grosso, 2006; Fei & Mahmassani, 2011; Yang, Yang, & Gan, 2006; Kim, Chung, & Chung, 2003; Lam & Lo, 1990; Li & Ouyang, 2011; Yang & Zhou, 1998; Zhou & List, 2010; Fei, Mahmassani, & Murray-Tuite, 2013; Simonelli, Marzano, Papola, & Vitiello, 2012).In this paper we focus on both the observability and the estimation problems arising when vehicle-ID sensors are to be located on the links of the network to determine and/or estimate route flow volumes. Both the problems were defined in Castillo, Menéndez, and Jiménez (2008) and Mínguez et al. (2010) respectively, where the corresponding mathematical formulations were presented and some computational experiments were carried out to evaluate the quality of the resulting observed/estimated route flows. The experiments were performed by solving the proposed mathematical formulations by means of a solver. Since the problems are NP-hard only small networks were tested.We further study the two problems and provide contributions both from a theoretical and an algorithmic point of view. In particular, we improve the existing mathematical formulations by adding some new constraints that better define the feasible set of solutions, we also provide efficient solution approaches, still missing in the literature, namely two different greedy approaches and a tabu search algorithm. The efficiency of the proposed approaches is tested on a set of benchmark tests by comparing the provided solutions with the optimal ones, when available, returned by the solver CPLEX.The sequel of the paper is organized as follows. Next section describes the addressed problems. Section 3 contains the mathematical formulations of the problems and the existing results in the literature. Section 4 describes our solution approaches. Computational results are discussed in Section 5. Conclusions and further research are object of Section 6.In this section we formally describe the addressed problems. We follow the general description given in Gentili and Mirchandani (2012) to introduce the Sensor Location Flow-Observability Problem and the Sensor Location Flow-Estimation Problem when vehicle-ID sensors are to be located on the links of a network.Consider the network in Fig. 1with five nodes and eight links, and assume vehicles on the network travel between 4 different Origin-Destination (OD) pairs. Each OD pair is connected by one or more routes, namely: the OD pairw1=(1,5)is connected by routeR1={a1,a2,a3,a4}and by routeR2={a1,a7,a4},the OD pairw2=(1,4)is connected by routeR3={a1,a6,a8,a3},OD pairw3=(3,2)is connected by routeR4={a3,a4,a5,a1}and the OD pairw4=(4,3)is connected by routeR5={a4,a5,a1,a2}. Table 1lists all the OD pairs, the corresponding OD trips, all the 5 routes, the corresponding route flow volumes, and all the link flow volumes. For example, the OD trips corresponding to OD pair w1 are equal to 27 units, 15 of them use route R1 and the remaining vehicles use route R2; flow on link a2 is equal to 37 units and it is equal to the sum of the flow of the routes that use that link, that is routes R1 with flow 15 and route R5 with flow equal to 22. The information shown in the table are given here for clarity of the exposition; we assume to know only the set of routes, while all the other information, namely, OD trips, link flows, and route flows are not known. Our aim is to locate Vehicle-ID sensors on the links of the network to derive the route flow volumes (listed in Table 1) that are not known. The location of a vehicle-ID sensor on a link of a network allows to univocally recognize a vehicle traveling on the network. When vehicle-ID sensors are located on the links we obtain flow volumes of the corresponding links. However, not only flows of the links can be obtained, but also, more detailed information can be derived when the same vehicle is detected on different links at different times. For example, let us suppose to locate three vehicle-ID sensors on our network example, say on links a1, a3 and a4 (we say that links a1, a3 and a4 are scanned). Since link a1 is used by all the routes in the network, then the following equation can be derived:(1)(linka1)fR1+fR2+fR3+fR4+fR5=66where 66 is the intercepted flow on link a1, andfRidenotes the unknown route flow volume of route Ri. Similarly, for links a3 and a4, we can derive the two following equations:(2)(linka3)fR1+fR3+fR4=32(linka4)fR1+fR2+fR4+fR5=56Moreover, if we consider jointly links a1 and a4, the following two additional equations related to the number of vehicles that are recognized on both links a1 and a4, can also be obtained:(3)(links(a1,a4))fR1+fR2=27(links(a4,a1))fR4+fR5=29Indeed, when a vehicle is detected, the detection time is also known. Hence, if the same vehicle is detected first on link a1 and subsequently on link a4, then we can state that such a vehicle is using any route that contains both the links in such an order, in this case the two routes R1 and R2. While if a vehicle is first intercepted on link a4 and subsequently on link a1 then we can say it is using either route R4 or route R5. We refer to this type of equation as the joint recognition equation associated with a subset of vehicle-ID sensors. Considering all the possible equations associated with the location setU={a1,a3,a4},the following system of linear equations will result:(4)(linka1)fR1+fR2+fR3+fR4+fR5=66(linka3)fR1+fR3+fR4=32(linka4)fR1+fR2+fR4+fR5=56(links(a1,a4)fR1+fR2=27(links(a4,a1))fR4+fR5=29(links(a1,a3))fR1+fR3=25(links(a3,a1))fR4=7(links(a3,a4))fR1+fR4=22(links(a1,a3,a4))fR1=15(links(a3,a4,a1))fR4=7.These equations are those associated with some of the possible ordered subsets of these three sensors. In particular, the first three equations are associated each with a single sensor, the subsequent five equations are the joint recognition equations associated with the possible subsets of two sensors out of the three that are located, and, the remaining two equations are the joint recognition equations associated with the three sensors together. Note that, not all the possible ordered subsets are considered, indeed there does not exist any route in the network that contains the ordered pair (a4, a3). The same observation can be made for the ordered sets containing all the three sensors: (a1, a4, a3), (a3, a1, a4), (a4, a1, a3) and (a4, a3, a1).System (4) has five unknown variables and five linear independent equations, hence the system admits a unique solution and all route flow volumesfRi,i=1,…,5can be univocally determined. We say, in this case, that the location setU={a1,a3,a4}has associated a fully observable system of linear equations. In this context, one could wonder whether there exists another subset of three or less sensors such that the associated system of equations is fully observable and hence allows to determine all route flow volumes. The following location problem arises:Vehicle-ID sensor location flow-observability problem:What is the minimum number of vehicle-ID sensors to be located on the links of the network and where to locate them, such that the associated system of linear equations is fully observable, that is it allows to uniquely determine all route flow volumes?Note that, the above problem is feasible only when univocally recognition of all the route flows is possible. Indeed, when unique observability of flows is not possible, there exist many solutions, usually an infinite number, to the system of linear equations associated with a given location of sensors that reproduce the measured flows. This can happen into two cases: either when the system of linear equations associated with the location of vehicle-ID sensors on each link of the network does not have a unique solution or when the total number of sensors that can be located on the network is limited due to the presence of budget constraints. In this case, a different optimization problem can be stated as explained in the following.Let us assume a limited number of sensors, say k, can be located on the network and all the systems associated with all the possible subsets of k sensors do not admit a unique solution. In this case, how can one decide when a location set is better than another? A possible way is (see Gentili & Mirchandani, 2012) to define a location-evaluation criterion g that associates with each location set U a value g(U) representing a measure of the quality of the flow estimates obtained by the system of equations associated with U. Given such a criterion, we can conclude that a location set U is better than another location set U′ if the value g(U) associated with U is better than the value g(U′) associated with U′. Following the approach suggested in Mínguez et al. (2010), for the case where vehicle-ID sensors need to be located, we could associate with the location set U an evaluation criterion g(U) that equals the total number of routes that can be univocally observed through the system associated with U. In this way, we could conclude that between two location sets U and U′, U is better than U′ if g(U) > g(U′). In our network example, let us consider the two locations setsU1={a1,a4}andU2={a3,a5}. The following system is associated with the location set U1:(5)(linka1)fR1+fR2+fR3+fR4+fR5=66(linka4)fR1+fR2+fR4+fR5=56(links(a1,a4))fR1+fR2=27(links(a4,a1))fR4+fR5=29and the following system is associated with the location set U2:(6)(linka3)fR1+fR3+fR4=32(linka5)fR4+fR5=29(links(a3,a5))fR4=7By solving system (5) route R3 can be univocally determined andg(U1)=1,while by solving system (6) we haveg(U2)=2since routes R4 and R5 can be univocally determined. Hence, we could conclude that, according to the defined evaluation criterion g, U2 is better than U1. Hence, given an evaluation function g, the following location problem can be defined:Vehicle-ID sensor location flow-estimation problem:If a given number k of vehicle-ID sensors are to be located on the network, where to locate them so that the associated evaluation criterion g is optimized?Both the described problems are NP-hard as it will be evident in the next section where the mathematical formulation is presented and the relationship with the set-covering problem is outlined.In this section we provide the mathematical formulation of the two problems described in the previous section. To this aim we introduce the concept of scanning map (firstly defined in Castillo et al. (2008)) associated with a location set U. Let us return to our example network. Consider again the location setU1={a1,a4}and let us associate with each route Rithe set of linksCRiof scanned links of the route (referred to in the sequel as scanning set associated with the route). That is:CR1=(a1,a4),CR2=(a1,a4),CR3=(a1),CR4=(a4,a1)andCR5=(a4,a1). Let us refer to this collection of sets as the scanning map associated with the location {a1, a4}. Analyzing this scanning map we can conclude: (i) if a vehicle is intercepted only on link a1, then it is using route R3; (ii) if a vehicle is intercepted first on link a1 and later on link a4 then it is using either route R1 or R2; finally, (iii) if a vehicle is intercepted first on link a4 and later on link a1 then it is using either route R4 or R5. That is, this scanning map allows to recognize univocally only vehicles of routes R3, while for the remaining routes the same conclusion cannot be derived. Let us consider to locate one additional vehicle-ID sensor on link a3, the new scanning map is:CR1=(a1,a3,a4),CR2=(a1,a4),CR3=(a1,a3),CR4=(a3,a4,a1)andCR5=(a4,a1). The location of a vehicle-ID sensor on link a3 permits to distinguish among those vehicles that use route R1 and those vehicles using route R2, and, similarly, we can distinguish those vehicles that use route R4 and those vehicles that use route R3. From this example, it is clear that, by using the scanning map associated with a location set, it is possible to understand which route, among all, is uniquely identified. Based on the scanning map definition we can give an alternative definition of the two problems described in the previous section, the mathematical formulation presented in Castillo et al. (2008) and Mínguez et al. (2010) is based on these definitions.Formally, letG=(V,A)be a network and R be a set of routes defined on the network. Given a location of vehicle-ID sensors on a subset U⊆A of links, we can define a scanning mapSM(U)={CRi:CRi=U∩Ri,i=1,2,…,|R|},where each scanning setCRiis associated with route Riand contains the scanned ordered list of links of the route. If all the scanning sets in the scanning map are not empty and are different, i.e.CRi≠CRj,for eachi≠j=1,2,…,|R|,then the scanning map allows to determine all the route flow volumes and we can define the alternative version of the observability problem given in the previous sectionVehicle-ID sensor location flow-observability problem:What is the minimum number of vehicle-ID sensors to be located on the links of a network and where to locate them such that the associated scanning map allows observability of all route flow volumes?While, if we define the evaluation criterion g(U) as the number of routes that can be univocally determined through the scanning map associated with U, we can state the following alternative version of the estimation problem:Vehicle-ID sensor location flow-estimation problem:If a given number k of vehicle-ID sensors are to be located on the network, where to locate them so that the associated scanning map is such that the total number of univocally determined routes is maximized?For a matter of clarity of exposition, in the sequel we will refer to the Vehicle-ID Sensor Location Flow-Observability Problem as problem P1, and, to the Vehicle-ID Sensor Location Flow-Estimation Problem a problem P2.Let us introduce two sets of binary variables: variable xaassociated with each link a ∈ A that it is equal to 1 if a vehicle-ID sensor is located on link a and it is equal to 0 otherwise; variable yabassociated with each pair of links a ≠ b ∈ A that is equal to 1 if a vehicle-ID sensor is located both on link a and link b and it is equal to 0 otherwise. The following set of parameters are also defined:-ρRia: is equal to 1 if route Ricontains link a and is equal to 0 otherwise;ρRiRja: is equal to 1 if link a is contained either in Rior in Rj(not in both) and is equal to 0 otherwise;σRiRjab: is equal to 1 if links a and b are both in route Riand Rjbut they appear in a different order.The mathematical formulation of problem P1, is the following [P1]:(7)min∑a∈Axa(8)s.t.∑a∈AρRiaxa≥1∀Ri∈R(9)∑a∈AρRiRjaxa+∑a≠b∈AσRiRjabyab≥1∀(Ri,Rj)|Ri<Rj(10)2yab−xa−xb≤0∀a≠b∈A(11)xa∈{0,1}∀a∈A(12)yab∈{0,1}∀a≠b∈AThe objective function (7) is the sum of the total number of the vehicle-ID sensors located on the network and is minimized. We refer to constraints (8) as covering constraints as they ensure there is at least one vehicle-ID sensor located on each route of the network. Constraints (9) are diversification constraints. These constraints ensure the scanning map associated with the location of vehicle-ID sensors allows full observability of the route flow volumes. Indeed, the sum on the left of the constraint ensures that for each couple of routes Riand Rjthe corresponding associated subsetsCRiandCRjare different either because they contain at least one different link or, in case they contain the same set of links, they appear in different order. Constraints (10) are logical constraints linking the binary variables xaand yab. If yabis equal to 1 then the constraint forces both xaand xbto be equal to 1, otherwise, ifyab=0the minimization of the objective function drives the value of xaand xbto be equal to 0. The remaining constraints (11) and (12) require the variables to be binary.The above mathematical formulation is different from the one provided in Castillo et al. (2008) where the set of diversification constraints did not take into account the order the scanned links appear in each setCRi. Our diversification constraints (9) and (10) consider this order and hence the feasible set of solutions of the problem is now correctly described. In Section 5 the results of the two mathematical formulations are compared on different sets of instances. The results show that our modified version of the diversification constraints improves the final solution on those instances where the routes in the network are defined as subsets of circular paths like, for example, the two routes R1 and R4 in the network of Fig. 1 that are subsets of the circular pathP={a1,a2,a3,a4,a5}.Let us consider the additional set of binary variableszRiassociated with each route Ri, such thatzRiis equal to 1 if route Riis uniquely identified (that is observed) and it is equal to 0 otherwise. Let us also define a weightwRiassociated with route Rito define its relative importance (see for example Mínguez et al. (2010) for possible definitions of these weights). The mathematical formulation of problem P2 is then the following [P2]:(13)max∑Ri∈RwRizRi(14)s.t.∑a∈AρRiaxa≥zRi∀Ri∈R(15)∑a∈AρRiRjaxa+∑a≠b∈AσRiRjabyab≥zRi∀(Ri,Rj)|Ri<Rj(16)2yab−xa−xb≤0∀a≠b∈A(17)∑a∈Axa≤k(18)xa∈{0,1}∀a∈A(19)yab∈{0,1}∀a≠b∈A(20)zRi∈{0,1}∀Ri∈RThe objective function (22) maximizes the total weight of the routes that can be univocally determined. Constraints (14) and (15) differ from those in the previous model [P1] since they ensure the coverage and the diversification of route Rionly if the corresponding variablezRiis equal to 1. Constraints (16) are the same as in the previous model. Constraint (17) ensures at most k vehicle-ID sensors are located on the links of the network. Variables are ensured to be binary by constraints (18)–(20). Note that, by fixingwRi=1,∀Ri∈ R, the problem looks for the maximization of the total number of routes that can be univocally determined.As for the previous formulation [P1], the above formulation of the problem differs from the one provided in Mínguez et al. (2010) basically for the characterization of the diversification constraints (15) and (16) that, unlike the constraints defined in Mínguez et al. (2010), take indirectly into account the order the scanned links appear in the scanning sets.In the sequel of the paper, we consider also two weighted variants of the above described problems that arise when an installation cost cais associated with each link. In particular, a variant of problem [P1] requires to determine the minimum cost vehicle-ID sensor location that ensures the observability of all the routes in the network. The corresponding model formulation is the following [P1b]:(21)min∑a∈Acaxas.t. (8)–(12)If there is an available maximum budget Cmaxfor the location of the sensors, then one could be interested in locating vehicle-ID sensors on the links of the network to maximize the total weight of the routes that can be univocally determined without exceeding the budget limit. In this case, the following model describes this variant [P2b]:(22)max∑Ri∈RwRizRi(23)s.t.∑a∈Acaxa≤Cmax(24)(14)−(16),(18)−(20)In this section we present our solution approaches, namely two greedy approaches (Greedy1 and Greedy2) and a tabu search algorithm, to solve problems P1, P1b, P2 and P2b. We describe the approaches for problem P1 and subsequently we will explain how the approaches have been modified to solve problems P1b, P2 and P2b.Before describing the greedy criterion used by our Greedy1 algorithm, let us introduce first some definitions and notations. Given a subset of links U⊆A, we associate with each link a ∈ A two different scores according to the number of additional constraints that can be satisfied if a is selected. In particular we define the two following criteria:•The covering criterion: Cov(U, a) is the additional set of routes that can be covered if link a is selected (that is, the set of additional covering constraints that can be satisfied if link a is selected). The resulting score associated with link a is the size of this set, that is |Cov(U, a)|.The diversification criterion: Div(U, a) is the set of additional diversification constraints that can be satisfied since either the termρRiRjaxa,or the termσRiRjabyab,becomes equal to 1 in the summation of the constraints where xaor yabare involved, if a is selected. The resulting score associated with link a is the size of this set, that is |Div(U, a)|.Let us return to our example in Fig. 1 for which the entire set of covering and diversification constraints of the mathematical formulation [P1] is given in Table 2.Let us assume link a4 is selected, that isU={a4},the corresponding value of the above criteria for each of the remaining links are listed in Table 3. The covering constraints that are already satisfied by the selection of link a4 are those related to routes: R1, R2, R4 and R5, while the satisfied diversification constraints are those corresponding to the pairs: {R1, R3}, {R2, R3}, {R3, R4} and {R3, R5}. Consider for example link a2. Link a2 has a covering score equal to|Cov({a4},a2)|=0since there is no additional covering constraint that is satisfied if a2 is selected, while the diversification score is equal to 5; indeed, the constraints related the pairs {R1, R2}, {R1, R4}, {R2, R5} and {R4, R5} are satisfied since variablexa2=1and the constraint related to the pair {R1, R5} is satisfied since variableya2a4=1.According to the two criteria we define an initial ordering of the links by ordering them in decreasing order with respect to the covering criterion forU=∅; ties are broken according to a decreasing order of the diversification criterion forU=∅. We refer to this ranking as Initial Ranking. The Initial Ranking for our network example is: {a1, a4, a3, a5, a2, a6, a7, a8} (see the upper most Table in Fig. 2where the values of the covering criterion and of the diversification criterion are showed for our example whenU=∅).Our first greedy approach to solve problem P1, iteratively selects a link that maximizes the covering criterion; in case of ties the link that maximizes the diversification criterion is chosen; in case of ties the link having the best position in the Initial Ranking is selected. The algorithm stops when a feasible solution is obtained. A re-optimization step is also applied to the returned solution U. This step tries to eliminate redundant links. The details of this algorithm are given in Table 4. In the worst case, the running time required by this algorithm is O(|A|4|R|2); indeed in the worst case, the algorithm could, for each link, check the entire set of constraints, which could involve checking the entire set of yabvariables. Fig. 2 shows the steps of Greedy1 when it is applied to solve problem P1 on our example network of Fig. 1.Given a subset of links U⊆A, our second greedy approach to solve problem P1, iteratively selects a link a that maximizes a greedy criterion W(U, a) that takes into account three main components: (i) length of the routes (in terms of number of links) that are covered if link a is selected, (ii) number of routes that can be univocally identified if link a is selected, and (iii) a measure of the total number of routes that still need to be differentiated if link a is selected. The algorithm stops when a feasible solution is obtained. The re-optimization step is applied to the returned solution U. The description of the greedy function is given next, while the pseudocode of the algorithm is given in Table 5.Let us better describe the function W(U, a) that is the core of the greedy criterion at Step 2.1. Let R be the set of the routes on the given network and let U⊆A be a subset of links. Function W(U, a) favors the choice of those links that, on the one hand, improve most the feasibility of the solution, and, on the other hand, leave a set of routes that are easier to be differentiated. These aspects are taken into account by considering the sum of three weighted componentsW(U,a)=ρ1f1(U,a)+ρ2f2(U,a)+ρ3f3(U,a)The first f1(U, a) component is computed as follows:f1(U,a)=∑Ri∈Cov(U,a)Avg|Ri|where |Ri| is the total number of links contained in route Ri, and Avg is the average number of links of each route Rj∈ R (for the example in Fig. 1 we haveAvg=195=3.8). This criterion f1(U, a) takes into account the total number of routesthat can be additionally covered if link a is selected. However, unlike the covering criterion, it also takes into account the length (in terms of number of links) of the additional routes that can be covered. Indeed, routes with a fewer number of links are less likely to be covered, hence, function f1 favors the selection of those links that cover shortest routes.The second component f2(U, a) is the following:f2(U,a)=|D(U,a)|.This component equals the total number of routes that can be univocally identified by the selection of link a. This criterion is slightly different from the diversification criterion introduced previously. Indeed, Div(U, a) is the set of diversification constraints that can be satisfied when link a is selected, while D(U, a) is the set of routes that are associated with a unique nonempty scanning set in the scanning map resulting after the selection of link a.Finally, the last component is the following:f3(U,a)=∑CRi∈SM(U∪{a}):Ri∉D(U,a)Ri∈Cov(∅,a)|M(CRi)|.This component considers the scanning map that results after the selection of link a. In particular, for each route that is covered by link a, i.e. Ri∈ Cov(∅, a) and that is still not univocally determined, that is Ri∉D(U, a), the associated scanning setCRiis considered. The total number of routes whose scanning set is equal toCRi,that is|M(CRi)|=|{Rj∈R:Rj≠RiandCRj≡CRi}|is computed. Function f3 computes the sum of the square root of the size of these sets. This criterion privileges the selection of those links that, if selected, split the resulting scanning map as much as possible.These three functions are properly weighted with weights ρi,i=1,2,3to define the relative importance of the corresponding criterion. In our experiments we setρ1=2ρ2,ρ2=100andρ3=1. We chose these values to favor criterion f1 first, then criterion f2, and finally to take into account criterion f3 in case of ties.Fig. 3shows the steps of Greedy2 when it is applied to solve problem P1 on the example of Fig. 1. In the example we setρ1=ρ2=ρ3=1. Tables 6–8show the scanning maps associated with each link and with setsU=∅,U={a1},andU={a1,a3}respectively.In the worst case, the running time required by this algorithm is O(|A|4|R|2); indeed in the worst case, the algorithm could, for each link, check the entire set of constraints, which could involve checking the entire set of yabvariables.In this section we describe the tabu search approach we developed to solve problem P1. Given a feasible solution U⊆A for the problem, we defined the neighborhood Nh(U) of this solution as the set of all the feasible solutions obtained from U by deleting at most h elements. Formally, the following neighborhood is considered:k-switch Neigborhood Nh(U)A subset of links U′ ∈ Nh(U) if and only if U′ is such that:|U′∩U|≥|U|−h,that is the two subsets U and U′ share at least|U|−hlinks.Note that, a neighbor U′ ∈ Nh(U) can be obtained from U by randomly deleting h elements and adding new elements to restore feasibility; such a procedure, referred to as FindNeighbor(U), is described in Table 9. The value of parameter h must be, on the one hand, large enough to ensure to find a neighbor U′ ∈ N(U)hsuch that U′ ≠ U, and, on the other hand, its value should vary according to the size of the instance. After a tuning phase we seth=5+β(|U|),where β(|U|) is a random value between 0 and|U|10.The tabu list memorizes moves corresponding to feasible solutions. Ideally, the tabu list should store the subset of links of each solution that is contained in the tabu list. Since memorizing such a detailed information could be heavy from a memory point of view, we decided to store in the tabu list an hash key H(U) that is univocally associated with solution U. When the algorithm needs to verify whether a given solution is in the tabu list it looks for its hash key in the tabu list. To give an example, let us considerU={ai1,ai2,…,ais}to be a feasible solution composed of |U| links, whereaijis the identification ID of the link. The corresponding hash key H(U) is obtained by applying the following steps:•Order the links in U in non decreasing order with respect to their ID and obtain:aij1≤aij2≤,…,≤aij|U|γ(0)=1γ(h)=α1aijh+α2γ(h−1)H(U)=γ(|U|)The first step is to order the links in the solution with respect to their ID. This step ensures that the hash key associated with a given solution does not depend on the order of the links in the solution. The hash key associated with U is a value computed by means of a recursive function γ( · ). The value γ(h) is associated with the link in position h,h=1,2,…,|U|,in the ordered set U; such a value is computed according to the value of the recursive functionγ(h−1)associated with the link in the previous positionh−1. The hash key associated with U is the value of the recursive function computed for the link in the last position. The values α1 and α2 are prime numbers. If the links were identified by prime numbers the resulting hash key would be unique. Of course, due to the size of the instance of the problem such an identification for the links is not possible. This results in a key that may not be unique. To limit the cases of different feasible solutions associated with the same hash key value, one would choose the values of α1 and α2 as large as possible. In our experimentation we setα1=4523andα2=31.Finally, we chose to implement a tabu list with a fixed length equal to 8. The generic iteration step of our tabu search algorithm is described in Table 10 where U is the current feasible solution, U* is the current incumbent solution, U** is the second incumbent solution and T is the current tabu list. The value of parameter p is fixed in our experiments equal to |U|*5. The initial feasible solution to start the first iteration of our tabu search is obtained by applying Greedy2. Our tabu search terminates if no improvement in the incumbent solution is obtained after |N|*150 iteration, where |N| is the total number of nodes of the input graph.Our solution approaches described to solve problem P1 can be easily adapted also to solve problem P1b and therefore to take into account the cost caof installation of a sensor associated with each link.The modifications for Greedy1 involve the definition of the Initial Ranking and of the greedy step criterion.The Initial ranking is such that the links are ordered increasingly with respect to the link cost; ties are broken according first to a decreasing order with respect to the covering criterion (computed forU=∅) and thenaccording to a decreasing order with respect to the diversification criterion (computed forU=∅).The greedy Step 2.1 of the Greedy1-P1 (in Table 4) becomes:Step 2.1. While U is not a feasible solution- find the link a ∈ A\U with|Cov(U,a)|camaximum;- in case of ties select the one with|Div(U,a)|camaximum;- in case of ties select the one with the best position in the Initial Ranking.The modifications for Greedy2 involve the greedy criterion W(U, a), that becomesW(U,a)ca. Such a modification is also considered in the tabu search algorithm. Moreover, Step 3 in the ith iteration in the tabu search (in Table 10) is also changed to take into account the new objective function. It becomes:3. Ifc(U^)≥c(U*)andH(U^)∉Tandc(U^)<c(U**)thenU**←U^.wherec(U)=∑a∈Ucais the sum of the costs of the links in the set U.The adaptation of the approaches to solve problem P2 and P2b requires to take into account a new objective function (the maximization of total weight of the routes that are observable) and the added budget constraint involving either the total number of sensors that can be located (problem P2) or the total cost of the sensors that can be located (problem P2b). All the changes are described for problem P2b and reported below. The same changes can be applied to solve problem P2 by settingCmax=kandca=1,∀a ∈ A. Let z(U) define the total weight of the routes that can be univocally determined if vehicle-ID sensors are located on the links in U.The modifications for Greedy1 algorithm involve the Initial Ranking and the Greedy criterion. When solving problem P2b the Initial Ranking takes into account the cost associated with each link and it is the same we considered for problem P1b, that is, the links are ordered increasingly with respect to the link cost; ties are broken according first to a decreasing order with respect to the covering Criterion (computed forU=∅) and then according to a decreasing order with respect to the diversification criterion (computed forU=∅). The greedy criterion to select link a is modified to take into account both the total number of additional constraints that can be satisfied, and the weights of the additional covered routes. In particular, the algorithm selects at each iteration a link a such that: (i) the budget constraint is not violated and (ii) the following quantity is maximum|Cov(U,a)|+|Div(U,a)|c(a)+∑Ri∈Cov(U,a)wRiw¯where the first element is the ratio between the sum of the covering and diversification scores over the cost of the link; while the second element is the ratio between the sum of the weights of the additional covered routes divided by the average route weightw¯=∑Ri∈RwRi|R|. The pseudocode is given in Table 11.Modifications of the Greedy2 algorithm involves the stopping criterion and the values of the parameters ρi,i=1,2,3associated to the three components that are involved in the greedy criterion. The new values assigned to parameters ρiare:ρ1=100,ρ2=2ρ1andρ3=1; this setting favors the choice of those links that diversify most. Greedy2 stops when the given budget limit is reached. The same modifications apply to the tabu search algorithm. Moreover, Step 3 in the ith iteration in the tabu search is also changed to take into account the new objective function. It becomes:3. Ifz(U^)≤z(U*)andH(U^)∉Tandz(U^)>z(U**)thenU**←U^.In this section we show the experimental results to test the performance of our approaches, in terms of solution quality and running time, and to evaluate when our proposed enhanced mathematical formulations provide a different optimal solutions than the formulations presented by Castillo et al. (2008) and Mínguez et al. (2010).Since there do not exist benchmark instances in the literature, we generated two different classes of instances. The first one, referred to as Class 1, is a set of instances where the set of routes do not show the circular pattern behavior described in section 3. The second class of instances, referred to as Class 2, contains instances where the set of routes in the network show a circular behavior. These instances are useful to evaluate the effectiveness of our enhanced mathematical formulations in providing better solutions with respect to those provided by the existing mathematical formulations.Class 1 and Class 2 instances are available upon request to the authors. On each instance, we compare the results returned by the mathematical models and by our Greedy 1, Greedy 2 and tabu search algorithms for each of the four problems. The greedy algorithms and the tabu search algorithm were coded in C and run on a 3.4 Ghz Intel i7 processor. The mathematical formulations were coded in AMPL and solved by means of the solver CPLEX 11.2. We fixed a threshold on the execution time of the CPLEX solver equal to 2 hours.Class 1 set of instances are modified square grid graphs, where arcs are added randomly between pairs of vertices of the graph. In particular, a number of arcs equal to 10 percent of the total number of arcs of a regular grid were randomly added to each grid. We generated square grids whose dimensions are: 8 × 8, 10 × 10 and 15 × 15, for a total number of nodes equal ton=64,100and 225, respectively. For each grid we generated a fixed number |R| of routes such that|R|=n,2n,3n,4n,5n. Hence, we generated 15 different scenarios. Costs on links were generated randomly from a uniform variable and they range from 1 to 5. Weights on routes were generated randomly from a uniform variable and they range from 10 to 100. For each scenario, five different instances were generated.Class 2 set of instances are generated considering networks with a total number of nodes equal ton=40,80,160,240,320,400and corresponding number of OD pairs equal ton4. A fixed number |R| of routes was generated for each OD pair with|R|=4,8,10,16. We then generated 24 different scenarios. Costs on links were generated randomly from a uniform variable and they range from 1 to 5. Weights on routes were generated randomly from a uniform variable and they range from 10 to 100. For each scenario, ten different instances were generated.

@&#CONCLUSIONS@&#
We addressed an important problem in the context of traffic control and management related to the optimum location of vehicle-ID sensors on the links of a network to derive route flow volumes. We considered both the full observability version of the problem where one seeks for the minimum number of sensors (or minimum cost) such that all the route flow volumes can be derived and the estimation version of the problem that arises when there is a limited budget in the location of sensors. Our contribution is both theoretical and algorithmic. We improved the existing mathematical formulations of the four addressed problems by better describing the feasible region. Being the problems NP-complete, we proposed three solution approaches (still missing in the literature) to heuristically solve the problems: two greedy algorithms and a tabu search metaheuristic. We tested our approaches on two different set of instances to better evaluate the quality of solutions provided by our algorithms and by the mathematical models when the set of routes show a circular pattern behavior or not.The proposed analysis is developed under the assumption (common to other papers existing in the literature Castillo et al. (2008), Mínguez et al. (2010)) that the information regarding OD routes is correct and complete. An interesting development of this research is now focused on the analysis of the sensitivity of the solutions with respect to the level of knowledge of the OD routes.