@&#MAIN-TITLE@&#
Classification and statistical learning for detecting of switching time for switched linear systems

@&#HIGHLIGHTS@&#
Method for the detection of switching time.Clustering and classification approach.Statistical learning approach.Technique of detection given an explicitly estimation of switching time.To demonstrate the efficiency and feasibility of our approaches and validate the results obtained, we conducted a numerical example.

@&#KEYPHRASES@&#
Switching instants detection,Switched linear systems,Clustering algorithm,SVM,

@&#ABSTRACT@&#
In this paper, a new method for the detection of switching time is proposed for discrete-time linear switched systems, whose switching mechanism is unknown. The switching instant estimation problem consists to predict the mode switching for discrete behavior from a finite set of input–output data. First, the proposed method use a clustering and classification approach define the number of submodels and the data repartition. Then, by the use of statistical learning approach, we define the linear boundary separator of each validity region. Finally, a technique of detection given an explicitly estimation of switching time. A numerical example was reported to evaluate the proposed method.

@&#INTRODUCTION@&#
Hybrid systems are defined as dynamic systems that explicitly and simultaneously interact phenomena of continuous and event nature. The continuous behavior is the result of the natural evolution of the physical process, while the discrete or events behavior may be due to the presence of switches, operating phases, transitions, computer program codes, etc….The hybrid dynamic systems (HDS) switch between several operating modes where each mode is governed by its own dynamic. Therefore, the modeling of HDS involves estimating the discrete dynamics on the one hand and to identify the sub-models of the continuous behavior, on the other hand. Several approaches have been proposed to solve this problem. The method presented in  [1], for linear switched system a class of HDS, is based on an application of the Multivariable Output-Error State Space (MOESP) identification technique  [2] for the estimation of sub-models, in a noisy environment. In this approach, the authors assume that the discrete state, which models the discrete dynamics, and the number of sub-models are known a priori. Further, the switching instants are separated by a minimum dwell time. In  [3], the considered model does not suffer from state databases matching problem such as a switched linear systems model. Indeed, the different linear submodels do not interact but they evolve independently of each other so that one can represent each of them in an arbitrary base. But the application of the presented method for the identification of this model (according to the authors formulation) may require a very important dwell time. Thus, there are many work in different search domain such as works of identification [1,3], control  [4,5], stability analysis  [6–9] and state estimation  [10,11], make the knowledge of the switching mechanism as a basic assumption.Other researchers have opted recently to other approaches based on artificial intelligence, learning and classification. These new methods showed quite encouraging results for several automatic issues. Boukharouba  [12], Tarhouni  [13] have proposed a modelling approach of hybrid systems and nonlinear system based on the classification. In  [12], the switching mechanism is modelled by a piecewise linear functions defining the validation boundaries of each sub-models. The parameters adaptation of these functions are provided by a new incremental and decremental classification algorithm multi-class support vector. The proposed approach, in  [13], is based on Least Squares Support Vector Machines (LS-SVM) with combined kernel for NARMA system identification. It’s consisted in considering the two terms of auto- correlation and the terms of cross-correlation and for every block a kernel function is used. Ackerson and Fu  [14] are the first which have considered the determination problem of the active mode through state estimation in noisy environment. A recent result for Markov Jump Linear System (MJLS) a class of hybrid system, developed in  [15], is presented to the state estimation in the presence of polyhedral bounded disturbances. The approaches  [16–18] are proposed to identify the switching instants for a class of switched linear systems described in the state form. In these works, an identification recursive algorithm and dynamic classification algorithm are used to estimate the discrete state.In this paper, a new approach is presented for detecting of switching time of switched linear systems defined in discrete-time. Our aim is to develop a method for the switching time estimate from a finite set of input–output system. The proposed method is based on classification techniques. The clustering algorithm affects all available data on an observation horizonNto their respective sub-models. Then, we proceed to classify online a new observation and we calculate its distances from the hyperplanes boundaries of its region. These distances present the decision criterion for the detection of the switching time. In fact, if their minimum value is less than a threshold, defined in practice, then the next instant(k+1)presents a switching time.This paper has the following structure. Section  2 deals with the problem statement. Section  3 presents the new approach for switching time detection. In Section  4, we present the simulations in order to illustrate the effectiveness of the proposed method.The considered switched linear systems are described in the discrete time by the following state space model:(1){x(k+1)=Aix(k)+Biu(k)y(k)=Cix(k)wherex(k)∈Rn,y(k)∈Randu(k)∈Rare respectively the continuous state, the output and the input of the systemAi,BiandCiare the parameter matrices associated with the submodel indexed byi∈S={1,…,s}. The discrete stateiindexes the submodel under evolution at instantk,sis the number of submodels. In general, the switching law of this state may be due to external variables controllable or uncontrollable, as it can be in terms of change of a invariant condition.A switched linear system, defined in (1), presents a collect of linear (affine) submodels connected by a discrete state. Therefore, each submodel evolves according to a fixed linear dynamic on a time intervals. The switching mechanism between the various submodels is usually undetermined. In this case, it is advantageous to be able to predict the switching time for proper tracking of the overall system behavior.Given data{y(k),u(k)}k=1Ngenerated by a switched linear model of the form as in (1), we are interested in determining switching time of discrete state. Before solving this problem, we make the following assumptions:(i)The considered switching mechanism is undetermined and without dwell time, it corresponds to a time interval in which no switching is franchise. In fact, the switches can be exogenous, deterministic, state-driven, event-driven, time-driven or totally random.The number of submodelssare a priori unknown.The ordernis the same for all submodels and is available.In this paper, we deal the problem of switching time detection for switched linear systems. The proposed approach is based on a data clustering method combined with an online detection technique of mode change. this technique consists in defining the hyperplanes limited of the each submodels region by a combination of a binary linear classifiers series, and in calculating the distance between the current data and the hyperplane of an appropriate region for an estimate of the instant switching.Given the input–output measures{y(k),u(k)}k=1Non an observation horizonN, generated by the system (1), the procedure, presented in Fig. 1, consists in(i)solve a data classification problem whose purpose is to separate the available data according to their respective affine submodels.Online estimate the switching instants of the discrete state of the system.We use the chiu’s classification algorithm  [19,20], also called the method of mountains  [21,22]. In this work, we extended this method to classify a set of regression’s vectors  [23]φ(k)(φ(k)=[y(k)y(k−1)u(k−1)]T,k=1,…,N), which consists in associating to eachφ(k)a potentialPkdefined by:(2)Pk=∑l=1l≠kNexp(−4‖φ(k)−φ(l)‖2ra2)whererais a positive coefficient that control the decay of the potential. Indeed, the potential decreases exponentially whenφ(l)moves away toφ(k). Otherwise, the coefficientradefines the radius of a class. The first class center, denotedφ1∗is the data whose potentialP1∗, expressed by Eq. (2), is the maximum. The potential of the neighborhood points of the center while gradually decreasing away from the latter. To avoid selecting the data in the neighborhood of the centerφ1∗as other centers of classes, the classification procedure changes the value of each potential given by the following formula:(3)Pk←Pk−P1∗exp(−4‖φ(k)−φ1∗‖2rb2).The parameterrb(rb>0) must be strictly greater thanrato promote the operation on the selection of other distinctly different classes of first and its close. The center of second class is selected as the data having the maximum modified potential given by relation (3). Letφ2∗the second center andP2∗the associate modified potential. Similarly, we select thecth centerφc∗havingPc∗as a potential and the potentials are modified by the following formula:(4)Pk←Pk−Pc−1∗exp(−4‖φ(k)−φc−1∗‖2rb2).Chiu introduces two positive parametersε1andε2(ε1>ε2)for conditioning the choice of centers. Indeed, at each instant, the selection procedure of each class center obeyed the following inequalities:•IfPc∗>ε1P1∗⇒selection authorized.IfPc∗<ε2P1∗⇒selection achieved.Ifε2P1∗≤Pc∗≤ε1P1∗and if:Min(|φc∗−φ1∗|,|φc∗−φ2∗|,…,|φc∗−φc−1∗|)ra≤1−Pc∗P1∗Once the centersφc∗of classes are selected, we proceed in search of the elementsφ(k)belonging to each class by a simple calculation of distancesdkcbetween each pointφ(k)of these centersφc∗.(5)dkc=|φ(k)−φc∗|φ(k)belongs to the class whose the center corresponds to the distance minimumdkc=minl(dkl). In practice, the normalized distancedkcngiven by the relation (6) are considered.(6)dkcn=dkc|φmax−φmin|φmaxandφminare respectively the maximum and minimum values of the dataφ(k).In summary, the classification method consists of two steps. First, the class centers using the Chui’s algorithm are determine, and the submodels numbersis given. Second, we assign the data to the appropriate class according to the distancedkcn.At resulting from the clustering phase, the regression data{φ(k)}k=1Nare assigned (labeled) to classesCifori∈{1,…,s}. Each classCipresents a submodel of the system and it is characterized by its centerci∀i∈{1,…,s}.The data of the classCi,i=1,…,s, are located in the neighborhood of the centerciwhen theith submodel is under evolution. When the switching instant is approaching, the regression data move away towards the frontiers of the activation region of submodeli. In fact, the distancedi,j(k)between the data available at the instantkand the boundary hyperplane ofiandjsub-models (forj∈{1,…,s},j≠i) minimizes. Then, the instant(k+1)will be a switching instant if:(7)‖di,j(k)‖2≤δ.Fori∈{1,…,s},∀j∈{1,…,s}withj≠i,δis a given threshold practically by the operator (see Fig. 2).Determination of hyperplanes: The computation of hyperplanesfij(withi∈{1,…,s},∀j∈{1,…,s},j≠i) of theith validity region is ensured by combination of a binary linear classifiers series. This classification category makes call to the decomposition schemes of type öne-against-one”. This method is a class of different methods of multi-class classification which was generalized of the technical Support Vectors Margin SVM  [24]. The SVM principle is to find the hyperplane which mimimise the sum of the errors associated with bad classifications while maximizing the marginρof separation between regions (see Fig. 3).Withris the distance from the dataφ(k)to the separator which has the following equation:(8)h(φ)=wTφ(k)+b.And the distanceris expressed by:(9)r=wTφ(k)+b‖w‖.We focus, in this paper, only on the calculation of classifier parameters. The hyperplane separator of the two regionsRiandRj(the validity region respectively of submodeliandj) has the equation:(10)wijTφ+bij=0wherewijandbijare solutions of the following optimization problem:(11)minwij,bij,ξij12‖wij‖2+C∑k=1Nijξkijwith constraints(12)wijTφ(k)+bij≥1−ξkij,∀φ(k)∈RiwijTφ(k)+bij<1−ξkij,∀φ(k)∈Rjξkij≥0,k=1,…,NijwhereNijis the total number of classified regression vectors in the two regionsRiandRj. We assumezkij=1ifφ(k)∈Riandzkij=−1ifφ(k)∈Rjthe constraints Eq. (12) rewrite:(13)zkij(wijTφ(k)+bij)≥1−ξkij,∀φ(k)∈Rijξkij≥0,k=1,…,NijwhereRij=Ri∪Rj.The solution of this optimization problem constrained is given by the saddle point of the Lagrangian, namely:(14)maxαkijβkij{minwij,bij,ξij12‖wij‖2+C∑k=1Nijξkij+∑k=1Nijβkijξkij+∑k=1Nijαkij(zkijwijTφ(k)+zkijbij−1+ξkij)}whereαkijandβkijare the Lagrange multipliers. The optimality conditions are then given by:(15){∂L∂wij=0∂L∂bij=0∂L∂ξkij=0⇒{wij+∑k=1Nijαkijzkijφ(k)=0∑k=1Nijαkijzkij=0C+αkij+βkij=0.This leads to the following dual problem:(16)maxαlij∑l=1Nijαlij+12∑l=1Nij∑k=1NijαlijαkijzlijzkijφT(l)φ(k)with constraints:(17)∑l=1Nijαlijzlij=00≤αlij≤C,∀φ(l)∈Rij.There are many mathematical solvers that allow solving the optimization problem (16) with (17). However, we use the LOQO with the language AMPL. The Eqs. (16) and (17) can rewrite in the following matrix form:(18)maxαij[1NijTαij−12αijTQijαij]with constraints:(19)αijzij=00Nij≤αij≤C1Nij,where1Nijand0Nijare respectively the unit and zero vectors ofNijelements.Qijis a matrix of dimensionNij×Nij, with(Qklij)1≤k,l≤Nij=zkijφT(k)φ(l)zlij, andZijis expressed as follows :Zij=(z1ij…zNijij).The solutionαijof problem (18) with the constraints (19) for eachi=1,…,s−1andj=i+1,…,sleads tos(s−1)/2linear separating function:(20)hij(φ)=wijTφ+bij,i∈{1,…,s−1},j∈{i+1,…,s}.The set of hyperplanes which limit the regionRifrom all the other regions is defined by:(21)Hi=[−wi1…−wij(j≠i)…−wis−bi1…−bij(j≠i)…−bis]T.Finally, the distancedi,j(k)is expressed as follows:(22)di,j(k)=wijTφ(k)+bij‖wij‖.The decision criterion of the switching time is defined according to the difference between the distancedi,j(k)andthe thresholdδ. The Algorithm 2 show the different steps of switching detection instant.The identification diagram structure based on the detection technique of switching times is shown in Fig. 4,y(k)is the current system output andyˆ(k)is the estimated output. First, the input–output data of the system are collected on the horizonNto constitute the set of data{u(k),y(k)}k=1Nfor training. Second, the SVM multi-class algorithm is used. Third, using the proposed technique of detection of switching times, we can predict online the mode under evolution. Finally, we update the observer block which depends on the value of estimated mode.To evaluate the accuracy of the proposed method we used the Mean Square Error MSE and the Variance-Accounted-For VAF which are the evaluation factors given by the following formulas:(23)MSE=1N∑k=1N(y(k)−yˆ(k))2(24)VAF=max{1−var(y(k)−yˆ(k))var(yˆ(k)),0}×100%.In this section, we apply the proposed algorithm to identify the switching time for a SISO switched linear two-mode model, where the dynamics are governed by equations of the type as in (1) with  [25]:(25)A1=[0.5100.5],B1=[01]C1=[10]ifu(k)<0A2=[0.71−0.50.5],B2=[01]C2=[10]ifu(k)≥0.We perform on model (25) a simulation with an excitation inputu(k)of type Pseudo-Random Binary Sequence (PRBS) with zero-mean and unit variance. A set of 100 data is generated by this model. The clustering algorithm was applied to this data set by choosing the following setting parameters:ra=0.25,rb=0.3750,φ1=0.5andφ2=0.15. The data classification results are presented in Fig. 5. The optimized parameterα12is expressed as following:(26)α12=[0…0α7012α71120…0]with:α7012=α7112=2.13082.Finally the equation of the hyperplanef12is given:(27)f12(φ)=[−1.2157−1.66840]φ(k)−1.1382.Now, we apply a randomly control signal for the online estimation of the switching time. The evolution of the switched signal is given in the Fig. 6.The behavior of the output systemy(k)and the estimated outputyˆ(k)evolution, are presented in Fig. 7. It is noticed that the estimated output trace perfectly follows the dynamics of the system. Fig. 8gives the evolution of the discrete state and his estimated. We find a perfect prediction of the switching instants.What leads to the conclusion that our approach improves the accuracy of the model. Table 1presents the switching instants of the discrete state of the switched system (1). We notice that for most of instants we have a zero error for detection. Indeed, the performance indexes VAF and MSE are equal to 97.8395% and 0.0048 respectively. We conclude, as well, that the suggested method of switching instants detection presents a best performance to predict the behavior of switched signal.

@&#CONCLUSIONS@&#
