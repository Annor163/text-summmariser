@&#MAIN-TITLE@&#
Parametric estimation of sample entropy in heart rate variability analysis

@&#HIGHLIGHTS@&#
A parametric approach based on autoregressive models is proposed for sample entropy.Theoretical analytical results, which were derived, help in guiding the process.A feasibility study of the technique was performed on synthetic and real series.When the parametric approach is suitable, nonlinearities are unlikely.On the contrary, a failure of the parametric approach is an index of nonlinearity.

@&#KEYPHRASES@&#
Sample entropy,Autoregressive models,Parametric estimates,Heart rate variability,

@&#ABSTRACT@&#
In this paper, a detailed study on the possibility and significance of performing a parametric estimation of sample entropy (SampEn) is proposed. SampEn is a non-linear metric, meant to quantify regularity of a time series. It is widely employed on biomedical signals, especially on heart rate variability. Results relevant to approximate entropy, a related index, are also reported.An analytical expression for SampEn of an autoregressive (AR) model is derived first. Then we study the feasibility of a parametric estimation of SampEn through AR models, both on synthetic and real series. RR series of different lengths are fitted to an AR model and then expected values of SampEn (SampEnμ) are estimated.Values of SampEn, computed from real beat-to-beat interval time series (obtained from 72 normal subjects and 29 congestive heart failure patients), with m=1 and r=0.2, are within the standard range of SampEnμmore than 83% (for series length N=75) and 28% (for N=1500) of the cases. Surrogate data have been employed to verify if departures from Gaussianity are to account for the mismatch.The work supports the finding that when numerical and parametric estimates of SampEn agree, SampEn is mainly influenced by linear properties of the series. A disagreement, on the contrary, might point those cases where SampEn is truly offering new information, not readily available with traditional temporal and spectral parameters.

@&#INTRODUCTION@&#
Heart rate variability (HRV) analysis is an important tool for evaluating cardiac autonomic regulation [1]. About 30 years ago, Pincus [2] developed a family of statistics, called approximate entropy (ApEn), to measure series regularity. Many potential applications [3–5] of this method can be found in medical research literature, in particular for detecting and testing the regularity of HRV data. Successively, to address some manifest limitations of ApEn (Pincus himself [6] reported ApEn to be a biased statistic), Richman and Moorman [7] introduced Sample Entropy (SampEn), which was also applied successfully to a wide range of problems [8–10].In the last 20 years [11], ApEn and SampEn had been the most commonly used methods to quantify the regularity of biological data. Both metrics estimate the differential entropy rate of the series [12,13]. However, SampEn: (i) is less prone to practical inconsistency, as it requires less lengthy series to converge to the final value and (ii) is relatively less biased even for not-so-long series [7]. Regarding the term “inconsistency”, Pincus [12] considered the problem of assessing if a stochastic process A was more regular than process B, by means of computing ApEn. He defined “consistent” those processes for which ApEn of A was always larger (or smaller) than ApEn of B, for any value of the parameters on which the metric depends, (i.e., m and r, see Section 2.1). Here we use the term “practical consistency” to refer to the fact that ApEn (or SampEn) of series SAis larger than ApEn (or SampEn) of series SBfor a broad range of the parameters values.ApEn and SampEn are extremely sensitive to data length (N), particularly for very short data sets, i.e., N≤200 [11]. Hence, their estimates may be far away from what expected using longer series. Unfortunately, short series are generally used in real applications. So, issues of convergence may appear when estimating the regularity of short data. A related problem arises in spectral analysis, where long time stationary series are required to achieve lower variance of the estimates. Hence, since the works of Bishop [14] and Kay and Marple [15], parametric spectrum analysis is commonly performed on short RR series [1] of 3–5min, which are reasonably stationary. We therefore verify in this work, if, in analogous circumstances, a SampEn computation based on a parametric representation of the series might convey new information.The first step of a parametric approach is to select the most appropriate family of model. For HRV signal, the most commonly used models are moving average (MA), autoregressive (AR), and autoregressive moving average (ARMA). Identification of AR models has been explored largely in the literature, it requires solving simpler equations than those required for ARMA models, and AR models are maximum-entropy models (among those sharing the same autocorrelation function). Thus, AR models are mostly used for HRV maximum-entropy spectral estimation.In this work, we will first discuss the conditions under which a parametric estimation of SampEn (and ApEn) is possible. We will limit our attention to linear AR models. Pincus [2] and then Lake [13] already tackled the problem of deriving analytical formulas of ApEn and SampEn for an AR process. Following the suggestion in [2], in this work, we have first extended the analytical expression of ApEn. Then, we have also derived an analytical expression for SampEn and tested these predictions on simulated series and real HRV data, obtained from Holter recordings.ApEn measures the likelihood that runs of patterns that are close remain close at the next incremental comparisons. The determination of this statistic is dependent on the prior selection of two unknown parameters: the length (m) of compared runs, also called templates, constructed from the series and a filtering threshold (r), i.e., the tolerance of mismatch between the corresponding elements of the templates.Given a time series {u[i]|1≤i≤N} of N data points, the calculation of ApEn [2] is as follows:1.Form templates Vm[j]={u[j], …, u[j+m−1]} of size m, for 1≤j≤N−m+1;Define the distance between Vm[j] and Vm[i]:d(Vm[j],Vm[i])=max0≤k≤m−1|u[j+k]−u[i+k]|;LetAjmbe the number of templates Vm[i] such that d(Vm[j], Vm[i])≤r, where 1≤i≤N−m+1, andCjm(r)=Ajm/(N−m+1);DefineΦm(r)=∑j=1N−m+1logCjm(r)/(N−m+1);Increase m by 1 and repeat steps 1 to 4;Finally,ApEn(m,r)=limN→∞[Φm(r)−Φm+1(r)]and it's corresponding statistics, ApEn(m, r, N)=Φm(r)−Φm+1(r), is estimated for finite series.SampEn is similar but improved version of ApEn. The calculation of SampEn [7] is performed by the following steps:1.LetAjmbe the number of templates Vm[i] such that d(Vm[j], Vm[i])≤r, where 1≤i≠j≤N−m, andCjm(r)=Ajm/(N−m−1);LetAjm+1be the number of templates Vm+1[i] such that d(Vm+1[j], Vm+1[i])≤r, where 1≤i≠j≤N−m, andCjm+1(r)=Ajm+1/(N−m−1);DefineAm(r)=∑j=1N−mCjm(r)/(N−m)andAm+1(r)=∑j=1N−mCjm+1(r)/(N−m), thenSampEn(m,r)=limN→∞[logAm(r)−logAm+1(r)]and, for a finite series, SampEn(m, r, N)=logAm(r)−logAm+1(r).An AR process of order M can be expressed asx[n]=−∑i=1Maix[n−i]+w[n]where aiare real coefficients andw[n]is a white Gaussian noise (WGN) with mean zero and varianceσw2. The parameters of the model and the autocovariance function values γk, are linked by the Yule–Walker's equations(1)1a1a2⋯aMa11+a2a3⋯0a2a1+a31+a4⋯0⋯⋯⋯⋯⋯aMaM−1aM−2⋯1γ0γ1γ2⋯γM=σw200⋯0.The m consecutive values, Xm[n]={x[n], …, x[n+m−1]}, are multivariate normal onℝm, with Normal joint probability densityf(Xm)=N(0,Σm)=exp(−XmTΣm−1Xm/2)/[(2π)mdet(Σm)]1/2and Toeplitz covariance matrixΣm=γ0γ1⋯γm−1γ1γ0⋯γm−2⋯⋯⋯⋯γm−1γm−2⋯γ0.The values γm, for m≤M, are defined by Eq. (1). When m>M, further elements in Σmare still dictated by the Yule–Walker's equationγk=−∑i=1Maiγk−i.Denoting ρk=γk/γ0 the autocorrelation coefficient, the varianceσy2=γ0of the series generated by the AR process is(2)σy2=σw2(1+a1ρ1+⋯+aMρM)−1=σw2c,where c=(1+a1ρ1+⋯+aMρM)−1.The analytical expression of ApEn(m=1, r) for a stochastic (thus also for an AR) process was given by Pincus in [2]. LetQm=∫x[m]−rx[m]+r⋯∫x[1]−rx[1]+rf(Ξm)dξ1⋯dξmbe the probability that the values Xmlie within the hypercube of side 2r, where f(Xm) is the multivariate probability density of the ergodic stochastic process. ThenApEnTH(1,r)=∬ℝ2f(X2)logQ1Q2dx[1]dx[2].This equation can be extended to derive a general analytical expression of ApEn(m, r) for any m as(3)ApEnTH(m,r)=∫ℝm+1⋯∫f(Xm+1)logQmQm+1dXm+1.where dXm=dx[1]dx[2]⋯dx[m],Following a similar approach, a theoretical value for SampEn of an AR process can be derived from the definition. In fact, the probability of matching two templates of size m within error tolerance r (i.e., the maximum absolute difference between the corresponding elements of any two templates is r) is given by:Pm=∫x[m]−rx[m]+r⋯∫x[1]−rx[1]+re−ΞmTΣm−1Ξm(2π)m/2det(2Σm)1/2dξ1⋯dξm.In fact, the difference Xm[i]−Xm[j] is distributed asN(0,2Σm). Hence, the theoretical value of SampEn of an AR model is(4)SampEnTH(m,r)=log(Pm)−log(Pm+1).It should be noted that the asymptotic theoretical values in Eqs. (3) and (4) depend on r and m and are valid in the limit N→∞. However, when computing Pm+1 for m≥M, the Yule–Walker's equations allow the factorization of the covariance matrix intoΣm+1=SΣm00σw2ST,with the change of variablexˆ[n+m]=x[n+m]+∑i=1Maix[n+m−i], where S is a transformation matrix. Hence, the value of SampEnTH(m, r) stabilizes for m≥M.Pincus [12] showed that ApEn is related to differential entropy rate, a central concept of information theory, and later Lake [13] proved that ApEn and SampEn are the differential Renyi entropy rates of order 1 and 2, respectively.In practice, Lake [13] derived the theoretical expressions of both ApEn and SampEn, from the definition of differential entropy rate, in the limit m→∞. If r is chosen independently of the standard deviation (STD) of the sequence (σy), the expressions for ApEn and SampEn become split lines in text.ApEnL(r)=log(σw)+12log(2π)+1−log(2r),SampEnL(r)=log(σw)+12log(4π)−log(2r).On the other hand, if r is chosen as a percentage of the STD, then it is(5)ApEnL(r)=logσwσy+12log(2π)+1−log(2r),(6)SampEnL(r)=logσwσy+12log(4π)−log(2r).Then, if σyin Eqs. (5) and (6) is replaced byσwcfrom Eq. (2), we have(7)ApEnL(r)=12log(2π)+1−log(2rc),(8)SampEnL(r)=12log(4π)−log(2rc).Hence, if r is fixed, Lake's estimates depend on the variance of the prediction error (σw2). On the other hand, if r varies with σy(as common in practise), they depend on the coefficients of the model (thus also on the model order M) but not anymore onσw2.Obviously, for a white Gaussian noise, which is an AR process of order zero with c=1 andσw=σy, the theoretical values in Eqs. (7) and (8) still apply.A couple of examples will help drawing a general consideration. In a first order AR model, the only pole z=−a1 must lie on the real axis andc=1/(1−a12). Thus the closer the pole to the unit circle and the lower the entropies. Similarly, in a second order AR model, with a pair of complex conjugate poles of magnitude ρ at θ=π/3,c=1+ρ21−ρ6+(ρ2−ρ4)(1−4cos2θ)=1+ρ21−ρ6=1+a21−a23and both entropies decrease when the poles approach the unit circle, unbalancing the power spectral density. Please note that for θ=2π/3 the value of c is identical and so the entropies. Analogous considerations are valid for higher order models, with larger values of entropies corresponding to situations where the frequency spectrum is “flatter”.The expressions provided in the previous two sections are asymptotic in the limit N→∞. Numerical estimates for short series obtained using the classical numerical algorithms ([2] for ApEn and [7] for SampEn) might be still far from the expected values. This is illustrated in Fig. 1(a).A possible operative approach to obtain expected values of the metrics for finite (and small) values of N is to perform a specific number of Monte Carlo simulations, and then measure ensemble statistics. While this is seldom possible with real series, given the lack of stationarity over time, it is fairly easy with synthetic series obtained from AR models, which can be generated at will. Hence, in each realization, a synthetic series of length N is generated. The values of entropies are estimated, using the classical algorithms [2,7], for specific values of m and r. Finally, an estimate of the probability density function (PDF) of the statistics is obtained, (i.e., with an histogram), from which mean and STD can be estimated. In the following, the mean values of ApEn and SampEn computed from K realizations of the process will be referred to as ApEnμand SampEnμ. Correspondingly, ApEnσand SampEnσwill label the standard deviations.Fig. 1(b) illustrates the procedure and, together with Figs. 2 and 3, show how the asymptotic values of the previous two sections match the numerical values, for various values of m, r and AR model order M.As a rule of thumb, for an AR model, we can expect SampEnμto converge much earlier (N≈100) to SampEnTH. However SampEnσis always larger than ApEnσ, suggesting that SampEn trades a much smaller bias at the expenses of a larger variance of the estimates. Also SampEnσgrows significantly with m, if N is fixed. Regarding the asymptotic values, SampEnμconverges to SampEnTH when N is large enough, and the two values start matching SampEnL only when m is larger than the AR model order.As seen in the previous section, SampEn (and ApEn) computed from series obtained from AR models can be analytically predicted from the coefficients of the models, and several theoretical results are available. Thus, one might wonder if these results can offer an insight in the analysis of real series.Similarly to what done for parametric spectral analysis, a proper AR model can be fitted to a series (being guided in the selection of the order of the model by an Akaike-like criterion and a whiteness test of the residuals). But then it is also possible to verify if the numerical estimates of entropy are in agreement with the parametric estimations. That is, if the SampEn of the original series is within the standard range (i.e., 95% of the range) of the values obtained on synthetic series, of the fitted AR model, for fixed m, r and N. Two opposite scenarios are possible. First, in case of disagreement, the AR model does not explain the series with respect to SampEn. This is the most interesting case as it suggests that the series cannot be described completely by a linear model, due to strong nonlinearities, non-Gaussianity or non-stationarity. On the other hand, when the SampEn of the series is within the standard range of the values predicted by the model, the results of the previous sections can be applied and parametric and numerical approaches lead to the same result (we can say that a parametric approach is suitable to the series at hand).Since time resolution is limited by the sampling frequency, the R peaks on the ECG are located with a precision proportional to the sampling frequency. Unless parabolic interpolation on nearby samples is employed to refine the location of the R peak, a finite sampling frequency of the ECG recorder induces quantization error in the RR series. Quantization error is a uniformly distributed white noise, which has large entropy and when the sampling rate is low (i.e., 128Hz as in certain Holter recordings) it might be relevant in the final SampEn estimates. Therefore, the simulated signal must be quantized equivalently to the original RR series.To investigate if a parametric approach is sensible in practical terms, Physionet's normal sinus rhythm (nsrdb & nsr2db), and congestive heart failure (chf2db) databases were considered for this study. The “nsrdb” database consists of 18 (5 men, age: 26–45, and 13 women, age: 20–50) long-term ECG recordings of subjects without any significant arrhythmias. “nsr2db” includes beat annotation files for 54 Holter recordings of subjects in normal sinus rhythm (30 men, age range 28.5–76, and 24 women, age range 58–73). The third database, “chf2db” includes 29 long-term ECG recordings of subjects (age 34–79) suffering from congestive heart failure (CHF). The beat annotations were obtained by automated analysis followed by manual review and correction. The ECG sampling rate was 128samples/s in all cases.The methodological steps for SampEn parametric estimation are listed in the block-diagram of Fig. 4:•“Pre-processing”. The RR series may contain ectopic beats and artifacts. To remove them, two levels of pre-processing were performed. In the first stage, only those extreme artifacts which lay outside the range [Q1, Q3]±3×IR were removed. Here IR=Q3-Q1 is the interquartile range, between the third (Q3) and first (Q1) quartiles. Ectopic beats were instead excluded in the second step, when only those RR which lay within 20% of the previously accepted RR interval were retained. The first accepted RR value of each series must lie within the IR.“AR(M)”. For each subject, RR series of some specific lengths (N=75, 150, 225, 375, 750, and 1500) were chosen in overlapping fashion (overlapped by 50%) and fitted to an AR model. The model order was determined by satisfying the Akaike information criterion (AIC) and the Anderson's whiteness test.“SampEn estimation”. Theoretical value (SampEnTH), numerical estimation (SampEnRR) and expected value of SampEn (SampEnμ), obtained by averaging K=300 Monte Carlo simulations, were estimated for each RR series. Then, the agreement of SampEnRR with SampEnμwas tested (i.e., if SampEnRR falls within the 95% standard range of SampEnμ).

@&#CONCLUSIONS@&#
A parametric computation of SampEn through AR model is largely possible when the series are short and free of artifacts. However, sample entropy of an AR process is directly related to its autocorrelation function. Thus when estimates of SampEn, computed numerically or parametrically do agree, SampEn is mainly influenced by linear properties of the series. On the other hand, when they do not match, SampEn is truly offering information not readily available with traditional temporal and spectral parameters. The work described in this paper offers the tools for a statistical test in this respect.