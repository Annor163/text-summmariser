@&#MAIN-TITLE@&#
A manifold learning method to detect respiratory signal from liver ultrasound images

@&#HIGHLIGHTS@&#
We proposed a manifold learning based method to detect the respiratory signal from 2D ultrasound images.We apply the proposed method to create breathing-corrected 3D ultrasound images.The experiments demonstrate robustness and accuracy of the proposed, and potential application in 3D ultrasound imaging.

@&#KEYPHRASES@&#
Liver ultrasound images,Respiratory gating,Respiratory signal,Manifold learning,Local tangent space alignment,

@&#ABSTRACT@&#
Respiratory gating has been widely applied for respiratory correction or compensation in image acquisition and image-guided interventions. A novel image-based method is proposed to extract respiratory signal directly from 2D ultrasound liver images. The proposed method utilizes a typical manifold learning method, based on local tangent space alignment based technique, to detect principal respiratory motion from a sequence of ultrasound images. This technique assumes all the images lying on a low-dimensional manifold embedding into the high-dimensional image space, constructs an approximate tangent space of each point to represent its local geometry on the manifold, and then aligns the local tangent spaces to form the global coordinate system, where the respiratory signal is extracted. The experimental results show that the proposed method can detect relatively accurate respiratory signal with high correlation coefficient (0.9775) with respect to the ground-truth signal by tracking external markers, and achieve satisfactory computing performance (2.3s for an image sequence of 256 frames). The proposed method is also used to create breathing-corrected 3D ultrasound images to demonstrate its potential application values.

@&#INTRODUCTION@&#
Respiration motion is a quasi-cyclic physiologic process and may lead to motion and deformation of abdominal organs, e.g. liver [1]. This physiologic process seriously affects the efficacy and efficiency of interventional and radio-therapeutic procedures performed for diagnosing and treating these diseased organs. A variety of respiratory motion modeling methods [2] have been proposed to overcome this problem, which inevitably involves detection of the respiratory signal. Here, respiratory signal can be considered as a generalized pattern of the human respiration and feature the principal component of the 3D respiratory motion.The respiratory signal can find its value in multiple liver-related clinical applications. For instance, it may be individually used for image acquisition to capture the respiration-induced moving liver [3], respiratory gating for liver ablation interventions [4,5] and radiation therapies [6], and accuracy improvement of quantitative evaluation of the hepatic perfusion [7]. In addition, the respiratory signal can also be combined with a 4D respiratory motion model for motion correction or prediction during radiation therapies [8,9] and high intensity focused ultrasound (HIFU) [10,11]. For this case, the signal is firstly used in the pre-operative procedure for establishing a correspondence model with 3D motion of the whole liver motion or specific liver part (e.g. vessels or lesions), and applied as input in the intra-operative stage to parameterize the motion model for motion estimation or prediction.One traditional and widely used method to obtain the respiratory signal is to place one or multiple external markers on the thoracic or abdominal skin to detect the dominant anterior-posterior translation of the human skin [12–14], which is viewed as measurements of the breathing phases. These markers are usually optical or electromagnetic (EM) sensors, whose position variations could be monitored by optical cameras or EM tracking devices. Recently, marker-less external tracking methods were proposed to track the whole chest or abdomen surface using optical imaging devices to provide high-dimensional respiratory information [15,16]. However, these extra positioning or imaging devices are not routinely available in clinical procedures, also need long device setup time and extra surgical working space and consequently lead to high financial costs.In order to relieve these problems existing in external marker-based methods, researchers and physicians recently proposed another class of more flexible and lower-cost methods, i.e. purely image-based respiratory signal tracking [6,17–22], which extract the respiratory signal directly from time-varying US liver images during pre-operative image acquisition or intra-operative image-guided procedures. These methods detect the respiration-related information by utilizing some specific image processing techniques to process an image region or the whole image.For the image-region-based methods [6,17–19], it is necessary to firstly specify a special image patch containing salient anatomical structures, such as the diaphragm, liver vessels or liver boundaries, from a reference image. Xu and Hamilton [6] calculated statistical dependency of successive image patches, which are located on the same position on all the processed images. These calculated statistical values (mutual information or correlation coefficient) are representative of principal respiratory motion. Hwang et al. [17] pointed that this method has severe dependency on the reference image with salient features, and statistical values cannot represent the respiratory signal well, especially in key respiratory phases, end of inhalation (EI) or exhalation (EE). Furthermore, they proposed to directly identify the motion of the salient anatomical features in image patches (called feature windows) and calculate displacements of these features with the first image patch's feature. These displacements reflect the respiratory motion of the anatomical features on images and, hence, can better delineate the respiratory signal. However, the feature identification is based on some thresholding technique, which is susceptible to speckle noise and intensity variations usually appearing in US images. Therefore, Wu et al. [18,19] proposed a template matching (TM) based method to estimate the respiratory motion of the anatomical structures on the image patches (also called template blocks). This method is robust to speckle noise and intensity variations and can recover the respiratory motion well. However, these methods above heavily rely on predefined distinctive anatomical features with strong contrast and large motion. When the features are absent or not distinctive in images, or they have small motion, these methods fail to extract satisfactory respiratory signal.Sundar et al. [20] proposed a novel phase correlation method to detect respiratory signal by considering the whole images but not image patches. This method uses the cumulated phase shift in the spectral domain of successive image frames as a measure of the respiratory motion. Wachinger et al. [21,22] pointed and experimentally demonstrated that this method cannot well recover the respiratory information from US images and further proposed a manifold learning (ML) based respiratory signal tracking for 4D US imaging. The ML-based tracking method makes use of a classic nonlinear dimensionality reduction technique, Laplacian Eigenmaps (LEM) [23], to infer intrinsic low-dimensional structures (e.g. respiratory motion of at most three dimensions) from very high-dimensional data (e.g. images of hundreds of thousands of dimensions).In this paper, we present a novel manifold learning based method to extract the respiratory signal from a sequence of 2D US B-mode images. The proposed method is based on a manifold learning technique, local tangent space alignment (LTSA) [24], which is a typical dimensionality reduction technique. This method assumes a low-dimensional manifold embedded in the high-dimensional space (image space) and each frame of the image sequence lies on this manifold. Based on this assumption, images over the breathing cycle will roughly form a continuous back-and-forth trajectory on the manifold in image space, with points at similar positions on the manifold related by the similar or same state of the breathing cycle. LTSA uses a linear approximation within each neighborhood to construct a local coordinate system for the neighborhood, and then aligns these overlapping local coordinate systems to obtain a global coordinate system. By such nonlinear mapping process, LTSA may assign to each image a low-dimensional coordinate (namely the respiratory phase) by exploring the neighborhood relationship and is well suitable for extracting the respiratory information from the image sequence.In contrast to previous image-region-based methods, our ML-based method directly takes the entire image sequence as input to extract the respiratory information and has no special requirement on salient anatomical features in images. In addition, our method could be more robust to artifacts and noise in US images and produces much smoother respiratory signal than previous image-region-based methods, which is important for respiratory gating during image acquisition. Compared to the LEM-based tracking method, the main advantage of the proposed LTSA-based method is that it can extract the local geometric information by constructing tangent planes of the local neighborhood of each point on the manifold, but LEM directly uses the distance relationship of each point with other points on the manifold. Therefore, LTSA in our paper is able to construct better mapping function to convert the high-dimensional images into corresponding low-dimensional respiratory states. The experiments in this paper will prove that the proposed LTSA-based method is able to extract more accurate and robust respiratory signal than other image-based methods and as a typical application example used to reconstruct respiration-corrected 3D US images from multiple 2D image sequences.

@&#CONCLUSIONS@&#
