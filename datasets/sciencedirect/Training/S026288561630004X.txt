@&#MAIN-TITLE@&#
Infrared ship target segmentation through integration of multiple feature maps

@&#HIGHLIGHTS@&#
Proposing a saliency map detection method through multiple feature map integration.Proposing an adaptive thresholding method for local salient region segmentation.Achieving a better performance for both visual and quantitative evaluations.

@&#KEYPHRASES@&#
Infrared images,Ship target segmentation,Feature map integration,Thresholding,

@&#ABSTRACT@&#
We investigate the issue of ship target segmentation in infrared (IR) images, and propose an efficient method based on feature map integration. It consists of mainly two procedures: salient region detection based on multiple feature map integration and salient region segmentation based on locally adaptive thresholding. Firstly, a saliency map is constructed by integrating multiple features of IR ship targets, including gray level intensity, local contrast, salient linear structures, and edge strength. Secondly, we propose an adaptive thresholding method to segment each local salient region, and a target selection procedure based on shape features is used to remove background and obtain the true target. Experimental results show that the proposed method performs well for IR ship target segmentation. The advantage of the proposed method is demonstrated in both visual and quantitative comparisons, especially for IR images with a bright background or a ship target close to port.

@&#INTRODUCTION@&#
In recent years, infrared (IR) imaging system has been widely used for maritime security, such as harbor surveillance, maritime search and rescue, and ship target tracking [1]. As a crucial step, IR ship target segmentation plays an important role in the above applications. It facilitates the detection of important features for subsequent imaging processing [2,3]. However, as the intensity values of an IR image depend on the temperatures of the imaged target and background, weather and atmospheric conditions, the image quality is sensitive to variations of the imaging scenario [4]. Generally, IR images are characterized by low resolution, low signal-to-noise ratio (SNR), and low target-to-background contrast [5]. Moreover, when the target is close to the background, it is difficult to separate the target from the background. All these challenges make ship target segmentation in IR images a tough task.Many investigations have been conducted to solve this problem, and many methods have been proposed. For instance, the mean-shift based method, which is a feature-space analysis method, has been applied for image segmentation, clustering and tracking [6]. The mean shift method works well for IR ship target segmentation in a sea background [7]. However, the segmentation process is based on region merging, where some target regions may be eliminated when the size is small, or wrongly merged with the background when the contrast is low. Active-contour based method is also commonly used for image segmentation [8]. The traditional Chan–Vese (C–V) model [9] only works well for images with statistically homogeneous intensities [10]. To overcome this issue, some improved models combining the local and global information were proposed, such as methods in [10,11]. However, the segmentation results of these methods are sensitive to initialization and time consuming. To address these problems, several strategies have been applied to improve the efficiency. For example, to achieve fast auroral oval segmentation, shape knowledge based initialization procedure has been proposed to improve the segmentation accuracy and its convergence rate [12,13]. And to further accelerate the segmentation, a multi strategies method combining universal lattice Boltzmann method (LBM) and sparse field method (SFM) have been developed [13]. Moreover, based on the assumption that the energy function of a pixel is defined by both the pixel and its neighbors, a noise robust Markov random field (MRF) embedded level set model is proposed. And during the implementation of this method, an algebraic multigrid (AMG) and SFM are applied to reduce the computational time [14]. Another commonly used method is based on thresholding [15]. Thresholding is one of the most powerful tools for image segmentation. Classical thresholding methods have the advantages of simplicity and efficiency, such as Otsu's method [16], entropy based method [17], and thresholding based on clustering criteria [18]. However, as these methods only take into account of the intensity information and ignore the spatial information between pixels, they are sensitive to noises. To compensate for this, thresholding methods considering spatial information are introduced, such as the spatial fuzzy C-means [19], 2D Otsu [20], and 2D entropy based methods [21]. These methods are less prone to noise due to the use of spatial information. Nevertheless, their performances are affected by the ratio of pixel numbers on the background and the target regions, and they cannot achieve satisfactory results when the contrast is low or the target is too small.In our previous work [22], we developed an iterative global thresholding (IGT) method. The IGT method can overcome several existing problems of IR ship target segmentation, such as low contrast, multiple targets, and uneven backgrounds. It has a good performance for IR images with different backgrounds. However, the IGT method assumes that the target region is much brighter than the background, it does not work well for images with bright backgrounds and large ship targets with non-uniform intensities. Moreover, in the region selection procedure, it will take a ship target obtained from front view as background and remove it.Therefore, despite many methods have been developed, we are still far from solving the problem of IR image segmentation. In recent years, there has been a trend towards algorithms that integrate multiple features [23,24]. As each feature can capture part of the information contained in an image, it is possible to produce better results by taking advantage of complementary properties of various features. And due to the fact that a target can often attract attention in an IR image, saliency based method is becoming important for IR target detection [25] and other image analysis tasks [26]. In this paper, to deal with the problems encountered in [22] and other approaches, we propose an effective IR ship target segmentation method by integrating multiple feature maps. Firstly, we propose a saliency map detection method through multiple feature map integration. In this step, discriminative and robust feature maps are extracted independently, including image intensity, local contrast, salient linear structures, and edge strength. And then all the feature maps are integrated to obtain a saliency map. As a preliminary step, a pre-processing procedure based on fast bilateral filtering is used to remove noises and smooth complex backgrounds. Secondly, an adaptive thresholding method is developed to segment each local salient region, and a target selection procedure is applied to obtain the true ship target. Experimental results demonstrate that our method can achieve good segmentation results for IR images with low and high contrasts, and it can segment ship targets with different sizes. Comparison results indicate that our method achieves a better performance for both visual and quantitative evaluations, especially for IR images with bright backgrounds and ship targets closely connected with the background.The flowchart of the proposed method is shown in Fig. 1Details are given in the following sections.The IR images are obtained from different maritime environments, and some samples are shown in Fig. 2These images have different types of backgrounds and different contrasts, and the sizes of the ship targets vary considerably. So it is difficult to segment all the images using only one or two simple features. To achieve an effective segmentation, feature integration is an applicable approach. By combining multiple features, we can have more information of the target from different imaging angles [27]. Based on observations on these images, we can find that they have some common characteristics. For instance, the ship target is a connected region with a regular shape, and it appears as a bright salient region with a fuzzy contour comparing with its surrounding background; and the local contrast around the target region is much higher. Although for some images the ship target is connected with a port (e.g., the first and the second images in the first row of Fig. 2 , boundary of the port can be used to separate them. Therefore, we propose a feature map integration method for effective segmentation. By integrating complementary information of various features, we intend to highlight the target regions as well as to separate the target regions from the background.IR images usually have high noise levels, and complex background will increase the difficulty of image segmentation. Therefore, effective pre-processing is necessary to improve the IR image quality. Various image pre-processing algorithms have been proposed to remove noises or enhance useful details and contrast [28]. Among the existing methods, bilateral filtering allows one to perform smoothing while preserving edges at the same time [29]. This filter has found widespread use in various image processing and computer vision applications. In this paper, we use the fast bilateral filtering method proposed in [30], which implements the bilateral filter in constant time using trigonometric range kernels. As shown in Fig. 3(b), after the fast bilateral filtering, the background is effectively smooth, while the details of the ship target are well preserved. This is beneficial for the following ship target segmentation.From Fig. 2 we can see that there are mainly three regions in the IR ship target images. These regions are sky or land background, ship target, and sea background. The intensity distributions vary according to each row. For the sky and sea background regions, their local contrasts are low; while for the ship target region, the local contrast is high. Therefore, local contrast can be used to distinguish the ship target from the background regions. To obtain the local contrast map, we use a block-based representation inspired by the work in [31]. Given an IR image I with size Sr×Sc, the filtered image is denoted as If. First we divide the image Ifinto M×N non-overlapping blocks {P11,…,P1N;…;Pi1,…,PiN;PM1,…,PMN} with Pijbeing a w×w image block, 1 ≤ i ≤ M;1 ≤ j ≤ N. In the implementation, we set w=5. The local row contrast measures the distinction between a given patch Pijand an averaged patch from row i of the blocked image, defined as(1)Ilrc(Pij)=sign(Pij−mRowi)⋅Pij−mRowi2where sign(x) is a sign function with sign(x)=−1, if x < 0; sign(x)=1, if x > 0; and sign(x)=0, otherwise. ∥⋅∥2 represents the l2 norm; mRowiis the averaged patch of row i of the blocked image, i.e.,mRowi=1/N∑j=1NPij. This local row contrast map can represent the local saliency of the ship target region, as shown in Fig. 3 (c).A ship target region appears as a closed connected region with fuzzy contours, including important edge features. Therefore, we use edge strength as another feature to highlight the ship target region. To detect the edge strength map, a scale multiplication method is used as in [32]. Two detection filters in x and y directions are used, denoted asfsx(x,y)andfsy(x,y), respectively. Here, s is the scale. Their responses to image IfareHxs(x,y)andHys(x,y), respectively. Two scales are used, a small scale s1 and a large scale s2. The scale multiplication is defined as the product of the two scale responses,PIx(x,y)=Hxs1(x,y)⋅Hxs2(x,y)andPIy(x,y)=Hys1(x,y)⋅Hys2(x,y). The modulus of point (x,y) is defined as(2)Iem(x,y)=PIx(x,y)+PIy(x,y)⋅We take the modulus Iem(x,y) as the edge strength of the pixel at position (x,y). To remove some false edges, the edge strength map Iemis thresholded. The threshold is set as [33](3)Tm=meanM+ρ⋅stdMwhere meanM and stdM are the mean and standard variation of Iem, respectively; ρ is a control parameter, and the determination of ρ will be discussed later. The binarized edge strength map BWemis obtained as follows(4)BWem(x,y)=1,ifIem(x,y)≥Tm0,otherwise.By multiplying BWemwith Iem, we obtain the following new edge strength map(5)Iem′=Iem⋅BWem.The edge strength map detection result is shown in Fig. 3 (d). Boundaries of the ship target are highlighted in the edge strength map, which is beneficial for the ship target extraction.The contour of the ship target, coastline and the sea port show salient linear structures, and the coastline and the boundary of the port play important roles in separating the ship target from the background. We detect linear structures using a Hessian matrix [34]. Hessian matrix describes the second order structures of images. Assuming the two eigenvalues of the Hessian matrix of a pixel are λ1 and λ2, they represent the variation of the intensity in one linear structure's principal orientation and its perpendicular orientation, respectively. For bright structures, they satisfy |λ1| < |λ2|. The numerical relationship between λ1 and λ2 can be used for linear feature enhancement [35].(6)Hk(x,y)=0,ifλ2>0exp−Rβ22β21−exp−Q22c2,otherwisewhere (x,y) is the location of the filter, Rβ=|λ1|/|λ2| is a blobness measure, andQ=∑j=1,2λj2is a measure of the second order structureness. β and c are manually set constants. This linear feature measure Hk(x,y) is usually analyzed at different scales, k. Small scale operator is sensitive to detail signals but is also prone to noise, whereas large scale operator is robust to noise but could filter out fine details. In this work, we want to highlight the outer contour, not the details of the ship targets. Therefore, large scales are used, with k ∈{5,7,9}. The maximum of the responses over all the scales will match the size of the linear feature. The absolute value of |λ2| shows the magnitude of the intensity variation in the orientation perpendicular to the principal orientation. It needs to be noted that the sign of the eigenvalues also play an important role in discriminating local patterns. To enhance the linear structure detection result, we add the sign of the eigenvalues to the original expression, and have the following(7)Hk′(x,y)=Hk(x,y)exp(sign(λ′))where λ′=λ1+λ2. The enhanced linear structure map Ilsis obtained as follows(8)Ils(x,y)=maxHk′(x,y)|k∈{5,7,9}After obtaining the linear structure map, a post-processing procedure is needed to remove weak and small detailed features. First, we threshold the linear structure map with a threshold Tls; and the binarization result is obtained as(9)BWouter(x,y)=1,ifIls(x,y)≥Tls0,otherwise.In this paper, to obtain adaptive thresholds, we propose to associate the threshold value with local region properties. Among the existing adaptive thresholding method, mean and standard variance are widely used for threshold determination and have been proved to be effective [36]. Therefore, we use flexible linear combination of mean and standard variance to determine the thresholds. Here, the threshold Tlsis set as(10)Tls=μls+σlswhere μlsand σlsare the mean and standard deviation of the linear structure map Ils. Then we remove small linear features by size selection, linear features with size smaller than Slsare removed (with Sls=20). Thus we can obtain long salient linear features, indicating the outer contour of the ship target, the long coastline or the boundary of the sea port, as shown in Fig. 3 (e).For different IR images, although their backgrounds are different, the ship targets generally appear as a bright region comparing with its surrounding background. So we detect bright regions by background subtraction, thus to remove most of the dark backgrounds. In the existing literatures, several models have been developed for background subtraction [37]. We intend to model the background in each single image, which requires a fixed background with much lower level of noise. In real images, this requirement cannot be rigorously satisfied, and a common method is to model each background pixel with a probability density function. As a single Gaussian model can account for noise [38] and it is much simple and efficient comparing with other complex models, we model each pixel with a Gaussian function with N(μ,σ2).The foreground Itis obtained by comparing the input filtered image Ifwith the estimated background Ib. Regions with brighter intensities than the corresponding estimated background are taken as bright foreground region, that is(11)It=If−Ib(12)BWbright(x,y)=1,ifIt(x,y)≥TD0,otherwise.The threshold TDis calculated in the following manner(13)TD=τ⋅(μf+σf)where μfand σfare the mean and standard variation values of the foreground image It, respectively; τ is a control parameter, and the determination of τ will be discussed later. The bright foreground region detection result is shown in Fig. 3 (f).Different features describe different characteristics of the ship targets. To obtain a comprehensive description of the target region, we propose to integrate all the feature maps mentioned above together with the filtered image. As different feature maps have different ranges and extraction mechanisms, it is difficult to combine them into a unique scalar saliency map. Therefore, all the feature maps are first normalized to the same range of (0,1) with(14)fz=f−fminfmax−fminwhere fmaxand fminare the maximum and minimum values of the image f. f can be the local row contrast map Ilrc, the edge strength map Iem′, the salient linear structure BWouter, the bright foreground region It,BWbright, and the filtered image If. Thus we obtain the normalized form of each attribute, Ilrcz, Iemz, Itz, and Ifz.Then all the normalized feature maps are integrated into a unique saliency map. Here, as the salient ship target region appears strongly in all the feature maps, a simple integration strategy is used. We sum all the feature maps into the saliency map in a linear manner as follows, where the binary masks BWouterand BWbrightare used as weights.(15)Isal=Ifz⋅BWtarget+(Ilrcz⋅Iemz+Itz)⋅BWbrightwhere BWtarget=BWbright−BWouter. By subtracting salient outer contour regions from the bright foreground region, we can effectively remove the linear coastline or the boundary of the sea port, which is helpful to separate the ship target from its closely connected background. After combining all the feature maps, regions with bright intensity, strong edge strength, and high local row contrast will show great saliency, as shown in Fig. 3 (g).In this part, we intend to segment each salient region using a local adaptive thresholding method. At first, the saliency map Isalis coarsely segmented into n regions {S1,…,Sn} using thresholding method. Firstly, for each pixel (x,y) in the saliency map Isal, by comparing the value Isal(x,y) with a given threshold Tsal, we obtain the binary mask BWsalin the following way.(16)BWsal(x,y)=1,ifIsal(x,y)≥Tsal0,otherwise.Then, connected regions in the binary imageBWsalare detected through connected component labeling. Finally, by assigning each connected region with the label {1,2,…,n}, we obtain the coarsely segmented regions {S1,…,Sn}, as shown in Fig. 3 (h). From Fig. 3 (g) we can see that the saliency map is divided into several local regions by dark areas next to them. In fact, the saliency value of these dark areas is not 0. In other words, some of these dark regions still have weak saliency. In our experiments, the saliency values of these dark regions are generally smaller than 0.1. Therefore, to remove these dark regions, we set Tsal=0.1.For the coarsely segmented regions Si, 1 ≤ i ≤ n, their intensity distributions are different. To obtain the final segmentation result, we develop a local adaptive thresholding method, which calculates the local threshold according to the properties of each region. A straightforward and simple way to describe local region properties is to use its mean and standard deviation values. Therefore, as mentioned above, the threshold for each region is determined using the linear combination of its mean and standard deviation value as follows(17)Tsi=meanSi+sign(α−1)⋅α⋅stdSiwhere meanSiand stdSiare the mean and standard deviation values of region Si, respectively; sign(x) is the sign function as mentioned before. α is the parameter used to control the threshold, and the determination of α will be discussed later.The segmentation result of region Siis expressed as(18)BWsi(x,y)=1,ifSi(x,y)≥Tsi0,otherwise.After the thresholding process, there are still some background regions which have great saliency; so it is necessary to perform a region selection to remove those non-target regions. We propose a target selection procedure which integrates region properties and shape features. Generally, ship target regions show stronger saliency and edge strength, so the region properties used are maximum region saliency Mrsand salient edge strength ratio Er. The edge strength ratio measures the amount of salient edges contained in the local region. It is defined as the ratio between the area of the salient edges and the local region. Given a local salient region BWsi, the maximum region saliencyMrsiand the salient edge strength ratioEriare(19)Mrsi=maxIsali(x,y),(x,y)∈BWsi,i=1,…,n(20)Eri=∑BWemi∑BWsi,i=1,…,n(21)BWsi(x,y)=0,ifMrsi<trsorEri<terwhereIsali=Isal⋅BWsi,i=1,…,n, andBWemi=BWem⋅BWsi,i=1,…,n, specify the salient region and the binarized edge strength map overlapping with the local segmented region BWsi. As expressed in Eq. (21), regions with the maximum saliency less than trsor regions with the salient edge strength ratio less than terare taken as backgrounds and removed. In our experiments, the thresholds are set as trs=0.8 and ter=0.2.Shape is one of the basic features for image description, and it plays an important role for image retrieval and target recognition [39]. For regions with high saliency and high edge strength, a further region selection process based on shape features is performed. Due to the lack of uniform shape model descriptor for ship targets, the shape features are mostly chosen based on a series of empirical hypotheses, which is similar with [22]. The shape features are region area Area, compactness Cp, width to height ratio Rwh, and upper to bottom part ratio Rub. Although these features are chosen empirically, they are based on the observation of the whole IR ship target dataset, representing common features of most of the ship targets. Except for the width to height ratio Rwh, we calculate the other shape features in the same way as in [22]. In this work, because the ship targets are obtained from different view angles, we replace the width to height ratio with the major axis length to minor axis length ratio Rmm, expressed as(22)Rmm=LMajorAxisLMinorAxiswhere LMajorAxisand LMinorAxisare the lengths of the major and minor axis, respectively. The major (minor) axis of the target region specifies the major (minor) axis of the ellipse which has the same normalized second central moment as the corresponding target region.The target region selection criterion based on shape features is as follows. Regions satisfying all these criteria are taken as true ship targets and preserved, while the others are regarded as backgrounds and removed.(23)ta1<Area<ta2andCp>tcandtm1<Rmm<tm2andRub<tubThe parameters in Eq. (23) are determined experimentally. In our dataset, sizes of the ship targets vary in a large range, so we set ta1=50, ta2=20000 to remove backgrounds with extremely small or large areas. As a ship target appears as a regular shape, the threshold for compactness is tc=0.1. Regions with compactness less than tcwill be discarded. For most of the IR images, the outline of the ship target appears as a rectangle. Taking into account the situations where the ship target is small and the major axis is almost the same or a bit longer than the minor axis, we set a lower limit of Rmmwith tm1=0.9. An upper limit tm2=12 is set to remove stripe like backgrounds, such as long coastlines and sea-sky lines. Generally, the upper part is much narrower than the lower part. But for images not taken from the side or images with a small ship target, the upper part is almost the same as the lower part. Therefore, we set tub=1.1. After the selection process, we obtain the final true ship target, as shown in Fig. 3 (i). To demonstrate the result clearly, boundary of the segmented ship target is overlaid on the original IR image, as shown in Fig. 3 (j), and the width of the overlaid boundary is set to three pixels.As mentioned above, the backgrounds of different IR images are different. To make the threshold adaptive to different images, we associate the threshold control parameters α, τ, and ρ with the estimated background and corresponding image properties. Generally, for IR images with high contrasts, the target region is much brighter than the background, and the expected threshold is much lower. While for IR images with low contrasts, the difference between the target region and the background is not distinct; therefore the expected threshold is much higher. Based on this observation, we calculate the control parameter α in Eq. (17) using(24)α=meanb/(maxb−meanb)where meanb, maxb are the mean and maximum values of the estimated background Ib, respectively. For images with high contrasts, the difference between the maximum and mean value of the background is large; while for images with low contrasts, the difference is small. So for images with high contrasts, the mean value meanb is much smaller than that of maxb−meanb, that is α < 1, and we have a lower threshold. While for images with low contrasts, the mean value meanb is close to maxb, so meanb is greater than maxb−meanb. Hence we have a higher threshold with α > 1. Consequently, by associating α with the estimated background, we can obtain the local threshold for each salient region adaptively.The control parameters τ in Eq. (13) is closely related to α. The bright foreground detection result is affected by the estimated background, therefore the expected threshold TDis similar to Tsi. That means a high TDis expected for an image with a low contrast, while a low TDis expected for an image with a high contrast. Therefore, the value of τ is similar to that of α. In this work, we set τ=α.Another control parameter ρ in Eq. (3), which is used for edge strength map detection, is also related to α. It is obtained by(25)ρ=αsign(stdM−b)where stdM is the standard deviation of the edge strength map Iem; b is a constant, and we set b=0.01. For IR images with low contrasts and small targets, few details are contained, so the edge strengths of the image are weak with a small standard deviation. When stdM is smaller than b, and sign(stdM−b) is −1, and α > 1 as mentioned above, we obtain a small ρ value. This is helpful for preserving the edge strengths of the ship targets. On the other hand, IR images with high contrasts and large targets contain many details structures. In this case, we obtain a large ρ value, which can preserve strong edge strengths while removing weak ones.

@&#CONCLUSIONS@&#
IR image segmentation is an important technique in the field of IR image processing, and it has wide applications. To segment the IR ship targets, an effective segmentation method based on feature integration is presented in this paper. To make the method robust for different IR images, we take advantages of multiple features of the ship targets, including local contrast, edge strength, salient linear structures, and bright intensities. Firstly, we construct a salient region map by integrating these features, thus to highlight the ship target region as well as to separate the target from the background. Then, we develop a local adaptive thresholding method for each salient region segmentation, thus to segment all the ship targets in the IR image. Besides the two main steps, a pre-processing step using fast bilateral filtering and a target selection procedure based on region and shape features are used to improve the performance. Experimental results demonstrate that the proposed method works well for IR ship target segmentation with different backgrounds. Due to the integration of complementary properties of multiple features, this method is effective and robust. It can effectively segment IR ship targets, especially for ship target with bright port background and large ship target with uneven intensities. The visual and quantitative comparison results verify that the proposed method is superior to the other well known methods. Therefore, the proposed method would be useful for the applications of IR ship target detection and tracking.Currently, the thresholds used are determined in a heuristic way, and the implementation is carried out in a serial mode. In our future work, we would investigate more theoretical guaranteed method for adaptive threshold determination, and some parallel processing technologies would be further considered to improve the efficiency.