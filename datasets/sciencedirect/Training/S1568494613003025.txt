@&#MAIN-TITLE@&#
Modelling energy storage systems using Fourier analysis: An application for smart grids optimal management

@&#HIGHLIGHTS@&#
We propose a new representation of the optimization dispatch variables.The handled variable are subject to zero-integral constraints in a given time interval.The basic idea comes from Fourier analysis.Fourier decomposition is used to design parametric courses showing zero integral.Advantages are for new optimization problems formulation with parametric functions.

@&#KEYPHRASES@&#
Integral constraints,Electrical energy storage systems,Fourier analysis,Optimal dispatch of resources,Multi-objective evolutionary algorithms,Smart grids,

@&#ABSTRACT@&#
In this paper, a new and efficient model for variables representation, named F-coding, in optimal power dispatch problems for smart electrical distribution grids is proposed. In particular, an application devoted to optimal energy dispatch of Distributed Energy Resources including ideal storage devices is here considered. Electrical energy storage systems, such as any other component that must meet an integral capacity constraint in optimal dispatch problems, have to show the same energy level at the beginning and at the end of the considered timeframe for operation. The use of zero-integral functions, such as sinusoidal functions, for the synthesis of the charge and discharge course of batteries is thus consequential. The issue is common to many other engineering problems, such as any dispatch problem where resources must be allocated within a given amount in a considered timeframe. Many authors have proposed different methods to deal with such integral constraints in the literature on smart grids management, but all of them do not seem very efficient. The paper is organized as follows. First, the state of the art on the optimal management problem is outlined with special attention to treatment of integral constraints, then the proposed new model for variables representation is described. Finally, the multiobjective optimization method and its application to the optimal dispatch problem considering different variables representations are considered.

@&#INTRODUCTION@&#
More and more literature uses traditional analytical functions to analyze and model the physical properties of complex phenomena [1–22]. Such more efficient analytical representation of physical phenomena can also be deployed in optimal control or management problems, giving rise to unexpected good solutions [23–25,8,3,26–47].In this paper, the problem of optimizing a set of given real control variables over a set of subsequent time intervals is dealt with. Such problem, in the field of electrical power engineering, is typically devoted to the optimization of the dispatch of generated power. Originally, this problem was aimed at identifying the optimal technical and economical dispatch schedule for generation units in High Voltage systems; now the same issue is formulated also for power distribution systems where generation units are also present (distributed generation, DG). In such systems, also electrical energy storage systems may be installed in order to produce a virtual shifting of the peak load and an efficient storage for energy produced from renewable sources (photovoltaic, wind based, etc.). The efficient management of all these Distributed Energy Resources, DER, is a complex mixed integer optimization problem that may show more than one objective and constraints. The advanced telecommunication infrastructure that connects the DER with a unique Energy Management System creates a smart environment where resources can be coordinated in order to attain optimal feasible technical and economical working points. Due to the features of the variables and of involved objectives and constraints the optimization issue has been dealt with using evolutionary computation methods [48–51]. Moreover, when energy storage systems, ESS, are present, an integral constraint on the amount of energy stored at the beginning and at the end of the dispatch timeframe must be considered. The problem thus shows a large search space and a complex formulation; these factors often limit the efficiency of whatever search algorithm, giving rise to largely sub-optimal solutions or limited convergence.In this paper, the problem formulation is modified and a new model for the variables representing the power output from ESS is considered. Such formulation consists in the synthesis of the charge and discharge course of batteries using ‘universal’ functions showing zero integral over a considered time interval. In this way, the number of variables can be reduced and the integral constraint concerning the amount of energy exchanged with the network is implicitly satisfied. In other words, the dispatch problem is turned into a parameters identification problem. Besides, the issue is common to many other engineering problems, such as any power dispatch problem where energy resources must be allocated within a given amount in a considered timeframe (hydrogen, thermal energy, etc.) [52–54].In general, the literature on optimal dispatch of energy resources in smart grids can be divided based on the applicable solution methods for this problem: techniques such as dynamic programming, simulated annealing, tabu search, fuzzy computing and genetic algorithms.The literature can also be tackled from the point of view of the formulation of the optimization problem as well as of the analysis of particular technical constraints, such as generator ramp limits, energy storage balance or environmental constraints, such as carbon dioxide emissions targets. The work in [55] presents a comprehensive survey of the most interesting papers on the issue.Focusing on the ESS management and the integral constraint representation, in [56] a deterministic optimization model that explores the difficulty met by Electric Energy Storage (EES) systems when economic dispatch for multiple-service provision is dealt with, is presented. In this case, the integral constraint on ESS is considered as a linear constraint, but the problem formulation does not consider, in the objectives, the non-linear terms connected to energy losses. In [51], the problem of optimal management is dealt with using the Particle Swarm Optimization method and the constraint about the integral of the output power injected from ESS is considered. In this case, the authors discard the solutions that do not meet the constraint ‘a posteriori’. In [52], the formulation of the same constraint is carried out through a linear equality constraint, but the authors do not activate it in the applications. Also [57] considers batteries and state of charge in the problem formulation, but again the constraint is formulated with more inequality constraints and one equality constraint. Morais et al. [58] uses mixed-integer linear programming and the formulation of constraints for electrical ESS is still based on a set of equality and inequality constraints.Finally a recent paper [59] on sizing of ESS uses a very similar concept to the one here proposed, but the Fourier analysis is used for analyzing and not for synthesizing the course of power contribution from the batteries. The Fourier analysis of the load course or photovoltaic plants production gives an idea on how to size the ESS.This paper proposes a new representation of one of the variables in the optimal dispatch problem in smart distribution power systems: the ESS output power along the considered dispatch timeframe. In this problem, the variables are the output powers from DER in each elementary time interval. The ESS output power is constrained by the fact that it must show the same state of charge at the beginning and at the end of the dispatch timeframe. Such constraint can be expressed by saying that the integral of the course of the output power is null. The basic idea proposed in the paper is thus to formulate such course using zero integral functions with a wide representation potential, such as sinusoidal functions in Fourier series. In other words, the underlying general idea is that, when feasible and convenient, the optimal dispatch problem can be turned into a parameters identification problem.The paper is organized as follows. Section 2 is devoted to the definition of the optimal dispatch problem in smart grids. Section 3 explains in greater details the proposed F-coding based on the use of Fourier series in the optimal dispatch problem. Section 4 briefly recalls the evolutionary computation algorithm used for the applications, whose results are finally reported and commented in Section 5.Smart grids or microgrids have many energy generation points that can be managed optimally according to real-time energy cost, efficiency and environmental objectives. Such energy generation points are referred to as Distributed Energy Resources, DER (internal combustion engines, small and micro gas turbines, fuel cells, photovoltaic and wind plants or storage units). DER comprises electric generating units (typically in the range of 3–200kW), parallel to the electric utility or stand-alone, located within the electric distribution system at or near the end user.Such systems are small Medium Voltage (MV) or Low Voltage (LV) distribution networks with enough local generated power to supply entirely a local load demand. Storage systems are typically installed to improve load profile according to energy cost and machines efficiency. Such as storage systems, also distributed generation units are remotely controllable and can be operated co-operatively to improve power quality and to reduce operational costs. Fig. 1shows a typical layout of a MV micro-grid.As shown in Fig. 1, the High Voltage, HV, grid supplies the micro-grid through an HV/MV transformer. The Micro-Grid Central Controller is installed downstream the transformer; the Microsource Controller and the Load Controller are respectively located near the generation units and the loads. In the same graph, the power converters AC/AC and AC/DC interface the DER with the grid. Such conversion system is able to change the voltage module and displacement to adapt the power injection to the current operating needs. The LC and MC are usually implemented into the inverters control logic. Every DER produces LV electric power and is connected to the grid through an MV/LV transformer.The MGCC [60] together with other functions also performs the optimal power generation dispatch (generation unit-commitment). The optimal power generation dispatch calculates the active and reactive power set points during the subsequent day in order to minimize various technical, environmental and economical objectives. From the analytical point of view, the issue of optimal power dispatch among DER through unit commitment in micro-grids appears to be very complicated since it is non-linear and shows multiple objectives to be optimized and many constraints to be met. A large literature on the more specialized topic of Energy Management Systems for smart grids is available; some of these papers are here recalled [61–64]. In these papers the issue of optimal dispatch of energy resources in a smart grid is considered and different formulations of the problem are proposed. Besides, the presence of real and/or reactive storage units strongly influences the possibility to dispatch power and to perform voltage and frequency regulation by controlling their status.For a given design configuration (size, type and location of DER; size and location of capacitor banks), knowing the hourly upper and lower production limits of each DER and the hourly loading level of each bus of the electrical distribution network, the most important objectives to be achieved are:•minimization of the yearly power losses;minimization of the yearly overall production costs;minimization of the yearly CO2 emissions.The independent optimization variables are the hourly power productions of the DER and the hourly storage units level.Consider a n-bus microgrid system with:-Nfixload or generation nodes with fixed forecasted real and reactive power demands or injections;NDERcontrollable DER, Nbattof which are controllable ESS.The problem is that to identify the real valued vector identifying the operating points of the DER in the network every elementary time interval (i.e.: hour by hour) of the Ndayrepresentative days of the different periods of the year. The timeframe for dispatch (number of elementary time intervals) is indicated with T. The vector has thus NDER×T×Ndayreal elements; a subset of it, taken for the jth DER in the generic day d, takes the following form:(1)xj,d=[Pj1,d,Pj2,d,…,PjT,d]Such vector represents the status of the jth DER in all the elementary time intervals of the day, from 1 to T. The relevant reactive powers,Qjt,d(t=1, …, T) are deduced accordingly since the buses are voltage controlled (PV nodes).The entire vector x can thus be written as:(2)x=[x1,1,x2,1,…,xNDER,1,…,x1,Nday,x2,Nday,…,xNDER,Nday]subject to the following constraints:(a)upper and lower limits of the values of controlled variables, namely DER power outputs, taking into account the required power reserves;(3)Pjmin≤Pjt,d≤Pjmaxt=1…T,d=1,…Nday,j=1,2,…,NDER(4)Qjmin≤Qjt,d≤Qjmaxt=1…T,d=1,…Nday,j=1,2,…,NDERwhere•Pjt,d,Pjmin,Pjmaxj=1, 2, …, NDERrespectively represent: the active production at time t of day d, the minimum and maximum limits of real power that can be injected by the jth DER;Qjt,d,Qjmin,Qjmaxj=1, 2, …, NDGrespectively represent: the reactive production at time t of day d, the minimum and maximum limits of the reactive power that can be injected by the jth DER;the solution must give raise at all nodes to voltage drops below a maximum limit;the solution must satisfy the constraint about power transfer limits in the network lines, this constraint is usually always satisfied in well designed networks, therefore, in this formulation, it will not be considered;the solution must meet the energy balance constraint for controllable ESS:(5)Ek(0,d)=Ek(T,d)k=1,…Nbatt;d=1,…NdayEk(t,d)=Ek(t−1,d)+(Pkt,d)Δtt=2,…T;k=1,…Nbatt;d=1,…NdayEk(t,d)<=Exkt=1,…T;k=1,…Nbatt;d=1,…Ndaywhere Δt is the reference elementary time interval,Pkt,dis the power input or output at time t of day d and at node k, while Ek(t,d) is the state of charge of the kth ESS at time t of day d.the solution must satisfy the constraint about the maximum number of manoeuvres in order to preserve the lifetime of batteries:(6)n_man≤max_manwhere n_man indicates the number of charge and discharge manoeuvres within the considered timeframe; max_man is the maximum number of manoeuvres within the considered timeframe.the power output where converters interfacing ESS are installed at the kth node must not overcome the rated power of converters, Pconv,k:Yearly joule energy losses in the system(8)O1(x)=∑d=1,Nday∑t=1,T(ΔPt,d)ΔtIn this expression, the energy losses at time t and day d in the system are obtained as the product of the power losses indicated with ΔPt,dmultiplied by the elementary time interval Δt; Δt is typically 1h. The quantities in round brackets are considered constant in the considered time interval.Yearly fuel consumption cost [65](9)O2(x)=∑d=1,Nday∑t=1,T∑i=j,NDGCPj(P)Pjt,d⋅Δtwhere CPj(P) is the unitary fuel consumption cost of the jth source,Pjt,dthe power output from the jth source at time t and day d, considered constant in time interval Δt;yearly CO2 emissions:(10)O3(x)=∑d=1,Nday∑t=1,T∑j=1NDGEmjt,dwhereEmjt,dis the amount of CO2 emissions from the jth DER unit at time t during day d.The emissions term is non linear and is taken from [66]. Therefore, the formulated problem is that to determine the operating points of the DER giving rise to a technical–economical optimum as a compromise between minimum cost operation, high sustainability and high quality service. Minimum cost operation is ensured if the overall fuel consumption is minimum.The problem is dealt with using a multi-objective evolutionary approach: the Non-dominated Sorting Genetic Algorithm II [67].In constrained optimization problems formulation, if possible, it is generally advisable to represent solutions so that they are always feasible, namely their coding must as much as possible be efficient by integrating as many constraints as possible. In the following section, an efficient way to represent the variables using Fourier analysis to deal with constraints (d)–(f) is presented.The other constraints are considered using the constraint domination concept [68].In the above formulation, a number of constraints are considered. Using evolutionary computation and real coded variables, constraint (a) is typically considered when generating a new solution or perturbing an existing solution.If we consider only one day for dispatch, Nday=1, the elements of the vector x can be generated through the following equation:Pjt=Pjmin+random×(Pjmax−Pjmin)While the elements of the vector x can be perturbed using the following equations:P¯jt=Pjt+random×(Pjmax−Pjt)P¯jt=Pjt−random×(Pjt−Pjmin)where random is a random number extracted with uniform probability between 0 and 1 andP¯jtis the mutated ofPjt. Constraints (b) and (c) can both be expressed through inequality constraints to be necessarily evaluated after the execution of the load flow calculations.Constraint (d) is an integral constraint that puts severe limitations on the generation of solutions and links each other the variables of the string. In general, discarding solutions that do not meet such constraint strongly increases computation times and reduces the efficiency of the algorithm.Starting from the assumption that in the generic node k where an ESS is installed, the variations of the state of charge, ΔE, must verify the following equation:(11)ΔE=∑t=1,TPkt⋅Δt=0wherePktis the power input or output at time t for the ESS installed at node k. In this expression, Δt is set to 1 if the elementary time interval for dispatch is 1h. It is evident that generating a feasible solution using the variables representation outlined in (1) and (2) satisfying Eq. (11) is not trivial.In this paper, the authors propose a new way to formulate the variables at the nodes where the ESS are installed. Such new way intrinsically produces feasible solutions according to the integral constraint (11), and the other constraints concerning ESS.Since the discrete integral of energy stored and released by the ESS in the considered timeframe must be zero, Eq. (11) can be written in a different way assuming that the charge and discharge course of batteries can be written as the summation of continuous functions showing zero integral (sines).Eq. (11) can thus be formulated in a different way:(12)ΔE=∑i=1nfak,i(t)=0where∑i=1nfak,i(t)=∑i=1nfAx,kisen(ωk,i⋅t+Ψk,i)and Ax,ki, ωk,i,ψk,iare real numbers. Moreover, ωk,i=2πi/T, with T=24.Assuming that the number of sine functions composing the course of energy along T is nf=3, Fig. 2(a) shows the terms ak,1ak,2ak,3 (in the figure, the subscripts k are omitted) of the summation in (12), while Fig. 2(b) shows the course of the result of the summation ΔE. Of course the functions considered are taken at discrete times, t, along T.In Eq. (12), we have assumed that the course of the state of charge of the ESS can be represented as the summation of nfsinusoidal functions showing zero integral over the considered timeframe. Thus the solution string for the optimal dispatch problem varies and the power injection at the kth node where the ESS is installed can be represented with nfsets of 3 real numbers. The variable nfis the highest order harmonic if we consider Eq. (12) as a Fourier analysis expansion. The presence of the ith component depends on the value of the sine wave amplitude Ax,ki: if such parameter takes nonzero value the relevant component is present, otherwise it is absent.If Nday=1 and the timeframe T includes 24 elementary time intervals for scheduling purposes, the standard representation defined by Eqs. (1) and (2) needs 24 real values to define the state of charge of each ESS. The proposed representation depends on nparparameters for each ESS and, from (12), such number is related to nf. Since each sinusoidal function is characterized by 2 parameters, namely Ax,kiand ψk,i, if nfis below 12, the proposed representation deriving from (12) shows a reduced number of variables. The state of charge of each ESS can indeed be defined through 2×nfunknown parameters. Namely, amplitude and displacement of each considered harmonic, since the frequency ωk,iis related to the order.Once the values of Axk,iand ψk,iare fixed, and ESS at time 0 have a given state of charge, Ek(0), the energy level of ESS can be calculated for each time interval t using Eq. (12), in the following way:(13)Ek(t)=Ek(0)+∑i=1nfAx,kisen(ωk,i⋅t+Ψk,i)The ranges of variation of the new variables to generate feasible plans according to the integral constraint are thus the following:(14)ΣAxk,i∈[0,Exk−Ek(0)]k=1,…,Nbatt;i=1,…,nfψk,i∈[+π;−π]k=1,…,Nbatt;i=1,…,nfwhere Exkis the rated size of the ESS at bus k.Constraints (e) and (f) can also be accounted for, using F-coding. Considering that the frequency related to the highest order harmonic influences:-the number of power fluctuations and thus the regularity of the profile of the state of charge of each battery. The value of the highest harmonic nfcan thus be fixed assuming that it is not desirable to have frequent charge and discharge cycles in order to preserve the lifetime of batteries, see Eq. (6).The derivative of the energy released or entering the ESS and thus the input/output power flow, see Eq. (7).Considering the first issue about the number of manoeuvres, if T is 24, the number of manoeuvres ranges from one to 2×nf. If the maximum number of manoeuvres per day is max_man, the highest order to be considered not to violate constraint (6) is:(15)nf=max_man2Considering the second issue about the maximum power injection from the kth battery bank, it is possible to limit the maximum order harmonic considering that:maxdEk(t)dht=1,…,T=∑i=1nfωk,iAx,kiNamely, the maximum value of the derivative of the state of charge expression in (13) is the maximum power flowing through the kth node where the ESS is installed, Pconv,k.Knowing that ωk,i=i(2π/T), it is possible to have feasible solutions during generation of new solution or perturbation of existing solutions considering together with Eq. (14) also the following condition:(16)∑i=1nfωk,iAx,ki≤Pconv,kWith the proposed formulation, the optimization string (1) for node k where a ESS is installed, thus becomes:(17)x′j,d=[Ax,j1d,ψj1d,…,Ax,jnfd,ψjnfd]In this paper, the efficiency of the proposed F-coding against the standard coding will be proved using a multi-objective optimization evolutionary algorithm, the Non-dominated Sorting Genetic Algorithm II.It must be underlined and it will be proved by the applications that managing constraint (14) and (16) with F-coding is much easier then managing constraint (5)–(7) with standard representation of variables.A multi-objective optimization problem has a number of objectives that have to be maximized or minimized [69]. There are different ways to deal with a multi-objective optimization problem, e.g., objectives can be aggregated into a single one, but most work in the area of multi-objective optimization has concentrated on the approximation of the Pareto set by stochastic population-based methods. Evolutionary and meta-heuristic techniques are suitable for this task, since many of these methods proceed through the modification of sets of solutions (population-based algorithms). Accordingly, the outcome of a population-based multi-objective optimization algorithm is considered to be a set of mutually non-dominated solutions, or Pareto set approximation.The concept of non-dominance is one of the basic concepts in multi-objective optimization.For a problem having more than one objective function to minimize (say, fj, j=1, …, m and m>1) any two multidimensional solutions x[a] and x[b] can have two possibilities: one dominates the other or none dominates the other. A solution x[a] is said to dominate the other solution x[b], if both the following conditions are true:(a)The solution x[a] is no worse than x[b] in all objectives, fj(x[a])≤fj(x[b]), for all j=1, …, m.The solution x[a] is strictly better than x[b] in at least one objective, or fj×(x[a])<fj×(x[b]) for at least one j×∈{1, …, m}.If any of the above conditions is violated, the solution x[a] does not dominate the solution x[b]. If x[a] dominates the solution x[b], it is also customary to write x[b] is dominated by x[a], or x[a] is not dominated by x[b], or, simply, among two solutions, x[a] is the non-dominated solution.It is again important to underline that the concept of optimality in multi-objective optimization is related to a set of solutions, instead than to a single one. Sets of solutions can be equivalent if we aim at optimizing more than one objective.It is therefore possible to define Pareto local and global optimality for sets of solutions.P is a locally optimal Pareto set, if for every member x in P, there exist no solution y in a small neighbourhood, which dominates every member in the set P.P is a global Pareto-optimal set, if there exist no solution in the search space, which dominates every member in the set P.From the above discussion, it is possible to point out that there are primarily two goals that a multi-criterion optimization algorithm must achieve:1.guide the search towards the global Pareto-optimal region;maintain population diversity in the Pareto-optimal front (prevent crowding of solutions).In the following section the well known Non-dominated Sorting Genetic Algorithm II proposed by Deb et al. [67] is briefly recalled.In this algorithm, the concept of non dominance is used for solutions prizing.The algorithm described in the following applies to constrained multi-objective problems, using the constraint domination concept for solutions selection.The Non-dominated Sorting Genetic Algorithm II is an evolutionary optimization method, where sets of solutions are evolved by means of recombination operators such as mutation and crossover. As Non-dominated Sorting Genetic Algorithm [67], NSGAII divides the population in fronts of non-dominated solutions so that the search can be addressed towards interesting areas of the search space, where the global Pareto optimal region is presumably located.In NSGA and NSGA-II, solutions are prized on the basis of their non-domination level, which is called solutions ranking. But basically, NSGA-II varies from the NSGA in three main things. It is more efficient computationally, since the ranking of solutions based on non-domination is performed with an O(mNP2) algorithm, instead of O(mNP3), where m is the number of objectives and NPis the population size; it significantly prevents the loss of good solutions once they have been found (elitism); it does not need any parameter specification. A Binary Tournament Selection operator is used to select the offspring population, whereas crossover and mutation operators remain as usual.In the following subsections the main operators of the algorithm are briefly described. Before selection is performed, the population is ranked on the basis of an individual's non-domination level and, to allow the diversification, a crowding factor is calculated for each solution.In order to sort a population of size NPaccording to the level of non-domination, each solution must be compared with every other solution in the population to find if it is dominated. The fast non-dominated sorting approach will require at most O(mNP2) computations. Further details on its implementation can be found in [3].To get an estimate of the density of solutions surrounding a particular point in the population, the average distance of the two points on either side of this point along each of the objectives is considered. In this paper, this measure has been normalized. Considering the ith solution x[i], this quantity x[i]distanceserves as an estimate of the size of the largest cuboid enclosing the point i without including any other point in the population (crowding distance). In Fig. 3, the crowding distance of the ith solution in its front (marked with solid circles) is the average side-length of the cuboid (shown with a dashed box) in the objectives space.The pseudo-code reported in Fig. 4can be used to calculate the crowding:Here fj(x[i]) is the jth objective function value of the ith individual solution vector in the set I. It must be observed that the crowding distance is normalized along each direction of the objectives space using the maximum distance between the objective function values along direction j, max_dist[j].The crowded comparison operator guides the selection process at the various stages of the algorithm towards a uniformly spread out Pareto-optimal front. Every individualxin the population is given three attributes:1.Constraint violationNon-domination rank in the objectives space directions (x.rank)Local crowding distance in the objectives space directions (x.distance)A solution i is said to constrained-dominate a solution j, if any of the following conditions is true:(a)Solutions i and j are feasible and solution i dominates solution j.Solution i is feasible and solution j is not.Solutions i and j are both infeasible, but solution i has a smaller constraint violation.In this way, every time a binary tournament selection operator is applied to any couple of solutions it is possible to select one of the two.Crossover and mutation operators depend on the problem at hand. In this paper, these operators are implemented as usual. In Fig. 5, one cycle of the NSGA-II procedure is represented. Popitand Popit+1 are the populations of solutions at iteration it and it+1, whilePop′itis a partially ordered (≥n) set of solutions.The applications have been carried out on a 28-buses existing network in S. Maria di Gallea, Rome, Italy. Its electrical features and structure can be taken from [70]. In the system, there are photovoltaic generation systems and different microturbines. The system also has one storage unit. The system is connected to the main grid, see Fig. 6.The NSGA-II is run with a population size of 80 elements and 150 iterations, mutation probability 0.3 and the crossover probability 0.7. In the applications, it was decided to minimize objectives Yearly joule losses and Yearly fuel consumption cost.Runs are carried out for only one day, thus the dependency of variables on day d is not evidenced. Δt is set to 1 since the elementary time interval for dispatch is 1h.The following results are referred to different runs carried out with(1)standard variables representation;Fourier based ESS variables representation (F-coding).In the standard representation, at the kth node were the ESS is installed the relevant variables are generated hour by hour in the following way:Pkt=Pkmin(t)+random×(Pkmax(t)−Pkmin(t))with:Pkmin(t)=Ex,k−Ebatt,k(t−1)ΔtPkmax(t)=Ebatt,k(t−1)Δtwhere Ex,kis the size of the ESS and Ebatt,k(t) is the state of charge of the ESS at node k at hour t. A similar mechanism has been used to mutate solutions.In the same way, using the new F-coding representation, harmonics amplitudes and displacements are perturbed randomly within the prescribed limits, see (14) and (16). While nfhas been chosen according to max_man using Eq. (15).The following applications aim at showing that:-the proposed F-coding allows an integral constraint free representation of the state of charge of the ESS in optimal dispatch problems;when constraints on the number of manoeuvres and on the maximum power flowing in the converter are not considered, F-coding and standard coding achieve results of comparable quality, although F-coding shows better stability of results;the proposed F-coding can use a limited number of parameters and in relation to this can have even more stable results;the proposed F-coding has a ‘representation potential’ increasing with the number of parameters and thus the number of composing sine functions, represented by nf;the proposed F-coding, when constraints on the number of manoeuvres and on the maximum power flowing in the converter are considered, always produces results; the standard representation may not produce any result. This is as more evident as the number of batteries, and of variables, increases.First of all, a comparison was carried out running the NSGA-II algorithm 50 times using the two representations; the test system is represented in Fig. 6 with one battery installed at node 6. In these runs, constraints (e) and (f) in Section 2 are not considered.To compare the two representations, with the maximum representation potential for F-coding, nfwas set to 12 and thus it was possible to execute one manoeuvre every hour.Tables 1 and 2report the results attained by the algorithm in terms of standard deviation on the solutions found by the algorithm and average value of the objectives over 50 runs of the NSGA-II:-daily energy losses, Daily_ΔEj;daily production costs: Daily_Cprod.Tables 1 and 2 show that, using F-coding, the solutions found by the algorithm are more stable and of comparable quality on average. Namely, the minimum losses solution at every run of the optimization algorithm is taken and the relevant minimum losses value is recorded. Then the average value and standard deviation of these out of all runs are taken and reported in Table 1.Same thing is done for minimum cost solutions in Table 2. The tables evidence that the use of the proposed F-coding improves the stability of the search algorithm.Table 3shows the best configuration attained out of the executed 50 runs, both for the minimum losses solutions and for the minimum cost solutions, using the two representations. The negative values are connected to the possibility to get a revenue from selling energy to the grid. A slightly lower energy losses value is again observed with the standard representation in the minimum losses solution, although in terms of stability of results, as it was said before, it is better to use the F-coding.Fig. 7(a) and (b) shows the state of charge dispatch plan for the ESS using standard representation for minimum losses and minimum cost solutions, while Fig. 8(a) and (b) show the same state of charge dispatch plan attained using the F-coding for minimum losses and minimum cost solutions.A few more runs show that increasing the value of nfit is possible to attain more varied but even more irregular courses; on the contrary, reducing the value of nfcauses more regular dispatch plans with less manoeuvres on batteries. Fig. 9(a)–(d) show some dispatch plans for minimum cost solutions attained with the proposed F-coding as nfvaries.Other experiments have analyzed the possibility to consider constraints about the maximum number of manoeuvres and the maximum power flowing through the interface node where the converter is installed.Using the standard representation, the latter constraint has been verified and corrected whenever a perturbation on the variables has been carried out, therefore in the final solutions it is never violated. The number of manoeuvres, on the other hand, has been treated as a regular constraint in constrained domination comparison operator whose violation was bringing a linear increase of a penalty factor, see Section 4.3.Some other simulations have been carried out activating the constraints about the maximum number of manoeuvres and the maximum power flowing through the interface node where the converter is installed.The results are shown in Tables 4–7. They prove that, when constraints are activated, the algorithm gives improved performance using the proposed F-coding. In particular, Tables 4 and 5 report the results attained in a sample of 50 runs by the algorithm in terms of standard deviation and average value of the objectives, setting the maximum number of manoeuvres to 6, and thus nf=3 for the F-coding representation. The attained results show that F-coding outperforms the standard representation, both in terms of average values and of standard deviation and thus stability of the algorithm. From the comparison with the values attained in Tables 1 and 2, it is also evident that introducing constraints the behaviour of the standard representation is strongly worsened while F-coding keeps same performances.Tables 6 and 7 show the results of simulations carried out with increasingly strict constraints respectively employing the F-coding representation and the standard representation. In the tables, with Pconvit is indicated the maximum value of the power flow through the converter at the node where the EES is installed.Namely it is the entity of the discharge depth in the elementary time interval.It must be also considered that, in the case with max_man=6 and Pconvequal to 33% Ex,k/Δt, the algorithm using the standard representation finds a solution only once every three runs.Increasing the number of ESS installations in the network, and thus the number of variables to be optimized, the algorithm using the standard representation hardly finds feasible solutions. When the F-coding is employed, the efficient combination of a feasible search space and adequate perturbation operators always leads to feasible solutions.The simulations have been carried out on the test system in Fig. 6 in the two following scenarios:(a)two ESSs at nodes 5 and 6;four ESSs at nodes 3, 5, 6, 14.In case (a), with the standard representation it is not possible to find any solution with a number of manoeuvres below 12. Moreover, with max_man=12, the algorithm employing the standard representation of variables, does not find any solution for Pconv<66% Ex/Δt.In Table 8, the comparison between the objectives attained with max_man=12 and Pconv=66% Ex/Δt in two runs using different representations is shown.In case (b), 50 runs have been executed with the same constraints (max_man=12, and Pconv=66% Ex/Δt). With the standard representation, only once every five runs it was possible to find a solution on a sample of 50 runs. In Tables 9 and 10the results attained in the first ten runs are reported.As it can be observed from the applications and the tables summarizing the obtained results, the proposed new representation for optimization variables, named F-coding is able to successfully describe the optimized behaviour of Electrical Storage Systems in optimal power dispatch for smart grids. The approach can be used in all those engineering problems in which a zero integral capacity constraint is present and, in general, it offers a new perspective for optimal dispatch problem in which the course of certain variables must be estimated, by turning an optimal dispatch problem (search for a set of real values) into a parameters identification problem.

@&#CONCLUSIONS@&#
