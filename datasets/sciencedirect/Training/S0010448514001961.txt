@&#MAIN-TITLE@&#
Solving the pentahedron problem

@&#HIGHLIGHTS@&#
Reduction of the pentahedron problem to a well-constrained system of 3 equations in 3 unknowns.A considerable performance enhancement (×42) over classical formulation.Existence of 3D parallel solutions for generic 3D pentahedron problems is shown.Interesting properties of the solution set are studied.Discussion of how the pentahedron interesting properties generalize for other polyhedra.

@&#KEYPHRASES@&#
Geometric constraint solving problems,Pentahedron,Geometric modeling with constraints,Interval solver,Desargues’ theorem,Al-Kashi theorem,

@&#ABSTRACT@&#
Nowadays, all geometric modelers provide some tools for specifying geometric constraints. The 3D pentahedron problem is an example of a 3D Geometric Constraint Solving Problem (GCSP), composed of six vertices, nine edges, five faces (two triangles and three quadrilaterals), and defined by the lengths of its edges and the planarity of its quadrilateral faces. This problem seems to be the simplest non-trivial problem, as the methods used to solve the Stewart platform or octahedron problem fail to solve it. The naive algebraic formulation of the pentahedron yields an under-constrained system of twelve equations in eighteen unknowns. Even if the use of placement rules transforms the pentahedron into a well-constrained problem of twelve equations in twelve unknowns, the resulting system is still hard to solve for interval solvers. In this work, we focus on solving the pentahedron problem in a more efficient and robust way, by reducing it to a well-constrained system of three equations in three unknowns, which can be solved by any interval solver, avoiding by the way the use of placement rules since the new formulation is already well-constrained. Several experiments showing a considerable performance enhancement (×42) are reported in this paper to consolidate our theoretical findings. Throughout this paper, we also emphasize some interesting properties of the solution set, by showing that for a generic set of parameters, solutions in the form of 3D parallel edge pentahedra do exist almost all the time, and by providing a geometric construction for these solutions. The pentahedron problem also admits degenerate 2D solutions in finite number. This work also studies how these interesting properties generalize for other polyhedra.

@&#INTRODUCTION@&#
Geometric Constraint Solving Problems (GCSPs) have retained much of the researchers attention since several decades  [1–7]. This attention may be justified by the advances in computing systems, in terms of both hardware capabilities and software facilities, which translated into a growing need for new CAD/CAM techniques and opened new perspectives for the implementation of researchers ideas. Although there exist a large number of GCSP-related works, expressing and solving geometric constraint systems is still an active research topic and much more effort has to be done in this direction.This paper considers a particular GCSP problem: the 3D pentahedron. A pentahedron is a polyhedron in 3D, not necessarily convex, consisting of five faces (Fig. 1). Two faces are triangles, while the remaining three faces are planar quadrilaterals. The lengths of the nine edges are given in the problem formulation. Thus, the problem has twelve constraints: nine lengths of the nine edges, plus three coplanarity conditions of the three quadrilateral faces. Under mild assumptions, this problem is well-constrained modulo an isometry (rigid body motion and symmetry). The pentahedron may be concave and self-intersecting. As an example, two of its triangular faces may intersect each other (Fig. 1).Why is the pentahedron problem so interesting? First, its statement is simple, but its resolution is difficult. We cannot solve it with computer algebra, even when the distance parameters are instantiated with numeric values. We cannot solve it with Cayley–Menger determinants or their generalizations  [8–10], though the pentahedron problem seems very close to the octahedron problem (also named the Stewart platform) as both polyhedra have six vertices, and Cayley–Menger determinants give an elegant solution to the octahedron problem.The pentahedron problem is even unsolvable with the reparameterization method proposed by Gao et al.  [11] to solve many 3D simple problems similar to the pentahedron problem. In their work, Gao et al. detected or introduced one key unknownu(an angle or a length) and expressed all the other unknowns of the problem as a function ofu. By construction, all the constraints of the problem, except one constraint called the ignored constraint, are satisfied. Therefore, it remains to only vary the key unknownu, i.e., to plot or sample a curve parameterized byu, and to detect when the ignored constraint is satisfied. Unfortunately, despite the apparent simplicity of the pentahedron, two key unknowns are needed to solve this problem.The first reason behind our focus on the study of the pentahedron problem in this paper is that the latter has not yet been solved. To the best of our knowledge, no work in the literature has focused on this problem, though a recent Ph.D. thesis made an allusion to it  [12]. The main contribution of our paper is the first method of resolution of the pentahedron which exploits a geometric property of the 3D pentahedron. This permits to drastically reduce the number of unknowns and equations of the problem. At the end, we obtain a system of only three equations in three unknowns, that is much smaller than the naive version of twelve equations in twelve unknowns, and which is easily solvable with either a wide range of interval solvers, or with homotopic solvers. Our experiments showed that the interval analysis library ALIAS-C++  [13] achieved a performance gain of×42for the reduced pentahedron formulation, compared to the naive one.A second reason making the pentahedron problem very interesting is the structure of its solutions, which is unexpectedly rich. Up to an isometry, this problem admits three finite sets of solutions: (1) a first set of 3D generic solutions, (2) a finite set of 3D special solutions where three edges are parallel, and (3) a set of 2D solutions.A third reason motivating our work is the opportunity given by this problem for studying some interesting issues on a simple but non-trivial problem. We only mention the following important issue: what are the rigidity or the flexibility conditions for the pentahedron problem? This issue is essential in many domains such as robotics and constitutes a challenge for computer algebra. Remember that the pentahedron, or any constrained object, is flexible when it can be continuously deformed, while fulfilling at the same time all the problem constraints during its deformation. For instance, it can be easily seen that when the two triangular faces of the pentahedron have equal lengthsa,b, andc, and the three edges linking these two faces have the same lengthh, i.e., the three quadrilateral faces are parallelepipeds, then the pentahedron is flexible. More precisely, it has three degrees of freedom. For all possible directions of a 3D line, there exists a pentahedron solution, such that the equal-length edges of this pentahedron are oriented the same as that 3D line. It is easy to compute the degree of flexibility of a given pentahedron by simply computing the rank and co-rank of its Jacobian. However, computing the general algebraic conditions for flexibility or rigidity is a hard problem.The rest of this paper is structured as follows: Section  2 describes the classical formulation of the pentahedron problem, which results in a system of twelve equations in twelve unknowns. Section  3 presents our new and reduced formulation of the pentahedron problem that yields a systems of three equations in three unknowns, and compares the performance of the interval solver ALIAS-C++ on the two formulations. In Section  4, we show that for a generic set of length parameters, the corresponding pentahedron problem admits almost all the time solutions in the form of 3D pentahedra with parallel edges, and we provide a geometric construction for them. In Section  5, we consider planar solutions to the pentahedron problem. In Section  6, we discuss the degenerate case of 3D simple pentahedra and provide a solution for this configuration. Finally, in Section  7, we study how the interesting properties of the pentahedron problem and the proposed resolution method can extend or not to other simple polyhedra.A GCSP is composed of a set of geometric objects, whose placement must fulfill a set of geometric constraints. The 3D pentahedron problem is composed of six points:A,B,C,D,E,F. Triples of pointsABCandDEFconstitute the vertices of the two triangular faces of the pentahedron, while the remaining three quadrilateral faces denoted asF1,F2, andF3have respective verticesABED,BCFE,CADF. See Fig. 2(a).In the literature, the pentahedron is defined, modulo an isometry, by twelve constraints: nine distances between all the pairs of adjacent pointsdAB,dBC,dCA,dDE,dEF,dFD,dAD,dBE, anddCF, and three coplanarities of the quadrilateral facescopl(ABED),copl(BCFE), andcopl(CADF). For generic values of the nine distance parametersdAB,…,dCF, there exist a finite number of pentahedra solution of the problem.In the Euclidean three-dimensional spaceE3, if we putA=(xA,yA,zA),B=(xB,yB,zB), etc., then the twelve constraints of the pentahedron problem result in an algebraically under-constrained system of twelve equations (constraints) in eighteen unknowns (coordinates of the six vertices). To fix the position and orientation of the pentahedron in the 3D space, we adopt the usual three points placement rule illustrated in Fig. 2(b), which fixes the coordinates of the three pointsABC. PointA=(0,0,0)is placed at the coordinates origin, pointB=(xB,0,0)is placed at the positivex-axis at a distancedABfromA, and pointC=(xC,yC,0)is placed in thexy-plane with positiveycoordinate (yC>0), at respective distancesdACfromAanddBCfrom pointB, thus implying thatxA=yA=zA=yB=zB=zC=0. These unknowns have to be replaced by their fixed values in the following under-constrained algebraic system of the pentahedron:(1){C1:(A−B)⋅(A−B)−dAB2=0C2:(B−C)⋅(B−C)−dBC2=0C3:(C−A)⋅(C−A)−dCA2=0C4:(D−E)⋅(D−E)−dDE2=0C5:(E−F)⋅(E−F)−dEF2=0C6:(F−D)⋅(F−D)−dFD2=0C7:(A−D)⋅(A−D)−dAD2=0C8:(B−E)⋅(B−E)−dBE2=0C9:(C−F)⋅(C−F)−dCF2=0C10:copl(ABED)=|A,B,E,D|=0C11:copl(BCFE)=|B,C,F,E|=0C12:copl(CADF)=|C,A,D,F|=0where the coplanarity constraint of four pointsABEDis expressed by the following null determinant, which translates into a null volume of the tetrahedron whose vertices correspond to the four points:(2)|A,B,E,D|=|xAyAzA1xByBzB1xEyEzE1xDyDzD1|=0.The algebraic system obtained after employing the three points placement rule, i.e., after substituting the coordinates of pointsABCby their fixed values in Eq. (1), is well-constrained and has a finite number of solutions, under mild assumptions. Though correct, the well-constrained system derived from Eq. (1) is awkward. First, it is too big to be solved with interval solvers. It does not exploit geometric properties of the pentahedron. Also, it may have spurious roots, where all the pentahedron vertices are coplanar. Indeed, let us consider this problem in 2D (planar pentahedron). For this configuration, the three planarity constraints disappear and only nine 2D point to point distance constraints remain. It turns out that this system is well-constrained, as it is well known from rigidity theory (Appendix C) and Laman’s theorem (Appendix B) thatn2D vertices are well-constrained if they are governed byc=2n−3distances  [14], and no sub-system is over-constrained (e.g., no four vertices are involved in more than five constraints). In our case,n=6andc=2n−3=9. In consequence, this 2D problem is well-constrained, so spurious roots are of finite number. To get rid of such spurious system roots and also to considerably reduce the system complexity, we propose in the next section a new formulation of the pentahedron problem.One main observation about the well-constrained pentahedron system of twelve unknowns given by the classical formulation is that it misses an essential property, which is specific to non-degenerate solutions. This property consists in the fact that the three supporting lines of the pentahedron edgesAD,BE, andFGmust be either concurrent or parallel. Indeed, the supporting planesP1,P2, andP3of the respective three quadrilateral facesF1,F2, andF3meet at a common point namedI, which may be located at infinity if the three intersection lines of these supporting planes are parallel. Clearly, these intersection linesL1=P2∩P3,L2=P3∩P1, andL3=P1∩P2pass through pointI=P1∩P2∩P3(Fig. 3(a)). Note that this concurrence property still holds for pentahedra projections on a 2D plane, i.e., for 2D drawings of a 3D pentahedron. The concurrence property is known as Desargues’ theorem  [15,16] and discussed in Appendix D of this paper.The aforementioned property of linesL1,L2, andL3inspires our new formulation, and suggests another way of expressing the constraints of the pentahedron problem. Let us suppose that linesL1,L2, andL3are concurrent in pointI. The “theorem of Al-Kashi”, also known as the “law of cosines”, states that given a triangle (A,B,C) inE2, if we denote byα,β, andγthe angles corresponding to its respective verticesA,B, andC, and bya,b, andcthe lengths of the sides respectively opposite to these angles (cf. Fig. 3(b)), then the length of any side of the triangle, saya, can be given in terms of the lengths of the two other triangle sides and the cosine of the opposite angle as follows:2bccosα=b2+c2−a2.The theorem of Al-Kashi generalizes the Pythagorean theorem for non-right triangles. Let us consider the quadrilateral faceF1=ABEDof the pentahedron. By applying the Al-Kashi theorem in its supporting planeP1on triangleIDEand on triangleIAB, cf. Fig. 3(c), we obtain:2XDXEcosα1=XD2+XE2−dDE2and:2(XD+dAD)(XE+dBE)cosα1=(XD+dAD)2+(XE+dBE)2−dAB2,whereXDdenotes the unknown distanceID,XEdenotes the unknown distanceIE, andXFrefers to the unknown distanceIF. Note thatα1=AIB̂=DIB̂.Substitutingcosα1from one of the above equations into the other and performing a circular permutation onABCandDEFresults in a well-constrained system of three equations in three unknownsXD,XE, andXFdescribed by Eq. (3) of Fig. 4. This new algebraic system is much smaller than the classical one of Eq. (1). Moreover, the new system has no spurious root. Another advantage of our formulation consists in the avoidance of placement rules which are necessary in the original formulation to make the system well-constrained.Finally, the solutions of the original system can be easily derived from the solutionsXD,XE,XFof the new formulation by following these steps:(i)Compute the coordinates of pointsABCaccording to the aforementioned three points placement rule:A=(0,0,0)B=(dAB,0,0)xC=(dAC2−dBC2+dAB2)/(2dAB)yC=dAC2−xC2,zC=0.Deduce the coordinates(xI,yI,zI)of concurrence pointI, by considering the already known coordinates of pointsABCand the already known lengths of all the edges of tetrahedronABCI. Remember thatAI=AD+XD,BI=BE+XE, andCI=CF+XF.Finally, compute the unknown coordinates of pointsDEFas follows:D=A+dADAI⃗/‖AI⃗‖E=B+dBEBI⃗/‖BI⃗‖F=C+dCFCI⃗/‖CI⃗‖.Regarding the new algebraic system of Eq. (3), we could not find a closed form solution, but this is not critical as this system can be efficiently solved by interval solvers.For simplicity, we only considered the convex pentahedron case, where its points are ordered asIDA,IEB, andIFC. It turns out that negative roots forXD,XE,XFare solutions for the convex pentahedron where its points are ordered in the opposite orderIAD,IBE, andICF. The algebraic formulations for concave pentahedra may be easily obtained in the same way.

@&#CONCLUSIONS@&#
