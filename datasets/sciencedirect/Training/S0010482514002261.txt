@&#MAIN-TITLE@&#
Evaluation of robust wave image processing methods for magnetic resonance elastography

@&#HIGHLIGHTS@&#
Addressing wave image processing and enhancement in MRE.Investigating various solutions for phase unwrapping, directional filtering and noise suppression.Carrying out both quantitative and qualitative experiments for performance evaluation and comparison.

@&#KEYPHRASES@&#
Directional filtering,Magnetic resonance elastography,Noise suppression,Phase unwrapping,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
There is a long tradition of soft tissue palpation in clinic for health evaluation and disease diagnosis. Manual palpation is not only limited to surface organs such as throat, breast and prostate for cancer screening, but also of major importance when diagnosing possible infection of liver and spleen [1]. Other than functional diagnosis [2], elasticity is essential for many emerging biomedical applications. For example, tactile sensation is important during surgical operation but it is difficult for medical robotics [3]. However, the outcomes of anatomical imaging, including ultrasound, computed tomography (CT) and magnetic resonance imaging (MRI), do not have explicit connections with soft tissue elasticity, in particular at the early stage of physiological alterations [4]. It is thus attractive to develop novel modalities to measure and visualize soft tissue elasticity quantitatively. This information is contributive to health evaluation, disease diagnosis, and medical robotics as well. Magnetic resonance elastography (MRE) is a promising technology in this regard [5].For noninvasive palpation, MRE employs low-frequency mechanical waves as a virtual probe. Once being imported into soft objects, mechanical waves propagate with various complicated phenomena of refraction and diffraction. The pattern of wave propagation varies according to local biomechanical properties. With specially-programmed pulse sequences, MRI is able to capture varying wave patterns, from which it is possible to reconstruct or estimate soft tissue elasticity. In other words, MRE involves not only wave image reconstruction but also elasticity estimation. The first part is indispensable in most phase-contrast imaging, but the latter one is a challenging inverse problem of wave equation [6,7].There have been several very good reviews on MRE [8–11], including those from the perspectives of method, technique and applications, respectively. Nevertheless, there is a lack of inspective study on wave image processing for MRE. Here we firstly introduce some popular techniques for MRE wave imaging, and then concentrate on the solutions for MRE wave image processing and analysis. The remainder of this paper is organized as follows. The second section briefs how wave images come into being in MRE and why they are prone to noise and artifacts. The third one describes some useful techniques for wave image enhancement, and how they assist elasticity reconstruction is explained with examples in the fourth section. Concluding remarks are drawn in the last section.MRE is designed to quantify soft tissue elasticity by noninvasive imaging techniques. It usually comprises an actuator for motion excitation, a specially-programmed magnetic resonance modality for motion imaging, and the software for elasticity interpretation [12]. There are two kinds of distinct MRE paradigms, one is static and the other one is dynamic. The static or quasi-static solutions track the tissues before and after deformation by using displacement-encoding or tagging pulse sequences [13]. They have widespread applications in evaluating myocardial stain. Note that both tagging and displacement-encoding pulse sequences are sensitive to large deformation only. Nevertheless, most soft tissues are nearly incompressible; hence substantial deformation is not easy. In addition, it is difficult to derive out quantitative strain maps because there is no information of force distribution [14].Both imaging pulse sequences of static and dynamic MRE paradigms make use of the Stejskal–Tanner bipolar gradient pairs (BGPs) that are commonly found in phase contrast imaging. The Stejskal–Tanner BGPs are a group of balanced preparatory dephasing and rephasing gradients. If the tissues of interest are stationary in the encoding direction, there would be no accumulated difference in phase. In contrast, if the tissues are moving or vibrating, the resultant phase difference might encode such motion information. However, BGP has to be synchronized with external vibration in dynamic solutions [8–10]. The subsequent discussion is then limited to dynamic MRE, where the patterns of wave propagation in different soft tissues are imaged and quantitative elasticity is derivable.Mechanical wave propagation is refractory and difficult to control [15]. In heterogeneous viscoelastic soft tissues, propagation has to confront attenuation, reflection and refraction [16]. MRE encodes wave propagation into phase; hence imaging parameters including BGP duration and strength have to be appropriate [17]. As shown inFig. 1(a) through (d), if too small, signals would be too weak; if too big, they are prone to being wrapped. Also, in MRE wave images, there are other noise and outliers from wave interference [18], electromagnetic turbulence [19] or chemical phase shifts.One of the biggest challenges in MRE wave imaging lies in low signal-to-noise ratio (SNR). There has been an intrinsic mechanism since the beginning [5], namely, employing multiple synchronized BGPs to amplify weak elastic vibrations inside heterogeneous soft tissues. As shown in Fig. 1(e) through (h), SNR usually increases with more pairs of Stejskal–Tanner gradients. Nevertheless, the pairs of BGPs are limited to other imaging parameters including repetition time (TR) and echo time (TE). In particular, the more pairs of Stejskal–Tanner gradients, the more demanding to MRI hardware. As a consequence, a scanning with multiple BGPs is often subjected to field inhomogeneity, electromagnetic noise and phase wrapping. In other words, it might be more effective to enhance tissue motion directly. Usually, low-frequency shear waves penetrate deeper into soft tissues, while high-frequency shear waves have higher spatial resolution. Then, there is another dilemma between penetration and resolution [20]. It is yet an open issue on efficiently delivering shear waves to a specific region of interest (ROI) [19].Imaging speed is another big issue in MRE that involves multiple steps of phase delay for wave field reconstruction. In some cases, it has to capture the information of wave propagation in all three directions. Therefore, for a dedicated low-field MRE system [21], it is not surprising to take about 80min for wave imaging. Although MRE is theoretically insensitive to unsynchronized motion, it inevitably results in low SNR [22] and, in particular, is not reasonable to keep objects static for such a long time. It is thus attractive to speed up MRE wave imaging. Ultrafast pulse sequences including [17] and [23] are helpful, but their outcomes often suffer from low SNR. Murphy et al. [32] found that, for relatively low spatial frequency content and low amplitude of the shear waves in the brain, it is possible to significantly reduce acquisition time by subsampling k-space while maintaining a mean error of elasticity reconstruction less than 10%.After obtaining a series of wave images with different phase delays {θ|θ1, θ2,…,θn}, harmonic analysis is employed to extract the complex-number wave field Φ, with which the elasticity distribution of soft tissues that support mechanical wave propagation can be numerically estimated. Nevertheless, acquiring perfect wave images with sufficiently good SNR is not easy in practice [6], [24]. It might be due to imaging noise, wave interference and/or inappropriate modeling. They are either inherent to MRE (e.g., phase wrapping and wave interference) or extrinsic due to accessory components (e.g., motion instability and electromagnetic artifacts). Before MRE elasticity reconstruction, preprocessing is necessary because noise and artifacts are misleading. The methods of phase unwrapping, directional filtering and noise suppression have been implemented and evaluated for wave image enhancement.Phase wrapping is a commonly encountered problem in MRI. Any signal in an MRI phase image is rounded within the interval [−π, π] or [0, 2π], namely(1)φ=(ϕ+ε)mod(2π).Here Φ is the unknown true phase, ε phase error, and φ denotes the phase measured by MRI. The objective of phase unwrapping is to recover Φ by adding to (or subtracting from) φ a multiple times of 2π. In other words, phase unwrapping is mathematically straightforward via(2)φΩ=ϕΩ+ηΩ(2π),where the subscript Ω denotes the domain of phase image, and ηΩ is an integer array assigning the unwrapping constant in each pixel.The so-called Itoh condition assumes that the absolute phase difference between neighboring pixels should be less than π[25]. It is not technically difficult to find out ηΩ if a phase image is sufficiently smooth. As a matter of fact, there have been some intrinsic mechanisms including susceptibility weighted imaging [26] for phase unwrapping in most commercial modalities. However, there are always noise and artifacts in MRE wave images, which makes phase unwrapping an ill-posed problem. The following experiments will show that phase unwrapping is often not as straightforward as expected.The methods of quality guidance, discontinuity minimization and graph cuts have been proposed to tackle the issues of noise and artifacts in phase unwrapping [25]. We implemented and evaluated the algorithms of phase unwrapping via max-flow/min-cut (PUMA) [27] and Goldstein׳s branch cut (GBC) other than the classical Itoh one. PUMA provides a framework of energy minimization and pursues the optimization by a series of max-flow/min-cut calculations. It is functional with or without quality guidance. However, the latter is indispensable for GBC. Similarly, the performance of Itoh algorithms relies on the choice of seed phase substantially.Wave interference is another refractory problem in MRE. Wave reflection and refraction happen between heterogeneous tissues and also in the peripheral boundaries. Both reflection and refraction interfere in wave propagation, and thus confuse the subsequent algorithms for elasticity reconstruction. Moreover, the interference between forward and backward waves would counteract tissue displacement, and thus result in low SNR. There have been different algorithms proposed for wave inversion and elasticity reconstruction. Most algorithms do not take boundary conditions into account in that no boundary information could be imaged [8], [28]. As a consequence, they cannot deal with wave reflection and refraction well [18].In mathematics, the wave with a specific frequency corresponds to two peaks in the Fourier domain: one at ω(kx,ky) and the other one at ω(−kx,−ky) in the opposite half-space. The waves traveling in the opposite directions are represented as these symmetric peaks in the Fourier domain. It is thus possible to design a directional spatiotemporal filter to separate them, and then interpret them one by one. The lognormal Gabor filters have been proposed for wave interference suppression in [18]. As shown inFig. 2(a), the lognormal Gabor filters, defined in the log-polar coordinate of the Fourier domain, are spatiotemporally directional.In order to suppress the aforementioned interfering artifacts, a wave image first undergoes band-pass filtering in Fig. 2(b) that cuts off both ultralow- and ultrahigh-frequency components. In general, high-frequency components come from random noise only, while ultralow-frequency ones are possibly due to longitudinal waves and bulk motion. It is then selected by a cos2-dependent directional spatiotemporal filter. For example, the filter in Fig. 2(c) may separate the wave components traveling from bottom to top. Another important property of such spatiotemporal filters is that they can be recombined into the original band-pass filter. However, as shown in Fig. 2(d), there is substantial difference between the reconstructed filter and the original band-pass one. In other words, this is not a lossless filter, whose effect would be validated in the following experiments. It is thus attractive to introduce more advanced directional spatiotemporal filters [29] for wave interference suppression.Other than phase wrapping and wave interference, there is contamination due to noise and outliers. Most algorithms of MRE elasticity reconstruction including algebraic inversion of differential equation (AIDE) and local frequency estimation (LFE) have intrinsic mechanisms of noise suppression. For example, the algorithm AIDE is established on the point-by-point inversion of complex-number Laplacian(3)μΩ=−ρ(2πfm)2uΩ∇2uΩ,where μ denotes shear modulus, ρ tissue density, fm vibration frequency and u the first harmonic displacement. The Laplacian operator is sensitive to noise, but AIDE does not directly calculate this high-order differential. Instead, it approximates Laplacian by using a Savitzky–Golay filter or a matched filter. The algorithm LFE employs a series of lognormal Gabor filters to estimate local wavelengths λs, and relates to shear moduli via(4)μ=(λsfm)2.The lognormal Gabor filters may accomplish noise suppression similar to wavelet thresholding. In other words, most MRE algorithms are robust to modest white noise.However, noise suppression in MRE is not as straightforward as expected. Conventional Gaussian or wavelet smoothing filters assume that noise amounts to trivial high-frequency components, which could be reduced or simply removed. They often destroy important features, such as edge, texture and fine structures, while reducing noise and outliers. Denoising by anisotropic diffusion or total variation aims at balanced structure preservation and noise suppression [30]. Here images are supposed to have a simple geometric description, namely, a set of connected smooth objects with jumping interfaces.All of them nonetheless do not characterize MRE contamination well. On one hand, noise in MRE is subjected to speckle or Rician distributions. On the other hand, MRE images contain complicated information of wave propagation that is eventually confusing with noise. In other words, MRE noise and outliers mix with varying wave propagation, which makes it challenging for locally adaptive techniques including anisotropic diffusion and wavelet thresholding. Here the NL-means algorithm [31] is introduced to denoise MRE wave images. Its performance is evaluated against that of three popular mechanisms of noise suppression, namely Gaussian smoothing, wavelet filtering and anisotropic diffusion.

@&#CONCLUSIONS@&#
