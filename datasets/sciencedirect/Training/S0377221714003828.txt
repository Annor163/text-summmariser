@&#MAIN-TITLE@&#
A priori orienteering with time windows and stochastic wait times at customers

@&#HIGHLIGHTS@&#
We consider stochastic wait times resulting from queues of competing salespeople.The customer-specific recourse action is a novel addition to routing models.We derive an analytical formula for the expected reward from an a priori tour.We show the value of incorporating stochastic information into the routing model.

@&#KEYPHRASES@&#
Orienteering,Stochastic wait times,Time window,Pharmaceutical sales,Recourse actions,

@&#ABSTRACT@&#
In the pharmaceutical industry, sales representatives visit doctors to inform them of their products and encourage them to become an active prescriber. On a daily basis, pharmaceutical sales representatives must decide which doctors to visit and the order to visit them. This situation motivates a problem we more generally refer to as a stochastic orienteering problem with time windows (SOPTW), in which a time window is associated with each customer and an uncertain wait time at a customer results from a queue of competing sales representatives. We develop a priori routes with the objective of maximizing expected sales. We operationalize the sales representative’s execution of the a priori route with relevant recourse actions and derive an analytical formula to compute the expected sales from an a priori tour. We tailor a variable neighborhood search heuristic to solve the problem. We demonstrate the value of modeling uncertainty by comparing the solutions to our model to solutions of a deterministic version using expected values of the associated random variables. We also compute an empirical upper bound on our solutions by solving deterministic instances corresponding to perfect information.

@&#INTRODUCTION@&#
The pharmaceutical sales force has experienced a sizable reduction in recent years that is likely to continue. By the end of 2011, the number of pharmaceutical sales jobs in the US dropped to 72,000 from its peak of 105,000 in 2006 (Rockoff, 2012). In 2012, Britain’s second largest drugmaker, AstraZeneca, is cutting 1150 sales representatives in its US organizations, which is 24% of its sales force in the US (Arnold, 2012). Pharmaceutical companies have tried to compensate for the reduced sales force through the use of digital tools like websites and smartphone apps that allow doctors to directly query the company. However, sales representatives are not totally replaceable as they provide the means to develop relationships with customers that may otherwise go unreached. Dealing with a reduced number of sales representatives, pharmaceutical companies face the challenge of better managing their reduced sales forces to maximize their benefit to the company.On a daily basis, pharmaceutical sales representatives must determine a daily schedule specifying which doctors to visit and the order to visit them in order to maximize potential sales. In general, a doctor’s accessibility to a sales representative is limited. Typically, the doctor specifies a time window during which she will meet representatives in between other work obligations (seeing patients, paperwork, etc.). We assume that the doctor meets with the representatives following a first-come-first-served protocol within the time window. To talk with a doctor, a representative must arrive at the doctor’s office before the closure of the doctor’s time window. However, after arriving, the representative may have to wait while the doctor attends to work obligations or meets with another representative. The time that doctors spend in with other work obligations is uncertain, while the duration of a meeting between a doctor and a representative is typically limited. In fact, representatives develop well-rehearsed sales pitches that fit within their brief time allocation. Thus, we assume that the meeting duration is known and constant while the time that a representative spends waiting to meet with a doctor is uncertain. This daily decision-making problem faced by pharmaceutical sales representatives is shared by other industries such as the textbook industry. Therefore, we more generally refer to this problem as a stochastic orienteering problem with time windows (SOPTW), in which a time window is associated with each customer and a uncertain wait time occurs at each customer.We model the wait time faced by the representative as a random variable dependent on the arrival time and the queue length (of other representatives) upon arrival. In turn, we model queue length as a random variable dependent on the arrival time at the doctor’s office. We associate a deterministic economic value with each doctor representing the expected sales to the doctor if the representative meets with the doctor that day. In this paper, our objective is to construct an a priori route for the representative that maximizes the expected value collected on a given day. An a priori route is a pre-planned order of visits to customers (see Campbell & Thomas (2008) for an overview). That is, we seek to construct a static sequence of customers (doctors) that maximizes the expected value collected. A priori tours are usually used as subproblems in dynamic solution approaches (see Goodson, Ohlmann, & Thomas, 2013).During the execution of an a priori route, after a random event is realized, a corrective action, often called a recourse action, may be required. In our treatment of the SOPTW, we consider two types of recourse actions, both of which preserve the route’s ordering of the visited customers. The first recourse action is motivated by the observation that a representative should skip a customer specified by an a priori route if she will not arrive within the customer’s time window. With the assumption of deterministic travel times, the representative can determine whether or not she can arrive at the next customer on the route within the respective time window given the departure time from the current customer. That is, the next customer visited by the representative will be the first customer in the remaining sequence of customers that can be visited within the time window. In Section 3, we generalize this recourse action to allow skipping if a representative will not arrive by any specified time.The second recourse action operationalizes the notions of balking and reneging from queueing theory. The basic premise is that the representative may leave the queue immediately after arriving at a customer if observing a sufficiently long queue (balking) or she may leave after waiting in queue for a period of time without meeting with the customer (reneging). We propose a decision rule that takes as input the observed queue length upon the representative’s arrival to a customer to determine the latest time she will wait there. We elaborate on this second recourse action in Section 3.This paper makes four primary contributions to the literature. First is the formulation of a routing model that explicitly accounts for the stochastic wait times resulting from queues of competing salespeople. Second, the customer-specific recourse action corresponding to the queueing notions of balking and reneging is a novel addition to routing models. We also derive an analytical formula to compute the expected reward from an a priori tour. Finally, our computational results demonstrate the value of incorporating stochastic information into the routing model for sales representatives.To position our contribution, we review related literature in Section 2. In Sections 3 and 4, we provide a formal model of the problem and derive a closed-form computation of the objective. We discuss our solution approach to the SOPTW in Section 5. In Section 6, we discuss the generation of input data, notably the data for the transient queueing, for our SOPTW instances. Section 7 presents a deterministic version of the SOPTW in which waiting time distributions are replaced with expected wait times, resulting in an elementary longest path problem solvable via an exact solution method. Section 8 provides a computational comparison and Section 9 concludes with a summary and discussion of future work.

@&#CONCLUSIONS@&#
