@&#MAIN-TITLE@&#
A biarc based subdivision scheme for space curve interpolation

@&#HIGHLIGHTS@&#
This article presents a biarc based interpolatory subdivision scheme.The scheme produces convexity preserving spatial limit curves in 3D.The limit curves are proved to beG1continuous, while numerical examples show that they are alsoG2smooth and fair.The scheme reproduces circular arcs and spherical curves with control data sampled on a circle and a sphere, respectively.

@&#KEYPHRASES@&#
Geometry driven subdivision,Nonlinear subdivision scheme,Space curve interpolation,3D biarc interpolation,Spherical curve,Convexity preserving,

@&#ABSTRACT@&#
This paper presents a biarc-based subdivision scheme for space curve interpolation. Given a sequence of space points, or a sequence of space points and tangent vectors, the scheme produces a smooth curve interpolating all input points by iteratively inserting new points and computing new tangent vectors. For each step of subdivision, the newly inserted point corresponding to an existing edge is a specified joint point of a biarc curve which interpolates the two end points and the tangents. A provisional tangent is also assigned to the newly inserted point. Each of the tangents for the following subdivision step is further updated as a linear blending of the provisional tangent and the tangent at the respective point of a circle passing through the local point and its two adjacent points. If adjacent four initial points and their initial reference tangent vectors are sampled from a spherical surface, the limit curve segment between the middle two initial points exactly lies on the same spherical surface. The biarc based subdivision scheme is proved to beG1continuous with a nice convexity preserving property. Numerical examples also show that the limit curves areG2continuous and fair. Several examples are given to demonstrate the excellent properties of the scheme.

@&#INTRODUCTION@&#
Designing a smooth interpolation curve from a given polygon by repeated subdivision is an important modeling method in Computer Aided Geometric Design. One of the classical subdivision schemes for curve interpolation is four point interpolatory subdivision (Dyn et al., 1987). It is simple to implement and is regarded as a significant curve subdivision scheme. Limit curves of four point interpolatory subdivision may however exhibit undesired artifacts and undulations (Marinov et al., 2005). To achieve the aim of shape preserving and artifact removing, some geometry driven schemes have emerged (Dyn et al., 1992; Marinov et al., 2005; Sabin and Dodgson, 2005; Yang, 2006; Deng and Wang, 2010; Deng and Ma, 2012). In this paper we generalize the incenter subdivision scheme (Deng and Wang, 2010) to a scheme for 3D curve interpolation with the properties of convexity preserving and artifacts removing.One subdivision step of the incenter subdivision scheme (Deng and Wang, 2010) consists of three main stages. Firstly, for each edge, we insert a new point which is the incenter of a triangle formed by the two end points of the edge and its end tangents, i.e., a special joint point of theG1biarc matching the two end points and tangents. Secondly, we select a provisional tangent for each point such that there exists aG1continuous circular arc spline interpolating the points and their provisional tangent vectors. If the tangents remain the same for the next level of subdivision, the limit curve would be the biarc spline curve which is aG1curve interpolating all initial points. Finally, to obtain aG2limit curve, we rotate the provisional tangent for each of the refined points according to the radii of two adjacent circular arc segments, i.e., all tangents are updated for the next level of subdivision. Note that this applies to the tangents at the points inherited from the previous step, as well as the new ones. If the old tangents were not modified, the scheme would be a Hermite one, probablyG1, but certainly notG2.To extend the incenter subdivision scheme to 3D, we need to compute newly inserted points (Stage I), their provisional tangents (Stage II), and updated tangents for the next level of subdivision (Stage III), all in 3D. The formulation of 2D biarc interpolation was extended to 3D in Sharrock (1987), Hoschek (1992). So the first and the second stages of the incenter subdivision scheme, i.e., the rule of adding new point as a special joint point of theG1biarc matching the two end points and tangents and the rule of defining a provisional tangent for each of the inserted points such that there exists aG1continuous circular arc spline interpolating the points and their provisional tangent vectors, can be easily generalized to the 3D case. The crux of the generalization thus lies in how to update tangents in 3D for the next level of subdivision since there is no trivial solution to rotate the tangents in 3D space which yields a well-behaved limit curve.Given three pointsp1,p2,p3sampled on aG2curvep(t)in 2D or 3D, whenp1andp3moving closer and closer top2, the discrete tangent atp2should be closer and closer to the tangent ofp(t)atp2and the radius of the arc segment interpolatingp1,p2,p3should also be closer and closer to the curvature radius ofp(t)atp2. Similarly, for a subdivision scheme generatingG2limit curves, the discrete curve formed by refined points should be smoother and smoother with the level of subdivisions higher and higher. At the same time, the discrete tangent and curvature at each refined point should also gradually converge to those of the limit curve. Inspired by these facts, we define each of the new tangents for the next level of subdivision as a linear blending of its provisional tangent and the tangent of the circle passing through the respective point and its two adjacent points. This method is much simpler than the rotation-based method used in the incenter subdivision scheme and numerical examples show that the limit curves produced by this method are also attractive. Furthermore, because 3D biarc curve lies on a spherical surface, the scheme can generate spherical curve segment if adjacent four initial points and their tangents are sampled from a spherical surface. Theoretical analysis shows that the proposed 3D biarc-based subdivision scheme is convexity preserving and the limit curve isG1continuous. Many numerical examples also show that the limit curves are fair curves withG2continuity.The rest of this paper is organized as follows. In Section 2, we briefly highlight the background knowledge of biarc interpolation. The proposed biarc based subdivision scheme is introduced in Section 3. The property of generating spherical curves by the proposed scheme is presented in Section 4. The convexity preserving property of the proposed scheme is proved in Section 5. Further smoothness analysis of the scheme is presented in Section 6. Section 7 provides some experimental examples to demonstrate the excellent properties of the scheme. Some concluding remarks can be found in Section 8.In this section, we briefly highlight the theory of interpolatingG1Hermite data using a biarc curve. Both planar case and spatial case are discussed. To be consistent with the rule of subdivision, we let a 2D or 3D biarc interpolate the local i-thG1Hermite data{pik,Tik;pi+1k,Ti+1k}, where k represents the level of subdivision,pik,pi+1kare two adjacent points, andTikandTi+1kare their unit tangent vectors, respectively. See Figs. 1 and 2for 2D and 3D cases, respectively.A biarc curve consists of two circular arc segments that interpolate two end points and the end tangents in aG1fashion. Planar biarcs appeared in the engineering design literature as early as the 1930s (Sandel, 1937). They were then studied in 1970s (Bézier, 1972; Bolton, 1975; Sabin, 1977) and research has continued in Piegl et al. (2009 and reference therein).Given the i-th localG1Hermite data{pik,Tik;pi+1k,Ti+1k}, letαikandβikbe the angles fromTiktopikpi+1kand frompikpi+1ktoTi+1k, respectively,p2i+1k+1be the joint point of the biarc andU2i+1k+1be the common unit tangent vector atp2i+1k+1, and θ be the angle fromTiktoU2i+1k+1, θ is then a free parameter which can be used to control the shape of the biarc (see Fig. 1).For the planar case, an angle is positive if it is counterclockwise and negative if it is clockwise. If slope anglesαikandβikhave the same sign, the biarc curve is C-shaped; otherwise the biarc curve is S-shaped. For the free parameter θ, it is suggested that for many cases,θ=αik(see Fig. 1(a)) for C-shape biarc curves andθ=12⋅(3αik−βik)(see Fig. 1(b)) for S-shape biarc curves are good selections (Sabin, 1977). In fact, for C-biarc curve withθ=αik, the joint pointp2i+1k+1is the incenter of the triangle formed bypikpi+1kandTik,Ti+1k(in the case that the radial linespikTikandTi+1kpi+1kintersect), the incenter subdivision scheme (Deng and Wang, 2010) is developed based on this fact.For the 3D case, we assume that vectorsTik,Ti+1k,pi+1k−pikare non-coplanar. 3D circular biarc curves are considered in Hoschek (1992), Sharrock (1987). They show that a 3D biarc curve, which interpolates3DG1Hermite data{pik,Tik;pi+1k,Ti+1k}, lies on a spherical surface whose center is the intersection of three planes. One plane passes through the midpoint ofpikpi+1kand is perpendicular topikpi+1k. The other two planes pass through the two end pointspik,pi+1kand are perpendicular to the two end tangentsTik,Ti+1k, respectively. It is easy to see thatLemma 2.1If theG1Hermite data{pik,Tik;pi+1k,Ti+1k}is sampled from a spherical surface, the resulting 3D biarc curve lies on this spherical surface.Remark 2.2If the givenG1Hermite data{pik,Tik;pi+1k,Ti+1k}is co-circular, the sphere is not uniquely defined. However, Lemma 2.1 also holds in this case.In this paper, we describe the 3D biarc interpolation ofG1Hermite data in a different way, in which we construct the relation between the 3D biarc interpolation and planar biarc interpolation.LetΠikbe the plane determined by linepikpi+1kand vectorTik−Ti+1kpositioned atpik, the projected vectors ofTik,Ti+1kto the planeΠikbeT¯ik,T¯i+1k, respectively (see Fig. 2). TheG1Hermite data{pik,T¯ik;pi+1k,T¯i+1k}are then on the planeΠikand can be matched by a biarc curve on the same plane. We denote the common tangent vector of the planar biarc asU2i+1k+1. The parameter θ of the joint point, denoted asp2i+1k+1, can be selected under two different cases, i.e.,θ=α¯ikfor a C-shape biarc curve andθ=3α¯ik−β¯ik2for S-shape biarc curves, whereα¯ik,β¯ikare angles fromT¯iktopikpi+1kand frompikpi+1ktoT¯i+1k, respectively. See Fig. 2 for illustrations.Based on the planar biarc curve matching{pik,T¯ik;pi+1k,T¯i+1k}, we can construct a 3D biarc curve matching{pik,Tik;pi+1k,Ti+1k}in the following way. Let us first assume that (see Fig. 2)•Iikbe the intersection of the radial linepikT¯ikand the straight linep2i+1k+1U2i+1k+1,Ii+1kbe the intersection of the radial linepi+1k+1(−T¯i+1k)and the straight linep2i+1k+1U2i+1k+1,qikbe a point on radial linepikTikwhose projection to planeΠikisIik, andqi+1kbe a point on the radial linepi+1k(−Ti+1k)whose projection to planeΠikisIi+1k.Given a sequence of points{pi0}with associated tangents{Ti0}, if any, we present the biarc-based subdivision scheme in 3D in this section. If the tangentTi0ofpi0is not given by users, we sampleTi0from the circle passing throughpi−10,pi0,pi+10as the tangent of the circle atpi0. Starting from{pi0,Ti0}, one level of subdivision is performed by respective rules to be introduced in 3.1 and 3.2 for inserting a new point corresponding to each edge and for assigning a provisional tangent vector to each newly inserted point, respectively. Before entering a new level of subdivision, all tangents are further updated following the rules discussed in 3.2.The sequence of points after each subdivision defines a control polygon which is refined in the following manner. After each refinement, points with even indices are inherited from the previous level and are renumbered asp2ik+1=pik. Newly inserted points are numbered with odd indices, such asp2i+1k+1betweenpikandpi+1k. Vertexp2i+1k+1is defined as a specified joint point of a biarc curve which matchesG1Hermite data{pik,Tik;pi+1k,Ti+1k}, as introduced in Section 2.LetTˆ2ik+1=TikandTˆ2i+1k+1=qi+1k−qik‖qi+1k−qik‖be the provisional tangents forp2ik+1andp2i+1k+1(see Fig. 2), respectively,{Φik+1}iis then aG1circular arc spline curve which interpolates{pik+1}iand matches{Tˆik+1}i, whereqik,Φik+1are defined in Subsection 2.2. If we letTik+1=Tˆik+1in the following subdivision step, the limit curve would be aG1circular arc spline curve{Φik+1}i.To obtain a curvature continuous subdivision curve, we define the new tangent vectorTik+1for pointpik+1as the linear blending of its provisional tangent vectorTˆik+1and the tangent of the circle passing throughpi−1k+1,pik+1andpi+1k+1as follows. LetCik+1be the circle passing throughpi−1k+1,pik+1andpi+1k+1, and the unit tangent vector ofCik+1atpik+1beT˘ik+1, the unit tangent vector ofpik+1is then defined as:(1)Tik+1=(1−ω)Tˆik+1+ωT˘ik+1‖(1−ω)Tˆik+1+ωT˘ik+1‖,where0<ω<0.5is a parameter used to adjust the shape of the limit curve (for more details, see Section 7).From the fact that a 3D biarc curve lies on a spherical surface, we prove that the biarc based subdivision scheme introduced in Section 3 reproduces a spherical curve with specified initial data.Theorem 4.1If{pj0,Tj0}(j=i−1,⋯,i+2)are sampled from a spherical surface S, the limit curve betweenpi0andpi+10is a spherical curve on S.ProofBecause{pj0,Tj0}(j=i−1,⋯,i+2)are sampled from a spherical surface S, according to the rule of adding new vertices introduced in Section 3.1 and Lemma 2.1,{pj1}(j=2i−2,⋯,2(i+2))lie on S andTˆj1⊥Opj1(j=2i−1,⋯,2(i+1)+1), where O is the center on S.Becausep2i−21,p2i−11,p2i1lie on surface S,T˘2i−11⊥Op2i−11, and followingT2i−11=(1−ω)Tˆ2i−11+ωT˘2i−1k‖(1−ω)Tˆ2i−11+ωT˘2i−1k‖,Tˆ2i−11⊥Op2i−11andT˘2i−11⊥Op2i−11, we haveT2i−11⊥Op2i−11. Similarly, we haveTj1⊥Opj1(j=2i,⋯,2(i+1)+1). This means that{pj1,Tj1}(j=2i−1,⋯,2(i+1)+1)are points and tangents of S.By induction,{pjk}lie on S, andTjk⊥Opjk(j=2ki−1,⋯,2k(i+1)+1). So the limit curve betweenpi0andpi+10is a spherical curve of S.  □Remark 4.2Planar curve reproductionBecause a plane can be seen as a spherical surface with infinite radius, if{pj0}(j=i−1,⋯,i+2)lie on a plane and{Tj0}(j=i−1,⋯,i+2)are parallel to this plane, the limit curve betweenpi0andpi+10is a planar curve segment.Also, because a circular arc segment can be seen as the intersection curve of a plane and a spherical surface, if{pj0,Tj0}(j=i−1,⋯,i+2)are sampled from this circular arc segment, the limit curve betweenpi0andpi+10lies on the intersection curve of the plane and the spherical surface, i.e., a circular arc segment Φ. So we haveCorollary 4.3Circular arc reproductionIf{pj0,Tj0}(j=i−1,⋯,i+2)are sampled from a circular arc Φ, the limit curve betweenpi0andpi+10is a circular arc segment of Φ.We also haveCorollary 4.4Piecewise circular arc and full circle reproductionIf{pj0,Tj0}(j=0,⋯,n+1)are sampled from a circle C, the limit curve betweenp10andpn0is a circular arc segment of C. In case of full sampling, an exact circle can be reproduced using the proposed subdivision scheme.Convexity preserving criteria of space curves have been suggested by Goodman and Ong (1997), Kaklis and Karavelas (1997) and Costantini and Pelosi (2001). Because the data processed in our biarc based subdivision scheme are points as well as their tangent vectors, different with other definitions of convexity, we define the convexity property of edges and points using points and their tangent vectors. We call{pik,Tik;pi+1k,Ti+1k}aG1Hermite edge and{pik,Tik}aG1Hermite point. We will define convexity property using bothG1Hermite edges andG1Hermite points.In the degenerate situation, i.e., there exists someG1Hermite edges whose edges and their tangents are collinear, we should modify the rule of adjusting tangents to achieve the aim of shape preserving. In such a case, to getG1limit curve, we select the midpoint of the edge as the new point and keep the end tangents fixed. To insert a line segment in the limit curve withG2continuity, we adopt the rules of Deng and Wang (2010) (Section 2.4). To make the text lighter, we assume that consecutive Hermite points do not go through the same straight line, and no part of the limit curve degenerates to a line segment.In the following, we first present the shape preserving property of the biarc subdivision scheme of the 2D case in Subsection 5.1, and then the 3D case in Subsection 5.2.In this subsection, we assume that all the initial points and tangents are coplanar.To prove the convexity preserving property of the biarc based subdivision scheme, we only need to prove that the number of inflections implied by data set{pik,Tik}i=0nis equal to that implied by data set{pik+1,Tik+1}i=02n. Inflection can be implied by aG1Hermite edge{pik,Tik;pi+1k,Ti+1k}or aG1Hermite point{pik,Tik}, so we count the number of inflections implied by data set{pik,Tik}i=0nas the sum of that implied by{pik,Tik;pi+1k,Ti+1k}i=0nand{pik,Tik}i=0n. For an inflectionG1Hermite point{pik,Tik}, its correspondingG1Hermite point{p2ik+1,T2ik+1}may be a convexG1Hermite point, so we consider the inflections implied byG1Hermite edges andG1Hermite points simultaneously.The process of the proof of convexity preserving property is as follows:•We first define the convex and inflectionG1Hermite edge (Definition 5.1) and convex and inflectionG1Hermite point (Definition 5.4).We then find the convexity preserving property between convex (inflection)G1Hermite edge (point) and the resulting biarc curve (Propositions 5.3 and 5.6).It is further proved that, after inserting the new points and defining the provisional tangent vectors, the convexity is preserved with the number of inflections being unchanged (Proposition 5.9).It is finally proved that, after adjusting the tangent vectors, the convexity is also preserved with the number of inflections being unchanged as well (Proposition 5.13).Finally the convexity preserving property (Theorem 5.14) can be derived based on the previous two conclusions.ForG1Hermite edge{pik,Tik;pi+1k,Ti+1k}, letαikbe the angle fromTiktopikpi+1kandβikbe the angle frompikpi+1ktoTi+1k, respectively. We define convex and inflectionG1Hermite edge as follows:Definition 5.1Convex and inflection Hermite edge classificationAG1Hermite edge{pik,Tik;pi+1k,Ti+1k}is defined as a convexG1Hermite edge ifαikβik>0(see Fig. 1(a)); aG1Hermite edge{pik,Tik;pi+1k,Ti+1k}is defined as an inflectionG1Hermite edge ifαikβik≤0(see Fig. 1(b)).Remark 5.2Ifαikβik=0, i.e., one of the angles ofαik,βikequals to 0, we define aG1Hermite edge{pik,Tik;pi+1k,Ti+1k}as an inflectionG1Hermite edge because it implies an S-shape biarc (seeG1Hermite edge{pik,Tik;pi+1k,Ti+1k}of Fig. 3for illustration).By the definition of C-shape and S-shape biarc (see Subsection 2.1), we haveProposition 5.3C-shape and S-shape biarc production from a Hermite edgeThe biarc matching a convexG1Hermite edge is a C-shape biarc curve (seeFig. 1(a)); the biarc matching an inflectionG1Hermite edge is an S-shape biarc curve (seeFigs. 1(b) and 3).We also define convexG1Hermite point and inflectionG1Hermite point as follows:Definition 5.4Convex and inflection Hermite point classificationAG1Hermite point{pik,Tik}is defined as a convexG1Hermite point ifαikβi−1k>0(seeG1Hermite point{pik,Tik}of Fig. 3 for illustration); aG1Hermite point{pik,Tik}is defined as an inflectionG1Hermite point ifαikβi−1k<0(seeG1Hermite point{pi+3k,Ti+3k}of Fig. 3 for illustration).Remark 5.5The case ofαikβi−1k=0(seeG1Hermite point{pik,Tik}of Fig. 4for illustration) will be further discussed in Lemma 5.12.There exists aG1biarc curve interpolating{pi−1k;pik,Tik;pi+1k}. One arc segment interpolates{pi−1k;pik,Tik}, the other segment interpolates{pik,Tik;pi+1k}, and they join atpikwith common tangentTik(seepikof Fig. 3 for illustration). Similar to Proposition 5.3, for the relations between biarc curve and the convexity ofG1Hermite point, we haveProposition 5.6C-shape and S-shape biarc production from a Hermite pointThe biarc matching convexG1Hermite point{pik,Tik}and its two adjacent pointspi−1k,pi+1kis a C-shape biarc curve (see convexG1Hermite point{pik,Tik}ofFig. 3for illustration); the biarc matching an inflectionG1Hermite point{pik,Tik}and its two adjacent pointspi−1k,pi+1kis an S-shape biarc curve (see inflectionG1Hermite point{pi+3k,Ti+3k}ofFig. 3for illustration).From Fig. 1 (note that in planar case,Tˆ2i+1k+1=U2i+1k+1) or Fig. 3, it is easy to see thatProposition 5.7Convexity preserving with edge inheritanceIf{pik,Tik;pi+1k,Ti+1k}is a convex (inflection)G1Hermite edge,(1)the newly inserted point with provisional tangent{p2i+1k+1,Tˆ2i+1k+1}is a convex (inflection)G1Hermite point; andeach of the new edges{p2ik+1,Tˆ2ik+1;p2i+1k+1,Tˆ2i+1k+1}and{p2i+1k+1,Tˆ2i+1k+1;p2i+2k+1,Tˆ2i+2k+1}will form a convexG1Hermite edge, respectively.Also from Fig. 1 or Fig. 3, we can see that no matter the biarc is C-shaped or S-shaped, the joint pointp2i+1k+1andpi+1klie on the same side of linepikTik; and the joint pointp2i+1k+1andpiklie on the same side of linepi+1kTi+1k, so we haveProposition 5.8Convexity preserving with point inheritanceIf{pik,Tik}is a convex (inflection)G1Hermite point,{p2ik+1,Tˆ2ik+1}is also a convex (inflection)G1Hermite point.We define the number of inflections implied by{pik,Tik}i=0nas the sum of the number of its inflectionG1Hermite edge and the number of its inflectionG1Hermite point. From Propositions 5.7 and 5.8 we have the following proposition immediately.Proposition 5.9Convexity preserving after subdivision with provisional tangentsFor the biarc based subdivision scheme defined by Section3, the number of inflections implied by{pik+1,Tˆik+1}i=02nis equal to that implied by{pik,Tik}i=0n.Now we have proved that after inserting the new points and defining the provisional tangent vectors, the number of inflections is not changed. In the following we focus on the issue that after computing the new tangent vectors the number of inflections is also not changed. To this aim, we first present three Lemmas for the signs of angles of inflectionG1Hermite point corresponding to the inflectionG1Hermite edge (Lemma 5.10), for the signs of angles of convexG1Hermite points inherited from convexG1Hermite points (Lemma 5.11) for the case ofαikβi−1k=0(Lemma 5.12), respectively.Lemma 5.10Convexity preserving with inflection edge-point inheritanceIf{pik,Tik;pi+1k,Ti+1k}is an inflectionG1Hermite edge, then{p2i+1k+1,T2i+1k+1}is an inflectionG1Hermite point, and the signs ofα2i+1k+1,β2ik+1are the same as those ofαˆ2i+1k+1,βˆ2ik+1, respectively.ProofFor an inflectionG1Hermite edge{pik,Tik;pi+1k,Ti+1k}, its corresponding newG1Hermite point{p2i+1k+1,Tˆ2i+1k+1}is an inflectionG1Hermite point (see inflectionG1Hermite edge{pi+1k,Ti+1k;pi+2k,Ti+2k}of Fig. 3 for illustration). Without loss of generality, we can assumeαik<0,βik>0and|αik|>βik. Then∠Tˆ2i+1kp2i+1kpi+1k=∠p2i+1k+1pi+1kIi+1k=∠pikpi+1kIi+1k+∠p2i+1k+1pi+1kpik=βik+∠p2i+1k+1pi+1kpik>∠p2i+1k+1pi+1kpik=∠pi+1kp2i+1k+1T˘2i+1k+1.Then by Eq. (1),T2i+1k+1=(1−ω)Tˆ2i+1k+1+ωT˘2i+1k+1‖(1−ω)Tˆ2i+1k+1+ωT˘2i+1k+1‖,andω<0.5we haveT2i+1k+1lies betweenpi+1k−p2i+1k+1andTˆ2i+1k+1. Thus we know that the signs ofα2i+1k+1,β2ik+1are the same as those ofαˆ2i+1k+1,βˆ2ik+1.  □For convexG1Hermite point{pik,Tˆik}, a similar conclusion holds:Lemma 5.11Convexity preserving with convex point-point inheritanceIf{pik+1,Tˆik+1}is a convexG1Hermite point withαˆik+1βˆi−1k+1>0,{pik+1,Tik+1}is also a convexG1Hermite point, and the signs ofαik+1,βi−1k+1are the same as those ofαˆik+1,βˆi−1k+1, respectively.ProofFrom the conditionαˆik+1βˆi−1k+1>0and the definition ofT˘ik+1, we have that bothTˆik+1andT˘ik+1lie on the same side of trianglepi−1k+1,pik+1,pi+1k+1, thenTik+1=(1−ω)Tˆik+1+ωT˘ik+1‖(1−ω)Tˆik+1+ωT˘ik+1‖also lies on the same side of trianglepi−1k+1,pik+1,pi+1k+1(see convexG1Hermite pointp2i+5k+1,Tˆ2i+5k+1of Fig. 3 for illustration). So{pik+1,Tik+1}is also a convexG1Hermite point, and the signs ofαik+1,βi−1k+1are the same as those ofαˆik+1,βˆi−1k+1, respectively.  □Lemma 5.12Convexity preserving under degenerate conditionsForG1Hermite point{pik+1,Tik+1}, ifαik+1βi−1k+1=0, thenG1Hermite point{p2ik+2,T2ik+2}is a convexG1Hermite point (seeFig. 4).ProofWithout loss of generality, we assumeαik+1=0. Because there exists aG1arc spline interpolating{pik+1,Tˆik+1}i=02nand all consecutive pointspi−1k,pik,pi+1kare not collinear, we have thenβi−1k+1≠0.By Lemma 5.10, for any newly inserted pointpik+1,αik+1βi−1k+1>0, thenpik+1is a point with even index. Without loss of generality, we assumei=2mand thenpik+1=p2mk+1=pmk,Tˆik+1=Tmk. By Proposition 5.8 and Lemma 5.11, for a convexG1Hermite point{pmk,Tmk}, both{p2m−1k+1,Tˆ2m−1k+1}and{p2m+1k+1,Tˆ2m+1k+1}are convexG1Hermite point, then we conclude that{pmk,Tmk}is an inflectionG1Hermite point.Because every newG1Hermite edge is convexG1Hermite edge (see item (2) of Proposition 5.7), both{pi−1k+1,Tˆi−1k+1;pik+1,Tˆik+1}and{pik,Tˆik;pi+1k,Tˆi+1k}are convexG1Hermite edges. By Lemmas 5.10 and 5.11, no matter whether edges{pm−1k,Tm−1k;pmk,Tmk}and{pmk,Tmk;pm+1k,Tm+1k}are convex or inflectionG1Hermite edges, the signs ofα2m−1k+1,β2mk+1are the same as those ofαˆ2m−1k+1,βˆ2mk+1. That is, the signs ofαi−1k+1,βik+1are the same as those ofαˆi−1k+1,βˆik+1(see Fig. 4).Because{pmk,Tmk}is an inflectionG1Hermite point,pm−1k,pm+1klie on opposite side ofpmkTmk. Combining with the fact thatpm−1k,p2m−1k+1lie on the same side ofpmkTmk(see inflectionG1Hermite point{pi+3k,Ti+3k}of Fig. 3 for illustration). Thenp2m−1k+1=pi−1k+1,p2m+1k+1=pi+1k+1lie on the opposite side ofpmkTmk, i.e.,pik+1Tˆik+1, too.By the sign ofαi−1k+1is the same as that ofαˆi−1k+1, we conclude thatp2i−1k+2,pi−1k+1lie on the same side ofpik+1Tik+1(see Fig. 4). By the sign ofβik+1is the same as that ofβˆik+1, we conclude thatp2i+1k+2and radial linepik+1Tˆi+1k+1lie on the same side ofpik+1Tik+1(see Fig. 4). Thenp2i−1k+2,p2i+1k+2lie on the same side ofpik+1Tik+1. Note thatTˆ2ik+2=Tik+1,p2i−1k+2,p2i+1k+2lie on the same side ofpik+1T˘2ik+2andT2ik+2=(1−ω)Tˆ2ik+2+ωT˘2ik+2‖(1−ω)Tˆ2ik+2+ωT˘2ik+2‖we conclude that{p2ik+2,T2ik+2}is a convexG1Hermite point (see Fig. 4).  □Based on Lemmas 5.10, 5.11 and 5.12, we haveProposition 5.13Convexity preserving after subdivision – from provisional tangents to final tangentsFor the biarc based subdivision scheme defined by Section3, the number of inflections implied by{pik+1,Tik+1}i=02nis equal to that implied by{pik+1,Tˆik+1}i=02n.ProofNote that there exists aG1arc splineΦk+1interpolating{pik+1,Tˆik+1}, we haveαˆik+1≠0andβˆik+1≠0. Because the order of computing the new tangents{Tik+1}does not affect the convexity, we first replace{Tˆik+1}by{Tik+1}of the convexG1Hermite points and inflectionG1Hermite points whose indices are odds. From Lemmas 5.10 and 5.11 we conclude that if{pik+1,Tˆik+1}is convexG1Hermite point withαˆik+1βˆi−1k+1>0, or is inflectionG1Hermite point with odd index, after replacingTˆik+1byTik+1, the convexity property of eachG1Hermite point andG1Hermite edge does not change. Combining with item (2) of Proposition 5.7, allG1Hermite edges are convexG1Hermite edges.In the following we consider the case ofαˆik+1βˆi−1k+1<0with even index, i.e.,i=2m.In the case ofαˆik+1βˆi−1k+1<0,pi−1k+1andpi+1k+1lie in opposite side ofpik+1Tˆik+1(see inflectionG1Hermite point{p2i+3k+1,Tˆ2i+3k+3}of Fig. 3 for illustration). Becausepi−1k+1andpi+1k+1remain to lie on the same side ofpik+1T˘ik+1, there are three possibilities ofTik+1=(1−ω)Tˆik+1+ωT˘ik+1‖(1−ω)Tˆik+1+ωT˘ik+1‖as follows:(i)pi−1k+1andpi+1k+1lie on opposite side ofpik+1Tik+1.In this case, the signs of anglesαik+1andβi−1k+1are the same as those ofαˆik+1andβˆi−1k+1, respectively. This means that after replacingTˆik+1byTik+1, the convexity property of eachG1Hermite point andG1Hermite edge is the same.pi−1k+1andpi+1k+1lie on the same side ofpik+1Tik+1.In this case, the sign of angleβi−1k+1is different from that ofβˆi−1k+1.{pik+1,Tik+1}then becomes a convexG1convex point, and the convexG1Hermite edge{pi−1k+1,Ti−1k+1;pik+1,Tˆik+1}becomes an inflectionG1Hermite edge{pi−1k+1,Ti−1k+1;pik+1,Tik+1}. So the number of inflections does not change.One ofpi−1k+1andpi+1k+1lies on the line defined bypik+1,Tik+1.Without loss of generality, we can assume thatpi+1k+1lies on the line defined bypik+1,Tik+1. So{pik+1,Tik+1;pi+1k+1,Ti+1k+1}is an inflectionG1Hermite edge and implies an inflectionG1Hermite point{p2i+1k+2,Tˆ2i+1k+2}(see Fig. 4). By Lemma 5.12 we know that{p2ik+2,T2ik+2}becomes a convexG1Hermite point and then the number of inflections does not change.Combining all the above cases, we conclude that Proposition 5.13 holds.  □From Propositions 5.9 and 5.13 we haveTheorem 5.14Convexity preserving for each level of subdivision in 2DThe biarc based subdivision scheme defined in Section3is convexity preserving for 2D curve interpolation.In this subsection, we assume that vectorsTik,Ti+1kandpi+1k−pikare not coplanar and we adopt the same symbols used in Section 2.2.The definition of convexity preserving in 3D is a very subtle issue because the position of an inflexion depends on the view direction if a curve has torsion. In our construction, the limit curve has local support and isG2, then it must allow torsion. Since a 3D biarc can be constructed from a 2D biarc, we define a convexG1Hermite edge, an inflectionG1Hermite edge, a convexG1Hermite point and an inflectionG1Hermite point in 3D according to the respective cases of 2D. Though this definition seems to be arbitrary to some extent because it is based on the local osculating sphere, it is well-defined due to the fact that each3DG1Hermite data is always co-spherical, and if the proposed construction is applied, there exists one and only one2DG1Hermite data corresponding to it.We define a convexG1Hermite edge and an inflectionG1Hermite edge as follows:Definition 5.15Convex and inflection edge classificationAG1Hermite edge{pik,Tik;pi+1k,Ti+1k}is defined as a convexG1Hermite edge ifα¯ikβ¯ik>0(see Fig. 2(a)); aG1Hermite edge{pik,Tik;pi+1k,Ti+1k}is defined as an inflectionG1Hermite edge ifα¯ikβ¯ik≤0(see Fig. 2(b)).Similarly, a convexG1Hermite point and an inflectionG1Hermite point are defined as follows:Definition 5.16Convex and inflection point classificationAG1Hermite point{pik,Tik}is defined as a convexG1Hermite point ifα¯ikβ¯i−1k≥0, aG1Hermite point{pik,Tik}is defined as an inflectionG1Hermite point ifα¯ikβ¯i−1k<0.For aG1Hermite edge{pik,Tik;pi+1k,Ti+1k}, we haveLemma 5.17Convexity preserving from 3D to arbitrary 2D plane projectionLet{pik,Tik;pi+1k,Ti+1k}be a convex (inflection) edge,Π˜be a plane passing throughpikpi+1k,U˜ik,U˜i+1kbe the projections ofTik,Ti+1ktoΠ˜, respectively, then{pik,U˜ik;pi+1k,U˜i+1k}is also a convex (inflection)G1Hermite edge.ProofLetq˜ik,q˜i+1kbe the intersections of linesqikIikandqi+1kIi+1kwithΠ˜respectively, then the projections ofpikTikandpi+1kTi+1ktoΠ˜will bepikq˜ikandq˜i+1kpi+1k, respectively (see Fig. 5).In case of{pik,Tik;pi+1k,Ti+1k}being a convexG1Hermite edge, vectorsIik−pik,pi+1k−Ii+1klie on different side ofpikpi+1konΠik, so vectorsq˜ik−pikandpi+1k−q˜i+1kalso lie on different side ofpikpi+1konΠ˜(see Fig. 5(a)). Thus{pik,U˜ik;pi+1k,U˜i+1k}is convexG1Hermite edge. Similar conclusion also holds in case of{pik,Tik;pi+1k,Ti+1k}being an inflectionG1Hermite edge. Lemma 5.17 thus holds.  □We point out a simple lemma as follows:Lemma 5.18LetTik=(1−ω)Tˆik+ωT˘ik‖(1−ω)Tˆik+ωT˘ik‖, unit vectorsT˜ik,Tˆ˜ik,T˘˜ikbe the projections ofTik,Tˆik,T˘ikto a planeΠ˜, thenT˜ik=(1−ω)Tˆ˜ik+ωT˘˜ik‖(1−ω)Tˆ˜ik+ωT˘˜ik‖.The proof of this lemma is easy and we omit it here.By Lemma 5.17, the convexity property ofG1Hermite edge{pik,Tik;pi+1k,Ti+1k}can be converted to the convexity of its projection to plane passing through{pik,Tˆik;pi+1k,Tˆi+1k}. On the other hand, convexity property ofG1Hermite point{pik,Tik}is defined on plane{pi−1k,pik,pi+1k}. Furthermore, by Lemma 5.18, the linear combination of 3D can also be converted to that of the 2D case. Similar to the proof of the 2D case, we haveProposition 5.19Convexity preserving after subdivision with provisional tangentsFor the biarc based subdivision scheme defined by Section3, the number of inflections implied by{pik+1,Tˆik+1}i=02nis equal to that implied by{pik,Tik}i=0n.Proposition 5.20Convexity preserving after subdivision – from provisional tangents to final tangentsFor the biarc based subdivision scheme defined by Section3, the number of inflections implied by{pik+1,Tik+1}i=02nis equal to that implied by{pik+1,Tˆik+1}i=02n.We thus haveTheorem 5.21Convexity preserving for each level of subdivision in 3DThe biarc based subdivision scheme defined in Section3is convexity preserving for 3D curve interpolation.To make the text lighter, we assume that all angles in this section are positive if not stated explicitly. In case of some angles being negative, the proof is similar.For convenience, we further summarize some notations as follows.•αik: the angle fromTiktopikpi+1k;βik: the angle frompikpi+1ktoTi+1k;θk=maxi⁡{αik,βik}.α¯ik: the angle fromT¯iktopikpi+1k;β¯ik: the angle frompikpi+1ktoT¯i+1k;θ¯k=maxi⁡{α¯ik,β¯ik}.αˆik: the angle fromTˆiktopikpi+1k;βˆik: the angle frompikpi+1ktoTˆi+1k;θˆk=maxi⁡{αˆik,βˆik}.γik: the angle fromTiktoT¯ik, i.e. the angle fromTik,Ti+1kto planeΠik.It is easy to see thatθ¯k≤θk.We now prove thatTheorem 6.1For the biarc based subdivision scheme defined in Section3,limk→∞⁡θk=limk→∞⁡θ¯k=0.The proof of this theorem requires some further discussions and we pose it in Appendix A.Theorem 6.2For the biarc based subdivision scheme defined in Section3, the polygon series converges to a continuous curve.ProofSimilar to the proof of Theorem 4.2 of Deng and Wang (2010), it is not difficult to show that the limit curve is continuous.  □Theorem 6.3For the biarc based subdivision scheme defined in Section3, the limit curve isG1continuous.ProofFollowing form Lemma A.4, Lemma A.6 we haveγik<ωθˆk<ω(1+2ω2)kθˆ0.Thenmax⁡{limk→∞⁡γik}=0and so for enough little neighborhood of a point, the control polygon can be seen as plane polygon. Thus this theorem follows immediately from (A.16) and Theorem 6.2 of this article and Theorem 18 of Dyn and Hormann (2012).  □In this section, we present several examples for smooth and convexity preserving interpolation by the biarc based subdivision scheme. To illustrate the quality of a subdivision curve, we also compute and plot the discrete curvatures of the curve after a finite number of subdivisions. For a pointpik, its discrete curvature is determined by its discrete curvature circle, which pass throughpi−1k,pik,pi+1k. The initial tangent vectorTi0forpi0is the tangent vector atpi0of the circle passing throughpi−10,pi0andpi+10.We first explore the effect of free parameter ω (see Eq. (1)) to the limit curve in Example 1, in which nine limit curves are generated by the biarc based subdivision scheme from a simple control polygon with free parameter ω as 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, respectively. The initial five points are (4.09,5.21,0), (3.79,3.92,1), (5.64,2.48,0), (7.98,3.75,0), (7.39,5.69,3). The limit curves as well as discrete curvature of each point are displayed in Fig. 6. To easily access the shape of these limit curves, we also display the discrete curvature plots for each of the limit curves (see Fig. 7). From the limit curves and their discrete curvature plots, we can see that for small ω such as 0.05, 0.1, 0.15, the limit curve have some visible jump points of curvature, though from the curvature plots we can see that the limit curves still seem to be curvature continuous. For big ω such as 0.35, 0.4, 0.45, the discrete curvatures of the limit curves seem to be jagged sometimes. From their discrete curvature plots, we can clearly see this effect. So though their limit curves seem to be curvature continuous, the limit curves are not fair. However for median ω such as 0.2, 0.25, 0.3, from the limit curves and their discrete curvature plots, we can see that the limit curves seem to be curvature continuous and fair. So we recommend to set the free parameter ω be in the range of[0.2,0.3]. In the following examples we letω=0.25.To compare the effect of the biarc subdivision scheme with other schemes, a limit curve generated by the ternary four point subdivision scheme (Hassan et al., 2002), which generatesC2curves, and its discrete curvature plots are displayed in Fig. 8. From Fig. 8(b) we can see that though the limit curve of the ternary four point subdivision scheme isC2continuous, the fact that the limit curve has many curvature extreme points implies that the limit curve is not fair. Two other examples (see Figs. 9, 10) also support this conclusion.In the following examples, we show the convexity preserving and artifact removal effect of the biarc based subdivision scheme. A well-known deficiency of linear subdivision schemes is that their limit curves have big bump near a short edge with adjacent very long edges (also see Fig. 10(a)). The biarc based subdivision scheme, however, produces very fair limit curves in such case (see Fig. 10(b)). The initial points for Example 2 are (2.5,8.8,0), (1.5,8.0,2), (3.0,5.0,0), (5.0,5.0,1), (6.5,8.0,0), (5.5,8.8,0), (4.0,7.6,0). The initial points for Example 3 are(4.7,3.8,0),(7.6,3.8,2),(7.7,3.9,2),(7.7,5.3,−2),(4.7,5.3,0).Finally, we give two more examples (see Figs. 11, 12) to show the property for generating spherical curves by the biarc based subdivision scheme. In these two examples, we first sample some initial data from source figures, then generate planar curves by the biarc based subdivision scheme, finally we map the planar initial data to spherical surface and generate spherical curves by the biarc based subdivision scheme. From the figures we can see that the limit curve are spherical curves if all the initial data are sampled from the spherical surface. These facts are consistent with Theorem 4.1.From these examples and many other examples that we tested, we find that the limit curves produced by the proposed biarc based subdivision scheme isG2continuous. It is however difficult to prove this conclusion at the moment. We thus pose a conjecture in this paper and leave the proof as future work.Conjecture 1For the biarc based subdivision scheme defined in Section3, the limit curve isG2continuous.

@&#CONCLUSIONS@&#
We have described a biarc based subdivision scheme for 3D curve interpolation. It can be seen as an extension of the incenter subdivision scheme (Deng and Wang, 2010) to 3D for space curve subdivision. The scheme has some attractive properties, such as spherical curve generation, convexity preserving, artifacts removal and thus producing fair limit curves. How to prove that the limit curve isG2continuous should however be further addressed as future work. The design of other higher order 3D interpolation curves by geometry driven subdivision schemes also deserves for future studies. Another attractive but difficult future work is to extend the proposed biarc based subdivision scheme for defining an interpolatory surface subdivision scheme that reproduces spherical surfaces.