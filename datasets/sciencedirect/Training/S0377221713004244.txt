@&#MAIN-TITLE@&#
New insights on integer-programming models for the kidney exchange problem

@&#HIGHLIGHTS@&#
Revision of Integer Programming approaches for the Kidney Exchange Problem.Presentation of two new IP formulations that grow polynomially with size of the instances.The tightness of IP formulations is compared theoretically.All formulations are evaluated computationally with a commercial IP solver.Two of the models are shown to perform best, although for different types of instances.

@&#KEYPHRASES@&#
Kidney exchange program,Integer programming,Combinatorial optimization,Healthcare,

@&#ABSTRACT@&#
In recent years several countries have set up policies that allow exchange of kidneys between two or more incompatible patient–donor pairs. These policies lead to what is commonly known as kidney exchange programs.The underlying optimization problems can be formulated as integer programming models. Previously proposed models for kidney exchange programs have exponential numbers of constraints or variables, which makes them fairly difficult to solve when the problem size is large. In this work we propose two compact formulations for the problem, explain how these formulations can be adapted to address some problem variants, and provide results on the dominance of some models over others. Finally we present a systematic comparison between our models and two previously proposed ones via thorough computational analysis. Results show that compact formulations have advantages over non-compact ones when the problem size is large.

@&#INTRODUCTION@&#
Kidney transplants are essential for the survival of many patients suffering from kidney failure, but finding suitable kidneys can be difficult because of their scarcity as well as blood or tissue incompatibility between donors and patients. For a long time, deceased donors were typically the most acceptable source of kidneys for transplantation. However, they only met a tiny fraction of the demand and alternative transplantation policies considering living donors progressively stepped forward. Within these policies, if a patient had someone willing to donate a kidney and the patient–donor pair was compatible, then the transplant could be done. However, if a patient and the prospective donor were not physiologically compatible, then transplantation could not be performed.In recent years kidney exchange programs brought new hope for many kidney patients. These programs involve patient–donor pairs in which donors are incompatible with their recipients. The key aspect is to organize exchanges between a number of such pairs so that patient P in one pair receives a kidney from donor D in the other pair. Fig. 1(left) illustrates the simplest case with only two pairs (P1,D1) and (P2,D2), where patient and donor in each pair are incompatible (dotted lines represent incompatibilities). However, P1 is compatible with D2 and P2 is compatible with D1. Previously, when exchanges between pairs were not allowed, no transplants could be performed in this situation. Within the evolving frameworks of new programs, exchanges between such pairs are allowed and the two transplants can be performed (arrows represent the exchange in the figure).Kidney exchange programs have already been introduced in many countries, including South Korea [20], Switzerland [37], Turkey [15], Romania [21], The Netherlands [8,9,19], UK [7,17,23] and the US [35,36,2,39]. Very recently, similar programs have also been set up in other countries: in 2010, Canada, Portugal, Australia, and New Zealand kicked-off their own programs while Spain initiated its program in 2011.The objective for optimization in a kidney exchange program is generally to maximize the collective benefit for a given pool of incompatible pairs, usually measured by the number of possible kidney exchanges [36,8] — in the entirety of the paper we will refer to this optimization problem as the Kidney Exchange Problem (KEP). Although such an optimal solution is typically desirable, there are other factors which may also be considered in some situations; e.g. maximize the weighted sum of kidney exchanges [23] and/or the quality-adjusted life expectancy of transplant candidates [42].One of the crucial questions for the KEP is the definition of a bound on the number of pairs that can be involved in an exchange. When a kidney exchange involves only two donor–recipient pairs as illustrated in Fig. 1 (left) it is commonly known as a 2-way or 2-cycle exchange. Basically this is an alternating directed cycle of two donors and two recipients in which the donor from one incompatible pair gives one kidney to the recipient in the other pair and vice versa. One can note that the size of the exchange cycle can be increased. For example, the 3-way exchange presented in Fig. 1 (right) allows three patients to get transplants instead of two; solid lines here represent compatibilities and arrows represent the actual exchanges that derive maximum collective benefit.Generally k-cycle exchanges with k⩾3 can be better for optimization as they have the potential for increasing the options for involving more incompatible pairs in an “exchange cycle”. If there is no bound on the number of pairs in an exchange cycle, i.e., k is not fixed, the problem turns into an assignment problem and can be solved in polynomial time [2]. Ideally all operations involved in a cycle should be performed simultaneously so that donors remain committed when the incompatible partners receive other donors’ kidneys. Therefore for a solution to be practical and manageable, the length of the cycles should be restricted for at least two main reasons. First, the number of personnel and facilities needed for simultaneous operations of donors and patients raise several logistic issues that can make it prohibitively inconvenient to handle too many operations simultaneously [2]. Second, because last-minute tests on donors and patients can bring out new incompatibility issues that can cause a kidney donation and related exchanges in the cycle to be canceled, it is preferable for the cycles to be shorter.For a given pool of donor–recipient pairs, a 2-cycle exchange can be seen as a task of pairwise compatibility matching, and Edmond’s maximum cardinality matching algorithm [11] can provide an optimal solution in polynomial time. The problem with k-cycle exchange certainly is a generalized model and much more interesting for practical applications. However, the associated problem is known to be NP-complete for k⩾3 and difficult to solve efficiently when a problem instance is large [2].Current work on solving the KEP focuses mostly on Integer Programming (IP) formulations. Two IP models, referred to in this paper as the “edge formulation” and the “cycle formulation”, were proposed in [34]. Despite the very good results reported for the cycle formulation in [2], the question of finding a compact formulation that has a number of variables and constraints bounded by a polynomial in the size of the problem (i.e., on the total number of pairs in a donor–recipient pool), has, up until now, remained open: the cycle formulation presents an exponential number of variables, while the edge formulation has an exponential number of constraints.This paper focuses on mathematical modeling aspects of the KEP: we propose two new compact formulations for the problem. Moreover we investigate the relationships between different formulations and provide some proofs of dominance of one formulation over the other in the sense of values of upper bounds for optimal solutions obtained with the linear relaxations (LP relaxations) of each formulation. Finally, a systematic comparison of these formulations with the two previously reported ones is presented by thorough computational analysis.The paper is organized as follows. Following this introduction we review in Section 2 relevant literature with respect to variants of the KEP and solution methods. In Section 3 the problem statement and the known IP models are presented. The new compact formulations for the KEP are introduced in Section 4. In Section 5 the adaptation of formulations for variants of the KEP is discussed. The interrelations of upper bounds of linear relaxations for the presented IP models are investigated in Section 6. Section 7 reports the computational analysis and conclusions on the effectiveness of each formulation. Finally Section 8 provides conclusions and directions for future work.

@&#CONCLUSIONS@&#
This paper presents two new formulations for the Kidney Exchange Problem – edge-assignment and extended edge formulations – that have the advantage over other formulations proposed in the literature of having polynomially bounded number of constraints and variables. A proof of dominance of some formulations over others is also given and a discussion on the adaptability of each formulation to different problem variants is provided. Finally, computational results that compare the previous and proposed formulations in terms of time needed to find an optimal solution and of the gaps of linear relaxations upper bounds of the models are provided.Computational results show that the edge formulation has a bad performance and that it is not effective at solving instances larger than 50 pairs. The non-compact cycle formulation is very efficient for low density graphs with small values of k. However for larger values of k and especially if graphs are denser this formulation becomes inefficient. In such cases compact formulations provide better results – in particular the extended edge formulation – and are able to solve larger problems. Therefore, although we prove in this paper that linear relaxations of the compact formulations do not provide better upper bounds for optimal solutions than the cycle formulation, computational results reinforce the idea that compact formulations are of practical relevance.As future work an interesting direction is to use decomposition methods on the extended edge formulation, in order to solve larger problems. The adaptation of these models to dynamic environments will also be the subject of additional research.