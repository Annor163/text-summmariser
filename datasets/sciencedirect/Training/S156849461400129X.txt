@&#MAIN-TITLE@&#
Design and implementation of coupled chaotic maps in watermarking

@&#HIGHLIGHTS@&#
A multidimensional coupled chaotic map as a pseudo random number generator is proposed.A watermark scheme is presented.The proposed scheme is subjected to some security analysis as well as statistical tests suites.Watermark extraction does not require the original image.

@&#KEYPHRASES@&#
Digital image watermarking,Chaotic map,Coupled map lattice,Ergodic theory,

@&#ABSTRACT@&#
The present paper proposes a multidimensional coupled chaotic map as a pseudo random number generator. Based on an introduced dynamical systems, a watermark scheme is presented. By modifying the original image and embedding a watermark in the difference values within the original image, the proposed scheme overcomes the problem of embedding a watermark in the spatial domain. As the watermark extraction does not require the original image, the introduced model can be employed for practical applications. This algorithm tries to improve the problem of failure of embedding in small key space, embedding speed and level of security.

@&#INTRODUCTION@&#
Watermarking technique is one of the active research fields in recent years, which can be used in protection of multimedia information, content authentication, and so on. The two well-known research branches and applications in digital watermarking are fragile and semi-fragile watermarking [28,40,14]. In authentication watermarking, tamper localization and detection accuracy are two major issues. However, most methods in literature have not presented precise localization. A watermark typically contains information about origin, status, and/or destination of the host data [9,41,32]. Image scrambling is one of the most prevailing encryption algorithms these years [15,37,43,12]. However, the methods of scrambling are limited. By now most of the proposed watermarking schemes have used watermarks generated from pseudo random number sequences [19]. On the other hand, chaotic functions such as Markov Maps, Bernoulli Maps, Skew Tent Map and Logistic Map have been widely used to generate watermark sequences [3,29,30]. These types of watermark generation schemes require two values (the initial value and the function seed value) to recreate the same watermark at a later stage. An advantage of these watermarks is the possibility of analyzing and controlling the watermark spectral properties.A watermark should be robust. That is, it should survive classic content processing. It should also remain imperceptible and convey as much information as possible. For real-time applications, it should have low complexity embedding and retrieval processes [38,20].The present paper concentrates typically on the security of watermarking (key space) [13,24]. Specifically it aims at proposing a secure watermarking scheme based on spatiotemporal chaos. In order to enhance the security in watermarking process, spatiotemporal chaos is employed to select both the embedding positions for each watermark bit and for watermark encryption. In this article, a watermarking algorithm based on a multidimensional coupled chaotic map is proposed. The dimension of the introduced dynamical system regarding the level of the security and the extra dimension can be used to apply many logos in watermarking process.The paper is organized as follows. Section 2 describes chaotic maps and the location of embedding position of watermark. Section 3 presents the synchronization condition and the ergodicity of the introduced model. The section studies the chaotic domain of the introduced model through Lyapunov exponents to generate the key space. The watermarking scheme based on chaotic maps is proposed in Section 4. The selected example and the simulation results are discussed in Sections 4 and 5. Section 6 concludes the paper.The chaotic sequences exhibit some important characteristics. any change in control parameter of chaotic maps such as Logistic and Chebyshev maps can produce white-noise-like sequences [24,6,25]. For enhancing the security of discrete chaotic watermarking the paper introduces for the first time, the concept of using multidimensional coupled chaotic map with an invariant measure in watermarking (See Appendix A). Certain characteristics of our introduced watermarking method, make it distinctive compared to the other schemes.These characteristics can be stated as follows:•Presenting very large number of fully developed chaotic maps.Having complexity due to high dimensionality and chaoticity.Having large key space; It is obvious that the attack complexity is determined by the size of the key space and the complexity of the verification of each key.Having flexibility in attributing different values to the control parameters and the coupling parameter.(1)Φ=x1(n+1)=F(x1(n),…,xN(n))=ϵ1f1(x1(n))+...+ϵNfN(xN(n))⋮xN(n+1)=F(x1(n),…,xN(n))=ϵ1f1(xN(n))+...+ϵNfN−1(xN−1(n))where, ϵ is the strength of the coupling {ϵ1+…+ϵN=1}. We introduce our map ensemble {f} based on the one-parameter families of chaotic maps ΦN(x, α) with an invariant measure. They can be defined as the ratio of polynomials of degree N (see Appendix A). In fact, there is a multidimensional dynamical system which has the property of possessing an invariant measure at synchronized state [21].Key space can be generated by control parameters and the initial conditions of chaotic maps. Many properties of the chaotic systems have their corresponding counterparts in traditional cryptosystems, such as: ergodicity and confusion, sensitivity to initial conditions, control parameter, and diffusion [26,27]. In this section, the ergodicity is explored by calculating the invariant measure. The Lyapunov exponents are also calculated to verify the chaotic domain. By considering the chaotic domain of the multidimensional coupled chaotic maps, the key space is arranged. One possibility to have an ergodic coupled map is to synchronize the introduced dynamical model.Synchronization of two (or more) chaotic dynamical systems (starting with different initial conditions) means that their chaotic trajectories remain in step with each other during the temporal evolution. The key concept of complete synchronization refers to a state where the trajectories of dynamical systems approach each other[4,39]. The introduced model has a fast speed and robust synchronization properties.For multidimensional coupled chaotic map, we have tried to describe ergodicity from the invariant measure point of view [16,10]. Sinai–Ruelle–Bowen (SRB) is a measure which describes the ergodic properties with respect to typical initial conditions [16,11]. The difficulty in rigorous proving that a given coupled map exhibits spatio-temporal chaos lies in finding such an SRB measure.Each symmetric transformation for generic model Eq. (1) should have the invariant measure. The suitable condition for the presentation of the invariant measure of the synchronized coupled map is choosing a one-dimensional map with an invariant measure as introduced in our previous paper [21]. We can rewrite the Frobenius–Perron (FP) integral for multidimensional coupled chaotic map as follows [16,11]:μ(x1(n+1),…,xN(n+1))=∫dx1…∫dxNδ(x1(n+1)−F1(x1(n),...,xN(n)))…δ(xN(n+1)−FN(x1(n),…,xN(n)))μ(x1(n),…,xN(n)),We will show that the invariant measure at synchronized state has the following form:(2)μ(x1,…,xN)=δ(x2−x1)…δ(xN−x1)μ(x1)Relation 2 shows invariance under the permutation of synchronization coordinate (x1, x2, …), therefore, the measure is invariant at transverse direction and the stable direction follows μ(x1). By considering the complete synchronization, the (FP) integral for multidimensional coupled chaotic map can be written as:μ=∫dx1…∫dxNδ(x1(n+1)−F1(x1(n),…,xN(n)))δ(xN(n+1)−FN(x1(n),…,xN(n)))×δ(x2(n)−x1(n))…δ(xN(n)−x1(n))μ(x1),which can be reduced to:μ=δ(x2(n+1)−x1(n+1))…,δ(xN(n+1)−x1(n+1))×∫dx1δ(x1(n+1)−F1(x1(n),…,x1(n)))μ(x1(n)),Now, if the one-dimensional map x(n+1)=F(x1(n), …x1(n)) possesses the invariant measure μ(x1(n)), then it satisfies:(3)μ(x(n+1))=∫δ(x(n+1)−F(x1(n),…,x1(n))dμ(x1),Then, we have:(4)μ(x1(n+1),…,xN(n+1))=δ(x1(n+1)−x2(n+1)),…,δ(xN(n+1)−x1(n+1))μ(x1(n+1)).The following properties make a deterministic algorithm suitable to generate a pseudo random sequence of numbers: high value of entropy, high dimensionality of the parent dynamical system, and very large period of the generated sequence [22,18,8]. There is a close correlation between the Lyapunov exponent of the underlying chaotic map and the “randomness”. Since randomness is desired to be seen on a random number generator clearly, it must be correlated with the diverging nature of the trajectories of a chaotic map, which is tied to the existence of a positive Lyapunov exponent.A spectrum of all the Lyapunov exponents with respect to the synchronization solution can be evaluated in a way similar to that of one-dimensional local maps [16,17]. At synchronized state, the Lyapunov exponents Λkof multidimensional coupled chaotic map described by the Eq. (1) are defined aslimn⟶∞1n|λk(x1,μ(x1(n+1),…,xN(n+1))=,xN)|,whereλk=∑k=1Nhk(x1,μ(x1(n+1),…,xN(n+1))=,xN)are eigenstates of the matrix:∂FoFo…F︷n(x1(0),…,xN(0))∂x1(0)…∂FoFo…oF︷n(x1(0),…,xN(0))∂xN(0)⋮∂FoFo…F︷n(xN(0),…,xN−1(0))∂x1(0)…∂FoFo…F︷n(xN(0),…,xN−1(0))∂xN(0)|x1(0)=,…,=xN(0)=∂x1(n+1)∂x1(n)…∂x1(n+1)∂xN(n)⋮∂xN(n+1)∂xN…∂xN(n+1)∂xN−1(n)|x1=…=xN=h1(x1,…,xN)h2(x1,…,xN)…hN(x1,…,xN)h2(x1,…,xN)h3(x1,…,xN)…h1(x1,…,xN)⋮hN(x1,…,xN)h1(x1,…,xN)…hN−1(x1,…,xN)andxk=FoFo…F︷k(x0,x0,…,x0). Now, in the case of ergodic one-dimensional map X=F(x, x, …, x), the Lyapunov exponents can be written as:Λk(syn)=limn→∞1nln|λk(xn)|=limn→∞1nln|λk(FoFo…F︷n(x10,x10,…,x10))|=limn→∞1n∑k=0nln|∑i=1Nhi(x1k,…,xNk)|(5)Λk(syn)=∫dxμ(x)ln|∑i=1Nhi(x10,…,xN0)|.Therefore, the ergodicity of one-dimensional map X=F(x, x, …, x) implies the ergodicity of symmetric multidimensional coupled chaotic map (Eq. (1)) at unstable synchronized state (synchronized state is stable for negative critical exponent Λk). Obviously, the non-ergodic choice of X=F(x, x, …, x) will lead to the non-ergodicity at synchronized state. There is a close correlation between the Lyapunov exponent sign of the maps and the efficiency of the extracted data in forming a good set of pseudo random numbers.Watermark provides a natural link between chaotic dynamics and information theory on which the recent idea of utilizing chaotic systems in encoding digital information is based. The proposed watermarking utilizes multidimensional coupled chaotic maps which are used along with a single chaotic map.In order to clarify the performance of the introduced model (Eq. (1)) in watermarking process [21], a simple two-dimensional model for watermarking is formed as follows. Through using (A.4) at synchronized state x1=, …, =xN=x, the coupled map (Eq. (2)) is reduced to:(6)x(n+1)=F(x(n),…,x(n))=a¯(ϵ1,…,ϵN,a1,…,aN)tan2(Narctan(x(n)))witha¯(ϵ,a1,a2,…,aN)=(∑i=1Nϵiai). As it is shown in (see Appendix B), this map has the invariant measure of the following form:(7)μ(x1,x2,…,xN)=δ(x2−x1)…δ(xN−x1)βx(1+βx).provided that the constant β is chosen as one of the positive roots of the following equation:(8)a¯(ϵ1,…,ϵN,a1,…,aN)=∑k=0N2C2kNβ−k∑k=0N−12C2k+1Nβ−k2In our example, the Lyapunov exponents are (see Appendix B):Λk=limn→∞1nln|λk(x1,k,…,xN,k)|(9)=ln(1−ϵ)a1−ϵa2+ln|∑k=1Nϵkωk−1ak|+Λ∑k=1Nϵkak)g′(x1,k,…,xN,kEq. (6) is reduced to the following two-dimensional chaotic map:(10)x(n+1)=F(x(n),x(n))=a¯(ϵ,a1,a2)tan2(Narctan(x(n))).which is used in watermarking process. The last part of the encryption is followed by:(11)x(n+1)=1a32tan2(Narctanx(n)).where N=2. At the second stage, we select the key. A positive way to describe the key space [5] might be in terms of positive Lyapunov exponents. Since it has been proved that the introduced map has an invariant measure, we select a suitable control parameter domain for the key space by refereing to analytically calculated Lyapunov exponents (see Fig. 1). Key space size in our introduced example, (Eqs. (10) and (11)) consists of coupling parameter, three-control parameters and three initial conditions.Watermark embedding process is described as follows. We assume that the original image of the size n×n is referred as Φ={Φ(x1, x2), 1≤x1, x2≤n} and the binary watermark (logo) of size m×m is referred to as ϕ={ϕ(i, j), 1≤i, j≤m}, where (i, j)((x1, x2)) represent the pixel coordinate of binary watermark image and the original host image.Watermark bits (1 bit per pixel) are embedded in the host image according to the following process. Using the coordinate (i, j) of watermark pixel and the control parameter of the coupled map as the initial conditions (see Fig. 1), the coupled map is iterated. Then the embedding position of pixels from watermark image to host image can be obtained. The watermark pixels will get different embedding positions, so the embedded watermark pixels will spread in host image randomly.To determine the bit of the host image pixels, the watermarking process is followed by the iteration of the third map (Eq. (11)). Based on the chaotic domain of the third map (see Fig. 7), a truly random sequence is generated which is distributed in the interval ([0, 1] or [0, ∞)). Then, the interval can be divided into several subintervals ([0, x1], [x1, x2], …) which correspond to different pixel bits in watermark embedding process [1,42]. As it was discussed, by dividing the sub-domain corresponding to the kth bit of host image, ([0, x1]→k3,[x1, x2]→k4,…), the watermark pixel is embedded in the kth bit of pixel (x1, x2) in host image.The embedded watermark pixel is referred to as Φ(x1, x2). If ϕ(i, j) is the same as the kth bit of Φ(x1, x2), then ϕ(x1, x2)=Φ(x1, x2), i.e., the pixel value is kept unchanged. Otherwise, the kth bit of Φ(x1, x2) is substituted by ϕ(i, j). The flowchart of the overall solution algorithm is shown in Fig. 2.In the process of extraction, one needs to know the key parameters. Since both decryption and encryption procedures have similar structure, they have essentially the same algorithmic complexity and time consumption. The block diagram of the extraction algorithm is shown in Fig. 3.

@&#CONCLUSIONS@&#
