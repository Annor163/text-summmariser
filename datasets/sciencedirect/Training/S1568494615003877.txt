@&#MAIN-TITLE@&#
Optimal design of passive power filters based on multi-objective bat algorithm and pareto front

@&#HIGHLIGHTS@&#
Four typical types of passive power filter.Four objectives and five constraints.Modified bat algorithm using inertia weight and external archive for multi-objective optimization.

@&#KEYPHRASES@&#
Bat algorithm,External archive,Multi-objective optimization,Non-dominated solutions,Passive power filters,

@&#ABSTRACT@&#
This paper proposes an optimal design method for passive power filters (PPFs) in order to suppress critical harmonics and improve power factor. The characteristics of common passive filters, such as single-tuned, second-order, third-order, and C-type damped filters are introduced. In addition, several objective functions and constraints for PPF design problems are constructed. A new multi-objective optimization based on the modified bat algorithm and Pareto front is developed for solving PPF design problems. A case study is also presented to demonstrate the efficiency and superiority of the proposed method.

@&#INTRODUCTION@&#
Nowadays, in modern power systems, nonlinear loads that may produce many harmonics are increasingly used, especially in electronic devices [1]. Harmonics distort current and voltage waveforms, which are expected to be purely sinusoidal. If the distortion is sufficiently large, it may lead to unfavorable effects, such as communication interference, power loss, equipment heating, malfunction, or even damage. In order to reduce harmonic effects, power filters are widely used in electric power systems. In addition to harmonic mitigation, power filters can provide reactive power compensation, which can improve the system power factor and reduce power loss. In general, there are three types of power filters: passive power filters (PPFs) [2–5], active power filters [6,7], and hybrid power filters [8]. Among them, PPFs have been used more commonly than the other types because of their low cost and simplicity.Designing PPFs includes determining the types, set number, elements, and parameters of filters to satisfy the requirements of harmonic filtering, power factor compensation, and other conditions [4,8]. That is, the performance of PPFs is determined not only by circuit topology but also by the values of the resistive, inductive, and capacitive components [5]. Designing a PPF is a difficult task owing to the several nonlinear constraints and objectives that have to be considered. Based on the experiences of engineers, trial-and-error procedures are involved in conventional methods. However, optimal solutions of PPFs are difficult to obtain. Recently, the growth of nature-inspired optimization methods has opened new approaches for PPF designs. Genetic algorithm-based methods have been used in PPF design [5], but their main disadvantages include a high computational burden and low convergence rate. Particle swarm optimization (PSO)-based methods are inspired by the social behaviors of a bird flock or a fish school when searching for food. The PSO algorithm [9] is known to have fast convergence and has been proved to be very successful with single-objective optimization problems. Some PSO-based methods have also been applied to PPF design [3,8]. Most of them treat the optimal design of PPFs as a single-objective optimization problem using a combinatorial fitness function [3], or they attempt to transform a multi-objective problem into a single-objective one by considering two or more objective functions as “acceptable level” constraints [8]. In a multi-objective optimization task, there is a set of feasible solutions called the Pareto optimal set. The values of the objective functions are used together to form a so-called Pareto front. In addition, these solutions can be termed as non-dominated solutions. Generally, in order to extend the PSO algorithm for multi-objective optimization, an external archive is usually used to store non-dominated solutions. In addition, the search space of variables is divided into many hyper-cubes which can help obtain a well-distributed Pareto front.New nature-inspired optimization methods are still being developed. A noteworthy example of those, called the bat algorithm (BA), was proposed by Yang [10] and has a promising future. This method is inspired by the echolocation behavior of microbats and has been proved to be efficient in some practical applications [11,12]. This paper proposes a new multi-objective optimization method based on the modified BA and Pareto front for PPF design. With the proposed approach, the PPFs design can be treated as a real multi-objective problem. No combinatorial functions or “acceptable level” constraints need to be used. In addition, several solutions are obtained, which can offer several options to a designer for selecting a suitable result.Compared to other methods and other types of filters, PPFs are widely used for mitigating harmonic effects in power systems because of their low cost and simplicity. The filters are usually installed close to the nonlinear loads, which may produce harmonic currents. After being installed, the filters can provide a low-impedance path to critical harmonic currents, and hence, prevent harmonic currents from flowing into the systems. In general, a PPF is composed of passive elements such as resistors, inductors, and capacitors. Fig. 1. shows typical PPFs including a single-tuned filter, second-order damped filter, third-order damped filter, and C-type damped filter.The single-tuned filter is a series combination of an inductor, a capacitor, and a resistor. The resistor is usually considered to be the intrinsic resistance of the inductor or the capacitor. Single-tuned filters have a very simple configuration. Hence, it offers low investment cost and power loss. However, the filter can attenuate only a single harmonic-order component. The transfer function of the single-tuned filter can be expressed as follows:(1)ZF(s)=1ssωn2+1Qsωn+1where s is the complex frequency, Q is the quality factor, and ωn(or fn) is the resonant frequency in rad/s (or Hz).(2)Q=1RLC(3)ωn=1LC→fn=12πLCThe impedance magnitude at the resonant frequency is represented by a valley in the plot of the magnitude response shown in Fig. 2. If the quality factor is increased, the resonant valley will become sharper, resulting in better harmonic attenuation. The resonant harmonic order is given by(4)hn≜fnf1=12πf1LC=1ω1LCAccording to (4), the relationship between the fundamental inductive reactance XLand the fundamental capacitive reactance XCcan be expressed as follows:(5)XL=XChn2At the hth-order harmonic frequency, the impedance of single-tuned filters is calculated as follows:(6)Z¯Fh=R+jhXL−XChThe second-order damped filter is a high-pass filter. It can attenuate harmonic currents whose frequencies are above the resonant frequency. In the s-domain, the transfer function of the filter is given by(7)ZF(s)=RCssL+Rsωn2+1Qsωn+1The quality factor is obtained as follows:(8)Q=RL/CThe magnitude response of the filter is shown in Fig. 3. The resonant frequency, resonant harmonic order, and the relationship between XLand XCare calculated by (3), (4), and (5), respectively. At the hth-order harmonic frequency, the filter impedance is calculated as follows:(9)Z¯Fh=R(hXL)2R2+(hXL)2+jR2hXLR2+(hXL)2−XChIn the third-order damped filter, a capacitor is connected in series with the resistor for reducing the impedance of the resistor branch. As a result, the fundamental power loss will decrease. Generally, the two capacitors of the third-order damped filter are selected similarly for design simplicity. Meanwhile, in the C-type damped filter, a capacitor is connected in series with the inductor instead of the resistor to yield series resonance at the fundamental frequency. This connection scheme is also aimed to reduce the fundamental power loss caused by the resistor. For these two filters, two parameters are introduced as the characteristic harmonic order hnand damping constant ratio m given as follows:(10)hn=12πf1RC2(11)m=LR2C2The magnitude response of the third-order and C-type damped filters are represented in Fig. 4and Fig. 5, respectively. At the hth-order harmonic frequency, the impedance of the third-order damped filter is given by(12)Z¯Fh=RhXL2R2+hXL−XCh2+jR2hXL−hXL2XC+XLXC2hR2+hXL−XCh2−XChand the impedance of the C-type damped filter is given by:(13)Z¯Fh=RhXL−XLh2R2+hXL−XLh2+jR2hXL−XLhR2+hXL−XLh2−XChwhereXC=1/(ωC2). In addition, C1=C2 for the third-order andC1=1/(ω12L)for the C-type damped filters.Typical PPFs include the single-tuned filter, second-order damped filter, third-order damped filter, and C-type damped filter. Because single-tuned resonant filters comprise only LC components, their investment cost and power loss are lower than those of the damped filters with the same capacity, and they are easy to design. However, single-tuned filters are used to mitigate the harmonics at frequencies slightly higher than the resonant frequency of the filter. The impedance of damped filters approaches the value of their resistance at high frequencies, and therefore, they achieve better performance in terms of harmonic filtering at high frequencies. However, damped filters are usually used in cooperation with tuned filters for reducing investment and power loss. In fact, the design of PPFs is a multi-objective engineering problem. Because of the various non-linear constraints and objectives involved, significant effort and engineering experience are required to produce a good PPF design. In other words, cost and performance are the main considerations in a PPF design. In this paper, PPF design involves selecting a suitable combination of types of filters and determining the parameters of passive elements so that the requirements of harmonic attenuation, power factor compensation, investment cost, and other conditions are satisfied.Fig. 6shows a typical system with PPFs and nonlinear loads. The nonlinear loads are considered to be harmonic current sources, and the system network and PPFs are modeled as impedances. Other linear loads can be omitted because the impedances of linear loads are very large compared to those of the system network and filters. The quality of filtering performance for each harmonic will be represented by the harmonic attenuation factor defined as(14)γ≜IShIh=Z¯FhZ¯Fh+Z¯ShThat is, the smaller the harmonic attenuation factor, the greater is the harmonic current absorbed.The THDs of current and voltage are given by(15)THDI=∑h=2HIShIS12(16)THDV=∑h=2HVShVS12where h is the harmonic order; H is the highest harmonic order to be considered; Ishis the rms of the harmonic current through the system network; Vshis the rms of the harmonic voltage at the system bus; I1 is the rms of the fundamental current through the system network; and V1 is the rms of the fundamental voltage at the system bus.The initial investment cost (IC) of a filter depends mainly on the values of the internal elements (R, L, C) as follows [4]:(17)IC=∑i=14αi∑j=1Ni(k1Rij+k2Lij+k3Cij)where i denotes the type of filter; Niis the number of filters of type i; Rij, Lij, and Cijare the resistance (in Ω), inductance (in mH), and capacitance (in μF) of the jth filter of type i, respectively; k1, k2, and k3 are cost weighting coefficients in pu/Ω, pu/mH, and pu/μF, respectively; and αiis the set-number multiplier of the i-type filter. The cost-weighting coefficients and set-number multiplier are given in [4].The fundamental power losses in PPFs are mainly caused by the existence of resistors and can be expressed as follows:(18)PF=∑i=14∑j=1NiPFijwhere PFijis the fundamental power loss in the jth filter of type i.Maximize total fundamental reactive power compensation:PPFs can improve the power factor. For multiple filters, the total reactive power to be produced is given by:(19)QF=∑i=14∑j=1NiQFijwhere QFijis the fundamental reactive power produced by the jth filter of type i.(20)THDI≤THDIMax(21)THDV≤THDVMaxwhere THDIMaxand THDVMaxare the tolerable values.(22)HDIh≜IShIS1≤HDIh,max(23)HDVh≜VShVS1≤HDVh,maxwhere HDIh,max and HDVh,max are the tolerable values for each hth-order harmonic component.The total fundamental reactive power from all filters must satisfy the following constraint:(24)Qmin≤QF≤Qmaxwhere Qmin and Qmax are tolerable values.Each filter impedance must be inductive to its corresponding harmonics to be filtered in order to prevent series resonance with the system impedance. In addition, if multiple filters are installed on the same bus, the resultant impedance of all filters must also be inductive to all critical harmonics, which may cause harmonic resonance in the system.(25)ImZ¯FijhF>0(26)ImZ¯FhC>0where hFis the order of the harmonic to be filtered; hCis the order of the critical harmonic;Z¯Fij(hF)is the impedance of the jth-filter of type i at order hF; andZ¯F(hC)is the resultant impedance of all filters at the critical harmonic frequency of order h. In general, critical harmonics are harmonic components that cause violation of a specified standard before the filters are installed.Aging and temperature effects may alter the reactance and capacitance values of PPFs. All these variations cause detuning problems [4,5]. Perturbations can be defined as parameter variations in power systems and in a filter itself that could cause the filter to work less effectively than initially designed. When a filter branch has a fault, only this faulty branch is cut off, and the other branches should work normally. This abnormal operation condition may cause parallel or series resonance at the critical order harmonics. To avoid undesired resonance, all filter branches are cut off when a filter branch has a fault. The following perturbations should be considered for robust design [4]:•System frequency variation:(27)−1%≤Δff≤1%Inductance variation of a filter:(28)−3%≤ΔLL≤3%Capacitance variation of a filter:(29)−3%≤ΔCC≤3%Resistance variation of a filter:(30)−3%≤ΔRR≤3%In 2010, a novel metaheuristic optimization algorithm called BA was proposed by Yang [10]. The algorithm is inspired by microbats, which make use of sound echolocation during their flights to avoid obstacles or find prey. The BA treats potential solutions as virtual microbats whose velocities vi, positions xi, and frequencies Fican be updated as follows:(31)Fi=Fmin+Fmax−Fminβ(32)v¯ik+1=v¯ik+x¯ik−x¯*Fi(33)x¯ik+1=x¯ik+v¯ik+1where β is a random number distributed uniformly within [0,1]. Fmin and Fmax denote minimum and maximum frequencies, respectively. Vectorx→*is a global best solution obtained by comparing all objective functions at iteration k.For the local search, a new solution for each “bat” is generated by a random walk around the current best solution.(34)x¯i,newk=x¯i,oldk+εAikwhereAikis the average loudness of all bats and ɛ is a random number uniformly distributed within [−1,1]. The loudness Aiand pulse emission rate rican be updated as follows:(35)Aik+1=αAik(36)rik+1=ri01−exp−γkwhere α and γ are constants, usually 0<α<1 and γ>0. The constant α is similar to the cooling factor in the simulated annealing (SA) algorithm, which controls the convergence rate of the algorithm.In order to enhance the convergence of the algorithm, the original BA will be modified using the following velocity updating equation.(37)v¯ik+1=w⋅v¯ik+x¯*−x¯ikFiwhere w plays the same role as the inertia weight in PSO-based algorithms.In multi-objective optimization problems, there are many objective functions. It is desirable that all objective functions are minimized simultaneously. However, in most practical problems, some objectives may conflict with one another, and there is no single solution that can minimize all objectives simultaneously. Hence, in order to address those problems, Pareto optimality is considered. A multi-objective optimization problem can be expressed as(38)Minimizex→fi(x→)(i=1,2,…,nf)Subject to(39)gj(x→)≤0(j=1,2,…,ng)(40)hk(x→)=0(k=1,2,…,nh)wherex¯is the vector of decision variables,fi(x¯)is the vector of objective functions,gj(x¯)is the inequality constraint,hk(x→)is the equality constraint, nfis the number of objectives, and ngand nhare the numbers of inequality and equality constraints, respectively.In an optimization problem, a solutionx→1dominatesx→2if the following two conditions are satisfied.(41)∀i∈{1,2,…,nf},fix→1≤fix→2(42)∃j∈{1,2,…,nf},fjx→1<fjx→2A vectorx→*is a Pareto optimal solution iff→(x→*)is non-dominated by anyf→(x→)for everyx→. Pareto optimal solutions are also called efficient solutions, non-inferior solutions, or non-dominated solutions. All non-dominated solutions are used together to form the Pareto optimal set. The Pareto front is defined as the set of objective vectors of the Pareto optimal set as shown in Fig. 7.In multi-objective problems, many non-dominated solutions will be produced at each step. They are potential solutions that will be reported as final solutions. In order to store them for the final report, a common procedure applied in many PSO-based and evolutionary algorithms is to use a so-called external archive[13,14]. The archive must be updated at each iteration. The size of the archive is always limited.It is necessary to apply a selection mechanism to decide whether a new solution can be inserted into the archive. In the selection mechanism, an adaptive grid will be used to spread the non-dominated solutions uniformly along the Pareto front. The adaptive grid is actually the objective space divided into many hypercubes [15]. Fig. 8shows two non-dominated solutions and the adaptive grid of a two-dimension objective space. Each solution in the archive will have coordinates that depend on its own objective functions. When the external archive is full and a new non-dominated solution is inserted, a solution in the most crowded hypercube will be selected randomly and removed from the archive.In order to select a global best in the objective space, each nonempty hypercube will be assigned a fitness value obtained by dividing any number greater than one by the number of non-dominated solutions inside it. After that, a hypercube is chosen by applying roulette-wheel selection. Finally, the global best is selected randomly from this hypercube [15].The initial personal best is set equal to the initial position of each virtual bat. At each iteration, the new position of a bat will be compared to its current personal best. If they are mutually non-dominated, a random selection will be made.A flowchart of the proposed method is shown in Fig. 9. The pseudo code of the new multi-objective BA or MOBA is given as follows:Step 1: Initialize each batx→i,v→i, Fi∈[Fmin, Fmax], riand Aifor i=1, 2, …, n.Step 2: Evaluate the objective functions and constraints.Step 3: Store the first non-dominated solutions in the external archive.Step 4: While iter <= maximum number of iterationsSelect the g best by roulette wheel selection.Update frequencies, velocities and positions using (31), modified equation (37), and (33).Improve the local search by random walks using (34).Evaluate the objective functions and constraints.Store new non-dominated solutions in the external archive.Update pulse rates and loudness using (35) and (36).End while loop.An 11.4kV, 60Hz system was introduced in [4] and is shown in Fig. 10. The system is assumed to be balanced, and therefore, per-phase analysis can be performed. Before passive filters are installed, the measured harmonic currents and voltages are listed in Table 1. IEEE Standard 519-1992 should be applied at the interface points between system owners or operators and users in the power system. Users produce harmonic currents that flow through the system owner's or operator's system, which lead to voltage harmonics in the voltage supplied to other users. The tolerances are based on IEEE Standard 519-1992 [16]. The fundamental active power demand is 20MW with lagging power factor 0.65, and power factor improvement is required to be within lagging power factors 0.95 and 0.99. The short-circuit current is 19,695 A. The 2nd, 5th harmonic currents and 5th harmonic voltage violate the IEEE standard. The total harmonic distortions also exceed the tolerances. For harmonic mitigation, a single-tuned filter and a C-type damped filter will be adopted. In single-tuned filters, the resistance is usually omitted owing to its small value. The single-tuned filter is used to suppress the 5th harmonic components, whereas the C-type damped filter is adopted to deal with the 2nd and higher harmonic components. In the C-type damped filter, the capacitor C* connected in series with the inductor is designed to yield series resonance at a fundamental frequency to reduce fundamental power loss.The decision variable is defined asx¯i=[C1,R2,L2,C2]T. The number B of “bats” is selected as 20. The size of the external archive R is 100. The number of divisions in the objective space D is 30. The maximum and minimum frequencies are 2 and 0, respectively. The inertia weight w is set at 0.4. Both coefficients α and γ for updating the pulse rates and loudness are selected as 0.9.The proposed algorithm will be executed 50 times with 1000 iterations of each running time using MATLAB R2009b. The final solutions for the PPF design problem are shown in Fig. 11. The Pareto front obtained by the Monte Carlo method is shown in Fig. 12. According to the two figures, a low-initial investment cost corresponds to high current and voltage THD. A high initial investment cost seems to provide better reactive power compensation and harmonic suppression.In order to evaluate the accuracy of the proposed algorithm, the generational distance (GD) is used [17] as follows:(43)GD=∑i=1ndi2nwhere n is the number of final solutions and diis the euclidean distance in the objective space between each solution and the nearest member of the true Pareto optimal set. The smaller the GD is, the closer it is to the true Pareto front. The GD of the proposed algorithm was compared to that of the popular multi-objective PSO (MOPSO) introduced in [14,18–20]. According to Table 2, it is obvious that the proposed algorithm provides better results than those of the MOPSO.In order to confirm the efficiency of the algorithm, a solution of the proposed method is selected and compared with that obtained by the SA algorithm introduced in [4]. SA is a technique based on the annealing process of crystallization in physical systems. SA is very efficient at solving single-objective and combinatorial optimization problems. According to Table 3, the solution obtained by the proposed method yields better harmonic suppression and a higher power factor. In addition, the initial investment cost obtained by the proposed MOBA is lower than that of the SA algorithm. Table 4shows that the selected solution obtained by the proposed method yields the harmonic current and voltage distortions that satisfy IEEE Standard 519-1992.The filtering performance of the designed filters can be evaluated by a harmonic attenuation factor. For the selected solution, the harmonic attenuation factor is shown in Fig. 13. It is obvious that no resonance points (points with infinite impedances) can be found over the range of frequencies. Moreover, there are no harmonic currents at the critical point (point with largest attenuation factor). All harmonic currents to be filtered are actually attenuated to very small values. Hence, the resonance cannot occur during the operation of all filters.

@&#CONCLUSIONS@&#
