@&#MAIN-TITLE@&#
A data-driven approach to prostate cancer detection from dynamic contrast enhanced MRI

@&#HIGHLIGHTS@&#
A data-driven approach for analysis of the dynamic contrast enhanced MRI of prostate.No need for pharmacokinetic modeling and knowledge of the arterial input function.LASSO is used to find an optimal set of principal components of the T1 time course.The area under ROC curve increased from 0.78 to 0.86 with the data-driven approach.Prostate cancer probability maps are generated using the proposed features.

@&#KEYPHRASES@&#
Dynamic contrast enhanced MRI,Prostate cancer,PCA,SVM,LASSO,

@&#ABSTRACT@&#
Magnetic resonance imaging (MRI), particularly dynamic contrast enhanced (DCE) imaging, has shown great potential in prostate cancer diagnosis and staging. In the current practice of DCE-MRI, diagnosis is based on quantitative parameters extracted from the series of T1-weighted images acquired after the injection of a contrast agent. To calculate these parameters, a pharmacokinetic model is fitted to the T1-weighted intensities. Most models make simplistic assumptions about the perfusion process. Moreover, these models require accurate estimation of the arterial input function, which is challenging. In this work we propose a data-driven approach to characterization of the prostate tissue that uses the time series of DCE T1-weighted images without pharmacokinetic modeling. This approach uses a number of model-free empirical parameters and also the principal component analysis (PCA) of the normalized T1-weighted intensities, as features for cancer detection from DCE MRI. The optimal set of principal components is extracted with sparse regularized regression through least absolute shrinkage and selection operator (LASSO). A support vector machine classifier was used with leave-one-patient-out cross validation to determine the ability of this set of features in cancer detection. Our data is obtained from patients prior to radical prostatectomy and the results are validated based on histological evaluation of the extracted specimens. Our results, obtained on 449 tissue regions from 16 patients, show that the proposed data-driven features outperform the traditional pharmacokinetic parameters with an area under ROC of 0.86 for LASSO-isolated PCA parameters, compared to 0.78 for pharmacokinetic parameters. This shows that our novel approach to the analysis of DCE data has the potential to improve the multiparametric MRI protocol for prostate cancer detection.

@&#INTRODUCTION@&#
Prostate cancer is the second leading cause of cancer-related death among males [1]. Morbidity is often due to the metastasis of cancer from prostate to bones, which happens only in a small percentage of cases. However, the existing diagnostic techniques cannot adequately determine the stage of prostate cancer. The most commonly used method to detect prostate cancer is a transrectal ultrasound (TRUS) guided biopsy. Although, TRUS provides excellent details about the boundaries of the gland and bladder, it has a limited ability to accurately image prostate tissues and differentiate malignant from benign tissues [2]. As a result, TRUS-guided biopsy is essentially a blind, systematic procedure which suffers from gross sampling errors. Small cancers may be missed and large or multifocal tumors may be under-sampled (false negative) [3]. Due to the limitations of the existing diagnostic techniques, radical prostatectomy is often used in treating the disease, including instances when the cancer is either pathologically insignificant at one extreme or incurable at the other [4]. This surgery can impact a man's quality of life by causing urinary incontinence or sexual dysfunctions. Therefore, there is a need for more reliable techniques to confirm cancer location, extent and its stage, prior to deciding on the optimal course of treatment in a given individual. With reliable imaging techniques, approaches such as focal therapy and active surveillance of the patients with lower risk tumors, and avoidance of surgery in non-operable cases become possible.Since the mid-1980s, magnetic resonance imaging (MRI) has shown great potential in visualization and characterization of prostate anatomy using T2-weighted imaging [5–7]. However, the sensitivity and specificity acquired from conventional T2-weighted MRI is insufficient for prostate cancer diagnosis and particularly grading of cancer [8–10]. As a result, the addition of multiple MR modalities (multiparametric-MRI), such as spectroscopy, diffusion imaging, and perfusion imaging, are under study for better tissue characterization [11]. Among these, dynamic contrast enhanced (DCE) MRI is a very promising methodology [12]. The pharmacokinetic parameters extracted from DCE MR images provide physiological information about tissue microvasculature and may be linked to active cancer growth [13,14]. These parameters, when used in a supervised machine learning framework with diffusion tensor features [15,16], or with T2-weighted and diffusion weighted features [17], have shown great potential in prostate cancer detection.The pharmacokinetic parameters are extracted by fitting a model to the concentration values measured from T1-weighted intensities acquired after the injection of a contrast agent. The sequence of contrast agent concentration values is fitted to one of the several pharmacokinetic models that characterize the perfusion pattern. One of the most commonly used models is the two-compartment Kety model [18]. Accurate pharmacokinetic modeling of DCE MRI data also requires the knowledge of the concentration of the contrast agent in the external iliac or femoral arteries over time, which is known as the arterial input function (AIF). The extraction of AIF requires the segmentation of the cross section of the artery, which is a subjective process. There has been work done with population averaged AIF [18,19], but with limited temporal resolution of MRI, there is no significant difference between population averaged and individually measured AIF in terms of their diagnostic power [20]. Besides, the modeling process is sensitive to noise and fitting instabilities [21], and the fitting process is complex and difficult for clinical use [22]. Furthermore, most pharmacokinetic models make simplistic assumptions about the perfusion process in tissue. This issue has resulted in limited correlation between individual DCE parameters and the stage of the disease [23,24], despite the strong evidence of correlation between increase in microvasculature and the pathologic stage of cancer [25,26]. Therefore, there is a need for new methods for the analysis of the DCE T1-weighted intensities. We address this need by proposing a data-driven and model-free parameterization process for the DCE T1-weighted signal intensities. Model-free parameters are reported in the literature for breast and prostate DCE MRI [27,28]. In this paper, we further investigate this approach to develop a framework for MRI-targeted prostate biopsies.Our approach is to devise a learning agent that can detect cancer directly from the T1-weighted intensities without modeling the physical perfusion phenomenon. We investigated two different sets of parameters in terms of their capability to classify prostate cancers. The first set of parameters consists of six empirical model-free parameters that describe the shape of the kinetic curves of DCE T1-weighted signal intensity. The second set of parameters is generated by reducing the dimensionality of the T1-weighted intensities using principal component analysis (PCA). An important question in the use of PCA for feature reduction is the determination of the optimal number of components that will be included in the model. It is also not guaranteed that the components that can explain most of the variance of the data also provide the highest classification accuracy. So we have devised a new solution of extracting the optimal set of features from PCA. To reduce the dimensionality in the PCA space, we used a least absolute shrinkage and selection operator (LASSO) model, along with cross-validation to determine the most effective principal components. The resulting parameters were used with support vector machine (SVM) classification. These parameters were generated directly from the DCE MRI signal intensities and therefore do not make any assumption about the perfusion pattern. We compared the proposed features with the traditional pharmacokinetic parameters in terms of their ability to detect cancer. We show that the proposed framework of learning the tissue signature directly from T1-weighted intensities is a promising approach for cancer detection from DCE MRI data.The data used in this work was obtained in 2010–2011 for a multiparametric MRI study. The study was approved by the Clinical Research Ethics Board of the University of British Columbia and the patients had given their written consent before entering the study. These patients were scheduled for radical prostatectomy and they went through an MRI imaging session before their surgery. The MRI examination was scheduled 3–48 days before the surgery date. The mean time between the MRI session and the radical prostatectomy was 14 days for these patients. The patients recruited for this study had not received any form of therapy before their radical prostatectomy. Detailed information about the patients are given in Table 1.MRI examinations were performed on a 3Tesla MRI scanner (Achieva, Philips Healthcare, Best, The Netherlands) and the signals were acquired with a combination of an endorectal coil (Medrad, Pittsburgh, PA) and a cardiac phased-array coil (Philips Healthcare, Best, The Netherlands). Fast spin-echo T2-weighted images were acquired in the axial and coronal planes using repetition time (TR) of 1851ms and an effective echo time (TE) of 80ms with 14cm field of view (FOV) (284×225 matrix, 3 averages). Each slice was 4mm thick and there were no gaps between the slices. 12 axial slices were selected from this sequence and used for DCE MRI scans. T2-weighted images were used to identify the anatomical details of the prostate gland to match MR-slices with histology. The majority of the glands were smaller than 48mm along slice selection direction.DCE T1-weighted images were acquired using a three-dimensional T1-weighted spoiled gradient echo-sequence with a field of view of 24cm (TR/TE=3.4/1.06ms, flip angle=15°, 256×163 matrix, 2 averages). The contrast agent used here was Gd-DTPA (Magnevist, Berlex Canada) and 0.1mmol/kg of Gd-DTPA was injected with a motorized power injector within 10s at the rate of 2mL/s, followed by a 20mL flush of saline. To calculate the contrast agent concentration in the prostate, at first proton density (PD) images were acquired (TR/TE=50/0.95ms, flip angle=45°). Subsequently a series of 75 T1-weighted dynamics were acquired, where 3 dynamics were acquired before the injection of the contrast agent, and the remaining 72 dynamics were acquired following the injection of the contrast agent. The time resolution was 10.6s per dynamic and the slice thickness was 4mm. T1 values were calculated based on PD-weighted and T1-weighted images according to the procedure described by Parker et al [29]. DCE MRI data were processed off-line using Matlab (Mathworks, Natick, MA) and Igor Pro (WaveMetrics, Portland, OR).After imaging, patients went through surgery. The radical prostatectomy specimens were dissected and histopathologically examined in a uniform manner to acquire the whole-mount analysis. The external surfaces were inked, seminal vesicles were amputated, the apical and bladder neck tissue slices were removed and the specimens were dissected following a minimum of 24-h fixation in 10% buffered formalin. A device described in Drew et al [30] was used to cut the prostate gland from inferior to superior in serial transverse cuts perpendicular to the posterior capsule, at 4mm intervals, which allowed reasonably good correspondence between the pathology slides and the MR slices. The multi-bladed cutting device consists of an adjustable box that holds the prostate, a plunger tool that prevents rolling or sliding of prostate, and a knife assembly that holds the blades at 4mm intervals. Once the prostate specimen is placed on the base, the specimen is rotated manually to the orientation that produces the proper slice orientation. The adjustable box was designed to hold the prostate in the correct orientation for matching the MRI and the histology sections. The walls of the device and the plunger include vertical slots to allow the blades of the knife to pass through it. The slots are at 4mm intervals and the slots on opposite walls are lined up with each other to ensure parallel cuts. The blades of the knife assembly fit through the vertical slots in the adjustable box and cut simultaneously through the sample. The multi-blade device ensures that the histology sections are parallel to each other and exactly 4mm apart – requirements that are difficult to achieve with manual cutting using a single blade. In addition, careful positioning of the specimen inside the cutting device results in the orientations of the MRI slices and histology sections being very close to each other. Fig. 1shows different parts of the prostatectomy sectioning device.A Lieka RM2245 whole body rotary microtome was used to cut the whole mount sections and the sections were submitted as intact transverse sections mounted on oversize glass slides for hematoxylin and eosin staining. In the pathology slides, the regions of prostatic carcinoma were outlined and assigned a Gleason score by an anatomic pathologist with over 20 years of experience.Our tissue cutting protocol and device ensured that the histopathology slides and the T2-weigthed MR slices could be matched. However, due to shrinkage of the tissue after surgery, deformable registration was required to map the histology findings to the MR images. Registration of DCE images to T2-weighted images was also needed to compensate for the motion of the prostate during the prolonged DCE MRI scan. The whole-mount pathology slides were registered with the corresponding T2-weighted MR images by affine registration followed by deformable B-spline registration. T2-weighted images were also registered to the corresponding DCE-MR images following similar procedures. These two transformations were used successively on the pathology slides to register it to DCE-MR images. To register the images, the prostate region was manually segmented in both the fixed (MRI) and the moving images and registration was applied on the segmented region only. Mutual information was used as the similarity measure and adaptive stochastic gradient descent was used as the optimizer to guide the registration process. After registration, the computed transformations were applied to map tumor regions from the pathology slides to the corresponding T2-weighted and DCE-MR images. For registration, we used elastix, which is an open source software for image registration [31]. We used dice similarity coefficient (DSC) to validate the registration. The average DSC value between the pathology and T2-weighted images after registration was 0.94, and between registered T2-weighted and DCE image it was 0.95. Figs. 2 and 3show two cases where the tumor regions from the pathology slides are mapped to the corresponding T2-weighted and DCE MRI slices.The normal and cancer regions were mapped from the pathology slides to the corresponding DCE slides by registration and the mapped regions were then used to extract features. To extract features, these mapped regions were divided into square regions of interest (ROI) of size 4.7mm×4.7mm in the DCE image. The intensity values within each ROI were averaged and an average T1-weighted signal was formed. Thereby, each ROI was used to form one T1-weighted signal and the model-free and PCA features were extracted from this average T1-weighted signal. The true label (class) of the feature vector was determined from the pathology image. Fig. 4shows the kinetic curves of contrast agent concentration in the prostate. These curves are generated by averaging over all the ROIs of the tumor and normal regions. The difference in the pattern of perfusion is evident: the contrast agent concentration increases faster and stronger within the tumor.Radiologic evaluation of the DCE time course is typically performed by examining the kinetics of the concentration time course [2]. As part of our data-driven approach to parameterization of the DCE data, we extracted six model-free empirical features from the DCE T1-weighted signal intensities. These features were extracted from the relative signal intensity calculated by the following equation:(1)irel(t)=i(t)−ipreiprewhere ipreis the average pre-injection signal intensity over an ROI and i(t) is the average signal intensity at time t. Fig. 5shows the change in the relative intensity over time for a single ROI. The features extracted from the relative signal intensity, irel(t) are:Maximum signal intensity (Imax): defined as the peak relative signal intensity in DCE time course.Time-to-peak (tpeak): defined as the time to reach the maximum signal intensity.Onset time (tonset): defined as the time to reach 10% of the maximum signal intensity.Initial gradient (Δinitial): defined as the mean gradient from the time of injection to the time when the intensity is 10% of the maximum signal intensity.Mean gradient (Δmean): defined as the mean gradient calculated between the time points when signal intensity goes from 10% to 90% of the maximum intensity.Washout gradient (Δwashout): defined as the average rate of change in relative signal intensity from the maximum intensity to the end of the scanning period.An alternative approach to data-driven characterization of the DCE T1-weighted intensities is to use a dimensionality reduction method to convert the time series of normalized contrast enhanced T1-weighted intensities to an optimally sized vector of features. We used principal component analysis (PCA) for this purpose. PCA uses an orthogonal transformation to map a high dimensional data of possibly correlated variables into a low dimensional representation with linearly uncorrelated variables, called principal components. The first principal component has the largest variance, or it inherits the maximum variability of the data. Each successive component in turn accounts for the highest variance possible under the constraint that it is orthogonal to the preceding components [32]. For a p-dimensional data-set, PCA analysis gives p number of eigenvectors and projects the data into a p-dimensional principal component space. We use the notation I for the N×72 dimensional matrix obtained by the PCA transformation of the 72-dimensional T1-weighted intensities for all the N training ROIs.The 72-dimensional principal components extracted from the DCE T1-weighted intensities were ranked in terms of class separability using LASSO [33]. The L1-norm regression problem in our work was formulated as:(2)βˆ=argminβ12∑j=1N(yj−β0−∑k=1pIjkβk)2+λ∑k=1p|βk|where Ijkare elements of I, yjis the label (0 or 1) for the jth ROI, λ is the regularization parameter and the vector β includes the LASSO coefficients. This L1-norm regression forces some coefficients to zero. The 72 features are ranked according to the magnitude of their corresponding βk. To solve the regression problem, cylindrical coordinate descent algorithm was used [34] and the value of λ was determined by 10-fold cross validation on the entire dataset targeted to minimize the mean squared error. Among 72 PCA features, 32 components were identified as the significant features by LASSO with non-zero coefficients. Leave-one-patient-out cross-validation with forward search showed that the maximum area Under receiver operating characteristics Curve (AUC) was obtained when the 11 top-ranked PCA features were used together to train and test the classifier.In order to compare our data-driven approach to the traditional pharmacokinetic approach to prostate cancer detection, we generated pharmacokinetic parameter maps for the patients. AIF was extracted from the external iliac or femoral arteries in the center-slice of the DCE MRI data. The MR images used in this work were acquired using the 3D technique. This technique minimizes the blood in-flow effect, as opposed to the 2D multislice technique; and therefore slice selection has a minimal effect on the arterial input function. We selected the center-slice to extract AIF as this slice best visualizes the arteries. We used local population averaged AIF, called local Gaussian AIF [20], to calculate the pharmacokinetic parameters. Here the AIF is calculated in the form of two Gaussians plus an exponential function, as proposed by Parker [19], but fitted to the average of individual AIFs measured from the patients in our study.The extracted AIF was then used to calculate the pharmacokinetic parameters: volume transfer constant, Ktrans, fractional volume of extravascular extracellular space,ve, and fractional plasma volumevp. These parameters were calculated by fitting the extended Kety model to the contrast agent concentration curves [35]. Fitting was carried out in every pixel of every slice within a region of interest encompassing the prostate gland.The two-compartmental Kety model is a standard tracer kinetics model, which assumes that the tracer (contrast agent) can reside in two compartments: blood plasma space and extra-vascular extra-cellular space, EES (the assumption is that the tracer does not cross the cellular membranes). Following intravenous injection of a bolus of a contrast agent, the agent passes through the arteries and its concentration can be measured in the supplying arteries – this is known as the AIF. Transfer of the contrast agent from blood plasma to interstitial space is driven by the concentration gradient. Initially, when blood plasma concentration is high, the agent diffuses into EES through the capillaries microscopic pores. When the plasma concentration becomes lower than the EES concentration, the contrast agent diffuses back to the plasma space. Overall concentration of the agent (plasma+EES) is additionally affected by the clearance of the agent through kidneys and liver. The rate at which this transfer of contrast agent between plasma and EES occurs is known as the volume transfer constant, Ktransand it depends on the permeability of capillary wall and the flow of blood. In the flow-limited condition (i.e. when the vessels are very leaky and the contrast agent leaves the plasma space very quickly), Ktransequals to the blood plasma flow per unit volume of tissue. In the permeability-limited condition (i.e. when the vessels’ permeability is very low), Ktransequals to the permeability surface area product per unit volume of tissue. The fractional volumes of the EES and plasma compartments are known asveandvprespectively. Fig. 6shows the relative signal intensity pattern for two regions, with significantly different Ktransvalues. As can be seen from the figure, region with high Ktransexhibits higher and faster intake and faster washout rate than the region with low Ktrans. It should be noted that the pharmacokinetic parameters measure physical quantities such as the transfer rate. The transfer rate also drives the changes in the image intensity. As such, not surprisingly, as Fig. 6 shows, higher Ktransvalues can be attributed to a fast increase in the intensity after injection, followed by a fast decrease.Support vector machine (SVM) classifier was used to classify cancer and normal tissues with different feature combinations. SVM classifier constructs a maximum-margin hyperplane or a set of hyperplanes in a high-dimensional space to separate the input data into different classes. Typically, a kernel function is used with SVM to map the data into a high-dimensional space. The optimization process that trains SVM is based on maximizing the distance between the hyperplane and the nearest training data points (support vectors). In our work, we used a radial basis function (RBF) as the kernel. The RBF kernel was used due to its ability for nonlinear mapping of the data. RBF outperforms a linear kernel in terms of classification accuracy in our data. The classifier was a soft margin classifier where the cost or error penalty, c, and the RBF kernel parameter, γ, were the two parameters to tune. For the classifier we used LIBSVM, which is a C++ implementation of the SVM algorithm [36]. Since SVM is a non-probabilistic binary classifier, it cannot give a posteriori probability values. Therefore, in order to evaluate the a posteriori class probability based on SVM classification, we used the methodology proposed by Platt [37,38]. This method estimates the class probability in form of a sigmoid function of the estimated SVM hyperplane equation. The parameters of this sigmoid function were estimated using maximum likelihood estimation on the training data. By applying a cutoff threshold to the cancer probability value acquired for each ROI we were able to calculate confusion matrices and plot the receiver operating characteristic (ROC) curves.We investigated the performance of different feature combinations in classifying tumor tissues. Six different SVM classifiers were trained on the following combinations of the features: the six dimensional empirical model-free parameters, the five dimensional PCA features (consisted of the PCA features that can explain 97% variance of the data), the combination of empirical model-free features with pharmacokinetic parameters, the combination of 5-dimensional PCA and pharmacokinetic parameters, 11-dimensional LASSO-isolated PCA features and the three dimensional pharmacokinetic feature vector. For each of these cases, the SVM classifier was tuned by cross-validation. The cross-validation was performed on a leave-one-patient-out basis, where for each combination of c and γ the classifier was trained on 15 patients and tested on the other patient. This process was carried out for all of the patients with the cross-validation targeted to maximizing the total area under ROC. We investigated the possible combinations of c and γ by a grid search on c∈{2−10, 2−9.5, …, 210} and γ∈{2−10, 2−9.5, …, 210}.

@&#CONCLUSIONS@&#
