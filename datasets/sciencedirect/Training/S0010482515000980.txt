@&#MAIN-TITLE@&#
Allele frequency calibration for SNP based genotyping of DNA pools: A regression based local–global error fusion method

@&#HIGHLIGHTS@&#
A novel allele frequency estimation method.Machine learning based approach to estimation.A local–global error fusion method.

@&#KEYPHRASES@&#
Allele frequency calibration,DNA pooling,SNP genotyping,Microarray,Machine learning,

@&#ABSTRACT@&#
BackgroundThe costs associated with developing high density microarray technologies are prohibitive for genotyping animals when there is low economic value associated with a single animal (e.g. prawns). DNA pooling is an attempt to address this issue by combining multiple DNA samples prior to genotyping. Instead of genotyping the DNA samples of the individuals, a mixture of DNA samples (i.e. the pool) from the individuals is genotyped only once. This greatly reduces the cost of genotyping. Pooled samples are subject to greater genotyping inaccuracies than individual samples. Wrong genotyping will lead to wrong biological conclusions. It is thus required to calibrate the resulting genotypes (allele frequencies).MethodsWe present a regression based approach to translate raw array output to allele frequency. During training, few pools and the individuals that constitute the pools are genotyped. Given the genotypes of individuals that constitute the pool, we compute the true allele frequency. We then train a regression algorithm to produce a mapping between the raw array outputs to the true allele frequency. We test the algorithm using pool samples withheld from the training set. During prediction, we use this map to genotype pools with no prior knowledge of the individuals constituting the pools.Results and discussionAfter data quality control we have available a dataset comprised of 912 pools. We estimate allele frequency using three approaches: the raw data, a commonly used piecewise linear transformation, and the proposed local–global learner fusion method. The resulting RMS errors for the three approaches are 0.135, 0.120, and 0.080 respectively.

@&#INTRODUCTION@&#
Genotyping refers to the process of determining the differences in the genetic make-up (i.e. genotype) of the individuals of a species. SNPs (Single Nucleotide Polymorphisms) are one of the most common forms of genetic variation. SNP genotyping refers to the measurement of genetic variation of SNPs. A SNP refers to a DNA sequence variation at a specific locus (a specific location on gene) where a Single Nucleotide (A, T, C or G) in the genome differs between members of a species. These genetic variations within humans are commonly utilized in DNA fingerprinting (used in forensic science for identification of individuals by their DNA profile) or to provide genetic linkage to a disease to assist in drug development or identify an individual׳s susceptibility to the disease. Whilst there are a number of technology platforms available for SNP genotyping studies, the choice of platform is largely dependent upon the available budget, the number of samples being genotyped and the required coverage of the gene or genome for the study at hand.The real time PCR technology, TaqMan (PE Applied Biosystems), will genotype a single SNP per assay. Furthermore, the assay requires a highly specialized, labor intensive design of allele-specific oligonucleotides (ASO) probes for each SNP in order to produce optimal hybridization between alleles [14]. Hence, TaqMan is only attractive in studies with a very small number of polymorphic markers, given cost and labor scale linearly with the number of SNP. At the opposite end of the spectra, the Illumina and Affymetrix multiplex platforms genotype a significant number of SNPs per assay. The Illumina [5] and Affymetrix [8] platforms are comprised of an array of beads or chips, respectively, with a set of SNP specific oligonucleotides probes placed upon each element. Such platforms are suited to genome wide association studies, particularly for humans, given a chip such as the Illumina Human Omni5 Beadarray can genotype over four million polymorphisms in the human genome. One of the main issues with high density array technologies, however, is the level of prior knowledge that is required to design an array for species where gene or genome coverage of polymorphic markers have yet to be determined. In this case, a low to medium density SNP platform with multiplexing is more a cost effective compromise. The Sequenom iPLEX platform [4] genotypes between tens and hundreds of SNP per assay and is a low cost technology for custom, low density studies. The platform utilizes a reaction where primers adjacent to SNP loci are extended with a terminator neuclotide (ddNTP) from a set of ddNTP of different masses. The platform then uses MALDI-TOF (matrix assisted laser desorption and ionization-time of flight) mass spectrometry to detect alleles by exploiting differences in the mass of reaction products. The Sequenom iPLEX platform is utilized in this paper to investigate calibration strategies for low cost genotyping technology.In addition to the coverage aspects of the study design, the number of samples to genotype is of critical importance. In many SNP based association studies, sufficient samples need to be genotyped to obtain the statistical power necessary to achieve meaningful results. This is often an expensive and labor intensive exercise. DNA pooling is a practical attempt to improve the efficiency of SNP genotyping by combining multiple DNA samples prior to genotyping [13]. Each pool of N samples is genotyped as a single sample reducing the cost of assays by up to a factor of N. For genotyping individuals, platforms commonly use algorithms to convert their continuous intensity measurement of a SNP into a discrete call of one of three possible pairs of allele. Such calls are not informative for DNA pools given that the intensity measurement represents one of 2N+1 possible allele calls. Consequently, when DNA pools are used, the output intensities must be acquired to compute a quantitative genotype for each SNP. This quantitative genotype is known as its allele frequency.Despite the improvement in cost and efficiency, a major shortcoming of pooled DNA samples is that allele frequency estimates are more sensitive to measurement error than the calls of individual samples [13,10,2]. The sources of error associated with DNA pooling include pool construction, biochemical reactions and allele frequency estimation [1]. Pool construction error is associated with the process of trying to obtain equal concentrations of DNA from the samples and then mix these in equal volumes to form the pool. For the biochemical reaction associated with PCR amplification of target DNA, one allele might be more efficiently amplified than the other allele. This differential amplification is a major source of error as its causes the signal that represents the more efficiently amplified allele to be higher than its expected value, thereby inflating its estimate in the pooled DNA sample. Finally there is an analytical error associated with attempting to model the effects of differential amplification in allele frequency estimation. Whilst individual samples are subject to the same measurement errors as pooled samples, this noise is not significant enough to change the allele call of individual samples. The continuity of allele frequency estimates, however, makes the pooled samples far more susceptible to being distorted by noise.A number of works in the current literature are aimed at solving this problem. In [15] the coefficient of preferential amplification/hybridization (CPA) is used to quantify the degree of bias. The ratio of average peak intensities between two alleles was used as the bias factor. It was found that bias introduced through preferential hybridization was adequately modeled using lognormal distributions. This results in reduced error of allele frequency estimation for the human genome. A general linear model that accounts for the nested structure of the data was used in [9] for SNP genotyping. It is not required to know the CPA in [9]. It thus avoids the need for individual SNP genotyping to determine allelic ratio of hybridization. This offers scaling up to arrays with many thousands of SNPs. The piecewise linear interpolation of pooled alleles was used in [11] to correct for the bias in pooled DNA data of the human genome.In this paper, a novel calibration method is proposed to reduce the measurement error associated with a low cost SNP genotyping approach. More precisely, local and global errors are treated differently with our proposed method. Local errors relate to issues that are specific to each SNP. For instance, differential amplification of alleles during PCR and signal to noise ratio issues associated with allele detection using mass spectrometry. The global error relates to errors that are common to all of the SNPs in the assay. Biochemical artifacts are independent of any specific SNP and are one kind of global error [11]. We designed two separate regression algorithms to calibrate allele frequency estimates: (i) one for a specific SNP to deal with local errors, and (ii) one across all the remaining SNPs to deal with global errors. The estimates from this stage are combined into a single allele frequency estimates by a fusion predictor. Experimental results demonstrate the effectiveness of the proposed method by producing accurate estimates of the allele frequencies. Such solutions will be useful for new applications or studies where there is little prior genomic knowledge available and where study budget is limited.Given the DNA sample, the genotyping process (e.g. from iPLEX platform) generates a (x, y) pair (Fig. 1) for each SNP, where x and y are the average peak intensities of the two alleles. The (x, y) pair for an individual (Fig. 1(a)) can fall in either of three clusters. The (x, y) pair for a pooled DNA sample (Fig. 1(b)) can fall into any of the 2N+1 clusters if constructed from N individuals. Because of the PCR process and different errors, a change in (x, y) values is likely to call a wrong allele frequency (different cluster) with a high probability for a pool (because of small gap between clusters) and the following biological conclusions are likely to be wrong. We thus propose a method to correct the allele frequencies. Given the alleles of individuals that constitute the pool, we compute the true allele frequency and train a regression algorithm to produce a mapping between raw array outputs to the true allele frequency. We then use this map to genotype pools with no prior of the individuals constituting the pools. We detail the proposed method next.Given a pair of intensities(x,y)produced by the genotyping machine for a pool, the objective of the regression based calibration process is to produce an estimate of the allele frequencyf^. Given a pooled samplek(where1≤k≤NPandNPrepresents the number of pools), the genotyping machine produces an x– and y– intensity pair for each SNP. Let(xik,yik)present an x– and y– intensity pair of poolkfor SNPiwhere1≤i≤NSandNSrepresents the maximum number of SNPs. In order to produce the training set for a regression algorithm, the true allele frequency estimate of the pools is also required. Let the poolkbe composed ofNI(k)individuals and the B allele count of individualjfor SNPiin poolkbebi,j(k)where1≤j≤NIandbi,j(k)∈{0,1,2}. The true allele frequency estimatefikof the poolkfor SNPican be computed as:(1)fik=∑j=1NI(k)bij(k)NI(k)A regression algorithm can be provided with a set of vector(xik,yik,fik)where x– and y– intensity pair acts as input and the true allele frequency estimatefikcan as target. Given a set of vectors(x,y,f)a supervised learning algorithmΓlearns a map(2)Γ(x,y)=fi.e. given a pair of intensities(x,y)it produces an estimate of the allele frequencyf^.When DNA samples are pooled together and go through the hybridization process, errors can be introduced from different sources. These errors can be grouped into two categories: (a) local error: that affects a specific SNP (e.g. differential amplification), and (b) global error: that are not tied to specific SNP (e.g. biochemical artifacts). When doing the calibration it is thus required to consider both of these error sources.We thus propose a two-step calibration process to estimate the allele frequency (Fig. 2). A local learnerΓLis trained on the intensity patterns of all the pools for an SNPiand a global learnerΓGis trained on the intensity patterns of all the pools for all the remaining SNPsjwherej≠i. As mentioned previouslyΓLandΓGcompensate for the local and global errors respectively. Given a pair of intensities(x,y),ΓLandΓGproduce estimate of the allele frequencyfLandfGrespectively. A new training set is generated where the sample vectors are(fL,fG,f). A fusion predictor is trained on this new training set to fuse the local and global predictions into final allele frequency estimatef^.Two genotyping experiments were conducted each using the same Sequenom iPLEX panel which generated results for 61 SNPs. In the first experiment 1041 individuals and 22 pool samples were genotyped. The pool sizes varied between 18 and 26 individuals all drawn from the 1041 individuals. A second experiment was conducted to allow a quality control preprocessing step on the first experiment data set. The need for a quality control is a consequence of errors in the genotyping process for particular SNPs. The Sequenom iPLEX panel generates pairs of raw measurements (i.e. x and y values) from the primer extension products of each SNP loci using MALDI-TOF spectrometry. The x and y values generated by the MALDI-TOF spectrometer are the peak intensities in the mass spectrum that correspond to the SNP alleles.Two types of error were present in the results: low signal level error and erroneous x and y values. The effect of these errors needs to be minimized before any assessment of calibration approaches can be conducted. The errors vary across the SNPs being assessed and from sample to sample. Therefore the simplest approach is the removal of the most erroneous SNPs and samples from the test set.Low signal error could be removed by requiring a minimum threshold to be reached in amplitude of the x and y signals such as in [18]. However, we note both low signal levels and erroneous x and y errors manifest themselves as either no call or incorrect calls by the Sequenom system. Therefore call accuracy is used to identify bad samples (samples that are not correctly called by many SNPs) and bad SNPs (SNPs which fail to detect many samples). Call accuracy is quantified by comparing the call results from the large experiment with the more stringent experiment.A sub set of 78 individuals from the first experiment were genotyped under a strict experimental regime to ensure minimal errors were committed during the genotyping process. The allele calls for the individuals were compared with those in the main data set calls.Fig. 3 shows the performance of each SNP in terms of the number of correct SNPs (call identical to call in the stringent experiment), and the number of samples that were not called, but were called in the stringent experiment (“no call to call” SNPS). Trend lines for the best performing SNPs are plotted. The number of “no call to call” SNPs joins the trend line after the worst 13 SNPs. Therefore the worst 13 performing SNPs were identified as bad and removed from the first experiment data set leaving 48 SNPs. Note that we have used the data from the first experiment only in the regression algorithms. The data from the second experiment is used for quality control only.The performance of the individual samples is highlighted by plotting the fraction of individuals that achieved a given fraction of SNPs calls (Fig. 4). Linear trend lines for the best and worst regions show a transition between the two regions between 70–90% of SNPs called. 0.8 was selected as a threshold for required fraction of SNPs called and individuals not achieving this call rate were culled leaving 850 individuals. The same approach was applied to pools resulting in 19 valid pool samples.Finally a baseline x, y RMS error (0.065) was estimated by the inclusion of duplicate samples in the first experiment by comparing the x and y values over the remaining SNPs.We used regression algorithm as a local and global predictor in Fig. 2. The outcomes of the local and global predictors are fused into a single prediction using another regression method. We have implemented a number of regression algorithms including Linear Regression, SVM, and MLP to evaluate the effectiveness of the proposed allele frequency estimation method. The algorithms and their parameter settings are presented inTable 1. The same regression algorithm was used in local, global, and fusion predictor. The WEKA and libSVM functions were called from MATLAB for implementation purposes. We have used leave-out-one approach to test the results. Leave-out-one is a cross validation approach. In cross-validation approach, a segment of the data is left out for testing and the remaining data is used for training. In this way, the training and test data becomes completely separate. In order to reduce the bias, an n-fold cross validation is done, where the data is divided into n different folds. Each fold becomes a test set in turn and the remaining folds are concatenated to form the training set. The average accuracy on all the n folds is reported. In case of leave-out-one approach, the number of folds equals the number of samples.

@&#CONCLUSIONS@&#
In this paper we have presented a regression based approach to calibrate the allele frequency estimates for SNP genotyping of pooled DNA samples. The errors in genotyping process affect the estimates on the pools more than the individuals. We grouped the errors into two categories: local and global. Local errors are specifics to SNPs and global errors affect all the SNPs. We have designed two separate regression algorithm based allele frequency estimator to deal with these two different sources of errors. The estimates generated by these two predictors are fused into a single estimate by a fusion predictor at stage two. The proposed calibration method achieves better allele frequency estimate accuracy compared to the well known estimation methods. In future we aim to design a parametric approach where each source of error can be expressed as a parameter. This will assist in understanding the influence of different sources of error on the estimated allele frequency.I worked in Monash University and Central Queensland University before. I am now working for CSIRO. I am also working in collaboration with some professors in University of New South Wales and Deakin University. Reviewers from these institutions should be avoided.