@&#MAIN-TITLE@&#
A new adaptive multiscale method based on the estimate of residual forces for static analysis of heterogeneous materials

@&#HIGHLIGHTS@&#
A new adaptive multiscale method (AMM) is developed.The estimate of residual force is taken as local relative error indicator.The validity of the proposed algorithm has been verified.Nearly optimal distribution of macroscopic nodes can be found by using AMM.

@&#KEYPHRASES@&#
Heterogeneous materials,Adaptive multiscale method,Multi-node extended multiscale finite element method (multi-node EMsFEM),Residual force,Multiscale computation,

@&#ABSTRACT@&#
A new adaptive multiscale method (AMM) is developed based on the estimate of residual forces for static analysis of heterogeneous materials. The AMM is established by combining multi-node extended multiscale finite element method (multi-node EMsFEM) with a new proposed macroscopic node adaptive algorithm. In our previous multiscale computations, macroscopic nodes are placed uniformly along each edge of multi-node coarse element without considering local strain or displacement gradient. In this paper, to optimize the distribution of macroscopic nodes, a new adaptive algorithm is proposed based on the estimate of residual forces. Numerical experiments have indicated that residual forces exist even for linear elastic problems. For boundary external loading cases, residual forces only exist on the edges of coarse element. Besides, computations indicate that residual forces can reflect local relative errors in the multi-node EMsFEM computations. Thus it is reasonable and suitable to take residual forces as local relative error indicators in the multi-node EMsFEM computations. Finally, the AMM is developed based on this idea. To verify the validity of this proposed method, three typical numerical examples are carried out. The examples demonstrate that nearly optimal distributions of macroscopic nodes can be obtained by employing the proposed AMM.

@&#INTRODUCTION@&#
As is well known, composites are more and more widely applied in the aeronautics, astronautics, automotive and other industrial areas due to their excellent performances. Almost all composites have multiscale features [1,2]. The schematic diagram of heterogeneous materials is shown inFig. 1, in which the minimum material sizeεis usually much smaller than the unit cell sizeh. Therefore, the grids must be refined to make their size smaller than the minimum material size when calculating the mechanical behaviors of the composite structures with complex microstructures by using direct methods, such as the finite element method (FEM) and the finite difference method (FDM). It will cost lots of computational resources. In this context, many multiscale computation methods which can not only save computational resources but also ensure computational accuracy have been developed in recent decades, such as the computational homogeneous method [3–7], the representative volume element method [8–12], the heterogeneous multiscale method [13–15], the multiscale quasicontinuum (QC) method [16–20], the multiscale finite element method (MsFEM) [21,22] and its branches [23,24].To capture local properties of heterogeneous materials more accurately and reasonably, many adaptive algorithms have been presented to solve the multiscale problems with localized effects. Abdulle and Nonnenmacher [25] presented a posteriori error analysis for the elliptic homogenization problems discretized by the finite element heterogeneous multiscale method. Jenny et al. [26] developed an adaptive multiscale finite-volume (MSFV) method for the multiphase flow and transport in heterogeneous porous media. Larson [2] developed a new adaptive multiscale finite element method using the variational multiscale framework together with a systematic technique for approximation of the fine scale part of the solution. Zheng et al. [27] studied the stationary incompressible Navier–Stokes equations using the variational multiscale (VMS) method with h-adaptive technique. Ghosh et al. [28] developed an adaptive concurrent multi-level computational model for multi-scale damage analysis of composite structures due to the de-bonding at the fiber–matrix interface. Vernerey and Kabiri [29] employed and extended this model for the elasticity problems with periodic microstructures. More recently, Vernerey and Kabiri also performed this model for fracture and crack propagation in heterogeneous media [30]. Temizer and Wriggers [31] performed a finite deformation analysis of microscopic heterogeneous structures using an adaptive multiscale resolution strategy based on the homogenization formulations. Lee et al. [32] described a sequential implicit multiscale finite-volume framework for coupled flow and transport with general prolongation and restriction operations for both pressure and saturation where three adaptive prolongation operators for the saturation are used. He and Ren [33] presented an adaptive multiscale finite element method for solving the unsaturated water flow problems in heterogeneous porous media with many scales. Hajibeygi and Jenny [35] introduced a space-time adaptive iterative multiscale finite volume method for the multiphase flow problems.To investigate the static and dynamic problems of heterogeneous materials uniformly, Zhang and Liu [36,37] developed a multiscale method to solve multiscale problems in computational solid mechanics. A multi-node coarse element was presented by them to simulate the mechanical behaviors of heterogeneous materials with complex deformation. Besides, by virtue of this multi-node coarse element, Liu [34] presented a p-adaptive multiscale algorithm, established based on the relative error estimate of strain energy density of the coarse element between two adjacent iterative steps, to find out a nearly optimal distribution of macroscopic nodes on the fixed coarse-scale meshes.In this paper, we develop a new adaptive multiscale method based on the estimate of residual forces for static analysis of heterogeneous materials. This adaptive algorithm can be implemented easily by comparison with the aforementioned ones. It is promising to popularize this method in computational engineering fields. By using this new adaptive method, the macroscopic nodes can be distributed reasonably and automatically according to the practice needs. This is to say that: more nodes will be placed on the domain with larger displacement gradient, and fewer will be distributed at the region with smaller displacement gradient.This paper is organized as follows. In the next section, the multi-node EMsFEM is reviewed briefly and the construction processes of numerical base functions of multi-node coarse element are introduced. In Section 3, the residual forces in the multi-node EMFEM computations for static analysis of heterogeneous materials are investigated in detail. In Section 4, the macroscopic nodes adaptive algorithm is presented based on the estimate of residual force. In addition, to verify the reasonableness and effectiveness of the presented algorithm, some typical numerical examples are carried out in Section 5. Finally, some conclusions are given in Section 6.To solve the multiscale problems in computational solid mechanics, Zhang et al. [38] developed extended multiscale finite element method (EMsFEM). The main idea of EMsFEM is to construct the multiscale base functions numerically by solving static equilibrium equations on sub-grids in different directions separately. These functions can capture the microscopic heterogeneous properties of materials effectively and efficiently. Finally, the original problems will be only solved at the macroscopic scale, which can reduce computation cost significantly. It should be mentioned that deformations in the different directions are coupled to each other due to the Poisson effect in solid mechanics. In EMsFEM, this coupling effect is taken into consideration and the additional coupled items are introduced into the numerical base functions. Lots of numerical examples have indicated that these items can improve computational accuracy significantly.The sketch of EMsFEM is depicted inFig. 2, where the fine-scale mesh is given for the reference solution computation by using FEM and the coarse-scale mesh is provided for the multiscale computation by employing EMsFEM. The multiscale base functions are generated on sub-grids numerically. More detailed introductions can be seen in Ref. [38].Furthermore, in order to simulate the multiscale problems with complex deformation effectively, a new multi-node coarse element has been presented by Zhang and Liu [34,36,37]. In this paper a 7-node coarse element (shown inFig. 3) is taken as an example to explain the generation processes of its multiscale numerical base functions clearly.Obviously, there are more than or equal to two macroscopic nodes distributed on each edge of multi-node coarse element. The construction processes [36,37] of multiscale base functions can be divided into three steps as shown inFig. 4. Firstly, the oscillating boundary valuesLixk(i=1–4,k=1–2)are obtained by using the oversampling technique. Then the piecewise oscillating boundary functionshk,ixmof multi-node coarse element are calculated by linear combination of the oscillating boundary values which are obtained in the previous step. Finally, the multiscale base functions will be calculated by solving static equilibrium equations on sub-grids with the prescribed displacement boundary conditions which are composed of the piecewise oscillating boundary functions selectively. More details can be found in Ref. [36]. For static problems, the multiscale base function matrix can be written as(1)N=[N1xxxN1xyy⋯N1yxxN1yyy⋯⋯NnxxxNnxyy⋯NnyxxNnyyy]wherendenotes the number of macroscopic nodes of multi-node coarse element;NixxxandNiyyyare the displacement interpolation functions of multi-node coarse element in the x and y directions, respectively; andNiyxx(Nixyy) represents the additional coupling item. Its physical meaning is that the displacement values of microscopic nodes on sub-grids in the y direction are caused by the Poisson effect when imposing a unit displacement on the macroscopic node i in the x direction. The values of the additional coupling items will become zero at the edges of multi-node coarse element. The dimensions ofNixxxandNiyxxare allns×1, wherensis the number of microscopic nodes on sub-grids.In addition, the constructedNixxx(Niyyy) can satisfy the Kronecker delta properties, i.e.(2)Nixxx(Xj)=δij={1(i=j)0(i≠j)whereXjrepresents the coordinate of the macroscopic node j.Nixxx(Niyyy) is equal to 1 at the macroscopic node i, while equal to 0 at the other macroscopic nodes. The multiscale numerical base functions of a 7-node coarse element are shown inFig. 5.After constructing the multiscale base functions, the displacement relationship between the microscopic nodes on sub-grids and the macroscopic nodes of corresponding multi-node coarse element can be given as(3)us=NUcwhereusandUcare the displacement vectors of microscopic nodes on sub-grids and the macroscopic nodes of corresponding multi-node coarse element, respectively.Once the base functions are generated, the equivalent macroscopic matrices and vectors of multi-node coarse element can be calculated easily. The static equilibrium equation of sub-grids in finite element discrete form is expressed as(4)Ksus=FswhereKsandFs, obtained by using the standard FEM, are the stiffness matrix and external force vector of sub-grids, respectively.The equivalent static equilibrium equation of multi-node coarse element can be obtained by substituting Eq. (3) into Eq. (4) and multiplying on the left of Eq. (4) by vectorNTon both sides of Eq. (4), i.e.(5)KcUc=FcwhereKcandFcare the equilibrium stiffness matrix and external force vector of multi-node coarse element respectively, which can be given as(6)Kc=NTKsN(7)Fc=NTFsThen, the global stiffness matrix and external force vector of overall coarse-scale mesh can be assembled by(8)KG=Ac=1NcKc(9)FG=Ac=1NcFcwhereArepresents the assemble operator which is usually used in the traditional FEM.Finally, the original multiscale equation on the fine-scale mesh is converted into the equivalent equation on the coarse-scale mesh which can be written as(10)KGUG=FGwhereUGis the displacement vector of macroscopic nodes in the coarse-scale mesh.Furthermore, the microscopic displacement vector can be evaluated by virtue of Eq. (3), i.e., the downscaling technique as described in Ref. [38]. Naturally, the microscopic stress and strain can also be calculated according to the microscopic displacement vector of sub-grids.The macroscopic node displacement vectorUGcan be easily evaluated from Eq. (10). Then, the macroscopic node displacement vector of a single multi-node coarse elementUccan be extracted from vectorUG. Then the microscopic node displacement vectorusof sub-grids corresponding to the multi-node coarse element will be evaluated from Eq. (3) naturally. Furthermore, the displacement vectorueof a single fine-scale element in the sub-grids will be extracted fromus. Therefore, the microscopic strain and stress information of a single fine-scale element, i.e.,εeandσe, can be also calculated according toue.The internal force vectorpeof a single fine-scale element in the sub-grids can be evaluated by(11)pe=∫VeBeTσedVwhere the subscript ‘e’ denotes the single fine-scale element in the sub-grids;Beis the differential operator matrix and its dimension is3×8for the 4-node plane element in computational solid mechanics.The internal force vectorPsof overall sub-grids will be assembled by(12)Ps=Ae=1nspewherensdenotes the number of fine-scale elements in sub-grids.Thus, the residual forceRsof sub-grids corresponding to the multi-node coarse element is defined as(13)Rs=Fs−PswhereFsis the external force vector imposed on sub-grids.A large number of numerical experiments have indicated that the value of this residual force vector is non-zero even for linear elastic problems. A simple numerical example as shown inFig. 6 is carried out to illustrate this phenomenon. All the computational parameters in this example are dimensionless.The coarse-scale mesh and boundary conditions of computational model are shown in Fig. 6 where the magnitude of uniform distributed load isq=105. The length and height of model areL=14.4andH=10.8, respectively. A periodic unit cell with two kinds of materials is shown in Fig. 6(b), where Materials A and B represent the matrix and fiber, respectively. And Young׳s moduli of matrix and fiber are105and107, respectively. Poisson׳s ratios of these two materials are all equal to 0.3. Besides the fiber is placed at the center of matrix and its diameter is 1.2.The 4-node coarse element as shown inFig. 7 is employed to calculate the residual forces in this multiscale computation. The distribution of residual forces is shown inFig. 8, from which it can be found that(1)the residual forces only exist on the edges of coarse element for this boundary external loading case;the distribution of residual forces is localized and non-uniform, i.e., their magnitudes are non-uniform at different regions.In this paper, only the boundary external loading case is taken into consideration. The relative magnitude of residual forces of whole computational model is defined by(14)Rrf=∑k=1nf[(Rxk)2+(Ryk)2]2∑k=1nf[(Fxk)2+(Fyk)2]2whereRxkandRyk, which can be extracted from the vectorRs, represent the residual forces of the microscopic nodekof fine-scale mesh in the x and y directions, respectively. Similarly,FxkandFykare the external forces in the x and y directions of the microscopic nodekof fine-scale mesh.nfis the number of microscopic nodes of fine-scale mesh.In addition, to investigate the computational accuracy, the relative error of displacement field obtained by employing the multi-node EMsFEM is also defined by(15)REdis=∑k=1nf[(uFk−uMk)2+(vFk−vMk)2]2∑k=1nf[(uFk)2+(vFk)2]2whereuandvare the displacements in the x and y directions, respectively. The subscripts ‘F’ and ‘M’ denote the solutions obtained by the traditional FEM on the fine-scale mesh (reference solution) and the multi-node EMsFEM on the coarse-scale mesh (multiscale solution), respectively.To study the effects of the number of macroscopic nodes of multi-node coarse element on the multiscale computation results, several multi-node coarse elements (as shown in Fig. 7) with uniform distributed macroscopic nodes are chosen to proceed the multiscale computations by using the multi-node EMsFEM based on coarse-scale mesh. The numbers of macroscopic nodes distributed on each edge of multi-node coarse element are 2, 3, 4, 7, 10, and 19.The variation trends of relative magnitude of residual forces and the relative error of displacements with increasing the number of macroscopic nodes of each multi-node coarse element are shown inFigs. 9 and 10, respectively, where ‘EMsn’ denotes the multi-node EMsFEM computation results andnrepresents the number of macroscopic nodes of each multi-node coarse element. From these figures, it can be found as follows:(1)The relative magnitude of residual forces and the relative error of displacements defined in Eqs. (14) and (15) are decreasing nonlinearly with increasing the number of macroscopic nodes of multi-node coarse element.RrfandREdisare decreasing by a larger amplitude at the beginning stage compared with the following stable one.RrfandREdisare 0.99 and 9.13% for EMs4. But they become only 0.079 and 0.16% for EMs24. Thus a huge decrease is achieved during the beginning stage. After this, the curves become more and more stable.From the above analysis, it can be seen that the number of macroscopic nodes has a great impact on the multiscale computational accuracy. But how to determine the number and distribution of macroscopic nodes is still a problem. For EMs24 (each coarse element with 24 uniformly distributed macroscopic nodes), the distribution of macroscopic nodes on the fixed coarse-scale mesh is shown inFig. 11, from which we can see that the nodes are placed uniformly along the edges of coarse elements.However, the realistic displacement gradient of structure is usually non-uniform in fact. Therefore, it is unreasonable to place all the macroscopic nodes uniformly along the edges of coarse elements. The distribution density of macroscopic nodes should be varying according to the localized strain or displacement gradient. A logical and reasonable practice is to place more macroscopic nodes at the region with higher level strain or displacement gradient and fewer nodes at the region with lower level one. For this purpose, a new adaptive algorithm is presented in the next section.In order to develop a new adaptive algorithm to obtain a logical and reasonable distribution of macroscopic nodes, a local relative error indictor should be defined to determine where the macroscopic nodes should be refined. Since the residual forces have the localization characteristic and can reflect the local relative error of deformation, it is suitable and reasonable to take the estimates of residual forces as the local relative error indictors. In addition, the residual forces are only distributed along the edges of coarse elements for the problems with external boundary loading conditions. The estimate of residual force is given as(16)Θci=∑k=1nci[(Rxk)2+(Ryk)2]2whereΘciandncidenote the estimate of residual force and the number of microscopic nodes on the edge i of the coarse element c, respectively.The process of the macroscopic node elevating is illustrated inFig. 12. Before the elevating, it is necessary to calculate the value ofΘcifor each edge of each coarse element. Then a macroscopic node will be added on the boundaryΓof coarse element with maximum estimate of residual force among all the valuesΘci(i=1~4, c=1~Nc) until the number of macroscopic nodes on the boundaryΓis equal to the prescribed value. Once a node is added on the boundaryΓ, all the nodes onΓwill be re-distributed uniformly as shown in Fig. 12. Therefore, the multiscale numerical base functions of multi-node coarse elements which are sharing the boundaryΓshould be re-constructed after the macroscopic node elevating due to the change of the number of macroscopic nodes on the boundaryΓ.In order to determine whether this adaptive algorithm is convergent, the relative error of multiscale displacement results of two adjacent iterative steps is defined as(17)Rdisi=∑k=1nf{[(uMk)i−(uMk)i−1]2+[(vMk)i−(vMk)i−1]2}2∑k=1nf{[(uMk)i−1]2+[(vMk)i−1]2}2,(i=1,2,3,…)whereiis the iterative step;(uMk)0and(vMk)0are the displacement components of initial multiscale solution in the x and y directions, respectively. The iterative processes will be terminated once the above defined relative errorRdisiis less than the prescribed small tolerance.The flow chart of this adaptive algorithm is depicted inFig. 13. And it can be implemented in the following steps:1.Construct the multiscale base functions of coarse elements in the initial coarse-scale mesh which are usually composed of four-node coarse elements;Calculate the macroscopic equivalent stiffness matrix and load vector of each initial coarse element by virtue of the constructed multiscale base functions;Solve the equivalent macroscopic static equation of initial coarse-scale mesh and obtain the initial microscopic displacement solution by using the downscaling technique. Besides, let the iterative step be equal to one, i.e.,i=1;Evaluate the relative error index parameterΘcjof each multi-node coarse element to determine where to add the macroscopic nodes;Add a macroscopic node on the boundaryΓwith maximum relative error index parameter and renew the macroscopic node information;Reconstruct the multiscale base functions of the multi-node coarse elements which are sharing the boundaryΓ;Solve the equivalent macroscopic static equation of coarse-scale mesh with the updated macroscopic node distribution and obtain the microscopic displacements by employing the downscaling technique;Determine whetherRdisiis less than the prescribed toleranceεdis. Proceed step 9 if it is, otherwise let the iterative stepi=i+1and go to step 4;Compute the microscopic strain and stress solutions of coarse-scale mesh with the final adaptive macroscopic node distribution.In this section, some typical numerical examples are carried out to investigate the performance of the proposed adaptive algorithm. It should be mentioned that all the parameters are dimensionless. The adaptive multiscale solution is calculated by using the proposed multiscale method and labeled by ׳’ ‘AMM׳. Solutions marked with ‘FEM’ denote the results which are obtained by the standard FEM on the fine-scale mesh.Example 1The coarse-scale computational model and its boundary conditions are shown inFig. 14 where a uniform distributed loadq=2.5×104is applied on the top edge along the positive y direction. The degrees of freedom of nodes on the bottom edge of computational model are constrained in the x and y directions. There are4×6coarse elements in this model and the size of each coarse element is1×1. Besides,5×5fine-scale elements are included in sub-grids as shown in Fig. 14(b). In this example, the unit cell is homogeneous and the four-node coarse elements are employed in the initial coarse-scale mesh.The adaptive distribution processes of macroscopic nodes are shown inFig. 15 where the nodes are refined automatically starting from the bottom corners of model. In fact, the stress concentration also occurs at those bottom corners. This indicates that the macroscopic nodes are added at the regions with stress concentration. This is also consistent with the basic assumption of Ref. [34]. Besides, the variation of displacement relative error with the increase of the number of degrees of freedom is shown inFig. 16, from which we can see that the displacement relative error will decrease significantly when increasing the macroscopic nodes adaptively. The von-Mises stress results, obtained by the proposed multiscale method on the meshes with initial and final adaptive macroscopic nodes, are compared with the reference solution which is evaluated by using FEM on the fine-scale mesh. The comparison is shown inFig. 17, from which we can see that the final adaptive multiscale solution coincides with the reference one very well. Furthermore, the von-Mises stress contours are depicted inFig. 18. Obviously, the proposed adaptive strategy is effective and efficient for this computational model with homogenous unit cell.Example 2The computational model with periodic heterogeneous unit cell as used in Section 3 is investigated in this example.The final distribution of macroscopic nodes in the coarse-scale mesh is obtained by using the proposed adaptive algorithm and shown inFig. 19, from which we can see that the macroscopic nodes are distributed adaptively, i.e., more macroscopic nodes are placed at the region with larger displacement gradient and fewer are distributed at the region with smaller one. This will optimize the distribution of nodes at the most extent. Obviously, the node distribution in Fig. 19 is more reasonable by comparison with that in Fig. 11. The numbers of degrees of freedom of nodes shown in Figs. 19 and 11 are 1162 and 1226, respectively. However, the relative errors of displacements of those two cases are 0.097% and 0.16%. This indicates that the adaptive multiscale method can make the distribution of the macroscopic nodes more reasonable. In addition, the comparisons of von Mises stress distributions are plotted inFig. 20, from which we can see that the computational accuracy will be improved significantly after the adaptive processes by comparison with the reference solution. Besides, the convergence curve of relative error of displacements along with the increase of the number of degrees of freedom is shown inFig. 21.Example 3The computational model with non-periodic unit cells is investigated in this example and its boundary conditions are plotted inFig. 22, where the uniform distributed load isq=105. The size of this model is10×10, i.e.,L=10. The number of coarse elements in the coarse-scale mesh is also10×10, and each unit cell contains10×10sub-grids. In addition, two kinds of the materials are considered in this example as shown inFig. 23, where ‘Phase 1’ denotes the randomly distributed inclusions and ‘Phase 2’ represents the matrix. Their Young׳s moduli are107and106, correspondingly. Poisson׳s ratios of these two materials are all equal to 0.3.The distribution of macroscopic nodes is plotted inFig. 24, from which we can see that there are more nodes at the region having larger displacement gradient and fewer are at the region with smaller one. Then, the y-direction displacement contour and von Mises stress distribution are shown inFigs. 25 and 26, respectively. One can see that the results, obtained based on the final adaptive macroscopic nodes, are consistent with the reference ones very well. Furthermore, the variation curve of displacement relative errors with increasing the number of degrees of freedom is shown inFig. 27 and coincides with that obtained according to Ref. [34] well. This demonstrates that these two methods can obtain almost the same results although they are developed based on two different ideas.

@&#CONCLUSIONS@&#
Based on the estimate of residual force, a new adaptive multiscale method is developed for static analysis of heterogeneous materials. By using the developed adaptive algorithm, the nearly optimal distribution of macroscopic nodes on a fixed coarse-scale mesh can be found, i.e., more nodes will be placed at the region with larger displacement gradient and fewer will be placed at the region with smaller one. It is reasonable and consistent with the fact.In the multi-node EMsFEM computations it has been found that the displacement relative error and the relative magnitude of residual forces are non-linearly decreasing along with the increase of the number of macroscopic nodes of multi-node coarse element. The decreases are dramatically in the beginning stage and become quite gentle in the following stable stage. By investigating the residual forces in the multi-node EMsFEM computations, it can be found that the residual forces can represent the magnitudes of local relative errors. Thus the local residual forces can be seen as local relative error indicators. Therefore it is reasonable and suitable to develop the adaptive algorithm based on the estimate of residual forces. Compared with other adaptive multiscale method, our proposed algorithm is easy to implement and its derivations are not complicated. Finally, three typical numerical examples with different kinds of unit cells are carried out to verify the validity of the proposed algorithm. Computation results indicate that the proposed adaptive multiscale method can successfully obtain nearly optimal distribution of macroscopic nodes and improve the computational accuracy consequently.