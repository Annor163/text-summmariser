@&#MAIN-TITLE@&#
Acceleration of MAP-EM algorithm via over-relaxation

@&#HIGHLIGHTS@&#
A modified MAP-EM method for faster reconstruction using an over-relaxation factor was proposed.The method, called MAP-AEM, converges numerically much faster than MAP-EM.MAP-AEM's speed can be made faster than an OS-type method if properly optimized.MAP-AEM outperforms MAP-EM in terms of speed, relative error and STD stability.

@&#KEYPHRASES@&#
Faster tomographic reconstruction,MAP-EM algorithm,PET reconstruction,SPECT reconstruction,

@&#ABSTRACT@&#
To improve the convergence rate of the effective maximum a posteriori expectation-maximization (MAP-EM) algorithm in tomographic reconstructions, this study proposes a modified MAP-EM which uses an over-relaxation factor to accelerate image reconstruction. The proposed method, called MAP-AEM, is evaluated and compared with the results for MAP-EM and for an ordered-subset algorithm, in terms of the convergence rate and noise properties. The results show that the proposed method converges numerically much faster than MAP-EM and with a speed that is comparable to that for an ordered-subset type method. The proposed method is effective in accelerating MAP-EM tomographic reconstruction.

@&#INTRODUCTION@&#
In emission tomography, such as positron emission tomography (PET) and single-photon emission computed tomography (SPECT), statistical reconstructions outperform FBP (filtered back-projection) [1], because of their ability to model noise, system geometry and imaging physics, in addition to incorporating prior information that is related to the object. One of the most widely used statistical reconstruction methods is the ML-EM (maximum likelihood expectation-maximization) algorithm [2]. The ML-EM algorithm is hampered by its slow convergence rate and has difficulty with the ill-condition problem [3].To improve its speed, the OS-EM (ordered-subset expectation-maximization) algorithm was proposed [4]. By using only one subset of the projection data per sub-iteration, the algorithm is an order of magnitude faster than the ML-EM. While OS-EM is fast, parallelizable and it preserves positivity, it does not converge to the ML solution [4]. In particular, increasing the number of subsets leads to increased noise and subset-related artifacts, which degrade lesion-detection performance [5]. Alternative methods to ensure convergence have been proposed, including RAMLA (row-action maximum likelihood algorithm) [6] and OS-separable paraboloidal surrogate [7]. RAMLA uses a manually selected relaxation parameter to preserve the property of convergence, while at the same time accelerating the iterative processing. Another way to solve the convergence problem in OSEM is the so-called complete-data ordered-subset EM (COSEM) algorithm [8], which uses all of the projection data for each pixel update, as opposed to only a subset of the projection data, which is the case for the OSEM update scheme. No extra parameter is necessary for COSEM, but the convergence rate is not as fast as that of a conventional OSEM or an optimized RAMLA. A similar reconstruction strategy, called an incremental optimization transfer algorithm, has also been applied to transmission tomography [9]. Instead of using ordered subsets, accelerated EM methods use a larger step size than the correction factor for a ML-EM [10–14]. One approach for increasing the step is to use a certain power to enlarge the correction term, while retaining the algorithm positivity [10]. By rewriting the ML-EM in an additive form, the other strategy is to multiply the correction term by a certain factor [11–14]. Recently, the COSEM reconstruction [15] used the same acceleration scheme to compensate for the slightly slow acceleration that is a result of having to process all of the data in the normalization term of the algorithm.For the ill-condition problem, one effective solution is to add a prior or a penalty term to the ML objective function and that becomes the MAP (maximum a posteriori) reconstruction [16]. However, incorporating a prior term into a reconstruction algorithm may introduce coupling between pixels [17]. Although the OSL (one-step-late) algorithm [18] is one way to reduce the coupling in MAP-EM reconstructions, it is suboptimal and does not converge to the MAP solution [19]. As in the ML case, the convergence rate for MAP-EM is also an issue. The BSREM algorithm proposed by De Pierro and Yamagishi [19] solves the coupling problem by using a surrogate function and accelerates the reconstruction by introducing a relaxation parameter, as in the RAMLA algorithm, for convergence. Alternatively, the MAP-COSEM method, a MAP version of the COSEM algorithm [8], can be used with a similar ordered-subset updating scheme to accelerate the MAP reconstruction. In addition to the improvement in convergence rate, edge-preserving priors were developed to preserve fine detail [20–22]. However, edge enhancement that uses edge-preserving priors is limited by several factors, such as an object's size and its intensity. To further sharpen the boundaries between tissues, while maintaining smoothness within the tissue, the incorporation of anatomical prior information in MAP reconstruction has been widely studied [23–26]. A more complete overview of MAP-EM and its related works can be found in [1].Although the acceleration scheme [10–14] described above has been applied to conventional ML-EM, OSEM [11] and COSEM [15], it has not been applied to MAP-EM reconstruction. In this study, in order to retain good noise properties that result from the use of an entire set of projection data [11], a new algorithm that increases the convergence rate of a conventional MAP-EM is derived. The algorithm, termed MAP-AEM, incorporates the surrogate function of the quadratic prior [19] into reconstructions, without applying the OSL approach. Although these ideas were introduced at a previous conference [27], a detailed description and more simulation results, including digital and Monte Carlo simulations, are provided here.The proposed algorithms are derived in Section 2. The methods of evaluating the performance of the proposed algorithms are described in Section 3. The results, including the empirical visual performance, a comparison of the convergence rate, the reconstruction accuracy and the noise properties of the proposed methods are shown and compared with those for a conventional MAP-EM in Section 4. A comparison of the convergence rate for these methods and an OS-type reconstruction (MAP-COSEM) is also provided, to show the effectiveness of the proposed algorithms. The findings of this study are discussed in Section 5 and the conclusion follows.The collected data is indicated by g and measured counts at the ith detector bin, gi(i=1,…, M), have a Poisson distribution. The Poisson mean is Hf, where H is the system matrix with element Hijindicating the probability that a photon is emitted from the jth pixel and is detected by the ith bin. Also, f is the intensity object vector with pixel intensity at the jth pixel, which is expressed by fj(j=1,…, N). The MAP reconstruction,fˆ, is obtained by optimizing the Poisson log-likelihood objective function, ΦL(g|f), and a prior ΦP(f), as:(1)fˆ=argmaxf≥0[ΦL(g|f)+ΦP(f)],where(2)ΦL(g|f)=−∑i∑jHijfj+∑igilog∑jHijfjA smoothing prior, ΦP(f), of a quadratic form is used as:(3)ΦP(f)=−β∑j∑j′∈N(j)ωjj′(fj−fj′)2,where β>0 represents the smoothing parameter. Herein, N(j) is the set of neighborhood systems of pixel j andωjj′indicates the weight between pixel j and its neighboring pixel, j′. Usually, the weight,ωjj′, is 1 for horizontal and vertical neighbors and1/2for diagonal neighbors. Only 4 nearest-neighbors are used in this study. The log-posterior values at the kth iteration that are used to evaluate the convergence rate are the summation of the Poisson log-likelihood objective function, ΦL(g|f), and a quadratic prior, ΦP(f), where fjis replaced by the current estimate,fˆj(k).A closed-form formula is difficult to obtain because there is coupling of f in the logarithmic term of the likelihood function (2). To solve this problem, the EM algorithm was proposed [2]. It has two steps: expectation (E) and maximization (M). By substituting a surrogate function for the quadratic prior [19] and using the EM algorithm, the MAP-EM reconstruction update equations at the kth iteration can be summarized as the following two steps, whereυjj′≡ωjj′+ωj′jand Dj≡∑iHij[28]:(4)Cij(k+1)=fˆj(k)Hijgi∑j′Hij′fˆj′(k)∀i,j(5)fˆj(k+1)=−b+b2−4ac2a=d∀jwherea=4β∑j′υjj′,b=−2β∑j′υjj′(fˆj(k)+fˆj′(k))+Dj,c=−∑iCij(k+1)andd=(−b+b2−4ac)/(2a).To derive the accelerated MAP reconstruction, a power factor, h, which is similar to that in [10–14] is introduced to these MAP-EM updating equations. The accelerated MAP-EM reconstruction method is then derived by multiplying the previous update by a correction factor, which is the h power of the ratio of the new MAP-EM update to the previous update, as:(6)f˜j(k+1)=fˆj(k)dfˆj(k)hBy rewriting Eq. (6) in an additive form and using a Taylor series expansion, the updating equation is expressed as:(7)f˜j(k+1)=fˆj(k)(1+Xj)h=fˆj(k)1+hXj+h(h−1)2Xj2+⋯where(8)Xj=d−fˆj(k)fˆj(k)Since the zero and first orders of a Taylor series expansion have larger values than other terms, the new updating equation is derived in terms of a first order approximation of Eq. (7) as:(9)f˜j(k+1)=fˆj(k)+h(d−fˆj(k))=(1−h)fˆj(k)+hdIn fact, the new algorithm, MAP-AEM, can be seen as an accelerated scheme that uses an additive over-relaxation factor. However, an additional count normalization term is necessary, to preserve the total counts in the data [11], as:(10)fˆj(k+1)=f˜j(k+1)∑igi∑i∑j′Hij′f˜j(k+1).Since Eq. (10) can be combined with the projection operation of the next iteration, the additional computation time is negligible, except for the last iteration.A 128×128 digital cylindrical phantom, with three regions of interest (ROIs), cold (i.e. black), background and hot (i.e. white) (with activity ratios of 1:4:8), as shown in Fig. 1(left), was used for data simulation. The system matrix, H, was generated using a ray-tracing method [29]. Poisson noise and the uniform attenuation of water at 140keV were modeled for SPECT imaging, but not the detector response. The projection data was simulated for a total of 500K counts, with dimensions of 128 detector bins and 128 scanning angles over 360°. For the noise analysis, 100 realizations of noisy data were simulated.To further evaluate the performance of the proposed method, a digital Zubal brain phantom [30], as shown in Fig. 1(center), was also used for simulation. To simulate the conditions for neuroimaging studies [31], the ratio of the activity concentration in the striatum region to the background was 4:1. All other conditions for data simulation and acquisition were the same as those for the cylindrical phantom study.To investigate the performance for a more realistic condition, a brain phantom, with gray matter, white matter and cerebrospinal fluid (CSF), was simulated, as shown in Fig. 1(right). To increase complexity, three separate tumor regions were added to the phantom. The resultant intensity for tumor:gray matter:white matter:CSF is 5:3:1:0. The simulation conditions were the same as those used before.A GATE Monte Carlo simulation [32] (Version 4.0.0) was performed, to determine the feasibility of the proposed method in more realistic conditions. The platform simulates most of the physical effects during practical scanning, based on the settings for user-specified geometry, material, physics and protocol. In this study, a dual-head SPECT system, which is equipped with a typical low-energy high-resolution (LEHR) parallel-hole collimator (hole size: 1.4mm, septal thickness: 0.16mm, and hole length: 32.8mm), was simulated. A NaI(Tl) crystal with an active area of 128mm×128mm and thickness of 10mm was used for photon detection. A 7.536mL cylindrical phantom with two 0.471mL inserts, representing cold and hot regions, was placed 47.2mm away from the detector. The phantom contained a total of 21.5625MBq (megabecquerels) and the relative activity concentrations for the cold, hot and background regions were the same as those seen in the simulation study 1. The cameras moved around the object over 360° and projection data was collected by 64 angles, taking 10s per angle. The physical effects, including the photoelectric absorption and Compton scattering, were modeled in the simulation. An attenuation map with air (cold region) and water (hot region and background) was used. The data was then sorted into a series of sinograms, with dimension of 128 bins×64 angles. Only the central slice, with a total of 196K collecting counts, was used for the analysis.Following each projection data simulation, the acquired sinogram was reconstructed, using conventional MAP-EM and the proposed accelerated algorithm. For all of the reconstructions, the same system matrix, H, was the same as that used to generate the projections and an initial condition of a uniform image with a value of 1.0 was used. For the digital phantoms, a uniform attenuation map that was the same as that used in the simulation was used in the system matrix, to correct attenuation. Since the main purpose of this study is to investigate the capability of the acceleration schemes that are applied to the MAP reconstruction, the smoothing parameter, β, that leads to acceptable image quality, was maintained at a fixed value (=1) for all methods, for simplicity. A larger value of β leads to a smoother image and more edge information is lost, but if β is too small, the reconstructed image is very noisy. Task-based selection of the parameter is possible, but complex [33]. An empirical and easy way is to select the smoothing parameter, based on a visual investigation or the signal-to-noise ratio within some target region. However, further research is necessary to optimize the value of β in an effective and efficient way. In addition, MAP-AEM with various over-relaxation factors (i.e. h) was performed to investigate the increase in the speed of convergence.The performance of the proposed methods was evaluated in terms of empirical visual comparison, convergence rate, regional relative error (RE{ROI}) and noise properties, using digital phantoms. For the GATE simulation, only the visual and convergent rates are compared for the proposed and the conventional MAP-EM methods.The convergence performance is determined using the plots of log-posterior values vs. iteration numbers. Convergence is achieved when there are stable log-posterior values. All reconstructions were performed with 2, 4, 8, 16, 32 and 64 iterations. Although theoretical proof of convergence was not available, the convergence property of the proposed method was studied numerically. To investigate whether MAP-AEM converges to the same value as a convergent algorithm, such as MAP-EM, the log-posterior value of MAP-AEM at the 5000th iteration was calculated and compared with that of MAP-EM.RE{ROI} for each region was used to quantify the reconstruction accuracy of the proposed methods and the conventional MAP-EM, as:(11)RE{ROI}≡1NROI∑j′∈ROIbj′wherebj=1M∑m=1M|fˆjm−fj|/fj. NROI is the number of pixels within the ROI and m is the noise trial index, for {m=1,…, M}. RE{ROI} was plotted against the number of iterations and it was averaged across the 100 noise trials. A standard deviation (STD) analysis over 100 noise trials for the digital simulations was conducted to evaluate the noise properties. Similarly to the RE{ROI} evaluation, all of the results were compared with those for MAP-EM reconstruction. The STD within each ROI for each reconstruction method was computed using the following equation:(12)STD≡1NROI∑j′∈ROIσj′2,whereσj2=1M∑m=1M(fˆjm−fˆ¯j)2andfˆ¯j=1M∑m=1Mfˆjm.The convergence rate for the proposed methods is also compared with that for the convergent OS-type MAP reconstruction and that for the MAP-COSEM with different subsets. Since using more than 32 ordered subsets did not result in significant acceleration in the preliminary experiments [15], only the ordered subsets of 8 and 32 were used.

@&#CONCLUSIONS@&#
