@&#MAIN-TITLE@&#
Two-level coarse-to-fine classification algorithm for asthma wheezing recognition in children's respiratory sounds

@&#HIGHLIGHTS@&#
The respiratory sounds in children should be considered separately from adults.Two layer pattern recognition system for wheezing recognition is introduced and its functionality is justified.The special structure of SVM classifier stacked in parallel improves the ordinary SVM classifier.The system is efficient in negative samples classification which is important for avoiding false asthma alarm and possibility to get used to medications.The difference between central frequencies of tested wheeze and its closest neighbor from training set is important for classification efficiency.

@&#KEYPHRASES@&#
Asthma wheeze recognition,Support vector machines,Mel frequency cepstral coefficients,

@&#ABSTRACT@&#
The paper proposes a two-layer pattern recognition system architecture for asthma wheezing detection in recorded children's respiratory sounds. The first layer consists of two SVM classifiers specifically designed as a cascade stacked in parallel to emphasize the differences among signals with similar acoustic properties, such as wheezes and inspiratory stridors. The second layer is realized using a digital detection threshold, which further upgrades the proposed structure with the aim of improving the process of wheezing detection. The results were experimentally evaluated on the data acquired from the General Hospital of Dubrovnik, Croatia. Classification results obtained on the test data sets revealed that the central frequency of wheezes included in the training data is important for the success of classification.

@&#INTRODUCTION@&#
Bronchial asthma (asthma) is one of the typical modern diseases that constantly attracts the attention of the medical and research community due to the growing number of people who suffer from it or for members of families involved in care. It is a chronic, inflammatory, reversible obstructive lung disease and is accompanied by the narrowing of the bronchi. Acoustic signals are formed in the lungs due to the oscillation of the bronchi walls caused by the turbulent air flow during breathing and are a source of information on the state of the respiratory system. In medicine, these sounds correlate with pulmonary pathology and have been studied since the invention of the stethoscope in 1816 [1]. Phonopneumograms (acoustic breathing records) are dependent on anatomical and physiological parameters such as sex, age, type and stage of disease. Additionally, they can be different in one person. Digital methods of collecting, processing and analyzing phonopneumograms have been used for more than 30 years. Measuring systems, among others, consisted of transducers that were placed on the chest or trachea and collected acoustic signals during breathing. A normal respiratory sound is the sound produced by the lungs of healthy people during inspiration and expiration. Abnormal respiratory sounds that occur at an earlier stage of asthmatic attacks found by stethoscope auscultation include prolonged expiration and the emergence of wheezing. Typical devices that monitor the degree of airway obstruction are the spirometer and peak flow meters, but these devices are unsuitable for children from zero to six years of age who cannot determine how to use them. Additionally, to ensure sufficient acoustic power for the respiratory sound, the children were usually encouraged to perform forced breathing [28]. Their efforts often resulted in specific physiological artifacts such as inspiratory stridor or snoring, which sound similar to asthmatic wheezes. Stridor is a monophonic high pitch wheezing sound produced by air flow passing through the narrowed larynx. Snoring is a sound arising from the passage of an air flow through the upper part of the respiratory tract that is obstructed by secretions. In addition, medical practitioners observed that children of a specified age (zero to six) are more prone to respiratory infections than adults due to well vascularized mucosa. Additionally, because of the anatomy of organs (small size), infection is rarely limited to a particular region of the respiratory system, and usually the larynx, trachea and bronchi are also affected. Hence, there is a problem with the exact classification of respiratory sounds in children, which should be considered separately from adults. In addition, there are non-physiological artifacts caused by the interaction of the transducer with the skin. These artifacts were more pronounced in restless children, which is a typical behavior for younger and/or asthmatic children.Therefore, trained physicians are able to recognize the children's breathing sound quality and diagnose an asthmatic attack, but there are only a few devices [2,34], based on our knowledge, suitable for home use, which could help parents decide if it was necessary to treat the children with medications. One type of device that can provide insight into the prognosis and the degree of obstruction is the wheezometer [34], a device that detects wheezes that usually appear in the early stage of an asthma attack. The most important component, which constitutes these devices, except the transducer that captures the signal of breathing, is certainly an algorithm that recognizes the wheezes from the acquired respiratory sounds. Scientific literature devotes considerable attention to wheezing recognition problems, which became a typical test study to prove new advances in the field of signal processing [3,4]. Although the first attempts to automatically detect wheezing were more than 20 years ago, a significant success is recorded with the emergence of machine learning algorithms.With an aim to reduce false asthma alarms and to improve the quality of the wheezometer's ability to distinguish asthmatic and non-asthmatic inspiratory stridors, in this paper, we present a two-level coarse-to-fine classification algorithm for asthma wheezing recognition in children's respiratory sounds (phonopneumograms).Due to the mentioned specificity, the first level of the classification algorithm has been assured with an SVM cascade consisting of two parallel classifiers that perform better than a single SVM classifier and helps to discriminate similar non-asthma sounds from asthma wheezes. Additionally, decisions on the second level, which are based on the newly introduced digital detection threshold, approve or reject the first-level results, making the process of wheezing recognition in respiratory sounds with artifacts highly reliable. Therefore, the novelty of the paper can be summarized with the following outlines:•The proposed algorithm is more suitable for children;A new, cascade classification algorithm is introduced that reduces false asthma alarms due to inspiratory stridors;Feature set drawn from the Mel-cepstrum could be optimized by the appropriate number of cepstral coefficients and their kurtosis and entropy;The algorithm is more robust to noise due to a newly introduced digital detection threshold.To clearly present the purpose of this research, the paper is divided into six sections. In Section 2, a literature overview, which motivated the performance this research, is presented. Section 3 describes the materials and methods used, particularly the measuring system and the components of the algorithm. Performed experiments and their results are presented in Section 4. The discussion is in Section 5. The paper presents the conclusions in Section 6.A typical pattern recognition system is composed of two blocks: feature extraction and classification. They function in two steps: training and testing. Training models the data, and then a discriminant is determined to delimitate the classes. For testing, new data are classified using the discriminant [5]. According to Bahoura [5], in the last two decades, the Fourier transform (FT) [6–9], linear predictive coding also known as autoregressive modeling (AR) [10], wavelet transform (WT) [11,12,30], and Mel Frequency Cepstral Coefficients (MFCC) [23–25] have been used for wheezing feature extraction, whereas artificial neural networks (ANN) [6–9,12,30], k-nearest neighbor (k-NN) [31], vector quantization (VQ) [11] and Gaussian mixture models (GMM) [24,25,36] have been used for respiratory sound classification. Current researchers use new approaches for spectro-temporal feature extraction [13,14] and/or SVM [15,32,35] for detection and quantization of wheezes based on various wheezing models. Additionally, there are methods for noise removal [16], which may be useful in obtaining better classification results.In this paper, wheezing is described by using the MFCC analysis of an acoustic breathing record. This analysis closely approximates the human auditory system's response. In this way, the feature describes exactly what humans (physician) can hear over the stethoscope. The researchers show that by using MFCC as features and GMM [24,25] or SVM [17] as classifiers, wheezing detection can achieve an accuracy higher than 95%. A similar accuracy has been obtained using advanced signal processing techniques based on the persistent homology of delay embedding [3]. Although the literature mentions the importance of ensemble classifiers in the decision making related to asthma patients [18,19], there is no paper, based on our knowledge, that investigates more deeply the efficiency of ensemble methods in wheezing detection in comparison to individual classifiers. In addition, the majority of the experimental results are evaluated based on the breathing record acquired under the controlled condition from the adult patients [29]. Considering the importance of reliability for wheezing detection in children respiratory sounds, the goal of this paper is to present how much the standard machine learning methods could be improved by the classifiers’ cascade, which can be perceived as a step toward ensembles. Under the specified conditions, the importance and the number of used features in cascade was not tested randomly, but the experiment has been set up to force the individual classifiers from the cascade to generate different errors due to which the effectiveness of the cascade comes to the forefront. Typical situations could be illustrated for the breathing record with asthma wheezing and inspiratory stridor in which spectral and psychoacoustic properties are similar. Therefore, we introduce cascade with the ability to distinguish those types of wheezes and eliminate false positive detections. It is worth noting that wheezes indicate an asthmatic attack under which consuming medications makes sense. Otherwise, applied therapy has the opposite effect—patient becomes accustomed to the medication. Hence, eliminating the false positive detections is as important as the detection of a true positive. Additionally, using a two-layer architecture in which the first layer is represented with the classifiers’ cascade and the second is realized using a digital threshold, it is possible to distinguish wheezes from non-wheezes more accurately. Therefore, the proposed architecture is further upgraded with the aim of improving the process of wheezing detection.In the following sections, the proposed algorithm is described in detail including the method of selecting the parameters of the classifier, the role of the chosen features and the way in which features are used to ensure greater reliability of the classification. Prior to that, the measuring system specifications utilized for data collection are presented.The measuring system consists of a transducer, 4-m long microphone cable, preamplifier transistor in a common emitter circuit built with transistor BC107, stable 5-V source, and a personal computer with an integrated audio card that has one microphone input, two analog inputs and a stereo output. The resolution of the AD/DA converter was 16bits, the input impedance of the analog inputs was 47kΩ, and the input voltage range was 2 VPP, signal-to-noise ratio (SNR) was 90dB, and the total harmonic distortion at 1 VRMS was 0.01%. The measurements used an analog card input. The sampling frequency was set to 8kHz. Due to the low-level signal voltage at the transducer terminals, previously, a signal was enhanced with a transistor preamplifier as shown in Fig. 1. Measurements in previous studies showed the absence of significant spectral components at frequencies higher than 650Hz. Because the sampling frequency is 8kHz (Nyquist frequency is 4kHz), the analog low-pass antialiasing filter was not embedded. The most important component of the system is the transducer created with the accelerometer BU-3173 by Knowles Electronics.Using a computer program Sound Recorder (part of Windows XP) and an audio card Sound Blaster PCI64, digital data (sampled signal value) was collected in .wav format. The corresponding computer program converted data from the .wav format to a .txt format. By using MATLAB software tools, several programs were developed (some with graphical interface) for data (signal) processing as contained in these text files and were also used to display the measurement results.The main goal of the presented research was to discriminate the wheeze signals from the non-wheeze signals. Therefore, the acquired respiratory sounds have been separated into two specific classes marked as W (wheeze) and NW (non-wheeze). In the following sections, all of the algorithm's components, which include the preprocessing stage, feature selection, SVM classifier cascade and digital detection threshold, are described in detail.Each signal in phonopneumograms lasting 10s was first filtered with the Yule–Walker 50th-order high pass filter with the lower cut-off frequency of 100Hz to reduce the impact of cardiovascular and muscular noise (Fig. 2a). Then, STFT is calculated (FFT method with 50% overlapping Hamming window using 256 samples that correspond to 32ms of time), and the result is graphically displayed as a 2D spectrogram (Fig. 2b). By the simultaneous playback and analysis of spectrograms, a physician visually allocates distinctive signal sequences and manually classifies them as breathing sounds, wheezing, inspiratory stridors or snoring. Depending on the type of signal, the corresponding allocation procedure is applied. For the case of wheezing, it is important to determine the beginning and the end of that distinctive sequence. Therefore, after the dominant frequency of the wheeze is determined, the whole signal is routed through the Yule–Walker 50th-order band pass filter again where the central frequency overlaps with the central wheeze frequency (Fig. 2c). It is important to mention that this band pass filter is only used to precisely determine the beginning and the end of the wheeze and to extract the features of the wheeze. Samples used for training, validation and testing were not run through this filter. Fig. 2d shows an enlarged wheeze marked as W1 in Fig. 2b after precisely determining the wheeze start sample (1.03×104th sample from the beginning of record) and the wheeze end sample as well (1.32×104th sample from the beginning of record). It has 2900 samples in total or, as expressed in the time domain, it lasts 362ms. The overall signal in a phonopneumogram is then routed through the Yule–Walker 50th-order high pass filter again with the lower cut-off frequency of 100Hz from which the signal sequence of the allocated wheeze W1 (Fig. 2e) was extracted, with an appropriate spectrum shown in (Fig. 2f) The initial signal segment of 100ms is allocated at the beginning of W1, which is then shifted every 10ms, forming a series of wheeze signal segments. Therefore, from the signal sequence of 362ms, 27 signal segments are obtained, and the residue of the last 2ms is rejected. Signal segments during 100ms represent the wheeze signal pattern from which feature extraction should be performed. Based on these feature values, the machine learning algorithm provides the classification. The same procedure was applied to other wheeze signal sequences. The total amount of phonopneumograms was 45. For training and validation purposes, 21 of them were used. The rest of the 24 phonopneumograms were used for testing. In 21 phonopneumograms, 5 of them contained wheezing, 9 contained other distinctive signals but not wheezing (inspiration, expiration, inspiration stridor and snoring), and the remaining 12 phonopneumograms contained unclassified non-wheeze signals. For a total of 17 wheeze recordings in 5 phonopneumograms, 269 signal segments (patterns) were obtained. Other distinctive signal extractions (inspiration, expiration, inspiratory stridor and snoring) were determined in a similar way. In total, nine phonopneumograms were used to obtain 17 wheezes, 22 inspiratory, 19 expiratory, 5 inspiratory stridors and 9 snore signal sequences. Using the same procedure described above for wheeze segment extraction, the following segments were stored: 924 segments to the sub-class I (Inspiration), 1650 segments to the sub-class E (Expiration), 99 segments to the sub-class L (inspiratory stridor—appears in larynx) and 245 snores segments to the sub-class S. All allocated distinctive signal sequences were without non-physiological artifacts with a clearly visible start and end time. Except for the allocated distinctive signal sequences, the other 12 randomly selected phonopneumograms without wheezes were used for acquiring 2388 unclassified signal segments (forming sub-class U) lasting 100ms, using 50% overlapping between each other. Due to the small number of wheezes, the wheeze signal detections were tested by using the leave-one-out cross validation (LOOCV) method described in Section 4.2.The performance of ensemble learning methods applied to classification is based on the preparation of the model, which implies a dataset, an initial pool of descriptors, and a machine-learning approach. Variation of any of these items can be used to generate an ensemble of models [33]. Here, we consider similar strategy, which assumes the descriptors variation approach combined with an SVM classifier stacked in parallel. The block scheme of the proposed classifier is shown in Fig. 3. Each classifier functionality is described by the appropriate model formed during the training phase. Based on the results from literature [24,25], the MFCC are used as the basic features that constitute descriptors for both of the models. Considering the fact that data contain artifacts, additional features were added to adopt the discriminant between classes of wheezes and non-wheezes. These would take into account the consequences of noise presence, such as energy distributions in the Mel filter bank (kurtosis) or measures for disorder (entropy). The results from classifiers are assembled using the logical AND function, which means that the signal segment (pattern) would be classified as a wheeze only if each of the classifiers votes positively. Additionally, other combinations are possible, but these experiments go beyond the scope of this paper. Finally, as seen in the block scheme, the results are improved by introducing a digital detection threshold, which is described in Section 4.2. The following section gives a description of the SVM functionality.The SVM classifier is a kernel-based supervised learning algorithm [27]. It is specifically designed for binary classification, which matches our goals related to wheeze and non-wheeze classification. During the training phase, SVM uses a kernel function to map the input vectors into a higher dimensional feature space in which the support vectors (some of training samples) define a decision boundary, i.e., the hyperplane that separates different classes (W: wheezes and NW: non-wheezes). In this research work, the radial basis kernel functions (RBF) were used because they perform well with nonlinear models. The performance of the SVM classifier with an embedded RBF kernel relies on two parameters: C and γ. The procedure for tuning the kernel parameters is useful and is a versatile tool for various tasks such as finding the right shape of the kernel, feature selection, and finding the right tradeoff between error and margin [26]. The value of parameter C for the soft margin was set to one because we found that the classification results were insensitive to its changes for a very wide interval [10−2, 102]. The parameter γ for the RBF kernel was adopted to obtain an optimal number of MFCC features resulting from the maximum classification reliability, which is presented in Section 5 of the experimental results. Section 4 discusses the experimental results.To make the whole process more robust and more suitable for practical realization, a digital detection threshold was introduced. Namely, assuming that the signal segments classified as wheeze are assigned the value one, and the signal segments classified as non-wheeze are assigned the value zero with the aim that each error in wheeze detection would not be considered an alarm (false positive segments), the additional criterion was introduced for the decision of the wheeze's existence. This works in the following way: the signal sequence would be declared as wheeze only if in n consecutive signal segments, at least k segments were classified as wheeze. The number k is called the digital detection threshold. Thus, the classification results have a higher reliability of detected wheezes than without using the threshold, which is presented in Section 4 with experimental results.The efficiency of wheezing recognition was evaluated with the appropriate validation measures such as the overall accuracy and the overall reliability. The overall accuracy is a standard validation measure defined in literature [33] and was calculated using (1), whereas the overall reliability was defined by the following equation:(1)ACC_____=1N∑i=1NTPi+TNiTPi+TNi+FPi+FNi(2)R¯=TPR¯⋅TNR¯where TPR and TNR (TPR—True Positive Rate, TNR—True Negative Rate) were calculated using the following equations, respectively:(3)TPR_____=1N∑i=1NTPiTPi+FNi(4)TNR_____=1N∑i=1NTNiTNi+FPiParameter N represents the number of experiments performed using the random subsampling validation method, and i is the index of each iteration. The input data set was divided in two subsets: wheezes and non-wheezes. Typically, two-thirds of the data were used for training and one-third for validation, but it could be any other proportion [33]. TP, FP, TN and FN are the numbers of the signal segments (samples) classified as true positive, false positive, true negative and false negative, respectively. Reliability is the evaluation measure similar to the measure known in literature as performance [20–22] or g-mean, which is calculated as a square root of Eq. (2). We found that the proposed measure is better than performance because it ensures a higher sensitivity of the highly efficient classification results (results for which TPR·TNR is close to one). Thus, the evaluation of the classifier efficiency is even stricter than using performance as a measure.

@&#CONCLUSIONS@&#
