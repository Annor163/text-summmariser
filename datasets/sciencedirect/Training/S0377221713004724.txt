@&#MAIN-TITLE@&#
Adaptive and robust radiation therapy optimization for lung cancer

@&#HIGHLIGHTS@&#
Considers fractionated intensity-modulated radiation therapy of lung cancer under breathing motion uncertainty.Proposes a method that generalizes robust optimization and adaptive radiation therapy.Provides computational results with real data that show an improvement over the non-adaptive method.Develops theoretical results that explain the multiple phenomena observed in the computational study.

@&#KEYPHRASES@&#
OR in health services,Intensity-modulated radiation therapy,Adaptive radiation therapy,Robust optimization,Linear programming,

@&#ABSTRACT@&#
A previous approach to robust intensity-modulated radiation therapy (IMRT) treatment planning for moving tumors in the lung involves solving a single planning problem before the start of treatment and using the resulting solution in all of the subsequent treatment sessions. In this paper, we develop an adaptive robust optimization approach to IMRT treatment planning for lung cancer, where information gathered in prior treatment sessions is used to update the uncertainty set and guide the reoptimization of the treatment for the next session. Such an approach allows for the estimate of the uncertain effect to improve as the treatment goes on and represents a generalization of existing robust optimization and adaptive radiation therapy methodologies. Our method is computationally tractable, as it involves solving a sequence of linear optimization problems. We present computational results for a lung cancer patient case and show that using our adaptive robust method, it is possible to attain an improvement over the traditional robust approach in both tumor coverage and organ sparing simultaneously. We also prove that under certain conditions our adaptive robust method is asymptotically optimal, which provides insight into the performance observed in our computational study. The essence of our method – solving a sequence of single-stage robust optimization problems, with the uncertainty set updated each time – can potentially be applied to other problems that involve multi-stage decisions to be made under uncertainty.

@&#INTRODUCTION@&#
Lung cancer is the leading cause of death due to cancer in North America, killing an estimated 180,000 people in 2010 (American Cancer Society, 2010; Canadian Cancer Society’s Steering Committee, 2010) and accounting for over 25% of all cancer deaths. Lung cancer is often treated using radiation therapy (Toschi, Cappuzzo, & Janne, 2007). Of the different types of radiation therapy, one of the most commonly used in practice for treating cancer in general is intensity-modulated radiation therapy (IMRT) (Mell, Mehrotra, & Mundt, 2005). In an IMRT treatment, the patient is irradiated from multiple beams, each of which is decomposed into a large number of small beamlets. The beamlet intensities can be controlled through the use of a multileaf collimator (MLC) that moves metal leaves in and out of the beam field in order to block certain parts of the beam. By appropriately setting the beamlet intensities, the volume that is irradiated can be made to closely conform to the shape of the target. The basic problem in planning an IMRT treatment is to determine how the beamlet intensities or weights should be set so that the target receives an adequate dose while the healthy tissue receives a minimal dose. This is known as the beamlet weight optimization problem or the fluence map optimization problem. Since the inception of IMRT, much research has focused on modeling and solving this problem as a mathematical program (see Romeijn & Dempsey, 2008 for a comprehensive overview).In practice, the beamlet weight optimization problem is complicated by the presence of uncertainties, such as those arising from errors in beam positioning and patient placement, internal organ motion during treatment, and changes in organ position between treatment sessions. All of these factors affect the relative position of the tumor with respect to the beams, which in turn affects how much dose is deposited in the tumor and the healthy tissue. For tumors in the lung, the most significant uncertainty arises from breathing motion. During treatment, the patient is constantly breathing, and the tumor moves with the expansion and contraction of the patient’s lungs. Furthermore, the patient’s breathing pattern during treatment is not known exactly beforehand and can vary from day to day. If a treatment is planned with a specific breathing pattern in mind but a different pattern is realized during treatment, the tumor may end up being underdosed and the quality of the treatment may thus be greatly compromised (Lujan, Balter, & Ten Haken, 2003; Sheng et al., 2006). At the same time, if the treatment is designed to deliver the prescription dose to the tumor under any breathing pattern, regardless of how unlikely some of those patterns may be, then an unnecessarily high amount of damage will be done to the healthy tissue. There exist approaches that aim to mitigate the effect of uncertainty by only activating the beam when the patient is in a certain phase of the breathing cycle (Ohara et al., 1989), but these approaches have the disadvantage of prolonging the treatment time, leading to reduced throughput in the treatment center.One methodology that allows for tumor coverage under uncertainty to be balanced with healthy tissue sparing, without extending the treatment time, is robust optimization. There are many robust optimization approaches to IMRT treatment planning. In this paper, we build on the method developed in Bortfeld, Chan, Trofimov, and Tsitsiklis (2008) and Chan, Bortfeld, and Tsitsiklis (2006), which is specifically designed to manage the instantaneous breathing motion uncertainty that may be realized during treatment sessions. Although robust optimization has been shown to be a valuable methodology for managing uncertainty due to breathing motion, it can be further improved by leveraging the fact that treatments are typically fractionated. Fractionation refers to the practice of dividing up the prescription dose and delivering small amounts in daily treatment sessions over multiple weeks, in order to exploit the more capable repair mechanism that healthy tissue has over cancerous tissue (Thames & Hendry, 1987).To date, the typical approach to fractionated treatment planning and delivery has been to determine what the beamlet intensities should be to deliver a certain prescription dose, scale them by 1/n where n is the number of fractions, and use the resulting intensities in every treatment fraction. This, however, does not take advantage of the dynamics that fractionation injects into IMRT treatment planning and the underlying uncertainty. For example, it may be the case that the pre-treatment estimates of the patient’s breathing pattern are erroneous, and the breathing patterns that are planned for differ from those realized over the treatment. In this case, the wrong beamlet intensities would be used for every fraction, without the possibility of correcting them. On the other hand, the beamlet intensities may be optimized in such a way that the prescription dose is delivered under a very large range of breathing patterns, when in actuality the patient’s breathing pattern does not vary significantly from fraction to fraction. In this case, there would be no way to correct the conservatism of the treatment, and the patient’s healthy tissue will incur more damage than necessary. Another example comes from the possibility that the patient’s breathing pattern may change over the course of treatment as the patient becomes more comfortable in the treatment room or as the evolution of the underlying disease affects the patient’s respiratory ability. As a result, latter treatment sessions may deliver insufficient dose to the tumor and more dose than anticipated to healthy tissue. These issues motivate the incorporation of adaptive re-optimization into robust optimization models.To deal with fractionation in more general IMRT treatment planning contexts, much research has been conducted in the medical physics community in what is known as off-line adaptive radiation therapy (ART). In off-line ART, after the current fraction is delivered, new information, typically obtained from imaging devices, is fed back into the planning process to design the beamlet intensities of the next fraction (Yan, Vicini, Wong, & Martinez, 1997a). To date, off-line ART and robust optimization have largely been considered independently of each other.In this paper, we propose a novel method that generalizes the framework of off-line adaptive radiation therapy and the robust optimization methodology of Bortfeld et al. (2008) and Chan et al. (2006) to treat lung cancer in the presence of breathing motion uncertainty. Our method is based on adaptively updating an uncertainty set that models the breathing motion uncertainty and then solving a robust optimization problem with the new uncertainty set prior to each fraction. As a result, our method is able to combat both the instantaneous uncertainty realized in each fraction as well as changes in this uncertainty that occur from day to day. The clinical value of this method is that it has the potential to improve upon the non-adaptive robust optimization method in both tumor coverage and healthy tissue sparing. This is significant because patient survival rates have been shown to improve when the tumor dose is increased (see Perez, Bauer, Edelstein, Gillespie, & Birch, 1986). Unfortunately, dose escalation to the tumor is limited by the radiation tolerance of healthy tissue, particularly the lungs (Cox et al., 1990). If it is possible to increase tumor dose and reduce healthy tissue dose from the levels achieved by non-adaptive robust optimization, further dose escalation will become viable, and improvements in patient survival rate may be realized.Our specific contributions in this paper are as follows:1.We develop a method that combines robust optimization with adaptive radiation therapy and suitably generalizes both frameworks. This method has modest computational requirements and can be easily generalized to other types of cancer and other types of uncertainty.Using real patient data, we demonstrate computationally that this method generates treatments that improve upon treatments obtained by non-adaptive robust methods in both tumor coverage and lung dose. We show that the quality of the final treatment does not vary significantly with the choice of initial uncertainty set. We also show that the achieved performance is comparable to that of two “prescient” solutions, which correctly anticipate the patient’s breathing over the entire treatment.We prove an asymptotic optimality result: if the patient breathing pattern converges over the treatment course, then the dose distribution produced by our adaptive robust method converges to an “ideal” set of dose distributions that exhibit no tumor underdose or overdose and low healthy tissue dose. We use this result to explain multiple phenomena observed in our computational study.The rest of the paper is organized as follows. In Section 2, we briefly review some of the relevant literature in robust optimization and off-line ART. In Section 3, we provide an overview of the non-adaptive robust optimization method on which this paper builds. In Section 4, we provide a detailed description of the proposed adaptive robust method. In Section 5, we provide results from our computational study with clinical lung cancer patient data. In Section 6, we conduct a theoretical analysis of the adaptive robust method. Finally, in Section 7, we provide some conclusions and directions for future work.

@&#CONCLUSIONS@&#
In this study, we developed an optimization method for fractionated IMRT treatment planning that combats breathing motion uncertainty by generalizing the methodologies of adaptive radiation therapy and robust optimization. We studied the effectiveness of our method on two PMF sequences obtained from clinical lung cancer patients and showed that our adaptive robust optimization method improves upon the static method in both tumor coverage and healthy tissue sparing simultaneously. We also studied the effectiveness of our method from a theoretical standpoint and proved that the adaptive robust dose distribution approaches a limiting set of optimal dose distributions. Even though this adaptive approach is myopic, it performs well when the PMF sequence converges, and for some uncertainty set update algorithms, performs well even when the PMF sequence does not converge. Also, as we have shown empirically and theoretically, our method does not require perfectly accurate information to be available before the start of treatment. Overall, the clinical value of this method is that it allows for the tumor dose to be safely escalated without leading to additional healthy tissue toxicity, which may ultimately improve the rate of patient survival.Future work should consider what results can be obtained when the convergence assumption is relaxed and the PMFs are instead drawn from a distribution on the probability simplex. The adaptive robust method we have studied can also be modified by changing the right hand side of problem (1) after each fraction, in order for the treatment to account for the dose delivered in prior fractions and to compensate for daily underdosages and overdosages in prior fractions. With such a method, we hypothesize that the daily dose delivered to the tumor will become increasingly inhomogeneous as the treatment progresses, with some parts of the tumor receiving significantly less than the daily prescribed amount. This seems to be the case in some preliminary computational tests and is the subject of ongoing work.Finally, we note that although we have specifically studied fractionated IMRT planning under breathing motion uncertainty, the methodology and analysis we have presented here is of value to other practical problems outside of the domain of healthcare. Specifically, this method can be applied to problems involving sequential decision making under uncertainty, when new measurements of the uncertain effect are obtained over the planning horizon. This approach may be particularly attractive when it is computationally inexpensive to solve the robust optimization problem with the updated uncertainty set at each stage. Overall, the empirical performance and theoretical properties we have shown in this paper suggest that this type of adaptive robust optimization method could be a viable approach for other multi-stage decision making problems under uncertainty.