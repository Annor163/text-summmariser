@&#MAIN-TITLE@&#
Representation and analysis of additively manufactured parts

@&#HIGHLIGHTS@&#
Representation of as-manufactured models using convolution.Incorporating manufacturing uncertainty into representation.Computing as-manufactured models using planar morphological operations.Interoperable analysis using query based simulation on sliced as-manufacturable models.

@&#KEYPHRASES@&#
Representation,Additive manufacturing,As-manufactured model,Interoperability,Physical analysis,

@&#ABSTRACT@&#
Representations of solid models were initially formulated partially in response to the need to support automation for numerically controlled machining processes. The assumed equivalence between shape, topology, and material properties of manufactured components and their computer representations led to the practice of modeling and simulating the behavior of physical parts before manufacture. In particular, representations of shape and material properties are treated in distinct nominal models for most unit manufacturing processes. Additively manufactured parts usually exhibit deviations from their nominal geometry in the form of stair-stepping artifacts and topological irregularities in the vicinity of small features. Furthermore, structural properties of additively manufactured parts have experimentally been shown to be dependent on the build orientation defining the cross sections where material is accumulated. Therefore geometric models of additively manufactured parts cannot be decoupled from the manufacturing process plan.In this paper we show that as-manufactured shapes may be represented in terms of the convolution operation to capture the additive deposition of material, measure the conformance to nominal geometry in terms of overlap volume, and model uncertainties involved in material flow and process control. We then demonstrate a novel interoperable approach to physical analysis on as-manufactured part geometry represented as a collection of machine-specific cross sections augmented with boundary conditions defined on the nominal geometry. The analysis only relies on fundamental queries of point membership classification and distance to boundary and therefore does not involve the overhead of model preparation required in approaches such as finite element analysis. Results are shown for non-trivial geometries to validate the proposed approach.

@&#INTRODUCTION@&#
Transformation of raw materials into a fabricated product relies on a sequence of unit manufacturing processes   [1]. All unit manufacturing processes are inherently imprecise but are instrumented and controlled to minimize the deviation between nominal design models and their physical counterparts. Nominal models provide the foundation for computer representation, analysis, planning, and automation for traditional unit manufacturing processes such as casting, machining, and welding. Fabricated parts are then characterized in terms of variations of nominal models of shape and material structure through distinct process and application specific notions of equivalence. For example, the formalism of geometric dimensioning and tolerancing  [2] is used to determine shape equivalence between perfect form nominal models and imperfect manufactured parts in terms of tolerance zones defined according to prescribed inspection procedures. Similarly, nominal models to simulate mechanical behavior of fabricated parts assume homogeneous and isotropic bulk material properties that are considered equivalent to material properties of manufactured parts, although the manufacturing process can induce material transformations due to phase change, deformation, and microstructure modification.Conceptually, the diagram in Fig. 1illustrates the workflow for mechanical performance prediction, where shape is nominally defined in a CAD system using solid model representations and mechanical performance is predicted by a CAE system through nominal models for structural analysis (arrow 3). The predicted performance is expected to be equivalent with the results of physical testing on fabricated parts (arrow 1 followed by arrow 2), and with the results of structural analysis on a representation of the process plan dependent as-manufactured model (arrow 4 followed by arrow 5) that captures manufacturing imperfections and material transformations due to fabrication.As-manufactured models are often not constructed for traditional unit manufacturing processes due to the observed consistency in mechanical performance between simulation in CAD/CAE systems and physical testing. However, in additive manufacturing experimental evidence has shown the performance of fabricated parts to be highly sensitive to a combination of machine resolutions, material, manufacturing strategy, and process specific parameters such as cooling rates and distortions due to phase change  [3–5]. Downstream analysis cannot be performed directly on CAD models and accurate predictive capability of simulation tools for additive manufacturing will rely on the ability to model the effect of these inter-dependent process parameters on part structure, prior to manufacture. We argue that as-manufactured models are therefore required to support automation for additive manufacturing in applications such as mechanical analysis, metrology, inspection, and process planning seen in product lifecycle management.A typical additive manufacturing process is driven by the controlled planar translation of a print head in stacked layers that determines the spatial accumulation of material. Depending on the process, the print head either deposits material (in Fused Deposition Modeling), cures material by applying a focused laser or ultraviolet beam (in Selective Laser Sintering and Stereolithography), sprays liquid binding onto particles (in Inkjet printing), or applies some combination of such methods.Representation of additively manufactured parts should account for process limitations and machine imprecision. For example, since most additive manufacturing processes build three-dimensional shapes by accumulating material laid out in sectional layers the manufactured parts will exhibit some degree of stair-stepping depending on printer resolution along the build direction. Printer resolution in the plane determines the size of features that may be manufactured (see Fig. 2). Printer ‘tool-paths’ also typically restrict the motion of the print head to within the boundary of the part’s cross section, resulting in rounding off sharp corners. Material deposition is usually irregular and depends on the curvature of the tool path. The geometry and topology of the as-manufactured model is largely driven by these process constraints. Additionally the uncertainty associated with the manufacturing process such as errors in locating a position to deposit material or the irregular flow of material from within a neighborhood of a printed location contribute to the variation observed between designed and manufactured parts. The resulting material properties of the fabricated part are therefore anisotropic and dependent on the build orientation.This paper formulates new representations of additively manufactured parts by simulating the layered manufacturing process, and presents a novel interoperable solution for mechanical analysis with the new representation. Specifically, the paper makes the following contributions.1.As-manufactured models are represented as the accumulation of infinitesimal material deposited at each translated print head position. Mathematically the process is described as a convolution that captures the extent of overlap of the printed shape with the nominal geometry. We show a totally ordered variational class of as-manufactured models as a function of this overlap.Process uncertainty due to positioning error as well as due to material flow from locations in a neighborhood of a position is formulated as a probabilistic membership classification of material within the as-manufactured model. The combined uncertainty is also shown to be a convolution of probability density functions of the individual uncertainties.We discuss approaches to compute convolution and show that in special but useful cases, convolution can be implemented in terms of planar morphological operations to represent the as-manufactured model as a stack of slices determined by printer resolution.The as-manufactured model represented as a stack of slices is sent directly along with boundary conditions as the input to a physical analysis routine. A three dimensional representation of the as-manufactured model, for example as a mesh, is not required to perform the analysis.In Section  2 we discuss the construction and representation of as-manufactured models using convolutions. In 2.1.1 we demonstrate that convolution can be used to model the motion of material repeatably deposited at every location of the print head and the resulting swept volume. In 2.1.2 we show the convolution also models uncertainties in material deposition arising from imprecise location of the print head as well as irregular material flow. The as-manufactured models are defined as sub-level sets of the various convolutions, and examples are shown to illustrate the effects of resolution dependence and process uncertainty on as-manufactured models. In Section  2.2 we discuss various strategies to implement as-manufactured models in terms of convolution and show a special but important case where planar morphological operations can be used to characterize deviations between manufactured and nominal geometry. In Section  3, the output of these computations are used as the input to an analysis routine in an interoperable manner to predict physical behavior on the as-manufactured part. The combination of the novel geometric representation and interoperable physical analysis is a first step towards creating new models for product lifecycle management with additively manufactured parts.Geometric variations between designed and manufactured parts will occur due to several factors such as machine resolution, build orientation, thermal physics of the manufacturing process that can lead to distortion and roughness, post processing operations such as finishing and the removal of support material (which influence part design as seen in Fig. 3), or air-gaps due to large step-over sizes in tool paths.The process and machine specific deviation of additively manufactured shapes with respect to their nominal geometry, as well as the resulting complex anisotropic material behavior imply the design model may be a poor surrogate for the manufactured model. Therefore we devise new representations of additively as-manufactured shapes that are reflective of the manufacturing process constraints and compatible with downstream applications in product lifecycle management. Specifically, we construct representations of as-manufactured models as a function of the (uncertain) motion of a print head, seen for example in material fusion (laser sintering) and extrusion (fused deposition modeling) techniques. Additive manufacturing techniques such as sheet lamination and light activated polymerization (for example using array based digital light processing) are not included in this model. Anisotropic material properties are included as a function of the build direction for structural analysis on as-manufactured models in Section  3.Given a shapeSto be printed, and the smallest three dimensional volumeFprintable by the moving head, the boundary ofSdefines the spatial limits up to which the motion of the print head is constrained. For the purposes of this paper we assumeFmay be modeled as a sphere (to model a melt pool or droplets of material), cylinder (to model the flattened layers in an FDM process), or any possibly irregular shape that can be assumed to feasibly represent the minimum volume deposited by incremental motion of the print head. In a layered manufacturing process, the motion of the print head is usually a planar translation and material is accumulated at every position over the course of a tool-path.Currently in additive manufacturing process planning the shapeFof the deposited material is not considered, and therefore the deviation from the design model is unpredictable. As mentioned earlier, in practice the material deposited at every position will vary slightly due to manufacturing uncertainties and/or due to the physics of local material accumulation, and exact characterization of such variation is quite difficult. However, empirical models of material deposition can be constructed through experimentation  [8–10] or through thermal physics analysis decoupled from manufacturing uncertainties  [11–14]. These local material models may then be used to define the shapeFused directly to construct the representations proposed in this paper.In this section we will provide a single mathematical framework that formally characterizes as-manufactured models as a function of the nominal geometry and the model defining material distribution at a spatial location. The feasible translational motions of the print head are modeled to simulate the material deposition and construct as-manufactured models, and subsequently models for uncertainty are included into this description.Initially let us assume that manufacturing error is negligible and that the machine repeatably deposits the same amount of materialFat every position. For any setX∈Rnwe defineX−1as the reflection ofXabout the origin, i.e. everyx∈Xis mapped to−x∈X−1.Given a build orientation, the maximal set of translations that constrainFto remain withinSand at most contact the boundary∂SofSis given by the expressionS⊖F−1where⊖represents the Minkowski difference operator. Similarly the maximal set of translations that constrainFto at least contact∂Sis given by the expressionS⊕F−1where⊕represents the Minkowski sum.Tool paths defining print head motion are therefore planned within a setTof translations such thatS⊖F−1⊆T⊆S⊕F−1. When a tool pathT∗inTis specified as a set of translations of the print head, the as-manufactured model is then exactly the Minkowski sumF⊕T∗. The resulting as-manufactured models in the two limiting situations are thereforeM0=(S⊖F−1)⊕FandM1=(S⊕F−1)⊕Frespectively. ClearlyM0⊂M1and there exists a class[M]of shapes such that for each as-manufactured modelMin the class,M0⊂M⊂M1.Example: For an example of an as-manufactured model, consider a slice as the intersection of a plane translated along the build direction with the appropriately orientedS. The restriction of a tool path to the interior of (planar solids in) a slice can still deposit material outsideSwhen accumulated along the build direction, often manifested as stair-stepped features on manufactured parts (see Fig. 7). The as-manufactured model is therefore contained inM1and containsM0. We demonstrate computation of this as-manufactured model in Section  2.2.3.Remark: Note that a very similar approach can be used to outline the maximal volume machinable by a translating cutting tool removing material from raw stock. For a partSand a cutting toolFthe maximal set of translations of the tool to avoid cutting into the part  [15] isSc⊖F−1. By the dual relationship between Minkowski sum and difference11A⊕B=(Ac⊖B)c.this set of translations is(S⊕F−1)c, also realizable as the complement of the translational configuration space obstacle seen in robot motion planning. The maximal machinable volume of the tool is therefore(S⊕F−1)c⊕F. Intuitively the formulations for determining as-manufactured models in subtractive and additive manufacturing are dual to each other restricting the motion ofFon complementary partitions of the contact space∂((S⊕F−1))which is the boundary of the configuration space obstacle.Elements of the class[M]of as-manufactured models defined by the translational motion ofFoverSare partially ordered by set containment. There is a totally ordered subclass of as-manufactured models which we will characterize in this paper. For a non-emptyX⊂Rndefineμ(X)as the Lebesgue measure, which is the standard volume measure for subsets ofRn. We observe that for every overlap ranging fromμ(F)atM0to some smallϵ>0at a close approximation ofM1(see Fig. 4), there exists a maximal as-manufactured model in[M]such that for any translationx∈R3that deposits materialFatxF, we haveμ(S∩∗xF)>λμ(F)where22∩∗represents regularized set intersection.λ∈[ϵμ(F),1).To characterize the class[Mmax]of maximal as-manufactured models as a function ofλ, we use properties of the convolution of indicator functions as described in the Appendix. Briefly, denoting convolution of functionsf,gasf⋆g, Eqs. (17) and (18) in the Appendix describe the Minkowski sumA⊕Band differenceA⊖Bof setsA,Bas terminal sub-level setsVα(1A⋆1B),α={0,μ(F)}of the convolution of (implicitly represented) indicator functions1Aand1B. Intuitively the convolution of indicator functions captures the extent of overlap of the moving setBwith the stationary setA. Detailed analysis of these relationships may be found in  [16,17].Therefore, it is possible to relate the translations of the print head to the resulting overlap ofFwithSas a fractionλofμ(F). Forλ∈[ϵμ(F),1), the maximal setTλof translations that ensure an overlap of at leastλμ(F)at every translation of the print head is given by a sub-level set of the convolution of indicator functions1Sand1F˜ofSandF−1(1)Tλ=Vλμ(F)(1S⋆1F˜).Intuitively, as we increase the overlap fromFminimally contactingS(λ=ϵμ(F)and the overlap isϵ) to enforcing strict containment ofFwithinS(λ=1and the overlap isμ(F)), the sub-level set of feasible translationsTλofFsuccessively decreases. The corresponding maximal as-manufactured models are defined by(2)M1−λ=Tλ⊕Fsuch that forλ1<λ2,M1−λ1⊃M1−λ2. The class[Mmax]whose elements areM1−λis totally ordered by set containment, and represents maximal as-manufactured models for overlap at leastλμ(F)at every translation of the print head. Consistent with the analysis based on Minkowski operations at the beginning of this section,M1(in the limit) represents the supremum of the[Mmax]andM0represents the infimum.We now have a new implicit representation of a variational class[Mmax]of maximal as-manufactured models whose elements may be computed using convolution. Fig. 5shows several as-manufactured models of a shapeSof a mammoth, assuming a cylindricalFthat represents the infinitesimal amount of material deposited by a nozzle along a tool path. Observe that with increasing measures of local overlap parameterized byλ, important structural features ofSsuch as the ribs or toes are lost in the maximal as-manufactured models, and topological changes (e.g. in the number of holes or connected components) between nominal and maximal as-manufactured models may occur. For an overlap ofλμ(F)the volume of excess material printed outside the nominal shapeSis bounded by(1−λ)μ(F)at any translation ofF. At a specific translationx∈Tλ, the excess material may be determined explicitly asμ(F)−(1S⋆1F˜)(x).Convolution is an attractive representation of material deposition in layered manufacturing, for it models the manufacturing process defined by the translational motion of the print head for a chosen build orientation. It is a real valued function that represents the overlap of a ‘moving’ function1F(shifted by translations inR3) over a ‘stationary’ (unshifted) function1Ssuch that the sub-level sets of this real valued function define all translationsTλthat restrict the permissible overlap ofFwithSto a pre-specified valueλμ(F). Tool pathsTλ∗can be planned from theTλto construct an as-manufactured model which is the sub level setV0(1F⋆1Tλ∗). From Fig. 5 it can also be seen that support material has to be planned separately for each as-manufactured model.Deviations between nominal and as-manufactured models such as the rounding of sharp corners or stair-stepping artifacts are unavoidable consequences of layered manufacturing. Additionally in many cases such as those shown in Fig. 2, topological inconsistencies occur when the as-manufactured shape is not homeomorphic to the nominal model. Homeomorphism is often not preserved due to different types of overlap possible betweenFand the nominal modelsS. For example, consider the erosionS⊖(F)−1in the as-manufactured model(S⊖(F)−1)⊕F. The erosion removes features such as bridges, walls, and protrusions where the printed featureFdoes not fit. In such cases the as-manufactured model is not homeomorphic toS. Given closed regular setsSandMλ, the failure of homeomorphism is due to the as-manufactured models having different homotopy type with respect to the nominal model. Informally, two sets with the same homotopy type have one–one correspondence between connected components, cycles, holes, etc.  [19]. Basic differences in homotopy type may thus be determined by counting differences in these structures betweenSandMλ.Convolution uses a representation of shape as an implicit (indicator) function, therefore it is possible to define convolutions of shapes with any real valued function. Using this observation we now show that representations of as-manufactured models may be extended to include manufacturing uncertainty.The as-manufactured models defined in Eq. (2) are derived assuming the overlap volume ofFwith the nominal geometry at every point in space is deterministic because of repeatable deposition. In reality the presence of material at every point in space is not deterministic and material deposition is better modeled in terms of a probability distribution due to the uncertainty of executing the prescribed tool path and the process dependent physics of material accumulation (e.g. from a melt pool in laser sintering or from molten plastic in fused deposition modeling).Consider material membership within the as-manufactured model at a locationz∈R3as an event derived from two independent events1.The print head moving as prescribed.Material accumulating around the point of deposition or sintering.The location of the print head is subject to positional uncertainty, and material accumulation has inherent uncertainty dependent on the physics of the material. Notice that the existence of material at a point in space is more likely if the tool path traverses near this point multiple times, for example in high curvature regions of a tool path (see Fig. 6).  With this, we letXandYbe independent continuous random variables with probability densitiesPXandPYthat model the above phenomena respectively. We are interested in the probability densityPX+Ythat determines likelihood of material membership inside the as-manufactured model.It is well known  [20] that the probability density forZ=X+Yis given by the convolution of the individual probability densitiesPXandPY.(3)PZ(z)=∫−∞∞PX(z−y)PY(y)dy(4)=PX⋆PY.This is quite easy to verify; ifZ=zwhenY=ythenX=z−y. The probability density for this to occur isPX(z−y)PY(y)due to independence of the random variablesX,Yand to obtain the total probability density thatZ=zwe need to integrate over all possible values ofYto getPZ(z). Note that if the controllers defining the print head location can be independently controlled in orthogonal axes of motion, thenPXcan be specified as a joint probability density specified by the product of the probability densities defining positional uncertainties at each axis.Tool pathsTλ∗may now be planned within the spaceTλas described in Section  2.1.1. Given a tool pathTλ∗⊂Tλ, the convolutionPZ⋆1Tλ∗defines a zone around each location on a tool path where material is likely to exist with non-zero probability. Specifying a threshold0<α<1to extract a sub-level setVα(PZ⋆1Tλ∗)that defines translations within which material is likely to exist with probability at leastα. These translations may be coupled with measures of overlap as defined in Section  2.1.1 to extract a larger variational class of maximal as-manufactured models compared to the class defined by the assumption of repeatable material deposition.As a simple example, consider the positional uncertainty along the axes of the print head controller to be defined by normal distributions such that the resulting multivariate distributionPXis a normal distribution.33The convolution of two normal distributions results in a normal distribution.If the material distributionPYis modeled as a normal distribution, we see that the convolutionPZis also a normal distribution. Fig. 6 (left) shows a path defined as an indicator function that is convolved with a normal distribution (with standard deviation of six pixels) to extract the sub level set (right) defined by a probability greater than 0.9. It may be seen that increasing the probability leads to a smaller sub-level set. Furthermore, it is also evident that the regions of high curvature on the path are more likely to have material deposited from adjacent locations, as is the case with additive manufacturing.The implicit representation of geometry in terms of indicator functions allows direct convolution with probability density functions, thus unifying the formulation of as-manufactured models with manufacturing uncertainty using a single operation.Convolution is a fundamental operation applied in several disciplines including signal and image processing, numerical methods, computer vision, statistics, and so on. When input data is a sampled function such as a signal or image, convolution is typically implemented in terms of the Fast Fourier Transform (FFT) used in conjunction with the convolution theorem. Ifnis the size of the grid to which functions are sampled, the convolution can be computed with complexityO(nlog(n)). Denoting the Fourier transform of a functionfasF(f)and the inverse Fourier transform asF−1, the convolution theorem simply states(5)f⋆g=F−1(F(f)⋅F(g)).The examples in Fig. 5 were computed using this approach. In many cases computing a boundary representation in terms of the implicit representation using isosurface extraction is more convenient than algorithms involving boundary evaluation, e.g. for level sets of convolutions with probability density functions. However, the implementation is always limited by the grid resolution used to sample the FFT, in which case indicator functions are represented as binary voxelizations. Therefore we may run into difficulties of memory overflow if very fine resolutions are chosen to capture small features (e.g. holes, thin walls) that can cause topological differences, also observed by  [21]. In such cases we must look for alternative strategies to compute and evaluate as-manufactured models.Consider the situation when the featureFcan be represented as a linear extrusion of a cross sectionXover translationsY, for example whenF=X⊕Yis a cylinder andXis a disk andYis a linear trajectory. In this special case we have1F=1X⋆1Yand1F˜=1X˜⋆1Y˜. Observe from Eq. (15) that(1S⋆1X˜)(q)=μ(S∩∗Xq)is the overlap of the cross sectionXwithS.44Note that in practice the setsXandYshould be defined as three dimensional sets (i.e. with some minimal thickness) to avoid integration on zero measure sets.Therefore given the overlap volume ofFwithSat any locationp∈R3it is possible to obtain the overlap of the cross sectionXofFwithSby computing the convolution1S⋆1X˜(p). Furthermore, the overlap ofXwithSis equivalent to the overlap ofXwith a slice ofS(assumingXand the slice have minimal thickness). We now discuss how this relationship will help us represent as-manufactured models using planar offsetting operations as opposed to sampling a three dimensional Fourier transform.Consider the special case where the cross sectionXof the minimal three dimensional printed featureFis modeled as a disk. There are two reasons this special case is important. First in the case of many layered manufacturing processes the print head depositing material has an approximately circular cross section. For example in FDM the nozzle depositing molten filament typically has a circular cross section, and in laser melting, the focused beam is assumed to have circular section to create a uniform melt pool. Also, if we assume normal distributions for the uncertainties in the position and material deposition the level sets of the combined normal density function will be circles.Given a sliceS′ofS, and the cross sectionXofF, we note that restricting the print head to the interior of the sliceS′implies the convolution1S⋆1X˜(p)at every feasible translationphas an overlapμ(X)and the maximal area covered by sweepingXinsideS′is the morphological opening(6)O(S′,X)=(S′⊖X−1)⊕X(7)=⋃{X+t:X+t⊂S′,t∈R2}.The printer specific representation of as-manufactured slicesO(S′,X)may then be used to plan tool paths in contrast to current practice of simply using the sliceS′to generate tool paths. We note that slicing in general is an inherently lossy process that cannot measure three dimensional overlap without computing the three dimensional convolution1S⋆1X˜⋆1Y˜, and containment ofXwithinS′does not necessarily imply containment ofFwithinS. However there are advantages to adopting this representation more than just directly modeling the machine specific layered manufacturing process.As shown in  [15], assuming openings with disks allows a characterization ofS′in terms of local size, defined as the distance of the boundary ofS′to its medial axis. The complement of the openingO(S′,kX)by a diskkX,k>1will outline the regions ofS′with thin walls that are printable but are below the recommended thicknesskXfor the printed material (often learned by experimentation). The two openingsO(S′,X)andO(S′,kX)allow a partition of each slice called the printability map that consists of three disjoint sets1.S′−O(S,X)represents regions that cannot be reached by the translating diskX, and therefore represents regions smaller than the smallest printable feature. Toolpaths that locate the print head in these regions will result in unplanned material accumulation.O(S′,X)−O(S′,kX)represents regions reachable by the translating diskXbut not by a larger diskkX. The radius ofkXrepresents the minimum recommended local size for the material used to print the part.O(S′,kX)represents the subset ofS′that is reachable by all translating disks larger than, and includingkX.Assuming circular cross sections has the added benefit of simplifying computations. The opening of a set by a disk can be expressed as a composition of an inward and outward polygon offset that will automatically capture rounded corners, as well as erode (via Minkowski difference) thin regions of the model. Therefore, given a set of oriented loops that define a valid polygon, standard offset and subtraction operations can be efficiently and robustly computed in the plane to represent the material deposited at every slice during additive manufacturing.Given a build orientation, the number of printed slices is determined in terms of the printer resolution along the build direction. A representation of the part as manufactured may then be obtained by computing the printability map at each sliceSi′and accumulating the openingsO(Si′,X). The bonding between layers is modeled by extruding theO(Si′,X)by a one parameter familyEof translations along the build orientation such that the extent of the translation is limited by the printer resolution. Thus the as-manufactured solid model is the regularized union(8)⋃i(O(Si′,X)⊕E).Fig. 7(right) shows a reconstruction of the as-manufactured model given the bracket shown in Fig. 7(left). The stair stepping effect of layered manufacturing is evident from the representation. Fig. 8shows the printability map for one slice of the nominal model of the bracket. Fig. 9shows a representation of extruded as-manufactured slices for the nominal model shown in Fig. 5 that highlight the printable regionO(S′,X)−O(S′,kX)below recommended local size when printed with ABS plastic on a Makerbot.The as-manufactured representations defined by Eqs. (2) and (8) are implicit but informationally complete  [22], in the usual sense that they support unambiguous point membership classification and neighborhood queries against the design modelM. In principle, these representations could be evaluated and converted to an explicit boundary representation, but we choose not to do so for several reasons. It should be apparent that explicit representation ofMas a collection of slices is an order of magnitude more complex than that ofS, because it accounts for individual manufacturing operations, features, and imperfections. Unioning boundaries of adjacent solid slicesO(Si′,X)⊕Eis likely to be problematic due to numerical errors and robustness issues. Instead, we will show that as-manufactured model defined as a collection ofO(Si′,X)can be used directly in variety of downstream applications using query-based approach to interoperability advocated in  [23].Two essential ingredients are required to implement a query-based approach: a formal semantics that defines the notion of equivalence between the models and/or systems that are required to interoperate, and a set of queries that interpret those semantics operationally in terms of computable mathematical functions. A hierarchy of geometric and topological queries that are sufficient for most applications is proposed in  [23].For example, in the simplest case of interchangeable solid models, a solidSis a closed regular subset of three-dimensional Euclidean space that may be abstracted as a set of{qp}of point membership tests; each testqpreturns a value of in, on, out, depending whether pointp​belongs to the interior, boundary, or complement ofSrespectively. The set of point queries may be infinite or corresponds to a finite cover ofS. Two solidsXandYare identical if every queryqpreturns the same answer with respect toXandY. Of course, in practice no two solids are identical, but two solids may be deemed interchangeable if they are equivalent in some application-dependent sense to a nominal reference solidS. In this case, the equivalence is established by applying the equivalence test to the queries. Ref.  [23] gives specific examples of query-based interoperability for several applications, including shape approximation, reconstruction, geometric dimensioning and tolerancing, and CAD/analysis integration.We now apply the concept of query-based interchangeability to the as-manufactured modelM. Based on the discussion in Section  2.1, we assume an as-manufactured modelMis related to nominal modelSthrough the correspondence of its shape and material properties. In particular, it is reasonable to assume that there exists a maphsuch thatM=h(S), wherehis a homotopy equivalence55SandMmay often not be homeomorphic due to manufacturing imperfections such as missed features, covered holes, and others described in Sections  2.1 and 2.2.and the Hausdorff distance betweenMandSis bounded by the Hausdorff distance betweenSandS⊕F. Clearly, maphis not unique, but in all cases,hwill also map the queries againstSto queries againstM. Thus, classificationqpfor every pointp∈Swill match that ofqh(p)for the corresponding pointh(p)∈M. Similarly, ifdpreturns the distance frompto boundary∂S, thendh(p)returns the distance to the boundary∂M, and we know that the two distances differ at most by the Hausdorff distance betweenMandS. Finally, we observe that existence of maphmay be sufficient for designing interchangeable or interoperable queries;hneeds to be constructed explicitly only when explicit application-specific correspondence betweenMandSis required.Here we only deal with the most common case of linear static analysis based on simple linear elastic model, but the approach generalizes to other types of analysis in a straightforward manner. Our formulation follows a more detailed derivation in  [24] and [23].The boundary of a three-dimensional solid domainΩis partitioned into three subsets:Γuwhere the displacements are prescribed (most commonly fixed),Γtwhere the loads (or “tractions”)Tare applied, and the free boundary. The solidΩis also subject to the body (gravity) forceF. The forces, as well as the resulting displacementsuare vector valued quantities, for exampleu=(ux,uy,uz)T, while both strainϵand stressσare second order tensor quantities represented by 3×3 matrices.Following the usual arguments, a weak discretized form of elasticity problem can be written as a system of equations  [24]:(9)−∑i=1nCi∫ΩBT[ηi]DB[ηj]dΩ︸stiffness coefficient=−∫ΩηjFdΩ︸load due to body force+∫ΩBT[ηj]DB[u∗]dΩ︸load due to applied displacements−∫ΓtηjTdΓt.︸load due to applied loadsHere we assume that the displacementuhas a general form of(10)u=∑i=1nCiηi+u∗.Note that the values of displacementsuon the boundaryΓucorrespond to the fixed boundary conditions,νiare test basis functions, and vector valued coefficientsCiare yet to be determined. Following the widely used notation in Finite Element Analysis (FEA) literature, we will useBto denote the matrix of derivatives, also known as the strain–displacement matrix, so thatϵ=B[u], andDfor the stress–strain matrix so thatσ=Dϵ.Implementation of this formulation requires that the basis functionsηivanish on portions of the boundaryΓuwhere the displacements are prescribed. This is usually achieved by converting domainΩinto a mesh of finite elements, creating an interoperability bottleneck, particularly in the case of as-manufactured modelMthat is represented implicitly. Instead, following the classical Kantorovich method  [25], choose(11)ηi=(ωx,ωy,ωz)Tχi,whereω1,ω2andω3measure (smoothed) distances to the fixed boundaries inx,yandzcoordinate directions respectively, and choose basis functionsχito be trivariate B-splines on a uniform grid whose supports completely coverΩ(see Fig. 10). The individual displacements on the boundariesΓumay be combined using inverse distance interpolation  [26] into a single global vector-valued functionu∗.The above formulation of linear static analysis requires assembling the system of linear equations  (9) by directly computing volume and surface integrals over supports of basis functionsχi. Using adaptive geometric integration  [27], computation of integrals reduces to repeated sampling and evaluation of basis functionsχiand their derivatives, material propertiesD, body forcesFas well as given boundary conditionsΓuandΓtat quadrature points either in interior or on the boundary of the solid domainΩ. In addition, two geometric queries are required: point membership testqpto determine which quadrature points lie within domainΩand distance to boundarydpquery to evaluate functionsηiper Eq. (11). Some of the above computations may be implemented more efficiently using more advanced queries, for example, Box/Solid intersection and Ray/Solid intersections, but all of such computations may be implemented in terms of point and distance computations  [22].Solving the linear system and substituting the computed values of the vector-valued coefficientsCiinto the assumed expression (10) ofuproduces an approximate solutionu(x)to the differential equation satisfying the specified boundary conditions. For additional details describing implementation of the query-based approach in commercial Scan&Solve system, the reader is referred to  [24].Fig. 10 shows the nominal modelSof the mammoth represented as a triangulated mesh, with an overlaid integration grid. The simulation problem models the effect of gravity on the skeletal structure of the mammoth with fixed base. The result of integration produces the displacement field shown rendered on the nominal geometry. We now demonstrate how the same framework will be used to query as-manufactured models to compute the solution to linear static analysis without constructing the boundary or a mesh of the three dimensional solid model ofM.When solid domainΩis a nominal solidSrepresented by its boundary, application of the above structural simulation is straightforward: boundary conditionsΓuandΓtare associated with portions of∂S, material propertiesDare given and are typically isotropic, and point and distance queries are evaluated against the given boundary representation ofS.We now apply the same query-based procedure to as-manufactured modelMthat is represented implicitly by a stack of slices per Eq. (8) (also see Fig. 12). We assume that the as-manufactured model already passed the geometric equivalence test with respect toS, therefore it is also reasonable to assume that the maphwill induce the mapping of boundary conditionsΓuandΓtonto the portions of boundary∂M. The exact mapping will depend on the type of boundary conditions. For example, it may be reasonable to restrain all points of∂Mthat are within prescribed Euclidean distance fromΓu; but the loads applied toΓtmay be applied in a work-equivalent sense only to some portions of∂Mbecause some surface points ofMmay not be accessible. For structural simulation under gravity, this mapping is particularly simple, sinceΓt=0̸andΓumaps to the bottom surface of the lowest slice in representation ofM.The only other required changes in the structural simulation procedure are representation specific implementation of point membership testqpand distance computationdp. Both are straightforward, but more efficient implementations are possible. For example, we observe that volumetric integration over thickened slices may be performed more accurately and efficiently by integrating of the planar slices and simply multiplying the thickness. Integration over a 2D slice is particularly efficient if the slice is already triangulated; and so on.Fig. 11shows a comparison between structural simulation performed on a nominal model with approximately1e6triangles (left) and the same simulation performed on the as-manufactured model (right) represented as a stack of the slicesO(Si′,kX). The ability to make comparisons between such distinct representations is enabled by the query based approach to interoperable structural simulation.While the shape ofMmay be close to that ofS, its material properties are likely to differ significantly. It is well known that structural properties of materials produced by layered manufacturing are usually orthotropic and are substantially weaker in the build direction  [3] due to incomplete inter-layer bonding. Fig. 13shows displacement results of query-based simulation on as-manufactured part representations, taking into account complete as-manufactured geometry and material properties. In Fig. 13 the rear row of mammoths assumes a 0.8 mm nozzle and therefore contains fewer details than the front row modeled using a 0.1 mm nozzle. From left to right, the material properties are isotropic injection molded ABS (E=2300MPa), averaged iso-tropic as-printed ABS (E=1370MPa), and homogenized orthotropic ABS from as-printed ABS taking into account the build direction with a [0 90 +45 −45] fill pattern (E1=1391MPa,E2=1653MPa,E3=1073MPa)  [28]. The model using the large nozzle and averaged ABS exhibits the greatest deflection due to low material stiffness and reduced geometric cross-section. Taking into account the material orthotropy and a fine nozzle yields 40% less deflection (front row, right column).

@&#CONCLUSIONS@&#
Experimental evidence has shown that as-manufactured models differ both in geometry/topology as well as material properties from nominal design. We have shown that as-manufactured parts in additive manufacturing may be efficiently represented using convolution such models may be used directly in downstream applications, such as analysis and simulations using query-based interoperable solutions. Specifically, the translational layered process may be modeled using convolution to create a variational class of as-manufactured models that may be parameterized by overlap volume, and further demonstrated that convolution can be used to characterize controller uncertainty in the shape of the final model. The proposed class of as-manufactured models captures geometric and topological deviations from the nominal model and can be used to evaluate manufacturing plans. Efficient algorithms to compute as-manufactured models, particularly as a stack of slices defined in terms of the morphological opening, have been directly used as the input to a query based structural simulation routine.Such an interoperable solution to structural simulation is not possible using conventional FEA which would require explicitly representing as-manufactured geometry as a faceted boundary representation with orders of magnitude more primitives than the nominal model. The query-based approach replaces the need for meshing by run-time queries that allow evaluating the weak form of Eq. (9) on variety of geometric representations without sacrificing rigor or accuracy of the solution. The query based solution also demonstrates the simplicity of incorporating anisotropic material properties which are used to evaluate direction dependent as-manufactured models. Constructing an optimized manufacturing process plan is beyond the scope of this paper, but the proposed representation of as-manufactured models helps in capturing important structural differences between nominal and as-manufactured parts that could be used within a manufacturing planning engine. We aim to use these representations and query based approaches to study a broader notion of equivalence between designed and as-manufactured parts for product lifecycle applications involving additive manufacturing.