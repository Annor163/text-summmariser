@&#MAIN-TITLE@&#
An ultrasound image enhancement method using local gradient based fuzzy similarity

@&#HIGHLIGHTS@&#
A novel noise suppression method based on fuzzy logic rules is proposed.Using two sets of fuzzy rules each pixel is categorized by its local gradients.Fuzzy similarity measures determine the non-local weighted restoring framework.The results are investigated using simulated and clinical medical ultrasound data.

@&#KEYPHRASES@&#
Ultrasound images,Multiplicative noise,Fuzzy IF-THEN rules,Local gradient,

@&#ABSTRACT@&#
In this paper, a fuzzy rule based filter is proposed for speckle reduction in Ultrasound (US) images. Considering a relevant US noise model this filter uses local gradients of the image and fuzzy inference to categorize image regions regarding their characteristics due to noise and structural information. Then in the restoration step each pixel is restored using fuzzy similarity criteria to weight its similar neighborhood pixels. Quantitative results on synthetic data show the performance of the proposed method compared to state-of-the-art methods. Results on real clinical images demonstrate that the proposed method is able to preserve accurately edges and structural details. As an application, this filter is used as a preprocessing step for a well-established US segmentation method known as Disk Expansion (DE). The results show an improved true diagnosis of lesion in both simulated and clinical US images.

@&#INTRODUCTION@&#
Ultrasound (US) imaging is one of the most common methods of imaging specifically in medical applications. There are a number of advantages in US medical imaging that makes it widespread. The first and the most important reason is that the US waves are not harmful for body. At the same time being low cost in design, development and maintenance and also small sized makes this imaging modality more popular. Nowadays the focus of image processing algorithms are to enhance its major disadvantage; Low resolution. The fact that US images are suffering from low resolution lies in the physics of US imaging technique. In the US imaging process, the energy of the high frequency waves produced by the probe are partially reflected and transmitted through the boundaries between tissues having different acoustic impedances. The basic idea is to collect the echoes from different tissue. Then categorize them relative to their acoustic characteristics. This phenomena plus interference effects between overlapping echoes leads to an artifact called speckle noise [1]. After the image acquisition step, also the images are log-compressed to make the visual inspection of anatomical details easier with real-time imaging capability. Nevertheless, the diagnosis quality is often low and reducing speckle while preserving anatomic information is necessary to delineate reliably and accurately the regions of interest such as cysts and lesions. In US imaging, denoising is challenging issue since the speckle artifacts cannot be easily modeled and the signal-dependent nature of the speckle must be taken into account to design an efficient speckle reduction filter [2].The speckle in US images is considered as undesirable artifacts that should be suppressed to make the radiologist diagnosis more robust; though several noise removal filters have been proposed. Unlike the additive Gaussian noise model adapted in most denoising methods, US imaging requires specific filters due to the signal-dependent nature of the speckle noise [3].In this paper we introduce a novel two step restoration method for US images. In the first step, named the “Detection step”, the image local gradients are used as input for the proposed fuzzy inference IF-THEN rules. Then all the image pixels are evaluated regarding noisy, edge and homogenous regions. In the second step which is named “Filtering” each of these regions are interpreted and denoised separately, using appropriate fuzzy similarity measures [4]. To evaluate the proposed method, we use a dedicated US noise model which is presented in [5]. In this model it is assumed that the observed signal at a pixel is a multiplicative Gaussian random variable with zero mean and a variance determined by the scattering properties of the tissue at the current pixel [6].Different experiments are included both for simulated phantom and clinical US images to evaluate the performance of this method regarding the noise suppression and detail preservation criteria. Furthermore this method is applied to US breast lesion images as a preprocessing filter to observe the improvement of a well-known segmentation method Disk Expansion (DE) [7].The remainder of the paper is organized as follows. In Section 2, we give an overview of speckle filters and related methods in the field of US image enhancement. Section 3 describes the proposed Fuzzy filter adapted to speckle noise. Quantitative results on phantom images with various noise models are presented in Section 4. Results on real 2D clinical US images are proposed in Section 5. Finally application of this method on an US segmentation scheme is investigated for both simulated and clinical images in Section 6.In this section, we present a classification of various filters and methods previously proposed for speckle reduction.The adaptive filters are widely used in US image restoration because their control parameters are easily derived [2]. The basic assumption for well known adaptive filters such as Lee [8], Frost [9] and Kuan [10] is that, speckle noise can be modeled as a multiplicative noise.Lopes et al. [11] suggested improving the Lee's and Frost's filters by classifying the pixels in order to apply specific processing to the different classes. Adaptive Speckle Reduction (ASR) filter exploits local image statistics to determine specific areas to be processed further. Considering Local Statistics, the kernel of this filter is fitted to homogeneous regions [12]. Analyzing local homogeneous regions were also investigated in [13] to spatially adapt the filter parameters. Note that the Median filter has been also examined for speckle reduction in [5]. Beside the conventional adaptive filters, a stochastic approach to US despeckling (SBF) has been developed in [14]. This local averaging method removes the local extrema assumed to be outliers in a robust statistical estimation framework. Finally the Rayleigh-Maximum-Likelihood (R-ML) filter has been derived with similar methodological tools in [15]. Among adaptive filters Lee [8] is best fit to US images and has better performance considering noise suppression, but over filtering in homogeneous areas is the main drawback of this method.Another approach to tackle the speckle reduction problem is to exploit Partial Differential Equations by defining an appropriate cost function. Adapted formulations of the Anisotropic Diffusion (AD) filter [16] and the Total Variation (TV) minimization scheme [17] have been developed for US imaging. The Speckle Reducing Anisotropic Diffusion (SRAD) uses a coefficient of variation pointing to the minimum of the cost function. In [17] multiplicative noise model is replaced with additive Gaussian noise. This assumption is valid in log-compressed US images. The Oriented SRAD (OSRAD) filter has been proposed in [18,19]; this filter takes into account the local directional variance of the image intensity, i.e., the local image geometry. Finally, the TV minimization scheme has been adapted to US imaging in [20]. Unlike the previous adaptive speckle filters, all the considered PDE-based approaches are iterative and produce smooth images while preserving edges. Nevertheless, in some cases important meaningful structural details are removed during iterations; and this is the disadvantage of these filters. Also in [21] denoising is performed using variable splitting plus augmented Lagrangian framework dealing with an optimization problem.Transform domain filters are also have popularity in US noise suppression algorithms. Here again based on the assumption that the noise is modeled by additive Gaussian distribution after log compression, the conventional wavelet thresholding methods [22] have been investigated [23]. In order to relax this restrictive assumption, Pizurica et al. proposed a wavelet-based Generalized Likelihood ratio formulation and imposed no prior on noise and signal statistics [24]. In [25], the Bayesian framework was also explored to perform wavelet thresholding adapted to the non-Gaussian statistics of the signal. Note that other multiscale strategies have been also studied in [26] to improve the performance of the AD filter. Evaluating the thresholds for transform domain is one of the most challenging issues among transform domain methods. In [27], the Kuan's filter is applied to interscale layers of a Laplacian pyramid.Most of the previously mentioned methods are based on the so-called locally adaptive recovery paradigm. It has been shown that image patches are relevant features for denoising images [28]. A patch-based non local paradigm has been proposed by Buades et al. [29]. This approach proposes to replace the local comparison of the pixels by the non local comparison of the patches. This Non-Local Means (NLM) method which was originally adapted for white Gaussian noise has competitive results regarding the state of the art filters. Also a modification of this method adapted for US noise model is presented using the Bayesian framework to redefine the patch comparison scheme called Optimized Bayesian NLM (OBNLM) [6]. Also other related methods could be found in the literature such as [30].Heuristic and knowledge-based property of fuzzy logic makes it an alternative to classical methods in image processing. Fuzzy filters have been used mostly in the case of impulse noise reduction [31,32]. In [33,34] a strong fuzzy inference mechanism is presented for detection and restoration of impulse noise pixels. Most of these methods are applied to images with applications different from medical imaging. Application of a despeckling fuzzy filter for SAR images is investigated in [35]. Fuzzy Anisotropic Diffusion Filter (FADF) used fuzzy reasoning to adapt the coefficients of variation in a classical diffusion algorithm [36,37]. Despite their success in noise suppression these methods suffer from blurred output images. In medical applications such as lesion segmentation this is not preferred. The type-II fuzzy sets proposed in [38] are used with a set of membership functions to evaluate the fuzzy edges and weight the neighboring pixels to perform the fuzzy filtering but for coherence tomography images [39]. The noise model in such images is far different from US images.

@&#CONCLUSIONS@&#
In this work a novel noise suppression fuzzy filter for US images was proposed. The structure of the proposed fuzzy filter is based on two steps: Detection and Filtering. In the detection phase the structural details of the image is extracted using two fuzzy rule bases and local gradients. As a result of this step each pixel of the image is classified to one of the noisy, edge and homogenous region. In filtering phase, each region is denoised using a non-local means scheme which the similarity weights are evaluated by fuzzy similarity criteria. Experimental results are included to show that the proposed filtering method has the versatility to be fitted to different image noise levels. The performance of this method regarding noise suppression in homogenous regions while preserving edges and detail structures for precise diagnosis in US images is examined using clinical and experimental phantom images. Furthermore application of the proposed filter is investigated using a well-known segmentation method for US images known as disk expansion method. Also in this practical case the proposed method shows its performance for both phantom and real clinical images of breast lesions.