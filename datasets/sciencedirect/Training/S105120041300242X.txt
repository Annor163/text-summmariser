@&#MAIN-TITLE@&#
Asymptotically efficient estimators for the fittings of coupled circles and ellipses

@&#HIGHLIGHTS@&#
New solutions for coupled circles and coupled ellipses fittings in explicit forms.The non-iterative solutions have computation advantage.The iterative solutions are self-initialized and achieve optimum performance.They have higher noise tolerance levels before the thresholding effects happen.They can be reduced back to the fittings of a single circle and a single ellipse.

@&#KEYPHRASES@&#
Coupled circles fitting,Coupled ellipses fitting,Explicit solution,KCR lower bound,

@&#ABSTRACT@&#
Fitting a pair of coupled geometric objects to a number of coordinate points is a challenging and important problem in many applications including coordinate metrology, petroleum engineering and image processing. This paper derives two asymptotically efficient estimators, one for concentric circles fitting and the other for concentric ellipses fitting, based on the weighted equation error formulation and non-linear parameter transformation. The Kanatani–Cramér–Rao (KCR) lower bounds for the parameter estimates of the concentric circles and concentric ellipses under zero-mean Gaussian noise are provided to serve as the performance benchmark. Small-noise analysis shows that the proposed estimators reach the KCR lower bound performance asymptotically. The accuracy of the proposed estimators is corroborated by experiments with synthetic data and realistic images.

@&#INTRODUCTION@&#
The fitting of a geometric object to a set of noisy data points has been a fundamental and important problem that has applications in many areas including coordinate metrology [1], aquifer characterization and petroleum engineering [2], computer graphics [3] and object classifications [4,5]. Recently, it has attracted research interests for biometric matching [6] and robotic applications [7].Among different geometric shapes for data fitting, circle and ellipse are most popular. Circle and ellipse fittings are challenging non-linear estimation problems. Many methods for circle fitting have been proposed over the years [8–16]. The Kåsa method [8,9], which has a closed-form solution and is simple to apply, appears to be the most widely used in practice. It is able to reach the Cramér–Rao Lower Bound (CRLB) [14] accuracy when the noise components in x and y coordinates are independent and have equal variances (isotropic observation noise) [15]. The ellipse fitting problem is more difficult than the circle fitting and conic formulation is often used. A few closed-form solutions are presented in [17,18] and [19]. Iterative solutions include the Fundamental Numerical Scheme (FNS) [20], the Heteroscedastic Errors-In-Variables (HEIV) method [21,22] and the renormalization method [23]. These iterative methods have better performance than the closed-form solutions and they have been proven analytically to reach the Kanatani–Cramér–Rao (KCR) lower bound [24] accuracy.All of the above circle and ellipse fitting solutions as well as the KCR lower bound are designed for a single circle or ellipse. Not many studies in the literature are available for the fitting of coupled geometric objects, such as concentric circles and concentric ellipses. Many objects encountered in practice are circularly concentric. A simple example is the inner and outer boundaries of a pipe. Another example is the inner and outer edges of an iris image. When viewing from different angles, concentric circles would become concentric ellipses. The concentric circles and concentric ellipses fitting methods proposed here have potential use in automatic inspection for pipes, iris recognition for biometric applications, calibration for cameras and ellipticity estimation of steel coils. Kim et al. [25] solved the camera calibration problem by determining the position of a projected circle center through concentric circles formulation. Motivated by determining the original size of the ruined Abhayagiriya stupa, Dampegama [26] provided a specific solution to this problem using concentric circles estimation. [27–29] presented more general solutions to the concentric circles/ellipses estimation problems. Benko et al. [27] considered simultaneous fitting of multiple curves and surfaces for reverse engineering using an iterative method that requires good initial guesses. The work by Marot and Bourennane [28], although it is extendable to concentric circles fitting, focused on the radius estimation only. OʼLeary et al. [29] proposed a quadratically constrained total least-squares method for the fitting of coupled geometric objects in metric vision. This method yielded closed-form solution under isotropic noise but no KCR lower bound performance evaluation was given.In this paper we develop new solutions for the fittings of concentric circles and concentric ellipses without requiring uncorrelated noise assumption. The proposed estimators are based on non-linear transformation of the unknown parameters to be estimated through the formulation of weighted equation error minimization. The proposed solutions have explicit forms. It can produce a non-iterative solution but the performance is suboptimal. Self-initialized iterative refinement can improve the estimation accuracy to optimum. To validate the efficient performance of the proposed solutions, we also provide the KCR lower bounds for the concentric circles and concentric ellipses fitting problems.The proposed concentric circles and concentric ellipses estimators are different from the previous solutions in [25,26] which are specific to their particular problems. More importantly, comparing to [29] the proposed estimators are shown analytically and validated by simulations to achieve asymptotically (over the small-noise region) the optimum KCR lower bound performance. When contrasting to FNS and HEIV methods extended to the fitting of coupled objects, the proposed estimators have higher noise tolerance levels before the thresholding effects take place.The proposed methods can be reduced back to the fittings of a single circle and a single ellipse. In such cases, they maintain the KCR lower bound performance for both isotropic and anisotropic noise. Anisotropic noise, meaning that the noise components in the x and y coordinate points are correlated, occurs quite often in practice such as in robotics and archaeology [7,16].In this paper, we use the common notations that bold capital letters represent matrices and bold lower case letters denote vectors.(⁎)ois the true value of(⁎)andΔ(⁎)is the error component of(⁎)so that(⁎)o+Δ(⁎)=(⁎). The subscript c of a variable indicates it is for concentric circles and e for concentric ellipses, unless stated otherwise.The organization of this paper is as follows. Section 2 formulates the estimation problems. Section 3 derives the estimators for concentric circles and concentric ellipses through parameter transformation and equation error formulation. Section 4 provides the KCR lower bounds for the fitting problems under additive zero-mean Gaussian noise. Section 5 analyzes the proposed solutions and compares their performance with the KCR lower bounds. Section 6 presents simulations and experimental results to support the theoretical developments and provides performance comparisons with some existing fitting methods. Section 7 concludes the paper.For ease of illustration, we shall only consider a pair of objects that has two circles or two ellipses coupled together. The coupled geometric shapes considered here have the same center and are scaled versions of each other. Examples of such kind of objects include the inner and outer boundaries of a pipe and the inner and outer edges of an iris. The derived solutions can be easily extended to more than two coupled geometric shapes or reduced to one in a very direct manner.LetNibe the number of data points on the i-th component of the coupled objects,i=1,2. The data from the coupled objects are modeled as(1)sij=sijo+nij,j=1,2,…,Ni,i=1,2,wheresij=[xijyij]Trepresents the2×1vector containing the Cartesian coordinates of a data point,sijo=[xijoyijo]Tis the true value andnij=[nxijnyij]Tis the observation noise ofsij.In the case of concentric circles,sijosatisfies the following relation(2)‖sijo−co‖2=rio2,whereco=[aobo]Tis the common circle center,r1oandr2oare the two circle radii, and‖⁎‖is the Euclidean norm. The unknown parameters we intend to estimate areθco=[aobor1or2o]T.For concentric ellipses having the same shape and orientation as those considered in this study,sijofulfills the ellipse equation(3)(sijo−co)TΓio(sijo−co)=1,Γ1o=[A1oρ1oρ1oB1o],Γ2o=[A2oρ2oρ2oB2o]=εoΓ1o,whereco=[aobo]Tis the common ellipse center,εois a positive constant scalar andΓiodefines the size, eccentricity and rotation angle of ellipse i. In our convention, ellipse 1 is the smaller one. The semi-major and semi-minor axes of ellipse i are equal to[Aio+Bio±(Aio−Bio)2+4ρio22(AioBio−ρio2)]1/2and the rotation angle with respect to the x-axis istan−1(−(Aio−Bio)−(Aio−Bio)2+4ρio22ρio). The unknown parameters to be estimated areθeo=[aoboA1oρ1oB1oεo]T.For notation simplicity, we shall collect allN=N1+N2measurement data points together and represent them as(4)s=so+n,wheres=[s11T,…,s1N1T,s21T,…,s2N2T]Tis a2N×1vector,sois the true value of s andn=[n11T,…,n1N1T,n21T,…,n2N2T]Tis the noise vector. In this study, we shall model n as zero-mean Gaussian with a covariance matrix equal to Q. In general, Q is not diagonal and examples are in robotics [7] and archaeology [16] applications. In most cases, it is reasonable to assumenikandnil, fork≠l, are independent so that Q is block diagonal while the elements innijare correlated. It should be noted that the proposed fitting solutions and the KCR lower bound do not require Q to be of any particular form.In this section, we derive the proposed estimators for concentric circles and concentric ellipses based on parameter transformation and weighted equation error formulation.Expressing the true data point assijo=sij−nijin (2) gives‖sij−co−nij‖2=rio2. Expanding the square on the left and rearranging the terms yield(5)2(sij−co)Tnij−nijTnij=‖sij‖2−2sijTco−(rio2−‖co‖2).The left side is the equation error and the right side is its functional dependency on the concentric circles parameters. Collecting all N equations forj=1,2,…,Niandi=1,2gives(6)Bcn−η=hc−Gcφco,where(7)Bc=2[(s11−co)T⋯0T0T⋯0T⋮⋱⋮⋮⋱⋮0T⋯(s1N1−co)T0T⋯0T0T⋯0T(s21−co)T⋯0T⋮⋱⋮⋮⋱⋮0T⋯0T0T⋯(s2N2−co)T],(8)hc=[‖s11‖2⋮‖s1N1‖2‖s21‖2⋮‖s2N2‖2],Gc=[2s11T10⋮⋮⋮2s1N1T102s21T01⋮⋮⋮2s2N2T01],φco=[cor1o2−‖co‖2r2o2−‖co‖2].InBc, 0 is a2×1vector of zero. n is defined below (4) andηis anN×1vector whose elements arenijTnij.φcois the re-parameterization form ofθcoand there is a unique one-to-one mapping relationship between them becauseriois always positive.φcois the unknown vector to be found.The measurement equation (6) is linear with respect toφco. When the SNR is sufficient such that the second order noise components are negligible,Bccan be treated as nearly noiseless andηis insignificant. Since n is Gaussian, if we ignore the dependency ofBcwithco, the negative of the log-likelihood function corresponding to (6) for minimization is(hc−Gcφco)TWc(hc−Gcφco), whereWcis the weighting matrix equal to the inverse of the noise covariance [30]:(9)Wc=(BcQBcT)−1.Other choices of the weighting matrix could be used instead, which would result in higher estimation variance and different amount of bias. Note thatWccontains the concentric circles center which is unknown to us. Some previous studies show that error in the weighting matrix does not affect the solution accuracy much [31]. Assuming some approximation ofWcin (9) is available, the solution ofφcois(10)φc=(GcTWcGc)−1GcTWchc.SinceGccontains the noisy measurementssi, the ill-conditioned problem may occur, although very rarely, in performing the inverse in (10). In such a case, pseudo inverse should be used instead.The solution strategy is therefore settingWcto identity to obtain an initial estimate ofφco(the least-squares solution), from which a betterWccan be generated to yield a better solution. The process can be iterated to improve performance. The convergence of the iterations has been studied in [32]. Through extensive simulations, we find that iterating Eqs. (7)–(10) twice is sufficient. Further iterating to regenerate the weighting matrix is not likely to yield better results.The proposed solution (10) is expected to behave similarly to the ML solution obtained directly from the data model (1) when the SNR is high. The transformation we use here is non-linear and introduces higher order noise components. Hence we expect the proposed solution will deviate from the actual ML solution as the SNR decreases. The proposed concentric circles estimator is translation invariant.From the definition ofφcoin (8), the estimate ofθcocan be found fromφcas(11)θc=[φc(1)φc(2)φc(3)+φc(1)2+φc(2)2φc(4)+φc(1)2+φc(2)2].The proposed estimator uses the expanded form of the ellipse equation (3). Usingsijo=sij−nijand multiplying outsijoTΓiosijogive(12)2(sij−co)TΓionij−nijTΓionij=xij2Aio+2xijyijρio+yij2Bio−2sijTΓioco+coTΓioco−1.When the noisenijis zero, (12) becomes the familiar conic equation of the formA¯x2+B¯xy+C¯y2+D¯x+E¯y+F¯=0in ellipse fitting [17].For simplicity, let(13)ko=coTΓ1oco−1.We have from ellipse 1(14)2(s1j−co)TΓ1on1j−n1jTΓ1on1j=x1j2A1o+2x1jy1jρ1o+y1j2B1o−2s1jTΓ1oco+ko.For ellipse 2, sinceΓ1oandΓ2oare related byΓ2o=εoΓ1ofrom (3), we have(15)2(s2j−co)TΓ1on2j−n2jTΓ1on2j=x2j2A1o+2x2jy2jρ1o+y2j2B1o−2s2jTΓ1oco+ko+εo−1εo.The unknowns are considered to beA1o,ρ1o,B1o,Γ1ocoandεo−1εo, which are re-parameterizations of the elements in vectorθeo. Collecting all N equations from (14) and (15) in matrix form yields(16)Ben−ηˆ=kohe−Geφeo,where(17)Be=2[(s11−co)TΓ1o⋯0T0T⋯0T⋮⋱⋮⋮⋱⋮0T⋯(s1N1−co)TΓ1o0T⋯0T0T⋯0T(s21−co)TΓ1o⋯0T⋮⋱⋮⋮⋱⋮0T⋯0T0T⋯(s2N2−co)TΓ1o],he=[1⋮11⋮1]N×1,φeo=[Γ1ocoA1oρ1oB1oεo−1εo],(18)Ge=[2x112y11−x112−2x11y11−y1120⋮⋮⋮⋮⋮⋮2x1N12y1N1−x1N12−2x1N1y1N1−y1N1202x212y21−x212−2x21y21−y212−1⋮⋮⋮⋮⋮⋮2x2N22y2N2−x2N22−2x2N2y2N2−y2N22−1].InBe, 0 is a2×1vector of zero. n is defined below (4) andηˆis anN×1vector whose elements arenijTΓ1onij. Note that bothkoandφeoare related to the concentric ellipses parameter vectorθeo.The measurement equation (16) is linear with respect toφeo. By following the same argument as in the concentric circles case, the negative of the log-likelihood function corresponding to (16) for minimization is(19)(kohe−Geφeo)TWe(kohe−Geφeo),whereWeis the weighting matrix and the choice of it will be discussed later in this subsection. Note that (19) is in quadratic form with respect to the unknownsφeoandko. Minimizing (19) with respect to them will give the unwanted trivial solutionsφe=0andk=0. To avoid the trivial solutions, the monic constraint should be imposed in (19), which is described below.The monic solution rewrites the cost function (19) as(20)(he−Ge(φeo/ko))T(ko2We)(he−Ge(φeo/ko))and solves forφeo/koonly.Weis the weighting matrix chosen to be the inverse of the noise covariance(21)We=(BeQBeT)−1to achieve the minimum variance of solution estimate [30]. Other choices of the weighting matrix could be used. However, the estimation variance will be higher and the amount of bias is different. Similar to the concentric circles case,Wecontains the ellipse parameters which are unknown to us. Assuming some approximation ofWein (21) is available, the solution ofφeo/kois(22)(φe/k)=(GeTWeGe)−1GeTWehe.If the ill-conditioned problem occurs, pseudo inverse will be used instead. The mapping ofφe/kback to c,Γ1and ε will give the concentric ellipses parameter vector estimateθe. In particular, usingΓ1/kobtained from the third to the fifth element ofφe/ktogether with the first two elements gives c. PuttingΓ1/kand c into the definition ofkoin (13) fixes k and henceΓ1can be determined. Using k and the last element ofφe/kgives the estimate of ε.The solution strategy is first settingWeto identity to obtain an initial estimate ofφeo/ko(the least-squares solution), from which a betterWecan be generated to yield a better solution. Through extensive simulations, we find that iterating Eqs. (17)–(22) twice is sufficient. Further iterating to regenerate the weighting matrix does not lead to much improvement in accuracy.The proposed solution (22) is expected to behave similarly to the ML solution obtained directly from the data model (1) when the SNR is high, based on the same rationale as in the concentric circles case.The monic solution requireskoto be not close to zero. To ensure this requirement, we add to the x and y coordinate points of the measurements a large constant, 500 in our case. After obtaining the monic solution we can simply subtract this constant out from the center estimate. The other parameter estimates are not affected by the translation in the data points. In Appendix A we provide a formal mathematical justification of our strategy regarding toko.Kanatani [33] has derived the lower bound for the parameter estimation accuracy of an unbiased curve fitting estimator. However, most of the existing curve fitting estimators from the literature are biased. Chernov and Lesort [24] modified the lower bound from Kanatani for biased estimator and called it the KCR lower bound. The KCR lower bound applies to the fitting problem of any algebraic curve and provides the lower bound on the leading term of the mean-square parameter estimator error.In this section, we present the KCR lower bounds for the fittings of concentric circles and concentric ellipses that are derived based on the formulations in [24] and [34].For the concentric circles fitting, the unknown parameter vector isθco=[aobor1or2o]T. Its KCR lower bound is(23)KCR(θc)=[PcoT(BcoQBcoT)−1Pco]−1,where(24)Bco=2[(s11o−co)T⋯0T0T⋯0T⋮⋱⋮⋮⋱⋮0T⋯(s1N1o−co)T0T⋯0T0T⋯0T(s21o−co)T⋯0T⋮⋱⋮⋮⋱⋮0T⋯0T0T⋯(s2N2o−co)T],Pco=2[pc,11o⋯pc,1N1opc,21o⋯pc,2N2o]T,pc,1jo=[(s1jo−co)Tr1o0]T,j=1,2,…,N1,(25)pc,2jo=[(s2jo−co)T0r2o]T,j=1,2,…,N2.InBco, 0 is a2×1vector of zero. Q is the covariance matrix of the measurement data.The unknown parameter vector for the concentric ellipses fitting isθeo=[aoboA1oρ1oB1oεo]T. The KCR lower bound ofθeois(26)KCR(θe)=[PeoT(BeoQBeoT)−1Peo]−1,where(27)Beo=−2×[(s11o−co)TΓ1o⋯0T0T⋯0T⋮⋱⋮⋮⋱⋮0T⋯(s1N1o−co)TΓ1o0T⋯0T0T⋯0T(s21o−co)TΓ1o⋯0T⋮⋱⋮⋮⋱⋮0T⋯0T0T⋯(s2N2o−co)TΓ1o],Peo=2[pe,11o⋯pe,1N1ope,21o⋯pe,2N2o]T,pe,1jo=[−(s1jo−co)TΓ1oq1jT0]T,j=1,2,…,N1,pe,2jo=[−(s2jo−co)TΓ1oq2jT1εo2]T,j=1,2,…,N2,(28)qij=[12(xijo−ao)2(xijo−ao)(yijo−bo)12(yijo−bo)2]T.InBeo, 0 is a2×1vector of zero. Q is the covariance matrix of the measurement data.In this section we perform the first order analysis of the proposed solution by evaluating its covariance matrix. The first order analysis is valid when the measurement noise is small. After obtaining the covariance matrix, we shall compare it with the KCR lower bound.The relation betweenθcandφcis given in (11). Taking the differential on both sides of (11) with respect to the true values gives(29)Δθc=ΦcoΔφc,Φco=[10000100aor1obor1o12r1o0aor2obor2o012r2o].The estimateθcfrom (11) has negligible bias under the first order approximation and its covariance matrix is(30)cov(θc)=Φcocov(φc)ΦcoT.From the theory of Weighted–Least–Squares (WLS) minimization [30], we havecov(φc)≃(GcoTWcoGco)−1when the noise is small, whereGcoandWcoareGcin (8) andWcin (9) when replacing the noisy values by the true values. Hence the covariance matrix ofθcfor the proposed method is(31)cov(θc)≃[Φco−TGcoTWcoGcoΦco−1]−1.We shall next comparecov(θc)with the KCR lower bound which is given in (23) and has the same structural form ascov(θc)in (31). Using the definitions ofPcoin (25) andΦcoin (29), we can verify thatPcoΦco=−Gcoand hence(32)GcoΦco−1=−Pco.Under the first order analysis, (9) can be approximated as(33)Wc≃(BcoQBcoT)−1whereBcois defined in (24). Putting (32) and (33) into (31) yields(34)cov(θc)≃[PcoT(BcoQBcoT)−1Pco]−1=KCR(θc).Thus the proposed concentric circles estimator reaches the KCR lower bound accuracy under the first order analysis.We shall perform the analysis of the proposed estimator with the monic constraint. For simplicity we shall denoteφe/kasφˆeandΓ1/kasΓˆ1. The monic solutionφˆeis given in (22). From the definition ofφeoin (18), the differentials of the first two elements ofφˆeare(35)Δφˆe(1:2)=Γˆ1oΔc+ΔΓˆ1co.Γˆ1is given by the third to the fifth elements ofφˆe, whose errorΔΓˆ1can be expressed in terms ofΔφˆe(3:5). Accordingly, we have(36)Δθe(1:2)=Δc=VabTΔφˆe,where(37)Vab={koΓ1o−1[10−coT00010−coT0]}T,andΓˆ1o=Γ1o/kohas been used. The subscript ab ofVabrepresents that it is for the concentric ellipses center.The value k is equal to[cTφˆe(1:2)−1]−1from (13) and its differential isΔk=−ko2[coTΔφˆe(1:2)+φˆeo(1:2)TΔc]. Usingφˆeo(1:2)=Γˆ1oco=Γ1oco/kofrom (18) andΔcfrom (36), we have(38)Δk=vkTΔφˆe,where(39)vk≜−ko([kocoT0T]+coTΓ1oVabT)Tand 0 is a4×1vector of zero. Sinceθe(3:5)=kφˆe(3:5)according to (18), their differentials are(40)Δθe(3:5)=koΔφˆe(3:5)+φˆeo(3:5)Δk=VΓTΔφˆewhere(41)VΓ=([OkoI0]+φˆeo(3:5)vkT)T,O is a3×2matrix of zero, I is the identity matrix of size 3, 0 is a3×1vector of zero and (38) has been used.The value of ε is[1−kφˆe]−1from (18). Its differential isεo2[koΔφˆe(6)+Δkφˆeo(6)]and by using (38) we arrive at(42)Δθe(6)=vεTΔφˆe,where(43)vε=εo2([0Tko]+εo−1εokovkT)Tand 0 is a5×1vector of zero. Thus from (36), (40) and (42), we obtain the relationship between the errors inθeandφˆeas(44)Δθe=ΦeoΔφˆe,Φeo=[VabVΓvε]T.Under the first order approximation, the covariance matrix ofθeis(45)cov(θe)=Φeocov(φˆe)ΦeoT.When the noise inGeandBeare small enough to be neglected, the covariance matrix ofφˆefrom WLS minimization [30] is(46)cov(φˆe)≃(GeoTWeoGeo)−1,whereGeoandWeoareGein (18) andWein (21) when replacing the noisy quantities by their true values. SinceΦeois invertible, substituting (46) into (45) yields the covariance matrix ofθeas(47)cov(θe)=(Φeo−TGeoTWeoGeoΦeo−1)−1.The KCR lower bound for the concentric ellipses parameters is given in (26), which has the same structural form ascov(θe)in (47).From (28) and (44), performing direct matrix multiplication and using the ellipse equation (3) for simplification givePeoΦeo=−Geo. Hence(48)GeoΦeo−1=−Peo.Also,Wein (21) can be approximated as(49)We≃(BeoQBeoT)−1under the first order approximation where the noise level is low. The substitution of (48) and (49) into (47) gives immediately(50)cov(θe)≃[PeoT(BeoQBeoT)−1Peo]−1=KCR(θe).In other words, the proposed concentric ellipses fitting method achieves the KCR lower bound performance asymptotically.We shall examine the performance of the proposed estimators and support the theoretical developments using synthetic data and actual image captures. Their results will be presented separately.Unless specified otherwise, theN=N1+N2data points are collected randomly (with a uniform distribution) along partial segments of the coupled circles or coupled ellipses. The noisy measurements are generated by adding zero-mean Gaussian noise to the true data points. The noise covariance matrix Q isdiag{R,R,…,R}, where R is a2×2matrix equal toσ2[1δδ1]and δ is the correlation coefficient in the x and y noise components. In most curve fitting studies, using a scaled identity matrix for Q is sufficient [24,33]. However, in application such as archaeology, the elements innijfor each data point can be correlated due to the process of digitizing [16]. In practice, the noise powerσ2and the noise correlation factor δ can be estimated from data measurements [16]. The estimation accuracy is presented using the mean-square error (mse) of the estimate of the unknown vectorθ, which is computed asmse(θ)=∑l=1L‖θ(l)−θo‖2/L, whereθ(l)is the solution obtained at ensemble run l,θois the true value and L is the number of ensemble runs. L is equal to10000throughout the simulations unless stated otherwise. The results for the concentric circles and the concentric ellipses will be shown separately in sequel, as well as the ones of the single circle and the single ellipse.The common center of the concentric circles isco=[00]Tand the two radii arer1o=10andr2o=20. In addition to the proposed estimator, the estimation results from the method proposed by OʼLeary et al. [29], the Kåsa method [8,9] and the Pratt method [3] are also shown for comparison purpose. When applying the Kåsa method on the concentric circles, the parameters of the two circles are obtained independently and the common circle center estimate is computed as the average of the two independent circle center estimates.Figs. 1 and 2compare the performance of the proposed estimator (× symbol) with the OʼLeary method (◯ symbol) and the Kåsa method (+ symbol) for the concentric circles center and radii estimates. We randomly sampled 10 data points from each of the two arcs of the concentric circles starting from 0 to π rad, i.e.N1=N2=10. The noise powerσ2varies from10−4to 10 and the correlation coefficient δ is 0.8. Fig. 1 shows that the proposed estimator reaches the KCR lower bound accuracy for the concentric circles center estimate very well as expected from the theory. The OʼLeary and the Kåsa methods have constant differences of about 2.7 decibel (dB) and 1.5 dB with the KCR lower bound before the noise power reaches 1, above which larger deviations occur. For the radii estimates shown in Fig. 2, the observations are similar in which the proposed method attains the KCR lower bound accuracy until the noise power exceeds 0.1 while the OʼLeary and the Kåsa methods always deviate away from the bound.To investigate a little further, we compared the estimation bias when the weighting matrixWcis equal to (9) and when it is set to be an identity matrix for the simulation case corresponding to Figs. 1 and 2. The results are tabulated in Table 1when the noise level is fixed at10−4. It clearly shows the effect of weighting matrix on the bias. For concentric circles, whenWcis equal to (9) the bias is about 0.5 dB larger than the one ifWcis equal to an identity matrix. However, choosingWcas in (9) did provide smaller estimation variance. It is non-trivial to analyze how the weighting matrix would affect the estimate bias theoretically. We plan to look at it in more detail and report the findings elsewhere.The proposed concentric circles estimator can also generate a non-iterative solution by settingWcin (10) to an identity matrix. In such a case, its performance would be suboptimal. Figs. 3 and 4show the results of the non-iterative solution together with those from the OʼLeary and Kåsa methods. From the plots we can observe that the performance of the non-iterative solution is similar to the one from the OʼLeary method for both the concentric circles center and radii estimates. It is slightly worse than the Kåsa method for the center estimate but yields better results for the radii estimates. However, the proposed solution in non-iterative form is more computational efficient than the OʼLeary and Kåsa methods. Table 2shows the relative computation time in matlab over 10 000 ensemble runs when the noise power is10−4. The non-iterative solution requires less computation time than the other two methods. The iterative solution of the proposed estimator requires more computation time than the non-iterative version but provides much better estimation performance.The proposed estimator can reduce back for the fitting of a single circle. By using the same setting as in Figs. 1 and 2, Figs. 5 and 6examine the performance of the proposed estimator when the data points are only from the arc of the circle whose radius is 10. The proposed method is able to attain the KCR lower bound accuracy for both the single circle center and radius estimates whenσ2is less than10−0.5while the Kåsa and Pratt methods are not able to reach the KCR lower bound performance at all.To supplement Figs. 3–6, we show in Table 3numerically the performance difference with the KCR lower bounds of different estimators. The values given are obtained by averaging over the range of noise power varying from10−4to 0.1.The concentric ellipses center isco=[00]T, the semi-major and semi-minor axes of the inner ellipse (ellipse 1) are 20 and 6.67, the rotation angle isπ/6rad (A1o=0.0075,B1o=0.0175,ρ1o=−0.0087). The scale factor betweenΓ1oandΓ2oas defined in (3) isεo=0.25.The performance of the OʼLeary method [29], the Taubin method [17], the FNS method [20] and the HEIV method [21] are also evaluated for comparison. Note that except the OʼLeary method, these methods are originally developed for the single ellipse fitting based on the conic ellipse equations and we have extended them for coupled ellipses. We convert their conic parameter estimates to ellipse parameters as defined in (3) when performing the comparison.Fig. 7gives the result of the concentric ellipses center estimate asσ2increases from10−4to 1, when the noise correlation coefficient δ is −0.6 andN1=N2=10data points are sampled randomly from the concentric ellipses portions that are above the common major axis. The proposed estimator (× symbol), the FNS method (△ symbol) and the HEIV method (∇ symbol) attain the KCR lower bound accuracy very well whenσ2is not larger than10−2.5. After that, the FNS method deviates from the bound. Whenσ2reaches 0.1, only the proposed method attains the KCR lower bound accuracy.With the same settings as in Fig. 7, Fig. 8shows the results of the estimatesΓ1(A1,ρ1andB1) and ε. The upper set of results is for ε and the lower one is forΓ1. The estimation accuracy of the proposed estimator and that of the HEIV method achieve the KCR lower bound whenσ2is not larger than10−1.5. We can observe from Figs. 7 and 8 the proposed method has a higher noise tolerance of the thresholding effect than the FNS and HEIV methods.We compare the estimation bias when the weighting matrixWeis equal to (21) and when it is set to an identity matrix for the simulation case corresponding to Figs. 7 and 8, and the results are tabulated in Table 1 at the noise level10−4. The resulting bias and variance whenWeis chosen as (21) are both smaller than the ones ifWeis equal to an identity matrix. It is non-trivial to analyze how the weighting matrix would affect the estimate bias theoretically. We plan to look at it in more detail and report the findings elsewhere.A non-iterative solution can be generated from the proposed concentric ellipses estimator by replacingWein (22) with an identity matrix. Using the same settings as in Figs. 7 and 8, Figs. 9 and 10give the estimation performance of the non-iterative solution (× symbol), the OʼLeary method (◯ symbol) and the Taubin method (Δ symbol). Whenσ2is not larger than10−2.5, the non-iterative solution has a similar performance as the other two methods. However, Table 2 indicates that the non-iterative solution is more computation efficient than the others. The relative computation time is obtained from matlab over 10 000 ensemble runs at the noise level of10−4. The iterative solution of the proposed estimator requires more computation time than the non-iterative version but provides much better accuracy.The proposed estimator can be simplified for the single ellipse fitting. Figs. 11 and 12examine the performance of the proposed estimator using the same set of data sampled from the inner ellipse as in Figs. 7 and 8. The proposed estimator attains the KCR lower bound accuracy beforeσ2reaches 0.01, while the Taubin and Fitzgibbon methods are not able to reach the bound at all. There is significant bias in the center estimate of the Fitzgibbon method whenσ2>0.01, making its mse lower than the KCR lower bound. The performance degradation of the proposed estimator whenσ2is larger than 0.01 is caused by the thresholding effect in non-linear estimation.We shall apply the proposed estimators on several real images to test their performance. The real images we use here are either taken by a digital camera or from the iris database CASIA-IrisV3 [35] collected by the Chinese Academy of Sciencesʼ Institute of Automation (CASIA).The left parts of Figs. 13 and 16depict images of the concentric circles and concentric ellipses captured by a digital camera with a640×480resolution. The images are clean and have been converted to 8 bpp gray scale with each pixel value between 20 and 224. To examine the estimatorsʼ performance under noise, we normalize the gray scale images by 255, add zero-mean Gaussian white noise of certain powerξ2, truncate each pixel value to be within 0 to 1 and multiply by 255 to restore the original dynamic range. The Canny edge detection [36] is applied to the noisy images to obtain the edges of the concentric circles and concentric ellipses. The edges are converted to binary images as shown on the right parts of Figs. 13 and 16. The binary images define the data points on which the proposed estimators are applied.Using the data points from concentric circles edges in Fig. 13, Figs. 14 and 15examine the performance of the proposed estimator (× symbol) and compare it with the OʼLeary method (◯ symbol). The noise covariance Q is a scaled identity matrix in (9) for the proposed method.N1=N2=20data points are randomly sampled from each of the concentric circles edges. The powerξ2of the zero-mean Gaussian white noise added to the original image before edge detection is varied from10−4to10−1.4andL=5000ensemble runs are performed at each noise power level. Instead of the mse, the variances of the parameter estimates are shown for the performance comparison because the true parameter values are not known. Fig. 14 indicates the variance of the center estimate from the proposed method is lower than that from the OʼLeary method. The difference between them is about 2 dB when the noise power is not larger than10−1.8. This amount of performance improvement is consistent with the mse results we have in Fig. 1. Note that the edge detection is in terms of pixel coordinates in integers and the noise in the data is quantized to integer values. As a result, when the noise power varies from10−4to10−1.8, the parameter estimation variance only changes slightly, and when the noise power reaches higher values it increases sharply. We observe from Fig. 15 the proposed method has only slight performance improvement on the radii when the noise power is larger than10−3, much less than those shown in Fig. 2. It is because the Gaussian noise used in this experiment is white (δ=0) while the one in Fig. 2 is anisotropic with a correlation coefficientδ=0.8. The improvement in radii estimates increases when δ increases.Fig. 17shows the variances of the concentric ellipses center estimate when 20 data points are sampled randomly from each of the concentric ellipses boundaries andξ2varies from10−4to 0.1. In (21), the noise covariance Q is set proportional to an identity matrix for the proposed method. The estimation variance of the OʼLeary method (◯ symbol) is always higher than the one of the proposed method (× symbol) by about 2 dB whenξ2⩽10−1.6. This is consistent with the simulation results in Figs. 7 and 9. Since the noise in the data points is quantized, the parameter variances of both methods vary only slightly as the noise power increases and they jump to much higher values when the noise power exceeds10−1.6.Fig. 18shows the estimation performance of theΓ1and ε parameters. The upper set of results is for ε and the lower one is forΓ1. Since the Gaussian noise added here is white (δ=0), we do not observe the performance improvement from the proposed method as indicated in Figs. 8 and 10 where the Gaussian noise is anisotropic with a correlation coefficientδ=−0.6. If correlated Gaussian noise is used, the performance improvement will be more apparent.One main application of ellipse fitting is in biometrics for iris recognition [37,38]. Iris recognition requires accurate extraction of the inner and outer boundaries of the iris (pupil and limbus). We shall show below the experimental results of applying the proposed concentric ellipses estimator withQ=Iin (21) to the edge data points extracted from an iris image. The iris (eye) images are from the CASIA-IrisV3 iris database with a resolution of320×280pixels. The images are processed directly without adding any noise. However, due to the blurring behavior in the images, the exacted edges will have inherent noise. Each figure to be presented has four subfigures. The upper left subfigure shows all the edges detected from the original eye image using the Canny edge detection technique [36]. The upper right subfigure shows only the edges belonging to the inner and outer boundaries of the iris. The lower left subfigure displays the original eye image with the estimated concentric ellipses from the proposed method superimposed. The lower right subfigure shows the ellipses obtained by other methods.N1=N2=25data points are sampled randomly from each of the iris inner and outer boundaries for the estimation.Fig. 19represents an eye image that contains the whole iris inner boundary and only a portion in the outer boundary. The advantage of the concentric ellipses fitting over the single ellipse fitting is clear in this case. The lower left plot of Fig. 19 shows the accurate fitted concentric ellipses from the proposed method. The lower right plot shows two fitted ellipses obtained separately from the method derived by Harker and OʼLeary [39]. Both methods fit the inner iris boundary very well. However, the single ellipse fitting method has difficulty for the iris outer boundary and gives wrong result, while the proposed method fits the outer ellipse quite well.Fig. 20compares concentric ellipses fitting between the proposed method (lower left) and the OʼLeary method [29] (lower right) for this particular eye image in which the edges are relatively clean as shown in the upper right plot. Both methods give comparable results in this case.Fig. 21gives the results when the data points from the iris outer boundary are a little noisier than those in Fig. 20. Comparing the fitted ellipses from the proposed method (lower left) and the OʼLeary method (lower right) shows that the common ellipse center estimate from the OʼLeary method shifts to the left and it performs a little worse than the proposed method, especially on the iris inner boundary.Fig. 22depicts the results when the outer ellipse data points are quite noisy. The fitted ellipses from the proposed method (lower left) are much better than those from the OʼLeary method (lower right). The common ellipse center estimated from the OʼLeary method is much worse than the one from the proposed method.To provide better measures of the performance comparison, Table 4shows the total-square errors between the 50 measurement points and their closest points from the fitted ellipses for Figs. 20–22. The second column is from the proposed method and the third column is from the OʼLeary method. The relative percentage reduction in the total-square errors of the proposed method relative to the OʼLeary method is shown in the fourth column. The amount of improvement increases as the extracted edge data points become noisier due to the inherent characteristics of the images. For the image in Fig. 22, a 32.79% error reduction is achieved.

@&#CONCLUSIONS@&#
