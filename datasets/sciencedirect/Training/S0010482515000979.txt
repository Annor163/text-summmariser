@&#MAIN-TITLE@&#
A new machine learning approach for predicting the response to anemia treatment in a large cohort of End Stage Renal Disease patients undergoing dialysis

@&#HIGHLIGHTS@&#
Prediction algorithm trained and tested on a large sample of real clinical data.Prediction improvement based on red blood cell dynamics and drug kinetics.There is still room for improvement of anemia management in dialysis.The model presented is suitable for the application in a daily clinical practice.

@&#KEYPHRASES@&#
Prediction,Hemoglobin,Chronic Kidney Disease,Anemia,Machine learning,

@&#ABSTRACT@&#
Chronic Kidney Disease (CKD) anemia is one of the main common comorbidities in patients undergoing End Stage Renal Disease (ESRD). Iron supplement and especially Erythropoiesis Stimulating Agents (ESA) have become the treatment of choice for that anemia. However, it is very complicated to find an adequate treatment for every patient in each particular situation since dosage guidelines are based on average behaviors, and thus, they do not take into account the particular response to those drugs by different patients, although that response may vary enormously from one patient to another and even for the same patient in different stages of the anemia. This work proposes an advance with respect to previous works that have faced this problem using different methodologies (Machine Learning (ML), among others), since the diversity of the CKD population has been explicitly taken into account in order to produce a general and reliable model for the prediction of ESA/Iron therapy response. Furthermore, the ML model makes use of both human physiology and drug pharmacology to produce a model that outperforms previous approaches, yielding Mean Absolute Errors (MAE) of the Hemoglobin (Hb) prediction around or lower than 0.6g/dl in the three countries analyzed in the study, namely, Spain, Italy and Portugal.

@&#INTRODUCTION@&#
A disorder like Chronic Kidney Disease (CKD) has global consequences for the organism, and it progressively makes a complete renal replacement therapy necessary. During End Stage Renal Disease (ESRD), dialysis partially reintegrates the blood filtration function; however, this is not sufficient to completely replace the renal endocrine role causing the development of common comorbidities, like CKD secondary anemia (CKD-anemia) [1]. Healthy kidneys secrete erythropoietin (EPO) that stimulates proliferation and differentiation of precursor cells into circulating Red Blood Cells (RBC). However, in CKD patients the capability of producing EPO becomes ineffective, leading both to a failure of the RBC production and to a contraction of the RBC lifespan [2]. The availability of exogenous Erythropoiesis Stimulating Agents (ESA) improved the treatment of CKD-anemia [3] although the clinical outcomes are still not completely successful [4] oftentimes. RBC maturation process strongly depends on iron availability, EPO concentration and EPO level fluctuations at the site of action [5,6]. Moreover, in the case of CKD, erythropoiesis is also strongly influenced by momentary or general patient conditions; specifically, inflammation and resistance to ESA treatment are two of the main determinants for drug response variability. Main difficulties in the selection of an optimal therapy dosing derive from the non-linear ESA dose/effect relationship, the high intra- and inter-individual response variability and the temporal discrepancy between the short ESA permanence in the blood (hours) and the long RBCs׳ lifespan (months) [7]. Therefore, patient status as well as ESA pharmacokinetics and pharmacodynamics are crucial factors for a correct long-term dose–response prediction that would avoid continuous raises and falls in Hemoglobin (Hb) levels.Given the complexity of the medical problem and the importance of the Hb variation prediction, the major aim of our present work has been to explore the potential of Machine Learning (ML) to derive a predictor of the response to the ESA/Iron therapy in hemodialysis patients affected by secondary anemia. To address this goal, we combined well-established ML techniques with careful feature engineering guided by the principles of actual drug kinetics, specific biological dynamics and clinical patient information. In the dialysis clinics under study, all the dialysis parameters were recorded at each session and registered in a central database together with the results of the routine laboratory analyses and the periodic control visits. This wide database offers a dynamic patient clinical picture, with updated biochemical indicators values and information on the pharmacological therapy, including the actual quantities of each medicament that patients have taken [8]. Such a large amount of clinical data is of pivotal importance to have a significant approximation to the general population; however the high complexity of this kind of data (multidimensional and non-linear) makes a correct interpretation difficult when operated only on the basis of standard statistical analyses. Conversely, ML techniques offer the advantage of inferring directly from the data the possible unknown relationships existing among the features present in a large and complex dataset thus finding an appropriate and powerful application in clinic and therapy management [9,10].This is not the first attempt of using ML to predict Hb levels or help in anemia management. Artificial Neural Networks (ANNs) have been used by several authors during the last decade to individualize ESA doses [11,12,10]; even most of the authors of this paper produced a very recent publication dealing with Hb prediction [13]. In general, those methods used current and previous Hb levels, ESA doses, and other variables that describe the patient׳s condition, in order to predict the next Hb level. The goal of those previous works was to select the optimal ESA dose in order to achieve a given Hb level; this approach is suitable only when the optimization horizon is the next time step. The same idea has been applied using other machine learning techniques, such as fuzzy logic [14,15], support vector machines [16] or Bayesian networks [17]. There have been other ML approaches focused on an efficient long-term anemia management instead of a pure prediction one-step ahead; relevant works on this topic have been developed in [14,18–20].Main concerns with previous ML implementations for Hb levels prediction in anemic patients have been the incomplete correspondence between the model and the true patient biology, the utilization of restricted study populations or the availability of a scant amount of patient data. In our case, the size and the diversity of the considered CKD population have been essential to derive a general and reliable model for the prediction of ESA/Iron therapy response. Additionally the ML application has been designed on the actual human physiology, i.e. taking into account RBC lifespan to build Hb records, and ESA pharmacology, i.e. considering not just the total quantity of administered drug but also the administration scheduling. This approach strongly enhanced the model accuracy.The rest of the paper is outlined as follows. Section 2 describes the methods used in this work; data collection and experimental setup are presented in Section 3. A description of the results is given in Section 4, followed by a discussion in Section 5. Conclusions end up the paper in Section 6.

@&#CONCLUSIONS@&#
This paper has presented a reliable ML approach to predict Hb values in patients undergoing secondary anemia to CKD. The work is the result of a long experience of the authors in this problem, with some previous works in which the produced models were not completely satisfactory.The proposed approach puts together the potential of ML models in general, and the MLP in particular, to produce accurate models given a representative data set with a better use of the available information using a priori knowledge of lifespan of RBC and the effect produced by Iron and ESAs. The result is an improved approach that outperforms the models published so far to face this problem.The successful results shown in Tables 2–6 and Figs. 1–4 and the fact that the model has been tested on a large dialysis population make the model suitable for its application as support tool in the real clinical practice. Our ongoing work deals with the implementation of the model in pilot clinics spread over different geographical areas to test the real performance on completely new patients. The goal is to check whether the model can be finally used in the short term as a decision support system to be implemented and successfully working in most of FME clinics.None declared.