@&#MAIN-TITLE@&#


@&#HIGHLIGHTS@&#
G1interpolation scheme with spatial rational PH cubics is presented.The existence of the interpolant is proven for any true spatial data configurations.Homotopy analysis and a Gram matrix approach are used.Numerical method to compute the solutions is proposed.

@&#KEYPHRASES@&#
Pythagorean-hodograph,Cubic rational curves,G,1,interpolation,Homotopy analysis,

@&#ABSTRACT@&#
In this paper theG1interpolation of two data points and two tangent directions with spatial cubic rational PH curves is considered. It is shown that interpolants exist for any true spatial data configuration. The equations that determine the interpolants are derived by combining a closed form representation of a ten parametric family of rational PH cubics given in Kozak et al. (2014), and the Gram matrix approach. The existence of a solution is proven by using a homotopy analysis, and numerical method to compute solutions is proposed. In contrast to polynomial PH cubics for which the range ofG1data admitting the existence of interpolants is limited, a switch to rationals provides an interpolation scheme with no restrictions.

@&#INTRODUCTION@&#
Pythagorean-hodograph (or shortly PH) curves form a special subclass of parametric curves. They are characterized by the property that their unit vector field of tangents is rational. Polynomial PH curves thus have a (piecewise) polynomial arc length, planar PH curves possess rational offset curves and spatial PH curves are equipped with rational orthonormal frames. This makes PH curves very useful for many practical applications in CAGD, CAD/CAM systems, CNC machining, robotics, animations, etc. Polynomial PH curves were first introduced in Farouki and Sakkalis (1990) and since then many approximation and interpolation schemes that involve these curves have been developed (see Farouki, 2008 and the references therein). On the other hand, not much work has been done on rational PH curves, since the extension from the polynomial ones is not straightforward. Planar rational PH curves were derived in Pottmann (1995a), Pottmann (1994), and independently in Fiorot and Gensane (1994). Some interpolation schemes involving these curves can be found in Pottmann (1995b).The first step to spatial rational PH curves is carried out as a short note in Pottmann (1994) based on the dual representation of rational curves. More extensive study can be found in Farouki and Šír (2011), where the construction of spatial rational PH curves is presented and illustrated from a geometric point of view. The spatial rational PH curve is determined by prescribing a rational unit vector field of binormals obtained from a rational unit field of tangents, and a rational function that prescribes the signed distance of the osculating plane from the origin. Rational unit tangents can be constructed using stereographic projection or Euler–Rodrigues frame (ERF) associated with a quaternion polynomial. In Kozak et al. (2014) it is shown, based on the dual approach and ERF, that such a construction leads in general to curves of relatively high degrees. More precisely, the connection between degrees of quaternion polynomials, dual representation and rational PH curves is revealed, and the question how to obtain low degree curves is considered in detail. Based on quadratic quaternion polynomials rational PH curves with the dual representation of degreem=3,4,5,6, having2m+4degrees of freedom are constructed. In particular, cubic rational PH curves with nonconstant denominator depending on ten free parameters are presented in a closed form. Since a family of cubic polynomial PH curves is also ten parametric, rationals do not provide additional degrees of freedom. Moreover both rational and polynomial spatial PH curves have rational canal surfaces (as an equivalent to offset curves in the planar case) and it is also true, that rational PH curves (in contrast to the polynomial ones) do not have rational arc length in general, which might be needed in some motion control applications. However, as shown in this paper, cubic rational PH curves are superior in other aspects to the polynomial ones when used forG1interpolation.TheG1interpolation of two data points and two tangent directions at these two points by spatial cubic PH curves is important for practical applications and has therefore been considered for polynomial curves in quite a few papers (e.g.Wagner and Ravani, 1997; Jüttler and Mäurer, 1999; Pelosi et al., 2005; Kwon, 2010; Jaklič et al., 2012). Since the problem is nonlinear, the analysis of the existence and the number of interpolants according to differentG1data is quite a difficult task. The conditions that provide the existence of cubic polynomial PH interpolants for many but not all possible data configurations can be found in Wagner and Ravani (1997), Jüttler and Mäurer (1999), Pelosi et al. (2005). A complete characterization of the existence conditions for all possibleG1data has later been established in Kwon (2010), and further in Jaklič et al. (2012), where nice geometrically intuitive necessary and sufficient conditions on the data have been derived.Unfortunately, the range of data configurations for whichG1cubic polynomial PH interpolants do not exist is quite large (see Fig. 1), which is a disadvantage if we want to make a scheme practically useful. In this paper we show thatG1cubic rational PH interpolants exist for all possible true spatialG1data. They are determined by nonlinear equations derived by combining a closed form curve representation given in Kozak et al. (2014), and the Gram matrix approach (used also in Jaklič et al., 2012). The existence of the solution is proven by using a homotopy analysis. It is shown that the number of rational interpolants with nonconstant denominator is always odd, and that rational interpolants are separated from the polynomial ones for all possible spatial data. But, as discussed further, if the data are planar, cubic rational PH curves provide the interpolant only in very particular setup. Numerical procedures to compute the solution are proposed too, together with some examples that confirm the theoretical results.The paper is organized as follows. In the next section the interpolation problem and the main result are presented. Section 3 recalls the quaternion approach from Kozak et al. (2014) and derives some basic properties of interpolants. In Section 4 the Gram matrix approach is presented and in Section 5 the basic PH equations are derived. Homotopy analysis is used in the next section to confirm the existence of a solution for true spatial data. Technically demanding, but tedious proofs needed in the section 6 are left to Kozak (2014). In Section 7 the algebraic approach and the planar case are briefly considered. Section 8 discusses the numerical solution of the PH equations. An algorithm is proposed in which one has to find real roots of a couple of single variable degree 6 polynomials only. Numerical examples of the last section conclude the main part of the paper.TheG1interpolation problem is as follows. Suppose that the directionsd0,d1,‖di‖=1,di∈R3,and the pointsP0,P1∈R3are prescribed. The data define a true space problem iff the vectorsd0,ΔP0:=P1−P0,d1are linearly independent. A parametric curver:[0,1]→R3interpolates the data in theG1way if(1)r′(0)=λ0d0,r(0)=P0,r(1)=P1,r′(1)=λ1d1,where the tangent lengthsλi=‖r′(i)‖,i=0,1, should be positive. The main result of the paper is the following assertion.Theorem 1Suppose that the prescribed datad0,ΔP0, andd1are not coplanar. Then there exists a regular cubic rational PH curve that solves theG1interpolation problem(1). It has no real points at infinity.Here and throughout the paper the term true space problem denotes the case when problem can't be reduced to a planar one. Similarly, true rational curve refers a rational curve that is not polynomial too.In Kozak et al. (2014) the general spatial cubic rational PH curve closed form was derived. The approach that led to it is based upon Euler–Rodrigues frame obtained from a quadratic quaternion polynomial. The closed form depends on ten free parameters: four of them come from the quadratic quaternion polynomial coefficients, three are hidden in the rotation matrixR, and the last three determine the point on the curve at a particular parameter value. Let us recall the main theorem (Kozak et al., 2014, Theorem 7) in short. Suppose that the parametersν0,ν1,ν2,ν3,ν4,νi∈R,satisfy(2)ν24≥16(ν32+ν42)>0and(3)4ν14−(ν24+8ν0ν22)ν12+ν24(ν32+ν42+ν0(ν22+4ν0))=0.This equation can be solved onν0, and we obtain(4)ν0=18(8ν12ν22−ν22±ν24−16(ν32+ν42)).Then, with(5)q(t):=16ν24(ν32+ν42)(ν22t2+2ν2ν1t+2ν12−ν0ν22)andp(t):=(p1(t),p2(t),p3(t))T, where(6)p1(t):=ν2(4ν14−(5ν24+8ν0ν22)ν12+ν24(ν0ν22+5(ν32+ν42))−4ν1ν24(ν22+2ν0)t−(8ν12ν22−4ν0ν24)t2)t,p2(t):=−4ν24(2ν2(ν1ν3+ν0ν4)+(ν22ν3+2ν1ν4)t)t,p3(t):=−4ν24(2ν2(ν1ν4−ν0ν3)+(ν22ν4−2ν1ν3)t)t,the cubic rational space PH curveris given as(7)r(t):=1q(t)Rp(t)+r(0).Here,Rdenotes a rotation matrix that depends on three free parameters. The rotation matrixRadmits several standard representations. As an example, it could be expressed as a product of rotations around the Cartesian coordinate axes depending on the Euler angles.Though the curve given by (7) is in the closed form, we have found it quite unsuitable to cope with theG1interpolation problem (1). Only interpolating one point it is straightforward since it is achieved by the curve translation. All the other equations that follow from (1) and (7) turn out highly nonlinear, and can't be significantly simplified. Even for the numerical data, finding the solution was quite a task. So we switched to the Gram matrix approach introduced in Jaklič et al. (2012), where the solution looked for should preserve particular properties of the closed form (7). This simplifies to amenable extent the approach followed in the paper. First of all, observe that the denominator q is of degree ≤2 only. This is due to a particularly chosen parameterization of the curve that maps a singular curve point to infinity. The crucial observations are given as the following lemma.Lemma 1Let r be the curve defined in(5),(6), and(7). Let(2)and(3)hold. The curve denominator q is positive onR. The hodograph norm is a rational function of degree two only,(8)‖r′(t)‖=4|ν2|(2ν12−ν0ν22)ν22t2+2ν2ν1t+ν22(ν22+3ν0)−2ν12q(t).The curve r is regular.ProofThe discriminant of q equals1024ν210(ν0ν22−ν12)(ν32+ν42)2,and it can't be nonnegative since (2) and (4) imply(9)8(ν12−ν0ν22)=ν22(ν22±ν24−16(ν32+ν42))>0.Alsoq(0)=16ν24(ν32+ν42)(2ν12−ν0ν22)>0, and the first assertion is proved. From (7) we obtainr′=1qRp′−q′q2Rp=R(1qp′−q′q2p).SinceRTR=I, we observe(r′)Tr′=1q4(q2‖p′‖2−2qq′(p′)Tp+(q′)2‖p‖2).It is straightforward to confirm that the numerator factorizes inq2‖p′‖2−2qq′(p′)Tp+(q′)2‖p‖2=q2π12,withπ1(t):=4|ν2|(2ν12−ν0ν22)(ν22t2+2ν2ν1t+ν22(ν22+3ν0)−2ν12). This confirms (8). The discriminant ofπ1equals64ν24(2ν12−ν0ν22)2(3(ν12−ν0ν22)−ν24), and note that the equation (3) could be written also in the form19(ν24+12(ν12−ν0ν22))(3(ν12−ν0ν22)−ν24)+ν289+(ν32+ν42)ν24=0.So clearly by (9) the discriminant should be negative and since1|ν2|π1(0)=ν22(ν22+3ν0)−2ν12=ν12+5ν248−3ν228ν24−16(ν32+ν42)>0,it followsπ1>0. The proof is completed.  □Let us consider now a cubic rational curverthat satisfies the interpolation conditions (1). A convenient way to constructris to use the Lagrange basis that corresponds to the datad0,ΔP0,d1,P0. The interpolating curve written in such a basis would be(10)r(t):=λ0d0ℓ0(t)+ΔP0ℓ1(t)+λ1d1ℓ2(t)+P0,where the rational basis(ℓ0(t),ℓ1(t),ℓ2(t),1)should be chosen in such a way that the interpolation conditions (1) are fulfilled. This reveals the basis functions asℓ0(t):=w0q(t)(1−t)2t,ℓ1(t):=1q(t)(2(1−t)w1+w2)t2,ℓ2(t):=w2q(t)(t−1)t2,with the common denominator q. We write it in the Bézier form(11)q(t):=w0(1−t)2+2w1t(1−t)+w2t2.The basis is homogeneous in the weightsw:=(w0,w1,w2)Tso there are only four free parameters that pin down the curver:λ0,λ1, and two of the weightswi. It is straightforward to compute the basis derivatives:(12)ℓ0′(t)=w0q(t)2(t2((t+1)w2−2(t−1)w1)+(t−1)3w0)(t−1),ℓ1′(t)=2q(t)2(w1(t−1)(2tw1−(t−2)w0)−w2(t(t+1)w1+w0))(t−1)t,ℓ2′(t)=w2q(t)2(w2t3+(w0(t−2)−2w1t)(1−t)2)t.The rationalsℓi′are clearly linearly independent. Even more could be observed.Lemma 2Suppose that the weightswisatisfyw0≠0, andw2≠0. The polynomialsq2ℓi′,i=0,1,2, have a common root only ifw12=w0w2, andw0≠w1≠w2.The first Gröbner basis polynomial ofq2ℓi′,i=1,2,3, with respect to t readsw02w22(w12−w0w2). Ifw12=w0w2, andw0≠w1, andw2≠w1, the simplified Gröbner basis gives the only common roott=w1w1−w2=w0w0−w1.If at least two of the weights are equal, no finite common root could be found.  □Let us incorporate all the unknowns in the modified basis vectorℓ:=(λ0ℓ0,ℓ1,λ1ℓ2)T=diag(λ0,1,λ1)(ℓ0,ℓ1,ℓ2)T.The hodograph of the curve can be written as(13)r′=(d0,ΔP0,d1)ℓ′,and its squared norm as(14)‖r′‖2=(r′)Tr′=(ℓ′)TGℓ′=:π2q4,where (12) implies thatπ2is a polynomial of degree ≤8. Here, G denotes the data Gram matrix,G:=(‖d0‖2d0TΔP0d0Td1ΔP0Td0‖ΔP0‖2ΔP0Td1d1Td0d1TΔP0‖d1‖2).With the notationδ0:=‖ΔP0‖,c01:=1δ0d0TΔP0,c12:=1δ0ΔP0Td1,c02:=d0Td1,the Gram matrix obtains the cosine form(15)G=(1δ0c01c02δ0c01δ02δ0c12c02δ0c121).Let us define(16)bc:=bc(c01,c12):=(1−c012)(1−c122)−(c02−c01c12)2=bc(c12,c01).The constantscijare not independent (Dattorro, 2009), and they should belong to the setP‾, the closure of the set(17)P:={(c01,c02,c12)∈R3‖cij|≤1,bc>0}.The boundary∂P:=P‾∖Pis reached if and only if the corresponding vectorsd0,ΔP0, andd1are coplanar, i.e.,bc=0. Note that the setP‾in (17) has a clear geometric meaning. Its points satisfy(c01+c12)22(1+c02)+(c01−c12)22(1−c02)≤1,ifc02∈(−1,1),orc02=±1,c01=±c12.For every fixed|c02|<1, the boundary ofPis an ellipse that reduces to a line segment at|c02|=1. The following figure (Fig. 1) demonstrates that for quite a few cosine values only the true rational solution of Theorem 1 is to be expected.A straightforward approach to equations that represent PH conditions is obvious. The polynomialπ2, introduced in (14), should satisfyπ2=π˜2for some polynomialπ˜of degree four. A simple way to achieve this is to compute five coefficients ofπ˜, expressed in the Bernstein basis, from the equationsπ2(i)(0)=(π˜2)(i)(0),i=0,1,2,π2(i)(1)=(π˜2)(i)(1),i=0,1.This determinesπ˜in a reasonably simple closed form, and the remaining part of the PH conditions is given by(18)π2(i)(0)=(π˜2)(i)(0),i=3,4,π2(i)(1)=(π˜2)(i)(1),i=2,3.Unfortunately, if expanded these four equations would require several pages of the paper, and we have found them to hard to analyze. So, additionally, we require that the interpolating curve satisfies the PH conditions in the stronger form derived in Kozak et al. (2014). By Lemma 1 the PH conditions then read(19)π2=q2π12for some polynomialπ1of degree ≤2.Remark 2For a true space problem, the data Gram matrix G defined in (15) is positive definite. Also, since the interpolation conditions (1) are to be met,λ0>0,λ1>0, andw0≠0, andw2≠0. So the polynomialπ2vanishes at somet∈Riffℓ′(t)=0. But this by Lemma 2 happens if and only if(20)discriminant(q)=4(w12−w0w2)=0,w0≠w1,w2≠w1.If the PH conditions (19) are fulfilled, we observe4(w12−w0w2)≤0. Since the basisℓis homogeneous in the weightsw, we may imposew0>0,w2>0without loosing generality or a possible solution. Alsoq≥0, and q has a double real root in a very particular case (20) only.Remark 2 justifies the introduction of new variables(21)μ0:=1δ0w0w2λ0,μ1:=1δ0w2w0λ1,ω0:=w2w0,ω1:=w1w0w2.In new variables, the curve is determined by(22)q˜(t):=1w0w2q(t)=1ω0(1−t)2+2ω1t(1−t)+ω0t2,ℓ(t)=1q˜(t)(δ0μ0(1−t)2t,(ω0−2(t−1)ω1)t2,δ0μ1(t−1)t2)T.If we rescaleπ2introduced in (14) byπ˜2:=1(δ0w0w2)2π2=1δ02q˜4(ℓ′)TGℓ′,the PH conditions inherited from (19) are given as(23)π3:=π˜2−q˜2π12≡0,π1(t)=s0(1−t)2+2s1t(1−t)+s2t2,wheresiare the free parameters to be determined. Remark 2 narrows the values of the unknowns (21) to the admissible set(24)D:={(μ0,μ1,ω0,ω1)∈R4|0<μi<∞,i=0,1,0<ω0<∞,|ω1|≤1}.From (14), (15), and (22) we observe that the changes(25)t→1−t,μ0⇄μ1,ω0→1ω0,c01⇄c12,leaveπ˜2andq˜unchanged. So it is natural to impose the PH conditions (23) by annihilating the Hermite basis coefficients ofπ3at the boundaries 0 and 1,π3(i)(0)=0,i=0,1,…,4,π3(i)(1)=0,i=0,1,2,3.Fromπ3(0)=1ω02(μ02−s02),π3(1)=ω02(μ12−s22),we selects0=μ0,s2=μ1, and the derivatives imply(26)π3′(0)=0:s1=−ω0ω1μ0−c02μ1+(ω0+2ω1)c01,(27)π3′(1)=0:s1=−ω1ω0μ1−c02μ0+(1ω0+2ω1)c12.Since both valuess1should be equal, we obtain all of the equations as(28)e:=(e1,e2,…,e6)T:=(π3′(0)−π3′(1),π3(2)(0),π3(2)(1),π3(3)(0),π3(3)(1),π3(4)(0))T=0.A straightforward evaluation gives(29)π˜2(2)(0)=4ω02(μ0(μ1(13−2ω0ω1)c02+2(ω0(ω1(ω0+2ω1)−5)−13ω1)c01)+2(μ12−2μ1(ω0+2ω1)c12+(ω0+2ω1)2)+μ02(14−2ω1ω0−ω02)),π˜2(3)(0)=24ω02(μ0(μ1(ω02+8ω1ω0−18)c02+(36ω1−ω0((ω0+4ω1)2−10))c01)+μ1(20ω1+ω0(7−4ω1(ω0+2ω1)))c12+2μ02(ω02+3ω1ω0−7)+2ω1(ω0(μ12+(ω0+2ω1)2−7)−10ω1)−5μ12−2ω02),π˜2(4)(0)=24ω02(2μ0(μ1(2ω0(ω0(ω1(ω0+2ω1)−2)−24ω1)+55)c02−2(55ω1+ω0(ω1ω03+(4ω12−1)ω02+4ω1(ω12−4)ω0−48ω12+10))c01)−4μ1(41ω1+ω0(ω1(ω0(2ω1(ω0+2ω1)−11)−36ω1)+9))c12+μ02(ω0(ω0((ω0+2ω1)2−10)−60ω1)+70)+4ω1(ω0(μ12(ω0ω1−9)+(ω0+2ω1)(ω0(ω1(ω0+2ω1)−2)−18ω1)+18)+41ω1)+41μ12+4ω02).Further, the derivatives of the polynomialπ4:=q˜2π12att=0are obtained from the following equations where the value ofs1is replaced by (26),(30)π4(2)(0)=4ω02(μ0(μ0(ω0(2ω0ω12−14ω1+ω0)+14)+μ1)+2μ0s1(4ω0ω1−7)+2s12),π4(3)(0)=24ω02(μ0(μ1(2ω0ω1−3)+μ0(ω0(21ω1+ω0((ω0−6ω1)ω1−3))−14))+s1(μ0((4ω12+2)ω02−24ω1ω0+21)+μ1)+s12(4ω0ω1−6)),π4(4)(0)=24ω02(2μ0μ1((4ω12+2)ω02−20ω1ω0+15)+μ02(ω0(60ω0ω12−20(ω02+7)ω1+ω0(ω02+30))+70)+μ12+4s1(μ1(4ω0ω1−5)+μ0(2ω0(30ω1+ω0(2(ω0−5ω1)ω1−5))−35))+4s12((4ω12+2)ω02−20ω1ω0+15)).From (29) and (30) the derivativesπ3(i)(0)=π˜2(i)(0)−π4(i)(0)that are needed in (28) are derived. Finally recall the symmetry (25). If in the expressions(−1)jπ3(j)(0),j=2,3,one renames the variablesμ0toμ1,μ1toμ0, andc01toc12,c12toc01, as well as one replacesω0by1ω0, one obtains the last needed derivativesπ3(j)(1),j=2,3.Thus we have obtained the system of six rational equations (28) for the four unknownsμ0,μ1,ω0, andω1. The polynomial form, usually preferred in numerical computations, is obtained by a diagonal multiplication(31)e˜:=diag(ω0,ω02,1,ω02,ω0,ω02)e=0.This section is devoted to the proof of Theorem 1. It is split in Lemma 3, Lemma 4, and Lemma 5. The proofs of the lemmas are quite technical and tedious. As strongly suggested, we moved them to Kozak (2014). The reader that is interested in the applications part of the paper mainly can skip them entirely. The equations (28) depend on three parameters(c01,c02,c12)∈Ponly, and so do the solutions(μ0,μ1,ω0,ω1)∈D, whereDis the admissible variable set introduced in (24).The following lemma determines the admissible solution for a particular data set.Lemma 3Suppose the cosine parameters satisfyc01=c12=0,|c02|<1. The system(28)has precisely one admissible solution, given in a closed form. With the help ofu:=u(c02):=(c02+1)(8c025−14c024−19c023+80c022−95c02+44−33(1−c02)2c02(c02(3−4(c02−5)c02)−70)+59)the solution reads(32)μ0=μ1=2(1−c02+c022)u1/3+(1+c02)2(7−10c02+4c022)+u2/33u3(1−c02),ω0=1,ω1=−1+c02μ021+μ02.Note that the particular data triple of Lemma 3, and any other one can be joined by a line segment(33)s(ζ):=(1−ζ)(0,c02,0)+ζ(c01,c02,c12),0≤ζ≤1,s⊂P,a homotopy path. The homotopy argument that counts the number of solutions is very simple: if no rational solution along s approaches∂D, the total number of rational solutions along the homotopy path s could change only by an even number. Since the number of solutions is odd at the particular data set of Lemma 3, it must be odd at the general one too. It remains now to prove that a rational solution can't near∂Dunless the data turn almost planar. Lemma 4 proves that a rational solution can't approach a particular point of the boundary∂D, i.e.,ω0=1,ω1=1, and Lemma 5 covers the rest of the boundary.Lemma 4Let(c01,c02,c12)∈Pbe any true space data triple. The corresponding polynomial and the rational solutions are separated.A true rational solution(μ0,μ1,ω0,ω1)∈Dof the system(28)may appear arbitrarily close to the boundary∂Donly if the corresponding data(c01,c02,c12)∈Pare arbitrarily close to the planar case∂P.So, the number of solutions for all the data inPstays odd. Recall Remark 2, and note that the polynomialsπ˜2andq˜inherit the properties ofπ2and q, respectively. For the true space data, Lemmas 4 and 5 rule out the solution at the boundary|ω1|=|w1|w0w2=1.Thus by Remark 2 the weights satisfyw12−w0w2<1. So the solution curves are regular and they cannot have real points at infinity for any true space data, as expected from Lemma 1. This completes the proof of Theorem 1.One is clearly tempted to study the properties of the system (28) for general cosinescijand the data point distanceδ0by the entirely algebraic approach directly. But as expected the straightforward Gröbner basis computation fails in this symbolic setup. Nevertheless, it works for the data prescribed, what gives a numerical approach as one of the computational procedures described in the next section.However, stubborn as we are, we have not given up the symbolic algebraic approach entirely, and the interplay of human and computer elimination steps that took quite a while resulted in the first Gröbner basis polynomial. Suppose that the Gröbner basis ofein (28) is computed with respect to variablesμ0,μ1,ω1, andω0in the lexicographic monomial order. Then(34)(ω02−1)q6(ω02)q8(ω02)determines the same variety as the first Gröbner basis polynomial. The polynomialsq6andq8are of degree 6 and 8 inω02respectively. Since they are too large to be included in the paper, one can find them in Kozak (2014). Note that the equations (28) determine both polynomial and true rational solutions. Let us separate both varieties. Let(35)cω:=(ω0−1ω0)2+2(1−ω1).By Lemma 4, the additional equationcω=0with the only real solutionω0=ω1=1that satisfies|ω1|≤1narrows the solution set to polynomial solutions (Jaklič et al., 2012; Kwon, 2010). The true rational solutions are this way obtained by an extended equation set(36)eE:=(e1,e2,…,e6,ω0cωu−1)T=0,u∈R,where u denotes a new variable to be determined. If we compute Gröbner basis ofeEwith respect tou,μ0,μ1,ω1, andω0, the first function simplifies from (34) to the polynomialq6only, up to a constant and the possible multiplicity. There is no need to follow all the elimination steps to verify this. The coefficients ofq6are polynomials inc01,c02, andc12, and the verification is confirmed if it holds for enough independent numerical values of the cosine parameters (Kozak, 2014). The polynomialq6implies the following observation.Lemma 6The possible candidates for theω0-part of an admissible true rational solution of(28)are determined by the set(37){x∈R+|q6(x2)=0}.The polynomialq6has an even number ≥2 positive roots.ProofRecallbcintroduced in (16) and let(38)g1:=−(c02−2c01c12+1)=−bc+(c01−c12)21−c02<0.Then(39)q6(x)=(1−c012)bc2g12+⋯+(1−c122)bc2g12x6,and(40)q6(1)=−(c01−c12)6g˜1,where(41)g˜1:=24bc+8(1−c0,23)−3(c0,22(c0,1−c1,2)2+(1−c0,22)(c0,1+c1,2)2).It is straightforward to verify(42)g˜1−24bc≥0,(c01,c02,c12)∈P‾.So if the data are not planar one yieldsq6(0)>0,q6(1)≤0,q6(∞)>0,and the set (37) gives an even number of candidates.  □In the section 6 it was shown that the number of admissible true rational solutions is odd. So at least one of the solutions of (37) has to be extraneous.The following observation covers a particular data case that will be used in the next section.Lemma 7For the true space problem, the polynomialq6vanishes atω0=1iff the cosinesc12andc01are equal.Sincebc>0, (38) and (42) showg1<0, andg˜1>0respectively. Thusq6(1)=0by (40) impliesc12=c01. But ifc12=c01thenq6simplifies to(43)q6(ω02)=(1−c012)(1−c02)2(1+c02−2c012)4(ω02−1)6=(1−c012)bc2g12(ω02−1)6,and the conclusionω0=1follows.  □Let us consider now the planar data casebc=0. This equation solved onc02yields(44)c02=c01c12∓(1−c012)(1−c122).The planar case simplifies the polynomialq6toq6(x)=−1(1−c02)(c01−c12)6q4(x)where (Kozak, 2014)q4(x)=(1−c012)2+(1−c012)((c01+c12)(c01+(2c02−1)c12)−4c02)x+(4(1−c122)c014+2c12(4c02(c122−1)+1)c013−12(8c124−20c122+c02+15)c012+c12(2(1−4c02)c122+9c02−5)c01+4c124−12(c02+15)c122+6)x2+(1−c122)((c01+c12)(c01(2c02−1)+c12)−4c02)x3+(1−c122)2x4.Let us apply (44). The algebraic cylindrical decomposition reveals thatq4has no positive root for the parameters−1≤c01,c12≤1,c01≠c12, regardless of the choice of sign in (44). This proves the following lemma.Lemma 8Suppose that the cosinesc01,c02, andc12determine planar data. Ifc12≠c01there is no admissible true rational solution of equations(28).If the cosines define planar data, i.e.,bc=0, andc12=c01, what impliesg1=0too, the polynomialq6in (43) vanishes identically, imposing no conditions onω0. So this case has to be studied separately.Theorem 2In the planar casebc=0, the equations(28)have an admissible true rational solution iff−1<c01=c12≤1. For a fixedc01, the solution is a unique circle segment, up to reparameterization.ProofThe necessary part is given as Lemma 8. Let nowc01=c12. Then(45)bc=(1+c02−2c012)(1−c02)=0.If either one of the factors in (45) vanishes, the solution of (36) can be derived in a closed form. Ifc02=2c012−1,−1<c01<1, the system (36) has four solutions, but onlyμ0=μ1=1,ω1=c01,u=1ω0cωis admissible. Since the data are planar, andδ0≠0, we may assume they are of the formP0=(000),P1=(100),d0=d1=(c011−c0120)without loosing generality. The resulting curve readsr(t)=1(1−t)2+2ω0c01(1−t)t+ω02t2(ω0(c01(1−t)+ω0t)tω01−c012(1−t)t0),and with the reparameterizationt=t(u)=uu+ω0(1−u)simplifies toω0-independent formr(t(u))=1(1−u)2+2c01(1−u)u+u2((c01(1−u)+u)u1−c012(1−u)u0),clearly a circle with the center at(12,−c0121−c012,0)T,and of the radius121−c012. Ifc01=1, the interpolating curve reduces to a line segment[0,1]. It is straightforward to verify that the choicec02=1,c01<1yields no admissible solution.  □The assertion of Theorem 2 was based on the equations derived with the help of Lemma 1. However, the numerical evidence on Fig. 2was computed for the general equations (18), without simplifications inherited from the quaternion approach. The results obtained show no difference among general and simplified version of equations. This gives a strong computational support to the following conjecture.Conjecture 1The only planar true rational cubic PH curves are rationally parameterized circles arcs.It is possible to accompanyq6with the rest of the symbolic Gröbner basis but this would make (Kozak, 2014) unbearably long, and other ways to the numerical solution have to be worked out. Note that the polynomial case is covered in Jaklič et al. (2012) completely. So we consider the true space problem, and the extended equations set (36) only. LetIdenote the ideal spanned by (36), andVbe the corresponding variety. If a polynomial equations solver is available, it is a straightforward but perhaps not most efficient to find all the solutions of the system (36). The admissible solutionsVare then selected from the whole polynomial equations solution set.As an alternative, we provide an algorithm that depends on the computation of real roots of a couple of single variable polynomials of degree ≤6 only. A numerical test carried out in Kozak (2014) suggests that near three such root-finding problems are to be expected. Quite a gain in efficiency compared with the straightforward approach. The basic idea of the procedure is to examine the idealIalong a binary tree (Fig. 3) that depends mainly on the coefficientsψ0andψ1at the variablesμ0andμ1ine1respectively,ψ0:=ω0(c02−ω0ω1),ψ1:=ω1−ω0c02,e1=ω0(ω0+2ω1)c01−(2ω0ω1+1)c12+μ0ψ0+μ1ψ1.The algorithm gathers the possible candidates forV. Any variables computed are filtered to be admissible on the spot. Finally, the quadruples(μ0,ℓ,μ1,ℓ,ω0,ℓ,ω1,ℓ)ℓ=1,2,…are inserted in the equations (36), and the actual solutions (either one or three) are selected. The precise derivation of the algorithm and its implementation are left to Kozak (2014), and a brief outline of the procedure is as follows.Case a) For the particular data casec12=c01Lemma 7 impliesω0=1, and the first equation simplifies toe1=(μ1−μ0)(ω1−c02). The cylindrical decomposition shows thatω1=c02,μ1≠μ0gives no admissible solution. Thusμ1=μ0. The Gröbner basis of the simplified idealIwith respect to the remaining unknownsω1andμ0yields the first basis polynomialψ2:=μ06(c02−1)+2μ04((1−2c02)c012+(c02−1)c02+1)+⋯+2(1−c012).The equationψ2=0gives an odd number of positive roots. The second Gröbner basis polynomial is linear inω1, and the solutionω1=μ05c01(c02−1)+μ04(c02−1)+μ03c01((2−4c02)c012+⋯+2c022−c02+1)4(c012−1)(c02−1)completes the solution quadruples ifc12=c01. This covers this case completely, and no other solutions need to be looked for.Case b) From now on we consider the casec12≠c01, so by Lemma 7 we also haveω0≠1. If bothψ0andψ1belong to the idealI, i.e.,ψ0=0andψ1=0, then it necessarily followsc02=0,ω1=0, andω0=c12/c01. Further, frome3=0we expressμ0=2(1−c01c12)/μ1too. After substitutions completed,e4=0becomes a quadratic equation for the last unknownμ1. Further analysis helps us to establish that the admissible solution exists only for the data on curve segments, implicitly described by all of the conditions0<c01<1,c012+c122<1,(c01c12−1)(c012+6c12c01+c122)+1=0.For the firstc01-segment,0<c01<(2−2)/2, we derive finally(46)μ0=4c01c12(1−c01c12)8c01c12(c01c12−1)+1+1,μ1=8c01c12(c01c12−1)+1+12c01c12.In order to obtainμ0andμ1for the values(2−2)/2<c01<1, we only have to switch the right-hand sides in (46). We have excluded the curve point(2−2)/2=c01since thenc12=c01.Case c) From this step further on we will not be able to expressω0in a closed form, depending on the cosine data only. So we compute the possible candidatesω0from the equation(47)q6=0.Let us consider the case whenψ1belongs to the idealI, soω1=ω0c02, butψ0,ψ0=ω0(c02−ω0ω1)=−ω0(ω02−1)c02≠0,does not. From the first equation we may now computeμ0,μ0=ω02(c01(2c02+1)−2c02c12)−c12ω0(ω02−1)c02,and the second, quadratic equation determines the possibleμ1values.Case d) In the last case to be examined we assumeψ1∉I. So from the equatione1=0we expressμ1(48)μ1=ω0(−μ0c02+2ω1c12−(ω0+2ω1)c01+μ0ω0ω1)+c12ω1−ω0c02,and substitute it in the equationse2,e3,…,e6. Further, we multiply them so that they regain the polynomial form, and use the same notationeifor simplicity. The equationsei,i=2,3,…,6, are quadratic inμ0on general, with leading coefficientsψ3:=(ψ3,i)i=26being polynomials inc02,ω0, andω1. If we compute the Gröbner basis ofψ3with respect toω1, the first polynomial equalsω02(ω02−1)2(c02−1)3c023,and it can vanish only ifc02=0. But then the fifth polynomial simplifies to−3ω02ω12. So at least one coefficientψ3,i,2≤i≤6, should be distinct from 0 atVsince we have excluded the possibilityc02=0,ω1=0in advance. Suppose thatψ3,i∉I. Then we can use the equationei, and we eliminate the quadraticμ0terms fromej,j=2,3,…,6,j≠i. The resulting equations, called againej, are now linear inμ0. Let us denote the coefficient vectors at powers ofμ0as followsvr,i:=(coefficient atμ0rinej)j=2j≠i6,i=2,3,…,6.So the vectorsv1,i, andv0,ishould be colinear, thus their wedge productv1,i∧v0,ishould vanish. Components of this wedge product are given as2×2minors of the matrix(v1,i,v0,i). If we compute polynomial greatest common divisor of the components ofv1,i∧v0,i, we obtain the productηi:=constiψ13(ω0cω)ψ4,whereconsti=±2±1depends on i, butψ4=ψ4(c01,c02,c12,ω0,ω1),(49)ψ4:=8ω02(c12−c01)ω16+4ω0(4c013−2c12c012+(2(c122−1)ω02−c02−3)c01+c12((−4c122+c02+3)ω02+2))ω15+…does not. It is straightforward to verify that polynomial components of the vector1ηiv1,i∧v0,ican vanish simultaneously only in the polynomial case, independently on i. Sinceψ1≠0,ω0cω≠0we finally conclude that in the case consideredω1should be a root of the degree 6 equationψ4=0. So (47) and (49) determine admissible pairs(ω0,ω1). The correspondingμ0is computed from the quadratic equation with the larges value of|ψ3,i|, and (48) completes the candidates quadruples.The setup of examples is as follows. Sinceδ0=‖ΔP0‖=0implies the planar data case, we may assumeP0=(0,0,0)T,P1=(1,0,0)T,without loosing generality. Similarly, let the directiond0lie in the x–y plane. So all additional interpolation data needed in (1) are determined by the cosinesc01,c12, andc02,d0=(c011−c0120),d1=11−c012(c121−c012c02−c01c12(1−c012)(1−c122)−(c02−c01c12)2).The first two examples demonstrate the flexibility of the rational solution compared with the polynomial ones. For each of the examples we leavec01andc12fixed, and we vary the values ofc02(Table 1).Table 1 and Fig. 4show that the first example admits two polynomial solutions for the first two data triplesc01,c12,c02, and none for the others. The unique rational solutions exist for all the data rows. Similarly, there is a single polynomial solution for the first data triple of the second example, and two for the second one. As expected, rational solutions are obtained for all the data rows (Fig. 5).The last example shows that the solution path may suffer unexpected kinks extremely close to the boundary∂P, and it shows that even the rational solution could not be unique. Suppose that the data cosine triple follows the line segment(50)c01=138055009909138240000000ζ,c02=1988919720000000,c12=138041554309138240000000ζ,fromc01=c12=0to the boundary∂P, i.e.,0≤ζ≤ζ∂P:=2073600049109363279902111610941312646984855158443≈1.00000042.Letε=2×10−7, and let us follow the solution depending on ζ in the original variablesλ0,λ1, where we normalize the weights concerned byw02+w12+w22=1. Most of the path, the solution changes are moderate, and the solution is unique (Fig. 6). Near the boundary, the solution suddenly changes, and the magnification on Fig. 7shows that at a very small interval of length<3εbecomes triple. The polynomialq6, introduced in (39) and Kozak (2014), confirms the solution behavior (Fig. 8). A closer look atq6=q6(ζ)reveals that it has a double root atζ∈{ζ_≈1−6.046ε,ζ‾≈1−1.735ε},and the solution of the interpolation problem atζ∈[ζ_,ζ‾]is triple.

@&#CONCLUSIONS@&#
