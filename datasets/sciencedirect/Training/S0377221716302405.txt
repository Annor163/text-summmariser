@&#MAIN-TITLE@&#
Admission and inventory control of a single-component make-to-order production system with replenishment setup cost and lead time

@&#HIGHLIGHTS@&#
We study admission and inventory control for a make-to-order production system.We investigate the optimal policy under non-preemptive lead time and setup cost.We introduce sub- and supermodularity and convexity with step size of order size.We develop two types of simple and implementable heuristic policies.

@&#KEYPHRASES@&#
Inventory,Admission control,Make-to-order system,Setup cost,Markov decision processes,

@&#ABSTRACT@&#
We consider the admission control and inventory management problems of a single-component make-to-order production system. Components are purchased from suppliers in batches of fixed size subject to stochastic lead times and setup costs. A control policy specifies when a batch of components is purchased, and whether the demand for each MTO production is accepted upon arrival. We formulate the problem as a Markov decision process (MDP) model, and characterize the structure of optimal admission control and inventory replenishment policies. We show that a state dependent base-stock policy is optimal for the inventory replenishment, although the MDP value function is not necessarily convex. We also show that the optimal admission control can be identified as a lattice dependent policy. A sensitivity analysis is conducted to show how the optimal policy changes as a function of the system parameters. To effectively coordinate admission and inventory control decisions, we propose simple, implementable, and yet effective heuristic policies. Our extensive numerical results suggest that the proposed heuristics can greatly help firms to effectively coordinate their admission and inventory control activities.

@&#INTRODUCTION@&#
In this paper, we study the admission control and inventory management problem of a make-to-order (MTO) facility with a common component, which is purchased from a supplier under stochastic lead time processes and setup costs. When a customer order arrives at the facility, a component is pulled from inventory, and then the end product is manufactured and delivered to the customer. Each customer order can be accepted or rejected depending on both the current status of the component inventory level and the operating characteristics (e.g., number of backlogged customer orders) of the system. For example, when the component inventory level is low and the size of backlogged customer orders is large, it is reasonable to reject incoming customer orders. An admission control will become more critical if the lead time is too long to replenish the component inventory quickly. Besides the admission control problem, the manufacturing firm has another problem of determining when to place a replenishment order. Even when the component inventory level is not low, if the size of backlogged customer orders is large and the replenishment lead time is long, the firm may need to place a replenishment order due to the risk of an excessive delay of customer order fulfillment due to stockout. Due to component replenishment and demand uncertainties, coordinating the admission control and inventory management becomes new challenging issues in a firm, which has inspired this research. The primary goal of this paper is to develop a Markov decision process model for jointly managing order admission and component inventory controls.Over the past decade, the consumer market has changed toward more customized products with specific configurations that customers want. The advance in information and manufacturing technologies has allowed firms to manufacture such products that meet customers’ requirements. In this market and production environment, it may not be appropriate to practice a make-to-stock manufacturing strategy, where products are stocked ahead of demands. Instead, it has become widely used by firms across many industries in order to initiate manufacturing of products in response to specific customer orders. Furthermore, to better protect themselves against demand variability, lower inventory cost, and reduce time-to-market, firms are increasingly using component-based manufacturing because it is capable of confining the impact of technology innovation to the component level (Xu & Li, 2007). When firms use component-based manufacturing, several issues may emerge at the operational level. If component procurement (production) lead times tend to be longer than the lead time requested by customers, components may have to be acquired in advance. Moreover, in the case in which components are acquired from suppliers, the stocking decision for component can be affected by the structure of the relationship between the manufacturer and the suppliers (Zhang, Ou, & Gilbert, 2007). Incorporating an admission control into a make-to-order system is also important due to its applicability to real problems. In many service practices, customers may be refused to enter a service facility due to its capacity restriction. In the case of a manufacturing environment, a finite buffer is a more realistic situation rather than an infinite buffer due to the limited storage buffers for semi-finished goods.There is a rich literature on joint admission and inventory/ production control for make-to-stock and assemble-to-order systems. Ha (1997a); 2000) considered a single product make-to-stock system with multiple customer classes and lost sales. Single product make-to-stock systems with backordering for two customer classes and N customer classes were studied by Ha (1997b) and de Vericourt, Karaesmen, and Dallery (2002), respectively. Carr and Duenyas (2000) considered a make-to-order/make-to-stock system that produces two classes of products, and studied the problems of joint admission control and production sequencing decision. Benjaafar and ElHafsi (2006) considered a single product assemble-to-order system with multiple customer classes and multiple components under the assumption of instantaneous assembly. ElHafsi (2009) extended the research of Benjaafar and ElHafsi (2006) to the case with a compound Poisson arrival process. Benjaafar, ElHafsi, and Tinglian (2010) considered a single product make-to-stock system with two customer classes, where customer orders can be fulfilled from existing inventory, if there is any, backordered, or rejected. Ioannidis (2011) considered a single product make-to-stock system with two customer classes, and studied production control, inventory rationing, and admission control problems. The references cited above assume that inventory of items is replenished one unit at a time and further, the production is preemptive.The inventory control for a make-to-order system is studied in Kim (2005), where inventory is replenished in batch under a non-preemptive lead time process. We extend (Kim, 2005) by considering the admission control of customer orders.Since we consider the admission and inventory control under a continuous inventory review, our model has some features similar to the classical continuous review inventory models with lost sales. The references in this area have the constraint that at most one replenishment order may be outstanding at any time. Archibald (1981) presented both optimal and approximate solution procedures for the model with a compound Poisson demand process and a fixed lead time. Buchanan and Love (1985) derived a solution procedure for the model with a Poisson demand process and an Erlang-distributed lead time. Beckmann and Srinivasan (1987) studied the model with Poisson demand and exponential lead time processes. Mohebbi and Posner (1998) analyzed the (r, Q) policies for the system with compound Poisson demand and Erlang or hyper-exponential lead time distributions. Hill and Johansen (2006) explored the behavior of optimal inventory control policies under both continuous and periodic reviews. In the classical periodic review inventory models with lost sales, some references analyzed the case with multiple outstanding orders. Morton (1971), Nahmias (1979), and Van Donselaar, de Kok, and Rutten (1996) developed myopic heuristic solution procedures under a fixed lead time which is an integral number of review periods and a negligible set-up cost. When demand is discrete, Johansen (2001) explored the optimal and near optimal base stock policies with negligible set-up costs and constant lead times.Our model contributes to the current literature in the following two essential aspects. First, we study the joint admission and inventory control for a make-to-order system with a non-preemptive lead time process and explicitly incorporate the replenishment setup cost into the model. Second, introducing submodularity and convexity with step size q, where q is an order quantity, we characterize the structure of the optimal admission and inventory control policy.The optimal policy identified in this paper has structural features similar to those studied in Nadar, Akan, and Scheller-Wolf (2014). They consider an assemble-to-order system where multiple products are produced using multiple components, and study a control policy which specifies when to produce a batch of each component type and whether or not to fulfill a demand for each product type from inventory upon arrival. By showing that the optimal cost function satisfies the submodularity, supermodularity, and convexity with respect to certain lattices of the state space, they characterize optimal inventory replenishment and allocation policies under a certain condition on component batch sizes as lattice-dependent base stock and lattice-dependent rationing policies, respectively. However, it should be noted that they assume preemption and no setup cost in the component production, whereas we assume non-preemption and setup cost in the component replenishment.The rest of the paper is organized as follows. We provide a Markov decision process model under the discounted cost criterion in the next section. Section 3 characterizes the optimal admission and inventory control. In Section 4, we implement a sensitivity analysis on the optimal policy. Section 5 extends the results to the average cost criterion. In Section 6, we develop the heuristic policies and present a numerical study. The last section states the conclusions.Customer orders arrive according to a Poisson process with rate λ and can be accepted or rejected. Whenever each customer order is rejected, a penalty cost of cRis incurred. The MTO facility produces a product for each accepted customer order using a common component. Production times for each customer order are the exponential random variables with meanμ1−1. Replenishment lead times of a common component are the exponential random variables with meanμ2−1. A backlog cost is assessed at rate c1 for each backlogged customer order, whereas a holding cost is incurred at rate c2 for each component in the inventory. At each instant a replenishment order with size q units is placed, a setup cost of cKis incurred. The replenishment process is assumed to be non-preemptive, that is, a replenishment order is never interrupted until it is completed.For tractability of the analysis, at most one outstanding replenishment order is assumed. In the inventory management literature, particularly in the literature of continuous review inventory with lost sales, it is a quite common assumption, and is often justified in practice when order cycles are usually large compared to lead times (Teunter & Haneveld, 2008). According to Tempelmeier (2006), in a typical practical case with high setup times or setup costs, the replenishment lead time is three weeks and the order cycle is about 25 weeks. Consequently the probability that several orders are outstanding simultaneously is very low.LetX(t)=(X1(t),X2(t)),where X1(t) and X2(t) denote the number of backlogged customer orders and the component inventory level at time t, respectively. Then, the state of the system at time t is described by the vector (X(t), n(t)), where n(t) represents the number of replenishment order in process at time t. The state space is denoted by Γ. The set of decision epochs in our model corresponds to the epochs of customer order arrival, MTO production completion, and replenishment order arrival. At each decision epoch, the facility determines whether or not to place a replenishment order. Furthermore, in the epochs corresponding to a customer order arrival, a decision must be made whether to accept or reject it. We denote an admission and inventory control policy by π.Since customer inter-arrival time, production time, and replenishment lead time are exponentially distributed, using the memoryless property, we can formulate the problem as a Markov decision process (MDP) model and restrict our analysis to Markovian policies. Let v denote a real-valued function defined on Γ. Define β as a continuous interest rate. For a given policy π and an initial state(X(0),n(0))=(x,n),the expected discounted cost over an infinite horizon can be written as(1)vπ(x,n)=E[∫0∞e−βt(cX(t)dt+cKdN1(t)+cRdN2(t))|(x,n)]wherecX(t)=c1X1(t)+c2X2(t)and N1(t) and N2(t) are the cumulative number of replenishment orders that have been placed and customer orders that have been rejected up to time t, respectively.The problem of interest can be formulated as a discrete-time MDP problem by using uniformization (Lippman, 1975), which makes all transition rates between states equal. This uniformized formulation has a transition rate ofγ=λ+μ1+μ2. Let τkbe the kth transition time. Then,{τk−τk−1:k∈N}is a sequence of i.i.d. exponential random variables, each with rate γ. Let ω be one of those exponential random variables. The discrete time discounted factor becomesE[e−βω]=γ/(β+γ). LetX(τk)=(X1(τk),X2(τk))be the vector which denote the number of backlogged customer orders and the component inventory level att=τk. Then, the inventory holding and backlog cost during the time interval[τk,τk+1)is given as(2)E[∫0ωcX(τk)e−βtdt]=cX(τk)β+γ.The following state transitions are considered in (X(τk), n(τk)):•A customer order arrival with probability λ/γ: If it is accepted, the size of backlogged customer orders increases by one (X1(τk+1)=X1(τk)+1).The service completion on a customer order with probability μ1/γ: The size of backlogged customer orders and the inventory level decrease by one, respectively (X1(τk+1)=X1(τk)−1,X2(τk+1)=X2(τk)−1).A replenishment order arrival with probability μ2/γ whenn(τk)=1: The inventory level increases by q (X2(τk+1)=X2(τk)+q) andn(τk+1)becomes zero.A self-loop transition with probability μ2/γ whenn(τk)=0and no replenishment order is placed (X(τk+1)=X(τk)).A replenishment order placement whenn(τk)=0:n(τk+1)becomes one.Following uniformization, (1) can be rewritten as(3)vπ(x,n)=E[∑k=0∞(γβ+γ)kcX(τk)β+γ+∑k=1∞(γβ+γ)k×{cK(N1(τk)−N1(τk−1))+cR(N2(τk)−N2(τk−1))}|(x,n)]where N1(τk) and N2(τk) are the cumulative number of replenishment orders that have been placed and customer orders that have been rejected at the time of the kth transition, respectively.The goal of this paper is to find a control policy π* that minimizes the expected discounted cost (3). Letp(x)=x−e1−e2if x1 > 0 and x2 > 0 and x otherwise, where ejis the unit vector along the jth axis. Letv(x,n)≡vπ*(x,n). Then, the optimality equation can be formulated as follows(4)v(x,n)=Tv(x,n)={min{TNv(x,n),TRv(x,n)}ifn=0TNv(x,n)ifn=1where(5)TNv(x,n)=1β+γ[cx+λmin{v(x+e1,n),v(x,n)+cR}+μ1v(p(x),n)+nμ2v(x+qe2,n−1)+(1−n)μ2v(x,n)](6)TRv(x,0)=cK+TNv(x,1).In (4), T is the value iteration operator, and TNand TRare operators corresponding to Do not replenish component and Replenish component actions, respectively. In (5), the term multiplied by λ represents the transitions and rejection cost associated by a customer order arrival, the term multiplied by μ1 represents the transition by the MTO operation, and the term multiplied by μ2 represents the transition associated with a replenishment order arrival. Note that the transitions associated with μ2 depend on n. Whenn=0,if the optimal policy is to not replenish the components, (x, 0) is transited to (x, 0) with rate μ2 because there is no replenishment order in process. Whenn=1,(x, 1) is transited to(x+qe2,0)because a replenishment order with size q arrives with rate μ2.In this section, we characterize the optimal replenishment and admission control policies. For any real valued function h on Γ, we introduce the following incremental costs:Di(x,n)=h(x+ei,n)−h(x,n),i=1,2,D11h(x,n)=h(x+e1+e2,n)−h(x,n).Operator D1(D2) is the marginal cost of holding one more backlogged customer order (unit of component in inventory). Operator D11 implies the magnitude of the cost reduction when a customer order is completed. Let H be the set of all functions defined on Γ such that if h ∈ H, then(7)D1h(x,0)≥D1h(x,1),(8)D1h(x,n)≥D1h(x+qe2,n),(9)D1h(x,n)≤D1h(x+e1+e2,n),(10)D1h(x,n)≤D1h(x+qe1,n),(11)D11h(x,0)≤D11h(x,1),(12)D11h(x,n)≤D11h(x+qe2,n),(13)D11h(x,n)≥0,(14)h(x,0)−h(x,1)≤cK,x2≥0.Eq. (8) says that the first difference along the x1 dimension is nondecreasing with an increase of q units in the component inventory. Eq. (10) states that D1 is nondecreasing with an increase of q backlogged customer orders. Whenq=1,(8) and (10) imply the standard submodularity and convexity concepts, respectively. Eqs. (8) and (10) are the special cases of Properties 1 and 2 presented by Nadar et al. (2014), which establishes convexity and submodularity with respect to certain lattices of the state space.We first show that (7)–(14) are preserved under T (Porteus, 1982). The proofs of all the subsequent results are shown in the Appendix.Lemma 1PreservationIf h ∈ H, then Th ∈ H.Denote N0 to be the set of nonnegative integers. We introduceLq(z,n)={(z+kqe2,n):k∈N0}to denote a two-dimensional lattice with initial vector (z, n) ∈ Γ. The main results of this section are summarized in the following theorem:Theorem 1There exists an optimal stationary policy that can be specified as follows.(1)The optimal replenishment policy is a base-stock policy with a state dependent critical level s(x1) such that it is optimal to order q units of component in state (x, 0) if and only if x2 ≤ s(x1). Furthermore, the optimal base stock level, s(x1), is nondecreasing in x1.The optimal admission control is managed by a lattice dependent level l(z)nwhere (l(z)n, n) ∈ Lq(z, n) such that it is optimal to accept an incoming customer order in state (x, n) ∈ Lq(z, n) if and only if x ≥ l(z)n. Furthermore, l(z)nhas the following additional properties:(a)l(z)n+qe1≤l(z+qe1)n.l(z)0 ≥ l(z)1.Part (1) of Theorem 1 states that the optimal replenishment policy is managed by a switching curve, which depends on the number of backlogged customer orders. Increase of s(x1) in x1 implies that the optimal policy balances between the number of backlogged customer orders and the component inventory level, which leads to increasing the system’s capacity utilization. Part (2) of Theorem 1 states that as the system moves to a higher component inventory level on the lattice Lq(z, n), the incentive to accept an incoming customer order increases in a nonstrict sense. Furthermore, property (a) implies that if it is optimal to accept an incoming customer order in state(x+qe1,n),it is optimal to do so in state (x, n). To see this, suppose thatl(z+qe1)n=z+qe1+k′qe2. Then, from (a),l(z)n≤z+k′qe2. Therefore, ifx+qe1≥l(z+qe1)n,x≥l(z+qe1)n−qe1=z+k′qe2≥l(z)n. Property (b) implies that it is optimal to accept an incoming customer order in state (x, 0), it is optimal to do so in state (x, 1), which indicates that the optimal policy will accept more customer orders when a replenishment order is in process than when it is not.The structure of s(x1) and l(z)0 is illustrated using the example withcK=500,cR=100,c1=2,c2=1,λ=0.6,μ1=1,μ2=0.2,β=0.0001,andq=10. s(x1) and l(z)0 of Fig. 1divide {(x, 0)} into four regions. These four regions are as follows: (I) do not place a replenishment order and accept an incoming customer order, (II) place a replenishment order and accept an incoming customer order, (III) place a replenishment order and reject an incoming customer order, and (IV) do not place a replenishment order and reject an incoming customer order. For example, consider (3,11,0). Fig. 1 shows that it is not optimal to place a replenishment order because11>s(3)=4. To identify the optimal admission control in (3,11,0), note that(3,11,0)∈Lq(3,1,0)={(3,1,0),(3,11,0),(3,21,0),…}. From Fig. 1, we see thatl(3,1)0=(3,1). Therefore, since (3, 11) > l(3, 1)0, it is optimal to accept an incoming customer order in (3,11,0). To check part (a), consider z = (0,0). Then,l(0,0)0+qe1= (0,0) + (10,0) = (10,0) < l(10, 0)0 = (10,20). Fig. 2compares the optimal admission controls l(z)0 and l(z)1. In x1 ≤ 8, l(z)0 and l(z)1 are the same, whereas in x1 ≥ 9, l(z)0 > l(z)1. For example,l(9,3)0=(9,23)>l(9,3)1=(9,13).In this section, we investigate the marginal impact of system parameters on l(z)nand s(x1). We first present a sensitivity analysis with respect to the setup cost cK.Theorem 2Monotonicity in cKIf cK increases, s(x1) decreases and l(z)nincreases.Consider two instances with different setup costs,cKA≤cKB,ceteris paribus. We use symbols A and B to differentiate these two problems. An increase in cKwill induce the optimal replenishment policy in order to make less frequent setups, that is, s(x1)A≥ s(x1)B. Because decrease in the number of replenishment setups leads to a reduced component inventory, however, the risk of paying excessive backlog costs due to stockout will become greater if lA(z)nis applied to system B. Therefore, the optimal admission control will accept less customer orders for system B than system A, that is, lA(z)n≤ lB(z)n. Fig. 3illustrates the optimal admission and inventory controls for systems A and B withcKA=250andcKB=500. In all figures presented in this section, sB(x1) and lB(z)nare derived with the example used in Section 3.A sensitivity analysis of l(z)nand s(x1) with respect to the rejection penalty cRis also established. It indicates that an increase in cRwill induce l(z)nto be lowered in order to reject less customer orders and s(x1) to be higher in order to avoid the payment of excessive backlog costs due to stockout. Because the proof of the following theorem is similar to that of Theorem 2, it is omitted.Theorem 3Monotonicity in cRIf cR increases, s(x1) increases and l(z)ndecreases.s(x1) and l(z)nare also sensitive to the mean time rate parameters even though the structure induced by the optimal policy is independent of the specific values of these parameters. Fig. 4compares the optimal admission and inventory control for systems A and B with different arrival ratesλA=0.4andλB=0.6,ceteris paribus. As expected, sB(x1) is higher than sA(x1) because system B should acquire more components in the inventory due to the increased size of backlogged customer orders, which resulted from the increased customer arrival rate. If sA(x1) is applied to system B, excessive backlog costs could be incurred due to component stockout. Not surprisingly, lB(z)0 is greater than lA(z)0 because excessively large units of backlogged customer order will be in queue if lA(z)0 is applied to system B. We also observed that when μ1 is increased, the optimal admission control tends to accommodate more customer orders, and the optimal replenishment policy tends to place orders more frequently. In addition, when μ2 is increased, the optimal admission control tends to accept more customer orders and the optimal replenishment policy tends to place orders less frequently.We define the value iteration operator G for the average cost MDP on any real valued function t on Γ as(15)Gt(x,n)={min{GNt(x,n),GRt(x,n)}ifn=0GNt(x,n)ifn=1where(16)GNt(x,n)=1γ[cx+λmin{t(x+e1,n),t(x,n)+cR}+μ1t(p(x),n)+nμ2t(x+qe2,n−1)+(1−n)μ2t(x,n)](17)GRt(x,0)=cK+GNt(x,1).Then, the optimality equation for the average cost MDP is(18)g+t(x,n)=Gt(x,n)where g is the average cost during the expected length of a state transition, 1/γ.We first show that H, defined by Eqs. (7)–(14), is closed under G. The proof of the following lemma is the same as Lemma 1, except thatβ=0.Lemma 2If t ∈ H, then Gt ∈ H.The following result guarantees that it is not optimal to accept an incoming customer order when the number of backlogged customer orders reaches a limit that is determined by a condition, which implies that the costs of backlogging x1 customer orders during 1/γ is greater than the cost of rejecting a customer order.Lemma 3Let N1 ≔ min {x1 ≥ 1: c1x1/γ > cR}. If t ∈ H satisfies,(19)D1t(x,n)>cR,x1≥N1,(20)D1t(x,n)>c1x1/γ,1≤x1<N1,(21)D1t(x,n)>c1/γ,x1=0,then so does Gt.From Eq. (19), when x1 ≥ N1,t(x+e1,n)>t(x,n)+cR,which means it is more cost-effective to reject an incoming customer order than to accept it.The following results confirm that it cannot be optimal to place a replenishment order when the component inventory reaches a limit, which is determined by a condition that the costs of holding x2 components in inventory during 1/γ is greater than the costs of setting up an inventory replenishment and holding the order quantity with q components in inventory during 1/γ.Lemma 4LetN2:=min{x2>q:c2x2/γ>cK+c2q/γ}. If t ∈ H satisfies,(22)t(x,n)−t(x+qe2,n)<cK,x2≥N2,(23)t(x,n)−t(x+qe2,n)<cK+c2(q−x2)/γ,1≤x2<N2,(24)t(x,n)−t(x+qe2,n)<cK+c2q/γ,x2=0.then so does Gt.If x2 ≥ N2, it is not optimal to place a replenishment order, regardless of x1. That is,(25)GNt(x,0)<GRt(x,0),x2≥N2.Based upon the results of Lemmas 2–5, we present the following:Theorem 4There exists an optimal average cost g that satisfies(18). In addition, the optimal inventory replenishment and admission control policies of the average cost MDP have the same structure as those of the discounted cost MDP exploited inTheorem 1.Since the optimal policy described in Section 3 is rather complex to implement in practice, we develop simpler and more implementable heuristics. We then perform a computational experiment to compare the performance of the proposed heuristics with the optimal policy via a set of test examples.The first heuristic, denoted by HR1, uses two thresholds for admission control and replenishment decision. Consider the following policy that is described by two integer parameters I1 (≥ 0) and J1 (≥ 0):•Each arriving customer order is accepted as long as x1 ≤ I1.A replenishment order with size q is placed if x2 ≤ J1.Parameters I1 and J1 denote the buffer size that the system uses in order to manage customer order and component inventory, respectively. In the inventory literature, HR1 is known as a fixed buffer policy. Appropriate values of I1 and J1 are found using a two-dimensional search. Since Lemmas 3 and 4 establish the upper bounds on x1 and x2, respectively, it is guaranteed that the search will be terminated within a finite number of steps.The second heuristic, denoted by HR2, uses two linear switching curves to determine the admission control and replenishment decision. Consider a policy that is described by three integer parameters K( ≥ 1), I2, and J2 as follows:•Each arriving customer order is accepted as long asx1≤x2/K+I2.A replenishment order with size q is placed ifx2≤x1+J2.HR2 is motivated by the results of Theorem 1. Two important observations with regard to the structure of the optimal policy are made from the figures of s(x1), l(z)0, and l(z)1. First, s(x1) of Fig. 1 exhibits the 45-degree line characteristic betweenx1=0and a certain value of x1 and becomes horizontal for large x1. In HR2, s(x1) is approximated by a line with a slope of one. Second, although the optimal admission control is characterized by the lattice dependent levels l(z)0 and l(z)1, Fig. 2 exhibits that it might be managed by the switching curves a(x2)0 and a(x2)1, as shown in Fig. 5. In fact, our numerical experiment shows that the optimal admission controls are given by the switching curves without an exception. The numerical experiment also shows that a(x2)0 and a(x2)1 have a slope close to the 45-degree line for small x2 and a steep slope beyond a certain value of x2. In HR2, they are approximated by a single line with a slope of K, where K is a positive integer. In implementing HR2, the appropriate values of K, I2, and J2 are found using a three-dimensional search.Table 1compares the performance of the optimal and the heuristic policies. The base example used in this numerical comparison has cR= 50, cK= 200, c1 = 3, c2 = 1, μ1 = 1. The size of the replenishment order is set to the economic order quantity,2cKλ/c2. The values of λ and μ2 are varied to examine the impact of these parameters on the performance of the heuristics. In this table, goptis the average profit under the optimal policy andg1H(g2H) is the average profit under HR1 (HR2).percentiHrepresents the average optimality gap which is defined as(giH−gopt)/gopt×100. The computational experiment was implemented on a laptop computer with a Pentium dual core T4300 processor. timeo, time1, and time2 are the computation times of the optimal policy and heuristic policies HR1 and HR2 measured in seconds, respectively.The test results of Table 1 suggest that HR2 performs very well and in general provides a very good approximation of the optimal policy. It is observed that the performance of HR1 is varied depending on μ2. The average performance difference between the optimal policy and HR1 and the optimal policy and HR2 is 3.8 percent and 0.7 percent, respectively. However, it should be noted that although HR2 has economical advantages overHR1, implementing HR2 is harder, as it requires optimizing an additional parameter, K. In fact, the average CPU times of HR1 and HR2 are 1.50 and 9.18 seconds, respectively. In particular, we observe that the CPU times whenμ2=0.5are significantly greater than those whenμ2=0.02. This comes because as shown in Table 1 a search for the best K whenμ2=0.5is made in a more widened range of values than whenμ2=0.02. Furthermore, in practice, HR1 may be preferable, since the component inventory and the backlogged customer order can be controlled independently.From numerical investigation, we found that as μ2/μ1 increases, s(x1), l(z)0, and l(z)1 become more impacted by the component inventory level, but less affected by the backorder position, which is somewhat an intuitive observation. This indicates that a threshold type of policy, such as HR1, will be a good approximation for the optimal policy when the lead time process is fast compared with the MTO production process. In fact, Table 1 shows that the performance difference between HR1 and HR2 is negligible when μ2 = 0.5. However, under the slow lead time process, HR2 outperforms HR1 in all instances of the example problems.The last column of Table 1 computes the average optimality gap of HR1 over HR2, percent1/percent2. Based on this, another important observation can be made. Whenμ2=0.02and 0.1, decreasing in λ1 amplifies the performance difference between HR1 and HR2. When μ2 = 0.5, however, the impact of λ1 on the performance of HR1 and HR2 is almost negligible. This result indicates that the admission control and replenishment decision will be more sensitive to both the component inventory and the backorder positions under a light traffic intensity than under a heavy one.

@&#CONCLUSIONS@&#
In this paper, we studied the optimal admission and inventory control policies in a single-component make-to-order production system, where components are purchased from suppliers in batches of fixed size subject to stochastic lead times and setup costs. We extend the existing MTO production and inventory literature by incorporating the setup cost and non-preemptive lead time process into the model. An important finding in this study is that convexity is not necessary to obtain the optimality of admission and inventory control policies.We presented that a base-stock replenishment policy with a state dependent critical level is optimal, and the optimal admission control can be identified as a lattice dependent policy. We also show that the optimal policy can be monotonically shifted in the change of the replenishment setup cost and customer order rejection penalty. Lastly, we proved the results obtained under the discounted cost criterion can be extended to the average cost criterion.We presented two types of simple and implementable heuristic policies. The first heuristic is a fixed buffer policy and the second one uses two linear switching curves for admission and inventory controls. Our numerical study indicates that the second heuristic can very effectively coordinate the admission and inventory control activities; yet, the first heuristic can be effective only when the lead time process is fast.The main limitation of our model is the assumption of a single outstanding replenishment order. It is conjectured that the structure of the optimal policy for the case with a single outstanding order could be extended to the case with multiple outstanding orders. However, it is proof is not tractable. We implemented an extensive numerical investigation for the case with multiple outstanding orders, although it is not presented in this paper. Computational results indicate that system performance can be improved by allowing multiple outstanding orders and the magnitude of cost reduction may vary depending on the problem parameters. Therefore, as a continuation of this work, it would be useful to develop effective heuristic policies that can be applicable to the cases with multiple outstanding orders. Another direction for future research is to consider a system with multiple-components make-to-order production system. Also, it would be more realistic to consider the replenishment process with variable batch sizes.Denote by a(·)(=0,1) the optimal admission control in state (·) where a(·) = 1 and a(·)= 0 represent Accept and Reject actions, respectively. Denote by p(·)(=0,1) the optimal replenishment action where p(·) = 1 and p(·) = 0 represent Order and Do not order actions, respectively. To represent the optimal controls in multiple states, we use a vector whose components are 0 or 1. For example, if it is optimal to accept an incoming order in states (x, n) and (y, n), (1,1) denotes these control actions.Eqs. (7) –(14) establish that a(·) and p(·) can be ordered under some different state vectors as follows:(P1) a(x, 0) ≤ a(x, 1);(P2)a(x,1)≤a(x+qe2,0);(P3)a(x,n)≥a(x+e1+e2,n);(P4)p(x,0)≤p(x+e1,0);(P5)p(x,0)≥p(x+e1+e2,0);(P6)p(x,0)≥p(x+e2,0).P1 comes because ifa(x,1)=0,that is,h(x+e1,1)>h(x,1)+cR,thenh(x+e1,0)>h(x,0)+cRby (7), which meansa(x,0)=0. Similarly, P2 and P3 are derived by (8) and (9), respectively. P4 comes because ifp(x+e1,0)=0,that is,TRh(x+e1,0)−TNh(x+e1,0)<0,thenTRh(x,0)−TNh(x,0)≤TRh(x+1,0)−TNh(x+1,0)<0by (7) and (8), which impliesp(x,0)=0. Similarly, P5 is obtained by (11) and (12). P6 is derived from P4 and P5.To make the analysis clear, we define the following event operators:T1h(x,n)≡min{h(x+e1,n),h(x,n)+cR};T2h(x, n) ≡ h(p(x), n);T3h(x,n)≡(1−n)h(x+qe2,n−1)+nh(x,n)forn=0,1.Then, the operator TNof Eq. (5) can be rewritten as a linear function of event operators T1, T2, and T3:TNh(x,n)=1β+γ[cx+λT1h(x,n)+μ1T2h(x,n)+μ2T3h(x,n)].Proof of Lemma 1To show that (7)–(14) are preserved under T, we need only check if each of T1, T2, and T3 preserves (7)–(14) because TD1 and TD11 propagate through linear transformations of these operators. In the presentation of the proof, the admissible combinations of replenishment actions are first considered. Given a specific replenishment control, the admission controls are then considered for the customer arrival event.(1)(Eq. (7)) LetΔ≡D1Th(x,0)−D1Th(x,1). We focus on the replenishment control in states(x+e1,0)and (x, 0),(p(x+e1,0),p(x,0)). By P4,p(x+e1,0)≥p(x,0). Then, we have three admissible cases; (0,0), (1,1), and (1,0).•(0,0): LetΔi=D1Tih(x,0)−D1Tih(x,1),i=1,2,3. To prove Δ ≥ 0, we show Δi≥ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]:1.Δ1 ≥ 0: Consider the admission controls in states(x+e1,0),(x, 0),(x+e1,1),and (x, 1),(a(x+e1,0),a(x,0),a(x+e1,1),a(x,1)). By P1, the following 9 cases are admissible:–(0, 0, ·, 0):Δ1≥D1h(x,0)−D1h(x,1)≥0by (7).(1, ·, 1, 1):Δ1≥D1h(x+e1,0)−D1h(x+e1,1)≥0by (7).(1,0,1,0):Δ1=D1D1h(x,0)−D1D1h(x,1)≥0by (7).(0, ·, ·, 1):Δ1≥h(x+e1,0)−h(x+e1,0)−(h(x+e1,1)−h(x+e1,1))=0.Δ2 ≥ 0:–x1=0,x2 > 0:Δ2=h(x−e2,0)−h(x,0)−(h(x−e2,1)−h(x,1))≥h(x+e1,0)−h(x,0)−(h(x+e1,1)−h(x,1))(by(11))≥0by (7).Otherwise: Δ2 ≥ 0 by (7).Δ3 ≥ 0:Δ3=D1h(x,0)−D1h(x+qe2,0)≥0by (10).(1, ·):Δ≥D1TRh(x,0)−D1Th(x,1)= 0 by (6).(Eq. (8)) LetΔ≡D1Th(x,1)−D1Th(x+qe2,0). Consider(p(x+e1+qe2,0),p(x+qe2,0)). By P4,p(x+e1+qe2,0)≥p(x+qe2,0). Then, three admissible cases are:•(0,0): LetΔi=D1Tih(x,1)−D1Tih(x+qe2,0),i=1,2,3. To prove Δ ≥ 0, we show Δi≥ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]:1.Δ1 ≥ 0: Consider(a(x+e1,1),a(x,1),a(x+e1+qe2,0),a(x+qe2,0)). By P2, the following 9 cases are admissible:–(0, 0, ·, 0):Δ1≥D1h(x,1)−D1h(x+qe2,0)≥0by (8).(1, ·, 1, 1):Δ1≥D1h(x+e1,1)−D1h(x+e1+qe2,0)≥0by (8).(1,0,1,0):Δ1=D1D1h(x,1)−D1D1h(x+qe2,0))≥0by (8).(0, ·, ·, 1):Δ1≥h(x+e1,1)−h(x+e1,1)−(h(x+e1+qe2,0)−h(x+e1+qe2,0))=0.Δ2 ≥ 0:–x1x2 > 0: Δ2 ≥ 0 by (8).x1 = 0, x2 > 0:Δ2=h(x−e2,1)−h(x,1)−[h(x+(q−1)e2,0)−h(x+qe2,0)]≥h(x+e1,1)−h(x,1)−[h(x+e1+qe2,0)−h(x+qe2,0)](by(12))≥0by (8).x1 > 0, x2= 0:Δ2=D1h(x,1)−D1h(x−e1+(q−1)e2,0)≥D1h(x+qe2,0)−D1h(x−e1+(q−1)e2,0)(by(8))≥0by (9).x1=x2=0:Δ2=D1h(x,1)−(h(x+(q−1)e2,0)−h(x+qe2,0))≥D1h(x,1)−(h(x+e1+qe2,0)−h(x+qe2,0))(by(13))≥0by (8).Δ3 ≥ 0:Δ3=D1h(x+qe2,0)−D1h(x+qe2,0)= 0.(1,1):Δ=D1Th(x,1)−D1TRh(x+qe2,0)=D1Th(x,1)−D1TNh(x+qe2,1)(by(6))≥D1Th(x,1)−D1TNh(x+qe2,0)(by(7))≥0by (0,0).(1,0):Δ≥D1Th(x,1)−D1TNh(x+qe2,0)≥0by case (0,0).(Eq. (9)) LetΔ≡D1Th(x,n)−D1Th(x+e1+e2,n). Suppose n= 0. We focus on(p(x+e1,0),p(x,0),p(x+2e1+e2,0),p(x+e1+e2,0)). By P4 and P5, the admissible cases are as follows:•(1,1,1,1): LetΔi=D1Tih(x,n)−D1Tih(x+e1+e2,n),i=1,2,3. To prove Δ ≤ 0, we show Δi≤ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]:1.Δ1 ≤ 0: Consider(a(x+e1,0),a(x,0),a(x+2e1+e2,0),a(x+e1+e2,0)). By P3, the following 9 cases follow:–(·, 0, 0, 0):Δ1≤D1h(x,1)−D1h(x+e1+e2,1)≤0by (9).(1, 1, 1, ·):Δ1≤D1h(x+e1,1)−D1h(x+2e1+e2,1)≤0by (9).(·, 1,0, · ):D1≤h(x+e1,1)−h(x+e1,1)−[h(x+2e1+e2,1)−h(x+2e1+e2,1)]=0.(1,0,1,0):Δ1=D1D1h(x,1)−D1D1h(x+e1+e2,1)≤0by recursively applying (9).Δ2 ≤ 0:–x1x2 > 0: Δ2 ≤ 0 by (9).x1 ≥ 0, x2 = 0:D1h(x,1)−D1h(x,1)= 0.x1 = 0, x2 > 0:h(x−e2,1)−h(x,1)−D1h(x,1)=−D11h(x−e2,1)≤0by (13).Δ3 ≤ 0:Δ3=D1h(x+qe2,0)−D1h(x+e1+(q+1)e2,0)≤0by (9).(0,0,0,0): The proof is similar to that of (1,1,1,1) and is omitted here.(1,1,0,0): SinceD1TRh(x,0)=D1TNh(x,1)≤D1TNh(x,0)(by (7)),Δ≤D1TNh(x,0)−D1TNh(x+e1+e2,0)≤0by (0,0,0,0).(1,0,1,0): SinceD11TRh(x+e1,0)=D11TNh(x+e1,1)≥D11TNh(x+e1,0)by (11),Δ≤D11TNh(x,0)−D11TNh(x+e1,0)=D1TNh(x,0)−D1TNh(x+e1+e2,0)≤0by (9).(1,0,0,0):Δ≤D1TNh(x,0)−D1TNh(x+e1+e2,0)≤0by (0,0,0,0).(1,1,1,0):Δ≤D1TRh(x,0)−D1TRh(x+e1+e2,0)≤0by (1,1,1,1).Supposen=1. The proof is the same as case (1,1,1,1).(Eq. (10)) From the result of (2),TD1h(x+qe1+qe2,n)≤TD1h(x+qe1,n). From the result of (3) and its recursive application,TD1h(x,n)≤TD1h(x+e1+e2,n)≤⋯≤TD1h(x+qe1+qe2,n). Hence, we haveTD1h(x,n)≤TD1h(x+qe1,n).(Eq. (11)) LetΔ≡D11Th(x,0)−D11Th(x,1). Consider(p(x+e1+e2,0),p(x,0)). By P5,p(x+e1+e2,0)≤p(x,0).•(1,1):Δ=D11Th(x,1)−D11Th(x,1)= 0.(0,0): LetΔi=D11Tih(x,0)−D11Tih(x,1),i=1,2,3. To prove Δ ≤ 0, we show Δi≤ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]:1.Δ1 ≤ 0: Consider(a(x+e1+e2,0),a(x,0),a(x+e1+e2,1),a(x,1)). By P1 and P3, the following 6 cases follow:–(0, 0, 0, ·):Δ1≤D11h(x,0)−D11h(x,1)≤0by (11).(·, 1, 1, 1):Δ1≤D11h(x+e1,0)−D11h(x+e1,1)≤0by (11).(0,1,0,1):Δ1=h(x+e1+e2,0)−h(x+e1,0)−(h(x+e1+e2,1)−h(x+e1,1))≤h(x,0)−h(x+e1,0)−(h(x,1)−h(x+e1,1))(by(11))≤0by (7).(0,0,1,1):Δ1=D11h(x,0)−D11h(x+e1,1)≤D11h(x,0)−D11h(x+e1,0)(by(11))=D1h(x,0)−D1h(x+e1+e2,0)≤0by (9).Δ2 ≤ 0: When x1x2 > 0, Δ2 ≤ 0 by (11). Otherwise, Δ2 = 0.Δ3 ≤ 0:Δ3=D11h(x,0)−D11h(x+qe2,0)≤0by (11).(0,1):Δ≤D11Th(x,0)−D11TNh(x,1)≤0by case (0,0).(Eq. (12))Δ≡D11Th(x,1)−D11Th(x+qe2,0). Consider(p(x+e1+(q+1)e2,0),p(x+qe2,0)). By P5,p(x+e1+(q+1)e2,0)≤p(x+qe2,0).•(0,0): letΔi=D11Tih(x,1)−D11Tih(x+qe2,0),i=1,2,3. To prove Δ ≤ 0, we show Δi≤ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]:1.Δ1 ≤ 0: Consider(a(x+e1+e2,1),a(x,1),a(x+e1+(q+1)e2,0),a(x+qe2,0)). By P2 and P3, the following 6 cases follow:–(0, 0, 0, ·):Δ1≤D11h(x,1)−D11h(x+qe2,0)≤0by (12).(·, 1, 1, 1):Δ1≤D11h(x+e1,1)−D11h(x+e1+qe2,0)≤0by (12).(0,1,0,1):Δ1=h(x+e1+e2,1)−h(x+e1,1)−(h(x+e1+(q+1)e2,0)−h(x+e1+qe2,0))≤h(x+e1+e2,1)−h(x+e1,1)−(h(x+e1+(q+1)e2,0)−h(x+e1+qe2,0))(by(12))≤0by (8).(0,0,1,1):Δ1=D11h(x,1)−D11h(x+e1+qe2,0)≤D11h(x+qe2,0)−D11h(x+e1+qe2,0)(by(11))=D1h(x+qe2,0)−D1h(x+e1+(q+1)e2)≤0by (9).Δ2 ≤ 0:–x1x2 > 0:Δ2 ≤ 0 (by (12)).x1 > 0 andx2=0:Δ2=−D11h(x−e1+(q−1)e2,0)≤0by (13).x1 = 0 and x2 ≥ 0: Δ2 = 0.Δ3 ≤ 0:Δ3=D11h(x+qe2,0)−D11h(x+qe2,0)= 0.(1,1): sinceD11TRh(x+qe2,0)=D11TNh(x+qe2,1)≥D11TNh(x+qe2,0)(by (11)),Δ≤D11Th(x,1)−D11TNh(x+qe2,0)≤0(by(0,0)).(0,1):Δ≤D1Th(x,1)−D1TNh(x+qe2,0)≤0by (0,0).(Eq. (13)) LetΔi≡TiD11h(x,n),i=1,2,3. By P3,Δ1=D11h(x+e1,n)or ≥ D11h(x, n). When x1x2 > 0, Δ2 ≥ 0 by (13), otherwise, Δ2 = 0. When n= 1,Δ3=D11h(x+qe2,0). When n= 0, by P5Δ3=D11h(x+qe2,0)or ≥ D11h(x, 0). For all cases, Δi≥ 0 by (13). Therefore,D11Th(x,n)=1/(β+γ)[c1+c2+λΔ1+μ1Δ2+μ2Δ3]≥0.(Eq. (14)) Ifp(x,0)=1,Th(x,0)−Th(x,1)=cK+Th(x,1)−Th(x,1)=cK. Ifp(x,0)=0,Th(x,0)−Th(x,1)≤=Th(x,0)−Th(x,1)=cK.□To prove Theorem 1, we need to show v ∈ H. This follows from the fact thatv=limn→∞T(n)h,h ∈ H where T(n) refers to n compositions of operator T and T(n)h ∈ H (see ElHafsi, 2009).(1)Lets(x1)=max{x2:p(x1,x2)=1}. Supposep(x1,x2′)=0forx2′<s(x1). Then, this is a contradiction by P6. Hence, the result follows.Part (a) comes from Eq. (10), convexity with step size q of h, which impliesa(x,n)≥a(x+qe1,n). Part (b) comes from P1.□We follow the framework of Carr and Duenyas (2000). Consider two instances with different setup costs,cKA≤cKB,ceteris paribus. We use symbols A and B to differentiate these two problems. Consider the following functional properties established by vAand vB:(26)cKA+vA(x,1)−vA(x,0)≤cKB+vB(x,1)−vB(x,0),(27)vA(x+qe2,0)−vA(x,1)≤vB(x+qe2,0)−vB(x,1),(28)D11vA(x,n)≥D11vB(x,n),n=0,1,(29)D1vA(x,n)≤D1vB(x,n),n=0,1.Let denote the optimal admission (replenishment) control in state (·)A/Bbya(·)A/B(p(·)A/B). Then, we have(P6)a(x,n)A≥a(x,n)B;(P7)p(x,0)A≥p(x,0)B.P6 comes from (29). To see this, suppose thata(x,n)A=0,that is,vA(x+e1,n)>vA(x,n)+cR. ThenvB(x+e1,n)−(vB(x,n)+cR)≥vA(x+e1,n)−(vA(x,n)+cR)>0by (29), which meansa(x,n)B=0. P7 comes from (26). To see this, suppose thatp(x,0)A=0,that is,TRvA(x,0)−TNvA(x,0)=cKA+vA(x,1)−vA(x,0)>0. Then,TRvB(x,0)−TNvB(x,0)=cKB+vB(x,1)−vB(x,0)≥cKA+vA(x,1)−vA(x,0)>0by (26), which impliesp(x,0)B=0.To prove Theorem 2, it suffices to show that (26)–(29) are preserved under T.(1)(Eq. (26)) LetΔ≡TvA(x,1)−TvA(x,0)−(TvB(x,1)−TvB(x,0)). Consider(p(x,0)A,p(x,0)B). By P7,p(x,0)A≥p(x,0)B.•(0,0): LetΔi=TivA(x,1)−TivA(x,0)−(TivB(x,1)−TivB(x,0)),i=1,2,3.1.Δ1≤−cKA+cKB: Consider(a(x,1)A,a(x,0)A,a(x,1)B,a(x,0)B). By P1 and P6, the following 6 cases follows:–(·, 0, 0, 0):Δ1≤vA(x,1)−vA(x,0)−(vB(x,1)−vB(x,0))≤−cKA+cKBby (26).(1, 1, 1, ·):Δ1≤vA(x+e1,1)−vA(x+e1,0)−(vB(x+e1,1)−vB(x+e1,0))≤−cKA+cKBby (26).(1,0,1,0):Δ1=vA(x+e1,1)−vA(x,0)−(vB(x+e1,1)−vB(x,0))≤vA(x,1)−vA(x,0)−(vB(x,1)−vB(x,0))(by(29))≤−cKA+cKBby (26).(1,1,0,0):Δ1=vA(x+e1,1)−vA(x+e1,0)−(vB(x,1)−vB(x,0))≤vA(x,1)−vA(x,0)−(vB(x,1)−vB(x,0))(by(7))≤−cKA+cKBby (26).Δ1≤−cKA+cKB:Δ2=vA(p(x),1)−vA(p(x),0)−(vB(p(x),1)−vB(p(x),0))≤−cKA+cKBby (26).Δ1≤−cKA+cKB:Δ3=vA(x+qe2,0)−vA(x,0)−(vB(x+qe2,0)−vB(x,0))≤vA(x,1)−vA(x,0)−(vB(x,1)−vB(x,0))(by(27))≤−cKA+cKBby (26).(1,1):Δ=−cKA+cKBfrom (6).(1,0):Δ≤TvA(x,1)−TRvA(x,0)−(TvB(x,1)−TRvB(x,0))=−cKA+cKB.Hence,Δ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3]≤γ/(β+γ)[−cKA+cKB]≤−cKA+cKB.(Eq. (27)) LetΔ≡TvA(x+qe2,0)−TvA(x,1)−(TvB(x+qe2,0)−TvB(x,1)). Consider(p(x+qe2,0)A,p(x+qe2,0)B). By P7,p(x+qe2,0)A≥p(x+qe2,0)B.•(0,0): LetΔi≡TivA(x+qe2,0)−TivA(x,1)−(TivB(x+qe2,0)−TivB(x,1)),i=1,2,3. To prove Δ ≤ 0, we showΔi≤0,i=1,2,3,sinceΔ1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3].1.Δ1 ≤ 0: Consider(a(x+qe2,0)A,a(x,1)A,a(x+qe2,0)B,a(x,1)B). By P2 and P6, the following 6 cases follows:–( ·, 0, 0, 0):Δ1≤vA(x+qe2,0)−vA(x,1)−(vB(x+qe2,0)−vB(x,1))≤0by (27).(1, 1, 1, ·):Δ1≤vA(x+e1+qe2,0)−vA(x+e1,1)−(vB(x+e1+qe2,0)−vB(x+e1,1))≤0by (27).(1,0,1,0):Δ1=vA(x+e1+qe2,0)−vA(x,1)−(vB(x+e1+qe2,0)−vB(x,1))≤vA(x+qe2,0)−vA(x,1)−(vB(x+qe2,0)−vB(x,1))(by(29))≤0by (27).(1,1,0,0):Δ1=vA(x+e1+qe2,0)−vA(x+e1,1)−(vB(x+qe2,0)−vB(x,1))≤vA(x+qe2,0)−vA(x,1)−(vB(x+qe2,0)−vB(x,1))(by(7))≤0by (27).Δ2 ≤ 0: Δ2 ≤ 0 by (27) when x1x2 > 0 or when x1 = 0 and x2 ≥ 0. When x1 > 0 andx2=0,Δ2=vA(x−e1+(q−1)e2,0)−vA(x,1)−(vB(x−e1+(q−1)e2,0)−vB(x,1))≤vA(x+qe2,0))−vA(x,1)−(vB(x+qe2,0)−vB(x,1))(by(28))≤0by (27).Δ3 ≤ 0:Δ3=vA(x+qe2,0)−vA(x+qe2,0)−(vB(x+qe2,0)−vB(x+qe2,0))=0.(1,1),Δ=cKA+TNvA(x+qe2,1)−TvA(x,1)−(cKB+TNvB(x+qe2,1)−TvB(x,1))(by(6))≤TNvA(x+qe2,0)−TvA(x,1)−(TNvB(x+qe2,0)−TvB(x,1))(by(26))≤0by (0,0).(1,0),Δ≤TNvA(x+qe2,0)−TvA(x,1)−(TNvB(x+qe2,0)−TvB(x,1))≤0by (0,0).(Eq. (28)) LetΔ≡D11TvA(x,n)−D11TvB(x,n). Suppose n = 0. Consider(p(x+e1+e2,0)A,p(x,0)A,p(x+e1+e2,0)B,p(x,0)B). By P5 and P7, the following cases are admissible:•(1,1,1,1): LetΔi≡D11TivA(x,0)−D11TivB(x,0). To prove Δ ≥ 0, we showΔi≥0,i=1,2,3,sinceΔ1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3].1.Δ1 ≥ 0: Consider(a(x+e1+e2,0)A,a(x,0)A,a(x+e1+e2,0)B,a(x,0)B). By P3 and P6, the following 6 cases follow:–(0, ·, 0, 0):Δ1≥D11vA(x,1)−D11vB(x,1)≥0by (28).(1, 1, ·, 1):Δ1≥D11vA(x+e1,1)−D11vB(x+e1,1)≥0by (28).(0,1,0,1):Δ1=vA(x+e1+e2,1)−vA(x+e1,1)−(vB(x+e1+e2,1)−vB(x+e1,1))≥vA(x+e1+e2,1)−vA(x,1)−(vB(x+e1+e2,1)−vB(x,1))(by(29))≥0by (28).(1,1,0,0):Δ1=D11vA(x+e1,1)−D11vB(x,1)≥D11vA(x,1)−D11vB(x,1)(by(9))≥0by (28).Δ2 ≥ 0: When x1x2 > 0, Δ2 ≥ 0 by (28), otherwise, Δ2 = 0.Δ3 ≥ 0:Δ3=D11vA(x+qe2,0)−D11vB(x+qe2,0)≥0by (28).(0,0,0,0): We apply the same argument as case (1,1,1,1).(1,1,0,0): SinceD11TRvA(x,0)=D11TNvA(x,1)≥D11TNvA(x,0)(by (11)),Δ≥D11TNvA(x,0)−D11TNvB(x,0))≥0by (28).(0,1,0,1):Δ=TNvA(x+e1+e2,0)−(cKA+TNvA(x,1))−(TNvB(x+e1+e2,0)−(cKB+TNvB(x,1)))≥TNvA(x+e1+e2,0)−TNvA(x,0)−(TNvB(x+e1+e2,0)−TNvB(x,0))(by(26))≥0by (0,0,0,0).(0,1,0,0):Δ≥D11TNvA(x,0)−D11TNvB(x,0)≥0by (0,0,0,0).(1,1,0,1):Δ≥D11TRvA(x,0)−D11TRvB(x,0)≥0by (1,1,1,1).When n= 1, the proof is the same as case (1,1,1,1).(Eq. (29)) LetΔ=D1TvA(x,n)−D1TvB(x,n). Suppose n= 0. Consider(p(x+e1,0)A,p(x,0)A,p(x+e1,0)B,p(x,0)B). By P4 and P7, the following cases are admissible:•(1,1,1,1): LetΔi=D1TivA(x,0)−D1TivB(x,0),i=1,2,3. To prove Δ ≤ 0, we show Δi≤ 0, sinceΔ=1/(β+γ)[λΔ1+μ1Δ2+μ2Δ3].1.Δ1 ≤ 0: Consider(a(x+e1,0)A,a(x,0)A,a(x+e1,0)B,a(x,0)B). By P6, the following 9 cases follow:–(·, 0, 0, 0):Δ1≤D1vA(x,1)−D1vB(x,1)≤0by (29).(1, 1, 1, ·):Δ1≤D1vA(x+e1,1)−D1vB(x+e1,1)≤0by (29).( ·, 1,0, · ):Δ1≤vA(x+e1,1)−vA(x+e1,1)−(vA(x+e1,1)−vA(x+e1,1))= 0.(1,0,1,0):Δ1=D1D1vA(x,1)−D1D1vB(x,1))≤0by (29).Δ2 ≤ 0: When x1= 0 and x2 > 0,Δ2=vA(x−e2,1)−vA(x,1)−(vB(x−e2,1)−vB(x,1))≤D11vB(x−e2,1)−D11vA(x−e2,1)(by(29))≤0by (28). Otherwise, Δ2 ≤ 0 by (29).Δ3 ≤ 0:Δ3=D1vA(x+qe2,0)−D1vB(x+qe2,0)≤0by (29).(0,0,0,0): We apply the same argument as case (1,1,1,1).(1,1,0,0): SinceD1TRvA(x,0)=D1TNvA(x,1)≤D1TNvA(x,0)(by(7),Δ≤D1TNvA(x,0)−D1TNvB(x,0))≤0by (0,0,0,0).(1,0,1,0):Δ=cKA+TNvA(x+e1,1)−TNvA(x,0)−(cKB+TNvB(x+e1,1)−TNvB(x,0))≤TNvA(x+e1,0)−TNvA(x,0)−(TNvB(x+e1,0)−TNvB(x,0))(by(26))≤0by (0,0,0,0).(1,0,0,0):Δ≤D1TNvA(x,0)−D1TNvB(x,0)≤0by (0,0,0,0).(1,1,1,0):Δ≤D1TRvA(x,0)−D1TRvB(x,0)≤0by (1,1,1,1).When n= 1, the proof is the same as case (1,1,1,1).□LetΔl≡D1Glt(x,n),l=1,2,3,and Δ ≡ D1Gt(x, n). Then,Δ=1γ[c1+λΔ1+μ1Δ2+μ2Δ3].(1)(Eq. (19)) Suppose n = 0. Consider(p(x+e1,0),p(x,0)). By P4,p(x+e1,0)≥p(x,0). The following three cases are admissible:•(0,0):1.Δ1: Consider(a(x+e1,0),a(x,0)). From (19),a(x+e1,n)=a(x,n)= 0 and thus Δ1 > cR.Δ2: Whenx1=N1and x2 > 0,Δ2=D1(N1−1,x2−1,n)>c1(N1−1)/γby (20), otherwise, Δ2 > cRby (19).Δ3: Since the state transition corresponding to μ2 does not change x1, Δ3 > cR.Therefore, whenx1=N1and x2 > 0,Δ>1γ[c1+μ1(N1−1)c1/γ+(λ+μ2)cR]>1γ[μ1N1c1/γ+(λ+μ2)cR]>1γ[μ1cR+(λ+μ2)cR](bythedefinitionofN1)=cR.Otherwise,Δ>1γ[c1+γcR]>cR.(1,1): This case can be shown using a similar argument above.(1,0):Δ≥GRt(x+e1,n)−GRt(x,n)>cRfrom case (1,1).The proof of case with n= 1 is the same as that of case (1,1).(Eq. (20)) Suppose n = 0. Consider(p(x+e1,0),p(x,0)). By P4,p(x+e1,0)≥p(x,0). The following three cases are admissible:•(0,0):1.Δ1: Consider(a(x+e1,0),a(x,0)).–(0,0):Δ1=D1t(x,n)>c1x1/γfrom (20).(1,1): Whenx1<N1−1,Δ1=D1t(x+e1,n)>c1(x1+1)/γ>c1x1/γ. Whenx1=N1−1,Δ1=D1t(N1,x2,n)>cR(by(19))>c1(N1−1)/γ(bythedefinitionofN1).(0,1):Δ1>t(x+e1,n)−t(x,n)>c1x1/γfrom (20).(1,0):Δ1>t(x+2e1,n)−t(x+e1,n)>c1x1/γfrom case (1,1).Δ2:–x1=1and x2 > 0:Δ2=D1(0,x2−1,n)>c1/γby (21).x2=0: Δ2 > c1x1/γ by (20).x1 > 1 and x2 > 0:Δ2=D1t(x−e1,e2,n)>c1(x1−1)/γby (20).Δ3: The state transition corresponding to μ2 does not change x1 and thus Δ3 > c1x1/γ by (20).Therefore, when x1 > 1 and x2 > 0,Δ>1γ[c1+μ1c1(x1−1)/γ+(λ+μ2)c1x1/γ]=1γ[c1−μ1/γc1+γ(c1x1/γ)]>c1x1/γ.Otherwise,Δ>1γ[c1+γ(c1x1/γ)]>c1x1/γ.(1,1): This case can be shown using a similar argument above.(1,0):Δ≥GRt(x+e1,n)−GRt(x,n)>c1x1/γfrom case (1,1).The proof of case with n= 1 is the same as that of case (1,1).(Eq. (21)) Suppose n= 0. Consider(p(x+e1,0),p(x,0)). By P4,p(x+e1,0)≥p(x,0). The following three cases are admissible:•(0,0):1.Δ1: Consider(a(x+e1,n),a(x,n)).–(0,0):Δ1=D1t(0,x2,n)>c1/γfrom (21).(1,1):Δ1=D1t(1,x2,n)>c1/γfrom (20).(0,1):Δ1>t(1,x2,n)−t(0,x2,n)>c1/γfrom (21).(1,0):Δ1>t(2,x2,n)−t(1,x2,n)>c1/γfrom (20).Δ2:–x2 > 0: From (8),Δ2=D1T2t(0,x2,n)≥D1T2t(0,x2+q,n)≥⋯≥D1T2t(0,∞,n)=t(0,∞−1,n)−t(0,∞,n)=t(0,∞,n)−t(0,∞,n)=0.x2=0:Δ2=D1t(0,0)>c1/γby (21).Δ3: The state transition corresponding to μ2 does not change x1 and thus Δ3 > c1x1/γ by (20).Therefore, when x2 > 0,Δ>1γ[c1+(λ+μ2)c1/γ]>1γ[μ1/γc1+(λ+μ2)c1/γ]=c1/γ.Otherwise,Δ>1γ[c1+γ(c1/γ)]>c1/γ.(1,1): This case can be shown using a similar argument above.(1,0):Δ≥GRt(x+e1,n)−GRt(x,n)>c1/γfrom case (1,1).The proof of case with n = 1 is the same as that of case (1,1).□LetΔl≡Glt(x,n)−Glt(x+qe2,n),l=1,2,3,andΔ≡Gt(x,n)−Gt(x+qe2,n). Then,Δ=1γ[−c2q+λΔ1+μ1Δ2+μ2Δ3].(1)(Eq. (22)) Suppose n= 0. By (22),p(x,0)=p(x+qe2,0)=0.1.Δ1: The state transition corresponding to λ does not change x2 and thus Δ1 < cK.Δ2: When x1 > 0 andx2=N2,Δ2=t(x1−1,N2−1,n)−t(x1−1,N2−1+q,n)<cK+c2(q−(N2−1))/γby (23). Otherwise, Δ2 < cKby (22).Δ3:Δ3=t(x,n)−(x+qe2,n)<cK.Therefore, when x1 > 0 andx2=N2,Δ<1γ[−c2q+μ1(cK+c2(q−(N2−1))/γ)+(λ+μ2)cK]=1γ[−c2q+c2μ1/γ+μ1(cK+c2(q−N2)/γ)+(λ+μ2)cK]≤1γ[−c2q+c2μ1/γ+μ1(cK−cK)+(λ+μ2)cK](bythedefinitionofN2)<cK.Otherwise,Δ<1γ[−c2q+γcK]<cK.Case with n = 1 can be shown using a similar argument above.(Eq. (23)) Suppose n = 0. Consider(p(x,0),p(x+qe2,0)). By P6,p(x,0)≥p(x+qe2,0). The following three cases are admissible:•(0,0):1.Δ1: The state transition corresponding to λ does not change x2 and thusΔ1<cK+c2(q−x2)/γ.Δ2:–x1 > 0 andx2=1:Δ2=t(x1−1,0,n)−t(x1−1,q,n)<cK+c2q/γby (24).x1=0:Δ2<cK+c2(q−x2)/γby (23).x1 > 0 and x2 > 1:Δ2=t(x1−1,x2−1,n)−t(x1−1,x2+q−1,n)≤t(x1,x2−1,n)−t(x1,x2+q−1,n)(by(8))<cK+c2(q−(x2−1))/γby (23).Δ3:Δ3=t(x,n)−(x+qe2,n)<cK+c2(q−x2)/γby (23).Therefore, when x1 > 0 and x2 > 1,Δ<1γ[−c2q+μ1(cK+c2(q−(x2−1))/γ)+(λ+μ2)(cK+c2(q−x2)/γ)]=1γ[−c2q+c2μ1/γ+γ(cK+c2(q−x2)/γ)]<cK+c2(q−x2)/γ.Otherwise:Δ<1γ[−c2q+γ(cK+c2(q−x2)/γ)]<cK+c2(q−x2)/γ.(1,1): This case can be shown using a similar argument above.(1,0):GRt(x,n)−GNt(x+qe2,n)≤GNt(x,n)−GNt(x+qe2,n)<cK+c2(q−x2)/γfrom case (0,0).The proof of case with n= 1 is the same as that of case (1,1).(Eq. (24)) Suppose n= 0. Consider(p(x,0),p(x+qe2,0)). By P4,p(x,0)≥p(x+qe2,0). The following three cases are admissible:•(0,0):1.Δ1: The state transition corresponding to λ does not change x2 and thusΔ1<cK+c2q/γ.Δ2:–x1 > 0:Δ2=G2t(x1,0,n)−G2t(x1,q,n). From (8),G2t(x1,0,n)−G2t(x1,q,n)≤G2t(x1+1,0,n)−G2t(x1+1,q,n)≤⋯≤G2t(∞,0,n)−G2t(∞,q,n)=t(∞,0,n)−t(∞−1,q−1,n)≤t(∞,0,n)−t(∞−2,q−2,n)(by(13))≤⋯≤t(∞,0,n)−t(∞−q,0,n)=t(∞,0,n)−t(∞,0,n)=0.x1=0:Δ2=t(0,0,n)−(0,q,n)<cK+c2q/γby (24).Δ3:Δ3=t(x1,0,n)−(x1,q,n)<cK+c2q/γby (24).Therefore, when x1 > 0,Δ<1γ[−c2q+(λ+μ2)(cK+c2q/γ)]<cK+c2q/γ. Otherwise,Δ<1γ[−c2q+γ(cK+c2q/γ)]<cK+c2q/γ.(1,1): This case can be shown using a similar argument above.(1,0):GRt(x1,0,n)−GNt(x1,q,n)≤GNt(x1,0,n)−GNt(x1,q,n)<cK+c2q/γfrom case (0,0).The proof of case with n=1 is the same as that of case (1,1).□GNt(x,0)−GRt(x,0)=−cK+GNt(x,0)−GNt(x,1)=−cK+1γ[λ(min{t(x+e1,0),t(x,0)+cR}−min{t(x+e1,1),t(x,1)+cR})+μ1(t(p(x),0)−t(p(x),1))+μ2(t(x,0)−t(x+qe2,0))].Consider a(x, 0) and a(x, 1). By P4, a(x, 0) ≤ a(x, 1). Therefore,min{t(x+e1,0),t(x,0)+cR}−min{t(x+e1,1),t(x,1)+cR}=t(x,0)−t(x,1)or≤t(x+e1,0)−t(x+e1,1). By applying (14) to λ and μ1 terms and (22) to μ2 term,GNt(x,0)−GRt(x,0)<−cK+1γ[(λ+μ1+μ2)cK]=0.□Consider the value iteration algorithm,tk+1(x,n)=Gtk(x,n),where t0(x, n) = 0 for every (x, n). Here, tk(x, n) is the optimal value function when the algorithm is terminated after k transitions. From Lemmas 3 and 5, without loss of optimality, we can convert the original average cost MDP with infinite state space into the new one with finite state space,{0,…,N1}×{0,…,N2}. Furthermore, the model has a finite action space and is unichain and aperiodic. From Theorem 8.5.4 of Puterman (2005), there exist an optimal average cost duringγ−1,g, and an optimal value function,t=limk→∞tk,that satisfyg+t(x,n)=Gt(x,n). Since t ∈ H from Lemma 2, the results of Theorem 1 apply to the optimal control policy for the average cost MDP as well.□