@&#MAIN-TITLE@&#
Toward improved simulation of river operations through integration with a hydrologic model

@&#HIGHLIGHTS@&#
The river/reservoir operations model MODSIM is coupled to MODFLOW.Models simulate physics based hydrology and priority/rule based water allocation.Coupling uses a Picard iteration and an implicit, mass conservative solution.Model simulates conjunctive use of surface water and groundwater.Helps evaluate groundwater sustainability resulting from alternative management.

@&#KEYPHRASES@&#
Conjunctive use,Groundwater–surface water interaction,MODFLOW,MODSIM,River-operations modeling,Integrated environmental modeling (IEM),

@&#ABSTRACT@&#
Graphical abstractMODSIM-MODFLOWMODSIM-MODFLOW is the integration of two widely used and freely-available codes used within the field of water-resource planning and management. The nature of the coupling in MODSIM-MODFLOW sets it apart from other river-operations/hydrologic-model couplings in that the codes iterate at the time-step level and share information via computer memory. Users are required to construct working MODSIM and MODFLOW models prior to using the integrated code and must adhere to each code's input-file formatting requirements. Using the custom-code interface available with MODSIM, the models are integrated by mapping surface-water features represented in both models to one another.Eric Morway (emorway@usgs.gov), with MODFLOW contributions from Rich Niswonger (rniswon@usgs.gov) and MODSIM contributions from Enrique Triana (Enrique.Triana@mwhglobal.com)Research supported by grant (1360506/1360507) from the Water Sustainability & Climate Program jointly funded by the National Science Foundation and U.S. Department of Agriculture/National Institute of Food & Agriculture and by the U.S. Geological Survey's Groundwater Resources Program.C#, C++, FortranWindows with.NET Framework 3.5 installedDownload MODSIM from http://modsim.engr.colostate.edu/. A version of MODFLOW compiled as dynamic-link library and required by the integrated code is available upon request from the corresponding author. Finally, users will need to download and install the C++ redistributable package for Microsoft Visual Studio 2012 available from Microsoft.“Inevitably, as each generation must learn, the land and the waters will instruct us in the ways of community.”Justice Gregory J. Hobbs, Jr.

@&#INTRODUCTION@&#
Efforts to address the growing divide between water supply and water demands are complicated by uncertain supplies resulting from climate variability, growing demands, shifting societal values, over-allocation of water resources, trans-boundary compacts, institutionalized inefficiencies, and complex legal entanglements rooted in conjunctive use, among others. The predictive capabilities of simulation models may be the only viable means by which to forecast the potential impacts of alternative management decisions (Singh, 2010). Thus, models are frequently relied upon for identifying potential trade-offs among alternative management strategies. Yet the potential complications resulting from an alternative management strategy can scarcely be appraised with a suitable level of accuracy if the hydrologic consequences caused by those decisions are over-simplified. An important example is the application of operations models that do not properly represent finite groundwater supplies and temporally varying groundwater and surface-water (GW-SW) exchanges. Due to the time delays of groundwater responses to surface-water and groundwater management actions, the effects of a new management decision may range from days to decades as it propagates through the connected river-aquifer system. Oversimplified assessment of the impacts of water-use decisions can interfere with meaningful reform of current water-use practices.Two pertinent examples of the importance of groundwater return flow in the execution of river operations are found in Colorado, though many other examples are available (e.g., Pulido-Velázquez et al., 2006; Rassam, 2011; Rassam et al., 2013; Shannon et al., 2000; Valerio et al., 2010). In Kansas v. Colorado11Kansas v. Colorado 514 U.S. 675, 131 L.Ed.2d 759, 115 S.Ct. 1733 (1995).(Abrams, 2004), the simplifying assumptions regarding GW-SW interaction were at the focal point of deliberations. The U.S. Supreme Court ruled that irrigation wells installed in Colorado (CO), located upstream of Kansas (KS), after the execution of the CO-KS interstate compact in the late 1940s did in fact “materially deplete” Arkansas River flows in direct violation of the governing compact (Colorado Revised Statutes, 1949), thereby injuring Kansas surface-water users (Hobbs, 2009; Willis et al., 2008). The Special Master's22The Special Master appointed by the U.S. Supreme Court was Arthur Littleworth, a Senior Partner at Best, Best & Krieger. The case lasted from 1990 until 2003, and his Fourth Report was argued before the U.S. Supreme Court.findings, informed by the Hydrologic-Institutional (“H-I”) model simulations, were affirmed by the U.S. Supreme Court (Luecke, 2010) and scores of irrigators had their pumping curtailed (Littleworth, 2003, pgs. 8–9).The second example is from the Platte River basin, which is the next major river basin to the north. A ‘substitute water supply plan’ (SWSP) approved by the Colorado State Legislature and implemented by the Colorado State Engineer's Office allowed junior-righted irrigation wells to operate provided they augment surface-water flows in sufficient amount to prevent injury to senior surface-water right holders, a calculation that acknowledges the influence of GW-SW connections and thereby requires a detailed hydrologic model (Howe, 2008). The SWSP had been operating successfully for nearly 30 years before the Colorado Supreme Court ordered the curtailment of pumping in nearly 400 irrigation wells starting in 2006, a move that recognized the impact irrigation wells were having on the already low surface-water flows, and, by extension, on the senior surface-water right holders (Ross, 2014). However, after the court order, water tables rebounded more than expected, negatively impacting home-owners by flooding basements and raising questions regarding curtailment of pumping in the irrigation wells (Waskom, 2014). In these and other examples, the influence of GW-SW exchange on in-stream flows, and therefore on the effective execution of river operations, cannot be overstated.Rassam (2011) points out that failure to account for GW-SW interaction during periods of low flow limits the forecasting ability of an operations model. Heavy overdraft of the aquifer during average to dry conditions not only impacts GW-SW interaction in the near term, but may sap river water for years, especially during extended droughts. In most hydrogeologic systems, pumping will intercept regional groundwater flow that historically returned to the river, thereby resulting in reduced base flow and consequently reduced river flows that can persist for decades after pumping has ceased (Barlow and Leake, 2012). Conversely, conjunctive use of groundwater and surface-water resources during average to wet years may reduce senior surface-water users' reliance on surface water. As patterns in surface-water usage emerge in this context, the onset of dry conditions may give rise to conflict under the “use it, or lose it” principal that accompanies the prior appropriation doctrine (Wilds, 2010). Finally, though not the focus of this paper, a significant consideration for future integrated hydrologic and operations-modeling studies is the role GW-SW interaction plays on water quality (Sophocleous, 2002; Winter et al., 1998), a facet of river-operations modeling that will likely receive increased scrutiny in the future. Thus, accounting for the impact of pumping on river flows is critically important for river-operations modeling in the 21st century (Brooks et al., 2012; Simonovic, 2000).In addition to the benefits that hydrologic models provide to operations models, operations models can greatly benefit common applications of hydrologic models, such as for water availability studies (Gleick, 1987). For example, where measurements of historical reservoir releases and river diversions are limited, operations models can be used to estimate anthropogenic components of water distribution. The ability to simulate river operations within basin-scale hydrologic models provides an accurate portrayal of the state of the basin in simulations of future conditions. That is, an integrated operations-hydrologic model requires no a priori specification of actual diversion amounts; the operational framework adhered to by the operation-side of the integrated code will dynamically allocate the yet unknown resource at model runtime, subject to all of the priorities and constraints specified by the user. Operations models provide a method to simulate the demand for water in conjunction with the hydrologic model that limits the availability of water supply within the hydrologic environment. If water users have supplemental groundwater rights, reasonable estimates of pumping can be calculated as the difference between the estimated water demand provided by the operations model and the surface-water shortfall provided by the hydrologic model (Schmid and Hanson, 2009). Historical conjunctive use of surface water and groundwater is typically unknown for many basins, and, as a result, simulation can improve the understanding of historical and projected supply versus demand within these systems.A review of the literature indicates a lack of truly integrated operations-hydrologic codes. Currently, many simplifications are used within river operations models to approximate the underlying groundwater resource. Approaches for representing groundwater in operations models include response coefficients calculated using a calibrated groundwater model (Fredericks et al., 1998) or by simplified one-dimensional equations such as the Glover solution (Glover, 1977); a single feed-forward iteration with output calculated by a distributed-parameter model such as MODFLOW (Valerio et al., 2010), PARFLOW (Condon and Maxwell, 2013), or WEAP21 (Sieber and Purkey, 2007; Yates et al., 2005); analytical solutions that assume linearity to approximate the cumulative effect of individual stresses (Rassam, 2011; Welsh et al., 2013); and the use of surrogate models such as artificial neural networks (ANNs) trained by models such as MODFLOW for emulating GW-SW interactions under variable management (Triana, 2008). In the present work, we analyze the importance of integrating operations and hydrologic models, such that the models iterate multiple times within a time step to determine a balanced solution between the available water supply simulated by the hydrologic model and the subsequent distribution of that supply among the demands specified within the operations model. We demonstrate that without convergence between the operations and hydrologic models, erroneous diversion amounts are simulated and significant mass-balance errors are accumulated owing to inaccurate representation of GW-SW interaction.An integrated operations-hydrologic model that iterates between the respective codes within each time step until specified convergences are attained provides a modeling platform that more accurately accounts for nonlinear feedbacks between water operations and water supply. Because groundwater is an integral component of most alluvial aquifer systems, it will strongly influence the predicted response to potential alternative management scenarios in many river systems, including operational changes (e.g., land fallowing), demand management (e.g., crop type), infrastructure changes (e.g., converting flood to sprinkler irrigation), and conjunctive-use strategies. Due to the profound impact that water operations have on water use and distribution, and, likewise, the impact that water supply has on water operations, integration of these aspects of water resources clearly points toward integrations of software that achieve these capabilities. Thus, an integrated approach to river operations and hydrologic modeling is provided here for exploring sustainable management of groundwater and surface-water supplies.A ‘what-if’ scenario in the context of water-resources simulation is an approach that tries to evaluate both obvious and unforeseeable outcomes associated with changes in water use or water supply. The value of ‘what-if’ scenarios common to most river operations and planning simulations is diminished when these simulations do not represent the finite storage of aquifers, head dependent GW-SW exchanges, and capture of natural groundwater discharge, as these processes control flow in rivers (Winter et al., 1998). Although it is well recognized that groundwater plays a profound role on surface-water supplies, representation of groundwater in operations models has failed to keep up with technology developed in the GW-SW literature (Fairbanks et al., 2001; LaBolle et al., 2003; Markstrom et al., 2008; Panday and Huyakorn, 2004). Recent drought in the western US has exposed the limitations of water supplies, especially with regard to groundwater supplies (Castle et al., 2014). As drought continues to apply stress on finite groundwater supplies, it is clear that realistic representation of groundwater resources is necessary for managing water resources in the 21st century.Therefore, the primary objective of this paper is to present a new approach wherein an operations/planning model is integrated with a hydrologic model capable of simulating GW-SW exchange at the time-step iteration level. An important distinction between the loosely-coupled (sometimes referred to as “sequentially-coupled”) models already available (Rassam, 2011; Sieber and Purkey, 2007; Valerio et al., 2010; Welsh et al., 2013) and the iteratively coupled models described here, is that in the iteratively coupled approach, neither model advances in time until differences in simulated values over an iteration fall below convergence criteria specified for each model individually and for quantities common to both models simultaneously. Using a hypothetical river basin modeled after a real river basin characteristic of semi-arid conditions in the western United States, scenarios are presented that highlight the value of integrating a river-planning/operations model (hereafter referred to as an operations model) with a GW-SW model as a tool for water-resources management. The integrated MODSIM-MODFLOW model is presented as an advancement over previously available codes because of its ability to simulate a much wider class of water-resources problems. We highlight the importance of iterative coupling over sequential coupling to achieve an accurate and mass-conservative solution that is robust over a wide range of management, climatic, and hydrologic conditions.In this work, the Newton formulation (MODFLOW-NWT; Niswonger et al., 2011) of the groundwater-flow model MODFLOW (Harbaugh, 2005) is coupled to the operations/planning model MODSIM (Labadie, 2010a). Although there are a wide-array of hydrologic and river-operations models available in the literature, MODFLOW and MODSIM were chosen for the work presented herein because they are popular and freely available, are numerically efficient and stable, and have a software architecture that promotes enhancement, such as coupling to the watershed runoff model PRMS (GSFLOW; Markstrom et al., 2008). Other hydrologic models that might have been used include MODHMS (Panday and Huyakorn, 2004) and HydroGeoSphere (Therrien et al., 2006), whereas WaterWare (Jamieson and Fedra, 1996), RiverWare (Zagona et al., 1998) (reference), WEAP (Yates et al., 2005), or WRAP (Wurbs, 2013), might have been used to represent water-resource operations. MODSIM customization capabilities allow the user to write code that is compiled with the MODSIM solver, making possible low-level integration with other models. Moreover, widely-varying hydrogeologic settings coupled with disparate sets of legal doctrines necessitate the use of generalized tools that are both customizable and defensible. As to the former, both MODFLOW and MODSIM are offered as generalized software that can be customized to specific river systems. Because of this, both have found widespread acceptance and application to many of the world's most important river basins.Management capabilities currently exist in MODFLOW; two examples are MODFLOW-GWM (Ahlfeld et al., 2005) and MODFLOW-FMP (Schmid and Hanson, 2009), with other versions of MODFLOW, such as MODFLOW-CDSS (Banta, 2011), compiled for use by river-operations models like StateMod (Alvarado and Bennett, 2005; Bennett, 2012). However, there are important distinctions between the MODSIM-MODFLOW model developed herein and these other MODFLOW based management codes. MODFLOW-GWM is a management tool that optimizes water use to achieve balances between meeting water demands and satisfying constraints related to water supply and other environmental factors. It is important to note that GWM does not include capabilities to represent rule and priority based water-allocation systems or reservoir operations. Conversely, MODSIM-MODFLOW is focused on representing laws that govern water use, which is distinct from the simulation-optimization capabilities of MODFLOW-GWM. This distinction also applies to the difference between MODSIM-MODFLOW and MODFLOW-FMP, which was recently re-released with added functionality as MODFLOW-OWHM (Hanson et al., 2014; Schmid et al., 2014). MODFLOW-FMP does not provide capabilities for representing rule and priority-based water allocation. Rather, water allocation is demand based. It should be noted that MODFLOW-GWM and MODFLOW-FMP offer capabilities that are not available in MODSIM-MODFLOW, and, as such, may be the most appropriate code for a particular water-management problem. MODSIM-MODFLOW is intended as a simulation tool for analyzing water-resources problems in basins that are governed by rule and priority controls on water allocation, as well as reservoir operations.

@&#CONCLUSIONS@&#
While this analysis emerges from a hypothetical test model, it demonstrates the impact that physically-based distributed-parameter modeling has on river-operations modeling, and vice versa. The spatio-temporal representation of GW-SW exchanges as simulated by a hydrologic model, in this case MODFLOW, has a clear impact on simulated river operations. Previously, less accurate approximations of GW-SW exchanges, including loosely-coupled models (e.g., “feed-forward” approaches), analytical solutions with their various assumptions, complete omission of groundwater, or simply lumping GW-SW exchanges in with all other unmeasured gains and losses and assuming the same GW-SW exchanges for different management conditions, were commonly applied. However, through simulation of GW-SW interaction with a physically-based distributed-parameter hydrologic model, a river-operations model is equipped to more accurately account for finite water resources, and in particular, finite groundwater resources in conjunctive-use systems. Other approaches, such as those named above, are in many situations unsuitable for examining water resources in water-scarce, over-appropriated, conjunctive-use basins that water-resource engineers must now manage.A distinct advantage of the MODSIM-MODFLOW integration, beyond the fact that it takes advantage of two long established models within their respective genres, is that the movement of information between the codes is via computer memory in compiled codes and can occur several times within each simulated time step, making the tool presented computationally efficient. Thus, simulated operational decisions are based on surface flows that are synchronized with GW-SW interactions resulting from the current, as well as all previous, management (i.e., diversions and releases) decisions. Through the synchronized solutions, ‘what-if’ scenarios and/or future forecasts run with an integrated operations-hydrologic model like MODSIM-MODFLOW more accurately account for the non-linear feedbacks and the cumulative effects of those feedbacks on yet unrealized operational decisions. Measured or inferred aquifer property heterogeneities, spatially and temporally variable stresses such as pumping, and, finally, their collective impact on river operations are vetted without relying on analytical approximations or loosely-coupled (i.e., out-of-synchronization) approaches.In addition, the particular code pairing adopted herein provides the MODFLOW community with access to new and novel functionality, allowing existing MODFLOW applications to be readily expanded to include the prior-appropriation framework (or a similar rule-based system). Conversely, MODSIM users can readily expand applications with the world's most widely used groundwater-modeling software for more accurate representation of GW-SW exchange based on simulated conjunctive use practices.While this integration effectively integrates hydrologic and operational considerations with detailed accounting of GW-SW interactions by the operations model, this effort does not address integration with economic, social, ecological, or other dimension of water-resource planning and management. However, given the integrated approach described herein, it is possible that one of the aforementioned modeling platforms (e.g., economic, ecological, etc.) could be integrated with MODSIM-MODFLOW such that the within time-step iteration includes a third type of model (e.g., an economic or ecologic model).