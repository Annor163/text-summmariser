@&#MAIN-TITLE@&#
Artificial neural networks (Fuzzy ARTMAP) analysis of the data obtained with an electronic tongue applied to a ham-curing process with different salt formulations

@&#HIGHLIGHTS@&#
Determination of values of parameters of an ANN to be included in a microcontroller.Monitoring the cure process of ham with potentiometric electronic tongue system.Hams salted with different salt formulations to obtain products with low sodium.

@&#KEYPHRASES@&#
Fuzzy ARTMAP artificial neural network,Electronic tongue,Ham curing process,Microcontroller device,

@&#ABSTRACT@&#
This paper describes the determination of optimum values of the parameters of a Simplified Fuzzy ARTMAP neural network for monitoring dry-cured ham processing with different salt formulations to be implemented in a microcontroller device. The employed network must be set to the limited microcontroller memory but, at the same time, should achieve optimal performance to classify the samples obtained from this application.Hams salted with different salt formulations (100% NaCl; 50% NaCl+50% KCl and 55% NaCl+25% KCl+15% CaCl2+5% MgCl2) were checked at four processing times, from post-salting to the end of their processing (2, 4, 8 and 12 months).Measurements were taken with a potentiometric electronic tongue system formed by metal electrodes of different materials that worked as nonspecific sensors. This study aimed to discriminate ham samples according to two parameters: processing time and salt formulation.The results were analyzed with an artificial neural network of the Simplified Fuzzy ARTMAP (SFAM) type. During the training and validation process of the neural network, optimum values of the control parameters of the neural network were determined for easy implementation in a microcontroller, and to simultaneously achieve maximum sample discrimination. The test process was run in a PIC18F450 microcontroller, where the SFAM algorithm was implemented with the optimal parameters. A data analysis with the optimized neural network was achieved, and samples were perfectly discriminated according to processing time (100%). It is more difficult to discriminate all samples according to salt formulation type, but it is easy to achieve salt type discrimination within each processing block time. Thus, we conclude that the processing time effect dominates salt formulation effects.

@&#INTRODUCTION@&#
One priority of the food industry and food safety controllers is the development of fast, cheap measuring devices to be applied to analyze and control food products and processes. In fact, the ideal situation would consist in measuring the properties of interest of all products at any point of the food process. It is, therefore, appropriate to apply quick and easy measurement techniques that provide qualitative results from the sample. For this purpose, electronic tongue systems have been developed to achieve these objectives, which are being gradually implemented into the food field [1]. The applications started with liquid samples [2], followed by some works done on solid samples with a high water content; e.g., fresh meat [3] and fish freshness [4]. In these cases, it is necessary to use electrodes for solid samples that can be easily inserted into samples and make good physical contact. Thus, a set of different metal electrodes that generate a spontaneous voltage and a reference electrode were used because metal electrodes are more easily and reliably inserted into samples. Electronic tongues use nonspecific sensors, which, in our case, were metal electrodes. Nevertheless, they are able to respond in some way differentially to a group of related chemical species, whose global response can sometimes be related with certain parameters or characteristics of the analyzed samples. To achieve this discrimination with no specific electrodes, it is often necessary to use different types of electrodes that may display a distinct behavior to either analyzed parameters or the presence of certain chemical species. Sample discrimination is usually performed by multivariate analysis techniques.Among the various electrochemical techniques available, we chose a potentiometric technique because it is easier and faster to perform, and measuring equipment is simpler than other techniques such as voltammetry and impedance spectroscopy. Measuring equipment for qualitative sample analyses is developed from these approaches, which is useful for in situ measurements.This work stemmed from an interest in developing low-sodium cured products. Cutting the amount of sodium chloride added to dry-cured hams has been proposed to reduce dietary sodium intake in Mediterranean countries. The effect of substituting sodium chloride with potassium chloride, calcium chloride and magnesium chloride on some dry-cured ham physicochemical characteristics throughout the dry-cured ham process has been previously evaluated [5–7].One of the main goals of electronic tongue systems is to obtain portable measurement equipment that can measure and analyze the results in situ. An electronic tongue system was applied herein to monitor the salting and curing of dry-cured hams to obtain equipment that automatically classifies various sample types quickly and easily.One of the most widely used methods for sample classification in electronic tongues systems are artificial neural networks (ANN), formed by algorithms inspired in biological neural systems. In an initial training stage, these networks fix coefficients that relate the input data to different output categories. The process is completed with the subsequent verification and test stages so that classification is determined as being correct or incorrect by other measures that did not participate in training.The neural network training and validation phases are usually carried out in the laboratory after collecting enough data and using software that is normally run on PCs. The test phase can also be run on a PC, or transferred to microprogrammable systems to facilitate the use of portable systems; that is, to obtain classification results quickly and efficiently, a neural network should be implemented into the same measuring equipment. Then the classification of measures can be made in situ which, in our case, was in ham-processing plants. For this reason, it is necessary to have electronic systems that can host the algorithms that constitute them.An effective and simple way to implement an algorithms ANN test in a portable measuring system is to use microcontroller devices, which are programmable digital electronic systems whose memory stores the program being run. The program must have a control system to read input data and to activate the corresponding outputs of each network category. The microcontroller memory does not usually have memory the power and capacity of management informatics systems, like PCs. So a network that is not complex and does not require a large memory must be selected for implementing algorithms into a microcontroller.Among the different artificial neural network types, the best known is probably the Multi-Layer Perceptron (MLP), which offers good performance for classifying data into categories, but the algorithm can be complex with a high computational cost. A good alternative to such neural networks is Fuzzy ARTMAP-type networks [8]. They are based on the Adaptive Resonance Theory [9] and their main characteristics are relative simplicity, good performance with limited data and low computational cost. These neural networks were used initially in electronic nose systems [10] and their use has extended with electronic systems tongues [11]. With electronic tongue systems, we have conducted several works to compare the results of the MLP and Fuzzy ARTMAP types, and have verified that the results obtained with such neural networks are generally better. This comparison has been applied mainly to food quality control [12–14].A Fuzzy ARTMAP neural network by means of an algorithm that can operate in a PC type computer is described. However, it can also be included in a microcontroller to take field measurements, in which case it is convenient to use a simplified version of the original algorithm, called Simplified Fuzzy ARTMAP (SFAM) [15]. However, the algorithm obtained when training an SFAM network does not require the optimal architecture to be implemented into a microcontroller. This type of test algorithm of the neural network must be limited to minimize the problems that are incorporated into the microcontroller memory.This simplified algorithm has been used in various application fields, such as explosives detection [16] and environmental applications [17]. One problem with this neural network is that its performance depends partly on the order of entry of training patterns, which suggests improvements based on genetic algorithms [18,19]. In recent years, we have used Simplified Fuzzy ARTMAP (SFAM) networks to compare results with other classification methods, namely partial least square analyses [20], and MLP networks and linear discriminatory analyses [21]. In the present study, we also conducted a comparative study of the memory used by a specific MCU (PIC18F4550) according to SFAM network size.To determine the parameters required to program the SFAM network test algorithm in the microcontroller, a graphical user interface (GUI) was developed employing MATLAB [22]. With this GUI program, the minimum neural network memory (mapfield) to size to optimize the microcontroller memory was obtained. Specifically, this interface was used to calculate the optimal values of the parameters that determine neural network algorithm performance, and to also achieve the most successful sample classification with a minimum memory size.This work aimed to develop an artificial neural network (Simplified Fuzzy ARTMAP) with optimal parameters for it to be embedded in a microcontroller to monitor the processing of hams salted with different salt formulations by means of a potentiometric electronic tongue.Thirty-nine hind limbs (hams) from white pigs fattened in confinement and fed with a commercial diet were selected from the same batch in a local slaughterhouse. pH was controlled within the 5.5–6.0 range, with an average weight of 10.6±0.8kg. Three of the hams were used as a control of raw material. The remaining 36 hams were randomly divided into three batches: salted using 100% NaCl salt (batch I); salted with a mixture of NaCl and KCl at 50% (batch II); salted with a mixture of 55% NaCl, 25% KCl, 15% CaCl2 and 5% MgCl2 (batch III). Salt formulations were chosen according to the results obtained in previous works into low-sodium dry-cured loin [23]. The salting stage was carried out at 3±1°C and 90% air relative humidity for 10 days, and all the hams were weighed daily. Hams were salted by rubbing and kneading with the three salt combinations. The amount of salt mixture added was 3% of the initial ham weight, and 200ppm of KNO3 and 100ppm of NaNO2 were added as curing agents to each ham mixture.After salting, hams were post-salted at 4.5°C and at 75–85% relative humidity. At the end of the post-salting stage, hams underwent the last processing stage (dry-ripening), where the temperature progressively increased from 6°C to 20°C, and relative humidity lowered from 80% to 65%. The process ended when total weight loss reached 34% of the initial weight, which fell within the typical industrial values range [24].Four sampling times were set during dry-cured ham processing. Sampling time 1 was set after 60 processing days (2 months) when the post-salting stage ended. Sampling times 2 and 3 were respectively set in the drying-ripening stages at 115 days (4 months) and 230 days (8 months). Sampling 4 time was set at the end of the process when total weight loss reached 34% of the initial weight (approximately 365 days of processing, 12 months).The potentiometric electronic tongue consisted of a set of electrodes made of silver, copper and gold, 0.8mm in diameter and 4cm long. To choose the materials that were to form the electrode set, the following metals were considered: metallic electrodes of zero order, e.g., gold and silver, that are sensitive to the redox potential [25]; other metal compounds, e.g., metal/metal oxide electrodes, that are used to determine pH in aqueous solutions [26]; other electrodes of metal/metal insoluble salt that have been used to determine anions [27]. In a pure form, these metals have already been used in previous experiments and their sensitivity to changes in the characteristics of the sample to be tested have been proven [28]. However, evidence for some instability of the obtained signal appeared for the silver and copper electrodes. In order to reduce this, the electrodes surface underwent an oxidative process by heat oxidation, which respectively generated a layer of silver oxide and copper oxide on their surface. The remaining three electrodes were obtained by electrolysis processes. After running several tests with the electrodes, we chose silver (Ag), gold (Au), copper (Cu), silver chloride (AgCl), copper sulfide (Cu2S) and silver bromide (AgBr). These salts were selected for their greater adherence to metal and longer duration. A reference electrode of Ag/AgCl (provided by Crison, model 5240) was used. They were all attached to connectors in order to carry the signal generated by the potentiometric measurement system (Fig. 1).The potentiometric electronic tongue was connected to self-built electronic equipment that suited the requirements of the multi-channel potentiometric measurements. The equipment was composed basically of two stages. First a conditioning circuit for the electrical signal generated by the electrodes. It consisted mainly of a very high input impedance electrometric amplifier LMC6001 (www.national.com) and an active filter to eliminate the signals from the electrical network. The second stage was a data acquisition system for further analysis, which comprised analog-digital converters. The data acquisition system also displayed information in real time. An Adlink PCI-9112 card (www.nudaq.com) and the VEE-Pro software (Agilent Technologies, Santa Clara, CA, USA, www.home.agilent.com) were used in the computer to view data on the computer screen and to store data for subsequent processing. Details of the entire measurement system can be found in previous works [29].At each sampling time, nine potentiometric measures were taken arbitrarily on the widest transverse section of the ham, thus 108 measures were taken: 4 sampling times×3 salting batches×3 hams×3 measures. No order, which depended on the salting batches, was established for measuring. After each measurement however, electrodes were cleaned with distilled water, rubbed with a brush and dried with paper to remove all traces of previous samples that could interfere with the next measurements.To calibrate the measurement system, a dissolution was prepared consisting in HEPES buffer solution, pH 7.5, 10% dissolved in distilled water (90%) and 0.5g of KCl was added per 100cl of dissolution. Several tests were run with this solution at the beginning of each measurement day and the results were used as a reference. Finally, the reference measurement value of each electrode was subtracted from the value of the meat measures of the respective electrode.Measurements on hams were taken by introducing electrodes into the sample; the reference electrode was placed on the meat sample by applying light pressure to ensure perfect contact between both elements. The measurement was taken for about 5min to achieve stabile electrochemistry. Sampling was collected in 5-s fractions. The signals obtained during this time were stored in an Excel file for further statistical analyses, and work was done with the latest sampling data average.To perform a quantitative data analysis and to determine the electronic tongue capacity's to classify the samples tested, artificial neuronal networks of the Fuzzy ARTMAP type were used. The Fuzzy ARTMAP network performed a supervised data classification and was composed of two Fuzzy ART type networks [30].Fuzzy ART is a neuronal network class that performs incremental non supervised classification learning of analogical input patterns (V) in different output categories (C) (Fig. 2), depending on the relationship between the input data. Clustering is set by three control parameters: vigilance parameter rho (ρ), learning parameter beta (β), and biasing parameter alpha (α). Vigilance parameter (ρ) takes a value between 0 and 1. Values close to 1 denote strong clustering (two samples need to be similar to be classified into the same cluster). Values close to 0 enable larger categories to form (fewer output nodes). So the best ρ value should cluster similar data in the same group, but cluster in separate groups with different data. Learning parameter (β) determines the velocity at which the network learns. High β values imply a quick learning process, but noise can also increase. So a vector of weights (wj), which related each output category and the input data, was finally established. A weight matrix with all the output categories was obtained. Parameter α indicates the number of subclasses to be created, and usually takes a value close to zero.The Fuzzy ARTMAP network was composed of two types of Fuzzy ART networks. One used the training data (C) and the other utilized the verification data (V). The relationship between both Fuzzy ART networks was performed by a memory map called mapfield. The input data were normalized to 1 and duplicated by adding their complement (I). Thus a data vector, which allowed the network weights (w) and the maximum and minimum input values to be found, was obtained.After network training, several parameters (ρ, β, weight array and mapfield) were obtained. These parameters were used to program the verification algorithm, which can be included in the microcontroller. The maximum and minimum data values of each input variable are also required to normalize the input data. Weight matrix size may preclude implementation in the microcontroller due to limited memory space. Therefore, obtaining the minimum memory size and the best sample classification rate was the primary objective of this work to, thus, classify ham samples.Despite the numerous applications of the Fuzzy ARTMAP network, their algorithm can be complex and redundant. It can also present difficulties in applications with a memory restriction to support the algorithm. In most of the above applications, the algorithm is implemented on a PC, where memory is often large enough for the algorithm to work properly. The problem arises when we wish to incorporate the Fuzzy ARTMAP network into portable measuring systems, where low-cost microcontrollers with limited memory are used. These systems seek algorithms that take up as little space memory as possible.For the Fuzzy ARTMAP algorithm to be easily programmable, a Simplified Fuzzy ARTMAP (SFAM) [14] method was employed. SFAM is a vast simplification of the Fuzzy ARTMAP. It classifies inputs by its fuzzy set of features and, unlike its predecessor, it reduces computational overhead and architectural redundancy, used to develop algorithms in a MATLAB environment [31].During the training process, the neural network weights (Wl) and output categories were obtained (ON) and these parameters were used during the network verification process. Fig. 3offers a block diagram of the verification process, in which the verification data were initially read, were also normalized to 1 and were complemented. Subsequently, the weights and categories of the outputs obtained during the training process were read, starting with a low α value. With these values, the activation function for all the classes (Tj) was calculated and that which obtained a higher value of the function was chosen. Having obtained the highest value, the match function was determined to check if it was higher than the ρ value. If so, the class was selected; if not, the same task was performed with the following class. If any class did not achieve the match function, it was assumed that the data were beyond the range; i.e., did not belong to any category.A Graphic User Interface (GUI) program in the MATLAB platform was developed to obtain the minimum size of the parameters required to allow microcontroller programming to generate a maximum success rate [21]. Fig. 4shows a block diagram of the operation.The program first performed a partition of the input data to be used as the training and validation tasks in the proportions determined by the GUI program user. A partition was made depending on the outputs categories, which usually involves the same number of members of each output category in both the network training data set and the validation group. Next the ρ and β values were scanned to determine the combination of values that yielded a smaller mapfield. The sample classification success rate for each combination of the ρ and β parameter values was determined. With these results, the ideal ρ and β values were established and a reduced memory map was obtained. To check this, none of the data used for calibration and training were employed.The program that developed GUI performed all the training and validation network tasks with various screens, where the input parameters were specified and the results were displayed. Fig. 5shows the network training screen where multiple parameters are specified: sweep values ρ and β, the mapfield values for all these values, the success rate obtained with each mapfield, maximum and minimum values, etc.After determining the optimal parameters of the neural network algorithm Simplified Fuzzy ARTMAP (SFAM), they were checked by employing the data not used during the neural network's training and validation process. The microcontroller program read the input data and then followed the routines set in the SFAM network using the obtained ρ values, weights, mapfield and the maximum and minimum values of entries. However, it did not use learning parameter (β), which was not included in the algorithm because the neural network was fixed and there was no learning phase.PIC18F4550 was the microcontroller used (Microchip Technology Inc.). This device is a PIC18/8-bit family microcontroller, has 2kB of RAM and 32kB of reprogrammable flash memory, supports up to 32 endpoints and incorporates a range of features that can significantly reduce power consumption during operation. The PIC18F4550 microcontroller software was designed to obtain the Fuzzy ARTMAP network, was coded in C language for the microcontroller and consisted in two main routines: a first routine for the data acquisition system, where the microcontroller read the test data at a voltage from outside; a second routine for neural network implementation. The test data were obtained by precision potentiometers to achieve equal voltages of the measures taken on the different ham samples. This task was performed because it is difficult to regain ham pieces with the same curing time and the same salt formulations as those samples used to train and test the neural network.

@&#CONCLUSIONS@&#
