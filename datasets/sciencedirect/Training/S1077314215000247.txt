@&#MAIN-TITLE@&#
Convergence analysis of multidimensional parametric deformable models

@&#HIGHLIGHTS@&#
Multidimensional parametric deformable models are formulated in the Fourier domain.The convergence of these models is also analyzed in the frequency domain.The eigenvalues of each spectral component of the system rule its convergence speed.The parameters of the iterative system can be optimized by using these eigenvalues.This process can be generalized to models of any number of dimensions.

@&#KEYPHRASES@&#
Multidimensional deformable model,Euler–Lagrange equation,Convergence analysis,Finite elements discretization,Non-rigid deformation,Frequency domain,Partial differential equations,

@&#ABSTRACT@&#
Deformable models are mathematical tools, used in image processing to analyze the shape and movement of real objects due to their ability to emulate physical features such as elasticity, stiffness, mass and damping. In the original approach, parametric models are obtained from the minimization of an energy functional by means of the Euler–Lagrange equation. Finite element method is used for spatial discretization. The shape and position of the model is governed by a second-order partial differential equation system, which is obtained by applying the calculus of variations. Subsequent work propose a model formulation defined completely in the frequency domain, by translating the PDE system into the Fourier domain. This new approach offers important computational efficiency and an easier generalization to multidimensional models, since each spectral component of the model is ruled by an independent PDE. This paper reviews the frequency based formulation and analyzes the convergence and stability of these multidimensional parametric deformable models. Results show that the accuracy and speed of convergence depend on the dynamic parameters of the system and the spectrum of the data to be characterized, providing a procedure to speed-up the convergence by an appropriate choice of these parameters.

@&#INTRODUCTION@&#
Deformable models are mathematical structures inspired by non-rigid physical objects. They are able to describe the boundaries and inner parts of real objects by means of curves, surfaces or volumes that deform under the influence of internal and external forces. The physical characteristics of the objects, such as elasticity, stiffness or mass, are emulated by the use of the internal forces. By contrast the external forces lead the model to follow the shape of the data to be characterized. This data is obtained regularly by means of multidimensional images, although deformable models can also be applied to other types of signals.The shape of the model is usually determined from the minimization of an energy functional through an iterative process. In this functional both internal and external energies influence the outline and position of the model. Thus, the final state is achieved when equilibrium is reached between these internal and external forces. Euler–Lagrange is applied to this functional providing a partial differential equation (PDE) system which characterizes the shape of the model. Since models are dynamic, if data changes over the time, external forces are recalculated, and then the model can rapidly adapt to the changing data by means of this PDE. Consequently, the deformable model is able to emulate the shape and physical properties of changing objects, especially those with non-rigid motion or deformation.These models have been used and further developed extensively in the last three decades due to their wide range of applications in the field of image processing and computer vision. The main motivation is to provide reliable tools to analyze, model and reconstruct datasets where the challenge lies in retrieving high-level information from low-level signals while minimizing the impact of noise and other unwanted effects. Among their vast range of applications are pattern recognition [1–3], object and motion tracking [4,5] as well as image segmentation [6–10]. In addition, their usage in the simulation of soft tissue [11,12], computer animation [13–15] and non-destructive testing of products [16,17] makes these models particularly valuable. Furthermore, in the field of medical imaging [9,10,18,19], the widely recognized value of deformable models arises from their ability to segment, match and track images of anatomic structures exploiting features derived from datasets.Deformable models were introduced by Kass et al. [20] under the name of active contours or snakes. Since these models held a single parameter, they were able to characterize linear objects which should be defined in the two-dimensional plane. Terzopoulos et al. generalized them to three dimensions in [21,22]. Nowadays, deformable models are well-known tools in the literature. Montagnat et al. [23] provides a comprehensive classification of different approaches according to the surface representations and mathematical background. Besides, books [18,24] describe the formulation of most used models focused on medical image processing.When designing deformable models a distinction between discrete and continuous representations must be made. First, with discrete representations the geometry of the model is only known at a finite set of points. Particle systems [14], spring-mass models [25,26] and simplex meshes [27–31] are discrete approaches. In contrast, continuous representations offer the ability to compute differential quantities such as surface normals or curvature everywhere in the model because they provide at most aC1continuity. They must be discretized for the iterative process, but the continuous function can be easily collected after each iteration.Continuous deformable models can be broadly classified into explicit and implicit models. In the explicit models [2,6,20,21,32], also known as parametric ones, the object is represented by means of meshes (curves, surfaces or volumes) whose shape evolves under the control of internal and external forces. Polynomial finite support representation [32], deformable templates and modal decomposition are examples of continuous explicit schemes. The shape deformation is the main advantage of this kind of models since it allows a fast adjustment to different objects. In contrast, their main drawback is the difficulty to change the topology of the model, so the basic topology must be created before the deformation. These topological constraints could provide however some benefits in experiments with a priori knowledge about the rough shape of the data of interest. Specifically, these models ensure that no topological change between initial an final stage is produced.Nevertheless, in order to overcome these constraints of the explicit models, several works have been developed over recent years. In [33]T-snakes are proposed, an extension of the classic snakes to provide flexibility in topology by means of an iterative reparameterization of the contours. Several works [34–36] develop techniques based on detecting the self-intersections in the evolving mesh and merging the colliding regions using a set of remeshing rules. In [37] undesirable loops of an active contour are detected by inspecting the total net change of a given contour angle. Similarly, [38] shows an approach where the mesh is iteratively updated by computing the Delaunay triangulation of the model.The second class of deformable models, namely the geometric or implicit ones, use a distance transformation to define the shape of the n-dimensional object as a level set of an(n+1)-dimensional object [39–41]. The progression of these implicit-scheme models is based on the theory of curve evolution, being able to provide topological flexibility in the iterative process. Therefore, topological changes can be automatically handled within the iterative process. As a drawback, the user interaction is more difficult and the computational cost is higher than the parametric models. Nevertheless, some optimizations have been proposed to increase the computational efficiency, as in the case of the narrow band principle, which was applied to the numerical evolution scheme of level sets [42,43] or to the energy itself [44,45], and nowadays are very popular in the literature [18].In recent years, new approaches to deformables models have been published in order to characterize the inner part of objects. The formulation of MetaMorphs [46] integrates both shape and interior texture as a generalization of previous parametric and implicit geometric deformable models. The shape is represented implicity and the interior texture is captured using a nonparametric kernel-based approximation of the intensity probability density function. Furthermore, Topological Active Volumes (TAV) [47] are parametric 3D deformable models based on the active nets model. This model has two different kinds of nodes: external nodes for surface adjustment and internal modes for modeling the inner topology. Both MetaMorphs and TAV allow topological changes in their structure in order to adjust the concavities, detect holes and find separate objects in the scene [48].Most approaches for the above mentioned deformable models are raised in the spatial domain [20,21,32]. This space-based formulation leads to a complicated extension to multidimensional systems, due to the resulting high computational load for models with a large number of nodes when defined inR3or higher [49]. Alternatively, a new approach for active contours were completely formulated in the frequency domain in [50]. Both spatial and frequency defined models accomplish a similar adjustment to the data, but the computational efficiency of the frequency approach is remarkable.In [51] we presented a framework for multidimensional parametric models, which are completely defined in the frequency domain similarly to [50] from a generalization of the classical framework of active contours [32]. Although, B-splines are used as polynomial finite support, these models can be easily built with other shape functions. Besides, since it is set in the Fourier domain, this formulation can be applied to models of any number of dimensions with a low computational complexity, allowing the modeling of complex data with a high speed of adaptation. Therefore, open or closed active meshes can be used to model edges of three-dimensional objects as well as three-dimensional structures to characterize the inner part of multidimensional data. Furthermore, the efficient implementation of the model in the frequency domain allows fast tracking of changing data over time.These models include a set of parameters that define their behavior, i.e., mainly elasticity, stiffness, mass and damping. Additionally they make use of other parameters that characterize how the model fits the data. The choice of these parameters is not a trivial task and it can restrict the final adjustment of the model and its speed of convergence. For this reason, it is highly advisable to study how these parameters determine the temporal evolution of the model and its convergence to the data. In [52] the convergence of active contours, i.e., unidimensional models, is analyzed using a modal decomposition based on an eigen analysis in the spatial domain. The work presented in [52] is limited to active contours and provides conditions that speed up the convergence and make it optimum. Namely, these are based mainly on the appropriate choice of the dynamic parameters of the model.In this work we propose a similar study applied to the general framework of multidimensional parametric deformable models. Thus, their formulation is analyzed resulting in a procedure to maximize the speed of convergence maintaining the stability of the model. This analysis is performed completely in the frequency domain, which leads to a decoupling of the frequency components of the model. Hence, the convergence conditions are obtained individually for each frequency component, which allow us to apply the results to models of any number of dimensions and shape functions, avoiding the restrictions found in [52].The paper is organized as follows. Section 2 reviews the continuous formulation of the generalized multidimensional model. Section 3 describes the discretization applied to the model, resulting in an iterative process in the frequency domain. Later, Section 4 portrays the problem statement, i.e., the convergence analysis of the models. The study of the convergence conditions is also conducted in this section, which leads to the mentioned optimization procedure. Section 5 addresses the practical implementation of the models, detailing both the algorithm and the computational analysis of the proposed method. Results with single spectral component signals and real data are detailed in Section 6. Then, discussion about the convergence conditions and efficiency are detailed in Section 7. Finally, Section 8 presents the conclusions and intended future work.An e-dimensional parametric deformable model is a time-varying curve, surface or hypersurface defined inRdas,(1)v≔v(s,t)=[v1(s,t),…,vd(s,t)]⊤,where t denotes the time,vi(s,t)represents the coordinate function for dimension i and the vector of parametric variables in the spatial domain is expressed bys≔[s1,…,se], wheresj∈[0,Lj],e⩽dande,d∈N.We consider firstly the modeling of the data as a static process i.e.,v≔v(s). Under this assumption, the shape of the model is governed by an energy functional with internal and external energies [20],(2)E(v)=S(v)+P(v).The generalization of the internal energy of a multidimensional model,(3)S(v)=12∑i=1d∫Ωα(s)∇vi(s)2+β(s)Δvi(s)2ds,emulates its energy of deformation. The elasticity of the model is controlled by the parameterα(s)and the rigidity by means ofβ(s). The operators∇and Δ denote respectively the gradient and Laplacian operators. The integration domain is defined byΩ≔[0,L1]×…×[0,Le]and the coordinate functions are represented byvi. The term of external energiesP(v)is usually given by,(4)P(v)=∫ΩP(v(s))+F(v(s))ds,where P is a potential function based on the gradient of the data and F is also a potential function which gathers other restrictions of the model such as area, volume or any other external constraint.According to the calculus of variations, the modelv(s,t)that minimizes the energy functionalE(v)must satisfy the Euler–Lagrange equations [32], which generalized for the multidimensional case produces a system of d partial differential equations (PDE) synthesized in the following vector equation,(5)-∇·αs∇vs+ΔβsΔvs=qvs,where∇·denotes the divergence operator. The first two terms represent the internal forces of stretching and bending respectively while the third term,(6)q(v(s))=-∇vP(v(s))+F(v(s))=-∇vP(v(s))+f(v(s)),∈Rd,stands for the external forces that couple the model to the boundaries of the data and keep the external constraints. The term∇vPsymbolizes the gradient of the potential function P with respect tov,(7)-∇vPv(s)=-∂v1Pv(s),…,∂vdPv(s)⊤∈Rd.Vectorf∈Rdrepresents the restrictions provided for each coordinate function, such as minimum or maximum distance between nodes, constraints in areas or volumes, fixed positions for some nodes and other hard conditions, etc.Let us now consider the model as a dynamic process, i.e.,v≔v(s,t). It is usual to add in the time-varying modelv(s,t), a mass densityμ(s)and damping densityγ(s), both usually constant over time,(8)μ(s)∂ttv(s,t)+γ(s)∂tv(s,t)-∇·α(s)∇v(s,t)+Δβ(s)Δv(s,t)=qv(s,t),where∂tand∂ttrepresent the first and second partial derivative with respect to time. Thus, the first two terms on the left-hand side represent the inertial forces due to mass and damping forces due to friction.By assuming that each coordinate function of vectorfcan be obtained independently from the rest of coordinates and applying the gradient, Laplacian and divergence operators in (8), the following system of d decoupled PDEs is obtained,(9)μ(s)∂ttvi(s,t)+γ(s)∂tvi(s,t)-∂s1α(s)∂s1vi(s,t)-⋯-∂seα(s)∂sevi(s,t)+∂s1s1+⋯+∂seseβ(s)∂s1s1vi(s,t)+⋯+β(s)∂sesev1(s,t)=∂viPv(s,t)+fiv(s,t),where1⩽i⩽d,∂sjand∂sjsjdenote the first and second partial derivatives with respect to the parametric variablessj, respectively, andfiis the i-th coordinate function of vectorf. The usual approach to solve Eq. (9) is to apply numerical algorithms, e.g. finite-element type methods [53].In order to compute numerically the evolution of the model, the termvi(s,t)is discretized, using finite elements for spatial variables. Eachsjis divided intoNjsegments. Therefore,vican be represented as the union ofN=N1⋯Neelements,(10)vin1,…,ne(s,t)=N(s)uin1,…,ne(t),whereN(s)represents the multidimensional shape functions anduiare the nodal variables for the coordinate i. Note thatN(s)must be separable in order to decouple and analyze independently each component. B-splines and finite differences are shape functions which satisfy this requirement.Given that coordinate functionsvi(s,t)are independent, the finite element formulation can be developed for a generic coordinate function i in the range1⩽i⩽d. Since (9) is a system of d linear decoupled PDE’s, it can be expressed in matrix form. As described in [51], the Galerkin’s method can be applied to Eq. (9), resulting in,(11)Mdttui(t)+Cdtui(t)+Kui(t)=qi(t),wheredtanddttdenote the first and second derivative with respect to time,M,CandKrepresent the global matrices of mass, damping and stiffness respectively,qi(t)indicates the external forces vector andui(t)is the global vector of nodal variables. The size of matricesM,CandKis(N1⋯Ne)×(N1⋯Ne)whereas the length of column vectorsui(t)andqi(t)isN=N1⋯Ne.In a practical scenario where the mass density and damping density are uniform throughout the deformable model,MandCsatisfyM=mFandC=cF, where m and c are constants which represent the mass and damping of the model andFis the shape matrix. The matricesFandKare nested circulant and can be calculated analytically for each shape function. Fig. 1shows examples of models defined with a 1, 2 and 3-dimensional array of nodal variables.In a linear system of equations given in matrix form as (11), the coordinate functionsuiare independent, therefore this analysis can be applied to each coordinate function individually. In addition, time is discretizedt=ξΔt, whereΔtis the time step andξ∈Nthe iteration index. Likewise, the time derivatives ofu(t)are replaced by their discrete approximations.1Henceforth the notationui(ξΔt)=uξis used and the subscript i is omitted.1Considering the regressive approximations for the derivatives,2dtu(t)≃u(t)-u(t-Δt)/Δt,dttu(t)≃u(t)-2u(t-Δt)+u(t-2Δt)/Δt2.2Eq. (11) can be written as,(12)mFΔt2(uξ-2uξ-1+uξ-2)+cFΔt(uξ-uξ-1)+Kuξ=qξ-1.Gathering the terms with the same time step leads to,(13)mΔt2+cΔtF+Kuξ=2mΔt2+cΔtFuξ-1+-mΔt2Fuξ-2+qξ-1.In order to simplify the notation, the following parameters are defined,3The use of parameters η and γ allows a more compact formulation as well as an easier characterization of the behavior of the model.3(14)η=m/Δt2+c/Δt,(15)γ=Δtc/m,(16)a1=1+1+γ-1,(17)a2=-1+γ-1,where η represents the global mass of the model, γ is the relationship between damping and mass,a1anda2are the first and second order coefficients of the iterative system. Note that η and γ are positive and greater than zero, according to their physical meaning. Finally, considering the nested-circulant property ofFandK, Eq. (13) leads to an implicit scheme for the equation of motion [51],(18)η-1ηf+k⊛uξ=a1f⊛uξ-1+a2f⊛uξ-2+η-1qξ-1,where⊛indicates an e-dimensional circular convolution of discrete signals of sizeN1×⋯×Ne. The arraysfandkare assembled by rearranging the first rows of matricesFandK[51]. Similarly, the nodal variablesuand forcesqof (18) are formed by rearranging the column vectorsuandqof (13) as arrays of sizeN1×⋯×Ne[51].Alternatively, with the use of progressive approximations,4dtu(t)≃u(t+Δt)-u(t)/Δt,dttu(t)≃u(t+Δt)-2u(t)+u(t-Δt)/Δt2.4an explicit scheme is derived instead,(19)f⊛uξ=a1f-η-1k⊛uξ-1+a2f⊛uξ-2+η-1qξ-1.Therefore, depending on the approximations for the derivatives, two iterative schemes are inferred.By applying the e-dimensional Fourier transform(eFT)to the spatial domain, the e-dimensional circular convolutions of periodical sequences5Deformable models are assumed to be closed. That is,vi(s)|sj=0=vi(s)|sj=Lj∀i,j∈N. As described in [50], extensions must be used to deal with non-closed models.5are transformed into the product of their spectra. As a result, the spectral components of the nodes for the iteration ξ can be isolated in the implicit,(20)Uξ(ω¯)=H(ω¯)a1Uξ-1(ω¯)+a2Uξ-2(ω¯)+Qξ-1(ω¯)ηF(ω¯),and explicit scheme,(21)Uξ(ω¯)=H′(ω¯)Uξ-1(ω¯)+a2Uξ-2(ω¯)+Qξ-1(ω¯)ηF(ω¯),whereU(ω¯),F(ω¯)andQ(ω¯)are theeFT’s of their respective spatial sequences andω¯≔[ω1,…,ωe]is the vector of continuous frequency variables. Equations of motion (20, 21) provide an efficient iterative system to adapt the deformable model to the data. Internal forces are imposed by the e-dimensional filters,(22)H(ω¯)=11+K(ω¯)ηF(ω¯),and(23)H′(ω¯)=a1-K(ω¯)ηF(ω¯).External forces are applied instead by means ofQ(ω¯). The expressions ofF(ω¯)andK(ω¯)for B-splines and finite differences are defined in A.From expressions of A it can be proven that the termK(ω¯)/F(ω¯)is a symmetric and2π-periodic function with respect to the variablesωj, whose value is bounded by the following range,(24)0⩽K(ω¯)F(ω¯)⩽K(ω¯)F(ω¯)max.The minimum of the function occurs for the continuous frequencyω¯=0¯,K(ω¯)/F(ω¯)|min=K(0¯)/F(0¯)=0whereas the maximum is obtained for frequencies6When working with discrete systems the range of frequencies is bounded by-π<ωj⩽π.6ω¯=±π¯, i.e.,K(ω¯)/F(ω¯)|max=K(±π¯)/F(±π¯). From Eqs. (22) and (23) and the restriction0<η, it can be derived that the implicit-scheme filterH(ω¯)is bounded by0<|H(ω¯)|⩽1. On the contrary, the amplitude of the explicit-scheme filterH′(ω¯)can be positive or negative and its modulus can be higher or lower than unity.The filterH(ω¯)has always an infinite length impulse response (IIR) and a lowpass behavior, attenuating high frequency components of the model such as sharp variations. In contrast, the spectral characteristics of the finite impulse response (FIR) filterH′(ω¯)depend on the parameters of the model. As shown in Section 4, the use of the IIR filter claims for less demanding stability conditions and it generally provides a faster convergence. The FIR scheme, on the other hand, allows a simpler addition of the extensions [50] and therefore an easier application to non-closed models. However, its evolution is slower than the previous case and stability conditions must be considered. Fig. 2depicts the frequency spectra of two-dimensional filtersH(ω¯)andH′(ω¯)for a certain set of parameters.Finally, it is noteworthy that (20) and (21) can be obtained because (9) is a system of d decoupled PDEs and, under the mentioned considerations, this system can be written in matrix form using nested circulant matrices. In this case, the matrix multiplication is equivalent to a circular convolution of two discrete signals, whose transformation in the Fourier domain results in a product of their respective spectra. It should be noted that this approach is not straightforward in scenarios with non-linear PDEs, as for instance, the geodesic active contour [54,55] whose parametric implementation has a non-linear Euler–Lagrange equation which depends on the curvature of the contour.This section addresses the convergence and stability characteristics of deformable models, whose dynamic nature is described by the iterative Eqs. (20, 21). The aim of this analysis is to determine the conditions to ensure system stability and speed up in the adjustment of the model to the data along the iterative process. In particular, the influence of the parametersα,β,γand η will be a key point, since the behavior of the deformable model, and hence the whole iterative process, are governed by them.As described later in this section, although all parameters are involved in the adjustment process, their effect on the process is distinctly different. On one hand, α and β are the static parameters that characterize the elasticity and rigidity of the model. Their influence is noticeable in the level of adjustment of the model to the data depending on the level of artifacts or noise, characterized by high frequency components. On the other hand, the parameters η and γ are defined in terms of the dynamic parameters m and c, which have a greater impact during the process of adjustment. Specifically, γ has a big influence in the iterative system, since the first and second order coefficients of the system,a1anda2, depend on γ. The parameter η influences the spectrum of the filter of the iterative system, and hence, the stability of the process.In the analysis of convergence it is important to distinguish the two stages that arise in the process of adaptation of the model to the dataset. During the first one, called transient state of the iterative process, the model moves quickly from the initial position to the rough shape of the object to be traced. In this stage some nodes of the model are trapped from the dominant borders while other nodes are affected only by the smoothness constraints of the model. The attraction of the nodes to the target is due to the external forces generated by the gradient of the data, whereas the filterH(ω¯)orH′(ω¯)is applied to all nodes as smoothing internal forces.The second phase of the adaptation process, namely the steady-state, begins when the deformable model reaches the vicinity of the data of interest. In the course of this phase, the model moves slowly and tends to reach an equilibrium between external and internal forces.The convergence and stability of the iterative systems underlying the implicit and explicit implementations of deformable models can be studied from two different approaches. One of them is by using the z-transform and analyzing the poles of the transfer function of the iterative system. The other approach is based on the analysis of the spectral radius of the matrix of a first-order iterative system, that is, the absolute value of the largest eigenvalue of the iteration matrix. Next, the two approaches will be used to ensure that both provide the same information about the dynamic behavior of deformable models described by (20) or (21).Before proceeding, two assumptions are assumed. Firstly, we suppose slow variations of external forces, i.e.,Qξ-1(ω¯)=Q(ω¯). Secondly, the array of nodesUξ(ω¯)is expected to converge to arrayU∞(ω¯). Although the external forces are really time-dependent (or ξ-dependent) in a practical scenario, the static behavior of the external forces is necessary due to the difficulty of the general case. This assumption, similarly to that made in [52], allows us to analyse the dynamical properties of the deformable model in a certain moment. Moreover, experimental results in Section 6 will show that these assumptions are perfectly admissible.In addition, it should be noted that since Eqs. (20) and (21) are expressed in the Fourier domain, each frequency component ofU(ω¯)is decoupled from the rest of components in the iterative process. Then, the results of the analysis can be applied to models of any number of dimensions and any shape function, by simply calculating the functionsF(ω¯)andK(ω¯)for the model of interest.In order to study the convergence, we analyze the residual errorEξ(ω¯)at iteration ξ-th for different values ofω¯. This error is defined as the difference array between the nodes of the model at the current iteration and the model in the final state,Eξ(ω¯)=Uξ(ω¯)-U∞(ω¯). Thus, the residual error for the implicit scheme in Eq. (20) can be approximated by,(25)Eξ(ω¯)=a1H(ω¯)Eξ-1(ω¯)+a2H(ω¯)Eξ-2(ω¯).By applying the z-transform to Eq. (25) with respect to the discrete temporal variable ξ, this expression results in,(26)E(ω¯,z)=a1H(ω¯)E(ω¯,z)z-1+a2H(ω¯)E(ω¯,z)z-2,where the residual error can be isolated as,(27)E(ω¯,z)=11-a1H(ω¯)z-1-a2H(ω¯)z-2.The polesp(ω¯)ofE(ω¯,z)are the z values that corresponds to the roots of the second order polynomial,(28)z2-a1H(ω¯)z-a2H(ω¯)=0.These poles can be easily calculated for a given frequencyω¯,(29)p1,2(ω¯)=a1H(ω¯)2±12a12H2(ω¯)+4a2H(ω¯),and provide information on the stability and convergence of the iterative process for each frequency component ofU(ω¯). Depending on the sign of the discriminant of Eq. (28), i.e.,Δ(ω¯)=a12H2(ω¯)+4a2H(ω¯), these poles can be complex double, single or real double, resulting in an underdamped, critically damped or overdamped process respectively.Parallel to the above analysis, the convergence of a first order iterative method can be studied by analyzing the spectral radius of its iteration matrix. For this purpose the order of the system (20) has to be reduced. By defining,(30a)Uξ(ω¯)≔Uξ(ω¯)Uξ-1(ω¯),(30b)H(ω¯)≔a1H(ω¯)a2H(ω¯)10,(30c)Qξ-1(ω¯)≔H(ω¯)Qξ-1(ω¯)ηF(ω¯)0,and using the same assumptions, the equation of motion can be collected as a first order system,(31)Uξ(ω¯)=H(ω¯)Uξ-1(ω¯)+Qξ-1(ω¯),and the residual error can be assessed as,(32)Eξ(ω¯)=H(ω¯)Uξ-1(ω¯)-U∞(ω¯)=H(ω¯)Eξ-1(ω¯),whereEξ(ω¯)is defined as,(33)Eξ(ω¯)≔Eξ(ω¯)Eξ-1(ω¯).MatrixH(ω¯)describes explicitly on the convergence characteristics of the frequency componentω¯of the equivalent modelU(ω¯). This matrix can be written asH(ω¯)=LDL-1, whereD(ω¯)is a diagonal matrix containing the eigenvalues{λ1(ω¯),λ2(ω¯)}andL(ω¯)is a matrix with the corresponding eigenvectors. These eigenvalues can be calculated from Eq. (30b) and match the poles obtained in (29), i.e.,λ1,2(ω¯)=p1,2(ω¯). Therefore, both elements provide the same information about the modes of convergence of the system as well as the evolution of the model towards the final situation.As mentioned in [56,57], iterative methods converge if and only if the spectral radius of the iteration matrix, defined as,(34)ρ(H(ω¯))≔max{|λi(ω¯)|}|i=1,2,is strictly less than unity. That is to say, whenρ(H(ω¯))<1is fulfilled. Likewise, the system is stable whetherρ(H(ω¯))⩽1. Note that each spectral componentω¯of the modelU(ω¯)is related to a differentρ(H(ω¯))and shows therefore a different behavior. Thus, to ensure convergence and stability, conditions|λ1,2(ω¯)|<1and|λ1,2(ω¯)|⩽1must be accomplished respectively, for all spectral components of the model in the three possible modes of convergence.As mentioned in the beginning, the adaptation of the model involves two stages. During the first stage, some nodes of the model move quickly from the initialization to the rough shape of the object to be traced. The error along this transient stage shows an oscillating behavior in all modes of convergence and its envelope can be approximated by,(35)Γ(Eξ(ω¯))≈|ϱ(ω¯)|·|λ̃(ω¯)|ξ,whereΓ(·)denotes the envelope function and the termϱ(ω¯)refers to the difference of the frequency componentω¯of the model between the initialization of the process and the final state. Namely,(36)ϱ(ω¯)=U0(ω¯)-U∞(ω¯).In Eq. (35),|λ̃(ω¯)|collects the information of the eigenvalues which determine the convergence mode of each spectral component. For complex double eigenvalues,|λ̃(ω¯)|=|λ1(ω¯)|=|λ2(ω¯)|, for single one|λ̃(ω¯)|=|λ(ω¯)|and finally for real double ones|λ̃(ω¯)|=|λ1(ω¯)+λ2(ω¯)|/2.In Section 6.1, the evolution of the error during the transient state in one and two-dimensional models is simulated and compared to the theoretical approach of Eq. (35) for the three modes of convergence.Once the model has reached the coarse adjustment to the boundaries of the data, begins the steady stage of the adaptive process, where a fine modeling of the object takes place. In this second phase, the model tends to evolve to an equilibrium between external and internal forces. This stage has a longer duration than the previous one since it involves a fine adjustment to the data. Moreover, depending on the mode of convergence, the way and speed of fitting changes substantially. For this reason the evolution of the model in steady state is examined below in each of the three modes of convergence.The frequency componentω¯of the model converges with a critically damped behavior when the discriminantΔ(ω¯)of Eq. (28) equals zero, i.e.,a12H2(ω¯)+4a2H(ω¯)=0. By considering that0<H(ω¯)⩽1∀ω¯, we have,7H(ω¯)=0provides the meaningless trivial solution.7(37)a12H(ω¯)+4a2=0.By replacing the expressions ofa1anda2given in (16) and (17), respectively, in terms of γ and multiplying by(1+γ)2, Eq. (37) is transformed into(2+γ)2H(ω¯)-4(1+γ)=0, and rearranging the terms, previous Eq. can be written as,(38)H(ω¯)γ2+4H(ω¯)-1γ+4H(ω¯)-1=0.This equation provides two values for the parameter γ that set the critically damped mode. Nevertheless, according to their physical meaning, γ must be always positive and nonzero. Therefore, only the positive value of γ can be chosen for the model, being expressed by,(39)γc(ω¯)=2H(ω¯)1-H(ω¯)+1-H(ω¯).Note thatγcdepends on the amplitude of the filterH(ω¯), and in consequence, on the frequency variableω¯. Fig. 3depicts the value8γcmax=γc|H=0=γc|ω¯=π¯andγcmin>γc|H=1=γc|ω¯=0¯=0.8ofγcversusH(ω¯).The substitution of (39) into the expression (29) yields the value ofλcfor this case of convergence,(40)λc(ω¯)=H(ω¯)21+H(ω¯)H(ω¯)+21-H(ω¯)+1-H(ω¯).Fig. 4shows the value ofλcdepending on the amplitude of the filterH(ω¯). As can be drawn from the picture, the eigenvalue is bounded by0<λc(ω¯)<1,(41a)H:Ω‾→H‾,λc:H‾→0,1,(41b)Ω‾≔-π,π×…×-π,π︸e⊂Re,H‾≔0,1⊂R.The parameter γ is usually set constant over the iterative process, i.e.,γ=γs. Thus, the process evolves through the critically damped way only for frequenciesω¯swhose amplitude of the filter isH(ω¯s)=Hcs, whereHcscan be calculated by,(42)Hcs=4(1+γs)(2+γs)2.For the rest of frequenciesω¯≠ω¯s, the system performs the adaptation either through the under or the overdamped case as it is illustrated in Fig. 3.Given a certain frequency vectorω¯, ifγs<γc(ω¯)the resultant discriminant is less than zero, i.e.,Δ(ω¯)<0. Therefore, for all frequenciesω¯that satisfyH(ω¯)<Hcs, the eigenvalues are complex and located inside the unit circle,(43a)H:Ω‾→H‾,λ1,2;Δ<0:H‾→ΛΔ<0,(43b)ΛΔ<0≔c∈C:0<|c|<1,whereΩ‾andH‾are the domains defined in (41b).The discriminant is greater than zero for the frequenciesω¯that satisfy the inequalityγc(ω¯)<γs, i.e.,Hcs<H(ω¯). Then, the system offers two different real positive eigenvalues bounded by,(44a)H:Ω‾→H‾,λ1,2;Δ>0:H‾→]0,1]⊂R,whereΩ‾andH‾are defined in Eq. (41b). The eigenvalueλ1;Δ>0(ω¯), which is linked to the+sign of expression (29), is the largest one. Since the speed of convergence of the spectral componentω¯of the iterative system depends on its corresponding eigenvalue,λ1;Δ>0(ω¯)is the dominant eigenvalue which rules the convergence of this component.In consequence, each spectral component of the model iterates in one of the three possible modes of convergence. For all modes, the eigenvalues are bounded by ]0,1] whetherω¯≠0¯. Forω¯=0¯the eigenvalues are equal to the unity. In conclusion, the proposed iterative system defined by means of an implicit scheme converges for all frequencies except forω¯=0¯, where at least stability can be guaranteed. Therefore, the residual error is reduced through iterations approaching the model to the data.By applying the same assumptions from Section 4.1, the residual error of Eq. (21) can be calculated by means of the following second order system,(45)Eξ(ω¯)=H′(ω¯)Eξ-1(ω¯)+a2Eξ-2(ω¯).Likewise, Eq. (21) can be reduced to a first order system,(46)Uξ(ω¯)=H′(ω¯)Uξ-1(ω¯)+Qξ-1(ω¯),and the residual error can be expressed as,(47)Eξ(ω¯)=H′(ω¯)Uξ-1(ω¯)-U∞(ω¯)=H′(ω¯)Eξ-1(ω¯),whereU(ω¯),H′(ω¯),Q(ω¯)andE(ω¯)are defined similarly to Eqs. (30) and (33). The spectral decomposition of matrixH′(ω¯)provides the eigenvaluesλ1,2′(ω¯), which are equal to the poles ofEξ(ω¯)in (45) and can be computed by means of,(48)p1,2′(ω¯)=12H′(ω¯)±12H′2(ω¯)+4a2.These poles are calculated similarly to the implicit scheme. By applying the z-transform to Eq. (45) a second-order polynomial is derived, whose roots are the polesp1,2′(ω¯)expressed by (48).Both poles and eigenvalues provide information on the convergence of the model along the two stages of the iterative process. Furthermore, the discriminant of the second order polynomial,Δ′(ω¯)=H′2(ω¯)+4a2, determines the mode of convergence, i.e., underdamped, critically damped or overdamped. Along the transient state, the residual error can be approximated again by Eq. (35) where|λ̃(ω¯)|must be calculated fromλ1,2′(ω¯)in a similar way to the implicit scheme. Once again, in order to ensure the convergence of the process, the condition in the steady state,|λ1,2′(ω¯)|=|p1,2′(ω¯)|<1∀ω¯, must be satisfied for the three cases.It can be proved that the parameterγ′that satisfiesΔ′(ω¯)=0is determined by,(49)γc′(ω¯)=-K′2(ω¯)+3K′(ω¯)+2K′(ω¯)K′(ω¯)2-2K′(ω¯)+2.whereK′(ω¯)=K(ω¯)/(ηF(ω¯)). The parameterγc′(ω¯)depends onK′(ω¯), and accordingly,9Since the parameter γ must be real finite positive and nonzero, the valuesγc′|ω¯=0¯=γc′|K′=0=0,γc′|K′=1→∞andγc′|K′⩾4⩽0are non-valid.9onω¯. Fig. 5depictsγc′versusK′(ω¯).Substitutingγc′in the expression (48) we obtain the eigenvalue for the critically damped case,(50)λc′(ω¯)=-11+γc′(ω¯).Thus, the modulus of the eigenvalue is bounded by0<|λc′(ω¯)|<1within the following frequency range,(51a)K′:Ω‾→K′‾,λc′:K′‾→]0,1[,(51b)K′‾≔0,1∪1,4⊂R.whereΩ‾is defined in Eq. (41b). Fig. 6depictsλc′(ω¯)for the valid range ofK′(ω¯).From the graphical results of Fig. 5, it is simple to deduce that by setting a specific value within the iterative process,γ=γs, we get three zones of iteration. These zones are separated by the border of the critically damped case, which can be computed with,(52)Kcs;1,2′=2+γs±1+γs1+γs.In accordance, the process evolves through the critically damped way only forω¯sthat yieldsK′(ω¯s)=Kcs;1,2′. For the rest of frequenciesω¯≠ω¯s, the mode of iteration of the system is underdamped ifKcs;1′<K′(ω¯)<Kcs;2′or overdamped whetherK′(ω¯)<Kcs;1′orKcs;2′<K′(ω¯). Therefore, the conditions for global stability and convergence for any value ofω¯, must be satisfied for the three types of operation.This mode is present for frequenciesω¯that lead toγs<γc′(ω¯). By assumingΔ′(ω¯)<0in Eq. (48), the modulus of the eigenvalues is constant over frequency, that is, it depends only on the parameterγsas follows,(53)|λ1,2;Δ′<0′|=11+γs.Both eigenvalues are complex and have identical modulus, which is less than unity,(54a)H′:Ω‾→H′‾,λ1,2;Δ′<0′:H′‾→ΛΔ<0,(54b)H′‾≔-21+γs,21+γs⊂R,whereΩ‾andΛΔ<0are defined in (41b) and (43b) respectively.For frequenciesω¯that accomplishγc′(ω¯)<γs, we obtain an overdamped iteration. From Eq. (48) it can be proved thatΔ′(ω¯)>0whenH′2(ω¯)>|4a2|. This is possible both for positive and negative values ofH′(ω¯), resulting in two different overdamped regions as shown in Fig. 5.It is simple to deduce that the eigenvalues are bounded by|λ1,2;Δ>0,H′>0′(ω¯)|<1whenH′(ω¯)>0, being equal to unity forω¯=0¯. In contrast, to assure convergence whenH′(ω¯)<0, the conditionK′(ω¯)<Kmax′must be accomplished, whereKmax′can be calculated as follows,(55)Kmax′=22+γs1+γs.This boundary of convergence is shown in Fig. 5. Note thatγsis the parameter fixed for the model. Since the value ofKmax′depends onH′(ω¯)and hence, on the shape function and dimensions of the model, the parameter η of the iterative system must be chosen accordingly. Thereby, only whenη>ηmin, the expression|λ1,2;Δ>0,H′<0′(ω¯)|<1is accomplished. Table 1shows the values ofηminto ensure converge in each system.By assuming thatη>ηminis fulfilled, we collect two different positive real eigenvalues bounded by ]0,1],(56a)H′:Ω‾→H′‾,λ1,2;Δ′>0:H′‾→0,1⊂R,(56b)H′‾≔-2-γs1+γs,-21+γs∪21+γs,2+γs1+γs⊂R,whereΩ‾is defined in (41b).Given that the iterative system is linear, if the data has mainly low frequency components,10This means that the dataset is composed mostly by structures with smooth shape. This assumption is perfectly admissible since in a practical scenario the majority of dataset can be approximated by smooth shapes.10we can use the value ofKmax′only for the bandwidth of interest in Eq. (55), obtaining a lower threshold forηmin. This is appealing, because large values of η increase the speed of convergence in transient state, but on the contrary the smoothing of the model is lower, specially with data with abrupt oscillations. As a result, reducing the value of η in this way leads to smoother and also stable models.11Note that due to implementation reasons, the application of external forces from the data involves a quantification of the values of these external forces, which can generate non-linearities. In case that they emerge in the unstable region of the spectrum, they must be filtered to avoid instability in the iterative system.11As a conclusion of this section, if condition of Table 1 is satisfied, the system defined by means of an explicit scheme is convergent for all frequenciesω¯≠0¯and stable forω¯=0¯.

@&#CONCLUSIONS@&#
In this paper, the convergence of multidimensional parametric deformable models based on the frequency domain [51] has been studied and the conditions that assure the stability and speed up the model evolution have been provided. The analysis has been applied to the multidimensional models in complete generality, that is, with any number of dimensions, shape function and iterative scheme.The shape of the model in the steady situation depends on the parameter η, and the filter of the system,H(ω¯)orH′(ω¯), but its final situation is independent on the parameter γ. However, the behavior towards the final situation does depend on γ. Since the whole process is performed in the frequency domain, the iterative system is decoupled into its spectral components, allowing the calculation of the optimum γ that speed up the convergence of each frequency component, and therefore of the whole model. Regarding to stability, the parameter η shows a key role in models with explicit scheme. Thus, depending on the useful bandwidth of the data, aηminmust be set to guarantee the stability of the system. Instead, all implicit-scheme models are inherently stable.Therefore, the frequency framework of deformable models described in [51] reveals an interesting perspective for designing and analyzing parametric deformable models. Then, models with any number of dimensions and shape function can be easily constructed in the frequency domain by choosing the appropriate iterative matrices. Likewise, both implicit and explicit schemes can be selected by using the proper matrices, resulting in an iterative system with a high computational efficiency. Besides, the frequency domain analysis conducted in this paper enables the optimization of the dynamic parameters based on the bandwidth of the data to be modeled, providing a fast and accurate adjustment. Experimental results prove the effectiveness of the models and the optimization algorithm in the recovery of boundaries of two- and three-dimensional objects.Although the frequency-based formulation can be applied to models of any number of dimensions, the filter expressions are calculated in this paper only for models withe=2parametric variables. Therefore, the next future line of work involves the calculation of the frequency arrays for models of higher dimensions, i.e.,e⩾3. Within this line of research, models withe=3or active volumes are particularly interesting. These three-dimensional structures represent a deformable volume, which can conform not only to the outline of an object, but also to its internal characteristics. In addition, given that active volumes should accommodate to the internal features of the object, the algorithm for calculating the external forces needs to be modified to provide these forces from the inner part of the dataset.In summary, this general formulation of the parametric deformable models along with its convergence analysis, provide a valuable framework for the effective use of deformable models for segmentation, tracking, simulation and characterization of multidimensional data, with high flexibility, velocity and effectiveness.