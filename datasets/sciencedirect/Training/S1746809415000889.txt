@&#MAIN-TITLE@&#
Full-view photoacoustic tomography using asymmetric distributed sensors optimized with compressed sensing method

@&#HIGHLIGHTS@&#
Full-view photoacoustic image is built using asymmetric distributed sensors.Adaptive arrange the distribution of receivers.Image quality increased with compressive sensing method.

@&#KEYPHRASES@&#
Photoacoustic tomography,Compressed sensing,Asymmetric sensor distribution,Full-view imaging,

@&#ABSTRACT@&#
Photoacoustic tomography (PAT) is an effective optical biomedical imaging method characterized with non-ionizing and noninvasive, presenting good soft tissue contrast and excellent spatial resolution. To build a full-view photoacoustic (PA) image, numbers of ultrasound sensors are needed to assure the image quality, which will bring difficulties to data acquisition and real-time image display. Compressed sensing (CS) theory breaks the restriction of Nyquist sampling theorem and is capable to rebuild signals with less measurements. In this contribution, we proposed an optimization method to increase image quality of full-view PAT with less ultrasound sensors, which combines the theory of CS and a circularly distributing asymmetric data acquisition frame. The hardware cost can be saved and time efficiency of PAT can be raised without sacrificing the image quality. The feasibility of our proposed method is verified in simulation experiments which yield expected results. Our study might be helpful for clinical medical imaging such as early stage breast cancer detection, endoscopic imaging and in vivo monitoring.

@&#INTRODUCTION@&#
Photoacoustic tomography (PAT) [1] is a promising biomedical imaging method which is based on the photoacoustic (PA) effect [2,3]. As an emerging imaging modality, PAT combines the advantages of both optical imaging and acoustic imaging, thus can providing high contrast and high resolution images inside biological tissue. The principle of PAT is that when laser beam illuminates the biological tissue, the light absorption by molecules creates a thermally induced pressure jump. Under this condition, ultrasonic waves (typically with several tens or hundreds megahertz bandwidth) are launched and transmitted through the tissue, finally detected by ultrasonic sensors to form PA images. Over the recent years, work on photoacoustic imaging has seen remarkable progress. Studies have found that the theorem of PAT can be applied to various biomedical imaging fields such as brain function imaging [4,5], tumor angiogenesis imaging [6,7], intravascular imaging [8,9], and breast cancer imaging [10–12]. Among these studies, much efforts had been made to improve the image quality of PAT. For example, Kruger et al. had developed a three-dimensional breast vascular imaging system [13], which has succeeded in achieving a maximum imaging depth of 4cm with the spatial resolution of about 0.25mm. However, when building full-view PAT images, more ultrasound sensors are needed to acquire the complete data, which increases hardware cost and time complexity. The contradictory between the image resolution and the time cost remains a problem in the application of PAT to in vivo studies. Therefore, it is of great value to tackle the problem and improve the image quality of PAT without adding hardware resources.In 2006, Candès and Donoho first proposed the compressed sensing (CS) theory [14,15]. Later in 2007, Donoho et al. proposed a method applying the CS theory to Magnetic Resonance Imaging (MRI) [16] and significantly reduced scan time. As a newly emerged method of efficient data compression and processing, the CS theory enables us to recover the unobserved components and has been widely applied to the field of optical imaging in recent years. The idea of incorporating CS theory into PAT was first proposed by Provost and Lesage in 2009 [17], and was tested in phantoms using a circular scanning system. Other related works including the CS-based photoacoustic computed tomography (PACT) by Guo et al. [18] and in vivo optical resolution PACT by Meng et al. [19]. These achievements had succeeded in reconstructing PA images of better quality, either using a linear array ultrasound sensor or adopting single element rotating scanning. However, the above method still takes roughly 10min to performing a complete calculation [18]. Besides, when certain areas of the reconstructed images require special attention (e.g. the lesion in the tissue), the above method cannot ensure a best resolution at the region of interest (ROI). With respect to this problem, we proposed a novel method of PAT based on the CS theory and an asymmetric data acquisition frame, in which the ultrasound detectors are non-uniformly distributed in a circle. By incorporating compression into the data acquisition process, images can be reconstructed from what appears to be highly incomplete data via nonlinear recovery algorithms [17]. Therefore, at the cost of longer calculation time, the number of sensors needed for a given image quality can be significantly reduced. Inversely, for a given number of sensors, the reconstruction using CS provides better images. With an asymmetric data acquisition method, it is possible to further improve the resolution in the region of interest (ROI) for a given number of sensors.This paper introduces an optimized method for full-view PAT. The theoretical background of algorithms and the data acquiring mechanism are described in Section 2, reconstruction images and numeric results are shown in Section 3, followed by the work discussion and summarize in Section 4. Potential applications in the future include real-time 3D PAT, in vivo monitoring and endoscopic PA imaging.In PAT, the wave equation of the forward problem can be written as(1)p(r⇀,t)=∂∂t14πc3t∫dr⇀′p0(r⇀′)δt−r⇀−r⇀′cwherep(r⇀,t)is the detected PA signals, andp0(r⇀)is the initial pressure, c is the speed of sound, andr⇀is the position of the ultrasound sensor [20]. In order to simplify Eq. (1), the velocity potentialφ(r⇀,t)=∫0tp(r⇀,t′)dt′is introduced, and Eq. (1) can be rewritten as(2)φ(r⇀,t)=14πc3t∫dr⇀′p0(r⇀′)δt−|r⇀−r⇀′|cThe inverse problem which solvesp0(r⇀)fromp(r⇀,t)is(3)p0(r⇀)=∫S02p(r⇀0,t¯)−2t∂p(r⇀0,t¯)∂t¯|t¯=r−r0dΩ0Ω0wheret¯=ct, S0 is the detecting aperture, and dΩ0/Ω0 is the solid-angle weighting factor [20]. In order to model the above problem in the 2-D situation [18], we use a matrix x to represent the initial pressurep0(r⇀)and a matrix y to represent the received PA signalp(r⇀,t). Hence, the forward and the inverse problems can be denoted as y=Φx andxˆ=Φ−1y, respectively, where the matrix Φ is the projection matrix, andxˆis the reconstructed image.However, if the measurement is incomplete, matrix Φ is ill-conditioned, then Φ−1 is not an exact inversion of Φ. The way to solve this ill-conditioned problem is via the CS theory. According to the CS theory, the prerequisite for accurate reconstruction is the sparsity of the original signal, and the incoherency of the sensing modality. For PAT image reconstruction, we can adopt several decomposition algorithms to make the received PA signal sparse, such as Discrete Cosine Transformation (DCT) and Discrete Wavelet Transform (DWT) [21].Basically, for signal x∈CN, if it can be denoted by an orthonormal basis Ψ=[ψ1|ψ2|⋯|ψN] (e.g. the wavelet basis), then we get the following equation:(4)x=∑n=1Nψnαn=Ψαwhereαis the N×1 coefficient vector of x, and αn=〈x, ψn〉. Thus the problem of sensing x is equivalent to extracting the large coefficient in the Ψ domain. To fill the requirement of incoherency, the sensing basis set Φ should be incoherent with Ψ. In other words, the sensing waveforms should have a dense representation in Ψ. After the preconditions are meet, a sparse signal can be accurately recovered from an incomplete measurement by solving a nonlinear convex optimization problem [18](5)minx|Ψx|1s.t.|Φx−y|2<εwhere ɛ is a parameter which controls the accuracy of the reconstruction. To solve the above problem, it is necessary to adopt an appropriate reconstruction algorithm. The algorithm will solve a sparse optimization problem as well as recovering the original signal x from the measurement y. In Eq. (5), minimizing the l1 norm of Ψx promotes sparsity, and the constraint ensures data consistency. Such an l1 norm minimization problem is easily tractable through linear or second-order programming, or with a matching pursuit-type algorithm [22].According to the aperture enclosing theory brought up by Xu [2], it is possible to design a “detection region”, within which all points have sufficient detection views. For a circular detection geometry, if we arrange half of the circle with sensors and the other half without, the circle is divided into a “visible” domain and an “invisible” domain. Accordingly, if an object is located inside the visible domain, it can be stably recovered. For objects partially located in the invisible domain, the parts of its boundaries that allow normal lines to pass through a detection position can be stably recovered. Therefore, for an imaging object with a known position, we can cover it in the visible domain by adjusting the position of sensors, and obtain a complete image with higher quality under the same condition of equipment.In a typical PAT system, the amount of acquired data as well as the data acquisition speed are limited with a fixed number of ultrasound sensors. Increasing the amount of sensors may lead to better image quality, yet resulting in longer calculating time and the increase of system cost. Traditionally, linear array sensors are frequently used for their accessibility and convenience [23]. However, the image boundaries perpendicular to the longer axis of the array will be seriously blurred due to the limited-view effect, and only the boundaries within the receive range can be recovered. As a solution, circular array sensors are adopted to cover the full viewing angle. For a circular imaging system with a given number of sensor elements, experience has shown that the optimum angular increment between detector positions is about 3 degrees. If we arrange more detectors along the ROI (some preliminary knowledge of the ROI's location may be required), a higher resolution in this region may be achieved, at the sacrifice of the resolution of the image background, which contains little information and is not sensitive to quality degradation.As shown in Fig. 1, suppose we have a target tissue with a prolate ROI inside, and there is an area of lesion at one end of the ROI, in which we hope to see the detailed features clearly. Traditionally, as shown in Fig. 1a, by locating the linear array sensors close to the lesion, we may be able to get a clear image of the lesion, but all the side boundaries of the ROI will hardly be reconstructed. While in Fig. 1b, the circular array sensors will be able to reconstruct a full-view PA image, but the image quality of the area with lesion will be less satisfactory compared with the previous method. As a solution, we proposed the method depicted in Fig. 1c, which combines the advantages of both methods. Before the implementation of this method, we need to obtain a priori knowledge of the target position by a process called pre-imaging. This process aims at knowing an approximate tissue distribution and does not require high resolution, so it is fast and easy to operate with very few sensors. The complete process of obtaining a priori knowledge of the tissue and performing PAT reconstruction using non-uniform circular sensors is depicted in Fig. 2.According to the pre-imaging result (usually of low quality, but an approximate location of the ROI can be determined), we change the position of sensors to cover the lesion in the domain where more sensors are arranged. For the uninterested area such as the healthy part of tissue, as its imaging result is usually chunks of single color which has little value of medical research, less sensors are allocated alongside. In this case, more sensors will be able to collect data primarily from the lesion, consequently, the image quality of the ROI may get improved compared with images reconstructed with the same number of sensors via traditional methods. We have verified our method and find the appropriate non-uniform distribution for a certain type of ROI. The corresponding results are presented in Section 3.In this study, we will use computer simulated data to perform the process of PA reconstruction. PA signals were generated using MATLAB K-Wave Toolbox [24]. Images of different biological tissues (e.g. breast cancer, human stomach, intestine, etc.) were chosen to simulate the initial pressure source, as these images contains much detailed information which acted as good contrasts in the reconstructed images. Simulations were performed using an Intel(R) Xeon(R) X5570 CPU @ 2.93GHz and 24.0 GB RAM running 64-bit (win64) MATLAB R2012b. We chose time-reversal algorithm for PA reconstruction. In order to reach higher resolution, it was necessary to consider greedy algorithms in CS reconstruction [17]. Hereby, we chose Stagewise Orthogonal Matching Pursuit (StOMP) [25] for CS reconstruction. Compared with traditional greedy algorithms such as Matching Pursuit (MP) and Orthogonal Matching Pursuit (OMP) [26], StOMP only takes a fixed number of stages and many coefficients can enter the model at each stage, thus it is simple and effective. Generally, it takes about 27s to finish one calculation using our proposed method when the total number of sensor is 128.Our results consist of two parts: (1) Comparisons of image quality evaluation metrics between traditional PAT with uniform sensor distributions and optimized PAT with three different non-uniform sensor distributions, and (2) four groups of comparisons between the reconstruction results of the existing method and our optimized method. We have presented images as well as the numerical and graphical contrasts to evaluate the reconstruction effects objectively and effectively.The SDNR is a metric which is intended to evaluate the image quality in terms of contrast and noise [27] and is defined by(6)SDNR=S¯rec_ROI−S¯rec_bgδbgwhereS¯rec_ROIis the average pixel intensities of the ROI,S¯rec_bgis the average pixel intensity of the reconstructed image background, and δbgis the standard deviation (STD) of the background pixel intensity. The SDNR measures the signal to noise ratio in a reconstructed image.The quality index [28] is used to evaluate the quality of reconstructed images, it is defined as follows:(7)Q=4δxyx¯⋅y¯(δx2+δy2)[(x¯)2+(y¯)2]wherex¯andy¯denote the average pixel intensities of the original image and the reconstructed image,δx2andδy2are the variances of pixel intensities of the original image and the reconstructed image, and δxyis the covariance of the two images.MSE is usually used to denote the average error of an image. For image size W×H, MSE is defined as(8)MSE=1W×H∑i=1W×H(xi−yi)2where xiand yiare the corresponding pixel value of the original image and the reconstructed image respectively.As mentioned in Section 2.2, we adopted an asymmetric sensor distribution which covered the ROI in the detection region. However, for a certain imaging target with a given number of sensors, there are numerous possibilities of distribution, we cannot decide which one is the best case at the first glance. In order to investigate the effect of different asymmetric sensors, we chose a medical image of human breast cancer as the initial numeric absorber and aimed to reconstruct PA images with good quality. As shown in Fig. 3a, according to the aperture enclosing principle described in Section 2.2, more sensors should be arranged to the lower half of the image according to the location of ROI. Hereby, we define sensor distribution ratio as(9)ratio=NumupperNumlowerwhere Numupperis the number of sensors in the upper half of the aperture, andNumloweris the number of sensors in the lower half of the aperture. The total number of sensors varies from 64 to 1000, and the graphical comparisons under different ratios are presented in Fig. 3.As can be seen from Fig. 3b, the SDNRs of three groups of the optimized PAT with asymmetric sensor distributions turned out to be higher than the traditional PAT with uniform aperture distribution. If we further analyze the curves of the ratio1–3, we can find a best ratio at every point of different sensor number, which can be taken as a reference standard for cases similar to this ROI distribution. Besides, in Fig. 3c, we noticed that except for the first group of 64 sensors, the quality indexes of the improved method were higher than traditional PAT, as well as in Fig. 3d, the values of MSE of the optimized method were all lower than traditional PAT under the same conditions.In addition, we observed from the three graphs that when the number of sensors was greater than 512, the optimized method had little advantage over traditional PAT. It was probably because the imaging aperture was already saturated with sensors when the number exceeded 512, and image quality would hardly improve. So in this particular case, this method is suitable when sensor number is less than 512. With the radius of the imaging area increases, the threshold of appropriate sensor number will change accordingly.To sum up, the figures presented in Fig. 3 illustrate that compared with the traditional PAT our method can further improve image quality with less sensor resources. For example, in Fig. 3b, the SDNR of the proposed method with 128 sensors was higher than the SDNR of the traditional method with 384 sensors. Similar conclusions can be drawn from Fig. 3c and d in the cases of Quality Index and MSE.In this section, four medical images of various biological parts were adopted as numerical phantoms, namely the images of breast cancer, stomach, intestine and hip bone. These images have different ROI distribution, and the sensor distribution also varies in each situation. For each group, a multiple of simulations using the optimized method were implemented under 128 non-uniformly distributed sensors. Traditional PAT using 128 uniformly distributed circular sensors was set as a contrast [29]. Fig. 4shows the reconstructed images of traditional PAT with uniform circular sensor (left image) and improved PAT with CS and asymmetric circular sensor (right image) of four groups of simulations, and the numeric results are presented in Table 1. It is notable that the certain asymmetric sensor distributions and sensor ratios used in Fig. 4a–d were different. Each ratio was chosen as a best result from a number of simulations with different ratios, and the aim here is to verify that there exists a best situation of asymmetric sensor distribution which advantaged over the traditional PAT with uniform sensor distribution under the same number of sensors.As can be seen from Fig. 4, the contrast areas in four groups of images were marked with yellow arrows. Generally, the reconstructed images of traditional PAT were recognizable, but much artifacts could be seen inside the ROI, especially in Fig. 4d, where much streak artifacts appeared around the hip bone. While for the reconstructed images using our proposed method, the image quality was improved and the visual effect was better than the contrast images, as the artifacts disappeared in the same area. Also, we may draw a similar conclusion from numerical results in Table 1, where three indices for every sets of simulation were listed, along with the percentage of improvement from traditional PAT to our proposed method.The numerical results in Table 1 indicates that, nearly all of the indices (numbers in bold) got improved using the proposed method than using the traditional PAT method, with a maximum percentage increase of 18.66% (the last line of Table 1). According to the results presented above, for a particular target, it is possible to find a non-uniform sensor distribution scheme to produce more satisfactory PAT reconstruction results with the implementation of CS theory than the traditional method can produce. In other words, there exists such a probability that, by using our proposed method, we may build PAT images of the same quality with the number of ultrasound sensors decreased, which has the advantages of saving hardware cost and performing more efficient PA imaging for medical applications.

@&#CONCLUSIONS@&#
