@&#MAIN-TITLE@&#
An extended finite element method for pipe-embedded plane thermal analysis

@&#HIGHLIGHTS@&#
A extended finite element is proposed for the pipe embeded thermal analysis.Using the proposed method can avoid the difficulty of modeling refined meshes and effectively improve the solving speed.The enrichment shape function is constructed based on the theoritical solution.The Dirichlet boundary condition inside the element is transformed into in-element Robin boundary.Multiple-pipes problems can be solved by the proposed method.

@&#KEYPHRASES@&#
Thermal analysis,Extended finite element,Cooling pipe,Enrichment shape function,

@&#ABSTRACT@&#
In thermal analysis of concrete with cooling pipes by conventional FEM (finite element method), extremely refined conforming meshes have to be generated around the pipe axis to obtain precise temperature field. It makes the meshing process demanding and cumbersome, especially in 3D cases. To avoid the difficulty of refining meshes in conventional FEM, an extended finite element method (XFEM) is proposed in this paper with which thermal analysis with pipes can be performed on coarse meshes instead of refined conforming meshes. The enrichment shape function is constructed in the proposed XFEM based on analytical solution and the Dirichlet boundary condition of the cooling pipe is numerically approximated by in-element Robin boundary condition. Thermal analysis of a concrete slab with a cooling pipe in the center is performed by XFEM with coarse meshes and by conventional FEM with refined conforming meshes respectively. The results demonstrate that the temperature field obtained by XFEM has a comparable accuracy level with the conventional FEM. The accuracy and reliability are further validated with three other numerical cases including the varying cooling boundary case, the internal heat source case and the multiple-pipe case.temperature (°C)density (kg/m3)boundary wall of cooling pipewater temperature (°C)approximation spacemaximum adiabatic temperature rise (°C)radial distance (m)pipe radius (m)outer radius of concrete cylinder (m)Bessel function of first kindtime increment (day)stiffness matrix of heat transferthermal load matrixElementspecific heat capacity (kJ/kg°C)thermal conductivity (kJ/m°Cday)concrete domainequivalent boundaryconventional Lagrangian shape functionenriched shape functionparameter representing the heat generation rateconvective coefficient (kJ/m2°Cday)excess temperature (°C)Bessel function of second kindcharacteristic time factor (day)initial temperature (°C)mass matrix of heat transfertime (d)

@&#INTRODUCTION@&#
Multi-scale problems are always involved in every aspect of engineering field. Heat exchanger with water-circulating pipes embedded in large-scale structures is one of the application cases. They are widely utilized in the field of thermal engineering, civil engineering and mechanical engineering, such as water cooling pipe in computing clusters [1,2], pipe-cooler in nuclear power plant [3], heat pump embedded underground [4,5], pipe-heating system in buildings [6] and so on. One significant case is the cooling pipes used in mass concrete engineering [7–14], which is the main motivation of this work. Concrete releases considerable heat due to the hydration reaction of the cement, and causes temperature gradient near the air-side surface. The temperature gradients are the main causes of thermal cracks that can seriously damage the structure. Active pipe cooling is the most widely applied method to reduce temperature gradient and consequently to avoid or diminish thermal cracks.Finite element method (FEM) is the most applied numerical approach for thermal analysis of cooling pipe embedded problems because of its quick and stable benchmark. The pipe diameter is relatively smaller than concrete size and sharp temperature gradient is generated around the pipe in the cross plane normal to the pipe axis. In conventional finite element analysis, extremely refined meshes have to be generated around the pipe axis to obtain precise thermal field. Numerous numerical studies have been conducted to analyze the temperature field in mass concrete embedded with cooling pipes [15–24]. Among them, Zhu was the first to systematically propose a finite element flow for the pipe-cooling problem with a refined network of FEM meshes near the pipe [15]. Kim developed a 3D program for the thermal analysis of pipe-cooling systems by marking the pipes as line elements connected by FEM nodes [18]. Liu proposed a heat-fluid coupling method in his work and the cooling pipe is simulated by several line elements chained together considering the heat flow of water [19].All the above-mentioned FEM simulations are based on refined meshes conforming to the pipe geometry. However, the huge difference between the diameter (about 20−40mm) and the length (about 1−2m) of the pipe makes the discretization of the domain demanding and cumbersome because the meshes have to conform to the pipe geometry with acceptable aspect ratios. Besides for a 3D problem, the pipes are embedded in grid-like coils, making the meshing procedure more difficult, especially when the structure is large and complex-shaped such as arch dams [25]. Moreover, there are many cases in which multiple pipes are used, making the analysis process very costly in time and computable resources.In this paper, an extended finite element method (XFEM) [26–28] is proposed to simulate the thermal field around the cooling pipes using coarse meshes, avoiding the difficulty of generating refined conforming meshes. Advantages of the proposed XFEM is that it could make the numerical meshes independent from the domain to be discretized, which is achieved by integration of a priori knowledge of the solution field and the enrichment shape functions. The paper is organized as follows. Firstly, the governing equation of the problem is given in Section 2. The XFEM formulation is introduced to approximate the discontinuous thermal gradient field in Section 3. Secondly, the enrichment shape function is constructed on the basis of the analytical solution in Section 4. The cooling-pipe boundary condition and the quadrature scheme for discontinuous element are also discussed in details in this section. Finally, a series of numerical cases are carried out in Section 5 in which the validity and efficiency of the method are shown.The temperature variation along the axial direction of the pipe is considerably smaller than that in the radial direction. Thus this study focuses on the 2D cooling problem in the cross section normal to the pipe axis, as shown inFig. 1. The governing equation of the problem can be expressed as follows:(1)ρc∂T∂τ=∇(λ∇T)+Q(τ)inΩ,whereTis the temperature scalar,τis the time,ρis the density of concrete,cis the specific heat capacity of concrete,Q(τ)is the internal heat source of concrete, andλis the heat conductivity tensor, which is considered isotropic in this study and denoted as a scalarλ.Metal pipes are always applied in thermal engineering for their good heat conductivity. Dirichlet boundary condition, which is also known as the first type boundary condition is imposed on the pipe wall,(2)T=Tw(τ)onΓp,whereTwis the water temperature andΓpis the wall of the cooling pipe.The internal heat source of concrete is induced by the hydration heat, which can be expressed as(3)Q(τ)=ρcχ(τ),whereχ(τ)is the adiabatic temperature rise of concrete. The hydration heat in concrete increases very quickly at the early age, and then decreases gradually with the age, which is always expressed in an exponential form [29]:(4)χ(τ)=χ0(1−e−mτ),whereχ0is the maximum temperature rise of concrete under adiabatic condition,mis the parameter that represents the heat generation rate.Initially, we suppose that the water is not running in the cooling pipes. Therefore, the temperature field is uniform on the concrete domain, which provides the following:(5)T=T0(x)whenτ=0,whereT0(x)is the initial temperature of the concrete.Generally the temperature field is approximated by the conventional FEM, as shown in the following equation:(6)Tappx(x)=∑i=1i∈SΝi(x)Ti.whereSis the set of nodes in the concrete domain,Νi(x)is the standard Lagrangian shape function associated with the ith node,Tiis the nodal temperature variable, andTappx(x)is the approximation of temperature at positionx.As aforementioned, refined meshes are required in the conventional FEM to obtain a precise thermal field. In order to avoid the cumbersome meshing job, we propose to approximate the temperature field by XFEM, with which the approximation space is extended to high dimensions. The temperature can then be expressed as follows:(7)Tappx=∑i=1i∈S∑j=1miφiΨijT˜ij=∑i=1i∈S∑j=1miϕijT˜ij.whereT˜ijis the enriched degrees of freedom (dof),iis the node number,miis the dimension of the local approximation space,φis the partition of unity function,Ψijis the function of j-th dimension approximation space on node i, andTijis the enriched nodal temperature variable. For convenience, the Lagrangian shape function N is used as the partition of unity function.ΝiΨijis called the enriched shape function, which should be carefully constructed based on the distribution properties of the field. Here we denote the product asϕ.For XFEM, the meshes do not have to conform to the cooling pipes. The pipe can be located anywhere inside the enriched element, provided that the pipe position is given. This only affects the expression of the enriched shape functionΝΨ. Thus mesh generation in XFEM can be a lot easier without consideration of the strong constraint of the cooling pipes.Metal is a good thermal conductor with high conduction ability. The thickness of the pipe wall embedded in concrete is extremely small (approximately 2mm). Therefore, the thermal resistance of the pipe walls can be completely omitted, which means that the concrete temperature on the metal pipe wall can be directly regarded as the water temperature. This is a typical Dirichlet boundary condition, as indicated in Eq. (2). Generally refined meshes are required in cooling-pipe problem with Dirichlet condition which can be solved by predefining the nodal values on the boundary.With the aim to construct an element without conforming to the pipe, we have to find a way to deal with the Dirichlet condition inside an element which is very difficult to handle in Generalized FEM (GFEM) or XFEM because the prescribed value cannot be directly assigned to the enriched nodes [30–32]. We propose to convert the Dirichlet condition into Robin boundary condition, which is also known as the third type boundary condition.For the concrete located near the pipe wall at radiusr, the radial flux rate of heat transfer can be expressed asq̇=λ(dT/dr). The heat flux of the whole circle can be obtained byQ̇=2πrq̇. Then the flux of a narrow concrete annulus encircling the pipe wall with an inner radius ofr0and an outer radius ofr0+Δr( as shown inFig. 2) can be expressed as follows by integrating the flux through the whole annulus,(8)∫r0r0+ΔrQ̇1rdr=∫r0r0+Δr2πλdT.(9)q̇=Q̇2πr0=λ(Tc−Tw)r0ln[(r0+Δr)/r0].wherer0is the pipe radius,Tcis the concrete temperature at the position of radiusr0+Δr, andTwis the temperature on the pipe wall, which is equal to the water temperature.Compared with the formula of Robin boundary condition,q̇=β(∂T/∂n), Eq. (9) can be regarded as a Robin condition withβdenoted as follows:(10)β=λr0ln[(r0+Δr)/r0].Given the above convection parameter, the boundary condition onΓp[i.e., Eq. (2)] is equivalent to the boundary condition onΓβ, and it can be expressed as follows:(11)∂T∂n=β[T−Tw(τ)]onΓβ,whereΓβis the concrete circle with an radius ofr0+Δrsharing the same center of the cooling pipe.Applying the approximation of Eq. (7), as well as the variation rule, the governing equation of the problem [Eqs. (1) and (10)] considering the internal heat source can be written as follows:(12)HT(τ)+PṪ(τ)+Q(τ)=0,where(13)H=∑e∈ΩKe+∑e∈ΓβKpe.(14)P=∑e∈ΩMe.(15)Q=∑e∈ΩFθ+∑e∈ΓβFp.The matrix of the above can be expressed as follows,(16)Ke=∫Ωe(∇ϕ)λ(∇ϕ)TdΩ,(17)Kpe=∫Γβ(ϕ)β(ϕ)TdΓ.(18)Me=∫Ωeρc(ϕ)(ϕ)TdΩ.(19)Fθ=∫Ωeρc(ϕ)∂θ∂τdΩ.(20)Fp=∫Γβρc(ϕ)βTwdΓ.An implicit backward-Euler time-integration scheme (ξ=1) is applied for the temporal discretization of Eq. (12), resulting in(21)(H+1ΔτP)T(τ)+(−1ΔτP)T(τ−Δτ)+F(τ)=0.As shown by Eq. (21), the thermal field of any time can be deduced incrementally from the initial temperature field which is given by Eq. (5).An important issue in the construction of the enriched element is to select appropriate enrichment shape function, which is denoted asΨin Eq. (7). In this study, the enrichment is built from the analytical solution of an idealized problem.In this section, the analytical solution of a 2D heat transfer problem in a hollow cylinder is derived (seeFig. 3). The outer radius of the cylinder,rb, can be considered as half the spatial distance between two neighboring cooling pipes. The inner radiusr0can be considered as the radius of the cooling pipe. The initial temperature of the cylinder is uniformlyT0and the temperature on the inner circle is constantlyTw. The governing equation of the problem can be written in the following equation set:(22){∂θ∂τ=λρc(∂2θ∂r2+1r∂θ∂r),r0<r<rb,τ>0B.C.θ=0,r=r0B.C.∂θ∂r=0,r=rbI.C.θ=θ0,r0≤r≤rb,τ=0.where(23){θ=T−Twθ0=T0−Tw.The temperature excessθis introduced here to make the problem homogeneous, which is convenient in obtaining an analytical solution.Using the method of separation of variables, the problem can be solved through the following equations (Details of the solution procedure are provided in Appendix A.(24)θ(r,ε)=θ0∑i=1∞CiRi(r)e−ε(kirb)2.where(25)ε=λτρcrb2.(26)Ci=2r0rbkirbRi′(r0)rb2[Ri(rb)]2−r02[Ri′(r0)]2.(27)Ri(r)=Y0(kir0)J0(kir)−J0(kir0)Y0(kir).In the above equations,kiis the i-th root of the following characteristic equation,(28)J0(kr0)Y1(krb)−Y0(kr0)J1(krb)=0.In the above equations,J0,J1are the zero-order and first-order Bessel functions of the first kind respectively, andY0,Y1are the zero-order and first-order Bessel functions of the second kind respectively.As deduced above, the analytical solution of the problem is an infinite series which is difficult to adopt in practical calculation. Based on the previous calculation experience, we know that the exponential term in Eq. (24) decays obviously with ki. Thus only the first term in Eq. (24) is taken into account in the analytical solution, as shown by Eq. (29),(29)θ[1](r,ε)=θ0C1R1(r)e−ε(k1rb)2.For a specified characteristic time factorε, the error betweenθ[1]andθis estimated by the following expression:(30)error(ε)=1num∑j=1num|θ[1](jrb−r0num+r0,ε)−θ(jrb−r0num+r0,ε)|θ(jrb−r0num+r0,ε).wherenumis the total number of discretization points along the radius betweenr0andrb. To investigate the feasibility of using only the first term rather than the full series, numerical experiments are conducted with different combinations ofεandrb/r0. The area is divided into 100 parts, i.e.,n=100, in each experiment. The errors are shown inTable 1.It can be seen from Table 1 that the relative error is less than 1% whenεis larger than 0.12. It means that during the time phaseε≥0.12, the full seriesθcan be reasonably replaced by only the first termθ[1]. In thermodynamics, we call such time as a regular regime. Takingrb/r0=100as an example, the comparison of the temperature profiles ofθandθ[1]at differentεis shown inFig. 4, where the two appear to be nearly the same in the regular regime.The practical duration corresponding to the regular regime (ε=0.12) in a typical pipe-cooling concrete application case is calculated by Eq. (25). In the calculationλ=10.0kJ/(mh°C),ρ=2500kg/m3,c=1.0kJ/(kg°C),rb=0.75m, andrb/r0=100. We can see from the calculation results thatε=0.12is equivalent toτ=16.875hin this situation. This duration is extremely short in the construction stage of concrete engineering, as some construction stages would last years long. For most thermal simulations of massive concrete, the time increment is usually set to be one day or even longer. Thus, it is appropriate to apply the regular regime form of the solution numerically in such concrete cooling problems.From the regular regime form of the analytical solutionθ[1](r,ε), we find that the temperature ratio of two arbitrary position is independent on the reduced time parameterε, as shown in the following equation:(31)θ[1](r1,ε)θ[1](r2,ε)=R1(r1)R1(r2)=Y0(k1r0)J0(k1r1)−J0(k1r0)Y0(k1r1)Y0(k1r0)J0(k1r2)−J0(k1r0)Y0(k1r2).wherer1andr2are two arbitrary radii insiderb. Thus the time factor is no longer needed to be considered, providing a simple way to mimic the curvilinear field near the pipe. For a specific time, the temperature at the position wherer=rbis used as a reference, as shown inFig. 5. The temperature difference between each position and the reference temperature is employed to describe the field, as shown in the following equation:(32)f(r)=θ[1](r,ε)−θ[1](rb,ε)θ[1](rb,ε)=Y0(k1r0)J0(k1r)−J0(k1r0)Y0(k1r)Y0(k1r0)J0(k1rb)−J0(k1r0)Y0(k1rb)−1.Thus the enrichment shape functionΨijis established as follows:(33)Ψ=span{1,f(r)}.whereris the radial distance in the polar coordinate system with the cooling pipe as the origin. In finite element analysis,rshould be transformed into the global rectangular system X−Y or X−Y−Z as shown inFig. 6, where the radius can be expressed as follows:(34)r=||x−xO||.wherexis the position in the global coordinate system, andxOis the position of the pipe center.Fig. 7 presents the shape of the enrichment functionf(r)in a quad element with the pipe at the center. It can be seen that the enrichment shape function distributes nonlinearly over the element, with a rapid variation near the pipe.The enrichment is built from the regular form (Eq. (32)) of the solution of the idealized problem (Eq. (22)). However, the application of the Bessel functions can consume a lot of computation time and cannot be implemented easily in programming. So here we propose to approximate the enrichment by elementary mathematical functions.After many trials, the exponential formula is chosen for its good performance in approximation to Eq. (32), which can be expressed as follows:(35)f(r)=−e−b(r/rb).where b is the parameter determined by the characteristic ratio ofrb/r0.Table 2 shows the value of b calibrated for reference.Fig. 8 shows the comparison of the results between the proposed exponential enrichment and the regular form of the solutions, takingrb/r0=100as an example. In addition to the advantage of the exponential form that it can effectively approximate the analytical solution, another advantage is that the differential and integral calculus is very easy to implement in programming, providing a lot of convenience in programming when shaping the stiffness matrix as abovementioned in Eq. (16).With the introduction of enrichment, the cooling pipe can be located inside the element, and an inherent weak discontinuity is thus generated in the shape function over the whole element. The standard Gauss quadrature scheme should be modified to satisfy the feature of the discontinuous gradient field. The idea of sub-domain integration [33,34] is employed to solve the problem. As an example, an enriched quadratic element is divided into 4 triangles by connecting the pipe center with four nodes. Each triangle is integrated as a standard triangular element and summed up to the stiffness matrix of the quadratic element.Fig. 9 shows a typical layout of subdomain integration points by Hammer quadrature rule which is used in the integration for triangular elements [35]. The weight of each integration pointWintQuadshould be revised as follows,(36)WintQuad=WintTriSTriSQuad.whereWintTriis the weight of Hammer quadrature rule,STriis the area of the triangle where the point is located, andSQuadis the area of the whole quadratic element.The accuracy of the XFEM is verified by comparing the XFEM results with conventional FEM results of four numerical cases.The first verification case is a concrete square 1.5m in side length cooled by one cooling pipe 0.0084m in radius embedded at its center.Table 3 shows the material properties of the concrete. For conventional FEM modeling, the square is represented by conforming meshes as shown inFig. 10. For XFEM modeling, the square is represented by one XFEM-enriched element as shown inFig. 11.The initial temperature of the concrete square is uniformly 20°C. The water temperature inside the cooling pipe is maintained constant at 4°C during the whole cooling process of 100 days (Tw=4°C). The boundary edges of the concrete square are supposed to be adiabatic. The time step of each increment is 1d. Hydration heat is not considered in this case.Temperature data on five nodes in the refined meshes denoted as points 1−5 in Fig. 10 are selected to make comparisons with the XFEM model, in which the temperature data are interpolated by the enriched shape function. The temperature results of the five points with respect to the time obtained from both models are presented inFig. 12.Table 4 provides the correlation coefficients at the five different points.It can be seen from Fig. 12(a) − (e) that,•The XFEM results of point 1−5 have good agreements with the conventional FEM results with refined conforming meshes respectively, thereby illustrating the validity of the proposed method.In the enriched element, the temperature gradient near the cooling pipe can be correctly calculated by the proposed interpolation function. Two degrees of freedom (dofs) on each node can sufficiently express the curvilinear field inside the element.The accuracy at the initial time of the calculation is not as satisfactory as that at later time. Here, we assume that the following three reasons might be included in this situation: (a) The difference between the first-term of the series and the full series is larger at early time than later time, which can be found in Fig. 4. (b) The backward-difference scheme [25] which is used for time-dependent interpolation is not accurate enough because the temperature varies fiercely at the beginning of the cooling process. c. Initially, the enriched temperature freedom is set to zero, whereas the conventional freedom is set to T0. More studies need to done to find out which is the exact reason.The second verification case is similar to the first case, except for the cooling water temperature (Tw) which in this case is not constant during the whole cooling process. Twis maintained at 10°C in the first 50 days, and then 4°C in the remaining 50 days.Fig. 13 shows the comparison of the temperature of points 1, 3 and 5 obtained from the XFEM model and the refined conventional FEM model. It can be seen from Fig. 13 that the temperature curve has an obvious turning point when the cooling boundary is changed. It can also be seen from Fig. 13 that the XFEM result has a good agreement with the conventional FEM results with refined conforming meshes, which verifies the reliability of the proposed method in the case of a changing cooling boundary.The third verification case is similar to the first case except that the hydration heat in the concrete is considered. In this case a time-dependent internal heat source is distributed uniformly in the concrete and the adiabatic temperature rise is expressed by an exponential form mentioned in Eq. (4) with parametersχ0=20°Candm=0.1. Changes of the cooling water temperature with time are shown inTable 5.Fig. 14 shows the comparison of the temperature of point 2 and point 4 obtained from the XFEM model and the refined conventional FEM model. It can be seen from Fig. 14 that the concrete temperature is effectively controlled and cooled by pipe-cooling. The early-age hydration releases heat quickly, causing the temperature rise in the concrete even with the cooling boundary. It can also be seen from Fig. 14 that the XFEM results agree well with the conventional FEM results with refined conforming meshes. It verifies the reliability of the proposed enriched finite element in the case of internal heat source.In this case the pipes are distributed in 7×7 grids. The outer boundary of the problem is adiabatic. The time step of each increment is 1d. The vertical and horizontal spacing between each two adjacent pipes is 1.5m. The water temperature in each pipe is different, which is given by the following equation,(37)Tw(x,y,τ)=(16−0.1τ)+0.1(y−0.751.5)2+0.1(x−0.751.5).wherex,yare the coordinates of the pipe center, andτis the time. The internal heat source is uniformly distributed in the whole concrete region with exponential parametersχ0=20°Candm=0.1in Eq. (4).Fig. 15(a) illustrates the refined conforming FE meshes with totally 6728 nodes and 6272 elements. Fig. 15(b) shows the non-conforming meshes used in the XFEM model, which is a simple 7×7 grid. All the pipes are numbered as shown in Fig. 15(b).Fig. 16 shows the comparison between the conventional FEM results and the XFEM results at three typical points. It can be seen from Fig. 16 that the proposed XFEM can yield results similar to that of the conventional FEM. Results with sufficient accuracy can be obtained by XFEM with no need of generating refined conforming meshes.From the previous four numerical tests, it is convincing that accurate results with coarse meshes can be obtained with the proposed XFEM. There are two temperature dofs on each node in the enriched element, which means that there are 8 dofs in total in one enriched element. The proposed method has an apparent speed advantage in solving the linear equation set compared with the conventional FEM model with refined meshes, which have a total of 152 dofs. Although more time is needed because more Gauss points are required for the proposed enriched element to shape the element׳s stiffness matrix, the shaping process of different elements is adaptable for parallel computing. Given enough degrees of parallelism, the proposed method should have speed advantage for solving large-scale problem.The proposed idea and method not only can be applied in concrete cooling with pipes, but also can potentially be employed in many similar engineering cases, such as numerical modeling of localized laser heating [35,36], ground source heat pump [37,38] and metal welding [39,40].In this study, only the 2D problem is discussed because the temperature mainly varies on the cross section normal to the pipe axis. The method could also be applied in 3D analysis by extending the shape function along the pipe axis, which will be studied in the future.The shape function in XFEM is modified from its traditional form in the conventional FEM, causing difficulty in plotting the contours through the standard post-processing software packages. At present the problem is solved by dividing one enriched element into several sub-elements and delivering them into the post-processing software separately. The dividing scheme and advanced post-processing techniques are still under study, and the results might be available in our future papers.

@&#CONCLUSIONS@&#
In this study, XFEM was implemented to calculate the discontinuous gradient thermal field in concrete with cooling pipe. The enriched shape function was modified based on the analytical solution. In addition, the boundary condition and numerical integration scheme were discussed in this paper. The refined conforming meshes are not required in the proposed method, thus making modeling and equation solving more convenient. Comparing XFEM results of four typical cases (constant cooling boundary, varying cooling boundary, internal heat source and multiple pipe condition) with conventional FEM results with refined conforming meshes, good agreements are observed between the two methods, indicating that XFEM has good accuracy and reliability compared with the conventional FEM.