@&#MAIN-TITLE@&#
Simultaneous confidence intervals for ratios of means of several lognormal distributions: A parametric bootstrap approach

@&#HIGHLIGHTS@&#
We present parametric bootstrap (PB) simultaneous confidence intervals.Our PB procedure is different from a previous PB procedure which performs poorly.Using simulation, we compare the PB procedure with three other procedures.The coverage probability of the PB method is close to the nominal confidence level.The PB procedure consistently outperforms other procedures.

@&#KEYPHRASES@&#
Nuisance parameters,Monte Carlo methods,Coverage probability,Generalized pivotal quantity,Fiducial generalized pivotal quantity,Simulation,

@&#ABSTRACT@&#
For constructing simultaneous confidence intervals for the ratios of means of several lognormal distributions, we propose a new parametric bootstrap method, which is different from an inaccurate parametric bootstrap method previously considered in the literature. Our proposed method is conceptually simpler than other proposed methods, which are based on the concepts of generalized pivotal quantities and fiducial generalized pivotal quantities. Also, our extensive simulation results indicate that our proposed method consistently performs better than other methods: its coverage probability is close to the nominal confidence level and the resulting intervals are typically shorter than the intervals produced by other methods.

@&#INTRODUCTION@&#
The lognormal distribution is widely used for analyzing positive right-skewed data; see, e.g., Oldham (1953), Koch (1966), Zhou et al. (1997), Lacey et al. (1997), Julius and Debarnot (2000), and Shen et al. (2006). We use the notationX∼LN(μ,σ2)to denote the lognormal distribution with parametersμandσ2; i.e.Y=ln(X)∼N(μ,σ2). The main parameter of interest is usually the mean:E(X)=exp(μ+σ22).Suppose that random samples are taken fromklognormal distributions,LN(μi,σi2),i=1,…,k. Letmi=exp(μi+σi2/2)denote the mean of thei-th sample, and letηi=ln(mi)=μi+σi2/2.We consider the problem of constructing simultaneous confidence intervals (SCIs) for the ratios of the meansmi/mj(i≠j)or, equivalently, forηi−ηj,i,j=1,…,k(i≠j), when theσi2are possibly unequal. This problem arises in the context of multiple comparisons of several treatments when the response variable is positive and has a right-skewed distribution, as is often the case in biological or medical studies; for example in bioequivalence studies for comparing several drug formulations; see Hannig et al. (2006) and Schaarschmidt (2013).Inferences about the mean of a lognormal distribution, based on a single random sample, have been considered by Land (1971, 1972, 1973, 1975, 1988), Angus (1994), Zhou et al. (1997), and Krishnamoorthy and Mathew (2003). The problem of comparing two lognormal means(k=2)was considered by Zhou et al. (1997), Zhou and Tu (2000), Krishnamoorthy and Mathew (2003), and Chen and Zhou (2006). Li (2009) proposed a procedure for testing the equality of several lognormal means. For constructing SCI for the ratios of means, Hannig et al. (2006) proposed a procedure based on fiducial generalized pivotal quantities (FGPQ) and Schaarschmidt (2013) proposed two procedures based on generalized pivotal quantities (GPQ).In this paper, we propose a parametric bootstrap (PB) approach for constructing SCI for the ratios of means. The PB approach has been successfully used in other contexts (mainly testing problems) involving nuisance parameters; see, e.g., Krishnamoorthy et al. (2007), Ma and Tian (2009), Tian et al. (2009), Krishnamoorthy and Lu (2010), Li et al. (2011), Xu et al. (2013), and Sadooghi-Alvandi and Jafari (2013). In fact Zhou and Tu (2000) and Chen and Zhou (2006) considered a PB procedure for constructing confidence intervals for the ratio of the means of two lognormal distributions(k=2), but their proposed confidence intervals perform rather poorly. In view of this, the PB approach has not been considered for thek-sample problem: as Schaarschmidt (2013, p. 269) commented regarding the PB approach: “The simulation results of Chen and Zhou (2006) do not motivate to consider this approach any further”. Our proposed PB procedure, however, is different from the PB procedure considered by Chen and Zhou (2006) and is more accurate. In fact, our extensive simulation results indicate that it performs better than other methods: its coverage probability is close to the nominal confidence level and the resulting intervals are typically shorter than the intervals produced by other methods.Our proposed PB procedure is presented in Section  2 and our simulation results are presented in Section  3. In our simulations, we first compare our PB procedure with the PB procedure considered by Zhou and Tu (2000) and Chen and Zhou (2006) for the casek=2. We then consider the casek≥3and compare our proposed PB procedure with the procedures proposed by Hannig et al. (2006) and Schaarschmidt (2013). Our simulation results indicate that our proposed PB procedure consistently performs better than these procedures.LetXi1,…,Xinidenote a random sample of sizenifrom the lognormal distributionLN(μi,σi2),i=1,…,kand let(2.1)ηi=μi+σi22.We shall be interested in constructing SCI for(ηi−ηj),i,j=1,…,k(i≠j). LetYij=ln(Xij),Ȳi=1ni∑j=1niYij,Si2=1ni−1∑j=1ni(Yij−Ȳi)2,i=1,…,k.It is well known thatȲiandSi2are independent and(2.2)Ȳi∼N(μi,σi2ni),(ni−1)Si2σi2∼χ(ni−1)2,i=1,…,k(whereχr2denotes a chi-square distribution withrdegrees of freedom). The natural (unbiased) estimator ofηiisηˆi=Ȳi+Si22,i=1,…,k.Note that(2.3)V ar(ηˆi−ηˆj)=σi2ni+σi42(ni−1)+σj2nj+σj42(nj−1),i≠jand an unbiased estimator of (2.3) isVij=Si2ni+Si42(ni+1)+Sj2nj+Sj42(nj+1);cf. Hannig et al. (2006, Eq. (2)). We propose to base SCI for(ηi−ηj),i,j=1,…,k(i≠j)on the random quantity(2.4)T=maxi≠j|(ηˆi−ηˆj)−(ηi−ηj)Vij|and to approximate the distribution ofTusing a parametric bootstrap approach. Ifqαdenotes the approximate(1−α)-th quantile of the distribution ofT, then approximate100(1−α)%SCIs forηi−ηj(i≠j)are(2.5)(ηi−ηj)∈(ηˆi−ηˆj)±qαVij,i,j=1,…,k(i≠j).Note that the distribution ofT(and therefore the value ofqα) depends on the nuisance parametersσi2. But it is important to note that the distribution ofTdoes not depend on the values ofμi. Therefore, when finding the distribution ofT, we can takeμi=0, for alli. This point is the main difference between our proposed PB method and the PB method considered by Zhou and Tu (2000) and Chen and Zhou (2006, Section 2.2) whenk=2. (They generate samples fromLN(μˆi,σˆi2), whereas we generate samples fromLN(0,σˆi2).) As expected, this greatly improves the accuracy of the PB method; as will be illustrated in Section  3.Parametric bootstrap SCI (PBSCI). Letsi2denote the observed value ofSi2,i=1,…,k. The PB distribution ofTis obtained by finding its sampling distribution when the values of the nuisance parametersσi2are replaced with the observed values of their estimatessi2(and the values ofμiare set to zero). From (2.2) it follows that the PB pivotal variable corresponding toTis(2.6)TB=maxi≠j|ȲiB−ȲjB+12(Si2B−Sj2B)−12(si2−sj2)VijB|,where(2.7)ȲiB∼siniN(0,1)andSi2B∼si2ni−1χ(ni−1)2,i=1,…,k,andVijB=Si2Bni+(Si2B)22(ni+1)+Sj2Bnj+(Sj2B)22(nj+1).Then the distribution ofTBprovides the PB approximation to the distribution ofTand100(1−α)%PBSCIs are(2.8)(ηi−ηj)∈(ηˆi−ηˆj)±qαBVij,i,j=1,…,k(i≠j),whereqαBdenotes the(1−α)-th quantile of the distribution ofTB.Computational procedure. The value ofqαBcan be estimated using Monte Carlo methods as follows:(i)Calculate the values ofsi2, the observed value ofSi2,i=1,…,k, from the data.GenerateȲiB∼siniN(0,1)andSi2B∼Si2ni−1χni−12,i=1,…,k, and calculate the value ofTB, as given by (2.6).Repeat step (ii) a large number of times,M, and from theseMvalues, obtain the empirical distribution ofTBand its(1−α)-th quantile as an estimate ofqαB.Comparing several treatments with a control. Suppose that thek-th sample corresponds to a control group. Then SCI for(ηi−ηk),i=1,…,k−1may be based on the random quantityTC=maxi=1,…,k−1|(ηˆi−ηˆk)−(ηi−ηk)Vik|whose distribution may be approximated using a parametric bootstrap approach: LetTCB=maxi=1,…,k−1|ȲiB−ȲkB+12(Si2B−Sk2B)−12(si2−sk2)VikB|whereȲiB,Si2B, andVikBare as defined in (2.7). Then the distribution ofTCBprovides the PB approximation to the distribution ofTCand the quantiles of the distribution ofTCBcan be estimated using Monte Carlo methods, similar to the computational procedure described above.In this section we report the results of our simulation studies, regarding the performance of our proposed PB procedure compared with other procedures. We first considered the casek=2and compared our proposed PB procedure with the PB procedure considered by Zhou and Tu (2000) and Chen and Zhou (2006). The simulation results confirm that our proposed PB procedure is more accurate, and its coverage probability is close to the nominal level. We then considered the casek≥3and compared our proposed PB procedure with the procedures proposed by Hannig et al. (2006) and Schaarschmidt (2013). The procedure proposed by Hannig et al. (2006), which is based on the concept of fiducial generalized pivotal quantities, will be denoted by FGPQ. Schaarschmidt (2013) actually presented four methods, based on generalized pivotal quantities, but recommended two of his methods, which he referred to as GPQ and GPQB. So his procedures will be denoted by GPQ and GPQB. (The “B” in GPQB stands for Bonferroni adjustment.) To assess the performance of each procedure, we calculated the empirical coverage probability as well the average length of the confidence interval, whenk=2, or the average volume of the confidence region (the product of the lengths of confidence intervals), whenk≥3.Note that all the procedures considered in this paper require using Monte Carlo methods to evaluate the appropriate “critical value” (for example the value ofqαBfor our proposed PB method—see the computational procedure of Section  2). In our simulations, these “critical values” were calculated usingM=100,000Monte Carlo samples, for all methods. Also, our simulations were based onN=10,000“runs” (the number of independently generated data sets). More specifically, we used the following procedure to estimate the true coverage probabilities (similarly for average length or average volume):I-GenerateYi1,…,YinifromN(μi,σi2),i=1,…,k, and calculate the observed values ofȳiandsi2.For each method, calculate the “critical value” (e.g., the value ofqαB), usingM=100,000Monte Carlo samples.For each method, construct SCIs and record whether or not all the values ofηi−ηj(i≠j)fall in their corresponding confidence intervals.Repeat steps I–IIIN=10,000times. Then, for each method, the fraction of times that allηi−ηj(i≠j)are in their corresponding SCIs provides an estimate of the true coverage probability.Note that the simulations in Schaarschmidt (2013) are based onM=10,000,N=10,000and the simulations in Hannig et al. (2006) are based onM=10,000,N=5000.Simulation results I. We first considered the casek=2and compared our proposed PB procedure with the PB procedure considered by Zhou and Tu (2000) and Chen and Zhou (2006), which is denoted by ZT–CZ PB in Table 3.1. For the configurations considered in Chen and Zhou (2006), we calculated the coverage probability (CP) and the average length (AL) of the intervals obtained by these procedures. For completeness, in our simulations we also included the GPQB and FGPQ procedures. Note that fork=2the GPQB procedure is the same as the GP procedure of Krishnamoorthy and Mathew (2003). The results, given in Table 3.1, show that the ZT–CZ PB procedure can be very inaccurate (the actual coverage probability can be as low as 80%); whereas the coverage probability of our proposed PB procedure is very close to the nominal level. (Note that since the coverage probability of the ZT–CZ PB procedure is unreliable, its average length is irrelevant.) As compared with GPQB and FGPQ procedures, our proposed PB intervals were always shorter (in each one of the 10,000 runs), as reflected in the average lengths.Simulation results II. In this simulation study, we compared the performance of the four procedures for the configurations considered by Hannig et al. (2006) fork=3. In their simulations, they setμi=0, alli, since the performance of their method does not depend on the values ofμi. (This property also holds for our PB method, but not for the methods of Schaarschmidt, 2013.) For the values ofσi2, they considered two cases:(σ12,σ22,σ32)=(0.01,0.04,0.08)and(σ12,σ22,σ32)=(1,2,4). The simulation results are given in Table 3.2. It is seen that the coverage probability of the PB procedure is close to the nominal level, and the resulting confidence intervals are typically shorter than the intervals produced by the other three methods (as reflected in the average volume). Note that the PB intervals can be much shorter than the intervals produced by the other methods, depending on the values ofσi2. For example, when(n1,n2,n3)=(5,5,25)and(σ12,σ22,σ32)=(1,2,4), the average volumes of the other procedures are around eight times the average volume of the PB procedure (the ratios of average volumes are 8.9,7.8, and 14.9), which means that the lengths of the corresponding intervals are around double the lengths of the PB intervals. Therefore, since the values ofσi2are unknown in practice, there is always the possibility that the other procedures can perform poorly compared to the PB procedure. Note also that the standard errors for the PB procedure are smaller than the standard errors for the other three methods; so the PB procedure is also more stable than the other procedures.Simulation results III. In this simulation study, we compared the performance of the four procedures for the configurations considered by Schaarschmidt (2013), fork=4. The simulation results are presented in Table 3.3. Again, the PB procedure performs consistently better than the other three procedures and, by comparing the average volumes, it is seen that the PB intervals can be much shorter (depending on the values ofσi2). Also, the PB procedure is more stable.RemarkIn Tables 3.1–3.3, we have given the average length/volume of the intervals produced by the four procedures. In fact in our simulations the length/volume of PB intervals was almost always smaller than the length/volume of FGPQ, GPQ, and GPQB intervals (i.e., the PB method had the smallest length/volume in almost all the 10,000 runs). The only exceptions were (i) when the three sample sizes were all equal to 125 and(σ12,σ22,σ32)=(0.01,0.04,0.08); in which case the PB method had the smallest volume in 99.8% of the runs and (ii) when the four sample sizes were all equal to 40 and(σ12,σ22,σ32,σ42)=(0.2,0.2,0.2,0.2); in which case the PB method had the smallest volume in 98.2% of the runs. So, unless all the sample sizes are very large, we are confident that the PB procedure produces shorter intervals than the other three procedures.In this section, we consider an example previously considered by Schaarschmidt (2013). The data, originally given by Hand et al. (1994), consist of 57 observations of nitrogen bound bovine serum albumin ink=3groups of mice: normal mice (group 1), alloxan-induced diabetic mice (group 2), and alloxan-induced diabetic mice treated with insulin (group 3), withn1=20,n2=18,n3=19. The original data were right skewed and Schaarschmidt (2013) showed that the data are consistent with the assumption of log-normality. A summary of the data is given in Table 4.1.For illustration, 95% simultaneous confidence intervals for the three ratios of means,mi/mj, obtained by using the four methods, are given in Table 4.2. (For each method, the corresponding quantile was computed usingN=1,000,000runs.) However, in this example the main concern is the comparisons of groups 2 and 3 (the treatment groups) with group 1 (the control group)—see Schaarschmidt (2013). Therefore the modified versions of the four methods, for comparing several treatments with a control, should be used (for the modification of the PB method, see Section  2). The results are given in Table 4.3. It is seen in both tables that the PB method produces shorter intervals than the other methods.In this paper, we have proposed a parametric bootstrap method for constructing SCI for the ratios of means of several lognormal distributions. This method is conceptually simpler than other proposed methods, which are based on the concepts of generalized pivotal quantities and fiducial generalized pivotal quantities. Also, our extensive simulation results indicate that our proposed method consistently performs better than other methods: its coverage probability is close to the nominal confidence level and the resulting intervals are typically shorter than the intervals produced by other methods. Therefore, in view of its conceptual simplicity and better performance, our proposed method may be more useful than other methods.

@&#CONCLUSIONS@&#
