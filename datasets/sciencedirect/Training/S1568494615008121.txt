@&#MAIN-TITLE@&#
Neural speed estimator for line-connected induction motor embedded in a digital processor

@&#HIGHLIGHTS@&#
A robust neural-network-method applied to speed estimation in line-connected three-phase induction motors is presented.A comparative study of single and multiple current sensor applied to speed estimation is presented.Proposed method is validated using simulation and experimental results considering unbalance operation conditions and wide range of load torque.Proposed method is embedded in a digital processor and validated in a test bench.

@&#KEYPHRASES@&#
Induction motors,Artificial neural networks,Feedforward neural networks,Multilayer perceptron,Parameter estimation,

@&#ABSTRACT@&#
Estimating the electrical and mechanical parameters involved in three-phase induction motors is frequently employed to avoid measuring every variable in the process. Among mechanical parameters, speed is an important variable: it is involved in control, diagnosis, condition monitoring, and can be measured or estimated by sensorless methods. These technologies offer advantages when compared with direct measurement, such as lower cost or more robust systems. This paper proposes the use of artificial neural networks to estimate rotor speed by using current sensors for balanced and unbalanced voltage sources with a wide mechanical load range in a line-connected induction motor. This paper also presents two case analyses: (i) a single current sensor; and (ii) a multiple currents sensors. Simulation and experimental results are presented to validate the proposed approach. A neural speed estimator embedded in a digital processor is also presented.

@&#INTRODUCTION@&#
Three-phase induction motors (TIMs) are used in many industrial applications such as pumps, fans, machine tools and robotics as a key element in the conversion of electrical into mechanical energy. Several control strategies for these machines are based on electronic drives with sensorless technologies, which is a growing trend in TIM monitoring and control [1].Conventional methods based on direct measurement of machine variables, such as torque and speed, have some disadvantages, in addition to the higher cost involved with the driver implementation. Rotor speed can be measured with optical encoders, electromagnetic resolvers or brushless DC tachogenerators. However, the use of these electromechanical devices is subject to limitations, such as increased driver costs, reduced mechanical robustness, and low noise immunity. They also affect machine inertia and require special attention in hostile environments [2].The use of sensorless techniques is primarily found in induction motor control drives [3–5]. However, induction motor speed is also an important variable to be considered in condition monitoring [6–8] and fault detection [9–11]. The main approaches for speed estimation are open-loop estimators using monitored stator voltage and current, state observers, model reference adaptive systems, and artificial intelligence [2].The conventional numerical methods for speed estimation are based on machine models. In this case, speed can be calculated by using machine model equations which require voltage and current as local machine parameters. Other variables for equation solving are the electrical and mechanical parameters of the machine, e.g., resistances, inductances, and load inertia, which are unavailable in the machine nameplate to feed the equations [12].The disadvantages of this method are: (i) unavailable parameters, such as resistances and inductances in the machine nameplate to feed the equations; (ii) the need to solve machine equations; (iii) most models are linear; and (iv) substantial computing power is required in the application.Condition monitoring is one of the applications of the speed estimators. The work of D’Angelo et al. [11] proposed approach is related to the enhanced resilience of the new motor failure detection procedure against false alarms, combined with a good sensitivity that allows the detection of rather small fault signals. The proposed system monitors the instantaneous values of the motor currents ias, ibs, icsand the rotor speed ω[11]. Furthermore, control drives plays also an important role of intelligent speed estimation. For example, the work of paper [5] proposed an open-loop neuro-fuzzy speed estimator with an innovative development. The ANFIS package of the Matlab/Simulink software was used to train and check the estimator response using the hybrid learning training algorithm and the subtractive clustering to generate the fuzzy inference system [5].More recently, the work presented in [13] proposed a method based on a complex continuous wavelet transform using a complex shifted Morlet wavelet to estimate the instantaneous rotation speed of electrical machinery. Also, as an alternative method, reference [14] used an approach to evaluate instantaneous speed of electrical machines by using the information from the time–frequency distribution of a vibration signal.Artificial neural networks (ANNs) have been presented as an alternative strategy to state observers for estimating the speed of rotating machinery. The work in [15] presents a speed estimator based on an adaptive linear element (ADALINE) network. The inputs of the proposed structure are the voltages and currents in the abc axis. A neural speed estimator of a TIM using a multilayer perceptron (MLP) is presented in [16]. The inputs in this estimator are data from the current and stator voltages in three-phase synchronous axis coordinate dq0. More recently, the authors of [3] proposed an alternative methodology, based on artificial neural networks, for estimating the speed of a TIM driven by a voltage source inverter with space vector modulation under the scalar control strategy.Line connected induction motors can use simple drive systems such as delta-wye connection. However, it is expected that the speed reaches between 90% and 95% of its rated speed for switching from wye to delta position in TIM. In Ref. [17] the authors mentioned that, depending on the application, the drive can go from a star connection to delta with 50% of rated speed. Thus there is a need to measure – or estimate – the TIM speed in order to determine the exact instant (or approximate) key switch.The main objective of this paper is to introduce an efficient neural approach for estimating speed in line-connected induction motors by using the current root mean square value under balanced and unbalanced voltage sources, with different mechanical load conditions. The computational simplicity and robustness to the variation of power parameters and load change in the shaft are very important issues in estimating speed. The currents are the ANN inputs, while the rotor speed is the estimated output. The use of the primary variables of the induction motor as input signals is one of the differential aspects of this speed estimation approach. The currents are relatively simple to measure, requiring a current transducer and its signal conditioning. In this work two cases are analyzed: (i) with a single current sensor; and (ii) with three current sensors. The best performance neural network is embedded in a digital processor.The proposed method, which considers unbalanced voltages and different kinds of loads applied to the induction motor, is based on offline training of the ANN. The currents are quite simple to measure from the data acquisition driver, and the processing cost of the monitoring system is reduced to simple matrix solving after the neural network is trained.ANNs have been used to solve engineering problems [1,3,6,9,16,18,19] and have the following advantages: (i) after training, an ANN is reduced to a weight matrix processing and some sigmoid function operations; (ii) matrix solving requires less computing effort compared to equation solving for a conventional speed estimator; (iii) machine parameters are represented by the network weights; and (iv) the portability of the solution means less expensive hardware.Recently, several neural network-based methods applied to induction motor-related problems have also provided effective results. An ANN is a processor with broad parallel-distribution and a natural propensity for storing experimental knowledge and making it available for use. The main advantage of an ANN used in this study is its ability to approximate nonlinear functional relationships.This paper is organized into five sections. The modeling aspects of the TIM are presented Section 2. Section 3 explains the methodology used in TIM speed estimation. Sections 3.1 and 3.2 discuss simulation and experimental results, while the conclusions appear in Section 4.The first step involved in the design of an ANN is to compile a set of input–output patterns to adjust its internal parameters. This procedure is also known as the training process, wherein the network must be exposed to sequences of patterns which represent the desired behavior of the analyzed system.For the purpose of generating the training patterns for the speed estimation system, various simulations are carried out using Matlab/Simulink software. The induction motor model used in the simulations is developed by [20], and is accepted and used by many researchers as a model which closely resembles real motor variables [20,21]. This model takes into account various aspects involved in motor electromechanical dynamics, which enable its behavior from transient to steady-state to be simulated in several operating configurations. The mathematical modeling of this complex machine is initially based on the stator voltage and rotor voltage equations. The equations related to the stator voltages are given by:(1)Vas=iasrs+dλasdt(2)Vbs=ibsrs+dλbsdt(3)Vcs=icsrs+dλcsdtwhere Vas, Vbs, Vcsare three-phase voltages of the stator in Volt (V); ias, ibs, icsare three-phase currents of the stator in Ampere (A); λas, λbs, λcsare three-phase fluxes of the stator in Weber (Wb); and rsis the stator resistance. In relation to the rotor, the voltage equations are provided by:(4)Var=iarrr+dλardt(5)Vbr=ibrrr+dλbrdt(6)Vcr=icrrr+dλcrdtwhere Var, Vbr, Vcrare three-phase voltages of the rotor in Volt (V); iar, ibr, icrare three-phase currents of the rotor in Ampere (A); λar, λbr, λcrare three-phase fluxes of the rotor in Weber (Wb); and rris the rotor resistance. The joint flux equations between the rotor and stator windings appear in the following matrix:(7)λsabcλrabc=LssabcLsrabcLrsabcLrrabc⋅isabcirabcwhere(8)λsabc=[λasλbsλcs]T(9)λrabc=[λarλbrλcr]T(10)isabc=[iasibsics]T(11)irabc=[iaribricr]TThe partitioned matrices of mutual inductances and self-inductances related to the induction machine are described by the following equations:(12)Lssabc=Lls+LssLsmLsmLsmLls+LssLsmLsmLsmLls+Lss(13)Lrrabc=Llr+LrrLrmLrmLrmLlr+LrrLrmLrmLrmLlr+Lrr(14)Lrsabc=Lsrabc=cos(θr)cos(θr+ϕ)cos(θr−ϕ)cos(θr−ϕ)cos(θr)cos(θr+ϕ)cos(θr+ϕ)cos(θr−ϕ)cos(θr)(15)Lrsabc=LsrabcTwhere ϕ=2π/3; Llsis the stator dispersion mutual inductance (H); Llris the rotor dispersion mutual inductance (H); Lssis the stator self-inductance (H); Lrris the rotor self-inductance (H); Lsmis the stator mutual inductance (H); Lrmis the rotor mutual inductance (H); Lsris the rotor and stator mutual inductance (H); and Nsand Nrare the number of turns on the rotor and stator windings, respectively. Discarding the core losses, these inductances may be expressed in terms of the number of turns on the rotor and stator windings and the magnetic permeance of the existent air gap between stator and rotor. The relationships among them are given by the following equations:(16)Lss=Ns2Pg(17)Lsm=Ns2Pgcos(ϕ)(18)Lsr=NsNrPg(19)Lrr=Nr2Pg(20)Lrm=Nr2Pgcos(ϕ)Pgis the magnetic permeance. The mathematical modeling of an ideal induction motor is normally represented by six first-order differential equations, with one for each winding. The coupling among them takes place through the mutual inductances of the windings. In one particular case, the coupling between rotor and stator is a function of the rotor position. When the rotor is rotating, this coupling relation also changes.By transforming coordinates, from the abc three-phase system to dq0 coordinates as presented in [20,21]. The differential equations with time-varying inductances are transformed in differential equations with constant inductances. The mechanical dynamics of electromagnetic torque and speed are presented in dq0 coordinates [20,21], as follows:(21)Tem=32p2(λqsids−λdsiqs)(22)Jdωdt=Tem−Tlwhere Temis the electromagnetic torque, Tlis the load torque, p is the poles number of the induction motor, J is the inertial moment, and ω is the angular speed.The coordinate transformation consists of referencing the motor variables (voltage, current and electromagnetic flux) of an original system to another coordinate system, which then becomes the new reference. The foundation of this process is based on the principle of electromagnetic similarity. The possibility of reproducing the machine's magnetic conditions inside its air gap, and the current distribution of the stator and rotor in the coordinate system adopted as the reference, have the same effect in relation to the physical behavior of the original coordinate system. A deeper understanding in relation to the mathematical modeling of the induction motor appears in [20,21].The main nonlinearities during the dynamic behavior of a TIM are the skin effect and core saturation. The skin effect phenomenon is observed in the stator and rotor windings, particularly in those with a squirrel-cage rotor. As it depends on the rotor slip, its influence is maximized during the transient time, when high loads are connected to the TIM shafts. Core saturation is directly related to the current value; when the current exceeds its nominal values the magnetizing curve goes from a linear region to a saturated region.More specifically, this saturation behavior is reproduced by a Matlab/Simulink block using two straight lines. The first line (lower boundary) considers a direct relationship between the motor flux and current (dψ/dt=1), where ψ is the mutual flux and i is the stator RMS current. The second line considers a lower increase in the flux with respect to the current increase, which defines a second region between current and flux, and displays a lower inclination by comparison (dψ/dt<1) [20,22]. The transition between these two regions (non-saturated and saturated) is implemented by an exponential function that smoothes the shift from one region to another, and avoids abrupt discontinuities in ψ(i). When the current exceeds its nominal value, the output flux value of the block simulates the saturation effect [20,22] by decreasing at a constant value. Fig. 1presents the dψ/di approximation used in this work.Accordingly, the implemented saturation block imposes upper and lower boundaries on a signal. When the input signal is within the range specified by the upper and lower limit parameters, the input signal is unchanged. When the input signal is outside these boundaries, the signal is clipped to the upper or lower boundary. Due to the short duration of the simulation, temperature effects were ignored.The schematic diagram representing the input–output configuration used in induction motor simulations is presented in Fig. 2. The model inputs are machine parameters such as voltage, stator and rotor electric parameters, load and rotor moment of inertia, and load torque.Electric current, electromagnetic torque, and rotor speed are the induction motor model outputs. These parameters will be used in the neural network training process. Block f(ω) represents the mathematical expression of load torque (Tl). In this work a linear load was used to simulate a mechanical device coupled in a TIM axis during transient time.The general mathematical model applicable to all three-phase induction motors must be able to reproduce the electromechanical behavior from transient to steady state, since the results will be used in the neural training stage. Table 1presents the induction motor parameters used in this model.The simulation of the proposed model, using Matlab/Simulink, produces sufficient data for the ANN training stage. To train an ANN to estimate motor shaft speed, a mathematical model covering the main characteristics of flux saturation is considered in this work.Artificial neural networks have shown promising results for parameter identification of induction motors such as in Ref. [3]. This section presents the methodology of the ANN training and validation process used for TIM speed estimation. The ANN results are evaluated by combining data from computer simulation and experimental data from a test bench.The machine model, developed in the Matlab/Simulink environment, is used to obtain the data set used in both training and validating the ANN speed estimator. The model is designed to reproduce system behavior, considering that the induction motor is subjected to different operating regimes. The machine parameters are given in Table 1.The simulation data contains a set of thee-phase currents and rotor speed curves in which the mechanical torque is varied from 10% to 150% of the machine rated torque. However, the originally proposed multi-layer perceptron (MLP) ANN requires only a single phase current input to estimate the TIM speed. For treatment of the input data, the curves of the currents generated in the simulations tests take into account only the period in which the motor is in steady state.The training data comprises only the balanced voltage condition, whereas unbalanced voltage is also considered for the validation procedure, which is used to evaluate the ANN robustness for new conditions. The input current vector is normalized as a function of its peak value in each sinusoidal wave cycle. So, data are normalized based on the maxima values of all input and output variables: the root mean square current and speed, respectively.The proposed MLP structure is shown in Fig. 3, and comprises five neurons in the hidden layer and a single neuron in the output layer. The activation function in the hidden layer is the hyperbolic tangent, while the output layer is linear.The results of the proposed ANN estimator in cases of power imbalance and mechanical load variation are shown in Fig. 4. The mean relative error between the estimated speed and the generalization result of the proposed network shows that the proposed network works properly in balanced voltage conditions. The results also show that the proposed ANN estimator works properly in a balanced supply voltage situation. However, with unbalanced voltage the relative error increases up to 30%. The relative error also explains that the method used in industrial environments to estimate speed, based on a single phase current measure, works properly only for balanced voltage conditions, which is typically not the case in production plants.Accordingly, a new ANN structure with three current inputs is proposed in order to avoid major errors when unbalanced voltage is included in a validation data set, and to improve its generalization results under new conditions.

@&#CONCLUSIONS@&#
This paper proposes an embedded system which uses neural networks to estimate the speed of a line-connected three-phase induction motor. The proposed ANN estimator, based on multilayer perceptron and offline training, is able to estimate motor speed in steady state, considering a wide range of load torque and voltage imbalance.The proposed method is (i) trained and validated by simulation data from a non-linear computational model, (ii) validated with experimental data obtained in a test bench and (iii) implemented in a digital processor. Experimental data obtained from a test bench is used to validate the proposed neural speed estimator model for real-time hardware applications. The results obtained show that the neural estimator is feasible for application in a low-cost device for TIM condition monitoring and fault diagnosis. A low error factor (considering a wide range of loads and voltage imbalance) combined with the simplicity of its embedded neural structure, are some of the advantages of the system proposed in this paper.As it only uses current sensors when in operation, the device which has been developed requires no mechanical interventions in order to turn; however, the mechanical coupling could result in changes in the inertia of the machine, higher costs, so special attention must be paid to its operation.The neural estimator is obtained primarily by computer simulation data. The first structure, with a single current sensor, shows a high error factor in generalization results, considering voltage imbalance. Accordingly, a second structure with three current sensors is proposed, where the computational system validation and experimental validation take into account situations encountered in industrial environments. In all cases an RME of less than 1% is reported.The training process first requires a broad range of survey data in order to obtain input and output samples, and hence the application of training algorithms. Once the framework is in place, the code to embed the estimator is developed in the dsPIC, as well as the conditioning boards of the network input and output signals.At the expense of lower computational effort required by the embedded algorithm, the conditioning of the line currents is conducted in analog form. Factors such as noise and ripple influence the response of the system, but not significantly.Finally, the cost of the proposed prototype is considerably less than to acquire a high-resolution optical encoder. As the prototype uses current sensors, there is no need to use a mechanical system in the motor shaft.