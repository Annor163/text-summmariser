@&#MAIN-TITLE@&#
Geometry-based vs. intensity-based medical image registration: A comparative study on 3D CT data

@&#HIGHLIGHTS@&#
A review study comparing conventional intensity-based and geometry-based registration methodologies.Three major registration frameworks were examined: (a) intensity-based, exhaustive registration framework using three distinct cost functions (b) geometry-based registration framework, featuring three geometrical descriptors (c) the original implementation of the Iterative Closest Point algorithm.Use of geometrical feature descriptors for aligning 3D medical data.All compared techniques were applied to CT data pairs with known and unknown initial spatial differences.Geometry-based and intensity-based techniques perform similarly, as far as accuracy is concerned, but geometry-based methods significantly reduce processing time.

@&#KEYPHRASES@&#
Image registration,Geometry-based registration,Geometrical descriptors,Computed Tomography,

@&#ABSTRACT@&#
Spatial alignment of Computed Tomography (CT) data sets is often required in numerous medical applications and it is usually achieved by applying conventional exhaustive registration techniques, which are mainly based on the intensity of the subject data sets. Those techniques consider the full range of data points composing the data, thus negatively affecting the required processing time. Alternatively, alignment can be performed using the correspondence of extracted data points from both sets. Moreover, various geometrical characteristics of those data points can be used, instead of their chromatic properties, for uniquely characterizing each point, by forming a specific geometrical descriptor. This paper presents a comparative study reviewing variations of geometry-based, descriptor-oriented registration techniques, as well as conventional, exhaustive, intensity-based methods for aligning three-dimensional (3D) CT data pairs. In this context, three general image registration frameworks were examined: a geometry-based methodology featuring three distinct geometrical descriptors, an intensity-based methodology using three different similarity metrics, as well as the commonly used Iterative Closest Point algorithm. All techniques were applied on a total of thirty 3D CT data pairs with both known and unknown initial spatial differences. After an extensive qualitative and quantitative assessment, it was concluded that the proposed geometry-based registration framework performed similarly to the examined exhaustive registration techniques. In addition, geometry-based methods dramatically improved processing time over conventional exhaustive registration.

@&#INTRODUCTION@&#
The accurate and efficient alignment of imaging data is often required in a wide variety of applications, such as computer vision, pattern recognition, robotics, motion tracking and medicine [1–6]. Especially medical imaging data, acquired from the same patient over different time intervals or from various patients (atlases), can be compared for assessing the regression or progression of certain diseases or pathomorphic conditions, or even the effectiveness of particular pharmaceutical therapies or surgical procedures [7–9]. In order to ease the assessment process, or even partially automate it, the compared imaging data need to be spatially aligned.The alignment process is usually described as image registration. Most conventional registration algorithms comprise of an iterative trial-and-error procedure, in an attempt to optimize a given transformation function after a finite number of trials [10]. The transformation function describes the geometrical model that needs to be applied to a data set or image (floating), in order to spatially align it with respect to a reference data set or image. Various transformation models can be used for registering imaging data, ranging from simple translations to more complex rigid transforms, such as affine, similitude and projective, or even non-rigid, elastic models, such as Thin Plate Splines [8–13]. The selection of the transformation model mainly depends on the physiology of the processed data and the requirements of the application. During each step of the iterative process, new parameters are produced for the selected transformation model, according to a preferred optimization algorithm. Usually, the optimization technique estimates parameters for the transformation model, based on a preferred similarity metric [14]. Most optimization methods are based on well-established mathematical models, such as the Downhill Simplex (Nelder-Mead) model and Powell’s approach [15]. More advanced optimization techniques, however, may be based on genetic algorithms and neural networks [16–17]. During each iteration of the optimization algorithm, its performance is assessed through a measure of match or error function, which quantizes the similarity or differences between the reference and the transformed floating data sets [14]. Some of the most commonly employed measures of match include the Correlation Coefficient, the Mutual Information, the Mean Squared Error, the Gradient Difference and various distance-based techniques or statistical measurements [18–21].In most cases, the aforementioned repetitive process is performed over the entire information range of the subject data sets. This enhances the accuracy of the underlying registration algorithms, but also introduces a high level of redundancy, since areas of the data with low information content are also considered [10]. When processing two-dimensional (2D) medical images, the added redundancy does not greatly affect the efficiency of the algorithm, as the limited size of the data guarantees reasonable processing times. However, when considering multi-dimensional data sets, such as three-dimensional (3D) Computed Tomography (CT) or Magnetic Resonance Imaging (MRI) volumes, registration by conventional means may negatively impact on the efficiency of the alignment scheme [16]. 3D volumes usually consist of several 2D digital images, hence dramatically increasing the required processing time.Instead of considering the entire information range of the processed data, the registration algorithm may only work with a very limited set of data points [22,23]. The particular data points may either be selected randomly, by equally distributed sub-sampling of the original data, or by selecting a set of distinct points (key-points) [24]. The latter case theoretically maximizes the efficiency of the registration scheme, as the points with maximum information content are only considered. The end result of the above process, whichever the preferred technique, should be a set of points for each data set (reference and floating). These point sets are usually called point clouds and are essentially a uniform or non-uniform sample of the original data points [25]. In order to align the two produced point clouds, the correspondences between them need to be accurately estimated. As with conventional exhaustive registration techniques, correspondences can be estimated through a repetitive trial-and-error procedure [22,26]. Again, correspondences are formed, based on specific similarity metrics. Those metrics may be based on the luminosity level of the examined data points or on specific geometrical features [27]. The latter can be especially advantageous when processing medical data from different modalities (CT-MRI, CT-PET, etc.) or data acquired using varying acquisition protocols, as they alleviate any possible chromatic incompatibility that may negatively impact on the registration process [27].Several feature descriptors have been proposed, which completely discard the luminosity information of the modeled data points, for several computer vision applications, such as pattern recognition and registration [25,26]. Some of the most commonly employed descriptors include the Point Feature Histogram (PFH) and its fast derivative (FPFH), the Signatures of Histograms of OrienTations (SHOT) and Surface Normals (SN) [28–31]. Most of those descriptors have been used in the past for aligning 3D object models, but to our knowledge they were never applied on medical data. All of the above descriptors produce a unique histogram or signature for each data point in the reference and floating point clouds. By directly comparing those unique identifiers, it is possible to determine the best point matches between the two point clouds, usually by minimizing a distance function, thus forming the desired point correspondences [32]. In turn, the obtained corresponding points can be used for estimating a global transformation function, by extrapolating the mathematical relationships between the corresponding points, over the entire set of correspondences [33]. Finally, the estimated global transformation may be applied to all points of the floating data set in order to align it with respect to the reference set. Since point-based registration techniques only use a small fraction of the processed data points, they are usually much faster than conventional exhaustive registration methods, albeit less accurate, due to the limitation of the available information range [10].Considering all of the above, the purpose of the presented study is twofold: Firstly, a registration framework is proposed for aligning CT data, based only on the geometrical characteristics of individual data points as extracted from both data sets. This allows the registration of the medical data without using their chromatic properties; thus, dramatically reducing the required processing time, without negatively affecting the quality of the registration in terms of accuracy. Secondly, a comprehensive comparison is performed, considering conventional, exhaustive registration methodologies based on the intensity of the examined data, as well as geometry-based methods which only consider the geometrical properties of a limited set of individual points.Specifically, three conventional, exhaustive, intensity-based registration techniques have been considered, based on the Correlation Coefficient (CC) [18], Mattes Mutual Information (MMI) [34] and the Mean Squared Error (MSE) metrics [35]. In contrast, three feature descriptors were employed in the proposed geometry-based registration scheme, namely, the Fast Point Feature Histogram (FPFH) [28], the Signatures of Histograms of OrienTations (SHOT) [29] and Surface Normals (SN) [31]. In addition, the widely used Iterative Closest Point (ICP) algorithm was also considered as a point-based registration approach [22]. All of the above methods were applied on the same data sets of 3D CT image volumes, specifically, ten volume pairs with known initial spatial differences and 20 more pairs with unknown initial deviations.The rest of the paper is organized as follows: In Section 2 a brief presentation of the acquired data is performed, along with a detailed description of the featured registration techniques. Both qualitative and quantitative results are illustrated in Section 3. In Section 4 the key aspects of the examined techniques are discussed, as well as future directions for a generalized application of the geometry-based registration techniques.

@&#CONCLUSIONS@&#
In this study, an extensive comparison was performed including several geometry-based and exhaustive, intensity-based registration techniques. More specifically, three distinct metrics were examined as part of a conventional intensity-based registration methodology: Correlation Coefficient, Mattes Mutual Information, and Mean Square Error. In addition a geometry-based registration scheme was considered, based on three geometrical feature descriptors (Fast Point Feature Histograms, Signatures of Histograms of Orientation, and Surface Normals). All of the above registration techniques, along with the well-established Iterative Closest algorithm, were applied to a total of 30 3D CT volume pairs with known and unknown initial spatial differences. Qualitative and quantitative evaluation of the aligned data showed that the proposed geometry-based registration framework, using any of the featured descriptors, achieved similar accuracy to the examined exhaustive, intensity-based registration variants, by significantly reducing the required processing time, on the examined cranial CT data.The authors of the manuscript titled: “Geometry-Based Versus Intensity-Based Alignment: a Comparative Study on 3D CT Data” declared that there is no any financial or any personal relationships with other people or organizations that could inappropriately influence (bias) their work.