@&#MAIN-TITLE@&#
Computer-aided diagnosis of plus disease via measurement of vessel thickness in retinal fundus images of preterm infants

@&#HIGHLIGHTS@&#
We present techniques for measurement of the width of the major temporal arcade.Gabor filters and morphological image processing methods are applied.The methods can detect plus disease and retinopathy of prematurity.Area under the receiver operating characteristic curve of 0.76 obtained.

@&#KEYPHRASES@&#
Computer-aided diagnosis,Gabor filters,Plus disease,Retinal blood vessels,Retinal fundus images,Retinopathy of prematurity,Temporal arcade,Vessel width,

@&#ABSTRACT@&#
Changes in the characteristics of retinal vessels such as width and tortuosity can be signs of the presence of several diseases such retinopathy of prematurity (ROP) and diabetic retinopathy. Plus disease is an indicator of ROP which requires treatment and is signified by an increase in posterior venular width. In this work, we present image processing techniques for the detection, segmentation, tracking, and measurement of the width of the major temporal arcade (MTA), which is the thickest venular branch in the retina. Several image processing techniques have been employed, including the use of Gabor filters to detect the MTA, morphological image processing to obtain its skeleton, Canny׳s method to detect and select MTA vessel-edge candidates, least-squares fitting to interpolate the MTA edges, and geometrical procedures to measure the width of the MTA. The results, obtained using 110 retinal fundus images of preterm infants, indicate a statistically highly significant difference in MTA width of normal cases as compared to cases with plus disease(p<0.01). The results provide good accuracy in computer-aided diagnosis (CAD) of plus disease with an area under the receiver operating characteristic curve of 0.76. The proposed methods may be used in CAD of plus disease and timely treatment of ROP in a clinical or teleophthalmological setting.

@&#INTRODUCTION@&#
Digital imaging of the retinal fundus has become a valuable tool in noninvasive detection, diagnosis, and prognosis of diseases such as diabetic retinopathy (DR) [1–5], retinopathy of prematurity (ROP) [6–8], glaucoma [9,10], and cardiovascular complications [11,12] via computer-aided image-analysis methods. It has been shown that changes that occur in retinal vasculature can be indicative of the presence of DR [13–15], ROP [7,16–18], and hypertension [19], to name a few diseases. Physical attributes of arteriolar and venular vessels, such as their tortuosity and width, are changed in the presence of such diseases. In particular, the width of both the arterioles and venules increases in the presence of ROP, DR, and hypertension. Given the average vessel widths of86μmand96μmin premature infants with no ROP and those with threshold ROP, respectively [7], changes that occur in vessels in the presence of diseases such as ROP are not easily detected by the human eye, even when analyzed using a funduscope or fundus imaging devices. This limitation indicates the need for computer-aided methods to detect and quantify such small changes.Plus disease is an indicator of the severity of ROP; it represents a stage that is progressing and requires immediate treatment [20]. It has been established that the presence of plus disease is strongly associated with the early detection and treatment of ROP [18,20–24]. Plus disease is defined as the presence of certain levels of abnormal venular thickness and arteriolar tortuosity [25]. There are several theories that attempt to explain the cause of the observed vascular changes in the presence of plus disease [26]. One theory relates the changes to increased levels of certain vascular growth factors [27,28]. In the case of changes in venular thickness, it has been theorized that increased levels of blood pressure, and the fact that venules are more distensible than arterioles, could lead to dilation of venules [29,30].Plus disease is clinically diagnosed by qualitative comparison to a standard retinal fundus image [25] that exhibits abnormal levels of thickness and tortuosity. However, the standard image is considered to be atypical since it shows more vascular dilation and less tortuosity as compared to most retinas with plus disease [21]. Furthermore, the range of vascular changes is smaller and more challenging to distinguish in premature infants in the presence of plus disease even for experts, since the retinal vasculature is not fully developed as compared to the situation in adults. Indeed, it has been shown in a study that 22 recognized ROP experts agreed on diagnosis of plus disease only in 21% of the images analyzed [22]. Considering such facts, it can be concluded that there is a great need of methods for computer-aided diagnosis (CAD) of plus disease, which can lead to timely treatment of ROP.The major temporal and nasal arcades (MTA and MNA) are the two thickest branches of blood vessels (venules) on the temporal and nasal sides of the retina with reference to the optic nerve head (ONH), respectively. It has been observed that the changes that occur in the width of venules in the presence of ROP and plus disease are predominantly or specifically seen in the MTA [23,18,17], but are also observed in the MNA [31,18,32].Computer-aided methods used for measurement of vessel thickness typically fall into two categories. The first category of methods initially attempt to detect and segment vessels, then obtain the vessel center-line and edge pixels, and finally compute a thickness measure based on the distance between the associated edge and center-line pixels [13,7,33]. The second category of methods employ vessel detection techniques via a modeling approach. The models are mainly Gaussian-based since the intensity profile of a vessel at a given vessel center-line pixel resembles an inverted Gaussian curve [34,6,11]. As a result, the spread or standard deviation (STD) of the Gaussian model used to detect the vessel could be employed to estimate the width of the vessel. A brief review of a few such methods proposed for analysis of retinal fundus images of preterm infants is presented below.Using semiautomated methods, Heneghan et al. [7] obtained a binary image of retinal vessels via multiscale analysis of the second-order derivative of the original intensity images combined with preprocessing and postprocessing morphological methods, as well as a two-level thresholding strategy. Heneghan et al. measured the vessel width by extending a line from the two opposite sides of a given vessel pixel until it reached the boundary of the vessel and noting the length of the line. This procedure was repeated for lines of various orientations originating from the same pixel. The vessel width at the given pixel was taken as the minimum distance obtained for all orientations.Martínez-Pérez et al. [35,36] developed a semiautomated image analysis software called RISA for detection, segmentation, and measurement of vessel width in retinal images. RISA uses a region-growing algorithm in order to segment (binarize) blood vessels based on two features of edge-strength and ridge-strength. The edge-strength feature is derived as the gradient of the intensity image. The ridge-strength feature is based on the eigenvalue of the Hessian matrix of the intensity image. The resulting binary image is skeletonized and broken into several segments based on the detected branching points. RISA estimates the width of each vessel segment as the total area (in pixels) of the segment, divided by its length. RISA requires manual user correction at the stage of detection of branching points, as well as manual input regarding the vessel segment to analyze and to distinguish between venular and arteriolar branches.Based on tracking and extraction of skeletons of manually selected vessels via multiscale ridge detectors, Wallace et al. [6] determined a vessel width estimate at each detected ridge point using the spread of a Laplacian-of-Gaussian model.Fiorin and Ruggeri [33] used a web-based software package to draft manually the center-line of a retinal vessel segment. Canny׳s edge detection method was then used to obtain a set of vessel-edge pixels around the selected center-line. Two edge curves were then estimated on either side of the selected center-line by fitting a cubic spline to the previously detected edge pixels. The width of the selected vessel segment at each pixel was defined as the distance along the normal at a center-line pixel between the two estimated edge curves.Using RISA, a few studies [31,23,18,32] have attempted to measure vessel width in retinal fundus images of premature infants and have correlated their findings to the presence of plus disease in the images. The results of these and two other studies [7,6] on CAD of plus disease are presented and compared with the results obtained using the proposed methods in Section 4.Locating vessel edges based on binarization of the intensity image obtained using a vessel detection algorithm is prone to error due to sampling, the scale of the model used, as well as the threshold value used to binarize and segment vessels [7]. Furthermore, estimation of vessel width using the STD of Gaussian-based models is also prone to error since a Gaussian model is a continuous curve that does not contain a clear-cut point to indicate the exact location of the vessel edges. Such a method for estimation of width requires an assumption regarding suitable, yet arbitrary, weighting of the STD of the Gaussian model to estimate vessel width [37]. Methods that use a vessel׳s center-line for measurement of width are prone to error in case the center-line is not precisely in the middle of the vessel; it is especially challenging to guarantee such a requirement. Furthermore, such methods require accurate detection and subpixel representation of vessel edges. In addition, the methods available in the literature for measurement of vessel width in case of plus disease either manually distinguish between venular and arteriolar branches [31,23,18,32], or do not distinguish between them at all [7]; these methods also obtain the width measurement for only manually selected vessel segments.In this paper, we present methods for detection, segmentation, and extraction of the MTA skeleton as well as detection and interpolation of the edges of the MTA, and ultimately, computation of the width of the MTA at several pixels along its skeleton in retinal fundus images of preterm infants. Gabor filters, which have been shown to be effective in detection of oriented patterns in biomedical applications [38–41], are used for the detection of vessels in the present work. Gabor filters have been applied for the detection of retinal blood vessels in previous works by Soares et al. [42] and Rangayyan et al. [43]. Furthermore, the methods include morphological image processing techniques to extract the MTA skeleton, Canny׳s method for selection of vessel-edge candidates, least-squares fitting to interpolate the vessel edges, and geometrical procedures to measure vessel width. The diagnostic performance of the average MTA width measure in distinguishing between cases with and without plus disease is analyzed in terms of sensitivity, specificity, area (Az) under the receiver operating characteristic (ROC) curve, and p-value. The obtained results are compared with results of similar studies in the literature. The present paper is an expanded and revised version of a related conference presentation [44].The proposed methods were tested with retinal fundus images from the Telemedicine for ROP In Calgary (TROPIC) database [45]. The TROPIC images were captured using the RetCam II equipped with a wide-field (130°) lens and possess a size of640×480pixels. The spatial resolution of the RetCam images is estimated to be30μm/pixel [46]. RetCam images are considered to be low-resolution retinal fundus images. In total, 110 images from 41 patients, including 16 females and 25 males, were selected. In most cases, there are five different images available for each eye of each patient from each visit, representing different retinal fields to provide collectively a nearly full photographic documentation of the retina. In each case, the image with the highest visibility of two quadrants of the MTA was selected. Images were not selected based on overall quality and/or vessel-to-background contrast [47]. Patients corresponding to 90 of the 110 images were diagnosed with no ROP or with stages 1 or 2 ROP (30 images per category), and patients corresponding to 20 images were diagnosed with stage 3 ROP. Nineteen of the selected images were of patients diagnosed with plus disease (stages 2 and 3 of ROP) and 91 showed no signs of plus disease.At most, two images of the same patient were included for the same stage of ROP, with one image from each eye. Images of the same eye from the same patient were included only if the ROP stages were different at the time of imaging, as diagnosed by an expert pediatric ophthalmologist and retinal specialist (A.L. Ells). The mean birth weight, gestational age, and chronological age of the patients at the time of imaging are 817.6g, 26.4 weeks, and 70.8 days, respectively. The project and protocol were approved by the Conjoint Health Research Ethics Board of the University of Calgary. The tenets of the Declaration of Helsinki were followed during the acquisition of the images. Written informed consent and approval were obtained from the parents of all children involved.The procedure for extraction of the MTA skeleton consists of several stages: (1) preprocessing, (2) selecting the seed labels, (3) extracting the MTA skeleton segments, and (4) postprocessing. The algorithm requires the approximate location of the center of the ONH; for this purpose, the ONH centers in all images were manually marked by the user via a graphical user interface [48]. Note that this is the only manual input in the entire procedure used for vessel width measurement and will eventually be replaced by an automated procedure [49].Fig. 1shows a flowchart representation of the preprocessing steps for extraction of the skeleton of the MTA.In order to detect the MTA, the previously published method of Rangayyan et al. [43], which uses Gabor filters, was employed. A large thickness value(τ=10pixels)and elongation factorl=1.2, determined empirically, were used to emphasize the magnitude response of the MTA. Using the responses from a bank of 45 Gabor filters spaced evenly over the angular range of[−π/2,π/2], the Gabor-magnitude response at each pixel was defined as the largest response of the filters, and the Gabor-angle response was defined as the orientation of the corresponding Gabor function.Given the fact that vascular changes have been observed to occur close to the ONH (posteriorly) in the presence of ROP [25], an average ONH width (ONHW) of 1.05mm in infants [46], and the spatial resolution of the TROPIC images, the skeleton extraction procedure and the subsequent analysis of each image were limited to the horizontal range from0.25×ONHWin the nasal direction to2×ONHWin the temporal direction with respect to the center of the ONH.The algorithm is designed to detect the superior and inferior temporal arcades (STA and ITA) separately. The part of the image above the center of the ONH was taken as the superior part (STA), and the part below it was taken as the inferior part (ITA) and processed separately.Each superior and inferior Gabor-magnitude-response image was normalized and gamma correction (withγ=1.5) [50] was applied to increase the high-intensity values (related to the MTA) and decrease the low-intensity values (related to choroidal vessels).The moment-preserving thresholding method [51] was used to binarize the Gabor-magnitude-response images of the STA and ITA separately. This method finds a suitable threshold by assuming that, if the given gray-scale image is binarized, the first three moments of the gray-scale image must be preserved in the resulting binary image [51]. The resulting binary image was then skeletonized using the curvature-skeleton algorithm [52].All vessels in the retina originate from the center of the ONH; hence, it is difficult to distinguish between the various branches of vessels within the ONH. Therefore, a circular region centered at the center of the ONH, with diameter equal to the average ONHW, was removed from the skeleton of the detected vessels.In order to remove the pixels in the skeleton that represent the boundary of the ONH, the difference between the radial angle (originating from the center of the ONH) and the Gabor angle for skeleton pixels within an annular region (the area between two circles with diameters=1×and2×ONHW) was obtained. If the angle difference was more than60°, the associated pixel was removed [53].The horizontally restricted skeleton images were then pruned to remove short branches. Unconnected segments that are not part of the MTA were removed by using the morphological process of area open only if there were at least 10 different segments available in the image. The minimum number of connected pixels to be removed was automatically determined based on the mean and STD of the number of pixels in all available segments in the skeleton image, as mean+0.5×STD.Based on the orientation of each skeleton pixel, as indicated by the Gabor-angle response, pixels that do not belong to the STA and ITA were removed separately. When considering the STA/ITA of the right/left eye, respectively, pixels with orientation in the range[0,π/2]were removed; similarly, when considering the STA/ITA of the left/right eye, pixels with orientation in the range[−π/2,0]were removed.Fig. 2illustrates a flowchart representation of the seed-label-selection algorithm for extraction of the skeleton of the MTA.The branching points of the skeleton were determined using morphological image processing and by considering the number of neighboring pixels in an area of size3×3pixels. The segments resulting from breaking the skeleton were each labeled separately by numbering them. The average Gabor-magnitude response of each labeled segment of the skeleton was then calculated to obtain the seed label. The annular search area used to find seed label candidates was adaptively increased to ensure that there are at least two labels present for comparison for each of the STA and ITA parts; the procedure makes an exception to this criterion if only a single label is available in the image.Fig. 3shows a flowchart representation of the part of the algorithm for extraction of segments of the skeleton of the MTA.When selecting the label with the highest average Gabor magnitude response as the next potential segment of the arcade being analyzed, the algorithm ensures that the distance between the ending point of the current label and the starting point of the next potential label is no more than 10 pixels. The algorithm checks the total length of the selected segments and how far they extend collectively, with respect to the horizontal size of the image, as the exit criteria; specific details are provided in the flowchart in Fig. 3.The postprocessing steps after the selection of the segments of the skeleton of the MTA are stated below.(a)Construct a binary image of the extracted arcade consisting of the selected labels in the previous stage.Combine the extracted STA and ITA to obtain a binary image of the MTA (see Fig. 3).It is possible that the extracted MTA skeleton consists of disconnected segments because of the removal of the branching points in the preprocessing stage. This design factor is advantageous to the measurement of width as explained in Section 5.In the present work, the selected skeleton segments are analyzed in terms of their associated Gabor-angle information in order to determine whether each selected segment is approximately linear or not. If a segment is not linear, breaking points are determined to separate the given segment into a set of linear subsegments.The first step in obtaining linear subsegments of each selected skeleton segment is to identify the pixels in the correct sequential order as follows:(a)Locate the left-most end point of the current segment.Start from the selected end point and sequentially move along the skeleton segment one pixel at a time in a3×3-pixel neighborhood.Store the sequential position of each traversed pixel in the segment as well as its associated Gabor-angle response in vectorial format.Repeat steps (b) and (c) until the right-most end point is reached.In order to detect possible changes in the orientation of the extracted skeleton segments, the statistical measure of median absolute deviation (MAD) [54] was obtained in a window of length 7 pixels applied to the sequenced Gabor-angle response obtained in the previous step. Given a set of data points, M,MAD=median[|M−median(M)|], where|.|indicates the absolute value. The analysis was only performed on segments with a minimum length of 7 pixels. The steps involved in obtaining the MAD measure are:(a)Obtain the MAD measure of the previously obtained Gabor-angle sequence.Set all nonzero values in the MAD measure equal to unity.All nonzero values in the MAD measure are set to be equal in order to avoid detection of local changes and emphasize the global variations in the orientation of the segment under analysis. Note that, given the angle increment ofπ/45, due to the number of Gabor filters used (45), the MAD measure provides values of 0 or integral multiples ofπ/45.The obtained MAD measure needs to be analyzed further in order to detect any possible significant variations in the orientation of the segment being evaluated and subsequently any possible cutting points. The analysis is performed as follows:(a)Obtain the forward and backward derivatives (dfand db) of the MAD measure.Set values ofdf>0anddb<0to 0.Setdcombined=df+db.Analyze dcombinedbased on possible patterns in the derivative values.Determine the breaking points if any expected patterns are detected.Break apart the segment only if any breaking point is determined.Assume the entire segment to be linear if no breaking point is determined.The forward and backward derivatives are combined to take advantage of the fact that a positive backward derivative value indicates the exact point of a positive change in the MAD measure; similarly, a negative forward derivative value indicates the exact point of a negative change in the MAD measure. Given a variation in the orientation of a segment, there are three possibilities and patterns to detect: (a) A change that starts and stops within a sequence, indicated by a leading positive and a trailing negative derivative. (b) A change that starts from the first pixel in a sequence and ends within it, indicated by only a negative derivative (no leading positive value). (c) A change that starts within a sequence, but does not end, indicated by only a positive derivative (no trailing negative value). Any one of these conditions indicates a possible cutting point on the segment under analysis. Any single index obtained from cases (b) and (c) was taken as a cutting point. The median point between the two indices obtained in case (a) was taken as a cutting point as well.By the end of this step, each extracted MTA skeleton segment is either broken into piecewise linear subsegments or is considered to be a linear segment by itself.In this work, Canny׳s edge detection method is used to detect initial edge-pixel candidates in the inverted green-channel of the original image. Canny׳s method detects edges by looking for local maxima in the gradient of the given gray-scale image. The gradient is obtained using the derivative of a Gaussian filter. The Canny method uses two threshold values to detect strong and weak edges. Pixels belonging to weak edges are included only if they are connected to strong edge pixels. As a result, the outcome of Canny׳s thresholding step is less prone to error due to noise as compared to other edge detection methods. However, given the low spatial resolution of the TROPIC images, the results of Canny׳s method provide vessel edges that are jagged and suffer from sampling errors. Considering the average width of vessels in pediatric cases of about90μm[7], the low spatial resolution of the TROPIC images, and small variations between normal and abnormal MTA width, it is crucial to detect and represent the vessel edges as accurately as possible and consequently obtain precise width measurements.In order to represent vessel edges accurately, for every linear segment or subsegment of the extracted MTA, two separate sets of nearest edge pixels (in Canny׳s output) to each skeleton pixel on both sides were selected. Two first-order polynomials were fitted to the two sets of edge-pixel candidates in order to obtain accurate, continuous-form representations of the two edges asYe1,2=me1,2Xe1,2+Ce1,2, where the subscriptse1,2indicate edge lines 1 and 2, respectively, and the variablesme1,2andCe1,2their corresponding slopes and y-intercepts. Such a continuous-form representation of vessel edges allows for subpixel measurement of MTA width.In theory, the width of a vessel is defined as the distance along the normal to the skeleton between the two adjacent edges. Based on the Gabor-angle response, i.e., vessel orientation, the slope of the normal, n, at a given skeleton pixel, i, is obtained asmni=−1/tan[ϕ(i)], whereϕ(i)is the Gabor-angle response at the given skeleton pixel. The normal line is then obtained using the coordinates of the given skeleton pixel,(xi,yi), and its corresponding slope, asYni=mniXni+Cni, whereCni=yi−(mnixi)is the y-intercept.Given the continuous-form representation of the two edges (also in slope-and-y-intercept form) and the normal lines along a linear vessel segment/subsegment, it is possible to obtain the width at each skeleton pixel precisely as the theoretical definition of width based on the Euclidean distance between the two exact points of intersection between the normal line and each edge line. At a given skeleton pixel, i, the coordinates of the two points of intersection are defined asxi1,2=(Cni−Ce1,2)/(me1,2−mni)andyi1,2=me1,2xi1,2+Ce1,2. The vessel width at the given pixel is computed aswi=(xi1−xi2)2+(yi1−yi2)2.

@&#CONCLUSIONS@&#
