@&#MAIN-TITLE@&#
Towards large-scale geometry indexing by feature selection

@&#HIGHLIGHTS@&#
A method integrating geometry in the indexing process for image retrieval.Unsupervised learning for feature selection.Image representation robust against viewpoint change, occlusion, background clutter.We find out that re-ranking with spatial verification is no longer needed.

@&#KEYPHRASES@&#
Image retrieval,Geometry indexing,Feature maps,Feature selection,Spatial matching,

@&#ABSTRACT@&#
We present a new approach to image indexing and retrieval, which integrates appearance with global image geometry in the indexing process, while enjoying robustness against viewpoint change, photometric variations, occlusion, and background clutter. We exploit shape parameters of local features to estimate image alignment via a single correspondence. Then, for each feature, we construct a sparse spatial map of all remaining features, encoding their normalized position and appearance, typically vector quantized to visual word. An image is represented by a collection of such feature maps and RANSAC-like matching is reduced to a number of set intersections. The required index space is still quadratic in the number of features. To make it linear, we propose a novel feature selection model tailored to our feature map representation, replacing our earlier hashing approach. The resulting index space is comparable to baseline bag-of-words, scaling up to one million images while outperforming the state of the art on three publicly available datasets. To our knowledge, this is the first geometry indexing method to dispense with spatial verification at this scale, bringing query times down to milliseconds.

@&#INTRODUCTION@&#
Geometry is essential in many problems of computer vision like feature correspondence, image registration, wide baseline stereo matching, object recognition, and retrieval. And it has been more so in early years when features were non-discriminative, e.g. points. With the advent of more discriminative features and descriptors, discarding geometry altogether has been an “easy” way to deal with viewpoint change and occlusion. The success of the bag-of-words (BoW) model, largely due to its very low computational cost, has come as quite a surprise to many, for instance in the seminal work of Sivic and Zisserman [1].In order to boost performance at large scale however, geometry is still essential. Even if weaker or stronger geometric models are feasible in tasks like registration or recognition, this is clearly not the case for image retrieval. State of the art approaches are still based mostly on appearance in the filtering stage, while geometric or spatial constraints typically come as a second, re-ranking or spatial verification stage. The former is carried out by an inverted file and is non-exhaustive; only a small percentage of the database is accessed during scoring. The latter is practically the most time consuming task. The need for including spatial information in the index itself is identified, e.g. in Philbin et al. [2].Even in more recent work, such indexing has only been achieved in the form of weak geometric constraints as in Jegou et al. [3], local geometry, as in Chum et al. [4], or representations that are not fully invariant to geometric transformations, such as Wu et al. [5]; a detailed account is provided in Section 2. On the other hand, global geometry indexing is at least as old as geometric hashing by Lamdan and Wolfson [6], where features are non-discriminative. To our knowledge, our earlier method of [7] has been the first to index appearance and global geometry under invariance, but index space requirements have limited it to 50K images. We attempt here a solution towards large scale image retrieval.One of our starting points is [2] where spatial matching is performed as a special case of RANSAC [8]. Shape parameters of local features are used to generate each hypothesis using a single feature correspondence. The idea stems from Lowe [9] but has been studied in more depth only recently, e.g. in Köser et al. [10]. We go a step further and for each feature we encode the normalized position and appearance of all remaining features in a sparse histogram that we call a feature map. One may think of feature map as a local descriptor that globally describes the entire image in a local coordinate frame. This has strong connections to shape context[11], geometric hashing [6], and previous work which is discussed in Section 2. Under this novel representation, spatial matching is further reduced to a collection of inner product or set intersection operations.The feature map representation is quadratic in the number of features. In [7], feature map hashing (FMH) is used to make it linear. A locality sensitive hashing (LSH) framework is adopted and min-wise independent permutations [12] are extended to collections of sets to derive a similarity measure for feature map collections. The images returned by the inverted file used in the filtering stage are not only ranked according to similarity, but are also associated with a rough estimate of the relevant geometric transformation, as in [4]. Full spatial matching is thus reduced to a single local optimization step of LO-RANSAC [13]. For the same processing time, the number of images we verify is effectively increased by an order of magnitude. The retrieval performance of FMH without re-ranking is superior to bag-of-words with re-ranking, on three publicly available datasets.Despite the hashing framework applied in [7], the memory requirements of FMH are still high enough to prohibit its use for datasets in the order of106. Hence, in the present work, we choose to substitute hashing with a novel feature selection model. Through an automated and unsupervised learning process, we select and index only the most informative features for each image and thus keep memory requirements comparable to the baseline bag-of-words model. We experiment on three publicly available retrieval datasets of size up to106with excellent performance. Most importantly, we find that spatial verification and re-ranking is no longer needed as the database gets larger. Hence queries can be restricted to the filtering stage alone with query times in milliseconds.Following the related work in Section 2, Section 3 provides a background on a number of related problems in shape matching, feature correspondence and indexing. Section 4 derives our feature map representation along with the associated matching process. These first two sections provide a detailed account of the work first introduced in our earlier work [7]. Feature selection, introduced here, is presented in Section 5 and implementation details in Section 6. Experiments and discussion are provided in Sections 7 and 8, respectively.

@&#CONCLUSIONS@&#
