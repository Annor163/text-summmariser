@&#MAIN-TITLE@&#
Respiratory rate estimation from the ECG using an instantaneous frequency tracking algorithm

@&#HIGHLIGHTS@&#
Two respiration-related waveforms are derived from the ECG.A frequency tracking algorithm estimates the respiratory rate from them in combination.This combination is more effective than using either waveform separately.The algorithm is automatic and real-time.

@&#KEYPHRASES@&#
Frequency tracking,Electrocardiogram (ECG),Respiratory rate (RR),

@&#ABSTRACT@&#
Monitoring the respiratory rate (RR) is important in many clinical and non-clinical situations but it is difficult in practice, for existing devices are obtrusive, bulky and expensive. The extraction of the RR from the routinely acquired electrocardiogram (ECG) has been proposed lately. Two approaches exist, one exploiting the modulation of the heart rate by the respiration, known as the respiratory sinus arrhythmia (RSA) and the other using the modulation by the respiration of the R-peak amplitudes (RPA). In this study, the weighted multi-signal oscillator based band pass filtering (W-OSC) algorithm is applied to track the common frequency in the RSA and RPA waveforms simultaneously, as an estimate of the instantaneous RR. On the public PhysioNet Fantasia data set, it is shown that the presented method is automatic, instantaneous and comparable in accuracy to the state-of-the-art.autoregressiveband-pass filterbreaths per minuteelectrocardiogramempirical mode decompositionerror percentageintrinsic mode functionmean absolute erroroscillator based band-pass filteringR-peak amplituderespiratory raterespiratory sinus arrhythmiashort time Fourier transformweighted multi-signal oscillator based band-pass filtering

@&#INTRODUCTION@&#
The respiratory rate (RR) is one of the human vital signs that need to be monitored in clinical and non-clinical applications for diagnosis and control purposes [1]. It is currently difficult to accurately and continuously monitor the RR, for the apparatus and devices are intrusive, expensive and uncomfortable for the patient [2]. It is therefore of great interest to provide easy and inexpensive means for the accurate, continuous and convenient monitoring of the RR. The respiratory and heart activities are linked through physiological processes. The respiration modulates the heart rate such that it increases during inspiration and decreases during expiration [3]. A waveform can be extracted from the heart rate time series representing this modulation, which is referred to as respiratory sinus arrhythmia (RSA). Furthermore, the filling and emptying of the lungs during respiration causes a rotation of the electrical axis of the heart and a change in the impedance of the thorax, which yields changes in the electrocardiogram (ECG) beat morphology. As a result, the R-peak amplitudes are modulated by the respiratory activity. A waveform can be extracted from the ECG representing this modulation, which is referred to as the R-peak amplitude (RPA). In the last twenty years, many researchers have investigated the possibility of deriving the RR by exploiting the influence of respiration on the heart rate or ECG beat morphology by using the RSA or RPA waveforms. A summary of studies prior to 2007 can be found in [3].In a more recent work, a windowed spectral analysis was applied to extract the RR from the RSA waveform [4]. A windowed temporal analysis using peak count was also applied to estimate the RR from the RSA waveform [4,5] as well as from the RPA waveform [5]. Furthermore, correlation analysis was used to compute the RR from the RSA waveform [4]. Past studies have highlighted the difficulty of deriving, for comparison purposes, a reference RR from a respiratory signal recorded by nasal thermistry or pneumography, as the latter is neither band-pass, nor stationary [4]. Proposed solutions consisted in applying the same frequency estimation methods as for the RSA or RPA waveforms to the respiratory signal to estimate the reference RR.In a pioneering work, Orphanidou et al. fused spectral information form ECG-derived RSA and RPA waveforms in order to derive the RR [6]. The most dominant peak from the autoregressive (AR)-estimated spectra of the RSA and RPA waveforms was selected according to several criteria as representing the RR. Vehkaoja et al. also used RSA and RPA signals simultaneously and combined their temporal maxima and minima counts after ad hoc filtering to estimate the RR [7]. However, none of these two methods provides a robust, real-time and automatic means to estimate the RR continuously. Both discarded parts of records and required special subject-dependent treatment.Motivated by the recent contribution of Orphanidou et al. to fuse respiratory information from the RSA and RPA waveforms extracted from the ECG [6], the purpose of the present study was to estimate the instantaneous real-time RR by using the weighted multi-signal oscillator based band-pass filtering (W-OSC) algorithm [8] to track the common frequency component present in the RSA and RPA waveforms. This multi-signal frequency tracking method operates recursively on several signals simultaneously to track a common frequency component. This method has been shown to successfully track a common frequency component in biomedical signals such as electroencephalogram signals [9]. Furthermore, it is instantaneous and provides an automatic approach to RR estimation from the RSA and RPA, in contrast to the ad hoc processing proposed in [6]. Therefore it can be implemented in a real-time setting to estimate the RR continuously without the need for subject-dependent adjustment. The performance of this tracking method was assessed on the single-lead ECG recordings of the PhysioNet Fantasia data set, using a reference RR computed from the combination of eight different frequency estimates of the simultaneously recorded respiratory signal.The PhysioNet Fantasia data set [10,11] is used to evaluate algorithms in this study. This data set provides 120min long records of simultaneously acquired single-lead ECG and spontaneous respiration signals (acquired through inductance plethysmography [12]) from 20 young (21–34 years of age) and 20 elderly (68–85 years of age) subjects. The subjects were healthy and laid supine watching the movie “Fantasia.” Both sets of signals were digitized with a sampling rate of 250Hz.In order to extract the RSA and RPA waveforms, the ECG baseline wander was first removed using a double median filter [13]. The local maxima of the corrected ECG were then extracted as the R-wave peaks R[n] using a classic extrema detection method [14]. No special processing was performed to identify irregular beats. The time differences tR[n]−tR[n−1] between all pairs of consecutive peaks were computed in order to create the R-peak to R-peak time series. The time abscissa associated to each difference was the midpoint between the two peaks. This series was re-sampled at 2Hz using cubic spline interpolation in order to ensure regular sampling. The resulting signal is the interbeat interval waveform, from which, the RSA waveform was extracted by band-pass filtering (between 0.1Hz and 0.5Hz to isolate components relevant to respiration [3]). The R-wave peaks R[n] were also re-sampled at 2Hz and band-pass filtered in the same manner as the inter-beat interval waveform to produce the RPA waveform. Forward-backward filtering using a Chebychev type I filter is used in the demonstrations presented is this article.An adaptive band-pass filter (BPF) with an oscillator-based mean-square error update algorithm [15] was used to estimate the common frequency present in the RSA and RPA waveforms. The algorithm is referred to as OSC. It was later extended to be applied to several signals simultaneously in order to track a common frequency component in them [8]. This multi-signal extension is referred to as W-OSC. This algorithm can track a common frequency present in M signals {xm}, m=1, …, M of the form:(1)xm[n]=sm[n]+bm[n]where the sm[.] are oscillations at time-varying frequency ω[.] and the bm[.] are additive white noises. All M signals are filtered with the same BPF and the tracking quality of the outcome is used to weigh the contribution of each signal to the filter update in order to track a common oscillation ω[.] in the signals. The transfer function of the BPF is:(2)H(z;n)=1−β21−z−21−α[n](1+β)z−1+βz−2where 0<β<1 defines the bandwidth of the BPF and α[.]=cos(ω[.]) is the central frequency coefficient of the filter. The output of the filter for signal m is:(3)ym[n]=(1+β)α[n]ym[n−1]−βym[n−2]+1−β2(xm[n]−xm[n−2]).It is desired that the filter output follows the oscillator model:(4)ym[n]=2cos(ω[n])ym[n−1]−ym[n−2].In order to update the filter such that the output follows (4), the following cost function is minimized:(5)Jm[n]=E{(ym[n]−2α[n+1]ym[n−1]+ym[n−2])2}with E{.} denoting the expectation. The minimization of Jmyields the optimal α[n+1] as:(6)α[n+1]=E{ym[n−1](ym[n]+ym[n−2])}2E{ym2[n−1]}.In practice, the expectations in the expression of α[n+1] cannot be computed and are replaced by time recursive estimates such that:(7)α[n+1]=Qm[n]2Pm[n]with(8)Qm[n]=δQm[n−1]+(1−δ)ym[n−1](ym[n]+ym[n−2])Pm[n]=δPm[n−1]+(1−δ)ym2[n−1]where 0<δ<1 is the update coefficient. If the frequency of one signal is estimated, (7) describes the update of the filter. If the common frequency of M signals is estimated, it is natural to weigh the contribution of each signal to the update of the BPF central frequency. For each signal, (7) yields αm[n], which gives a frequency estimate ωm[n]=arccos(αm[n]). This estimate can be written as ωm[n]=ω0+Δm[n], where Δm[n] is the deviation of the estimate from the true frequency ω0. A set of weights{Wm∣∑m=1MWm=1}are sought based on the variances of the Δm[.] to minimize deviations [8]:(9)Wm=1/σm2∑i=1M1/σi2.These weights maximize the effect of signals with low-variance estimates and minimize the effect of signals with high-variance estimates. As the variances in (9) cannot be computed, it is assumed that they are proportional to:(10)σm2∝JmSxmwhere Jmis defined in a recursive manner as:(11)Jm[n]=λJm[n−1]+(1−λ)|ym[n]−2α[n+1]ym[n−1]+ym[n−2]|2andSxmis the variance of the input x, which in its recursive estimate form is:(12)Sxm[n]=λSxm[n−1]+(1−λ)xm2[n]with 0<λ<1. The weights in (9) are therefore obtained as:(13)Wm[n]=Sxm[n]/Jm[n]∑i=1MSxi[n]/Ji[n].The inclusion of the weighting process yields:(14)α[n+1]=∑m=1MWm[n]Qm[n]2Pm[n].The instantaneous frequency is computed as:(15)f[n+1]=arccos(α[n+1])2π.The RR is estimated using the W-OSC algorithm with the RSA and RPA as inputs to track common frequency component. In order to assess the benefit of using both RSA and RPA simultaneously, as opposed to either separately, the RR is also estimated by using the OSC algorithm on each one separately.To evaluate the RR estimated from the RSA and RPA waveforms, one needs to compare the estimate with the true RR. However, deriving the RR from a real respiratory signal is a challenging problem as the respiratory signal derived from thoracic volume changes (measured with impedance pneumography) or nasal/oral airflow is neither stationary nor band limited. It also contains many artifacts and noise due to the acquisition process. Many methods have been proposed, but no single automated technique exists to reliably compute the RR in a window or instantaneously.A common practice to estimate the RR is to compute the power spectrum in a sliding window over the signal and to consider the dominant peak frequency as the RR [3]. The power spectrum can be computed using either a non-parametric or a parametric estimator. AR modeling has been used for the respiratory signals of the PhysioNet Fantasia data set [6], which are thought to be impedance pneumography ones. Extrema detection to compute the RR [16] has also been applied to the PhysioNet MIMIC data set respiratory signals [17,11], which are thought to be obtained by nasal thermistry.In this study, eight frequency estimation algorithms were used to estimate the RR from the PhysioNet Fantasia respiratory signals. Various frequency-domain and time-domain estimates were combined to provide a robust estimate, which is used as ground truth RR. The majority of the chosen methods are instantaneous, however several are window-based. The optimal length of the windows are chosen based on the properties of each method in an empirical manner.Prior to the reference RR estimation process, the respiratory signal was re-sampled at 2Hz using cubic spline interpolation. In addition, a high pass filter with a normalized cutoff frequency of 0.025 was applied to the re-sampled respiratory signal in order to remove its baseline wander.In order to determine the frequency content of a non-stationary signal by using its spectrum, the short time Fourier transform (STFT) is used. The instantaneous RR was computed as the normalized frequency corresponding to the local maximum in the magnitude of the STFT in 75s long windows. The window length was found to allow for necessary frequency resolution based on several trials. This window length is applicable to other data sets and moreover, the outcome is moderately sensitive to the exact length.The Hilbert transform allows to generate, from a real signal, a complex signal, termed the analytic signal with separable amplitude and phase components [18]. However, for the Hilbert transform to be meaningful, the input signal must be narrow band [19]. Empirical mode decomposition (EMD) is a data analysis method that decomposes the signal into a set of intrinsic mode functions (IMFs) based on the extraction of energy from different intrinsic time scales [20]. EMD is used to extract a component of the respiratory signal, which contains the RR and is narrow band such that the Hilbert transform outcome is meaningful. When the EMD is applied to the respiratory signal, the first IMF is observed to contain oscillations within the range of the RR. The instantaneous frequency was obtained by differentiating the phase of the analytic representation of the first IMF.The time difference between two respiratory peaks P[n−1] and P[n], denoted as tPP[n]=tP[n]−tP[n−1], is interpreted as a respiratory cycle. The respiratory peaks were extracted by local maxima detection. The time series of their differences, attributed to the time index of the second peak, was created and inversed in order to estimate the instantaneous respiratory frequency. The resulting RR was re-sampled at 2Hz using cubic spline interpolation in order to ensure equal spacing of points such that comparison and combination with other RRs is possible.The number of local maxima in a window determines the number of respiratory cycles in that window. The RR in a window was estimated as the ratio of the number of respiratory cycles in the window by the length of the window. 20s windows, centered on each sample were chosen based on several trials. This window length is applicable to other data sets and moreover, the outcome is moderately sensitive to the exact length. Respiratory peaks were extracted by local maxima detection.The RR was estimated using the Teager–Kaiser operator. This energy tracking operator estimates the energy required to generate a given amplitude and frequency modulated signal, which is then used to separate the amplitude and frequency components [21].A recursive modified covariance method was used to estimate the RR. The modified covariance method is a recursive frequency tracking algorithm derived from the linear prediction property of sinusoids [22]. The minimization of the squared error between the linear prediction estimate and a sinusoidal model in a recursive manner yields an estimate of the signal frequency.The RR was extracted as the largest peak, within 20s windows centered on each sample, of the spectrum estimated using an AR model fit to the data [3]. The window length was empirically found to be optimal based on several trials. It is applicable to other data sets and moreover, the outcome is moderately sensitive to the exact length. A Yule-Walker 10th order AR model was used. In [6], an AR model of order 8 was used to estimate the spectrum of the respiration signal. However, several trials showed that increasing the order to 10 yielded more detailed RR estimates.Prony's method is a technique for modeling a discrete-time signal as a linear combination of exponentials. It extends Fourier analysis by directly estimating frequency, damping, strength and relative phase of modal components present in a signal [23]. In the original approach, a model is fit to the data and then the frequency and other signal attributes are computed from the model parameters. Later, a modified instantaneous linear-prediction-based version of Prony's frequency estimator was proposed [24], which uses five data points to directly estimate the instantaneous frequency of a sinusoidal signal. The latter version was implemented for use in this study.At each time index, the three closest estimates to the median of the eight estimates were chosen as the three most accurate RRs. The reference RR was computed as the mean of the three retained estimates and expressed as the number of breaths per minute (bpm) as bpm=60×f, where f was the RR in hertz. This combination method is robust to outliers and allows to take into account different estimates, some of which are spectral and some other temporal. Estimates 1, 4 and 7 are computed in windows and estimates 2, 3, 5, 6 and 8 are instantaneous.A low-pass Butterworth filter with a normalized cutoff frequency of 0.2 was used to filter the estimates 2, 5, 6, 7 and 8 in order to smooth sudden changes due to the imperfection of the respiratory signal with respect to the assumptions of each algorithm. The final reference RR was filtered as well. The re-sampling rate as well as the filter cutoff frequencies were heuristically chosen based on several trials.In the filtering operations mentioned, forward-backward filtering was used in order to avoid phase shifts.The W-OSC tracking algorithm was applied to the RSA and RPA waveforms extracted according to Section 2.2 with parameters β=0.8, δ=0.9 and λ=0.9, which were found to allow for a good compromise between filter bandwidth and tracking adaptation. A larger β entails a narrower filter, however, a narrower filter has a longer adaptation delay. Mirroring was applied at the beginning of the signals in order to avoid border effects.For comparison purposes, and in order to assess the benefits of using both RSA and RPA waveforms, the OSC tracking algorithm was used to estimate the RR from the RSA and RPA separately with the same parameters as the W-OSC algorithm as they function in a similar manner.Errors were computed in two ways: (1) instantaneous; (2) window-based, where both the estimated RR and the reference RR were averaged in 60s windows.The mean absolute error (MAE) was computed as:(16)MAE=1N∑i=1Nbpmestim−bpmrefand the error percentage (EP) was computed as:(17)EP=100N∑i=1Nbpmestim−bpmrefbpmrefwhere N is the length of the signals in the instantaneous error computation and the number of windows in which the window-based error is computed. bpmestimis the estimate RR and bpmrefis the reference RR.

@&#CONCLUSIONS@&#
This article presents an RR estimation technique using a multi-signal frequency tracking algorithm W-OSC on the respiratory RSA and RPA waveforms extracted from the ECG.The tracking algorithm successfully estimated the RR from the two respiratory waveforms simultaneously. Furthermore, it was shown that using the two together is advantageous with respect to using either one separately. In addition, the algorithm performance was similar for young and elderly subjects.In sum, the W-OSC method yields estimates which are comparable to the state-of-the-art in terms of accuracy. Furthermore, this tracking algorithm is recursive and instantaneous and introduces a smaller delay in computations compared to existing methods. It is automatic and does not require special adjustments based on subject characteristics. In addition, due to being recursive, the method is robust to abnormalities in the input signals. In conclusion, in contrast to current similar methods, it has the potential to be used in real-life situations, in which a single-lead ECG is available and an accurate, convenient, and inexpensive RR estimate is required in a continuous and automatic manner.