@&#MAIN-TITLE@&#
Shift selection influence in partial cycle spinning denoising of biomedical signals

@&#HIGHLIGHTS@&#
Partial Cycle Spinning (PCS) denoising method for ultrasonic signals is studied.Different rules for shift selection in PCS are proposed, compared and evaluated.Quality of denoised signals using PCS varies for different selected shifts.Quality of denoised traces using PCS can be better than using Cycle Spinning.Selection of the best shifts for PCS denoising is an open problem.

@&#KEYPHRASES@&#
Denoising,Cycle spinning,Ultrasonics,Biomedical signals,Wavelets,

@&#ABSTRACT@&#
Denoising of biomedical signals using wavelet transform is a widely used technique. The use of undecimated wavelet transform (UWT) assures better denoising results but implies a higher complexity than discrete wavelet transform (DWT). Some implementation schemes have been proposed to perform UWT, one of them is Cycle Spinning (CS). CS is performed using the DWT of several circular shifted versions of the signal to analyse. The reduction of the number of shifted versions of the biomedical signal during denoising process used is addressed in the present work. This paper is about a variant of CS with a reduced number of shifts, called Partial Cycle Spinning (PCS), applied to ultrasonic trace denoising. The influence of the choice of PCS shifts in the denoised registers quality is studied. Several shifts selection rules are proposed, compared and evaluated. Denoising results over a set of ultrasonic registers are provided for PCS with different shift selection rules, CS and DWT. The work shows that PCS with the appropriate choice of shifts could be the best option to denoise biomedical ultrasonic traces.

@&#INTRODUCTION@&#
Ultrasonic equipment is very often used in medical diagnosis. In most cases the acquired biomedical ultrasonic signals are corrupted with noise coming from the reflection of the ultrasonics by the tissue's microstructure. This noise shares spectrum with the ultrasonic signal and is usually non-stationary. The reduction of noise in ultrasonics has been widely discussed and different techniques based on spatial or frequency diversity have been proposed [1].Wavelet transform has been used for denoising different kinds of signals including biomedical ultrasonic traces [2–6]. The most common denoising techniques are based on discrete wavelet transform (DWT) defined as [7](1)DWTx(k)(j,n)=∑k=−∞∞x(k)12jψk2j−nj,n∈Zwhere x(n) is the discrete time signal to analyze, ψ(t) the mother wavelet, n2jthe shift and j the decomposition level.DWT is not a shift-invariant transform and produces different denoise results depending on the shift. To overcome this limitation undecimated wavelet transform (UWT) was introduced in ultrasonic denoising problems [8–12].(2)UWTx(k)(j,n)=∑k=−∞∞x(k)12jψk−n2jj,n∈ZBasic denoising processing using wavelets is performed in three stages. In the first stage the wavelet coefficients of the register to denoise are obtained. The second stage performs the denoising process over the wavelet coefficients, usually by using thresholding. Different types of thresholding can be used, usually soft or hard thresholding, and different threshold selection rules can be implemented, of which SURE, Universal and Minimax are the most used [13–15]. In the final stage, the denoised version of the signal is recovered performing the inverse wavelet transform with the modified wavelet coefficients.Cycle spinning (CS) is a method of UWT and has been previously used for denoising purposes [8–12]. The CS algorithm performs DWTs of shifted versions of the register to analyze, denoise the wavelet coefficients, make the inverse DWTs and perform a mean to obtain the final denoised ultrasonic A-scan. The denoised traces show better characteristics using CS than using DWT, but the complexity in the CS case is much greater than in the DWT one.CS analysis generates redundant coefficients. In [16,17], it was shown that the wavelet coefficients were repeated when the number of shifts involved in CS were higher than 2J, with J being the maximum decomposition level in DWT analysis. More recently, CS wavelet coefficient redundancy has been studied in [11]. Based on this redundancy, the use of a reduced version of CS for denoising with the processing of only a limited number of shifts is studied in this work. This algorithm is called Partial Cycle Spinning (PCS).PCS involves a selection of shifts. One previous work [10] proposed the selection of shifts in a random way for ultrasonic A-scan denoising purposes. Although random selection of shifts generated good denoising results, in this work the performance obtained with different selection rules of the PCS shifts and the influence of the selected shifts in the final denoised trace quality were studied. This current paper compares three types of shift selection: random selection, consecutive selection, and fixed sparse selection. The obtained results are compared and evaluated taking as reference the results obtained using a complete CS denoising procedure.This paper is set out in the following manner. Section 2 describes the PCS denoising method. Section 3 describes the experiments to evaluate the variability of PCS and discusses the results obtained. The conclusions are presented at the end of the paper.PCS analysis is based on the calculation of the DWT of a reduced number of shifted versions of the trace to be denoised. The wavelet coefficients obtained by performing the PCS analysis contain several sets of DWT coefficients, one set for each shift. In fact, the PCS process is similar to the CS apart from the number of the shifts used during implementation. PCS shifts are a subset of CS shifts. Fig. 1shows a schematic representation of the PCS analysis with M shifts. The denoising is performed over the wavelet coefficients at the output of this stage.The PCS synthesis performs several inverse DWTs with the wavelet coefficients associated to each shift. Each inverse DWT recovers a shifted version of the original trace which is passed through a unshift stage to recover the original trace. In fact, if wavelet coefficients have not been modified, the original trace is recovered several times, one time for each shift. In practice, wavelet coefficients are modified for denoising purposes and the last step of the process consists of performing the mean of all the recovered versions of the initial trace. Fig. 2shows the synthesis process.Denoising is applied over the wavelet coefficients at the output of the analysis stage, over coefficients ds,jand as,jof Fig. 1. A soft thresholding [18] is applied to these coefficients and the resulting denoised coefficients, d′s,jand a′s,j, which can be seen in Fig. 2, act as input for the PCS synthesis stage. Three thresholds have been used and compared to study the variability in PCS: Universal [14,15], Minimax [13] and SURE [15]. Each threshold is calculated and applied during denoising to each set of wavelet coefficients, ds,j, obtained for a shift s and a decomposition level j.The Universal threshold is calculated by the expression:(3)Ts,jU=σˆs,j2lnNjwhere Njis the number of wavelet coefficients ds,jat decomposition level j andσˆs,jis:(4)σˆs,j=mediands,j0.6745The Minimax threshold is calculated as follows:(5)Ts,jMm=σˆs,jλ*(Nj)where the value of function λ*(Nj) is obtained using Table 1 of [13].The SURE (Stein's unbiased risk estimation) threshold in the case of soft thresholding uses the risk function:(6)SURET;X=Nj−2⋅#i:Xi≤T+∑i=1NjminXi,T2where#i:Xi≤Tis the cardinality of the set in brackets.The SURE threshold is the value that minimizes that risk function (6) for the vector of transformed coefficients:(7)Ts,jS=argminT≥0SURET;ds,jσˆs,jThe differences between PCS and CS implementation methods are due to the shift selection. The objective of PCS is to reduce the number of shifts while maintaining the denoising quality of CS. A reduced number of shifts are selected in the case of PCS and three different rules for choosing the shifts are evaluated: sequential shifts, random shifts and fixed sparse shifts. In the case of sequential shifts the difference between two consecutive shifts is only one time unit while in the other cases it is greater than one. The random shift case selects the shifts in a random way over the whole range while the fixed sparse shifts method chooses the sparse shifts in a pre-determined way.The PCS procedure involves a selection of the time shifts. As a consequence there is an intrinsic variability in the denoising results depending on the shifts selected. Some results using ultrasonic traces concerning performance variability are presented in this section.Different sets of ultrasonic traces have been generated for experiments. The A-scans are formed by the addition of a normalized ultrasonic pulse to a normalized ultrasonic noise register. The ultrasonic noise registers have been simulated in the frequency domain by the expression [19]:(8)N(f)=[N1(f)f2H(f)]exp(α0f4)+N2(f)where f is frequency, H(f) is the frequency response of the piezoelectric ultrasonic transducer, N1(f) represents the scatters distribution of tissue and α0 is the frequency dependent attenuation factor with a selected value α0=1.8×10−26. N2(f) is an additive Gaussian noise included to simulate the effects of the ultrasonic and measurement systems. In the traces used in this work N2(f) contributes 33,3% to the total power of N(f).A pulse P(t) of a 1MHz ultrasonic transducer, acquired with sampling frequency 64 Ms/s, is used to complete the ultrasonic A-scans. The resulting trace is(9)TA(t)=N(t)+A⋅P(t)where parameter A is related with the signal to noise ratio (SNR) of the initial traces. SNR is defined by:(10)SNR=peakvalueintargetareastandarddeviationinthewholetraceSeveral experiments were performed using different sets of traces with controlled SNR. PCS variability performance was studied using three different selections of shifts: sequential, random and fixed. For wavelet processing, Daubechies 6 was selected as mother wavelet, the maximum decomposition level was 7 and the number of selected shifts for PCS was 8 over a maximum of 128 [11,16,17].The eight shifts selected for the sequential case were: 0, 1, 2, 3, 4, 5, 6 and 7. The shifts applied in the random PCS procedure were obtained randomly from a uniform distribution in the range 0 to 127. For the case of fixed selection of shifts, three sets of shifts were used. The shifts of set number 1 were: 0, 15, 30, 45, 60, 75, 90 and 105. The shifts of set number 2 were: 7, 21, 35, 49, 78, 92, 106 and 120. The shifts of set number 3 were: 1, 17, 33, 49, 65, 81, 97, and 113.Two quality parameters were analyzed for each experiment and threshold. The first one is the SNR defined by Eq. (10) and the second one is the mean square error defined as:(11)MSE=1L∑i=1L(x′(n)−R(n))2where x′(n) is the recovered denoised trace normalized in amplitude (see Fig. 2) and R(n) the reference trace obtained eliminating the noise component of Eq. (9) which includes the pulse normalized in amplitude without noise.Two experiments were performed to evaluate the PCS variability with shifts. In the first experiment several sets of 1000 synthetic ultrasonic A-scans were generated following Eqs. (8) and (9). To each trace 7 different denoising procedures were applied using 3 soft thresholds (Universal, Minimax and SURE), thus each trace is denoised with 21 different methods. The 7 different denoising procedures were: DWT, PCS with sequential shifts, PCS with fixed set number 1 of shifts, PCS with fixed set number 2 of shifts, PCS with fixed set number 3 of shifts, PCS with random selection of shifts and CS.Table 1summarizes the mean values and standard deviations of the resulting SNRs and MSEs for a set of 1000 A-scans with a mean SNR of 4.83. The results are classified depending of the threshold used: Universal, Minimax and SURE. The eight rows contain the results for different types of processing. The first row shows the results of the original traces without processing. Five rows include results of PCS with different selections of shifts. Additionally, the denoising results obtained for the same set of A-scans but using CS and DWT denoising algorithms are included to compare performances.Results from Table 1 show that, in general, the Minimax threshold obtains better results than the SURE and Universal thresholds. The mean SNR is the highest for the Minimax threshold in all the cases, while the standard deviation of SNR is the lowest for SURE threshold. The lowest MSE mean and standard deviation are distributed between Minimax and SURE thresholds. The best MSE values correspond to Minimax threshold for the most of the cases with higher mean SNR values.The results of Table 1 are very regular except in the case of MSE for the Universal threshold. These anomalies are due to the fact that in some registers the pulse sought is lost during the denoising process. In the registers without pulse, the normalization amplifies noise components and then MSE has a high value.Five shifts selection cases are evaluated for PCS denoising. The worst performance, very close to DWT performance for all the thresholds, is obtained for PCS with sequential shifts. A possible explanation for this is that a selection of fixed sequential shift values can be considered as a particular case of PCS with very bad shift selection. In all PCS cases the number of shifts is the same but in the cases of fixed PCS and random PCS the shifts are distributed over the whole range. Fixed and random PCS procedures show the benefits in robustness obtained from the average of a few shifts which are distributed over the whole range. On the other hand, random PCS presents variability in repeated execution which could be useful in some applications.The selection of shifts affects the denoising results. Table 1 shows three different types of results using PCS with fixed shifts. When shift set 1 is used the results are worse than results using CS. However, the results, when shift sets 2 and 3 are used, are similar to the CS results or even better. This variability is due to PCS being obtained as the mean of a set of denoised shifted versions of the initial A-scan; these denoised versions include good and bad denoised shifted traces. If only good denoised versions could be selected, the recovered PCS denoised traces would have better quality than the CS denoised traces. CS denoised traces were obtained as the mean of all (good and bad) shifted denoised versions of the initial A-scan. The problem is how to select the shifts that generate the best denoised registers. In this experiment the pulse sought is always in the same position, so with a trial and error method an adequate set of shifts can be selected. However the same set of shifts is not valid for all the thresholds. In Table 1, shift set 3 generates the best results for Universal and Minimax thresholds, but the best results for SURE threshold are obtained with shift set 2. Thus PCS denoising with an adequate selection of shifts can obtain better results than CS denoising. However, the optimal selection of shifts in PCS is an open problem that will need more research in the future.From the results shown in Table 1 it can be concluded that the PCS is a good alternative to CS in denoising applications. PCS can obtain results very similar or even better than CS algorithm if the selection of PCS shifts is appropriate. The PCS shift selection must be carried out over the whole set of shifts and additional research is necessary to find the method to select the optimal shifts.A second experiment was carried out to study the variability of the denoising results depending of the selection of shifts for the PCS procedure. The selected denoising procedure for this experiment was random PCS in order to generate the set of shifts without any conditions. The experiment performed the PCS denoising procedure to one A-scan with 1000,000 different sets of shifts. The resulting SNR and MSE variability are evaluated. One of the A-scans used in Table 1 was selected and 1000,000 sets of 8 shifts were calculated in a random way. The objective was to cover a great range of sets of shifts, not the total, because the total number of possible sets of shifts is approximately 5.8×1016 for 8 selected shifts and a decomposition level in the wavelet transform of 7. Mean and standard deviation of SNR and MSE for the 1000,000 sets of shifts are shown in Table 2.Results confirm the variability depending on the shifts involved during the PCS process. In both SNR and MSE data the standard deviation and the difference between maximum and minimum values show values that imply a variability. On the other hand the best SNR and MSE mean values are for the Minimax threshold.To show graphically the influence of the thresholds, Fig. 3represents the initial A-scan used in Table 2 and the results after denoising using the PCS method with the fixed shift set number 2. Results after applying Universal, SURE and Minimax thresholds are shown. The pulse sought is approximately between points 2100 to 2400 of the register, with the rest of the trace components being due to noise.A second figure is included to show how the different processing methods affect a denoised A-scan. The selected threshold is SURE and the rest of parameters are the same as those used in previous experiments. Fig. 4shows different denoising results from initial A-scan to processing with CS. Display 4d deserves special attention as in this case a SNR greater than in the case of CS (4f) is obtained using shift set 2 defined previously.

@&#CONCLUSIONS@&#
This paper has presented PCS as alternative to CS for signal denoising applications. PCS is based on CS but in this implementation a reduced number of shifts must be selected. The selection of the shifts has a clear effect on the final denoising results.Three rules for the shift selection in PCS implementation have been studied: sequential shifts, random shifts and fixed sparse shifts. The PCS procedure with the three different kinds of shifts was applied to a set of ultrasonic A-scans, and the results were analyzed, taking as quality parameters the SNR and MSE of the denoised signals. The results, for fixed PCS and random PCS cases, confirmed SNRs and MSEs are very similar to those obtained by the CS denoising method. The sequential PCS method showed poorer performance than the other two procedures, thus the best selection options for PCS shifts are random and fixed distributed over the whole range of shifts.A second experiment was performed to study the PCS variability. In the experiment 1000,000 different sets of shifts were applied over the same ultrasonic A-scan, using in all cases the PCS denoising method. The results confirm the variability in the results with the shifts used during denoising.The PCS procedure for denoising purposes can obtain similar results to the CS method. To obtain good results with PCS, the shifts must be selected in a sparse way. Intrinsic variability is associated with PCS, but this variability in general is small for sparse shifts. Thus, PCS can be considered as a robust and efficient denoising procedure with a level of performance close to that of CS but with lower complexity.In some special cases the denoising results with PCS can be better than results obtained with the CS denoising procedure. This is due to the dependence of denoised trace quality on the selected shifts during the PCS process. The way of selecting the best shifts to optimize the denoising process is an open problem that will need more research in the future.