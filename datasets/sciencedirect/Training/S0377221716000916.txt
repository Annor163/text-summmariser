@&#MAIN-TITLE@&#
A column generation approach for solving the examination-timetabling problem

@&#HIGHLIGHTS@&#
We present a student-centric ETP with improve exam spread by dynamically allowing more versions of exams.We propose two column generation algorithms to solve exam-timetabling problems.Both models include dynamic spreading of exams by using spreading costs.Second model has post-processing: either by heuristic or integer program(IP).Model 2 performs marginally better than Model 1, but is less scalable.Student spreading costs for existing data sets were improved at the cost of more exam versions.

@&#KEYPHRASES@&#
Timetabling,Examination-timetabling problem,Column generation,Exam spreading,

@&#ABSTRACT@&#
In this paper, we approach the Examination-Timetabling Problem (ETP) from a student-centric point of view. We allow for multiple versions of an exam to be scheduled to increase the spreading of exams for students. We propose two Column Generation (CG) algorithms. In the first approach, a column is defined as an exam schedule for every unique student group, and a Pricing Problem (PPs) is developed to generate these columns. The Master Program (MP) then selects an exam schedule for every unique student group. Instead of using branch-and-price, we heuristically select columns. In the second approach, a column consists of a mask schedule for every unique student group, and a PP is developed to generate the masks. The MP then selects the masks and schedules exams in the mask slots. We compare both models and perform a computational experiment. We solve the ETP at KU Leuven campus Brussels (Belgium) for the business engineering degree program and apply the models to two existing datasets from the literature.

@&#INTRODUCTION@&#
Examination timetabling is a recurring and time-consuming task in educational institutions (Qu, Burke, McCollum, Merlot, & Lee, 2008), and is defined as “the scheduling for the exams of a set of university courses, avoiding overlap of exams of courses having common students, and spreading the exams for the students as much as possible” (Schaerf, 1999). Examination timetabling has to deal with many requirements, which include: no clashes for students, a fair exam schedule with sufficient study time in between exams, preferences of lecturers, and availability of classrooms. Within those requirements, two types of constraints can be distinguished (Qu et al., 2008), namely soft and hard constraints. Some survey articles also define them as first-order and higher-order constraints (Schaerf, 1999) or primary and secondary constraints (Carter, 1986). Hard constraints (equivalent to first-order and primary constraints) are constraints that must be satisfied at all times. Soft constraints (equivalent to higher-order or secondary constraints) only need to be satisfied as much as possible. Qu et al. (2008) point out that the extent to which soft constraints are met, defines the quality of a timetable. This quality aspect is also the key difference between search and optimization problems as described by Schaerf (1999). Search problems only try to find a feasible solution by satisfying the hard constraints, while optimization problems try to find an optimized feasible solution. The main difference between the search and optimization problems is therefore the capability to incorporate soft constrains. This paper presents two models that handle the latter type of Examination-Timetabling Problems (ETPs). However, contrary to the definition by Schaerf (1999) and the examination-timetabling literature in general, many universities schedule several versions of the same exam to further satisfy the soft constraints. Multiple versions of the same exam are created (1) to ensure that students do not have two exams at the same time, and (2) to improve the exam spread. Our models incorporate a trade-off between multiple versions of exams and the soft constraints such as spreading.The many requirements imposed on ETPs impede manual timetabling. Automated timetabling has therefore been a highly researched topic in operational research (Qu et al., 2008). However, ILP models of ETPs cannot be solved with modern-day computers, as the number of variables in the LP model is too large. On top of that, examination timetabling has been proven to be NP-complete when introducing certain characteristics (Cooper & Kingston, 1996). For example, imposing constraints concerning the equal spread of exams, or dealing with the many different students who have shared courses increases the complexity of the problem immensely.This paper addresses the above issues from a more student-centric point of view. A trade-off function is used to create timetables for each student group separately, while trying to minimize extra exam versions being created. Existing methodologies schedule exams while trying to minimize the total spreading cost. We propose two algorithms that decompose the problem by using a Column Generation (CG) approach. Our first algorithm defines a column to be a complete examination timetable for every student group. The second algorithm defines a column to be a timetable containing examination time slots or mask slots without specifying the exams themselves. It constructs the final timetables by scheduling exams and taking the mask slots into account. The second model needs a post-processing step to construct the final timetables. The algorithms thus transfer a different part of the problem's complexity to the sub-problems. We compare both approaches in a computational experiment. We also apply both models to two existing datasets from the literature.The remainder of this paper is organized as follows: in the second section, we state our problem description and link this to the existing literature. We also give a brief overview of the techniques used to solve the ETP. The third section presents our first CG approach and the fourth section our second. We report the results in the fifth section. The last section concludes the paper with the most important findings and with directions for future research.In this section, we present the ETP and the existing methodologies. We focus on the requirements defined in well-known problems and on existing literature related to the application of CG to ETPs.Educational institutions basically have two systems of offering classes to students. The first is the curriculum-based system in which the student follows a predefined curriculum for which the timetable has already been created (Demeester, Bilgin, De Causmaecker, & Van Den Berghe, 2012). The other system is a post-enrollment system, in which the timetables are produced after the students have selected their courses. In curriculum-based universities, it is easier to produce examination timetables because exams are only shared between several homogeneous groups. In post-enrollment universities, exams are shared between many different students who all have different curricula. European universities are typically a curriculum-based environment, but are incorporating more and more post-enrollment elements. Students follow a curriculum, but can make changes to their curriculum to widen their scope, to slow down or increase the pace, etc. In this setup, we aim to automate the examination timetabling, while optimizing exam spread for students and minimizing the number of times an exam is scheduled. For our problem setting, we define a unique curriculum as a set of exams for a unique student group. Exams in these sets can be shared across multiple unique curricula. If multiple students take the exact same set of exams, they form a unique student group. The group is indivisible, so exams are always scheduled for an entire student group. Multiple groups can take the exam at the same time, but this is not a requirement. Multiple versions of an exam are therefore possible. An exam version is an instance of an exam scheduled at a specific time slot. The number of versions is equal to the number of time slots for which the exam is planned.The ETP is well known in the timetabling literature. Many articles in the proceedings of the PATAT (Practice and Theory on Automated Timetabling) conferences relate to this topic. Subsequently, a EURO (European Association of Operational Research) Working group on Automated TimeTabling (WATT) was established (Burke, Jackson, Kingston, & Weare, 1997). Qu et al. (2008) give an elaborate review of the problem and discuss several datasets: the Toronto dataset (a, b, c, d, and e), the Nottingham dataset (a and b), and the Melbourne dataset (I and II). An elaborate overview of the studies performed per type of problem is also provided. In 2007, PATAT and WATT issued an international competition specifying a problem now known as the ITC2007 problem (Queen's University of Belfast 2007) where the goal function, soft constraints, hard constraints, and datasets were defined.In this section, we discuss the requirements of our problem definition and link them to requirements of the existing problems in the literature.The model should try to spread the exams as evenly as possible for every student group. Many other studies have incorporated this, ranging from a static approach such as not having two consecutive exams on the same day or overnight (Burke, Newall, & Weare, 1998; Qu et al., 2008; Wijgers & Hoogeveen, 2007), to a more dynamic approach attributing spreading costs relative to the number of time slots between two exams. Problems Toronto c, Toronto e, and Nottingham a include a static spreading requirement in which students cannot have two (consecutive) exams on the same day. Problems Toronto d, Nottingham b, Melbourne I, and Melbourne II extend this and penalize consecutive exams on the same day and overnight. Laporte and Desroches (1984) introduced a dynamic spreading approach and utilized a cost parameter wsfor each pairwise combination of exams that are s time slots apart. These costs have been defined asw1=16,w2=8,w3=4,w4=2, andw5=1. The Toronto b problem evaluates the exam spread using the same dynamic spreading costs. Bullnheimer (1998) achieves dynamic spreading by maximizing study time instead of minimizing spreading costs. The ITC2007 problem both requires static and dynamic spreading. The total cost takes into account the number of times students have two subsequent exams as well as the number of times students have two or more exams within a predefined number of time slots. The Toronto a problem does not include any spreading measures. We employ a dynamic spreading cost as defined by Laporte and Desroches (1984). Our problem relates best to the Toronto b set, of which we will use two instances to test the performance of the models presented in this article.To honor the first requirement, one could schedule a new version of an exam for every unique student group, but this is undesirable. Every version requires new exams to be drawn up by the lecturer and requires other practicalities such as the presence of lecturers at the examination of every version. Contrary to standard ETPs, most European universities schedule multiple versions of an exam. We did not encounter any previous research that incorporated this into the automated-timetabling algorithms. Surely, in current methodologies multiple versions of exams can be created for different student groups to ease the scheduling, but not dynamically. Our models optimize a trade-off between scheduling an exam more than once and maximizing exam spread. Since this trade-off is not present in the literature, our article does not relate to the existing datasets for this aspect.Given a finite number of rooms with a finite capacity, the total capacity must be respected. The exam capacity is equal to the maximum number of students that can take an exam at the same time slot. This is a very common constraint in the literature but not every study takes this into account. Only Toronto e and the Nottingham sets specify that the total room capacity should not be exceeded (Qu et al., 2008). Contrary to these aggregated capacities, the ITC2007 problem requires that exams are assigned to rooms and that individual room capacities must be respected. Our models do not schedule exams to individual rooms. We therefore use aggregated room capacities.Extensive overviews of ETP-solving methodologies are available in several survey articles. Carter (1986) discusses the application of graph theory to ETPs, with a focus on heuristics that use graph-coloring. Schaerf (1999) defines the difference between school timetabling problems, University Course Timetabling Problems (UCTPs), and ETPs. The article also includes a list of previous survey articles. For ETPs, Schaerf (1999) reviews direct heuristics, graph-coloring, simulated annealing, genetic algorithms, and several other methods. Burke and Petrovic (2002) contribute to the literature with an overview of these topics and also discuss constraint-based techniques, tabu search, hyper heuristics, and population-based techniques such as evolutionary algorithms and ant algorithms. Qu et al. (2008) update this effort. Many techniques have thus already been applied to the ETP.Mixed Integer or Integer Programming (MIP or IP) formulations are straightforward to set up, but they are constrained in their operation by the size of the problem. Examples are an application at the university of Kuwait (Al-Yakoob, Sherali, & Al-Jazzaf, 2010) and a quadratic programming model by Bullnheimer (1998). Direct heuristics mostly mimic human action and improve an initial integer solution by altering one element at a time (Schaerf, 1999). Laporte and Desroches (1984) use a heuristic that first solves a basic MIP and then takes care of classroom requirements and the need to spread the exams. Dimopoulou and Miliotis (2001) use a heuristic algorithm to first schedule the exams and then improve the solution to satisfy other constraints in a similar manner to Laporte and Desroches (1984). Recently, Arbaoui, Boufflet, and Moukrim (2015) present new preprocessing stages and an improved MIP model for the examination timetabling problem of ITC2007. The preprocessing stages exploit an exam-based conflict graph, together with hard constraints and room capacities, to reveal implicit conflict constraints between exams even when they have no students in common.Graph-coloring formulations have been applied since 1967 (Qu et al., 2008). In these formulations, exams are represented by vertices and time slots by colors. Two nodes are connected by an edge when they share resources and cannot be scheduled for the same time slot. When coloring the graph, two adjacent vertices cannot receive the same color. Two exams that share, for example, the same students cannot be scheduled on the same day (Mehta, 1981). Carter (1986) focuses his review article on possible tactics concerning which node to color first. Wijgers and Hoogeveen (2007) use graph coloring to create “sub-exam schedules”, a list of non-clashing exams for each time slot in their CG algorithm. Qu, Burke, and McCollum (2009) create a hyper-heuristic which selects the best method for coloring the nodes. The basic graph-coloring problem was also solved using CG by Mehrotra and Trick (1996), which makes it possible to solve large-scale basic ETPs where only a clash-free exam schedule has to be found. A recent example of a graph-coloring-based heuristic applied to an ETP, is the work of Kahar and Kendall (2010). They also compare the different requirements for the different ETP definitions. Abdul-Rahman et al. (2014b) assign a score for the difficulty of scheduling each examination using an adaptive linear combination of two graph-coloring heuristics and examinations are scheduled in an order based on this value.Another category of solution methods consists of local search approaches. They are often combined with population-based techniques to search the solution space around initial feasible solutions. Popular local search techniques are simulated annealing (Zhang, Liu, M'Hallah, & Leung, 2010), great deluge (Kahar & Kendall, 2014), and tabu search (Kendall & Hussin, 2005; Pais & Amaral, 2011; White, Xie, & Zonjic, 2004). Examples of population-based methods are genetic algorithms (Burke, Eckersley, McCollum, Petrovic, & Qu, 2010), memetic algorithms (Al-Betar, Khader, & Abu Doush, 2014), ant-colony algorithms (Dowsland & Thompson, 2004), particle swarm optimization (Marie-Sainte, 2015), and bee colony algorithms (Alzaqebah & Abdullah, 2014; Alzaqebah & Abdullah, 2015; Sabar, Ayob, Kendall, & Qu, 2012). A comparison between different meta-heuristics applied to the ETP can be found in an article by Azimi (2004). The graph-coloring problem was also solved using local search approaches (Burke et al., 2010, 2007, 2005; Qu et al., 2009). Recently, Abdul-Rahman, Burke, Bargiela, McCollum, and Özcan (2014a) present a local search heuristic that decomposes the examinations into two sets: a set of difficult to schedule and a set of easy to schedule examinations. These sets are dynamically updated during the construction of a timetable to ensure earlier assignment of examinations that lead to infeasibilities in subsequent attempts. Moreover, the examinations within each set are ordered using different strategies based on graph coloring heuristics. Li, Bai, Shen, and Qu (2015) propose an evolutionary ruin and stochastic rebuild search algorithm in which optimization is achieved by an iterative process of component evaluation, solution disruption and stochastic constructive repair.A last class of frequently used methods are hyper-heuristics, which combine different simpler heuristics. Instead of using only one heuristic, the problem at hand instructs the algorithm which (part of a) lower-level heuristic might be the most effective (Qu et al., 2009). Hyper-heuristics are increasingly utilized to generalize the method for solving ETPs (Demeester et al., 2012; Gogos, Alefragis, & Housos, 2010; Malik, Othman, Ayob, & Hamdan, 2011; Sabar et al., 2011; Soghier & Qu, 2013, Burke, Qu, & Soghier, 2014, Qu, Nam, Bai, & Kendall, 2015).In addition to the previous categories, some authors are also researching the possibility of parallelizing the optimization process of the ETP, to make greater use of distributed computing (Komar, Grbic, & Cupic, 2011; Mansour and Sleiman-Haidar, 2011). Algorithms are designed to break up and work on different parts of the problem in parallel to speed up the optimization process.Our models are based on CG. A Master Problem (MP) selects partial solutions (grouped decisions) that are grouped into one decision variable or a column. CG tries to solve large-scale Linear Programs (LPs) by only looking at a part of the possible columns and generating new columns that improve the goal function value. It decomposes the problem into a Restriced Master Problem (RMP) that constructs a solution, given available feasible columns, and a subproblem that generates new columns. Except for a technical report by Wijgers and Hoogeveen (2007), CG has not yet been applied to the ETP. CG can be defined as an algorithm that permits solving LP problems containing a huge number of variables of which many are non-basic. It deals with the complexity through decomposition and iterative improvement of a feasible solution. The technique has already been applied to other scheduling problems like the UCTP which is a problem similar to the classic ETP. For instance, CG has successfully been applied to a UCTP in Italy (Qualizza & Serafini, 2005). Wijgers and Hoogeveen (2007) first try to minimize the number of time slots using a CG approach. Their goal is to find a non-clashing schedule, indicating that no student has two exams at the same time. In their research, a column represents a schedule of non-clashing exams for one time slot. The model tries to minimize the number of columns (time slots) needed so that all exams are scheduled and students have a complete examination timetable. Note that this method does not assign a column to a specific time slot, as a column is generated for a random time slot. In the second part of their research, Wijgers and Hoogeveen (2007) are able to include availability of lecturers and to avoid a situation where students have two exams in one day. The columns (or schedules) are defined slightly differently. A column is now a schedule for one day and contains two time slots, so that the student day constraint is easy to incorporate. In order for lecturers to express their availability, columns are specific to a certain day. The model no longer minimizes the number of time slots, but it minimizes the artificial cost associated with choosing a schedule under the constraints mentioned above. The authors were unable to incorporate a dynamical spread of the exams. This inability is a direct result of the definition of a column. The spreading of exams is nevertheless very important for students. Our method therefore differs from the method of Wijgers and Hoogeveen. We transfer the complexity of the dynamic approach of minimizing spreading costs to the Pricing Problem (PP). A column is defined per unique student group, for which the spreading cost is calculated. The Master problem (MP) then selects a combination of columns that minimizes the weighted spreading and exam version costs, taking into account the room capacities. To avoid a situation in which some exams get an excessive number of exam versions (whereas others have only one version) we also assign a penalty to the maximum number of exam versions over all exams. In this way additional exam versions are spread over all exams.In this section, we present the first model. We first define the columns that are used and we discuss the MP. Then, we cover the reduced cost of a column in this model and present a PP to generate these columns. We conclude this section with an overview of the algorithm that heuristically selects the columns in a process we call “fixing”.Our first model is the most intuitive. We use a complete schedule for a unique student group s as a column with index q. A column consists of a binary matrixAsqwhere the columns represent the time slots and the rows represent the exams taken by student group s. The elements of the matrix, namely asqet, denote that exam e is scheduled at time slot t when the element equals 1, and 0 otherwise.(3.1)timeslots:12345678exame{=abAsq=(0000100010000000)The above example (3.1) shows a matrix for a fictional unique student group that has exams a and b within a period of eight time slots. In the example, asqa5 and asqb1 equal 1, indicating that the student group takes exam a at time slot 5 and exam b at time slot 1. Each exam schedule column has a cost representing the fictional spreading cost. This costcsqSis defined in the PP in Section 3.4.This model's MP will select the most beneficial combination of exam schedules, one for each unique student group. The MP trades off the cost of additional exam versions against the cost of a worse schedule for students, and treats the room capacity as a hard constraint. The MP is shown in (3.2)–(3.11) and uses the following definitions:Sets and indicesEIs the set of exams, index e.Is the set of student groups, index s.Is the subset of exams for unique student group s, ∀s ∈ S: Es⊆E.Is the subset of student groups that take exam e, ∀e ∈ E: Se⊆S, index sIs the set of time slots, index t.Is the set of schedules (columns) generated for student group s, index q.Binary, equals 1 if timetable q for student group s schedules exam e at time slot t.Cost of scheduling an extra exam version.Cost of the maximum additional exam versions over all exams.Cost of choosing schedule q for unique student group s, a function of study-time fairness.Number of students in student group s.Number of student groups taking exam e.Total exam capacity of rooms.Binary, equals 1 if schedule q is chosen for student group s.Binary, equals 1 if exam e has a version scheduled at time slot t.Number of student groups in Senot taking a scheduled version of exam e at time slot t.Maximum number of additional exam versions.Dual prices for scheduling an exam e at time slot t due to version costs.Dual prices for not scheduling student groups when a version for exam e at time slot t is scheduled.Dual price for scheduling at time slot t, due to room capacities.Dual price for scheduling a timetable for student group s.The goal function in Eq. (3.2) minimizes the total cost of exam versions and of the students’ schedules. The first two terms are the costs for scheduling exams. During preliminary testing of this model, we encountered unbalanced outcomes. Some exams had up to six versions in a certain test case, while others had only one. We therefore added a variable N to the MP, which counts the maximum number of additional versions of any exam in the solution. The first term attributes a cost to N. The second term attributes a cost to the number of groups not taking an exam at the same time slot as the other student groups taking that exam. We use this as a proxy for extra exam version costs, as the absent student groups in one time slot will need at least one additional version of that exam at another time slot. We thus attribute the cost of an exam version to this. The last term incurs the total spreading costs for students. We weigh the cost of the student group exam schedules by the number of students in that group. The set of constraints in Eq. (3.3) forces a version to be scheduled at a time slot if at least one student group takes the exam at that time slot. We use a binary variableϵetVto assign a version of an exam when at least one unique student group has exam e at time slot t. A big-M constraint is used, because this aggregated formulation of master constraints reduces the tailing-off effect traditionally found in CG (Vanderbeck, 2005). This, however, does result in a less tight lower bound when relaxing the MP (Bosch & Trick, 2005). Instead of an arbitrary big value for M, we limit this effect by using the number of student groups taking that exam. In constraint (3.4), we then count the number of absent student groups for each exam version that is scheduled. Constraint (3.5) ensures that the total room capacity is not violated. For each student group, the MP will select exactly one exam schedule, which is ensured by (3.6). The dual prices used in the PP are listed next to each constraint. The integer constraints are defined in (3.8) and (3.10) for, respectively, the selection of columns and the scheduling of exam versions. We exclude scheduling exam versions on Saturday afternoons and on Sundays. Furthermore, a cost cNis incurred to variable N in the goal function and we add (3.7) and (3.11). These additions make sure that N equals the maximum number of additional versions over all exams and that it is minimized in the goal function.To obtain the dual prices, we relax the IP to an LP and replace (3.8) and (3.9) with (3.12) and (3.13). The relaxation enables the algorithm to calculate dual variables and a reduced cost ksqof a column q for student group s. The cost for a new exam schedule is defined bycsqS. The reduced cost ksqof column q for student group s, is given by (3.14) and is minimized in the PP to find new columns that can decrease the goal function value of the MP. A new column will only be added to the MP when its reduced cost is negative, i.e., when the beneficial impact outweighs the cost of the column).(3.12)αsq∈[0,1],∀s∈S,∀q∈Qs(3.13)ϵetV∈[0,1],∀e∈E,∀t∈T(3.14)ksq=csqS−∑t∈T∑e∈Esasqet(λetT−λetN+nsSλtR)−λsSEvery iteration, the algorithm searches for a new column (exam schedule) for every unique student group that has the largest possible gain, i.e., the largest negative reduced cost). The columns make it possible to transfer some of the requirements to the PP, which results in a less complex MP. The transferred requirements are the two constraints of exam spreading for students. In this section, we model the PP as an IP to search for new columns by minimizing the reduced cost.We use a cost definition as defined in (3.15), created by Laporte and Desroches (1984) and formalized by Qu et al. (2009). Parameter C is a cost factor and I is the ideal number of time slots between two exams. The exponent in (3.15) measures the difference between the ideal number of time slots and the actual number of time slots between two exams. If a student has more time slots between two exams, the exponent will be negative, which results in a cost lower than 1. If a student group has fewer time slots between exams, the exponent is positive and a larger cost will be incurred. By defining a variable parameter I per student group, one can adapt this to the number of exams in that unique curriculum. However, to adhere to existing literature, we use the cost definition as defined in the article by Qu et al. (2009). The method defines costs withC=2andI=5, for study times up to 5 time slots.(3.15)ct′,tspread=CI−(t−t′)We use Eq. (3.16) to calculate the impact of scheduling an exam e at time slot t on the reduced cost for student group s.(3.16)Ket=−λetT−nsSλtRThe PP that tries to find a new column for student group s is formulated in (3.17)–(3.23). The model uses the previous definitions with the following additions:ParametersKetImpact on reduced cost for scheduling exam e at time slot tBinary, equals 1 if exams are scheduled at time slots t andt+uBinary, equals 1 if exam e is scheduled at time slot tGoal function (3.17) minimizes the reduced cost. We use constraint (3.18) to make sure that every exam from the curriculum is scheduled exactly once and use constraint (3.19) to exclude these exams being scheduled at the same time slot. Constraint (3.20) takes into account the spreading costs when two exams are scheduled u time slots apart. Constraint (3.21) does the opposite and is a valid inequality to solve the MIP faster. We define the domain of the binary variables in (3.22) and (3.23).The elements asqetof the columns' matrixAsqare determined using (3.24). The costcsqSof the column is determined by the spreading costs and is given in (3.25).(3.24)asqet=κet(3.25)csqS=∑t∈T∑u∈1..5:t+u≤|T|cuspreadδtuTransferring the complexity of the spreading costs to the PP increases the flexibility to incorporate many requirements such as the spreading of exams. When testing the model, we found that the PP is still somewhat time-consuming on modern-day computers, demanding on average half of a second of computation time.The algorithm for the first model is based on a standard CG-scheme. The MP selects the individual exam schedules (columns) for student groups and schedules exam versions when the selected exam schedules require them. The dual prices from the relaxed MP are used in the PP to create a new exam schedule for a student group that is added to the MP. Fig. 1 outlines the algorithm in a flowchart. CG must start with a feasible solution so that at least all hard constraints are satisfied. This can be achieved using methods such as the clique-partitioning method of Liu, Zhang, and Chin (2011), which provides a feasible starting solution. Another possibility is to use a dummy solution that satisfies all constraints, but that is only selected at a big-M cost. We start by solving the relaxed RMP using a set of dummy columns that give us a first solution. This results in the necessary dual prices needed in the PP to search for new columns, or exam schedules. New columns that improve the RMP will be added to the RMP if the reduced cost ksqof the column is strictly negative. If new columns are found, the RMP including these new columns is rerun, resulting in new dual prices. We then start the search for new columns again for every student group. This process is repeated until no columns are found and our relaxed RMP is fully solved.An optimal relaxed MP does not necessarily contain the columns needed in an optimal integer MP-solution. For this to be guaranteed, a time consuming branch-and-price algorithm is needed as discussed in Barnhart, Johnson, Nemhauser, Savelsbergh, and Vance (1998). Our algorithm heuristically selects a time slot at which a version for an exam is scheduled. The time slot of an exam that has the highest value ofϵetVin the relaxed MP is fixed. New columns are then generated, while forcing exams to be scheduled at those time slots. Extra versions from existing columns are still allowed, but at an extra cost. Fixing a time slot for exams is done in batches, after which the new columns are generated. If a time slot is fixed for a specific exam, other exams that share students are excluded from being fixed at that time slot. Exams that share students with exams in the current batch of fixing, must also wait for the next batch so that new columns can be found for those student groups. In one batch of fixing examination time slots, time slots are fixed for as many as possible exams. The order of fixing for exams is determined by the number of potential conflicts with other exams. The exams with the highest number of potential conflicts are fixed first. We define a potential-exam-conflict matrix with dimensions E × E. The elementsye1e2count the number of potential conflicts between the two exams by counting the number of shared student groups, and is defined in (3.26), where xesequals 1 if student group s takes exam e, and 0 otherwise.(3.26)ye1,e2=∑s∈Sxes1xes2This matrix is inspired by the conflict matrix proposed by Cole (1964), in which the elementsce1,e2equal 1 if exam e1 has students groups in common with exam e2. Contrary to this binary logic, the elements in our matrix count the number of potential conflicts. We define the number of potential conflicts for an exam e1 asYe1in (3.27).(3.27)Ye1=∑e2∈E∖{e1}ye1e2For exam e1, we fix the time slot with the highest value ofϵe1tV. We also remove the exam from our potential-exam-conflict matrix, since it has already been scheduled. Next, we reoptimize the RMP to take into account the newly fixed examination time slot.This process is repeated until all exams have been fixed (and thus received a timetable). Finally, the RMP is solved as an IP to obtain the final values forϵetand αsqand the goal function value.In this section, we discuss our second model. This model uses a mask with “mask slots” as a column. A mask slot is a time slot at which the student group is scheduled to take an exam from its curriculum.Column q for unique student group s is a vectorVsq. Its binary elements vsqtdefine the mask slots at time slots t for student group s. If vsqtequals 1, student group s will take an exam at time slot t. In the example (4.1) below, student group s takes its three exams at the first, fourth, and eighth time slot. The number of assigned time slots is always equal to the number of exams in the curriculum Es.(4.1)timeslots:12345678Vsq=[10010001]Every column has a cost, which is equal to the spreading costscsqSas discussed in Section 3.2.The MP assigns versions of exams to time slots and minimizes the number of versions by using masks as columns. We again select the most beneficial combination of columns in order to schedule the exam versions at the time slots when student groups are available. Explicitly assigning exam versions for student groups would result in a very large MP. We tested the idea of assigning exam e to student group s and time slot t with binary variableϵest, which proved to be very time-consuming when imposing integrality constraints. Instead, we implicitly schedule exams for student groups. Exams are “overscheduled” when an exam version is scheduled, but the student group cannot take the exam at the scheduled time slot. Overscheduling can be the result of one of the following two reasons: either the student group does not have a mask slot scheduled at that time slot, or another exam version from that student group's curriculum is already scheduled at that time slot. We minimize the number of times exams are overscheduled for a student group. For each time slot t, variable Ystcounts the number of overscheduled exams for the curriculum of student group s. As the overscheduling results in extra versions to be created at another time slot, we attribute a cost of scheduling extra exam versions. This has two effects. Firstly, this approach loses the ability to differentiate the cost of each version depending on the weight exam in a student's curriculum. Secondly, as the scheduling of exam versions for students is done implicitly, the goal function does not calculate the total costs in the same manner as the first model. The actual total cost is calculated in a post-processing step (see Section 4.6). The MP minimizes the total cost that consists of the cost of overscheduling exam versions and the spreading costs for students. The MP is described in (4.2)–(4.11) and uses the following definitions:SetsEIs the set of exams, index eIs the set of student groups, index sIs the set of exams for unique student group s, ∀s ∈ S: Es⊆EIs the set of student groups that take exam e, ∀e ∈ E: Se⊆S, index sIs the set of time slots, index tIs the set of masks (columns) generated for student group s, index qCost of scheduling an extra exam versionCost of the maximum additional exam versions over all examsCost of choosing mask schedule q for unique student group s, equals spreading costs for studentsNumber of students in student group sTotal exam capacity of roomsBinary, equals 1 if an exam can be scheduled for student group s at time slot t in mask qBinary, equals 1 if schedule q is chosen for student group sBinary, equals 1 if exam e has a version scheduled on time slot tMaximum number of additional exam versionsContinuous variable, number of overscheduled exams for student group s at time slot tDual price for a mask slot for student group s at time slot t, due to overschedulingDual price for scheduling at mask slot t, due to room capacitiesDual price for scheduling a timetable for student group sThe goal function (4.2) minimizes the total costs. As in Model 1, we weigh the spreading cost of the columns according to the number of students in the student group. Constraint (4.3) makes sure that every exam has at least one exam version. Decision variable Ystis calculated in constraint (4.4). We are unable to use aggregation on this constraint to counteract the tailing-off effect, as our dual prices would only offer information either per time slot or per student group to the PP. In (4.5) we include the room capacity constraint. Constraint (4.6) imposes that every student group is associated with exactly one mask schedule. Integrality definitions for mask selection variables and exam version variables are included in (4.8) and (4.10). During testing, we again found unbalanced solutions in exam versions as was the case in Model 1. We therefore added decision variable N, which counts the maximum number of additional versions over all exams in the solution. We add the cost of the maximum additional exam versions to the goal function and add constraint (4.7). We also define the domain of N in (4.11).This formulation has some drawbacks. Because exam versions are not explicitly assigned to groups, there is no guarantee that a student group receives a complete exam schedule. In the students’ mask slots, some exams from their set of exams may be scheduled multiple times whereas it is possible that others are not scheduled at all. Therefore, post-processing of the results is required.To obtain the dual prices, the integrality constraints (4.8) and (4.10) are replaced with (4.12) and (4.13). Model 2 leads to the reduced cost ksqfor a new column q for student group s, specified in (4.14). The cost at which the new exam schedule for student group s is selected is defined bycsqS.(4.12)αsq∈[0,1],∀s∈S,∀q∈Qs(4.13)ϵetV∈[0,1],∀e∈E,∀t∈T(4.14)ksq=csqS−∑t∈T(λstE+nsSλtR)vsqt−λsSWe use a PP similar to the first PP proposed for Model 1 in Section 3.2 to find a column with the largest negative reduced cost. The PP is now only concerned with the mask slots in which the exams are to be scheduled. The spreading costs are calculated as in (3.15). The impact of creating a mask slot at time slots t on the reduced cost is defined in (4.15).(4.15)Kt=−λstS−nsSλtRThe PP for student group s is formulated in (4.16)–(4.21). The model uses the previous definitions with in addition:ParametersKtImpact on reduced cost for scheduling a mask slot at time slot tBinary, equals 1 if mask slots are scheduled at time slots t andt+uBinary, equals 1 if a mask slot is scheduled at time slot tGoal function (4.16) minimizes the reduced cost. Constraint (4.17) enforces that the new column contains exactly as many mask slots as there are exams in the student group's curriculum. The program links the variables for calculating the spreading costs in (4.18). Constraint (4.19) is a valid inequality to speed up the solving process. In (4.20) and (4.21), we define the problem as a binary IP.The elements vsqtof the columns' matrixVsqare determined using (4.22). The costcsqSof the column is determined by the spreading costs and is given in (4.23).(4.22)vsqt=κt(4.23)csqS=∑t∈T∑u∈1..5:t+u≤|T|cuspreadδtuAs discussed in Section 4.2, Model 2 does not assign exam versions explicitly to student groups. The program does not give an exam schedule for each unique group of students, nor does it guarantee a complete schedule. Hence, it is necessary to revise the solution of the MP. We perform the post-processing using two approaches: a heuristic approach and a binary IP approach. Both approaches assign an exam version to a student group and start from the solution given by the integer formulation of the MP. This solution contains a mask schedule for every unique student group and the time slots for which the exams have an exam version.To illustrate the heuristic approach, we use the following example. Student group 1 takes exams 1, 2, 3, and 4, and student group 2 takes exams 1, 2, and 3. Exam 1 has a version at time slot 1 (ϵ11V=1), exam 2 at time slot 3 (ϵ23V=1), exam 3 at time slots 5 and 7 (ϵ35V=ϵ37V=1), and exam 4 at time slot 5 (ϵ45V=1). Student group 1 takes its exams at time slots 1, 3, 5, and 7 (α1q=1andV1q=[1010101]); student group 2 takes its exams at time slots 1, 5, and 7 (α2q=1andV2q=[1000101]).In the heuristic, we use a matrixXin which the columns represent the time slots and the rows represent the unique student groups. The elements of the matrix xstrepresent the exam student group s has at time slot t. The elements in curly brackets are not fixed and will be changed by the heuristic. The post-processing heuristic works as follows:Step 1 For every element mst, create a set containing all exams that are currently assigned to time slot t for group s. If no mask slot exists, the element is equal to the empty set. Otherwise, the element is a series of exams that have versions at that time slot. This is shown for the example below. Note that exam 2 does not have a version planned in a mask slot for student group 2. This is solved in step 3.X=[{1}0{2}0{3,4}0{3}{1}000{3}0{3}]The following 3 steps are repeated until no more moves can be made.Step 2 In each row, fix the exams for which only one version is planned in that row and drop the other exams from the series in the fixed element mst. In our example, this results in the matrix below. If there are multiple exams in the same time slot with only one version scheduled, first fix the exams for which there already exists a version at that time slot; then fix the exam with the most versions in the same time slot for other student groups.X=[102040{3}1000{3}0{3}]Step 3 For each group s, add the exams in Esthat are not planned in a mask slot to the series that are not yet fixed. In our example, we must add exam 2 to the elements for student group 2.X=[102040{3}1000{3,2}0{3,2}]Step 4 In each element, fix the exams if a version already is fixed in that column. If multiple exams from an element are already fixed at that time slot, then choose the exam with the highest number of student groups already taking it. In our example, nothing needs to be done. Return to step 2.Step 2bis We fix exam 3 in the last time slot for the first student group.X=[10204031000{3,2}0{3,2}]Step 3bis No exams are missing.Step 4bis Exam 3 exists at the last time slot, so we fix exam 3 in the second row at the last time slot and remove it from the other elements in that row.X=[10204031000{2}03]Step 2tris We fix exam 2 in the fifth time slot for the second student group.X=[10204031000203]All exams are fixed, so the heuristic is stopped. The result of the heuristic is a matrix that contains a complete examination timetable for every student group.Using the solution from Model 2, we can create an IP that assigns exams explicitly to student groups and time slots. The column selection variables αsqresulting from the MP are now parameters. The IP used is described in (4.24)–(4.32), and has the same definitions as the MP in Section 4.2 with the following alterations:ParametersαsqBinary, equals 1 if schedule sq is chosen for student group s in the integer MP of Model 2Binary, equals 1 if exam e is scheduled at time slot t for unique student group ss.t.(4.25)∑t∈TϵetsP=1,∀s∈S,∀e∈Es(4.26)ϵetsP−∑q∈Qsvsqtαsq≤0,∀s∈S,∀e∈Es,∀t∈T(4.27)ϵetsP−ϵetV≤0,∀s∈S,∀e∈Es,∀t∈T(4.28)∑e∈EsϵetsP≤1,∀s∈S,∀t∈T(4.29)∑t∈TϵetV−N≤1,∀e∈E(4.30)ϵetV∈{0,1},∀e∈E,∀t∈T(4.31)ϵetsP∈{0,1},∀e∈Es,s∈S,∀t∈T(4.32)N≥0Goal function (4.24) minimizes the totals cost of exam versions. We impose in constraint (4.25) that every exam a student group takes is scheduled. Constraint (4.26) ensures that an exam is assigned to a student group only if there is a mask slot for the student group. In (4.27), an exam version is created if an exam is scheduled for a student group at that time slot. Constraint (4.28) makes sure that only one exam is planned for a student group at a given time slot. Similar to the approach used in Model 1, we try to level the additional exam versions by means of (4.29). We define the problem as a binary IP in (4.30) and (4.31), and define the domain of N in (4.32).In the IP post-processing approach, we only use the mask schedules to find a solution as opposed to the heuristic post-processing approach, which also uses the exam version data. If we were to impose the already scheduled versions in the integer MP, we would unnecessarily constrain the post-processing MIP.Fig. 2illustrates the algorithm for Model 2. The CG algorithm is equivalent to the first model, but with another fixing strategy and the addition of a post-processing step. Post-processing can be performed by using the heuristic or by using the IP model. During testing, we noticed strong tailing-off effects, especially for larger values of cVand cN. Since we were unable to counter this effect by aggregating constraints (as in Model 1), we chose to cut off the CG-process by using the Lagrangian bound as a lower bound on the optimal solution of the MP (Lübbecke & Desrosiers, 2005). The process is stopped if this bound is within 5 percent of the RMP's current goal function value.In this model, we cannot fix exams by fixing columns for student groups. We therefore fix exam versions in order of the number of potential conflicts. Exams with a higher number of potential conflicts are fixed first. We construct a potential-exam-conflict matrix, similar to the conflict matrix in Model 1, in which elementsze1e2count the number of potential conflicts between exams e1 and e2. Only exams that do not have potential conflicts with exams that were scheduled during this fixing loop, are allowed to be fixed. After the RMP has fixed a time slot for all exams, additional columns are generated for the last time. After this step, the RMP is solved as an IP. Next, because student groups are still assigned implicitly to exam versions, post-processing is required. During this step, we remove the fixing of all exam decision variables.

@&#CONCLUSIONS@&#
