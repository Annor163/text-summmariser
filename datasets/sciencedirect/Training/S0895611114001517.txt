@&#MAIN-TITLE@&#
Segmentation of heterogeneous or small FDG PET positive tissue based on a 3D-locally adaptive random walk algorithm

@&#HIGHLIGHTS@&#
We propose to use the distance between adjacent nodes in place of a constant β parameter to take into account the different distances between adjacent nodes in 26 connectivity.To reduce the partial volume effect in PET imaging, we propose to strengthen the grouping of voxels having similar intensity by adding the likelihood of probability to each class (tumor and non-tumor).The accuracy in the small and heteregenous tumor segmentation is improved using our improvements.

@&#KEYPHRASES@&#
Random walk,PET imaging,Tumor segmentation,Heterogeneous tumors,

@&#ABSTRACT@&#
A segmentation algorithm based on the random walk (RW) method, called 3D-LARW, has been developed to delineate small tumors or tumors with a heterogeneous distribution of FDG on PET images. Based on the original algorithm of RW [1], we propose an improved approach using new parameters depending on the Euclidean distance between two adjacent voxels instead of a fixed one and integrating probability densities of labels into the system of linear equations used in the RW. These improvements were evaluated and compared with the original RW method, a thresholding with a fixed value (40% of the maximum in the lesion), an adaptive thresholding algorithm on uniform spheres filled with FDG and FLAB method, on simulated heterogeneous spheres and on clinical data (14 patients). On these three different data, 3D-LARW has shown better segmentation results than the original RW algorithm and the three other methods. As expected, these improvements are more pronounced for the segmentation of small or tumors having heterogeneous FDG uptake.

@&#INTRODUCTION@&#
Traditionally in oncology, treatments planning in radiation therapy (RT) and evaluation of response after a treatment are mainly based on anatomical images such as computed tomography (CT) and magnetic resonance imaging (MRI). For RT, one needs to delineate the target volume, also called gross tumor volume (GTV). One of the criteria of response from solid tumor is the unidimentional measurement of the lesion size on CT images [2]. Positron emission tomography (PET) with 18F-2-fluoro-2-deoxyglucose (FDG) is now also widely used for RT [3] and patient follow-up [4]. FDG positive tissue corresponds to tumor cells having a high glucose metabolism. In the context of patient follow-up, early metabolic changes detected on FDG PET images can occur before anatomic changes. By assessing differences in several PET scans acquired before and at different times during treatment, various quantitative parameters have been proposed to characterize the therapeutic response [5], such as the tumor volume. In radiation therapy, the use of FDG PET in addition to CT can modify GTV volume and shape compared to those obtained on CT images alone [6]. Furthermore, Hall [7] has proposed the concept of dose painting consisting of the application of a non-uniform dose prescription based on biological characteristics of the tumor. To this end, PET images are used for segmentation of subvolumes, also called biological target volumes (BTV) [8].For this purpose, several algorithms have been proposed in the literature for segmentation of FDG PET positive tissue [9]. One can quote thresholding methods [10,11]. The advantages of these methods are their ease of used, but they need a calibration step. Region growing methods have also been developed [12], but most of these algorithms propose a stopping rule based on a threshold value similar to thresholding methods. Watershed algorithms have been proposed [13], with the advantage of not requiring a calibration step. As the method is based on gradient measurement, it is sensitive to noise. Finally, methods based on voxel classification using probability [14], fuzzy measures (i.e. fuzzy-C-means algorithm (FCM), fuzzy local adapting Bayesian (FLAB) [15]) and belief functions [16] have also been proposed.Graph based techniques have been recently developed for medical image segmentation because only a slight user interaction is needed for the initialization step. The most studied one is the graph cuts method [17] which has been used for segmentation, for example, of liver on CT images [18], multiple sclerosis lesions in brain structure in MRI [19]. Although performing well in many situations, this approach is less well suited for the segmentation of non-homogeneous region of interest. The random walk (RW) algorithm firstly proposed by Grady [1,20], has been applied on different medical image modalities with success. This algorithm has been evaluated for segmentation of FDG PET images on oncology [21,22] showing better performances than the FCM [23] and FLAB algorithms [15].If most of these methods are efficient in case of large lesions with a good contrast and a homogeneous distribution of radioactivity, they are less effective in case of small tumors or a heterogeneous distribution of radioactivity. So, even if several methods have been proposed for PET segmentation, there is no consensus on this issue [9]. It is also not clear that only one algorithm can cover all the complexity of the segmentation of PET positive tissue [24], allowing the development of algorithms dedicated to the resolution of a specific problem, such as segmentation of heterogeneous lesions or small lesions.The difficulty in PET image segmentation is compounded by the low spatial resolution and high noise characteristics of PET images. Among the many physical factors degrading image quality and quantitative accuracy, the partial volume effect (PVE) is recognized as one of the most important factors [9]. Owing to the limited spatial resolution of clinical PET systems, the resulting images are blurred by the system response and as a consequence smaller lesions appear larger. Although the total number of counts is preserved, they are distributed over a larger volume. Partial volume problem becomes more serious in the context of “small” objects, i.e. with dimensions smaller than around 2–3 times the full width at half-maximum (FWHM) of the point spread function (PSF) of the PET. A physiological characteristic also impacts the performances of PET image segmentation, because it makes the FDG uptake inhomogeneous in a lesion. This phenomenon is mainly observed on large lesion. Furthermore, necrotic tissue is most likely found on large lesions than on small ones.Our goal is to improve the initial random walk algorithm [1,20,21,25] by integrating local information for segmentation of (i) lesions with heterogeneous distribution of FDG and (ii) small lesions blurred by PVE. The proposed method is called 3D-locally adaptive random walk (3D-LARW). This paper is organized as follows: Section 2 describes the principle of the random walk algorithm and the proposed improvements. Section 3 presents the material and methods used to evaluate the 3D-LARW algorithm, and Section 4 provides results on phantom and FDG PET images of patients. A conclusion is finally given with a summary of the proposed segmentation and perspectives in the future work.At first, the method needs a small number of voxels corresponding to seeds with a pre-defined label according to each of the structure to be segmented. The algorithm calculates the probability that a constrained random walker starting from each unlabeled voxel will first reach the seeds [1]. A final segmentation is obtained by selecting, for each point, the most probable seed destination of the random walker. The constraint of the RW depends on the gradient between the intensity of the voxels.In this approach, the image is considered as a purely discrete object. So a graph, with a fixed number of nodes and edges corresponding to the image size, is created. This graph consists of a pair G=(V, E) with nodes v∈V and edges e∈E. An edge, e, spanning two viand vj, is denoted by eij. The weight necessary for the walker's moving on this graph according to connectivity, follows the empirical function ωij, such as:(1)ωij=exp[−β(gi−gj)2]where both giand gjare the image intensity values at points i and j. β represents a free parameter depending on the application.The desired random walker probability is considered as the combinatorial Dirichlet problem [1]. A Dirichlet integral is defined as:(2)D[U]=12∫Ω|ΔU|2dΩfor a fieldUand a region Ω.The solution of Eq. (2) is given by a harmonic function that satisfies the Laplace equation:(3)∇2U=0The harmonic function that satisfies the boundary conditions minimizes the Dirichlet integral of Eq. (2).The combinatorial Laplacian matrix proposed in [1] is defined as:(4)Lij=diifi=j−ωijifviandvjare adjacent nodes0otherwise,withdi=∑ωijfor each node.The Laplacian matrix is a sparse matrix. It can be built according to 4 or 8 connectivity for 2D images, and 6 or 26 connectivity for 3D images. It is partitioned into four submatrices:(5)LMBBTLUin which, the subscripts M and U stand for labeled and unlabeled voxels.The way to solve the harmonic function for finding probabilities on unlabeled nodes is shown in [1]. As result, the harmonic function can be found by solving a system of linear equations as follows:(6)LUχ=−BTMLU: submatrix of edge weights for the unlabeled voxels (nU*nU, nUnumber of unlabeled voxels);M: binary matrix of values 0 or 1 (nM*l, l number of labels and nMnumber of seeds), corresponding to the boundary conditions of seeds;BT: submatrix of edge weights corresponding to the labeled voxels (nU*l);χ: the probability for each voxel being a member of the labels (nU*l).Using the probability obtained by solving the system of linear Eq. (6), the assigned label of each voxel corresponds to the highest probability.In the original method, parameter β is a constant [20]. A value of 1 was proposed by Bagci et al. in case of segmentation of 2D FDG PET images [21]. We propose to use the distance between adjacent nodes in place of a constant β parameter to take into account the different distances between adjacent nodes. Thus, the weight function in Eq. (1) becomes:(7)ωij=exp−β(gi−gj)2hijwhere the added term hijrepresents the Euclidean distance between adjacent voxels i and j. In the initial method, the probability depends only on the gradient between voxels, but not directly on their intensity. Due to the PVE, the classification of voxels at interface between non-tumor and tumor regions is very difficult. This effect causes errors regardless of the segmentation method. To reduce this effect, we propose to strengthen the grouping of voxels having similar intensity by adding the likelihood of probability to each class (tumor and non tumor) to Eq. (6). Supposing each class k having a Gaussian distribution, their observation likelihood function can be written as:(8)pk(I,μk,σk)=12πσkexp−(I−μk)22σk2where μkand σkrepresent, respectively, the mean and the standard deviation of class k. The submatrix BTin (6) is then modified according to:(9)B′=pk⋅BTThe system of linear equations becomes:(10)LUχ=−B′MDue to these improvements proposed according to local information, the method is called 3D-locally adaptive random walk (3D-LARW).The tumor segmentation algorithm, 3D-LARW, is composed as follows. The first step corresponds to the definition of a region of interest (ROI) surrounding the tumor and corresponding to a 3D cubic box. A median filter is applied on the image to attenuate noise. Afterward, seeds are defined automatically. Finally, the 3D segmentation is obtained using the improved RW algorithm (Section 2.2). Voxels corresponding to the boundary of the ROI are assigned as non-tumor seeds. For tumor seeds and in order to face the problem of heterogeneous FDG uptake in the lesions, we propose a FCM algorithm [23] to classify voxels of ROI into three classes: the first class corresponds to the centroid having the lowest intensity value (R1), the second one corresponds to voxels with a moderate uptake (R2), and the third one, the highest uptake (R3). The seeds having the tumor label are those whose intensity value is higher than the middle of the centroid of R2 and R3. To build the Laplacian matrix in 3D, 26 connectivity for the adjacency graph is used. Eq. (8) related to the two labels (tumor and healthy tissue) are estimated from the two sets of seeds. Two probability maps corresponding to the two labels are finally obtained by resolving Eq. (10). Then, each voxel is assigned to the label whose probability is the highest.

@&#CONCLUSIONS@&#
