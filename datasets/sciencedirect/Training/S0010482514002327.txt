@&#MAIN-TITLE@&#
Automatic exudate detection by fusing multiple active contours and regionwise classification

@&#HIGHLIGHTS@&#
We introduce an automatic exudate detection method.We take advantage of several image enhancement methods.We extract the precise contours of exudate candidates by an active contour method.We apply region-wise classifier for labeling of candidates.Our method outperforms several state-of-the-art approaches.

@&#KEYPHRASES@&#
Exudate detection,Active contour method,Region-wise classification,Diabetic retinopathy screening,Contours combination,Multiple pre-processing,

@&#ABSTRACT@&#
In this paper, we propose a method for the automatic detection of exudates in digital fundus images. Our approach can be divided into three stages: candidate extraction, precise contour segmentation and the labeling of candidates as true or false exudates. For candidate detection, we borrow a grayscale morphology-based method to identify possible regions containing these bright lesions. Then, to extract the precise boundary of the candidates, we introduce a complex active contour-based method. Namely, to increase the accuracy of segmentation, we extract additional possible contours by taking advantage of the diverse behavior of different pre-processing methods. After selecting an appropriate combination of the extracted contours, a region-wise classifier is applied to remove the false exudate candidates. For this task, we consider several region-based features, and extract an appropriate feature subset to train a Naïve–Bayes classifier optimized further by an adaptive boosting technique. Regarding experimental studies, the method was tested on publicly available databases both to measure the accuracy of the segmentation of exudate regions and to recognize their presence at image-level. In a proper quantitative evaluation on publicly available datasets the proposed approach outperformed several state-of-the-art exudate detector algorithms.

@&#INTRODUCTION@&#
More than 360 million people suffered from diabetes in 2012 worldwide. The number of the diagnosed cases has grown rapidly in the last few years and this tendency is estimated to continue [1]. Long-term diabetes also affects the eyes, resulting in a disease called diabetic retinopathy (DR). If DR remains undiagnosed or is treated inappropriately, it can lead to loss of vision. Moreover, DR is the most common cause of blindness in the world. However, there exist suitable ways of treatment to slow down this damage of the eyes. Thus, an automatic screening system for DR would have great importance mainly in developing countries, where near 40% of the cases remain undiagnosed. Such a system is useful if it is able to detect the first signs of the disease. Such signs of DR are microaneurysms and exudates. Exudates arise when fluid exudes from tissue due to its injured capillaries. Since the fluid contains protein, cellular debris and white blood cells, exudates appear as yellowish, bright patches on the retinal background. That is, considering intensity differences, exudates can be distinguished more efficiently from the background than microaneurysms from blood vessel segments. On the other hand, the fluid can flow without restrain, so the exudates have various sizes and irregular shape, which makes the automatic detection of exudates challenging as well.In the corresponding literature, a large number of exudate detection algorithms has been proposed. In general, we can divide these approaches into two main groups. The first group contains algorithms based on grayscale morphology [2–4], while the second one consists of methods considering pixel/region-wise classification [5–9]. Furthermore, we can find some special approaches (e.g. [10–12]) falling out of these groups. Walter et al. [2] proposed a method using morphological closing to eliminate blood vessels, and then the local standard deviation is calculated and thresholded to find the candidate regions. Finally, morphological reconstruction is applied to find the contours of the exudates. Sopharak et al. [3] introduced a technique which is based on optimally adjusted morphological operations. Since the optic disc is also a bright patch, it is eliminated and Otsu׳s algorithm is used for thresholding to locate regions with high intensities. Welfer et al. [4] applied morphological operations and H-maxima transform after contrast enhancement on the channel L in the color space CIE 1976 L*u*v*. Sopharak et al. [5] proposed a method using fuzzy c-means clustering in order to determine whether a pixel belongs to an exudate or not. Then, morphological operations are applied to refine the segmentation result. Sopharak et al. [6] designed an algorithm for exudate detection, which applied pixel-based classification. Namely, a Naïve–Bayes classifier sorts each pixel-based on five extracted features. The method proposed in [7] also considers pixel-based classification, but the training database is defined for each analyzed image separately. That is, the algorithm first detects small isolated exudates and uses those pixels as a positive training set. Then, the rest of the image pixels are classified based on their corresponding properties. Niemeijer et al. [8] proposed a multi-level classification approach for segmentation of pixels which belongs to bright lesions with high probability. These pixels are grouped into clusters and the clusters are labeled as exudates, cotton-wool spots or drusens. Jaafar et al. [10] proposed exudate detection based on a split-and-merge technique. This algorithm splits the images into disjoint regions first, and merges them based on local variance afterwards. Finally, a histogram-based adaptive thresholding is applied to each merged region. Ali et al. [11] proposed an atlas based method to detect exudates. Harangi et al. [12] published an active contour-based method for exudate detection using only the green intensity channel of the image.In this paper, we propose a method for exudate detection which combines the mainstream approaches (morphology and classification) within a single framework. Our aim is to take advantage of several image enhancement methods for recognizing the precise boundaries of candidates extracted by a morphology-based candidate extractor. The motivation behind this objective is that the features extracted from the precisely segmented regions are more appropriate to differentiate the true exudates from the false ones. So, we recommend the use of several different pre-processing algorithms to extract contour candidates by an active contour method for each preprocessed image. The final exudate contour is found by a combination of these contour candidates. Finally, a region-wise classifier is applied to decide whether the candidates should be considered as exudates or not. The proposed fusion of grayscale morphology and active contour-based segmentation with region-wise classification can outperform several state-of-the-art approaches according to our empirical results.The rest of the paper is organized as follows. In Section 2, we describe the applied data sets for experimental evaluation. In Section 3, we introduce the algorithm [2] applied for rough candidate extraction, list the involved image pre-processing methods and present our novel methodology. Section 4 is dedicated to our comparative experimental results regarding some other state-of-the-arts exudate detection methods. Finally, some discussions and conclusions are given in Section 5.We use the publicly available DIARETDB1 – Standard Diabetic Retinopathy Database [13] and the HEI-MED – Hamilton Eye Institute Macular Edema Dataset [14] for our experimental studies. The dataset DIARETDB1 contains 89 fundus images with a 50° Field-of-View (FOV) and resolution of 1500×1152 pixels. 53 images contain exudates based on the labeling of 4 clinical experts. Each expert marked manually the most representative points of the exudates in these images, and the coordinates of these points are stored in text files. Based on these manually-marked anchor points, a local ophthalmologist segmented manually the exudates further in these images. Thus, we have gained 53 binary masks containing the precise exudate boundaries. For feature selection and the training of the region-wise classifier (see Section 3.4 for more details), the dataset DIARETDB1 is divided into training and test part by taking into account the distribution of normal and abnormal images as proposed by Kauppi et al. [13]. The training set consists of 24 images containing exudates and 4 images with no such lesions. The dataset HEI-MED consists of 169 images of resolution 2196×1958 pixels with a 45° FOV, among which 54 images are classified manually by an ophthalmologist as containing exudates. The binary images containing the manually segmented exudates for HEI-MED images are not available, so we use this image set for evaluation at image-level only. For both image sets, the images have been captured from patients belonging to heterogeneous ethnic groups so the datasets do not correspond to any typical population as it is published in [13,14]. Consequently, the retinal pigmentations of these images are quite diverse.

@&#CONCLUSIONS@&#
