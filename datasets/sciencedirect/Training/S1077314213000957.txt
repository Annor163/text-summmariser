@&#MAIN-TITLE@&#
An adaptive spatial information-theoretic fuzzy clustering algorithm for image segmentation

@&#HIGHLIGHTS@&#
We incorporate the spatial context to the conventional fuzzy c-means (FCM) algorithm for image segmentation.We incorporate the information-theoretic framework into the FCM algorithm to improve its robustness.The new clustering algorithm can effectively improve the image segmentation results and is useful for brain image analysis.

@&#KEYPHRASES@&#
Image segmentation,Fuzzy c-means,Spatial information,Information clustering,MRI brain image,

@&#ABSTRACT@&#
This paper presents an adaptive spatial information-theoretic fuzzy clustering algorithm to improve the robustness of the conventional fuzzy c-means (FCM) clustering algorithms for image segmentation. This is achieved through the incorporation of information-theoretic framework into the FCM-type algorithms. By combining these two concepts and modifying the objective function of the FCM algorithm, we are able to solve the problems of sensitivity to noisy data and the lack of spatial information, and improve the image segmentation results. The experimental results have shown that this robust clustering algorithm is useful for MRI brain image segmentation and it yields better segmentation results when compared to the conventional FCM approach.

@&#INTRODUCTION@&#
Image segmentation is one of the most important steps in many computer vision applications. The goal of image segmentation is to partition a given image into regions or parts that have a strong correlation with patterns or areas corresponding to objects in the real world. In the last few decades, data clustering techniques had been widely used in image segmentation and had achieved great successes in the areas of medical image analysis [1,2], face recognition [3,4], and machine vision [5,6]. The fuzzy clustering method, especially the fuzzy c-means (FCM) algorithm [7], is one of the most popular data clustering algorithms for image segmentation. It has been shown to be more advantageous than crisp clustering in that the crisp assignment of a data point to cluster center is not reasonable in real applications. Further, when compared to the crisp approaches, the FCM method is more tolerant to variations and noise in the input data [8].Like many other standard unsupervised clustering methods, the FCM method suffers the lack of spatial information when applying to image segmentation applications. They rely only on the intensity distribution of the pixels, and disregard their geometric information, which make them very sensitive to noise and other artifacts introduced during the imaging process. In order to make the standard FCM algorithm [7] more robust to noise and outliers for image segmentation, many modified fuzzy clustering approaches had been reported in [9–15]. These methods are better than the conventional fuzzy clustering algorithms because the clustering decision of a single pixel is now reconsidered by the influence from the neighborhood patterns. This improvement tends to smooth out the isolated noise or image artifacts and produces more homogeneous segmentation results.Most of these improved methods were developed in the last decade. The major contribution to the modifications of the FCM algorithm through the incorporation of the spatial information can be tracked back to 1998. Mohamed et al. [9] used a modified FCM algorithm for medical image segmentation. They introduced the spatial information into the similarity measure. The similarity measure is modified such that the pixel can be dragged closer to the cluster center if it is in homogenous regions. Although there is no more model assumption in the FCM algorithm, the drawbacks of the FCM algorithm [8] are its sensitivity to the non-descriptive initial centers and its massive computational load. Therefore, Ahmed et al. [10] used another similarity measure in a Bias-Corrected FCM (BCFCM) algorithm for bias field estimation and segmentation, which achieved a better performance when an additional term is added to the new objective function. Many researchers subsequently modified the objective functions and developed several robust FCM variants for image segmentation [11–15]. These algorithms were shown to have better performance than the standard FCM algorithm. However, some of these methods [11,13,14] depend on a fixed spatial factor which needs to be adjusted according to the real applications. The shortcoming of using a fixed spatial parameter is evident. It makes the segmentation algorithm less robust to various images and causes the problem of over-smoothed edges. In order to overcome this, clustering algorithms that have an adaptive selection mechanism of the spatial parameters have been proposed recently [16,15]. The new similarity measure makes use of local and spatial intensity information, and so it performs better and is able to reduce the blurring effect. However, the need for experimentally adjusted parameter and the blurring problems still exist.In this paper, we propose a new adaptive spatial fuzzy clustering algorithm, called the Adaptive Spatial Information-Theoretic Fuzzy Clustering Algorithm (ASIFC), to address the noise problem and the lack of spatial information for the conventional FCM algorithms with two-level robustness enhancements. We extend the idea in [17] to specifically enhance the robustness of FCM algorithms. The lack of spatial information problem is taken into consideration by using a novel adaptive similarity measure, while the noise and outliers are to be identified through the mutual information (MI) maximization. This new information framework allows us to add robust capability to the basic FCM algorithm while inheriting its advantages such as fast processing time and less sensitive to the density of clusters.One approach to fuzzy clustering, probably the most commonly used, is the FCM algorithm, which was proposed by Dunn [18] in 1973 and improved by Bezdek [7] in 1981. FCM is formulated as the minimization of the following objective function with respect to the membership functions u and the centers w:(1)Jfcm=∑i=1N∑k=1Kuikq‖xi-wk‖2,1⩽q<∞where q is any real number greater than 1, uikis the degree of fuzzy membership of xiin the kth cluster, and ∥·∥ is any norm expressing the similarity measure. Typically, the Euclidean distance measure is used in this paper.Intuitively, the objective function (1) is minimized when the large membership values are assigned to input patterns are close to their nearest cluster centers and low membership values are assigned when they are far from other cluster centers.Minimizing the objective function (1) with the hidden constraint∑k=1Kuik=1, we have(2)∂Jfcm∂uik=0,∂Jfcm∂wk=0These lead to the iterative solutions(3)uik=‖xi-wk‖-2/(q-1)∑c=1K‖xi-wc‖-2/(q-1)and(4)wk=∑i=1Nuikqxi∑i=1NuikqIterating through these two necessary conditions leads to the minimum of Jfcm. This iteration will stop when|uik(p+1)-uik(p)|<ε, where ε is a termination condition between 0 and 1, p is the iteration steps. This procedure converges to a local minimum or a saddle point of Jfcm.In image segmentation, the neighboring pixels are highly correlated in the spatial domain. If the segmentation algorithm fails to take into account this neighborhood correlation, the segmentation result will have flaws and errors. In other words, the data clustering algorithm should incorporate the spatial information in such a way that if the neighboring pixels share similar characteristics, the center pixel should have higher probability of grouping to the same cluster as the neighboring pixels.Modifying the objective functions is one of the most commonly used methods to incorporate the spatial information into the FCM algorithm. Many researcher modified the objective function to include the spatial constraint imposed on the center pixel. The generalized modified objective function can be expressed(5)Js=∑i=1N∑k=1Kuikq‖xi-wk‖2+α∑i=1N∑k=1Kuikq∑r∈Ni‖xr-wk‖2where Niis the subset of neighborhood pixels of xiand the parameter α reflects the preference of neighboring effect. In real applications, α can be fixed or adaptive to the image content. As can be seen from (5), the modified objective function has two components. One puts the constraints that the pixels are to be close to the cluster centers. The other imposes spatial continuity, and is weighted by α. It favors a piecewise-homogenous clustering solution.With this modification, the spatial information can be incorporated into the clustering process. However, the above modified objective function may smooth out the important structures (such as regional borders or edges) in the image, because it always imposes a significant amount of spatial constraint on the center pixel. In other words, the center pixel will be influenced by the neighboring pixels no matter it is in a homogenous region or along an edge. Hence, the blurring effect will occur when the center pixel is along an edge [19]. Some other significant modifications can be found in [14,15]. Nevertheless, the need for experimentally adjusted parameter and the blurring problems still exist.Besides the lack of spatial information problem, the conventional FCM algorithm also suffers from the lack of robustness against outliers [8].In order to overcome the outlier problem of FCM algorithm, Krishnapuram et al. [20] proposed the possibilistic clustering algorithm to achieve membership values that are possibilistic. Here, one input data point has little effect on good clusters if its possibility as noise is high, so that the clustering results are less distorted as compared to the FCM method. The modified objective function of PCM algorithm is(6)JPCM=∑i=1N∑k=1Ktikq‖xi-wk‖2+∑k=1Kηk∑i=1N(1-tik)qwhere ηkis the estimated noisy cluster hyper-parameter, and there is no constraint on the possibility membership value tikother than the requirement that it should be in [0,1].The PCM algorithm utilizes different hyper-parameters ηkto form K different noisy clusters and has the capability to identify noisy data through the possibility membership values, i.e. the sum of possibilistic values tikis not equal to one in a particular cluster as compared to the FCM algorithm. However, PCM is much more sensitive to the initialization and ηk’s selection as compared to the FCM-type algorithms, and this has limited its applications [8].To circumvent these shortcomings in the conventional FCM algorithm and to take into consideration the incorporation of spatial information, we introduce input data distribution and an improved similarity measure ds(xi,j,wk) into the objective function of FCM algorithm. This can be done by modifying the objective function (1) as follows:(7)JASIFC=∑i=1M∑j=1N∑k=1Kei,juk|i,jqds(xi,j,wk),1⩽q<∞where(8)ds(xi,j,wk)=λi,j‖xi,j-wk‖2+(1-λi,j)NR∑xr,c∈Ni,j‖xr,c-wk‖2and ei,jis the estimated input data distribution (with constraint∑i=1M∑j=1Nei,j=1), which is set to 1/M×N in the initial stage of the ASIFC algorithm. The Ni,jis the subset of neighborhood pixels of (i,j) in a 3×3 window. NRis the window size. uk∣i,jis actually another form of notation for the membership value as we try to make the notations consistent with information theory. The choice of the spatial weighting factor λi,jwill be discussed later.Note that the estimated input data distribution plays an important role in identifying the noise data and outliers. During the initial stage, since we have no preference for any input data points, the initial values for ei,jare usually set to 1/M×N unless specified user preference is available. In the pruning phase, the data reliability/preference is assessed by MI maximization. The identified unreliable data points can be deleted (for common data clustering applications) or relabeled (for image segmentation applications) to achieve better clustering results. Embedded in the new objective function (7), the estimated input data distribution ei,jalso plays a similar role of the possibility value as in the PCM algorithm to eliminate the outliers. Furthermore, the improved similarity measure ds(xi,j,wk) offers an optimal way to tackle the lack of contextual information from the image coordinates. Except for the fuzzifier q, there is no pre-fixed parameter in the specific objective function (7) for the clustering phase, which makes our proposed ASIFC algorithm relatively simpler to use when compared to other robust versions of fuzzy clustering algorithms like the PCM-type algorithms.By introducing the hidden constraint∑k=1Kuk|i,j=1, and minimizing the objective function (7), we have(9)∂JASIFC∂uik=0,∂JASIFC∂wk=0These lead to the iterative solutions(10)uk|i,j=ds(xi,j,wk)-1/(q-1)∑c=1Kds(xi,j,wc)-1/(q-1)and(11)wk=∑i=1M∑j=1Nei,juk|i,jq(λi,jxi+(1-λi,j)NR∑xr,c∈Ni,jxr,c)∑i=1M∑j=1Nei,juk|i,jqAs can be seen from (8), the improved similarity measure has two components. One puts the constraint that the pixels are to be close to the cluster centers. The other imposes spatial continuity. These two terms are weighted by λi,j. With this new objective function, we can choose λi,jto be small so that the pixel xm,nis greatly influenced by its neighbors if it is in a homogeneous region. On the other hand, a big λi,jwill be used to reduce the neighboring effect, if xm,nis along the borders or edges. Thus, the over-smoothed edges problem can be solved by this adaptive weighting scheme.In order to make the smoothing parameter {λi,j} adaptive to the image content, the value of {λi,j} should be adjusted according to the homogeneousness of the neighboring window. Consider a 3×3 window, for the pixel in location (i,j), we can calculate the dispersion of intensity differences between its intensity value and its neighbors’:(12)d(xi,j,xi+r,j+c)=‖(xi,j-xi+r,j+c)‖2with r={−1,0,1}, and c={−1,0,1}, but (r,c)≠(0,0). Thus, the homogeneousness of this 3×3 neighboring window can be measured by the standard derivation of the intensity difference between the center pixel and its neighboring pixels, leading to(13)ηi,j=1NR∑r=-11∑c=-11(d(xi,j,xi+r,j+c)-μ)212μ=1NR∑r=-11∑c=-11d(xi,j,xi+r,j+c)It is apparent from (13) that the standard derivation of the intensity difference {d(xi,j,xi+r,j+c)} does not take into account the magnitude of intensity transition in the edge region, and hence will over smooth obscure edge regions. Therefore, a further modification is required to eliminate the unbalanced effect on the weighting parameters between the obvious and obscure edge regions.Since (13) measures the local variance of the intensity difference between the center pixel and its neighbors, a straightforward solution is to divide ηi,jby the local variance of intensity of all the pixels over the 3×3 window, i.e.(14)λˆi,j=ηi,j/ζi,jwhereζi,j=19∑r=-11∑c=-11(xi+r,j+c-τ)212τ=19∑r=-11∑c=-11x(i+r,j+c)Finally, we normalizeλˆi,jand obtain λi,j(15)λi,j=λˆi,j/max(λˆi,j)Apparently, this approach is totally adaptive to the local image content, and can be pre-computed before the clustering iteration. Furthermore, there is no experimentally adjusted parameters in the whole process. Detailed discussions about the adaptive weighting factor λi,jcan be found in [19].As interpreted in Section 3.1, ei,jacts as an extra weighting factor or typical value to eliminate the outliers. Note that these values are chosen to be fixed for all input data points during the normal fuzzy clustering process, which implies that initially we do not have any preference about the input data points. After generating the estimated cluster center wkand membership value uk∣i,j, we actually can reassess the input data reliability, i.e. via the input data distribution ei,j, under the estimated wkand uk∣i,j. After some proper iterations between these two steps, we can produce a set of new robust input data reliability values ei,jfor every input data points. These values can be used to label/eliminate the remaining unreliable data points with the improved similarity measure, and thus improve the clustering/segmentation results.To derive the robust estimation of input data distribution ei,j, we first define the mutual information between the set of optimal membership distributions of input data points obtained via (10) and (11) and the input data distribution as follows:(16)I(X,W)=∑i=1M∑j=1N∑k=1Kei,juk|i,jloguk|i,jei,j∑i=1M∑j=1N(ei,juk|i,j)Using similar procedure in the information theory [21], for fixed wkand uk∣i,j, we can obtain the robust estimate for ei,jby the following function(17)ei,j=ei,jexp∑k=1Kuk|i,jloguk|i,j∑i=1M∑j=1N(uk|i,jei,j)∑i=1M∑j=1Nexp∑k=1Kuk|i,jloguk|i,j∑i=1M∑j=1N(uk|i,jei,j)The ASIFC is basically a two-step clustering algorithm for image segmentation. First, it uses a conventional FCM algorithm together with the improved similarity measure as the starting point to explore the details of the input features from the image and group them effectively into several clusters subject to the adaptive spatial weighting factors λi,j. Given the estimated cluster centers wkand the optimal membership values uk∣i,jfrom ASIFC, the reliability of the input data points are assessed by the MI maximization. Finally, these identified unreliable data points are clustered again with a bigger neighboring window.The implementation of the ASIFC algorithm is described below. Suppose that we are given the feature vectors of input image X={x1,1,x1,2,…,xM,N} with the resolution of L=M×N.Fuzzy clustering with adaptive spatial weighting factors:(1)Set the pre-specified number of clusters K, convergence parameter ∊=0.001, fuzzifier q>0, and the input data distribution ei,j=1/(M×N) for i=1–M, j=1–N.Initialization: calculate the weighting function λi,jas discussed in Section 3.1.Perform fixed point iteration according to (10) and (11).Convergence test: If not satisfied, then go to (3).MI Maximization for identifying the unreliable data points:Select ei,j=1/(M×N), for i=1,…,M, j=1,…,N, and ε>0, then start the fixed point iteration of the robust density estimation according to steps (6)–(7).Iteratively update the input data distribution by usingci,j=exp∑k=1Kuk|i,jloguk|i,j∑i=1M∑j=1N(uk|i,jei,j)and(18)ei,j=ei,jci,j∑i=1M∑j=1Nci,jIf(19)ln∑i=1M∑j=1Nei,jci,j-lnmax{i,j}ci,j<εthen go to (9) where ε>0.Label unreliable data points, and obtain the membership of all data points for a hard clustering solution.Create a 3×3 window centered at the outlier, obtain the clustering labels for all neighboring pixels within this neighborhood window from the fuzzy clustering step.Store all label counts for each cluster into ξk, k=1,2,…,K.Find the maximum value of ξkand its corresponding cluster index, i.e. ξm=max(ξk).If ξ1=ξ2=…=ξK, increase the current window edge by 2 more pixels, (for example, from 3×3 to 5×5), go to (12); Otherwise, update the outlier label with m.Iterate for all outlier pixels until there is no further change, then stop.The weighting factors {λi,j} do not change in each fixed point iteration, so we can pre-compute them at step (2). After this, the algorithm begins the fixed point iteration.

@&#CONCLUSIONS@&#
In this paper, we have presented a novel robust information fuzzy clustering method that uses the information-theoretic clustering concept and adaptive spatial weighting factors to improve the image segmentation results. The proposed ASIFC algorithm addresses the two interwined problems, i.e. the identification of noisy data, and the lack of spatial contextual information, in data clustering based image segmentation. The algorithm is fully automated, except for the initialization of fuzzifier, cluster number and stop condition parameters. The experimental results based on synthetic images showed that the proposed algorithm can effectively improve the segmentation accuracy. The experiment on real MRI image also demonstrated that our ASIFC method can deliver useful segmentation results for brain image analysis.