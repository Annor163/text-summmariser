@&#MAIN-TITLE@&#
Robust shape optimization of continuous structures via the level set method

@&#HIGHLIGHTS@&#
Robust shape optimization considering uncertainty in loads and material is proposed.Stochastic shape derivatives of continuous structures are obtained.The existence of a solution for the robust shape optimization problem is proved.Different probability distributions and random fields are considered in experiments.

@&#KEYPHRASES@&#
Robust structural shape optimization,Random fields,Adaptive sparse grid,Level-set method,Existence theory,

@&#ABSTRACT@&#
This work proposes a stochastic shape optimization method for continuous structures using the level-set method. Such a method aims to minimize the expected compliance and its variance as measures of the structural robustness. The behavior of continuous structures is modeled by linear elasticity equations with uncertain loading and material. This uncertainty can be modeled using random variables with different probability distributions as well as random fields. The proper problem formulation is ensured by the proof of the existence colorrev of solution under certain geometrical constraints on the set of admissible shapes. The proposed method addresses the stochastic linear elasticity problem in its weak form obtaining the explicit expressions for the continuous shape derivatives. Some numerical examples are presented to show the effectiveness of the proposed approach.

@&#INTRODUCTION@&#
Shape structural optimization aims to obtain the optimal layout of material within the design domain by performing variations in its boundary and connectivity  [1–3]. This technique has been successfully applied to improve the design of many complex industrial problems, such as in aeronautical, aerospace and naval applications. Its relevance for real-world applications has greatly increased the interest in this research field giving rise to multitude of studies  [4,3] until today [5,6]. Most of these works assume deterministic conditions for the input data, obviating the different sources of uncertainty which may affect significantly the structural performance. These sources of uncertainty include aleatory uncertainties, e.g. manufacturing imperfections, unknown loading conditions and variations of the material properties, and epistemic uncertainties due to the lack of knowledge. Ideally, the shape structural optimization methods should consider these sources of uncertainty to ensure the robustness and reliability of the final designs.The robust shape structural optimization methods can be broadly divided, according to the representation and treatment of uncertainties, into non-probabilistic and probabilistic approaches. The former methods  [7] do not require the statistical information about the uncertainty of the phenomenon but a qualitative notion about its magnitude. The worst-case approach  [8–10], taking the form of a min–max optimization problem, and fuzzy techniques  [11], making use of fuzzy set theory, are methods included in this category. The main drawback of these approaches is that they are often too conservative, due to overestimation of uncertainty, leading to optimal designs with poor structural performance. The latter methods make use of the stochastic characterization of the uncertainty of the phenomenon. These methods can consider the statistical moments of the structural response to perform robust design optimization. They also can take into account the probabilities of failure to perform risk-averse optimization and reliability-based design optimization  [12]. Robust design optimization aims at obtaining optimal designs less sensitive to variations in the input data  [13]. Reliability-based design optimization deals with extreme or rare events and aims to ensure a given level of reliability by means of probabilistic constraints  [14,15]. Risk-averse optimization minimizes a risk function that quantifies the expected loss related with the damages caused by catastrophic failures  [16,17]. This work deals with the robust shape structural optimization problem adopting a probabilistic approach, in which the mean and the variance of the structural performance are considered as a measure of robustness.A key point in stochastic structural optimization is the discretization process of the physical and the stochastic domains. The most common process consists of firstly discretizing the state law of the problem with respect to the spatial (physical) variable (e.g. by using finite elements), and then incorporate uncertainty in the spatially discretized model  [18]. The mean and/or variance of the cost function, typically compliance or total strain energy, is then minimized using some optimization method, which applies to the governing Finite Element (FE) system of equations. Several works addressing the robust shape and/or topology structural optimization problem, whether using the SIMP method  [19–21] or the level-set method  [22–25], have adopted this approach. However, some examples have shown that the optima of the spatially discretized model may not converge, as the parameter of discretization tends to zero, to the optimum of the continuous counterpart  [26]. On the other hand, the process can incorporate uncertainty in the PDE-constrained optimization problem before discretizing the spatial domain. This is done adopting Stochastic Partial Differential Equations (SPDEs) with random input data for the linear system of elasticity. The use of the linear elasticity system in its weak form permits to obtain the explicit expressions for the continuous shape derivatives without being limited by the discretization method used for the physical and the stochastic domains.Different works have addressed the robust shape and topology optimization problem using the continuous weak form of the SPDE. The shape optimization of diffusion problems with uncertainty in its input data is addressed in  [27]; in particular, the uncertainty is introduced in the force term, the diffusion coefficient and the boundary conditions. The direct and adjoint equations are solved numerically using stochastic finite element methods. For the system of elasticity, the work  [28] proposes a two-stage stochastic programming and level-set based algorithm for shape structural optimization under stochastic loading. The shape optimization problem under uncertainty is formulated as the minimization of the expected value of a functional cost. Recently, Carrasco et al.  [29] propose a continuous approach to the multi-objective robust topology optimization under uncertain loads conditions with point, surface and/or volume loads represented by dependent and independent random variables. The multi-objective problem is transformed into a single objective problem using an average approach, in which the variance of the compliance is included as a measure of robustness.This work extends the development of  [27] to the robust shape optimization of continuous structures using the level-set method for the SPDE of linear elasticity with random input data. The proper stochastic problem formulation is guaranteed by the proof of the existence of solution under the well-knownε-cone geometric condition  [30]; in particular, an existence result of the robust compliance for the linear system of elasticity with random Lamé coefficients and volume and surface loadings is proved. The robust shape optimization of continuous structures is then addressed in its weak form and explicit expressions for the continuous shape derivatives are obtained. These expressions require the resolution of the stochastic linear system of elasticity and its associated adjoint system. The stochastic collocation finite element method is then used to solve the direct and adjoint systems. The proposed development provides a general framework to consider uncertainties in loads and material properties with diverse probability distributions and random fields.The paper is organized as follows. Section  2 is devoted to the problem statement, which includes the proper stochastic problem formulation providing the proof of an existence result under certain geometrical constraints on the set of admissible shapes. The proposed development for addressing the robust shape optimization for continuous structures using the level-set method is presented in Section  3. Section  4 is devoted to the uncertainty modeling and the stochastic collocation approach used for the numerical approximation of integrals in the random domain. Some numerical examples are presented in Section  5 to verify the effectiveness of the proposed development. Such experiments include uncertainty in loads and material properties with different probability distributions and random fields. Finally, some conclusion and concluding remarks are presented in Section  6.Let(Ω,F,P)be a complete probability space, and letD⊂Rd(d=2or 3) be a bounded Lipschitz domain whose boundary∂Dis decomposed into the following three disjoint parts∂D=ΓD∪ΓN∪Γ0,|ΓD|>0,where|⋅|stands for the Lebesgue measure andΓDandΓNare the parts of∂Dwhere Dirichlet and Neumann boundary conditions are applied, respectively. For any symmetric matrixζ, the Hooke’s lawAof a linear isotropic elastic material is defined byAζ=2μζ+λ(Trζ)Id,whereλ=λ(x,ω)andμ=μ(x,ω)are the Lamé moduli of the material, which are assumed to depend on bothx=(x1,…,xd)∈Dandω∈Ω. Given a random displacement fieldu=u(x,ω)=(u1(x,ω),…,ud(x,ω))∈LP2(Ω;H1(D)d), consider the linearized strain tensore(u)=12(∇u+(∇ut))=12(∂ui∂xj+∂uj∂xi)1≤i,j≤d.The following system of linear elasticity with random input data is considered(1){−div(Ae(u(x,ω)))=finD×Ω,u(x,ω)=0onΓD×Ω,(Ae(u(x,ω)))⋅n=gonΓN×Ω,(Ae(u(x,ω)))⋅n=0onΓ0×Ω,wherenis the unit outward normal vector to∂D. The divergence operator (div) involves derivatives with respect to the spatial variablex∈D. The following assumptions on the uncertain input parameters of the system (1) are made:(A1)λ(x,ω),μ(x,ω)∈LP∞(Ω;L∞(D))and there exist positive constantsμmin,μmax,λmin,λmaxsuch that0<μmin≤μ(x,ω)≤μmax<∞a.e.x∈D,a.s.ω∈Ω,and0<λmin≤2μ(x,ω)+dλ(x,ω)≤λmax<∞a.e.x∈D,a.s.ω∈Ω,f=f(x,ω)∈LP2(Ω;L2(D)d),g=g(x,ω)∈LP2(Ω;L2(ΓN)d).To introduce an appropriate functional framework for problem (1), consider the Hilbert spacesVD={v∈H1(D)d:v|ΓD=0in the sense of traces},equipped with theH1(D)d-norm, andLP2(Ω;VD)={f:Ω→VD,fisF-measurableand‖f‖LP2(Ω;VD)2=∫Ω‖f(ω)‖VD2dP(ω)<∞}.A weak solution of (1) is a random functionu∈LP2(Ω;VD)such that(2)∫Ω∫DAe(u(x,ω)):e(v(x,ω))dxdP(ω)=∫Ω[∫Df⋅vdx+∫ΓNg⋅vds]dP(ω),∀v∈LP2(Ω;VD).The Lax–Milgram lemma permits to state the well-posedness of (1). Moreover, there existsc>0such that‖u‖LP2(Ω;VD)≤c(‖f‖LP2(Ω;L2(D)d)+‖g‖LP2(Ω;L2(ΓN)d))and(3)‖u(ω)‖VD≤c(‖f(ω)‖L2(D)d+‖g(ω)‖L2(ΓN)d),a.s.ω∈Ω.Notice that, considering the assumption (A1), the constantc=c(D,μmin,λmin)in (3) does not depend onω∈Ω.Theε-cone property, introduced by Chenais  [30], is presented as follows. Let a pointy∈Rd, a vectorξ∈Rdandε>0be given. Consider the coneC(y,ξ,ε)={z∈Rd:(z−y,ξ)≥cosε|z−y|,0<|z−y|<ε}.An open setO⊂Rdis said to have theε-cone property if for allx∈∂Othere exists a unit vectorξxsuch that∀y∈O¯∩B(x,ε), the propertyC(y,ξx,ε)⊂Oholds.Consider the classOε={Oopen,O⊂D,Ohas theε-cone property}.For instance, the bounded, open and convex sets are some of the domains in the classOε. It can be proved ([31, Th. 2.4.7]) that theε-cone property is equivalent to the fact that∂Ois uniformly Lipschitz. Imposing a volume constraintV∗on an admissible domain, the class of admissible domains isUad={O∈Oε,ΓD∪ΓN⊂∂O,|O|=V∗},with0<V∗<|D|.For a givenO∈Uad, letuO=uO(x,ω)be the weak solution of (1) posed in the spatial domainO. For each realizationω∈Ω, consider the compliance(4)J(O,ω)=∫Of(x,ω)⋅uO(x,ω)dx+∫ΓNg(x,ω)⋅uO(x,ω)ds.The following cost function is considered(5)JRα(O)=E(J(O,ω))+αVar(J(O,ω)),whereα≥0is a weighting parameter,E(J(O,ω))=∫ΩJ(O,ω)dP(ω)is the expectation of the compliance, andVar(J(O,ω))=∫ΩJ(O,ω)2dP(ω)−(∫ΩJ(O,ω)dP(ω))2is its variance. In the sequel, the cost functionalJRαis referred to as the robust compliance. Such a cost functionalJRαis an averaged approach, commonly used in the field of robust optimization  [20,24,23], that combines lower statistical moments of the structural performance to find a trade-off between performance and robustness. The expectation of the complianceE(J(O,ω))is considered as an indicator of the structural performance, whereas the variance of the complianceVar(J(O,ω))is used as an indicator of the structural robustness.Remark 1Notice that in order for the variance to be well-defined it should be assumed thatf∈LP4(Ω;L2(D)d)andg∈LP4(Ω;L2(ΓN)d).The following optimization problem is considered(Pα)min{JRα(O):O∈Uad}.It is well known that if an admissible domain is assumed to be only Lebesgue measurable the deterministic shape optimization problem is ill-posed due to the lack of closure of the set of admissible domains with respect to theweak -⋆topology inL∞(D;{0,1}). To overcome this difficulty, additional conditions, such as smoothness, geometrical or topology, are imposed on the class of admissible designs. In this work, the standardε-cone assumption [30] on the uniform geometry of the shapes has been considered. To prove the existence of a solution for(Pα), the set of admissible domainsUadis equipped with an appropriate topology so that the compactness ofUadand the continuity ofJRα(O)are ensured. Following  [31, Definition 2.2.3], let{On}n≥1andObe Lebesgue measurable sets ofRd. It is said that{On}converges toOin the sense of characteristic functions asn→∞if1On⟶1OinLlocp(Rd)∀p∈[1,∞[,where1Bstands for the characteristic function of a measurable setB⊂Rd.The class of domainsOεenjoys the following compactness property ([31, Th. 2.4.10]): let{On}n≥1be a sequence inOε. Then, there existsO∈Oεand a subsequence, still labeled byn, such thatOnconverges toOin the sense of characteristic functions.Theorem 2.1The problem(Pα)has, at least, one solution.ProofLetOnbe a minimizing sequence. Due to the compactness property ofOε, there existO⋆∈Oεand a subsequence, still labeled byn, such thatOnconverges toO⋆. Moreover, the convergence in the sense of characteristic functions permitsO⋆to satisfy the volume constraint, and henceO⋆∈Oad. The domainO⋆is the candidate to be the minimizer. Similarly to the deterministic case (see  [31, Th. 4.3.1] for a related deterministic shape optimization problem for the conductivity equation)(6)J(On,ω)→J(O⋆,ω)asn→∞,a.s.ω∈Ω.Indeed, letun(x,ω)anduO⋆(x,ω)be the solutions of (1) associated toOnandO⋆, respectively. Since the domains inOεenjoy the uniform extension property  [30], there exists a uniformly, w.r.t.O∈Oε, bounded extension operator(7)PO:H1(O)d→H1(D)d,‖PO‖≤k.Letuˆn(⋅,ω)=POn(un)(⋅,ω)be the extension ofuntoD. By (3) and (7),‖uˆn(ω)‖VD≤‖POn‖‖un(ω)‖VOn≤kc(‖f(ω)‖L2(D)d+‖g(ω)‖L2(ΓN)d),a.s.ω∈Ωand thus, by extracting a subsequence,{uˆn(ω)→u⋆(ω)weakly inVDa.s.ω∈Ω,uˆn(ω)→u⋆(ω)strongly inL2(D)da.s.ω∈Ω.Let us prove thatu⋆|O⋆(ω)=uO⋆(ω)a.s.ω∈Ω.From the definition ofun, it follows that∫OnAe(un):e(v)dx=∫Onf⋅vdx+∫ΓNg⋅vdx∀v∈VD,a.s.ω∈Ω,which is equivalent to∫D1OnAe(uˆn):e(v)dx=∫D1Onf⋅vdx+∫ΓNg⋅vdx∀v∈VD,a.s.ω∈Ω.The weak convergence ofuˆnand the strong convergence inL2(D)of the characteristic functions permit to take the limit to get∫D1O⋆Ae(u⋆):e(v)dx=∫D1O⋆f⋅vdx+∫ΓNg⋅vdx∀v∈VD,a.s.ω∈Ω.This proves thatu⋆|O⋆(ω)=uO⋆(ω)a.s.ω∈Ω. Since this is valid for any subsequence, the whole sequence also satisfies this property.Let us consider the compliance in the formJ(On,ω)=∫Onf⋅undx+∫ΓNg⋅unds=∫D1Onf⋅uˆndx+∫ΓNg⋅uˆnds.Due to the strong convergence of1Onanduˆn(and using the compactness of the trace operator [32]), the limit in this expression can be taken to obtain (6).The parts of the cost functional are studied separately as follows•Expectation of the compliance: by the Cauchy–Schwarz inequality, the continuity of the trace operator and (3),(8)J(On,ω)=∫Onf(x,ω)⋅uOn(x,ω)dx+∫ΓNg(x,ω)⋅uOn(x,ω)ds≤‖f(ω)‖L2(D)d‖uOn(ω)‖L2(On)d+‖g(ω)‖L2(ΓN)d‖uOn(ω)‖L2(ΓN)d≤c‖f(ω)‖L2(D)d(‖f(ω)‖L2(D)d+‖g(ω)‖L2(ΓN)d)+c‖g(ω)‖L2(ΓN)d(‖f(ω)‖L2(D)d+‖g(ω)‖L2(ΓN)d)∈LP1(Ω).Combining (6) and (8), by dominated convergence, it follows thatE(J(On,ω))=∫ΩJ(On,ω)dP(ω)→E(J(O⋆,ω))=∫ΩJ(O⋆,ω)dP(ω).Variance of the compliance: from (6) it follows thatJ(On,ω)2→J(O⋆,ω)2a.s.ω∈Ω.Hence, by Remark 1 and (8),∫ΩJ(On,ω)2dP(ω)→∫ΩJ(O⋆,ω)2dP(ω)andVar(J(On,ω))=∫ΩJ(On,ω)2dP(ω)−(∫ΩJ(On,ω)dP(ω))2→Var(J(O⋆,ω))=∫ΩJ(O⋆,ω)2dP(ω)−(∫ΩJ(O⋆,ω)dP(ω))2.□Remark 2Although the existence result of Theorem 2.1 applies to the minimization of compliance, it can be extended to other types of objective functionals. Consider a functionj=j(x,r):D×Rd→R,which is assumed to be measurable w.r.t.x∈D, continuous w.r.t.rfor a.e.x∈D, and such that there exists a positive constantCsuch that(9)|j(x,r)|≤C(1+|r|2),∀(x,r)∈D×Rd.Following similar notations, set(10)Jˆ(O,ω)=∫Oj(x,uO(x,ω))dx.In the same vein of the cost functionalJRα, defined in (5), the following cost functional is consideredJˆRα(O)=E(Jˆ(O,ω))+αVar(Jˆ(O,ω)),α≥0,which, making use of (9), is well-defined providedf∈LP4(Ω;L2(D)d)andg∈LP4(Ω;L2(ΓN)d). In these conditions, the proof of Theorem 2.1 can be used to prove that the existence result holds for the cost functionalJˆRα(O).Following the notation in  [33],θ∈W1,∞(Rd;Rd)is the deformation vector field. The boundary of an admissible domainOis composed of three disjoint parts, namely∂O=ΓD∪ΓN∪Γ0, whereΓDandΓNare fixed andΓ0is the part of the boundary to be optimized. Accordingly, the vector fieldθsatisfies the constraintθ⋅n=0onΓD∪ΓN. The volume constraint, as given in the definition ofUad, is incorporated in the cost functional through an augmented Lagrangian method. According to the approach described in  [34], an augmented Lagrangian function is constructed as(11)JRαL(O)=JRα(O)+L1(∫Odx−V∗)+L22(∫Odx−V∗)2whereL=(L1,L2), beingL1andL2the Lagrange multiplier and the penalty parameter, respectively, used to enforce the volume constraint at convergence. The Lagrange multiplier is updated at each iterationnaccording toL1(n+1)=L1n+L2(∫Odx−V∗). Furthermore, the penalty multiplier is augmented, after every five iterations, multiplying its previous value by 1.2.A formal computation of the shape derivative of the cost functional(12)JRαL(O)=∫Ω[∫Of⋅udx+∫ΓNg⋅uds]dP(ω)+α∫Ω[∫Of⋅udx+∫ΓNg⋅uds]2dP(ω)−α(∫Ω[∫Of⋅udx+∫ΓNg⋅uds]dP(ω))2+L1(∫Odx−V∗)+L22(∫Odx−V∗)2is presented below. For the definition and main properties of shape derivative for shape functionals, the author is referred to [1].Proposition 3.1The shape derivative of the cost functionalJRαL(O)is given by(13)(JRαL)′(O)(θ)=∫Γ0θ⋅n[∫Ω(2f⋅u−Ae(u):e(u))dP(ω)]ds+α∫Γ0θ⋅n[∫Ω(2J(O,ω)f⋅u−f⋅p+Ae(u):e(p))dP(ω)]ds−2αE(J(O,ω))∫Γ0θ⋅n[∫Ω(2f⋅u−Ae(u):e(u))dP(ω)]ds+L1∫Γ0θ⋅nds+L2(∫Odx−V∗)∫Γ0θ⋅ndswhereJ(O,ω)is given by   (4)   and the adjoint statep∈LP2(Ω;VO)solves the system(14)∫Ω∫OAe(p):e(v)dxdP(ω)=−2∫Ω(∫Of⋅udx+∫ΓNg⋅uds)(∫Of⋅vdx+∫ΓNg⋅vds)dP(ω),for allv∈LP2(Ω;VO).Sketch of the proofA rigorous proof of (13) should address the existence of the Gâteaux or Fréchet derivative of (12). This issue has been analyzed in  [1,31] for the case of the Laplace equation. To simplify, a brief formal proof using the Lagrange method due to Céa  [35] is provided in this work for the sake of completeness. Recall that for a generic shape functional as(15)J1(O)=∫OF1(x)dx+∫∂OF2(x)ds,its shape derivative is explicitly given by(16)J1′(O)(θ)=∫∂Oθ⋅n(F1+∂F2∂n+HF2)ds,whereH=div(n). See  [1, Propositions 6.22 and 6.24] for a proof.The first term on the right hand side (RHS) of (13), which is the one associated to the expectation of the compliance, is obtained from (16) following  [33]. The only difference with respect to  [33] is thatF1andF2take the form(17)F1(x)=∫Ωf⋅udP(ω)andF2(x)=∫Ωg⋅udP(ω).Notice that a change in the order of integration has been carried out.For the second term in (13), the Lagrangian(18)L(O,uˆ,pˆ)=∫Ω[∫Of⋅uˆdx+∫ΓNg⋅uˆds]2dP(ω)+∫O∫ΩAe(uˆ):e(pˆ)dP(ω)dx−∫O∫Ωpˆ⋅fdP(ω)dx−∫ΓN∫Ωpˆ⋅gdP(ω)dsis considered, whereuˆ,pˆ∈LP2(Ω;H1(Rd;Rd))satisfyuˆ=pˆ=0onΓD. For a givenO, denoting by(u,p)a stationary point ofL, the derivative ofLwith respect touˆin the directionv∈LP2(Ω;H1(Rd;Rd)), withv=0onΓD, yields(19)0=〈∂L∂uˆ(O,u,p),v〉=2∫Ω(∫Of⋅udx+∫ΓNg⋅uds)(∫Of⋅vdx+∫ΓNg⋅vds)dP(ω)+∫O∫ΩAe(v):e(p)dP(ω)dx.After integrating by parts and by takingvwith compact support inO×Ωgives(20)−div(Ae(p))=−2(∫Of⋅udx+∫ΓNg⋅vds)finD×Ω.Similarly, varying the trace ofv(⋅,ω)onΓNand onΓ0, the following boundary conditions(21)Ae(p)⋅n=−2(∫Of⋅udx+∫ΓNg⋅vds)gonΓN×Ωand(22)Ae(p)⋅n=0onΓ0×Ωare obtained. The variational or weak formulation of (20)–(22) is given by (14).The third term on the RHS of (13) is obtained by applying the chain rule theorem to the third term on the RHS of (12). The fourth term in (13) is obtained from (16), takingF1=1andF2=0. Notice that in the present caseθ⋅n=0onΓD∪ΓN. Finally, the fifth term in (13) is obtained by applying the chain rule theorem to the fifth term on the RHS of (12). □The shape of the unknown domainOis described through the zero level set of a functionψ=ψ(t,x)defined on the working domainDas follows(23)∀x∈Rd,∀t∈(0,T){ψ(x,t)<0ifx∈O,ψ(x,t)=0ifx∈∂O,ψ(x,t)>0ifx∉O.Following the original idea by Osher and Sethian  [36], which was incorporated to the topology optimization framework in  [37,33], the evolution of the shape during the optimization process is controlled by the Hamilton–Jacobi equation(24)∂ψ∂t+(θ⋅n)|∇ψ|=0,t∈(0,T),x∈Rd,wheretstands for a fictitious time that accounts for the step-size parameter in the descent algorithm. The chosen descent direction is thenθ=−vn, where(25)v=∫Ω(2f⋅u−Ae(u):e(u))dP(ω)+α∫Ω(2J(O,ω)f⋅u−f⋅p+Ae(u):e(p))dP(ω)−2αE(J(O,ω))∫Ω(2f⋅u−Ae(u):e(u))dP(ω)+L1+L2(∫Odx−V∗)is the advection velocity in the Hamilton–Jacobi equation (24). Following  [33,38], a regularization procedure for the level set function, which implies a smooth evolution of the shape during the optimization process, is carried out. Oncev=v(x)is computed, solving the stochastic elasticity systems for the stateu=u(x,ω)and the adjoint statep=p(x,ω)and approximating the integrals in the probabilistic spaceΩwhich appears in (25), the level-set method, as proposed in  [33], applies to this context.The uncertainties acting in the PDE input data with spatial variations are characterized by random fields. A random field is completely characterized by an infinite number of random variables, which poses a computational challenge. To address this issue, the following assumption is considered:(A4)Finite dimensional noise: the random input data of (1), i.e. Lamé coefficients and loads, depends on a finite numberNof real-valued random variables{Yn}n=1N.One choice to fulfill the assumption (A4) is the truncated lognormal Karhunen–Loève (K–L) expansion  [39] of a second-order random field of the form(26)a(x,ω)−a0(x)=exp(∑n=1Nγnbn(x)Yn(ω)),witha=μorλ,whereYnare pairwise uncorrelated random variables with zero mean and unit variance,a0∈L∞(D)such thata0(x)≥amin>0a.e.x∈D, andγnandbnare the eigenvalues and eigenvectors, respectively, of the compact and self-adjoint operatorψ↦∫DC(x,x′)ψ(x′)dx′,ψ∈L2(D),beingC(x,x′)the correlation function. If the random field is Gaussian, thenYn∼N(0,1)are independent and identically distributed standard Gaussian variables. From the theoretical point of view, Gaussian variables cannot be used for modeling the uncertainty of Lamé coefficients. This is due to the lower and upper uniform boundedness condition imposed in (A1). However, in practice a Gaussian variable may be accurately approximated considering its truncation at some large enough lower and upper points. Another choice is to takea(x,ω)=a0(x)+βtanh(UN(x,ω)),whereβis a given constant such thata(x,ω)lies within the prescribed bounds, andUN(x,ω)is a truncated K–L expansion of a random field. In addition, some regularity on the eigenfunctionsbn(x)should be imposed. In the case of Gaussian random fields with a covariance function continuous inD¯×D¯, the eigenfunctionsbn(x)are continuous and bounded inD×D[40]. Consequently, the conditions (A1–A3) are satisfied, and thus second-order random fields, in particular Gaussian fields, are allowed to model the uncertainty offandg.Under the finite dimensional noise assumption (A4), and since the random variables{Yn}n=1Nare mapped from the sample spaceΩtoR, the variational formulation of (1) can be rewritten as:(27)∫Λρ(y)∫DAe(u(x,y)):e(v(x,y))dxdy=∫Λρ(y)[∫Df(x,y)⋅v(x,y)dx+∫ΓNg(x,y)⋅v(x,y)ds]dy,∀v∈Lρ2(Λ;VD),whereΛ=Y(Ω)⊂RNandρ=ρ(y)is the joint probability density function ofY=(Y1,…,YN), which is assumed to exist. By a standard localization argument, (27) is equivalent to(28)∫DAe(u(x,y)):e(φ(x))dx=∫Df(x,y)⋅φ(x)dx+∫ΓNg(x,y)⋅φ(x)ds,∀φ∈VD,ρ−a.e.inΛ.Thus, the stochastic boundary-value problem (1) has been transformed into a deterministic PDE system with anN-dimensional parameter.The stochastic collocation method leads to a set of uncoupled deterministic sub-problems (28) collocated at some stochastic nodesyk∈Λ. The shape of the unknown domainOfor each sub-problem is constrained to a bounding boxDtessellated using a fixed grid of finite elements. The fixed grid approximation, also referred as “ersatz material” approach [33], classifies the elements as insideI, outsideOand boundaryBelements according to their position with respect to the level set functionψ. (See  [41] for more details.) The Hooke’s law is then modified as(χe+Δ(1−χe))A, whereΔ=10−3andχe=VIe/Veis the volume ratio between the volume of elementVIeenclosed byOand the total volume of elementVe. From this point on,VDhdenotes a finite element space approximating the Sobolev spaceVDintroduced in Section  2.1, wherehstands for the size of the spatial mesh. Quadrangular meshes and LagrangeQ1finite elements are used in the experiments of Section  5.The number of terms required by the K–L expansion in (26) depends on the decay rate of its eigenvalues. The required terms in (26) can lead to unaffordable computational problem when full tensor product rules are used for uncertainty propagation. Conversely, the isotropic sparse grid approaches  [42–44] permit to reduce the number of collocation points keeping the level of accuracy for problems whose random variables weigh equally in the solution. However, the convergence rate is deteriorated for highly anisotropic problems  [44]. This is the case of K–L expansions in which random variables corresponding to large eigenvalues have more influence than those associated to low eigenvalues. In this case, an anisotropic sparse tensor product can lead to highly accurate solutions while reducing drastically the computational requirements. Finally, the level of the quadrature rule used for the numerical approximation of integrals in the probability space should be adaptively chosen as to comply with a prescribed accuracy level.The numerical approximation in the random domain is performed using the adaptive anisotropic sparse grid collocation method described in [45]. For an integerℓ∈N+, called the level, and a vector of weights for the different stochastic directionsβ=(β1,β2,…,βN), consider the index setXβ(ℓ,N)={i=(i1,…,iN)∈N+N,i≥1:∑n=1N(in−1)βn≤ℓβ¯},withβ¯≔min1≤n≤Nβn. Similarly to the isotropic Smolyak quadrature rule  [46], the anisotropic Smolyak quadrature formula applied to a generic functionF:Λ→Ris given by(29)Aβ(ℓ,N)F=∑i∈Xβ(ℓ,N)(Δi1⊗⋯⊗ΔiN)F,=∑r1=1Ri1⋯∑rN=1RiNF(y1r1,…,yNrN)w1r1⋯wNrNwhereΔin=Qin−Qin−1, withQ0=0, is a quadrature rule in which the coordinatesynrnof the nodes are those for the 1D quadrature formulaQinand its associated weightswnrnare the difference between those for theinandin−1levels. The number of collocation points innth direction is denoted byRin. The numerical experiments presented in Section  5 make use of Gauss–Legendre and Gauss–Hermite 1D-quadrature rules. The vector of weightsβdepends on the analyticity properties of the solutionu(x,y)with respect toy∈Λ. For the case of Gaussian random variables  [47,48], thenth term of the vectorβtakes the following form(30)βn=122γn‖bn‖L∞(D),with(γn,bn(x))the eigenpair in the K–L expansion.The levelℓof the quadrature rule is adaptively chosen as to comply with a prescribed accuracy level0<ε≪1. This is done as follows:(i)Calculate the vector of weightsβaccording to (30).Initialize the levelℓ=1and a positive, large enough, integerℓ¯.Determine the discrete numerical approximationAβ(ℓ,N)Jh(O), whereJh(O)is the compliance associated touh(numerical approximation ofu; precisely,uhis obtained by solving, via finite elements, (28) at the stochastic nodesykwhich come from the quadrature rule (29)) andAβ(ℓ,N)Jh(O)is given by (29), withF=Jh(O).Calculate the norm overL2(D)of the mean and the variance ofJh(O)denoted byEβ,ℓ,Nh=‖Aβ(ℓ,N)Jh(O)‖L2(D)2andVβ,ℓ,Nh=‖Aβ(ℓ,N)Jh2(O)−Aβ(ℓ,N)Jh(O)2‖L2(D)2.Calculate the numerical approximation of an enriched solution given by(31)Aβˆ(ℓ̄+1,N)Jh(O),withβˆn=(In(β,ℓ¯)−1In(β,ℓ¯))(βnβ¯),where the maximum index in each directionIn(β,ℓ¯)=maxi∈Xβ(ℓ¯,N){in}is introduced.Compute the norm overL2(D)of the mean and the variance of the enriched solution as followsEβˆ,ℓ̄,Nh=‖Aβˆ(ℓ̄+1,N)Jh(O)‖L2(D)2andVβˆ,ℓ̄,Nh=‖Aβˆ(ℓ̄+1,N)Jh2(O)−Aβˆ(ℓ̄+1,N)Jh(O)2‖L2(D)2.Finally, the levelℓis increased linearly (fromℓ=1toℓ=ℓopt≤ℓ¯) up to the stopping criterion(32)max{|Eβ,ℓ,Nh−Eβˆ,ℓ̄,Nh|Eβˆ,ℓ̄,Nh,|Vβ,ℓ,Nh−Vβˆ,ℓ̄,Nh|Vβˆ,ℓ̄,Nh}≤εis satisfied.The resolution of the adjoint problem (14) follows the same stages as for solving the direct problem. After projecting Eq. (14) onto the finite element spaceVDh, the resulting equation is collocated at the nodesykof the random domainΛleading to∫DAe(ph(x,yk)):e(φh(x))dx=−2(∫Df(x,yk)uh(x,yk)dx+∫ΓNg(x,yk)uh(x,yk)ds)⋅(∫Df(x,yk)φh(x)dx+∫ΓNg(x,yk)φh(x)ds),whereuh(x,yk)is the numerical approximation of (28),ph(x,yk)is the solution of the projected equation andφh(x)are the shape functions inVDh. Notice that by exploiting the linear nature of tensorA, the solution of the adjoint problem is as followsph(x,yk)=−2ckuh(x,yk),withck=∫Df(x,yk)⋅uh(x,yk)dx+∫ΓNg(x,yk)⋅uh(x,yk)ds.The use of stochastic collocation methods during the optimization process can notably increase the computational cost. However, these methods are considered embarrassingly parallel because they have no shared state and can be executed in complete isolation. For that reason, stochastic collocation methods become an attractive tool for uncertainty propagation tasks with the advent of High Performance Computing (HPC). Task-level parallelism is used for implementing the resolution of the direct and adjoint state equations at eachyk∈Λstochastic node in clustering. This is done adopting a Master–Worker Pattern, which permits to perform simultaneous processing across multiple machines or processes via a Master and multiple Workers. The Master creates a set of tasks at eachyk∈Λ, which consist of the resolution of the direct and adjoint states using finite element analysis. The Workers calculate these works in clustering, taking work after work until the set of tasks has been calculated. After receiving all samples at the stochastic nodes, the Master evaluates the statistical moments involved in the objective function and the shape derivative.The effectiveness of the proposed development for robust shape optimization of continuous structures is evaluated using three benchmarks; in particular, the designs of “beam-to-cantilever”, “electric mast” and “half-wheel” problems. The first two problems aim to optimize a design domain under uncertain loading whereas the last problem is concerned with the optimization under uncertain material properties. These experiments aim to show that the proposed development is able to consider different probability distributions as well as random fields as input uncertain loading and material properties. All the benchmarks make use of a fixed grid ofQ1quadrangular plane stress finite elements with Young’s modulusE=1and Poisson’s ratioν=0.3. The level set functionψ(t,x)is discretized at the nodes of such a fixed grid. The Lagrange multiplier and the penalty parameter of the augmented Lagrangian function (12) are initialized heuristically according toL1=0.1⋅JRα(O)/V∗andL2=abs(0.01⋅L1/V∗). The resolution of the direct and adjoint state equations at each stochastic node is computed using a cluster with 8 nodes. Such nodes are equipped with 2 Intel Xeon E5-2620 at 2 GHz and 32 GB of RAM memory.In all the numerical experiments the algorithm stops at the firstn∈Nfor which the two following conditions are satisfied:max1≤i≤5{|(JRαL)n−(JRαL)n−i|≤0.01(JRαL)n}and|Vn−V∗|≤0.005.The beam-to-cantilever problem consists in the shape optimization of a two-dimensional cantilever under uncertain loading conditions. Such a benchmark is widely used  [10,20,29] to show the effects of uncertain loading in the robust optimal design. The left edge of the cantilever is anchored and a unit force with uncertainty in direction, centered in the horizontal line, is applied at the middle of the right edge. The design domain is a 1×2 rectangle which is tessellated using a 60×120 quadrangular mesh (h1=h2=0.016). The uncertain loading, the boundary conditions and the tessellation of the design domain are depicted in Fig. 1(a), whereas the initialization of the level-set function is shown in Fig. 1(b).The configuration and the numerical resolution of the robust shape optimization problem is as follows. The target volume is set to 30% of the initial design domain. The directionϕof the unit-load follows a probabilistic distribution centered at the horizontal line,ϕ=0, with the deterministic loading state as the mean valueμϕ=0. The influence of the level of uncertainty on the robust shape design is shown by the consideration ofσϕ={π/6,π/12,π/24,π/32,π/42}standard deviation values. In the same vein, three different probability distributions ofϕare considered to study the effect of the skewness of stochastic distribution on the robust shape design; in particular, Gaussian, Uniform and Gumbel probabilistic distributions are evaluated. Non-normal stochastic distributions are transformed into a Gaussian distribution, and then the Gauss–Hermite quadrature rule with a levelℓ=5is used to obtain the statistical moments of the compliance.The deterministic optimization required 69 iterations to convergence whereas the robust optimization (for caseα=1) required 57 iterations to converge. Each iteration of the robust optimization required to solve 5 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 5 workers was 2.568 s, which is very close to the required by the deterministic optimization 2.256 s. The deterministic shape optimization design (classical beam) for the horizontal (ϕ=0) unit-load is depicted in Fig. 2(a). The robust optimized designs for the minimization of the functional costJRαLare shown from Fig. 2(b) to (f) for various magnitudes of the parameterα. The resulting robust designs incorporate stiffness in the vertical direction where the uncertain loading is introduced. Higher values of the parameterα, increasing the weight of the variance in the functional cost, lead to more robust structural designs at the cost of decreasing their optimality. One can observe how the increase in robustness is firstly achieved by means of topology modifications, increasing the redundancy by adding paths to transmit the load to the support, and then by thickening the cantilever members. The trade-off between structural robustness and structural performance is shown in the Pareto front depicted in Fig. 10(a).The effect of the amount of uncertainty using a Gaussian probability distribution for the directionϕof the unit-load is shown in Fig. 3. This experiment shows the different shape optimal designs of the functional costJRαLfor a given value ofα. One can observe how the increment in the uncertainty of the directionϕof the unit-load increases the span between supports and the thickness of members, which increment the vertical stiffness. The effect of the probability distribution used to model the uncertainty of the directionϕof the unit-load is shown in Fig. 4. One can conclude that the modeling of uncertainty using different probability distributions has a notable influence in the optimal design. The robust shape optimization using Gaussian and Uniform distributions for the directionϕof the unit-load leads to symmetric optimal designs, whereas the resulting optimal design using Gumbel distribution for the directionϕis asymmetric by a diversification of the load path in the direction of the skew.The electric mast benchmark consists in finding the best structural design for a T-shaped design domain where the bottom part of the T-leg is simply-supported and two “symmetric” vertical unit loads (g=1) are applied in the bottom middle part of T-shafts. The uncertain loading is modeled by introducing horizontal uncertain loads in the points where the vertical unit loads are applied. These horizontal uncertain loads are modeled as independent random variables following a uniform distributionU(0,1). The uncertain loading represents the force applied by the wires on the mast. This problem has also been widely studied in the context of robust topology optimization with different loading conditions. In particular, vertical force perturbations are considered in  [10] whereas lateral force perturbations are considered in  [25].The uncertain loading, the boundary conditions and the tessellation of the design domain are depicted in Fig. 5(a). The design domain is discretized by 6400 square elements (h1=h2=0.05). A non-nested quadrature rule whose collocation nodesykare determined by the roots of Legendre polynomials are used. Due to the symmetry of the design domain and boundary conditions, an isotropic vector of weightsβ=[1,1]is considered in this problem. The nodes and weights of the isotropic sparse grid are computed adaptively as described in Section  4 withN=2,ℓ̄=12,ε=10−3andℓopt=3. The Sparse grids Matlab toolbox  [49] was used to implement the adaptive sparse grid algorithm presented above. The initialization of the level-set function is shown in Fig. 5(b). The target volume is set to 30% of the initial design domain.The deterministic optimization required 86 iterations to convergence whereas the robust optimization (for caseα=1) required 99 iterations to converge. Each iteration of the robust optimization required to solve 13 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 13 workers was 3.945 s, which is slightly greater than the time required by the deterministic optimization 3.512 s. Fig. 6(a) shows the deterministic optimal solution obviating the horizontal uncertain loading and Fig. 6(b–d) depict the robust optimal shapes for several magnitudes of the parameterαof the cost functionalJRαL. One can observe how the robust designs differ meaningfully from the deterministic optimal design. The robust designs show a larger span between supports than the deterministic optimal solution. Besides, the material distribution of stochastic designs is further from the symmetry axis than the deterministic optimal solution, which provides a higher lateral stiffness to such robust designs. In the same vein, the number of members of the robust designs is higher than the deterministic design, which diversifies the load paths.Regarding the robust designs, all of them share the same topology (number of holes). However, the shape of the holes and the thickness of the members are adapted to fulfill the robustness requirements. The increment of the parameterαcauses a redistribution of the material from the T-shafts to the cross bars of the T-leg, which increases the lateral stiffness. Fig. 10(b) shows the Pareto front of the different robust designs balancing the mean and standard deviation of the compliance.The half-wheel experiment unfolds in the two-dimensional structural configuration shown in Fig. 7(a). The design domain is a bounding box of dimension 16×12 tessellated using a 100×75 fixed grid (h1=h2=0.16). Such a design domain has a roller support in the bottom right-hand corner and a fixed support in the bottom left-hand corner. A vertical unit load is applied at the center of the bottom edge. The uncertainty in the Young’s modulus is modeled by a 2D lognormal random field through the transformation(33)F(x)=exp(η(x)+ξ(x)U(x)),with(34)η(x)=log(1(1+Var(x))1/2)ξ(x)=(log(1+Var(x)))1/2Var(x)=(0.0054x2−0.0857x)2,whereη(x)andξ(x)are the location and scale parameters of the lognormal distribution. The random fieldUis assumed to have zero mean, unit variance and the following isotropic squared exponential correlation function(35)C(x,x′)=exp[−∑i=12(xi−xi′)2l2],wherex=(x1,x2),x′=(x1′,x2′)∈Dandl=8is the correlation length. The Gaussian random fieldUis discretized through the truncated K–L expansion (26). Fig. 7(c) shows a realization of the lognormal discretized random fieldF. According to the decay rate of the eigenvalues, the K–L expansion is truncated at its ninth term to capture 90% of the energy field. Since the considered random variablesYnare Gaussian, a non-nested quadrature rule, whose collocation nodesykare determined by the roots of Hermite polynomials, are used. The nodes and weights of the anisotropic sparse grid are computed adaptively as described above withN=9,ℓ̄=14,ε=10−3andℓopt=8. The level-set function initialization is depicted in Fig. 7(b). Similarly to previous problems, the target volume is set to 30% of the initial design domain.Table 1shows the values of the maximum indicesI(β,ℓ)obtained through the adaptive process for computingAβ(ℓ,N). Additionally, the values of the maximum indicesIˆ(βˆ,ℓ̄+1)for computing the enriched solution are shown. The convergence rate, depicted in Fig. 8, reveals a (sub)-exponential decay of the error as the number of points increases linearly. It also shows that the level, and also the number of points, of the anisotropic sparse grid are governed by the error of the variance of the compliance, which has the slowest rate of convergence.The deterministic optimization required 148 iterations to convergence whereas the robust optimization (for caseα=1) required 134 iterations to converge. Each iteration of the robust optimization required to solve 5627 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 96 workers was 121.38 s, which is significantly greater than the 3.15 s required by the deterministic optimization. The optimal designs minimizing the functional costJRαLfor several magnitudes of the parameterαare shown in Fig. 9. One can observe that the structural robustness is increased modifying the topology design. Such topology modifications introduce new elements that diversify the load paths increasing the structural redundancy. This diversification requires increasing the height of the arch for large values ofα. Fig. 10(c) shows the trade-off between the mean and standard deviation for this robust shape structural optimization problem. One can observe that the increment of structural robustness implies a degradation of the structural performance in terms of compliance.

@&#CONCLUSIONS@&#
