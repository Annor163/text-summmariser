@&#MAIN-TITLE@&#
Medical image fusion based on hybrid intelligence

@&#HIGHLIGHTS@&#
A new hybrid algorithm called hybrid intelligence image fusion (HIIF) is used for fusing multimodal medical images.It uses two stages of intelligence. In the first stage, edges are detected using ACO technique and the edges are enhanced.The first stage output is given as the input to the second stage which is a simplified pulse coupled neural network.The algorithm was tested on 5 datasets of PET and MRI and 5 datasets of SPECT and MRI.The proposed algorithm performs better compared to the existing intelligence method.

@&#KEYPHRASES@&#
Hybrid intelligent system,Medical image fusion,Ant colony optimization,Pulse coupled neural network,Fusion metric,Edge enhancement,

@&#ABSTRACT@&#
Medical image fusion combines complementary images from different modalities for proper diagnosis and surgical planning. A new approach for medical image fusion based on the hybrid intelligence system is proposed. This paper has integrated the swarm intelligence and neural network to achieve a better fused output. The edges are an important feature of an image and they are detected and optimized by using ant colony optimization. The detected edges are enhanced and it is given as the feeding input to the simplified pulse coupled neural network. The firing maps are generated and the maximum fusion rule is applied to get the fused image. The performance of the proposed method is compared both subjectively and objectively, with the genetic algorithm method, neuro-fuzzy method and also with the modified pulse coupled neural network. The results show that the proposed hybrid intelligent method performs better when compared to the existing computational and hybrid intelligent methods.

@&#INTRODUCTION@&#
Medical image fusion (MIF) combines images to provide accurate and reliable information. The images can be from different modalities like PET, CT, SPECT, MRI, etc., or from the same modality obtained at different times. The MIF is used to improve confidence in diagnosis, to provide structural and functional information in the same image, to increase the reading efficiency, to quantify the difference between scans, to plan radiation therapy and much more [1].The computational intelligent systems (CIS) play a crucial role in the field of medicine [2]. CIS like fuzzy logic, neural networks, machine learning, swarm intelligence and genetic algorithms are applied to different medical problems and domains like neurology, oncology, gynecology, cardiology, radiology and ophthalmology [3,4]. The CIS are applied widely for the fusion of medical images [5–13].In the recent years, many algorithms based on hybrid intelligent systems (HIS) are developed for medical diagnosis and computer assistance, patient monitoring and patient care [14–17]. HIS is a combination of intelligent tools and techniques that make sense in a theoretical and practical basis for performing in a competitive way when compared to simple intelligent techniques. It can be framed either by integrating two or more intelligent systems, which maintains the identity of each methodology, or by fusing one system into another or by transforming the knowledge representation of one intelligent system into another form with the characteristic of the another intelligent system. The different hybrid soft computing architectures are given in the literature [18]. The performance of HIS depends not only upon the choice of the intelligent systems but also on the architecture of the hybrid intelligent systems. The right components need to be selected for building a good hybrid system. A very few research works using the HIS has been carried out in the field of the MIF. The algorithms are developed by combining the neural network and fuzzy logic, generally known as neuro-fuzzy [19–23].Many algorithms using the CIS have been applied to the MIF [5–13]. In the literature [6], authors have fused CT and MRI images by using Mamdani-type minimum-sum-mean of maximum (MIN-SUM-MOM) algorithm. The fuzzy implication operation has used MIN algorithm and SUM was applied for calculating the membership functions of total output set. In order to defuzzify, the MOM algorithm was used. The fusion algorithms using pulse coupled neural network (PCNN) were developed in the past decade [8–11]. The feeding input which is applied to the modified PCNN (m-PCNN) in the application of image fusion [8] used the normalized gray value of the input image. In most of the MIF work with PCNN, the normalized value of the single pixel intensity in spatial or transform domain of the input image is used as the feeding input of the neuron [7–10]. In the transform domain, the image coefficients which are negative are normalized by considering the absolute value of the coefficients. This leads to the loss of directional details. In literature [11], for fusing CT and MRI images, the modified spatial frequency of the high frequency region in the discrete ripplet transform domain is given as input to the PCNN. In literature [24], for fusing multifocal images, the focus measure is given as an input to the m-PCNN. These methods which are applied to the PCNN are not effective as the edge and the directional information are lost.To overcome the above limitation of the PCNN method, suitable modification is carried out in the feeding input and in the linking field of the PCNN and it is represented as simplified PCNN (s-PCNN) in this paper. The integration and synergetic effects of swarm intelligence and neural network is proposed. This method utilizes one of the hybrid soft computing architecture discussed in the literature [18] and it is shown in Fig. 1. In this paper, the swarm intelligence of ant colony is used to detect and optimize the edges. The output of the ant colony optimization (ACO) is enhanced and it is given as the feeding input to the neural network. The proposed MIF based on the HIS technique is named as hybrid intelligence image fusion (HIIF) scheme. The datasets of PET and MRI, SPECT and MRI are taken to study the effectiveness of the HIIF method and the fused output is compared quantitatively and qualitatively with the existing method.The proposed HIIF architecture for MIF is shown in Fig. 2. Here, the intelligent systems are cascaded to get the fused output. An optimization technique to use in the neural network is proposed for getting accurate and precise information of the input images from a single fused image.The various steps of the HIIF fusion scheme are:•The perfectly registered datasets are given as input to the HIIF fusion scheme.The edges of the input images are optimized using ACO and enhanced.The enhanced edge images are applied as feeding input to s-PCNN which produces the firing maps for both the images.Then maximum fusion rule is applied which results in the fused output.Two types of datasets are taken for testing the performance of the proposed algorithm. Type-I consists of PET and MRI images and Type-II consists of SPECT and MRI images [25]. Five datasets from each type are used for testing. The size of the image is 256×256×3 with intensity values ranging from 0 to 255. Two sets of input images are shown in Fig. 3(a)–(d). The remaining eight datasets are given in Appendix.Fig. 3(a) shows the PET-FDG image of a person suffering from Astrocytoma and (b) shows the MR-GAD image of the same person. Fig. 3(c)–(d) shows SPECT-Tc and MR-T2 image of a person suffering from chronic subdural hematoma.Edges are the points where discontinuities or sharp changes in intensity occur. They play an important role in understanding the content of the image clearly. For maximizing the information content of the image, enhancement of the image is required. In the proposed HIIF method, a new technique for image enhancement is carried out by applying the enhancement criteria only to the edgels. The edgels are detected and optimized using the ant colony optimization (ACO) technique.ACO technique is an optimization algorithm inspired by the natural collective behavior of the ant species. Number of ants are utilized to evolve on a 2D image and to construct the pheromone matrix. This matrix represents the edge information at each pixel based on the path followed by the ants. The ant colony moves to the neighboring pixels based on the image intensity values and follows the path where the intensity of the pixel varies [26–28]. The various process involved are initialization, construction, update and decision.Let the input images be I1 and I2 and let the size of each input image be M×M.In the beginning, all the necessary parameters are initialized. Let the number of ants be equal to M. The pheromone matrix τ(0) is initialized. Each element of the matrix is set to a constant value which is equal to τi.An ant is randomly selected from the M ants and let this ant move L steps on the image. At the kth construction step, the selected ant moves from node (i,j) to the neighboring node (p,q) according to the transition probability given by Eq. (1).(1)P(i,j),(p,q)(k)=τ(i,j),(p,q)(k−1)αη(i,j),(p,q)β∑(p,q)∈Ω(i,j)τ(i,j),(p,q)(k−1)αη(i,j),(p,q)βwhereτ(i,j),(p,q)(k−1)is the quantity of pheromone on the edge from node (i,j) to node (p,q),η(i,j),(p,q) – the heuristic information of the edge from node (i,j) to node (p,q),Ω(i,j) – the neighborhood nodes of the ant at the position (i,j),α – a constant which controls the pheromone information,β – a constant which controls the heuristic information.The denominator term is a normalization factor which is used to limit the values ofP(i,j),(p,q)(k)within [0,1].In order to determine the heuristic information given in Eq. (1), the variation in image intensity value on the local group of pixels, g is determined. It is given in Eq. (2).(2)η(i,j),(p,q)=vg(I1(p,q))∑p=1:M∑q=1:MVg(I1(p,q))whereI1(p,g)is the pixel intensity of the image I1 at the position (p,q) andVg(I1p,g)– the variation of image intensity value on the local group of pixels and it is defined as(3)Vg(I1p,q)=sinπx2λ0≤x≤λ0elsewhere λ is the parameter used to adjust the functions shape and it is taken to be one. The value of x is expressed as in Eq. (4).(4)x=|Ip−2,q−1−Ip+2,q+1|+|Ip−2,q+1−Ip+2,q−1|+|Ip−1,q−2−Ip+1,q+2|+|Ip−1,q+2−Ip−1,q−2|+|Ip−1,q−1−Ip+1,q+1|+|Ip−1,q+1−Ip−1,q−1|+|Ip−1,q−Ip+1,q|+|Ip,q−1−Ip,q+1|The permissible range of ant movement, Ω(i,j) at the position (i,j) is considered as 8-way connectivity neighborhood.The pheromone matrix is updated after the movement of each ant within each construction step according to Eq. (5).(5)τ(i,j),(p,q)(k−1)←(1−ρ)⋅τ(i,j),(p,q)(k−1)+ρ.Δ(i,j),(p,q)lif(p,q)is visited by thelth antτ(i,j),(p,q)(k−1)otherwisewhere ρ is the evaporation rate andΔ(i,j),(p,q)lis determined by the heuristic matrix. The pheromone matrix is again updated after the movement of all ants within each construction step according to Eq. (6).(6)τk=(1−ψ)⋅τ(k−1)+ψ⋅τ(0)where ψ is the pheromone decay constant.The decision process determines whether each pixel position is an edge or not. A binary decision is made by applying a threshold T on the final pheromone matrix τ(N). The threshold, T is computed adaptively based on Otsu's algorithm.The initial threshold T(0) is selected as the mean value of the pheromone matrix τ(N) as given in Eq. (7)(7)T(0)=∑p=1:M∑q=1:Mτp,qNM2To compute the next threshold, the entries of the pheromone matrix are separated into two parts. The entries of the pheromone matrix are compared with the initial threshold T(0). The values less than T(0) and the values greater than T(0) are separated and classified. The mean values of these separated pheromone matrix are calculated.Let l(0) be the mean value of the pheromone matrix which are less than T(0) and let u(0) be the mean value of the pheromone matrix which is greater than T(0).(8)l0=∑p=1:M∑q=1:MC1τp,q(N)∑p=1:M∑q=1:MD1τp,q(N)(9)u0=∑p=1:M∑q=1:MC2τp,q(N)∑p=1:M∑q=1:MD2τp,q(N)where(10)C1τp,q(N)=τp,q(N)ifτp,q(N)≤T(0)0otherwise(11)D1τp,q(N)=1ifτp,q(N)≤T00otherwise(12)C2τp,q(N)=τp,q(N)ifτp,q(N)≥T00otherwise(13)D2τp,q(N)=1ifτp,q(N)≥T00otherwiseThe average of the mean values gives the new threshold as given in Eq. (14).(14)T(1)=l(0)+u(0)2The iteration is continued until convergence. The edge Ep,qis determined as explained in Eq. (15).(15)Ep,q=1τp,q(N)≥T(r)0otherwisewhere r is the iteration index. The edge detected outputs for the input images of Fig. 3(a) and (b) are shown in Fig. 4(a) and (b) respectively.The input image is enhanced or sharpened only on the pixel points where the edges are detected. The edge enhanced image Ehi,jis obtained using the statistical scaling [29] as given in Eq. (16).(16)Ehi,j=Ki,j(I1i,j−c×mi,j)+mi,jaifEi,j=0I1i,jotherwisewhere mi,jis the local mean of the image in an 5×5 window, Ki,jis the enhancement function, the constant a can take values between 0 and 1.5 and c can take the value between 0 and 1. The edge enhanced images for the same sets of input images are shown in Fig. 4(c) and (d) respectively.The PCNN is an artificial neuron model which resembles the visual cortex of the cat. It does not require training and it has global coupling and synchronization characteristics. It is a feedback network formed by the connection of neurons. The basic model has three parts, viz. the receptive field, the modulation field and the pulse generator [30]. The basic PCNN model has certain disadvantages like slow processing, many parameters are required to be set and it is difficult to determine the parameter values. These are overcome by many modified versions of the PCNN (m-PCNN) used in simulating the image fusion algorithms [8–11].The MIF requires that the fused output provides all the information available in the input images and also gives clear edge information. This paper has carried out certain changes in the feeding input and linking field of the m-PCNN which is called as s-PCNN. The s-PCNN is shown in Fig. 5.The feeding input (Fi,j), which are applied to the m-PCNN in the application of image fusion [8–10], are not effective as the edge information and the directional information is lost. In this paper, the edge enhanced image in spatial domain as detailed in Section 2.3 is given as the feeding input of s-PCNN in order to preserve the edge information in the fused output. The feeding input to activate the neuron is given as in Eq. (17).(17)Fij(n+1)=Ehi,jwhere Ehi,jis the enhanced edge image, obtained using Eq. (16).In the traditional PCNN algorithm and the m-PCNN algorithm, the computational cost is more as the linking input Lijdepends upon the previous value of linking and on the weighted output of the other neighboring neurons. Also, L varies according to the number of other pixels that are fired in the local neighborhood. In this paper, the limitation of the traditional and m-PCNN algorithm is overcome by using sigmoidal linking. The linking modulation is either on or off. To make L uniform, threshold the linking input using the matrix S. The linking input is given in Eq. (18).(18)Lij(n+1)=1ifL1(n+1)>S0otherwisewhere(19)L1(n+1)=Yij(n+1)⊗KYij(n+1)istheoutput, ⊗ represents convolution and the K is the convolution kernel. The matrix S is a zero matrix and it is defined with the same dimension as the input image (I) [30]. The linking input, L is set to one everywhere the convolved value is greater than S. It is zero, if the convolved value is less than or equal to S. The matrix S is defined to be zero to make the linking modulation either on or off.As the essential features of PCNN are pulses and products, the decaying mechanism of threshold is not important [31]. The traditional model of PCNN uses an exponentially decaying threshold Tij. This paper has applied the linear decay threshold mechanism as computational time is considerably reduced. The linear decay threshold is given in Eq. (20).(20)Tij(n+1)=Tij(n)−dT+VTYij(n+1)where dT decides the linear decay speed of the dynamic threshold and VTis the coefficient of Y term in dynamic threshold.The internal activity Uijconsists of both the feeding input and the linking input. The feeding field is modulated by the linking field and the internal activity is given in Eq. (21).(21)Uij(n+1)=Fij(n+1)(1+β(Lij(n+1)))where β is the linking strength.When the internal activity is greater than the dynamic threshold, the corresponding neuron fires and the output Yijis equal to one.(22)Yij(n+1)=1ifUij(n+1)>Tij(n+1)0otherwiseEach neuron firing time Mijis given in Eq. (23).(23)Mij(n+1)=Mij(n)+Yij(n+1)The parameters which are used in the s-PCNN are listed below.Total number of iterations=40.Magnitude scaling term of threshold potential, VT=10.Linking strength of PCNN neuron, β=0.1.K=[0.707 1 0.707; 1 0 1; 0.707 1 0.707].Edges are detected for both the input images using ACO and are enhanced. The edge enhanced images are given as input to s-PCNN and the firing times M1(i,j) and M2(i,j) are computed. The maximum fusion rule is applied and is given in Eq. (24).(24)IF(i,j)=I1(i,j)ifM1(i,j)≥M2(i,j)I2(i,j)otherwisewhere IF(i,j) is the fused output and I1(i,j), I2(i,j) are the input images.

@&#CONCLUSIONS@&#
A novel HIIF method for fusing the multimodal medical images is proposed in this paper. The edge is detected using ACO technique. The edge detected image is enhanced using statistical scaling. It is given as the feeding input to the s-PCNN where the sigmoid linking and linear decay threshold are used. The simulation was carried out using MATLAB version 7.6. Ten datasets of input images are fused. Five datasets each of PET and MRI and five datasets each of SPECT and MRI are used for the fusion. The PET and SPECT images give the functional information whereas the MRI image gives the structural or anatomical information. These images when fused provide the radiologist the necessary information about the lesion and it is used for accurate diagnosis. The lesion is localized precisely, so that it also aid the radiologist in the medical treatment planning. There are no artifacts in the proposed method. The edges are clearly visible in the fused output. The objective analysis confirms the observation of the radiologists. The metrics like entropy, standard deviation, average gradient, MI, SSIM, correlation coefficient, bias and UIQI indicates that the performance of the HIIF algorithm is better when compared with the existing intelligence method like GA, m-PCNN and NF algorithm. The computation time involved in the proposed method is more compared to the GA method, NF algorithm and less compared to the m-PCNN algorithm. The computational time is not of much significance as the medical images used for diagnostic purpose require accurate and precise information which was provided by the HIIF method.