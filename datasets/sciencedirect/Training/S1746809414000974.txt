@&#MAIN-TITLE@&#
Automatic artifact removal from GFR measurements

@&#HIGHLIGHTS@&#
We propose a new motion artifacts correction method for renal function measurement.Renal function can be reliably measured in freely moving animals.The performance of the proposed method is demonstrated on real and simulated data.The method is suitable for any noisy nonperiodic signals containing unwanted shifts.

@&#KEYPHRASES@&#
Artifact removal,Cluster analysis,Glomerular filtration rate (GFR),Renal function,

@&#ABSTRACT@&#
Measurement of renal function in awake rats or mice can be accomplished by an intelligent plaster device that fits on the back of animals. The device performs a percutaneous measurement of the kinetics of a labeled fluorescent dye exclusively eliminated by the kidney. During the measurement, relative motion between plaster and skin leads to a variation of the illumination conditions, which emerge as artifacts in the data. In this paper, a novel strategy to detect and eliminate artifacts is suggested. The method combines cluster analysis and nonlinear regression with a priori knowledge about signal morphology to correct data. The performance of the proposed method is demonstrated on real and simulated data. Simulations were performed on data with two artifact amplitude ranges: (1) shifts in the recorded data with amplitude exceeding 3% of the signal amplitude for a combined duration of 10% of the total measurement time and (2) shifts greater than 3% for approximately 30% of the total measurement time. Prior to artifact removal, the MAE was calculated to be 10.3% and 21.9%, respectively. Following artifact removal using the proposed method, results showed that, when determining the half-life, the mean absolute error (MAE) was 0.88% for range type 1 and 10.4% for the more substantial range of the type 2 artifacts. When examining real data, the mean difference (bias) while determining the half-life was 7.5%. Results show that novel technique outperforms a number of state-of-the-art techniques when removing artifacts from the signal recorded while an animal is allowed to move freely. In this case, the signal acquires shifts and random changes with large amplitudes, which make it impossible to use standard methods.

@&#INTRODUCTION@&#
Glomerular filtration rate (GFR) is a standard clinical parameter characterizing kidney function. Determination of the urinary or plasma clearance of exogenous renal markers is considered as gold standard for GFR measurement [1]. The main issues of application of the device for the transcutaneous measurement of the elimination kinetics of the fluorescent-labeled exogenous GFR marker in freely moving rats are discussed in [2,3].Artifacts in GFR measurements pose problems for the interpretation of recorded signal. Unlike instrumental artifacts, to eliminate the artifacts arising from motion is more difficult due to the fact that the frequency spectra of motion artifacts and the desired signal overlap. Thus standard frequency filters cannot be implemented [4]. Basic techniques for artifact removal in the field of biomedical signal processing are discussed in detail in [5]. Artifact removal is widely applicable to process signals of electrocardiography, electromyography, electroencephalography (EEG), photoplethysmography, pulse oximetry, and functional near infrared spectroscopy.Among other methods, artifact removal by adaptive filtering is a widespread approach [6]. These filters require a reference signal to adjust their parameters or structure and lead to excellent artifact suppression. The additional signal is also applied to produce the error signal for self-adjustment of the filter. However, the approach relies on additional sensors that often cannot be integrated into the system.Optimal filtering can be achieved by using the statistical technique of Wiener–Kolmogorov type. However, it requires a priori knowledge on the statistics of the desired signal and noise. Therefore, the power spectral densities of these signals should be estimated from measurements [7]; however, the latter is a non-trivial task. Kalman filtering is another statistical technique. The classical Kalman filter is a statistically optimal estimator of the underlying system state, assuming the observation model and the system dynamics are linear functions of the state [8]. Particle filtering is similar to the Kalman filtering but unlike it does not require the model being linear or the distribution being unimodal. To date, artifact separation and removal using the particle filter has not been widely investigated, relative to physiological signals [5].In fact, if additional information on the source signals or the mixing process of the desired signal and artifacts are lacking, blind signal separation (BSS) should be applied. Canonical correlation analysis (CCA) is a BSS technique in which a second-order statistics is used to form components by maximizing their autocorrelation and minimizing mutual correlation. [9]. Moreover, independent component analysis (ICA) is a widely spread method in biomedical signal processing [5,10,11]. ICA uses higher order statistics to separate a given signal into statistically independent components (sources that have non-Gaussian distributions). ICA as a CCA can operate only on multichannel signals. Therefore, it is interesting to use these methods to remove artifacts from single-channel recordings. Single-channel signal sources can only be successfully identified and separated using ICA when their power spectral densities are disjunct. Single-channel ICA (SCICA) is a special case of multidimensional ICA applied to vectors of delayed samples [12].Dynamical Embedding (DE) is another method for separating a number of mixed signals from single-channel measurements. It constructs an appropriate embedding matrix out of a series of delay samples from the measured signal. This matrix needs to deconstruct the single-channel signal into its underlying informative components by applying ICA [13]. Noteworthy is also the Wavelet ICA (WICA) where the given signal is first transformed into multidimensional data via wavelet decomposition and then ICA is applied to find independent components as described in [14]. However, all ICA and CCA techniques require a non-trivial selection of components related with artifacts [5].Combining Empirical Mode Decomposition and ICA (EMD-ICA) is well suited to nonstationary signals. This method combines EMD (or rather a more robust, noise-assisted version of this algorithm called Ensemble EMD, EEMD [15]) with ICA. EEMD-ICA first decomposes the input signal into spectrally independent oscillatory modes, using EEMD, and then ICA is applied to extract sources [16]. EEMD-ICA was tested against the WICA and SCICA in [16], where it was shown that EEMD-ICA outperforms the other two strategies, particularly for high noise-to-signal ratios. As shown in [17], a two-stage process of EEMD and CCA can be utilized instead of EEMD-ICA. EEMD-CCA is able to demonstrate similar results, while significantly outperforming EEMD-ICA in computational cost. Components containing artifacts can be selected either manually or using the autocorrelation-based technique proposed in [18].Morphological Component Analysis (MCA) decomposes signal into parts that have different morphological characteristics and then an overcomplete dictionary is constructed by merging several complete dictionaries representing the signal [19]. Using this overcomplete dictionary, the sparsest representation is determined. For denoising, components related to artifacts are discarded and, using remaining components, the desired signal is reconstructed. In [19], to represent an EEG signal, authors applied the discrete cosine transform, Daubechies wavelet basis, and a Dirac basis. To apply this method to other cases, it is necessary to use different sets of dictionaries. However, it is not always easy to find this necessary set.In [20], authors applied local singular spectrum analysis (LSSA) to eliminate high-amplitude artifacts from single-channel measurements. LSSA has been developed to remove artifacts from EEG recordings. This method is applicable for automatic artifact removal (does not require any user intervention) and is capable of removing low-frequency artifacts [20]. However, these artifacts are different from those present in GFR measurements as well as different is GFR signal itself that does not contain periodic components. Both MCA and LSSA cannot operate in the non-linear domain [5] and both are widely applied for signals that composed of rhythmic oscillations.In this paper, we present a new method for automatic artifact removal. This method first groups data into clusters, using statistical information and a priori knowledge about signal morphology, processes these clusters separately, and then, performs piecewise linear correction of the recorded signal. These steps are repeated iteratively until an acceptable result is reached. The proposed method allows coping with the artifacts that are most common in GFR measurements in awake animals. This, in turn, allows facilitating the analysis of the recorded data and their interpretation.The measurement process relies on a percutaneous measurement of the elimination of an injected fluorescent-labeled exogenous GFR marker substance. The physiological model used consists of three compartments (Fig. 1) where one compartment describes the injection process, one the blood volume, and the final the interstitial part. The sensor acquires the signal from the interstitial compartment.As measurement device, we used a plaster device [2] with two light emitting diodes (LEDs), a photosensor, and a local microcontroller for controlling the measurement and sending the measured data to a PC where data are collected and evaluated. The sampling frequency of the system is 1Hz while the half-lives of the marker elimination as well as the diffusion between compartments are in the range of 10–60min.For the experiments, we used commercially available Sprague-Dawley rats (Janvier, France) as well as mice from the following strains: NMRI, CD1, Balb/c, C57BL/6 (all from Janvier, France). All experiments were conducted in accordance with the German Animal Protection Law and were approved by the local authority (Regierungspräsidium, Nordbaden, Karlsruhe, Germany).Artifacts can arise from a number of different sources; however, some of the most detrimental arise from the movement of the measurement device relative to the recording area. For fixation of the device on the animal, we use a plaster on which a miniaturized measurement device is mounted (Fig. 2).Motion of the animal leads to relative motion of the device vs. skin on one hand side and motion of the skin vs. subcutaneous tissue on the other hand side. This type of motion generates artifacts as seen when comparing anaesthetized vs. awake animals (Fig. 3). The deviations in Fig. 3a are distributed like additive Gaussian noise as was tested by a Kolmogorov–Smirnov test [21].If an animal is allowed to move freely, then unpredictable artifacts are produced (Fig. 3b). Movement of the animal leads to displacements of the device on the animals back and that, in turn, leads to two distinct types of artifacts: (1) random shifts of the signal, (2) random changes with large amplitudes. All changes in the signal are random and generally not correlated with each other.For type 1 artifacts, data analysis (with a number of cases N=40) indicates that the shifts of the signal are equally probable in both directions and the amplitude of the shift is a random variable having approximately exponential distribution, i.e. its probability density function (PDF) is as follows:(1)f(a)=fa⋅e−λ⋅|a|,where λ and faare the rate and scale parameters, respectively. However, this does not mean that, in the current signal, shifts will occur in each direction equal number of times. In distinct signals, shifts can be observed just in one direction. In general, when there is a large sample, shifts are equally in both directions.Type 2 artifacts, experimental evidence shows that they are approximately Gamma distributed with standard deviation σmas tested by the Kolmogorov–Smirnov test, i.e. PDF for σmis as follows:(2)f(σm)=1θk⋅Γ(k)σmk−1⋅e−σm/θ,where the operator Γ(·) denotes the gamma function, k and θ are the shape and scale parameters, respectively. Parameter k is a little bit greater than 1, thus the distribution is close to the exponential one.After injection of a GFR marker, an ideal GFR signal will increase quickly at the beginning, and then, as the marker is filtered out by kidneys, the signal descends down to the initial level [22], forming the curve shown in Fig. 3a, where the injection is clearly seen at the initial rise. As described in [3], model of second order may serve as a good mathematical approximation to describe this process. Often, however, this model has a systematic error, and therefore the third order model can be applied for a more detailed description of the process. Compartments of the model (Fig. 1) can be described as follows [23]:(3)dcHdt=−CH⋅R4VH,(4)dcPdt=CH⋅R4VP−CP⋅R1+R2VP+CI⋅R3VP,(5)dcIdt=CP⋅R2VI−CI⋅R3VI,where cH, cP, cIand VH, VP, VIdenote concentration and volume in respective compartments (see Fig. 1 describing the compartment model), R1–R4 are the respective rate constants.Eq. (3) can be solved directly:(6)CH=CH,max⋅e−λ3⋅t,where λ3=R4/VH. Eq. (5) can be converted:(7)CP=VIR2⋅dcIdt+R3R2⋅CI,(8)dcPdt=VIR2⋅d2cIdt2+R3R2⋅dcIdt.Using Eqs. (7), (8), and (6) in Eq. (4), we can derive an inhomogeneous differential equation:(9)d2cIdt2+dcIdt⋅R1⋅VI+R2⋅VI+R3⋅VPVP⋅VI+CI⋅R1⋅R3VP⋅VI=R2⋅R4VP⋅VI⋅CH,max⋅e−λ3⋅t.Homogeneous solution can be obtained when the right side of Eq. (9) is zero. Then(10)cI(t)=C1⋅e−λ1t+C2⋅e−λ2t,where C1, C2 and λ1, λ2 are constants deriving from Eq. (9).The general solution of Eq. (9) is as follows:(11)cI(t)=C1⋅e−λ1t+C2⋅e−λ2t+C3⋅e−λ3t,where constant C3 can be derived from Eq. (9).Since the initial concentration is zero (i.e. cI(0)=0), we can simplify Eq. (11) to:(12)0=C1+C2+C3.For ease of future calculations, the following variables can now be defined:(13)A=−C2,B=−C3,C1=A+B.Because injection is an input action for the system, and the amount of injected GFR marker directly affects the amplitude of the output signal, the signal g(t) will be used as an input signal:(14)g(t)=G⋅H(t),where H(t) is the Heaviside step function (unit step function),G∈ℝdenotes the amount of the injected substance.Using Eqs. (10) and (13), where C3=0 and hence B=0, the transfer function of the second order system (10) can be defined [3] as follows:(15)W2(s)=A⋅ss+λ1−A⋅ss+λ2=A(λ2−λ1)⋅s(s+λ1)(s+λ2)or in the case of the third order system, using Eqs. (11) and (13):(16)W3(s)=(A+B)⋅ss+λ1−A⋅ss+λ2−B⋅ss+λ3=a2⋅s2+a1⋅s(s+λ1)(s+λ2)(s+λ3),where A, B, and λi(∀i λi>0) are physiological parameters of the animal (we assume that these parameters do not change during the test). Parameters aifrom Eq. (16) are defined as follows:(17)a1=(A+B)λ2λ3−Aλ1λ3−Bλ1λ2a2=(A+B)(λ1+λ2)−A(λ1+λ3)−B(λ1+λ2)Using Eqs. (14), (15) or (14), (16), we can determine the output signal y(t) of the system (system response):(18)y(t)=L−1{L{g(t)}⋅W(s)}=L−1Gs⋅W(s),where the operatorL{⋅}denotes the Laplace transform and the operatorL−1{⋅}denotes the inverse Laplace transform. When using the equation (16), the output signal (18) of the system in time domain (provided that the input signal is g(t)) is as follows:(19)y(t)=(A+B)⋅e−λ1t−A⋅e−λ2t−B⋅e−λ3t.

@&#CONCLUSIONS@&#
