@&#MAIN-TITLE@&#
A medical cost estimation with fuzzy neural network of acute hepatitis patients in emergency room

@&#HIGHLIGHTS@&#
FNN is employed to develop the cost forecasting model for acute hepatitis patients in emergency room.The FNN model can provide more accurate forecast than SVR and ANN.Unlike SVR and ANN, FNN can also provide fuzzy IF–THEN rules for interpretation.

@&#KEYPHRASES@&#
Acute hepatitis,Medical resource estimation,Fuzzy neural network,

@&#ABSTRACT@&#
Taiwan is an area where chronic hepatitis is endemic. Liver cancer is so common that it has been ranked first among cancer mortality rates since the early 1980s in Taiwan. Besides, liver cirrhosis and chronic liver diseases are the sixth or seventh in the causes of death. Therefore, as shown by the active research on hepatitis, it is not only a health threat, but also a huge medical cost for the government. The estimated total number of hepatitis B carriers in the general population aged more than 20 years old is 3,067,307. Thus, a case record review was conducted from all patients with diagnosis of acute hepatitis admitted to the Emergency Department (ED) of a well-known teaching-oriented hospital in Taipei. The cost of medical resource utilization is defined as the total medical fee. In this study, a fuzzy neural network is employed to develop the cost forecasting model. A total of 110 patients met the inclusion criteria. The computational results indicate that the FNN model can provide more accurate forecasts than the support vector regression (SVR) or artificial neural network (ANN). In addition, unlike SVR and ANN, FNN can also provide fuzzy IF–THEN rules for interpretation.

@&#INTRODUCTION@&#
Hepatitis is a medical condition defined by the inflammation of the liver and characterized by the presence of inflammatory cells in the tissue of the organ. It may occur with limited or no symptoms, but often leads to jaundice, poor appetite and malaise. Acute hepatitis lasts less than six months and is labeled as chronic when it persists longer. Usually, a patient who has hepatitis should have several treatments in hospital before recovering. During the treatment period, the hospital needs to prepare medicines and medical applications. However, as every patient's condition is totally different, this makes it difficult for the hospital to prepare the necessary medical resources. Thus, if medical costs could be predicted in advance, then the hospital could prepare for the related medical resources efficiently in order to provide high-quality treatment and avoid the unnecessary waste of resources. Therefore, in order to avoid waste and be more efficient, developing a cost-predicting system to estimate medical cost for patients has become a very critical issue in hospitals.Data mining can extract hidden association rules from large databases to acquire useful knowledge. With the advances in data mining techniques in recent years, scholars have started to apply them to metabolic syndrome research. Huang [1] used an efficient data mining algorithm, called DCIP (the data cutting and inner product method), to explore association rules between the lifestyles of factory workers in Taiwan and the metabolic syndrome. An artificial neural network (ANN) is a system from neurophysiology models. In general, an ANN consists of a collection of simple, nonlinear computing elements whose inputs and outputs are connected together to form a network [2], and it is applied in the medical field [3–5]. Vapnik [6] promoted the SVM method in 1999 to obtain function fitting problems, forming the support vector regression (SVR) method. Currently, the SVR model is widely used in many fields to develop predicting models with good performance [7–10].The popular research topic of fuzzy neural networks (FNNs) has been successfully applied in many areas, such as in control, identification, prediction, pattern recognition, and bioengineering. FNNs inherit their learning ability from neural networks and their inference technology from fuzzy systems; they are used for solving the aforementioned characteristic behaviors [11–22]. The fuzzy neural networks combine the low-level learning and computational power of neural networks into fuzzy systems and the high-level, human-like thinking and reasoning of fuzzy systems into neural networks.Acute hepatitis lasts less than 6 months while chronic hepatitis lasts longer than 6 months. Acute hepatitis has several possible causes, such as infectious viral hepatitis (hepatitis A, B, C, D and E), other viral diseases (glandular fever and cytomegalovirus), severe bacterial infections, amoebic infections, medicines (acetaminophen and halothane) and toxins (alcohol and fungal toxins). The severity of illness in acute hepatitis ranges from asymptomatic to fulminant and fatal. Some patients are asymptomatic with abnormalities noted only in laboratory studies, while other patients might have symptoms and signs, such as nausea, vomiting, fatigue, weight loss, abdominal pain, jaundice, fever, splenomegaly, or ascites.Chronic hepatitis also has several different causes, like infectious viral hepatitis (hepatitis B, C and D), drug reactions, alcohol, autoimmune hepatitis, Wilson's disease, and hemochromatosis. According to the World Health Organization (WHO), of the 2 billion people infected with the hepatitis B virus (HBV), more than 350 million have chronic (lifelong) infections [23]. Hepatitis B results in 600,000 deaths each year from cirrhosis and hepatocellular carcinoma [24]. Taiwan is a hyperendemic area of hepatitis B virus (HBV). The estimated total number of HBsAg carriers in the general population >20 years old is 3,067,307; 61% of the patients involved in this study are hepatitis B-related [25].The typical presentation of severe acute exacerbation is a short onset of jaundice and very high ALT level, sometimes preceded by prodromal constitutional symptoms, in patients with chronic hepatitis B. It is often misdiagnosed as acute hepatitis, especially in those with a negative history of hepatitis in the past or who had never been examined for hepatitis marker in the past [26]. The symptoms of severe acute exacerbation of chronic hepatitis B can be very similar to those of acute hepatitis B. Hence, severe acute exacerbation of chronic hepatitis B might be misdiagnosed as acute hepatitis B in some cases [27].In countries with intermediate or high endemicity for HBV, exacerbations of chronic hepatitis B may be the first presentation of HBV infection [28]. Although these exacerbations are usually transient and asymptomatic, 1%–2.4% of patients later develop hepatic decompensation [29–31]. In this study, we believe that the great majority of patients with acute hepatitis B suffer from acute exacerbation of chronic hepatitis B.Child–Pugh classification has been used for decades to measure the severity of chronic liver disease. Recent studies have shown that the model for end-stage liver disease (MELD) more accurately predicts the short and mid-term survival of patients with cirrhosis compared to the CTP system. MELD, which has 3 parameters (serum bilirubin, creatinine, and prothrombin time) that need logarithmic transformation, has the advantage of a wide-range continuous scale; it is more objective and less variable [32]. Reports of predictors for acute hepatitis include: MELD Scoring System, Discriminant Function (DF) and Multivariate analysis. However, there are limited reports using abdominal echogram and Child–Pugh classification as a predictor for acute hepatitis.Sheth et al. [33] used MELD score and the Discriminant Function (DF) as a predictor of mortality in 34 patients hospitalized with alcoholic hepatitis. The MELD score performs as well as the DF in predicting mortality at 30 days. A MELD score greater than 11, or the presence of both ascites and an elevated bilirubin greater than 8mg/dL should prompt consideration of specific therapeutic interventions to reduce mortality.Li et al. [34] tried to find the prognostic factors for chronic severe hepatitis and constructed a prognostic model. The clinical and laboratory indices of 213 patients with chronic severe hepatitis within 24h after diagnosis were analyzed retrospectively. Death or survival was limited to within 3 months after diagnosis. The mortality of all patients was 47.42%. Compared with the survival group, age, basis of hepatocirrhosis, infection, degree of hepatic encephalopathy (HE) and levels of total bilirubin (TBil), total cholesterol (CHO), cholinesterase (CHE), blood urea nitrogen (BUN), blood creatinine (Cr), blood sodium ions (Na), peripheral blood leukocytes (WBC), alpha-fetoprotein (AFP), international normalized ratio (INR) of blood coagulation and prothrombin time (PT) were significantly different in the group who died. The significant attributes are shown in Table 1. They concluded that multivariate analysis in the prognosis of chronic severe hepatitis and the regression model was of significant value in the prognosis of this disease.Basically, the prognosis of liver cirrhosis is assessed by using the Child–Pugh score. Since abdominal ultrasound is also a commonly used tool for the evaluation and rapid diagnosis of acute hepatitis in the ED [35], the objective of this study is to determine whether the Child–Pugh score and abdominal ultrasound could be used simultaneously to predict the medical resource cost in patients of acute hepatitis without liver cirrhosis in the ED. In 2008, the consensus recommendations of the Asian Pacific Association for the study of the liver (APASL) indicated several prognostic scores of acute-on-chronic liver failure (ACLF) [36]. Liver-specific scoring systems (Mayo Risk Score, Combined Clinical and Laboratory Index) are adequate, but the Acute Physiology and Chronic Health Evaluation (APACHE) II and III were proved to be more powerful because they include additional physiologic parameters, and therefore also take into account additional complications associated with this liver disorder [37,38]. An accurate prognosis of the patient helps in the appropriate selection of a treatment program.The remainder of this paper is organized as follows. The material and methodology are presented in Section 2. Section 3 shows the computational results. Finally, the concluding remarks are made in Section 4.In this section, the material, including the acute hepatitis data set with description statistic and the fuzzy neural network system are introduced.The data which are used for medical resource cost forecasting of patients with acute hepatitis admitted to the Emergency Department (ED) in this study were collected from a well-known teaching-oriented hospital in Taipei, Taiwan. Table 2shows the descriptive statistics about the dataset. Acute hepatitis lasts less than 6 months while chronic hepatitis lasts longer than 6 months. Acute hepatitis has several possible causes, such as infectious viral hepatitis (hepatitis A, B, C, D and E), other viral diseases (glandular fever and cytomegalovirus), severe bacterial infections, amoebic infections, medicines (acetaminophen and halothane) and toxins (alcohol and fungal toxins). The severity of illness in acute hepatitis ranges from asymptomatic to fulminant and fatal. Some patients are asymptomatic with abnormalities noted only by laboratory studies, while other patients might have symptoms and signs, such as nausea, vomiting, fatigue, weight loss, abdominal pain, jaundice, fever, splenomegaly, or ascites [34,36–38].The advantage of FNN is that the fuzzy inference rules can be explained because they are given in the form of fuzzy IF–THEN rules. This allows the causal relationship to be more easily understood by users or doctors. The fuzzy IF–THEN rule is employed in FNN. The kth rule, which is instantiated as:(1)Rulek:IFx1isA1kandx2isA2kandxnisAnkTHENykisBkwhere x1, …, xnare the input variables, n is the number of input variables and ykis the output variable. A1k, …, Ankare the linguistic terms of the pre-condition with the Gaussian membership function. The architecture of FNN is shown in Fig. 1.An integration function, f, is associated with the fan-in of a unit and serves to combine information, activation, or evidence from other nodes. This function provides the net input for this node:(2)net-input=fu1k,u2k,…,upk;w1k,w2k,…,wpk,where the superscript shows the layer number.A second action of each node is to output an activation value as a function of its net-input:(3)output=oik=act(f).Layer 1: the nodes in the layer only transmit an input value to the next layer:(4)f=ui1andact=f.The link weight of layer one (wi1) is unity.Layer 2: the layer comprises input values membership functions. Previous studies indicated that using the bell-shaped function (Gaussian function) can have better performance in developing the FNN model [12,39,40]. Thus, this study employs the bell-shaped function as the membership function as follows:(5)f=Mxijmij,σij=exp−ui2−mij2σij2andact=f,where mijis the center (mean) and σijis the width (variance) of the bell-shaped function of the jth term of the ith input linguistic variable xi. The link weight of layer two (wij2) can be interpreted as mij.Layer 3: using the fuzzy intersection operator, AND, to translate the degree of accommodation into firing strength:(6)f=minu13,u23,…,up3andact=f.The link weight of layer three (wi3) is unity.Layer 4: this structure uses the inference model of Mamdani. According to this inference model, this layer belongs to the OR operation of fuzzy inference:(7)f=∑i=1pui4andact=min(1,f).The link weight of layer four (wi4) is equal to 1.Layer 5: the purpose of this layer is defuzzification:(8)f=∑mij5σij5ui5andact=f∑σijui5wheremij5andσij5are the mean and the variance of the membership functions, respectively. The link weight at layer five, (wij5), ismij5σij5.Many studies indicate that the artificial neural network (ANN) and support vector regression (SVR) have good performance to construct the forecasting model [3–5,7–10]. Besides FNN, this study also uses the artificial neural network (ANN) and support vector regression (SVR) to construct the forecasting models for comparison. The LIBSVM package developed by Chang and Lin [41] is used to construct the SVR model. The ANN, which is a feedforward neural network with back-propagation learning algorithm, is coded in C++ programming language. The forecasting performance is evaluated using the performance measures, the mean square error (MSE) and the mean absolute difference (MAD). The definitions of the measures are shown as Eqs. (9) and (10):(9)MSE=1N∑i=1N(Yi−Ti)2and(10)MAD=1N∑i=1N|Yi−Ti|where Tiis the actual value, Yiis the forecast value and n is the total number of data. The parameters for both algorithms are important since they have a significant effect on the performance.

@&#CONCLUSIONS@&#
In this study, an FNN is employed to develop a medical cost estimation model for acute hepatitis patients. Six input variables: PV, GB wall, splenomegaly, CP, T-bil and PT are used for training the FNN model. The computational results indicated that FNN has the lowest MSE and MAD values: 0.0103 and 0.0818, respectively, compared to those of the ANN and SVR models in testing. In addition, after training, FNN can form the fuzzy IF–THEN rules in order to predict the medical cost. These rules can be used by medical doctors or hospital managers to explain the cost structure. Basically, medical resource waste can be reduced and operation efficiency enhanced. Future studies might collect more data in order to improve the forecasting accuracy. Besides, other learning algorithms can also be used to develop the forecasting model.