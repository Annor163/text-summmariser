@&#MAIN-TITLE@&#
Cardiac magnetic resonance image-based classification of the risk of arrhythmias in post-myocardial infarction patients

@&#HIGHLIGHTS@&#
Cardiac magnetic resonance image-based features were used to distinguish post-myocardial infarction patients into high and low arrhythmic risk groups.Seventeen features describing the size, location and texture of the scarred myocardium were used in different classifiers.In Experiment 1, a systematic testing of features and their combinations was done.SMOTE, wrapper based feature selection, and nested cross-validation were used in Experiment 2.Experiments 1 and 2 gave an accuracy of 94.4% (AUC=0.965) and 92.6% (AUC=0.921), respectively.

@&#KEYPHRASES@&#
Local binary pattern,Sobel filter,k-Nearest neighbor classifier,Support vector machine classifier,Cardiac magnetic resonance image,High and low arrhythmic risk,

@&#ABSTRACT@&#
IntroductionPatients surviving myocardial infarction (MI) can be divided into high and low arrhythmic risk groups. Distinguishing between these two groups is of crucial importance since the high-risk group has been shown to benefit from implantable cardioverter defibrillator insertion; a costly surgical procedure with potential complications and no proven advantages for the low-risk group. Currently, markers such as left ventricular ejection fraction and myocardial scar size are used to evaluate arrhythmic risk.MethodsIn this paper, we propose quantitative discriminative features extracted from late gadolinium enhanced cardiac magnetic resonance images of post-MI patients, to distinguish between 20 high-risk and 34 low-risk patients. These features include size, location, and textural information concerning the scarred myocardium. To evaluate the discriminative power of the proposed features, we used several built-in classification schemes from matrix laboratory (MATLAB) and Waikato environment for knowledge analysis (WEKA) software, including k-nearest neighbor (k-NN), support vector machine (SVM), decision tree, and random forest.ResultsIn Experiment 1, the leave-one-out cross-validation scheme is implemented in MATLAB to classify high- and low-risk groups with a classification accuracy of 94.44%, and an AUC of 0.965 for a feature combination that captures size, location and heterogeneity of the scar. In Experiment 2 with the help of WEKA, nested cross-validation is performed with k-NN, SVM, adjusting decision tree and random forest classifiers to differentiate high-risk and low-risk patients. SVM classifier provided average accuracy of 92.6%, and AUC of 0.921 for a feature combination capturing location and heterogeneity of the scar. Experiment 1 and Experiment 2 show that textural features from the scar are important for classification and that localization features provide an additional benefit.ConclusionThese promising results suggest that the discriminative features introduced in this paper can be used by medical professionals, or in automatic decision support systems, along with the recognized risk markers, to improve arrhythmic risk stratification in post-MI patients.

@&#INTRODUCTION@&#
Patients who have suffered a myocardial infarction (MI) are at risk of experiencing life-threatening arrhythmias due to impaired functioning of the scarred myocardium. The survival rate of patients susceptible to arrhythmia has been shown to be improved by the use of implantable cardioverter defibrillators (ICDs) [1]. However, patients with a low risk of arrhythmias do not benefit from ICD implantation because of the substantial cost and potential complications of this procedure. Moreover, magnetic resonance imaging is generally contraindicated post-ICD implantation. For these reasons, accurate arrhythmic risk stratification of post-MI patients is of significant importance. Currently, recognized risk markers such as reduced left ventricular ejection fraction (LVEF) and large scar size are used to evaluate patient eligibility for an ICD [1,2]. However, LVEF has its own limitations in assessing myocardial functional state [3]. In a population based study [4], only 30% of patients who suffered sudden cardiac death would have qualified as candidates for a prophylactic ICD based on the current guidelines. On the other hand, many patients with poor LVEF would not draw any advantages from ICD prophylaxis [5]. Therefore, there is a substantial need for improved strategies to distinguish between the high arrhythmic risk group (HAG) and the low arrhythmic risk group (LAG) of patients.Several studies suggest that scarred myocardial tissue in cardiac magnetic resonance (CMR) images contains useful information for identifying patients who are susceptible to fatal arrhythmias. Bello et al. [6] showed that the risk of arrhythmia is correlated with the infarct size. The location of the scar in the myocardium is another factor in identifying patients with a high risk of arrhythmia, which needs to be further explored. Recent studies indicate that the heterogeneous texture of scarred tissue is likely to be responsible for irregular heartbeat (arrhythmia) [2,7,8]. Motivated by these findings, several studies have been conducted by our group to examine the role of features extracted from the scarred myocardium in arrhythmic risk stratification. Engan et al. [9] were able to classify patients implanted with an ICD into two groups (high and low risk of fatal arrhythmia) using features that describe size, statistics and texture (Haralick features from co-occurrence matrices) of the scarred myocardium. In [10], the same textural features were used along with LVEF and infarct size to classify HAG and LAG patients. Although these studies were exploratory in the sense that a large number (several hundreds) of features were explored on a small dataset, they substantiated the potential use of textural information in predicting serious ventricular arrhythmias. Local binary patterns (LBPs), introduced by Ojala et al. [11], are powerful texture descriptors which have been used in many biomedical applications [12,13]. In [14], we successfully used LBPs along with a simple non-parametric classifier to distinguish between HAG and LAG patients with a sensitivity of 75.0% and specificity of 83.3%. However, in order to be validated and used as a clinical prognostic tool, both of these discriminative measures need to be improved. In the present work, we aim to do so by introducing new quantitative CMR-based image features and using them in combination with widely used classification algorithms, namely, k-nearest neighbor (k-NN) and support vector machine (SVM), adjusting decision (AD) tree and random forest.The main aim of the manuscript is to differentiate the HAG and LAG patients using CMR image-based features with the help of image processing and pattern recognition techniques. To our knowledge this study is the first attempt in this regard. In previous works, [1,2], the authors used recognized risk markers, LVEF and scar size computed from the CMR images to differentiate HAG and LAG. Therefore, we used the classification results obtained by LVEF and scar size (computed by the cardiologists) to compare our classification results from different CMR image-based features. We have also compared the classification results in this manuscript to our group's previous works [10,14].The Department of Cardiology at Stavanger University Hospital provided the late gadolinium (LG)-enhanced CMR images of 54 post-myocardial infarction patients. The CMR images of the HAG patients were captured between February 2005 and March 2007, and the CMR images of the LAG patients were captured between September 2005 and September 2007. The use of LG enhancement techniques during CMR examinations allows precise depiction of scar characteristics and cardiac morphology. Experienced cardiologists divided the patients into high and low arrhythmic risk groups. Out of the 54 patients, 20 were categorized as high risk (HAG) and the remaining 34 were categorized as low risk (LAG). The decision to categorize a patient as high risk is based on a combination of LVEF (less than 30%), cardiac history, i.e., having demonstrated ventricular tachycardia in the past, and possibly other biomarkers (note that LVEF is an important factor in the decision making process). Each one of the HAG patients was later implanted with an ICD, and during the first year following implantation, the ICDs of all HAG patients recorded incidents of VT. The LAG patients had acute myocardial infarction treated with percutaneous coronary intervention (PCI) one year before the CMR images were taken, and during this year no arrhythmia was detected.All the CMR images were obtained from a 1.5Tesla MRI machine using the same protocol. Resting left ventricular (LV) function was determined from cine images using a steady-state free precession (SSFP) technique in short axis and long axis views, in the true heart axis. The SSFP technique provides very good contrast between the blood and myocardium in CMR imaging [15]. The short axis view constitutes the slices perpendicular to the line between the center of the mitral valve and the apex (long axis) [16]. In-plane resolution was 1.3mm×1.3mm with a slice thickness of 8mm and an interslice gap of 2mm. The whole LV was covered with 10–14 contiguous slices. The left ventricular mass, LVEF, and left ventricular volumes were determined using short axis volumetry. After acquiring the functional images, a dosage of 0.25mmol/kg of gadolinium-based contrast agent was infused via an antecubital vein and delayed hyper-enhancement (DHE) images were acquired 10–15min after the infusion, using an inversion recovery prepared T1-weighted gradient echo (T1-GRE) sequence, with inversion time (TI)=200–290ms, repetition time (TR)=4.1ms and echo time (TE)=1.3ms. Inversion recovery (IR) pulses are used in delayed enhanced CMR imaging to nullify the signal from the healthy myocardium. IR makes healthy myocardium dark in contrast to the enhanced scar. IR pulses are specified in terms of three time parameters: TI, TR and TE. TI is the time it takes for the healthy myocardium turns dark, and was individually adapted to null the healthy myocardium (typically 200–300ms). Images were acquired with a pixel size of 0.82mm×0.82mm, covering the whole ventricle with short-axis slices of 10mm thickness, without interslice gaps. Mean heart rate was 57.5bpm (range: 52–68bpm). Myocardial scars are bright voxels on LG-enhanced CMR images. Bright voxels have high signal intensity and are more fibrotic than voxels that are less bright. These CMR images were stored according to the Digital Imaging and Communications in Medicine (DICOM) format with a 512×512 pixel resolution. In all of our experiments, the short axis image slices showing visible scars were used. Fig. 1shows segmentation of the healthy and scarred myocardium, superimposed on the original CMR images of one HAG and one LAG patient. The fact that the difference in the scar texture between the two patients is not visually recognizable necessitates the use of image processing techniques to extract appropriate discriminative features.As discussed in Section 1, several studies suggest that information concerning the scarred myocardium, including the size, location and textural properties of the scar might be useful in identifying patients who are susceptible to arrhythmia. In this section, we introduce quantitative CMR image features that capture this information and which will later be used to classify HAG and LAG patients.Scar size is currently used as a marker for prophylactic ICD implantation since HAG patients generally have larger scars than LAG patients. Different methods have been proposed in the literature to quantify the scar size. In this work, we use the segmented CMR slices, as shown in Fig. 1, to calculate the relative scar volume (RSV) as the ratio of the number of pixels present in the scar to the number of pixels present in the myocardium, across all the CMR slices.Let Stand Mtdenote the scar region and the myocardium region, respectively, in the tth CMR slice. RSV is then defined as:(1)RSV=∑t=1T|St|∑t=1T|Mt|,where |St| and |Mt| represent the number of pixels in the associated region and T is the total number of slices in the CMR image sequence.In order to take into account the morphological information concerning the scarred tissue, we need a reference point on any CMR slice t, with respect to which the localization features are calculated. This reference point, denoted by Ct, is obtained by taking the average position of the centroids of all pixels in the epicardial, myocardial, and endocardial regions. The angular position, ϕ(p), of any pixel p is defined as the angle (ranging from 0 to 2π) between the line connecting that pixel to Ct, and the left ventricle (LV) axis manually marked by cardiologists. The LV axis is drawn in reference to the left and right ventricles. In some short axis image slices, the right ventricle is not visible. In these cases, the LV axis is marked in reference to the previous slice in which both ventricles are visible.Although the mapping ϕ(p) captures angular information about the pixel, p, we still need another quantity in order to uniquely localize each pixel within the myocardium. The radial position, λ(p), of any pixel, p, within the myocardium is a number between 0 and 1, representing the relative distance from that pixel to the inner wall of the myocardium such that the pixels close to this wall have relatively small values of λ, whereas those close to the outer wall have larger values. The calculation process for the angular and radial positions of an arbitrary pixel within the myocardium is presented in Fig. 2. More details on the localization features can be found in [17].For all pixels, ps, within the scar volume, angular position values are calculated and stacked into the vector Φ whose statistics, i.e. μΦ(mean), σΦ(standard deviation), and ηΦ(median) can be easily calculated. A similar procedure is applied to the radial position of the pixels within the scar volume and the corresponding statistics are calculated for the vector Λ. Finally, the 6-tuple (μΦ, σΦ, ηΦ, μΛ, σΛ, ηΛ) represents the localization features used throughout this paper.Infarct tissue heterogeneity has been shown to be a strong predictor for spontaneous arrhythmias [7,8]. Fig. 3depicts two sample 3×3 image patches with different degrees of heterogeneity. Of these two patches, the one on the right is more likely to belong to a high-risk patient due to the drastic changes in pixel intensity. To capture and quantify this type of heterogeneity in a gray-scale CMR image, we make use of the derivative images which measure the rate of change in the pixel intensity in the x- and y-directions. For any pixel (i, j) within the scar region of the tth slice, the magnitude of the gradientDt(w)is calculated as:(2)Dt(w)(i,j)=[Gt,x(w)(i,j)]2+[Gt,y(w)(i,j)]2,where the directional derivative imagesGt,x(w)andGt,y(w)result from convolving the scar image Stwith the x- and y-direction Sobel kernels of sizew, respectively. Different x-direction kernels (w=3,5,7) used in this paper are shown below.(3)Kx(3)=10−120−210−1,Kx(5)=210−1−2320−2−3430−3−4320−2−3210−1−2,Kx(7)=3210−1−2−34320−2−3−45430−3−4−56540−4−5−65430−3−4−54320−2−3−43210−1−2−3.The y-direction kernels are obtained by simply transposing the x-direction kernels, i.e.,Ky(w)=(Kx(w))T. Finally, the featuregradscar(w), is formed by taking the sum of the gradient magnitude of all pixels within the scar volume:(4)gradscar(w)=∑t=1T∑i,jDt(w)(i,j)Local binary patterns (LBPs) are powerful texture descriptors that are used in a variety of computer vision applications due to their computational simplicity. The LBP image is formed by replacing each pixel in the original gray-scale image with a binary string.This string is obtained by thresholding a circular neighborhood around each pixel and assigning 1 to the neighbors with larger values than that of the center pixel and 0 to the others. The two parameters that play a role in finding the LBP strings are the radius of the circular neighborhood, R, and the number of neighbors, P. The decimal representation of the LBP binary string is calculated as:(5)LBPP,R=∑i=0P−1u(gi−gc)2i,where u(·) is the unit step function, gcis the gray-scale value of the center pixel and gi's (0⩽i⩽P−1) are the gray-scale values of its P neighbors located on a circular neighborhood of radius R. Fig. 4demonstrates the calculation of the LBP string for the center pixel of a sample neighborhood.The number of bitwise transitions (0→1 or 1→0) in a circular LBP string of a pixel provides a measure of heterogeneity for the neighborhood around it. There are 2Ppossible binary strings, out of which many are just the rotated version of another string. The set of all circular binary strings is divided into subsets of rotationally equivalent strings in the sense that any string can be obtained from other strings in the same subset via rotation. All strings in a subset can then be mapped to one member of that subset which is called the representative pattern. There are exactly P+1 representative patterns with a maximum transition number of 2, which are referred to as uniform patterns [11]. Patterns with a transition number of more than 2 are called non-uniform patterns and are more likely to be seen in HAG patients. For every pixel in the scar region of a CMR slice, we find its LBP string and label it as either non-uniform or one of the P+1 uniform patterns, according to its representative pattern. Having a total of P+2 different bins, we build a histogram of LBP strings using all of the pixels within the scar volume. Each histogram is then normalized to have a total area of 1. Fig. 5summarizes the process of forming LBP histograms from CMR image slices.After creating the LBP histograms for all patients (sample histograms), it is possible to use a non-parametric classification scheme to separate HAG and LAG patients. In order to do so, we need two model histograms (one per each class) and a distance metric measuring the similarity between two given histograms. This way, a test patient will be assigned to the class that has a smaller distance when compared to the model histograms of the HAG and LAG patients. Learning the model histogram for a certain class can simply be done by taking the average of the training histograms in that class. Several distance measures have been proposed in the literature [18], out of which the chi-square distance proves to work better for smaller datasets. The chi-square distance between a sample histogram F and a model histogram G is defined as:(6)χ2(F,G)=∑b=1B(Fb−Gb)2Fb+Gb,where Fband Gbdenote the frequencies of the same bin, b, in the sample and model histograms, respectively, and B is the total number of bins. A scalar feature, chiP,R, that later will be used in k-NN and SVM classifiers, is defined as:(7)chiP,R=χ2(F,GH)χ2(F,GL),where F is the patient's LBP histogram, and GHand GLare the model histograms for HAG and LAG patients, respectively. P and R in Eq. (7) refer to the LBP parameters used to construct the histograms. According to the way chiP,Ris defined, we expect high values for this feature to correspond to the patients at high risk of arrhythmias.

@&#CONCLUSIONS@&#
