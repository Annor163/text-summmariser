@&#MAIN-TITLE@&#
Determination of optimal parameters for bilateral filter in brain MR image denoising

@&#HIGHLIGHTS@&#
This is the first GA based-optimization study to find optimal parameters of bilateral filter.Both the simulated and clinical brain MR images were used for Rician noise removal.The preservation of edges and removal of noise were investigated for different noise levels.A better performance in computation time of our approach was observed.The quality of the denoised images with the proposed parameters was validated using quantitative metrics.

@&#KEYPHRASES@&#
Bilateral filter,Genetic algorithm,Rician noise,MR denoising,Optimal parameters,

@&#ABSTRACT@&#
Noise elimination is an important pre-processing step in magnetic resonance (MR) images for clinical purposes. In the present study, as an edge-preserving method, bilateral filter (BF) was used for Rician noise removal in MR images. The choice of BF parameters affects the performance of denoising. Therefore, as a novel approach, the parameters of BF were optimized using genetic algorithm (GA). First, the Rician noise with different variances (σ=10, 20, 30) was added to simulated T1-weighted brain MR images. To find the optimum filter parameters, GA was applied to the noisy images in searching regions of window size [3×3, 5×5, 7×7, 11×11, and 21×21], spatial sigma [0.1–10] and intensity sigma [1–60]. The peak signal-to-noise ratio (PSNR) was adjusted as fitness value for optimization.After determination of optimal parameters, we investigated the results of proposed BF parameters with both the simulated and clinical MR images. In order to understand the importance of parameter selection in BF, we compared the results of denoising with proposed parameters and other previously used BFs using the quality metrics such as mean squared error (MSE), PSNR, signal-to-noise ratio (SNR) and structural similarity index metric (SSIM). The quality of the denoised images with the proposed parameters was validated using both visual inspection and quantitative metrics. The experimental results showed that the BF with parameters proposed by us showed a better performance than BF with other previously proposed parameters in both the preservation of edges and removal of different level of Rician noise from MR images. It can be concluded that the performance of BF for denoising is highly dependent on optimal parameter selection.

@&#INTRODUCTION@&#
Magnetic resonance imaging (MRI) is a popular imaging technique to provide detailed cross-sectional images of internal structures and organs in the body [1]. However, the images are generally affected by some artifact sources and noises [2]. Most of the noise in MR images is the result of patient's body in the system. This noise type is basically caused by thermally active electrons in the body. Additionally, there have been some other noise sources due to the measurement parts of the MRI system such as coil and electronics [3]. As a result, all of these undesired noise conditions limit the visual evaluation and computer analysis of images. Therefore, in order to increase the image quality for correct evaluation or diagnosis, denoising should be performed as an important pre-processing step.To date, lots of studies with various filtering methodologies have been conducted for denoising of MR images including the classical linear (spatial and temporal) filters [4], nonlinear filters (anisotropic diffusion, non-local means, bilateral/trilateral filters) [5–9] transformation filters (curvelet, contourlet and wavelet) [10–14] and statistical filters (maximum likelihood estimation, non-parametric estimation, singularity function analysis, phase error estimation, and linear minimum mean squared error estimation) [15–19]. In the early days, classical denoising algorithms like spatial and temporal filters that assume the noise as Gaussian distributed in MR images had been applied for noise elimination. However, the noise characteristics of MR images are Rician distributed, these techniques are not considered proper for effective denoising [20]. Moreover, especially the spatial filters have a major edge blurring drawback as a result of convolving the image with a filter [20].In the following years, some other algorithms such as nonlinear filters depending on partial differential equations, anisotropic diffusions (AD), non-local means (NLM), transformation filters (wavelets, curvelets) and statistical filters have been proposed for filtering of MR images in order to overcome this blurring drawback. Developed by Perona and Malik [5], anisotropic diffusion filter (ADF) increases the image quality by removing noise and preserving edges as a multiscale smoothing and edge detection algorithm. ADF method, which basically relies on estimation of noise standard deviation and second order partial differential equations for MRI, formulates the smoothing as a diffusive process [20]. Some of the researchers used the principles of ADF to remove Rician noise from MRI [6,21–23]. While the ADF reduces the noise and preserves the edges, there exist a number of drawbacks such as its inability to keep small features, producing the mask effect in uniform regions and determination of unpredicted iteration number before the process [24,25]. In order to preserve small structural details and remove noise in the images, the NLM filter has been proposed by Buades et al. [26]. This method first calculates the weighted average of gray level values of all pixels in the original noisy image by Gaussian smoothing function. Then, this value is used for replacing the noisy pixel [26,27]. It has been reported that the high computational cost and calculation complexity are the main problems of the NLM filter [20,24]. On the other hand, although transform domain filters such as frequency and wavelet domain filters can significantly decrease the amount of noise in MR images, they introduce some characteristic artifacts to denoised images as an important limitation [25,28]. Moreover, the main drawbacks of wavelet filters are the elimination of small structures that are similar in size to the noise in noisy images [12,20] and to select the wavelet base and the decomposition level [29]. For the Rician noise removal in MR images depending on statistical approaches, Basu et al. [30] used the combination of AD term and another index that represents the data likelihood. In another study, calculating the sample distribution of local mean, variance, and mean squared values of the images, Aja-Fernandez [16] performed the filtering on MR images with Rician noise based on the linear minimum mean squared error (LMMSE). Recently, Rajan et al. [31] used maximum likelihood approach for denoising of MRI images. In all of these statistical methods, the performance of the filtering highly depends on the correct estimation of noise in images [16].It can be concluded that many noise filtering methods have been proposed during the past years for MRI images; among these techniques, bilateral filter (BF) is another popular nonlinear filter. It is local, non-iterative and simple approach used in spatial domain for noise elimination while preserving edges. To detect detailed parts of an image, it uses local information. Then, it smoothes these components less than the other parts of the image [32]. Although BF is being widely used for denoising of MRI images, it has been reported that there is not much theoretical or empirical study for optimal selection of the BF parameters in the denoising procedure [33,34]. In some of the following previous studies, statistical approaches were selected to find optimal parameters. Ramanandan et al. [35] used vector root mean squared error values for adjusting optimal filter parameters. However, their approach assumes that an image ground truth is known. In a previous study, Yang et al. [36] conducted an image enhancement study that uses particle swarm optimization (PSO) algorithm for parameters of BF. However, in their study, the authors did not give information about how to select the fitness function and to adjust the range of the BF parameters. Moreover, in their enhancement study, the authors only reported the PSNR and SSIM values of final images after filtering without any noise consideration. They repeated the filtering approach until they visually enhanced the images in terms of their details and luminance. In another BF parameter optimization study conducted based on PSO, artificially corrupted color images by only one level noise were investigated for the recommendation of BF parameters [37]. Mostly, the parameters of BF are usually determined by trial and error in practice [38].The main purpose of our study is to optimize the parameters of BF using genetic algorithm (GA). It has been reported that as a powerful soft computing method, GA has an advantage in terms of its simplicity, fewer iteration number and less mathematical complexity [39]. The strength of GA approach is that it often finds an optimal solution to a problem in a fast manner [40] with less prior knowledge about the problem than the other conventional optimization techniques [41]. Therefore, there have been some GA studies for parameter optimization of Kalman filter in flight control system of unmanned aerial vehicle [42], of Gabor filter in texture classification system [43], and of local polynomial approximation based intersection confidence interval filter for brain MRI image denoising [44]. Besides, there have been some other studies that use GA procedure itself for impulse [45] or Rician [39,46] noise removal from the MRI images. To the best of our knowledge, this study is the first GA based optimization work to find optimal parameters of BF for denoising of MR images. The expected outcome of this study is to estimate the optimal filter parameters using GA for reducing the Rician noise of MR images with different noise levels (σ=10, 20, 30) by significantly obtaining higher values of PSNR. We evaluated the proposed BF parameters on the simulated and clinical MR images using both the objective quality metrics and visual inspections. Moreover, a comparison between our results and the results of other classical BFs was provided.

@&#CONCLUSIONS@&#
In this paper, we presented a GA-based technique as a novel way for selection of BF parameters to remove the Rician noise in MR images. Although there have been large number of studies that compare the effectiveness of different optimization approaches such as GA and PSO, the inconsistent results depend on the application area have been noted. For example, in a previous work that compares the PSO and GA in the design of permanent magnet motors, it has been reported that PSO has some advantages over GA in terms of accuracy, the robustness to population size and coefficients of the algorithm [61]. On the other hand, in another study related to the accuracy of the parameters in a control system, it has been found that the GA predicts parameter values that are closer to the known values than does the PSO approach [62]. In a software testing experiment [63], GA approach, when it compared to PSO, has been reported as a superior technique since it can solve nonlinear and multimodal problems that are formulated by either continuous or discrete variables. Moreover, in another study that is conducted for image thresholding [64], although it has been observed that both the PSO and GA techniques yield same output in terms of accuracy and robustness of the results, the total time of the GA approach for this result has been reported to be most influential. In our study, we preferred to use the GA approach for parameter optimization of BF because of its parallel nature of search and execution time.To our knowledge, this is the first study that investigates the BF parameter settings using a GA-based optimization algorithm for a more successful denoising of T1-weighted brain MR images with different noise levels. We tested the proposed BF parameters on the simulated brain images and also on clinical MR images. In order to understand the importance of parameter selection in BF, we compared the results of denoising based on proposed parameters with other results based on previously proposed parameters using the quality metrics such as MSE, PSNR, SNR and SSIM. BF with the proposed optimal parameters achieved better performances for all the images with different noises (σ=10, 20, 30), in terms of all quality measures. Moreover, it protects the image details better while removing noise. It can be observed from the images that BFs with previously proposed parameters tend to blur the images more than BF with parameters proposed in this study.We have found that N×N=7×7, σd=0.805 and σr=0.168 are the optimal parameters of BF for MR images with σ=10 noise level. For the σ=20 and σ=30 noise levels N×N=7×7, σd=1.609, σr=0.227 and N×N=3×3, σd=1.556, σr=0.235 are the best BF parameters, respectively. Based on these results, we can set a relationship as an intensity weight coefficient between the σrintensity coefficient parameter and the noise level of the image (σ). The intensity weight coefficient can be calculated using the equations as follows:σr=0.805×25510=4σ,σr=3σ, and σr=2σ for the noise levels of σ=10, 20, and 30, respectively. The intensity sigma values (σr) were multiplied by 255 because we performed the process of filtering in the normalized images with intensity range between [0–1] that were obtained from simulated images with intensity values within the range [0–255]. It can be inferred from the relations above, as the noise level (σ) in the image increases, the intensity weight coefficient should be adjusted as small. However, the optimal value of intensity parameter (σr) of the BF increases linearly with the variance of the noise in the image. This result is consistent with the findings in the previous study that investigated the optimal parameters of multiresolution BF for denoising of color images [34].Moreover, the BF with proposed optimal parameters exhibits a better performance in terms of computational time of the denoising process. From the experiments, we can conclude that the successfulness of noise elimination and edge-preservation highly relies on the parameter settings of BF. Additionally, the noise level of the image is the another key factor in the performance of the denoising. BF with the proposed parameter settings in Table 3 can be applied to any T1-weighted MR images, successfully. For the future studies, a performance comparison of BF with proposed parameters to other nonlinear filtering techniques with their parameters optimized such as enhanced or extended [65,66] NLM filters and total variation filter [67] for brain MRI denoising.