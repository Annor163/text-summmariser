@&#MAIN-TITLE@&#
A method for normal-mode-based model reduction in nonlinear dynamics of slender structures

@&#HIGHLIGHTS@&#
A non-intrusive approach to construct geometrically-nonlinear models of large structures with slender subcomponents from existing industrial-scale linear vibration FE models.An extension of static condensation methods on slender structures that utilises the spatial distribution of the condensation nodes.A numerical procedure to filter high-frequency dynamics while retaining the contribution of the high-frequency mode shapes to approximate large deformations.A numerically-efficient modal projection of geometrically-nonlinear structural dynamics.

@&#KEYPHRASES@&#
Model reduction,Geometrically-nonlinear structures,Static condensation,Nonlinear vibrations,Modal analysis,

@&#ABSTRACT@&#
This paper introduces a nonlinear reduced-order modelling methodology for finite-element models of structures with slender subcomponents and inertia represented by lumped masses along main load paths. The constructed models have dynamics described by 1-D intrinsic equations of motion, which are further written in modal co-ordinates. This yields finite-dimensional approximations of the system dynamics with only quadratic nonlinearities. Evaluation of the problem coefficients is performed from static condensation of the original model on the lumped masses. The method exploits the multi-point constraints typically used to obtain sectional loads in aircraft aeroelastic analysis. The technique is illustrated on simple 3D structural models built using solid elements.cross-sectional compliance matrixbeam internal forces in material coordinatesapplied forces/moments per unit beam lengthbeam curvatures in material coordinatesinitial beam curvatures in material coordinatesstiffness matrix in reduced set of 3-D FEM problembeam internal moments in material coordinatesmass matrix in reduced set of 3-D FEM problemcross-sectional mass matrixbeam local position vectorintrinsic modal coordinates (all components)intrinsic modal coordinates (velocity component)intrinsic modal coordinates (stress resultant component)beam local coordinate transformation matrixcurvilinear coordinate along main load pathtimebeam local displacements in material coordinatesbeam translational velocities in material coordinatesskew-symmetric matrix with natural frequencieslocal translational/angular velocity state vectorinternal force/moment state vectornatural mode shape j in global displacementsnatural mode shape j in intrinsic velocitiesnatural mode shape j in intrinsic sectionalforcesdiscrete mode shape j in reduced set of 3-D FEM problemdiagonal matrix with natural frequenciesωjbeam angular velocities in material coordinatescutoff angular frequencynatural angular frequency of mode jscalar part of quaternionvector part of quaternion

@&#INTRODUCTION@&#
The dynamic aeroelastic response of most existing air vehicles and wind turbines is characterised by small-amplitude elastic displacements at relatively low frequencies. As a result, their structural description for aeromechanic studies has long been based on linear theories and solutions have been sought using linear normal modes (LNMs) of the structure in vacuum. This also has the additional advantage that the time-domain aerodynamics can be obtained for wall disturbances defined by that relatively small number of LNMs. The demand for ever higher design efficiency, however, is leading to much more flexible high-aspect-ratio lightweight wings and blades with major implications for the requirements of computational tools [1]: First, the low-frequency elastic response is dynamically coupled with the rigid-body dynamics of the vehicle; second, geometrically-nonlinear effects may be significant in the structural response; and finally, full coupling is required with the fluid solver at simulation time. Consequently, the resulting computational cost is increased manifold [2,3] and may become prohibitive for routine design analysis. An additional requirement is posed by the initial (model-based) design of the flight control and gust/manoeuvre load alleviation systems, which call for the ability to generate small-size descriptions of the system dynamics using methods of model reduction [4].While model reduction of linear systems is very well developed, dimensional reduction of general nonlinear systems heavily depends on the characteristics of the relevant nonlinear phenomena and the structure of their representation. Parametrised modal projections have been shown for flexible bodies with arbitrary rigid-body kinematics and small elastic displacements [5,6] and have also been extended to the case of aeroelastic systems modelling flexible manoeuvring aircraft [7,8]. For nonlinear vibrations, normal form theory allows dimensional reduction of the free response in the structure’s Nonlinear Normal Modes (NNMs) [9,10]. NNMs provide a fundamental understanding of the system dynamic characteristics, but they do not define, unlike LNMs, a basis for projection of the forced response of the geometrically-nonlinear structure. Instead, the LNMs themselves (either on undeformed or deformed equilibrium conditions) are commonly employed as a basis for projection in nonlinear vibrations [11,12], although methods based on system responses to prescribed forces, such as proper orthogonal decomposition or centroidal Voronoi tessellation [13], have also been proposed. The main limitation of those methods comes from the fact that in solutions based on approximations of the displacement field, one needs to retain cubic terms to capture softening/hardening effects on the stiffness. The corresponding fourth-order tensors are, in general, fully populated, as the banded structure in the finite-element discretisation disappears in the global basis. As a result, the computational cost grows very quickly with the number of LNMs.Thus, the common approach has been to use structural slenderness to construct purpose-built models based on geometrically-nonlinear beam elements [14–17]. The constitutive relations (i.e., the matrices of mass and stiffness per unit length) are based on either estimates of section moments of inertia or purpose-built homogenisation tools based on either cross-sectional [18] or unit-cell [19] analysis. This results in a moderate simulation effort for configuration studies, as well as procedures to synthesise control systems from local linearisation around nonlinear static equilibria [20,21]. While this has provided substantial insight into the nonlinear response of highly-flexible aircraft and wind turbines, none of these procedures currently relate to the actual, detailed and typically very large (with the number of degrees of freedom typically measured in millions) 3-D finite-element (FEM) models, which are built, validated, and refined, in the various loops of the design cycle. These models collect the engineering knowledge of an organisation and should be the basis for any numerical analysis aimed at structural certification.Since the low-frequency dynamic response of slender structures is strongly dominated by its lengthwise deformations, it is still interesting to establish reduction methods from those large 3-D models into much more compact 1-D representations. The typical approach is to construct 1D models with a distribution of mass and stiffness that matches section-averaged responses to unit static loads and/or a number of LNMs [22]. The main drawback of this approach is that, to obtain an accurate representation of the original model, one needs to identify a large number of coefficients on that approximate beam discretization (in general, 21 independent coefficients in the sectional mass and stiffness matrix of each beam element). Typically the identification is only carried out on a very small number of modes, which does not guarantee modelling accuracy in nonlinear problems. To overcome this, this paper will present a hybrid approach that combines the model fidelity encapsulated in the LNMs of the large 3-D model with the efficiency of 1-D models to capture the dominant geometrically-nonlinear effects in slender structures. This is achieved by introducing the dimensional reduction on the linear eigenvalue analysis in the 3-D FEM model, by means of static or dynamic condensation onto nodes located along the main load path. In parallel to this, the geometrically-nonlinear beam equations are projected into the basis defined by its LNMs. Finally, the mode shapes in the condensed 3-D model are treated as 1-D functions of the arc length along the reference line and thus used in the modal beam equations. As it will be shown, this can be done solely by post-processing information obtained from the 3-D model, i.e., without explicitly constructing a beam finite-element model. The result is a formulation that (1) characterises the nonlinear vibrations in modal space; and (2) uses the mode shapes and frequencies corresponding to the 3-D FEM.The first step is to identify a suitable nonlinear beam theory. Among the many solutions in the literature, intrinsic descriptions [23–25] will be particularly useful here. An intrinsic beam theory draws upon Kirchhoff’s analogy between the spatial and time derivatives [26] to define a two-field Hamiltonian description of the beam dynamics in first-derivatives, i.e., strains and velocities. This results in a formulation that closely resembles that of rigid-body dynamics, with first-order equations of motion in both beam strains and velocities and, critically for this work, quadratic nonlinearities on those primary states. As in rigid-body dynamics, the solution process is closed by the propagation equations to obtain load displacements and rotations. The infinite-degree nonlinearities associated with the finite rotations are then transferred to that post-processing step. Previous work by the authors [27] has identified energy-preserving conditions in both the infinite-dimensional and the truncated modal finite-dimensional system equation, due to the symmetries present in the reduced modal description. Following on from that work, this paper will investigate the generation of the equations of motion in intrinsic modal coordinates from built-up 3-D FEM models.The starting point is the assumption that such a 3-D model of the structure already exists for linear vibration analysis. This FEM model is then reduced using Guyan’s method [28] to a small set of grid points along the main load paths. The selection of those condensation points is therefore critical, but it can be performed with similar criteria to those used in the selection of monitoring stations for aircraft dynamic loads analysis [29]. It will be assumed that the model mass is lumped on those nodes, which reflects a typical situation in full-aircraft models for vibration analysis. More sophisticated methods of dynamic condensation are available in the literature [30,31] and they could be also considered within the approach proposed in this paper. However, Guyan reduction is arguably the most common condensation method in aerospace applications and is readily available in most finite-element packages, so it is therefore preferred here. The LNMs of the full 3-D model on the set of beam nodes will then be used to define directly the different coefficients of the intrinsic equations in modal coordinates. This procedure will be illustrated in the final section of the paper with two numerical examples.We will first describe the intrinsic equations of motion for a geometrically-nonlinear composite beam, since this formulation is the basis of the model reduction method used in this work. Only the main results are presented here, and the reader is referred for additional details to the original paper by Hodges [23]. This will then be followed by a projection of the equations into a modal space, as it was performed by Palacios [32]. Finally, the intrinsic variables are expressed in terms of local displacements and rotations to link the results to those obtained from the condensation of a general 3-D FEM model of the structure in Section 3.A beam will be defined as the solid determined by the rigid motion of cross sections linked to a deformable space curve, Γ (Cosserat’s model). There are no assumptions on the sectional material or geometric properties, other than the condition of slenderness. Let s be the arc length,v(s,t)andω(s,t)the instantaneous translational and angular inertial velocities, andf(s,t)andm(s,t)the sectional internal forces and moments (stress resultants) along the reference line. Vectors are expressed in their components in the instantaneous local (deformed) material frame. Using these magnitudes and using dots and primes to refer to their derivatives with time, t, and the arc length, s, respectively, Hodges [23] has derived the intrinsic form of the beam equations of motion, which are written here as [32](1)Mẋ1-x2′-Ex2+L1(x1)Mx1+L2(x2)Cx2=f1,Cẋ2-x1′+E⊤x1-L1⊤(x1)Cx2=0.The state vectorsx1andx2are defined as(2)x1≔vω,x2≔fm.The forcing term is the vectorf1(s,t), which includes the applied forces and moments per unit length, also written in their components in the instantaneous material frame. Thus a constant value off1corresponds to follower forces.M(s)andC(s)are the sectional mass and compliance matrices, respectively, which are6×6symmetric matrices. Finally, the matrixEand linear matrix operatorsL1andL2are(3)E≔k̃00ẽ1k̃0,L1(x1)≔ω̃0ṽω̃,andL2(x2)≔0f̃f̃m̃,where•̃is the skew-symmetric (or cross-product) operator,k0(s)is the initial pretwist and curvature of the reference line, ande1≔1;0;0is the unit vector. Eqs. (1) are solved with the corresponding boundary and initial conditions, which are also written in terms of velocities and forces [23].The formulation being presented here is completely equivalent to a standard displacement-based nonlinear composite beam formulation, but without including displacements and rotations as primary variables. In the intrinsic description, displacements and rotations are dependent variables that only appear explicitly in Eq. (1) when applied forces and moments,f1, depend on them. Local values of the displacement and rotations are obtained either from time integration of the inertial velocities, as in rigid-body dynamics; or from spatial integration of the strains corresponding to the stress resultants, as with the Frenet–Serret formulae in differential geometry. The first approach will be followed here, following Ref. [32]. If the local orientation with respect to a reference inertial frame is defined by quaternions,(ζ0(s,t),ζ(s,t)), they satisfy(4)ζ̇0=-12ω⊤ζ,ζ̇=12ζ0ω-ω̃ζ.The position vectorr(s,t)along the beam with respect to the same inertial reference frame (and given in its components in that frame) is finally obtained from time integration of the local inertial velocity, as(5)ṙ=Rv,withR(s,t)the local rotation matrix corresponding to the quaternions obtained in Eq. (4), which can be written as(6)R=-ζζ01+ζ̃-ζζ01-ζ̃⊤,where1is the identity matrix.The LNMs of the structure in intrinsic variables are obtained from the linearisation of Eq. (1) around the unloaded conditions. For small values ofΔx1andΔx2,(7)MΔẋ1-Δx2′-EΔx2=Δf1,CΔẋ2-Δx1′+E⊤Δx1=0.Non-trivial solutions forΔf1=0are of the form1The general solution to this first-order system would be of the formΦjeωjtwithΦjbeing a complex variable. It is easy to see that the eigenvectors have the structureΦj=iΦ1jΦ2jand this is implicitly used here to define only real modes and amplitudes.1(8)Δx1(s,t)=Φ1j(s)sin(ωjt),Δx2(s,t)=Φ2j(s)cos(ωjt),whereΦ1j(s)andΦ2j(s)are the mode shapes in sectional linear/angular velocity and stress resultant variables respectively. The modesΦ1jandΦ2jare therefore solutions to the eigenvalue equation(9)E⊤-∂∂s-ωjC(s)ωjM(s)-E-∂∂sΦ1j(s)Φ2j(s)=0.Wynn et al. [27] have shown, using the structure of the nonlinear intrinsic Eq. (1), that this set of modes is always space-spanning. In general, the solution to Eq. (8) can only be obtained numerically. The normalisation in Eq. (8) is chosen such that(10)〈Φ1j,MΦ1k〉=δjk,〈Φ2j,CΦ2k〉=δjk,where〈g,h〉≔∫Γg⊤hdsis the inner product in the 1-D domain, defined on any pair of functionsg(s)andh(s). Using Einstein notation to sum over repeated indices, the modal projection of the state vectors is now defined as(11)x1(s,t)=Φ1j(s)q1j(t),x2(s,t)=Φ2j(s)q2j(t),whereq1jandq2jare pairs of intrinsic modal coordinates. Note that, since this is a first-order theory, each LNM is associated to two generalised coordinates that effectively corresponds to the real and imaginary components of a complex modal amplitude. After substituting Eq. (11) into (1) and enforcing the orthogonality conditions (10), the finite-dimensional equations of motion in intrinsic modal coordinates are written as [32](12)q̇=Wq+N(q)q+η,with(13)q=q1q2,η=η10,and the following coefficients for the linear and quadratic terms,(14)W≔0Ω-Ω0andN(q)≔-q1ℓΓ1ℓ-q2ℓΓ2ℓq2ℓ(Γ2ℓ)⊤0.Here, we have definedΩ≔diag(ω1,…,ωN),η1j(t)≔〈Φ1j,f1〉, and(15)(Γ1ℓ)jk≔〈Φ1j,L1Φ1kMΦ1ℓ〉,(Γ2ℓ)jk≔〈Φ1j,L2Φ2kCΦ2ℓ〉.The coefficients of the quadratic terms in the equation,Γ, which are responsible for the modal couplings in the system dynamics, are obtained from integral equations involving the mode shapes and the mass and compliance matrices, Eq. (15). The constant coefficientsW,Γ1andΓ2, together with the mode shapes of Eq. (11), are the only information required to construct a geometrically-nonlinear description in intrinsic modal coordinates. As we will show below, that information can be directly extracted from a built-up 3-D FEM model of the actual configuration. In Ref. [27], we have discussed the Hamiltonian structure of Eq. (12) and also described the energy-preserving properties of the system. It was shown that the finite-dimensional approximation of Eq. (12) conserves total system energy. Total system momentum is however not necessarily conserved and it needs to be enforced via convergence in the solution. This will be exemplified in the results section.The nonlinear coupling coefficients in (15) are computed from integrals of the intrinsic modes along the reference line. If the modal values of the intrinsic variablex1andx2are only known at discrete points (as would be the case during the condensation process described later), we would need to define an interpolation scheme to interpolate these variable to compute the coupling coefficients. Thus we now seek a suitable spatial interpolation of the modes in primary intrinsic variables (local velocities and sectional force resultants) along the reference line from the mode shapes obtained at discrete points (analysis nodes). Note that we are not trying to define shape functions for a finite-element discretisation and the interpolation will be for the sole purpose of computing the nonlinear system, with the linear modes that are assumed to be already known at discrete analysis nodes from a previous analysis. A low-order interpolation scheme is sought and, if required, the number of nodes can be increased to reduce the errors associated with the low-order scheme. Although higher-order schemes are entirely possible, we will demonstrate in Section 5.2 that the current scheme is sufficient to achieve convergence without requiring an excessively large number of nodes.First, we define the variablex0as a six-element vector containing the linear rotation and displacement degrees of freedoms at each point. As the discrete solution provides exact displacement and velocity information on the set of analysis nodes, we will regard the values ofx0andx1of the continuous solution to be exactly equal to the discrete solution at the reference points. We then note that displacements and velocities on the structure must be continuous, thus in the lowest-order scheme we regardx0andx1to vary linearly on each reference line segment between two adjacent reference nodes, on which the values are known exactly. If we definex1,ias the discretised value ofx1defined at node i, that is,x1,i=x1(si), linear interpolation results in(16)x1≅∑iφ1,ix1,i,with(17)φ1,i(s)=s-si-1si-si-1si-1<s<sis-si+1si-si+1si<s<si+10otherwise.This is similarly carried out onx0. As the sectional forces are not required to be continuous, we subsequently regardx2as being piecewise-constant along the reference line, which can be represented as(18)x2≅∑iφ2,i+12x2,i+12withx2,i+12the stress resultant at the midpoint of the reference line segment and(19)φ2,i+12(s)=1si<s<si+10otherwiseThis thus defines the interpolated intrinsic statesx1andx2at every point s along the reference line from the discretised intrinsic variablesx1,iandx2,i+12. Similarly, the intrinsic modesΦ1(s)andΦ2(s)will also follow this interpolation scheme. In the next section we will make use of these interpolations when computing the nonlinear coupling coefficients in the modal system.As outlined in the introduction, we seek to utilise a linear 3D FE model of the slender structure to obtain the coefficients in (12). This will be achieved by the application of Guyan condensation to reduce the linear equations of motion of the 3D model onto the degrees of freedom of a small set of analysis nodes. The starting point of the analysis in this section is a linear 3D FE model of the structure with nodal displacement, and possibly rotations, as the degrees of freedom, on which we define a set of analysis degrees of freedom. The natural modes are then obtained on this reduced set. Here the error can become significant at the higher frequencies [33] or with a poor selection of the analysis degrees of freedom [34]. For very large systems, the matrix inversion itself can also be replaced by a Gauss–Jordan elimination [35] or any other suitable procedure. In this work however, we first lump the structural inertia of the full 3D model onto the set ofNaanalysis nodes, and then we obtain the mass and stiffness matrices that describe the linear dynamics of this reduced set of degrees of freedom. We should note that this lumping of masses, which used in a number of finite-element descriptions [36], is common practice in full aircraft vibration analysis. The relation between the 3D model and the set of analysis nodes can be seen in Fig. 1. We define the six-state (three in displacement and three in rotation) vector variablexa,i∈R6to describe the (linear) nodal displacement and rotation at the i-th condensation node (withi=1,…,Na). The corresponding linear normal modes,Φaj∈R6Na, of the reduced system are then obtained from(20)-ωj2MaΦaj+KaΦaj=0whereMais block diagonal and contains the mass matrices of individual lumped-mass nodesML∈R6×6, andKais, in general, fully populated as a result of the condensation. Note that this section considers linear analysis only, thus the Δ sign is dropped from all variables, which are assumed to be small.The reduced system (20) is discrete in space with displacements and velocities defined only at theNalumped mass nodes. For nonlinear analysis using the intrinsic modal description, we consider reference lines that connect the analysis nodes along the load paths of the structure as shown in Fig. 1, and then seek a continuous description of the variables along the reference lines. The linear normal modes on the continuous problem will be obtained from the discrete system in (20) and will be used to compute the geometrically-nonlinear dynamics of the structure using the intrinsic modal formulation.We will identify next the relation that links the (discrete) linear normal modes defined by (20),Φaj, to the (continuous) intrinsic modesΦ1j(s)andΦ2j(s). Since the linear intrinsic description and the displacement-based description are different formulations of the same (linear) problem, the eigenvalues and eigenvectors of the two formulations are enforced to match exactly. This will then provide the process by which the intrinsic modes of the continuous, 1D problem, and thus the nonlinear modal system (12), can be computed from the 3D FE model.As the intrinsic variables (velocityx1and sectional forcex2) are defined using the local frame at each point of the reference line whereas the displacement and rotationx0is not necessarily defined in the same frame, we will first define the transformation from the frame used byx0(s,t)into the local frame used by intrinsic variablesx1(s,t)as(21)x1(s,t)=T(s)ẋ0(s,t),similar to (5).T(s)is a 6×6 matrix. In the particular case that both the displacement and rotation components inx0are defined in the global inertial frame,T(s)will take the form of(22)T(s)=R(s)-100R(s)-1whereR(s)from (5) is taken at the unloaded configuration.Using (21) and (8), we write the eigenvalue solution to the structural problem as(23)x1(s,t)=T(s)ẋ0j(s,t)=Φ1j(s)sin(ωjt)Therefore, the eigenvalue solution inx0that corresponds to the above solution inx1will be(24)x0(s,t)=-1ωjT(s)-1Φ1j(s)cos(ωjt)We now define the linear normal mode shapes in displacements and rotations along every point on the reference line asΦ0j, with corresponding natural angular frequenciesωj, as taking the form of(25)x0(s,t)=-cos(ωjt)Φ0j(s).wherex0is the eigenvalue solution to the structural equations cast inx0in a displacement-based formulation, which will not be reproduced here.From (21) and (25), a definition of the continuous displacement and rotation modes in terms of intrinsic velocity variables, with the correct sign, is(26)Φ1j(s)=ωjT(s)Φ0j(s),Finally, we obtain the linear normal modes in displacements and rotations for the discrete, reduced problem (20) asΦaj, with corresponding natural angular frequenciesωj, from(27)-ωj2Ma+KaΦaj=0.Consistent with the interpolation scheme used in this work described in Section 2.3, we now regard each continuous displacement-rotation mode shapeΦ0jat each analysis node as(28)Φ0j(si)=Φaj,i,i=1,…,Na.Therefore, relations (28) and (26) allow us to relate the natural modes of the continuous, 1D problem to the natural modes of the discrete, reduced FE system and computeΦ1jfrom the knowledge ofΦaj.The momentum modeMΦ1jis obtained by simply multiplying the nodal lumped massML,iwith the nodal values of the velocity modeΦ1j(si). The reference frame ofMΦ1j(si)can be the local reference frames of any reference line segment connecting to it as this is only used to compute the coupling coefficientΓ1in (12).We have outlined the process of obtainingΦ1jof the continuous 1D problem fromΦajof the discrete, reduced structure in the previous section. We will now proceed to describe how the information fromΦajis independently used to construct the intrinsic mode shape in sectional forcesΦ2jin the 1D problem. In particular, we seek to obtain the modes in sectional force,Φ2j, and the corresponding modes in sectional strainsCΦ2jdirectly fromΦajand the stiffness matrixKain Eq. (20) without explicitly computing the sectional stiffnessC, which is in general, a function of the arc length s. For clarity we shall useCΦ‾2jto indicate the directly-computed sectional strain modes to emphasise the fact thatCis not explicitly known.We first compute the intrinsic mode in sectional strains,CΦ‾2jfrom the corresponding intrinsic mode in velocityΦ1j, by applying the linearised intrinsic equations. From the second equation in (7) we obtain,(29)ωjCΦ‾2j(s)=-Φ1j′(s)+E⊤Φ1j(s).Using the linear interpolation inΦ1jin Eq. (16) and piecewise constantCΦ‾2jin Eq. (18), we can also write in discrete form as(30)CΦ‾2j,i+12=ωj-1-Φ1j,i+1-Φ1j,isi+1-si+E⊤Φ1j,i+Φ1j,i+12,The sectional force modesΦ2jwill also be computed directly fromΦaj, i.e., there is no need for explicit knowledge of the sectional compliance matrixCin this method. Similar toCΦ‾2j, we can rewrite the first equation in (7) and obtain(31)Φ2j′(s)+EΦ2j(s)=ωjMΦ1j(s)that describes the relation between a pair ofΦ2jandΦ1jwith the correct sign. However for a lumped-mass model whereMis concentrated at the nodes, this equation encounters issues with geometry and is difficult to apply directly. In order to clarify the method used in our approach, we seek an alternative, integral description toΦ2j. We first note that the termKaxain (20) describes the elastic forcesfKand momentsmKexperienced on each of the6Nadegrees of freedom on the analysis nodes of the system (3 displacement and 3 rotation variables in each node) caused by the distribution of displacements/rotationsxa. Thus at each node i,(32)fK,imK,i=(Kaxa)|i.We also note that, in the linear case, this elastic force can equally be described by an imbalance of sectional (internal) forces, i.e., there is a one-to-one relation between the distribution ofx2and the distribution offKandmK(thusxa). In order to obtain the relation, we consider the linear static problem where the structure experiences an internal stress distributionx2which arises from the application offKandmK. We observe that for node i in Fig. 2, the relation between the forces described by theKamatrix, and internal sectional forces (which we always evaluate at the midpoint of the reference line segments), is(33)fK,imK,i=(Ti+12+L1(ρi+12-ρi))x2,i+12-(Ti-12+L1(ρi-12-ρi))x2,i-12where(34)ρi=ri0Due to the piecewise-constant interpolation ofx2within each segment, we evaluate the value ofx2(andΦ2j) at the midpoint of each segment, i.e.,si+12andsi-12. The sign in front of each sectional force term is dependent on the direction of increasing s, as reversing this direction reverses the definition of sectional force and thus reverses the sign.Using these definitions, we could write the relation betweenΦajandΦ2jat nodesiusing (33). This equation can be easily extended to nodes that contain multiple connectivity. Inverting these equations allows us to obtainΦ2jfromΦajandωj, by starting from any unconstrained end point on the assembly (where the sectional forces and moments are zero by definition), then computingΦ2jat each subsequent segment from the value ofΦ2jat the previous segment andKaΦajat the node. For example, for a single, straight beam without any branching structures, the method can be written as(35)Φ2j(si+12)=∑k>i(KaΦa)|k,123∑k>i(KaΦa)|k,456+(r̃k-r̃i+12)(KaΦa)|k,123.From this complete knowledge ofΦ1,Φ2,MΦ1andCΦ2(asCΦ‾2), we can compute all the coefficients (15) in the equations of motion in intrinsic modal coordinates (12).To summarise, the condensation method described in this work is carried out in the four steps summarised in Fig. 1, namely:Step I, the starting point is a 3D FE model of the structure with the requirement that inertia is lumped onto a set of analysis nodes along load paths.Step II, we carry out the Guyan reduction on the 3D model, arriving at the reduced mass and stiffness matrices describing the linear dynamics of the discrete reduced degrees of freedom in displacement and rotationsxaand a linear system described by (20).Step III, the natural modes described in discrete global displacements and rotations of the analysis nodesΦaare obtained from the mass and stiffness matrices.Step IV, we obtain the equivalent, continuous intrinsic modesΦ1,Φ2,MΦ1andCΦ2from the discrete natural modesΦa.The nonlinear intrinsic modal system (12) is obtained by computing the coupling coefficients from the continuous intrinsic modes. Thus, we have developed a method of arriving at a geometrically nonlinear, modal description of a slender structure from a linear 3D FE model of the structure.The problem has been cast as a first-order nonlinear ODE and will be marched using the explicit 4th-order Runge–Kutta numerical scheme. The largest permissible time-step for stable time marching of the system (Eq. (12)) is determined by the inverse of the largest eigenvalue in theWmatrix. As modes of increasing frequency are included for better accuracy of results, the permissible time-step becomes smaller, i.e., the problem becomes increasingly stiff in the numerical sense.This problem can be mitigated by using the structure of the nonlinear modal equations. Higher modes are required to capture the highly deformed shapes, but the fast dynamics of the associated natural frequencies (the linear part of Eq. (12)) are not of interest. Here we define a mode as being high-frequency when its associated eigenvalue,ωj, is higher than a specified cut-off frequency,ωC. Otherwise it is regarded as being low-frequency. We now splitqinto two parts containing the low- and high-frequency modes,qLandqH, respectively, that is,q=qL⊤qH⊤⊤. Using this, Eq. (12) can be split into(36)q̇L=WLqL+NL(q)q+ηL,q̇H=WHqH+NH(q)q+ηHUnder a slow external forcing, the linear part of the second equation, which defines a set of high-frequency harmonic oscillators, operates at a very different frequency to the quadratic part of the equation, which contains contributions from geometrically nonlinear couplings, and to the external forcing, whose characteristic frequency can be orders of magnitudes lower than the linear part. Therefore, if only the low-frequency dynamics are of interest, the system can be approximated by regarding a time-averagedq‾Hthat reacts instantaneously to excitations fromNH(q)qandηHterms. This approximation effectively removes the high-frequency dynamics fromqHstates and converts Eq. (36) into a set of differential–algebraic equations (DAE),(37)q̇L=WLqL+NL(q‾)q‾+ηL,q‾H=-WH-1(NH(q‾)q‾+ηH),withq‾=qL⊤q‾H⊤⊤. This set of equations is marched here by first iterating the value ofq‾Husing the currently known values of system statesqLwith the second equation of Eq. (37), then computing the value ofq̇Lusing the first equation to advance the time marching. Results using this method will be shown in Section 5 and will be compared to full simulation of Eq. (12).The computational complexity of marching the solution at every timestep is dominated by the computation of the quadratic coupling termsN(q)qin Eq. (12). As the coupling is quadratic, the total number of multiplications required will increase with the number of modes retained asO(NM3). The memory required also scales withO(NM3), with each of the two sets of (fully-populated)Γcoefficients requiring8NM3bytes of memory. The timestep itself can be adjusted using the method described above.TheO(NM3)time and memory complexity arises from the global nature of the coupling, which is non-zero between each pair of natural modes. However we observe that each beam segment only couples locally and it can be shown easily that a decomposition ofΓ1ℓ=B1-1D1ℓB1is possible, where column j of the constant matrixB1contain the vectorised form ofΦ1j. Under this decomposition, eachD1ℓmatrix will be a banded diagonal matrix with a very low bandwidth and containsO(NM)non-zero elements. A similar decomposition is possible forΓ2ℓwhich reduces the total time and memory requirement toO(NM2).Two numerical examples will be used to demonstrate the present methodology. The first is a simple cantilever box-beam configuration, for which analytical solutions are available. This will allow verification of the various steps in the analysis. Next, an application of the methodology developed in this paper will be performed on a more complex unsupported structure under large rigid body motions and elastic deformations.Consider a simple prismatic thin-walled cantilever structure with constant dimensionless properties (E=106,ν=0.3,ρ=1) and a rectangular cross section. The box beam has lengthL=20, widthw=1, heighth=0.1, and walls of thicknesst=0.01. MSC Nastran (v2012.1.0) is then used to build 3-D FEM models using 4-noded shell elements. The model has 1600 shell elements, which are reduced to 40 condensation nodes along the centre line. These nodes are free to move in all six degrees freedom.This problem is also well approximated as a constant-section Euler–Bernoulli beam. In this case, the constants in Eq. (1) areM=diagρA,ρA,ρA,ρI1,0,0, andC-1=diagEA,∞,∞,GJ,EI2,EI3, where we have used the usual definitions for the stiffness and inertia constants. The LNMs in intrinsic variables can in this case be solved analytically [32].The eigenvalues of the axial problem areωj=Eρλj, withλj=2j-12πLforj=1,2,…,∞. Letting x denote the spanwise coordinate, the non-zero components in the corresponding normalised eigenvectors are(38)ΦV1j=2ρALsinλjx,ΦF1j=-2EALcosλjx,where for exampleΦV1jdenotes the first element of the velocity component ofΦ1jfrom Eq. (11). The same results are obtained for the torsional modes, with GJ replacing EA andρI1instead ofρA. For the bending modes, the natural frequencies in the x–z plane areωj=(λj)2EI2ρA, whereλjare the solutions to the well-known equation,(39)cos(λjL)cosh(λjL)+1=0.If we now define(40)Λj=cos(λjL)+cosh(λjL)sin(λjL)+sinh(λjL),the corresponding non-zero eigenvectors, after normalisation with Eq. (10), are(41)ΦV3j=1ρALcos(λjx)-cosh(λjx)-Λj(sin(λjx)-sinh(λjx)),ΦΩ2j=λjρALsin(λjx)+sinh(λjx)+Λj(cos(λjx)-cosh(λjx)),ΦF3j=λjEI2Lsin(λjx)-sinh(λjx)+Λj(cos(λjx)+cosh(λjx)),ΦM2j=EI2L-cos(λjx)-cosh(λjx)+Λj(sin(λjx)+sinh(λjx)).Similar equations define the LNMs in the x–y plane. This information can be now used to directly compute the coefficients in the nonlinear equations of motion in modal coordinates (12). They will be used to verify the outcomes of the proposed method based on condensation of the 3-D model.First, we will compare the LNMs obtained from the condensation process with the analytical ones. This will serve to verify details of implementation, but also to highlight some characteristics, and advantages, of our approach. Table 1shows the natural frequencies on a set of modes selected to span the whole space of possible beam deformations. It includes the first three bending modes in each axis, and also the first two twisting and axial deformation modes, even if they have higher frequencies, so as to capture in-plane deformations and 3-D rotations in the nonlinear beam dynamics. The table also includes the order number in which they appear in the reduced-set solution of the 3-D FEM model,Ncondensed. In practice, the process of selecting mode types can be automated by ranking modes according to the total number zero-crossings (nodal points) on the relevant component of the velocity modes, which should lead to better spanning of the space of possible deformations. This however has not been explored in this work.As expected, bending and axial modes compare very well. The analytical model does not include warping restraint, and the differences in the torsional modes are larger. Similar observations can be made of the mass-normalised mode shapes in intrinsic coordinates, which are shown in Figs. 3 and 4. As mentioned above, there is no need to compute the sectional compliance matrix,C, to normalise the component of the modes in stress resultants,Φ2, since they are obtained from the same set of modes in displacements,Φ0, as the modes in velocities,Φ1. The effect of warping restraint can be clearly seen on the torsional modes in Fig. 4. It is important to emphasise that the constant-section beam solution is included here only as a reference: The nonlinear model obtained by the condensation method is calculated in terms of mode shapes and frequencies directly obtained from the 3-D FEM. As a result, the present method, being based on an actual built-up geometrically-accurate model of the structure, naturally includes end effects due to kinematic restrictions along the longitudinal dimension.We still need to compute the productCΦ2jfor each mode shape. This physically represents the force and moment strains (curvatures) in the LNMs. The curvatures for the first out-of-plane bending and torsional modes, obtained from Eq. (30), are shown in Fig. 5. Results are compared against the constant-section beam solutions. As before, bending modes compare well, while restrained warping on torsional modes is not included in the analytical model and creates significant differences near the boundaries, which increase with the frequency. At this stage, we can finally compute all the coefficients in the equations of motion in intrinsic modal coordinates, Eqs. (12).Once the coefficients for the geometrically-nonlinear equations of motion have been identified, the dynamics of the condensed structure can be investigated. The simulations in this paper correspond to free vibrations for a parabolic initial velocity distribution, given asx1(x,0)=x10x/L2, wherex10∈R6will be the parameter in the different test cases. An explicit 4th-order Runge–Kutta was used to solve the first-order intrinsic Eq. (12), with a time stepΔt=0.02and no structural damping. Sectional velocities and stress resultants are then obtained using the modal expansions in Eq. (11). Finally, the material velocities are integrated at the point of interest using the equations of rigid body dynamics.Fig. 6shows the velocities and displacements at the free end of the box beam for small initial velocities,x10=0;0.002;0.002;0;0;0. In this case, the response is in the linear regime and can be compared directly with that obtained using the condensation method developed in this paper. The intrinsic equations of the form (12), calculated via condensation of the 3-D Nastran model, are based on the 10 modes shown in Table 1. Since these modes are directly obtained from the 3-D model, both methods are effectively solving the same equations, except for very small differences due to the modal truncation in the intrinsic solution.If the amplitude of the initial velocities is increased, geometrically-nonlinear effects become relevant. Fig. 7shows the displacements and velocities at the free end withx10=0;2;2;0;0;0. Maximum tip displacements in this case are about 25% of the beam length. The first observation is that a larger modal basis is needed to obtain converged results. Fig. 7 compares the results obtained using the 10 modes employed in the linear case (corresponding to those in Table 1), which were deemed sufficient for that problem, against a model built with the first 18 modes, plus the first two axial modes (N=20), and a model with the first 50 modes. Note that the axial modes are included manually as the lowest axial mode is at number 98 (Table 1). This is necessary to introduce the nonlinear coupling between modes. The shift in the frequency of the in-plane motions is not captured by the small modal basis. The larger basis is not required in order to model the frequency content in the response as such, but rather because the mode shapes are needed to approximate the instantaneous deformed shapes in the nonlinear response. It can be shown analytically [32] that, if no axial modes were included, there would be no couplings in the deformations on the principal bending planes of the isotropic beam.As it can be seen in Fig. 7, results have converged forN=20and that system is further investigated in Fig. 8, which shows the time history of the first 20 modal amplitudes (force component,q2) for the same geometry and initial conditions. All visible modes in Table 1 are identified. The response shows the nonlinearities present in the system, as a linear system would have exhibited a series of harmonic oscillators in the modal response. In particular, note that the torsional modes, which are not excited in the linear case, are rather significant and their amplitude is essentially modulated by the first bending mode in each plane. This finite-rotation effect occurs when there is simultaneous bending in both axes and disappears for planar deformations. A second effect of the nonlinear interaction is that the higher modes exhibit dynamics on a timescale similar to that of the lower frequency mode, which links to the time-marching approach described in Section 4.1.Fig. 9compares the displacement at the centroid of the free end obtained from condensation with 50 LNMs, for large initial conditionsx10=0;2;2;0;0;0, with those obtained from (1) the constant-section intrinsic beam equations, (2) constant-section beam models in Abaqus, and (3) full 3D FEM in Abaqus. The constant section intrinsic modal solution also uses 50 modes on a 200-node beam with adaptive RK4 time-stepping and a relative error for convergence of10-6. The Abaqus constant section finite-element beam solution is a converged geometrically-nonlinear solution (2000 B31 Abaqus elements and time stepΔt=0.01), whereas the Abaqus finite-element 3D solution uses 4500 S4 shell elements with a time stepΔt=0.02and geometrically-nonlinear deformations. The full 3D FEM model has distributed mass and therefore cross-sectional constraints are added to prevent large sectional warping that would appear due to the initial condition. Very good agreement can be observed between both constant section beam models, which verify our implementation of the nonlinear intrinsic beam solver. Equally, the nonlinear solution on the full 3D FEM and that based on the static condensation also agree. The difference between the two sets of results can be seen in theu2response and the results show the improvement obtained when deriving the beam equations directly from the 3D model, such improvements are mostly due in this particular case to the poor approximation to the torsional modes in the constant-section models.Finally, Table 2shows the norm of the displacement vector error of tip displacement as a fraction of the maximum tip displacement between the full 3D model and the present method with 50 modes for different amplitudes of initial excitations of the formx10=0;λ;λ;0;0;0. The error shows that as the maximum tip displacementpz,maxincreases, the normalised error eventually increases due to the increasing effects of section warping not captured in the condensation model. It should be also noted that the error arises mostly from a difference in frequency of the response and is otherwise minimal, as it can be seen in Fig. 9.This final test case is a U-shaped beam that was originally defined by Hesse and Palacios [7]. It consists of a free-flying U-shaped beam assembly with solid rectangular cross-sections subject to external loads. The shape of the structure is shown in Fig. 10(a) with isotropic sectional properties listed in Table 3. The applied forces and moments in Fig. 10(a) areFz=1000f,Fy=100f,Fy2=250fandMy=100Lxf, where the load profilef(t)is shown in Fig. 10(b). All applied forces are dead loads while the applied moments are follower loads that move with the local reference frame. As the position of the centre-of-mass of the free-flying structure under the influence of dead loads can be computed analytically, it offers a good test to assess the convergence requirements to preserve total momentum in the structure.A finite-element model is constructed using a commercial FE analysis package (MSC NASTRAN v2012.1.0), shown in Fig. 11(a). This model contains 4752 3D solid elements and 1–5 lumped mass condensation nodes per 5-m span (i.e., models with total model sizes of 7, 13, 19, 25 and 31 lumped mass nodes respectively). Lumped mass elements are connected to the massless structure using NASTRAN’s RBE3 interpolation elements, so that the spatial location of the lumped mass nodes are expressed as a linear combination of the closest nodes on the structure. Static condensation is then used to reduce the stiffness matrix to the degrees of freedom associated with the lumped mass nodes. For comparison, beam models using equivalent 1-D sectional property definitions (Table 3) were constructed with the same number of nodes and the modal system is obtained in the same way as in the condensed model.Fig. 12shows the non-zero entries in the stiffness matrices of the beam model and the condensed model. It can be seen from the Figure that the stiffness matrix obtained from the condensation of the 3D FE model in the 31-node case is fully populated with significant non-zero entries far from the diagonal, whereas that from a beam model is banded with a very small bandwidth. The maximum magnitude of entries in the fully populated stiffness matrix that are zero in the beam-based stiffness matrix is about 1% of the magnitude of entries within the banded matrix. Fig. 13shows the difference between the lowest 40 structural eigenvalues of the condensed model and the beam-element model for the 31-node problem.The numerical results show that the root-mean-square difference of centre of mass location vector with theory for models both built from prescribed beam elements and constructed using the condensation method (simulated with full modal basis). The error scales, in this case, quadratically with element size (shown as the slope on the log–log plot in Fig. 14). Thus the application of condensation in creating the nonlinear modal system can achieve a similar level of conservation to the beam-element model. In this test case these are mainly discretisation errors that arise due to the linear velocity and piecewise-constant stress interpolations used in the model.The effect of truncation and residualisation on the accuracy of the simulation is also studied with momentum conservation. Here the 31-node full-order model (total structural mode numberNM=180) is either truncated toNClowest-frequency modes by removing the remaining modes from the system, or residualised toNClowest-frequency modes by only removing the linear dynamics of the remaining modes. Their effect on the accuracy of system momentum conservation is shown in Fig. 15(a). The maximum stable timesteps for the truncated and residualised system relative to the full-order system are the same and is shown in Fig. 15(b). It can be seen that residualisation provides significantly better results compared to truncation for any givenNC, while allowing for the same increase in maximum permissible timestepΔtmaxas truncation, an increase that can be very significant.Snapshots of the shapes of the deformed beam during the first 15s of time-marching simulation using the condensed and beam element approach, both with 31 nodes, are shown in Fig. 16. Although both models are obtained by completely different processes, their responses are still very similar. As it can be seen in Fig. 13, the difference in the lowest structural eigenvalues between the condensed model and the beam-element model for the 31-node problem is small. For longer time integrations the small differences between models (as seen in the eigenvalues in Fig. 13) accumulate to give slowly diverging trajectories. Fig. 17plots the response of the 31-node, statically condensed model together with data from a converged solution using beam elements from SAMCEF Mecano (from [7]), the comparison demonstrates that the response is captured to a good degree of accuracy by the condensation technique. The difference between them arises due to the differences present in the linear normal modes between the methods, in particular the capturing of end effects by the reduction method, which is then amplified by the large, geometrically nonlinear motions that the structure underwent. Snapshots of the shapes of the deformed beam during the first 15s of time-marching simulation using the condensed and beam element approach, both with 31 nodes, are shown in Fig. 16. Although both models are obtained by completely different processes, their responses are still very similar. As it can be seen in Fig. 13, the difference in the lowest structural eigenvalues between the condensed model and the beam-element model for the 31-node problem is small. For longer time integrations the small differences between models (as seen in the eigenvalues in Fig. 13) accumulate to give slowly diverging trajectories. Fig. 17 plots the response of the 31-node, statically condensed model together with data from a converged solution using beam elements from SAMCEF Mecano (from [7]), the comparison demonstrates that the response is captured to a good degree of accuracy by the condensation technique. The small differences between them arises from the slightly different estimation of the linear normal modes between both methods, which is then amplified by the long time integrals.To summarise, the numerical cases in this chapter demonstrated the process of static condensation via Guyan reduction combined with the intrinsic formulation in creating a nonlinear modal structural system from a 3D FE model.

@&#CONCLUSIONS@&#
This paper has introduced a procedure to obtain modal-based geometrically-nonlinear descriptions from detailed 3-D finite-element models of structures with lumped inertia and slender sub-components. The condition for this is that a static condensation in the structural model is carried out into grid nodes along the main load paths in the original structure. This is in fact just exploiting the usual approach to obtain stress resultants in aircraft load analysis. Subsequently, the spatial distribution of those analysis nodes is used to construct 1-D representations of the mode shapes.The formulation works in a global basis and it directly uses the linear normal modes of the reduced structure. As a result, there is no loss of accuracy in linear analysis beyond that of the condensation. It is intrinsic, which means that it transforms the mode shapes from nodal displacements and rotations into their spatial derivatives (strains, or internal forces) and time derivatives (velocities). Those are local magnitudes which decouple the computation of local stiffness and inertia with spanwise (integral) geometrically-nonlinear effects. A direct consequence of this is that only linear calculations are required on the large 3-D model, while the geometrically-nonlinear effects are included by the spatial distribution of the analysis nodes. This is a substantial advantage with respect to methods based on projections of the displacement field, which require full nonlinear solutions. Moreover, the intrinsic equations only include quadratic nonlinear terms, which allows computationally-efficient numerical procedures on complex structures.Numerical results have been presented for a cantilever box beam and a three-bar structure. It is first shown that the nonlinear equations of motion can be built directly from the shell model and it has also shown that obtaining the nonlinear coefficients from the direct computation of 1-D strains and curvatures for each mode removes the need for estimation of the sectional compliance matrix. Results for the cantilever box beam were presented against nonlinear beam models and the proposed description has the ability to capture torsional deformations arising from the nonlinear couplings under large amplitude vibrations. The airframe model further demonstrated that this technique is applicable to a more complex structure and that geometrically nonlinear time-domain analysis can still be performed on such a model. It was also shown that the computational speed of the current method can be effectively controlled via approximation of high-frequency dynamics as algebraic equations, while still retaining excellent accuracy and geometrically nonlinear couplings.To conclude, the proposed method allows the generation of geometrically-nonlinear reduced-order models of complex (but slender) structures as a non-intrusive post-processing step of a linear vibration analysis. It produces first-order equations of motion with quadratic nonlinearities that can be time-marched at a relatively modest computational cost.