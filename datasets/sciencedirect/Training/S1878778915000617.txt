@&#MAIN-TITLE@&#
Analysis of ARQ protocols for bacterial quorum communications

@&#HIGHLIGHTS@&#
We model bacterial communication between two populations of bacteria.This model is based on quorum sensing and signalling molecular (AHLs) diffusion.Channel noise is introduced by ISI, considering all the previous symbols.ARQ dynamics and CRC codes are applied for improvement.SR-ARQ performs the best, followed by SW-ARQ; GBN-ARQ performs the worst.

@&#KEYPHRASES@&#
Bacterial communication,Quorum sensing,ARQ protocols,Molecular communication,Nano communications,

@&#ABSTRACT@&#
Quorum sensing (QS) is used to describe the communication between bacterial cells, whereby a coordinated population response is controlled through the synthesis, accumulation and subsequent sensing of specific diffusible chemical signals called autoinducers, enabling a cluster of bacteria to regulate gene expression and behaviour collectively and synchronously, and assess their own population. As a promising method of molecular communication, bacterial populations can be programmed as bio-transceivers to establish information transmission using molecules. In this work, to investigate the key features for molecular communication, a bacterial QS system is introduced, which contains two clusters of bacteria, specifically Vibrio fischeri, as the transmitter node and receiver node, and the diffusive channel. The transmitted information is represented by the concentration of autoinducers with on–off keying (OOK) modulation. In addition, to achieve better reliability, transmission efficiency and channel throughput performance, different Automatic Repeat reQuest (ARQ) protocols are taken into consideration. This configuration is investigated via simulation and the consequent results discussed. The performance of the system is evaluated in terms of transmission time, efficiency, bit error rate (BER) and channel throughput. Results show that Selective-Repeat (SR-ARQ) performs better than Go-Back-N (GBN-ARQ), while the performance of Stop-N-Wait (SW-ARQ) varies for different channel conditions, which is quite different from the performance of ARQ schemes in traditional networking areas.

@&#INTRODUCTION@&#
Instead of language, bacteria communicate with each other through a process called quorum sensing (QS), using signalling molecules, called autoinducers, which are released into their immediate environment  [1]. Also, they are able to measure the concentration of the signalling molecules within a population, which means that the accumulation of autoinducers enables a single cell to sense the number of bacteria (cell density)  [1]. In particular, if the concentration of molecular signals in the medium exceeds a certain threshold, an individual bacterium in a population releases more molecules into the environment  [2], which will in turn increase the density of signalling molecules over time producing a positive feedback process. Thus, the concentration of external autoinducers is correlated with the bacterial cell population density. The output of the QS mechanism can be in various forms and one example is the production of luminescence  [2]. The phenomenon of QS was first found in the luminescence marine bacteria V. fischeri and V. harveyi, which were found to be luminescent when the local bacterial population is high  [1]. The discovery of this phenomenon changed the general perception of many individual, simple organisms existing in the natural world. Bacteria can alter the target gene expressions by changing the signalling molecular concentration, which enables coordinated behaviours, such as competence, virulence, biofilm development, sporulation, light production and attacking suitable hosts, and rapid adaptation to environmental changes, based on the local density of the bacterial population  [3]. Different bacterial species use different classes of signalling molecules, which have minor variations such as different length side chains and side-chain decorations, to communicate  [4]. In some situations, a single bacterial species can have more than one QS system using more than one signalling molecule, which means that a specific bacterial species may respond to different classes of autoinducers in different ways  [5]. In addition, it has also been demonstrated that interspecies communication via QS exists, which is referred to as cross talk  [5]. In this paper, a diffusive bacterial communication network between two populations of bacteria has been modelled and analysed, using the well-studied bacteria species, V. fischeri, which is most famous for its aforementioned bioluminescence and has been used to study toxicity of aquatic environments. The transmitted information is represented by the concentration of signalling molecules, which will then be encoded into data frames, with the release of molecules represented by a binary ‘1’ and no release represented by a binary ‘0’.Noise, which may result from gene expressions at the intracellular level and the diffusion of autoinducers, presents a major challenge for the robust function and performance of natural and engineered quorum sensing networks  [6]. For the bacterial communication system proposed in this paper, the effect of inter symbol interference (ISI) caused by molecular diffusion is considered as a major source of impairment. This may result in data packet corruption and out-of-sequence delivery, making it necessary to apply error detection rules and Automatic Repeat reQuest (ARQ) mechanisms for reliable transmission. In this work, ARQ protocols are used rather than error correction schemes because error detection requires much simpler decoding operations than does error correction  [7]. The term ARQ was first introduced by Chang  [8], after which three widely used ARQ schemes, including Stop-N-Wait (SW-ARQ), Go-Back-N (GBN-ARQ) and Selective-Repeat (SR-ARQ), have been presented and developed  [9]. The performance of the SW-ARQ protocol has been investigated in our previous work in  [10]. In this paper, we will compare the performance of the three kinds of ARQ schemes for bacterial communication.The contributions of this paper are as follows. To our knowledge, although GBN-ARQ and SR-ARQ are well-known concepts in networking and coding theory, this is their first use in a bacterial quorum communication system to enhance reliability. Specifically, this research maps existing protocol concepts to biological QS processes and shows how different protocols and parameters can be fitted to different modes of bacterial communication. Also, transmission delay, transmission efficiency, BER and channel throughput of the system are evaluated when different parameters are applied. Results show that the parameter settings are quite different compared with that of the ARQ techniques used in traditional communication fields. This work could be used in improving the sensitivity of bacterial biosensors and drug delivery systems. The rest of this paper is organized as follows: In Section  2, the basic bacterial communication scheme and the transmitter and receiver models are introduced, followed by the establishment of the channel in Section  3. In Section  4, the ARQ protocols and error detection codes are used to enhance the system performance, followed by the results and discussions in Section  5. Finally, Section  6 gives the conclusions and possible future work.The high degree of randomness and limited capabilities of a particular bacterium makes communication between two individual bacteria unreliable  [2]. In addition, the delay in the communication process can be fairly large due to biological actions such as transcription and translation. In other words, an individual bacterium is very primitive and unreliable and hence incapable of transferring information by itself. Hence, to achieve reliability of the communication system, here, the communication model between two populations of bacteria which is proposed in  [2] is taken into consideration. In this model, a cluster of bacteria trapped in a chamber, which is collectively capable for reliable transmission and reception of molecular information, is considered as a node  [2]. The model consists of the transmitter node, the receiver node and the communication channel. Both the transmitter and receiver nodes are considered to be genetically modified bacteria, which can sense specific types of signals and respond accordingly  [2]. Molecular communication between two nodes can be made up of three procedures. The transmitter node produces the signalling molecules by adequate stimulation, then these molecules propagate through the medium undergoing Brownian motion and finally the receiver node senses the concentration of the local signalling molecules and takes appropriate actions. The communication system is assumed to be in a theoretically infinite space. The transmitted information is encoded via the concentration of signalling molecules, i.e. the embedding of the information is by alteration of the concentration of the molecules and its transmission relies on diffusion. The output of the receiver node, in the form of luminescence, is measured in steady-state to estimate the concentration of signalling molecules at the vicinity of the node, and hence decode the transmitted information  [2].In this proposed model, both the transmitter and receiver nodes containminstances of the bacterium V. fischeri, which is the most commonly studied QS system in gram-negative bacteria. These bacteria are motile, gram-negative rods, 0.8–1.3 μm in diameter and 1.8–2.4 μm in length  [11]. Bioluminescence in this bacterium is controlled by the QS system, which is composed by two regulatory genes, luxI and luxR, coding for proteins LuxI and LuxR, respectively. At low cell densities when only a small number of bacteria are present, the signal (3-oxo-C6-HSL, an N-acyl homoserine lactone or AHL), which is synthesized by the protein LuxI, is produced by the bacteria at a low level. Then the molecules diffuse out of the bacteria cells and propagate into the surrounding environment. When the bacteria population increases, the concentration of AHLs around the node will grow. If the concentration of the signal reaches a critical threshold, it is able to interact with the LuxR protein, which acts as the ligand receptor for AHL. The LuxR/AHL complex binds to a region of DNA called the lux box, activating the transcription of the bioluminescence operon, which is made up of the luxCDABE genes. In addition, the LuxR/AHL complex also triggers the AHL (via LuxI) to be produced at a higher level. Thus the AHL is said to auto-induce its own synthesis. The process of bioluminescence is illustrated in Fig. 1.In this work, the number of bacteria in each node is assumed to be constant. The bacteria inside the node can grow, divide and die to maintain the constant population through the process of gene regulation  [12]. It is assumed that each bacterium can sense and produce two different types of AHL molecules, denoted as type I and type II  [13]. Hence, each bacterium must be equipped in general with two distinct receptor types (for type I and type II molecules) to perform its functionality as a transmitter or receiver. Type II molecules are produced with the stimulation of type I molecules, while luminescence is produced when stimulated by type II molecules. However, depending on the different functionalities, as a transmitter or receiver, only one type of receptors is activated. For the bacteria in the transmitter node, only type I receptors are enabled, while for bacteria in the receiver node, only type II receptors are enabled, a process which can be controlled by proper enzymes. The bacteria inside the transmitter node can produce various concentrations of type II molecules to be transmitted through the channel by the stimulation of different levels of concentration of type I molecules surrounding them  [2]. At the receiver, each bacterium senses the concentration of type II molecules through type II receptors, followed by the production of luminescence by bacteria, which is used to decode the input signal concentration.In the channel model which is shown in Fig. 2, AHLs propagate through the channel via a diffusion process in a three dimensional medium, which is assumed to be extremely large compared to the size of the information molecules. Furthermore, collisions between these molecules are neglected and their motion is inspired by the forces produced by the constant random thermal molecular motion within the fluid medium. The transmitter encodes its information into the concentration of signals. The emitted signalling molecules then diffuse through the channel to the receiver which is at a distancedfrom the transmitter. At the receiver, the transmitted information is decoded according to the concentration of type II molecules detected by type II receptors.Due to the process of QS, the bacteria cells in the receiver can synchronously respond to the molecules as they arrive. In addition, at the receiver, although the molecules can pass through the bacteria cells in the node, the concentration of signalling molecules and the luminescence output will not be affected since the type I receptors in the node are not activated. Thus the channel can be modelled as a Communication via Diffusion (CvD) channel as follows.The proposed channel is a binary asymmetric channel (BAC) with binary input and binary output and a probability of error, which is known as crossover probability. To effectively represent the transmitted symbols, the propagation time is divided into time slots, also called symbol durations, which have the equal length. Only one symbol propagates in single time slot, which is denoted byts. The information is encoded by concentration with binary representation. Specifically, if the number of information molecules arriving at the receiver at a certain time slot exceeds a thresholdτ, the symbol is represented by ‘1’. Otherwise, it will be interpreted as ‘0’. Moreover, with OOK modulation employed, the release of molecules in a time slot represents a binary one while their absence for the same duration represents a binary zero. However, errors may be caused by Inter Symbol Interference (ISI), which is a form of distortion of a signal in which one symbol interferes with subsequent symbols. It is an unavoidable consequence of both wired and wireless communication systems and is known to degrade the error performance of communication systems, particularly when the system is stochastic  [14]. It can be noticed that the received signals tended to spread to adjacent symbols and smeared into each other when a sequence of symbols are transmitted  [15]. The ISI effect is related to the properties of the medium used, the distance of the symbol propagation and the selection of the threshold value. In the diffusive communication system here, some information molecules may arrive at the receiver after the current time slot according to the diffusion dynamics, which will lead to the incorrectly decoding of the received symbol of the next time slot.In essence, the information molecules propagate through the fluid medium undergoing Brownian motion which is a random procedure and a probabilistic behaviour, which means that there is a probability that the molecule will hit the receiver at a time slot. At a certain time durationt, the capture probability, which is defined as the probability of success at a specific time period, in a three dimensional environment is given by  [16]:(1)P(d,t)=RR+derfc{d2Dt}wheredis the distance away of the information molecule from the receiver with radiusR, the value of which is related to the number of bacteriamin the receiver node. The diffusion coefficientDis 4.9×10−6  cm2  s−1, which is settled as a conservative value for AHL in water at 25 °C  [17].In this work, the communication channel is a binary one, where each molecule arrives at the receiver or does not. Due to ISI, the number of molecules received in a time slot which is denoted byNhitis made up of the molecules sent at the start of the current time slot (Nc) and the sum of those sent at the start of the previous symbol durations (Np). It is assumed thatninformation molecules are sent at the start of each symbol duration. Also, the transmitted information includeskbits. Due to ISI, theith(i∈[2,k])symbol can be affected by the symbols from(i−1)previous time slots. For theith symbol, the number of molecules received within the current time duration is a random variable and follows a binomial representation, which can be approximated with a normal distribution  [18]:(2)Nc∼B(n,P1)∼N(nP1,nP1(1−P1))whereP1represents the capture probability with receiver radiusR, transmission distancedand symbol durationts, which can be calculated from Eq. (1).The number of left over moleculesNpbelonging to all of the previous time slots can be given as:(3)Np∼∑j=1i−1(B(n,Pj+1)−B(n,Pj))∼∑j=1i−1[N(nPj+1,nPj+1(1−Pj+1))−N(nPj,nPj(1−Pj))]∼N(μpi,σpi2)wherePjis the capture probability with receiver radiusR, transmission distancedand time duration ofjts. Particularly, for the case ofj=1,Pjrepresents the capture probability in one time slot, which is identical toP1in Eq. (2).μpi,σpi2are the expectation and variance of the distribution of the number of left over molecules from all the previous time slots, respectively. The total number of moleculesNhitreceived in theith symbol duration is the summation ofNcandNp.It can be derived from Eq. (3) thatμpiandσpi2can be described by:(4)μpi=n(Pi−P1)(5)σpi2=nP1(1−P1)+2n∑j=2i−1Pj(1−Pj)+nPi(1−Pi).For theith symbol(i>0), there exist(i−1)previous time slots and thus2idifferent cases, i.e.[0,(2i−1)], represented as binary numbers. For example, there are two previous time slots for the third symbol, the 8 corresponding cases of which can be represented by(000,001,010,011,100,101,110,111), where the last bit represents the third symbol and the other two bits represent the previous symbols. If the transmitted symbol in the current time slot is 1, the number of received molecules need to be larger thanτfor correct decoding. The total number of molecules that have arrived at theith time slot is represented by:(6)Nhit=Np+Nc∼N(μhit(i),σhit(i)2)whereμhit(i)andσhit(i)2are the expectation and variance of the distribution ofNhitand can be represented by:(7)μhit(i)=μpi+nP1=nPi(8)σhit(i)2=2n∑j=1i−1Pj(1−Pj)+nPi(1−Pi).Thus, the error probability for this case is:(9)pe(1)=P(Nhit<τ)=1−Q(τ−nPin(2∑j=1i−1Pj(1−Pj)+Pi(1−Pi)))where theQ-function is the tail probability of the standard normal distribution. Similarly, for the case when the symbol in the current time slot is 0, the total number of molecules received in theith symbol duration is:(10)Nhit=Np∼N(μpi,σpi2).Hence, the error probability for the case when the transmitted symbol in the current time slot is 0 is given as:(11)pe(0)=P(Nhit>τ)=Q(τ−n(Pi−P1)n(P1(1−P1)+2∑j=2i−1Pj(1−Pj)+Pi(1−Pi))).Due to the fact that the capture probability is a function ofR,d,ts, and that the receiver radiusRis determined by the number of bacteriamin the node, the error probability for given values ofn,τ,m,d,tscan be calculated from(pe(0)+pe(1))/2.The bit error rate (BER) is considered as a key parameter which is often employed to assess the performance of communication systems that transmit information from one position to another. Here, the BER refers to the probability of one bit error when information symbols are transmitted in the diffusion based communication channel. According to  [18], most molecules arrive at the receiver in a relatively short time while only a few molecules arrive after a very long period of time, which will lead to the unsatisfied increasing average hitting time. In this model, the symbol durationtsis chosen as the time before 60% of the molecules arrive at the receiver. In this paper, the BER is the value when the error probability reaches the minimum forτ∈[1,n]. The corresponding values of thresholdτare applied in the following research. The results and discussions will be presented in Section  5. Theoretically speaking, the application of ARQ will decrease the BER.A time varying channel with a relatively high BER level causes frequent packet corruptions and out-of-sequence delivery, which needs error check codes and ARQ mechanisms for effective error detection and recovery, respectively  [19]. ARQ, which is usually located at the data link layer, is an error control technique to ensure that a data stream is delivered accurately to the user despite errors in transmission. ARQ forms the basis of peer-to-peer protocols that provide for the reliable transfer of information. The basic elements of ARQ protocols include the information frames that transfer the information, the acknowledgement frames (ACKs), the negative acknowledgement (NAK) and the time out mechanism. The ACK/NAK signifies the receipt of a given frame. The time out mechanism is required to maintain the flow of frames.Generally, a population of bacteria is able to perform distributed information processing, where each bacterium in the colony is capable of information storing, processing, and interpreting information  [20]. Also, the advance of synthetic biology, particularly the foundation of the BioBricks database  [21], enables many types of capabilities based on genetically engineered bacteria, including timing, counting, clocking, logic gates, pattern detection and intercellular communication  [22]. Moreover, because ARQ mechanisms and error control operations can be implemented through circuits  [7], it is possible to implement both techniques in bacterial communication systems as well. In addition, genetically engineered bio entities can harvest energy from biological systems and require no external energy sources, which is therefore expected to be energy efficient  [23]. Such capabilities greatly improve the bacterial cooperation level during the communication process, making it possible to meet the requirement of high processing and memory intensive ARQ protocols. Generally speaking, the SW-ARQ protocol has been investigated in our previous work  [10] which shows that it suffers from inefficiency due to the fact that the channel is idle between the transmission of the message and the reception of its ACK or NAK. Theoretically, the GBN-ARQ and SR-ARQ protocols offer a better performance but have a higher requirement for buffers at the receiver  [24]. In this paper, the three basic ARQ schemes will be analysed separately and then compared with each other.In SW-ARQ technique, after transmitting a frame, the transmitter waits for an ACK/NAK from the receiver before transmitting the next frame. On receiving a frame, the receiver checks errors using error detection techniques. If no error is found, the receiver sends an ACK to the sender through the feedback path. If errors are detected, a NAK is transmitted back to the transmitter. If ACK is received by the transmitter, the transmitter transmits the next frame. Otherwise, it will retransmit the previously sent frame. However, if the ACK/NAK is lost, the transmitter waits for a time out period until next transmission. In short, the retransmission continues until a frame is received correctly and it is positively acknowledged, or the number of retransmissions reaches a certain threshold. In addition, in order to avoid ambiguities, sequence number can be added to the frames. The protocol continues in this manner until all the frames are transmitted successfully.In the GBN-ARQ technique, the transmitter continuously transmits a block ofW(Wis often known as window size) frames without waiting for the acknowledgement for the individual frame. Each frame must be buffered (stored) until a valid ACK arrives, in case retransmission is needed.Wrepresents the maximum number of frames that may be outstanding simultaneously. The receiver keeps track of the sequence number of the next frame it expects to receive, and sends that number with every ACK it sends. The receiver only sends the NAK if errors are detected. When the transmitter receives a NAK for the first time, it stops transmission and resends all the frames which were transmitted prior to stopping of transmission but starting from the frame for which NAK is received, and discards the frames transmitted prior to the frame in error from the memory. In short, the receiver will discard any frame that does not have the exact sequence number it expects (either a duplicate frame it already acknowledged, or an out-of-order frame it expects to receive later) and will resend an ACK for the last correct in-order frame. Once the sender has sent all of the frames in its window, it will detect that all of the frames since the first lost frame are outstanding, and will go back to sequence number of the last ACK it received from the receiver process and fill its window starting with that frame and continue the process over again. For example, if the fourth frame of the block is the first negatively acknowledged from when up toWth frame has been transmitted, the transmitter will then discard first to third frames from its buffer and retransmit all the frames from fourth toWth. It is the best situation when none of the frames in one block is negatively acknowledged and successful transmission ofWpackets involves with minimum two propagation delays. Compared with the best situation in SW-ARQ where one frame is involved with two-propagation delays, GBN-ARQ provides throughput improvement in theory.SR-ARQ operates in a similar way to GBN-ARQ but only retransmits the frame for which a NAK is received. The receiver accepts out-of-order frames and buffers them. This requires more buffer at the receiver to store correct out of sequence frames. Fig. 3shows examples of the process of transmitting a series of frames with ACKs and NAKs of the three ARQ schemes.In the channel model here, the transmitter node generates a sequence of information frames for transmission. Each information frame contains a header which contains sequence numbers that are essential for in-sequence delivery, information bits and error detection bits. Here, the error detection is effected via cyclic redundancy check (CRC) codes, which are represented by polynomials, having good error sensing performance, fast encoding and decoding capabilities, and applicability to varying message lengths  [25]; these are appended to the frame to determine if error occurs during transmission. It is assumed that the information flows only in one direction, from the transmitter to the receiver. The reverse communication channel is used only for the transmission of ACKs/NAKs. In Section  2, it may be observed that for the transmitter node, only type I receptors are activated, while for the receiver node, only type II receptors are enabled. Also, it has been explained in Section  3 that the transmitted information is represented by the concentration of type II molecules. Thus the information frame is made up of certain number of information bits, which are encoded by type II molecules. Similarly, the acknowledgement frames are composed of fixed number of bits encoded by type I molecules. In addition, because the signalling molecules used to encode the acknowledgement frames in the reverse channel (type I molecules) are different from autoinducers used to encode the information frames in the forward channel (type II molecules), they will not interfere with each other. Also, at the receiver node, the inhibition of type I receptors makes it impossible to generate extra type II molecules, providing a more accurate decoding of the transmitted information at the receiver. Therefore, both transmission and reception are able to generate and receive different types of signalling molecules to avoid adjacent channel interference. Moreover, genetic marking techniques, such as fluorescent labelling technology, could be applied to distinguish between the type I molecules used for sending messages and that for acknowledgement messages  [26].

@&#CONCLUSIONS@&#
In recent years, bacteria have been considered as one approach for molecular communication using QS. In this paper, a bacterial communication network model through a diffusion channel between transmitter and receiver bacteria populations is proposed. For the first time, the widely used ARQ protocols have been employed, specifically utilizing CRC coding, SW-ARQ, GBN-ARQ and SR-ARQ. For each of these three ARQ protocols, BER and delay performance worsen as the transmission distance increases, leading to the choice of 4 μm as a feasible and representative value. Given the increasing complexity and delay from high order CRC polynomial operation, CRC-8 is selected. Increasing the window size used enhances performance but the gains saturate meaning that a value of 7 is found to be a highly satisfactory compromise for GBN-ARQ, and a value of 4 is the better for SR-ARQ. Also, the error performance is better with a larger bacterial population in the receiver node. Moreover, there are two crossover points for the transmission time, indicating that when the number of molecules per bit is in a range of approximately 40–200 for GBN-ARQ and 40–160 for SR-ARQ, larger frame lengths perform better, with reduced time consumption. In addition, the throughput efficiency with smaller frame lengths is greater when the number of molecules emitted at the start of each time slot is in a range of up to 200 for GBN-ARQ and up to 140 for SR-ARQ. Finally, with identical parameter settings, the performance of the three ARQ schemes has been investigated, indicating that SR-ARQ performs better than GBN-ARQ, while the performance of SW-ARQ varies according to the range of the number of emitted molecules at the start of each time slot; this is quite different from the performance of ARQ schemes in traditional networking areas. The simulation results described show how traditional ARQ schemes perform in bacterial communication networks and how the parameters may be determined to achieve a better channel performance. It must be stressed, however, that the simulations are conceptual and intended to lay the groundwork for ongoing and detailed study. We recognize that there are details to be filled in. These include a mechanism for a cluster of transmitter bacteria to release information molecules at an appropriate rate, progress in biological logic gates based on transcription and translation  [30] to create complex coding, windowing and sequencing operations. Nevertheless, we consider that the broad conclusions with respect to the performance of the established ARQ schemes over the bacterial diffusion channel to be valid. In addition to the topics above, future work includes the optimization of the frame length to achieve the best channel throughput and the investigation of the energy consumption. We would then envisage that a possible application of ARQ protocols in bacterial communications would be to improve the sensitivity of bacterial biosensors and drug delivery systems.