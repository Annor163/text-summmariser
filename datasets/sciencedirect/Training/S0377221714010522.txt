@&#MAIN-TITLE@&#
Optimal deleveraging with nonlinear temporary price impact

@&#HIGHLIGHTS@&#
We propose a portfolio management model to balance equity and liability.Efficient frontiers are constructed to visualize tradeoff between equity/liability.We further study portfolio management under leverage requirement.The deleveraging problem is a non-convex constrained polynomial program.An efficient algorithm is developed to solve the polynomial optimization problem.

@&#KEYPHRASES@&#
Portfolio deleveraging,Equity and liability,Polynomial optimization,Nonlinear temporary price impact,Lagrangian method,

@&#ABSTRACT@&#
In this paper, we first propose a portfolio management model where the objective is to balance equity and liability. The asset price dynamics includes both permanent and temporary price impact, where the permanent impact is a linear function of the cumulative trading amount and the temporary impact is a kth (between 0 and 1) order power function of the instantaneous trading rate. We construct efficient frontiers to visualize the tradeoff between equity and liability and obtain analytical properties regarding the optimal trading strategies. In the second part, we further consider an optimal deleveraging problem with leverage constraints. It reduces to a non-convex polynomial optimization program with polynomial and box constraints. A Lagrangian method for solving the problem is presented and the quality of the solution is studied.

@&#INTRODUCTION@&#
It is pointed out in the world bank report (D’Hulster, 2009) that one of the main contributors to the recent global financial crisis is the excessive leverage of financial institutions. As a result, the leverage ratio, a non-risk-based capital measure, has been introduced to supplement minimum capital requirements (Basel Committee on Banking Supervision, 2011). The leverage ratio, or equivalently, the debt-to-equity ratio, is a key factor that reflects an institution’s ability to bear risk and sustain losses. By analyzing 15 trading losses with amounts exceeding $1 billion since 1990, Barth and McCarthy (2012) finds that a strong capital ratio, or equivalently, a small leverage ratio, allows an institution to withstand difficult economic times and survive from catastrophes better. Keeping a good balance between equity and liability is thus particularly important to individual institutions as well as to the financial system as a whole.Asset and liability management has been widely studied in the field of financial accounting (see Carino and Ziemba, 1998; Kusy and Ziemba, 1986; Zenios, 1995; Ziemba and Mulvey, 1998). The main purpose of asset and liability management is to choose a portfolio of the least cost or maximal return so that the asset meets the liability. See Zenios and Ziemba (2006) for a comprehensive survey of the theories and methodologies for asset and liability management. In our article, we propose a portfolio management model where the objective is to obtain a good balance between equity and liability during a rapid deleveraging process. With a pre-determined leverage ratio as a benchmark, we define the excessive liability as the difference between the actual and the benchmark liabilities. The higher the excessive liability, the further the leverage ratio is away from the desired level. Hence, the excessive liability, to some extent, can be viewed as a risk measure. We take into account that rapidly deleveraging a portfolio to reduce excessive liability is costly and market impact must be considered. There is a vast literature on how to liquidate portfolios to minimize both trading cost and trading risk. Various risk measures have been suggested (see Almgren and Chriss, 2000; Forsyth, Kennedy, Tse, and Windcliff, 2009; Gatheral and Schied, 2011; Schied and Schöneborn, 2009; Schied, Schöneborn, and Tehranchi, 2010). These works focus on seeking a liquidation strategy that depletes the whole portfolio within a small trading period. Unlike them, our objective is to decide what fraction of the portfolio should be liquidated for the purpose of reducing the leverage ratio. Our model thus has both similarities and differences with asset liability management models and portfolio liquidation models.In the second part of the paper, we further investigate the deleveraging problem with a non-positive excessive liability constraint. The leverage ratio after liquidation must reach the benchmark value. This type of optimal deleveraging problems have been studied in Brown, Carlin, and Lobo (2010) and Chen, Feng, Peng, and Ye (2014), where the price impact functions are assumed to be linear. However, both theoretical studies and empirical works have shown evidence of nonlinearity in the price impact. For example, Lillo, Farmer, and Mantegna (2003) show that the temporary price impact function is strictly concave. The concavity is also explained in Gabaix, Gopikrishnan, Plerou, and Stanley (2006), Chacko, Jurek, and Stafford (2008) and Bouchaud, Farmer, and Lillo (2008). Many empirical works are in favor of a power temporary impact function with an exponent between zero and one (see Almgren, Thum, Hauptmann, and Li, 2005; Engle, Ferstenberg, and Russell, 2006; Gabaix, Gopikrishnan, Plerou, and Stanley, 2003; Kempf and Korn, 1999; Moro et al., 2009; Torre and Ferrari, 1997; Toth et al., 2011). For example, Almgren et al. (2005) demonstrate that a power of 0.6 is plausible when data from Citigroup equity trading is used. Toth et al. (2011) report a power of around 0.5 for small tick contracts and 0.6 for large tick ones by analyzing proprietary trading data from Capital Fund Management. In our work, we assume an arbitrary exponent between 0 and 1 and study the corresponding optimal deleveraging problem.With a power temporary price impact function, the portfolio deleveraging problem in the first part becomes a polynomial program with box constraints. We obtain analytical results on how the optimal trading strategy responses to changes in the liability-aversion parameter and the benchmark leverage ratio. Under a convexity assumption, the uniqueness of the optimal solution is guaranteed. We construct efficient frontiers to visualize the tradeoff between the equity and liability. We further investigate how liquidation priority is influenced by intrinsic characteristics such as initial asset price and price impact. Our results show that trading preference is given to those assets with higher initial prices or smaller price impact.The optimal deleveraging problem in the second part is modeled as a non-convex polynomial program with polynomial and box constraints, where the polynomial constraint corresponds to the non-positivity of the excessive liability. In the absence of convexity, the optimization problem is rather challenging, even in the linear temporary price impact case with quadratic objective and constraint (see Chen et al., 2014). We extend the Lagrangian method proposed in Chen et al. (2014) to the case of non-convex polynomial programs. The method is closely related to the portfolio management problem in the first part. We provide conditions under which the Lagrangian algorithm provides a global optimal solution. When such conditions are not satisfied, the algorithm returns an approximate solution and an upper bound on the loss in equity induced by adopting a suboptimal strategy is derived.The optimal deleveraging strategies may differ significantly under linear and nonlinear temporary price impact. We consider the case of a permanent price impact dominant market, where the permanent price impact outweighs the temporary impact. This often arises in practice. For instance, Schöneborn and Schied (2009) show that in markets that do not suffer from extreme cash outflows, the impact of stock sales is predominantly permanent. Holthausen, Leftwich, and Mayers (1990) observe from their data that the permanent impact accounts for 85 percent of the total impact (Schöneborn and Schied, 2009). Coval and Stafford (2007) also show that the permanent price impact could be strongly dominant. In a permanent impact dominant market, we show that, when the temporary price impact is linear, at most one asset in the portfolio could be partially liquidated. All other assets either are fully liquidated or remain intact. This does not generally hold when the temporary price impact is nonlinear.The contributions of this article are three-fold. First, we propose a portfolio management model, where the objective is to gain a good balance between equity and liability when a portfolio is deleveraged and market impact is taken into account. Under a power temporary price impact, the problem reduces to a polynomial program with box constraints that can be solved using standard optimization softwares. Second, we derive analytical properties regarding the optimal deleveraging strategies, which provide general guidelines for practical applications. Third, we extend the Lagrangian method of Chen et al. (2014) to non-convex polynomial programs with polynomial and box constraints that result from the optimal deleveraging problem with a leverage constraint.The paper is organized in the following way. In Section 2, we present our first portfolio deleveraging problem, analyze the effects of the liability-aversion parameter and the benchmark leverage ratio on the optimal trading strategies, construct efficient frontiers to visualize the tradeoff between equity and excessive liability, and investigate the influences of initial asset prices and price impact on the liquidation priority. In Section 3, we study the optimal deleveraging problem with a leverage constraint, present a Lagrangian method for solving the resulting non-convex polynomial optimization program with polynomial and box constraints, and analyze the effects of linearity on the optimal trading strategy in a permanent price dominant market. In Section 4, we present numerical experiments verifying the properties of the optimal trading strategies. We conclude in Section 5 with a discussion on future research.In this section, we consider a portfolio management problem where the objective is to reduce liability and hence obtain a better balance between equity and liability. The problem is reduced to a polynomial optimization program with box constraints. We construct efficient frontiers to visualize the tradeoff between equity and excessive liability and obtain analytical properties of the optimal trading strategy.The asset price dynamics is given by(2.1)pt=p0+Γ(xt−x0)−Λytk,wherept,xt,yt≥0∈Rmare vectors of initial prices, holdings and trading rates at time t,ytk(0 < k ≤ 1) is a vector withyi,tkas its ith entry, and Γ and Λ are positive definite diagonal matrices with permanent and temporary price impact coefficients on the diagonals respectively (i.e., γi= Γi, i> 0 and λi= Λi, i> 0). Since our primary goal is to deleverage a portfolio, we consider pure selling strategies only (and hence the minus sign beforeΛytk). The permanent price impact is related to the cumulative trading amount while the temporary price impact is related to the amount traded per unit time. Denote q = p0 − Γx0. The price dynamics then becomes(2.2)pt=q+Γxt−Λytk.The price process (2.2) generalizes those in Brown et al. (2010) and Chen et al. (2014). The temporary price impact here is no longer restricted to a linear function as in Brown et al. (2010) and Chen et al. (2014). It is given by a power function with an arbitrary exponent between zero and one. As explained in Introduction, such a nonlinear temporary price impact has been supported by many empirical works on price impact.We assume continuous execution during the trading period. The holding dynamics is thusxt=x0−∫0tysds. Without loss of generality, let the trading period be T = 1. The asset price is p0 = q + Γx0 before trading and p1 = q + Γx1 after trading. The amount of cash generated isK=∫01pt⊤ytdt.After paying the debt, the remaining liability becomesl1=l0−K=l0−∫01pt⊤ytdt,where l0 is the initial liability. Denote the value of the portfolio after liquidation bya1=p1⊤x1. The net equity at time T = 1 is hence given by(2.3)e1=a1−l1=p1⊤x1−l0+∫01pt⊤ytdt=q⊤x1+x1⊤Γx1+∫01(q⊤yt+xt⊤Γyt−yt⊤Λytk)dt−l0.We assume constant trading rate as in Brown et al. (2010) and Chen et al. (2014). That is, yt≔ y is constant. Since the liquidation duration is T = 1, the trading rate y equals the trading amount over the whole liquidation period: y = x0 − x1. We thus get(2.4)l1=12y⊤Γy+y⊤Λyk−p0⊤y+l0,(2.5)e1=12y⊤Γy−y⊤Λyk−x0⊤Γy+e0,wheree0=p0⊤x0−l0is the initial net equity.Let ρ1 denote the benchmark leverage ratio at time 1, where the leverage ratio is defined as the ratio of liability over net equity. From the practical viewpoint, the original leverage ratio is such that l0/e0 ≫ ρ1 and we would like to reduce the leverage ratio from l0/e0 towards ρ1. Namely, l0 − ρ1e0 ≫ 0 and we would like to liquidate some assets to reduce f1 ≔ l1 − ρ1e1 towards zero. We call f1 the excessive liability after liquidation. It is given by(2.6)f1=(1−ρ1)12y⊤Γy+(ρ1+1)y⊤Λyk−(p0−ρ1Γx0)⊤y+l0−ρ1e0.On the other hand, due to market impact, liquidation leads to trading cost and hence loss in equity. It is desirable to also minimize the loss in equity. The portfolio deleveraging problem is thus to balance the equity and the excessive liability. Let α > 0 represent the level of liability-aversion. We also assume no shortselling as in Chen et al. (2014) and Brown et al. (2010). The optimization problem is then given by the following:(2.7)maxy∈Rme1−αf1subjectto0≤y≤x0.Plugging in the expressions of e1 and f1, (2.7) becomes the following bounded nonlinear program:(2.8)maxy∈Rm12(1+αρ1−α)y⊤Γy−(1+αρ1+α)y⊤Λyk+[αp0−(1+αρ1)Γx0]⊤ysubjectto0≤y≤x0.Here we have dropped the constant term in e1 − αf1 since it does not affect the solution of the optimization problem.In the following, we first analyze how the liability-aversion parameter α and the benchmark leverage ratio ρ1 affect the optimal trading strategy. We then generate efficient frontiers by sweeping out a range of the liability-aversion parameter for different temporary impact functions (i.e., different exponent k). Finally, we investigate how initial prices and price impact affect the liquidation priorities.Proposition 2.1The optimal trading amount y* is increasing with respect to the liability-aversion parameter α.Let y1,* and y2,* denote the optimal solutions corresponding to α1 and α2, respectively, where α1 < α2. We want to show that y1,* ≤ y2,* elementwise. Assume to the contrary that there exists an asset i such thatyi1,*>yi2,*. Note that functions e1(y) and f1(y) are separable due to the fact that Γ and Λ are diagonal matrices. Thenyi1,*andyi2,*are the optimal solutions ofmaxy∈Re1i−αf1isubjectto0≤y≤x0,iwith α = α1 and α = α2, respectively. Here(2.9)e1i=12γiy2−λiy1+k−γix0,iy,(2.10)l1i=12γiy2+λiy1+k−p0,iy,and(2.11)f1i=l1i−ρ1e1i.Note that we have omitted the constant terms in (2.4) and (2.5), which are irrelevant for the optimization problem. By optimality, we have(2.12)e1i(yi1,*)−α1f1i(yi1,*)≥e1i(yi2,*)−α1f1i(yi2,*),and(2.13)e1i(yi2,*)−α2f1i(yi2,*)≥e1i(yi1,*)−α2f1i(yi1,*).Adding the above two inequalities, we get(2.14)(α2−α1)(f1i(yi1,*)−f1i(yi2,*))≥0.According to (2.5),(2.15)ddye1i(y)=γiy−(k+1)λiyk−γix0,i<0since0≤y≤x0i. Thus we havee1i(yi1,*)<e1i(yi2,*). From (2.12), we getf1i(yi1,*)<f1i(yi2,*). But this contradicts (2.14). Therefore,yi1,*≤yi2,*must hold for all 1 ≤ i ≤ m. This finishes the proof of the proposition.□This result is consistent with our intuition. An investor that is more liability-averse prefers to liquidate more assets. On the other hand, an investor that is less liability-averse is reluctant to liquidate due to the trading cost incurred by market impact.Corollary 2.2The optimal net equity and excessive liability are decreasing with respect to α.The corollary follows immediately from the proof of Proposition 2.1.Proposition 2.3The optimal trading amount y* is decreasing with respect to ρ1.Forρ1<ρ¯1,let y* andy¯*be the optimal solutions corresponding to ρ1 andρ¯1,respectively. We want to show thaty*≥y¯*elementwise. By optimality, we havee1i(yi*)−αf1,ρ1i(yi*)≥e1i(y¯i*)−αf1,ρ1i(y¯i*),e1i(y¯i*)−αf1,ρ¯1i(y¯i*)≥e1i(yi*)−αf1,ρ¯1i(yi*)for each asset i. Heree1iandf1,ρiare given in (2.9) and (2.11). We have used the subscript ρ to stress the dependence off1,ρion ρ. Adding the above, we getf1,ρ1i(yi*)+f1,ρ¯1i(y¯i*)≤f1,ρ1i(y¯i*)+f1,ρ¯1i(yi*).Sincef1,ρ1i=l1i−ρ1e1iandf1,ρ¯1i=l1i−ρ1¯e1i,it follows that(ρ1−ρ1¯)(e1i(yi*)−e1i(y¯i*))≥0.Therefore,yi*≥y¯i*according to (2.15).□Intuitively, when the desired leverage ratio is smaller, liquidation of more assets becomes necessary. Proposition 2.3 shows that this is indeed the case from a theoretical perspective. A similar property is derived for the optimal deleveraging problem considered in Brown et al. (2010). But in Brown et al. (2010), linear price impact is assumed and the deleveraging problem is such that the desired leverage ratio must be satisfied.Corollary 2.2 shows the monotonicity of the net equity and excessive liability with respect to the liability aversion parameter α, implying a tradeoff between equity and liability. In this subsection, we construct efficient frontiers to visualize the tradeoff. We start with the following assumption.Assumption 2.4γi<k(k+1)λix0,ik−1,for i = 1, …, m.For the purpose of illustrating efficient frontiers, we impose the above assumption to ensure the strict concavity of the problem (2.8) for all liability-aversion parameters. In this case, there exists a unique optimal trading strategy to (2.8). Although we may not be able to get the optimal solution analytically, we can easily obtain the optimal trading strategy numerically using standard softwares. Assumption 2.4 is only made for Sections 2.3 and 2.4. As for the portfolio deleveraging problem in Section 3, we no longer impose this restriction.For each α, we compute the optimal solution y*(α) and then obtain the optimal net equity e1(y*(α)) and the excessive liability f1(y*(α)) according to (2.5) and (2.6). Consider an asset with γ = 0.6 ($/share)/million shares, λ = 1.4 ($/share)/(million shares/unit of time)k, x0 = 1 million shares, p0 = $40, ρ1 = 11, l0 = $37 million. Let α sweep out the values in [0.021, 0.245]. We construct efficient frontiers for k = 0.25, 0.5, 0.75. See Fig. 1for the generated efficient frontiers.The three curves correspond to the optimal trading strategies under different temporary price impact functions when α varies from 0.021 to 0.245. The vertical axis is the net equity. The horizontal axis is the negative excessive liability. The three marked points on the efficient frontiers correspond to the three optimal trading strategies that end up with zero excessive liability. Each efficient frontier consists of a family of trading strategies that achieve the optimal balance between the equity and the excessive liability. When α increases, the corresponding point on each efficient frontier moves towards the lower right corner. That is, the optimal equity and excessive liability decrease. This was shown in Corollary 2.2 mathematically. We can also see that the efficient frontier shifts upward when k increases in this particular example. This is because the trading amount y is between 0 and 1 (million shares). A larger k thus implies a smaller temporary price impact and hence smaller trading cost.This section studies liquidation priorities among different assets. We find that intrinsic factors (e.g., initial prices, permanent and temporary price impact) of the assets affect the liquidation preference. Liquidation priorities have been studied for the deleveraging problems in Brown et al. (2010) and Chen et al. (2014), where both the permanent and temporary price impact are linear. Here we consider a more general and realistic case: a power temporary price impact function. Under Assumption 2.4, we have the following properties.Proposition 2.5For assets with the same initial holdings and price impact, the one with higher initial price is prioritized for selling, i.e.yi*≤yj*if p0, i≤ p0, j, x0, i= x0, j, γi= γjand λi= λj.Assume to the contrary thatyi*>yj*. We will find a directionΣ∈Rmalong which the liability l1 is strictly decreasing but the equity e1 is strictly increasing. ConsiderΣ∈Rmwith − 1 on ith entry, 1 on jth entry and zero elsewhere. Denote x0 = x0, i= x0, j, γ = γi= γjand λ = λi= λj. From (2.4), we have(2.16)∇l1⊤Σ=p0,i−γyi*−(k+1)λyi*k−p0,j+γyj*+(k+1)λyj*k<0.From (2.5), we get(2.17)∇e1⊤Σ=−γyi*+(k+1)λyi*k+γx0+γyj*−(k+1)λyj*k−γx0=(k+1)λ(yi*k−yj*k)+γ(yj*−yi*)>(k+1)λ(yi*k−yj*k)+λk(k+1)x0k−1(yj*−yi*)=λ(k+1)(yi*k−kx0k−1yi*−(yj*k−kx0k−1yj*))≥0.The first inequality is due to Assumption 2.4, that is,γ<k(k+1)λx0k−1. The last inequality is becauseyk−kx0k−1yis non-decreasing on [0, x0]. Thus, there exists a small enough ε > 0 such that y* + εΣ is a feasible solution with higher equity, lower liability and hence higher e1 + α(ρ1e1 − l1). This contradicts the optimality of y*. Therefore, we must haveyi*≤yj*. This finishes the proof of the proposition.□Proposition 2.5 shows that we prefer to sell assets with higher initial prices when other factors are the same, since it helps generate more cash and reduce the liability more effectively. The following proposition shows that trading priority is given to assets with smaller price impact.Proposition 2.6For assets i and j with the same initial holding and price, the one with smaller price impact is prioritized for selling, i.e.,yi*≥yj*if p0, i= p0, j, x0, i= x0, j, γi≤ γjand λi≤ λj.Assume to the contrary thatyi*<yj*. We find a directionΣ∈Rmalong which the liability is strictly decreasing but the equity is strictly increasing. Let Σ = (Σ1, …Σm), where Σi= 1, Σj= −1 and Σn= 0, n ≠ i, j. According to (2.4), we have∇l1⊤Σ=γiyi*+(k+1)λiyi*k−γjyj*−(k+1)λjyj*k<0,since γj≥ γi, λj≥ λiandyj*>yi*. According to (2.5),(2.18)∇e1⊤Σ=γiyi*−(k+1)λiyi*k−γix0,i−γjyj*+(k+1)λjyj*k+γjx0,j=(γj−γi)x0,i+γiyi*−(k+1)λiyi*k−(γjyj*−(k+1)λjyj*k).Note that, according to Assumption 2.4, γjy − (k + 1)λjykis strictly decreasing with respect to y for y ∈ [0, x0, j]. Therefore,(2.19)∇e1⊤Σ>(γj−γi)x0,i+γiyi*−(k+1)λiyi*k−(γjyi*−(k+1)λjyi*k)=(γj−γi)(x0,i−yi*)+(k+1)(λj−λi)yi*k≥0.As can be seen in the proof of Proposition 2.5, this contradicts the optimality of y*. Therefore, we must haveyi*≥yj*. This finishes the proof of the proposition.□Assets with smaller price impact tend to be more liquid. Proposition 2.6 simply tells that, everything else being equal, more liquid assets are prioritized for selling.In this section, we study the portfolio deleveraging problem with a non-positive excessive liability constraint. That is, we want to deleverage the portfolio until the resulting leverage ratio reaches a predetermined level. The optimal deleveraging problem has been studied in Brown et al. (2010) and Chen et al. (2014), under the assumption of linear price impact functions. In that case, the deleveraging problem reduces to a quadratic program with quadratic and box constraints. In Brown et al. (2010), the quadratic program is convex under the assumption that the temporary price impact is greater than half of the permanent price impact. In Chen et al. (2014), a general non-convex case is studied. A Lagrangian method is proposed to solve the non-convex quadratic program optimally under certain conditions. When such conditions are violated, an approximate solution is obtained and an upper bound on the loss in equity caused by adopting a suboptimal strategy is derived.In this work, with a power temporary price impact function, the resulting optimization problem is a non-convex polynomial program with polynomial and box constraints. We first describe the problem formulation and derive properties regarding the optimal solution. Then we analyze the connections between this optimal deleveraging problem and the deleveraging problem with liability aversion in (2.7). By adapting the Lagrangian method proposed in Chen et al. (2014), we obtain a numerical algorithm for solving the optimization problem. We then estimate the quality of the solution.The optimal deleveraging problem is defined to be(3.1)maxy∈Rme1subjecttoρ1e1≥l1,0≤y≤x0.Here the notations are the same as in Section 2.1. Rewrite the problem explicitly as follows:(3.2)maxy∈Rmy⊤(12Γ)y−y⊤Λyk−x0⊤Γy+e0subjectto(ρ1−1)12y⊤Γy−(ρ1+1)y⊤Λyk+(p0−ρ1Γx0)⊤y+ρ1e0−l0≥0,0≤y≤x0.We assume that (3.2) is strictly feasible and the initial leverage ratio does not meet the requirement (i.e. ρ1e0 < l0). Otherwise, the investor will simply not liquidate since liquidation is costly due to market impact (see (2.15)). We next show in Proposition 3.1 that the excessive liability is exactly zero at the optimal solution. The investor will deleverage to the level that the leverage requirement is just satisfied. This property has also been reported in Brown et al. (2010) and Chen et al. (2014). Proposition 3.1 demonstrates that in the case of nonlinear temporary price impact function, it is still optimal to just deleverage to the desired leverage ratio.Proposition 3.1The leverage constraint of the optimal deleveraging problem (3.2) is active at the optimal solution.Denote the optimal solution by y*. Assume to the contrary that the constraint is not active at the optimal solution. Then the linear independence constraint qualification (LICQ) holds at y*.11LICQ holds if the set of gradients of active constraints is linearly independent.According to the first order optimality condition, there existsμ*=(μ0*,μ1*,…,μm*,μm+1*,…,μ2m*)≥0satisfying the following conditions:(3.3)μ0*(ρ1e1−l1)=0,(3.4)μi*yi*=0,i=1,…,m,(3.5)μm+i*(x0,i−yi*)=0,i=1,…,m,(3.6)∇e1(y*)−μ0*∇f1(y*)+∑i=1m(μi*∇gi(y*)+μm+i*∇gm+i(y*))=0,wheregi(y)=yi,gm+i(y)=x0,i−yi,i=1,…,m.If the leverage constraint is inactive (i.e., ρ1e1 > l1), we haveμ0*=0from (3.3). For i = 1, …, m, Eq. (3.6) can be rewritten as(3.7)γiyi*−(k+1)λiyi*k−γix0,i+μi*−μm+i*=0.For each asset i, it can be seen from (3.4) and (3.5) thatμi*andμm+i*cannot be non-zero simultaneously. Therefore, we only need to consider the following three cases.1.μi*=0,μm+i*≠0: From (3.5), we obtainyi*=x0,i. According to Eq. (3.7), we getμm+i*=−(k+1)λix0,ik<0,contradicting to μ* ≥ 0.μi*=μm+i*=0: By Eq. (3.7), we obtainγi(x0,i−yi*)=−(k+1)λiyi*k. Sinceγi(x0,i−yi*)≥0and−(k+1)λiyi*k≤0,we haveγi(x0,i−yi*)=−(k+1)λiyi*k=0. That is,yi*=x0,iandyi*=0,which itself is a contradiction.μi*≠0,μm+i*=0: From (3.4),yi*should be 0.Summarizing the above, we obtain that y* = 0. But this contradicts the assumption that l0/e0 > ρ1 and deleveraging is required. Therefore, the leveraging constraint must be active. This finishes the proof of the proposition.□In this section, we adapt the Lagrangian method of Chen et al. (2014) to solve the deleveraging problem (3.2) numerically. The liability-aversion parameter α can be treated as a Lagrangian multiplier and the optimization problem (2.7) can be viewed as a Lagrangian problem associated with (3.1). Connections between the optimal solutions to (2.7) and (3.1) are investigated and a Lagrangian algorithm is used to solve (3.1) optimally under certain conditions. When such conditions are not satisfied, we obtain an approximate solution and estimate the loss in the objective value caused by adopting such a suboptimal deleveraging strategy.Since the price impact matrices Λ and Γ are both diagonal, the Lagrangian problem (2.8) can be solved by solving m univariate polynomial optimization programs with box constraints:(3.8)(Pi)maxyi∈R12(1+αρ1−α)γiyi2−(1+αρ1+α)λiyi1+k+[αp0,i−(1+αρ1)γix0,i]yisubjectto0≤yi≤x0,i.Since the case k = 1 has been fully studied in Chen et al. (2014), in the remainder of this paper, we will assume 0 < k < 1. In this case, it can be easily seen that the above program could have multiple solutions (however, it cannot have more than four solutions). For each Lagrangian multiplier α, letf1*(α)be the set of values of f1 at all possible optimal solutions of the Lagrangian problem. It is a set-valued map. We start with the following definition of breakpoint.Definition 3.2α is said to be a breakpoint off1*iff1*(α)has distinct values.f1*has no breakpoint ifγi<k(k+1)λix0,ik−1,for 1 ≤ i ≤ m.Ifγi<k(k+1)λix0,ik−1for each asset i, the Lagrangian problem (2.7) is strictly concave and there exists a unique optimal solution for any α. Hence, no breakpoint exists.Next we present some key properties off1*(α)that are essential for the design of the algorithm.Theorem 3.4f1*(α)is a piecewise continuous non-increasing map.22Here a non-increasing map means thatf1*(α)is a monotone set-valued map: (α1 − α2)(ξ1 − ξ2) ≤ 0,∀ξi∈f1*(αi). For details of set-valued maps, refer to Aubin, Frankowska, and Frankowska (2008).In particular,f1*(0)>0and∃α′>0such thatf1*(α′)<0.The monotonicity off1*can be shown in a similar manner as in Theorem 1 in Chen et al. (2014). Note that in the current paper, f1 = l1 − ρ1e1; while in Chen et al. (2014), the corresponding function is f = ρ1e1 − l1. When α = 0, we maximize e1. Since e1 is strictly decreasing with respect to each yiaccording to (2.15), the optimal solution is y* = 0. Then we havef1*(0)=f1(0)=l0−ρ1e0>0. The remaining of the proof follows similarly as in Theorem 1 in Chen et al. (2014).□Theorem 3.4 implies that there exists a α* such that zero is contained in eitherf1*(α*)or an interval defined by two different values off1*(α*). When0∈f1*(α*),we have the following:Theorem 3.5If there exists α* such that0∈f1*(α*),an optimal solution y(α*) to the Lagrangian problem (2.7) satisfying f1(y(α*)) = 0 is also optimal to (3.1).Refer to Theorem 2 in Chen et al. (2014) for a detailed proof. Theorem 3.5 shows that when there exists a Lagrangian multiplier α* such that0∈f1*(α*),we can obtain the optimal deleveraging strategy by solving the corresponding Lagrangian problem.Before presenting the algorithm, we make the following assumption. For each i = 1, …, m, let Bidenote the set of Lagrangian multipliers α under which (3.8) has multiple optimal solutions.Assumption 3.6For any i ≠ j,Bi⋂Bj=⌀.Assumption 3.6 implies that there is no α such that (3.8) has multiple solutions for two different assets. Any breakpoint is due to multiple solutions of (3.8) for only one i ∈ {1, 2, …, m}.The Lagrangian algorithm aims to find α* and a corresponding y(α*) such that f1(y(α*)) = 0. When such α* and y(α*) exist, y(α*) is an optimal solution of the deleveraging problem (3.1). Otherwise, when there exists α* such that 0 falls in an open interval defined by two values off1*(α*),we construct an approximate solution yLin a similar way as in Chen et al. (2014). Suppose α* is such that the Lagrangian problem (3.8) has multiple solutions for only i (see Assumption 3.6). By Assumption 3.6, all these solutions only differ in their ith entry. For any such solution y(α*), letyjL=yj(α*),j ≠ i.yiLis set to be the smallest zero of f1(yL) as a function ofyiL. Here we use the smallest zero since, according to (2.15), the net equity is decreasing with respect to the trading amount in asset i. The approximate solution constructed in this way obviously is feasible to (3.2). Below is the detailed algorithm. ε > 0 is a small error tolerance level.Algorithm1.Leta=0. Find a large enoughbsuch thatmaxf1*(b)<0(i.e., all values in the setf1*(b)are less than 0).2.Setα=(a+b)/2. Ifmin|f1*(α)|≤ϵ: setyL=y(α)wherey(α)satisfies|f1(y(α))|≤ϵ. Stop.3.Else Ifminf1*(α)<0<maxf1*(α): findithat leads to multiple solutions for (3.8); setyjL=yj(α),j≠i,wherey(α)is any optimal solution of (3.8); setyiLto be the smallest zero off1(yL)as a function ofyiL. Stop.4.Else Ifmaxf1*(α)<−ϵ,setb←(a+b)/2. Go to Step 2.5.Else Ifminf1*(α)>ϵ,seta←(a+b)/2. Go to Step 2.For the case when there is no breakpoint or there exists a breakpoint α* such that0∈f1*(α*),the optimal solution can be obtained with the above algorithm efficiently. Otherwise, a feasible approximate solution is constructed. We estimate the loss in equity caused by using such an approximate solution.Theorem 3.7Suppose α* is a breakpoint off1*that leads to multiple solutions for the problem Pi,0∉f1*(α*)and is included in an open interval defined by two values inf1*(α*). The loss in the net equity caused by adopting a suboptimal strategy yLobtained in the Lagrangian algorithm is bounded byγi2x0,i2+λix0,i1+k.Lety^be an optimal solution for the Lagrangian problem (2.8) such thatf1(y^)>0. Let y* be an optimal solution to (3.1). Since y* is feasible to the Lagrangian problem (2.8), we have(3.9)e1(y*)=e1(y*)−α*f1(y*)≤e1(y^)−α*f1(y^)<e1(y^),where the first equality is due to Proposition 3.1. Then0≤e1(y*)−e1(yL)<e1(y^)−e1(yL).Sincey^and yLdiffer only in the ith entry, we have0≤e1(y*)−e1(yL)<e1i(y^i)−e1i(yiL)≤e1i(0)−e1i(x0,i)=γi2x0,i2+λix0,i1+k.Heree1iwas defined in (2.9) and the last inequality is becausee1iis decreasing (see 2.15).□Consider the case of a linear temporary price impact function (i.e., k = 1). The optimal deleveraging problem is(3.10)maxy∈Rm−y⊤(Λ−12Γ)y−x0⊤Γy+p0⊤x0−l0subjectto−y⊤(ρ1(Λ−12Γ)+Λ+12Γ)y+(p0−ρ1Γx0)⊤y+ρ1p0⊤x0−(ρ1+1)l0≥0,0≤y≤x0.(3.10) is the same as the one studied in Brown et al. (2010) and Chen et al. (2014). As explained in Introduction, permanent impact dominant market may arise (Coval and Stafford, 2007; Holthausen et al., 1990; Schöneborn, 2011). In such a market, we have the following property:Proposition 3.8When ρ1 > 1 andΛ≺ρ1−12(ρ1+1)Γ,there exists at most one asset i such that the optimal solution to (3.10) satisfies0<yi*<x0,i.For any other asset j in the portfolio, j ≠ i, we have eitheryj*=x0,joryj*=0.Denote y* as an optimal solution to (3.10). Assume to the contrary that there exist two assets i and j such that0<yi*<x0,iand0<yj*<x0,j. By the optimality of y*,(yi*,yj*)is an optimal solution to the following optimization problem, which is obtained by fixing ykatyk*,k ≠ i, j, in (3.10):(3.11)max(yi,yj)∈R2g(yi,yj):=A1yi2+B1yi+C1yj2+D1yjsubjecttoc(yi,yj):=A2yi2+B2yi+C2yj2+D2yj+F≥0,0≤yi≤x0,i,0≤yj≤x0,j.Here,A1=12γi−λi>0,A2=12(ρ1−1)γi−(ρ1+1)λi>0,C1=12γj−λj>0,C2=12(ρ1−1)γj−(ρ1+1)λj>0.By Proposition 3.1,c(yi*,yj*)=0.Since0<yi*<x0,iand0<yj*<x0,j,the LICQ holds. Moreover, because the box constraints are non-active, by the KKT conditions, there exists a Lagrangian parameter λ ≥ 0 such that∇g(yi*,yj*)+λ∇c(yi*,yj*)=0.Note thatg(yi,yj)+λc(yi,yj)=(A1+λA2)yi2+(B1+λB2)yi+(C1+λC2)yj2+(D1+λD2)yj+λFhas positive coefficients A1 + λA2 > 0, C1 + λC2 > 0. Since the gradient of g(yi, yj) + λc(yi, yj) at(yi*,yj*)is zero,(yi*,yj*)is the unique global minimum for g(yi, yj) + λc(yi, yj).Note that c(yi, yj) = 0 intersects with the box 0 ≤ yi≤ x0, i, 0 ≤ yj≤ x0, jat an interior point(yi*,yj*). There exists another point(y¯i,y¯j)such thatc(y¯i,y¯j)=0and0≤y¯i≤x0,i,0≤y¯j≤x0,j. Since(yi*,yj*)is the unique global minimum for g(yi, yj) + λc(yi, yj),g(yi*,yj*)+λc(yi*,yj*)=g(yi*,yj*)<g(y¯i,y¯j)+λc(y¯i,y¯j)=g(y¯i,y¯j).We thus have found a point(y¯i,y¯j)that is feasible for (3.11) but with larger objective value. This contradicts the optimality of(yi*,yj*).□Proposition 3.8 indicates that under certain conditions, there can be at most one asset that is partially liquidated when the temporary price impact is linear. The other assets in the portfolio either are completely liquidated or remain intact. Proposition 2 in Chen et al. (2014) shows that more liquid assets are prioritized for selling when initial prices and holdings are the same. Proposition 3.8 then allows one to easily determine the optimal deleveraging strategy in certain cases. More specifically, for a portfolio consisting of m assets with the same initial price and holding, suppose the conditions of Proposition 3.8 are satisfied and the assets can be ordered according to their liquidity as suggested in Proposition 2 in Chen et al. (2014). Consider the following candidate solution: asset i, (1 ≤ i ≤ m), is partially liquidated; all assets that are more liquid than asset i are fully liquidated; all assets that are less liquid remain intact; the amount of asset i to sell is obtained as the smallest non-negative zero of f1 as a function of yi(by Proposition 3.1). There are at most m such feasible solutions. The optimal strategy is obtained as the one that gives the largest objective value.When the temporary price impact is nonlinear, Proposition 3.8 does not generally hold.Example 4.1In this example, we consider the portfolio deleveraging problem (2.8) with x0, i= 1, 1 ≤ i ≤ 6, α = 0.05, l0 = 220. The temporary price impact function is assumed to have a power of k = 0.5. We solve the problem under two different benchmark leverage ratios ρ1 = 10 and ρ1 = 11. The units of the parameters are the same as in Section 2.3. See Table 1for the optimal trading strategies.It can be seen that when the benchmark leverage ratio is larger, the optimal liquidation amount is smaller for each asset. This is consistent with Proposition 2.3. For assets with the same price impact (i.e. assets 1 and 4, assets 2 and 5, assets 3 and 6), the one with higher initial price is prioritized for selling (see Proposition 2.5). Table 1 also illustrates that we prefer to sell assets with smaller price impact when the initial prices and holdings are the same. This can be seen from the optimal trading amounts of assets 1, 2 and 3 when the initial asset prices are all 39 or from the optimal trading amounts of assets 4, 5 and 6 when the initial asset prices are all 40. Such trading priorities are shown in Proposition 2.6.In this example, we consider the optimal deleveraging problem (3.2). We first consider the same portfolio as in Example 4.1 with ρ1 = 11 and l0 = 222. For these assets,γi<k(k+1)λix0,ik−1,1 ≤ i ≤ 6, implying concavity for the associated Lagrangian problems. Solving the problem with the Lagrangian algorithm, we get α* = 0.0545. The corresponding optimal trading amounts are in Table 2. We also consider another portfolio where Assumption 2.4 no longer holds. The parameters are given in Table 3. The Lagrangian algorithm returns α* = 0.0689 and an approximate solution with objective value e1 = 12.7336. The optimal objective value of the corresponding Lagrangian problem is 12.8288, giving an upper bound on the optimal objective value of the deleveraging problem. Thus, the loss in equity due to the suboptimality of the strategy is bounded by 0.0952, which is around 0.63 percent of the initial equity.In this example, we compare the optimal deleveraging strategies obtained under linear and nonlinear temporary price impact respectively. Consider a two-asset portfolio with x0, i= 0.05, p0, i= 2, 1 ≤ i ≤ 2, l0 = 0.185, ρ0 = 12.65. The desired leverage ratio ρ1 = 11. We solve the problem (3.2) under linear (k = 1) and square root (k = 0.5) temporary price impact functions respectively. See Table 4for the optimal liquidation strategies.This is a permanent impact dominant market. Under linear temporary price impact, one asset is partially liquidated and the other remains intact. However, under the square root temporary price impact, both assets are partially liquidated. The numerical result is consistent with Proposition 3.8.

@&#CONCLUSIONS@&#
We study two related optimal deleveraging problems under nonlinear price impact. The temporary price impact is given by a power function. The objective of the first deleveraging problem is to optimally balance equity and liability. We derive analytical properties of the optimal trading policies and construct efficient frontiers to visualize the tradeoff between the net equity and excessive liability. The objective of the second problem is to liquidate to a desired level of the leverage ratio and maximize equity. It is formulated as a non-convex polynomial program with polynomial and box constraints. An efficient Lagrangian algorithm is used to find the global optimal solution numerically under certain conditions. When such conditions are violated, an approximate solution is obtained and an upper bound on the equity loss due to suboptimality is derived.In Brown et al. (2010), a two-period deleveraging problem is studied where there might be a liquidation shock in the second period. The main focus in Brown et al. (2010) is to analyze how the possibility of such a liquidation shock affect the optimal deleveraging strategy. This is a practically important problem, in particular, during difficult economic times when liquidation shocks are much more likely. The resulting optimization problem involves more complex non-convex objective values and constraints. The extension of the current work to a multi-period model is thus interesting but challenging. We leave that for future research.