@&#MAIN-TITLE@&#
Maximum wind power tracking for PMSG chaos systems – ADHDP method

@&#HIGHLIGHTS@&#
Aiming at the chaotic behavior of PMSG under certain parameters, a method based on ADHDP is proposed to track the maximum wind power point, which can make the system out of chaos and track the maximum power point stably, and the optimal control problems of the complex nonlinear system can be solved effectively.Cloud RBF neural network is adopted as the function approximation structure of ADHDP. Cloud model introduces the randomness and fuzziness into new algorithm, at the same time, the new algorithm retains the learning ability and topological relation of RBF neural network.This method is realized by using the optimal power–speed curve and the vector control principle, adjusting the stator output voltage to control the electromagnetic and then the wind turbine rotor speed can be operated at the optimal speed that corresponds to the maximum power point, meanwhile, the measurement of wind speed also can be avoided.

@&#KEYPHRASES@&#
Permanent Magnet Synchronous Generator (PMSG),Chaotic behavior,Maximum wind power,Action Dependent Heuristic Dynamic Programming (ADHDP),

@&#ABSTRACT@&#
Aiming at the chaotic behavior of PMSG under certain parameters, the new ADHDP method based on Cloud RBF neural network is proposed to track the point of maximum wind power, which can make the system out of chaos and track the point of maximum power stably, and the optimal control problems of the complex nonlinear system can be solved effectively. This method is realized by using the optimal power–speed curve and the vector control principle, and by adjusting the stator output voltage to control the electromagnetic torque, then the rotor speed of wind turbine can operate at the optimal speed that corresponds to the point of maximum power, meanwhile, the measure of wind speed also can be avoided. The simulation results show the effectiveness of the proposed method.

@&#INTRODUCTION@&#
Wind power is a kind of clean and renewable natural resource. Under the pressure of energy shortage and ecological environment degradation, wind power generation as a new type of efficient technology has been got a rapid development, and how to improve the utilization of wind energy is the main challenge of wind power generation technology [1,2].In current the main methods of maximum power tracking from the domestic and international methods include: optimal tip speed ratio method, hill climbing method and power curve control method. From the opinion of application, Doubly Fed Induction Generator (DFIG) and Permanent Magnet Synchronous Generator (PMSG) are considered usually [3,4]. Optimal tip speed ratio method is the most direct thought to realize the maximum wind power tracking. When the wind is changing, the tip speed ratio of wind turbine has to be operated at the best value, then the maximum wind power is got. The defect of this method is that wind speed needs to be measured, but it is difficult to be got accurately, which will influence the final accuracy of control [5]; Hill climbing method need not measure the speed of wind, but it needs to detect the power value of stator and rotor, and adjust the speed of generator according to the changed trend of power, so the rotor speed can search the optimal speed automatically. It overcomes the defects depending on system model and prior data, but the method needs more measure devices, the search step is difficult to be determined and the coefficient of variable step is rather complicated to be calculated [6–8]. Power curve control method is widely used because the principle is simple and it also does not need to measure the speed of wind. According to the relation curve between wind power and rotor speed, the speed of rotor is made to operate at the point of optimal power [9,10].In the maximum wind power tracking methods that have been mentioned above, the wind power generation systems are often treated as linear time-invariant system. In this paper, considered the nonlinear time-variant essence of wind power generation, the method based on Action Dependent Heuristic Dynamic Programming (ADHDP) is proposed to realize the maximum wind power point tracking. ADHDP is the approximate realization of dynamitic programming and approaches the true solution of dynamitic programming by iteration, so the optimal control of nonlinear system is approached gradually [11–14]. The basic idea of this method is that the function approximation structures are used to approach the performance index function and control strategy, the target is to satisfy the optimal principle and then the optimal control and the optimal performance index are attained, and the optimal control problem of complex nonlinear can be solved effectively. PMSG system will appear with chaotic motion under certain conditions [15–18]. The ADHDP controller is designed based on the optimal torque–speed curve and vector control technology, RBF neural network is adopted as the function approximation structure, and electromagnetic torque control is realized by adjusting the stator voltage which makes the system out of chaos and operates at the point of maximum power. The simulation results show that the optimal torque tracking can be realized and the maximum wind power is captured without the detection of the wind speed.According to the Betz theory in aerodynamics, the input power of the wind turbine can be defined as follows:(1)Pm=0.5ρv3πR2Cp(λ,β)where ρ is the air density; v is the actual wind speed; R is the radius of wind turbine; Cp(·) is the utilization coefficient of wind energy,λ=ωrR/vis the optimal tip speed ratio, ωris the angular velocity of rotor, β is the pitch angle of wind turbine.SinceTm=Pm/ωr, then the output mechanical torque of the wind turbine is(2)Tm=0.5ρv2πR3Cp(λ,β)λAccording to formulas (1) and (2), the maximum power tracking curve and the optimal torque curve of wind turbine under the conditions of variable wind speed and fixed pitch are shown in Fig. 1.As can be seen from Fig. 1, the output power value is different under the same wind speed but different rotor speed, the rotor speed should be adjusted when the wind speed is changing and then the optimal power point can be tracked. In (a) the dotted line corresponds to the maximum power curve under the condition of variable wind speed, (b) is the mechanical torque curve that corresponds to the optimal wind power.The stator voltage equation of PMSG in d–q axis synchronous rotating coordinate is(3)ud=−Rsid−Lddiddt+Lqωsiquq=−Rsiq−Lqdiqdt−Ldωsid+ωsψpThe motion equation of PMSG is(4)Jdωmdt=Tm−Te−BωmThe electromagnetic torque equation of PMSG is(5)Te=32npψpiq+(Ld−Lq)idiqwhere ud, uq, id, iqis the stator voltage and current of generator; Rs, Ld, Lqis the resistor and inductor respectively; ωs=npωmis the electrical angular frequency, npis the generator pole pairs, ωmis the rotor speed; ψpis the permanent magnetic flux; Teis electromagnetic torque, Tmis mechanical torque; J is the movement inertia of rotor; B is viscous damping coefficient.Since the wind speed is difficult to be measured accurately in actual operation, the method based on optimal curve between torque and speed is adopted to control rotor speed indirectly, so the wind speed measurement can be avoided.The converter in stator side of PMSG adopts the control strategyid*=0, namely the current in d axis keeps to zero, so the electromagnetic torque in formula (5) is(6)Te=32npψpiqAs can be seen from formula (6), the rotor speed can be controlled if iqis determined. For a given torque reference valueTe*, the reference value iqis(7)iq*=2Te*3npψpWithout wind speed detection, the rotor speed of wind turbine or generator speed need to be measured, according to Fig. 1, the optimal torqueTe*should be searched out corresponding to the rotor speed, and then the current reference valueiq*can be calculated in accordance with formula (7). The actual current can track the reference current by adjusting the stator voltage, so the rotor speed can operate at the optimal speed corresponding to the point of maximum power.Considering the uniform distribution of air gap for PMSG, set Ld=Lq=L, according to formula (4)–(6), the whole mathematical model of PMSG system is(8)diddt=−RsLid+ωiqs−1Luddiqdt=−RsLiq−ωsid+ψLωs−1Luqdωmdt=TmJ−1Jnpψpiq−BJωmFormula (8) can be transformed by time scale transformation and linear affine transformation. Considering the situation to track the stator current, sett˜=t/τ,i˜d=(id−id*)/k,i˜q=(iq−iq*)/k,ω˜s=τωs,τ=L/Rs,k=Be/npτψp, B=npBe, then(9)i˜˙d=−i˜d+i˜qω˜s+ω˜sβiq*−βid*−u˜di˜˙q=−i˜˙q−i˜dω˜s−ω˜sβid*+ω˜sβη−u˜qω˜s=−σ(i˜q+ω˜s)−σβiq*+T˜mwhereβ=1/k,η=ψp/L,σ=npBeτ/J,u˜d=ud/Rsk,u˜q=uq/Rsk,T˜m=τ2npTm/J. The chaotic mathematical model of PMSG is very similar to the classic Lorenz equation, so set σ=5.456, β=3.621, η=−6.906,T˜m=u˜d=u˜q=0,id*=iq*=0. The chaotic motion phenomenon of PMSG is displayed in Fig. 2.ADHDP is a kind of iterative program calculation method to solve the optimal control problem for the discrete system, so formula (9) has to be discretized by Euler method as follows [19]:(10)i˜d(k+1)=[i˜d(k)+i˜q(k)ω˜s(k)+βω˜s(k)iq*−βid*−u˜dk]T+i˜dki˜q(k+1)=[i˜q(k)−i˜d(k)ω˜s(k)−ω˜s(k)βid*+ω˜s(k)βη−u˜q(k)]T+i˜q(k)ω˜s(k+1)=[−σ(i˜d(k)+i˜q(k))−σβiq*+T˜m]T+ω˜s(k)where T is the sample period; k is the sample steps.According to the ADHDP principles [11], the performance index function for formula (10) can be defined as follows:(11)J(k)=∑i=1∞γi−kU(k)where U(k) is utility function, γ(0<γ<1) is discount factor.According to Behrman optimization principle, the optimal control principle should be satisfied as follows:(12)J∗(k)=min(u˜d(k),u˜q(k)){U(k)+γJ∗(k+1)}ADHDP controller structure is designed as in Fig. 3, it is composed of execution network and evaluation network, the artificial neural network is adopted as the function approximation structure.The input variables of execution network are composed ofi˜d(k),i˜q(k)andω˜s, letxa(k)=i˜d(k),i˜q(k),ω˜s(k), output variables are composed ofu˜d(k)andu˜q(k), letu(k)=u˜d(k),u˜q(k), and the training goal is minimizingJˆ(k)by using control vectoru(k). The input variables of evaluation network are composed ofxa(k) andu(k), output variable is the performance index functionJˆ(k), and the training goal is minimizing Ecby using the formulaEc=1/2∑kJ(k)−U(k+1)−γJ(k+1)2. The object controlled is a discrete nonlinear system which is expressed by formula (10) and by which the next state variablexa(k+1) can be generated. In Fig. 3, the dotted line represents the back propagation path of updating weight value for execution network and evaluation network.If U is a set constituted with precise numbers, X⊆U, TQis a qualitative concept that relates to U, the correlation degree between single variable x(x∈X) and qualitative concept TQcan be expressed with a random number, but the random number has the certain tendency, which is defined asCr(x)∈0,1, then the mapping relation of concept TQfrom set U to digital range [0,1] is called cloud, that is(13)Cr(x):U→[0,1]∀x∈X(X⊆U)x→Cr(x)Cloud model contains 3 numerical characteristics – (Ex,En,He), which is used to reflect the quantitative characteristics of qualitative concept TQ.Ex is the expected value in the space of number field representing the qualitative concept, and reflecting the center of gravity of all cloud drops.En is used to measure the uncertainty degree of qualitative concept TQ, it is decided by the randomness and fuzziness of qualitative concept TQ. The bigger it is, the more macroscopically the qualitative concept is. On one side, it reflects the discrete degree of TQ, on the other side, it reflects the independence and relatedness degree of TQand decides the value range of all the cloud drops accepted by qualitative concept TQ.He is used to measure the uncertainty degree of En, it is also decided by the randomness and fuzziness of qualitative concept TQ.The 3 numerical characteristics of cloud model get the randomness and fuzziness of qualitative concept together and form the mapping relation between qualitative concept and quantitative concept. Normal cloud model is the basic cloud model, it is built on the universality of normal distribution function and its expected value is the cloud drop distributing on the cloud expectation curve.Cloud expectation curve based on the normal distribution is(14)Cr(x)=exp−(x−Ex)22(En)2Algorithm 1One-dimension(1)Initialize (Ex,En,He);Generate a normal distributed random number x with expectation value Ex and variance En;Generate a normal distributed random number μ with expectation value En and variance He;Cr(x)=−exp−(x−Ex)2/2μ2;x is a cloud drop with the certainty degree Cr(x);Repeat steps (2)–(5) until generate z cloud drops.Let Ex=10, En=2, He=0.2, z=500, normal distributed curve of cloud model is shown in Fig. 4.Algorithm 2m-dimension(1)Generate m dimension normal distributed random vectorx=x1,x2,…,xmwith expectation value (Ex1, Ex2, …, Exm) and variance (En1, En2, …, Enm);Generate m dimension normal distributed random vectorx=x1,x2,…,xmwith expectation value (En1, En2, …, Enm) and varianceμ=μ1,μ2,…,μm;n dimension normal distribution expectation value isCloud RBF neural network is combing cloud model with RBF neural network. Cloud model introduces the randomness and fuzziness into new algorithm, at the same time, the new algorithm retains the learning ability and topological relation of RBF neural network. Cloud model can determine the basic parameters of primary function of RBF neural network.The number of hidden layer unit can be determined by the uncertainty reasoning principle based on cloud model. The uncertainty reasoning principle is built on the uncertainty of the input space and it is realized on the basis of taking fully uncertainty into account and intelligent decision theory. Cloud RBF neural network with m dimension input variables is a condition generator, let each input variable generates a group of normal random numbers, they are unequal with each other, but tend to a stable distribution, and take the expected value as one output value of hidden layer.For input vectorx=x1,x2,…,xm, the 3m numerical characteristics is(Ex1,En1,He1;Ex2,En2,He2,…,Exm,Enm,Hem)Each variable xi(1≤i≤m) generates q normal random number (xi1, xi2, …, xiq), xiis the expected value of each normal random number xij(1≤j≤q), then the normal random numbers generated by vector x constitute matrix X,X=x11x12…x1qx21x22…x2q⋮⋱xm1xm2…xmqTake each column of X as the input vector of Cloud RBF neural network, the numbers of hidden layer are q, the mapping relation from input layer to hidden layer is(16)Crj(x)=exp−12∑i=1m(xij−Exij)2μij2(0≤j≤q)where μijis normal random number of the jth hidden layer, which is generated by each xi.The mapping relation from hidden layer to output layer is linear mapping,(17)yi=∑j=1kωijCrj(x)(1≤i≤n)where ωijis the weight value connecting the ith output with the jth hidden layer.The basic structure of evaluation network is shown in Fig. 5, the numbers of input layer are 5, the numbers of hidden layer are 8, their mapping functions are cloud activity functions, and in the output layer linear mapping is adopted and the output is the evaluation for performance index functionJˆ(k).The input vector of evaluation network isxc(k)=[i˜d(k),i˜q(k),ω˜s(k),u˜d(k),u˜q(k)], the output value is(18)J(k)=∑j=18ωcjCrj(xc(k))where ωcjis the weight value connecting with the jth hidden layer.The target function of evaluation network is to minimize Ec:(19)Ec=∑kEc(k)=12∑kJ(k)−U(k+1)−γJ(k+1)2U(k) is the utility function, it is a very important index for the ADHDP controller to be designed, because it reflects the control effect of each iteration and its definition should satisfy the various requirements of controlled object. In this paper, the object is to track the reference currentid*andiq*by adjusting the voltage ud(k) and uq(k), so U(k) can be defined as follows:(20)U(k)=i˜d(k)i˜q(k)Pi˜d(k)i˜q(k)+u˜du˜qQu˜d(k)u˜q(k)wherePandQare 2 dimension matrix.The weight values of the evaluation network are updated based on the adaptation rule of gradient descent:(21)ωcj(t+1)=ωcj(t)−αc∂Ec(k)∂ωcj(t)where αc(0<αc<1) is learning rate; t is the iteration number of weight value updated.The basic structure of execution network is shown in Fig. 6, the numbers of input layer are 3, the numbers of hidden layer are 6, their mapping functions are cloud activity functions, and in the output layer linear mapping is adopted and the output is stator voltageu(k).Set the output vector of execution network asu(k)=u˜d(k),u˜q(k)=u˜1(k),u˜2(k), then(22)ui(k)=∑j=16ωai,jCrj(xa(k))(i=1,2;j=1,2,…,6)where ωai,jis weight value connecting the ith output with the jth hidden layer.The target function of execution network is to minimize Ea:(23)Ea=∑kEa(k)=12∑kJ2(k)The weight values of the execution network are updated as follows:(24)ωai,j(t+1)=ωai,j(t)−βa∂Ea(k)∂ωai,j(t)where βa(0<βa<1) is learning rate; t is the iteration number of updated weight value.The various physical parameters of PMSG are Rs=0.6017Ω, Ld=Lq=0.085H, ψ=0.9Wb, B=1, np=10, J=0.06kgm2. Since the PMSG system is considered in chaotic state and the mathematical model as formula (10) is adopted, set σ=5.456, β=3.621, η=−6.906. αc=0.4, βa=0.6, γ=0.9, T=0.1s,P=Q=I.The maximum power point tracking without wind speed detection is accomplished by measuring the PMSG rotor speed indirectly. The optimal torque–speed curve is got from Fig. 1 and the reference current is got from formula (7), the maximum wind power tracking is realized by ADHDP controller. According to the analysis of the simulation process mentioned above, the reference current areid*=0A,iq*=6.6A. In this paper only the control results of ADHDP controller with Cloud RBF and RBF activity function are tested. At the beginning of the simulation, the control variablesu˜d=u˜q=0, after 20s, the control variables is added to PMSG system, and the simulation results of rotor speed tracking based on ADHDP controller with Cloud RBF and RBF activity function are shown in Fig. 7.As can be seen from Fig. 7, PMSG system is in a chaotic state if the control variable is not added. After 20s, the system is out of chaos and attains the stable state. When the actual current tracks the given value, the rotor speed attains the optimal speed corresponding to the point of maximum powerω˜s=2.83. It can be seen that the result with Cloud RBF activity function is better than the result with RBF activity function.Considering the situation that the physical parameters of PMSG are uncertain, let σ=5.800, β=4.621, η=−6.106, and the simulation results are shown in Fig. 8.As can be seen from Fig. 8, ADHDP controller is an optimal controller with the adaptive ability. When there is a little change of the PMSG parameters, ADHDP controller can attain the target state quickly depending on its adaptive ability and still keeps a good control effect. It also can be seen that the result with Cloud RBF activity function is better than the result with RBF activity function.

@&#CONCLUSIONS@&#
PMSG system appears chaotic phenomenon under certain parameters, in this conditions, PMSG is a complex nonlinear system, in which the rotor speed is changing. In this paper, a nonlinear control method is proposed to solve this problem. The maximum wind power tracking and the ADHDP principle based on Cloud RBF neural network are used to design an optimal controller which can make the system out of chaos and track the point of maximum power. The nonlinear function fitting method is adopted in ADHDP to approach the dynamic programming performance index function, by which the optimal control problems of the complex nonlinear system can be solved effectively. Simulation results show that the method can control the rotor speed effectively and realize the maximum wind power tracking. When the system parameters have little changes, ADHDP can make the rotor speed track the optimal speed quickly depending on its adaptive ability.