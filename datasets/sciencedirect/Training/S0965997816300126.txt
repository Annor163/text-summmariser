@&#MAIN-TITLE@&#
Flow simulation and visualization in a three-dimensional shipping information system

@&#HIGHLIGHTS@&#
We studied the flow visualization module in a 3D shipping information system.The surface-based flow visualization and 3D geographical environment were integrated.2D hydrodynamic model was used to simulate flow conditions with current inflow.Real-time flow conditions and ship attributes were considered for safe navigation.The system can provide early warnings based on GPS and inland navigational standards.

@&#KEYPHRASES@&#
Flow visualization,Shipping information system,3D geographical environment,Information integration,Real-time flow conditions,Navigational safety,

@&#ABSTRACT@&#
We develop a three-dimensional (3D) shipping information system as a case study for the integration of a dynamic flow field and a 3D virtual geographical environment. A 2D hydrodynamic model is formulated to calculate the waterway depth and velocity distribution by using real-time hydrologic monitoring data. The parallel OpenMP computations take 4min on a 20-core computer. The image-based flow visualization method is used to produce a 2D dynamic flow field on a curved surface, and the integration of dynamic flow fields with a 3D virtual geographical environment was achieved with the OpenSceneGraph rendering engine. Compared with a traditional 2D navigation map, the combination of a flow simulation and a visualization module can integrate flow velocity magnitude and distribution, and enhance ship navigation safety. This functionality will aid the display of integrated scientific information, and will have potential applications within 3D information systems in many domains.

@&#INTRODUCTION@&#
Shipping safety refers to the safety of life and of property, which are closely related, and is a priority of inland river navigation. In recent years, increasing water traffic density and extreme weather have led to many transportation accidents. For example, the ship “Oriental Star” sunk in the Jianli waterway in the middle reaches of the Yangtze River on June 1, 2015 because of bad weather; 442 persons died and there were many casualties. Further study of shipping navigation technologies is wanted to improve shipping safety.Shipping navigation research focuses on navigational flow conditions and the Inland Electronic Navigational Chart (IENC). As regards the navigational flow conditions, water-level data collected from hydrological stations along the river are used to provide a navigable water-depth-contour surface, which is constructed by linear interpolation of said data in combination with that of the waterway terrain. The use of linear interpolation in calculating the water level, although computationally efficient, reduces the accuracy of the calculation, resulting in low-resolution spatiotemporal information of the waterway depth. Furthermore, water depth is only one of the factors that affect navigation; the characteristics of the flow, such as the velocity and the presence of cross flow and vortices, also affect navigational safety and efficiency [1–3]. Notwithstanding, current shipping information systems lack a velocity distribution display—ship helmsmen navigate with water depth and beacon information only, and beacons cannot be updated in real time to resolve flow transients. Recent studies on navigational flow simulation have focused on waterway regulation engineering [4,5], but have not provided real-time distributions of water depth and flow velocity for navigation.Current IENC research is mainly focused on the two-dimensional (2D) IENC system, the development and application technology of which are relatively mature. The 2D IENC is a map generalization based on abstract symbols that represent the waterway environment. It accurately describes various waterway elements and presents them as 2D maps on a graphical interface and is used in navigation, monitoring and management [6], Fig. 1shows a common IENC. Pecar-Ilic and Ruzic used a 2D IENC for the management of the Danube waterway data in Croatia [7]. Nilsson et al. presented a simulation study with empirical data of an advanced decision-support system for ship navigation using IENC [8], and Porathe et al. discussed how to avoid ship collision accident based on IENC system [9]. With the development of three-dimensional (3D) visualization technologies, 3D IENCs have also been introduced for inland navigation, which embed more detailed spatial waterway information [10]. Peng et al. applied 3D simulation technology to Navigation-Aid Management [11]. In a study of marine navigation, Gao and Shiotani used an Automatic Identification System and a 3D Geographic Information System (GIS) to present navigational information for the prevention of maritime disasters [12]. Compared with its 2D counterpart, the 3D IENC comprises a virtual 3D waterway environment. Despite the wide application of these IENC systems, there are limitations with the current IENC. One of the limitations is that it lacks information on real-time flow conditions, such as velocity distribution, only water-depth-contour is supplied in current system (see Fig. 1).Flow visualization has become an important area of research in fluid dynamics since the widespread access to 3D solvers. It encompasses a range of techniques, such as direct-, feature-, texture- and geometry-based representations [13]. Each technique has a particular computational complexity [14]. With the development of computational fluid dynamics (CFD) and of the power of computing hardware, the demand for visualization solutions has grown rapidly across a variety of applications, such as product design evaluation, flood control, and the analysis of water pollution diffusion [15–18]. Such visualization software requires the functionality to extract flow features and, increasingly, the need to integrate it within a 3D environment to improve decision making [19–21]. For instance, in a virtual wind tunnel application [22,23], the authors not only used a flow visualization module to show flow conditions, they also used a 3D airplane model to determine the spatial position of the flow. How to integrate flow visualization with a 3D environment efficiently is of great interest to users when depicting a comprehensive overview of simulation datasets [17].The main objective of this paper is to show how to integrate a 2D hydrodynamic model and a surface-based flow visualization into a 3D geospatial visualization system to provide a real-time distribution of the water depth and flow velocity for navigational and early warning purposes. We describe the implementation and function of the flow simulation and visualization module. The surface flow field is extracted via a texture-based flow visualization method and demonstrated in a 3D geographical environment. We also discuss the key technologies, functions and application of the flow simulation and visualization module.The Yangtze River is the longest river in China. It has a complex navigational environment and a large volume of shipping. To ensure shipping safety and to improve the efficiency of navigation, a Yangtze River shipping information system was developed from 3D visualization and flow simulation technologies. The Yangtze River shipping information system is a virtual global geographic environment that includes a database, 3D environment visualization, data monitoring, river flow calculation, flow visualization, and early warning modules. An overview of the system is shown in Fig. 2. The data monitoring module works with two types of information: ship position data and hydrologic data (e.g., river discharge and water level). The database stores the monitored data, the 3D geospatial data (e.g., terrain, bridges, ports, beacons) and corresponding attribute information, and the output from the river flow calculation module. The 3D environment visualization module reads the spatial data from the database and builds a 3D virtual environment, which includes information such as the waterway, ships, buildings, and beacons. The river flow calculation module is used to calculate the water depth and flow field from the current river discharge data. To compute quick enough to make early shipping warnings, the river flow calculations were made with a 2D hydrodynamic model, which uses an irregular quadrilateral grid to discretize the simulation area and solves the shallow water equations using the finite volume method, yielding the water depth and flow velocity information at each grid node [24]. The early warning module is used to determine the seaworthiness of a ship from its physical properties, the waterway flow conditions and the shipping regulations [25]. The flow visualization module renders the real-time water surface and flow field in the 3D virtual environment from the results of the flow calculation module, and displays the flow conditions for seaworthiness provided by the early warning module to aid shipping navigation.The flow visualization module requires several specific functions. First, the features of the flow field, such as velocity magnitude and direction, water depth, vortices and circumfluence, should be displayed in an intuitive way. Second, the computation of the flow visualization should be efficient enough to be integrated with that of the 3D virtual environment. For the computational demands of the present application, contour map was used to show the water depth and seaworthy area, and the image based flow visualization (IBFV) method [26] was chosen to implement the dynamic flow field display.The software was implemented in C++ and Qt. OpenSceneGraph (OSG) and osgEarth (www.osgearth.org) were used as the rendering engines to process the 3D data.

@&#CONCLUSIONS@&#
