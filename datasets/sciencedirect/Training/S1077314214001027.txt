@&#MAIN-TITLE@&#
Fully automatic segmentation of AP pelvis X-rays via random forest regression with efficient feature selection and hierarchical sparse shape composition

@&#HIGHLIGHTS@&#
A fully automatic approach for landmark detection and shape segmentation.The random forest regression framework with the sparse shape composition model.Effective feature selection that reduces dimension without sacrificing the accuracy.

@&#KEYPHRASES@&#
X-ray radiograph,Landmark detection,Shape segmentation,Feature selection,Statistical shape model,

@&#ABSTRACT@&#
In clinical practice, traditional X-ray radiography is widely used, and knowledge of landmarks and contours in anteroposterior (AP) pelvis X-rays is invaluable for computer aided diagnosis, hip surgery planning and image-guided interventions. This paper presents a fully automatic approach for landmark detection and shape segmentation of both pelvis and femur in conventional AP X-ray images. Our approach is based on the framework of landmark detection via Random Forest (RF) regression and shape regularization via hierarchical sparse shape composition. We propose a visual feature FL-HoG (Flexible-Level Histogram of Oriented Gradients) and a feature selection algorithm based on trace radio optimization to improve the robustness and the efficacy of RF-based landmark detection. The landmark detection result is then used in a hierarchical sparse shape composition framework for shape regularization. Finally, the extracted shape contour is fine-tuned by a post-processing step based on low level image features. The experimental results demonstrate that our feature selection algorithm reduces the feature dimension in a factor of 40 and improves both training and test efficiency. Further experiments conducted on 436 clinical AP pelvis X-rays show that our approach achieves an average point-to-curve error around 1.2mm for femur and 1.9mm for pelvis.

@&#INTRODUCTION@&#
In clinical practice, X-ray radiography is widely used for various purposes due to its convenience and low cost. Detecting landmarks and segmenting shape contours such as femur and pelvis benefit many applications, such as computer aided diagnosis disease diagnosis [1,2], image based surgery planning and intervention [3]. In addition, three dimensional (3D) reconstruction of anatomical models can also be performed with the help of the segmented 2D contours [4,5]. Recently, we have developed a method that can reconstruct a patient-specific 3D model from a single conventional X-ray radiograph [6]. However, in [6], image contours are extracted semi-automatically with a live-wire method. A fully automatic image contour extraction will facilitate the clinical usage of this method.Traditionally, landmark detection and shape segmentation in X-ray images, despite its extreme usefulness, is seldom done in clinical practice due to its difficulty. In cases where it is ever done, it is carried out manually by clinical doctors, making the work both time-consuming and error-prone. Therefore, in this paper we explore fully-automatic techniques, which will immediately make this traditionally useful but difficult task widely applicable. However, automatic landmarking and segmentation of X-ray images faces many challenges. The poor image contrast, along with the noise, makes the landmark detection very difficult. Due to the accumulation nature of X-ray imaging, multiple bone structures at different depth might be superimposed together on the image and it may be hard to distinguish bones from each other. Furthermore, the existence of implants, which is very common in AP pelvis radiography, often drastically changes the visual appearance of the relevant anatomical regions.In literature, the tasks of landmark detection and shape segmentation in X-ray images are closely related [2,7]. Usually, a set of landmarks are defined along the shape contour, and landmark detection is the first step of the pipeline, where the position of these landmarks are predicted. Then, the detected landmark positions are regularized using a statistical shape model [2,7]. In this way, the final contour is controlled by both the image cue encoded in the landmark detection output, and the shape prior information conveyed in the statistical shape model. In this paper we also take this strategy.In this paper, we propose a new fully automatic method for femur and pelvis segmentation in anteroposterior (AP) X-ray images. Our method consists of two key components: landmark detection with random forest regression, and shape regularization with hierarchical sparse shape composition. Specifically, the contributions of this paper include:1.We propose a hierarchical landmark detection framework where we use global landmarks for image normalization and local landmarks for shape optimization. The hierarchical strategy has been used in other works [8,9], and we adapt it to our AP segmentation application.We propose a visual feature FL-HoG (Flexible-Level HoG) for efficient landmark detections. Zhu et al. [10] used a similar strategy in defining HoG feature with variable-size blocks. They employed the Adaboost algorithm for the subsequent feature selection, while we employ a feature selection algorithm proposed in [11] to reduce the feature searching space. In this way we speed up the feature extraction and subsequent computations.We exploit the recently proposed sparse shape composition model [12] combined with the RF based landmark detection approach.To further increase the accuracy, we employ a post-processing strategy on the pre-segmented shape contour by considering the low-level image feature.In the following, we first summarize related work in Section 2. we then give an overview of our method in Section 3. Our landmark detection algorithm is presented in Section 4, followed by the shape optimization algorithm in Section 5. We show our experimental results in Section 6 and conclude the paper in Section 7.

@&#CONCLUSIONS@&#
We have proposed a new fully-automatic method for left femur and pelvis segmentation in conventional AP X-ray images. Our method features a hierarchical segmentation framework, a new visual feature, an efficient and effective feature selection algorithm, and the shape model based on sparse representation. Experiments show that our method achieves good results, and that the different contributions (feature selection, shape model) indeed improve the performance. Although we demonstrate our method using the left femur and left pelvis, our method can be readily extended to the right side. In the future, we are also interested in extending our method into 3D data.