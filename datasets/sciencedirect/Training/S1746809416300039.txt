@&#MAIN-TITLE@&#
Use of basis functions within a non-linear autoregressive model of pulmonary mechanics

@&#HIGHLIGHTS@&#
A non-linear autoregressive (NARX) model of pulmonary mechanics was defined.The NARX model captured pulmonary distension characteristics in ARDS patients.The model could also capture recruitment characteristics via a dynamic elastance term.The NARX approach is easily applicable and could benefit respiratory therapy.

@&#KEYPHRASES@&#
Pulmonary modelling,Pulmonary elastance,Non-linear modelling,Autoregressive modelling,

@&#ABSTRACT@&#
Patients suffering from acute respiratory distress syndrome (ARDS) require mechanical ventilation (MV) for breathing support. A lung model that captures patient specific behaviour can allow clinicians to optimise each patient's ventilator settings, and reduce the incidence of ventilator induced lung injury (VILI). This study develops a nonlinear autoregressive model (NARX), incorporating pressure dependent basis functions and time dependent resistance coefficients. The goal was to capture nonlinear lung mechanics, with an easily identifiable model, more accurately than the first order model (FOM). Model coefficients were identified for 27 ARDS patient data sets including nonlinear, clinically useful inspiratory pauses.The model successfully described all parts of the airway pressure curve for 25 data sets. Coefficients that captured airway resistance effects enabled end-inspiratory and expiratory relaxation to be accurately described. Basis function coefficients were also able to describe an elastance curve across different PEEP levels without refitting, providing a more useful patient-specific model. The model thus has potential to allow clinicians to predict the effects of changes in ventilator PEEP levels on airway pressure, and thus determine optimal patient specific PEEP with less need for clinical input or testing.

@&#INTRODUCTION@&#
Acute respiratory distress syndrome (ARDS) patients in the intensive care unit (ICU) require mechanical ventilation (MV) for breathing support [1,2]. ARDS generally involves the lungs becoming inflamed and filled with fluid, and results in increased pulmonary elastance [3]. ARDS is a diverse condition, the impact of which varies across patients. Hence, every patient requires differing optimal ventilator settings that may change over the course of treatment [4,5].A key setting for mechanical ventilation is the positive end expiratory pressure (PEEP) [6]. High tidal pressure can increase oxygen perfusion, but a PEEP that is too high can over-distend and damage healthy alveoli, causing ventilator induced lung injury (VILI) [7,8]. A release of biological mediators when the lung is injured in this way can lead to subsequent organ failure, and is one reason for the high mortality of ARDS patients of up to 60% [8]. A PEEP level that is too low can result in insufficient oxygenation, and cyclic opening and closing of alveoli with each breath (atelectrauma) that also damages healthy alveoli [9]. Hence, setting PEEP is a balancing act between these negative outcomes.A lung model that captures patient specific lung mechanics and behaviour could enable clinicians to optimise ventilator settings, to reduce the incidence of VILI, and help to reduce patient morbidity and mortality [10]. However, for a model to be successfully applied in a clinical setting, it should not require significant additional measurements, equipment, or interventions beyond current care.There have been a number of models developed to capture pulmonary mechanics. The first order model (FOM), or single compartment model, describes airway pressure as a series combination of a constant resistance and constant elastance component [11]. The viscoelastic model consists of the FOM with an additional parallel circuit of a resistance and an intra-pulmonary elastance [12]. The expiratory time constant model [13] uses expiration data to determine a parameter that is directly proportional to passive respiratory system elastance. Hickling's alveolar recruitment model [14] describes the lung as a collection of lung units, divided into horizontal compartments, where lower compartments experience higher superimposed pressure due to the weight of the lung. The opening and closing of alveoli in this model are assumed to be governed by a normally distributed threshold opening pressure (TOP) and threshold closing pressure (TCP). The minimal model [15] uses Hickling's description to capture recruitment, but with a modified recruitment concept. The alveolar distension model [16] describes the pressure–volume relationship of lung tissue using an exponential function. The pressure dependent recruitment model (PRM) [17] combines the alveolar distension and alveolar recruitment models, yielding a pressure dependent compliance function embedded in the structure of the FOM. The polynomial method, described by Bates [18], was used to fit exponential volume decays in expiration. A model proposed by Hantos et al. describes pressure as the sum of polynomial functions of volume, flow, and volume acceleration [19]. Hence, there is a wide range of physiologically and clinically relevant models.However, there remains significant debate about the best model that fits all modes of ventilation. The simpler models, such as the FOM and viscoelastic model, are limited in their abilities to describe all respiratory mechanics. They have not been able to describe consistent values for recruitment, distension, and elastance that can be interpolated across PEEP steps. In particular, many models assume respiratory resistance is constant. This may be unreasonable as variable resistance within one breathing cycle has been shown to occur in a high proportion of ARDS patients [20]. More complex models have issues with identifiability [21,22] so they cannot be made patient-specific. Ambiguity in parameter values ultimately leads to a lower confidence in the ability of a model to predict patient responses to changes in therapy, and thus lower confidence in its use for decision support.This research introduces a nonlinear auto-regressive correlation (NARX) model of pulmonary mechanics. Autoregressive models can define the input–output relationships of systems, and are capable of prediction based on previous inputs [23,24]. In pulmonary mechanics, the inputs to the model are the airway flow rate, inspired volume, and PEEP. The single output of the system is the airway pressure. The overall goal of this research was to capture all potential features of the airway pressure curve across multiple increasing PEEP steps, thus fitting to data that includes alveolar recruitment and distension, while also capturing a varying elastance, and to do so with an easily identifiable model. The success of the NARX model could provide new capabilities in patient assessment and decision support.A clinical study was conducted from 2000 to 2002 in the ICUs of eight German hospitals [25]. Measurements were taken from 28 ARDS patients, aged 17 to 77 years. The cause of ARDS varied among patients, and included pneumonia, lung contusion, and brain injury. Patients were on mechanical ventilation for varying lengths of time, with the minimum being two days. Therefore a wide range of patient conditions were captured. Patients were ventilated in the supine position, and sedatives were titrated to achieve a Ramsay sedation score of 4–5 and neuromuscular blocking drugs were administered as needed. Therefore, patient breathing efforts did not occur. The protocol was approved by the local ethics committee of each participating institution, and informed consent was obtained from the patient or his or her legally authorised representative. Full details are available in Stahl et al. [25].Patients were ventilated with Evita4Lab systems to enable respiratory manoeuvres and data acquisition. Gas flow was measured with a calibrated Fleisch No. 2 pneumotachograph connected to a differential pressure transducer. A heat-moisture exchanger was placed between the tube connector and the pneumotachograph to prevent moisture from affecting the flow measurement. Pressure at the airway opening was measured by a piezoresistive pressure transducer. Volume was calculated from continuous integration of the flow with adjustment for volume drift. Data was sampled at 62.5Hz. A noncompliant, single-patient tubing system was used in all patients.The volume controlled mode of ventilation was used, with the tidal volume set to 8±2mL/kg body weight. Inspiratory time and flow rate were set to obtain an end-inspiratory pause of ≥0.2s. Patients were first ventilated at zero PEEP (ZEEP) for five minutes. Then, 27 of the 28 patients underwent a recruitment manoeuvre where PEEP was increased in 2cmH2O steps after every 10 breaths. This process continued until a peak inspiratory pressure of approximately 50cmH2O was reached.There are a number of ways to choose an autoregressive model structure [26]. We have chosen to use the first order model as the foundation of the NARX model:(1)Paw=RV˙+EV+P0where Paw is the measured airway pressure (cmH2O), R is the airway resistance (cmH2Os/L),V˙is the airway flow rate (L/s), E is the pulmonary elastance (cmH2O/L), V is the inspired volume (L), and P0 is the end-expiratory pressure (cmH2O).The NARX model presented here adapts the FOM with pressure dependent b-spline basis functions and multiple time-dependent resistance coefficients:(2)Paw(t)=∑i=1Mai∅i,dPawtVt+∑j=0LbjV˙t−j+P0(t)where aiand bjare the parameters to be identified. M is the number of basis-functions to be used, i is the index of a particular basis function of degree d, aiis the coefficient for a given basis function, and∅i,dPawtis the basis function value for a given pressure measurement. The sum of the basis functions multiplied by their aicoefficients defines elastance. There are j=0,…, L bjcoefficients that capture the effect of airway resistance and pressure responses that occur due to changes in flow (i.e. inertance, and pressure equalisation in the relaxation phase). The subscript −j in the second term refers to the previous time sample. Thus, each Paw(t) is calculated from information from the previous L data points. The FOM is thus replicated with M=L=1, and d=0.Zeroth order b-spline basis-functions are square functions, defined:(3)∅i,0P=1ifPi≤P<Pi+10otherwisewhere Piare division points (also known as knots) that subdivide the interval 0≤P≤Pmax. Basis functions of higher degrees are defined recursively [27]:(4)∅i,dP=P−PiPi+d−Pi∅i,d−1P+Pi+d+1−PPi+d+1−Pi+1∅i+1,d−1(P)Fig. 1shows examples of zeroth, first, and second order basis functions.Eq. (2) can be rewritten over time to generate a matrix system of equations:(5)Ax=bwhereA=∅1,dPawt0V(t0)∅2,dPawt0V(t0)…∅M,dPawt0V(t0)V˙(t0)V˙(t−1)…V˙(t−L)∅1,dPawt1V(t1)∅2,dPawt1V(t1)…∅M,dPawt1V(t1)V˙(t1)V˙(t0)…V˙(t1−L)⋮⋮⋮⋮⋮⋮⋮⋮∅1,dPawtNV(tN)∅2,dPawtNV(tN)…∅M,dPawtNV(tN)V˙(tN)V˙(tN−1)…V˙(tN−L),b=Paw(t0)Paw(t1)⋮Paw(tN)andx=a1⋮aMb1⋮bLMeasured data was recorded from t0. Thus, all elements that occur before t0 were set to zero in matrix A. The coefficients (ai, bj) are determined via linear least squares.

@&#CONCLUSIONS@&#
