@&#MAIN-TITLE@&#
Individualization of a vectorcardiographic model by a particle swarm optimization

@&#HIGHLIGHTS@&#
We designed a method for an automatic individualization of the life like vectorcardiographic (VCG) model.The Particle Swarm Optimization (PSO) is used for setting of the parameters of the model.156 models were individualized without any previous analysis of the waves of the original records.For 152 of the 156 VCG models a correlation coefficient achieves r>0.995 and Mean Squared Error MSE<0.0005mV2.

@&#KEYPHRASES@&#
Bio-inspired method,Synthetic ECG,ECG generator,Dipole model,

@&#ABSTRACT@&#
This paper presents the application of a bio-inspired method for optimizing a lifelike vectorcardiographic (VCG) model. During the model estimation, a Particle Swarm Optimization (PSO) seeks the optimal combination of all parameters that maximize the correlation coefficient (r) and minimize the Mean Squared Error (MSE) between the synthetic and directly measured VCG leads. The proposed method was tested on 52 different VCG records annotated as a healthy control (HC) from PTB database. 156 models were individualized without any previous analysis of the waves of the original records. The PSO method automatically provides very realistic models with a correlation coefficient r>0.995 and MSE<0.0005mV2 for 152 of the 156 VCG signals.

@&#INTRODUCTION@&#
Electrocardiography (ECG), one of the most important diagnostic tools used in clinical cardiology, is based on measuring the electrical activity of the heart from the surface of the human body. The most common recording method consists of 12 leads which correspond to projections of electrical activity to different directions in the cardiac space. During the cardiac cycle, electrochemical processes, called depolarisation and repolarisation, of the cardiac cells occur in a particular region of the heart. These processes cause individual patterns called P, Q, R, S, T, and occasionally present a U wave in electrocardiograms (ECG).The basic mathematical model describing the cardiac cycle is based on a moving dipole (MD). MD is a resulting vector of the electromotive forces of the individual cardiac cells during cardiac activity [9]. This vector is represented by 3 orthogonal components and time. The direct measurement of these components is the basis of vectorcardiography (VCG). Three orthogonal leads X, Y and Z are measured as projections into three orthogonal directions [1,8].MD describes the magnitude and direction of the de/repolarisation waves in cardiac muscle and in three-dimensional space and is represented in the form of P, QRS and T loops [8]. Conventional ECG leads are computed from this model using the transformation method. The relationship between ECG and VCG can be described by a transformation matrix. The most common methods are inverse Dower and Kors transformation which differ only in the coefficients of the matrix [2].An approximation of the MD can be used for generating a realistic artificial ECG/VCG. These artificial signals are used in many areas of biomedical research. The most common use is for testing new algorithms in pre-processing (filtration, segmentation), compression and analysis of the ECG [5,6]. New algorithms for classifying ECG patterns [16] are usually tested on real records and an annotation of the data is required. For example, for 24-h records, a Holter monitor can collect more than hundreds of thousands beats, which are impossible to analyse manually and comparing new algorithms will only be possible with existing methods. However, with a synthetic ECG generator, it is possible to generate long realistic records with a known annotation that includes all possible pathologies and artefacts [4].It is also possible to generate variances in the ECG with the model, such as an abnormal cardiac rhythm, respiration effects, ectopic beats and artefacts [7]. Pathological changes, such as myocardial infarction (MI), hypertrophy etc. are reflected as changes to the shape and intervals of the individual waves or segments in the ECG. One cardiac cycle of the model can be individualized to an actual ECG/VCG record by using the approximation model [3].The Gaussian function is the most common way to approximate individual waves [3–7]. Parameters of the Gaussian function then correspond to the shape of the resulting waves. For fitting of these parameters to real beats, a gradient descent method is used [4,7]. But this method requires a previous analysis of the ECG and the approximation often fails in some non-Gaussian shapes of the waves. However non-Gaussian shapes are common in ECG records, especially in pathology records. Precisely expressing the pathology in the model is crucial for further use of the model.Non-symmetrical waves are often present even in healthy records, and this cannot be approximated with only one Gaussian function. Multiple Gaussian functions can approximate both non-symmetry and bipolar waves (often T waves). But the number of Gaussian functions needed for representing the entire beat varies depending on records and leads. For MI records, often elevation or depression of the ST segment is present in some leads. It is also possible to approximate using several Gaussian functions with specific parameters but the fitting process is complicated because there is no previous knowledge about the number and/or positions of the Gaussian functions.This paper focuses on the design of an automatic method for identifying the positions and parameters of Gaussian functions to accurately approximate the MD without having any previous knowledge of the VCG record.Tested records were chosen from a PTB diagnostic database that was recorded from healthy volunteers and patients with different heart diseases at the Department of Cardiology of University Clinic Benjamin Franklin in Berlin, Germany. The database contains 549 records from 286 subjects. Each subject is represented by one to five records. Each record includes 15 simultaneously measured signals: the conventional 12 leads together with the 3 Frank VCG. Each signal was digitized at 1000 samples per second, with 16 bit resolution over a range of ±16.384mV [11–13].There are 52 records measured on different patients annotated as healthy control (HC) in the PTB. All these records were used to test of the proposed algorithm.The records were band-passed using an FIR filter with a linear phase response in range from 0.5 to 150Hz (−3dB). From the filtered records, representative VCG beats excluding ectopic beats and artefacts were chosen. The beginning of the beat was defined as distance from the R wave: TR−0.4Tmin(RR) and the end of beat was defined as TR+0.6Tmin(RR), where TRis the time of presence of an R wave and Tmin(RR) is the minimal pulse period for the record. The positions of R waves were detected using Pan–Tompkins’ algorithm [19] from a V signal (1). Individual representative beats were averaged for each VCG lead and then an isoelectric line was zeroed by subtracting the median value from each averaged beat.(1)V=X2+Y2+Z2In electrocardiology, models are used to describe potentials at electrodes placed on the thorax. The best-known model is a dipole model which is the basis of VCG. Other models are based on multipole expansions or double layer representation [8,9].The MD is commonly referred to as the (time-dependent) heart vector M(t). As each wave of de/repolarization spreads through the heart, the heart vector changes in magnitude and direction as a function of time [9,10]. MD M(t) is given by three orthogonal components Xm, Ymand Zm. With each component, it is possible to approximate the sum of n Gaussian by the following functions:(2)Xm=∑i=1naix⋅e−Δθix2/2bix2,Yy=∑i=1naiy⋅e−Δθiy2/2biy2,Zy=∑i=1naiz⋅e−Δθiz2/2biz2,whereΔθix=θ0−θixis the relative phase with phaseθ0∈0,2π. Each Gaussian function is described by three parameters: amplitudeaix, widthbixand phaseθixwhich corresponds to the position of the ith Gaussian function in the range from 0 to 2π in the lead X.To fit the model to an observation, an optimization method should be performed to set the ai, biand θiparameters.The authors in [4,7] used a gradient descent method to fit the model to a real record. This method is based on minimizing the MSE between the model based Xmand the directly measured Frank lead XFby the following equation:(3)MSE=1n∑Xm−XF2.A further important and common parameter indicating similarity between two signals is the Pearson correlation coefficient r. The correlation indicates the degree of similarity between two signals and is independent of the differences in their amplitudes(4)r=∑XmXF∑Xm2∑XF2For the purpose of optimizing the VCG models, the combination of these two parameters is used. The correlation can take values in range ofr∈−1,1and MSE≥0. For identical signals r=1 and MSE=0. Both these parameters are combined in the objective function (5). When the objective function (5) is maximized, the MSE is also maximized and r is minimized at the same time.(5)Gr,MSE=r101/MSE+110.For identical signals G=1. An optimization method looks for the optimal combination of the parameters by maximizing the objective in the following function:(6)maxai,biθiG.Each beat including P, Q, R, S and T waves, can be represented as the sum of n Gaussian functions. A demonstration of this principle is presented in Fig. 1. Each wave is formed by one Gaussian function. The number and position of Gaussian functions can easily be determined based on a previous analysis of the signal and the parameters aiand bican be optimized using the gradient descent method.Non-symmetrical and bipolar waves are always approximated using two or more Gaussian functions. Elevation/depression of the ST segment and other extra shapes such as a pathological R wave should be automatically recognized and approximated using multiple Gaussian functions. The optimal number of Gaussian functions varies in records, leads and individual waves. The maximal number of Gaussians influences the complexity of the model and the optimization process. In published papers, 5 or 6 Gaussians are typically used for the approximating one beat [4,6,7]. For records annotated as HC, we use 11 Gaussian functions to approximate one beat in each lead. An example of the use of multiple Gaussians for approximating complex signals is presented in Fig. 2. For unused Gaussian functions, parameters aiare automatically set to insignificant values by the optimization method. These Gaussian functions then do not influence the resulting model.Optimization finds the optimal combination of ai, biand θiwhen the objective function G is maximal. Then, MSE between signals is minimal and the correlation is maximal.Particle swarm optimization is a biologically inspired method published in 1995 and motivated by the behaviour of birds in their search for food. This method belongs to a group of algorithms dealing with swarm intelligence. The PSO is a popular method for solving different types of optimization tasks. Its main advantages include fast convergence towards the optimum for a wide range of objective functions and easy implementation [17,15]Many variations have been developed to improve the speed of convergence and accuracy of solutions found by PSO. In this paper, we present the results for a Trelea 1 type of PSO [14].One optimization problem is the search for the ideal position in the D-dimensional space, where N particles are both located (8) and moving (7). The ith particle is characterized by the positionXi=xi1,xi2,…,xiDand the velocityVi=vi1,vi2,…,viD. Swarming of these particles, during optimization, leads to convergence of the model to an optimum of the objective function [18].(7)vidk+1=ωvidk+λ1pidk−xidk+λ2pgdk−xidk,(8)xidk+1=xidk+vidk+1,1≤i≤N,1≤d≤D,where for Trelea 1 type of PSO ω=0.6 and λ1=λ2=1.7 represent inertial, cognitive and social coefficients.Pi=pi1,pi2,piDis the best position of the ith particle searching until kth iteration andPg=pg1,pg2,…pgDis the best position of the search for total particle swarm until kth iteration. The PSO process is demonstrated by the flowchart in Fig. 3.The initial population setting can be random, based on previous models or a combination of both. The first variant looks for the best combination of parameters and creates required patterns. The convergence time can be long and the algorithm may converge different local optima for different runs. A model based optimization is mainly based on the fitting similar models for the observed signal. During initialization, several particles can be initialized according to previous models and the rest of particles randomly.In order to achieve fast convergence to the optimum of the objective function, the PSO settings need to be carefully chosen. Ranges of individual dimensions are chosen based on the general knowledge about the ECG signal and the model used.θi∈0,2πcorresponds to the position of the Gaussian function in the beat. The range is chosen according to the model. Theai∈−2,2parameter corresponds to the amplitude of the wave. We assume that amplitudes of one Gaussian will not be less than −2mV and higher than 2mV. Generally with a combination of more Gaussian functions, it is possible create even higher waves than 2mV. The parameterbi∈0.01,1corresponds to the width of the wave. Values lower than 0.01 produce narrow impulses that are not physiologically possible in an ECG/VCG. High values produce low frequency changes in the model which can be useful e.g. for approximating the ST segment. Values higher than 1 are useless and unnecessarily increase the search area. PSO keeps particles inside these limits during optimization, but it is also important to observe these limits during initialization.Based on experimental observations of the optimization process, we chose a triangular distribution of probability during random initialization of the particles with the following parameters for the PSO: number of particles N=200; maximal number of epochs kmax=5000; minimal performance gradient μ=0.5e−5. The PSO stops when the performance gradient is smaller than μ during 500 iterations or when the maximum number of iterations is met.Neither MSE nor correlation separately guarantees an ideal VCG model. Some models with a low MSE might not fit the VCG properly as well as some models with only a high correlation. For the optimization process, a combination of both parameters is therefore used. The objective function (5) produces balanced results with a low MSE and a high correlation. Optimized models fit the VCG properly, but sometimes the algorithm finds only a local optimum and the process has to start over. Fig. 5 shows an example of one record with a notch in the R wave. Model 2 approximates the original record less accurately than model 1. The differences between MSEs and correlations are small, but diagnostic meanings are different. Based on subjective observations, we consider MSE<0.0005mV2 and r>0.995 to be the minimal limits. If the model does not meet these limits, the PSO starts over with different initial parameters. The principle of the validation process is demonstrated in Fig. 4. For more complex records, the maximal number of iterations has to be increased. Therefore, with each new start of the optimization process, the maximal number of iterations increases by 500 iterations.

@&#CONCLUSIONS@&#
The automatic optimization procedure to fit a VCG model to any given subject was proposed in this paper. Particle swarm optimization seeks to identify the set of optimal parameters for the model by maximizing of the objective function, which contains two basic features the MSE and correlation coefficient. The optimization is automatic and does not require any previous analysis of the individual waves. It allows for designing models with non-symmetrical and more complex waves.The 52 averaged beats for different healthy volunteers from the PTB database were modelled by fitting a mixture of 11 Gaussian functions in each lead. Only 4 of the 156 models did not properly match the original signals. With a higher number of Gaussian functions, it could be possible to individualize also these 4, as well as even more complex and pathological beats. The least accurate models are for the Y lead, but the most of the records were approximated with at least sufficient accuracy.The designed models were used in a generator of synthetic VCG (see Fig. 12). The ECG models can be derived by transforming VCG models and ECG record can be derived from the VCG record.The method described in this paper individualizes the shapes of the waves in the model. Our approach can be used for modelling pathological waves, such as premature ventricular contraction or artefacts. This paper also highlighted that for more complex beats, which are typical for many diseases such as myocardial infarction, is necessary to use more Gaussian functions to properly model these beats. Another optimization and individualization are also necessary to obtain lifelike VCG or ECG signals. Individualization of heart rate variability, respiratory sinus arrhythmia or Mayer waves should be incorporated in the generator for a real use.