@&#MAIN-TITLE@&#
A new approach based on Machine Learning for predicting corneal curvature (K1) and astigmatism in patients with keratoconus after intracorneal ring implantation

@&#HIGHLIGHTS@&#
Optimization of corneal ring implantation using Machine Learning techniques.Prediction of astigmatism and corneal curvature improvement in patients with keratoconus after ring implantation by means Machine Learning techniques.Finding out the most relevant features for a successful ring implantation.

@&#KEYPHRASES@&#
Machine Learning,Keratoconus,Intracorneal rings,Astigmatism,

@&#ABSTRACT@&#
Keratoconus (KC) is the most common type of corneal ectasia. A corneal transplantation was the treatment of choice until the last decade. However, intra-corneal ring implantation has become more and more common, and it is commonly used to treat KC thus avoiding a corneal transplantation. This work proposes a new approach based on Machine Learning to predict the vision gain of KC patients after ring implantation. That vision gain is assessed by means of the corneal curvature and the astigmatism. Different models were proposed; the best results were achieved by an artificial neural network based on the Multilayer Perceptron. The error provided by the best model was 0.97D of corneal curvature and 0.93D of astigmatism.

@&#INTRODUCTION@&#
Keratoconus (KC) is a non-inflammatory, progressive thinning disorder of the cornea, resulting in a protrusion, myopia and irregular astigmatism [1]. It classically manifests in the teenage years to young adulthood and leads to a variable decrease in the quality of vision and ocular discomfort [2]. The general interest in this entity has been increasing in the past years due to the development of new technologies to detect this corneal abnormality and its association to refractive surgery [3]. Laser in situ keratomileusis (LASIK) is the most common refractive surgical procedure for the treatment of myopia. Corneal ectasia associated to LASIK is among the most serious complications [4,5].The treatment approach to KC follows an orderly progression from glasses to corneal transplantation. Glasses and contact lenses are an effective means of correcting mild KC. As the cornea steepens and becomes more irregular, glasses are no longer capable of providing adequate visual improvement. Surgery is recommended when a stable contact lens fit fails to provide adequate vision. Keratoplasty was long the only surgical treatment [6]. However, recent years have seen the introduction of new surgical options: collagen cross-linking, which stiffens the cornea and can halt disease progression [7], or corneal rings, which can reduce astigmatism and improve visual acuity [8,9]. There are many clinical studies on the effectiveness of intrastromal rings on KC in their early stages [10,11]. With the implantation of intracorneal ring segments, the cones remains stabilized and the time point for necessary keratoplasty is delayed or totally avoided [8] (Fig. 1).There are several studies of patients with KC treated with intracorneal rings that discuss about the results and complications after implantation [12]. However, these results vary widely from one author to another. Moreover, the methodology and implantation technique is different [13,14]. For several years trying to reach a consensus about which technique and which nomogram is ideal for implanting rings, the conclusion is that there is no universal nomogram, sufficiently robust to enable surgeons to predict the refractive, topographical and biomechanical outcome of patients with ectasia after implantation of rings. Hence, there is a real need to go further than traditional linear statistical models in order to help surgeons in planning the optimal number and location of intracorneal rings.The objective of this study is to devise a mathematical corneal model for patients with KC and intracorneal rings implantation for treatment. From a database formed by a cohort of 288 patients treated in Fundación Oftalmológica del Mediterráneo (FOM)44Ophtalmology clinic based in Valencia, Spain., mathematical models are developed aimed at predicting the improvement of KC patients after the implantation of intracorneal rings. The improvement is measured in terms of the corneal curvature and astigmatism, thus being an indirect marker of the most appropriate therapeutic strategy to plan the surgery for new patients.The mathematical models proposed in this paper are based on Machine Learning (ML) approaches [15]. The basic idea underlying ML is the production of predictive models based on knowledge acquired from actual cases stored in databases, and their capability of generalization to new cases, not previously seen by the developed models. Machine Learning algorithms have already been used to keratoconus detection based on data from keratoconus diagnosis [16–21]. However, to the authors’ knowledge this is the first time that Machine Learning is used to predict the improvement of KC patients after treatment with intracorneal ring implantation which implied a great novelty to plan this type of surgery.From a database formed by a cohort of 288 KC patients treated in Fundación Oftalmológica del Mediterráneo, a data pre-processing was carried out. The cohort included KC patients (men and women) from 20 to 75 year-old (presenting similar number of samples in the same age range) with a Corneal curvature varying from approximately 33D to 58D. Data removal included firstly an exclusion criteria based on eliminating those data records that did not include the information of all the variables considered in the construction of the model, as well as those patients that presented any other disease in the KC eye. Secondly, for features in a continuous range, outliers were removed based on the classical criterion of excluding those records located beyond three times the standard deviation with respect to the mean value.A model of ML classifier based on an artificial neural network was implemented in Matlab®. The use of artificial neural networks is appropriate in this framework since they are universal function approximators, i.e., they can find a relationship between a given input space and its corresponding output space provided that the model is trained with a sufficient number of data records. These models also present different drawbacks, being likely the three most relevant ones, the need of preventing the model from overfitting (too many parameters), overtraining (too many iterations leading to learn the training data instead of the problem) [15] and falling into local minima. Proposed models had the necessary characteristics to avoid all the three problems, since the number of parameters was reasonably low, and early stopping and cross-validation methods were performed. In addition, a sensitivity analysis was carried out aiming at studying the relevance of the input variables in this model.Artificial neural networks (ANN) are mathematical algorithms inspired in certain aspects of biological neurons, in particular, the knowledge is acquired through a learning process and stored in the so-called synaptic weights [22,15]. The multilayer perceptron (MLP), which is the most widely used ANN, was used in this work. It is a fully-connected feed forward network whose architecture is shown in Fig. 2.The MLP is formed by non-linear elements, (neurons), that are arranged in layers. The first layer is known as input layer, the last one as output layer while the rest of layers are called hidden layers [15]. The number of neurons in the input and output layers is given by the problem while the number of hidden layers and the number of neurons in each layer must be chosen by the network designer [15]. Due to the characteristics of the problem, the activation functions chosen for the MLP were the hyperbolic tangent for the hidden layer and a linear function for the output layer.In the experimental setup, the back propagation algorithm modified by a term of momentum to speed up the learning process was used to train the networks. The chosen value of the learning rate was 0.001 whereas the momentum coefficient was adapted during the learning process depending on the values of the synaptic weights.In addition to the regression produced by the MLP, a ranking of the relevance of the variables was also obtained. This is based on perturbing an input, and then monitoring model outputs [23]. The bigger the difference in the output, the more relevant the input feature.The first step when designing the model is the election of the input variables that characterizes our study. In our case, this choice relied on the variables that are normally provided by the ophthalmologists to the companies that manufacture the rings. Based on these data, the companies provide the rings, propose a possible position for the ring in the cornea as well as its characteristics: thickness and arc length. Thus, the variables incorporated to our model were:•Topographical variables: K1 and K2 corresponding to the corneal curvatures. Astigmatism is obtained as the difference between K1 and K2. In this study, corneal curvatures were measured with Pentacam [24].Variables of the surgery: Incision (Axis corresponding to the cut through which the ring is implanted) and Depth (depth to which the ring is implanted). These variables were obtained from K1 axis and Pachymetry, respectively. In this study, Pachymetry was measured with Visante [25].Characteristics of the rings: nA (number of rings), thickness, arc length and ring type (5mm or 6mm). These variables were provided by the company that manufactured the rings.Due to recent appearance of the ORA device [26], which provides some biomechanical properties of the cornea, some researchers are studying the influence of those properties on the cornea with keratoconus. The biomechanical properties that ORA provides are the Goldmann-correlated intraocular pressure (IOPg), the Corneal-compensated intraocular pressure (IOPcc), the Corneal Hysteresis (CH) and the Corneal Resistance Factor (CRF). Before incorporating those variables to the model, a study was performed by a decision tree. The study clearly showed that CH was the most relevant variable among all the biomechanical properties provided by ORA. CH reflects viscoelastic properties of the cornea and indicates its biomechanical integrity [26]. Therefore, this variable was included in the model as input variable in order to analyze the impact of the biomechanical behavior of the cornea in the developed model.After removing those records that showed missing values, were outliers or showed some inconsistencies, the analyzed data corresponded to 194 measurements of 194 eyes from 154 different patients. Measurements were taken in FOM following the normal protocol for patient with keratokonus.The final data set was split into two groups. The first one, called “training group” and made up of 2/3 of our data, was the group that designed and portrayed our model. The second one, known as “validation” was used to validate the model obtained from the training group. A fine result on “validation group” guarantees a good model design and, therefore, a good problem description since the model shows a good capability to work well with data different from those used to obtain the model and hence, it suggests an adequate behavior on new patients.In order to obtain the model of neural network, 300 networks were generated by changing the number of neurons of the hidden layer from 2 to 20, by tuning the learning speed parameters and by testing different initializations for the synoptic weights. The continuous variables were standardized to normal distributions with mean value equal to zero and standard deviation unity to ensure that all of them contribute in a similar way to the neural models.

@&#CONCLUSIONS@&#
This paper has proposed a methodology to build neural networks that accurately predict the corneal curvature K1 and the astigmatism after implantation of intracorneal rings. A good model of astigmatism and K1 prediction has been developed in terms of a high correlation coefficient between actual and predicted signals, and low ME, MAE and RMSE values. Sensitivity analysis has shown that the most relevant features for the astigmatism and K1 prediction are the keratometry, K1, and the position of the ring in the depth of the cornea. After the study and looking at the obtained results, it can be concluded that the suggested results are promising and open a door for the use of this methodology in clinical practice after a thorough validation.Currently, we are working on the acquisition and accommodation of new data in order to improve the models already produced as well as validate them with new data, thus showing up their robustness capabilities.All authors disclose that there are not any financial and personal relationships with other people or organizations that could inappropriately influence their work.