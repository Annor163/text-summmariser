@&#MAIN-TITLE@&#
Locating the fovea center position in digital fundus images using thresholding and feature extraction techniques

@&#HIGHLIGHTS@&#
A methodology for detecting the fovea center position in fundus images is presented.The methodology was evaluated on 1200 fundus images of the MESSIDOR database.Evaluation criterion: methodology-provided and actual fovea center distance.In 93% of analyzed images, the distance remained below 1/4 of one optic disc radius.These results outperform all the reviewed methodologies available in literature.

@&#KEYPHRASES@&#
Ophthalmic pathologies diagnosis,Fundus images,Diabetic retinopathy,Fovea location,

@&#ABSTRACT@&#
A new methodology for detecting the fovea center position in digital retinal images is presented in this paper. A pixel is firstly searched for within the foveal region according to its known anatomical position relative to the optic disc and vascular tree. Then, this pixel is used to extract a fovea-containing subimage on which thresholding and feature extraction techniques are applied so as to find fovea center. The methodology was evaluated on 1200 fundus images from the publicly available MESSIDOR database, 660 of which present signs of diabetic retinopathy. In 93.92% of these images, the distance between the methodology-provided and actual fovea center position remained below 1/4 of one standard optic disc radius (i.e., 17, 26, and 27 pixels for MESSIDOR retinas of 910, 1380 and 1455 pixels in size, respectively). These results outperform all the reviewed methodologies available in literature. Its effectiveness and robustness with different illness conditions makes this proposal suitable for retinal image computer analyses such as automated screening for early diabetic retinopathy detection.

@&#INTRODUCTION@&#
Diabetic retinopathy (DR) is a retinal disease derived from complications caused by the abnormally high glucose level in blood produced by diabetes mellitus. Nowadays DR is the leading ophthalmic pathological cause of blindness among people of working age in developed countries [1]. Although DR is not a curable disease, laser photocoagulation can prevent major vision loss if detected in early stages [1,2]. However, DR patients usually perceive no symptoms until the later stages, when visual loss develops and treatment is less effective. All diabetic patients are at risk for DR and most of them eventually develop the illness. Therefore, annual eye fundus examination in diabetic patients becomes necessary to ensure timely treatment application [3–5]. However, this preventive protocol involves a huge challenge for health systems due to the great number of patients needing ophthalmologic revision (the estimated prevalence of diabetes for all age groups worldwide is forecasted to rise from 171 million in 2000 to 366 million in 2030 [6]).DR is diagnosed by the examination of retinographies. This use of digital images of the retinal surface could be exploited for computerized early detection of DR. A robust system that enabled non-experts to filtrate cases of patients not affected by the disease, would reduce the specialists’ workload and increase effectiveness in preventive protocols and early therapeutic treatments. Furthermore, it would also result in outstanding economic benefits for public health systems, a cost-effective treatments associated to early illness detection have been observed to lead to remarkable cost savings [7,8].The fovea is a small depression at the centre of the retina of about 1mm in diameter and visible as a round dark area in retinal images. The location of this retinal region is particularly important in the development of automated DR diagnosis systems because it is a diagnosis key for disease classification. The fovea is responsible for sharp central vision, usually called photopic or bright-light vision. This central portion in the retina primarily contains the cones, which are light receptors highly sensitive to color connected to their own nerve end: thus, they can resolve fine details. Therefore, the distance at which DR-related pathologies are located from the fovea influences clinical relevance and is used for illness-grade determination.A new methodology for locating the fovea through its center position in fundus images is presented in this paper. Despite its simplicity, the accuracy achieved by this method exceeds that reported by the most accurate methods in literature. Method evaluation was performed on a wide-range database composed by 1200 retinal images, more than half of them corresponding to retinas presenting different DR grades. This is especially relevant if we keep in mind that our main aim is integrating the method into systems for automated DR diagnosis.The rest of the paper is organized as follows. Other published solutions for fovea location are reviewed in Section 2, while the testing material used in this study is described in Section 3 and the proposed method is explained and illustrated in Section 4. Section 5 presents the obtained results and compares them to those obtained with other available methods. Finally, the authors’ conclusions put an end to this paper.The fovea location methods reported in literature are mainly based on exploiting the fovea's visual appearance (this region is recognizable as a round area darker than its surrounding retinal tissue) and its known anatomical position in the retinal surface (on average, fovea center is located at 2.5 optic disc (OD) diameters from the OD center following the horizontal raphe of the retina [9]).Sinthanayothin et al. [10] present a method for fovea recognition in which the fovea was assumed to be the darkest area in the fundus image, with approximately the same intensity as the blood vessels. Firstly, the fovea was correlated to a template of intensities; the template was chosen to approximate a typical fovea. Then, the location of maximum response was selected as the location of the fovea if it also was at approximately 2.5 times the diameter of the OD from the OD center. Gagnon et al. [11] use a similar approach to detect fovea center. They first generated a coarse resolution image from the original image. Secondly, they selected the darkest pixel in the coarse resolution image following the above-described distance criterion. Finally, fovea center was found by searching in the vicinity for this darkest pixel on the original fine resolution image. On the other hand, Li et al. [12] present a method for fovea location that also use its darkness and the distance criterion, but also propose the use of the vascular arch to reduce the search area. Thus, they presented a model-based approach in which an active shape model was used to extract the main course of the vasculature based on OD location. This course and the distance criterion of the fovea were used to specify a region of interest. Finally, the fovea center was obtained by applying a thresholding scheme to the region of interest. Later, a fovea automated location only by means of the distance criterion and the vascular arch is proposed in [13]. The method started by locating the OD and estimating the vascular arch by means of a parabolic model. Fovea location was ultimately inferred according to these two anatomical landmarks. A method, started with the parabolic modeling of the vascular arch, was presented in [14]. Then, using this elliptical modeling of the major retinal blood vessels, the approximate locations of the OD and the fovea were obtained. Finally, fovea position was refined according to its local darkening. On the other hand, Niemeijer et al. [15] presented a method to model the distribution of all retinal features. The method used an optimization method to fit a point distribution model to the fundus image. After fitting, the points of the model indicated the location of the normal anatomy. Subsequently, these authors presented another work on fovea detection in [16]. They first found the OD and, according to its location, an area of interest for the fovea was defined. The location with the lowest predicted distance to the fovea within this area was selected as the fovea location. Finally, Yu et al. [17] used the above-mentioned distance criterion and the vascular arch to find a region of interest where the lowest response of a template matching was selected as the fovea center position.To evaluate the fovea location methodology described in the next section, the publicly available MESSIDOR database was used. This database11Download images section, MESSIDOR: Digital Retinal Images, MESSIDOR TECHNO-VISION Project, France [Online]: http://messidor.crihan.fr/download-en.php.contains 1200 eye fundus color images of the posterior pole acquired by the Paris Hôpital Lariboisière, the Faculté de Médecine St. Etienne and the LaTIM – CHU at Brest (France). 800 of these images were captured with pupil dilation (one drop of Tropicamide at 10%) and 400 without dilation, using a Topcon TRC NW6 non-mydriatic retinograph with a 45° field-of-view (FOV). The images were digitalized to 1440×960, 2240×1488 or 2304×1536 pixels, corresponding to retina diameters of approximately 910, 1380 and 1455 pixels, respectively, and are 8 bits per color plane. All these images are provided in TIFF format.All fundus images from this database were diagnosed by medical experts attending to a classification designed within the framework of the Messidor – Techno-Vision Project.22Methods to evaluate segmentation and indexing techniques in the field of retinal ophthalmology – TECHNO-VISION Project. Available: http://messidor.crihan.fr/index-en.php.This classification grades DR into four stages (on a scale of 0–3, with 0 being normal retina) and evaluates the risk of macular edema (ME, a retinal disease closely associated to DR) into three grades (on a scale of 0–2, with 0 being no risk). According to this classification, the whole set of MESSIDOR images includes 540 cases of healthy retinas (DR grade=0; ME risk=0) and 660 cases of pathological retinas showing some DR or ME sign (DR grade≠0 or ME risk≠0). Therefore, the choice of this database allows evaluating the methodology under different illness conditions.On the other hand, the MESSIDOR database provides no binary masks delineating retina pixels for the images (FOV masks). The use of these masks allows the application of algorithms exclusively within the retina, as well as obtaining outstanding information. For instance, for a given fundus image, retinal diameter can be easily determined by measuring the diameter of the FOV mask. As shown in Sections 4.1 and 5.1, this fact is especially relevant in this paper, as the OD diameter can be estimated from this retina size. Therefore, the FOV masks were manually generated and are publicly available in [18].

@&#CONCLUSIONS@&#
A method for locating the fovea in retinal digital images by detecting its center position is presented in this paper. According to the known geometrical position of the fovea relative to the optic disc (OD) and vasculature, the method firstly obtains a pixel within or near enough this retinal region. Then, a fovea-containing region of interest, centered on this pixel, is extracted. Since the fovea can be identified as the darkest round area in this region, its center is located by applying thresholding and feature extraction techniques.The methodology was tested on 1200 fundus images from the MESSIDOR database. This database was selected because, apart from being public, it is composed by a large number of retinographies classified according to diabetic retinopathy (DR) grade and macular edema (ME) risk. Specifically, the set of tested images include 540 healthy and 660 DR- or ME-related pathological retinas. Thus, the methodology can be evaluated on a huge number of clinical cases of interest within the framework of automated diagnoses of these retinal diseases. Regarding the evaluation criterion, the distance between the estimated fovea center and the actual one, established by two different experienced ophthalmologists, was measured for each fundus image. Specifically, referential distances 1/8, 1/4, 1/2 and 1 times the OD radius (measured from the real center position of the fovea) were selected to set a quality scale.The proposed methodology provided a pixel separated from the true fovea center by a maximum distance of (1/8) and (1/4) OD radius in 80.42% and 93.92%, respectively, of the 1200 of analyzed cases (Table 2). According to the methodological comparison in Tables 2 and 3, these results are systematically higher than those achieved by the reviewed fovea-location approaches available in literature. Note that although comparison results in Table 3 could not be carried out on the same set of images, since the authors evaluated their different published methodologies on their own not publicly available databases, performance comparison in Table 2 was carried out under identical conditions. For the sake of facilitating rigorousness in future method comparisons, the coordinates of the fovea centers used in this paper as ground truth for each of the 1200 MESSIDOR images analyzed are available in [18]. Moreover, the manually generated FOV masks are also at researchers’ disposal.In addition, method simplicity should also be highlighted. The performance results obtained on a massive digital retinal database indicate that simple methods based on basic image processing techniques seem to suffice for fovea location. These results demanded very short computational time. In spite of dealing with high resolutions images (1440×960, 2240×1488 and 2304×1536), average time to process a single image was 0.940s (standard deviation of 0.547s). Its effectiveness and robustness, together with its fast implementation, make this proposed automated fovea location method a suitable tool to be integrated into a complete prescreening system for early DR detection.