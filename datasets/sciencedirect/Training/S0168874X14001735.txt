@&#MAIN-TITLE@&#
Parallel, second-order and consistent remeshing transfer operators for evolving meshes with superconvergence property on surface and volume

@&#HIGHLIGHTS@&#
Several field transfer operators between meshes are studied for ALE formulation and remeshing.They are based of superconvergent patch recovery techniques derived from error estimation.Improvements provide super convergence on surface, balanced stresses and parallelism.With analytical tests, super convergence is measured on surface as well as improved accuracy.Satisfactory accuracy is obtained on 3D metal forming applications.

@&#KEYPHRASES@&#
Field transfer,Superconvergent patch recovery techniques,Meshless finite difference method,Remeshing,ALE formulation,Solid mechanics,

@&#ABSTRACT@&#
This paper investigates several field transfer techniques that can be used to remap data between three-dimensional unstructured meshes, either after full remeshing of the computational domain or after mesh regularization resulting from an ALE (Arbitrary Lagrangian or Eulerian) formulation. The transfer is focused on state (or secondary) variables that are piecewise discontinuous and consequently only defined at integration points. The proposed methods are derived from recovery techniques that have initially been developed by Zienkiwicz et al. in the frame of error estimation. Obtaining a higher order interpolation with the recovered fields allows reducing the inescapable diffusion error resulting from the projection on the new mesh. Several variants of the method are investigated: (a) either based on nodal patches or on element patches, (b) by enforcing the balance equation in a weak sense or in a strong sense or not, (c) by using first or second interpolation orders. A special attention is paid to the accuracy of the transfer operators for surface values, which can play a first order role in several mechanical problems. In order to take into account the constraint due to parallel calculations, a new iterative approach is proposed. All methods are evaluated and compared on analytical tests functions, both for the ALE formulation and for full remeshings, before being applied to an actual metal forming problem. In all studied examples, in addition to improved accuracy, higher order convergence rates are observed both for volume and surface values, so providing quite accurate transfer operators for various applications.

@&#INTRODUCTION@&#
For a large class of nonlinear problems, such as forming processes or highly heterogeneous loadings, the optimal mesh configuration continually changes throughout the deformation process, requiring successive mesh adaptations during the numerical simulation. Therefore, the problem resolution requires the transfer of data fields such as pressure, temperature, velocity, stress and strain between different meshes, and the quality of the numerical simulation highly depends on the quality of transfer operator allowing continuing the computation on a new mesh. In Arbitrary Lagrangian or Eulerian (ALE) formulations, such data transfer takes place at each time step [1]. In Lagrangian formulations, it is activated at each remeshing step. Several important aspects of the transfer operator, such as consistency with constitutive equations, conservation of equilibrium equations or bound on extrema need to be considered to have a stable and reliable data transfer [2]. However, the transferring approach highly depends on the type of variables which needs to be transferred. Most of physical data encountered in engineering applications can be roughly categorized into variables which are either continuous or discontinuous throughout the domain. The continuous variables (such as displacements, velocity and temperature) are often stored at nodes; they will be referred to as P1 variables in the present paper where a linear finite element interpolation is used. The discontinuous variables (such as stress and strain tensors) are stored at the Gauss points of the element; they will be referred to as P0 variables in the present paper where a single Gauss point is used at the center of the element. The techniques that are developed to transfer P1 variables are hardly applicable to P0 variables because of their discontinuous characteristic. Transfer of P0 variables consequently requires more sophisticated techniques and is the main subject of this paper.In literature, the oldest method used for P0 transfer is a direct P0 operator. The value at an integration point of the new mesh is directly copied from the nearest integration point of the old mesh. Srikanth et al. [3] for instance further improved this direct approach by introducing weighted averages. If the nearest integration point of the old mesh is close enough to the considered integration point, then the variable is approximated by its value, otherwise a weighted average over the values of the integration points located at a selected distance of the considered point is performed. The second class of method is based on the weak conservation of the transferred field in the domain. Shashkov et al. [4,5] formulated a local-bound-preserving conservative transfer operator with 1st and 2nd order of accuracy. An approximated integration of the constructed function on the new grid is used to obtain the mean value in the cell. Liska et al. [6] extended the technique by an idea derived from flux corrected transfer [7] and formulated flux corrected transfer by introducing a new local measure of accuracy which is derived from L1 norm of the error. Lin et al. [8] proposed a scheme based on the concept that the error caused by transfer can be confined within particular areas of the mesh that have been significantly changed. Inside these “worse areas”, they tested four methods including linear interpolation, particle transfer, 1st order integral transfer and high order essentially non-oscillatory transfer, before concluding that only worse area is needed to be transferred.Following a similar approach, Rachid [9] proposes to associate a “tributary region” to any integration point of the mesh. It allows writing a piecewise discontinuous interpolations over the domain, both for the old and new meshes. The minimization of the L2 norm of the difference between these two discretizations integrated over the entire domain directly provides the integration point values of the new mesh. The main difficulty consists in computing the integration terms of the L2 norm with non-matching meshes. In [10], in the frame of the finite volume method, the integration of the difference norms is based on using the mortar elements technique; it allows developing a very conservative operator.The general idea of this paper is that, whichever the utilized transfer operator and conservative as it can be, transfer always results into a loss of information due to diffusion during the change of mapping. It is then believed that it is possible to reduce and control this loss of information by enriching the transferred field beforehand, in such a way that this enrichment can compensate for the inevitable loss. This enrichment is derived from techniques which have initially been developed for error estimation based on the comparison between the finite element field and a recovered enhanced field, as originally proposed by Zienkiewicz and Zhu [11]. In this particular context, it has been shown the global L2 norm does not allow building a sufficiently accurate recovered field (because it smooths the solution too much) and that local approximations should be built using superconvergence properties [12,13]. This paper follows this main idea to build recovered fields of a higher order than the initial field.At first, we introduce the interpolation method. It has often been used in literature following two approaches: (a) direct interpolation [6,14] and (b) nodal recovery based techniques [2,15,16]. The direct interpolation approach relies on using a set of field values at Gauss points (of the old mesh) located in the vicinity of the considered Gauss point (of the new mesh) for building a local and continuous approximation. In the work of Liszka et al. [6,14] with irregular meshes, the interpolation method was based on a Taylor series expansion of unknown functions combined with the minimization of interpolation error. A shortcoming of this approach is the lack of continuity between the set of considered Gauss points. Villon et al. [17,18] developed a transfer operator based on the diffuse approximation, also referred to as the Moving Least Square method, which is both local and continuous over the entire domain. The reconstruction of the stress field is carried out using operators that intrinsically preserve the local equilibrium (balance equation and stress admissibility). On the other hand, in the second approach of nodal recovery techniques [2,15,16,19], the P0 variables of the old mesh are first projected onto nodal points to build a continuous interpolation. The nodal points values on new mesh are then computed by simple interpolation of old mesh nodal values using the shape-functions. The P0 variables at the Gauss points of the new mesh are finally obtained by employing the shape functions of new mesh. Peric et al. [2] formulated a nodal recovery based transfer operator and discussed the different aspect related to equilibrium conditions, consistency with the constitutive equation, geometric issues and diffusion of state variables between successive meshes. Khoei et al. [20] pointed out that by transferring the information to the nodes and recalculating them at new Gauss points, the equilibrium of the system is violated, even if the mesh is not changed. Dureisseix et al. [16] also formulated a nodal recovery based transfer operator by using an approximated integral of the Jacobian transformation of the point needed to be transferred with weights of those points to recover the nodal field.Mediavilla et al. [19] modeled a quasi-static ductile crack propagation by using a nodal recovery based transfer operator. They used a standard extrapolation and nodal averaging technique to recover the state variable from the discrete values known at the integration points, although such technique will produce numerical diffusion. Hinton et al. [21] used a global least squares approximation and Loubignac et al. [22] used an iterative procedure to construct a smooth stress field to reduce numerical diffusion. Less diffusion can be achieved by computing the new integration point variables directly from the continuous stress field on the old mesh [15]. Yet, this introduces more inconsistencies as was shown in Pavanachand [23]. The consistency issue of the transfer operator is well explained by Camacho et al. [24], clearly stating that consistency among field variables may be lost due to the fact that nonlinear relations between them are not carried over correctly by a linear transfer operator.In 1992, in the frame of error estimation, Zienkiewicz et al. [12,13] introduced the concept of Superconvergent Patch Recovery (SPR), where nodal field is evaluated by determining a polynomial expansion over a patch of elements sharing the node. Several modified and alternative recovery technique based on SPR have been proposed over the years to increase its robustness and accuracy. Boroomand et al. [25] proposed Recovery by Equilibrium in Patches (REP) which avoids the specification of superconvergent points. Gu et al. [26] modified SPR by using integration points as sampling points and introducing additional nodes, which increased the performance of SPR for nonlinear problems remarkably. Wiberg et al. [27,28] presented an improvement to SPR by extending the technique to use element patches rather than nodal patches, and extended the SPR to SPRE (penalizing the violation of the equilibrium) and SPREB (by including a least square fit of the boundary conditions). SPR technique has been more often used for the purpose of FEM error estimation rather than remapping. Khoei et al. [20] formulated a 3D data transfer operator based on SPR model for a plasticity problem by implementing 0 (Co continuity), 1st (C1 continuity) and 2nd (C2 continuity) order polynomial while formulating SPR, clearly stating the effect of each variant. When dealing with boundary variables, Khoei used higher order patch to maintain the same order of accuracy on the boundary as for the internal points.All these techniques apply to continuous fields and implicitly assume that the finite element method is converging, in other words, that a higher order interpolation of the field to be transferred provides a higher order solution. This is the case of problems including discontinuities such as bi-materials.In the present paper, eight transfer operators based on different interpolation approaches are formulated and tested against each other over benchmark problems. Parallel aspects of transfer operator are discussed. A new modified iterative SPR recovery based transfer operator is proposed, which maintains its order of accuracy over the surface without increasing the patch size and is therefore easier to implement in a parallel environment. The convergence rate and accuracy of proposed operators are tested for several analytical functions, as well as on a representative mechanical problem derived from a metal forming application in order to use representative finite element sizes and field gradients.P0 transfer is the simplest transfer operator as discussed above. The value of the P0 variable on new mesh is approximated by the value of the nearest integration point of the old mesh. In addition to being very fast and very easy to implement into a parallel code, this very simple technique has some remarkable properties: it allows preserving the bounds as well as the consistency of the transferred field. For instance, the remapped stress and strain (or strain rate) tensors still satisfy the constitutive equation at the integration point of the new mesh. Therefore, this technique can be rather efficient, provided that the considered meshes are sufficiently refined with respect to the remapped fields. In fact, for a given element size, the transfer error is directly proportional to the gradient of the remapped value. In the general practice, this technique is too coarse and too diffusive.In the ALE formulation, remeshing occurs at each time step so the old and new meshes are very similar. Consequently, the Gauss points of the new mesh almost always belong to the same element of the old mesh. On the other hand, in a Lagrangian formulation with complete remeshing, some parts of the domain are very often only weakly changed by remeshing. Therefore, in order to minimize diffusion resulting from usual transfer techniques, interpolation can be avoided through a direct calculation of recovered fields on element patches, as for instance in [27,29]. Element patches, Pg, are built on the old mesh. They consist of all the mesh elements e′ that contain at least one node k of the considered element e (1), where g is the Gauss point located at the center of e (so we could either denote it Peor Pg), as shown inFig. 1. If there would be several inter(1)Pg={e′suchthat:∃k∈e,k∈e′}In this approach, a recovered local continuous solution is constructed in the vicinity of each Gauss point and is regarded as valid on the whole patch Pg. It can thus be used to extrapolate the values at the integration points of the new mesh that belongs to the central element. In Fig. 1,xkbeing the location of the integration point k of the new mesh and g the nearest integration point of the old mesh belonging to element e, the value of P0 variable σ atxkis then interpolated from the value of the recovered expressionσ˜g(xk)atxk, as given by Eq. (2) for 1st order polynomial:(2)∀x∈Pg:σ˜g(x)=Pg(x)ag=a1g+a2g(x−xg)+a3g(y−yg)+a4g(z−zg)Whereagis the vector of interpolation coefficients andPgis the polynomial basis. Different polynomial orders can be used providing different orders of recovery. For the first order expansion, the method is called EPR1 (Element Patch Recovery of the 1st order) and for the second order expansion, the method is called EPR2 (Element Patch Recovery of the 2nd order). For the consistency of the recovered solution, ifxis located at the same position likexg, thenσ˜g(x=xg)should be equal to σg, the finite element value of σ atxg. Consequently:(3)σ˜g(xg)=σg⇔a1g=σgThe other coefficients of the polynomial are determined by the condition of minimizing the difference betweenσ˜g(xf)and σfat any Gauss point f of patch Pglocated inxf. In the general case, there are much more Gauss points than unknowns, so it is not possible to exactly enforce this condition; a least square minimization is then used. It writes, in the linear case:(4)ΠgFD(ag)=MINbgΠgFD(bg)where:ΠgFD(ag)=12∑f∈Pg(σf−(σg+a2g(xf−xg)+a3g(yf−yg)+a4g(zf−zg))(Δgfr)2)2andwith:(Δgfr)2=(xf−xg)2+(yf−yg)2+(zf−zg)2The weighting term(Δgfr)−4is derived from the Liszka-Orkisz’ approach [6,14] (see Section 3.2 for more details). The minimization ofΠgFD(ag)(4) implies that:(5)∀n=2,…,4or10∂ΠgFD∂ang=0This will result into a 3×3 linear system (or 9×9 with a 2nd order polynomial) of equations(6)AgXg=BgIn order for this system to be solvable (Agis invertible), it is necessary that the number of independent equations be larger than the number of unknown coefficients(aig)i=2,…:3for linear interpolations and to 9 for quadratic interpolations. But in certain cases, it is not enough that the number of pointsxfincluded in the patch is large enough. For instance, in the example ofFig. 2, the two neighbors are aligned with the patch center, so the equations provided by these Gauss points are not independent and do not provide any information about the gradient in the vertical direction.When the system is badly conditioned, which is often the case for patches centered on boundary elements, then two strategies are possible: (a) either increase the size of the patch (by including elements that share at least a node with any element of the present patch) to get more information or (b) decrease the order of the expansion to decrease the number of unknowns in Eq. (6) (from second to first polynomial order and down to constant P0 interpolation). In this paper, these two strategies are combined in order to handle any kind of meshes: if the enlargement of the patch (a) does not provide an invertible matrix then the order of the expansion (b) is reduced.This section is more specifically focused on the transfer of the stress tensorσ. After transferringσonto the new mesh and computing the equilibrium equations (in a weak sense), it is observed that the balance equation is not properly satisfied. This can be the source of numerical oscillations when the unbalanced forces will be compensated during next time increment. For unstable problems like those encountered in fracture mechanics, these oscillations can trigger unexpected behaviors of the material. For less stiff problem, those non-physical adjustments may cumulate with time, especially with an ALE formulation where data transfer occurs at each time step, and eventually become non-negligible.Therefore, several techniques have been developed in the literature to improve this issue. Rather than independently interpolating each component of stress tensor as in (2), the recovered tensorσ˜gis globally approximated by Eq. (7), either using a new polynomial basisP¯g(x)or not. For instance, Brancherie et al. [29] have proposed a transfer operator that exactly preserves the equilibrium as well as the stress admissibility at the new Gauss points. In their work, the tensor local polynomial basisP¯g(x)is constructed in a dedicated way that allows thatσ˜gsatisfies the balance Eq. (8) for any value of the interpolation coefficientsag. Their interpolation is built on the basis of the diffuse approximation.(7)σ˜g(x)=P¯g(x)ag(8)div(σ˜g(x))+ργ(x)=0In Eq. (8),γdenotes any force field enforced on the domain. The polynomial coefficientsagare computed by minimizing an expression that is quite similar to Eq. (9) where all components of the stress tensors are included. In the present work, a slightly different approach is followed. No special polynomial basis is introduced andPg(x) is used as in (2). Consequently, the equilibrium constraint (8) is enforced by adding a penalty termΠgE(ag)to the functionalΠgFD(ag)to be minimized, while the consistency Eq. (3) is still used and consequently reduces the number of unknowns ofag(9)ΠgEFD(ag)=ΠgFD(ag)+χΠgE(ag)with:ΠgFD(ag)=12∑f∈Pg(σf−σ˜g(xf)):(σf−σ˜g(xf))(Δgfr)4where:σ˜g(xf)=Pg(xf)agandwith:ΠgE(ag)=12∑f∈Pg‖div(σ˜g(xf))+ργ(xf)‖2χ is a penalizing coefficient defined in Eq. (10), where hgis the size of central element and χ0 a large non-dimensional constant.(10)χ=χ0(hg)2withχ0⪢1In the minimization ofΠgEFD(ag), the derivatives ofΠgE(ag)provide a coupling between the different components of the recovered stress. Therefore, it is no longer possible to solve six linear systems (as expressed by Eq. (6)) independently for each stress component, and a global system is formulated containing extra-diagonal terms. When a first order polynomial is utilized, the divergence ofσ˜gis constant on the patch and the method is called EPRE1 (Element Patch Recovery with Equilibrium constraint and 1st order polynomial expansion).When a 2nd order polynomial is used, the method is slightly more complex to implement, so a second approach has been preferred. It is based on the concept of equilibrium in patches proposed by Zienkiewicz and Boroomand [30–32] for patches centered on nodes. Here the method is extended to patches centered on elements and thus directly providesσ˜gwithout any additional interpolation. The method is called REEP2 (Recovery by Equilibrium in Element Patches with 2nd order polynomial expansion). It involves equilibrating the stress tensor in a weak sense only, locally over the element patch Pg, by writing the weak form of the equilibrium equation [25], first for the finite element solution (11) and then for the recovered stress tensor (12).(11)∀u⁎∈U0ca(Pg),∫Pgσ:ε(u⁎)dω−∫Pgf.u⁎dω-∫∂TPgT¯.u⁎ds=−FΩ\Pg(12)∀u⁎∈U0ca(Pg),∫Pgσ˜g:ε(u⁎)dω-∫Pgfu⁎dω−∫∂TPgT¯.u⁎ds=−FΩ\PgwhereU0ca(Pg)is the set of kinematically admissible displacement fields satisfying zero (homogeneous) essential boundary conditions over Pg,ε(u) is the linear strain tensor derived fromu,fare the volume forces imposed on domain Ω,T¯the surface stresses enforced on ∂TΩ that intersect ∂Pginto ∂TPgandFΩ\Pgare the actions of the remaining domain Ω/Pgover Pgas shown inFig. 3. Eqs. (11) and (12) provide the system of equations thatσ˜gshould verify(13)∀u⁎∈U0ca(Pg),∫Pg(σ˜g−σ):ε(u⁎)dω=0As in Eq. (4), these conditions are enforced in a least square sense. The consistency Eq. (3) is still used and consequently reduces the number of unknowns.ΠgFD(ag)is written as(14)ΠgFD(ag)=12∑λ=1,3∑l∈Pg(∫Pg(σ˜g−σ):Bλldω)2with:∀l∈Pg,∀(λ,i,j)∈{1,3}3Bλlij=12[∂Nl∂xjδiλ+∂Nl∂xiδjλ]where δ is the Kroenecker symbol(δij=1⇔i=jandδij=0⇔i≠j)and N are the finite element interpolation functions. As for the EPRE1 technique, the imposition of the local equilibrium introduces a coupling between the different 6 components of the recovered stress tensor. The differentiation ofΠgFD(ag)with respect toagprovides a 54×54 linear system to solve, which is similar to the system of Eq. (6).The use of element patches brings about a slight discontinuity at the interface between elements. It is not an issue within an ALE formulation where new Gauss points are usually located inside the element of the old mesh. For the transfer between non-matching meshes, this discontinuity can regarded as a weakness of the transfer operator. Therefore, nodal patches have been extensively used in literature [12,25,33–35] to build continuous interpolations. The method often comes down to calculating nodal valuesσ˜kof the recovered fieldσ˜at any node k of the mesh, and then to interpolating (15) these values with the continuous interpolation functions N of the finite element mesh, e.g. using the isoparametric interpolation functions of the primary variables such as displacements or velocities. It should be noticed that this particular choice (isoparametric interpolation functions) is shown to be optimal in the error estimation framework.(15)∀x∈Ω,σ˜(x)=∑k∈Ωσ˜kNk(ξ(x))Whereξ(x) are the local coordinates ofxcomputed by the inversion of (16)(16)∀x∈Ω,x=∑k∈ΩXkNk(ξ(x))Therefore, the P0 field σ is first extrapolated to nodes of the old mesh and then interpolated to new integration points, as shown inFig. 4. The continuous transfer operator is a two-stepped process: recovering the field(σ˜k)k∈Ωat nodal points and then interpolating it on new mesh (17)(17)∀xg′∈Ω′,σ˜(xg′)=∑k∈Ωσ˜kNk(ξ(xg′))suchthat:xg′=∑k∈ΩXkNk(ξ(xg′))σ˜is a continuous P1 field with a higher order continuity than the original P0 field. When superconvergent recovery techniques are utilized to compute the interpolation coefficients(σ˜k)k∈Ω,σ˜is expected to be a much higher order solution than σ, in terms of the finite element convergence toward the exact continuous solution. The superconvergence property is well satisfied with linear/elasticity problems [31] while it is often lost with non-linear/plasticity problems [32].The easiest way to computeσ˜kat node k consists in averaging integration points values σg(or the element value σeif there is only one integration point per element) of the elements of patch Pkcentered in k(19). This method is denoted Avg(18)∀k∈Ω,σ˜k=1∑e⊃k∑g∈eωg∑e⊃k∑g∈eωgσgorelse:∀k∈Ω,σ˜k=1∑e∈Pkωe∑e∈Pkωeσe(19)Pk={esuchthat:k∈e}where ωg(or ωe) is the volume contribution associated to Gauss point g (or to element e). It should be noticed that this approach is not superconvergent, as will be shown in Section 4.The nodal least square (LS) method is a basic projection method which is commonly used in remeshing procedure. The value of P0 field σ is projected onto P1 interpolation by minimizing the global least square error between projected and original fields at Gauss points:(20)∏LS((σ˜k)k∈Ω)=12∑g∈Ωωg(∑k∈Ωσ˜kNk(ξ(xg))−σg)2This approach is also not super convergent, as will be shown in Section 4.In 1992, Zienkiewicz and Zhu [12,36] introduced the concept of Superconvergent Patch Recovery (SPR), where nodal field is evaluated by determining a polynomial expansionσ¯kover a patch of elements Pk(19) sharing the node k (seeFigs. 4 and 5).The approach is quite similar to the method presented in Section 2.2. For linear finite element interpolation, and for any node k, the problem consists in finding the polynomial coefficientsak(21) which allows recovering σgvalues at any Gauss point of patch Pk(22). Here again, the problem contains more conditions than available unknowns so it can only be satisfied in a least square sense.(21)∀x∈Pk:σ¯k(x)=Pk(x)ak(1storder)=a1k+a2k(x−xk)+a3k(y−yk)+a4k(z−zk)(22)Findaksuchthat:∀g∈Pk,σ¯k(xg)=σgAlternatively and according to the polynomial order chosen forPk,σ¯kcan be regarded as first (or second) order Taylor series expansion of σ at node k, having second (or third) order accuracy in the vicinity of k. Therefore, Eq. (22) are expected to be satisfied with an error proportional to the square (or cube) of the distance between node k and Gauss point g, so the associated least square errorΠkFD(ak)is written as follows in the linear case [34]:(23)ΠkFD(ak)=12∑g∈Pk(σg−(a1k+a2k(xg−xk)+a3k(yg−yk)+a4k(zg−zk))(Δkgr)2)2with:(Δkgr)2=(xg−xk)2+(yg−yk)2+(zg−zk)2In the frame of error estimation, it has been observed [37] that better results are obtained with(Δkgr)−4weights, rather than without weighting coefficients as in the original SPR method [12]. However, in the following, the method is still referred to as SPR method. The minimization ofΠkFD(ak)implies that(24)ΠkFD(ak)=MINbkΠkFD(bk)⇒∀n=1,…,4or10∂ΠkFD∂ank=0This will result into a 4×4 linear system (or 10×10 with a 2nd order) of equations(25)Ak.Xk=BkIn Section 2, within the element patch recovery approach, the consistency condition requiring thatσ˜(xg)is equal to σgfor any Gauss point g of the mesh was easily introduced (3). With nodal patches, this condition cannot be enforced at the patch level, although, after the P1 interpolation (15),σ˜(xg)has no reason to be equal to σg. Therefore, the consistency condition has to be enforced during theσ˜(x)interpolation. A richer P1+interpolation is so formulated to take into account the consistency. It consists in adding a hierarchical bubble function to the P1 interpolation (15); it is built by considering the sub-tetrahedra of an element that are constructed from the central integration point and lie on its facets, as shown inFig. 6. The nodal variable can thus be interpolated by using the following expression:(26)∀x′∈Ω′,σ˜(x′)=∑k∈ess.t.x⊂esandk≠gσ˜kNkes(ξ(x′))+σgNges(ξ(x′))Where esis the sub tetrahedron of e containing the pointx′ of new mesh,Nke′(ξ(x))are the sub-tetrahedron interpolation functions and g denotes the Gauss point merged with the center of element e. This P1+interpolation is slightly more accurate than the simple P1 interpolation (15) but its main quality is to provide a consistent interpolation.MatrixAkis not always invertible. This issue was described in Section 2 for element patches. It occurs more frequently with node patches, particularly when node k belongs to surface as depicted inFig. 7. To overcome such issue, Zienkiewicz et al. [12,20] suggested of using the solution of neighbor patch centered on a volume node l as shown in Fig. 7. Asσ¯linterpolation is valid on the whole patch Pland node k belongs to Pl,σ˜kcan be calculated byσ˜k=σ¯l(xk). Some arguments have been given by different researchers about which patch to choose when multiple neighbor patch solutions are available (l1 and l2 of Fig. 7). However such approximation produces a lower accuracy at the surface and tends to be diffusive.An alternative with similar consequences consists in using a lower order of recovery at the surface, from a first order to zero order interpolation, or from second order to first order. However, it is preferable to reduce the interpolation order only in necessary directions (see Fig. 2 where the gradient information is not available in the y direction only), which can be done using a regularization formulation that consists in adding a regularization termΠkR(ak)to the least square functionalΠkFD(ak)of Eq. (23)(27)ΠkRFD(ak)=ΠkFD(ak)+βΠkR(ak)with:ΠkR(ak)=12∑i=2,4(aik)2(firstorder)orΠkR(ak)=12∑i=5,10(aik)2(secondorder)where β is a small dimensional numerical coefficient.ΠkR(ak)either contains the first or second order terms that need to be regularized. TheAkRmatrix of the resulting linear system is always invertible, provided that β is large enough. On the other hand, β has to be small enough for minimizing the smoothing onσ¯kprovided by the regularization. Such approach also produces a lower accuracy at the surface.In many engineering applications, surface values are of primary importance and largest field gradients are computed close to the surface, which is especially true in metal forming applications (see Section 4 for instance) where most important phenomena such as contact and friction take place on the domain surface. Transfer operators should consequently be especially accurate with particularly high order convergence rate next to the surface.When matrixAkis not invertible, the reason is the lack of information, in other words, the lack of integration points surrounding node k. To overcome this issue, while keeping the method accuracy and convergence rate, second order neighbors have been introduced, for instance in [37], as shown in Fig. 5. This approach requires identifying a set of elements which contains not just the neighbor elements but also neighbors to the neighbor elements. Such data structure is quite difficult to build in a parallel computational environment where elements belong to different processors (within an element based partitioning approach). For instance, Fig. 5 shows how first order neighbors can belong to only two processors while second order neighbors can belong to three processors. The identification of the third processor is consequently quite indirect, so significantly increasing algorithm complexity. In addition, this approach increases further communications between processors so reducing parallel efficiency.On the other hand, first order neighbors can easily be computed within a parallel environment as described in next section. So an alternative approach to keep the method accuracy without changing the patch definition is proposed in this paper. It is an iterative algorithm which involves enriching the integration point field with the neighbor nodal field values computed at previous iteration. For example, in Fig. 7, the values at volume node l1 and l2 can be recovered but not the value of surface node k as it does not has enough neighbor elements. Therefore, a 2nd iteration for recovery is carried out. While calculating the recovered value at node k, this time, the field values at node l1and l2,σ˜l1andσ˜l2, are used along with the known values σgat integration points. The least square errorΠkFD(ak)is then enriched as given in Eq. (28). γ is a regularization coefficient close to 1 that allows providing a lesser weight to recovered nodal values with respect to element values(28)ΠkIFD(ak)=ΠkFD(ak)+γΠkI(ak)with:ΠkI(ak)=12∑l∈Pks.t.σ˜lexists(σ˜l−σ¯k(xl)Δklr2)2The γ value is selected by numerical experiments and may depend on the characteristics of the mesh. If elements of the patch have very different sizes then some nodes of the patch can be closer than the original Gauss points to the patch center, so they would have a lesser. It is more sounded to prescribe a larger weight to the original Gauss points through the γ coefficient. A similar approach was successfully used in [37] where a lower weight was allocated to second order neighbors.This method can regarded as an iterative way to enrich the size of the patch by addition of second order neighbor contributions. In the first iteration, the recovered valuesσ˜kcan be only computed for the volume nodes and for a limited number of surface nodes. In the second iteration, information of surface node patches is enriched by new valuesσ˜lavailable at volume nodes of these patches, which basically contains information from second order neighboring elements. A third iteration can be necessary for the mesh edges, and a fourth one for mesh corners. If the mesh has a very poor topology without more than one element in some space directions then it is not possible to evaluate the gradient in those directions. In this case, regularization (27) is introduced to computeσ˜kfor those remaining nodes.In parallel computations, the domain is split into several subdomains; within an element partitioning approach, the elements of one subdomain belong the same processor. Consequently, the different elements of any node patch have great chances to belong to different processors (see Fig. 5 for instance), so the construction of transfer operators requires expensive communications in order to get the integration point information from the different processors. It is then advisable to avoid building the data structure of node patches. Moreover, the matrix and second member of Eq. (25) can be constructed by an assembly procedure, like all the other matrix systems built on the partitioned finite element mesh. In other words, rather than scanning the nodes and then the elements, the assembly loop is inverted and starts by scanning the elements before affecting the Gauss point contribution to the different nodes of the element and to their respective patch recovery linear system, as presented inFig. 8. Communications are only necessary for the nodes belonging to interfaces between partitioned domains. They are carried out only once, after the parallel assembly over the different domains.Another issue which has been usually neglected in the literature is the robustness of the transfer method from the engineering stand point. When recovering the solution on a coarse mesh and having a steep gradient of the surface, recovered SPR solution is often found well outside the extremes of the fields. Although it is not an issue form mathematical point of view, it is not acceptable from engineering point of view. Therefore, in order to formulate a SPR based transfer operator for engineering applications, it is necessary to have control over the gradient of field or, in order words, to have control over maximum and minimum. Therefore the problem statement of the SPR used in the present work can be revised as(29)∀x∈P:σ¯k(x)=Pk(x)akFindaksuchthat:{∀g∈Pk,σ¯k(xg)=σgσmink−Γ≤σ˜k=a1k≤σmaxk+Γwhereσminkandσmaxkare the local extrema values on patch Pk. The Γ value is determined by the user according to the expected variations of the considered field. Usually, it is a percentage of the averaged field value. The additional engineering constraints of Eq. (29) are imposed in an iterative way. Whenever they are not satisfied, a regularization term is added to the least square functional presented in Section 3.3.2 and Eq. (27). The value of the β coefficient of (27) is iteratively increased till the constraints of (29) are satisfied.

@&#CONCLUSIONS@&#
Transfer of state variables between meshes within the frame Lagrangian or ALE formulations has been considered by using recovery techniques derived from error estimation. Rather than transferring data directly from one mesh to the other, it is built an intermediate field with higher order of continuity, higher order of interpolation and allowing satisfying weak or strong balance equations, which is then projected on new mesh. Different approaches with element as well as nodal patches have been investigated, and in this particular frame, superconvergent properties of the recovery procedure are verified. It is observed that these properties extend to transfer operators, which is shown by comparisons with standard direct operators (P0 interpolation) or with intermediate field that are not based on higher order of interpolation (simple averaging (Avg) or global least square method (LS) ). The increase of the local interpolation order on the patch results into a similar increase of the accuracy and of the convergence rate of transfer operator. For the transfer of stress tensor, the conservation of the balance equation is also shown to slightly increase the accuracy when it is enforced in a strong sense. When this condition is only weakly imposed, results are not as contrasted, so it would be useful to go further into this analysis by studying more strongly non-linear problems, in order to evaluate their possible interest as highlighted in error estimation. Therefore, the convergence rate of the transfer error with respect to the mesh size increases from less than 1 (with P0 interpolation) to 2 (with SPR, EPR1 and EPRE1) and to 3 (with EPR2), so providing very accurate methods. Element patches shows quite efficient, but in this first version they do not provide a strictly continuous interpolation and they are not easy to implement in a parallel environment. So, further studies could be dedicated to their continuity as well as to their parallelization, for instance by extending the iterative approach used with nodal patches.For a wide range of problems, such as in metal forming applications, a large part of phenomena originates from the surface where the gradients of state variables are larger, while standard patch recovery techniques are much less accurate for surface values. Using extended patches including second order neighboring elements allows improving the quality of surface recovery, but this approach is not easy to extend to parallel calculations, so the proposed iterative method provides a better way to achieve such accuracy by enriching the quantity of information available on nodal patches. It is observed that resulting accuracy and convergence rate are the same for surface and volume fields. For coarse meshes, when there is not enough information to compute local gradient or Hessian, the patch recovery approach is made robust by a regularization approach so decreasing the interpolation order in certain directions only. On coarse meshes, this approach is also used to reduce the gradient intensity when recovery provides too strong gradients with respect to the engineering constraint of getting reasonably bounded solutions.In summary, it is considered that the proposed superconvergent patch recovery methods solve most of the expectations for robustness and accuracy of transfer operators: transfer accuracy for volume as well as surface variables, conservation of balance equation, compatibility with parallel calculations, robustness with respect to mesh size and mesh topology and consistency of results with respect to engineering expectations.