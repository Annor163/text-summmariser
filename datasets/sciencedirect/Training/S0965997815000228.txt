@&#MAIN-TITLE@&#
Visualization of cracks by using the local Voronoi decompositions and distributed software

@&#HIGHLIGHTS@&#
Local Voronoi decompositions are applied to extraction of crack surfaces.Cracks propagate in mono-dispersed particulate media simulated by the DEM.The geometry of crack surfaces is accurately defined by faces of the decomposition.Generation of local decompositions rather than global meshes reduces execution time.The sufficiently high speed-up of distributed visualization software is achieved.

@&#KEYPHRASES@&#
Distributed visualization,Surface extraction,Propagating cracks,Discrete element method,Mono-dispersed particles,Local Voronoi decomposition,

@&#ABSTRACT@&#
The paper presents a novel visualization technique for cracks propagating in mono-dispersed particulate material. The proposed technique is based on local space decompositions generated in fractured areas. The contact surfaces of the neighboring particles are defined by the local Voronoi decomposition generated according to the lattice topology employed in computations of the discrete element method. The visual model validation helps to indicate the regions of a highly deformed lattice, where the defects detected between the pairs of the neighboring particles on the lattice connections cannot be directly mapped onto the relevant edges of the Voronoi diagram. The parallel implementation of the visualization technique is based on the domain decomposition and two layers of ghost vertices and connections. The technique is implemented in the distributed visualization software VisPartDEM. Datasets of the elastic solid problem exhibiting non-uniform distribution of fracture force values are considered to validate the performance of the proposed technique. The parallel speed-up of the visualization software is investigated. The superior performance of the applied local technique is compared to the performance observed by using the standard global Voronoi algorithm.

@&#INTRODUCTION@&#
The discrete element method (DEM), introduced by Cundall and Strack [1], is widely used in numerical analyses of particulate media from the perspective of science and engineering. DEM is based on a Lagrangian approach, where motion of individual particles is calculated according to the Newton’s second law of motion. The contact forces between two particles are determined from the overlap and relative movements of the particle pair according to a specified force–displacement law. DEM can simulate the behavior of discrete particles, such as grain, soil and powder, as well as the fracture of non-continuous brittle mediums, such as rock, concrete and laminated glass [2–4].Several different particle- and lattice-based approaches have been developed in the frame of DEM applied to the simulation of solids and fracture. The particle-based approach [5,6] replaces a solid with a composition of discrete particles, where the presence of the cohesive forces acting between the particles and various mechanisms of their linkage and detachment may be allowed. The approach, where the material particles interact via the network elements, connections or bonds, can be referred to as the lattice-based model [7]. A comprehensive review of the planar elastic lattice models for micro-mechanical applications is given by Ostoja-Starzewski [8]. The lattice-based DEM [9] and the bonded particle model [10] have been extensively applied to the simulation of heterogeneous solids to study their fracture problems. The lattice-based DEM can take into account most kinds of discontinuities and material failure characterized with multiple fracture which makes it an effective tool to study fracture phenomena.DEM computations are based on the positions of particles and forces acting between them. The lattices employed in DEM computations are assembled from the 1D springs or beams which are not well suited for the reliable interpolation and common visualization techniques used in 3D. Based on the described approach, the defects between the pairs of the neighboring particles are identified by the broken lattice connections or bonds [9,10]. The main visualization task is to construct the surfaces of cracks from the broken lattice connections and the geometry of the neighboring particles. The complex disjoint surfaces of cracks and the unavailability of a suitable scalar field defining the crack surfaces limit the application of the widely used surface extraction methods. Thus, there is hardly any direct technique of constructing the surfaces of propagating cracks from individual defects determined between the neighboring particles and applying the available visualization methods. Moreover, the commercial finite element analysis software widely used by engineers can import only continuously defined crack surfaces represented by usual graphic primitives. The successful research into the problems of representation and visualization of crack surfaces can help to fill the gap between the industrial requirements and the research results currently obtained in the areas of fracture mechanics and material sciences.The technique based on the local Voronoi decomposition is applied to visualize cracks, propagating in mono-dispersed particulate media. Local Voronoi decompositions, serving as the contact surfaces of the neighboring particles, are generated according to the lattice topology employed in computations. The model validation is developed to identify the regions of a highly deformed lattice, to which the Voronoi decomposition-based techniques cannot be directly applied because of inconsistency between the lattice connections and the faces of the Voronoi diagram. This paper is mainly based upon the work of Kačeniauskas et al. [11], however, the following additional research was made: the visualization technique was extended to 3D, the new 3D benchmark was considered and parallel implementation of the visualization technique based on the domain decomposition was investigated.The paper is organized as follows. The related works are discussed in Section 2. The mathematical model of the lattice-based DEM is outlined in Section 3. The visualization technique based on the local Voronoi decomposition is presented in Section 4. The details of implementation and the employed software are provided in Section 5. The obtained results and performance are discussed in Section 6, while the concluding remarks are given in Section 7.Cracking is a very common phenomenon investigated by a wide research community in different scientific areas. In computer graphics, crack patterns can be applied to ceramics [12], to soil [13] and, more generally, to any object represented as a 3D mesh [14]. Geometric models propose algorithms to get crack patterns close to those produced by nature [15]. In contrast, physical approaches propose the models which tend to accurately simulate the dynamics of natural crack patterns. O’Brien et al. [14] succeeded in modeling brittle and ductile fractures by means of the finite element method. A dynamic model of crack development based on the 3D discrete shrinkage volume propagation is proposed by Valette et al. [16]. Comprehensive review articles [17–19] summarize models and approaches for simulating crack growth in many fields of engineering. The lattice-based DEM provides a valuable insight into the fracture phenomena at the particle level [9,10].Computer graphics scientists focus their attention on enhancing the realism of natural scenes, while computational researchers concentrate on building accurate numerical models. Furthermore, their principal aim is not closely related with visually attractive results. In the lattice-based DEM methods, cracks and the related phenomena are often visualized in the most straightforward way. The particles are often colored depending on particular scalar attributes, such as the initial high altitude or radii [20–23]. The propagation of large cracks is illustrated by using the rendered geometry of particles [24]. However, this technique can be applied only to large cracks which are of the particle size. The colored lattice connections [9,23] can be treated as the main alternative to the rendered particles. The broken connections between the neighboring particles indicate the fractured regions, but do not provide any valuable information on the formation of the crack surfaces. The application of the finite elements or the Voronoi polyhedra allows us to color the elements or cells [25]. However, the absence of the defined crack surfaces limits visual analysis of the computed results and reduces the understanding of the investigated fracture phenomena.The problem of reconstructing a surface from a set of sample points is motivated by numerous applications and, consequently, has always been a popular field of research. Most surface reconstruction methods roughly fall into two major categories: implicit surface methods [26,27] and Delaunay-based methods [28,29]. The most common approach to surface reconstruction is based on the Delaunay triangulation: the underlying idea is that, when the sampling is noise-free and dense enough, points close on the surface should also be close in space. Among the Delaunay-based methods, the most well-known algorithms are, preferably, the Crust [28] and the Cocone [29] families of algorithms. Another approach that directly extracts smooth surfaces from unstructured point-based volume data without prior resampling or mesh generation is proposed by Rosenthal and Linsen [27]. In the case of lattice-based DEM methods, the discussed surface extraction algorithms cannot be directly applied because of the absence of suitable data defining the crack surface and the complex nature of crack surfaces, defined by the scattered results of numerical computations at the micro-level. The holes and disjoint pieces of crack surfaces make surface extraction extremely complicated.The Voronoi diagrams can be applied to post processing of particle systems as well as to lattice forming. Given a set of primitives, the Voronoi diagram partitions space into regions, where each region consists of all points that are closer to one primitive than to any other. The Voronoi diagrams have important applications in many sciences, including visualization of medical datasets, proximity queries, spatial data manipulation, shape analysis, computer animation, robot motion planning, modeling spatial structures and processes, pattern recognition, locational optimization and selection in user-interfaces [30,31]. A concept of the Centroidal Voronoi tessellation was presented in the form of graphs in [32]. The edges of radical Voronoi diagrams were employed to construct a beam–network model for autoclaved aerated concrete [33]. Computational lattices for poly-dispersed particulate media are assembled according to the Voronoi diagrams by Cusatis et al. [23]. However, there were no attempts to describe the contact surfaces of particles and to visualize the propagating cracks by using local space decompositions based on the Voronoi cells.The motion of the visco-elastic particle system is governed by the Newton’s second law, i.e.(1)mid2xidt2=Fi,(2)Iid2θidt2=Ti,where mi, and Iiare the mass and the moment of inertia of the particle, respectively, while vectorsxiandθidefine the position of the particle center and the orientation of particle i. The vectorsFiandTipresent the sum of the contact force and the gravity force as well as the respective torques:(3)Fi=∑j=1,j≠iNFij,cont+mig,(4)Ti=∑j=1,j≠iNTij=∑j=1,j≠iNdcij×Fij,cont,wheregis the acceleration due to the gravity,dijis the vector pointing from the particle center to the contact center. The interparticle force vectorFij,cont, describing the contact between the particles i and j, may be expressed in terms of normal and tangential components. The normal component, presenting a repulsion force, comprises elastic and viscous ingredients, while the tangential component reflects static or dynamic frictional behavior. The static force describes friction prior to gross sliding and comprises elastic and viscous ingredients, while the dynamic force describes friction after gross sliding and is expressed by the Coulomb’s law.For evaluating the contact forces (3–4), all contacts between the particles and their neighbors must be detected. A cell-based method is used for contact detection. The numerical integration of the equations of motion (1–2) is performed to obtain the dynamical state of all particles at the time t, resulting from the action of the particle forces (3–4). The solution of these equations is obtained by using the Verlet scheme. The details of these procedures can be found in [6].In the present work, the materials are modeled using the elastic perfectly brittle model of contact interaction. The lattice-based discrete element model assumes cohesive bonding between the neighboring particles [4,10]. These lattice connections represented by springs can be broken under excessive loading, which allows us to simulate initiation and propagation of the material fracture. When two particles are bonded, the contact force in normal direction is calculated from the linear constitutive relationships:(5)Fn,cont=knunwhereFn,contis the normal contact force, knis the spring stiffness in the normal direction, unis the normal relative displacement. The lattice connections are broken instantaneously, when the interface strength is exceeded in the normal direction by the tensile contact force. The failure criterion can be written as(6)Fn,cont⩽Rnwhere Rnis the interface strength in the normal direction. Although a compressive interaction force between the particles does not cause breakage of the connections, the material damage under macroscopic compression can be represented properly in the particle model. A compressive macroscopic load brings about tensile interactions at the microscopic level which may lead to connection failures.After breakage of connections, a normal contact force is calculated, using the Hertz contact model [34]. A frictional interaction can occur among the particles in the case of compression. The limiting friction force is evaluated, assuming the Coulomb model of friction:(7)Ft,cont=μFn,cont,where μ is the Coulomb friction coefficient. The simple mathematical model (1–7) of the lattice-based DEM is provided for the sake of completeness. However, the simulation results will not be examined in detail because the presented research is concentrated on the surface extraction and the proposed visualization technique.The visualization technique based on the local Voronoi decomposition has been developed for the analysis of propagating cracks. The applied technique plots the crack on the contact surfaces obtained from local decompositions. During DEM computations, the defects are identified between the pairs of the neighboring particles on the lattice connections. The broken lattice connections should be directly mapped onto the generated faces. The consistency of the generated faces of the Voronoi decomposition and the relevant lattice connections should be verified in the case of the highly deformed lattice. The standard algorithms for generating the global Voronoi diagrams are hardly applicable to visualization of cracks because they use the coordinates of points, but do not take into account the lattice topology.A general schema of the algorithm developed for generating the local Voronoi decompositions is presented in Fig. 1. The algorithm can be divided to five stages: preparation of data structures and kd-tree [35], identification of fractured regions that are necessary to cover by local Voronoi decompositions, generation of Voronoi cells, validation of generated cells and mapping of the attributes of the lattice connections onto the relevant edges of Voronoi cells. Data structures for loops, running through the particle neighbors, which are joined to the considered particle by the lattice connections, are prepared at the beginning. The next module constructs the kd-tree [35], which is used for visual model validation at other stages of the algorithm. A loop, running through all lattice connections, starts the identification of fractured regions. The following condition checks if the current connection is broken. The cells of the local Voronoi decomposition are generated only around the end nodes of the broken connections, therefore, the next loop runs through two end nodes of the current connection. The next condition checks if the current node has not been processed yet because the Voronoi cell can be already generated around this node processing another broken connection attached to it. The following module generates the Voronoi cell around the particle center represented by the processed node of the current connection. Each Voronoi cell is created around the node according to the available data on the node neighbors. The implemented algorithm [36] is based on the clipping of the whole domain by perpendicular planes drawn through the midpoints between the considered node and its neighbors.All faces of the generated Voronoi cell are validated by the orange module, which will be described in the following subsection. The loop, running through the valid faces of the generated Voronoi cell, finishes processing of the generated contact surfaces. The following module maps the attributes of the lattice connections onto the relevant suitable faces of the generated Voronoi cell. In the 2D case, the attributes of the lattice connections are mapped onto the relevant edges of the cell. When the Voronoi cells are created around both end nodes of all broken connections, the main computations are finished. The last module prepares the output for visual model validation. Three orange modules (Fig. 1) used in model validation will be described in the following subsection.Visualization of crack surfaces is a challenging problem, while the application of the Voronoi decomposition-based techniques is hardly possible in the regions of the highly deformed lattice. It is worth mentioning that the most of computational models also have limitations in such complex cases. In the lattice-based DEM computations, the lattice topology does not change in time, while the particles can significantly change their positions. The particles have more freedom to move and to deform the lattice in the regions containing a lot of broken connections. Thus, after a certain period of time, the lattice topology might become inconsistent with respect to the cells of a standard Voronoi diagram. Fig. 2a illustrates the case, when the stationary lattice topology became inconsistent with a changing global Voronoi diagram. Blue tubes represent the edges of the generated decompositions, while red tubes visualize cracks relevant to the broken lattice connections. The broken yellow connection of the stationary lattice joins the centers of the particles 2 and 4, while the algorithm for generating the standard Voronoi diagram takes into account the fact that the distance between the centers of the particles 1 and 3 is shorter and does not generate the edge perpendicular to the broken connection. The available cyan edge represents the contact surface between the particles 1 and 3. The observed inconsistencies do not allow the direct mapping of the attributes of the lattice connections onto the relevant edges of Voronoi cells. Therefore, the global Voronoi diagrams cannot be applied to crack visualization in the regions of the highly deformed lattice. Fig. 2b shows that, in such regions, the local Voronoi decomposition generated according to the stationary lattice topology contains the overlapped cells and introduces the numerical error.In this work, the performed validation is based on the well-known property of the Voronoi diagrams described as follows: for each vertex q of the Voronoi diagram, there exists a unique empty sphere centered on q, which passes through at least four nodes and is the largest empty sphere centered on q[30,31]. Fig. 3presents the algorithm for validation of each generated Voronoi cell while Fig. 4shows an explanatory schema of visual model validation in 2D.A loop, running through all the vertices of the considered Voronoi cell, starts the validation. The sphere is defined by the center located in the considered vertex and the radius, which is equal to the distance from the considered vertex to the node representing the center of the Voronoi cell. Fig. 4a shows validation of two vertices of different Voronoi cells by using two illustrative circles. The green circle is defined by the center located in the considered vertex (green point) and the radius equal to the distance from the vertex to the node 1 in the center of the Voronoi cell. The magenta circle is defined by the center located in the considered vertex (magenta point) and the radius, which is equal to the distance from the vertex to the node 3 in the center of the Voronoi cell. The query to the initially prepared kd-tree structure provides the number of nodes belonging to the solid sphere. The considered vertex is marked as suitable for the Voronoi decomposition if none of the nodes of the lattice is located inside the solid sphere. In other cases, the processed vertex does not satisfy the required conditions of the Voronoi diagram. In Fig. 4a, the lattice nodes 1, 2 and 4 are located on the green circle, but the node 3 violates the required condition, because it is located in the interior of the circle. The lattice node 1 is located in the interior of the magenta circle. Thus, both verified vertices are marked as unsuitable for the Voronoi decomposition. Usually, this can be observed in the regions of the highly deformed lattice, where the lattice connection cannot be directly mapped onto the Voronoi face. The end of the loop, running through all vertices of the considered Voronoi cell, finishes the consistency check.The following loop, running through all faces of the considered Voronoi cell, is used to mark the suitable faces of the Voronoi cell and the appropriate connections of the lattice. If the considered face is a boundary face, marking is not performed. The next condition checks all the vertices of the considered face. If all vertices have been marked as suitable, the entire face is marked as suitable. Otherwise, the connection, corresponding to the considered face, would be marked as belonging to the region of the highly deformed lattice, which could not be accurately visualized by using the Voronoi cells. The end of the loop, running through all faces of the considered Voronoi cell, finishes the marking procedure. Fig. 4b demonstrates how the visual model validation helps to indicate the regions of the highly deformed lattice by plotting marked connections as yellow tubes. The model validation also prevents the appearance of the overlapped cells. It is worth noting that all validation modules can be removed from the pipeline to save computational time in the case of small geometric deformations in the lattice.

@&#CONCLUSIONS@&#
The paper presents the local Voronoi decomposition-based technique and distributed software for visualization of crack geometry on the contact surfaces between the neighboring particles. The performed visualization benchmark based on the elastic solid problem demonstrated the ability of the proposed technique and the developed software to visualize crack propagation and fracture formation modeled in mono-dispersed particulate media. The performance analysis revealed that generation of the local Voronoi decompositions consumed 72.2% and 85.1% of the total visualization benchmark time in the case of the last time step of the 2D and 3D datasets, respectively. The quantitative comparison showed that the distributed software, based on the local decompositions, significantly outperformed the code based on the global Voronoi diagrams. In visualizing the last time step of the 3D dataset, the generation of the local Voronoi decomposition, containing 15.5% faces of the global Voronoi diagram, took 19.1% of the time consumed by the global Voronoi filter. The number of the inconsistencies between the lattice connections and the faces of the local Voronoi decomposition did not exceed 0.26% of the number of the lattice connections. The sufficiently high speed-up of parallel visualization was achieved by employing a small number of processes. However, the scalability and the perfect load balancing are limited because of the highly changing visualization load, which is concentrated in the relatively small fractured area occupied by the propagating crack.