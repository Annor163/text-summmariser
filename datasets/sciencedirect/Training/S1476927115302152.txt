@&#MAIN-TITLE@&#
Comparison of approaches for parameter estimation on stochastic models: Generic least squares versus specialized approaches

@&#HIGHLIGHTS@&#
Parameter estimation is demonstrated for a stochastic bistable genetic toggle switch.Conventional parameter estimation methods do not perform well for models with substantial intrinsic stochasticity.Parameter estimation for stochastic models can be done in a computationally efficient manner.

@&#KEYPHRASES@&#
Stochastic models,Parameter estimation,Systems biology,Identifiability,

@&#ABSTRACT@&#
Parameter estimation for models with intrinsic stochasticity poses specific challenges that do not exist for deterministic models. Therefore, specialized numerical methods for parameter estimation in stochastic models have been developed. Here, we study whether dedicated algorithms for stochastic models are indeed superior to the naive approach of applying the readily available least squares algorithm designed for deterministic models.We compare the performance of the recently developed multiple shooting for stochastic systems (MSS) method designed for parameter estimation in stochastic models, a stochastic differential equations based Bayesian approach and a chemical master equation based techniques with the least squares approach for parameter estimation in models of ordinary differential equations (ODE). As test data, 1000 realizations of the stochastic models are simulated. For each realization an estimation is performed with each method, resulting in 1000 estimates for each approach. These are compared with respect to their deviation to the true parameter and, for the genetic toggle switch, also their ability to reproduce the symmetry of the switching behavior. Results are shown for different set of parameter values of a genetic toggle switch leading to symmetric and asymmetric switching behavior as well as an immigration-death and a susceptible-infected-recovered model. This comparison shows that it is important to choose a parameter estimation technique that can treat intrinsic stochasticity and that the specific choice of this algorithm shows only minor performance differences.original data (red),stochastic simulations with the MSS estimates (blue) andstochastic simulations with the LSQ estimates (dashed blue).Parameter name (column 1),true parameter value (column 2),averages of MSS estimates (column 3):Mean=1N∑i=1NθˆiMSS,average relative errors of MSS method (column 4):ARE=1N∑i=1N|θˆiMSS−θ0|θ0,average of the LSQ estimates (column 5):Mean=1N∑i=1NθˆiLSQ,average relative errors of the LSQ method (column 6):ARE=1N∑i=1N|θˆiLSQ−θ0|θ0,average of the SDE estimates (column 7):Mean=1N∑i=1NθˆiSDE,average relative errors of the SDE method (column 8):ARE=1N∑i=1N|θˆiSDE−θ0|θ0.

@&#INTRODUCTION@&#
Parameter estimation is very important for the analysis of models in systems biology. Computational modeling is a central approach in systems biology for studying increasingly complex biochemical systems. Progress in experimental techniques, e.g. the possibility to measure small numbers of molecules in single cells Raj and van Oudenaarden (2009) makes it possible to observe behavior that can only be explained by taking into account the intrinsic stochasticity of the underlying processes, leading to a need for stochastic modeling approaches. Simulation methods for stochastic processes have been developed for decades since (Gillespie, 1976) and nowadays exist with a lot of variants (Pahle, 2009). On the other hand, parameter estimation for stochastic models is a less mature field. The wide availability of software for parameter estimation in deterministic models (compared to specialized stochastic methods) may lead to an application of these methods even when the underlying data shows indications of intrinsic stochasticity. The question arises whether this naive approach (using a method designed for deterministic models to determine parameters of stochastic models) is acceptable, or whether specialized approaches are required for satisfactory results.We compare, with three example models, the performance of dedicated stochastic parameter estimation methods with a least squares method designed for deterministic models. An important property of stochastic processes (and of their models) is that they can show behavior that is qualitatively different from the behavior of a corresponding deterministic model. One example for such a qualitatively different behavior is random switching between different states that in an ODE model would each be stable steady states. For this study we chose the stochastic model of a genetic toggle switch (Gardner et al., 2000) as a prototype model for such a switching behavior. Using this model, and an immigration-death as well as an epidemics model, we compare the multiple shooting for stochastic systems (MSS) approach (Zimmer and Sahle, 2012), a stochastic differential equation (SDE) based Bayesian approach (Golightly and Wilkinson, 2005) and a chemical master equation (CME) technique for parameter estimation in stochastic models with a least squares (LSQ) approach.The problem for parameter estimation for stochastic models can be written in the following form: we assume that the experimental or simulated data measures at each time point ti, i=1, …, n, the number of molecules of species νiin the system, henceνi∈ℕ0. Each data set ν=(ν1, …, νn) is stochastic. This means that even two simulated realizations of the system without assumption of measurement noise can be different. Fig. 1illustrates that the behavior of the stochastic genetic toggle switch shows a switching behavior while the ODE model rapidly converges towards a steady state. This means that the behavior of the stochastic model is qualitatively different. Furthermore, it is assumed that the system's behavior depends on some unknown parametersθ∈ℝqwhich are to be estimated. To this goal the data ν is compared to simulations with respect to some objective function F which measures the quality or the error of the fit. Parameter estimation means finding the optimal valueθˆfor the parameter. For models of ODE the choice of the objective function has been widely discussed (Jaqaman and Danuser, 2006) and in case of normally distributed measurement error the common choice is a least squares function. Even in cases where the distribution of the error is not well known, a least squares approach is commonly used because it is widely available in software implementations.Approaches using stochastic simulations and density estimation methods can be found in Tian et al. (2007) and Poovathingal and Gunawan (2010), a reversible jump algorithm (Boys et al., 2008) together with Bayesian methods or a stochastic gradient descent in Wang et al. (2010). Using a surrogate probabilistic model as an approximation is faster from a computational point of view (Henderson et al., 2010). A second class of methods focuses on a numerical solution of the Chemical Master equation (CME), which describes the probability for each state as a function of the time. As the state space might be infinite, state space truncation can be used (Andreychenko et al., 2011) or moment-closure methods, which are an approximation focusing on a finite number of moments of the probability distribution (Gillespie, 2009; Gillespie and Golightly, 2010). If distribution information is available from measurement a finite state projection (Munsky and Khammash, 2010) can be used to solve the CME without simulations. The common challenge is the fact that the solution of the CME as well as simulation-based methods becomes very time-consuming as the number of states in the state space becomes larger.The MSS approach (Zimmer and Sahle, 2012) used in this article splits the time course into intervals that are treated separately. The initial values for each interval are calculated by state updating. The MSS method is motivated by a method proposed by Bock (1981) for the parameter estimation in systems of ordinary differential equations (ODE), further developed (Schlöder and Bock, 1983) and already successfully applied to deterministic systems with chaotic behavior (Baake et al., 1992; Kallrath et al., 1993). The method can tackle models with fully observed and partially observed data sets. The fact that it works without stochastic simulations and without solving a high dimensional chemical master equation (CME) means that it is possible to approach systems of a size as large as realistic models being tackled with ODEs. This is a main advantage in comparison with simulation or CME based methods. In Zimmer and Sahle (2012) examples are shown which compare the MSS method to the reversible jump algorithms (Boys et al., 2008; Wang et al., 2010) demonstrating that the increase in speed does not lead to a loss in accuracy. The approach is implemented in the widely used software package (Hoops et al., 2006) which allows the user to access all model import and analysis features of this well established software.We also implemented a second approach that is suited for parameter estimation in stochastic models: a diffusion approximation that uses latent data points to treat unobserved components and a Bayesian framework for sampling these latent components as well as the parameters (Golightly and Wilkinson, 2005). A third approach is based on the chemical master equation. It is exact but requires a computational effort that can only be mastered for small models.Since the objective function of the MSS method is deterministic the estimate for a single stochastic time course is unambiguous. This is also the case for the CME method and the LSQ method and, at least for infinite run time of the Markov chain, also for the Bayesian approach. But, using the same model with the same parameters and initial conditions, another stochastic time course realization will look different due to the intrinsic stochasticity and, therefore, the estimation will result in a different value. To compare both objective functions, it is, therefore, necessary to estimate more than one stochastic realization of the same model with the same parameters and initial conditions. This article uses 1000 different simulated realizations. A statistic over the 1000 estimations can then be used to assess the quality of the objective function. The quality is assessed with displaying relative errors. Furthermore, the estimated parameters of the genetic toggle switch are used to carry out new stochastic simulations and compare their symmetry of the switching behavior to that of the true parameters. It has to be underlined that the 1000 realizations are only used to test the quality of the objective function. For an estimation one realization is sufficient.The article is structured as follows:The method section will briefly introduce stochastic modeling and review the dedicated stochastic parameter estimation approaches as well as the LSQ approach. The results section will show the performance of the methods on several sets of parameter values of a stochastic model of a genetic toggle switch. Three sets of parameter values of an immigration-death model illustrate the conditions under which the dedicated stochastic methods have the strongest advantage against the least squares approach. The conclusion section will give some concluding remarks.

@&#CONCLUSIONS@&#
