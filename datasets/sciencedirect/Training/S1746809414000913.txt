@&#MAIN-TITLE@&#
Barker coded excitation with linear frequency modulated carrier for ultrasonic imaging

@&#HIGHLIGHTS@&#
The limitations of conventional Barker coded excitation are studied.A novel Barker coded excitation with LFM carrier (called LFM-Barker) is proposed.Pulse compression scheme for the LFM-Barker is developed to suppress sidelobes.The LFM-Barker is simulated and compared with conventional Barker coded excitation.Simulation results show the significant improvements in SNR and axial resolution.

@&#KEYPHRASES@&#
Ultrasound imaging,Barker coded excitation,LFM carrier,Pulse compression,Axial resolution and SNR improvements,

@&#ABSTRACT@&#
A new Barker coded excitation using linear frequency modulated (LFM) carrier (called LFM-Barker) is proposed for improving ultrasound imaging quality in terms of axial resolution and signal-to-noise ratio (SNR). The LFM-Barker coded excitation has two independent parameters: one is the bandwidth of LFM carrier, and the other is the chip duration of Barker code. To improve the axial resolution, increase the bandwidth of LFM carrier; and to improve the SNR, increase the chip duration of Barker code. In this study, a LFM pulse with proper (<5.5) time–bandwidth product is considered as the carrier in order to avoid sidelobes inside the mainlobe of matched filtered output. A pulse compression scheme for the LFM-Barker coded excitation is developed, and it consists of the LFM matched filter and Barker code mismatched filter. In the simulations, the impulse response of transducer can be approximated by a Gaussian shaped sinusoid with 5MHz central frequency of 60% −6dB fractional bandwidth. The pulse compression filter is performed to suppress sidelobes below −40dB roughly, which is acceptable in medical imaging. Simulation results show that in comparison with conventional Barker coded excitation using sinusoid carrier (called Sinusoid-Barker), the axial resolution of the LFM-Barker coded excitation system can be doubled, and the SNR can be improved by about 3dB. Simulation of B-mode images with the Field II program demonstrates that the axial resolution is improved from 0.7mm to 0.4mm. In addition, the LFM-Barker coded excitation is robust for frequency dependent attenuation of tissues.

@&#INTRODUCTION@&#
Ultrasound imaging is an important medical imaging modality, and is often used for many diagnostic purposes, mostly considering that it is safe and produces real-time images [1], moreover less expensive and simpler in use than other imaging techniques [2,3]. Axial resolution and signal-to-noise ratio (SNR or penetration) are crucial factors to consider in evaluation of the image quality of ultrasound system. It is well known that the axial resolution can be improved by increasing the frequency of the transmitted ultrasound. Unfortunately, the energy of ultrasound is attenuated when propagating through tissues. Generally the attenuation of ultrasound in tissues is frequency dependent, and increases as the frequency increases. Therefore, the improvement in the axial resolution results in limited penetration depth and a decrease in SNR of the received signals due to the higher attenuation coefficients.On the other side, the improvement in SNR can be achieved by increasing the total ultrasound energy input into the system, by increasing either the pulse amplitude or pulse duration. In medical ultrasound, safety requirements limit the peak amplitude of the pulse in order to avoid heating and cavitation damages within the insonated human body [4,5]. Therefore, the way to improve the SNR is to excite the transducer with a long and modulated pulse (coded excitation) in the transmitter, which allows increasing the average transmit power without increasing the peak amplitude of the pulse. Moreover, in the receiver, the echoes of the long pulses can be compressed (decoded) with pulse compression filter to restore the axial resolution.Coded excitation technique is often used in medical ultrasound for improving the SNR and increasing the penetration depth. It has been studied and applied to medical ultrasound for almost 10 years [6–14]. A variety of coded excitations have been developed, including the linear frequency modulated (LFM) signal or nonlinear frequency modulated signal [6–8], and the phase coded signal, such as Barker codes [9,10], m-sequences [11] and Golay complementary sequences [12], and the amplitude modulated signal [13,14]. They can be basically categorized according to their modulation functions into three types: frequency modulation, phase modulation and amplitude modulation. Generally, a coded waveform uses only one of modulation functions. For example, Barker coded signal uses the bi-phase modulation, and the LFM coded signal uses the linear frequency modulation.In this paper, we focus on improving the performance of Barker coded excitation. Conventionally Barker code is modulated with a single-frequency carrier of sinusoidal wave, and the Barker coded excitation using the sinusoid carrier (called Sinusoid-Barker) has the advantages of simpler pulser and lower cost compared with the LFM coded excitation [15]. However, its frequency spectrum cannot accord well with ultrasound transducer frequency spectrum. Moreover, the single-frequency carrier of sinusoidal wave has the time–bandwidth (TB) product on the order of one, and hence the gain in SNR (SNRG) through the Sinusoid-Barker coded excitation can be only achieved by Barker code length [16]. Theoretically, Barker coded waveforms with longer code length give better SNRG. Unfortunately, the Barker-13 (i.e. the code length is 13) is the longest Barker code available, and the Barker-13 coded excitation can achieve 11.1dB SNRG [17]. Therefore the SNRG is limited for the Sinusoid-Barker coded excitation. In addition, the Sinusoid-Barker coded signal has frequency-shift sensitivity [9]. Because of frequency dependent attenuation of tissues, it cannot be well applied in medical ultrasound.Due to the drawbacks of conventional Sinusoid-Barker coded excitation, a new Barker coded excitation using the LFM pulse as the carrier (called LFM-Barker) is proposed in this paper. The LFM-Barker coded signal uses two types of modulation functions. Within every chip of Barker code, it uses the linear frequency modulation. Between chips of Barker code, it uses the Barker phase modulation [18]. The LFM pulse as the carrier is flexible to control its frequency spectrum according to the impulse response of ultrasound transducer, and it has the TB product on the order of above one [7]. Hence, the SNRG through the LFM-Barker coded excitation can be achieved not only by the Barker code length but also by the TB product of LFM carrier. Moreover, the LFM signal has the advantage of frequency-shift tolerance [7].However, the major problem associated with coded excitation is the range sidelobe artifacts [7–10,19]. In the Barker-13 coded excitation system, the peak sidelobe level (PSL) of matched filtered output is −22.3dB below the mainlobe, which is not tolerated in medical ultrasound imaging. In this study, the mismatched filter for the LFM-Barker coded excitation is developed to decode the received echo and suppress the sidelobe level.In this paper, basic concepts and expected benefits of the LFM-Barker coded excitation are presented. The two Barker coded excitations using the LFM carrier and sinusoid carrier, respectively, are compared in simulation experiments. Section 2 gives the representations of the LFM-Barker coded excitation and introduces the mismatched filter for pulse compression. The optimized coded excitation/pulse compression scheme was simulated to verify the quality of ultrasound imaging in Section 3. Section 4 draws the final conclusions.

@&#CONCLUSIONS@&#
In this study, we propose a new LFM-Barker coded excitation for ultrasound imaging. The LFM-Barker coded excitation has two parameters, which are the bandwidth of LFM carrier and the chip duration of Barker code. The effects of the bandwidth of LFM carrier and the chip duration of Barker code on the compressed pulse are studied to improve the image quality of the axial resolution and the SNR, respectively. For conventional Sinusoid-Barker coded excitation, only one parameter (i.e. the chip duration of Barker code) can be adjusted. The bandwidth of sinusoid carrier is only determined by the chip duration of Barker code. When the chip duration of Barker code increases, the transmitted energy increases and the SNR is improved. However, the bandwidth of sinusoid carrier decreases, and the axial resolution is degraded. In comparison, the proposed LFM-Barker coded excitation can increase the chip duration of Barker code to improve the SNR, and increase the bandwidth of LFM carrier to improve the axial resolution at the same time.In the simulation experiments, in comparison with conventional Sinusoid-Barker coded excitation, the axial resolution of the LFM-Barker coded excitation system is doubly improved when its chip duration of Barker code is the same as that of the Sinusoid-Barker coded excitation and the bandwidth of LFM carrier is set to be as large as possible. It is worth noting that, when the bandwidth of LFM carrier increases for the improvement in the axial resolution, the transducer largely attenuates the coded signal, resulting in a loss in the SNR. When the SNR is almost ensured to be the same for both coded excitations, the axial resolution of the LFM-Barker coded excitation system is evidently improved. When the axial resolution is ensured to be the same for both coded excitations and the chip duration of Barker code for the LFM-Barker coded excitation is set to be as large as possible, the SNR of the LFM-Barker coded excitation system is improved by about 3dB. Simulation of B-mode images with the Field II program demonstrates that the axial resolution is improved from 0.7mm to 0.4mm.When the chip duration of Barker code for conventional Sinusoid-Barker coded excitation is large enough to ensure the high SNR, the bandwidth of sinusoid carrier is accordingly decreased, thereby degrading the axial resolution. At this time the LFM-Barker coded excitation has the advantage of improving the axial resolution. Likewise, when the bandwidth of sinusoid carrier is large enough to ensure good axial resolution, the chip duration of Barker code is accordingly decreased, thereby degrading the SNR. At this time the LFM-Barker coded excitation has the advantage of improving the SNR. Moreover because of the LFM frequency-shift tolerance, the LFM-Barker coded excitation can be applied in presence of frequency dependent attenuation.In conclusion, the new Barker coded excitation using the LFM pulse as the carrier instead of the sinusoid carrier is proposed in this paper. Pulse compression scheme of the LFM-Barker coded excitation that consists of the LFM matched filter and the Barker code mismatched filter is developed. In the simulations, the pulse compression filter is performed to suppress the sidelobes below −40dB roughly, which is acceptable in medical imaging. In comparison with conventional Sinusoid-Barker coded excitation, the simulation results reveal that the LFM-Barker coded excitation can improve the axial resolution by increasing the bandwidth of LFM carrier, and can improve the SNR by increasing the chip duration of Barker code. The simulation of B-mode imaging was carried out to demonstrate the advantage of the proposed LFM-Barker coded excitation in improving the axial resolution. However, it requires a relatively complex pulser due to the complexity of LFM signal. As such, for the LFM carrier with a relatively broad bandwidth, it needs a relatively high operating frequency for both transmission and reception, which increases the computational complexity of signal processing and hardware cost of the imaging system. In an actual ultrasound imaging system, frequency-dependent attenuation and nonlinear propagation in tissue may degrade the LFM-Barker code performance particular to the SNR and sidelobe level. In our future work, the LFM-Barker coded excitation with relatively large (>5.5) TB product of LFM carrier will be further investigated.