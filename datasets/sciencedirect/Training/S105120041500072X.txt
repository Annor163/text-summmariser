@&#MAIN-TITLE@&#
A robust baseline elimination method based on community information

@&#HIGHLIGHTS@&#
Excellent community provides threshold, global and local slope information.Global and local slope information further confirm peak distribution information.An adaptive iteratively reweighted genetic programming model the baseline.

@&#KEYPHRASES@&#
Baseline correction,Genetic programming,Robust estimation,Community information,

@&#ABSTRACT@&#
Baseline correction is an important pre-processing technique used to separate true spectra from interference effects or remove baseline effects. In this paper, an adaptive iteratively reweighted genetic programming based on excellent community information (GPEXI) is proposed to model baselines from spectra. Excellent community information which is abstracted from the present excellent community includes an automatic common threshold, normal global and local slope information. Significant peaks can be firstly detected by an automatic common threshold. Then based on the characteristic that a baseline varies slowly with respect to wavelength, normal global and local slope information are used to further confirm whether a point is in peak regions. Moreover the slope information is also used to determine the range of baseline curve fluctuation in peak regions. The proposed algorithm is more robust for different kinds of baselines and its curvature and slope can be automatically adjusted without prior knowledge. Experimental results in both simulated data and real data demonstrate the effectiveness of the algorithm.

@&#INTRODUCTION@&#
Fourier transform infrared spectroscopy can be a valuable tool for measuring many chemical and physical properties of materials. However, it is a severe problem that spectra generally consist of peaks and noise superimposed on a baseline. Usually these baselines can be either flat, linear, curved or a combination of all three. Compared with peaks, their main character is that they vary much more slowly than the peaks do. The worst is that baselines vary greatly from spectrum to spectrum, even in similar samples. Thus, it is hard to eliminate them and this situation hampers the interpretation of spectra, which makes the removal of baseline drift necessary.Baseline elimination for spectral data has been studied intensively and several methods have already been presented. These methods can be divided into two categories: manual and automatic techniques. In the manual method [1], the baseline is constructed by using linear, polynomial, or spline functions fitted on the no signal (baseline) points selected by users. If the points are correctly selected, the construction would produce satisfactory results. Obviously, this technique is subjective, time-consuming, and poorly reproducible [2].In contrast, automatic baseline correction is called for and more widely employed. Among these methods, the wavelet transform has become a useful tool in background removal [3,4]. However, inappropriate wavelet and resolution level selection are detrimental to baseline estimation. Fourier transform method which can generate the frequency components from the original spectrum is used to make a discrimination among baseline (low frequency), signal (mid frequency), and noise (high frequency) components. Then these frequency components can be filtered by a band-pass or high-pass filter to eliminate unwanted spectral components. But the filter parameters are difficult to set for separating the baseline from the signal effectively [5]. In general, these approaches are based on a hypothesis that the background can be well separated (in the transformed domain) from the real signal. The derivative method [6] uses first derivatives or second derivatives to remove constant off-sets or linear baselines from the spectra. But the threshold, which determines how many peaks are selected from the smoothed differentiated spectrum, is difficult to set.Recently, baseline correction algorithms with asymmetric least squares smoothing are proposed [7–10]. The Whittaker smoother described by Eilers is used and only two parameters related to the rigid of the fitted curve and the noise level need to be tuned. But how to set the parameters is not always an easy task.An iterative method based on polynomial curve fitting for automated estimation of baseline is proposed [11–16]. These algorithms generate automatic threshold to distinguish the baseline from peaks by a fitted curve. Linear programming is used for baseline correction [17], the polynomial order is selected based on a criterion instead of the user's experience, but the criterion can be used only when these baseline correction processes with different polynomial orders have been completed and only be used in comparing results of these processes. These methods offer a promising approach to removing baseline effects in a simple, straightforward fashion. However, their performance depends on the two parameters predefined by the users. The parameters include the polynomial order and the threshold which is related to the noise level and other characters about the spectrum. Therefore, the accuracy of the estimation still depends on the user's prior knowledge.If there is some slope or curvature information about the baseline, the parameter which is related to the rigid of the fitted curve and the threshold would be easier to set and these baseline correcting methods should have more chances to present satisfied results.Usually there isn't any information about baseline before a baseline correction process, but more and more knowledge about the baseline can be obtained with the deepening of the process. In this paper, this knowledge is used in the adaptive iterative baseline correction process to help automatically define the rigid of the fitted curve. Reweighted genetic programming based on excellent community information (GPEXI) is proposed to recognize and model baseline automatically. Here excellent community information includes common automatic threshold, global slope, local slope, and curvature information which are obtained from these present common baseline areas determined by excellent community selected from the current population of GP. The proposed method uses an automatic threshold defined by excellent community information instead of one curve to discriminate baseline areas and peaks. The order of polynomial is automatically determined during the learning process without prior knowledge of spectra. By this way, an iteratively procedure is executed to gradually approximate a complex baseline.In Section 2, some useful and important preliminary ideas are discussed. The proposed reweighted genetic programming based on excellent community information (GPEXI) are given in Section 3. These methods about how to extract excellent community information from each generation and how to use this information are also given in this section. Section 4 presents some simulated data which are used to illustrate the performances of the proposed method. The effectiveness of the method is also demonstrated through applications on experimental spectra. Finally, some conclusions are given in Section 5.Assume that the I-point spectrum is{(x1,y(x1)),⋯(xi,y(xi)),⋯,(xI,y(xI))}. It can be modeled asy(xi)=b(xi)+e(xi),1≤i≤Iwhere:xiis a wavelength value.y=(y(x1),y(x2),⋯,y(xI))is a I point positive peak spectrum.b=(b(x1),b(x2),⋯,b(xI))denotes the baseline itself.e=(e(x1),e(x2),⋯,e(xI))denotes the residual, peaks, and physical noise. The baseline can be modeled as(1)b(xi)=f(xi,a).Here,f(⋅)and a are functions and parameters. Baseline should have the following properties: 1) being smooth, but 2) also being faithful to y[18].In these methods, a baseline b can be modeled as a p order polynomial function. It can be written asb′=Xa. Here,X=(x10x11⋯x1px20x21⋯x2p⋮⋮⋮xI0xI1⋯xIp),a=(a0a1⋮ap)is the polynomial coefficients. Try to minimize the criterionJ(a), then find the coefficients a of the polynomial curve.(2)J(a)=∑i=1Iφ(y(xi)−Xia)Xirepresents the ith row of X. The cost function φ has a critical influence on the criterion. The two following cost functions are used and a is estimated by an iterative technique [12,19].Asymmetric Huber function(3)φ(y(xi)−Xia)={(y(xi)−Xia)2ify(xi)−Xia<Δ2Δ(y(xi)−Xia)−Δ2otherwiseAsymmetric truncated quadratic(4)φ(y(xi)−Xia)={(y(xi)−Xia)2ify(xi)−Xia<ΔΔ2otherwiseOther polynomial curve fitting algorithm [11,13–16] use an iterative algorithm to estimate the baseline on a spectrum in which peaks are eliminated. The signal areas (peaks) are redefined at each iteration by a estimated baseline. Each point is set equal to the estimated baseline if the corresponding spectrum intensity is higher than the estimated baseline, otherwise it is set equal to the spectrum [14]. This method is equivalent to minimize an asymmetrical truncated quadratic whenΔ=0.The threshold Δ and the order of a polynomial function provide a threshold to discriminate baseline areas from signal areas. The two parameters need to be predefined by a user.GP was proposed by J.R. Koza in 1990's. It starts with an initial population created randomly and produces offspring by performing genetic operators in the current population. The iterative process continues until the stopping criterion is satisfied after several generations [20]. Then the best individual is gotten. GP has been widely used in many fields [21,22]. The steps of GP is:(1)A random population of size N is created. Each individual is represented as a tree structure. The individuals in the initial population are generated by recursively generating a rooted point-labeled tree.Calculate the fitness of each individual in the current population.Use the selection, recombination, and mutation operators on the current population and generate a offspring population.Back to step 2 until the final conditions are satisfied. The best individual ever encountered during the run is the solution to the problem.Here, genetic programming provides multiple estimated baseline curves with different smoothness and recognizes baseline areas by community information which is abstracted from all these estimated curves. The characteristic of GP, which is a population based optimization technique, is used to improve the accuracy of the baseline region recognition. Then GP models the baseline without pre-specifying the structure of it.Considering that a baseline generally varies much slower than a signal, so slope and curvature information can be used to distinguish signal free regions (baseline area) from signal areas (peaks). With the help of this information, reweighted genetic programming based on excellent community information (GPEXI) is proposed to eliminate baselines in spectra.First several best fitted curves (individuals in the current population) are used to identify peak regions from baseline regions. Because several fitted curves are used, the results should be more credible than those results obtained by only one fitted curve. Then, in order to avoid mistaking baseline regions as peaks, slope and curvature information are used to retest whether regions belong to peaks or baseline regions.As mentioned before, the baseline shows very broad spectral features and its derivative changes very slowly too. In the proposed method, derivative information of spectra is used to identify whether a point belongs to peaks, but noise degrades effectiveness of the method. So noise removal is needed. A Savitzky–Gloay filter [23,24] is used as a generalized moving average filter and is denoted asy¯(xi)=smoothing(y(xi),N1),N1is the number of neighboring data points on the either side ofy(xi).y¯(xi)is only used to get slope (derivative) information in baseline regions, so the parameterN1is robust which can be demonstrated in subsequent experiments.In order to utilize the characteristic information of the baseline to prevent erroneous identification of baseline areas and peak areas, excellent community and community information are combined with GP. The characteristic information includes global slope information, local slope information, and the curvature information of a baseline. Generally, this information is produced based on baseline areas of a spectrum. But unfortunately no information about baseline can be used before a correction processes generally. With the deepening of the correction process, more information can be obtained. The proposed method try to use and update these information during all the process based on current excellent community. Thus they are called community information.Excellent community consists of the several optimal individuals selected from the current population and is updated during all the evolutionary process. Here an individual represents an estimated fitted curve. Excellent community is defined as: Sort all individuals in the current population in an increasing order based on their fitness. The first 20% in the queue are chosen to make up the excellent community.Community information is automatically abstracted based on the common information provided by the present excellent community. This information includes common automatic threshold, global slope, local slope and curvature information which are abstract from common preliminary baseline areas. These information will be used to further confirm whether the preliminary results derived from common automatic threshold are true or false.Each individual curve generates an automatic threshold to discriminate peaks from baseline regions. A region is identified as a peak region by an individual if the original spectra have a value higher than the corresponding value in the individual fitted curve. Preliminary baseline and peak information is derived from common automatic threshold which are abstracted from the present excellent community.(1)Suppose, the current generation is Gen.PGen−1(xi)contains the peak distribution information obtained from the last generation.(5)PGen−1(xi)={0ifxi∈baseline regions1ifxi∈peak regionspj(xi)is the peak distribution identified by an individualbˆj(1≤j≤J) in the excellent community.pj(xi)={0ify(xi)−bˆj(xi)≤01ify(xi)−bˆj(xi)>0.Ifpj(xi)=1,a wavelength valuexiis identified to be belonging to a peak area bybˆj.A wavelength pointxiis initially identified as belonging to peaks ifP1(xi)=1.P1(xi)=PGen−1(xi)∨(p1(xi)∧p2(xi)∧⋯∧pJ(xi))contains the preliminary peak distribution information obtained from the current excellent community and the last generation. Here ∧ is an and operator, ∨ is a or operator.In order to avoid spikes in the baseline areas (single or few points belonging to peaks) [9] which are caused by noise usually,P1(xi)is modified by this way:P1(xi)=1requires not only that the pointxisatisfiesP1(xi)=1but also that two of its neighbors do.Fig. 1shows the current preliminary peak distribution information. The area about 440 is initially identified as a peak area basedPGen−1although this area is a baseline area based the information from the current excellent community.Because the effects of peak areas will be rarely considered in the subsequent baseline correction process, the determination of peak areas requires more attention. Global slope, local slope and curvature information will be used to further determine whether a point is really in a peak region.Global slope information should be obtained from the whole baseline of a spectrum. Slopes of a baseline in peak regions can be represented by the slopes of their neighboring baseline areas, because baselines vary much slower than peaks do and these peak areas can't provide any effective baseline information generally.(6)db(xi)={dy¯(xi)ifP1(xi)=0dLine(Peakm)ifP1(xi)=1andkstest2=0d(Bm)ifP1(xi)=1andL(xi,Bm)≤0.5(L(Bm)+L(Bm+1))d(Bm+1)ifP1(xi)=1andL(xi,Bm+1)<0.5(L(Bm)+L(Bm+1))Here,db(xi)is the slope of a estimated baseline atxi.dy¯(xi)=y¯(xi+1)−y¯(xi).Peakmis a continuous peak area which locates between its neighbor baseline areasBmandBm+1.kstest2=0means that these absolute derivatives of the spectrum inPeakmand these absolute derivatives inBmandBm+1are drawn from the same underlying data based on Kolmogorov–Smirnov (K–S) test with the significance level 5%. If they are drawn from the same underlying data,Peakmmay be a broad peak and too much parts of it are mistaken as some parts ofBmandBm+1. So slope information obtained fromBmandBm+1contains wrong information fromPeakmand use this slope information to represent the slopes inPeakmis improper.Line(Peakm)is the slope of the straight line which connects both sides ofPeakm.L(Bm)andL(Bm+1)represent the number of points inBmandBm+1respectively.L(xi,Bm)andL(xi,Bm+1)are distances fromxitoBmandBm+1respectively.d(Bm)is a value generated from a normal distribution with meanm(Bm)and standard deviationσ(Bm).m(Bm)andσ(Bm)are mean and standard deviation of slops inBm.d(Bm+1)are generated by the same way used ind(Bm), butBm+1is used instead ofBm.In order to avoid the influence of spikes, the neighbor baseline areasBmandBm+1on both sides ofPeakmare defined as: if a wavelength pointxibelongs toBm,ximust satisfy thatmin⁡(xPeakm,left−L(Peakm),xPeakm,left−Lbl)≤xi≤xPeakm,left−1andP1(xi)=0,xPeakm,leftis the left most position ofPeakm.Lblis the length of a continuous baseline area which is adjacent to the left side of the peak.Bm+1is defined by the way used in definingBm, but the right most position of the peak and a continuous baseline area located at the right side are used instead ofxPeakm,leftandLbl.With the deepening of the correction process, the area of a peak becoming clearer and some peaks become very broad, the information from these peak regions can't be ignored. At this condition, slopes of baseline in peak regions are represented by the slope of a straight line which connects both sides of the peak and the value ofdb(xi)in these peak regions should be modified. A peak is considered to be very broad if the length of a peak is larger than the sum of number of points in its neighbor baseline areas. Here, the peak and its neighbor baseline areas are defined by the way used in definingPeakm,BmandBm+1, butPGen−1is used here instead ofP1.By this way, the estimated baseline slope informationdb(xi)on the whole spectrum can be obtained. Ifdb(xi)>m+2σordb(xi)<m−2σ, the slope atxiis abnormal and its influence will be eliminated in calculating m and σ. m and σ are mean and standard deviation of slope of all remaining points respectively. Then the process continues until slopes at all remaining wavelength values are in the normal range[m−2σ,m+2σ]. The normal global slope range is larger thanSglobalLow=m−2σand lower thanSglobalHigh=m+2σ. BecauseSglobalHighandSglobalLoware obtained based on the information of the whole spectrum, so they are called global slope information.To further identify whether a pointxiis in a peak range, a straight line (Lm,globalHigh) is drawn from the nearest point in the most likely baseline part of the left neighbor baseline regionBmwith slopeSglobalHigh. Also, a straight line (Lm+1,globalLow) is drawn from the other neighbor regionBm+1with slopeSglobalLow. The nearest points in regionBmandBm+1are decided by the normal global and local slope information. Then whetherxibelongs to baselines or peaks is decided by:(7){P2(xi)=1ify(xi)>min⁡(Lm,globalHigh(xi),Lm+1,globalLow(xi))P2(xi)=0otherwisewhere,Lm,globalHigh(xi)andLm+1,globalLow(xi)are the corresponding value ofLm,globalHighandLm+1,globalLowatxirespectively.xiis identified again as belonging to a peak region ifP2(xi)=1.y(xi)>Lm,globalHigh(xi)means that slopes at some wavelength points in any curve which connectsxiand the baseline regionBmexceeds the normal rangeSglobalHigh, soxiis re-identified in a peak by global slope normal range. Fig. 2shows the peak distribution (P2) obtained by using global slope information.xiis inPeakmthat is initially identified byP1(xi)=1but not further confirms by global information becauseP2(xi)=0. In this section, local slope information will be used to identify whether it is in a peak range further.The normal local slope range ofBmis calculated by the same method used in calculating the normal global slope and is larger thanSm,localLow=m−2σand lower thanSm,localHigh=m+2σ. m is the mean and σ is the standard deviation of slopes at all remaining wavelength points inBm. BecauseSm,localHighandSm,localLoware obtained based on only one preliminary identified baseline bandBmon a spectrum, so they are called local slope information.Sm+1,localHighandSm+1,localLoware the normal local slope range ofBm+1.The effective scopes of local slope information are their neighboring regions and how to decide the exact scope is difficult. So[Clow,Chigh]the normal ranges ofd2b(xi)which represents the slope change rate atxiare used to decide the change rate ofSm,localHighandSm,localLowwhen a point is outside the regionBm.[Clow,Chigh]are obtained from initially identified baseline areas with the same method used in determining the normal local and global slope range. Here a Savitzky–Gloay filter is used to suppress the fast varying components of the slopedb(xi)which are usually caused by remaining noise and thendb¯(xi)is got.db¯(xi)=smoothing(db(xi),N2),d2b(xi)=db¯(xi+1)−db¯(xi),N2is the number of neighboring data points on the either side ofdb(xi).Whetherxibelongs to a baseline or peak area is redefined byP3(xi).xiis identified again as belonging to a peak region ifP3(xi)=1.(8){P3(xi)=1ify(xi)>min⁡(curveBm(xi),curveBm+1(xi))P3(xi)=0otherwisesBm(xi)=Sm,localHigh+(xi−xBm)CHigh,curveBm(xi)=y(xBm)+∑t=xBmxi−1sBm(t).sBm+1(xi)=Sm+1,localLow−(xBm+1−xi)CLow,curveBm+1(xi)=y(xBm+1)−∑t=xi+1xBm+1sBm+1(t).(xBm,y(xBm))and(xBm+1,y(xBm+1))are nearest points of the most likely baseline part inBmandBm+1.sBm(xi)andsBm+1(xi)are slopes ofcurveBmandcurveBm+1atxi.CHighandCLoware the upper and lower boundary ofd2b(xi).Because the bounds of the normal range ofd2b(xi)and the normal local slope range are used,curveBm(xi)andcurveBm+1(xi)give the upper bound of the possible baseline. Some points with a higher value thanmin⁡(curveBm(xi),curveBm+1(xi))may also belong to baseline areas, soP3(xi)is a strict definition of the peak distribution. Fig. 3shows the peak distribution (P3) obtained by strict boundary definition.Looser bounds of the possible baseline are also obtained based on a hypothesis that the effective domains of local information include their adjacent continuous peak range.A straight line (Lm,localHigh) is drawn from the nearest point of the most likely baseline part inBmwith slopeSm,localHigh. Also, A straight line (Lm+1,localLow) is drawn from the other neighbor regionBm+1with slopeSm+1,localLow. Then the looser definition of the possible peak distributionP4(xi)are obtained:(9){P4(xi)=1ify(xi)>min⁡(Lm,localHigh(xi),Lm+1,localLow(xi))anderr(xi)>mean(err)P4(xi)=P3(xi)otherwiseerr(xi)=y(xi)−Line(Peakm).mean(err)is the mean value oferr(xi).Line(Peakm)is a straight line which connects both sides ofPeakm.xiis identified belonging to a peak region based on the looser definitionP4(xi)=1. Fig. 4shows the looser peak distribution (P4). Looser boundarymin⁡(Lm,localHigh,Lm+1,localLow)is lower than corresponding values on strict boundarymin⁡(curveBm,curveBm+1).If the result ofP1(xi)is wrong andxiis in a baseline area, there must be a curve which connects(xi,y(xi))and all points in neighbor baseline area and the slope at each point on the curve should be in the normal global slope range. Looser and strict boundaries also should be defined based on real baseline areas.However, there must be some peaks which are mistaken as baseline areas becausexiis defined in baseline areas only needs the recognition of one individual curve. So only the most likely baseline parts in a neighbor baseline region will be considered.RegionBmis on the left ofPeakmandxi∈Peakm. In the regionBm, the most likely baseline parts locate atxm,lowand its neighborhood.y(xm,low)is the lowest value at all wavelength points in the regionBm={xm,1,xm,2,⋯,xm,low,⋯,xm,l,⋯,xm,L}. The neighborhood is decided by normal global and local information:(1)Make straight lines from(xm,low,y(xm,low))to every point on the right side of it in the regionBmrespectively, becausePeakmis on the right side ofBm.Calculate slopes of these straight lines and getSlow,low+1,Slow,low+2,⋯,Slow,l,⋯Slow,L. Here,Slow,lis the slope of the straight line which connects(xm,low,y(xm,low))and(xm,l,y(xm,l)).xm,lis inBmand on the right side ofxm,low.xm,kis the nearest wavelength value in the most likely baseline part ofBmtoPeakm, ifSlow,k≤min⁡(SglobalHigh,Sm,localHigh),Slow,l>min⁡(SglobalHigh,Sm,localHigh),l∈[k+1,L]anddy¯(xm,k)≤min⁡(SglobalHigh,Sm,localHigh)atxm,k.The nearest wavelength value of the most likely baseline part inBm+1is also decided by the above method. It is needed to replace every point on the right side of(xm,low,y(xm,low))with every point on the left side of(xm+1,low,y(xm+1,low))inBm+1and usingSglobalLowandSm+1,localLow.Peak regions which are identified by preliminary informationP1(xi)are verified again by global slope informationP2(xi)or local slope informationP3(xi). Then the peak region is decided by a strict definition:(10){xi∈baseline regionsifPGen(xi)=0xi∈peak regionselse ifPGen(xi)=1wherePGen(xi)=PGen−1(xi)∨(P1(xi)∧(P2(xi)∨P3(xi))). Then modifiedPGenby this way:PGen(xi)=1requires not only that the pointxisatisfiesPGen(xi)=1but also that two of its neighbors do.The peak region is decided by a loose definition:(11){xi∈baseline regionsifPGen′(xi)=0xi∈peak regionselse ifPGen′(xi)=1,wherePGen′(xi)=PGen−1(xi)∨(P1(xi)∧(P2(xi)∨P4(xi))). ModifiedPGen′by the same method as used inPGen.After peak detection, the data in peak regions should be replaced with some interpolated values which are the estimates of baseline. Slope information is used to get interpolated values in peak regions.Supposing a peak region defined byPGen(xi)locates between baseline wavelength valuesxbandxewhich locate inBmandBm+1. Slopes of the interpolated curve atxbandxearedc(xb)=min⁡(dy¯(xb),Sm,localHigh)anddc(xe)=max⁡(dy¯(xe),Sm+1,localLow). On the curve, there must be a point where the slope is the slope (dline) of the straight line (linexb,xe) which connects(xb,y(xb))and(xe,y(xe)). Then the slope (dc(xi)) of the interpolated curve uniformly changes fromdc(xb)todlineand then todc(xe). By this way, the slope (dc(xi)) in the interpolated curve in a peak are gotten. Interpolated values are obtained by integrating the estimated slopes. However direct integration ofdc(xi)makes some mismatched values since thedc(xi)is only an estimate of slope information, especially on boundaries of a peak. So linear interpolation also used.(12)s(xi)=dc(xi)−mean(dc(xi))(13)y′(xi)=linexb,xe(xi)+∑t=xbxi−1s(t)After interpolation, the spectrum is modified as(14)y′(xi)={y′(xi)xi∈peak regionsy(xi)xi∈baseline regionsand the result of interpolation is presented in Fig. 5.The structure of an estimated baseline model is constructed by GP. After that, the weighted least square method is applied to estimate unknown parameters. The structure of an estimated baseline model can be expressed as:(15)bˆ(xi)=c1f1(xi)+c2f2(xi)+⋯+ckfk(xi)Herebˆ(xi)is an estimated baseline value atxi. The structure offkand the number of k are defined by genetic programming automatically. Minimize Q and find C.(16)min:Q=∑i=1Iβi(y′(xi)−bˆ(xi))2.Suppose there are M continuous peak areas (Peakm,1≤m≤M) identified byPGen.xR,PeakmandxL,Peakmare baseline wavelength values on both sides ofPeakmbased onPGen. Thenβiis defined as:βi={1ifPGen(xi)=0andPGen′(xi)=00.1L(peakm)L(spectrum)ifxi∈PeakmandPGen′(xR,Peakm)=0andPGen′(xL,Peakm)=00ifxi∈Peakmand(PGen′(xR,Peakm)=1orPGen′(xL,Peakm)=1)L(peakm)is the number of points in the peak, andL(spectrum)is the number of all points on the spectrum.The minimization of Q leads to the following system of equations:(17)dQdC=0⇒C=(FTβF)−1FTβYC=[c1c2⋮cK],F=[f1(x1)f2(x1)⋯fk(x1)f1(x2)f2(x2)⋯fk(x2)⋯f1(xI)f2(xI)⋯fk(xI)],β=diag(β1,β2,⋯,βI),Y=[y(x1)y(x2)⋮y(xI)].The fitness function provides criterion for each estimated baseline and offers guidance on searching direction. Whether an individual is better or worse is judged by it. So the fitness function has a crucial influence on a GP's performance. Generally, the fitness is designed as:(18)min:Fit=∑i=1I(e(xi))2where,e(xi)=bˆ(xi)−y(xi),i=1⋯Iis number of points.bˆ(xi)is the value of the estimated baseline curve atxi. This kind of fitness function is very sensitive to peaks, so it is not suitable for baseline correction.Generally peak areas provide little useful information for baseline modeling, so in these regions, their effect should be reduced, smoothness is more important than the fitting error. But in baseline regions, the fitting error needs more attention.Therefore the fitness function of an estimated baseline consists of the following parts:(19)Fit(bˆj)=∑i=1Iβi′(y′(xi)−bˆj(xi))2+∑i=1IF(bˆj(xi))Here,βi={1ifPGen(xi)=0andPGen′(xi)=00.5ifPGen(xi)=0andPGen′(xi)=10.1L(peakm)L(spectrum)ifxi∈PeakmandPGen′(xR,Peakm)=0andPGen′(xL,Peakm)=00ifxi∈Peakmand(PGen′(xR,Peakm)=1orPGen′(xL,Peakm)=1)∑F is a penalty term based on how much the value ofbˆjexceeds the possible upper boundary of baseline scope in peak areas and how much the value ofbˆjis larger than the corresponding value on the spectrum in baseline areas. In a peak area, there is only little information for baseline estimation. But with global slope information, local slope information, and the normal slope change rate, the possible upper boundary of baseline scope in peak regions can be roughly estimated.(20)F(bˆj(xi))={(bˆj(xi)−Upper(xi))2ifbˆj(xi)>Upper(xi)andPGen(xi)=1(bˆj(xi)−y(xi))2ifbˆj(xi)>y(xi)+ΔandPGen(xi)=0Here, Δ is standard deviation ofbˆj(xi)−y(xi)on baseline areas defined byPGen.Upper(xi)is the upper bound of possible baseline curve fluctuation at peaks.(21)Upper(xi)=min⁡(Lm,globalHigh(xi),Lm+1,globalLow(xi),curveBm(xi),curveBm+1(xi),y(xi))(1)A random population of size N is created. Each individual is an estimate of baseline for the spectrum.Estimate parameters and calculate the fitness value.Get excellent community, obtain informationP1(xi).Reconfirm these peak regions with global slope information and obtainP2(xi).Reconfirm these peak regions with local slope information, obtainP3(xi)andP4(xi).Obtain the present strict identified peak regions withPGen(xi)and loose peak definitionPGen′(xi).PGen−1(xi)=PGen(xi).Use the selection, recombination, and mutation operator to generate a child population.Back to step 2 until the final conditions are satisfied. Here final condition is considered to be reached when there are no new peak points founded and the fitness of the best individual doesn't improve for several consecutive generations.Remove the estimated baselinebˆ(xi)fromy(xi).

@&#CONCLUSIONS@&#
