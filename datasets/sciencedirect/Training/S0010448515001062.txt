@&#MAIN-TITLE@&#
Geometric characteristics of a class of cubic curves with rational offsets

@&#HIGHLIGHTS@&#
This paper presents a geometric characterization of cubic indirect-PH curves.We give a construction ofG1Hermite interpolation using indirect-PH curves.The optimal indirect-PH curve toG1Hermite interpolation is investigated.

@&#KEYPHRASES@&#
Bézier curves,Offsets,Rational parameterization,Pythagorean hodograph,G,1,Hermite interpolation,

@&#ABSTRACT@&#
Planar Bézier curves that have rationally parameterized offsets can be classified into two classes. The first class is composed of curves that have Pythagorean hodographs (PH) and the second class is composed of curves that do not have PHs but can have rational PHs after reparameterization by a fractional quadratic transformation. This paper reveals a geometric characterization for all properly-parameterized cubic Bézier curves in the second class. The characterization is given in terms of Bézier control polygon geometry. Based on the derived conditions, we also present a simple geometric construction ofG1Hermite interpolation using such Béziercurves. The construction results in a one-parameter family of curves if a solution exists. We further prove that there exists a unique value of the parameter which minimizes the integral of the squared norm of the second order derivative of the curves.

@&#INTRODUCTION@&#
This paper deals with a class of Béziercurves that possess rational offset curves. Béziercurves are a common type of representations for free form curves in computer aided design and manufacturing (CAD/CAM)  [1]. Offsetting has diverse engineering applications including CNC machining, motion planning, railway design, shape blending, etc. However, it is known that a Béziercurve in general may not have a rational offset  [2]. This actually motivated a lot of research on offset approximation  [3–8]. On the other hand, the failure of preserving rationality of the offsetting results may cause extra cost in operations involving offsets and software development as well. Therefore it is interesting to explore the curves that allow rational representation of their exact offset curves.In 1990, Farouki and Sakkalis introduced a class of polynomial curves called Pythagorean hodograph (PH) curves  [9]. A polynomial parametric curve is called a PH curve if the Euclidean norm of the hodograph of the curve is a polynomial. Hence for PH curves, their offset curves admit rational representation. Furthermore, PH curves’ arc length can be expressed as a polynomial function of the parameter. Since then, many works have followed. The idea of PH curves was extended to spatial PH curves  [10], rational PH curves  [11,12], Minkowski PH curves  [13], etc. Also many methods have been developed to perform Hermite interpolation using various PH curves  [14–19]. One can easily find hundreds of papers in these topics. Detailed review on PH curves and related topics can be found in Chapter 17 of the Handbook of Computer Aided Geometric Design  [1], book “Pythagorean-Hodograph Curves: Algebra and Geometry Inseparable”  [20], a special issue of Computer Aided Geometric Design in 2008  [21], and a recent survey  [22].Having a Pythagorean hodograph is only a sufficient condition for the offset of a polynomial curve to be rational. For example, the parabola does not belong to PH curves, but the offsets to the parabola are rational  [23]. It has been proved that the necessary and sufficient condition for a properly-parameterized polynomial curve on a plane to have rational offsets is that the squared norm of its hodograph has at most two complex roots (with nonzero imaginary part) of odd multiplicity  [24–26]. PH curves are a special case of such curves corresponding to the situation that the number of complex roots with nonzero imaginary part of odd multiplicity is zero. The curves in the complementary set of PH curves do not have polynomial Pythagorean hodograph, but after reparameterization via a quadratic parameter transformation, they can have a rational Pythagorean hodograph. For convenience of description, in this paper we call such curves in the complementary set indirect-PH curves.Note that sophisticated algebraic methods have been employed to analyze and construct curves with rational offsets. For example, the complex variable model was used for planar PH curves  [27] and indirect-PH curves  [25], and the quaternion model was used for spatial PH curves  [28,29]. On the other hand, polynomial curves are always representable in Bézierform and Béziercontrol polygons provide an intuitive way to dealing with curves. While in general the algebraic structure of the polynomial curves with rational offsets is not simply transferred to intuitive constraints on the control polygon geometry, Farouki and Sakkalis provided an elegant geometric characterization for cubic PH curves  [9], which are two constraints on the lengths of legs and two interior angles of the Béziercontrol polygons. Wang and Fang derived the geometric characterization of quartic PH curves also in terms of Béziercontrol polygons  [30]. This thus provides a geometric approach for constructing PH quartics. The use of control polygons was also proposed for designing planarC2PH quintic spline curves in  [31].In this paper, we are interested in intuitive geometric constraints for cubic Béziercurves to be indirect-PH curves based on Béziercontrol polygons. Except for some brief description of cubic indirect-PH curves in  [25], no work has been published on the full geometric characterization of them. The main contribution of this paper is that we convert the special algebraic structure in the hodographs of indirect-PH curves into simple geometric constraints and present the full geometric characterization of cubic indirect-PH curves. The geometric characteristics are expressed using the lengths of edges and the interior angles of a quadrilateral formed from the Béziercontrol polygons. Furthermore, we present the construction of a characterization diagram for the Béziercontrol points. The idea of constructing a diagram to characterize cubic curves has been used in  [32–34]. Another contribution of the paper is a simple geometric construction ofG1Hermite interpolation using cubic indirect-PH curves. In particular, if a single cubic indirect-PH curve is available for the input Hermite data, the solution is actually a one-parameter family of curves. We prove that there exists a unique value of the parameter that minimizes the integral of the squared norm of the second order derivative of the curves.The paper is organized as follows. Section  2 briefly reviews polynomial curves with rational offsets, which serve as the starting point of our work. Section  3 then presents the full geometric characterization of indirect-PH curves. The geometric construction ofG1Hermite interpolation using indirect-PH curves is discussed in Section  4. Section  5 provides some examples and Section  6 concludes the paper.The offset to a planar curveP(t)=(x(t),y(t))can be written as(1)Po(t)=P(t)±d(−y′(t),x′(t))x′2(t)+y′2(t)wheredis the offset distance.Due to the square root in the denominator,Po(t)is generally not a rational curve. In case there exists a polynomialσ(t)such thatx′2(t)+y′2(t)=σ2(t), i.e.,(x′(t),y′(t),σ(t))form a “Pythagorean triple”,Po(t)is a rational curve. SuchP(t)is called a PH curve  [9].The rationality of the offset curvePo(t)actually depends on whether the square root has a rational parameterization. The necessary and sufficient condition for a properly-parameterized polynomial curve to have rational offsets can be described by the following theorem  [25].Theorem 1A properly-parameterized polynomial curveP(t)=(x(t),y(t))has rationally parameterized offsets if and only if the hodograph(x′(t),y′(t))has the following decomposition:(2)x′(t)+iy′(t)=ρ(t)[(λt+1)+iμt][u(t)+iv(t)]2wherei=−1is the imaginary unit,ρ(t),u(t)andv(t)are polynomials oftwith real coefficients,λandμare real numbers, andu(t)andv(t)are relatively prime.The decomposition (2) can be classified into two cases corresponding to the two classes of polynomial curves with rational offsets: PH curves and indirect-PH curves.•μ=0. We havex′(t)=ρ(t)(λt+1)(u2(t)−v2(t)),y′(t)=ρ(t)(λt+1)(2u(t)v(t)).Hencex′2(t)+y′2(t)=(ρ(t)(λt+1)(u2(t)+v2(t)))2, which implies thatP(t)is a PH curve. A linear curve (i.e., straight line segment) is a PH curve withλ=0andρ,u,vbeing constant.μ≠0. The root of(λt+1)+iμt=0is a complex number−λ+iμλ2+μ2, which is also a root ofx′2(t)+y′2(t)=0with odd multiplicity. Therefore the curveP(t)in this case is not a PH curve. However, we introduce a quadratic parameter transformation  [25]:(3)t(s)=B12(s)+(c−1+b)B22(s)(c+1−b)B02(s)+(1+b)B12(s)+(c−1+b)B22(s)whereb=(λ+1)2+μ2,c=(λ+2)2+μ2,andBi2(t)=2i(1−t)2−it2are quadratic Bernstein polynomials. It is obvious thatt(0)=0andt(1)=1. After the parameter transformation, the curveP(t(s))has a rational Pythagorean hodograph. In fact, it is sufficient to verify that(λt+1)2+(μt)2=((c+1−b)B02(s)+c2−(1−b)22B12(s)+b(c−1+b)B22(s)(c+1−b)B02(s)+(1+b)B12(s)+(c−1+b)B22(s))2.Therefore the curves in this class are indirect-PH curves.Consider a cubic properly-parameterized curveP(t)in the class of indirect-PH curves. According to Theorem 1, it must have a decomposition of (2). Since the derivativeP′(t)is quadratic andμ≠0, bothu(t)andv(t)must be constant, andu2+v2≠0(i.e.,uandvcannot be zero simultaneously). Moreover,ρ(t)is linear int. After some calculation, we obtainP′(t)=ρ(t)(u2−v2,2uv)[λμ−μλ]t+ρ(t)(u2−v2,2uv).Let(4)T0=(u2−v2,2uv),T1=(u2−v2,2uv)[λ+1μ−μλ+1].Sinceu2+v2≠0,u2−v2and2uvcannot be zero simultaneously, from which we can conclude thatT0≠0,T1≠0andT0∦T1. Thus we haveTheorem 2A cubic properly-parameterized curveP(t)=(x(t),y(t))is an indirect-PH curve if and only if(5)(x′(t),y′(t))=[ρ0(1−t)+ρ1t][T0(1−t)+T1t]whereT0,T1are two non-parallel vectors, andρ0,ρ1are two numbers satisfyingρ02+ρ12≠0.We further haveCorollary 3If a cubic properly-parameterized curveP(t)=(x(t),y(t))is an indirect-PH curve, it does not contain a cusp within the parameter domain[0,1]if and only ifρ0ρ1>0.ProofA cusp on a curve refers to a point where the unit tangent vector of the curve is discontinuous. For cubic properly-parameterized indirect-PH curveP(t), it contains a cusp if and only ifρ0(1−t)+ρ1thas a root within[0,1]sinceT0,T1are two non-parallel vectors. This is equivalent toρ0ρ1≤0.■Remark 1Theorem 2 tells that for a cubic indirect-PH curve, its hodograph can be expressed by a linear vector with respect to parametertmultiplied by a linear scalar functionρ(t). This means that a cubic indirect-PH curve is actually an LN curve introduced by Ahn and Hoffmann  [35], though a higher degree indirect-PH curve is not necessarily an LN curve. The term “LN” stands for linear normal, which was introduced by Jüttler in the surface case  [36]. LN curves have linearly varying normals and play an important role in convolution. They are special instances of curves possessing a rational support function  [37]. This paper focuses on cubic indirect-PH curves (i.e., cubic LN curves). We analyze their geometric characteristics in terms of Béziercontrol polygon geometry, a full exploration of which was not done before.We writeP(t)in Bézierform:(6)P(t)=(x(t),y(t))=∑i=03PiBi3(t),t∈[0,1]whereBi3(t)=3i(1−t)3−itiare cubic Bernstein polynomials andP0,P1,P2andP3are the four control points. The hodograph can be expressed as(x′(t),y′(t))=3(P1−P0)B02(t)+3(P2−P1)B12(t)+3(P3−P2)B22(t).Note that Eq. (5) can be re-written as(x′(t),y′(t))=ρ0T0B02(t)+ρ0T1+ρ1T02B12(t)+ρ1T1B22(t).Comparing the above two representations of the hodograph gives(7)3(P1−P0)=ρ0T0,3(P3−P2)=ρ1T1,3(P2−P1)=ρ0T1+ρ1T02.From the first two equations of (7), we have(8)P1=P0+ρ03T0,P2=P3−ρ13T1.Substituting them into the third equation of (7) givesρ0T1+ρ1T02=P3−P0−ρ1T13−ρ0T03,i.e.,(9)P0+(ρ03+ρ16)T0=P3−(ρ13+ρ06)T1.Corollary 4If a cubic properly-parameterized BéziercurveP(t)of   (6)   is an indirect-PH curve, its first and last control points could not coincide, i.e.,P0≠P3.ProofIfP0=P3, then(ρ03+ρ16)T0=−(ρ13+ρ06)T1. Since(ρ03+ρ16)and(ρ13+ρ06)cannot be zero simultaneously,T0andT1are parallel, which contradicts Theorem 2.■LetI=P0+(ρ03+ρ16)T0=P3−(ρ13+ρ06)T1. If we denote the line going throughP0and having directionT0byL0and the line going throughP3and having directionT1byL3.Iis a point on both linesL0andL3.Leth=ρ1/ρ0. We have(10)I−P0=(ρ03+ρ16)T0=(ρ03+ρ16)3(P1−P0)ρ0=(1+h2)(P1−P0).Similarly,(11)I−P3=(1+12h)(P2−P3).Using Eqs. (7)–(11), we now analyze the geometric characterization of cubic indirect-PH curves in eight different cases according to the value ofh.Case 1.h=∞(i.e.,ρ0=0,ρ1≠0)In this case, Eqs. (7), (8), (10) and (11) respectively giveP1=P0,T1=3ρ1(P3−P2),I−P0=ρ16T0,I=P2.On the other hand, if four control pointsP0,P1,P2andP3are given in this way (i.e.,P0=P1≠P3,P0,P2,P3are not collinear as shown in Fig. 1), we letρ0=0,ρ1=1,T0=6(P2−P0)andT1=3(P3−P2).T0∦T1. Then condition (5) holds andP(t)is an indirect-PH curve.h=0(i.e.,ρ0≠0,ρ1=0)This is ‘symmetric’ to Case 1 (see Fig. 2). We haveP2=P3,T0=3ρ0(P1−P0)andI=P1.h=−2From (10) and (11), we haveI=P0,P2=P3+43(P0−P3).In this case,P1can be anywhere as long as it does not lie on the line containingP0P3(see Fig. 3).On the other hand, ifP2=P3+43(P0−P3), we just letρ1=−2ρ0,T0=3ρ0(P1−P0)andT1=3ρ1(P3−P2), which make condition (5) be satisfied.h=−12This is ‘symmetric’ to Case 3 (see Fig. 4). We haveI=P3,P1=P0+43(P3−P0),andP2can be anywhere as long as it is not on the line going throughP0andP3.Similarly, ifP1=P0+43(P3−P0), we just letρ0=−2ρ1,T0=3ρ0(P1−P0),T1=3ρ1(P3−P2), which make condition (5) be satisfied.h>0In this case,I−P0=(1+h2)(P1−P0)has the same direction as vectorP1−P0, but a longer length thanP1−P0. Similarly,I−P3=(1+12h)(P2−P3)has the same direction as vectorP2−P3, but a longer length thanP2−P3.Letd1=‖I−P0‖,d2=‖I−P3‖,l0=‖P0−P3‖,l1=‖P1−P0‖,l3=‖P3−P2‖. Thenl1=2h+2d1,l3=2h2h+1d2.Eliminatinghfrom these two equations gives(12)(d1l1−1)(d2l3−1)=14.Denote the two interior angles of quadrilateralP0P1P2P3atP0andP3byαandβ, respectively. Referring to Fig. 5, in△P0IP3, the Law of Sines givesd1sinβ=l0sin(α+β)=d2sinα.Thusd1=sinβsin(α+β)l0,d2=sinαsin(α+β)l0. Substituting them into (12), we arrive at(13)(l0l1sinβsin(α+β)−1)(l0l3sinαsin(α+β)−1)=14which is a geometric constraint expressed in terms of the lengths and angles of quadrilateralP0P1P2P3.It is also worth pointing out that whenh=1, we havel1=23d1andl3=23d2. Thus the cubic Béziercurve can be degree-reduced to a quadratic Béziercurve defined by control pointsP0,IandP3.−2<h<−12In this case,I−P0has the same direction as vectorP1−P0, but a shorter length thanP1−P0.I−P3has the same direction as vectorP2−P3, but a shorter length thanP2−P3. Hence line segmentsP0P1andP3P2intersect atI(see Fig. 6). In a similar way, we can obtainl1=2h+2d1,l3=2h2h+1d2and(14)(d1l1−1)(d2l3−1)=14.In△P0IP3, the Law of Sines givesd1sinβ=l0sin(α+β)=d2sinα.Thusd1=sinβsin(α+β)l0,d2=sinαsin(α+β)l0. Substituting them into (14) gives (13).−12<h<0In this case,I−P0has the same direction as vectorP1−P0, but a shorter length thanP1−P0. The directions ofI−P3andP2−P3are opposite. Thenl1=2h+2d1,l3=−2h2h+1d2.Eliminatinghgives(15)(d1l1−1)(d2l3+1)=−14.Note that in this case the interior angleβis a reflex angle (see Fig. 7). In△P0IP3, the Law of Sines givesd1sin(β−π)=l0sin(2π−α−β)=d2sinα.Thusd1=sinβsin(α+β)l0,d2=−sinαsin(α+β)l0. Substituting them into (15) also gives (13).h<−2This is ‘symmetric’ to Case 7.I−P3has the same direction as vectorP2−P3, but a shorter length thanP2−P3. The directions ofI−P0andP1−P0are opposite. Thenl1=−2h+2d1,l3=2h2h+1d2.Eliminatinghgives(16)(d1l1+1)(d2l3−1)=−14.Referring to Fig. 8, the interior angleαin this case is a reflex angle. In△P0IP3, the Law of Sines givesd1sinβ=l0sin(2π−α−β)=d2sin(α−π).Thusd1=−sinβsin(α+β)l0,d2=sinαsin(α+β)l0. Substituting them into (16) gives (13).Summarizing all the above discussions, we arrive at the main result of the paper:Theorem 5A properly-parameterized cubic BéziercurveP(t)of   (6)   is an indirect-PH curve if and only if the four control pointsP0,P1,P2andP3do not lie on the same line,P0≠P3, and they further satisfy one of the following eight conditions (corresponding toFig.  9(a)–(h)):(i)P0=P1.P2=P3.P2=P3+43(P0−P3).P1=P0+43(P3−P0).Two raysR1(u)=P1+u(P1−P0),u>0andR2(v)=P2+v(P2−P3),v>0intersect, and constraint(13)   holds.Two line segmentsP0P1andP2P3intersect, and constraint(13)   holds.RayR(u)=P3+u(P3−P2),u>0and edgeP0P1intersect, and constraint(13)   holds.RayR(u)=P0+u(P0−P1),u>0and edgeP2P3intersect, and constraint(13)   holds.ProofConditions (i)–(viii) actually correspond to Cases 1–8, respectively. Thus what remains is just to prove that if a Béziercontrol polygon is given as in Cases 5–8, the Béziercurve is an indirect-PH curve. In fact, we simply leth=2(l0l1sinβsin(α+β)−1),ρ1=hρ0,T0=3ρ0(P1−P0),T1=3hρ0(P3−P2).Then it is easy to verify that the constraint (13) makes the condition (5) in Theorem 2 be satisfied.■Remark 2According to Corollary 3, the condition for a cubic indirect-PH curve to have no cusp ish>0. Therefore, among the eight cases for indirect-PH curves, only Case 5 defines curves that do not contain cusps within the parameter domain[0,1]. Moreover, in this case, the control polygons are convex, so the curves cannot have an inflection point.Remark 3GivenP0,P1andP3such that they are not collinear,P0P1andP0P3form a 2D affine frame. We construct two lines: One line goes throughP1andP3, and the other goes throughP3and is parallel toP0P1. As shown in Fig. 10, these lines together with linesP0P1andP0P3partition the plane into nine zones. If a Béziercurve defined byP0,P1,P2andP3is an indirect-PH curve, the control pointP2must be atP3,P3+43(P0−P3), or one of four shaded zones (i.e., I, II, III and IV). Specifically, zones I, II, III and IV correspond to Cases 5, 6, 7 and 8, respectively. Thus this figure provides a characterization diagram for Béziercontrol points of indirect-PH curves.Remark 4If we are required to examine whether a cubic spline consists of indirect-PH curves, a simple way is just to convert each segment into a Béziercurve by knot insertion and then to apply Theorem 5.This section considers theG1Hermite interpolation problem: given two pointsP0andP3and two respective tangent vectorsT0andT1, we want to find a cubic indirect-PH curveP(t)satisfying(17)P(0)=P0,P(1)=P3,P′(0)=c0T0,P′(1)=c1T1for some positive numbersc0andc1. Moreover, the constructed curveP(t)is required not to contain cusps since cusps are usually not desirable.We first construct two raysR0(u)=P0+uT0,u∈(0,+∞)andR1(v)=P3−vT1,v∈(0,+∞). IfR0(u)andR1(v)intersect, there exist cubic indirect-PH curves achievingG1Hermite interpolation according to Theorem 5. We discuss the construction of such curves in Section  4.1. Otherwise, there is no intersection betweenR0(u)andR1(v). Then according to Theorem 5, there may not exist an indirect-PH curve as the solution to the problem, or there do exist indirect-PH curves satisfyingG1Hermite interpolation but the curves contain cusp(s). We propose to use two indirect-PH curves connected withG1continuity to achieveG1Hermite interpolation and these curves do not contain cusps. We discuss this in Section  4.2.Assume thatR0(u)andR1(v)intersect atIas shown in Fig. 11. We look for a single indirect-PH curveP(t)as the solution to theG1Hermite interpolation problem. We expressP(t)using cubic Bézierform. It is obvious that the given two pointsP0andP3serve as the first and last Béziercontrol points. To further achieveG1Hermite interpolation, the two inner Béziercontrol pointsP1andP2should be placed on raysR0(u)andR1(v), respectively. Using the notations introduced in the preceding section,P1andP2are expressed as(18)P1=P0+l1T0‖T0‖,P2=P3−l3T1‖T1‖wherel1andl3should be properly chosen in order to assureP(t)to be an indirect-PH curve.In order to make sure that constraint (13) holds, we letl0l1sinβsin(α+β)−1=h2,l0l3sinαsin(α+β)−1=12hwherehis a parameter that can be used for shape control. Solving these two equations gives(19)l1=2l0h+2sinβsin(α+β),l3=2hl02h+1sinαsin(α+β).Sinceα,βandα+βare all in(0,π)in this case, to guarantee the positivity of bothl1andl3obtained from the above two equations,hmust satisfy eitherh>0or−2<h<−12. When−2<h<−12,l1>4l03sinβsin(α+β)>l0sinβsin(α+β), andl3>4l03sinαsin(α+β)>l0sinαsin(α+β), which correspond to Case 6. Similar analysis shows thath>0corresponds to Case 5. Since Case 5 is the only case where there is no cusp, we restrict our discussion toh>0.So far we have constructed a family of cubic Béziercurves characterized by parameterh, which are indirect-PH curves and satisfy the requirement ofG1Hermite interpolation. Next we show how to select a “good” one from the family. Our criterion is that the integral of the square norm of the second order derivative of the curve is minimized, which is often used in fair curve design. Thus the problem is to solve(20)h=argminh>0∫01‖P″(t)‖2dt.We have the following theorem for this:Theorem 6Among all the constructed indirect-PH curvesP(t), the minimization problem   (20)   has a unique solution. Moreover, the solutionhis within(0.49,2.04).ProofNote that the integration in (20) remains the same under a rigid transformation. Hence without loss of generality we assume thatP0=(0,0),P3=(l,0)andI=(lm,ln)wherel,m,nare real numbers andl>0,n>0. ThenP(t)can be represented byP(t)=2lh+2(m,n)B13(t)+2hl2h+1(m+2h,n)B23(t)+l(1,0)B33(t).Some calculations give(21)ddh∫01‖P″(t)‖2dt=72l2F(h)(h+2)2(2h+1)3whereF(h)=2(6m2−3m+6n2+1)h4+(12m2−27m+12n2+11)h3+18(−2m+1)h2+(−12m2−3m−12n2+4)h+2(−6m2+9m−6n2−4).HenceF′(h)=8(6m2−3m+6n2+1)h3+3(12m2−27m+12n2+11)h2+36(−2m+1)h+(−12m2−3m−12n2+4),F″(h)=24(6m2−3m+6n2+1)h2+6(12m2−27m+12n2+11)h+36(−2m+1).SinceF(0)=4(−6m2+9m−6n2−4)=−24(m−34)2−24n2−52<0and6m2−3m+6n2+1=6(m−14)2+6n2+58>0,F(h)=0has at least one solution in(0,+∞). Next we show that there is exactly one solution in(0,+∞).Ifm≤12, then12m2−27m+12n2+11=12(m−2724)2+12n2−6716≥12(12−2724)2+12n2−6716=12+12n2>0. HenceF″(h)has a minimum ath=−12m2−27m+12n2+118(6m2−3m+6n2+1)<0, from which andF″(0)=36(−2m+1)≥0we can concludeF″(h)>0for allh>0. This implies thatF′(h)has at most one root in(0,+∞). IfF′(h)=0has no solution, thenF′(h)>0forh>0andF(h)=0has a unique solution in(0,+∞). Otherwise,F′(h)has one rootc∈(0,+∞). ThenF′(h)<0forh∈(0,c)andF′(h)>0forh∈(c,+∞). Therefore,F(h)<F(0)<0forh∈(0,c], andF(h)=0has a unique solution in[c,∞).Otherwise,m>12.F″(0)=36(−2m+1)<0. ThusF″(h)=0has one solution in(0,∞), which we denote byr. Forh∈(0,r),F″(h)<0and forh∈(r,∞),F″(h)>0. Meanwhile,F′(0)=−12m2−3m−12n2+4=−12(m+18)2−12n2+6716<−12(12+18)2−12n2+6716=−12−12n2<0. ThereforeF′(h)<F′(0)<0forh∈(0,r], andF′(h)has only one root in(r,∞). Denote the root byc. ThenF′(h)<0forh∈(0,c)andF′(h)>0forh∈(c,+∞). Therefore we can prove thatF(h)=0has a unique solution in(0,+∞)in a similar analysis.Therefore for any positivehless than the root ofF(h)=0,F(h)is negative, so is (21), and for anyhgreater than the root,F(h)and (21) are positive. Therefore at the root ofF(h)=0, the integration in (20) reaches its minimum.Finally, we can easily verify the following inequalities:F(0.49)≤−15.77643588(m−0.1383071871617178)2−15.77643588n2−0.0069794624518767<0andF(2.04)≥273.22294272(m−0.8620652619256)2+273.22294272n2+0.0455229664307>0.This means that the solution ofF(h)=0is within(0.49,2.04).■Theorem 6 also provides a way to findingh. That is to find the root ofF(h)=0within(0.49,2.04). The theorem has assured that there exists a unique solution. The Bézierclipping method  [38] can be used to quickly find the solution. Thus given theG1Hermite data{P0,T0;P3,T1}, the construction ofG1Hermite interpolation proceeds as follows: (1) compute the two anglesαandβ; (2) find the optimalh; (3) computel1andl3using Eq. (19); and (4) computeP1andP2using Eq. (18), which together withP0,P3define the target cubic Béziercurve.WhenR0(u)andR1(v)do not intersect, a single cubic indirect-PH curve without cusp(s) is not available for the given Hermite data. We resort to two indirect-PH curve segments that are connected withG1continuity and satisfy the interpolation condition. This is always possible.The basic idea is to introduce two pointsQ1andQ2as follows:Q1=P0+aT0,Q2=P3−bT1with some positive numbersaandb. Then we choose a pointPmon line segmentQ1Q2. In this way, we can obtain two sets of data:{P0,T0;Pm,Q1Q2}and{Pm,Q1Q2;P3,T1}. Each set of the data satisfies the assumption in Section  4.1. We can thus apply the procedure presented there to construct two indirect-PH curve segments which satisfyG1Hermite interpolation and also join atPmwithG1continuity.While there are many ways to choosea,bandPm, we here describe a heuristic way to determine them automatically. The underlying consideration is the balance of the two indirect-PH curve segments in terms of length and shape, and the simplicity of the method. Denote byl0the length ofP0P3. The process consists of the following three steps (with reference to Fig. 12):(1)Construct a rectangle centered atP0. One pair of edges is parallel toP0P3and the other pair of edges is orthogonal toP0P3. The length of the edges parallel toP0P3is chosen to bel0/2and the length of the other pair of edges is chosen to bel0. Cast a ray starting fromP0along the direction ofT0. The intersection between the ray and the rectangle is selected to beQ1.Similar to step (1), construct a rectangle centered atP3. The intersection between the rectangle and a ray starting fromP3along the direction of−T1is selected to beQ2.Note thatQ1andQ2are on the two sides of the perpendicular bisector ofP0P3. The intersection betweenQ1Q2and the perpendicular bisector is chosen to bePm.A simple situation is thatT0=−T1andT0,T1are perpendicular toP0P3. Then the above procedure producesQ1,Q2andPmsuch thatP0Q1,Q1Pm,PmQ2, andQ2P3have the same length andP0Q1PmandPmQ2P3are the same up to a rigid transformation. Similarly, ifT0=T1and they are perpendicular toP0P3, the constructed two sets of data are symmetric.This section provides more examples of indirect-PH curves in addition to those given in Section  3.Fig. 13shows a cubic Béziercurve in red and its control polygon. The Cartesian coordinates of the four control points are (0, 0), (0, 5.6), (3, 4), and (6, 1). It can be verified that this Béziercontrol polygon corresponds to Case 5 and the constraint (13) holds. Thus the curve has rational offsets. In fact, a parameter transformation could bet(s)=0.4109643s2−2s2.882843864s2−3.913301496s−0.558578068,and the offset curves are rational Béziercurves of degree of 8. Three offset curves and their control polygons are depicted in blue.Given two endpointsP0=(0,0),P3=(1,1)and their respective tangent vectorsT0=(1,4),T1=(1.5,−1), there exists a family of indirect-PH curves that achieveG1Hermite interpolation. Fig. 14shows five such curves from the family with parameterh=0.1,1,1.568665207,2.5,15from left to right. In particular, whenh=1, the indirect-PH curve is actually a quadratic Béziercurve.h=1.568665207is the optimal solution to the minimization problem (20). As a comparison, we also construct the cubic PH curve which is displayed on the right of Fig. 14. Different from indirect-PH curves, the PH curve is unique for the givenG1Hermite data. In the bottom row of the figure, the curvature plots of the curves are presented.When the givenG1Hermite data do not satisfy the assumption in Section  4.1, a single indirect-PH curve without cusp(s) is not available. Then two indirect-PH curves can be used. Fig. 15shows the construction of two indirect-PH curves under various situations. It can be seen that such bi-indirect-PH curves possess enough flexibility forG1Hermite interpolation. In Fig. 15, the input data (two endpoints and two vectors) are displayed in green. The two constructed curves and their control polygons are shown in blue and black, respectively. The joint point between the two indirect-PH curves is drawn in red.Finally, Figs. 16 and 17showG1spline curves consisting of several indirect-PH curves that interpolate a sequence of Hermite data. This is done by automatically constructing indirect-PH curve(s) for each adjacent pair of data. The input data points for the closed curve in Fig. 16 are(−8,0),(−2.5,−3),(3,−5),(8,0),(3,5),(−2.5,3),(−8,0), and their respective tangent vectors are(0,−1),(2,1),(4,−1),(0,1),(−4,−1),(−2,1),(0,−1). It can be seen that two indirect-PH curves are used for the span between points(−2.5,−3)and(3,−5), and the span between points(3,5)and(−2.5,3). The data points for the open curve in Fig. 17 are(−12,−4),(−6,−3),(−2,2),(4,4),(9,1),(6,−4), and their respective tangent vectors are(1,0),(1,1),(1.2,1),(3,0),(0,−1),(−2,−1). Similarly, it can be seen that two indirect-PH curves are constructed in the span between points(−6,−3)and point(−2,2).

@&#CONCLUSIONS@&#
