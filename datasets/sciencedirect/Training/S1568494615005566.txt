@&#MAIN-TITLE@&#
Uncertainty management in multiobjective hydro-thermal self-scheduling under emission considerations

@&#HIGHLIGHTS@&#
A stochastic multiobjective framework is proposed for short-term Hydro-Thermal Self Scheduling (HTSS) for electricity markets.The generating units’ contingencies and price uncertainty are explicitly considered in the stochastic programming of HTSS.The roulette wheel mechanism and Lattice Monte-Carlo Simulation are employed for random multiperiod scenario generation.HTSS problem is formulated using linearized multiobjective programming while maximizing expected profits and minimizing expected emission of GENCOs.The modified augmented ɛ-constraint method is implemented to generate Pareto optimal solutions.

@&#KEYPHRASES@&#
Stochastic programming,Hydro-thermal self scheduling,Price uncertainty,Generating unit contingency,Multiobjective mathematical programming,

@&#ABSTRACT@&#
In this paper, a stochastic multiobjective framework is proposed for a day-ahead short-term Hydro Thermal Self-Scheduling (HTSS) problem for joint energy and reserve markets. An efficient linear formulations are introduced in this paper to deal with the nonlinearity of original problem due to the dynamic ramp rate limits, prohibited operating zones, operating services of thermal plants, multi-head power discharge characteristics of hydro generating units and spillage of reservoirs. Besides, system uncertainties including the generating units’ contingencies and price uncertainty are explicitly considered in the stochastic market clearing scheme. For the stochastic modeling of probable multiobjective optimization scenarios, a lattice Monte Carlo simulation has been adopted to have a better coverage of the system uncertainty spectrum. Consequently, the resulting multiobjective optimization scenarios should concurrently optimize competing objective functions including GENeration COmpany's (GENCO's) profit maximization and thermal units’ emission minimization. Accordingly, the ɛ-constraint method is used to solve the multiobjective optimization problem and generate the Pareto set. Then, a fuzzy satisfying method is employed to choose the most preferred solution among all Pareto optimal solutions. The performance of the presented method is verified in different case studies. The results obtained from ɛ-constraint method is compared with those reported by weighted sum method, evolutionary programming-based interactive Fuzzy satisfying method, differential evolution, quantum-behaved particle swarm optimization and hybrid multi-objective cultural algorithm, verifying the superiority of the proposed approach.thermal unit indexhydro unit indextime interval (hour) index. For instance, p(j,t,s) is the power output of hydro unit j at hour t in the sth scenario (MW)scenario indexnetwork area indexprobability of kth price levelbilateral contract price ($/MWh)emission price ($/lbs)number of periods in the planning horizonshut-down cost of unit i ($)start-up cost of unit j ($)slope of block n of fuel cost curve of unit i ($/MWh)slope of the volume block n of the reservoir associated to unit j (m3/s/Hm3)slope of the block n of the performance curve k of unit j (MW/m3/s)slope of segment n in emission curve of unit i (lbs/MWh)coefficients of valve loading cost functiongenerated emission by off-unit while providing non-spinning reserve (lbs)generated emission of n−1th upper limit in the emission curve of unit i (lbs)emission group (SO2orNOx)emission quota (lbs)generation cost of n-1th upper limit in the fuel cost curve of unit i ($/h)forecasted natural water inflow of the reservoir associated to unit j (Hm3/h)number of performance curvesnumber of prohibited operating zonesnumber of blocks of the piecewise linearized start-up fuel functionnumber of price levelsnumber of scenario after scenario reductionnumber of areas in the networkpower capacity of bilateral contract (MW)probability of scenario snormalized probability of scenario sminimum and maximum power output of unit i (MW)minimum power output of unit j for performance curve n (MW)capacity of unit j (MW)lower limit of nth prohibited operating zone of unit i (MW)upper limit of n−1th prohibited operating zone of unit i (MW)minimum and maximum water discharge of unit j (m3/s)ramp down and ramp up limit for block n (MW)start-up and shut-down emission generated by unit i (lbs)start-up and shut-down ramp rate limit of unit i (MW/h)ramping down and ramping up limit of unit i (MW)minimum content of the reservoir associated to unit j (Hm3)maximum content of the reservoir j associated to nth performance curve (Hm3)generation of block n of fuel cost curve for unit i (MW)generation of block n of unit i for valve loading effect curve (MW)market price for energy, spinning and non-spinning reserve ($/MWh), respectivelyindividual membership function (the degree of optimality) for the nth objective function in the rth Pareto optimal solutionthe weight factor of the nth objective function in the MMP problemtotal membership function of the rth Pareto optimal solutionstart-up cost of unit i ($)valve loading effect cost of unit i ($)fuel cost of unit i ($)main objective function (expected profit of GENCO)GENCO's total expected profit in dollars after arbitrageexpected generated emission for each Pareto optimal solution (lbs)non-spinning reserve of thermal unit i in the spot market when unit is off and on, respectively (MW)non-spinning reserve of a hydro unit j in the spot market when unit is off and on, respectively (MW)power output of thermal unit i (MW)maximum power output of unit i (MW)power output of hydro unit j (MW)power for bid on the spot market (MW)profit of scenario swater discharge of hydro unit j and block n (m3/s)spinning reserve of a thermal unit i and hydro unit j in the spot market (MW), respectivelywater content of the reservoir associated with unit j (Hm3)1 if thermal unit i is on1 if hydro unit j is on1 if unit i provide non-spinning reserve when unit is off.1 if block n of fuel cost curve of unit i is selected1 if volume of reservoir water is greater than vn(j)1 if power output of unit i has exceeded block n of valve loading effect curveobtained from the roulette wheel mechanism in the scenario generation stage indicating whether kth price level in the sth scenario occurred(wk,t,sP=1)or not(wk,t,sP=0)status of the ith thermal and jth hydro unit obtained from LMCS in the scenario generation stage (forced outage state, i.e. W=0 or available, i.e. W=1).1 if thermal unit i is started-up1 if hydro unit j is started-up1 if unit i is shut-downthermal unitshydro unitsset of indices of blocks of piecewise linearized hydro unit performance curvethe blocks of piecewise linearized thermal unit emission curvethe periods of market time horizon T={1, 2, …, NT}scenario

@&#INTRODUCTION@&#
For several years Unit Commitment (UC) has been used to determine the optimal scheduling of power producers for different horizons (daily, weekly and etc.). The Independent System Operator (ISO) implements Security-Constrained Unit Commitment (SCUC) problem that its objective function is minimization of cost while considering system security and meeting system load. GENeration COmpanies (GENCOs) uses Price-Based Unit Commitment (PBUC) to maximize their profit but they are not concerning about providing the system load [1]. The UC and PBUC are respectively termed as the Hydro-Thermal Scheduling (HTS) and Hydro-Thermal Self Scheduling (HTSS) [2] for the system with the hydro and thermal units. Different solution methods of the HTSS problem are comprehensively classified into heuristic and analytical methods in Ref. [3]. In Ref. [4], a novel mixed-integer nonlinear approach is proposed to solve the short-term hydro scheduling problem in the day-ahead electricity market, considering not only head-dependency, but also start/stop of units, discontinuous operating regions and discharge ramping constraints.In Ref. [5], a stochastic programming formulation is proposed for trading wind energy in a market environment under uncertainty of energy market prices as well as the volatile and intermittent nature of wind energy. Optimal hydro scheduling for the short-term time horizon is proposed in Ref. [6] wherein a mixed-integer nonlinear programming framework including the head effect on power production, start-up costs of units, multiple operating regions, and discharge variation constraints is considered. Also in Ref. [6], as new contributions to the field, the market price uncertainty is introduced in the model via price scenarios. Also, the risk management is included in Ref. [6] using Conditional Value-at-Risk (CVR) to limit profit volatility. In Ref. [7], Monte Carlo Simulation (MCS) method is implemented to generate random hourly prices for energy, ancillary services, and fuel in the stochastic PBUC framework. A stochastic midterm risk-constrained hydrothermal scheduling algorithm is proposed for profit maximization of GENCOs in Ref. [8]. In Refs. [9,10], the stochastic SCUC is implemented for the electricity market clearing problem while reserve services are determined based on the expected-load-not-served. Two methodologies are suggested to reduce computational burden of the stochastic UC in Ref. [11]. The stochastic nature of the electricity price is modeled in a multi-stage stochastic framework for thermal units’ self-scheduling in Ref. [12]. Ref [13] used a deterministic MIP approach for solving the HTSS problem of generating units. Also, [14] presents a mixed- integer stochastic framework for a hydro-wind power system scheduling. Ref. [15] presents the techno-economic factor for distributed generation units based on the effect of their generation on the network losses. The MCS method is used for the outages of generating units and transmission lines together with the load forecasting inaccuracies in the SCUC problem in Ref. [16]. A stochastic self-scheduling for thermal units based on the ARIMA model is utilized in Ref. [17]. In Ref. [18], an interval-fuzzy two-stage stochastic programming method is developed for the carbon dioxide (CO2) emission trading under uncertainty. It is worth to mention that, in the above-mentioned papers, the valve loading effect and dynamic ramp rate are not taken into account. On the other hand, to the best of our knowledge, no research work in the area considers a stochastic multiobjective multiperiod framework for the HTSS problem. In other words, the uncertainty sources (generating unit contingencies and price forecast uncertainty) have been taken into account in this work. Accordingly, the main contribution of this paper is to present a multiperiod stochastic multiobjective framework for the short term HTSS. In the proposed model, the expected profit is maximized based on the MIP optimization formulation while at the same time the expected emission is minimized in the form of multiobjective stochastic problem. Furthermore, the price uncertainty is considered using the Probability Distribution Function (PDF) of price forecast error. Concurrently, the roulette wheel mechanism is implemented to generate the price of energy and spinning/non-spinning reserve for each hour and Lattice Monte Carlo simulation (LMCS) method is applied to consider Forced Outage Rate (FOR) of units. For the sake of accuracy, more practical constraints of thermal and hydro units are taken into account. In Refs. [19–21], the valve loading effect cost is modeled in the form of a nonlinear sinusoidal function which is linearized in our framework. Based on the work [22], different dynamic ramp rate is also proposed in the HTSS framework. Finally, a general formulation is recommended for the multi-performance curve of hydro units based on [23]. Different solution methods for the optimization problem can be found in Refs. [24–27]. Accordingly, the proposed HTSS includes a linear formulation for valve loading effect, fuel cost, emission function, fuel constraint, and multi-performance power-discharge curves of hydro units as well as units’ minimum up/down time. A GENCO can use the proposed methodology in their day-ahead scheduling to find the optimal decision for the UC for the next day. The new contributions of this paper with respect to the previous works can be briefly summarized as follows:(a)A new multiobjective model for the HTSS is proposed considering emissions in addition to cost function using linearized formulations. A new approach incorporating the lexicographic optimization and ɛ-constraint method is proposed to solve the multiobjective problem.Different operating constraints of thermal and hydro units have been included in the proposed formulations. Also, all the nonlinear terms of the HTSS formulations have been converted to linear forms using mixed integer techniques and piece-wise linearization.The generating units’ contingencies and price uncertainty are explicitly considered in the stochastic programming of the HTSS problem using the roulette wheel mechanism and Lattice Monte-Carlo Simulation (LMCS).Some discussions regarding emission trade, as a new paradigm in new era of power system operation, have been presented in the paper.The remainder of this paper is organized as follows: In section II, the proposed stochastic modeling of HTSS problem is formulated concerning system's uncertainties. In section III, the MIP formulation for the stochastic multiobjective HTSS has been presented. Solution approach of the multiobjective optimization problem is discussed in section IV. In the next section, the IEEE 118-bus test system is studied to demonstrate effectiveness of the proposed scheme. Some relevant conclusions are drawn in the section VI.There are some uncertain factors like market price and outages of generating units that affect the profit of the GENCO. However, several methods exist to characterize the uncertainty of the problem due to market price and outages of generating units, among which Monte-Carlo Simulation (MCS), time series technique, input/output hidden Markov model and Generalized Auto-Regressive Conditional Heteroskedasticity (GARCH) model are the well-known ones. However, this paper uses the Lattice Monte-Carlo Simulation (LMCS) method to consider the outages of generating units as well as the price uncertainty based on the price forecast error. Lattice rule is an algorithm to generate low-discrepancy procedures leading to better results than ordinary MCS method [16]. An n-point lattice rule of rank-r in d-dimension is defined as follows [16]:(1)∑l=1rklnl.vlmod1kl=0,1,...,nl−1l=1,…,rwherev1,v2,…andvrare randomly generated and linearly independent d-vector of integers. The dimension d indicates the number of random values required to generate each scenario and nlrepresents the variation range of klin rank l (l=1,2, …, r). The points generated by the rank-1 lattice rule and ordinary MCS are shown in Fig. 1(A) and (B), respectively. The points generated by the LMCS have a much more uniform distribution and better covers the space of the figure. Therefore, the LMCS is implemented based on the Forced Outage Rate (FOR) of units to model generating units’ uncertainties. Fig. 2shows a typical continuous distribution function of the price forecast error along with its discretization. Here, seven intervals are centered on the zero mean and each of the intervals is one price forecast error standard deviation (σ) wide, as done in Ref. [28]. On the basis of different price forecast levels and their obtained probabilities from the PDF, roulette wheel mechanism [29,30] is implemented to generate price scenarios for each hour. For this purpose, at first, the probabilities of different price forecast levels are normalized such that their summation becomes equal to unity. Then the range of [0,1] is accumulated by the normalized probabilities as shown in Fig. 3. After that, random numbers are generated between [0,1]. Each random number falls in the normalized probability range of a price forecast level in the roulette wheel. That price forecast level is selected by the roulette wheel mechanism for each hour of a scenario.Scenario reduction techniques can be ultimately employed to reduce the number of scenarios while maintaining a good approximation of the system uncertain behavior. In this paper, the basic idea of the scenario reduction is to eliminate a scenario with very low probability and scenarios that are very similar [28,29]. Accordingly, the scenarios with higher probabilities as well as dissimilar ones should be extracted (NS scenarios) to be implemented in the stochastic multiobjective HTSS problem. The probability of each generated scenario can be calculated as follows:(2)P(s)=∏t∈T∑k=1NP(Wk,t,sP.αk)∏i∈IWi,t,s(1−FOR(i))+(1−Wi,t,s)FOR(i)∏j∈JWj,t,s(1−FOR(j))+(1−Wj,t,s)FOR(j)where∑k=1NLWk,t,sP=1.The binary parametersWk,t,sP, are determined by the roulette wheel mechanism and Wi,t,sand Wj,t,sare specified by the LMCS for each hour of each scenario. Subsequently, the normalized probability of scenarios can be calculated as follows:(3)Pr(s)=P(s)∑s=1NSP(s)The flowchart of the proposed scenario-based stochastic modeling of uncertainties is illustrated in Fig. 4.The idea of the stochastic programming of the HTSS problem is to construct or sample possible options for uncertain circumstances, solve the deterministic optimization problem for the possible options, and select a good combination of the outcomes to represent the stochastic solution. So, in the proposed stochastic HTSS structure, the expected value is considered, which is the aggregation approach adopted in many stochastic frameworks such as [16]. It is noted that theoretically deviation from the minimum limits constraints, such as (18) of the paper, might occur in the aggregated solution obtained by the expected value operator. For a better illustration of this matter, simply consider two scenarios with the equal probability wherein a unit is assigned ON and OFF states in these two, respectively. Aggregated value of the generation output of this unit obtained by the expected value operator is half of its generation in the ON scenario, which may deviate from its minimum limit. On the other hand, deviation from the maximum limit constraints, such as (18) of the paper, cannot be occurred in the expected value based scenario aggregation result, since each scenario result separately satisfy the maximum limit constraints and so a weighted average of the scenario results cannot deviate from these constraints. At the same time, we observed no deviation from the minimum limit constraints in our all experimental results, since our remained scenarios after scenario reduction do not have much diversity (the low probability scenarios are removed by the scenario reduction technique). So, deviation from the minimum limit constraints by the expected values is not observed in our results. However, if in a test case, deviation from these constraints is likely to be occurred then inter-scenario constraints can be used to avoid such deviations. For instance, in Ref. [16], bundle constraints are proposed to avoid infeasible solutions with the expected value based scenario aggregation. Another alternative is to impose these constraints on the aggregated results (expected values). However, both approaches lead to inter-scenario constraints and so the obtained problem becomes more complex than the present stochastic framework, which can be solved using decomposition techniques (e.g., benders decomposition). This matter is beyond the scope of this paper and will be considered in our future work.The proposed multiobjective stochastic framework for HTSS contains two objective functions as follows:(4)Objectivefunctions=F1expectedprofitmaximizationF2expectedemmisionminimizationwhere F1, and F2are the objective functions of the HTSS as following subsections.The main objective function of problem is the Expected Profit (EP) maximization, written as follows:(5)F1:maxEP=πb(t)pb(t)+∑s∈NSPr(s)PROFIT(s)(6)PROFIT(s)=∑t∈Tπsp(t,s)psp(t,s)+∑i∈Iπsr(t,s)R(i,t,s)+πns(t,s)Nu(i,t,s)+Nd(i,t,s)+∑j∈Jπsr(t)R(j,t,s)+πns(t,s)Nu(j,t,s)+Nd(j,t,s)−∑i∈IF(i,t,s)+Aiz(i,t,s)+B(i,t,s)+C(i,t,s)−∑j∈JAjy(j,t,s)where the EP is the main objective function which equals to constant revenue from bilateral contract (the first term of (5)) plus the summation of revenue of each scenario times to its corresponding probability (the second term of (5)). Eq. (6) shows the profit of each scenario and the first term of this equation is related to revenue from the sales of energy. Second and third term refer to revenue from the sales of ancillary services on the spot market by thermal and hydro units, respectively. Fourth and 5th terms stand for thermal and hydro units cost, respectively. Subsection III.C shows more details for thermal units cost which consists of fuel cost, shut-down cost, start-up cost and valve loading effects cost, respectively. The last term of Eq. (6) refers to hydro plants start-up cost because of wear and tear of the windings and mechanical equipments, loss of water during maintenance and start-up and finally malfunctions in the control equipments [31].The second objective function of the HTSS problem is to minimize the expected emission of thermal units which can be written as follows:(7)F2:minEE=∑s∈NSPr(s)∑i∈EGR∑t∈TEmin(i)Id(i,t,s)+∑n=1NEβn(i,t,s)E(pn−1u(i))+ben(i)δn(i,t,s)+SUE(i)y(i,t,s)+SDE(i)z(i,t,s)where EGR={SO2, NOx}, since the SO2 and NOxare the most important emissions in power generation industry which have harmful effects on the environment [32]. The emission function is linearized using the piecewise linear approximation as shown in Fig. 5. In order to more accurately model the problem, the emission function consists of emission due to start-up and shut-down of thermal units. Note that the first term represents the emission caused by off thermal units when providing non-spinning reserve [13].The proposed HTSS framework is subject to the equality and inequality constraints. One of them is that the total generated power of thermal and hydro units should be equal to the total power sold in the spot market and bilateral contract for each hour of each scenario as follows:(8)∑i∈Ip(i,t,s)+∑j∈Jp(j,t,s)=pb(t)+psp(t,s);∀t∈T,∀s∈SaThe other constraints of the thermal units and hydro units are presented in Sections 3.1, 3.3 and 3.4, respectively.This subsection pertains to the linearization of all the nonlinear equations of the thermal units.Usually quadratic function is used to present the fuel cost of the thermal units. However, thermal units cannot operate in some specific zones due to the physical operating restrictions. Consequently, their fuel cost function is a discrete function. The proposed piecewise linear model for fuel cost function with M POZs is as follows as:∀i∈I,∀t∈T,∀s∈S(9)F(i,t,s)=∑n=1M+1[βn(i,t,s)F(pn−1u(i))+bn(i)δn(i,t,s)](10)P(i,t,s)=∑n=1M+1[pn−1u(i)βn(i,t,s)+δn(i,t,s)]where F(i,t,s) is the piecewise linearized fuel cost function and βn(i,t,s) is binary variable and equal to 1 if power block n for thermal unit i of piecewise fuel cost curve selected. The second term in Eq. (9) is related to the slope and generation of power block n. The amount of unit output is determined by (10). The other constraints for linearization of fuel cost function can be formulated as follows [33]: ∀i∈I, ∀t∈T, ∀s∈S(11)δn(i,t,s)≥0;n=1,2,…,M+1(12)δn(i,t,s)≤[pnd(i)−pn−1u(i)]βn(i,t,s);n=1,2,…,M+1(13)∑n=1M+1βn(i,t,s)=I(i,t,s)wherep0u(i)=pmin(i)andpM+1d(i)=pmax(i)in (12). Eq. (11) indicates that power output of each block is positive Eq. (12) shows he generated power of each unit is restricted by its upper limit. Constraint (13) forces the selected thermal unit to operate only at one of the operating zones.The valve loading effect is modeled as an absolute sinus function of the generated power [19–21] which has a nonlinear form. In the proposed MIP formulation for the HTSS problem, the valve loading effect is linearized, as shown in Fig. 6, according to the following equations.(14)C(i,t,s)=2eifiπ2∑n=0ki[ψ4n+1(i,t,s)−ψ4n+4(i,t,s)]+(2−2)∑n=0kiψ4n+2(i,t,s)−ψ4n+3(i,t,s)(15)p(i,t,s)=pmin(i)I(i,t,s)+∑n=0kiψ4n+1(i,t,s)+ψ4n+2(i,t,s)+ψ4n+3(i,t,s)+ψ4n+4(i,t,s)∀i∈I,∀t∈T,∀s∈S(16)π4fiχ1(i,t,s)≤ψ1(i,t,s)≤π4fiI(i,t,s)∀i∈I,∀t∈T,∀s∈S(17)π4fiχn(i,t,s)≤ψn(i,t,s)≤π4fiχn−1(i,t,s);∀i∈I,∀t∈T,n=2,3,…,xi,∀s∈Ski=ceilfipmax(i)−pmin(i)π,xi=ceil4fipmax(i)−pmin(i)πThe ceil (·) function, approximate its argument to its nearest upper integer value. For instance ceil (3.1)=4.where eiand fiare coefficients of valve point effects for ith thermal unit and ψn(i,t,s) is power generated by nth block. Eq. (15) indicates that the generated power by the thermal unit i at the hour t of scenario s is the sum of its minimum power output when that unit is committed, plus the produced power in each block. Constraint (16) determines the thermal unit output in the first block. In other words, the thermal units output in the first block should smaller than or equal to π/4fi. In Eq. (16), the binary variable I(i,t,s) prevents unit i to generate power, if it is decommitted at the hour t of the scenario s. In order to restrict the produced power in each block, the binary variable χn(i,t,s) is introduced in constraints (16) and (17). In fact, the binary variable will be equal to 1, if the output of the thermal unit i at the hour t of the scenario s is more than the upper limit of the block n. In other words, the binary variable χn(i,t,s)=1 if p(i, t, s)>Pmin(i, t, s)+(nπ/4fi).The upper and lower limit constraints of the thermal units including the ramp up limit (RUL) and ramp down limit (RDL) can be written as follows:(18)pmin(i)I(i,t,s)≤p(i,t,s)≤p¯(i,t,s)(19)p¯(i,t,s)≤pmax(i)I(i,t,s)−z(i,t+1,s)+SD(i)Z(i,t+1,s)(20)p(i,t−1,s)−p(i,t,s)≤SD(i)Z(i,t,s)+RDL(p(i,t,s))(21)p(i,t+1,s)−p(i,t,s)≤SU(i)y(i,t+1,s)+RUL(p(i,t,s))Eq. (18) indicates the power generation limit of thermal units and Eq. (19) illustrates the upper limit of power generation by thermal units at each time. The shut-down ramp rate and Ramp-Down Limit (RUL) are shown in Eq. (17) while Eq. (18) indicates the start-up ramp rate and Ramp-Up Limit (RUL).Based on the work [22], the proposed dynamic ramp rate of the thermal units is as follows:(22)RDL(p(i,t,s))=∑n=1M+1RDLn(i)βn(i,t,s)∀i∈I,∀t∈T,∀s∈S(23)RUL(p(i,t,s))=∑n=1M+1RULn(i)βn(i,t,s)∀i∈I,∀t∈T,∀s∈SAccording to (22) and (23), the dynamic ramp rate is related to thermal units by βn(i,t,s).Reserve Services: In order to sustain sudden events of power systems such as the outages of transmission lines and generators, the operating services (spinning reserve and non-spinning reserve) are considered as done by [16]. The other constraints of the proposed HTSS problem, as addressed in Refs. [2,34], are: time varying start-up cost function, Minimum Up-Time (MUT) and Minimum Down-Time (MDT), and Logical status of commitment. Also, the fuel limit constraints are taken from [7,16].In this section the constraints of the hydro units are addressed.The linear formulations of the hydro units with L performance curves, as shown in Fig. 7, are as the following equations:(24)av(j,t,s)≥v0(j);∀j∈J(25)v(j,t,s)≤vL(j)βL−1(j,t,s)+∑n=2Lvn−1(j)[βn−2(j,t,s)−βn−1(j,t,s)](26)v(j,t,s)≥vL−1(j)βL−1(j,t,s)+∑n=3Lvn−2(j)[βn−2(j,t,s)−βn−1(j,t,s)](27)β1(j,t,s)≥β2(j,t,s)≥…≥βL−1(j,t,s)Eq. (24) indicates that the volume of each hydro plant at each period should be greater than the minimum content of that hydro plant. Eqs. (25) and (26) stand for the right head corresponding to volume. The Eqs. (24)–(27) determine the integer variable of βn(j,t,s) for performance curves based on the water volume. In other words, these equations choose the right curve for head according to the content level.The linear relationship between generated powers, discharged water and performance curves is presented as:(28)p(j,t,s)−p_k(j)I(j,t,s)−∑n∈Nqn(j,t,s)bnk(j)−p¯(j)[(k−1)−∑n=1k−1βn(j,t,s)+∑n=kL−1βn(j,t,s)]≤0,1≤k≤L(29)p(j,t,s)−p_k(j)I(j,t,s)−∑n∈Nqn(j,t,s)bnk(j)+p¯(j)[(k−1)−∑n=1k−1βn(j,t,s)+∑n=kL−1βn(j,t,s)]≥0,1≤k≤LIn above constraints, p(j,t,s) is power generated by hydro plant at hour t and scenario s andp_k(j)is minimum generation of kth head. Proper head appointed by βn(j, t, s) andp¯(j)is capacity of hydro plant j and qn(j,t,s) is water discharge of block n andbnk(j)is slope of the block n of the performance curve k of hydro plant j.The water discharge limits are similar to those presented in Ref. [23]; however, in the proposed stochastic multiobjective HTSS model the spillage effect is also considered [2]. Also, the initial value of the reservoir, water balance [2,23], and operating services [16] are considered in the proposed HTSS problem.In Multiobjective Mathematical Programming (MMP), there is more than one objective function and there is no single optimal solution that simultaneously optimizes all the objective functions. A well-organized technique to solve MMP problems owning one main objective function among all objective functions is the ɛ-constraint method which is used to solve the proposed stochastic multiobjective HTSS problem in this paper. In general, the ɛ-constraint technique [35,36] optimizes the main objective function f1considering the other objective functions as constraints:(30)minf1(x¯)subjecttof2(x¯)≤e2f3(x¯)≤e3…fp(x¯)≤epwhere the subscript p indicates the number of competing objectives functions of the MMP problem andx¯refers to the vector of decision variables. In (30), it is assumed that all p objective functions should be minimized. In order to properly apply the ɛ-constraint method, the ranges of at least p−1 objective functions are needed that will be used as the additional objective function constraints. The most common approach is to calculate these ranges from the payoff table. To calculate the payoff table for a MMP problem with p competing objective functions, at first, the individual optima of the objective functions fiare calculated. The optimum value of fiis indicated byfi*(x¯i*)wherex¯i*refers to the vector of decision variables which optimizes the objective function fi. Then, with the solution that optimizes the objective function fi, the value of the other objective functions f1, f2,…, fi−1, fi+1,…,fpis calculated, which are represented byf1(x¯i*),f2(x¯i*),…,fi−1(x¯i*),fi+1(x¯i*), …,fp(x¯i*). The ith row of the payoff table includesf1(x¯i*),f2(x¯i*), …,fi*(x¯i*), …,fp(x¯i*). In this way all rows of the payoff table are calculated as follows:(31)Φ=f1*(x¯1*)⋯fi(x¯1*)⋯fp(x¯1*)⋮⋱⋮f1(x¯i*)⋯fi*(x¯i*)⋯fp(x¯i*)⋮⋱⋮f1(x¯p*)⋯fi(x¯p*)⋯fp*(x¯p*)The payoff table has p rows and columns. The jth column of the payoff table includes the obtained values for the objective function fjamong which the minimum and maximum values indicate the range of the objective function fjfor the ɛ-constraint method. To enhance the ɛ-constraint method to the proposed MMP solution technique, at first a few concepts should be introduced. Without losing generality, it is again supposed that all objective functions should be minimized.Utopia point is a specific point, generally outside of the feasible region, that corresponds to all objectives simultaneously being at their best possible values. The utopia is written as:(32)fU=f1U,…,fiU,…,fpU=f1*(x¯1*),…,fi*(x¯i*),…,fp*(x¯p*)Nadir point is a point in the objective space where all objective functions are simultaneously at their worst values. The nadir point is written as:(33)fN=f1N,…,fiN,…,fpNwhere(34)fiN=maxx¯fi(x¯),subject tox¯∈Ωwhere Ω represents the feasible region. A close concept to nadir point is pseudo nadir point defined as follows:(35)fSN=f1SN,…,fiSN,…,fpSN(36)fiSN=maxfi(x¯1*),…,fi*(x¯i*),…,fi(x¯p*)It is noted that utopia, nadir and pseudo nadir points are defined in the objective space, which is a vector space with the objective functions as its dimensions. In the ɛ-constraint technique, the range of each objective function in the payoff table is determined based on the utopia and pseudo nadir points, that is:(37)fiU≤fi(x¯)≤fiSNOptimization of MMP problems is to identify the set of Pareto optimal solutions. For a general multi-objective optimization problem of (25), a pointx¯*∈Ωis Pareto optimal or efficient solution for the MMP problem if and only if there is nox¯∈Ωsuch thatfi(x¯)≤fi(x¯*)for all i=1, 2, …, p with at least one strict inequality.After finding the range of all objective functions based on (37), the ɛ-constraint technique divides the range of p-1 objective functions f2, …,fpto q2, …, qpequal intervals using (q2−1), …, (qp−1) intermediate equidistant grid points, respectively. Considering the minimum and maximum values of the range, we have in total (q2+1), …, (qp+1) grid points for f2, …, fp, respectively. So, we should solve∏i=2p(qi+1)optimization subproblems, where the subproblem (n2, …, np) has the following form:(38)minf1(x¯)subject tof2(x¯)≤e2,n2,…,fp(x¯)≤ep,np(39)e2,n2=f2SN−f2SN−f2Uq2×n2n2=0,1,…,q2(40)e2,np=fpSN−fpSN−fpUqp×npnp=0,1,…,qpwhere the superscript U and SN refer to the value of the objective function in the utopia and pseudo nadir points as shown in (32) and (36), respectively. The constraints of the MMP problem should be also considered in each of these optimization subproblems in addition to the objective function constraints mentioned in (38). By solving each optimization subproblem, one Pareto-optimal solution is obtained in the ɛ-constraint technique. Some of these optimization subproblems may have infeasible solution space, which will be discarded. Among the obtained Pareto-optimal solutions, the most preferred one is selected by the decision maker.The advantages of the proposed method can be listed as following:i.For linear problems, the weighting method generates only efficient extreme solutions. On the contrary, the epsilon-constraint method is able to produce non-extreme efficient solutions [35].Despite the weighting method, the epsilon-constraint method can produce unsupported efficient solutions in multiobjective integer and mixed integer programming problems [35].In the epsilon-constrained method, the scaling of the objective functions is not necessary while this is needed in the weighting method [35].In the epsilon-constraint method, the number of the generated efficient solutions can be controlled by properly adjusting the number of grid points in each one of the objective function ranges [35].Despite the above advantages, the epsilon-constraint method has two points that need attention:i.Firstly, the range of the objective functions over the efficient set is not optimized. To solve this problem, lexicographic optimization technique is proposed here.Secondly, the generated Pareto optimal solutions by the epsilon-constraint method may be dominated or inefficient solutions. Augmented-weighted epsilon-constraint technique is suggested to remedy this deficiency. The details of incorporating lexicographic optimization and augmented-weighted epsilon-constraint technique have been described in our previous paper in the area [37,38]. To avoid tautology in writing, these matters have not been repeated in this paper.The presented MMP solution method is formed by coming together the augmented-weighted ɛ-constraint technique and lexicographic optimization. The procedure of the proposed method can be stated as follows:Step 1: By employing the lexicographic optimization approach, the payoff table pertaining to a MMP problem is computed.Step 2: The range of the ith objective function (i=2, 3,…, p) is determined using payoff table.Step 3: According to formulation proposed in (39) and (40), the range of at least p-1 objective functions is divided into qi (i=2, 3,…, p) equal intervals.Step 4: The feasible optimization sub-problems in (38) are solved applying the presented MMP solution method to produce the Pareto efficient solution while the infeasible ones are discarded.Step 5: The efficient solutions derived through step 4 is evaluated using the Fuzzy decision making process; Eq. (41)–(43), to choose the most desired Pareto optimal solution.The proposed optimization framework for ɛ-constraint optimization method for MMP problem is illustrated in Fig. 8.In order to choose the best compromise solution among the obtained Pareto optimal solutions by the ɛ-constraint method, a fuzzy decision maker is proposed which can softly select the most preferred compromise solution among the Pareto solutions [29,37–42]. For this purpose, the fuzzy decision maker calculates a linear membership function for each objective function in each Pareto optimal solution, which measures the relative distance between the value of the objective function in the Pareto optimal solution from its values in the respective utopia and pseudo nadir points. The mathematical formulation of these membership functions for the MMP market clearing problem is as follows:(41)μnrn=1=0fnr≤fnSNfnr−fnSNfnU−fnSNfnSN≤fnr≤fnU1fnr≥fnU(maximization)(42)μnrn=2=1fnr≤fnUfnSN−fnrfnSN−fnUfnU≤fnr≤fnSN0fnr≥fnSN(minimization)The fuzzification process described in (41) and (42) is used for the objective functions that should be maximized and minimized, respectively. The total membership function (total degree of optimality) of each Pareto optimal solution is computed considering the individual membership functions and the relative importance of the objective functions (wnvalues) as follows:(43)μr=∑n=1pwn⋅μnr∑n=1pwnThe most preferred solution refers to the Pareto solution with the highest value of μror the highest preference for the MMP problem. This solution more optimizes the objective functions of the MMP problem, considering their relative importance, than the other Pareto solutions [29,37–42].In some circumstances, selling the emission quota is more profitable than selling the power; therefore, the GENCO can use this opportunity to obtain more profit. On the other hand, in some cases, the GENCO is forced to procure emission quota, to increase its output to obtain more profit. The total profit of the GENCO considering emission arbitrage is as follows:(44)EA=EP+πE×(EQUATA−EE)where EA, denotes that GENCO's total profit in dollars, EP is the obtained profit of each Pareto optimal solution in dollars, πEis the price of emission in $/lbs, EQUOTA is the emission quota in (lbs) and finally EE is the expected generated emission of each Pareto optimal solution in (lbs). If EQUOTA>EE, then an excess quota is available that can be sold in the market. On the other hand if EQUOTA<EE then the GENCO need to purchase additional emission quota [52]. Hence, for each Pareto-optimal solution EA is calculated and then the solution with the highest value of EA can be chosen as the best solution by the GENCO.The case study used to illustrate the proposed stochastic multiobjective HTSS is the well-known IEEE 118-bus test system. This system contains 54 thermal units which are 10 oil-fired, 11 gas-fired and 33 coal-fired units. Eight hydro units are considered that their required data are taken from [23]. The POZ data and valve loading coefficients are taken from [43]. Based on [2], the start-up cost of thermal units is linearized in 3 blocks. Also, based on [32] the emission functions of SO2 and NOxhave been linearized in 4 blocks as shown in Fig. 5. It is assumed that both SU(i) and SD(i) are equal to 0.7*Pmax(i). Bilateral contract at each hour is 1000MWh at the price of 40$/MWh. Also, it is assumed that the forecasted water inflow to the hydro plants is deterministic value while the proposed scheduling problem is considered for the short-term horizon plan. Due to lack of data, without the loss of generality, fix ramp rate data is used. For hydro units, 3 performance curves are used that each of them is linearized in 4 blocks as shown in Fig. 7. Total spinning and non-spinning reserves which can be sold at each hour of each scenario is 500MW. Other data for thermal units are taken from [43]. Thermal units 5, 10, 11, 28, 36, 43, 44 and 45 have valve loading effect cost and thermal units 7, 10, 30, 34, 35 and 47 have POZs limitations.The proposed MIP optimization problem of the stochastic multiobjective HTSS has been modeled in GAMS [44] software using CPLEX solver on a personal computer Pentium IV, 2.4GHz with 2 GB RAM. The optimization problem includes millions of continuous and discrete variables which increase the solution time and computational burden. For this reason, without the loss of generality, in the case study of the proposed stochastic multiobjective HTSS framework, the number of scenarios and also the periods of time scheduling (hours) are reduced. However, the parallel computation method and decomposing approach can significantly decrease solution time of the HTSS optimization problem. According to this study, the number of scenarios after scenario reduction is reduced to 10. Also, 10 periods (hours) are considered for the stochastic multiobjective HTSS. In other words in each scenario, the system is scheduled over ten successive hours. Accordingly, the case study of the stochastic multiobjective HTSS includes one deterministic (non-contingent generating units and without price forecast error) scenario plus nine scenarios considering the generating units’ contingencies as well as the price forecast errors. In this study, five different price forecast levels are considered as shown in Fig. 2 and the MCP for each hour of each scenario (except the first scenario that is deterministic) is determined based on the roulette wheel mechanism described in Section 2.The ɛ-constraint is used to find the Pareto solutions of the stochastic multiobjective HTSS problem. In the ɛ-constraint method, F1 (expected profit maximization) is considered as the main objective function. To solve the MMP problem, 19 grid points (q2=19) for F2, i.e. EE, is used for obtaining Pareto optimal solutions. So, the problem should be solved totally (q2+1=20) times to obtain the Pareto optimal solutions of the stochastic multiobjective HTSS which all of them have feasible solution.In order to better explanation of the proposed framework, four cases are considered which are:Case 1-Deterministic single objective HTSS: In case 1, the objective function is the profit maximization and include only one scenario wherein it is assumed that all units can be on if necessary after solving optimization problem and forecasted price is equal to the actual price. Therefore this case include Eqs. (5), (6) and (8) to (29).Case 2-Stochastic single objective HTSS: In this case, the objective function is profit maximization including uncertainty of price and availability of generation units. Therefore this case includes Eqs. (1)–(6), (8)–(29).Case 3-Deterministic multiobjective HTSS: The objective functions of this case are profit maximization and emission minimization. Also, it includes only one scenario wherein all units can be on if necessary after solving optimization problem and the forecasted price is equal to the actual price. Therefore, this case includes Eqs. (4)–(44).Case 4-Stochastic multiobjective HTSS: In case 4, the objective functions are profit maximization and emission minimization. Also, the uncertainty of price and availability of generation units has been considered in the formulation. Accordingly, this case includes Eq. (44).The results of cases 1 and 2 are shown in Table 1. The expected profit of the stochastic HTSS is lower than the profit in deterministic HTSS for the reason that in the stochastic framework in each scenario, some efficient units may decommitted based on their forced outage and therefore the profit of the GENCO is decreased. This difference in the profit can be interpreted as the value of perfect information[32]; i.e., the lack of information of the exact market price and also the exact status of generating units causes the GENCO to lose 6782$ (2,535,224–2,528,442=6782$) of profits. Also, the amounts of the emissions are shown in Table 1.For deterministic multiobjective HTSS, only 5 of 20 Pareto optimal solutions are reported in Table 2. The results show that the GENCO's emission is increased if the GENCO pursue more profit. In other words, obtaining more profit results in more emission showing the conflicting nature of these two objective functions. The best compromise solution can be selected by the fuzzy method or arbitrage approach [32], based on the GENCO's priority to obtain more profit or lower emissions. The arbitrage approach will be explained more in this section.In the case 4, the stochastic multiobjective HTSS is studied for 10 scenarios and 10 successive hours. The payoff table results of the case 4 are shown in Table 3.According to Table 3, both minimum and maximum value of the expected profit is lower than those of the deterministic ones. The minimum value of the expected profit is 1,894,347.22 $ which is lower than the lowest value of the profit in the deterministic HTSS as shown in the second column of the last row of Table 2, i.e. 1,899,232.71$. Similarly the maximum value of the profit is 2,533,858.45$ for the stochastic case against 2,535,646.92$ for the deterministic multiobjective HTSS as shown in the second column of the first row in Table 2. The difference in the profits is due to the uncertainty of price forecasting and units’ outage.To choose the optimal solution among the Pareto solutions of the problem, a fuzzy decision maker is used. The weighting factors (showing the importance of the objective function) are considered the same for 2 objective functions in the fuzzy decision maker (w1=w2=1). Results of equal weighting factors for these two objective functions are shown in Table 4. The membership value indicates the degree of optimality. If equal weighting factors are considered for two objective functions, then the total membership is obtained 0.616 for 20 Pareto solutions which is not acceptably optimized. However, changing the weighting factors can simply direct the decision maker to its interested solution. Nevertheless, the GENCO is more desirous to profit rather than the emission concerns. Therefore, the proposed method is solve again with the profit and emission weighting factors of 3 and 1, respectively, which logically searching for a Pareto solution with high value of the profit membership and low value of the emission membership as shown in Table 5. From Table 5 it can be seen that the membership value of the profit remarkably has been improved from 0.653 in case of equal weighting factors to 0.970 in the case of different weights. The profit value in Table 5 is equal to 2,514,601.40 $; indeed it is very close to its ideal value reported in Table 3. On the other hand, the emission is increased as its membership is low. In other words, according to Table 5, the GENCO prefers to obtain more profit rather than emission decrease.Since GENCOs are more desirous to increase profit rather than decrease emission, in the stochastic multiobjective HTSS problem, the optimal solution can be also obtained using arbitrage opportunity to gain more profit. Therefore, the emission arbitrage formulation (44) is calculated for all the Pareto optimal solutions obtained by the ɛ-constraint method and the optimal solution is ultimately selected. The advantage of the arbitrage trade compared to the fuzzy method is that the emission quota is implicitly considered and the chosen solution is more economic and realistic from GENCOs viewpoint. The Pareto solutions and their related emission trade are shown in Table 6. These arbitrage scenarios are calculated based on the EQUOTA=100,000lbs, with different prices of emission, i.e. πE=1, 2 and 3$/lbs, which are shown in the last three columns of Table 6. The negative value for emission indicates that GENCOs emission quota is not enough and it should accordingly purchase emission. In Table 6, the optimal solutions for each price of emission are represented with the bold numbers superscripted with asterisk. By the proposed method, the GENCO can readily analyze arbitrage opportunities and make a decision that improves the total profit.Finally, the number of variables and constraints and solution time for the four cases are presented in Table 7. From Table 7, it takes 6186s to find the Pareto optimal solutions of the case 4 of the problem. This is mainly for dimensionality issue which includes thousands of equations, continuous and discrete variables. Also from this table, one can see that the execution time of the problem is dramatically increased as the number of equations and variables of the problem increases.It is noted that the methods used to solve pure integer and mixed integer programming problems require dramatically more mathematical computation than those for similarly sized pure linear programs [44]. Many relatively small integer programming models take enormous amounts of time to solve.Moreover, when the memory is limited, the CPLEX solver will automatically make adjustments which may negatively impact the performance [44]. The MIP nature of our problem on one hand, and relatively large dimensions and memory limitations on the other hand, causes our HTSS optimization problem to take 6186s to be solved and find the Pareto optimal solutions. Nevertheless, the parallel computation and decomposing approach can significantly decrease this solution time. However, this paper pertains to present the comprehensive model for the stochastic multiobjective HTSS problem rather than computational viewpoints of the problem.We have used works [45–48] to compare the results of the proposed framework with them. It should be mentioned that the objective function of works [45–48] is the cost function. Also, in these works, emission function has been considered as another objective function of the optimization problem. All these works have used a heuristic approach to solve the problem. While the frameworks proposed in Refs. [45–48] are not completely same as the proposed scheme in this paper, i.e. multiobjective hydrothermal self-scheduling problem with objective functions of profit maximization and emission minimization, therefore we compare our proposed method with these references [45–48]. Accordingly, we have used their data, constraints and objective functions to show the performance of the proposed approach. Considering the above assumptions, the results of this case study are summarized in Tables 8 and 9which are taken from [48]. If we solve the same problem by the proposed method in this paper, the fuel cost is 43,250.01($) and emission value is 16,197.63 (lb). It can be seen from results that the proposed method can find better solution for fuel cost and emission in comparison with the results of [45–48]. Also, Table 10shows power generation of each thermal and hydro unit in each hour by solving the problem using the proposed method.Besides, in Table 11, we can see the solution time of each method. It is inferred from this table that the proposed algorithm in this paper has better efficiency from the calculation speed.

@&#CONCLUSIONS@&#
This paper presents a stochastic multiobjective HTSS framework in the form of MIP optimization problem in which the valve loading effect cost, dynamic ramp rate, POZs, fuel limitation are modeled all in linear form. It also includes multi-performance curves for hydro units making the HTSS framework more realistic. With the proposed method, each GENCO can cope with the uncertainties of the HTSS problem, i.e. price forecast error and generating units’ outage. Besides, each GENCO can compromise the conflicting objectives of the expected profit maximization in such a way that the GENCO's concerns about the emission are to some extent relieved. Furthermore, the stochastic approach leads to a more efficient utilization of generating units, allowing the GENCOs to estimate the effects of units’ contingencies and price uncertainty on the HTSS results. Covering the uncertainties by the proposed stochastic multiobjective HTSS, each GENCO can bid in the day-ahead market so as to gain profit as much as possible. Using the arbitrage approach make it possible for the GENCO to purchase its required emission or sell its emission quota to obtain more profit.The research work under way to (a) present a stochastic model with other scenario reduction techniques; (b) consider financial risk associated with the market price uncertainty, and (c) use accelerated benders decomposition to reduce computational burden.