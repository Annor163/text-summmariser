@&#MAIN-TITLE@&#
Active modes and switching instants identification for linear switched systems based on Discrete Particle Swarm Optimization

@&#HIGHLIGHTS@&#
Hybrid systems.Identification of a switched linear systems.Identification of active mode.Discrete Particle Swarm Optimization (DPSO).Application to: buck–boost converter.

@&#KEYPHRASES@&#
Switched linear systems (SLS),Identification,Discrete Particle Swarm Optimization (DPSO),Modal sequence,SARX,Buck–boost converter,

@&#ABSTRACT@&#
In this paper, a methodology for identifying switching sequences and switching instants of switched linear systems (SLS) is derived. The identification problem of a SLS is a challenging and non-trivial problem. In fact, it involves interaction between binary, discrete and real-valued variables. A SLS switches many times over a finite time horizon and thus estimating the sequence of activated modes and the switches locations is a crucial problem for both control and Fault Detection and Isolation (FDI). The proposed methodology is based on the Discrete Particle Swarm Optimization (DPSO) technique. The identification problem is formulated as an optimization problem involving noisy data (system inputs and outputs). Both a set of binary variables corresponding to each sub-model before and after each switch, and the corresponding switching instants are iteratively adjusted by the DPSO algorithm. Thus, the DPSO algorithm has to classify which sub-system has generated which data. The efficiency of the proposed approach is illustrated through a numerical example and a physical one. The numerical example is a Switched Auto-Regressive eXogenous (SARX) system and the physical one is a buck–boost DC/DC converter.

@&#INTRODUCTION@&#
Many applications in the real world processes are based on mathematical models, in particular for sake of control and diagnosis. Thus, an accurate estimation of such models and their parameters is highly required. In practice, many encountered systems exhibit switching between several operating modes. The switching mechanism can be either natural (switching systems) or imposed by an external authority (switched systems) [1].Conventionally, Hybrid Dynamical Systems (HDS) identification deals with the development of a useful mathematical description by appropriately treating input–output data. The main challenge with this framework is that the measured available data are only presented as a mixture of observations generated by different sub-models and usually corrupted by noise signals. Hence, one needs to assign each data to its generating mode, to detect when (or where) a commutation from one sub-system to another occurs and finally to estimate the parameters of all the sub-models describing the whole HDS [2].In this paper, we consider the problem of identifying the sequence of active sub-systems and their corresponding switching instants for the class of linear switched systems modelled in the state space formalism or as Switched Auto-Regressive eXogenous (SARX) models.The identification of HDS has been tackled using many traditional approaches which can be classified into two major families. The first one is based on algebraic tools [3] or on recursive algorithms [4,5]. These methods alternate in general between data assignment and parameters estimation. The second family presents the problem as an optimization one [6,7]. Continuous optimization framework in [7] is inspired by traditional estimation methods and supposed to avoid the use of discrete optimization generally known to suffer from combinatorial explosion. In [6] sparse optimization technique uses some relaxation strategies to convert the NP-Hard problem to a convexe one.Unfortunately, all these techniques have their limitations. Indeed, the algebraic procedures fail to find exact parameters specially in presence of noise [8]. Moreover, they are prone to be trapped in local minima because of their sensitivity to initialization. From an optimization point of view, the identification of HDS involves solving the combinatorial optimization problem which is known to be time consuming and thus used for small data sets.Being presented with such difficulties when tackled using classical techniques, the identification of HDS can be better achieved by robust methods of optimization. Since 1995, the general method of optimization based on particle swarms has been successfully used for engineering problems and in particular for dynamical systems identification [9–13,18]. As examples, we can cite the work in [9] about the identification of van der Pol–Duffing oscillators. In [10], on-line identification of permanent magnet synchronous motor was implemented and in [11], where the estimation of bilinear systems parameters based on a specific version of adaptive PSO is detailed. Morover, the work presented in [12] and relating directly to fault and mode switching identification based on PSO has implemented some sets of Global Analytical Redundancy Relations (GARRs) for fault diagnosis. The main shortage of this approach, in our opinion, is that PSO is not the adequate tool to solve such relations. Also, in our previous work [13], we have successfully applied the PSO to the identification of the switching instants and parameters of autonomous switched linear systems.The contribution of this paper consists on the development and the implementation of an identification method for the class of linear switched systems based on DPSO. The data issued from the whole system is presented as a mixture resulting from the activation of the local sub-systems. We need in fact to assign each group of data to its corresponding sub-system and to estimate eventual switching time locations over the observation window. The strategy adopted in this paper consists on associating a set of binary variables to each possible generator sub-system and a set of discrete variables to the switching instants. These variables are iteratively adjusted using a version of continuous PSO equipped with a powerfull confinement mechanism. The objective is then to minimize the sum of least-squared errors between the noisy output of the real HDS and its model. Thus, both data clustering and parameters estimation are performed simultaneously without any need for strong mathematical assumptions or regularities. The main condition to be ensured is that the error function is computable and its expression contains all the parameters to be identified.The paper is organized as follows: Section 2 presents the class of HDS to be identified both in state space formalism and in SARX form and then the identification problem is formulated. In Section 3, the proposed approach for active modes and switching instants identification is described. Section 4 discusses the results of two illustrative examples.Let us consider a switched linear system (see Fig. 1), supposed to describe a switched real process and defined by:(1)Sub-systemq:y(t)=∑h=1nahqy(t−h)+∑l=1mblqu(t−l)+e(t),q∈{1,…,M}where y(t) is the output of the model, u(t) is the input and q is a discrete variable indicating the qth sub-model of the SLS. n and m are respectively the orders of the system.ahqandblqare the regressor coefficients assumed to be constant. M is the number of sub-systems. e(t) is an additive noise term. Without loss of generality, we consider that all the sub-systems have the same orders.The system switches S times over a finite set of samples, t∈{0, …, N}. Let us define a sequence of active sub-systems Q and a set of switching instants τ(2)Q={q0,…,qS},τ={tc1,…,tcS}such that each sub-system qj∈{1, …, M}, j∈{0, …, S} is active during the interval of discrete instants {tcj+1, …, tc(j+1)}, tc(S+1)=N.Without loss of generality, let us explain the switching mechanism. Consider the SLS of Fig. 1 under the switching sequence 3→1→4→1→2→3 and define a set of discrete samples {0, …, N}. Assume that 5 mode changes occur respectively at the switching instants tc1, tc2, tc3, tc4 and tc5. The active sub-systems and the corresponding time intervals are defined in Table 1.The identification problem studied in this paper is defined as follows:Given the excitation input signal{u(t)}t=0t=Nand (N+1) observations of the SLS measured output{ym(t)}t=0t=Ndefined in (1) under a switching sequence as in (2), we are interested here in estimating the sequence of active sub-systemsQˆ={qˆ0,…,qˆS}and the set of their corresponding switching instantsτˆ={tˆc1,…,tˆcS}.Note here that the same problem can be described in the state-space formalism. Hence, the switched sub-systems are defined as:(3)x˙(t)=Aqx(t)+Bqu(t)y(t)=Cqx(t)+Dqu(t)+e(t)Aq, Bq, Cqand Dqare matrices with appropriate dimensions and q is the discrete index as defined in (1). We consider that at each time one and only one sub-system is active. In other terms, at each sample the output y(t) is generated by only one sub-system.To deal with the identification problem, let us first transform it into an optimization one. This consists on minimizing the Least-Squared Error function defined in (4).(4)LSE=∑t=0t=N(ym(t)−y(t))2As depicted in Fig. 2, the excitation signal u(t) is applied to both the real switched process and its model. The outputs are compared and the error signal is then introduced to the DPSO-based identifier in order to estimate the model parameters that cluster exactly the data and estimates both the active modes and the switching instants.For this optimization problem, the decision variables should be defined as follows:(a)For each interval of time {tcj+1, …, tc(j+1)}, a set of binary variables αjq∈{0, 1}, j∈{0, …, S}, q∈{1, …, M} is defined. These variables characterize the state of each one of the sub-systems such that αjq=1 if the mode q is active and αjq=0 if not. Since one has assumed that one and only one sub-system is active during each interval, these variables must verify the following constraint:(5)∑q=1q=Mαjq=1These binary coefficients constitute the first family of decision variables. Their number depends on the number of sub-systems and the number of switches. In fact for M sub-systems and S switches, the number of binary variables is equal to M(S+1).The switching instants constitute the second family of decision variables. For the SARX form, they are discrete variables and for the state-space form, they are continuous variables. In both cases they have to verify the following constraint:(6)t0=0<tc1<…<tcS<tc(S+1)=NThe physical meaning of this constraint is that when a sub-system is activated it remains active during a certain minimum time known as the dwell time. An infinite number of switches in a finite amount of time is thus avoided.PSO is a population-based optimization method. Because of its simplicity and computational efficiency it has been used in many fields and in particular for the identification of dynamical systems’ parameters. In PSO, numerous individual agents called “particles” are moved across the search-space looking for better solutions. During the move, each particle takes benefit from its best discoveries in the past and the best discoveries of the entire population called “swarm”. A vector of candidate solutions, called “position”, is associated to each particle and a “velocity” operator is adjusted in order to approach the global best solution. For detailed presentation of the PSO algorithm, its variants, its convergence analysis and parameters tuning, you can see the specialized references [14–17] and the references cited therein.In our case, we need only to ensure the connection between the “SLS identification world” and the “PSO world” by defining the position of a particle. The decision variables which are the parameters to be identified are coded as the position vector of the ith particle as follows:(7)θ(i)=α01(i),…,α0M(i),tc1(i),…,tcS(i),αS1(i),…,αSM(i)T,i∈{1,…,p}where p is the swarm size (number of particles).At each iteration k, each particle in the swarm updates its position according to the following set of equations:(8)vk+1(i)=wk⋅vk(i)+C1⋅r1⋅(θpk(i)−θk(i))+C2⋅r2⋅(θgk(i)−θk(i))(9)θk+1(i)=round(θk(i)+vk+1(i))(10)wk=wmax−wmax−wminkmaxkθk(i)is a candidate solution encoded as the position of the ith particle at iteration k andvk(i)is its velocity. C1 and C2 are the cognitive and the social acceleration constants. They are set to 2 respectively. r1 and r2 are random numbers with values in the range0,1.θpk(i)is the best position reached by the ith particle in the past, known as the “personal_best”.θgk(i)is the best position between neighbours of each particle, known as the “global_best”. kmax is a maximum number of iterations.wkis the inertia weight making balance between exploration and exploitation during the identification process.wmax=0.9,wmin=0.4.The round function introduced in Eq. (9) indicates that the real-valued numbers are rounded off to the nearest integer numbers [17]. This is due to the fact that binary and integer solutions are needed for the identification problem studied in this paper.The computational process of the proposed DPSO-based algorithm for switched linear system identification can be described in the following steps.•Step 1: Extract the (N+1) observations{ym(t)}t=0t=Nof the SLS and define all the parameter settings of the DPSO algorithm to be used.Step 2: Set the iteration index to k=0 and initialize randomly the particles by positions (7) and velocities (8). The binary variables are initialized as random numbers in {0, 1} while respecting, for each interval of time, the constraint (5). The switching instants are initialized as integer numbers in the interval {0, …, N} while respecting the constraint (6). Evaluate the estimation error function (4) for each particle and set the value of the current switched system parameters to its personal best position.Step 3: Determine the global best as the position of the particle having the minimum error function among the swarm.Step 4: Increment the iteration index. For each particle, update the vector of parameters according to Eqs. (8–10).Step 5: Round-off all the obtained parameters to the nearest integer number such that the constraints (5) and (6) are satisfied.Step 6: Each particle quality is evaluated according to its updated position and thus the estimation error function (4) is computed.Step 7: If one particle improves its error function, its personal best position is set to its current position.Step 8: If the stopping criterion is reached then, print the obtained result as the estimates of the identification parameters; otherwise repeat Steps 3–8.The main operation to be performed in a PSO algorithm is the fitness function computation. According to Steps 2 and 6, the particle quality is evaluated from its Least-Squared Error (LSE) function which is here the objective function to be minimized. Given the ith particle position θ(i) (as defined in Eq. (7)), the continuous SLS input u(t) and its measured output ym(t), t∈{0, …, N}, the following procedure is used to compute the ith particle fitness function.Fitness function computation for the ith particleLSE(i)(0)=(ym(0)−y(0))2; initial value for the fitness functionfor j=0 to S; time interval indexesfor t=tc(j-1)+1 to tcj; the jth interval limitsy(t)=∑q=1q=Mαjq∑h=1nahqy(t−h)+∑l=1mblqu(t−l)+e(t); The sub-system which generates the output y(t) is the one active in the jth interval. Its corresponding index αjq=1.; all the other sub-systems are inactive.LSE(i)(t)=LSE(i)(t−1)+(ym(t)−y(t))2EndEndLSE(i)=LSE(i)(N)In general, the move equations in the PSO approach provide real-continuous values. As the variables to be identified for the studied switched systems are binary (αjq) or discrete-integer (tcj), we have resort to the “round” function (Eq. (9)) to generate the adequate values. In fact, the real value is gradually truncated to its nearest integer [20].Let us consider the dth component in the position vector,(θk(i)+vk+1(i))d, corresponding to the confined binary variable αjq. The confinement procedure operates as follows:•If(θk(i)+vk+1(i))d∈−0.5,0.5⇒round((θk(i)+vk+1(i))d)=0⇒αjq=0If(θk(i)+vk+1(i))d<0.5⇒αjq=0If(θk(i)+vk+1(i))d∈0.5,1.5⇒round((θk(i)+vk+1(i))d)=1⇒αjq=1If(θk(i)+vk+1(i))d>1.5⇒αjq=1In addition to the above cited confinement procedure, the constraint (5) must be ensured; i.e. during each interval of time {tc(j−1)+1, …, tcj}, one and only one sub-system is active (its corresponding activation index αjq=1 and all the other indexes are equal to 0).The performance of the proposed approach is illustrated through the following examples.Consider a SISO (Single-Input Single-Output) SARX composed of three sub-systems having the following structures:•Sub-system 1: y(t)=−0.5961y(t−1)−0.5476y(t−2)+0.6u(t−1)+e(t)Sub-system 2: y(t)=−0.9y(t−1)−0.6175y(t−2)+1.2u(t−1)+e(t)Sub-system 3: y(t)=−0.5106y(t−1)−0.81y(t−2)+3.5u(t−1)+e(t)To generate the identification data, the excitation input (Fig. 2(a)) is chosen to be a 100 sized pseudo-random binary sequence (PRBS). We introduce also the following switches: from sub-system 2 to subsystem 1 at the instant 32 and from sub-system 1 to sub-system 3 at 75. The output signal is corrupted by an additive Gaussian white noise. The magnitude of the noise is chosen such that the Signal to Noise Ratio (SNR) is equal to 10dB with respect to the output signal. Note that the switches herein introduced are only for simulation purpose. They are also used to be compared with the estimated results.Using the experimental data (Fig. 2), we want to estimate which of the three sub-systems have been activated (qˆ0,qˆ1,qˆ2) and when the two switches occur (tˆc1,tˆc2). For such purpose, we start by encoding the parameters to be estimated as a position of each particle in the DPSO paradigm:θi=(α01(i),α02(i),α03(i),tc1(i),α11(i),α12(i),α13(i),tc2(i),α21(i),α22(i),α23(i))TSince the proposed DPSO approach is stochastic and the SLS measurements are corrupted by noise, we have carried out 300 independent experiments in the same conditions (number of particles, SLS input and measured output, …). All the computations are performed in Matlab environment. The swarm size is 20 and the stopping criterion is a maximum number of iterations, kmax=100.To deal with statistical measures of the carried out experiments, the obtained results are recorded. We use 4 statistical parameters namely, mean (average), standard deviation (st.dev.), median and mode [19] for the two switching instants and for the global best fitness function. The statistical results are summarized in Table 2. We adopt the mode values as the identified parameters of the studied SARX. In fact, the mode value of each parameter corresponds to the most frequent result among those of the 300 carried out experiments. Moreover, the mean values for the switching instants are almost equal to the theoretical values used for simulation data generation. It is also obvious that the standard deviations are very small which proves that the results distributions are near the mean values and that they are more or less similar [19].Details about a run that provides results corresponding to the mode adopted values are given below. In order to alleviate these details, a swarm of 5 particles (among the 20 particles considered) is used (Fig. 3).(a)Initialization: the 5 particles, named P1, P2, P3, P4 and P5 are initialized as indicated in Table 3. It is obvious that each three binary variables have their sum equal to 1. For example, particle P3 position indicates that in the first interval of time, sub-system 1 is active. The first switch occurs at 24. The second activated sub-system is sub-system 2. The second switch occurs at the sample number 63 to the first sub-system. The last column includes the value of the error function of each particle. P5 is the best particle among the swarm.Confinement: During the identification process, the move equations of the particles may generate real numbers for binary and discrete variables to be identified. In such case, one has to round-off these variables to the nearest integer numbers in order to satisfy the nature of the identified variables and to satisfy the constraints (5) and (6).Convergence illustration: To demonstrate the convergence characteristics of the proposed approach, one chooses to follow one of the particles of the swarm (P4 for example).It is shown from Fig. 4that the parameters tc1 and tc2 converge to constant values (respectively 33 and 77) within 60 iterations. Any other particle of the swarm behaves globally like P4. In Fig. 5, we illustrate the convergence characteristics of the whole swarm. It is clearly observed that the value of the identification error function of the best particle converges to a constant value at the end of the identification process. The fact that this value is different from zero is due to the presence of the noise term in the extracted output. At the end of the identification process, the obtained solution is represented in Table 4.It can be observed that among the three first binary variables, the second one is equal to 1 which means that during the first interval of time {0, 1, …, 33} the sub-system 2 is active. During {34, …, 77}, sub-system 1 has been identified to be active. Finally, during the interval of time {78, …, 100}, the sub-system 3 is active. Moreover, it is clear that the estimated two switching instants are respectively 33 and 77. The obtained results are almost the same as those used in simulation data generation (see Fig. 2).Let us consider the buck–boost DC/DC converter shown in Fig. 6[3]. The switching component (T) is subject to two discrete states (Open and Closed). Thus, the converter presents a switched behaviour characterized by the two following sub-systems:•Sub-system 1:x˙=−1RC000x+01LuSub-system 2:x˙=−1RC−1C1L0x+00uFor the computation requirement the two sub-systems are sampled at a sampling period Ts=1μs. The first order discrete-time model for the studied switched DC/DC converter is then given by:•Sub-system 1:x(t+1)=A1x(t)+B1u(t),A1=−TsRC+1001,B1=0TsLSub-system 2:x(t+1)=A2x(t)+B2u(t),A2=−TsRC+1−TsCTsL1,B2=00To generate simulation data, the system is excited by a constant input signal U=24V starting atx(0)=[00]Tand sub-system 1 as initial active mode. To fulfil the same conditions as in [3], the output is assumed to be noise-free. Four switches are also introduced respectively at 80μs, 150μs, 220μs and 280μs. N=300 data are then collected to perform the identification process.The parameters to be identified are coded as the position of swarm particles according to the following equation:θ(i)=[α01(i),α02(i),tc1(i),α11(i),α12(i),tc1(i),α21(i),α22(i),tc3(i),α31(i),α32(i),tc4(i),α41(i),α42(i)]The following constraints have to be verified:•αj1(i)+αj2(i)=1,j=0:4,αJ1(i)∈{0,1},αJ2(i)∈{0,1}.tc1(i)<tc2(i)<tc3(i)<tc4(i)For this example, 300 runs are carried out using the DPSO of Section 3. The results are then recorded and their statistical measures are summarized in Table 5. Furthermore, Table 5 provides the worst and the best estimation error functions. From this table, it can be observed that the sequence of active modes and their corresponding switching instants are accurately estimated. In 98% of runs (among 300 experiments carried out), the numerical values of the switching instants are provided with little standard deviations. The obtained results confirm the effectiveness of the proposed DPSO on data clustering. In fact, the data generated by different sub-systems are correctly assigned to their corresponding modes. Moreover, our approach is demonstrated to perform better than the approach in [3]. In fact, the used DPSO allows the estimation of the active modes in addition to the switching instants whereas, the algebraic approach proposed in [3] estimates only the switching instants.The best solution is chosen to simulate the studied SLS behaviour. The continuous states (the current and the voltage across the capacitor) evolutions are shown in Fig. 7. Both the experimental active modes and the identified ones are depicted in Fig. 8.

@&#CONCLUSIONS@&#
