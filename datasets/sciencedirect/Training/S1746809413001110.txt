@&#MAIN-TITLE@&#
Hidden Markov random field model based brain MR image segmentation using clonal selection algorithm and Markov chain Monte Carlo method

@&#HIGHLIGHTS@&#
Investigated statistical models and model estimation methods for MR image segmentation.Proposed a HMRF model based method that can jointly segment MR images and correct bias fields.The HMRF model is stepwise learned by MCMC-based voxel labeling and CSA-based model estimation.The results of the proposed algorithm are very promising and robust to image artifacts.

@&#KEYPHRASES@&#
Image segmentation,Magnetic resonance imaging (MRI),Clonal selection algorithm (CSA),Markov random field (MRF),Hidden Markov random field (HMRF),Markov chain Monte Carlo (MCMC),

@&#ABSTRACT@&#
The hidden Markov random field (HMRF) model has been widely used in image segmentation, as it provides a spatially constrained clustering scheme on two sets of random variables. However, in many HMRF-based segmentation approaches, both the latent class labels and statistical parameters have been estimated by deterministic techniques, which usually lead to local convergence and less accurate segmentation. In this paper, we incorporate the immune inspired clonal selection algorithm (CSA) and Markov chain Monte Carlo (MCMC) method into HMRF model estimation, and thus propose the HMRF–CSA algorithm for brain MR image segmentation. Our algorithm employs a three-step iterative process that consists of MCMC-based class labels estimation, bias field correction and CSA-based statistical parameter estimation. Since both the MCMC and CSA are global optimization techniques, the proposed algorithm has the potential to overcome the drawback of traditional HMRF-based segmentation approaches. We compared our algorithm to the state-of-the-art GA–EM algorithm, deformable cosegmentation algorithm, the segmentation routines in the widely-used statistical parametric mapping (SPM) software package and the FMRIB software library (FSL) on both simulated and clinical brain MR images. Our results show that the proposed HMRF–CSA algorithm is robust to image artifacts and can differentiate major brain structures more accurately than other three algorithms.

@&#INTRODUCTION@&#
Magnetic resonance (MR) imaging as a structural imaging modality is widely used in clinical practice and neuroscience research. Comparing to the functional positron emission tomography (PET), it offers higher spatial resolution and better soft-tissue contrast. The recently developed PET/MR scanner combines both imaging techniques, and thus enable the simultaneous acquisition of the functional and structural information in a single scanning session [1,2]. The complementary information embedded in the co-aligned MR and PET data can be analyzed more efficiently. The novel dual-modality PET/MR imaging technique hence excites an increasing number of research opportunities [1,3,4]. Specifically, to guide the functional investigations, the traditionally popular MR image research areas, such as MR image segmentation, has been revitalized [4]. Segmentation of brain MR images into gray matter (GM), white matter (WM), and cerebrospinal fluid (CSF) plays an essential role in a wide spectrum of clinical and research applications. Since the manual segmentation performed by medical professionals is time-consuming, expensive and subject to operator variability, automated segmentation algorithms have been developed in the literature [5–15]. Among them, statistical model based approaches have attracted numerous research attentions.A widely used statistical model in neuroscience is the Gaussian mixture model (GMM) [5–8], which assumes brain voxel values are sampled independently from one of K Gaussian distributions with a prior probability. The GMM is not only consistent with the piecewise constant nature of brain MR images, but also has computational advantages. Particularly, the segmentation algorithm in the widely-used statistical parametric mapping (SPM) software package [16], namely unified segmentation [12] is based on this method but combined with a nonlinear registration process. Model parameters of the GMM can be estimated according the maximum likelihood (ML) criterion using the expectation-maximization (EM) algorithm [17]. However, the EM-based ML estimation has several drawbacks, including over-fitting and being apt to be trapped in a local optima. To overcome such drawbacks, several global optimization techniques have been used to replace the EM algorithm. For instance, Tohka et al. [6] incorporated the genetic algorithm into the likelihood estimation, and thus proposed the GA–EM algorithm, which can produce satisfying segmentation results. Alternatively, maximum a posteriori (MAP) estimation is a common substitution for the ML estimation when prior knowledge is available. The prior of voxels’ spatial dependence is usually interpreted by modeling the voxel class labels as a Markov random field (MRF) [18–21]. Thus, the image segmentation problem can be approached within the MAP–MRF framework. A classical solution is the iterated conditional modes (ICM) [8,15,22–24]. Despite being computationally efficient, the ICM algorithm has an evident drawback of locally convergences. Thus, global stochastic searching based inference methods, such as the Markov chain Mote Carlo (MCMC) inference [25], have been extensively studied to substitute for the deterministic routines [26,27].The posterior criterion is to approximate the optimal class labels given the model parameters and the observed image. However, it fails to examine whether the model parameters fit the observed image data. The hidden Markov random field (HMRF) model can naturally characterize this important penalty, and hence better suits the image segmentation problem [19,28]. In this model, both the observed image and hidden voxel labels are assumed to be random variables. Image segmentation is represented as the joint approximation of the optimal hidden variables and model parameters conditioned on the observed data. The HMRF model was introduced into the brain MR image segmentation field by Zhang et al. [15]. In their HMRF–EM framework, they use a two-step iterative procedure to solve the joint probability. The ICM algorithm is first used to approximate the hidden class labels, and then the EM algorithm is used to estimate the model parameters. Despite being popular and computationally efficient [29,30], both the ICM and EM algorithms used in this approach are deterministic searching technique, which tend to converge at local optima and is highly dependent on initializations. An intuitively solution is to replace the deterministic algorithms with the stochastic searching techniques. It has been reported that the segmentation performance can be improved by using the MCMC technique to approximate class labels [9,31–33] or using evolutionary algorithms to replace the EM algorithm for parameter estimation [10,14].Recently, immune inspired algorithms have drawn significant attention, due to their highly evolved, parallel and distributed nature. They provide a potential source of new evolutionary algorithms for solving complex optimization problems. Among them, the clonal selection algorithm (CSA) has been demonstrated to be effective in several research fields [34]. It is based on the clonal selection theory, claiming that, only those antibodies that recognize the antigens will be selected to proliferate, and the proliferated cells will improve their affinity to the antigens through an affinity maturation process [35,36]. The CSA mimics the nature of an immune response to an antigenic stimulus, and has the potential to achieve global optima. In our preliminary study, we have used the CSA to learn the parameters of the HMRF model, and proposed the eHMRF algorithm [10] for brain MR image segmentation.In this paper, we incorporate both the CSA and MCMC techniques into the HMRF model estimation, and thus propose the HMRF–CSA algorithm for brain MR image segmentation. The observed brain image data and underlying voxel labels are modeled by the HMRF. The segmentation is iteratively accomplished using a joint estimation of the class labels and model parameters. First, the optimal label configuration is approximated by the MCMC method. Then, the implicit HMRF model parameters are estimated by the CSA. We replace all deterministic search routines with global stochastic optimization techniques, with the aim of improving the robustness of the segmentation algorithm. Meanwhile, the image inhomogeneity in MR images is modeled as a multiplicative component of the piecewise constant image. Once the intermediate segmentation result is obtained from MCMC inference, the image inhomogeneity is estimated and partly removed from the image. The proposed HMRF–CSA algorithm has been compared to the state-of-the-art GA–EM method [37], deformable cosegmentation (D–C) algorithm [11], the unified segmentation routine in the SPM software package [16] and the HMRF–EM segmentation routine in the FMRIB Software Library (FSL) [38] on both simulated and clinical brain MR images.

@&#CONCLUSIONS@&#
