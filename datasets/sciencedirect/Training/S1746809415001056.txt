@&#MAIN-TITLE@&#
Averaging of nonlinearly aligned signal cycles for noise suppression

@&#HIGHLIGHTS@&#
Unfavorable influence of time warping on cycles averaging was shown.Modification of the costs of alignment was proposed.Weighting of the summed cycles was introduced.Significant improvement of noise suppression was achieved.

@&#KEYPHRASES@&#
Nonlinear alignment,Dynamic time warping,Event-related potentials,Evoked potentials,ECG signal,QT interval,Noise suppression,

@&#ABSTRACT@&#
Averaging of nonlinearly aligned (time-warped) signal cycles is an important method for suppressing noise of quasi-periodical or event related signals. However, in the paper we show that the operation of time warping introduces unfavorable violation of the requirements that should be satisfied for effective averaging and, as a result, it causes poor suppression of noise. To limit these effects, we redefine the matrix of the alignment costs. To improve results of averaging in cases of variable energy noise, we apply weighting of the summed signal samples. The derived formula gives smaller weights for more noisy signal cycles and this way limits their influence on the constructed template. The proposed modifications caused a significant increase of the Noise Reduction Factor (NRF) in the experiments on the simulated evoked potentials. Whereas the greatest NRF obtained by the reference methods in nonstationary white noise environment was equal to 1.55, for the new method proposed we achieved a value of 4.44. For non-stationary colored noise, the corresponding values were 1.44 and 2.99. Moreover, application of the developed method to ECG signal processing, prior to the measurements of the QT interval, significantly improved the measurements immunity to noise.

@&#INTRODUCTION@&#
Dynamic time warping (DTW) is a technique that uses dynamic programming [3] to determine the best alignment of two time series (or sequences of vectors) and to provide a measure of their morphological similarity. This similarity measure was developed for spoken words recognition [29,22] and later applied in a variety of pattern recognition problems, for instance to ECG beats clustering [27], to knee joint sound classification [11], to sleep stage classification [18] and in [33] more generally to different biomedical time series clustering. In this paper, we focus on application of the DTW technique to noise suppression.Analysis of biomedical signals is often possible only after effective suppression of noise they are embedded in. Therefore development of methods dealing with this problem has for many decades been an objective of unceasing efforts. When the noise component frequency-band overlaps that of the desired component, suppression of noise is particularly difficult; however, when the processed signals are of repetitive shape, a relatively simple method of coherent averaging appears advantageous [28]. Since the early years of computerized electrocardiography, this method has successfully been applied to ECG signals enhancement [26] and even to fetal ECG extraction from the maternal abdominal bio-electrical signals [10]. Particularly important is its application in exercise electrocardiography where measurements of the signal features (amplitudes and slopes of the respective ECG waves, as well as their time lengths) require prior suppression of high level muscular noise. To accomplish this requirement effectively, the method has for many years been modified and improved [2,17,21]. However, with the progress in the analysis and interpretation of electrocardiogram, the method intrinsic constraint of forming an average template of an ECG cycle and loosing the information on its variability appeared unacceptable. It stimulated the efforts to develop new methods of noise suppression, preserving the shapes of the individual cycles. Their reconstruction on the basis of orthogonal functions derived with the use of principal component analysis appeared rather advantageous [12] as well as application of a slightly similar method of projective filtering of time-aligned ECG beats [13]. However, these methods are less effective in cases of high QT interval variability, associated with a changing position within an ECG cycle of a relatively low T wave. Reconstruction of such signals with the use of projective filtering appeared much more precise and immune to noise when a kind of nonlinear alignment (time warping) of ECG cycles preceded the projections [14]. A novel approach, based on two-dimensional warping of the ECG signals, both along the time and the amplitude axes, was proposed in [30]. A comparative study of the approaches allowing for averaging of signals with different types of shape variability was performed in [4].A similar progress can be observed in the development of methods for processing of so-called evoked potentials. Such signals respond to a stimulus with a series of positive and negative deflections from the baseline. The time between a stimulus and a particular deflection is called as latency. The latencies convey important information on physiological mechanisms evolving in the brain. Unfortunately the evoked potentials are mixed with spontaneous EEG signal and can be of low signal-to-noise ratio. Different types of filtering techniques can be applied to raise this ratio [5,1,25,36]; in cases of a very high level of noise, however, they can rarely produce signals of sufficient quality to detect the important deflections and measure their amplitudes and latencies. Thus of high importance are the methods of averaging [6,31] and their modifications [37,20,7]. Application of nonlinear alignment of the evoked potentials, prior to their averaging, performed with the use of the technique of dynamic time warping, was proposed in [24,9]. However, the procedure of dynamic time warping does not distinguish the signal and the noise components of the aligned signals and therefore noise can cause their erroneous alignment [24]. To prevent this effect, trilinear modeling of evoked potentials was applied in [34] to filter single responses before aligning and averaging them. In this study, we present more details showing how unfavorable can be the influence of noise on the results of time warping and averaging. Our aim is to propose an approach limiting these undesired effects.The rest of the paper is organized as follows. Section 2 presents the classical approach to dynamic time warping, a few methods of nonlinearly aligned cycles averaging known from the literature, an approach limiting the unfavorable influence of DTW on averaging, and a new method of weighted averaging of nonlinearly aligned cycles. Section 3 shows the experiments on the simulated evoked potentials and on real ECG signals. Finally, conclusions are drawn in Section 4.

@&#CONCLUSIONS@&#
We have presented three methods of nonlinearly aligned cycles averaging, known from the literature, and we have described the reasons of their ineffective processing of noisy signals. The fundamental reason is that nonlinear alignment of signals under averaging violates the basic requirements that should be fulfilled to make this averaging effective. We have proposed a modification of a cost matrix that can diminish these unfavorable results of the procedure of dynamic time warping. Application of this modification has significantly improved the results of evoked potentials enhancement with the use of all the three reference methods.To exploit the fact that the noise components of the processed signals are often nonstationary, we have developed a method of weighted averaging of nonlinearly aligned signal cycles. With this method, applied with the modified alignment costs, we have achieved significant improvement of evoked potentials enhancement in nonstationary noise environment.When the most effective among the reference methods and the newly developed one were applied to ECG signal enhancement prior to the measurements of the QT interval, these findings were confirmed. Whereas the reference method based on the classical alignment costs improved the measurements only insignificantly, its application with a modified costs resulted in much better signal enhancement and subsequently in much more precise measurements of the repolarization duration. However, it was the weighted averaging of nonlinearly aligned cycles, based on the modified alignment costs, that allowed for most noise immune determination of the QT time series and for most reliable assessment of its variability.