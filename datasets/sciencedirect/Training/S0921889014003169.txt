@&#MAIN-TITLE@&#
Correlated space formation for human whole-body motion primitives and descriptive word labels

@&#HIGHLIGHTS@&#
We construct correlated spaces of human motions and word labels.The correlated space can be applied to searching for motions from word queries.The motions can be retrieved, even if the queries are not assigned to the motions.This technology can be helpful for reusing the motion data.

@&#KEYPHRASES@&#
Motion primitive,Word label,Canonical correlation analysis,

@&#ABSTRACT@&#
The motion capture technology has been improved, and widely used for motion analysis and synthesis in various fields, such as robotics, animation, rehabilitation, and sports engineering. A massive amount of captured human data has already been collected. These prerecorded motion data should be reused in order to make the motion analysis and synthesis more efficient. The retrieval of a specified motion data is a fundamental technique for the reuse. Imitation learning frameworks have been developed in robotics, where motion primitive data is encoded into parameters in stochastic models or dynamical systems. We have also been making research on encoding motion primitive data into Hidden Markov Models, which are referred to as “motion symbol”, and aiming at integrating the motion symbols with language. The relations between motions and words in natural language will be versatile and powerful to provide a useful interface for reusing motion data. In this paper, we construct a space of motion symbols for human whole body movements and a space of word labels assigned to those movements. Through canonical correlation analysis, these spaces are reconstructed such that a strong correlation is formed between movements and word labels. These spaces lead to a method for searching for movement data from a query of word labels. We tested our proposed approach on captured human whole body motion data, and its validity was demonstrated. Our approach serves as a fundamental technique for extracting the necessary movements from a database and reusing them.

@&#INTRODUCTION@&#
To understand real-world phenomena that are not clearly separated, humans segment those phenomena and perceive them as symbols. Rather than being based on physical properties, this segmentation is arbitrary and depends on the society to which the person belongs  [1]. However, these symbols have been refined by recording the correspondence between the arbitrarily segmented world and the symbols used for denoting it, as well as the relation between the different symbols, and through the evolutionary process of the cumulative utilization of these symbols. This immense system of intricately intertwined symbols sublimated into language, allowing humans to communicate efficiently with one another and to perform high-order reasoning. It can be said without exaggeration that the high-order cognitive capabilities of humans are a product of language.For humanoid robots to coexist with humans, they will have to be able to use the same symbols and language systems as humans. Research on robot body motion has focused on imitating learning methods that optimize the parameters of mathematical models based on various motion patterns  [2,3]. In this framework, time-series data (e.g., data about the joint angles representing motions) are memorized as symbols represented discretely by parameters of a statistical model  [4,5] or of a dynamical system  [6–10]. This sort of robot intelligence is the ability not only to understand human behavior by comparing human motions with previously memorized motions but also to generate continuous motions from memorized symbolic representations of motions to apply them to the real world. The expansion of the range of fields where humanoid robots are used is creating an increasingly strong demand for a framework to memorize many motion symbols  [11].With the improvement and spread of optical motion capture technologies, data about human body motions is getting applied not only in robotics but also in various other fields, such as animation, sports engineering and rehabilitation. A massive amount of data about human body motion has already been collected. However, when reusing memorized motion data in order to synthesize new motions for animated characters or to perform motion analysis by comparing motions with previous ones, efficient search techniques should be used to find the necessary motions in the collected data. Currently, searching for and reusing the necessary motion data is based on labels such as measurement time or motion description. An environment where it is possible to search for only labels that match the input data places a large burden on operators that reuse the motion data by requiring them to memorize the exact measurement time or motion description.The ability of a robot to perform intelligent information processing by encoding and categorizing large amounts of body motion data and linking that data to linguistic representations forms the basis of the robot’s comprehension of language and body motion. Also, this is closely related to technology for searching and presenting motion data related to simple linguistic input. This ability would substantially improve the reusability of motion data in motion analysis or motion generation for CG characters. Frameworks proposed thus far have been based on arrays of motion symbols representing body motion data learned through a Hidden Markov Model (HMM)  [12] and arrays of verb labels attached to those motions. In those frameworks, emphasis is placed on learning the correspondence between motions and verbs by restricting the linguistic representations to verbs and considering the context of the symbol and verb arrays, however, without taking into account the interrelation between motions or other linguistic units, such as nouns or adverbs  [13]. One proposed method for expressing the interrelation between motion symbols involves calculating the distances between individual motion symbols and constructing a multidimensional motion symbol space and assigning motion symbols to points such that those distances are preserved  [14]. Furthermore, there are language processing techniques in which sentences composed of verbs, nouns and other elements are represented as points in a vector space based on the presence, absence or frequency of the constituent words  [15–17]. Thus, it may be possible to construct a computational model connecting motions to word labels by using a common representation of both motions and word labels as points in some spaces. In this paper, we construct a space of motion symbols learned by applying an HMM to body motion data and a word label space consisting of verbs, nouns and other words assigned to those motions. Next, through canonical correlation analysis  [18], these spaces are reconstructed such that a strong correlation is formed between motion symbols and word labels. Using these spaces, we propose a method for searching for motion data based on word labels. This serves as a fundamental technique for extracting the necessary motions from a database and reusing them.Research on intelligent robots through conversion of bodily senses or movements into symbols is being conducted in robotics. These approaches encode the continuous spatio-temporal data of motions into the low dimensional parameters of motion primitives, and these parameters allow robots to classify the motions into the motion primitives. However, the motion primitives represented in the parameters cannot be intuitively understood by humans. Humans have acquired language through the process of evolution. We can understand motions in same expression that others can do by using the language. The mapping between the motion parameters and words is crucial to establishing communication between robots and humans. This section describes an approach to extract the mapping between motions and word labels. The motion data is encoded into a Hidden Markov Model (HMM), which is referred to as “motion symbol”. The motion data is also given word labels by human annotators. Relation between the motions and the word labels is extracted from the training pairs of the motion symbols and the word labels as shown in Fig. 1.Fig. 2shows the overview of mapping between human whole body motions and word labels. The human motion primitive data are encoded in Hidden Markov Models (HMMs). Each HMM is referred to as “motion symbol” since it represents spatio-temporal features of its corresponding motion primitive. Dissimilarity between each motion symbol can be calculated by using the Kullback–Leibler information.(1)d(λi,λj)=∑Oˆi(k):k=1,2,3,…,N1N{lnP(Oˆi(k)|λi)−lnP(Oˆi(k)|λj)}d(λi,λj)is the Kullback–Leibler information from motion symbolλito motion symbolλj.Oˆi(k)is thekth motion data that the motion symbolλigenerates by the Monte Carlo method.P(Oˆi(k)|λj)is the likelihood that motion symbolλjgenerates the motion dataOˆi(k). The Kullback–Leibler information does not necessarily satisfy the symmetry. In Eq. (2),d(λi,λj)andd(λj,λi)are summed to obtainD(λi∥λj), which satisfies the symmetry.(2)D(λi∥λj)=d(λi,λj)+d(λj,λi)2.This is defined as the distance between motion symbolλiand motion symbolλj. All of the motion symbols are arranged as points on a multidimensional space such that the distance between all the motion symbols is satisfied. The coordinates of the point in the multidimensional space corresponding to motion symbolλiare taken asxi, and this position is found such that the following error function is minimized.(3)T=∑∀i,j(D(λi∥λj)2−dij2)24D(λi∥λj)2(4)dij=‖xi−xj‖.Here, the multidimensional scaling proposed by Takane et al. [19] is used. The error functionTis represented by a fourth-order polynomial in coordinatexiof motion symbolλi. The optimal position of the motion symbol, which minimizes the error functionT, can be found by the Newton–Raphson method. This process constructs the motion symbol space based on dissimilarity between the motion symbols by the multidimensional scaling.Multiple word labels are manually assigned to the same motion primitive data that the HMM encodes into the motion symbol. The word labels are descriptive of the motion primitive. A set of the word labels is represented by a feature vector with binary elements taking value 1 if the corresponding word label is present in the set of the word label, and 0 if the word label is not present. The number of dimensions of the feature vector is equal to the number of the different word labels. For example, four word labels “run”, “walk”, “throw” and “ball” can be used, and two word labels, “throw” and “ball” are assigned to motion primitive data. In this case, feature vectory=(0,0,1,1)Tcorresponding to the motion primitive is derived. The position of the word labels in the word label space can be defined as the feature vectory.The motion primitive data{Oi}i=1ncan be represented not only by the position{xi}i=1nin the motion symbol space but also by the position{yi}i=1nin the word label space.nis the number of the motion primitive data. By using training dataset of the positions,{xi,yi}i=1n, these positions are linearly projected onto the basis vectorsaandbby Canonical Correlation Analysis (CCA) such that the correlation between the resulting positions is maximized. The matrices,XandYcan be derived by arranging the vectors of the motion symbols and the word labels along the column direction respectively:(5)X=[x1,x2,…,xn]T(6)Y=[y1,y2,…,yn]T.The correlationrfgbetween the projections offi=xiTaandgi=yiTbcan be given by(7)rfg=aTΣXYbaTΣXabTΣYb(8)ΣX=1n−1XTX(9)ΣY=1n−1YTY(10)ΣXY=1n−1XTY.The CCA seeks to find the optimal basis vectorsaandbto maximize the correlationrfgsubject to following constraints that the covariances of the resulting projections take value 1.(11)aTΣXa=1(12)bTΣYb=1.The CCA optimization problems can be simplified to the following eigenvalue problems.(13)ΣXYΣY−1ΣYXa=α2ΣXa(14)ΣYXΣX−1ΣXYb=α2ΣYb{a1,a2,…,ak}and{b1,b2,…,bk}denote the eigenvectors corresponding to the largest eigenvectorsα12≥α22≥⋯≥αk2. The projectionsxTaiandyTbiareith dimensional coordinates of a motion symbol and word labels in the canonical spaces respectively. The correlation between these two coordinates becomesαi. The matricesA=[a1,a2,…,ak]andB=[b1,b2,…,bk]project the motion symbols and word labels ontok-dimensional canonical spaces.Reuse technologies of prerecorded motion data improve analysis of human motions, edition of character animation, and interaction between a human and a robot. The reuse of the motion data archive has remained challenging. The reuse technologies need the effective search for specific motion data in the archive. The conventional search has been depending on recording date labels, or names of motion data files. Users have to know the date or names of their necessary motion data. The relation between motion symbols and word labels through the CCA leads to a useful search for motion data from queries of word labels. The users only have to input word labels in order to find prerecorded motion data.We assume that the relation between the projectf=ATxand the projectg=BTycan be represented as the linear transformation,f=CTg, whereCis a transformation matrix. The transformation matrix can be found such that it can minimize the errorSbetween the projectATxand the project estimated by the transformationCTg.(15)S=∑i=1n12(fi−CTgi)T(fi−CTgi).The optimal transformation matrix can be represented as(16)C=ΣFG(17)ΣFG=1n−1FTG(18)F=[f1,f2,…,fn]T(19)G=[g1,g2,…,gn]T.Word labels are given as a search query, and converted to a binary feature vectory. The projectiong=BTycan be derived by projecting the binary feature onto the canonical space. This projection is transformed into the feature vectorCTgin the canonical space of motion symbols. Motion symbols whose feature vectors are close to the transformed feature can be retrieved from the database. This operation makes it possible to search for motion data corresponding to a query of word labels.In addition to the motion retrieval, the relation between motion symbols and word labels through the CCA is also used for motion recognition. The relation between the projectf=ATxand the projectg=BTycan be represented as the linear transformation,g=DTf, whereDis a transformation matrix. The transformation matrix can be found such that it can minimize the errorSbetween the projectBTyand the project estimated by the transformationDTf. The optimal transformation matrix can be derived by a similar fashion described above. Observed motion is recognized as a motion symbol that is most likely to generate the observation. The feature vectorxrepresenting the position of this motion symbol in the motion symbol space can be derived. This feature vector is projected tof=ATx. This projection is further transformed into the feature vectorDTfin the canonical space of word labels. Words whose feature vectors are close to the transformed feature can be found out of the database. The observed motion can be consequently recognized as the words.

@&#CONCLUSIONS@&#
