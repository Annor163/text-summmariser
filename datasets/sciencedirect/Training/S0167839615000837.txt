@&#MAIN-TITLE@&#
Reduced curvature formulae for surfaces, offset surfaces, curves on a surface and surface intersections

@&#HIGHLIGHTS@&#
Reduced curvature formulae are presented, namely, formulae entailing only derivatives of the functions involved in the entity's representation.Reduced curvature formulae are more efficient compared to unreduced formulae.Formulae are presented for curves on a surface and for surface intersection curves, in all representation modes of the surfaces.Formulae are also presented for the normal curvature of offset surfaces and for the curvature of intersection curves of offset surfaces.

@&#KEYPHRASES@&#
Reduced curvature formulae,Gaussian mean and normal curvature,Curvature of curves on a surface,Curvature of intersection curves of surfaces,Curvature of intersection curves of offset (parallel) surfaces,

@&#ABSTRACT@&#
We introduce the concept of reduced curvature formulae for 3-D space entities (surfaces, curves). A reduced formula entails only derivatives of the functions involved in the entity's representation and admits no further algebraic simplifications. Although not always the most compact, reduced curvature formulae entail only basic arithmetic operators and are more efficient computationally compared to alternative unreduced formulae. Reduced formulae are presented for the normal, mean and Gaussian curvatures of a surface and the curvature of curves on a surface, where each surface or curve on a surface may be defined parametrically or implicitly. Reduced formulae are also presented for the curvature of surface intersection curves, where each of the intersecting surfaces may be a given surface or an offset of a given surface and each given surface may be defined parametrically or implicitly. Known formulae are cited, without derivation, to form a collection, in one place, of new and of known results scattered in the literature. Each curve curvature formula is presented together with a formula for the respective binormal vector, from which formulae for the Frenet frame and torsion of the curve can be derived.

@&#INTRODUCTION@&#
Formulae for computing various curvature measures are important in Geometric Modeling, CNC machining and other applications. Texts on classical differential geometry (Knoblauch, 1913; Struik, 1950; Lipschutz, 1969; Spivak, 1975; Do Carmo, 1976; Kreyszig, 1991) focus on the Gaussian and mean curvatures of surfaces, which determine local surface shape. They generally limit their discussion on the normal curvature to the classic formula expressing the normal curvature of a parametric surface as the ratio of the second to first fundamental forms of the surface, which is at the root of the classical theory on surface curvature. Regarding the curvature of curves, they provide only a general formula for parametric space curves, on the tacit assumption that specific formulae for curves on a surface or surface intersection curves can somehow be derived. Both Ye and Maekawa (1999) and Goldman (2005) have noted the scarcity of English literature on the differential geometry of intersection curves. A notable exception is Willmore (1959) who describes procedures (but gives no closed formulae) for computing the curvature, torsion and Frenet frame vectors of intersection curves of two implicit surfaces.In recent years, interest in the differential geometry of curves on a surface and surface intersection curves has revived, motivated by research in Geometric Modeling (Faux and Pratt, 1981; Hartmann, 1996; Ye and Maekawa, 1999; Goldman, 2005) and the need for advanced CNC controls (Papaioannou and Patrikoussakis, 2011). The curvature of a plane or space curve is a function of the first and second derivatives of the curve's position vector. Similarly, the normal curvature of a surface and, by extension, its Gaussian and mean curvatures, are functions of the first and second partial derivatives of the surface's position vector. These derivatives can, in turn, be expressed in terms of first and second derivatives, or partial derivatives of the functions involved in the actual curve or surface representation. We shall call a curvature formula entailing only representation function derivatives reduced, if it does not evidently admit further algebraic simplifications. We allow, however, the use of placeholders for reduced expressions in reduced curvature formulae, for the sake of compactness.The task of generating a reduced formula for the curvature of the intersection curve of a parametric surfacer(u,v)=[x(u,v)y(u,v)z(u,v)]Twith an implicit surfacef(x,y,z)=0will serve to illustrate the issues involved. An established fact in differential geometry is the dependence of the intersection curvature k of two surfacesSa,Sbon their local normal curvatureskan,kbn, which reduces the task of computing k to computingkan,kbnand combining them, by means of an equation expressing this dependence, to produce k. The following expression ofk2in terms ofkan,kbnis given in Lipschutz (1969)(1)k2=kan2+kbn2−2kankbncos⁡φsin2⁡φwhere φ is the angle formed by the local normal vectors ofSa,Sb. Previous authors (Faux and Pratt, 1981; Ye and Maekawa, 1999) suggest substituting the values ofkan,kbn,cos⁡φ,sin⁡φinto Equ. (1) to compute k. Efficiency gains can, however, be obtained by introducing known formulae forkan,kbninto Equ. (1), or an equivalent expression, to produce reduced formulae for k, by taking advantage of possible simplifications. This is a more systematic and efficient approach. It is also less complicated than trying to compute k, without regard to its dependence onkan,kbn.Thus, to reduce Equ. (1) for the above case, we introduce into it the classic expression for the normal curvaturekrnof a parametric surfacer(u,v)=[x(u,v)y(u,v)z(u,v)]T(2)krn=crn|t|2|nr|,crn=L′a2+2M′ab+N′b2,L′=ruunr,M′=ruvnr,N′=rvvnr,t=aru+brvthe expression for the normal curvaturekfnof an implicit surfacef(x,y,z)=0(3)kfn=cfn|t|2|nf|,cfn=−[t]THf[t]cfn=−(fxxtx2+fyyty2+fzztz2+2fxytxty+2fxztxtz+2fyztytz)whereHfis the Hessian off(x,y,z), and the following expressions forcos⁡φandsin⁡φ(4)cos⁡φ=nr⋅nf|nr||nf|,sin⁡φ=|nr×nf||nr||nf|=|t||nr||nf|wherenr=ru×rvandnf=∇fare the normal vectors of the intersecting surfaces andt=nr×nfis the tangent vector of the intersection curve.There have been, however, two missing links for this reduction process to succeed. Formula (3) for the normal curvature of an implicit surface has been provided only recently by Ye and Maekawa (1999), although implicit forms of this formula can be traced back to classical works (Spivak, 1975; Do Carmo, 1976). And unlike this formula, in which t is represented by its Cartesian coordinates, formula (2) for the normal curvature of a parametric surface entails the coordinates a, b of t in the basisru,rvof the surface's tangent plane. Reduced formulae for a, b when t is a tangent vector of the intersection curve of a parametric surface by another surface have not been known, but we provide this link in Section 3, Equ. (20b), which here assume the form(5)a=−rv⋅nf,b=ru⋅nfIntroducing Equ. (2)–(4) into Equ. (1) and simplifying, we obtain(6a)k=|crnnf−cfnnr||t|3whereL′,M′,N′,crn(Equ. (2)),cfn(Equ. (3)), a, b (Equ. (5)) andnr,nf, t are placeholders for reduced derivative expressions of the representation functionsx(u,v),y(u,v),z(u,v),f(x,y,z)and formula (6a) is also reduced as evidenced by its explicit form(6b)k=((crnfx−cfnnrx)2+(crnfy−cfnnry)2+(crnfz−cfnnrz)2)1/2(tx2+ty2+tz2)3/2The formulae presented in this paper fall into three categories. Known formulae, which are cited without derivation. Derived reduced formulae for curvature measures for which alternative unreduced formulae or procedures have been presented by other authors. Completely new formulae for the curvature of curves on implicit surfaces and the normal and intersection curvatures of offset surfaces.The rest of the paper is organized as follows: Following a brief review of classical differential geometry (Section 2), we derive in Section 3 reduced formulae for the tangential coordinates a, b of the surface tangent vector t for use with Equ. (2) and in Section 4 reduced curvature formulae for curves on both parametric and implicit surfaces. In Section 5, from the Faux and Pratt (1981) expression of thekBvector, we derive reduced formulae for the curvature of intersection curves, for the remaining two representation modes (implicit/implicit and parametric/parametric) of the intersecting surfaces. In Section 6 we present reduced formulae for the normal and intersection curvatures of offset surfaces, a subject not treated in the English literature. The paper concludes with some final remarks (Section 7) and two appendices, the first of which compares the efficiency of proposed reduced to existing unreduced formulae and the second rederives curvature formulae presented earlier, by reformulating the problem as a surface intersection problem and applying proposed formulae for this problem.A word on notation: We use capital bold letters to distinguish unit vectors from other vectors. The principal normal vector of a curve and the unit normal vector of a surface are denoted byNCand N, respectively. Otherwise, indexes indicate the representation of curves/surfaces and their differential quantities (r for parametric, f, g for implicit, h for explicit representations) and for partial derivatives of implicit functions (f,g) of position vectors (r) and of their coordinates (x,y,z) the associated parameters. Dots signify derivatives w.r.t. arc length and primes derivatives w.r.t. any other variable.Classical differential geometry starts from the Frenet–Serret equations of a curve(7)T˙=kNN˙=−kT+τBB˙=−τNand derives two basic curvature formulae. The first for the binormal curvature vectorkBof a parametric space curver(t)=[x(t)y(t)z(t)]T(8a)kB=r′×r″|r′|3from which follow expressions for the curvature k and the binormal vector B(8b)k=|r′×r″||r′|3,B=r′×r″|r′×r″|of the curve. In fact, all formulae for the curvature of curves derived in the sequel (curves on a surface and surface intersection curves) originate at expressions of thekBvector and this close relationship between k andkBimplies that for any such curvature formula of the formk=|v|/|t|3, where|v|is the norm of a vector expression and t is the curve's tangent vector, there is a respective expressionB=v/|v|of the binormal vector of the curve. The curve's unit tangent vector T, principal normal vectorNCand torsion τ can then be obtained from the formulae(9)T=r′|r′|,NC=B×T,τ=r‴⋅B|r′×r″|The second basic curvature formula(10)r¨C⋅Nr=krn=III=La2+2Mab+Nb2Ea2+2Fab+Gb2,Nr=ru×rv|ru×rv|E=ru⋅ru,F=ru⋅rv,G=rv⋅rv,L=ruu⋅Nr=−ru⋅Nru,M=ruv⋅Nr=−ru⋅Nrv,N=rvv⋅Nr=−rv⋅Nrvgives the normal curvaturekrnof a parametric surfaceSrat a point P, in terms of the first and second fundamental formsI=Ea2+2Fab+Gb2andII=La2+2Mab+Nb2ofSrat P. Both forms are associated with a tangent vectort=aru+brvofSr. In particular, I is a surface metric allowing lengths, areas and angles onSrto be expressed in terms of its first fundamental coefficients E, F, G. Thus, the norms of t and of the normal vectornr=ru×rvofSrat P are(11)|t|=((aru+brv)(aru+brv))1/2=(Ea2+2Fab+Gb2)1/2|nr|=|ru×rv|=(ru2rv2sin2⁡γ)1/2=(ru2rv2−ru2rv2cos2⁡γ)1/2=(EG−F2)1/2The normal curvaturekrnis the curvature of the section curve ofSrby the normal plane spanned by t andNr. It measures the curving ofSrin the tangent direction t and its variation as t rotates aroundNrreveals the local surface geometry at P. This leads to an examination of the stationary values ofkrn, as the direction ratioa/bof t varies, with the following results:krnhas either two real distinct stationary values (minimumkrn1, maximumkrn2, termed principal curvatures) or it is constant in all directions. In the latter case, the surface looks locally like a spherical cup and the point is an umbilic. Apart from umbilics, the principal curvatures are distinct and the associated principal directions are orthogonal. The local surface shape depends on the relative signs ofkrn1,krn2. This gives rise to two new curvature measures, the Gaussian curvatureK=krn1krn2and the mean curvatureH=(krn1+krn2)/2. Sincekrn1≤krn≤krn2,K>0implies thatkrndoes not change sign and the local surface shape is cup-like. In particular, ifH2−K=0, thenkrn1=krn2and the point is an umbilic.K<0, on the other hand, implies a sign change ofkrnand the local surface shape is saddle-like.The left part of formula (10) expresses the normal curvaturekrnofSrat P as the projection on the surface unit normal vectorNrof the curvature vectorr¨C=kNCof any curve C onSrwhich passes through P and is tangent to t. SinceNr,NCare unit vectors, this part can also be written in the form(12)krn=kNC⋅Nr=kcos⁡θFor reasons that will become apparent when we come to intersection curves, it is convenient to introduce into formula (10) the surface normal vectornr=ru×rvin place of the unit normal vectorNr=nr/|nr|ofSrand write(13)L=L′|nr|,L′=ruunr,M=M′|nr|,M′=ruvnr,N=N′|nr|,N′=rvvnrFormula (10) then reduces to formula (2).The classic formulae for the Gaussian and mean curvatures of a parametric surface are(14)Kr=crK|nr|4,crK=L′N′−M′2,Hr=crH2|nr|3,crH=EN′+GL′−2FM′Spivak (1975, vol. 3), Belyaev et al. (1998), Turkiyyah et al. (1997), Patrikalakis and Maekawa (2002) and Osher and Fedkiw (2003) provide the following formulae for the Gaussian and mean curvatures of a surface with explicit representationz=h(x,y)and implicit representationf(x,y,z)=0(15)Kh=chK|nh|4,chK=hxxhyy−hxy2,|nh|=(hx2+hy2+1)1/2,Hh=chH2|nh|3,chH=(1+hx2)hyy−2hxhyhxy+(1+hy2)hxx(16)Kf=cfK|nf|4,|nf|=(fx2+fy2+fz2)1/2,cfK=fx2(fyyfzz−fyz2)+fy2(fxxfzz−fxz2)+fz2(fxxfyy−fxy2)+2fxfy(fxzfyz−fxyfzz)+2fxfz(fxyfyz−fxzfyy)+2fyfz(fxyfxz−fyzfxx)Hf=cfH2|nf|3,cfH=2(fxfyfxy+fxfzfxz+fyfzfyz)−fx2(fyy+fzz)−fy2(fxx+fzz)−fz2(fxx+fyy)It is important to note that we have cast the normal, Gaussian and mean curvatures of a surface in the generic forms(17)kin=cin|t|2|ni|,Ki=ciK|ni|4,Hi=ciH2|ni|3,i∈(r,h,f,g)where index i indicates the surface representation. We shall call the numerator of each of these forms curvature factor of the respective curvature.To apply formula (2) for the normal curvature of a parametric surfaceSrin a tangent direction t, one must express t in the form(18a)t=aru+brvThis task is trivially simple when t is defined as tangent to a curve C onSr, represented byu=u(t),v=v(t). Then(18b)t=r′=ruu′+rvv′so thata=u′,b=v′. When C is defined onSrby an implicit equationf(u,v)=0then, by the implicit function theorem, as long asfu≠0, u is an explicit functionu=u(v)of v and C can be represented parametrically asr(v)=[x(u(v),v)y(u(v),v)z(u(v),v)]T. Thenv′=1and(18c)f′=fuu′+fv=0→u′=−fvfut=r′=ruu′+rv=−fvfuru+rvso thata=−fv/fu,b=1and formula (2) becomes(19)krn=crn|t|2|nr|,crn=L′fv2−2M′fufv+N′fu2|t|2=Efv2−2Ffufv+Gfu2regardless of which of the parameters u, v is a function of the other.Ye and Maekawa (1999) give the following general expressions for a, b, when t is an arbitrary tangent vector ofSr(20a)a=G(t⋅ru)−F(t⋅rv)EG−F2,b=E(t⋅rv)−F(t⋅ru)EG−F2which are obtained by taking the dot product of Equ. (18a), first withru, then withrvand solving the resulting system for a, b. We shall reduce these expressions for the case when t is tangent to the curve of intersection ofSrby another surface with local normal vector n. Thent=(ru×rv)×nand using the vector identity(a×b)×c=(a⋅c)b−(b⋅c)a, we obtain(21)t=(ru⋅n)rv−(rv⋅n)rut⋅ru=(ru⋅n)F−(rv⋅n)Et⋅rv=(ru⋅n)G−(rv⋅n)FIntroduction of the last two expressions into Equ. (20a) yields(20b)a=−(rv⋅n),b=ru⋅nFor a curve C on a parametric surfaceSr, defined parametrically byu=u(t),v=v(t), the classic expression (8a) of thekBvector yields (Hartmann, 1996)(21a)kB=(ruu′+rvv′)×(ruuu′2+2ruvu′v′+rvvv′2)+ru×rv(u′v″−u″v′)|ruu′+rvv′|3If C is defined implicitly byf(u,v)=0, Equ. (21a) becomes(21b)kB=(rvfu−rufv)×a+β(ru×rv)|rvfu−rufv|3a=ruufv2−2ruvfufv+rvvfu2,β=fuufv2+fvvfu2−2fuvfufvHartmann suggests computing the curvature of C ask=|kB|2. The resulting formulae when Equ. (21a) or (21b) is introduced into this expression are far from been reduced.We shall use the general expression for the curvature k of a space curve C (Equ. (8b)) as a starting point to generate reduced curvature formulae for curves onSr, by substituting in it reduced expressions of the derivativesr′,r″of the position vector of C, in terms of derivatives of the functions involved in the representation of C. Curves on a surface may be represented parametrically, explicitly or implicitly, as the surface itself. In all cases, the domain or range of the curve (depending on the type of variables involved in the curve's definition) must be contained within the domain of definition of the surface, otherwise, numerical problems will arise. For parametric representationsr(u,v)=[x(u,v)y(u,v)z(u,v)]TofSrandu=u(t),v=v(t)of C,r′,r″are expressed in terms of representation function derivatives, using the chain rule(22a)r′=[x′y′z′]=[xuxvyuyvzuzv][u′v′],r″=[x″y″z″]=[xuuxuvxvvyuuyuvyvvzuuzuvzvv][u′22u′v′v′2]+[xuxvyuyvzuzv][u″v″]and formulae (8b) become(23)k=((xpypp−xppyp)2+(ypzpp−yppzp)2+(zpxpp−zppxp)2)1/2(xp2+yp2+zp2)3/2xp=xuu′+xvv′,yp=yuu′+yvv′,zp=zuu′+zvv′xpp=xuuu′2+2xuvu′v′+xvvv′2+xuu″+xvv″,ypp=yuuu′2+2yuvu′v′+yvvv′2+yuu″+yvv″,zpp=zuuu′2+2zuvu′v′+zvvv′2+zuu″+zvv″B=[(ypzpp−yppzp)(zpxpp−zppxp)(xpypp−xppyp)]T((xpypp−xppyp)2+(ypzpp−yppzp)2+(zpxpp−zppxp)2)1/2When C is defined in the parametric plane ofSrby an implicit equationf(u,v)=0, we distinguish two cases. If this equation can be solved in the form sayu=u(v), C can be represented as a space curver(v)=[x(u(v),v)y(u(v),v)z(u(v),v)]Tand its curvature obtained by means of formula (8b). Otherwise, we need a special curvature formula entailing partial derivatives off(u,v). Assumingfu≠0, we can stipulate the existence of a functionu=u(v)and of a representation of C as above. Thenv′=1,v″=0and(24)f′=fuu′+fv=0→u′=−fvfufu′=fuuu′+fuv=−fuufv+fuvfufu,fv′=−fuvfv+fvvfufuu″=fu′fv−fufv′fu2=2fuvfufv−fuufv2−fvvfu2fu3so that Equ. (22a) are adapted as follows:(22b)r′=[x′y′z′]=[xuxvyuyvzuzv][−fv/fu1],r″=[x″y″z″]=[xuuxuvxvvyuuyuvyvvzuuzuvzvv][fv2/fu2−2fv/fu1]+[xuxvyuyvzuzv][u″0]Further(25)x′y″−x″y′=[xuxv][−fv/fu1]([yuuyuvyvv][fv2/fu2−2fv/fu1]+yuu″)−[yuyv][−fv/fu1]([xuuxuvxvv][fv2/fu2−2fv/fu1]+xuu″)=(xuufv2−2xuvfufv+xvvfu2)(yufv−yvfu)fu3−(yuufv2−2yuvfufv+yvvfu2)(xufv−xvfu)fu3−(xuyv−xvyu)(2fuvfufv−fuufv2−fvvfu2)fu3and deriving similar expressions fory′z″−y″z′,z′x″−z″x′, we finally obtain the formulae(26)k=((cxy−cyx−nzupp)2+(cyz−czy−nxupp)2+(czx−cxz−nyupp)2)1/2(cxl2+cyl2+czl2)3/2cxq=xuufv2−2xuvfufv+xvvfu2,cyl=yufv−yvfu,cxy=cxqcylcyq=yuufv2−2yuvfufv+yvvfu2,cxl=xufv−xvfu,cyx=cyqcxlczq=zuufv2−2zuvfufv+zvvfu2,czl=zufv−zvfu,cyz=cyqczlczy=czqcyl,czx=czqcxl,cxz=cxqczl,upp=2fuvfufv−fuufv2−fvvfu2nx=yuzv−yvzu,ny=zuxv−zvxu,nz=xuyv−xvyuB=[(cyz−czy−nxupp)(czx−cxz−nyupp)(cxy−cyx−nzupp)]T((cxy−cyx−nzupp)2+(cyz−czy−nxupp)2+(czx−cxz−nyupp)2)1/2Example 1Given a spherical surfaceSr, represented asr=R[cos⁡ucos⁡vsin⁡ucos⁡vsin⁡v]T, the curvature of the surface curvef=u−v=0,−π/2≤u,v≤π/2, is found by means of curvature formula (8b) to bek=(3cos2⁡v+5)1/2R(cos2⁡v+1)3/2Verify this expression using curvature formula (26).Partial derivatives of f:fu=1,fv=−1,fuu=fuv=fvv=0,upp=0.Partial derivatives ofSr:ru=R[−sinucos⁡vcos⁡ucos⁡v0]T,rv=R[−cosusin⁡v−sinusin⁡vcos⁡v]T,ruu=R[−cosucos⁡v−sinucos⁡v0]T,ruv=R[sin⁡usin⁡v−cosusin⁡v0]T,rvv=−R[cos⁡ucos⁡vsin⁡ucos⁡vsin⁡v]T.cxl,cyl,czl̲:cxl=R(sin⁡ucos⁡v+cos⁡usin⁡v),cyl=R(−cos⁡ucos⁡v+sin⁡usin⁡v),czl=−Rcos⁡v,(cxl2+cyl2+czl2)3/2=R3(cos2⁡v+1)3/2.cxq,cyq,czq̲:cxq=2R(sin⁡usin⁡v−cos⁡ucos⁡v),cyq=−2R(sin⁡ucos⁡v+cos⁡usin⁡v),czq=−Rsin⁡v.cxy,cyx,cxz,czx,cyz,czy̲:cxy=cxqcyl=2R2(sin⁡usin⁡v−cos⁡ucos⁡v)2,cyx=cyqcxl=−2R2(sin⁡ucos⁡v+cos⁡usin⁡v)2,cxz=cxqczl=−2R2cos⁡v(sin⁡usin⁡v−cos⁡ucos⁡v),czx=czqcxl=−R2sin⁡v(sin⁡ucos⁡v+cos⁡usin⁡v),cyz=cyqczl=2R2cos⁡v(sin⁡ucos⁡v+cos⁡usin⁡v),czy=czqcyl=−R2sin⁡v(−cos⁡ucos⁡v+sin⁡usin⁡v).Curvature formula (26):(cxy−cyx)2=4R4,(cyz−czy)2=R4(sin⁡ucos2⁡v+sin⁡u+cos⁡usin⁡vcos⁡v)2,(czx−cxz)2=R4(sin⁡usin⁡vcos⁡v−cos⁡ucos2⁡v−cos⁡u)2k=((cxy−cyx)2+(cyz−czy)2+(czx−cxz)2)1/2(cxl2+cyl2+czl2)3/2=(3cos2⁡v+5)1/2R(cos2⁡v+1)3/2The task of developing curvature formulae for curves lying on an implicit surfaceSfhas been an open question, according to Goldman (2005). The rest of this section is our attempt to provide an answer. WhenSfis represented asf(x, y,z)=0, a parametric definitionx=x(u),y=y(u),z=z(u)of C onSf, involving all three coordinates cannot be distinguished from an ordinary parametric representation of C as a space curve, even though incidentallyx=x(u),y=y(u),z=z(u)satisfy the surface equationf(x,y,z)=0identically. Also an implicit definitiong(x,y,z)=0of C as a curve onSfcannot be distinguished from its definition as an intersection curve of the surfacesf(x,y,z)=0,g(x,y,z)=0. In the first case, the curvature of C is provided by curvature formula (8b), while the second case is treated in Section 5.Distinct definitions of C onSfresult by imposing on only two of the three coordinates ofSf, say on x, y, a parametric restrictionx=x(u),y=y(u)or an implicit restrictiong(x,y)=0. In the first case, a value of u fixes x, y, but z can only be obtained from the implicit equationf(x,y,z)=0iffz≠0. The curvature formula must somehow reflect this fact. The derivativesr′,r″in the general curvature formula (8b) are then obtained for the x and y components from the given functionsx=x(u),y=y(u), while forz′,z″, the curve representationf(x(u),y(u),z)=0yields(27)f′=fxx′+fyy′+fzz′=0→z′=zpfz,zp=−(fxx′+fyy′)and by differentiatingz′(28a)z″=−fz(fx′x′+fy′y′+fxx″+fyy″)−(fxx′+fyy′)fz′fz2where, by the chain rule(29)[fx′fy′fz′]=[fxxfxyfxzfxyfyyfyzfxzfyzfzz][x′y′z′]and by introducing Equ. (29) into Equ. (28a), the latter becomes(28b)z″=zppfz3,zpp=−(fz2(fxxx′2+fyyy′2+2fxyx′y′+fxx″+fyy″)+2fz(fxzx′+fyzy′)zp+fzzzp2)Then, introduction of the above expressions forz′,z″into formulae (8b), yields(30)k=(fz6(x′y″−x″y′)2+(y′zpp−y″fz2zp)2+(fz2zpx″−zppx′)2)1/2(fz2(x′2+y′2)+zp2)3/2B=[(y′zpp−y″fz2zp)(fz2zpx″−zppx′)fz3(x′y″−x″y′)]T(fz6(x′y″−x″y′)2+(y′zpp−y″fz2zp)2+(fz2zpx″−zppx′)2)1/2These expressions are symmetric in x, y but non-robust since, whenfz=0we havezp=zpp=0and k, B assume the indeterminate values 0/0,0/0. This is expected since, as noted above,f(x,y,z)=0cannot be solved for z when this condition exists.When bothSfand C are represented implicitly asf(x,y,z)=0andg(x,y)=0, respectively, assuminggy≠0, we can stipulate the existence of a functiony=y(x)and represent again C on S parametrically byx=x,y=y(x), with parameter x this time. Thenx′=1,x″=0and(31a)g′=gx+gyy′=0→y′=−gxgy,y″=gy′gx−gygx′gy2f′=fx+fyy′+fzz′=0→z′=zpgyfz,zp=fygx−fxgyz″=(fy′gx+fygx′−fx′gy−fxgy′)gyfz−zp(gy′fz+gyfz′)gy2fz2Introducing the derivative expressions(32)[gx′gy′]=[gxxgxygxygyy][1y′]=1gyfz[gxxgxygxygyy][gyfz−gxfz][fx′fy′fz′]=[fxxfxyfxzfxyfyyfyzfxzfyzfzz][1y′z′]=1gyfz[fxxfxyfxzfxyfyyfyzfxzfyzfzz][gyfz−gxfzzp]we obtain(31b)y″=yppgy3,ypp=2gxygxgy−gxxgy2−gyygx2,z″=zppgy3fz3zpp=2fxygxgy2fz2−2fxzgy2fzzp+2fyzgxgyfzzp−fxxgy3fz2−fyygx2gyfz2−fzzgyzp2−2gxygxgyfyfz2+gxxfygy2fz2+gyygx2fyfz2(33)y′z″−y″z′=cyzgy3fz3cyz=−2fxygx2gyfz2+2fxzgxgyfzzp−2fyzgx2fzzp+fxxgxgy2fz2+fyygx3fz2+fzzgxzp2+2gxyfxgxgyfz2−gxxfxgy2fz2−gyyfxgx2fz2With the above expressions ofy′,y″,z′,z″and the valuesx′=1,x″=0, formulae (8b) become(34)k=((yppfz3)2+(cyz)2+(zpp)2)1/2((gx2+gy2)fz2+zp2)3/2B=[cyz−zppyppfz3]T((yppfz3)2+(cyz)2+(zpp)2)1/2Curvature formula (34) encompasses the known formula for the curvature of a plane implicit curveg(x,y)=0(35)k=ypp(gx2+gy2)3/2=2gxygxgy−gxxgy2−gyygx2(gx2+gy2)3/2as a special case, whenSfis thex–ycoordinate plane, defined byf(x,y,z)=z=0. Then,fz=1,zp=zpp=cyz=0and formula (34) reduces to formula (35).The curvatures of special curves on a surface are also of interest. Geodesics have their principal normal vectorNCaligned with the surface unit normal vector N. Consequently (Equ. (12)), their curvature k is equal to the local normal curvatureknof the surface, in the direction of the geodesic. The curvatures of lines of curvature (principal curvatures) are roots of the quadratic equation(36)k2−2Hk+K=0Direct but unreduced formulae for the curvatures of curvature lines on implicit surfaces have been provided by Che et al. (2007). Curvature formulae for topologically important curves such as ridges and ravines are presented in Che et al. (2011).LetSa,Sbbe two intersecting surfaces, C their curve of intersection, P a point on C andNa,Nbthe unit normal vectors ofSa,Sbat P. Then, the normal curvature vectorskanNa,kbnNbofSa,Sbdetermine the curvature k of their intersection curve C at P (Fig. 1). This is a consequence of Equ. (12), as follows: The plane spanned byNa,Nbis normal to C at P and contains the principal normalNCof C and its curvature vectorkNC. Since C belongs to bothSαandSb, according to Equ. (12), the projections of its curvature vectorkNCon the lines Px, Py normal toSα,Sbwill be equal in magnitude to the normal curvatureskan,kbnofSa,Sb, in the direction of the tangent to C at P. Conversely, if on the lines Px, Py drawn normal toSa,Sbwe take segmentsPA=kan,PB=kbnand from their end points A, B draw normals to these lines in their plane, the intersection Q of the normals defines the curvature vectorPQ→=kNCof C and, consequently, the curvature k of C at P. The dependence of k onkan,kbnand φ revealed by this construction, is expressed by Equ. (1). There are two alternative equations, which express the same relationship. The first(37a)kB=kanNb−kbnNa|Na×Nb|was provided by Faux and Pratt (1981, p. 262) and the second(38)kNC=kan−kbncos⁡φsin2⁡φNa+kbn−kancos⁡φsin2⁡φNbby Ye and Maekawa (1999). Both reduce to Equ. (1) by squaring.Surprisingly, the possibility of using these expressions to derive reduced formulae for the curvature of the intersection curve has not been exploited by their authors. We shall use Equ. (37a) for this purpose. It is more convenient to introduce into it the surface normal vectorsna,nb, through the expressionsNa=na/|na|,Nb=nb/|nb|and write Equ. (37a) in the form(37b)kB=kan|na|nb−kbn|nb|na|t|,|t|=|na×nb|The convenience stems from the fact that introduction of the generic forms of the normal curvatureskan,kbnofSα,Sb(Equ. (17)) simplifies this expression, as follows(39a)kB=cannb−cbnna|t|3Equ. (39a) leads directly to reduced formulae for the curvature k of C and for its binormal vector B, as follows(39b)k=|cannb−cbnna||t|3,B=cannb−cbnna|cannb−cbnna|To generate a reduced curvature expression for the curvature k of the intersection curve C of two implicit surfacesSf,Sg, for example, represented byf(x,y,z)=0,g(x,y,z)=0, we introduce into Equ. (39a) expressions for the normal curvature factorscfn,cgnofSf,Sg(Equ. (3)) and the expressionsnf=∇f,ng=∇gfor the surface normal vectors andt=nf×ngfor the tangent vector of C. We then have the following formulae for the curvature k and for the binormal vector B of C(39c)k=((cfngx−cgnfx)2+(cfngy−cgnfy)2+(cfngz−cgnfz)2)1/2(tx2+ty2+tz2)3/2cfn=−(fxxtx2+fyyty2+fzztz2+2fxytxty+2fxztxtz+2fyztytz)cgn=−(gxxtx2+gyyty2+gzztz2+2gxytxty+2gxztxtz+2gyztytz)B=[(cfngx−cgnfx)(cfngy−cgnfy)(cfngz−cgnfz)]T((cfngx−cgnfx)2+(cfngy−cgnfy)2+(cfngz−cgnfz)2)1/2For two parametric surfacesSr1,Sr2, represented byr1(u,v)=[x1(u,v)y1(u,v)z1(u,v)]T,r2(p,q)=[x2(p,q)y2(p,q)z2(p,q)]Twith normal vectorsn1=r1u×r1v,n2=r2p×r2q, the tangent vectort=n1×n2of their intersection curve C has tangential coordinates in the basisr1u,r1vof the tangent plane ofSr1a1=−r1v⋅n2,b1=r1u⋅n2and in the basisr2p,r2qof the tangent plane ofSr2a2=−r2q⋅n1,b2=r2p⋅n1(Equ. (20b)). Then, Equ. (39a) yields the formulae(39d)k=((cr1n2x−cr2n1x)2+(cr1n2y−cr2n1y)2+(cr1n2z−cr2n1z)2)1/2(tx2+ty2+tz2)3/2cr1=L1′a12+2M′a1b1+N1′b12,L1′=r1uun1,M1′=r1uvn1,N1′=r1vvn1cr2=L2′a22+2M′a2b2+N2′b22,L2′=r2ppn2,M2′=r2pqn2,N2′=r2qqn2B=[(cr1n2x−cr2n1x)(cr1n2y−cr2n1y)(cr1n2z−cr2n1z)]T((cr1n2x−cr2n1x)2+(cr1n2y−cr2n1y)2+(cr1n2z−cr2n1z)2)1/2The curvature formula for the intersection curve of a parametric with an implicit surface was derived in Section 1 (Equ. (6b)), but it could have more readily been derived from Equ. (39a).Interest in the differential geometry of surface intersection curves has recently expanded to include intersection curves in R4 and even higher dimensions (Goldman, 2005; Aléssio, 2006; 2012; Düldül, 2010).Intersection curves of surfaces which are offsets of (also known as parallel to) given surfaces do arise in modern applications, justifying a revival of interest in their differential properties. For example, in the 3-axis CNC milling of free-form geometries, with a ball-end cutter of radius R, it is sometimes desirable to move the cutter with its ball-end being in simultaneous contact with two given surfaces, both of which must be machined or one must be machined, while the other is used for guiding the tool. Then, the center point of the ball-end of the cutter, whose motion is programmed, moves along the intersection of two surfaces which are offsets of the given surfaces, at distance R.LetSpbe an offset surface of a given surface S, at distance d. Classical texts focus on the fact that at corresponding points P,Ppon S,Sp, that is points lying on a common normal line, the principal directions of the two surfaces are parallel and their principal curvatureskni,kpni,i=1,2, are related by(40)kni=kpni1+dkpni,kpni=kni1−dkni,i=1,2They don't show, however, how the normal curvatures of S,Spare related, in other directions. We shall investigate this matter, using Euler's equation (Struik, 1950), which expresses the normal curvatureknat a surface point P, in a given tangent direction t, in terms of the principal curvatureskn1,kn2of the surface at P and the angle φ of t with the direction ofkn1, as follows:(41a)kn=kn1cos2⁡φ+kn2sin2⁡φ=(kn1−kn2)cos2⁡φ+kn2We apply Euler's equation toSpand substitute in it the principal curvatureskpn1,kpn2ofSpby their expressions in terms of the principal curvatures of S (Equ. (40)), to obtain(41b)kpn=(kpn1−kpn2)cos2⁡φp+kpn2=(kn11−dkn1−kn21−dkn2)cos2⁡φp+kn21−dkn2Since the principal directions on S,Spare parallel, t makes equal angles with the directions of the principal curvatureskn1of S andkpn1ofSp. Thus, by applying Euler's equation to S, we expresscos2⁡φpin terms of the principal curvatures of S(42)cos2⁡φp=kn−kn2kn1−kn2and Equ. (41b) becomes(41c)kpn=(kn11−dkn1−kn21−dkn2)(kn−kn2kn1−kn2)+kn21−dkn2=kn−dkn1kn21−d(kn1+kn2)+d2kn1kn2=kn−dK1−2dH+d2KThe last expression of the normal curvaturekpnofSpentails the normal curvatureknof the base surface S in the tangent direction t and the Gaussian and mean curvatures K, H of S. Reduced formulae for these curvatures have been given in Section 2 (Equ. (15)–(17)). Substitutingkn, K, H by their generic expressions, we obtain(43)kipn=cin|t|2|ni|−dciK|ni|41−dciH|ni|3+d2ciK|ni|4=cipn|t|2|ni|,cipn=|ni|(cin|ni|3−dciK|t|2)|ni|4−dciH|ni|+d2ciKExpressions derived by instantiating the normal curvature expression (43) for a surfaceSrpoffset of a given parametric surfaceSr(i=r)and for a surfaceSfpoffset of a given implicit surfaceSf(i=f), can now be combined in all three modes (implicit/implicit, parametric/parametric and parametric/implicit) of the given surfacesSr,Sf, with the aid of Equ. (39a), to yield curvature formulae for the intersection curves of offset surfaces. It may also be desirable to compute the curvature of the intersection of a given surfaceSawith a surfaceSbpoffset of a given surfaceSb. In all these cases, Equ. (39a), (43) can be used to produce intersection curvature formulae for offset surfaces, as it was done for given implicit and parametric surfaces in Section 5, provided proper expressions for the curvature factorscrn,cfn,crK,cfK,crH,cfHof the given surfaces are utilized. For two surfacesSfp,Sgpoffset of given implicit surfacesSf,Sgrepresented byf(x,y,z)=0,g(x,y,z)=0, for example, Equ. (39a) yields(44)k=((cfpngx−cgpnfx)2+(cfpngy−cgpnfy)2+(cfpngz−cgpnfz)2)1/2(tx2+ty2+tz2)3/2cfpn=|nf|(cfn|nf|3−dcfK|t|2)|nf|4−dcfH|nf|+d2cfK,cgpn=|ng|(cgn|ng|3−dcgK|t|2)|ng|4−dcgH|ng|+d2cgKB=[(cfpngx−cgpnfx)(cfpngy−cgpnfy)(cfpngz−cgpnfz)]T((cfpngx−cgpnfx)2+(cfpngy−cgpnfy)2+(cfpngz−cgpnfz)2)1/2withnf=∇f,ng=∇g,t=nf×ng, where the expressions for the normal curvature factorscfn,cgnare derived from Equ. (3) and those forcfK,cfH,cgK,cgHfrom Equ. (16).Example 2Given a spherical surfaceSfof radius R and a circular conical surfaceSgwith a 90° aperture and its apex at the center of the sphere, implicitly represented byf=xf2+yf2+zf2−R2=0,g=yg2+zg2−xg2=0and offsetsSfp,Sgpof these surfaces at distance d (Fig. 2): a) Express, by means of geometry, the curvature k of the largest of the two circles of intersection ofSfp,Sgp, in terms of R, d. b) Verify the curvature expression found in (a) by means of the general curvature formula (44).(a) In thex–zplane, the generatrix line OP ofSgphas equationz=x+2d. It meets the circlex2+z2=(R+d)2at P, whose coordinates are found by solving the system of these two equations to bexP=2(R2+2dR−d)2,zP=2(R2+2dR+d)2SincezPequals the radius r of the intersection circle ofSfp,Sgp, the curvature of this circle is(b) Partial derivatives of the given surfacesSf,Sg:fx=2xf,fy=2yf,fz=2zf,fxx=fyy=fzz=2,fxy=fxz=fyz=0gx=−2xg,gy=2yg,gz=2zg,gxx=−2,gyy=gzz=2,gxy=gxz=gyz=0Surface normal vectors ofSf,SgatPf,Pg(yf=yg=0):nf=∇f=[2xf02zf]T,ng=∇g=[−2xg02zg]T,|nf|=2R,|ng|=2(xg2+zg2)1/2=2(OP−d)=2(2r−d)=2R2+2dRTangent vector of the intersection circle ofSfp,Sgpat P:tP=nf×ng=4[0−(zfxg+xfzg)0]TTo evaluate the norm oftP, we substitute the coordinates ofPf(xf,0,zf),Pg(xg,0,zg)in terms of coordinates ofP(xP,0,zP), using the defining relations of the offset surfaces:rP=rf+dnf|nf|=rg+dng|ng||nf|xf+2dxf=|nf|xP→xf=RR+dxP,zf=RR+dzP|ng|xg−2dxg=|ng|xP→xg=|ng|xP|ng|−2d,zg=|ng|zP|ng|+2dBefore applying curvature formula (44), it is convenient to express all quantities it entails in terms of R, d,|ng|,|tP|. Thus, we havexP=2(|ng|−2d)4,r=zP=2(|ng|+2d)4xf=2R(|ng|−2d)4(R+d),yf=2R(|ng|+2d)4(R+d)xg=zg=2|ng|4,|tP|=4|(zfxg+xfzg)|=R|ng|2R+dCurvature factors ofSfp,Sgp(Equ. (3), (17)):cfn=−2tPy2=−2|tP|2,cfK=16(xf2+zf2)=16R2,cfH=−16(xf2+zf2)=−16R2cfpn=|nf|(cfn|nf|3−dcfK|tP|2)|nf|4−dcfH|nf|+d2cfK=−2R|tP|2R+dcgn=−2tPy2=−2|tP|2,cgK=16(xg2−zg2)=0,cgH=−16xg2=−2|ng|2cgpn=cgn|ng|3|ng|3−dcgH=−2|ng||tP|2|ng|+2dCurvature of the intersection circle ofSfp,Sgp(Equ. (44)):k=((cfpngx−cgpnfx)2+(cfpngz−cgpnfz)2)1/2|tP|3cfpngx−cgpnfx=cfpn(−2xg)−cgpn(2xf)=22R|ng|2|tP|2(R+d)(|ng|+2d)cfpngz−cgpnfz=cfpn(2zg)−cgpn(2zf)=0k=|cfpngx−cgpnfx||tP|3=22|ng|+2d=2(R2+2dR+d)The following properties of reduced curvature formulae can now be stated:a)They are closed formulae, entailing only basic arithmetic operators (addition, subtraction, multiplication, division) and square root operators. They are thus suitable for casual users, whose skills do not extend beyond basic algebra and the extraction of function derivatives.They are more efficient compared to alternative unreduced formulae (see Appendix A).Although we have presented several reduced formulae, we have not exhausted all cases that may arise. We have not, for example, dealt with the curvature of curves defined by differential equations. Curves on offset surfaces may also arise in ways other than as intersections with other surfaces. An open problem is developing a curvature formula for the curveCptraced by a pointPpon a surfaceSp, offset of a given surface S, when its corresponding point P traces on S a given curve C. In this case, C andCpdo not have the same directions at corresponding points, so Euler's formula (Equ. (41a)) cannot be used to relate the curvatures of C,Cp. The solution of this problem would be of practical interest in the isoparametric 3-D machining of a surface patch S, with a ball-end cutter.

@&#CONCLUSIONS@&#
