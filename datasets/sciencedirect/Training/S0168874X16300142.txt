@&#MAIN-TITLE@&#
Multiscale analysis of heat treatments in steels: Theory and practice

@&#HIGHLIGHTS@&#
Description of the differential formulation of the transient multiscale model as well as its numerical equations, practical implementation, validation and multiscale application.Application of a rigorous and consistent multiscale tool called Asymptotic Expansion Homogenization.Application of the transient multiscale model to model heat treatments is original. No publication was found with this approach.

@&#KEYPHRASES@&#
Transient multiscale analysis,Asymptotic Expansion Homogenisation,Periodic microstructure,Heat treatments,

@&#ABSTRACT@&#
Multiphase steels offer impressive mechanical properties. However, their characterisation still represents a challenge. In a quenching process, phenomena such as undesirable strains or residual stresses are inevitable and can be the cause for non-admissible final parts. Microstructural phase transformations generally magnify the problem. The non-existence of efficient non-destructive experimental procedures capable of measuring them leads to the need of numerical tools capable of quantifying these undesirable effects.In this work, a numerical multiscale transient model, that uses the Asymptotic Expansion Homogenisation (AEH) methodology combined with Finite Element Method (FEM), is proposed for the analysis of heat treatments in steels. The implementation of the AEH method is carried out using the commercial program Abaqus, considering an uncoupled and transient problem with implicit time integration. Within the homogenisation method, the existence of two distinct scales is assumed, defining a micro- and a macroscale. In the smaller scale, the evolution of a steel periodic microstructure is analysed in detail and an equivalent homogeneous material model is established for macroscopic use. Moreover, it is presented in this work that AEH is a rigorous and effective homogenisation method that allows the modelling of the thermomechanical and transient thermal behaviour in periodic materials, particularly in heat treatments.

@&#INTRODUCTION@&#
Steels are widely used on many applications and some of them require heat treating the material in order to achieve the desired strength, machinability or formability [1]. During quenching, hardenable steels may suffer dramatic changes in their microstructure and, consequently, on their properties. Such processes may lead to the appearance of undesirable effects such as residual stresses and distortions on the steel part [2]. The residual stresses have their origin on plasticity phenomena and phase transformations. Moreover, inhomogeneous cooling processes tend to intensify the unwanted effects. Nowadays, there is little doubt that steel phase transformations play a major role in the development of residual stresses and should be taken into account [3]. Therefore, this work presents a transient multiscale model capable of reproducing the thermomechanical behaviour in the referred transformations using the Asymptotic Expansion Homogenisation (AEH) methodology and Finite Element Method (FEM).Homogenisation is rapidly maturing due to the increasing power of computation. However, this subject dates back to many years ago, starting with homogenisation methods such as effective medium models of Eshelhy [4], Mori and Tanaka [5], self-consistent approaches of Hill [6] and many others [7]. Later, a new mathematical homogenisation methodology emerged as the Asymptotic Expansion Homogenisation pioneered by Bensoussan et al. [8].Many authors followed this subject, as Sanchez-Palencia [9], Guedes and Kikuchi [10], Hollister and Kikuchi [11], Terada and Kikuchi [12], Chung et al. [13], Yuan and Fish [14], Pinho-da-Cruz et al. [15], Zhang et al. [16], Özdemir et al. [17], Goupee and Vel [18], and Terada et al. [19]. For instance, Zhang et al. [16] used a thermomechanical multiscale model in order to model the thermodynamic wave propagation phenomena. Özdemir et al. [17] also used a thermomechnical multiscale with particular emphasis in modelling thermal shocks and consequent thermomechanical damage and debonding. Later, Terada et al. [19] also used a thermomechanical multiscale model with microscale heat transfer in order to analyse porous solids.The base formulation of the presented multiscale model has been used by other authors in order to model many phenomena, as previously enumerated. However, the modelling of steel heat treatments with phase transformations provides a new application. The presented transient multiscale model is implemented in the commercial Computer-Aided Engineering (CAE) software ABAQUS [20]. This provides engineers and/or new researchers with a methodology to create their own transient multiscale model. This is taken further with a code subroutine that is provided in Appendix A, in order to facilitate and encourage new developments.The AEH methodology considers the existence of two distinct scales: a micro- and a macroscale. During the process, the macroscale is explicitly analysed using the information gathered on a detailed analysis of the microscale. Being a multiscale procedure, the inverse approach is also done. The detailing of the material behaviour in the microscale with the results from the macroscale is called localisation. This homogenisation methodology allows the analysis of a great number of different microstructures, given the requirement of a periodic Representative Unit Cell (RUC) [21]. The main advantages of this methodology are: (i) allowing the modelling of the mechanical, thermomechanical and transient thermal behaviours of periodic materials with a rigorous and effective homogenisation methodology, (ii) reducing the number of degrees of freedom linked to modelling of the material behaviour, (iii) allowing the proper characterisation of periodic heterogeneous microstructures [15] and (iv) analysing the material anisotropy microstructurally for macroscopic use. However, this methodology has drawbacks. If non-linear phenomena (i.e. phase transformations) are introduced, several of microscales are needed, since each material point of the macroscale might evolve in a particular way. Therefore, techniques to reduce the computational costs are needed. Within this work, a methodology to reduce computational costs is presented and the temperature is a key parameter to achieve it. While this work proposes a new approach, this topic has also been studied by other authors. Temizer and Wriggers [22], proposed the use of the eigenvalues of the macroscopic strain tensor and their orientation as a way to construct a material map and therefore reduce computational costs. Yvonnet et al. [23], also proposed the use of a material database that stores the effective strain energy density functions in the macroscopic right Cauchy–Green strain tensor, combined with a simplified interpolation scheme.This document starts with the introduction of the transient multiscale model formulation, its assumptions and differential formulation, followed by the analysis and discussion of the finite element formulation of the variational problems and their implementation. Then, a validation test is presented, where AEH methodology is compared to the general FEM methodology. In the end, a multiscale application of AEH in heat treatments and its results, such as the characteristic displacement fields, the homogenised properties, the stress and temperature evolution, and the process of localisation for both mechanical and thermal fields, are presented. Finally, some final remarks are provided.The Asymptotic Expansion Homogenisation is an homogenisation methodology capable of modelling the behaviour of periodic materials in an uncoupled and quasi-static process. The macroscopic behaviour of a heterogeneous material is derived from the heterogeneity scale that describes the physical process over a Representative Unit-Cell (RUC) [21], i.e., the spatial repetition of the RUC form the heterogeneous material. However, the referred element has to be large enough to represent the material and small enough when compared to the macroscopic volume. The fundamental condition can be expressed as(1)ϵ=lL⪡1,where l and L are the characteristic lengths of the RUC and macroscopic body, respectively. In the presence of a periodic heterogeneous medium, the AEH is the most effective methodology [24]. At this point, it is common to assume two distinct scales: x and y for the behaviour of the materials in the macroscale and in the microscale, respectively [7]. Thus, the variables related to the referred fields become functionally dependent on both x and y scales, where(2)y=x/ϵ.The referred functional dependence is usually called Y-periodicity. Thereby, the Y-periodicity of the microstructural heterogeneities reflects itself on the fact that the thermal expansion tensorα, the elasticity tensor D and the thermal conductivity tensor k are Y-periodic in y. In contrast, the material homogeneity at the macroscale level results from the fact that the tensors do not depend on the macroscale x, resulting in(3)αij=αij(y),(4)Dijkl=Dijkl(y)and(5)kij=kij(y).On the macroscale x, the microscale constituents appear over periods ϵ−1 times smaller than the characteristic dimension of Y. Replacing Eq. (2) in Eqs. (3)–(5) results in(6)αijϵ=αij(x/ϵ),(7)Dijklϵ=Dijkl(x/ϵ)and(8)kijϵ=kij(x/ϵ),respectively, where the superscript ϵ states thatα, D and k areϵY-periodic in the macroscale x.The formulation presented in the following sections is based on the formulations presented in [13,15,25,26].Assuming infinitesimal strains and a quasi-static process, the linear thermoelastic problem is given by the following equations:(9)∂σijϵ∂xjϵ+fi=0inΩ,(10)εijϵ=12(∂uiϵ∂xjϵ+∂ujϵ∂xiϵ)inΩand(11)σijϵ=Dijklϵεklϵ−βijϵΔTϵ,where(12)ΔTϵ=Tϵ−T0and(13)βijϵ=Dijklϵαklϵ=βij(x/ϵ).σijϵandεijϵare the components of the Cauchy stress and the strain tensors, respectively. fi, uiand T0 are the loads per unit of volume, displacements and the reference temperature, respectively. The boundary of Ω is defined by the surfacesΓDandΓN. These are related to the Dirichlet and Neumann boundary conditions(14)uiϵ=u¯iinΓDand(15)σijϵnj=t¯iinΓN,whereΓD∪ΓN=ΓandΓD∩ΓN=∅.u¯iandt¯iare the prescribed values of displacements and forces, respectively. njare components of the outward unit vector, orthogonal to surfaceΓN.Considering the existence of two distinct scales, which connect the material behaviour of the macroscale Ω and the microscale Y, the displacement fields can be approximated by an asymptotic expansion in ϵ, mathematically given by(16)uiϵ=ui(0)(x,y)+ϵui(1)(x,y)+ϵ2ui(2)(x,y)+⋯,whereui(r)(x,y), withr∈N0andi∈{1,2,3}, are Y-periodic functions in y, called correctors of order r of the displacement field. Considering thaty=x/ϵ, the application of the chain differentiation rule results in(17)∂·∂xiϵ=∂·∂xi+1ϵ∂·∂yi.Replacing Eq. (17) in (10), the linearised thermoelastic problem formulation is obtained. The displacements fieldsui(0)are the solutions of the homogenised thermoelastic problem, defined as(18)∂Σij∂xj+bi=0inΩ,(19)uiϵ=u¯iinΓD,(20)Σijnj=t¯iinΓNand(21)Σij=Dijklh∂uk(0)∂xl−βijh(T(0)−T0)inΩ,where Σijrepresents the macrostructural stress field.Dijklhandβijhrepresent the homogenised elastic tensor and thermal moduli tensor, respectively, defined as(22)Dijmnh=1|Y|∫YDijkl(y)(Iklmn−∂χkmn∂yl)dYand(23)βijh=1|Y|∫Y(βij(y)−Dijkl(y)∂Ψk∂yl)dY.Iklmn=δkmδln, where δijis the Kronecker׳s delta. χkmnand Ψkrepresent the components of the mechanical and thermomechanical characteristic displacement tensors, respectively, obtained as a solution of(24)∫YDijkl∂χkmn∂yl∂vi∂yjdY=∫YDijmn∂vi∂yjdY,∀vi∈V˜Yand(25)∫YDijkl∂Ψk∂yl∂vi∂yjdY=∫Yβij∂vi∂yjdY,∀vi∈V˜Y,where χkmnandΨk∈V˜YandV˜Yis the set of Y-periodic continuous and sufficiently regular functions with an average value of zero in Y. The computation of the average value of a Y-periodic function in Y is written as(26)<Φ>Y=1|Y|∫YΦ(x,y,t)dY.This formulation is based on the micro- and macroscale, and the validity of this assumption is dependent on the existence of periodic oscillations in the displacement fields. These oscillations should overlap macroscopic fields, where a heterogeneous material is approximated by a homogeneous material. In this sense, the results from the macroscale can be used to estimate stress and strain levels in the microscale. This process is called localisation and can be defined as(27)σij(1)(x,y)=Dijkl(y)(Iklmn−∂χkmn∂yl)∂um(0)∂xn+[Dijkl(y)∂Ψk∂yl−βij(y)](T(0)−T0)and(28)εij(1)(x,y)=12(δikδjl+δilδjk)[(Iklmn−∂χkmn∂yl)∂um(0)∂xn+∂Ψk∂yl(T(0)−T0)].The previous equations allow to estimate microstructural stress and strain levels for every point in the macroscale x. The homogenised stress fields in the macroscale correspond to average values of the microscale fields.The thermal transient problem is described by the equilibrium equation and the Fourier׳s law for heat conduction as(29)∂qiϵxijϵ+ρϵcϵṪϵ−Q=0inΩand(30)qiϵ=−kijϵ∂TϵxjϵinΩ,fori,j=1, 2, 3. qiare the components of the conduction heat fluxes and Q is the rate of heat generation per unit of volume.TϵandṪϵare the temperature value and time rate, respectively.ρϵis the material density and cϵis the specific heat. The boundary of Ω is defined by the surfacesΓD,ΓNandΓR. These are related to the Dirichlet, Neumann and Robin boundary conditions(31)Tϵ=T¯inΓD,(32)qiϵni=−q¯inΓNand(33)qiϵni=hc(Tϵ−T∞)inΓR,respectively, whereΓD∪ΓN∪ΓR=ΓandΓD∩ΓN=ΓD∩ΓR=ΓR∩ΓN=∅.T¯andq¯are the prescribed temperature and conduction heat flux, respectively. niare the components of the outward unit vector, orthogonal to the surfacesΓNorΓR. hcandT∞are the convection coefficient and the room temperature, respectively. The auxiliary variational problemTϵ∈VΩ0of Eq. (29) becomes [18](34)∫Ωkijϵ∂Tϵxjϵ∂vxiϵdΩ+∫ΩρϵcϵṪϵvdΩ=∫ΩQvdΩ+∫ΓNq¯vdΓ−∫ΓRhc(Tϵ−T∞)vdΓ,whereVΩ0is a set of functions, continuous, sufficiently regular and zero-valued inΓD.With the existence of two different scales, associated to behaviour levels over the macroscale Ω and microscale Y, the temperature field is approximated using the respective asymptotic expansions in ϵ as(35)Tϵ(x,t)=T(0)(x,y,t)+ϵT(1)(x,y,t)+ϵ2T(2)(x,y,t)+⋯,whereT(r)(x,y,t), withr∈N0, are Y-periodic functions in y, classified as therthorder temperature field correctors. Replacing the asymptotic expansions of the temperature fields (Eq. (35)) in the Fourier׳s law of heat conduction (Eq. (30)) and making use of Eq. (17) results(36)qiϵ=ϵ−1qi(0)+ϵ0qi(1)+ϵ1qi(2)+⋯,(37)qi(0)=−kij(y)∂T(0)∂yjand(38)qi(r)=−kij(y,t)(∂T(r−1)∂xj+∂T(r)∂yj),r∈N.Substituting Eq. (36) in the equilibrium Eq. (29) and making use of Eq. (17), it is possible to obtain(39)ϵ−2∂qi(0)∂yi+ϵ−1(∂qi(0)∂xi+∂qi(1)∂yi)+ϵ0(∂qi(1)∂xi+∂qi(2)∂yi+ρϵcϵṪϵ−Q)+ϵ1⋯=0.Considering the fact that Eq. (39) has to be valid for everyϵ→0, all terms associated with ϵ have to be zero, meaning(40)ϵ−2⇒∂qi(0)∂yi=0,(41)ϵ−1⇒∂qi(0)∂xi+∂qi(1)∂yi=0,(42)ϵ0⇒∂qi(1)∂xi+∂qi(2)∂yi+ρϵcϵṪϵ−Q=0and(43)ϵr⇒∂qi(r+1)∂xi+∂qi(r+2)∂yi=0,r∈N.Analysing Eqs. (40) and (41), and considering the first order of Eq. (38), which is(44)qi(1)=−kij(y)(∂T(0)∂xj+∂T(1)∂yj),it is possible to obtain(45)T(1)(x,y,t)=−Υi(y,t)∂T(0)∂xi+T¯(1)(x,t).T¯(1)(x,t)is an integration constant in Y domain andΥiare the components of the thermal characteristic displacement tensor. In this sense, replacing Eq. (45) in (44) results in(46)qi(1)=q^ik∂T(0)∂xk,whereT(0)is independent of the microscale, corresponding to the macroscale temperature of the homogenised material.q^ikare Y-periodic functions given by(47)q^ik=−kij(y)(Ijk−∂Υk∂yj),whereIjk=δjkis the Kronecker delta.In order to compute the thermal characteristic displacement tensorΥ, the following auxiliary variational problemΥk∈V˜ymust be solved:(48)∫Ykij∂Υkyj∂vyidY=∫Ykik∂vyidY,∀v∈V˜Y,whereV˜Yis a set of Y-periodic continuous and sufficiently regular functions with average value of zero in Y.Applying the operator of Eq. (26) in Eq. (42), it is possible to demonstrate that the macroscale temperature field corresponds to the solution of the variational problemT(0)∈VΩ0given by(49)∫Ωkijh∂T(0)xj∂vxidΩ+∫ΩρhchṪ(0)vdΩ=∫ΩQvdΩ+∫ΓNq¯vdΓwhereVΩ0is a set of continuous, sufficiently regular functions and zero-valued inΓD[18], defined as(50)T(0)=T¯inΓDand(51)Ξini=−q¯inΓN.Ξiare the homogenised heat fluxes from the macroscale. These fluxes are obtained by replacing Eq. (47) in (46) and applying the operator of Eq. (26), resulting(52)Ξi=〈qi(1)〉Y=−kijh∂T(0)∂xjinΩ,where(53)kijh=1|Y|∫Y−kij(y)(Ijk−∂Υk∂yj)dY.ρhis the homogenised density andchis the homogenised specific heat, respectively defined as(54)ρh=1|Y|∫YρϵdYand(55)ch=1|Y|∫YcϵdY.The existence of micro- and macroscale is also considered in the homogenisation of the transient thermal problem. Thus, the periodic oscillations of the temperature field should overlap the macroscopic one, where the heterogeneous material is approximated by a homogeneous medium. Additionally, the results from the macroscale can be used to estimate the microstructural conduction heat fluxes. This process is called localisation and can be defined by replacing Eq. (47) in (46), resulting(56)qi(1)=−kij(y)(Ijk−∂Υk∂yi)∂T(0)∂xk.The previous equation allows to estimate the microstructural conduction heat flux for every point in the macroscale x. The homogenised conduction heat fluxes in the macroscale correspond to the average values of the microscale.The microscale problem can be solved in two main steps [13]. The first is finding the solutions of the variational Eqs. (24), (25) and (48) in order to obtain the correctorsχ,Ψandϒrepresenting the characteristic displacement field tensors for mechanical, thermomechanical and thermal problems, respectively. The finite element approximations for the referred equations are given by(57)∫YBTDBdYχ=∫YBTDdY,(58)∫YBTDBdYΨ=∫YBTβdYand(59)∫YM˜TkM˜dYϒ=∫YM˜TkdY,where the superscript e stands for element quantities of the RUC domain [15].BandMare the derivative matrices of the interpolation functions of displacement and temperature fields, respectively.The second step is the computation of Eqs. (22), (23), (53), (54) and (55) in order to obtain the homogenised propertiesDh,βh,kh,ρhandch, respectively. The finite element approximations for the referred equations are given by(60)Dh=∑i=1nelmVieVtotDie(I−Bieχie),(61)βh=∑i=1nelmVieVtot(βie−DieBieΨie),(62)kh=∑i=1nelmVieVtotkie(I−M˜ieϒie),(63)ρh=∑i=1nelmVieVtotρieand(64)ch=∑i=1nelmVieVtotcie,wherenelmis the number of elements in the RUC,Veis the element volume andVtotis the total volume of the RUC [25].The AEH methodology allows to explicitly define the stress, strain and conduction heat flux equations for the microscale using the results from the macroscale. The finite element approximations of Eqs. (28), (27) and (56) are(65)ϵ(1)=(I−Beχ)BEu(0)+BeΨ(T(0)−T0),(66)σ(1)=De(I−Beχ)BEu(0)+(DeBeΨ−βe)(T(0)−T0)and(67)q(1)=−ke(I−M˜eϒe)M˜ET(0),where the superscriptEdenotes the macrostructural quantities, T0 represents the reference temperature andT(0)is the temperature of the homogenised material in the global model [15].u(0)andT(0)are the macrostructural displacements and temperature vectors, respectively.In order to solve the microscale problem, periodicity boundary conditions must be imposed on the outer surface boundaries of the RUC. For a square cell iny1∈[0,y10]andy2∈[0,y20], these conditions can be defined as(68)χijk(0,y2)=χijk(y10,y2)andχijk(y1,0)=χijk(y1,y20).In order to prevent rigid body motion, the displacements and rotations of at least one arbitrary point must be fixed [27].The mechanical, thermomechanical and transient thermal microscale models were implemented using two user-element subroutines UEL in ABAQUS [20]. The subroutines are responsible for computing the homogenisation correctors and consequent properties homogenisation over the RUC domain. For instance, the Thermo Mechanical Model is an Abaqus user-element [20] based on a linear quadrilateral finite element with four nodes and full integration. In order to solve the equations of the microscale thermomechanical problem (Eqs. (57) and (58)), Abaqus needs the referred element. Within the element, a stiffness matrix is computed as well multiple load vectors.11Each load vector is obtained from the right side of Eqs. (57) and (58), where each column represents a load vector integrating the material property components along each respective direction.Thus, the software is able to solve the finite element problems and the resultant displacement fields are the AEH correctors, that are used in the computation of the homogenised properties. In Appendix A,, a code is provided in order to facilitate and illustrate the referred process. The Transient Multiscale Model is identical to the mechanical problem.The macroscale model consists in four subroutines: (i) USDFLD, to update material density, (ii) UEXPAN, to define incremental thermal strains, (iii) UMAT, to define material mechanical behaviour and (iv) UMATHT, to define material thermal behaviour. Fig. 1summarises the whole process, representing the fluxes of information between the subroutines.If the RUC and the microstructural properties are temperature dependent, and the macroscale suffers an inhomogeneous cooling process, each point of the macroscale needs a different equivalent homogeneous material model. Ideally, the External Manager (see Fig. 1) would call the Micro Transient Thermal Model and the Micro Thermo Mechanic Model for every integration point of the macroscale on every time increment. However, this approach would lead to huge computational costs. In this particular case, the problem can be simplified by the creation of a database, where the characteristic displacements and the equivalent homogeneous models are stored for localisation and macroscopic use, respectively. Thus, the macroscale analysis checks a database and interpolates an approximated material model. This approximation reduces the computational costs and allows the use of a refined discretisations in the macroscale. Otherwise, the Micro Transient Thermal Model and the Micro Thermo Mechanic Model would have to be called for every element of the macroscale on every time increment. The implementation of this reduced model is achieved in two main steps. The first step is the construction of the database, where several homogenized properties are computed for a given temperature. Within the microscale computations of the homogenised properties, a representative microstructure for a referred temperature, as well as the properties of its constituents, is considered. After their computation, they are stored in the database. This procedure is repeated for several temperatures. It should be noted that this step can be performed using parallel processes and that this multiscale model is limited to a given microstructural evolution and a given quenching speed, being the link between scales made by temperature. In fact, the application of the HEA method considering macroscale transient heat conduction results, for a fixed microstructure, in a steady-state uncoupled microscale behaviour. In this analysis, microstructure is temperature dependent, so transient macroscale evolution controls the microstructure morphology at the RUC level, which reflects the associated equilibrium (for each timestep) quasistatic microstructural behaviour.The second step is solving the macrostructural problem. The properties used in the macroscale are extracted from the database, using an average between initial and final temperatures of macroscale integration points on every time increment. If the referred temperature does not exist in the database, interpolated homogenised properties between the two closest temperatures are used instead. Finally, it should be noted that the properties extraction corresponds to a trial and error solution, where the two unknowns are both the final temperature and the thermal properties. Thus, the link between scales is archived using temperature instead of time. However, the time increment of the macroscale should be small in order to avoid large steps and skipping of homogenised properties, ensuring a smooth variation.In short, the External Manager coordinates the creation of the database and controls the fluxes of information between the six Abaqus subroutines in the presented implementation (see Fig. 1).The scope of this section is the AEH validation. In order to accomplish this, the results of two different approaches are presented and compared.A heterogeneous material, formed by materials A and B, is considered. In this material, the volume fraction of material B (represented with white-grey colour in Fig. 2(c)) is 25%. Table 1lists the properties of its constituents, where E is the Young׳s Modulus and ν is the Poison׳s ratio. Additionally, the spatial distribution of its constituents is represented in Fig. 2(c) and consists in the spatial repetition of the RUC (Fig. 2(b)).In the microscale, each constituent of the heterogeneous material is considered as isotropic and analysed here under plane stress conditions. The thermomechanical behaviour is also assumed to be isotropic.A simulation of a heating process is considered and analysed with two different approaches: the AEH and a direct approach, where each constituent of the heterogeneous material is spatially modelled within the discretisation, as represented in Fig. 2(c). This last approach corresponds to a typical finite element problem. Thus, both implementations consider an uncoupled problem with implicit time integration in a two-dimensional problem. Boundary conditions of symmetry were applied macroscopically and a linear temperature increasing in the right and upper surfaces of the geometry was considered. The initial and the final temperatures are 0°C and 500°C, respectively, with a heating rate of 0.125°C/s.The scope of this section is to compare the main results of the two different approaches. They are not fully comparable, since AEH considers that ϵ (scale ratio) is very small, much lower than the detailed direct approach. However, even with this difference, this comparison proves to be useful in order to understand the numerical stability and clearly provides results that state the validity of the multiscale modelling. Thus, Figs. 3 and 4present some results for both approaches at different time instants. The general behaviour is identical, but a more careful analysis reveals some differences, as it can be seen in the temporal evolution represented at Fig. 5. The reference location for each of the evolution curves is provided within the figure. An adaptive time increment was used, where the thermal increment could not exceed 15°C. The resultant number of time increments was 34, but its refinement in both simulations resulted in relative errors always inferior to 0.5%, being therefore neglected.In short, the transient multiscale model appears to give reasonable results when compared with the direct model. Moreover, the computational costs are significantly lower, presenting a computational time reduction of 89%, if the localisation process is carried out in all macroscale elements. This major difference is related to the insufficient CPU memory to solve a FEM problem with 923,521 nodes with three degrees of freedom per node (displacements and temperature), resulting in large computational times. This becomes increasingly prohibitive as the scale ratio decreases, requiring increasing model detail for the direct approach.Consider a dual phase steel that suffers a heat treatment process. The process is composed by a heating stage, resulting in a perfect austenisation of the material, and a quenching stage. During the quenching stage, the steel microstructure undergoes severe changes. Its evolution is a continuous process that is discretised into a finite number of frames. Some of the used frames are represented in Fig. 6and the microstructure evolution was obtained using a phase field model22The phase field model was used to obtain several phase distributions for different temperatures.described in [28]. It was considered that the grey, white and black colours represent the presence of Austenite, Ferrite and Bainite, respectively. The properties of the referred phases are provided in Table 2under a generic linear form of(69)ϑ=ι1+ι2T,∀ϑ∈{E,ν,α,k,ρ,c},where T is the material phase temperature. During a quenching process, phase transformations are inevitable. Therefore, the RUC of the material has to change accordingly, meaning that the RUC changes during simulation. Each of the considered frames was discretised into a different RUC. Consequently, the representative unit cell becomes dependent on the macroscale temperature. The RUC discretisation was carried out using the centroid of each element and comparing it with the closest frame of the microstructural evolution.In the microscale, each steel phase is considered as isotropic for the mechanical (plane stress), thermomechanical and thermal behaviours.The scope of this section is the simulation of the quenching of a gear (cogwheel). The plasticity phenomena are neglected, since it is out of this work׳s scope and significantly increases the complexity and computational costs. The presented implementation considers an uncoupled problem with implicit time integration in a two-dimensional problem. In order to solve the macroscale problem, boundary conditions were applied and a linear temperature decreasing on the outer surface of the gear was considered. The initial and the final temperatures are 1125°C and 25°C, respectively, with a quenching rate of 0.24°Cs−1 and 60 increments of time. Fig. 7represents the referred problem.

@&#CONCLUSIONS@&#
In the current work, a transient multiscale model which takes into account the phase transformations of steel is presented and the macrostructural response can be predicted without losing the proper characterisation of the steel microstructure or requiring a large number of degrees of freedom. This fact results from the AEH capabilities to model the mechanical, thermomechanic and thermal behaviours of periodic materials. The present implementation is carried out using a commercial computer-aided engineering software, ABAQUS, through specific subroutines. Furthermore, an External Manager was developed to control the process.The transient multiscale model can simulate complex processes, such as a quenching. Moreover, this work shows that phase transformations can also be modelled and assumes a great importance to properly model heat treatments. In fact, it has a relevant impact on the residual stress fields of the steel part when allied to an inhomogeneous cooling process.