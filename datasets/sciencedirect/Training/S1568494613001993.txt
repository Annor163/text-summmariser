@&#MAIN-TITLE@&#
Improving the design of sequences for DNA computing: A multiobjective evolutionary approach

@&#HIGHLIGHTS@&#
We propose a multiobjective evolutionary algorithm for DNA sequence design.The algorithm uses a matrix-based chromosome as encoding strategy.The algorithm uses specific recombination operators.We show that our approach may improve the performance for this problem compared to previous methods.

@&#KEYPHRASES@&#
DNA computing,DNA sequence design,Multiobjective optimization,NSGA-II,Genetic algorithms,

@&#ABSTRACT@&#
Designing oligonucleotide strands that selectively hybridize to reduce undesired reactions is a critical step for successful DNA computing. To accomplish this, DNA molecules must be restricted to a wide window of thermodynamical and logical conditions, which in turn facilitate and control the algorithmic processes implemented by chemical reactions. In this paper, we propose a multiobjective evolutionary algorithm for DNA sequence design that, unlike preceding evolutionary approaches, uses a matrix-based chromosome as encoding strategy. Computational results show that a matrix-based GA along with its specific genetic operators may improve the performance for DNA sequence optimization compared to previous methods.

@&#INTRODUCTION@&#
Molecular computers have been a dream, and a goal, of nanotechnology from its inception. The possibility was introduced by Feynman in his seminal lecture [1], and numerous schemes have been proposed ever since. The idea became reality in 1994, when Adleman [2] first demonstrated that DNA could be used to create a molecular computer. DNA-based computations rely on short single-stranded DNA molecules referred to as oligonucleotides. The computational process usually allows oligonucleotide strands to hybridize in order to form longer DNA molecules. For this, the oligonucleotide strands must selectively hybridize in a manner that is compatible with the goals of the computation, and unwanted or non-selective hybridizations do not occur. Otherwise, undesired reactions might introduce errors, thus damaging the correctness or at least the efficiency of the experiment [3].This problem, called “DNA sequence design problem”, has attracted considerable attention over the last decade because of its exponential nature [4], leading to the development of heuristic algorithms to approximate its optimal solution [5–8]. Since an appropriate encoding of a problem requires the simultaneous - and often conflicting - satisfaction of several combinatorial and thermodynamical constraints, DNA sequence design has been tipically formulated as a multiobjective optimization task, but in order to simplify its solution, early approaches tried to combine all of the objectives into a single one, such as the well-known weighted linear sum of the objectives [5,7,9,10].Evolutionary algorithms seem particularly suitable for non-trivial multiobjective problems as they can identify multiple members of the Pareto optimal front in a single run of the algorithm [11]. Although there has already been some work for DNA sequence optimization, previous approaches have only considered the traditional linear chromosome to represent the solution space [5,6]. Representation of candidate solutions is one of the most critical parts of designing a good evolutionary algorithm [12]. Michalewicz suggested that a natural representation would seem useful in solving many problems [13], and experimental results have endorsed the idea that it is best to operate on the encoding scheme which in some way resembles the underlying problem [14,15].In this paper, a matrix-based multiobjective evolutionary algorithm is proposed as a basis for the required solution. Our approach consists in treating DNA sequence design as a two dimensional spatial problem, in which candidate solutions are encoded in an m×n-matrix with each row representing a single-stranded DNA of a fixed length n. Five different crossover operators for matrix representation were studied to test the performance of the algorithm. For comparative reasons, designed oligonucleotides satisfy the following constraints: H-measure, similarity, hairpin formation, continuity, melting temperature and GC content. We show that the proposed approach may improve the performance for DNA sequence optimization giving better results than previous methods.The rest of the paper is organized as follows. In Section 2, we introduce the DNA sequence design problem as well as the objective functions and constraints investigated in this work. Section 3 briefly reviews previous approaches in DNA sequence design. Section 4 describes the multiobjective evolutionary algorithm. In Section 5, the generated sequences are presented and compared with those of previous approaches. Finally, in Section 6 we discuss our results and give some directions for future work.The objective of the DNA sequence design problem consists in finding a set of n DNA sequences, each of length l, that satisfies a number of combinatorial and thermodynamical constraints. Combinatorial constraints basically try to map code theory to the requirements imposed by molecular reactions on DNA sequences in order to guarantee their uniqueness [16]. Some examples include the Hamming distance, reverse Hamming distance, reverse complement Hamming distance, H-measure, and similarity function. On the other hand, thermodynamical constraints aim to keep the stability of DNA oligonucleotides in solution, such as melting temperature, GC-content, continuity, and hairpin formation [3].We next define the specific constraints studied in this work. For a more detailed explanation, the reader is referred to the original formulation, as described in [6].Let Λ={A, C, G, T, -} be an alphabet consisting of each single nucleotide, where the symbol ‘-’ denotes a gap. Define an alphabet Λnb={A, C, G, T} consisting of only single nucleotides without gap. Moreover, letΛnb*be the set of all DNA sequences. Let a, b∈Λ andx,y∈Λnb*. The length of a DNA sequence x is denoted by |x|. Let xibe the ith nucleotide from 5′-end of sequence x, where 1≤i≤|x|. A set of n sequences with the same length l is denoted by Σ, where the ith member of Σ is denoted as Σi. The Watson–Crick complement of nucleotide a is denoted bya¯, and a base pair can be defined as follows:(1)bp(a,b)=1a=b¯,0otherwise.Additional basic definitions include(2)eq(a,b)=1a=b,0otherwise.(3)T(i,j)=ii>j,0otherwise.For a given sequence x∈Λ*, the number of non-blank nucleotides is defined as(4)lengthnb(x)=∑i=1|x|nb(xi),where(5)nb(a)=1a∈Λnb,0otherwise.A shift of a sequence x by i bases is denoted as follows:(6)shift(x,i)=(−)ix1⋯xl−ii≥0,xi+1⋯xl(−)ii<0.The similarity measure computes the similitude in the same direction of two given sequences to keep each sequence as unique as possible including position shift. It can be calculated as follows:(7)fsimilarity(Σ)=∑i=1n∑j=1nsimilarity(Σi,Σj),where Σiand Σjare parallel to each other. Similarity(x, y) is composed of two terms. One term is for the overall discrete similarity (sdis) and the other is the penalty term for the continuous common subsequence (scon):(8)Similarity(x,y)=maxg,i[sdis(x,shift(y(−)gy,i))+scon(x,shift(y(−)gy,i))],with(9)0≤g≤l−3,|i|≤l−1,(10)sdis(x,y)=T∑i=1leq(xi,yi)Sdis×lengthnb(y),(11)scon(x,y)=∑i=1lT(ceq(x,y,i),Scon),and(12)ceq(x,y,i)=cif∃c,s.t.eq(xi,yi)=0,eq(xi+j,yi+j)=1for1≤j≤candeq(xi+c+1,yi+c+1)=0,0otherwise.Sdisis a real value between 0 and 1, Sconis an integer between 1 and l, and ceq(x, y, i) stands for the length of the continuous common subsequence starting from the ith base of sequence x.The H-measure function calculates the minimum value of hamming distance between a DNA strand and a complementary DNA strand in order to prevent cross-hybridization [4]. The H-measure can be calculated as follows:(13)fH−measure(Σ)=∑i=1n∑j=1nH−measure(Σi,Σj),where Σiand Σjare anti-parallel to each other. H-measure(x, y) is also composed of two terms. One term is for the overall complementarity (hdis) and the other is the penalty term for the continuous complementary region (hcon):(14)H-measure(x,y)=maxg,i[hdis(x,shift(y(−)gy,i))+hcon(x,shift(y(−)gy,i))],with(15)0≤g≤l−3,|i|≤l−1,(16)hdis(x,y)=T∑i=1lbp(xi,yi),Hdis×lengthnb(y),(17)hcon(x,y)=∑i=1lT(cbp(x,y,i),Hcon),and(18)cbp(x,y,i)=cif∃c,s.t.bp(xi,yi)=0,bp(xi+j,yi+j)=1for1≤j≤candbp(xi+c+1,yi+c+1)=0,0otherwise.Hdisis a real value between 0 and 1, Hconis an integer between 1 and l, and cbp(x, y, i) stands for the length of continuous base-pairing starting from ith base of sequence x.The hairpin measure estimates a penalty for DNA hairpin formation. Suppose that a hairpin has at least Rminbases as a loop and at least Pminbase pairs as a stem. Then, a DNA hairpin with r-base loop and p-base pairs stem has a penalty function given by:(19)fhairpin(Σ)=∑i=1nhairpin(Σi),with(20)hairpin(x)=∑p=Pmin(l−Rmin)/2∑r=Rminl−2p∑i=1l−2p−rT∑j=1pl(p,r,i)bp(xp+i+j,xp+i+r+j),pl(p,r,i)/2,where pl(p, r, i)=min(p+i, l−r−i−p) denotes the maximum number of possible base-pairs when a hairpin is formed at center p+i+r/2.The continuity measure prohibits the consecutive runs of the same base over a given threshold, as the continuos occurence of a nucleotide can result in unexpected structures. The continuity function is defined as follows:(21)fcontinuity(Σ)=∑i=1ncontinuity(Σi),where(22)continuity(x)=∑i=1l−t+1∑a∈Λ*(T(ca(x,i),t))2,and(23)ca(x,i)=0if∃o,s.t.xi≠a,xi+j=afori≤j≤oandxi+o+1≠a,0otherwise.The GC content of a DNA strand is defined as the number of positions in which the string has symbols G and C, and it is usally given as a percentage ratio. DNA sequences with similar GC content have similar thermodynamical characteristics.(24)fGCcontent(Σ)=yG+zCwA+xT+yG+zC.wherewA,xT,yGand zC are the number of A's, T's, G's, and C's in a sequence Σ, respectively.The melting temperature (Tm) allows the hybridization of multiple DNA strands to proceed simultaneously. It is defined as the temperature at which half of the double-stranded DNA molecules break into single strands, and depends on the length of the DNA molecule as well as on its specific nucleotide sequence. The melting temperature is usually calculated with the GC ratio method and the SantaLucia's nearest-neighbor (NN) model [17]:(25)Tm(x)=ΔH°ΔS°+Rln(CT/4)−273.15ifNNmethod,81.5+16.6×log10(salt(1.0+0.7×salt)+41×GCcontent(x)−500|x|,otherwise.The termsaltstands for salt concentration, R is the gas constant, andCTis total sequence concentration. The enthalpy (ΔH°) and entropy (ΔS°) of a double-stranded molecule are calculated with the corresponding Watson-Crick NN parameters [17].The problem of DNA sequence design can be modelled from the perspective of multiobjective optimization as follows:(26)Minimizefi(x),i∈{similarity,H−measure,hairpin,continuity}subjecttoGCcontent(x)=δ%andTm(x)=Ll,Ul°C,where Lland Ulare the lower and upper bounds of the required Tmrange, respectively.To date, several strategies have been proposed to satisfy some or all of the constraints listed above. Early approaches included deterministic, exhaustive search methods for DNA sequence design. For example, [18] presented a strategy for designing short oligonucleotides suitable for DNA computing on surfaces using a template map strategy. In total, a set of 108 8-mer sequences were designed, each of which contains at least a 4-base mismatch with the complements to all the other members of the set as well as a fixed GC content of 50% in order to make the thermodynamic stability of DNA duplexes similar. [19] introduced another template method that systematically generates a set of sequences of length l such that any of its member has approximately l/3 mismatches with other sequences, their complements, and the overlaps of their concatenations.Hartemink et al. [20] implemented an exhaustive search method that satisfies a pre-specified set of constraints, including hybridization discrimination, 5′-end and 3′-end oligonucleotide stability, hairpin, and oligonucleotide dimer formation. The computational designs were implemented in laboratory, showing a significative performance over previous attempts at manual design. [21] developed a software tool for the construction of DNA sequences meeting logical and physical parameters such as uniqueness, melting temperature and GC content as required by the user. The generation algorithm uses a directed graph, whose nodes correspond to unique strands of minimal length, and the successors to strands that can appear as overlapping successors in a longer sequence.On the other hand, [22] described an algorithm based on dynamic programming that calculates the total number of sequences of length l whose free energy value falls in a given range taking into account combinatorial constraints like the Hamming distance and reverse complement Hamming distance. Dynamic programming was also applied by [23] to calculate the partition function for the ensemble of DNA structures considering the thermodynamic stability of secondary structures such as hairpins, internal loops and bulge loops. The generated library was experimentally tested using molecular biology tools. [24] proposed a similar dynamic programming algorithm for calculating the optimal secondary structure of concatenated DNA sequences.Exhaustive search methods may be adequate for designing a set of small-length sequences. However, as the solution space increases, the search becomes impractical, making inevitable the development of approximated methods, such as probabilistic algorithms. For example, [25] described a stochastic local search algorithm that satisfies a number of constraints like the Hamming distance, GC content, and reverse complement Hamming distance. The algorithm takes as input the desired sequence length and set size, along with the corresponding constraints that the set should fulfill, and attempts to find a solution that meets the requirements. [26] developed randomized algorithms to design DNA sequences that satisfy a given set of constraints while minimizing the length of the strings. The authors considered multiple thermodynamical and combinatorial constraints like Hamming distance, reverse complement Hamming distance, shifting Hamming distance, self-complementarity constraint, the continuity constraint, GC content, and the free energy constraint.Nature-inspired heuristics have also contributed to the field. For instance, [27] reported a simulated annealing algorithm which minimizes an evaluation function calculated as the linear sum of seven evaluation terms. The algorithm not only searches for good sequences but also estimates the influence ratio of each term to the evaluation function in order to reduce it. [28] introduced a particle swarm optimization algorithm to solve the multiobjective approach by converting it into a single-objective problem with the weighted sum method. [29] recently reported another particle swarm optimization approach for the multiobjective problem using digital encoding DNA sequences. On the other hand, [8] proposed an ant colony system which consists of four nodes representing four DNA bases using the nearest-neighbor thermodynamic parameters as the distance between nodes. [10] combined an artificial inmune algorithm with simulated annealing to solve the multiobjective optimization approach getting better performance than previously known results.Among nature-inspired heuristics, evolutionary algorithms have been one of the most widely used. These methods have in common the classical linear representation of candidate solutions. For example, [5] implemented a genetic algorithm to generate a set of unique DNA sequences using the Hamming distance as a measure of uniqueness. [30] also presented an evolutionary algorithm that optimizes the DNA encoding sequences for the 7-node instance of the Hamiltonian path problem used by Adleman. [31] encountered some difficulties for GAs to set the fitness evaluation function when the number of design constraints increases. Instead, they proposed a random generate and test algorithm, allowing users to set a threshold value for each constraint. [6] described the first multiobjective approach to solve the problem of DNA sequence design by identifying multiple Pareto optimal candidate solutions. For this, the authors developed a tool based on the multiobjective evolutionary algorithm NSGA-II that generates sets of DNA sequences evaluated using four objective functions, namely, H-measure, similarity, continuity, and hairpin formation. The modified NSGA-II adopted a representation with two hierarchical levels (an individual and sequence level) along with a two-stage crossover operator: at the first stage, member sequences between two individuals are exchanged (individual level operation) and, at latter stage (sequence level operation), a multipoint crossover is implemented. Another multiobjective evolutionary approach was proposed by [9], who calculated the fitness function as the weighted sum of the required objectives. The main idea of this paper was to improve the speed of convergence of the genetic algorithm by saving the best populations.All techniques cited above have used computational algorithms for DNA sequence design. Another alternative is to manufacture them directly on the test tube by using in vitro evolution, as proposed by [32], who generated huge libraries of non-crosshybridizing oligonucleotides in a test tube. To this end, a fitness function that corresponds to non-crosshybridization was implemented in laboratory through a modified version of a PCR-based protocol that selects non-crosshybridizing oligonucleotides. Experiments confirmed that the PCR-based protocol can selectively amplify mismatched oligonucleotides over those that were more closely matched.The Non-dominated Sorting Genetic Algorithm II (NSGA-II) developed by [33] is used in this study. NSGA-II is an efficient multiobjective evolutionary algorithm that implements a non-dominated sorting mechanism to classify all solutions in different fronts. If the solutions belong to the same non-dominated front, the algorithm applies a crowding distance operator to preserve their diversity by favouring an even distribution of points along the Pareto front.Although NSGA-II has been previously used for DNA sequence design [6], the two-dimesional nature of this problem suggests that both chromosome representation and crossover operator may be modified from the original approach to improve the optimization results. This paper uses a matrix-based chromosome to encode the set of DNA sequences, where each row represents a sequence of fixed length l. For this, each position in the array is occupied by a symbol from the alphabet {A, T, C, G}, with the character symbols corresponding to the nucleotides adenine, thymine, cytosine and guanine, respectively.The pseudocode for the proposed algorithm is the standard NSGA-II, which is briefly described in Algorithm 4.1. The algorithm receives as parameters the cardinality of the set of DNA sequences (n), the corresponding sequence length (l), the size of the population (Psize), and the stop condition for algorithm execution, specified in number of generations (tmax).Algorithm 4.1NSGA-II for DNA sequence designInput: set size n, sequence length l, population size Psize, crossover rate pc, mutation rate pm, and maximum number of generations tmax.Output: a set F1 of non-dominated solutions.1:t←0.2:Generate at random a population of Psizeof n×l-individuals.3:repeat4:Evaluate and sort P based on non-domination.5:Assign to each individual a rank equal to its non-domination level.6:Apply constrained-tournament selection.7:Apply matrix crossover to generate offspring population Q.8:Apply mutation to individuals in Q.9:Create extended population R=P∪Q.10:Sort R based on non-domination.11:Generate new population of size |P| with the individuals from thesorting frontsF1⋯Fnstarting from the best (F1).12:To choose exactly |P| individuals, sort the overflowing front Fousingthe crowding-distance operator in descending order.13:t←t+1.14:untilt≥tmax15:returnF1Generation of initial population. A parent population P is randomly initialized by filling each position of an individual with 0 as “A”, 1 as “T”, 2 as “G”, or 3 as “C” with equal probability. Once the initial population is constructed, the aforementioned objective functions are called and initial fitness values are assigned to the population.Parent selection. At each generation, the evaluated population is ranked using the non-dominance criterion according to their objectives values. The feasibility of non-dominated solutions is ensured by using constrained-tournament selection [34]. In this method, when comparing pairwise individuals, (1) any feasible solution is preferred to any infeasible one; (2) between two infeasible solutions, the less penalized one is selected; and (3) between two feasible solutions, the dominating one is preferable. If the solutions coincide in the same non-dominated front, the one with larger crowding distance is chosen.Crossover operators. Recombination naturally follows the representation scheme, thus transmitting the same two-dimensional arrangement to offspring. This variation operator is performed with probability pcto produce a child population Q. If no recombination occurs, the parents are directly copied to the new population Q. In total, five recombination operators were considered in this work:1Horizontal crossover. In this mechanism offspring are generated by copying alternate row vectors from parents to the offspring (Fig. 1A). A variant of this operator consists in randomly selecting each sequence from one of the parents [14] (horizontal-v2). For this, a boolean value is randomly generated for each row vector. If the returned value is equal to ‘true’, the corresponding sequence from Parent 1 is copied to Offspring 1, while Offspring 2 inherits that one from Parent 2. For returned values equal to ‘false’, the inheritors are interchanged.Vertical crossover. Analogous to one-point crossover in linear structures, vertical crossover randomly defines a cut point that splits the sequences of the parents into two parts. Offspring are then created by selecting one substring from each parent [14]. The operation of vertical crossover is illustrated in Fig. 1B.Frame crossover. Originally proposed by [15] for image processing problems, this operator selects a rectangular section of the matrix structure at random. Offspring are then built by using information from inside the rectangle of one parent and outside the rectangle of the other parent (Fig. 2A).Mask crossover. The Mask operator uses one of the parents as a mask matrix to determine which nucleotides will be inherited by the offspring. First, any locus sharing a common allele in both parents is copied to the offspring. Then, the rest of the genes are randomly selected from one of the parents (Fig. 2B).Horizontal–vertical crossover. This recombination mechanism is a modification of the horizontal and vertical crossover. Horizontal recombination is first performed. Column vectors are then randomly chosen from one of the parents and copied to the offspring.Mutation. The mutation operator can remain unchanged and be applied after recombination with a probability pm. If this happens, a point mutation is simply replaced by a character from the alphabet {A, T, C, G}, as encoded before.Survivor selection. The child generation is mixed with the parents from previous generation. Each individual in the extended population (R) is evaluated and sorted based on non-domination. Constrained-tournament selection is performed on R to generate an elitist new parent population P. The whole process is then repeated until a maximum number of generations is reached.

@&#CONCLUSIONS@&#
This study presents a matrix-based representation within the NSGA-II algorithm for the problem of sequence design in DNA computing. Special crossover operators were studied for the proposed representation. The designed sequences were compared to those generated by previous optimization models including MOEA, PSO, ACO, and hybrid approaches. Experimental results suggest that our algorithm can provide sequences with better combinatorial and thermodynamical properties, such as similarity, H-measure, hairpin, and continuity. In theory, a lower similarity and H-measure values would account for a higher probability of intended hybridizations, while a lower continuity and hairpin values would reduce the number of unwanted secondary structures. Indeed, our sequences show much lower H-measure and similarity values for both benchmark tests than the aforementioned methods. Moreover, hairpin formation is hypothetically prevented and the largest segment of repeated bases in a sequence is at most of size two, as a continuity score of zero implies. All these outcomes were accompanied by competitive melting temperature ranges.From the evolutionary point of view, our results agree with the assumption that a more natural representation of the set of DNA sequences allows a more refined search strategy towards global solutions, supporting the idea that it is better to operate on the encoding scheme which in some way resembles the underlying problem. However, further studies are needed to qualify the suitability of the matrix-based representation for the problem in question. The application of analytical tools such as the measurement of epistasis [42] and genetic linkage [43] would be of interest towards this end. Another issue that arises from this study is the conceptual equivalence between a linear chromosome with inter-sequence crossover and our approach, or even more interesting, how the efficiency of the proposed algorithm can be improved. These issues, which extend beyond the scope of this paper, will be explored in forthcoming projects.