@&#MAIN-TITLE@&#
Application of improved firefly algorithm for programmed PWM in multilevel inverter with adjustable DC sources

@&#HIGHLIGHTS@&#
Improved firefly algorithm is applied to determine the optimum switching angles for the 11-level cascaded H bridge multilevel inverter with non-equal DC sources.Firefly algorithm takes least estimation time and surpasses all other 11 metaheuristic algorithms.The algorithm and the model are developed using MATLAB and the validity of the simulation is confirmed by an experimental setup using FPGA Spartan 6A DSP.Results are compared with the results obtained using Particle swarm optimization and artificial bee colony algorithm and it is proved that the proposed method offers reduced THD with less computation period.

@&#KEYPHRASES@&#
Programmed PWM,Cascaded multilevel inverter,Firefly algorithm,FPGA,

@&#ABSTRACT@&#
Programmed pulse width modulation is an optimized pulse width modulation which is particularly applicable for high-power applications where the power losses must be kept below firm limits. Based on the offline estimation, it is capable of pre programming the harmonic profile of the output waveform over a range of modulation indices by eliminating some lower order harmonics. In this paper, improved firefly algorithm (FA) is applied to determine the optimum switching angles for the 11- level cascaded H bridge multilevel inverter (MLI) with adjustable DC sources in order to eliminate pre specified lower order harmonics and to achieve the desired fundamental voltage. Though number of optimization algorithms is available for the estimation of switching angles, Firefly algorithm takes least computation time and surpasses all other 11 metaheuristic Algorithms. The algorithm and the model are developed using MATLAB and the validity of the simulation is confirmed by an experimental setup using FPGA Spartan 6A DSP. Results are compared with the results obtained using particle swarm optimization (PSO) and artificial bee colony algorithm (ABCA) and it is proved that the proposed method offers reduced total harmonic distortion (THD) with less computation period.

@&#INTRODUCTION@&#
The advantages of multilevel inverters like lower common mode voltage, lower voltage stress on power semiconductor switches, reduced THD and more closer to sine wave output have led them to be put in service in medium and high power applications [1,2]. With multilevel inverters wherein some of the dominant lower order harmonics can be mitigated, the quality of power generated enhances. In recent days MLIs have become the choice for power conversion in the renewable energy sector that use solar or wind power. There are three different configurations of MLI. They are diode clamped [3], flying capacitor [4], cascaded H bridge (CHB) MLI [5–7]. The output voltage is of a stepped waveform with step sizes decided by the available DC voltage sources contributing for each step and with step duration dictated by Programmed PWM with the objective of eliminating the specific lower order harmonics.Modern power systems driven by high power converters are becoming inevitable in view of the ever increasing demand in electric power. By limiting the switching losses within tolerable limits in such power converters, the total power loss can be reduced leading to more power efficiency. In this way, a reduced switching frequency less than few hundreds of hertz is applied to the power converters producing output waveforms with high distortion. Therefore, it is necessary to select a suitable modulation method in order to reduce the harmonic content of the output. In [7,8] the authors have discussed about many techniques used for switching the MLI with low switching frequency scheme. The step modulation with selective harmonic elimination (SHE) is one among the various fundamental frequency programmed PWM strategies.To ensure the desired spectral quality and output amplitude, the angles at which each voltage level is applied need to be computed. In order to compute these angles, a set of nonlinear mathematical equations can be derived using the Fourier analysis of a general switched converter waveform. The derived functions, which are transcendental and nonlinear in nature, can be solved for a range of modulation indices using a variety of methods The predominant method of solving them is by means of iterative techniques including the Newton–Raphson [NR] technique [9–12]. The function to be solved should necessarily be differentiable and for that, proper initial guess is required. The NR method gives the solution and it is the next nearest as dictated by the initial guess.The Walsh function that uses a set of algebraic matrix equations is used in [13] resulting in the creation of a waveform which was devoid of the intended lower order harmonics. The idea of multiple switching during each voltage level of the MLI known as sub switching was introduced in [14], where the number of harmonics eliminated is not related to number of levels. Another analytical method is the theory of resultants and it is capable of finding all feasible solutions [15]. Considering the mathematical complexity, the theory of resultants is a difficult procedure especially when handling more number of levels; it is much more complicated when the operating DC voltage sources vary from time to time in real time.Artificial neural network (ANN) based real time estimation of switching angles can be carried out for the elimination of lower order harmonics for a wide variety of modulation indices [16]. But this method demands the knowledge of a vast set of switching angles for the corresponding modulation indices. The recent trend in the estimation of switching angles incorporates the model predictive control which could make the amplitudes of the unwanted harmonics and ensure the required amplitude for the fundamental voltage waveform [17]. Unfortunately, while this method is a more time consuming longer procedure; it also suffers with the disadvantage of introducing a finite quantity of DC component and some even harmonics.The evaluation of switching angles by solving SHE equations has been demonstrated using other heuristic search algorithms. In [18] genetic algorithm is employed for lower order harmonic elimination of MLI. While genetic algorithm offers the globally best solution, it has the limitation of slow speed of convergence. In [19] selective harmonic elimination (SHE) for three phase inverter has been performed using differential evolution. Selected lower-order harmonics of cascaded MLI have been eliminated using PSO with non-equal DC sources [20]. Colonial competitive algorithm and bee algorithm are applied to optimize harmonics in seven-level cascaded MLI [21,22].In this paper, nature inspired Meta heuristic algorithm known as improved Firefly algorithm is used to obtain optimum switching angles for 11-level CHB MLI with adjustable DC sources. Original firefly algorithm depends on its parameters such as absorption, attraction coefficients and random movement factor which leads to probability of ending up with local optima. Hence this method gives better results than original FA.The proposed methodology has been validated using MATLAB based simulation environment. A suitable experimental hardware has also been fabricated using FPGA. For the digital control of power electronic converters, Microcontrollers and DSPs are used where the number of PWM pulses generated is limited. Hence FPGA is a better solution for the implementation of PWM algorithms of high power converters. In [25], variable common mode injection PWM for three-level inverter has been implemented using FPGA. In this proposed work, FPGA is used for the implementation of programmed PWM and the results validate the simulation results obtained.The results reveal that the proposed methodology offers the maximum available fundamental voltage for the available DC voltage levels of the isolated DC sources with the selected lower order harmonics eliminated for whatever be the source voltages and the magnitude of the fundamental voltage.As compared to the diode clamped inverter and the flying capacitor based inverter topologies, the cascaded H bridge topology uses less number of power switches for any number of output voltage levels [6]. Cascaded H bridges are used in voltage and power levels as high as 13.8kV and 30MVA, respectively. Being structurally modular, it offers improved reliability in operation compared to the other two types of higher level inverters. A characteristic advantage of the Cascaded H bridge inverter is that it is capable of integrating a number of isolated equal or non-equal DC voltage sources into a common inverter. Fig. 1shows the general structure of single phase cascaded multilevel inverter. In the basic form of the inverter, S number of H bridge cells required for N number of voltage levels is given by S=(N−1)/2. In the synthesis of the output waveform in a MLI, the objective is to produce a waveform that is closer to the Sinusoidal wave. As such levels in the output of the inverter increases, the harmonic distortion is reduced. In a cascaded MLI that caters for five-levels, the possible number of combinations of the switches is given by 2N−1. This implies that the number of switching combinations will be 16. The number of combinations of switches is a measure of direct degrees of freedom and this measure is more in a cascaded MLI compared to the other configurations of MLIs, leading to operational flexibility.Similarly, in the case of an 11-level inverter, five individual H bridge units are connected in cascade. The individual DC voltage sources powering up the individual H bridges must be isolated. However at the output side, the AC output voltage of individual H bridges will be connected in series, and actually this operational requirement warrants that the individual DC power sources driving the H bridges should be isolated. This feature of the cascaded H bridge inverter is an advantage when it is required to integrate photo voltaic panels, wind energy sources or fuel cells into a common multilevel inverter.The output voltage of an individual H bridge of a MLI is a mapping of the input DC voltage to the switching function. In general this relationship is given by the following equation. VHi=WiVdci. Where VHi is the AC output voltage of the individual ith H bridge, Wi is the mapping between the input and the output. Wi can be either 1 or 0 or −1. The switches Si1 and Si4 are turned on to obtain +1, whereas switches Si2 and Si3 are turned on to obtain −1 while Si1 and Si2 or Si3 and Si4 are turned on to get 0 output voltage. The output phase voltage waveform for 11 level cascaded MLI with five non-equal DC sources (S=5) is shown in Fig. 2.On the other hand, each cell has two switching signals, the output voltage of each cell in terms of binary switching signals Si1 and Si2 is given by(1)VHi=Vdci(Si1−Si2)The output voltage of the MLI is expressed as(2)VaN=∑i=1SVHiFundamental frequency programmed PWM for selective elimination of harmonics produces switch commutations at output fundamental frequency and can be meant to cancel some particular low frequency harmonics. In SHE of multilevel inverter, the output is a staircase wave with the duration of each level optimized to tightly control the harmonic spectrum hence minimizing harmonic filter requirements and eliminating expensive and huge reactive components. The SHE technique keeps the magnitude of the fundamental harmonic to a required value, and sets zero for the amplitude of a limited number of harmonics. Using N switching angles, a maximum of N−1 harmonics can be eliminated. Usually, the lowest odd non-triplen harmonics (5, 7, 11 …) are the target harmonics to be eliminated. This is because, due to the waveform symmetry, even harmonics are absent and triplen harmonics will not appear in the line to line voltage of three phase circuit.An 11-level inverter waveform is shown in Fig. 2. It has five switching angles θ1, θ2, θ3, θ4 and θ5. The five non-equal DC sources are Vdc1 to Vdc5. Due to waveform characteristics of odd and half-wave symmetry, the Fourier series expansion of the generalized stepped voltage waveform for unequal DC sources is given as follows(3)V(ωt)=∑n=1,3,5∞4Vdcnπ∑i=1Sci*cos(nθi)sinnωtThe switching angles θ1−θs must satisfy the following condition(4)0≤θ1≤θ2≤θ3≤θ4…≤θs≤π2Conventionally, the following nonlinear equation group is formed to estimate the switching angles to realize SHE for MLI(5)∑i=15ci*cos(θi)=M*SH5=4Vdc5π∑i=15ci*cos(5θi)=0H7=4Vdc7π∑i=15ci*cos(7θi)=0H11=4Vdc11π∑i=15ci*cos(11θi)=0H13=4Vdc13π∑i=15ci*cos(13θi)=0where ci=Vdci/Vdc, S is the number of DC sources, Vdc is the nominal DC voltage. Vdci is the ith non-equal DC voltage and i varies from 1 to 5.In this equation group, the first equation promises the desired fundamental component. The second to the fifth equations are utilized to make sure the elimination of 5th, 7th, 11th, and 13th harmonics. It is clear that, with five switching angles, four selected harmonics can be eliminated. The relationship between the DC link voltage of the converter and the amplitude of the generated fundamental component is called the modulation index M and can be expressed as(6)M=π*H14SVdcwhere, M is between 0 and 1 to cover different values of H1 which is the required fundamental voltage. The number of harmonics to be eliminated from the output of the inverter is S−1. The harmonics of the order up to 3S−2, when S is odd and up to 3S−1, when S is even can be eliminated from the output waveform. Therefore, using 11-level inverter with five DC sources, four harmonics 5th, 7th, 11th and 13th can be eliminated.Most of the modern optimization algorithms are inspired by nature and such algorithms are collectively known as the metaheuristic algorithms. Out of the 11 popular metaheuristic algorithms used for the purpose of optimization, the Firefly algorithm is the best in terms of speed of execution when realized in a microcontoller. The Firefly algorithm was developed by Yang [23]. Fireflies, also known as lightning bugs, are found in the tropical countries including India. They exhibit a peculiar behaviour and where they are modelled in the mathematical background,they lead to solutions in the optimization domain.The behaviour of the fireflies can be viewed to follow three advantageous rules. The first of the three rules is that the fire flies are of unisex. Their attraction to each other in the pursuit of their movements is sex independent and so there is no question of cross over proceedure as in genetic algorithm. Second rule is that each firefly is attracted towards the nearby and more brighter firefly and this happens as a function of the distance between the individual firefly and the neighbouring brighter one. If the flies find difficult to distinguish flies with better brightness than one another, they all tend to move at random. This apparent random movement may not in fact be a random movement, since actually a reason cannot be given for their apparent random movement. The apparent random movement could be an ordered and governed one based on parameters that could be sensed only by the flies, but not visible to the human eyes like brightness of their light. Finally,the third rule is that when realized as an optimization algorithm, the value of the objective funtion associated to each fly is related to the brightness of the individual firefly.Let XPand Xq, respectively be the positions of two fireflies p and q. Let the distance between these two fireflies is denoted as rpq. It can be written in uni dimensional space as(7)rpq=Xp−XqThe function of distance between two fireflies β, also known as degree of attractiveness and is given by(8)β=β0e−γ(rpq)n,n≥1where γ is absorption coefficient which controls the decrease of light intensity, whose value is between 0 and 10. β0 is initial attractiveness which is chosen as 1, such that the brightest firefly strongly determines the position of other fireflies in its neighbour hood.If it is assumed that the brightness of firefly p is less than that of q, the new position of firefly p is given by the following equation:(9)Xpt+1=Xpt+β(Xp−Xq)+αrand−12where α is known as random movement factor. If α is higher, it makes the movement to look at the solution through the distant search space and the smaller α tends to ease local search. The value of α is chosen between 0 and 1which is maintained constant.The essence of selective harmonic elimination is the estimation of certain number of switching instants, and this paper presents a novel methodolgy using a self adaptive improved firefly algorithm [24] for arriving at the optimal switching instants. The SAIFA is better than the original FA, as the SAIFA overcomes the tendency of the FA especially for converging at the local minima. The inclusion of a new mutation operator in the SAIFA drastically enhances the performance when compared against the original FA.SAIFA consists of fireflies with different brightness, and the firefly, with the best fitness value among all the fireflies is selectedGbestk=[best1k,best2k,⋯,bestNk]θmk=[θm,1k,θm,2k,⋯,θm,Nk]where m=1, …, Nfirefly, N=No. of decision variables(10)θmod,fireflyk=θm,fireflyk+βk(θn,fireflyk−θm,fireflyk)+α|θmax−θmin|(rand1×N(⋅)−0.5);ifFF(θn,fireflyk)<FF(θm,fireflyk)θm,fireflyk;otherwisem=1, …, Nfireflyn=1, …, Nfirefly; FF is the fitness function andθn,fireflykcorresponds to best fitness valueθmax=[θ1max,θ2max,…,θNmax];θmin=[θ1min,θ2min,…,θNmin]In this paper, β of original FA is modified so as to result faster convergence of the algorithm and escaping from local optima and is given as follows.(11)βk=(βmax−βmin)e−γ(rmnk)q+βminThe value of q is taken as 2(12)rmnk=θn,fireflyk−θm,fireflyk=∑i=1N(θn,fireflyk−θm,fireflyk)2Further in this work, the value of α is adaptively tuned in each iteration using the following expression.(13)αk+1=0.5kmax1/kmaxαkIn this work, a powerful mutation strategy was incorporated in basic FA so as to improve the performance as well as to prevent from converging onto any unexpected local minima. In each iteration, for each of the existing solutions, four vectors p1, p2, p3, and p4 are selected randomly from the existing population to cover the algorithm searching domain uniformly, and the mutant individual(θm,mutk)is evaluated as follows:(14)θm,mutk=θp1,fireflyk+rand1(⋅)(1−rand2(⋅))(θp2,fireflyk−θp3,fireflyk)+rand3(⋅)(1−rand4(⋅))(Gbestk−θp4,fireflyk)Then, the mutant vector is mixed withθm,fireflykwhich generatesθm,newkas followsθm,mutk=[θm,1,mutk,θm,2,mutk,…,θm,N,mutk]θm,newk=[θm,1,newk,θm,2,newk,…,θm,N,newk](15)θm,i,newk=θm,i,mutk,if(rand5(⋅)≤rand6(⋅))θmod,i,fireflyk,otherwisewhereθm,i,newkis the switching angle of the ith switch of mth firefly of the kth iteration. The original solution is replaced with new solution based on its fitness value as follows.(16)θm,fireflyk+1=θm,newk,ifFF(θm,newk)≤FF(θm,fireflyk)θm,fireflyk,otherwiseAn appropriate fitness function is formulated so as to maximize the fundamental voltage and to eliminate the lower order harmonics as follows.(17)MinimizeFF=100*V1d−V14V1d4+50V12*V552+V772+V11112+V13132where V1 is the fundamental value and V5 to V13 are the target lower order harmonics to be eliminated. If an error of 1% is sensed in the fundamental waveform, it is quite negligible because this component is represented by the order of 4 in the fitness function. The second expression eliminates harmonics under 2% of fundamental. But if any harmonic goes beyond this bound, the cost function is subjected to a penalty by power of 2. Also, each harmonic proportion is weighted by the inverse of its harmonic order. By this weighting method, minimizing the low-order harmonics obtains more significance.

@&#CONCLUSIONS@&#
