@&#MAIN-TITLE@&#
Inferential sensor-based adaptive principal components analysis of mould bath level for breakout defect detection and evaluation in continuous casting

@&#HIGHLIGHTS@&#
Prediction capacities of PCA algorithm have been improved using an adaptive form-based moving windows technique.Breakout defect has been detected and evaluated using the main process data of continuous casting process.An accurate and precise model is obtained; performance of such model is evaluated using MSE index.

@&#KEYPHRASES@&#
Soft sensor,Continuous casting,Adaptive principal component analysis,Breakout detection and evaluation,

@&#ABSTRACT@&#
This paper is concerned with a method for breakout defect detection and evaluation in a continuous casting process. This method uses adaptive principal component analysis (APCA) as a predictor of inputs–outputs model, which are defined by the mould bath level and casting speed. The main difficulties that cause breakout in continuous casting are, generally, phenomenon related to the non-linear and unsteady state of the metal solidification process. PCA is a modelling method based on linear projection of the principal components; the adaptive version developed in this work uses the sliding window technique for the estimation of the model parameters. This recursive form updates the new model parameters; it gives a reliable and accurate prediction. Simulation results compare PCA, APCA, non-linear system identification using neural network (NN) and support vector regression (SVR) methods showing that the APCA gives the best Mean Squared Error (MSE). Based on the MSE, the proposed approach is analyzed, tested and improved to give an accurate breakout detection and evaluation system.

@&#INTRODUCTION@&#
Soft sensors are virtual instruments based on analytical models. They give an estimation of the process states parameters based on modelling and identification techniques. An inferential model can be obtained using first principles (i.e. mechanistic modelling), or by using grey or black box identification methods. However, in continuous casting the breakouts propagation, which is due to complex effects and high interactions between different variables, makes the process hard to model. It is, then, strongly recommended to use a data driven empirical model. Such model is based on the analysis of interactions between variables, data exploration, and modelling.In continuous casting, the main measured directly affecting the breakout are the casting speed v(t), the mould bath level h(t) and the control input u(t), see Fig. 3.As known by the theoretical aspects and practical standards, procedures and methods are applied in continuous casting to control the interactions between metallurgical process elements. In fact, chemical composition, casting temperature, casting speed and other parameters should directly or indirectly be taken into account to obtain a reliable soft sensor for breakout detection.The objective of this work can be summarized in two tasks:•Firstly, breakout detection,Secondly, the breakout is evaluated according to the importance of the deviation of the model from its normal behaviour: This amount is quantified with MSE. A breakout with a little deviation from the normal MSE value is not as important as a breakout with a large deviation.There are many related works in the field of soft sensor for quality prediction and evaluation applied in different systems and processes, the following are some of them:•The prediction and evaluation of the key factors characterizing the product quality in various processes using soft sensing based multivariate statistical process control, fuzzy means and multivariate identification [1–10].Soft sensing methods including support vector machine, data driven and data mining [11–19].Mechanistic modelling based energy and mass balance [20,23]. This aspect is very complex to model particularly in a dynamic way.Soft sensing based principal component analysis (pca), and partial least squares (PLS), including its adaptive form have been widely considered as a promising approach for quality monitoring and data-based analysis and control from process history data. Its successful applications have been reported in numerous process industries [12,18]. Traditionally, PCA as a part of the MSPC takes an important place in monitoring methods. The PCA technique, characterized by its multivariate component, is strongly recommended to model a multi-input–multi-output system. Moreover, in some works, it was extended for quality prediction-based models [12,18,24].Adaptive principal component analysis (APCA) is a relatively new method which is recommended for an accurate detection and evaluation of the breakout. Different factors such as metallurgical properties of the material, the solidification rate and the thermal operating conditions are then controlled.The development of an accurate system to detect and to evaluate a breakout is a very complex task because the breakout cannot be directly measured by an instrument. The complexity of the breakout phenomena is due to a mixture of non-linear and unknown dynamics and parameters. There are many accomplished works in continuous casting technology field. However, they are limited, or have not dealt with a model correlation of key variables. Generally, the detection of breakout is based on processing of measured temperature profiles using the embedded sensors on the mould copper. This approach is detailed in [21–23], where some theoretical and applied aspects using neural networks are considered. In fact, the majority of published works on breakout prevention and detection systems deals with different methods of modelling using linear, non-linear system identification among others. Measurements of process parameters are done on main factors that influence the breakout, including temperature profiles.Breakout detection and evaluation systems are generally based on the sticking phenomenon which is detected using thermal sensors located in the mould. The cooling–solidification process connected to breakout is considered as a thermal reactor where all process parameters as the mould bath level, the mould temperature field, the casting speed and other unsteady state parameters are considered.In this paper, the idea of introducing an adaptive PCA connected to measurement of the above cited process parameters is somehow new. This approach is based on the analysis of the correlation between the mould bath level, casting speed and the tundish stopper. This approach consists in the following steps:•The first step is modelling. A regression model is built using the input and output data, taking into account all dependencies. A residual is generated using the difference between the real and the computed data.The second step is an evaluation of the generated residual based on the MSE. Depending on the importance of the computed residual, the adaptive procedure reacts.The third step is a general evaluation of the detected breakout based on the MSE values. A classification of the breakout as significant and important is given according to the importance of the numerical value of MSE. This latter will be defined in Section 2.1.The main motivations to use such an APCA-based approach are:•The considered application is a multivariable system.The nature of the process application can present non-linear and unsteady state reactions; in such a case an adaptive form is needed.In many cases, the soft sensing approach does not require more than simple programming tasks. However, it may need some hardware tools. This approach is applied only in the case of the existing numerical control system i.e. modification of the existed software.The PCA algorithm is relatively simple to be implemented.This paper is organized as follows. In Section 2, the proposed inferential model using data mining is developed, and then the PCA algorithm is presented. In this part, a matrix inversion procedure is needed and eigenvalues are computed. A particular focus is given to the numerical implementation of the proposed adaptive form of PCA. After that, the proposed computing scheme is implemented and tested. MSE would help to evaluate the residual importance. Section 3 gives a description of the continuous casting process and presents the process parameters as the main factors which the breakout is highly depending on. Simulation results and comments of the used adaptive and non-adaptive PCA forms are presented in this same section. Whereas, at the end of the paper, there is a comparative study between PCA, APCA, non-linear system identification using neural network (NN) and support vector regression (SVR). In this part, simulation results are shown in the corresponding figures and tables and an interpretation of the obtained results is given too. Finally, the developed method analysis is presented and some related advantages with justifications are mentioned.Nomenclature.PCAprincipal components analysisAPCAadaptive principal components analysisPLSpartial least squarePCsprincipal componentsMSPCmultivariate statistical process controlMSEmean squared errorMSEAacceptable mean squared errorSVDsingular vector decompositionStdstandard deviationCcovariance matrixeig(C)eigenvalue of the covariance matrix Cℜreal spaceΦideal correlation functionγoutput spaceχinput spaceyreal model outputXvector of input dataɛmodelling errorSxestimated value of stdu(t)control inputh(t)mould bath levelv(t)casting speedTcastcasting temperatureN(0, σ)normal distribution with zero mean and a std (σ)NNneural networksfmodelling functionDHisthistorical domain of real dataσstandard deviationTscore matrix of PCA algorithmR(ft−1,XtR)model of the adaptive function used by PCA procedure[xt, …, xt−Nx]input dataXscaledscaled vector of input dataXminminimal value of input vector (X)Xmaxmaximal value of input vector (X)XMeasmeasured value of input vector (X)Ploading matrix of PCA algorithmEresidual error obtained from PCAVeingenvalue matrixBproportional coefficients of the estimated linear model using (PCA)λeigenvalue of the covariance matrixNxnumber of the element of the input vector (X)Nynumber of the element of the output vector (y)Nɛnumber of the element of the modelling error (ɛ)βproportional coefficients of the estimated linear model using (APCA)lnumber of the significant eigenvaluemnumber of global vectorρvolumetric mass of the liquid steelAn ideal process model can be defined by a complex relationship between its input (input space: χ) and output variables (output space: γ). This relationship is defined by the function Φ.(1)γ=Φ(χ)This latter, can be approximated by a model defining the dependency between an input data (X) and an output data (y).(2)y=f(X)+εwhere ɛ∈N(0, σ)ɛ is a zero-mean normal distribution of the error term obtained in modelling step and σ its standard deviation.Firstly, the model f is developed and trained using historical data. DHist=(XHist, yHist); where DHist is the historical domain containing the input/output data base. The estimated output at each time (t) is given by:(3)yˆt=f(Xtf)whereXtfis the input of the model depending on the model complexity. The input is composed by the input data [xt, …, xt−Nx], past values of the target data [yt−1, …, yt−Ny−1], and the prediction residual [ɛt−1, …, ɛt−Nɛ−1].Using [ɛt−1, …, ɛt−Nɛ−1] as an input of the model can lead to a problem with the stability of the model because this term is used as a feedback. The model parameters are obtained by online identification methods using an adaptive procedure-based moving windows technique. In some cases, characterized by a limited noise, the term [ɛt−1, …, ɛt−Nɛ−1] is cancelled.For avoiding a possible loss of performance that may occur as a consequence of the model changes, an adaptive form is necessary: In this case, the model needs to be equipped with an adaptation mechanism (see Fig. 1) which takes into consideration the feedback information and the online data. In addition to the model description given by Eq. (3), there is an adaptation function defined by(4)ft=R(ft−1,XtR)Different techniques, in this context, can be applied as the moving window technique and the recursive method with its allied techniques.The moving window and recursive technique can be formulated respectively by:-ft=R(XtR)withXtR=[DMW=(Xt−i,yt−i)]i=1Nx−1, N is the moving window lengthft=R(ft−1,XtR)withXtR=[Xt−1,yt−1,ft−1]Principal component analysis (PCA) is a mathematical procedure that uses an orthogonal transformation to convert a set of observations of possibly correlated variables into a set of values of uncorrelated variables called principal components. The number of principal components is less than or equal to the number of original variables. This transformation is defined in such a way that the first principal component has the higher variance, i.e. the higher possible variability, without having any correlation with different variables and each succeeding component in turn has the highest possible variance under the orthogonal conditions. Principal components are guaranteed to be independent only if the data set is jointly normally distributed. PCA is sensitive to the relative scaling of the original variables. Generally a matrix of the input data X is to be normalized with a zero mean and a unit variance. This normalization is obtained by the following formula:(5)Xscaled=XMeas−XminXmax−Xminwhere Xscaled is the scaled data, Xmin is minimum value of the real data, Xmax is maximum value of the real data, XMeas is the real value.The scaling is applied in order to assume equal influence of the input variables in the model. The normalized data is then transformed to l-dimensional (l≤m) scores matrix T∈ℜnxlusing the following equation:(6)X=TPT+EX is the normalized form of the original data, P∈ℜmxland E∈ℜnxmare the loading and residuals matrices respectively.In the case of the covariance approach, the correlation matrix C of the input data X is calculated as:(7)C=1Nx−1XTXEigenvalues and eigenvectors of this matrix are obtained by solving:(8)V−1CV=eig(C)where eig(C) is the diagonal eigenvalues matrix and V is the eigenvector matrix. The eigenvalues λiare then stored in descending order such that λ1>λ2>⋯>λm. The columns of a matrix P are then formed by the eigenvectors vicorresponding to the highest eigenvalues (l≤m). There is a truncation of the neglected eigenvalues that not have a significant contribution:(9)P=[v1,v2,…,vl]withvi∈ℜmxlTo perform the eigenvalue decomposition, the Singular Value Decomposition technique (SVD) can be used.(10)T=XPHaving the matrix T, one can build a regression model using the least squares (LS) algorithm:(11)yˆ=T⋅BUsing the LS algorithm, the estimated value of B can be obtained by:(12)B=[TTT]−1TT⋅y=L−1TT⋅ywithL∈ℜlxlThe regression model performance can be measured by the MSE which is defined by the following formula, this index gives the mean quadratic distance between the model and real output:(13)MSE=N−1∑t=1Ny(yt−yˆt)2The computing procedure is defined as follows:1.Data acquisition (formation of X and y).Compute the eigenvalues λ.Select the significant values of λ=[λ1, λ2, …, λl], l<m,Compute the matrices P and T using Eqs. (9) and (l0)Compute the matrix B using Eq. (12)Predict the outputyˆusing Eq. (11)Compute the residualεt=yt−yˆtand the residual performance defined by the MSE of residual.Go to step 6.As shown in Eqs. (10) and (11) the predicted valueyˆdepends on two variables T and B. An adaptive approach based on the moving window method implemented in Section 3.2.4 is developed in this section (Fig. 2).The proposed computing prediction procedure using the adaptive PCA is defined as follows:1.Select an optimal moving window length (Nx, Ny, Nɛ),Data acquisition:X=[xt,…,xt−Nx,yt−1,…,yt−Ny,εt−1,…,εt−Nε−1],y=[yt,…,yt−Ny],Compute the eigenvalues λ,Select the significant values of λ=[λ1, λ2, …, λl]. l≤m,Compute the matrices P and T using Eqs. (9) and (10)Compute the matrix B using Eq. (12)Predict the outputyˆusing Eq. (14),Compute the residualεt=yt−yˆtand the residual performance defined by the MSE of residual.If (MSE<MSEA), go to step 7. MSEA is the accepted mean squared error.Else go to step 1.From Eqs. (9) and (10), the predicted output can be written as:(14)yˆt=XPB=Xβ=[xt,…,xt−Nx,yt−1,…,yt−Ny−1,εt−1,…,εt−Nε−1][β1,…,βNx+Ny+Nε]TIn continuous casting, the breakout phenomenon is generally caused by rupture of the solid crust due to an increase in temperature at various points of the mould. Both peak and oscillations of temperature have a direct influence on solidification process and thus, on the resulting quality of the solidified product. This influence is more perceptible in case of slag incrustation, cracks formation or propagation, poor friction and generally in a situation of an imbalance of distributed thermal reactions in the mould. In this section, the breakout is detected and evaluated by the analysis of the normal and abnormal phenomena affecting the mould bath level using PCA and APCA models.Fig. 3shows the principle of the continuous casting process. The mould bath level fluctuations affect strongly the thermal profile and the sticking can occur particularly for sensitive steel grade. In the normal situation the complex relationship between the mould bath level h(t), the casting speed v(t) and the stopper action u(t) is balanced. Whereas, in the abnormal situation, the model parameters are changed and the balanced correlation is then affected. A PCA-APCA method coupled to modelling uncertainties is used in exploring this phenomenon in order to evaluate the breakout.As mentioned in the section above, the mechanism for the original sticking can be explained by the existing conditions at the meniscus such as variations of casting speed, liquid-steel level in the mould bath, steel temperature and lubrification. Since, changes of casting speed have an important influence; related procedures have been modified to slowly ramp up the speed. A breakout appears generally during metal sticking on the copper plate of the mould causing a solidification disturbance that is followed by a perforation of the solid shell. Sticking breakout is propagated with various speeds in various directions and particularly in the casting direction. Fig. 3 shows an example of breakout propagation and a little crack which grows to become a breakout affecting the slab quality.After the development and implementation of the breakout detection system on continuous casting processes, efforts have been focused on the simplification of instrumentation by reducing the number of thermocouples and the development of advanced models that would be able to minimize the number of false alarms [25]. The principle of detection is based on the analysis of temperatures on the mould and their gradients. Such a system ensures the monitoring and the detection of different alarm levels and aims to the reduction of the casting speed. Temperatures are acquired and transmitted to a computer for monitoring. The control ensures actions using a specific algorithm for detection and control.The proposed control scheme is based on a simple and accurate method based on the analysis of the complex relationship between mould bath level, casting speed and the stopper position control is proposed. The breakout is evaluated on the base of uncertainties value of the considered model given by Fig. 4.As shown in Fig. 4 the complex model defining the relationship between the casting speed, mould bath level and stopper control position of outlet steel flow of the tundish can be considered as a dynamic system. The mould bath level h(t) is affected by several changes of unsteady state parameters such as the steel physical properties (ρ, Cp), changes of the process dynamic parameters [v(t), v(t−1), h(t−1), u(t), u(t−1)], the temperature field of the mould i.e. the casting temperature Tcast and other unknown parameters defined by a random term ɛ(t). Using soft sensing, it is possible to correlate the uncertainty of modelling to the breakout damage i.e. modelling uncertainties are proportional to damage levels.In the followings schemes, related to breakout application, the mould bath level h(t) is considered as the model output y(t) and the input variable x is associated to the input vector i.e.(15)x=[v(t),v(t−1),h(t−1),u(t),u(t−1)]As defined in the above equation, the past values of the main factors affecting the breakout, i.e. the mould bath level h(t−1), the casting speed v(t−1) and the control input u(t−1) of the tundish opening gate are used to take into account dynamic changes of the model.Advanced process control and monitoring requires accurate process models. The development of analytical models from the relevant physical and chemical knowledge, especially for complex processes with phase changes, can be too costly or even technically impossible. For such models, based on process production, operational data should be capitalized. Many industrial processes are characterized by a non-linear dynamic behaviour. Then, they need non-linear models. Indeed, neural networks have been shown to be able to approximate continuous non-linearities and have been applied in modelling of non-linear and complex processes of which the complexity is due to the large number of network weights. In practice, many non-linear processes are approximated by reduced order and possibly linear models and which are clearly related to the underlying process characteristics. The model identification principle using NN is given by Fig. 5. A model structure is chosen, the input and the output variables are defined, the modelling residual or error is computed and used as a tool to adapt the model parameterswijtby the means of the computing procedure which generally includes a recursive form, more details about this method can be founded in different documents [25–27].The model output is defined by:(16)yt=f(x,wijt)f is a model structure, x is the model input andwijtare the NN weights. They are estimated by the corresponding algorithm that minimizes the modelling error as shown in Fig. 6. The recursive form is given by the following equation.(17)wijt=wijt−1+α∂fwijε(t)with α a constant (0<α<1).Many published works have been developed in modelling and identification field using NN [25–27], the computing procedure is described by the following steps:Step 1: Initialize the network weightswij0=[−0.5to+0.5]Step 2: Acquisition of inputs/outputs (xt, yt)Step 3: Compute the model outputyˆtStep 4: Compute the modelling errorε(t)=yt−yˆt(a)if ɛ(t)≈0,wijt=wijt−1→Stop:wijt=wij[*]Else, adjust the NN weights using the recursive algorithm Eq. (15)Step 5: Go to step 2.Since the publication of the first results of the SVM theory by Vapnik (1995) at the AT&T Bell Laboratories, the application of SVM to time-series forecasting has shown a real breakthrough and a good performance in general. Moreover, the rapid development of SVM in the statistical learning theory has encouraged researchers to use SVM in various research areas (Chen et al., 2001; Sansom, Downs, Saha, 2002; Vapnik, 1995).The SVM algorithm uses a set of training data to model the regression function that can accurately approximate future values. More details about this method can be found in different works [11,14].The generic SVR estimating function takes the form:(18)y=f(wϕ(x))+bwherew∈Rn, b∈R and ϕ denotes a non-linear transformation from Rnto the higher dimensional space. x and y are the input and output data to be modelled. The goal is to find such values of w and b those values of x can be determined by minimizing the “regression risk” defined as follows [11,14]:(19)Rregre(f)=C∑i=0tΓ(f(xi−yi))+12||w||2The principle of breakout modelling and identification using SVR is defined by the scheme given in Fig. 6.After transformation of initial mathematical formulation given by Eqs. (16) and (17) using support vector regression [28,29], the computing procedure is given by the followings steps:Step 1: Initialize the model data (initialize sets parameters)Step 2: Acquisition of inputs/outputs (xt, yt)Step 3: Compute the model outputyˆtusing SVM algorithmStep 4: Compute the modelling errorε(t)=yt−yˆt(a)if ɛ(t)≈0, New sets=Old sets→Stop: [w, b]=[w, b]**Else, affect the new computed sets as old sets and act the SVM algorithmStep 5: Go to step 2.In order to evaluate the breakout and to validate the proposed technique, real data was used to predict the process’ outputs, i.e. the mould bath level h(t). The detection–evaluation is carried out by a combined approach of PCA and its adaptive form developed in this work. The adaptive implementation of PCA-APCA using a moving window is explained in Fig. 7. The process output is predicted by the above adaptive computing procedure and the new data is acquired via a moving window. The action of the adaptive procedure starts when the predicted error exceeds a threshold fixed by the practical procedure of continuous casting. New PCs obtained from eigenvalues (λ) are computed and the least squares algorithm is used to estimate the correlation matrix B as given by Eq. (13).In order to validate the developed method, a number of simulations corresponding to six cases of breakout have been realized. The first three situations (Fig. 8) are of normal cases (no breakout: False alarms) whereas the three others given by Fig. 9represent real breakout situations of different importance.The comparative study was carried out using four methods:1-APCA: Adaptive PCA technique,PCA: Conventional PCA techniqueNN: Neural Network methodSVM: Support vector machine based on Quadratic Programming,A short description of the two last methods (NN, SVM) is given in Sections 3.2.2 and 3.2.3.The process behaviours shown in Fig. 8 and Table 1are related to a no major breakout situation, the MSE value is computed for each method. More interesting example is the breakout presented in Fig. 9a–c where, the detection and evaluation efficiency is easily distinguished from a method to another.As shown in Table 1, the best threshold of MSE obtained with PCA method (1.5321e+004–252.2465), but that obtained using APCA is about (517.6882–109.4932). The APCA algorithm provides an MSE proportional to the breakout importance. This property is clearly shown in Fig. 8 and Table 1, where major and minor breakouts have different MSE's (about 4.050e+3 and 683.0986).Using PCA method, major and minor breakouts have a MSE values respectively about 1.3250e+004 and 1.5321e+004. These MSE values confirm that the method has not the same efficiency in evaluation as the first one; the MSE value is not proportional to the breakout importance.Concerning the two others methods NN and SVM, MSE values do not show any variation at breakouts occurrence, even with major ones. These methods remain insensitive to breakout detection and evaluation (Fig. 10).

@&#CONCLUSIONS@&#
