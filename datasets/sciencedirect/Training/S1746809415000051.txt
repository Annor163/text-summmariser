@&#MAIN-TITLE@&#
Quantitative analysis of live lymphocytes morphology and intracellular motion in microscopic images

@&#HIGHLIGHTS@&#
The dynamic behavior of live lymphocytes is quantitatively analyzed.A novel approach for exploiting intracellular motion information is proposed.An optimal feature vector is chosen by formal statistical testing.Effectiveness of the feature vector is experimentally demonstrated.Salient clinical potentials of the proposed scheme are envisioned.

@&#KEYPHRASES@&#
Lymphocyte shape analysis,Lymphocyte deformation analysis,Intracellular motion analysis,Optical flow,

@&#ABSTRACT@&#
Cellular morphology and motility analysis is a key issue for abnormality identification and classification in the research of relevant biological processes. Quantitative measures are beneficial to clinicians in making their final diagnosis. This article presents a new method for measurement of live lymphocyte morphology and intracellular motion (motility) in microscopic images acquired from peripheral blood of mice post skin transplantation. Our new method explores shape, deformation and intracellular motion features of live lymphocytes. Especially, a novel way of exploiting intracellular motion information based on optical flow method is proposed. On the basis of statistical tests, optimal morphological and motility features are chosen to form a feature vector that characterizes the dynamic behavior of the lymphocytes (including shape, deformation and intercellular motion). In order to evaluate the proposed scheme, the above feature vector is used as input to a probabilistic neural network (PNN) which then classifies the dynamic behavior of lymphocytes in a set of cell image sequences into normal and abnormal categories. Comparative experiments are conducted to validate the proposed scheme, and the results revealed that joint features of shape, deformation and intracellular motion achieve the best performance in expressing the dynamic behavior of lymphocytes, compared with Fourier descriptor and Zernike moment methods.

@&#INTRODUCTION@&#
Measurement of live cells morphology and motility in microscopic images is essential to understanding and treating some biological processes, such as the development of an organism, wound healing, cancer metastasis, drug test, inflammation research and immune response [1–7]. Computer-assisted cell image analysis has become a powerful analytical tool for turning qualitative data into quantitative values [8–13]. As we know, lymphocytes are involved in immune response. Clinicians observed that lymphocytes are highly deformable objects: cell deformation and protrusion are more active when the graft rejection occurs, compared with the case of no graft rejection occurring. Currently, needle biopsy, the golden standard of pathology method to diagnose rejection, is far from satisfactory because it is invasive, time-consuming, trial-limited, and dependent on the puncture location [14]. The analysis of lymphocytes dynamic behavior to reveal the relationships between the immune status of the organism and activity of immune cells via microscopic images is meaningful for the assisted diagnosis of graft rejection. In this article, we focus on analyzing the dynamic behavior of the single lymphocyte in different situations, normal and abnormal (graft rejection), and then classify them based on quantitative assessment of lymphocytes’ shape, deformation and intracellular motion.In the past four decades, many applications of cell image analysis have been developed, such as the classification of white blood cells [15], cell segmentation and tracking [1,4,6,7,16–21], and the quantitative characterization of cells dynamic behavior [5,8,22–28]. Some shape parameters (center, area, perimeter, circularity, and minimum rectangle) were extracted, and the rate of the NIH-3T3 cell movement was calculated by measuring the displacement of the whole cell in [22]. The Weijer group introduced a gradient method for quantitative analysis of cell movement [23]. The velocity of the leukocyte was computed from a tangent direction at each point of the trace in [24]. Quantitative analysis of dynamic behavior (deformation and migration) of cells was presented in [5,25], in which motion and deformation parameters were extracted from parametric estimation of the affine-motion model. Theriot et al. studied on the mechanism of shape determination in motile cells, and further predicted the cell's speed from its aspect ratio [26]. The method for local and global measures of shape dynamics was proposed in [27], and the cell motion speed was computed from the magnitude of the displacement of the boundary point. Our earlier work has presented a geometric method for modeling dynamic features of cells in image sequences, which emphasized on cell deformation analysis without considering intracellular movement [28].In previous work on cell image analysis, there are two worth noting issues: first, in the analysis of cell motion, the cell speed was usually calculated via the displacement of the centroid of the cell [22], by the tangent direction of the motion trail of the cell [24], through the cell deformation [26], or via the affine-motion model [5,25]. All these methods dealt with the movement of the whole cell. Little attention has been paid to the intracellular motion [23]. Secondly, these works either dealt with shape and deformation analysis [8] or dealt with cell motion analysis [23,24]. However, few have combined these three aspects [22]. Quantitative methods for cell shape analysis mentioned in the article [8] do not provide information about the dynamic cellular activity.In this article, in order to quantitatively assess the dynamic behavior of the lymphocyte, we computed the intracellular motion field directly using optical flow techniques based on the brightness constant model (BCM) [29], and further extracted intracellular motion feature from it. Especially we quantitatively analyzed the dynamic cellular activity from three aspects: shape, deformation and intracellular motion, and then combined three aspects of features to classify lymphocyte dynamic behavior into normal and abnormal categories. This article is an extended version of our preliminary work presented in the conference article [30].The rest of the article is organized as follows. Materials and methods are introduced in Section 2. Experiments and results are presented in Section 3, and the discussion in Section 4. Finally, the conclusion is in Section 5.The cell image sequences were acquired by optical phase contrast microscope at a magnification of 160,00× from the peripheral blood samples of clean healthy mice 7 days after the skin transplantation. The mice in our experiments are 6–8 weeks and 20–22g. Experiments ensure that there is only one object-lymphocyte in each frame image. That is to say we only observe one lymphocyte in each image sequence. The animal experiments were conducted by the trained staff in Beijing You’an Hospital, which is affiliated to the Capital Medical University. And the hospital is a Grade-III Class-A hospital of the Ministry of Health in China. All the disposals are in accordance with the guideline of animal ethics. Two kinds of experiments were conducted. The first experiment was implemented through autologous transplant. Healthy Balb/C male mice were used as both hosts and donors, which is called self-skin transplantation group (the SST group). The second experiment was implemented through allogenic transplantation, in which healthy Balb/C male mice were used as hosts while healthy C57BL/6 male mice were used as donors. We called it allogenic skin transplantation group (the AST group). The shape of the lymphocytes is stable in the SST group, and the deformation and intracellular motion are slight. There is no acute rejection in this case, and this is a normal group. The lymphocytes are more active in the AST group, and the deformation and intracellular motion are intense. There is acute rejection in this case, and it is an abnormal group.Segmentation and tracking of cell boundaries in phase contrast microscopic images are challenging due to non-uniform edge intensities and the phase halos. Active contour models (snakes), pulling the initial contour to the desired boundaries with various kinds of external force, have shown prominent advantages in object segmentation and tracking. However, the current external-force-inspired snakes suffer from initialization sensitivity, and are weak at handling low-contrast edges. We propose a new feature map instead of the traditional edge map to generate external force field for snakes evolution, and apply it to cell segmentation and tracking in this study. The new feature map can combine the region information of the object, extracted by morphology gray-scale reconstruction (MGR), and the edge information, extracted by the Laplacian of Gaussian (Log) filter, which is called MGRL-feature map and defined as follows:(1)fMGRL(x,y)=Fl[∇2(Gσ(x,y)×ρI(x,y)(J(x,y)))]where F1(·) is a low pass filter; ∇2(·) is the Laplacian operator; Gσ(x, y)+ρI(x,y)(J(x, y)) is the convolution of the Gaussian function Gσ(x, y) and ρI(x,y)(J(x, y)). ρI(x,y)(J(x, y)) denotes the MGR of the I(x, y) from the J(x, y). I(x, y) is the region of interest (ROI). The details of the MGR process can be found in [31]. The improved external force field based on MGRL-feature map is:(2)Vvfc_MGRL(x,y)=fMGRL(x,y)×k(x,y)where k(x, y) is the vector field kernel, the details of which could be referred to [32].The VFC snakes based on the improved external force minimize the following energy function [32].(3)E=∫0112(α|C(1)(s)|2+β|C(2)(s)|2)+Evfc_MGRL(C(s))dswhere C(s)=[x(s), y(s)], s∈[0, 1] denotes the parametric contour which is defined in an image domain and can move under the influence of the internal and external forces. α and β are weighting parameters representing the degrees of elasticity and rigidity of the parametric contour, respectively. Evfc_MGRL denotes the improved external energy. Using the calculus of the variations [21], the minimization of Eq. (3) must satisfy the Euler equation:(4)α⋅C(2)(x,y)−β⋅C(4)(x,y)+Vvfc_MGRL(x,y)=0whereVvfc_MGRL(x,y)=[u(x,y),v(x,y)]is defined as Eq. (2). Using a finite difference approach on a discrete grid, the solution of the Eq. (4), C(s), is the desired boundary of the lymphocyte.Active contour models allow us to solve both segmentation and tracking problems simultaneously. The concept is that lymphocyte tracking is realized by lymphocyte segmentation frame by frame. To alleviate initialization sensitivity problem, the initial contour of the first frame is obtained around the ground truth by an initial segmentation; the initial contour of the subsequent frame is obtained from the previous frame. That is to say, the final contour of the previous frame is regarded as the initial contour of the current frame during the evolution of active contours. The procedure of segmentation and tracking is described in Fig. 1.The segmentation and tracking results of the lymphocyte in the image sequence are shown in Fig. 2.Once the boundary of the target cell has been obtained, the next step is a concise, quantitative and biologically relevant description of the cell morphology and mobility. In this study, we extracted the features of the shape, the shape deformation and the intracellular motion, respectively. Methods of features extraction are introduced as follows.In general, shape descriptor is a set of parameters that are produced to describe a given shape. A shape descriptor is consistent with human intuition. Good shape descriptors are supposed to find similar shapes from a database effectively. Some geometric features can be used to describe a shape in different aspects [8,33]. These shape parameters are area, perimeter, center of gravity, eccentricity, circularity, average bending energy, rectangularity, convexity and solidity. Area is the total number of pixels in the region containing the object. Perimeter is the distance around the boundary of the object. Eccentricity is the ratio of the distance between the foci of the ellipse and its major axis length, whose value is between 0 and 1. Circularity ratio represents how a shape resembles a circle. The solidity describes the concavo-convex information of a shape. For example, the solidity of a convex shape is always 1. Some definitions of shape parameters are shown in Table 1.The shape parameters in Table 1 are defined for the static objects. Here we propose the shape descriptor and the deformation descriptor for describing the shape and the deformation of the lymphocyte in the image sequence as follows. We define the shape descriptor Vshape to describe the shape feature of the lymphocyte in the image sequence, as is shown in Eq. (5).(5)Vshape=1N∑i=1NDiwhere N is the total number of frames in the image sequence; Diis the shape descriptor value of the lymphocyte in the ith frame, which can be a shape parameter as mentioned above, such as area, perimeter, eccentricity, circularity, average bending energy, rectangularity, convexity and solidity. For example, when Direpresents the area, we get the Vshape of area. Vshape is the average of the cell shape parameter of all frames in the image sequence, which indicates the shape feature of the lymphocyte in the image sequence.We define the deformation descriptor Vdeformation to describe the shape change feature of the lymphocyte in the image sequence, which is shown as:(6)Vdeformation=1N−1∑i=2N|Di−Di−1|where N and Diare the same as in Eq. (5); Vdeformation is the average of the cell shape difference of all frames in the image sequence, which indicates the deformation feature of the lymphocyte in the image sequence. Vdeformation of the area and the perimeter should be normalized.According to the clinical observation, the intracellular movement is intense in the abnormal group, while slight in the normal group. Here we adopt optical flow techniques to obtain quantitative analysis of intracellular movement. The optical flow computation is a key technique for the object motion analysis, and can help us to know important motion characteristics of moving bodies. In our study, the camera and the microscopic slide are fixed during the image sequence acquisition process. We assume that the incident illumination is uniform.Phase contrast microscope is one of the most common used instruments to observe long-term cell activity [34]. Cells are transparent objects and have local variation, and the local phase variations will be generated based on the refractive index while light going through them. Then phase contrast microscopy can generate high-contrast images of cells by translating these local phase variations of the object into intensity variations in the image. So we can apply optical flow method to obtain the velocities of the intracellular motion.The optical flow constraints equation based on BCM is shown as follows [29]:(7)Ix⋅u+Iy⋅v+It=0where I(x, y, t) denotes the image brightness at the point (x, y) in the image at time t. Ix, Iyand Itare the partial derivatives of image brightness with respect to x, y and t, respectively. u=dx/dt andv=dy/dtare x and y components of the optical flow.There is only one constraint at each pixel, while a velocity vector has two unknowns: u and v. So the velocity vector cannot be computed locally in Eq. (7), and additional constraint should be involved. Some references have assumptions on the instantaneous velocity field, such as spatial smoothness constraint or spatial constancy in a small neighborhood in the velocity vector [29,35]. Here we use HS optical flow method, in which the additional constraint is to minimize the sum of the square of the magnitude of the gradient of the optical flow. The variation formulation of the HS optical flow method can be expressed as:(8)EHS(u,v)=∫∫Ω(Ix⋅u+Iy⋅v+It)2+γ(|∇u|2+|∇v|2)dxdywhere γ is the weighting parameter that controls the relative importance of the optical flow error(Ixu+Iyv+It)and the spatial smoothness error(|∇u|2+|∇v|2). We minimize the sum of the optical flow error and the spatial smoothness error by using the calculus of variations. Hence the optical flow (u, v) that minimize Eq. (8) must satisfy the Euler equation(9)(Ix⋅u+Iy⋅v+It)Ix−γ⋅∇2u=0(Ix⋅u+Iy⋅v+It)Iy−γ⋅∇2v=0The details of the solution process of (u, v) can be found in [29]. Then we can obtain the direction and magnitude of each pixel's velocity of intracellular motion at the cellular stage.In order to assess the intracellular motion, we extracted the quantitative feature from the optical flow fields by the following steps. First, we computed the mean velocity of each optical flow field as follows:(10)VMeanVeloField=1AΩ∑(x,y)∈Ωu2(x,y)+v2(x,y)where u(x, y) andv(x,y)are the x and y components of the velocity at the point (x, y). AΩis the area of the region Ω. Ω is a closed 2-dimensional optical flow field domain(11)Ω={(x,y):u2(x,y)+v2(x,y)≥thresholds}where thresholds=0.0001 (fixed by numerous experiments), which is used to restrict the region of the optical flow fields and mask the optical flow data to the interior of the cell. Secondly, we defined Vmotion as the intracellular motion feature, which is computed as:(12)Vmotion=1N2∑i=1N2VMeanVeloField_iwhere VMeanVeloField_iis the mean velocity of the ith frame optical flow field. N2 is the total number of frames of the optical flow fields in the image sequence. Vmotion represents the mean velocity of intracellular movement fields of all frames in an image sequence.In order to evaluate the performance of our proposed scheme, we also adopt the other two comparative methods in this study: the Fourier descriptor and the Zernike moments. Fourier descriptors (FD) have been successfully applied to contour-based shape representation application, which is appropriate to a close contour shape descriptor [36,37]. Generally, FD is obtained through Fourier transform (FT) on a shape signature function, which is derived from the shape boundary coordinates {(x0, y0), (x1, y1), …, (xN−1, yN−1)}. Here the complex number derived from the contour c(n)=xn+j·ynis used as the shape signature function. One-dimensional FT is then applied on c(n) to obtain the Fourier transformed coefficients.(13)d(k)=1N3∑n=0N3−1c(n)exp(−j2πnk/N3),k=0,1,…,N3−1where N3 is the number of pixels on the cell boundary, and j is the imaginary unit. The coefficients d(k) are used to obtain FD. d(0) denotes the position information of the object shape, and getting rid of it can realize that FD is invariant to translation. Then the magnitudes of the rest of the coefficients normalized by the magnitude of the primary harmonic coefficient d(1) are used as FD. The obtained FD is translation, rotation and scale invariant [37].Zernike moments descriptor (ZMD) is a region-based shape representation method, which is obtained by using all the pixel information within a shape region. The complex Zernike moments of order n with repetition m are defined as:(14)Anm=n+1π∑x∑yf(x,y)Vnm*(x,y)where f(x, y) is a binary shape function; n and m are integers, andVnm*(x,y)is the complex conjugate of Vnm(x, y). Vnm(x, y) is the Zernike polynomials which are a complete set of complex function orthogonal over the unit disk. The details of Vnm(x, y) are referred to [38].

@&#CONCLUSIONS@&#
