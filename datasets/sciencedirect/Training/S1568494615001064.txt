@&#MAIN-TITLE@&#
Early fault detection in gearboxes based on support vector machines and multilayer perceptron with a continuous wavelet transform

@&#HIGHLIGHTS@&#
The study was undertaken to evaluate early fault detection of a gearbox using ANN.Selected coefficients from CWT were used as input data for the neural networks.

@&#KEYPHRASES@&#
Fault detection,Support vector machines (SVMs),Wavelet transform (WT),Multilayer perceptron network (MLP),Bevel gearbox,

@&#ABSTRACT@&#
One of the research problems investigated these days is early fault detection. To this end, advanced signal processing algorithms are employed. The present paper makes an attempt at early fault detection in a gearbox. In order to evaluate its technical condition, artificial neural networks were used. Early fault detection based on support vector machines is a relatively new and rarely employed method for evaluating condition of machines, particularly gearboxes. The available literature offers very promising results of using this method. In order to compare the obtained results, a multilayer perceptron network was created. Such standard neural network ensures high effectiveness. The vibration signal obtained from a sensor is seldom a material for direct analysis. First, it needs to be processed to bring out the informative part of the signal. To this end, a wavelet transform was used. The presented results concern both a “raw” vibration signal and processed one, investigated for two neural networks. The wavelet transform has proved to improve significantly the accuracy of condition evaluation and the results obtained by the two networks are consistent with one another.

@&#INTRODUCTION@&#
Methods for controlling technical condition of machinery are still a matter of research. This is due to the fact that manufacturing companies seek for techniques that would allow for reducing both maintenance and production costs by both preventing stoppages caused by machinery breakdowns and prolonging machine working time. The use of a vibration signal in diagnostic systems is widely employed, particularly when it comes to machines with rotating elements. Evaluating the general condition of a machine and distinguishing basic defects, such as unbalance or shaft misalignment, does not pose any problems these days. Scientists and machinery diagnostics companies have long been investigating methods that enable early fault detection. As for gearboxes, which are an important component of the powertrain, the early fault detection involves the diagnostics of gears and bearings, as these critical elements on which the gearbox reliability depends are most prone to damage.The basic diagnostic signal involves measuring vibrations mainly on a gearbox body. The traditional methods of signal analysis involve analyzing time and frequency domains. The first method mainly consists in calculating statistical features, while the frequency analysis brings out the signal structure which can then be used to draw conclusions about object condition. At present, numerous diagnostic methods are being developed; the ones that are rarely used in gearbox diagnostics include a recurrence plot [1] (detecting faults in gears) or bispectrum [2] (detecting faults in bearings). Additionally, principal component analysis (PCA) or canonical discriminant analysis (CDA) is used to conduct preliminary signal processing at redundant data [3].The use of a wavelet transform (WT) has been very popular for two decades. The popularity is due to advantageous properties of this transformation and availability of computer software [4]. The WT is used in different fields of science, like medicine, biology and engineering; it is also employed to process signals and images. In engineering, the signal analysis mainly consists in signal structure visualization [5], denosing [6,7], compression [8] and decomposition [9]. Depending on a machine type and operational conditions, diagnostic signals can be non-stationary. One of the most frequently used methods for analyzing such signals is the short time Fourier transform [10]. However, a shortcoming of this method is constant window length in the course of analysis, which results in constant time-frequency resolution. In the WT, the higher the signal frequency is, the narrower the window, which leads to reaching an advantageous compromise between the resolution in time and scale (scale is interpreted similarly to frequency). In the studies devoted to gearbox diagnostics, the WT is more and more often one of the stages of the diagnostic procedure [11,12], and not its main or only element [13].The diagnostic systems which perform diagnosis in an automatic manner need methods that allow for evaluating technical condition of a given object without the participation of a diagnoser. It seems that such task can be accomplished using methods based on artificial intelligence. Such methods include, among others, genetic algorithms, fuzzy logic, expert systems as well as artificial neural networks (ANNs), which were used in the present study. Two basic tasks that ANNs are applied to include: classification of technical condition and/or predicting changes in an object being studied (regression analysis). ANNs model non-linear relationships between diagnostic signals (or their parameters) and object condition. According to [14], which discusses the over a decade-long application of ANNs to the diagnostics of cutting tools, the most popular network type is a multilayer perceptron (MLP), in which learning is done by means of a back propagation algorithm. This network has proved to be effective in many applications. However, a shortcoming of this network and other traditional networks is the risk of overlearning, i.e. limited generalization of the acquired knowledge. Support vector machines (SVMs) invented by Vapnik are relatively less popular [15]. In contrast to the traditional ANNs based on empirical risk minimization (ERM), SVMs are based on structural risk minimization (SRM), which results in their better properties of knowledge generalization [16]. There are relatively few studies devoted to technical condition evaluation based on SVMs, especially with regard to gearboxes. Yet, the results obtained by the authors of these studies are very promising. The studies devoted to comparing the SVM results and the ones obtained for other networks reveal that the results obtained for SVMs are better [16–18]. The fundamental aim of the SVM is to separate two classes by means of a hyperplane described by support vectors. For data that are not linearly separable, projecting into a different functional space is done where the data can be linearly separated.The present study was undertaken to evaluate the condition of a gearbox using two networks: SVM and MLP. The latter network was used only for comparative reasons, as its effectiveness had been reported by many studies. The authors of the present paper had successfully used this network, too. A continuous wavelet transform (CWT) decomposes the vibration signal into wavelet coefficients. Such transformation allows for extracting signal characteristics that are invisible in timing. Next, the selected coefficients were used as input data for the ANN.The experimental tests were conducted at constant maximum rotational velocity and under constant load of 34% of the maximum load. The test stand and the measuring circuit are shown in Fig. 1. The tested gearbox was a one-step bevel regulator with circular-arc teeth. The experiments were performed on two gearboxes: a gearbox that was in good condition and a damaged one. The gears of the damaged gearbox were in the initial stage of scuffing.The sampling frequency of the vibration acceleration signal was 40kHz, while the meshing frequency was 1960Hz. An example of the vibration signal for the two gears and their parameters is shown in Fig. 2.The transformation of a signal from the time domain to wavelet coefficients allows for signal decomposition. The CWT is defined in the following way [4]:(1)CWT(a,τ)=1|a|∫−∞∞x(t)ψ∗t−τadtwhere τ is the position parameter, a is the scaling parameter, ψ is the mother wavelet, and ψ* is the complex conjugate of ψ.The mother wavelet is a function whose values oscillate around zero. This function is used to create a set of wavelets by changing the scaling parameter a and the wavelet position parameter τ. The wavelet coefficients are obtained by “comparing” the wavelet with the signal, and they are interpreted as the correlation measure of signal and wavelet. For this reason, the choice of mother wavelets is so important. The wavelet should have a shape similar to that of the signal generated by the phenomenon being analyzed, however, such piece of information is usually unavailable. Eleven types of wavelets were tested to find the optimal one: Morlet, biorthogonal 3.1, Coiflet 3, Daubechies 4, Dmeyer, Gaussian, Haar, Mexican hat, Meyer, ReverseBior 3.1 and symlet wavelets. To this purpose, neural network classifiers (MLP) were created. Parameters such as the number of neurons in the hidden layer, epoch training and activation functions were found to be the same. Since the MLP networks were created to find the best wavelet, the above-mentioned parameters were not optimal to this end. The results are shown in Fig. 3. The most suitable type of wavelet in the investigated case is the Haar wavelet.The number of scales for which the analysis was performed was set to 27 so as to avoid generating an excessive number of data. The interpretation of the scale is similar to that of the frequency – the higher the frequency is, the lower the scale number. Nine scales were selected, from 17 to 25, in the range of clear changes in the signal frequency. Due to the direct use of wavelet coefficients as an input to the neural network, all information is transferred to the neural network. If statistical features were used, the information could be incomplete. This can be seen both in Fig. 4, which shows gears in good condition, and in Fig. 5, which illustrates damaged gears.The MLP network is a unidirectional network with one input and one output layer, and – in this case – with one hidden layer (Fig. 6). The number of neurons in the input and output layers is equal to the number of input and output variables. To accomplish most tasks, one hidden layer is sufficient, and the number of neurons in this layer greatly affects operational correctness of the network. The more complex the problem is, the more neurons are needed to map the problem in a correct way. The neural network learning method and activation function are important in this context, too. Given the fact that the MLP network was used here only for comparative reasons, it will not be discussed in detail, as more information can be found in other studies, for example in [16,8].The SVM performs classification into two classes. In order to perform a classification for many classes, however, the multi-class classification approach is required. The SVM is also used to solve regression tasks. The aim of the present study was to investigate a two-class classification, which is discussed below.The SVM concept can be represented as looking for hyperplanes that will separate the data into particular classes. Let us assume that the data have the form of the vectorxifor i=1, 2,…,m, they are linearly separable and belong to two classes. The first class is described by yi=+1 (positive class), while the second class is described by yi=−1 (negative class). In this case, the equation of the hyperplane (line) separating the data has the following form [8]:(2)f(x)=wTx+b=0where w is the m-dimensional vector and b is the scalar. The position of the separating hyperplane is described bywand b.The equations for the first and second class, respectively, have the following forms [8]:(3)wTx+b≥+1(4)wTx+b≤−1Theoretically, there is an infinite number of hyperplanes that separate data in a correct manner. However, an optimal hyperplane is looked for, i.e. a hyperplane which would ensure the smallest error for new data – in other words, one with good generalization properties. Therefore, a hyperplane for which the margin between the classes is the highest has to be found (Fig. 7). This can be obtained by solving the optimization problem:(5)min⋅12w2At the following constraints(6)yi(wTxi+b)≥1In practice, this changes to a quadratic optimization problem with linear constraints solved by means of Lagrange multipliers [15]:(7)L(w,b,α)=12w2−∑i=1mαiyi(xi⋅w+b)+∑i=1mαiThe Lagrange function needs to be minimized relative to the parameters w, b, while maximized with respect to α[20]:(8)yi(xi⋅w+b)−1>0→αi=0(9)yi(xi⋅w+b)−1=0support vectorsIn the extreme point we have:(10)∂L∂w=0,∂L∂b=0,which can be rewritten as [15]:(11)w=∑i=1mαiyixi,∑i=1mαiyi=0.Substituting Eq. (10) into Eq. (6), we obtain the dual problem [8]:(12)maximize∑i=1mαi−12∑i=1m∑j=1mαiαjyiyjxiTxjat the following constraints(13)w=∑i=1mαiyixi,∑i=1mαiyi=0.For the data, which are fully non-linearly separable, Eq. (4) takes the form:(14)min12w2+C∑i=1mξiAt the following constraints(15)yi(wTxi+b)≥1−ξiξi≥0where ξiis the surplus variable decreasing the width of the current separation margin, C is the parameter describing the relationship between the test error and separation margin width [20].The dual problem (11) is then solved for the following constraints [8]:(16)0≤αi≤C,∑i=1mαiyi=0A high value of C means that the separation margin will be low, while a low value of C means that the margin will be high. Unfortunately, the high separation margin can result in a higher classification error. This parameter is selected by the user when creating the network in an experimental way.The non-linear network SVM is used for the cases which are not linearly separated. The data are transformed from the original N – dimensional space to the space with a higher number of dimensions Q (Q≥N), where classification will be possible. To this end, the non-linear function ϕj(x) for j=1, 2,…,Q is used. The dual problem takes the form [8]:(17)maximize∑i=1mαi−12∑i=1m∑j=1mαiαjyiyjK(xiTxj)At the same constraints as for the non-linear network:(18)0≤αi≤C,∑i=1mαiyi=0By definition, the kernel function K(xi,xj) is a symmetric function, i.e. K(xi,xj)=K(xj,xi), defined as the scalar product of vectors [8]:(19)K(x,xj)=φT(xi)φ(x)Every function that satisfies the Mercer condition [21] can be used as a kernel function. The most common kernel functions are listed in Table 1.The application of the kernel function means that it is not necessary to know the function; it is enough to know the kernel to be able to work in a new space. The decision function takes then the following form [8]:(20)f(x)=∑i=1NαiyiK(xi,x)+bWhen designing an SVM network, it is necessary to decide which kernel function to select; according to [8], the linear function is characterized by considerable limitations. In the study, the Gaussian function was applied, and the above-mentioned parameter C was of vital importance due to its effect on network complexity.In the learning of the MLP network, the BFGS (Broyden–Fletcher–Goldfarb–Shanno) algorithm [20] and the error function of sum of squares were used. The investigated networks had both a different activation function (linear, hyperbolic tangent, logistic, exponential, sine) and a different number of neurons in the hidden layer (8 through 15). The best results obtained for the three neural networks are shown in Table 3.In the case of the SVM network, the parameter C was verified in the range from 0.1 to 1000. The best results were obtained at C=119.The training of the MLP network was stopped when one of the following three conditions was met:•The training error decreases and the validation error starts to increase.The training error changes less than 0.0000001.The number of epoch is greater than 200.As for the SVM, one of the below two conditions had to be met:•The number of iterations is greater than 20,000.The error is less than 0.01.For comparative purposes, the results obtained for the “raw” vibration signal are listed in Table 2.When evaluating the neural network, it was necessary to test its behavior in confront with new input data, i.e. the data which did not participate in the learning process. The results obtained for the test data amount to 60%.Table 3lists the results obtained for the wavelet coefficients.

@&#CONCLUSIONS@&#
The results obtained for the “raw” vibration signal amount to 60%, which is not satisfactory. The vibration signal without processing is not a good source of information even for ANNs, which are usually effective in finding a standard that enables classification.By changing the signal representation into the wavelet coefficients, the classification effectiveness is significantly improved. For the SVM network, the improvement is almost 90%, while for the MLP – 92%. The classification of the gearbox condition can be improved by optimizing the wavelet transform and/or by using additional signal processing.The results came as a surprise for the authors. The studies on comparing the effectiveness of SVMs and other ANNs mentioned at the beginning of the paper as well as those the present authors are familiar with reveal that SVMs produce better results. Further studies based on SVMs will be conducted and their results will be compared with other ANNs.