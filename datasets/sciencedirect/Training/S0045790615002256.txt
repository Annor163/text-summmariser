@&#MAIN-TITLE@&#
Efficient storage of microCT data preserving bone morphometry assessment

@&#HIGHLIGHTS@&#
Preclinical micro-computed tomographies are used for morphological bone evaluation.A Volume of Interest (VoI) strategy for microCT images is proposed.The proposal allocates substances in different VoIs using the Hounsfield scale.The proposed approach may reduce the transmitted data in more than 90%.This proposal can be used to other imaging modalities work with the Hounsfield scale.

@&#KEYPHRASES@&#
Tomography,Micro-CT,3D morphometry,Medical image compression,DICOM,

@&#ABSTRACT@&#
Preclinical micro-computed tomography (microCT) images are of utility for 3D morphological bone evaluation, which is of great interest in cancer detection and treatment development. This work introduces a compression strategy for microCTs that allocates specific substances in different Volumes of Interest (VoIs). The allocation procedure is conducted by the Hounsfield scale. The VoIs are coded independently and then grouped in a single DICOM-compliant file. The proposed method permits the use of different codecs, identifies and transmit data corresponding to a particular substance in the compressed domain without decoding the volume(s), and allows the computation of the 3D morphometry without needing to store or transmit the whole image. The proposed approach reduces the transmitted data in more than 90% when the 3D morphometry evaluation is performed in high density and low density bone. This work can be easily extended to other imaging modalities and applications that work with the Hounsfield scale.

@&#INTRODUCTION@&#
Human breast, lung, and prostate cancer can induce bone metastasis, which affects the bone structure [1]. To better understand the interactions between these diseases and the bone structure during the development of metastasis, preclinical researchers develop models using small living animals. These models help to evaluate new therapeutic approaches [2,3]. The use of micro-computed tomography (microCT) images has become a common approach to assess structural changes in the bones of animals by means of 3D morphometry [4–6].During the microCT scanning process, imaging data belonging to air, fat, muscle, bone, bed, and other substances are captured. The reconstruction of the whole volume of the animal has high computational costs due to the large amount of data involved. So, rather than reconstructing and storing the whole volume, in practice, only a relevant volume (RV) that contains a portion of the whole data is reconstructed, stored, and used for the 3D morphometry evaluation.To obtain qualitative and quantitative bone morphometric measurements, specialists segment the bone tissue from the rest of the data within an RV through a thresholding procedure. This procedure is required because RVs may contain many data that do not correspond to the bone tissues. These data are not necessary for the 3D morphometry computation. The 3D morphometry is computed solely using the bone data [6,7]. Research institutions store sets of microCT data in servers to allow their access and distribution to other institutions via the Internet. The Digital Imaging and Communications in Medicine (DICOM) standard [8] is typically adopted to store and distribute such medical images [9]. This standard includes coding (i.e., compression) systems to reduce the size of the data stored. The most relevant coding systems supported in DICOM are Lempel–Ziv–Welch (LZW) [10], JPEG [11], JPEG lossless (JPEG-LS) [12], JPEG2000 [13], and H.264 [14].Progressive lossy-to-lossless coding of medical images has been widely studied in the literature. Without aiming to be exhaustive, [15] presents a 3D coding technique based on discrete cosine transform and several proposals based on discrete wavelet transform. A modification of the set partition hierarchical trees (SPIHT) method for handling 3D medical data sets is introduced in [16]. An object extension of SPIHT is presented in [17]. Sanchez et al. [18] employed the anatomical symmetries of the human body in a prediction technique that employs the wavelet transform. A JPEG2000 region of interest (ROI) coding method that can prioritize multiple ROIs at different priorities guaranteeing lossy-to-lossless coding for the ROI and the BG is proposed in [19]. More recently, a region-based coding method that distinguishes three different types of regions, namely, ROI, non-ROI, and background is described in [20]. In this work, the ROI is coded with a coding system such as RLE, LZE, or ZIP, the non-ROI is coded with SPIHT, and the background is disregarded. Despite the advantages that these coding systems may provide, none of them is suited for professional medical scenarios. This is because most of them are not supported in DICOM, others can only be employed with a particular coding system, some do not recover the original image, and others need to carry out the ROI selection manually.This paper introduces a novel DICOM-compliant coding strategy that uses the Hounsfield (HU) scale to identify different substances within an RV of a microCT image. These substances are allocated in different Volumes of Interest (VoIs) through a segmentation process performed prior to the data storage. The segmentation process allows the organization of an RV in different VoIs that are encoded independently and then grouped together in a single DICOM-compliant file. Each VoI contains a specific substance. This individual treatment of the substances allows their encoding using any technique included in DICOM. Also, it permits the identification and transmission of the data corresponding to a particular substance with neither decoding nor transmitting the others. This can be conceptually seen as scalability by substance, a new feature of the coding system. The proposed method also permits the computation of the 3D morphometry transmitting a reduced amount of data. To enhance the coding performance, an offset operation that compacts the dynamic range of the VoIs is performed. Extended experimental results analyzing coding performance and accuracy of the 3D morphometry validates the soundness of the proposed method.The rest of this paper is structured as follows. Section 2 briefly describes materials and methods, Section 3 describes the proposed approach, and Section 4 provides results and discussions. The last section concludes this work with a brief summary.The intensity values of microCT volumes are given in HU units. This allows the identification of different substances since they are allocated in non-overlapping ranges of intensity. Table 1provides the HU scale included in the reference guide of the eXplore Locus device employed in this work (see [21]). The HU scale can be finely adjusted by the specialist thanks to a calibration object that is scanned along with the animal. Other CT images (that are not necessarily microCT) also have a HU scale associated, so our method may be employed for other types of CT images.In general, the evaluation of bone structural changes produced by bone metastasis is carried out by computing the 3D morphometry using data corresponding to low-density bone (LB) and high-density bone (HB) [4,6,7,22]. LetBV,BS, and TV respectively denote the bone volume, the bone surface, and the tissue volume of an RV. The tissue volume corresponds to fat, water, low bone, and high bone. The statistics employed in 3D morphometry evaluation to analyze the cancellous bone areVs,Sv,Tb.Th,Tb.N, and Tb.Sp. They respectively represent the bone volume fraction, the density of the bone for a given VoI, the average trabecular thickness, the number of trabeculae, and the average separation between trabeculae. They are obtained via(1)Tb.Th=2−2VvSv,Tb.N=2VvSv,andTb.Sp=Sv2,(2)withVv=BVTVandSv=BSBV,with Vvand Svbeing the bone volume ratio and the bone density for a given VoI, respectively. These architectural measures only depend onBV,TV, and BS for a specific VoI. In the case of a lossless encoding and decoding of a VoI, BV and BS are calculated without error. TV needs to be stored as auxiliary data for each VoI during the segmentation procedure. It is generally stored in the metadata headers of the DICOM files.The 3D morphometry is computed using the boneJ software Library [23] with ImageJ [24]. To assess morphological differences, specialists commonly compute the 3D morphometry of bone between two different specimens, or between bone of the same specimen before and after an experimental treatment. It is considered that a difference below 2% is insignificant, between 10% and 18% is evident, and larger to 18% is significant [25].The RVs employed in this work are provided by the Center for Animal Biotechnology and Gene Therapy (CBATEG) [26], from the Universitat Autònoma de Barcelona. The microCTs are acquired by the eXplore Locus microCT imaging device from General Electric. This device generates an RV as a collection of slices with a bit depth of 14bps including sign at a voxel resolutions of 93, 45, or 27µm. Results reported in the experimental section are obtained with a corpus of 19 RVs belonging to 4 different mice. They are acquired with a voxel resolution of 27µm. Although 27µm might not be the most suitable resolution for bone evaluation since the microstructure of trabecular bone may be missing [27,28], it is the highest resolution supported in this device and so it is used in CBATEG for bone morphometry. The characteristics of these RVs are reported in Table 2.As previously mentioned, the DICOM standard supports the coding systems RLE, LZW, JPEG, JPEG-LS, JPEG2000, and H.264. RLE does not provide competitive performance for CT image data and JPEG does not support lossless compression, so they are not employed herein. The remaining systems support lossless compression and achieve competitive performance. LZW is a dictionary-based technique that replaces strings of characters with single codes. JPEG-LS is based on the LOCO-I algorithm [29]. It has two coding stages, a predictor and an encoder. JPEG2000 is wavelet-based and features important functionalities such as progressive lossy-to-lossless coding, spatial and quality scalability, random codestream access, and support for up to 38bits of signed and unsigned data with up to 16,384 slices. These features are not included in any other coding systems compliant with DICOM. H.264 is commonly employed for coding and distributing video content. It is based on block motion estimation and compensation. The extensions of the H.264 standard include the Scalable Video Coding (SVC), which enhances the interactive transmission (though such extension is not included in DICOM).The proposed method introduces a novel allocation procedure for microCT that allows the storage and identification of relevant substances in the compressed domain. First, a segmentation process that organizes an RV in different VoIs is applied. Each VoI contains a specific substance. These VoIs are then separately encoded. After encoding, they are grouped in a DICOM-compliant file. This individual treatment of the VoIs permits to encode them with different coding systems, identify and transmit the data corresponding to a particular substance (i.e., providing substance scalability), and compute the 3D morphometry without transmitting or decoding the whole RV.The proposed scheme is illustrated in Fig. 1. It has a pre-coding stage named “RV Allocation by Substances”, a DICOM-compliant coder and decoder, and an (optional) post-decoding stage named “RV Reallocation”. The “RV Allocation by Substances” and the “RV Reallocation” steps are highlighted in gray in the figure. They are described in the following section.As previously stated, a typical microCT image contains different substances of the scanned mouse and the surrounding environment. The most common substances are those reported in Table 1. Since the ranges of the intensities for these substances do not overlap, the specialists carry out the distinction among the different substances of the image via a thresholding procedure that utilizes the HU value ranges associated to each substance [7,22,30]. The threshold may vary depending on the scanning parameters and environment conditions, though the specialists can adapt such thresholds according to the device and the calibration object.The goal of the “RV Allocation by Substances” procedure is to extract the relevant substances (generally, the HB and LB) from the original RV and copy them to independent VoIs. The remaining substances are considered irrelevant and are copied to another VoI. More precisely, the “RV Allocation by Substances” procedure takes as input an RV, with a dimension of X rows, Y columns, and Z slices. The intensity of a sample within this volume is denoted by RVx,y,z, with the subindices x,y,z indicating the row, column, and slice of the sample. Let S denote a biological substance and VoIS the VoI associated with such substance after the allocation procedure. The size of VoIS is identical to the original RV, with the intensities of those samples corresponding to S being equal as in the original RV. The remaining samples are zeroes. An individual VoI is constructed in this manner for each relevant substance. The last VoI, referred to as VoIIrrel, is constructed containing all samples whose intensities do not correspond with any of the substances of interest. Evidently, the relevant substances can be selected depending on the goals of the specialist. In general, only the HB and LB are relevant, in which case the volumesVoIHB,VoILB, and VoIIrrel are generated.Each VoI is encoded independently, resulting in a single compressed file for each VoI. At the end of the encoding process, all compressed files are encapsulated in a single DICOM-compliant file. As described below, the original RV can be recovered losslessly if all VoIs are encoded and stored losslessly.The original RV is reconstructed in the “RV Reallocation Procedure”. If all the VoIs are decoded, such procedure is performed by adding the VoIs in a sample-by-sample basis. In our previous example the original RV is recovered asRVx,y,z=VoIx,y,zHB+VoIx,y,zLB+VoIx,y,zIrrel. As stated in the introduction, it may happen that only the VoIHB and/or the VoILB are needed. Such a situation occurs when, for instance, the compressed images are stored in a server and the specialist wants to access the data from a remote location. In such a case, only the VoIs containing HB and LB are transmitted, reducing both the latency and the transmitted data.The “RV Allocation by Substances” procedure may cause that the sample intensities within the VoIs contain numerical discontinuities. These discontinuities are produced by the zeroes corresponding to substances stored in other VoIs and may negatively affect the coding performance of the compression system. To partially tackle this issue, an offset operation is applied to all VoIs containing relevant substances. This operation subtracts the minimum HU value minus 1 for each VoIS. The offset process is performed before coding and is inverted after decoding. No offset is employed during the encoding of VoIIrrel, so the corresponding codestream is decoded directly.

@&#CONCLUSIONS@&#
Preclinical micro-computed tomography (microCT) images are employed together with 3D morphometry evaluation for medical research. Typical region-of-interest coding techniques encode the relevant data and disregard the rest, which is not adequate in many medical environments. The method proposed in this paper uses a volume-of-interest coding technique that provides many interesting features for medical applications. First, it identifies the substances of the microCT through a thresholding segmentation technique based on the Hounsfield scale. Second, it allocates the substances in different VoIs, encoding them independently and with any coding system supported in DICOM. And third, it permits the extraction and transmission of only the relevant substances without needing to decode the whole image. Experimental results indicate that the proposed method reduces in more than 90% the stored and/or transmitted data when recovering specific substances of the image. Results also indicate that JPEG2000 is the most convenient codec in such a coding scheme. This work can be easily extended to other imaging modalities and applications that work with the HU scale.