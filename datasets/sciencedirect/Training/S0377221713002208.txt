@&#MAIN-TITLE@&#
A dynamic inventory model with supplier selection in a serial supply chain structure

@&#HIGHLIGHTS@&#
This article provides an inventory model for a serial supply chain with multiple suppliers and time varying demand.The model minimizes the total cost of purchasing, production, inventory setup and holding, and transportation.Considering lead times, necessary feasibility conditions regarding the demand at the last stage are established.Actual transportation costs are modeled by exact piecewise linear functions.Our results show that inventory setup and holding costs can affect supplier selection and order lot sizing decisions.

@&#KEYPHRASES@&#
Serial supply chain,Supplier selection,Dynamic inventory model,Transportation cost,

@&#ABSTRACT@&#
Considering the inherent connection between supplier selection and inventory management in supply chain networks, this article presents a multi-period inventory lot-sizing model for a single product in a serial supply chain, where raw materials are purchased from multiple suppliers at the first stage and external demand occurs at the last stage. The demand is known and may change from period to period. The stages of this production–distribution serial structure correspond to inventory locations. The first two stages stand for storage areas for raw materials and finished products in a manufacturing facility, and the remaining stages symbolize distribution centers or warehouses that take the product closer to customers. The problem is modeled as a time-expanded transshipment network, which is defined by the nodes and arcs that can be reached by feasible material flows. A mixed integer nonlinear programming model is developed to determine an optimal inventory policy that coordinates the transfer of materials between consecutive stages of the supply chain from period to period while properly placing purchasing orders to selected suppliers and satisfying customer demand on time. The proposed model minimizes the total variable cost, including purchasing, production, inventory, and transportation costs. The model can be linearized for certain types of cost structures. In addition, two continuous and concave approximations of the transportation cost function are provided to simplify the model and reduce its computational time.

@&#INTRODUCTION@&#
Manufacturing and distribution systems in today’s competitive markets face a myriad of dynamic challenges that require not only exceptional planning capacity, but also robust supply chain networks with communication and coordination mechanisms that allow the parties involved in such networks to address changes in a short notice. From radical volume changes in customer demand, to variations in prices of raw material and finished products due to currency fluctuations in the global marketplace, to increases in transportation costs due to speculation in the price of crude oil, any number of factors can have a serious effect on corporate revenue projections. In particular, when inventory is stuck in the various stages of the supply chain, the company may be forced to operate at critical cash flow levels. As such, the ability to intelligently address inbound and outbound issues through effective supply chain inventory and distribution strategies not only keeps the wheels of business turning, but it also gives the company a relative advantage over its competitors in being able to address supplier concerns and consumer needs in a way that slower, less agile manufacturers are unable to do.Of the various activities involved in supply chain logistics, purchasing is one of the most strategic because it provides opportunities to reduce costs across the entire supply chain. An essential task within the purchasing process is supplier selection, given that the cost of raw materials and component parts represents the largest percentage of the total product cost in most industries. For instance, in high technology firms, purchased materials and services account for up to 80% of the total product cost (Weber et al., 1991). In contemporary supply chain management, companies maintain long term partnership with suppliers, and use fewer, but more reliable suppliers. The performance of potential suppliers is evaluated against multiple criteria rather than considering a single factor (Ho et al., 2010).Inventory is recognized as one of the major drivers of a supply chain (Ravindran and Warsing, 2013). High inventory levels increase the responsiveness of the supply chain but decrease its cost efficiency because of the cost of holding inventory. Hence, a relevant problem in supply chain logistics is to determine the appropriate levels of inventory at the various stages involved in a supply chain. Given the prevalence of both supplier selection and inventory management decisions in a supply chain, this article addresses both problems simultaneously by studying the production and distribution of a single product or an aggregated unit representing a family of products with similar process plans in a serial supply chain structure. An example of this situation is a manufacturer that purchases raw parts from various preferred suppliers. These raw parts are stored at the manufacturing facility or processed into final products. These products are either stored at the manufacturer level or transported to a warehouse. At the warehouse stage, either products are stored there or transported to a distribution center (DC). In general, the DC may serve products to an entire market area or a set of retailers. Given the possible impact of transportation costs in both supplier selection and inventory replenishment at each stage of the supply chain in today’s enterprises, the proposed mixed integer nonlinear programming (MINLP) model considers purchasing, production, inventory, and transportation costs over a planning horizon with time varying demand considering quality constraints for the suppliers, capacity constraints for suppliers and the manufacturer, and inventory capacity constraints at all the stages.The scenario described above can be viewed as a generalization of one of the most studied problems in production and inventory planning for a single facility, called the dynamic inventory lot-size problem. This basic problem is to determine the production quantities for each period so that all demands are satisfied on time at minimal production and inventory cost. Wagner and Whitin (1958) use dynamic programming to find an exact solution for the uncapacitated version of the problem in polynomial time. Florian and Klein (1971) show how to handle the case of time-independent production capacity. Florian et al. (1980) show that, when the capacity limitation is time-dependent, even for the single item case, the problem is NP-hard.Several authors have considered multi-stage supply chain models under deterministic constant demand. Muckstadt and Roundy (1993) survey and summarize these results. In particular, the sequential structure has been the most common mechanism used to implement optimization on supply chain logistics. In this case, the optimal results obtained for a particular process are used as input to optimize interrelated processes in the supply chain that are considered independent from a modeling point of view. An integrated optimization approach has shown to produce superior solutions for many of the applications. This is the case of supplier selection and lot sizing production in a supply chain. In fact, the literature shows substantial research of these two topics when they are analyzed independently. However, research that covers both topics simultaneously is limited and recent. Basnet and Leung (2005) present one of the first studies where inventory lot sizing is analyzed simultaneously with supplier selection under a dynamic demand environment. They propose an enumerative search algorithm and also a heuristic approach to solve the mixed integer linear programming (MILP) formulation developed for the single stage uncapacitated multiproduct problem. Ustun and Demirtas (2007) propose a mixed integer goal programming model for the single stage lot sizing and supplier selection problem. Additional work has also been performed for the static demand case using some extensions of the economic order quantity (EOQ) model. Mendoza and Ventura (2010) study a serial inventory system with supplier selection and order quantity allocation, where some of the properties of the EOQ model are used to derive a simplified MINLP model for the problem.This article extends previous research developed in inventory lot sizing and supplier selection for a serial supply chain. In particular, the proposed MINLP model solves a dynamic multi-stage single-product capacitated problem. Even though Hoesel et al. (2005) suggest a dynamic programming approach for the multi-stage lot sizing problem in a serial supply chain with production capacities, they neither integrate supplier selection nor consider quality and capacity constrains in their model. Thus, this work intends to cover a novel area of research that has not been studied extensively and, consequently, could allow further research. Our results show that switching suppliers over a predefined planning horizon according to costumer demand may reduce the total cost. These results are consistent with a novel methodology developed by Moalem et al. (2010) for the healthcare industry where the selection of suppliers is affected by the business environment forecast.The remainder of this article is organized as follows. In Section 2, the development of the proposed dynamic inventory model with supplier selection for a serial supply chain is presented. Section 3 gives a general characterization of the transportation freight rates for the less-than-truck load (LTL) mode. Section 4 provides a description of the two freight rate estimate functions considered in this research. In Section 5, a rather simpler MILP version of the proposed model is formulated, where transportation costs are represented by piecewise linear functions. Section 6 describes the illustrative example used in this article, while Section 7 presents the results obtained from the sensitivity analysis performed over some relevant model parameters. Finally, Section 8 provides the conclusions of this research and several new opportunities that have been identified as potential extensions of this work.A dynamic lot-sizing model with supplier selection in a serial supply chain structure is presented in this section. Let J={1,2,…,nJ} be the set of suppliers, K={1,2,…,nK} the set of supply chain stages, S={1,2,…,nS} the set of customers, and T={1,2,…,nT} the set of planning periods. Let l0jbe the number of delivery lead time periods from supplier j∈J to stage 1, and lkthe number of delivery lead time periods from stage k∈K⧹{nK} to stage k+1. Finally, letdstbe the external demand in units of customer s∈S at time t∈T. Let Jt={j∈J:t−l0,j⩾0} be the subset of suppliers that can provide raw materials at period t. Note that at time t only a supplier with a lead time less than t can supply raw material to stage 1.The dynamic serial supply chain with multiple suppliers and customers can be modeled as a general transshipment network GD=(ND,AD), where the set of nodes NDand the set of arcs ADare defined as follows (see Fig. 1):ND=J∪K∪S,andAD={(j,1):j∈J}∪{(k,k+1):k∈K/{nK}}∪{(nK,s):s∈S}.As shown in Fig. 1, stages 1 and 2 represent the raw material and finished product warehouses at the manufacturing facility. KD={2,3,4,…,nK−1} is the set of intermediate warehousing/distribution stages that hold finished products, including the warehouse at stage 2, and nKis the last distribution stage that ships products to customers. Notice that the external demand can be aggregated by consolidating the set of customers into a single demand node nK+1, wheredt=∑s∈Sdstrepresents the external demand in units for all customers at time t∈T. In this case, the distribution process from stage nKto customers for each period t∈T can be treated as a separate problem that can be independently solved.Considering that the dynamic supply chain represented by network GDdoes not show the effect of changes in demand between consecutive time periods, a (time-expanded) static supply chain network is defined and represented by the general transshipment network GS=(NS,AS). In this network, the set of nodes NSand the set of arcs ASare defined as follows:NS={(0,j,t):j∈J,t∈T}∪{(k,t):k∈K,t∈T},andAS={((0,j,t),(1,t+l0j)):j∈J,t∈{1,2,…,nT-l0j}}∪{((k,t),(k+1,t+lk)):k∈K⧹{nK},t∈{1,2,…,nT-lk}}.Note that neither set S nor its aggregated node nK+1 are used in the definition of NS. Similarly, neither initial nor ending inventories are included in the definition of AS. The raw material flow from supplier j in period t is represented as a directed arc connecting nodes (0,j,t) and (1,t+l0j). Likewise, the inventory flow between consecutive time periods t and t+1 at stage k is represented as a directed arc connecting nodes (k,t) and (k,t+1), while the product flow between consecutive stages k and k+1 is represented by a directed arc that connects nodes (k,t) and (k+1,t+lk). In this setting, all initial inventories, raw material and finished product pending orders at every stage k are assumed to be available at the beginning of the first period, and respectively represented byik0,q0j0, andyk-10. In the same way, ending inventories at each stage k are assumed to be available at the end of the last period and are represented byiknT.Considering that the MINLP model will associate a continuous flow variable to each arc in network GS=(NS,AS), a promising approach for reducing the problem size consists of eliminating from the analysis all the arcs and nodes that cannot be used or reached by any feasible raw material or product flow due to the positive lead times and finite planning horizon. Notice that since only unreachable arcs and nodes are eliminated, the original problem can be formulated in a reduced transshipment networkGs′=Ns′,As′, whereNs′⊆NSandAs′⊆AS. After the elimination, the original and reduced problems will have the same optimal solution, but the reduced problem will have fewer variables and be faster to solve than the original problem.In the following theorem, a set of feasible time periods Tkis defined for each stage k∈K, so that a node (k,t) will be considered feasible if and only if k∈K and t∈Tk.Theorem 1For a given stage k∈K, let mkbe either zero or the closest preceding stage with positive initial inventory or pending order, i.e.,mk=max{0,k′:yk′-10+ik′0>0,k′∈{1,…,k}}. Letmk∗be either nKor the closest succeeding stage from stage k with positive ending inventory, i.e.,mk∗=min{nK,k′:ik′nT>0,k′∈{k,…,nK-1}}. In addition, let l0=min{l0j:j∈J}.Finally, lety00=∑j∈Jq0j0. Then, node (k,t) is a feasible node in the (time-expanded) static network if and only if t∈Tk, whereTk=t:1+∑k′=mkk-1lk′⩽t⩽nT-∑k′=kmk∗-1lk′,t∈T.Considering that the total lead time between stages mkand k is given by∑k′=mkk-1lk′, the earliest time t that a flow generated at stage mkcan reach stage k is1+∑k′=mkk-1lk′. In addition, given that the lead time between stages k andmk∗is∑k′=kmk∗-1lk′, the latest time t∈Tkin which a flow sent from stage k can arrive at stagemk∗by time nTisnT-∑k′=kmk∗-1lk′. On the other hand, given that nodek,1+∑k′=mkk-1lk′can always send a product flow to any node (k,t), where1+∑k′=mkk-1lk′<t<nT-∑k′=kmk∗-1lk′, then any intermediate node between nodesk,1+∑k′=mkk-1lk′andk,nT-∑k′=kmk∗-1lk′will also be feasible. Therefore, at any stage k∈K, a node (k,t) is a feasible node if t∈Tk.On the other hand, since the lead time from stage mkto stage k is∑k′=mkk-1lk′, it is straightforward to show that a node (k,t) with1⩽t<1+∑k′=mkk-1lk′will not be feasible. Similarly, since the lead time between stages k andmk∗is∑k′=kmk∗-1lk′, a flow generated in stage k at time t,nT-∑k′=kmk∗-1lk′<t<nT, will always be received at stage nKafter period nT.□Based on Theorem 1, the following corollary states a similar result that identifies the sets of feasible time periods for raw material orders submitted by the suppliers.Corollary 1.1A raw material order submitted by the manufacturing stage (stage 1) to a given supplier j∈J at time t will be feasible if and only if t∈T0j, whereT0j={t:1⩽t⩽max{t′∈T1}-l0j}.Even though a raw material order from supplier j∈J to the manufacturer stage (stage 1) can always be shipped in period 1, considering that the delivery lead time defined for supplier j is l0j, the latest time that an order from supplier j can be shipped is max{t′∈T1}−l0j; otherwise, it would be received during an infeasible time period.□Considering the lead times at the different stages of the supply chain network, necessary feasibility conditions regarding the demand at stage nKcan be established for the dynamic supplier selection and inventory planning problem. These conditions are stated in the following lemma and theorem.Lemma 1For a given stage k∈K, if node (k,1) is connected to node (nK,t) at the demand stage nKin period t∈Tk, then every node(kˆ,1), such thatk⩽kˆ⩽nK, is also connected to node (nK,t).Since the total lead time between stageskˆand nKis given by∑k′=kˆnK-1lk′, nodekˆ,t-∑k′=kˆnK-1lk′is connected to node (nK,t). However, since a product flow can be sent from node(kˆ,1)to nodekˆ,t-∑k′=kˆnK-1lk′, node(kˆ,1)is always connected to nodekˆ,t-∑k′=kˆnK-1lk′. Consequently, through this node, node(kˆ,1)is also connected to the demand node (nK,t).□The supply chain inventory problem with supplier selection can only be feasible if for every demand node (nK,t),1+∑k′=mnKnK-1lk′⩽t<1+∑k′=0nK-1lk′, the following condition holds:∑k′=ktnKyk′-10+ik′0-∑t′=1t-1dt′⩾dt,where,kt=minnK,k∈K:∑k′=knK-1lk′<t.Based on Theorem 1, the first feasible node at stage nKis given bynK,1+∑k′=mnKnK-1lk′.In addition, considering that the total lead time from stage 0 to stage nKis∑k′=0nK-1lk′, the first node at stage nKthat can be directly supplied with finished products produced by new raw material orders is given bynK,1+∑k′=0nK-1lk′.Consequently, any demand node (nK,t), with1+∑k′=mnKnK-1lk′⩽t<1+∑k′=0nK-1lk′, can only be supplied from initial inventory or pending orders. Given that node (kt,1) is connected to node (nK,t), by Lemma 1, node(kˆ,1), forkt⩽kˆ⩽nK, is also connected to node (nK,t).Thus, the accumulated initial inventory and pending orders accessible to node (nK,t) can be calculated as∑k′=ktnKyk′-10+ik′0.Moreover, the cumulative demand prior to time t can be calculated as∑t′=1t-1dt′.Therefore, the maximum possible available inventory before attempting to satisfy demand at stage nKin period t is given by∑k′=ktnKyk′-10+ik′0-∑t′=1t-1dt′.Consequently, to achieve feasibility at node (nK,t), it is necessary to satisfy the demandrequirement:∑k′=ktnKyk′-10+ik′0-∑t′=1t-1dt′⩾dt.Otherwise, the problem is infeasible.□An illustration of a static supply chain network with three suppliers (nJ=3), five stages (nK=5), and a planning horizon of six periods (nT=6) is presented on Fig. 2. As shown in the figure, the lead times are positive for suppliers 2 and 3, and stages 3 and 4, where orders are delivered one time unit (period) after they are submitted, i.e., l02=l03=l3=l4=1. In this problem, assuming zero initial and ending inventories, and no pending orders, mk=0 andmk∗=6for each stage k∈K. Thus, the feasible sets of time periods Tkfor each stage k∈K can be determined by applying Theorem 1. In this illustration, T1=T2=T3={1,…,nT−l3−l4}={1,2,3,4}, T4={1+l3,…,nT−l3}={2,3,4,5}, and T5={1+l3+l4,…,nT}={3,4,5,6}. Similarly, applying Corollary 1, sets T0j, j∈J, are defined as T01={1,…,nT−l3−l4}={1,2,3,4} andT02={1,…,nT-l02-l3-l4}={1,2,3}, andT03={1,…,nT-l03-l3-l4}={1,2,3}. Consequently the reduced networkGs′=Ns′,As′can be defined as follows:Ns′={(0,j,t):j∈J,t∈T0j}∪{(k,t):k∈K,t∈Tk},andAs′={((0,j,t),(1,t+l0j)):j∈J,t∈T0j}∪{((k,t),(k+1,t+lk)):k∈K⧹{nK},t∈Tk}.The lists of remaining parameters, decision variables, and cost function components for the dynamic production planning problem are provided below.Remaining parametershktunit holding cost at stage k from period t to period t+1, k∈K, t∈Tk.b0jtcapacity (in units) of supplier j at time t, j∈J, t∈T0j.b1tproduction capacity (in units) at stage 1 in period t, t∈T1.bktdistribution capacity at stage k in period t (in units), k∈K, t∈Tk.rkinventory capacity (in units) at stage k, k∈K.p0jtunit price of raw material for supplier j in period t, j∈J, t∈T0j.p1tunit production cost in period t, t∈T1.f0jtsetup cost for an order submitted to supplier j in period t, j∈J, t∈T0j.f1tsetup cost for production at stage 1 in period t, t∈T1.fktsetup cost at stage k in period t, k∈KD, t∈Tk.ajperfect rate of supplier j (probability that a unit is acceptable), j∈J.aminimum acceptable perfect rate.Decision variablesq0jtreplenishment order quantity (in raw material units) shipped from supplier j to stage 1 in period t, j∈J, t∈T0j.x1tproduction lot size (in units of finished product) at the manufacturing stage (stage 1) at the beginning of period t, t∈T1.yktreplenishment order quantity (in units of finished product) shipped from stage k to stage k+1 in period t, k∈KD, t∈Tk.iktinventory level (in units) held at stage k from period t to period t+1, k∈K, t∈Tk.w0jt1 if supplier j receives a replenishment order at time t; 0 otherwise; j∈J, t∈T0j.w1t1 if a production order is submitted at time t; 0 otherwise; t∈T1.wkt1 if a replenishment order is shipped from stage k to stage k+1 at time t; 0 otherwise; k∈KD, t∈Tk.Cost Function componentss0jtq0jtpurchasing cost ofq0jtunits purchased from supplier j in period t, j∈J, t∈T0j.c1tx1tproduction cost ofx1tunits at stage 1 in period t∈T1.hktiktinventory holding cost ofiktunits stored at stage k from period t to period t+1, k∈K, t∈Tk.u1jtq0jtholding cost for in-transit inventory ofq0jtunits shipped from supplier j (stage 0) to stage 1 for periods t to t+l0j−1, j∈J, t∈T0j. It is calculated as∑t′=tt+l0j-1h1t′q0jt.uk+1tyktholding cost for in-transit inventory ofyktunits shipped from stage k to stage k+1 for periods t to t+lk−1, k∈KD, t∈Tk. It is calculated as∑t′=tt+lk-1hk+1t′ykt.g0jtq0jttransportation cost ofq0jtunits of row material shipped from supplier j to stage 1in period t, j∈J, t∈T0j.gktykttransportation cost ofyktunits of product shipped from stage k to stage k+1 in period t, k∈KD, t∈Tk.Given that purchasing, production, inventory, and transportation cost functions are defined as general expressions, the problem can be formulated as an MINLP, where the objective is to minimize the total cost over nTplanning periods:(P1)(1)MinimizeZ=∑j∈J∑t∈T0js0jtq0jt+∑t∈T1c1tx1t+∑k∈K∑t∈Tkhktikt+∑j∈J∑t∈T0ju1jtq0jt+∑k∈KD∑t∈Tkuk+1tykt+∑j∈J∑t∈T0jg0jtq0jt+∑k∈KD∑t∈Tkgktykt,**** subject to(2)∑j∈Jtq0jt-l0j+i1t-1=x1t+i1t,t∈T1,(3)x1t+i2t-1=y2t+i2t,t∈T2,(4)yk-1t-lk-1+ikt-1=ykt+ikt,k∈KD⧹{2},t∈Tk,(5)ynK-1t-lnK-1+inKt-1=dt+inKt,t∈TnK,(6)∑j∈Jtajq0jt-l0j⩾a∑j∈Jtq0jt-l0j,t∈T1,(7)q0jt⩽b0jtw0jt,j∈J,t∈T0j,(8)x1t⩽b1tw1t,t∈T1,(9)ykt⩽bktwkt,k∈KD,t∈Tk,(10)ikt⩽rk,k∈K,t∈Tk,(11)ikt⩾0,k∈K,t∈Tk,(12)q0jt⩾0,w0jt∈{0,1},j∈J,t∈T0j,(13)x1t⩾0,w1t∈{0,1},t∈T1,(14)ykt⩾0,wkt∈{0,1},k∈KD,t∈Tk.This formulation has been written with respect to the reduced static networkGs′. The total cost for all nTperiods is minimized while satisfying all the demand on time. Eq. (1) represents the total variable cost function, which includes raw material purchasing, production, inventory, and transportation costs for nTperiods. Notice that no transportation cost is considered between stages 1 and 2, since all these flows occur internally in the manufacturing facility. Set of Eq. (2) guarantees flow balance between raw material and finished product at the manufacturing level. Note that when 1∈T1 then∑j∈Jq0j0+i10>0, otherwise∑j∈Jq0j0+i10=0. For simplicity of exposition and without loss of generality, a bill of materials (BOM) ratio equal to one is assumed at the manufacturing stage. Consequently one unit of raw material is required for each unit of finished product. Sets of Eqs. (3)–(5) assure that the balance of finished products between consecutive stages of the supply chain is satisfied, ensuring that customer demand is completely satisfied in each period of the planning horizon. Observe in Eq. (3), when 1∈T2 thenx10+i20>0; otherwise,x10+i20=0. Similarly, in Eqs. (4) and (5), when 1∈Tkthenyk-10+ik0>0; otherwise,yk-10+ik0=0. Set of constraints (6) guarantees that, at each period, the average rate of raw material units of acceptable quality received from the suppliers is greater than or equal to the minimum acceptable perfect rate set by the manufacturer. Sets of bounds (7)–(9) represent the capacity constraints for suppliers, manufacturing, and transportation, respectively. Set of constraints (10) defines the inventory capacity at each stage in the supply chain. Finally, sets of constraints (11)–(14) describe the nature of the variables considered in the model.Notice that purchasing and production costs usually have a setup component and a linear component, which can be respectively expressed as follows:(15)s0jtq0jt=f0jtw0jt+p0jtq0jt,and(16)c1tx1t=f1tw1t+p1tx1t.On the other hand, inventory holding cost functions are frequently assumed to be linear, and can be represented in this manner:(17)hktikt=hktikt.Consequently, in-transit holding cost functions can be expressed as follows:(18)u1jt(q0jt)=∑t′=tt+l0j-1h1t′q0jt=u1jtq0jt,and(19)uk+1t(ykt)=∑t′=tt+lk-1hk+1t′ykt=uk+1tykt,whereu1jt=∑t′=tt+l0j-1h1t′anduk+1t=∑t′=tt+lk-1hk+1t′represent unit holding costs for in-transit inventory from supplier j to stage 1 and from stage k to stage k+1, respectively.Most manufacturing companies rely on third-party providers for the transportation of products through their supply chain (Chan et al., 2002). Assuming trucks as the common means of transportation, freight can be transported using full-truck-load (TL) or less-than-truckload (LTL) options. Even though, TL is frequently the less expensive transportation option, when other supply chain costs are simultaneously considered in the analysis, the LTL option can provide more flexibility in the definition of the optimal order size to allow reduction of the overall supply chain cost. This situation is especially true, when the shipment sizes are relatively small. According to Swenseth and Godfrey (2002), TL rates are usually expressed on a per-mile basis, while LTL rates are commonly expressed per hundredweight (CWT), defined for a given origin and destination. Justifiably, LTL transportation cost functions are similar to ordering cost functions for inventory replenishment with quantity discounts. The two most commonly used order quantity discount structures are the incremental and all-unit discounts. In both cases quantity discounts are obtained as a result of economies of scale. Although both quantity discount structures result in ordering cost functions that are piecewise linear, only incremental quantity discount functions are concave.Today’s market is characterized by small shipment sizes, which can be modeled using the LTL transportation option. In fact, as a result of increasing product customization, the number of stock-keeping units has dramatically increased during the last two decades, pushing for more frequent shipments. Customer service considerations have also played an important role, promoting decentralized distribution networks, where fewer customers are served per DC (Spiegel, 2002). Considering that the all-unit discount transportation cost strategy is widely used to stimulate demand for larger and more profitable shipments in the LTL transportation mode, this strategy has been selected to incorporate the transportation costs in Model (P1) and can be described as follows:(20)gˆ(q)=0,ifq=0,α1,if0<q<β1,α2q,ifβ1⩽q<β2,α3q,ifβ2⩽q<β3,⋮⋮αnq,ifβn-1⩽q<βn,αn+1,ifβn⩽q⩽βn+1,where q is the shipment size, β0=0<β1<β2<⋯<βn<βn+1are the breakpoints, α1 is the fixed shipment cost for 0<q<β1, αiis the unit shipping cost for the order quantity q, when if βi−1⩽q<βi, for i=2,⋯,n, and αn+1 is the fixed shipment cost for βn⩽q⩽βn+1. Notice that α2>α3>⋯>αn>0, α2β1=α1, and αnβn⩾αn+1. Thus, the total transportation cost for q units is calculated as:(21)g(q)=min{gˆ(q),gˆ(βi)},whereβi-1⩽q<βi.This function considers the situation where it may be advantageous to declare βiunits, even though only q units are effectively transported. This concept, commonly known as over-declaring, is frequently used in practice to take advantage of cost reductions obtained by shipping larger sizes. In this case, cost functions are characterized by indifference points, where any number of shipping units beyond these points pays an LTL freight rate corresponding to next range by over-declaring the shipment size. Thus, shipments are artificially increased to the next higher shipment breakpoint, resulting in a lower total cost (Swenseth and Godfrey, 1996). As an illustration, Table 1presents the LTL freight rates defined for a specific origin and destination. These rates could represent the transportation cost between a specific supplier and the manufacturing facility. Nominal freight rates represent the rates as stated by the LTL carrier, while actual freight rates represent the transportation costs obtained after the concept of over-declaring has been applied. Notice that even though LTL rates are usually expressed in CWT (Swenseth and Godfrey, 2002), for simplification of this illustration, freight rates are expressed in per unit of raw material or finished product. Nominal and actual freight rates are characterized by a minimum and maximum number of units. Subsequent freight ranges are defined by a progressive reduction of the variable rates. As an example of the actual freight rates calculation, let us consider the first three nominal rates given by ranges [1,31], [32,62], and [63,124] in units. Using the graphical representation provided in Fig. 3, it is possible to notice that the total transportation cost given for the range [49,62] is higher than the total cost obtained when 63 units are declared. Therefore, any shipping size between 49 and 62 units can be over-declared to 63 units to obtain a reduced total transportation cost.Once all the indifference points are found, actual freight rates are calculated as they are presented in Table 1. These rates alternate between ranges of a constant charge per unit followed by a fixed charge. The fixed charge is the result of over-declaring a LTL shipment to the next LTL transportation range. A graphical representation of actual freight rates is presented in Fig. 4. Notice that although this function is continuous, it is non-differentiable due to the break and indifference points. Natarajan (2007) states that, when actual freight rates are incorporated into analytical models, two problems may arise. First, the determination of the exact rates between every origin and destination can become time consuming and expensive. Second, given that freight rates are function of the volume shipped, transportation cost functions are generally step functions. For similar reasons, several researchers have proposed the use of continuous functions to estimate actual freight rates that are also differentiable. In this direction, Section 4 presents two continuous functions that can be used to incorporate transportation costs in model (P1).Since the actual LTL transportation cost functions are piecewise linear and non-concave, power and quadratic functions are used to estimate the transportation costs. Both approximation functions are concave and differentiable.Tyworth and Ruiz-Torres (2000) recommend the use of a power approximation function to model the LTL transportation mode. In this case, the unit shipment cost is approximated as a function of the order quantity q:(22)Fp(q)=a(q)b,where a>0 and −1<b<0 correspond to the coefficients of the nonlinear regression function. However, as indicated by Ventura and Mendoza (2008), given that Eq. (22) can also be represented by Eq. (23), the coefficients a and b can be easily found by fitting a simple linear regression model.(23)ln(Fp(q))=ln(a)+bln(q).Notice that in the all-unit discount strategy, the unit transportation cost decreases as the number of units increases. Thus, Fp(q) is a strictly decreasing function for q⩾0. Furthermore, since the transportation cost can be calculated by multiplying the number of transported units by the corresponding unit cost, the resulting transportation cost function, q·Fp(q), will be concave.As an alternative method, our experimental results have shown that a simple quadratic approximation function can also be used to estimate the freight rates for the LTL transportation mode as a function of the order quantity q:(24)Fq(q)=a+bq+cq2,where a>0, b>0, and c⩾0 correspond to the coefficients of the linear regression function. Using the actual freight rates presented in Table 1, the total transportation cost functions generated from the unit cost power and quadratic approximation functions are plotted in Fig. 5. Both functions are simultaneously plotted to allow a graphical comparison with the actual freight cost. A simple inspection of Fig. 5 clearly shows that the quadratic function provides a better approximation of the actual freight costs than the traditional power function.Considering the nonlinear characteristics of the power and quadratic approximation functions, modeling transportation costs through any of these two alternatives makes Model (P1) nonlinear. In addition, since economies of scale are assumed for transportations costs, both approximation functions are concave. Thus, when the remaining components of the objective function are represented by linear functions, as shown by sets of Eqs. (15)–(19), Model (P1) consists of a concave objective function and linear constraints, which is a well known NP-hard problem (Benson, 1995; Pardalos and Schnitger, 1988). In this type of problems, even in seemly simple cases, there can be an exponential number of local minima, making the problem computationally difficult to solve to optimality (Horst et al., 2000). Moreover, given that transportation costs are estimates of the actual costs, it cannot be guaranteed that the optimal solution of Model (P1) will be the same than the optimal solution for the original problem. Thus, in this section, an MILP version of Model (P1) is presented, where purchasing, production, inventory holding, in-transit inventory are assumed to be linear and represented by Eqs. (15)–(19). In addition, transportation costs are represented by exact piecewise linear functions, as shown in Fig. 6.LetR0j={1,2,…,nR0j}be the set of freight ranges of the transportation cost function from supplier j to stage 1. Similarly, letRk={1,2,…,nRk}be the set of freight ranges for the transportation cost between stages k and k+1. Notice that in both cases, freight rates alternate between ranges of a fixed charge followed by a constant charge per unit. Thus, both sets R0jand Rkcan be partitioned in the respective freight range sets of fixed charge (R0jfandRkf) and constant charge per unit (R0jcandRkc), such thatR0j=R0jf∪R0jcandRk=Rkf∪Rkc. Let qrbe a flow variable, which assumes the value of the respective replenishment order quantity q, when it falls in transportation range r, and is 0 otherwise. Let βr−1 and βrbe the respective lower and upper bounds for range r, and φra binary variable denoting whether (φr=1) or not (φr=0) the transported volume falls in range r. Notice that β0=0 andβnRcan be set to the maximum shipping capacity. As an illustration, let us consider the transportation cost function in Fig. 6, where β3⩽q4<β4. In this case φ4=1, and φr=0 for r=1, 2, 3 and 5. Similarly, q4=q and qr=0, for r=1, 2, 3 and 5.In order to redefine Model (P1), letβ0jr-1andβ0jrdenote the lower and upper limits for range r on the transportation cost function associated with supplier j. Similarly, letβkr-1andβkrdenote the respective lower and upper limits for range r on the cost function associated with transportation from stage k to stage k+1. Thus, following an approach similar to the one developed by Balarkrishnan and Graves (1989), and Simchi-Levi et al. (2005), Model (P1) can be rewritten as an MILP model, according to the following formulation:Additional parametersv0jrFixed charge for the actual freight rate for supplier j when order quantity falls in range r,j∈J,r∈R0jf.vkrFixed charge for the actual freight rate from stage k to stage k+1 if order quantity falls in range r,k∈KD,r∈Rkf.e0jrConstant charge per unit for the actual freight rate for supplier j when order quantity falls in range r,j∈J,r∈R0jc.ekrConstant charge per unit for the actual freight rate from stage k to stage k+1 if order quantity falls in range r,k∈KD,r∈Rkc.Additional variablesφ0jt,r1 if the replenishment order quantity (in units of raw material) sent from supplier j to stage 1 in period t falls in transportation range r; 0 otherwise; j∈J, t∈T0j, r∈R0j.φkt,r1 if the order quantity (in units) sent from stage k to stage k+1 in period t falls in transportation range r; 0 otherwise;k∈KD∪{nK}, t∈Tk, r∈Rk.q0jt,rdefined asq1jtwhen replenishment order quantity (in units of raw material) shipped from supplier j in period t falls in transportation range r; 0 otherwise; j∈J, t∈T0j, r∈R0j. Notice thatq0jt=∑r∈R0jq0jt,rykt,rdefined asyktwhen replenishment order quantity (in units of finished product) shipped from stage k to stage k+1 in period t falls in transportation range r; 0 otherwise; k∈KD, t∈Tk, r∈Rk. Notice thatykt=∑r∈Rkykt,r.(P2)(25)MinimizeZ=∑j∈J∑t∈T0jf0jtw0jt+p0jt∑r∈Rq0jt,r+∑t∈T2f1tw1t+p1tx1t+∑k∈K∑t∈Tkhktikt+∑j∈J∑t∈T0ju1jt∑r∈Rojq0jt,r+∑k∈KD∑t∈Tkuk+1t∑r∈Rkykt,r+∑j∈J∑t∈T0j∑r∈R0jfv0jrφ0jt,r+∑j∈J∑t∈T0j∑r∈R0jce0jrq0jt,r+∑k∈KD∑t∈Tk∑r∈Rkfvkrφkt,r+∑k∈KD∑t∈Tk∑r∈Rkcekrykt,rsubject to(2-14)Sets of constraints(26)q0jt,r-β0jrφ0jt,r⩽0,j∈J,t∈T0j,r∈R0j,(27)q0jt,r-β0jr-1φ0jt,r⩾0,j∈J,t∈T0j,r∈R0j,(28)ykt,r-βkrφkt,r⩽0,k∈KD,t∈Tk,r∈Rk,(29)ykt,r-βkr-1φkt,r⩾0,k∈KD,t∈Tk,r∈Rk,(30)∑r∈R0jφ0jt,r⩽1,j∈J,t∈T0j,(31)∑r∈Rkφkt,r⩽1,k∈KD,t∈Tk,(32)q0jt,r⩾0,φ1jt,r∈{0,1}j∈J,t∈T0j,r∈R0j,(33)ykt,r⩾0,φkt,r∈{0,1}k∈KD,t∈Tk,r∈Rk,The objective function in Eq. (25) represents the total variable cost function which includes purchasing, production, inventory holding, in-transit inventory and transportation costs. Replenishment order quantity variables are disaggregated according to the freight ranges. Transportation cost functions are represented by piecewise linear functions, where freight rates alternate between ranges of constant charge per unit, followed by a fixed charge. Notice that sets of Eqs. (15)–(19) are used to define purchasing, production, inventory holding and in-transit inventory cost functions in the objective function. Sets of constraints (2)–(14) are defined as in Model (P1), except that order quantities are disaggregated:q0jt=∑r∈R0jq1jt,randykt=∑r∈Rkykt,r. Sets of constraints (26)–(29) guarantee that the order quantities fall in the corresponding freight range. Sets of constraints (30) and (31) assure that at most one freight range is active for each order quantity. Finally, sets of constraints (32) and (33) describe the nature of the variables considered in the model.In this section, a three stage serial supply chain example with three suppliers and six time periods is presented and analyzed. Similar to Ghodsypour and O’Brien (2001), and Mendoza and Ventura (2010), linear functions are defined for purchasing, production, and holding costs. Three alternative functions are considered to model the LTL transportation costs. In the first case, transportation costs are modeled with a piecewise linear function, which enables an exact representation of the actual costs in the MILP model. In the other two cases, transportation costs are modeled using power and quadratic approximation functions, which are estimates of the actual transportation costs. Thus, Model (P2) is used as benchmark to measure the performance of the transportation cost approximations in Model (P1).The illustrative example includes three potential suppliers, one manufacturer and one DC. While raw materials can only be stocked at the manufacturing stage, finished products can be stored at both the manufacturing and distribution stages. Zero delivery lead times are assumed for all stages and suppliers. Consequently, products arrive in the same time period in which they are ordered. No initial and ending inventories are considered for the problem, and neither pending orders. The minimum acceptable perfect rate for raw materials is assumed to be a=0.95. Thus, 95% of the mix of raw materials purchased at each period need to be of acceptable quality.At the supplier level, it is assumed that the three suppliers have been already screened from a larger set of potential suppliers. This selection could have been done using the Analytical Hierarchy Process, as suggested by Mendoza et al. (2008), or following any other suitable method. The transportation costs structures used in this example are similar to those considered by Swenseth and Godfrey (2002), Natarajan (2007), and Ventura and Mendoza (2008). Nominal and actual freight rates for suppliers 1, 2 and 3 are provided in Tables 1, 7 and 8, respectively (see Section 3 and Appendix A). Similarly, freight information is also provided for interplant transportation (manufacturing facility to DC) in Table 9. From the graphical representation of the respective LTL cost functions (see Fig. 7), it is possible to observe that while supplier 2 has the most expensive transportation cost, interplant shipments happen to use the less expensive route.Even though it is assumed that all the suppliers may be potentially selected to procure raw materials, they do not necessarily have the same characteristics in terms of ordering costs, perfect rate, and capacity (see Table 2). For instance, note that although supplier 1 has the lowest setup and variable costs, considering that its perfect rate is below the minimum acceptable rate, it can only be selected as part of a mix with the other two suppliers. In contrast, even if supplier 2 has lower fixed and variable ordering costs than supplier 3, in an optimal solution this advantage could be offset by higher transportation costs associated with the other two alternatives (see Fig. 7).The analysis was performed over a 6 period planning horizon with time varying customer demand (see Table 3). Capacity constraints were only considered at the production stage, where the capacity was assumed to be fixed for the entire planning horizon. Given the anticipated inflation expected in the second half of the planning horizon, production and DC setup costs were accordingly increased. Furthermore, as a result of seasonality factors, variable production costs were increased for periods 3 and 4. Inventory holding costs were considered constant throughout the entire planning horizon, only depending on the stage and product characteristic (raw material or finished product).Based on the information about actual freight rates for suppliers and interplant transportation, power and quadratic freight approximation functions were fitted using Minitab version 15 (MINITAB, 2009). The results are provided in Table 4. Notice that most of the coefficients of determination (R2) are greater than 0.94, with the only exception of the power estimate function for supplier 2. Considering the values of R2, the quadratic function always provides the best fit for the actual freight rates.Similar to the display of transportation cost functions for supplier 1 presented in Fig. 7, graphical comparisons of power and quadratic estimate functions against the actual freight rates for suppliers 2 and 3, and interplant transportation are provided in Fig. 8 (see Appendix B). Even though both estimate functions show to be good approximations of the actual freight rates, the power function appears to be less accurate than the quadratic function. That observation is particularly apparent for shipment sizes above 2000 units, where the power function overestimates the actual freight rates. In both cases, the major estimation errors are produced for shipment sizes between 400 and 2000 units.The illustrative example was implemented on GAMS 21.7 (Rosenthal, 2007) on a Pentium 4 with 3.40gigahertz and 1gigabytes of RAM. The MILP model was solved using CPLEX 11.0 provided by GAMS. A maximum allowed gap of 0.001% between the LP relaxation and the optimal integer solution was defined as stopping criteria for the branch and bound algorithm. The MINLP models generated by the power and quadratic approximation functions were solved using the DICOPT algorithm also provided by GAMS. The maximum CPU time to solve all the instances of the illustrative example was less than 5seconds.Fourteen different cost scenarios were analyzed, in order to capture the effect of holding and production/distribution setup costs over raw material supply decisions. A summary of the results for the different scenarios is shown in Table 5, where changes in cost parameters are expressed as percentage of their respective original values. Considering the inverse effect of setup and inventory holding costs on order quantities, in order to avoid the neutralization result of these two parameters, when holding costs were increased, setup costs were either maintained or decreased. Similarly, when holding costs were decreased, setup costs were maintained or increased.The illustrative example was solved using three alternative formulations, two MINLP models, where transportation cost were approximated through power and quadratic transportation cost functions, and an MILP model, where transportation costs were represented by an exact piecewise linear function. After the three alternative model formulations were solved for each instance of the problem, transportation costs were recalculated for the two optimal MINLP solutions using the actual freight rates defined for the problem. The optimal solutions for the MILP model and the two updated solutions for the MINLP models are provided in columns 5–7 of Table 5. In addition, transportation cost errors for the power and quadratic functions were calculated as the percentage deviation from the actual transportation costs for the fourteen cost scenarios. These results, given in the last two columns of the table, indicate that the power estimate function systematically underestimates the actual transportation cost, and the quadratic estimate function overestimates the actual freight costs. The averages of the absolute transportation cost errors for the power and quadratic estimate functions are respectively 3.1% and 2.2%. Consequently, the apparently better fitting shown by the quadratic estimate function over the power estimate function (see R2 in Table 4) was ratified when the functions were implemented into the MINLP model.Given that the optimal solution of the MILP model is the benchmark solution for the problem, the gap of a solution obtained from the MINLP model using a transportation cost approximation function is equal to the difference between the optimal objective function values of the MINLP and MILP models. The gaps for the power and quadratic estimate functions for the fourteen cost scenarios, written as a percentage of the optimal MILP solutions, are given in columns 8 and 9 of Table 5. Note that, in almost all the cases, the gap observed with the quadratic approximation model is substantially lower than the gap obtained with the power approximation model. In fact, the average gap obtained with the power function is more than twice larger than the average gap observed with the quadratic approximation model (1.2% vs. 0.5%). As it was expected, both alternatives models did not reach the global optimal solutions as a consequence of the inaccuracy associated with the estimation of the actual freight costs.Under the original cost structure (scenario 1, Table 6), the optimal solution for the MILP model allocated approximately 42% of the total purchased raw material (3200 of 7500 units) to supplier 3. This situation can be explained by the relative low transportation cost of this supplier for medium lot size orders (see Fig. 7), which compensates its relatively high ordering cost. It was also ratified that changes on holding and setup costs may affect the optimal sourcing strategy for the problem. In fact, that situation was observed for all three models, where the optimal raw material order policy changed depending of the inventory holding and setup cost scenario. Even though, the MILP model solution provided the most stable raw material sourcing strategy (among the fourteen scenarios), the original solution was also affected when holding and set up costs were changed (see Table 6). In the optimal solution for the MILP model, when holding costs were reduced (scenarios 2, 5, 6, 8 and 13), the total number of orders was decreased and consequently the average raw material lot size was increased (see Table 6, column b). In this case, the reduction in holding costs triggered a reduction of the number of orders and as a result a decrease in total raw material set up cost. In contrast, changes in production and distribution set up cost affected the decisions related with order allocation by supplier. In particular, when setup costs were reduced (scenarios 10, 11, 12 and 14), the volume allocated to supplier 3 was increased in the optimal solution for the MILP model. In addition, raw material was ordered in every period under consideration (see Table 6, column a), enabling the reduction production and distribution lot sizes, and consequently the respective holding costs. Even though it may appear that production and distribution lot sizing decisions are unrelated to the raw material ordering policy, the selection of suppliers was affected by changes in production/distribution lot size orders. In fact, given the acceptable perfect rate and low transportation cost of supplier 3, this supplier was preferred under a scenario of small production/distribution lot sizes. On the other hand, due to the relative high transportation cost of supplier 2, this supplier was not a competitive alternative when lot sizes were reduced. Finally, given that the perfect rate of supplier 1 is lower than the minimum acceptable rate for the problem, this supplier could only be selected in combination with any of the other two suppliers; however, this strategy was competitive under a scenario of reduced production/distribution lot size orders.

@&#CONCLUSIONS@&#
In this research work, alternative mathematical programming formulations have been developed for the dynamic inventory problem with supplier selection in a serial supply chain. Particular attention has been given to the analysis of the characteristic of the (time-expanded) static network to identify unreachable arcs and nodes that can be eliminated from the network in order to reduce the size of the problem.Considering the all-units quantity discount structure of the actual transportation costs, power and quadratic functions have been used to approximate the actual costs in the proposed MINLP model. These approximations have been used because the actual costs are piecewise linear and non-concave. However, given the inaccuracies and increased complexities that these estimate functions introduce into the model, an exact piecewise linear formulation has also been developed and incorporated into an MILP model. Our results show that the transportation cost approximations may lead to suboptimal solutions for the problem. In particular, power and quadratic functions produced average transportation cost errors of 3.1% and 2.2% in relation to the actual transportation costs for their respective optimal solutions. Similarly, when the optimal solutions for the power and quadratic functions are compared with the optimal solution obtained with the MILP model (piecewise linear approximation), average solution gaps of 1.2% and 0.5% are obtained. Consequently, when the estimated functions are used for the transportation costs under an all-unit discount structure, the analyst needs to be aware of potential solution gaps that cannot be easily detected without an alternative exact model formulation.According to our results, inventory holding and production/distribution setup costs seem to have a significant impact on raw material supplier selection and order lot sizing decisions. Even though these parameters may not appear directly related with raw material supplier decisions, the analysis of fourteen different cost scenarios show that they play an important role in the optimal sourcing policy. These results demonstrate the need to develop integrated models to correctly minimize the total cost of the entire supply chain network.Considering that the current analysis has been performed for a single product problem, a natural extension of the current research is to extend the proposed models to a multi-product setting. In particular, it could be important to consider additional economies of scale provided by joint replenishment and transportation costs. Finally, considering that uncertainty is a common factor in most of the actual production environments, it could be highly useful to evaluate the impact of uncertainty in some of the relevant parameters of the model.