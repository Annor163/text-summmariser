@&#MAIN-TITLE@&#
A two-level self-adaptive variable neighborhood search algorithm for the prize-collecting vehicle routing problem

@&#HIGHLIGHTS@&#
A two-level self-adaptive variable neighborhood search algorithm is developed based on the two levels of decisions in the PCVRP, namely the selection of customers and the vehicle scheduling of selected customers.The neighborhood sequence can be self-adaptively changed based on the analysis of the search history.A graph extension method is adopted to obtain the lower bound for PCVRP by transforming the proposed mixed integer programming model of PCVRP into an equivalent traveling salesman problem model.

@&#KEYPHRASES@&#
Vehicle routing,Two-level variable neighborhood search,Self-adaptive mechanism,

@&#ABSTRACT@&#
This paper investigates the prize-collecting vehicle routing problem (PCVRP), which has a strong background in practical industries. In the PCVRP, the capacities of all available vehicles are not sufficient to satisfy the demands of all customers. Consequently it is not a compulsory requirement that all customers should be visited. However, a prize can be collected once a customer is visited. In addition, it is required that the total demands of visited customers should reach a pre-specified value at least. The objective is to establish a schedule of vehicle routes so as to minimize the total transportation cost and at the same time maximize the prize collected by all vehicles. The total transportation cost consists of the total distance of vehicle routes and the sum of vehicles used in the schedule. To solve the PCVRP, a two-level self-adaptive variable neighborhood search (TLSAVNS) algorithm is developed according to the two levels of decisions in the PCVRP, namely the selection of customers to visit and the visiting sequence of selected customers in each vehicle route. The proposed TLSAVNS algorithm is self-adaptive because the neighborhoods and their search sequence are determined automatically by the algorithm itself based on the analysis of its search history. In addition, a graph extension method is adopted to obtain the lower bound for PCVRP by transforming the proposed mixed integer programming model of PCVRP into an equivalent traveling salesman problem (TSP) model, and the obtained lower bound is used to evaluate the proposed TLSAVNS algorithm. Computational results on benchmark problems show that the proposed TLSAVNS algorithm is efficient for PCVRP.

@&#INTRODUCTION@&#
Vehicle routing problem (VRP) is the key component to transportation optimization, which plays the most important role in modern manufacturing enterprise and logistics management. So it has been one of the hottest research topics in operation research for a long time. The classical VRP involves a fleet of identical vehicles with uniform capacity, a single depot, and a set of customers with known demands. The objective is to establish the optimal delivery routes which can minimize the total transportation cost and at the same time satisfy the demands of all customers. Each vehicle must leave and go back to a single depot, and each customer can be served exactly once by one vehicle route. The classical VRP ignores many additional constraints in real world. Many variants of VRP have been studied by incorporating additional constraints such as distance, capacity and time window into classical VRP. These variants include capacitated VRP (CVRP) [1–9], VRP with time windows (VRPTW) [10–16], VRP with delivery and pickup (VRPDP) [17–20], VRPTW with delivery and pickup [21], multi-depot VRP (MDVRP) [22,23], MDVRP with time windows (MDVRPTW) [24,25], VRP with stochastic demands (VRPSD) [26,27], multi-objective VRP (MOVRP) [28,29], and so on. For more information about VRP, please refer to the taxonomic review presented by Eksioglu et al. [30]. In the literature, most of the variants of VRP assume that the number of available vehicles is not limited, that is, the available vehicles are sufficient to visit all customers and satisfy their demands. So the task of these problems becomes to establish a schedule of vehicle routes so that the number of used vehicles (or vehicle routes) and/or the total distances can be minimized. In these problems, customers are equally treated in the scheduling because it is assumed that all of them will be visited. However, in most cases in real world the customers have different importance to decision-makers because different customers generally provide different profits. In addition, each customer needs not to be visited compulsorily because the available vehicles are often insufficient to visit all customers at a time [31–35].By taking into account the above constraints in real world, this paper investigates another variant of VRP, namely the Prize-Collecting VRP (PCVRP [34,35]). This problem has some characteristics in common with the classical VRP such as: (1) all vehicles must leave and go back to the single depot; (2) the fleet consists of identical vehicles with the same capacity; (3) each customer can only be visited once by at most one vehicle; and (4) the total demands of customers visited by one vehicle cannot exceed the vehicle's capacity. However, the PCVRP has its special features as compared to the classical VRP and other variants. These features make the variant a more realistic problem in logistics, and they are summarized as follows: (1) the number of available vehicles is limited, that is, the available vehicles are insufficient to satisfy the demands of all customers; (2) whenever a customer is served (or visited), a prize (or profit) can be collected from this served customer and this can help to decrease the value of the objective function; (3) it is not compulsorily required that each customer should be served; and (4) the total demands of served customers should not be less than a pre-specified value. The objective is to determine a schedule of vehicle routes so as to minimize the total transportation cost and at the same time maximize the prize collected by all vehicles. The total transportation cost consists of the total distance of vehicles and the number of vehicles used in the schedule. Please note that the PCVRP without the above feature (4) is often called the Capacitated Profitable Tour Problem (CPTP) in the literature [31–33].The PCVRP has a strong background in practical industries [34,35]. For example, in the scheduling problems in iron and steel industry or the equipment manufacturing industry, there are a set of candidate jobs to be processed through a processing line. During production, the processing tools such as the rollers in hot rolling line and the cutting tools in metal-cutting machine need to be replaced after processing a number of jobs. The set of jobs processed between two replacements of processing tools is called a turn, and the maximum amount of jobs that can be included in a turn is called the capacity of a turn. Although in a scheduling horizon several turns can be processed, it is impossible to process all the candidate jobs within this scheduling horizon. So the task of scheduling is to select a subset of candidate jobs and establish several turns simultaneously so that the total setup cost can be minimized and at the same time the total profits of processed jobs can be maximized. In addition, it is often required that the total weights of processed jobs should not be less than a pre-determined value so as to guarantee a satisfactory utilization of equipment's. If each job is viewed as a customer whose demand is its weight and the setup cost between two adjacent jobs is viewed as the travel distance, then this scheduling problem can be modeled as PCVRP.As mentioned above, several kinds of metaheuristics such as the genetic search [33], particle swarm optimization [34], and iterated local search [35] have been proposed for the CPTP and PCVRP. These metaheuristics belong to population-based algorithms that have to maintain a population of solutions and carefully determine the setting of many parameters. In addition, in these algorithms the decisions (i.e., the selection of customers, assignment and sequencing of selected customers in each route) are simultaneously combined into the neighborhood moves (e.g., the neighborhood search on the exhaustive solution in [33] and the cyclic transfer neighborhood in [35], which may make the neighborhood search very complex and hard to be implemented. Therefore, in this paper we prefer to adopt the variable neighborhood search (VNS) [36] to solve the PCVRP. The motivation of adopting VNS lies in two major factors. First, the VNS is an effective metaheuristic because its application in VRP and its variants [3,8,9,16,18,22–25,32,37] has shown very promising results. Second, there are no population and parameters to be considered in the VNS except the stopping criterion (please refer to the Algorithm 1 in Section 4.1), which makes it simple and easy to be implemented. In addition, motivated by the fact that there are two levels of decisions in the PCVRP, namely the selection of customers to visit and the visiting sequence of selected customers in each vehicle route, we develop a two-level self-adaptive VNS (TLSAVNS) for the PCVRP. This algorithm has two main features: the first one is a two-level VNS structure and the second one is a self-adaptive mechanism of neighborhood selection. In the two-level VNS structure (please refer to Algorithm 2 in Section 4.2), the first level corresponds to the selection of customers to visit and the second level corresponds to the visiting sequence of selected customers in each vehicle route. In the second level VNS, a self-adaptive mechanism of neighborhood selection is presented so that the algorithm itself can adaptively adopt the appropriate neighborhood based on its search history, instead of a pre-determined adoption sequence of neighborhoods. The two-level structure with adaptive mechanism has two main advantages. First, the selection of customers and sequencing of selected customers in each route are separately considered in two levels, which makes it easy to be implemented. Second, the adaptive mechanism for the selection of neighborhoods can ensure that only the neighborhoods with a better performance in the historical search process can be often selected. This strategy can help to improve both the search efficiency and robustness of VNS. As shown in the experiments (please refer to Section 6.2.3), it should be also pointed out that the two-level structure may not be able to obtain a better performance than the existing metaheuristics such as the UHGS in [33] for small and medium size problems. The main reason is that the two-level structure does not consider the interaction between the selection of customers and the assignment and sequencing of selected customers in each vehicle route. However, this structure can succeed to achieve better results for large size problems within the same computational time because the size of neighborhood in [33] will become too large to be efficiently searched.In the literature, there have been some kinds of adaptive VNS algorithms. Polacek et al. [25] proposed a cooperative and adaptive VNS for the MDVRPTW. In this algorithm, the adaptive mechanism is focused on the self-adaptation of parameters of the VNS such as the neighborhood parameter and the move parameter. Stenger et al. [37] also presented a kind of adaptive VNS for the VRP derived from small package shipping. In this VNS, the adaptive mechanism is used in the shaking procedure to determine the route and customer selection methods. Lü and Hao [38] developed an adaptive neighborhood search in which an adaptive mechanism is designed to adaptively change the search strategies. If the objective value of a solution has not been improved for a given number of consecutive iterations, a diversification level parameter will be increased; otherwise it will be decreased. Then based on the value of this parameter, the search strategy with different intensification and diversification ability can be selected. Wei et al. [9] designed an adaptive VNS for the CVRP with 3D loading constraint. In this adaptive VNS, they proposed an adaptive selection method to select the better one from two diversification mechanisms, which can perturb the best solution found so far if it has not been improved after an iteration of VNS. This adaptive selection method was based on the historical performances of the diversification mechanisms. The historical performance of a diversification mechanism was evaluated by the success rate of performing this mechanism. Although the idea of our adaptive mechanism is similar to that used in [9], our adaptive mechanism is based on the success rate of each neighborhood and it is used to adaptively select the appropriate neighborhood used in the local search of the VNS. That is, the focus of our adaptive mechanism is on the adaptation of the search behavior of VNS.To evaluate the proposed TLSAVNS algorithm, the PCVRP is formulated as a mixed integer programming model that is different from those proposed by Zhang et al. [34] and Tang and Wang [35], and then a graph extension method is adopted to obtain the lower bound for the PCVRP by transforming the proposed model of PCVRP into an equivalent traveling salesman problem (TSP) model, whose relaxation can be solved by CPLEX.The rest of the paper is organized as follows. The literature review of state-of-the-art algorithms for different kinds of VRP is presented in Section 2. In Section 3, a mixed integer programming formulation of the PCVRP is presented. The two-level self-adaptive variable neighborhood search algorithm is described in details in Section 4. Section 5 is devoted to generating the lower bound for the PCVRP. Computational results on benchmark problems are reported and analyzed in Section 6. Finally, the paper is summarized in Section 7.

@&#CONCLUSIONS@&#
In this paper we consider a variant of the VRP, namely PCVRP in the literature. This problem has three features: it is not compulsorily required to visit all customers but a prize can be collected from a visited customer; the capacity of available vehicles is not sufficient to satisfy the demands of all customers; and the demands of visited customers should reach a pre-determined amount at least. A mixed integer programming model is established for this problem and a graph extension method is adopted to obtain its lower bound. To effectively solve this problem, a TLSAVNS algorithm is developed. Instead of a pre-determined sequence of neighborhoods used in traditional VNS, a self-adaptive strategy based on the selection probability of each neighborhood is proposed in our TLSAVNS to adaptively select the neighborhood with higher probability of finding new better solutions. The selection probability of each neighborhood is updated based on its search result. The efficiency of the self-adaptive strategy is illustrated by the computational results based on randomly generated instances derived from benchmark problems. The comparison between our TLSAVNS and the other metaheuristics in the literature shows that the TLSAVNS algorithm is superior to the MS-LS, MS-ILS, and PSO algorithms, and shows a comparative performance with comparison to the UHGS algorithm (note that for large size problems the performance of our TLSAVNS is superior). Future research can be made on the diversity control of the TLSAVNS so as to further improve its search diversity.