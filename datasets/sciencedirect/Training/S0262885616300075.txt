@&#MAIN-TITLE@&#
A variational based model for estimating true tracklets in wide area surveillance

@&#HIGHLIGHTS@&#
Preprocessing of the extracted tracklets before extracting the persistent trackAn intermediate step on multi-object multi-camera tracking problemVariational data association model for estimating true trackletsExtracting the least possible true tracklets from erroneous tracklets

@&#KEYPHRASES@&#
Variational model,Wide area surveillance,True tracklet estimation,Multi-object tracking,Camera network tracking,

@&#ABSTRACT@&#
In many wide area surveillance applications, tracking objects is usually accomplished by using network of cameras. A common approach to any multi-objects tracking algorithm in a network of cameras comprises of two main steps. First, the movement trajectory of each object, within the field of view of a camera, is extracted and is called object tracklet. Then, the set of tracklets are used to determine the persistent trace of each object. In this paper, we assume that the tracklets are extracted by a conventional tracking algorithm. The occurrence of occlusion between objects, within the viewing scene, leads to various types of errors on the extracted tracklets. If these erroneous tracklets are used in a multi-object tracking algorithm and ignoring the correction phase, then the errors are propagated and affect the results of tracking algorithm. Therefore the true tracklets have to be estimated from the erroneous tracklets. In this paper, we propose a variational model for estimating the true tracklets. The variational principle proposed in this model is established by first introducing a variational energy function. Then the erroneous tracklets are used to estimate the true tracklets through optimizing the energy function. The proposed method is evaluated on two well known datasets and a synthetic dataset which is particularly developed to demonstrate the performance of our algorithm under challenging scenarios. The 10 common metrics, which are used in other multi-objects tracking applications, are used for quantitative evaluations. Our experimental results illustrate that our proposed model estimates the true tracklets which improves the overall association performances.

@&#INTRODUCTION@&#
The development and use of visual surveillance systems are becoming widespread in the growing cities. An intelligent surveillance system takes advantage of many cameras, which are connected in a network, to cover and monitor a wide area. An important component of these intelligent surveillance systems is the tracking module. The tracking module is used for visual object tracking. The visual object tracking is performed by detecting an object in the frame by frame of a video which is captured from one or many cameras.There are numerous methods that have been proposed to deal with the object tracking task under different scenarios in the images captured by a single camera [30,2]. However, the multi-objects tracking in a network of cameras is a young and challenging field of research.The multi-objects tracking task in a network of cameras usually consists of two main steps [1,31,10]. In the first step, objects are tracked in each camera using a single camera tracking algorithm [30,2]. The trajectories of moving objects which are detected within a single camera images are called tracklets. Then the extracted tracklets are associated to determine the persistent traces of all objects. In the second step, it is usually assumed that the input tracklets are accurate and consequently no analysis is required in this stage. A correct tracklet refers to the one that all its observed sample points, which are extracted from the consecutive frames, belonging to one object. Therefore, extracting the correct tracklets before any association step is an essential requirement. On the other hand, in a real world scenario, many challenging events arise which affect the performance of any tracking algorithm. An important challenge in object tracking is occlusion which is caused by sudden disappearing of objects [30,24] in video frames. In this situation, the tracking algorithms may make a wrong decision and wrong objects are tracked. As a result, the extracted tracklet is associated with more than one object. We refer to these tracklets as the erroneous tracklets.The erroneous tracklets in the extraction stage are resolved by some authors by introducing complex and robust algorithms in the initial step [24,3,25,39,38]. For example, in [24] several models with many parameters are introduced and a success rate of 85% is achieved. In that paper, the authors use different algorithms to handle occlusion in different situations. Algorithms include: (i) a content-adaptive progressive occlusion analysis algorithm, which combines the information provided by spatiotemporal context, reference target, and motion constraints together, (ii) a variant-mask template matching for rectifying the target location, (iii) a drift-inhibitive masked Kalman appearance filter, which accurately evaluates the influence of template drift, and (iv) a local best match authentication algorithm.In other work [39], the main reliance is based on viewing the multi-camera with an overlapped camera network; however, the cameras in the multi-camera tracking surveillance system are usually non-overlapped, particularly in wide area surveillance systems. Also, in [37], a novel approach is proposed for multi-objects tracking in a single camera and the results of this paper illustrate that the obtained tracklets yet embed unavoidable errors.In all of these methods, the errors are corrected to some extent only under some restrictive assumptions imposed on the behavior of objects and the topology of cameras, to name a few. Under the absence of any assumption, the occurrence of errors on the extracted tracklets are inevitable. Thus, the risk of occurring errors in the extracted tracklets in the first step is high. Evidently, if the erroneous tracklets are not corrected before association, the errors will be propagated to the association results which are the persistent trace of objects. Therefore, an intermediate step is required to correct the errors.In this paper, we propose a novel variational model as an intermediate step to estimate error free tracklets from erroneous tracklets before they are used in step-two of the tracking algorithm, as shown in Fig. 1. In this figure, the block diagram illustrates the inclusion of our proposed intermediate step in conjunction with the two conventional steps.The conventional two steps algorithms for associating tracklets which were proposed previously aim to generate the persistent trace of objects in camera networks [1]. In some of these works, the error free ground truth tracklets are assumed to be available and therefore they are used in the association process [10,23,13,32,14,26]. In other works, the erroneous tracklets are collected and are used as input to the algorithm. Therefore, the intermediate step which is introduced above is necessary to estimate the true tracklets.In [1,31,5], the errors are categorized into two classes and different solutions are proposed for each class. In the first class which is the lost class, a tracking error (TE) metric [9] is used to quantify the errors. The TE metric is the distance between the model of tracked object in the current observation and the predicted model of the object based on past observations. When TE metric is greater than some thresholds, lost track error is detected and the rest of the tracklet is removed. A shortcoming of this algorithm is severe under change of lighting conditions or pose of the objects, which are the popular challenging events in tracking scenarios, causing change of object model in each observation. Consequently, the TE metric fails to pinpoint the true part of tracklets.The second class of error is due to track switching. In this regard, a simple approach is adapted to resolve the problem. In this approach, the tracklets are split into more segments at points where objects are overlapped. If a candidate erroneous tracklet is broken into more segments where it was not actually necessary, its information content is deteriorated. The missing information of tracklets, which is the consequence of tracklet splitting, affects the associations results and increases the complexity of computations in the association phase. Nevertheless, if erroneous tracklets are not modified, the errors propagate the association results. Therefore, in this paper, we propose a novel model for identifying and estimating the true tracklets which reduces the aforementioned side effects.In the tracklet estimation process, our objective is to create the least possible number of the true tracklets from each erroneous tracklet with no observation error. Erroneous tracklets in the occluded situations arise in different forms. In Fig. 2a an example scenario is shown to demonstrate how occlusions in a scene can lead to erroneous tracklets. In Fig. 2a the two trajectories of objects are presented. The trajectory of object 1 is shown by solid line and the second object by dotted line.Due to occlusion, the two acquired observations contain portions of other object's observations. In this example, if the break points of erroneous tracklets, along with TE metric, are used to determine the true tracklets it would result in creating more than one tracklet for each object. As shown in Fig. 3, the tracklet of object 2 is split into 3 tracklets. Among these three tracklets, two are true tracklets and the other is not. We are interested to estimate the true tracklets of an object in a manner that the true tracklets of each object is detected correctly and is composed of one tracklet alone, even if the true tracklet has missing data, as shown in Fig. 4(a),(b). The desired results are achievable by data association between observation points of the erroneous tracklet. However, since the solution space of this association task grows exponentially with the number of observations of the tracklet, an efficient method is desirable to solve this problem. Since, this problem is an ill-posed inverse problem [4], it is formulated as(1)τ=AÊwhere τ is the erroneous tracklet which is used as an observation in this problem and is assumed to be known, theÊis the estimated true tracklet set which is the solution of the problem and is unknown and A is the occlusion effect which degrades the true tracklets. Here, we are interested to extract the true tracklet setÊfrom the erroneous trackletτ. If the dot and line objects in Fig. 2 have distinctive models (appearance or motion model), which makes them unique compared to other objects, only one true tracklet set can be found in this example scenario as shown in Fig. 4. But, if they don’t have any distinctive models, more than one solution can be found which are shown in Figs. 3 and 4b. These kinds of problems are known as the ill-posed problems [4].There are various noises, i.e pose and illumination variation, occlusion, clutter and sensor noise, which is almost impossible to find the distinctive models in these problems. Furthermore, extending the camera coverage, i.e. more viewing sites and more objects, obtaining unique distinctive models become even more complex. So, for each observation, more than one solution is possible which makes the problem of estimating true tracklets an ill-posed one. Furthermore, since the variational model is an effective solution for solving the ill-posed inverse problem [16,36,34,35,22,20], we propose a variational model for associating observations of the erroneous tracklet.The rest of the paper is organized as follows. In Section 2 the mathematical formulation of the proposed model is presented. The experiments which are performed for evaluating our proposed model are given in Section 3 and finally, the conclusion is given in Section 4.As stated in Section 1, extraction of correct tracklets influences the overall performance of a multi-objects tracking in a network of camera. The tracklet sets are generated by any conventional tracking algorithm such as the algorithm presented in [30], or by other methods such as a simple bounding box or accurate curve silhouette [2]. On the other hand, in a multi-object tracking problem, occlusion of objects is a common challenge, and its occurrence causes that the tracklets to be erroneous. Hence, in the association step these erroneous tracklets must be corrected beforehand. In our proposed model, the true tracklets are estimated from erroneous tracklets using a variational model which is optimized by using an energy function. The list of symbols for all parameters which are used throughout this paper are presented in Table 1.In this section, a variational data association model for estimating the true tracklets is presented. We first introduce the proposed variational energy function, then a level set representation of this energy function is presented. Finally, a numerical solution for solving the variational data association model is proposed.In the process of estimating true tracklet, we are interested to associate observations of each object as a separate tracklet. Our approach is optimized to extract the longest tracklets which have similar appearance and low variance among all observations. An energy function based on these considerations is defined as,(2)JÊ=∑τj∈Êλ1×∑m=1|τ|CLSτj(τ(m))+λ2×∑m=1τjSMτjτj(m)−λ3×Lτj+λ4×DCτj,which comprises of four components. The CLS(⋅) is the closeness component and is included to identify and control the estimated tracklet such that it selects those observations with similar appearance model. The SM(⋅) is the smoothness component and its objective is to estimate the tracklet containing the observations with low variance in appearance models. The constraint on the longest tracklet computation is satisfied with terms L(⋅) which is presented the length of the tracklet and DC(⋅) is the discontinuity rate of the tracklet. The closeness part is defined as,(3)CLSτj(τ(m))=DAFA(τ(m)),FAτj+∑τi∈Êτi≠τjDAFAτm,FAτj−DAFA(τ(m)),FAτiifτ(m)∈τj1−DAFA(τ(m)),FAτj+∑τi∈Êτi≠τjDAFA(τ(m)),FAτi−DAFA(τ(m)),FAτjifτ(m)∉τj,and, the smoothness part is given as,(4)SMτjτj(m)=DAFAτj(m),FAτj−MeanFAτj2+∑τi∈Ê,τi≠τjDAFAτj(m),FAτj−MeanFAτj2−DAFAτj(m),FAτi−MeanFAτi2,where Mean FA(τj) is the mean distance of the observations of estimated tracklet and is defined as,(5)MeanFAτj=1τj∑m=1τjDAFAτj(m),FAτj.The FA(⋅) represents the appearance model. In this paper, the RGB histogram is used as the appearance model. The FA(τj(m)) is the appearance model of the object in the mth frame of trackletτjand the FA(τj) is the mean appearance model of the trackletτj, respectively, which is obtained by averaging the appearance model of an object in all frames of the trackletτj.Figs. 5 and 6present the proposed energy function, with more details. In Figs. 5 and 6, a two dimensional appearance model is assumed for each observation of the object. Then, the observations of the erroneous tracklet are drawn in the two dimensional chart. It is assumed that the erroneous tracklet includes three different true tracklets. The appearance model of each true tracklet is shown by a different geometric shape. As mentioned, each extracted true tracklet contains a mean appearance model, which is presented in these figures by bold shape. Assuming euclidean distance as a measure, the distance between two appearance models are also shown. In this figure it is assumed that the new observation τ(m) of the erroneous tracklet is being analyzed.As shown in Fig. 5, the main objective of closeness part is to assign the new observation to the true tracklet with minimum distance between appearance model of new observation and mean appearance model of true tracklet. Similarly, the requirement of including the smoothness part of energy function is demonstrated in Fig. 6. As it is shown, the smoothness part assigns the new observation (τ(m)) to the true tracklet in a way that the distance between appearance model of the new observation and mean appearance model of true tracklet is similar to the same distance of other observation of this true tracklet. As explained, the closeness and smoothness parts assign the observation based on the appearance model while geometrical constraints are excluded. Therefore, the length and discontinuity parts are added to the energy function which prevent production of short and slashed tracklets.In order to use this energy function for estimating the true tracklets, a proper representation for the proposed variational multiphase energy function is required. This representation is defined in the following.A multiphase level set [42] is used to represent our proposed variational energy function. In this representation, all estimated tracklets which are obtained from erroneous trackletτ are represented by Ω={ω1,⋯ ,ωq} where each estimated tracklet of this set is represented by ωjand is defined as,ωj:X→Ywhere X={1,⋯ ,|τ|} and Y isY⊂Rand |τ| is the number of observations of the object in the tracklet and,(6)τ(m)∈τjifωj(m)≥0τ(m)∉τjifωj(m)<0.In this representation, the smoothness part of the energy function is rewritten as,(7)SMωj(m)=DAFAτj(m),FAωj−MeanFAωj2∑υ=1,υ≠j|Ω|DAFAτj(m),FAωj−MeanFAωj2−DAFAτj(m),FAωυ−MeanFAωυ2,where the index ofSMωj(m)is to emphasize the smoothness of our new representation. The closeness part is also redefined as,(8)CLSωj(m)=DAFA(τ(m)),FAωj+1|Ω|−1×∑υ=1,υ≠j|Ω|DAFA(τ(m)),FAωj−DAFA(τ(m)),FAωυ×Hωj(m)+1−DAFA(τ(m)),FAωj+1|Ω|−1×∑υ=1,υ≠j|Ω|DAFA(τ(m)),FAωυ−DAFA(τ(m)),FAωj×1−Hωj(m).In this representation, the H(⋅) is the Heaviside step function which is defined as,(9)H(z)=1ifz≥00ifz<0Furthermore, the appearance mean distance for each estimated tracklet is rewritten as,(10)MeanFAωj=∑m=1τjDAFAτj(m),FAωj×Hωj(m)∑m=1τjHωj(m),and, the appearance model of each estimated tracklet in the level set representation is computed by,(11)FAωj=∑m=1τjFAτj(m)×Hωj(m)∑m=1τjHωj(m).The L (ωj) part of the energy function is defined as,(12)Lωj=1ωj×∑m=1ωjHωj(m),and, the DC (ωj) is defined as,(13)DCωj=∑m=1ωj∂∂mHωj(m)2=∑m=1ωjδωj(m)×∂∂mωj(m)2.which counts the number of breaks in the estimated tracklet of the optimization process. So, the variational form of the proposed energy function using level set representation is rewritten as,(14)J[Ω]=∑j=1|Ω|∑m=1ωjλ1×CLSωj(m)+λ2×SMωj(m)×Hωj(m)−λ3×1ωj×Hωj(m)+λ4×δωj(m)×∂∂mωj(m)2.The energy function presented in Eq. (14) is used to estimate the tracklets. The solution to this optimization equation is denoted by,(15)Ω*=argminΩJ[Ω].Furthermore, the ϵ regularized version of the energy function Eq. (14) is introduced to facilitate the solution of our optimization problem and is given by,(16)Jϵ[Ω]=∑j=1|Ω|∑m=1ωjλ1×CLSϵ,ωj(m)+λ2×SMϵ,ωj(m)×Hϵωj(m)−λ3×1ωj×Hϵωj(m)+λ4×δϵωj(m)×∂∂mωj(m)2.In this paper, the regularized version of H(⋅) which is introduced in [12] is used. This function is defined as,(17)Hϵ(z)=121+2πarctan⁡zϵ,and, the regularized version of the Delta Kronecker function is defined as,(18)δϵ(z)=ddzHϵ(z),also,CLSϵ,ωj(.)andSMϵ,ωj(.)are the same asCLSωj(.)andSMωj(.), respectively, only the H(.) is replaced with Hϵ(.).This optimization problem is solved by fixing FAand MeanFAthen Jϵ[Ω] is minimized with respect to Ω using the Euler–Lagrange equation [4]. Employing gradient descent and representing ωj(m) by an artificial time parameter t ≥ 0, ωj(m) is changed to ωj(t, m), then, the level set representation of our optimization Eq. (16) is converted to a partial differential equation (PDE), where its solution yields the jth optimal true tracklet which is estimated from the erroneous trackletτ . The PDE is given by,(19)∂ωj(t,m)∂t=−aϵ,ωj(m)+SMωj(m)−1ωj−2×δωj(t,m)2×∂2∂m2ωj(t,m)×δϵωj(t,m),whereaϵ,ωj(m)is defined as,(20)aϵ,ωj(m)=2×DAFϵ,A(τ(m)),Fϵ,Aωj+2|Ω|−1×∑υ=1,υ≠j|Ω|DAFϵ,A(τ(m)),Fϵ,Aωj−DAFϵ,A(τ(m)),Fϵ,Aωυ−1,and, for each estimated tracklet, one candidate observation (called candidate point) is selected which is not modified in the optimization process. For estimating the first tracklet, the first observation of the erroneous tracklet is selected as the candidate point. For other estimated tracklets, first observation of the erroneous tracklet which is not assigned to any estimated tracklets, is selected as the candidate point. Based on this assumption the initial conditions which are used for solving the PDE are defined as,ωj(0,0)=ϵ,ωj(0,⋅)=0ifj=0ωj(0,CandidatePoint)=ϵ,ωj(0,⋅)=0ifj>0.In addition, based on the definition of the candidate point and assuming that the estimated tracklets do not change in the boundaries, the boundary conditions are defined as,ωj(t,0)=ϵ,dωj(t,ωj)dm=0ifj=0ωj(t,CandidatePoint)=ϵ,dωjt,ωjdm=0,dωj(t,0)dm=0ifj>0.An analytical solution for this PDE is not feasible, hence, a numerical solution is sought which is presented in Section 2.1.3.In order to solve the PDE, we use a finite differences implicit schema [15,33]. By discretizing the partial derivative part of the equation, an finite difference equation (FDE) is obtained as,(21)−S×δhωjn(m)2×ωjn+1(m−1)+2Sδhωjn(m)2+1×ωjn+1(m)−Sδhωjn(m)2×ωjn+1(m+1)=ωjn(m)−δhωjn(m)×bωjn(m)×Δt,where h is the space interval, Δt is the time step,ωjn(m)is defined as,(22)ωjn(m)=ωj(n×Δt,m×h),and,bωjn(m)is defined as,(23)bωjn(m)=aωjn(m)+SMωjn(m)−1ωj,and(24)S=2×Δth2.The solution of FDE has several important properties [15,33]. An important feature is that the solution of this FDE is feasible, and its convergence and consistency are guaranteed using the Thomas algorithm by an order of O(n) complexity [15,33]. The proposed algorithm for tracklet estimation is presented in Algorithm 1. This algorithm includes three main steps. First, an initial value is created for level set function representation of the estimated tracklet setÊ(lines 1 and 2 of Algorithm 1). Second, the best Ω is calculated based on the optimization equations (lines 3 to 12 of Algorithm 1). Third, a true estimated tracklet set of the trackletτ which is obtained based on the calculated Ω and Eq. (6) is created (lines 13 to 22 of Algorithm 1). Also, SplitAndMerge(⋅) is computed using Algorithm 2. The SplitAndMerge(⋅) includes five main steps. First, the observation points of the trackletτ which is not included in any of the estimated tracklets is assigned to the NotUsed container and the tracklets of the estimated tracklet set which does not contain any observation points of the trackletτ are assigned in the RemoveList container (lines 1 to 17 of Algorithm 2). Second, the observation points of the trackletτ in the container NotUsed is assigned to the the estimated tracklets in the current estimated tracklet set which are not assigned to these up to this point of the optimization algorithm based on the container NotAssignTo (lines 18 to 27 of Algorithm 2). Third, the estimated tracklets in the container RemoveList are removed from the current estimated tracklet set (lines 28 to 32 of Algorithm 2). Fourth, if the observation points exist in the NotUsed container yet, a new estimated tracklet is created and these points are assigned to this new estimated tracklet (lines 33 to 39 of Algorithm 2). Finally, the updated estimated tracklet set Ωnis created based on the modified estimated tracklets and is returned from the algorithm (lines 40 to 41 of Algorithm 2).Algorithm 1The tracklet estimating algorithmSplit and merge algorithm

@&#CONCLUSIONS@&#
