@&#MAIN-TITLE@&#
Statistical shape analysis of subcortical structures using spectral matching

@&#HIGHLIGHTS@&#
A novel groupwise shape analysis approach is proposed to detect regional morphological alterations in sub-cortical structures between two study groups, e.g., healthy and pathological subjects.The proposed framework applies spectral matching in order to find point-to point correspondences across all surfaces.The proposed framework is applied on the clinical application of Alzheimer's disease for detecting abnormal sub-cortical shape variations.

@&#KEYPHRASES@&#
Subcortical morphology,Groupwise shape analysis,Spectral matching,Alzheimer's disease,

@&#ABSTRACT@&#
Studying morphological changes of subcortical structures often predicate neurodevelopmental and neurodegenerative diseases, such as Alzheimer's disease and schizophrenia. Hence, methods for quantifying morphological variations in the brain anatomy, including groupwise shape analyses, are becoming increasingly important for studying neurological disorders. In this paper, a novel groupwise shape analysis approach is proposed to detect regional morphological alterations in subcortical structures between two study groups, e.g., healthy and pathological subjects. The proposed scheme extracts smoothed triangulated surface meshes from segmented binary maps, and establishes reliable point-to-point correspondences among the population of surfaces using a spectral matching method. Mean curvature features are incorporated in the matching process, in order to increase the accuracy of the established surface correspondence. The mean shapes are created as the geometric mean of all surfaces in each group, and a distance map between these shapes is used to characterize the morphological changes between the two study groups. The resulting distance map is further analyzed to check for statistically significant differences between two populations. The performance of the proposed framework is evaluated on two separate subcortical structures (hippocampus and putamen). Furthermore, the proposed methodology is validated in a clinical application for detecting abnormal subcortical shape variations in Alzheimer's disease. Experimental results show that the proposed method is comparable to state-of-the-art algorithms, has less computational cost, and is more sensitive to small morphological variations in patients with neuropathologies.

@&#INTRODUCTION@&#
Quantifying groupwise neuroanatomical shape differences has become an important topic in neuroscience as well as in neuroimaging studies, since brain morphometry has been hypothesized to be linked to various neurological disorders [1]. Recent advances in medical image analysis have led to several morphological studies on different pathologies including schizophrenia [2] and Alzheimer's disease [3]. Early studies on brain morphology were based on volumetric analysis, which had the advantage of simplicity [3,4]. However, these methods lacked regional shape information, which are potentially important for neurological identification. Thus, shape analysis has emerged as an alternative of evaluating morphology location and magnitude in the brain anatomy, in order to detect the neuroanatomical changes in specific regions of a single structure.Several works have proposed groupwise shape analysis approaches based on creating a template image and estimating the deformation field between each individual image and the template [5–7]. These methods non-rigidly register each image to a specific template, and evaluate the information contained within the deformation field to detect the location and magnitude of shape changes. In deformation-based approaches the template creation and the choice of the registration technique has a critical impact on the quality of the shape analysis results [8]. Indeed, deformable registration remains a challenging problem, particularly in smaller regions such as subcortical structures, which requires a high level of accuracy to precisely match sub-fields.Another approach for shape analysis is based on medial surface representations [9–12]. These methods provide a compact parameterization of a volumetric object by extracting the 3D skeleton of a shape. The local positional changes are then quantified by assessing morphological variations of the skeleton across a population of shapes. The medial surface representation has been applied to various subcortical structures including the cross sectional images of the corpus callosum [9] and hippocampus/amygdala complex [11], caudate [12], and lateral ventricle [13], in order to evaluate changes in patients diagnosed with schizophrenia. Since medial representation relies on a coarse-scale sampling of the structure of interest, it may be insensitive to small-scale shape differences, which might be present in a studied population [2].In addition to the above-mentioned methods, several works have proposed surface parameterization based approaches, in which a parameterization of a shape is performed on a simple domain such as a sphere. One such approach is the spherical harmonics (SPHARM) method by Styner et al. [14], which is used in combination with Point Distribution Models (PDM) to discover structural differences across populations. In this approach, which is called SPHARM-PDM, shapes first represented by binary segmentations are converted into a corresponding spherical harmonic description. Then, the correspondence problem is solved by the alignment of the spherical parameterization using a first-order ellipsoid. In this method, the spherical description of surface meshes is sampled into triangulated surfaces using icosahedron subdivision. These surfaces are then spatially aligned using rigid Procrustes alignment.The SPHARM-PDM method has been applied in various clinical applications, such as for studying shape variations of the hippocampus [2] and lateral ventricles [13] in schizophrenia, and analyzing caudate morphological changes [15] in bipolar disorder. Although SPHARM-PDM enabled the reliable assessment of local shape variation across populations, it requires establishing correspondence on simplified spherical models of surfaces, which is restricted to surfaces with spherical topology [16,17]. In order to overcome this limitation, combining SPHARM-PDM with an entropy-based particle system correspondence model has been proposed in [16]. Furthermore, Cates et al. [17] proposed to model the shape as sets of particles, where the particles are distributed on the surfaces of the shapes by optimizing an entropy-based energy function. According to a recent evaluation in [8], this method was not able to find the location of group differences in some cases.Chung et al. [18] proposed weighted-SPHARM, which expresses surface data as a weighted linear combination of spherical harmonics. The weighted-SPHARM method generalizes the traditional SPHARM representation as a special case. This method reduces ringing artifacts observed with the SPHARM representation especially for the high frequency components [18]. However, it is applicable for a limited class of shapes and is only able to detect the sufficiently large shape difference across populations. The SPHARM-MAT (SPHARM Modeling and Analysis Toolkit) is another shape analysis method, which creates parametric surface models using spherical harmonics [19]. This approach is similar to the SPHARM-PDM framework [14] but applies different spherical parameterization and shape alignment process [19]. A comparison between the two spherical harmonics-based methods showed that SPHARM-PDM could capture the shape differences more accurately rather than the SPHARM-MAT [8]In general, despite the development of various approaches in the field of groupwise shape analysis, there are still some limitations and challenges that need to be addressed. For instance, the morphometry framework should be robust to different shape topologies and shape segmentation approaches, while from a computational perspective, the total population-wise shape analysis process should be determined in an efficient time manner, in order to be feasibly implemented as a clinical diagnostic tool.One of the main challenges in a surface-based groupwise shape analysis approach is to establish reliable one-to-one correspondences among the population of surfaces. Among various surface matching algorithms in the literature, the recent spectral matching approach proposed by Lombaert et al. [20,21] have shown promising results, which enables mapping brain cortical surfaces in a computational efficient manner. To the best of our knowledge, no studies have been based on spectral matching theory directly for groupwise shape analysis. In this paper, we employ the spectral matching approach in a groupwise shape analysis pipeline, designed for the population-wise comparison between two groups of subcortical structures. In the proposed framework, the mean curvature feature is used as feature information in the spectral matching process in order to increase the surface matching accuracy. This work presents a complete pipeline that allows the detection, localization, and quantification of statistically significant morphological differences in different subcortical brain structures across various populations.The main contribution of this paper is to propose a robust and reliable spectral-based shape analysis framework using curvature features for analyzing simple (e.g., putamen) and complex (e.g., hippocampus) subcortical structures. Furthermore, in contrast to the above-mentioned methods, the suggested framework can perform population-wise shape analysis in a computational efficient fashion and integrates the spectral matching approach with a groupwise shape analysis framework. This paper is the first work that integrates spectral matching in to a groupwise subcortical shape analysis pipeline and incorporates curvature features to increase the surface matching accuracy (methodological contribution). Experimental analysis on real clinical datasets show that the extracted group differences are similar to the findings of other clinical studies (clinical contribution). This work would represent a significant forward for providing an alternative for future clinical studies on sub-cortical brain structures.The proposed shape analysis framework processes two groups of segmented binary images from neuroimaging data (e.g., MRI) as input. After converting the images into triangulated surface meshes and applying the curvature flow smoothing process, the surface correspondence is established between two populations using the spectral matching approach. The mean curvature features are incorporated in the spectral matching process to improve the accuracy of the resulting surface correspondence. Then, two mean shapes for each group are created as the geometric mean of all surfaces, and the distance map between the two mean shapes is computed. To verify for statistically significant differences between two populations, a non-parametric permutation testing scheme [22] is applied, followed an FDR correction [23] for multiple comparisons. The evaluation of the proposed shape analysis framework is performed on three separate neuroanatomical datasets, and group differences across populations are detected by point-to-point correspondences. The output of these analyses is compared to a state-of-the-art method used for groupwise analysis of anatomical shapes, namely SPHARM-PDM.A preliminary version of the proposed method has been presented in [24], but was dependent of spherical representations of input shapes, integrated a point-based shape matching method, and with limited validation. The present paper provides the detailed explanation of the methodology and offers the following major contributions: (i) a curvature-based surface smoothing is employed to smoothen extracted 3D surfaces, which has less computational requirements compared to the spherical-based smoothing method used in [24]; (ii) mean curvature feature was added into the spectral matching process to increase the surface matching accuracy; (iii) a statistical permutation-based analysis is applied to detect the significant shape differences across populations; (iv) the evaluation of the proposed pipeline is performed on an increased number of clinical datasets with more samples.The remainder of this paper is organized as follows. In Section 2, the methodology is presented, including the overview of the framework, the spectral surface matching approach, and the detailed description of the proposed population-wise shape analysis framework. The quantitative evaluation of the shape analysis method is provided in Section 3. Section 4 presents a discussion on the results obtained from different neuroimaging datasets, followed by a conclusion in Section 5.In this section, an overview of the proposed groupwise shape analysis pipeline is presented (Fig. 1). The inputs of the proposed framework are two sets of segmented binary maps of a particular structure of interest from medical images, obtained either manually or automatically. The output of the proposed pipeline is the extracted local and global shape differences between two sets.In the first step, the segmented binary maps are processed to the same image orientation and isotropic voxel sizes, and then converted into 3D triangulated surfaces using the marching cube algorithm [25]. A smoothing process is subsequently applied on each surface in order to remove surface noise. Then, a reference surface is defined in an iterative process, and all triangulated surfaces are aligned to this reference using a rigid registration algorithm. In order to establish the point-to-point correspondences across all surfaces, each mesh is matched to a selected reference surface using the spectral matching algorithm. The vertices of all surfaces are rearranged to create the new reconstructed meshes with consistent vertex ordering. This enables to create a mean shape of each study group, and detect any morphological variations between two groups. A distance map between two mean shapes is computed to capture the local group differences across populations. Moreover, average and maximum distances, as well as Dice volume overlap are calculated to indicate the global group differences between two study groups.This section presents the theoretical framework of computing the spectral matching between two surfaces in the spectral domain. The matching between two surfaces S1 and S2 is conducted in a two-step process (Fig. 2a and b). In the first step, an initial map is calculated between the two surfaces [20]. This initial map is then used in the second step to establish a smooth map between the two meshes [21].For each surface mesh Si(i∈{1, 2}) composed of the set of vertices Viand edges Ei(neighboring points in mesh faces), the corresponding graph Gi={Vi, Ei} is built. Then, the weighted adjacency matrix Wiis created based on a distance between connected vertices and the graph Laplacian matrix Li[26] is defined as:(1)Li=Gi(Di−Wi)where, Diis a diagonal matrix with elements given by the degree of vertices. Giis another diagonal matrix, which could be considered asGi=Di−1or any other (positive valued) vertex weights [20,27]. The eigendecomposition of the Laplacian matrix Licomputes the eigenvalues and the associated eigenmodes. The spectrum (spectral representation)S˜iis defined as the first k eigenmodes associated with the non-zero eigenvalues.Once the spectrumsS˜1andS˜2are computed, the reordering and sign adjustment [20] process are performed and the resulting spectrums are aligned using the Coherent Point Drift (CPD) method [28]. Then, the correspondence map c between two surfaces S1 and S2 is established with a simple nearest-neighbor search in the spectral domain. An overview of the procedure to find the correspondence map c is shown in Fig. 2a.Given the initial map c between two surfaces, the final map φ (smooth match) is obtained according to Fig. 2b. In this procedure, an association graph Ga={V1,2, E1,2,c} composed of the set of vertices and edges of S1 and S2 with the initial links c between the two surface meshes is created. Then, the Laplacian matrix is created as La=Ga(Da−Wa), where, Wa, Ga, and Dacould be defined in the similar way as Eq. (1). The eigendecomposition of the Laplacian matrix Laproduces a shared set of eigenvectors that enables a direct mapping φ1→2 between two meshes (see [21] for more details).According to [20,27], considering higher node weights in the graph Gacould improve the spectral matching precision between two surfaces. This could be achieved by adding extra features on node weights Ga[20,27]. In this paper, we propose to use the mean curvature [29] as an additional feature, due to its ability to represent the pointwise characteristic within a surface. In fact, the exponential of the mean curvature is added to the node weights in the Laplacian graph Lato assign higher weights to each vertex. In order to compute the mean curvature at each vertexv, the principal curvaturesCmin(v)andCmax(v)[29] are calculated as the minimum and maximum curving degrees of the surface Si. Then, the mean surface curvature C at each vertexvis defined as:(2)C(v)=12(Cmin(v)+Cmax(v))Hence, the mean curvature of surface Siis computed as {C(1), C(2), …, C(n)}, where, n is the total number of vertices in the surface Si. The additional information is incorporated in the weighting of the nodes by computing the exponential of the mean curvature, and defining the diagonal node weighting matrix Gaas:(3)Ga=Da−1(exp(diag(C(1),C(2),…,C(n)))The effect of the curvature feature on the matching accuracy will be assessed in Section 3.Let{IiA}i=1,…,NAand{IiB}i=1,…,NBbe two separate sets of segmented binary maps of a particular subcortical structure, with NA and NB as the number of samples in each set, respectively. To extract smooth 3D triangulated surface meshes from input binary maps, the labeled datasets are first reoriented in the same image orientation and resampled to isotropic voxel sizes of 1×1×1mm3. Then, the isosurfaces of the segmentation are extracted using the marching cube algorithm [25] to generate 3D surface meshes denoted as{MiA}i=1,…,NAand{MiB}i=1,…,NBfor the two study groups.The 3D triangulated surface meshes are then smoothed using mean curvature flow algorithm [30], in order to create the smoothed meshes{SiA}i=1,…,NAand{SiB}i=1,…,NB. This smoothing step is an iterative process, which removes surface irregularities and improves the appearance of surfaces. Given a triangulated surface Miand for each mesh vertex x, the mean curvature flow is computed using the following explicit vertex-updating scheme:(4)xnew←xold+λH(xold)where, the step-size λ is a small positive number. This parameter should be chosen small enough to keep the smoothing process stable. Here, H(xold) is a discrete approximation of the mean curvature vector at a mesh vertex x, which is defined as:(5)H(xold)=14∅∑i(cotαi)+cosβi(Qi−xold)where, ∅ is the sum of the areas of the triangles surrounding x and {Qi} are the neighbors of the vertex xold. Here, αiand βiare the two angles opposite to the edge Qixold. The process defined in Eq. (4) is applied to every point of each triangulated surface Miiteratively to further smooth the mesh. High iterations produce smoother mesh, but it might cause the loss of fine surface details. Removing fine surface information could mislead a groupwise morphological study in capturing small shape differences. In this paper, the 3D surfaces are smoothed after five iterations. This is the least smoothing that is required to avoid failure in spectral matching process. The parameter λ is set to 1.0 as suggested in [30].As a prerequisite for any shape analysis study, objects have to be normalized with respect to a reference coordinate frame. In order to define the reference surface Sr, an arbitrary surface from the input dataset can be chosen randomly, and used as a reference mesh. Alternatively, an average template could be created in an iterative process and employed as a reference surface. In this study, these two different reference selection approaches are tested, in order to evaluate their impact on the performance of the proposed shape analysis framework.The step-by-step procedure of the average reference computation is presented in Algorithm 1. This algorithm is based on the approach proposed by Guimond et al. [31], in which an average image was created by alternating between pairwise registrations and updates of the average image. The input to Algorithm 1 is the union of the two sets{SiA}i=1,…,NAand{SiB}i=1,…,NB, which is defined as{Si}i=1,…,(NA+NB). Starting from an initial reference surface (e.g., Sr=S1), all other surfaces Siare rigidly aligned to the selected reference mesh. This rigid alignment is performed using the iterative closest point (ICP) algorithm [32], which finds the optimal rigid transformation between each mesh and the reference Sr. In the next step, the point-to-point mapping φi→rbetween each surface Siand Sris computed based on the spectral matching framework presented in Section 3. In the final step, the geometrical mean shape is estimated from all matched structures, and used as an updated reference shape. This process terminates when no more changes in Srobtained or the maximum number of iterations is achieved. According to preliminary experiments, the maximum iteration value is set as 10.Once the reference surface Sris defined, using either random selection or average surface creation, all surfaces Siare registered rigidly to Sr. This global surface alignment between each surface Siand reference surface Srconsists of rigid transformations.Algorithm 1:Average templateInput:N=(NA+NB) triangulated surfaces Si, and an initial reference surface (e.g., Sr=S1)repeat1. Align all surfaces Si–Srusing rigid ICP2. Find point-to-point mapping φi→rbetween each surface Siand Sr3. Update referenceSr=1N∑i=1N(Siφi→r)until No more changes in Srobtained or the maximum number of iterations is reachedOutput: average template SrGiven two sets of aligned surface meshes{SiA}i=1,…,NAand{SiB}i=1,…,NB, the point-to-point correspondences between each surface and the reference Sris established using the spectral matching approach presented in Section 2.2. Then, the mesh vertices of all surfaces are rearranged to have the consistent ordering across the populations. The resulting reconstructed meshes are denoted as{S′iA}i=1,…,NAand{S′iB}i=1,…,NBfor the two study groups.The mean shapesS′μAandS′μBare computed by averaging the 3D coordinates of corresponding surface points across each group:(6)S′μA=1NA∑i=1NAS′iA,whereS′iA=S′iAφi→rS′μB=1NB∑i=1NBS′iB,whereS′iB=S′iBφi→rwith φi→rthe mapping from instance Si to reference Sr. The local shape differences between groups can be detected by computing a distance map between two mean shapesS′μAandS′μB. This will provide the visual assessment of the location and magnitude of the differences between groups A and B. We use a standard, non-parametric Hotelling T2 test [22] to check for significant group differences, with the null hypothesis that the two groups are drawn from the same distribution. The resulting raw p-values are then corrected for multiple comparisons by the false discovery rate (FDR) approach [33].The performance of the method is further evaluated by significant vertex ratio metric, which is estimated by computing the ratio of the number of statistically significant vertices over the total number of surface points of the mesh [8].The global shape difference between two groups is computed by averaging the distances between the mean surfaces, which results in the mean absolute distance (MAD). The mean absolute distance (MAD) attempts to estimate the average distance of surfacesS′μAandS′μBby projecting the vertices of the first surface on the second one [34]. Moreover, the Hausdorff distance [35] is calculated as the maximum distance between two mean shapes. This measure has high sensitivity to positional differences between two surfaces. In addition, Dice coefficient [36] is reported as a global measure, which indicates the amount of volume overlap between two mean shapes. The 3D Dice coefficient metric between two surfacesS′μAandS′μBis defined as the intersection divided by the mean volume of the two surfaces:(7)Dice(S′μA,S′μB)=|S′μA∩S′μB||S′μA|+|S′μB|2For identical surfaces, Dice coefficient achieves its maximum value of 1, with decreasing values indicating less volume overlap.

@&#CONCLUSIONS@&#
