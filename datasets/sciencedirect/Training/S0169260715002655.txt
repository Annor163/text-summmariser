@&#MAIN-TITLE@&#
Low-dose CT statistical iterative reconstruction via modified MRF regularization

@&#HIGHLIGHTS@&#
Proposed a novel regularization scheme MMRF for CT reconstruction.Present a new objective function and deduce its iterative equation.Optimize the objective function by a modified alternative iterative algorithm.Design experiments on different phantoms to validate the validity of the approach.Analyze the results by visual evaluation and quantitative evaluation.

@&#KEYPHRASES@&#
CT,Statistical iterative reconstruction,Markov random field,Total generalized variation,Regularization,

@&#ABSTRACT@&#
It is desirable to reduce the excessive radiation exposure to patients in repeated medical CT applications. One of the most effective ways is to reduce the X-ray tube current (mAs) or tube voltage (kVp). However, it is difficult to achieve accurate reconstruction from the noisy measurements. Compared with the conventional filtered back-projection (FBP) algorithm leading to the excessive noise in the reconstructed images, the approaches using statistical iterative reconstruction (SIR) with low mAs show greater image quality. To eliminate the undesired artifacts and improve reconstruction quality, we proposed, in this work, an improved SIR algorithm for low-dose CT reconstruction, constrained by a modified Markov random field (MRF) regularization. Specifically, the edge-preserving total generalized variation (TGV), which is a generalization of total variation (TV) and can measure image characteristics up to a certain degree of differentiation, was introduced to modify the MRF regularization. In addition, a modified alternating iterative algorithm was utilized to optimize the cost function. Experimental results demonstrated that images reconstructed by the proposed method could not only generate high accuracy and resolution properties, but also ensure a higher peak signal-to-noise ratio (PSNR) in comparison with those using existing methods.

@&#INTRODUCTION@&#
X-ray computed tomography (CT) is used in a rapidly increasing host of imaging applications, especially for applications in image-guided intervention where repeated scans are required and the subsequent accumulated radiation dose could be substantial [1–3]. However, excessive X-ray radiation dose exposure to patients caused by repeated CT scans could result in significant risk to get genetic and cancerous diseases [4,5]. Therefore, it is highly desirable to study the low-dose CT imaging, which can be achieved through lowering the X-ray tube current (mAs) or tube voltage (kVp) and simultaneously reducing the total number of X-ray views per rotation around the body [6–9]. Generally, for a given set of noisy and sparse-view projection data, the associated image quality of results reconstructed by the conventional analytical reconstruction methods is degraded [10]. To reconstruct high-quality CT images from undesirable projection data, various reconstruction methods with varying degrees of success have been proposed in recent years [11–19]. Among these, SIR algorithms show superiority over the conventional FBP method due to the statistical modeling of projections and imaging geometry. Specifically, the cost function for SIR methods comprises two major parts. One part is the data-fidelity term which can be used to model the statistics of measurements. The other part is the regularization term which may be utilized to regularize the solution and reflect the prior information at the same time.Many advanced SIR methods achieve satisfactory reconstructed images by introducing different regularizations, which mostly include smooth regularizations [20–23] and edge-preserving regularizations [24–28]. More broadly, the academic attention to regularizations covered the entropy prior, Gamma prior, MRF-based priors, TV-based regularizations, nonlocal-means (NLM)-based priors, dictionary learning (DL)-based regularizations, and patch-based roughness regularizations, etc. In general, the Gaussian and Gamma priors enable the pixel values to approach the mean value of the image. For this reason, the pixel values could be kept from “blowing up”, but image smoothness cannot be well implemented [21,22]. By adjusting weighting coefficients, Wang et al. [23,24] proposed an improved MRF prior, which utilized the anisotropic weighting coefficients while retaining the quadratic-form potential function. Recently, many NLM-based SIR methods [25–28] were proposed and worked well. Inspired by the study on sparse and redundant representations over dictionary learning, Xu et al. [29] proposed to utilize the DL-based sparsification as the regularization for CT reconstruction. In addition, to improve the image quality of reconstructed results, Lu et al. [30] proposed a modified DL-based regularization which combine a transitional dictionary for atom matching and a global dictionary for image updating. Moreover, through training a multi-scale dictionary, Bai et al. [31] proposed a multi-scale DL-based regularization for SIR method which perform well on details extracting and resolution maintaining. For edge-preserving regularizations, a typical example is the TV-based regularization. Tian et al. [32] proposed to preserve the edges by the EPTV term which can preferentially perform smoothing only on the non-edge part of the image. Alternatively, Liu et al. [33] proposed the adaptive-weighted TV(AwTV) regularization for SIR methods which outperforms TV-based and EPTV-based methods due to the consideration of the anisotropic edge property. However, these methods often lead to “staircase effects” and the appearance of noticeable blocky or patchy artifacts in the reconstructed images. Other attempts have been carried out on the research of high-order TV [34], TV-strokes [35] and CT reconstruction methods via TGV [36,37], which aimed to reduce the staircase artifacts without sacrificing edge sharpness.In this paper, a novel regularization scheme was proposed by modifying the conventional MRF regularization with the edge-preserving TGV, in order to eliminate the undesired artifacts and preserve the edges and details. Specifically, the TGV, which is a generalization of TV and capable to measure directional features and image high-order characteristics, was introduced into the novel MMRF regularization, aiming to incorporate smoothness up to a certain differential order, while still accounting for edges. Subsequently, a modified alternating iterative algorithm was adopted to optimize the associative objective function and to help design new algorithms. In summary, we proposed a modified-MRF (MMRF) regularization for the SIR algorithm via the penalized weighted least-squares (PWLS) criteria, which was defined as “SIR-MMRF”, to suppress over-smoothing and eliminate the undesired patchy artifacts that appeared in low-dose CT reconstructed images. Experiments on different phantoms were designed to validate the validity of the approach.Approximately, the process of low-dose CT measurement can be expressed as a discrete linear system(1)y=hfwherey=(y1, y2, …, yI)Tdenotes the measurements from I detector bins,h={hij} is the I×J system matrix,f=(f1, …, fJ)Tis a linear attenuation coefficients distribution of the object to be reconstructed. According to the Bayesian theory and the statistical measurement model Eq. (1)[16,22,26], the PWLS criterion with a regularization term R(f) can be expressed as(2)fˆ=argminf≥0(y−hf)T∑−1(y−hf)+βR(f)where∑=diag{σyi2}is a diagonal matrix with the ith element ofσyi2, which denotes the corresponding variance of every yi. Previous research [24] on CT measurements expounded that the projection data obey a Gaussian distribution after system calibration and logarithm transformation. The noise model can be described as(3)σyi2=ςiexpy¯iηwherey¯iis the expectation value of the projections measured by the ith bin, η is a object-independent parameter, and ςiis determined by detector bin i.According to the classical MRF theory, R(f) in Eq. (2) is a widely used quadratic-form regularization which can be described as(4)R(f)=∑j∑k∈Njϑjk(fj−fk)2where index j runs over all the pixels in the image domain, Njdenotes the search-window in the neighborhood of the jth pixel. As the weighting coefficient, ϑjkdenotes the interaction degree between the central pixel j and its neighboring pixel k, and is usually considered to be inversely proportional to the Euclidean distance between the two pixels. Through calculating the weighted sum of the potential function on the different neighboring pixels, the quadratic regularization provides the smoothed prior information. Due to the lack of global connectivity, however, over-smoothing often appear in the edges or fine structures of the reconstructed images.The concept of TGV was first proposed by Bredies [38]. Unlike TV, which only considers first-order derivatives, TGV utilizes high-order derivatives. TGV is a widely used regularizer to measure image characteristics up to a certain order of differentiation in image processing. Mathematically, TGV for a given imagefcan be expressed as(5)TGVαγ(f)=sup∫Ωfdivγvdlv∈CcγΩ,Symγℜd,divkv∞≤αkwhereCcγ(Ω,Symγ(ℜd))and Symγ(ℜd)={ξ:ℜd×⋯×ℜd→ℜ} denote the space of compactly supported symmetric tensor fields and the space of symmetric tensors on ℜd, respectively. div denotes the divergence operator,vdenotes the dual variable. In this paper, we use the second-order TGV which can be written more precisely as follows:(6)TGVα2(f)=sup∫Ωfdiv2vdlv∈Cc2Ω,Sd×d,v∞≤α0,divv∞≤α1where Sd×dis the space of all symmetric d×d matrices, and the first and second divergences are defined as(7)(divv)i=∑j=1d∂vij∂lj,div2v=∑j=1d∂2vii∂li2+2∑i<j∂vij∂li∂lj,1≤i≤dRespectively, the infinity ∞-norm of matrixvand the vector fields divvare given by(8)v∞=supl∈Ω∑i=1dvii(l)2+2∑i<jvij(l)21/2,(9)divv∞=supl∈Ω∑i=1d∑j=1d∂vij∂lj(l)21/2Note that TGV is able to incorporate smoothness up to a certain differential order while still accounting for edges. Subsequently, the second-order TGV can be generalized to represent a minimization problem [38,39](10)TGVα2(f)=minωα1∇f−ω1+α0εω1Here, Ω denotes the space of vector fields of bounded deformation, that is to say, the set of vector fields in which the weak symmetrized derivative ɛ(ω)=1/2(∇ω+∇ωT) is a matrix-valued Radon measure. Respectively,∇f−ω1andεω1denote the Radon norm for vector-valued and matrix-valued Radon measures.Inspired by the work of Bredies [38,39] that TGV takes directional features and high-order smoothness into consideration, in this paper, we modified the classical MRF regularization by introducing the edge-preserving penalty TGV and proposed a novel regularization model named MMRF(11)RMMRF(f)=∑jψfj−argminfϕfj(12)ϕ(f)=TGVα2(f′)+κ2f′−f22whereψ(Δ)=Δ. Previous work [22] showed that a stable convergence solution could be obtained only if the corresponding objective function in Eq. (2) were concave, which indicates that the regularization term R(f) in Eq. (2) should be convex. This convexity is proved in the following step. Like the method described in Ref. [40], suppose ψ(Δ) is convex, we easily get(13)ψ(γx+(1−γ)y)≤γψ(x)+(1−γ)ψ(y),γ∈0,1For any given two points(aj(1),bj(1))and(aj(2),bj(2))in the domain, RMMRF(f) would be proved to be convex when the following condition is satisfied,(14)∑jψγaj(1)−bj(1)+(1−γ)aj(2)−bj(2)≤γ∑jψaj(1)−bj(1)+1−γ∑jψaj(2)−bj(2)Because of that from Eq. (13) we can easily get(15)ψγaj(1)−bj(1)+(1−γ)aj(2)−bj(2)≤γψaj(1)−bj(1)+(1−γ)ψaj(2)−bj(2)we know that the sum of convex is also convex. So it is derived that RMMRF(f) is convex only if ψ(Δ) is convex. Other convex functions (e.g. ψ(Δ)=Δ2/2,ψ(Δ)=Δp,1<p<2,ψ(Δ)=Δp/1+Δ/δp−q1≤q≤p≤2) could be the choice. In this work, we selectedψ(Δ)=Δbecause there is a connection [40,41] between the median and the absolute value function. This choice makes the objective function in Eq. (2) easy to optimize. In summary, the cost function of the new proposed SIR-MMRF method for CT image reconstruction can be rewritten as(16)fˆ=argminf≥0(y−hf)T∑−1(y−hf)+β1RMMRF(f)Since the presented SIR-MMRF optimization in Eq. (16) is a joint estimation, we solve the problem by an alternate optimization method with three minimizing steps, which can be described as(17)(P1):fˆl+1=argminf≥0(y−hfˆl)T∑−1(y−hfˆl)+β1RMMRFfˆ1l+1(P2):fˆ1l+1=argminf1∑jψ(fˆl)j−fˆ2l+1j(P3):fˆ2l+1=argminf2,ωκ2f2l+1−fˆl22+TGVα2f2l+1we can solve the data-fidelity term constrained problem (P1) by iterative operation, but the obtained virtual solution may yield a noisy result. Then with the virtual solution of (P1) as initial value, we solved (P2) and (P3) and obtain a more precise solution, in which the noise-induced artifacts can be remarkably suppressed. In the implementation, we used the separable paraboloidal surrogates method [16,22,42,43] to solve (P1)(18)fˆjl+1=fˆjl−∑i=1I(1/σi2)hij([hfˆl]i−yi)+β1∂RMMRFfˆ1l+1/∂fˆl∑i=1I(1/σi2)hij∑t=1Jhit+β1∂2RMMRFfˆ1l+1/∂fˆl2where the superscript l=1, 2, …, L denotes the iteration index. Most obviously, (P2) can be easily solved. To solve (P3), the first-order primal-dual algorithm [39] was utilized in this work. Suppose ϑ1=∇f2−ω, ϑ2=ɛ(ω), we can get(19)F1(ϑ1)=α1∫Ωgϑ1dx,F2(ϑ2)=α0∫Ωϑ2dxThen, for any twoϑ1*andϑ2*, * represents the conjugate operation, we have(20)F1*(ϑ1*)=maxϑ1ϑ1*,ϑ1−F1(ϑ1)=maxϑ1ϑ1*,ϑ1−α1∫Ωgϑ1dx=0,ϑ1*≤α1g+∞,ϑ1*>α1g,F2*(ϑ2*)=maxϑ2ϑ2*,ϑ2−F2(ϑ2)=maxϑ2ϑ2*,ϑ2−α0∫Ωϑ2dx=0,ϑ2*≤α0+∞,ϑ2*>α0.Ifp=ϑ1*,q=ϑ2*, according to thatF1**=F1,F2**=F2, Eq. (19) becomes(21)F1(∇f2−ω)=maxp∇f2−ω,p−F1*(p),F2(ε(ω))=maxqε(ω),q−F2*(q)And then, the dual problem of (P3) can be deduced as(22)fˆ2l+1=minf2,ωmaxp,qκ2f2l+1−fˆl22+∇f2l+1−ω,p−F1*(p)+ε(ω),q−F2*(q)whereP={p=(p1,p2)Tp(x)≤α1g},Q=q=q11,q12q21,q22Tq∞≤α0, so, the iterative solution of Eq. (22) can be(23)pk+1=projPpk+δ∇(f¯2l+1)k−ω¯k,qk+1=projPqk+δ(ε(ω¯k)),(f2l+1)k+1=prox1(f2l+1)k+τdiv1pk+1,ωk+1=ωk+τpk+divℏ(qk+1),(f¯2l+1)k+1=2(f2l+1)k+1−(f2l+1)k,ω¯k+1=2ωk+1−ωkwheredivℏ=−ε*, δ and τ are two positive parameters, the projections can be easily obtained by pointwise operations.(24)projP(pˆ)=pˆmax1,pˆα1,projQ(qˆ)=qˆmax1,qˆα0(25)prox1(f2l+1)k=argminf2k(f2l+1)k−(f˜2l+1)k222τ+κ(f2l+1)k−(fˆl)k222=(f2l+1)k+κτ(fˆl)k1+κτThe pseudo-code for low-dose CT reconstruction with the novel SIR-MMRF method can be described as follows:Task: low-dose CT image reconstruction with SIR-MMRF algorithm1: Initializationf0=FBP(y),f10,f20,f¯20,ω0,ω¯0,p0,q0;β1,κ,δ,τ,α0,α1,l=0,∑=diag{σi2(yi)};2: Repeat while the stopping criterion is not met;3: (1) For each pixel;4:Updatefˆltofˆl+1using (18); End For;5: (2) Fork=0, 1, …, K−1;6:Update(f2l+1)kto(f2l+1)k+1using (23); End For;7:(f¯2l+1)0=(f¯2l)K,ω0=ωK,ω¯0=ω¯K,p0=pK,q0=qK;8:If(f2l+1)jK>0, then(fˆ2l+1)j=(f2l+1)jK,j=1,2,…,J;9:Else(fˆ2l+1)j=0,j=1,2,…,J; End If;10: (3)∂RMMRF(fˆ1l+1)∂fl=∑jfˆjl−(fˆ2l+1)jj′,j=1,2,…,J,∂2RMMRF(fˆ1l+1)∂(fˆl)2=∑jfˆjl−(fˆ2l+1)jf″,j=1,2,…,J;11:∑=diagσi2∑jhijfˆj; End;

@&#CONCLUSIONS@&#
