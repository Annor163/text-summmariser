@&#MAIN-TITLE@&#
Segmentation and optical flow estimation in cardiac CT sequences based on a spatiotemporal PDM with a correction scheme and the Hermite transform

@&#HIGHLIGHTS@&#
A new framework for segmentation and optical flow estimation applied to cardiac CT sequences is proposed.The segmentation is based on two processes: (1) A spatiotemporal point distribution model, and (2) A correction scheme that performs the segmentation of small details.The optical flow estimation uses a bio-inspired model based on the Hermite transform to code local image features.Both algorithms are combined to provide a powerful framework to assist the evaluation of heart mechanical problems.

@&#KEYPHRASES@&#
Segmentation,Spatiotemporal point distribution model,Local image features,Optical flow,Hermite transform,Cardiac CT sequences,

@&#ABSTRACT@&#
Purpose: The left ventricle and the myocardium are two of the most important parts of the heart used for cardiac evaluation. In this work a novel framework that combines two methods to isolate and display functional characteristics of the heart using sequences of cardiac computed tomography (CT) is proposed. A shape extraction method, which includes a new segmentation correction scheme, is performed jointly with a motion estimation approach.Methods: For the segmentation task we built a Spatiotemporal Point Distribution Model (STPDM) that encodes spatial and temporal variability of the heart structures. Intensity and gradient information guide the STPDM. We present a novel method to correct segmentation errors obtained with the STPDM. It consists of a deformable scheme that combines three types of image features: local histograms, gradients and binary patterns. A bio-inspired image representation model based on the Hermite transform is used for motion estimation. The segmentation allows isolating the structure of interest while the motion estimation can be used to characterize the movement of the complete heart muscle.Results: The work is evaluated with several sequences of cardiac CT. The left ventricle was used for evaluation. Several metrics were used to validate the proposed framework. The efficiency of our method is also demonstrated by comparing with other techniques.Conclusion: The implemented tool can enable physicians to better identify mechanical problems. The new correction scheme substantially improves the segmentation performance. Reported results demonstrate that this work is a promising technique for heart mechanical assessment.

@&#INTRODUCTION@&#
Cardiac CT is currently one of the main types of radiological images used for heart analysis. Image slices showing the structural composition of the heart can be obtained with CT scanners [1]. The continued improvement of multidetector CT scanners has increased the potential of cardiac CT as clinical tool for heart imaging [2]. Since heart failure is one of the main health problems in developed and developing countries [3], tasks focused on cardiac analysis are of main concern for physicians. Several benefits of CT systems have been recognized to evaluate heart functions. Quantification of the ejection fraction, left and right ventricular functions, and wall motion evaluation are examples of typical uses of cardiac CT data [4].The natural movement of the heart implies that its mechanical behavior must be evaluated as well. The spatiotemporal data obtained from cardiac CT studies can be used in computer-aided systems to evaluate the cardiac function, which has become essential over the past few years allowing faster assessments in the diagnosis process [5]. Since the left ventricle is vital for the proper functioning of the heart, it has become of major interest when analyzing cardiac images. In cardiac CT heart is commonly scanned at increments of 10% of the cardiac cycle providing a 4D dataset.Shape extraction for volume measurement and motion estimation are the most typical tasks for heart evaluation where computer-based algorithms are extensively used [6–9]. In this sense, development of new and most efficient algorithms, methods and mathematical models to analyze cardiac structures in CT data are activities of great interest for researchers.In a general sense, basic processes like segmentation and optical flow estimation are primary steps before applying higher processes like image interpretation. Cardiac CT sequences constitute great challenges for segmentation and motion estimation algorithms. A typical problem when working with medical images is that they may vary considerably from one patient to another, from an image processing point of view. These variations are perceived as changes of contrast, size and geometrical shape. Cardiac CT images do not scape from these kinds of problems. Even though development of segmentation and optical flow estimation algorithms imposes issues that researches have tried to solve for several decades, the problem remains open. Recent thorough reviews of segmentation techniques applied to cardiac images [10,11] conclude that shape extraction in heart images remains a very challenging task.Active Shape Models (ASM) [12] have gained enormous popularity during the last twenty years and have been extensively used for modeling 2D and 3D data in cardiac imaging [13–15]. We opted for this approach due to its ability to represent specific shapes of an image. Problems regarding the contrast and shape variability can be easily overcome with ASM-based algorithms. Related literature deals with active shape models as methods to analyze cardiac images [14,16]. ASM have also been combined with other methods with the aim of segmenting heart images [6]. Modifications of the original approach become necessary for improving the segmentation performance in some cases when the training samples are scarce [14]. However, issues of ASM are evident when the number of training samples is small. It is therefore necessary to design new strategies to overcome these problems.The dynamic nature of the heart has motivated researchers to design image tracking algorithms to process cardiac images [17,9,18]. Tracking heart structures like the left ventricle or the myocardial wall can be performed using optical flow estimation methods which also allow computing the displacements of the cardiac structures in a sequence of images. For this purpose we used a differential approach defined in the Hermite transform (HT) space. The HT is a bio-inspired human vision model that decomposes an image with a set of orthogonal functions defined by the Hermite polynomials. Image patterns and structures relevant to human vision perception such as oriented edges and textures can be efficiently represented with the HT. The proposed optical flow estimation approach using the HT allows defining local image constraints and a multiresolution strategy within differential scheme and are relevant in a perceptual sense as described in [8].Our main goal is to build a tool that may help physicians evaluate heart mechanical functions. In order to achieve our objective, we implemented a framework with two main processes: (1) A segmentation stage based on a statistical shape model and a new correction scheme, and (2) An optical flow estimation approach based on the Hermite transform. For the first process we have designed a novel correction method that substantially improves the segmentation performance. The goal of the new correction method is to refine the segmentation previously achieved with the statistical shape model. It consists of a deformable scheme that combines three image parameters: histogram, gradient and a binary pattern. These parameters are locally computed for each point of the contour of the segmentation. This work is entirely focused on analyzing sequences of cardiac CT images (2D + time). The algorithms are specifically applied to the left ventricle because it is responsible for some of the most vital functions of the heart. Cardiac CT studies are analyzed using the original axial view. Nevertheless, the method can be extended without major problems to other views. Although short and long axis are the most accepted views used for cardiac analysis, the original axial view is also very important for this task [19]. Combined results of both algorithms are presented. Vectors indicating the motion of the left ventricle are jointly used with contours of the segmentation. Results are evaluated with several image sequences using quantitative and qualitative analysis.The rest of the paper is organized as follows. Material used in this work is described in Section 2. Methods are depicted in Section 3. Here, segmentation and optical flow approaches are included. Results and discussions are finally presented in Sections 4 and 5 respectively.Our dataset consists of 40 sequences of cardiac CT images. Selected sequences used for evaluation show the left ventricle at half of the heart. The tomographic studies were acquired with a SIEMENS 16-slice CT system at 120kVp of tube voltage and 900mA. The scanner is composed of 128 detectors and is synchronized with the ECG signal. Each image has a size of 512×512 pixels, quantized to 12 bits per pixel. A contrast agent was also applied to each patient. Each sequence is composed by 10 frames showing the heart variation throughout the entire cardiac cycle from diastole to systole.

@&#CONCLUSIONS@&#
We implemented a framework for the analysis of cardiac CT sequences using a shape extraction method and an optical flow estimation approach. The left ventricle was used as object of interest. We firstly performed the corresponding segmentation using a STPDM which consists of a trained statistical model that codes spatial and temporal information of the sequences. Errors of the segmentation were subsequently corrected using an algorithm that incorporates three image parameters for edge characterization. These parameters were embedded as image energies into an active contour model. Afterwards, an optical flow estimation method was calculated using a bio-inspired differential approach. Combining the boundaries of the segmented object and the displacements vector field obtained from the optical flow estimation technique enables physicians to carry out a better identification of mechanical problems. The proposed framework was validated with several sequences of cardiac CT images and compared with other techniques.Results were individually evaluated for each frame of the sequence using several metrics. In general, the lowest performance achieved in our segmentation method was obtained for frames at half the cardiac cycle. These frames are acquired at the end of the contraction phase, i.e., when the heart is bombing flood to the body. The bar diagram (Fig. 6) with the DSC analysis and the metric distance reflect this interesting behavior. The poor definition of edges, the low contrast and the irregular shape of the left ventricle are causes for this result. Moreover, this can also be a consequence of the presence of the left atrium in the images at this cardiac phase when working with the original axial view of tomographic studies. The high irregularity of the structures found in this part of the cardiac cycle makes the segmentation task more complicated.In Table 1 we present comparative results of the two stages of the segmentation: STPDM and correction algorithm. As can be seen, the segmentation is substantially improved with our correction scheme. In all reported cases, the segmentation error is reduced when applying the correction method. Because the correction method follows the segmentation of the statistical model, the level of correction naturally depends on the performance initially achieved with the STPDM. From Fig. 8 and Table 1, it can be noted that bigger corrections are reached at the contraction phase of the cardiac cycle. It is a logical finding because the performance of the STPDM is lower at this phase. Therefore, fine details of the object boundaries are efficiently segmented with the proposed correction scheme, reducing the segmentation errors previously obtained with STPDM. Selection of optimal weight parameters is a difficult task. Since each image sequence presents different characteristics of contrast and noise, values of the parameters may require a specific configuration for each example. In this work we set the weight parameters experimentally. However, finding automatic ways to select them could be an interesting future contribution. In cases when the contrast of the images is poor and the noise is very high, it is more convenient to set higher values to the parameter that attempts to preserve the shape, as well as to the local intensity parameter. In the correction segmentation algorithm, these weight parameters correspond to μ and α respectively. When edges and contrast are well defined, it is preferable to give more relevance to the energies that act upon the edge features directly (λ and β).The vector field was obtained using a differential approach incorporated into the HT domain. Several local restrictions based on the SHT, non-linear constraints and a multiresolution approach for large displacements were adopted. Quantitative analysis was used to evaluate the performance. The forward reconstruction error obtained for the frames of the sequences shows better general performance with the proposed method. From Fig. 13 is clear that the best results (lowest error) were achieved during the relaxation phase of the cardiac cycle. This part of the cardiac phase presents smaller and more regular changes of the left ventricle motion. The worst result was consequently obtained in frames at the beginning of the systolic cycle.The vector field in the optical flow estimation method is computed using the steered Hermite coefficients. Since the coefficients have been steered using the direction of maximum energy, the image noise is automatically filtered with this operation. It means, the steering property of the HT is indirectly filtering the image noise.The proposed application, in which the vector field is visualized on the contour that encloses the left ventricle, is a promising technique for mechanical assessment of cardiac structures. Even though this technique was applied to the left ventricle, in future works it can be extended to others objects and others anatomical axes.Since heart is a volumetric organ whose natural movement occurs in a 3D space, the logical task should be performing 3D evaluations using both segmentation and motion analysis. In the case of the segmentation, volumetric analysis can be provided by running the proposed algorithm slice by slice on each cardiac volume and then building the 3D model from the segmented slices. In the case of motion estimation, the task is more complex since it implies to analyze more variables in order to achieve accurate 3D vector field estimations. On the other hand, even though the heart is a structure that moves in a 3D space, most physicians are still evaluating the heart mechanical function using image sequences. Nevertheless, the future trend aims at providing 3D cardiac motion analysis [3] which also implies training physicians to diagnose based on moving volume and surface models. As future work, we propose to extend this framework to provide 3D evaluations.None declared.