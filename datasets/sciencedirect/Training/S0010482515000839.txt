@&#MAIN-TITLE@&#
Automatic detection of atrial fibrillation using stationary wavelet transform and support vector machine

@&#HIGHLIGHTS@&#
A novel method for automatic detection of Atrial fibrillation (AF) is proposed.This method eliminates the need for P and/or R peak detection.Sensitivity and specificity of the method is 97.0% and 97.1%, respectively.It holds several interesting properties suitable for practical applications.

@&#KEYPHRASES@&#
Atrial fibrillation,Support vector machine,Wavelet transform,Cardiac arrhythmia,Log-energy entropy,ROC curve analysis,

@&#ABSTRACT@&#
BackgroundAtrial fibrillation (AF) is the most common cardiac arrhythmia, and a major public health burden associated with significant morbidity and mortality. Automatic detection of AF could substantially help in early diagnosis, management and consequently prevention of the complications associated with chronic AF. In this paper, we propose a novel method for automatic AF detection.MethodStationary wavelet transform and support vector machine have been employed to detect AF episodes. The proposed method eliminates the need for P-peak or R-Peak detection (a pre-processing step required by many existing algorithms), and hence its performance (sensitivity, specificity) does not depend on the performance of beat detection. The proposed method has been compared with those of the existing methods in terms of various measures including performance, transition time (detection delay associated with transitioning from a non-AF to AF episode), and computation time (using MIT-BIH Atrial Fibrillation database).ResultsResults of a stratified 2-fold cross-validation reveals that the area under the Receiver Operative Characteristics (ROC) curve of the proposed method is 99.5%. Moreover, the method maintains its high accuracy regardless of the choice of the parameters׳ values and even for data segments as short as 10s. Using the optimal values of the parameters, the method achieves sensitivity and specificity of 97.0% and 97.1%, respectively.DiscussionThe proposed AF detection method has high sensitivity and specificity, and holds several interesting properties which make it a suitable choice for practical applications.

@&#INTRODUCTION@&#
Atrial fibrillation (AF) is the most common cardiac arrhythmia with an estimated prevalence of 1% corresponding to 2.3 million patients in the US and 4.5 million in the European Union [1]. This prevalence is strongly associated with age, such that over 17% of people aged 85 or above are AF patients [2]. It is expected that the number of AF patients in U.S. will increase by 2.5-fold to more than 5.6 million people by 2050 [3]. This increase not only reflects the growing population of elderly individuals, but also improved survival of people with predisposing conditions to AF (e.g. ischemic heart disease) [4]. The presence of AF is associated with a 5-fold increased risk of stroke [5] and about 2-fold increased risk of death, independent of other risk factors [6]. Furthermore, due to high rates of hospitalization and considerable health resource utilization, the economic and clinical burden of AF is substantial and will continue to increase in the future [7].AF is usually characterized by rapidity and irregularity of ventricular contraction [8]. The chronic forms of AF can be paroxysmal AF (more than one episode with spontaneous termination within seven days); persistent AF (not self-terminated, or lasted more than seven days) and permanent AF (not terminated, or terminated but relapsed) [9]. Silent or asymptomatic AF can also occur in any of these temporal forms, carrying a similar prognosis to symptomatic AF [10]. Chronic AF adversely affects the blood flow dynamics and can result in the stroke. Early and accurate detection of AF and its management (e.g. anticoagulation, antiarrhythmic therapy and radiofrequency ablation) could substantially help in prevention of the complications associated with the chronic AF.Currently, the diagnosis of AF mainly rests on the presence of related symptoms (e.g. shortness of breath and fatigue), followed by an electrocardiogram (ECG) study to verify the diagnosis. During the ECG study, a trained clinician/technician visually inspects the ECG signal collected over short period of time (e.g. less than 48h) to identify the AF associated chaotic patterns or abnormal changes in the waveform morphology.Early and accurate diagnosis of AF is a challenging task. As a result, a majority of the early stage and easily treatable AF cases are not diagnosed in time and evolves into chronic debilitating AF with high cardiac related complications. Several factors hinder the accurate and early detection of AF:•Many of the AF patients do not experience symptoms. Hence, a considerable number of AF cases are undetected or diagnosed fortuitously when the subject is being evaluated for other cardiac complications. Moreover, the studies have shown that a good correlation does not always exist between symptoms and episodes of AF [11].ECG study can miss detection of AF in patients with paroxysmal intermittent AF who are not experiencing AF episodes during the study.Visual inspection of hours of collected ECG is time consuming.Accurate interpretation of ECG study requires extensive training and experience. Hence, the reliability of diagnosis is dependent on the level of training or experience of the clinician. In fact, studies have shown that many primary care practitioners are not able to detect AF (on an ECG) with sufficient accuracy to guide therapy [12].A possible solution to this problem is automatic AF detection using ambulatory monitoring. This approach could eliminate the need for visual inspection, and contribute to early and accurate detection of AF by allowing for an in-depth analysis of ECG and identification of abnormal patterns.Over the last two decades, several algorithms have been developed for automatic AF detection. Many of these algorithms either rely on the absence of P-waves (replaced by rapid oscillations or fibrillatory waves) [13–16] or R–R irregularities [17–21], or combination of both characteristics to detect AF episodes [22–24]. As P-waves are prone to contamination with motion and noise artifacts, the AF detection algorithms solely based on the absence of P-waves perform poorly in the presence of noise [25]. Therefore, employing heart rate variability for AF detection has become a preferred approach in recent years. But many of these R–R interval based methods compare the density histogram of R–R intervals for a segment of data with previously compiled histograms of R–R intervals during AF using the Kolmogorov–Smirnov test [18,24,26]. Since these algorithms require storage of large amount of histogram data, they may not be suitable for implementation in an ambulatory monitoring device with limited memory and processing power. Other R–R algorithms need various parameters׳ tuning to guarantee the high accuracy of AF detection [19–21]. Furthermore, most of the existing methods do not perform well with short data segments (less than one minute) [25]. This deficiency may result in missing short-duration AF episodes (prevalent in Paroxysmal or early stage AF), less accurate calculation of AF burden (a measure of the percent of time a patient spends in AF), and a lower speed of AF detection. Lastly, a majority of existing approaches for AF detection require P or R peak detection as a pre-processing step and consequently their performance will degrade if the related peaks are missed or erroneously detected.Aimed at addressing the existing issues, the current work proposes a novel method for automatic AF detection using stationary wavelet transform (SWT) and support vector machine (SVM). As opposed to traditional methods, the proposed method does not require P or R peak detection pre-processing step. Only few parameters are involved in the development of the proposed method and the method maintains its high accuracy regardless of the choice of the parameters׳ values. The proposed method also performs well even for short data segments of 10s. In what follows, we first describe (Section 2) our proposed method in detail. Then in Section 3, we present the result of applying the proposed method on MIT-BIH Atrial fibrillation database. These results are discussed and compared with those of the existing methods in Section 4. Conclusions are presented in Section 5.The proposed method consists of three major steps: pre-processing; feature extraction; and AF classification.Fig. 1 illustrates a block diagram of various steps of this method. In the following sub-sections, we will describe each step in detail.The incoming ECG signal is divided everyTseconds into segments of lengthT. An elliptical band-pass filter with pass-band of 0.5–50Hz (effective filter order of 10) is applied to each data segment to remove noise and baseline wander. After filtering in the forward direction, the filtered sequence was then reversed and run back through the filter to obtain a zero-phase distortion. Then a wavelet transform is performed on the filtered data segments.Wavelet transform has proved to be a useful tool for denoising, delineation and compression of signals. Using wavelet transform, one can observe a signal at different scales where each scale emphasizes on various signal properties and characteristics [27]. Wavelet transform allows for the analysis of transients, aperiodicity and other non-stationary signal features where, through the interrogation of the transform, subtle changes in signal morphology may be highlighted over the scales of interest [28].In the current work, we employ wavelet transform which allows for arbitrarily high resolution of the high frequency signal components (in contrast to short term Fourier transform) and then extract features that would enable us to detect AF episodes. Among several wavelet transform techniques, we choose stationary wavelet transform (SWT). SWT is time-invariant and at each decomposition level, its wavelet coefficients carry the same number of samples (temporal information) as that of the original signal. SWT overcomes the problem of repeatability and robustness of the analysis which exists with a discrete wavelet transform. We leverage these remarkable properties of SWT, and employ it for the purpose of AF detection.It is known that to implement SWT withL-levels on a signal, the length of signal should be a multiple of2L. In order to meet this data length requirement, we zero-pad the filtered data segment (Let us call the zero-padded signalx(n)wheren=1,...,N).Fig. 2 presents a tree-structure diagram of anL-level SWT(ℓ=1,2,...,L).In this figure,G(z)andH(z)are high-pass and low-pass filters respectively, designed based on the wavelet basis function, andX(z)is the zero-padded signal in z-domain. Note that at decomposition levelℓ, the impulse responses of high-pass filterG(z2ℓ−1)and low-pass filterH(z2ℓ−1)are up-sampled versions (by a factor of 2) of impulse responses of high-pass filterG(z2ℓ−2)and low-pass filterH(z2ℓ−2)at previous level(ℓ−1). The detail coefficientsdℓ(n)and coarse coefficientscℓ(n)in time domain can be recursively obtained as(1)Dℓ(z)=G(z2ℓ−1).Dℓ−1(z)⇒dℓ(n)=∑mg(n).dℓ−1(n−2ℓ−1m),Cℓ(z)=H(z2ℓ−1).Cℓ−1(z)⇒cℓ(n)=∑mh(n).cℓ−1(n−2ℓ−1m).n=1,...,NHence, at the end of pre-processing step, a total of2×Ltime series are generated (L detail coefficients and L coarse coefficients), where each coefficient time series has the same time resolution as the original signalx(n). Note that the optimal value for the length of the data segment (T) is not a trivial choice. The parameter tuning to maximize the performance of the proposed method will be discussed later in Section 2.3.Following the calculation of wavelet coefficients, at this step, two features are extracted for each coefficient: Peak-to-average power ratio; and log-energy entropy. These features are later used in combination with a support vector machine classifier to detect AF.The power spectrum of the wavelet coefficients at each level provides spectral information of ECG signal for different scales [29], and hence it can be used to analyze atrial activity. In fact, power spectrogram of detail coefficient atℓthlevel(SℓD(f))and that of coarse coefficient(SℓC(f))can be expressed as(2)SℓD(f)=Ε{|Dℓ(f)|2},SℓC(f)=Ε{|Cℓ(f)|2},whereΕdenotes expectation operation, andDℓ(f)andCℓ(f)are Fourier transforms of detail coefficient(Dℓ(f)=Dℓ(z)|z=ej2πft)and coarse coefficient(Cℓ(f)=Cℓ(z)|z=ej2πft), respectively.It is known that atrial activity usually occurs in the frequency range of F=[4–9Hz]. Therefore during an AF episode, one can expect to have higher power concentration in this frequency range [25]. Peak-to-average power ratio has been shown to be effective in capturing the power distribution profile in the aforementioned frequency range [29], and is obtained according to the following formula:(3)ρℓD=maxSℓD(f)f∈F∫f∈FSℓD(f),ρℓC=maxSℓC(f)f∈F∫f∈FSℓC(f),whereρℓDandρℓCare Peak-to-average power ratio of detail and coarse coefficients at levelℓ, respectively. By calculatingρℓDandρℓCfor all levelsℓ={1,2,...,L}, we obtain 2×L power spectrum related features for each data segment.Entropy is a measure of the degree of disorder, uncertainty or randomness of a signal. Wavelet entropy provides useful information about the underlying dynamic system (associated with a signal) over different frequency bands. For example, entropy of a mono-frequency signal is very low, given that the wavelet coefficient at the decomposition level containing the representative frequency will contain most of the signal energy. In contrast, a random white noise has high entropy, as there is a significant contribution of energy from wavelet coefficients at various decomposition levels [30].During AF, electrical discharges conducted from the atrium into the ventricles are irregular and disorganized. Consequently, one can expect that the ECG signal demonstrates more degree of randomness and a higher entropy during an AF episode [30]. Leveraging this note, in order to reveal underlying dynamic process relevant to AF pathology, we calculate the wavelet entropy of the signal. Various wavelet entropy measures have been defined. In this paper, we use a simple non-normalized log-energy entropy [31] (which is conveniently included in Matlab Wavelet Packet and quickly executable) defined as(4)EℓD=∑n=1Nlog(dℓ(n))2,EℓC=∑n=1Nlog(cℓ(n))2,whereEℓDandEℓCare the log-energy entropy of detail coefficient and coarse coefficient atℓthlevel, respectively. Calculation of log-energy entropy for all wavelet coefficients results in obtaining2×Ltime related features for each data segment. Hence, at the end of this step, a vector of4×Lfeatures are extracted for each data segment as(5)Φ=[ρ1C...ρLCρ1D...ρLDE1C...ELCE1D...ELD]T.Our goal is to classify each data segment into AF or non-AF category using4×Lextracted features. For this purpose, we employ support vector machine (SVM) as our classification algorithm. SVM is a non-parametric binary classifier which has shown promising results in various medical diagnostics [32–35].In a conventional problem of binary classification, a data point is viewed as a p-dimensional vector which belongs to one the two possible categories. An SVM classifies these data points by finding the best (p−1)-dimensional hyperplane that separates all data points of one class from those of the other class. The separating hyperplane has the largest margin between the two classes (Margin is the maximal width of the slab parallel to the hyperplane that has no interior data points). SVM then classifies new samples based on which side of the hyperplane they fall into and how far the samples are from the hyperplane (SVM score)[36]. One of the major advantages of SVM is that in addition to linear classification, it can efficiently perform a non-linear classification [37]. Using a kernel trick, samples are mapped into higher-dimensional feature space where a linear classifier can separate the two classes with the largest margin among the samples. Mapping the separating hyperplane back to the original space results in having a non-linear classifier.For our AF detection, we use a common kernel choice, Gaussian Radial Basis Function kernel(6)K(Φi,Φj)=e−‖Φi−Φj‖222σ2,with scaling factorσ=1.ΦiandΦjare features of two data segments and‖Φi−Φj‖22is the squares Euclidean distance between the two feature vectors. The separating hyperplane for our SVM classifier is obtained using the conventional “Least-Squares” method.To evaluate the performance of the proposed method, we employ MIT-BIH Atrial fibrillation (MIT-BIH AFIB) dataset [38], the most popular and most frequently used publicly available dataset for AF detection. This dataset contains 23 annotated records of ECG signal from atrial fibrillation patients (mostly paroxysmal) with sampling frequency of 250Hz and 12-bit resolution over a range of ±10mV. Each record is about 10h-long and the whole dataset includes slightly less than 234h of data. The dataset has 605 annotated episodes: 291 atrial fibrillation episodes with average time duration of 115s, 14 atrial flutter episodes with average time duration of 419s, 12 episodes of junctional rhythm with average time duration of 27s and 288 episodes of all other rhythms with average time duration of 174s.Fig. 3 presents examples of ECG signal during four annotated episodes.Daubechies 5 is an orthogonal wavelet resembling the ECG waveform in morphology [29]. Hence, we choose the Daubechies 5 wavelet as the mother wavelet to perform wavelet analysis. Given the sampling frequency of 250Hz and the frequency range of atrial activities (4–9Hz) [39], aL=6level wavelet transform is implemented. A periodogram spectral estimator with a Hamming window is used to obtain the power spectrum of each wavelet coefficient.The original beat-to-beat annotations of data are converted to aT-second resolution (Tis the duration of each data segment) by using a minimum percentage parameterP[19,20]: A data segment is classified as a true AF only if the percentage of annotated AF beats in that data segment is more thanP. A two-fold stratified cross-validation on the feature vectors (extracted from the dataset) is employed to train and test the classifier. At the testing phase of each fold, SVM׳s scores for the testing samples (distance of the testing samples to the separating hyperplane) are obtained and compared with a pre-set thresholdςto classify corresponding testing samples. The classification results (from each fold) is then compared to the ground truth (converted annotation) and number of True Positive (TP), False Negative (FN), True Negative (TN) and False Positive (FP) cases are calculated. Finally, the results from the two folds are combined to calculate True Positive Rate (TPR) asTPR=TP/TP+FN, False Positive Rate (FPR) asFPR=FP/FP+TNand Accuracy (ACC) asACC=TP+TN/TP+TN+FP+FN.In order to obtain the optimal values of the parameters of the proposed method (T,Pandς), an exhaustive standard Receiver Operating Characteristic (ROC) Curve analysis is implemented as the following: ParameterT(length of the data segment in seconds) is varied over a reasonable range of 10–120s with incremental steps of 5s. ParameterP(percentage threshold for annotation of AF data segments) is varied from 0% to 100% with incremental steps of 10%. Then for each specific value ofTandP, an ROC curve is derived by varying the score thresholdςfrom −1.5 to 1.5 with incremental steps of 0.01. The ROC with the highest Area Under the Curve (AUC) is used to obtain the optimal values of parametersTandP. Furthermore, the score thresholdςcorresponding to the knee point of this ROC curve (closest point to ideal performance of FPR=0 and TPR=1) is considered as the optimal value for score threshold.To further investigate the efficacy of the chosen classification algorithm (SVM), we compare the ROC curve of AF detection using SVM classifier with those of three other popular classifiers—viz., Naïve Bayesian, Linear discriminant Analysis (LDA), and Logistic Regression. For this purpose, the ROC curves of other classifiers are obtained similar to that of SVM by varying either the score threshold (logistic regression), or a threshold on the AF posteriori (Naïve Bayesian, LDA). Finally, we compare the performance of our proposed method with those of the existing AF detection methods in terms of various measures including accuracy, transition time, and computation time.

@&#CONCLUSIONS@&#
