@&#MAIN-TITLE@&#
A fast algorithm to estimate inverse consistent image transformation based on corresponding landmarks

@&#HIGHLIGHTS@&#
We propose a simple and efficient inverse consistent image transformation estimation algorithm.Forward and backward transformations between two corresponding point sets are estimated simultaneously.Inverse consistency errors of transformations between two images are reduced.Convergence of our algorithm is analyzed.

@&#KEYPHRASES@&#
Image registration,Inverse consistency,Forward transformation,Backward transformation,

@&#ABSTRACT@&#
Inverse consistency is an important feature for non-rigid image transformation in medical imaging analysis. In this paper, a simple and efficient inverse consistent image transformation estimation algorithm is proposed to preserve correspondence of landmarks and accelerate convergence. The proposed algorithm estimates both the forward and backward transformations simultaneously in the way that they are inverse to each other based on the correspondence of landmarks. Instead of computing the inverse functions and the inverse consistent transformations, respectively, we combine them together, which can improve computation efficiency significantly. Moreover, radial basis functions (RBFs) based transformation is adopted in our algorithm, which can handle deformation with local or global support. Our algorithm maps one landmark to its corresponding position exactly using the forward and backward transformations. Moreover, our algorithm is employed to estimate the forward and backward transformations in robust point matching, as well to demonstrate the application of our algorithm in image registration. The experiment results of uniform grids and test images indicate the improvement of the proposed algorithm in the aspect of inverse consistency of transformations and the reduction of the computation time of the forward and the backward transformations. The performance of our algorithm applying to robust point matching is evaluated using both brain slices and lung slices. Our experiments show that by combing robust point matching with our algorithm, the registration accuracy can be improved and the smoothness of transformations can be preserved.

@&#INTRODUCTION@&#
Image transformation is widely used to map images, and plays an important role in imaging analysis such as image registration, animation and shape atlases construction. In image registration, one of the key issues is the transformation model used between the source image and the target image. Transformations between two images are expected to be one-to-one to make sure that each point in the source image just has one corresponding point in the target image and vice versa. In particular, for medical image registration, symmetry and inverse consistency are two commonly required properties of transformations [1] to produce the kind of deformation results, which are smoother and present more biological meaning. Symmetric or inverse consistent registration methods guarantee that the registration results are invariant to the order of the choice of source and target images. However, most registration methods are asymmetric. The registration results depend on the order of images, which lead to algorithm-induced artifacts in detected changes [2].Symmetric registration algorithms construct symmetric objective functions and use exact inverse transformations guaranteed by diffeomorphisms, to make unbiased registration results when the order of input images are interchanged [3–10]. Beg et al. [3] introduced two consistent constraints into the Large Deformation Diffeomorphic Metric Mapping (LDDMM) algorithm to make the registration results invariant to the order in which the images are chosen. Avants et al. [4] proposed the symmetric diffeomorphic normalisation method which balanced transformation smoothness against the cross-correlation of intensities between images. The symmetric diffeomorphic normalisation methods are employed to perform the registration of diffusion-weighted images [5], automated segmentation of mouse heart using gated 4D mirco-CT data [7]. Transformations estimated by symmetric algorithms are invertible, differentiable and bijective. Werner et al. compared the performance of diffeomorphic registration with that of symmetric diffeomorphic registration applied to the lung motion estimation in thoracic 4D CT data. They found that diffeomorphic registration and symmetric force definition led to an increased smoothness of the estimated motion fields [8]. However, symmetric diffeomorphic registration has high computational cost generally. Lorenzi et al. [9] utilized stationary velocity fields (SVFs) to simplify the transformations in the log space for symmetric diffeomorphic registration. In addition, symmetric algorithms led to an increased smoothness of the deformation fields when the register images are very similar (small deformation), but might lead to non-topology-preserving deformation results for large non-linear deformation in images.Inverse consistent registration algorithms jointly estimate the forward and backward transformations, and impose a constraint that the forward and backward transformations are inverse to each other [11–16]. That is, the correspondence made by the forward transformation is consistent with the one by the backward transformation. The inverse consistency of the forward and backward transformations defines a unique correspondence between two images, which can produce smoother deformation results with more biological meaning. Christensen et al. [11] first proposed the idea of consistent image registration. They jointly estimated the forward and backward transformations subject to the constraint that the forward transformation is the inverse function of the backward transformation, and vice versa, to estimate a differentiable and one-to-one transformation. Compared with symmetric algorithms, inverse consistent registration algorithms explicitly penalize asymmetry and lead to more coherent results, such as coherent dose accumulation in image guided radiotherapy [17]. Bender et al. [18] demonstrated the possible utility of consistency metrics for contour based deformable image registration using TPS and EBS deformation; they pointed that good performance in consistency metrics is a necessary but not sufficient condition for an accurate deformation method. Most importantly, inverse consistent transformations preserve the natural topology of an image, that is, they ensure the neighborhood relationships between structures to be same before and after deformation, maintain connected structures remain connected, and avoid artifacts such as “folding” and “tearing” of images. In addition, inverse consistent registration algorithms also make the mapped results be invariant to the mapping direction. In some applications, they seem to be more robust and produce accurate registration [14].Let I⊂Ωhand J⊂Ωgbe the source and target images, h and g be the forward and backward transformations, h:Ωh→Ωg, g:Ωg→Ωh, respectively. An inverse consistent registration satisfies h∘I=J, g∘J=I, g∘h=idh, and h∘g=idg, where the symbol ∘ represents function composition which applies one function to the result of another to produce a third function. idhand idgare the identity maps, idh:Ωh→Ωh, idg:Ωg→Ωg, idhassigns to each element x of Ωhthe element x of Ωh, the identity function idgassigns to each element y of Ωgthe element y of Ωg. h∘g=h(g(y)) and g∘h=g(h(x)) are the composition functions of h and g. For image registration, Ωh=Ωg=Ω is supposed. The method of introducing the inverse consistent constraints into the registration procedure can be divided into two categories: intensity-based and landmark-based. Intensity-based inverse consistent methods aimed at aligning dense image intensities by including inverse consistent penalties in the optimization algorithm [19–23]. Intensity-based algorithms work better for small deformation problem, but lead to mis-registration for large deformation in images.The other one is landmark-based method, which attempts to find the correspondence of landmarks between images [12,24–27]. Commonly used point landmarks are the unique points in intensity map, such as tip-like, saddle-like and sphere-line structure. Compared with intensity-based image registration algorithms, landmark-based image registration algorithms avoid solving large system of equations and can handle image registration problem with large deformation. Moreover, landmark-based methods are more flexible because registration features can be customized for the particular study [28].For transformations based on the corresponding landmarks, a set of corresponding landmarks in the images is given, and the estimated transformation is required to map the given landmarks to their corresponding landmarks. Johnson et al. [12] added consistent constraints in the cost function to minimize the error between the forward transformation and the inverse of the backward transformation, and vice versa, given a set of corresponding points. The initial forward and backward transformations are estimated by the thin-plat spline algorithm with periodic boundary conditions based on the correspondence of landmarks. Johnson et al.'s algorithm is useful for image registration with small deformation. He and others [29] expanded Johnson et al.'s algorithm and concatenated a sequence of small deformation transformations to estimate the forward and backward transformations, which are inverse to each other for large deformation registration. However, since inverse of transformations are computed many times during the iterative procedure, Johnson et al.'s algorithm takes long time to compute. Moreover, the correspondence between control points cannot be ensured for Johnson et al.'s algorithm [30].Researchers have done much work in accelerating the computation of inverse consistent transformations. Chen et al. [19] sought for two pair of half-way transformations that deform source image and target image to an intermediate image and vice versa in a variational registration model. These half-way transformations are inverse to each other to avoid the directional computation of the inverse transformations, and the computational cost of estimating these half-way transformations is much less than the one that estimate the forward and backward transformations between source and target images. Leow et al. [20] proposed a numerical algorithm to solve minimization the inverse consistent constraints in only the forward direction and uni-directionally without explicitly involving the inverse function. Yang et al. [21] computed the forward and backward displacement fields that are inverse to each other in smaller incremental steps by minimizing a symmetric optical flow cost function. A triangulation interpolation is employed to compute the inverse displacement fields quickly. Guetteret et al. [22] used an interleaved optimization scheme constrained by inverse consistency to estimate forward and backward transformations that are inverse to each other. It costs 45% additional time than one-directional registration algorithm. Papiez et al. [23] adopted a Newton–Raphson like method to calculate the inverse transformation, which is more accurate and robust than the method proposed by Christensen and Johnson. Rogelj et al. [10] treated both the source and the target images equally and interacted both of them through forces. The forces that appear on the source image to match it with the target image is related to the image similarity and transformations. As a consequence, transformations put the whole system into the equilibrium state of minimal energy. The advantage of Rogelj et al.'s algorithm is that it does not compute transformation inverses at all. Bondar et al. [27] simultaneously estimated the forward and backward transformations using the robust point matching algorithm. It did not compute the inverses of these two transformations.Improvement of image registration accuracy can be achieved by solving inverse consistent transformation between images. However, solving the inverse consistent transformations problem is usually much more complicate, and is also very time consuming. In this paper, we propose a fast and efficient algorithm to estimate inverse consistent transformations between images. The proposed algorithm finds the forward and backward transformations that are inverse to each other based on the given correspondence of landmarks. Through using the proposed algorithm, there is no procedure of computing the inverse functions. The forward and backward deformation fields are updated according to the consistent error in the procedure iteratively. Compared with the algorithm proposed by Johnson et al., our algorithm takes much less computation of inverse consistent transformations, which makes it possible for problems with iterative optimization procedures. Moreover, landmarks are mapped exactly to their target positions during the procedure in our algorithm instead of swinging around their target positions in Johnson et al.'s method. Furthermore, we employ our algorithm to estimate the transformations between two point set used in robust point matching to demonstrate the performance of our algorithm in image registration.The remainder of this paper is organized as follows. We describe our algorithm to estimate inverse consistent transformations in Section 2. Application of our algorithm in robust point matching is given in Section 3. Experiments on random point sets and medical images demonstrate the feasibility of our algorithm in Section 4. Finally, conclusion is presented in Section 5.

@&#CONCLUSIONS@&#
This paper proposed a fast and efficient algorithm to estimate the forward and backward transformations at the same time based on the correspondence of landmarks. The forward and backward transformations are required to be inverse to each other, but no computation of the inverse transformation fields is needed in our algorithm. The convergence of our algorithm is proved in theory. Theoretical analysis results also show that the corresponding relationships between source landmarks and target landmarks are preserved exactly using the forward and backward transformations estimated by our algorithm. By introducing our algorithm to the robust point matching, the forward and backward transformations can be estimated without given corresponding control points. Our algorithm is extensively evaluated based on brain and lung dataset in both inter and intro-subject registration settings. Experiment results indicate that the inverse consistency error of the forward and backward transformations using our algorithm is smaller than CL-TPS algorithm, and the computation time of our algorithm is reduced significantly. Moreover, by combing our algorithm and robust point matching, image registration accuracy can be improved and more smooth transformations can be obtained.The authors declared that they have no conflicts of interest to this work.