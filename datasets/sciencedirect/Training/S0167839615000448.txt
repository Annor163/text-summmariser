@&#MAIN-TITLE@&#
A normalized basis for condensed

@&#HIGHLIGHTS@&#
B-spline basis of the quadratic condensed Powell–Sabin-12 spline space.Determination of control points.Discrete and differentiable quasi-interpolants.

@&#KEYPHRASES@&#
B-spline,Powell–Sabin-12 triangulation,Blossoming,Marsden's identity,Quasi-interpolation,

@&#ABSTRACT@&#
The purpose of this article is the construction of a normalized basis for a quadratic condensed Powell–Sabin-12 macro-element space introduced by Alfeld et al. (2010). The basis functions have a local support, they are nonnegative, and they form a partition of unity. The construction of this basis is adopted from Dierckx (1997) and Speleers (2010a), and is based on the determination of a set of triangles that must contain a specific set of points. The proposed basis can only be constructed on triangulations with a maximal angle less thanπ2.

@&#INTRODUCTION@&#
Piecewise quadratic triangular macro-elements are very useful in the construction ofC1-surfaces. Two of them are described in the original paper of Powell and Sabin (1977): the Powell–Sabin-6 triangle, subdivided into six subtriangles and the Powell–Sabin-12 triangle, subdivided into 12 subtriangles. A major advantage of the Powell–Sabin-12 macro-elements is that certain geometric constraints required in the Powell–Sabin-6 case can be removed (see Remark 7.4. in Schumaker and Sorokina, 2006). SomeC1macro-elements, such as piecewise quadratic Powell–Sabin-12 element, are refinable in the sense that nested spline spaces with stable local bases can be constructed with their help. This refinability property makes the Powell–Sabin-12 element suitable for multiresolution analysis. Jia and Liu (2008) have used a mixture ofC1Powell–Sabin-6 and Powell–Sabin-12 elements in order to construct continuously differentiable wavelets on triangulations.There exist many bases with a very similar construction based on Powell–Sabin-6 partitions with different degrees (see for example Lamnii et al., 2014; Speleers, 2010b, 2013b) and different dimensions (see for example Speleers, 2013a). Similarly a B-spline representation for bivariate reduced Clough–Tocher splines has been considered in Speleers (2010a). Recently, a simplex spline basis for theC1-quadratics on the Powell–Sabin-12 with all the usual properties of the univariate B-spline basis was discovered (Cohen et al., 2013).In applications, and in particular for scattered data fitting and the solution of boundary-value problems by the finite-element method, it is advantageous to work with macro-element spaces that produce a given order of approximation while involving the least number of degrees of freedom. Degrees of freedom can frequently be removed from macro-elements by a process called condensation, but typically at the cost of not preserving full approximation power. In Alfeld et al. (2010), a variant of the condensed bivariateC1Powell–Sabin-12 macro-element is defined that has the same approximation power, but only requires vertex data. This approach was used to condense the Powell–Sabin-12 macro-element in Powell and Sabin (1977), although there is no discussion of approximation power there. Numerically, the condensation has only a small effect on the error in the interpolant. The structure of the condensedC1Powell–Sabin-12 spline space is very similar to the structure of theC1Powell–Sabin-6 (Dierckx, 1997) and theC1reduced Clough–Tocher space (Speleers, 2010a). Indeed, these three spaces can be characterized by means of the function values and derivative values at the vertices. This explains why it is possible to construct a normalized B-spline basis.The purpose of this paper is to show that for the condensedC1Powell–Sabin-12 spline space, it is possible to construct a normalized B-spline basis. The basis functions have a local support, they are nonnegative, and they form a partition of unity. The construction is based on the determination of a set of triangles that must contain a specific set of points. This is an important property in CAGD applications. The fact that the basis functions sum up to 1, ensures that the surface is affine invariant: applying an affine transformation to the control points yields the same result as applying the transformation on the surface itself. The nonnegativity of the basis functions guarantees that the surface lies in the convex hull of its control points. For the construction we follow the same approach from Speleers (2010a), developed to obtain a B-spline representation for reduced Clough–Tocher splines. This means that the triangulation Δ or its refinement has to satisfy certain geometric constraints. In the Powell–Sabin-12 case we assume that the maximal angle in the triangulation Δ is less thanπ/2. This assumption, however, implies that our basis cannot be defined on arbitrary triangulations, in contrast to the normalized B-spline bases for theC1Powell–Sabin-6 space (Dierckx, 1997) and theC1reduced Clough–Tocher space (Speleers, 2010a).The paper is organized as follows. Section 2 recalls some known results on the blossom of polynomials, some general concepts of polynomials on triangles, and the definition of the quadratic condensed Powell–Sabin-12 spline space. Section 3 describes the construction of the normalized basis for this space, which is based on determining a set of triangles that contain a specific set of points, and the interpolation rules for theC1quadratic condensed Powell–Sabin-12 splines. In Section 4, for some particular triangulations, we are able to define control points and we also show how to construct discrete and differentiable quasi-interpolants that reproduce quadratic polynomials.The Bernstein–Bézier techniques are well-established tools from CAGD, and it is well known that the related Bernstein–Bézier form of the polynomial pieces plays a key role for bivariate splines, see Lai and Schumaker (2007) for details.LetPddenote the linear space of bivariate polynomials of total degree less than or equal to d. Every polynomialp∈Pdcan be written in its Bernstein–Bézier form, i.e. for every triangleT:=〈V1,V2,V3〉we havep(x,y)=∑|α|=dbαBαd(λ),withα=(α1,α2,α3)∈N3a multiindex of length|α|=α1+α2+α3,λ=(λ1,λ2,λ3)the barycentric coordinates of(x,y)Twith respect toT, and(1)Bαd(λ)=d!α1!α2!α3!λ1α1λ2α2λ3α3the Bernstein–Bézier polynomials of degree d on the triangle. The coefficientsbαare called the Bézier ordinates of the polynomial p associated with the Bézier points(α1+α2+α3)/d, which are sometimes also called domain points.On the other hand, the multiaffine blossom of a polynomial p is the unique symmetric multiaffine polynomialB[p](u1,…,ud)for whichp(u)=B[p](u,…,u︸d).Ramshaw (1989) has shown that the Bézier ordinates for a polynomial relative to a triangleTcan be obtained by evaluating the polynomial's blossom at the vertices ofT. More precisely, for allα=(α1,α2,α3)∈N3where|α|=α1+α2+α3=d, we havebα=B[p](V1,…,V1︸α1,V2,…,V2︸α2,V3,…,V3︸α3︷d).Consider a simply connected subsetΩ⊂R2with polygonal boundary ∂Ω. Assume a conforming triangulation Δ of Ω is given, consisting of t trianglesTj,j=1,…,t, and havingnvverticesVi=(xi,yi)T,i=1,…,nv.LetVandEbe the sets of vertices and edges, respectively. We now define the Powell–Sabin-12 (PS-12) split of interest in this paper.Definition 1Given a triangleT:=〈V1,V2,V3〉, for each1≤i≤3, letRibe the midpoint of the edgeei=〈Vi+1,Vi+2〉opposite toViwhere we setV4=V1. Draw in the line segments〈Vi,Ri〉,i=1,2,3. Then it is easy to see that these three line segments intersect at the barycenterZ=(V1+V2+V3)/3ofT. The resulting partitionTPS6ofTinto six triangles is called the Powell–Sabin-6 split ofT. If we now draw in the line segments〈Ri,Ri+1〉,i=1,2,3whereR4=R1, then the resulting partitionTPS12ofTinto twelve triangles is called the PS-12 split ofT, see Fig. 1where we setR23=R1,R31=R2,R12=R3,W1=(R12+R31)/2,W2=(R12+R23)/2, andW3=(R23+R31)/2. The triangulation obtained from Δ by applying the PS-12 split to each triangle will be denotedΔPS12.The linear space of piecewiseC1continuous quadratic polynomials onΔPS12is defined asS21(ΔPS12):={s∈C1(Ω):s|T⁎∈P2,T⁎∈ΔPS12}.It is well known (cf. Theorem 6.13 in Lai and Schumaker, 2007) that the dimension ofS21(ΔPS12)is3nv+ne, whereneis the number of edges in Δ.We now consider a particular subspace ofS21(ΔPS12)with full approximation power, but which requires only nodal data at the vertices of Δ, see Alfeld et al. (2010). For each edge e in Δ, letηebe any unit vector that is not parallel to the edge. It is clear that for everys∈S21(ΔPS12)and every edge e of Δ,Dηesis a piecewise linear function on e. Alfeld et al. (2010) define the associated condensedC1quadratic PS-12 macro-element space by requiring that these cross derivatives be linear rather than piecewise linear.The condensed PS-12 spline space is defined asS˜21(ΔPS12):={s∈S21(ΔPS12):Dηes|e∈P1,for each edgeeinΔ}.The dimension of this spline space equals3nv. The following Hermite interpolation problem has a unique solutions∈S˜21(ΔPS12)for any given set of(fk,fx,k,fy,k)-values withk=1,…,nv:(2)s(Vk)=fk,∂s∂x(Vk)=fx,k,∂s∂y(Vk)=fy,k,k=1,…,nv.Suppose that the PS-12-spline s is defined by means of interpolation problem (2). On each micro-triangle inΔPS12, the spline is a quadratic polynomial that can be represented in its Bernstein–Bézier formulation. The corresponding Bézier ordinates are schematically represented in Fig. 2.Then by standard Bernstein–Bézier arguments, we get the following formulae for the Bézier ordinates of s:(3)a1=f1,(4)a2=a1+12(fx,1(x2−x1)+fy,1(y2−y1)),(5)a3=a1+14(fx,1(x2+x3−2x1)+fy,1(y2+y3−2y1)),(6)a4=a1+12(fx,1(x3−x1)+fy,1(y3−y1)),(7)a13=12a2+12a8,(8)a15=12a4+12a10,(9)a19=34a16+14a2,(10)a24=34a18+14a4,(11)a25=a16+a17+a183,(12)a26=12a16+12a18,(13)a29=12a19+12a24.Note that each of the formulae in (3)–(13) is to be applied to get the other coefficients of s.We now use a similar way developed in Alfeld et al. (2010) to determine the formulae fora16,a17anda18. Supposee:=〈V1,V2〉, and letηebe the unit vector perpendicular to e and pointing into T. To give a formula fora16, we make use of our requirement thatDηesshould be linear along the edge e. First, we writeηe=α1(R12−V1)+β1(W1−V1),ηe=α2(R12−V2)+β2(W2−V2),ηe=α12(V1−R12)+β12(Z−R12).For details on how to get the α's and β's, see Remark 1 given in Alfeld et al. (2010). Then, we get the formulae(14)α1=−2B+(V1−V2).(V1−V3)A,β1=4BA,(15)α2=−2B+(V1−V2).(V3−V2)A,β2=4BA,(16)α12=−(V1−V2).(V1−V3)+(V1−V2).(V2−V3)A,β12=3BA,whereB:=‖V1−V2‖22andA:=B|x3(y1−y2)+x1(y2−y3)+x2(y3−y1)|.Proposition 1The coefficienta16is given by the following formula:(17)a16=112B(4(B+C)s(V1)+(2C(V2−V1)+B(V3−V1)).∇s(V1)),whereC=(V2−V1).(V2−V3).The coefficienta16is given by the last formula in Section 3 of Alfeld et al. (2010). Hence,a16=a13+(−2α12(a8−a13)+α1(a2−a1)+β1(a3−a1)+α2(a8−a5)+β2(a7−a5))/2β12.Then, using Eqs. (3)–(13) and (14)–(16) we obtain (17).  □Finally, similar formulae hold fora17anda18.In this section, we give the main results of the paper. We will look for a suitable B-spline representation ofS˜21(ΔPS12),(18)s(x,y)=∑i=1nv∑j=13ci,jBi,j(x,y),where the basis functions satisfy(19)Bi,j(x,y)≥0,1=∑i=1nv∑j=13Bi,j(x,y),and have local support. Some properties for the basis{Bi,j}as convex partition of unity and locality are highly desirable in CAGD applications.Any B-splineBi,jwith respect to vertexViis required to be supported inΩi:=Star(Vi)(for the definition ofStar(Vi), see Lai and Schumaker, 2007). Thus, the splineBi,jis zero with its first derivatives at any vertex of Δ except forViand it is defined as the unique solution of interpolation problem(20)∂a+b∂xa∂ybBi,j(Vi)=βi,jabfor0≤a+b≤1.We now determine for each vertexVia particular set of three linearly independent{βi,jab,0≤a+b≤1}, such that the corresponding B-splinesBi,jwill form a convex partition of unity.With each vertexViwe associate a triangleti(Qi,1,Qi,2,Qi,3)with verticesQi,j=(Xi,j,Yi,j)T,j=1,2,3. Each{βi,jab,0≤a+b≤1}is then related to the function and derivative values at the pointViof one of the Bernstein polynomials of degree 1 with respect to triangleti. They are defined as(βi,100βi,200βi,300βi,110βi,210βi,310βi,101βi,201βi,301)(Xi,1Yi,11Xi,2Yi,21Xi,3Yi,31)=(xiyj1xiyj1xiyj1).More precisely, from Speleers (2013b) we have(21)βi,1ab=∂a+b∂xa∂ybB1001(Vi),βi,2ab=∂a+b∂xa∂ybB0101(Vi),βi,3ab=∂a+b∂xa∂ybB0011(Vi),for all0≤a+b≤1. Consequently, the B-splinesBi,j(x,y)constructed using the set of trianglestiform a partition of unity.Given a triangleT∈Δ, letΘT:=largest angle in the triangleT.Set,Θ:=maxT∈Δ⁡ΘT.In the rest of this paper, we will assume thatΘ<π2.In order to obtain nonnegative basis functions, we follow exactly the same strategy developed in Speleers (2010a).To derive the conditions ensuring nonnegativity, we focus on the B-splineB1,j(x,y)corresponding to vertexV1. We consider again the macro-triangleT(V1,V2,V3)depicted in Fig. 1. The Bernstein–Bézier representation of the B-splineB1,jon the triangleT(V1,V2,V3)is schematically represented in Fig. 3. As presented in the above section, the coefficientsd7,…,d19are given by(22)d7=12d2,d8=12d4,d9=34d5,d10=34d5+14d2,(23)d11=34d6,d12=34d6+14d4,d13=18(3d5+3d6+d2+d4),(24)d14=38d5,d15=38d6,d16=12(d5+d6),(25)d17=12d5,d18=12d6,d19=13(d5+d6).To obtain conditions ensuring nonnegativity, it is sufficient to impose that all Bézier ordinates of the B-splineB1,jon the triangleT(V1,V2,V3)are nonnegative. Looking at the formulae (22)–(25), this is the case when(26)di≥0,i=1,…,6.LetP1=V1,P2=12V1+12R12,P3=12V1+12W1,P4=12V1+12R31,(27)T1=3η1+2θ14(η1+θ1)V1+2θ14(η1+θ1)V2+η14(η1+θ1)V3,(28)T2=3η2+2θ24(η2+θ2)V1+2θ24(η2+θ2)V2+η24(η2+θ2)V3,whereη1=‖V2−V1‖2,η2=‖V3−V1‖2,θ1=‖V2−H1‖2andθ2=‖V3−H2‖2whereH1is the orthogonal projection ofV3onto the edge〈V1,V2〉, andH2is the orthogonal projection ofV2onto the edge〈V1,V3〉.Proposition 2The functionsB1,j,j=1,2,3, are nonnegative onT(V1,V2,V3), if the trianglet1contains the pointsPk,k=1,…,4, andTk,k=1,2.Without loss of generality, we assumej=1. We recall from (20) and (21) that(29)∂a+b∂xa∂ybB1,1(V1)=β1,1abfor0≤a+b≤1,whereβ1,1ab=∂a+b∂xa∂ybB1001(V1),whereB1001is the Bernstein polynomial of degree 1 with respect to trianglet1. Let us denotef(V):=B1001(V). Then(30)f(V)=f(V1)+∇f(V1).(V−V1).Each Bernstein polynomial is nonnegative on its domain triangle. It follows thatf(V)≥0for allV∈t1. In view of the smoothness at vertexV1, the Bézier ordinated1is given byd1=f(V1)=f(P1).Hence, imposingd1to be nonnegative is equivalent to the condition that the pointP1is inside the trianglet1. From (4), we haved2=f(V1)+12∇f(V1).(R12−V1)=f(V1)+∇f(V1).(P2−V1)=f(P2).Then,d2is nonnegative ifP2is inside the trianglet1. Similarly, we can verify thatd3andd4are nonnegative ifP3andP4are inside the trianglet1.On the other hand, from Proposition 1 we have(31)d5=112B(4(B+C)f(V1)+∇f(V1).(2C(V2−V1)+B(V3−V1))).Hence,3BB+Cd5=f(V1)+∇f(V1).(2C4(B+C)(V2−V1)+B4(B+C)(V3−V1)).Put,(32)d=f(V1)+∇f(V1).(2C4(B+C)(V2−V1)+B4(B+C)(V3−V1)).SinceH1is the orthogonal projection ofV3onto the edge〈V1,V2〉, it follows thatC=(V2−V1).(V2−V3)=‖V2−V1‖2.‖V2−H1‖2.Letη1=‖V2−V1‖2andθ1=‖V2−H1‖2, then(33)d=f(V1)+∇f(V1).(2θ14(η1+θ1)(V2−V1)+η14(η1+θ1)(V3−V1)),d=f(V1)+∇f(V1).(3η1+2θ14(η1+θ1)V1+2θ14(η1+θ1)V2+η14(η1+θ1)V3−V1),d=f(V1)+∇f(V1).(T1−V1),d=f(T1).Now the hypothesisΘ<π2implies thatC=(V2−V1).(V2−V3)is nonnegative. The realB=‖V1−V2‖2is nonnegative, then from (31), (32) and (33) we conclude thatd5≥0ifT1∈t1. In the same way, we can show thatd6≥0ifT2∈t1, and the proof is complete.  □By (27) we observe thatT1∈Tand(3η1+2θ14(η1+θ1),2θ14(η1+θ1),η14(η1+θ1))is the barycentric form ofT1relative to the triangleT(V1,V2,V3). Now, we will see how to locate geometrically the pointT1in the triangleT(V1,V2,V3).•We draw a straight line (D) not parallel to the edge<V1,V2>passing through the pointV1.We define the pointsMαon (D) such that‖V1−Mα‖2=α.On the line (D), we draw the pointsM4(η1+θ1),Mη1+2θ1andM2θ1.We draw two straight lines parallel to the line(V2M4(η1+θ1))that pass, respectively, throughMη1+2θ1andM2θ1.From the intersection of these two lines with the edge〈V1,V2〉, we draw two straight lines with equationsλ1=3η1+2θ14(η1+θ1)andλ2=2θ14(η1+θ1).The intersection of these last two lines gives the pointT1.On the other hand, sinceH1is the orthogonal projection ofV3onto the edge〈V1,V2〉, it follows that there exists aγ1such thatθ1=γ1η1, where0≤γ1≤1. Hence, form (27) we have(34)T1=3+2γ14(1+γ1)V1+2γ14(1+γ1)V2+14(1+γ1)V3.Similarly, by (27) the pointT2can be written in the form(35)T2=3+2γ24(1+γ2)V1+2γ24(1+γ2)V3+14(1+γ2)V2,whereθ2=γ2η2,0≤γ2≤1.P4=34V1+14V3.It follows immediately from (34) that(36)T1=(1−γ1)P4+γ1T˜γ1,whereT˜γ1=12(1+γ1)V2+3γ1+24(1+γ1)V1+γ14(1+γ1)V3.A similar argument shows that(37)T2=(1−γ2)P2+γ2T¯γ2,whereT¯γ2=12(1+γ2)V3+3γ2+24(1+γ2)V1+γ24(1+γ2)V2.We then arrive at the following result.Proposition 3The functionsB1,j,j=1,2,3, onT(V1,V2,V3)are nonnegative ifticontains the pointsPk,k=1,…,4,T˜γ1andT¯γ2.We then establish the following corollary.Corollary 1In order to derive conditions for the nonnegativity ofB1,j,j=1,2,3, onT(V1,V2,V3)it then suffices to request thatt1contains the pointsP¯k,k=1,…,3given by (seeFig. 4)P¯1=V1,P¯2=12V1+12R12,P¯3=12V1+12R31,T¯1=58V1+14V2+18V3,T¯2=58V1+14V3+18V2.Suppose Δ is a regular triangulation consisting of equilateral triangles. Then, the pointsT1andT2coincide with(V1+Z)/2. Therefore, the functionsB1,j,j=1,2,3, are nonnegative onT(V1,V2,V3)if the trianglet1contains the following points:V1,(V1+Z)/2,(V1+R12)/2,(V1+R31)/2.The PS-12 B-splines have some nice properties, which are very useful in CAGD and approximation applications. In this subsection we give some of them.For each vertexVi, we havex=∑i=1nv∑j=13Xi,jBi,j(x,y),y=∑i=1nv∑j=13Yi,jBi,j(x,y).We now define the control points asci,j=(Qi,j,ci,j)=(Xi,j,Yi,j,ci,j),and the control triangles asTi(ci,1,ci,2,ci,3).The projection of the control trianglesTiin the(x,y)plane are the PS-12 trianglesti. Furthermore, one can prove that the control triangle is tangent to the surface ats(Vi).In the following result, we give Hermite interpolation rules forC1quadratic PS-12 splines in the normalized B-spline representation.Proposition 4Lets∈S˜21(ΔPS12), thens(x,y)=∑i=1nv∑j=13(s(Vi)+(Qi,j−Vi)T∇s(Vi))Bi,j(x,y),(x,y)T∈Ω.The proof is similar to the one of Theorem 6 given in Lamnii et al. (2013b) (see also Eq. (4.2) in Speleers, 2013a).  □As in the Powell–Sabin-6 spline case (Lamnii et al., 2013a; Sbibih et al., 2009; Speleers, 2014), it is possible to express anys∈S˜21(ΔPS12)as a combination of the normalized B-splines, where the coefficients in that combination are given in terms of the polar forms of s. DefineQ˜i,j=−12Vi+12Qi,j,i=1,…,nv,j=1,2,3.Then, the following result is an immediate consequence of Theorem 7 from Sbibih et al. (2009)s(x,y)=∑i=1nv∑j=13B[si](Vi,Q˜i,j)Bi,j(x,y),∀(x,y)T∈Ω,wheresiis the restriction of s to one of the triangles ofΔPS12havingVias vertex. We then establish the following corollary (Marsden's identity).Corollary 3For any polynomialp∈P2, we havep(x,y)=∑i=1nv∑j=13B[p](Vi,Q˜i,j)Bi,j(x,y),∀(x,y)T∈Ω.We have implemented the above method in some simple cases.We now consider an important special case where the constraints of Corollary 2 are met.Triangular hexagonal lattices or equilateral triangle lattices have been used by Kovačević and Sweldens (2000) in geometric modeling and many other fields. An example of this triangulation can be found by drawing the three lines (shown in Fig. 5)(D1,k):y=32k,k∈Z(D2,k):y=3x−3k,k∈Z(D3,k):y=−3x+3k,k∈Z.HereVi=Γ(i1i2)=(i1+i2232i2),Γ:=(112032),with(i1,i2)T∈Z2. On a hexagonal lattice, box-splines (ch. Prautzsch and Boehm, 2001) can be constructed using the three vectors(12,−32)T,(12,32)Tand(1,0)T.Inspired by the Powell–Sabin-6 B-spline construction (Dierckx, 1997), we propose an extension for the PS-12 splines on the hexagonal lattice triangulation. More precisely, we show that the B-spline basis functions for uniform PS-12 splines defined on the hexagonal lattice triangulation, are the translates of three B-splinesBj(x,y),j=1,2,3whose support, centered at the pointV(0,0)=(0,0)T, is shown in Fig. 6. We summarize the construction of the normalized B-spline basis and show how control triangles can be associated with the B-spline coefficients:1.The basis functionBj(x,y)is the unique solution of the interpolation problem (2) with all(fk,fk,x,fk,y)=(0,0,0)except for(fj,fj,x,fj,y)=(αj,βj,γj).For vertexV(0,0)we start by identifying its PS-12 points, see Corollary 2. Fig. 7shows the PS-12 points for the vertexV(0,0).For the vertexV(0,0), find a PS-12 trianglet(Q1,Q2,Q3)containing all the PS-12 points ofV(0,0). Denote its verticesQj(Xj,Yj). Fig. 7 shows a PS-12 triangle containing the PS-12 points at the vertexV(0,0).Given the PS-12 triangle of the vertexV(0,0), three linearly independent triplets of real numbers can be found as follows:•α=(α1,α2,α3)are the barycentric coordinates ofV(0,0)with respect to t,β=(β1,β2,β3)=(Y2−Y3e,Y3−Y1e,Y1−Y2e),γ=(γ1,γ2,γ3)=(X2−X3e,X3−X1e,X1−X2e), wheree=|1X1Y11X2Y21X3Y3|.Here, we haveQ1=(−12,0)T,Q2=(14,−34)TandQ3=(14,34)T. Hence, we getα=(13,13,13),β=(−43,23,23),γ=(0,23,−23).Figs. 8 and 9show an example of three linearly independent PS-12 B-splines corresponding to the same vertex.In the following, for eachi=(i1,i2)T∈Z2, we puti⋆=(i1+i22,32i2)T. We consider the spline spaceSM:={∑i∈Z2∑j=13ci,jBj(x−i⋆)}.This is the linear space spanned by the shiftsBi,j(x):=Bj(x−i⋆)of the B-splinesBj,j=1,2,3.We now define two quadratic spline quasi-interpolants in the spaceSM.We are interested in quasi-interpolants of the following form(38)Q1f(x)=∑i∈Z2∑j=13λi,j(f)Bj(x−i⋆),whereλi,j(f),i∈Z2,j=1,2,3, are suitable linear functionals.First of all we note that, if(39)f(i⋆),∇f(i⋆),i∈Z2,are given, set(40)λi,1(f)=f(i⋆)−12∂f∂x(i⋆),λi,2(f)=f(i⋆)+14(∂f∂x(i⋆)−3∂f∂y(i⋆)),λi,3(f)=f(i⋆)+14(∂f∂x(i⋆)+3∂f∂y(i⋆)).Then, from Proposition 4, the quasi-interpolant obtained by (38) with (40) provides the unique element inSMthat interpolates the Hermite data (39).For the second quasi-interpolant, we consider(41)λi,1(f)=f(i⋆)−14(f(A4+i⋆)−f(A2+i⋆))+14(f(A3+i⋆)−f(A1+i⋆)),λi,2(f)=f(i⋆)+14(f(A4+i⋆)−f(A2+i⋆)),λi,3(f)=f(i⋆)−14(f(A3+i⋆)−f(A1+i⋆)),whereA1=(12,32)T,A2=(−12,32)T,A3=(−12,−32)TandA4=(12,−32)T. Then, from Corollary 3 (Marsden's identity) and by straightforward computation, the scheme (38) with coefficients given by (41) is a quasi-interpolant (using only function values) which reproducesP2.To test our condensed PS-12 quasi-interpolants, we use the well-known Franke function f (cf. Franke, 1982)f(x,y)=34exp⁡(−(9x−2)2+(9y−2)24)+34exp⁡(−(9x+1)249−(9y+1)10)+12exp⁡(−(9x−7)2+(9y−3)24)−15exp⁡(−(9x−4)2−(9y−7)2),on the unit squareΩ=[0,1]×[0,1]. We compute the Hermite interpolant and discrete quasi-interpolant (q.i.) PS-12 splines on a nested sequence of hexagonal lattice triangulation associated with the verticeshi⋆,i∈Z2. Maximum errors between the test function and its approximations are given in Table 1.Let Δ be the uniform triangulationR2whose set of vertices isZ2, and whose edges are parallel to the three directionse1=(1,0)T,e2=(0,1)Tande3=(1,1)T, see Fig. 10. LetSHbe the condensed space ofC1quadratic splines onΔPS12. According to the above section, it is shown that any element of this space can be expressed as linear combination of three B-splines. Their support is the unit hexagon with vertices{±e1,±e2,±e3}, see Fig. 11.The three B-splinesBjassociated withV(0,0)are defined by its control trianglet(Q1,Q2,Q3). We can show that for any choiceQ1=(−19,1118),Q2=(5−ε6(ε+1),2ε−13(ε+1)),Q3=(8−ε3(2ε−7),5ε+146(2ε−7)),where27≤ε≤1, the corresponding B-splines are nonnegative.Forε=27, we haveQ1=(−19,1118),Q2=(1118,−19),Q3=(−25,−25).Their PS-12 triangle is shown in Fig. 12. Consider three linearly independent triplets(αj,βj,γj),j=1,2,3, for the vertexV(0,0). The basis functionBjis the solution of the interpolation problem (2) with all(fk,fk,x,fk,y)=(0,0,0)except for(fj,fj,x,fj,y)=(αj,βj,γj). The three linearly independent triplets of real numbers(αj,βj,γj),j=1,2,3, are then related to the function and derivative values at the pointV(0,0)of one of the Bernstein polynomials of degree one with respect to trianglet(Q1,Q2,Q3). They are defined as(α1,β1,γ1)=(413,−413,1413),(α2,β2,γ2)=(413,1413,−413),and(α3,β3,γ3)=(513,−1013,−1013).We now show how the basisBj(x−i),i∈Z2, can be used to give a formal solution to the interpolation problem (2). Suppose f is sufficiently differentiable so that the valuesλi,jcan be computed as(42)λi,1(f)=f(i)−19∂f∂x(i)+1118∂f∂y(i),λi,2(f)=f(i)+1118∂f∂x(i)−19∂f∂y(i),λi,3(f)=f(i)−25∂f∂x(i)−25∂f∂y(i),and set(43)Q2f(x)=∑i∈Z2∑j=13λi,j(f)Bj(x−i).Then it follows immediately from Proposition 4 that the quasi-interpolant obtained by (43) with (42) provides an element inSHwhich interpolates the Hermite data(44)f(i),∇f(i),i∈Z2.However, in many practical applications, such information is not available. Therefore, it is interesting to construct quasi-interpolants using only function evaluations. For example, let(45)λi,1(f)=f(i)+1336(f(A3+i)−f(A1+i))−1136(f(A4+i)−f(A2+i)),λi,2(f)=f(i)−1336(f(A3+i)−f(A1+i))+118(f(A4+i)−f(A2+i)),λi,3(f)=f(i)+15(f(A4+i)−f(A2+i)),whereA1=(1,0)T,A2=(1,1)T,A3=(−1,0)TandA4=(−1,−1)T. Then it follows from Corollary 3 (Marsden's identity), that the quasi-interpolant obtained by (43) with (45) reproducesP2.We now present numerical results confirming good approximation properties of the proposed quasi-interpolants (43). We have used the well-known Franke test function. The test is done in a sequence of uniform 3-direction meshΔnassociated with the vertices(kh,lh),k,l=0,…,n, withh:=1/nwheren=4,8,16,32. The errors are presented in Table 2.

@&#CONCLUSIONS@&#
