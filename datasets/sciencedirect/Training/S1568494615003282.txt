@&#MAIN-TITLE@&#
Prediction of composite suitability index for physical habitat simulations using the ANFIS method

@&#HIGHLIGHTS@&#
Conventional methods of physical habitat simulation use the habitat suitability index models.However, the habitat suitability index model can easily be affected by the subjective opinion of the expert.To overcome this weakness, this study introduces the ANFIS method for predicting the composite suitability index for use in physical habitat simulations.

@&#KEYPHRASES@&#
Physical habitat simulation,Composite suitability index,Adaptive neuro-fuzzy inference system (ANFIS),Habitat suitability index,Zacco platypus,Watershed monitoring data,

@&#ABSTRACT@&#
A physical habitat simulation is a useful tool for assessing the impact of river development or restoration on river ecosystem. Conventional methods of physical habitat simulation use the habitat suitability index models and their success depends largely on how well the model reflects monitoring data. One of preferred habitat suitability index models is habitat suitability curves, which are normally constructed based on monitoring data. However, these curves can easily be affected by the subjective opinion of the expert. This study introduces the ANFIS method for predicting the composite suitability index for use in physical habitat simulations. The ANFIS method is a hybrid type of artificial intelligence technique that combines the artificial neural network and fuzzy logic. The method is known to be a powerful approach especially for developing nonlinear relationships between input and output datasets.In this study, the ANFIS method was used to predict the composite suitability index for the physical habitat simulation of a 2.5km long reach of the Dal River in Korea. Zacco platypus was chosen as the target fish of the study area. A 2D hydraulic simulation was performed, and the hydraulic model was validated by comparing the measured and predicted water surface elevations. The distribution of the composite suitability index predicted by the ANFIS model was compared with that using the habitat suitability curves. The comparisons reveal that the two distributions are similar for various flows. In addition, the distribution of the composite suitability index of the Dal River is computed by the ANFIS method using monitoring data for the other watersheds, namely the Hongcheon River, the Geum River, and the Chogang Stream. The monitoring data for the Chogang Stream, correlation pattern of which was the most similar to that of the Dal River, yielded the distribution of the composite suitability index, which was very close to that obtained using data for the Dal River. This is also supported by the mean absolute percentage error for the difference in the weighted usable areas.

@&#INTRODUCTION@&#
The construction of hydraulic structures as dams and banks for flood protection and water supply are common in modern societies, and these structures can affect the environment of a river in various ways. The impacts of individual hydraulic structures were studied extensively in the past [1–5]. In 1992, a UN Conference on Environment and Development [45] proposed the concept of Environmentally Sound and Sustainable Development (ESSD) and various techniques have since been introduced, in attempts to mitigate the negative impact of such structures on natural environments, including rivers [6].With river environments attracting so much attention, it became necessary to investigate the impact of hydraulic structures on river ecosystems and to resolve the resulting problems caused by such construction [7]. For example, in the United States, if a certain type of river work needs to be done, the impact of the altered discharge on the river environment must first be assessed and solution to minimize its impact should be given a priori [46].The physical habitat simulation is a useful tool for assessing the impact of a change in flow on the ecosystem of a river. A physical habitat simulation is based largely on the concept of the Instream Flow Incremental Methodology (IFIM) [8–10]. This technique can be used to determine the discharge required to keep the potential productivity of the river related to the biodiversity [46]. PHABSIM, based on the IFIM concept, is a technique that is used to evaluate habitat suitability caused by a change in flow. This technique, in general, combines the hydraulic and habitat models and relates the flow conditions to the suitability of physical habitats for the target species in the river ecosystem [11–15]. Thus, the technique can provide the appropriate flow range needed to maintain specific species in the river.In order to obtain quantitative results for a physical habitat simulation, the composite suitability index (CSI) should be computed. The CSI is a combination of the suitability of each habitat variable such as velocity, flow depth, and substrate. In general, the CSI can be constructed based on either a knowledge-based model or a data-driven model [47]. The knowledge-based model is the conventional approach and the evaluation results are heavily dependent on the individual habitat suitability index (HSI) and the methods used to calculate the CSI from each HSI [16]. The knowledge-based models assume that the correlations between physical habitat variables are negligible and spatial connectivity between habitats can be ignored [48]. However, for example, in reality, the flow depth and the velocity are related by the hydrodynamic principle and each HSI model does not include the geographic or spatial information regarding the river. In order to overcome this weakness, data-driven models, using artificial intelligence techniques such as artificial neural network [17], fuzzy logic [18–20], statistical methods [21], and genetic algorithm [22–24], have been proposed.Specially, Fukuda et al. [25,26] introduced various data-driven models to assess the fish habitat suitability in the river. The models include artificial neural networks, classification and regression trees, fuzzy habitat suitability models, generalized additive models, generalized linear models, random forests, and support vector machines. Fukuda et al. [25,26] compared the predicted results and concluded that these data-driven models can be useful in the evaluation of habitat suitability.Recently, hybrid type artificial intelligence techniques such as the fuzzy neural network (FNN) model and the adaptive neuro fuzzy inference system (ANFIS) model, were introduced and were reported to yield better results compared with individual artificial intelligence technique [49–52]. For example, fuzzy neural network models were used to construct the HSI model [27,28,53,54], indicating that fuzzy neural network models are appropriate for considering the uncertainty inherent in complicated ecosystems.In this study, the ANFIS method was utilized to predict the CSI for a physical habitat simulation. The novelty of the present study is the application of a powerful data-driven approach, the ANFIS method to the prediction of the CSI directly using the monitoring data. A physical habitat simulation was carried out for a reach in the Dal River in Korea, and the adult Zacco platypus was chosen as the target fish. A 2D hydraulic model was used for the flow analysis. The distribution of the CSI predicted by the ANFIS method was compared with that obtained from habitat suitability curves. The CSI predicted using monitoring data in other watershed areas are given and the results are compared. The resulting weighted usable areas (WUAs) are also provided and discussed.Fig. 1shows the study area of the Dal River, Korea. The study reach is 2.5km long, ranging from the Sujeon Bridge located downstream from the Goesan Dam to the Daesu Wier. The flow and physical habitat conditions of the study reach are heavily affected by the discharge from the Goesan Dam [29,55]. The Goesan Dam discharges 5–20m3/s at irregular intervals for hydropower generation, and the flow is kept constant by the downstream weir even if the dam does not discharge water.The watershed area of the Goesan Dam is 675.2km2 and the design flood is 1750m3/s for a 50-year return period. For the study reach, the discharges for drought flow (Q355), low flow (Q275), normal flow (Q185), averaged-wet flow (Q95) are 1.82, 4.02, 7.23, and 17.13m3/s, respectively [30]. Here, Qndenotes the average value of the recorded discharge over n days of the year. The slope of the reach is approximately 1/650, and the bed materials are composed of cobble, gravel, and sand. The median size of the bed material is 137mm, indicating that it can be classified as a gravel-bed river [29]. Field investigations revealed that a riffle is present in the straight reach upstream of the bend and pools are located before and after the riffle. The presence of the pools and riffle is also supported by the distribution of bed materials. That is, coarse and fine particles are present at the riffle and pools, respectively [29].Float-type, sonar, and radar water gauges are installed at the Sujeon Bridge, where various measurements of water levels can be made. For this reach, a long period of hydrologic and fish monitoring data have been accumulated through Government R&D projects [31,32].Fish monitoring revealed that the dominant species in the study area is the minnow (Zacco platypus), followed by dark chubs (Zacco temmincki) and swiri (Coreoleuciscus splendidus) [32]. Detailed data are given in Fig. 2. In the present study, the adult minnow was selected as the target fish for the physical habitat evaluation. Adult Zacco platypus grows to about 0.08–0.12m and normally lives in the riffles in the midstream or downstream reach of rivers. In particular, they adapt relatively well to artificial changes in a river environment such as various river works, the collection of aggregates, and water pollution, and thus are the most common freshwater fish species in Korea [33].Kang [34] collected fish monitoring data in the Geum River basin, and developed habitat suitability curves for Zacco platypus. Fig. 3shows the habitat suitability curves for flow depth, velocity, and substrate [34].In this section, the hydraulic model was introduced for the flow analysis and the ANFISF method is presented for predicting the CSI. How the weighted usable area is calculated is then described.For the flow analysis, the River2D model proposed by Stefﬂer and Blackburn [35] is used in the present study. The model is based on the two-dimensional shallow water equations such as(1)∂H∂t+∂qx∂x+∂qy∂x=0(2)∂qx∂t+∂∂x(Uqx)+∂∂y(Vqx)+g2=gH(S0x−Sfx)+1ρ∂∂x(Hτxx)+1ρ∂∂y(Hτxy)(3)∂qy∂t+∂∂x(Uqy)+∂∂y(Vqy)+g2∂∂xH2=gH(S0x−Sfx)+1ρ∂∂x(Hτyx)+1ρ∂∂y(Hτyy)which are depth-averaged continuity and x- and y-momentum equations, respectively. In Eqs. (1)–(3), H is the flow depth, U and V are the depth-averaged velocities in the x- and y-directions, respectively, qxand qyare respective discharges per unit width (qx=HU, qy=HV), g is the gravitational acceleration, ρ is the water density, S0iand Sfiare the river bed slope and friction slope in the i-direction, and τijis the horizontal turbulent stress tensor.Mamdani and Assilian [36] first presented Fuzzy Inference System (FIS). Later, Sugeno [37] proposed so-called Sugeno model by improving the computational efficiency of the earlier FIS. Since Sugeno model is powerful for optimization and adaptive method, it is good for controlling problems and dynamic nonlinear problems. The ANFIS method was first developed by Jang [38]. The ANFIS method is a hybrid algorithm that combines the fuzzy logic with the neural network. Both the gradient descent and the least square method improved the learning algorithm for the ANFIS method [39].The ANFIS method has been applied to various areas including economics, business administration, finance, environmental science, and engineering. Specially, in engineering, the ANFIS method was used to estimate the stability of tunnels during the design and construction stages [40] to predict the local scour around bridge piers [41], to improve the diagnostic accuracy of diabetes disease [42], to predict the daily CO concentration in the atmosphere [43], and to predict the stress–strain relation of conductive silicon rubber in the compression test [44]. In the present study, the ANFIS method was used to predict the CSI for adult Zacco platypus in the study site.The ANFIS network architecture of five layers is given in Fig. 4. The input values of the ANFIS network are velocity (v=(U2+V2)1/2), flow depth (H), and substrate (s), and the output variables are the CSI. Output variables at each layer are calculated with input variables from the previous layer and parameters at each node.The ANFIS network shown in Fig. 4 operates as follows: for the ANFIS network whose numbers of layers and nodes are L and n, respectively, the output value at i-th node in k-th layer is given by Ok,i. That is, for example, for v,(4)Oi1=μAi(v)where v (or H, s) is the input value, Aiis the fuzzy set, andOi1is the membership function of Ai. In the present study, the triangular-shaped function is used for the membership function. In Layer 1, the input values are transformed into membership functions, and the output values are computed by(5)μAv,a,b,c=maxminv−ab−a,c−vc−b,0The membership functions are then multiplied in Layer 2, and products or firing strengths are averaged in Layer 3. That is,(6)O2,i=wi=μAi(v)μBi(d)μCi(s),i=1,2,…,n(7)O3,i=w¯i=wiw1+w2+⋯+wn,i=1,2,…,nIn Layer 4, outputs are produced by the fuzzy rule with weighting factors obtained in Layer 3. That is, Layer 4 is the defuzzifier layer that performs defuzzification of the outputs. Herein, the following fuzzy rule proposed by Takagi and Sugeno [37] is used:(8)O4,i=w¯ifi=w¯i(piv+qid+ris+ki)where pi, qi, ri, and kiare consequent parameters. The final network output is produced by the node in Layer 5 by summing the results from Layer 4. That is,(9)O5,i=∑iw¯ifi=∑iwifi∑iwiIn the feedforward path from Layer 1 to Layer 4, product signals at each node are calculated and parameters are identified by the least square method with fixed premise parameters. However, in the backward path from Layer 4 to Layer 5, error is propagated from the output node to the input node. The premise parameters are modified by the gradient descent method.The habitat suitability was evaluated via habitat simulation based on monitoring data. The results of the habitat simulation are, in general, given by CSI and WUA. The CSI provides the habitat suitability over the study reach. The CSI is an aggregation of habitat suitability indices of individual physical habitat variables, including velocity, flow depth, and substrate. The CSI can be estimated by various methods, that include multiplication, geometric mean, minimum values, and the weighted value of habitat suitability indices [8]. In general, since habitat suitability curves are based on the judgment of experts, they are likely to be affected by their subjective opinions [56]. In the present study, the CSI was predicted by the ANFIS method using monitoring data and WUA is calculated with the predicted CSI. The WUA is calculated by multiplying the CSI by the area of the cell.(10)WUA=∑i=1nAi×CSIi=f(Q)where CSIiis the value of the CSI of cell i, Aiis the area of the divided cell i, and Q is the discharge. The WUA provides information regarding the amount of discharge required to maintain the optimal conditions for physical habitats.The hydraulic simulation was carried out using the River2D model. For model validation, comparisons were made between the predicted and measured data. Measured water levels at five stations within the study reach were used. For the downstream discharge, the actual data measured at the Daesu Weir [31] were imposed as a boundary condition. Forty-four datasets for channel geometry at intervals of 50m in the longitudinal direction were used [31].Fig. 5shows the longitudinal distribution of the water surface elevation. The profile computed from the River2D model is given together with measured data for comparison. It can be seen that the water surface elevation simulated using the River2D model agrees well with measured data.Contour plots of the flows simulated by River2D are given in Fig. 6. Both the depth-averaged velocity (up) and flow depth (down) are given for drought flow, low flow, normal flow, and averaged-wet flow. As seen in the figure, pools are formed in the straight reaches before and after the bend. A riffle where the velocity is high and the flow depth is shallow, is also located at a reach slightly upstream from the bend. It is also noteworthy that velocity rarely changes with discharge except for the bend and both upstream and downstream ends.Through an analysis of monitoring data, Kang [34] found the optimal range of the velocity of a stream for adult Zacco platypus, that is between 0.2m/s and 0.55m/s. Based on this range, it is expected that the habitat suitability would be high for adult Zacco platypus in the vicinity of the bend. However, when the discharge is larger than the averaged-wet flow, the habitat suitability would be expected to decrease because the velocity exceeds the optimal range over the entire reach.Considering that the optimal flow depth for adult Zacco platypus is in the range of 0.25m–0.6m [34], the reach, including the pools, is not appropriate for a fish habitat. This is consistent with the previous prediction based on the velocity of a stream. From Fig. 6, it appears that, as the discharge increases, the habitat suitability decreases for adult Zacco platypus except for the reach slightly before the bend.For the prediction using the ANFIS method, the monitoring data are divided into two groups, namely for training and for validation. The amount of data and ranges of physical habitat variables for training and validation are given in Table 1. The performance of the ANFIS method was tested using the dataset for validation. The performance test results in a Mean Absolute Percentage Error (MAPE) of 12.99%. Based on the error criterion proposed by [57], it can be said that the ANFIS method successfully predicts the CSI. In addition, the ANN model was also built for comparison. The ANN model has 15 nodes in the hidden layer with a learning rate of 0.7, a momentum constant of 0.95, and a system error of 0.001. Using the same datasets in Table 1, the ANN model was trained and validated. The model validation resulted in a MAPE of 19.02%, which is slightly larger than that by the ANFIS method. This indicates that the ANFIS method is a better predictor of the CSI than the ANN model.Fig. 7shows the distribution of the CSI of the adult Zacco platypus computed by the ANFIS method for various flows. Both predictions with (down) and without (up) consideration of zero abundance are given for comparisons. The prediction considering zero abundance means that the ANFIS method does not make the prediction in the region of zero abundance.In general, the CSI ranges between 0 and unity, indicating the combined condition of physical habitats such as velocity, flow depth, and substrate is the worst and most optimal for adult Zacco platypus, respectively. As seen in the figure, the composite suitability is higher around the bend and reaches close to both ends. This is consistent with the previous prediction made from the hydraulic simulations in Fig. 6. As the discharge increases, the CSI by both predictions decreases around the bend and at both the upstream and downstream ends but it increase elsewhere.It is also noteworthy that the CSI increases continuously with discharge in the prediction made using the ANFIS method without consideration of zero abundance. However, in the case of the prediction where zero abundance is taken into consideration, the CSI decreases when the discharge exceeds the averaged-wet flow. The prediction without considering zero abundance does not seem to be realistic since the method predicts CSI incorrectly in the region of zero abundance.The CSI distributions predicted by the HSI model are given in Fig. 8. For the computation of CSI, the multiplication method was used with the help of the habitat suitability curves in Fig. 3. It can be seen that the pattern of CSI distribution calculated by the HSI model is similar to that obtained by the ANFIS method. That is, the distributions show a general feature that the composite suitability is higher around the bend and reaches close to both ends.The 3D scatter plot in Fig. 9shows the population against velocity, flow depth, and substrate. The size of the bubble indicates the population, and each physical parameter is normalized by its maximum value. Data for the Dal River, used to predict the CSI in Fig. 7, are given with three separate datasets monitored in the Hongcheon River, Geum River, and Chogang Stream. The watersheds of each river are given in Fig. 1. It should be noted that the bubble distribution of the Dal River is different from those for the Hongcheon River and the Geum River. Rather, the distribution of the Dal River is similar to that of the Chogang Stream. Specifically, however, in the distribution of the Chogang Stream, the population is large in the low velocity range, which is different from the distribution for the Dal River. Thus, from Fig. 9, it would be expected that the CSI distribution predicted by the ANFIS method using data for the Dal River is similar to that obtained using data for the Chogang Stream to a certain extent.The monitoring datasets given in Fig. 9 were used to construct the membership functions for the ANFIS method, which are shown in Table 2. As expected from Fig. 9, the membership functions constructed with the dataset for the Dal River appear to be most similar to those obtained using the dataset for the Chogang Stream. If monitoring data are not sufficient or not available in the study reach, the fuzzy inference system with membership functions and fuzzy rules constructed with datasets from other watersheds can be used to predict the distribution of the CSI.Fig. 10shows the CSI distribution for adult Zacco platypus in the Dal River predicted by the ANFIS method. The upper, middle, and lower rows of distributions are predicted based on monitoring datasets for the Hongcheon River, the Geum River, and the Chogang Stream, respectively. It can be seen that the CSI distributions predicted with the dataset for the Chogang Stream are similar to those in Fig. 8 (considering zero abundance). However, for small discharges, the CSI distribution in this figure is different from that in Fig. 8. This is due to higher populations in the range of low velocity and shallow depth in the Chogang Stream as depicted in Fig. 9. This leads to different membership functions for such a flow in the two rivers as given in Table 2.Using Eq. (10), the WUA is calculated with the CSI distributions in Fig. 10. Fig. 11shows Mean Absolute Percentage Errors (MAPEs) of the WUAs compared with the WUA from CSI distribution in Fig. 7 (with consideration of zero abundance). As expected, the MAPEs of the WUAs calculated using the dataset for the Chogang Stream are the smallest. This is because the pattern of distribution of physical habitat variables of the Chogang Stream is most similar to that of the Dal River, as shown in Fig. 9.

@&#CONCLUSIONS@&#
Conventional HSI models such as habitat suitability curve ignore the correlation between physical habitat variables. That is, an individual habitat suitability curve gives a preference for the target species to only one variable. This study describes the use of the ANFIS method to predict the CSI for physical habitat simulations.A 2.5km long study reach was chosen in the Dal Stream, Korea, and Zacco platypus was selected as the target fish in this reach. A 2D hydraulic model was used for flow analysis, and the computed water surface elevation was compared with measured data, indicating good agreement.First, the CSI distributions predicted by the ANFIS method with and without considering zero abundance were compared and taking zero abundance into consideration was found to result in improved prediction. In addition, the CSI distribution predicted by the ANFIS method compared favorably to that obtained using the HSI model. Field monitoring data for Zacco platypus collected in four different streams were given. The population of the target fish monitored at specific flow depths, velocities and substrates was plotted. The findings revealed that the distribution of the population of the Dal River was similar to that of the Chogang Stream except for the region of low velocity. This leads to the membership functions of the Dal River and the Chogang Stream to be similar, when the ANFIS method is used, resulting in similar distributions in the CSI and the weighted usable area of the two streams.