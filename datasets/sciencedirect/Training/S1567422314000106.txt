@&#MAIN-TITLE@&#
Optimal reserve prices in weighted GSP auctions

@&#HIGHLIGHTS@&#
We show how to determine the optimal reserve price of the weighted GSP mechanism in Bayesian settings.We prove that the wGSP auction with this discriminatory re-serve price is a Myerson optimal auction.This optimal reserve price can be extended to support CPA/CPC/CPM hybrid auction.Our simulations indicate that setting a proper reserve price will make bidders transfer surplus to payment.We describe a practical implementation method to compute optimal reserve prices in production systems.

@&#KEYPHRASES@&#
Generalized second price auction,Weighted GSP,Reserve price,Optimal auction,Sponsored search auction,

@&#ABSTRACT@&#
Most search engines use the weighted Generalized Second Price (wGSP) auction to sell keyword-based text ads, generating billions of dollars of advertising revenue every year. Designing and implementing near-optimal reserve prices for these wGSP auctions are naturally important problems for both academia and industry.In this paper, we show how to calculate and implement the near-optimal reserve price of the wGSP mechanism in realistic settings. Unlike reserve prices in standard single-item auctions, optimal reserve prices in wGSP auctions are discriminatory, different even for advertisers bidding on the same keyword. The optimal reserve price results can be extended to support CPA/CPC/CPM1CPM: cost per mille (impressions), CPA: cost per action, CPC: cost per click.1hybrid auctions.Our simulations indicate that setting a proper reserve price will transfer some bidder utility (payoff) to auctioneer utility, resulting in higher revenue for the search engine. We describe a practical methodology to implement optimal reserve prices in production systems.

@&#INTRODUCTION@&#
Search advertising places keyword-based text ads alongside search results, generating billions of dollars of advertising revenue annually, and is the primary factor in the successful commercialization of search engines (Edelman et al. 2007, Varian 2007). Keyword-based text ads typically contain a title, a text description, and a display URL. Advertisers generate revenue when search engine users click on keyword ads and subsequently purchase advertised goods or services. Search providers conduct auctions to allocate advertising positions and decide per-click prices. Early keyword auctions implemented the Generalized First Price (GFP) mechanism, which was pioneered by Overture (later acquired by Yahoo!). The major stages of keyword auction evolution (Thompson and Leyton-Brown 2009) are as follows:1.GFP: The unweighted Generalized First Price auction. Agents are ranked by their bids and each bidder who wins a slot pays her bid per click. This mechanism was first used by Overture, 1997–2002.uGSP: The unweighted Generalized Second Price auction. Agents are ranked by their bids and each bidder who wins a slot pays the next highest bid per click. This mechanism was first used by Yahoo!, 2002–2007.wGSP: The weighted Generalized Second Price auction. The mechanism assigns a weightwito each bidder; agent i is ranked by the product of her bidbiand her weightwi, winner i payspi=bi+1·wi+1/wiper click (wherebi+1andwi+1are the next highest bidder’s bid and weight). This mechanism was first used by Google and adopted by all major search engines gradually.The wGSP mechanism is widely used in the industry nowadays and naturally is the focus in both academia and industry. Instead of rank-by-bid in uGSP, we refer to wGSP as rank-by-revenue. When users search for the keyword, the search engine will rank the ads in descending order of the product of each advertiser’s weight (ad quality) and bid (per-click). Under the wGSP mechanism, search engines charge advertisers according to their bids as well as their ad quality factors (primarily the estimated click-through rate). Our work focuses on wGSP auctions and our results allow the search engine to set discriminatory reserve prices for each advertiser and each keyword. Our settings are as follows: each bidder knows her private value and her expected click-through rate (eCTR) of the keyword, and only bidders who bid greater than their reserve prices can participate in the auction.

@&#CONCLUSIONS@&#
Keyword auctions are a key part of the business model for most search engines, generating billions of dollars of advertising revenue for these companies annually. Examining the optimal reserve price for these auctions is a very important problem. Our work generalizes the optimal reserve price for Myerson auctions to wGSP auctions in realistic contexts. We prove that the optimal reserve price in wGSP auctions depends only on the joint distribution of bidders’ valuationsviand quality factorsei, independent of the number of bidders. We further extend this theory to the CPA/CPC/CPM hybrid auction, and show that the optimal reserve price can be calculated similarly.Simulations shed additional light on our theory and reveal a significant revenue increase by adjusting reserve prices to the optimal one. Those simulations indicate that increasing the reserve price leads to an indirect positive change to the top bidders’ expected payments, while the lower position bidders’ contributions are negative. Increasing reserve price decreases auction efficiency, and it is not a zero-sum game, however, it transfers bidders’ utilities into payments and finally maximizes the search engine’s revenue.Besides theory and simulation, we also propose a practical implementation method to compute the optimal reserve price in realistic contexts for search engines, and resolve some key issues via statistical techniques, such as keyword semantic clustering, value distribution estimation from truncated samples, etc.While we do not know bidder’s private valuesvi, we can analyze the correlation between bidsbiand quality factorseifor each keyword. Assume all bidders bidbisymmetrically based on their values and quality factors, if their valuesviare correlated with their quality factorsei,bimust be correlated withei.We examine correlation coefficients of each keyword’s bidsbiand quality factorseiusing bidding data of 500,000 keywords which is a subset of the dataset used in Section 5. Those bids constitute nearly perfect competition, since we only select keywords with at least 10 bidders. Finally, we draw those correlation coefficients in a histogram as in Fig. A7.Those correlation coefficients are symmetrically distributed around 0, with their average −0.019. In summary, the expected correlation coefficient ofbiandeiis almost 0 for any given keyword. This suggests that for any keyword, bidders’ valuesviand quality factorseiare linear independent.According to the ranking and pricing schemes in wGSP auctions, given bidder i with value-per-clickvi, quality factorei, and bidbi, his expected utility is:(B.1)Ui(vi,bi,ei)=∑j=1k(vi-〈priceatjth〉)·ei·xj·Pr〈bieiranksjth〉Letvi=vandei=e, and consider another bidder h with value-per-clickvh=ev̇and quality factoreh=1, heree∈(0,1]. Suppose bidder i bids b and bidder h bidseb, thus both advertisers get the same rank scoreeb. Their expected utilities are:(B.2)Ui(v,b,e)=∑j=1kv-bj+1ej+1e·e·xj·Pr〈ebranksjth〉=∑j=1k(ev-bj+1ej+1)·xj·Pr〈ebranksjth〉(B.3)Uh(ev,eb,1)=∑j=1kev-bj+1ej+11·1·xj·Pr〈ebranksjth〉=∑j=1k(ev-bj+1ej+1)·xj·Pr〈ebranksjth〉Herebj+iandej+1are the next bidder’s bid and quality factor when the bidder wins the j-th slot. It is easy to get that:(B.4)Ui(v,b,e)=Uh(ev,eb,1)We definebi=δ(vi,ei)to be the equilibrium bidding function at anyviandei. Letbh=δ(ev,1)maximizeUhandbi=δ(v,e)maximizeUirespectively. Eq. (B.4) suggests that if biddingbi=bis the best for bidder i with value-per-click v, biddingbh=ebmust be the best for bidder h with value-per-clickev. Thus, we derive:(B.5)e·bi=bh⇒e·δ(v,e)=δ(ev,1)Finally, bidder i’s scoresi=eivi=ev. Letβ(si)=δ(ev,1), we rewrite bidder i’s bidding strategy as:(B.6)bi=δ(vi,ei)=β(si)eiWe assume individually rational (utility-maximizing) bidders with the same bidding strategybi=β(si)eiin equilibria. Bidder i’s expected CTR iseCTRi=ei·xi=ei·q̃(ei·bi)Thus, the bidder’s utility formula:Ui(bi)=vi·eCTRi-Paymenti=vi·ei·q̃(ei·bi)-m̃(ei·bi)The derivative ofUiwith variablebiis:(C.1)∂Ui(bi)∂bi=vi·ei2·q̃′(ei·bi)-ei·m̃′(ei·bi)Since the biddingbi=β(si)eimaximizes his utility, thusbiis an equilibrium bidding, i.e.,(C.2)∂Ui(bi)∂bi|bi=β(si)ei=vi·ei2·q̃′(β(si))-ei·m̃′(β(si))=0Letq̃(β())=q(),m̃(β())=m(), thensi·q′(si)-m′(si)=0If the minimum score of all ads iss̲, then its utility is zero, and it satisfies the restraint boundary condition:(C.3)U(s̲)=s̲·q(s̲)-m(s̲)=0Solving Eqs. (C.2) and (C.3) yields(C.4)m(s)=s·q(s)-∫s̲sq(r)dr,where s is a random variable drawn from a known distributionF(s), with the probability density functionf(s)=F′(s)in(0,∞)(Bulow and Roberts 1989). The payment of a bidder is determined by his score s only: whens<s̲, his utility is 0; and whens⩾s̲, his utility is computed by Eq. (C.4). The expected payment of bidder i is:(C.5)E[m(s)]=∫0s̲0·f(s)ds+∫s̲∞m(s)·f(s)ds=∫s̲∞s·q(s)f(s)ds-∫s̲∞∫s̲sq(r)drf(s)ds=∫s̲∞s·q(s)·f(s)ds-∫s̲sq(r)dr·F(s)s̲∞+∫s̲∞F(s)·q(s)ds=∫s̲∞s·f(s)-1+F(s)·q(s)ds=∫s̲∞s-1-F(s)f(s)·q(s)·f(s)dsThere are n bidders, each bidder’s expected payment is given by the above expression, and the sum of their expected payments is the expected revenue of the search engine:(C.6)n·E[m(s)]=n∫s̲∞s-1-F(s)f(s)·q(s)·f(s)dsWith probabilityFn(s̲), nobody wins any ad slot and the search engine gains a valuet0of better user experience (no ads, Jun Li et al. study this case in Li et al. (2012)). Therefore, the expected revenue per search of the search engine is:T(s̲)=Fn(s̲)·t0+n∫s̲∞s-1-F(s)f(s)·q(s)·f(s)dsIf the minimum scores̲maximizes the expected revenueT(s̲), it satisfies:∂T(s̲)∂s̲=n·Fn-1(s̲)f(s̲)t0-ns̲-1-F(s̲)f(s̲)q(s̲)·f(s̲)=0Then the optimal value of the minimum scores̲∗satisfies(C.7)s̲∗-1-F(s̲∗)f(s̲∗)=Fn-1(s̲∗)q(s̲∗)·t0whereq(s)is the expected position factor when a bidder’s score is s. Whent0=0, Eq. (C.7) is simplified into:(C.8)s̲∗-1-F(s̲∗)f(s̲∗)=0Whens̲∗is solved via Eq. (C.8), for bidder i with quality factorei, his optimal reserve pricepi∗for this keyword is(C.9)pi∗=s̲∗eiAssume there is a family of probability distributions with probability density functionp(x,θ)and the corresponding cumulative density functionF(x,θ),θ∈Θ,Θis the parameter space. Random variableX∼p(x,θ)and for another random variableX′which follows the truncated distribution with threshold s, its probability density functionps(x,θ)is:(D.1)ps(x,θ)=p(x,θ)1-F(s,θ)(x⩾s)Given N observationsx1,x2,…,xNofX′, the likelihood function for distribution estimationL(θ)is defined as:(D.2)L(θ)=∏i=1Nps(x,θ)=∏i=1Np(xi,θ)1-F(s,θ)NCorrespondingly, the log-likelihood is:(D.3)logL(θ)=∑i=1Nlogp(xi,θ)-Nlog1-F(s,θ)We sayθˆ=θˆ(x1,x2,…,xN)is the maximum likelihood estimate ifθˆsatisfies that:(D.4)logL(θˆ)=maxθ∈ΘlogL(θ)To find the parameter valuesθˆmaximizinglogL(θ),θˆshould satisfydlogL(θ)dθ=0. Given the strong connectivity of the probability density function, it is equivalent to solve the following equation(D.5)1NdlogL(θ)dθ=1N∑i=1N∂p∂θ(xi,θ)p(xi,θ)+∫-∞s∂p∂θ(x,θ)dx1-F(s,θ)=0Given that N is large enough, we have:(D.6)limN→∞1N∑i=1N∂p∂θ(xi,θ)p(xi,θ)=∫s+∞∂p∂θ(x,θ)p(x,θ)p(x,θ0)1-Fs,θ0dxTherefore,(D.7)limN→∞1NdlogL(θ)dθ=∫s∞∂p∂θ(x,θ)p(x,θ)p(x,θ0)1-F(s,θ0)dx+∫-∞s∂p∂θ(x,θ)dx1-F(s,θ)Ifθ0is the maximum likelihood estimate, the corresponding derivative will approach zero as N approximates infinity. By replacingθwithθ0, we have:(D.8)limN→∞1NdlogL(θ)dθ=∫-∞+∞∂p∂θ(x,θ)|θ=θ0dx1-F(s,θ0)Thus, once if∫-∞+∞∂p∂θ(x,θ)|θ=θ0dx=0is always true, we can conclude that the estimated parameter valueθˆalways equals toθ0. Given the assumption thatp(x,θ)is second degree differentiable with respect toθ, we can interchange integration and differentiation for the right side term of the above equation, leading to:(D.9)∫-∞+∞∂p∂θ(x,θ)|θ=θ0dx=ddθ∫-∞+∞p(x,θ)dx|θ=θ0Since∫-∞+∞p(x,θ)dx=1, for∀θ, we have the equation(D.10)ddθ∫-∞+∞p(x,θ)dx=0Consequently,limN→∞1NdlogL(θ)dθ|θ=θ0=0,θ0is a potential candidate of maximum likelihood estimate.