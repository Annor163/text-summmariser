@&#MAIN-TITLE@&#
A tabu search for Time-dependent Multi-zone Multi-trip Vehicle Routing Problem with Time Windows

@&#HIGHLIGHTS@&#
A new formulation for the Time-dependent Multi-zone Multi-trip Vehicle Routing Problem with Time Window.A new tabu search meta-heuristic outperforming the literature.An adaptive neighborhood structure and strategy used to control the selection of neighborhoods and the phases of the search.

@&#KEYPHRASES@&#
Multi-trip vehicle Routing with Time Windows,Synchronization,Time-dependent demand,Tabu search,

@&#ABSTRACT@&#
We propose a tabu search meta-heuristic for the Time-dependent Multi-zone Multi-trip Vehicle Routing Problem with Time Windows. Two types of neighborhoods, corresponding to the two sets of decisions of the problem, together with a strategy controlling the selection of the neighborhood type for particular phases of the search, provide the means to set up and combine exploration and exploitation capabilities for the search. A diversification strategy, guided by an elite solution set and a frequency-based memory, is also used to drive the search to potentially unexplored good regions and, hopefully, enhance the solution quality. Extensive numerical experiments and comparisons with the literature show that the proposed tabu search yields very high quality solutions, improving those currently published.

@&#INTRODUCTION@&#
The basic Vehicle Routing Problem with Time Windows (VRPTW) aims to design least cost routes from a single depot to a set of geographically distributed customers, while satisfying time window constraints at customers and the capacity of vehicles. In this paper, we consider the Time-dependent Multi-zone Multi-trip Vehicle Routing Problem with Time Windows (TMZT-VRPTW), which is an extension of the VRPTW involving both designing and assigning routes to vehicles within time synchronization restrictions.In the TMZT-VRPTW setting, a homogeneous fleet of vehicles operates out of a single garage to deliver customer-specific loads, available at particular facilities during particular operating time intervals. Deliveries at customers must be performed according to hard time windows. Vehicles must synchronize their arrivals at facilities with the respective operating time periods, that is, time windows at facilities are hard and vehicles are not permitted to arrive in advance and wait. Particular waiting stations may be used by the vehicles to wait for the next appointment. A vehicle route thus leaves the garage to visit a first facility within its operating time periods and load freight, proceeds to deliver it to customers within their time windows, and then moves to its next appointment to a facility, possibly stopping to wait for the appropriate time at a waiting station. The route continues until either there are no more loads to deliver or its cost becomes noncompetitive compared to other routes. The vehicle returns to the garage in both cases. The goal of the TMZT-VRPTW is to determine the set of routes, and assign them to particular vehicles, providing timely customer service and synchronized arrival at facilities for loading freight, minimizing the total cost made up of the (variable) costs of operating vehicles and the (fixed) costs of using them. The “time dependency” characterizing the problem setting follows from the time stamps of the origin-to-destination demand, indicating the time interval when the load is available at the origin facility and the delivery time window at the customer. This is different from most time-dependent vehicle routing problem contributions in the literature where travel costs or travel times are considered to vary with time.The TMZT-VRPTW is encountered in several settings, in particular in the context of planning the operations of two-tiered City Logistics systems (Crainic et al., 2009). In such systems, the first tier involves large-capacity vehicles delivering freight from the city distribution centers (CDCs) located on the outskirts of the city to intermediary facilities, called satellites, where it is transferred to smaller-capacity vehicles performing the satellite-to-customer delivery routes. Given the concerns regarding the impact of freight transport on the city living conditions (e.g., congestion and environment), as well as the locations of most satellites within or close to the city center, very short waiting times are allowed, most transfer operations being performed according to transdock practices, without intermediate storage. The arrival of first-tier vehicles at a given time period define the set of customers to be serviced, and the time required to unload and transfer the freight thus defining the availability period during which second-tier vehicles must arrive at the satellite and load. Second-tier vehicles must therefore synchronize their arrivals at satellites with these availability periods. After loading the planned freight, each second-tier vehicle undertakes a trip servicing the customers assigned to it. Once the last customer is serviced, the vehicle moves empty either directly to a satellite for its next trip, to a waiting station (when available) to wait for its next appointment at a satellite, or to the garage to end the current work assignment. The TMZT-VRPTW corresponds to the planning of the activities of second-tier vehicles.To our knowledge, Crainic et al. (2009) were the first (and only) to propose a method to address the TMZT-VRPTW. The authors proposed a decomposition approach that first addressed the VRPTW subproblems representing the delivery to the customers associated with each combination of satellite and availability period. The vehicle trips resulting from the solution of the subproblems were then put together into multi-trip routes by solving a minimum cost network flow problem. These two sets of decisions, (1) how to service customers associated to given facility-availability period combinations and (2) how to combine the resulting trips into vehicle-specific multi-trip routes abiding by the synchronization requirements at facilities, are not independent, however. Combining them into one formulation and solution method should yield better results. The objective of this paper is to take up on this challenge and present a meta-heuristic that addresses the two decisions simultaneously, in a comprehensive and efficient way.We thus introduce the first tabu search for the TMZT-VRPTW, integrating multiple neighborhoods grouped into two classes to address the two sets of decisions identified above. A first set of neighborhoods and moves work on the construction of the multiple-trip vehicle routes by modifying the facilities and availability periods a given vehicle visits. A second set aims to improve the routing of vehicles between two such visits by working on the customer to route/vehicle assignments. The former perturb significantly the solution and thus favor exploration of the search space, while the latter applied to each vehicle trip exploit good assignments. Hence, dynamically adjusting their utilization during the search provides the proposed algorithm with desired exploration and exploitation capabilities.The proposed algorithm starts by freely exploring the search space made up of feasible and unfeasible solutions. As the search advances, one lowers the probability of selecting neighborhoods modifying the facility-to-vehicle route assignments, thus limiting the size of the search region and giving routing moves more time to optimize routes. Of course, customer time windows and synchronization requirements constrain these decisions and moves. A diversification strategy guided by an elite set of solutions and a frequency-based memory is called upon when the search begins to stagnate. Creating new working solutions from the elite set helps to capitalize on the best solution attributes obtained so far. On the other hand, employing a frequency-based memory to perturb new working solutions provides a certain level of diversity to the search.The main contributions of the paper are the following: (1) a new formulation for the TMZT-VRPTW, which is the source to define neighborhoods in the proposed tabu search; (2) the neighborhood structure and the dynamic strategy used to control the selection of neighborhoods; and (3) a new tabu search meta-heuristic outperforming the available method (Crainic et al., 2012) with new best-known solutions on all instances and an improvement in the solution quality by 4.42% on average.The remainder of the paper is organized as follows. Section 2 contains a detailed problem description. The problem formulation is then provided in Section 3. Section 4 reviews the literature. The details of the proposed methodology are described in Section 5. Computational results are then reported and analyzed in Section 6, while conclusions and future works are considered in Section 7.The time-dependency characterizing demand in the TMZT-VRPTW setting translates into two phenomena. The first concerns facilities, which become available for work at particular time periods only with a set of loads destined to specific customers. A given facility may be available at several periods during the planning period considered, with a different set of loads at each occurrence. To model this time dependency, we definesupply pointsas particular combinations of facilities and availability time periods. A supply point is then characterized by a set of loads to be delivered to particular customers, and by a no-wait hard time window, meaning that vehicles cannot arrive before the beginning of the time window and wait for the opening of the facility, nor after the end of the time window by paying a penalty. The second phenomena concerns customers, which may receive several loads, from different facilities and time periods. We model this time dependency by identifying each particular load as acustomer demand, characterized by the supply point where it is available for delivery, the customer it must be delivered to, and the particular time window for the delivery at the customer.Synchronization at supply points requires that vehicles arrive at supply points at appointed times. Consequently, a direct move that gets the vehicle to a supply point sooner than the appointed time is forbidden. In this case, the vehicle may go to a location, which we call waiting station (e.g., a parking lot), and wait there in order to get to its next supply point just before the appointed time. Otherwise, if there is no waiting station available, the vehicle goes to the garage to finish its route.The TMZT-VRPTW can then be described as follows. There is a garage, or main depot, g, a set of waiting stationsw∈W, a set of supply pointss∈S, and a set of customer-demand nodesd∈D(i.e., one node for each customer demand). We assume that there is a limited allowable waiting time, defined by η, at each supply point. Each supply points∈Shas a no-wait, hard opening time window [t(s)−η,t(s)], specifying the earliest and latest times the vehicle may be at s, respectively, a vehicle loading time δ(s), and a set of customer-demand nodesDs∈Dmaking up its service zone. Each customer-demand node d∈Dshas a volume qdto be delivered, a service time δ(d) to unload freight from the vehicle, and a time window [ed,ld], where edis the earliest time service may begin and ldis the latest time. It is assumed all customer-demand volumes are less than the capacity of the vehicle (otherwise, the classical technique of duplicating customer demands such that each conforms to this requirement is applied in a processing phase).The TMZT-VRPTW can be seen as the problem of determining a set of routes made up of a sequence of supply-point visits, each followed by a trip servicing customer loads in the zone of the respective supply point, and of assigning each route to one vehicle. The objective is to minimize the total cost, which is made up of the fixed cost of using the vehicles and the routing costs of servicing customer demands and moving between supply points, while the following conditions are satisfied:1.Every vehicle starts and ends its route at the main depot g;Every vehicle servicing customer-demand nodes in Dsmust reach the supply points∈Swithin its time window, i.e., it must not arrive sooner than (t(s)−η) and no later than t(s); When needed, the vehicle may wait at a waiting stationw∈Wbefore moving to s; Once at s, the vehicle starts loading at time t(s) and continues loading for a time δ(s), after which it leaves s to service the assigned customer-demand nodes in Ds. After performing a route within zone Ds, the vehicle may move to another supply point for the next trip or go to the main depot g to complete its route;Every customer-demand noded∈∪s∈SDsis visited by exactly one vehicle within its time window (these are hard).The TMZT-VRPTW is defined on a directed graphG=(V,A), with vertex setV=g∪S∪D∪W, where g is the main depot,Sis the set of supply points,D={∪Ds:s∈S}is the customer-demand node set,Wis the set of waiting stations, and the arc setA={(g,s):s∈S}∪{(s,d):s∈S,d∈Ds}∪{(d,j):d∈D,j∈g∪W}∪{(i,j):i,j∈Ds,s∈S}∪{(d,s′):d∈Ds,s,s′∈S,t(s)<t(s′)}∪{(w,s):w∈W,s∈S}. Hence, the setAdoes not include arcs representing direct travel:•From the main depot g to any customer-demand node or waiting station;From any customer-demand node to its supply point or to supply points with opening times earlier than that of its supply point;From a supply point to any waiting station or to the main depot g.A routing cost (or travel time) cijis associated with each arc(i,j)∈A. A fleet of m identical vehicles with capacity Q is based at the main depot g. Vehicles are grouped into setK.Let aroute legbe a trip that links a pair of supply points, or starts and ends at a supply point and the main depot g, respectively. Thus, there are two types of route legs and their feasibility is defined as follows:•Asingle-supply point route legl, starting at supply point s and ending at the main depot, is feasible if it starts loading a total of goods not exceeding Q at supply point s at time t(s), then leaves s at time t(s)+δ(s) to deliver to a subset of customer-demand nodes in Dswithin their time windows.Aninter-supply point route legl that starts and ends at a pair of supply points s and s′, respectively, is feasible if it starts loading a total of goods not exceeding Q at supply point s at time t(s), then leaves s at time t(s)+δ(s) to deliver to a subset of customer-demand nodes in Dswithin their time windows, and arrives to s′ within the opening time window [t(s′)−η,t(s′)] (the vehicle can wait at a waiting stationw∈Wbefore moving to s′ in case the direct move from the last serviced customer in leg l to s′ gets the vehicle to s′ before (t(s′)−η)).A sequence of route legs, starting and ending at the main depot, assigned to a vehicle is called a route orwork assignment. For the sake of simplicity, from now on, the terms vehicle route and work assignment are used interchangeably. Fig. 1illustrates a three-leg work assignment, where s1, s2, s3 are supply points, g and w1 are the main depot and a waiting station, respectively,Ds1={d1,d2,d3,d4,d5},Ds2={d6,d7,d8,d9}, andDs3={d10,d11,d12,d13,d14,d15}. The dashed lines stand for the empty arrival from the depot g or from a waiting station, the empty movement from the last customer in the previous leg to the supply point of the next leg or to a waiting station, and the empty movement to the depot g once the work assignment is finished. This work assignment consists of a sequence of three legs {l1,l2,l3}, where l1={s1,d1,d4,d3,s2} and l2={s2,d7,d9,w1,s3} are two inter-supply point route legs, while l3={s3,d11,d14,d12,d15,g} is a single-supply point route leg.LetLdenote the set of all feasible legs satisfying the total load of vehicles, and the time windows at customers and supply points. Define the edland flscoefficients:edl=1ifcustomerdemandd∈Disonlegl∈L;0otherwise;fls=1ifleglstartsatsupplypoints∈S;-1iflegendsatsupplypoints∈S;0otherwise;Binary decision variables are used in the formulation:•xlk=1iflegl∈Lisassignedtoworkassignmentk∈K,0otherwiseysk=1ifworkassignmentkhasthefirstlegstartingatsupplypoints,0otherwisezsk=1ifworkassignmentkhasthelastlegstartingatsupplypoints,0otherwiseLet πlbe the total cost of route leg l, and F be the fixed cost of using a vehicle. The TMZT-VRPTW can then be formulated as(1)Minimize∑k∈K∑l∈Lπlxlk+∑k∈KF∑s∈Sysk(2)S.t.∑k∈K∑l∈Ledlxlk=1∀d∈D,(3)∑s∈Sysk⩽1∀k∈K,(4)∑s∈Sysk=∑s∈Szsk∀k∈K,(5)∑l∈Lflsxlk=ysk∀s∈S,k∈K,(6)xlk∈{0,1}∀l∈L,k∈K,(7)ysk∈{0,1}∀s∈S,k∈K,(8)zsk∈{0,1}∀s∈S,k∈KThe objective function (1) minimizes the total cost made up of the costs of operating and using vehicles. Constraints (2) guarantee that each customer demand is visited exactly once, while Constraints (3) state that at most one work assignment is assigned to each vehicle. Constraints (4) ensure that each work assignment starts and ends at the main depot. In fact, by summing over all supply points, the left-hand side counts the number of first legs assigned to each vehicle k, while the right-hand side counts the number of last legs assigned to each vehicle k. Then, from Constraints (3) and (4), either the numbers of first and last legs assigned to the vehicle k are both equal to zero, e.g., the vehicle k is not used∑s∈Sysk=∑s∈Szsk=0, or are both equal to 1, e.g., the vehicle k is used∑s∈Sysk=∑s∈Szsk=1.Constraints (5) ensure that when a vehicle goes to a supply point, it also leaves it, except for the starting supply point of the first leg. In fact, for any given vehicle k and supply point s, the left-hand side of the equality sums the value of flson all legs starting or ending at supply point s which are assigned to vehicle k. Consequently, whenysk=1, the equality (5) becomes∑l∈Lflsxlk=1, which means that there must be one leg starting at supply point s assigned to vehicle k as the first leg. Constraints (6)–(8) define the sets of decision variables.

@&#CONCLUSIONS@&#
We proposed a tabu search meta-heuristic for the Time-dependent Multi-zone Multi-trip Vehicle Routing Problem with Time Windows. The proposed model formulation provided the means to identify clearly the main components of the decision set of the problem. We could thus propose a tabu search method that works on multiple neighborhoods, which are used to improve both the routing and the assignment of routes to vehicles. The selection of neighborhoods is dynamically adjusted along the search to keep the balance between exploration and exploitation. Moreover, a diversification strategy guided by an elite set and a frequency-based memory is introduced to not only provide a certain level of diversity to the search, but also help incorporate good attributes into newly created solutions.Experimental results illustrated clearly the superior performance of the proposed methodology compared to the literature. It yields higher quality solutions in terms of both required number of vehicles and traveling cost. In addition, the utilization of waiting stations, resulting from the synchronization restriction at supply points, was significantly reduced. The quality of these results in terms of number of required vehicles, costs, times, and frequency of direct movements are not only extremely satisfying when evaluating the proposed meta-heuristic, but are also interesting from a managerial point of view. Indeed, they indicate that our tabu search will prove magisterially efficient in actual applications, contributing to provide system managers with solution requiring less vehicles to perform efficiently the same amount of work. This is particularly interesting when City Logistics systems are contemplated as our results indicate a reduction in the presence of vehicles on the streets of the city and, thus, in their negative impact on congestion and environment.