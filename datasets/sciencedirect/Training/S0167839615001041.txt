@&#MAIN-TITLE@&#
Control point based exact description of curves and surfaces, in extended Chebyshev spaces

@&#HIGHLIGHTS@&#
We consider extended Chebyshev spaces that also comprise the constant functions.We transform the unique normalized B-bases of these spaces to their ordinary ones.The proposed general basis transformation is based only on endpoint derivatives.Ordinary curves/surfaces can be described by explicit control point based formulas.Our formulas can be more efficient than other numerical methods up to dimension 16.

@&#KEYPHRASES@&#
Extended Chebyshev vector spaces,Normalized B-basis functions,Basis transformation,Curves and surfaces,Control point based exact description,

@&#ABSTRACT@&#
Extended Chebyshev spaces that also comprise the constants represent large families of functions that can be used in real-life modeling or engineering applications that also involve important (e.g. transcendental) integral or rational curves and surfaces. Concerning CAGD, the unique normalized B-bases of such vector spaces ensure optimal shape preserving properties, important evaluation or subdivision algorithms and useful shape parameters. Therefore, we propose global explicit formulas for the entries of those transformation matrices that map these normalized B-bases to the traditional (or ordinary) bases of the underlying vector spaces. Then, we also describe general and ready to use control point configurations for the exact representation of those traditional integral parametric curves and (hybrid) surfaces that are specified by coordinate functions given as (products of separable) linear combinations of ordinary basis functions. The obtained results are also extended to the control point and weight based exact description of the rational counterpart of these integral parametric curves and surfaces. The universal applicability of our methods is presented through polynomial, trigonometric, hyperbolic or mixed extended Chebyshev vector spaces.

@&#INTRODUCTION@&#
Normalized B-bases (a comprehensive study of which can be found in Peña (1999) and the references therein) are normalized totally positive bases that imply optimal shape preserving properties for the representation of curves described as convex combinations of control points and basis functions. Similarly to the classical Bernstein polynomials of degreen∈N– that in fact form the normalized B-basis of the vector space of polynomials of degree at most n on the interval[0,1], cf. Carnicer and Peña (1993) – normalized B-bases provide shape preserving properties like closure for the affine transformations of the control points, convex hull, variation diminishing (which also implies the preservation of convexity of plane control polygons), endpoint interpolation, monotonicity preserving, hodograph and length diminishing, and a recursive corner cutting algorithm (also called B-algorithm) that is the analogue of the de Casteljau algorithm of Bézier curves. Among all normalized totally positive bases of a given vector space of functions the normalized B-basis is the least variation diminishing and the shape of the generated curve more mimics that of its control polygon. Important curve design algorithms like evaluation, subdivision, degree elevation or knot insertion are in fact corner cutting algorithms that can be treated in a unified way by means of B-algorithms induced by B-bases.Curve and surface modeling tools based on non-polynomial normalized B-bases also ensure further advantages like: possible shape or design parameters; singularity free exact parametrization (e.g. parametrization of conic sections may correspond to natural arc-length parametrization); higher or even infinite order of precision concerning (partial) derivatives; ordinary (i.e., traditionally parametrized) integral curves and surfaces can exactly be described by means of control points without any additional weights (the calculation of which, apart of some simple cases, is cumbersome for the designer); important transcendental curves and surfaces which are of interest in real-life applications can also be exactly represented (the standard rational Bézier or NURBS models cannot encompass these geometric objects). Moreover, concerning condition numbers and stability, a normalized B-basis is the unique normalized totally positive basis that is optimally stable among all non-negative bases of a given vector space of functions, cf. (Peña, 1999, Corollary 3.4, p. 89). These advantageous properties make normalized B-bases ideal blending function system candidates for curve and surface modeling.Besides their interest in the classical contexts of CAGD and approximation theory, normalized B-bases and their spline counterparts have also been used in isogeometric analysis recently (consider e.g. Manni et al., 2011 and the references therein). Compared with classical final element methods, isogeometric analysis provides several advantages when one describes the geometry by generalized B-splines and invokes an isoparametric approach in order to approximate the unknown solutions of differential equations (e.g. of Poisson type problems) or Dirichlet boundary conditions by the same type of functions.Letn≥1be a fixed integer and consider the extended Chebyshev (EC) system(1)Fnα,β={φn,i(u):u∈[α,β]}i=0n,φn,0≡1,−∞<α<β<∞of basis functions inCn([α,β]), i.e., by definition (Karlin and Studden, 1966), for any integer0≤r≤n, any strictly increasing sequence of knot valuesα≤u0<u1<…<ur≤β, any positive integers (or multiplicities){mk}k=0rsuch that∑k=0rmk=n+1, and any real numbers{ξk,ℓ}k=0,ℓ=0r,mk−1there always exists a unique function(2)f:=∑i=0nλn,iφn,i∈Snα,β:=〈Fnα,β〉:=spanFnα,β,λn,i∈R,i=0,1,…,nthat satisfies the conditions of the Hermite interpolation problem(3)f(ℓ)(uk)=ξk,ℓ,ℓ=0,1,…,mk−1,k=0,1,…,r.In what follows, we assume that the sign-regular determinant of the coefficient matrix of the linear system (3) of equations is strictly positive for any permissible parameter settings introduced above. Under these circumstances, the vector spaceSnα,βof functions is called an EC space of dimensionn+1. In terms of zeros, this definition means that any non-zero element ofSnα,βvanishes at most n times in the interval[α,β]. Such spaces and their corresponding spline counterparts have been widely studied, consider e.g. articles by Lyche (1985), Carnicer and Peña (1994), Mazure (1999), (2001), Mainar et al. (2001), Lü et al. (2002), Carnicer et al. (2004), (2007), Mainar and Peña (2004), Costantini et al. (2005), Mainar and Peña (2010) and many other references therein.Hereafter we will also refer toFnα,βas the ordinary basis ofSnα,β. Using (Carnicer and Peña, 1995, Theorem 5.1) it follows that the vector spaceSnα,βalso has a strictly totally positive basis, i.e., a basis such that all minors of all its collocation matrices are strictly positive. Since the constant function1≡φn,0∈Snα,β, the aforementioned strictly totally positive basis is normalizable, therefore the vector spaceSnα,βalso has a unique non-negative normalized B-basis(4)Bnα,β={bn,i(u):u∈[α,β]}i=0nthat in addition to the identity(5)∑i=0nbn,i(u)≡1,∀u∈[α,β]also fulfills the properties(6)bn,0(α)=bn,n(β)=1,(7)bn,i(j)(α)=0,j=0,…,i−1,bn,i(i)(α)>0,(8)bn,i(j)(β)=0,j=0,1,…,n−1−i,(−1)n−ibn,i(n−i)(β)>0conform (Carnicer and Peña, 1995, Theorem 5.1) and (Mazure, 1999, Equation (3.6)).Using the normalized B-basisBnα,βofSnα,β, one of our objectives is to provide explicit closed formulas for the control point based exact description of integral curves that are specified with coordinate functions given in traditional parametric form in the ordinary basisFnα,βof the same vector space. Based on homogeneous coordinates and central projection, we also propose an algorithm for the control point (and weight) based exact description of the rational counterpart of these ordinary integral curves. Results can easily be extended to the exact representation of families of (hybrid) integral and rational surfaces that are exclusively given in each of their variables by using ordinary EC basis functions of the type (1).To the best of the author's knowledge, the coefficient based exact representation of ordinary (rational) functions, curves and surfaces by means of the (rational or spline counterpart of the) normalized B-basis of an arbitrary EC space (that also comprises the constant functions) was not considered in such a general unified context. Without providing an exhaustive survey, so far the presented problem appears in the literature for example in case of conversion algorithms related to Bernstein polynomials, monomials and the classical families of orthogonal Jacobi, Gegenbauer, Legendre, Chebyshev, Laguerre and Hermite polynomials (Cargo and Shisha, 1966; Barrio and Peña, 2004); in special lower dimensional vector spaces (e.g. in Zhang, 1996; Mainar et al., 2001; Carnicer et al., 2003, 2006; Romani et al., 2014); in case of conical and helical arcs, of catenaries, of patches on all types of quadrics and of helicoidal surfaces (e.g. in Pottmann and Wagner, 1994; Lü et al., 2002); of certain (rational) trigonometric curves of arbitrarily finite order like epi- and hypotrochoidal arcs (Sánchez-Reyes, 1999a), or segments of offset-rational sinusoidal spirals, arachnidas and epi spirals (Sánchez-Reyes, 1999b); or more recently, in case of arbitrary trigonometric and hyperbolic (rational) polynomials, curves, (hybrid) surfaces and volumes of finite order (Róth, 2015a).The rest of the paper is organized as follows. Section 2 lists our main results, namely it describes closed formulas for the basis transformation that maps the normalized B-basisBnα,βof the vector spaceSnα,βto its ordinary basisFnα,βand also specifies control point configurations for the exact representation of certain large classes of integral and rational curves and surfaces that are specified in traditional parametric form by means of ordinary bases likeFnα,β. Although the presented results are mainly of theoretical interest, Section 2 also studies the computational complexity of the proposed basis conversion formulas and – compared with alternative cubic time numerical methods like curve interpolation or least square approximation – points out that these can more efficiently be implemented up ton=15. Section 3 emphasizes the universal applicability of the general basis transformation described in Section 2 with examples that can be compared to presumably already existing results in the literature. This section considers EC vector spaces of functions that may be important in CAGD, in engineering, in (projective) geometry, in (numerical) analysis or in approximation theory. The proofs of all theoretical results stated in Sections 2 and 3 can be found in Section 4. In the end, Section 5 closes the paper with our final remarks.At first, we provide explicit formulas for the transformation of the normalized B-basisBnα,βof the vector spaceSnα,βto its ordinary basisFnα,β.Theorem 2.1General basis transformationThe matrix form of the linear transformation that maps the normalized B-basisBnα,βto the ordinary basisFnα,βis(9)[φn,i(u)]i=0n=[ti,jn]i=0,j=0n,n⋅[bn,i(u)]i=0n,∀u∈[α,β],wheret0,jn=1,j=0,1,…,nandti,0n=φn,i(α),ti,nn=φn,i(β),i=0,1,…,n, whileti,jn=φn,i(α)−1bn,j(j)(α)⋅∑r=1j−1φn,i(r)(α)bn,r(r)(α)(bn,r(j)(α)+ti,jn=+∑ℓ=1j−r−1(−1)ℓ∑r<k1<k2<…<kℓ<jbn,r(k1)(α)bn,k1(k2)(α)bn,k2(k3)(α)…bn,kℓ−1(kℓ)(α)bn,kℓ(j)(α)bn,k1(k1)(α)bn,k2(k2)(α)…bn,kℓ(kℓ)(α))+φn,i(j)(α)bn,j(j)(α),(10)i=1,2,…,n,j=1,2,…,⌊n2⌋,(11)ti,n−jn=φn,i(β)−1bn,n−j(j)(β)⋅∑r=1j−1φn,i(r)(β)bn,n−r(r)(β)(bn,n−r(j)(β)+ti,n−jn=+∑ℓ=1j−r−1(−1)ℓ∑r<k1<k2<…<kℓ<jbn,n−r(k1)(β)bn,n−k1(k2)(β)bn,n−k2(k3)(β)…bn,n−kℓ−1(kℓ)(β)bn,n−kℓ(j)(β)bn,n−k1(k1)(β)bn,n−k2(k2)(β)…bn,n−kℓ(kℓ)(β))ti,n−jn=+φn,i(j)(β)bn,n−j(j)(β),i=1,2,…,n,j=1,2,…,⌊n2⌋.Remark 2.1EvaluationIf in formulas (10) or (11), for someℓ=1,2,…,j−r−1(withr=1,2,…,j−1andj=1,2,…,⌊n2⌋) there exist no integersk1,k2,…,kℓsuch thatr<k1<k2<…<kℓ<jthen, by convention, the summation corresponding to ℓ equals 0. Ifn=2z≥2, then forj=zone can evaluate the entries[ti,z]i=1nof the middle column by using either of these formulas, since the zth coefficients of the ordinary basis functions (1) in the normalized B-basis (4) are unique.Except some special but important cases, in general, one does not know the closed form of the normalized B-basis (4) ofSnα,β. In case of EC spaces of traditional, trigonometric or hyperbolic polynomials of finite degree we have explicit closed formulas cf. Carnicer and Peña (1993), Sánchez-Reyes (1998) and Shen and Wang (2005), respectively; in case of a special class of mixed (e.g. algebraic trigonometric, algebraic hyperbolic, or both trigonometric and hyperbolic) EC spaces these functions appear in recursive integral form cf. Mainar and Peña (2010) and the references therein; while the most general (determinant based) formulas that can be applied in such spaces was published in Mazure (1999). Thus, concerning the evaluation of (10) and (11), in general, one can differentiate the formulas presented in Mazure (1999, Theorem 3.4, p. 658) in order to calculate the higher order derivatives of the normalized B-basis functions (4) at the endpoints of the interval[α,β]. Namely, by using the functionϕ(u):=[φn,1(u)φn,2(u)…φn,n(u)]T,u∈[α,β],one has to substitute the parameter valuesu=αandu=βinto the derivative formulas(12)bn,0(j)(u)=det⁡[ϕ(1)(β)⋯ϕ(n−1)(β)ϕ(j)(u)]det⁡[ϕ(1)(β)⋯ϕ(n−1)(β)ϕ(α)−ϕ(β)],(13)bn,n(j)(u)=det⁡[ϕ(1)(α)⋯ϕ(n−1)(α)ϕ(j)(u)]det⁡[ϕ(1)(α)⋯ϕ(n−1)(α)ϕ(β)−ϕ(α)],(14)bn,i(j)(u)=det⁡[ϕ(1)(α)⋯ϕ(i−1)(α)ϕ(i)(α)ϕ(1)(β)⋯ϕ(n−i−1)(β)ϕ(n−i)(β)]det⁡[ϕ(1)(α)⋯ϕ(i−1)(α)ϕ(β)−ϕ(α)ϕ(1)(β)⋯ϕ(n−i−1)(β)ϕ(n−i)(β)]bn,i(j)(u)=⋅det⁡[ϕ(β)−ϕ(α)ϕ(1)(α)⋯ϕ(i−1)(α)ϕ(j)(u)ϕ(1)(β)⋯ϕ(n−i−1)(β)]det⁡[ϕ(β)−ϕ(α)ϕ(1)(α)⋯ϕ(i−1)(α)ϕ(i)(α)ϕ(1)(β)⋯ϕ(n−i−1)(β)]for alli=1,2,…,n−1andj=1,2,…,n. However, as it is also mentioned in Mazure (1999), these general relations are difficult and computationally expensive to evaluate even in the most simple cases for either arbitrarily big or general values of the order n. Therefore, Section 3 provides explicit closed formulas for the required endpoint derivatives in several special cases. Due to properties (7) and (8), these expressions should only be used whenever one does not know the exact value of the required endpoint derivatives.Another core result of the current section is presented in the next statement which is an immediate corollary of Theorem 2.1 that provides closed formulas for the exact description of ordinary integral curves as convex combinations of control points and normalized B-basis functions (4).Corollary 2.1Exact description of ordinary integral curvesThe ordinary integral parametric curve(15)c(u)=∑i=0nλiφn,i(u),u∈[α,β],λi=[λiℓ]ℓ=1δ∈Rδ,δ≥2of order n can be written as an EC B-curve(16)c(u)≡∑j=0npjbn,j(u),∀u∈[α,β],pj=[pjℓ]ℓ=1δ∈Rδ,of the same order, wherepjℓ=∑i=0nλiℓti,jn,j=0,1,…,n,ℓ=1,2,…,δ.Corollary 2.1 can easily be extended to the control point based exact description of those ordinary bi- or higher variate integral surfaces (volumes) that are specified in traditional parametric form with coordinate functions described as sums of separable products of ordinary linear combinations. Further details can be found in Section 2 of the extended version (Róth, 2015b) of the current manuscript.If the denominator of the rational counterpart of the ordinary integral curve (15) is strictly positive, then, by means of control points and non-negative weights of rank 1, one can also exactly describe ordinary rational curves as it is illustrated in the steps of the next algorithm.Algorithm 2.1Exact description of ordinary rational curvesConsider inRδthe rational curve(17)c(u)=1cδ+1(u)[cℓ(u)]ℓ=1δ,u∈[α,β]given in ordinary parametric form, wherecℓ(u)=∑i=0nλiℓφn,i(u),ℓ=1,2,…,δ+1,cδ+1(u)>0,∀u∈[α,β].Using the rational counterpart of EC B-curves (16), the process that provides the control point and weight based exact representation(18)c(u)≡∑j=0nwjpjbn,j(u)∑r=0nwrbn,r(u),∀u∈[α,β]consists of the following steps:•apply Theorem 2.1 to the higher dimensional pre-imagec℘(u)=[cℓ(u)]ℓ=1δ+1,u∈[α,β], i.e., compute control pointspj℘=[pjℓ]ℓ=1δ+1,j=0,1,…,nfor the exact description ofc℘in the pre-image spaceRδ+1;project the obtained control points from the origin0δ+1∈Rδ+1onto the hyperplanexδ+1=1that results in the control pointspj=1pjδ+1[pjℓ]ℓ=1δ∈Rδand weightswj=pjδ+1needed for the rational representation (18);the above generation process does not necessarily ensure the non-negativity of all weights, since the last coordinate of some control pointspj℘in the pre-image spaceRδ+1can be negative; if this is the case, one should elevate the dimension (and consequently the order n of the normalized B-basisBnα,β) of the underlying EC space with an algorithm that generates a sequence of control polygons inRδ+1that converges toc℘which, by definition, is a geometric object of one branch that does not intersect the vanishing planexδ+1=0, since the(δ+1)th coordinate of all its points is strictly positive; therefore, by using proper dimension elevation methods, it is guaranteed that exists a finite and minimal order for which all weights are non-negative.Remark 2.2About the last step of Algorithm 2.1If the pre-imagec℘of (17) is described as B-curves of type (16) by means of the normalized B-bases of the EC spacesSnα,β⊂Sn+1α,β, thenc℘(u)=∑j=0npj℘bn,j(u)≡∑j=0n+1p1,j℘bn+1,j(u),∀u∈[α,β],wherep1,0℘≡p0℘,p1,n+1℘≡pn℘, whilep1,j℘=(1−ξj)pj−1℘+ξjpj℘for some real numbersξj∈(0,1),j=1,…,n. Iterating this corner cutting based representation ofc℘in the normalized B-bases of the nested EC spacesSnα,β⊂Sn+1α,β⊂…⊂Sn+zα,β⊂…, one obtains a sequence of control polygons which converges to a Lipschitz-continuous limit curve (de Boor, 1990) that, in general, does not necessarily coincide withc℘. As it is pointed out in a unified manner in Róth (2015a, Remark 2.3, p. 76), in case of vector spaces of finite order trigonometric/hyperbolic polynomials, the sequence of order elevated control polygons always converges to the curve generated by the first term of the sequence. In case of traditional polynomials of finite degree, one can use the well-known degree elevation techniques of (rational) Bézier curves. However, in general, the initial ordinary basisFnα,βcan iteratively be appended by new linearly independent functions in infinitely many ways and not every choice of functions leads to a sequence of order elevated control polygons that fulfills the desired convergence property, e.g. in EC Müntz spaces a recent characterization of the required convergence of the dimension/order elevation process can be found in Ait-Hadou (2014). In order to illustrate the last step of Algorithm 2.1, Fig. 1shows two different control point configurations for the exact representation of the rational trigonometric curve(19)c(u)=158−12sin⁡(2u)[12(sin⁡(u)+cos⁡(u))32cos⁡(2u)],u∈[0,π2],by means of second and fourth order normalized trigonometric basis functions of type (26).Using multivariate rational EC B-surfaces, the steps of Algorithm 2.1 can also easily be extended to the control point and weight based exact description of certain large classes of ordinary rational surfaces and volumes. Further details can be found in Section 2 of Róth (2015b).Theorem 2.2Computational complexityProvided that endpoint derivatives{φn,i(j)(α),φn,i(j)(β),bn,i(j)(α),bn,i(j)(β)}i=1,j=0n,⌊n2⌋are calculated and stored in advance in permanent lookup tables for a fixed value ofn≥1, the total number of floating point operations (or shortly flops) that have to be performed for the evaluation of formulas(10)–(11)is(20)κ(n)={2⌊n2⌋+1(⌊n2⌋−3)+2⌊n2⌋+6+2n⌊n2⌋(⌊n2⌋+1),n(mod2)=1,2n2−1(3n2−10)+n+5+n32,n(mod2)=0.Using the normalized B-basisBnα,β, the control point based exact description of the ordinary integral curve (15) can also be imagined either as a curve interpolation problem or as the least square approximation of the considered curve. Both of these alternative numeric methods can be reduced to the solutions of δ systems of linear equations that determine the unknown coordinates of the control points[pj]j=0nappearing in the EC B-curve representation (16). In what follows, we neglect both the floating-point round-off errors and the computational cost of the construction of the regular main matrices of the size(n+1)×(n+1)of these alternative methods, and we compare the exponential computational cost (20) to the total work(21)κLU(n,δ)=23(n+1)3−12(n+1)2−16(n+1)+(2(n+1)2−(n+1))δof an LU decomposition based algorithm that efficiently solves δ systems of linear equations. (Expression (21) covers the cost of computing of all multipliers, of all row operations and of all forward and backward substitutions as well, Press et al. 2007, pp. 48–55, 106–108.) Naturally, as n tends to infinity, the growth rate of the exponential cost function (20) is substantially bigger than that of the cubic one (21), however ifn∈{1,2,…,15}then (20) is less than (21) as it is illustrated in Fig. 2, i.e., compared with other cubic time numerical algorithms, the proposed general basis transformation can more efficiently be implemented up to 16-dimensional EC spaces despite the seemingly complicated nature of formulas (10)–(11).This section applies closed formulas (10) and (11) in case of different vector spaces of functions that can be spanned by ordinary EC bases of the type (1). Our intention is only to emphasize the global applicability of the general basis transformation described in Theorem 2.1 with examples that can be compared to possible already existing results in the literature. Formulas (10) and (11) depend on the higher order endpoint derivatives of the ordinary and normalized B-basis of the underlying vector space. The following subsections specify these values in case of polynomial, trigonometric, hyperbolic and algebraic trigonometric vector spaces of functions. Although we consider several reflection invariant EC spaces, general formulas (10)–(11) are valid in not necessarily reflection invariant EC spaces as well.The systemBn0,1={bn,i(u)=(ni)ui(1−u)n−i:u∈[0,1]}i=0nof Bernstein polynomials of degree n is the normalized B-basis of the EC spaceSn0,1=〈{φn,i(u)=ui:u∈[0,1]}i=0n〉.Proposition 3.1Polynomial endpoint derivativesIn this case one has that(22)φn,i(j)(0)={i!,j=i,0,j≠i,φn,i(j)(1)={i!(i−j)!,i≥j≥0,0,i<j≤n,(23)bn,i(j)(0)={0,i>j≥0,(−1)j−i⋅j!⋅(nj)⋅(ji),i≤j≤n,bn,i(j)(1)=(−1)jbn,n−i(j)(0),i=0,1,…,nfor allj=0,1,…,n.Example 3.1Traditional polynomials of finite degreeAs it is proved in Appendix A of the extended version (Róth, 2015b) of the current manuscript, the substitution forα=0andβ=1of derivatives (22)–(23) into formulas (10) and (11) leads to the expected classical transformation matrix of entries(24)ti,jn={(ji)(ni),j=i,i+1,…,n,0,j=0,1,…,i−1,wherei=0,1,…,n.Letα=0andβ∈(0,π)be fixed parameters and consider the ordinary basis(25)F2n0,β={φ2n,0(u)≡1,{φ2n,2i−1(u)=sin⁡(iu),φ2n,2i(u)=cos⁡(iu)}i=1n:u∈[0,β]}of trigonometric polynomials of order at most n (degree 2n). Using the results of Sánchez-Reyes (1998), the normalized B-basis of the vector spaceS2n0,β=〈F2n0,β〉can linearly be reparametrized into the form(26)B2n0,β={b2n,i(u)=c2n,iβsin2n−i⁡(β−u2)sini⁡(u2):u∈[0,β]}i=02n,where(27)c2n,iβ=c2n,2n−iβ=1sin2n⁡(β2)∑r=0⌊i2⌋(ni−r)(i−rr)(2cos⁡(β2))i−2r,i=0,1,…,nare symmetric normalizing coefficients. It is obvious thatφ2n,2i−1(j)(0)=ijφ2n,2i−1(jπ2),φ2n,2i−1(j)(β)=ijφ2n,2i−1(β+jπ2),j=0,1,…,n,i=1,2,…,n,φ2n,2i(j)(0)=ijφ2n,2i(jπ2),φ2n,2i(j)(β)=ijφ2n,2i(β+jπ2),j=0,1,…,n,i=1,2,…,n,b2n,0(0)=b2n,2n(β)=1,b2n,i(0)=b2n,2n−i(β)=0,i=1,2,…,2n,while the higher order derivatives{b2n,i(j)(0),b2n,i(j)(β)}i=0,j=12n,nare specified by the next theorem.Theorem 3.1Trigonometric endpoint derivativesFor arbitrary derivative orderj=1,2,…,nwe have that(28)b2n,2r+1(j)(0)c2n,2r+1β=122n−1∑k=0n−r−1∑ℓ=0r(−1)n+1−k−ℓ(2(n−r−1)+1k)(2r+1ℓ)⋅((n−k−ℓ)j−(n−k−2r+ℓ−1)j)cos⁡((2(n−r−k)−1)β2−jπ2),for allr=0,1,…,n−1and(29)b2n,2r(j)(0)c2n,2rβ=(2n−2rn−r)22n−1∑ℓ=0r−1(−1)r−ℓ(2rℓ)(r−ℓ)jcos⁡(jπ2)+(2rr)22n−1∑k=0n−r−1(−1)n−r−k(2(n−r)k)(n−r−k)jcos⁡((n−r−k)β−jπ2)+122n−1∑k=0n−r−1∑ℓ=0r−1(−1)n−k−ℓ(2(n−r)k)(2rℓ)⋅((n−k−ℓ)j+(n−k−2r+ℓ)j)cos⁡((n−r−k)β−jπ2),for allr=0,1,…,n. At the same timeb2n,i(j)(β)=(−1)jb2n,2n−i(j)(0),i=0,1,…,2n,j=0,1,…,n.Example 3.2Second order trigonometric polynomialsConsider the ordinary basisF40,β={φ4,0(u)=1,φ4,1(u)=sin⁡(u),φ4,2(u)=cos⁡(u),φ4,3(u)=sin⁡(2u),φ4,4(u)=cos⁡(2u):u∈[0,β]},β∈(0,π)of the vector space of trigonometric polynomials of order at most two (or degree 4) and its normalized B-basis(30)B40,β={b4,i(u)=c4,iβsin4−i⁡(β−u2)sini⁡(u2):u∈[0,β]}i=04,wherec4,0β=c4,4β=1sin4⁡(β2),c4,1β=c4,3β=4cos⁡(β2)sin4⁡(β2),c4,2β=2+4cos2⁡(β2)sin4⁡(β2).Applying identities (10) and (11) forn=4andα=0, one obtains the transformation matrix(31)[ti,j4]i=0,j=04,4=[11111012tan⁡(β2)3sin⁡(β)2+4cos2⁡(β2)sin⁡(β)−12cos⁡(β)tan⁡(β2)sin⁡(β)113(1+cos⁡(β))2+4cos2⁡(β2)cos⁡(β)+12sin⁡(β)tan⁡(β2)cos⁡(β)0tan⁡(β2)6sin⁡(β)2+4cos2⁡(β2)sin⁡(2β)−cos⁡(2β)tan⁡(β2)sin⁡(2β)116cos⁡(β)2+4cos2⁡(β2)cos⁡(2β)+sin⁡(2β)tan⁡(β2)cos⁡(2β)],based on which Fig. 3shows control net configurations for the exact description of some patches of integral and rational trigonometric surfaces given by traditional parametric equations(32){x(u,v)=3cos⁡(u)+12(1+cos⁡(2u))sin⁡(v)−12sin⁡(2u)sin⁡(2v),y(u,v)=3sin⁡(u)+12sin⁡(2u)sin⁡(v)−12(1−cos⁡(2u))sin⁡(2v),z(u,v)=cos⁡(u)sin⁡(2v)+sin⁡(u)sin⁡(v)and(33){x(u,v)=μ(c−acos⁡(u)cos⁡(v))+b2cos⁡(u)a−ccos⁡(u)cos⁡(v),y(u,v)=bsin⁡(u)(a−μcos⁡(v))a−ccos⁡(u)cos⁡(v),z(u,v)=bsin⁡(v)(ccos⁡(u)−μ)a−ccos⁡(u)cos⁡(v),respectively, where(u,v)∈[0,2π]×[0,2π]anda=6,b=42,c=2,μ=3.Now, letα=0andβ>0be fixed parameters. Using hyperbolic sine and cosine functions in expressions (25)–(27) instead of the trigonometric ones, we obtain the vector space of hyperbolic polynomials of order at most n (or degree 2n) the unique normalized B-basis of which was introduced in Shen and Wang (2005). In this caseφ2n,0(j)(u)=0,j=1,2,…,n,b2n,0(0)=b2n,2n(β)=1,b2n,i(0)=b2n,2n−i(β)=0,i=1,2,…,nandφ2n,2i−1(j)(0)={0,j(mod2)=0,ij,j(mod2)=1,φ2n,2i−1(j)(β)={ijsinh⁡(iβ),j(mod2)=0,ijcosh⁡(iβ),j(mod2)=1,φ2n,2i(j)(0)={ij,j(mod2)=0,0,j(mod2)=1,,φ2n,2i(j)(β)={ijcosh⁡(iβ),j(mod2)=0,ijsinh⁡(iβ),j(mod2)=1for alli,j∈{1,2,…,n}, while the higher order derivatives{b2n,i(j)(0),b2n,i(j)(β)}i=0,j=12n,nare specified by the next theorem.Theorem 3.2Hyperbolic endpoint derivativesFor arbitrary derivative orderj=1,2,…,n, one has thatb2n,2r+1(j)(0)c2n,2r+1β={122n−1∑k=0n−r−1∑ℓ=0r(−1)n+((n−r−1)mod2)+(rmod2)−k−ℓ−1(2(n−r−1)+1k)(2r+1ℓ)⋅((n−k−2r+ℓ−1)j−(n−k−ℓ)j)cosh⁡((2(n−k−r)−1)β2),j(mod2)=0,122n−1∑k=0n−r−1∑ℓ=0r(−1)n+((n−r−1)mod2)+(rmod2)−k−ℓ(2(n−r−1)+1k)(2r+1ℓ)⋅((n−k−2r+ℓ−1)j−(n−k−ℓ)j)sinh⁡((2(n−k−r)−1)β2),j(mod2)=1,for allr=0,1,…,n−1, whileb2n,2r(j)(0)c2n,2rβ={(2(n−r)n−r)(2rr)22n+(2(n−r)n−r)22n−1∑ℓ=0r+(rmod2)−1(−1)r+(rmod2)−ℓ(2rℓ)2j(r−ℓ)j+(2rr)22n−1∑k=0(n−r)+((n−r)mod2)−1(−1)(n−r)+((n−r)mod2)−k(2(n−r)k)(n−r−k)jcosh⁡((n−r−k)β)+122n−1∑k=0(n−r)+((n−r)mod2)−1∑ℓ=0r+(rmod2)−1(−1)n+((n−r)mod2)+(rmod2)−k−ℓ(2(n−r)k)(2rℓ)⋅((n−k−3r+2ℓ)j+(n+r−k−2ℓ)j)cosh⁡((n−r−k)β),j(mod2)=0,(2(n−r)n−r)(2rr)22n+(2(n−r)n−r)22n−1∑ℓ=0r+(rmod2)−1(−1)r+(rmod2)−ℓ(2rℓ)2j(r−ℓ)jsinh⁡(2(r−ℓ)β)+122n−1∑k=0(n−r)+((n−r)mod2)−1∑ℓ=0r+(rmod2)−1(−1)n+((n−r)mod2)+(rmod2)−k−ℓ(2(n−r)k)(2rℓ)⋅((n+r−k−2ℓ)j−(n−k−3r+2ℓ)j)sinh⁡(2β(r−ℓ)),j(mod2)=1for allr=1,2,…,nandb2n,i(j)(β)=(−1)jb2n,2n−i(j)(0),i=0,1,…,2n,j=0,1,…,n.Example 3.3Second order hyperbolic polynomialsUsing hyperbolic sine, cosine and tangent functions instead of the trigonometric ones that appear in Example 3.2 and applying the second order hyperbolic normalized B-basis (Shen and Wang, 2005) with the shape parameterβ>0, one can easily construct the hyperbolic counterpart(34)[ti,j4]i=0,j=04,4=[11111012tanh⁡(β2)3sinh⁡(β)2+4cosh2⁡(β2)sinh⁡(β)−12cosh⁡(β)tanh⁡(β2)sinh⁡(β)113(1+cosh⁡(β))2+4cosh2⁡(β2)cosh⁡(β)−12sinh⁡(β)tanh⁡(β2)cosh⁡(β)0tanh⁡(β2)6sinh⁡(β)2+4cosh2⁡(β2)sinh⁡(2β)−cosh⁡(2β)tanh⁡(β2)sinh⁡(2β)116cosh⁡(β)2+4cosh2⁡(β2)cosh⁡(2β)−sinh⁡(2β)tanh⁡(β2)cosh⁡(2β)]of the trigonometric basis transformation (31), the structurally difference of which consists in the highlighted operators.Remark 3.1Asymptotic behaviorBy means of Juhász and Róth (2014, Proposition 2.1) and Shen and Wang (2005, Proposition 5), we know that the linear reparametrization{b2n,i(βx):x∈[0,1]}i=02nof both of the trigonometric normalized B-basis (26) and its hyperbolic counterpart degenerate to the classical Bernstein polynomial basis of even degree 2n as the parameter β tends to 0 from above. This asymptotic behavior is also valid in case of higher order derivatives, i.e.,limβ→0⁡b2n,i(j)(βx)=q2n,i(j)(x),∀x∈[0,1],i=0,1,…,2n,j≥0, whereq2n,i(x):=(2ni)xi(1−x)2n−i.Using the results of Carnicer et al. (2004), for appropriately fixed values ofβ>0, one can also provide general formulas for the required endpoint derivatives of the normalized B-basis in case of a large family of reflection invariant mixed EC spacesSn0,βthat are formed by all solutions of the constant-coefficient homogeneous linear differential equation(35)∑i=0n+1γiv(i)(u)=0,γi∈R,u∈[0,β]of ordern+1, the characteristic polynomialpn+1(r),r∈Cof which is an either even or odd function such thatr=0is one of its (presumably higher order) zeros. Further details can be found in Proposition 3.1, Example 3.5 and Appendix B of the extended version (Róth, 2015b) of the current manuscript. Here, we list only a simple example.Example 3.4Quadratic algebraic trigonometric functionsThe (higher order) zeros of the odd characteristic polynomialp5(r)=r3(r2+1),r∈Cgenerate the reflection invariant EC spaceS40,β=〈F40,β〉=〈{φ4,0(u)=1,φ4,1(u)=u,φ4,2(u)=u2,φ4,3(u)=sin⁡(u),φ4,4(u)=cos⁡(u):u∈[0,β]}〉of algebraic trigonometric functions. Ifβ∈(0,β4⋆:=2π), then the normalized B-basis of this space isB40,β={b4,0(u)=b4,4(β−u),b4,1(u)=b4,3(β−u),B40,β=b4,2(u)=c4,2β(2β(sin⁡(u)−sin⁡(β))−2β(1−cos⁡(β))u+β2+2βsin⁡(β−u)−β2cos⁡(β−u)B40,β={b4,0(u)}=+β2(cos⁡(β)−cos⁡(u))+2(1−cos⁡(β))u2+β(β−u)usin⁡(β)),B40,β=b4,3(u)=c4,3β(2(β−u)+2(sin⁡(u)−sin⁡(β))+2(ucos⁡(β)−βcos⁡(u))+2sin⁡(β−u)B40,β={b4,0(u)}=+β2(u−sin⁡(u))−(β−sin⁡(β))u2),B40,β=b4,4(u)=c4,4β(2cos⁡(u)+u2−2):u∈[0,β]}that can be constructed by using either the differential equation based iterative integral representation published in Mainar and Peña (2010) and the references therein or the determinant based formulas of Mazure (1999, Theorem 3.4). The critical lengthβ4⋆=2πwas determined in Carnicer et al. (2004, Section 5) or Carnicer et al. (2007, Proposition 3), while positive scalarsc4,2β=4−4cos⁡(β)−2βsin⁡(β)(β2−4cos⁡(β)−4βsin⁡(β)+β2cos⁡(β)+4)2,c4,3β=2(β−sin⁡(β))(2cos⁡(β)+β2−2)(β2−4cos⁡(β)−4βsin⁡(β)+β2cos⁡(β)+4),c4,4β=12cos⁡(β)+β2−2are normalizing coefficients. Applying Theorem 2.1 with the settings above, one obtains the transformation matrix(36)[ti,j4]i=0,j=04,4=[1111102cos⁡β+β2−22(β−sin⁡β)(2−2cos⁡β−βsin⁡β)β4−4cos⁡β−2βsin⁡ββ−2cos⁡β+β2−22(β−sin⁡β)β00β2−4cos⁡β−4βsin⁡β+β2cos⁡β+42−2cos⁡β−βsin⁡ββ2−(2cos⁡β+β2−2)β(β−sin⁡β)β202cos⁡β+β2−22(β−sin⁡β)(2−2cos⁡β−βsin⁡β)β4−4cos⁡β−2βsin⁡βsin⁡(β)−(2cos⁡β+β2−2)cos⁡(β)2(β−sin⁡β)sin⁡(β)11(2sin⁡β−β−βcos⁡β)β4−4cos⁡β−2βsin⁡βcos⁡(β)+(2cos⁡β+β2−2)sin⁡(β)2(β−sin⁡β)cos⁡(β)]that mapsB40,βtoF40,β, based on which Fig. 4illustrates the control point based exact description of the cycloidal arcs(37)cℓ(u)=[γℓ0]+[10]⋅u+[−cos⁡(γℓ)sin⁡(γℓ)]⋅sin⁡(u)−[sin⁡(γℓ)cos⁡(γℓ)]⋅cos⁡(u),u∈[γℓ,γℓ+1],βℓ:=γℓ+1−γℓ,γℓ:=π6(ℓ2+ℓ+2),ℓ=0,1,2,3and of helices(38)hℓ(u)=[002βℓ]⋅u+[010]⋅sin⁡(u)+[100]⋅cos⁡(u),u∈[0,βℓ],βℓ=π3+ℓ⋅π6,ℓ=0,1,2,3.Fig. 5(a) shows the control point exact description of the patch(39){x(u,v)=(2+u)⋅cos⁡(v),y(u,v)=(2+u)⋅sin⁡(v),z(u,v)=v,(u,v)∈[0,2]×[0,2π3]of a cylindrical helicoid.Remark 3.2Hybrid EC B-surfacesNaturally, one can also combine different types of normalized B-basis functions in order to describe hybrid surfaces as it is shown in Fig. 5(b) that illustrates the control point based exact description of the hyperboloidal patch(40){x(u,v)=(1+cosh⁡(u−32))⋅sin⁡(v),y(u,v)=(1+cosh⁡(u−32))⋅cos⁡(v),z(u,v)=sinh⁡(u−32),(u,v)∈[0,3]×[0,π2].Proof of Theorem 2.1The linear transformation[ti,jn]i=0,j=0n,nthat maps the normalized B-basisBnα,βof the vector spaceSnα,βto its ordinary basisFnα,βwill be constructed by mathematical induction on the column index j orn−j, wherej=0,1,…,⌊n2⌋. Using one of the properties (5)–(8), at each step j we will compare the left and right side of the jth order derivative of the matrix equality (9), thus obtaining an iterative process that is outlined in Fig. 6.First of all, observe thatt0,j=1,∀j=0,1,…,nandti,0nbn,i(α)=ti,0n=φn,i(α),ti,nnbn,n(β)=ti,nn=φn,i(β),i=0,1,…,n,due to the partition of unity property (5) and to the endpoint interpolation property (6), respectively. Using forward substitutions, the elements of the columns[ti,jn]i=1n,j=1,2,…,⌊n2⌋are iteratively determined by differentiating the matrix equality (9) with gradually increasing order and applying the Hermite conditions (7) atu=α. In order to formulate a mathematical induction hypothesis, let us consider some special cases. Whenj=1one obtains thatφn,i(1)(α)=ti,0nbn,0(1)(α)+ti,1nbn,1(1)(α),i=0,1,…,n,wherebn,1(1)(α)≠0and for the special subcasei=0one has thatbn,0(1)(α)+bn,1(1)(α)=φn,0(1)(α)=0,i.e.,bn,0(1)(α)=−bn,1(1)(α),ti,1n=1bn,1(1)(α)(φn,i(1)(α)−ti,0nbn,0(1)(α))=1bn,1(1)(α)(φn,i(1)(α)+φn,i(α)bn,1(1)(α))=φn,i(α)+φn,i(1)(α)bn,1(1)(α),i=1,2,…,n.Forj=2, we have thatφn,i(2)(α)=ti,0nbn,0(2)(α)+ti,1nbn,1(2)(α)+ti,2nbn,2(2)(α),wherebn,2(2)(α)≠0and for the special subcasei=0we obtain thatbn,0(2)(α)+bn,1(2)(α)+bn,2(2)(α)=φn,0(2)(α)=0,i.e.,bn,0(2)(α)+bn,1(2)(α)=−bn,2(2)(α),ti,2n=1bn,2(2)(α)(φn,i(2)(α)−ti,0nbn,0(2)(α)−ti,1nbn,1(2)(α))=1bn,2(2)(α)(φn,i(2)(α)−φn,i(α)bn,0(2)(α)−(φn,i(α)+φn,i(1)(α)bn,1(1)(α))bn,1(2)(α))=φn,i(α)−1bn,2(2)(α)⋅φn,i(1)(α)bn,1(1)(α)bn,1(2)(α)+φn,i(2)(α)bn,2(2)(α),i=1,2,…,n.In case ofj=3one obtains thatφn,i(3)(α)=ti,0nbn,0(3)(α)+ti,1nbn,1(3)(α)+ti,2nbn,2(3)(α)+ti,3nbn,3(3)(α),i=0,1,…,n,wherebn,3(3)(α)≠0and for the special subcasei=0, one has thatbn,0(3)(α)+bn,1(3)(α)+bn,2(3)(α)+bn,3(3)(α)=φn,0(3)(α)=0,i.e.,−bn,3(3)(α)=bn,0(3)(α)+bn,1(3)(α)+bn,2(3)(α),ti,3n=1bn,3(3)(α)(φn,i(3)(α)−ti,0nbn,0(3)(α)−ti,1nbn,1(3)(α)−ti,2nbn,2(3)(α))ti,3n=1bn,3(3)(α)(φn,i(3)(α)−φn,i(α)bn,0(3)(α)−(φn,i(α)+φn,i(1)(α)bn,1(1)(α))bn,1(3)(α)ti,3n=−(φn,i(α)−1bn,2(2)(α)⋅φn,i(1)(α)bn,1(1)(α)bn,1(2)(α)+φn,i(2)(α)bn,2(2)(α))bn,2(3)(α))ti,3n=φn,i(α)−1bn,3(3)(α)(φn,i(1)(α)bn,1(1)(α)(bn,1(3)(α)−bn,1(2)(α)bn,2(3)(α)bn,2(2)(α))+φn,i(2)(α)bn,2(2)(α)bn,2(3)(α))+φn,i(3)(α)bn,3(3)(α),i=1,2,…,n.One can observe that expressions corresponding to these special cases are in accordance with formula (10). Now, fix the column indexj∈{1,2,…,⌊n2⌋−1}and assume that formula (10) is valid up to the selected index j and we will also prove it forj+1. We can proceed as follows:φn,i(j+1)(α)=∑γ=0j+1ti,γnbn,γ(j+1)(α),i=0,1,…,n,wherebn,j+1(j+1)(α)≠0and for the special subcasei=0we have that∑γ=0j+1bn,γ(j+1)(α)=φn,0(j+1)(α)=0,i.e.,(41)∑γ=0jbn,γ(j+1)(α)=−bn,j+1(j+1)(α)andti,j+1n=1bn,j+1(j+1)(α)⋅(φn,i(j+1)(α)−∑γ=0jti,γnbn,γ(j+1)(α))=φn,i(j+1)(α)bn,j+1(j+1)(α)−1bn,j+1(j+1)(α)∑γ=0jbn,γ(j+1)(α)ti,γn=φn,i(j+1)(α)bn,j+1(j+1)(α)−1bn,j+1(j+1)(α)⋅∑γ=0jbn,γ(j+1)(α)(φn,i(α)+φn,i(γ)(α)bn,γ(γ)(α)−1bn,γ(γ)(α)⋅∑r=1γ−1φn,i(r)(α)bn,r(r)(α)(bn,r(γ)(α)+∑ℓ=1γ−r−1(−1)ℓ∑r<kγ,1<kγ,2<…<kγ,ℓ<γbn,r(kγ,1)(α)bn,kγ,1(kγ,2)(α)bn,kγ,2(kγ,3)(α)…bn,kγ,ℓ−1(kγ,ℓ)(α)bn,kγ,ℓ(γ)(α)bn,kγ,1(kγ,1)(α)bn,kγ,2(kγ,2)(α)…bn,kγ,ℓ(kγ,ℓ)(α)))=(41)φn,i(j+1)(α)bn,j+1(j+1)(α)+φn,i(α)−1bn,j+1(j+1)(α)⋅∑γ=0jbn,γ(j+1)(α)(φn,i(γ)(α)bn,γ(γ)(α)−1bn,γ(γ)(α)⋅∑r=1γ−1φn,i(r)(α)bn,r(r)(α)(bn,r(γ)(α)+∑ℓ=1γ−r−1(−1)ℓ∑r<kγ,1<kγ,2<…<kγ,ℓ<γbn,r(kγ,1)(α)bn,kγ,1(kγ,2)(α)bn,kγ,2(kγ,3)(α)…bn,kγ,ℓ−1(kγ,ℓ)(α)bn,kγ,ℓ(γ)(α)bn,kγ,1(kγ,1)(α)bn,kγ,2(kγ,2)(α)…bn,kγ,ℓ(kγ,ℓ)(α)))=φn,i(α)−1bn,j+1(j+1)(α)⋅∑r=1jφn,i(r)(α)bn,r(r)(α)(bn,r(j+1)(α)+∑ℓ=1j−r(−1)ℓ∑r<k1<k2<…<kℓ<j+1bn,r(k1)(α)bn,k1(k2)(α)bn,k2(k3)(α)…bn,kℓ−1(kℓ)(α)bn,kℓ(j+1)(α)bn,k1(k1)(α)bn,k2(k2)(α)…bn,kℓ(kℓ)(α))+φn,i(j+1)(α)bn,j+1(j+1)(α),which means that our induction hypothesis is correct for all column indicesj=1,2,…,⌊n2⌋.Using a similar technique based on backward substitutions, the entries of the columns[ti,n−jn]i=1n,j=1,2,…,⌊n2⌋can also iteratively be determined by differentiating the matrix equality (9) with gradually increasing order and applying the Hermite conditions (8) atu=β. After correct reformulations one obtains exactly the formula (11).  □Proof of Theorem 2.2Leti∈{1,2,…,n},j∈{1,2,…,⌊n2⌋},r∈{1,2,…,j−1}andℓ∈{1,2,…,j−r−1}be fixed indices at the moment and consider formula (10). There are(j−r−1ℓ)pairwise distinct strictly increasing sequencesr<k1<k2<…<kℓ<jof length ℓ between r and j that can also be stored in permanent lookup tables, since they are independent of the applied normalized B-basis. In case of each of these sequences one has to evaluate the fractionfj,r,ℓ:=bn,r(k1)(α)bn,k1(k2)(α)bn,k2(k3)(α)⋅…⋅bn,kℓ−1(kℓ)(α)bn,kℓ(j)(α)bn,k1(k1)(α)bn,k2(k2)(α)⋅…⋅bn,kℓ(kℓ)(α)that includes 2ℓ flops (i.e., ℓ multiplications in the nominator,ℓ−1multiplications in the denominator and 1 division). Thus, the total number of flops required for the evaluation of the summation(42)sj,r,ℓ:=∑r<k1<k2<…<kℓ<jfj,r,ℓequals2ℓ⋅(j−r−1ℓ)+((j−r−1ℓ)−1)for each fixed values ofℓ=1,2,…,r−1, where the last term in the parentheses appears due to additions that have to be performed in (42). If one considers all possible values of ℓ and observes that(−1)ℓis just an alternating sign (implying either addition or subtraction), the number of flops performed during the evaluation of the expressiongj,r:=bn,r(j)(α)+∑ℓ=1j−r−1(−1)ℓsj,r,ℓbn,r(r)(α)is∑ℓ=1j−r−1(2ℓ⋅(j−r−1ℓ)+(j−r−1ℓ)−1)+[1+(j−r−2)]+1=2j−r−1⋅(j−r)that consists of the evaluation cost of all{sj,r,ℓ}ℓ=1j−r−1, of1+(j−r−2)=j−r−1additions and of 1 division.Observe that values{gj,r}r=1j−1are independent of the row index i for all fixed column indicesj=1,2,…,⌊n2⌋, i.e., they can be evaluated and stored in a temporary lookup table by performing∑r=1j−12j−r−1⋅(j−r)=2j−1⋅j−2j+1flops and later they can be reused for the evaluation of all quantitieshi,j:=∑r=1j−1φn,i(r)(α)⋅gj,r,i=1,2,…,n.Thus, independently of i, the calculation ofhi,jtakes an additional2j−3flops (i.e.,j−1multiplication andj−2addition) for all fixed values ofj=1,2,…,⌊n2⌋. Finally, each of the column entriesti,jn=φn,i(α)−hi,j−φn,i(j)(α)bn,j(j)(α),i=1,2,…,ncan be evaluated by means of 3 additional flops for all fixed values ofj=1,2,…,⌊n2⌋.Thus, the total number of flops required for the evaluation of unknown entries[ti,jn]i=1,j=1n,⌊n2⌋of the general transformation matrix is(43)∑j=1⌊n2⌋(2j−1⋅j−2j+1)+n⋅∑j=1⌊n2⌋[(2j−3)+3]=2⌊n2⌋(⌊n2⌋−3)+⌊n2⌋+3+n⌊n2⌋(⌊n2⌋+1).Since the structure of formula (11) is very similar to that of (10), one can conclude that for odd numbers n the total computational cost of all unknown entries of the general transformation matrix is twice of (43), while for even values of n the entries of the middle column do not have to be reevaluated by means of (11), i.e., in this latter case the partial computational cost (43) has to be increased by∑j=1n2−1(2j−1⋅j−2j+1)+n⋅∑j=1n2−1[(2j−3)+3]=2n2−1(n2−4)+n2+2+n22⋅(n2−1),which leads to the final expression (20).  □Proof of Theorem 3.1In order to determine the higher order derivatives of normalized B-basis functions (26) at the endpoints of the interval[0,β], we will make use of trigonometric identitiessin2r+1⁡(θ)=222r+1∑ℓ=0r(−1)r−ℓ(2r+1ℓ)sin⁡((2(r−ℓ)+1)θ),sin2r⁡(θ)=122r(2rr)+222r∑ℓ=0r−1(−1)r−ℓ(2rℓ)cos⁡((2(r−ℓ))θ),wherer∈Nandθ∈R. E.g. ifi=2r+1(r=0,1,…,n−1), thenb2n,2r+1(u)c2n,2r+1β=sin2(n−r−1)+1⁡(β−u2)sin2r+1⁡(u2)=(222(n−r−1)+1∑k=0n−r−1(−1)n−r−1−k(2(n−r−1)+1k)sin⁡((2(n−r−k)−1)β−u2))⋅(222r+1∑ℓ=0r(−1)r−ℓ(2r+1ℓ)sin⁡((2(r−ℓ)+1)u2))=122(n−1)∑k=0n−r−1∑ℓ=0r(−1)n+1−k−ℓ(2(n−r−1)+1k)(2r+1ℓ)⋅sin⁡((2(n−r−k)−1)β−u2)sin⁡((2(r−ℓ)+1)u2)=122n−1∑k=0n−r−1∑ℓ=0r(−1)n+1−k−ℓ(2(n−r−1)+1k)(2r+1ℓ)⋅(cos⁡((n−k−ℓ)u−(2(n−r−k)−1)β2)−cos⁡((n−k−2r+ℓ−1)u−(2(n−r−k)−1)β2)),from which follows thatb2n,2r+1(j)(u)c2n,2r+1β=122n−1∑k=0n−r−1∑ℓ=0r(−1)n+1−(k+ℓ)(2(n−r−1)+1k)(2r+1ℓ)⋅((n−(k+ℓ))jcos⁡((n−(k+ℓ))u−(2(n−r−k)−1)β2+jπ2)−(n−k−2r+ℓ−1)jcos⁡((n−k−2r+ℓ−1)u−(2(n−r−k)−1)β2+jπ2))for allj≥0. Substitutingu=0into the last expression, one obtains exactly the formula (28). Ifi=2r(r=0,1,…,n), then one can proceed analogously.  □Proof of Theorem 3.2In order to determine the higher order derivatives of the hyperbolic counterpart of the normalized B-basis functions (26) (see also Subsection 3.3) at the endpoints of the interval[0,β], one can follow the steps of the proof of Theorem 3.1 by applying the hyperbolic identitiessinh2r+1⁡(θ)=222r+1∑ℓ=0r(−1)r+(rmod2)−ℓ(2r+1ℓ)sinh⁡((2(r−ℓ)+1)θ),sinh2r⁡(θ)=122r(2rr)+222r∑ℓ=0r+(rmod2)−1(−1)r+(rmod2)−ℓ(2rℓ)cosh⁡((2(r−ℓ))θ)and basic propertiessinh(j)⁡(ωu)={ωjsinh⁡(ωu),j(mod2)=0,ωjcosh⁡(ωu),j(mod2)=1,cosh(j)⁡(ωu)={ωjcosh⁡(ωu),j(mod2)=0,ωjsinh⁡(ωu),j(mod2)=1,2cosh⁡(θ1)cosh⁡(θ2)=cosh⁡(θ1+θ2)+cosh⁡(θ1−θ2)of the hyperbolic sine and cosine functions, wherer∈Nandθ,θ1,θ2,ω∈R.  □As listed in Section 1, concerning geometric modeling, the normalized B-bases (of EC spaces that also comprise the constant functions) ensure many optimal shape preserving properties and algorithms. Moreover, they may also provide useful design or shape parameters that can arbitrarily be specified by the user or the engineer. In Section 3, we have seen that polynomial, trigonometric, hyperbolic or mixed EC spaces allow us to obtain the control point based exact description of many (rational) curves and surfaces that are important in several areas of applied mathematics. The investigated large classes of vector spaces also ensure the description of famous geometrical objects (like ellipses; epi- and hypocycloids; Lissajous curves; torus knots; foliums; rose curves; the witch of Agnesi; the cissoid of Diocles; Bernoulli's lemniscate; Zhukovsky airfoil profiles; cycloids; hyperbolas; helices; catenaries; Archimedean and logarithmic spirals; ellipsoids; tori; hyperboloids; catenoids; helicoids; ring, horn and spindle Dupin cyclides; non-orientable surfaces such as Boy's and Steiner's surfaces and the Klein Bottle of Gray).EC bases of type (1) represent a large family of vector spaces that can be used in real-world applications, e.g. besides of examples described in Section 3, general formulas of Theorem 2.1 can also be applied in the exponential space〈{1,eλ1u,eλ2u,…,eλnu:u∈[α,β]}〉,0<λ1<λ2<…<λn,α<β,or in the space〈{1,uλ1,uλ2,…,uλn:u∈[α,β]}〉,0<λ1<λ2<…<λn,[α,β]⊂(0,∞)of restricted Müntz polynomials among many others.Storing in permanent lookup tables the zeroth and higher order endpoint derivatives of the ordinary EC basis (1) and of the normalized B-basis (4) induced by it, general formulas (10)–(11) and the proposed control point based curve/surface modeling tools can efficiently be implemented up ton=15, even by means of a sequential algorithm. Considering that, in practice, curves and surfaces are mostly composed of continuously joined lower order arcs and patches, even a sequential but clever implementation of Theorem 2.1 can be useful in case of real-life applications. (If one uses multi-threading, the value of n, for which one can provide an efficient implementation, can be higher.) Nevertheless, ifn>15, the presented results are mainly of theoretical interest.

@&#CONCLUSIONS@&#
