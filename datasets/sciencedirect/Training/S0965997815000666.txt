@&#MAIN-TITLE@&#
Software for estimation of second order effective material properties of porous samples with geometrical and physical nonlinearity accounted for

@&#HIGHLIGHTS@&#
A method for estimation of effective properties of porous materials is presented.The second-order nonlinearities are accounted for.The effective material properties as functions of porosity are examined.The computations were carried out in parallel using CUDA technology.Accounting for nonlinear effects is essential for estimation of effective properties.

@&#KEYPHRASES@&#
Effective properties,Porous material,Finite strain,Physical nonlinearity,Finite-element method,Parallel computations,

@&#ABSTRACT@&#
A method and an algorithm for numerical estimation of effective mechanical properties of porous materials are presented. The effective properties are sought in the form of the nonlinear relation between the second Piola–Kirchhoff stress tensor and the Green strain tensor for anisotropic materials with second-order nonlinearities accounted for. The effective characteristics of test models are computed by means of a CAE Fidesys program module based on the proposed algorithm. The effective material properties as functions of porosity are examined. The finite element mesh that contained more than a million of elements was used while performing stress analysis of a specimen. To reduce computing time, assembly and solution of the global equation system was done in parallel using CUDA technology. The computations were carried out on NVIDIA Tesla C2050 graphics processors. Our results show that accounting for nonlinear effects is essential for correct estimation of effective properties of porous materials.

@&#INTRODUCTION@&#
The problem of estimating the effective properties of porous materials [1] is important for the analysis of specimen properties during geological exploration of oil fields. Such material properties are used for computational modeling of physical processes in the course of field development and operation. At present the existing mathematical models do not allow to calculate the effective properties of porous materials with the accuracy suitable for industrial use. The effective material properties are usually determined experimentally, by testing of multiple specimens. Nevertheless, an efficient development of an oil field is impossible without complicated numerical modeling that requires significant computer power. It is necessary to perform multiple computer solutions for the determination of effective averaged properties of porous samples. Computational procedure for estimation of averaged properties of porous materials is suitable for effective parallelization using large number of computational nodes, such as in cluster-type systems. The use of hybrid supercomputers (MPI, CUDA, Open MP-based) allows enormous increase of the speed of modeling effective prototype properties thus decreasing time and cost of laboratory tests.Let us consider the representative volume, filled with porous material. We assume that an effective (averaged) material should satisfy to the following condition: average volume stresses in real and effective materials are equal under the same displacements of faces that bound the representative volume [2–4].Here we describe a method for creating effective constitutive relationships for the porous material with the use of definition given above. We solve certain sequences of boundary value problems of nonlinear elasticity for the representative volumeV0in its initial state (before deformation) [6–8]:(1)∇·σ=0with boundary conditions(2)uΓ0=R·(Fe∗-I)It is shown [9] that the superposition of a rigid motion on the deformation of a porous body does not change the effective constitutive equations.The mechanical properties of a matrix material are described by Hooke’s law or by constitutive relations of Murnaghan [5]:(3)Σ0=λ(E:I)I+2GE+3C3(E:I)2I+C4(E2:I)I+2C4(E:I)E+3C5E2Hereσis the true total state stress tensor (Cauchy stress tensor);Σ0is the second Piola–Kirchhoff stress tensor; E is the Green strain tensor; I is the second-order identity tensor; F is the corresponding affinor (deformation gradient) [6],F=drdR;Ris the radius vector of a particle in the initial state, r is the radius vector of a particle in the current state;r-R=u,uis the displacement vector from the initial state to the current state;λand G are the first-order elastic constants;C3,C4, andC5are the second-order elastic constants. The index e corresponds to the effective material. The colon in equations is the sign of double tensor contraction.Each problem sequence corresponds to certain appearance of the Green strain tensorEeof the effective material (and to certain deformation gradient F in boundary conditions). Also, different problems of one sequence differ by strain magnitude.We find stress tensorσby solving each problem of each sequence. Usingσit is possible to calculate stress tensorσeof effective material according to the following formula:(4)σe=1V∫VσdV=1V∫ΓN·σrdΓwhere N is an external normal to boundaryΓand r is the radius vector.Last equality in (4) has been received with the help of the divergence theorem and the following observation from tensor analysis:(5)∇·(σr)=(∇·σ)r+σ(∇r)∗=(∇·σ)r+σ·I=σKnowing the deformation gradient (that was set by us) and true stress tensor, we can calculate Green strain tensor and second Piola–Kirchhoff stress of the effective material:(6)Ee=12(Fe∗·Fe-I)(7)Σe0=(detFe)(Fe)-1·σe·(Fe)∗-1We assume that the dependence of the Piola–Kirchhoff stress tensor components on a strain parameter q for each problem sequence (i.e. for each load type) can be described by a quadratic function:(8)Σije0=αij0q+αij1q2Accordingly we will search for effective constitutive relations as a nonlinear dependence of the Piola–Kirchhoff stress tensorΣe0on the Green strain tensorEe:(9)Σije0=Cijkl0Ekle+Cijklmn1EkleEmneThe second term in the right-hand side is introduced in order to take into account nonlinear effects in the effective constitutive equations.The effective elastic moduliCijkl0andCijklmn1of the porous material depend on porosity.It is worth noting that finding the effective constitutive relations of the porous material in the nonlinear case above requires solving 21 sequences of cases (equal to the number of independent elastic modules in (9)). Each sequence must contain no less than three problems (i.e. for each load type – no less than three load cases) in order to perform least squares method for determining coefficients in (8).In practice it is convenient to set the Green strain tensor and to employ it for computation of the deformation gradient using formula (6). Since the deformation gradient is a non-symmetric tensor of the second rank it cannot be uniquely determined from the symmetric Green strain tensor. That is why we set the deformation gradient as an upper triangular matrix. Then its six components are uniquely defined by six independent components of the Green strain tensor.After calculation of the deformation gradient, we apply boundary conditions (2) to the model, solve the boundary value problem of nonlinear elasticity and find stressesσ.The following sequences of problems are solved:(1)E11=q– uniaxial tension or compression in the X direction;E22=q– uniaxial tension or compression in the Y direction;E33=q– uniaxial tension or compression in the Z direction;E12=E21=q– shear in the XY plane;E13=E31=q– shear in the XZ plane;E23=E32=q– shear in the YZ plane;E11=E22=q– biaxial tension or compression in the XY plane;E110=E330=q– biaxial tension or compression in the XZ plane;E110=E220=E330=q– uniform tension or compression;E11=q,E12=E21=q– superposition of uniaxial tension or compression in the X direction and shear in the XY plane;E22=q,E12=E21=q– superposition of uniaxial tension or compression in the Y direction and shear in the XY plane;E33=q,E12=E21=q– superposition of uniaxial tension or compression in the Z direction and shear in the XY plane;E11=q,E13=E31=q– superposition of uniaxial tension or compression in the X direction and shear in the XZ plane;E22=q,E13=E31=q– superposition of uniaxial tension or compression in the Y direction and shear in the XZ plane;E33=q,E13=E31=q– superposition of uniaxial tension or compression in the Z direction and shear in the XZ plane;E11=q,E23=E32=q– superposition of uniaxial tension or compression in the X direction and shear in the YZ plane;E22=q,E23=E32=q– superposition of uniaxial tension or compression in the Y direction and shear in the YZ plane;E33=q,E23=E32=q– superposition of uniaxial tension or compression in the Z direction and shear in the YZ plane;E12=E21=q,E13=E31=q– superposition of shears in the XY and XZ planes;E12=E21=q,E23=E32=q– superposition of shears in the XY and YZ planes;E13=E31=q,E23=E32=q– superposition of shears in the XZ and YZ planes;here q is a strain parameter.The effective stress tensorσeis calculated with the help of averaging (4). Using Eq. (7), the Piola–Kirchhoff stress tensorΣe0is determined.Then the dependence of the Piola–Kirchhoff stress tensor on the strain parameter q is generated for each problem sequence. These dependences are approximated by expressions (8). Coefficientsαij0andαij1are found using the least squares method.The coefficientsCijkl0from (9) are determined through the coefficientsαij0, and coefficientsCijklmn1– throughαij1that are calculated for the corresponding problem sequence by solving a linear algebraic system composed of 21 equations. Taking into account the symmetry of the Green strain tensor, we assume thatCijkl0=Cijlk0. Then it is sufficient to find the following coefficientsCijkl0:Cij110Cij220Cij330Cij120Cij230Cij130These six coefficients are calculated from the results of first six problem sequences by solving a system of six linear algebraic equations.Taking into account the Green strain tensor symmetry and the appearance of effective constitutive relations we assume thatCijklmn1=Cijlkmn1,Cijklmn1=Cijklnm1,Cijklmn1=Cijmnkl1. Then it is sufficient to find the following coefficientsCijklmn1:Cij11111Cij12121Cij13131Cij22221Cij23231Cij33331Cij11121Cij12131Cij13221Cij22231Cij23331Cij11131Cij12221Cij13231Cij22331Cij11221Cij12231Cij13331Cij11231Cij12331Cij11331These 21 coefficients are determined by solving a system of 21 linear algebraic equations. The additional averaging of effective modules along coordinate directions is performed. This averaging permits one to write the effective constitutive equations for porous materials in the form of Murnaghan model.The proposed algorithm was implemented as a program module (plug-in) in CAE Fidesys [10] with parallelization on the basis of CUDA technology [11] thus allowing the use of the computational power of graphics processing unit (GPU) as massively parallel equipment.A program package CAE Fidesys is dedicated to solving static and dynamic stress analysis problems for elastic and elastic–plastic solids under finite strains with the use of the finite element method (FEM), spectral element method (SEM) and the discontinuous Galerkin method (DG). The package has been developed in such a way that it can be executed on an ordinary desktop or notebook PC computer. If a PC computer has a powerful video card, computations can be made in parallel with CUDA technology giving considerable speedup (up to 30 times). In addition, the package is suitable for supercomputer usage with MPI-based parallelization.A uniqueness of CAE Fidesys package is related to a possibility of solving problems in which new boundary surfaces (cavities) are originated under loading or material properties are changed in some part of the solid that leads to the redistribution of finite strains in the computational domain [7,12]. The package allows direct modeling of the redistribution of finite strains. Unlike schemes with “element killing” or change of material properties inside elements (when boundary conditions are not taken into account precisely), this software uses an approach based on the exact expressions for the full analytical problem statement including a forced removal of the solid part. An approach based on the direct replacement of the system of nonlinear partial differential equations by the system of nonlinear algebraic ones by means of FEM or SEM and their further solution is used in the package.CAE Fidesys includes some enhancements of computational schemes such as:1.Enhancement of models, computational methods and algorithms, in particular:1.1.Better precision for modeling of nonlinear effects arising under finite strains and their redistribution.Possibility to take into account a forced change of the solid shape (structural element shape) under large deformations with the origination of new surfaces in a loaded solid.Modeling a change of material properties (including phase transitions in solids) under large deformations including the analysis for nano-size templates.Using modern variants of constitutive equations.Solving different types of coupled problems including the case of finite strains.Application of the newest computational schemes to solving problems of mathematical physics, for example, a fully explicit spectral element method and discontinuous Galerkin method.Use of modern computational schemes, software and hardware:2.1.Use of modern software libraries and tools that allow drastically simplify program development and speed-up computational processes.Parallelization of computational processes with the use of shared memory systems, computer clusters and massively-parallel computers.Application of newest technologies to the use of additional PC resources, for example, using CUDA technology for parallel computations of the GPU.Cloud computing support by means of SAAS (software as a service) Fidesys-online [13] – a web-interface to CAE Fidesys for performing remote computations in a cloud.While performing numerical simulation in CAE Fidesys both assembly of the global finite element stiffness matrix [14,15] and equation solution [16] are performed in parallel. The assembly of the global stiffness matrix requires stiffness matrix calculation for all finite elements. In our program, each thread calculates its local element matrix, and saves it to the global stiffness matrix. The conjugate gradient method is selected for solving the global equation system. Its algorithm includes just computing sparse matrix–vector product and scalar products for vectors. These operations are relatively easy for parallelization.Profiling of a computational process demonstrated that in case of GPU the most time consuming part is sparse system solution (47% of a total time), while global stiffness matrix assembly takes about 23%. That is why it was decided to accelerate these parts by their parallelization on the GPU. The parallel version of the program based on CUDA technology demonstrated speedup of 6.8 compared to the sequential program when using a workstation with two NVIDIA Tesla C2050 graphics processors.Fig. 1illustrates an example of a finite element mesh for the porous medium built in CAE Fidesys. Finite element mesh contains 2,323,969 tetrahedral elements and 401,946 nodes.As was mentioned in the description of the algorithm for estimation of effective properties, the computational model (the representative volume of porous material) is subjected to 21 load types. Fig. 2shows analysis results for one of load types – displacement distribution in the computational model. For each load type we perform 3–4 solutions with different load levels. Dependences of the second Piola–Kirchhoff stress components on load magnitude are determined for each load type (Eq. (8)) using the least squares method. Then the coefficients of the effective constitutive relations (9) are computed.For the modeling of the porous medium, the ensemble averaging is used. The scheme of ensemble averaging is similar to the scheme that was proposed in [17] for 2D case. This scheme approximately simulates a statistically uniform and isotropic distribution of pores. We suppose that all the pores assume a spherical shape in the undeformed state and are uniform in size. Let the representative volumeV0be a cube of side a, whose sides are parallel to the coordinate axes. The uniform mesh with nodes (xi,yj,zk)is constructed inV0:xi=(i+1/2)h,yj=(j+1/2)h,zk=(k+1/2)h,wherei=0,…N-1;j=0,…N-1;k=0,…N-1;h=a/N; N is a given integer.So, the mesh consists ofM=N3nodes. It is assumed that centers of pores are located exactly on the nodes of the mesh. There are2Marrangements of pores satisfying this assumption. For each arrangement, the effective moduliCijkl0,Cijklmn1are computed using the scheme presented above. Then the averaging over all these arrangements is performed with regard for their probabilities, which depend on porosity.Let P denote the probability of existence of a pore, whose center is at a certain node. It is assumed that P does not depend on the existence of pores whose centers are in other nodes. Taking into account these assumptions, one can obtain an expression for porosity ratio p:(10)p=PVporeh3=P4πρ33h3,whereρis the pore radius, andVpore=(4/3)πρ3is the pore volume.From (10) one can express the probability P in terms of porosity:(11)P=p3h34πρ3.Letαbe an arrangement of pores, and there are k pores in this arrangement. With regard for the assumptions made, one can obtain the probabilityPαof this arrangement:(12)Pα=Pk(1-P)M-k.LetC(α)be one of the moduliCijkl0,Cijklmn1obtained for the arrangementα, andCbe the correspondent modulus obtained by averaging by the arrangements. Then one can write(13)C=∑αC(α)Pα,where summation is made over all arrangements.Using Eqs. (11)–(13), one can express the effective elastic moduli in terms of porosity.Note that the conditionρ<h/2is necessary and sufficient to avoid intersections of boundaries of pores with one another and with the boundary of the representative volume.It follows from (10) that the limiting value of porosity for this scheme ispmax=4πρ3/(3h3).After the computation of moduliCijkl0,Cijklmn1, their averaging by all possible orientations of coordinate axes is performed [17]. This averaging permits one to represent the effective constitutive equations in a form (3) proposed by Murnaghan.The dependences of effective modules of the first and the second order on the porosity ratio are shown in Figs. 3 and 4. The computations are performed forN=2,ρ/h=0.42. The effective modules are related to the shear modulus of the solid material. The results show that the dependence of nonlinear modules on the porosity ratio (Fig. 4) is not always monotone.

@&#CONCLUSIONS@&#
