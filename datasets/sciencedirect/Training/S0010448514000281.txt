@&#MAIN-TITLE@&#
Multi-dimensional dynamic programming in ruled surface fitting

@&#HIGHLIGHTS@&#
A multi-dimensional dynamic programming based ruled surface fitting scheme to a freeform rational surface.Providing solutions for the Ruled Surface Fitting (RSF) problem and the Ruled Surface Partitioning (RSP) problem in the discrete domain.Error-bound can be achieved by using the surface–surface composition technique.Highly parallel algorithms running on GPUs are employed to evaluate the multi-dimensional dynamic programming.

@&#KEYPHRASES@&#
Ruled surface fitting,Multi-dimensional dynamic programming,Surface–surface composition,GPU algorithms,

@&#ABSTRACT@&#
Ruled surfaces play an important role in many manufacturing and construction applications. In this work, we explore a multi-dimensional dynamic programming based ruled surface fitting scheme to a given freeform rational surface,S. Considering two initial opposite boundaries ofS, sampled into a discrete piecewise linear polyline representation, the ruled surface fitting problem is reduced to a pairing-search between the polylines and elevations above the polylines, in the normal directions ofS. A four-dimensional dynamic programming solution is sought for the four dimensions prescribed by the two polylines and the two elevation levels along the surface normals. This multi-dimensional dynamic programming is evaluated using highly parallel algorithms running on GPUs that ensures the best fit to the sampled data. In order to evaluate the fitting error with respect toS, we derive a scheme to compute a bound from above on the maximal error between a bilinear surface patch (formed by two consecutive point-pairs) and its corresponding surface region onS. Surface–surface composition is employed to extract the corresponding surface region onSto compare against. Finally, the above ruled surface fitting approach is also extended into a discrete algorithm to find the non-isoparametric subdivision curve onSwhen a discrete recursive piecewise-ruled surface fitting is considered. A five- or seven-dimensional dynamic programming solution is employed towards this end and once again, surface–surface composition is employed to extract the two subdivided patches as tensor products.

@&#INTRODUCTION@&#
Ruled surfaces are widely used in many applications in manufacturing as well as civil engineering application. In manufacturing, while multi-axis CNC processes are well known, other manufacturing technologies, such as wire Electrically Discharged Machining (EDM)  [1] and 5-axis CNC flanking milling  [2–4] are also in extensive use. In wire EDM, a conducting wire is discharging electricity against a conductive stock and evaporates and cuts ruling lines in the material. Tool side CNC machining (e.g., flank milling) exploits the linear edge of the rotating tool to similarly cut along a line after carefully considering the non-zero thickness of the tool. Interestingly enough, other manufacturing processes also cut along lines in 3D. Examples include CNC water jet cutting as well as laser cutting. In building construction, ruled surfaces are used for the realization of free-form architecture  [5]. Recently, the use of hot wire cutting in styrofoam was also proposed towards mold making of surface tiles in architecture design [6].Within all above applications, it is interesting that the following Ruled Surface Fitting (RSF) is still a highly investigated problem:ProblemRSFGiven a parametric surfaceS(u,v), find the best ruled surface fit toSunder some metric.A good solution to the above RSF problem would clearly increase the usability and quality of all aforementioned technologies for fabricating a given surfaceSby swept cutting lines. The accuracy of the resulting artifact would greatly benefit from such an optimal ruling fit. However, as a ruled surface is hyperbolic in general  [7], one can expect that only a hyperbolic patch (or parabolic)Swill benefit from such a ruled surface fitting. Forced to use a line-cutting based technology that constructs ruled surfaces, the benefits for elliptical surface regions cannot be significant. Nevertheless, one can still hope to find the optimal ruled surface fit to any surfaceSunder this constrained manufacturing technologies. If multiple ruled surface patches may be tiled together, while fittingS, the solution of the best Ruled Surface Partitioning (RSP) problem is also highly desirable:ProblemRSPGiven a parametric surfaceS, find the non-isoparametric partitioning ofSinto two sub-patchesSLandSR(or more generally several sub-patches), that is best fitted by two (several) piecewise ruled surfaces, minimizing some metric in RSF.Finding the global optimum for RSF and RSP is difficult; unlike the prior work based on numerical optimization, this paper presents a ruled surface fitting scheme for solving the RSF and RSP problems in the discrete domain formed by sample points. The scheme finds an optimal ruled surface fitting once the discrete piecewise linear sampled sets of the boundaries ofSand the possible elevation (again discrete) of these points along the local normal ofS, are given. Each discrete ruling line is defined through two elevated sampled points on two opposite boundaries. The elevation is along the normal ofSand is also discretized.Two consecutive ruling lines above the discrete sampled point set define a bilinear surface patchBfor which the corresponding patch ofS,Sb, is extracted using a surface–(bilinear) surface composition. An upper bound on the Hausdorff distance betweenBandSbis established by computing a bound on‖B(u,v)−Sb(u,v)‖.A four-dimensional dynamic programming problem is defined for all possible pairs of points and all possible allowed elevations. The best ruling fit to this discrete arrangement is then determined by solving a four-dimensional dynamic programming (4D-DP). A simple example can be seen in Fig. 1. The DP algorithm has two phases. First a multi-dimensional table is computed for all possible pairing and elevations, a 4D table in this case. Then, path tracking is conducted from the source (the first ruling line at the beginning of the two boundaries) to the destination (the last ruling line at the end of the two boundaries). Special treatment must be made for the end conditions as the first and last ruling lines can be in arbitrary elevations. Further, ifSis a periodic surface, the first and the last ruling lines must be the same ruling line.Both DP steps are of a complexity order that depends on the dimension of the built table. If each side of the table is of lengthn, the 4D-DP has complexity ofO(n4). However, the computation of each entry in the table requires an upper bound on the Hausdorff distance of‖B(u,v)−Sb(u,v)‖and the construction time of the DP table governs the entire computation costs. Therefore, we employ highly parallel algorithms running on Graphics Processing Units (GPUs) to speed up the construction of the DP table.

@&#CONCLUSIONS@&#
