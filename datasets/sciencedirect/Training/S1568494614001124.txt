@&#MAIN-TITLE@&#
Color differences based fuzzy filter for extremely corrupted color images

@&#HIGHLIGHTS@&#
Adaptive fuzzy membership functions have been constructed in the proposed technique for both bell-shaped and triangle-shaped fuzzy sets.Idea of multiple fuzzy membership functions has been incorporated in an effective manner for the removal of impulse noise from degraded images.Detailed sensitivity analysis is presented, showing that different fuzzy membership functions perform better for different types of images at different noise ratio.Automatic selection of best suitable fuzzy membership function will definitely give the better filtering results.

@&#KEYPHRASES@&#
Color image restoration,Impulse noise,Fuzzy filter,

@&#ABSTRACT@&#
In this paper, a color difference based fuzzy filter is presented for fix and random-valued impulse noise. Noise detection scheme of two stages was applied to detect noise efficiently whereas for noise removal an improved Histogram based Fuzzy Color Filter (HFC) is presented. Pixels detected as noisy by the noise detection scheme are deliberated as candidate for the removal of noise. Candidate noisy pixels are then processed using a modified Histogram based Fuzzy Color Filter to estimate their non-noisy values. The idea of using multiple fuzzy membership functions is presented, so that best suitable membership function for local image statistics can be used automatically. In the proposed technique we have used three different types of fuzzy membership functions (bell-shaped, trapezoidal-shaped, and triangular-shaped) and their fuzzy number construction algorithms are proposed. Experimentation is also performed with three, five, and seven membership functions. Type and number of suitable fuzzy membership functions are then identified to remove noise. Comparison with the existing filtering techniques is established on the basis of objective quantitative measures including structural similarity index measure (SSIM) and peak-signal-to-noise-ratio (PSNR). Simulations show that this filter is superior to that of the existing state-of-the-art filtering techniques in removing fix and random-valued impulse noise whereas retaining the details of the image contents.

@&#INTRODUCTION@&#
Image restoration has been used in so many applications in the last few years. They range from exploration of space to as for the medical diagnosis. Various effectual and refined techniques for image restoration have been proposed in both the spatial and transformed domains [16]. Image restoration may be defined as “the process of restoring the original image from corrupted one with or without having prior knowledge about the degradation procedure. Pre-processing, transmission, compression, acquisition, storage and/or reproduction phases of processing leads to image degradation. [7]. Restoring the image, removal of such degradation is considered as an important issue in image processing, for example, an important task is to remove the impulse noise without destroying the image details. Smoothing a region of the degraded image may lead to blurrier edges while sharpening edges can cause amplification of unnecessary noise. Standard impulse noise filtering procedures are generally based on median modifications [17]. Most of the filters are subjected to be applied on the image as a whole, apart from applying on the noisy pixels, pixels that are not altered and are noise free are also changed that is the key contributing factor for destroying the image specifics. Switching scheme concept is an important strategy to improve the impulse noise removal without destroying the image details [18]. The concept suggests that we should detect the noisy pixels first and then we should proceed to the process of noise removal. Noise free pixels should remain unchanged during the filtering process. Most of the newly proposed filters are based on this approach. Since only the selected pixels are estimated during the filtering process, therefore most of the image details can be maintained in this case by not estimating the noise-free pixels present in the degraded image. In these filter, the core is the efficient and accurate noise detection process. Since degradation can occur on smooth regions as well as on edges, therefore, estimation of noisy pixels can still lead to distortion of edges. So we need a correct noise detection process as well as an effective detail preserving filter to restore the degraded image. Color image restoration is a difficult task as compared to the gray-scale image restoration but it is a logical step in the study of image restoration [35,37,38]. The major problem in color image restoration is that restoration algorithm must take care of correlation between different color components. Majority of the methods, proposed for color image restoration, apply the filtering mechanism to each color channel, say Red, Green and Blue in RGB model, independently. The images restoration techniques discussed in paper 2 are mainly used for grayscale images but they can also be applied to color images by applying them to each color component independently. This procedure leads to the introduction of many artifacts especially on edge or texture elements. As these techniques are applied on each component separately, each color component is restored by a different amount of noise. As a result correlation between different color components may disturb, producing color artifacts in images [3,5,6].To cater for the problem of artifacts, researcher introduced vector-based color image restoration techniques. A very famous sets of nonlinear filters that makes use of the theory of robust statistics [8,13] is based on the ordering of vectors in a predefined sliding window [21,22,26]. The basic principle behind vector-based techniques is to rank the vectors with the help of a proper resembling measure using the reduced ordering principle. The vectors that are closest to the other vectors in the window, on the basis of the distance measure used, are the lowest ranked vectors. So we can easily mark noise by observing the highest rank in the window [24,25,27].The major problem with these color filters is that they cannot adapt to images with different level of details because of fixed amount of filtering. Therefore a lot of modified versions of vector filters are developed. In 2007, “Histogram-based fuzzy color filter For image restoration, fuzzy color filter based on histogram was developed by Schulte et al. [9] This filter tries to maintain color differences while using well-known HFF[40] algorithm for color images and therefore outperforms other techniques for color image restoration.In this paper, a fuzzy logic based filter for noise reduction is proposed. This technique comprises impulse noise detection modules along with color differences based fuzzy filtering module for the removal of impulse noise preserving details of the image like texture information and edges. Major contributions of the paper include:•Adaptive fuzzy membership functions have been constructed in the proposed technique for both Bell-Shaped and Triangle-Shaped fuzzy sets.Idea of multiple fuzzy membership functions has been incorporated in an effective manner for the removal of impulse noise from degraded images.Detailed sensitivity analysis is presented, showing that different fuzzy membership functions perform better for different types of images at different noise ratio. So automatic selection of best suitable fuzzy membership function will definitely give the better filtering results.The remaining paper is organized as follows: Proposed technique is discussed in Section 2. Fuzzy number construction algorithms are presented in Section 3. Fuzzy filtering module is deliberated in Section 4. Comparative study along with sensitivity analysis of the proposed technique has been discussed in Section 5. Section 6 concludes the present study along with some future recommendations.Proposed technique utilizes two-stage noise detection scheme, calculation of color difference matrix along with novel idea of fuzzy set assembly algorithms and process of fuzzy filtering. System architecture is explained in Fig. 1. Input of the system is a 256×256 noisy color image having gray values from 0 to 255 for each R, G, and B components. A 3×3 sliding window is passed through the whole image. To categorize the central pixel as noisy, we have used two-stage noise detection process [9], which separates out the noisy pixels. Color differences based fuzzy filtering process is used to restore the noisy pixels.Fuzzy filtering process uses color difference matrices and newly proposed fuzzy set noise-free for removal of noise. For each difference matrix reference difference is estimated with the help of normalized difference matrix by using its membership value in fuzzy set noise-free. This reference difference is used in actual color difference calculation. Fuzzy number construction algorithms are used to construct fuzzy membership functions in fuzzy set noise-free as described below (Section 3). These number construction algorithms construct fuzzy membership functions based on image contents dynamically. Membership functions of three types are applied which include trapezoidal, triangular and bell shaped with 3, 5, and 7 fuzzy sets. To preserve the color differences, outputs from all membership functions is compared with the reference value and closest output value of de-fuzzification process is used by filtering method.The process of noise detection and filtering is iterated till count of the noisy pixels becomes slightly small. Noise detection, algorithms of fuzzy number construction and the process of fuzzy filtering are presented in detail in the subsequent subsections.Three fuzzy membership functions have been used which include bell, trapezoidal, and triangular shaped fuzzy membership functions.Bell Shaped Function:(1)μLosmall(rgk)=1,ifrgk≤γ11.01.0+powx–γ1α1,2.0×β1,ifrgk>γ1,k=1,2,…,9μMDsmall(rgk)=1.01.0+powx–γ2α2,2.0×β2,k=1,2,…,9μHismall(rgk)=1.01.0+powx–γ3α3,2.0×β3,ifrgk≤γ31,ifrgk>γ3,k=1,2,…,9Trapezoidal Shaped Function:(2)μ(rgk)=0,if(x<ai)(rgk−ai)(bi−ai),if(rgk≥aiANDrgk<bi)1,if(rgk≥biANDrgk<ci)(di−rgk)(di−ci),if(rgk≤ciANDrgk<di)0,if(rgk≥di)Triangular Shaped Function:(3)μ(rgk)=0,if(rgk<αi)(rgk−αi)(b−α),if(rgk≥αiANDrgk<βi)(γi−rgk)(γi−βi),if(rgk≤βiANDrgk<γi)0,if(rgk≥γi)For trapezoidal and triangular shaped functions, Lo, MD, and Hi fuzzy sets can constructed by replacing i with 1, 2, and 3.Most important part of fuzzification process is the construction of membership functions. We have proposed a method which dynamically uses the histogram of the image under consideration for the construction of fuzzy membership functions. Therefore the proposed filtering method performs better for low as well as high contrast images.Following flowcharts show the detail of fuzzy number construction process for bell, trapezoidal and triangular shapes functions. Fuzzy number construction algorithm for trapezoidal shaped fuzzy membership function has been used from [42], however bell and triangular shaped fuzzy number construction algorithms have been proposed in this paper. We have explained the process for five membership functionsVLOαVLO,βVLO,γVLO,LOαLO,βLO,γLO,MDαMD,βMD,γMD,HIαHI,βHI,γHIandVHIαVHI,βVHI,γVHIfor Bell-Shaped and Triangular-Shaped fuzzy sets. Here VLO corresponds to very low dynamic range in the image, LO corresponds to low dynamic range, MD corresponds to medium dynamic range, HI corresponds to high dynamic range, and VHI corresponds to very high dynamic range, Histogram of the source images can be used to derive the membership functions which depict the intensity feature of non-noisy images.Let h(Ik)=gkbe a discrete function describing histogram of an image I with gray-level ranging from 0 to L–1, where gkis number of pixels having kth gray-level in image I and Ikis the kth gray-level in I. Then the proposed algorithms for construction of Bell-Shaped and Triangular-Shaped fuzzy sets can be explained as below. The algorithms calculate the parameter values of α, β, and γ for both fuzzy sets dynamically using image contents.First of all color differences are estimated and then filtering is performed so that color-component differences are not changed.Information about the color component difference is used to maintain correlation between different color components. So the following matrices are calculated for an image I:(4)MRG(x,y)=IR(x,y)−UG(x,y)MRB(x,y)=IR(x,y)−IB(x,y)MGB(x,y)=IG(x,y)−IB(x,y)MGR(x,y)=MRF(x,y)MBR(x,y)=MRB(x,y)MBG(x,y)=MBG(x,y)The matrices introduced in (Eq. (4)) are used to estimate the differences between color components of the moving window around a central pixel. We use windows of size (2K+1)×(2K+1) (with K=1) to traverse the normalized matrices (Eq. (4)).For all elements the windows mentioned above 3, 5, and 7 membership degrees are calculated in parallel to the fuzzy sets. These are realized by the bell-shaped (Eq. (1)), trapezoidal-shaped (Eq. (2)), and triangular-shaped (Eq. (3)) membership functions in different experiments. The parameters a, b, c, and d for the above mentioned membership functions are derived in the number construction step (Figs. 2 and 3).The first stage of the filtering method consists of following steps.Table 1.Output of the step 8 is transformed from interval [0,1] into the [−(2m−1), +(2m−1)] interval. This value (suppose for RG matrix) is the approximated noise-free color difference for the pixel at position (i, j) between red and green component. In this way we further use output values for all matrices by filtering method to preserve the color transformations. The color component of a pixel is considered non-noisy element, which has nil membership degree in the fuzzy set noise, and therefore does not takes part in filtering process. Color components having non-zero value in fuzzy set noise (for green component μnoise(IG(x, y))>0) are considered to be noisy and hence filtering process is applied on them.Filtering technique considers several different cases, that are explained below for noisy red component pixel IR(x, y) (i.e. μnoise(IR(x, y))).CASE1:μnoise(IG(x,y))>0andμnoise(IB(x,y))>0FR(x,y)=∑k=19(1−μnoise(IRk))IRk∑k=19(1−μnoise(IRk))CASE2:μnoise(IG(x,y))=0andμnoise(IB(x,y))>0FR(x,y)=IG(x,y)+Δ′RG(x,y)CASE3:μnoise(IG(x,y))>0andμnoise(IB(x,y)_=0FR(x,y)=IB(x,y)+Δ′RB(x,y)CASE4:μnoise(IG(x,y))=0andμnoise(IB(x,y))=0FR(x,y)=0.5(IG(x,y)+Δ′RG(x,y))+0.5(IB(x,y)+Δ′RB(x,y))where FR(x, y) represents the filtered output value.In the first instance it might happen that∑k=19(1−μnoise(IRk))=0(that is exceptional). In this situation median, of all intensity values involved, is set as the output value FR(i, j).In the following subsections, experimental results of the proposed technique have been presented along with sensitivity analysis.Proposed filtering technique comprises of two-stage noise detection and fuzzy filtering process. Noise detection technique plays vital role in the noise removal process, so we used robust noise detection scheme based on direction and fuzzy noise detection technique. Pixels identified by both stages are considered as noisy. The major part of filtering process depends upon the fuzzy set construction algorithms. In literature, fuzzy filtering techniques use a single fuzzy membership function for construction of fuzzy sets. Experiments show that different membership functions give better results for different type of images. Our technique has the uniqueness of constructing fuzzy sets based on bell, trapezoidal, and triangular shaped membership functions, and dynamically selecting the best suitable membership function for the filtered image. This makes our algorithm adaptive to image contents and hence it performs better than state-of-the-art filtering techniques.Proposed method has been thoroughly tested on variety of well known test images and results are reported on “Lena” image here. In our experiments 24-bit color image is used. We performed sensitivity analysis of the anticipated filter toward number of fuzzy membership functions and types of fuzzy membership functions. Comparison is given for bell, trapezoidal and triangular shape fuzzy membership functions with 3, 5 and 7 functions. Performance of the proposed filter is also associated with several other advanced impulse noise filters based on subjective and quantitative measures of the error. The quantitative measures used are peak-signal-to-noise-ratio (PSNR) and structural similarity index measure (SSIM), which can be defined by the following equation.(5)PSNR(F,O)=10×log10S2MSE(F,O)where O is the original image, F is the restored image of size NM, S is the maximum possible intensity value (for 8-bit images the maximum is 255) and MSE is mean square error defined by the following equation.(6)SSIM(x,y)=(2μxμy+c1)(2σxy+c2)(μx2+μy2+c1)(σx2+σy2+c2)withμxis the average of x, μyis the average of y,σx2is the variance of x,σy2is the variance of y. σxyis the covariance of x and y. c1=(k1L)2, c2=(k2L)2 are two variables to stabilize the division with weak denominator. L is the dynamic range of the pixel-values (typically this is 2#bitsperpixel−1). k1=0.01 and k2=0.03 by default.The sensitivity analysis of the proposed filter can be seen in Tables 2 and 3and Figs. 4 and 5with respect to PSNR and SSIM for Lena image. The results are shown for impulse noise rate ranging from 0.1 to 0.9.Table 2 shows comparison of PSNR values of our technique for bell-shaped, trapezoidal-shaped, and triangular-shaped fuzzy sets with 3, 5, and 7 membership functions. This table gives results of our technique for fix-valued (salt & pepper) impulse noise. We can see that best results are found with bell-shaped membership functions while trapezoidal-shaped being in tight competition. 3 and 5 membership functions give better results for low noise density, while 5 and 7 membership functions give better results for high noise density. Trapezoidal-shaped 5 and 7 membership functions give equally good results, while results with 3 membership functions are not so promising. Results with triangular-shaped membership function are not so good as compared to others.Table 3 gives comparison of results for impulse noise based on random-valued. Removal of random-value based impulse noise is a hard task, as amount of noise keeps varying and gets mixed with actual image contents. As we can see from Table 3, our techniques performs best with trapezoidal-shaped 5 and 7 membership functions. Results with bell-shaped membership functions are comparable.Detail preserving is one of the major goals of a noise removal technique. We used SSIM as a measure of detail preservation. Figs. 4 and 5 give sensitivity analysis of our technique with respect to SSIM for salt & pepper and random-valued impulse noise.Fig. 4 (a, c and e) shows graphs of SSIM for 3, 5, and 7 membership functions for salt & pepper impulse noise. We can see that for 3 membership functions, bell-shaped function outperforms the other two with respect to detail preserving capability. For 5 membership functions, bell-shaped and trapezoidal-shaped functions give equally better results as compare to triangular-shaped functions. In case of 7 membership functions, we see that trapezoidal-shaped membership function outperforms the other two for low noise and it gives equally good results to bell-shaped membership function for high noise.Fig. 4(b, d and f) shows graphs of SSIM for bell-shaped, trapezoidal-shaped and triangular-shaped membership functions. We see that for bell-shaped functions, 7 membership functions give better results of high noise and perform equally better to 3 and 5 membership functions for low noise. So we infer that detail preserving for bell-shaped functions is best at 7 membership functions. For bell-shaped membership functions, 5 functions give better results for high noise and give equally better results to 7 functions for low noise. Detail preserving capability of triangular-shaped functions is not so good, as it can be seen in graph.As we just inferred that for detail preserving bell-shaped, 7 membership functions gives best results. We also have seen for Fig. 4(e) that for 7 functions, trapezoidal-shaped function gives better results as compared to bell-shaped. So we conclude that our technique gives best detail-preserving capability with trapezoid-shaped membership functions.Similarly Fig. 5(a, c and e) shows graphs of SSIM for 3, 5, and 7 membership functions for random-valued impulse noise. And Fig. 5(b, d and f) shows graphs of SSIM for trapezoidal, triangular and bell shaped membership function for random-valued impulse noise. Comparing the results could enable us to see that bell-shaped 7 membership functions give best results for random-valued impulse noise.Fig. 6(a, c and e) shows graphs of PSNR of Parrots image for 3, 5, and 7 membership functions for fix-valued impulse noise. And Fig. 6(b, d and f) shows graphs of PSNR for trapezoidal, triangular and bell shaped membership function for fix-valued impulse noise. Comparing the results could enable us to see that different fuzzy sets with different number of membership functions give better results at different noise densities. So combining them will result in optimally filtered image.The performance capability of the proposed filter is matched with other filters in Tables 4 and 5for salt & pepper and random-valued impulse noise respectively. Fig. 7shows the visual results of the proposed technique compared with other techniques. The results are averaged over 20 iterations for salt & pepper impulse noise rate ranging from 0.03 to 0.50 and for random-valued impulse noise from 0.03 to 0.20. Salt & pepper impulse noise removal results (see Table 4) show that the proposed technique exhibits better image restoration for all the test images as compare to other filtering methods because of better noise detection technique and fuzzy number construction algorithms. Proposed technique outperforms other filtering techniques for noise rates ranging from 0.03 to 0.30 and for noise rate greater than 0.50. Table 5 showing the performance of the anticipated technique for removal of random-valued impulse noise remains consistent with the results obtained for salt & pepper impulse noise removal (Table 4).Furthermore, visual results for the image “Lena” under consideration, corrupted with 20% impulse noise are shown in Fig. 7. We see that the proposed filter gives better visual results in tight competition with HFC [9] and FIDRM [31,32].

@&#CONCLUSIONS@&#
