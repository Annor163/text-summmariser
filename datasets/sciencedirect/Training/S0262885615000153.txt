@&#MAIN-TITLE@&#
Registration of images with affine geometric distortion based on Maximally Stable Extremal Regions and phase congruency

@&#HIGHLIGHTS@&#
A combination of coarse alignment and refinement is employed in the method.Input images are coarsely aligned by fitting and normalizing the matched MSERs.A phase congruency and point set registration based refinement step is used.The method accurately and efficiently aligns images with affine distortions.The method is robust to illumination changes.

@&#KEYPHRASES@&#
Image registration,Affine transformation,Maximally Stable Extremal Region,Phase congruency,Point set registration,

@&#ABSTRACT@&#
This paper proposes a novel method to address the registration of images with affine transformation. Firstly, the Maximally Stable Extremal Region (MSER) detection method is performed on the reference image and the image to be registered, respectively. And the coarse affine transformation matrix between the two images is estimated by the matched MSER pairs. Two circular regions containing roughly the same image content are also obtained by fitting and normalizing the centroids of the matched MSERs from the two images. Secondly, a scale invariant and approximate affine transformation invariant feature point detection algorithm based on the Gabor filter decomposition and phase congruency is performed on the two coarsely aligned regions, and two feature point sets are achieved, respectively. Finally, the affine transformation matrix between the two feature point sets is obtained by using a probabilistic point set registration algorithm, and the final affine transformation matrix between the reference image and the image to be registered is achieved according to the coarse affine transformation matrix and the affine transformation matrix between the two feature point sets. Several sets of experiments demonstrate that our proposed method performs competitively with the classical scale-invariant feature transform (SIFT) method for images with scale changes, and performs better than the traditional MSER and Affine-SIFT (ASIFT) methods for images with affine distortions. Moreover, the proposed method shows higher computation efficiency and robustness to illumination change than some existing area-based or feature-based methods do.

@&#INTRODUCTION@&#
Image registration is to overlay two or more images containing the same scene shot at different times, from different viewpoints or by different sensors [1]. It has been widely applied to many fields, such as image stitching [2], image fusion [3], and 3D reconstruction [4]. Because of the different structures caused by different viewpoints, the alignment for image pairs with affine geometric distortion is much more difficult than that for images with some simple transformations (e.g., translation, rotation and scaling). This paper proposes a novel method by using a two-step way, i.e., by combining a coarse alignment based on feature region detection and a refinement based on feature point detection, to address the registration of images with affine transformation.So far, there have been numbers of image registration algorithms, which can be divided into two categories [1], i.e., area-based and feature-based methods. The area-based image registration methods [5–9] generally employ some optimization algorithms to search the transformation model between two input images, in which some windows of predefined size or even the whole image is used [1]. However, if there is large affine distortion between images, these area-based methods will obtain some unsatisfactory results. In addition, the huge parameter space of the transformation model often leads to high computation complexity [1]. Differently, the feature-based methods [10–15] utilize the salient features instead of image intensities to determine the transformation model between the two input images. They are more robust to some complex geometric deformations, such as the affine distortion, and have higher computation efficiency than the area-based ones do [1]. Therefore, the feature-based methods are more widely used to align images with complex geometric distortions [1].Especially, many feature-based methods have been proposed to align images with affine geometric distortion. For example, Flusser and Suk [13] utilized closed-boundary region features to align the SPOT and Landsat images, in which the moment-based invariants were used to describe the regions. Yang and Cohen [14] computed the affine geometric invariants of the border triangles generated by object convex hull. They successfully recovered the affine transformation and mapped the reference object into the test object domain. Moreover, some affine invariant region detectors, such as Harris–Laplace [16], Hessian–Laplace [17], Maximally Stable Extremal Region (MSER) [18] and the improved MSER [19] have been proposed. These detectors can effectively detect invariant regions from the image pairs. And the centroids of the detected regions are often used to establish the geometrical relationship and estimate the affine transformation model. But the shapes of the detected regions are usually unstable because of some image distortions, such as affine distortion, scale change, illumination change and blur. This influences the localization accuracy of each detected region's centroid, and reduces the final registration precision.Compared with region features, point features, such as Harris corners [20] and Scale Invariant Feature Transform (SIFT) [21] points, usually have more stable localization against those image distortions mentioned above. Higher registration precisions may be achieved by using point features instead of region features to estimate the transformation model between the image pairs. For instance, Lin and Du et al. [15] used the correlation between the edge images to determine the homologous corner points, and then established the affine transformation model between the two input images. It should be noted that most of the feature point detection methods are not affine invariant, although some methods (e.g., SIFT) can obtain many correspondences from images with a narrow range of affine transformation. Generally, low feature repeatability rate [22]11The feature repeatability rate is the percentage of the total observed features that are detected in both images. More details can be seen in [22].is obtained when these feature point detectors are directly performed on the images with affine geometric distortion, especially when the affine distortion is too large. This reduces the registration precisions to some extent. Recently, Morel and Yu [23] proposed a fully affine invariant feature detection method, i.e., Affine-SIFT (ASIFT), by which, good registration results can be obtained on images with large affine geometric distortion. However, the computation complexity of the ASIFT is very high, which limits its application in aligning images of large size. Considering the affine invariance of the region features and the high localization accuracy of the point features, more point correspondences with high feature repeatability rate will be obtained if the feature point detection is performed on the detected affine invariant regions instead of on the original image pairs. Correspondingly, the registration results will also be improved by the combination of point and region detections.In this paper, a novel affine image registration method is proposed based on the Maximally Stable Extremal Region (MSER) [18] and phase congruency [24,25]. In the proposed algorithm, two circular image regions are firstly obtained by fitting and normalizing the matched MSERs, and the coarse affine transformation matrix between the two input images is thus estimated. Secondly, a point detection algorithm (GDPC, for short) based on the Gabor filter decomposition and the maximal phase congruency moment [26] is performed on the two circular regions. Two sets of points with scale and approximate affine invariance are thus obtained from the reference image and the image to be registered, respectively. Finally, the point set registration method in [27] is performed on the two point sets and the transformation matrix between them is obtained. The final affine transformation matrix between the input image pairs is achieved according to the coarse affine transformation matrix and the affine transformation matrix between the two feature point sets.The proposed method is an adaptation of a number of commonly used techniques. But it should be noted that the proposed method is not a simple combination of the existing methods. Three main contributions are made in this paper. (1) The proposed registration method is implemented by using a two-step way, i.e., the region feature based coarse alignment and the point feature based refined registration. By the combination of the two steps, the proposed method makes best use of the affine-invariance of the region detectors and the localization accuracy of the point detectors, and then outperforms some traditional registration methods, such as the SIFT, MSER and ASIFT methods, for images with scale or affine distortions. (2) A novel MSER based registration method is proposed in the coarse alignment step. Instead of directly using the matched MSER pairs to estimate the transformation matrix, we first obtain two coarsely aligned circular regions by fitting and normalizing the matched MSER pairs in the reference image and the image to be registered, and then obtain the coarse estimation of the transformation matrix according to the relationship between the two circular regions. By this way, the parameters in the transformation matrix model are more easily estimated due to the fact that there mainly exist scale and rotation geometric distortions between the two circular regions after normalization. More feature points and higher feature repeatability rate in the subsequent refinement step will also benefit from the two coarsely aligned circular regions considering the fact that they contain more common image contents than any individual matched MSER pair. In addition, we present a new method to exclude the mismatched MSER pairs by using a voting mechanism in the coarse alignment of the sub-regions. (3) A phase congruency based feature point detection method (i.e., GDPC method) and a point set registration method are jointly employed to refine the coarse alignment. The employed GDPC point detector improves the robustness of the proposed registration method to illumination change. And the employed point set registration algorithm avoids the construction of descriptors for the detected feature points in the refinement step and increases the computation efficiency of the proposed method to some extent.The rest of the paper is organized as follows. Section 2 gives a brief introduction to the related work. In Section 3, the diagram of the proposed image registration approach is provided, which consists of three parts. And the three parts will be described in detail in Sections 4, 5 and 6, respectively. Experimental results are presented in Section 7 and some conclusions are drawn in Section 8.

@&#CONCLUSIONS@&#
In this paper, a novel image registration method is proposed to align images with affine distortions by using a two-step way. The coarse affine transformation matrix between the reference image and the image to be registered is first estimated by using an improved MSER based registration method. Then the final affined transform matrix is refined by using a phase congruency based point detector and a probabilistic point set registration method. We show that the combination of the two-step way makes the proposed method outperform some traditional area-based methods (e.g., the MSER–MI and MSER–CC methods) and feature-based methods (e.g. MSER, SIFT, ASIFT and MSER–ASIFT methods) for images with scale changes or affine distortions. Especially, with the help of the phase congruency based point detector in the refinement step, the proposed method shows higher robustness to illumination change than those existing methods do. Owing to the employed point set registration algorithm, the construction of descriptors is canceled in the refinement step, and the computation complexity of our proposed registration method is also reduced to some extent. Experimental results demonstrate that the run time of our proposed method is about the half of that of the ASIFT method.