@&#MAIN-TITLE@&#
CheapTrick, a spectral envelope estimator for high-quality speech synthesis

@&#HIGHLIGHTS@&#
A spectral envelope estimator is presented for high-quality speech synthesis.The proposed algorithm enables us to obtain the temporally stable spectral envelope.Objective results showed the proposed algorithm was better than other algorithms.Subjective results showed that the proposed algorithm can synthesize natural speech.

@&#KEYPHRASES@&#
Speech synthesis,Speech analysis,Spectral envelope,Time-varying component,

@&#ABSTRACT@&#
A spectral envelope estimation algorithm is presented to achieve high-quality speech synthesis. The concept of the algorithm is to obtain an accurate and temporally stable spectral envelope. The algorithm uses fundamental frequency (F0) and consists of F0-adaptive windowing, smoothing of the power spectrum, and spectral recovery in the quefrency domain. Objective and subjective evaluations were carried out to demonstrate the effectiveness of the proposed algorithm. Results of both evaluations indicated that the proposed algorithm can obtain a temporally stable spectral envelope and synthesize speech with higher sound quality than speech synthesized with other algorithms.

@&#INTRODUCTION@&#
A speech analysis, manipulation, and synthesis framework is an important research topic ranging from singing synthesis (Kenmochi, 2012) to voice conversion. The origin of this framework was based on the idea of Vocoder (Dudley, 1939), and its framework consists of the fundamental frequency (F0) and spectral envelope estimators. In particular, since spectral envelope estimation was important for speech synthesis, several estimation algorithms such as Cepstrum (Noll, 1964; Oppenheim, 1969) and linear predictive coding (LPC) (Atal and Hanauer, 1969) have been proposed. Many improved algorithms have been proposed to estimate spectral envelopes accurately, such as discrete all-pole modeling (El-Jaroudi and Makhoul, 1991), weighted maximum likelihood autoregressive and moving average modeling (Badeau and David, 2009), and penalized likelihood approach (Campedel-Oudot et al., 2001). However, the sound quality of the speech synthesized by using these algorithms was less than that by using waveform-based synthesis such as PSOLA (Moulines and Charpentier, 1990). Sinusoidal models (McAulay and Quatieri, 1986) are also effective for high-quality speech synthesis, but it is difficult for them to achieve high-quality voice conversion. Spectral envelope is still useful for the flexible voice conversion such as eigenvoice conversion (Ohtani et al., 2010) and voice morphing (Kawahara et al., 2009).Statistical parametric speech synthesis (Zen et al., 2009) is focused on for achieving a high-quality text-to-speech synthesis system. Several approaches have been proposed such as deep neural networks (Zen et al., 2013) and Gaussian process regression (Koriyama et al., 2014), and they require the accurate spectral envelope as the training data. Alternatively, a spectral envelope estimation method using a statistical approach (Toda and Tokuda, 2008) was also proposed for the statistical parametric speech synthesis.A modern framework STRAIGHT (Kawahara et al., 1999) was proposed as an effective framework for high-quality speech synthesis. STRAIGHT achieved not only the high-quality speech synthesis but also F0 and spectral envelope manipulation without deterioration and has been used for voice conversion and singing synthesis. In particular, the spectral envelope estimated by STRAIGHT has been widely used for the statistical parametric speech synthesis. To reduce the computational cost while maintaining the sound quality, we proposed TANDEM-STRAIGHT (Kawahara et al., 2008; Kawahara and Morise, 2011) as an improved version of STRAIGHT. TANDEM-STRAIGHT made it possible to achieve the real-time application (Morise et al., 2009) and statistical analysis with a huge database.High-quality speech synthesis has recently been focused on, and several spectral envelope estimation algorithms have been proposed (Morise, 2013; Nakano and Goto, 2012) for high-quality speech synthesis. In this paper, a simple algorithm for high-quality speech synthesis is introduced that is superior to conventional ones both objectively and subjectively.The rest of this paper is organized as follows. In Section 2, we describe the problems facing the spectral envelope estimation. In Section 3, we propose a spectral envelope estimation method, named CheapTrick. In Section 4, we evaluate the proposed algorithm in objective and subjective evaluations. We conclude in Section 5 with a brief summary and a mention of future work.According to the idea of STRAIGHT, which is an improvement of Vocoder, the voiced sound contains the F0, spectral envelope, and aperiodicity information. To simplify the discussion, we only deal with the fixed F0 and spectral envelope and leave out aperiodicity. The requirement is to obtain an accurate spectral envelope from speech waveform regardless of the temporal position for windowing.Voiced soundy(t)is approximated to the convolution of an impulse responseh(t)and periodic impulses. The spectrum of the waveformY(ω)is given by(1)y(t)=h(t)∗∑n=-∞∞δ(t-nT0),(2)Y(ω)=2πT0H(ω)∑n=-∞∞δ(ω-nω0),where, symbol ∗ represents the convolution,T0represents the fundamental period, andω0represents fundamental angular frequency (=2π/T0).H(ω)is the spectral envelope that is the estimation target. This equation shows that the target is discretized by convolving the periodic impulses in the time domain. On the other hand, Eq. (2) also shows that powers atnω0Hz (n: integer value) have exact values, which a spectral envelope estimation algorithm should therefore obtain. The spectral recovery is also required for compensating for the influence of discretization. Since the power spectrum of windowed waveform depends on the temporal position of the window function, this influence (time-varying component in this paper) should also be removed.Conventional algorithms other than STRAIGHT and TANDEM-STRAIGHT cannot fulfill two requirements in the estimation performance and remove the time-varying component. This paper introduces an algorithm named CheapTrick that fulfills these requirements and is superior to conventional algorithms both objectively and subjectively. The name CheapTrick comes from its cheap and tricky design based on the conventional algorithms such as F0-adaptive windowing and the cepstrum method.CheapTrick consists of three steps: F0-adaptive windowing, smoothing of the power spectrum, and a liftering processing for smoothing and spectral recovery.The first step is designing a window function on the basis of the ideal of pitch synchronous analysis (Mathews et al., 1961). A Hanning window with a length of3T0is used in the proposed algorithm. The power of the window atω0Hz is 30dB lower than that of the main lobe (0Hz), which suggests that a harmonic structure influences the neighboring structure at below 30dB. Since the actual speech contains temporal fluctuation, aperiodicity, and noise, we assumed that 30dB was small enough.The overall power of a periodic signaly(t)windowed by the Hanning windoww(t)is calculated as follows;(3)∫03T0y(t)w(t)2dt=∫0T0y2(t)w2(t)dt+∫0T0y2(t)w2(t+T0)dt+∫0T0y2(t)w2(t+2T0)dt,=∫0T0y2(t)w2(t)+w2(t+T0)+w2(t+2T0)dt,=1.125∫0T0y2(t)dt,whereT0represents the period of the signaly(t). This equation shows that the overall power of the periodic signal windowed by the window is temporally stable.The second step is the frequency domain smoothing of the power spectrum calculated in the first step. This step is positioned as the pre-processing of the third step carried out in the quefrency domain. A logarithmic power spectrum is used for the processing in the quefrency domain, but the zero of the power spectrum indicates-∞in logarithmic power and causes a fatal error. This step is carried out to ensure that the power spectrum has no zeros. The smoothing is carried out by simple filtering with a rectangular window given by(4)Ps(ω)=32ω0∫-ω03ω03P(ω+λ)dλ,where,P(ω)represents the power spectrum calculated from the waveform windowed by the Hanning window. Since the width of the rectangular window is2ω0/3, this step ensures that the influence between the neighboring structures is below 30dB as in the first step.The third step is liftering in the quefrency domain to remove the frequency fluctuation caused by discretization. The spectral recovery is also carried out at the same time. The time-varying component is caused by convolving the periodic impulses and windowing the waveform. Since the spectrum of periodic impulses with a period ofT0is the periodic impulses with a period ofω0, its cepstrum representation is also the periodic impulses with a period ofT0in the quefrency domain. Fig. 1shows an example in the time-varying component calculated in periodic impulses. The horizontal axis represents the normalized quefrency, and the vertical axis represents the standard deviation of the time series of cepstrum. To definitely calculate the time-varying component atnT0, the sampling frequency of the signal is 65,536Hz, F0 is 128Hz, FFT length is 65,536, the length of the signal is 1s, and the length of frame shift is one sample. Fig. 1 shows that the time-varying component converges atnT0. To remove the time-varying component and to extract the low quefrency components, we employed a sinc function as the liftering that fulfills the requirements.Spectral recovery is carried out on the basis of consistent sampling (Unser, 2000). Consistent sampling theory is the expansion of sampling theory and requires that the digital signal after AD conversion must equal the digital signal after AD/DA/AD conversion. This sampling enables the design of the linear filter to fulfill this requirement. In the proposed algorithm, the liftering function is designed as the compensation filter on the basis of consistent sampling. This function can compensate for the errors atnω0Hz, which are the sampling points caused by smoothing in both the second and third steps.The spectral recovery based on consistent sampling has been carried out on the frequency domain in the TANDEM-STRAIGHT (Kawahara et al., 2008) as follows.(5)Pl(ω)=expq̃0log(P(ω))+q̃1logP(ω+ω0)P(ω-ω0),wherePl(ω)represents the output of spectral recovery processing, andP(ω)represents the power spectrum including the influence by smoothing. In this study, both the smoothing and spectral recovery were carried out in the quefrency domain. The final spectral envelopePl(ω)is given by(6)Pl(ω)=expFls(τ)lq(τ)ps(τ),(7)ls(τ)=sin(πf0τ)πf0τ,(8)lq(τ)=q̃0+2q̃1cos2πτT0,(9)ps(τ)=F-1logPs(ω),where,ls(τ)represents the liftering function for smoothing andlq(τ)represents the liftering function for spectral recovery derived from Eq. (5).q̃0andq̃1are the parameters for spectral recovery. SymbolF[]andF-1[]represent Fourier transform and its inverse transform.ls(τ)shows that the smoothing is carried out by convolving the rectangular window on the frequency domain. This window has zeros atnT0in the quefrency domain shown in Fig. 2. To determine the two parameters inlq(τ), an exploratory evaluation was carried out. The conditions were same as the following objective evaluation. As a result, 1.18 and −0.09 are obtained as the values ofq̃0andq̃1, respectively, and used in the following evaluation.Each processing is carried out on discrete time–frequency representation.Pl(k,n)discretized on both time and frequency domains is therefore used, where k represents discrete frequency index and n represents the frame number.To verify the effectiveness of the proposed algorithm (CheapTrick), both objective and subjective evaluations were carried out. The TANDEM-STRAIGHT and STAR (Morise, 2013) were used for comparison. The objective evaluation used two evaluation indexes in the estimation accuracy and time-varying component. In the subjective evaluation, a MUSHRA-based evaluation and a Thurstone’s paired comparison were carried out to demonstrate the effectiveness of the proposed algorithm in terms of sound quality of not only the re-synthesized but also the F0-manipulated speech.The index for evaluating the estimation accuracy is given by(10)Ef=1N∑n=0N-1σf(n),(11)σf2(n)=1K∑k=0K-1Pe(k,n)-1K∑l=0K-1Pe(l,n)2,(12)Pe(k,n)=10log10Pl(k,n)-10log10Pt(k),where N represents the number of frames and K represents the half value of FFT length.Pt(k)represents the target spectral envelope.Efindicates 0, provided that the estimation result equals the target.The other index for evaluating the amount of time-varying component is given by(13)Et=1K∑k=0K-1σt(k),(14)σt2(k)=1N∑n=0N-1Pe(k,n)-1N∑m=0N-1Pe(k,m)2.Etalso indicates 0, provided that the time-varying component was completely removed. The algorithm that can minimize bothEfandEtis the best one in this paper.In the experiment 1, the test signals were designed to confirm the robustness of the F0 change because the F0 of speech is time-varying. In this experiment, test signals were used that were designed using the following equation including the parameter for controlling the gradient.(15)f0(t)=fc+αfccosαfct+θ,wherefcrepresents the standard F0,θrepresents the phase, andαrepresents the parameter for controlling the gradient. In this F0 contour, the maximum gradient isαfc. We used the standard F0s of 100, 200, and 400Hz to confirm the dependency of F0;αfrom 0.0 to 36.0 was used.θfrom 0.0 to2πwas used to calculate evaluation indexes at a temporal position, and results calculated in allθwere averaged to obtain the definitive result.Since the signal for experiment is an aperiodic impulse train, the target spectrum is flat without depending on the temporal position for windowing. The sampling frequency of the signal is 48kHz, FFT length is 4096 samples, and the length of the signal is 1s. The value of the frame shift is 1ms, and the number of frames is 1000.Figs. 3 and 4illustrate the evaluation results of estimation accuracy and the time-varying component, respectively. The results show that the STAR was clearly inferior to the other algorithms in both evaluation indexes. In all results, the errors in higher F0 are smaller than those in lower F0. CheapTrick outperformed both other algorithms in estimation accuracy regardless ofαand standard F0. From the results of the time-varying component, CheapTrick was the best in the standard F0 of 100Hz. CheapTrick and TANDEM-STRAIGHT exhibited almost the same performance for other standard F0s.In experiment 2, the test signals were designed to confirm the relationship between the estimation performance and the spectral slope. The target spectral envelope has spectral slope of-βdB/oct from 100Hz.βfrom 0.0 to 10.0 was used, and Eq. (15) withαof 10 was used to generate the F0 contour.αwas set for comparing results under realistic conditions because F0 of real speech is time-varying. Since the same tendencies were observed in the experiment, a standard F0 of 100Hz was employed. Other conditions were the same as those for experiment 1.Fig. 5illustrates the relationship between the parameterβand the evaluation indexes. In the time-varying component, CheapTrick was superior to other algorithms, and it was relatively better than TANDEM-STRAIGHT, provided thatβwas above 8.5. In the estimation error, all algorithms performed almost the same, provided thatβwas above 8.5. These results suggested that the proposed algorithm was superior for estimating the spectral envelope including sharp formants.Two subjective evaluations were carried out to verify the sound quality of not only the re-synthesized but also the F0-manipulated speech. Since the F0 and the aperiodicity estimated by TANDEM-STRAIGHT are used in the evaluation, the sound quality of the speech only depends on the estimated spectral envelope. The speech used for the evaluation was of three males and three females from a DVD of a Japanese-language textbook. The sampling was 44.1kHz/16bit, and an anechoic room was used for the recording. The speech was five Japanese vowels /aiueo/ continuously uttered by all speakers and did not include consonants because all algorithms were for the spectral envelope estimation of voiced speech. In the subjective evaluations, a sound proof room with the A-weighted SPL of 16-dB was used. Ten subjects with normal hearing ability participated in both evaluations.A MUSHRA evaluation based on the ITU-R recommendation BS.1534-1 was carried out to compare the sound quality of original and re-synthesized speech. Since MUSHRA uses the 0–100 scale, subjects can rate smaller differences than when using MOS evaluation. The subjects evaluated all speech by using a GUI that displayed four kinds of stimuli (the original speech and speech synthesized with TANDEM-STRAIGHT, STAR, and CheapTrick) at the same time. Therefore, the subjects could evaluate speech uttered by the same speaker. When evaluating the four sets of speech by the GUI is defined as one set of stimuli, the number of sets is six.A Thurstone’s paired comparison was carried out by using not only the re-synthesized but also the F0-manipulated speech. In this evaluation, the subjects were instructed to select the stimulus with higher sound quality. Three types of F0 (F0, 1.25 F0, and 0.75 F0) were used to demonstrate the robustness against F0-manipulation. In the three sets of speech synthesized with the same F0, all combinations excluding the same stimulus pairs were used. The order effect is counterbalanced by using both A–B and B–A pairs. The stimulus pairs numbered 108, and all were randomized.

@&#CONCLUSIONS@&#
