@&#MAIN-TITLE@&#
An adaptive neuro-fuzzy identification model for the detection of meat spoilage

@&#HIGHLIGHTS@&#
Classification of meat samples into fresh, semi-fresh, spoiled based on FTIR spectra.Development of a neuro-fuzzy architecture.Prediction of the total viable counts in meat samples based on FTIR spectra.Evaluation made using well known performance indices.Comparison with ANFIS, MLP and PLS.

@&#KEYPHRASES@&#
Adaptive fuzzy logic system,Principal components analysis,Meat spoilage,Neural networks,Neurofuzzy systems,Partial least squares regression,

@&#ABSTRACT@&#
In food industry, safety and quality are considered important issues worldwide that are directly related to health and social progress. To address the rapid and non-destructive detection of meat spoilage microorganisms during aerobic storage at chill and abuse temperatures, Fourier transform infrared (FTIR) spectroscopy with the aid of a neuro-fuzzy identification model has been considered in this research. FTIR spectra were obtained from the surface of beef samples, while microbiological analysis determined the total viable count for each sample. The dual purpose of the proposed modelling approach is not only to classify beef samples in the respective quality class (i.e. fresh, semi-fresh and spoiled), but also to predict their associated microbiological population directly from FTIR spectra. The proposed model utilises a prototype defuzzification scheme, whereas the number of input membership functions is directly associated to the number of rules, reducing thus, the curse of dimensionality problem. Results confirmed the advantage of the proposed scheme against the adaptive neuro-fuzzy inference system (ANFIS), in terms of prediction accuracy and structure simplicity. Subsequent comparison against multilayer perceptron (MLP) and partial least squares technique indicated that FTIR spectral information in combination with the proposed modelling scheme could be considered as an alternative methodology for the accurate evaluation of meat spoilage.

@&#INTRODUCTION@&#
In the past few decades, meat industry has enormously thrived, as demands for better food quality continues to grow on both international and domestic markets [1]. Interests in meat quality are driven by the need to supply the consumer with a consistent high quality product at an affordable price [2]. To realise such need, it is a crucial element within the meat industry to accurately assess meat quality attributes by improving modern techniques for quality evaluation [3]. Beef is one of the commercially viable and widely consumed muscle foods throughout the world. Although it is a good food source for proteins and other essential nutrients, it is also an ideal substrate for the growth of both spoilage and pathogenic microorganisms. Spoilage occurs when the formation of off-flavours, off-odours, discoloration, or any other changes in physical appearance or chemical characteristics make the food unacceptable to the consumer. Changes in muscle food characteristics are due to native or microbial enzymatic activity or to other chemical reactions. The current practice to assure the safety of meat still relies on regulatory inspection and sampling regimes. This approach, however, seems inadequate because it cannot sufficiently guarantee consumer protection, since 100% inspection and sampling is technically, financially and logistically impossible. Additionally, although more than 50 chemical, physical and microbiological methods have been proposed for the detection and measurement of bacterial safety or spoilage in meat, most of them are time-consuming and provide retrospective information [4].Meat industry however needs rapid analytical methods for quantification of these indicators in order to determine suitable processing procedures for their raw material and to predict the remaining shelf life of their products [5]. The development of non-destructive sensing technologies to detect spoilage bacteria as well as pathogenic bacteria with a high degree of dependency in food products is very desirable. Various rapid, non-invasive methods based on analytical instrumental techniques, such as Fourier transform infrared spectroscopy (FTIR) [6], Raman spectroscopy [7], and Electronic nose technology [8] have been researched for their potential in assessing meat quality. The “mechanism” of these approaches is based on the assumption that the metabolic activity of micro-organisms on meat results in biochemical changes, with the simultaneous formation of metabolic by-products, which may contribute to the spoilage phenomenon. The quantification of these metabolic activities corresponds to a unique “signature”, providing thus information about the type and rate of spoilage [9].The huge amount of information provided by spectral data requires an advanced data analysis approach. This has been achieved through the integration of modern analytical platforms with computational and chemometric techniques [10]. Multivariate statistical analyses (e.g., partial least square (PLS) regression, discriminant function analysis (DFA), cluster analysis) have resulted in the development of decision support systems for timely determination of safety/quality of meat products [11]. Considering that microbial meat spoilage is a complex process which involves growth of microorganisms during storage, their spectra contain highly non-linear characteristics. Hence, linear-based techniques might not provide a complete solution to such complex identification/classification problem [12]. Neural networks (NNs) have gained much interest in predictive engineering and quantitative modelling due to their flexibility and high accuracy as compared to other modelling techniques (e.g., statistical models). In comparison to other NN-based application areas, the field of food science is still in an early development stage. Recently, advanced NN algorithms have shown promising results in applications such as growth parameter estimation of microorganisms [13]. NNs usually require a large number of neurons for solving the majority of approximation problems and are prone to dimensionality problems, as each single neuron-node cannot define a multi-dimensional hyper-sphere of the input domain. Although fuzzy logic systems, provide such input space mapping, they do not have learning ability, thus it is difficult to analyse complex systems without prior and accurate knowledge on the system being analysed [14].To overcome the limitations of NNs and fuzzy systems, neuro-fuzzy approaches have attracted growing interest of researchers in various scientific and engineering areas. The main objective of this paper is to associate FTIR spectral data with beef spoilage, by utilising a neuro-fuzzy identification model. The proposed “Adaptive Fuzzy Logic System” (AFLS) model includes a prototype defuzzification scheme, while differs from conventional fuzzy rule-table approaches that utilise the “look-up table” concept. In those models, an input space is divided into K1×K2×⋯×Knfuzzy subspaces, where Ki, i=1,2,…, n is the number of fuzzy subsets for the ith input variable [15]. As one fuzzy rule is normally assigned for each one of these subspaces, their main drawback is that the number of fuzzy rules increases exponentially with respect to the number of inputs n. The Adaptive Neuro-Fuzzy Inference System (ANFIS) is a classical example of such approach, where the number of fuzzy rules is related to the number of input variables as well as the number of membership functions for each input. In the case of AFLS, the number of memberships for each input variable is directly associated to the number of rules, hence, the “curse of dimensionality” problem is significantly reduced.Datasets related to FTIR spectra and the correlated microbiological analysis (i.e. total viable counts – TVC) from beef fillets, were provided to the first author by Agricultural University of Athens, Greece, in the framework of the “Symbiosis-EU” European research project [16]. Fresh beef fillets were packaged under aerobic conditions and left to spoil at (0, 5, 10, 15, 20°C), for up to 350h. FTIR spectra were collected directly from the surface of meat samples, whereas TVCs of bacteria were obtained via standard plating methods. Sensory evaluation was performed during storage and samples were attributed into three quality classes, namely fresh, semi-fresh, and spoiled [17]. Due to the nature of FTIR spectral data, the use of principal components analysis (PCA) in reducing the level of input dimensionality with the minimum information lost is required. The proposed AFLS model has been utilised to simultaneously classify beef samples to one of three quality classes, based on their biochemical profile provided by the FTIR spectrometer and predict TVCs on meat surface. Results from AFLS scheme are compared against models based on ANFIS, multilayer neural networks (MLP), and PLS. Such comparison is considered as an essential practice, as we have to emphasise the need of induction to the area of food microbiology, advanced learning-based modelling schemes, which may have a significant potential for the rapid and accurate assessment of meat spoilage. Such an accurate assessment prediction could allow a more efficient management of products in the food chain.FTIR spectroscopy has been used extensively by chemists to identify compounds in a wide variety of applied fields. This motivation is justified from the fact that FTIR is a rapid, inexpensive and sensitive technology that rapidly allows real-time measurements at all stages of production without requiring special skills from users. Moreover, it has been recognised as a powerful tool when coupled to chemometric techniques, and is widely utilised for rapid quality control of numerous foodstuffs since it provides information from complex spectra about the composition of food components. In fact, for any individual sample, FTIR spectroscopy provides information on fundamental vibration and stretching of molecules exhibited under infrared light in the spectral region between 4000 and 700cm−1. It provides a characteristic spectrum that is the result of absorption by various chemical constituents, providing thus a “fingerprint” of each sample [18].Over the last few years, FTIR has been considered as a very important tool in food analysis including authenticity and adulteration. Nutrient determination is time consuming and not appropriate for routine application in the food industries. FTIR was able to determine omega-6 and omega-3 fatty acids in pork adipose tissue [19]. It has been used to investigate the influence of heating rates and different heating temperatures on protein denaturation in beef [20], as well as to study the influence of ageing and salting on uncooked and cooked pork [21]. In addition, it has been considered as a fast and non-destructive technique for the detection and quantification of pork in beef meatball formulation for Halal verification purposes. The spectral bands associated with pork fat (PF), beef fat (BF), and their mixtures in meatball formulation, were scanned, interpreted, and identified by relating them to those spectroscopically representative to pure PF and BF [22]. The quality of oil, an essential ingredient of the food processing industry has also been investigated through the use of FTIR for the accurate quantification of the moisture in edible oils [23]. Although, the vast majority of FTIR-based applications for classification and quantification purposes utilise liquid and solid phase samples, very few applications based on gaseous phase samples have been reported. A FTIR spectroscopy-based olfactory sensing system has been investigated in sensing the volatiles collected from the headspace of a meat package for the detection of pathogen contamination (Salmonella typhimurium) in the packed meat [24].The application of chemometric techniques to associate FTIR spectral data with meat spoilage is not new and it has been tackled in the past [25]. In that approach, emphasis was given only to the detection of bacterial spoilage, in terms of microbiological analysis, whereas no attempt was made to associate spectral data with quality classes defined by sensory assessment of the samples. FTIR spectral data collected directly from the surface of meat had been verified that they could be used as biochemical interpretable “signatures”, in an attempt to obtain information on early stage detection of microbial spoilage of chicken breast and rump steaks [26]. An MLP-based NN has been also explored in an attempt to correlate spectral data from FTIR spectroscopy analysis with beef spoilage and its associated total viable bacteria counts-TVC [17]. A rapid and non-destructive determination of pork storage time associated with its freshness has been considered with the aid of FTIR and MLP networks [27], while the spoilage of fresh minced pork was examined through the use of FTIR and PLS models [28]. Recently, the potential of mid infrared spectroscopy to determine microorganisms’ spoilage on the surface of chicken breast fillets has been explored. PLS regression was carried out to predict TVCs, Pseudomonas, Enterobacteriaceae and Brochothrix thermosphacta microbial counts from related spectral data [29].The FTIR experimental case was performed at the Laboratory of Microbiology and Biotechnology of Foods, at the Agricultural University of Athens, Greece. A detailed description of the experimental methodology, as well as the related microbiological analysis of the meat samples, is described in [17]. Briefly, the samples were prepared by cutting fresh pieces of beef into small portions (40mm wide×50mm long×10mm thick) and then portions placed onto Petri dishes and stored at (0, 5, 10, 15 and 20°C) in high-precision incubation chambers for a total period of 350h, taking into consideration the storage temperature, until spoilage was apparent [16].For the purposes of FTIR spectral measurements, a thin slice of the aerobic upper surface of the beef fillet was isolated and used for additional analysis. In total, 74 FTIR spectra were produced through the use of a using a ZnSe 45° ATR (Attenuated Total Reflectance) crystal on a Nicolet 6700 FTIR Spectrometer. Spectra collected over the specific wave-number range 1800–1000cm−1, which is considered as the area where spoilage signals are expected to be detected [17]. Typical FTIR spectral data collected from fresh and spoiled beef fillet samples stored at 10°C for 6 days are shown in Fig. 1. Different colours represent samples collected at various sampling times. For example, sample 10F2 has been collected after 8h storage, while 10F18 is associated with a sample with storage of 148h. Two curves associated to F1a and F1b are considered as measurements that correspond to the initialisation of the FTIR procedure, at t=0s [16]. Comparison of those FTIR spectra can reveal knowledge on particular biochemical changes taking place during beef spoilage, at various temperatures. For example, the highest peak 1640cm−1 is due to the presence of moisture with an essential contribution from amide I in the beef sample. The second peak at 1550cm−1 is due to the absorbance of amide II, while peaks at 1460, 1240,and 1175cm–1 can be credited to fat. These FTIR spectra were initially subjected to smoothing according to the Savitzky–Golay algorithm [17].In parallel, microbiological analysis was performed, and resulting growth data from plate counts were log10 transformed and fitted to the primary model of Baranyi & Roberts [30] in order to verify the kinetic parameters of microbial growth (maximum specific growth rate and lag phase duration). The growth curves of total viable counts (TVC) for beef fillet storage at different temperatures under aerobic conditions are illustrated in Fig. 2.Analysis specified that the total microflora (TVC) ranged from 2.9–3.3log10cfucm−2 at the beginning of storage (fresh samples), to 8.7–9.4log10cfucm−2 for samples characterised as spoiled [17]. This finding is consistent with an indication that the population threshold that depicts the shift of a sample from fresh to semi-fresh and then from semi-fresh to spoiled is temperature dependant. Additionally, sensory evaluation of meat samples was performed during storage, based on the perception of colour and smell before and after cooking. Each sensory attribute was assigned to a three-point scale corresponding to: 1=fresh; 2=semi-fresh; and 3=spoiled. In total, 74 meat samples were evaluated by a sensory panel and classified into the selected three groups as fresh (n=24), semi-fresh (n=16), and spoiled (n=34) [16].A principal component analysis (PCA) has been applied on those FTIR spectral data used for training purposes. This choice was initiated mainly by two reasons. The original FTIR spectral data is considered as a high-dimensional problem, thus it could be prohibited for utilising a learning-based model (i.e. excessive number of input variables). Secondly, the strong correlation among the FTIR variables (i.e. wave-numbers), would deteriorate seriously the modelling procedure. PCA scheme was implemented in MATLAB, with the aid of PLS_Toolbox (ver. 7.5, Eigenvector.com). For this particular experimental case study, although the total variance (100%) of the dataset was explained by 34 principal components (PCs), only the first five PCs were associated with the 98.25% of the total variance, as shown in Table 1. The variability (%) of the first three PCs is dominant to the overall contribution and this is also illustrated from a visualisation of the first three orthonormal principal component coefficients for each variable, and the principal component scores for each observation in a single plot, as shown at Fig. 3.Thus, the first five principal components from the PCA scheme were extracted and utilised as inputs to the various simulation models developed for this specific case study.With the continuously growing demand for models for complex systems inherently associated with nonlinearity, high-order dynamics and imprecise measurements, there is need for a relevant modelling environment. During the last decade, neuro-fuzzy network (NF) approaches have gained considerable interest for solving real world problems, including modelling of highly complex systems and pattern recognition. Extensive experimentation has demonstrated that the class of feed-forward NF systems exhibits significant advantages compared to the NN models [31]. NNs are well-known to act as global models, where training is performed on the entire pattern range. In contrast, owing to the partition of the input space, NF models perform a fuzzy blending of local models in space. As a result, faster convergence is achieved during learning for a specific task. Additionally, by utilising learning-based training algorithms for the tuning of fuzzy logic parameters, the efficiency of function approximation can be largely improved. Examples of NF systems as modelling structures include schemes such as ANFIS, Fuzzy RBF, and Fuzzy Adaptive learning Control Network (FALCON) [14].A fuzzy logic system (FLS) is a system that utilises fuzzy set theory and its operations to solve a given problem. A specific type of FLS with fuzzifier and defuzzifier components is used throughout this study. Various methods have been used in defuzzification section, such as “centre average”, “centroid of area”, etc. The “centroid of area” approach is an optimal answer to defuzzification because it uses all available information to compute the output. One major problem, however, with the centroid defuzzifier is its intensive computation. The “centre average” (CA) defuzzifier, on the other hand, is more efficient in terms of implementation. Its main disadvantage is that it suffers from not utilising the entire shape of the consequent membership function. The output of a CA defuzzifier is still the same, regardless of whether the shape is narrow or wide [32]. In general, an adaptive fuzzy logic system is a FLS where its rules are derived and extracted from given training data. Since we have general ideas about the structure and effect of each rule, it is straightforward to effectively initialise each rule. This is a tremendous advantage of AFLS over its NN counterpart. The “centroid” defuzzifier however cannot be used also due to the presence of gradient-descent learning algorithm.The proposed AFLS scheme consists of an alternative defuzzification approach, the area of balance (AOB), and its structure is shown in Fig. 4[33]. In this architecture, the fuzzy basis layer consists of fuzzy basis nodes for each rule. A fuzzy basis node has the following form:(1)φm(x¯)=μm(x¯)∑l=1Lμl(x¯)whereφm(x¯)is a fuzzy basis node for rule m andμm(x¯)is a membership value of rule m. Since a product-inference is utilised, the fuzzy basis nodeμm(x¯)is in the following form:(2)μm(x¯)=∏i=1nμFim(xi).whereμFim(xi)is the membership value of the ith input of rule m. In the proposed scheme, a “Gaussian-shape” membership function has been employed, thusμFim(xi)has the following form:(3)μFiim(xi)=exp−(xi−cim)22(bim)2.wherecimandbimare the centre and spread parameters of the membership function ith input of the mth rule. The “centroid of area” defuzzification method returns the centroid of the area formed by the consequent membership function, the membership value of its rules and the max–min or max–product inference. In the case of a discrete universe, the centroid calculation yields(4)y=∑q=1Qμy(ybq)ybq∑q=1Qμy(ybq)where Q is a number of quantisation levels of the output. The higher Q is the finer y will be. The computational cost increases analogous to Q. However, since the method provides good performance, its main characteristics, such as centre of gravity and use of the shape of membership function, have been adopted in the design of the proposed defuzzification approach.AFLS's overall output utilises Kosko's method with product inference [34]. The proposed defuzzification method can be explained by the following mass-less beam example. Let us consider the density (D), which is defined as mass (M) per unit volume (V).(5)D=MVUnder the assumption that we use the same material and all shapes have the same thickness, T, then(6)M=ATDwhere A is an area and T is a thickness. Let us assume for simplicity, that the shape of the membership function used in the consequent part has a symmetric triangular form.The centre of gravity will pass through the halfway point of the base of that shape. For example, if we use a triangular shape and product-inference as a t-norm, then the shape of the consequent part of rule m will be shown as in Fig. 5. If we could consider the consequent part of each rule placed on the massless beam having the pivot point at origin, then such visualisation is shown in Fig. 6.Then,(7)F=M1g+M2g+M3g=(M1+M2+M3)gFor balance(8)Fy=M1gyb1+M2gyb2+M3gyb3=(M1yb1+M2yb2+M3yb3)g(9)y=(M1yb1+M2yb2+M3yb3)gF=(M1yb1+M2yb2+M3yb3)g(M1+M2+M3)gAssume that D in Eq. (6) is the same, thus,(10)y=(A1yb1+A2yb2+A3yb3)TD(A1+A2+A3)TD=(A1yb1+A2yb2+A3yb3)(A1+A2+A3)The calculation of area A will be depended upon the type of membership function used. Under the assumption of symmetric shape, this method will have comparable capability with the centroid calculation method to approximate the output from the fuzzy set in the consequent part.By utilising the triangle shape as a membership function and the usage of max-product inference (i.e. Larsen logic), the shaded area A will be derived as:(11)Am=12μmLmDeriving from Eq. (10), the output, y will be(12)y=μ1L1yb1+μ2L2yb2+μ3L3yb3μ1L1+μ2L2+μ3L3In general form, the calculation of the output, y will be(13)yp=∑m=1MμmLpmypm∑m=1MμmLpmwhere yp: the pth output of the network; μm: the membership value of the mth rule;Lpm: the spread parameter of the membership function in the consequent part of the pth output of the mth rule;ypm: the centre of the membership function in the consequent part of the pth output of the mth rule.The learning algorithm of AFLS involves the use of the back propagation/gradient descent (BP/GD) method to identify the various parameters. During, the backward “training” pass, the error signals are calculating recursively from the output layer backward to the hidden (i.e. rules) layer, and parameters at defuzzification and fuzzification parts are fine-tuned. The objective function for training is defined as:(14)J=∑k=1KJkwhere K is the number of training patterns and Jkis the sum of squared error for the kth pattern. Then, Jkis defined as:(15)Jk=12∑p=1P(yp(x¯k)−dp(x¯k))2where P is the number of outputs and dpis the desired response of the pth output. Variableyp(x¯k)is defined as in Eq. (13). The update equation ofypmis as in the form:(16)ypm(n+1)=ypm(n)+my[ypm(n)−ypm(n−1)]−ηy∂J∂ypm|nwhere(17)∂J∂ypm=∂J∂Jm∂Jm∂ep∂ep∂yp∂yp∂ypm(18)=∑k=1K(ypk−dpk)μmkLpm∑m=1MμmkLpmwhereypkis the pth output of the network corresponding to the kth pattern in the training data,dpkis the pth desired output of the kth pattern andμmkis the membership value of the mth rule corresponding to the kth pattern in the training data. The update equation ofLpmis in the following form:(19)Lpm(n+1)=Lpm(n)+mL[Lpm(n)−Lpm(n−1)]−ηL∂J∂Lpm|nwhere(20)∂J∂Lpm=∂J∂Jm∂Jm∂ep∂ep∂yp∂yp∂Lpm(21)∂J∂Lpm=∑k=1K(ypk−dpk)μmk∑m=1MμmkLpm{ypm−ypk}whereypmis interpreted as a centre of the membership function of the pth output of the mth rule in the consequent part of IF–THEN rule. The update equation of the centre parametercimis in the form:(22)cim(n+1)=cim(n)+mc[cim(n)−cim(n−1)]−ηc∂J∂cim|nwhere(23)∂J∂cim=∂J∂Jm∂Jm∂ep∂ep∂yp∂yp∂μm∂μm∂μFim∂μFim∂cim+⋯As, a Gaussian-based membership function has been adopted, then(24)∂μFim∂cim=μFim(xik−cim)bim2and(25)∂μm∂μFim=∏j=1j≠inμFijThus,(26)∂J∂cim=∑k=1K∑p=1P(ypk−dpk)Lpm[ypm−ypk]∑m=1MμmkLpmμmk(xik−cim)bim2The update equation of the spread parameterbimis in the form:(27)bim(n+1)=bim(n)+mb[bim(n)−bim(n−1)]−ηb∂J∂bim|nwhere(28)∂J∂bim=∂J∂Jm∂Jm∂ep∂ep∂yp∂yp∂μm∂μm∂μFim∂μFim∂bim+⋯Again for the Gaussian-based function,(29)∂μFim∂bim=μFim(xik−cim)2bim3Therefore,(30)∂J∂bim=∑k=1K∑p=1P(ypk−dpk)Lpm[ypm−ypk]∑m=1MμmkLpmμmk(xik−cim)2bim3All equations derived are used to update all parameters during the training phase of the network. The initial centre,cimandypmare randomly selected from the kth training data,xikanddpkrespectively. The initial spread parameter,bim, is determined by(31)bi=max(xi)−min(xi)Nwhere biis a spread parameter of the ith input of all rules and N is the number of rules. The initial spread parameter,Lpm, has been set to 0.75 and is adjusted during training.A machine learning approach, based on the proposed AFLS model, has been adopted in order to create a decision support system acting in parallel as an efficient classifier, in an effort to classify meat samples in three quality classes (fresh, semi-fresh, spoiled), as well as a prediction system. The real challenge in this paper is to propose a new learning-based structure which could be considered as a benchmark method towards the development of efficient intelligent methods in food quality analysis. For this reason, produced results are compared against the PLS technique, which is considered as well-recognised tool in chemometric analysis. In addition, AFLS's prediction results are compared with those obtained by MLP networks and adaptive neuro-fuzzy inference system (ANFIS) identification models. Such schemes have become popular modelling techniques in food science and technology in recent years [35]. These approaches are effective and versatile techniques for the identification and modelling of some parameters especially in nonlinear systems. They can be used efficiently to solve problems and to predict parameters in the absence of accurate mathematical models. The final dataset, consisted of 74 beef patterns, include information from the various storage temperatures, the first five PCs and the sampling times.In this research study, two distinct procedures have been considered. In the first procedure, as the number of observations/samples is small, the separation of the dataset into training and testing subsets (hold-out method) was considered that it would further reduce the number of data and would result in insufficient training of the network. Therefore, in order to improve the robustness of identification process, the leave-1-out cross validation technique was employed to evaluate the performance of the developed AFLS model.The AFLS concept has been developed with the aim to be a more effective modelling tool against to classic MLP and ANFIS structures. Its structure, as shown from Fig. 4, consists of an input layer which in this current research study contains seven input nodes (i.e. storage temperature, sampling time, and the values of the five principal components). The second layer is related to the inference engine (i.e. the fuzzy rules). After many trials, it has been found that only 12 rules are necessary for the proposed AFLS model to achieve an acceptable performance for this particular case/experiment. The number of membership functions for each input variable is directly associated to the number of rules, hence, each input signal is “distributed” through Gaussian functions with different centres and widths to every rule node via a product operator. The values of the parameters (centres and widths) of the Gaussian membership functions have been adjusted by the learning procedure. The output layer consists of two nodes, corresponding to the predicted quality class (fresh, semi-fresh, spoiled) of meat samples and the total viable counts (TVC), respectively. As both output parameters are dependent, in the sense that quality class is related to microbiological counts and vice versa, a model that combines both these measurements have been considered to be desirable. In order to accommodate both classification and modelling tasks in the same model-structure, the classification task has been modified accordingly.Rather than trying to create a distinct classifier, an attempt has been made to “model” the classes [33]. Initially, values of 10, 20 and 30, have been used respectively, to associate the three classes with a cluster centre. During the identification process, output values of [5, 15] were associated to “fresh” class with cluster centre 10, values of [15.01, 25] were associated to “semi-fresh” class with cluster centre 20, and finally values of [25.01, 35] were associated to “spoiled” class with cluster centre 30. The second output node has been assigned to the total viable counts (TVC).The classification accuracy of the AFLS network was determined by the number of correctly classified samples in each sensory class divided by the total number of samples in the class. The performance of the model in the prediction of TVC for each meat sample was determined by the bias (Bf) and accuracy (Af) factors, the mean relative percentage residual (MRPE) and the mean absolute percentage residual (MAPR), and finally by the root mean squared error (RMSE) and the standard error of prediction (SEP) [36]. Results revealed that the classification accuracy of the AFLS model was very satisfactory in the characterisation of beef samples, indicating the advantage of a neurofuzzy approach in tackling complex, nonlinear problems, such as meat spoilage. The classification accuracy obtained from AFLS, is presented in the form of a confusion matrix in Table 2.The model overall achieved a 95.94% correct classification, and 95.83%, 87.5% and 100% for fresh, semi-fresh and spoiled meat samples, respectively. The sensitivities (i.e. how good the network is at identifying correctly the positive samples) for fresh and spoiled meat samples reveal one (even marginally) out of 24 fresh meat samples, and zero misclassifications out of 34 spoiled samples. One spoiled meat sample was accurately classified as spoiled, even marginally. In the case of semi-fresh samples, two samples out of 16 were misclassified, as fresh ones. The specificity index (i.e. how good the network is at identifying correctly the negative samples) was also high, indicating satisfactory discrimination between these three classes (Table 2). It is characteristic that no fresh samples were misclassified as spoiled and vice versa, indicating that the biochemical information provided by FTIR data could discriminate these two classes accurately. Lower percentages were obtained for semi-fresh samples (ca. 87.5%) with incorrect classifications in the fresh class. It must be emphasised however that the number of examined samples within each class was not equally distributed, due to the different spoilage rate of beef samples at the different temperatures. The lower accuracies obtained in the semi-fresh class could be also attributed to the performance of the sensory evaluation process, as the difference between “fresh” and “semi-fresh” class is not very obvious sometimes.The common measure of goodness-of-fit for model comparison in food microbiology is performed by calculating the squared correlation coefficient (R2) [37]. The index R2(0≤R2≤1) is often used as an overall measure of the prediction attained. It measures the fraction of the variation about the mean that is explained by a model. The higher the value, the better is the prediction by the model. AFLS's overall value of 0.98% for the index R2 indicates a very good fit of the experimental data from the AFLS-based approach. The individual R2 values for fresh, semi-fresh and spoiled cases were 0.923%, 0.95% and 0.93% respectively. However, R2 is a criterion for model comparison on the assumption that the error is normally distributed and not dependent on the mean value; In fact, the distribution of the error is not clearly known in the case of microbial/bacteria growth, so this term must be used with caution, particularly in non-linear regression models and hence additional indices must be employed for model comparison [38].The plot of predicted versus observed total viable counts is illustrated in Fig. 7a, and shows a very good distribution around the line of equity (y=x), with all the data included within the ±1 log unit area. However, a few samples were placed near the borderline of the ±1 log unit area, as shown at Fig. 7a. These include the spoiled “5F9”, the semi-fresh “0F8” and the fresh “20F6” samples. “5F9” sample corresponds to a beef sample stored at 5°C and collected after 192h of storage, “0F8” corresponds to a beef sample stored at 0°C and collected after 168h of storage and finally “20F6” corresponds to a beef sample stored at 20°C and collected after 22h of storage. The performance of the AFLS model is also presented in Fig. 7b, where the % relative error of prediction is illustrated against the observed microbial population. Based on this plot, data was almost equally distributed above and below 0, with all (expect one) predicted microbial counts included within the ±20% RE zone. That particular microbial count is associated with the fresh “0F4” sample, which corresponds to a beef fillet, stored at 0°C and collected after 72h of storage. Fig. 2 reveals the reason for such behaviour. The “0F4” sample is the third sample at the 0°C growth curve. An inspection at the shape of that curve illustrates a deep drop after the first two samples, while the curve is increasing throughout subsequent sampling time. A possible way to overcome this problem could be to broaden the training dataset, especially for low temperatures. The performance of the AFLS model to predict TVCs in beef samples in terms of statistical indices is presented in Table 3.The RMSE values of the AFLS were very low for all samples, with an overall indicator of 0.373. This index is calculated between the desired and output values and then averaged across all data. It can be used as an estimation of the goodness of fit of the models. It can also provide information about how consistent the model would be in the long run [38]. The related RMSE values for the proposed scheme are very low, as shown in Table 3, indicating the ability of AFLS to make better prediction on data for which there was no previous training. Bias factor (Bf) is a multiplicative factor that compares model predictions and is used to determine whether the model over- or under-predicts the response time of bacterial growth. A Bfgreater than 1.0 indicates that a growth model is fail-dangerous. Equally, a Bfless than 1.0 generally indicates that a growth model is fail-safe (i.e. observed generation times were larger than predicted values), so that predicted values give a margin of safety. Perfect agreement between predictions and observations would lead to Bfof 1. Based on the calculated values of the bias factor Bf, it can be concluded that the AFLS model over-estimated total viable counts in semi-fresh samples (Bf>1), whereas for fresh samples under-estimation of microbial population was evident (Bf<1) and almost perfect for spoiled samples (1.008). The accuracy factor Afis a simple multiplicative factor that indicates the spread of results about the prediction. A value of one indicates that there is perfect agreement between all the predicted and measured values. In our case, the values of the accuracy factor Afindicated that the predicted total viable counts were 7.37%, 6.26%, and 3.74% different from the observed values for fresh, semi-fresh, and spoiled meat samples, respectively. Regarding the appropriate values of the accuracy factor Af, it has been reported [38] that an increase of 0.15 (15%) would be acceptable for each independent variable included in model development. Therefore, in our study, with only one independent variable (i.e. temperature), any value of Afup to 1.15, could be considered to be satisfactory. The mean relative percentage residual index (MRPR) similarly verified the over-prediction for semi-fresh and spoiled samples (MRPR<0) and under-prediction for fresh samples (MRPR>0), whereas the values of mean absolute percentage residual (MAPR), representing the average deviation between observed and predicted counts, verified the information provided by the accuracy factor. Finally, the standard error of prediction (SEP) index is a relative typical deviation of the mean prediction values and expresses the expected average error associated with future predictions. It has the advantage of being independent on the magnitude of the measurements [38]. The lower the value of this index is, the better the capability of the model to predict microbial counts in new meat samples. The value of the index was 5.67% for the overall samples indicating good performance of the network for microbial count predictions in this class (Table 3), with also very low values (4.4%) for spoiled samples. However in the case of fresh samples, the index gave higher values (i.e. 8.58%) as the network under-estimated microbial counts for some fresh beef samples.Although AFLS identification model utilises the gradient descent learning method for training, its main advantage is related to its MIMO structure capability. The majority of existing neuro-fuzzy schemes follow the classic Takagi–Sugeno–Kang (TSK) structure, where only one output is enabled. TSK models consist of IF–THEN rules with fuzzy antecedents and mathematical functions in the consequent part. The fuzzy sets partition the input space into a number of fuzzy regions, while the consequent functions describe the system's behaviour in these regions. ANFIS is a classic representative of TSK-based neuro-fuzzy systems [39]. By analysing mapping relationships between input and output data, ANFIS optimises the distribution of membership functions by using a gradient descent algorithm either alone or combined with a least-squares method. The ANFIS uses fuzzy if–then rules involving premise and consequent parts of a TSK-type fuzzy inference system. The five-layer system ANFIS architecture includes a fuzzification layer (Layer 1), a production layer (Layer 2), a normalisation layer (Layer 3), a de-fuzzification layer (Layer 4), and a total output layer (Layer 5) [40].In addition to AFLS, in this research work, an ANFIS model has been developed to predict TVCs. The same leave-1-out cross validation technique, as well as the same training dataset have been utilised also for this case. Under these conditions, ANFIS performed very satisfactory, its performance however was achieved with a high computational cost, by utilising two membership functions for each input variables and 128 fuzzy rules.The related plot of the predicted versus the observed TVCs, as shown in Fig. 8a, reveals a good distribution around the line of equity, with the majority of data (ca. 98.65%) included within the ±1 log unit area. Four samples were in the border-line of the ±1 log unit area, while one sample (semi-fresh) was placed outside that unit area. More specifically, the semi-fresh “10F7” sample was clearly outside the ±1 log unit area. “10F7” corresponds to a beef sample stored at 10°C and collected after 52h of storage. Spoiled samples, “10F12”, “20F11” and fresh samples “0F6”, “0F5” were placed very close to the borderline. “10F12” sample corresponds to a beef sample stored at 10°C and collected after 90h of storage, while “20F11” corresponds to a beef sample stored at 20°C and collected after 44h of storage. Similarly, 0F6″ sample corresponds to a beef sample stored at 0°C and collected after 120h of storage, while “0F5” corresponds to a beef sample stored at 0°C and collected after 96h of storage. The performance of the ANFIS model is also presented in Fig. 8b, where the % relative error of prediction is illustrated against the observed microbial population. Based on this plot, data was almost equally distributed above and below 0, with all (expect two) predicted microbial counts included within the ±20% RE zone. These particular microbial counts are associated with the fresh “0F5” and “0F6” samples. The performance of the ANFIS model in predicting TVC in meat samples in terms of statistical indices is presented in Table 4.An MLP network has been also implemented using the same FTIR dataset and employing the leave-1-out validation method. After a few trials, the MLP was constructed with two hidden layers (with 12 and 6 nodes respectively) and two output nodes, one for the sensory class and one for the TVCs. The classification accuracy obtained from MLP, is presented in the form of a confusion matrix in Table 5.The model overall achieved a 90.54% correct classification, with 87.5%, 81.25% and 97.06% for fresh, semi-fresh and spoiled meat samples, respectively. The related sensitivities represent 3 misclassifications out of 24 fresh meat samples, and one misclassification out of 34 spoiled samples. In the case of semi-fresh samples the respective figure was somehow lower (81.25%). In this case, 3 samples were misclassified (out of 16), two as fresh and one as spoiled cases.The related plot of the predicted versus the observed TVCs, as shown in Fig. 9a, reveals a reasonable good distribution around the line of equity without any particular trend, with the majority of data (ca. 90.54%) included within the ±1 log unit area. Three samples were in the border-line of the ±1 log unit area, while four samples (3 spoiled and one semi-fresh) were placed outside that unit area. A more comprehensive picture of the prediction performance of the MLP is given in Fig. 9b where the % relative error of prediction is depicted against the observed microbial population. Based on this plot, approximately 91.89% of predicted microbial counts included within the ±20% RE zone. The performance of the MLP network in predicting TVC in meat samples in terms of statistical indices is presented in Table 6. An MLP implementation of the same FTIR dataset has been considered recently, however with a much simpler structure [17]. More specifically, an MLP with one hidden layer (with 10 nodes) and two outputs managed to perform the same task, however with worse results. The overall RMSE was 0.850, while the overall SEP was increased to 12.94%. It is well known that a two-hidden MLP structure enjoys a better performance against its single-hidden MLP counterpart, and such results simply proved that concept.Although both AFLS and MLP share the same learning training algorithm, i.e. the gradient descent method, the different “philosophy” in building the neurofuzzy architecture, allowed AFLS to achieve such superior performance. In MLP models, all normalised inputs are fed to the hidden layer, while in the case of AFLS, each input is fuzzified/decomposed through Gaussians membership functions. As the number of these membership functions is equal to the numbers of rules, this architecture has advantages over the classic ANFIS neurofuzzy model. The increased number of Gaussian membership functions increases the localisation of the input signal while in the same time maintains the required number of rules at low level. This localisation spread through the membership functions, is one advantage against the classic MLP structure. The proposed defuzzification scheme improves also the final output, against a simple sigmoid function as it is the case for MLP. All modelling schemes have been implemented in MATLAB (ver. R2012a, Mathworks.com).Partial least squares (PLS) regression approaches, similarly to NNs, have the ability to relate the input and output variables without having any pre-knowledge on physics of the system provided an accurate and adequate amount of data on the system variables is available [40]. The PLS method is a linear multivariate regression method that projects the input–output data down in to a latent space, extracting a number of principal factors with an orthogonal structure, while capturing most of the variance in the original data. PLS derives its usefulness from its ability to analyse data with strongly collinear, noisy and numerous variables in the predictor matrix X and response Y. The PLS model was constructed using the same input vector as in the cases of AFLS, ANFIS and MLP, and the PLS_Toolbox software (ver. 7.5, Eigenvector.com) in association with MATLAB was used to perform the PLS analysis. The nonlinear iterative partial least squares algorithm (NIPALS) has been chosen as the appropriate learning scheme. The related plot of the predicted versus the observed TVCs, as shown in Fig. 10, reveals a satisfactory, but inferior to MLP and AFLS, distribution around the line of equity without any particular trend, with the majority of data (ca. 67.56%) included within the ±1 log unit area. The performance of the PLS regression model in predicting TVC in meat samples in terms of statistical indices is presented in Table 7.Although in general, PLS results are worse than those from MLP, special attention should be paid to the cases of fresh samples. Both SEP and Accuracy Factor indicators are very extremely high and such behaviour could be explained by an inspection at Fig. 10. Four fresh samples, “15F2”, “20F4”, “20F2” and “20F3”, which correspond to collection after 6h, 12h, 4h and 8h of storage respectively, are placed far away from the ±1log unit area. Fig. 2 illustrates the behaviour of 15°C and 20°C growth curves, where a very abrupt behaviour can be noticed especially for the 20°C curve at low sampling times. However, such results from PLS are expected, as it is well known that in modelling of real processes, linear PLS has some difficulties in its practical applications since most real problems are inherently nonlinear and dynamic [41].The FTIR data analysis utilising the leave-1-out cross validation method was imposed by the relative number of experimental samples. In order to investigate further the capabilities of AFLS model in this joint problem of classification/prediction, a second experiment was carried out, where the initial FTIR dataset was divided into a training subset with approx. 75% of the data, and a testing subset with the remaining 25% (i.e. 19 samples). An ANFIS model and an MLP network have been also developed for comparison reasons, to associate the same spectral data from FTIR analysis with beef fillet spoilage during aerobic storage at different temperatures.The proposed AFLS model has been also utilised in this second simulation study, in order to assess its competence to be trained with a dataset with a reduced number of samples. For this particular case, after trials, it has been found that 15 rules were necessary for the proposed model to achieve an acceptable performance for this particular case/experiment. The training set consisted of 55 samples, while 19 (7 fresh, 5 semi-fresh and 7 spoiled) meat samples were included in the testing subset. Table 8illustrates these testing results. It has to be mentioned however, that one fresh meat sample, although formally categorised as positive, its value was almost identical to the cut-off threshold, therefore it could be considered it as a “grey” case.In addition, AFLS's second output modelled successfully the TVCs, as illustrated in Fig. 11. In this case, the plot of the predicted vs. the observed TVC for the testing dataset, have shown reasonably good distribution around the line of equity without any particular trend, with the majority of data (ca. 89.47%) included within the ±1 log unit area. The semi-fresh “10F7” sample is clearly out of the ±1 log unit area, while the spoiled “5F9” sample is on the borderline. Another fresh sample (i.e. “0F5”) has been placed very close to the borderline. “10F7” sample corresponds to a beef sample stored at 10°C and collected after 52h of storage, “5F9” corresponds to a beef sample stored at 5°C and collected after 192h of storage and finally “0F5” corresponds to a beef sample stored at 0°C and collected after 96h of storage.The comparison of Fig. 11a with the related Fig. 7a is more than evident. A more comprehensible picture of the AFLS's prediction performance is provided in Fig. 11b, where the % relative error of prediction is shown against the observed microbial population. Based on this plot, data were distributed above and below 0, with approximately 89.47% of predicted microbial counts included within the ±20% RE zone. Samples “10F7” and “0F5” are placed outside the ±20% RE zone.The performance of the AFLS model to predict TVCs in beef samples for this second simulation, in terms of statistical indices is presented in Table 9. Based on the calculated values of the bias factor Bf, it can be assumed that the neurofuzzy network under-estimated TVCs in semi-fresh and spoiled samples (Bf<1), whereas for fresh samples over-estimation of microbial population was evident (Bf>1). The overall Bfwas almost optimal (ca. 1.007). In addition, the values of the accuracy factor Afindicated that the predicted TVCs were 11.8%, 7.8%, and 3.1% different from the observed values for fresh, semi-fresh, and spoiled meat samples, respectively. However, a closer comparison of AFLS performance for these two simulation case studies reveals a problem with the limited number of samples for training. The SEP index is much worse in this second case, and this reflects an open problem in learning-based systems, i.e. the need to have as large as possible training datasets.Similarly to the previous case study, an ANFIS model has been developed to predict TVCs for this reduced dataset. ANFIS's performance although generally inferior to the previous case study, revealed an almost excellent “response” to the cases of semi-fresh and spoiled samples. Unfortunately, such performance was compromised with a high computational cost, by utilising two membership functions for each input variables and 128 fuzzy rules.The related plot of the predicted versus the observed TVCs, as shown in Fig. 12a, reveals a good distribution around the line of equity without any particular trend, with the majority of data (ca. 89.47%) included within the ±1 log unit area.Two fresh samples were clearly outside the borderline of the ±1 log unit area. A more complete picture of the prediction performance of the ANFIS model is given in Fig. 12b where the % relative error of prediction is depicted against the observed microbial population.These diagrams reveal however some similarities. Samples “0F2” and “10F3” which are placed outside the ±1 log unit area at Fig. 12a also are responsible for the high relative errors at Fig. 12b, with 57.32% and 30.63% respectively. Sample “0F2” corresponds to a beef sample stored at 0°C and collected after 24h of storage, while sample “10F3” to a beef sample stored at 10°C and collected after 18h of storage. The performance of the ANFIS model in predicting TVCs for beef samples for this second simulation, in terms of statistical indices is presented in Table 10.The performance of the MLP model using the reduced training dataset, although it could be considered as satisfactory, it is also inferior compared to MLP's performance from the previous case. The calculated correct classifications were similar to the previous case (i.e. leave-1-out case). More specifically, the classification for fresh, semi-fresh and spoiled beef samples were 85.71%, 80.0% and 100% respectively, whereas the overall correct classification (accuracy) for MLP test dataset was 89.47%. The semi-fresh “15F10” sample, which corresponds to a beef sample stored at 15°C and collected after 48h of storage, was classified as spoiled, whereas the fresh “15F5” sample, which corresponds to a beef sample stored at 15°C and collected after 24h of storage, was classified as semi-fresh case. Table 11illustrates the MLP-based testing classification results.The related plot of the predicted versus the observed TVCs, as shown in Fig. 13a, reveals a reasonable good distribution around the line of equity without any particular trend, with the majority of data (ca. 84.21%) included within the ±1 log unit area. Three samples (2 fresh and one spoiled) were outside the border-line of the ±1 log unit area. A more complete picture of the prediction performance of the MLP is given in Fig. 13b where the % relative error of prediction is depicted against the observed microbial population. Based on this plot, approximately 78.94% of predicted microbial counts included within the ±20% RE zone.The above two diagrams reveal also some resemblances. Samples “15F5” and “0F2” which are placed outside the ±1 log unit area at Fig. 13a, also are responsible for the high relative errors at Fig. 13b, with −48.76% and 28.86% respectively. Sample “0F2” corresponds to a beef sample stored at 0°C and collected after 24h of storage. The performance of the MLP model in predicting TVCs for beef samples for this second simulation, in terms of statistical indices is presented in Table 12.The overall RMSE for the MLP was 0.8133, while the overall SEP was increased to 12.73%. However, an interesting issue from both Fig. 13a and Table 12 is related with the performance of semi-fresh samples. In comparison with the related AFLS and ANFIS cases, MLP model managed to predict more accurately the growth dynamics of semi-fresh samples. The related SEP was 5.97%, compared to 10.7% and 6.33% for the cases of AFLS and ANFIS respectively. Overall results revealed that both classification and especially prediction accuracies of the AFLS model were better compared with the performances of MLP, ANFIS and PLS, in the characterisation of meat samples for this reduced number of samples, indicating again the superiority of this specific MIMO neurofuzzy approach in tackling complex, nonlinear problems such as the meat spoilage.

@&#CONCLUSIONS@&#
In this paper, Fourier transform infrared spectra were used to identify meat spoilage microorganisms during aerobic storage at chill and abuse temperatures. The identification strategy involved not only the classification of beef samples in their respective quality class (i.e. fresh, semi-fresh and spoiled), but also the prediction of their associated microbiological population directly from FTIR spectra.The realisation of this strategy has been fulfilled with the development of a MIMO neurofuzzy model which incorporates a prototype defuzzification scheme, while utilising an efficient, compared to TSK-systems, fuzzification layer. In the case of AFLS, the number of memberships for each input variable was directly associated to the number of rules, hence, the “curse of dimensionality” problem was significantly reduced. Classification performance was almost excellent, with 95.94% and 94.74% accuracy for the two different case studies. Similarly, overall prediction for TVCs has been considered as very satisfactory, although lower performance was observed especially for the fresh samples.ANFIS's prediction performance appeared to be comparable to AFLS case; however such results were achieved with huge expensive computational cost. ANFIS suffers from the “curse of dimensionality” problem as well as the inability to support multiple output variables. Prediction performances of MLP and PLS schemes revealed the deficiencies of these systems which have been used extensively in the area of Food Microbiology. There is need to explore further the use of hybrid intelligent systems, and this paper has attempted for the first time to associate FTIR spectra with such systems.The AFLS performance although very convincing, discloses however an open problem, that is the need to have or “create” larger training datasets, even with the presence of small amount of real experimental data. Research work is in progress to develop algorithms based on fuzzy logic that will generate “virtual” spectral data from limited experimental spectral meat samples. Further research will be focused in incorporating to the data analysis, specific microbiological data, such as Pseudomonas spp., Brochothrix thermosphacta, Lactic acid bacteria and Enterobacteriaceae.