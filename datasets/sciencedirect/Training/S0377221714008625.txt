@&#MAIN-TITLE@&#
Minimizing costs is easier than minimizing peaks when supplying the heat demand of a group of houses

@&#HIGHLIGHTS@&#
We model a simple heating system.We examine complexity of computing the optimal control.Minimizing cost is polynomial while minimizing the peak is NP-complete.Further study of minimizing the peak.Studied problem has practical applications in Smart Grids.

@&#KEYPHRASES@&#
Complexity,Dynamic programming,Job scheduling,Lot-sizing,

@&#ABSTRACT@&#
This paper studies planning problems for a group of heating systems which supply the hot water demand for domestic use in houses. These systems (e.g. gas or electric boilers, heat pumps or microCHPs) use an external energy source to heat up water and store this hot water for supplying the domestic demands. The latter allows to some extent a decoupling of the heat production from the heat demand. We focus on the situation where each heating system has its own demand and buffer and the supply of the heating systems is coming from a common source. In practice, the common source may lead to a coupling of the planning for the group of heating systems. On the one hand, the external supply of the energy for heating up the water may have to be bought by an energy supplier on e.g. a day-ahead market. As the price of energy varies over time on such markets, this supplier is interested in a planning which minimizes the total cost to supply the heating systems with energy. On the other hand, the bottleneck to supply the energy also may be the capacity of the distribution system (e.g. the electricity networks or the gas network). As this has to be dimensioned for the maximal consumption, in this case it is important to minimize the maximal peak. The two mentioned coupling constraints for supplying the energy for producing the heat, lead to two different objectives for the planning of the group of heating systems: minimizing cost and minimizing the maximal peak. In this paper, we study the algorithmic complexity of the two resulting planning problems. For minimizing costs, a classical dynamic programming approach is given which solves the problem in polynomial time. On the other hand, we prove that minimizing the maximal peak is NP-hard and discuss why this problem is hard. Based on this, we show that this problem becomes polynomial if all heating systems have the same consumption of energy when turned on. Finally, we present a Fix Parameter Tractable (FPT) algorithm for minimizing the maximal peak which is linear in the number of time intervals.

@&#INTRODUCTION@&#
In modern society, a significant amount of energy is consumed for heating water (Aguilar et al., 2005). Almost every building in developed countries is connected to a district heating system or equipped with appliances for heating water locally. Typical appliances for heating water are electrical and gas heating systems, heat pumps and Combined Heat and Power units (microCHP). The resulting water is stored in buffers to be prepared for demands of inhabitants.A schematic overview of a local heating system is presented in Fig. 1. It consists of•a supply which represents some source of energy (electricity, gas),a converter which converts the energy into heat (hot water),a buffer which stores heat for later usage anda demand which represents the consumption profile of heat.A more formal definition of the used model for local heating and the used parameters and variables is given in Section 1.1. For the presentation of the model electricity and heat is used to distinguish between consumed and produced energy, but the given model can handle arbitrary types of energy. Furthermore, even though the presented model of the local heating system is quite simple, it cannot only be applied for heating water but has many other applications, e.g. heating demand of houses, fridges and freezers and inventory managements. Section 1.1 presents more details about those applications.The combination of a heating device and a buffer gives some freedom in deciding when the heat has to be produced. To use this freedom in a proper way, different objectives may be considered in practice. On one hand, the electricity used to heat water has to be bought. Although these prices are nowadays mostly fixed for private costumers, the supply companies delivering the electricity are faced with variable prices resulting e.g. from a day-ahead market. This leads to the objective of minimizing the total cost of electricity consumed by all heating systems in the area of the supply company during the planning period. Note that in cost or auction based control algorithms for Smart Grids, this objective is also used (see e.g. Molderink et al., 2010). On the other hand, the energy used for heating is transported from a supply to the heating systems by electrical networks or gas pipes. These transport media have to be able to transport all the used energy and therefore have to be dimensioned for the maximal consumption peak of all houses connected to the transport network. Thus, minimizing the maximal consumption over all these houses may decrease investments in the distribution networks.The above mentioned aspects lead to two basic planning problems for a group of heating systems which are both based on the same model but they differ in the objective function. The first problem is called minimizing cost. The second one is minimizing peak where peak is the maximal consumption of electricity over the planning period. Those problems are formally defined in Section 1.1. We show that the algorithmic complexity of those problems is substantially different, although the problems differ only by the objective function. The use of a classical dynamic programming approach (see e.g. Cormen et al., 2001) gives a simple polynomial-time algorithm. On the other hand, we proof that minimizing peak is NP-hard and we discuss why minimizing peak makes the problem hard. We show that minimizing peak becomes polynomial if all converters have the same consumption of electricity when turned on. We also present a dynamic programming algorithm for the general case of minimizing peak which is linear in the number of time intervals and the multiplicative constant depends only on the number of heating systems and the ratio between capacity and production of the heating systems, meaning that the algorithm is a Fix Parameter Tractable (FPT) algorithm.In this section we present a mathematical description of the studied model, possible applications of this model and a summary of the results of this paper. The used parameters and decision variables are summarized the following table.Cset of heating systemsset of time intervalsconsumed electricity of converter c if turned onproduced heat of converter c if turned onheat demand from the heating system c in time interval tprice of electricity in time interval tlower bound on the state of charge of buffer c in time interval tupper bound on the state of charge of buffer c in time interval toperational state of the converter xc, tstate of charge of buffer c in the beginning of time interval tFirst of all, we consider a discrete time model for the considered problem, meaning that we split the planning period into T time intervals of the same length. We consider setsC={1,⋯,C}of C heating systems andT={1,⋯,T}of T time intervals. In this paper, the letter c is always an index of a heating system and t is an index of a time interval. For mathematical purposes, we separate a heating system into a converter, a buffer and a demand; see Fig. 1. We say “a converter c” or “a buffer c” or “a demand c” to refer to the devices of the heating systemc∈C.We consider a simple converter which has only two states: In every time interval the converter is either turned on or turned off. The amount of consumed electricity is Ecand the amount of produced heat (or any other form of energy) is Hcduring one time interval in which the converterc∈Cis turned on. If the converter is turned off, then it consumes and produces no energy. Let xc, t∈ {0, 1} be the variable indicating whether the converterc∈Cis running in time intervalt∈T.The state of charge of a bufferc∈Cat the beginning of time intervalt∈Tis denoted by sc, twhich represents the amount of heat in the buffer. Note that sc, T + 1 is the state of charge at the end of planning period. The state of charge sc, tis limited by a lower bound Lc, tand an upper bound Uc, t. Those two bounds are usually constant over time: the upper bound Uc, tis the capacity of buffer and the lower bound Lc, tis mostly zero. But it may be useful to allow different values, e.g. a given initial state of charge can be modeled by setting Lc, 1 and Uc, 1 equal to the initial state. In this paper, we assume that Lc, 1 = Uc, 1, so the initial state of charge sc, 1 is fixed.The amount of consumed heat by the inhabitants of the house from heating systemc∈Cduring time intervalt∈Tis denoted by Dc, t. This amount is assumed to be given and is called the demand of heating system c. Furthermore, the price of a unit of electricity consumed by a converter in time intervalt∈Tis denoted by Pt. We discuss in Section 5 that different prices of electricity for different converters do not influence the developed algorithms. In this paper, we study off-line problems, so we assume that both demands Dc, tand prices Ptare given for the whole planning period.The operational variables of the converters xc, tand the states of charge of buffers sc, tare restricted by the following invariants.(1)sc,t+1=sc,t+Hcxc,t−Dc,tforc∈C,t∈T(2)[4pt]Lc,t≤sc,t≤Uc,tforc∈C,t∈T∪{T+1}(3)[4pt]xc,t∈{0,1}forc∈C,t∈TEq. (1) is the charging equation of the buffer. During time intervalt∈T,the state of charge sc, tof a bufferc∈Cis increased by the production of the converter which is Hcxc, tand it is decreased by the demand Dc, t. Eqs. (2) and (3) ensure that the domains of variables sc, tand xc, t, respectively, are taken into account.In this paper, we compare the complexity of the following two objective functions.(4)Minimizingcost:minimize∑c∈CEc∑t∈TPtxc,t(5)Minimizingpeak:minimizem(6)[4pt]wherem≥∑c∈CEcxc,tfort∈TSince Ecxc, tis the amount of consumed electricity by a converter c in time t and EcPtxc, tis the cost for this electricity, the sum in (4) is the cost for electricity consumed by all converters during the whole planning period. Furthermore, since the sum∑c∈CEcxc,tis the amount of electricity consumed by all converters in time t, the inequality (6) and the objective function (5) guarantee that the value of the variable m is the maximal consumption of electricity during one time period within the whole planning period.The contribution of this paper are as follows. First, we prove that minimizing peak is NP-hard even for two time intervals (T = 2) and it is strongly NP-hard if the number of time intervals T is a part of input (Section 3). To make it easier to get more insight in the differences between the two objectives, in Section 4 some preprocessing methods for the input data are presented. They, both, simplify the mathematical model and decrease the computation time if a Mixed Integer Linear Programming solver is used for minimizing peak. Afterwards, in Section 5, a classical dynamic programming approach (see e.g. Cormen et al., 2001) is given, which results in a polynomial-time algorithm for minimizing cost. This leads to the question which elements of the problem make the objective to minimize peak hard. The polynomial reduction presented in Section 3 sets up parameters Hc, Lc, t, Uc, tand Dc, tin such a way that every converter has to run exactly once and the consumption of converters Ecis used for partitioning integers into time intervals. Therefore, partitioning the consumption of converters Ecmakes minimizing peak hard. Thus, we investigate the special case where the consumption values Ecof all converters are equal, since in this case partition is trivial. We show that minimizing peak is also easy in this case by presenting a polynomial time algorithm (Section 6).However, as the assumption that all converters have the same consumption is not really practical. Therefore we consider which other restriction makes minimizing peak tractable. As minimizing peak is NP-hard already for two time interval and practical study cases often have a fixed number of heating systems but a long planning period, it would be useful to have a FPT algorithm for minimizing peak which is polynomial in the number of time intervals T if the number of heating systems C is fixed. We present such an algorithm which is polynomial in T if C and a radio between capacity of buffers and production of converters is fixed (Section 5).Furthermore, Section 4 presents some preprocessing methods for the input data which both simplifies the mathematical model and decreases computation time if a Mixed Integer Linear Programming solver is used for minimizing peak.

@&#CONCLUSIONS@&#
