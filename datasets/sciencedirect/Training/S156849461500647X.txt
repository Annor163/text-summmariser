@&#MAIN-TITLE@&#
Type-2 fuzzy sets applied to multivariable self-organizing fuzzy logic controllers for regulating anesthesia

@&#HIGHLIGHTS@&#
Type-2 self-organizing fuzzy logic controllers for automatic anesthesia control.Type-2 SOFLC use type-2 fuzzy sets to handle anesthesia control uncertainties.Data capturing inter and intra-patient variability used to define type-2 fuzzy sets.Simulations show effectiveness of type-2 SOFLC in control of anesthetic infusion under noisy and uncertain surgical conditions.Type-2 SOFLC are able to outperform the existing type-1 SOFLC.

@&#KEYPHRASES@&#
Anesthesia,Hierarchical systems,Type-2 fuzzy sets,Self-organizing fuzzy logic controller,

@&#ABSTRACT@&#
In this paper, novel interval and general type-2 self-organizing fuzzy logic controllers (SOFLCs) are proposed for the automatic control of anesthesia during surgical procedures. The type-2 SOFLC is a hierarchical adaptive fuzzy controller able to generate and modify its rule-base in response to the controller's performance. The type-2 SOFLC uses type-2 fuzzy sets derived from real surgical data capturing patient variability in monitored physiological parameters during anesthetic sedation, which are used to define the footprint of uncertainty (FOU) of the type-2 fuzzy sets. Experimental simulations were carried out to evaluate the performance of the type-2 SOFLCs in their ability to control anesthetic delivery rates for maintaining desired physiological set points for anesthesia (muscle relaxation and blood pressure) under signal and patient noise. Results show that the type-2 SOFLCs can perform well and outperform previous type-1 SOFLC and comparative approaches for anesthesia control producing lower performance errors while using better defined rules in regulating anesthesia set points while handling the control uncertainties. The results are further supported by statistical analysis which also show that zSlices general type-2 SOFLCs are able to outperform interval type-2 SOFLC in terms of their steady state performance.

@&#INTRODUCTION@&#
Modern invasive surgical procedures would normally be impossible without the patient being induced into a state of general anesthesia (GA). The essential features of successful GA, displayed by the patient, are a reversible loss of consciousness with a cessation of movement through muscle relaxation, a lack of awareness, unresponsiveness to painful stimuli through analgesia (i.e. pain relief) and an overall lack of recall of the surgical intervention. Inadequate GA may lead to intra-operative awareness with recall (due to anesthetic under dosage) or to prolonged recovery and an increased risk of postoperative complications for the patient (due to over dosage) [1]. The major role performed by a clinical anesthetist is the maintenance of GA over the duration of surgical procedures by the precise and timely delivery of drugs into the patient's body. In order to aid the anesthetist there is a need to design systems to accurately administer and control the delivery of anesthetic in direct response to patients’ physiological changes, in order to maintain effective anesthesia during surgery, while providing a means of interpreting these responses. In the last decade several experiments have been performed, where anesthesia was controlled in a closed-loop control system without human interference [2–4]. Although these experiments were relatively successful, there are many sources of complexity and uncertainty related to biomedical control systems that make designing such an automatic controller difficult.There can be differences in the patient's physiological characteristics such as age, gender and any pre-operative health conditions which can have an effect on the concentration and duration of anesthetic drug that is required to be administered during surgery [1]. The variability in the physiological effects of drugs on the body (pharmacodynamics) and the drugs metabolism in the body (pharmacokinetics) means that the concentrations of the anesthetic drug required to be infused or inhaled may change. There can be dynamic multi-variable effects in the way the patient responds while undergoing the surgical procedure based on heart rate (ECG), respiration, blood pressure (BP) and muscle relaxation (EMG) as well as brain activity (EEG), which will need to be carefully monitored and controlled by the anesthetist. Finally noise and variability in signals that are sensed and monitored from the human body such with EMG and BP signals can occur due to the effects of high frequency surgical instruments, interference due to changes in cardiac rhythm, sensing barriers such as subcutaneous fat, bodily movements and other external environmental effects. The above mentioned complex multivariable interactions and variations translate into a high degree of non-linearity; complex input output relationships and encountered uncertainties within the control process. These make the task of automating anesthesia control very challenging [5,6].Fuzzy logic controllers (FLC) have been credited with being an adequate methodology for designing robust controllers that are able to deliver a satisfactory performance when contending with the uncertainty and imprecision attributed to the real world [7]. FLCs are therefore able to exhibit robustness with regard to noise and variation of system parameters in complex highly non-linear problem domains such as biomedical control systems [8,9]. There have been a number of recent applications of FLCs for automated drug infusion control as described in [10–12]. Here type-1 FLCs have been used in a closed loop system designed to maintain a targeted effect by adapting the administered amounts of drug based on approximating the outputs of a reference model.Fuzzy adaptive control schemes in which the FLC parameters are modified have been increasingly applied for regulating the drug delivery process, due to their ability to dynamically configure and learn to control drug infusion/concentration rates based on patient and environmental variability. In [13] fuzzy rules emulated network (FREN) is described to adaptively control the infusion of sodium nitroprusside while maintaining target values for mean arterial pressure (MAP). Here an FLC is initially pre-defined and an on-line adaptation algorithm is used to tune its input and output type-1 membership function parameters during the simulation run. In [14] a fuzzy neural network (FNN) is proposed to automatically manage the hemodynamic variables specifically, MAP and cardiac output (CO), of patients with hypertension and congestive heart failure by simultaneous infusion of cardiac drugs such as vasodilators and inotropic agents. The parameters of the FNN are initialized based on physician expert experience. Over the course of the control simulations a back-propagation learning algorithm adjusts, on-line, the shapes of the type-1 membership functions (MFs) used in the fuzzification layer and fuzzy output layer of the neural network.Type-2 FLCs that are based on type-2 fuzzy sets have been shown under specific conditions to assist in providing a good solution [15]. This is due to the fact that type-2 fuzzy sets have more design degrees of freedoms, which are able to handle higher orders of possible real world uncertainties and hence potentially contribute to producing more accurate and stable control performances. Previous work by El-Bardini and El-Nagar [16] has developed a direct adaptive interval type-2 FLC for controlling the multivariable anesthesia system to overcome the uncertainty problem introduced by large inter and intra-individual variability of the patient's parameters. This adaptive controller uses predefined rule-bases for each control signal and expert initialized interval type-2 fuzzy sets. The learning mechanism approximates a reference model which models the effects on MAP and muscle relaxation based on the interaction of two anesthetic agents: Isoflurane and Atracurium used in their regulation to specified set points. This is achieved by a knowledge base modifier which tunes the centers of the output MFs of fired rules in response to deviations from the desired control behavior. Random initialization of the model parameters was used to simulate the patient variability. More recently in [17] an automatic approach for the regulation of bispectral (BIS) index in the anesthesia process by controlling the concentration target of two drugs, namely, Propofol and Remifentanil is proposed. The approach constructs a pharmacokinetic and pharmacodynamic patient reference model describing the dynamic reactions to the input drugs which is derived from real clinical data. Three PID controllers are employed, namely linear PID controller, type-1 (T1) fuzzy PID controller and interval type-2 (IT2) fuzzy PID controller, to regulate the BIS index using the nominal patient's model. The number of fuzzy rules and shape of the MFs are initially pre-defined however the PID gains and MF parameters are optimized offline by a genetic algorithm subject to a performance index (cost function) which quantifies the performance of the controllers.One successfully applied approach is the self-organizing fuzzy logic controller (SOFLC) [6] which is composed of a hierarchical control structure consisting of a standard FLC that is adapted using a self-organizing (SO) mechanism proposed by Procyk and Mamdani [6,18] which acts as a monitor and an evaluator of the controller performance. The SO has the ability to create and modify the rule-base of an FLC to meet the desired response of the controller. This feature provides a qualitative adaptive mechanism which is based on adjusting the control behavior rather than focusing on a parametric tuning and optimization of the fuzzy sets as is the case with the existing approaches for adaptive closed loop drug delivery systems described above. As the rules essentially distribute and individually encapsulate control behavior this approach provides a very flexible adaptive control mechanism that can rapidly adjust the system to a desired behavior. More over the approach can provide the benefit to the anesthetist of being able to linguistically interpret and analyze the control performance based on adapted rules enabling an understanding of drug delivery behavior over different stages, of specific surgical procedures in response to patient specific physiological and medical conditions.In the past two decades, there have been several studies on applying SOFLC to biomedical systems, such as muscle relaxation [19,20], depth of anesthesia [21], and patient analgesia control [22]. Controlling the delivery of anesthesia in operating theaters is possible using the multivariable SOFLC structure due to its ability to approximate flexible nonlinear control models which can be dynamically adapted for regulating desired physiological set points for muscle relaxation and unconsciousness (measured from BP). Simulation studies presented in [6,23], have shown that the SOFLCs were able to adaptively adjust the multivariate control outputs for the drug concentration and infusion rates however produced high degree of instability and steady state errors in approximating the set points for control of anesthesia, which would not be acceptable in a real system. Part of the reason for this is that these previous applications of SOFLCs are based on using type-1 fuzzy sets, which are unable to handle fully the uncertainties affecting parameter variability associated with biomedical control processes and in particular controlling anesthesia delivery during surgical procedures.In this paper we propose a type-2 SOFLC which combines the qualitative adaptive control mechanism of a SOFLC with the use of type-2 fuzzy sets to handle the uncertainties affecting parameter variability during the maintenance of anesthetic sedation. Type-2 SOFLC's are based on interval and z-slices based type-2 fuzzy sets [24] which are used for modeling the uncertainties associated with the input/output parameters. We evaluate the performance of the type-2 SOFLCs for the automatic control of anesthesia during single stage surgical procedures in which we use a non-fixed patient model and add signal noise to account for environmental and patient drug interaction uncertainties. We construct the type-2 FOUs using data acquired from real patients during surgical procedures to approximate realistic patient interaction and signal uncertainties encountered. The FOU's of the type-2 sets therefore aim to capture the possible numerical uncertainties in the physiological parameters during regulation and control of anesthesia. We perform unique simulated experiments in which the type-2 SOFLCs is used for controlling anesthestic drug delivery to maintain physiological set-points for muscle relaxation and BP (used in assessing consciousness) during surgical procedures. We show how our type-2 SOFLCs can deal with the control complexities and uncertainties to produce a good control performance in terms of approximating and maintaining the physiological set-points over steady state control. We compare their performance with type-1 SOFLCs and show the type-2 SOFLCs produce significantly lower performance errors while generating fewer better defined rules in controlling a multi-variable anesthesia system.The rest of this paper is organized as follows: In Section 2, we describe the patient anesthetic model and the derived reference model which we use in our anesthesia control simulations for evaluating controllers’ performance. In Section 3, the type-2 fuzzy sets and their associated terminologies are introduced. Our type-2 SOFLC's hierarchical control and adaptation mechanism is described in Section 4. In Section 5, we present our experiments and results. Finally conclusions and future research directions are presented in Section 6.The major roles performed by a clinical anesthetist are the maintenance of drug-induced muscle relaxation (paralysis), unconsciousness and analgesia [25]. Measuring the patient's level of sensation based on muscle relaxation can be carried by using a Datex Relaxograph to measure evoked electromyogram (EMG) signals. In clinical settings, anesthesiologists have a number of physiological signs and online measurements including BP, EEG, minimum alveolar concentration and auditory evoked response that can be used selectively for the determination of the patient's anesthetic state [26,27]. However, anesthesiologists still normally use BP as it is considered as one of the most reliable measures according to clinical standard practices [28,29] for defining the level of anesthesia that relates to the degree of unconsciousness and depth of anesthesia (DoA) [26]. Currently there is still no validated, routinely used monitor for analgesia [30,31], and so analgesia is not controlled in this study. Regulation of muscle relaxation percentage is done by EMG responses to the intravenous administration of drugs such as Atracurium, Cis-Atracurium, or Rocuronium. This is normally done by using a syringe pump, like an Ohmeda 9000 or Graseby 3500, via a computer to control the infusion rate [32]. For maintaining DoA, BP (expressed in terms of the systolic pressure over diastolic pressure and measured in millimeters of mercury (mmHg) is used as a guide for administering intravenous drugs such as Propofol or inhalational anesthetics such as Isoflurane, Desflurane, or Sevoflurane. Typically this is done through using a stepping motor via a computer to control the inhalational gas concentration [33].Pharmacological modeling is commonly used to describe the metabolism of such drugs [16] which can be used as a basis to create a mathematical model. Pharmacological modeling comprises of two main categories which are: Pharmacokinetics (PK), the concentration of drugs in the blood as a function of time and dose schedule interpreted mathematically via compartmental models representing the metabolism of the drug in different parts of the body; Pharmacodynamics (PD), the relationship between drug concentration in the blood and its effect [34]. In modern surgery, Atracurium is commonly used for controlling muscle relaxation and Isoflurane or Propofol for controlling anesthesia through BP via their PK–PD compartment models.The patient model used with our SOFLCs simulations is based on a multivariable anesthetic model combining two pharmacological models the Atracurium Mathematical Model: based on the pharmacokinetics and non-linear pharmacodynamics of Atracurium [35] on muscle relaxation (paralysis), and the Isoflurane Unconsciousness Model: describing variations of BP (change in MAP) to small changes in concentrations of inhaled Isoflurane.According to previous studies [34,35], the Atracurium pharmacokinetics can be expressed by the following transfer function (1) which describes the pharmacokinetics of the muscle relaxation relating to Atracurium.(1)G1(s)=9.94(1+10.64s)(1+3.08s)(1+34.42s)The drug's pharmacodynamics effect can be expressed as the following transfer function [36]:(2)G11(s)=K1(1+T4s)e−τ1s(1+T1s)(1+T2s)(1+T3s)where τ1 is a dead-time (time elapsed until the drug takes effect), K1 is a coefficient, T1, T2, T3 and T4 are time-constants with the values: τ1=1min, K1=1, T1=4.81min, T2=34.42min, T3=3.08min, T4=10.64min. s refers to the algebraic function derived from applying a Laplace transform to transform from the time domain to a frequency domain s in order to equate time based effects on the model parameters. In addition, the following Hill equation is used to relate the effect of a specific drug concentration as described in Eq. (3)[37,38]:(3)Eeff=EmaxXEαXEα+(XE(50))αwhere XEis the drug concentration, α is the power and XE(50) is the drug concentration at 50% effect with the following values: Emax=100%, XE(50)=0.404μg/ml, α=2.98.Up till now there is still no direct method to measure DoA since the brain activity is too complicated to observe. Clinically, BP is one of the signs that are commonly used to indicate DoA. Based on previous studies in [6,39], the responses of BP to inhaled Isoflurane concentration is approximately linear when the changes in Isoflurane concentration are less than 5%. However, the responses are in general non-linear and time-varying if the changes become large. Therefore, a first-order linear model with a dead-time of 0.42min and a time-constant of 2min is used. In addition, in order to estimate the steady-state gain, it is assumed that a relatively sensitive patient needs 2% Isoflurane for a 30mmHg reduction in mean arterial pressure. Therefore, the model describing variations of BP to inhaled Isoflurane concentration can be written as follows [6]:(4)G22(s)=ΔMAP(s)U2(s)=K2e−τ2s1+T5s:where ΔMAP is the change in MAP, τ2 is a dead-time, T5 is a time-constant and K2 is a coefficient with the following values: τ2=0.42min, T5=2min, K2=−15mmHg/%.According to previous studies, the interaction of Atracurium to BP is so small that can be ignored [35,40]. The interaction of Isoflurane to muscle relaxation is significant and is expressed by the following equation [41]:(5)G12(s)=K4e−τ4s(1+T6s)(1+T7s)where τ4 is dead time, T6 and T7 are time-constants, and K4 is a coefficient having the values: τ4=1min, T6=2.83min, T7=1.25min, K4=0.27.Based on Eqs. (1)–(5) described in previous sections, the overall multivariable anesthetic model combining muscle relaxation (based on the pharmacokinetics and non-linear pharmacodynamics of Atracurium) and unconsciousness (based on the effects of Isoflurane on BP) can be summarized as the following equation:(6)ParalysisΔMAP=G11(s)G12(s)0G22(s)U1U2where U1 is the Atracurium infusion, U2 is the Isoflurane concentration. In a deployed system U1 and U2 would be inputs to an embedded microcontroller that would be used to operate the syringe pump and stepping motor for regulating infusion and inhalation concentration of these drugs respectively.The traditional fixed patient mathematical models is based on predefined clinical studies [34,35], and cannot represent the dynamic changes and interactive effects of drugs on a patient during surgical operations (intra-patient uncertainties) and these differences from one person to another (inter-patient uncertainties). In our simulations we experimented with adding values up to 1% of white noise to approximate the maximum value of possible parametric uncertainty affecting all parameters in Eqs. (1)–(5) of the multivariable anesthetic model. By using this non-fixed patient anesthetic model we can account for the possible patient drug interaction uncertainties during our simulations. The strength of physiological signals like muscle relaxation and BP is so small that it is susceptible to interference during measurement. In most cases, the amplitude of noise is up to 20% of standard deviation of the signal strength in measuring instruments [42]. We therefore experimented with adding values up to 20% white noise to the measured signals (i.e. muscle relaxation and BP value), in order to test the robustness of SOFLCs under real environmental uncertainty. Both the patient interaction and signal noise will enable us to test the features of type-2 SOFLCs, in their ability to handle the encountered uncertainties. The type-2 SOFLC proposed in this paper uses the non-static anesthetic model as a reference model in a closed loop control of the infusion and concentration rates of Atracurium and Isoflurane to maintain set points for muscle relaxation and BP for regulating DoA as shown in Fig. 1. The anesthetic model determines signal values for muscle relaxation and MAP based on the interaction of Atracurium and Isoflurane infusion and concentrate rates output by the controller. The model signals with the addition of noise are then compared with reference signals produced from a previous control actuation. The error and integration of error of each signal is calculated to form the closed loop inputs to the controller, as shown in Fig. 1. We use integration of error as additional inputs to signal errors in order for the control system to better emulate the gradual pharmacokinetics and pharmacodynamics responses and produce less pronounced oscillatory responses when approaching the desired control set points.Type-2 fuzzy sets are characterized by a fuzzy Membership Function (MF), where the membership value (or membership grade) for each element of the set is itself a fuzzy set in [0,1]. This allows us to capture and handle uncertainties about the degree of membership of an element in the fuzzy set. Given an input at p in the case of type-1 fuzzy sets, this will be a crisp singleton membership value where the vertical line intersects the type-1 fuzzy set as shown in Fig. 2(a). Note that the figure includes a third dimension which is implicit in the definition of a type-1 fuzzy set [15]. In the case of type-2 fuzzy sets the input at p will no longer have a single crisp value for the MF but instead the MF takes on values wherever the vertical line intersects a bounded area known as the Footprint Of Uncertainty (FOU) of a type-2 fuzzy set, see Fig. 2(b)–(d). According to Liang et al. [43], a type-2 fuzzy set can be thought of as a large collection of embedded type-1 MFs (forming its FOU), where each type-1 MF also has a weight or amplitude associated with it. These embedded type-1 MFs can potentially partition the input domain into smaller regions which enables a type-2 FLC to realize more complex nonlinear input–output control relationships than a type-1 FLC using the same rule-base [44,45]. The FOU can be derived from real world domain data [46,47] to capture the possible control variability of the input/output parameters that will affect the membership degree of their fuzzy sets.The membership of the type-2 set at p comprises of the primary membership values that intersect the FOU at p. Each primary membership value can have a weight associated with it creating an amplitude distribution projected in the third dimension. This distribution forms what is termed as a secondary MF which provides an additional design degree of freedom for modeling higher level uncertainties associated with the primary membership values. The third dimensional secondary MF can be modeled as either a fixed interval (interval type-2) or as a continuous fuzzy set (General type-2), whose support is in the interval [0,1] [15], as shown in Fig. 2(b) and (c) respectively.Formally a general type-2 fuzzy setA˜is characterized by a type-2 MFμA˜(p,u)[48] where p∈X and u∈Jp⊆[0, 1], i.e.,(7)A˜=((p,u),μA˜(p,u))|∀p∈X,∀u∈Jp⊆[0,1]in whichμA˜(p,u)∈[0,1].A˜can also be expressed as follows [48]:(8)A˜=∫p∈X∫u∈JpμA˜(p,u)/(p,u)Jp⊆[0,1]where ∫∫ denotes union over all admissible x and u. Jpis called the primary membership of p inA˜.At each value p say p=p, the two-dimensional (2-D) plane, whose axes are u andμA˜(p,u)is called a vertical slice ofA˜[48]. A secondary MF is therefore a vertical slice ofA˜and isμA˜(p=p′,u),for p′∈X and ∀u∈Jp⊆[0, 1] [48], i.e.,(9)μA˜(p=p′,u)≡μA˜(p′)=∫u∈Jp′fp′(u)/uJp′⊆[0,1]in which0≤fp′(u)≤1.Because ∀p′∈X, the prime notation onμA˜(p′)can be dropped, andμA˜(p)is referred to as a secondary MF [48], which is a type-1 fuzzy set, also referred to as a secondary set [48]. When fp(u)=1 is true for ∀p∈X, then the secondary MFs are interval sets and we have the case for an interval type-2 MF [48], which characterizes interval type-2 fuzzy sets.Interval secondary MFs reflect a uniform uncertainty distribution over the primary memberships of p[48]. Since all the memberships in an interval set are unity, an interval set is represented just by its domain interval, which can be represented by its left and right endpoints as [l,r] [43]. The two endpoints are associated with two type-1 MFs that are referred to as upper MF (UMF) and lower MF (LMF) [49]. The UMF and LMF are bounds for the FOU(A˜)of an Interval type-2 fuzzy setA˜[49]. The UMF is associated with the upper bound of FOU(A˜)and is denoted byμ¯A˜(p),∀p∈X.The LMF is associated with the lower bound of FOU(A˜)and is denoted byμ_A˜(p),∀p∈X[49]. The interval type-2 fuzzy setA˜can be represented in terms of its UMF and LMF as follows:(10)A˜=∫p∈X∫u∈μ_A˜(p),μ¯A˜(p)1/u/pMost of the real world applications of type-2 fuzzy sets have used Interval type-2 fuzzy sets [50]. This is due to the high complexity and associated computational requirements involved in the design of general type-2 fuzzy sets. Interval type-2 sets however have a limited ability to represent the secondary membership values 0≤fp(u)≤1 over a vertical slice ofA˜,which are associated with a varied uncertainty distribution in the third dimension. zSlices based general type-2 fuzzy sets as proposed in [24] provides a framework for extending the capabilities of interval type-2 sets to model the unequal uncertainty distribution in the third dimension. This should result in the potential for a superior control performance in comparison to type-1 and interval type-2 based fuzzy systems.The third dimension (z) of a general type-2 fuzzy set can be sliced into a finite number of interval type-2 fuzzy sets (zi) to form a zSlices based general type-2 fuzzy set as shown in Fig. 2(d). Each zSliceZ˜iis an interval type-2 fuzzy set with a specific height or level zithat represents the secondary membership or amplitude associated with all the primary memberships over its FOU. As such, the interval type-2 fuzzy setZ˜iwould have a membership gradeμZ˜i(p,u)in the third dimension that is equal to 0≤zi≤1 [24]. The zSliceZ˜ican therefore be written as follows:(11)Z˜i=∫p∈X∫u∈Jipzi/(p,ui)where at each p value, zSlicing creates an interval set with height ziand domainJip,which ranges fromμ¯A˜(p)itoμ_A˜(p)i,where 1≤i≤I and I is the number of zSlices (excludingZ˜0and zi=i/I[24]. Fig. 3shows zSlices-based type-2 fuzzy set with three zSlices whereμ¯A˜(p)iandμ_A˜(p)iare designated as riand lirespectively, for each slice along a vertical intersection of the set at point p. Hence Eq. (11) can be written as follows:(12)Z˜i=∫p∈X∫u∈μ¯A˜(p)i,μ_A˜(p)izi/(p,ui)and a zSliceZ˜ican also be expressed as:(13)Z˜i={((p,ui),zi)|∀p∈X,∀ui∈[li,ri]}The zSlices are arranged to represent a convex piecewise secondary MF where higher Z levels represent interval type-2 fuzzy sets with more certain narrower FOUs than lower Z level interval type-2 FOUs as shown in Fig. 3. Hence depending on the size and shape of the FOUs of each z slice, p would intersect one or more Z levels with corresponding secondary memberships over the union of all intersecting FOUs at zi.Our proposed type-2 SOFLCs for anesthesia control have a closed loop hierarchical adaptation and control structure which has the ability to generate and modify the rule-base making the controller adaptive to dynamic changes in the controlled system. The hierarchical structure consists of two levels comprising of the type-2 FLC and the components of the SO mechanism as shown in Fig. 4and described in the sections below.The first level is a type-2 fuzzy controller which consists of a fuzzifier, inference engine, rule-base, type-reducer, and defuzzifier [43] see Fig. 4. The input signal from the patient anesthetic model to the controller is taken at each sampling instant in the form four inputs. These are the error of muscle relaxation (M_e), integration error of muscle relaxation (M_e_i), error of BP (B_e) and integration error of BP (B_e_i) based on the set points to be maintained for DOA control. As mentioned the integration of the error is considered as an additional input to the system in order to effect the reduction of the steady state error in approaching the desired control set points. In our previous work we have proposed a method for decomposing a multivariable SO fuzzy logic structure into smaller 2-input/1-output control units [6]. This has the advantages of providing a more interpretable and modular component based representation of the system and generated rule-bases, as well as allowing flexible and efficient parallel computational implementations [51]. In the decomposed 2-input/1-output system used in our simulations, the fuzzy rules can be represented as:(14)IFxisF˜andyisF˜,THENzisG˜where x and y are inputs,F˜is input fuzzy set, z is output andG˜is output fuzzy set. In our simulations we evaluate the performance of both four input and two input SOFLCs where in the latter case the input parameters M_e_i and B_e_i are not included. Each input signal is mapped to a corresponding discrete level by using the error and integration error scaling factors respectively.The type-2 FLC maps control inputs to either interval or zSlices based type-2 input fuzzy sets which are based on singleton fuzzification. The input type-2 fuzzy sets activate rules in the rule-base. The inference engine combines the fired rules by employing type-2 intersection and union operations based on minimum t-norm and maximum t-conorm respectively [43]. This gives a mapping from input type-2 fuzzy sets to output type-2 fuzzy sets (which can also be either interval or zSlices based type-2 output fuzzy sets). The type-2 fuzzy outputs of the inference engine are then processed using standard interval type-2 type-reduction and defuzzification methods. The type-reducer combines the output type-2 fuzzy sets to form a type-1 fuzzy set known as the type reduced set [52]. The type-reduction method used here is the Enhanced Iterative Algorithm with Stop Condition (EIASC) method [53] which has been shown to be more computationally efficient for real world control applications over the well-known Kamik–Mendel (KM) iterative procedure [49,52]. The defuzzifier can then defuzzify the type-reduced type-1 fuzzy outputs to produce the crisp control outputs, where we use the standard centroid type reducer [54]. These control operation are based on using general type-2 fuzzy sets. In the case of z-slices based general type-2 fuzzy sets the interval type-2 control operations previously described are computed independently on the input and output interval type-2 fuzzy sets for each level zi. A center of sets type-reducer is then used to combine all the type reduced sets for each zlevel zito create an overall type reduced set [24]. The centroid defuzzifier is finally applied to obtain a final crisp output value as described in [24].There are two output control signals corresponding the to change of Atracurium infusion rate (d_Atra_inf) and the change of Isoflurane concentration (d_Iso_conc) which are based on the integration of these output values in order to facilitate real-time adjustment of anesthetic dosage. The crisp outputs are converted back to real values using the output scaling factors and sent to the patient anesthetic model. The model responses are then fed back to the type-2 SOFLC and compared with the set points to calculate the error and integration error of the input control signals.The type-2 SOFLCs which extend on the type-1 SOFLCs use input and output scaling factors to map the real valued parameters to a set of discrete levels for scaled inputs and outputs used in the system [6]. The discrete levels for the scaled control inputs are divided into seven levels represented by equidistant shoulder and triangular type-1 fuzzy sets: negative big (NB), negative medium (NM), negative small (NS), zero (ZE), positive small (PS), positive medium (PM), and positive big (PB). Fig. 5(a) shows the input type-1 fuzzy sets for M_e. The discrete levels for the scaled control outputs are divided into four levels also represented by equidistant shoulder and triangular type-1 fuzzy sets: zero (ZE), positive small (PS), positive medium (PM) and positive big (PB). Both scaled input and output type-1 fuzzy sets have an overlap 25% of the total area of each triangular MF. Interval and zSlices based type-2 FOUs are created from monitored physiological parameters of real anesthetized patients where we use the zSlices based type-2 FOUs to capture the intra and inter patient parameter variability. The generated FOUs will model realistic data derived numerical uncertainties affecting the input and outputs. We can then evaluate the SOFLC's ability to handle different proportions of white noise added to the input signals and non-static reference model parameters for approximating these numerical uncertainties during the surgical simulations. The following section describes the heuristic approach used for generating interval and zSlices based FOUs from the patient data.The FOUs of the patient derived type-2 fuzzy sets are generated using data acquired from monitoring physiological parameters of real anesthetized patients, in order to account for the uncertain parameter variability during DoA control. Average percentage of muscle relaxation avgmr and standard deviations (±) stdmr and the average BP avgbp and standard deviations (±) stdbp were collected from 15 anesthetized patients while undergoing ear, nose, and throat (ENT) surgical procedures, as shown in Table 1[55]. The (±) stdvmr and (±) stdvbp values for a given patient represent the intra patient variability attributed to noise and the PK and PD effects of anesthetic on the patient's body over the surgery duration. Table 1 also contains the mean average and standard deviation values for muscle relaxation and BP which we will designate asavgmr(mean)stdvmr(mean)andavgbp(mean)avgbp(mean)respectively.We used the following heuristic process to generate the interval and zSlices based general type-2 fuzzy sets for the type-2 SOFLC input parameters. A coefficient of variation percentage for muscle relaxation: cvmr and BP: cvbp is initially calculated for each patient (see Table 1), as follows:(15)cv∂(t)=stdv∂(t)avg∂(t)×100where 1≤t≤T, T is the number of patients and ∂=mr or bp. The calculated cv values are based on 100% muscle relaxation and a BP of 100mmHg. The operating physiological set points for anesthesia used in our simulations are 80% muscle relaxation and 110mmHg (systolic) BP, which we will designate as stpmr and stpbp respectively. The cv values were then scaled to these set points to give the following scaled cv valuescvΔbp(t)andcvΔmr(t)that were calculated as follows:(16)cvΔ∂(t)=cv∂(t)100×stp∂Table 1 shows the calculated mean cv valuescv∂(mean)for muscle relaxation and BP based on the 15 patients which were then scaled to reflect anesthesia set points and are given ascvΔmr(mean)andcvΔbp(mean)respectively.To construct the interval type-2 set's FOUs a symmetric uncertainty value ±uc∂ is calculated as follows:(17)±uc∂=(cvΔ∂(mean))/pr∂2where pr∂ is the parameter range over which thecvΔ∂(mean)values are divided to derive the FOU uncertainty ranges. The calculated ±uc∂ is added to the end points of the type-1 fuzzy sets to form the interval type-2 FOUs. The type-2 fuzzy sets produced are based on shoulder and trapezoidal interval type-2 MFs. We illustrate how the heuristic process was applied to generate the interval type-2 fuzzy sets for the type-2 SOFLC input variable M_e, based on the patient data in Table 1, as follows:avgmr(mean)=89.69,stdvmr(mean)=±10.95cvmr(mean)=(10.95/89.69)×100=12.21,cvΔmr(mean)=12.21×0.8)=9.77prmr=±7(scaled parameter range for M_e)±ucmr(mean)=1×((9.77/±7)/2)=1.39/2=±0.70As shown in the example above the overlap and support of the original type-1 fuzzy sets was also factored into the final±uc∂(mean)value. In the case of the input M_e this was the product of the support (which was 4) and overlap (which was 0.25) that equated to 1. This was then multiplied by±ucmr(mean)to give the same result. The calculated±ucmr(mean)value above was then used to construct symmetric FOUs to form interval type-2 fuzzy sets which are shown in Fig. 5(b).The cv valuescvmr(t)andcvbp(t)for each patient represent inter patient variability attributed to differences in the PK and PD effects of anesthetic on each patient's body. For constructing the zSlices based general type-2 fuzzy sets, similar inter patientcv∂(t)values were identified and grouped from the patient data. Five groups of patients were identified, based on a distance measure between theircv∂(t)values for muscle relaxation and BP respectively. The mean cv valuescvmriandcvbpicalculated from each group was used to generate a symmetric interval type-2FOU∂iover the endpoints of the original scaled type-1 fuzzy set using the heuristic method previously described, where 1≤i≤5. EachFOU∂iwas then assigned to a zSlice with amplitude zi. The interval FOUs for each group were then arranged together to form a third dimensional piecewise secondary MF of the zSlices based general type-2 fuzzy sets. We illustrate below how the average cv values for muscle relaxation were calculated from each identified group of similar patients based on the patient data in Table 1. We then show how the heuristic process was applied to generate the zSlices based general type-2 fuzzy sets for the SOFLC input variable M_e as follows:Patient group1:cvmr1=14.11+20.88+17.60=52.59/3=17.53±ucmr1(17.53*0.8)/7=14.02/7=2.0(FOU)=+/−1.0Patient group2:cvmr2=13.91+13.20+12.74=39.85/3=13.28±ucmr2(13.28*0.8)/7=10.62/7=1.52(FOU)=+/−0.76Patient group3:cvmr3=11.71+10.95+11.84=34.5/3=11.5±ucmr3(11.5*0.8)/7=9.2/7=1.31(FOU)=+/−0.66Patient group4:cvmr4=10.47+10.90+10.81=32.18/3=10.72±ucmr4(10.72*0.8)/7=8.58/7=1.23(FOU)=+/−0.61Patient group5:cvmr5=7.79+8.39+8.10=24.28/3=8.09±ucmr5(8.09*0.8)/7=6.47/7=0.92(FOU)=+/−0.46The calculated±ucmrivalues above are then used to construct symmetric FOUsFOUmrifor each zSlice which are separately shown in Fig. 6(a) for linguistic level ZE. The individual FOUs are then combined to form zSlices based general type-2 fuzzy set for linguistic level ZE as shown in Fig. 6(b).The type-2 MFs used for the type-2 SOFLC input parameters are constructed using the heuristic method previously described. In contrast a trial and error based approach was used to determine the interval and zSlices based general type-2 MFs used for the type-2 SOFLC output parameters (d_Atra_inf) and (d_Iso_conc). Here the best drug infusion and concentration range to induce patients into anesthesia was determined and then used to calculate the uncertainty ranges for creating the type-2 FOUs from the existing type-1 fuzzy sets. The design of a more structured approach to generate the output type-2 fuzzy sets will be the scope of future work.The second level of the SOFLC consists of the SO mechanism that is able to tune and modify the control rules to output the desired control responses [6]. The SO mechanism comprises of four functional blocks: the previous rule-base generation, performance index, rule generation and displacement and rule-base modification which feeds into the FLC control rules as shown in Fig. 4. The previous rule-base can be generated either from expert experience (i.e., medical doctors) or from learning the input/output relationships based from clinically logged patient data on DoA. During the control process the rules in the previous rule-base generation block will be modified by the SO mechanism. The performance index measures the deviation from the desired response and calculates the appropriate changes that are required in the output of the controller. The performance index functions act as an evaluation criterion of the controller performance and measures the deviation from the desired trajectory and issues the appropriate correction to the rule(s). It is derived from linguistic conditional statements by means of using standard fuzzy operations and is written in a multi-dimensional look-up table (performance index matrix). The generation and modification of the control rules is achieved by assigning a credit or reward value to the individual rule combinations defined in the look-up table. The credit value is obtained from the performance index defining the desired performance linguistically and is added into a look-up table to generate new rules if these are not found in the previous rule-base. Hence this process will iteratively modify the output of the controller. The type-2 FLC rules are adjusted over the control process to reflect a qualitative “feel” for the patients’ responses to administered drugs and are intended to provide fast convergence around the equilibrium state to achieve a high accuracy and control stability. As the performance functions are only shown in a two-dimensional form, we use our previously described method for decomposing an m-input/n-output SOFLC structure to many 2-input/1-output subsystems whose outputs are then aggregated together as described in [6]. The performance index rules for the 2-input/1-output subsystems can therefore be more easily defined in a more interpretable two-dimensional space [6]. Fig. 7shows our four input two output type-2 SOFLC which has been decomposed into 12 two inputs/one output subsystems. Further details on the design of SOFLC can be found in [56]. The type-2 SOFLC therefore provides adaptive control rules which can effectively model a multivariable non-linear system and dynamically configure themselves to control drug infusion/concentration rates while handling patient and environmental uncertainties.

@&#CONCLUSIONS@&#
In this paper, we have presented a novel type-2 SOFLC for the automatic control of anesthesia during single stage surgical procedures. The SOFLC is a hierarchical controller which consists of a standard FLC and a SO rule-base mechanism that observes the trajectory of the process to be controlled and corrects any deviations from a desired trajectory path by modifying the FLC's control rule(s). The purpose of our study was to evaluate whether the original type-1 SOFLC could be enhanced by using type-2 fuzzy sets to improve multivariable anesthesia control.Our type-2 SOFLCs used interval and zSlices based general type-2 fuzzy sets to model variability in the multi variable control parameters, specifically the input parameters for muscle relaxation and BP (used in monitoring DoA) and the output parameters of Atracurium and Isoflurane infusion/concentration rates (used in anesthesia regulation). Clinically acquired data on the average maintained set points for BP (mmHg) and muscle relaxation percentage were collected from 15 anesthetized patients during surgery. The data was used for defining symmetrically shaped FOUs of the Interval and zSlices based general type-2 fuzzy sets using a heuristic approach to capture inter and intra patient parameter variability found in the clinical data, in order to approximate the type-2 FOUs. We used a multivariable non fixed anesthetic model as our patient reference model for conducting surgical simulations which were based on known pharmacological models of the noise added interactions of Atracurium and Isoflurane for regulating muscle relaxation and DoA respectively. The simulations compared the type-2 SOFLCs with type-1 SOFLCs in controlling anesthesia delivery to maintain physiological set points for muscle relaxation and BP over the duration of a single stage operational procedure.Our results specifically showed that both the interval and zSlices based general type-2 SOFLCs were able to produce a good multivariable control performance in maintaining the desired set points for muscle relaxation and BP in comparison to the type-1 SOFLCs while operating under signal and patient noise. In the case of interval type-2 SOFLC these results concur with experimental evidence that suggests that an interval type-2 FLC will give a smoother control surface in regions around the steady state over its type-1 counterpart [60,61]. Karnik et al. also suggest that interval type-2 FLCs are more adaptive as they are able to realize more complex input-output relationships which cannot be achieved by a type-1 FLC [62]. Our results also support this from the IT2 SOFLCs ability to adaptively regulate multi variable anesthesia set points based on adjusting the delivery rates of two different drugs with different pharmacodynamic and pharmacokinetic characteristics. zSlices based general type-2 fuzzy sets slice the third dimension of a general type-2 fuzzy set into a finite number of interval type-2 fuzzy sets each with a specific height that represents the secondary membership or amplitude associated with all the primary memberships over its FOU [24]. The three dimensional MF of a zSlices based general type-2 fuzzy set can therefore provide greater design degrees of freedom over interval type-2 fuzzy sets [24]. The simulation results we obtained for our GT2-SOFLCs were shown to support this by achieving lower steady state errors for multi variable set point control than the equivalent interval type-2 and type-1 SOFLCs.We also found that both the interval and zSlices based general type-2 SOFLCs are able to use fewer more concentrated rules to reach the set points via tracking their rule usage. In our simulations we did not use the rules’ firing percentage values as additional inputs into our SO mechanism. Further research can use these values to assign a weight to each rule in order to improve the rule modification process. In addition, a further deployment of this approach for visualizing the rule usage patterns can help the anesthetist study the drug delivery behavior.This study has provided good evidence on the merits of using our type-2 SOFLC for automated anesthesia. Compared with the previous FREN system described in [13], our SOFLC is a multi-variable controller for controlling both MAP (as with FREN) and muscle relaxation. FREN was also applied in a postoperative scenario while the SOFLC is for intraoperative drug delivery control. The FNN in [14] is a multi-variable system for controlling MAP and CO in a postoperative scenario. Two separate sub-controllers are used in [14], which is a similar concept as the decomposition of the multi-variable structure used for SOFLC. However a major difference between the FNN and our SOFLC is that the FNN is able to modify the MFs whereas the SOFLC can self-adapt by modifying the fuzzy control rules.El-Bardini et al. proposed a direct adaptive IT2-FLC in [16] applied to the same scenario as our study. The direct adaptive IT2-FLC uses a predefined rule-base and tunes the centers of the output MFs of fired rules in response to deviations from the desired control behavior. Inter and intra-variability is added to the parameters of the patient drug interaction model by manually setting these for specific test cases. In our study we added random noise to both patient model and the measured signals for muscle relaxation and BP to exam the robustness of the controller under environmental and patient related uncertainties. In terms of evaluation of performance, square of errors (ISE), integral of time and absolute error (ITAE) and root mean square error (RMSE) are used as criteria for the direct adaptive IT2-FLC. In our simulations, SSE is the most important criterion to evaluate the performance. It can be proved that the RMSE is greater than or equal to the arithmetic mean error that we used to calculate the SSE. However, the difference of these two types of error will be close to zero for steady state control. Therefore we can use the two errors to roughly compare the performance of the two controllers. By comparison we can find that even the worst case of the 42-IT2-SOFLC and 42-GT2-SOFLC can still produce a lower error than the best case of the direct adaptive IT2-FLC in [16]. Nevertheless, it should be noted that the RMSE measured for direct adaptive IT2-FLC also counted the settling stage, which leads to a larger overall error. Hence, further research will provide a benchmark comparison to evaluate the performance of the two controllers more precisely. More recent research described in [17] uses genetic algorithms to design fuzzy PID controllers to regulate BIS. The parameters of the fuzzy PID controllers are optimized offline and a cost function is defined to evaluate the performance of the fuzzy PID controllers. However, this controlling structure is quite different from our study so it is difficult to directly compare the performance of this system with our approach. Future research could compare this control strategy to the SOFLCs if we change our monitoring of DoA to use BIS instead of BP as is the case in this study.In our simulations, we have used a fixed amount of initial bolus which is administered to patients to reach rapid anesthesia. The initial bolus is effective in muscle relaxation in the first 15min and settles down toward the set point. The simulation results show that the bolus can let the system stabilize close to the desired set point which can then be regulated through the adaptive SOFLC. In a real clinical setting it is still however difficult for the anesthetists to decide the amount of the bolus to give. Different patients have different physiological response such as height and weight, and the dosage of initial bolus can therefore also vary in terms of its effectiveness on the patient. Anesthetists generally tend to guess the initial bolus and adjust the amount according to the patient's physiological response. Future work will simulate different amount of initial bolus and see how the type-2 system can handle the related uncertainties and adjustment of the bolus amount to be initially administered.Our controller is mainly proposed for regulating single stage operation procedure instead of multi stage operation procedures. In such scenarios the depth of anesthesia is not always at the same level during multi-stage surgical procedure in which the set points may change several times during the operation. Hence, in the future, the set point of muscle relaxation and BP will be changed two or three times during a longer multi-stage simulated procedure to evaluate how well the controller (i.e., Type-2 SOFLC) can handle these changes.Another proposed feature of the SOFLC which has not been investigated as part of this study is the ability to track and analyze the systems rules that fire over the control period. The dynamic patterns of rule firings can indicate some behavior about the effects of drugs and individual patient's responses to them over the course of a surgical procedure. This would be beneficial to the surgical team during the operation as well as to clinical staff managing the patient's postoperative care.