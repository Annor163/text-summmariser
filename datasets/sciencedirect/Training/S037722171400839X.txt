@&#MAIN-TITLE@&#
Calibration of agricultural risk programming models

@&#HIGHLIGHTS@&#
We show how risk programming models can be calibrated with Positive Mathematical Programming (PMP).Typical linear mean-variance models are incompatible with the PMP algorithm.We examine how supply elasticity priors can be used with PMP for calibrating a risk programming model.Nonlinear mean-variance models are suitable for agricultural policy analysis.

@&#KEYPHRASES@&#
Agricultural economics,Utility theory,E-V analysis,Farm model,Positive Mathematical Programming,

@&#ABSTRACT@&#
Positive Mathematical Programming (PMP) is one of the most commonly used methods for calibrating activity programming models. In this article we consider PMP as a calibration method for risk programming models with a mean-variance (E-V) specification. We argue that the restrictive theoretical assumptions employed by typical linear E-V models limit their applicability in analyzing the effects of decoupled payments on agricultural production decisions. Furthermore, the requirement for eliciting a risk aversion coefficient renders such models incompatible with the PMP method. For this reason we propose a nonlinear E-V specification and develop a PMP-based procedure for its calibration which does not aim at introducing (further) nonlinearities in the objective function, but at recovering the “true” distribution of wealth that will allow the final model to reproduce base year observations. We also examine how our approach relates to the recent PMP developments on calibration against elasticity priors and we show how such priors can be used for the calibration of the nonlinear E-V model.

@&#INTRODUCTION@&#
The effect of uncertainty and risk aversion on decision making has already received much attention in the economic literature and theoretical contributions have examined the behavior of the optimizing firm outside the neoclassical paradigm of parameter certainty and risk-neutrality (e.g. Sandmo, 1971). In the context of mathematical programming, risk has typically been modeled in a linear mean-variance (E-V) framework with an exogenously specified risk aversion parameter under the assumption of expected utility (E-U) maximization.Although linear E-V farm models have been used extensively in the discipline of agricultural economics, analysts employing them face two serious problems. The first is the availability of data that will allow for a complete characterization of the variance of allocative choices; typically such exercises require empirical distributions on prices and/or outputs which are rarely available at the farm level. For this reason it is common to use distributions from regional or even national data, under the assumption that preferences are homogeneous among farmers, although it is acknowledged that this practice often leads to a biased representation of risk (Gómez-Limón et al., 2003).The second problem is that an efficient calibration method for linear E-V models still does not exist. On the contrary, calibration methods for deterministic programming models have evolved significantly because agricultural economists applying operational research methods in agriculture realized that not all objective function specifications can simulate the observed market outcome (Kutcher and Norton, 1982). This finally led to a distinction between normative and positive models which has come to dominate the literature, especially after the seminal work of Howitt (1995a) on Positive Mathematical Programming (PMP).PMP assumes that the observed activity mix is optimal and considers calibration problems to be the result of unobserved implicit information that affects economic behavior. This implicit information is integrated into the model by introducing or re-estimating nonlinear terms in the objective function, so that the final nonlinear model exactly reproduces the observed activity vector. Interestingly, the PMP methodology seems to provide an answer (albeit unorthodox) to the previously described problem of data availability, since its fundamental principle is to calibrate programming models by estimating primal or dual specifications of production technology with only minimal data. Accordingly, our first argument in this article is that PMP can be used in an E-V context to estimate the wealth distribution which leads to the observed production choices.11This does not imply, however, that we support the estimation of behavioral functions for economic agents from a single observation. Our argument concerns those cases for which behavioral homogeneity, expressed through the selection of a common regional or national wealth distribution, is not a plausible assumption, since it may lead to erroneous model results. We discuss such issues in Section 3 and present an appropriate example in Section 4.Furthermore, we argue that the linear E-V model is not compatible with the standard PMP method and so the analyst should re-examine the suitability of the linear E-V specification. This argument also stems from the theoretical limitations of linear E-V models and more precisely from their restrictive assumption that an agent’s response to risk does not depend on the initial level of wealth. As a result of this assumption, such models cannot capture the effect of decoupled support mechanisms on farm production decisions because economic behavior is considered to be invariant to nonrandom profits.In order to bypass the previous theoretical limitation we propose the use of a nonlinear E-V model with a decreasing absolute risk aversion coefficient (DARA) and we develop a novel PMP method for its calibration. The working hypothesis is that the model may fail to calibrate because of (i) a wrong wealth distribution and (ii) the existence of implicit marginal costs that affect economic behavior. Additionally, we examine how to control the second order properties of the final model by introducing supply elasticity priors into the calibration process, as proposed by recent contributions in the PMP literature (e.g. Mérel et al., 2011; Mérel and Bucaram, 2010). Our approach differs from existing applications in that we consider a full elasticity matrix, consisting of both own- and cross-supply elasticities. We also show that because of the strong nonlinearities in the DARA model it is necessary to make use of the implicit function theorem, which, however, results in a computationally difficult estimation problem.The article is structured as follows: Section 2 explains the principles of the PMP method and presents the seminal example of calibrating linear programming (LP) models using nonlinear cost functions. Then we review the techniques for incorporating risk into economic programming models and investigate the methods proposed for their calibration. In Section 3 we examine the reasons for which the nonlinear E-V model may fail to calibrate and provide a detailed presentation of both the proposed PMP method, and of using supply elasticities in the calibration process. A simple farm-level application within the current Common Agricultural Policy (CAP) setting is given in Section 4, in order to demonstrate the model’s ability to calibrate and its response sensitivity to changes in the level of decoupled payments received by the farm. The paper ends with a discussion section where we identify the limitations of the nonlinear E-V specification and examine how our approach relates to the critique concerning the PMP method.The PMP algorithm is a two-step process that begins with the introduction of additional calibration constraints to the initial LP model that force it to replicate base year observations, x0:(1)maxx≥0Π=r⊤x−c⊤xs.t.Ax≤b[z](2)x≤x0+ɛ[h]where Π denotes farm’s gross margin to be maximized, x is the I × 1 vector of unknown activity levels (e.g., hectares), r is the I × 1 vector of activity revenues and c the I × 1 vector of average variable costs. Inequality (1) represents the resource constraints, A is the M × I matrix of technical coefficients and b is the M × 1 vector of available resources. The dual values associated with the resource constraints are given by the M × 1 vector z. The calibration constraints (2) bind each activity to its observed level, while h is the corresponding I × 1 dual vector and ɛ is a small perturbation term that is used to prevent model degeneration.22A degeneration problem can occur when the resource constraints Ax ≤ b contain a land constraint expressed as ∑ix ≤ ∑ix0, where x and x0 denote the ith element of x and x0 (with i ∈ I). If the perturbation term is omitted, the two constraint sets are linearly dependent.The model calibrates and its first order conditions with respect to x are written as:(3)r−c−h−A⊤z=0The dual vector h is the key parameter in the PMP method and it is argued that it embodies any type of marginal implicit information on a farmer’s production choices, or it may implicitly account for model misspecifications and data errors that can cause calibration problems. Paris and Howitt (1998) interpret h as a “differential” marginal cost vector that, together with the observed “accounting” variable average cost c, can reveal the “true” variable marginal cost at x0. As is shown by Howitt (1995a), the necessary and sufficient condition for a model to calibrate is that the objective function be nonlinear in at least some of the decision variables (activities). The PMP algorithm thus aims at transforming the linear objective function into a nonlinear one that integrates all information contained in h, so that the model calibrates without any additional constraints. The nonlinearity is usually sought in the cost term and is introduced in the model by replacing the linear cost function c⊤x with a quadratic one, C(x) = d⊤x + 0.5x⊤Lx, where d is an I × 1 vector of linear terms and L is an I × I positive, semi-definite matrix that is either diagonal or fully specified.33The quadratic cost function is convex in x, thus leading to decreasing marginal profits. Alternatively, nonlinearities can be introduced in the form of a concave production function (e.g. Howitt, 1995a; 1995b).The final nonlinear model is written as:maxx≥0Π=r⊤x−d⊤x−0.5x⊤Lxs.t.Ax≤b[z]and the unknown parameters d and L must be estimated so that the model’s first order conditions with respect to x are exactly satisfied at x0:(4)r−d−Lx0−A⊤z=0Since both the initial bounded model and the final quadratic one calibrate, we can combine Eqs. (3) and (4) and obtain the following equation:44This step assumes that the resource shadow price vector z is the same in both models. The implications of this assumption are discussed in Section 5.2.(5)d+Lx0=c+hIn the second step of the PMP algorithm, Eq. (5) is used for the estimation of the unknown parameters d and L. This constitutes an ill-posed problem with I equations and 2I or I + I(I + 1)/2 unknown parameters, depending on the form of the L matrix; if L is diagonal, several ad hoc methods have been proposed, summarized by Heckelei (2002), while Paris and Howitt (1998) were the first to estimate a fully specified matrix. Their approach was based on the maximum entropy (ME) criterion and is now considered the standard method for estimating a full PMP L matrix.The E-V criterion and E-U theory are the principal methods for modeling choices under risk in economics. E-V analysis is based on Markowitz’s (1952) pioneering work on portfolio theory and postulates that an economic agent selects an activity mix which minimizes the variance of income, σ2 (or standard deviation, σ), for a given expected income, μ. On the other hand, E-U theory represents a more axiomatic approach to decision making under risk. It assumes that individuals assign discrete or continuous probability distributions to risky prospects and respond to this risk by maximizing the utility expectation E[U( · )] of the wealth W that these prospects generate. More formally, let W0 be the non-stochastic part of wealth55In economic literature, W0 is also called “initial” or “certain” wealth and W is usually referred to as “final” or “terminal” wealth. For what follows we will use these terms interchangeably.and α a random monetary reward, so that final wealth is given by W = W0 + α with μ = W0 + E[α] and σ2 = Var[α]. The maximization of E-U is equivalent to the maximization of the certainty equivalent (CE) of wealth, which Pratt (1964)approximated with the following E-V expression:(6)CE=μ−0.5[−U′′(μ)U′(μ)]σ2For a normal distribution of wealth and a negative exponential utility function U(W) = 1 − exp ( − φW), where φ represents the (constant) absolute risk aversion coefficient, maximizing the CE from expression (6) is exactly equivalent to the maximization of E-U (Freund, 1956). If g denotes the I × 1 vector of random profits per activity level (e.g., euro per hectare), so that α = g⊤x is the stochastic part of a farmer’s wealth, the resulting CE maximization program can be written in a linear E-V form as:(7)maxx≥0CE=W0+g¯⊤x−φ2x⊤Vxs.t.Ax≤b[z]whereg¯=E[g]is the I × 1 vector of expected activity profits and V is the I × I covariance matrix of activity profits. Expected wealth is thus given byμ=W0+g¯⊤xand its variance by σ2 = x⊤Vx.The linear E-V model (7) with an exogenously defined risk aversion parameter is probably the most common specification used in a mathematical programming context. As a result, the need for eliciting the risk aversion coefficient has led analysts to use methods that achieved some level of calibration of their models. For example, imputing values of φ by solving farm models for their efficient set of plans, finally allows to select a value of φ which gives the closest fit between the actual and predicted farm plans (e.g. Brink and McCarl, 1978). However, Hazell and Norton (1986) identify two problems related to this approach. The first refers to the possibility of farmers having access to risk sharing institutions, which may lead to an imputed value of φ that does not reflect their real risk attitude. The second problem concerns a possibly biased φ value in case of model misspecification and data errors. This is in line with Musser et al. (1989) who show that the omission of resource constraints can lead to an overestimation of the importance of risk in farmers’ decision making process.Yet the most important shortcoming of adjusting the risk aversion coefficient is that calibration may not be perfect because the optimality conditions of the maximization problem are not taken into account. Wiens (1976) was the first to calibrate a linear E-V model by using the first order optimality conditions, under the assumption that the resource dual vector z can be approximated with a vector w of factor market prices. As a result, φ can be estimated from the first order conditions of the linear E-V model (7), if they hold at x0 for z = w:(8)φ=g¯−A⊤wVx0Although Wiens’ approach is in line with the PMP rationale of calibrating using the first order conditions, it may not always be applicable. The reason is that φ is a scalar, whereas the right side of (8) corresponds to an I × 1 vector (I different equations). This may lead to inconsistency issues (non-identification of φ) since each equation may yield different estimates of φ (Paris, 1979). Another problem is that the assumption z = w is rather difficult to hold in empirical analysis because some constraints may either be non-binding (resulting in zero duals) or they may concern non-marketable goods (e.g. crop rotations or intermediate products). Furthermore, the opportunity cost of resources produced in the farm (like animal manure used as fertilizer for crops) can be quite different from their actual market prices.Regarding the use of PMP for the calibration of risk models, Heckelei (2002) initially noted the analogy between linear E-V specifications and PMP models with quadratic cost functions: the quadratic cost term can be interpreted as the variance of wealth, scaled by the risk aversion coefficient. In this sense, the variance term can easily account for nonlinearities in programming models and rationalize the use of a quadratic cost function, which is heuristically interpreted in PMP as the result of decreasing land quality.In a PMP context, Jeder et al. (2011) proposed a two-step procedure for calibrating a linear E-V model. Their method starts with solving their model for different values of φ, in order to achieve the best approximate fit to base year observations. A PMP procedure is then used, which adds a quadratic cost function and results in perfect calibration. However, the use of PMP implies that the risk aversion coefficient recovered in the first step may be arbitrary because PMP will allow the model to calibrate regardless of the chosen value of φ. Additionally, a φ value which gives a perfect fit will negate the need for introducing a quadratic cost function in the model. This argument suggests that calibration problems are primarily (or even exclusively) assumed to be caused by a farmer’s risk considerations, whereas the PMP literature identifies various additional reasons (e.g. parameter misspecifications).Another example of calibrating a linear E-V model with PMP is given by Cortignani and Severini (2012) who model farmers’ participation in revenue insurance schemes. Their approach relies on the use of a full matrix of supply elasticity priors for the estimation of an additional quadratic cost function with maximum entropy.66The rationale of combining supply elasticities with PMP is discussed in Section 3.3.However, the variance term is omitted from the definition of the elasticity matrix which means that the model’s true supply response is inconsistent with the elasticities against which it is calibrated.All calibration methods presented in the previous paragraphs concern linear E-V models and share the common assumption that the mean and variance of wealth are known a priori. Calibration thus focuses on finding the “true” value of the risk aversion coefficient and/or the estimation of a quadratic cost function. However, it is obvious that the principle of using the first order conditions for calibration, either directly or through a two-step PMP procedure, cannot be easily implemented in linear E-V models because the recovery of the risk aversion coefficient is not a trivial task. Especially in the two-step PMP approach, φ needs to be estimated beforehand; adding a quadratic cost function in a linear E-V model still requires a reliable value for φ in the initial calibrating step.Perhaps more important than the calibration problems are the two problematic assumptions on which linear E-V models are based, namely the normal distribution of wealth and the exponential utility function, both of which cannot be easily accepted. Starting with the former, Ramirez et al. (2003) reject the distributional normality of crop yields. On the other hand, all exponential (CARA) utility functions imply “zero wealth effects”, a term that is commonly used in risk analysis (Chavas, 2004, p. 39). More precisely, initial wealth, W0, does not appear in the first order conditions of the linear E-V model (7) and therefore it does not affect economic behavior. If W0 is interpreted as subsidies decoupled from production, then a linear E-V model postulates that lump sum payments have no impact on farmers’ production choices, whereas an extensive literature of econometric studies shows the opposite (e.g. Hennessy, 1998; Serra et al., 2006).One solution that will relax the previous assumptions and at the same time negate the need for eliciting an individual’s risk aversion coefficient is the use of a utility function that exhibits decreasing absolute risk aversion under any (empirical or parametric) distribution of wealth. A commonly used DARA function is the logarithmic one, which is concave in W, with U′ > 0 and U′′ < 0 (decreasing marginal utility of wealth). Its disadvantage is that it cannot be defined at a zero wealth level and that relative risk aversion is invariant to wealth.77As stated by Tsiang (1972, p. 357), an ideal utility function must exhibit decreasing absolute risk aversion and increasing relative risk aversion and thus should lie somewhere between the negative exponential and the logarithmic one.From Eq. (6) and for the logarithmic utility function U = ln (W0 + g⊤x), the maximization of E-U is approximately equivalent to the maximization of the certainty equivalent which can be expressed in a nonlinear E-V form as:(9)maxx≥0CE=W0+g¯⊤x−12x⊤Vx(W0+g¯⊤x)s.t.Ax≤b[z]According to the theory of PMP, program (9) may not calibrate due to various reasons like data errors and unknown information (implicit marginal costs that are only perceived by the farmer and do not appear in farm accounting data). Starting with the former, expected profits are usually defined asg¯=r¯−c,wherer¯=E[r]is the I × 1 vector of expected activity revenues.88We consider activity costs to be non-random. According to Antle (1983), this assumption is justified because in static decision models all input prices are known when decisions are made.In most E-V models,r¯is calculated from time series data of prices and/or yields that are often available only at the national or regional level and concern average values. However, these “average” distributions may be unsuitable for farm models because the variability of prices and (especially) yields among different farms can be substantial. Additionally, when these national averages are lower than the observed farm values in the base year, then they may result in a negative profit per hectare. Negative profits return zero levels for the corresponding activities at the optimum, although positive activity levels are observed. Such a discrepancy provides a strong indication of misspecified revenue and profit distributions which must be corrected before the E-V model can be considered operational. In modeling terms, the distribution of prices and yields must be re-estimated because the “true” vector of expected revenues (which we will denote byr^) may be generally different thanr¯. Obviously, the same applies for the covariance matrix V, which may be different than the “true” matrix (which we will denote by S), presumably known to the farmer.Furthermore, although E-V models imply the use of the distribution mean as the expectation of activity profits, this may not always be appropriate, especially in the case of historical trends, or farmers’ subjective information and beliefs (McCarl and Spreen, 2003). For example, Brink and McCarl (1978) consider the expected value of activity profits to be “unrealistic” and suggest instead a five-year moving average. In a PMP context, the discrepancy between the historical and the “true” profit expectation is attributed to the existence of additional implicit information which is represented by nonlinearities in the objective function. Although nonlinearity in LP models is required for calibration, E-V models are intrinsically nonlinear with respect to x, which means that any additional implicit costs need not be nonlinear (increasing) for the model to calibrate. Hence, for simplicity we assume that these costs are linear (q⊤x), so that the farmer’s implicit expected profits are given byg^=r^−c−q.Linear (constant) implicit marginal costs can be interpreted as the result of various socio-economic and/or technical factors. For example, agronomic issues like soil suitability may lead to high opportunity costs and therefore render some activities less preferable to others. Another example is a farmer’s high shadow (own) cost of labor in crops that are labor intensive (e.g. tobacco). Whatever the origin of these implicit costs, they increase the risk aversion coefficient of a farmer with a logarithmic utility function and therefore affect economic behavior.99For terminal wealth W, the risk aversion coefficient of a farmer with a logarithmic utility function is equal to 1/W. These implicit costs reduce the level of W and therefore the risk aversion coefficient increases.It is interesting to note that the problem of inappropriate historical data which we develop in this section is not new to portfolio theory. In fact, it has been shown that estimation errors in moments of wealth distributions, in particular the distribution mean, can often lead to sub-optimal portfolios (e.g. Best and Grauer, 1991). Therefore the research for methods that mitigate such data problems remains a contemporary issue in the relevant literature (e.g. Levy and Levy, 2014).The previous discussion outlines the working hypothesis of our approach: a nonlinear E-V model will reproduce observed activity levels only if the analyst has acquired information on (i) the “true” distribution of activity revenues and (ii) possible implicit marginal costs. In other words, these parameters need to be estimated so that the first order conditions are exactly satisfied at x0. For this purpose we follow the typical two-step PMP procedure, starting with program (9) and add calibration constraints that bind all activities at their observed level:maxx≥0CE=W0+g¯⊤x−12x⊤Vx(W0+g¯⊤x)s.t.Ax≤b[z]andx≤x0+ɛ[h]Parametersg¯and V are assumed to be exogenous and are calculated from national or regional annual data for prices and yields. The first order conditions of this initial bounded model for a maximum at x0 define that:(10)g¯−Vx0W0+g¯⊤x0+12g¯(x0⊤Vx0)(W0+g¯⊤x0)2−h−A⊤z=0Let us consider now the CE problem that includes the vector of “true” (implicit) profitsg^and the matrix S and reproduces base-year observations without using the additional calibration constraints. Since the model calibrates, the first order conditions are satisfied at x0:(11)g^−Sx0W0+g^⊤x0+12g^(x0⊤Sx0)(W0+g^⊤x0)2−A⊤z=0Using a PMP rationale, we can combine Eq. (10) with (11) and obtain the following equation which is analogous to Eq. (5) in the standard quadratic-cost PMP model:(12)g¯−Vx0W0+g¯⊤x0+0.5(x0⊤Vx0)g¯(W0+g¯⊤x0)2−h=g^−Sx0W0+g^⊤x0+0.5(x0⊤Sx0)g^(W0+g^⊤x0)2Due to negative degrees of freedom, the estimation of the unknown parameters in Eq. (12) is performed with a ME program, as in the case of typical PMP formulations with a fully specified L matrix. Starting with vectorr^and matrix S, consider the case of both price and output uncertainty and assume that prices and yields for a single farm are independent random variables.1010Independence translates to zero correlation between prices and yields and thus farms are assumed to be price takers. Although this assumption was made for simplicity, it is justified when market prices are determined at the international level or in the case of stabilization mechanisms (e.g. floor and ceilings prices for cereals in the European Union).When national data on prices and yields over a sample period of T years are available for each crop, the corresponding “true” values for the farm in any given year should be equal to that year’s statistic multiplied by a percentage error term that represents the numerical distance between the two values. Therefore, if we denote the national price for crop i at year t byp¯it,then the “true” price for the farm at the same year will be equal top^it=p¯itepit,whereepitis the corresponding error term. The same procedure can be applied for crop yields, i.e.,y^it=y¯iteyit,wherey¯itis the national yield average andeyitthe error term. As a result, the “true” revenue of crop i at year t is calculated asr^it=p^ity^itand the corresponding “true” average revenue over the sampling period (i.e. the elements ofr^) asr^i=1/T(∑tr^it).Contrary to the estimation ofp^itandy^it(and therefore ofr^and S), the selection of appropriate supports for vector q is a completely subjective issue. Nevertheless, we decided to use a simple rule of thumb, numerically defining q to be less or equal than the expected crop accounting profits,r^−c,so that the expected implicit profitsr^−c−qremain positive. Hence the additional implicit marginal cost for an activity i is defined asqi=(r^i−ci)eqi,where ciis the ith element of vector c, while eqiis the corresponding error term, with 0 ≤ eqi< 1.In a maximum entropy framework, every error term is expressed as the expected value of an unknown discrete probability distribution over a vector (or interval) of discrete support points. Letπpikt,πyiktand πqikbe the kth elements of the unknown probability distributions for prices, yields and implicit costs. Accordingly,zpnkt,zyiktand zqikrepresent the respective elements of the discrete support vectors which are specified in the feasible range of the unknown parameters and are defined a priori by the researcher. In this sense, the selection of appropriate support values constitutes the most subjective and controversial aspect of the entropy method because estimation results are not invariant to the chosen support intervals. For example, Golan et al. (1997) showed that narrow intervals can greatly increase the mean square error of the ME estimator for a Tobit specification, while Léon et al. (1999) proposed the use of wide intervals in order to prevent any infeasibility problems and allow for an optimal solution to the ME program. More recently, Caputo and Paris (2008) provided analytical qualitative results for the sensitivity of the coefficients of the general linear regression model with respect to different support priors.Assuming that the parametersg¯and V are known (calculated from national valuesp¯itandy¯it), the entropy maximization problem can be written as:maxπpikt,πyikt,πqik≥0H=−∑i,k,tπpiktln(πpikt)−∑i,k,tπyiktln(πyikt)−∑i,kπqikln(πqik)s.t.epit=∑kzpkπpikt,∑kπpikt=1,p^it=p¯itepiteyit=∑kzykπyikt,∑kπyikt=1,y^it=y¯iteyiteqi=∑kzqkπqik,∑kπqik=1,qi=(r^i−ci)eqir^it=p^ity^it,r^i=1T∑tr^it,g^it=r^it−ci−qi,g^i=1T∑tg^itSi2=1T−1∑t(g^it−g^i)2,Sij=1T−1∑t[(g^it−g^i)(g^jt−g^j)]g¯−Vx0W0+g¯⊤x0+0.5(x0⊤Vx0)g¯(W0+g¯⊤x0)2−h=g^−Sx0W0+g^⊤x0+0.5(x0⊤Sx0)g^(W0+g^⊤x0)2∀i,j∈I,∀k∈K,∀t∈Twhereg^itis the implicit profit of crop i at year t,g^iis the mean of the distribution of implicit profits,Si2is the profit variance for crop i (the diagonal elements of matrix S) and Sijis the covariance of profits for crops i and j (the off-diagonal elements of S, for i > j).A serious shortcoming of the standard PMP procedure is the estimation of a large number of unknown parameters under negative degrees of freedom; a single observation does not provide enough information for controlling the second order properties of the final model. A solution proposed by Helming et al. (2001) is to calibrate against supply elasticity priors. The idea behind this calibration method is that an elasticity matrix E can be defined as a function of the model’s unknown parameters. If the analyst has prior information on these elasticities, an analytical expression of E that contains the unknown parameters can be used either directly as an estimating equation or as an additional constraint to the model’s supply response.The elasticity method was later adjusted by Heckelei (2002) for a “non-myopic” calibration, while Mérel and Bucaram (2010) and Mérel et al. (2011) further examined the mathematical conditions under which, models with quadratic-cost and production functions with constant elasticity of substitution can be exactly calibrated against own-supply elasticity priors. A “non-myopic” calibration takes into account the effect of changes in activity profits not only on output, but also on the dual values of the limiting resources: using the notation introduced in the previous sections, the activity vector x depends on g and z, while the resource duals themselves are a function of g.In the related PMP literature, the derivation of an analytical elasticity equation starts with a closed form expression of the activity vector x which is then differentiated with respect to g. Due to strong nonlinearities, this is not possible for the DARA model and therefore the implicit function theorem is required. A similar solution has been applied by Mérel and Bucaram (2010) for calibrating a general production model with own-supply elasticity priors. In the present paper we use the implicit function theorem for deriving an analytical expression for a full elasticity matrix and apply it to the nonlinear E-V model. More analytically, we implicitly define the first order conditions of the final calibrated model with respect to x as a vector functionF:R+2I+M→RIand assume that pointΩ=(x0,g^,z^)is a solution to F(x, g, z) = 0. In other words, Eq. (11) must be exactly satisfied for the observed activity vector x0, the “true” profit vectorg^and the “true” shadow prices of the resource constraintsz^. According to the implicit function theorem, if the Jacobian matrices ∂F/∂x and ∂F/∂z evaluated at Ω are invertible, then there exist C1 functions defined on an open ball about Ω:z=Z(g)andx=X(z,g)withz^=Z(g^)andx0=X(z^,g^)that satisfy the following conditions:(13)F(x0,g^,Z(g^))=0(14)F(X(g^,z^),g^,z^)=0Using the chain rule, the total derivative of (13) with respect to g around point Ω results in:(15)∂F∂g+∂F∂z∂Z∂g=0⇒∂Z∂g=−(∂F∂z)−1∂F∂gTaking the total derivative of (14) with respect to z around Ω we obtain:(16)∂F∂x∂X∂z+∂F∂z=0⇒∂X∂z=−(∂F∂x)−1∂F∂zSimilarly, differentiating (14) with respect to g:(17)∂F∂x∂X∂g+∂F∂g=0⇒∂X∂g=−(∂F∂x)−1∂F∂gIn the previous equations, the partial derivatives of F with respect to each of its arguments at Ω are given by the following expressions:(18)∂F∂x=−SW0+g^⊤x0+Sx0g^⊤+g^x0⊤S(W0+g^⊤x0)2−g^(x0⊤Sx0)g^⊤(W0+g^⊤x0)3(19)∂F∂g=II+Sx0x0⊤+0.5II(x0⊤Sx0)(W0+g^⊤x0)2−g^(x0⊤Sx0)x0⊤(W0+g^⊤x0)3(20)∂F∂z=−A⊤where IIis the I × I identity matrix.From Eqs. (15)–(17) the total effect of g on x can be written as:∂x∂g=∂X∂g+∂X∂z∂Z∂gAs a result, the full profit elasticity matrix implied by the model, evaluated at point Ω is calculated as:(21)E^=(∂X∂g+∂X∂z∂Z∂g)∘g^x0where ○ is the element-wise operator (the Hadamard product).In Eqs. (15) and (20) note that since ∂F/∂z = −A⊤ is an I × M (not necessarily square) matrix, then (∂F/∂z)−1 is the M × I left inverse of − A⊤, such that ( − A⊤)−1( − A⊤) = IM, where IMis the M × M identity matrix. Because there exists an infinite number of left inverses, in this paper we will consider only the (AA⊤)−1( − A).Eqs. (18)–(21) can be used as additional constraints in the ME program, so that the estimated model be made consistent with the predefined elasticity matrix. However, we do not seek to exactly calibrate against the supply elasticity priors. Instead we approximate these priors, around which we construct confidence intervals for the model’s “true” supply elasticities.1111The same method was used by Heckelei (2002) who calibrated a quadratic-cost model using maximum entropy and a full matrix of prior elasticities. The final model’s implied elasticities were defined using the priors as a central point.The main reason for this choice is that calibration might not be guaranteed by any given set of exogenous supply elasticities and thus numerical deviations from it may be required (Mérel et al., 2011). In computational terms, defining intervals instead of selecting single elasticity values “loosens” the model’s constraints and facilitates the finding of a feasible interior solution in an already numerically challenging program which involves a matrix inversion operation (that of ∂F/∂x). Another option for mitigating the computational problems of model solving is to limit the use of priors to own-supply elasticities only. Mérel and Bucaram (2010) argue that this choice can also be motivated by the unavailability of appropriate priors and in no case is it implied that the cross-supply response of the final model is zero.In order to incorporate elasticity confidence intervals in the ME program, the model’s implied supply elasticitiesE^ijare parameterized as the expected values of a discrete probability distribution πeijkover a vector of support points zeijk, such thatE^ij=∑kπeijkzeijk,with ∑kπeijk= 1. Furthermore, the objective function of the ME program is modified since entropy now also depends on πeijk:H=−∑i,k,tπpiktln(πpikt)−∑i,k,tπyiktln(πyikt)−∑i,kπqikln(πqik)−∑i,j,kπeijkln(πeijk)To provide an example of the proposed calibration method, we selected a former tobacco growing farm from the Karditsa prefecture of Thessaly, Greece. Farm data, presented in Table 1, correspond to the year 2006 and include information on single farm payment (SFP) entitlements, which we assume that they correspond to the farmer’s initial wealth, W0. The high SFP entitlement amounts at almost 77 percent of the farm’s annual income and thus provides the appropriate setting for demonstrating how the nonlinear E-V model can capture the effect of decoupled payments on production choices.To calculate the initial V matrix, we used national averages on (deflated) prices and yields for the years 1996–2005 from the website of the Greek Ministry of Rural Development and Food, which are reproduced in Table 2.Note that with the data presented in Table 2 and under the assumption of nonrandom variable costs, a simple calculation reveals that the expected profit per hectare of durum wheat is negative and equal to − 23.9 euro/hectare, whereas the observed profit is positive and amounts at 184.8 euro/hectare (Table 1). This discrepancy clearly demonstrates the possibility of erroneous model parameters and stresses the need for re-specifying the underlying distributions.For simplicity reasons, our illustrative example uses only a land constraint.1212The model was written in GAMS and solved with the CONOPT3 solver. The script is available upon request from the authors.In order to force the model to reproduce base year observations in the first PMP step, the calibration constraints for activities with negative profits (x−) were redefined asx−≥x0−−ɛ,thus setting a lower bound to the optimal activity levels.1313A similar constraint is used in Kanellopoulos et al. (2010) who include a land renting activity in their objective function in order to separately calibrate activities with profits lower than the average.Conversely, activities with positive expected profits (x+) retain the formx+≤x0++ɛ. The dual vectors for the calibration constraints are represented by h− and h+ respectively. The h+ vector produced in the first PMP step consists of only one non-zero element, namelyhcotton+=260.7euro/hectare. The lower bound calibration constraint is binding for wheat and results in a dual ofhwheat−=−28.5euro/hectare. Therefore the remaining activity, maize, is constrained by land availability.Two support points (K = 2) were selected for the estimation of the “true” price and yield distributions. For crop prices, we chose the support range [0.90, 1.10] which implies that the “true” farm prices lie within ± 10 percent of the national averages. For yields, we chose the support vector [0.75, 1.25] so that the resulting values are inside a ± 25 percent interval, centered around the national yields. Finally, vector q was defined to be numerically less than the accounting crop profitsr^−c. Therefore, the chosen support range was [0, 0.9].Calibration was performed initially without elasticity priors (M1 model) and then with elasticities (M2 model). The support range for the own-supply elasticities was defined as [0, 3] and for the cross-supply elasticities as [ − 3, 3]. These priors are indicative and do not correspond to any real estimates. However, although their choice was primarily based on computational convenience, comparable values can be found in Heckelei (2002).Solving the ME program resulted in the error terms which are presented in Table 3. As expected, the errors for the M2 model are generally larger than those of the M1 model. This is the result of the additional constraints for the elasticity definitions which require larger deviations from the centre of the support intervals in order to return a feasible solution.With the estimated error terms for prices and yields, the model’s implied own-supply response was revealed and the farm’s “true” wealth distribution was recovered, resulting in the profit covariance matrices presented in Table 4. To improve readability and to demonstrate clearly the differences between the initial V and the estimated S matrices of the two calibrated models, both the corresponding correlation and covariance matrices are illustrated.The estimated activity revenues, the implicit marginal costs and the final implicit profits for the two calibrated models are presented in Table 5.Finally, the estimated elasticity matrices for the two models are given in Table 6, where it is obvious that the supply response of the M2 model is constrained within the limits defined by the elasticity priors. On the contrary, the response behavior of the M1 model can be characterized as “unrealistic”, since the resulting elasticities are numerically very large. This observation highlights the main shortcoming of the standard PMP procedure, which is its inability to provide second order structure to the calibrated model.Nevertheless, an important issue is whether or not the predefined elasticity values actually reflect farmers’ behavior: economic theory dictates the estimation of elasticities by means of econometric analysis of time series or panel data and this implies that the estimates are valid only for the period from which the data set for estimation is drawn. On the other hand, behavioral mathematical programming models are built with single year observations. Their advantage, especially when applied in times of drastic policy changes, lies on their ability to generate optimal solutions that are substantially different from previous practices. This means that the accuracy of a programming model can only be determined by ex-post validation. For the above reasons we cannot consider the resulting elasticity matrices as indications of a “good” or a “bad” model.To verify that our PMP procedure works, we solve the final calibrated CE models M1 and M2 with the previously estimated parameters, obtaining optimal solutions that in both cases reproduce the activity levels observed in Table 1.Since the final goal of using a DARA utility function is to capture the wealth effects that are ignored in typical linear E-V models, we perform a sensitivity analysis in order to examine the calibrated model’s supply response to changes in initial wealth, W0. As stated previously, the latter is assumed to be given by the SFP entitlement (Table 1). For this purpose, we solve the model parametrically for continuously decreasing values of W0. Results, illustrated in Fig. 1, indicate that reducing W0 leads to significant changes in the farm’s crop patterns, although the M2 model displays a more moderate response compared to M1. Regarding each crop, we observe that land allocated to cotton (the crop with the highest variance in both calibrated models) decreases in an attempt to reduce downside risk. On the contrary, wheat is the crop with the lowest profit variance in both models and thus its surface increases. Finally, the response of maize is different in the two models, since in M2 its surface increases, whereas in model M1 it decreases and finally disappears when W0 is reduced by more than 35 percent.

@&#CONCLUSIONS@&#
In this paper we present a PMP method for calibrating E-V programming models. Our approach is based on a nonlinear E-V specification derived from a logarithmic utility function and leads to an endogenous definition of the (decreasing) risk aversion coefficient. The DARA model seems more flexible in applied research since the amount of final wealth determines a farmer’s degree of risk aversion and therefore allows for investigating the effect of nonstochastic wealth (or equivalently, decoupled payments) on production choices. On the contrary, deterministic PMP models and typical E-V specifications are incapable of capturing such a response because initial wealth enters the objective function linearly.For calibration, we refrain from introducing further nonlinearities in the model and instead we focus on correcting misspecified moment parameters of the wealth distribution. To this end, a maximum entropy program is used for the recovery of possible implicit marginal costs and of the “true” distributions of prices and yields. Unlike classical PMP models with quadratic cost functions, the implicit costs are assumed to be linear since the nonlinearity requirement of the objective function is already satisfied by the variance term. For estimation, crop prices and yields are defined around prior distributions, while implicit marginal costs are set to be less than the “true” accounting profit expectations. We also show how the implicit function theorem can be combined with the PMP algorithm in order to calibrate the nonlinear E-V model against supply elasticities.One important shortcoming of our approach, inherited by its deterministic PMP origins, is that the second order properties of the estimated model cannot be easily controlled. Although this shortcoming can be mitigated by calibrating against supply elasticity priors, strong nonlinearities may lead to a computationally challenging ME program. For this reason we choose to approximate rather than to reproduce the predefined elasticities. Yet despite the computational problems that may occur, our illustrative example clearly shows that nonlinear E-V models are appropriate for policy analysis in the current CAP setting and that they can be calibrated by correcting possible misspecification problems which are usually ignored in typical linear E-V applications. This model choice can improve the validity of the results because wealth effects that would otherwise be ignored are presumably captured.