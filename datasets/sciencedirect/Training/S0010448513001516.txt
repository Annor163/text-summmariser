@&#MAIN-TITLE@&#
Efficient energy evaluations for active B-Spline/NURBS surfaces

@&#HIGHLIGHTS@&#
Efficient Active B-Spline/NURBS energy evaluations based on an Analytic Solution.Efficient algorithm for computing the stiffness of an Active B-Spline/NURBS Surface.Accurate and stable algorithms for computing integrals of B-Spline Basis Functions.Detailed analysis of computational efficiency, accuracy and stability.Up to four times faster than standard Gaussian Quadrature for practical cases.

@&#KEYPHRASES@&#
B-Splines,NURBS,Surface deformation,Deformable model,

@&#ABSTRACT@&#
The construction of the stiffness matrix associated with an Active B-Spline/NURBS surface is one of the most important but time consuming operations performed in CAD/CAM/CAE. This paper aims to address this problem and presents a novel, computationally efficient, generalised mathematical framework and accompanying algorithms based on an analytic solution to the problem. The approach is shown to extend seamlessly to the problem of computing mass, damping and forcing matrices, and importantly, can handle variable mass, damping, and stiffness coefficients. The capabilities of the algorithms are illustrated and their respective performances verified through detailed analysis of the computational efficiency, accuracy and stability in several practical case studies. The main benefit of the proposed approach is a reduction in computation times required for the evaluation of the stiffness matrix by up to a factor of 4, over the standard Gaussian Quadrature approach, for the practical cases considered, while preserving a high degree of accuracy and stability. Additionally, no assumptions regarding the problem complexity, degree, or regularity of the knot vector are imposed upon the solution in order to achieve the computational saving.

@&#INTRODUCTION@&#
The use of techniques based on energy minimisation for the implementation of physically aware deformable models is widespread across the domains of Computer Aided Design, Computer Graphics, and Computer Vision. Due primarily to the myriad of applications, the study of deformable models is one of the most active research topics in computer graphics.The key component to imparting physical properties on a geometric model is the construction of the stiffness matrix. The generation of the stiffness matrix is one of the more time-consuming operations in computer-based modelling applications. For interactive applications such as virtual sculpting or prototyping, performance is key and waiting long periods of time for models to respond to changes made is highly undesirable. George Allen, Chief Technologist and Technical Fellow at Siemens PLM Software, recently addressed the academic research community, where he talked about what he saw as the big geometric modelling problems in industrial CAD/CAM/CAE software  [1]. Allen cited performance as one of the key issues stating that ‘Lack of real-time response makes some exploratory functions unusable, and this impairs user creativity’.In CAD/CAM/CAE, computationally efficient bi-parametric B-Spline representations, particularly NURBS (Non-Uniform Rational B-Splines), are the dominant technology. While the study of efficient techniques for the construction of the stiffness matrix has been an active area of research since the introduction of computer based deformable models in the early 1980s, the recent popularity gain experienced by Isogeometric Analysis has instigated a spurt of new research activity for the specific problem of minimising the energy of an Active B-Spline/NURBS Surface [2–4]. There are several popular approaches ranging from indirect approaches that operate on the geometry rather than the controls to approaches that target the controls directly. Irrespective of the approach adopted, numerical methods  [5] are often favoured for their ‘black-box’ solution with universal applicability. A disadvantage of such generic numerical approaches is that they typically surrender a-priori knowledge of the system. Consequently, to achieve the levels of accuracy often deemed necessary, large numbers of discrete data points must be processed resulting in computationally expensive algorithms. Analytic solutions, where possible, can offer significant computational savings  [2].This paper aims to address this problem and presents a novel, generalised analytic mathematical framework complete with accompanying algorithms for the computationally efficient generation of the stiffness matrix associated with an Active B-Spline surface model. The approach is shown to generalise to the problems of computing mass, damping, and forcing matrices. It is also demonstrated that the approach can cope with variable mass, damping, and stiffness coefficients. Further to this is its extension for the important special case of an Active NURBS surface using the approximation properties of B-Splines  [4,6]. No assumptions regarding the problem complexity, degree, or regularity of the knot vector are imposed on the solution. To illustrate the capabilities of the algorithms and verify their respective performances, several case studies are presented and detailed analysis of the computational efficiency, accuracy and stability is undertaken.

@&#CONCLUSIONS@&#
This paper presents a novel direct Analytic approach, and accompanying algorithm to address the problem of efficiently computing the stiffness matrix associated with an Active B-Spline/NURBS Surface. The proposed approach is shown by experiment to significantly outperform the Gaussian Quadrature approach in terms of computational efficiency, while preserving high levels of accuracy and stability. Additionally, unlike existing approaches, no assumptions about the regularity of the Active Surface are made in order to achieve the computational savings. The approach is shown to generalise to the problems of computing mass, damping, and forcing matrices. It is also demonstrated that the approach can cope with variable mass, damping, and stiffness coefficients. Further to this, an extension to the important case of NURBS is presented and while a direct analytic solution is unavailable for NURBS, it is demonstrated how the Analytic approach for a non-rational B-Spline can be modified to approximate a solution.As part of the development of the Analytic approach, theory relating to the integral and repeated integral of a B-Spline basis function is derived, and efficient algorithms for computing such integrals are developed and shown to be highly accurate and stable. An important special case relating to the repeated differentiation of a B-Spline basis function is identified and algorithms for dealing with the special case are provided.While the Analytic algorithm does not perform as accurately as Gaussian Quadrature in extreme cases, due to the propagation of floating-point errors, the algorithm is shown to achieve very high levels of accuracy up to and beyond most practical cases. Additionally, for interactive CAD prototyping or virtual sculpting applications, compromises on accuracy are often made in practice to achieve acceptable levels of interaction. An analysis of the small numerical error incurred by the Analytic approach identifies the root cause of the error and suggestions are offered as to ways of achieving greater accuracy.Overall, the experiments show that the proposed Analytic approach presented in this paper offers computational savings from 63% to 77%, making the algorithm up to 4.3 times faster for the cases presented, while achieving accuracy to within 0%–10−4% from regular to extreme cases of knot spacing respectively.