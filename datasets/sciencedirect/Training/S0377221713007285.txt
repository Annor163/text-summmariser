@&#MAIN-TITLE@&#
On distributional robust probability functions and their computations

@&#HIGHLIGHTS@&#
Introduce “distributional robust probability function” with input moments.Revisit worst case VaR-portfolio with a new concept (i.e. the existence of zeta).Introduce new computational methods for joint probability moment bounds.The new method is exact, while only approximation is available currently.Three applications are introduced for risk management purposes.

@&#KEYPHRASES@&#
Risk management,Distributional robust,Moment bounds,Semidefinite programming (SDP),Conic programming,

@&#ABSTRACT@&#
Consider a random vector, and assume that a set of its moments information is known. Among all possible distributions obeying the given moments constraints, the envelope of the probability distribution functions is introduced in this paper as distributional robust probability function. We show that such a function is computable in the bi-variate case under some conditions. Connections to the existing results in the literature and its applications in risk management are discussed as well.

@&#INTRODUCTION@&#
One of the tasks in risk management is to manage what to do in all scenarios, especially when worst comes to worst. With reference to a risk measure, a common way to describe “worst-case” is through distributional robustness, which refers to any distribution fitting some given moments, saym0,m1,…,mn. Consequently, the formulation below is often known as the moment bound problem:(GP)supx∼(m0,…,mn)E[ψ(x)]≔supE[ψ(x)]s.t.E[x⊙x⊙⋯⊙x︸#ofx=i]=mi,i=0,…,n.A few words about our notations are in order here. For x∈R, “⊙” denotes the usual scalar multiplication andmi∈Rfor all i, withmi≔E[xi]. For x∈Rd, “⊙” is the tensor multiplication (or matrix multiplication in case d=2) in the corresponding spaces andmi∈Rd×⋯×d︷#ofd=i. For example, if x=[x(1), x(2)]T∈R2, thenx⊙x=xxT=(x(1))2x(1)x(2)x(1)x(2)(x(2))2∈R2×2, which is in the same space wherem2resides. We will use the lower case letters (e.g. m) for scalars and vectors, capital letters (e.g. M) for matrices, and fraktur lower case lettersmfor ambiguous (implied) dimensions.Scarf (1958) was the first to apply this worst-case analysis in inventory management, where he took ψ(x)=min{x, k} for some constant k and assumed the knowledge of the first two moments. Lo (1987) and Grundy (1991) applied the similar concept for option bounds. As a matter of fact, a sizeable amount of relevant literature can be found (see e.g. Chen, He, & Zhang (2011), Cox (1991), Cox, Lin, Tian, & Zuluaga (2008), Han, Li, Sun, & Sun (2005), He, Zhang, & Zhang (2010), Jansen, Haezendonck, & Goovaerts (1986), Liu & Li (2009), De Schepper & Heijnen (2007, 2010), De Vylder & Goovaerts (1982, 1983), De Vylder (1982), Courtois & Denuit (2007), Zymler, Rustem, & Kuhn (2011), Gulpinar & Rustem (2007), Huang, Zhu, Fabozzi, & Fukushima (2011), Pena, Vera, & Zuluaga (2012)) With the recent computational developments of moment bounds, applications have been introduced in different streams in financial engineering. For example, Bertsimas and Popescu (2005) discussed the moment bounds using semidefinite programming and its relevance in probability theory (see also Bertsimas, Natarajan, & Teo, 2006; Popescu, 2007) considered the mean–covariance solutions for stochastic optimization; Chen et al. (2011) as well as Natarajan and Sim (2010) discussed the moment bounds in the context of robust portfolio selection; Wong and Zhang (2013) discussed the moment bounds in the context of nonlinear risk management; Lasserre, Preito-Rumeau, and Zervos (2006) discussed the pricing of a class of exotic options with moments and SDP relaxation. Regarding the theory underlying the computation of moment bounds, we refer the interested reader to Popescu (2005) and Lasserre (2008).In particular, when we chooseψ(x)=1x∈Efor some eventEin the sample space Ω⊆Rdof x, (GP) is the worst-case probability, which can be regarded as an implicit function of the moments, given the eventE:(1)Fd,n(E)≔sup(Rd∋)x∼(m0,…,mn)P[x∈E]=supx∼(m0,…,mn)E[1x∈E].As we shall see later, choosingE={x∈R:x⩽t},F1,2(E)is in fact a probability distribution itself. In general, however, this is not the case; although we always have0⩽Fd,n⩽1, it may not satisfy the additivity of joint countable union, namely, for any countable sequence of pairwise disjoint eventE1,E2,…, we only haveFd,n⋃j∞Ej⩽∑j=1∞Fd,n(Ej).In other words, only subadditivity is guaranteed and the equality holds only when the right hand side is attained by the same extremal distribution of x for allEj.The possibility of deriving an analytical form or devising a simple computational procedure forFd,nremains open for general n and d. Throughout this paper, we adhere our discussion to the case n=2, unless specified otherwise. When d=1 and n=2, there are nice distributional robust functions in analytical form. In our subsequent discussion we will revisit them while applying the Value-at-Risk in the context of portfolio selection. The formulation is in line with El Ghaoui, Oks, and Oustry (2003), who discuss the worst-case Value-at-Risk knowing the first two moments. To the best of our knowledge, even when d=2 there is no analytical form or method for exact computation. The closest approximation is due to Cox et al. (2008), who use sum-of-squares (SOS) polynomials to approximateF2,2(E)for nonnegative random variables, whereE={x∈R2:x⩽tforsomet∈R+2}. In this paper, we propose a computational method, in the realm of semidefinite programming (SDP), to exactly computeF2,2(·). The methodology is based on the characterization of copositive cones in Rd+1, where d⩽3, and some results in Luo, Sturm, and Zhang (2004), which state that, given either (i) x(1)∈[0,1] or (ii) x(1)∈R+, and x(2)∈Rm, the nonnegativity of a bi-quadratic function reduces to LMIs.Before proceeding, let us formally summarize and highlight the main contributions of this paper.1.We introduce the moment bound of the probability as a function given their moments, and formally introduce this function as the distributional robust probability function.In particular for the moment bound of two joint events, Cox et al. (2008) developed an approximation approach through sum-of-squares polynomials. In contrast, we provide an methodology of the exact moment bound in the form of a semidefinite program.In association with risk management, we give three examples as applications of the distributional robust probability functions. Our approach is in particular useful and powerful when involving the bounded events, i.e. (l1⩽x(1)⩽u1, l2⩽x(2)⩽u2).The rest of this paper is organized as follows. In Section 2, we reviewF1,2and its connection to Value-at-Risk in the context of portfolio selection. In Section 3, we derive the LMIs for computingF2,2, where three events are taken into account as our “base cases”:E1≔{x∈R2:x(1)⩽u(1),x(2)⩽u(2)},E2≔{x∈R2:l(1)⩽x⩽u(1),l(2)⩽x⩽u(2)}andE3≔{x∈R2:x(1)⩽u(1),12⩽x⩽u(2)}. Model extensions are introduced in Section 4, followed by applications in Section 5, and finally we conclude the paper in Section 7.TakeE1={x∈R:x⩽t}and let μ1 and σ2 be the mean and variance respectively.F1,2(E1)can be represented as a function of t (Cantelli, 1910; Chebyshev, 1874):(2)F1,2(E1)≔F(t)=σ2(μ1-t)2+σ2,t⩽μ1;1,t>μ1.The above follows essentially from the Chebyshev–Cantelli inequality. An alternative proof can be found in Chen et al. (2011). It is also well-known that this worse-case probability is achieved by a two-point distribution of x. However, the story is completely different when F(t) is regarded as a distribution function of some random variable ζ, since it now has a smooth and continuous distribution (2), which allows us to compute its moments analytically. In the next paragraph, we review the portfolio selection based on worst-case Value-at-Risk. We will use this F(t) in the proof of Lemma 1 to enable a second-order cone programming formulation of the portfolio selection problem. Meanwhile, it is interesting to note that the first two moments of ζ and x are no longer the same:E(ζ)=μ1-π2σversusE(x)=μ1; andE(ζ2)=∞versusE(x2)=μ12+σ2(see Appendix A). Recall that ζ follows a worst-case distribution and represents an extreme event. This infinite variance of ζ actually meets our intuition that an extreme event has a high “fluctuation”.In risk management, as extreme events are often associated with the Value-at-Risk (VaR), let us apply ζ with this risk measure and consider a portfolio selection problem (Castellacci & Siclari, 2003; Goh, Lim, Sim, & Zhang, 2012; Gotoh & Takeda, 2012; Rossello, 2008). Suppose that θ∈Rpis the vector of investment return from p assets with a mean m∈Rpand second moment matrixM∈S+p. Let w∈Rpbe the portfolio weights and x=wTθ the portfolio return. ThenE(x)=wTmandE(x2)=wTMw. ApplyingF1,2(E1)in the definition VaR, where we regard −wTθ as the loss and choose t=−α inE1, we haveVaR∊(wTθ)≔argminα{F1,2(-wTθ⩾α)⩽∊},where ∊∈(0,1) is the level of confidence. The higher the α, the higher the risk. Therefore we would like to minimize the risk over the set of admissible portfolioW(which typically incorporates the target of return, budget constraint and sometimes no short selling constraints) as follows:(3)minαs.t.F1,2(-wTθ⩾α)=F(-α)⩽∊w∈W,where ∊ is given. Recall thatF(-α)=supx∼(wTm,wTMw)P(x⩾-α). Below we show that (3) is a convex optimization model and can be solved efficiently.Lemma 1See also Theorem 1 of (El Ghaoui et al., 2003)Problem(3)can be reformulated by second-order cone programming (SOCP).The assertion follows from the observation thatF(-α)⩽∊⇔wTMw(wTm+α)2+wTMw⩽∊⇔(1-∊)wTMw⩽∊(wTm+α)2⇔wTm+α1-∊∊M12w∈SOC(d+1).Note that we have implicitly assumed −wTm⩽α. OtherwiseF1,2(-wTθ⩾α)=1>∊, which contradicts the definition of VaR. The proof in Lemma 1 can be regarded as an alternative approach compared to that of El Ghaoui et al. (2003). The key difference is that we work with the extremal distributionsupx∼(μ1,Γ)P(E1)=F(t), which makes the proof explicit. (Recall that in El Ghaoui et al. (2003) the strong duality is discussed forsupx∼(μ1,Γ)P(E1).)Let us introduce the worst-case probability of the eventE2≔{x∈R:l⩽x⩽u}as:(4)F1,2(E2)=σ2(l-μ1)2+σ2,μ1<l;1,l⩽μ1⩽u;σ2(μ1-u)2+σ2,μ1>u.The proof is in Appendix B.In this section, we consider three “base-case” joint events:E1≔{x∈R2:x(1)⩽u(1),x(2)⩽u(2)},E2≔{x∈R2:l(1)⩽x(1)⩽u(1),l(2)⩽x(2)⩽u(2)},E3≔{x∈R2:x(1)⩽u(1),l(2)⩽x(2)⩽u(2)}.Our goal is to show the SDP formulations forF2,2(Ek), k=1, 2, 3. Let l≔(l(1), l(2))Tand u≔(u(1), u(2))Tand the mean μ∈R2 and covariance matrixΓ∈S+2of x be given. Recall their primal form,(Pk)supx∼(μ,Γ)P[x∈Ek]≔supx∈PE[1Ek]s.t.E[x]=μE[xxT]=Γ+μμT,wherePin the above is the set of all possible distributions that satisfy the moment condition. Since we can pick any feasible distribution fromPfor the optimal, the bound is known as distributional robust. Another remark is that (Pk) is an infinite dimensional problem that is not trivial to solve. Therefore, we will look into their dual formulation:(5)(D1)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀x⩽u(6)z0+z1Tx+Z2•xxT⩾0∀x∈R2,(D2)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀l⩽x⩽u(7)z0+z1Tx+Z2•xxT⩾0∀x∈R2,(D3)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀x(1)⩽u(1),l(2)⩽x(2)⩽u(2)z0+z1Tx+Z2•xxT⩾0∀x∈R2.Obviously the second constraint in the above formulations are simply LMI. In the mean time, (5) is a copositive constraint (Bomze, 2012; Dur, 2010) in dimension 3×3, thus also an LMI. We will supplement the derivation for completeness. To show that (6) and (7) can be cast into LMIs as well, we base the results on Theorems 1 and 2:Theorem 1c.f. Theorem 4.5 of Luo et al. (2004)Let p(x, y)≔yTCy+2(yTBy)x+(yTAy)x2be defined by p:R+×Rm↦R, where A, B, C are sub-matrices inZ∈L2,mandL2,m≔CBBA∈S2×m:A,B,C∈Sm.Thenp(x,y)⩾0∀x∈R+,y∈Rm⇔Z∈CBBA∈L2,m:CBBA-0EET0⪰0,E+ET⪰0forsomeE.Let p(x, y)≔yTCy+2(yTBy)x+(yTAy)x2be defined by p: [0,1]×Rm↦R, where A, B, C are sub-matrices inZ∈L2,m. Thenp(x,y)⩾0∀x∈[0,1],y∈Rm⇔Z∈CBBA∈L2,m:CB-EB-ETA+E+ET⪰0,E+ET⪰0forsomeE.The key to apply Theorems 1 and 2 into the moment bounds is that we choose y=(1,ξ,…,ξm)T, where ξ∈R, so that p(x, ξ) has a degree 2m−2 in ξ. In other words, it is no longer bi-quadratic. Below we shall show the “conversion” can be done and how the theorems are invoked.Letx=u-x̃. Then rewrite (5) with a few lines of algebra:z0-1+z1T(u-x̃)+(u-x̃)TZ2(u-x̃)=z0-1+z1Tu+uTZ2u-(z1T+2uTZ2)x̃+x̃TZ2x̃⩾0∀x̃∈R+2⇔z0-1+z1Tu+uTZ2u-z1T/2-uTZ2-z1/2-Z2uZ2-N∈S+3,whereN∈R+3×3. Here we use the fact that the copositive coneCm=S+m+R+m×mfor m⩽4. Hence (D1) can be cast as an SDP:(SDP1)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0-1+z1Tu+uTZ2u-z1T/2-uTZ2-z1/2-Z2uZ2-N⪰0,N(ij)⩾0,i,j=1,2,3z0z1T/2z1/2Z2⪰0.We remark here that (D1) can be extended to computeF3,2(E1).Let x(1)=(u(1)−l(1))η+l(1) andx(2)=l(2)+u(2)ξ21+ξ2. Writing the expression in (6) componentwise and multiplying (1+ξ2)2 on both sides, we have(1+ξ2)2(z0-1+z1Tx+Z2•xxT)=(1+ξ2)2(z0-1+z1(1)x(1)+z1(2)x(2)+Z2(11)(x(1))2+(Z2(12)+Z2(21))x(1)x(2)+Z2(22)(x(2))2)=z0-1+z1(1)((u(1)-l(1))η+l(1))+Z2(11)((u(1)-l(1))η+l(1))2(1+2ξ2+ξ4)+z1(2)+Z2(12)+Z2(21)((u(1)-l(1))η+l(1))(l(2)+u(2)ξ2)(1+ξ2)+Z2(22)(l(2)+u(2)ξ2)2=c1(ξ)+b1(ξ)(u(1)-l(1))η+a1(ξ)(u(1)-l(1))2η2,wherec1(ξ)≔z0-1+z1(1)l(1)+Z2(11)(l(1))2(1+ξ2)2+z1(2)+l(1)Z2(12)+Z2(21)(l(2)+u(2)ξ2)(1+ξ2)+Z2(22)(l(2)+u(2)ξ2)2=1ξξ2TC11ξξ2,withC1(∈C(l(1),l(2),u(2)))≔Y∈S3|Y(11)=z0-1+z1(1)l(1)+Z2(11)(l(1))2+z1(2)+l(1)Z2(12)+Z2(21)l(2)+Z2(22)(l(2))2;Y(13)+Y(22)+Y(31)=2z0-1+z1(1)l(1)+Z2(11)(l(1))2+z1(2)+l(1)Z2(12)+Z2(21)(l(2)+u(2))+2Z2(22)l(2)u(2);Y(33)=z0-1+z1(1)l(1)+Z2(11)(l(1))2+z1(2)+l(1)Z2(12)+Z2(21)u(2)+Z2(22)(u(2))2;Y(12)=Y(21)=Y(23)=Y(32)=0,andb1(ξ)≔z1(1)+2Z2(11)l(1)(1+ξ2)2+Z2(12)+Z2(21)(l(2)+u(2)ξ2)(1+ξ2)=1ξξ2TB11ξξ2,withB1(∈B(l(1),l(2),u(2)))≔Y∈S3|Y(11)=z1(1)+2Z2(11)l(1)+Z2(12)+Z2(21)l(2);Y(13)+Y(22)+Y(31)=2z1(1)+2Z2(11)l(1)+Z2(12)+Z2(21)(l(2)+u(2));Y(33)=z1(1)+2Z2(11)l(1)+Z2(12)+Z2(21)u(2);Y(12)=Y(21)=Y(23)=Y(32)=0,anda1(ξ)≔Z2(11)(1+ξ2)2=1ξξ2TA11ξξ2,withA1(∈A)≔{Y∈S3|Y(11)=Z2(11);Y(13)+Y(22)+Y(31)=2Z2(11);Y(33)=Z2(11);Y(12)=Y(21)=Y(23)=Y(32)=0}.By Theorem 2, constraint (6) can be represented by LMIs:z0+z1Tx+Z2•xxT⩾1∀0⩽x⩽t⇔c1(ξ)+b1(ξ)u(1)-l(1)η+a1(ξ)u(1)-l(1)2η2⩾0∀0⩽η⩽1,ξ∈R⇔C1(u(1)-l(1))B1/2-E1u(1)-l(1)B1/2-E1Tu(1)-l(1)2A1+E1+E1T⪰0,E1+E1T⪰0,whereA1∈A,B1∈Bl(1),l(2),u(2),C1∈Cl(1),l(2),u(2).Hence, (D2) is equivalent to the following SDP:(SDP2)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.C1(u(1)-l(1))B1/2-E1(u(1)-l(1))B1/2-E1T(u(1)-l(1))2A1+E1+E1T⪰0,E1+E1T⪰0A1∈A,B1∈B(l(1),l(2),u(2)),C1∈C(l(1),l(2),u(2))z0z1T/2z1/2Z2⪰0.Let x(1)=u(1)−η andx(2)=l(2)+u(2)ξ21+ξ2. Writing the expression in (7) componentwise and multiplying (1+ξ2)2 on both sides, we have(1+ξ2)2(z0-1+z1Tx+Z2•xxT)=(1+ξ2)2(z0-1+z1(1)x(1)+z1(2)x(2)+Z2(11)(x(1))2+(Z2(12)+Z2(21))x(1)x(2)+Z2(22)(x(2))2)=z0-1+z1(1)(u(1)-η)+Z2(11)(u(1)-η)2(1+2ξ2+ξ4)+z1(2)+Z2(12)+Z2(21)(u(1)-η)(l(2)+u(2)ξ2)(1+ξ2)+Z2(22)(l(2)+u(2)ξ2)2=c2(ξ)+b2(ξ)η+a2(ξ)η2,wherec2(ξ)≔z0-1+z1(1)u(1)+Z2(11)(u(1))2(1+ξ2)2+z1(2)+u(1)Z2(12)+Z2(21)(l(2)+u(2)ξ2)(1+ξ2)+Z2(22)(l(2)+u(2)ξ2)2=1ξξ2TC21ξξ2,withC2(∈C(u(1),l(2),u(2)))≔Y∈S3|Y(11)=z0-1+z1(1)u(1)+Z2(11)(u(1))2+z1(2)+u(1)Z2(12)+Z2(21)l(2)+Z2(22)(l(2))2;Y(13)+Y(22)+Y(31)=2z0-1+z1(1)u(1)+Z2(11)(u(1))2+z1(2)+u(1)Z2(12)+Z2(21)(l(2)+u(2))+2Z2(22)l(2)u(2);Y(33)=z0-1+z1(1)u(1)+Z2(11)(u(1))2+z1(2)+u(1)Z2(12)+Z2(21)u(2)+Z2(22)(u(2))2;Y(12)=Y(21)=Y(23)=Y(32)=0,andb2(ξ)≔-z1(1)+2Z2(11)l(1)(1+ξ2)2-Z2(12)+Z2(21)(l(2)+u(2)ξ2)(1+ξ2)=1ξξ2TB21ξξ2,withB2(∈-B(u(1),l(2),u(2)))≔Y∈S3|Y(11)=-z1(1)+2Z2(11)u(1)-Z2(12)+Z2(21)l(2);Y(13)+Y(22)+Y(31)=-2z1(1)+2Z2(11)u(1)-Z212+Z221(l(2)+u(2));Y(33)=-z1(1)+2Z2(11)u(1)+Z2(12)+Z2(21)u(2);Y(12)=Y(21)=Y(23)=Y(32)=0,anda2(ξ)≔Z2(11)(1+ξ2)2=1ξξ2TA21ξξ2,withA2(∈A)≔{Y∈S3|Y(11)=Z2(11);Y(13)+Y(22)+Y(31)=2Z2(11);Y(33)=Z2(11);Y(12)=Y(21)=Y(23)=Y(32)=0}.By Theorem 1, constraint (7) can be represented by LMIs:z0+z1Tx+Z2•xxT⩾0∀-∞<x(1)<u(1),-∞<x(2)<u(2)⇔c2(ξ)+b2(ξ)η+a2(ξ)η2⩾0∀η⩾0,ξ∈R⇔C2B2/2B2/2A2-0E2E2T0⪰0,E2+E2T⪰0whereA2∈A,B2∈-B2(u(1),l(2),u(2)),C2∈C(u(1),l(2),u(2)).Summarizing, the tractable formulation for (D3) is(SDP3)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.C2B2/2B2/2A2-0E2E2T0⪰0,E2+E2T⪰0A2∈A,B2∈-B(u(1),l(2),u(2)),C2∈C(u(1),l(2),u(2)),z0z1T/2z1/2Z2⪰0.For the tight bound of the union of two events, saysupx∼(μ,σ)P(l(1)⩽x(1)⩽u(1)orx(2)⩽u(2)), applying Theorems 1 and 2 to its dual is almost immediate:(8)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀l(1)⩽x(1)⩽u(1)(9)z0+z1Tx+Z2•xxT⩾1∀x(2)⩽u(2)(10)z0+z1Tx+Z2•xxT⩾0∀x∈R2.We can see that Theorem 2 is applied to (8) and Theorem 1 to (9).We can extend to compute the corresponding bound of (Pk), k=1, 2, 3, for nonnegative random variables. The dual formulations are respectively(11)(D1+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀0⩽x⩽u(12)z0+z1Tx+Z2•xxT⩾0∀x(1),x(2)∈R+(D2+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀max{0,l}⩽x⩽u(13)z0+z1Tx+Z2•xxT⩾0∀x(1),x(2)∈R+(D3+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀0⩽x(1)⩽u(1),max{0,l(2)}⩽x(2)⩽u(2)z0+z1Tx+Z2•xxT⩾0∀x(1),x(2)∈R+.Approximations to (D1+) with SOS polynomials are discussed in Cox et al. (2008). Theorem 2 can be applied to (11)–(13) in the same way as that in the previous section. Their second constraint is now a copositive constraint of dimension 3×3, i.e.,z0z1T/2z1/2Z2∈C3,and therefore an LMI. Then the SDP for (Dk+), k=1, 2, 3, are(SDP1+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0-1+z1Tu+uTZ2u-z1T/2-uTZ2-z1/2-Z2uZ2-N1∈S+3,N1(ij)⩾0,i,j=1,2,3z0z1T/2z1/2Z2-N2∈S+3N2(ij)⩾0,i,j=1,2,3,(SDP2+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.C1(u(1)-max{l(1),0})B1/2-E1(u(1)-max{l(1),0})B1/2-E1T(u(1)-max{l(1),0})2A1+E1+E1T⪰0,E1+E1T⪰0A1∈A,B1∈B(max{l(1),0},max{l(2),0},u(2)),C1∈C(max{l(1),0},max{l(2),0},u(2))z0z1T/2z1/2Z2-N∈S+3N(ij)⩾0,i,j=1,2,3,(SDP3+)infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.C1u(1)B1/2-E1u(1)B1/2-E1T(u(1))2A1+E1+E1T⪰0,E1+E1T⪰0A1∈A,B1∈B(0,max{l(2),0},u(2)),C1∈C(0,max{l(2),0},u(2))z0z1T/2z1/2Z2-N∈S+3N(ij)⩾0,i,j=1,2,3.Meanwhile, it is worth noting that the results above imply that we can compute the joint probability bound for two random variables with a variety of support of x(1) and x(2), in any combination:(I)x∈R;x∈R+ (hence any semi-infinite interval);x∈[a, b] for any constant a and b;x∈⋃j=1j¯Ij, where Ij’s can be intervals of the above forms.We have shown that Theorems 1 and 2 can be applied to compute the exact joint probability bound. As a matter of fact, the theorems provide us with the freedom of using either random variable’s higher moments. For example, for the bound ofP(l(1)⩽x(1)⩽u(1),l(2)⩽x(2)⩽u(2)), if we are given the higher moments of x(2), say λ3,…,λn, in addition to μ and Γ, then the dual formulation isinfz0,z1,Z2,z3,…,znz0+z1Tμ+Z2•(Γ+μμT)+∑i=3nziλis.t.z0+z1Tx+Z2•xxT+∑i=3nzi(x(2))i⩾1∀l⩽x⩽uz0+z1Tx+Z2•xxT+∑i=3nzi(x(2))i⩾0∀x(1),x(2)∈R.Every step in the previous setting can be applied and the dimension m in Theorems 1 and 2 now becomes m=n+1.Given any bounded Riemann integrable subsetRof a sample space Ω⊂R2 and the first two moments (μ and Γ) of an arbitrary probability measure of it, we can always approximate the distributional robust probability measure ofRwith finitely many rectangular partitions[x̲i,x¯i]×[y̲i,y¯i]. In other words, there exists m∈N such thatR≈⋃i=1m[x̲i,x¯i]×[y̲i,y¯i]andsup(x,y)∼(μ,Γ)P((x,y)∈R)≈sup(x,y)∼(μ,Γ)P(x,y)∈⋃i=1m[x̲i,x¯i]×[y̲i,y¯i]=infz0,z1,Z2z0+z1Tμ+Z2•(Γ+μμT)s.t.z0+z1Tx+Z2•xxT⩾1∀x∈[x̲i,x¯i]×[y̲i,y¯i],i=1,…,mz0+z1Tx+Z2•xxT⩾0∀x,y∈R.Example 1Suppose x and y are two economic risk factors, and we are interested in the event that (x, y) is inR. In general, there is no way, except for brutal force random sampling, of estimating its probability even given the distribution. If we are given the first two moments and uncertain about the distribution, we can approximate the worst-case probabilitysup(x,y)∼(μ,Γ)P((x,y)∈R)(see Fig. 1).As a matter of fact, this method may be applied to the weather forecast as well. Imagine that SetRis the border of a region, say a country. We can estimate various worst-case probability (of raining, for instance) by gridding the area.Following the previous example, we compare our approximation result with a known method by considering a circular region.1.We will evaluatesup(x,y)∼(μ,Γ)P((x,y)∈R), whereRis a unit circle centered at the origin. Since this can be calculated exactly with the use of the S-Lemma (Pólik & Terlaky, 2007; Yakubovich, 1971, 1977), we can compare the calculation with our approximation with rectangles. The approach is as follows:i.Consider a square (Sq) that is inscribed in the unit circle.The remaining areas (I–IV) are approximated by small rectangles (Sq(θi)) that are parameterized by θ’s (as shown in Fig. 2).For example, choose μ=(2,1) andΓ=1001. The convergence of the approximation is shown in Table 1. With 500 such rectangles, the approximated probability is converged to the exact value calculated with S-Lemma (up to 6 decimal places). With more choices of mean and covariance, the numerical results are given in Table 2.A more meaningful calculation is to evaluate the probability with events (areas) that are not regular. In this regard, we also calculatesup(x,y)∼(μ,Γ)P((x,y)∈III), where III is defined in Fig. 2. Results are shown in the last column of Table 2. Note that for the column “Approx. prob. (circle)” and “Approx. prob. (III)”, we keep using 500 rectangles (plus the inscribed square).VaR is a common risk measure for investment returns. Given the international investment markets nowadays, dependence among investments from different markets has raised a growing concern. Therefore, it is of a great interest to study the VaR of different portfolios simultaneously. Consider two investment markets (i=1,2). Suppose thatθi∈Rpibe the vector of investment return from piassets with a meanmi∈Rpi, second moment matrixMi∈S+pi, and covariance matrix between the two marketsC12∈Rp1×p2. Letwi∈Rpibe the portfolio weights andx(i)=-wiTθithe portfolio return. If α(i) is the VaR of the portfoliowiTθiin the two markets, then we can compute the worst-case probability through (SDP1), in which we takeμ=[-w1Tm1,-w2Tm2]T,Γ=w1TM1w1w1TC12w2w1TC12w2w2TM2w2and u=[α(1), α(2)]T. In fact, (SDP1) allows us to compute the probability exactly (upon machine error) for at most three portfolios under (SDP1).In general, when we let α=α(1)=⋯=α(d), we can define the worst-case simultaneous VaR (WS-VaR) byWS-VaR∊w1Tθ1,…,wdTθd≔argminαFd,2-w1Tθ1⩾α,…,-wdTθd⩾α⩽∊,SinceFd,2-w1Tθ1⩾α,…,-wdTθd⩾αis monotone in α, WS-VaR can be obtained by bisection.Note that in the above definition, only the copositivity is involved and this has not fully utilized the computational advantage of our method, as Theorem 2 or Theorem 1 has not been invoked. However, we can see their powerfulness when we consider a closely related concept – the ruin probability of two assets. Suppose x(1) and x(2) are asset values of two companies. A default occurs when they are below their corresponding threshold levels α1 and α2. By the very definition, an asset must be nonnegative. So we concern the ruin probabilityP(0⩽x(1)⩽α1,0⩽x(2)⩽α2).Example 3The Hong Kong stock market is one of the world’s largest exchanges based on the market capitalisation of its shares.2http://www.hkex.com.hk/eng/exchange/exchange.htm.2Given its location and history, its market movement raises international concern and hence correlated to other markets, especially that in China. Besides the major Heng Seng Index (HSI), there is Hang Seng China Enterprises Index (HKCEI) which reflects the movements of mainland companies listed in Hong Kong. It is of a great interest to study the co-movements of both indices. In this example, based on the first two moments (see Table 3),3We use 5year daily data (2008–2012) extracted from Yahoo Finance.3we calculate the bound B of ruin probabilityP(0⩽HSI⩽α1,0⩽HKCEI⩽α2)given (α1,α2), i.e.P(0⩽HSI⩽α1,0⩽HKCEI⩽α2)⩽B≔F2,2(0⩽HSI⩽α1,0⩽HKCEI⩽α2). In particular, we choose (α1, α2) to be the 5-year minimum, 1%, 5%, 10% and 50% of the current prices (as at December 31, 2012). Results are shown in Table 4. As a reference, the column “Bi-normal” refers to the probability assuming that HSI and HKCEI follow a normal distribution with the same mean and covariance. Meanwhile, the probability of each row is zero based on the 5-year empirical data.Digital options are one of the most common exotic options. Besides being directly traded, they can also be found in structured products such as the range accrual, which is a type of interest rate derivative, and some investment-linked products, which offer attractive payoff when the market meets the pre-specific range. With our approach and given the first two moments of the underlying assets, the bound of digital options with complicated joint numerical ranges can be estimated. Suppose x and y are the assets and one unit is paid off when(x,y)∈B≔⋃i=1m[x̲i,x¯i]×[y̲i,y¯i]. Then we can estimate the boundsup(x,y)∼(μ,Γ)P(1(x,y)∈B).Let us remark that our approach is robust to any (joint) distribution. Compared to simulation approaches, no distribution is assumed so that the implementation may be made relatively easier. Moreover, the pre-specified rangeBcan be as fined as possible to fit the product design, with little marginal computational costs. (Recall the dual form ofsup(x,y)∼(μ,Γ)P(1(x,y)∈B). Each rectangle[x̲i,x¯i]×[y̲i,y¯i]corresponds to a semidefinite cone constraint in a low dimension. Hence, roughly speaking, an additional rectangle should pay little extra computational cost.)Example 4Consider two stocks: Facebook, Inc (FB) and Microsoft Corporation (MC). From their statistics since the initial placement offer of Facebook (see Table 5), we see that the fluctuation (in terms of variance) of Facebook is higher than that of Microsoft. We may capture their comovement by a digital option I with one unit of payoff when FB∈[16,20]∪[36,40] and MC∈[26,30]. In other words, the option tries to capture the payoff under the stable movement of MC (about the mean) together with the wild movement of FC (toward the extremes). Without distribution assumptions, we can estimate the conservative price of the option using their first two moments. Hence, we have from our computation thatI⩽F2,2(FB∈[16,20]∪[36,40],MC∈[26,30])=0.5060. (With the same mean and covariance, (i) bivariate normal distribution with Monte Carlo simulation gives a probability 0.1007, while (ii) empirical probability is 0.1161).In principle, we can follow the idea of this example and create a digital option to capture multiple desired ranges of each stock.To get an impression how the distributional robust probability functions actually look like, we provide some computational results in this section. For simplicity, in our examples we assume the mean to be zero vector and the covariance matrix to be identity, although the technique works for any mean vector and covariance matrix.To start with, we plotF1,2which is readily computable. Fig. 3showsF1,2(x⩽t). To illustrateF1,2(l⩽x⩽u), we fix the interval width between l and u so that they depend on the same parameter. Figs. 4 and 5representF1,2(t⩽x⩽t+1)andF1,2(t⩽x⩽t+10)respectively.Corresponding plots ofF2,2are illustrated in Figs. 6–8. We see that the shape ofF2,2is similar to that ofF1,2in the sense that the latter looks like the cross-section of the former.ForF2,2with random bivariate with different variance and non-zero covariance, plots with positive and negative covariance are illustrated in Figs. 9 and 10respectively.

@&#CONCLUSIONS@&#
