@&#MAIN-TITLE@&#
DNA sequence watermarking based on random circular angle

@&#HIGHLIGHTS@&#
DNA watermarking is for copyright protection and authentication of a DNA sequence.We address the random circular-angle based watermarking for the coding DNA sequence.Our method satisfies amino acid preservation, mutation resistance, and security.Embeddable codons are selected by random mapping table and singularity detection.The watermark changes random circular angles of embeddable codons.

@&#KEYPHRASES@&#
DNA watermarking,Copyright protection,Codon random mapping table,Amino acid residue conservation,Mutation resistance,

@&#ABSTRACT@&#
This paper discusses DNA watermarking for copyright protection and authentication of a DNA sequence. We then propose a DNA watermarking method that confers mutation resistance, amino acid residue conservation, and watermark security. Our method allocates codons to random circular angles using a random mapping table and selects a number of codons for embedding targets using the Lipschitz regularity that is measured from the evolution across scales of local modulus maxima of codon circular angles. We then embed the watermark into random circular angles of codons without changing the amino acid residue. The length and location of target codons depend on the random mapping table and the singularity of detection of Lipschitz regularity. This table is used as the watermark key and can be applied to any codon sequence regardless of sequence length. Without knowledge of this table, it is very difficult to detect the length and location of sequences for extracting the watermark. From experimental results on the suitability of similar watermark capacities, we verified that our method has a lower bit-rate error for point mutations compared with previous methods. Further, we established that the entropies of the random mapping table and the location of target codons are high, indicating that the watermark is secure.

@&#INTRODUCTION@&#
The genetic code contains profound personal information. It may be considered as a personal diary, and its unauthorized disclosure may be considered as a grave invasion of privacy and a violation of human rights. Legal measures have been established to ensure the safety and security of procedures for collecting human genetic information (HGI) [1–3]. There are laws of ethics or guidelines for HGI use, but security techniques for preventing illegal copying and piracy of HGI are urgently required. DNA is considered as a new biometric medium for storing extraordinarily large amounts of data. Thus, DNA storage demands that DNA security techniques are addressed. Recent research on DNA security includes DNA cryptography [4–7], steganography [8–16], and watermarking [17–25] using DNA sequences with a character stream of A, G, T (or U), and C. These studies [4–25] were validated by in vivo, in vitro, or in silico experiments.DNA cryptography [4–7] is a technique for biological encryption and decryption based on the polymerase chain reaction (PCR) or DNA chips and has been recognized as a new biological encryption technique for potential widespread use in the future. However, it has not yet begun to replace the conventional encryption algorithms because of the difficulty in its implementation. DNA steganography [8–16] is the technique for hiding messages in DNA sequences and is useful for DNA signature/identification and DNA storage of vast quantities of information. However, the purposes of DNA cryptography and steganography are not to recover DNA sequences or messages under changing experimental conditions or from mutations, and they are therefore not suitable as applications for copyright protection.DNA watermarking [17–25] is a technique for protecting the information within a DNA sequence. DNA-based watermarks can be applied to copyright-protect DNA sequences as well as for discriminating between wild-type and artificial genomes [25]. Recently, J. Craig Venterʼs research team inserted a watermark at intergenic sites known to tolerate transposon insertions to identify the genome of Mycoplasma genitalium JCVI-1.0 as synthetic [26,27]. Jupiter et al. [28,29] presented the strategy of watermark implementation for tracking select or infectious agents. They suggested five features for implementation strategy as follows: message fidelity, error tolerance, easy interpretation, uniqueness, and resistance. They compared and analyzed the features of DNA and multimedia watermarking. Multimedia watermarking schemes for audio, image, video, and 3D model are mostly processed in the frequency domain of the discrete cosine transform (DCT) [30,31], discrete wavelet transform (DWT) [32–34], and scale-invariant feature transform (SIFT) [35], as well as the geometric domain [36,37]. However, DNA-based watermark must be embedded without changing the function of coding regions, which represents the main difference between DNA and multimedia watermarking.The genome contains all of an organismʼs hereditary information, and it includes coding sequences (genes), which are translated into polypeptide chains (proteins), representing, for example, approximately 1.5% of the human genome. Sequences that do not encode proteins may be transcribed into non-coding RNAs such as micro-RNAs, which may code for RNAs that regulate gene function. The genome also includes pseudogenes, which are mutated remnants of genes that are unable to encode a functional product. The majority of the human genome comprises non-coding repeated sequences. DNA steganography or watermarking methods have been designed differently depending on whether the information is embedded in non-coding [17–20] or coding DNA [21–24].Non-coding DNA-based methods typically assume that non-coding DNA does not change the phenotype of an organism. Based on this assumption, any pirate could substitute an arbitrary sequence or dummy sequence for a non-coding DNA sequence while including embedded sequences without changing phenotype. However, many types of non-coding DNA sequences have known biological functions, including the transcriptional and translational regulation of protein-coding sequences. Non-transcribed DNA sequences may contribute to chromosomal properties or possess functions that are yet to be discovered. Therefore, it is not yet been appropriate to manipulate non-coding DNA for steganography and watermarking.Coding DNA is translated to a polypeptide chain, so the watermark embedded in coding DNA sequences should preserve the protein profile of an organism. This is a prerequisite and a limitation of coding DNA-based methods. We refer to this limit here as amino acid residue (amino acid) conservation. Amino acid conservation is problematic when designing DNA watermarking, in contrast to image and video watermarking.Most conventional DNA watermarking methods focus on the embedding process through simple substitutions or bit allocations to a base or codon as determined by the genetic code, and focus has been placed on watermarked gene in in vivo experiments. Therefore, it is necessary to analyze the resistance to phenotypic change, amino acid sequence conservation, as well as security for signal processing when designing a DNA watermarking method that satisfies the above requirements.Here we present a coding DNA watermarking method for copyright protection of a DNA sequence that provides mutation resistance, watermark security, and amino acid sequence conservation. We analyze the performance of coding DNA watermarking using in silico experiments. The main features of our method are as follows: First, we map codons to numerical values of random circular angles using a random mapping table for security and ease of signal processing. The random mapping table for 64 codons, which includes start and stop codons, is used as the watermark key. Coding sequences of various lengths can be mapped to random circular angles using any random mapping table. Second, we select a number of target codons for embedding using the Lipschitz regularity of local modulus maxima at multi-resolution scales. The local modulus maxima of random circular angles depend on the random mapping table. The length and location of target codons depend on Lipschitz values of local modulus maxima. It is very difficult to detect locations of embedded codons without the knowledge of random mapping table. Third, we embed repeatedly a binary watermark into random circular angles of codons to confer mutation resistance. An angle of a center codon and the distance between two angles of neighboring codons are changed by a bit of a watermark without changing the encoded amino acid. Finally, random circular angles are based on circular coding, which makes the numerical transformation of DNA symbols easier and allows estimation of symbol errors in arbitrary positions. Moreover, it allows the allocation of synonymous codons to neighboring numerical values.The performance of our in silico experiments verified that our method ensures amino acid sequence conservation and is more resist to point mutations compared with DNA-Crypt watermarking [21] and the Liss method [24]. We investigated the capacity based on the analysis by Balado et al. [38–40]. We computed the entropy of the random mapping table and random positions of codons for analyzing security and confirmed that the entropies were high.This paper is organized as follows: In Section 2, we explain the structure of DNA sequences and the genetic code and analyze conventional watermarking methods. We present the proposed DNA watermarking method in Section 3 before analyzing its performance using in silico experiments in Section 4. Finally, are conclusions are presented in Section 5.In this section, we examine the genetic code [41–43] and then analyze the requirements of DNA watermarking for copyright protection of a DNA sequence.DNA is a long polymer that carries genetic information in simple units called nucleotides, the backbones of which are composed of carbohydrate and inorganic phosphate groups joined by phosphodiester bonds. The nucleotide bases are the purines A (adenine) and G (guanine), and the pyrimidines C (cytosine) and T (thymine). Uracil (U) occurs in RNA instead of thymine. Three nucleotides form a codon, the basic unit of the genetic code that specifies one amino acid. Fig. 1shows that the genetic code represents a set of rules, which allows the information encoded in DNA to be transcribed into messenger RNAs (mRNAs) that are translated into polypeptide chains composed of amino acids. This code is called the triplet code. There are43=64different codon combinations, because there are four distinct nucleotide bases. All 64 codons encode one of 20 amino acids or translational stop signals.Table 1shows the correspondence of codons to amino acids (Fig. 1). In this table, the cardinality of synonymous codons in each amino acid is from 1 to 6. ‘ATG’ encoding methionine (‘Met’) is the most frequently used start codon, whereas ‘TAA’, ‘TAG’, and ‘TGA’ for ‘Stp’ are stop codon marking the end of coding regions. Except for start and stop codons and the codon for the tryptophan (W), all codons in coding DNA sequences can be used for watermark embedding, and they can be substituted by a watermark while conserving the amino acid. However, all codons including the excepted codons are allocated to numerical values and circular angles because of computational tractability of numerical mapping.DNA watermarking requires amino acid sequence conservation, mutation resistance, message fidelity, security, capacity, error tolerance, and easy interpretation as follows:•Amino acid conservation: Amino acid sequences into which a host DNA sequence and a watermarked DNA sequence are translated must be the same. Although codons are changed by the watermark, amino acids into which they are translated are not. Amino acid conservation can be similar to invisibility with the high quality constraint of multimedia watermarking.Mutation resistance: Watermarks must resist spontaneous or induced mutations. Thus, watermarks must be extracted from mutated or damaged DNA sequence to certify ownership.Security: Watermarks must be very difficult to extract without the knowledge of the key even if a DNA sequence is known.Message fidelity: Watermarks must not alter the phenotype of an organism. DNA sequences and watermarks do not mutually interfere in a manner similar to amino acid sequence conservation.Capacity: Watermarks must contain enough information for copyrighting. The capacity for watermarking should be considered differently compared with the capacity for steganography.Error tolerance: Errors in the detection of watermarks can occur through mutation by transfer delay and in PCR or organic synthetic reactions. Watermarks must be recovered within the tolerance of detection error and is similar to resistance.Easy delivery/interpretation: A watermarked DNA sequence must be clear and definitive. Detection and delivery of a watermark within an organism must be easy.Amino acid conservation and mutation resistance differ with the requirements of multimedia watermarking. Other requirements are similar between DNA and multimedia watermarking. However, they should be confirmed using different methods, because the embedding targets are different, for example, DNA codons and nucleotide bases versus image pixels and frequency coefficients.Any pirate can use a mutation of the DNA or protein to attack the watermarked DNA sequence. The information in sequences can be changed by mutagens during DNA replication or transcription. Mutations are can be classified as small-scale or large-scale [44,45]. Small-scale mutations involve one or a few nucleotides, and they include point mutations, insertions, and deletions. Point mutations are often caused by a malfunction in DNA replication, and they replace a single nucleotide, which is classified as a transition or a transversion depending on whether the change involves pyrimidines or purines. Insertions and deletions add or remove one or more nucleotide. They can alter the reading frame of the gene, which can generate a protein with either a subtly or dramatically altered sequence [46], but they are rare. The latter may affect chromosomal structure and includes amplifications, deletions, and loss of heterozygosity. We consider only point mutations of small-scale mutations as suitable attacks on DNA watermarking. Mutations can be caused by spontaneous and induced processes. However, any pirate can maliciously produce intentional mutations. If all codons in protein-coding regions are intentionally changed by silent mutations, most watermarks in these regions will be removed. Nevertheless, DNA watermarks must be resistance to spontaneous, induced, and intentional mutations.Watermarking can be classified as private and public, depending on the detection method. The first detects a watermark using the host sequence and the watermark, whereas the second detects the watermark without the host sequence and the watermark. Private watermarking has many problems in terms of security, so DNA watermarking must be public.Research into DNA cryptography or steganography began in the late 1990s, and DNA watermarking has been researched since the late 2000s. Some papers present DNA steganography using watermarking; however, the two should be considered individually. DNA steganography communicates a secret message through a DNA sequence. Therefore, the security and capacity are the main requirements in DNA steganography. However, DNA watermarking is designed for copyright protection of a DNA sequence. Resistance to mutation is the main requirement for DNA watermarking.Clelland et al. [8] presented the first DNA steganography method using DNA microdots, and they implemented the technique in vitro. This method hides a secret message in DNA microdots based on a simple permutation cipher. However, this method requires specific primers to recover the message. Leier et al. [9] mixed binary-encoded plain text with DNA dummy strands in DNA steganography. This method also requires knowledge of primer sequences. Anam et al. [7] reviewed DNA cryptography methods using PCR and DNA steganography methods using DNA sequencing or DNA chip technology. They found that the difficulties of DNA cryptography and steganography were caused by lack of a theoretical basis and practical methodologies that could be readily implemented in the field of information security. Shimanovsky et al. [11] combined codon redundancy with arithmetic encoding and public key cryptography when embedding watermarks into coding DNA sequences. They allocated four bases to 2-bit binaries and converted the binary sequence to a decimal number from 0 to 1, which was used as the target number in repeated subdivision steps of arithmetic encoding. However, this method fails to accurately extract the target number in each step if any codons are mutated. Arita et al. [12] embedded a short signature into the coding DNA sequence of Bacillus subtilis based on the degenerate genetic code and a permutation cipher function. However, this method requires the host sequence to recover the embedded message, which is non-blind.Several methods exist for embedding watermarks into non-coding DNA sequences. Yachie et al. [17,18] redundantly embedded duplicated data encoded by nucleotide sequences into multiple loci of the B. subtilis genome. Heider et al. [19] applied the DNA-Crypt algorithm [20] to non-coding DNA sequences in in vivo experiments using the small cytoplasmic RNA I (scR1) from yeast Saccharomyces cerevisiae and the lac promoter region of Escherichia coli. However, their results show that the watermark can deactivate promoter regions and that it further affected the secondary structures of regulatory RNA molecules, although the watermarked RNA and one of the watermarked promoters were not different from the wild-type RNA and promoter regions, respectively. Therefore, they concluded that watermark embedding is not suitable for regulatory regions such as promoters or other regulatory regions.To embed watermarks in coding sequences, Heider et al. [21] inserted encrypted information into S. cerevisiae using the DNA-Crypt algorithm [20]. This method only produces a protein profile, because they did not consider the redundancy of the genetic code. The DNA-Crypt algorithm allocates four bases{A,C,G,T}to 2 bits and embeds the last base of four synonymous codons into 2 bits of the watermark. This algorithm corrects mutations by any code in which the integrated fuzzy controller decides whether to use the 8/4 Hamming code, n-time WDH code, and no correction code for optimal performance. The binary information can be encrypted by integrating the encryption algorithms AES, Blowfish, RSA, or OTP in DNA-Crypt. However, because the target codons can be easily revealed even if the binary information is encrypted, any pirate can intentionally remove the watermark. Shuhong et al. [23] permuted a third base symbol for codons according to the watermark bit, which was similar to a least significant bit permutation based on Aritaʼs genetic code [12]. This method can only be applied to four synonymous codons. Liss et al. [24] embedded text messages into open reading frames of synthetic genes considering gene optimization. They designed ORFs of the watermarked genes using codon usage table of host genes that were already optimized for protein expression. For example, given a codon usage table for a particular amino acid, odd ranked codons in this table represent a binary 0 and even-ranked codons represent a binary 1. They encoded a text message into four or six synonymous codons that retain a high degree of codon assignment flexibility. However, this method does not consider the mutation resistance and security, although it retains gene optimization. Balado et al. [38–40] used Shannonʼs theory to model the maximum capacity of data with mutation resistance.Conventional watermarking methods for coding DNA have some problems with amino acid conservation, their resistance to mutations, and watermark security. Although the purposes of steganography and watermarking are different distinctly, many DNA watermarking methods hide vast amounts of information without mutation resistance and security, similar to steganography.This paper presents a watermarking method for DNA sequences with the features as follows: 1) Embed the binary watermark into coding DNA sequences. Non-coding DNA sequences are included in regulatory regions such as promoters or other regulatory motifs, so coding DNA sequence are suitable for use as the embedding target. 2) Ensure amino acid conservation and resist small-scale mutations such as point mutations. 3) Use a fixed-length watermark key regardless of the sequence length and ensure high-level security. 4) Directly extract the watermark without the host sequence.Fig. 2(a) shows the proposed embedding process, which consists of the numerical mapping of codons using a random mapping table, the selection of target codons using the Lipschitz regularity of local modulus maxima, the binary embedding in target codons, and the generation of the watermarked DNA sequence. A random mapping table is used as a key for extracting the watermark. The watermark is extracted using a similar process to embedding, as shown in Fig. 2(b).The definitions of terms are as follows: Denote a character symbol as a lower-case Roman letter, a numerical value as a lower-case italic letter, and a set as an upper-case bold letter.–A sequence of codons isC=(ci)1⩽i⩽Nand a sequence of watermarked codons isC′=(ci′)1⩽i⩽N. N is the sequence length.A nucleotide base isb={G,A,C,T}and a codon of triplet bases isc=b1b2b3. Numerical values of a base and a codon are b and c.The amino acid represented by a codon c isS=f(c)andf|C→Sis the translation from codons to amino acids (Table 1).|S|is the number of synonymous codons that are translated to an amino acid S, which is known as the cardinality of an amino acid S.A random mapping table D isD=T′−Tthe difference between a reference code table T and a random code tableT′.A circular angle of a codon value c is θ and a circular angle of a random codon valuecˆon D isθD. A sequence of circular angles isΘ=(θi)1⩽i⩽Nwithout random mapping. A sequence of random circular angles isΘD=(θD,i)1⩽i⩽Non D.Dyadic wavelet transform ofΘDisW2j(ΘD)and the local modulus maxim ofW2j(ΘD)isW2jLM(ΘD).A binary watermark ofNWbits isw=(wk={0,1})1⩽k⩽NWand an extracted watermark isw′.A target codon for 1-bit embedding isck(3)=(ck−1,ck,ck+1)that consists of 3 consecutive codons. The number of target codons is the same as the number of watermark bitsNW.Nucleotide sequences and codon sequences are character strings produced by a combination of G, A, C, T. They must be converted to numerical values when embedding the watermark as binary, integer, or floating type for signal processing.Shimanovsky [11], Heider [20], and Shuhong [23] mapped four nucleotide bases to 2 bits of{00,01,10,11}and converted the nucleotide sequences to binary sequences. Balado [38–40] mapped four nucleotide bases to four integers{0,1,2,3}and converted 64 codons to triplet integer values. However, these methods do not consider the rules of the genetic code and the correlations among synonymous codons. Further, these methods have limited applications in signal processing for watermark embedding.The numerical mapping of codons is a basic step in the identification of protein-coding regions and DNA walks using DNA Fourier [43] or wavelet transform analysis [49,50]. Cristea [47,48] presented the codon code depending upon the base code [T = 0, C = 1, A = 2, G = 3] that is optimally selected under the minimally non-monotonic correspondence between 64 codons and 20 amino acids. Anastassiou [43] mapped four characters to complex values such asA=1+j,T=1−j,C=−1−j,G=−1+j, and analyzed the DNA spectrogram of the complex value sequences using DFT (Discrete Fourier Transform). Similarly, Machado et al. [49] mapped{A,C,T,G}to{1,−1,j,−j}and transformed the complex value sequences to the wavelet domain for the analysis of human DNA sequences. Mena-Chalco et al. [50] segmented the codon sequence to four-base binary sequences and identified the protein-coding regions based on the magnitude of Gabor wavelet coefficients for each of the four sequences.These methods are based on signal analysis using the forward frequency transformation. However, they do not require an inverse transform to generate the host codon sequence. Digital watermarking should generate the codon sequence from the watermarked numerical values using reversible numerical mapping, whereas the forward and the inverse mappings are reversible. Therefore, a DNA frequency transform is not suitable for numerical mapping during DNA watermarking but it may be suitable for detecting the target codons for embedding. Therefore, the proposed method uses a codon-coding table (Table 2) that is suitable for a watermarking system, and it maps 64 codons to integer values of 6 bits based on this table before converting them to circular angles.First, we setb={G,A,C,T}tob={0,1,2,3}and map a codonc=b1b2b3to the integer value c of 6 bits using the polynomial expression.(1)c=42×b1+41×b2+40×b3We then transform c to the circular angle θ, as shown in Fig. 3(a).(2)θ=2cπ64or2cπ64−2πThis figure illustrates an example of circular angles generated by the reference code table T. θ is re-allocated to an angle such that the difference from the codon angleθ−1of two angles is small.(3)θ={2cπ64,if|2cπ64−θ−1|<|2cπ64−2π−θ−1|2cπ64−2π,if|2cπ64−θ−1|>|2cπ64−2π−θ−1|A codon c can be easily recovered from a circular angle θ using inverse mapping. From Eq. (3), the integer value c can be obtained as follows.(4)c={642πθ,ifθ>0642π(2π+θ),otherwiseThree bases of a codonc=b1b2b3are(5)b1=⌊c42⌋,b2=⌊c%424⌋,b2=(c%42)%4We refer to the sequence of circular angles for a codon sequence as the numerical sequence. Table 2 shows the reference code table T for 64 codons. This table can be varied in the order{G,A,T,C}. T is selected as one among 24 tables. Thus, a codon is coded to c by the sequential mapping of three bases. Because the integer value c of the codon is simply a code value that is similar to the decimal point in ASCII code, it has nothing to do with the physical quantity.The features of our codon-coding method are as follows:(1)Generally, the numerical codes of six synonymous codons are separated into two groups. The code separation, which depends on the method for codon mapping, should be minimized for facilitating the processing for DNA watermarking. In our method, most synonymous codons come together in one place, except for the codons for ‘Ser’ and stop codons. Codons can be grouped to the center points of each amino acid region much like vector quantization (VQ), so that the embedding process is simple when viewed as signal processing. For example, the synonymous codons in ‘Arg’ are bound to(x00,x01,202,203),x=1,2, and the synonymous codons in ‘Leu’ are bound to(x30,x31,232,233),x=2,3. As mentioned in the next section, we group together ‘Ser’ and stop codons using random mapping.Forward and inverse mapping between a codon and a numerical value are very simple and reversible, with no data loss. Thus, each step in the embedding process of “codon → numerical value → watermarked numerical value → watermarked codon” can be designed mathematically and simply.The integer valuec˜with a single base error can be estimated using the16×4codon coding table. If the first base b1 of a codonc=b1b2b3has an error wherec˜=b˜1′b2b3,c′will be changed to any codon in the column on c. If the second base has an error wherec˜=b1b˜2′b3,c′will be changed to any codon in the row on c. If the third base has an error wherec˜=b1b2b˜3′,c′will be changed to the codon above or below c. The integer valuec˜ofc˜is changed by43−imultiples depending on the error position i.In the example(c,c)=(CCC,42), ifb1is the error,(c˜,c˜)will be changed to one of (GCC,10), (ACC,26), or (TCC,58). Ifb2is the error,(c˜,c˜)will be changed to one of (CGC,34), (CAC,38), or (CTC,46). Ifb3is the error,(c˜,c˜)will be changed to one of (CCG,40), (CCA,41), or (CCT,42). Errors of b1 and b2 in (CCC,42) will change the amino acid.The watermark can be embedded while ensuring amino acid conservation by the signal processing of the numerical sequence. Using the codon-coding table, a codon can be exchanged for another in a codon group of the amino acid. Like the VQ concept, synonymous codons can be easily grouped and modeled mathematically.Circular angles in the reference codon table have the resolution of 64 codons as shown in Fig. 3(a). To secure the watermark, we extend the resolution withR(>64)samplings by zero padding and map 64 codons to any sampled code as a unit of synonymous codons. M zeros are padded between amino acids, andM|Sn|zeros are padded in each amino acid. Thus, the resolution for an amino acidSnwill be(M+1)|Sn|and the full resolution for all codons will beR=20M+∑n=120(M+1)|Sn|.First, we list all codons in Table 2 as a unit of synonymous codons in random order. Then we randomly allocate codons in synonymous codons to M times sampled code. For example, when the randomly ordered amino acids areS={S1,S2,…,S20},Sn={cn,j|j∈[1,|Sn|]}, any codoncn,jin synonymous codons of nth ordered amino acidSnbecome allocated as follows:(6)cn,j→cˆn,j={(l(j)+(∑l=1n−1(M+1)|Sl|+M0))%R,ifn>1l(j)+M0,ifn=1l(j)is randomly selected inj∈[1,|Sn|].M0is the starting codon value and is randomly selected inM0∈[1,M]. Accordingly, a codon valuecn,jin the reference code table T is permuted to a random valuecˆn,j;cn,j:cn,j→cˆn,j. A circular angleθD,n,jfor a permuted valuecˆn,jcan be computed using Eq. (3):θD,n,j=2cˆn,jπRor2cˆn,jπR−2π.We define the random mapping table D as the difference of the reference code tableT={cn,j|n∈[1,20],j∈[1,|Sn|]}and the random code tableTˆ={cˆn,j|n∈[1,20],j∈[1,|Sn|]}.(7)D=Tˆ−TTwo tables of T and D can be used as keys in the public-key infrastructure (PKI) protocol where T is the public key and D is the private key. The embedding process is performed on a sequence of random codon valuesCˆ=(cˆi)1⩽i⩽N. The watermarked codon valuesCˆ′=(cˆi′)1⩽i⩽Nare recovered toC′=(ci′)1⩽i⩽Nby D, and the watermarked codonsC′are generated fromC′using Eq. (5).Fig. 3(b) illustrates random circular angles that are permuted as a unit of synonymous codons by the random mapping table D in no zero paddingM=0. This process allocates synonymous codons of{S,R,L}to consecutive values and makes the embedding process easy, because the random circular valuesθDcan be recovered as the reference circular values θ using the random mapping table D, and this table makes the circular angles for the embedding process unpredictable. In Section 4.3, we explain fully the unpredictability of the random circular anglesΘDand the position of center codons for embedding targets using the random mapping table D.Our method selects a number of target codonsck(3)=(ci−1,ci,ci+1)in a sequence of codons C and embeds a watermark bitwkinto random circular angles of target codons. This section explains two processes for searching target codons and embedding bits.The embedding targets can all be codons except for start and stop codons and one synonymous codon for ‘Trp’ (W). Given a codon sequence C, a sequence of random circular anglesΘDis decided by the random mapping table D that is one of a very large number of tables. Because the conventional methods embed the watermark into four or six synonymous codons in C, and anyone can know their positions, the watermarked codons are easily estimated, although randomly mapped. For the unpredictability of the watermarked codons, the codons can be randomly selected for embedded targets. However, additional information must be stored, in this case the positions of selected codons. Given the random mapping table used as a key, the random circular angles as well as the positions and numbers of target codons should be determined together. Accordingly, our method selects the codons for embedded targets for the purposes as follows:(1)The position and number of embedded targets should be regulated on a sequence of random circular anglesΘD.It should be very difficult to predict the positions and numbers of the embedded targets without the knowledge of random mapping table D.Because the wavelet coefficients of random circular angles that appear as random noise are influenced strongly by neighboring angles, it is difficult for the Lipschitz regularity to be reliably computed. Therefore, we remove irregular perturbations in a sequence of random circular valuesΘDusing hard-thresholding according to the Birgé–Massart strategy [53]. We then decompose a sequence of threshold circular values to a multi-scale wavelet transform with the same length,{S2J(ΘD),(W2j(ΘD))1⩽j⩽J}, and detect local modulus maxima{(W2jLM(ΘD))1⩽j⩽J}by finding positions where|W2j(ΘD)|is larger than its two closest neighboring coefficients and strictly larger than at least one.S2J(ΘD)is the coarse signal at the scale2JandW2j(ΘD)is the wavelet transform signal at the scale2j.In the Mallat theory, ifθDhas the local modulus maxima|W20LM(ΘD)|>0atj=0and it is equal to the convolution of a function with local singularity with a Gaussian of varianceσ2, the Lipschitz regularity is the upper boundα0of the set of α that satisfy regularity over[a,b].(8)|W2jLM(ΘD)|⩽K2js0α−1wheres0=22j+σ2and{(|W2jLM(ΘD)|)1⩽j⩽J,∀c∈[a,b]}ParametersK,α,σcan be obtained by minimizing(9)argminK,α,σ∑j=1J(log2|W2jLM(ΘD)|−log2K−j−α−12log2(22j+σ2))2We obtain codonsck⁎whereθD,kare the local modulus maxima and its Lipschitz regularity is below a thresholdα<th(−1<th⩽1). These are used to center codons of target codons.(10)c⁎=h(ΘD)=(ci⁎)|c⁎|∈ZThe target codons for 1-bit embedding are the center codon and its two closest codons:(11)ck(3)={(ci−1,ci⁎,ci+1)||W20LM(θD,k)|>0andαk<0}.The support region[a,b]and the maximum scale J have slight effects on the above parameters. Here we limit the maximum scale to0<J⩽6according to the length of sequence and set the support region[a,b]to[0,p(j)]considering the propagation of local maxima of delta functions across scales. The setting for the maximum scale J and support region[a,b]are explained fully in Appendix A.Fig. 4shows random circular anglesΘD, filtered angles ofΘD, local modulus maxima|W2jLM(ΘD)|on the scalej=0,2,4, and the Lipschitz regularity α and K parameter for codon DNA sequence of Homo sapiens (ANG; NM_001145).|W20LM(ΘD)|whereα<0decreases when the scale increases. In contrast,|W20LM(ΘD)|whenα>0increases when the scale increases. The K parameter gives the magnitude of sharp variations of signal. This figure shows that the sharp variations increase when K is high.Our method uses codons with the local modulus maxima andα<thas the center codon of triplet codons. th can be determined condignly considering capacity and security. Center codons of target codons,c⁎=h(ΘD), depend on the random mapping table D and the codon sequence C. If D is unknown,c⁎is very difficult to estimate.All bits of watermark,w=(wk)1⩽k⩽NW, are embedded into random circular angles of triplet codons,c(3)=(ck(3)=(ci−1,ci⁎,ci+1))1⩽k⩽NW, one by one, while ensuring amino acid conservation. Fig. 5illustrates an embedding example with three zeros padding in target codonsck(3)={ATC,CAG,GCC}.Set amino acids and synonymous codons of triplet codonsck(3)=(ci−1,ci⁎,ci+1)as(12)f(ci−1)→Sn−1:{cn−1,1,cn−1,2,…,cn−1,|Sn−1|}f(ci⁎)→Sn0:{cn,1,cn0,2,…,cn0,|Sn0|}f(ci+1)→Sn1:{cn1,1,cn1,2,…,cn1,|Sn1|}wheren−1,n0,n1∈[1,20]and their random circular angles on random mapping table D as(13)ΩD(Sn−1)={θD,n−1,1,θD,n−1,2,…,θD,n−1,|Sn−1|}ΩD(Sn0)={θD,n0,1,θD,n0,2,…,θD,n0,|Sn0|}ΩD(Sn1)={θD,n1,1,θD,n1,2,…,θD,n1,|Sn1|}Thus,ΩD(Sn)is the set of random circular angles of synonymous codons in an amino acidSnon D. AndθD,n,jis the random circular angle of a codoncn,jthat is jth codon in a set of nth synonymous codons.A random circular angleθD,n0,iof a center codonci⁎moves to maximum and minimum angles inΩD(Sn0)according to a bitwk.(14)θD,i′={max(ΩD(Sn0)),ifwk=1min(ΩD(Sn0)),ifwk=0The maximum and minimum angles aremax(ΩD(Sn0))=θD,n0,1andmax(ΩD(Sn0))=θD,n0,|Sn0|because random circular angles of synonymous codons are continuous in their group, as shown in Fig. 3(b).Our method moves random circular angles of left and right codons to angles with the maximum or minimum distances, in clockwise and counterclockwise directions from the reference point according to a bitwk. The reference pointMkis the average of random circular anglesΩD(Sn0)for the center codon;Mk=1|Sn0|∑j=1|Sn0|θD,n0,j. As shown in Fig. 5, we define the clockwise distance d⥁ betweenMkand random circular anglesΩD(Sn−1)inSn−1(15)d⥁(Mk,θD,n−1,j)=|θD,n−1,j−Mk|,∀j∈[1,|Sn−1|]and the counterclockwise distance d⥀ betweenMkand random circular anglesΩD(Sn1)inSn1(16)d⥀(Mk,θD,n1,j)=2π−|θD,n1,j−Mk|,∀j∈[1,|Sn1|]A random circular angleθD,i−1moves to maximum or minimum clockwise distances inΩD(Sn−1)on the reference pointMk,(17)θD,i−1′={max(d⥁(Mk,ΩD(Sn−1))),ifwk=1min(d⥁(Mk,ΩD(Sn−1))),ifwk=0and a random circular angleθD,i+1moves to maximum or minimum counterclockwise distances inΩD(Sn1)on the reference pointMk,(18)θD,i+1′={max(d⥀(Mk,ΩD(Sn1))),ifwk=1min(d⥀(Mk,ΩD(Sn1))),ifwk=0Watermarked angles of triplet codons, (θD,i−1′,θD,i′,θD,i+1′), are inversely converted to reference angles (θi−1′,θi′,θi+1′) by random mapping table D. These angles are inversely mapped to watermarked integer values (ci−1′,ci′,ci+1′) from Eq. (4).(19)ci′={R2π(θi′),ifθi′⩾0R2π(2π+θi′),ifθi′<0fori∈[−1,0,1]Finally the watermarked codons are obtained from Eq. (5);(ci−1′,ci′,ci+1′)=(b3i+j′)−3⩽j⩽5. Using the above process, all bits of watermark are embedded into target codons in order.Given a received or pirated coding DNA sequenceC˜, the watermark is extracted inC˜using the random mapping table D. The extraction and embedding processes are similar (Fig. 2(b)). During the extracting process, we generate random circular anglesΘ˜DofC˜on D and search center codonsc˜⁎using the Lipschitz regularity of local modulus maxima of hard-threshold angles and then obtain a number of target codons(c˜k(3)=(c˜i−1,c˜i⁎,c˜i+1))1⩽k⩽NW.When extracting a watermark bit from target codonsc˜k(3), we compute random circular angles (θ˜D,i−1,θ˜D,i,θ˜D,i+1) ofc˜k(3), sets of random circular angles of synonymous codons(Ω˜D(Sn−1),Ω˜D(Sn0),Ω˜D(Sn1)), and average values (M˜i−1,M˜i,M˜i+1) of these sets. Further, we compute the clockwise distance onM˜iwith a circular angleθ˜D,i−1;d⥁(M˜i,θ˜D,i−1)and the counterclockwise distance onM˜iwith a circular angleθ˜D,i+1;d⥀(M˜i,θ˜D,i+1). Three bits of triplet codons can be computed by comparingM˜iand the distances.(20)w˜i−1={1,ifd⥁(M˜i,θ˜D,i−1)>d⥁(M˜i,M˜i−1)0,otherwise(21)w˜i={1,ifθ˜D,i>M˜i0,otherwise(22)w˜i+1={1,ifd⥀(M˜i,θ˜D,i+1)>d⥀(M˜i,M˜i+1)0,otherwiseTherefore, a watermark bitw˜kcan be determined based on the majority rule of three bits;w˜k=floor(w˜i−1+w˜i+w˜i+13).All bits of watermarkw˜are computed using the above process. Whether a pirated DNA sequence is copied or not can be determined based on the similarity or bit error rate (BER) of the original watermark w and the extracted watermarkw˜.

@&#CONCLUSIONS@&#
The main requirements of codon DNA watermarking are amino acid conservation, mutation resistance, and security. Here we present a codon DNA watermarking method that satisfies these requirements and was evaluated in silico. The main features of the proposed method are the numerical mapping to random circular angles based on random mapping table, searching for codons using the local modulus maxima according to the Lipschitz regularity, and watermark embedding to ensure amino acid conservation. The codon-coding table and numerical mapping were designed to be suitable for processing DNA watermarking. The watermark was resistant to mutations by embedding it into the difference of circular angles of adjacent codons. We evaluated our method with respect to its the resistance to point mutations, amino acid conservation, security, and data capacity for the HEXA, ANG, CCT2, and bp1 genes. The experimental results show that our method confers superior resistance to mutations with the same capacity as Heider et al. and Liss et al. methods, ensuring amino acid conservation. Further, we established that the random mapping table and the position of target codons are secure from entropy.