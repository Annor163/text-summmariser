@&#MAIN-TITLE@&#
Integrating Support Vector Regression and a geomorphologic Artificial Neural Network for daily rainfall-runoff modeling

@&#HIGHLIGHTS@&#
A SVR model based on a geomorphologic-ANN model is developed to estimate the runoff.The results of the SVR-GANN model are assessed from modeling viewpoints.Equipping the SVR model with ANN as kernel function has improved the model accuracy.The SVR-GANN model can be applied as a promising tool for rainfall-runoff modeling.

@&#KEYPHRASES@&#
Rainfall-runoff modeling,Geomorphologic characteristics,Support Vector Regression (SVR),Artificial Neural Networks (ANNs),Genetic algorithm,Fuzzy inference system (FIS),

@&#ABSTRACT@&#
In spite of the efficiency of the Artificial Neural Networks (ANNs) for modeling nonlinear and complicated rainfall-runoff (R-R) process, they suffer from some drawbacks. Support Vector Regression (SVR) model has appeared to be a powerful alternative to reduce some of these drawbacks while retaining many strengths of ANNs. In this paper, to form a new rainfall-runoff model called SVR-GANN, a SVR model is combined with a geomorphologic-based ANN model. The GANN is a three-layer perceptron model, in which the number of hidden neurons is equal to the number of possible flow paths within a watershed and the connection weights between hidden layer and output layer are specified by flow path probabilities which are not updated during the training process. The capabilities of the proposed SVR-GANN model in simulating the daily runoff is investigated in a case study of three sub-basins located in a semi-arid region in Iran. The results of the proposed model are compared with those of ANN-based back propagation algorithm (ANN-BP), traditional SVR, ANN-based genetic algorithm (ANN-GA), adaptive neuro-fuzzy inference system (ANFIS), and GANN from the standpoints of parsimony, equifinality, robustness, reliability, computational time, simulation of hydrograph ordinates (peak flow, time to peak, and runoff volume) and also saving the main statistics of the observed data. The results show that prediction accuracy of the SVR-GANN model is usually better than those of ANN-based models and the proposed model can be applied as a promising, reliable, and robust prediction tool for rainfall-runoff modeling.

@&#INTRODUCTION@&#
Development and application of rainfall-runoff simulation models have been an appealing subject of research in hydrology. For simulating rainfall-runoff (R-R) relation in a watershed, two main approaches, namely knowledge-based and data-driven approaches, have been developed [1]. Many researches have been conducted based on the use of knowledge-based approaches such as physical and conceptual approaches [3]. These methods in general, mimic complexity of real world runoff behavior and conceptualize runoff processes and catchment properties [4,5]. An alternative to the knowledge-based approach is the data-driven approach which is based on extracting and reusing information implicitly existing in hydrologic data [22]. Sources and descriptions of many watershed models and comparative assessment of their performances are well addressed by researchers [6–8].Several models have been developed to simulate the watershed response to rainfall by Artificial Neural Networks (ANNs), due to their efficiency in modeling nonlinear and complicated rainfall-runoff relationship [9–12]. Among several topologies of ANNs, the feed forward back propagation type is frequently used in rainfall-runoff simulation and also river flow forecasting due to having less complexity than other architectures [13,14]. In spite of the efficiency of the ANNs in modeling nonlinear and complicated R-R process, they suffer from some drawbacks [15–17]. Efforts to overcome these shortcomings in the ANNs models used to simulate the rainfall-runoff process can be summarized in three categories:(1)Incorporating the physical and geomorphologic characteristics of a watershed directly in the ANN architecture (here named GANN) especially in the connecting weights of the model [18–21]. Zhang and Govindaraju [22] established a three-layer feed-forward ANN that explicitly accounts for the geomorphologic catchment characteristics in the network architecture to estimate direct runoff hydrographs resulted from several storms over two watersheds in the state of Indiana, USA. The structures of geomorphologic ANN as well as network weights were determined using watershed geomorphology. The authors compared the results of the developed model with those obtained using the Geomorphologic Instantaneous Unit Hydrograph theory (GIUH) based on path probability. Their study showed that the GANN model is a promising tool for estimating direct runoff. They also used the ANN-based geomorphologic model developed by [22] for surface and subsurface flow simulation in Heng-Chi watershed in Taiwan [23]. The results of this model were also compared with ones obtained using GIUH model developed by [24] based on kinematic-wave approximation and Darcy's law. The authors suggested that the ANN model showed better performance than GIUH model in terms of time to peak and peak flow estimation.Using an evolutionary optimization algorithm in the ANN structure to improve the optimization process of the parameters during the training phase. The most well-known training algorithms are the classical feed-forward algorithm [25], conjugate gradient algorithm [26,27] and methods based on second-order gradients such as the Levenberg–Marquardt (LM) algorithm [28]. These gradient-based algorithms usually are prone to be trapped in locally optimal solutions in multi-modal and multi-dimensional non-linear optimization problems such as rainfall-runoff modeling. The recently proposed nature-inspired evolutionary computation algorithms are able to work not only with non-differentiable functions but also with functions with a considerable number of local minima [29]. Hybridizing the ANNs with such optimization algorithms (e.g., genetic algorithm, particle swarm optimization, etc.) can decrease the chance of over-fitting and provide better accuracy, while increasing the computational time. Wu and Chau [30] and Chau [31] developed particle swarm optimization-based ANN (PSO-ANN) model for prediction of Shing Mun River stage in Hong Kong and showed that the PSO-ANN model has higher efficiency than back propagation-based ANN model. Haykin [32] discussed several data-driven optimization training algorithms, such as Levenberg–Marquardt algorithm and scaled conjugate gradient algorithm. Rogers et al. [33] used the genetic algorithm for optimal field-scale groundwater remediation together with ANN.Integrating the ANN model with the fuzzy inference system (FIS), entitled ANFIS model. The rainfall-runoff process is a complex non-linear outcome of various hydrologic parameters, i.e., precipitation intensity, evaporation, geomorphology of watershed, infiltration of water into the soil and depression storage as well as interactions between groundwater and surface water flows [34,35]. The deficiencies in data including missing data, noisy data, insufficient data, and also vagueness of these variables can cause difficulties in rainfall-runoff modeling. Previous works of application of the FIS integrated with the ANN model structure, so-called neuro-fuzzy system, showed that it could be a well-organized tool to deal with these challenges in rainfall-runoff modeling [12,36,37].Recently, Support Vector Regression (SVR) has been successfully applied in the fields of water resources engineering and hydrology for purposes such as runoff prediction [38–40], flood forecasting [41,42], lake water level prediction [43,44], regionalization of contaminants in aquifers [45], etc.In comparison with ANNs, SVRs are able to learn more effectively when using scarce and incomplete hydrologic data [46,47]. This advantage is because of two outstanding features of SVRs: their excellent capability in generalization of the unseen data (testing phase) and their proficiency for application in large scale problems using only a small number of support vectors [48]. The SVRs are also preferred due to reducing the memory footprint of the learned predictor, as well as low computational cost [49]. Liong and Sivapragasam [41] detailed eight facts about superiority of SVRs over ANNs in simulating and predicting complex phenomena in hydrogeology and water resources, while holding all the strengths of ANN.The key questions in using different approaches for R-R modeling described above are how these models perform in simulating runoff and how one can incorporate the capabilities of the ANN- and SVR-based models in one model to promote the reliability of the watershed runoff simulation. The main purpose of this paper is developing a new model which combines the traditional SVR model with a geomorphologic ANN model (GANN) to simulate the daily runoff in a watershed. The performance of the proposed model (SVR-GANN) is compared with different ANN-based models including ANN with embedded geomorphologic characteristics (GANN), ANN with genetic algorithm (ANN-GA), ANN adopted with the fuzzy inference system (adapted neuro-fuzzy inference system – ANFIS) and also traditional SVR model from the viewpoints of simplicity (parsimony), equifinality, robustness, reliability, computational time, hydrograph ordinates and saving the main statistics of the observed data.In this section, the structure of the SVR-GANN model, which is developed by combining the GIUH theory, a three-layer perceptron ANN model, a traditional SVR model and a genetic algorithm-based optimization model is described. At first, a brief description of each individual model is given. Then, the structure and details of the proposed GANN model are provided. Also, the ANN-based models, which are applied for comparing their results with those of the proposed model, are briefly explained and finally, the fitness function and evaluation criteria used for evaluating the results of the models are described.Before explaining the structure of GANN model, a brief review of the GIUH theory is given in this section. The GIUH principle assumes that the watershed can be represented as a linear, time-invariant system, such that the total runoff from surface and subsurface flow in response to input rainfall can be obtained based on the following convolution integral [50]:(1)Q(t)=∫0tI(τ)∗u(t−τ)dτwhere u(t) is IUH ordinate at time t, Q(t) is direct flow in watershed outlet, and I(t) is excess rainfall at time t. The unit response hydrograph is formulated in terms of travel path probabilities and travel times over portions of the land surface, subsurface zones and channel links (Fig. 1). The spatial structure of the basin, expressed in terms of the Strahler order of the network, is explicitly considered for formulating the GIUH.Letxoidenotes the ith overland flow region, xithe ith surface flow order, and i=1, 2, 3, …, Ω (Ω denotes the watershed order). The total IUH of watershed, u(t), as a linear system of surface flows is expressed as follows:(2)u(t)=∑ws∈Wsfxoi(t)∗fxi(t)∗fxj(t)∗⋯∗fxΩ(t)ws⋅P(ws),Ws=〈xoi,xi,xj,…,xΩ〉wherefxi(t)is the travel time probability density function in state xi, Wsis the surface flow path space which includes{xoi,xi,xj,…,xΩ}with total number of N(ws), P(ws) is the probability of the surface flow adopting path ws. The probability of P(ws) is defined by [24] as follows:(3)P(ws)=POAi⋅PxOixi⋅Pxixj…PxkxΩwherePOAiis the ratio of the surface flow region of the ith order hillslope to the total watershed area:(4)POAi=NiAΩA¯i−∑j=1i−1A¯iNjPxixjNii=2,…,Ωwhere AΩis the total area of watershed, Niis the number of ith order, andA¯iis average area of ith order sub-basins. In Eqs. (10) and (11),Pxi,xjdenotes the transition probability of the runoff moving from ith order surface flow region to jth order channel as follows:(5)Pxi,xj=(Ni−2Ni+1)E[j,Ω]∑k=jΩE[k,Ω]Ni+2Ni+1Niδi+1,ji=2,…,Ω,δi+1,j=1ifj=i+10otherwiseE[i,Ω] is average number of upstream channel orders joining ith order stream. This is defined as:(6)E[i,Ω]=N∏j=2i(Nj−1−1)2Nj−1i=2,…,ΩTo compute the flow path probabilities using Eqs. (2)–(6), the required parameters including Niand Ai(i=1, 2, 3, …, Ω) can be directly determined from geomorphologic characteristics of watershed. The probability density function of travel time[fxj(t)]must be estimated for computing the transition probabilities of different orders.The GANN model is a three-layer perceptron in which the number of hidden neurons is equal to the number of possible paths within a watershed (N(ws)). The connection weights between hidden layer and output layer are specified by the path probabilities (P(ws)) which are not updated during the training process [22]. In addition, the connected weights between input and hidden layers (wij), interpreted as the transition probabilities of watershed, are estimated during the training process. The GANN model computes the surface flow at time t(Qˆt)corresponding to the values of input variables (pt) using the following formula:(7)Qˆt=φ2∑jεSPj(ws)×φ1∑i=1mpt×wij+bj+bj+1,t=1,2,3,…,NTwhere wijis the connective weight between ith neuron in the input layer and jth neuron in the hidden layer; m is the number of neuron in the hidden layer; ptdenotes the tth input data; S is the set of flow paths; and φ1 and φ2 are the activation functions of the hidden layer (mostly log-sigmoid) and output layer (mostly linear), respectively (Fig. 2). The values of weights (wij) and biases (bj) need to be optimized during the training mode.The traditional SVR model, according to Vapnik [51], solves the following optimization problem to find the parameters of the model for a specified kernel function f(xt)=w·Φ(xt)+b with small w that has the least possible deviation (ɛ) from the actual targets (Qt) for NTtraining patterns:(8)Minimize︸F,ε,ξ,ξ*12||w2||+F∑t=1NT(ξt+ξt*)subject to(9)Qt−(wT⋅Φ(xt)+b)≤ε−ξt(wT⋅Φ(xt)+b)−Qt≤ε−ξt*ξt,ξt*≥0∀t=1,2,…,NTIn the above equations, (wT·Φ(xt)+b) is a given transformation function (kernel function) which maps input data (x) from the input space to a higher dimensional feature space; ξ and ξ* are slack variables which are used to determine the amount up to which samples with error more than ɛ are penalized. Constant F defines the tradeoff between the flatness of f(x) and the tolerated error. For example, if the F-value tends to infinity, the objective becomes minimizing the error regardless of the flatness [53,71].Radial-basis functions (RBFs) are practical choices of kernel functions with more flexibility and fewer parameters than the other ones (e.g., linear, polynomials, and sigmoid) [52]. The RBF kernel function can be defined as Gaussian covariance kernel with unit variance [53]:(10)k(x,xi)=σ2exp(−γ2||x−xi||2)where γ is the specified kernel parameter and σ2=1. The objective function given in Eq. (8) minimizes the complexity (the magnitude of w) of the flow estimator which is usually solved in a dual form using Lagrangian multipliers considering the Karush–Kuhn–Tucker optimality condition.The proposed model for simulating the daily runoff in a watershed incorporates the GANN model structure with formulation defined in Eq. (7) as the kernel function of the SVR structure:(11)f(xt)=Qˆt=φ2∑jεSPj(ws)×φ1∑i=1mpi×wij+bj+bj+1Substituting Eq. (11) into Eq. (9), and considering the vector of w in the objective function (8) as the vector of connecting weights between input and hidden layers (wij), the SVR-GANN model can be mathematically presented as follows:(12)Minimize︸w,b,ε,F,ξ,ξ*Z=12∑jεS∑i=1mwij2+F∑t=1NTξt+ξt*subject to:Qt−φ2∑jεSPj(ws)×φ1∑i=1mpi×wij+bj+bj+1≤ε−ξtφ2∑jεSPj(ws)×φ1∑i=1mpi×wij+bj+bj+1−Qt≤ε−ξt*ξt,ξt*≥0∀t=1,2,…,NTFig. 3shows a flowchart of the SVR-GANN model. As presented in this figure, the geomorphologic characteristics of watershed and the capabilities of a GA-based optimization model and the ANN and SVR models for simulating the direct runoff in watershed outlet are effectively used in the SVR-GANN model.The decision variables of the above optimization problem consist of vector of connecting weights between neurons of input and hidden layers (wij), vector of biases (bj) and slack variables ξ and ξ*, and their optimal values are obtained using genetic algorithm (GA). In the GA, the decision variables of the SVR-GANN model (wij, bj, ξ and ξ*) are treated as genes in each chromosome of the population pool and updated in each generation through the training phase (Fig. 4). In this paper, the continuous type of genetic algorithm (real-coded GA) is used to find the optimal values of the SVR-GANN model parameters. The real-coded GA has some advantageous over the binary type of GA (e.g. [54,55]). Linking this meta-heuristic algorithm with the SVR-GANN model can promote the efficiency of the model and increase the chance of obtaining globally optimum values for the model parameters [56]. In addition, the GA approach does not require certain conditions such as continuity and differentiability, which are essential in derivative-based optimization algorithms. The GA can work with discrete complicated functions with many decision variables and probabilistic rules starting from a population of potential solutions [57].The efficiency of the SVR-GANN model for simulating daily runoff is compared with some benchmark models including a traditional three-layer ANN model based on feed-forward back-propagation algorithm (ANN-BP), adaptive neuro-fuzzy inference system (ANFIS), traditional three-layer ANN integrated with GA (ANN-GA), and geomorphologic-based ANN (GANN). A brief explanation of each of these models is given in the following sections.The ANN-BP model is a traditional three-layer perceptron ANN which uses back-propagation algorithm (BP) in training phase [58,59]. It is a supervised learning method in which an output error is fed backward through the network, altering connection weights so as to minimize the error between the network output and the target output [10]. The BP algorithm is a first order method based on the steepest gradient descent, with the direction vector being set equal to negative of the gradient vector. In this model, the number of nodes in the hidden layer, the connected weights, and also the bias terms need to be adjusted during model calibration/training (Table 1).Similar to the previous model, a three-layer perceptron ANN model is developed which incorporates the genetic algorithm, instead of the BP algorithm, for optimizing the connecting weights and biases of ANN structure during the training phase.The ANFIS model used in this paper is a Mamdani FIS type [60] which contains five layers (see Fig. 5). (1) The first layer generates membership degrees according to the defined membership functions (MFs) for the input variables. In this paper, Gaussian function is chosen as the membership function of input variables which is specified by two parameters σ and c:(14)Gaussian(x;σ,c)=exp−x−cσ2where c represents the MF's center and σ determines the MF's width which need to be optimized during the training phase. Parameters c and σ are known as the nonlinear parameters (NNPs) of the ANFIS model.(2) The second layer, which contains rule nodes, uses AND and/or OR operators to compute every possible conjunction of the decision rules. (3) Layer three normalizes the conjunctive membership functions in order to rescale the inputs. (4) The fourth layer, called consequent node, combines the incoming rule antecedents and determines the degree to which they belong to the output label. Here, the number of nodes is equal to the number of rules. (5) The fifth layer, containing the output nodes, computes the overall output by summing the incoming evidences. The sum of all incoming signals is used to generate the decision crisp output. In the ANFIS model, fuzzy subtractive clustering is also conducted for each data of input variable to prevent increasing the number of parameters which is altered according to the number of rules [37,61,62]. More details about this model can be found in [63].To run the six mentioned models, the input–output data must be divided into three categories of training set, testing set and validation set. In the training phase of the four benchmark models, the parameters are optimized by minimizing a performance criterion which is calculated considering the amount of difference between the observed and simulated discharges. The criterion basically is an error function named HMLE and is defined as fitness function of the optimization algorithm which is calculated as follows [64]:(15)HMLE=(1/n)∑i=1nwiQisim−Qiobs2∏i=1nwii/nwhereQisimandQiobsdenote the ith target output computed by model and the ith observed value, respectively; n is the total number of data; and wiis the relative weight of the ith output. HMLE is also considered as the maximum likelihood estimator under the assumption that the measurement errors(ei=Qisim−Qiobs)are normally distributed with zero mean and variance σ2. The weights (wi) are computed aswi=fi, where fiis the expected value ofQiobs. However, in practice the use offi=Qiobsresults in a more stable estimator. To evaluate the suitability of output patterns of the six models, two performance criteria are used:(1)Coefficient of determination (R2):(16)R2=∑t=1nQobs(t)−Q¯obs][Qsim(t)−Q¯sim]∑t=1n[Qobs(t)−Q¯obs]2∑t=1n[Qsim(t)−Q¯sim]22The closer the R2 value to unity, the better is the performance of the model.Scattering index (SI):(17)SI=(1/n)∑t=1nQobs(t)−Qsim(t)Q¯obsIn Eqs. (16) and (17), Qobs(t) and Qsim(t) are the recorded and simulated discharges at time t, respectively;Q¯obsandQ¯simare the average recorded and simulated discharge values, respectively; and n is the number of hydrograph ordinates.Geomorphologic information and hydrologic records of a large watershed named Qomrud in a semi-arid region in Iran are used to investigate the performance of the presented models (Fig. 6). The Qomrud watershed is a sixth-order basin with total area of 14,047km2. The maximum and minimum heights of this watershed are 3565m and 950m, respectively. The Qomrud river supplies a great deal of domestic and agricultural water demands in the area. The land uses of this watershed are shown in Fig. 7and Table 2. More than 50% of the watershed area consists of rangelands with poor density and bare lands.The Qomrud river passes through the Qom city with a population of more than 1,100,000 people. Changing the land use of the main riverbanks to residential purposes due to population growth has increased the risk of hazardous floods in the area. For instance, in March 29 and 30, 2009, a very rare rainfall event with average intensity of 2.42mm/h and duration of 23h occurred that caused a peak flow of 145m3/s in this watershed (Fig. 8) and severe damages in the Qom city. After this event, the Regional Water Organization of Qom province decided to design a flood warning system. The models presented in this paper are used to simulate the rainfall-runoff process in this basin.Due to lack of recent hydrological and meteorological data of this watershed, it is divided into three sub-basins including Golpayegan (fourth order basin with A=1032.6km2) at the upstream of the watershed, Panzdahe-Khordad (fifth order basin with A=8773.4km2) at the center of the watershed and Shadabad (fourth order with A=4241.8km2) upstream of Qom city (Fig. 6). Additional physiographic characteristics of the three sub-basins are calculated using terrain processing module of ArcHydro tools software (version 1.3) based on DEM data obtained from existing 1:50,000 scale contour map and are summarized in Table 3.The geomorphologic properties of the three sub-basins required for computation of path probabilities include number of stream order (N), average area of order upstream(A¯), and average length of each stream(L¯)which are estimated from a topographical 1:250,000 scale map and are listed in Table 4.Based on rainfall and runoff measurements in Golpayegan, Panzdahe-Khordad and Shadabad sub-basins, the average annual precipitation of these stations are 257, 187 and 165mm and the average annual discharges are 9.53, 5.78 and 3.52 MCM, respectively. Considering the area of each sub-basin, the specific discharge of Golpayegan, Panzdahe-Khordad, and Shadabad are 9.1, 2.6 and 1.0l/km2, respectively.

@&#CONCLUSIONS@&#
