@&#MAIN-TITLE@&#
Performance of a digital transmitter leakage LMS-based cancellation algorithm for multi-standard radio-frequency transceivers

@&#HIGHLIGHTS@&#
We study the performance of a Tx Leakage compensation algorithm.The baseband model is parametrized by a complex gain and a fractional delay.A recursive online joint estimation (complex gain, fractional delay) is proposed.All theoretical asymptotic performance and optimal step formulae are derived.

@&#KEYPHRASES@&#
FDD transceiver,Radio frequency impairment,Tx leakage,Digital cancellation,Least-mean-square (LMS) algorithm,

@&#ABSTRACT@&#
This paper deals with a joint estimation algorithm that is dedicated to digital compensation of transmitter leakage pollution in frequency division duplexing transceivers. These transceivers are affected by transmitter to receiver signal leakage. Combined with the nonlinearity of amplifying components in the receiver path, the baseband signal received can be severely polluted by a baseband polluting term. This term is based on the square modulus of the transmitted signal, and it depends on the equivalent transmitter leakage channel which models leakages and the receiver path. Here, we consider a nonconvolutive, time-varying channel that is modeled by a time-varying complex gain and the presence of a fractional delay, modeling the propagation effects into the receiver. The complex gain is a sum of two components, a constant term that models static effects, and a first-order autoregressive model that approximates the time variation of the transmitter leakage channel. We focus here on a fully digital approach, using digital signal processing techniques and knowledge of the transmitted samples to mitigate the pollution. We first express the asymptotic performance of a transmitter leakage gain estimator piloted by a reference-based least-mean-square (LMS) approach in the synchronized case, and then we derive the influence of the fractional delay. We show that, in practice, the fractional delay cannot be neglected, and we propose a joint estimation of the fractional delay and the transmitter leakage gain to perform digital compensation. The proposed method is adaptive, recursive and online, and it has low complexity. This algorithm, that is developed for a flat transmitter leakage channel case, is seen to be robust in a typical selective channel simulation case, and more suitable than a classic multi-tap LMS scheme proposed in the literature.

@&#INTRODUCTION@&#
In wireless communication systems, transmission and reception can be based on time division duplexing or on frequency division duplexing (FDD). In the first case, the transmission and the reception are temporally separated, leading to a time slot that is dedicated to transmission and another that is dedicated to reception [2]. However, for a FDD framework which is the case of the study presented here, the transmission and the reception are simultaneous, using two different carrier frequencies [3].As a common antenna is used for both transmission and reception, a duplexer is used to connect the receiver (Rx) path and the transmitter (Tx) path [4] (see Fig. 1). In practice, as only an average of 50 dB attenuation can be achieved in the duplexer, the isolation between the Tx path and the Rx path is far from infinite [5]. Thus, the transmitted signal can leak into the Rx path, which leads to the so-called Tx leakage (TxL) phenomenon. As the uplink and the downlink bands are spectrally separated, the received signal will not be impaired directly by the leakage of the transmitted signal, as the low-pass filter (LPF) located after the demodulation stage will remove all of it from the band signals. However, an image of the transmitted signal can pollute the received signal in the baseband, due to nonlinearities and imperfections in the components in the Rx stage; especially the low-noise amplifier (LNA) [6] and the demodulator [7]. These aforementioned imperfections lead to second-order intermodulation products that shift downward to the baseband square component of the TxL signal [8]. In practical cases, this polluting signal can be neglected, except when the receiver is far from the transmitter (which corresponds to the cell edge context in cellular communications), as the power of the received signal is weak, and the power of the transmitted signal is strong [9].To avoid this pollution, analog methods can be implemented. Such mitigation methods consist of the addition of a band-pass filter in the Rx stage before [10] or after the LNA [11]. Other techniques consist of the combination of the Tx path multiplied by a calibrated analog gain to the Rx path, to suppress the pollution at high frequency [12]. However, RF transceivers contain more and more digital parts, and signal-processing techniques are becoming an area of interest for radio-frequency impairment problems [13]. In perfect agreement with the dirty RF paradigm, several digital-compensation methods have been investigated in the past few years for TxL compensation [5,9,14,15].These methods are based on the knowledge of the transmitted signal and require the estimation of the so-called TxL channel that characterizes the Tx-Rx isolation of the duplexer and the Rx path. Different channel models are used in the literature, from a single constant coefficient [5,16], to an exponential decay filter [17], or a more general finite impulse response filter [9]. However, literature methods do not take into account that the duplexer isolation is time varying, as showed by [18]. Furthermore, under the flat TxL channel assumption, the existence of a fractional delay in the reception stage due to digital blocks, analog blocks and propagation into the receiver, has not been considered. Also, a steady-state analysis of a LMS-based algorithm was described by [19] to reduce the impact of the spurs (which are narrowband pollutions due to leakage of clock harmonics), and a similar approach can be investigated for a wideband polluting signal.In this paper, we propose a digital compensation scheme for the TxL problem. Our method exploits the knowledge of the transmitted signal as a reference, and estimates both the TxL channel that is assumed to be frequency flat and to follow a first-order auto-regressive model (AR1), and the fractional delay introduced by the transceiver. We first study the synchronized case (where the fractional delay is assumed to be perfectly known), and we derive the asymptotic performance of the channel complex gain estimator, based on the LMS algorithm. Then, through the derivation of the analytic formula of the asymptotic performance of the algorithm in the presence of noncompensated fractional delay, we show that the fractional delay must be compensated for beforehand. We propose a joint estimation algorithm for the estimation of both the channel gain and the fractional delay. Before the compensation part, the estimation part of our algorithm has similitudes with a data-aided algorithm that was designed for phase and timing synchronization as well as for automatic gain control [20], although here the Rx signal is considered as noise for the estimation process. To be suitable for hardware implementation, this algorithm is adaptive, online, and recursive, and has low complexity. The algorithm is proposed under the flat TxL channel assumption, but we will see in the simulation part that the method is robust against a typical frequency-selective TxL channel, and is more suitable than a classical multi-tap LMS approach when the fractional delay is not negligible. We complete and extend the initial work proposed by [1], providing here all of the proofs, additional extensive simulations, comparisons with the literature, and interpretations. The main contributions of the present paper can be summarized as:•Proposition of a baseband digital model for TxL pollution, which takes into account the time variation of the polluting channel and the propagation delay to the receiver. The link between the parameters of the (AR1-based) model and physical values (e.g., interference level, normalized Doppler frequency, and others) is analytically established.Proposition of a joint estimation algorithm to both estimate the time-varying complex gain and the fractional delay, before performing TxL compensation. This LMS-based compensation is piloted by a reference synthesized from the transmitted samples.Derivation of the closed-form asymptotic performance of the algorithm when the fractional delay is assumed to be perfectly known. This can be used to tune the step-size parameters of the algorithm, as well as to predict the signal interference ratio (SIR) performance with respect to the TxL channel properties. The impact of a noncompensated fractional delay on the asymptotic performance is also derived, which shows that the fractional delay must be compensated for beforehand.Simulation and comparison between the proposed joint estimation scheme and a classical literature method for the case of a frequency selective TxL channel, which shows the robustness and effectiveness of the proposed algorithm.This paper is organized as follows. We give the baseband polluting model in Section 2. We derive the asymptotic performance of the LMS algorithm for the channel gain estimation process in the synchronized case in Section 3. We derive the analytic formulae of the influence of the fractional delay in Section 4. We propose a joint channel gain and fractional delay in Section 5. Section 6 validates our method and theoretical results through simulations.As, the baseband polluting model involves several signals from both Tx and Rx stages, the main signals (and their definitions) are synthesized in Table 1, and also mentioned in Fig. 1. We consider a classical FDD scheme where transmission and reception are simultaneous, at the frequencyfTxfor transmission, andfRxfor reception. The transmitted signalxTxHF(t)has a bandwidthBTxaroundfTx(i.e. the bandwidth ofxTxHF(t)is fromfTx−BTx/2tofTx+BTx/2), and can be expressed as:(1)xTxHF(t)=ℜ{s˜Tx(t)e2jπfTxt+jϕTx},whereℜ{}is the real part operator, and where:(2)s˜Tx(t)=sTxI(t)+jsTxQ(t),is the complex baseband Tx signal. Here, we assume a purely linear power amplifier with gaingPA, and the signal at the duplexer input can be expressed as(3)xTxPA(t)=gPA×xTxHF(t).In a classical FDD transceiver, TxL is due to the cascade of several impairments:•The finite isolation between the Tx path and Rx path at the duplexer implies leakage of the transmitted signal into the Rx path (see Fig. 1). If we denotehTxL(t)as the duplexer equivalent channel, and introduce the power amplifier gaingPAinto the duplexer response, the TxL signal in the Rx path can be expressed as(4)sTxLHF(t)=hTxL(t)⁎xTxHF(t),where ⁎ is the convolution operator. The signal at the input of the LNAxLNA(t)is a mixture between the desired high-frequency signalsRxHF(t)and the TxL signalsTxLHF(t). It can be noted that, in practice, the level of the received signalsRxHF(t)can be much lower than the level of the leaked transmitted signalsTxLHF(t), especially in a cell edge.(5)xLNA(t)=sRxHF(t)+sTxLHF(t)The LNA that amplifies the received signal regarding the noise is not perfectly linear [21]. As a consequence, intermodulation products located at the LNA create second-order baseband components. Assuming a LNA with a nonlinearity of order II, the output of the LNA can be expressed as:yLNA(t)=α1LNAxLNA(t)+α2LNAxLNA2(t)By introducingzRx(t)as the analytic signal associated with the received signalsRxHF(t)[and with a baseband complex envelops˜Rx(t)], andzTxL(t)as the analytic signal ofsTxLHF(t)[with a baseband complex envelops˜TxL(t)], defined as:zRx(t)=sRx(t)e2jπfRxtzTxL(t)=s˜TxL(t)e2jπfTxt,the link with the high-frequency signals can be expressed as:(6)sRxHF(t)=zRx(t)+zRx⁎(t)2=ℜ{zRx(t)}(7)sTxLHF(t)=zTxL(t)+zTxL⁎(t)2=ℜ{zTxL(t)},A leakage can appear at the demodulator stage, between the input and the output of the demodulator [6]. As a consequence, baseband signals (due to intermodulation products) will pollute the desired noisy signal that is translated fromfRxto baseband by the demodulator. If we denotegOLas the static gain of the leakage, andhRx(t)as the low-pass filter located after the demodulation stage, the final baseband polluting term is:(9)sTxLBB(t)=gOL×α2LNA2×hRx(t)⁎|s˜TxL(t)|2Here, as we will apply digital compensation to mitigate the impact of the TxL pollution, we need a digital pollution model for the TxL. The polluting term after the analog-to-digital converter can be expressed as:(10)sTxL(n)=[sTxLBB(t)]t=nTRxwhereTRx=1/FRxis the sampling period. Here, for the theoretical analysis, we assume that the duplexer is frequency flat, and that the Rx chain introduces a complex gain due to mismatch, as has been widely assumed in the literature, as in [5,16,22].Due to digital and analog blocks, the polluting signal has a delayΔ=(D+δ)TRx, which is composed of an integer part D and a fractional part δ. From (9) and (10), the polluting term becomes:(11)sTxL(n;Δ)=βTxL(n)×[hRx(t−Δ)⁎|s˜Tx(t−Δ)|2]t=nTRxwhereβTxL(n)models the global TxL complex channel gain at time index n (modeling the impact of both the duplexer, the Rx chain, and the demodulator). The TxL channel gain is time varying [18], and can be expressed as:(12)βTxL(n)=β0TxL+αTxL(n),whereβ0TxLis a complex constant that is linked to the interference level, andαTxL(n)is the time-varying channel evolution. For the complex gain evolution, we use a first-order auto-regressive process that is a simple but widely used model in the communications literature used to approximate time-varying channels [23,24], and is defined by:(13)αTxL(n)=γαTxL(n−1)+ξTxL(n),initialized byαTxL(0)=0, where0<γ<1andξTxL(n)is circular complex zero-mean white Gaussian state noise, with variance:(14)σξTxL2=(1−γ2)σαTxL2.As the channel is composed of a static term and a complex Gaussian dynamic term, we denote K as the power ratio of the fixed and scattered components (in the same way as for a Ricean wireless channel model):(15)K=|β0TxL|2σαTxL2The caseK→∞corresponds to a nonvarying channel, whereasK→0corresponds to a varying channel with a negligible constant interference level.We assume that the integer part of the delay is known, as in practice it can be easily estimated with a correlation process or with a parallel structure, as described by [5], and without loss of generality, we takeD=0. In the baseband receiver part, the discrete time observed signald(n)becomes:(16)d(n)=x(n)+b(n)+sTxL(n;δ),wherex(n)is the desired signal, which is assumed to be stationary uncorrelated11This strong hypothesis is only made to derive theoretical performance formulae, but we will see in the simulation section that the results can be applied to some typical communication signals (that are cyclostationary and slightly correlated by the waveforms).and zero-mean, of varianceσx2,b(n)is the white additive Gaussian noise, of varianceσb2, andsTxL(n;δ)is the TxL polluting signal defined in (11).The TxL canceller is not intended to cancel the additive noise term. As we focus here on the performance of the TxL canceller, and not on the impact of the additive white noise, we consider for the performance measurement that the noise is part of the desired signal. In other words, regarding the TxL cancellation algorithm, the desired signal is the observed signal without the TxL polluting termsTxL(n;δ). We denotexb(n)as the desired noisy signal, which is a white zero-mean signal, of varianceσxb2, and the observation model becomes:(17)d(n)=xb(n)+sTxL(n;δ).The influence of the TxL in terms of the SIR, expressed in dB, is:(18)SIRinit=−10log10(PsTxLσxb2),wherePsTxLis the power of the polluting termsTxL(n;δ).To proceed to the compensation, we synthesize a referenceu(n)as a perfect image of the baseband intermodulation product that takes into account the impact of the Rx chain:(19)u(n)=[hRx(t)⁎|sTx(t)|2]t=nTRxThis reference of powerPuis synthesized in the reference generator (see Fig. 1) from the baseband Tx samples, and it can be noted that in practice, it might need additional processing, such as an upsampler, filters, and a resampler. Based on the observation model described in (17), the TxL channel evolution described in (12) and (13), and the reference in (19), the estimation process consists of the estimation of the time-varying complex gainβTxL(n)and the fractional delay δ.The estimation error is defined by:(20)ϵ(n)=e(n)−xb(n),wheree(n)is the output of the TxL compensation structure (see Fig. 1), and the asymptotic performance of the algorithm will be described by the SIR after compensation:(21)SIRcomp=−10log10(Pϵσxb2),wherePϵis the mean square error.The baseband model of the complex gainβTxL(n)is function of several parameters, synthesized in Table 2. In addition to the overall parameters, that are necessary to establish the model and to derive the analytical study, the model also depends on the so-called primary parameters that characterizes the AR1 mathematical model (see Table 2). Besides, instead of using the primary parameters, physical interpretation of the baseband polluting model and characterization of the parameters can alternatively be done through the initial SIR (that defines the interference level at the entry of the digital front end), the ratio K, and the normalized Doppler frequencyfdTRx. These parameters are denoted as associated physical parameters in Table 2.The output of the AR1 model can be viewed as the low-pass filtering of the state noiseξTxL(n), and we denoteL(z)as the z transform of this filter. From (13), we have:(22)L(z)=11−γz−1,and the coherence timeTcorr, defined here as the inverse of the 3-dB cut-off frequency ofL(z), can be approximated as:(23)Tcorr≈2γπTRx1−γThe channel variation is slow in terms of the Rx sampling timeTRx, and we assumeTcorr≫TRx; the AR1 parameter γ can be approximated as:(24)γ≈TcorrTcorr+2πTRx.Reintroducing (24) in (14), and introducing the normalized Doppler frequencyfdTRx=TRxTcorr≪1, we finally have:(25)σξTxL2≈4πσαTxL2fdTRx,and finally, the constant interference levelβ0TxLand the channel varianceσαTxL2are defined by the initial SIR and the ratio K:(26)|β0TxL|2=σxb22PuK1+K10−SIRinit(27)σαTxL2=|β0TxL|2K.As in classical literature articles related to channel estimation modeled by auto-regressive models, the theoretical performance formulae in the rest of the paper are expressed in terms ofβ0TxL,σξTxL2andσαTxL2that define the baseband polluting model described in (12)–(15). It corresponds to the primary parameters described in Table 2 that can be associated to practical physical parameters (see Table 2) with (25)–(27).In this part, we assume that δ is known and we synthesize the fractionally delayed referenceuδ(n)from (19):(28)uδ(n)=[hRx(t)⁎|sTx(t)|2]t=nTRx+δ.Note that with a perfect interpolator, we would have:(29)sTxL(n,δ)=βTxL(n)uδ(n),and it can also be noted that in practical cases, a Lagrangian interpolator of size L can be implemented [25,26]. The compensation idea, as depicted in Fig. 2, is to obtain the compensated signale(n)by subtracting the estimated TxL component from the input sampled(n). This component is obtained by multiplying the reference signaluδ(n)by a complex adaptive coefficientβˆTxL(n)(estimation of the TxL channel), which is updated usinge(n)with a LMS algorithm [27]:(30)sˆTxL(n)=βˆTxL(n)uδ(n)(31)e(n)=d(n)−sˆTxL(n)(32)βˆTxL(n+1)=βˆTxL(n)+μuδ(n)e(n),where μ is the constant step size of the algorithm. The asymptotic performance of the algorithm can be derived as (see Appendix A):(33)SIRcomp=−10log10[μPu2−μPu+Q(Pu,σαTxL2,γ)μσxb2(2−μPu)],where(34)Q(Pu,σαTxL2,γ)=2μPuσαTxL2(1−γ)1−γ(1−μPu)models the impact of channel variations on performance. It can be noted that the asymptotic performance has a form that is similar to the performance of the spur canceller in [19]. The asymptotic SIR is composed of a static term (due to the presence of the input signalxb(n)) and a dynamic term (34) due to channel variations. The global form of this asymptotic SIR is linked to the stochastic gradient approach, and the difference lies in the use of different pollution models.From the previous result, an optimal functional point can be deduced. First, with (14), we can relate γ toσξTxL2andσαTxL2:(35)γ=1−σξTxL2σαTxL2,withγ≈1as we assumeσξTxL2≪σαTxL2. If we additionally assume thatμPu≪1, the SIR can be approximated by:(36)SIRcomp≈−10log10[μPu2+σαTxL2(1−1−σξTxL2σαTxL2)μσxb2].From (36), an optimal step size can be deduced:(37)μopt=2σαTxL2Puσxb2(1−1−σξTxL2σαTxL2),and reintroducing (37) in (36) leads to the maximal SIR reachable for a given AR1 channel modeling the TxL impact:(38)SIRcompmax=−1210log10[2σαTxL2Pu(1−1−σξTxL2σαTxL2)σxb2]In the previous section, we assumed that the fractional delay δ was perfectly known. In this section, we study the impact of a non-compensated fractional delay on the performance of the complex gain estimator. If we use in the algorithm a reference that is not fractionally delayed, the estimation process of the polluting termsˆTxL(n)would beβˆTxL(n)u(n)[withu(n)defined in (19)], and notβˆTxL(n)uδ(n)[as in (30)].Thus, the reference used in the algorithm would not longer be a perfect image of the polluting term (see (29)) and in this case, the LMS algorithm becomes:sˆTxL(n)=βˆTxL(n)u(n)e(n)=[xb(n)+βTxL(n)uδ(n)]−sˆTxL(n)βˆTxL(n+1)=βˆTxL(n)+μu(n)e(n),and we introduce:(39)ηTxL(n)=uδ(n)−u(n),as the difference between the perfect reference and the used reference. We assume thatηTxL(n)can be modeled as white Gaussian noise, of varianceσηTxL2. On a first approximation (assuming linear interpolation), the variance ofηTxLcan be expressed as (see Appendix B):(40)σηTxL2≈δ2Pu.In the case of a non-compensated fractional delay, the asymptotic performance of the system is a function of the AR1 parameters and the variance of the noise introduced in (39), and it can be expressed as (see Appendix C):(41)SIRcomp≈−10log10[μPu2−μPu+Q(Pu,σαTxL2,γ)μ(σx2+σb2)(2−μPu)+μPu(|β0TxL)|2+σαTxL2)σηTxL2σxb2(2−μPu)+(|β0TxL|2+σαTxL2)σηTxL2σxb2].The asymptotic SIR is composed of four terms: the first and the second are relative to the synchronized LMS performance, and linked to the static error and the dynamic error (due to the AR1 channel), and the two last are due to the non-compensation of the fractional delay. It can be noted that the fractional delay has a non-negligible impact on the asymptotic performance, and it must be compensated for upstream. As δ can be unknown in practice, a joint estimation scheme must be investigated.To jointly estimate the complex channel gainβTxL(n)and the fractional delay δ, we propose the joint estimation process depicted in Fig. 3.The referenceuδn(n)used in the gain estimator algorithm defined in (31)–(32) is obtained fromu(n), which is delayed with a fractional delayδn, with (28). Then, using the outpute(n)of the gain estimator block, the channel estimateβˆTxL(n), the referenceu(n), and the fractionally delayed referenceuδn(n), the update of the fractional delay estimateδn+1is performed with another LMS algorithm. The updated fractional delay estimateδn+1is then used in the next iteration of the compensation scheme.The fractional delay estimation algorithm is based on the minimization of the instantaneous square error|e(n)|2to which a gradient is applied (see Appendix D):(42)Δu(n)=u(n−1)−u(n)(43)δn+1=δn+νℜ{[βˆTxL(n)Δu(n)βˆT+uδn(n)L(n)]e⁎(n)}(44)L(n+1)=(1−μuδn(n)2)L(n)−μd(n)Δu(n)+2μβˆTxL(n)uδn(n)Δu(n),whereL(n)=∂βˆTxL(n)/∂δand ν, the constant step size of the fractional delay estimator. In practice, ν can be chosen in a wide range, but must be normalized by the power of the signalσxb2.The final joint estimation algorithm is composed of (31)–(32), (42)–(44), and it can be expressed as:e(n)=d(n)−βˆTxL(n)uδn(n)βˆTxL(n+1)=βˆTxL(n)+μuδn(n)e(n)Δu(n)=u(n−1)−u(n)δn+1=δn+νℜ{[βˆTxL(n)Δu(n)+uδn(n)L(n)]e⁎(n)}L(n+1)=(1−μuδn(n)2)L(n)−μd(n)Δu(n)+2μβˆTxL(n)uδn(n)Δu(n).It can be seen that this algorithm is recursive, online (as it provides a compensated outpute(n)at each iteration), and with low complexity. A computational complexity comparison is done at the end of Section 6.The performance of the proposed algorithm, and the influence of both channel variations and constant fractional delay are further analyzed by simulations. In this section, the results are presented with respect to the physical parameters given in Table 2 (i.e. the normalized Doppler frequencyfdTRx, the initial SIR and the Ricean factor K). The links between the primary set of parameters (the variance of the time varying channelσαTxL2, the constant interference levelβ0TxLand the speed of the AR1 processσξTxL2) and the physical parameters are done with (25), (26) and (27). Besides, the parametrization of the model depends on the variance of the transmitted samples, assumed to be unitary in the rest of the paper (i.e.σTx2=1that leads toPu=2with (19) under the assumption of a normalized Rx filterhRx(t)). Finally, as TxL is detrimental for the cell edges, where the power of the input signal is low [9] and thus the interference level is strong, we consider an initial SIR of 0 dB withσxb2=10−8.We first consider the synchronized case, in Fig. 4, where the TxL channel is assumed to follow an AR1 model added to a constant value, as described in (12) and (13), and where the fractional delay is assumed to be perfectly known. The K factor defined in (15) is set to 10. We compare the asymptotic theoretical SIR to a simulated one versus the step size of the gain estimation algorithm, for several values of normalized Doppler frequencyfdTRx, and with the optimal step value described in (37). The range of normalized Doppler frequency is set to have a coherence time from approximatively 1 ms (related to worst case scenario in [18]) to several hundred seconds. It is shown that the simulated performance is coherent with the theory, and that the channel influence limits the asymptotic performance.Fig. 5shows the evolution of the simulated maximal SIR versus the normalized Doppler frequency of the AR1 channel, with the Ricean factorK=10, and it validates the theory elaborated in (38). As seen in (25), the faster the channel, the lower the performance. In practice, assuming the knowledge of the statistics of the channel (AR1 varianceσαTxL2, and state noise varianceσξTxL2throughfdTRxwith (25)), the gain estimation process can be optimally tuned to provide the best asymptotic performance.Fig. 6shows the performance of the LMS algorithm versus the step size of the algorithm for several values of K (which represents the ratio between the static and dynamic parts of the TxL channel, expressed in dB). We still consider an AR1 model to approximate the time-varying TxL channel, withfdTRxof10−8. It is shown that the simulation agrees with the theory expressed in (33), and that in the case of a purely static channel (K→∞), the performance of the LMS algorithm becomes linear with respect to the step size, as in this case,Q(Pu,σαTxL2,γ)is negligible. If the static part becomes negligible with respect to the dynamic part (when K, expressed in dB, is negative), the performance reaches a boundary due to the impact of the factorQ(Pu,σαTxL2,γ).We now consider the impact of noncompensation of the fractional delay and the asymptotic performance of the joint estimation scheme. We still use an AR1 model for the TxL channel, as in (13), andfdTRx=10−9. Fig. 7shows the asymptotic performance of the LMS versus the step size, for several values of fractional delay, and we compare this to the synchronized asymptotic performance (33). Again, agreement with the theory described in (41) is shown, and it can be noted that in practice, a fractional delay will severely degrade the performance of the algorithm if it exceeds 0.02, which means 2 percent of the Rx sampling time.This justifies that a joint estimation scheme must be investigated if the fractional delay is unknown. Fig. 7 shows the asymptotic performance of the joint estimation algorithm versus the step size of the gain estimator process, forν=10−6/σxb2. It is shown that this algorithm provides a very good asymptotic performance for different values of fractional delay, as it almost reaches the boundary defined by the theoretical synchronized performance (33). It is also shown that the performance of the proposed algorithm is independent from the FD value, as the performance with the joint estimation algorithm is similar in the range of the simulated FDs.From Fig. 4 to Fig. 6, the desired signal was a complex Gaussian white signal. We recall that the assumption of an uncorrelated (stationary) signal has been made to derive the analytic performance formulae, and we propose in Fig. 8to validate also the theoretical performance on a typical (cyclostationary) signal used in communication systems. We use an orthogonal multiplexing division multiplexing (OFDM) signal with 72 quadrature phase-shift keying (QPSK) subcarriers, a fast Fourier transform of size of 128, and a cyclic prefix of size nine samples for both transmission and reception. We display the asymptotic simulated performances for different fractional delays versus the step-size of the joint estimation algorithm. It is shown that, for this particular use-case, the simulated results corroborate with the theory that was obtained for a white signal in (41).Up to now, we have discussed the performance in terms of the SIR for both correlated and uncorrelated signals. We now look at bit error rate simulations. For this, we assume a FDD framework where the Tx and Rx signals share the same modulation parameters, and where the TxL channel is assumed to be a complex AR1 channel with a fractional delay between the Rx path and the Tx path of 0.2 samples. We synthesize a referenceu(n)following (19) with power of 2 (asσTx2=1), and we assume a power entry signal of−80dB(cell edge context) withK=10andfdTRx=10−9.We first consider a WCDMA framework based on quadrature phase-shift keying modulation. The code is an orthogonal variable spreading factor code of length 16, and a scrambling sequence of size38400is also used. Square root raised cosine filters are used both in transmission and reception, with a roll-off factor of 0.22. We show in Fig. 9the results of the bit error rate performance without the compensation system and with a joint estimation compensation scheme (withμ=2⋅10−5andη=10−6) for different values ofEb/No(where Eb is the energy per bit, andN0is the white additive noise spectral density), and for different SIRs. Here, the initial SIRs are computed from only the power of the desired signal, without taking into account the additive white noise, to have constant TxL pollution power versus the channel signal-to-noise ratio. We show that our method greatly reduces the bit error rate, and that the compensated bit error rate comes close to the ideal channel influenceQ(2Eb/N0).We now compare the bit error rate for the case of simplified long-term evolution (LTE) modulation that is based on the third generation partnership project model [28]. The data signal follows LTE 1.4 MHz bandwidth specifications based on OFDM, with 72 quadrature phase-shift keying subcarriers, a fast Fourier transform of size 128, and a cyclic prefix of length of nine samples. The bit error-rate is computed on the uncoded bits of the data and through an additive white Gaussian noise channel with various signal-to-noise ratios. We consider that the noisy signal is polluted by TxL and that the transmitted signal has the same modulation parameters. Fig. 10shows the results of the bit error rate without compensation and with the joint estimation scheme (withμ=2⋅10−5andη=10−6) for different values of the channel signal-to-noise ratio and for different SIRs. The theoretical performance without TxL (i.e., only the influence of the channel) is shown in black in Fig. 10. Again, it shows that TxL has a detrimental impact on performance, and that the proposed system greatly reduces the bit error rate.In this paper, we have assumed a frequency flat channel for the duplexer that is equivalent to consider a Dirac distribution as a time impulse response. As a consequence, the compensation scheme aims to estimate the amplitude of this Dirac and its fractional delay. Frequency flat duplexer channels are often used in the literature, as for example by [16,5,29,22], and this hypothesis can be partially justified through a typical isolation profile, as described for example by [30], which shows only a little attenuation variation in the transmission and reception bands (typically less than 2 dB). However, a purely frequency flat channel is a limiting case, and as in practice, it is equivalent to an estimation of only the mean contribution of the filter, with the other contributions of the TxL filter being neglected. A more realistic assumption would be to consider a quasi-flat TxL channel i.e., a filter with a main but nonunique component in its time impulse response.From the initial profile, we propose to synthesize a filter that respects the initial pattern proposed by [30]. We next apply our method on a polluting model, where the complex gain is replaced by the synthesized filter. We assume here nontime-varying filter coefficients and an important oversampling factor. The frequency and time impulse responses obtained are shown in the Fig. 11.The synthesized time impulse response is narrow with respect to the receiver sampling timeTRx, which is coherent with a quasi-flat channel assumption. The proposed joint estimation algorithm estimates and suppresses the most important component of the filter impulse response, and we show in Fig. 12the convergence of the complex gain and the fractional delay, and the mean performance of the structure. This shows that even in a quasi-flat channel, the proposed structure has good performance and can reduce the influence of the TxL pollution. In such a case, the fractional delay estimated by our algorithm is expected to converge to the position of the maximum of the time impulse response of the synthesized filter (this position is denoted as ‘expected fractional delay’). We want to now compare our method with the TxL compensation method presented by [15] (and variations of this method can be found in [16,22,31]), based on a multitap LMS canceller. Fig. 13compares the performances of this multitap-LMS (with 8 taps) and the performance of the proposed scheme for the synthesized filter, with several values of the expected fractional delay. It can be seen that the proposed scheme has better asymptotic performance than the multitap LMS, especially in the case of a nonnegligible fractional delay value. We finally compare in Table 3the complexity (real operators) of the proposed JE algorithm, in terms of additions, multiplications and shifts (as the steps μ and η are tuned to a power of 2) and a comparison with the classical multi-tap LMS versus the number of the taps and applied for 8 taps, as used in Fig. 13. It is shown that the proposed method, in addition to have better asymptotic performance than classical multi-tap approach even in the proposed frequency selective TxL channel scenario, also offers a lower computational complexity.

@&#CONCLUSIONS@&#
