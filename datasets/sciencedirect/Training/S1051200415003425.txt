@&#MAIN-TITLE@&#
Optimum single-tap per-subcarrier equalization for OFDM/OQAM systems

@&#HIGHLIGHTS@&#
An equivalent model of the standard transceiver for OFDM/OQAM systems is derived.The impulse response of the equivalent filter in multipath channels is obtained.The optimum single-tap equalizer according to the maximum SIR criterion is designed.It is related to the inverse of a specific coefficient of the derived impulse response.Under particular conditions it reduces to the standard single-tap equalizer.

@&#KEYPHRASES@&#
Filter bank multicarrier,OFDM/OQAM,Signal-to-interference ratio,Single-tap equalizer,

@&#ABSTRACT@&#
An equivalent multi-input multi-output (MIMO) linear model of the standard transceiver for OFDM/OQAM systems is derived. Specifically, the impulse response of the equivalent filter that determines the effect on each output of the symbol sequence transmitted on each subcarrier, both with reference to AWGN and multipath channels, is obtained. The derived model is exploited for the design of the optimum single-tap per-subcarrier equalizer according to the maximum signal-to-interference ratio criterion. It is shown that the optimum single-tap equalizer in the absence of guard subcarriers is the inverse of a specific coefficient of an impulse response of the derived MIMO model. This coefficient under particular conditions leads to the conventionally used single-tap equalizer given by the inverse of the channel frequency response at the frequency of the considered subcarrier. The effects of guard subcarriers and the inclusion of the noise term in the cost function are also studied.

@&#INTRODUCTION@&#
In the last years, filter-bank based multicarrier (FBMC) systems have been considered for high data-rate transmissions over both wired and wireless frequency-selective channels. One of the most famous multicarrier modulation techniques is orthogonal frequency division multiplexing (OFDM), other known types of FBMC systems are filtered multitone systems [1] and OFDM based on offset QAM modulation (OQAM) [2] whose use has been suggested in many scenarios [3].While the OFDM approach inserts the cyclic prefix after the IFFT, OFDM/OQAM systems (aiming at improving the spectral efficiency) do not use it. Then, in order to combat the effects of frequency-selective channels, they complement the IFFT with a set of digital subchannel filters, obtained by complex modulation of a single filter, usually called polyphase network (PPN). The use of the PPN implies some fundamental differences between OFDM and OFDM/OQAM systems [3]: e.g., the adoption in the latter case of pulse shaping filters very well localized in time and frequency [4–6].In this paper we derive an equivalent model of the OFDM/OQAM standard transceiver with multiple inputs and outputs. Its inputs are represented by the symbol sequences transmitted on each active subcarrier; the outputs of such a model are the sequences of the decision variables used for final decisions at the receiver outputs. The derived model, which is exact and not approximate, provides an expression for the impulse response of the equivalent filter that determines the effect on each subcarrier output of the symbol sequence transmitted on each subcarrier, both with reference to AWGN and multipath channels; moreover, the complete characterization of the equivalent noise process is provided. A similar model has been derived in [7,8] and [4]. However, the equivalent model in [7] is explicitly expressed only with reference to the asymptotic approximation of a large number of subcarriers, the model in [8] is not explicitly derived but some of its properties are directly used for channel estimation, and, finally, in the model described in [4] the existence of the linear relation is clearly shown but the analytic expressions of the overall impulse responses are not derived. Moreover, in [7] and [4] the characterization of the additive disturbance depending on the channel noise is neglected.The obtained equivalent model is exploited for the design of the optimum (according to the maximum signal-to-interference ratio (SIR) criterion) single-tap per-subcarrier equalizer for OFDM/OQAM systems, which can be easily implemented in practice and is considered important for maintaining a step-by-step equivalence between OFDM/OQAM and OFDM complexities. It is shown that the optimum single-tap equalizer in the absence of guard subcarriers is simply the inverse of a specific coefficient of an impulse response of the derived model. This coefficient under particular conditions leads to the conventionally used single-tap equalizer given by the inverse of the channel frequency response at the considered subcarrier frequency. Moreover, the effects of guard subcarriers and the inclusion of the noise term in the cost function are studied.The paper is organized as follows. In Section 2 the OFDM/OQAM standard transceiver is recalled and, in Section 3, its equivalent model is derived. In Section 4 the optimum single-tap equalizer is derived, in Section 5 some realistic issues related to the implementation of the proposed methods are considered, and in Section 6 some simulation results are reported. Finally, in the conclusions, the main results are summarized.Notation:j=△−1, superscript(⋅)⁎denotes the complex conjugation, superscript(⋅)Tthe transpose,ℜ[⋅]the real part,ℑ[⋅]the imaginary part,E[⋅]the statistical expectation,δ[i]the Kronecker delta,|⋅|the absolute value,floor[x]denotes the largest integer smaller than or equal to x,〈⋅〉denotes the time average, i.e.,〈x[n]〉=△limN→+∞⁡12N+1∑n=−NNx[n]andmodM(ℓ)=△ℓ−qMwith q such thatmodM(ℓ)∈{0,1,…,M−1}. Moreover, ⊗ denotes the linear convolution,⊗Mdenotes the circular convolution, i.e., given the signalsxl[n]andyl[n](1)xl[n]⊗yl[n]=∑ℓ=−∞+∞xl(ℓ)yl(n−ℓ)and, given the sequencesxc[n]andyc[n], null whenn∉{0,1,…,M−1},(2)xc[n]⊗Myc[n]={∑ℓ=0M−1xc(ℓ)yc(modM(n−ℓ))n∈{0,1,…,M−1}0n∉{0,1,…,M−1}.Furthermore,DFT[x]denotes the vectorx˜whose kth component can be written asx˜k=1M∑i=0M−1xiexp⁡(−j2πki/M)wherexidenotes the ith component of x (i=0,1,…,M−1). Finally, lowercase boldface letters denote column vectors and ⊙ denotes the Hadamard product.Let us consider an OFDM/OQAM system with an even number M of subcarriers [4]. The lowpass version of the transmitted signal is obtained by D/A conversion of the discrete-time signals[i]equal to(3)s[i]=sR[i]+jsI[i−M/2]with(4)sR[i]=∑n=−∞+∞∑k∈Aan,kRθkejk(2πMi+π2)g[i−nM]sI[i]=∑n=−∞+∞∑k∈Aan,kIθkejk(2πMi+π2)g[i−nM]where M is the discrete-time duration of the OFDM/OQAM symbol interval,A⊂{0,…,M−1}is the set of active subcarriers whose size isMu, the sequencesan,kRandan,kIindicate the real and imaginary parts of the complex data symbols transmitted on the kth subcarrier during the nth OFDM/OQAM symbol, and the real prototype filterg[i]satisfies the following properties(5){g[i]=0∀i∉{1−a,2−a,…,KM−1}(a)g[KM/2+i]=g[KM/2−i−a]∀i(b)ℜ{θ−2mwgmM/2[pM]}≃Egδ[m]δ[p]∀p,∀m∈{0,1,…,M/2−1}(c)where K is the overlap parameter,Egandwgα[p]are the energy(6)Eg=△∑i=−∞+∞g2[i]and the ambiguity function of the prototype filterg[⋅]:(7)wgα[p]=△∑i=−∞+∞g[i]g[i−p]e−j2παi.The parameter a in (5b) is defined according to the type of symmetry chosen for the prototype filter, specifically(8)a={0odd symmetry1even symmetrymoreover,(9)θ=exp⁡(jπaM).Since the symmetry property in (5b) implies that(10)ℑ{θ−2mwgmM/2[pM]}=0∀p,∀m∈{0,1,…,M/2−1},in the set of properties (5), the property (5c) is usually imposed as(11)wgmM/2[pM]≃Egδ[m]δ[p]∀p,∀m∈{0,1,…,M/2−1}and expressed as (see, for example, the condition (16) in [6]):(12)∑ℓ=−∞+∞g[i−ℓM2]g[i−pM−ℓM2]≃2EgMδ[p],∀i.The equivalence between (11) and (12) is straightforward.As shown in [9,10], the transmitted signals[i]can be obtained by using the polyphase network structure or the frequency-spreading structure, which is particularly suited to the case where the prototype filter is designed by the frequency-sampling method [5]. According to (3) and (4), the transmitted signals[i]can be written as(13)s[i]=∑n=−∞+∞∑k∈Ajn+kan,kejk2πM(i−nM2)θkg[i−nM2]where we have defined the variablean,kas follows(14){a2n,k=△(−1)nan,kRa2n+1,k=△(−1)nan,kI.The sequencean,krepresents the real part or the imaginary part of the complex-valued QAM symbol introduced in the definitions (3) and (4); thus, it is a sequence of real-valued symbols transmitted with double rate on the kth subcarrier that has to be recovered at the receiver side. We regard the M different sequencesan,k,k∈{0,1,…,M−1}, as the inputs of the equivalent model that we are going to derive. When their statistical properties are concerned, we assume that the real sequencesan,ksatisfy the following property:(15)E[an1,k1an2,k2]={Pan1=n2,k1=k2∈A0otherwise.We consider three possible channels, the AWGN channel where the received signalr[i]can be written as follows(16)r[i]=s[i]+η[i]the pure-delay channel wherer[i]is equal to(17)r[i]=s[i−nτ]+η[i]and the multipath channel wherer[i]can be written as(18)r[i]=∑ℓ=0Lhh[ℓ]s[i−ℓ]+η[i].In (18) the complex-valued sequenceh[i]of lengthLh+1models the multipath channel.In (16)–(18) the noise termη[i]is assumed to be the ith sample of the low-pass equivalent of a white Gaussian random process with null average and power spectral density equal toN0/2in the signal bandwidth; the analog low-pass equivalent has null average and power spectral density equal to2N0. The low-pass equivalent is sampled with sampling periodTs; assuming an ideal antialiasing filter with bandwidth equal to1/(2Ts), the random variableη[i]ideally sampled at the filter output has null average and varianceVAR[η[i]]=2N0/Ts. Moreover, the sequenceη[i]is zero-mean, white, Gaussian and circularly symmetric; thus,(19)E[η[n]η⁎[n−m]]=2N0Tsδ[m]E[η[n]η[n−m]]≡0.The considered receiver first evaluates the termsDn,kdefined as follows(20)Dn,k=△1A∑i=−∞+∞r[i]j−k−ne−jk2πM(i−nM2)θ−kg[i−nM2]=j−k−nθ−kA∑i=1−aKM−1r[nM2+i]e−jk2πMig[i]where we have used (5a). It is well known (see, for example, the proof in Appendix A of [11]) that the receiver using the real part ofDn,kis optimum according to the ML criterion on the AWGN channel provided that the prototype filterg[⋅]is properly chosen (i.e., according to the conditions (5)). In fact, the conditions (5b) and (5c) imply thatDn,kis practically independent ofan−δ,modM(k−q)for(δ,q)≠(0,0)while the definition (13) implies that (20) represents the output of the filter matched to the useful pulse on an AWGN channel. The constant A is defined in order to guarantee that, on AWGN channel and in absence of noise,ℜ{Dn,k}=an,k; therefore, accounting for (13) and for the useful-signal power reduction introduced by the channel, it follows that(21)A=PrPsEgwherePr=△〈E[|h[i]⊗s[i]|2]〉denotes the average power of the useful component of the received signalr[i]andPs=△〈E[|s[i]|2]〉denotes the average power of the transmitted signals[i]that can be evaluated by exploiting the results reported in Appendix A. The M different sequencesDn,k,k∈{0,1,…,M−1}, are regarded as the outputs of the equivalent model we are going to derive.The decision variableDn,k, which is the output of our model, can be decomposed in a deterministic termDn,k(D)and in a random termDn,k(N)that accounts for the noise effect:(22)Dn,k=△Dn,k(D)+Dn,k(N).While the random term(23)Dn,k(N)=△θ−kj−k−nA∑i=1−aKM−1η[nM2+i]e−jk2πMig[i]does not depend on the channel, the deterministic term assumes a different expression on each considered channel. We first consider the pure-delay channel where the deterministic term, accounting for (20), can be expressed as follows(24)Dn,k(D)=Dn,k,nτ(Δ)=△θ−kj−k−nA∑i=1−aKM−1s[nM2+i−nτ]e−jk2πMig[i].Then, it is straightforward to express the deterministic term on the other two channels on the basis of its valueDn,k,nτ(Δ)on the pure-delay channel:(25)Dn,k(D)={Dn,k,0(Δ)AWGN channel∑ℓ=0Lhh[ℓ]Dn,k,ℓ(Δ)multipath channel.When the pure-delay channel is considered, as shown in Appendix B, the deterministic term can be written as follows(26)Dn,k,nτ(Δ)=∑q=0M−1In,q(nτ,k)⊗an,modM(k−q)where the linear convolution ⊗ has to be performed with respect to the index n and(27)In,q(nτ,k)=△j−n−q(−1)n(k−q)e−j2πM(k−q)nτθ−qwgqM[−nM2+nτ]Eg.The expression (26) provides a multiple-input multiple-output (MIMO) relation among the M input sequencesan,kand the M output sequencesDn,k,nτ(Δ); more specifically,In,q(nτ,k)represents the impulse response of the equivalent channel between themodM(k−q)th input sequence and the kth channel output.The expression of the deterministic term on AWGN channel is obtained by settingnτ=0in (26) and (27); specifically, we obtain(28)Dn,k(D)=∑q=0M−1In,q(k)⊗an,modM(k−q)with(29)In,q(k)=j−n−qθ−q(−1)nk(−1)nqEgwgqM[−nM2].The expression (28) provides a MIMO relation among the M input sequencesan,kand the M output sequencesDn,k(D), which specializes the more general model already derived for the pure-delay channel to the casenτ=0; in particular, in such a case, only the sign of the impulse response for odd n is different on the various subcarriers (i.e.,In,q(k)for n even and|In,q(k)|for all n are independent of k).The considered model is often used for the basic transceiver design, though it is a special case of the other two models; in particular, the relation (28) obviously shows the following equivalence:(30)ℜ{Dn,k(D)}=an,k∀n,∀k⇔ℜ{In,q(k)}=δ[n]δ[q]∀n,∀q∈{0,1,…,M−1}.When the expression (29) is taken into account, the conditions (5b) and (5c) imposed to the prototype filter imply the condition in the right-hand side of (30) and, therefore, guarantee the optimality of the receiver (20) on AWGN channel; this is well known in the literature (see [6], for example).The expression of the deterministic term on multipath channel is obtained by resorting to (25) and (26):(31)Dn,k(D)=∑ℓ=0Lhh[ℓ]{∑q=0M−1In,q(ℓ,k)⊗an,modM(k−q)}=∑q=0M−1In,q(h,k)⊗an,modM(k−q)with(32)In,q(h,k)=△∑ℓ=0Lhh[ℓ]In,q(ℓ,k)=j−n−qθ−q(−1)n(k−q)Eg∑ℓ=0Lhh[ℓ]wgqM[−nM2+ℓ]×e−j2πM(k−q)ℓ.Let us note thatIn,q(h,k)represents the impulse response of the equivalent channel between themodM(k−q)th input and the kth channel output. Moreover, the impulse responseIn,q(h,k)in (32) depends on the considered subcarrier k (and not only for the sign as is forIn,q(k)in (29)) since the channel impulse responseh[ℓ]modifies each subcarrier response. In Fig. 1a scheme that illustrates the derived MIMO model is depicted.Note also that from (7), and (5a), forℓ∈{0,1,…,Lh}, it follows that(33)wgqM[−nM2+ℓ]=0n∉{n0[ℓ]−(2K−1),…,n0[ℓ]+2K}wheren0[ℓ]=△floor[ℓ/(M/2)]is defined so that−n0[ℓ]M/2+ℓ∈{0,1,…,M/2−1}. Thus, from (32) and (33), it follows that(34)In,q(h,k)=0n∉{n0[0]−(2K−1),…,n0[Lh]+2K}and, therefore, the impulse responseIn,q(h,k)has finite length4K+floor[Lh/(M/2)]sincen0[0]=0. Moreover, note thatn0[Lh]=0forLh<M/2.Consider that, whenwgqM[−nM2+ℓ]in (32) is weakly dependent on ℓ (i.e.,wgqM[−nM2+ℓ]≃wgqM[−nM2]forℓ∈{0,1,…,Lh}), the impulse responseIn,q(h,k)can be approximated as follows:(35)In,q(h,k)≃j−n−q(−1)n(k−q)θ−qEgwgqM[−nM2]∑ℓ=0Lhh[ℓ]e−j2πM(k−q)ℓ=j−n−q(−1)n(k−q)θ−qEgwgqM[−nM2]H(k−qM)whereH(pM)represents the Fourier transform of the impulse responseh[ℓ]at the normalized frequencyF=p/M. The approximation in (35) has been used for channel estimation in [12–14] and for joint synchronization and channel estimation in [15,16]. Moreover, it allows to derive the standard implementation of the zero-forcing single-tap per-subcarrier equalizer [17]. In fact, from (31) it follows that, on the kth subcarrier, the coefficient multiplying the useful terman,kisI0,0(h,k)and (35) shows that it can be approximated with(36)I0,0(h,k)≃H(kM)wg0[0]/Eg=H(kM)provided that the ambiguity function in (32) is weakly dependent onℓ∈{0,1,…,Lh}.The overall model (31) describes the effects determined at the receiver output by the multipath channel. However, it is interesting to note that the same model can also describe the case where a prefilter is applied at the transmitter output in order to reduce the channel distortion under the assumption that the transmitter knows the channel state. In such a case, therefore, the pulseh[⋅]in (32) describes the cascade of the prefilter (at the transmitter output) and the multipath channel. Consequently, the derived model can also be exploited in scenarios similar to that considered in [18] where the prefilter optimization is considered. However, we consider in the next sections only the case where the pulseh[⋅]in (32) is fixed.Sinceη[i]is a zero-mean Gaussian process, the definition (23) guarantees that also the noise componentDn,k(N)is zero-mean and Gaussian. Moreover, sinceη[i]is a circular process (see (19)), the pseudo-correlation [19,20]E[Dn,k1(N)Dn−m,k2(N)]=0, thus, to complete the characterization of the noise component in the model, we derive in Appendix C the joint correlation between the noise components on the subcarriersk1andk2:(37)E[Dn,k1(N)Dn−m,k2(N)⁎]=2N0|A|2Tsjk2−k1−mθk2−k1(−1)k2mwgk1−k2M(−mM2).Consequently, it follows that(38)E[|Dn,k(N)|2]=2N0Ts|A|2wg0[0]=2N0PsPrTsEg=2Paγwhere we have used (15), (21), and the following definitions(39)Es=△PrTsM2Muγ=△EsN0and the result, derived in Appendix A, that the powerPsof the signals[i]in (13) isPs=2MuMPaEg. Finally, accounting for (38), (37) can be rewritten as(40)E[Dn,k1(N)Dn−m,k2(N)⁎]=2PaγrD(N)[m,k1,k2]with(41)rD(N)[m,k1,k2]=△jk2−k1−mθk2−k1(−1)k2mwgk1−k2M(−mM2)Eg.In the present section, by exploiting the results reported in the previous section, we derive the optimum single-tap equalizer according to the maximum SIR criterion for the case where(42)A=AMAM=△{0,1,…,M−1}and with reference to the most general channel model considered in Section 3, the multipath channel. Using the MIMO model derived in Section 3 (more specifically, the relations (22) and (31)) and the assumption (42), the decision variable on the kth subcarrier can be written as(43)Dn,k=∑q=0M−1∑δ=n1n2Iδ,q(h,k)an−δ,modM(k−q)+Dn,k(N)withn1=−(2K−1)andn2=n0[Lh]+2K. The single-tap equalizer multiplies the decision variableDn,kby the constant complex-valued single-tap coefficientWkbefore real-part extraction for obtaining the final decision-variableDn,k(E):(44)Dn,k(E)=ℜ{WkDn,k}.Using (43) in (44), we can write(45)Dn,k(E)=∑q=0M−1∑δ=n1n2ℜ{WkIδ,q(h,k)}an−δ,modM(k−q)+ℜ{WkDn,k(N)}.Therefore, using (15) and (42), the SIR on the kth subcarrier can be written as(46)SIRk=ℜ2{WkI0,0(h,k)}∑q=0M−1∑δ=n1n2ℜ2{WkIδ,q(h,k)}−ℜ2{WkI0,0(h,k)}.We can first notice thatSIRkdepends only on the phase of the complex numberWk. Therefore, we can also impose the following condition(47)ℜ{WkI0,0(h,k)}=1that can be satisfied by choosing the proper value of|Wk|without affecting the achieved value ofSIRk. The value ofWkthat maximizes theSIRkwithout satisfying (47) often achieves a larger BER unless an antipodal constellation is considered foran,k(i.e., the 4-QAM constellation is considered for the complex-valued symbolan,kR+jan,kI), though such a loss does not appear in terms ofSIRk. Consequently, using the expression (46), the problem of maximizing theSIRkunder the constraint (47) is equivalent to the following constrained optimization problem(48){minWk⁡∑q=0M−1∑δ=n1n2ℜ2{WkIδ,q(h,k)}ℜ{WkI0,0(h,k)}=1whose solution can be written as (see Appendix D)(49)Wk=[I0,0(h,k)]⁎−I0,0(h,k)[Rk⁎/Qk]|I0,0(h,k)|2−ℜ{[I0,0(h,k)]2[Rk⁎/Qk]}where(50)Qk=△∑q=0M−1∑δ=n1n2|Iδ,q(h,k)|2Rk=△∑q=0M−1∑δ=n1n2[Iδ,q(h,k)]2.It is interesting to note that, whenRk=0, the optimumWkbecomesWk=1I0,0(h,k), i.e., the optimumWkis obtained by imposing the following condition(51)WkI0,0(h,k)=1which is different from the constraint (47) because it imposes also that the imaginary part ofWkI0,0(h,k)is null. Moreover, the standard choice(52)Wk=1/H(kM)which is usually adopted on a practical basis without investigating about its optimality, becomes the optimal choice when the approximation (36) can be used in (51); however, when the approximation (36) does not hold, the standard equalizer is not equivalent to the optimum equalizer (51) any more. Therefore, it becomes interesting to investigate the conditions under whichRk=0as well as the condition under which the approximation (36) holds. Under the assumption (42) (i.e., in the absence of guard subcarriers), the statistical pseudocorrelation of the transmit signal is null (see Appendix E):(53)E[s[i]s[ℓ]]=0∀i,∀ℓ.From (24) and (53), it follows that(54)E[Dn,k,ℓ1(Δ)Dn,k,ℓ2(Δ)]=0∀ℓ1,∀ℓ2and, from (25) and (54), it easily follows that, on a multipath channel,(55)E[(Dn,k(D))2]=0.On the other hand, from (31), (15), and (42), it easily follows that(56)E[(Dn,k(D))2]=PaRk.From (55) and (56) it follows thatRk=0; consequently, (51) is a general condition for settingWk.In this section, we consider some realistic issues related to the implementation of the proposed method for the design of the single-tap equalizer. In particular, we extend the method to the cases where some guard subcarriers are present and where the noise term is included in the cost function in Subsections 5.1 and 5.2, respectively. Moreover, we discuss the application of the proposed method to a multiuser scenario in Subsection 5.3 and, finally, we address the evaluation of the complexity for generating the coefficientWkin Subsection 5.4.In the previous section we have used the assumption (42) for deriving (46) from (45). However, since some guard subcarriers are usually employed in the realistic systems, it is reasonable to modify the expression (46) to write theSIRkin the caseA≠AM: in such a case, the sum over q at the denominator of (46) has to be replaced by the sum over the setAkdefined11In particular, when the set of useful subcarriers belongs to the interval fromk1tok2(with each indexk1,k2∈{0,…,M−1}), the setAkcan be written as the union of the intervalsAk(1)andAk(2)whereAk(1)is the interval ranging from 0 tok−k1andAk(2)is the interval ranging fromM−(k2−k)toM−1.as follows:(57)Ak=△{q∈{0,1,…,M−1}:modM(k−q)∈A}.The resulting modified expression of theSIRkis still maximized by the expression (49) provided that the sums over q in (50) are replaced by sums overAk.The exact expression of the optimumWkwould therefore require to calculate the values ofRkandQkfor each value of k. However, one should note that the terms excluded from the sums in (50), which depend on k, are usually marginal and, therefore, the result obtained in absence of guard subcarriers can be used also in its presence. More specifically, the quantitiesIδ,q(h,k), involved in the definition ofQkandRk, are such that the sums in (50) are dominated by the terms obtained forq∈Qβ=△{0,…,β,M−β,…,M−1}, i.e.,(58)∑q=0M−1∑δ=n1n2|Iδ,q(h,k)|2≃∑q∈Qβ∑δ=n1n2|Iδ,q(h,k)|2∑q=0M−1∑δ=n1n2[Iδ,q(h,k)]2≃∑q∈Qβ∑δ=n1n2[Iδ,q(h,k)]2.Such approximations express the property of the prototype filter to concentrate a large percentage of its energy in the interval(−β/M,β/M)of the frequency domain; therefore, using such a property and the relations (7) and (32), we can easily verify that the pulsesg[i]e−j2πqi/Mandg[i−p]exhibit a minimum overlap forq∉Qβand the termsIδ,q(h,k)in (50) can be neglected for such values of q. The approximations (58) imply that(59)Qk≃∑q∈Qβ∑δ=n1n2|Iδ,q(h,k)|2Rk≃∑q∈Qβ∑δ=n1n2[Iδ,q(h,k)]2∀k∈AI=△{k∈A:Qβ⊂Ak}.In fact, for the internal subcarriers, defined as those subcarriers with the indexk∈AI, the sum overAk, which is present in the new definition ofQkandRkto be used in the presence of guard subcarriers, contains the most interesting values ofq∈Qβaccording to (58). The expression (59) forRkand the approximation (58) imply that, for internal subcarriers,Rk≃0and, therefore, also in the presence of guard subcarriers, the optimum value ofWkfor internal subcarriers can be practically determined by (51).Almost all the subcarriers are internal; in fact, the extreme subcarriers, defined as the subcarriers with indexk∈AE=△A−AI, are located at the borders of the setA, which are close to a guard subcarrier. In particular, if the set of active subcarrierAis the interval fromk1tok2,AE=△{k1,…,k1+(β−1),k2−(β−1),…,k2}and, therefore,AEcontains only the two extreme indices{k1,k2}when the choice of the prototype filter guarantees thatβ=1, e.g., the Phydyas filter [5]. In such a case, for the two extreme subcarriersk1andk2, the optimum value ofWkis determined by (49) withQkandRkevaluated as follows:(60)Qk≃∑q∈QkE∑δ=n1n2|Iδ,q(h,k)|2Rk≃∑q∈QkE∑δ=n1n2[Iδ,q(h,k)]2QkE=△{{−1,0}k=k1{0,1}k=k2It is interesting to evaluate the modifications introduced in the design procedure when also the noise termℜ{WkDn,k(N)}in (45) is included in the cost function by adding its power to that of the interference terms. Using (38) and the circularity of the noise process, such a power can be easily written asPa|Wk|2/γ; consequently, the choice of the signal-to-interference-plus-noise ratio (SINR) as cost function implies that the denominator of the SIR cost function in (46) has to be modified by adding the quantity|Wk|2/γ. Therefore, the function to be optimized in (48) has to be modified by adding the quantityℜ2{Wk1γ}+ℜ2{Wkjγ}, which does not alter the structure of the optimization problem. For such a reason, its solution can be still expressed by (49) provided that the expression ofQkin (50) is modified by adding the term|1γ|2+|jγ|2=2/γwhile the expression ofRkin (50) is still valid for the considered SINR cost function because(1γ)2+(jγ)2=0. The same quantity2/γhas to be added to the expression ofQkin (60) when the effects of the guard subcarriers are considered.For such reasons, the SINR design procedure coincides with the SIR design procedure except for the need to add the quantity2/γin the expression ofQkin (50). This is a minor modification for the following reasons: (a) the expression of the optimum solution in (49) does not depend on the quantityQkifRk=0; (b) the caseRk=0occurs on all subcarriers forA≡AM; (c) the caseRk≃0occurs on almost all subcarriers in the caseA≠AM; (d) when the value of γ is limited andA≠AM, only on the extreme subcarriers the use of the SINR cost function produces a slightly different solution.The considered transceiver scenario refers, for sake of clarity, to the case where a single transmitter is using the subcarriers in the setAand a single receiver is present. However, we can trivially extend the considered scenario to the downlink of a multiuser OFDM/OQAM scenario where a single transmitter operates with reference to several receivers; in such a case, each receiver is associated with a different channel responseh[⋅]and is interested to a subset of the active subcarriers with indices inA. The coefficientWkto use on the subcarriers of interest is straightforwardly determined, for each receiver, by the same proposed method. The use of the proposed method for the uplink of a multiuser OFDM/OQAM scenario is less straightforward; however, also in such a scenario, the model derived for point-to-point transceiver can be easily exploited in order to derive the optimum coefficientsWkon each subcarrier of interest provided that the impulse responses (from each transmitter to the single receiver) are available.Let us evaluate the computational complexities of the three methods for single-tap equalizer design by assuming that the channel impulse responseh[⋅]is available and the normalized ambiguity functionwgqM[⋅]/Egof the prototype filter is stored once for all.The standard single-tap equalizer requires to determine its FFT over M points (whose complexity is quantified here as4Mlog⁡(M)−6M+8) or to directly use the definition (32) before inverting the obtained values; therefore, such design method requires(61)Mmin⁡(4log⁡(M)−6+8/M,2Lh+1)+6Mflops and no storage of samples of the ambiguity function is needed.The improved equalizer whose single-tapWkis designed according to (51) and therefore, requires to evaluateI0,0(h,k)and to invert it for the M values of k. We first need2(Lh+1)real-valued flops to evaluate the quantityh[ℓ]wg0[ℓ]/Egforℓ∈{0,1,…,Lh}sincewg0[⋅]is real-valued. Moreover, we can determineI0,0(h,k)for all k by using the FFT or the direct evaluation; finally, we have to invert it. Consequently, such design method requires the following number of flops:(62)2(Lh+1)+Mmin⁡(4log⁡(M)−6+8/M,2Lh+1)+6Mand the number of samples of the normalized ambiguity functionwg0[ℓ]/Egto be stored has to be not smaller than the maximum value achievable by the normalized delay spreadLh. Therefore, the difference in their complexities is very marginal and just lies in the first2(Lh+1)flops that are needed to multiplyh[ℓ]andwg0[ℓ]/Egaccording to the definition (32).Finally, the computational complexity needed to design the optimum equalizer according to (49) whereQkandRkare defined in (50) is much larger. For each value of k, it needs to calculateIn,q(h,k)for 4K different values of n according to (33) (at least if the conditionLh<M/2is satisfied) and for2β+1values ofq∈Qβ; moreover,2(2β+4K)additions are needed to determineQkandRkusing the approximations in (58); finally, the values ofRkandQkhave to be used in (49) to determineWk, which requires 25 flops. Consequently, for each value of k, the total number of flops can be written as(63)(4K)(2β+1)(6(Lh+1)+min⁡(4log⁡(M)−6+8/M,2Lh+1))+2(2β+4K)+25On the extreme subcarriers the quantity 2β has to be replaced by β, since the sum over q includes onlyβ+1terms. The complexity of the optimum equalizer is much larger than that of the two previously considered structures. For example, when the Phydyas filter [5] is chosen as prototype filter (i.e.,β=1), in a scenario withA≡AMand the parameters M, K, andLhset as follows:M=1024,K=4, andLh=6, the flops required by the three equalizers are 19,456, 19,470, and 2,765,824, respectively, i.e., the complexity increase of the improved equalizer in comparison with the standard equalizer is irrelevant while the complexity of the optimum equalizer is more than two orders of magnitude larger than that of the other two equalizers. Moreover, the number of real-valued samples to store in memory is 2M times larger than that required by the improved equalizer.This section is devoted to the performance analysis of the previously considered single-tap structures under the following experimental setting:•the considered OFDM/OQAM system hasM=256subcarriers with an overlap parameterK=4;the used prototype filter is that proposed in [5], i.e., we can writeg[n]=G0+2∑i=1K−1Gicos⁡(2πiKMn)forn∈{1,2,…,KM−1}, and zero otherwise with the coefficientsG0=1,G1=−0.97196,G2=1/2, andG3=−0.235147;the system exploits a one-tap per-subcarrier equalizer with perfect knowledge of the channel; in particular, we have considered three cases for the design of the equalizer coefficient:–the standard single-tap equalizer where the coefficientWkis designed according to (52);the improved single-tap equalizer where the coefficientWkis designed according to (51);the optimum single-tap equalizer where the coefficientWkis designed according to (49) whereQkandRkare defined in (50);the considered multipath fading channel models are the ITU-R Vehicular A and the ITU-R Vehicular A Extended [21]; they both have the same profile of the relative power, which, expressed in dB, can be written as[0−1−9−10−15−20]while they have different delay profiles. The channel ITU-A has a delay profile equal to[037111725]while the channel ITU-A Extended has a delay profile equal to[0371117100]; in both cases, we have expressed the delays in terms of discrete samples with reference to a bandwidth of10MHz; they are proportionally modified for other values of the set of bandwidths considered here:{10,15,20,25}MHz;we have used the following two sets of active subcarriers{1,…,M/2−M16}and{M/2+M/16,…,M−1};the number of Monte Carlo trials is set to 104 for the experiments aimed at evaluating the BER and to 103 for the experiments aimed at evaluating the signal-to-interference-and-noise ratio.We have first used the derived transceiver model in order to simply express the SINR of the decision variable obtained at the output of the three single-tap receivers. Using such expression, we have compared the improved single-tap equalizer (51) with the standard single-tap equalizer on channel A; in order to appreciate the effects of the interference symbols on the useful decision variable, the background noise power level is set so that the ratio γ in (39) is fixed atγ=30dB. We have considered the difference (in dB)Δ−SINRbetween the SINR achieved by the improved equalizer and that achieved by the standard one. We have collected the values of such a difference for the7M/8active subcarriers and for the 103 Monte Carlo trials in a vector v; in Fig. 2we report the percentage of components of the vector v (i.e., the fraction of subcarriers for the different channel realizations) for which the advantageΔ−SINRis obtained. The results show that often the SINR advantage is much limited on channel A; in particular, a small advantage of the improved equalizer is obtained only on a very small fraction of subcarriers and only in correspondence of the larger values of the bandwidth. In fact, for larger bandwidths, the path delays become longer in terms of discrete-time samples and the assumption, on which the standard equalizer is based, about the property of the ambiguity function to be slowly varying in intervals long as the channel delay spread becomes less realistic. In particular, using the general expression (32) with reference to the prototype filter considered for simulations and the approximate expression forwg0[⋅]reported in [10], we can easily write the following expression ofI0,0(h,k):(64)I0,0(h,k)≃G02EgH(kM)+1Eg∑p=1K−1Gp2[H(kK−pKM)+H(kK+pKM)]SinceEg=G02+2∑p=1K−1Gp2, (64) implies thatI0,0(h,k)≃H(kM)provided thatH(kK+pKM)≃H(kM)for|p|≤K−1. Therefore, when the channel exhibits limited variations in the subcarrier bandwidth, the approximation (36) holds; instead, when the channel is not constant in the subcarrier bandwidth, the approximation (36) does not hold any more and the improved equalizer outperforms the standard single-tap equalizer.We have also compared the optimum single-tap equalizer (49) with the improved equalizer (51). We have considered the difference (in dB) between the SINR achieved by the optimum equalizer and that achieved by the improved one. When an internal subcarrier is considered, such a difference results to be null in 100% of the channel realizations. Only on the four extreme subcarriers, an interesting performance advantage is obtained. Since the computational complexity of the optimum single-tap equalizer is much larger than that of the other two single-tap equalizers, as shown in Subsection 5.4, and since, coherently with the theoretical derivations in Subsection 5.1, its performance advantage is only present at the extreme subcarriers (where, moreover, a smaller interference power is present), we have limited our further analysis to the performance comparison between the standard and the improved single-tap equalizers. Furthermore, we have included in the experiments also the multitap equalizers proposed in [22] with the number of taps chosen in the following set{3,5,7}; such structures perform obviously better than a single-tap equalizer but their inclusion is motivated by the need to compare the advantages that can be obtained by using the improved single-tap equalizer with that achieved by the multitap equalizer, which, however, requires to pay a price in terms of increased transceiver latency. Finally, we have also included for comparison purposes the classical OFDM system with the same number of subcarriers and with a cyclic prefix set toM/8.We have reported in Figs. 3 and 4, the average BER for a bandwidth of10MHzand25MHz, respectively, exhibited by the receivers under comparison with reference to the case where the 4-QAM symbol constellation is used. We can note that, moving from10MHzto25MHz, the result of the comparison between the single-tap and the multitap equalizers changes; however, in both cases, the performance of the standard single-tap equalizer coincides with that of the improved one, thus confirming with reference to the BER analysis, the results already obtained in terms of SINR analysis shown in Fig. 2, coherently with the results obtained in [23]. More specifically, the performance advantages shown in Fig. 2 are small and are obtained on a so small fraction of subcarriers that they do not determine appreciable differences in terms of average BER. We have also performed simulation results for the case where the 64-QAM symbol constellation is used. The results show more significant differences between the single-tap and the multitap equalizers, which exhibit a performance advantage over the single-tap equalizer also when the bandwidth is10MHz, as shown in Fig. 5; however, again the BERs of the two kinds of single-tap equalizer are perfectly equivalent. This confirms the importance of having carried out the analysis in terms of SINR reported in Fig. 2 that shows the equivalence of the two equalizers on a large fraction of subcarriers for the different channel realizations but also the superior performance of the improved equalizer on a fraction of subcarriers so small that they do not affect the average BER.Finally, we have also performed the same simulation experiments on channel ITU-A Extended, where the longer delay of the last path affects the approximation (36), and, therefore, allows one to achieve performance improvements by using the improved single-tap equalizer instead of the standard one. We have first studied the SINR achieved at the equalizer output using the model derived in Section 3. The results reported in Fig. 6are obtained analogously to that reported in Fig. 2 with reference to the channel ITU-A. They show that the improved equalizer, which has practically the same complexity of the standard equalizer, can achieve a significant performance advantage on specific channel realizations while on a large percentage of subcarriers it achieves an interesting advantage (and, obviously, the SINR difference in dB never achieves negative values). Moreover, the experiments on channel ITU-A Extended confirm that the optimum equalizer exhibits the same SINR of the improved equalizer on the internal subcarriers.We have also analyzed the equalizer performance in terms of average BER; in Figs. 7, 8, 9, 10, we have reported the average BER in correspondence of a bandwidth equal to10MHz,15MHz,20MHz,25MHz, respectively, achieved by the different receivers under comparison when the 4-QAM constellation is used. In general, we can notice that the performance of each receiver worsens when the bandwidth increases. However, also the performance advantage of the improved equalizer in comparison with the standard equalizer becomes more significant when the bandwidth increases. In particular, for a bandwidth of 20 and25MHz, the performance of the improved single-tap equalizer is closer to that of the multitap structure with 3 taps than to that of the standard one. Therefore, the performance comparison on channel ITU-A Extended shows that the proposed equalizer guarantees an interesting performance improvement. On the same channel, we have also evaluated the BER of the considered receivers also when the 64-QAM constellation is employed. The results, reported in Fig. 11with reference to a bandwidth of20MHz, confirms that an interesting performance advantage is achieved by the proposed equalizer in comparison with the standard one. We make also note that, on the channel ITU-A Extended, the maximum multipath delay is larger than the cyclic prefix of the OFDM system that, therefore, exhibits a significant performance loss.

@&#CONCLUSIONS@&#
We have derived the MIMO relation between the outputs of the OFDM/OQAM receiver and the sequences of symbols at the transmitter input. Such a relation has been exactly expressed in (31); moreover, in subsection 5.1 it has been shown that the sum overq∈{0,1,…,M−1}in (31) can be replaced by the sum overQβand therefore, only a few terms are relevant in it, more specifically2β+1terms, which means three terms, when the choiceβ=1is adopted in the design of the prototype filter. The derived model has been exploited to design the optimum single-tap equalizer, which is often considered in such transceivers in order to limit the increase of computational complexity in comparison with the standard OFDM system.It has been shown that the optimum single-tap equalizer in the absence of guard subcarriers is simply the inverse of a specific coefficient of an impulse response of the derived model. This coefficient under particular conditions leads to the conventionally used single-tap equalizer given by the inverse of the channel frequency response at the frequency of the considered subcarrier. Moreover, the effects of guard subcarriers and the possible inclusion of the noise term in the cost function have been studied; furthermore, we have shown that there is practically no design complexity increase associated with the use of the proposed equalizer. Finally, we have shown that it can achieve interesting performance improvements in comparison with the standard equalizer.Using (15), it can be easily shown that the statistical autocorrelation of the transmitted signals[i]in (13) can be written as(A.1)E[s[i]s⁎[i−m]]=∑n1=−∞+∞∑n2=−∞+∞∑k1∈A∑k2∈Ajn1−n2+k1−k2×ejk12πM(i−n1M2)e−jk22πM(i−m−n2M2)θk1−k2×g[i−n1M2]g[i−m−n2M2]E[an1,k1an2,k2]=Pa{∑k∈Aejk2πMm}×∑n=−∞+∞g[i−nM2]g[i−m−nM2].Moreover, its time averagers[m]=〈E[s[i]s⁎[i−m]]〉can be written as(A.2)rs[m]=〈Pa∑n=−∞+∞∑k∈Aejk2πMmg[i−nM2]g[i−m−nM2]〉=Pa{∑k∈Aejk2πMm}2M∑i=−∞+∞g[i]g[i−m]and, then, the average power of the transmitted signal isPs=△rs[0]=2MuMPaEg. Note that the conditions (5b) and (5c), and the choiceM=Mu, imply that the OFDM/OQAM signal is a white and wide sense stationary signal. In fact, when the expression (A.1) is taken into account, the choiceM=Muimplies thatE[s[i]s⁎[i−m]]=0form≠ℓMwhile the conditions (5b) and (5c) imply the condition (12) that is equivalent to the conditionE[s[i]s⁎[i−ℓM]]=0forℓ≠0.In order to derive the relation (26), we first introduce two useful lemmas and, finally, we provide the final proof.The conditions (24), (13), (5a), and (21) imply the following relation:(B.1)θkjk+nDn,k,nτ(Δ)=1Eg∑δ=−∞+∞tn,k(δ,nτ)with(B.2)tn,k(δ,nτ)=△∑i=0M−1bn+δ,i−nτ−δM2rg,i(nτ)[δ]e−jk2πMiwhere(B.3)rg,i(nτ)[δ]=△∑q=0K−1g[qM+i]g[qM−δM2−nτ+i]and(B.4)bn,i=△∑k′∈Ajn+k′θk′an,k′ejk′2πMi.In fact, from (24), (13), (5a), and (21), it follows that(B.5)Dn,k,nτ(Δ)θ−kj−k−n=△1A∑i=0KM−1{∑n′=−∞+∞∑k′∈Ajn′+k′an′,k′θk′×ejk′2πM[i−nτ−(n′−n)M2]g[i−nτ−(n′−n)M2]}×e−jk2πMig[i]=1Eg∑i=0KM−1∑n′=−∞+∞[∑k′∈Ajn′+k′θk′an′,k′×ejk′2πM[i−nτ−(n′−n)M2]]g[i]×g[i−(n′−n)M2−nτ]e−jk2πMi=1Eg∑n′=−∞+∞∑i=0KM−1bn′,i−nτ−(n′−n)M2g[i]×g[i−(n′−n)M2−nτ]e−jk2πMi(B.6)=1Eg∑δ=−∞+∞∑i=0KM−1bn+δ,i−nτ−δM2g[i]×g[i−δM2−nτ]e−jk2πMi=1Eg∑δ=−∞+∞tn,k(δ,nτ)where we have used the definition (B.4) for writing (B.5). Moreover, to write (B.6) we have defined the quantitytn,k(δ,nτ)as follows(B.7)tn,k(δ,nτ)=△∑i=0KM−1bn+δ,i−nτ−δM2g[i]g[i−δM2−nτ]e−jk2πMi=∑q=0K−1∑i=0M−1bn+δ,qM+i−nτ−δM2g[qM+i]×g[qM+i−δM2−nτ]e−j2πkM(qM+i)=∑q=0K−1∑i=0M−1bn+δ,i−nτ−δM2g[qM+i]×g[qM−δM2−nτ+i]e−j2πkM(qM+i)=∑i=0M−1bn+δ,i−nτ−δM2×{∑q=0K−1g[qM+i]g[qM−δM2−nτ+i]}e−jk2πMi=∑i=0M−1bn+δ,i−nτ−δM2rg,i(nτ)[δ]e−jk2πMiwhererg,i(nτ)[δ]is defined in (B.3). In writing (B.7) we have noted that, according to its definition (B.4),bn,iis periodic with respect to i with period M.The quantitytn,k(δ,nτ)defined in (B.2) can be written as follows(B.8)tn,k(δ,nτ)=∑q=0M−1θqjn+δ+q(−1)qδe−j2πMqnτan+δ,q×wgmodM(k−q)M[δM2+nτ].In fact, once defined the vectors(B.9)dn,nτ(Δ)=△[jnDn,0,nτ(Δ)jn+1Dn,1,nτ(Δ)…jn+M−1Dn,M−1,nτ(Δ)]T(B.10)tn(δ,nτ)=△[tn,0(δ,nτ)tn,1(δ,nτ)…tn,M−1(δ,nτ)]T(B.11)rg(nτ)[δ]=△[rg,0(nτ)[δ]rg,1(nτ)[δ]…rg,M−1(nτ)[δ]]Tfrom (B.1) it follows thatdn,nτ(Δ)=1Eg∑δ=−∞+∞tn(δ,nτ)while from (B.2) it follows that(B.12)tn(δ,nτ)=MDFT[bn+δ(−nτ−δM2)⊙rg(nτ)[δ]]=MDFT[bn+δ(−nτ−δM2)]⊗Mr˜g(nτ)[δ]where we have defined theM×1vectorr˜g(nτ,ε)(δ)as follows(B.13)r˜g(nτ)[δ]=△[r˜g,0(nτ)[δ]r˜g,1(nτ)[δ]…r˜g,M−1(nτ)[δ]]T=DFT[rg(nτ)[δ]]and the ith component (i∈{0,1,…,M−1}) of the vectorbn+δ(−nτ−δM2)isbn+δ,i−nτ−δM2. Consequently, the kth component of its DFT can be written as(B.14)1M∑i=0M−1bn+δ,i−nτ−δM2e−j2πMki=1M∑i=0M−1{∑k′=0M−1jn+δ+k′θk′an+δ,k′ej2πMk′(i−nτ−δM2)}e−j2πMki=jn+δ+kθkan+δ,k(−1)kδe−j2πMknτwhere we have used (B.4) and we have assumed thatan,k′is null by definition fork′∉A. Using (B.14), the kth component in (B.12) can be re-written as follows:(B.15)tn,k(δ,nτ)=M∑q=0M−1θqjn+δ+q(−1)qδe−j2πMqnτan+δ,q×r˜g,modM(k−q)(nτ)[δ].The mth componentr˜g,m(nτ)[δ]of the vectorr˜g(nτ)[δ]can be written as (see (B.3), (B.11), and (B.13))(B.16)r˜g,m(nτ)[δ]=1M∑p=0M−1rg,p(nτ)[δ]e−j2πMpm=1M∑p=0M−1∑q=0K−1g[qM+p]g[qM−δM2−nτ+p]×e−j2πMpm=1M∑i=0KM−1g[i]g[i−δM2−nτ]e−j2πMim=1MwgmM[δM2+nτ]where we used (5a) and (7). From (B.15) and (B.16), (B.8) directly follows.From (B.1), taking into account (B.8), the following equality holds:(B.17)Dn,k,nτ(Δ)=θ−kj−k−nEg∑δ=−∞+∞∑q=0M−1jn+δ+q(−1)qδθqan+δ,q×wgmodM(k−q)M[δM2+nτ]e−j2πMqnτFrom (B.17), the relation (26) straightforwardly follows by taking into account the definition (27) and the fact thatM/4is assumed to be an integer.According to the definition (23) and using the first noise property in (19), the joint correlationE[Dn,k1(N)Dn−m,k2(N)⁎]between the noise components on the subcarriersk1andk2can be written asE[Dn,k1(N)Dn−m,k2(N)⁎]=jk2−k1−mθk1−k2|A|2∑i1=−∞+∞∑i2=−∞+∞ej2πM[k2i2−k1i1]×g[i1]g[i2]×E[η[nM2+i1]η⁎[(n−m)M2+i2]]=jk2−k1−mθk1−k2|A|22N0Ts(−1)k2m∑i=−∞+∞ej2πM(k2−k1)i×g[i]g[i+mM2]from which, using the definition (7), (37) straightforwardly follows.Using the definitions in (50), the Lagrangian in (48) can be written as(D.1)Wk2Rk+2QWkWk⁎+(Wk⁎)2Rk⁎+λ(WkI0,0(h,k)+Wk⁎[I0,0(h,k)]⁎−2)where λ denotes the real-valued Lagrange multiplier. Its stationary point satisfies the following conditions:(D.2){2QkWk+2Rk⁎Wk⁎+λ[I0,0(h,k)]⁎=0WkI0,0(h,k)+Wk⁎[I0,0(h,k)]⁎=2.The first condition can be re-written as(D.3)2WkQkI0,0(h,k)+2Wk⁎Rk⁎I0,0(h,k)+λ|I0,0(h,k)|2=0and, therefore, since λ andQkare real valued,(D.4)2Qkℑ{WkI0,0(h,k)}+2ℑ{Wk⁎Rk⁎I0,0(h,k)}=0or, equivalently,(D.5)ℑ{Wk(QkI0,0(h,k)−[I0,0(h,k)]⁎Rk)}=0.Consequently, (D.2) can be re-written as(D.6){ℑ{WkSk}=0WkI0,0(h,k)+Wk⁎[I0,0(h,k)]⁎=2Sk=△QkI0,0(h,k)−[I0,0(h,k)]⁎Rkor also(D.7)WkSk−(2−WkI0,0(h,k)[I0,0(h,k)]⁎)Sk⁎=0.From such a condition, the following expression of the optimumWkcan be easily derived(D.8)Wk=Sk⁎ℜ{I0,0(h,k)Sk⁎}.From (D.8), the definition (D.6) ofSk, and the definitions (50) ofQkandRk, the expression (49) straightforwardly follows.Here we prove the relation (53) under the assumption (42). Using the assumption (42) and the definition (13), it follows that(E.1)E[s[i]s[ℓ]]=∑n1=−∞+∞∑n2=−∞+∞∑k1∈AM∑k2∈AMjn1+n2+k1+k2θk1+k2×E[an1,k1an2,k2]ejk12πM(i−n1M2)ejk22πM(ℓ−n2M2)×g[i−n1M2]g[ℓ−n2M2]=Pa∑n=−∞+∞∑k∈AMj2n+2kθ2kejk2πM(i−nM2)ejk2πM(ℓ−nM2)×g[i−nM2]g[ℓ−nM2](E.2)=Pa{∑k∈AMejk2πM(i+ℓ−(M2−a))}×{∑n=−∞+∞(−1)ng[i+nM2]g[ℓ+nM2]}.We have used (15) and (42) to write (E.1) and we have used (9) to write (E.2). The first factor in (E.2) is null unless(E.3)i+ℓ=M/2−a+pMTo complete the proof of (53), we next show that the second factor in (E.2) is null when (E.3) holds (for any integer p). Let us therefore consider the following quantity, which represents the second factor of (E.2) under the condition (E.3):(E.4)Sg(i,p,M)=△∑n=−∞+∞(−1)nRg(n,i,p,M)with(E.5)Rg(n,i,p,M)=△g[i+nM2]g[pM+M2−a−i+nM2]=g[i+nM2]×g[KM2−(i+KM2−pM−(n+1)M2)−a]=g[i+nM2]×g[KM2+(i+KM2−pM−(n+1)M2)](E.6)=g[i+n2M]g[i+(K−p−n+12)M]=g[i+n2M]g[i+(2ns(p)−n−12)M]where we have used (5b) to write (E.5) and the definitionns(p)=△K−pto write (E.6). From (E.6) it follows that, fort∈{0,1,2,…},(E.7)Rg(ns(p)+t,i,p,M)=g[i+ns(p)+t2M]g[i+(ns(p)−t−12)M](E.8)Rg(ns(p)−(t+1),i,p,M)=g[i+ns(p)−(t+1)2M]g[i+(ns(p)+t2)M].From (E.7) and (E.8) it follows that(E.9)Rg(ns(p)+t,i,p,M)=Rg(ns(p)−(t+1),i,p,M)t∈{0,1,2,…}.Once fixed the values of i, p, and M, using the property (E.9) in (E.4) we can verify that(E.10)Sg(i,p,M)=∑t=0+∞[(−1)ns(p)+t+(−1)ns(p)−(t+1)]×Rg(ns(p)+t,i,p,M)=0.From (E.10) it follows that (53) holds for any i and ℓ.