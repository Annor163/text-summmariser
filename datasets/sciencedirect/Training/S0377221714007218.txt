@&#MAIN-TITLE@&#
Penalty functions based upon a general class of restricted dissimilarity functions

@&#HIGHLIGHTS@&#
General results about the class of restricted dissimilarity functions.A subclass of restricted dissimilarity functions based on automorphisms.A model of generation of penalty functions by means of automorphisms.A characterization theorem of the generators of penalty functions of any dimension.The existence of not convex generators is shown.

@&#KEYPHRASES@&#
Restricted dissimilarity function,Penalty function,Quasi-convexity,

@&#ABSTRACT@&#
In this paper the notion of restricted dissimilarity function is discussed and some general results are shown. The relation between the concepts of restricted dissimilarity function and penalty function is presented. A specific model of construction of penalty functions by means of a wide class of restricted dissimilarity functions based upon automorphisms of the unit interval is studied. A characterization theorem of the automorphisms which give rise to two-dimensional penalty functions is proposed. A generalization of the previous theorem to any dimension n > 2 is also provided. Finally, a not convex example of generator of penalty functions of arbitrary dimension is illustrated.

@&#INTRODUCTION@&#
The notion of penalty based aggregation function has become increasingly popular in the literature over the last few years (see, for instance, Calvo and Beliakov, 2010 and the references therein). In Bustince, Jurio, Pradera, Mesiar, and Beliakov (2013), the authors suggest the use of penalty functions for selecting alternatives in decision making problems. In particular, they build penalty functions by means of a particular class of restricted dissimilarity functions (see Bustince, Barrenechea, and Pagola, 2008), called faithful restricted dissimilarity functions, in order to generalize one of the most widely used methods in decision making, that is the weighted voting method (see, for example, Hüllermeier and Brinker, 2008; Hüllermeier and Vanderlooy, 2010). From a mere theoretical point of view, a faithful restricted dissimilarity function is strictly related to a convex automorphism of the real unit interval up to a bijection. As the authors somehow admit, there is no real reason for imposing convexity restriction other than to assure that the corresponding penalty function is convex, so fulfilling, a fortiori, the crucial property of quasi-convexity demanded to all penalty functions.This consideration has led us to the main goal of this paper: to characterize a class of restricted dissimilarity functions, wider than the faithful restricted dissimilarity functions, able to assure that the generated one-variable mappings, constructed in the same way as in Bustince et al. (2013), turn out to be penalty functions.We have organized this paper as follows: In the next section we introduce the basic notions needed for subsequent developments. In Section 3 we analyze the limited cases in which a restricted dissimilarity function is also a distance and mostly we study a model of construction of penalty functions by means of a general subclass of restricted dissimilarity functions strictly connected to automorphisms of the real unit interval, also called generators. In Section 4, we characterize the class of generators of two-dimensional penalty functions, while in Section 5 we extend the two-dimensional result to any dimension n > 2. Finally, we present a conclusion and some references.In this article, we will make use of the following notations and assumptions.Our domain of interest is the real unit interval, denoted byI,being clear that it might be replaced without loss of generality by any closed, non-empty subinterval of the real line. We adopt the classical notation x = (x1, …, xn) for any n-tuple x inIn,while x↗ = (x(1), …, x(n)) represents the result of the permutation of the components of x in increasing order, i.e. x(1) ≤ x(2) ≤ … ≤ x(n). We denote by Wnthe set of weighting vectors of dimension n, i.e.Wn={w∈]0,1[n:∑i=1nwi=1}. We will exclusively reserve the symbol w for any weighting vector: further,wn*stands for the weighting vector given by (1/n, …, 1/n).Definition 2.1Letx0∈I,μ > 0 andE⊂I. Then, we set(2.1)μE={μ·x:x∈E}and(2.2)E±{x0}={t±x0:t∈E}.We warn the reader that throughout the paper the notion of monotonicity is intended in weak sense: otherwise, we speak of strict monotonicity. Moreover, when we say that a property holds almost everywhere (for short, a.e.), it is intended that it is true outside a set of Lebesgue measure, denoted by λ, equal to zero.Consider now the following definition.Definition 2.2Bustince et al., 2011; Calvo and Beliakov, 2010LetP:In+1→[0,∞]. We say that P is a penalty function of dimension n if, and only if, satisfies:(i)P(x,y)=0if xi= y for all i ∈ {1, …, n};for every fixedx∈In,the set of minimizers of the mappingy↦P(x,y)is a subinterval ofI,possibly reducible to a singleton.The penalty based functionf:In→Iis given byf(x)=argminyP(x,y)if y is the unique minimizer or y = (a + b)/2 if the set of minimizers is a subinterval ofIwith bounds a and b.A penalty function is a tool for measuring the disagreement between the input x and the value y. The penalty based function f associates with any input x the corresponding output value y which just minimizes the chosen disagreement.The first, prototypical model of penalty function appeared in the literature was of the form(2.3)P(x,y)=∑i=1ndp(xi,y),wheredp:I2→Iis given by dp(x, y) = |x − y|p, for p ≥ 1. In particular, the cases p = 1 and p = 2 were already studied by Fermat, Laplace and Cauchy (see Hudry, Leclerc, Monjardet, and Barthélemy, 2010; Torra and Narukawa, 2007 and the references therein). When p = 1, the penalty function is obtained as sum of the (Euclidean) distances of the components of the input x to the value y. The model is then generalized replacing d1 with dp, with the crucial difference that only d1 is a distance in mathematical sense. We will return to this point later.The notion of penalty function is closely related to the dissimilarity function, as proposed and discussed in Mesiar (2007), even if this concept in its turn is inspired to a first formulation of penalty function given by Calvo, Mesiar, and Yager (2004) which is quite different from the above one. Our version fundamentally coincides with the most general one as it appears in Calvo and Beliakov (2010), except for the redundant requirement P(x, y) ≥ 0 for all x, y, here dropped.In some papers, condition (ii) is replaced by the requirement that the mapping y↦P(x, y) is quasi-convex for any fixedx∈In. Recall that a real function g over a convex subset X ofRnis quasi-convex if its level sets Lc= {x ∈ X: g(x) ≤ c} are convex (see Greenberg and Pierskalla, 1971 for a thorough exposition of the notion of quasi-convexity). It is well-known that if g is a function of a single variable, then g is quasi-convex if, and only if, either it is monotone or there exists a x* ∈ X such that g is decreasing on {x ∈ X: x ≤ x*} and increasing on {x ∈ X: x ≥ x*}. Therefore, it is clear that quasi-convexity is a stronger condition than (ii).The restricted dissimilarity functions were introduced by Bustince et al. (2008) and are inspired, among others, to the notions of proximity and dissimilarity measures, as they appear in Fan and Xie (1999) and Liu (1992), respectively. In the applications, they turn out to be very useful, for instance, in image processing, in order to measure the dissimilarity of two objects, while, from a theoretical point of view, they are more flexible than existing dissimilarity functions.Definition 2.3A mappingdR:I2→Iis called a restricted dissimilarity function if :(D1)dR(x, y) = dR( y, x) for everyx,y∈I;dR(x, y) = 1 if, and only if, {x, y} = {0, 1};dR(x, y) = 0 if, and only if, x = y;dR(y, z) ≤ dR(x, t) for allx,y,z,t∈Isuch that x ≤ y ≤ z ≤ t.In the sequel, we will exclusively deal with continuous restricted dissimilarity functions. This is not a too strong assumption, since we know that, fixed anyx∈I,the mapping t↦dR(x, t) is quasi-convex (see Bustince et al., 2011), hence it is also continuous onIup to a subset ExofIsuch that λ(Ex) = 0 (see Greenberg and Pierskalla, 1971). The next result just shows that if Ex= ∅ for allx∈I,then dRis continuous as two-place function.Proposition 2.4Let dRbe a restricted dissimilarity function. Then dRis continuous if, and only if, the mapping t↦dR(x, t) is continuous onIfor every fixedx∈I.First of all, notice that, by (D1), the assumption may be equivalently formulated as continuity of the mapping t↦dR(t, x) for every fixedx∈I. Given an arbitrary point (x0, y0) ofI2,we have to show that for any real ɛ > 0 there exists a neighborhood U of (x0, y0) such thatdR(x0,y0)−ɛ≤dR(x,y)≤dR(x0,y0)+ɛfor all (x, y) ∈ U. Let us divide the proof into four cases, according to the position of (x0, y0).Case (1): 0 < x0 < y0 < 1. By continuity of t↦dR(x0, t) at t = y0, we can always find a δ ∈ ]0, min {x0, 1 − y0, (y0 − x0)/2}[ such that(2.4)|dR(x0,t)−dR(x0,y0)|≤ɛ/2for all t ∈ [y0 − δ, y0 + δ]. Moreover, by continuity of t↦dR(t, y0 + δ) at t = x0, we can always find a δ1 ∈ ]0, δ[ such thatdR(x0−δ1,y0+δ)≤dR(x0,y0+δ)+ɛ/2.Employing Eq. (2.4), last inequality leads to(2.5)dR(x0−δ1,y0+δ)≤dR(x0,y0)+ɛ.In the same way, starting with the continuity of the mapping t↦dR(t, y0 − δ) at t = x0, there exists a δ2 ∈ ]0, δ[ such that(2.6)dR(x0+δ2,y0−δ)≥dR(x0,y0)−ɛ.Set δ* ≔ min {δ1, δ2}: by the properties of δ, it is quite easy to see thatx0−δ1≤x0−δ*<x0+δ*≤x0+δ2<y0−δ,hence, by (D4), one immediately findsdR(x0+δ*,y0−δ)≤dR(x,y)≤dR(x0−δ*,y0+δ)for all (x, y) ∈ [x0 − δ*, x0 + δ*] × [y0 − δ, y0 + δ], and the claim directly follows from Eqs. (2.5) and (2.6).Case (2): 0 < y0 < x0 < 1. It directly follows from the previous case, taking into account (D1).Case (3): 0 < x0 = y0 < 1. The proof is the same (even simpler) as that of the first case.Case (4): (x0, y0) belongs to the boundary ofI2. This is again a sub-case of the first one, so concluding the proof.□In what follows, AC(I)denotes the family of absolutely continuous real functions overI. We say that anyφ:I→Ibelongs toA(I)if, and only if,(A1)φ ∈ AC(I);φ is an increasing bijection.Obviously, anyφ∈A(I)is an automorphism of the real unit interval (see, for instance, Fodor and Roubens, 1994). Recall that, as a consequence of (A1), the derivative of anyφ∈A(I)exists and is defined onIup to a subset of measure zero (see, for instance, Yeh, 2006).Let us introduce now a special class of restricted dissimilarity functions by means of a construction illustrated in the next lemma, whose elementary proof is omitted. Later on, any continuous bijectionh:I→Iis simply called a scaling function.Lemma 2.5Letφ∈A(I). Let h be a scaling function. Then, the mappingdR:I2→Igiven by(2.7)dR(x,y)=φ(|h(x)−h(y)|)is a restricted dissimilarity function.Note that the class of restricted dissimilarity functions as in Eq. (2.7) properly contains the family of faithful restricted dissimilarity functions, as defined in Bustince et al. (2013). Indeed, the construction is exactly the same: the only difference is that condition (A1) is replaced with the stronger requirement that φ is convex. In fact, any convex and continuousφ:I→Iis also absolutely continuous (see, for instance, Yeh 2006, Theorem 14.13).Observe that the mappings dppreviously introduced are exactly restricted dissimilarity functions of the form given in Eq. (2.7), with φ(t) = tpand h ≡ id, where id is the identity function.In this section, we address the problem of building penalty functions following the approach of Eq. (2.3), but with the crucial novelty that we replace the class of mappings dpwith a larger family of (continuous) restricted dissimilarity functions.Starting with an arbitrary continuous restricted dissimilarity function dRand fixing the dimensionn∈N,our candidate for being an n-dimensional penalty function is the mappingP:In×Wn×I→Igiven by(3.1)P(x,w,y)=∑i=1nwidR(xi,y).When a mapping P as in Eq. (3.1) is actually a penalty function, dRwill be referred to as a generator of P.Remark 3.1Let P be as in Eq. (3.1): then, conditions (i) and (ii) have to be slightly modified as follows:(i’)for every fixed w ∈ Wn, P(x, w, y) = 0 if xi= y for all i ∈ {1, …, n};for every fixedx∈Inand w ∈ Wn, the set of minimizers of the mapping y↦P(x, w, y) is a subinterval ofI,possibly reducible to a singleton.Observe that condition (i’) is trivially satisfied due to (D3), so the real difficulty is the verification of (ii’).Fixing anyx∈Inand w ∈ Wn, the mapping y↦P(x, w, y) is clearly continuous over a compact domain, so its set of minimizers, denoted by Sx, w(P), is always nonempty.From now on, we will suppose first that x = x↗. Note that there is no loss of generality: otherwise it would suffice to relabel the indices of the components of the involved vectors. Secondly, assume that xi≠ xi + 1 for all i ∈ {1, …, n − 1} (otherwise, the dimension n would be reduced). Under these assumptions, owing to (D4) it is easy to see that the mapping  y↦P(x, w, y) is decreasing on [0, x1] and increasing on [xn, 1], whence condition (ii’) is equivalent to showing that Sx, w(P) is a subinterval of [x1, xn].Now, we pose the following problem: may we make use of a distance as particular restricted dissimilarity function in order to generate n-dimensional penalty functions via Eq. (3.1)? The answer is decidedly negative even for n = 2 with only one exception, as we show in the following.Proposition 3.2Let dRbe a continuous restricted dissimilarity function. Assume that dRis a generator of a two-dimensional penalty function P via Eq. (3.1). Then, dRis a metric if, and only if, is of the form given in Eq. (2.7) with φ ≡ id.Let dRsatisfy the assumptions. According to (D1) and (D3), it is easy to see that dRis a metric if, and only if, verifies the triangle inequalitydR(x1,x2)≤dR(x1,z)+dR(x2,z)for allx1,x2,z∈I. The only non-trivial case is when x1 < x2 and z ∈ ]x1, x2[. We have two mutually exclusive possibilities only: in the first one, assume thatdR(x1,x2)=dR(x1,z)+dR(x2,z)for allx1,x2∈Isuch that x1 < x2 and for any z ∈ [x1, x2]. Then, define h(t) ≔ dR(0, t): by (D4), we have that h is a (continuous) increasing mapping, while (D2) and (D3) trivially force h(t) = t when t ∈ {0, 1}. Now, consider anyx,y∈Isuch that 0 ≤ x ≤ y: if we apply the above equality with x1 = 0, x2 = y and z = x, we immediately get dR(x, y) = h(y) − h(x). By (D3), this clearly implies the strict monotonicity of h, so closing the first case. The only other possibility is that dRfulfills the triangle inequality and, at the same time, there exists at least a pair of pointsx1,x2∈I,with x1 < x2, such that dR(x1, x2) < dR(x1, z0) + dR(x2, z0) for some z0 ∈ ]x1, x2[. Let us show that this case is incompatible with the fact that dRacts as a generator of a two-dimensional penalty function P via Eq. (3.1). In fact, if this were true, we would immediately find that the generated penalty functionP(x,w2*,y)satisfies the inequalityP(x,w2*,y)≥P(x,w2*,x1)=P(x,w2*,x2)for all y ∈ [x1, x2] and at the same timeP(x,w2*,z0)>P(x,w2*,x1)=P(x,w2*,x2).As a straightforward consequence, it would follow thatSx,w2*(P)certainly contains x1, x2, but not z0, hence it could not be convex, so contradicting (ii’).□Since the whole class of continuous restricted dissimilarity functions is too wide, we focus on its relevant subclass introduced in Lemma 2.5.Given anyφ∈A(I),letPh,φ:In×Wn×I→Ibe described asPh,φ(x,w,y)=∑i=1nwiφ(|h(xi)−h(y)|),for any fixed scaling function h.With a little abuse of terminology, when Ph, φ is a penalty function, the mapping φ will be referred to as generator of Ph, φ.Our aim is to find the minimal requirements on φ and h in order for Ph, φ to be an n-dimensional penalty function. The first, simple result shows the total irrelevance of the scaling functions. To avoid cumbersome symbols, in what follows we write Pφ as the shorthand for Ph, φ when h ≡ id. More explicitly,Pφ:In×Wn×I→Iis given by(3.2)Pφ(x,w,y)=∑i=1nwiφ(|xi−y|).Lemma 3.3Assume that Pφ is an n-dimensional penalty function for some generatorφ∈A(I). Then Ph, φ is also an n-dimensional penalty function for any scaling function h.Without loss of generality, suppose that h is strictly increasing. Then, it suffices to show that, given anyx∈Inand any w ∈ Wn, the set Sx, w(Ph, φ) is convex. By assumption, we know that Su, w(Pφ) is a sub-interval ofI,where u = h(x) ≔ (h(x1), …, h(xn)). Then, it is quite easy to see that Sx, w(Ph, φ) = h−1(Su, w(Pφ)), hence the claim is assured by the properties of h.□Due to the previous result, from now on, we will exclusively deal with the class of functionsPφ:In×Wn×I→Iof the form given by Eq. (3.2). However, because of the high complexity of our task, we try to achieve our goal through the pursuit of an intermediate target, that is the search for a subclassSofA(I)such that, whatever is the choice ofφ∈S,the mapping y↦Pφ(x, w, y) is quasi-convex for every fixedx∈Inand w ∈ Wnand for any dimension n ≥ 2. Note that this is a well-posed problem, in the sense thatSis not empty. In fact, if we denote byCAthe set of all convex automorphisms ofI,it is clear thatCA⊂S. To this end, note that the convexity of φ easily implies convexity, and a fortiori quasi-convexity, of Pφ (see, for instance, Bustince et al. 2013, Propositions 7 and 8). Actually, our problem is twofold: first, the characterization ofSthrough a differential condition on φ; second, relying on such characterization, to find out whetherCA=S. We emphasize the fact that, as remarked in the previous section, any restricted dissimilarity function is quasi-convex in one variable, so our new task is strictly related to the more general problem of determining a non-trivial family of quasi-convex functions, containing nonconvex functions, which is closed under the operation of addition. As stated by the authors in Greenberg and Pierskalla (1971), although many years have passed since then, to the best of our knowledge such problem is still open.In this section, we solve the problem of characterizing the mappingsφ∈A(I)such that every functionPφ:I2×W2×I→Iis a two-dimensional penalty function.First, we need to introduce some suitable notation and useful lemmata.We begin to restrict the initial class of the candidates for being generators of two-dimensional penalty functions: letS0={φ∈A(I): φ′ is strictly positive and continuous a.e. onI}. Observe thatCA⊂S0: in fact, given any convexφ:I→I,φ′ is continuous onIup to a countable subset (see Roberts and Varberg, 1973). Moreover, the strict increasing monotonicity and convexity easily imply that φ′(t) > 0 for all t ∈ ]0, 1] where the derivative exists.Remark 4.1In the sequel, we will exclusively reserve the symbolDφ′for the domain of the derivative of anyφ∈S0. Note thatDφ′is defined up to a zero measure subset ofI:this precisely means that any subset S ofIis a proper domain of φ′ ifλ(I∖S)=0and φ′: S → ]0, ∞[ is continuous.Recall a well-known property, useful for the sequel, which characterizes monotonicity of absolutely continuous functions.Lemma 4.2Letf:[a,b]→Rbe an absolutely continuous function. Then, f is decreasing if, and only if, f′(x) ≤ 0 almost everywhere on [a, b].Let us introduce a class of functions which turns out to be crucial for our purposes. Note that, throughout this section, we will reserve the symbol X for denoting an arbitrary subset of ]0, 1] dense inI. Given anyφ∈S0,letF2(X,φ)={ψc,w:c∈X,w∈W2}be the class of mappingsψc,w:[0,c]→Rdefined byψc,w(t)=w1φ(t)+w2φ(c−t).In the sequel, for sake of brevity, we will adopt the shorthand notationF2(X),unless some confusion arises. Moreover, we will also adopt the shorthand notation ψcforψc,w2*.Recall that absolute continuity is closed under the operation of addition, therefore every function ofF2(X)is absolutely continuous, hence it is also a.e. differentiable.Let us turn our attention to the notable subclass {ψc: c ∈ X} ofF2(X). It is immediate to see that the graph of any member ψcof this subclass is symmetrical with respect to the vertical line at t = c/2 and consequently ψcis quasi-convex if, and only if, is decreasing on [0, c/2]. According to Lemma 4.2, this is equivalent to saying that ψcis quasi-convex if, and only if,(4.1)ψc′(t)≤0foralmostallt∈[0,c/2].Remark 4.3Letφ∈S0and c ∈ X. Based upon the properties of positively homogeneity and invariance under translation of the Lebesgue measure (see, for instance, Yeh 2006, Theorems 3.18 and 3.16) and taking into account Remark 4.1, it is not difficult to check that the complement with respect toIof the setDφ′,c:={t∈I:φ′(t),φ′(c−t)exist} has measure zero. This allows us to assume without loss of generality that the domain of the derivative of every member of the subclass ofF2(X)given by{ψc,w∈F2(X):w∈W2}is exactlyDφ′,c. Further, given anyψc∈F2(X),an elementary computation shows that the inequalityψc′(t)≤0amounts to φ′(t) ≤ φ′(c − t) for everyt∈Dφ′,c.The next result will be presented without including a proof: indeed, it is a straightforward consequence of both the uniform continuity of anyφ∈S0overIand the density of X inI.Lemma 4.4Letφ∈S0. Assume that every function ofF2(X)is quasi-convex for some dense subset X⊂]0, 1]. Then, every member ofF2(]0,1])is quasi-convex.Now, we shall proceed in two steps: in the first one, we consider the particular casew=w2*.Proposition 4.5Letx∈I2andφ∈S0. Then, the mapping φ(y − x1) + φ(x2 − y) is quasi-convex in the variable y if, and only if,(4.2)φ′(t)≤inf{φ′(z):z∈]t,1−t[∩Dφ′}forallt∈Dφ′∩[0,1/2[.Set t ≔ y − x1: consequently x2 − y = c − t, where c ≔ x2 − x1 ∈ ]0, 1]. Using this change of variable and employing Lemma 4.4, we can equivalently consider the problem of characterizing quasi-convexity of every member of the subclass {ψc: c ∈ X} for some subset X of ]0, 1] dense inI. ChooseX=Q∩]0,1]: note that X is countable and dense inI. Owing to Remark 4.3, it is quite easy to see thatI∖⋂c∈XDφ′,chas measure zero, hence, according to Remark 4.1, we may assume thatDφ′=⋂c∈XDφ′,c. This implies that, fixing anyt∈Dφ′and any c ∈ X, both φ′(t) and φ′(c − t) exist. As above stated, an arbitrary element of {ψc: c ∈ X} is quasi-convex if, and only if, Eq. (4.1) is verified. Now, we assert that Eq. (4.1) holds for any c ∈ X if, and only if, Eq. (4.2) is satisfied. Let us start with the necessity and suppose ab absurdo that Eq. (4.2) is violated for somet0∈Dφ′∩]0,1/2[. This means that there exists az0∈]t0,1−t0[∩Dφ′such that φ′(t0) > φ′(z0). Set ε ≔ φ′(t0) − φ′(z0). Being φ′ continuous at z0, there exists a sufficiently small δ > 0 such that(4.3)φ′(z)<φ′(z0)+ϵ/2for allz∈[z0,z0+δ]∩Dφ′. By the density of X inIwe can always find ac0∈]t0+z0,t0+z0+δ2[∩X. Being φ′ continuous at t0, there exists a sufficiently small δ1 > 0, withδ1<δ2,such that(4.4)φ′(t)>φ′(t0)−ϵ/2for allt∈[t0−δ1,t0]∩Dφ′. Now, pick anyt∈[t0−δ1,t0]∩Dφ′: being clearly t < c0/2, Eq. (4.1) applies, so that, by Remark 4.3, we obtain(4.5)φ′(t)≤φ′(c0−t).Moreover, since it is not difficult to check that c0 − t ∈ ]z0, z0 + δ[, recalling that φ′(c0 − t) exists as consequence oft∈Dφ′,we can also apply Eq. (4.3) with z = c0 − t. Finally, combining Eqs. (4.5) and (4.3) with Eq. (4.4), we get the following chain of inequalities:φ′(t0)−ϵ/2<φ′(t)≤φ′(c0−t)<φ′(z0)+ϵ/2.The evident contradiction with ε = φ′(t0) − φ′(z0) closes the first part of the assertion. Conversely, let Eq. (4.2) hold. Given any c ∈ X, lett∈]0,c/2[∩Dφ′: after the assignment z ≔ c − t, we immediately find thatz∈]t,1−t[∩Dφ′,hence by applying Eq. (4.2) easily leads toψc′(t)≤0,so showing the assertion and concluding the proof.□Remark that Eq. (4.2) is equivalent to both convexity of φ on [0, 1/2] and φ′(t) ≤ μφ(t) a.e. on [0, 1/2[, whereμφ:[0,1/2[→Ris defined asμφ(t)=inf{φ′(z):z∈]1/2,1−t[∩Dφ′}.In fact, let Eq. (4.2) hold: consequently, given anyt1,t2∈[0,1/2[∩Dφ′such that t1 < t2, if we apply Eq. (4.2) with t = t1 we haveφ′(t1)≤inf{φ′(z):z∈]t1,1−t1[∩Dφ′}.Since it is clear thatt2∈]t1,1−t1[∩Dφ′,we easily infer that φ′(t1) ≤ φ′(t2). In conclusion, we have proved thatφ′:Dφ′∩[0,1/2[→Ris an increasing function, thus (see, for instance, Yeh 2006, Theorem 14.14) φ is a convex function on [0, 1/2]. As a straightforward consequence, it follows that for everyt∈[0,1/2[∩Dφ′we have φ′(t) = ∈f{φ′(z): z ∈ ]t, 1/2]}. This obviously implies that Eq. (4.2) may be rewritten in the simplified formφ′(t)≤inf{φ′(z):z∈]1/2,1−t[∩Dφ′}forallt∈[0,1/2[∩Dφ′.The converse is trivial. We have shown the following.Proposition 4.6Letx∈I2andφ∈S0. Then, the mapping φ(y − x1) + φ(x2 − y) is quasi-convex in the variable y if, and only if, φ fulfills the following properties:(P1)φ is convex on [0, 1/2];φ′(t) ≤ μφ(t) almost everywhere on [0, 1/2[.The preceding result states that the subclass ofS0characterizing quasi-convexity of every member of {ψc: c ∈ ]0, 1]} is exactly given byS1={φ∈S0:φverifies (P1) and (P2)}.Example 4.7Consider the functionφ:I→Idefined byφ(t)={12t,t≤34;38+54t−34,otherwise.It is easy to check thatφ∈S0and that (P1) holds. Hence, it is really an elementary task to show thatφ∈S1,being clearly φ′(t) = μφ(t) = 1/2 for all t ∈ ]0, 1/2[.Letφ∈S0. Suppose that φ is convex on [0, 1/2] and is concave on [1/2, 1]. Then, it is not difficult to show thatφ∈S1if, and only if, φ′(t) ≤ φ′(1 − t) for almost all t ∈ [0, 1/2].In the second step, the weights come into play: in this case, as it was probably natural to expect, the subclass ofS0exclusively formed of generators of two-dimensional penalty functions as in Eq. (3.2) is a proper subset ofS1,as we show in the following example.Example 4.9Let φ be as in Example 4.7,x=(0,1)andw=(5/6,1/6). If we consider the correspondingPφ(x,w,y),it is only a matter of computation to see that Sx, w(Pφ) = {0, 1/4}, hence Pφ is not a penalty function althoughφ∈S1.Given anyφ∈S0,letZ2(X,φ)={ζc:c∈X}be the class of strictly positive functions defined a.e. on [0, c] and described asζc(t)=φ′(t)φ′(c−t).We highlight thatZ2(X,φ)is made of continuous mappings, due to the continuity of φ′ onDφ′. Similarly as above, we will adopt the shorthand notationZ2(X)forZ2(X,φ),unless some confusion arises.Remark 4.10Letφ∈S0and c ∈ X. Remark that there is a natural, biunivocal correspondence between the subclass{ψc,w∈F2(X,φ):w∈W2}ofF2(X,φ)and the mappingζc∈Z2(X,φ). In particular, according to Remark 4.3, we may assume that the domain of ζccoincides withDφ′,c. Moreover, an elementary computation shows that the inequalityψc,w′(t)>0amounts toζc(t)>w2w1for everyt∈Dφ′,c.We emphasize the fact that the increasing monotonicity of all mappings ofZ2(]0,1])will play a crucial role in characterizing the family of generators of two-dimensional penalty functions of the form given by Eq. (3.2). In the next result, we show that such property is assured even if it occurs for a particular dense subset X⊂]0, 1] only.Lemma 4.11Letφ∈S0. Assume that there exists a dense subset X⊂]0, 1] such that every mapping ofZ2(X)is increasing. Then, every member ofZ2(]0,1])is increasing.Reasoning by contradiction, suppose thatζc0(t1)>ζc0(t2)for some t1, t2 ∈ ]0, c0[, with t1 < t2, and for some c0 ∈ ]0, 1]∖X. It is only a matter of computation to see thatζc0(t1)>ζc0(t2)amounts toφ′(t1)φ′(t2)>φ′(c0−t1)φ′(c0−t2).The above inequality implies that(4.6)φ′(t1)−ϵφ′(t2)+ϵ>φ′(c0−t1)+ϵφ′(c0−t2)−ϵfor a sufficiently small ε > 0. Being φ′ continuous, there exists a sufficiently small δ > 0 such that(4.7)|φ′(t)−φ′(ti)|<ϵ,i=1,2and(4.8)|φ′(t)−φ′(c0−ti)|<ϵ,i=1,2for almost all t such that |t − ti| < δ and |t − (c0 − ti)| < δ respectively and for i ∈ {1, 2}. Now, pick any c ∈ X such that |c − c0| < δ/2: sinceI∖Dφ′,chas measure zero, we can always findu1,u2∈Dφ′,c,with u1 < u2, such that |ui− ti| < δ/2 for i ∈ {1, 2}. In this case, we have all the conditions to employ Eqs. (4.7) and(4.8), so gettingφ′(u1)φ′(u2)>φ′(t1)−ϵφ′(t2)+ϵandφ′(c−u1)φ′(c−u2)<φ′(c0−t1)+ϵφ′(c0−t2)−ϵ.The last two inequalities, combined with Eq. (4.6), lead toφ′(u1)φ′(u2)>φ′(c−u1)φ′(c−u2),or, equivalently, ζc(u1) > ζc(u2), so contradicting the assumption and concluding the proof.□Let us introduce the notable subclass ofS0given byS2={φ∈S0:every member ofZ2(]0,1])is increasing}. The next two results just concern this subclass: in the first one, we show that the verification task of the increasing monotonicity of every member ofZ2(]0,1])may be slightly simplified. In the second one, we will prove thatS1(strictly) includesS2. In order to reduce the complexity of the proof of both the results, an appropriate choice of the dense subset X⊂]0, 1] is required, as suggested in the next remark.Remark 4.12Observe that we can associate with anyφ∈S0a particular dense subset X⊂]0, 1], denoted with X2(φ′), characterized by the property that any x ∈ ]0, 1] belongs to X2(φ′) if, and only if, φ′(x/2) exists. Indeed, consider the set2((I∖Dφ′)∩[0,1/2])(see Eq. (2.1)). Since the Lebesgue measure is positively homogeneous, we getλ(2((I∖Dφ′)∩[0,1/2]))=2λ((I∖Dφ′)∩[0,1/2])=0.Now, the characterizing property of X2(φ′) easily follows if we choose as X2(φ′) the complement of2((I∖Dφ′)∩[0,1/2])with respect to ]0, 1] (for the density of X2(φ′) see, for instance, Nagata, 2004, Proposition 2.4).Letφ∈S0. Assume that every mapping ofZ2(X2(φ′))is increasing on [0, c/2]. Then, every member ofZ2(]0,1])is increasing.Letζc∈Z2(X2(φ′)): by assumption, we know that ζcis increasing on [0, c/2]. Accordingly, from the elementary property ζc(c/2 − t) · ζc(c/2 + t) = 1 for almost all t ∈ ]0, c/2[, we infer that ζcis increasing also on [c/2, c]. Finally, according to Remark 4.12, we have thatc/2∈Dφ′,c,hence we obtainlimt↑c/2ζc(t)=limt↓c/2ζc(t)=ζc(c/2)=1,so obtaining that every mapping ofZ2(X2(φ′))is increasing. Finally, the proof is concluded by applying Lemma 4.11.□Letφ∈S2. Then,φ∈S1.By Propositions 4.5 and 4.6, the claim is equivalent to showing that Eq. (4.2) holds. Reasoning by contradiction, assume there existt0,z0∈Dφ′,with t0 ∈ ]0, 1/2[ and z0 ∈ ]t0, 1 − t0[, such that φ′(t0) > φ′(z0). Set ε ≔ φ′(t0) − φ′(z0). Being φ′ continuous at t0, there exists a sufficiently small δ > 0 such thatφ′(t)>φ′(t0)−ϵ2for allt∈[t0−δ,t0]∩Dφ′. This immediately leads to(4.9)φ′(t)>φ′(z0)+ϵ/2>φ′(z0)for allt∈[t0−δ,t0]∩Dφ′. Now, assignF:=[t0+z0−δ,t0+z0]∩2((I∖Dφ′)∩[0,1/2]).Notice that λ(F) = 0, hence F − {z0} (see Eq. (2.2)) is a zero measure subset of [t0 − δ, t0] due to the invariance under translation of the Lebesgue measure. Accordingly, fixing anyt∈([t0−δ,t0]∖(F−{z0}))∩Dφ′,it is not difficult to see thatφ′(t+z02)exists or, equivalently, t + z0 ∈ X2(φ′). Now, assign c ≔ t + z0. Since it is clear that c ∈ ]0, 1],t,c/2∈Dφ′,cand t < c/2, by applying Eq. (4.9) yields ζc(t) > 1 = ζc(c/2), obtaining that not every member ofZ2(]0,1])is increasing. The contradiction closes the proof.□As noted above, the statement of the previous lemma cannot be reversed. Indeed, consider φ as in Example 4.7. We know that suchφ∈S1. Now, pick anyc∈]34,1[:then, by a simple computation, one finds thatζc(t)=45c−34−tast∈[0,c−34[,hence it is not increasing.Our purpose is to determine the class of generators of penalty functions as in Eq. (3.2) for n = 2. Summarizing the last results so far illustrated, we have shown that both the desired class andS2are strictly included inS1. Further, we have somehow conjectured that these two classes might be coincident. It remains to be seen whether this conjecture is true.Theorem 4.16Letφ∈S1. Then, φ is a generator of a two-dimensional penalty functionPφ:I2×W2×I→Iif, and only if,φ∈S2.Using the change of variable t ≔ y − x1 and setting c ≔ x2 − x1, the claim is equivalent to showing that every member ofF2(]0,1],φ)is quasi-convex if, and only if, anyζc∈Z2(]0,1],φ)is increasing. First, we state that we can associate to anyψc,w∈F2(1)(]0,1]):={ψc,w∈F2(]0,1]):w1≥w2}a uniquely determined pointtc,w*∈[0,c/2]such thatψc,w′(t)≥0for almost allt∈[tc,w*,c]. Indeed, given anyψc,w∈F2(1)(]0,1]),setJ(ψc,w):={u∈]0,c[:ψc,w′(t)≥0almosteverywhereon[u,c]}. It is quite easy to see that J(ψc, w) is a (possibly empty) subinterval of ]0, c[. We assert that J(ψc, w) is not empty, because [c/2, c[⊆J(ψc, w). In fact anyψc,w∈F2(1)(]0,1])is increasing on [c/2, c], because, due to an elementary algebraic manipulation, it may be rewritten asψc,w(t)=w2(φ(t)+φ(c−t))+(w1−w2)φ(t),that is a linear combination with non-negative coefficients of two increasing functions on [c/2, c] (the increasing monotonicity of the mapping φ(t) + φ(c − t) on that subdomain is assured by Proposition 4.6). If we bear in mind Lemma 4.2, this amounts toψc,w′(t)≥0for almost all t ∈ [c/2, c], so the assertion trivially holds as well as the statement, after the assignmenttc,w*:=infJ(ψc,w). By the same token, given anyψc,w∈F2(2)(]0,1]):={ψc,w∈F2(]0,1]):w2>w1},there exists a uniquely determined pointt^c,w∈[c/2,c]such thatψc,w′(t)≤0for almost allt∈[0,t^c,w].Turning back to the claim, let us start with the sufficiency and suppose ab absurdo there exists aψc,w∈F2(]0,1])such that ψc, wis not quasi-convex. We may limit ourselves to the caseψc,w∈F2(1)(]0,1]),since the remaining one may be treated analogously. Trivially, an arbitraryψc,w∈F2(1)(]0,1])is not quasi-convex if, and only if,tc,w*>0andψc,w′(t0)>0for somet0∈]0,tc,w*[. By Remark 4.10, this amounts toζc(t0)>w2w1. By the increasing monotonicity of ζc, we immediately derive that for almost all t ∈ [t0, c] we haveζc(t)>w2w1. Again by Remark 4.10, this means thatψc,w′(t)>0almost everywhere on [t0, c], so contradicting the specific nature of the pointtc,w*and closing this step. Conversely, assume that every member ofF2(]0,1])is quasi-convex. Reasoning by contradiction, suppose that there exists a c ∈ ]0, 1] such that ζc(t1) > ζc(t2) for some t1, t2 ∈ ]0, c[ such that t1 < t2. Suppose first that ζc(t2) < 1. Then, we can always choose a w ∈ W2 such that(4.10)w2/w1∈]ζc(t2),ζc(t1)[,provided that w1 > w2. By Eq. (4.10), bearing in mind that ζcis continuous, we immediately deduce that there exists a sufficiently small δ > 0 such that(4.11)ζc(t)<w2/w1almosteverywhereon[t2−δ,t2+δ],and at the same time(4.12)ζc(t)>w2/w1almosteverywhereon[t1−δ,t1+δ].Owing to Remark 4.10 and Lemma 4.2, we know that Eqs. (4.11) and(4.12) amount to the decreasing and increasing monotonicity of the corresponding ψc, won the intervals [t2 − δ, t2 + δ] and [t1 − δ, t1 + δ] respectively, so showing that ψc, wis not quasi-convex and contradicting the assumption. The remaining case ζc(t2) ≥ 1 may be treated analogously, choosing a w ∈ W2 such thatw2/w1∈]ζc(t2),ζc(t1)[,provided that w2 > w1, so concluding the proof.□We emphasize thatCAis strictly included inS2. Indeed, letφ∈S0:if φ is convex, then φ′ is increasing and so is anyζc∈Z2(]0,1]),being a ratio whose numerator and denominator are an increasing and a decreasing positive function, respectively. Now, consider the followingφ∈S0:φ(t)={t2,t≤34;1−7(t−1)2,otherwise.We claim that such mapping, although evidently not convex, belongs toS2. By Lemma 4.13, being X2(φ′) = ]0, 1], we may check the increasing monotonicity of an arbitraryζc∈Z2(]0,1])on [0, c/2]. Fixing anyc∈]0,34],ζcis clearly increasing because of the convexity of φ on the subdomain[0,34]. Whenc∈]34,1],by a direct computation one finds thatζc(t)={t7(t+1−c),t∈[0,c−3/4[;tc−t,t∈]c−3/4,c/2],hence the claim easily follows.In this section, we generalize the main results of the previous section in order to determine the generators of n-dimensional penalty functions of the form given by Eq. (3.2). For this reason, throughout this section, we will take for granted that n > 2, unless otherwise specified.First, we present the n-dimensional versions of notations already introduced in the previous section for n = 2.Let En= {x ∈ ]0, 1]n − 1: 0 < xj< xj + 1, j = 1, …, n − 2}. For any vector x ∈ En, we will follow the convention x0 ≔ 0. Moreover, throughout this section, we will reserve the symbol X for denoting an arbitrary subset of Endense in the topological closure of En. Given anyφ∈S0,letFn(X,φ)={ψc,w:c∈X,w∈Wn}be the class of mappingsψc,w:[0,cn−1]→Rdefined byψc,w(t)=∑i=1nwiφ(|ci−1−t|).We will adopt the shorthand notationFn(X)forFn(X,φ)unless otherwise stated. Obviously,Fn(X)coincides with the previously introducedF2(X)for n = 2. Similar to the n = 2 case above, we can state that every mapping ofFn(X)is absolutely continuous and a.e. differentiable.Remark 5.1Letφ∈S0andc∈X. Following the same line of reasoning of Remark 4.3, it is easy to see that the complement of the setDφ′,c:={t∈I:max{cj−t,t−cj}∈Dφ′,j=0,…,n−1}has zero measure, hence we may assume that the domain of the derivative of every member of the subclass{ψc,w∈Fn(X):w∈Wn}ofFn(X)is justDφ′,c.The next result is the n-dimensional version of Lemma 4.4 and consequently the proof will be omitted.Lemma 5.2Letφ∈S0. Assume that every function ofFn(X)is quasi-convex for some dense subset X⊂En. Then, every mapping ofFn(En)is quasi-convex.Let An= {p ∈ ]0, ∞[n: p1 = pn= 1}. Given anyφ∈S0,letZn(X,φ)={ζc,p:c∈X,p∈An}be the class of functions defined a.e. on [0, cn − 1] and described asζc,p(t)=∑i=1k+1piφ′(t−ci−1)∑i=k+2npiφ′(ci−1−t),t∈]ck,ck+1[,k∈{0,…,n−2}.We will adopt the shorthand notationZn(X)forZn(X,φ)unless otherwise stated. Obviously,Zn(X)coincides with the previously introducedZ2(X)for n = 2.Remark 5.3Letφ∈S0andc∈X. Observe that there is a natural, biunivocal correspondence between the subclass{ψc,w∈Fn(X,φ):w∈Wn}ofFn(X,φ)and the subclass{ζc,p∈Zn(X,φ):p∈An}ofZn(X,φ). In particular, according to Remark 5.1, we may assume that the domain of any member of{ζc,p∈Zn(X,φ):p∈An}coincides withDφ′,c. Moreover, letψc,w∈Fn(X,φ)andt∈]ck,ck+1[∩Dφ′,cfor some k ∈ {0, …, n − 2}: an elementary computation shows that the inequalityψc,w′(t)>0amounts toζc,pw(t)>wnw1,where the vectorpw∈Anis given by(5.1)(pw)j={wj/w1,j∈{1,…,k+1};wj/wn,j∈{k+2,…,n}.We emphasize the fact that the property of increasing monotonicity of all mappings ofZn(En)will play a crucial role in characterizing the family of generators of penalty functions of the form given by Eq. (3.2). The next result, which states that it suffices to verify such property at least for a particular dense subset X⊂En, relies upon a similar argument as we have used in the proof of the corresponding Lemma 4.11, hence the proof will be omitted.Lemma 5.4Letφ∈S0. Assume that there exists a dense subset X⊂Ensuch that every mapping ofZn(X)is increasing. Then, every member ofZn(En)is increasing.Let us introduce the notable subclass ofS0given bySn={φ∈S0:every member ofZn(En)is increasing}. Note thatSnreduces to the previously introducedS2when n = 2. Remark that the verification task of the characterizing property ofSnmay be slightly simplified if we make use of a suitable dense subset X, illustrated in the next lemma.Lemma 5.5Letφ∈S0and n > 2. LetXn(φ′)={c∈En:ck−cj∈Dφ′for all k, j ∈ {0, …, n − 1} such that k < j}. Then, Xn(φ′) is a dense subset of En.Let x ∈ Enand ε > 0. BeingDφ′a dense subset ofI(see Remark 4.1), after selecting δ1 = min {ε, x1}, we know that there exists a c1 ∈ ]x1 − δ1, x1] such that 0 < c1 ≤ x1, with x1 − c1 < ε, andc1∈Dφ′. Now, consider the set(I∖Dφ′)+{c1}: evidently, this set has measure zero, hence its complement with respect toDφ′is dense inI. Thus, after selecting δ2 = min {ε, x2 − x1}, there exists a c2 ∈ ]x2 − δ2, x2] such thatc2∈Dφ′∖((I∖Dφ′)+{c1}). While it is obvious that x1 < c2 ≤ x2, with x2 − c2 < ε, andc2∈Dφ′,it is not difficult to check thatc2−c1∈Dφ′. Repeating the same argument for a finite number of steps, it is quite easy to see that we can determine a vector c ∈ ]0, 1]n − 1 (following the convention c0 ≔ 0) satisfying the following properties:(A1)xk − 1 < ck≤ xk, k = 1, …, n − 1;ck−cj∈Dφ′for all k, j ∈ {0, …, n − 1} such that k < j;xk− ck< ε, k = 1, …, n − 1.From (A1) and (A2), it directly follows that c ∈ Xn(φ′). Moreover, by (A3) we derive that ‖c − x‖∞ < ε, where the symbol ‖ · ‖∞ stands for the sup norm, so closing the proof.□We emphasize that generally Xn(φ′) does not reduce to X2(φ′) introduced in Remark 4.12 when n = 2.Lemma 5.6Letφ∈S1. Assume that every mapping ofZn(Xn(φ′))is increasing on any subdomain [ck, ck + 1] for all k ∈ {0, …, n − 2}. Then, every member ofZn(En)is increasing.By Lemma 5.4, given anyζc,p∈Zn(Xn(φ′)),it suffices to show that ζc, p(ck−) ≤ ζc, p(ck+) for any k ∈ {1, …, n − 2}, whereζc,p(ck−):=limt↑ckζc,p(t),ζc,p(ck+):=limt↓ckζc,p(t).Observe that ζc, p(ck−) and ζc, p(ck+) exist due to the monotonicity of ζc, pon both the intervals [ck − 1, ck] and [ck, ck + 1]. As a straightforward consequence of the characterizing property of Xn(φ′) and the continuity of φ′, it is quite easy to check thatζc,p(ck−)=∑i=1kpiφ′(ck−ci−1)∑i=k+1npiφ′(ci−1−ck)andζc,p(ck+)=∑i=1k+1piφ′(ck−ci−1)∑i=k+2npiφ′(ci−1−ck).Note that both ζc, p(ck−) and ζc, p(ck+) contain the term φ′(0), which certainly exists and is a finite non-negative number by (P1). Finally, the desired inequality easily follows from the fact that the numerator of ζc, p(ck+) is the sum of the numerator of ζc, p(ck−) and the non-negative term pk + 1φ′(0) and the same holds for the denominators, with interchanged roles of ζc, p(ck−) and ζc, p(ck+).□Now we are ready to state the corresponding result of Theorem 4.16 for the n-dimensional case. Note that, being interested in the case n > 2, we can assume without loss of generality that any candidate φ belongs toS2.Theorem 5.7Letφ∈S2. Then, φ is a generator of a n-dimensional penalty functionPφ:In×Wn×I→Iif, and only if,φ∈Sn.Using the change of variable t ≔ y − x1 and setting ci − 1 ≔ xi− x1 for i = 1, …, n, the claim is equivalent to showing that every member ofFn(En,φ)is quasi-convex if, and only if, anyζc,p∈Zn(En,φ)is increasing. First, we state that we can associate to anyψc,w∈Fn(1)(En):={ψc,w∈Fn(En):w1≥wn}a uniquely determined pointtc,w*∈[0,cn−1[such thatψc,w′(t)≥0for almost allt∈[tc,w*,cn−1]. Indeed, repeating same argument as we have used in the corresponding part of the proof of Theorem 4.16, letψc,w∈Fn(1)(En)and setJ(ψc,w):={u∈]0,cn−1[:ψc,w′(t)≥0almosteverywhereon[u,cn−1]}. Since it is clear that J(ψc, w) is a subinterval of ]0, cn − 1[, the statement easily follows from the assignmenttc,w*:=infJ(ψc,w),provided J(ψc, w) is not empty. To this end, by an elementary algebraic manipulation, anyψc,w∈Fn(1)(En)may be seen as the sum of two functions, i.e. w1φ(t) + wnφ(cn − 1 − t) and∑i=2n−1wiφ(|ci−1−t|),called in the sequel first and second summand, respectively. From the trivial identityw1φ(t)+wnφ(cn−1−t)=(w1+wn)·(w1w1+wnφ(t)+wnw1+wnφ(cn−1−t))we easily deduce that, due to Theorem 4.16, the first summand is increasing at least on [cn − 1/2, cn − 1]. At the same time, since the second summand may be rewritten as∑i=2n−1wiφ(t−ci−1)for t ∈ [cn − 2, cn − 1], it is certainly increasing on the subdomain [cn − 2, cn − 1] due to the monotonicity of φ. Accordingly, we derive that ψc, wis increasing at least on [max {cn − 1/2, cn − 2}, cn − 1], hence, due to Lemma 4.2, we can draw the desired conclusion. By the same token, given anyψc,w∈Fn(2)(En):={ψc,w∈Fn(En):w1<wn},there exists a uniquely determined pointt^c,w∈]0,cn−1]such thatψc,w′(t)≤0for almost allt∈[0,t^c,w]. Turning back to the claim, let us start with the sufficiency and suppose ab absurdo there exists aψc,w∈Fn(En)such that ψc, wis not quasi-convex. We may limit ourselves to the caseψc,w∈Fn(1)(En),since the remaining one may be dealt with in analogous manner. Trivially, an arbitraryψc,w∈Fn(1)(En)is not quasi-convex if, and only if,tc,w*>0andψc,w′(t0)>0for somet0∈]0,tc,w*[. By Remark 5.3, this amounts toζc,pw(t)>wnw1,where the vector pwis as in Eq. (5.1). By the increasing monotonicity ofζc,pw,we immediately derive that for almost all t ∈ [t0, cn − 1] it holdsζc,pw(t)>wnw1. Again by Remark 5.3, this means thatψc,w′(t)>0almost everywhere on [t0, cn − 1], so contradicting the specific nature of the pointtc,w*and closing this step. Conversely, assume that every member ofFn(En)is quasi-convex. Reasoning by contradiction, suppose that there exists at least a member ofZn(En)which is not increasing. By Lemma 5.6, this entails that there exists aζc,p∈Zn(Xn(φ′))such that ζc, p(t1) > ζc, p(t2) for some ck< t1 < t2 < ck + 1 and for some k ∈ {0, …, n − 2}. We only study the case ζc, p(t2) < 1, since the case ζc, p(t2) ≥ 1 may be treated analogously. Then, after the assignmentpt:=∑i=1npi,let us consider the family Un(pt) of vectors w(β) ∈ ]0, 1]ndescribed as(5.2)wj(β)={pj/pt+βpj∑i=k+2npi∑i=1k+1pi,j=1,…,k+1;pj/pt−βpj,j=k+2,…,n,for β ∈ [0, pt[. By a simple computation, one easily finds that Un(pt) is a subset of Wn. Now, if we consider the mapping β↦f(β) ≔ wn(β)/w1(β), it is not a difficult task to check that f is strictly decreasing on [0, 1/pt[ with boundary values f(0) = 1 and f(1/pt) = 0. Hence, we can always choose a β* ∈ ]0, 1/pt[ such that(5.3)f(β*)∈]ζc,p(t2),ζc,p(t1)[.By Eq. (5.3), bearing in mind that ζc, pis continuous, we immediately deduce that there exists a sufficiently small δ > 0 such that(5.4)ζc,p(t)<f(β*)almosteverywhereon[t2−δ,t2+δ],and at the same time(5.5)ζc,p(t)>f(β*)almosteverywhereon[t1−δ,t1+δ].According to Eqs. (5.1) and(5.2), an elementary calculation shows thatp=pw*,where w* ≔ w(β*). Therefore, owing to Remark 5.3 and Lemma 4.2, we know that Eqs. (5.4) and(5.5) amount to the decreasing and increasing monotonicity of the correspondingψc,w*on the intervals [t2 − δ, t2 + δ] and [t1 − δ, t1 + δ], respectively. This shows thatψc,w*is not quasi-convex, so contradicting the assumption and definitely concluding the proof.□Owing to the above result, it is not difficult to show thatSn+1⊂Snfor all n ≥ 2. In fact, by Theorem 5.7, it is enough to show that every member ofFn(En,φ)is quasi-convex for any fixedφ∈Sn+1. The claim is trivially proved if, given anyψc,w∈Fn(En,φ)and any ε > 0, there exists a quasi-convex mappinggϵ:[0,cn−1]→Rsuch that ‖ψc, w− gε‖∞ ≤ ε. Let us choose as gε the function given by gε(t) = ψc, w(t) + ε · φ(|cε − t|), where cε is any real number belonging to ]0, c1[. It is immediate to check that ‖ψc, w− gε‖∞ ≤ ε, hence it remains to be seen whether gε or, equivalently, gε/(1 + ε) is quasi-convex. The last step, left to the reader, is to verify thatgϵ/(1+ϵ)=ψcϵ,wϵ∈Fn+1(En+1,φ),where cε ∈ En + 1 and wε ∈ Wn + 1 are respectively given by(cϵ)j={cϵ,j=1;cj−1,j=2,…,nand(wϵ)j={w1/(1+ϵ),j=1;ϵ/(1+ϵ),j=2;wj−1/(1+ϵ),j=3,…,n+1.We have proved the following.Lemma 5.8Letφ∈Sn+1. Then,φ∈Sn.Notice thatCAis a subclass ofSnfor any n ≥ 2: this statement is exactly based upon the same argument as the one used in Remark 4.17.LetS:=⋂n=2∞Sn: as above noted,CA⊆S. Now the problem is: doesSexactly coincide withCAor not? Well, the answer is negative, as we show in the conclusive part of this section.Consider the functionφ∈S2introduced in Remark 4.17: we will prove that such mapping, which is not convex, actually belongs toSnfor every fixed n > 2. Letζc,p∈Zn(Xn(φ′))and let k ∈ {0, …, n − 2}: by Lemma 5.6, the claim is equivalent to saying that ζc, pis increasing on [ck, ck + 1]. Consider the two finite sequences ξi≔ ci − 1 + 3/4 for i = 1, …, k + 1 and ηi≔ ci − 1 − 3/4 for i = k + 2, …, n. It is immediate to see that(5.6)ηk+2<…<ηn<ξ1<…<ξk+1and that ξi≠ ck, ck + 1 for all i ∈ {1, …, k + 1} as well as ηi≠ ck, ck + 1 for all i ∈ {k + 2, …, n}, because of the characterizing property of Xn(φ′). Note that φ′ exists at allt∈Iexcept for t = ξ1. Let us divide the analysis of ζc, pon [ck, ck + 1] into two main cases:(1)ξ1 < ck;ξ1 > ck.In case 1, we immediately deduce that k > 0 and[ck,ck+1]⊂Dφ′,c. This case in its turn may be divided into the two following sub-cases:(1A)there exists a unique r ∈ {1, …, k} such that ξr< ck< ck + 1 < ξr + 1;there exist two uniquely determined indices r, s ∈ {1, …, k}, with r < s, such that ξr< ck< ξs< ck + 1 < ξs + 1.In the first sub-case, also taking into account Eq. (5.6), it is only a matter of computation to check that for any t ∈ [ck, ck + 1] we have(5.7)ζc,p(t)=7μr(t)+νr(t),whereμj(t):=−(∑i=1jpi)t+∑i=1jpi(1+ci−1)−(∑i=k+2npi)t+∑i=k+2npici−1andνj(t):=∑i=j+1k+1pi(t−ci−1)∑i=k+2npi(ci−1−t)for any index j ∈ {1, …, k}. The increasing monotonicity of νr(t) is immediate, while the condition of (strict) increasing monotonicity for μr(t) is easily shown to be given by(5.8)(∑i=1rpi)·(∑i=k+2npici−1)<(∑i=1rpi(1+ci−1))·(∑i=k+2npi).Observe that Eq. (5.8) directly follows from the trivial inequalities(1+ci−1)pi≥pi,i=1,…,r;pi≥pici−1,i=k+2,…,nand the fact that at least one of the above inequalities is necessarily strict. In sub-case 1B, it is not a difficult task to see that ζc, p, restricted to every subinterval of the type [ck, ξr + 1], ...,[ξs, ck + 1], is again of the form described in Eq. (5.7), with the only difference that μr(t) and νr(t) must be replaced by μj(t) and νj(t) respectively for any j ∈ {r, …, s}, hence we may omit the proof. In case 2, we only discuss the sub-case in which there exist two uniquely determined indices r ∈ {k + 2, …, n − 1} and s ∈ {1, …, k} such thatηr<ck<ηr+1<ηn<ξ1<ξs<ck+1<ξs+1,because any other sub-case is similar and even simpler. Note that[ck,ck+1]∩Dφ′,cis the finite union of three types of subintervals, i.e. [aj, ηj + 1] for any j ∈ {r, …, n − 1}, where aj≔ max {ck, ηj}, then [ηn, ξ1[ and finally [ξj, bj]∖{ξ1} for any j ∈ {1, …, s}, where bj≔ min {ck + 1, ξj + 1}. For the first type, after some elementary algebra, one finds that1ζc,p(t)=7μj*(t)+νj*(t),whereμj*(t):=(∑i=j+1npi)t+∑i=j+1npi(1−ci−1)(∑i=1k+1pi)t−∑i=1k+1pici−1andνj*(t):=∑i=k+2jpi(ci−1−t)∑i=1k+1pi(t−ci−1).The decreasing monotonicity ofνj*(t)is immediate as well as the (strict) decreasing monotonicity ofμj*(t)due to a trivial condition similar to Eq. (5.8), so closing this first step. The increasing monotonicity of ζc, pon the subinterval [ηn, ξ1[ is a straightforward consequence of the convexity of φ on such subdomain. Finally, relatively to any subinterval of the third type, it is quite easy to see that Eq. (5.7) still holds, with μj(t) and νj(t) in place of μr(t) and νr(t), respectively. In order to conclude that the proposed φ belongs toS,it remains to be seen whether ζc, p(ξ1−) ≤ ζc, p(ξ1+): this directly follows from the fact that, after some trivial computation, we getζc,p(ξ1−)ζc,p(ξ1+)=3/4+∑i=2k+1pi(ξ1−ci−1)7/4+∑i=2k+1pi(ξ1−ci−1).

@&#CONCLUSIONS@&#
