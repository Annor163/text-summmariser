@&#MAIN-TITLE@&#
Impulse control of pension fund contributions, in a regime switching economy

@&#HIGHLIGHTS@&#
Research question: when is it optimal to contribute to a pension plan?Return of assets managed by the fund depends on economic regimes.Market frictions, as transaction costs, illiquidity, late payments are considered.An optimal strategy is found numerically based on impulse control technique.Contributions are paid only if assets deviate too much from liabilities.

@&#KEYPHRASES@&#
Pension fund,Impulse control,Regime switching,Transaction costs,Liquidity risk,

@&#ABSTRACT@&#
In defined benefit pension plans, allowances are independent from the financial performance of the fund. And the sponsoring firm pays regularly contributions to limit deviations of fund assets from the mathematical reserve, necessary for covering the promised liabilities. This research paper proposes a method to optimize the timing and size of contributions, in a regime switching economy. The model takes into consideration important market frictions, like transactions costs, late payments and illiquidity. The problem is solved numerically using dynamic programming and impulse control techniques. Our approach is based on parallel grids, with trinomial links, discretizing the asset return in each economic regime.

@&#INTRODUCTION@&#
The world of pension provisions is currently shifting from unfunded social security towards private funding. In this context, the actuarial profession has a strong interest in the funding of pension plans and in timing of contributions payment. Pension funds are either classified as defined contribution or as defined benefit plans. They differ in risk and benefits. In defined contribution schemes, the financial risk is borne by affiliates and benefits directly depend upon assets performance. Whereas, in the other category of plans, this risk is borne by the sponsoring firm of the fund: allowances are warranted and independent from assets returns. For both classes of pension funds, contributions paid a long time before an employee’s retirement, earn higher capital gains than most recent ones. But as they are immediate charges affecting the income statement of the sponsoring corporation, it is important to optimize the contribution schedule. This research paper studies this issue in presence of market frictions, for defined benefits pension funds.Defined benefit pension plans have been extensively analyzed in the literature. Sundaresan and Zapatero (1997) argue that investors should maximize the expected utility of the surplus of assets over the liabilities of the fund. However, especially from the employer’s point of view who pays for the defined benefit pension plan of his employees, the important issue is to find a contribution process which has small fluctuations and which leads as exactly as possible to the value of the mathematical reserve necessary for covering the liabilities promised in the pension plan. Therefore a whole branch of papers has studied the minimization of a loss function of contributions and the wealth to be obtained. In the papers of e.g. Haberman and Sung (1994, 2005), Boulier, Trussant, and Florens (1995), Josa-Fombellida and Rincôn-Zapatero (2004, 2006), the fund manager keeps the value of the assets as close as possible to liabilities by controlling the level of contributions. Cairns (1995, 2000) discusses the role of objectives in selecting an asset allocation strategy and has analyzed some current problems faced by defined benefit pension funds. Huang and Cairns (2006) or Hainaut and Deelstra (2011) study the optimal contribution rate for defined benefit pension plans when interest rates are stochastic.But till now, this issue has mainly been studied with stable economic sources of randomness. The interested reader may e.g. refer to papers of Haberman and Sung (1994), Boulier et al. (1995), Cairns (2000) or Josa-Fombellida and Rincôn-Zapatero (2004, 2006, 2008, 2010) in which both contributions and assets allocation are optimized in continuous time and without transaction costs. In these works, the market is modeled by geometric Brownian motions. Even though this model is very popular, it is a well-known fact that pure diffusion processes are not an adequate representation of the characteristics of long term returns from risky assets. The papers of Ngwira and Gerrard (2007) or of Josa-Fombellida and Rincôn-Zapatero (2012) remedy to this drawback by adding jumps in assets returns and study the pension funding and asset allocation problem.Jump-diffusion models represent a significant advance in research. But contrary to switching regime processes, they are partly unsatisfactory because they fail to duplicate economic cycles as stated by Henry (2009). Switching regime processes have already received a lot of attention in investment management practice with Hunt and Kavesh (1976), Hunt (1987) or Stovall (1996). Guidolin and Timmermann (2005) present evidence of persistent ‘bull’ and ‘bear’ regimes in UK stock and bond returns and considers their economic implications from the perspective of an investor’s portfolio allocation. Similar results are found in Guidolin and Timmermann (2008), for international stock markets. Guidolin and Timmermann (2007) characterizes investors’ asset allocation decisions under a regime switching model for asset returns with four states that are characterized as crash, slow growth, bull and recovery states. Cholette, Heinen, and Valdesogo (2009) fit skewed-t GARCH marginal distributions for international equity returns and a regime switching copula with two states. Al-Anaswah and Wilfing (2011) estimate a two-regimes Markov-switching specification of speculative bubbles. Hainaut and MacGilchrist (2012) study the strategic asset allocation between stocks and bonds when both marginal returns and copula are determined by a hidden Markov chain. On another hand, Calvet and Fisher (2001, 2004) shows that discretized versions of multifractal processes captures thick tails and have a switching regime structure. Finally, Hardy (2001) and the society of actuaries (SOA) since 2004, recommends switching processes to model long term stocks return, in actuarial applications. Frauendorfer, Jacoby, and Schwendener (2007) or Korn, Tak Kuen, and Zhang (2009) adopted this approach to optimize assets allocation in defined contribution pension plans.Defined benefits pension plans are funded by contributions paid in by their sponsoring firm (and/or employees) and by the return on the invested capital. This work proposes a method to optimize the timing and size of these payments, whether fund assets are driven by a switching regime diffusion and in presence of market frictions. It contributes to the literature in several directions. First, research papers cited in this introduction optimizes payments in continuous time and without transaction costs. These unrealistic assumptions are removed in the studied framework. Instead, contributions are here controlled impulses, paid at discrete times, when assets deviate too much from liabilities. And transaction costs are both fixed and proportional to the volume of assets purchased or sold. The solving approach is based on dynamic programming and inspired from the works of Korn (1998, 1999) and Costabile, Leccadito, Massabo, and Russo (2014). The model takes also into consideration market imperfections. The first one is late payments, when delays are distributed as an exponential random variable. The second one is illiquidity that entails as underlined by Cont (2014), a relation between volume of assets purchased or sold and prices. In both cases, the impulse control strategy is adjusted to partly anticipate the impact of these frictions. Finally, this work proposes a method to calculate probabilities that the sponsor contributes to the fund over a certain time horizon. These probabilities are interesting management tools, not available when contribution calls are modeled by a continuous process.The remainder of the paper is organized as follows. First, the features of the pension fund and the dynamics of its assets are introduced. Next, the Markov chain defining parameters in each economic regime is detailed. The third and fourth sections develop respectively the objective of the fund and the dynamic programming equation. These are followed by a paragraph detailing the numerical method based on parallel grids. Sections 7 and 8 respectively adapt the solving algorithm to take into account illiquidity risk and delay of payments. They are followed by a paragraph developing a method to estimate probabilities of impulse. The paper is concluded by a numerical illustration, in which the return of assets is modeled by a four states switching regime diffusion, fitted to CAC 40 daily returns.We consider a defined pension fund during the accumulation phase, that pays benefits at maturity T. The value of actuarial commitments, accounted as a liability in the balance sheet of the pension fund, is notedR(t). This actuarial liability (also called technical provision, or mathematical reserve)R(t)is the sum of expected discounted benefits, earned by employees at time t. We assume that no benefits is paid during the accumulation phase.Assets managed by the pension fund are financed by a sponsor which is usually a private company outsourcing its pension liabilities. During the accumulation phase, to face the growth of charges related to retirement of employees, the sponsor regularly contributes to the fund. These capital injections or withdrawals limit deviations of fund assets from the mathematical reserve, necessary for covering the promised liabilities. But the timing and amounts paid in depend widely on the performance of assets. These assets are most of a time a basket of stocks and bonds, regularly rebalanced so as to maintain a constant proportion of stocks. The categories of assets and their percentages (the so called asset-mix) are defined in the mandate of management, that formally links the sponsor and the pension fund. As the definition of the asset mix sets indirectly by the same occasion the expected return and risk of assets, we focus in the remainder of this work on the optimization of the schedule and size of contributions. The influence of different sources of incompleteness are studied in the following sections. But we first only consider transaction costs.In the remainder,Atdenotes the market value of assets managed by the pension fund. This is a stochastic process, defined on a probability space(Ω,F,{F}t,P). And its dynamics is ruled by an observable Markov chain,αtdefined on the same probability space. This chain carries on information about the current economic conjuncture and takes a finite number of values, noted N. Each value corresponds to a certain state of the economy (e.g. bull or bear market) and sets the average return and the volatility of assets. The features ofαtare developed in the next section. Before continuing, we define what we call an impulse strategy.The assets are supplied by contributions at discrete times. An impulse strategy to contribute,S=(τn,δn), consists in a sequence such that for alln∈N, the timesτiare stopping w.r.t. the filtration(Ft)t⩾0.τnis the nth time at which the sponsor pays in a contribution to purchase new assets. Andδn>0defines the size of this contribution, that is measurable w.r.t. the sigma algebra ofτnpastFτn“control actions”. The set of admissible impulse strategies is notedA.The market value of assets is driven by a switching diffusion processXtAdefined as follows:(2.1)dXtA=μA(αt)dt+σA(αt)dWtAwhereμA(αt),σA(αt)are function of the Markov chainαt, representative of the economic situation.WtAis here a Brownian motion. The initial value ofXtAis set tolnA0. The calibration of such type of processes to real time series is done with the Hamilton’s filter (1989), reminded in Appendix A. An application using the filter is presented in Section 10. If no contribution is paid in till time t, the market value of assets is equal to:(2.2)At=eXtA=eX0A+∫0tμA(αs)ds+∫0tσA(αs)dWsA.If the sponsor supplies a net contributionItat time t (by net, we mean after transaction costs), the assets market value increases of:(2.3)At=At-+It.But instead of working with absolute amount of money, we translate this contribution as a jump in the assets return, notedδtand calculated as follows:(2.4)XtA-Xt-A=ln1+ItAt-=δt,and thenIt=At-(eδt-1). The dynamics of assets can be rephrased as(2.5)dXtA=μA(αt)dt+σA(αt)dWtA+d1{τj⩽t}δj,whereas the market value of assets under management becomes(2.6)At=eXtA=eX0A+∫0tμA(αs)ds+∫0tσA(αs)dWsA+∑j=1∞1{τj⩽t}δj.Before presenting the optimization criterion used to set up an impulse strategy of contributions, we detail the features of the Markov chainαt.As mentioned earlier,αtis a discrete variable providing information about the economic conjuncture. Furthermore it drives the assets return and volatility. Under the assumption that there exist N states,αtakes its values in the setN={1,2,…N}and admits an intensity matrix Q whose elements, denoted byqi,j, satisfy the following conditions:(3.1)qi,j⩾0∀i≠j∑j=1Nqi,j=0∀i∈N.The transition probabilities between any two times t andu⩾tare computed as the (matrix) exponential of Q:(3.2)P(t,u)=exp(Q(u-t)).The elements of the matrixP(t,u)are denoted bypi,j(t,u)for alli,j∈N. Indeed,pi,j(t,u)is the probability of jumping from state i at time t to state j at time u:(3.3)pi,j(t,u)=P(αu=j|αt=i)i,j∈N.The probability of being in state i at time t, denoted bypi(t), can be expressed as a function of the initial probabilitiespk=1,…,N(0)at timet=0as follows:(3.4)pi(t)=P(αt=i)=∑k=1Npk(0)pk,i(0,t)∀i∈N.When the time tends to infinity, it can be shown that the asymptotic probability is independent from the initial state (steady-state probabilities):(3.5)limt→+∞pi(t)=pi∀i∈N.In this framework, we denote byτithe random time at which the Markov chainαchanges of state for theithtimes.The pension fund collects or eventually redeems contributions from or to the sponsor. Both operations imply to adjust the size of assets under management and generate transaction costs, fixed and proportional to amount raised. These fixed and proportional costs are respectively notedc1andc2. And the total cost related to a modification of assets at timeτis linked to the impulseδas follows(4.1)Cost=c1+c2|Aτ-Aτ-|=c1+c2|Aτ(eδ-1)|The pension fund aims naturally to minimize the contribution risk, measured here as the sum of all transaction costs over the time horizon T of the accumulation phase, eventually discounted at a rate notedγ. On another hand, It is widely recognized in the optimal pension fund control literature that the goal of the pension plan sponsor and trustees is to minimize the solvency risk. As suggested in Ngwira and Gerrard (2007), the common approach to measuring solvency risk is to consider deviations between the value of the fund, and the actuarial liability,R(t). The solvency risk at time t is assessed by a quadratic utility function of the surplus, which is the difference between assets and liabilities:(4.2)U(At,R(t))=(At-R(t))-κ2(At-R(t))2,whereκ2is a positive constant. Maximizing this utility is equivalent to optimize the surplus and to penalize large deviations of assets from liabilities. If T is the investor’s time horizon, the value function, defining our impulse control problem, is then given by:(4.3)J(t,At,αt)=maxS=(τn,δn)∈AEP-∑e-γ(τn-t)c1+c2Aτn(eδn-1)+∫tTe-γ(s-t)U(As,R(s))ds+e-γ(T-t)U(AT,R(T))|FtInstead of trying to solve the quasi-variational inequality satisfied by the value function, we work with a discrete version of the dynamic programming principle to propose a numerical method.First, let us assume consider a small interval of timeΔ. According to the dynamic programming principle, the value function can be rewritten as:(5.1)J(t,At,αt)=maxS=(τn,δn)∈AEP-∑e-γ(τn-t)c1+c2Aτn(eδn-1)+∫tt+Δe-γ(s-t)U(As,R(s))ds+e-∫tt+ΔγdsJ(t+Δ,At+Δ,αt+Δ)|Ft.Atandαtbeing our state variables, the impulse is triggered once that these processes cross the border delimiting the domain into what we call the action and inaction regions. The inaction region is a subset ofR+, notedDt(αt). This domain depends on the state of the economy and ifAtis located in this area, it is suboptimal to inject or withdraw money from the fund. In this scenario, the value function is then approached by(5.2)J(t,At,αt)≈U(At,R(t))Δ+e-γΔEP(J(t+Δ,At+Δ,αt+Δ)|Ft)At∈Dt(αt)Let us denote the operatorM(·), that provides the value function just after adjustment of the assets size:(5.3)MJ(t,At,αt)=maxδ>0J(t,Ateδ,αt)-(c1+c2|At(eδ-1)|)IfAtis located in the inaction region, an immediate action does not need to be optimal. And this yields the following inequality:(5.4)J(t,At,αt)⩾MJ(t-,At-,αt-)At∈Dt(αt).In the opposite case, ifAtenters into the action region, it is optimal to adjust the assets size by a contribution call. And in this scenario, we must have the equalityJ(t,At,αt)=MJ(t-,At-,αt-)whenAt-∈Dtc(αt). To summarize, the (approached) value function satisfies the next system of equations:(5.5)J(t,At,αt)≈U(At,R(t))Δ+e-γΔEPJ(t+Δ,At+Δ,αt+Δ)|FtAt∈Dt(αt)J(t,At,αt)=MJ(t-,At-,αt-)At∈Dtc(αt).Furthermore, as it is never optimal to call for contributions at maturity due to transaction costs, the value function at time T is equal to the utility function:(5.6)J(T,AT,αT)=U(AT,R(T))andDT(αT)=R+, whatsoever the state of the economy,αt. The next section presents a grid based method to solve the system (5.5), by backward iterations.This section develops a grid-based method for solving the impulse control problem under regime-switching. More precisely, the evolution of asset returnXt, is approximated by several recombining grids. Each of these grid corresponds to a regime. At each node of the grid, a trinomial lattice approaches the normal law of returns using a trinomial distribution. This distribution is constructed by imposing that the conditional local mean and variance at each node are equal to those of the basic continuous-time process. The interested reader can refer to Brigo and Mercurio (2006) annex F for details about similar lattices applied to interest rates modeling. The geometry of the grid is then designed to ensure all branching probabilities remain positive. Fig. 6.1shows such example of grid. Note that by an adapted impulse, at a given time, it is possible to reach any node of the grid from any other node.The first stage of our approach is the discretizing of the time horizon. From time 0 to T, we choose a finite set of n times0=t0<t1<⋯<tn=T. The length of time intervals is notedΔ=ti+1-ti. For each regimeα=1…N, we define a finite number of equispaced nodesx,jα. If we noteΔxαthe distance between nodes at timeti, the value of nodes is defined asxi,jα=jΔxαwhere j is an integer running forjlowtojhigh. The stepΔxαis set to1.2σA(α). By doing so, N grids are defined. Each one corresponds to a regime and is used to model the dynamics of assets return exclusively in this regime.In regimeα, ifXtireaches the nodexi,jαat timeti, it is assumed that it can move to the following nodes,xi+1,k-1α,xi+1,kα,xi+1,k+1α, with the respective probabilitiespdα,pmαandpuα(to simplify notation, we drop the indexes i and j). The nodexi+1,kαis the closest node to the theoretical expectation in regimeα,EXti+Δ|Xti=xi,jα,αtt+1=αtt=α. These transition probabilities are chosen so that the first two moments of the discrete process match the moments of the continuous process. We adopt the following notations for the local centered moments ofXti+Δ:Mi,jα=EXti+Δ|Xti=xi,jααtt+1=αtt=αVi,jα=EXti+Δ-Mi,jα2|Xti=xi,jααtt+1=αtt=αThenk=roundMijαΔxα-jlow. If we defineηj,kα=Mi,jα-xi+1,kα, the probabilities matching these moments are given by the following expressions:puα=Vi,jα22Δxα2+ηj,kα22Δxα2+ηj,kα2Δxαpmα=1-Vi,jα2Δxα2-ηj,kα2(Δxα)2pdα=Vi,jα22(Δxα)2+ηj,kα22(Δxα)2-ηj,kα(2Δxα)As illustrated in Fig. 6.1, upper and lower nodes,xi,jhighxi,jlow, are respectively connected toxi+1,jhigh-2α,xi+1,jhigh-1α,xi+1,jhighαand toxi+1,jlow-2α,xi+1,jlow-1α,xi+1,jlowα. The procedure previously described, yields recombining grids per state of the economy. As the regime of the economy switches between several states, we need to manage these transitions during the optimization procedure. We opt for an approach similar to the one of Costabile et al. (2014) for binomial trees. We assume that regime switches occur only at discrete times and assess backward the value function. More precisely, in each regime and at each step of time, we first appraise the value function without any impulse, notedJNI:(6.1)JNIti,xi,jα,α=Uxi,jα,R(ti)Δ+∑β=1Ne-γΔpα,β(ti,ti+1)×puαJ(ti+1,xi+1,k+1α,β)+pmαJ(ti+1,xi+1,kα,β)+pdαJ(ti+1,xi+1,k-1α,β)wherepα,β(ti,ti+1)is the probability of switching from regimeαtoβduring the time interval[ti,ti+1]. Ifβ≠α, the valuesxi+1,k+1α,xi+1,kαandxi+1,k-1αdo not coincide with any value of the grid discretizing the dynamics ofXtin regimeβ. However, we can estimate the value functionsJti+1,xi+1,k+.α,βat these points by any standard interpolation scheme applied to available dataJti+1,xi+1,jβ,βforj=llow…jhigh. In numerical applications developed at the end of this work, we use cubic splines. Once that this step is finished, we check if an impulse control is optimal and calculate the value function as the following maximum:(6.2)Jti,xi,jα,α=maxk=jlowtojhighJNIti,xi,jα,α,JNIti,xi,kα,α-c1+c2A0xi,jαexi,kα-xi,jα-1whereA0xi,jαis the assets value at node(i,j). If it is optimal to modify the assets and ifk∗is the index maximizing Eq. (6.2), the optimal impulse at notexi,jαis equal toδi,jα=xi,k∗α-xi,jα. To summarize, the algorithm implemented is the following:Algorithm 1Backward calculation of the value function.Forα=1to NFori=n-1to 0Forj=jlowtojhighCalculateJNI(ti,xi,jα,α)with Eq. (6.1)endForj=jlowtojhighCalculateJ(ti,xi,jα,α)with Eq. (6.2)endendendA numerical application of this algorithm is presented in Section 10.In this section, we suggest a model for the liquidity risk and its impact onAt. As previously, transactions done by the pension fund happens only at discrete times and incur some fixed and proportional costs. However, due to illiquidity, prices are respectively pushed up or moved down when purchasing or selling assets. The price impact of a transaction on the total market value of assets is defined by a functionG(At,At-). In case of a purchase or of a sale of an amount of assets equal toAt(eδ-1)(ifδ>0, purchaseδ<0sale), the impact of this operation on the total assets is assumed linear and provided by(7.1)G(At,At-)=At(eδ-1)(1+λAt|eδ-1|)whereλis a positive constant related to the fact that larger trades generate larger quantity impact.λcan also be seen as a measure of the market depth. When a transaction occurs at time t, with a pre-trade market value of assets,At-, the post-trade market value of is equal to:(7.2)At=At-+At-(eδ-1)(1+λAt|eδ-1|)=At-(1+(eδ-1)(1+λAt|eδ-1|))This cost function is consistent with the asymmetric information and inventory motives in the market microstructure literature (see e.g. Kyle, 1985). The value function, defining our impulse control problem, is not modified by the illiquidity risk. And in the inaction region, still notedDt(αt), the value function is again approached by the following relation:(7.3)J(t,At,αt)≈U(At,R(t))Δ+e-γΔEPJ(t+Δ,At+Δ,αt+Δ)|FtAt∈Dt(αt).The size of impulses is modified by the illiquidity risk. The value of the strategy just after adjustment of the assets size, defined by the operatorM(·), is then modified as follows(7.4)MJ(t,At,αt)=maxδ>0J(t,At-(1+(eδ-1)(1+λAt|eδ-1|)),αt)-(c1+c2|At(eδ-1)|).As done in the previous section, the value function can be computed backward on several grids discretizing the assets returnXtin each regime. However to assess the cost of an action, we have to determine the impulseδneeded to jump from one node of a grid to another one.Proposition 7.1The impulse required to reachAti=A0exi,kαstarting fromAti-=A0exi,jαis provided by(7.5)δj,kα=ln-(1-2λAti-)+1+4λ(Ati-Ati-)2λAti-ifAti>Ati-(7.6)δj,kα=ln(1+2λAti-)-1+4λ(Ati--Ati)2λAti-ifAti<Ati-According relation (7.2), ifAti⩾Ati-, the impulseδ(we drop momentarily the subscriptsi,jandα) required to reachAti=A0exi,kαstarting fromAti-=A0exi,jαis positive and satisfies the relation:(7.7)AtiAti--1=(eδ-1)(1+λAti-(eδ-1))Let us denotey=eδ, then Eq. (7.7) becomes(7.8)λAti--AtiAti-+(1-2λAti-)y+(λAti-)y2=0The discriminant of this second order polynomial isρ=(1-2λAti-)2+4(λAti-)AtiAti--λAti-=1+4λ(Ati-Ati-)and the roots of (7.8) are given byy±=-(1-2λAti-)±1+4λ(Ati-Ati-)2λAti-but onlyy+is acceptable. ifAti<Ati-,y=eδis one of the roots of(7.9)AtiAti-+λAti--(1+2λAti-)y+λAti-y2=0which arey±=(1+2λAti-)±1+4λ(Ati--Ati)2λAti-but onlyy-is acceptable. □The value function is still computed by backward iterations as depicted in Algorithm 1, excepted that we replace Eq. (6.2) by the following:(7.10)Jti,xi,jα,α=maxk=jlowtojhighJNIti,xi,jα,α,JNIti,xi,kα,α-c1+c2A0xi,jαeδj,kα-1whereδj,kαis the impulse needed to jump fromA0xi,jαtoA0xi,kα, such as determined by (7.5) or (7.6). The impact of liquidity risk is illustrated later in numerical applications.In practice, there exists a delay between the contribution call and the effective purchase or sale of assets. This interval of time is random and depends on many external factors such size of transactions or market frictions. In this section, we adapt the model without liquidity risk so as to analyze the impact of these delays on optimal impulse strategies. In the rest of this section, the delay of (dis)-investment is notedΔiand assumed to be distributed as an exponential of parameterη. The average delay is thenEP1ηand its density is(8.1)fΔi(u)=ηe-ηu.As previously, the pension fund aims naturally to minimize the contribution risk and the solvency risk. The value function, taking into account the delay, is now given by(8.2)J(t,At,αt)=maxS=(τn,δn)∈AEP-∑e-γ(τn+Δi-t)c1+c2Aτn+Δi(eδn-1)+∫tTe-γ(s-t)U(As,R(s))ds+e-γ(T-t)U(AT,R(T))|Ft.The delay being independent from assets, we can rewrite this value function as follows:(8.3)J(t,At,αt)=maxS=(τn,δn)∈AEP-∑∫0+∞e-γ(τn+u-t)(c1+c2|Aτn+u(eδn-1)|)fΔi(u)du+∫tTe-γ(s-t)U(As,R(s))ds+e-γ(T-t)U(AT,R(T))|Ftand the integral present in this equation is developed in the next proposition.Proposition 8.1Let us define the matrix,(8.4)C=Q′+diagμA(1)+12σA(1)2-γ-η⋮μA(N)+12σA(N)2-γ-ηthen the integral in(8.3)is equal to the sum of(8.5)∫0+∞e-γ(τn+u-t)c1+c2Aτn+u(eδn-1)fΔi(u)du=c1e-γτn-tηη+γ-c2ηe-γ(τn-t)AτnC-1∊(τn);1(eδn-1)The integral in (8.3) can be rewritten as:(8.6)∫0+∞e-γ(τn+u-t)c1+c2Aτn+u(eδn-1)fΔi(u)du=c1Ee-γτn+Δi-t|τn+c2Ee-γτn+Δi-tAτn+Δi|τn(eδn-1)the density of the delay being known, we easily infer that(8.7)E(e-γ(τn+Δi-t)|τn)=e-γ(τn-t)ηη+γ,and on another hand, we have that(8.8)Ee-γ(τn+Δi-t)Aτn+Δi|τn=∫0∞EAτne-γ(τn-t)e∫0uμA(αs)-γds+∫0uσA(αs)dWsAηe-ηudu=∫0∞Aτne-γ(τn-t)Ee∑k=1NμA(k)-γ+12σA(k)2Tk(τn,u)ηe-ηudu.If we introduce the matrix B defined asB=Q′+diagμA(1)+12σA(1)2-γ⋮μA(N)+12σA(N)2-γ,according to the result of Buffington and Elliott (2002), the expectation in the integral (8.8) is equal toEe∑k=1NμA(k)-γ+12σA(k)2Tk(τn,u)=〈exp(Bu)∊(τn);1〉where∊(t)=(∊(i,α(t))i∈N)′is a vector taking its values in the set of units vectors{e1,e2…eN}. Then, expression (8.8) becomesEe-γ(τn+Δi-t)Aτn+Δi=ηe-γ(τn-t)Aτn∫0∞〈exp(Bu)∊(τn);1〉e-ηudu=ηe-γ(τn-t)Aτn∫0∞〈exp(Cu)∊(τn);1〉duwhere C is defined by Eq. (8.4). If we combine the next resultEe-γ(τn+Δi-t)Aτn+Δi=ηe-γ(τn-t)Aτn∫0∞exp(Cu)∊(τn);1du=ηe-γ(τn-t)Aτn[〈C-1exp(Cu)∊(τn);1〉]u=0u=∞=-ηe-γ(τn-t)Aτn〈C-1∊(τn);1〉with Eqs. (8.6) and (8.7) we get well (8.5). □Based on the result of the last proposition, the objective function becomes nowJ(t,At,αt)=maxS=(τn,δn)∈AEP-∑e-γ(τn-t)c1ηη+γ+c2ηe-γ(τn-t)Aτn〈C-1∊(τn);1〉|(eδn-1)|+∫tTe-γ(s-t)U(As,R(s))ds+e-γ(T-t)U(AT,R(T))|FtAs done in the previous section, the value function can be computed backward with Algorithm 1. In the inaction region,Dt(αt), the value function is still approached by Eq. (5.2) whereas we replace Eq. (6.2) by the following:(8.9)J(ti,xi,jα,α)=maxk=jlowtojhighJNI(ti,xi,jα,α),JNI(ti,xi,kα,α)-c1ηη+γ-c2ηC-1∊(t);1A0xi,jα(eδj,kα-1)The influence of a delay on the optimal contribution scheme is tested in the section devoted to numerical applications.This section introduces a method based on grids previously built to assess at a given time and per assets value, the (approached) probability that the sponsor contributes to the fund over a certain time horizon. It consists in moving backward through the meshes of optimal impulses computed by a first backward procedure, such as described in Algorithm 1. Let us denote byP(τ⩽ts|τ>ti,Ati=A0exi,jα,αt=α)=P(ti,xi,jα,α)the probability at timeti, that an impulse occur before timets⩾ti, when the processXtis at the nodexi,jα. Clearly,P(ts,xs,jα,α)=1(resp.P(ts,xs,jα,α)=0) ifδs,jα≠0(resp.δs,jα=0). Furthermore,P(ti,xi,jα,α)can be rewritten as the following expectation:P(ti,xi,jα,α)=EP(1τ⩽ts|τ>ti,Ati=A0exi,jα,αt=α)If allPti+1,xi+1,..,.are known, the above expression is approached by the following relation:(9.1)Pti,xi,jα,α≈max1δi,jα≠0,∑β=1Npα,β(ti,ti+Δ)×puβPti+1,xi+1,k+1α,β+pmβPti+1,xi+1,kα,β+pdβPti+1,xi+1,k-1α,βwherepα,β(ti,ti+Δ)is the probability of switching from regimeαtoβduring the time interval[ti,ti+Δ]. As for the value function, ifβ≠α,xi+1,kαandxi+1,k-1αdo not coincide with any value of the grid discretizing the dynamics ofXtin regimeβ. However, we can estimate missing probabilities by an interpolation scheme applied to available dataPti+1,xi+1,jβ,βforj=llow…jhigh. Based on Eq. (9.1), probabilities of impulseP(t0,x0,jα,α)are obtained by successive backward iterations such as described in Algorithm 2.Algorithm 2Backward calculation of the value function.Pt0,x0,jα,αInitializePts,xs,jα,αForα=1to NFori=s-1to 0Forj=jlowtojhighCalculateP(ti,xi,jα,α)with Eq. (9.1)endendendThe dynamics ofAtis fitted to the time series of CAC 40 (the French stocks index) daily log-returns. The period considered runs from the 22/3/1999 to 14/4/2013 (3596 observations). A standard Hamilton’s filter is used, such as detailed in Appendix A. Gatumel and Ielpom (2011) reject the hypothesis that two regimes are enough to capture asset returns evolutions for many securities. Their empirical results point out that between two and five regimes are required to capture the features of each asset’s distribution. Based on this observation, models with two to five regimes are tested and their loglikelihoods (Logliks), akaike information criterion (AIC), and bayesian information criterion (BIC) are presented in Table 10.1. According to loglikelihoods and AIC, four regimes are optimal to model the CAC 40. Expected returns, volatilities and matrix of 1year transition probabilities are provided in Tables 10.2 and 10.3. Assets managed by the pension funds are assumed to follow the same dynamics in later developments. As discussed in Guidolin and Timmermann (2007), every state ofαtcorresponds to an economic cycle. States 1 and 2 are respectively characterized by bull and slow-growth markets. Whereas states 3 and 4 are respectively identified as slowing down markets or market crashes.In reality the Markov chainαtis not visible, contrary to the assumption done in this paper. However, the filtering procedure yields probabilities of presence in each state (see formula (11.2) in Appendix A) that can be used to determine the current economic cycle. This is illustrated by Fig. 10.1that presents the probability of presence in state 1 and 2 (phases of sharp or moderate economic growth) during the last ten years. As revealed by this graph, periods during which this sum of probabilities is close to zero are easily identified to recent economic downturn, like sovereign debts crisis or internet bubble burst.To test numerical algorithms presented previously, we consider liabilities having an initial value ofR0=100and growing at a continuous rate of 5% for the next five years. The actuarial liability at time t is then equal toR(t)=100e0.05t. We split a year into 60 steps of time. The other parameters used by the algorithm are provided in Table 10.4. In the first set of tests, we assume no delay between contribution calls and purchases of assets and no liquidity effects.Fig. 10.2presents the upper and lower boundaries delimiting action and inaction domains, in each state ofαt. The staircase shapes of these curves is mainly due to the size of time and return steps. The inaction region is a corridor centered around the profile of liabilities, in all states. Furthermore, in third and fourth states (bad economic conjunctures), the inaction area is much wider than in phases of economic growth. The figure also shows the assets value after payment of a contribution (lines “Lower” and “Upper Arrival”). We notice that at a given time, for any nodes in the action region, the impulse is such that the arrival value of assets is the same. And the post impulse assets values are well far inside the inaction region.Fig. 10.3shows the probability of calling the sponsor to pay a contribution during the first quarter, as a function of the initial value of assetsA0. During cycles of economic growth (states 1 and 2), the corridor in which probabilities of impulse are low is narrower than during economic downturns (states 3 and 4). Whatever the states, the probability of impulse is minimized when the value of assets is around these of liabilities (A0=R0=100).Finally, we assess the influence of a delay between the contribution call and the effective purchase of assets. The delay is exponentially distributed with a parameter set toη=1. The two upper graphs of Fig. 10.4compare boundaries and post impulse assets value (to put in evidence we truncate the x-axis to the first year), with and without time delay, for state 2. A delay tends to move both lower boundary and arrival values to the left. Whereas, upper boundary and arrival values are shifted to the right. Other tests revealed that the amplitude of shifts is directly proportional to the average delay and that similar conclusions can be drawn in other states ofαt. The two graphs in the lower part of Fig. 10.4 compare boundaries and arrivals when the market is illiquid, for state 2. The parameter determining the impact on price of a transaction is set toλ=0.02. The influence of illiquidity is similar to the delay. Lower and upper boundaries are respectively shifted to the left and to the right. Sizes of shifts increase withλand similar effects are observed in states 1, 3 and 4.

@&#CONCLUSIONS@&#
This paper proposes a method to optimize both the timing and size of contributions to a defined benefit pension plan, in a regime switching economy. The model takes also into consideration important market frictions, like transactions costs, late payments and illiquidity.Changes in the economic environment observed over the last decades, are modeled here by a Markov modulated Brownian motion. Transaction costs being considered, the optimal contribution pattern is not continuous and consists in a series of impulses. The problem is solved numerically using dynamic programming and relies on parallel trinomial grids, discretizing the assets return in each economic regime.As illustrated in numerical examples, the algorithm yields a corridor per regime, splitting the domain time vs assets return into inaction and action regions. Once that the market value of assets leaves this corridor, the sponsoring firm contributes to the pension fund. It seems that the volatility in each state determines the width of this corridor. We also propose a method to calculate the probability of impulse, which is an useful tool to anticipate contribution calls.The methodology is next enhanced to eventually consider illiquidity risk and late payments. In illiquid markets, prices movements are caused by large assets transactions. These two market frictions have a similar influence. Illiquidity or delay between contribution calls and purchase of assets shift respectively to the left or to right, the upper or lower bounds of the corridor delimiting the inaction region.There would be practical and academic areas in our funding approach adapted in this paper could be extended and improved. In particular, it could be interesting to develop a framework to optimize both the assets allocation and contributions call.The series of daily log return of the CAC 40 has been retrieved from the 22/3/1999 to 14/4/2013 (3596 observations). The discrete version of their dynamics isΔXt=μ(αt)Δt+σ(αt)ΔWtwhereΔWtAis a normal random variableN0,Δt. For a given occurrence ofαt, the variation ofXt, on[t,t+Δt], is then normally distributed:(11.1)ΔXt=Nμ(αt)Δt,σ(αt)Δt,and we note its density,f(ΔXt). In reality, the stateαtis not directly observable, but the filtering technique developed by Hamilton (1989) and inspired from the Kalman’s filter (1960) allows us to retrieve the probabilities of being in a state given previous observations. We briefly summarize this filter. Let us noteΔXi=0,…,tthe observed variation of short term rates on the past periods. Let us define the probabilities of presence in a certain state j as:πtj=P(αt=j|ΔX1,…,ΔXt).Hamilton has proved that the vectorπt=πtjj=1…dcan be calculated as a function of the probabilities of presence during previous periods:(11.2)πt=f(ΔXt)*πt-1′P(t,t+Δt)f(ΔXt)*πt-1′P(t,t+Δt),1where1=(1,…,1)∈Rdandx*yis the Hadamard product(x1y1,…,xdyd). To start the recursion, we assume that the Markov processαthas reached its stable distribution.π0is then set to the ergodic distribution ofαt, which is the eigenvector of the matrixP(t,t+Δt), coupled to the eigenvalue equal to 1. If we observed the interest rate process on t periods, the loglikelihood function is:(11.3)lnL(ΔX1,…,ΔXT)=∑t=0Tln〈f(ΔXt),(πt-1P(t,t+Δt))〉.The most likely parameters,(μ(1),…,μ(N),σ(1),…,σ(N))and transition matrix are obtained by numerical maximization of (11.3). The variance of an estimator of a parameterθis computed numerically from the asymptotic Fisher information:Var(θ)=-∂2lnL(θ)∂θ2-1.