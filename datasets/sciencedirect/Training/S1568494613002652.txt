@&#MAIN-TITLE@&#
An approach based on simulated annealing to optimize the performance of extraction of the flower region using mean-shift segmentation

@&#HIGHLIGHTS@&#
A novel performance optimization approach (i.e. SAMS) for flower extraction using mean-shift segmentation (MS) is proposed.Simulated annealing solution of quadratic assignment problem (QAP) model is treated as an image segmentation process.The performance of Backprojection-based MS (BackMS) is “improved” by using simulated annealing-based MS (SAMS).For benchmark and segmentation, the object extractor using SAMS (OE-SAMS) software is introduced.The conclusion is based on the performance metrics and statistical analysis (i.e., Wilcoxon signed rank median test).

@&#KEYPHRASES@&#
Simulated annealing,Flower extraction,Mean-shift segmentation,Quadratic assignment problem,Performance optimization,

@&#ABSTRACT@&#
Flower identification and recognition are tedious and difficult tasks even for humans. Image segmentation based on automatic flower extraction is an essential step for computer-aided flower image recognition and retrieval processes. Furthermore, there is a challenge for segmentation of the object(s) from natural complex background in color images. In this study, a novel performance optimization approach for image segmentation, i.e. simulated annealing-based mean-shift segmentation (SAMS), is proposed and implemented. It is based on the simulated annealing solution of quadratic assignment problem model treated as an image segmentation process using feature-based mean-shift (MS) clustering on color images. The proposed approach is designed to realize a global and unsupervised (i.e., fully automatic) segmentation. It is a modified and optimized version of Backprojection-based mean-shift segmentation (BackMS) method. In conducted segmentation experiments, the performance results of SAMS approach are compared with the ones of BackMS method. Comparison of overall performance results and statistical analysis (i.e., Wilcoxon signed rank median test) show that SAMS approach improves the performance of BackMS method. It is measured as 49.33% when using object bounding boxes and as 51.33% when using object pixel regions.

@&#INTRODUCTION@&#
Image segmentation is a general and challenging topic in computer vision research area. It is the most critical task for an image analysis by having the objective of extracting information from the image. The segmentation process is described as the partitioning that subdivides an image into its constituent parts. Therefore, it extracts those parts of interest as the objects. This process is very important, because it will affect all the subsequent processes of the image analysis [1]. Flower images in any given dataset display significant variations or diversities due to illumination, shadow effects, partial occlusions, multiple instances and differences on the viewpoint, scale and size [2]. The content-based flower image retrieval leads to some difficulties based on the abovementioned variations and natural complex backgrounds. In similar habitats, the background of flower images is mostly similar to each other. However, this is not always the case, segmentation or extraction of the flower region from complex background is a challenging task because of the sheer variety of flower classes (i.e., categories), the intra-class variability, the variation within a particular flower, and the variability of imaging conditions, e.g., lighting, pose, foreshortening, etc. [3]. Flower extraction is a kind of low-level process of image segmentation which is based on object boundary detection, and it affects the higher-level processes in image analysis. During the last few decades, researchers focused on optimization of existing segmentation methods. Consequently, researchers have created numerous new methods which are very accurate and have fast segmentation capabilities. In the literature, the problem of image segmentation is frequently treated as a combinatorial optimization problem (COP). Therefore, the performances of well-known segmentation methods were usually optimized by using the solutions of COPs based on any given heuristic method.There are some image datasets consisting of natural images in the literature, such as University of Berkeley's Berkeley Image Segmentation Datasets (BSDS300 and BSDS500) [4,5], Oxford-17 and Oxford-102 categories of the University of Oxford's flower image datasets [3,6,7], Computer Assisted Visual InterActive Recognition (CAVIAR) flower image dataset [7–9] and California Institute of Technology (Caltech) Computational Vision Group's Caltech-256 object category image dataset [10]. Some image datasets involve also the ground-truth (GT) images (i.e., masks) have been hand-segmented by an human expert. Image segmentation evaluation was classified in the literature as subjective and objective. The reader may refer to Karasulu and Balli's study [11] for a comprehensive review of image segmentation evaluation. In the literature, most of the evaluation methods are based on the computation of the scores between the GT mask and the segmented image result. There are some major categories of image segmentation techniques in the literature, such as clustering based on features, thresholding, edge-based segmentation and region-based segmentation (i.e., spatial segmentation) [11–13]. The issues of clustering based on features (especially MS clustering model) for the proposed segmentation method (i.e., SAMS) and optimization of its performance are the focus of the present study.The mean-shift filtering (MSF) is based on a smooth continuous non-parametric model. In MSF, the spatial coordinates of each pixel are adjusted along with its color values (i.e., joint domain of color and location), so that the pixel migrates more quickly towards other pixels with similar colors. Therefore, it can be later used for clustering and segmentation [14]. MS clustering models the feature vectors associated with each pixel of an image (e.g., color and coordinates) as samples from an unknown probability density function. The MS clustering uses the joint spatial (i.e., location) and range (i.e., color) domain [14,15]. MS analysis is a non-parametric, iterative procedure for seeking the mode of a density function presented by local samples. Since a complete density is being modeled, this approach is called non-parametric[14,16–18]. The MS segmentation based on MS clustering is proposed in [16,17]. Backprojection-based MS (BackMS) method is a variant of MS segmentation that is based on the histogram computation and pyramidal segmentation processes. For more detailed information, the reader may refer to Bradski and Kaehler's study [19].Quadratic assignment problem (QAP) is a well-known classical NP-hard problem in the field of operations research (OR), which is usually interpreted as a facility layout problem [20,21], and it is known as a COP. Also, the best solution cannot be easily computed exactly in polynomial time. Metaheuristics are the general framework for building heuristics, which are used in combinatorial and global optimization problems. The literature identifies QAP as the problem of finding a minimum cost allocation of facilities into locations, taking the costs into account as the sum of all possible distance-flow products [22]. Many solution techniques are used to solve QAP such as exact algorithms and metaheuristic algorithms. In the literature, the metaheuristic algorithm of SA is frequently used to solve QAP [23,24]. The reader may refer to the study of Bayat and Sedghi [25] for detailed information of solution techniques of QAP.The SA is a stochastic search technique which forms the basis of an optimization technique for combinatorial and other problems [26,27]. The fundamental idea of SA is to allow moves resulting in solution of worse quality than the current solution in order to escape from local optima. During the search process, the probability of doing such a move is however decreased [28]. In the literature, selection of SA parameters is called the cooling schedule, also called the annealing schedule [29].In the present study, a novel MS segmentation approach is proposed, which uses the feature-based MS clustering on color images. The proposed approach is called SA-based MS (SAMS) method. Its first application is on the color images, especially for flower (boundary) extraction. The MS's outcome is only controlled by the kernel size (i.e., bandwidth). Thence, MS requires less manual intervention compared to other clustering algorithms. However, too large or small bandwidth may lead to over- or under-segmentation problems, which affect the segmentation accuracy. Therefore, extraction of object of interest becomes very difficult and inconsistent. According to Zhou et al. [12], one can integrate different algorithms with MS in order to find an optimal solution to effectively handle segmentation problems. In this study, SA is integrated with MS in order to optimize the segmentation solution as well.In the proposed approach, the problem of image segmentation is treated as a QAP, and its metaheuristic solution (i.e., SA) obtains the optimal kernel size (i.e., the optimal spatial domain is concatenated with the range domain) for the segmentation process. The facility location problem that the proposed approach deal with here is to assign n equally-sized facilities to n homogeneous locations as to minimize the total cost. In our model, MS kernel (i.e., Parzen window) attributes are given as the (x,y) facility locations (i.e., the spatial domain for MS clustering) and the distance matrix (i.e., the distances based on the spatial coordinates are concatenated with the range domain in MS clustering) for the objective function of QAP. For the segmentation based on the MS clustering, the spatial domain covers the spatial coordinates of the image, and the range domain involves the color values of each pixel. The flow in this case can be interpreted as the adjusting the centroid of the rectangular kernel window on the image. The cost of flow-per-pixel distance is computed from one facility to another that are identified by MS kernel attributes (i.e., spatial and range bandwidths). The SAMS provides a higher segmentation accuracy than MS segmentation does. Besides, SAMS has a lower computational cost than Markov Random Field (MRF) cost function(s) optimized with graph cuts do. The SAMS takes the MSF and MS segmentation as the basis of its segmentation process. As the performance is assumed as the indicator of success of a given segmentation process, BackMS was considered as the regular MS segmentation method to be compared to SAMS in terms of performance. This kind of comparison between BackMS and SAMS shows that the proposed SA-based optimization approach improves the segmentation accuracy of the regular MS method.The main goal of the current study is developing a procedure to automatically segment out the flower region by using color features. In this scope, this study introduces a novel performance optimization approach for global, unsupervised and color-based segmentation process. The first main contribution of this study is the novel approach (i.e., SAMS) based on the SA solution of QAP model (QAPSA) to adjust some MS kernel attributes. This solution is also treated as an image segmentation process. Therefore, MS segmentation method's kernel size is modified automatically to its optimal size by using SAMS. The optimal kernel size leads to better segmentation accuracy. The second main contribution of this study is the improved performance evaluation methodology, which makes use of ten metrics for performance evaluation as opposed to other flower extraction studies available in the literature. In this way, the effects of all pixels in given images (i.e., labeled or unlabeled pixels) are used to evaluate the segmentation performance in terms of accuracy, similarity and error rate measurements.Rest of the paper is organized as follows. In Section 2, some studies in the literature on the issue of extraction of the flower region are reviewed, and their proposed approaches or methods are discussed. Section 3 provides the details of MS segmentation, classical SA method, QAP and QAPSA procedure. Section 4 is dedicated to description of the proposed approach as SA-based optimization for MS segmentation. In Section 4, the details of analyzed problem are also described, such as how the segmentation is treated as QAP, and its SA solution is implemented. In Section 5, the common performance measures (i.e., metrics) are described, and the approaches taken as the basis of performance evaluation are considered. Section 6 addresses the experimental results and statistical analysis, and includes discussion on performance results of BackMS and SAMS. Section 7 concludes the paper.

@&#CONCLUSIONS@&#
The first main contribution of this study is to develop a novel performance optimization approach based on the SA solution of QAP model that is treated as an image segmentation process using the feature-based MS segmentation. In this connection, its first application to color images is introduced and systemically tested. The proposed SAMS method provides a more robust structure in terms of the optimal kernel size and pixel classification (i.e., labelling) accuracy than the standard BackMS (i.e., the regular MS method chosen for this study). The presented qualitative and quantitative performance results of segmentation based on pixel regions and bounding boxes indicated the performance improvement by the SAMS approach compared to the standard BackMS. Flower image experiments were carried out with a subset of Oxford-17 flower image dataset, which consists of a variety of images with different color, shape and size flowers. In this regard, there is a variation in the set of features, which makes the segmentation more challenging. The clustering-based segmentation requires a trade-off between the computational performance and segmentation accuracy. In this study, a single kernel is used in the clustering stage. However, the flowers presented in the dataset possess a set of different colors, which complicates extraction of the flower due to the absence of the multiple property kernel(s) in the BackMS segmentation method. To overcome this segmentation problem, in some other studies a local scope is made use of (i.e., using a ROI), or a supervised (i.e., semi-automatic) segmentation process is utilized, during which the regions in the image are manually defined by the end-user. On the contrary to those studies, our proposed approach realizes a global and unsupervised segmentation.The second main contribution of the current study is the use of a performance evaluation scheme which makes use of ten different metrics for the objective evaluation of the segmentation performance. This evaluation scheme differs from other flower extraction studies in the literature, given that the effects of all (i.e., labeled or unlabeled) pixels are taken into account in performance evaluation. Performance is measured by using pixel classification accuracy, regional similarities and classification error rates. Along with the SAMS method, the 10-metric evaluation scheme is implemented in the OE-SAMS software and used for comparison of SAMS with BackMS performances in the aforementioned experiments on Oxford-17 images.From this point on the proposed SAMS approach will be improved by the implementation of the multiple kernel property for MS segmentation and the flower model based on flower's other features (e.g., shape, texture, etc). Therefore, the optimization procedure will be converted into a multi-start (i.e., parallel) form of the SA-based solution of the QAP model that will also cover the geometric flower model based on features.