@&#MAIN-TITLE@&#
An algorithm for CAD tolerancing integration: Generation of assembly configurations according to dimensional and geometrical tolerances

@&#HIGHLIGHTS@&#
Tolerance integration in CAD model.The realistic modeling of the parts and assemblies.Prediction of the tolerance impacts.Updating the mating constraints.

@&#KEYPHRASES@&#
CAD model,Geometrical tolerance,Dimensional tolerance,Realistic assembly,Model configurations,Mating constraints,

@&#ABSTRACT@&#
For several years, Digital Mock-Up (DMU) has been improved by the integration of many tools as Finite Element (FE) Analysis, Computer Aided Manufacturing (CAM), and Computer Aided Tolerancing (CAT) in the Computer Aided Design (CAD) model. In the geometrical model, the tolerances, which specify the requirements for the proper functioning of mechanical systems, are formally represented. The nominal modeling of the parts and assemblies does not allow the prediction of the tolerance impacts on the simulation results as the optimization of mechanical system assemblability. So, improving the CAD model to be closer to the realistic model is a necessity to verify and validate the mechanical system assemblability. This paper proposes a new approach to integrate the tolerances in CAD model by the determination of the configurations with defects of a CAD part, used in a mechanical system. The realistic parts are computed according to the dimensional and geometrical tolerances. This approach provides an assembly result closer to the real assembly of the mechanical system. The Replacement of the nominal parts by the realistic ones requires the redefinition of the initially defined assembly mating constraints. The update of the mating constraints is performed by respecting an Objective Function of the Assembly (OFA). Integrating tolerances in CAD allows the visualization and simulation of the mechanical assemblies’ behavior in their real configuration and the detection of possible interference and collision effects between parts which are undetectable in the nominal state.

@&#INTRODUCTION@&#
In CAD model, the tolerances are represented as annotations. In fact, the numerical model is used in the nominal configuration. The values of the dimensional and geometrical tolerances do not have any impact on CAD model or the results of the numerical simulations. Research works assert that the tolerance stack-up has an impact on the F.E. results  [1] and the assembly process  [2] as the case of the sheet metal assembly  [3]. Thus, a realistic modeling of the assembly, which considers the geometrical and dimensional tolerances on CAD model, is an industrial need. In this paper, a method to model realistic assembly (variational assembly) is presented. This new method allows tolerance analysis with consideration of the assembly process planning, the contact types and the assembly motion.In our previous work, a method taking into account the tolerances on CAD model was established  [4]. This model is based on the assumption of obtaining the worst case assemblies by using components in the worst case configurations. The worst case configurations of components are computed using the worst case tolerancing. The randomness of obtaining mechanical parts and the assembly complexity cast doubt on this assumption. Thus, in this work, the assumption of obtaining worst case assemblies by random components is adopted. New algorithms to compute the possible configurations of components and redefine the assembly mating constraints are established.In this paper, the components with dimensional and geometrical tolerances are modeled in CAD model by using two algorithms to respect the principle of independence (ISO 8015): the first one leads to obtain a component with dimensional defects. This algorithm is founded on a numerical perturbation method to determine the relationships between dimensions. The tolerance interval is discretized to define the realistic configuration of components. The second algorithm allows the determination of components with geometrical tolerances. The tolerance zone is discretized according to the parameters specified by the Small Displacement Torsors (SDT)  [5]. The face displacements are performed to obtain components with geometrical defects.In nominal assembly, the ideal components are linked by mating constraints. The replacement of those components by the realistic ones requires the updating of mating constraints. A tolerance analysis is performed by using the proposed method and showed through the crankshaft system.This paper is organized as follows. First, a review of literature is presented. Then, the realistic component modeling approach is proposed: The algorithms used to model the components with dimensional defects, as well as components with geometrical defects are detailed. Thereafter, the redefinition of the mating constraints is introduced with an illustration and validation example (rod — crankshaft mechanical system) followed by the tolerance analysis that enables to verify and validate the mechanical system assemblability. The chosen assembly method is a sequential assembly  [6]. The conclusions and perspectives for this work are presented at the end.This paper can be positioned under the research works belonging to two themes: (1) Tolerance analysis and synthesis; (2) Generation of the realistic configurations and the redefinition of the assembly mating constraints.Several researches are contributed to developing methodologies of tolerance analysis and synthesis for a good choice of specifications. The tolerance analysis and synthesis require relating geometric deviations to variations in functional conditions. Thus, several mathematical and structural models were established as the vectorial  [7], the Topologically and Technologically Related Surfaces (TTRS)  [8], the torsorial [5], kinematic  [9] and parametric [10] models. Some of those models of defect representations are highlighted.Wirtz defined the Vectorial Dimensioning and Tolerancing (VD&T) model [7]. Each vector is associated to geometry with two variables: one for the nominal state and one for the deviation from this state. Thus, it is possible to represent the difference between the ideal and real geometry. This model does not take into account the functional aspect of surfaces and is oriented to manufacturing and control. Ballot and Bourdet established a torsorial model  [5]. The deviation and the linkage torsors are defined by using the SDT tool. The first torsor represents the geometry variations and the second one models the small displacements allowed by linkages. Clement et al. developed a structural model, which is founded on TTRS, to describe the geometry (Clement et al.  [8]). In this model, the part is considered as the association of TTRS. The TTRS is a surface pair, a surface and a TTRS or a TTRS pair belonging to the same solid and is associated for functional reasons.After the mathematical modeling of the geometrical and dimensional defects, the tolerance analysis or/and synthesis is performed by using a worst case or a statistical approach. Socoliuc et al. established an approach to realize a realistic simulation of assemblies  [11]. This approach is based on TTRS model  [8]. Indeed, a complex mechanical system is represented by a simple parametric model. Then, a worst case tolerancing allows modeling of the deviation domains by the polyhedral tool (polytope)  [12]. The use of the Minkowski sum of polytopes  [13] allows the determination of the tolerance effects on functional requirements of the assembly. Pierre et al. developed a method to take into account both the thermo-mechanical effects and the geometrical defects of assembly by using the three dimensional chain tools [14]. The model is based on the substitute surfaces approach. The authors present a solution, in torsorial form, for the problems of coupling between the thermal requests and the geometrical defects. A worst case tolerancing and the Minkowski sum tool leads to model the tolerated limits of the geometric defects of a part by deviation hulls  [15] and the accepted limits of relative displacement between two surfaces in contact by clearance hulls [15]. Mansuy et al. proposed a new calculation method rather than using the Minkowski sum. The relationship between the functional tolerance and the tolerances associated with surfaces of mechanical components are determined in linear form. Thus, an influence coefficient is defined  [16].In a bottom-up assembly modeling, the components are brought together to define a product representation. In CAD software, the components are located and oriented as required by designer. Indeed, the relative positions of the components are defined by the mating constraints  [17]. These mates must model joints between parts and satisfy functional requirements for proper functioning of the system. The component positioning can be done sequentially or simultaneously. Sodhi and Turner confirm that the technique of mounting components simultaneously is insufficient in some cases  [6]. Indeed, the solution, found by using this technique, can be not optimal as the assembly of the four bars of a picture frame. In CAD software, primitive or high-level relations are used for specifying assembly information. Then, the aggregation of assembly information in assembly models can be made by relational or hierarchical models.Several methods to analyze and to solve assembly constraint problems had been developed. Kim et al. defined a relationship between the joint alignments, which are defined by the mating constraints, and the assembly Degrees of Freedom (DoFs)  [18,19]. In an assembly model, the mating joints are described by the 4×4 transformation matrix. Using this matrix, Tanaka et al. proposed an algebraic method to solve and reduce three-dimensional geometric constraints  [20]. In DMU, the allocation of the current mating constraints leads to three types of assembly: under-constrained, fully constrained and over-constrained assemblies  [20,21]. The first, under-constrained assembly is a system that has at least one DoF. The second type of assembly does not have any relative movement between components. The last type of assembly is obtained when the mating constraints are conflicting and can be not satisfied. Indeed, the geometric modeler cannot find a solution for positioning components with required mating constraints. The above methods of assembly modeling solve three dimensional geometric constraints, which model the relationships between assembly parts, basing on the hypothesis of ideal-rigid parts  [6,17–21].A significant amount of research, based on the non-ideal geometry, has been devoted to the development of analysis and synthesis models that take into account, in addition to the manufacturing deviations and gaps, the assembly process planning and the relationships between assembly parts. The Tolerancing in Localization with Influence of the Contacts (CLIC) method allows choosing the adequate dimensional and geometrical specifications for a mechanism  [22]. CLIC is Computer aided tolerancing (CAT) software based on three-dimensional computation. In addition, static and three-dimensional tolerancing models are developed to optimize tolerance values of functional requirements  [23,24]. To determine the assembly specifications, CLIC model takes into account the assembly process planning specified by the designer. Dantan et al. developed a method for conceptual tolerance synthesis  [25]. The variational geometry due to the manufacturing deviations and the gaps are modeled by SDT. The assembly structure is modeled by a graph of elementary contacts. During the assembly process, the contact evolution is determined by the identification of the contact type (floating, slipping or fixed contact) in each assembly sequence. This tolerance synthesis model takes into account the geometrical behavior of the assembly and the quantifier notion (existential quantifier “∃” or universal quantifier “∀”)  [26]. The quantifier notion allows the determination of the relation between n-hulls (compatibility, interface and specification hulls). Those hulls model the geometrical behavior of the mechanism. The authors defined rules to determine the modifier (Maximum Material Condition and Least Material Condition) according to the quantifier notion and the contact type. The model is used to determine the necessary semantics of the geometrical specification model formalized by gauge with internal mobilities  [27]. The mobilities between different parts of the gauge are considered the function of the other parts of the mechanical system. Franciosa et al. developed a tolerance analysis model  [28]. To simulate variational features of rigid-part assemblies, the authors used the Statistical Variational Analysis for tolerancing (SVA-TOL). A matrix variational model, which is based on TTRS approach, is defined to determine the variational features. Thus, the assembly is modeled by a set of parameterized variational features. The model considers two cases of assembly mating constraints: against (between two planar surfaces) and fit (between two cylindrical surfaces) alignments. The method to determine the assembly constraint solution depends on the assembly type: in the case of fully constrained assembly, a sequential constraint solver is used and a least squares method is employed in the case of over constrained assembly.This literature review relates to two aspects. The first aspect consists on tolerance analysis and synthesis  [5,7–12,14–16]. The second aspect consists on the variational geometry and the redefinition of the assembly mating constraints  [22,25–28].In most of the references cited, the tolerance analysis and syntheses are based on the polyhedral or mathematical model. The solutions for the tolerance analysis and syntheses, which are presented in mathematical form (equations), are modeled in a geometrical solution. The polyhedral is a difficult tool to be used in the industry. This model does not predict the impact of dimensional and geometrical deviation, permitted by tolerances, on the assembly deformations. The proposed model in this paper is considered as a tool for visualization and tolerance impact analysis (interference detection) in the assembly simulation case. The second aspect addressed in the literature appears to be closest to this work [22,25–28]. Indeed, we can learn a great deal from the methods used in this second aspect, and apply them to solve some issues of the problem as contemplated: Using the OFA to update the mating constraints, the choice of the assembly (sequential assembly), using the parametric variational features to generate the assembly component configurations.The approach presented in this paper is an extension of those works. The realistic modeling of the components allows taking into account the tolerances in CAD model. The redefinition of the mating constraints leads to consider the relationships between realistic components and the assembly process planning. The realistic modeling of the assembly in CAD environment allows a direct use of the computation applications which already exist in CAD software as the assembly motion simulation.In the CAD model, obtaining realistic configurations allowed by dimensional tolerances requires modifications of the component dimensions. CAD software defines two dimension types. The driving dimensions are used to build the CAD model. The driven dimensions are controlled by driving ones. In fact, the driven dimensions values are deduced from driving dimension ones.The toleranced dimension can correspond to a driving dimension (Fig. 1(a)): the driven dimension is controlled by one driving dimension. Therefore, the modification of the driving dimension value (40 mm) allows changing directly the value of the corresponding driven dimension. In the other case (Fig. 1(b)), obtaining a target value of the driven dimension requires the determination and the modification of the corresponding values of each driving dimensions (25, 35 and 100 mm).In the general case, the designer defines the component model by using driving dimensions. In the following step, he assigns the tolerances on the driven dimensions. The determination of the components with dimensional defects requires the identification of the relationships between the driving and driven dimensions. Indeed, thendriving dimensionsDi, withVDivalues, that control the driven dimensionRj(withVRjvalue) should be determined. The influence coefficientλijis the ratio between the variation of the driving dimensionδVDiand the variation of the driven dimensionδVRDj(Eq. (1)). This coefficient can be determined by using a numerical perturbation method.(1)λij=δVDi/δVRj.A sub-algorithm to detect the driving dimensionsDi, which control the driven dimensionRj, is developed (Fig. 2). The method is based on the identification of the impact of the numerical change ofVDion the CAD model. From numerical viewpoint, this change can be defined as a percentage(δVDi=0.1%⋅VDi). Initially, a perturbation value is added to each driving dimension valueVDi. Then, new driving dimension valuesV′Di(V′Di=VDi+δVDi)are obtained. For each change ofVDi, if the value of driven dimensionVRjchanges to a new valueVRj′, then the two dimensions are related.δVRDiis the deviation betweenVRj′andVRj(δVRDi=VRj′−VRj).λijis determined by using the equation (Eq. (1)).The tolerance intervalTIspecified on driven dimensionRDjis discretized by an incremente; such ase=TI/h.his the discretization accuracy to be chosen by user. For eachkth deviation valuetkjof the driven dimensionRDj, the deviation valueTkiofDiis deduced by the relation (Eq. (2)). Thus, the new values ofDiare determined according to the sign ofλij(Eq. (3)). The model is rebuilt with those new values of driving dimension to obtain components with dimensional defects.(2)Tki=|λij|tkj/n(3)Ifλij>0,thenDki=Di+Tki.Else Ifλij<0thenDki=Di−Tki.An algorithm to determine all components with geometrical defects is developed. Those realistic configurations are obtained by modeling the geometrical tolerances by the displacements of the corresponding faces. The approach depends on the shape of the tolerance zone, the toleranced feature type and the tolerance type. The overview table (Table 1) comprise the sub-algorithms used to model component with geometrical defects.The deviation between the nominal and the realistic feature is determined by the SDT tool. Then, the assumption of neglecting the form defects relative to the position and orientation defects is used. The deviation torsor, which is based on SDT tool, defines the DoFs of toleranced feature. In the proposed model, the deviation parameters between the nominal and realistic features are determined by analogy to the parameters defined by the SDT. In the proposed methodology, the original shape of the feature is conserved as the planar faces remain planar. The algorithm starts by identifying toleranced features, tolerances types and datum reference, which are specified by ISO standards.a. Case of the positional toleranceIn the case of a positional tolerance[−Tl/2;Tl/2]assigned to a planar facePof a component, the tolerance zoneTzis a parallelepiped (Fig. 3(a)). The deviation torsorEppofPis defined on the pointO(the center ofP) by the relation (Eq. (4)).(4){Epp}O={α0β00tz}(O,X,Y,Z).The sub-algorithm in Fig. 3(b) comprises the main steps to obtain all Possible Component Configurations according to Positional Tolerance allocated to Planar face (PCCPTP). First, three lateral edges (E1,E2andE3) ofTzare discretized by an incrementi(Fig. 3(c)). The integeriis defined by the designer according to the desired precision of the results. The subdivisionshare obtained such ash=Tl/i(Fig. 3(c)). The nominal facePis defined by three pointsN1,N2andN3. Therefore, a target position of the realistic facePuvwis defined by three new points (N1u,N2vandN3w; withu,vandwrange from 1 toi) (Fig. 3(d)).The geometric deviation between the two faces (nominal facePand target facePuvw) is defined by three parameters: two anglesαvw(αvw=(N2N3⃗∧N2vN3w⃗))andβvu(βvu=(N2N1⃗∧N2vN1u⃗))and a distancedv(dv=N2N2v)(Fig. 3(d)). Thus, the obtaining of realistic parts requires the face displacements to the target positions. Those displacements are performed by two rotations and one translation:•A rotation aboutL1(L1=[N1N2])by an angleαvw.A rotation aboutL2(L2=[N2N3])by an angleβvu.A translation by a distancedvalong the normal vector ofP.b. Case of orientation toleranceIn the case of an orientation toleranceTo(as the perpendicularity tolerance in Fig. 4(a)) assigned to a planar facePof a component, the allowed deviations are defined by the SDT{Epo}(Eq. (5)).αxandβyare the rotation parameters about the axesXandYrespectively.(5){Epo}G={αx0βy000}(G,X,Y,Z).The pointGis the center ofP(Fig. 4(a)). The tolerance zoneTzois a parallelepiped. A sub-algorithm to obtain Possible Component Configurations according to Orientation Tolerance allocated to Planar face (PCCOTP) was developed (Fig. 4(c)). Initially, two lateral edgesE1andE2of the parallelepipedTzoare subdivided by the incrementi(h=To/i).iis an integer to be defined by the designer. Thereafter, for each vertex pairS1uandS2v(u,v=1toh) onE1andE2respectively, a vertexS3uonE3is deduced.S3uis obtained by the intersection of the line(OS1u)andE3(Ois the middle point of the edge[S1uS3u]). Thus, the target facePuvis defined by the three verticesS1u,S2vandS3u. The deviation between the two facesPandPuvcan be parameterized by two parametersαxandβy(Fig. 4(b)). Thus, the configuration with defects of the component is obtained by the displacement ofPtoPuv. Indeed, two rotations are required to obtain the variational geometry:•A rotation by an angleαxaboutXaxis.A rotation by an angleβyaboutYaxis.c. Case of positional and orientation tolerancesThe conformity domain of a planar faceP, which is subjected to a positional toleranceTpand a parallelism toleranceTo, is located between two parallel planes spaced by a distanceTpwhile remaining enveloped by two planes spaced from a distanceTo(Fig. 5(a)). A sub-algorithm to determine all the Possible Component Configurations according to Positional and Orientation Tolerances allocated to Planar face (PCCPOTP) was developed (Fig. 5(b)). The main steps of this algorithm are as the following:Initially, the positional toleranceTpdefines a tolerance zoneTzp. Then,Tzpis discretized by the method described previously in the case of positional tolerance assigned to a planar face. However, the incrementiis determined relatively to orientation tolerance zoneTzo:h=Tzo/i;his an integer to be defined by the designer. Therefore, three vertex sets are obtained (N1u,N2vandN3w; withu,vandwrange from 1 toi).In the second step, for each vertexN2vtwo vertex setsN1uvandN3wvare deduced:N1uvare the verticesN1u; such as the angleβvu∈[−To/a;To/a](βvu=(N2N1⃗∧N2vN1u⃗)).N3wvare the verticesN3w; such as the angleαvw∈[−To/b;To/b](αvw=(N2N3⃗∧N2vN3w⃗))(Fig. 5(c)).Finally, the face displacement from the nominal position to the realistic position is performed by three operations:•A translation along theZaxis by a distancedv(dv=N2N2v).A rotation about theXaxis by an angleαvw.A rotation about theYaxis by an angleβvu.a. Case of positional toleranceIn the case of a face axisI1I2, which is allocated to a positional toleranceTp, the tolerance zoneTzis cylindrical (Fig. 6(a)). A local coordinate system(O,X,Y,Z)is defined (theZaxis is along the axisI1I2). The deviation torsor{Ecp}, defined in the middle pointOof the nominal axis, allows four DoFs: Two rotationsrxandryabout the axesXandYrespectively and two translationstxandtyrespectively alongXandYaxes respectively (Eq. (6)).(6){Ecp}O={rxtxryty00}(O,,X,Y,Z).A sub-algorithm to obtain Possible Component Configurations according to Positional Tolerance allocated to Cylinder Axis (PCCPTCA) is developed and illustrated in Fig. 6(b). A discretization ofTzis performed to obtain all possible configurations of the axis Fig. 6(c).The facesF1andF2are planar faces with circular loop (C01andC02are the two circular loops ofF1andF2respectively in Fig. 6(b)). Thus,F1andF2are discretized by the two parametersψandδ.•The angleψ=2uπ/N(u=1toN)  [12,15] (N=6in the case of Fig. 6(c)). The choice of the integerNdepends on the discretization accuracy intended by the designer.δis the radial finesse factor of the discretization.δ=(Tp/2)/j(j=3in the case of Fig. 6(b)).In the local coordinate system(O,X,Y,Z), the coordinates of the two point setsAg,n1andAk,m2are:•Ag,n1((Tp/2)−gδ)cos(2nπ/N),((Tp/2)−gδ)sin(2nπ/N),L/2Ak,m2((Tp/2)−kδ)cos(2mπ/N),((Tp/2)−kδ)sin(2mπ/N),−L/2.By analogy with the DoFs defined by{Ecp}, the deviation setting between the two axis (I1I2andAg,n1Ak,m2) is defined by four parameters (αx,βy,dxanddy) (Fig. 6(d)). In fact, the displacements of the toleranced axis from the nominal position to the realistic position are performed by two rotations by anglesαxandβyabout the axesXandYrespectively and two translations along the distancesdxanddyalong the axesXandYrespectively. The figure (Fig. 6(d)) shows an example of the displacement parameters of nominal axisI1I2to realistic configurationA2,21A0,32.b. Case of orientation toleranceIn the case of a face axisI1I2, that is subjected to an orientation toleranceTo, the tolerance zoneTzis cylindrical (Fig. 7(a)). The deviation torsor{Eco}, defined in the middle point of the axisI1I2, allows two DoFs: Two rotationsrxandryabout the axesXandYrespectively (Eq. (7)).(7){Eco}O={rx0ry000}(O,X,Y,Z).A sub-algorithm to obtain Possible Component Configurations according to Orientation Tolerance allocated to Cylinder Axis (PCCOTCA) is developed (Fig. 7(b)). First, one of the two planar faces (F1orF2) ofTzis discretized by using the method described previously in the case of a positional tolerance. In fact, a setΩ1of verticesAg,n1(Ag,n1∈F1)is obtained (Fig. 7(c)). Then, for each vertexAg,n1a corresponding vertexAg,n2is deduced by the relation (Eq. (8)). Therefore, a setΩ2of verticesAg,n2is deduced. Finally, the realistic axesAg,n1Ag,n2are obtained by the displacements of the nominal axis: Two rotations by the anglesαxandβyabout the axesXandYrespectively (Fig. 7(c)).(8){Ag,n2}=F2∩(OAg,n1).c. Case of orientation and positional tolerancesGenerally, a face axisI1I2is subjected to an orientation toleranceTo(To=0.2mm)and a positional toleranceTp(Tp=0.5mm)(Fig. 8(a)). The sub-algorithm to obtain Possible Component Configurations according to Positional and Orientation Tolerances allocated to Cylinder Axis (PCCPOTCA) is developed (Fig. 8(c)). The tolerancesTpandTodefine the cylindrical tolerance zonesTzpandTzorespectively. The possible axes, allowed byTp, are obtained by using the sub-algorithm PCCPTCA (Fig. 6(b)) (the designations used in Fig. 6 are conserved):•The discretization of the two planar faces ofTzpby using the two incrementsψandδallows obtaining the positions of the axis endsAg,n1andAk,m2. Thus, the possible axesAg,n1Ak,m2are defined.The deviation setting between the two axis (I1I2andAg,n1Ak,m2) is defined by four parameters (αx,βy,dxanddy).His the midpoint of the edge[Ag,n1Ak,m2]. The axisEFofTzois perpendicular to the datumAand passes throughH. Thus, the tolerance zoneTzois defined.If the axisAg,n1Ak,m2verifies the relation (Eq. (9)), then the configuration is conserved as a solution. The realistic axis is obtained by the cylindrical face displacements (according to the parameters (αx,βy,dxanddy)).(9)‖Ag,n1E⃗‖≤Tz02.As mentioned before, in this paper, the sequential assembly technique is used. The rebuilding of the assembly with the realistic components may lead to an over-constrained assembly. Thus, the mating constraints, used in the nominal assembly, must be modified to allow the linkage of the realistic components. In the CAD system there are many primitive mating to link the assembly components: collinearity, perpendicularity, tangency, symmetry, coincidency and parallelity. In the context of this article three primitive mating constraints are considered: coincident between two planar faces, coaxiality between two axes and distance between two planar faces:•Coincident constraint between two planar faces (Co:F&F): In this case, the two unit normal vectors of the planar faces are anti-aligned (the angle between the two directions isΠ) or aligned (the angle between the two directions is zero). The two planar faces are located in the same plane and are in or without contact.Coaxiality constraint between two cylinder axes (Co:A&A): In this case, the two axes are aligned or anti-aligned and a point from the first axis belongs the second one.Distance constraint between two planar faces (Dist:F&F): In this case, an alignment between the pair faces is performed.In the realistic assembly, those mating constraints must be redefined. Those realistic mating constraints are obtained by modifications of the relations between MGREs (Minimum Geometrical Reference Elements)  [8]. The method depends on the Objective Function of the Assembly (OFA) specified by the designer. In the CAD software, the OFA is automatically deduced from the nominal model:•The mating constraint order, specified in the feature manager design tree of the software, defines the mounting order of the assembly and the joint order priority. Thus, the planning of the assembly process is identified.The kinematic state of the nominal assembly defines the DoFs which are to be conserved in the realistic model. The DoFs are identified by a method based on the graphs of primitive kinematic joints: Each assembly or sub-assembly is defined with a graph. In this graph, a node represents a part and an edge represents a primitive joint.The contact between the features is conserved.The joint type between each couple of components is respected.The coincident constraint, which was defined between two planar faces in nominal configuration, is replaced in the realistic model by a coincident constraint between: two planar faces (Co:F&F), face and edge (Co:F&E) or face and vertex (Co:F&V). In the nominal configuration, two planar facesf1(with normal vectorN1) andf2(with normal vectorN2) of the partsA1andA2respectively linked by a coincident constraint. In the realistic model, the redefinition of this constraint depends on the initial contact (with or without contact) between the facesf1andf2:The configurations with defects of the partsA1andA2are obtained by the face displacements. Thus, in realistic configuration, before the application of mating constraint betweenf1andf2, a developed sub-algorithm to Verify Relative Position of Two Faces initially in Contact (VRPTFC) is used to ensure that the relative position off1andf2is adequate (Fig. 9(a)).Ii(i=1toa) andJj(j=1tob) are the vertices delimitingf1andf2respectively (the numbersaandbdepend on the loop type of the face. For example, in the case of a quadratic loop off1,a=4) andQis the plane derived fromf2.In the realistic configuration, both faces can have three main configurations (Fig. 9(b)):•In the first case, the following condition is satisfied:N1⃗.N2⃗≤0andIiJj⃗.N1⃗>0fori,j=1to 4 (an anti-alignment relation). The two faces are in the correct configuration and the both faces do not intersect.In the second case, the condition(N1⃗.N2⃗>0)is satisfied (an alignment relation). The partA1is rotated about the(O,T⃗)axis by an angle equal toΠ.Ois the center off1andT⃗is the tangential axis tof1. After the part rotation, the configuration off1andf2becomes similar to the configuration in the first case.In the third case, the condition (N1⃗.N2⃗≤0and fori,j=1to 4 and there exists a pair(u,w)such thatIuJw⃗.N1⃗<0) is satisfied. A coincident constraint betweenf1and the vertexJvis applied temporarily (applied to move the face then deleted from the model). The vertexJvis determined by the relation (Eq. (10)). Then, the model becomes one of the two previous configurations (case1 or case2).(10){dkm=‖IkJm⃗⋅N1⃗‖;such asIkJm⃗⋅N1⃗<0.dv=‖IkJv⃗⋅N1⃗‖;such asdv=max(dkm);k,m=1to4.Case of Co:F&V: To apply a coincident constraint betweenf1and a vertexSaoff2, a vertexSais to be identified. Initially,f2is discretized. The discretization method depends on the type of the face loop. In the case of quadratic loop the discretization is performed by two parametersmandn(Fig. 10(a)). The face with circular contour is discretized by two polar parametersrandθ. For the face with complex loop, the discretization is performed by a fine tessellation. These discretization parameters are chosen by the designer according to the desired accuracy of the results. The explanation will be limited to the case of face with quadratic loop.f1is modeled by a grid ofImnvertices. Then, allImnvertices are projected on the planeQaccording to the normal vectorN1to obtain the set ofJmnvertices. Finally, the distancedminis the minimum distance between the pairs(Imn,Jmn)and the vertexSais identified by the relation (Eq. (11)).(11){dmin=min‖JnmInm⃗‖;such asJnm∈f2Sa=Jnm;such as‖JnmInm⃗‖=dmin.Case of Co:F&E: To determine the edgeEit suffices to identify the two verticesV1andV2(E=[V1V2]). The faceF2is discretized by using the method described previously. The first vertexV1is determined by the relation (Eq. (11)). The second vertexV2is identified by the equation (Eq. (12)).(12){dmin′=min‖JnmPnm⃗‖;such asJnm∈f2andJnm≠SaV2=Jnm;such as‖JnmPnm⃗‖=dmin′.In the nominal assembly, a coincident constraint between two facesf1andf2is applied such as the two faces are not in contact. In the realistic assembly, the relative position off1andf2is verified by using a sub-algorithm to Verify Relative Position of Two Faces initially Without Contact (VRPTFWC) (Fig. 10(c)). In fact, in nominal configuration, both faces can have two main initial configurations NCase1 and NCase2 (Eq. (13)). The relative position of the two faces in the nominal configuration must be respected in the realistic one.(13){IfN1⃗⋅N2⃗=1,then NCase1IfN1⃗⋅N2⃗=−1,then NCase2 .In the realistic configuration, the two faces can be in one of the three cases described in Fig. 9(b). In the case NCase2 the method is similar to the one defined previously: the sub-algorithm VRTFC is used. In the case NCase1, the case2 becomes the optimal case (Fig. 10(c)). Then, the sub-algorithm VRTFC is used after replacing the condition and the statement of the case1 by the condition and the statement of the case2.The mate type is determined by the sub-algorithm to identify mate type between two planar faces initially on coincidence relationship (Fig. 10(b)). Thus, the mates Co:F&V, Co:F&Eand Co:F&Fare to be applied in realistic model.Case of Co:F&V: The method is similar to the previous one (Section  3.1   Case of Co:F&V); only the relation (Eq. (11)) is replaced by the relation (Eq. (14)). In fact,Sacan be outside the faceF2.(14){dmin=min‖JnmInm⃗‖Sa=Jnm;such as‖JnmInm⃗‖=dmin.Case of Co:F&E: The method is similar to the previous one (Section  3.1   Case of Co:F&E). The first vertexV1is determined by the relation (Eq. (14)). The second vertexV2is identified by the equation (Eq. (15)).(15){dmin′=min‖JnmInm⃗‖;such asJnm≠SaV2=Jnm;such as‖JnmInm⃗‖=dmin′.In the nominal assembly, a distance mate between two facesf1andf2of two partsA1andA2is applied. In the realistic assembly, the relative position off1andf2is verified by using a sub-algorithm VRPTFC (Fig. 9(a)). The distance condition, which is defined in nominal configuration between two planar faces (Dist:F&F), will be conserved or replaced by a distance mate between a planar face and an edge (Dist:F&E) or by a distance mate between a planar face and a vertex (Dist:F&V) according to the OFA (Fig. 10(b)). The constraint definition of (Dist:F&E) and (Dist:F&V) is performed by using the method used to define the mates (Co:F&E) and (Co:F&V) in the case of the coincidence constraints between planar faces initially in contact (Section  4.1.1).In the case of the cylindrical joint, the coincident constraint between two axes (coaxiality) (Co:A&A) is conserved in the realistic configuration. In the case of revolute or attachment joint, the constraint (Co:A&A), which is defined in the nominal configuration, can be conserved or modeled by a coincident relation between an axis and a vertex (Co:A&V) in the realistic configuration.The method to redefine the mating constraints in the case of a revolute joint is shown through the case of revolute joint between the two partsAandB(Fig. 11(a) and (b)). This joint is defined by:•A coaxiality condition between two axesL1(Co:A1&A2).A coincident constraint between two planar facesL2(Co:Fa2&Fb2).After the application of the constraintL′1, the vertexVuvand the planeQuvare determined by using the method in Fig. 12:•A rotational angleΨeabout the axisA(A=A′1=A′2; the rotation axis) is defined:Ψe=2eπ/N(e=1toH). The choice of the integerHdepends on the result accuracy intended by the designer and on the complexity of the face loop.The faceFa2′is modeled by a grid of verticesPijby the two parametersmandn(method detailed previously). After each rotation of the partA′by an angleΨeabout theAaxis,Pijare projected on the axisAto obtain theKijevertices (Fig. 12). The vertexOis the intersection between the axisAand the faceFa2′.N⃗is the driving vector of theAaxis. For eachΨerotation, the distanceDpqeis determined by the relation (Eq. (16)). Then, the vertexPuvcorresponds to the distanceDuvw.(16){Dpqe=max(Dije);Dije=OKij⋅Sign(OKij⃗⋅N⃗)Puvsuch asDuvw=max(Dmne);(e=1toHandw∈[1,H]).In the case of an attachment relation, the parts are linked by two coaxiality constraints and a coincident constraint between two planar faces. For example, the three partsA(Fig. 11(a)),B(Fig. 11(b)) andC(Fig. 13(a)) are joined by an attachment relation performed by three constraints:•L1(Co:A1&A2),L2(Co:A1&A3),L3(Co:F5.3&F6.3).L′1(Co:A1&VBe),L′2(Co:A1&VCf),L′3(Co:Qst&Vst).The realistic axesA2′andA3′are discretized by an incrementhto obtain two vertex setsVBeandVCf(e,f=0toh).The faceFa2′is modeled by a set of verticesPij(i=1tom;j=1ton;mandnare the two parameters of the face discretization).After the application ofL′1andL′2, the planeQstand the vertexVst(s∈[1;m]andt∈[1;n]) are determined using the method shown in Fig. 12. Then, the constraintL′3is applied. The assembly configurations that present interferences are eliminated.In order to illustrate the proposed method, a rod and crankshaft assembly (Fig. 14) is selected as a validation. The assembly is realized through the mating constraintsLi(i=1to 15) (Table 2). Those constraints simulate the assembly process sequences (seven sequences) and the kinematic state of the system. The realistic assembly rebuilding is based on three steps:•The rebuilding of the realistic configurations of the assembly components (the variational geometries). The realistic configuration of each component is obtained according to the dimensional and geometrical tolerances allocated to them (Fig. 11). This step is realized by using the algorithms presented previously (Sections  3 and 4);The redefinition of the assembly mating constraints since the use of the constraintsLidefined on the nominal assembly leads to obtain an over-constrained assembly;The rebuilding of the realistic assembly to respect the OFA defined in nominal configuration.Sequence 1:In the sequence 1 of the assembly process, the parts 0 and 1 (Fig. 14) are linked by a fixed joint. The nominal sub-assembly SA1: {0,1} is defined by three constraints:•L1(Co:F0.1&F1.1);L2(Co:F0.2&F1.2);L3(Dist:F0.3&F1.3).In the realistic assembly, before applying each constraint, the relative position ofF0.iandF1.iis verified by using a sub-algorithm VRPTFC (Fig. 9(a)). The realistic configurations of the parts 0′ and 1′ are obtained according to the dimensional and geometrical tolerances allocated to the two parts 1 and 2 respectively (the face displacements are multiplied by a scale factor for better illustration in Fig. 15(a)): The facesF′0.1,F′1.2,F′1.5andF′1.4are the realistic configurations ofF0.1,F1.2,F1.5andF1.4respectively. When the assembly is rebuilt with those realistic components, the model becomes over-constrained. So, the constraintsLi(i=4to 15) are deactivated temporarily and the sub-assembly SA1: {0,1} must be resolved based on the OFA. The OFA of the sub-assemblySA1is:•fixed joint;No DoF;(F0.1,F1.1)and(F0.2,F1.2)are in contact.Sequence 2:The fixed joint to link the parts 1 and 2 (Sequence 2 — Table 2) is defined, in the nominal configuration, through three constraintsLi+3(Dist:F1.i&F2.i;i=1to 3). So, the sub-assemblySA2is obtained. The update of those constraints is performed by the method described previously (Section  4.1.3). According to the OFA, the constraintL4is conserved.L5andL6becomeL′5(Dist:F′1.2&E2) andL′6(Dist:F1.3&V3) respectively. The edgeE2and the vertexV3are determined by the method described in Section  4.1.1.Sequence 3:In the nominal configuration, a revolute joint links the two parts 1 and 3 (Fig. 14) in the assembly sequence 3 (Table 2). Thus, the sub-assemblySA3={0,1,2,3}is obtained. This joint is defined by:•L7(Co:A3.1&A1.1),L8(Co:F3.3&F1.5).Sequence 4:Also, in sequence 4, the revolute joint between the parts 3 and 4, defined byL9(Co:A3.2&A4.1) andL10(Co:F3.4&F4.1) in nominal configuration to obtain the sub-assemblySA4. In the realistic configuration, the assembly is performed byL′9(Co:A′3.2&A′4.1) andL10(Co:Q′uv&V′uv).Q′uvandV′uvare deduced by the method shown in Fig. 12.Sequence 5:The sub-assembly SA5 is performed by an attachment relation, the three parts 4, 5 and 6 (Sequence 5 in Table 2):•L11(Co:A5.1&A6.1),L12(Co:A5.1&A4.2),L13(Co:F5.3&F6.3).Using the method shown in Section  4.2.2, the constraintsL11,L12andL13become:•L′11(Co:A′5.1&V6e),L′12(Co:A′5.1&V4f),L′13(Co:Qst&Vst).The new mating constraints defined in the realistic assembly (rod — crankshaft assembly) are aggregated in Table 2. Mating constraints are updated and applied on the assembly system. Then, the realistic configurations of the assembly are obtained (Fig. 18(a)).A set of assembly configurations does not present interferences between parts. However, the simulation of the realistic assembly motion shows the interferences between the cylinder and the piston. For example, the realistic assembly configuration Cm is obtained after updating the mating constraints: the minimum clearance Jmin is equal to 0.023 mm and the angleαis equal to 50° (Fig. 18(a)). When the part 3′ is rotated about the axisA′1.1(to simulate the assembly motion), interferences are detected between parts (Fig. 18(b)).All obtained configurations present interferences between parts (before or after the assembly motion). Thus, the tolerances allocated to the components must be modified. So, the proposed model is considered as a tool for visualization and tolerance impact analysis in the assembly simulation case.The proposed model for tolerance analysis takes into account not only the part deviations but also the assembly process planning and the contact types between parts. In addition, the impact of the tolerance stack-up on the functional requirement in a dynamic environment can be determined.

@&#CONCLUSIONS@&#
