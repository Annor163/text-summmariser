@&#MAIN-TITLE@&#
Inverse portfolio problem with coherent risk measures

@&#HIGHLIGHTS@&#
An inverse portfolio problem finds a coherent risk measure for a given optimal portfolio.Necessary and sufficient conditions for the existence of such a risk measure are obtained.A risk envelope characterization of an optimal solution is presented.If the exact solution do not exists, an approximate one in the form of a mixed CVaRs is found.

@&#KEYPHRASES@&#
Decision making under risk,Coherent risk measure,Portfolio optimization,Inverse portfolio problem,

@&#ABSTRACT@&#
In general, a portfolio problem minimizes risk (or negative utility) of a portfolio of financial assets with respect to portfolio weights subject to a budget constraint. The inverse portfolio problem then arises when an investor assumes that his/her risk preferences have a numerical representation in the form of a certain class of functionals, e.g. in the form of expected utility, coherent risk measure or mean-deviation functional, and aims to identify such a functional, whose minimization results in a portfolio, e.g. a market index, that he/she is most satisfied with. In this work, the portfolio risk is determined by a coherent risk measure, and the rate of return of investor’s preferred portfolio is assumed to be known. The inverse portfolio problem then recovers investor’s coherent risk measure either through finding a convex set of feasible probability measures (risk envelope) or in the form of either mixed CVaR or negative Yaari’s dual utility. It is solved in single-period and multi-period formulations and is demonstrated in a case study with the FTSE 100 index.

@&#INTRODUCTION@&#
Identifying agent’s risk preferences has been and continues to be one of the main thrusts of decision making under uncertainty. von Neumann and Morgenstern (1953) were the first who proposed four axioms on a preference relation: completeness, transitivity, continuity, and independence and showed that these axioms admit a numerical representation in the form of expected utility. Due to its mathematical elegance and relative simplicity, the expected utility theory (EUT) still remains a normative model of the theory of choice despite continuing debate and criticism since its inception. On the one hand, empirical evidence (so-called paradoxes) shows that some of EUT’s axioms are consistently violated (see, e.g., Allais paradox (Allais, 1953)), whereas, on the other hand, even if the four axioms are agreed to follow, an agent faces an exhaustive questionnaire procedure for identifying his/her utility function. A considerable number of alternative theories of choice have emerged only to encounter their own paradoxes and to reveal that they hardly have advantage over the EUT; see dual utility theory (Röell, 1987; Yaari, 1987), weighted expected utility theory (WEUT) (Fishburn, 1983), rank-dependent (anticipated) utility theory (AUT) (Quiggin, 1993), prospect theory (Fox & Poldrack, 2009; Kahneman & Tversky, 1979), cumulative prospect theory (CPT) (Kahneman & Tversky, 1992), regret theory (Loomes & Sugden, 1982), disappointment theory (Bell 1985), mean-deviation theory (Grechuk, Molyboha, & Zabarankin, 2012), to mention just a few.While all utility theories begin with axioms on a preference relation and then derive numerical representations for those axioms, the recently emerged theory of coherent risk measures (Artzner, Delbaen, Eber, & Heath, 1999) introduces the notion of acceptance setAfor risky alternatives (random variables) and measures risk of a random variable (r.v.) X as the minimum amount of cash C that makesX+Cacceptable. In other words, a risk measure ρ of X can be determined asρ(X)=min{C∈R|X+C∈A}. IfAis a closed positively homogeneous convex cone containing all nonnegative r.v.’s and no strictly negative r.v.’s, then ρ is a positively homogeneous convex functional and is called coherent risk measure (Artzner et al., 1999). In this case, it admits a dual representation in the formρ(X)=supQ∈QE[Q(−X)],whereQis a closed convex set whose elements are nonnegative r.v.’s with expected value of 1 (constant 1 is also included). The setQis called risk envelope and each its element can be interpreted as a “distortion” of the underlined probability measure. Namely this interpretation ties risk preferences to a certain convex set of probability measures. In other words, the agent can specify “scenarios” of probability measures and can evaluate risk of an r.v. X as the negative expected value of X under the worst-case probability measure over the convex hull of the specified probability measures; see, e.g., Lesnevski, Nelson, and Staum (2007). In fact, there is a one-to-one relationship between coherent risk measures and risk envelopes.Given the elegant risk-envelope characterization and the attractive properties (convexity, positive homogeneity, monotonicity, and constant translation) of coherent risk measures, the agent may reasonably assume that his/her risk preferences have a numerical representation in the form of a coherent risk measure ρ, which he/she would use in a variety of decision making problems: optimal portfolio selection (Miller & Ruszczyński, 2008), optimal risk sharing (Jouini, Schachermayer, & Touzi, 2008), optimal hedging (Rudloff, 2009), etc. Also,−ρ(X)plays the role of a utility functional of an r.v. X, and the question of identifying ρ(X) is equivalent to the one of identifying the utility functionalU(X)=−ρ(X). One of the approaches to finding ρis to solve the inverse portfolio problem: if the agent minimizes the coherent risk measure ρ over some set of r.v.’s (portfolio returns), and X* is known to be optimal, i.e. the rate of return of an optimal portfolio, then ρ can be recovered from X* through determining the risk envelopeQassociated with ρ. This approach was demonstrated in identifying a deviation measure in a Markowitz-type portfolio selection problem; see Grechuk and Zabarankin (2014) and (Zabarankin & Uryasev, 2014, Section 8.2.4). However, in general, the results in (Grechuk & Zabarankin 2014) cannot be used directly to solve the inverse portfolio problem with an unrestricted class of coherent risk measures, since deviation measures correspond one-to-one to averse measures of risk (Rockafellar, Uryasev, & Zabarankin, 2002, 2006a),22In Rockafellar et al. (2002, 2006a), they are originally called strictly expectation bounded risk measures.which, in contrast to coherent risk measures, are not required to preserve monotonicity of preference relations; see Rockafellar et al. (2002, 2006a) and (Zabarankin & Uryasev, 2014, Section 2.3). In fact, these two classes of risk measures have a nonempty intersection called coherent averse measures of risk that correspond one-to-one to lower range dominated deviation measures (subclass of general deviation measures). For example, the standard deviation is not lower range dominated, and as a result, it has no counterpart in coherent risk measures through the one-to-one correspondence established in (Rockafellar et al., 2002, 2006a). Also, the work (Grechuk & Zabarankin, 2014) assumes X* to be SSD-efficient to guarantee the existence of a law invariant solution, which is no longer required here.This paper solves the inverse portfolio problem with coherent risk measures in both single-period and multi-period formulations. In the single-period formulation, a setXof feasible portfolio rates of return at some time moment t0 in the past is given, and the agent’s optimal portfolio rate at t0 is known to beX*∈X. The inverse problem is then finding a coherent risk measure ρfrom a given classR,determined by some additional requirements/constraints on agent’s risk preferences, such that X* is agent’s optimal choice. It is shown that if a law-invariant solution to the inverse problem exists, it can always be represented in the form of mixed CVaR, and a technique for explicitly computing that mixed CVaR is suggested.33In Grechuk and Zabarankin (2014), the technique for identifying deviation measures requires X* to have unique risk identifiers with respect to all CVaR’s, which considerably limits the number of appropriate X* (especially of real-life instruments). Here, the corresponding technique works for arbitrary X*.Moreover, if an exact solution does not exist, the technique returns the “best” approximate mixed CVaR. In the multi-period formulation, a sequence of agent’s optimal portfolio rates of return is given (each of which is from a given feasible set), andρ∈Ris sought to make all those portfolio rates optimal (or at least close to optimal).The rest of the paper is organized into four sections. Section 2 introduces coherent risk measures. Section 3 formulates and solves the inverse portfolio problem with coherent risk measures, whereas Section 4 constructs approximate solutions in the form of mixed CVaR. Section 5 concludes the work and proposes future research directions.LetXbe a set of available random variables (r.v.’s), e.g. representing rates of return of risky assets. Formally, an r.v. is a measurable function from some probability spaceΩ=(Ω,M,P)toR,where Ω is the set of future states ω,Mis a field of sets in Ω, andPis a probability measure on(Ω,M). The relations between r.v.’s will be understood to hold in the almost sure sense, e.g., we writeX=YifP[X=Y]=1and X ≥ Y ifP[X⩾Y]=1. By FX(x) andqX(α)=inf{x|FX(x)>α}will be meant the cumulative distribution function (CDF) and quantile function of an r.v. X, respectively. LetL∞(Ω)=L∞(Ω,M,P)be the space of all bounded r.v.’s with the norm∥X∥∞=sup|X|,and letL1(Ω)=L1(Ω,M,P)be the space of all r.v.’s with finite expectation with the norm∥X∥1=E|X|. The probability space Ωis called atomless, if there exists an r.v. with a continuous CDF.44The existing literature offers several definitions of an atomless space, all of which are equivalent, see (Föllmer & Schied, 2011, Proposition A.27).We assume that every r.v. X fromXis bounded, and that an agent evaluates risk of X by a risk measureρ:L∞(Ω)→Rsatisfying four axioms:(i)Monotonicity: ρ(X) ≥ ρ(Y) whenever X ≤ Y;Sub-additivity:ρ(X+Y)⩽ρ(X)+ρ(Y)for allX,Y∈L∞(Ω);Positive homogeneity:ρ(αX)=αρ(X)for everyX∈L∞(Ω)and α ≥ 0;Translation property:ρ(X+C)=ρ(X)−Cfor everyX∈L∞(Ω)and constant C.A functionalρ:L∞(Ω)→Rsatisfying (i)–(iv) is called coherent risk measure (Artzner et al., 1999). The set of all r.v.’s with non-positive risk, i.e.(1)Aρ={X∈L∞(Ω)|ρ(X)⩽0}is called the acceptance set associated with ρ. The four axioms of ρ imply thatAρis a positively homogeneous convex cone containing all nonnegative r.v.’s and no strictly negative r.v.’s; see Artzner et al. (1999). In fact,Aρgives ρ back as(2)ρ(X)=minC∈R:X+C∈AρC,which shows that ρ(X) is the minimum amount of cash infusion needed for X to be acceptable.Every coherent risk measure satisfying the Fatou property55A functional ρ satisfies the Fatou property, ifρ(X)⩽liminfn→∞ρ(Xn)for any bounded sequence Xnwith Xn→ X a.s. Since Xn→ X a.s. does not imply Xn→ X in theL∞norm, this property is stronger than lower semicontinuity.can be represented by(3)ρ(X)=supQ∈QE[Q(−X)],for someQ⊂QMAX⊂L1(Ω),whereQMAX={Q∈L1(Ω)|Q⩾0,E[Q]=1},see Artzner et al. (1999). The setQin (3) is called the risk envelope of ρ and is recovered from ρ as(4)Q={Q∈L1(Ω)|E[Q(−X)]⩽ρ(X)forallX∈L∞(Ω)}.Since everyQ∈QMAXis a Radon–Nikodym derivative of some probability measurePQwith respect toP,E[Q(−X)]=EPQ[−X]can be viewed as the expected loss associated with X underPQ. The setQin (3) can then be interpreted as the set of Radon–Nikodym derivatives of probability measures, or scenarios, which the agent considered “likely,” and the risk measure in (3) is then interpreted as the average loss under the “worst” scenario. If the supremum in (3) is attained for some Q, it is called a risk identifier for X (Rockafellar, Uryasev, & Zabarankin, 2006c). The set of all risk identifiers for X is denoted byQρ(X).The representations (1) and (3) imply that the acceptance setAρcan be determined by the risk envelopeQbyAρ={X∈L∞(Ω)|E[QX]⩾0forallQ∈Q},whereas it follows from (2) and (4) that the risk envelopeQis “induced” byAρasQ={Q∈L1(Ω)|E[Q]=1,E[QX]⩾0forallX∈Aρ}.A coherent risk measure ρ is called law-invariant ifρ(X)=ρ(Y)whenever X and Y have the same distribution function. This is equivalent to the assumption that the risk envelopeQassociated with ρ is law-invariant:Q1∈Qimplies thatQ2∈Qwhenever Q1 and Q2 have the same distribution, see Dana (2005, Corollary 4.3).The best known example of a law-invariant coherent risk measure is arguably conditional value-at-risk (CVaR) (Rockafellar & Uryasev, 2002), defined for any α ∈ (0, 1] byCVaRα(X)≡−1α∫0αqX(β)dβ.By continuity, we can defineCVaR0(X)=limα→0CVaRα(X)=−infX.A straightforward generalization of CVaR is mixed CVaR (Rockafellar et al., 2002, 2006a)(5)ρ(X)=∫01CVaRα(X)dλ(α),where λ is a weight function66In Rockafellar et al. (2002, 2006a), λ is a weight function on (0, 1). Following Föllmer and Schied (2011, p. 220), we extend the definition of mixed CVaR to includeCVaR0(X)=−infXandCVaR1(X)=−E[X]. In particular, λcan be a linear combination of delta-functions atα1<⋯<αn,in which case, mixed CVaR (5) simplifies to∑i=1nwiCVaRαi(X),wherew1,…,wnare positive weights summing up to 1.on [0, 1], i.e. λ(α) ≥ 0 and∫01dλ(α)=1. Iflimϵ→0∫0ϵdλ(α)=0,77In other words, if λis not a δ-function at 0.mixed CVaR (5) can be represented in the spectral form(6)ρ(X)=−∫01ϕ(α)qX(α)dα,whereϕ(α)=∫[α,1)s−1dλ(s)is a left-continuous and nonincreasing function withϕ(1−)=0and∫01ϕ(α)dα=1; see Theorem 4.70 in Föllmer and Schied (2011). Guriev (2001, Theorem 1) showed that the integral in (6)(without negative sign) is exactly a Yaari’s dual utility function (Yaari, 1987).Under a minor technical assumption,88Namely, this holds if Ω is atomless andL2(Ω)is separable. The representation (7) was originally proved in Kusuoka (2001) under somewhat more restricting conditions.every law-invariant coherent risk measure can be represented as a worst-case mixed CVaR(7)ρ(X)=supλ∈Λ∫01CVaRα(X)dλ(α),where Λ is a collection of probability measures λ on [0, 1], see Corollary 4.63 and Remark 4.64 in Föllmer and Schied (2011). Equivalently, ρ(X) in (7) can be represented as(8)ρ(X)=supQ∈Q∫01qQ(α)q−X(α)dα,whereQis the same as in (3), see Theorem 4.59 in Föllmer and Schied (2011).In this work, investors are assumed to be non-satiable and risk averse, and their choices are assumed to be consistent with risk orderings (Lozza, Shalit, & Fabozzi, 2013).An r.v. X dominates an r.v. Y with respect to second-order stochastic dominance (SSD), and we write X≽SSDY, if E[f(X)] ≥ E[f(Y)] for every concave increasing functionf:R→R,or, equivalently, if(9)CVaRα(X)⩽CVaRα(Y)∀α∈[0,1],see Theorem 2.57 in Föllmer and Schied (2011). If X ≽SSDY, then (9) implies that ρ(X) ≤ ρ(Y) for every ρ in the form (7), so that Y can be viewed as universally riskier than X.A coherent risk measure can be required to conform to certain preferences from agent’s past experience, for example, to(a)Accept assets with rates of returnX1,X2,…,Xk,i.e. X1 ∈ Aρ,⋯,Xk∈ Aρor, equivalently,ρ(X1)⩽0,…,ρ(Xk)⩽0,which can be written asQ⊂QM,whereQis the risk envelope associated with ρ and(10)QM={Q∈QMAX|E[QX1]⩾0,…,E[QXk]⩾0}.In other words, the agent’s risk envelope should include only those scenarios, under whichX1,X2,…,Xkhave non-negative expected values.Order “reference” ratesX1,…,Xkaccording to a given set S of orderings: (i, j) ∈ S⇔Xi⪰Xj. For example, the agent may feel that the FTSE250 index is safer than the FTSE100 index, which, in turn, is safer than the IBM stock. Such preferences may be formalized asQ⊂QM,whereQis the risk envelope of ρ and(11)QM={Q∈QMAX|E[QXi]⩾E[QXj],(i,j)∈S}.Exclude certain (Radon–Nikodym derivatives of) probability measures that are “too concentrated” to some scenarios, e.g. to haveQ⊂QMwith(12)QM={Q∈QMAX|1/2⩽Q⩽3/2}.Generate a risk envelope by perturbing a “reference” elementQ*∈QMAX,e.g.Q*=1:(13)Q={Q∈QMAX|Q=Q*+Z,Z∈Z},whereZ⊂L1(Ω)is a closed convex set of possible “errors” of Q*, andQ=Q*+Zcan be viewed as a perturbation of Q*. For example,Zmay consist of all r.v.’s Z with E[|Z|] ≤ ϵ for some ϵ > 0.In addition, ρ can be assumed to be either (i) law-invariant, (ii) mixed CVaR (5), or (iii) a finite combination of CVaRs(14)ρ(X)=∑j=1mλjCVaRαj(X)for some0⩽α1<⋯<αm⩽1andλj⩾0,j=1,…,mwith∑j=1mλj=1.The agent may combine any requirements (a)–(d) on the existing preferences with any assumption (i)–(iii) on the form of coherent risk measure. In general, letRbe the set of all coherent risk measures satisfying agent’s requirements/assumptions. For example,Rcan be a set of all law-invariant coherent risk measures such that(15)R={ρ(X)=supQ∈QE[Q(−X)]|Q⊂QM}withQMdefined by either (10), (11), or (12), if the agent requires ρ to conform to preference conditions (a), (b), or (c), respectively.IfRis not a singleton, how to choose a particular risk measureρ∈R? One of the approaches is to recover ρfrom the inverse portfolio problem: the agent assumes that the rate of return of the portfolio that he/she either believes to be optimal or is relatively satisfied with minimizes ρ over the setX. The portfolio optimality conditions are then used to find the risk envelope associated with ρ, and ρis given by (3).Once ρ is recovered, the agent may use it to find an optimal portfolio over a different setXof portfolio rates of return, X, and subject to additional constraints, e.g. E[X] ≥ π for some π > 0; see e.g. Miller and Ruszczyński (2008). However, the knowledge of ρ is critical far beyond portfolio selection. One example is optimal risk sharing between two agents who use law-invariant coherent risk measures ρ1 and ρ2 as numerical representations of their attitudes towards risk. Namely, given agents’ endowments X1 and X2, it is often possible to find agents’ shares Y1 and Y2 of the aggregate endowmentX=X1+X2such thatY1+Y2=X,but ρ1(Y1) < ρ1(X1) and ρ2(Y2) < ρ2(X2), see Jouini et al. (2008). Another example is hedging in an incomplete market, when, in contrast to a complete market, not every contingent claim can be replicated with the existing set of assets, and the agent needs to find a hedging strategy that minimizes the risk (measured by ρ) of the residual of a replicated claim, see Rudloff (2009).A single-period portfolio optimization problem is formulated as follows. Let r.v.’sr1,…,rnbe the rates of return of n risky assets, and letvibe the fraction of the initial capital invested into asset i. Then the portfolio rate of return is determined byrp=∑i=1nrivi,and the investor’s portfolio problem is to minimize a coherent risk measure ρ of rpwith respect tov1,…,vnsubject to the budget constraint∑i=1nvi=1and no-shorting constraintsvi⩾0,i=1,…,n:(16)minX∈Xρ(X),whereXis the set of all possible rates of return:(17)X={X=∑i=1nrivi|∑i=1nvi=1,v1⩾0,…,vn⩾0}.If short sales are allowed, the feasible setXin (17) becomesX={X=∑i=1nrivi|∑i=1nvi=1},and if there is also a risk-free asset with constant rate of return r0, thenX={X=∑i=0nrivi|∑i=0nvi=1}. In the last case,v0is typically expressed from the budget constraint asv0=1−∑i=1nvi,and rptakes the formrp=∑i=1n(ri−r0)vi+r0=X+r0,whereX=rp−r0=∑i=1n(ri−r0)viis the portfolio excess rate of return. In this case,ρ(rp)=ρ(X)−r0,and the portfolio optimization problem can be equivalently reformulated as (16) with(18)X={X=∑i=1n(ri−r0)vi|(v1,…,vn)∈Rn}.In either case, the inverse portfolio problem is then formulated by(19)Findρ∈Rsuchthatρ(X*)⩽ρ(X)foreachX∈X,whereX*∈XandXisgivenbyeither(17)or(18).Theorem 5 in Rockafellar et al. (2002) implies that a sufficient condition for X* to be optimal in (16), which is also necessary when ρ is finite onL2(Ω),is the existence of a risk identifierQ∈Qρ(X*)such that(20)E[(X−X*)Q]⩽0∀X∈X.WithXgiven by (17),X*=∑i=1nrivi*,and (20) reduces to (see also Rockafellar et al. (2006c, Theorem 2) and Zabarankin and Uryasev (2014, Theorem 8.1))(21)∃Q∈Qρ(X*)suchthatE[riQ]{=ζ,vi*>0⩽ζ,vi*=0i=1,…,n,where ζ is the Lagrange multiplier corresponding to the constraint∑i=1nvi=1,which implies that optimal ζ is equal toE[X*Q]=−ρ(X*). The optimality conditions (21)can be equivalently formulated as(22)∃Q∈QsuchthatE[riQ]⩽−ρ(X*),i=1,…,n.Indeed, letQ∈Qsatisfy (22). Then (22) yields∑i=1n(E[riQ]+ρ(X*))vi*⩽0,so thatE[X*Q]+ρ(X*)⩽0,orρ(X*)⩽E[Q(−X*)]. SinceQ∈Q,ρ(X*)⩾E[Q(−X*)],and the equality holds. Thus, Q is, in fact, a risk identifier for X*, and the equality in (22) holds for every i such thatvi*>0. Hence, (22)reduces to (21).IfXis given by (18), then the optimal portfolio rate of return must have zero risk.Proposition 1If X*is a solution to(16)withXgiven by(18), thenρ(X*)=0. Consequently, any portfolio rate of return from the set{X∈X|X=αX*,α⩾0}is also optimal in(16).SinceXin (18) is a subspace ofL∞(Ω),(1−ϵ)X*∈Xand(1+ϵ)X*∈Xfor some ϵ > 0, and since X* is optimal,ρ(X*)⩽min{ρ((1−ϵ)X*),ρ((1+ϵ)X*)}=min{(1−ϵ)ρ(X*),(1+ϵ)ρ(X*)},which implies thatρ(X*)=0. By positive homogeneity,ρ(αX*)=0for any α ≥ 0 such thatαX*∈X,and consequently, all these portfolio rates of return are optimal as well.□Proposition 1 implies thatE[X*Q]=ρ(X*)=0for anyQ∈Qρ(X*),and consequently, the optimality condition (20) reduces to E[XQ] ≤ 0 for allX∈X,which is possible only if(23)E[XQ]=0∀X∈X,or, equivalently, ifE[riQ]=r0,i=1,…,n. AnyQ∈QMAXsatisfying (23) is called the Radon–Nikodym derivative of “risk-neutral probability measure” or “risk neutral” in short.99A risk-neutral probability measure is a measure under which the expected discounted future price of any instrument is equal to the current one, see Föllmer and Schied (2011).By the fundamental theorem of asset pricing (see, e.g., Föllmer and Schied (2011, Theorem 1.7)), the existence of the risk-neutral probability measure is equivalent to the no-arbitrage assumption, i.e. no portfolio has excess return non-negative with probability 1 and strictly positive with positive probability. If this assumption does not hold, the investor can borrow at the risk-free rate unlimited amount of money and can invest in the risky assets making portfolio risk as small as desired, so that there is no optimal portfolio, and the inverse portfolio problem (19) has no solution.This section seeks to find law-invariant solutions to the inverse portfolio problem (19). The following proposition establishes necessary and sufficient conditions for their existence.Proposition 2For arbitrary setXand anyX*∈X,the following conditions are equivalent:(a)The inverse problem (19) has a solution in the form of worst-case mixed CVaR (7).There is no constant ϵ > 0 andY∈Xsuch thatY≽SSDX*+ϵ.There is noY∈Xsuch that(24)CVaRα(Y)<CVaRα(X*)∀α∈[0,1].The inverse problem (19) has a solution in the form of mixed CVaR (5).If the probability space Ω is either atomless or finite uniform, i.e.Ω={ω1,…,ωT}withP[ωt]=1/T,t=1,…,T,then conditions (a)–(d) are equivalent to the condition that(e)The inverse problem (19) has a law-invariant solution.If the probability space Ω is finite uniform, then conditions (a)–(e) are equivalent to the condition that(f)The inverse problem (19) has a solution in the form (14) withm=Tandαj=j/T,j=1,…,T.IfXis given by (18), then conditions (a)–(d) are equivalent to the conditions that(g)There exists a risk-neutral r.v.Q*∈QMAXcomonotone1010Two r.v.’sX:Ω→RandY:Ω→Rare said to be comonotone, if there exists a set A ⊂ Ω such thatP[A]=1and(X(ω1)−X(ω2))(Y(ω1)−Y(ω2))⩾0for all ω1, ω2 ∈ A.with−X*.The inverse problem (19) has a solution in the form(25)ρ(X)=∫01qQ*(α)q−X(α)dα,Q*∈QMAX.(a) ⇒ (b): By contradiction, let ϵ > 0 andY∈Xbe such thatY≽SSDX*+ϵ. Then, for any ρgiven by (7),ρ(Y)⩽ρ(X*+ϵ)=ρ(X*)−ϵ<ρ(X*),hence ρ is not a solution to the inverse problem (19).(b) ⇒ (c): By contradiction, letY∈Xbe such that (24) holds. SinceCVaRα(X*)−CVaRα(Y)is a continuous function of α ∈ [0, 1], it attaints its minimum value ϵ. By (24), ϵ > 0, andCVaRα(Y)⩽CVaRα(X*)−ϵ=CVaRα(X*+ϵ)for every α ∈ [0, 1]. Hence,Y≽SSDX*+ϵ,which contradicts (b).(c) ⇒ (d): The convexity ofXand CVaRα, α ∈ [0, 1], implies that the setU={ϕ∈S|∃X∈X:ϕ(α)⩾CVaRα(X)}is a convex subset in the vector spaceSof continuous functionsϕ:[0,1]→R. By (c), the functionϕ*(α)=CVaRα(X*)belongs toU,but not to the interior ofU. Thus, there exists a non-zero linear functionalL:S→Rwhich attains its supremum onUat ϕ*; see e.g. Zalinescu (2002, Corollary 1.1.4). In fact,(−L)is a positive linear functional, that is,(−L)(ϕ)⩾0for any function ϕ such that ϕ(α) ≥ 0 for all α ∈ [0, 1]. Indeed,ϕ*+ϕ∈U,henceL(ϕ*+ϕ)≤L(ϕ*),so thatL(ϕ)⩽0. Thus,(−L)(ϕ)=∫01ϕ(α)dλ(α)for some non-negative measure λ on [0, 1], and we may assume that∫01dλ(α)=1. Then the functionalR(X)=−L(CVaRα(X))=∫01CVaRα(X)dλ(α)belongs to the family (5) and attains its infimum onXat X*.(a) ⇒ (f): Letρ˜be a solution to the inverse problem in the form (7). By Theorem 5 in Rockafellar et al. (2002), there exists a risk identifierQ*∈Qρ˜(X*)such thatE[(X−X*)Q*]⩽0for allX∈X. By Proposition 1,ρ˜(X*)=0. SinceQ*∈Qρ˜(X*),this implies thatE[X*Q*]=0,and consequently, E[XQ*] ≤ 0 for allX∈X,which is possible only ifE[Q*ri]=r0,i=1,…,n. Thus, Q*is a risk-neutral r.v. Ifρ(X)¬≡−E[X],then Q* is comonotone with−X*by Proposition 14 in Grechuk and Zabarankin (2014), applied to the functionalD(X)=ρ(X)+E[X]. Ifρ(X)≡−E[X]then Q* ≡ 1, and comonotonicity follows as well.(f) ⇒ (h): LetQ*∈QMAXbe a risk-neutral r.v. comonotone with−X*. Thenρ(X*)=∫01qQ*(α)q−X*(α)dα=E[Q*(−X*)]=0,where the second equality follows from comonotonicity of Q* and−X*,and the third one from risk neutrality of Q*. On the other hand,ρ(X)=∫01qQ*(α)q−X(α)dα⩾E[Q*(−X)]=0=ρ(X*)for any other r.v.X∈X,where the inequality is due to Hardy & Littlewood (Föllmer & Schied, 2011, Theorem A.24). Hence, X* is optimal in (16) with ρ.Implications (h) ⇒ (a) and (d) ⇒ (a) follow from the fact that families (25) and (5) are subclasses of (7). On an atomless probability space, every law-invariant risk measure can be represented in the form (7) (Föllmer & Schied, 2011, Corollary 4.63), and (a) ⇔ (e) follows.Let Ω be a finite uniform set with T elements. Then every law-invariant risk measure ρ preserves SSD, i.e. ρ(X) ≤ ρ(Y) whenever X≽SSDY, see Bäuerle and Müller (2006, Theorem 3.5), so that it can be represented in the form (7) (Leitner, 2005, Theorem 2.2), and (a) ⇔ (e) follows. Finally, with finite uniform Ω, CVaRα(X) is a piecewise-linear function of α for every X, so that the condition (24) can be written as(26)CVaRj/T(Y)<CVaRj/T(X*)j=1,…,T,and (c) ⇒ (e) follows from the same argument as (c) ⇒ (d), while the implication (e) ⇒ (d) is obvious.□If in the proof of (a) ⇔ (f) ⇔ (h) in Proposition 2,QMAXis replaced by any law-invariantQM⊂QMAX,then the following result holds.Proposition 3The inverse problem(19), whereXis given by(18)andRis given by(15)with law-invariantQM,has a solution in the form(7)if and only if there exists a risk-neutral r.v.Q*∈QMcomonotone with−X*. In this case, the coherent risk measureρ(X)=∫01qQ*(α)q−X(α)dαis a solution of the inverse problem.The solution to the inverse problem (19), if exists, may in general be not unique. LetR*be the set of all solutions in the form (8) to the inverse problem (19) withRgiven by (15).Proposition 4If the setR*is non-empty, it contains a solution ρ*with the associated risk envelopeQ*,which is “maximal” possible in sense thatQ⊂Q*for any other solutionρ∈R*with the associated risk envelopeQ. Moreover,Q*is given by(27)Q*={Q∈QM|∫01qQ(α)q−X*(α)dα⩽0}.Let ρ given by (8) with the associated risk envelopeQbe a solution to the inverse portfolio problem (19), and letQ∈Q. Then0=ρ(X*)⩾∫01qQ(α)q−X*(α)dα,where the equality follows from Proposition 1, and the inequality is due to (8). Hence,Q∈Q*by (27), andQ⊂Q*,and consequently, ρ*(X) ≥ ρ(X) ≥ 0 for any r.v.X∈X. On the other hand,ρ*(X*)=0by construction, so that X* is optimal in (16) with ρ*.□In the portfolio problem (16), the investor may impose a constraint on the portfolio expected rate of return:(28)minX∈Xρ(X)subjecttoE[X]⩾π.The problem inverse to (28) is formulated similarly to (19): givenX*∈X,find π and ρ such that X* is optimal in (28). If ρ is an averse measure of risk, i.e.ρ(X)>−E[X]for all non-constant X (see Rockafellar et al. (2002, 2006a) and Zabarankin and Uryasev (2014, Section 2.3)), and the constraint E[X] ≥ π holds as equality at optimality, then (28) is equivalent to(29)minX∈XD(X)subjecttoE[X]⩾π,whereD(X)=ρ(X)+E[X]is a deviation measure (see Rockafellar et al. (2002, 2006a) and Zabarankin and Uryasev (2014, Section 2.1)). The problem inverse to (29) is solved in Grechuk and Zabarankin (2014).Proposition 5[Proposition4inGrechuk and Zabarankin (2014)]If there is noY∈Xfor which(24)holds, thenX*∈Xis an optimal solution in(28)forπ=E[X*]and for a risk measure ρ in the form of mixed CVaR(5).LetΩ={ω1,…,ωT}withP[ωt]=1/T,t=1,…,T,and let rit,i=1,…,n,t=1,…,T,be the excess rate of return of risky asset i under ωt. The feasible setXin (18) is then a subset ofRTand is given byX={X=(x1,…,xT)|xt=∑i=1nritvi,t=1,…,T,(v1,…,vn)∈Rn}.FixX*=(x1*,…,xT*)∈X. If there exists a law-invariant solution to the inverse problem (19)withRgiven by (15) withQM=QMAX,then its risk envelope (27) takes the form(30)Q*={Q=Perm(q1,…,qT)|∑t=1Tqt(−x¯t*)⩽0,∑t=1Tqt=T,0⩽q1⩽q2⩽⋯⩽qT},where(x¯1*,…,x¯T*)is a permutation of(x1*,…,xT*)such thatx¯1*⩾⋯⩾x¯T*,andPerm(q1,…,qT)denotes the set of all permutations of(q1,…,qT).In particular, we selectn=92instruments from the FTSE 100 index1111There are 101 instrument in the index, nine of them are excluded due to the lack of data.and identifyT=182scenarios for instruments’ weekly rates of return from 3-January-2011 to 30-June-2014. Here,r0=0,and ritis the historical rate of return of instrument i during time period t.(i)LetX*=(x1*,…,xT*)be the rate of return of the master fund of positive type (Rockafellar, Uryasev, & Zabarankin 2006b)1212A master fund of positive/negative type is an optimal mean-deviation portfolio that has positive/negative unit price and zero weight in the risk-free asset, see Rockafellar et al. (2006b, Definition 2, p. 758). It is a “tangent portfolio” on the mean-deviation positive/negative efficient frontier of risky assets.in Markowitz’s mean-variance optimization problem. Fig. 1shows three elements from the law-invariant risk envelope (30). The horizontal axis denotes scenariost=1,…,T=182,while the vertical one denotes the values of the corresponding qt-s.LetX*=(x1*,…,xT*)be the rate of return of the FTSE 100 index.1313The weights of components in FTSE 100 index can be found at http://www.ftse.com/analytics/factsheets/Home/ConstituentsWeights. The weights of nine excluded components are assumed to be zero.Then condition (b) in Proposition 2 does not hold, hence there are no law-invariant solution to the inverse problem (19).There are two reasons for presenting Example 1(i), where X* is chosen to be the rate of return of a mean-variance portfolio. First, Markowitz’s mean-variance portfolio is often viewed as a reference result in the modern portfolio theory and capital asset pricing. However, the standard deviation (or, equivalently, variance) is not, in fact, a measure of risk but rather the one of deviation. It does not preserve monotonicity of a preference relation and, as a deviation, cannot be used alone to express risk aversion. In this case, the question of interest is not whether the Markowitz’s mean-variance portfolio is desirable, but rather what a “rational equivalent” of the mean-variance model in the class of risk measures, which are monotone and risk averse, is. In other words, the inverse portfolio problem allows to uncover the “rational side” of the mean-variance model. Second, Example 1(ii) shows that for X* of a real-life instrument, e.g. the FTSE 100 index, the inverse problem typically may not have exact law-invariant solution. In this case, the investor has two options:(a)Solve the inverse problem to find an exact non law-invariant solution, orFind a law-invariant risk measure, which solves the inverse problem approximately.Option (a) is addressed in Section 3.3, whereas option (b) is pursued in Sections 4.1–4.4.If the inverse problem (19) withXgiven by (18) has no law-invariant solution, it can always be solved in the class of all coherent measures provided that the market is arbitrage-free.1414A market is considered to be the set of one risk-free and n risky financial instruments, whereas an arbitrage-free market is the one in which no portfolio has excess rate of return non-negative with probability 1 and strictly positive with positive probability; see Föllmer and Schied (2011).Indeed, if one takesQ={Q*}for any risk neutral Q*, then the corresponding coherent risk measure ρ in (3) satisfiesρ(X)=0for allX∈X,so that anyX∈Xis optimal, in particular, a givenX*∈X. However, there exists ρfor which X* is optimal, but anyX∈X,which is not proportional to X*, is not. Such ρ can be constructed through (13): start with any risk neutral Q* and then “robustify” it by choosing an appropriate error setZ. ThenQ∈QMAXforQ=Q*+Zimplies that(31)E[Z]=0∀Z∈Z.Suppose that Q* is a risk identifier for X*, thenE[Q*(−X*)]⩾E[(Q*+Z)(−X*)]for allZ∈Z,or, equivalently,(32)E[ZX*]⩾0∀Z∈Z.Proposition 6LetQbe defined by(13), where Q*is any risk neutral r.v. such thatP[Q*>0]=1,and letZbe the set of all r.v.’s inL1(Ω)satisfying the conditions(31)and(32),1515The statement of the proposition will be unaffected if the extra condition that ‖Z‖1 ≤ ϵ for allZ∈Zand some ϵ > 0 is added.i.e.Z={Z∈L1(Ω)|E[Z]=0,E[ZX*]⩾0}. Then for the corresponding coherent risk measure ρ in(3), the set of optimal portfolio rates of return in(16)is precisely the set{X∈X|X=αX*,α⩾0}.E[Q(−X*)]=E[(Q*+Z)(−X*)]=E[Q(−X*)]+E[Z(−X*)]⩽0for everyQ∈Q,where the last inequality follows from (23) and (32). Since the equality holds for, say,Q=Q*,we haveρ(X*)=0.For anyX∈X,letZX∈L1(Ω)be a set of r.v.’s Z such thatE[Z]=0and E[ZX] ≥ 0. IfX=αX*for some α ≥ 0, thenZX=Z,but otherwiseZ∖ZXis non-empty, and there is an r.v. Z* such thatE[Z*]=0and E[Z*X*] > 0 > E[Z*X]. Since bounded r.v.’s are dense inL1(Ω),Z* can be chosen to be bounded. For any ϵ > 0, let Zϵ be an r.v. such thatZϵ(ω)=0,ω ∈ Ωϵ andZϵ(ω)=Z*+Cϵ,ω∉Ωϵ,whereΩϵ={ω|Q*(ω)⩽ϵ}and Cϵ is chosen such thatE[Zϵ]=0. SinceP[Q*>0]=1,limϵ→0P[Ωϵ]=0,so thatlimϵ→0Zϵ=Z*inL1(Ω). Thus, E[ZϵX*] > 0 > E[ZϵX] for sufficiently small ϵ. ThenE[Q]=1and Q ≥ 0 forQ=Q*+ϵ∥Zϵ∥∞Zϵ. Consequently,Q∈Qandρ(X)⩾E[Q(−X)]=E[(Q*+ϵ∥Zϵ∥∞Zϵ)(−X)]=−ϵ∥Zϵ∥∞E[ZϵX]>0,and the statement is proved.□Under the conditions in Proposition 1, Proposition 6 describes the best possible solution for the inverse portfolio problem (19). In terms of acceptance sets, it returns the coherent risk measure ρ, for which the given rate of return X* along with αX* for any α > 0 is acceptable, but any other r.v. X is not.In general, the setQin Proposition 6 is not unique: if the risk neutral Q* is not unique, the investor can choose either a “favorite” or the maximal possible setQsuch that the corresponding coherent risk measure is a solution to the inverse portfolio problem (19).Proposition 7The inverse problem(19)withXgiven by(18)and withRgiven by(15)has a solution if and only if there exists a risk-neutral r.v.Q*∈QM. In this case, a solution ρ is determined by(3)with(33)Q={Q∈QM|E[QX*]⩾0},and this solution is “maximal” possible in sense that the risk envelope of any other solution is a subset ofQin(33).“Only if”: Letρ˜∈Rbe a solution to (19). By Proposition 1,ρ˜(X*)=0,and consequently,ρ˜(X)⩾0for allX∈X. By Theorem 5 in Rockafellar et al. (2002), there exists a risk identifierQ*∈Qρ˜(X*)such thatE[(X−X*)Q*]⩽0for allX∈X. Hence,E[XQ*]⩽E[X*Q*]=ρ˜(X*)=0for allX∈X. SinceX⊆L∞(Ω),this implies that Q* is a risk-neutral r.v. Sinceρ˜∈Rand since Q* is in the risk envelope ofρ˜,it follows from (15) thatQ*∈QM.“If”: LetQ*∈QMbe risk-neutral r.v. ThenQ*∈Qby (33), so thatρ(X)⩾E[Q*(−X)]=0for allX∈X. Since ρ(X*) ≤ 0 by construction, ρis a solution to (19). Ifρ˜∈Ris any other solution with a corresponding risk envelopeQ′,ρ˜(X*)=0by Proposition 1, and consequently, E[QX*] ≥ 0 for everyQ∈Q′. SinceQ′⊂QMby (15), this implies thatQ′⊂Q.□The solution (33) can be viewed as a robust approach to identifying risk preferences: it includes the Radon–Nikodym derivatives of all possible scenarios, for which given rate of return X* belongs to investor’s acceptance set, i.e. X* is not worse than the risk-free rate. Observe that (33) is independent of the feasible setX.Example 2In the settings of Example 1, the risk envelope (33) of a solution withQM=QMAXto the inverse problem (19) is given byQ={Q=(q1,…,qT)|∑t=1Tqtxt*⩾0,∑t=1Tqt=T,q1⩾0,…,qT⩾0}.IfQMis given by (10), the inverse problem (19) can be formulated as follows: find a coherent risk measure ρ for which X* is optimal, provided thatX1,…,Xkare acceptable. In this case, the solution (33) includes additional constraints E[QXi] ≥ 0,i=1,…,k:Q={Q∈QMAX|E[QX*]⩾0,E[QX1]⩾0,…,E[QXk]⩾0},which, obviously, remains the same if X* is interchanged with any ofX1,…,Xk.The representation (33) can be readily generalized for the case when the rate of return of investor’s multi-period portfolio is known. Suppose that at each time momentt∈T={0,1,2,3,⋯},the investor chooses a portfolio, optimal for the next time period, i.e. the investor solves a single-period optimization problem(34)minXt+1∈Xtρ(Xt+1),whereXt+1is the excess rate of return of the portfolio at timet+1subject to the information available at time t, andXtis the set of all possible excess rates of return available at time t.The problem inverse to (34) is then formulated as follows. Let X*(t) be the excess rate of return of the optimal portfolio att∈T. If X*(t) is known for eacht∈T,find ρ such that X*(t) is optimal in (34) for eacht∈T. The requirement of the optimality of X*(t) can be replaced by a weaker condition that for eacht∈T,X*(t) belongs to the investor’s acceptance set. Then the investor’s risk envelope can be recovered as(35)Q={Q∈QM|E[QX*(t)]⩾0∀t∈T},whereQM⊂QMAXis specified by extra constraints that the investor may wish to add.If the set (35) is empty, then investor’s risk preferences are incompatible with coherent risk measures and the investor may opt for an approximate solution by replacing 0 in the right-hand in (35) side by some ϵ < 0.Example 3In the settings of Example 1(i), letXt=(x1t,…,xTt)be the excess rate of return of the portfolio that the investor held at timest=1,2,…,t0. Then the investor’s risk envelope (35)withQM=QMAXis given by(36)Q={Q=(q1,…,qT)|∑j=1Tqjxjt⩾0,t=1,…,t0,∑j=1Tqj=T,q1⩾0,…,qT⩾0}.Suppose that the investor holds a portfolio with the rate of return X* for the lastt0=20weeks. We use (36) witht0=20,T=182−20=162,andxjt=xj+t−1*,j=1,…,T,t=1,…,t0to determine the risk envelopeQ. Fig. 2a showsthree random elements fromQ. Fig. 2b shows three elements fromQwhen additional constraints0⩽q1⩽q2⩽⋯⩽qT,giving more weight to more recent observations, are added to (36). The horizontal axis denotes scenariosj=1,…,T,while the vertical one denotes the values of the corresponding qj-s.Suppose that a solution ρ to the inverse problem (19) is sought in the form of mixed CVaR (14). If the underlying probability space Ω is finite uniform, which is typically the case in the scenario-based apparoch, such a solution always exists, provided that there exists a law-invariant solution, see Proposition 2. We assume thatα1,…,αmin (14) are fixed, so that the problem reduces to findingλ1,…,λm.In this case, any element Q of the risk envelopeQcan be represented by(37)Q=∑j=1mλjQj,where Qjbelongs to the risk envelopeQjofCVaRαjgiven by(38)Qj={Q∈L1(Ω)|E[Q]=1,Q∈[0,1/αj]},j=1,…,m.Then the optimality conditions (22) can be written as(39)∃Q1,…,QmsuchthatE[Qj]=1,Qj∈[0,1/αj],j=1,…,m,∑j=1mE[riλjQj]⩽−∑j=1mλjCVaRαj(X*),i=1,…,n,which, with new variablesS1=λ1Q1,…,Sm=λmQm,simplifies to a linear system of equations and inequalities forλ1,…,λm,S1,…,Sm:(40)∑j=1mE[riSj]⩽−∑j=1mλjCVaRαj(X*),i=1,…,n,E[Sj]=λj,Sj∈[0,λj/αj],j=1,…,m,∑j=1mλj=1,λ1⩾0,…,λm⩾0.Example 4Let Ω be finite uniform as in Example 1. Then Proposition 3 implies that a law-invariant solution ρ to (19), if exists, can be found in the form (14) withm=Tandαj=j/T,j=1,…,T,and withλ1,…,λTfound from (40). This ρ can be equivalently represented in the spectral form (6) withϕ(α)=T∑j=iTλj/jforα∈[j−1T,jT),j=1,…,T. If, in addition, the rate of returnX=(x1,…,xT)of some instrument is required to be in the acceptance set of ρ, the system (40) includes extra constraint ρ(X) ≤ 0. As in Example 1, letn=92andT=182.(i)ForX*=(x1*,…,xT*),being the rate of return of the optimal mean-variance portfolio (see Example 1(i)), the system (40) has a solution, and the found weights in mixed CVaR (14) are shown in Fig. 3a, whereas the the weight function ϕ(α) of the same solution in the dual utility form (6) is depicted in Fig. 3b. Fig. 4 shows how the weight function in the dual utility (6) changes whenX=1n∑i=1nriis included in the acceptance set (in this case, the system (40) includes extra contsraint ρ(X) ≤ 0).ForX*=(x1*,…,xT*),being the rate of return of the FTSE 100 index (see Example 1(ii)), the system (40) has no solution.In general, the system (40) may have no solution in the following cases:(a)If there existsY∈Xsuch that (24) holds, the inverse problem (19) has no solution in the form of mixed CVaR (5), and therefore, there is no solution in the form (14). This is the case in Example 4 (ii).For a general probability space, the inverse problem (19) may have no solution in the form (14) even if conditions (a)–(e) in Proposition 2 hold.If the probability space Ω is finite uniform with T atoms, and the inverse problem (19) has a law-invariant solution, then the solution can be chosen in the form (14) withm=Tandαj=j/T,j=1,…,T. Obviously, this does not apply when m< T.In these cases, the investor may seek to find an approximate solution to the inverse problem (19). There are at least three different approximation approaches.Suppose conditions (a)–(d) in Proposition 2 hold, so that the inverse problem (19) has an exact solution ρ* in the form of mixed CVaR (5). Then an approximate solution ρ in the form (14) with fixed m can be found by minimizing the distance to ρ* in the space of risk measures:(41)minρ∈Rd(ρ*,ρ),where d( ·, ·) is a metric defined byd(ρ1,ρ2)=supX∈L∞(Ω):|X|⩽1|ρ1(X)−ρ2(X)|,andRis either the 2m-parameter family of all risk measures (14) with fixed m or the m-parameter family of all risk measures (14) with fixed m and fixedα1,…,αm. In Grechuk and Zabarankin (2014), the problem (41)was formulated for deviation measures (Rockafellar et al., 2002, 2006a) and was reduced to finding a piecewise linear approximation of a convex function on (0, 1). The drawback of this approximation approach is that it requires knowing the exact solution ρ*, which, moreover, may not exist.An alternative formulation of the inverse problem (19) is: given optimal (preferred) rate of returnX^∈X,find suchρ∈Rthat a solution X* of (16) has the least underperformance with respect toX^:(42)minρ∈R,X*∈X∥[X*−X^]−∥psubjecttoX*∈argminX∈Xρ(X),whereRis the m-parameter family of all risk measures (14) with fixed m and fixedα1,…,αm,[t]−=max{0,−t},and ‖ · ‖pis theLp-norm with some p∈ [1, ∞] (typically,p=1orp=∞). The objective function∥[X*−X^]−∥pcan be replaced by any other suitable functionf(X^,X*).In fact, the problem (42) can be viewed as optimal tracking control, in whichX^and ρ are a target and a control “variable,” respectively, or even as shape optimization, whereλ1,…,λmconstitute the “risk shape.” However, the disadvantage of the optimization problem (42) is that its objective value as a function ofλ1,⋯λn:(43)f(λ1,…λn)=minX*∈argminX∈Xρ(X)∥[X*−X^]−∥pis non-convex and even discontinuous. The following example shows that the function (43) has its minimum exactly at a point of removable discontinuity, which is unlikely to be found by standard optimization methods.Example 5LetΩ=(ω1,ω2)withP[ωi]=1/2,p=∞,n=2,r0=0,r1=(0,0),r2=(−1,2),X^=23r1+13r2=(−1/3,2/3),m=2,α1=0,α2=1,λ1=λ,λ2=1−λ. Suppose short sales are not allowed. Then the objective function (43)is given by(44)f(λ)={2/3,λ∈[0,1/3)∪(1/3,1],0,λ=1/3.Detail In this case, mixed CVaR (14) takes the formρ(X)=λ1CVaR0(X)+λ2CVaR1(X)=λ(−infX)+(1−λ)(−E[X]),λ ∈ [0, 1], andX={X|(1−x)r1+xr2=(−x,2x),x∈[0,1]},so thatρ(X)=λ(−(−x))+(1−λ)(−(x/2))=x(3λ−1)/2. Thus,X*=(−x*,2x*)is an optimal rate of return, wherex*=1when λ ∈ [0, 1/3), x* ∈ [0, 1] whenλ=1/3,andx*=0when λ ∈ (1/3, 1], and the optimal value of (43) is determined byf(λ)=∥[(−1,2)−(−1/3,2/3)]−∥∞when λ ∈ [0, 1/3),f(λ)=0whenλ=1/3,andf(λ)=∥[(0,0)−(−1/3,2/3)]−∥∞when λ ∈ (1/3, 1], which simplifies to (44).In the next section, the problem (42) is “modified” into a convex one: instead of minimizing distance in the space of r.v.’s, we can approximate the value of an optimal risk measure for a givenX^.For givenX^∈X,a solutionρ∈Rcan be sought to minimizeρ(X^)−ρ(X*)forX*∈argminX∈Xρ(X):(45)minρ∈R,X*∈X(ρ(X^)−ρ(X*))subjecttoX*∈argminX∈Xρ(X).LetXbe given by (17). Then with the optimality conditions (22), the problem (45) can be written as(46)minρ∈R,X*∈X(ρ(X^)−ρ(X*))subjectto∃Q∈Qρ:E[riQ]⩽−ρ(X*),i=1,…,n,whereQρis the risk envelope of ρ. This problem is equivalent to(47)minρ∈R,X*∈X,Q∈Qρ(ρ(X^)−ρ(X*))subjecttoE[riQ]⩽−ρ(X*),i=1,…,n,or, with a new variablez=ρ(X^)−ρ(X*),to(48)minz∈R,ρ∈R,X*∈X,Q∈Qρzsubjecttoz=ρ(X^)−ρ(X*),E[riQ]+ρ(X^)−z⩽0,i=1,…,n.SupposeRis the family of all risk measures (14) with fixed m and fixedα1,…,αm. WithΛ={λ=(λ1,…,λm)|∑i=1mλi=1,λi⩾0,i=1,…,m},the problem (48) reduces to(49)minz∈R,λ∈Λ,X*∈X,Q∈Qλzsubjecttoz=ρλ(X^)−ρλ(X*),E[riQ]+ρλ(X^)−z⩽0,i=1,…,n,whereρλ(X)=∑j=1mλj(CVaRαj(X))andQλis the corresponding risk envelope.The variable X* in (49) is included only in the constraintz=ρλ(X^)−ρλ(X*)and can always be chosen to satisfy it, so that the problem (49) simplifies to(50)minz∈R,λ∈Λ,Q∈QλzsubjecttoE[riQ]+ρλ(X^)−z⩽0,i=1,…,n,see Appendix A for the proof of the equivalence of (49) and (50).The problem (50) has an interesting interpretation: it seeks to find a risk measure ρλfor which the optimality conditions (22) can be satisfied forX^as accurately as possible.Using (40), we can rewrite (50) as(51)minz,λ1,…,λm,S1,…,Smzsubjectto∑j=1mE[riSj]+∑j=1mλjCVaRαj(X^)−z⩽0,i=1,…,n,E[Sj]=λj,Sj∈[0,λj/αj],j=1,…,m,∑j=1mλj=1,λ1⩾0,…,λm⩾0.For a discrete probability space, (51) simplifies to a linear program.Example 6In the settings of Example 1(ii), letXbe a feasible set with no short positions:X={X=(x1,…,xT)|xt=∑i=1nritvi,t=1,…,T,∑i=1nvi=1,v1⩾0,…,vn⩾0},X^∈Xbe the rate of return of the FTSE 100 index, andm=5,α1=0.01,α2=0.05,α3=0.2,α4=0.5,andα5=1. Then optimalλ1,…,λ5in (14) can be found from (51) and yieldρ=0.011CVaR0.01+0.008CVaR0.05+0.069CVaR0.2+0.149CVaR0.05+0.763CVaR1.If the probability space Ω is finite uniform with T atoms,m=T,andαj=j/T,j=1,…,T,then the optimal value in (51) is zero if and only if condition (b) in Proposition 2 holds. In other words, (51) is a linear programming test to determine whetherX^is SSD-efficient withinX. In contrast to the existing SSD-efficiency tests Grechuk (2014); Kopa and Chovanec (2008); Post (2003), (51)has the advantage to return an explicit optimal risk measure (or dual utility) for SSD-efficient portfolios as well as an “approximately optimal” risk measure for inefficient ones. In the later case, the optimal value in (51) can also be interpreted as a measure of SSD-inefficiency forX^.LetY⊂Rmbe given byY={y=(y1,…,ym)|∃X∈X:CVaRαj(X)⩽yj,j=1,…,m}.Then the inverse portfolio problem (19) has an exact solution in the form (14) if and only if the pointy(X*)=(CVaRα1(X*),…,CVaRαm(X*))lies on the boundary ofY. Indeed, if y(X*) is in the interior ofY,thenCVaRαj(X*)⩾CVaRαj(X′)+ϵ,j=1,…,m,for someX′∈Xand ϵ > 0, so thatρ(X*)⩾ρ(X′)+ϵfor any ρ admitting the form (14), hence, X* cannot be optimal. Conversely, if y(X*) is on the boundary of a (convex closed) setY,then there exists a supporting hyperplane forYthrough y(X*), and the coefficientsλ1,…,λmin the equation of that hyperplane are exactly the coefficients of the desired risk measure ρ in (14).Now letX^be a portfolio such thaty(X^)is in the interior ofY,so that an exact solution of the inverse problem (19) does not exist and we seek to find an approximate one. The problem (42) is then asks for a point on the boundary ofY,which is “closest” to the given pointy(X^)in its interior, where a measure of closeness can be defined in different ways. In contrast, the problem (45) requires finding a hyperplaneAthat containsy(X^)such that the distance fromAto the supporting hyperplane parallel toAis as small as possible.The first approach identifies a risk measure ρ1 such that optimal portfolio with ρ1 is as “close” toX^as possible, i.e. a similar portfolio is optimal, whereas the second approach finds a risk measure ρ2, such that riskρ2(X^)is as close to the optimal risk as possible, i.e. a given portfolio is almost optimal.This work has proposed to identify agent’s risk preferences in the form of a coherent risk measure by solving the inverse portfolio problem in single-period and multi-period formulations. The negative coherent risk measure is viewed as agent’s utility functional and can be recovered either through identifying a convex set of admissible probability measures (so-called risk envelope) or through finding either the risk profile in mixed CVaR or the weight function in negative Yaari’s dual utility (the last two representations are law-invariant coherent risk measures and may not exist). The inverse portfolio problem assumes that the rate of return of the portfolio that the agent is most satisfied with minimizes the sought coherent risk measure and is given as a sequence of known random variables (r.v.’s) for the multi-period case (single r.v. for the single-period case). In Examples 1–4 and 6, the coherent risk measure is recovered in all three forms based on the weekly historical rates of return of a portfolio formed by 92 stocks from the FTSE 100 index for the period from 3-January-2011 to 30-June-2014. As a future research, the suggested inverse portfolio problem approach can be extended to identifying risk preferences in the frameworks of other decision theories.

@&#CONCLUSIONS@&#
