@&#MAIN-TITLE@&#
Birational quadrilateral maps

@&#HIGHLIGHTS@&#
We show how to make a quad map be birational by assigning one control point weight.The weight is computed using a simple closed-form equation.For convex quads, the weight is positive and the pre-image is the[0,1]×[0,1]domain.Any planar quad mesh can be made piecewiseC0birational by using this method.

@&#KEYPHRASES@&#
Quadrilateral meshes,Birational map,

@&#ABSTRACT@&#
A generic planar quadrilateral defines a 2:1 bilinear map. We show that by assigning an appropriate weight to one vertex of any planar quadrilateral, we can create a map whose inverse is rational linear.

@&#INTRODUCTION@&#
A planar quadrilateral with verticesPij=(xij,yij)defines a bilinear map(1)P(s,t)=P00s¯t¯+P10st¯+P01s¯t+P11stwheres¯=(1−s)andt¯=(1−t). If the quad is a trapezoid, the map is 1:1. Otherwise, the map is generally 2:1 and the inverse involves a square root (Wolberg, 1990). For point E in Fig. 1.a,s=x−4y+36±f(x,y)24,t=−x+4y+36±f(x,y)32,wheref(x,y)=x2−8xy+16y2−72x−96y+1296. So E has pre-images(s,t)=(13,34)and(s,t)=(2,2). Fig. 1.b shows that E lies on two different t-isoparameter lines:t=34andt=2.This paper proves that assigning a weightwijto one control point, the map defined by any non-degenerate quadrilateral can be forced to be generally 1:1 with a rational linear inverse.For example, in Fig. 2.a we assignw01=53to the quad in Fig. 1. In this case, point E lies on a single s- and t-isoparameter line. The inversion equations ares=3x−4y26−4yandt=2y20−xand the pre-image of E is(s,t)=(25,23). This is an example of a birational map, meaning that both the map and its inverse can be expressed as a polynomial divided by a polynomial.As illustrated in Fig. 2.a, birational quadrilateral maps are characterized by the fact that each family of isoparameter lines form a pencil, that is, they pivot about axis pointsAsandAt, respectively. We now show how those pencils can be created by assigning a single control point weight.Given a tripleQ=(a,b,c)of homogeneous projective coordinates,Point(Q)denotes the point whose Cartesian coordinates are(a/c,b/c)andLine(Q)denotes the lineax+by+c=0. Given triplesQ1andQ2,Line(Q1)andLine(Q2)intersect atPoint(Q1×Q2)andPoint(Q1)andPoint(Q2)lie onLine(Q1×Q2). The projective coordinates robustly express the intersection of two parallel lines as a point at infinity, i.e., a point for whichc=0.IfQ1⋅Q2=0,Point(Q1)lies onLine(Q2). IfQ(t)=(a(t),b(t),c(t))is a triple of polynomials,Point(Q(t))is a rational curve andLine(Q(t))is called a moving line (Sederberg et al., 1994), i.e., a line that moves as a function of t. DenotingQij=(xij,yij,1)andQ˜ij=wijQij,(2)Q(s,t)=Point(Q˜00s¯t¯+Q˜10st¯+Q˜01s¯t+Q˜11st)defines a rational bilinear map. In Fig. 2.b,(3)As=(Q˜00×Q˜01)×(Q˜10×Q˜11),At=(Q˜00×Q˜10)×(Q˜01×Q˜11),Bs(s)=s¯Q˜01+sQ˜11,Cs(s)=s¯Q˜00+sQ˜10,Bt(t)=s¯Q˜10+sQ˜11,Ct(t)=s¯Q˜00+sQ˜01.For a generic quadrilateral, the families of s- and t-isoparameter lines areLine(Is(s))andLine(It(t)), whereIs(s)=Bs(s)×Cs(s),It(t)=Bt(t)×Ct(t).Line(Is(s))is a pencil with axisPoint(As)ifAs⋅Is(s)≡0. This implies(4)w01w10As⋅Q01×Q10+w11w00As⋅Q11×Q00=0orw00w11w01w10=As⋅Q01×Q10As⋅Q00×Q11.Likewise,Line(It(t))is a pencil with axisPoint(At)if(5)w00w11w01w10=At⋅Q10×Q01At⋅Q00×Q11.Letting|ABC|denoteA×B⋅C, and applying to (3) the identity(A×B)×(C×D)=(A⋅(B×D))C−(A⋅(B×C))D,(4) and (5) become equivalent to(6)w00w11w01w10=|Q01Q00Q10||Q10Q11Q01||Q11Q01Q00||Q00Q10Q11|=ρwhere ρ is a constant. For trapezoids,ρ=1so all weights can be one.The main contribution of this paper is the observation that if (6) holds,Line(Is(s))andLine(It(t))each form a pencil. Hence the map (2) is birational and we can find rational linear inversion equations as follows. If (6) holds and no three vertices are collinear,(7)Line(Is(s))=Line(As×Bs(s))=Line(As×Cs(s)).PointP=(x,y,1)lies onLine(Is(s))at the value of s for which|AsBs(s)P|=0:(8)s=|AsQ˜01P||AsQ˜01P|−|AsQ˜11P|.P also lies onLine(Is(s))at the value of s for which|AsCs(s)P|=0:(9)s=|AsQ˜00P||AsQ˜00P|−|AsQ˜10P|.In similar manner, we obtain two inversion equations for t as(10)t=|AtQ˜10P||AtQ˜10P|−|AtQ˜11P|(11)t=|AtQ˜00P||AtQ˜00P|−|AtQ˜01P|.If no three vertices are collinear, (8) and (9) produce the same value of s and (10) and (11) produce the same value of t, so all four are valid inversion equations. IfQ10,Q11, andQ01are collinear, as shown in Fig. 3.a, (6) requiresw11=0and the geometry producesAs=Q01andAt=Q10. Consequently, (9) and (11) are valid inversion equations but (8) and (10) are not. The same discussion applies to the “hanging” vertex example in Fig. 3.b.In the case of a non-convex quadrilateral, the weight of the concave vertex is negative, as illustrated in Fig. 4.a. While the inversion equations work in this case, only points within the region bounded by quadrilateralQ00AtQ11Ashave pre-images in the[0,1]×[0,1]domain. The inversion equations work properly in the self-intersection case shown in Fig. 4.b, and the pre-image of each point in the twisted quadrilateral lie in the[0,1]×[0,1]domain. In this example, all weights are positive, even though two of the triple-products in (6) are negative. We can also satisfy (6) by assigningw10=w01=−2, however the inversion equation for s applied to points in the twisted quadrilateral lie outside[0,1].The birational maps we have presented are generally 1:1, but not everywhere. PencilsLine(Is(s))andLine(It(t))have one line in common:Line(As×At). From (8)–(11), all points on that line have an s parametersˆ=s=|AsQ˜01At||AsQ˜01At|−|AsQ˜11At|=|AsQ˜00At||AsQ˜00At|−|AsQ˜10At|,and a t parametertˆ=|AtQ˜10As||AtQ˜10As|−|AtQ˜11As|=|AtQ˜00As||AtQ˜00As|−|AtQ˜01As|.Thus, point(s,t)=(sˆ,tˆ)“blows up” toLine(As×At).Since all s-isoparameter lines pass throughAsand all t-isoparameter lines pass throughAt, the pre-image ofAsis the linet=tˆand the pre-image ofAtis the lines=sˆ. In other words,Point(As)=Point(Q(s,tˆ)),Point(At)=Point(Q(sˆ,t)).The map (2) is bilinear in s, t. If we convert (2) to power basis, the st coefficient isQ˜00−Q˜10−Q˜01+Q˜11, which vanishes if(12)w00Q00−w10Q10−w01Q01+w11Q11=0.The general-case solution to (12) is(13)w00:w10:w01:w11=|Q10Q01Q11|:|Q00Q01Q11|:|Q00Q11Q10|:|Q00Q01Q10|The fact that a quad map (2) is affine if it satisfies (13) is algebraically equivalent to a well-known result for mapping the vertices of a quad to the vertices of a square by solving a4×4linear system (Wolberg, 1990). Affine maps are birational, and weights that satisfy (13) also satisfy (6).

@&#CONCLUSIONS@&#
