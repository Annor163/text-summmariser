@&#MAIN-TITLE@&#
Endoluminal surface registration for CT colonography using haustral fold matching

@&#HIGHLIGHTS@&#
Novel haustral fold matching algorithm.Achieves 96.1% mean accuracy over 1743 reference points in 17 CTC datasets.New initialisation to non-rigid intensity-based surface registration method.Full method shows 6.0mm mean error.Use of initialisation shows significant improvement (p<0.001).

@&#KEYPHRASES@&#
CT colonography,Markov random field,Haustral fold,Landmark,Registration,

@&#ABSTRACT@&#
Computed Tomographic (CT) colonography is a technique used for the detection of bowel cancer or potentially precancerous polyps. The procedure is performed routinely with the patient both prone and supine to differentiate fixed colonic pathology from mobile faecal residue. Matching corresponding locations is difficult and time consuming for radiologists due to colonic deformations that occur during patient repositioning.We propose a novel method to establish correspondence between the two acquisitions automatically. The problem is first simplified by detecting haustral folds using a graph cut method applied to a curvature-based metric applied to a surface mesh generated from segmentation of the colonic lumen. A virtual camera is used to create a set of images that provide a metric for matching pairs of folds between the prone and supine acquisitions. Image patches are generated at the fold positions using depth map renderings of the endoluminal surface and optimised by performing a virtual camera registration over a restricted set of degrees of freedom. The intensity difference between image pairs, along with additional neighbourhood information to enforce geometric constraints over a 2D parameterisation of the 3D space, are used as unary and pair-wise costs respectively, and included in a Markov Random Field (MRF) model to estimate the maximum a posteriori fold labelling assignment.The method achieved fold matching accuracy of 96.0% and 96.1% in patient cases with and without local colonic collapse. Moreover, it improved upon an existing surface-based registration algorithm by providing an initialisation. The set of landmark correspondences is used to non-rigidly transform a 2D source image derived from a conformal mapping process on the 3D endoluminal surface mesh. This achieves full surface correspondence between prone and supine views and can be further refined with an intensity based registration showing a statistically significant improvement (p<0.001), and decreasing mean error from 11.9mm to 6.0mm measured at 1743 reference points from 17 CTC datasets.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
We present a novel method for establishing correspondence between two CT colonography acquisitions with the patient in prone and supine positions. First, haustral folds are segmented with a graph-cut method applied to a triangular mesh representation of the colonic lumen segmentation. The method uses depth map images to drive a virtual camera optimisation to provide a unary cost value for the matching of folds between the two views. An additional pair-wise cost function compares the geometric relationship between pairs of haustral folds in the prone and supine CTC images. A parametrisation of the image space exploits the quasi-cylindrical form of the colon and simplifies the description of this geometric relationship by reducing the dimensionality from 3D to 2D. The problem is modelled using a Markov Random Field, and a Belief Propagation algorithm used to estimate the optimal labelling. This process can establish an accurate correspondence between the a set of positions in the two views even in cases where endoluminal collapse occurs, which is very common in clinical practice. We have also given an example of how this method can be applied to initialise a dense intensity-based registration technique, in this case a surface-based method, and show that it significantly reduces mean registration error. While the intensity-based registration method alone can be susceptible to misregistration by one or more haustral folds (Fig. 10), or by a degree of rotation around the tenaie coli, the new composite method defends against this problem by using a landmark-based initialisation. Moreover, the initialisation could be generalisable to other registration methods.The work flow presented is fully automated, taking as input a prone and supine colon lumen segmentation, and in disconnected cases, the ordering of those segments. The consistency of results across cases exhibiting varying characteristics indicates that the composite method is more robust than those previously reported, especially in more ‘difficult’ cases showing marked differences in distension, or exhibiting areas of endoluminal collapse. This situation is very common in routine practice and algorithms must be able to cope in order to have clinical utility.Although algorithm performance is similar for both well-distended cases and those cases exhibiting one or more areas of endoluminal collapse, the number of identified corresponding folds can decrease. In future work we will investigate inclusion of an additional unary prior based on the relative location of stable anatomical landmarks to aid MRF convergence and increase the number of output correspondences in difficult cases. The current method relies on manual ordering of collapsed segments, so a proposed extension will automatically find their order using the same MRF model. It would also be interesting to investigate an interactive system such that landmark points could be selected manually on the virtual colonoscopic views, and used in the MRF optimisation. We will also research MRF optimisation schemes that include the inverse consistency constraint directly in the optimisation, rather than after algorithm convergence.To conclude, we have presented a novel method for matching haustral folds between prone and supine CT colonography acquisition. We give an example of how this may be used to improve the results of a full surface-based registration by validation using a set of 1743 reference standard points over 17 patient cases exhibiting a variety of characteristics.