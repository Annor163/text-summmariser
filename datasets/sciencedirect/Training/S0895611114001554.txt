@&#MAIN-TITLE@&#
Interactive 3D medical data cutting using closed curve with arbitrary shape

@&#HIGHLIGHTS@&#
We mix octree and quad-tree to make cutting operation in real-time.2D mask image and coordinate transformation make users cut 3D volume data in 2D space.The cutting method could improve the accuracy of image segmentation algorithms.The cardiac images segmented results can be used to evaluate cardiac function quantitatively and be more conducive for diagnosis and treatment of cardiac disease.

@&#KEYPHRASES@&#
Interactive 3D cutting,Binary mask image,Coordinate transformation,Octree decomposition,Image segmentation,

@&#ABSTRACT@&#
Interactive 3D cutting is widely used as a flexible manual segmentation tool to extract medical data on regions of interest. A novel method for clipping 3D medical data is proposed to reveal the interior of volumetric data. The 3D cutting method retains or clips away selected voxels projected inside an arbitrary-shaped closed curve which is clipping geometry constructed by interactive tool to make cutting operation more flexible. Transformation between the world and screen coordinate frames is studied to project voxels of medical data onto the screen frame and avoid computing intersection of clipping geometry and volumetric data in 3D space. For facilitating the decision on whether the voxels should be retained, voxels through coordinate transformation are all projected onto a binary mask image on screen frame which the closed curve is also projected onto to conveniently obtain the voxels of intersection. The paper pays special attention to optimization algorithm of cutting process. The optimization algorithm that mixes octree with quad-tree decomposition is introduced to reduce computation complexity, save computation time, and match real time. The paper presents results obtained from raw and segmented medical volume datasets and the process time of cutting operation.

@&#INTRODUCTION@&#
Volume clipping is typically used in visualizing medical data, preparing surgical plans and processing images, because it conveniently clips away selected parts of volume data. Volume clipping is also a useful approach in exploring the interior details of volume data [1]. Accurate volume data clipping can meet users’ requirements to design more complicated volume model by cutting and pasting existing volume data [2]. Combined with image segmentation algorithms, clipping operation can be used as a pre-processing step to extract region of interest (ROI) in volume images, such as tumor organizations or important brain functional areas. Just because volume cutting plays an so important role to remove and carve the occluding materials and extract different regions of interest [4,9], we explore a 3D cutting tool in depth which can arbitrarily select volume data and cut them away in real-time. Moreover, the cutting algorithm introduced in the paper has been experimented to reveal hidden parts of brain volume data for surgical planning and extract cardiac chambers from heart volume images effectively.Most volume clipping methods use common clipping geometry that can be structured by implicit functions to clip medical images. Many researchers had used a set of volumetric data clipping methods, including plane, bounding box, ball, and contour surface cutting [3]. Several methods based on volumetric textures and depth fields constructed various geometric primitives to cut unwanted volumetric data away [4]. However, depth-based clipping methods hardly handled concave geometry clipping. To solve the problem, Xie et al. [5] proposed a clipping method that uses the clipping distance field to represent clipping geometry and implement a clipping algorithm on the fragment shader. McGuffin et al. [6] presented a method for browsing the interior of volumetric data with interactive manipulation widgets. Some researchers also presented multifunctional tools to segment volume data flexibly. Huff et al. [7] exploited programmable hardware and proposed three tools (eraser, digger, and clipper) to uncover hidden structures in volume images. Correa et al. [8] proposed a collection of operators (peeler, retractors, pliers, and dilators) that can be placed anywhere on or within volume data. Chen et al. [9] utilized point radiation techniques and interactive parallel region growing algorithm to extract different regions of interest. There were also some researchers combine sketch-lines with subdivision surface to create novel envelops to cut unwanted region away [10]. Users needed to define the depth of penetration into the volume image before the cutting technique was implemented. The painting metaphor defined a selection tool that is similar to “brush strokes” to select voxels [11]. In some of the commercial medical image processing software, for example, zioTerm, similar cutting approaches based on closed curve were adopted to clip away or retain selected data. Industrial design software, such as AutoCAD, used mesh, curved surface or other 3D model to cut objects through intersecting them. Many approaches had been proposed to simulate the cutting process of deformable objects and mesh data. Zhang et al. [12] proposed a hybrid cutting method combining non-progressive cutting with progressive cutting for the real-time simulation of soft-tissue cutting. The method that dynamically modifying the mesh topology of deformable objects achieved better simulation effects [13]. Lenka et al. [14] used two synchronized geometrical models at different resolutions to simulate the interactive cutting of viscoelastic objects.In this paper, a flexible and timesaving method adopting free closed curve is proposed to address two main issues in clipping 3D medical images, namely, (1) finding the correspondence between clipping geometries and volume data in 2D space, and (2) reducing computation complexity and saving computation time.The proposed method differs from those using common clipping geometries, which mainly uses an interactive tool to draw an arbitrary closed curve to retain or clip away volume data. Thus, the clipping geometry can be convex or concave. A binary mask image with same size as the rendering window is built according to the closed curve to conveniently compute the coordinate relationship between the volume data and the closed curve in screen frame. The 2D screen coordinates of volume data are computed by the transformation from the world coordinate frame to the screen coordinate frame. To increase cutting speed and reduce computation complexity, the optimization algorithm mixing octree with quad-tree decomposition is introduced to decompose eligible volume data. Octree has been widely utilized as spatial data structure for organizing 2D or 3D data, such as in ray tracing [15], mesh simulation [16], mesh coding [17], and geometric modeling [18–20]. Eligible octants are decomposed to eight parts, and the other octants are clipped away or retained according to their coordinate relationship with the closed curve.The rest of the paper is organized as follows: Section 2 introduces the proposed volume clipping algorithm, which includes filling the closed curve geometry, transforming the coordinate system, and using the optimization algorithm to decompose volumetric data. Section 3 describes how it can perform multiple cutting. Section 4 describes several experiments, including manually segment cardiac images, and Section 5 presents our conclusions.

@&#CONCLUSIONS@&#
