@&#MAIN-TITLE@&#
Statistical procedures for the market graph construction

@&#HIGHLIGHTS@&#
The market graph construction is investigated as a multiple decision statistical procedure.The multiple decision problem is reduced to the family of two-decision problems.Multiple decision statistical testing is reduced to generating hypothesis testing.The market graph construction procedure is optimal as a multiple decision statistical procedure.Compatibility conditions and additivity of the loss function are discussed theoretically and numerically.

@&#KEYPHRASES@&#
Market graph,Unbiased statistical tests,Multiple decision statistical procedures,Generating hypotheses,Additivity of the loss function,Conditional risk,

@&#ABSTRACT@&#
The statistical analysis of the method of construction of the market graph when considered as a multiple decision statistical procedure is investigated. It is shown that under the condition of additivity of the loss function the method can be optimal in different classes of unbiased multiple statistical procedures. The results are obtained by application of the Lehmann theory of multiple decision procedures to the method of construction of the market graph. The main findings are illustrated by numerical studies of the conditional risk of multiple decision statistical procedures for different loss functions and different return distributions.

@&#INTRODUCTION@&#
Stock market models have attracted great attention in mathematical modeling since the seminal work by Markowitz (1952). An important characteristic of these models is the analysis of simultaneous behavior of the stocks based on their correlations. At the same time, the stock market can be considered as a complex network where the stocks are the nodes of the network and the correlation is a measure of similarity between them (Mantegna, 1999; Mantegna and Stanley, 2000; Tumminello et al., 2010). In the paper Boginsky et al. (2003) a new model for the analysis of the stock market was introduced. The method involves the construction of the market graph associated with the stock market and the investigation of the structural characteristics (cliques, independent sets and others) of this graph. This method was recently developed by Boginsky et al. (2005), Boginsky et al. (2006), and Huang et al. (2009); see also Bautin et al. (2013) and Vinciotti and Hashem (2013).The main goal of the present paper is the investigation of the market graph construction from a statistical point of view. We consider a market graph construction as a multiple decision procedure. In our investigation we consider the class of unbiased statistical procedures in the sense of Lehmann (1951) and Lehmann and Romano (2005a). As a model of the financial market we use the Markowitz type model (Markowitz, 1952, 2010). We call a true market graph the graph with the incidence matrix with entries 0 and 1, where we have 0 if the associated correlation is less than a given threshold and 1 otherwise. In Boginsky et al. (2003) the authors use a sample market graph constructed in the same way from the sample correlations. We show that the procedure of this type can be made optimal in the class of unbiased multiple decision statistical procedures. This result is obtained by application of the Lehmann theory of multiple decision problems to the method of construction of the market graph. In the framework of the Lehmann theory (Lehmann, 1957) we discuss the following conditions of optimality for the multiple decision statistical procedures: choice of the generating hypotheses, compatibility of the family of tests for the generating hypotheses with decision space for the original hypotheses, and additivity of the loss function. We prove that the multiple decision statistical procedure for the construction of the market graph is optimal if one uses the tests of the Neyman structures. From the other hand, in practice it is more convenient to use classical unbiased correlation tests. We prove that the associated multiple decision statistical procedure is also optimal, but in a restricted class of unbiased multiple decision statistical procedures.The paper is organized as follow. In Section  2 we introduce the market graph and give a formal statement of the problem. In Section  3, we recall some basic concepts from the Lehmann theory (Lehmann, 1957). In Section  4, we study (from a statistical point of view) the method of construction of the market graph. In Section  5, we present results of numerical simulation and discuss the conditional risk of described statistical procedures. In the last Section  6, we summarize the main results of the paper.LetNbe the number of stocks in the financial market, and letnbe the number of observations. Denote bypi(t)the price of the stockifor the dayt(i=1,…,N;t=1,…,n)and define the daily return of the stockifor the period from(t−1)totasri(t)=ln(pi(t)/pi(t−1)). We assumeri(t)to be a realization of the random variableRi(t). We define the sample spaceRN×nwith elements(ri(t)). We consider the standard assumptions: the random variablesRi(t),t=1,…,nare independent with fixedi, have all the same distribution as a random variableRi(i=1,…,N), and the random vector(R1,R2,…,RN)has a multivariate normal distribution with correlation matrix‖ρi,j‖. The sample correlation between the stocksiandjis defined bysi,j=Σ(ri(t)−ri¯)(rj(t)−rj¯)Σ(ri(t)−ri¯)2Σ(rj(t)−rj¯)2,whereri¯=1n∑t=1nri(t). It is known Anderson (2003), that for a multivariate normal vector the statistics(r1¯,r2¯,…,rN¯)and‖si,j‖are sufficient.Matrix‖ρi,j‖is the matrix for the construction of the true market graph and matrix‖si,j‖is the matrix for the construction of the sample market graph. Each vertex of the graph corresponds to a stock of the financial market. The edge between two verticesiandjis included in the true market graph, ifρi,j>ρ0(whereρ0is a threshold). For the sample graph, from the statistical point of view, it is more natural to consider the following procedure: the edge between two verticesiandjis included in the sample market graph, ifsi,j>ci,j(whereci,jis a threshold). We obtain a market graph construction from Boginsky et al. (2003) in the particular case whereci,j=ρ0,i,j=1,2,…,N.In the present paper we study, from the statistical point of view, the procedure of construction of the sample market graph as a procedure of identification of the true market graph.The problem of identification of the true market graph can be formulated as a multiple decision problem (in the sense of  Lehmann, 1957) of the selection of one from the set of hypotheses:(1)H1:ρi,j<ρ0,∀(i,j),i<j,H2:ρ12>ρ0,ρi,j<ρ0,∀(i,j)≠(1,2),i<j,H3:ρ12>ρ0,ρ13>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,2),(i,j)≠(1,3),…HL:ρi,j>ρ0,∀(i,j),i<j,whereL=2MwithM=N(N−1)/2. Together these hypotheses describe all possible true market graphs. In this setting, the problem is to construct a statistical procedure to choose the true market graph.Suppose that the distribution of a random vector is taken from the parametric familyf(x,θ):θ∈Ω, whereθis a parameter,Ωis the parametric space. We are looking for the construction of the statistical procedure for the selection of one from the set ofLhypotheses:(2)Hi:θ∈Ωi,i=1,…,L,Ωi∩Ωj=0̸,i≠j,⋃i=1LΩi=Ω.This is a multiple decision problem. The Lehmann theory is based on three concepts: generating hypotheses, compatibility conditions, and the additivity condition for the loss function.The multiple decision problem (2) of the choice of one hypothesis from the set ofLhypothesesHi:θ∈Ωi;i=1,…,nis equivalent to M two-decision problems: hypotheses testing(3)Hj′:θ∈ωjvsKj′:θ∈ωj−1,with⋃i=1LΩi=ωj∪ωj−1=Ω,j=1,2,…,M.This equivalence is given by the relations:Ωi=⋂j=1Mωjχi,j,ωj=⋃{i:χi,j=1}Ωi,where(4)χi,j={1,Ωi∩ωj≠0̸,−1,Ωi∩ωj=0̸.The hypothesesHj′:(j=1,…,M)are called generating hypotheses for the problem (2). The choice of generating hypotheses is not unique. Note that forL=2Mit is possible to choose exactlyMgenerating hypotheses.The equivalence between problems (2) and (3) reduces the multiple decision problem to generating hypotheses testing. Any statistical procedureδj′for hypotheses testing ofHj′can be written in the following form(5)δj′(x)={∂j,x∈Xj,∂j−1,x∈Xj−1,where∂jis the decision of acceptance ofHj′and∂j−1is the decision of acceptance ofKj′,Xjis the acceptance region ofHj′andXj−1is the acceptance region ofKj′(rejection region ofHj′) in the sample space. One hasXj∩Xj−1=0̸,Xj∪Xj−1=X,j=1,2,…,M, whereXis the sample space.Define the acceptance region forHiby(6)Di=⋂j=1MXjχi,j,whereχi,jare defined by (4) and we putXj1=Xj. Note that⋃i=1LDi⊂X, but it is possible that⋃i=1LDi≠X.According to the Wald decision theory (Wald, 1950), a nonrandomized multiple decision statistical procedureγ(x)is a mapping from the sample spaceXto the decision spaceD={d1,d2,…,dL}, wherediis the decision of acceptance ofHi,i=1,2,…,L. Any decision functionγ(x)induces a partition of the sample spaceX=⋃i=1LGi,Gi={x∈X:γ(x)=di},i=1,2,…,L.Therefore, ifD1,D2,…,DLdefined by (6) is a partition of the sample spaceX, then one can define the statistical procedureδ(x)by(7)δ(x)={d1,x∈D1,d2,x∈D2,⋯⋯⋯dL,x∈DL.According to Lehmann (1957), we call the family of statistical procedures for generating hypotheses testing compatible with the decision spaceDof multiple decision statistical procedure ifD1,D2,…,DLis a partition of the sample spaceX. Under this compatibility condition there is a one to one correspondence between multiple decision statistical procedures and the family of statistical procedures of generating hypotheses testing. This correspondence is given by the relations(8)Di=⋂j=1MXjχi,j,Xj=⋃{i:χi,j=1}Di.Note that our definition of compatibility is more restrictive than the original definition by Lehmann which reads:Pθ(x∈⋃i=1LDi)=1,θ∈Ω.Example 1This example illustrates the compatibility condition for one non trivial case (Lehmann, 1957). Consider the multiple decision problem with homogeneous parameter:H1:θ<θ0,H2:θ=θ0,H3:θ>θ0.Letx=(x1,x2,…,xn)∈Rnbe a vector of observations. To construct the multiple decision statistical procedure one can use two generating hypothesesH1′:θ≥θ0vsK1′:θ<θ0,H2′:θ≤θ0vsK2′:θ>θ0.According to (2)–(4) one hasω1={θ:θ≥θ0},ω1−1={θ:θ<θ0},ω2={θ:θ≤θ0},ω2−1={θ:θ>θ0},andΩ1=ω1−1∩ω2={θ:θ<θ0},Ω2=ω1∩ω2={θ:θ=θ0},Ω3=ω1∩ω2−1={θ:θ>θ0}.Therefore,χ1,1=−1,χ1,2=1,χ2,1=1,χ2,2=1,χ3,1=1,χ3,2=−1.Note thatω1−1,ω2−1have an empty intersection, i.e.ω1−1∩ω2−1=0̸. We use the Neyman–Pearson approach (Lehmann and Romano, 2005a) for generating hypotheses testing. According to this approach the rejection region forH1′is:T<c1, whereTis a sufficient statistics for the parameterθ, and the critical valuec1is calculated from the equation:Pθ0(T<c1)=α1, whereα1is the significance level of the test. The rejection region forH2′is:T>c2and the critical valuec2is calculated from the equation:Pθ0(T>c2)=α2, whereα2is the significance level of the test. In this case, one hasX1=X11={x∈Rn:T(x)≥c1},X1−1={x∈Rn:T(x)<c1},X2=X21={x∈Rn:T(x)≤c2},X2−1={x∈Rn:T(x)>c2},andD1=X1−1⋂X21,D2=X11⋂X21,D3=X11⋂X2−1.The setsD1,D2,D3form a partition of the sample spaceRnif and only ifc1<c2. Therefore the compatibility condition in this example isc1<c2. This is equivalent to the conditionα1+α2<1.To study optimality we use a conditional risk for the multiple decision statistical procedure (Wald, 1950; Lehmann and Romano, 2005a):(9)Eθw(θ,δ(x))=risk(θ,δ)=∑k=1Lw(θ,dk)Pθ(δ(x)=dk),whereEθis the expectation according to the density functionf(x,θ)andw(θ,dk)is the loss from decisiondkunder the condition thatθis true,θ∈Ω. The conditional risk for the generating hypotheses of the statistical procedureδj′is(10)Eθw(θ,δj′(x))=risk(θ,δj′)={w(θ,∂j)P(δj′(x)=∂j),θ∈ωj−1,w(θ,∂j−1)P(δj′(x)=∂j−1),θ∈ωj,where we supposed thatw(θ,∂j)=0forθ∈ωjandw(θ,∂j−1)=0forθ∈ωj−1.To apply the classical results on hypotheses testing to the case of multiple decision statistical procedures, Lehmann suggested to use the additivity condition for the loss function (Lehmann, 1957):(11)wik=∑j=1M(βikjaj+βkijbj),wherewik=w(θ,dk)forθ∈Ωi,wii=0,aj=w(θ,∂j−1)forθ∈ωj,bj=w(θ,∂j)forθ∈ωj−1andβikj={1,χi,j=1,χk,j=−1,0,otherwise .The conditional risk (9) can be written forθ∈Ωias(12)Eθw(θ,δ(x))=risk(θ,δ)=∑k=1LwikPθ(δ(x)=dk),θ∈Ωi.Using the relations (8) and additivity condition (11) one can prove that(13)risk(θ,δ)=∑j=1M∑k=1L[βikjajPθ(δj′=∂j−1)+βkijbjPθ(δj′=∂j)],θ∈Ωi.This equation implies:(14)Eθw(θ,δ(x))=risk(θ,δ)=∑j=1Mrisk(θ,δj′),θ∈Ω.Now the main result of the Lehmann theory (Lehmann, 1957) can be stated as follows: if the compatibility and additivity conditions are satisfied then the following statements are true:•Ifδj′,j=1,2,…,Mare unbiased, thenδ(x)is unbiased.If all functionsEθw(θ,δj′(x)),j=1,…,Mare continuous onθ, some additional structural properties are satisfied and all two-decisions statistical procedures for the generating hypotheses are optimal in the class of unbiased procedures, then the associated multiple decision statistical procedure is optimal too.These results allow us to construct the optimal multiple decision statistical procedures from the optimal statistical procedures for generating hypotheses testing. We use this in the next section. The Lehmann theory is further developed in Rao and Swarupchand (2009), Lehmann and Romano (2005b), Shaffer (2006) and Romano and Wolf (2007).To investigate the statistical procedures for the market graph construction we put it in the framework of the Lehmann theory. The sample spaceXisRN×nwith the elements(ri(t)). The random variablesRi(t),t=1,…,nare independent for a fixedi, and have all the same distribution as the random variablesRi(i=1,…,N). The random vector(R1,R2,…,RN)has a multivariate normal distribution with correlation matrix‖ρi,j‖. We assume for simplicity thatE(Ri)=0, andσ2(Ri)=1. The parameter spaceΩis the space of positive semi-definite matrices‖ρi,j‖.Ωk, is a domain in the parameters space associated with the hypothesesHkfrom the set (1),k=1,2,…,L,L=2M,M=N(N−1)/2.For the multiple decision problem (1) we introduce the following set of generating hypotheses:(15)hi,j:ρi,j≤ρ0vski,j:ρi,j>ρ0,i,j=1,2,…,N,i<j.For convenience we use the notationhi,jandki,jfor the generating hypotheses (3) in place ofHj′andKj′. In these notations,∂i,jis the decision of acceptance of the hypotheseshi,jand∂i,j−1is the decision of rejection ofhi,j;ai,jis the loss from the rejection of the hypotheseshi,jin the case when it is true andbi,jis the loss from the acceptancehi,jin the case when the alternativeki,jis true. Any test for the two-alternative hypotheses testing (15) can be written in the following form:(16)δi,j={∂i,j,ti,j≤cα∂i,j−1,ti,j>cα,whereti,jis the statistics of the test defined on the sample space,αis the significance level, andcαis defined by the equation(17)Pρ0(Ti,j>cα)=α.There are known tests (Lehmann and Romano, 2005a) for the hypotheses testing of (15). Therefore, one can construct the associated multiple decision statistical procedure. We illustrate it by the following exampleExample 2LetN=3and the hypotheses testing of (15) is made by the classical Pearson correlation tests. Then the multiple decision statistical procedure (7) takes the form:δ(s12,s13,s23)={d1,s12<cα,s13<cα,s23<cα,d2,s12>cα,s13<cα,s23<cα,d3,s12<cα,s13>cα,s23<cα,d4,s12<cα,s13<cα,s23>cα,d5,s12>cα,s13>cα,s23<cα,d6,s12<cα,s13>cα,s23>cα,d7,s12>cα,s13<cα,s23>cα,d8,s12>cα,s13>cα,s23>cα.One hasDk={x∈RN×n:δ(x)=dk}. It is clear that⋃k=1LDk=RN×n.Hence,D1,D2,…,D8is a partition of the sample spaceRN×nand therefore the compatibility condition is satisfied. Note that the acceptance regionsDkfor the hypothesesHkcan also be defined in the sample space of sufficient statisticssij,i,j=1,2,…,N,i<j. In this case, the compatibility condition is equivalent to the positive semi-definiteness of the sample correlation matrix.The additivity condition of the loss function is given by relation (11). For simplicity, we discuss this condition for the case of Example 2; the general case can be treated in the same way.The multiple decision problem (1) for the caseN=3is:H1:ρi,j≤ρ0,∀(i,j),H2:ρ12>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,2),H3:ρ13>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,3),H4:ρ23>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,2),H5:ρ12>ρ0,ρ13>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,2),(i,j)≠(1,3),H6:ρ13>ρ0,ρ23>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,3),(i,j)≠(2,3),H7:ρ12>ρ0,ρ23>ρ0,ρi,j≤ρ0,∀(i,j)≠(1,2),(i,j)≠(2,3),H8:ρi,j>ρ0,∀(i,j),hereL=23=8andM=3. Denote bydkthe acceptance of the hypothesisHk,k=1,…,8. One can writed1=(∂12,∂13,∂23)(hypothesisH1is accepted, if allhi,jare accepted). In the same wayd2=(∂12−1,∂13,∂23),d3=(∂12,∂13−1,∂23),d4=(∂12,∂13,∂23−1),d5=(∂12−1,∂13−1,∂23),d6=(∂12,∂13−1,∂23−1),d7=(∂12−1,∂13,∂23−1),d8=(∂12−1,∂13−1,∂23−1). Now we discuss the additivity of the loss function. Letai,jbe the loss from the rejection of the hypothesishi,jin the case when it is true andbi,jbe the loss from the acceptancehi,jin the case where the alternativeki,jis true. Letwikbe the loss from the acceptance of the hypothesisHkin the case where the hypothesisHiis true. Consider the following cases:Case 1. The true decision and the taken decision are different in one component. For example, suppose the hypothesisH1is true i.e. the right decision isd1=(∂12,∂13,∂23)but the following decision is takend2=(∂12−1,∂13,∂23). In this case the only one error is in rejection of the hypothesish12. In this case one hasw12=a12in accordance with the additivity condition (11). If the hypothesisH2is true i.e. the right decision isd2=(∂12−1,∂13,∂23)but the following decision is takend1=(∂12,∂13,∂23), thenw21=b12.Case 2. The true decision and the taken decision are different in two components. For example, suppose the hypothesisH1is true i.e. the right decision isd1=(∂12,∂13,∂23)but the following decision is takend5=(∂12−1,∂13−1,∂23). In this case the general lossw15has two componentsa12,a13and additivity conditions readsw15=a12+a13. If the hypothesisH5is true i.e. the right decision isd5=(∂12−1,∂13−1,∂23)but the following decision is takend1=(∂12,∂13,∂23), then the general lossw51has two componentsb12,b13, andw51=b12+b13. Similarlyw23=a13+b23.Case 3. The true decision and the taken decision are different in three components. For example, suppose the hypothesisH1is true i.e. the right decision isd1=(∂12,∂13,∂23)but the following decision is takend8=(∂12−1,∂13−1,∂23−1). In this case the general lossw81has three componentsa12,a13,a23and according to additivity conditionw18=a12+a13+a23. If the hypothesisH8is true i.e. the right decision isd8=(∂12−1,∂13−1,∂23−1)but the following decision is takend1=(∂12,∂13,∂23), then the general lossw81has three componentsb12,b13,b23andw81=b12+b13+b23. Similarlyw27=a12+a13+b23.The general caseN>3can be considered in the same way.The class of multiple decision unbiased statistical procedures according to Lehmann (1951) and Lehmann and Romano (2005a) is defined by the conditional risk relations:Eθw(θ,δ(x))≤Eθw(θ′,δ(x))for anyθ,θ′∈Ω.This is equivalent toEθw(d,δ(r))≤Eθw(d′,δ(r)),wheredis the true decision for the parameter valueθ, andd′is an arbitrary decision. The unbiased tests for generating hypotheses (15) satisfy the relations(18)Pρi,j(Ti,j>C)≤αi,j,ρi,j≤ρ0,(19)Pρi,j(Ti,j>C)>αi,j,ρi,j>ρ0,whereTi,j=ti,j(R1(1),R1(2),…,RN(n))is the statistics of test andαi,jis the significance level of tests.Taking into account the continuity of the distribution ofTi,jone has:(20)Pρ0(Ti,j>C)=αi,j=bi,jai,j+bi,j.To construct the optimal test in the class of unbiased tests for generating hypotheses (15) one could use the tests of the Neyman structure. This tests have the form Lehmann and Romano (2005a):(21)δi,j({sk,l})={∂i,j,ifsi,j≤ci,j({sk,l},(k,l)≠(i,j)),∂i,j−1,ifsi,j>ci,j({sk,l},(k,l)≠(i,j)),where the critical valuesci,jcan be defined from the associated conditional distributions.Example 3LetN=3and the hypotheses testing of (15) is made by the tests of Neyman structure. Then the multiple decision statistical procedure (7) takes the form:δ(s12,s13,s23)={d1,s12<c12(s13,s23),s13<c13(s12,s23),s23<c23(s12,s13),d2,s12>c12(s13,s23),s13<c13(s12,s23),s23<c23(s12,s13),d3,s12<c12(s13,s23),s13>c13(s12,s23),s23<c23(s12,s13),d4,s12<c12(s13,s23),s13<c13(s12,s23),s23>c23(s12,s13),d5,s12>c12(s13,s23),s13>c13(s12,s23),s23<c23(s12,s13),d6,s12<c12(s13,s23),s13>c13(s12,s23),s23>c23(s12,s13),d7,s12>c12(s13,s23),s13<c13(s12,s23),s23>c23(s12,s13),d8,s12>c12(s13,s23),s13>c13(s12,s23),s23>c23(s12,s13).One hasDk={x∈RN×n:δ(x)=dk},k=1,2,…,8. It is clear that⋃k=18Dk=RN×n.Hence,D1,D2,…,D8is a partition of the sample spaceRN×nand therefore the compatibility condition is satisfied. Note that the acceptance regionsDkfor the hypothesesHkcan also be defined in the sample space of sufficient statisticssi,j,i,j=1,2,…,N,i<j. In this case, the compatibility condition is equivalent to the positive semi-definiteness of the sample correlation matrix.The tests of the Neyman structures for the generating hypotheses (15) are optimal in the class of unbiased tests. Therefore, if the condition of the additivity of the loss function is satisfied, then the associated multiple decision statistical procedure is optimal. The main conclusion therefore is: the multiple decision statistical procedure for the construction of the market graph is optimal if for the construction one uses the tests of the Neyman structures.In practice however for hypotheses testing of the problem (15) one usually uses a simplified class of tests where the statistic of test depends only onri(1),ri(2),…,ri(n),rj(1),rj(2),…,rj(n):ti,j=ti,j(ri(1),ri(2),…,ri(n),rj(1),rj(2),…,rj(n)).The classical Pearson correlation test belongs to this class. Classical Pearson correlation test is known to be optimal in the class of linear transformation invariant unbiased tests. Therefore, the associated multiple decision statistical procedure for the market graph construction is optimal in this class. The critical value is taken from the equation(22)Pρ0(Si,j>cα)=αi,j=bi,jai,j+bi,j.For anyρ0the distribution ofSi,jis known and forn≥25one can use a normal approximation (Anderson, 2003).We illustrate our findings by numerical simulations for two types of multivariate distributions: multivariate normal distribution and multivariatet-distribution (multivariate Student distribution). The use of multivariatet-distribution is motivated by the known property of heavy tails of its marginal distributions, which fits better the empirical market data. We present the numerical experiments under the following assumptions:•ai,j=a≥0,bi,j=b≥0,i,j=1,2,…,N,i<j. For simplicity, we supposea+b=1. The meaning ofais the singular loss in the case when one particular edge is absent in the true market graph but it is present in the sample market graph. The meaning ofbis the singular loss in the case when one particular edge is present in the true market graph but it is absent in the sample market graph.N=100,n=400.The number of simulations for the fixed correlation matrix(ρi,j)is equal to 1000.Significance level of tests for generating hypotheses isα=ba+b,α=0.05;0.1;0.2;0.5.Two different models of correlation matrix are considered: sparse correlation matrix and real data correlation matrix. Sparse correlation matrix has the following structure: all elements of the matrix are zero except seven diagonals:ρn,n=1,ρn,n−1=ρn,n+1=0.3,ρn,n−40=ρn,n+40=0.2,ρn,n−70=ρn,n+70=0.1. This matrix is positive definite. The real data correlation matrix is calculated from real data of the Russian stock market.The calculations are running on a machine equipped with Intel Core i3 processor and 8 GB of RAM with Ubuntu 12.04 operating system using Matlab R2011b. Calculation of one characteristic for a fixedρ0takes in average 0,18 s of CPU Time.Our main goal is to study the conditional risk of multiple decision statistical procedures. In the case of multiple decision procedures the conditional risk can be calculated by (13)–(14). This is a linear combination of probabilities of all possible errors weighted by the associated losses. We note that the condition of unbiasedness implies a non linear dependence of conditional risk on the choice of the loss function. We restrict ourself to the case where the sample graph construction is based on the Pearson correlation tests for generating hypotheses testing. We use the following characteristics of the associated multiple decision statistical procedures as a functions of the thresholdρ0:•ma(ρ0)— mean of the number of singular losses of the type “a”.mb(ρ0)— mean of the number of singular losses of the type “b”.R(ρ0)=ama+bmb— conditional risk.In our setting, the method of construction of the market graph from Boginsky et al. (2003) is a particular case of described statistical procedures witha=bi.e.α=0.5. The results of numerical simulations show how the conditional risk depends on the choice of the loss function. We illustrate it by the Figures below.The Figs. 1–6correspond to the numerical experiments for the case of multivariate normal distributions ofRi.Analysis of the Figs. 1–4 shows that if the significance levelαis decreasing then the number of the singular losses of the type “a” is decreasing and the number of the singular losses of the type “b” is increasing. This is expected. Figs. 1–2 show the rate of change of the number of the singular losses of the type “a” and Figs. 3–4 show the rate of change of the number of the singular losses of the type “b”. One can see that the rates of changes have a non linear connection. This non linearity leads to the essential decreasing of conditional risk as it is shown on the Figs. 5–6. This phenomena is numerically well studied for the classical hypotheses testing but it is not well investigated for the multiple decision statistical procedures. For the sparse graph (Figs. 2, 4, 6) the main contribution in conditional risk is given by the number of the singular losses of the type “a”, the contribution of the number of the singular losses of the type “b” being neglected (for any significance level). The situation is different for the real data graph (Figs. 1, 3, 5). Forα=0.5(a=b), the contributions in conditional risk of the number of the singular losses of the type “a” and “b” are equivalent, but forα=0.05(a=0.95,b=0.05)the conditional risk is dominated by the number of the singular losses of the type “b”. Therefore, one can control the conditional risk of multiple decision statistical procedures for the market graph construction by the choice of the loss function.The Figs. 7–12correspond to the numerical experiments for the case of multivariatet-distribution ofRi. The correlation matrices (real data matrix and sparse matrix) for this case are the same as for the multivariate normal distribution case. We use the same values ofci,jfor the generating hypotheses testing as for the normal case. Analysis of the Figs. 7–10 shows that if the significance levelαis decreasing then the number of the singular losses of the type “a” is decreasing and the number of the singular losses of the type “b” is increasing. This is the same as for the normal case. Figs. 7–8 show the rate of change of the number of the singular losses of the type “a” and Figs. 9–10 show the rate of change of the number of the singular losses of the type “b”. However, the rate of changes is essentially different from the rate of changes for the normal case. This leads to the serious difference in the behavior of the conditional risks for different distributions. As it was noted above, the decreasing of the significance levelαimplies an essential decreasing of conditional risk for the normal distribution case (Figs. 5–6) which is not true for thet-distribution case (Figs. 11–12). Therefore, a deviation from normality can restrict the control of conditional risk.In the present paper different statistical procedures for the market graph construction are investigated. All procedures differ on the choice of statistical tests for generating hypotheses testing. Our main findings are:•The multiple decision statistical procedure for the market graph construction is optimal in the class of all unbiased statistical procedures if for the generating hypotheses testing one uses the tests of the Neyman structures. According to this procedure the sample market graph is constructed in the following way. Two verticesiandjare connected by an edge if the corresponding sample correlationsi,jis larger than a given thresholdci,j. The thresholdci,jdepends on the threshold for the true market graph, significance level of the test, number of observations, and the values of all sample correlationssl,k,(l,k)≠(i,j). The calculation ofci,jinvolves the conditional distribution ofsi,jwhich can be obtained from the associated Wishart distribution.The multiple decision statistical procedure for the construction of the market graph is optimal in a restricted class of unbiased statistical procedures if for generating hypotheses testing one uses the classical Pearson correlation tests. According to this procedure, the sample market graph is constructed in the following way. Two verticesiandjare connected by an edge if the corresponding sample correlationsi,jis larger than a given thresholdc. The thresholdcdepends on the threshold for the true market graph, significance level of the test, and the number of observations. The calculation ofcis easy and involves the known distribution ofsi,j(Anderson, 2003). The procedure is optimal in the restricted class of unbiased statistical procedures where the statistics of generating hypotheses tests depends only on observations for the stocksiandj. In particular, the method of the market graph construction from Boginsky et al. (2003) is optimal in this class for a special choice of significance levelα=0.5.The optimality of the described statistical procedures is essentially based in the additional assumption of normality on the additivity condition for the loss function. The last condition can be considered as natural for the investigated problems.Numerical experiments show a possibility to control the conditional risk by the choice of the loss function in the case of multivariate normal distribution. The deviation from normality can restrict the control of conditional risk as it is shown for the multivariate Studentt-distribution. The detailed analysis of this will be given in a future publication.

@&#CONCLUSIONS@&#
