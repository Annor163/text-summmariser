@&#MAIN-TITLE@&#
A sensor-software based on a genetic algorithm-based neural fuzzy system for modeling and simulating a wastewater treatment process

@&#HIGHLIGHTS@&#
A software sensor was proposed for real-time estimation of nutrient.The software sensor was based on a genetic algorithm-based neural fuzzy system.Fuzzy subtractive clustering and genetic algorithm was used to identify the model.

@&#KEYPHRASES@&#
Anoxic/oxic process,Neural fuzzy system,Genetic algorithm,On-line monitoring,

@&#ABSTRACT@&#
In this paper, a software sensor based on a genetic algorithm-based neural fuzzy system (GA-NFS) was proposed for real-time estimation of nutrient concentrations in a biological wastewater treatment process. In order to improve the network performance, self-adapted fuzzy c-means clustering algorithm and genetic algorithm were employed to extract and optimize the structure of the network. The GA-NFS was applied to a biological wastewater treatment process for nutrient removal. The simulative results indicate that the learning and generalization ability of the model performed well and also worked well for normal batch i.e., two data points. Real-time estimation of COD, NO3− and PO43− concentration based on GA-NFS functioned effectively with the simple on-line information on the anoxic/oxic system.

@&#INTRODUCTION@&#
Owning to increasingly stringent requirements on effluent quality, monitoring and controlling the wastewater treatment processes have become very significance and essential in facilitating operations, and saving manpower and energy [1,2]. On-line sensors include important information from the state of the plant, so it can be utilized by plant operators to apply real-time control strategies and optimize process performance. However, due to the lack of suitable on-line sensors for monitoring key variables of the process, such as nitrogen concentrations, phosphorus concentrations and chemical oxygen demand (COD), the effective monitoring and control for the effluent quality especially is hampered in biological wastewater treatment [3]. Although these concentrations can be measured by laboratory analysis, it is usually unavoidable that there is a significant time delay which ranges from minutes to hours. In the light of influent fluctuation and other disturbances, it is too late to come out these results usually to achieve a well-timed adaptive process control, especially for advanced wastewater treatment which requires more precise and timely controls. Hence, in order to overcome these problems, it's necessary to develop software sensors to estimate hard-to-measure process variables from other on-line measurable process variables [1].Intelligent techniques have been proven to be able to approach nonlinear systems and applied to modeling various non-linear processes [4]. The most significant advantage of intelligent technique is that the intelligent technique does not need precise mathematical model and it can well approximate any nonlinear continuous function and overcome shortcomings of the traditional control which depends on an accurate mathematical model. Recently, it became popular that the neural network (NN) was applied to modeling the biological wastewater treatment process [5]. NN can map a set of input patterns onto a corresponding set of output patterns after learning a series of past processing data from a given system. Furthermore, a NN model has a distinctive ability of figuring out non-linear functional relationships without modeling the structural knowledge of the process. There are several successful software sensors based on the NN approach [6,7]. According to Yilmaz et al., a novel approach based on the NN model has been developed to provide better predictions of the effluent COD in upflow anaerobic filter (UAF) reactor [8]. Moreover, Curteanu et al. reported a neural-networks-based optimization technique for modeling the electrolysis process in wastewater treatment [9]. The simulation results illustrated that the NN, as a function of initial characteristics (initial values of chlorophyll a, total suspended solids and COD) and operation conditions (temperature, electric power, time, electrode distance, and electrode type), can facilitate accurate predictions of a treated waste's main system outputs.Although some NN-based software sensors were designed successfully, NN schemes still have several limitations which are caused by the possibility of getting trapped in local minimum and the choice of model architecture. If the performance can be further enhanced, better operation strategies will follow. To overcome these limitations of traditional NN, many new training algorithms have been proposed, for example hybrid neural fuzzy technique, which has advantages of fuzzy inference and NN [10–12]. Hybrid neural fuzzy system combines fuzzy logic control with artificial neural network, and can realize fuzzy logic by using NN. Meanwhile, the system can get hold of fuzzy rules and optimize its subjection function online through the NN with a self-learning ability. Application of neural fuzzy network to wastewater treatment process, it was proven that a more stable operation and better effluent quality could be achieved [13]. Recently, active research has been carried out on neural fuzzy system. Chaiwat et al. integrated fuzzy systems and NNs to monitor the process response and control anaerobic hybrid reactor (AHR) in wastewater treatment and biogas production [14]. Dilek and Sukran combined fuzzy systems with NNs for predicting anaerobic digestion effluent quality in a sequential upflow anaerobic sludge bed reactor (UASBR) system [15]. They illustrated the NFS model-based-control system in the anaerobic digester system would be most likely to produce an effluent that is amenable to a consecutive aerobic treatment unit. But the main disadvantage of the system is long learning and slow converging speed. Genetic algorithm (GA) is a parallel, global search technique that emulates operators [16]. Because it simultaneously evaluates many points in the search space, it is more likely to converge toward the global solution. By working with a population of solutions, the algorithm can effectively seek many local minima, thereby increasing the likelihood of finding the global minimum.GA can be employed to generate fuzzy rules and adjust membership functions of fuzzy sets. The pioneer was Karr who used GA to adjust membership functions [17]. Hence, both the number of fuzzy sets and the membership function of each fuzzy set were determined. The GA was given more flexibility in designing the rule set and membership functions for some difficult nonlinear control problems [18]. Therefore, the combination of NN, fuzzy logic and GA could be used for integrated process modeling and optimization. The hybrid GA-NFS technique is a more powerful method for process modeling and optimization than other techniques such as response surface methodology, particularly for complex process models.The objective of this study is to develop an on-line software sensor for nutrients based on the genetic algorithm-based neural fuzzy system. Associated with the GA-NFS is a hybrid parameter learning algorithm, which combines the GA and the back-propagation algorithm (BP algorithm) method to identify parameters of the fuzzy logic rules. The proposed method, which can provide an accurate prediction of hard-to-measure process variables (here are COD, NO3− and PO43−) was applied to a bench-scale anoxic/oxic process for advanced wastewater treatment.A lab-scale reactor shown in Fig. 1was used to collect the data in this work. The reactor was operated with fed-batch sequences for organic substrate and nitrogen removal. The average working volume of the reactor was 40L. The system is an alternating aerobic–anoxic process. Solid retention time was maintained at about 15 days by wasting mixed liquor suspended solids at the end of the aerobic stage. The composition of synthetic wastewater used in this experiment was: glucose, NH4Cl, K2HPO4, and other trace elements (Fe, Mg, Na, and Ca).The control of duration/sequence of phases and on/off of peristaltic pumps, mixer, and air supply was automatically achieved by an in-house developed data acquisition and control (DAC) system. The DAC system consisted of a computer, interface cards, individual meters, transmitters, solid-state relays, and Programmable Logic Controller (PLC, SIEMENS, German). Electrodes for pH (HACH, USA), Oxidation-Reduction Potential (ORP, HACH, USA) and Dissolved Oxygen (DO, HACH, USA) were installed and connected to individual meters. The status of the reactor and the value of electrode signal were displayed on a computer monitor, and stored in the data file.Amounts of loaded COD, NH4+–N and PO43−–P per cycle was kept in a standard condition (COD: 500–1200mg/L, NH4+–N: 10–100, 120mg/L, PO43−–P: 0–40mg/L, respectively). A broad range of experimental conditions was employed to develop a model that could cover the entire range of possible conditions in actual processes. Therefore, a total of 30 data sets, including six normal operation sets with the standard influent loadings, were employed to develop an on-line software sensor. The on-line pH, ORP and DO signals were obtained in the data file every 30s during the experiment. Moreover, the performance of the system was also monitored by an off-line analysis of COD, PO43− and NO3− concentrations every 30min. All chemical analyses were performed according to standard methods [19].The schematic architecture of the genetic algorithm-based neural fuzzy system is depicted in Fig. 2. It consists of five key components: an input and output preprocessor, a fuzzy system generator, a fuzzy inference system, an adaptive neural network representing the fuzzy system and a genetic algorithm optimizer. The fuzzy inference system and its associated adaptive network are a Sugeno fuzzy inference system and an adaptive network-based fuzzy inference system (ANFIS) [20].The input and output parameters are selected or generated from the parameters which are commonly used for system description. It has been proven that on-line ORP and pH measurements are useful process control parameters for biological nutrient removal in continuous-flow reactors and in sequencing batch reactor-activated sludge process [21]. ORP and DO can be used to detect wastewater modifications and sludge activity, relating signal bending points to nitrification and denitrification [22–24].The GA-NFS (Fig. 2) has five layers with node and link numbering defined by the brackets. Nodes at layer 1 are input nodes (linguistic nodes) that represent input linguistic variables. Layer 5 is the output layer. Nodes at layer 2 are term nodes that act as membership functions to represent the terms of each linguistic variable. Each node at Layer 3 is a rule node, which represents one fuzzy logic rule. Thus all nodes at Layer 3 form a fuzzy rule base. In the nodes at Layer 4, the consequent part of the Takagi–Sugeno–Kang (TSK) model is used [25]. Links at Layer 3 define the preconditions of the rule nodes. Links at Layer 2 are fully connected between linguistic nodes and their corresponding term nodes.GA applies the operators inspired by the mechanics of natural selection to a population of binary string called chromosome, which encodes the parameter space at each generation, explores different areas of the parameter space and then directs the search to regions where there is a high probability of finding improved performance. Working with a population of solutions, the algorithm can easily seek many local minima and thereby increase the likelihood of finding the global minima. In the learning stage, GA is used to optimize the structure of neural fuzzy system and train the membership function of the terms of each input linguistic variable and the weights between Layers 4 and 5.Moreover, in order to improve the system precision and reduce the calculation time, BP algorithm is used to train GA-NFS in updating the parameters of membership functions and the linked weights between Layers 4 and 5 on the basis of the first training stage.During the BP training stage, the structure of GA-NFS is static. When the neural fuzzy system undergoes training, the feedback error information between the actual output of layer-5 nodes and the corresponding target values is propagated backward through the system. The backward propagation of error signals is used to update the connection weights between layers 4 and 5 and the centers and widths of Gaussian membership function of each fuzzy term, which have rough value after GA training. In the parameter updating, the goal is to minimize the following error function.(1)E=12∑K=1r(ydk−yk)2where ydkand ykare the desired and actual output of the k-th node, respectively, and E is the sum of squared errors.

@&#CONCLUSIONS@&#
