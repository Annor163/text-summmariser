@&#MAIN-TITLE@&#
Phase space reconstruction for improving the classification of single trial EEG

@&#HIGHLIGHTS@&#
Phase space reconstruct method is used to reconstruct the phase space of EEG signals.The features are extracted by amplitude–frequency analysis method in the phase space.The sensitivity of the attractors helps to improve the classification accuracy of BCIs based on phase space features.The maximal mutual information and the maximal steepness are used as the criterions.

@&#KEYPHRASES@&#
Brain–computer interface (BCI),Electroencephalogram (EEG),Phase space reconstruction (PSR),Nonlinear,Amplitude–frequency analysis (AFA),

@&#ABSTRACT@&#
Electroencephalogram (EEG) signals are nonlinear time series, which are generally very noisy, nonstationary, and contaminated with artifacts that can deteriorate classification methods. This contribution presents an efficient scheme to extract features in phase space by exploiting the theoretical results derived in nonlinear dynamics for motor imagery tasks recognition. To remodel the single nonlinear sequence is to reveal variety of information hidden in the origin series by its phase space reconstruction (PSR), and maintaining the original information continuity. The phase space features (PSF) were extracted by the amplitude–frequency analysis (AFA) method in the state space of EEG signals (AFAPS). The linear discriminant analysis (LDA) classifiers based on the AFAPS features are used to classify two Graz datasets used in BCI Competition 2003 and 2005. The results have shown that the LDA classifiers based on PSF outperformed most of other similar studies on the same Graz dataset in terms of the competition criterions. The features extracted by the proposed scheme contain the nonlinear information which helps to improve the classification results in the BCI.

@&#INTRODUCTION@&#
Brain–computer interface (BCI) is a system that helps the serious disabled individuals to drive and control external devices using only their brain activity, without participation of peripheral nerves and muscles [1–3]. The real purpose of BCI is to translate brain activity into a command for a computer. To achieve this goal, the feature extraction and the classification algorithm are employed. More and more evidence indicate that some mental tasks can be recognized from spontaneous EEG signals. Currently, the success in the motor imagery-based BCI can be attributed to the underlying neurophysiological phenomena accompanying motor imagery, termed event-related desynchronization (ERD) and event-related synchronization (ERS) [4]. The μ (8–13Hz) and β (14–25Hz) band originating in the sensorimotor cortex have been postulated to be good signal features for EEG-based BCI [5,6].Many EEG feature extraction studies have been developed within the recent years. Among these feature extraction methods, autoregressive (AR) models [7], power spectral density (PSD) [8], amplitude–frequency analysis (AFA) [9], wavelet transforms (WT) [10] and other method such as empirical mode decomposition (EMD) [11] technique have been used to process the EEG signals. Rodríguez-Bermúdez et al. presented an efficient Leave-One Out estimation method to choose the most useful features extracted by PSD, Hjorth, AR and WT. Their results showed that the classification results using the proposed method were competitive [8]. Zhang et al. used the amplitude–frequency analysis (AFA) and phase synchronization techniques to realize an online BCI [9]. Xu et al. use fuzzy support vector machine based on the statistical features over the set of the wavelet coefficients to classify the left and right hand motor imagery tasks. The classification results outperformed the winner of the BCI Competition 2003 and 2005 on the same dataset and the same criterion [10]. The EMD approach rests on the identification of signal's nonstationary and nonlinear features which represent different modalities of brain activity captured by the EEG data acquisition system. Park et al. introduced a novel method using extension of the algorithm EMD to determine asymmetry, the liberalization of brain activity [11]. A new set of features including higher-order statistics based on the bispectrum of EEG signals have been applied to the classification of right and left motor imagery for developing EEG-based BCI systems. Zhou et al. stated that by using the bispectrum-based feature extraction, all three classifiers (i.e., linear discriminant analysis (LDA), support vector machine (SVM) classifier, and neural network (NN) classifier) are superior to the winner of the BCI Competition 2003 on the same Graz dataset [12].From a practical perspective, traditional feature extraction techniques based on AR models and PSD applied to the EEG generally assume that the EEG signals is linear. These methods are insensitive to nonlinear structure contained in a time series. For example, it is well known that given any power spectrum, it is possible to generate a time series with that power spectrum by a linear regressive process. If there is significant nonlinearity in the signal, these methods can miss important information contained in the signal. As the physiological signals such as EEG signals, generally acquired as time series, are often marked by significant nonlinearity that conventional analysis methods often fail to identify [13]. It is more suitable to use nonlinear methods to analyze the EEG signals. Much research such as EMD [11] and the method proposed in reference [12] have tried to overcome this limitation. The simulation results have shown the effectiveness of the nonlinear features. Another popular nonlinear method is phase space reconstruction (PSR), which is a valuable tool for the studies of this kind of signals [14].A number of authors have looked for the presence of nonlinearity in human EEG signals with varying outcomes. Liley et al. proposed an EEG model to describe the dynamics of neural activity in cortex [15]. Stam analyzed the nonlinear dynamics of EEG and MEG [14]. Many nonlinear features were used to analyze epilepsy, mental fatigue [13,16,17]. In the BCI community, only a paucity of research has used the chaotic indices. Banitalebi et al. used largest Lyapunov exponent, mutual information, correlation dimension and minimum embedding dimension as the features for the classification of EEG signals in reference [18]. As it is well known, the calculations of chaos features such as Lyapunov exponent, mutual information etc. is time-consuming. It spend 38.6s to calculate a maximal Lyapunov exponent index with wolf method for one channel of a trial in MATLAB 7.10(R2010a) running in the machine with 4GB of memory and 3.10GHz processor. A practical BCI must have a high information transfer rate, so these chaos features such as Lyapunov exponent cannot meet the real-time requirements. To address these deficits, we developed a feature extraction scheme based on PSR. The principle of PSR is to transform the properties of a time series into topological properties of a geometrical object which is embedded in a space, wherein all possible states of the system are represented, each state corresponds to a unique point, and this reconstructed space sharing the same topological properties as the original space [19,20]. Because the ERD/ERS phenomenon emerges in motor imagery, and the reconstructed attractors are sensitivity to the initial conditions, some useful nonlinear information hidden in the phase space will be revealed. So, all the features extracted in the phase space of the EEG signals must help to improve the classification of the BCI. In the first stage of the proposed scheme, a phase space of the EEG signals is reconstructed. Then the features were extracted in the phase space by AFA. To evaluate the effectiveness of the feature sets, a linear discriminant analysis (LAD) classifier is adopted to classify the Graz BCI datasets which are used in the BCI-Competition 2003 [21] and BCI-Competition 2005 [22]. It should be emphasized that, although the PSR techniques and AFA have been previously analyzed in other BCI research works; this letter introduces a new framework to combine the conventional features extraction methods AFA to chaos theory. To the best knowledge of the authors, this framework has not been previously proposed for implementing BCI systems based on motor imagery.Two datasets coming from BCI Competition 2003 and 2005 are used in present study. The first dataset is the dataset III of BCI Competition 2003 and the second dataset is the dataset IIIB of BCI Competition 2005. All the two datasets are provided by Department of Medical Informatics, Institute for Biomedical Engineering, University of Technology Graz [21,22].In BCI Competition 2003, the dataset III (termed Graz2003 dataset) was recorded over C3, Cz and C4 from a normal subject (female, 25 years) during a feedback session. The task was to control a feedback bar by means of imagery left or right hand movements. The order of left and right cues was random. The feedback was based on AAR parameters of channel C3 and C4. Each trial lasted 9s. The first 2s was quite, at t=2s an acoustic stimulus indicates the beginning of the trial, the trigger was displayed for 1s; at t=3s, an arrow (left or right) was displayed as cue. At the same time the subject was asked to image to move a bar into the direction of the cue. The EEG was sampled with 128Hz; it was filtered between 0.5 and 30Hz [21].In BCI Competition 2005, the dataset IIIB (termed Graz 2005 dataset) was recorded over the positions C3, C4 from three subjects (O3, S4 and X11) during the cued motor imagery task with online feedback. The experiment consists of 3 sessions for each subject. Each session consists of 4 to 9 runs. The first 2s was quite, at t=2s an acoustic stimulus indicates the beginning of the trial, the trigger was displayed for 1s; at t=3s, a visual cue (virtual reality for O3 or basket for S4 and X11) was displayed as cue. At the same time the subject was asked to image to do motor imagery along the direction of the cue (Fig. 1). The EEG was sampled with 125Hz; it was filtered between 0.5 and 30Hz with Notch filter on. The duration of each trial was 8s, with a random interval between trials from 1 to 2s. More detailed description can be found in [22]. The distribution of available trials in the training and testing dataset for the four subjects is summarized in Table 1.AFA is a method based on Discrete Fourier transform (DFT). Fourier transform of a sequence x(n) (n=0, 1, ..., N−1) with the length of N can obtain a Discrete Fourier transform sequence X(k) (k=0, 1, …, N−1) with the length of N. When N can be represented by 2m(m is an integer), the Fourier transform can be calculated by a fast algorithm which is termed Fast Fourier transform (FFT). In generally, it can be expressed as Eq. (1):(1)X(k)=∑n=0N−1x(n)exp−j2πNkn(k=0,1,...,N−1)X(k)takes the absolute value of the amplitude samples of X(k).X(k)is the amplitude–frequency character of the DFT sequence, the unit of k is Fs/N Hz, Fsis sampling frequency. The features used in this study are the maximal values (termed peak value) and the mean values ofX(k)in μ-band (8–13Hz) and β-band (14–25Hz).The theory of nonlinear PSR is proposed by Packard and Takens [20]. Mathematically, the states of an m dimensional dynamic system can only be characterized by m independent quantities. Such a set of m independent quantities represents the coordinates of the phase space. One of the most used methods of PSR is the time-delay embedding. Since this method does not require that the treated system could be mathematically defined, explicitly, it fits well with 1D time series. Let {xk:k=1, 2, …, N} is an observed time series. From the time series, an m-dimension phase space can be remodeled. The reconstruction phase space can be shown as the following trajectory matrix:(2)X=X1X2...XM=x1x1+τ...x1+(m−1)τx2x2+τ...x2+(m−1)τ............xMxM+τ...xNwhere M=N−(m−1)τ, τ is the delaying time and m is the embedding dimension. The m-dimensional space of delay coordinates serves as a pseudo state-space which provides a natural setting to approximate the quantitative aspects of the dynamics.Many studies have shown that sensory, cognitive and motor processing can result in changes of the ongoing EEG in form of ERD or ERS. There is obvious difference between left and right hand motor imagery in the EEG time series recorded over C3 and C4 (Fig. 2). When imaging left hand movement, the peak value of the μ band over C3 is greater than that over C4, which illustrates that the ERS emerges over C3 and ERD emerges over C4. When imaging right hand movement, the peak value of the μ band over C3 is smaller than that over C4, which illustrate the ERS emerging over C4 and ERD emerging over C3. The changes of the peak value over C3 and C4 is consistent with the ERD/ERS [5,6]. It also can be depicted that with the change of the signal's frequency, the amplitude of the same channel has obvious changes in bands, especially in μ (8–13Hz) band.In practice, physiologically meaningful EEG features can be extracted from various frequency bands of recorded EEG signals. However, for various reasons (such as the noise, the interference of electrooculographic (EoG) and electromyographic (EMG) and the status of the subjects), the changes of the peak value in μ band over C3, C4 may not be obvious or even not consistent with the ERD/ERS for every trial (Fig. 3) as that in Fig. 2. The trial 27 in Graz2003 training dataset is the EEG signal for right hand movement imagery. The ERD/ERS will appear when imaging hand movement. The amplitude of C3 in μ band should be smaller than that of C4 according to ERD/ERS, however, the opposite is true. The changes in μ band will be enlarged in the phase space because the attractor is sensitive to the initial condition; it will be reflected in the amplitude–frequency curve (Fig. 3(b)). From Fig. 3(b), the amplitude–frequency curve of C3 and C4 is consistent with ERD/ERS after PSR. PSR can reduce the effects of the noise or outliers of the EEG signals in BCI. Hence, the features extracted in phase space must help to improve the classification results.There are several parameters must been chosen before extract the features such as the dimension m and delaying time τ. Computing m and τ using traditional method is time-consuming. It is unnecessary to compute m and τ for every trial, because the purpose of our study is to obtain the better feature set for classification, not to reconstruct the entire phase space for the EEG. When calculated with the mutual information method, the average values of τ for all subjects of Graz2003 and Graz2005 dataset are all near 7. However, the average value of τ is 4 when calculated with C–C method. Considering the two methods, we used dataset τ={3, 4, 5, 6, 7, 8} as the candidate dataset. The average values of m calculated by Cao method and C–C method are all greater than 10. The greater the value of m, the more time is needed to reconstruct the phase space. A greater m cannot improve the results obviously, while the dataset of m={2, 3} can also help to improve the features. In this study, the value of m was searched in the set of m={2, 3} and τ in the set of τ={3, 4, 5, 6, 7, 8} based only on training set. We selected the value of m and τ associated with the best result according to the evaluation criteria (see Section 4).Reconstructed phase spaces have been proven to be topologically equivalent to the original system and therefore are capable of recovering the nonlinear dynamics of the generating system [19,20]. This implies that the full dynamics of the system are accessible in this space, and for this reason, the features extracted from it can potentially contain more and/or different information than the common features extraction method. In order to get a more efficient features set, this paper proposes the following features extraction scheme using AFA.(1)Reconstruct the phase space for C3, C4 with the selected m and τ for each trial;Transform each dimension of the constructed phase space of C3 or C4 with FFT. Extract the maximal values and the average values of the absolute value of amplitude samples in μ-band (8–13Hz) and β-band (14–25Hz) as the features. Concatenate the features of each dimension and each channel to form a single feature vector.In order to demonstrate the effectiveness of the proposed features in BCI applications, the Linear Discriminant Analysis (LDA) classifier are used in this paper [23].Features were extracted at every sampling point, with the sliding window size of 2s for Graz2003 dataset and Graz2005 dataset of BCI Competitions. Fig. 4shows the chart of sliding window for Graz2003 dataset. The sliding window is begin at t=3s and end at t=9s or 8s for Graz2005 dataset. The procedure of the classifiers with the features extracted in phase space could be divided into two parts: the first one performing to train the classifiers on the training trials and the second one being for the analysis of testing trials. The general flow chart was shown in Fig. 5where the left of the flow chart was for the offline training of classifiers and the right was for the classification of the testing trials.Some explanation about the classification procedure was as follows:(1)The sliding window move from t=3s to t=9s for Graz2003 dataset or t=3s to t=8s for Graz2005 dataset point by point. Every sliding window has 2×Fs points, where Fs is the sampling frequency.The parameters used in the testing dataset are the same as they are in training dataset. All these parameters are chosen based on the training dataset. Once the values of m and τ are selected for one subject, they will never change during the classification procedure. The phase space is an M×m trajectory matrix (where M=N−(M−1)τ). The features were extracted from the m column vector. If the embedding dimension is m, the feature vector has 2×m×4 features for each trial.The features extracted from one sliding window at a sampling point training one classifier in the training dataset; this classifier is used to classify the features extracted in the sliding window at the same sampling point in the testing dataset.

@&#CONCLUSIONS@&#
