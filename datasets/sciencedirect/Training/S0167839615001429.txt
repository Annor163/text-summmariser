@&#MAIN-TITLE@&#
Constrained multi-degree reduction with respect to Jacobi norms

@&#HIGHLIGHTS@&#
We study the problem of constrained degree reduction with respect to Jacobi norms.Our results generalize several previous findings on polynomial degree reduction.We explore the space of Jacobi parameters on the reduced polynomial approximation.

@&#KEYPHRASES@&#
Degree reduction,Weighted least squares,Jacobi norm,Hahn orthogonal polynomials,

@&#ABSTRACT@&#
We show that a weighted least squares approximation of Bézier coefficients with factored Hahn weights provides the best constrained polynomial degree reduction with respect to the JacobiL2-norm. This result affords generalizations to many previous findings in the field of polynomial degree reduction. A solution method to the constrained multi-degree reduction with respect to the JacobiL2-norm is presented.

@&#INTRODUCTION@&#
Optimal degree reduction is one of the fundamental tasks in Computer Aided Geometric Design (CAGD) and therefore has attracted researchers' attention for several decades (Ait-Haddou, in press; Zhou and Wang, 2009; Ahn et al., 2004; Ahn, 2003; Kim and Ahn, 2000; Lutterkort et al., 1999; Watkins and Worsey, 1988). Used not only for data compression, CAD/CAM software typically requires algorithms capable of converting a curve (surface) of a high degree to a curve (surface) of a lower degree. Considering the problem coordinate-wise, the goal is formulated as follows: given a univariate polynomial p of degree n, find its best polynomial approximation q of degree m,m<n, with respect to a certain given norm.The degree reduction can be seen as an inverse operation to the degree elevation. Whereas elevating polynomial degree from m to n is always possible, see e.g. (Hoschek and Lasser, 1993), because it is equivalent to expressing a polynomialq∈Pmin the basis of a larger linear spacePn,Pm⊂Pn, the degree reduction is in general not. A natural alternative is then finding the best approximation that minimizes a certain error. This can be interpreted as projectingp∈PnintoPm. Depending on a particular norm defined onPn, various schemes for degree reduction were derived (Eck, 1993; Peters and Reif, 2000; Lee and Park, 1997; Kim and Moon, 1997; Brunnett et al., 1996; Ait-Haddou and Goldman, 2015).An elegant resemblance between theL2-norm and the Euclidean norm acting on the vector of Bernstein coefficients was revealed by Lutterkort et al. (1999). They proved that the least squares approximation of Bézier coefficients provides the best polynomial degree reduction in theL2-norm. Two interesting generalizations of this result were achieved by Ahn et al. (2004) and by Ait-Haddou (submitted for publication). Ahn et al. (2004) showed that a weighted least squares approximation of Bézier coefficients provides the best constrained polynomial degree reduction in theL2-norm. By constrained we understand that the original polynomial and its reduced-degree approximation match at the boundaries up to a specific continuity order. Ait-Haddou (submitted for publication) shows that the weighted least squares approximation of Bézier coefficients with Hahn weights provides the best polynomial degree reduction with respect to the JacobiL2-norm. In view of these two generalizations, it is natural to ask the following question:(Q) – Is there an analogue to the result ofLutterkort et al. (1999)for the constrained degree reduction with respect to the JacobiL2-norm?The JacobiL2-norm depends on two real parameters and a partial answer to the question (Q) is given in (Jianmin and Wang, 2003) for specific values of the parameters of the JacobiL2-norm.In the present work, we give an affirmative answer to question (Q); namely we show that there exists a weighted inner product on the Bézier coefficients for which the problem of constrained degree reduction with respect to the JacobiL2-norm is equivalent to the problem of weighted least squares approximation of the Bézier coefficients.Our methodology for answering question (Q) is very similar to Lutterkort et al. (1999) and its extension by Ahn et al. (2004). The main challenge lies in the construction of the adequate inner product of Bézier coefficients.We note that a general solution to the problem of constrained degree reduction with respect to the JacobiL2-norm is derived in (Woźny and Lewanowicz, 2009). Although their solution does not require matrix inversion, the derivation is rather complicated because it requires an explicit computation of the dual bases of the discrete Bernstein bases. Moreover, their methodology does not involve the approach taken in (Lutterkort et al., 1999) and (Ahn et al., 2004). In contrast, our solution, even though it requires the computation of a single Moore–Penrose inverse, is simple and fits to the framework of (Lutterkort et al., 1999; Ahn et al., 2004).The rest of the paper is organized as follows. In section 2, we prove that the best constrained polynomial degree reduction with respect to the JacobiL2-norm is equivalent to a weighted least squares approximation of Bézier coefficients with factored Hahn weights. We demonstrate how to compute the degree-reduced polynomials in Section 3, present several examples in Section 4, and finally conclude the paper in Section 5.Denote byPnthe linear space of polynomials of degree at most n and letBnbe its Bernstein–Bézier (BB) basis andQnbe its Lagrange basis with respect to the nodes(0,1,…,n), i.e.,Bn:=[B0n,…,Bnn],whereBin(t)=(ni)(1−t)n−iti,t∈[0,1],andQn:=[Q0n,…,Qnn],whereQin(t)=∏j=0,j≠int−ji−j.LetPmbe a subspace ofPn,m<nand let k and l be two non-negative integers such thatk+l≤m+1, we definePmk,las:Pmk,l={f∈Pm:f(i)(0)=0,i=0,1,…,k−1;f(j)(1)=0,j=0,…,l−1}.That is,Pmk,lis a linear space of polynomials of degree at most m with k vanishing derivatives att=0and l vanishing derivatives att=1. Moreover, we defineQmk,l={f∈Pm:f(i)=0,i=0,1,…,k−1andi=n−l+1,…,n}.Letα>−1andβ>−1be two real numbers and define the Jacobi inner product inPnby(1)<p,q>L2=∫01tα(1−t)βp(t)q(t)dt.Considering the vectors of BB coefficients of p and q,p=[p0,…,pn]Tandq=[q0,…,qn]T, respectively, we define the following weighted Euclidean inner product of the BB coefficients(2)<p,q>E2=<Bnp,Bnq>E2=∑i=kn−lwipiqi,with the weights(3)wi=(ni)(ii−k)(n−in−i−l)(α+1)k+i(β+1)n−i+l,where(a)s=a(a+1)…(a+s−1)denotes the Pochhammer symbol with the convention that(a)0:=1.Remark 1The choice of the weightswiin (3) is not arbitrary but follows a certain logic that combines the work of Ahn et al. (2004) and the work of Ait-Haddou (submitted for publication). First recall that Hahn orthogonal polynomialsHi,i=0,1,…,n, are orthogonal polynomials with respect to the Hahn inner product(4)<p,q>H=∑i=0n(ni)(α+1)i(β+1)n−ip(i)q(i).Whenk=l=0(the unconstrained case) the weightswiin (3) coincide with the Hahn weights(ni)(α+1)i(β+1)n−igiven in (4). This is what is naturally expected from the results in (Ait-Haddou, submitted for publication). Moreover, in the constrained case, i.e, whenk≠0orl≠0, and whenα=β=0, we recover from (3) the inner product given in (Ahn et al., 2004). The weights in (3) are essentially the Hahn weights in (4) multiplied by certain factors that depend on the order of the endpoint constraints.We need the following lemma given in (Ahn et al., 2004).Lemma 1(SeeAhn et al., 2004.) A polynomialBnpis of degree m,m≤n, withp(i)=0fori=0,…,k−1andi=n−l+1,…,nif and only if the vector of coefficients is a polynomial of degree m with zeros ati=0,…,k−1andi=n−l+1,…,nin its index, i.e.,Bnp∈Pmk,l⇔Qnp∈Qmk,l.Now we are in a position to state the main result of this work.Theorem 1The orthogonal complements ofPmk,linPnk,lwith respect to the Jacobi inner product(1)and the weighted Euclidean inner product(2)are equal.ProofDenote byPm,nk,lthe orthogonal complement ofPmk,linPnk,lwith respect to the Euclidean inner product (2). LetBnqbe an element ofPm,nk,l. Thus we have<Bnq,Bnp>E2=0for any elementBnp∈Pmk,l. Let s be an integer smaller or equal thanm−k−l. We have<Bnq,tk+s(1−t)l>L2=∫01tα+s+k(1−t)β+lBnqdt=∑i=0nqi∫01tα+s+k(1−t)β+lBin(t)dt.Therefore,(5)<Bnq,tk+s(1−t)l>L2=<Bnq,Bnϕ>E2,whereϕ=[ϕ0,ϕ1,…,ϕn]withϕi=(ii−k)(n−in−i−l)(ni)1(α+1)k+i(β+1)n−i+l∫01tα+s+k(1−t)β+lBin(t)dt.AsBnqis an element ofPm,nk,land by Lemma 1, the inner product (5) vanishes if and only ifϕiis a polynomial in i of degree less or equal to m that vanishes at0,1,…,k−1and atn−l+1,…,n. We have∫01tα+s+k(1−t)β+lBin(t)dt=(ni)Γ(α+s+k+i+1)Γ(β+l+n−i+1)Γ(α+β+s+k+l+n+2),whereΓ(.)is the Gamma function. Thus∫01tα+s+k(1−t)β+lBin(t)dt=(ni)Γ(α+1)Γ(β+1)Γ(α+β+2)(α+1)i+k+s(β+1)n−i+l(α+β+2)s+n+k+l.Therefore,ϕi=Γ(α+1)Γ(β+1)Γ(α+β+2)(α+i+1)(α+i+2)…(α+i+s)(α+β+2)s+n+k+l(ii−k)(n−in−i−l),which shows thatϕiis a polynomial of degree at most m in the variable i that vanishes at0,1,…,k−1and atn−l+1,…,n. Therefore,Pm,nk,lis contained in the orthogonal complement ofPmk,linPnk,lwith respect to the weighted Euclidean inner product (2). The fact of equal dimensions of both orthogonal complements completes the proof.  □A consequence of Theorem 1 for the constrained degree reduction with respect to the JacobiL2-norm is the following corollary; for which the proof goes along the same lines as the proof of Corollary 4.1 in (Ahn et al., 2004).Corollary 1Given a polynomial p of degree n, the approximation problem(6)minq∈Pm⁡{‖p−q‖:p(i)(0)=q(i)(0)fori=0,…,k−1,andp(j)(1)=q(j)(1)forj=0,…,l−1}has the same minimizer for the norm induced either by the JacobiL2-inner product(1)or the weighted Euclidean inner product(2).Remark 2The following factorization for the constrained degree reduction holds: Denote byPm,nk,lthe linear operator that maps polynomials of degree n to their best constrained JacobiL2-approximations; then we havePm,nk,l=Pm,hk,lPh,nk,lwithm≤h≤n. That is, reducing the degree sequentially by one from n to m gives the same result as projecting p directly fromPntoPmwhile preserving the endpoint constraints.Remark 3Our result is a generalization of both unconstrained and constrainedL2-degree reduction schemes (Lutterkort et al., 1999; Ahn et al., 2004; Ait-Haddou, submitted for publication). Forα=β=0, we recover the results given in (Ahn et al., 2004) and if additionallyk=l=0, we obtain the results in (Lutterkort et al., 1999). Fork=l=0and α, β arbitrary, we recover the results given in (Ait-Haddou, submitted for publication).We now introduce computational tools to solve the constrained polynomial degree reduction with respect to the JacobiL2-norm. Apart from the expression of the weight matrices, that accommodates the expression of the inner product (2), the method is similar to the one given in (Ahn et al., 2004).Denote byAn,mthe degree raising matrix that maps the BB coefficients q of a polynomial q of degree m to BB coefficientsq‾=[q‾0,…,q‾n]Twhen raised to degree n, i.e.,q‾=An,mq. The matrixAn,mis of order(n+1)×(m+1)and can be decomposed into elementary degree raising matrices asAn,m=An,n−1An−1,n−2…Am+1,mwhereAh,h−1(i,j)={i/hifj=i−1,1−i/hifj=i,0else.Denote by W (resp.W) the diagonal(n+1)×(n+1)weight matrix where the diagonal elements are the weightswi(resp.wi) from (3).According to Corollary 1, the constrained degree reduction problem reduces to solving the least squares problem(7)minq∈Rm+1⁡‖p−An,mq‖E2,with k boundary constraints att=0and l boundary constraints att=1. Imposing the boundary constraints equals expressing the first k (the last l) coefficients of q in terms of the first k (the last l) coefficients of p. This yields a(k×k)(an(l×l)) linear systempi=q‾i,i=0,…,k−1(pi=q‾i,i=n−l+1,…,n) with the coefficients of the vector q as unknowns, see e.g. (Hoschek and Lasser, 1993). We denote byqˆ=[q0,…,qk−1,0,…,0,qn−l+1,…qn]T,qˆ∈Rm+1,the vector that contains the solutions of the two boundary linear systems. That is, there ism+1−k−lcoefficients of q that are not affected by the boundary constraints, we denote them byq˜=[qk,…,qm−l]∈Rm+1−k−l. These coefficients are the free parameters for the least squares minimization described as follows.LetWnk,lbe a diagonal(n+1−k−l)matrix obtained fromWnby skipping the first k and the last l entries and definep˜as[0,…,0︸k,p˜,0,…,0︸l]T=p−Am,nqˆ.Then the least squares problem (7) transforms to(8)minq˜∈Rm+1−k−l⁡‖Wnk,lp˜−Wnk,lAn,mk,lq˜‖2,whereAn,mk,lis a submatrix ofAn,mobtained fromAn,mby skipping the first k and the last l rows and columns. Using Moore–Penrose inverse, the unique minimizer to (8) is(9)q˜=Mn,mk,lp˜=((An,mk,l)TWnk,lAn,mk,l)−1(An,mk,l)TWnk,lp˜.Example 1Consider degree reduction fromn=6tom=5with theC0continuity constraint att=0andC1continuity constraint att=1, i.e.,k=1,l=2, see Fig. 1. Thenp−Am,nq=[p0p1p2p3p4p5p6]−16[600000150000024000003300000420000051000006][q0q1q2q3q4q5].The first k and the last l control points of q are determined by the boundary constraints. Incorporating them we obtainp−Am,nq=[p0p1p2p3p4p5p6]−16[600000150000024000003300000420000051000006][p0q1q2q365p5−15p6p6].Splitting q into boundary-determined and boundary-independent vectors,qˆ=[p0,0,0,0,65p5−15p6,p6]Tandq˜=[q1,q2,q3]T,and grouping the p-dependent terms together, the system reduces top˜−Am,nk,lq˜=[p1−16p0p2p3p4−25p5+115p6]−16[500240033004][q1q2q3]and (9) givesq˜.In this section, we show several numerical examples of constrained degree reduction. Fig. 2shows the effect of the parameters α and β on the final approximant q. In this figure, p and q are both univariate polynomials (graphs). One can see that the shape of the degree-reduced curve changes considerably for various α and β and these Jacobi weights can be seen as two free shape parameters. Their influence on the degree-reduced curve can be interpreted as follows. For example, ifα≪β, the finalL2error is forced to be smaller in the neighbourhood ofp(0)because the weight magnifies theL2error to be minimized, see (1). This results in a curve that is closely aligned to the initial curve closer to its startpointp(0).Due to the two degrees of freedom, additional criteria on the quality of the fit can be considered. Fig. 2 shows theL∞error between p and q and also the fairness energy defined as(10)Efair(q)=∑i=1m−1‖qi−1−2qi+qi+1‖2which reflects the variation of the control points and consequently the fairness of the curve. It is difficult to estimate a-priori the optimal pair(α,β)that minimizes eitherL∞orEfair. However, since the minimization of (6) is achieved by (9) efficiently, one may explore the space of shape parameters to seek for an approximation that meets additional criteria, e.g. lowL∞and/orEfair.Curvature constrained degree reduction of planar Bézier curves is shown in Fig. 3. The problem is reduced component-wise and, for the particular settingn=8,m=6,k=l=3, the coordinates of a single free control point (green) are computed from (9). Observe the impact of(α,β)on the shape of the approximation.An example of aC1-constrained degree reduction is shown in Fig. 4. A planar curve is considered as a half-meridian of a surface of revolution and the two parameter family of the optimal approximations with respect to JacobiL2-norm (1) is explored. Again, one can see how the weights α and β influence the shape by increasing (decreasing) the importance of theL2error in the vicinity of the corresponding endpoint.

@&#CONCLUSIONS@&#
