@&#MAIN-TITLE@&#
An innovative method for dynamic update of initial water table in XXT model based on neural network technique

@&#HIGHLIGHTS@&#
The neural network is initially integrated into the runoff generation module of XXT model.Previous rainfall–runoff data are considered in conceptual model.PSO technique is employed for the integration of ANN and XXT model.A new and efficient integrated hydrologic model is proposed in the paper.

@&#KEYPHRASES@&#
XXT model,ANN,Integration,PSO,

@&#ABSTRACT@&#
The initial subsurface flow of whole basin plays a quite important role in daily rainfall–runoff simulation. However, general physically based rainfall–runoff model, such as the XXT model (a hybrid model of TOPographic MODEL and the Xinanjiang model), is difficult to catch the non-linear factors and take full advantages of previous information of rainfall and runoff that is essential to the initial watershed average saturation deficit of each time step. In order to address the issue, this study selected the initial subsurface flow for the whole time series of the XXT model as the breakthrough point, and used the observed runoff and rainfall data of two days before the present day as the inputs of artificial neural network (ANN) and initial subsurface flow of the present day as the output, then integrated ANN into runoff generation module of XXT model and finally tested the integrated model for daily runoff simulation in large-scale and semi-arid Linyi watershed, eastern China. In addition, this work employ particle swarm optimization (PSO) algorithm to seek the best combination of 6 physical parameters in XXT and a great number of weights in ANN to avoid the local optimization. The results show that the integrated model performs much better than XXT in terms of Nash–Sutcliffe efficiency coefficient (NE) and root mean square error (RMSE). Hence, the new integrating approach proposed here is promising for daily rainfall–runoff modeling and can be easily extended to other process-based models.

@&#INTRODUCTION@&#
High-efficiency rainfall–runoff forecast plays an important role in disaster warning and sustainable water resource management. Many hydrologists have tried to disclose the hydrological law through rainfall–runoff based hydrological models [1–3]. However, rainfall–runoff process consists of quite complex nonlinear factors and physical mechanisms so that it is difficult to be described accurately. As a result, there is an urgent demand to find a more effective and efficient method to forecast the runoff more precisely and more reasonably.So as to successfully simulate the rainfall–runoff processes in drainage basins, most researchers and hydrologists work by two kinds of approaches consisting of deterministic techniques that take underlying physical process into account and the systems theoretic models that take only the inputs and outputs of the whole watershed into account but possess the ability to capture the complicated non-linear relationship.So far conceptual models have always been widely used [4–7]. It is possible to work on a conceptual model that considers both hydrologic and climatologic variables, such as precipitation, runoff, temperature and evaporation. TOPMODEL [1], is a simple semi-distributed and physically based rainfall runoff model that provides computationally efficient prediction of distributed hydrological responses with a simple framework. Sun and Deng [8] made the daily and monthly rainfall–runoff response simulated with the TOPMODEL coupled with the simple water cycle model and indicated that TOPMODEL works well in catchments with a hill-slope region, moist soil, and a shallower groundwater table. Wu et al. [9] addressed the spatial uncertainty of TOPMODEL to assess its variability in simulating watershed hydrologic response with the change of DEM resolution and indicated that the model efficiencies based on the same set of TOPMODEL parameters were sensitive to DEM grid size especially at coarse resolutions. Takeuchi et al. [7] introduced the block-wise TOPMODEL (BTOP) of extension of the TOPMODEL concept in a grid based framework for distributed runoff simulation of large river basins. Xu [10], based on geographic information system (GIS) technique and TOPMODEL, developed a new agricultural drought prediction model which performed well in Linyi watershed in China. Gumindoga et al. [11], acquiring a fine resolution of 30m DEM for the semi-distributed hydrological modeling through the computation of the topographic index, proved that TOPMODEL could make an explicit link between catchment topography and the generation of stream flow. Another semi-distributed conceptual hydrological model, Xinanjiang model, has been generally applied in China since its birth [2,5]. Its highlight is the soil moisture storage capacity distribution curve, which makes it robust for application in humid and semi-humid regions [12–14]. Gan et al. [15] also proved that the Xinanjiang model did consistently better than the Pitman model of South Africa, the Sacramento model of USA, the NAM model of Europe, and the SMAR model of Ireland. Aiming at more precise predict results, some hybrid models have been raised. Yong and Zhang [16] proposed a hydrological model TOPX (a hybrid model of TOPMODEL and Xinanjiang) by combining the concept of topographic index in TOPMODEL and the calculation of water balance in the Xinanjiang model. Chen et al. [17] developed a monthly hydrological model, which linked the TOPMODEL topographic index with the mechanism of runoff generation employed in the Xinanjiang model. In addition, based on the soil moisture storage capacity distribution curve (SMSCC) of the Xinanjiang model and the simple model structure of TOPMODEL, a new rainfall–runoff model named XXT was developed by Xu et al. [18]. It is suggested that XXT performs better against the TOPMODEL and the Xinanjiang model for watersheds of both the small and large scale in terms of the Nash–Sutcliffe efficiency. Moreover, Xu et al. [19] indicated early flood warning by the XXT model using the output of GRAPES (Global/Regional Assimilation and Prediction Systems) driven by TIGGE data was feasible.Although conceptual models can express well in runoff generation by depicting the concrete physical factors, it is quite difficult to catch the non-linear relationship among environmental factors. In order to address the issue, increasing scientists have begun to use the computer science and mathematical methods to construct the non-linear mathematical models to seek the answers. Hsu et al. used a probabilistic model developed based on historical events to assess flood risk in Taiwan [20]. Tseng et al. have discussed a critical assessment of the natural disaster risk control decision model from a methodological perspective and have identified major shortcomings with the employment of enhanced formal evaluation and decision-making methods [21]. Chen and Chen [22] proposed a method of stability analysis for a GA-based reference ANNC (adaptive neural network controller) which is capable of handling these types of problems in a nonlinear system. As a robust member of artificial intelligence (AI) family, ANN possesses powerful capability to deal with the mass data and automatically search a non-linear relationship in the system as well as human's brain. In recent years, the use of ANN has been a focus in hydrological forecasting. Anctil et al. [23] focus on the impact of the length of observed records on the performance of MLP (multiple-layer perceptron) and the result shows MLP stream flow mapping was efficient as long as wet weather data were available for the training. Nayak et al. [24] explored the potential of integrating neural network and fuzzy logic to effectively model the rainfall–runoff process from rainfall and runoff information. Demirel et al. [25] applied ANN and SWAT (the soil and water assessment tool) to the daily flow of the Pracana basin in Portugal, then found that ANN performed more successful than the SWAT in relation to better forecast of peak flow. Ghumman et al. [26] confirmed that ANN model was an important alternative to conceptual models. Nevertheless, it may be not absolutely feasible because of the fatal weakness of the black-box models which can hardly reflect the physical process. Consequently, instead of using single ANN as a replacement for rainfall–runoff model, some researchers have used ANN as a tool to enhance the performance of traditional hydrological models. Cerda-Villafana et al. [27] used rainfall data as inputs of ANNs and let them control six of the tank model parameters to adjust them along time in order to improve efficiency. Jain and Kumar [28] made ANN consider rainfall and runoff as the inputs and the infiltration parameters as the outputs, and demonstrated that the ANN could be well employed for calibration of infiltration equations. To overcome the shortcomings of both the ANN and the conceptual model, Chen and Adams [29] have combined ANNs within the conceptual models. It seemed very novel. However it also has been criticized, especially due to its non-global parameters optimizing method [30]. Furthermore, Xu has already successfully used ANN to correct the errors of outputs both from XXT and TOPMODEL for better results [31,32]. In general, it is clear recognized that ANN is very promising to building the non-linear relationship between some necessary factors of hydrological processes to improve efficiency.According to antecedent studies, most rainfall–runoff models, such as TOPMODEL, Xinanjiang and XXT, have not richly considered previous observed runoff and rainfall both of which however are important for streamflow forecast [19]. What is more, at present most researchers just used the ANN as a tool for runoff routing of conceptual model, but they never integrated it into runoff generation module in physical based rainfall–runoff models. Additionally, the global optimization for integrated hydrological model based on black-box and physical models was rarely reported. In this study, we take XXT model as an example. From equations of streamflow generation of the XXT model [18], we know that the initial subsurface flow of whole watershed decides the initial groundwater table. So a novel approach for XXT improvement is presented in this paper. In order to find non-linear relationship among hydro-meteorological factors for reasonably revealing the watershed average saturation deficit of every time step, this study selected the initial subsurface flow Qb0 of XXT as the breakthrough point, and then integrated ANN into runoff generation module of XXT to establish an integrated hydrological model and finally applied it in study area with the help of PSO technique. The main objectives of this study are (1) to propose a new integrated model; (2) to compare the new model with XXT in daily runoff modeling over Linyi watershed.

@&#CONCLUSIONS@&#
In order to describe non-linear relationship among hydrological elements well, and meanwhile more reasonably reveal the dynamic update of watershed average saturation deficit in the XXT model of every time step for better runoff forecast, a new method is firstly proposed in this paper. We selected the initial subsurface flow Qb0 of improved XXT as the breakthrough point and integrated ANN into runoff generation module of it. Then, we utilized the non-linear function of ANN to replace the initial subsurface flow of each day for enhancing the dynamic update of the watershed average saturation deficit. At the same time, we used the runoff(t−1), runoff(t−2), rainfall(t−1) and rainfall(t−2) as the inputs of ANN and the initial subsurface flow as the output. Finally this integrated model was applied for daily runoff simulation in Linyi catchment, China. The observed daily precipitation, pan evaporation and stream flow data from 2001 to 2003 were used for calibration, and daily data from 2006 to 2007 were considered as the validation set. USGS 90-m-resolution DEMs were used for driving the models. With the help of PSO optimization algorithm for avoiding the local optimization, the results show that calibration period gives XXT NE coefficient of 0.76 and RMSE of 6.33×10−4m, while the integrated model obtains the NE of 0.82 and RMSE of 5.40×10−4m. During the validation period, the performance indexes of XXT are 0.66 and 5.30×10−4m respectively while 0.71 and 4.91×10−4m for the integrated model. The new integrated model performed much better than the XXT model. Generally speaking, the novel approach by integrating ANN into the XXT model is promising and easily extended to other process-based models.Due to the hydrological model structure becomes increasingly complicated to satisfy the requirements of the gradually complicated environment problems [57], more uncertainties from more factors will impact the modeling results as well. How to precisely estimate the uncertainties of the new proposed model is the next important task. Furthermore, this paper does not focus on the architecture of the ANN and its impact which may influence the final results. Hence, further study of relationship between architectures of ANNs and integration performance is also required in the future work.