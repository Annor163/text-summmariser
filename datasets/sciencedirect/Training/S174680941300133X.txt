@&#MAIN-TITLE@&#
Wavelet based electroretinographic signal analysis for diagnosis

@&#HIGHLIGHTS@&#
To automate an ophthalmologic diagnostic system based on signal processing.Wavelet transform is used to extract the features.Entropy analysis is used and we have formulated an Electroretinographic Index to discriminate between controls and suspects.It will assist the physicians to cross check their diagnosis.

@&#KEYPHRASES@&#
Electroretinogram,Wavelet analysis,Entropy analysis,Morphological analysis,Scalogram,

@&#ABSTRACT@&#
In this paper we have made a humble attempt to automate an ophthalmologic diagnostic system based on signal processing using wavelets. Electroretinographic signals indicate the activity of the retinal cells from different layers of the inner retina and therefore these signals are used to predict various dreadful diseases. In this work we have analyzed 95 subjects from four different classes viz. Controls, Congenital Stationery Night Blindness (CSNB), rod-cone dystrophy and Central Retinal Vein Occlusion (CRVO). The signal features extracted by wavelets are used for morphological and statistical analysis and for getting the subtle parameters like entropy. The results found comprises of difference in the values of wavelet coefficients, a-wave and b-wave amplitude in the case of normal and pathological signals. The colour intensity distribution of scalograms shows highlighting variations in the case of maximum response and oscillatory potentials of the ERG signals for specific type of diseases. Furthermore, we propose an Electroretinographic Index (ERI) from different entropy parameters which can be used to distinguish between the normal and abnormal classes. This new method based on ERG signal analysis can be reliable enough to build a solution for the constraints in the field of ophthalmology.

@&#INTRODUCTION@&#
All the physiological signals exhibit complex behaviour which reflects the non-deterministic and non-linear dynamics of a biological system. To be specific, the bio-signals can contain more information which is not visible to our naked eye. By using conventional tools, such hidden information cannot be extracted. For this reason, wavelets are used for obtaining the subtle parameters like entropy and are used in the context of non-linear signals for the analysis of biomedical time-series [1,2].Electroretinogram is the time-varying potential that arises from the different layers of the retina. It is elicited by a brief flash of light which will produce a repeatable waveform. It is recorded clinically with a contact lens type electrode that carries a silver chloride wire. The electrode is in the shape of a cup, filled with saline and is placed on the cornea. The reference electrode can be placed either on the forehead, temple or earlobe. The amplitude of ERG depends upon the physiological and stimulating conditions, and it is in the range of tenths of a millivolt [3].Each portion of the ERG waveform is contributed by different layers of the retina. Fig. 1shows the cross-section of human retina along with the origin of signals from various retinal cells. A typical ERG signal comprises of R1 and R2 early receptor potential (ERP), a-wave (a1 and a2), oscillatory potentials, b-wave (cone b-wave and rod b-wave) and c-wave. The first and the primary portion of the signal are generated by the initial changes in the photo pigment molecules of the photoreceptor (cones and rods) due to the action of stimulus (flash). This gives rise to a positive R1 deflection followed by R2 deflection which comprises of ERP. It is then followed by a 2ms delay, after which a late receptor potential (LRP) which forms the main constituent of the a-wave and is a corneo-negative waveform [3]. The a-wave forms two dips a1 and a2 which are attributed to the photoreceptor (cones and rods) contribution respectively. It lasts for about 30ms [1,2]. By applying appropriate stimuli, these cones and rods can be separated. For instance, a dim blue light with the dark-adapted environment extracts a rod ERG, whereas a bright red light with a light-adapted environment will exhibit a cone ERG. The second wave which is corneo-positive is the b-wave. In the inner-retinal cells, there are Muller cells which contribute to the b-wave. The Muller cells have no synaptic link to the retinal cells. Now, the trans-membrane potential of these cells depends upon the extra-cellular changes of potassium, the release of which causes the activation of photo-receptors. Muller response can be either from cone or rod photo-receptors separately. The oscillatory potentials are small amplitude wavelets which occur in the light-adapted rising edge of the b-wave. They reflect the activity of inner retinal layers especially the amacrine cells. The c-wave is a slower positive wave and is generated by the retinal pigment epithelium (RPE) as a result of interaction with the rod cells [3].According to the International Standards for Clinical Electrophysiology of Vision (ISCEV) [4], five commonly obtained responses are:The patient has to be dark-adapted for atleast 20min. It is the first signal measured with the standard stimulus of dim white flash (2s between the flash) of 2.5 log units or a blue stimulus [4].It is the combined response of both cone and rod cells. It is produced by the white standard flash (10s between the flash) [4].It can be obtained either from dark-adapted eye (15s between flash) or light-adapted eye (1.5s between flash) using white standard flash. The frequency of interest is set by the band pass filter i.e. 75–100Hz on the lower end and 300Hz and above at the higher end [4].Patients should be light adapted for atleast 10min before recording the cone response. The interval between the flash (white or bright-red) should be 0.5s [4].Flashes are presented at the rate of 30 stimuli per second. Rods will follow the flickering light up to 12–17Hz and cones will follow up to 60–70Hz [4].The first remarkable work done by Bornschein et al. was the study of ERG in normal, colour-blind and night blind subjects under different status of adaptation of varying stimuli [20]. Another work was by Barraco et al. in which the results indicate the occurrence of three frequencies in the range 20–200Hz [1]. They had also analyzed the time-frequency behaviour of the a-wave and concluded that there is an absence of the second dip in CSNB patients [2,12]. Garry et al. evaluated cone and cone-driven retinal function in patients with Smith–Lemli–Opitz Sydrome [18]. Tomasz Rogala and Andrzej Brykalski created a wavelet based feature space for the classification of Pattern ERG's. Principal Component Analysis were used to visualize both time-domain features and wavelet features and found that PERG waveforms are better separable in wavelet feature space than time-domain feature space [17].In all the existing methods, they have analyzed either cone response or rod response of the ERG signal. In our proposed work we are dealing with all the five steps of the ERG signal and got the classification accuracy of 90.5%. To the best of our knowledge, no work is reported yet, attempting five steps in ERG analysis for the diagnosis of the ophthalmological diseases. In all the existing methods the authors have analyzed the a-wave of the ERG signal for the diagnosis of CSNB. But in our work, we have formulated an index to differentiate the classes and scalogram analysis is also performed to distinguish between the classes which have more reliability over the existing methods.Digital data is collected using the machine TOMEY EP 1000 version 3.0.4 from 95 patients with their consent. These patients under the study were those suffering from Congenital Stationery Night Blindness (CSNB), Cone Rod Dystrophy (CRD) and Central Retinal Vein Occlusion (CRVO). Rod response, Cone response, Maximal response, Oscillatory potentials and Flicker response were recorded from the above subjects and the same set of responses were obtained from normal Control subjects. In this work, we have collected the data from four different classes: 30 Controls, 20 CSNB, 30 CRD and 15 CRVO. Proper informed consent was obtained from both the clinicians and the staffs of Little Flower Hospital and Research Centre, Angamaly, India before collecting the data for this study.The data collected are analyzed by wavelets and several subtle features are extracted. The details regarding the clinical situation and the brief description about the parameters are given below:In the case of controls the amplitude range of the rod response is 140–250μV with the implicit time of 80–90ms, amplitude of maximum response ranges from 250–500μV with the implicit time of 45ms, cone response amplitude value ranges from 100 to 180μV with the implicit time of 32ms and 30Hz flicker amplitude is approximately 50μV.Congenital Stationer Night Blindness (CSNB) is an X-linked non-progressive retinal disorder with abnormal nocturnal vision. Additional symptoms associated with it are myopia and nystagmus. The ERG waveform is characterized by a negative ERG, where the amplitude of b-wave is reduced as compared to the a-wave [5,6].Cone-rod dystrophies (CRD) are also called retinitis pigmentosa group which is an inherited retinal dystrophy with retinal pigment deposits visible on fundus examinations. There is a drastic reduction of the amplitude of a- and b-waves. The CRD is again classified into Typical RP (Retinitis pigmentosa), RP with early macular involvement and early onset RP or late stage RP. In typical RP, the first symptom is night blindness, followed by vision loss in the daylight after several years. In the second type of CRD, macular involvement occurs early and there is a prominent involvement of rods which supports the diagnosis. In the third type, there is a decrease in the visual acuity along with the macular involvement. The diagnosis is based on the appearance of night blindness or loss of central vision first [7,9].Blood enters the eye through the central retinal artery (CRA) and leaves through the central retinal vein (CRV). Due to high blood pressure or glaucoma, there is a risk of clotting of blood in the CRV which leads to retinal injury or Central Retinal Vein Occlusion (CRVO) [8].Most of the signals in practice are time-domain raw signals. Time-domain representation of the signal is not the best one when it is dealt with signal processing applications. Several mathematical transformations are applied to the raw signal to obtain the hidden information in the frequency content of the signal. This gives rise to the Fourier transform, Short time Fourier transform (STFT) and wavelet transform. Apart from these transforms there are many other transforms that are used by engineers and mathematicians. The Fourier transform has proved better when the signal of interest is stationery in nature, i.e. it gives the spectral content of the signal, but it gives no information about the time those spectral components appear. In STFT, the non-stationery signal is divided into small segments, where these segments are considered as stationery. Here a window function is chosen such that the width of the window is equal to the segment of the signal. In short, STFT of the signal is nothing but it is the Fourier transform of the particular signal multiplied by its window function. The problem with STFT is one cannot know the exact time at which a particular spectral component occur instead one can only know the time interval at which the band of frequencies exist which leads to the resolution problem. This problem of resolution can be solved by wavelet transform. Since all the biological signals are non-stationery in nature, wavelet transform proved the better option with its multi-resolution analysis [10,11]. Wavelets provide a time-frequency representation of the signal. Our region of interest is in the low frequency part of the ERG signal and discarding the high frequency part so that there remains a smoother representation of the original signal with its lower frequency components intact.In continuous wavelet transform (CWT), the width of the window is adjustable which solves the resolution problem. The CWT is defined as follows [10]:(1)W(a,b)=∫−∞+∞f(t)1aψ*t−badt=〈f(t),ψa,b(t)〉(2)ψa,b(t)=1aψ*t−badtHere CWT is applied over the signal f(t) and the basis function is the mother wavelet Ψa,b(t) which is the prototype for generating the child wavelets by scaling and translations where ‘a’ is the scale parameter and ‘b’ is the translation parameter [11]. The normalizing factor1/aensures that the energy remains same for all ‘a’ and ‘b’. By definition, the CWT is computed by changing the scale of the window and shifting the window in time, then multiply it by the signal to be transformed and integrating all over the times. At low frequencies, the procedure offers good frequency resolution, but poor time resolution and at higher frequencies there is good time resolution but poor frequency resolution [12].Discretization of the CWT will give discrete wavelet transform (DWT) which saves the computation time. Discretization is done on dyadic basis [16].(3)ψj,k(t)=2−j/2ψ(2−jt−k)where ‘j’ is the scale parameter and ‘k’ is the translation parameter. In DWT, the signal is passed through the low pass filter (LPF) to analyze the low frequencies which employs the scaling function ϕ(t) and high pass filter (HPF) to analyze the high frequencies which gives the wavelet function ψ(t). This will change the resolution of the signal and the scale of the signal is changed by up sampling and down sampling operations. In essence, the low pass filtering halves the resolution but the scale remains unchanged. Sub-sampling by 2 will double the scale which is expressed mathematically as the dilation equation and wavelet equation respectively.The dilation equation is given by:(4)ϕ(t)=∑kckϕ(2t−k)where Ckis the low pass filter (approximation) coefficients and ϕ(t) and ϕ(2t−k) spans the same space Vo.The wavelet equation is given by:(5)ψ(t)=∑kdkϕ(2t−k)Similarly dkis the high pass (detail) coefficients and ψ(t) and ϕ(2t−k) spans the same space Wo[8]. In our work we are applying Mexican hat wavelet (MHW) for the maximum response of the ERG data and Morlet wavelet to the oscillatory potentials of the ERG. Cross correlation of the Oscillatory potential with Morlet wavelet is approximately near to 1 in the case of controls. By applying Haar transform, we are using sub-band decomposition of the rod response, cone response and 30Hz flicker of the ERG signal. The choice of the type of wavelet used depends upon different characteristics of the signal. MHW is a continuous, non-orthogonal wavelet which provides a good detection and emphasizes the stationery activity of the signal which highlight either to minima or maxima [16,17].Features are extracted from the ERG signal using wavelets based on entropy analysis, statistical analysis and morphological analysis. The ERG signal processing system can generally be classified into various functional modules as in Fig. 2. This section gives a brief description of these parameters.Entropy can be defined as a thermodynamic quantity which measures the degree of disorder in the system. Basically there are two types of entropy-spectral entropies and embedding entropies. In the spectral entropy, power spectrum of the signal is obtained and the amplitude component of this spectrum is taken as the probabilities for calculating the entropy. An example for spectral entropy is Shannon entropy. The embedding entropies directly use the time series to calculate the entropy. An example for embedding entropies are approximate and sample entropy [13–15].Approximate entropy is used to detect the dynamics in the underlying episodic behaviour which cannot be identified using peak occurrences or amplitudes. It is defined as logarithmic likelihood that the data points which are closer to each other will be same for the next comparison with a longer pattern. In other words the deterministic signals posses’ small ApEn value and random signals have high ApEn value [13–15].(6)ApEn(m,r,N)=1N−m∑i=1N−mlog(Cim+1(r))−1N−m+1∑i=1N−m+1log(Cim(r))Here the correlation integralCim(r)is calculated with m as pattern length and r is the effective filter.The basic idea of both ApEn and SampEn are same but there is a slight computational difference. Here it does not calculate self-matching and it is based on the template approach to find a match of length m+1. SampEn algorithm involves the following steps. Let x(n)=[x1, x2, …, xN] denotes the ERG time-series signal. First we have to create the vector sequences of size m. X(i)=[x1, xi+1, …, xi+m−1] where i=1, 2, …, N−m+1. Now the distance between two vectors is calculated by:(7)dm[X(i),X(j)]=max0,1,…,m−1[|xi+k−xj+k|]In the next step, the number of similar segments in the two vectors is calculated.(8)nm=dm[X(i),X(j)]≤ri≠j(9)nm+1=dm+1[X(i),X(j)]≤ri≠jwhere r is the tolerance value. Now, the similarity measures of the segments are:(10)Bim(r)=1N−m−1nm(11)Aim(r)=1N−m−1nm+1Next step is to calculate the mean measures:(12)Bm=1N−m∑i=1N−mBim(r)(13)Am=1N−m∑i=1N−mAim(r)Sample entropy is given by:(14)SampEn(m,r,N)=−lnAm(r)Bm(r)where m is the pattern length and r is the effective filter. In theory, sample entropy is independent on N value [13,15].Power spectral density is calculated by applying the Fourier transform and the entropy is calculated by multiplying the power in each frequency by the logarithm of the inverse of Pfand taking the summation of entropy over entire range [13].(15)SEN=∑fPflog1pfRecurrence period density entropy is used to determine the repetitiveness of the signal. The RPDE value Hnorm=0 for purely periodic signals and Hnorm=1 for random signals.(16)Hnorm=−1lnTmax∑t=1TmaxP(t)lnP(t)where Tmax=larger recurrence value [21].Entropy decreases for an abnormal ERG signal compared to the case of controls. We have used the entropy parameters to formulate an index called Electroretinographic Index (ERI) to distinguish between the normal and pathological classes. Using the individual entropy values it is difficult to diagnose a particular group. So we have formulated an ERI based on entropy parameters. The range within which the ERI varies for each class is unique.Electroretinographic index (ERI) by using all the entropies is given by:(17)ERI=5×RPDE−(ApEn×SampEn×2×SEN)Here we are measuring the b-wave amplitude and a-wave amplitude. In certain diseases like CSNB, an electro-negative pattern of ERG is obtained. Electro-negative pattern indicates that the b-wave is smaller than a-wave. In our work, we are calculating the algebraic sum of b and −a value, where the negative sign indicates that a-wave is the negative peak of the ERG signal. This result can be used to effectively differentiate and diagnose different pathological classes [19,20]. MATLAB Software has been used for the analysis purpose in the present work [22].

@&#CONCLUSIONS@&#
