@&#MAIN-TITLE@&#
Development of an inverse finite element method with an initial guess of linear unfolding

@&#HIGHLIGHTS@&#
IFEM method is a fast tool to predict initial blank and strain distribution.To avoid converging problem unfolding method is used as an efficient initial guess.This initial guess decreases the number of iteration in the numerical solution.A non-uniform distribution of friction is exerted on blank‌holder zone.This method is capable of being applied to complicated geometries.

@&#KEYPHRASES@&#
Sheet metal forming,Initial blank design,Finite element method,Linear unfolding,

@&#ABSTRACT@&#
An inverse finite element method (IFEM) has been developed for estimation of the blank size and prediction of the strain distribution in sheet metal forming. In the inverse method the nodal coordinates in the final shape are known and their corresponding positions on the initial blank should be determined. The developed method deals with logarithmic large strains of membrane triangular elements, virtual work principle and a new approach for friction modeling. This method leads to a system of nonlinear equations which is highly sensitive to the initial guess. In order to avoid the converging problems, especially in the quasi-vertical walls, an appropriate initial guess is introduced. The introduced initial guess guarantees the convergence; furthermore the number of iterations in the nonlinear numerical solution is decreased and the solution speed is significantly increased. Three different problems are analyzed with the developed method and the results show good agreement to commercially available finite element software and experimental results.

@&#INTRODUCTION@&#
Sheet metal forming is a complicated process that depends on numerous parameters such as die geometry, blank shape, drawing ratio and blank holder force. An important factor for having a successful process without defects is the initial blank shape. The traditional method to simulate the sheet metal forming is the forward incremental finite element method [1–3]. In the forward method, computations start with the blank geometry which is unknown at the initial design stage. Therefore, trial and error is the nature of the forward method which is very time consuming. Due to this fact, a method is needed to predict the initial blank shape directly. So many attempts have been carried out in order to obtain the initial blank directly.Karima [4] made use of the slip-line method to design the initial blank shape. Vogel and Lee [5] and Chen and Sowerby [6] used the characteristic of plane stress, while Blount and Stevens [7] used geometric mapping to design the initial blank shape. These methods provide good guidance to design the initial blank shape, but they neglect the height of the deformed parts, have geometric restrictions, and do not consider the deformation behavior of the materials. On the other hand, there have been several attempts to design the blank shape and estimate the distribution of the strain in a deformed part with deformation theory of plasticity. Majlessi and Lee [8–11] showed that using this theory is reasonable for rapid simulation in the first stages of design. They extended the theory of Levy et al. [11] and applied it to axi‌symmetric one step and multi-stage problems, obtaining good results. However, this method cannot be applied without boundary conditions implementation like friction and blank holder force. Therefore, the crash form process cannot be analyzed by this approach. Guo and Batoz [12–14] derived a formulation for field problems as an inverse method to obtain the initial blank shape and the thickness distribution in a deformed part. Due to the nonlinearities that come from considering large deformation and material properties, this method is very sensitive to initial guess and needs an efficient initial guess. Based on the work by Karima et al. [15], Assempour et al. [16–18] developed a linear inverse finite element method known as unfolding technique. Their formulation is based on the principle of potential energy minimization and linear strain–displacement relation. Thus, their formulation leads to a system of linear equations which can be solved very quickly. This method is very efficient in obtaining the initial blank; however, due to the nature of linear formulation, the strain values are less accurate compared with nonlinear formulation.In the present study, an inverse finite element formulation has been developed which deals with the principle of virtual work, deformation theory of plasticity and logarithmic large strains of membrane triangular elements. This method leads to a system of nonlinear equations which is very sensitive to the initial guess and may diverge in numerical solution. In order to avoid the convergence problems, especially in the quasi-vertical walls, the linear unfolding method is used as an appropriate initial guess. Besides, a new approach for friction modeling is introduced which considers a non-uniform distribution of the friction force on the nodes located under the blank holder zone. Numerical simulations have been conducted and results have been compared with Abaqus Explicit and experimental results to verify its feasibility.In the inverse approach only two states are considered:(1)The initial flat blank obtained from the initial guess with a known thickness.The final work piece with a known tridimensional mid-surface discretized with flat triangular membrane elements.The geometry of final shape is discretized with linear triangular membrane elements. Positions of elements in the flat plane are obtained by an appropriate initial guess.Fig. 1 shows the schematic elements of the initial and final shapes.By considering only the initial and final states of elements and calculating left Cauchy–Green deformation tensor [B], principal stretches are obtained as below:(1)λi−2={ni}T[B]−1{ni}(i=1,2)where {ni} are eigenvectors of [B]−1[19]. Principal stretches which are also eigenvalues of [B], can be calculated as follows:(2){λ1=((1/2)(B11+B22)+(1/2)((B11−B22)2+4B122)1/2)−1/2λ2=((1/2)(B11+B22)−(1/2)((B11−B22)2+4B122)1/2)−1/2λ3 is also obtained from λ1 and λ2 by assuming incompressibility.Bij; i,j=1,2 are components of [B]−1[19]:(3){B11B22B12}=1(h2yh3x−h2xh3y)2×{h3y2L2+h2y2L3−(L2+L3−L1)h2yh3yh3x2L2+h2x2L3−(L2+L3−L1)h2xh3x−h3xh3yL2−h2xh2yL3+(1/2)(L2+L3−L1)(h2yh3x+h2xh3y)}where Li=||Hi||2 and hix, hiyare the components of hi(see Fig. 1) in the element local coordinates of final configuration.Logarithmic strains in element local coordinates can be obtained from Eq. (2) as follows:(4){εxεyεxy}={lnλ1cos2θ+lnλ2sin2θlnλ1sin2θ+lnλ2cos2θ(lnλ1−lnλ2)sinθcosθ}where θ is the angle between thexaxis of the local coordinate system and the principal stretch λ1[19]:(5)θ=tan−1(λ1−2−B11B12)Under conditions of plane stress (σz=σxz=σyz=0) and planar isotropic material, Hill's function gives(6)f(σij)=σxx2+σyy2−2r1+rσxxσyy+21+2r1+rσxy2where r is the Lankford value.Based on deformation theory of plasticity and implementing flow rule on Hill's function, the constitutive equation is defined as(7){σxxσyyσxy}=23σ¯ε¯[ABA0AAC000AD]{εxxεyyεxy}where,(8)A=r(2+r)(1+2r),B=(1+r)r,C=(1+r)r,D=1r,The effective strain corresponding to Eq. (6) can be expressed as(9)ε¯=(2/3)A(Bεxx2+2εxxεyy+Cεyy2+2Dεxy2)The effective stressσ¯is also obtained fromε¯by the Holloman power law.The principle of virtual work is applied to the final work piece:(10)∑eWinte−∑eWexte=0where e is element numbers and,(11)Winte=∫ve〈ε⁎〉{σ}dv(12)Wexte=∫ve〈u⁎〉{f}dvwhere, 〈u⁎〉 and 〈ε⁎〉 are the virtual displacements and their corresponding virtual membrane strains, veis the element volume, {σ} are the Cauchy stresses, and {f} are the external forces such as tool actions in element local coordinates.Element internal workWintecan be written as below:(13)Winte=〈Un⁎〉{Finte}With〈Un⁎〉=〈Uj⁎,Vj⁎,Wj⁎〉,j=1,2,3. U⁎, V⁎, W⁎ are the virtual displacements in the global coordinate system XYZ. Since the vertical displacement of each node is known,Wj⁎=0.{Finte}are the element internal forces vector and are given by(14){Finte}=[T]T[B]T{σ}Ahwhere [B] is the strain operator in the local coordinate system of each element. [T] is the transformation matrix between global and local coordinate systems. A is the element area and h is the thickness of the element. h is obtained from thickness stretch which is modified at each iteration.The element external workWextecan be written as below:(15)Wexte=〈Un⁎〉{Fexte}where{Fexte}are the element external forces vector due to the tool actions. Calculation of the element external forces will be described in the next section.Substituting Eqs. (13) and (15) in Eq. (10), Eq. (16) is derived:(16)∑eFinte−∑eFexte=0Here, the external forces mainly include the blank holder and tool forces. The blank holder and tool forces consist of normal and friction forces. However, under the blank holder, the normal forces acting on the two sides of the sheet are in equilibrium; therefore, only the friction forces are considered.Friction force is path dependent, but in the inverse method only final and initial configuration is considered; therefore it is impossible to simulate the friction forces perfectly. So a simplified method is introduced to model the friction force per unit area, under the blank holder. In this method, a non-uniform distribution of the friction force is considered on the nodes under blank-holder zone. Since the contact time for each node in this region increases from inner to outer edge, a linear weight function (ω) is defined to consider this non-uniformity. The following equation gives the blank holder friction force per unit area:(17){ft}=−2ωμqn{t}where, qnis the normal blank holder pressure, μ is the coefficient of friction, {t} is the material flow direction and ω is the linear weight function, which is 1 at nodes initially located at the outer edge of the blank and 0 at nodes initially located at the inner edge of the die (as shown inFig. 2).Since the material flow direction is unknown prior to the analysis, a good initial guess is used to find the nodal positions in the flat plane and therefore the material flow direction. The unit vector representing the material flow direction {t} is as follows:(18){t}={ut}|ut|(19){ut}=(xj−Xj,yj−Yj,0)where, Xj, Yjare the coordinates of node j in the initial blank obtained by initial guess and xj, yjare the coordinates of node j in the final configuration.The punch and die effects correspond to the normal and tangent components of the contact force, as shown inFig. 3:(20){F}={Fn}+{Ft}⇒F{nf}=Fn{n}−Ft{t}where, {n} and {t} are the normal and tangent unit vectors. Fnis the normal force of tool and Ftis the friction force between the tool and sheet. The unit vector in the direction of the resultant force, {nf}, can be specified as follows:(21){nf}=11+μ2({n}−μ{t})So the direction of the resultant force is known while its magnitude, F, is unknown.Under the blank holder, there are two equations and two unknowns (two horizontal displacements Uk, Vk) at each node k:(22){Fextk}−{Fintk}={ftxk(Uk,Vk)ftyk(Uk,Vk)}−{FintXk(Uk,Vk)FintYk(Uk,Vk)}=0Under the punch and die regions, there are three equations and three unknowns (Fkas well as two horizontal displacements Uk, Vk) at each node k:(23){Fextk}−{Fintk}={Fknfxk(Uk,Vk)Fknfyk(Uk,Vk)Fknfzk(Uk,Vk)}−{FintXkFintYkFintzk}=0Fkcan be calculated by using the third equation, but some numerical problems may arise especially at quasi vertical walls because of small values of nf. The following relation proposed by Naceur et al. [13] can be used in order to reduce numerical problems.(24)Fk=〈nf〉{Fintk}Therefore, the system of three equations (23) can be reduced to two equations with two unknowns Uk, Vk:(25){Fextk(Uk,Vk)}−{Fintk(Uk,Vk)}={FknxfFknyf}−{FintXkFintYk}=0The Newton Raphson method has been implemented for solving the set of nonlinear Eqs. (22) and (25) as follows:(26){Ui+1}={Ui}+α{ΔU}(27){ΔU}=[Ji]−1{R(Ui)}where, [Ji] is the Jacobian matrix:(28)[Ji]=−[∂{R(U)}∂{U}]U=Uiα is a coefficient between 0 and 1. According to the examples solved in this work, suitable value for α is between 0.3 and 0.5. Values less than 0.3 decrease the convergence speed and values between 0.5 and 1 usually lead to divergence.The Newton–Raphson method expressed by Eq. (26) is highly sensitive to the initial guess {U0}. So initial guess is an important issue to speed up and guarantee the convergence of Newton–Raphson iteration. In this study the unfolding technique is used as initial guess.The unfolding technique, as discussed in Section 1, is a linear type of IFEM that is very quick and efficient to obtain the initial blank. This method avoids the convergence problems in the nonlinear method. Detailed description about this method is given in the following section.The idea of the initial guess used in the present analysis is a linear mapping of the deformed surface of the final state to a flat surface of the initial state. In the mapping procedure, the surface is discretized into triangular elements and it is assumed that the material in each element deforms linearly.The scheme for the initial guess is as follows:Step 1. Unfold each element in the final configuration to the flat plane, as shown inFig. 4.Step 2. Project each element in the final configuration on the flat plane, as shown inFig. 5.Step 3. Calculate displacement vector between the unfolded and projected elements, Δueand consequently the force vector, Fewith respect to Eq. (29).(29)Fe=KeΔuewhere Keis the linear stiffness matrix of triangular membrane element.Step 4. Assemble the force vectors and stiffness matrices to obtain global displacement vector:(30)ΔU=K−1FAdd this vector to the coordinates of projected nodes to obtain the initial estimation of nodal coordinates.Step 5. Calculate element effective strain and stress in accordance with Section 2.1 by using the final nodal coordinates and the initial nodal coordinates obtained from Step 4.Step 6. Correct the material properties with respect toFig. 6 and repeat Steps 3–5 until convergence. The convergence criterion has been selected according to Ref. [16]. It usually takes about 4–6 iterations to obtain convergence.For more details about unfolding technique, refer to Ref. [16].

@&#CONCLUSIONS@&#
In the present study, an inverse finite element formulation has been developed which deals with principle of virtual work, deformation theory of plasticity, logarithmic large strains of membrane triangular elements and a new approach for friction modeling. In order to avoid the convergence problems, especially in the quasi-vertical walls, the linear unfolding method has been used as an appropriate initial guess. Furthermore, using the unfolding method as initial guess decreases the number of iterations in the nonlinear numerical solution and the solution speed is significantly increased.The numerical results demonstrate that the present algorithm calculates initial blank shape and strain distributions reasonably good even for complicated shapes. The observed errors are intrinsic to the inverse method because of applying deformation theory of plasticity and ignoring path dependent nature of deep drawing. However, this method helps engineers to quickly estimate the initial blank shape and strain distribution for a new shape. Therefore, it has a significant application in automobile, airplane and home appliance industry by letting engineers to easily modify the design in blue print stage.