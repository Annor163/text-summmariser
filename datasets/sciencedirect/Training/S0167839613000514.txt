@&#MAIN-TITLE@&#
Computing the topology of a real algebraic plane curve whose defining equations are available only “by values”

@&#HIGHLIGHTS@&#
The topology of the curve is obtained directly from Lagrange interpolation data.Roots of polynomial matrix determinants are obtained as generalized eigenvalues.The algorithm is very useful when the explicit polynomial expressions are huge.

@&#KEYPHRASES@&#
Computations in the Lagrange Basis,Algebraic curve topology,Parametric curve topology,Generalized eigenvalues,

@&#ABSTRACT@&#
This paper is devoted to introducing a new approach for computing the topology of a real algebraic plane curve presented either parametrically or defined by its implicit equation when the corresponding polynomials which describe the curve are known only “by values”. This approach is based on the replacement of the usual algebraic manipulation of the polynomials (and their roots) appearing in the topology determination of the given curve with the computation of numerical matrices (and their eigenvalues). Such numerical matrices arise from a typical construction in Elimination Theory known as the Bézout matrix which in our case is specified by the values of the defining polynomial equations on several sample points.

@&#INTRODUCTION@&#
The problem of computing the graph (even topologically) of an implicitly defined algebraic plane curve has received special attention from both Computer Aided Geometric Design and Symbolic Computation, independently. For the Computer Aided Geometric Design community, this problem is a basic subproblem appearing often in practice (see, for example, Bajaj et al., 1988; Keyser et al., 2000; Song et al., 2004; Farouki et al., 2005 or Hass et al., 2007). For the Symbolic Computation community, on the other hand, this problem has been the motivation for many achievements in the study of subresultants, symbolic real root counting, infinitesimal computations, etc. By a comparison between the seminal papers Arnon and McCallum (1988); Gianni and Traverso (1983); Roy (1996); Sakkalis (1991); Cellini et al. (1991); Cucker et al. (1991); Feng (1992) and Roy and Szpirglas (1990) and the more renewed works of Gonzalez-Vega and El Kahoui (1996), Hong (1996), Gonzalez-Vega and Necula (2002), Busé et al. (2005), Seidel and Wolpert (2005), Eigenwillig et al. (2007), Lionel et al. (2008), Kerber (2009), Alcázar and Díaz-Toca (2010) and Cheng et al. (2010), one can see how the theoretical and practical complexities of the algorithms dealing with this problem have been dramatically improved.This paper is devoted to introducing a new family of methods for determining the topology of a real algebraic plane curve presented either parametrically,(x(t),y(t)), or defined by its implicit equationf(x,y)=0. The main difference between our approach and those previously mentioned is the fact that here we completely replace the algebraic manipulation of the polynomials (and their roots) with computations of numerical matrices (and their eigenvalues). This is motivated by the fact that we prefer to deal with numerical matrices of moderate size instead of high degree polynomials. This is typically a better strategy from the numerical point of view when the coefficients of the polynomials in the parametrization(x(t),y(t))or of the implicit equationf(x,y)=0are floating point real numbers.But there is a stronger motivation behind the new approach to be introduced here. In many practical situations the polynomialf(x,y)or the polynomials in(x(t),y(t))appear presented in a non-expanded form which if expanded in the standard monomial basis produce polynomials of high degree, with big coefficients whose manipulation is a difficult task. For example, when computing the intersection of two surfaces, or when computing offset curves (for more examples see Diaz-Toca et al., 2013). Otherwise, if the polynomials describing the considered curve are presented by their values then they can be easily evaluated at any desired point with a reasonable computational cost. This is our starting point: we do not assume that we have an explicit description (in the standard monomial basis) of the polynomialf(x,y)or of the polynomials in(x(t),y(t)). We do only require, first, the knowledge of an upper bound for the degree of the polynomials which describe the considered real algebraic plane curve and second, the mathematical tools to evaluate those polynomials at any desired point.Another application of the approach presented in this paper is to generate the points of an offset curve which is at distance δ from a parametric curve(x(t),y(t))described by its values. Typically, the implicit equation of such an offset curve is either complicated to compute or is a dense bivariate polynomial of big size. A point(x,y)is on the offset if, for some t, the following equations are verified:(1)F(x,y;t)≡(x−x(t))2+(y−y(t))2−δ2=0,G(x,y;t)≡x′(t)(x−x(t))+y′(t)(y−y(t))=0.The implicit equation can be obtained as the determinant of the Bézout matrix,Bez(F,G), with respect to t (for a definition, see Section 1). For example, if we let the distanceδ=1, and the initial curve is parametrized byx(t)=t5+t2−3t,y(t)=t34−t2+1,the determinant ofBez(F,G)is a polynomial of degrees 14 and 18, in x and y, respectively, with 158 terms whose coefficients have a number of significant digits ranging from 33 to 44.The paper is organized as follows: In Section 1, we detail some standard facts about the Bezoutian which is a tool from Elimination Theory. In Section 2, we introduce the linearization tools which are going to be used to determine the roots of the determinant of a matrix polynomial without computing the determinant. In other words, instead of computing the determinant and then its roots we compute the so-called generalized eigenvalues of a matrix pencil (in this context known as the companion matrix pencil). In Section 3, we give an explicit description of how to compute the Bézout matrix for a pair of univariate polynomials and the companion matrix pencil associated with a matrix polynomial, in the Lagrange polynomial basis. In Section 4, we summarize the standard strategies used for computing the topology off(x,y)=0; we show how algebraic manipulation of polynomials can be replaced with the computation of the Bézout matrix by values and the corresponding generalized eigenvalues. Sections 5 and 6 are devoted to introducing the algorithms for computing the topology of a real algebraic plane curve presented by its implicit equationf(x,y)=0or by its parametrization(x(t),y(t))in the Lagrange polynomial basis. Both sections include a detailed description of the corresponding algorithm together with several examples and the results coming from our tests and experimentations. Section 7 shows how to compute the topology of a real algebraic plane curve presented by its parametrization(x(t),y(t))in the Lagrange polynomial basis by applying the same algorithm used for the implicit equation case in Section 5; in this case it is enough to show how to evaluate the implicit equationf(x,y)of(x(t),y(t))without computingf(x,y), explicitly. In Section 8, we briefly discuss some numerical issues posed by our algorithms. Finally, in Section 9, we summarize the results and highlight several points where we believe our approach can be improved.Basic notationIn this paper, vectors and matrices are denoted by bold letters. The notationp(t)∈K[t]indicates a univariate polynomial in the variable t with coefficients fromK. We denote the vector space of the polynomials of degree at most n byPn. For bivariate polynomials of degree at most m in the first argument and degree at most n in the second argument, the associated vector space is denotedPm,n. For a bivariate polynomialp(z,t),degz(p(z,t))(resp.degt(p(z,t))) denotes the degree of p when considered as a polynomial in z (resp. t) with polynomial coefficients in t (resp. z). The space ofn×nsquare matrices with elements inKwill be denoted byMn(K).Standard definitions of the Bezoutian make explicit reference to the monomial or power basis (see, e.g., Barnett, 1990). However, all constructions of the Bézout matrix make use of the so-called Cayley quotient which makes no reference to any particular basis in which the given polynomials are represented.Definition 1Letp(t),q(t)be univariate polynomials withn=max(deg(p(t)),deg(q(t))). The Cayley quotient ofp(t)andq(t)is the polynomialCp,qof degree at mostn−1defined by(2)Cp,q(z,t)=p(t)q(z)−p(z)q(t)t−z.AlthoughCp,qas written in (2) is a rational function of z and t, the numerator vanishes ifz=t; as sucht−zdividesp(t)q(z)−p(z)q(t), and the Cayley quotientCp,qis a bivariate polynomial inPn−1,n−1, as stated. The apparent discontinuity in the Cayley quotientCp,q(z,t)in Eq. (2) when t goes to z can be removed (see Shakoori, 2007 for a proof):limt→zCp,q(z,t)=p′(z)q(z)−p(z)q′(z).Definition 2IfΦ(t)=[ϕ1(t),…,ϕn(t)]is a basis forPn−1thenCp,qin (2) can be uniquely writtenCp,q(z,t)=∑i,j=1nbijϕi(z)ϕj(t).The symmetric matrix with coefficientsbijis called the Bezoutian or the Bézout matrix associated withp(t)andq(t)in the polynomial basisΦ.Note that ift⁎∈Cis a common zero ofp(t)andq(t), thenΦ(t⁎)is a vector in the nullspace of the Bezoutian.The construction of the Bézout matrix using the Cayley quotient in the monomial basis (i.e., power basis) is classic (see for example Barnett, 1990). The computation of the Bézout matrix in the Bernstein and Chebyshev bases have been studied in Bini and Gemignani (2004) and Barnett (1989), respectively.Definition 3Letp(t)andq(t)be as described in Definition 1. The Bézout matrix associated withp(t)andq(t), in the monomial basis, is the symmetric matrix:Bez(p,q)=(b0,0…b0,n−1⋮⋮bn−1,0…bn−1,n−1)where the elementsbi,jare defined by the Cayley quotient:(3)p(t)q(z)−p(z)q(t)t−z=∑i,j=0n−1bi,jtizj.The Bezoutian determines the degree of the greatest common divisor of p and q becausedeg(gcd(p,q))=n−rank(Bez(p,q)). The rank ofBez(p,q)is equal to the order of the largest nonsingular principal minor, when starting from the lower right hand corner (see Bini and Pan, 1994 and Helmke and Fuhrmann, 1989).The nullspace of the Bezoutian has an elegant structure presented in the next proposition that can be used to determine the common roots of the given polynomials (for a proof see Heinig and Rost, 1984, p. 42).Proposition 1The nullspace ofBez(p,q)is spanned by(4)nullspace(Bez(p,q))=[X1,X2,…,Xk]where each blockXjcorresponds to a different common root of p and q. The dimension of each block is the geometric multiplicitykjof the common rootxj(i.e., its multiplicity as a root of the greatest common divisor of p and q). Moreover each block can be parameterized by the common rootxjin the form(5)Xj=(100…0xj100xj22xj2⋮xj33xj26xj⋱⋮⋮⋮⋮⋱(kj−1)!⋮⋮⋮kj!xj⋮⋮⋮xjn−1(n−1)xjn−2(n−1)(n−2)xjn−3…(n−1)kj−1̲xjn−kj)wherenkj̲=n(n−1)⋯(n−kj+1).In particular, when the nullspace is of dimension 1, it is generated by[1,x,x2,…,xn−1]Tfor x the unique common root ofp(t)andq(t). We may, if we choose, order the construction of the quadratic form for the Bezoutian in such a way as to reverse the row order of the entries of the nullspace.Finally the next proposition and corollary show how the structure of the nullspace for the Bezoutian can be very helpful to deal with the computation of multiple roots (under certain additional hypothesis).Proposition 2Let p be a polynomial inC[t]. Ifi⩾1,p(i)=dipdtiandNiis the subspace defined by:Ni=⋂j=1inullspace(Bez(p,p(j)))thendim(Ni)=deg(gcd(p,p(1),…,p(i))).ProofIfn=deg(p)and Θ is the linear mapping fromCntoCnigiven by the matrix(6)(Bez(p,p(1))Bez(p,p(2))⋮Bez(p,p(i)))(columnwise) thennullspace(Θ)=⋂j=1inullspace(Bez(p,p(j)))=Ni.By applying Theorem 3.2 in Diaz-Toca and Gonzalez-Vega (2002):dim(Ni)=dim(nullspace(Θ))=n−rank(Bez(p,p(1))Bez(p,p(2))⋮Bez(p,p(i)))=n−(n−deg(gcd(p,p(1),…,p(i))))=deg(gcd(p,p(1),…,p(i)))as desired.  □Corollary 1A polynomialp∈C[t]has exactly one multiple root of multiplicitym+1(and no other multiple roots) if and only ifdim(Ni)−dim(Ni+1)=1for i in{1,…,m}(note that this implies thatNm+1={0}). Moreover, if α is such a unique multiple root of multiplicitym+1and(v1,…,vn)is any nonzero vector inNm, thenα=v2v1.The classical discriminant computation for determining the x-projection of the critical points of the real algebraic plane curve defined by the equationf(x,y)=0is going to be replaced by its formulation as a nonlinear eigenvalue problem. In other words, instead of computing the real roots of the determinant of a matrix polynomial directly, we solve a sparse generalized eigenvalue problem for a regular matrix pencil.In this section we review some of the main properties of generalized eigenvalues to be used in the next sections. See Amiraslani et al. (2009), Corless et al. (2007) for a more detailed discussion.We define ann×nmatrix polynomial as ann×nmatrixA(t)whose entriesAij(t)are polynomials in t (1⩽i,j⩽n). The degree of a matrix polynomialA(t)is the maximum degree of its entries, i.e.,deg(A(t))=max1⩽i,j⩽ndeg(Aij(t)).Given a matrix polynomialA(t), the polynomial eigenvalue problem is as follows:(7)Findt⁎∈Csuch thatA(t⁎)is singular.There is an extensive literature on such problems; theoretical results about solutions of polynomial eigenvalue problems are available in Gohberg et al. (1982), Manocha and Demmel (1995). Moreover, standard algorithms exist for polynomial eigenvalue problems expressed in the power basis through linearization, i.e., finding an associated pair of companion matrices that defines a generalized eigenvalue problem. The finite generalized eigenvalues of such a pair are exactly the polynomial eigenvalues of the matrix polynomialA(t)(see Demmel, 1997; Manocha and Demmel, 1995; Tisseur and Higham, 2001 and, e.g., Matlabʼs polyeig function).IfA(t)=∑i=0mAiti,where eachAiis a numerical square matrix of size n, then we construct (with I and 0 denoting the identity and the zero matrices of size n, respectively)C0=(00…0−A0I0…0−A10I…0−A2⋮⋮⋮⋮00…0−Am−200…I−Am−1),C1=(I0…000I…00⋮⋮⋮⋮⋮⋮⋮⋮00…I000…0Am).It can be verified thatdet(tC1−C0)=det(A(t)). The pair of matrices(C0,C1)is called a companion matrix pencil ofA(t), andt∈Csuch thatdet(tC1−C0)=0is called a generalized eigenvalue. Similar to an ordinary eigenvalue problem, for a given generalized eigenvalue, we have left and right eigenvectors. The matrix pencil is called regular ifdet(tC1−C0)is not identically zero.Usually the degree ofdet(tC1−C0)is smaller than nm: in that case we say that ∞ is a generalized eigenvalue for the matrix pencil(C0,C1)with multiplicitynm−deg(det(tC1−C0)). The next proposition gives a more concrete description of the multiplicity of ∞ as a generalized eigenvalue for(C0,C1)(see Amiraslani et al., 2009).Proposition 3The multiplicity of ∞ as a generalized eigenvalue for the matrix pencil(C0,C1)is at leastn−rank(Am), and it is equal to the multiplicity of 0 as a generalized eigenvalue of the matrix pencil(C1,C0).There are several applications of Bézout matrices for bivariate polynomials given by samples in each variable. The natural basis is the tensor product of the Lagrange basis in each variable. Before discussing such applications we review some theories and facts about the Lagrange interpolation problem (for the proofs and a more detailed discussion see Shakoori, 2007; Corless, 2004). We consider the so-called barycentric representation of the Lagrange basis which is known to have numerical advantages over the familiar standard definition (see Berrut and Trefethen, 2004; Schneider and Werner, 1984 and Section 8 below).Definition 4Letτ=(τ1,…,τd+1)∈Cd+1be a vector whose numerical entries are all distinct. We define(8)ℓ(t;τ)=∏j=1d+1(t−τj)∈Pd,ωi(τ)=[∏j=1j≠id+1(τi−τj)](−1),whereωi(τ)are the barycentric weights. The associated barycentric Lagrange polynomials are given by(9)Li(t;τ)=ωi(τ)ℓ(t;τ)t−τi(1⩽i⩽d+1).Ifp(t)∈Pdandpi=p(τi),i=1,…,d+1, then(10)p(t)=ℓ(t;τ)∑i=1d+1ωi(τ)pit−τi.Moreover, we call(11)L(t;τ)=[L1(t;τ),…,Ld+1(t;τ)]T∈[Pd]d+1,the Lagrange interpolation basis.Dealing with some geometric problems involving plane curves (such as those considered in this paper) requires the computation of the Bézout matrix that is in fact a matrix polynomial which in turn gives rise to a polynomial eigenvalue problem described in Section 2.Proposition 4Letp(t),q(t)∈Pdwithd=max(deg(p(t)),deg(q(t))). Supposeτ=(τ1,…,τd+1)∈Cd+1consists of distinct numerical values. Letp=(p1,…,pd+1)andq=(q1,…,qd+1)be numerical data such thatp(τi)=piandq(τi)=qi(1≤i≤d+1).Letτ˜=(τ1,…,τd)∈Cdconsist of all the nodes in τ exceptτd+1. Letpi′=p′(τi)andqi′=q′(τi)denote the values of the derivatives ofp(t)andq(t)(1≤i≤d). Then, the Bézout matrix in the Lagrange basisL(t;τ˜)∈[Pd−1]dis the matrixBez(p,q)=[bi,j]with entries given by(12)bi,j=piqj−pjqiτi−τj,i≠j(13)bi,i=pi′qi−piqi′,i=j.In order to avoid a cumbersome notation, we use the same notationBez(p,q)as in the monomial basis. In the cases where there might be some doubt, the used basis will be mentioned.Lemma 1Matrix congruence propertyLet τ,p(t),q(t)∈Pd, andτ˜be defined as inProposition 4. Moreover, letV∈Cd×dbe the Vandermonde matrix associated withτ˜.(14)V=(1τ1…τ1d−11τ2…τ2d−1⋮⋮⋮⋮1τd…τdd−1).Let alsoBdenote the Bezoutian associated withτ˜, in the Lagrange basis,L(t;τ˜), andBMthe corresponding Bezoutian in the monomial basis. Then,(15)B=VBMVT.As we showed in Proposition 4, to compute the diagonal entries of the Bézout matrix in the Lagrange basis, we need to calculatepi′andqi′(1≤i≤d). In fact, we need to have a systematic way of computing all the derivatives of the polynomial interpolant on the given sample points. Next we introduce a formula which is the main tool in computing the diagonal entries of the Bézout matrix in the Lagrange basis.Lemma 2Letτ=(τ1,τ2,…,τd+1)∈Cd+1consist of distinct sample points, andp=(p1,p2,…,pd+1)be the numerical values of the polynomialp(t)∈Pdat τ. Moreover, letωi(τ), andωj(τ)be the barycentric weights constructed by using Eq.(8). The valuespi′=p′(τi)of the derivative of the interpolantp′(t)∈Pd−1at the nodes in τ are(16)pi′=1ωi(τ)∑j=1j≠id+1ωj(τ)(pj−pi)τi−τj(1⩽i⩽d+1).See Amiraslani (2006), Trefethen (2000).  □Observe that in this case, ift⁎∈Cis a common zero ofp(t)andq(t), thenL(t⁎;τ˜)is a null vector of the Bézout matrix with respect to the Lagrange basis.Theorem 1Letp(t),q(t)∈Pdwithd=max(deg(p(t)),deg(q(t))). We assume thatp(t)andq(t)are specified in the Lagrange basis, by data τ,p, andqas inProposition 4. Ifp(t),q(t)has only one common root,t⁎, which is simple, then we may use any vectorU=[u1,u2,…,ud]Tin the nullspace of the corresponding Bézout matrix in the Lagrange basis to computet⁎. This is done by means of a procedure that is referred to as “taking moments”. That is,(17)t⁎=∑i=1dτiui∑i=1dui.By hypothesis, for1≤i≤d, we haveui=αLi(t⁎;τ˜)for some α. Then(18)∑i=1dui=α∑i=1dLi(t⁎;τ˜)=α.This is because the sum interpolates 1 onτ˜. Likewise,(19)∑i=1dτiui=α∑i=1dτiLi(t⁎;τ˜)=t⁎αbecause the sum interpolates t. By replacing the right hand sides of Eqs. (18) and (19) in Eq. (17), the proof is complete.  □On the other hand, similar to the monomial basis case described in Section 2, for a matrix polynomialA(t)written in the Lagrange basisL(t;τ), we construct a block matrix pencil(C0,C1)whose finite generalized eigenvalues include the roots ofdet(A(t)).Definition 5We consider the matrix polynomial(20)A(t)=A1L1(t;τ)+A2L2(t;τ)+⋯+Ad+1Ld+1(t;τ),where, for1≤i≤d+1,Aiarer×rmatrices such thatA(τi)=Ai. The corresponding companion matrix pencil for the matrix polynomialA(t)is(21)C0,C1=(τ1IA1τ2IA2⋱⋮τd+1IAd+1−ω1I−ω2I⋯−ωd+1I0),(II⋱I0),where I and 0 are the identity matrix and the zero matrix, respectively, conformal with ther×rmatricesAi, for1≤i≤d+1. MatricesC0andC1are of dimensionr(d+2)×r(d+2)and we have thatdetA(t)=det(tC1−C0).Although the purpose of the present paper is not to discuss methods for solving generalized eigenvalue problems, we will make some brief considerations in Section 8.The goal of this section is to recall the main ideas of the usual method for computing the topology of algebraic curves, from which our method has, in some sense, evolved. This will make the exposition clearer, and the paper self-contained. The characterization of the topology of a curveCfpresented by the equationf(x,y)=0is usually based on the location of the critical points of f with respect to y (i.e., singular points or points with a vertical tangent) and on the study of the halfbranches (i.e., simple arcs of curve starting from a point) ofCfaround those points (see for example Hong, 1996; Gonzalez-Vega and El Kahoui, 1996; Gonzalez-Vega and Necula, 2002; Seidel and Wolpert, 2005; Cheng et al., 2010). This is due to the fact that for any other point ofCfthere will be only one halfbranch to the left and one halfbranch to the right.Definition 6Letf(x,y)∈R[x,y]andCbe the real algebraic plane curve defined by f:Cf={(α,β)∈R2:f(α,β)=0}.A point(α,β)∈C2is called a critical point ofCfiff(α,β)=0,∂f∂y(α,β)=0.A critical point is said to be singular if∂f∂x(α,β)=0; nonsingular critical points are called ramification points. A point(α,β)∈C2is a regular point ofCfiff(α,β)=0and it is not critical.The usual strategy to compute the topological graph of a real algebraic plane curveCdefined implicitly by a polynomialf(x,y)∈R[x,y]proceeds in the following way:1.Compute the squarefree part of the discriminant of f with respect to y,D(x), and determine its real roots,α1<α2<⋯<αrwhich are the x-coordinates of the critical points ofCf.For everyαi, compute the real roots off(αi,y),βi,1<⋯<βi,si, determining which(αi,βi,j)is regular and which(αi,βi,j)is critical.For every(αi,βi,j), compute the number of halfbranches to the right and to the left of the point(αi,βi,j).Steps 1 and 2 provide the vertices of a graph representing the topology ofCfsuch as the one in Fig. 3. For the purpose of tracing the curve numerically, this graph is of much importance because it helps us understand how to proceed when we approach a complicated point on the curve.In this section we summarize two usual different approaches for solving steps 1 and 2. The main difference between the two approaches is that in the method we choose in order to determine the x-coordinates of the critical points: we can either choose to explicitly compute the discriminant off(x,y)with respect to y, or we can avoid such computation. Although these two methods use the monomial expression off(x,y), their presentation here is necessary to understand the rationale behind the method presented in Section 5 in which we do not have the monomial expression off(x,y).We begin with the computation of the discriminantR(x)of f with respect to y by any available method (a determinant computation, subresultant algorithm, etc.) and of its squarefree part:D(x)=R(x)gcd(R(x),R′(x)).This step ends with the computation of the real roots ofD(x).When solving the equationsf(αi,y)=0, to avoid the numerical problems arising from the computation of the multiple roots of everyf(αi,y), a linear change of coordinates might be necessary. Such change of coordinates puts the curve in a desirable position which is known as “generic position” (see Gonzalez-Vega and Necula, 2002).Definition 7Letf∈R[x,y]be a squarefree polynomial. The real algebraic plane curve defined by f,Cf, is in generic position if the following two conditions are satisfied:1.The leading coefficient of f with respect to y (which is a polynomial inR[x]) has no real roots.For everyα∈Rthe number of distinct complex roots off(α,y)=0,∂f∂y(α,y)=0is 0 or 1.One of the advantages of having the curve in generic position is presented in the next proposition (for a more detailed discussion see Necula, 2005; Gonzalez-Vega and Necula, 2002).Proposition 5Letf∈R[x,y]be a squarefree polynomial such thatCfis in generic position. If(α,β)is a critical point ofCfandα∈Rthenβ∈Rtoo.In general, if(α,β)is a critical point onCfand α is a real number, this does not imply that β is a real number as well (see Example 1).IfCfis in generic position then for every real root α ofD(x)there is only one critical point of the curve in the vertical linex=αwhose y-coordinate can be rationally described in terms of α; if the equationf(x,y)is available as a polynomial in y whose coefficients are polynomials in x then, by using subresultants and for each critical point(α,β), a rational functionrα(x)∈R(x)is explicitly determined such thatβ=rα(α).To check ifCfis in generic position the following condition is used (see Theorem 3.7 in Gonzalez-Vega and Necula, 2002):Cfis in generic position if and only if for each α,Sreski(f(α,y),fy(α,y))is proportional to(y−β)k, where k depends on α and on a suitable factorization ofD(x), andSresjdenotes the subresultant of order j (with respect to y).This allows to symbolically construct a squarefree polynomialgi(αi,y), from everyf(αi,y), i.e., by symbolically dividingf(αi,y)by a convenient power of(y−rαi(αi)), whose real roots need to be computed in the second step.If the curve is not in generic position then we apply the linear change of coordinates(22)x=x−y,y=y,and restart the process with the new polynomial. Alternatively, one may apply a rotation with a randomly chosen angle between 0 and π. After a finite number of such transformations the curve will be in generic position. Notice that these changes of coordinates do not modify the topology of the curve, and the transformation can be reversed at the end.Example 1For the bivariate polynomialf(x,y)=−3+12x2−18x4+12x6−3x8+12y2−28y2x2+20y2x4−4y2x6+2y4+12y4x2+2y4x4−12y6+4y6x2+y8,the discriminant has real roots ±1, ±6.236475953965871. Forx=−1there are three critical points:(−1,−2)and(−1,2)with algebraic multiplicity 2, and(−1,0)with multiplicity 0. Similarly forx=1(see Fig. 1, left). Thus, the curve is not in generic position. On the other hand, forα=±6.236475953965871, the y-coordinate of the only double point is the complex numberβ=8.688945478749457i.If one transforms the polynomial using (22) then the leading coefficient with respect to y annihilates atx=0, and the first condition in the generic position definition is not satisfied (see Fig. 1, center). By applying the transformation (22) once more, we obtain the curve in generic position (see Fig. 1, right).The third step is accomplished by computing the number of real roots of the squarefree polynomialsf(γi,y)(i∈{1,2,…,r+1}) withγ1=−∞,γr+1=∞, and for2⩽i⩽r,γibeing any real number in the open interval(αi−1,αi). As a consequence of the generic position condition, the edges of the topological graph can be obtained by using a straightforward combinatorial reasoning (see Gonzalez-Vega and Necula, 2002).Letf(x,y)be a squarefree polynomial inR[x,y]andCfthe curve defined by the equationf(x,y)=0. Moreover, letB(x)=Bez(f(x,y),fy(x,y)), the Bézout matrix off(x,y)andfy(x,y)with respect to y. Note that the roots of the discriminant are the roots ofdet(B(x)). LetC0andC1be the companion matrix pencil forB(x). Sincef(x,y)is squarefree,det(B(x))=det(xC1−C0)is not identically zero.Ifn=degy(f)andm=degx(B(x))thenC0andC1are square matrices of size nm. According to Section 2 the number of finite eigenvalues (counted with multiplicity) for the pencil(C0,C1)is equal todeg(det(B(x)))while the number of infinite eigenvalues agrees withnm−deg(det(B(x))).Assuming, as before, thatCfis in generic position, for every real eigenvalue α of the pencil(C0,C1), in the second step of the procedure for determining the topological graph ofCf, we need to compute the unique (real) multiple root off(α,y)together with its multiplicity.Ifdim(nullspace(B(α)))=1then the normalization (with respect to the first coordinate) of any nonzero vector v innullspace(B(α))provides β as the second coordinate of the normalization of v. In this case the multiplicity of β as a real root off(α,y)is 2 (see Corollary 1 in Section 1).Ifdim(nullspace(B(α)))=k>1then, using the particular structure of the nullspace of the Bézout matrix described in (5), β can be recovered from any basis A of thenullspace(B(α)), as shown by the following proposition (see Necula, 2005 for a proof).Proposition 6IfAi,jis the i-th element of the j-th column-vector of the nullspace basis ofB(α),Yi={0if1⩽i⩽k−1(k−1)!ifi=kand X is the solution ofAX=Ythenk!⋅β=∑j=1kAk+1,jXj.In this case the multiplicity of β as a real root off(α,y)isk+1. In order to compute the simple roots of everyf(α,y)and for the final determination of the topology ofCfwe proceed in the same manner as described in Section 4.1.Letf(x,y)be a polynomial inR[x,y]whose monomial description is not available or it is costly to be either computed or used. We assume that it is possible to evaluatef(x,y), and that it is known that the degrees off(x,y)with respect to x and y are bounded by m and n, respectively. The curvef(x,y)=0is assumed to be in generic position (see Section 4.1); later in Section 5.5 we present a method for checking whether or not a given curve is in generic position, in this context. As usual, we will also demonstrate that by making a simple linear change of coordinates we put the curve in generic position, if not already in such a position.We recall that the Bézout matrix of a pair of bivariate polynomials is a matrix polynomial. Therefore, each entry of such Bézout matrix is a univariate polynomial. The following proposition presents a degree bound for the polynomial entries of the Bézout matrix off(x,y)andfy(x,y)(with respect to y).Proposition 7Letσ=(σ1<σ2<⋯<σn+1)ben+1real numbers, and letL(y;σ)=[Li(y;σ):1⩽i⩽n+1]be the Lagrange basis of[Pn]n+1[y]w.r.t. to the interpolation nodes σ. LetB(x)∈Mn(R)be the Bézout matrix off(x,y)andfy(x,y)(with respect to y) in the Lagrange basisL(y;σ˜)B(x)=Bdxd+⋯+B0,whereBi∈Mn(R). The degree d ofB(x)is upper bounded by 2m.Notice that bothf(x,y)andfy(x,y)have degree at most m w.r.t. x. From Lemma 1, we have thatB(x)=VBM(x)Vt(whereBM(x)is the Bézout matrix off(x,y)andfy(x,y)w.r.t. the monomial basis, and V is a constant Vandermonde matrix depending onσ). The coefficients ofBM(x)areBijM=∑k=1min{i,n+1−j}f(x,y)j+k+1fy(x,y)i−k−f(x,y)i−kfy(x,y)j+k+1,then it is straightforward to conclude that the degree ofB(x)w.r.t. x is bounded by 2m.  □Let σ andL(y;σ)be as described inProposition 7. Moreover, letτ=(τ1<τ2<⋯<τ2m+1)be another collection of real numbers, andL(x;τ)=[Li(x;τ):1⩽i⩽2m+1]be the Lagrange basis ofR2m[x]w.r.t. the interpolation nodes τ(the two collections of real numbers τ and σ might share common nodes). Then, we have(23)B(x)=B(τ2m+1)L2m+1(x;τ)+⋯+B(τ1)L1(x;τ),whereB(τk)=Bez(f(τk,y),fy(τk,y))=(b1,1k…b1,nk⋮⋮bn,1k…bn,nk)is then×nBézout matrix in the Lagrange basisL(y;σ˜)and(24)bi,jk=f(τk,σi)fy(τk,σj)−f(τk,σj)fy(τk,σi)σi−σj,ifi≠j,bi,ik=fy(τk,σi)2−f(τk,σi)fyy(τk,σi),otherwise.ProofIt follows directly from Proposition 4.  □To compute the values of the second derivativesfyy(τk,σi)we use the derivative formula in Eq. (16) twice by replacing the required data which are either given or have been already evaluated. Once we know the evaluations of the Bézout matrix off(x,y)andfy(x,y)(in the Lagrange basisL(y;σ˜)) at the nodesτ, the x-coordinates of the critical points{α1,…,αr}of the curvef(x,y)=0are determined by computing the real generalized eigenvalues of the matrix pencil provided byB(x)as presented in Eq. (23). This requires the construction of the two square matricesC0,C1∈Mn(2m+2)(R). For each critical point, we shall call the vertical line{x=α}passing through it, a critical line.We assume that α is a real generalized eigenvalue of the pencil of companion matricesC0,C1, such thatB(α), the corresponding Bézout matrix in the Lagrange basis is a singular matrix. Ifβαis the unique multiple root off(α,y)anddim(nullspace(B(α)))=1, then the nonzero column-vector[L1(βα;σ˜),…,Ln(βα;σ˜)]Tgenerates the subspacenullspace(B(α)). Thus, if[a1,…,an]is a basis ofnullspace(B(α)), then from Theorem 1 we have that[L1(βα;σ˜),…,Ln(βα;σ˜)]=[a1,…,an]a1+⋯+anandβα=σ1L1(βα;σ˜)+⋯+σnLn(βα;σ˜).In this case the multiplicity ofβαas a real root off(α,y)is 2.Ifdim(nullspace(B(α)))=k>1, let(25)N⁎=(L1(βα;σ˜)L1(1)(βα;σ˜)…L1(k−1)(βα;σ˜)L2(βα;σ˜)L2(1)(βα;σ˜)…L2(k−1)(βα;σ˜)⋮⋮⋮Ln(βα;σ˜)Ln(1)(βα;σ˜)…Ln(k−1)(βα;σ˜)).Then on the one hand, ifN∈Mn×k(R)is a matrix whose columns are a basis of thenullspace(B(α)), then there exists a nonsingular matrixA∈Mk×k(R)such that(26)N=N⁎A.On the other hand, letM=(10…0βα1…0βα22βα…0⋮⋮⋮βαkkβαk−1…k!βα)having the same structure as in (5). We can take moments by multiplying by a truncated transpose of the Vandermonde matrix(27)Vk+1,nT=(11…1σ1σ2…σnσ12σ22…σn2⋮⋮⋮σ1kσ2k…σnk)∈M(k+1)×n(R)by considering thatVk+1,nTN⁎=M. Thus Eq. (26) can be rewritten as(28)Vk+1,nN=Vk+1,nN⁎A=MA.If we define Z asZ=Vk+1,nTN,we have(29)Z=MA,and we obtain the following result.Proposition 9Following the above notation,(30)(βαk−(k1)βαk−1(k2)βαk−2…(−1)k−1kβα(−1)k)Z=0,where(kj)denotes the binomial coefficient.A left-inverse matrix of M is given byP=(100…00−βα10…00βα22−βα12…00⋮⋮⋮⋮⋮(−βα)k−1(k−1)!(−βα)k−2(k−2)!(−βα)k−3(k−3)!2!…1(k−1)!0),and multiplying by P on the left of both sides of Eq. (29) one gets the following expression for the entries of A:(31)Aji=∑s=1j(−βα)j−s(j−s)!(s−1)!Zsi.The equations inMA=Zcorresponding to the last row of Z have the formZ(k+1)i=βαkA1i+kβαk−1A2i+k(k−1)βαk−2A3i+⋯+k!βαAki.Then, by using (31), one obtains the system (30).  □The system (30) is composed by k equations of degree k inβα. By applying the Gauss method, we compute the lower triangulationZˆof Z, whence[βαk−(k1)βαk−1(k2)βαk−2…(−1)k−1kβα(−1)k](Zˆ110…0Zˆ21Zˆ22…0⋮⋮⋮Zˆk1Zˆk2…ZˆkkZˆ(k+1)1Zˆ(k+1)2…Zˆ(k+1)k)=0.Thus, sinceZˆhas rank k, andZˆkk≠0,βα=Zˆ(k+1)kkZˆkk.In this case the multiplicity ofβαas a real root off(α,y)isk+1.For each eigenvalue α we verify if|f(α,βα)|<ε, where ε is a small tolerance value which we have chosen at the beginning; typically ε is between10−8and10−6. The failure of this condition may be due to two reasons: numerical error, or a complex, and non-real root of the discriminant. The first problem is solved by increasing the number of precision digits, and repeating the computation of the generalized eigenvalues. To analyze the second case, when the discriminant has complex and non-real roots, we consider the following example; forf(x,y)=(3x2+4y+4y2)(x2−2y+y2)(x2+2x+2y2)(x2−2x+y2),f(6,y)andfy(6,y)have two common complex roots which are conjugate. Hencex=6is one of the computed eigenvalues, but the curve does not satisfy the second condition in Definition 7 of generic position. Thus, similarly to Section 4.1, we make a linear change of coordinates (a rotation or the transformation (22)) and restart the algorithm with the new polynomial. If we use the transformation (22) to obtain the values of the new polynomialfˆ(x,y)=f(x−y,y)at the nodesτ,σwe need to apply the following proposition.Proposition 10Letp(x)=∑i=1d+1p(τi)Li(x;τ)be a polynomial expressed in the Lagrange basis. Ifpˆ(x)=p(x−a), thenpˆ(τi)=∑j=1d+1p(τj)Lj(τi−a;τ).The expression ofpˆin the Lagrange basisL(x;τ)ispˆ(x)=∑i=1d+1pˆ(τi)Li(x;τ).On the other hand,p(x−a)=∑j=1d+1p(τj)Lj(x−a;τ)=∑j=1d+1p(τj)∑i=1d+1Lj(τi−a;τ)Li(x;τ)=∑i=1d+1[∑j=1d+1p(τj)Lj(τi−a;τ)]Li(x;τ),and the proposition follows.  □As a consequence(32)fˆ(τk,σj)=∑i=12m+1f(τi,σj)Li(τk−σj;τ),andfˆ(x,σj)=∑k=12m+1[∑i=12m+1f(τi,σj)Li(τk−σj;τ)]Lk(x;τ).We assume that, for fixed α, we know the value ofβαsuch that(α,βα)is a critical point off(x,y), and also the multiplicityk+1ofβαas a root off(α,y). We can proceed to get the rest of the roots of the polynomialf(α,y). Remember that these roots are simple becausef(x,y)is in generic position.Notice that we can easily obtain the Lagrange presentation of the polynomial(33)Fα(y)=f(α,y)(y−βα)k+1w.r.t. the Lagrange basisL(y;σ˜)whereσ˜is a subset ofn−kelements ofσ, avoiding to choose anyσithat is equal or too close toβα. The coefficients of the polynomial in the Lagrange basis are{f(α,σi)(σi−βα)k+1:σi∈σ˜}.With these coefficients we construct the corresponding pencil of companion matrices, which in this case are constant matrices of sizen−k+2, and find the generalized eigenvalues. Then we eliminate non-real complex and infinite eigenvalues. The remaining eigenvalues are the real simple solutions off(α,y)=0.The points on all the critical lines obtained by using the method described in the previous sections will be the vertices of the topological graph. To determine which pairs of vertices in two consecutive critical lines must be joined by edges, we first choose a sequenceγ1,…,γr+1of values of x such thatγ1<α1,αi−1<γi<αi,i=2,…,r,αr<γr+1.Then, we compute the solutions off(γi,y)=0for each i. Letbidenote the number of such solutions andνibe the number of simple points in the critical line{x=αi}. Then, the number of edges going from the critical point(αi,βαi)to the left is equal tobi−νi, and the number of edges to the right isbi+1−νi. From each of the other points in the critical line there is only one edge to the left and only one to the right because they are simple points. Fig. 2shows an example withbi=7,νi=3,bi+1=5.The choice of the intermediate valuesγi,i=2,…,r, is made based on the following criterium: if there is a nodeτjin the interval(αi−1,αi), we choose it, otherwise, we choose the midpoint of the interval. Similarly,γ1is either a node or equal toα1−1, and alsoγr+1is either a node or equal toαr+1.To compute the real roots off(γi,y)we proceed analogously to Section 5.3; evaluatef(γi,σj),j=1,…,n+1, build the companion matrix pencil, and solve for the generalized eigenvalues.In some cases, the nongeneric position of the curve is detected when certifying the critical points (see 5.2.1). In other cases, one has to check conditions 1 and 2 in Definition 7. To check the first condition, for each generalized eigenvalue α we must determine that the leading coefficient off(x,y)with respect to y does not vanish whenx=α. To obtain the leading coefficient we use the following proposition whose proof follows directly from Definition 4.Proposition 11Letp(y)be a polynomial of degree d andσ=(σ1,…,σd+1)be a collection of real numbers. The leading coefficient ofp(y)isad=∑i=1d+1ωi(σ)pi,whereωi(σ)is given by formula(8), andpi=p(σi).Therefore, in our case, for each generalized eigenvalue α we compute(34)LCα=∑i=1n+1ωi(σ)∑j=12m+1f(τj,σi)Lj(α,τ).If for some α we have that|LCα|<εthen the curve is not in generic position (it has a vertical asymptote atx=α).The method to verify the second condition in the generic position definition is based on Proposition 2 and Corollary 1. First, it is necessary to find the x-coordinates of the critical points{α1,…,αr}as in Section 5.1. For eachαjwe compute the nested finite sequence of linear spaces(35)Nk=⋂s=1knullspace(Bezy(f(αj,y),∂sf∂ys(αj,y)))ending whendim(Ni)⩽1.Notice that∂if∂yi(αj,y)can be computed using the nodesσand applying the formula (16)i times. The corresponding Bézout matrix is given by Proposition 4.As soon asdim(Ns+1)−dim(Ns)>1for oneαj, the computation is stopped and we conclude that the curve is not in generic position. In this case, we perform a linear transformation onf(x,y)as explained in 4.1 and 5.2.1, and restart the algorithm by using the values of the transformed polynomial.Input:•The degree bounds m and n forf(x,y)with respect to x and y, respectively.The nodes for x,τ=(τ1<⋯<τ2m+1), for y,σ=(σ1<⋯<σn+1), and the corresponding values(f(τi,σj):1⩽i⩽2m+1,1⩽j⩽n+1).The tolerance ε.Output: The graph representing the topology off(x,y)=0.1.Critical points(a)Fork=1,…,2m+1compute the matricesBkby using formula (24).Construct the companion matrix pencil(C0,C1)and compute its generalized eigenvalues. Discard all complex non-real and infinite eigenvalues. The remaining eigenvalues are{α1<⋯<αr}.Detection of vertical asymptotes: For each eigenvalueαi, computeLCαias in Eq. (34). If for anyαi,|LCαi|<ε, then a linear transformation must be applied to the curve (see Section 5.5), and the algorithm must be restarted with the transformed curve.For each eigenvalueαi, compute the corresponding y-coordinateβias in Section 5.2. Check if|f(αi,βi)|<ε; if this condition is not satisfied for oneαithen•Increase the computing precision by 10 digits and repeat the computation of the critical points.If the precision has been increased sufficiently (up to 200 digits) but the desired condition is not yet satisfied conclude that the curve is not in generic position. In this case, apply a linear transformation as explained in Section 5.5 and restart the algorithm with the transformed polynomial.Checking generic positionThe condition 1 of Definition 7, has been checked in the step 1(b) above. To check condition 2, for each eigenvalueαifind a basis of each subspaceNkas defined in (35) by using the Singular Value Decomposition on the matrix in Eq. (6). If for some s,dim(Ns)−dim(Ns−1)>1, then the curve is not in generic position, a linear transformation must be applied to the curve (see Section 5.5), and the algorithm must be restarted with the transformed curve.Other points on a critical lineFor each eigenvalueαi, letki+1be the multiplicity ofβias a root off(αi,y). Then(a)Construct the matrix pencil associated with the nodes(σj:1⩽j⩽n−ki)and the values(f(αi,σj)(σj−βi)ki+1:1⩽j⩽n−ki).Compute the generalized eigenvalues and discard those complex non-real and infinite.For each eigenvaluey⁎, the point(αi,y⁎)is one of the regular points of the curve on the considered critical line.Letνibe the number of simple points on each critical line.Points on the noncritical lines(a)Choose intermediate x-coordinatesγ1<α1,αi−1<γi<αi,i=2,…,r,αr<γr+1, in the following way:i.If there is a nodeτj<α1−0.3letγ1be the biggest of such nodes; otherwise, letγ1=α1−1.Fori=2,…,r, if there is a nodeτj∈(αi−1+(αi−αi−1)/4,αi−1+3(αi−αi−1)/4)letγibe any such node; otherwise letγi=(αi−1+αi)/2.If there is a nodeτj>αr+0.3letγ1be the smallest of such nodes; otherwise, letγr=αr+1.For eachγi, construct the companion matrix pencil associated with the nodes(σj:1⩽j⩽n+1)and the values(f(γi,σj):1⩽j⩽n+1). Compute the generalized eigenvalues and discard those complex non-real and infinite.Letbibe the number of these simple points with x-coordinate equal toγi.Edges of the graphStarting from the lowest point, connect each simple point to the next available point on the linex=γiand to the next available point on the linex=γi+1until the critical point is reached (see Fig. 2). Connect the critical point tobi−νipoints on the linex=γiand tobi+1−νipoints on the linex=γi+1. Then, continue connecting the remaining simple points to one point on the left and one point on the right.Example 2To illustrate the main steps of the algorithm we use the algebraic curve obtained by applying the transformation in Eq. (22) to the curve in Example 1 (plotted in Fig. 1, right).Input:m=8,n=8,τ=(−8,−7,−6,−5,−4,−3,−2,−1,0,1,2,3,4,5,6,7,8),σ=(−4,−3,−2,−1,0,1,2,3,4).The corresponding values are in the following matrix, where the ij-element isf(τi,σj):(1708515552−183795−4660416−47258883−291960000−1299890163−4594916160−13699084611368642025−12288−1044375−15925248−124862391−648744960−2553167223−8235479040102093−19201437−162816−4501875−48218112−303025635−1354366848−478388741119660820250−13527−995328−16343607−130621440−680410935−267170611212018915552−435−192−151875−4660416−50973363−320397120−1425581187−9830401997709−12288−1044375−17522688−139475415−720961536−5708211−15552014370−243−162816−5091555−55064448−341940915−20508672−1255095−1228890−13527−1167360−19163223−149876736−59394627−5609280−183795−192−3−192−183795−5609280−59394627−149876736−19163223−1167360−1352709−12288−1255095−20508672−341940915−55064448−5091555−162816−24301437−155520−5708211−720961536−139475415−17522688−1044375−122889019977−983040−1425581187−320397120−50973363−4660416−151875−192−43515552120189−2671706112−680410935−130621440−16343607−995328−1352702025196608−4783887411−1354366848−303025635−48218112−4501875−1628161437−1920102093−8235479040−2553167223−648744960−124862391−15925248−1044375−12288202536864−13699084611−4594916160−1299890163−291960000−47258883−4660416−1837951555217085)Critical points. The companion matrix pencil matrices are of size144×144, and the real and finite generalized eigenvalues (without counting multiplicities) are{±7.0217988481097227684,±1.4608761201425284718,±1.2531054640051353026,±1}.The corresponding critical points are(±7.0217988481097227684,±3.3476041758252916187),(±1.4608761201425284718,±1.0577307224691838865),(±1.2531054640051353026,±0.38099545231238395034),with multiplicity 2 and(±1,0)with multiplicity 4.Other points on critical lines. For each of the eight critical points, we construct the corresponding companion matrix pencil and compute the generalized eigenvalues. They give the following points:On the linesx=±7.0217988481097227684:(±7.0217988481097227684,±7.1617016141985190797);(±7.0217988481097227684,±2.1915651133634752340).On the linesx=±1.4608761201425284718:(±1.4608761201425284718,±1.9547205884882777201);(±1.4608761201425284718,±0.15719056570656257280).On the linesx=±1.2531054640051353026:(±1.2531054640051353026,±1.7851493909851024819);(±1.2531054640051353026,±0.085491388179816599602).On the linesx=±1:(±1,±1.5830673160968719153);(±1,±0.50534806187044243447).Thusνi=2, fori=1,…,8.Noncritical lines and edges. The nine intermediate noncritical lines used to compute the edges of the graph are the following:x=−8,x=−5,x=−1.3569907920738318872,x=−1.1265527320025676513,x=0,x=1.1265527320025676513,x=1.3569907920738318872,x=3,x=8. The numbers of points on each noncritical line arebi={2,4,2,4,4,4,2,4,2}.This example requires a precision of 20 digits because there are pairs of eigenvalues which are rather close. The graph is represented in Fig. 3.Example 3An interesting application of our method is computing the topology of the offset curve at distance δ from a parametric plane curve given by values. Suppose(x(t),y(t))is the parametrization of the initial curve, and letd=max(deg(x(t)),deg(y(t))). For this application, as we shall see shortly, the values of(x(t),y(t))at4d−1nodes(λ1,…,λ4d−1)are required.A point(x,y)on the δ-offset obeys Eqs. (1). The δ-offset is not rational, in general, but it is an algebraic curve of degree4d−2(see Farouki and Neff, 1990). The implicit equation of the δ-offset could be obtained by taking the resultant ofF(x,y;t)andG(x,y;t), with respect to t. However, since(x(t),y(t))is given by values, and to avoid the computation of a determinant (because it is costly and it may be unstable), we will apply the following formula introduced in Apéry and Jouanolou (2006): given two polynomialsa(t)andb(t)withdeg(a)=manddeg(b)=n, we have(36)resultant(a,b)=∑I=U∐V,|U|=n,|V|=m∏u∈Ua(u)∏v∈Vb(v)∏u∈U,v∈V(u−v)where I is a set of distinctn+mnodes.Letf(x,y)=0be the implicit equation of the δ-offset, and choose nodesτ=(τ1,…,τ8d−3)for x, andσ=(σ1,…,σ4d−1)for y (see Section 5.6). The coefficients off(x,y)in the Lagrange basis arefij=f(τi,σj), i.e.,(37)f(x,y)=∑i=18d−3∑j=14d−1fijLi(x;τ)Lj(y;σ),withfij=resultantt(F(τi,σj;t),G(τi,σj;t)).Then, using formula (36) withI=(1,…,4d−1),a(u)=F(τi,σj;λu), andb(v)=G(τi,σj;λv), we have(38)fij=∑I=U∐V,|U|=2d−1,|V|=2d∏u∈UF(τi,σj;λu)∏v∈VG(τi,σj;λv)∏u∈U,v∈V(λu−λv).To show a concrete example, consider a cubic curve, i.e.d=3, given by the following values(39){(28,−31),(18,−594),(10,−5),(4,−1/4),(0,1),(−2,1/4),(−2,−1),(0,−5/4),(4,1),(10,294),(18,19)}.For this initial curve, the offset has genus different from 0, whence it does not admit a rational parametrization. We will find the topology of the offset at distanceδ=1. In this case, the offset curve has degree 10. From the nodes (39) on the initial curve, we compute the valuesfijusing Eq. (38), corresponding to a suitable choice ofτandσ. Then, we apply our algorithm taking as inputfij, withi=1,…,21, andj=1,…,11. The output is presented in Fig. 4.The computation of the coefficientsfijtook 4 seconds, and the application of the topology algorithm took 161 seconds. We processed the same example with other method, the Top algorithm presented in Gonzalez-Vega and Necula (2002), that takes as input the implicit equation of the offset. In this case, we previously needed to recover the parametric equations(x(t),y(t))of the initial curve from the nodes (39), by interpolation, and then computef(x,y)=resultantt(F(x,y;t),G(x,y;t)),withF,Gas in (1). The polynomialf(x,y)has 53 terms and degree 10. The curve is in generic position, but the Top algorithm has trouble checking the generic position. Note, that there are two consecutive critical points whose x-coordinates are rather close, as it can be seen in the right hand side image of Fig. 4. In addition, depending on the precision, the topology obtained with the Top algorithm may be wrong.

@&#CONCLUSIONS@&#
We have presented several approaches for computing the topology of a given real algebraic plane curve described by its values in the Lagrange polynomial basis. The first algorithm is designed for problems in which the given data corresponds to an implicitly defined algebraic curve. The second algorithm however, is designed to be used for parametric curves. In both cases, the defining polynomial equations are specified only by their values at some sample points. Moreover, the degrees are known, can be deduced or are upper bounded. The key idea is to find the roots of the determinant of a particular Bézout matrix without computing the determinant. This is achieved by computing the generalized eigenvalues of a companion matrix pencil associated with the Bézout matrix. If the precision and other numerical parameters are adjusted appropriately, the algorithms presented here are very accurate. They are also efficient, always in the parametric case, and for moderate degrees in the implicit case. The size of the companion matrix pencil could be quite big in the implicit case, producing an increase in the computational cost.One of our next goals is to reduce the computational time by using better methods for computing the generalized eigenvalues. These methods should take full advantage of the particular structure of the companion matrix pencil. Using such a particular structure, we also expect to find a practical bound which allows us to confidently discard large generalized eigenvalues as infinite ones. The desired bound for generalized eigenvalues may follow from Hadamardʼs inequality for determinants when applied to the companion matrix pencil in the Lagrange basis (see Corless et al., 2002 for the monomial case).In addition, it would be interesting to study which properties of curves (normality, for instance) can be determined by values.