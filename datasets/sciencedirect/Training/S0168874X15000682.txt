@&#MAIN-TITLE@&#
On the force–displacement characteristics of finite elements for elasticity and related problems

@&#HIGHLIGHTS@&#
Established the result that the magnitude of forces at the nodes of a constant strain triangular element depends only upon the extensional strains along the edges of elements connected at the node.Further showed that the result is not specific to constant strain triangles, but is true of all finite element formulations of elasticity problems.A mathematical proof of the result is presented.An illustrative example involving the CST is presented.

@&#KEYPHRASES@&#
Plane elasticity,Triangular finite elements,Extensional strains along edges,Mathematical proof,

@&#ABSTRACT@&#
The displacement based finite element models for hyperelastic materials are considered, and it is shown that—based on the invariance of the discretized strain energy to translations and rigid body rotations of the elements—the magnitude of the nodal forces can be written purely in terms of the strains along the edges composing the elements, while their directions are along the unit vectors corresponding to the edges. In other words, the nodal forces are “truss like” with one major difference: the magnitude of the forces depends upon the extensional strains of neighboring edges. In order to motivate the ideas, we first explicitly demonstrate this result for triangular finite element formulation of plane elasticity problems and then show that the result is valid for any finite element formulation of hyperelasticity.

@&#INTRODUCTION@&#
The aim of this paper is to show a relatively simple result that has hitherto not been documented in the FEM literature, despite a long history of finite element analysis of structural problems (which were originally motivated by matrix structural analysis of trusses). The idea is stated simply thus: for hyperelasticity problems, the magnitude of the nodal forces can be written purely in terms of the strains along the edges composing the elements, while their directions are along the unit vectors corresponding to the edges, i.e., no matter what the element type, we can show that the problem can always be reduced to a truss-like problem (with the “links” of the truss being represented by straight lines connecting the nodes of each element), but with one difference—namely that the magnitude of each of the forces at a node (which are along each of the links connecting the node to other nodes, like in a truss) depends not only upon the strain in the link but also on the strains along the links connecting the other nodes. This provides a surprisingly simple picture of the finite element method but provides additional insight and new possibilities for generalization and solution of problems.In order to prove this result, we proceed in two steps: in the first step, we start with the traditional FEM formulation of the isotropic 2-D elasticity problem using the linear triangular element and show explicitly that the magnitude of the forces at the nodes of a constant strain triangular (CST) element depends only upon the extensional strains of the edges of the elements that share the node, and that the directions of the nodal forces are along the edges that have the node in common. In other words, the problem is like that of a generalization of a “truss”, i.e. the forces are along the truss elements but their magnitudes dependent upon the strains in neighboring truss elements.We then show that further that the result is not specific to a constant strain triangle, but is true of all finite element formulations of elasticity problems (both linear and non-linear). The result follows from the fact that the discretized strain energy of the finite element representation has to (1) depend only upon nodal positions (once the shape functions are chosen) and (2) must be invariant to translations and rigid body rotations of the elements, together with well-established representation theorems using the integrity bases for isotropic functions.The governing equations for plane elasticity (plane stress or plane strain) problems are summarized here (see Reddy [1,2]). The presentation here is limited to linearized elasticity, where no distinction is made between the Cauchy stress tensor and the second Piola–Kirchhoff stress tensor and between the current coordinates x and the reference coordinates X.The domain of the elastic solid is denoted by Ω, which is an open bounded subset ofR2. The boundary of Ω is denoted byΓ=∂Ω=Ω¯−Ω, whereΩ¯represents the closure of Ω. A typical point belonging toΩ¯is denoted as x. We employ the customary designations for the Sobolev spacesHs(Ω)andHs(Γ), wheres≥0[4,5]:(1)Hs(Ω)={u:∫Ω|Dsu|2dΩ<∞};Hs(Γ)={u:∫Γ|Dsu|2dΓ<∞}The corresponding norms are denoted as∥·∥Ω,sand∥·∥Γ,s. Likewise the inner products associated with these spaces are denoted as(·,·)Ω,sand(·,·)Γ,srespectively. The product spacesHs(Ω)=[Hs(Ω)]2are constructed in the usual way.The governing equations of a plane elastic continuum consist of equations of equilibrium, strain–displacement relations, and stress–strain relations. These equations are expressed in matrix form.Equations of equilibrium:(2)DTσ+f=0where (σxx,σyy,σxy) are the rectangular Cartesian components of the stress tensorσ, fxand fyare the components of the body force vector f (measured per unit volume) along the x- and y-directions, respectively, and(3)DT=[∂/∂x0∂/∂y0∂/∂y∂/∂x],σ={σxxσyyσxy},f={fxfy}Strain–displacement relations:(4)εxx=∂ux∂x,εyy=∂uy∂y,2εxy=∂ux∂y+∂uy∂xor(5)ε=Du,ε={εxxεyy2εxy},u={uxuy}where (εxx,εyy,εxy) are the rectangular Cartesian components of the strain tensorεand uxand uyare the rectangular Cartesian components of the displacement vector u.Stress–strain (or constitutive) relations:(6){σxxσyyσxy}=[c11c120c12c22000c33]{εxxεyy2εxy}or(7)σ=Cε,C=[c11c120c12c22000c33]where cij(cji=cij)are the elasticity (material) constants for an orthotropic medium with the material principal directions (x1,x2,x3) coinciding with the coordinate axes(x,y,z)used to describe the problem. The cijcan be expressed in terms of the engineering constants(E1,E2,ν12,G12)for an orthotropic material, say for plane stress problems, by(8)c11=E1(1−ν12ν21),c22=E2(1−ν12ν21)c12=ν12c22=ν21c11,c33=G12Eqs. (2)–(8) can be combined into a single equation in terms of the displacement vector u as(9)DTCDu+f=0Eq. (9) contains, for the two-dimensional case, two equations of equilibrium in terms of the two displacement components uxand uy.The principle of virtual displacements [3] is equivalent to the following variational problem: findu∈Vsuch that(10)B(w,u)=F(w)∀w∈WwhereB(w,u)is a bilinear form,F(w)is a linear form,(11)B(w,u)=h∫Ωe(Dw)TC(Du)dxF(w)=h∫ΩewTfdx+h∮ΓewTtdsHere h denotes the thickness of the elastic solid,(·)Tdenotes the transpose of the enclosed quantity,VandWare vector spaces (e.g., appropriate subsets of the product (Sobolev) spaceH1(Ω)=H1(Ω)×H1(Ω)). The quantityw~δurepresents the weight or test function. Unlike classical solutions that are defined unambiguously point-wise, weak solutions exist with respect to test functions and are therefore understood in the context of distributions. As a result, the weak solution (and its derivatives) is typically defined unambiguously in Ω up to a set of measure zero.The finite element model associated with Eq. (11) is obtained by restricting the solution space to a finite-dimensional subspaceVhof the infinite-dimensional function spaceV, and the weight function to a finite-dimensional sub-spaceWh⊂W. As a result, in the discrete problem we seekuh∈Vhsuch that(12)B(wh,uh)=F(wh)∀wh∈WhThe quantity h in the definition of the subspacesVhandWhrepresents the average size of all the elements in a given finite element discretization. We assume that the domainΩ¯⊂R2is discretized into a set of NE non-overlapping sub-domainsΩ¯e, called finite elements, such thatΩ¯≈Ω¯h=⋃e=1NEΩ¯e. The geometry of each element is characterized using the standard isoparametric bijective mapping from the master elementΩ^eto the physical elementΩ¯e.Let u be approximated overΩ¯eby the finite element interpolations (the element label e on the variables is omitted in the interest of brevity)(13)u={uxuy}=ΨΔ,w=δu={w1=δuxw2=δuy}=ΨδΔΨ=[ψ10ψ20…ψn00ψ10ψ2…0ψn]Δ={ux1uy1ux2uy2…uxnuyn}TThe strains can be computed as(14)ε=Du=DΨΔ≡BΔ,σ=CBΔwhereDis defined earlier in Eq. (3) and B is a3×2nmatrix(15)B=DΨ=[∂ψ1∂x0∂ψ2∂x0⋯∂ψn∂x00∂ψ1∂y0∂ψ2∂y⋯0∂ψn∂y∂ψ1∂y∂ψ1∂x∂ψ2∂y∂ψ2∂x⋯∂ψn∂y∂ψn∂x]To obtain the finite element model, we substitute Eq. (13) into the variational statement in Eq. (10)(16)0=he∫Ωe(δΔe)TBTCBΔedx−he∫Ωe(δΔe)TΨTfdx−he∮Γe(δΔe)TΨTtds=(δΔe)T(KeΔe−Fe−Qe)or(17)KeΔe=Fe+Qewhere(18)Ke=he∫ΩeBTCBdx,Fe=he∫ΩeΨTfdx,Qe=he∮ΓeΨTtdsThe element stiffness matrixKeis of the order2n×2nand the element load vectorFeand the vector of internal forcesQeis of order2n×1, where n is the number of nodes in a Lagrange finite element.For the linear right-angled triangular (master) element (n=3) with horizontal side of a and vertical side of b, matrix B is given by(19)B=DΨ=[−1a01a0000−1b0001b−1b−1a01a1b0]Fig. 1shows the nodal displacements and forces of the linear master triangular element. The stiffness matrix takes the form (area of the triangle,A=ab/2and h is the thickness of the body)(20)Ke=abh2[c11a2+c33b2(c12+c33)ab−c11a2−c33ab−c33b2−c12ab(c12+c33)abc33a2+c22b2−c12ab−c33a2−c33ab−c22b2−c11a2−c12abc11a200c12ab−c33ab−c33a20c33a2c33ab0−c33b2−c33ab0c33abc33b20−c12ab−c22b2c12ab00c22b2]The nodal forces are given by(21){F1xF1yF2xF2yF3xF3y}=abh2[c11a2+c33b2(c12+c33)ab−c11a2−c33ab−c33b2−c12ab(c12+c33)abc33a2+c22b2−c12ab−c33a2−c33ab−c22b2−c11a2−c12abc11a200c12ab−c33ab−c33a20c33a2c33ab0−c33b2−c33ab0c33abc33b20−c12ab−c22b2c12ab00c22b2]{ux1uy1ux2uy2ux3uy3}where Fixand Fiyare the horizontal (x-direction) and vertical (y-direction) forces, respectively, at node i,i=1,2,3(see Fig. 2). For example, at node 1 we have(22)F1x=abh2[(c11a2+c33b2)ux1+(c12+c33)abuy1−c11a2ux2−c33abuy2−c33b2ux3−c12abuy3]=abh2[c11a2(ux1−ux2)+c33b2(ux1−ux3)+c12ab(uy1−uy3)+c33ab(uy1−uy2)]=−abh2(c11aεxx+c12aεyy+c33bγxy)(23)F1y=abh2[(c12+c33ab)ux1+(c33a2+c22b2)uy1−c12abux2−c33a2uy2−c33abux3−c22b2uy3]=abh2[c12ab(ux1−ux2)+c33ab(ux1−ux3)+c22b2(uy1−uy3)+c33a2(uy1−uy2)]=−abh2(c12bεxx+c22bεyy+c33aγxy)where(24)εyy=ε(2)=uy3−uy1b,εxx=ε(3)=ux2−ux1a,γxy=γ23=ux3−ux1b+uy2−uy1aFrom the strain transformation equations, we haveεn=εxxsin2θ−γxycosθsinθ+εyycos2θwithsinθ=aa2+b2,cosθ=ba2+b2Thus, defining the axial strain along the edges 2–3 asε(1)and using the above strain transformation rules, we can obtain the shear strains in terms of the three axial strainsε(i)(i=1, 2, 3) as(25)γxy=abε(3)+baε(2)−a2+b2abε(1)Therefore, we can express F1xand F1ysolely in terms of the extensional (normal) strains in sides 1, 2, and 3:(26)F1x=−abh2[c11aε(3)+c12aε(2)+c33b(abε(3)+baε(2)−a2+b2abε(1))]=abh2[a2+b2ab2c33ε(1)−1a(c12+c33)ε(2)−a(c11a2+c33b2)ε(3)](27)F1y=−abh2[c12bε(3)+c22bε(2)+c33a(abε(3)+baε(2)−a2+b2abε(1))]=abh2[a2+b2a2bc33ε(1)−b(c22b2+c33a2)ε(2)−1b(c12+c33)ε(3)]Similarly,(28)F2x=abh2[c12aε(2)+c11aε(3)],F2y=c33h2a[a2ε(3)+b2ε(2)−(a2+b2)ε(1)](29)F3x=c33h2b[a2ε(3)+b2ε(2)−(a2+b2)ε(1)],F3y=abh2[c22bε(2)+c12bε(3)]One can verify that the nodal forces are in equilibrium (i.e.,F1x+F2x+F3x=0andF1y+F2y+F3y=0).If we define the unit vectors along the three edges ase1−2=i,e1−3=j,e2−3=(−ai+bj)/a2+b2)(whereiandjare the unit vectors along the coordinate axes, it is easy to see that the nodal forces at node 1 are trivially along the edges 1–2 and 1–3. Next, if we consider the nodal forces at node 2, we see that (using the geometry of the triangular element)(30)F2=F2xi+F2yj=(F2x+abF2y)e1−2+a2+b2bF2ye2−3and(31)F3=F3xi+F3yj=(F3y+baF3x)e1−3−a2+b2aF3xe2−3In other words, the nodal forces at each node can be written in terms of the unit vectors along the edges.For the case of b=a, we have the result(32)F1x=ah2[2c33ε(1)−(c12+c33)ε(2)−(c11+c33)ε(3)]F1y=ah2[2c33ε(1)−(c22+c33)ε(2)−(c12+c33)ε(3)]F2x=ah2(c12ε(2)+c11ε(3)),F2y=−c33ah2(2ε(1)−ε(2)−ε(3))F3x=−ah2c33(2ε(1)−ε(2)−ε(3)),F3y=ah2(c22ε(2)+c12ε(3))A routine calculation further reveals that the direction of the nodal force vectors is along the edges of the triangle. In other words, the FEM formulation of the plane problem in elasticity using right angled triangular elements resembles a truss formed by the nodes and edges of the elements. The nodal forces are along the truss elements (edges of the FEM formulation) while their magnitudes depend upon the extensional strains of all the neighboring truss elements. This is not a surprising result for this specific case, especially considering the special geometry chosen. However, we now show that for any finite element discretization of hyperelasticity, the above result holds.Having explicitly demonstrated that the nodal forces for right angled triangular elements for 2-D isotropic plane elasticity can be recast in the form of a “truss-like” problem, we now turn to the general problem of FEM formulations of hyperelasticity and prove that the result is not a special quirk of triangular elements but it follows from fundamental invariance properties of the strain energy function. Here, we need to generalize the notion of an “edge” as being “the straight line joining any two nodes of a finite element”. Thus, a four-node quadrilateral has six edges, four along the boundary and two along the diagonals. Similarly an eight-node cube will have 28 edges.Thus, we suppose that the elastic mediumΩ¯has been discretized into a finite element meshΩ¯hconsisting of NN nodes and NE elements. It is evident that, for a Green elastic material, given the interpolation functions and the location of the nodes, the strain energy Ψ of the discretized domain can be determined entirely by the position vectorsriof the NN nodes, since these are the generalized coordinates, that (along with the fixed interpolation functions) uniquely determine the configuration of the deformed body. Thus, for a finite element model of a Green elastic body, we must have(33)Ψ=∑e=1NEΨe(rie)where superscript “e” represents the element number, a lower case subscript denotes the node number within an element, that is,(·)iestands for the enclosed quantity at the ith node of the eth elementΩ¯e. Thus if we choose to use mesh of triangular elements, i runs from 1 to 3. If we choose some other higher order element that i runs from 1 to the number of nodes per element.Thus the notation Ψestands for the strain energy of the eth element, while the notationriestands for the current position of the ith node of the eth element (see Fig. 3).Irrespective of how the discretized strain energy is computed, it has to meet a fundamental criterion: translations and rigid body rotations (in the case of infinitesimal deformations, it is the infinitesimal rotation) superimposed on a given configuration of any element (i.e. on any given state of strain) should not change the strain energy function . Thus the elemental strain energy Ψemust satisfy (for each element)(34)Ψe(rie)=Ψ((rie)⁎),(rie)⁎=Qe·rie+cewhere(rie)⁎is the position vector with superposed rigid-body motion,Qeis a proper orthogonal tensor, andceis a constant vector. The above requirement is the counterpart of the notion of invariance under superposed rigid body motions [2] for all classical continua. We now state and prove one of the important results of this study.Theorem 1A necessary and sufficient condition for the strain energy to meet the condition in Eq. (34)is that(35)Ψe=Ψe((dije)2)wheredije=∥rie−rje∥is the distance between the ith and jth nodes of the eth element (seeFig. 3).The fact that form in Eq. (35) is sufficient is a consequence of the fact that the distance between any two nodes of an element is unaffected by translations and rigid body rotations of the element.In other words, it is obvious from Eq. (34), the properties of orthogonal tensors (i.e.,QT·Q=I, the identity tensor and|Q|=±1), and the fact that ceis a constant that(36)((dije)⁎)2=∥(rie)⁎−(rje)⁎∥2=((rie)⁎−(rje)⁎)·((rie)⁎−(rje)⁎)=Q·(rie−rje)·Q·(rie−rje)=(rie−rje)·(QT·Q)·(rie−rje)=(dije)2To prove necessity, we note that since Eq. (34) is valid for allcwe first choosec=0and obtain(37)Ψe((rie)⁎)=Ψe(Q·rie)In other words, Ψ should be an isotropic scalar function of the vectorsrie. Now by virtue of well known representation theorems for isotropic functions of vectors (see [6]), the requirement in Eq. (37) implies that Ψeis a function of the integrity basis for its vector arguments. In the current case, this implies that the strain energy can depend only upon all possible inner products between the vectors, that is(38)(Ψe)⁎≡Ψe((rie)⁎)=Ψe(Q·rie)⇒Ψe=Ψe(rie·rje)(i,j=1,…,n)Next using the fact that(39)rie·rje=∥rie∥2+∥rje∥2−(dije)22,dije=∥ρije∥=∥rie−rje∥Hereρijedenotes the vector connecting element node i to element node j (see Fig. 3). We can further write Eq. (38) in the equivalent form(40)Ψe=Ψe(∥rie∥2,(dije)2)(i,j=1,…,n)Thus invariance under pure rotation about the origin implies that the strain energy function can be dependent only upon the distance of the nodes from the origin and the distance of the nodes from each other.Next, we consider the translation vector c and note that(41)Ψe=Ψe(∥rie∥,(dije)2)=Ψe(∥rie+ce∥2,(dije)2)(i,j=1,…,n)we now choosece=−r1eand arrive at(42)Ψe=Ψe(∥ρi1e∥2,(dije)2)=Ψe((dije)2)(i,j=1,2,…,n)and thus our proof is completed.□Now that we have shown that the requirement that the strain energy of a body that is discretized into finite elements, should be invariant to translations and rotations of the elements implies that the strain energy has to have the simplified form (35), we go on to show that this implies that the nodal forces are always directed along the vectors connecting the nodes of the element. The magnitude of these forces can depend upon the distances from all the nodes that share the element but its direction is along the edges that connect the nodes.To see this, we note that for elastic bodies, the nodal forces for each element are given by an expression similar to Castigliano׳s Theorem I [3], and results in the following form:(43)fie=−∂Ψe∂rie=2∑j=1n∂Ψe(∂dije)2(ρije)where we have also used the chain rule for differentiation to simplify the expression.Upon taking the magnitude of the above expression and noting that∥ρije∥=dijewe see that forces of magnitude(∂ψe/∂(dije)2)dijeare acting along each edge in the element connecting the node i with the other nodes j.The similarity of this expression with that for a truss system and for peridynamics [7] is noteworthy. However there is one key difference, for a simple truss system and for peridynamics, it is assumed that(44)Ψe((dije)2)=∑iNNE∑j>iNNEΨije((dije)2)That is, for the peridynamics approaches, the strain energy is written as just the sum of the strain energies along each edge with no cross dependence. On the other hand for FEM formulations, the strain energy depends upon the distance between all the edges of the element and is not just the sum. This is a crucial feature that is present in FEM formulations that provides them with a richer structure than truss or peridynamics formulations.The results established above do not assume that either the displacements or the strain energy are in any way restricted. For the case of infinitesimal deformations where the strain energy can be at most quadratic, we can obtain the result in a direct way as follows:For the case of infinitesimal deformations, we see that if we write(45)ρije=Rije+uijewhereRije=Rie−Rjeis the relative position of node i with respect to node j in the undeformed configuration anduije=uie−ujeis the relative displacement of node i with respect to node j.Now a routine calculation ofρije·ρije, keeping terms that are at most linear inuije(and assuming that the undeformed configuration is one of minimum energy) reveals that(46)ψe=ψe(ξije),ξije=uije·Rijenosumoniandjwhereξijeis the axial extension11It can easily be shown that the axial extensionξijedefined in Eq. (46) remains invariant under infinitesimal rotations as befits a small deformation theory.along the edge that connects nodes i and j in element e. This in turn implies that the nodal force is given by(47)fie=∂Ψe∂rie=∑j=1n∂ΨeξijeRije

@&#CONCLUSIONS@&#
In this paper we established a very simple but revealing result concerning the forces at the nodes of finite element representations of hyperelasticity. In particular, we established that forces at a node are only functions of the extensional strains along the edges and thus the finite element formulation is “truss-like” but with the forces along the truss members being dependent upon the strains of the neighboring truss members. This result shows that these FEM formulations can be treated in a manner similar (but not identical) to truss systems.