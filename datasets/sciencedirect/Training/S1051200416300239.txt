@&#MAIN-TITLE@&#
High resolution time-frequency representation for chirp signals using an adaptive system based on duffing oscillators

@&#HIGHLIGHTS@&#
Method based on periodic–chaotic states of the Duffing oscillator for time-frequency analysis.Adaptive Duffing Array of five oscillators to precisely measure Chaotic Intermittence.Implementation of a recursive algorithm to obtain time-varying spectra of non-stationary signals.Experiments show extraordinary performance in the analysis of signals with up to −17 dB SNR

@&#KEYPHRASES@&#
Time-frequency,Duffing oscillator,Detection,Estimation,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Typically, detection and estimation of time-varying signals is done through time-frequency (TF) methodologies like those of short-time Fourier Transform, discrete wavelet transform and other more modern techniques like the Wigner and the Choi–Williams distributions [1]. However, all these TF techniques exhibit difficulties when the time-varying signals under study have low SNRs, as in the case of chirp signals immersed in noise.In recent years, detection of extraordinarily low SNR signals with a constant frequency has been reported using chaotic oscillators [2–5] and specifically the Duffing oscillator [6–11]. The use of an array of Duffing oscillators has also permitted the detection of nonlinear time-varying frequencies under high levels of noise – with better results than those obtained from conventional TF techniques – working with chirp signals in environments with very low SNRs [12]. This array approach presented a drawback due to its imprecise way of measuring changes in frequency.In contrast, traditional and modern TF analysis techniques when used to measure signals whose frequency changes over time including the spectrogram, the continuous wavelet transform [13–15] and the Wigner distribution [16–18] have given very accurate results in high SNR scenarios, but they are all seriously impacted when the SNR is too low.Here, and due to an improvement in measuring and detecting the transitions between the periodic and chaotic states of an array of five, self-adjusting Duffing oscillators, this paper proposes a novel method for the analysis of chirp signals with very low SNR in the TF domain as an advantaged choice to the Choi–Williams distribution [1], and the Multiform Tiltable Exponential Distribution (MTED) [18].Furthermore, the experimental comparison allowed noticing that there exist two inner limitations related to the Duffing oscillator: i) Despite the published claims that the chaotic oscillator is immune to noise [6,9,11,14,19–23], it has a noise threshold under which the oscillator can work as a good detector; and ii) the array system oscillator also has a measuring threshold for the frequency variation ratio present in the chirp signal.In what follows, Section 2 provides a short description of the Duffing oscillator chaotic behavior whereas Section 3 describes how such behavior is used to detect chirp signals in high levels of noise and how to obtain the corresponding parameter measurements in the most precise form. Section 4 describes the proposed adaptive system that allows for the measurement of the instantaneous frequency variation of a highly dynamic single component chirp signal within a large frequency range. Finally, Section 5 shows the experimental comparison, based on the relative MSE, among the TF representations using the Choi–Williams distribution, the MTED and the proposed Duffing Adaptive System.The general Duffing oscillator can be modeled as the following non-linear differential equation [24]:(1)y¨+2ζy˙+μy˙3+αy+γy3=0where y represents displacement, ζ is the damping ratio, μ is the non-linear damping coefficient, α is the linear stiffness and γ is the non-linear stiffness.Analysis of the Duffing system under no external force using the homogeneous equation (1) gives 3 equilibrium points, one equilibrium point at(yeq,y˙eq)=(0,0), and two equilibrium points(yeq,y˙eq)=(±−αγ,0)under two different conditions [24]:i)One condition occurs when the stiffness coefficients, both linear and non-linear, have the same sign, that isαγ>0.The other condition occurs when both stiffness coefficients have different signs, that is,αγ<0.Thus, working under such conditions, and when we apply an exciting force composed by the sum of two sinusoidal parts in the presence of additive noisen(t), equation (1) becomes(2)y¨+2ζy˙−αy+γy3=Frcos⁡(ωt)+Acos⁡[(ω+Δω)t+φ]+n(t)whereFris the amplitude of a given single reference signal with the frequency ω chosen to be equal to the initial frequency of an applied input signal (amplitude A, arbitrary phase φ and a frequency drift from the reference of Δω). The additive noise has standard deviation σ.The operating principle of the oscillator is based on the frequency difference between the two involved signals in the equation: the proper reference signal of the Duffing Oscillator (Frcos⁡(ωt)) and the introduced external signal (Acos⁡[(ω+Δω)t+φ]).A complete mathematical demonstration of such transitions is developed in [8] where it is also shown that the amplitude of the oscillator's response is given by(3)F(t)=Fr2+2Frcos⁡(Δωt+φ)+A2.WhenF(t)is smaller than a given but fixed Fo the oscillator exhibits a chaotic state, and whenF(t)is bigger than Fo the oscillator presents its periodic state. Thus, Fo establishes a threshold for transitions between chaos and periodicity [23]. Furthermore, the frequency difference Δω can be estimated when calculating the time at which those transitions occur by means of(4)ΔT=2πΔω.It has also been shown in [20] that any possible noise added to the system, does not affect such transitions and only affects the trajectory of the response, re-enforcing in this manner the chaotic intermittence behavior.From equation (4), the period at which the transitions occur is inversely proportional to Δω, which allows a precise frequency measurement of the input signal even in the presence of noise. Therefore, measuring the period ΔT is one of the most important steps along the process.It should be noted that the existing force for this case only contains a single reference signal, thus limiting this development to single component signal applications.With the purpose of detecting a signal with any frequency variation without necessarily modifying any parameter in equation (1) when ω varies, it is convenient to apply a variable transformation [10] to the system equation, obtaining the state-space system described by(5){x˙=ωyy˙=ω(−2ζy+αx−γx3+Frcos⁡(ωt))It is worth noticing that the state equations (5) have the angular frequency ω as a factor and, therefore, the amplitude in the oscillator response increases as ω increases [4,10,21,23] and this may cause a variation in the threshold between the two possible states. This, in turn, may cause the oscillator to fall off the chaotic intermittence, making it impossible to estimate any dynamic frequency changes in the incoming signal. This has to be taken into consideration when attempting to detect chirp signals.In other words, frequency measurements work well for stationary frequency signals. However, our motivation is to verify that the Duffing oscillator can permit the measurement of time dependent frequency signals, specifically chirp signals.This section is intended to give the reader an idea of how it is possible to detect chirp signals using the Duffing oscillator, the main contribution of this research. We also explain how the system generates a time-frequency representation (TFR). It is important to note here that the proposed system has the ability to detect linear and nonlinear frequency variations and that these variations represent accelerations and decelerations or even changes in acceleration which, in fact, are more consistent with the Doppler Effect in real situations.The Duffing oscillator working under a reference chirp signal whose frequency variation in time, represented byω˙, is described by(6)y¨+2ζy˙−αy+γy3=Frcos⁡(ωt+ω˙t2)+Acos⁡[(ω+Δω)t+(ω˙+Δω˙)t2+φ]+n(t).To work with this type of signal it was assumed that the Duffing oscillator is able to accurately detect the frequency of signals with linear phase variations operating under chaotic conditions as discussed under equation (5). Thus, it is possible to conceive a new time approach where the chirp signal is divided into small time windows short enough to assume that, within each window, the frequency can be considered constant. Furthermore, the selection of the time window has to ensure that the variation of frequency does not take the oscillator out of the intermittence condition.To calculate the accepted frequency variation present in a windowed linear chirp signal described by(7)X(t)={cos⁡(ωt+ω˙t2)fort<|T2|0otherwisewhere T is the width of a symmetric window in the time domain, let us start with rewriting equation (7) as(8)cos⁡(ωt+kt2)=cos⁡(ω0t)cos⁡(kt2)−sin⁡(ω0t)sin⁡(kt2)where k is the corresponding rate forω˙.Ifkt2is small, we get(9)cos⁡(ωt+kt2)=cos⁡(ω0t)−kt2sin⁡(ω0t).Using Taylor's residue theorem for an expected error of 1%, the value for k can be easily calculated, obtainingkt2=0.14radfort<|T2|.Fig. 1displays the time system response where it is possible to observe the transitions between the chaotic and the periodic states. One drawback is the effect of having two implicit variables in time, namely the difference in speed and acceleration of the chirp signal at which those transitions occur, thus preventing the measurement of Δω and consequently any changes in acceleration in the signal separately. Furthermore, as it was pointed out in [12], any dynamic changes in frequency cannot exceed 0.04 rad/sec since it is difficult to perceive the intermittent chaos as the transitions occur very rapidly. Hence, it is highly recommended to keep measuring signals whereΔω<|0.04|.Thus, the proposed system would use rectangular time windows in a similar way as in the short-time Fourier transform (STFT) but, in contrast, it does not apply the Fourier transform to each window, but rather each time window is analyzed using an array of Duffing oscillators for as many different frequency references as those that are meant to be detected. Fig. 2depicts the actual time windowing applied to an incoming signal to a set of Duffing oscillators.Specifically, each one of the windows dividing the signal is introduced to an array of Duffing oscillators which detects the frequency in the window or, in other words, the instantaneous frequency in the period of time defined by that window.Fig. 3illustrates how the frequency measuring procedure is performed for a given initial signalX1(t)– which is the result of multiplying the incoming signal by the very first rectangular window and later simultaneously introduced to each oscillatorOSjin the array. Each oscillator generates transitions between chaos and periodicity as it was expected. Since the oscillators are located at different reference frequencies, each one of them presents a different response, but it must be consistent with the detected frequency by the other oscillators.To implement such proposed technique, an array of Duffing oscillators is set up where each element OSn of the array gives an estimation of the frequency that is being analyzed for a given time window. The array gives a set of different frequency estimates and at the end an average frequencyωais obtained. This procedure is performed for every one of the subsequent time windows that divide the original signal.To properly describe the method to detect chirp signals being proposed here, let us assume that there are only 5 Duffing oscillators (OSj,j=1,…,5) in the array and that the incoming linear chirp signal varies in frequency from 1 rad/s to 1.4 rad/s. Further, and just for the sake of a clear explanation, let us consider a noiseless incoming signal.For a given time window that is presented to the array, Equation (4) indicates that in order to calculate Δω, it is necessary to measure the time interval Δt at which each oscillator gets in and out of its corresponding chaotic state. Fig. 4shows that each oscillator generates a signal response with a different period Δt. Thus, there are 5 measurements, which are close to each other, representing different points of reference and permitting us to obtain a very accurate estimate of the actual frequency.To start measuring Δt, there are some practical considerations based on Fig. 4.First of all, it is clearly seen that the periodic state on the Duffing oscillator response presents a bigger amplitude than the chaotic state. Thus, it is easy to define an amplitude threshold to properly distinguish the time separation between the points that reach that threshold. Therefore, the first step is to detect the points where the signal has an amplitude above such threshold followed by finding the time region where there exist periodic states. The second step is to identify which points belong either to the same periodic state or to a different one. Once we have identified the points belonging to different periods, the distance Δt between them needs to be measured. However, within the response of the particular oscillator under study, we will find several transitions and very likely the measurements will give different Δt but, still very close to each other. Therefore, all those values are averaged producing the final ΔT for that specific oscillator.Secondly, from Fig. 4 it can also be easily seen that the OS4 oscillator is the one with the fewer number of transitions and, in agreement with equation (3), that oscillator is at the non-chaotic state. Therefore OS4 is the one that contains the reference closest to the instantaneous frequency of the incoming signal and it should be taken as an adequate estimate of such frequency.Thirdly, to obtain the most accurate measurement of ΔT, the oscillator with the greatest number of transitions should be taken. Fig. 4 shows that such oscillator is the farthest one from the instantaneous frequency. Precaution should be taken when the number of transitions is so large that it would make it impossible to distinguish one transition from another which, in turn, would make the calculation of Δω very difficult.Finally after finding the most precise ΔT, then Δω can be calculated giving the best estimate of the frequency variation between the reference signal and the incoming signal. Despite having a precise measurement of Δω, such value does not say anything about how the real frequency is changing in time in the sense of not knowing if it increases or decreases; it only says how far away the real frequency from the reference frequency is. Thus, at the moment of calculating the signal frequency, we must consider the reference frequency in the oscillator, aiming to either add or subtract Δω as appropriate.To overcome this difficulty, it would be sufficient to observe where the other oscillators are located with respect to the one that gave the proper estimate of the incoming signal. In the case of Fig. 4, the oscillators OS1, OS2 and OS3 are located at a smaller frequency than OS4 and therefore we must add the Δω to their reference frequencies. Correspondingly, for OS5 the Δω must be subtracted because it is located at a higher frequency than the OS4 oscillator.In this way, the proposed array gives us the required information about Δω because it is possible to identify if it is negative or positive. That is an important reason for applying a Duffing oscillator array.To conclude, once the frequency is calculated for each oscillator, we can now get the average frequency for all responses. This will be the result generated by the oscillators array and hence would be the most precise estimate of the frequency for the particular time window being analyzed.The implementation algorithm is as follows:i)The incoming chirp signal immersed in noise is previously divided into n time windows depending on both the total duration of the whole signal and the condition that the variation of frequency does not exceed the limit of being considered constant for the specific desired precision.Give a first estimate for the incoming frequency signal and set each of the Duffing local reference frequencies, adjusted within a close variation.Select the jth oscillator response and identify points above a given amplitude threshold that distinguishes chaos from periodicity.Account for the i-number of transitions present in the response.MeasureΔtibetween all different periodic states.Calculate the average ΔT.Perform the same procedure for all Duffing oscillators in the array.Identify the oscillator with the least amount of transitions and use its ΔT to calculate the better frequency estimate for this observation window.Decide whether Δω implies if the frequency is increasing or decreasing.Provide the actual frequency estimate for this window.The full algorithm is summarized in Fig. 5.Measuring Δt in the Duffing oscillator response is a key process in the system's performance since it is at this point that the detection of the frequency signal takes place. Therefore, it is necessary to estimate Δt with the least possible error to achieve greater accuracy in the measurement.In this process, it is necessary to identify or highlight any of the two states – periodic or chaotic state – in the oscillators' response to measure the period at which the transitions occur. In the presence of noise, it is observed that the difference in amplitude between the periodic and chaotic oscillator becomes less distinct, as seen for allOSj,j=1, 2, 3, 4, 5, in Fig. 6.For this reason, it is critical to study different methodologies that highlight some of both states to improve measurements and thus, introducing in the system a process to enhance chaos-periodicity transitions.Fig. 7shows how the whole process is modified for a better frequency estimate from the Duffing oscillator array.In Fig. 7,y(t)is the Duffing oscillator response ands(t)is the new signal that is used to measure ΔT.The signal enhancement block is responsible for improving the oscillator response in order to identify the transitions between the states with better accuracy. The studied methods for this purpose were:a)Melnikov Function [8,21].Lyapunov Exponent [11,22].Correlation [25,26].High Order Cumulants [27–29].Squared Response [12,20] of the Duffing Oscillator.Fig. 8shows the results of applying all these methodologies to enhance the signal.The enhancement process is described in [30] and concluded that the correlation method permits the improvement of frequency measurement up to a limit of −28.5 dB of SNR with good accuracy. This fact is confirmed directly in Fig. 8 and, therefore, such method was selected and used by the entire system.In scenarios with very high levels of noise, a problem may persist when measuring the differentΔTjwhich consists in that sometimes there is a periodic state that fails to overcome the previously selected threshold amplitude. For the example in Fig. 6, the problem occurs within the OS5 oscillator at the particular 5th transition. One can see that this periodic state has a lower amplitude than the others.To solve this situation, the method for theΔTjestimation performs a measurement of distances between each of them and compares with the average of the entire signal to later make an automatic assignment of the points that are needed.An inherent difficulty in the array of Duffing oscillators is that in order to use a chirp signal as a reference, it would be necessary to know beforehand the signal to be measured and to adjust the frequency and acceleration parameters accordingly or, at least to know if the frequency rate of the incoming signal is of second order or higher. Hence, the system is rendered useless when measuring a signal that could have unknown variations in frequency.The Duffing array provides a larger frequency range than a single Duffing oscillator because the whole chirp signal is broken in a set of time windows. However, although the use of an array of oscillators produces very good frequency estimation of the signal, it has limitations for detecting the instantaneous frequency in a signal whose frequency range is broad. This could happen because of the possible existence of very high dynamics involved in the given chirp signal. One way of widening the frequency range is to have a very large array of oscillators.The described procedure in the previous section shows that the arrangement of 5 oscillators works very well because it is easy to precisely measure ΔT but, when the array is large, the oscillators that are located too far from the actual instantaneous frequency could not perform an accurate measurement of frequency due to the sensitivity of working in chaotic intermittence.To avoid the use of a large array of oscillators, we also propose a practical solution that consists of generating a system array able to recursively follow the instantaneous frequency detected in a chirp signal. This means that the array adjusts itself to the changes in frequency of the incoming signal independently of those changes increasing or decreasing the frequency.The proposed operating principle is based on the following: after obtaining a first estimate of the instantaneous frequency (using a small window analyzed by the 5 oscillators as described above) then, for the next window that is going to be analyzed, the local reference frequency for each of the oscillators is adjusted according to that specific value. This procedure repeats itself for the whole duration of the incoming signal and so ensures that the array of oscillators is always close to the instantaneous frequency of the chirp signal.This method is always going to need a fixed number of oscillators regardless of the frequency range. In addition, because the system array adjusts the frequency according to the frequency found at each iteration, the system becomes adaptive.As a direct result of the system being adaptive, the main advantage of the proposed method is that the signal frequency to be analyzed does not need to be either a linear or a quadratic chirp signal but it may have any general chirp rate of the form(10)y(t)=A⋅cos⁡(ωt+ω˙t2+ω¨t3+⋯+ω(n)tn)which implies that the signal may contain accelerations, decelerations or any variation that produces a change in its phase over time.Fig. 9is a schematic view which allows for a better understanding of how the entire system operates for such single chirp signals.This section describes how the time-frequency representation is obtained.Because Δω is calculated for each time window in which the unknown chirp signal was divided and because that particular window corresponds to a specific time then, the system array already gives one point in the TF representation. Since the system is adaptive, the next time window will have its corresponding time and Δω which constitute again another point in the TF representation, and so on.The proposed adaptive system array methodology is implemented as follows:i.The chirp signal immersed in high levels of noise is presented for detection.Calculate window size in the time domain for a given expected error.Partition signal into corresponding n windows.nth window processing:a.set local frequency references for allOSj,j=1,…,5adjusted within a close variation of the most likely frequency estimate;the windowed chirp signal is presented to the 5 Duffing oscillator array;Signal Enhancement toOSjforj=1,…,5;MeasureΔtifor all i-transitions at eachOSj;ΔTnaverage calculation;Estimate the instantaneousΔωn;Save coordinate values for the Time vs. Frequency plot.Update frequency reference for the nth +1 window.Recursive analysis for all windows.Generate TF representation.The full algorithm is described in the flow chart presented in Fig. 10.One interesting issue is that of evaluating the computational effort when using the proposed technique. Firstly, it is important to note that the program that implements the Adaptive Duffing System algorithm in fact converges and therefore it has an asymptotic behavior which, in turn, is given by the previously described main algorithm (Fig. 10). Then, it is easy to establish an upper bound by the use of the maximum rule [31] to the whole algorithm. Because there are two loops in the main algorithm, such upper bound belongs to theO(n2). This places our adaptive system in the same order of difficulty as that of the general Cohen's class [32], particularly the Choi–Williams and the Multiform Tiltable Exponential Distribution when they compute their kernel withO(n2)operations [33,34]. This relative computational cost will be experimentally proven in the next section.

@&#CONCLUSIONS@&#
This work achieves a measurement methodology for chirp signals by means of an adaptive Duffing oscillator array. We have proposed a method which takes time windows from the signal of interest and uses the chaotic properties of the Duffing oscillator instead of time-frequency representations. The principal advantage of this technique is that chirp signals can be analyzed for a frequency that varies with time and at low levels of SNR. A collateral important contribution is the enhancement of the Duffing oscillator response achieved with the correlation between its reference signal and the response itself. We have demonstrated that the system is able to detect linear and quadratic frequency shifts and in general it could meet any kind of nonlinear frequency variation. The Duffing oscillator has favorable characteristics for the analysis of weak signals, which presents a clear advantage over the tested traditional time-frequency techniques.As future work, there is the need to compare the proposed method against most modern TF techniques such as the Compact Kernel distribution and adaptive time-frequency distribution [38]. Further, much extra work still needs to be done to test the performance of the Adaptive Duffing Array under multi-signaling conditions.