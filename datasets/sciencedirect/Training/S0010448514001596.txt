@&#MAIN-TITLE@&#
Spiral tool path generation for diamond turning optical freeform surfaces of quasi-revolution

@&#HIGHLIGHTS@&#
Space Archimedean spiral is defined.A new spiral tool path generation based on space Archimedean spiral is proposed to machining freeform surfaces with big slope.The proposed method can be used for 3-axis and 4-axis ultraprecision diamond turning optical freeform surfaces of quasi-revolution.

@&#KEYPHRASES@&#
Spiral tool path,Ultraprecision machining,Diamond turning,Surface of quasi-revolution,Space Archimedean spiral,

@&#ABSTRACT@&#
Space Archimedean spiral is defined firstly in this paper. Thereafter, a new spiral tool path generation based on space Archimedean spiral is proposed for diamond turning optical freeform surfaces of quasi-revolution, which is defined as a surface close to some surface of revolution. By projecting the space Archimedean spiral onto the freeform surface along the normal direction of the base surface instead of a fixed direction like traditional method, a quasi-uniform spiral tool path on the freeform surface can be obtained. This method can be used on diamond turning optical freeform surfaces. Finally, two examples are presented to prove its effectiveness and adaptability.

@&#INTRODUCTION@&#
With the development of optical technology, more and more complex optical freeform surfaces are designed, which are not rotationally symmetric surfaces and have special properties. Usually, ultraprecision diamond turning is used to machine simple optical reflector. But, for complex optical surfaces, especially for freeform surfaces, there is still lack of effective tool path generation method.Tool path generation methods for multi-axis machining freeform surfaces have been developed greatly in industrial and academic fields  [1,2]. Most algorithms focused on multi-axis milling, which includes end milling and flank milling  [3,4]. These algorithms mainly concentrate on several issues: increasing machining strip width, improving dynamic performance, avoiding local or global interference, cutting deformation  [5–7] etc. But few papers focused on tool path generation for multi-axis turning [4,8], especially for unsymmetrical freeform surfaces. Three-axis diamond turning is a well-developed technology, which can produce contoured surfaces with surface finish in the range of 5 nm Ra and long range accuracy of micrometers or less  [9].For three-axis turning freeform surfaces, spiral tool path is the most typical method  [10–15], as shown in Fig. 1. Spiral tool path is also a typical method in current CAM (Computer Aided Manufacturing) software system. According to current applications, it can be categorized as rough machining and finish machining. For rough machining, we often mill cavity level by level, especially in High Speed Machining (HSM). Spiral tool path is generated in each level to improve dynamic characteristics of the machine tool to ensure optimal machining performance   [16–18]. Bieterman etc.  [16] generate the morphed spiral tool path by solving the eigen-value problem for an elliptic PDE, subject to Dirichlet’s boundary conditions. Martin Held etc.  [17] proposed a method to generateG1-continuous spiral tool path for high-speed machining of pockets without islands by interpolating growing disks placed on the medial axis of the pocket. They can guarantee that the tool path is free of self-intersections and no tool retractions. Avisekh Banerjee etc.  [18] proposed a morphed spiral tool path consisting ofG1continuous biarc and arc spline for machining a floor, which can handle islands in pockets.For finish machining, spiral tool path is usually generated by projecting Archimedean spiral onto the designed surface, which is well known in current CAD/CAM systems, such as UG NX. But this method has a distinct disadvantage: when the slope of surface increase, the distance between two adjacent passes of the projected spiral will increase, as shown in Fig. 2, distance B>A, especially when the normal of surface is vertical to the projecting direction, the distance between two adjacent passes is infinite. Obviously, this disadvantage will leads to different machining error distribution on the whole surface. In order to make the maximum error on the surface less than permissible error, we often need to add more turns of the Archimedean spiral. It will leads to sharp increase of the quantity of redundant data of tool positions. To solve this problem, a new spiral tool path generation method for diamond turning will be presented in this paper.As we know, Archimedean spiral is the locus of points corresponding to the locations over time of a point moving away from a fixed point with a constant speed along a line with constant angular velocity. Equivalently, in polar coordinates(r,θ)it can be described as(1)r=a+bθwith real numbersaandb.rdenotes the polar distance. Eq. (1) also can be written as follows:r=b(ab+θ).Ifais changed, the initial angle is changed, which means that spiral is turned, whilebcontrols the distance between successive turnings. In rectangular coordinate system it can be described as(2){x=rcosθ=(a+bθ)cosθy=rsinθ=(a+bθ)sinθ.For tool path generation of diamond turning, without loss of generality, we can supposea=0,b>0andθ∈(0,θe]. Usually,bdepends on the allowable machining error;θedepends on the area of machined surface.Obviously, Archimedean spiral lie on a plane, which can be parameterized by two parametersrandθlike Eqs. (1) and (2). Further, it can be looked as the special case of surface of revolution when the generating curve is a radial, as shown in Fig. 3(a). According to Eq. (1), the quasi-plane is parameterized with polar coordinates, which have two parametersrandθ. Given a constantθ=θi(i=1∼n), we can get a group of parameter curves, which are radials. Given a constantr=ri(i=1∼n), we can get another group of parameter curves, which are circles. For the convenience of presentation, we call the radial as longitude. The circle is called as latitude. The two groups of curves are orthogonal at the point of intersection. Suppose the longitude is deformed to a plane curve using isometric mapping within the plane that pass throughZaxis and the corresponding longitude, as shown in Fig. 3, the plane is deformed to a generic surface of revolution. Correspondingly, the Archimedean spiral on the plane is deformed to a space spiral curve. This curve has a property: the arc length between successive turnings will not change, but the length of the spiral shrinks. For example, also see Fig. 3(a),Pi(i=1∼n)denote the points of intersection between radial and Archimedean spiral, the arc length betweenP1andP2will not change after deformation. Following this idea, we can map an Archimedean spiral onto a generic surface of revolution and get a space spiral curve with uniform successive turnings. This space spiral curve can be called space Archimedean spiral.According to Fig. 3, without loss of generality, the longitude of generic surface of revolution can be written as(3)f=f(s)=(Y(s),Z(s))s∈(0,se]wheresdenotes arc length parameter. Further, surface of revolution can be written as(4){x=Y(s)cosβy=Y(s)sinβz=Z(s).β∈[0,2π]According to Eq. (1) and the description of mapping from Archimedean spiral to space Archimedean spiral, we can getr=s. Therefore, we have(5)s=a+bθθ∈(0,θe].In addition,(6)β=θmod2π⇒{cosβ=cosθsinβ=sinθ.Substituting Eqs. (5) and (6) into Eq. (4), we can get the spiral Archimedean spiral as follows(7){x=Y(a+bθ)cosθy=Y(a+bθ)sinθz=Z(a+bθ).θ∈(0,θe]Fig. 4just presents a typical mapping from Archimedean spiral to space Archimedean spiral.We usually cannot get the analytical expression off=f(s)with respect to arc length parameters. The longitude of generic surface of revolution is often represented asR=R(t)with respect to generic parametert. In this paper, we adopt B-spline curveR(t)=∑n=0nNi,p(t)Pia≤t≤b.Obviously, we can calculate the arc length ofR(t)using numerical integration. The corresponding point on this curve can be determined for given arc lengths.As mentioned in Section  1   [10–15], current spiral tool path generation methods for diamond turning are mainly based on Archimedean spiral. For the convenience of understanding, the plane that Archimedean spiral belongs to can be called as base surface. Obviously, to generate tool path, Archimedean spiral is projected in the normal direction of the base surface in previous literatures. If the angle between the normals of the base surface and the designed surface is small, the projected spiral on the designed surface has relative uniform successive turnings. Therefore, this kind of surface is suitable to use Archimedean-spiral-based method. Further, letnplanedenote the unit normal of the base surface.ndesigndenotes the unit normal of the designed surface. The acute angle betweenndesignandnplanecan be written as(8)φ=arccos(|nplane⋅ndesign|).For the whole designed surface, ifmax(φi)≤φlim(i=1∼n), we think that the designed surface can be machined using Archimedean-spiral-based method.φlimdenotes the allowable angle limit.Unfortunately, we often get optical surfaces that meetmax(φi)>φlim. For example, as shown in Fig. 5, this is a compound-eye surface. There are many small spherical patches on a big sphere. Obviously, this surface is not suitable to use Archimedean-spiral-based method because the designed surface is close to the big sphere instead of a plane. Further, let us imagine that the big sphere can be looked as a surface of revolution. Following this idea, the base surface may be a generic surface of revolution instead of plane or sphere. If the designed surface is close to a generic surface of revolution, a new spiral tool path generation method based on the space Archimedean spiral can be developed as follows.Firstly, for the given designed surface, we need to determine if its shape is close to some surface of revolution. If yes, we call it surface of quasi-revolution. How to define surface of quasi-revolution mathematically? As shown in Fig. 6, LetSddenotes a given designed surface.Srdenotes a surface of revolution.p1denotes a point ofSd. The unit normal ofSdat pointp1isn1.p2denotes the nearest point onSrto pointp1. The unit normal ofSrat pointp1isn2. Similar to Eq. (8), the acute angle betweenn1andn2can be written as(9)α=arccos(|n1⋅n2|).For the whole designed surfaceSd, ifmax(αi)<αlim(i=1∼n), we call the designed surface as a surface of quasi-revolution.αlimdenotes the allowable angle limit.Secondly, how can we determine the best fittingSrsurface to the givenSdsurface? As we know, a surface of revolution includes two parameters: the rotation axis and the shape of generating curve. Supposetdenotes the unit direction vector of rotation axis andRdenotes the generating curve, according to Eq. (4), the abovementioned shape determination and fitting problem can be described as the following optimization problem.(10){A=min(max(αi))(t,R)s.t.A<αlim.The shapeRand orientationtare searched to find aSrthat allows error limitαlim. Obviously, this is a nonlinear optimization problem. This is very difficult to get global optimum. To simplify this problem, we can choosetby human–computer interaction, which mean thattis known. Eq. (10) can be simplified as(11){A=min(max(αi))(R)s.t.A<αlim.If we cannot find the solution of Eq. (10) or Eq. (11), it shows that the designed surface may not be machined by using diamond turning with spiral tool path. We need to resort to other methods.Once the proper shape of surface of quasi-revolution is found, the corresponding surface of revolutionSrcan be obtained as the base surfaceSb. Further, we can calculate an Archimedean spiral on the plane. Then, it can be mapped ontoSb. A space Archimedean spiral can be generated according to the definition of space Archimedean spiral in Section  2.1. Finally, by projecting the space Archimedean spiral onto the designed surface in the normal direction of the base surfaceSb, final spiral tool path can be obtained. Obviously, the base surfaceSbhas varying normal directions, which is the major difference from Archimedean-spiral-based method. The projecting process is shown in Fig. 7,pbdenotes one point of space Archimedean spiral on the base surfaceSb,nbdenotes the normal ofSbat the pointpb. By projectingpbonto the designed surface alongnb,pdcan be obtained, which is a point on final spiral tool path. Therefore, by repeating this process, we can get a series of point of final spiral tool path on the designed surface.In Section  2, the basic calculation process of tool path generation of diamond turning based on space Archimedean spiral has been presented. In this section, two typical cases will be calculated by using the proposed method. In the first case, the designed surface is a compound-eye surface, as shown in Fig. 5. The detailed calculation process: (1) According to Eqs. (10) and (11), in order to simplify the calculation, the normal line at a point on the middle patch of the designed surface is chosen as the rotation axist; (2) Sample the designed surface into several points uniformly and rotate them to a plane around the rotation axist; (3) The least square method is used to fit the revolved projected points and get the generating curve, as shown in Fig. 8(a); (4) Rotate the generating curve and get the base surfaceSb, see Fig. 8(b); (5) Calculate the space Archimedean spiral on the base surfaceSb, see Fig. 8(c); (6) Project the space Archimedean spiral onto the designed surface and get the spiral tool path, see Fig. 8(d). Following this process, the spiral tool path is generated too, see Fig. 9. Compared with case 1, the normal at the bottom of designed surface has bigger slope. Obviously, we cannot use traditional Archimedean-spiral-based method to generate spiral tool path for this case.In order to prove the effectiveness of the proposed method, an experiment has been conducted to machine the compound eye on Moore ultraprecision Lathe. The pitch of space Archimedean spiral is 2 μm. The average spindle speed is about 20 rev/min. The material of workpiece is PMMA (Polymethyl methacrylate). Cutting tool is a single crystal diamond tool with nose radius 0.02 mm, as shown in Fig. 10. The machining result is shown in Fig. 11. Taylor Hobson surface profiler is used to measure part of the machined compound eyes, as shown in Fig. 12(a). To analyze the form error, a spherical patch is separated from measured point clouds. Least square method is used to obtain form error 2. 3 μm, as shown in Fig. 12(b).

@&#CONCLUSIONS@&#
Projecting Archimedean spiral onto the designed surface along a given direction is widely used method in CAM system. However, it has serious problem when the slope of the designed surface relative to projecting direction is very large. To solve this problem, a new spiral tool path generation based on space Archimedean spiral is proposed for diamond turning optical freeform surfaces of quasi-revolution, which is defined as a surface close to a surface of revolution. By projecting the space Archimedean spiral onto the designed surface along the normal direction of the base surface instead of a fixed direction, we can get a quasi-uniform spiral tool path on the designed surface. When the base surface is a plane, it is just the traditional method. Therefore, the proposed method is a generalized method of projecting spiral method. This method can be used on 3-axis or 4-axis diamond turning optical surfaces, especially complex optical freeform surfaces.