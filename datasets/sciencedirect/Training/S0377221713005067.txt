@&#MAIN-TITLE@&#
Robustness of optimal portfolios under risk and stochastic dominance constraints

@&#HIGHLIGHTS@&#
Robustness of risk constrained portfolio selection problems.Robust FSD portfolio efficiency tests.Contamination technique.Stress testing of parameters in the Markowitz model.Stress testing with respect to additional scenarios.

@&#KEYPHRASES@&#
Robustness and sensitivity analysis,Markowitz mean–variance model,Probabilistic risk constraints,Contamination technique,First order stochastic dominance constraints,Portfolio efficiency tests,

@&#ABSTRACT@&#
Solutions of portfolio optimization problems are often influenced by a model misspecification or by errors due to approximation, estimation and incomplete information. The obtained results, recommendations for the risk and portfolio manager, should be then carefully analyzed. We shall deal with output analysis and stress testing with respect to uncertainty or perturbations of input data for static risk constrained portfolio optimization problems by means of the contamination technique. Dependence of the set of feasible solutions on the probability distribution rules out the straightforward construction of convexity-based global contamination bounds. Results obtained in our paper [Dupačová, J., & Kopa, M. (2012). Robustness in stochastic programs with risk constraints. Annals of Operations Research, 200, 55–74.] were derived for the risk and second order stochastic dominance constraints under suitable smoothness and/or convexity assumptions that are fulfilled, e.g. for the Markowitz mean–variance model. In this paper we relax these assumptions having in mind the first order stochastic dominance and probabilistic risk constraints. Local bounds for problems of a special structure are obtained. Under suitable conditions on the structure of the problem and for discrete distributions we shall exploit the contamination technique to derive a new robust first order stochastic dominance portfolio efficiency test.

@&#INTRODUCTION@&#
In conclusions of his famous paper (Markowitz, 1952) on portfolio selection, Markowitz stated that “what is needed is essentially a ‘probabilistic’ reformulation of security analysis”. He developed a model for portfolio optimization in an uncertain environment under various simplifications. Let us recall the basic formulation: The composition of portfolio of N assets is given by weights of the considered assets,xn,n=1,…,N,∑nxn=1. The unit investment in the nth asset provides the random return ρnover the considered fixed period. The assumed probability distribution of the vector ρ of returns of all assets is characterized by a known vector of expected returns Eρ=μ and by a fixed covariance matrix Σ=[cov(ρi,ρj), i, j=1,…,N] whose main diagonal consists of variances of individual returns. This allows to quantify the “yield from the investment” as the expectationEPρ⊤x=∑nxnμn=μ⊤xof its total return and the “risk of the investment” as the variance of its total return,varPρ⊤x=∑i,jcov(ρi,ρj)xixj=x⊤Σx. Investors aim at maximal possible yields and, at the same time, at minimal possible risks – hence, a typical decision problem with two criteria, “max” {EPρ⊤x,−varPρ⊤x} or “min” {−EPρ⊤x, varPρ⊤x}. The mean–variance efficiency introduced by Markowitz is fully in line with general concepts of multiobjective optimization. Accordingly, mean–variance efficient portfolios can be obtained by solving various optimization problems such as the risk-adjusted expected return problem(1)minx∈X-λμ⊤x+1/2x⊤Σxwhere the value of parameter λ⩾0 reflects investor’s risk aversion. Another possibility, favored in practice, is to minimize the portfolio variance subject to a lower bound for the total expected return, i.e.(2)minx∈Xx⊤Σxsubject toμ⊤x⩾kwith parameter k, or to maximize the expected return under a constraint on the portfolio variance(3)maxx∈Xμ⊤xsubject tox⊤Σx⩽v.In the classical theory, the setX=x∈RN:∑nxn=1is without nonnegativity constraints, which means that short sales are permitted. Under this simplification explicit forms of optimal solutions can be obtained. In what follows we shall allow in (1)–(3) for general convex polyhedral setsX.It was the introduction of risk into the investment decisions which was the exceptional feature of this model and a real breakthrough, and the Markowitz model became a standard tool for portfolio optimization.The optimal solution x∗(μ,Σ;λ) and the optimal value φ(μ,Σ;λ) of (1) depend on the chosen value of λ and on parameters μ, Σ. At the same time, one can hardly assume full knowledge of these input parameters. The impact of errors in expected returns, variances and covariances on the optimal return φ of the obtained portfolio was investigated, e.g. in a simulation study Chopra and Ziemba (1993). The results indicate that the errors in expected values are more influential than those in the second order moments. We refer to Fabozzi, Huang, and Zhou (2010) for discussions of suitable approaches dealing with parameters uncertainty for the Markowitz model, such as robust reformulations and advanced estimation techniques, and also to Dupačová (2012) for results based on parametric programming, stochastic sensitivity analysis and the worst-case analysis.We shall deal with static mean-risk models for portfolios of assets with random returns ρ whose probability distribution P does not depend on the selected portfolio composition. (Recall the assumption of a small investor in the Markowitz model.) The yield from the portfolio x is again the expectation EPρ⊤x, the risk is understood now as a functionRwhich assigns a real number to uncertain outcomes ρ⊤x of the decision x. The value of functionRshould not depend on the realization of the uncertain return ρ but it depends on the decision and on the probability distribution P; accordingly we shall denote itR(x,P). It should posses some natural properties such as monotonicity, translation equivariance, positive homogeneity and subadditivity to be called coherent; see Artzner, Delbaen, Eber, and Heath (1999). The well-known risk measure Value at Risk (VaR), which is not coherent in general, and the coherent Conditional Value at Risk (CVaR) are special cases ofR. We refer to the recent survey paper Krokhmal, Zabarankin, and Uryasev (2011) for other possibilities.For a known probability distribution P of returns the problems corresponding to f (1)–(3) are(4)minx∈X-λEPρ⊤x+R(x,P),(5)minx∈XR(x,P)subject toEPρ⊤x⩾k,(6)maxx∈XEPρ⊤xsubject toR(x,P)⩽v.The form (4) with a probability independent set of feasible decisions is convenient for applications of quantitative stability analysis techniques, whereas risk management regulations ask frequently for satisfaction of risk constraints with a fixed limit v displayed in (6). Solving (6) for various values of v one obtains directly the corresponding points [μ⊤x∗(v),v] on the mean-risk efficient frontier. Numerical tractability of the mean-risk problems depends on the choice of the risk measure and on the assumed probability distribution P. Programs (4)–(6) are convex for variance of portfolio returns,R(x,P)=x⊤Σx, and for convex risk measuresR(•,P), such as CVaR, but not for VaR; see Dupačová (2006) and Dupačová and Polívka (2007). As the probability distribution P is fully known only exceptionally, quantitative stability analysis with respect to changes of P is important. The selected approach should reflect the type of the risk functionR(x,P)and of the input information which, in general, does not consist only of the first and second moments. See e.g. Stoyanov, Rachev, and Fabozzi (2013) for analysis of influence of moments of fat-tailed return distributions on portfolio VaR and CVaR in a parametric setting. Aiming at numerically tractable approaches, one may design focused simulation studies and backtesting; also the worst-case analysis or robustification with respect to all probability distributions belonging to an uncertainty setPis applicable in various situations, see e.g. Pflug and Wozabal (2007) and Zhu and Fukushima (2009). In this paper we shall approach the quantitative stability analysis with respect to changes of P by stress testing via contamination, see Dupačová (2006) and Dupačová and Kopa (2012) and Dupačová and Polívka (2007).In our paper Dupačová and Kopa (2012), convexity and smoothness properties of risk functionsR(x,P)in (5) and (6) were exploited to get local contamination bounds for the optimal value. The results hold true, e.g. for portfolio optimization under the variance or CVaR constraints. Now we shall focus on relaxation of convexity and smoothness assumptions having in mind distributional robustness analysis and stress testing for risk averse portfolios with risk quantified by means of probabilistic constraints and for the first order stochastic dominance constraints. Probabilistic constraints appear in definition of VaRαof a portfolio(7)VaRα(x,P)=min{a∈R:P(g(x,ρ)⩽a)⩾α},where g(x,ρ) denotes the loss of portfolio x for return ρ, and they were considered in the context of risk modeling already by Telser (1955) and Kataoka (1963) for a bilinear loss function and Gaussian distribution of ρ. In the present paper, such special assumptions are not imposed. Subsequently, the first order stochastic dominance constraints will be exploited.In Section 3, we shall describe the contamination technique and we shall deal with local contamination bounds under relaxed assumptions. The results will be applied in Section 4 to efficiency tests of portfolios under the first order stochastic dominance constraints.Consider the following abstract formulation of (6) written now as a minimization problem:(8)minx∈X(P)G0(x,P)where P is the probability distribution of a random vector ρ with rangeΩ⊂RM. The objective function G0 quantifies the loss of portfolio and risk constraints enter the definition of the set of feasible solutionsX(P)⊂RN. We denoteX∗(P)the set of optimal solutions and φ(P) the optimal value of the objective function in (8) and we shall assume that φ(P) is finite. The considered set of feasible solutions is of the form(9)X(P)≔{x∈X:Gj(x,P)⩽0,j=1,…,J}.We shall focus on probabilistic risk constraints with(10)Gj(x,P)≔Rj(x,P)-vjandRj(x,P)≔P(gh(x,ρ)⩾0,h∈Hj),j=1,…,Jwheregh:RN×Ω→RandHj⊂{1,…,K}. Individual probabilistic constraints, e.g. in definition (7) and in Kataoka (1963) and Telser (1955), correspond to Hjcontaining one element of {1,…,K}, whereas the index set Hjin a joint probabilistic constraint contains more than one element; such constraints express a reliability requirement of a whole system. Probability levels vj∈(0,1) are fixed, prescribed by regulations or chosen by the decision maker.The setX(P)is typically nonconvex, sometimes even disconnected, and functions Gj(•,P) need not be smooth. This is the reason why probabilistic programs have been recognized as hard optimization problems that are rather demanding from the computational point of view. The seminal results on convexity ofX(P)were proved by Prékopa, cf. Prékopa (1971), under specific assumptions concerning both the function g and the probability distribution P. See Prékopa (2003) and Chapter 5 of Shapiro, Dentcheva, and Ruszczyński (2009) for details. A favorable class are, e.g. linear probabilistic constraints with Gaussian coefficients (van Ackooij, Henrion, Möller, & Zorgati, 2011) that appear in Kataoka (1963) and Telser (1955).In practice, complete knowledge of P is rare; still the wish is to apply such solution of (8) which is reliable and robust even in situations when the true probability distribution P has been approximated or when it is known only partly. This gives a motivation for stability analysis of (8) with respect to perturbations of P. The probability distribution P plays a role of an abstract parameter and dependence of the set of feasible solutions on P complicates the stability considerations substantially. General stability results were proved by Römisch without any convexity assumptions; cf. Theorems 5 and 9 in Römisch (2003). They were detailed mainly for linear probabilistic programs with random right hand sides, which does not agree with the form of the considered risk constraints, and for generalized concave probability distributions, see, e.g. Römisch (2003) and Römisch and Schultz (1991). The main stumbling block for their application is the requirement of the metric regularity property, see, e.g. Chapter 2.3 of Bonnans and Shapiro (2000). For the first order stochastic dominance constraints stability and sensitivity analysis is even more involved; cf. Dentcheva, Henrion, and Ruszczyński (2007).If ρ has a finitely discrete distribution(11)P(ρ=ρs)=ps,s=1,…,Swith ps>0, the setXin (9) is compact and functions g(•,ρs) are continuous for all s, then it is possible to rewrite problem (8)–(10) as a mixed integer program, see, e.g. Ruszczyński (2002). Consider only one probabilistic constraint, i.e. J=1, H1={1,…,K}, and for each s∈{1,…,S} introduce a binary variable zssuch that zs=0 guarantees thatg(x,ρs)⩽0∀x∈X, and a K-dimensional vector Mswhose components are sufficiently large. For a deterministic objective function G0 the problem (8)–(10) can be written as(12)minimizeG0(x)subject tog(x,ρs)-Mszs⩽0,s=1,…,S(13)∑spszs⩽v1,x∈X,zs∈{0,1}∀s.For convex functions G0 and gh(•,ρs) ∀h, s this is a large convex mixed integer program.Sometimes, the wish may be to observe a stochastic ordering of outcomes. The concept of stochastic ordering was introduced in statistics already in the 1940s and is known under the name the first order stochastic dominance (FSD):Definition 1We say that a random variable ξ dominates a random variable ζ with respect to the first order stochastic dominance (ξ⪰FSDζ) ifP(ξ⩽y)⩽P(ζ⩽y)∀y∈R.In financial applications constraints based on the FSD allow us to incorporate random benchmarks (defined on the same probability space) instead of fixed thresholds. The FSD relation can be alternatively defined as follows:(i)ξ⪰FSDζ if and only if Eu(ξ)⩾Eu(ζ) for all nondecreasing utility functions u provided the expected values above are finite; see for example Chapter 3.2 in Levy (2006).ξ⪰FSDζ if and only ifFξ(-1)(y)⩾Fζ(-1)(y)for all y∈[0,1], or equivalently, if and only if VaRα(−ξ)⩽ VaRα(−ζ) for all α∈[0,1]; see, e.g. Ogryczak and Ruszczyński (2002).Unfortunately, in both cases as well as in Definition 1, FSD constraints are expressed in general as a continuum of constraints; see Dentcheva et al. (2007) and Dentcheva and Ruszczyński (2004).In the subsequent analysis of results under distributional uncertainty we shall follow, similarly as in Dupačová and Kopa (2012), the relatively simple ideas of output analysis based on the contamination technique initiated in Dupačová (1986) and Shapiro (1990). The considered special type of perturbations reduces the stability analysis of (8)–(10) to that for parametric programs with one-dimensional real parameter. At the same time, it gets on with needs for what-if-analysis or stress testing. As we shall see, it can be exploited also to study influence of changes in parameters in parametric models such as the Markowitz mean–variance model.The contamination approach was initiated in mathematical statistics as one of tools for the analysis of robustness of estimators with respect to deviations from the assumed probability distribution and/or its parameters. Contamination means to model the perturbations of P by its contamination by another fixed probability distribution Q, i.e. to use Pt≔(1−t)P+tQ, t∈[0,1]. It was developed and applied for program (8) withX(P)independent of P and for the expectation type objective G0(x,P), cf. Dupačová (1996) and Dupačová (2006) and Dupačová, Bertocchi, and Moriggia (1998) and Dupačová and Polívka (2007), under assumption that the optimal value φ(t) is finite for all t∈[0,1] and the set of optimal solutions of the unperturbed program is compact. It proved to be a flexible tool which is suitable in various disparate situations: By contamination of discrete probability distributions one may model changes in scenario probabilities, scenario values and the impact of inclusion of additional, stress scenarios – the choice of a degenerated distribution Q concentrated in ρ∗∉Ω corresponds to an additional scenario. See, e.g. Dupačová (1996) and Dupačová et al. (1998). The basic properties of the optimal value function are summarized in the following lemma.Lemma 1Assume thatX(P)=Xis independent of P, the set of optimal solutionsX∗(P)of(8)is nonempty and compact, the perturbed objective function G0(x,t)≔G0(x,Pt) is a linear function of t and that its optimal valueφ(t)≔minx∈XG0(x,t)is finite for all 0⩽t⩽1. Then φ(t) is a lower semicontinuous concave function on [0,1].Consult, e.g. Theorem 4.3.2 of Bank, Guddat, Klatte, Kummer, and Tammer (1982). This lemma allows us to construct global bounds for φ(t)(14)(1-t)φ(0)+tφ(1)⩽φ(t)⩽φ(0)+tφ′(0+)∀t∈[0,1]valid for all 0⩽t⩽1. The directional derivative(15)φ′(0+)=minx∈X∗(P)G0(x,Q)-φ(P).In the presence of risk constraints the set of feasible solutions depends on P which means that the optimal value function is concave only exceptionally and the lower bound in (14) does not hold true.The set of feasible solutions (9) for the contaminated probability distribution Ptequals(16)X(Pt)=X∩{x:Gj(x,Pt)⩽0,j=1,…,J}.The probabilistic risk functionsR(x,P)in (10) are linear in P, hence, Gj(x,Pt)=(1−t)Gj(x,P)+t Gj(x,Q)≔Gj(x,t) ∀j are linear in t. We assume again that the perturbed objective function G0(x,t) is also linear in t. The perturbed problem (8) is then the linearly perturbed parametric program(17)minx∈X(1-t)G0(x,0)+tG0(x,1)(18)subject to(1-t)Gj(x,0)+tGj(x,1)⩽0,j=1,…,J.We denoteX(t),φ(t),X∗(t)the set of feasible solutions, the optimal value and the set of optimal solutions of (17) and (18). Fort=0,X(0),φ(0),X∗(0)denote the set of feasible solutions, the optimal value and the set of optimal solutions of the initial unperturbed problem.For parameter dependent sets of feasible solutions the optimal value function φ(t) is concave only under rather strict assumptions such as Gj(x,t), j=1,…,J jointly concave onX×[0,1]; cf. Corollary 3.2 of Kyparisis and Fiacco (1987). The form of (14) suggests that we should concentrate on the existence and form of the directional derivatives and on assumptions under which the setsX(t)remain fixed at least for small values of the contamination parameter t.If the linear independence condition and the strict complementarity condition hold true at the optimal solution x∗(0) of the unperturbed convex problem, then for t⩽t0 small enough, the optimal value φ(t) is concave and a local upper bound can be constructed according to (14). The same statement can be obtained for nonconvex problems when also the second order sufficient condition is satisfied.Theorem 1Let(8)–(10)be a twice differentiable program with probabilistic constraints, x∗(P)=x∗(0) its optimal solution. Assume that at x∗(0) linear independence, the strict complementarity and the second order sufficient conditions are satisfied. Then there exists t0>0 such that for all t∈[0,t0] the optimal value function φ(t) is concave and the local upper contamination bound is given by(19)φ(t)⩽φ(0)+tφ′(0+)∀t∈[0,t0].We refer to Dupačová and Kopa (2012) for details and basic references.There exist various formulas for directional derivative φ′(0+) based on the Lagrange functionL(x,u,t)=G0(x,Pt)+∑jujGj(x,Pt)for the contaminated problem. The generic form isφ′(0+)=minx∈X∗(0)maxu∈U∗(x,0)∂∂tL(x,u,0)whereU∗(x,0)denotes the set of Lagrange multipliers coupled with the optimal solutionx∈X∗(0)of the unperturbed problem. For convex unperturbed programs with unique optimal solution x∗(0), multipliers u∗(0) and for L(x,u,t) linear in t it simplifies to(20)φ′(0+)=L(x∗(0),u∗(0),1)-φ(0).Derivations of relevant formulas proceed in accordance with the assumed properties of problem (17) and (18); consult Section 4.3.2 of Bonnans and Shapiro (2000).For the accepted structure of perturbations the lower bound for the optimal value function of (17) and (18) is based on Theorem 1 of Dupačová and Kopa (2012):Theorem 2Dupačová and Kopa (2012).Assume that in(17) and (18)X⊂RNis a nonempty convex set, G0(x) is independent of t, G(x,t) is a concave function of t∈[0,1] and φ(t) is finite for all t∈[0,1]. Then the optimal value functionφ(t)≔minx∈XG0(x)subject toG(x,t)⩽0is quasi-concave on [0,1] with the lower bound(21)φ(t)⩾min{φ(1),φ(0)}.Theorem 2 directly applies if there is only one probabilistic risk constraint and the objective function G0 does not depend on P. However, the result can be extended to objective functions G0(x,P) which are concave in P:(22)φ(t)=minx∈X(t)G0(x,t)⩾minx∈X(t)[(1-t)G0(x,0)+tG0(x,1)]⩾(1-t)minφ(0),minX(1)G0(x,0)+tminφ(1),minX(0)G0(x,1),and also to multiple probabilistic risk constraints.Multiple probabilistic risk constraints in (9) can be reformulated as G(x,P)≔maxjGj(x,P)⩽0, but then the function G(x,P) is convex in P. As the probabilistic risk constraints are linear in P, G(x,t)≔maxjGj(x, Pt) is a convex piecewise linear function of t. It means that there existst̃>0such that G(x,t) is a linear function of t on[0,t̃]and we get the local lower boundφ(t)⩾min{φ(0),φ(t̃)}valid fort∈[0,t̃]. Notice that no convexity assumption with respect to x was required.Similarly as in Dupačová and Kopa (2012), trivial upper bounds for φ(t) are available without any differentiability assumption if no constraint is active at x∗(0) or if for all constraints active at x∗(0), i.e. Gj(x∗(0),0)=0,j∈J0, inequalities Gj(x∗(0),1) ⩽0,j∈J0 hold true. Then for t small enough, x∗(0) is a feasible solution of (18), hence G0(x∗(0),t)⩾φ(t) for t small enough. Using linearity of G0 with respect to t,φ(t)⩽φ(0)+t(G0(x∗(0),1)-φ(0));compare with (14) and (15).An upper bound for φ(t) can be also constructed whenever there is at disposal a feasible solutionx∈X(Pt). This may occur due to the structure of the solved problem, e.g. for the FSD portfolio efficiency tests (see Section 4.2) where there is a particularx∈X(Pt)∀t. Feasibility of x∗(1) for the unperturbed problem is another possibility. Even though the existence of such feasible direction can be proved under various assumptions, it is not easy in general to construct it. A direct search forxˆ∈Xwhich satisfies constraintsGj(x,0)⩽0∀jandGj(x,1)⩽0∀jis manageable, namely, whenQ=δρ∗is a degenerated probability distribution. Using it means to augmentXby deterministic constraints gh(x,ρ∗)⩽0, h∈Hj, j=1,…,J. Moreover, for problems with one joint probabilistic constraint one may solveminx∈XG1(x,1)subject toG1(x,0)⩽0.Assume that the covariance matrix Σ in (1) is a positive definite matrix, the setXa nonempty convex polyhedron with nondegenerated vertices, λ⩾0 a chosen parameter. Under these assumptions, there is a unique optimal solution x∗(μ,Σ;λ) of (1).To stress the parameter values in the Markowitz model we shall exploit the contamination technique with the local upper bound obtained according to Theorem 1. The application of its basic form to (1) is straightforward, with a selected parameter perturbationμt=(1-t)μ+tμˆ,Σt=(1-t)Σ+tΣ^to be tested for 0⩽t⩽1. The basic approach extends also to (2) or (3) when a known expected return μ or a fixed covariance matrix Σ are assumed.To stress separately correlations one can exploit the suggestion of Kupiec (2002): The covariance matrix can be written as Σ=DCD with the diagonal matrix D of “volatilities” (standard deviations of the marginal distributions) and the correlation matrix C.Changes in the covariances may be then modeled by “stressing” the correlation matrix C by a positive semidefinite stress correlation matrixC^(23)C(γ)=(1-γ)C+γC^with parameter γ∈[0,1]. This type of perturbation of the initial quadratic program allows us again to apply the related parametric stability results to the perturbed problem (2)(24)minx∈Xx⊤DC(γ)Dx,γ∈[0,1]with the constraint μ⊤x⩾k incorporated into the definition ofX.Under the above assumptions, the optimal value φ(γ) of (24) is concave and continuous in γ∈[0,1]. The directional derivative is of the form (15)φ′(0+)=x∗(0)⊤DC^Dx∗(0)-φ(0)and contamination bounds (14) have the form(1-γ)x∗(0)⊤DCDx∗(0)+γx∗(1)⊤DCˆDx∗(1)⩽minx∈Xx⊤DC(γ)Dx⩽(1-γ)x∗(0)⊤DCDx∗(0)+γx∗(0)⊤DC^Dx∗(0).They quantify the effect of the considered change in the input data on the optimal value φ(γ) of portfolio. See Dupačová and Polívka (2007) for additional results. In a similar way, one can quantify the influence of stressing parameters μ, C or μ, Σ in (1).Example 1For a numerical illustration consider a standard set of ten active benchmark stock portfolios that are formed, and annually rebalanced, based on individual stocks’ market capitalization of equity, each representing a decile of the cross-section of stocks in a given year. Furthermore, we use the one-month US Treasury bill as a riskless asset. Historical data on monthly value-weighted returns (month-end to month-end) from May 2005 to August 2008 obtained from Kenneth French’ data library serve as the original discrete distribution P taking all S=40 scenarios with the same probabilities. The alternative distribution Q is given by 40 equiprobable scenarios from the crises period (September 2008–December 2011). We will apply the contamination bounds (22) and (19) to Markowitz problem (3) rewritten in the minimizing form:(25)minx∈X-μ⊤xsubject tox⊤Σx⩽vwhere short sales are not allowed, that is,X=x∈RN:∑nxn=1,xn⩾0,n=1,2,…,N. Parameters μ and Σ are estimated from the data for May 2005–August 2008 and v=0.001. Let us contamine μ and the covariance matrix Σ (instead of the correlation matrix C considered in the theoretical part of this section) byμˆandΣ^estimated from the crisis period data. The global lower bound (22) can be easily calculated solving the four optimization problems. The construction of upper bound (19) exploits (20) and it is generally valid only for sufficiently small t; however, in this Markowitz model the upper bound holds true for all t∈[0,1], see Fig. 1.The situation changes substantially when Value at Risk (7) is used in (25) instead of x⊤Σx.Let us consider the same assets and distributions of returns as in Example 1 but use a different risk measure-Value at Risk (7). Again, we formulate a minimizing expected loss problem:(26)minx∈X-μ⊤xsubject toVaRα(-ρ⊤x)⩽vfor v=0.02. Using the “big M” idea (12) and (13) it turns to the following mixed integer program:(27)minx∈X-μ⊤xsubject to-ρs⊤x-Mszs⩽v,s=1,…,S∑spszs⩽1-α,zs∈{0,1},s=1,…,Swhere ps=0.025 and the coefficients Msare sufficiently large numbers for all s. The contaminated distribution of ρ is carried now by the 80 scenarios, hence (27) gets extended for additional scenarios. First we choose α=0.97 and Fig. 2shows that the minimal mean loss is not continuous and it coincides with lower bound (22) for t⩽0.028. Moreover, x∗(t)=x∗(0) is the optimal solution for t⩽0.028 what allows us to construct a trivial local upper bound-μt⊤x∗(0). It coincides with the minimal mean loss for t⩽0.028, however, it is no more valid for t>0.028.Finally, we consider α=0.95; now, one of cumulative probabilities is equal to α. Contrary to the previous case, the minimal mean loss is not right continuous in 0, see Fig. 3. This is due to the fact that the strict complementarity condition in the unperturbed problem is not fulfilled and x∗(0) is not a feasible solution for any contaminated problem. Therefore, in this case, the local upper bound (19) is not applicable.In this section, we shall study robustness of portfolio efficiency tests with respect to the first order stochastic dominance relation. Consider N assets and a random vector of their returns ϱ. A decision maker may combine assets into portfolios and all portfolio possibilities are given byX=x∈RN:∑nxn=1,xn⩾0,n=1,2,…,N.LetFϱ⊤x(y)denote the cumulative probability distribution function of returns of portfolio x. In the context of FSD portfolio efficiency, following Kopa and Post (2009); Kuosmanen (2004) and contrary to Definition 1, we define the first order stochastic dominance relation between portfolios in the strict form.Definition 2Portfoliox∈Xdominates portfolioτ∈Xby the first order stochastic dominance (ϱ⊤x≻FSDϱ⊤τ) if and only ifFϱ⊤x(y)⩽Fϱ⊤τ(y)∀y∈Rwith strict inequality for at least oney∈R.Alternatively, ϱ⊤x≻FSDϱ⊤τ iff(28)Hϱ(x,τ)≔maxy∈R(Fϱ⊤x(y)-Fϱ⊤τ(y))⩽0(29)hϱ(x,τ)≔miny∈R(Fϱ⊤x(y)-Fϱ⊤τ(y))<0.Definition 3A given portfolioτ∈Xis FSD inefficient if there exists portfoliox∈Xsuch that ϱ⊤x≻FSDϱ⊤τ. Otherwise, portfolio τ is FSD efficient.This definition classifies portfolioτ∈Xas FSD efficient if and only if no other portfolio is better (in the sense of the FSD relation) for all non-satiated decision makers. Following Kuosmanen (2004), Definition 3 formulates FSD efficiency in the sense of ”FSD admissibility”. Another definition of FSD efficiency, called “FSD optimality”, was introduced in Kopa and Post (2009). Alternatively, one may also employ a notion of almost stochastic dominance, cf. Levy (2009) and Lizyayev and Ruszczyński (2012). In this paper we focus on efficiency approach based on Definition 3.In order to find a FSD dominating portfolio x, using (28) and (29), we may solve the following problem:(30)ξϱ(τ)=minxhϱ(x,τ)s.t.Hϱ(x,τ)⩽0x∈X.Theorem 3A given portfolio τ is FSD efficient if and only if ξϱ(τ)=0. If ξϱ(τ)<0 then the optimal portfolio x∗of(30)dominates portfolio τ by FSD.If ξϱ(τ)=0 then no FSD dominating portfolio exists. On the other hand, if ξϱ(τ)<0 than the optimal solution x∗ of (30) FSD dominates τ.□Since all existing portfolio efficiency tests have been derived for a discrete probability distribution P of returns we assume that ϱ takes S valuesrs=r1s,r2s,…,rNs, called scenarios, with probabilities p1,p2,…,pS. Contrary to the former tests, cf. Kopa and Post (2009) and Kuosmanen (2004), we do not assume equiprobable scenarios. Again, the scenarios are collected in the matrixR=r1r2⋮rS.For any portfoliox∈X, let (−Rx)[k] be the kth smallest element of (−Rx), i.e. (−R x)[1]⩽(−Rx)[2]⩽⋯⩽(−Rx)[S] and let I(x) be a permutation of the index set {1,2,…,S} such that for all i(x)∈I(x): −ri(x)x=(−Rx)[i]. Accordingly, we can order the corresponding probabilities and we denotepix=pi(x). Hence,pix=P(-ϱx=(-Rx)[i]). Moreover, we consider cumulative probabilities:qsx=∑i=1spixand defineq0x=0. The same notation is applied for the tested portfolio τ=(τ1,τ2,…,τN)⊤.As in Ogryczak and Ruszczyński (2002), we express the FSD relation using Value at Risk (VaR) that is defined forα∈qs-1x,qsx,s=1,…,Sas:(31)VaRα(-ϱ⊤x)=(-Rx)[s].Lemma 2Letx,τ∈X. Then ϱ⊤x≻FSDϱ⊤τ if and only if(32)VaRα(-ϱ⊤x)⩽VaRα(-ϱ⊤τ)forallα∈(0,1]with a strict inequality for at least one α.Since we limit our attention to a discrete probability distribution of returns, the inequality between VaRs need not be verified in allα∈(0,1], but only in at most S particular points.Theorem 4A portfolio x dominates portfolio τ with respect to FSD (ϱ⊤x≻FSDϱ⊤τ) if and only ifVaRqsτ(-ϱ⊤x)⩽VaRqsτ(-ϱ⊤τ)for all s=1,2,…,S with a strict inequality for at least oneqsτ.Functions VaRα(−ϱ⊤x) and VaRα(−ϱ⊤τ) are piece-wise constant in α with jumps inα=qsx, respectively inα=qsτ,s=1,2,…,S, see (31). Therefore Lemma 2 directly implies the theorem.□Inspired by Dupačová and Kopa (2012) we consider the following measure:(33)ξ(τ,R,p)=minbs,x∑s=1Sbss.t.VaRqsτ(-ϱ⊤x)-VaRqsτ(-ϱ⊤τ)⩽bs,s=1,…,Sbs⩽0,s=1,…,Sx∈X.The objective function of (33) represents the sum of differences between VaRs of a portfolio x and VaRs of the tested portfolio τ. The differences are considered in pointsqsτ,s=1,…,S. According to Theorem 4, the other points need not be taken into account. All differences must be non-positive and at least one negative to guarantee that portfolio x dominates portfolio τ. Moreover, minimizing these differences, we find portfolio x∗ that cannot be dominated by any other one. On the other hand, if no dominating portfolio exists, that is, portfolio τ is FSD efficient, then ξ(τ, R, p)=0 because the only feasible solutions of (33) are τ and portfoliosx¯satisfyingRx¯=Rτ. Summarizing, Theorems 3 and 4 imply the following necessary and sufficient FSD portfolio efficiency test:Theorem 5A given portfolio τ is FSD efficient if and only if ξ(τ,R,p)=0. If ξ(τ,R,p)<0 then the optimal portfolio x∗in(33)is FSD efficient and it dominates portfolio τ by FSD.Consider a contamination of the original distribution of returns by an additional scenarior̃=(r̃1,…,r̃N):ϱ(t)=(1-t)ϱ+tδr̃,t∈[0,1]. Similarly to (30) we examine the problem(34)ξϱ(t)(τ)=minxhϱ(t)(x,τ)s.t.Hϱ(t)(x,τ)⩽0x∈XwhereHϱ(t)(x,τ)=maxy∈R(Fϱ(t)⊤x(y)-Fϱ(t)⊤τ(y))hϱ(t)(x,τ)=miny∈R(Fϱ(t)⊤x(y)-Fϱ(t)⊤τ(y)).Definition 4A given portfolioτ∈Xis directionally FSD inefficient with respect to an additional scenarior̃if for each t there exists x(t) such that ϱ(t)⊤x(t)≻FSDϱ(t)⊤τ. Moreover, a given portfolioτ∈Xis directionally FSD efficient with respect to an additional scenarior̃if ϱ(t)⊤x≻FSDϱ(t)⊤τ does not hold for anyx∈Xand any t∈[0,1].The definition classifies portfolio τ as directionally FSD efficient (inefficient) with respect to additional scenarior̃if τ is FSD efficient (inefficient) when using the original distribution P as well as in any contaminated case Pt. FSD efficiency of portfolio τ for distribution Q is equivalent tor̃x⩽r̃τ∀x∈X.Using (34), portfolioτ∈Xis directionally FSD efficient with respect to additional scenarior̃if and only ifmint∈[0,1]ξϱ(t)(τ)=0.If Hϱ(t)(x,τ) is concave in t then ξϱ(t)(τ) is quasiconcave in t and the lower bound is:(35)ξϱ(t)(τ)⩾(1-t)min{ξϱ(0)(τ),minx∈X,Hϱ(1)(x,τ)⩽0hϱ(0)(x,τ)}+tmin{ξϱ(1)(τ),minx∈X,Hϱ(0)(x,τ)⩽0hϱ(1)(x,τ)};see (22). As a consequence we can derive the following sufficient condition for directional FSD efficiency with respect to additional scenarior̃.Theorem 6Let Hϱ(t)(x,τ) be concave in t. If1.τ is FSD efficient with respect to the original distribution of returnsthere is no portfolio x≠τ having the same original distribution of returns as τr̃τ>r̃xfor all x≠τSince τ is FSD efficient for the original distribution of ρ, Theorem 3 implies ξϱ(0)(τ)=0. Combining it with Assumption 2,minx∈X,Hϱ(0)(x,τ)⩽0hϱ(1)(x,τ)=0because τ is the only feasible solution of the problem. Similarly, Assumption 3 implies the uniqueness of τ when using the alternative distributionQ=δr̃, henceξϱ(1)(τ)=0andminx∈X,Hϱ(1)(x,τ)⩽0hϱ(0)(x,τ)=0.Since ξϱ(t)(τ) cannot be strictly positive, applying lower bound (35), we get ξϱ(t)(τ)=0 for all t∈[0,1] and the rest of the proof directly follows from Theorem 3 applied for all contaminated problems and from Definition 4.□Similarly, portfolioτ∈Xis directionally FSD inefficient with respect to additional scenarior̃if and only ifmaxt∈[0,1]ξϱ(t)(τ)<0.To compute maxt∈[0,1]ξϱ(t)(τ) one needs to solve a minimax problem what may be computationally very demanding or even impossible. Therefore the following sufficient condition can be very useful in empirical testing. It applies the trivial global upper bound for (34) under assumption that some portfolio x is a feasible solution for all contaminated problems (34).Theorem 7If there existsx∈Xsuch that ϱ⊤x≻FSDϱ⊤τ andr̃x⩾r̃τthen τ is directionally FSD inefficient with respect tor̃.SinceFϱ(t)⊤x(y)is linear in t for allx∈X,(Fϱ(t)⊤x(y)-Fϱ(t)⊤τ(y))is linear in t and Hϱ(t)(x,τ) is convex in t, that is,Hϱ(t)(x,τ)⩽(1-t)Hϱ(x,τ)+tHr̃(x,τ)for all t∈[0,1]. Since ϱ⊤x≻FSDϱ⊤τ andr̃x⩾r̃τwe have Hϱ(x,τ)⩽0 andHr̃(x,τ)⩽0, and therefore, Hϱ(t)(x,τ)⩽0. Hence ϱ(t)⊤x≻FSDϱ(t)⊤τ for all t∈[0,1] and τ is directionally FSD inefficient with respect tor̃what completes the proof.□Note that the required portfolio x can be easily found as a solution of (30) with the additional constraint:r̃x⩾r̃τ.Assume that the probability distributionP‾of random returnsϱ¯takes again values rs, s=1,2,…,S but with other probabilitiesp¯=(p¯1,p¯2,…,p¯S). We define the distance between P andP‾asd(P‾,P)=maxi|p¯i-pi|.Definition 5A given portfolioτ∈Xis ∊-FSD inefficient if there exists portfoliox∈XandP‾such thatd(P‾,P)⩽∊withϱ¯⊤x≻FSDϱ¯⊤τ. Otherwise, portfolio τ is ∊-FSD efficient.The introduced ∊-FSD efficiency is a robustification of the former FSD portfolio efficiency. It guarantees stability of the FSD efficiency classification with respect to small changes (prescribed by parameter ∊) in probability vector p. A given portfolio τ is ∊-FSD efficient if and only if no portfolio x FSD dominates τ neither for the original probabilities p nor for arbitrary probabilitiesp¯from the ∊-neighborhood of the original vector p. For testing ∊-FSD efficiency of a given portfolio τ we modify (33) to a new measure of ∊-FSD efficiency:(36)ξ∊(τ,R,p)=minbs,x,p¯,q¯∑s=1Sbss.t.VaRq¯sτ(-ϱ⊤x)-VaRq¯sτ(-ϱ⊤τ)⩽bs,s=1,…,Sq¯sτ=∑i=1sp¯iτ,s=1,…,S∑i=1Sp¯i=1-∊⩽p¯i-pi⩽∊,i=1,2,…,Sp¯i⩾0,i=1,2,…,Sbs⩽0,s=1,…,Sx∈X.Theorem 8Portfolioτ∈Xis ∊-FSD efficient if and only if ξ∊(τ,R,p) given by(36)is equal to zero.The proof directly follows from Theorem 5 because (36) is obtained from (33) by an additional minimization overp¯from ∊-neighborhood of the original probability vector p.□

@&#CONCLUSIONS@&#
To analyze the influence of perturbed input data in portfolio optimization problems with risk constraints, the contamination technique was applied under relaxed assumptions. When constructing contamination bounds for the optimal value the form of the constraints plays an important role. For the Markowitz model, e.g. the set of feasible solutions of perturbed problems (2) or (3) depends on contamination parameter t. Still, convexity (and smoothness) of these problems allows us to construct both the lower contamination bound and a local upper contamination bound. In the case of general probabilistic risk constraints local lower bounds can be constructed under modest assumptions, however derivation of local upper bounds is rather involved. Several instances of such bounds are presented.For discrete distributions with non-equiprobable atoms, the obtained results are exploited to develop new robust FSD efficiency tests of a given portfolio with respect to an additional scenario or with respect to changes in scenario probabilities. Similarly as the already implemented simpler tests without robustness and with equal scenario probabilities in Kuosmanen (2004), our robust FSD efficiency tests are numerically demanding but they do not increase the computational complexity over the applicable mixed-integer programming procedures of Kuosmanen (2004).