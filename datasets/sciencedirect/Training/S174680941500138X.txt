@&#MAIN-TITLE@&#
Improved multiscale permutation entropy for biomedical signal analysis: Interpretation and application to electroencephalogram recordings

@&#HIGHLIGHTS@&#
Permutation entropy (PE) is a broadly used algorithm to measure the complexity of signals.Multiscale PE (MPE) is based on assessing the PE for a number of coarse-grained sequences representing temporal scales.To increase the stability and reliability of MPE, improved MPE (IMPE) is proposed.Several signal processing concepts are used to show the ability of IMPE.We also apply MPE and IMPE for real publicly available electroencephalogram (EEG) signals.

@&#KEYPHRASES@&#
Multiscale permutation entropy,Biomedical signal analysis,Electroencephalogram,Non-linear analysis,Signal regularity,Complexity,

@&#ABSTRACT@&#
Permutation entropy (PE) is a well-known and fast method extensively used in many physiological signal processing applications to measure the irregularity of time series. Multiscale PE (MPE) is based on assessing the PE for a number of coarse-grained sequences representing temporal scales. However, the stability of the conventional MPE may be compromised for short time series. Here, we propose an improved MPE (IMPE) to reduce the variability of entropy measures over long temporal scales, leading to more reliable and stable results. We gain insight into the dependency of MPE and IMPE on several straightforward signal processing concepts which appear in biomedical activity via a set of synthetic signals. We also apply these techniques to real biomedical signals via publicly available electroencephalogram (EEG) recordings acquired with eyes open and closed and to ictal and non-ictal intracranial EEGs. We conclude that IMPE improves the reliability of the entropy estimations in comparison with the traditional MPE and that it is a promising technique to characterize physiological changes affecting several temporal scales. We provide the source codes of IMPE and the synthetic data in the public domain.

@&#INTRODUCTION@&#
There are several main types of measures, such as, entropies and fractal dimensions, to compute the complexity of a system or signal. These are used to compare signals and distinguish or detect regular and random epochs [1]. As mentioned in [2], healthy subjects and people with disease can often be distinguished by the complexity of their physiological activity [3].Entropy is one of the most popular and powerful concepts to evaluate the dynamical characteristics of a signal. This metric measures the uncertainty and irregularity of a time series. Higher entropy generally demonstrates higher uncertainty, whereas lower entropy shows more regularity and certainty of a system [1,4]. There are a number of entropy approaches commonly applied to physiological recordings, such as approximate entropy (ApEn) [5], sample entropy (SaEn) (Richman and Moorman 2000), fuzzy entropy (FuEn) (Chen, Wang et al., 2007), permutation entropy (PE) [1] and wavelet entropy (Rosso, Blanco et al., 2001), each of which has its own advantages and disadvantages [6].PE is based on the order relations among values of a signal, the permutation patterns. It is analogous to the Lyapunov exponents for some well-known chaotic dynamical systems, such as the noise-free logistic map, although PE yields more meaningful results in the presence of observational and dynamical noise [1,7]. Compared with the other entropies, such as ApEn and FuEn, PE is theoretically simple and it has fewer parameters, it is relatively robust to artifacts and noise, and is computationally fast. Furthermore, the PE can be used for both the non-stationary and nonlinear signals. With respect to the signal length, PE is more robust than the zero-crossing rate (ZCR) [1]. Because of the aforementioned advantages, PE has been extensively employed in the numerous real world physiological signal and image processing applications [7,8]. For example, Li et al. investigated the behavior of PE to predict absence seizures in rats using EEG signals [9]. They showed that PE can track the dynamical changes of EEG recordings and that PE can predict absence seizures better than SaEn [9]. Ferlazzo et al. employed PE to reveal abnormalities of cerebral activity in patients with typical absences [10]. They concluded that PE is a valuable tool to detect abnormalities of cerebral electrical activity which are not revealed by conventional approaches for EEG signals [10].However, PE is limited to assessing the values of entropy for only one temporal scale, the one associated with the original sampling of the signals. This may limit the ability of PE to inspect dynamics residing at longer temporal scales. In this sense, multiscale entropy (MSE), proposed by Costa et al. [3,11], calculates entropy over a range of scales to evaluate the complexity of a time series. In the original definition of MSE, SaEn was the metric used to assess the entropy over the temporal scales [3,11]. Nonetheless, the concept of multiscale evaluation of entropy can be extended to other entropy metrics. Morabito et al. used multiscale PE (MPE) to assess the complexity of electroencephalogram (EEG) recordings in Alzheimer's disease [8].The multiscale evaluation of entropy has notorious advantages. First of all, it allows us to inspect dynamics along more than one temporal scale. This is very significant for biological systems which need to operate across multiple spatial and temporal scales, and therefore their complexity is also multiscaled [3,12]. Secondly, unlike SaEn, MSE is consistent with the Fogedby study [13] illustrating that the complexity of 1/f noise is higher than white Gaussian noise (WGN).The coarse-graining of MPE and MSE methods are based on Costa's algorithm [3,8,11]. The first step of MPE, the coarse-graining process, considerably reduces the time series length because, to inspect the deeper temporal scales, MPE uses a procedure similar to sub-sampling. This may yield an imprecise estimation of entropy when the time series is too short. Hence, the basic MPE method may not provide a reliable analysis for short time series. To overcome this problem, in this paper, an improved MPE (IMPE) is proposed. This is in contrast with the alternative MPE algorithm by [14] called modified MPE (MMPE). In the MMPE, a coarse-grained sequence is built subsampling the original signal by taking one out of τ samples, where τ denotes the temporal scale. However, no filtering is used. Therefore, this procedure will necessarily lead to aliasing, thus changing important properties of the signal. For example, for τ=3 and i=2, y(3)(2,j)={x2,x5,x8,...}, some important information of the original time series {x1,x2,...,xN} may be omitted in the MMPE.Because of the relevance and the possible usefulness of MPE and IMPE in a number of biomedical signal analyses, it is important to understand and exemplify the behavior of the measure for different kinds of classical signal concepts such as frequency, amplitude, noise power, and signal bandwidth. This study addressed this issue to help to illustrate the dependency of both MPE and IMPE on these concepts and to compare both techniques. Moreover, we will illustrate the application of MPE and IMPE to five different datasets of real EEG signals.In the following section, the concepts of PE and MPE are described. Our proposed method is explained in Section 3. In Section 4, the synthetic signals and real EEG datasets employed in this paper are introduced. Then, the results and discussions of the proposed method (IMPE) and the conventional MPE are explained in Sections 5 and 6, respectively. The conclusions of the paper are drawn in the last section.In this section, we briefly describe PE and MPE.Assume we have a given time series of length N, and let the time series be y={y1,y2,...,yN}. At each time t of y, a vector including the dth subsequent values is constructed as: Ytd,l={yt,yt+l,...yt+(d-2)l,yt+(d-1)l}for t=1,2,…,N−(d−1)l, where d, which is named the embedding dimension, determines how much information is contained in each vector and l is the time delay. To calculate the PE, the d values yiare associated with numbers from 1 to d and arranged in increasing order as{yt+(j1−1)l,yt+(j2−1)l,...,yt+(jd−1−1)l,yt+(jd−1)l}. For different samples, there will be d! potential ordinal patterns, π, which are named “motifs”. For each πt, p(πt) demonstrates the relative frequency as follows:(1)p(πid,l)=#{tt≤N−d,type(Ytd,l)=πid,l}N−d+1where #{} denotes the cardinality of the set (the number of elements) [1,7]. The PE is computed as follows:(2)H(y,d,l)=−∑πk=1πk=d!p(πk)lnp(πk)When all motifs have equal probability, the largest value of PE is obtained, which has a value of ln(d!). In contrast, if there is only one p(πk) different from zero, which illustrates a completely regular signal, the smallest value of PE is obtained as much as 0 [1,7].MPE, like MSE, includes two main steps. First, a “coarse-graining” process is applied to a time series. Consider a real-valued time series {x1,x2,...,xN} of length N. Multiple successive coarse-grained versions are made by averaging the time data points within non-overlapping windows of increasing length τ, which is called scale factor. A schematic illustration of the coarse-grained procedure is shown in Fig. 1. According to the following equation, each element of the coarse-grained time series yj(τ)is defined as:(3)yj(τ)=1τ∑i=(j−1)τ+1jτxi1≤j≤Nτwhereadenotes the largest integer not greater than a. The length of each coarse-grained time series isNτ. Second step is calculating the PE for each coarse-grained time series. The attained values can be plotted as a function of the scale factor τ[3,8,11].The conventional MPE has two main drawbacks. Firstly, the MPE is not symmetric. For example in scale 3, we could rationally expect the metric to behave the same for x3 and x4, in comparison with x2 and x3. However, at scale 3, x1, x2 and x3 are separated from x4, x5 and x6. The second drawback is the relative variability of the MPE results for long temporal scales. When the MPE is computed, in the coarse-graining process, the number of samples of the resulting coarse-grained sequence isNτ. When the scale factor τ is high, the number of samples in the coarse-grained sequence decreases. This may yield an unstable measure of entropy.To overcome these problems, the IMPE is proposed based on the idea originally reported by Wu for MSE [15]. Here, because of some advantages of PE over SaEn, we use PE instead. Hence, the IMPE is calculated in two main steps:1)In the first step,zi(τ)={yi,1(τ),yi,2(τ),...}are generated whereyi,j(τ)=∑f=0τ−1xf+i+τ(j−1)τAs can be observed in Fig. 2, in the IMPE algorithm, for each τ, we have τ different time serieszi(τ)|(i=1,...,τ), while in the MPE method, only Z1(τ)is considered.For a defined scale factor τ and embedding dimension d, PE of each ofzi(τ)|(i=1,...,τ)is separately calculated. Then, the average of PE values is computed as follows:Due to the key role of embedding dimension for the PE, an important issue is choosing the embedding dimension d. In order to work with reliable statistics, for calculating PE, it is highly recommended d!≪N or (d+1)!≤N[16,17]. In addition, when d is too large, the computation time will be higher. On the other hand, when d is high, the number of accessible states will be large, and the value of the PE will probably be more reliable. All in all, we should make a trade-off between the aforementioned cases. It is worth noting that, since the number of sample points for a coarse-grained sequence at level τ isNτ, we have the conditiond+1!≤Nτfor MPE or IMPE.To evaluate the IMPE and MPE, we will use both synthetic signals and real EEG data.In this subsection, the signals used to study the MPE and IMPE measures, and their interpretability in terms of classical signal processing concepts such as frequency, amplitude, noise power, and signal bandwidth are described. We also consider the performance of the entropy metrics on WGN and 1/f noise. All these synthetic signals, except WGN and 1/f noise, have a sampling frequency (fs) of 150Hz and a length of 100s. Therefore, they have 15,000 sample points. The time plots of these synthetic signals, and their corresponding spectrograms, and two zooms (for each kind of signal) on their start and end, to demonstrate the changes in their characteristics, appear in Fig. 3. Some of them have been employed to inspect the Lempel-Ziv complexity measure and auto-mutual information function rate of decrease and have been explained in (Aboy, Hornero et al., 2006) and [18] respectively.1) MPE and IMPE Versus Noise Signals: White Gaussian noise is a random signal which has equal energy across all frequencies. The name white originates from the fact that this kind of signal has a constant power spectral density S(f) as follows:(5)S(f)=Cwf0where Cwis a constant [19]. White can be regarded as a sequence of consecutively uncorrelated random variables with zero mean and finite variance [20].A stochastic process appropriate to model evolutionary or developmental systems characterized by equal energy per octave is called pink noise, whose power spectral density is as follows:(6)S(f)=Cffαwhere Cfis a constant and α can be changed between 0 and 2. As can be seen in Equation 6, the power spectrum density of pink noise is inversely proportional to frequency [19]. We expect pink noise to be more complex than WGN, due to the presence of long-range correlations in the data.2) MPE and IMPE Versus Frequency: In order to clarify how the MPE and IMPE change when the amplitude and frequency of sinusoidal signals are changed, two kinds of synthetic signals are created. The first one consists in a constant amplitude chirp signal whose frequency is swept logarithmically from 0.1Hz to 30Hz in 100s. The second kind of signal, whose frequency is swept logarithmically from 0.25Hz to 5Hz in 100s, was generated by modulating the amplitude of the chirp signal by a pure sinusoid. MPE and IMPE were applied to each of the two kinds of signals using a moving window of 6.667s with 80% overlap with the objective of testing if MPE and IMPE are sensitive to frequency or amplitude changes. Fig. 3(a) and (b) demonstrates the constant chirp signal and the amplitude modulated chirp, respectively.3) MPE and IMPE Versus Noise Power: In order to understand how the MPE and IMPE change with the level of noise affecting quasi-periodic signals, we created an amplitude-modulated quasi-periodic signal with additive WGN of diverse power. The signal was generated as an amplitude-modulated sum of two sine waves with frequencies at 0.5Hz and 1Hz. The first 20s of this sequence does not have any noise. After that, WGN was added to the signal, with the noise power increasing every 10s. Fig. 3(c) shows this time series.4) MPE and IMPE Versus Bandwidth of Colored Noise: In order to determine the relationship between MPE or IMPE and noise bandwidth, a synthetic signal consisted of a 100-s time series composed of the five segments of colored noise with increasing bandwidth is employed. The frequency spectra of the colored noises are all centered at fs/4 and their bandwidth increases from fs/15 to fs/3 in five equal steps. Fig. 3(d) depicts this signal.5) MPE and IMPE Versus Spectral Content of Colored Noise: In order to investigate the dependence between the MPE or IMPE and the spectral content of colored noise, an autoregressive (AR) process of order 1, AR(1), was generated varying the model parameter, ρ, linearly from +0.9 to −0.9. Its energy therefore moved from low to high frequencies. When ρ was equal to 0, the sequence corresponded to WGN, in the center of the synthetic signal. Fig. 3(e) depicts the corresponding spectrogram, time plot and zoom views.6) MPE and IMPE Versus Changes from being Non-deterministic to Deterministic: In order to inspect how the MPE and IMPE change when a stochastic sequence progressively turns into a periodic deterministic signal. For this end, we generated a MIX process employed by [5,18,21]. It is defined as follows:(7)MIX=(1−z)x+zywhere z denotes a random variable which equals 1 with probability p and equals 0 with probability 1−p, x shows a periodic time-series created byxk=2sin2πk/12and y is a uniformly distributed variable on−3,3[18,21]. The synthetic time-series was based on a MIX process whose parameter varied between 0.01 and 0.99 linearly. Therefore, this signal, depicted in Fig. 3(f), evolved from randomness to orderliness.The MPE and IMPE were applied to five groups (denoted A, B, C, D, and E) of real EEG signals to compare the ability of each method to account for different characteristics of the real biomedical data. These recordings belong to the EEG database made available online by Andrzejak et al. at the Department of Epileptology, University of Bonn [22]. Here, we only describe these signals briefly and the reader is referred to [22] for additional information. Each of the five datasets consists of 100 single-channel EEG segments of 23.6s recorded with fs=173.61Hz (4096 sample points).Subsets A and B include EEG signals recorded extracranially during the relaxed state of five healthy people with eyes closed and eyes open, respectively. The signals in sets A and B were acquired at surface electrodes placed according to the international 10–20 system.We also applied our methods to three subsets (C, D and E) of EEG data from five epileptic subjects, who had achieved full seizure control after a surgical procedure [22]. Therefore, the EEG signals were not acquired in the same way in healthy subjects and epileptic patients.Signals in set D were recorded from within the epileptogenic zone, whereas segments in set C were acquired from the hippocampal formation of the opposite brain hemisphere. Strip electrodes were implanted onto the lateral and basal regions of the neocortex. Both sets C and D included only activity measured during seizure-free intervals. Nonetheless, it might be possible that some epileptic abnormalities are still present in these recordings. In contrast, set E contains seizure activity throughout (i.e., all epochs in set E were recorded during ictal periods). All EEG recordings were prepared with the same 128-channel amplifier system, employing an average common reference. Electrodes with pathological activity (C, D, and E) or strong eye movement noise (A and B) were removed from the computation of the reference [22].Before computing the entropy of these signals, all recordings were digitally filtered employing an FIR band-pass filter with cut-off frequencies at 0.5Hz and 40Hz, a band typically used in the analyses of brain activity.

@&#CONCLUSIONS@&#
MPE is a powerful indicator of entropy for different types of signals, including nonlinear and non-stationary signals. To increase the stability of MPE, we have proposed the IMPE. Then, using synthetic signals, the MPE and IMPE results were investigated to better understand their behavior in terms of signal processing concepts such as frequency, amplitude, noise power, and signal bandwidth. The results showed that a signal with noise, larger bandwidth and/or higher frequency would generally lead to higher values of entropy. MPE and IMPE results were not sensitive to slow changes in amplitude. In the deeper scale factors, because of the filtering effect of the coarse-graining process, the MPE and IMPE tended to have lower values for the tested signals, except for constant and amplitude modulated chirp signals. Furthermore, the capabilities of MPE and IMPE to assess physiological complexity were assessed by analyzing publicly available EEG signals. The results derived from both synthetic and real EEG signals support the idea that IMPE has a better performance than MPE, although both are useful and informative tools to calculate the complexity of a time series.