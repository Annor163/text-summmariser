@&#MAIN-TITLE@&#
The general design of asymptotic unrestricted polar quantizers with square cells

@&#HIGHLIGHTS@&#
The design of asymptotic unrestricted polar quantizer with square cells was done.The design was done in general manner, i.e. for any compression function.The design was done for variable variance.Using μ-law companding function, robust polar quantizers were designed.Very good performances are achieved and proved by simulation.

@&#KEYPHRASES@&#
Unrestricted polar quantizer,Square cells,μ-law companding function,Gaussian source,Minimal moment of inertia,

@&#ABSTRACT@&#
The aim of this paper is the presentation of the designing of asymptotic unrestricted polar quantizers with square cells, since it is known that square cells give minimal moment of inertia, which leads to minimization of distortion. Until now, polar quantizers with square cells have been designed only for the optimal companding function and their performances have been analyzed only for the stationary variance. In this paper, the design is done in a general manner, i.e. it is valid for any companding function and performances are analyzed in the wide range of variances. After that, this general design is applied for the logarithmic μ-law companding function. It is important that expressions for the numbers of magnitude and phase levels are obtained in the closed form, which simplifies the design. It is shown that the proposed polar quantizer has better performances (more than 3 dB higher the maximal and the average SQNR (signal-to-quantization noise ratio)) than the corresponding scalar quantizer with μ-law. Simulation is performed, and it is shown that theoretical and simulation results are matched very well. It is shown that the proposed polar quantizer can be used both for stationary and non-stationary signals, choosing the appropriate value of μ. This quantizer can be widely used, for all signals with Gaussian distribution.

@&#INTRODUCTION@&#
Quantizers are one of the main parts of A/D (analog-to-digital) converters, but they can also be used for signal compression. Hence, quantizers are very important parts of modern systems and the design of quantizers is very topical. Quantizers are often designed for Gaussian source, since a lot of signals can be modeled with Gaussian distribution. Furthermore, quantizers designed for Gaussian distribution can be used for signals with other distributions, passing these signals through an appropriate filter [1].Vector quantizers have better performances than scalar quantizers, but on the other hand they are more complex and their complexity increases with increasing of dimension. Two-dimensional vector quantizers are much simpler compared to vector quantizers with higher dimensions, but they still have better performances than scalar quantizers, therefore they are very used in practice. For two-dimensional circularly symmetric sources (such as two-dimensional memoryless Gaussian source) it is much easier to design two-dimensional vector quantizers in polar coordinates (r-magnitude, ϕ-phase) than in Cartesian coordinates. Such two-dimensional vector quantizers, designed in polar coordinates, are called polar quantizers. The magnitude r is usually quantized using the companding technique with some companding functiong(r). Polar quantizers can be restricted (also called product, where the numbers of phase levels are the same for all magnitude levels) and unrestricted (where the number of phase levels is optimized for each magnitude level).Polar quantization has been considered in many papers. Papers [2–4] consider the unrestricted polar quantization with the optimal companding function. The uniform polar quantization is considered in [5,6]. Paper [7] considers product polar quantization with a companding function which is optimal for scalar but not for polar quantization. In [8], embedded product and unrestricted polar quantizers are considered. For the polar quantizer from [9], numbers of magnitude and phase levels are found by trying all possible combinations in a brute force manner, which is exhausting and it does not provide optimal solution for higher bit-rates. In [10] the polar quantizer is designed using an iterative algorithm, which can be computationally complex for higher bit-rates. In all these papers [2–10], polar quantizers are designed for the stationary variance, i.e. without the analysis of robustness. In [11], an n-dimensional vector quantizer is considered, but for Laplacian PDF. Product polar quantizer with A-law, considering high values of A, was designed in [12], for audio signals, but without exact definition of distortion and without optimization of quantizerʼs parameters. In [13], product polar quantization with μ-law was considered, but also without optimization of parameters of the quantizer.In this paper, the design of the asymptotic unrestricted polar quantizers for the two-dimensional memoryless Gaussian source is done, applying the principle of square cells, since it was proved in [2] that square cells have the minimal moment of inertia of all rectangular cells, which is important for the minimization of distortion, since the moment of inertia is used in Bennettʼs integral for vector quantizers [14]. Until now, the principle of square cells was exploited only for the design of polar quantizers with optimal companding function for stationary variance [2,4,15]. In this paper, the design of polar quantizers with square cells is done in a general manner, i.e. for any companding functiong(r)and for variable variance. After that, this general theory is applied for the design of the unrestricted polar quantizer with μ-law companding function, which has the following advantages compared to the optimal companding function: expressions for thresholds and representation levels are obtained in the closed form, while for the optimal companding function it is necessary to solve integral equations [16,17]; furthermore, the optimal companding function has very poor robustness and it is suitable only for stationary signals (with constant variances) but not for non-stationary signals (whose variances change in time), while μ-law companding function is much more flexible, since it depends on the parameter μ and choosing the appropriate value of μ the quantizer can be adjusted to different types of signals. It is shown in this paper that small values of μ should be used for stationary signals, while high values of μ should be used for non-stationary signals since quantizer becomes very robust. Another important result from this paper is that expressions for numbers of magnitude and phase levels and for distortion are obtained in the closed form, which significantly simplifies the design of quantizer. The analysis of performances of the quantizer is done in the wide range of variances, for different values of the parameter μ. The asymptotic analysis [2–5,11–14] of the polar quantizer is applied; therefore this model should be used for medium and high bit-rates. The optimization of the parameter μ is done, to achieve the maximal SQNR. Simulation is done and it is shown that theoretical and simulation results are matched very well, which proves the developed theory. It is shown that the unrestricted polar quantizer has better performances than the corresponding scalar quantizer: higher the maximal SQNR for 3.34 dB and higher the average SQNR in the wide range of variances for 3.63 dB. Also, it was shown that our μ-law polar quantizer is much more robust than the optimal and the uniform polar quantizers.This paper is organized as follows. In Section 2, the unrestricted polar quantizer with square cells is designed in a general manner, i.e. for any companding function. In Section 3, the design of the unrestricted polar quantizer for μ-law is presented, its performances are analyzed and numerical results obtained by theory and by simulation are presented. Section 4 concludes the paper.Letʼs consider the two-dimensional memoryless Gaussian source, which is defined with the probability density function (PDF) in Cartesian coordinatesf(x,y,σ)=12πσ2exp(−x2+y22σ2). Polar coordinates are defined asr=x2+y2andϕ=arctanyx, where r is called magnitude and ϕ is called phase. In polar coordinates, PDF for this Gaussian source becomes(1)f(r,ϕ,σ)=r2πσ2exp(−r22σ2),whereσ2is the variance (i.e. power) of the Gaussian source. PDFs of r and ϕ coordinates arefr(r,σ)=∫02πf(r,ϕ,σ)dϕ=rσ2exp(−r22σ2)which is Rayleigh distribution andfϕ(ϕ,σ)=∫0∞f(r,ϕ,σ)dr=12πwhich is uniform distribution. Since the phase has the uniform distribution, this source is circularly-symmetric. Contours wheref(r,ϕ,σ)is constant are concentric circles. According to the geometric principle for the design of quantizers [15], cells of quantizer should be placed on contours where PDF is constant, while distances between contours are inversely proportional to the value of PDF. Therefore, two-dimensional quantizer can be easily designed in the polar coordinates, putting cells on concentric magnitude rings.Magnitude r is quantized using the companding technique with companding functiong(r), while phase ϕ is quantized using the uniform quantization, since it has uniform PDF. Letʼs N denotes the total number of cells of the quantizer; L denotes the number of the magnitude levels;Mi,i=1,…,L, denotes the number of phase levels on the ith magnitude level;rmaxdenotes the maximal magnitude of the quantizer;ri,i=0,…,L, denote thresholds andmi,i=1,…,L, denote representation levels for the quantization of magnituder;ϕi,j=j2π/Mi,j=0,…,Mi, denote thresholds andψi,j=(j−1/2)2π/Mi,j=1,…,Midenote representation levels for the quantization of phase ϕ on the ith magnitude level. It holds that(2)∑i=1LMi=N.Cells of the polar quantizer are defined asSi,j={(r,ϕ)|ri−1⩽r<ri,ϕi,j−1⩽ϕ<ϕi,j}, and within each cellSi,jthere is one representation point(mi,ψi,j). Therefore we can define the polar quantization Q as a mappingQ:R2→R2,Q[(r,ϕ)]=(mi,ψi,j),∀(r,ϕ)∈Si,j.Our aim is to design the unrestricted polar quantizer with square cells in general way, i.e. for any companding functiong(r), and to analyze its performances in the wide range of input variances, i.e. for a variable varianceσ2. Letʼs defineΔr(i)as the radial width andΔϕ(i)as the angular width of cells on the ith magnitude level. If we introduce the parameterΔ=rmax/L, for the asymptotic analysis it holds thatg′(mi)=ΔΔr(i)=rmaxLΔr(i)[16]. ParametersΔr(i)andΔϕ(i)can be defined as:(3)Δr(i)=rmaxg′(mi)L;Δϕ(i)=2πmiMi.In [2], it was proved that square cells have minimal moment of inertia of all rectangular cells, which leads to the minimization of the distortion. Therefore, this principle of square cells will be applied in this paper for the design of polar quantizers. This principle denotes the fact that cells have nearly square shape [2], which means that the radial widthΔr(i)and the angular widthΔϕ(i)of cells on the ith magnitude level are equal (see Fig. 1), which is defined with equation(4)Δr(i)=Δϕ(i),i=1,…,L.It is clear that numbers of magnitude and phase levels (L andMi) have to be integers. But, in the process of the theoretical analysis, we can allow that numbers of magnitude and phase levels can be real numbers, denoted withL˜andM˜i. This approach is usual in the asymptotic analysis [4,6]. We use this approach since we want to obtain the final expressions in the closed form.Using (3) and (4), it is obtained that(5)M˜i=2πmig′(mi)Lrmax.Putting (5) into (2), multiplying and dividing byΔr(i), using (3) forΔr(i)in the denominator and changing summation with integration (∑→∫,mi→r,Δr(i)→dr) [4], it follows that(6)∑i=1LM˜i=2πLrmax∑i=1Lmig′(mi)Δr(i)Δr(i)=2πL2rmax2∑i=1Lmi(g′(mi))2Δr(i)=2πL2rmax2∫0rmaxr(g′(r))2dr=N.From (6) it is obtained that(7)L˜=rmaxN2π∫0rmaxr(g′(r))2dr.In (5) and (6) we use L (notL˜) since until (7) we do not know that this parameter takes a real value. Changing (7) into (5), it is obtained that(8)M˜i=mig′(mi)2πN∫0rmaxr(g′(r))2dr.For practical realization, we have to use integer valueL=[L˜], where [x] denotes the nearest integer to the real number x. Also, we have to calculate integer values for the numbers of phase levelsMi=[M˜i],i=1,…,L. If∑i=1LMi=Nthen calculated values of parametersMiare final values which will be used in the practical realization. However, due to the rounding ofL˜andM˜i, it is possible that∑i=1LMiis very close but not equal to N. In this case (when∑i=1LMi≠N) we have to slightly modify values of parametersMi,i=1,…,L, to satisfy the condition∑i=1LMi=N. We defineK=|∑i=1LMi−N|. If∑i=1LMi>Nthen K of L parametersMishould be decreased by 1, while if∑i=1LMi<Nthen K of L parametersMishould be increased by 1. Selection of K parametersMithat will be modified (decreased or increased by 1) should be done with the aim to make the minimal rounding error. This process of modification ofMiparameters is described with the following algorithm.Algorithm 11:Mi=[M˜i],i=1,…,L;K=|∑i=1LMi−N|;if∑i=1LMi>Nthenai=M˜i−(Mi−1),i=1,…,L; /⁎aidenotes the rounding error ofM˜iifMiwill decrease by 1 ⁎/Letʼsp1,p2,…,pKdenote indexes of K the smallest errorsai,i=1,…,L;Mpj=Mpj−1,j=1,…,K; /⁎ We decrease (by 1) K parametersMiwhose decreasing by 1 causes the smallest error ⁎/endif;if∑i=1LMi<Nthenbi=(Mi+1)−M˜i,i=1,…,L; /⁎bidenotes the rounding error ofM˜iifMiwill increase by 1 ⁎/Letʼsp1,p2,…,pKdenote indexes of K the smallest errorsbi,i=1,…,L;Mpj=Mpj+1,j=1,…,K; /⁎ We increase (by 1) K parametersMiwhose increasing by 1 causes the smallest error ⁎/endif;Text between /⁎ and ⁎/ denotes comments and explanations. Algorithm 1 represents one method for the rounding ofM˜ito integer values, with the aim of minimization of the rounding error. Other methods are also possible. However, it should be mentioned that rounding ofM˜ito integer values has negligible impact on the performances.According to [4], the granular distortion (in the arear⩽rmax) is defined as:(9)Dg(σ)=12∑i=1Lfr(mi,σ)(rmax212(g′(mi))2L2+π2mi23Mi2)Δr(i).Based on (3) it is obtained that(10)Dg(σ)=12∑i=1Lfr(mi,σ)12((Δr(i))2+(Δϕ(i))2)Δr(i).Based on (4), it follows thatDg(σ)=112∑i=1Lfr(mi,σ)(Δr(i))2Δr(i). Using (3), it is obtained thatDg(σ)=rmax212L2∑i=1Lfr(mi,σ)(g′(mi))2Δr(i). Changing summation with integration, it follows that(11)Dg(σ)=rmax212L2∫0rmaxfr(r,σ)(g′(r))2dr.According to [13], the overload distortion is defined as:(12)Dov(σ)=12∫rmax∞[(r−rmax)2+rrmaxπ23ML2]fr(r,σ)dr=12[X(σ)+rmaxπ23ML2Y(σ)],where(13)X(σ)=∫rmax∞(r−rmax)2fr(r,σ)dr=σ(2σe−rmax22σ2−2πrmaxErfc(rmax2σ)),(14)Y(σ)=∫rmax∞rfr(r,σ)dr=e−rmax22σ2rmax+π2σErfc(rmax2σ).The total distortion isD(σ)=Dg(σ)+Dov(σ), whereDg(σ)is given with (11) andDov(σ)is given with (12). SQNR is defined as:(15)SQNR(σ)=10log10σ2D(σ)[dB].The design of quantizers is always done for some referent varianceσ02. This means that the parameter of quantizerrmaxhave to be calculated forσ02, by minimization of the total distortionD(σ0), i.e., by solving the equationdD(σ0)drmax=0. This value ofrmaxis used for any other varianceσ2.These quantizers are designed for uncorrelated signals, but they can be also applied for correlated signals, putting them into DPCM loop [12,16]. In this way, the correlation of the signal is exploited, increasing SQNR of the product polar quantizer by the prediction gain of the linear predictor.The previous theory is general since it was developed for any companding functiong(r). Now, this theory will be applied for the design of the unrestricted polar quantizer with logarithmic μ-law companding function, which is defined as:(16)g(r)=rmaxln(μ+1)ln(1+μrrmax),whereμ>0is a parameter. Thresholds and representation levels for the magnitude r are defined with the following expressions:(17)ri=rmaxμ((μ+1)i/L−1),(18)mi=rmaxμ((μ+1)(i−12)/L−1).We can see that thresholds and representation levels are given in the closed form, i.e. there is no need to solve integral equation which is the case for the optimal companding function. Therefore, the realization of the quantizer is simplified. Expressions (7) and (8) for the numbers of magnitude and phase levels become:(19)L˜=ln(μ+1)(N2π)1/2(−1+11+μ+ln(μ+1))−1/2;(20)M˜i=mirmaxμ2πN(1+μmirmax)(−1+11+μ+ln(μ+1))−1/2.It is very important that expressions forL˜andM˜iare obtained in the closed form, which significantly simplifies the design of quantizer. For practical realization we should use integer valuesL=[L˜]andMiobtained using Algorithm 1.If conditionμmi/rmax≫1is satisfied (it is valid for high i, i.e. for higher number of levels), then expression (20) becomes(21)M˜i≡M˜=2πN(−1+11+μ+ln(μ+1))−1/2.We can see thatM˜i(and thereforeMi) becomes constant, i.e. it does not depend on i. Conditionμmi/rmax≫1can be written more specifically asμmi/rmax>k, where k is some positive number. Based on (18) and (19), it is obtained thatμmi/rmax>kis equivalent toi>t≡⌊0.5+ln(k+1)N1/2(2π(−1+11+μ+ln(μ+1)))−1/2⌋, where⌊x⌋denotes the nearest integer less than or equal to x. Therefore, it can be considered that for magnitude levelsi>t, the number of phase levels is constant, which simplifies the realization of the quantizer, since instead of calculating and storing in the memory all valuesMi,i=t+1,…,L, it is enough to calculate and store in memory only one valueMt+1. It is obvious that t is inversely proportional to μ. For example, forN=1282,μ=255andk=10, it is obtained thatL=120andt=53, which means that for more than a half magnitude levels the number of phase levels can be considered as a constant.Based on (11), the granular distortion becomes:(22)Dg(σ)=ln2(μ+1)12L2∫0rmaxfr(r,σ)r2(1+rmaxμr)2dr=ln2(μ+1)12μ2L2[rmax2+2μ2σ2−e−rmax22σ2(2μ2σ2+rmax2(1+μ)2)+2πrmaxμσErf(rmax2σ)].Based on (12), and using the approximationmL≈rmax, which is valid for the asymptotic analysis, the following expression for the overload distortion is obtained:(23)Dov(σ)=12[X(σ)+rmaxπ2(1+μ)26Nμ2(−1+11+μ+ln(μ+1))Y(σ)].According to (13) and (14), it follows thatX(σ)andY(σ)can be expressed usingErfc(⋅)function. Since functionsErf(⋅)andErfc(⋅)can be approximated in the closed form with very high accuracy [18], it follows thatDg(σ)andDov(σ)can be expressed in the closed form, which simplifies the design.Now, short algorithm for the designing of the final quantizer will be presented. Input data:N, μ,σ0, k (values of these parameters should be defined in advance). Quantizer is designed for the referent varianceσ02, therefore during the design process it will be considered thatσ=σ0. Algorithm 2 consists of the following steps:Algorithm 21.L is calculated using (19) and rounded to the nearest integer value.Calculation ofrmax. Putting value of L into (22) and (23), we can see that the total distortionD=Dg+Dovis the function of one unknown variablermax, i.e.D≡D(rmax). Optimal value ofrmaxis found by numerical minimization of D, i.e. by solving the equationdD(rmax)drmax=0.riandmiare calculated using (17) and (18).ValuesMi,i=1,…,L, are calculated using (20) and applying Algorithm 1.Fori=1,…,Lcalculateϕi,j=j2π/Mi,j=0,…,Mi, andψi,j=(j−1/2)2π/Mi,j=1,…,Mi.To simplify the design, Step 4 should be replaced with the following step:4a.Calculate t. CalculateMi,i=1,…,t+1, using (20) and applying Algorithm 1. Fort+1<i⩽Lit holds thatMi=Mt+1.Calculating all these parameters, the designing is finished.Numerical results for the unrestricted polar quantizer, obtained using the developed theory, are shown in Table 1, for different values of μ and N. Maximal value of SQNR is always achieved for the reference varianceσ02, and therefore this maximal value will be denoted asSQNRσ0. The optimization of μ is done, in the way to achieve maximal value ofSQNRσ0. The value of μ that gives maximalSQNRσ0(denoted asμopt) is calculated by numerical optimization ofSQNR(σ0)defined with (15). Values ofμoptare different for different values of N, and they are also presented in Table 1.Simulation in MATLAB is done in the following way. Firstly, a memoryless Gaussian random vector X with 1 000 000 samples is generated, using MATLAB functionX=randn(1000000,1). Then, the two-dimensional random Gaussian source is generated joining every two consecutive samples (X(2i−1),X(2i)),i=1,…,500000. After that, the polar quantizer is simulated according to the algorithm described above. Values ofSQNRσ0obtained by simulation are also shown in Table 1, for the purpose of comparison with theoretical results. We can see that values ofSQNRσ0obtained by theory and by simulation are matched very well, which proves the developed theory.In Fig. 2, there is shown SQNR in the wide range of variances, for different values of μ and forN=1282. Forμ=5.357, the maximal value ofSQNRσ0is achieved, but robustness of the quantizer is poor. Increasing of μ leads to decreasing ofSQNRσ0, but robustness increases. For high values of μ (e.g.μ=255), robustness of the quantizer is very good, i.e. SQNR is constant in very wide range of variances. We can conclude that for stationary signals whose variance is constant (equal toσ02) and for near-stationary signals (whose variance is changed in the narrow range of variances aroundσ02), small values of μ should be used. For non-stationary signals, whose variances are changed significantly with time in the wide range of variances, robustness is very important, therefore high values of μ should be used. Also, this polar quantizer can be used as a part of adaptive and switch quantizers [16,19]. In this case, small values of μ should be used.Fig. 3shows SQNR in the wide range of variances forμ=255, for different N.The bit-rate of the polar quantizer is defined asR=12log2Nbits-per-sample (bps). SQNR of the unrestricted polar quantizer in the wide range of variances is shown in Fig. 4with line 1. Also, for the purpose of comparison, SQNR of the corresponding μ-law scalar quantizer is shown in Fig. 4 with line 2. Both quantizers have the same parameters:R=7bpsandμ=255. We can see that the unrestricted polar quantizer has better performances than the corresponding scalar quantizer: it has higher the maximal SQNR for 3.34 dB and higher the average SQNR for 3.63 dB in the range of variances (σ02[dB]−40dB,σ02[dB]).Fig. 5shows SQNR in the wide range of variances for the μ-law polar quantizer from this paper, for two values ofμ:μ=255andμ=μopt. Also, SQNR for two other types of the polar quantizers (the optimal polar [4] and the uniform polar [6] quantizers) is presented, for the purpose of comparison. All these quantizers are considered for the same bit-rate ofR=7bps. For non-stationary signals, the μ-law polar quantizer with high μ (μ=255) is used. Its average SQNR in the wide range of variances (σ02[dB]−40dB,σ02[dB]) is 33.53 dB, while the average values of SQNR for the optimal and the uniform polar quantizers in this range of variances are 21.68 dB and 19.65 dB, respectively. We can see that the μ-law polar quantizer withμ=255has much higher the average SQNR (i.e. it is much more robust) than the optimal and the uniform polar quantizers. Therefore, the μ-law polar quantizer withμ=255is a much better solution for non-stationary signals than the uniform and the optimal polar quantizers. For stationary signals, the μ-law polar quantizer with small μ (μ=μopt) is used. It is better than the uniform polar quantizer since it has higher SQNR for all variances. It has slightly smaller the maximal SQNR than the optimal polar quantizer for 0.83 dB, but on the other hand it has higher the average SQNR for 4.95 dB. Furthermore, it is simpler for realization since the optimal polar quantizer requires solving of integral equations which is not the case with the μ-law polar quantizer. Therefore, for stationary signals, the μ-law polar quantizer withμ=μoptis a very good solution. We can see that the μ-law polar quantizer is a very good solution both for stationary and non-stationary signals, which is not the case with the optimal and the uniform polar quantizers. Also, the unrestricted polar quantizer withμ=255has higher the maximal SQNR for 0.84 dB, higher the average SQNR for 0.59 dB in the range of variances (σ02[dB]−25dB,σ02[dB]) and higher the average SQNR for 0.08 dB in the range of variances (σ02[dB]−40dB,σ02[dB]), compared to the product polar quantizer from [13]. Furthermore, the product polar quantizer in [13] is designed only for one value of μ (μ=255), while the unrestricted polar quantizer in this paper is designed for all values of μ.

@&#CONCLUSIONS@&#
