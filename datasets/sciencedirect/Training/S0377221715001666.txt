@&#MAIN-TITLE@&#
Multivariate control charts based on the James–Stein estimator

@&#HIGHLIGHTS@&#
Multivariate control chart is a useful tool in quality control.We use the James–Stein estimator to construct better control charts.JS-type control charts are proposed.

@&#KEYPHRASES@&#
Average run length,Control chart,Multivariate normal distribution,James–Stein estimator,

@&#ABSTRACT@&#
In this study, we focus on improving parameter estimation in Phase I study to construct more accurate Phase II control limits for monitoring multivariate quality characteristics. For a multivariate normal distribution with unknown mean vector, the usual mean estimator is known to be inadmissible under the squared error loss function when the dimension of the variables is greater than 2. Shrinkage estimators, such as the James–Stein estimators, are shown to have better performance than the conventional estimators in the literature. We utilize the James–Stein estimators to improve the Phase I parameter estimation. Multivariate control limits for the Phase II monitoring based on the improved estimators are proposed in this study. The resulting control charts, JS-type charts, are shown to have substantial performance improvement over the existing ones.

@&#INTRODUCTION@&#
Multivariate control charts are useful tools in detecting shifts in a manufacturing process when the quality characteristics of interest are multivariate. Early research goes back to the T2 control chart (Hotelling, 1947), which detects mean vector shifts in a multivariate process based only on the most recent observation, resulting in insensitive detection of small mean vector shifts.There are many other multivariate control charts proposed in the literature. Crosier (1988) proposed multivariate CUSUM control charts by either reducing each multivariate observation to a scalar or forming a CUSUM vector from the observations. Pignatiello and Runger (1990) proposed a CUSUM control chart, MC1, and showed that it has better performance than several other CUSUM charts. In addition, the MEWMA control chart established by Lowry, Woodall, Champ, and Rigdon (1992) uses all data information from the early to the last observations to construct a chart which has the advantage of smaller average run length for detecting small shifts in the process mean vector. Reynolds and Cho (2006) and Reynolds and Stoumbos (2008) proposed combining different multivariate control charts for monitoring process mean vector. For more studies on multivariate control charts, refer to Chan, Lai, Xie, and Goh (2003), Huwang, Yeh, and Wu (2007), Wang (2012) and Woodall and Montgomery (2014). The use of control charts generally involves two phases, Phase I and Phase II. In the Phase I study, a set of historical data is used to estimate the parameters of the process and establish control limits for the Phase II monitoring. In the Phase II monitoring, the data are sequentially collected over time to assess whether the parameters of the process have changed from the estimated values in the Phase I study. Usually before the Phase II monitoring, one must estimate the in-control process parameters and determine the control limits in the Phase I study. As a result, the accuracy of the Phase I estimation is a crucial step for the success of the Phase II study.For monitoring a univariate quality characteristic assumed to follow a normal distribution, there are only two parameters, the mean and variance, that need to be estimated. In this case, the sample mean and sample variance are optimal estimators under the squared error loss function. On the contrary, when the number of parameters needed to be estimated is greater than two such as in the case of a multivariate normal process, it is well known that the conventional estimators are not optimal under squared error loss. For example, the sample mean vector is not admissible for estimating the multivariate normal mean vector under squared error loss when the dimension is greater than two (Berger, 1985). Due to the inadmissibility property of the sample mean vector, the parameter estimation in the Phase I study for monitoring multivariate process can be improved.It is well known that the shrinkage estimators have smaller mean squared errors than the conventional estimators (Lehmann and Casella, 1998; Stein, 1956). Thus, in this study, we propose using shrinkage estimators to improve the Phase I estimation. Since one of the well-known shrinkage estimators is the James–Stein estimator, we propose multivariate control charts based on the James–Stein estimator in the Phase I study and show that the resulting charts, as compared with the conventional charts, have substantial improvement in performance. To carry out this, several well-known charts with the Phase I estimation based on the conventional estimators and the James–Stein estimators are studied in the Phase II monitoring, and their performance is compared in terms of average run length (ARL).The rest of the paper is organized as follows. The shrinkage estimation approach is introduced in Section 2. The new control charts based on the James–Stein estimator to estimate the mean vector in the Phase I study when the covariance matrix is known or unknown are proposed in Section 3. Section 4 compares the conventional charts and the new proposed charts in terms of the ARL performance. An asymptotic result for control limit comparison is given in Section 5. A real example from the chemical industry is illustrated in Section 6. Concluding remarks and discussions are given in Section 7.Suppose that a random sampleX1,…,Xnfollows a multivariate normal distribution N(μ, Σ) where μ is a p-dimensional vector and Σ is a p × p positive definite matrix. First, we assume that Σ is known. The conventional estimator for μ is the sample meanX¯=∑i=1nXi/n. Stein (1956) has proved that for estimating μ, under squared error loss,X¯is inadmissible for p ≥ 3. Namely, there exists an estimatorδ(X1,…,Xn)such that the mean squared error (MSE),E[(δ(X1,…,Xn)−μ)′Σ−1(δ(X1,…,Xn)−μ)],ofδ(X1,…,Xn)is smaller than or equal to the MSE,E[(X¯−μ)′Σ−1(X¯−μ)],ofX¯for all μ and the strict inequality holds for some μ when p ≥ 3. An improved estimator, called the James–Stein estimator, is proposed in James and Stein (1961) with a smaller mean squared error thanX¯. Since then, many studies for developing shrinkage estimators have been conducted (Casella, 1980; Draper and Van Nostrand, 1979; Efron and Morris, 1972; Strawderman and Cohen, 1971; Wang, 1999; 2000).In our study, we use the James–Stein estimator to construct better control charts. The standard form of the James–Stein estimator is given by(1)X¯0JS=(1−p−2n(X¯−v)′Σ−1(X¯−v))·(X¯−v)+v,where v is a fixed vector to which we intend to shrinkX¯. By Lehmann and Casella (1998), v can be selected to be any p-dimensional vector. An improved James–Stein estimator has the form(2)X¯JS=(1−p−2n(X¯−v)′Σ−1(X¯−v))+·(X¯−v)+v,which is shown to have smaller MSE than the standard James–Stein estimator (1). Here the notationx+is defined to bex+={xifx>0,0otherwise.Note that in this study, we adopt the form (2) as the James–Stein estimator for constructing improved control charts.It is worth noting that a confidence set based on the shrinkage estimator is preferable to that based on the conventional estimator, resulting in the potential use of the James–Stein estimator for constructing better charts. Usually, a1−αconfidence set for μ based on the sample mean vectorX¯isC={μ:(X¯−μ)′Σ−1(X¯−μ)≤c/n},where c is the1−αcutoff point of a chi-square distribution with p degrees of freedom. The exact coverage probability Pr(C) of the confidence set C equals1−α. However, the confidence set based on the James–Stein estimator(3)CJS={μ:(X¯JS−μ)′Σ−1(X¯JS−μ)≤c/n}has been shown to have a higher coverage probability than1−αanalytically and numerically. That is,(4)Pr(CJS)≥Pr(C),and the strict inequality in (4) holds for some μ when p ≥ 3 (Brown, 1966; DasGupta, Ghosh, and Zen, 1995; Hwang and Casella, 1982; Joshi, 1967).Since the sets CJS and C have the same volume, property (4) shows that the set CJS can include a larger proportion of the population than the set C with the same capacity, which leads to better performance of the set CJS. Using property (4), in Section 3 we will propose several control charts in the Phase II study for monitoring the mean vector μ with the James–Stein estimator (2) used in the Phase I estimation.Note that although v in (2) can be selected to be any vector, the performance of the James–Stein estimator depends on v. If we do not have any preference of selecting v, we can select the value of v near the sample mean vector or being the zero vector.In this section, we propose charts for monitoring μ by modifying several well-known conventional charts by replacing the sample mean with the James–Stein estimator. For simplicity, we only consider the case of subgroup size 1 (i.e., individual observation) in our study. However, the results can be easily extended to the case where the subgroup size is greater than 1. In the following, the notationX¯denotes the sample mean vector of the in-control observations in the Phase I study and Xi∼ N(μ, Σ), with known Σ, denotes the observation of subgroupi,i=1,2,…,in the Phase II monitoring. Since the proposed charts are obtained by replacing the sample mean with the James–Stein estimator in the original charts, we refer to these charts as the JS-type control charts.1.The JS-T2 chart.The first proposed control chart is to modify the Hotelling-T2 chart (Hotelling, 1947). When the covariance matrix Σ is known, the monitoring statistic for the sample i is(5)TiJS=(Xi−X¯JS)′Σ−1(Xi−X¯JS).The chart gives an out-of-control signal if(6)TiJS>c1,where c1 is the constant to achieve a desired in-control average run length (ARL0). The conventional Hotelling-T2 chart replacesX¯JSwithX¯in (5) (Tracy, Young, and Mason, 1992).The JS-MC1 chart.Pignatiello and Runger (1990) proposed the MC1 control chart and showed that it can improve Crosier’s (1988) multivariate CUSUM control charts. The modified monitoring statistic for the MC1 chart isMC1iJS=max{∥Ci∥−kni,0},where k > 0,(7)Ci=∑l=i−ni+1i(Xl−X¯JS),ni={1ifMC1i−1JS≤0,ni−1+1ifMC1i−1JS>0,∥Ci∥=Ci′Σ−1CiandMC10JS=0.The JS-MC1 chart gives an out-of-control signal when(8)MC1iJS>c2,where c2 is the constant to achieve a specified ARL0. The conventional MC1 chart replacesX¯JSin (7) withX¯. Pignatiello and Runger (1990) chose the reference parameter k to be half of the distance between μ* and μ0, where μ0 is the in-control mean vector value and μ* represents a specified unacceptable out-of-control mean vector value.The JS-MEWMA chart.The MEWMA control chart was first developed by Lowry et al. (1992). The modified JS-type chart statistic isEiJS=Zi′ΣZi−1Zi,where(9)Zi=λ(Xi−X¯JS)+(1−λ)Zi−1,andΣZi=λ(2−λ)[1−(1−λ)2i]Σ.HereZ0=0(the zero vector) and λ is a constant, 0 < λ ≤ 1. The parameter λ determines the rate at which ‘older’ data enter into the calculation of the statistic. Thus, a large value of λ gives more weight to recent data and less weight to older data. When choosing the value of λ, it is recommended that small values of λ, such as 0.2, are used to detect small shifts, and larger values for larger shifts. The MEWMA chart gives an out-of-control signal if(10)EiJS>c3,where c3 is a specified constant. The constant c3 is chosen to achieve a desired ARL0. The conventional MEWMA chart replacesX¯JSwithX¯in (9).The JS-SZ & JS-MZ combined chart.Reynolds and Cho (2006) and Reynolds and Stoumbos (2008) proposed combining different multivariate control charts for process monitoring. One of them is the combination of SZ and MZ control charts, where the SZ denotes the Hotelling-T2 chart and the MZ for the MEWMA chart. Based on the SZ & MZ combined chart, we proposed a JS-SZ & JS-MZ combined chart, which signals if(11)TiJS>c4for the JS-SZ chart or(12)Zi′Σ∞−1Zi>c5for the JS-MZ chart, whereTiJSis defined in (5), Ziis defined in (9), andΣ∞=λΣ/(2−λ). Here the constants c4 and c5 are chosen to achieve a desired ARL0. The conventional JS-SZ & JS-MZ combined chart replacesX¯JSwithX¯inTiJSand Zi.In Section 3.1, we considered the case with known covariance matrix. However, in applications, it is likely that the covariance matrix is unknown. For the unknown covariance matrix case, we propose using a modified James–Stein estimator of the form(13)X¯SJS=[1−p−2n(X¯−v)′S−1(X¯−v)]+·(X¯−v)+v,where S is the sample covariance matrix of the in-control observations in the Phase I study. We have included the details of the JS-type charts in the case of a known covariance matrix. By a similar argument, we propose control charts for the case of unknown covariance matrix with the James–Stein estimator (2) and Σ in the four JS-type control charts in Section 3 replaced by the modified James–Stein estimator (13) and the sample covariance S, respectively.In this section, we conduct a simulation study to compare the JS-type control charts with the conventional control charts in terms of their ARLs. In applications, it is usually the case that the covariance matrix is unknown. Thus, here we mainly consider the case of unknown covariance matrix. In the simulations, we consider the case that the true mean of the process is not equal to the zero vector 0 and the James–Stein estimator shrinks toward the point 0. Here we do not assume that the true mean is the zero vector because in applications, the point that we shrink toward is usually not the true mean.To consider a more general case, we assume thatμ=μ0=(h,−h,h,−h,…,(−1)p+1h)′,where h is a constant, when the process is in control andμ=μ*when the process is under an out-of-control condition. In general, when we select the point v of (13) in a p-dimensional space, it is possible that the values of this point in some dimensions are greater than (or less than) the true parameter values in the corresponding dimensions. Since in the simulation study, the James–Stein estimator shrinks toward the zero vector, we select the type of μ0 such that its values in some dimensions are greater than 0 and its values in other dimensions are less than zero. We also tried other in control parameter values, such asμ0*=(h,h,h,h,…,h)′. The simulation shows that it has a similar performance as that of μ0. In this study, h is set to 0.03 and v in (13) is selected to be the zero vector 0. That is, the James–Stein estimator (13) shrinks toward the point 0.From the simulation study, we found that the JS-type control charts usually have significant improvement when the true mean is in a known region which should not be too wide, and v in the James–Stein estimator is selected to be a point in this region. If we do not have this knowledge, and just let the James–Stein estimator shrink to a randomly selected point, the JS-type charts may not have significant improvement.To investigate the performance of the JS-type charts for different situations, we consider three cases with different covariance matrices: (i) the covariance matrix arising from an autoregressive model, (ii) the covariance matrix from an equi-correlation framework, and (iii) a specific nonsparse covariance matrix. For the first case, we consider the covariance matrix from an autoregressive model AR(1). Let Ytbe a time series with the modelYt=1+ϕYt−1+ϵt,where ϕ is a constant andϵtis assumed to follow a standard normal distribution N(0, 1). The covariance matrix ofYt,t=1,…,p,has the form(14)σij={1/(1−ϕ2)ifi=jϕ|j−i|/(1−ϕ2)ifj≠i,wherei,j=1,…,p. In the second circumstance, we consider the covariance matrix of the form(15)σij={1ifi=jeifj≠i,where e is a constant between 0 and 1 andi,j=1,…,p. For the third case, since in the simulation study the dimension of the variables does not exceed 15, we consider a covariance matrix of the form(16)σij={1ifi=j(15−i)/(15p)ifj≠i,wherei,j=1,…,p.The ARL performance is presented for various values ofd=∥μ*−μ0∥. To have a fair comparison, we set the control limits of each control chart with the same ARL0 when the process is in control, and then the ARLs for different out-of-control scenarios are estimated. A chart with a larger ARL in an out-of-control condition is not preferable because it needs more data to signal.Comparisons of the four charts with their JS-type counterparts are presented in Tables 1–12, which tabulate the ARLs for different values of μ* when the in-control process mean vector is estimated fromm=25observations in the Phase I study. Letci′s denote the constants used in original control charts corresponding to the constant cis used in the JS-type charts. The last row of each table gives the values ofci′and ciused for the control limits such that all charts have the ARL0 approximately equal to 200. The replication size used in this simulation study is 200,000. The corresponding standard errors for each ARL calculation are given in parentheses.In the out-of-control scenarios, we consider three different mean shift patterns. The three forms ofμ*−μ0are(d/p,…,d/p),(d/p−2,…,d/p−2,0,0)and(−d/p,d/p,−d/p,…,(−1)pd/p).All of these forms satisfy∥μ*−μ0∥=d. Tables 1–4 provide the performance of the conventional charts and the JS-type charts for the covariance matrix (14) from the autoregressive model withϕ=0.3. Tables 5–8 present the results for the covariance matrix from the equi-correlation framework. Tables 9–12 display the results for the covariance matrix of the form (16). In the simulation study, the constant k for the MC1 charts in the tables was chosen to be 0.5 as it is commonly selected and the smoothing constant λ for the MEWMA charts was selected to be 0.2.For comparing the SZ & MZ and JS-SZ & JS-MZ combined charts, it is first necessary to compute the values of(c4′,c5′)and (c4, c5) to achieve a desired ARL0. Although there are many combinations of(c4′,c5′)and (c4, c5) such that the ARL0 for the SZ & MZ and JS-SZ & JS-MZ combined charts equals 200, we chose the values of(c4′,c5′)and (c4, c5) so that the SZ chart and JS-SZ have ARL0=400,and the SZ & MZ and JS-SZ & JS-MZ combined charts have ARL0=200.For all three covariance matrix cases, the simulation results show that the JS-type charts are better than the conventional charts because the JS-type charts have shorter out-of-control ARLs. The improvement of the JS-type charts is significant for most situations. Only for the situations of μ4 in the tables, the improvement level of the JS-type charts is not as significant as the other situations. Both the JS-type charts and the conventional charts can detect this out of control situation easily.In Tables 1–12, we present the results for the cases ofd=1andd=3. The performance for 1 < d < 3 (not presented here) is between the performance for the case ofd=1and that for the case ofd=3. These tables show that the JS-type control charts have better performance than the conventional charts. Although the improvement level of the JS-type chart depends on the form of μ*, from the simulation results, the JS-type charts can always improve the conventional charts for different pattern of μ* if the shift is not really small. When a shift is really small, neither the JS-type charts nor the conventional charts can easily detect it. In this case, it would be more difficult to compare their performances.The simulation results in Section 4 show that the JS-type charts have smaller ARL1 than the conventional charts. From the simulation results, we see that the control limits for the JS-type control charts are smaller than those of the conventional charts. The comparison of the control limits for the T2 and JS-T2 charts for large subgroup sample sizes when the covariance matrix is known is given in the following theorem.TheoremFor p ≥ 3, under the same ARL0, the control limit of the JS-T2 chart is less than or equal to that of the T2 chart for the case of known covariance matrix when the subgroup sample size is large.In the previous discussion, we assumed that the sample size of the subgroup equals 1. Here we consider the case where the sample size of the subgroup is greater than 1. Hence, in the current situation, for the JS-T2 chart, Xiin (5) is replaced byXi¯,which denotes the sample mean vector of the observations in the subgroup i, andX¯JSin (5) is replaced byX¯¯JSwhich represents the average of the James–Stein estimators from the in-control samples in the Phase I study. Similarly, for the T2 chart, Xiis replaced byXi¯andX¯is replaced byX¯¯,which represents the average of the sample mean vectors from the in-control samples in the Phase I study. It is worth noting that the estimatorsX¯¯andX¯¯JSare obtained from the Phase I study, while the estimatorX¯iis calculated from the Phase II monitoring. HenceX¯iandX¯¯are mutually independent and so areX¯iandX¯¯JS.Note that the ARL0 for a control chart in the Phase II study is the average number of samples taken until the monitoring statistic is greater than the control limit when the process is in control. For the case of known covariance matrix, without loss of generality, we assumeΣ=I. To prove that the control limit of the JS-T2 chart is less than or equal to that of the T2 chart, it suffices to show that for any constant s > 0Pμ0(|Xi¯−X¯¯JS|<s)≥Pμ0(|Xi¯−X¯¯|<s),i=1,2,…,wherePμ0(·)denotes that the probability is evaluated underμ=μ0,which is the in-control mean vector.When the process is in control, we haveXi¯→μ0in probability. Thus, for a given constantϵ>0we have(17)Pμ0(|Xi¯−μ0|<ϵ)→1.By (4) and the fact thatPμ0(|μ0−X¯¯JS|<s)−Pμ0(|μ0−X¯¯|<s)is a continuous function of μ0, there exists a ζ ≥ 0 and an η > 0 such that(18)Pμ′(|μ′−X¯¯JS|<s)−Pμ′(|μ′−X¯¯|<s)≥ζfor|μ′−μ0|≤η.By (17), we havePμ0(|Xi¯−μ0|≥ϵ)→0,for anyϵ>0. Therefore, for a constant(ζ+ρ)/[2(1+ζ)],there exists a n0 such that(19)Pμ0(|Xi¯−μ0|>η)<(ζ+ρ)/[2(1+ζ)],when the subgroup sample size n* in Phase II is greater than n0, where ρ is a positive constant to be determined later. Also, by a straightforward calculation, we have(20)Pμ0(|Xi¯−X¯¯JS|<s)−Pμ0(|Xi¯−X¯¯|<s)=Pμ0(|Xi¯−X¯¯JS|<s,|Xi¯−μ0|>η)+Pμ0(|Xi¯−X¯¯JS|<s,|Xi¯−μ0|≤η)−Pμ0(|Xi¯−X¯¯|<s,|Xi¯−μ0|>η)−Pμ0(|Xi¯−X¯¯|<s,|Xi¯−μ0|≤η).LetW=[Pμ0(|Xi¯−X¯¯JS|<s∣|Xi¯−μ0|≤η)−Pμ0(|Xi¯−X¯¯|<s∣|Xi¯−μ0|≤η)]Pμ0(|X¯i−μ0|≤η)andV=Pμ0(|Xi¯−X¯¯|<s,|Xi¯−μ0|>η),where P(A|B) denotes a conditional probability of event A given event B.Then (20) can be rewritten as(21)Pμ0(|Xi¯−X¯¯JS|<s,|Xi¯−μ0|>η)+W−V.To prove that (21) is not less than zero, note that the first term in (21),Pμ0(|Xi¯−X¯¯JS|<s,|Xi¯−μ0|>η)=τ,is greater than zero. Conditioning on the event|X¯i−μ0|≤η,from (18) we havePμ0(|Xi¯−X¯¯JS|<s∣|Xi¯−μ0|≤η)−Pμ0(|Xi¯−X¯¯|<s∣|Xi¯−μ0|≤η)≥ζfor n* > n0. By this and (19), we haveW≥ζ{1−(ζ+ρ)/[2(1+ζ)]}when n* > n0.Also by (19), we haveV<(ζ+ρ)/[2(1+ζ)]for n* > n0. Hence,W−V≥ζ{1−(ζ+ρ)/[2(1+ζ)]}−(ζ+ρ)/[2(1+ζ)]=(ζ−ρ)/2.If ζ > 0, we choose a ρ satisfying 0 < ρ < ζ or ifζ=0,we choose a ρ satisfying 0 < ρ < 2τ. Then (21) is greater than zero. Thus, the proof is completed.□In the proof of the theorem, we require that the subgroup sample size is large because we need to apply the law of large number to prove it. This theorem discusses the known covariance case. As for the unknown covariance matrix case, from the control limits shown in Section 4, it is likely that the result is still valid. However, it is not easy to obtain a similar result for the unknown covariance matrix case because, to our best knowledge, there is no similar result as Eq. (4) established for the unknown covariance case in the literature. Therefore, for the unknown covariance matrix case, the theoretical results are still under study. In addition, since the distribution of the James–Stein estimator has not been established in the literature, the study for applying the result of the theorem to other charts are still on-going. But from the simulation results, this phenomenon also holds for other charts. Also the result of the theorem may be related to the better performance of the chart because we expect that a signal occurs earlier for a smaller control limit. That is, smaller control limits may lead to shorter ARL1. As a result, we expect that a chart with a smaller control limit may lead to better performance under the same ARL0.In this section, we use an example from chemical industry to illustrate the applicability of the proposed charts. The data, adapted from Montgomery (2009, p. 520), include 30 samples (with size 1) of 4 process variables (p=4) from a chemical process, which are shown in Table 13.These data are used to demonstrate the performance of a principal component analysis in Montgomery (2009). Treating the data in a similar way as Montgomery (2009), the first 20 samples are assumed to be drawn from the in-control process and are utilized for the Phase I parameter estimation while the last 10 samples are used for the Phase II monitoring. As indicated in Montgomery (2009), there is a mean vector shift beginning at sample 24 or 25. We treat the sample covariance matrix of the first 20 samples as the true covariance matrix and make a transformation so that the resulting process variables have the identity covariance matrix. Then we compare the results of the conventional and JS-type charts using the transformed process variables. Here the James–Stein estimator of the JS-type control chart shrinks toward the zero vector. The conventional and JS-type control charts for the 10 samples in the Phase II monitoring are presented in the figures below. All control charts have the ARL0 approximately equal to 200.In Fig. 1, the MC1 chart detects an out-of-control signal at the 10th sample while the JS-MC1 chart triggers at the 8th sample. Fig. 2shows that the MEWMA chart detects an out-of-control signal at the 8th sample whereas the JS-MEWMA chart triggers an out-of-control signal at the 6th sample. Here we do not present the T2 and SZ & MZ charts and their JS-type counterparts because both the conventional and JS-type charts detect an out-of-control signal at the same sample. This example shows that the JS-MC1 and JS-MEWMA charts can detect an out-of-control signal earlier than the corresponding conventional charts in a practical application when a mean vector shift occurs.

@&#CONCLUSIONS@&#
