@&#MAIN-TITLE@&#
Suspension models for testing shape similarity methods

@&#HIGHLIGHTS@&#
We introduce a procedure to build challenging examples for persistence algorithms.Our procedure allows us to construct models in arbitrarily high dimension.The correctness of the procedure is proved and supported with numerical tests.We provide insights regarding the need to use multidimensional measuring functions.

@&#KEYPHRASES@&#
Topological suspension,Shape similarity,Persistent homology,Filtration,Matching distance,

@&#ABSTRACT@&#
A model based on the concept of topological suspension is constructed with the purpose of testing and comparing different shape similarity measures in computer vision and graphics. This model gives an automatic way to produce interesting shapes of arbitrarily high dimension as quality tests of algorithms that have been used in low dimensions, but are now intended for comparing multidimensional data sets. The analysis of the matching distance method is provided for one and two-parameter measuring functions on closed curves and surfaces, whose suspension is defined, respectively, on surfaces inR3and 3D objects inR4. Perspectives for applying this model to other shape descriptors used for digital images are pointed out.

@&#INTRODUCTION@&#
In this paper, we present a model based on the concept of topological suspension for testing and comparing different shape similarity measures. This model shall give an automatic way to produce interesting shapes of arbitrarily high dimension as quality tests of algorithms that have been successfully used in the lowest dimensions, but are now intended for comparing multidimensional data sets. Data of arbitrarily high dimension arise in computational dynamics, in particular in PDEs of evolutionary type as a result of Fourier series projection or of discretization of the space variable. See, for example [8,15,12] and references therein. Another example of high-dimensional data comes from considering the time index in streams of images as an additional dimension. In this way a stream of 2D images can be interpreted as a 3D image [16,19]. One of the authors of [19] is currently working on applying this principle to pattern analysis of streams of 3D images interpreted as 4D images. Such data may be huge and thus numerically challenging, but since we do not know a priori the expected output of the topology algorithm, we cannot be sure if it gives the right results. Hence, unless the data and its structure is already well-known, it may not be suitable for testing. Conversely, high-dimension examples constructed by hand are typically not very demanding from a numerical standpoint. The suspension process allows the construction of models with the desired topological characteristics in any dimension.Let us outline this procedure which will be presented in detail in Section 2. Let M be an n-dimensional triangulated manifold representing a given shape, and let f be a continuous function on M with values inRwhich measures a feature of interest of M. In papers on applications to shape comparison such a function is called measuring function (e.g. [11]), and is often interpolated from its values on vertices of a given mesh.The topological descriptor of shapes we will focus our attention on is the homology rank invariant, one of many ways of measuring how the topology of the sublevel set changes as we pass through a critical value of the function f. This shape descriptor permits measuring the persistence or, in other words, the robustness of homology generators, thus distinguishing those which may appear due to noise in the data from structural ones. The term rank invariant was perhaps first introduced in [4] in the context of multidimensional persistence, but in case of one-dimensional persistence, the information given by the rank invariant can be graphically displayed in two equivalent ways: either as the persistence diagram[9] or as a barcode[5]. Given two different shapes M and N, and their measuring functions f and g, a distance between rank invariants is a measure of similarity between the shapes. We focused our attention on the matching distance[11] but our model carries over to any other known distance with the stability property, for instance, to the Wasserstein distance[10].We construct a measuring functionS1fon the topological suspension SM, also with values inR, and with the property that its rank invariants are basically those of f with the homology dimension q shifted by one (Theorem 2.3). In particular, the 0-dimensional rank invariant, also called the size function[14,22] ofS1fis quasi-trivial, and the one-dimensional rank invariant ofS1fprovides about the same information as the size function of f. Note that by iterating this construction, we can produce shapes of arbitrary dimensionality whose interesting features are shifted to the highest dimension.Our next result is Theorem 2.5 showing the relation between the matching distances of two measuring functions and their suspensions. We then extend the construction to suspensionsSkfof multiparameter functionsf:M→Rk, also called multidimensional measuring functions. The multidimensional persistent homology was first introduced in [4] in the context of discrete filtrations. Its motivation is that a multifiltration may detect geometric features which separate k coordinate-wise tests cannot detect. Multidimensional 0th order rank invariants were first applied to the shape similarity analysis based on continuous measuring functions in [3]. A bridge between the discrete and continuous settings is established in [6].Our construction was motivated by the fact that current numerical experimentation seems to suggest that in some cases, shape comparison using homology rank invariants can be reduced in practice to that of multidimensional 0th order rank invariants provided the dimension of the parameter space is increased. Our goal is not to object to this experimental assertion, but rather to indicate that the exchange of the method cannot be done blindly, that is, without knowing the shape of the object we want to study, and that it may induce a higher computational cost than computing rank invariants for higher homology dimensions.In Section 3, the analysis of the matching distance method is provided for two-parameter measuring functions on closed curves and surfaces, whose suspension is defined, respectively, on surfaces and on 3D objects in 4D space.In Section 4, perspectives for applying our construction to other known shape descriptors in digital imaging are suggested. We give two examples: one is the Morse descriptor introduced in [1] and another one is the method of image matching by transformation maps introduced in [13]. In applications to digital imaging, where pixels and voxels are of concern, cubical grids are the most convenient geometric structure. However, the geometric realization of the suspension is clearly easier in simplicial meshes. Nevertheless, our model can be applied to cubical grids arising in digital imaging, by using the concept of relative homology, as we show.Appendix A contains the proofs of the main mathematical statements, which are our original results.Since the homological rank invariants are only defined for homology with coefficients in a fieldF, we will use the notationH∗(X)forH∗(X;F)throughout this paper.The suspension of a topological space X is the quotient spaceSX≔X×[-1,1]/∼, where∼is the identification(x,1)∼(y,1)and(x,-1)∼(y,-1)for allx,y∈X[20, Section 33]. This space can be visualized as a double cone over X with vertices at the parameter valuess=±1. It is known that S is a functor on the category of topological spaces, with its value on mapsF:X→Ygiven bySF(x,s)≔(F(x),s). This functor shifts the reduced homology dimension by one [20, Theorem 33.2], that is(1)H∼q+1(SX)≅H∼q(X),q⩾-1.In terms of non-reduced homology, this is equivalent to writingHq+1(SX)≅Hq(X),forq⩾1,H1(SX)⊕F≅H0(X),andH0(SX)≅F.Letx0∈X. The based suspension of the pointed space(X,x0)is the pointed space(ΣX,(x0,0)), whereΣXis the quotient space of SX obtained by the additional identification(x0,s)∼(x0,0)for alls∈[-1,1]. Fig. 1shows an example of a topological space and its suspension.Let us note that if X is a triangulable space, then its suspension SX is also triangulable, and givenKa triangulation of X we can constructS(K), also called the suspension of the complexK, as the joinS(K)=K★{w0,w1}, where{w0,w1}is a complex composed of two vertices. That is, the simplices ofS(K)are composed of every simplex[a0,a1,…,an]ofK, as well as[w0,a0,a1,…,an]and[w1,a0,a1,…,an]. The suspensionS(K)can be seen as the union of two cones overK, and ifKis a triangulation of X, thenS(K)is also a triangulation of SX. In this case, it is known thatΣXis homotopy equivalent to SX[17, Section 4.3].We now pass to measuring functions on topological spaces. In literature on Morse theory and its applications, we usually assume thatX=Mis a connected smooth compact manifold of dimension d and thatf:M→Ris a Morse function, that is, aC2function whose critical points are nondegenerate and have distinct critical values. Among other consequences, this hypothesis permits the definition of the Morse index of a critical point p of f as the dimension of the negative eigenspace of the Hessian matrix of f at p. However, in this paper we will only assume that f is of classC1unless otherwise stated. Letm0be the global minimum of f attained atx0.DefineEf:M×[-1,1]→Rby(2)Ef(x,s)≔s2m0+(1-s2)f(x).Note that Ef assumes the global minimum at the union of{x0}×[-1,1]withM×{-1,1}. Along each lines↦(x,s),Efassumes a maximum at(x,0). By simple differential calculus, we get the following statement.Proposition 2.1A point(p,s)is a critical point of Ef if and only if either p is a critical point of f ands=0, ors=±1. Moreover, if p is a nondegenerate critical point of f of Morse indexλ, then(p,0)is also a nondegenerate critical point of Ef of Morse indexλ+1.Define the mapsS1f:SM→R, respectively,Σ1f:ΣM→R, as the compositions of the inverse of the quotient map ofM×[-1,1]onto SM, respectively,ΣM, with Ef. These applications are well-defined since Ef is constant on the subsets ofM×[-1,1]which are sent to a point by quotient maps. The statement of Proposition 2.1 extends toS1fexcept for the non-degeneracy conditions at points on{x0}×[-1,1]with the critical valuem0. By passing toΣ1f, we gain the isolation condition for the equivalence class of(x0,0).Given anyα∈R, we consider the sublevel setsMα≔{x∈M|f(x)⩽α}and(SM)α≔{(x,s)∈SM|S1f(x,s)⩽α}.It is easy to see thatS(Mα)⊂(SM)αbut the reverse inclusion does not hold true. However, the following result holds. Proof can be found in appendix, along with other long proofs of results in this article.Lemma 2.2The setS(Mα)is homotopy equivalent to(SM)α.We now discuss the effect of the suspension operation on rank invariants. We assume that M is triangulated so that the critical points of f are vertices of the triangulation, and in particular, thatx0is a vertex. More precisely, in practical computations, f is usually known only on vertices of a given mesh and a functionf∊is interpolated from f in such a way that its critical values occur only on vertices. The stability theorems [7,6] guarantee the existence of a distance (such as the matching distance) in which the rank invariants of f andf∊can be made as close as desired.Given anyα<βinR, we consider the mapH∗(j(α,β)):H∗(Mα)→H∗(Mβ)induced by the inclusion mapj(α,β):Mα↪Mβ. Recall that the qth persistent homology space of(M,f)at(α,β)is the image ofHq(Mα)under the mapHq(j(α,β))and the qth rank invariant of(M,f)at(α,β)is the number(3)ρfq(α,β)=rankimHq(j(α,β)).The rank invariant function isρfq:Δ+→Ndefined onΔ+≔{(α,β)∈R2|α<β}.Analogously, we define the reduced rank invariant function as the one on the reduced homologies:(4)ρ̃fq(α,β)=rankimH∼q(j(α,β)).Here is our first result.Theorem 2.3Letf:M→Rbe aC1function on a connected compact manifold M. For any(α,β)∈Δ+,(5)ρ̃S1fq+1(α,β)=ρ̃fq(α,β),q⩾-1.For the non-reduced rank invariant, we have(6)ρS1fq+1(α,β)=ρfq(α,β),q⩾1,(7)ρS1f1(α,β)=ρf0(α,β)ifα<m0,ρf0(α,β)-1otherwise,and(8)ρS1f0(α,β)=0ifα<m0,1otherwise.The same formulas hold forΣ1f.We can use Theorem 2.3 to prove results about the matching distance between rank invariants [11]. The previous reference discusses the use of the matching distance in size theory, which is in essence the study of the 0th rank invariant. These results can be generalized in a natural and common way to the qth rank invariant. Recall the definition of a cornerpoint of the rank invariant functionρf:Definition 2.4For a pointp=(α,β)∈Δ+, define its multiplicityμ(p)as the minimum, over all∊>0such thatα+∊<β-∊, ofρf(α+∊,β-∊)-ρf(α-∊,β-∊)-ρf(α+∊,β+∊)+ρf(α-∊,β+∊).Ifμ(p)>0, then p is called a proper cornerpoint ofρf. In addition, for a vertical line r of equationx=α, define its multiplicityμ(r)to be the minimum, over all∊>0such thatα+∊<1/∊, ofρf(α+∊,1/∊)-ρf(α-∊,1/∊).Ifμ(r)>0, then r is called a cornerpoint at infinity ofρf, and we identify it with the pair(α,∞). The rank invariant functionρfis uniquely determined by the multiset of its cornerpoints together with their multiplicities, called its persistence diagramDgm(ρf).The matching distance d between the rank invariantsρfandρgis the bottleneck distance between the multisets of their cornerpoints. Technical details can be found in [11, Definitions 3.4–3.6] and we do not wish to encumber this article by repeating them, but generally speaking, its definition is the following:d(ρf,ρg)=minσmaxp∈Dgm(ρf)δ(p,σ(p)),whereσvaries among the bijections betweendgm(ρf)anddgm(ρg), and whereδ((u,v),(u′,v′))=minmax{|u-u′|,|v-v′|},maxv-u2,v′-u′2.The main idea is thatd(ρf,ρg)is the cost of the optimal bijection moving the cornerpoints of the persistence diagram ofρfto those ofρg. However, it also recognizes that if a cornerpoint of one or both of these persistence diagrams is close to the diagonalΔ≔{(α,α)|α∈R}, or cannot be matched to another cornerpoint due to differing cardinalities of the diagrams, the optimal bijection might entail moving it to the diagonal. This corresponds to smoothing out small topological noise in f or g.Theorem 2.5LetM,Nbe homeomorphic connected compact manifolds, and letf:M→Randg:N→RbeC1measuring functions. Denote bym0andn0the minima, respectively, of f on M and g on N. Then(9)d(ρ̃S1fq+1,ρ̃S1gq+1)=d(ρ̃fq,ρ̃gq),q⩾-1.For the matching distance between non-reduced rank invariants:(10)d(ρS1fq+1,ρS1gq+1)=d(ρfq,ρgq),q⩾1,(11)d(ρS1f1,ρS1g1)⩽d(ρf0,ρg0),and(12)d(ρS1f0,ρS1g0)=|m0-n0|.Furthermore, ifm0=n0, then we have(13)d(ρS1fq+1,ρS1gq+1)=d(ρfq,ρgq)ifq⩾0,0ifq=-1.The same formulas hold forΣ1fandΣ1g.From this point on, let us consider simplicial complexesKandL, assumed to be the triangulations of homeomorphic compact connected manifolds M and N. We equip these complexes with k-dimensional measuring functionsφ:V(K)→Rkandψ:V(L)→Rk, whereVrefers to the vertex set of the complex under consideration. The functions may be obtained by sampling measuring functionsf:M→Rkandg:N→Rkof classC1. For a complexKequipped with a measuring functionφ:V(K)→Rk, and a valueα∈Rkwe further define the sublevel complexKαas the complex composed of all simplices ofKwhose vertices v all verify the relationφ(v)⪯α, where⪯is the usual partial order onRk. We shall define, forφ:V(K)→Rk, the measuring functionSkφ=(S1φ1,…,S1φk):V(S(K))→Rkon the vertices of the suspensionS(K)=K★{w0,w1}, whereS1φi(v)=φi(v)for all vertices v ofK, andS1φi(wj)=mi,0,j=0,1,mi,0being the absolute minimum ofφioverV(K).We can define the rank invariants for the discrete model. Consider the mapH∗(j(α,β)):H∗(Kα)→H∗(Kβ)induced by the inclusion mapj(α,β):Kα↪Kβ, whereα≺βand whereKαandKβdenote the supports of the sublevel complexesKαandKβ. We define the qth rank invariant of(K,φ)at(α,β)to beρφq(α,β)=rankimHqj(α,β).As proved in [6], the rank invariant functionsρφare identical to the rank invariant functionsρφ⌝, whereφ⌝:K→Rkis the axis-wise interpolation ofφ.In [3] a foliation method was introduced to reduce the computation of multidimensional rank invariants to that of a parametrized family of rank invariants for one-dimensional measuring functions. Algorithms were then developed to allow arbitrarily precise computation of the multidimensional matching distance on a finite subset of this family. In short, for every pair(l→,b→)∈Rk×Rkwhereli>0,∑li=1and∑bi=0, called an admissible pair and representing a line wherel→is a unit direction vector oriented toward higher values in the partial order onRkand whereb→is a starting point, we define a reduced one-dimensional measuring function on vertices asred(l→,b→)φ(v)=mini=1,…,klimaxi=1,…,kφi(v)-bili.It has been shown in [3] that ifα≺βare values found on the line inRk×Rkgenerated by(l→,b→), and more precisely, ifα=sl→+b→,β=tl→+b→, then we have equality of rank invariants:ρφ(α,β)=ρred(l→,b→)φ(s,t).This property has been used to define a k-dimensional matching distance between rank invariants:D(ρφ,ρψ)=sup(l→,b→)∈Admkdρred(l→,b→)φ,ρred(l→,b→)ψwhereAdmkis the set of admissible pairs.It should be noted that k-parameter persistence provides more information on the structure of a shape than k separate tests using single-parameter persistence. To convince oneself of this fact, we may take a look at Fig. 3. The two curves pictured cannot be distinguished by the rank invariant method using one or other of the coordinate functions. Indeed, their persistence diagrams will be identical, and the matching distance between them will be zero. However, using the reduction method, we find directions where topological properties are not born at the same point for both curves. We can therefore conclude that the 2-dimensional matching distance between their rank invariants will be positive.Theorem 2.6LetK,Lbe simplicial complexes, and letφ:V(K)→Rkandψ:V(L)→Rkbe k-dimensional measuring functions. Then(14)D(ρ̃Skφq+1,ρ̃Skψq+1)=D(ρ̃φq,ρ̃ψq),q⩾0.For the k-dimensional matching distance between non-reduced rank invariants:(15)D(ρSkφq+1,ρSkψq+1)=D(ρφq,ρψq),q⩾1,and(16)D(ρSkφ1,ρSkψ1)⩽D(ρφ0,ρψ0).We believe that Theorem 2.6 is probably also true in the continuous case, that is, with manifoldsM,Nequipped with continuous measuring functionsf:M→Rkandg:N→Rk. However, the proof appears to be more complicated in this case. Since our interest is in the numerics, assuming the simplicial framework was sufficient.The numerical examples described in this section have been produced with two-dimensional measuring functions. In this case, we note that the set of admissible pairsAdm2is the set of pairs((a,1-a),(b,-b))wherea∈(0,1)andb∈R. For a measuring functionφ:V(K)→R2, we will denote the reduced one-dimensional functionsred((a,1-a),(b,-b))φbyΦ(a,b), andred((a,1-a),(b,-b))S2φasS2Φ(a,b). Our examples are intended to provide experimental support for the theory described in the previous section. We have used two pairs of models, each of which are 1 or 2-dimensional simplicial complexes homeomorphic to connected and compact manifolds, as well as their simplicial suspensions as previously defined.We have used an implementation of the algorithm of [2] to compute lower bounds for the two-dimensional matching distance between their rank invariants of various orders with decreasing error tolerance. This algorithm, given pairs(X,φ)and(Y,ψ), computesd(ρΦ(a,b),ρΨ(a,b)), with(a,b)chosen on increasingly fine grids, until the desired tolerance∊, that is, the worst case error between the computed and exact 2-dimensional matching distances, is attained. Its total complexity depends on the complexity of the persistence and one-dimensional matching distance algorithms. It is known that computing persistent homology has complexityO(m3)in the worst case, where m is the number of simplices in the complex [23]. The complexity of one-dimensional matching distance computation isO(p2.5), where p is the maximal number of cornerpoints allowed [11]. The grid algorithm of [2] requires in the worst case a number of computations proportional to1/∊2, representing the number of grid points. Our implementation (coded in Java with help from N. Cavazza, co-author of [6] along with this paper’s authors) computes the persistence diagrams for these rank invariants using the persistent homology software JPlex [21]. In addition, constructing the suspension of a simplicial complex is linear on the number of simplices of the original complex.Example 3.1The contour model example is the pair of models(K,φ)and(L,ψ)shown in Fig. 4, along with the persistence diagrams forρφ20andρψ20. Its suspension is a two-dimensional simplicial complex embedded inR3; sort of a simplicial version of the curve and surface seen in Fig. 1. As shown, bothφ1andψ1, andφ2andψ2, take the same global minimum (in both cases 0), so we expect Eq. (13) to hold. The 2D matching distances have been computed with a tolerance∊=0.01, but given the simplicity of the example their exactness is easy to show. The results of our computations can be found in the following two tables:ρρ̃q=0q=1d(ρφ10,ρψ10)0.050.05d(ρS1φ1q,ρS1ψ1q)00.05d(ρφ20,ρψ20)0.150.15d(ρS1φ2q,ρS1ψ2q)00.15D(ρφ0,ρψ0)0.20.15D(ρS2φq,ρS2ψq)0.10.15As seen above,D(ρS2φ0,ρS2ψ0)cannot be assumed to equal 0, even ifφiandψitake the same global minimum fori=1,2. We have not included the results for the reduced rank invariants for the suspended models, since they are equal to that of the non-reduced rank invariants. This is not however expected to be true in general. Fig. 5further showsd(ρΦ(a,b)q,ρΨ(a,b)q)andd(ρS2Φ(a,b)q,ρS2Ψ(a,b)q)plotted in function of a and b, for a few interesting choices of q.Example 3.2The surface mesh model is shown in Fig. 6. Its suspension is a three-dimensional simplicial complex embedded inR4, which cannot be accurately shown without playing a video with the fourth dimension mapped to time. The measuring functionφ:V(K)→R2is defined in the following way: assuming thatV(K)={v1,…,vn}and that c is the center of mass of K defined by taking the weighted average of the centers of each triangle, we define the principal vectorw→=∑i=1n(vi-c)‖vi-c‖2∑i=1n‖vi-c‖22where‖·‖2refers to the Euclidean norm. Then, let d be the line passing through c havingw→as direction vector, andπbe the plane passing through c havingw→as normal vector. The functionφis defined asφ1(vi)=1-dist(vi,d)maxj=1,…,ndist(vj,d)andφ2(vi)=1-dist(vi,π)maxj=1,…,ndist(vj,π),where dist refers to the Euclidean distance between a point and the line d or planeπ. The measuring functionψis defined equivalently on the vertex setV(L). By the definition of the measuring functions, the absolute minima ofφ1,φ2,ψ1andψ2will all be 0. Table 1shows the results of our computations. All lower bounds for the 2D matching distance are shown, in order to illustrate the comparability of results between the original and suspended models at every step in the algorithm.Our focus in this paper is on the use of the topological suspension as a model in shape comparison by persistent homology methods. We finish with remarks showing that the main ideas can also be applied to many other topological methods in imaging with the same aim: to give an automatic way of producing examples of interesting shapes for providing quality tests of algorithms and programs that have been successfully used in low dimensions but which we now want to use with high-dimensional spaces. In this section we invite the readers to use their imagination in inventing similar models in their field of study, by pointing out examples of potential applications.Our first example is the Morse descriptor introduced by [1] with the same aim as persistent homology, that is, to provide topological analysis and comparison of shapes. The authors directly apply their descriptors to digital images generated from photographs of hand gestures in a sign language, and to other digital objects. Rather than looking at the rank of inclusion maps of a lower sublevel set into an upper one, they consider an invariant based on the concept of the rank of the relative homology of one set modulo another. More precisely, the Morse descriptorMDf:Δ+×N→Nis defined byMDf(α,β,q)≔rankHq(Mβ,Mα).This descriptor provides somewhat different information about the shape of interest than the rank invariant studied in this paper. Indeed, it focuses on the non-trivial homology cycles remaining or created in the upper level setMβafter contracting the lower level setMαto a point, while the rank invariant focuses only on the cycles of the lower level set remaining non-trivial after immersingMαtoMβ.We may want to investigate data of higher dimension than the initial 2D objects studied in [1] and test results on our suspension models. The suspension functor can be applied similarly as in Section 2 by the following theorem which can be proved using the relative Mayer–Vietoris sequence [20, Exercise 2 page 145] and Lemma 2.2.Theorem 4.1Under the terminology of Section2, the isomorphism(17)Hq+1((SM)β,(SM)α)≅Hq(Mβ,Mα)holds for allq∈Zprovided that(SM)α≠∅. If(SM)α=∅,(17)holds for allq>0, while forq=0andq=-1we have:H0(Mβ,∅)=H0(Mβ)≅H1((SM)β)⊕F,H0((SM)β,∅)=H0((SM)β)≅F.Our next example is an image matching method presented in [13]. The method consists of estimating a transformation map between block structures (pixels, voxels, windows) of given binary images analyzed for topological correspondence, using the concept of homology of maps. The idea is to use the structure of cubical sets to represent the image data of the two compared images, respectively X and Y. One next generates the cubical chain complexesC(X)andC(Y). The authors perform experiments with three types of transformations of 2D binary images: translation, rotation, and homothety. They provide an algorithm that generates a chain mapφ:C(X)→C(Y)and computes the mapH∗(φ)it induces in homology. That map carries the information on locations where important topological features (connected components or cycles) of X are carried to Y by the transformation. We believe that it is an interesting idea which has the potential of leading to algorithms for comparing shapes whose calculation time may compete with our matching distance methods.Our model easily adapts to the described method of [13] due to the functoriality of the suspension map. Once we define the chain complexes of the suspended images SX and SY and the suspended chain mapSφ:C(SX)→C(SY), we get the homology mapH∗(Sφ):H∗(SX)→H∗(SY).The only practical issue is in suitable choice of combinatorial structures. In [13,1,19], and in many other works on applications of topology to digital imaging, one uses cubical sets and cubical complexes. We refer the reader to [18, Chapter 2] for a detailed presentation of those structures as well as of the cubical homology theory. There are three main reasons behind this choice. First, it is the most appropriate for representing image pixels, voxels or, more generally, n-dimensional pixels. Second, the calculation of homology based on cubical sets is by far more efficient than that based on triangulations. Third, elementary cubes have this nice property that the product of two elementary cubes is also an elementary cube of higher dimension, while the product of two simplices is not in general a simplex. However, the suspension operation is based on contracting a subset of a cylinder to a single point (a vertex of a cone), and thus it produces a polyhedral set which is no longer a cubical set. Luckily, the efficient cubical homology algorithms may still be applied by using relative homology, thus one may avoid triangulating the suspended set. In brief, the relative homology of a pair of cubical sets gives the same information as the homology of the set obtained by contracting a subset to a single point, so the actual contraction does not need to be realized in practice. The idea is illustrated by Fig. 7. More explicitly, we have the isomorphism:(18)H∼∗(SX)≅H∗(ΣX,[x0])≅H∗(X×[-1,1],[x0])where[x0]=X×{-1,1}∪{x0}×[-1,1]is the equivalence class of the chosen base pointx0of X under the relation definingΣX. Given a pair of cubical setsA⊂X, we get(19)H∗(SX,SA)≅H∗(ΣX,ΣA)≅H∗(X×[-1,1],X×{-1,1}∪A×[-1,1]).Similarly, one can deal with the relative homology of sublevel sets of the suspended space.We leave up to the reader’s imagination further examples of problems where our model can be applied. We also believe that other topological operations than the suspension might also be found to be of interest in imaging.We now sketch, for the interested reader, proofs for some of the theorems we used in this paper. These proofs are original work by the authors.Proof of Lemma 2.2Ifα=m0is the absolute minimum of f, then we obviously haveS(Mα)=(SM)α.LetEM=M×[-1,1]and(EM)αbe the sublevel set of Ef. We first assume thatαis a regular value and construct a strong deformationh:X×[0,1]→Xof the setX=(EM)α∪M×{-1,1}ontoA=E(Mα)∪M×{-1,1}.These sets are illustrated in Fig. 2. Forcingly, we must haveh((x,s),λ)=(x,s)for all(x,s)∈Aand allλ∈[0,1]. Hence, it is enough to continuously extend h to(X⧹A)×[0,1]. By the hypothesis thatαis regular, the gradient vector field-∇Efdefines a flowt↦φ((x,s),t)onX⧹A‾such that the values of Ef decrease along its trajectories. In the absence of critical points, any(x,s)∈X⧹A‾is sent byφto A in a finite timet(x,s). By standard arguments from the dynamical systems theory,t(x,s)is a continuous function of(x,s).We extend h to(X⧹A)×[0,1]by the formulah((x,s),λ)≔φ(x,s),λt(x,s).It is easily verified that h is a strong deformation retraction of X onto A. Since, for eachλ,h(·,λ)is the identity map onM×{-1,1}⊂A,hextends to the deformationh̃:(SM)α×[0,1]→(SM)αby applying the quotient map. In particular, we have the homotopy equivalenceS(Mα)≅(SM)αfor a regular valueα.Now letαbe a critical value, other than the absolute minimumm0which is already taken care of. Since it is isolated, there exists∊>0such that all values in(α,α+∊]are regular. It is known from the classical Morse theory thatMαis a strong deformation retract ofMα+∊. Therefore,Mα≅Mα+∊, henceS(Mα)≅S(Mα+∊). By the same argument,(SM)α≅(SM)α+∊. By the preceding construction,S(Mα+∊)≅(SM)α+∊. By transitivity,S(Mα)≅(SM)α.□Eq. (5) is a consequence of (1), Lemma 2.2, and the functoriality of the suspension operation. Eq. (6) is an obvious consequence. Eq. (8) follows from the fact thatm0is the absolute minimum of the function at which a 0th order homological generator of infinite persistence is born. For proving Eq. (7), the above arguments carry over to prove the commutativity of the diagram:To complete the proof, letx0,v1,…,vnbe representative vertices of a basis ofH0homology generators forMα, andx0,w1,…,wmbe those of a basis forMβ. We haveH0(Mα)=⊕k=1nF[vk-x0]⊕F[x0]=H∼0(Mα)⊕F[x0]and the same holds true forH0(Mβ)with respect towk’s. The conclusion is reached by carrying the presented direct sum decomposition of the spaces to the isomorphisms shown by vertical arrows in the diagram and comparing their ranks.SinceΣMαis homotopy equivalent toSMαfor eachα, the arguments carry over toΣ1f.□Eqs. (9) and (10) are direct corollaries, respectively, of (5) and (6). Now Eq. (12) derives from (8), which signifies that the rank invariant functionρS1f0has a single cornerpoint(m0,∞). Similarly,ρS1g0has only one cornerpoint(n0,∞). It follows thatd(ρS1f0,ρS1g0)=|m0-n0|.To prove Eq. (11), see that from (7), the rank invariant functionsρf0andρS1f1differ only in that the former has one cornerpoint at infinity with the valuem0which the latter does not have. Similarly,ρg0has a cornerpoint(n0,∞)not present inρS1g1. Therefore, the computation ofd(ρS1f1,ρS1g1)requires computing the bottleneck distance between two proper subsets of the points involved in the computation ofd(ρf0,ρg0). Eq. (11) follows. However, in the case wherem0=n0, these two cornerpoints at infinity, differing by 0, will be matched in the optimal bijection between the sets of cornerpoints ofρf0andρg0and will not influence the value ofd(ρf0,ρg0). From this, and Eqs. (10) and (12), (13) follows.□D(ρSkφ,ρSkψ)is obtained as the supremum over admissible pairs ofd(ρred(l→,b→)Skφ,ρred(l→,b→)Skψ)(with the obvious change for the reduced rank invariants). Let us fix a particular pair(l→,b→)∈Admk. It is obvious from definitions thatred(l→,b→)Skφ(v)=S1(red(l→,b→)φ)(v)=red(l→,b→)φ(v)for allv∈V(K). Now,S1(red(l→,b→)φ)(wj)⩾red(l→,b→)Skφ(wj)=minilimaxi(mi,0-bi)/li,j=0,1.However, the appearance ofw0andw1in the sublevel filtration for the functionred(l→,b→)Skφbefore their appearance for the functionS1(red(l→,b→)φ)does not affect their rank invariants of order 1 or greater, which will be identical. This along with Theorem 2.5 and the application of linear interpolation tored(l→,b→)φandred(l→,b→)ψallows us to show thatdρ̃red(l→,b→)Skφq+1,ρ̃red(l→,b→)Skψq+1=dρ̃S1(red(l→,b→)φ)q+1,ρ̃S1(red(l→,b→)ψ)q+1=dρ̃red(l→,b→)φq,ρ̃red(l→,b→)ψq,q⩾0,dρred(l→,b→)Skφq+1,ρred(l→,b→)Skψq+1=dρS1(red(l→,b→)φ)q+1,ρS1(red(l→,b→)ψ)q+1=dρred(l→,b→)φq,ρred(l→,b→)ψq,q⩾1,anddρred(l→,b→)Skφ1,ρred(l→,b→)Skψ1=dρS1(red(l→,b→)φ)1,ρS1(red(l→,b→)ψ)1⩽dρred(l→,b→)φ0,ρred(l→,b→)ψ0,yielding formulas (14)–(16).□

@&#CONCLUSIONS@&#
