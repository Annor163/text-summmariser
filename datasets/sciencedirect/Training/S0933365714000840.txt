@&#MAIN-TITLE@&#
Optimization of anemia treatment in hemodialysis patients via reinforcement learning

@&#HIGHLIGHTS@&#
We use batch reinforcement learning for optimizing the treatment of renal anemia.The proposed method learns optimal treatments from medical records.A standard dose adjustment protocol is compared with the learned policy.Treatments are tailored according to the patients’ characteristics.

@&#KEYPHRASES@&#
Reinforcement learning,Markov decision processes,Fitted Q iteration,Chronic kidney disease,Renal anemia,Darbepoietin alfa,

@&#ABSTRACT@&#
ObjectiveAnemia is a frequent comorbidity in hemodialysis patients that can be successfully treated by administering erythropoiesis-stimulating agents (ESAs). ESAs dosing is currently based on clinical protocols that often do not account for the high inter- and intra-individual variability in the patient's response. As a result, the hemoglobin level of some patients oscillates around the target range, which is associated with multiple risks and side-effects. This work proposes a methodology based on reinforcement learning (RL) to optimize ESA therapy.MethodsRL is a data-driven approach for solving sequential decision-making problems that are formulated as Markov decision processes (MDPs). Computing optimal drug administration strategies for chronic diseases is a sequential decision-making problem in which the goal is to find the best sequence of drug doses. MDPs are particularly suitable for modeling these problems due to their ability to capture the uncertainty associated with the outcome of the treatment and the stochastic nature of the underlying process. The RL algorithm employed in the proposed methodology is fitted Q iteration, which stands out for its ability to make an efficient use of data.ResultsThe experiments reported here are based on a computational model that describes the effect of ESAs on the hemoglobin level. The performance of the proposed method is evaluated and compared with the well-known Q-learning algorithm and with a standard protocol. Simulation results show that the performance of Q-learning is substantially lower than FQI and the protocol. When comparing FQI and the protocol, FQI achieves an increment of 27.6% in the proportion of patients that are within the targeted range of hemoglobin during the period of treatment. In addition, the quantity of drug needed is reduced by 5.13%, which indicates a more efficient use of ESAs.ConclusionAlthough prospective validation is required, promising results demonstrate the potential of RL to become an alternative to current protocols.

@&#INTRODUCTION@&#
Anemia is a common complication characterized by a reduced concentration of hemoglobin (Hb) that occurs in over 90% of patients undergoing hemodialysis [1]. Hemodialysis is the most common treatment for patients in advanced stages of chronic kidney disease (CKD), particularly in its end state, commonly referred as end-stage renal disease (ESRD). In the last years the prevalence of ESRD has increased substantially, reaching more than 1000 per million population in most of the developed countries [2]. In some countries, such as USA and Japan, the current prevalence is over 2000 per million [2]. ESRD involves a gradual loss of kidney function over time, which produces, among other health problems, a poor production of erythropoietin (EPO). This hormone regulates the red blood cell (RBC) production, a class of cells rich in Hb. Low Hb levels are associated with heart disease, poorer overall quality of life, and increased mortality [3,4].Current standard treatment of anemia consists mainly of the administration of erythropoiesis-stimulating agents (ESAs). The response to this kind of drugs is known to have a large inter- and intra-interindividual variability due to differences in background characteristics, disease severity, comorbidities and concurrent medications [5,6]. Although there exist protocols to help physicians determine the appropriate dose, achieving stable Hb levels within the target range can be complex and often requires dose titration. Results from several studies suggest that a phenomenon known as Hb cycling is a common occurrence in ESA-treated patients [7,8]. Hb cycling is defined as the cyclical, repeated, up and down movement of Hb levels during ESA treatment. The exact causes of Hb cycling are not yet completely understood; however, a number of possible reasons have been proposed. Fishbane and Berns [9] suggested two ESA management practices as major causes. First, the use of rigid dose adjustment protocols that do not account for the high heterogeneity in patient response. Second, narrow Hb target ranges recommended in clinical guidelines [10,11], which need frequent dose changes. The effect of an ESA dose change does not reach a steady state until 70–120 days (RBC lifespan). When doses are changed frequently, it is difficult to take into account the long-term effects of each dose, and often they are ignored [12,13]. The link between Hb cycling and the development of several diseases [7] together with the high cost of the treatment (e.g., around $2.3 billions per year in USA [2]) justifies the need to improve current protocols.The widespread use of electronic medical records is giving rise to large amounts of data that could be useful to reduce medical errors, improve treatments and minimize side effects and costs [14]. This work proposes a methodology based on reinforcement learning (RL) to optimize ESA therapy. RL is a data-driven approach for solving sequential decision-making problems that are formulated as Markov decision processes (MDPs) [15]. Computing optimal drug administration strategies for chronic diseases is a sequential decision-making problem in which the goal is to find the best sequence of drug doses. MDPs are particularly suitable for modeling these problems due to their ability to capture the uncertainty associated with the outcome of the treatment and the stochastic nature of the underlying process [16–18]. The standard approach to solve MDPs is dynamic programming (DP); however, the practical application of DP is limited because it cannot deal with large-scale problems and requires full knowledge of the MDP model, including the transition probability function. In contrast, RL (also known as approximate dynamic programming (ADP)) uses function approximation to address large-scale problems and the data sampled from the process to implicitly represent the transition function [19]. RL can exploit the information contained in medical records to compute policies of ESA administration tailored to the individual characteristics of each patient. In addition, the optimization process is made over sequences of doses instead of isolated doses, which is crucial to include the drug long-term effects.The methodology proposed in this work uses the algorithm fitted Q iteration to learn a policy of ESA administration from a set of medical records. The features employed to define the MDP model are extracted in part from the laboratory tests and in part from a clustering procedure of the patient's main attributes. In order to test the methodology, a series of experiments has been conducted using a computational model that simulates the response of the patients. The performance has been assessed against the algorithm Q-learning and a standard protocol of dose adjustment.The rest of the paper is organized as follows. Next section provides a brief review of related work in this domain. Section 3 introduces the necessary background in RL and briefly explains the algorithms employed in the experiments, namely, Q-learning and fitted Q iteration. The latter algorithm makes use of extremely randomized trees, a supervised learning method that is described in Section 4. Section 5 discusses the computational model used in the experiments to simulate patients’ response to ESA. Anemia management formulation using the MDP framework is presented in Section 6. Experiments carried out are detailed in Section 7. Section 8 shows and discusses the achieved results. Finally, conclusions and proposals for further work are given in Section 9.

@&#CONCLUSIONS@&#
This work has proposed a methodology based on RL to optimize anemia treatment in hemodialysis patients. After formulating the problem using the MDP framework, RL was able to learn automatically near-optimal treatments from clinical data. Contrary to other techniques to solve MPDs, RL does not require a complete knowledge of the system dynamics, a feature that can be crucial in medical problems. More specifically, the methodology uses the algorithm FQI, which stands out for its ability to make an efficient use of data. FQI was combined with a function approximator based on regression trees in order to deal with the continuous state space and to generalize the learned policy to the cases not covered by the data set. The state variables of the MDP were extracted partly from the laboratory tests and partly from a clustering analysis of the patient's main attributes.The proposed methodology was evaluated through a computational model that describes the effect of darbepoetin alfa on the concentration of Hb. In addition to FQI, the experiments were also performed using the well-known Q-learning algorithm. A standard protocol of dose adjustment was used for baseline comparison. The quality of the policy obtained with Q-learning, πQ-learningwas considerably inferior in comparison to the other two policies (πFQIand πprotocol). When comparing πFQIand πprotocol, the policy obtained with FQI increased by 27.6% the proportion of patients with an adequate level of Hb and, at the same time, it reduced the amount of drug used by 5.13%.The simulation results suggest that the FQI policy can deal with the long-term effects of darbepoetin alfa and the high variability in the patient's response. These features, which are absent in standard dosing protocols, had been suggested as a major cause of Hb cycling. As a result, the proposed methodology was more effective than the standard-use tested protocol in maintaining stable Hb levels and preventing Hb cycling. On the other hand, the drug is prescribed in a more efficient way since the treatment achieves better outcomes with less amount of darbepoetin alfa.The computational model used in the experiments has several limitations owing to the assumptions on which it is grounded and, therefore, does not represent all possible patients. Nevertheless, it reproduces some important difficulties present in actual cases that may cause Hb cycling. Thus, although prospective validation is required, experiments have shown the potential benefits of RL in anemia treatment.The positive results obtained in this work using simulated patients have motivated further research in applying the proposed methodology to actual patients. Currently, a tool for clinical decision support based on FQI is being validated through a clinical evaluation in five hemodialysis centers from three European countries.Although this work has been focused in renal anemia, the methodology can be extended to other types of anemia. For example, oncology patients who also receive darbepoetin alfa treatment, or even to other complex problems of drug administration such as warfarin therapy to prevent venous thromboembolism. Another interesting line of future research is to include other optimization aspects in the reward function, in addition to those related to the patients’ health, like the cost of the treatment.