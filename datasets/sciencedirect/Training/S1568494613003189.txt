@&#MAIN-TITLE@&#
Fault detection and identification spanning multiple processes by integrating PCA with neural network

@&#HIGHLIGHTS@&#
A comprehensive model is proposed for quick and accurate fault detection and identification in health monitoring.A principal component analysis scheme is designed to reduce dimensionality of data collected by COSMED K4b2 and improve efficiency in data transmission.A new method which combines the K-means clustering and artificial neural networks is developed to classify data and accurately detect and isolate faults.The mechanism provides the feasibility and increases the efficiency of the fault detection and identification for a system with multiple processes.

@&#KEYPHRASES@&#
BP neural network,Exercising monitoring,Fault detection and identification,Principal component analysis,

@&#ABSTRACT@&#
This paper proposes an effective fault detection and identification method for systems which perform in multiple processes. One such type of system investigated in this paper is COSMED K4b2. K4b2 is a standard portable electrical device designed to test pulmonary functions in various applications, such as athlete training, sports medicine and health monitoring. However, its actual sensor outputs and received data may be disturbed by Electromagnetic Interference (EMI), body artifacts, and device malfunctions/faults, which might cause misinterpretations of activities or statuses to people being monitored. Although some research is reported to detect faults in specific steady state, normal approach may yield false alarms in multi-processes applications. In this paper, a novel and comprehensive method, which merges statistical analysis and intelligent computational model, is proposed to detect and identify faults of K4b2 during exercise monitoring. Firstly the principal component analysis (PCA) is utilized to acquire main features of measured data and then K-means is combined to cluster various processes for abnormalities detection. When faults are detected, a back propagation (BP) neural network is constructed to identify and isolate faults. The effectiveness and feasibility of the proposed model method is finally verified with experimental data.

@&#INTRODUCTION@&#
Cardio-respiratory parameters, such as oxygen consumption rate, carbon dioxide production rate and heart beat are major indicators for the evaluation of human's physical status and sports performances [1–5]. These parameters are traditionally tested by indirect calorimeter with a metabolic cart. However, most metabolic carts are restricted in laboratories due to their size and weight limitations. Although many activities can be simulated in the laboratory (e.g. walking on a treadmill), some activities involving in occupational, recreational activities and health monitoring are not available in the laboratory. Using heavy equipments to collect expired air in fields can often disturb activities under investigation. Because of the improvement of miniaturized metabolic measurement systems oxygen consumption can be measured in real circumstances by small gadgets. Recently lightweight, portable telemetric gas analysis systems are used to acquire parameters in daily activities or sports for further analysis.Among several gas analysis devices COSMED K4b2 metabolic measurement system is a typical and popular instrument. It is designed to measure parameters of ventilatory, oxygen consumption and carbon dioxide production with several sensors such as flow meter, oxygen sensor, carbon dioxide sensor, environmental sensor and so on [6–9]. This system is one of the latest portable devices for cardiopulmonary gas exchange analysis base on true breath-by-breath without limitation. Along with the widely usage of COSMED K4b2, the reliability is very crucial for measurement in metabolic testing or health monitoring. R Duffield assessed the validity and reliability of a COSMED K4b2 portable telemetric gas analysis system by experiments and reliability is formed in specific steady state and sustained exercise [10]. However, in free living environment, the sensor outputs and data received by base station may be abnormal, which can be caused by impulsive noise, low batteries or environment interference. These abnormal data might cause misinterpretations of exercises or living activities and lead to unreliable results. Although some methods are available to detect faults, normal approach may yield false alarms for multi-processes applications especially for wireless transmission. Therefore, an effective and feasible method is necessary to detect abnormal situation and identify faults in multi-statuses for monitoring.In this paper, a novel fault detection and identification method is proposed for systems performing in multiple processes by optimally integrating principal component analysis (PCA) [11], K-means [12] and neural networks [13]. Firstly, the PCA is used to detect the potential faults. At the same time, it decreases the dimension of the data set so that the energy consumption in transmission is consequently reduced. Thereafter, in the reduced data space, K-means is applied to cluster data into different groups and detect faults with statistic criteria. Then a neural network is constructed and trained to identify faulty by reconstruction. Based on real data experiments and simulations it is demonstrated that the proposed fault detection and identification (FDI) method is able to correctly detect and identify faults.The main contributions of this paper exist in three aspects: (1) It applies the dimension reducing technique to decrease energy consumption in transmission which is very important in wireless body sensors networks; (2) With clustering it can correctly detect faults in different processes which is usually ignored in traditional model; (3) This model works beyond fault detection and it can identify crashed sensors according to measured data.The remaining sections of this paper are presented as follows: Section 2 introduces the portable medical device: COSMED K4b2. Section 3 explains the principles of PCA and K-means for clustering and fault detection. In Section 4 the back propagation (BP) neural networks for prediction is outlined. Section 5 verifies the FDI model with demonstration of experimental results. Section 6 makes a conclusion.A K4b2 system is a COSMED portable medical instrument used for testing of pulmonary functions. It can be worn by people during activities and is capable of delivering real-time measurements into a PC base station. Due to its convenience, it is applied in many fields such as: sports medicine research, gait lab, occupational health, cardiology, cardiac rehabilitation, clinical nutrition and so on. It can measure physiological response to exercise in the field without limitation. This telemetric gas analysis system contains a soft, flexible face mask to sample expired air and a sensor unit to test ventilation (VE), oxygen (O2) and carbon dioxide (CO2) concentrations in the expired air [14]. These measurements represent energy cost of activities and are highly correlated. So it is available to extract main principal components for reducing transmission amount. The meaning of measured symbols of K4b2 in breath by breath exercise testing are showed in Table 1[6].PCA is often used to transform multivariable space into a subspace which preserves maximum variance of the original space in minimum dimensions [15]. The measured process variables are usually correlated to each other. The measured process variables are usually correlated to each other and data can be disposed into the significant patterns. Then the abnormalities, such as noises or outliers in residual subspace can be identified. PCA transforms the original correlated data into a new set of uncorrelated data set that represent the trend of the process. It is highly useful in analyzing state data which contains relationships between variables. It is proved successfully in many applications such as reducing dimensionality, data compression, and fault detection [16–20].In normal condition, the PCA is established with a collected n×m data matrix, where n is the number of samples and m is the number of variables. This matrix must be standardized asX¯to eliminate different units’ effects of variables. Then the covariance matrix is constructed as Eq. (1):(1)R=1n−1X¯TX¯And then perform the SVD (Single Variable decomposition) on R:(2)R=UDλUTwhere Um×mis a unitary matrix, and Dλ=diag(λ1, λ2, …, λn) is a diagonal matrix contains the eigenvalues of R sorted in decreasing order (λ1>λ2>…>λn). The transformation matrix P∈Rn×kis generated by choosing k eigenvectors. Matrix P transforms the space of measured variables into reduced dimension space. Elements of T, called as scores, are calculated by columns of matrix P.(3)T=XPScores are values of original measured variables that have been transformed into the reduced dimension space.The subspace, which is formed with the first k (k<n) vectors without correlation, is called principal component subspaceSˆ=[u1,u2,…,uk]. Another subspace, which is formed with the n–k vectorsS˜=[uk+1,uk+2,…,un]are called residual subspaceS˜. So the database X with m dimensions is replaced by the principal subspaceS˜with k dimension and the residual subspaceS˜with n–k dimension, whereXˆ=TPT,E=X−Xˆ. At last raw data space X can be calculated as:(4)X=TPT+Ewhere TPT represents the principal elements of variability in the process and E stands for the variability related to the process noise. It is critical to select the number of principal components. The popular method for choosing components is Cumulative Percent Variance (CPV) approach. It captures the CPV(i)≥90% by the first k principal components:(5)CPV(i)=∑i=1kλi∑j=1nλj−1The square prediction error (SPE), also known as Q, indicates the difference, or residual, between a sample and its objects into the k components in the model [21,22]. The SPE value is used as the main criterion for fault detection because training data are multivariate normal in the feature space. The formulation description of SPE distribution is mathematically given as:(6)SPE=XT(I−PPT)The upper limit of this statistic can be computed as the next equation:(7)δα2=θ1cα2θ2h02θ1+1+θ2h0(h0−1)θ21/h0Subject to:θ1=∑j=k+1mλj,θ2=∑j=k+1mλj2,h0=1−(2θ1θ3/3θ22)where Cαis the value of the normal distribution with the level of significance. IfSPE>δα2, it means the serious deviation has occurred. So when an abnormality occurs and it causes a change in the covariance structure of the model, it will be judged by a high value of SPE to detect the fault.K-Means clustering is an algorithm to classify or to group objects based on attributes or similarities into K groups [23–25]. K is a positive integer number and the grouping is done by minimizing the sum of squares of distances between data and the corresponding cluster centroid. Thus, it is effective to separate the different process modes. The process is described as follows:1.Choose K initial cluster centroids {z1, z2, …, zK} randomly from the n points {x1, x2, …, xn}.Assign point xi, i=1, 2,…, n to cluster Cj∈{1, 2, …, K}, if D(Zj, xi)<D(Zp, xi), p=1, 2,…, K, and j≠p, ties are resolved arbitrarily.Compute new cluster centroids,Z1*,Z2*,…,ZK*as follows:(8)Zi*=1ni∑xj∈Cixj,i=1,2,…,Kwhere niis the number of elements belonging to cluster Ci.IfZi*=Zi, i=1, 2,…, K, then terminate. Otherwise continue from Step 2.K-Means clustering minimizes the global cluster variance J to maximize the compactness of the clusters. The global cluster variance J can be represented as(9)J=∑K=1K∑xj∈CKD2(ZK,xj)Note that if the process does not terminate at Step 4 normally, then it is executed for a maximum fixed number of iterations [26].In this article, firstly acquired values are transferred by PCA into another subspace where K-means can be applied efficiently. Data must be classified to specific process to avoid false alarm and SPE is used as the main criterion for fault detection. If the SPE is within the threshold, then data are considered normal. Otherwise it means faults occurrence and further approaches will be executed.An artificial neural network (ANN) is a mathematical model to simulate some behaviors of biological nervous systems [13]. Each neural network has three critical components: Neurons, network topology and learning rules. Neurons determine how signals are processed and connected together with weights so that they can deal with information collaboratively. Network topology determines the ways nodes are organized and connected. Learning rules determine how the weights are initialized and adjusted. ANNs have been used for time series prediction, pattern recognition, and fault diagnosis [27–29]. The back propagation learning algorithm is one of the most popular ANN for practical applications [30,31]. It is a useful model for prediction and forecasting proved by many researches. For example, Jiantao Liu used a BP artificial neural network to predict the flow stress of high-speed steel during hot deformation [32]. Yong Wang presents an accurate electricity load forecasting algorithm with back propagation neural networks [33]. So we apply a BP neural network for fault reconstruction based on predicted values.A BP neural network is one feed forward neural network, in which neurons are arranged in layers, and each neuron can be connected only with the neurons in the next layer. BP neural networks are trained by a supervised learning algorithm. An error back-propagation algorithm is an iterative procedure typically used to train a BP neural network. Specifically, the process modifies the weights in the network in an iterative method so that the resulting network fits the training data well. A schematic diagram of a single output BP neural network is showed in Fig. 1. This neural network includes three layers: input layer, hidden layer, and output layer. Xj(i) is the output from the ith neuron in the jth layer. The weights, which are called w, denote the layer. For example: W2(3, 1) indicates a weight in the second layer which is connected to x1(3). The number of neurons in the input layer can be set according to actual requirement with historical values for prediction. Calculation for data processing takes place in the hidden layer. The output layer has only one neuron and the value is the predicted result.The entire network learning process includes two phases: the first stage calculates from input layer to output layer. Output can be calculated by training samples with initial structure and weight W; the second stage is modifying weights and threshold. And weights of neurons, which connect to output, can be adjusted according to errors of output. Hidden layer weight can also be modified. The two stages are iterative processes, repeat until convergence. All layers adjust weights by Eq. (10):(10)W(t+1)i=W(t)i+ηδiXjkwhere η is regarded as precision of network learning, which can be used as conditions to judge the network finishing. δiis the value of error and can be defined as(11)δi=yi(1−yi)(di−yi)where yiis the output value and diis the desired output.Due to the correlation of variables measured with K4b2, PCA can be used for fault detection. But in health and exercising monitoring people usually behave at different status, such as walking, running or swimming. Classical PCA may fail to extract correction across different activities and then detect excessive faults or miss faults because grade transitions from one to another status can break the correlation between variables. Therefore it is necessary to design a feasible model to detect faults for multiple processes applications. The proposed model of multiple processes FDI is showed in Fig. 2.Firstly data are acquired and then PCA is implemented to transform original data to subspace with extraction of main features. Consequently energy consumption is reduced in wireless transmission because only main components are transferred. Then K-means with setting reference patterns are adopted to judge various processes. Threshold of SPE is calculated in each process to detect abnormalities. If faults are captured a trained BP neural network is used to predict values for error reconstruction and identification. The whole procedure of FDI is outlined as the following steps:The first step: Acquire validated data which represents normal process operations; carry out SVD to transform data for a PCA model; determine the number of principal components and build reference patterns with K-means.The second step: Transmit main features of data, and implement the process judgment by reference patterns.The third step: Evaluate SPE statistics with comparing with the threshold obtained by PCA model. If the value exceeds the threshold then go to step four. Otherwise go back to obtain new data.The forth step: When a fault is detected the trained BP neural network is applied to reconstruct the possible value based on the previous measured value.The fifth step: Compare the reconstructed data with real sampled data and identify faults. If the fault is transient, replace it with the reconstructed data. Otherwise set alarm and identify fault sensors.In order to verify the whole procedure of this FDI model we use datasets measured in UTS laboratory for exercise monitoring. A K4b2 system measures physical values of a person such as VO2, VCO2, FetO2, VE, HR and etc. The data samples in five separate time points are showed in Table 2. We used 22 recorded values, which demonstrate tidal volume of each breath (VT), averaged expiratory concentration of O2 and CO2, oxygen uptake (VO2), carbon dioxide production (VCO2), and minute ventilation (VE), heart rate (HR) and so on. For example VO2 is calculated as the volume of inspired O2 minus the volume of expired O2 and the measurement at rest and during exercise increases abruptly. These parameters are necessary for pulmonary gas exchange measurement and acquired the feature matrix U by PCA analysis. The eigenvalues Uiand corresponding eigenvectors V of the covariance matrix C of training samples X are obtained, and ordered decreasingly. The first k eigenvectors are packed to form the feature matrix base on Eq. (5). A calculation based on CPV reveals the principal components represent the high portion of data, which is clearly shown in Table 3with the main eigenvalues and the proportion of each eigenvalue in total data.From this table we can clearly notice that the first two eigenvalues can represent approximately 99% of the total data. They are suitable for fault detection but not ideal for clustering so we take the first three principal components and use corresponding scores as parameters for further analysis.Experiment 1: In an experiment a person walks and runs with a K4b2 in specific time and real data are acquired for indoor exercising monitoring. We select some validated data to illustrate the method. If we do not separate two processes and evaluate all samples together with PCA, the result of excessive faults is achieved and shown in Fig. 3which incorrectly interpret collected data because PCA does not get the right correlation along different periods. The green line value is calculated by Eq. (7) and used as the threshold for abnormal data in Figs. 3, 5–7. The red lines represent the SPE value acquired based on Eq. (6). It means classical PCA detect excessive fault due to the status transition. Then we use K-means to cluster data by three principal components as shown in Fig. 4. It shows samples as blue spots can be classified into two groups at the 130th spot which is corresponded to the real scenarios in our experiments. Then we divide data into two isolated processes and implement the fault identification with distinct SPE again. These data in each process are detected normal as shown in Figs. 5 and 6respectively because they have different properties of correlation in different activities. Therefore using clustering is necessary for faults detection in multi-processes monitoring.Experiment 2: Then we apply this FDI method in new samples, which contains right data and wrong data in the specific period. Firstly data are classified to different process they belong to with K-means based on reference patterns. As we see in Fig. 7SPE increases abruptly and keeps this status from the 67th sampling point according to the calculated threshold. It means faults occur at that time and are permanent errors in this process. This result is consistent with the predesigned condition in real situation. It shows faults are correctly detected and the detection accuracy is guaranteed.Usually detecting faults is not enough for reliability and it is essential to find which sensors break or crash if there are permanent faults. In order to identify fault sensors we construct a BP neural network for prediction and identification. The network has one input-layer with 10 neurons, one hidden-layer neurons with 12 neurons, and one output-layer with a neuron. The transfer function of the hidden layer is sigmoid and output layer is linear respectively. The following steps are executed to train for reliable prediction:(1)Train the neural network using 10 continuous normal samples as the input data and the corresponding expected output data.Compute the error of the network by given corresponding output data. Then, propagate the error backward to the input layer. In this error back-propagation process, the weights on connections are changed to reduce the error. These steps will be repeated until the network error is small. A trained BP neural network is showed in Fig. 8.In the training process, we input real values, which are acquired from 10 consistent steps before the fault sampling point. A predicated value is generated with the trained BP neural network for fault reconstruction. We compare the predicted data with the fault samples and recognize that O2 related parameters such as VO2, FeO2 are abnormal as illustrate in Fig. 9with different colorful symbols for measured data and predicated data (Numbers in Fig. 9 represent 22 measured parameters). These parameters are collected by the oxygen sensor in K4b2. While we use the reconstruction data to replace the detected values, the faulty signs disappear as shown in Fig. 10. Therefore this sensor is indicated as malfunction from the 67th sampling moment. If the fault is transient and recovers quickly, we assume it is temporally interfered. If the errors are continuous and several related values are all bias we can accurately determine the faulty sensor and isolate it consequently. At the same time the alarm information is set for further action.

@&#CONCLUSIONS@&#
