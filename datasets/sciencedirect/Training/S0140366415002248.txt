@&#MAIN-TITLE@&#
SF-DRDoS: The store-and-flood distributed reflective denial of service attack

@&#HIGHLIGHTS@&#
We propose a novel reflective amplification DDoS attack called store-and-flood DRDoS.SF-DRDoS gains a high amplification factor by storing prepared data on reflectors.We implement prototypes on two Kademlia networks, Kad and BT-DHT.Real-world experiments achieves an average amplification factor of 2400 in Kad.The upper bound of attack bandwidth could be 670 Gbps and 10 Tbps for Kad and BTDHT.

@&#KEYPHRASES@&#
DDoS,DRDoS,Amplification factor,Kademlia,Store-and-flood,

@&#ABSTRACT@&#
Distributed reflective denial of service (DRDoS) attacks, especially those based on UDP reflection and amplification, can generate hundreds of gigabits per second of attack traffic, and have become a significant threat to Internet security. In this paper we show that an attacker can further make the DRDoS attack more dangerous. In particular, we describe a new DRDoS attack called store-and-flood DRDoS, or SF-DRDoS, which leverages peer-to-peer (P2P) file-sharing networks. An attacker can store carefully prepared data on reflector nodes before the flooding phase, to greatly increase the amplification factor of an attack. In this way, SF-DRDoS is more surreptitious and powerful than traditional DRDoS. We present two prototype SF-DRDoS attacks on two popular Kademlia-based P2P file-sharing networks, Kad and BT-DHT. Experiments in real-world environments showed that, this attack can achieve an amplification factor of 2400 on average in Kad, and reach an upper bound of attack bandwidth at 670 Gbps and 10 Tbps for Kad and BT-DHT, respectively. We also propose some candidate defenses to mitigate the SF-DRDoS threat.

@&#INTRODUCTION@&#
While distributed denial of service (DDoS) attacks have posed a significant threat to Internet security for many years, recently distributed reflective denial of service (DRDoS) attacks have become prevalent and received a lot of attention due to their severity. For example, CloudFlare observed a UDP-based DRDoS attack [1] in February 2014, which generated over 400 Gbps attack traffic through NTP amplification, targeting a French hosting provider. This attack is one of the largest DDoS attacks in history, with a tremendous traffic volume that could bring down virtually any service on today’s Internet.In a typical DRDoS attack, the attacker first sends many requests with a spoofed source IP address (i.e., the victim’s address) to intermediate nodes (i.e., reflectors), which in turn reply with numerous and often voluminous responses to the spoofed IP, thereby flooding the victim. Two key metrics for measuring the severity of a DRDoS attack are amplification factor (AF) and attack ability. The amplification factor is the ratio between the traffic volume of response packets and that of request packets, reflecting the resource cost ratio between attackers and victims. The attack ability is the absolute amount of attack traffic launched toward the victim. Please note that reflectors are usually meant to provide a legitimate service and can hardly realize that they are being exploited to produce a large attack traffic.Unfortunately, DRDoS attacks can be even more dangerous than expected. In particular, we notice in our recent studies that peer-to-peer (P2P) file-sharing applications can be leveraged to conduct more powerful UDP-based DRDoS attacks. We observe three features that make P2P applications particularly attractive for DRDoS attacks: (i) P2P applications use UDP messages frequently, such as the index services provided by Distributed hash tables (DHT [2]), making IP address spoofing easy to perform. (ii) All P2P users can freely access and store various data on other nodes in a P2P network, making almost all nodes in the P2P network perfect candidates for DRDoS reflectors. (iii) P2P applications often have a huge user base. At present, the user population of popular P2P file-sharing applications, such as Kad [3] and BitTorent [4], are over millions [5,6].In this paper, we present a new type of DRDoS attack called store-and-flood DRDoS attack, or SF-DRDoS. The most notable characteristic of SF-DRDoS is that an adversary prepares and stores carefully crafted data on reflector nodes before issuing spoofed requests to reflector nodes and flooding the victim. This strategy can yield a much higher AF than previously explored DRDoS approaches [7]. The adversary can further adjust the timing, content, and in particular the volume of the responses.Furthermore, we present a prototype SF-DRDoS attack system based on two popular Kademlia-based [8] P2P file-sharing networks, Kad and BT-DHT. The prototype system consists of a crawler to crawl the network, a node group to store index entries, and another node group to flood the victim. We investigate various factors that may affect the ability of the attack, and build a model to help illustrate the relationship between the attacker’s bandwidth cost, the reflectors’ response sizes, and the AF.We further conducted real-world experiments to evaluate the effectiveness and flexibility of SF-DRDoS attacks, and found the average AF in the Kad network is about 2400, much higher than the AF achieved by current DRDoS attacks. The peak AF can reach 4326, making it possible to use only a 205 Kbps bandwidth to generate an attack flow of about 865 Mbps. If an attacker had enough bots, it could initiate an attack that costs only about 280 Mbps to generate a SF-DRDoS attack of more than 670 Gbps. Meanwhile, the average AF in BT-DHT networks is approximately 7. But due to BT-DHT’s loose flow control mechanism and its huge user base (more than 16 million), the damage of this attack is much more terrible than expected, which can achieve a SF-DRDoS attack of over 10 Tbps.Finally, we propose defense solutions to filter out the attack traffic generated by SF-DRDoS attacks. It is worth noting that, the attacker obeys the specifications of P2P networks and the attack traffic has no specific characteristics to be distinguished from legitimate traffic, making the defense very challenging. Our proposed defenses are based on BGP flow specification [9], and are able to filter attack traffic at the upstream links.The rest of the paper is organized as follows. We first describe the DRDoS attack and discuss related work in Section 2. We then describe how a SF-DRDoS attack works in general in Section 3, and introduce the Kad-based and BT-DHT-based SF-DRDoS attacks in Sections 4 and5, respectively. Section 6 presents the real-world experiments of SF-DRDoS attacks. We then discuss defenses against SF-DRDoS attacks in Section 7, discuss several observations in Section 8, and conclude the paper in Section 9.Fig. 1illustrates the working mechanism of a DRDoS attack. Because the victim can only see that the attack traffic coming from reflectors, the attacker is difficult to locate. To conduct an effective DRDoS attack, the following conditions should be met:•The transport protocol should be stateless and lack authentication so that the attacker can use spoofed IP addresses in their requests. Otherwise, the potential reflectors cannot be fooled into sending responses to the victim.There should be abundant reflectors that are open to all Internet users. Insufficient availability of reflectors caps the attack ability. For example, there are more than 27 million open DNS resolvers on the Internet that can be misused as reflectors [10].Some requests should trigger large responses according to the communication protocol in place, thus enabling amplification. Otherwise, the attack ability will be reduced to that of a non-reflective attack or even lower.Also desirable for attackers are protocols which are difficult to filter, such as those using non-fixed UDP ports or that encrypt or obfuscate messages by default.

@&#CONCLUSIONS@&#
