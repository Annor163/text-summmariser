@&#MAIN-TITLE@&#
Brain morphometry on congenital hand deformities based on Teichmüller space theory

@&#HIGHLIGHTS@&#
We propose a novel Teichmüller space theory approach to study brain morphometry.Conformal welding signature reflects the geometric relations of different regions.The invertible method encodes complete information of the functional area boundaries.We evaluate signatures of pre-central and post-central gyrus on subjects and control.Congenital Hand Deformities may make a greater impact on post-central gyrus.

@&#KEYPHRASES@&#
Congenital hand deformities,Brain morphometry,Surface Ricci flow,Teichmüller space theory,Brain MRI,

@&#ABSTRACT@&#
Congenital Hand Deformities (CHD) usually occurred between the fourth and the eighth week after the embryo is formed. Failure of the transformation from arm bud cells to upper limb can lead to an abnormal appearing/functioning upper extremity which is presented at birth. Some causes are linked to genetics while others are affected by the environment, and the rest have remained unknown. CHD patients develop prehension through the use of their hands, which affects the brain as time passes. In recent years, CHD have gained increasing attention and researches have been conducted on CHD, both surgically and psychologically. However, the impacts of CHD on the brain structure are not well-understood so far. Here, we propose a novel approach to apply Teichmüller space theory and conformal welding method to study brain morphometry in CHD patients. Conformal welding signature reflects the geometric relations among different functional areas on the cortex surface, which is intrinsic to the Riemannian metric, invariant under conformal deformation, and encodes complete information of the functional area boundaries. The computational algorithm is based on discrete surface Ricci flow, which has theoretic guarantees for the existence and uniqueness of the solutions. In practice, discrete Ricci flow is equivalent to a convex optimization problem, therefore has high numerically stability. In this paper, we compute the signatures of contours on general 3D surfaces with the surface Ricci flow method, which encodes both global and local surface contour information. Then we evaluated the signatures of pre-central and post-central gyrus on healthy control and CHD subjects for analyzing brain cortical morphometry. Preliminary experimental results from 3D MRI data of CHD/control data demonstrate the effectiveness of our method. The statistical comparison between left and right brain gives us a better understanding on brain morphometry of subjects with Congenital Hand Deformities, in particular, missing the distal part of the upper limb.

@&#INTRODUCTION@&#
Congenital anomalies affect 1%–2% of newborns, and approximately 10% of those children have hand abnormalities  [1,2]. Congenital hand deformities (CHD) usually occurred between the fourth and the eighth week after the embryo is formed  [3]. Failure of the transformation from arm bud cells to upper limb can result in an abnormal appearing/functioning upper extremity which is presented at birth. Some causes are linked to genetics while others are affected by the environment—either outside or inside the uterus, and the rest has remained unknown.CHD are present at birth and may become a challenge for children as they continue to grow and learn to interact with their environment through the use of their hands. The degree of deformity can vary from something minor, such as a digital disproportion, to a more severe deformity, such as total absence of a bone or part of the hand. Children develop prehension with hands as they are, and they usually start being self-conscious of the difference when they socialize in school, as a result, they may intend not to show or use it. The less the affected arm and hand are used, the less functional they will be, and the more likely it will affect functionalities of brain. In recent years, a number of researches have been conducted on mechanism, behaviors and psychology for CHD  [4–7]. However, the impacts of CHD on brain structure are not well-understood so far.Most brain MRI scanning protocols acquire volumetric data about the anatomy of the subject. Early researches  [8,9] have demonstrated that surface-based brain mapping may offer advantages over volume-based brain mapping work  [10] to study structural features of the brain, such as cortical gray matter thickness, complexity, and patterns of brain change over time due to disease or developmental processes. In research studies that analyze brain morphology, many surface-based shape analysis methods have been proposed, such as spherical harmonic analysis (SPHARM) [11,12], minimum description length approaches  [13], medial representations (M-reps)  [14], cortical gyrification index  [15], shape space  [16], metamorphosis  [17], momentum maps  [18] and conformal invariants  [19]; these methods may be applied to analyze shape changes or abnormalities in cortical and subcortical brain structures. Even so, a stable method to compute a global intrinsic transformation-invariant shape descriptors would be highly advantageous in this research field.Here, we propose a novel and intrinsic method to compute the global correlations between various surface region contours in Teichmüller space and apply it to study brain morphology on CHD. The proposed shape signature demonstrates the global geometric features encoded in the interested regions, as a biomarker for measurements of CHD progression and pathology. It is based on the brain surface conformal structure  [20–23] and can be accurately computed using the surface Ricci flow method  [24,25].For a 3D surface, all the contours represent the ‘shape’ of the surface. Inspired by the research work of Sharon and Mumford  [26] on 2D shape analysis (recently it has been generalized to model multiple 2D contours  [27]), we build a Teichmüller space for 3D shapes by using conformal mappings. In this Teichmüller space, every 3D contour (a simple closed curve) is represented by a point in the space; each point denotes a unique equivalence class of diffeomorphisms up to a Möbius transformation. For a 3D surface, the diffeomorphisms of all the contours form a global shape representation of the surface. By using this signature, the similarities of 3D shapes can be quantitatively analyzed, therefore, the classification and recognition of 3D objects can be performed from their observed contours.We tested our algorithm in segmented regions on a set of brain left cortical surfaces extracted from 3D anatomical brain MRI scans. The proposed method can reliably compute signatures on two cortical functional areas  [28] by computing the diffeomorphisms of each observed contour. Using the signature as the statistics, our method achieves about 91% accuracy rate to discriminate a set of CHD subjects from healthy control subjects.To the best of our knowledge, it is the first work to apply contour diffeomorphism to brain morphometry research. Our experimental results demonstrated that this novel and simple method may be useful to analyze certain functional areas, and it may shed some light on understanding and detecting abnormality regions in brain surface morphometry. Our major contributions in this work include:(i)A new method to compute Teichmüller shape descriptor, in a way that generalized a prior 2D domain conformal mapping work  [26].The method is theoretically rigorous and general. It presents a stable way to calculate the diffeomorphisms of contours in general 3D surfaces based on Ricci flow.It involves solving elliptic partial differential equations (PDEs), so it is numerically efficient and computationally stable.The shape descriptors are global and invariant to rigid motion and conformal deformations.Pipeline.   Fig. 1shows the pipeline for computing the diffeomorphism signature for a surface with 4 closed contours. Here, we use a human brain hemisphere surface whose functional areas are divided and labeled in different colors. The contours (simple closed curves) of functional areas can be used to slice the surface open to connected patches. As shown in frames (a, b, g), four contoursγ1,γ2,γ3,γ4are used to divide the whole brain (a genus zero surfaceS) to 5 patchesS0,S1,S2,S3,S4;S0is a genus zero surface with four boundaries and thus could be conformally mapped to a disk with one exterior circle and three interior circles, as shown in frame (c). In order to study the correlation of left and right functional areas with respect to the corresponding half brain, we have cut the whole brain surface into two halves,SleftandSrightrespectively. Each ofS1,S2,S3,S4is conformally mapped to a circle domain (e.g., disk or annuli),D1,D2,D3,D4, in (d). Each ofC1,C2,C3,C4in frame (e) is mapped from(Sleft−S1),(Sleft−S2),(Sright−S3),(Sright−S4), the complement ofS1,S2,S3,S4with respect to the corresponding half brain. One contourγi,(i=1,2,3,4)is mapped to two unit circles in two mappings, which are boundaries of two topological disks,DiinandDiout. Technically, outer topological disksDioutare mapped from a topological annulusCi, frame (e). The inner boundary of the annulus forms the circle, while the outer boundary represents the connection between the left and the right half of the brain. The representation of the shape according to each contour is a diffeomorphism of the unit circle to itself, defined as the mapping between periodic polar angles(Anglein,Angleout),Anglein,Angleout∈[0,2π], which is determined only by the target functional area and the corresponding half brain surface. The proper normalization is employed to remove Möbius ambiguity. The diffeomorphisms induced by the conformal maps of each curve form a diffeomorphism signature, which is the Teichmüller coordinates in Teichmüller space. As shown in (f, h), the curves demonstrate the diffeomorphisms for two contours; thel2norm of the area distance is defined as the metric for shape comparison and classification.In this section, we briefly introduce the theoretical foundations necessary for the current work. For more details, we refer readers to the classical books  [29,30].Conformal mapping between two surfaces preserves angles. Suppose(S1,g1)and(S2,g2)are two surfaces embedded inR3,g1andg2are the induced Euclidean metrics.Definition 2.1Conformal MappingA mappingϕ:S1→S2is called conformal, if the pull back metric ofg2induced byϕonS1differs fromg1by a positive scalar function:ϕ∗g2=e2λg1,whereλ:S1→Ris a scalar function, called the conformal factor.For example, all the conformal automorphisms of the unit disk form the Möbius transformation group of the disk, each mapping is given byz→eiθz−z01−z̄0z.All of the conformal automorphism group of the extended complex planeC∪{∞}is also called Möbius transformation group, each mapping is given byz→az+bcz+d,ad−bc=1,a,b,d,c∈C.By stereo-graphic projection, the unit sphere can be conformally mapped to the extended complex plane. Therefore, the Möbius transformation group is also the conformal automorphism group of the unit sphere. SupposeSis a genus zero closed Riemannian surface, then there exists a conformal mappingϕ:S→S2, which mapsSto the unit sphere. Furthermore, all such conformal mappings differ by a Möbius transformation of the sphere.A circle domain on the complex plane is the unit disk with circular holes. A circle domain can be conformally transformed to another circle domain by Möbius transformations,z→eiθz−z01−z̄0z.All genus zero surfaces with boundaries can be conformally mapped to circle domains:Theorem 2.2UniformizationSupposeSis a genus zero Riemannian surface with boundaries, thenScan be conformally mapped onto a circle domain. All such conformal mappings differ by a Möbius transformation on the unit disk.Definition 2.3Conformal EquivalenceSuppose(S1,g1)and(S2,g2)are two Riemannian surfaces. We sayS1andΩ2are conformally equivalent if there is a conformal diffeomorphism between them.All Riemannian surfaces can be classified by the conformal equivalence relation. Each conformal equivalence class shares the same conformal invariants, the so-called conformal module. The conformal module is one of the key components for us to define the unique shape signature.Definition 1Teichmüller SpaceFixing the topology of the surfaces, all the conformal equivalence classes form a manifold, which is called the Teichmüller space.Suppose a genus zero Riemannian surfaceShasnboundary components∂S=γ1+γ2+⋯+γn,ϕ:S→Dis the conformal mapping that mapsSto a circle domainD, such that (a).ϕ(γ1)is the exterior boundary of theD; (b)ϕ(γ2)centers at the origin; (c) the center ofϕ(γ3)is on the imaginary axis. Then the conformal module of the surfaceS(also the circle domainD) is given byMod(S)={(ci,ri)|i=1,2,…,n}.This shows the Teichmüller space of genus zero surfaces withnboundaries is3n−3dimensional. The Teichmüller space has a so-called Weil–Peterson metric  [26], so it is a Riemannian manifold. Furthermore it is with negative sectional curvature, therefore, the geodesic between arbitrary two points is unique.Surface Ricci flow is a powerful tool to compute uniformization. Ricci flow refers to the process of deforming Riemannian metricgproportional to the curvature, such that the curvatureKevolves according to a heat diffusion process, eventually the curvature becomes constant everywhere. Suppose in the local coordinate, the metric can be written asg=(gij). Hamilton  [31] introduced the Ricci flow asdgijdt=−Kgij.Surface Ricci flow conformally deforms the Riemannian metric, and converges to constant curvature metric  [32]. Furthermore, Ricci flow can be used to compute the unique conformal Riemannian metric with the prescribed curvature.Theorem 2Hamilton and Chow  [32]SupposeSis a closed surface with a Riemannian metric. If the total area is preserved, the surface Ricci flow will converge to a Riemannian metric of constant Gaussian curvature.SupposeΓ={γ0,γ1,…,γn}is a set of non-intersecting smooth closed curves on a genus zero closed surface.Γsegments the surface to a set of connected components{Ω0,Ω1,…,Ωn}, each segmentΩiis a genus zero surface with boundary components. Construct the uniformization mappingϕk:Ωk→Dkto map each segmentΩkto a circle domainDk,0≤k≤n. Assumeγiis the common boundary betweenΩjandΩk, thenϕj(γi)is a circular boundary on the circle domainDj,ϕk(γi)is another circle onDk. Letfi|S1≔ϕj∘ϕk−1|S1:S1→S1be the diffeomorphism from the circle to itself. We called the diffeomorphismfithe signature ofγi.Definition 2.4Signature of a Family of LoopsThe signature of a family non-intersecting closed 3D curvesΓ={γ0,γ1,…,γk}on a genus zero closed surface is defined as:S(Γ)≔{f0,f1,…,fk}∪{Mod(D0),Mod(D1),…,Mod(Ds)}.The family of smooth closed curvesΓon a genus zero closed Riemannian surfaceSis determined by its signatureS(Γ), unique up to a conformal automorphism of the surface. Furthermore, the signature reflects the intrinsic symmetry of the surface.Theorem 2.5Suppose(S,g)is a genus zero Riemannian surface,η:S→Sis an isometry,γ1andγ2are two closed loops onSwith signaturesf1andf2respectively, such thatγ2=η(γ1).Then the signaturesf1andf2are equal after Möbius normalization.In this section, we explain each step of the pipeline in Fig. 1 in detail.The surface is represented as a triangular meshΣ(V,E,F). We apply the discrete Ricci flow method  [25] and the discrete Yamabe flow method.Definition 3.1Discrete Conformal FactorThe discrete conformal factor function is defined on the vertex setu:V→R, such that for each edge[vi,vj], the edge lengthlij=euiβijeuj,whereβijis the initial edge length.The discrete Gaussian curvature on each vertexviis defined as angle deficitKi={2π−∑ijθijkvi∉∂Σπ−∑ijθijkvi∈∂Σwhereθiijis the corner angle atviin the face[vi,vj,vk]. Then the discrete Gauss–Bonnet theorem holds∑vi∈ΣKi=2πχ(Σ).Definition 3.2Discrete Ricci EnergyThe discrete Ricci energy is given byE(u)=∫u∑iKiduiwhereuis the vector of conformal factors(u1,u2,…,un).Definition 3.3Delaunay TriangulationA closed triangle mesh is Delaunay, if for each edge[vi,vj]adjacent to faces[vi,vj,vk]and[vj,vi,vl],θkij+θlji≤π.Given target curvatureK̄:V→R, satisfying Gauss–Bonnet theorem, the discrete Ricci flow is given byduidt=K̄i−Ki,which is the gradient flow of the following energy:F(u)=∫u∑i(K̄i−Ki)dui,this energy is strictly concave in the space∑iui=0, and can be optimized directly using Newton’s method,∇F=(K̄1−K1,K̄2−K2,…,K̄n−Kn)T,the Hessian matrix is the negative of that ofE(u). Furthermore, during the flow, we preserve the mesh to be Delaunay all the time. This guarantees the existence of the solution.SupposeΣis a topological annulus,∂Σ=γ1−γ2. We set the target curvature to be zero everywhere, then use discrete Yamabe flow to get a flat metric. Then we find a shortest pathτbetweenγ1andγ2. By slicingΣalongτ, we get a topological diskΣ̄. Then we isometrically embedΣ̄face by face, this embedding is denoted asφ:Σ̄→C. By translation, rotation and scaling, we mapγ1to the imaginary axis, and the length is2π. Then the composition of the complex exponential map and the embeddingexp∘φ:Σ→D,maps the mesh to the canonical annulus with the unit exterior radius.SupposeΣis a topological disk, then by puncturing a small hole in the center, we convert it to a topological annulus. After mapping the topological annulus to the canonical annulus, we can fill the center hole. This gives the Riemann mapping from the original topological disk to the unit disk.SupposeΣis a genus 0 surface with multiple boundaries,∂Σ=γ1+γ2⋯γn, we apply the following Koebe iteration method. We filln−1holes bounded byγi,i>1to convert the mesh to a topological disk, map it to the planar unit disk,γ1is mapped to the unit circle. Then we remove the area bounded byγ2, choose a small circle insideγ2, by reflecting the whole plane with respect to the small circle, we makeγ2to be the exterior boundary,γ1the interior boundary. Then we fillγ1, compute a Riemann mapping to map the whole mesh to the unit disk,γ2to the unit circle. Then we repeat the whole process, each time, remove an area bounded byγk, and fill all other holes, and map the mesh to the unit disk, makeγkto the unit circle. The whole iteration procedure will converge, and eventually, all boundary curvesγk’s become rounder and rounder, and the mesh is mapped to a circle domain.After the computation of the conformal mapping, each connected component is mapped to a circle domain. We define an order for all the loops on the surface, this induces an order for all the boundary components on each segment. Then by the definition for the conformal module of a circle domain, we normalize each circle domain using a Möbius transformation, then compute the conformal modules directly. For those segments, which are simply connected and mapped to the unit disk, we compute its mass center, and use a Möbius transformation to map the center to the origin.Each loop on the surface becomes the boundary components on two segments, both boundary components are mapped to a circle under the uniformization mapping. Then we compute the signature directly. Supposeγ⊂S1∩S2, whereS1andS2are two segments.φ1:S1→D1andφ2:S2→D2are two conformal mappings, then the signature ofγis given byfγ≔φ2|γ∘φ1−1|γ.

@&#CONCLUSIONS@&#
