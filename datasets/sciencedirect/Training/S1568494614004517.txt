@&#MAIN-TITLE@&#
A hybrid fuzzy regression model and its application in hydrology engineering

@&#HIGHLIGHTS@&#
The large variation issue in fuzzy data is studied by a new variable spread model.For the first time, a MARS-fuzzy regression model is developed.The proposed model is used to predict the suspended load based on a real-world data.Empirical results show the advantages of the model with respect to LS fuzzy regressions.The model is satisfactory applied in a real hydrology engineering problem.

@&#KEYPHRASES@&#
Discharge,Fuzzy regression,Hydrology,Multivariate adaptive regression splines (MARS),Spline basis function,Suspended load,

@&#ABSTRACT@&#
The goal of this paper is to handle the large variation issues in fuzzy data by constructing a variable spread multivariate adaptive regression splines (MARS) fuzzy regression model with crisp parameters estimation and fuzzy error terms. It deals with imprecise measurement of response variable and crisp measurement of explanatory variables. The proposed method is a two-phase procedure which applies the MARS technique at phase one and an optimization problem at phase two to estimate the center and fuzziness of the response variable. The proposed method, therefore, handles two problems simultaneously: the problem of large variation issue and the problem of variation spreads in fuzzy observations. A realistic application of the proposed method is also presented, by which the suspended load is modeled using discharge in a hydrology engineering problem. Empirical results demonstrate that the proposed approach is more efficient and more realistic than some well-known least-squares fuzzy regression models.

@&#INTRODUCTION@&#
Fuzzy regression analysis is a widely known method for seeking the fuzzy relationship between input variables (also known as independent or explanatory variables) and output variable (also called dependent or response variable) based on a crisp (exact) or fuzzy (imprecise) data set. Two main approaches to construct a regression model in fuzzy environments are:1.the possibilistic approach, e.g. see [2,3,6,32,38,44], andthe fuzzy least-squares approach, e.g. see [4,8,10,11,13,14,33,34,41,42].However, during recent years, it is shown that in some cases the combined techniques, which integrate several single methods, have greater accuracy than any individual method [19,27,30]. Although it is shown that these methods have some theoretical and applied advantages the issue of the large variation data however has not been discussed in these studies. The problem of large variation data, specially, occurs in the analysis of some real-world data, such as: incomes data, rainfall data, data related to the characteristics of soil, and so on.To resolve the above problem, nonparametric models can be used. One of the most promising nonparametric techniques is multivariate adaptive regression splines (MARS) which models relationships that are nearly additive or involve interactions with fewer variables [16]. It essentially builds flexible models by fitting piecewise linear regressions; that is, the non-linearity of a model is approximated through the use of separate regression slopes in different intervals of the variable space [18]. Over the last years, MARS has been compared with a number of parametric and nonparametric approximation routines in terms of its accuracy, efficiency, robustness, model transparency, and simplicity [1,24–26,37].In this paper, MARS technique and a mathematical programming method are integrated to propose a new hybrid fuzzy regression procedure to cope with the problem of modeling and analyzing the large variation data. We consider the case when the response variable is fuzzy and the explanatory variables are crisp. This situation commonly arises in practical studies especially in hydrology engineering (as we shall see in Section 6).The proposed method is a two-phase procedure for computation of fuzzy regression that is simple and gives good solutions. At the first phase, this correspondence employs the MARS technique to estimate the crisp regression coefficients of the model using the defuzzified values of fuzzy observations of response and the crisp observations of explanatory variables. At the second phase, using the evaluation criterion proposed by Hojati et al. [19] as the objective function of a programming problem, a mathematical programming model is then constructed to determine the fuzzy error term associated with each observation. The model is a variable spread model, and so can avoid the spread increasing problem. A real-life problem in hydrology engineering is used to illustrate the applicability of the introduced method. The performance of the proposed approach with respect to some well-known fuzzy regression models are considered in a comparative study.The structure of the paper is as follows. In the section below, we shall describe some aspects of fuzzy set, fuzzy arithmetic and multivariate adaptive regression splines known as MARS. In Section 3, using MARS technique, we describe a variable spreads MARS-fuzzy regression model for fuzzy response and crisp explanatory variables. In Section 4, forecasting via fuzzy inference system is illustrated. Two goodness of fit criteria are recalled in Section 5 for evaluating the fuzzy regression models. In Section 6, we explain the applicability of the proposed hybrid model to estimate the suspended load based on the discharge, when the available real data of the suspended load are imprecise (fuzzy) rather than crisp (exact). Finally, we state important conclusions of the paper in Section 7.A fuzzy setA˜on the universal setXis described by its membership functionA˜(x):X→[0,1]. In this paper, we assume thatX=ℝ, the set of real numbers. The crisp setAα={x∈ℝ:A˜(x)≥α}, α∈(0, 1], is called the α-cut ofA˜, and for α=0 we assumeA0=cl{x∈ℝ:A˜(x)>0}, where cl is the closure operator.A specific class of fuzzy sets onℝis the so-called LR-fuzzy numbersN˜=(n,l,r)LRwith central valuen∈ℝ, left and right spreadsl∈ℝ+,r∈ℝ+, decreasing left and right shape functionsL:ℝ+→[0,1],R:ℝ+→[0,1], with L(0)=R(0)=1. Typically, the LR-fuzzy numberN˜has the following membership function [45](1)N˜(x)=Ln−xlifx≤n,Rx−nrifx>n.A special type of LR-fuzzy number is the so-called triangular fuzzy number, denoted byN˜=(n,l,r)T. The membership function of triangular fuzzy numberN˜is as follow(2)N˜(x)=x−(n−l)lifx∈[n−l,n],(n+r)−xrifx∈(n,n+r],0ifx∉[n−l,n+r].For l=r, the triangular fuzzy numberN˜is called symmetric triangular fuzzy number and is abbreviated byN˜=(n,l)T.For the algebraic operations of LR-fuzzy numbers, we have the following result on the basis of Zadeh's extension principle (for more details, see [45]). LetM˜=(m,lm,rm)LRandN˜=(n,ln,rn)LRbe two LR-fuzzy numbers and λ be a real number. Then(3)λ⊗M˜=(λm,λlm,λrm)LRifλ>0,I{0}ifλ=0,(λm,|λ|rm,|λ|lm)RLifλ<0,(4)λ⊕M˜=(λ+m,lm,rm)LR,(5)M˜⊕N˜=(m+n,lm+ln,rm+rn)LR,whereIAstands the characteristic function of a crisp set A.Defuzzification: Many defuzzification approaches have been proposed in the literature, of which the center of gravity (COG) method (also called the centroid method) is the most common used method [5,35]. The COG method calculates Nc, the defuzzified value of fuzzy numberN˜, as follows:(6)Nc=∫xN˜(x)dx∫N˜(x)dx.We can easily obtain the defuzzified value ofN˜=(n,l,r)Tas Nc=(3n−l+r)/3.Multivariate adaptive regression splines (MARS) is a non-parametric regression modeling procedure which was first introduced by Friedman [16] to efficiently approximate the relationship between a dependent variable (y) and a set of independent variables (x) in a piecewise regression, especially when the data set is large and/or the relationships between the variables does not follow a linear function. The MARS model takes the form of an expansion in multivariate spline basis functions(7)y=β0+∑m=1MβmBm(x),where β0, β1, …, βM, are the coefficients of the basis functions determined by a least-squares regression, M is the number of basis functions, and(8)Bm(x1,…,xn)=∏i=1Kmmax{Sim(xj(i,m)−tim),0},where Sim=±1, xj(i,m)'s are the explanatory variables associated with the basis function Bm(x1, …, xn), i.e. the values of jth explanatory variables at ith node of mth basis function, Kmis the level of interaction between j(i, m) variables, and timindicates the knot locations for Bm(x1, …, xn) [16,18].Basis functions are selected from the collectionCwhere(9)C={{max{(xj−t),0},max{(t−xj),0}}t,j:t∈{xj1,…,xjn},j=1,…,k}.Each function is piecewise linear with a knot t at every xji. One might assume that only piecewise linear functions can be formed from basis functions, but basis functions can be multiplied together to form non-linear functions, which are either order one or cubic, depending on the degree of continuity of the approximation. Therefore, by allowing the basis function to bend at the knots, MARS can model functions that differ in behavior over the domain of each variable [18,37].MARS models are developed through a two-stage forward/backward stepwise regression procedure which finds the location and number of the needed spline basis functions. To make the MARS algorithm computationally affordable, the maximum number of basis functions, the maximum number of knots considered, the minimum number of observations between knots, and the highest order of interaction terms in the model are specified by the analyst (for more details see [18]). Generally, finding a MARS model is computationally complex. In this paper, we use “earth” package in the software “R-2.14.1” to report the numerical results [15].In this section, using the MARS technique and a mathematical optimization method, we develop a new hybrid model to provide a variable spreads fuzzy regression model in fuzzy environment (see Fig. 1).Assume that the observed data on n statistical units are denoted as(y˜1,x1),…,(y˜n,xn), wherey˜n×1=[y˜1,…,y˜n]tis a vector of LR-fuzzy numbers, i.e.y˜i=(yi,yil,yir)LR(i=1, …, n), which determines the fuzzy observed of the dependent variable, andxi=[x0i,x1i,…,xki]∈ℝk+1(i=1, …, n;k<n;x0i=1) forms a (k+1)-dimensional vector of crisp observed independent variables. Based on the aforementioned data set, we will consider the following functional dependence betweeny˜n×1and Xn×(k+1)(10)y˜i=β0+∑m=1MβmBm(xi)⊕ɛ˜i,i=1,…,n,where βm, m=0, 1, …, M, are the crisp regression coefficients, andɛ˜i=(0,li,ri)LRis the fuzzy error term associated with the ith observation.In order to estimate the above fuzzy regression model, a two-phase procedure is introduced in the following. In the first phase, the crisp regression coefficients β0, β1, …, βMare estimated using MARS technique, and in the second phase, the fuzzy error termsɛ˜1,…,ɛ˜nare determined by a mathematical programming method.Phase 1. The regression coefficients βm, m=0, 1, …, M, are estimated by modeling the defuzzified values of fuzzy dependent variable, i.e. yc, on the crisp independent variable x, through the following model(11)yc=β0+∑m=1MβmBm(x).To estimate the regression coefficients β0, β1, …, βM, we use the MARS method. When the crisp coefficients of the model are obtained, the centers of the fuzzy responses are estimated as(12)yˆi=βˆ0+∑m=1MβˆmBm(xi),i=1,…,n.Phase 2. In this phase, we fuzzify the estimated valueyˆiin order to obtain an accurate estimation for the fuzzy response. Therefore, to provide a model with variable spread, in the second phase we provide a mathematical programming to estimate the fuzzy error termɛ˜i=(0,li,ri)LRfor each i, i=1, …, n subject to some constrains. Each fuzzy error termɛ˜ishould be estimated such that the spread ofɛ˜i, i.e. li+ri, be equal to the observed spread ofy˜i, i.e.yil+yir. The spreads ofɛ˜iare estimated by maximizing the sum of similarity measures between the estimated and observed membership values of the response variable subject to the equality of spreads. Therefore, we are led to an optimization problem with an objective function and some constraints.Following Hojati et al. [19] and Lu and Wang [27], the objective function, which should be maximized, is the sum of similarity measures between the estimated and observed values of the response variable as follows(13)∑i=1n∫min{y˜i(x),y˜ˆi(x)}dx∫max{y˜i(x),y˜ˆi(x)}dx.The constraints of the optimization problem are such that the estimated fuzziness for ith response is equal to the observed fuzziness for ith response, i.e.li+ri=yil+yir, i=1, …, n. But, the constraintsli+ri=yil+yir, i=1, …, n, limited only the value of the sum of left spread and right spread for each estimated response. In this case, it is possible that equalityli+ri=yil+yiris held, but lior riis much smaller than its corresponding observed left spread or right spread, respectively. To avoid this problem, letymlandymrbe the smallest left and right spreads of the observed responses, respectively, i.e.(14)yml=min{y1l,…,ynl},(15)ymr=min{y1r,…,ynr}.Then, we consider some part of the fuzziness of the estimated response asyml+ymrwhich makes it impossible to estimate values for the left or right spreads of the response variable much smaller than their associated observed left spread or right spread, respectively. Now, let(16)Di=(yil+yir)−(yml+ymr)≥0,i=1,…,n.Therefore, for the ith response, the minimal spreadyml+ymrneeds to be expanded in both sides in total of Dito become equal to the spread of the observed fuzzy response. To do this, the value of Diis divided into two values diand Di−di, where 0≤di≤Di, and the constraints of the optimization problem are summarized as follows(17)ɛ˜i=(0,yml+di,ymr+Di−di)LR,(18)0≤di≤Di,i=1,…,n.Consequently, incorporating the objective function and the constraints, the main optimization problem which yields the optimal values for diis summarized as follows: for each i=1, …, n(19)maxdi∫min{y˜i(x),y˜ˆi(x)}dx∫max{y˜i(x),y˜ˆi(x)}dx,(20)s.t.y˜ˆi=yˆi⊕ɛ˜i,(whereyˆi=βˆ0+∑m=1MβˆmBm(xi))(21)ɛ˜i=(0,yml+di,ymr+Di−di)LR,(22)0≤di≤Di.Finding the optimal valuesdˆ1,…,dˆn, the fuzziness of each estimated response is derived and so, the optimal fuzzy regression model is obtained as follows(23)y˜ˆi=βˆ0+∑m=1MβˆmBm(xi)⊕ɛ˜ˆi(24)y˜ˆi=(βˆ0+∑m=1MβˆmBm(xi),yml+dˆi,ymr+Di−dˆi)LR,i=1,…,n.By estimatingβˆ0,βˆ1,…,βˆM, anddˆ1,…,dˆn, the proposed fuzzy regression model becomes(25)y˜ˆi=βˆ0+∑m=1MβˆmBm(xi)⊕(0,yml+dˆi,ymr+Di−dˆi)LR,i=1,…,n,which can be adopted to forecast the associated response for any new observation of the independent variables. By employing the above model the estimated fuzzy responsey˜ˆiand the associated fuzzy error termɛ˜ˆiare derived for each pair(xi,y˜i), i=1, …, n. Therefore, for ith observation we have(xi,y˜i;y˜ˆi,ɛ˜ˆi). Letx*=[1,x1*,…,xk*]denotes a new specific value of the independent variable. For the new case x* its associatedy˜must be estimated which consist of two parts: the center and the spreads. Using the first phase of the model, the center of the fuzzy response is estimated asY=βˆ0B0(x*)+∑m=1MβˆmBm(x*). For estimating the spreads of the fuzzy response fuzzy error termϵ˜ˆneeds to be estimated. Since the second phase can not be used directly for such forecasting, therefore, a fuzzy inference system based on the fuzzy regression model is employed for derivingϵ˜ˆ(see also [9]).The basic structure of the fuzzy inference system consists of three components: a rule base, a database, and an inference procedure. The rule base contains the selection of fuzzy if–then rules activated by a certain value of interest, the database defines the membership functions adopted in the fuzzy if–then rules, then the inference procedure provides a fuzzy reasoning based on information aggregation from the activated fuzzy rules. Here, the simplest case of the Mamdani fuzzy model with one input–one output is adopted for deriving the predicted fuzzy error terms. The detailed description of fuzzy inference systems can be found in [35,45].Here an algorithm is provided denoting the steps of forecasting procedure:Step 1.Given a new specific value of the independent variablex*=[1,x1*,…,xk*], obtainY=βˆ0B0(x*)+∑m=1MβˆmBm(x*)using the first phase;Select the pairs(y˜i,ɛ˜ˆi), i=1, …, n, with conditiony˜i(Y)>0and collect them in set A, i.e.A={i:y˜i(Y)>0,i=1,…,n}. (The set A contains the observed responses activated by the new value of x*);For any a∈A, write the ath if–then rule as follows(26)Ra:IFYisy˜aTHENϵ˜ˆisɛ˜ˆa,where Rais the ath rule;Run the created fuzzy inference system with the rules provided in Step 3.The procedure of forecasting the response variable for a new observation of independent variable(s) is summarized in the flowchart given in Fig. 2.The antecedent and the consequence of each if–then rule Rain the Mamdani fuzzy model are fuzzy propositions. Moreover, the output from such a model is a fuzzy set which is specified by a membership function. For the value Y, each output membership function is activated to arrive at the membership gradey˜a(Y), and the predicted error term associated to Y, the fuzzy set created by the superposition of individual rule actions, can be obtained.Note that, while all observations are LR-fuzzy numbers, the fuzzy set of the predicted error term could be any irregular shapes. But, it is suitable that the predicted error term is a LR-fuzzy number which makes the obtained estimated response a LR-fuzzy number, too. To achieve this, the obtained predicted error termϵ˜ˆshould be transformed into a LR-fuzzy number. Finally, we consider the transformed predicted error term asϵ˜ˆ=(ϵˆ,lˆ,rˆ)LR, whereϵˆis the defuzzified value of the predicted error term calculated by center of gravity,lˆandrˆare set as the minimum and maximum of the possible values of the predicted error term, respectively.Thus, the estimated response for new independent variable x* becomes(27)Y˜ˆ=Y⊕ϵ˜ˆ=(Y+ϵˆ,lˆ,rˆ)LR.Several goodness-of-fit criteria have been introduced by authors to evaluate the performance of a fuzzy regression model (see e.g., [7,9–11,17,19,22,27,30,39]). In this work, in order to provide a competitive study we compare the model proposed in this study with some well-known models. To do this, we employ two criteria known as mean of similarity measures (MSM) and mean of absolutes errors (MAE) which have been widely used for evaluation of fuzzy regression models. These criteria are defined as follows:(28)MSM=1n∑i=1n∫min{y˜i(x),y˜ˆi(x)}dx∫max{y˜i(x),y˜ˆi(x)}dx,(29)MAE=1n∑i=1n∫|y˜i(x)−y˜ˆi(x)|dx.One of the classical problems in hydrology engineering is the measurement of suspended load (ton/day) and discharge (m3/s) in watersheds [29]. In practical studies, it is important to estimate the suspended load using the observations of discharge. Based on a study in a part of Darband (situated in the north east of Iran (see Fig. 3)) some water characteristics were measured using standard procedures. The natural logarithm of daily discharge and suspended load of the watershed are measured for 184 days [8]. But, due to some limitations in experimental environments, the observed values of the suspended load were reported as the triangular fuzzy numbers shown in Table 1. Since, in practical studies, it is important to estimate the amount of suspended load in term of discharge, we wish to model the relationship between suspended load as the fuzzy dependent variable (y˜=(y,s)T) and discharge as the crisp independent variable (x).The scatter plot of centers of suspended load in term of discharge is shown in Fig. 4. From this graph it is easy to see that no simple polynomial fit to the data would be able to analyze the data. Unlike well-known global parametric modeling methods such as linear regression, MARS does not assume coefficients are stable across the entire range of each variable and instead uses splines to fit piecewise continuous functions to model responses. This is very suitable for problems with high input dimensions and/or when a large data set is available to train the model, especially when it is suspected that model inputs have varying optima across different levels of the model inputs. Therefore, we apply the variable spreads MARS-fuzzy regression model to analysis the hydrology data.

@&#CONCLUSIONS@&#
