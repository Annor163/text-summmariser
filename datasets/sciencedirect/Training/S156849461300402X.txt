@&#MAIN-TITLE@&#
Modeling glycemia in humans by means of Grammatical Evolution

@&#HIGHLIGHTS@&#
We propose a method based on Grammatical Evolution to obtain individualized and customized glycemia models in humans.We have tested this proposal with five in silico patients taken from AIDA simulator.We present a study of four different grammars and five objective functions.In the test phase GE-models characterized glucose levels with a mean percentage average error of 13.69%.Models obtained with our method reflect also a good representation of both hyper and hypoglycemic situations.

@&#KEYPHRASES@&#


@&#ABSTRACT@&#
Diabetes mellitus is a disease that affects to hundreds of millions of people worldwide. Maintaining a good control of the disease is critical to avoid severe long-term complications. In recent years, several artificial pancreas systems have been proposed and developed, which are increasingly advanced. However there is still a lot of research to do. One of the main problems that arises in the (semi) automatic control of diabetes, is to get a model explaining how glycemia (glucose levels in blood) varies with insulin, food intakes and other factors, fitting the characteristics of each individual or patient. This paper proposes the application of evolutionary computation techniques to obtain customized models of patients, unlike most of previous approaches which obtain averaged models. The proposal is based on a kind of genetic programming based on grammars known as Grammatical Evolution (GE). The proposal has been tested with in silico patient data and results are clearly positive. We present also a study of four different grammars and five objective functions. In the test phase the models characterized the glucose with a mean percentage average error of 13.69%, modeling well also both hyper and hypoglycemic situations.

@&#INTRODUCTION@&#
Diabetes mellitus is a disease caused by a defect in either the secretion or in the action of insulin, which is essential for the control of blood glucose levels. Both of them cause in cells not to assimilate the sugar and, as a consequence, there is a rise in blood glucose levels, or hyperglycemia. Several types of diabetes differ in origin. According to the ADA (American Diabetes Association) we can distinguish four types of diabetes:•Type 1 Diabetes (T1DM): cells do not produce insulin because of an autoimmune process. Currently, requires the person to inject insulin or wear an insulin pump.Type 2 Diabetes (T2DM): results from insulin resistance, where cells fail to use insulin properly, sometimes combined with an absolute insulin deficiency.Gestational diabetes: appears in the gestation period in one out of ten pregnant women. Pregnancy is a change in the body's metabolism, since the fetus uses the mother's energy for food, oxygen and others. This causes a decrease in the secretion of insulin from the mother.Other types: such as problems on β-cells, genetic defects affecting insulin action, induced by drugs, and genetic syndromes.In most cases, diabetic patients with long time evolution need exogenous insulin either injected into various injection doses, or introduced by an insulin pump. It is important to maintain good glycemic control to prevent not only from the acute complications specific to diabetes (diabetic ketoacidosis and hypoglycemia, defined as blood glucose value less than 70mg/dl), but also from a set of multi-chronic complications associated with diabetic patients: nephropathy, retinopathy, microangiopathy and macroangiopathy.In recent years, it has been shown that a strict glycemic control in critically ill patients improves performance and reduces medical costs [1,2]. Glucose levels control is a demanding and difficult task for both patients and their families. To keep good levels of blood glucose, the patient must have some capacity of prediction to know what level of glucose would have if ingested a certain amount of food or injected with a quantity of a insulin of a certain kind. In fact, the objective is to avoid not only long periods of hyperglycemia (glucose levels ≥120mg/dl) but also episodes of severe hypoglycemia (glucose levels ≤40mg/dl) that can lead to patient death.One of the aspects that make it difficult to control blood glucose level is the lack of a general model of response to both insulin and the various factors mentioned above, due to the particularities of each patient [3]. Models in the literature apply classical modeling techniques, resulting in linear equations, defined profiles, or models with a limited set of inputs. Here we propose a novel technique that involves obtaining the patient model using genetic programming (GP). GP eliminates barriers in building the model, such as linearity or limitations on the input parameters.Evolutionary techniques such as GP, have certain characteristics that make them particularly suited to address optimization problems and complex modeling. First, they are conceptually simple in its application but have a theoretical basis defined and widely studied. GP has demonstrated its applicability to many real problems, and is intrinsically parallelizable to work with a set of solutions. Furthermore, EAs have great potential to incorporate knowledge about the domain and to incorporate other search mechanisms (not necessarily evolutionary).One of the best known applications of GP is symbolic regression and the application of one of its variants, Grammatical Evolution (GE), allows to obtain solutions that incorporate non-linear terms. GE is an evolutionary computation technique established in 1998 by Conor Ryan's group at the University of Limerick (Ireland) [4]. GP aims to find an executable program or function that respond to the reference data. The key advantage is that GE applies genetic operators to a whole chain, which simplifies the search application in different programming languages. In addition, there are no memory problems, unlike with GP where the tree representation could have the well know problem of bloating (an excessive growing of the computer structures in memory). Hence, we propose to apply GE to find a custom model that describes and predicts the blood glucose level in a patient. Our method takes the historic data of a patient consisting in previous glucose levels, ingested carbohydrates and injected insulin, and obtains an expression that can be used to predict near future glucose values. The contributions of this work are:•We propose a method based on GE to obtain individualized and customized glycemia (glucose level in blood) models in humans.We have tested this proposal with five in silico patients taken from AIDA simulator [5].We present a study of four different grammars and five objective functions.We have selected the best models for each patient and run a test phase with a new dataset. In the test phase the models characterized the glucose with a mean percentage average error of 13.69%, reflecting also a good representation of both hyper and hypoglycemic situations.The rest of the paper is organized as follows. Section 2 describes the related work. Section 3 details how Grammatical Evolution can be applied to this problem. Section 4 shows the general model we propose, as well as the grammars, particular models and objective functions we have studied for the glucose estimation problem. Section 5 is devoted to the experimental setup, while Section 6 presents the results obtained in both training and test phases. Finally, Section 7 explains the conclusions and the future work.

@&#CONCLUSIONS@&#
In this paper we propose an evolutionary method based on GE that automatically obtains custom models for blood glucose levels in diabetic patients. Up to our knowledge, this is the first proposal where GE is applied to obtain glucose models in diabetics.The main advantages of our method are: (1) the model is obtained as a custom expression for each patient, which improves the individual treatment of a diabetic person; (2) the training dataset can be easily collected by a patient or by a simple system because models require values of previous glucose measures, carbohydrate units ingested and insulin doses injected; (3) this method may be integrated in a progressive optimization system where the model is generated and stored and, after several days of data gathering, the model can be updated using the new dataset.In our work, we have studied four different grammars and five different objective functions for our optimization scheme on five in silico patients. The grammars incorporated some knowledge about the problem, trying to limit the search space of the algorithm. We have concluded that grammars which consider previous data that are close to the current time step are better than those able to select any previous data. That is, the most recent data are more valuable than the past ones. In addition, these grammars obtained more useful models because their expressions depend on almost all the involved variables. Besides, we saw that optimizing the average error objective obtains the best results, as well as we identified that the maximum error is an opposite objective that could be considered in future multi-objective optimizations.Once the training phase finished, we selected the best model expressions for each patient and run the test phase with a different dataset. The results showed a mean percentage average error of 13.69% for the best models in the test phase. In addition, the best models predicted quite well the dangerous situations of hyper and hypoglucemias for all the patients.In the future, we expect to manage datasets from real patients, which will allow the study of new variables in the models like stress or exercise. This will require the refinement of the grammars. In addition, we will consider the multiobjective optimization with both average and maximum error objectives. We will also consider to integrate fuzzy regression into the GP process [27,28].