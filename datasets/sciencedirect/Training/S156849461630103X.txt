@&#MAIN-TITLE@&#
EMGdi signal enhancement based on ICA decomposition and wavelet transform

@&#HIGHLIGHTS@&#
A novel de-noising method is proposed to remove the ECG interference from noisy EMGdi signals. Experimental results achieved on practical clinical data show that the proposed approach is better than traditional methods include wavelet transform (WT), ICA, digital filter and adaptive filter in ECG interference removing.The original independent components of contaminated EMGdi signal were firstly obtained with independent component analysis (ICA). Then the ECG components contained were removed by a specially designed wavelet domain filter. Finally, the purified independent components were reconstructed back to the original signal space by ICA to obtain the clean EMGdi signals.

@&#KEYPHRASES@&#
Independent component analysis,Wavelet transform,EMGdi signal,ECG interference,

@&#ABSTRACT@&#
Diaphragmatic electromyogram (EMGdi) signal plays an important role in the diagnosis and analysis of respiratory diseases. However, EMGdi recordings are often contaminated by electrocardiographic (ECG) interference, which posing serious obstacle to traditional denoising approaches due to overlapped spectra of these signals. In this paper, a novel method based on wavelet transform and independent component analysis (ICA) is proposed to remove the ECG interference from noisy EMGdi signals. With the proposed method, the original independent components of contaminated EMGdi signal were first obtained with ICA. Then the ECG components contained were removed by a specially designed wavelet domain filter. After that, the purified independent components were reconstructed back to the original signal space by ICA to obtain clean EMGdi signals. Experimental results achieved on practical clinical data show that the proposed approach is better than several traditional methods include wavelet transform (WT), ICA, digital filter and adaptive filter in ECG interference removing.

@&#INTRODUCTION@&#
Diaphragmatic electromyographic (EMGdi) signal carries important information about the human respiratory system. It is often used to monitor the situation and determine the respiratory diaphragm fatigue and other symptoms [1] to facilitate the diagnosing and analyzing of chronic obstructive pulmonary disease, which is found to be related with diaphragmatic fatigue and may cause a severe disorder of the respiratory system with a high death rate. As the acquisition of clean EMGdi signals is a prerequisite for its practical applications [2,3], a major problem unfortunately encountered is the strong ECG interference signal caused by the beating activity of the heart, which spreads through the body tissue around the cavity to the diaphragm thus contaminates EMGdi signal [4,5]. Moreover, the ECG artifact generally has greater amplitude even than the maximum EMGdi signal. As a result, useful information contained in original EMGdi signal is often masked. Hence, an efficient method to remove the ECG interference with minimal loss of the EMGdi signal is needed.Several methods have been proposed to reduce the ECG artifacts. To be specific, the traditional wavelet ‘hard threshold’ (called WTHT) methods adopted in [5] aims to suppress background noise by simply setting a hard-threshold, we called this method ‘small-coefficient-truncated’. One of the most simple and cost-efficient solution is high-pass filter [6]. But, spectrum analysis indicated that most of the ECG signal energy concentrates in the 0–70Hz frequency range, while the EMGdi signal occupies the band from 0 to 250Hz. There obviously exists an overlapped frequency band of 0–70Hz between these two kinds of signals. Thus traditional highpass filters or bandpass filters may not be able to filter the ECG without introducing significant loss of the EMGdi signal [7,8]. Subtraction techniques can remove the ECG artifacts without sacrificing useful data. However, it needs manual precise selection of the ECG templates, which is extremely difficult in practical applications. Slim and Kosai proposed a least mean square (LMS) structure without introducing supplementary electrodes to the noise reference for minimizing the presence of electronics [9]. Nonetheless, it was not really sufficient because there was always the presence of the useful EMGdi signal in the reference signal.The traditional methods directly based on frequency-domain features have significant limitations because of the overlapped spectral features [7–9] between EMGdi signals and ECG interference. ICA has been emerging as an efficient tool on the condition that all the sources are independent with each other. It does not need any other prior knowledge of the sources. Cao proposed a method based on ICA and standard digital filtering in [10] to remove ECG interference from surface Electromyography. The traditional ICA (called TICA) adopted in [10] could be summarized as: First, independent components are obtained by applying ICA to original signals. Second, ECG components contained are purified by a standard bandpass filter. Then, the contributions of ECG signal are recovered by ICA. Finally, ECG interference is subtracted from the original signals. However, while this noise reduction method [10] adopted the ICA to efficiently decompose original signal into independent components, it still relied on traditional bandpass filter to remove noise in each independent component space. As a result, the temporal-frequency resolution of noise removing is limited, compared to that of time frequency analysis.Time frequency analysis of EMGdi signals based on the white noise assumption was addressed in [5], where Deng suggested that small wavelet coefficients should be ignored after signal decomposition of wavelet, as they are dominated by white noise. According to this assumption, a threshold T is set for each decomposition level. The wavelet coefficients of signals smaller than the threshold T will be transferred to 0, else the wavelet coefficients keep unchanged. Afterward the target signal can be reconstructed from the threshold processed wavelet coefficients. Thus, inspired by the superiority of wavelet filtering, wavelet domain threshold is proposed in this paper for the noise removing from the independent components obtained by ICA process.It has been recognized that the method combines wavelet analysis with ICA can overcome the shortcomings of wavelet analysis (could not distinguish overlapped spectrum) and ICA (lack of noise reduction capability) to facilitate the signal de-noising, which has been reported in many previous papers. In [11], the authors employed concept of the spatially constrained ICA (SCICA) to extract artifact-only independent components (ICs) from the given EEG data, use wavelet denoising to remove any cerebral activity from the extracted-artifacts ICs, and finally project back the artifacts to be subtracted from EEG signals to get clean EEG data. However, the extract data segment could contain important information. A wavelet based method is needed to design to reject the artifact while conserving the EMGdi signal. Azzerboni et al. [12,13] presented ICA and wavelet to detect single muscle activation by means of ICs time-scale decomposition, which starts with acquisition of sEMG (surface EMG) signals; source separation is performed by a neural net-work that implements on ICA algorithm. In this way a signal set each representing single muscle activity is obtained. The wavelet transform, lastly, is utilized to detect muscle activation intervals. In wavelet transform, three levels are detected: a threshold, a max level and a min level.In this paper, considering the overlapped frequency bands, non-stationarity and low signal-to-noise ratio (SNR) features of the noisy EMGdi signal, we propose a novel wavelet domain threshold filter combining with FastICA, which is designed to achieve the separation and removal of the ECG components with minimal loss of the EMGdi signal. In this paper, the design of threshold is modified to remove the dominant part of the ECG interference by truncating the ‘large’ wavelet coefficients with variable threshold dependent on different decomposition levels.The paper is organized as follows: in Section 2, the algorithm of traditional ICA de-noising methods and wavelet transform will be reviewed and the proposed method (we named it ICA–Wavelet) will be introduced; in Section 3, preliminary knowledge of ECG signals and EMGdi signals, and the practical implementation of the proposed approach will be provided, then the experimental results and discussion will be presented; finally, in Section 4, conclusions will be given.Compared with existing methods for ICA, the FastICA possesses the common advantages of typical neural algorithms including parallel calculation, low computational complexity and small memory space requirement. The algorithm is easy to use because no algorithm parameters such as step size is needed compared to gradient-based algorithms [14,15].According to [14,15], we assume a set of observationsX=[x1,x2…xm]Tis obtained as a linear combination of the unknown sourcesS=[s1,s2...sm]Twith size of m×n. Therefore, the mathematical model can be expressed as(1)X=ASwhere mixing matrix A consists of some parameters that depend on the distances of esophageal electrodes. Actually, A is unknown and its de-mixing matrix W should be calculated.Estimations of the original signals or sourcesS=[s1,s2…sm]Tcan be changed to find a de-mixing matrixW, then:(2)S=WX=A−1XFastICA is widely used as one of the efficient algorithms to solve or estimate the de-mixing matrixW.Before applying the ICA algorithm on the data, it is necessary to do some preprocessing to facilitate the implementation of ICA estimation. First, observed signals denoted by a matrixX=[x1,x2…xm]Tare subtracted by their mean vectors expressed asxi−meanxi=x¯i,i=1…mto get a matrixX¯=x¯1,x¯2…x¯mT. Then, with the eigen-value decomposition of the covariance matrixEX¯X¯T=UDUT, whereUis the orthogonal matrix of eigenvectors ofEX¯X¯T,Dis the diagonal matrix, the whitening transformation can always be done by(3)Z=UD−1/2UTX¯=VX¯whereVis the preprocessing matrix, it will be used in the inverse transformation later in this paper,Zis the signal matrix after some preprocessing to detected signal matrixX. After that Eq. (2) becomes(4)S˜=WZwhereS˜is the estimate ofS. According to FastICA algorithm,Wcan be solved asStep 1: Choose a random square matrixW, set the convergence threshold 0<ε≪1;Step 2: Iterative calculation:W+=EZgWTZ−Eg′WTZW, letg′WTZ=tanhWTZ;Step 3: LetW=W+/W+;Step 4: IfWk+1−Wk<ε,the algorithm is finished, else go back to Step 2.The above ICA process enables the efficient separation of different components from the original signal space, which may be difficult to separate by classic approaches when the target signal and noise have overlapped spectral features. Among the independent components obtained by ICA, if we can identify certain components dominated by noise, it is possible to remove this noise by ignoring that ‘noise related’ components and then reconstructing the target signal. However, as the ‘noise related’ components generally also contain contributions from target signal, it is reasonable to remove those ingredients contributed by noise from the ‘noise related’ components, instead of simply ignoring the ‘noise related’ components.The wavelet transform is usually applied to overcome the limitations in time-frequency resolution of the classical Fourier transform and its extended versions. The continuous wavelet transform of target signal f(t) is defined as [12,16,17](5)f,ψa,b=1a∫−∞+∞f(t)ψt−badtwhere ψa,b(t) denotes the mother wavelet, a is the scaling parameter which is reciprocal of frequency and b indicates the time shifting. Discrete a and b to binary parameters, a=2−j, b=k2−j, where, j, k denote the different decompose levels. The discrete wavelet transform is shown in the following equation:(6)ψj,k(t)=2j/2ψ2jt−kIn [16], the discrete signal is convolved with a low pass filter L and a high pass filter H, yielding two output vectors cA1and cD1, which are called Approximate Coefficients and Detailed Coefficients respectively. The down sampling process, by which the odd indexed elements of the filtered signal are omitted, is carried out to ensure that the whole number of the coefficients produced by the basic decomposition step is approximately the same as the number of the elements of the original discrete signal.Wavelet decomposition is extensively applied for de-noising under the assumption of additional white noise. A shrinkage function based on wavelet ‘hard threshold’ was used in [5] to reduce the noise in the signal. The wavelet ‘hard threshold’ is defined as:(7)θT=0,ifθ<Tθ,ifθ≥Twhere θ is the wavelet coefficient after wavelet decomposition, it can be obtained by Eq. (5). T is called wavelet ‘hard threshold’ which is calculated with Approximate Coefficients and Detailed Coefficients.Suppose we get a set of clinic data noted by a matrixX=[x1,x2…xm]T, where m is the number of simultaneous data acquisition channels. The original data matrixXcontains both ECG interference and EMGdi signal. Through FastICA algorithm, we can obtain independent componentsS˜=s˜1,s˜2…s˜mTas an estimated matrix of the original ECG and EMGdi mixture. Among the independent components obtained by FastICA, in this paper these dominated by EMGdi signalS˜EMGdiare called ‘EMGdi related’ components, while those reigned by ECG interference are called ‘ECG related’ components. The ‘ECG related’ componentS˜ECGgenerally also contains some weak contributions caused by EMGdi signal. In order to remove ECG interference, a novel wavelet threshold is designed to purifyS˜ECG. Instead of constant ‘hard’ threshold as adopted in [5,12,13], variable threshold is adopted in this paper according to distribution of ECG components at different wavelet decomposition levels.Specifically, considering the sampling rate at 2000Hz and the central frequency of ECG signal is at 60–70Hz, we adopt wavelet decomposition of 5 layers. Experiments show that the coefficients associated with ECG interference are found in the fifth wavelet decomposition layers. Other layers include 1–4 layers contain weak ECG energy. On the contrary, most energy of EMGdi signals concentrates in 1–4 layers which correspond to relatively high frequency range. Thus different threshold can be assigned to relate the ECG interference reduction threshold with its distribution among different wavelet scale layers.In Daubechies (Db) wavelet family [18,19], as low number of wavelet (such Db1) is highly localized and the singularity index is small, it could reflect the frequency characteristics of the original signal. On the other hand, wavelets associated with high number (such as Db8) are highly smooth, and it could not accurately reflect the peak signal singularity. Considering the time-frequency domain resolution and the characteristics of target signal, we choose Db1 wavelet in this article.Taking into account the frequency range of ECG signals including QRS is mainly concentrated about 0–65Hz [20], 5-level Db1 wavelet decomposition is used in our work. Under the sampling frequency of 2kHz, the lowest frequency band of 5-level wavelet decomposition is about 0–62.5Hz (namely, 62.5×25=2000), which matching the frequency band of ECG interference. So we take j=d1, d2, …, d5, a5 at the sampling frequency of 2kHz for variable threshold setting, expressed as:(8)θTS˜ECG=θjS˜ECG,ifθjS˜ECG<Tj0,ifθjS˜ECG≥TjwhereTjis assigned with different weightkjat different decomposition level, defined as(9)Tj=kjavejAccording to the distribution features of ECG signals at different wavelet decomposition levels, the threshold selection of the proposed method is based on an average amplitude of neighbor raw signals, we setkd1,kd2,kd3,kd4,kd5,ka5=[2,2,3,4,5,5]to adjust the threshold value in different decomposition levels. The average amplitudeavejis constructed as a vector, which elements at time tavej,tare calculated as(10)ave[j,t]=∑i=t+Ljt+Ujθj,iUj−Ljt<Uj∑i=t−Ujt−Ljθj,i+∑i=t+Ljt+Ujθj,i2Uj−Lj+1Uj≤t≤Pj−Uj∑i=t−Ujt−Ljθj,iUj−LjPj−Uj<t≤Pjwhere Ujand Ljis the upper bound and lower limit at j wavelet decomposition level of the calculated window, Pjis the data length at j level. θj,iis the wavelet coefficient at time i of j level in wavelet decomposition. It is worth noting that, unlike our previous work [21],kjin Eq. (9) are different values at different wavelet decomposition levels, rather than for the same constant k.The wavelet domain threshold adopted here is different from that of the WTHT method in [5]: First, with traditional WTHT filter, the wavelet coefficients were preserved if they were larger than the threshold, otherwise the coefficients were ignored by setting to zero. By contrast, with new method proposed in this paper, the wavelet coefficients are ignored if they are larger than the threshold and smaller coefficients are preserved. Second, new method designs the threshold based on the average amplitude of raw signals instead of constant threshold at each wavelet decomposition level. Thus, the noise removing procedures under the proposed variable threshold can be summarized as:S˜ECGis decomposed according to Eqs. (5) and (6), then the average of each wavelet decomposition level can be obtained by utilizing Eq. (10) to obtain the variable threshold at each wavelet decomposition layer with Eq. (9). Thus, one can get purified componentsS˜d-ECGfromS˜ECGafter the ECG interference removing procedure expressed by Eq. (8). In other words, we get the total signal components matrix include purified componentsS˜d-ECGand directly obtained separated componentsS˜EMGdiby ICA. We write it asS˜Total=S˜d-ECGS˜EMGdi,S˜Totalis finally reconstructed back to the original signal space by(11)XEMGdi=V−1W−1S˜Total=V−1WTS˜TotalwhereXEMGdi is the resulting signal matrix after EMGdi signal enhancement,Wis an orthogonal matrix, the inverse matrixV−1 and transposed matrixWTcan be obtained from Eq. (3) to (4). It is noteworthy thatZ=VX¯is an orthogonal matrix [15], and we cannot ensureVis an unitary matrix. Otherwise, in this paper, it is reasonable that wavelet filter is applied after ICA, as ECG components obtained to be rejected and reserve EMGdi although there is minute quantity EMGdi signal. However, when clinical data shows EMGdi signal amplitude is larger than ECG signal during some part time, in this condition, calculate these data directly with Eqs. (8)–(10) (wavelet based filter) or use wavelet based filter before ICA will be failure during these periods. Hence, it is necessary to separate ECG components by using ICA first and then reject them by using wavelet based filter.A typical normal ECG includes P wave, QRS wave group, ST segment and T wave, of which the amplitude of the QRS complex is significantly higher than the other waves T wave. ECG interference is a serious problem encounter in practical signal acquisition, because the QRS wave group frequently has greater amplitude even than the maximal EMGdi signal.All data used in this paper were collected at the Guangzhou Institute of Respiratory Diseases, China. Raw EMGdi signals were obtained via a 5-lead esophageal electrode consisting of 10 electrode, each of them is 1cm long, 2mm in diameter, set a proximal ground electrode as the reference electrode, the other nine electrodes arranged in a sequence composed of five records and leads, electrodes with a thin insulating layer. Each lead between the two recording electrodes is separated by three electrodes. The total length of recording electrodes is 9cm. There are some very small gaps between the electrodes (shown in Fig. 1a). The 5-lead esophageal electrodes were placed via the nose into the esophagus and stomach of the patient (shown in Fig. 1a). The raw EMGdi signals were amplified 1000-times by the PowerLab system (GT201/50 produced by ADInstruments, Castle Hill, Australia), which has a notch filter to eliminate the 50Hz Interference. After amplification, the signal amplitude is between 0 and 500mV, which were sampled at 2kHz with a standard 16-bit analog-to-digital converter for each channel and stored in binary format on a hard disk for analysis (shown in Fig. 1b).Experiments of 5-channel simultaneous acquisition of the real 30 group EMGdi signals were conducted, including the acquisition of signals from healthy volunteers, respiratory disease in men, women when they were sitting or sleeping. To facilitate signal analysis, we select a 5-channel synchronization of offline EMGdi collected data of 12.06s as shown in Fig. 2to be analyzed by different methods in the next section. The data came from a male suffering from respiratory disease when he was sitting during the day.The block chart of the proposed ECG noise removing approach combining the FastICA and wavelet filter is illustrated in Fig. 3, which corresponds to algorithm formula from Eqs. (3), (4) and (8)–(11). Steps are outlined as following:First, different components are obtained by applying FastICA to the clinical data. In the FastICA processing, the source number is supposed to be equal to the number of detected signal source. In this paper, the detected signal number is 5 corresponding to the number of data acquisition channels. It means that de-mixing matrix is a square matrix. Actually, this assumption does not match the physical conditions as the number of physical signal sources is less than 5. In other words, this is an over-determined blind source separation problem if based on the above assumption. However, we don’t plan to reduce the sensor dimensionality because our focus is ECG signal component and try to reject it.Second, similar to principal component analysis [22–24], the component associated with the dominant energy will be the first to be extracted under the one by one separation mode of FastICA. Thus, the ‘ECG related’ component will be obtained first because of its larger energy, but it usually contains some weak EMGdi contributions. In order to guarantee the performance of ECG noise reduction while reserve the EMGdi contribution as much as possible, we purify the ‘ECG related’ components with the variable threshold obtained with the wavelet domain coefficients according to Eqs. (8)–(10).Finally, all components (purified ‘ECG related’ components noted byS˜d-ECGand ‘EMGdi related’ components noted byS˜EMGdi) are reconstructed back to the original signal space by FastICA inverse transform withV−1 andWT.We write some Matlab programs to calculate the real data, run the algorithms and analyze the experimental results. According to the ICA–Wavelet processing procedure, FastICA is adopted to separate the clinical data in Fig. 2. A preconditioning matrixVand a de-mixing matrixWare first obtained with the formula Eqs. (3) and (4), through which 5 components are obtained after the convergence of FastICA algorithm as shown in Fig. 4. All components are normalized to facilitate the ICA process. According to the previous interpretation of the preliminary knowledge of ECG signals and EMGdi signals at the beginning of Section 3, 5-channel independent components can be divided into two groups: ‘ECG related’ component corresponding to the first component and ‘EMGdi related’ components corresponding to the other four components in Fig. 4. To remove ECG interference, the ‘ECG related’ component was purified by the wavelet domain variable threshold. After that,S˜EMGdiandS˜d-ECGwere reconstructed back to the original signal space by ICA inverse transform with matrixV−1 andWT. In order to illustrate the superiority of the proposed method, typical traditional methods are also selected for performance comparisons in the experiments in this paper.As the EMGdi signal has similar ‘wide band’ spectral distribution pattern with white noise [5], from WTHT method we developed a modified method by subtracting the results of ‘hard threshold’ wavelet filtering from raw EMGdi signals to remove ECG interference and preserve EMGdi signals. We named the method as ‘inverse hard thresholding’ filter (named IWTHT) and employed it for performance comparisons.In the first experiment, the proposed ICA–Wavelet method was compared with TICA, WTHT and IWTHT methods, to process the clinical data shown in Fig. 2. The reconstructed EMGdi signals of 5-channel were de-noised by ICA–Wavelet, shown in Fig. 5. However, different with ICA, WTHT and IWTHT can process single channel signal. For a fair comparison and brevity, the raw EMGdi of the first channel (Fig. 6a) was used to remove ECG interference. The results are shown in Fig. 6. It is obvious that the amplitude of ECG signal is even higher than that of EMGdi signal, especially for the QRS impulse. WTHT (Fig. 6b) removes less ECG signal than IWTHT (Fig. 6c), because WTHT method was designed to suppress background noise by simply setting a hard-threshold and remove small coefficients decomposed by wavelet. IWTHT removes ECG interference based on the assumption that the EMGdi signal has similar ‘wide band’ spectral distribution pattern with white noise [5], the rough assumption in IWTHT leads to a limited improved performance than that of WTHT. Similar with the proposed method, TICA constructs EMGdi signal contains less ECG signal than IWTHT (Fig. 6d). TICA deals with 5-channel data, recover EMGdi signal by removing the ECG components. ICA separates different components based on the assumption of the components are independent. However, the clinical data usually shows more complex feature, even not totally independent, i.e. the components contain other signal after separation of ICA method. Based on the above consideration, the proposed ICA–Wavelet method can remove ECG signal with the least loss of EMGdi signal, provides the least ECG signal contained EMGdi signals.Furthermore, in order to quantify the performance assessment of these methods, the centriod frequency (CF) value defined by Eq. (12) is used in this paper, as it can reflect the mean frequency over the whole power spectral density (PSD) [10,25]. Obviously, EMGdi signal contaminated by significant ECG interference will exhibit CF value near to that of ECG signal. Thus, after noise elimination process, the extent of CF value deviating from the range of the ECG signal to that associated with pure EMGdi signal may indicate the ECG interference removal performance.(12)∫0fmidPSD(f)df=12∫0f0PSD(f)dfMoreover, because of the difficulties in direct detection of pure EMGdi signals, SNR of pure EMGdi signal is not suitable to be used for performance evaluation. Thus, Welch power spectrum density analysis is also applied to evaluate the intuitive performance of the noise reduction. The length of overlapped window is set to half of FFT analysis window.In [26], the average rectified value (ARV) of the signal presented to quantitatively assess the efficiency of the ECG artifact removal methods which focus on signal amplitude, defined as(13)ARV=12N∑k=ii+2Ns(k)where s denotes the processed signal, 2N is the length of the ECG signal, and i is the time point of ECG signal occurring. ARV was chosen as performance indicator because it was more meaningful to focus on signal amplitude than on any other parameter. However, we cannot ensure one method is effective when it reject both ECG signal and EMGdi signal at the same time part, in this sense, ARV may seems to be good although it sacrifices lots of useful signal. Here, we proposed a modified performance indicator: the average rectified value ratio (ARVR), defined as(14)ARVR=∑k=ii+2Ns(k)∑k=i−Nis(k)+∑k=i+2Ni+3Ns(k)where∑k=ii+2Ns(k)means calculating the ECG signal amplitude value, but it inevitably exists EMGdi signal during these data length. We calculate∑k=i−Nis(k)+∑k=i+2Ni+3Ns(k)as EMGdi signal amplitude value. So, if ARVR approaches to 1 means ECG signal is weaken or even disappear but remain EMGdi signal. Based on the above consideration, ARVR is less than 1 means it loss lots of EMGdi signal also at this time period. ARVR is an indicator focus on the signal amplitude. We applied ARVR to estimate the results of ICA–Wavelet, TICA, WTHT and IWTHT methods. The ARVR indicator comparisons are shown as Fig. 7. It indicates that ECG interference is well reduced by ICA–Wavelet, and may be worse than raw EMGdi signal by WTHT. From Fig. 7, one can see that ICA–Wavelet outperforms than TICA, WTHT, IWTHT methods.The quantitative performance comparisons of the ECG interference removal methods evaluated by the normalized PSD analysis are shown in Fig. 8. As the ECG signal energy concentrates about 0–70Hz frequency range while the EMGdi signal occupies 0 to 250Hz frequency band as mentioned before, Fig. 8a indicate that ECG interference still reigns in signals after de-noising. Specifically, as shown in Fig. 8b, the results processed by WTHT contain only ECG signals. It can also be seen from Fig. 8b that, after noise elimination process by the proposed ICA–Wavelet approach, the EMGdi signal is significantly enhanced.The CF values before and after data processing by traditional methods and ICA–Wavelet are given in Table 1. From Table 1 one may observe that the CF of raw signals ranges from 21.1Hz to 23.1Hz. The dominant frequency range of processed EMGdi signals by ICA–Wavelet is 87.2–101.5Hz. It means that the frequency range of processed EMGdi signals by ICA–Wavelet changed from that of the original ECG signal to that of the pure EMGdi signal. On the other hand, TICA has no significant improvement in performance of reducing interference, as the dominant frequency range of processed EMGdi signals by TICA is 35.0–68.0Hz. WTHT even has worse performance because the associated CF values, ranging from 20.2Hz to 21.3Hz, are similar to that of pure ECG signals. The IWTHT exhibits better performance of ECG interference reduction than WTHT, but its CF values are still near to that of the ECG CF values, with the corresponding dominant frequency ranging from 55.0Hz to 66.4Hz. It means that there is still significant ECG interference after processing by IWTHT.In this experiment, the ICA–Wavelet will be compared with the traditional digital filter and adaptive filter. It is recognized that the main frequency distributes about 0–70Hz, and that of EMGdi is about 0–250Hz. Take into account the frequency response characteristics and computational efficiency of the filter, we adopt 10-order IIR Butterworth high-pass (HP) filter (cut-off frequency is 70Hz) to reduce some ECG interference. On the other hand, adaptive filter is widely used in rejecting ECG interference [9,27,28]. In fact, normalized least mean square (NLMS) algorithm may be more attractive than LMS because of its robustness and can be easily applied, which processed by the following equations:(15)e(n)=d(n)−xT(n)h(n)hi(n+1)=hi(n)+μe(n)x(n−i)c+xT(n)x(n),∀0≤i<L,where d(n),h(n)=h0(n),h2(n),…,hL−1(n)Tandx(n)=x(n),x(n−1),…,x(n−L+1)Tdenote the contaminated EMGdi signal, adaptive filter coefficient vector and ECG interference respectively, L is the filter length, n is the filter time index, 0<c≪1; is a constant value and named regularization parameter,We applied the ICA–Wavelet, HP and NLMS methods to the clinical data, which is 4-channel, as long as 22.2 seconds, as shown in Fig. 9. In the contaminated EMGdi signals where the first signal vector is set as reference of ECG signal in NLMS method. The de-noised EMGdi signal results by 3 methods are shown in Fig. 10. One can see that NLMS (Fig. 10b) method contains the most ECG signal, since there are unavoidable variable waveform and their difference between the reference ECG signal and the ECG components in EMGdi signal. That may reveals that adaptive method needs precise selection of the ECG templates as a reference signal. Hence, this method introduces supplementary electrodes which may inevitably introduce additional noise and lead to a non-ideal result. HP filter removes ECG signal in the setting frequency range (Fig. 10c), however, which will result to a loss of EMGdi signals. ICA–Wavelet can remove ECG signal when conserving EMGdi at most, which is shown in Fig. 10d.Quantified performance assessments of these methods include ARVR (Fig. 11), PSD (Fig. 12) and CF (Table 2). From Fig. 11, one can observe that the result get by NLMS is more than 1.7, which means ECG energy is still high in the constructed EMGdi signal, even higher than the raw EMGdi signal. Because NLMS removes ECG signal with the loss of EMGdi signal unavoidably. It can also be seen from Fig. 11 that, after noise elimination process by the proposed ICA–Wavelet approach, the EMGdi signal is significantly enhanced. The ARVR of ICA–Wavelet approach is close to 1.The CF values (Table 2) before and after data processing by 3 methods reveal that the CF of raw signals ranges from 20.8Hz to 25.1Hz. The dominant frequency range of processed EMGdi signals by ICA–Wavelet is 91.47Hz. It means that the frequency range of processed EMGdi signals by ICA–Wavelet changed from that of the original ECG signal to that of the pure EMGdi signal. In this sense, HP method has no significant improvement in performance of reducing interference, as the dominant frequency range of processed EMGdi signals by HP method is 33.9–83.3Hz. NLMS even has worse performance because the associated CF values, ranging from 33.3Hz to 35.1Hz, are similar to that of pure ECG signals. It means that there is still significant ECG interference after processing by NLMS.In this experiment, we focus on the robustness of our algorithm with applying it to the data detected at different status of patient. It is recognized that there are some different features between the EMGdi signals from patient and healthy human [1–4]. In order to illustrate the general applicability of the method proposed in this paper, another representative clinical data was obtained from two different states: patients with sleep breathing disorders and sitting during the signal acquisition. Cohen in [29] indicated that the CF reference value of EMGdi is in the 80–130Hz range and pointed that patients with chronic obstructive pulmonary diseases had a lower significantly CF than that of healthy. The EMGdi CF of healthy human has a relatively fixed value. However, the EMGdi signal CF of the patient may has different degree of reduction with different causes of disease.In this paper, we select 5-channel EMGdi signals we noted as raw signal 1 acquired from patients during sleep for analysis. As shown in Fig. 13, it contains 4 cycles of EMGdi signals and 12 cycles of ECG signals. The EMGdi signal enhancement results processed by ICA–Wavelet are shown in Fig. 14, which indicate that the 12 cycles of ECG signals in time-domain are greatly reduced. Meanwhile, comparisons of the CF values (see Table 3) between raw EMGdi and processed results are consistent with this conclusion. With the dominant CF of raw signals ranging from 21.3Hz to 23.0Hz, the CF value range of the processed results is increased to 83.6Hz to 99.6Hz. Through the proposed ICA–Wavelet method, the extent of the CF value varying from the range of the typical ECG signals to that of typical EMGdi signals shows that the method proposed in this paper is effective in ECG interference removal.Another data sections we noted as raw signal 2 were presented with 20,000 points of the patient when he was sitting, as shown in Fig. 15. It contains 2 cycles of EMGdi signals and 12 cycles of ECG signals on each channel signal. We can see from Fig. 15 that the features of EMGdi signal were seriously masked by the ECG interference. The results of ECG interference reduction by the proposed method are shown in Fig. 16, from which the quality improvement of EMGdi signals is evident. Table 3 provides the result of CF values, it shows that the CF values have been changed from 20.8–24.5Hz to 82.6–93.9Hz, namely, changing from frequency range of typical ECG signal to that of the typical EMGdi signal. The experimental results obtained above shows that the ICA–Wavelet method exhibits promising performance of removing ECG interference for practical clinical data. With the help of the proposed ICA–Wavelet interference reduction method, we can see that purified EMGdi signals from patients during sleeping exhibit different patterns with that from patients during sitting, which can be employed to facilitate further diagnosing and analyzing of respiratory muscle fatigue [29].

@&#CONCLUSIONS@&#
