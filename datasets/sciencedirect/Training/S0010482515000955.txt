@&#MAIN-TITLE@&#
A software platform for phase contrast x-ray breast imaging research

@&#HIGHLIGHTS@&#
A simulation platform dedicated for PhC x-ray breast imaging research is developed.Various in complexity phantoms for PhC (from simple cuboids to anthropomorphic breasts) are modelled.Generation of PhC images from thick objects (breast models) is now feasible.Simulation results are validated against measurements performed at ESRF.Experimental studies on PhC may be optimized in advance.

@&#KEYPHRASES@&#
Phase contrast imaging,In-line x-ray Imaging,Modelling and simulation,Synchrotron facilities,Breast imaging,Breast phantoms,

@&#ABSTRACT@&#
PurposeTo present and validate a computer-based simulation platform dedicated for phase contrast x-ray breast imaging research.MethodsThe software platform, developed at the Technical University of Varna on the basis of a previously validated x-ray imaging software simulator, comprises modules for object creation and for x-ray image formation. These modules were updated to take into account the refractive index for phase contrast imaging as well as implementation of the Fresnel–Kirchhoff diffraction theory of the propagating x-ray waves. Projection images are generated in an in-line acquisition geometry. To test and validate the platform, several phantoms differing in their complexity were constructed and imaged at 25keV and 60keV at the beamline ID17 of the European Synchrotron Radiation Facility. The software platform was used to design computational phantoms that mimic those used in the experimental study and to generate x-ray images in absorption and phase contrast modes.ResultsThe visual and quantitative results of the validation process showed an overall good correlation between simulated and experimental images and show the potential of this platform for research in phase contrast x-ray imaging of the breast. The application of the platform is demonstrated in a feasibility study for phase contrast images of complex inhomogeneous and anthropomorphic breast phantoms, compared to x-ray images generated in absorption mode.ConclusionsThe improved visibility of mammographic structures suggests further investigation and optimisation of phase contrast x-ray breast imaging, especially when abnormalities are present. The software platform can be exploited also for educational purposes.

@&#INTRODUCTION@&#
X-ray breast imaging modalities like the traditional two-dimensional (2D) mammography and the advanced three-dimensional (3D) breast tomosynthesis use low-dose projection images of the breast acquired with dedicated x-ray based mammography systems. In 2D mammography, the typical breast screening exam includes two x-ray images of each breast taken at craniocaudal and mediolateral oblique views. In breast tomosynthesis, a limited number of x-ray projection images of the breast (typically 9 to 25) are acquired, while the x-ray source and the detector rotate along an arc around the breast. The projection images are then used with reconstruction techniques to provide a pseudo 3D image of the breast. In such exams, the total absorbed dose in the breast is typically in the order of a few mGy (0.6 to 4.0mGy) [1,2]. Each mammogram presents a 2D distribution of the intensity of the x-rays reaching the detector. This type of projection imaging is based on the absorption properties of the various breast tissues and when applied to dense breasts, it may impair the task of diagnosing tumour-like structures due to the superposition of large areas of normal glandular tissue. The overlapping of tissue structures is partly removed in the 3D tomosynthesis acquisition. However, an additional limitation of such 2D or 3D imaging modalities applied to the breast, is that they are based on x-ray absorption in the breast, where attenuation coefficients of normal and cancerous breast structures (like invasive/non-invasive ductal and lobular carcinoma) are very close and the resulting subject contrast is less than 10%, typically [3,4].Phase-contrast (PhC) imaging uses a different approach that has proved to increase the visibility of internal details in objects (e.g. biological tissues) composed of elements with low atomic number [5]. PhC exploits the differences between the refractive index of different materials to improve the visibility between these structures in 2D x-ray images. Different techniques have been developed for detecting PhC effects. In the in-line (or so-called propagation based) PhC imaging, contrast enhancement effects are produced with an x-ray source characterized by a certain degree of lateral spatial coherence, by recording the diffracted and refracted wave field downstream of the irradiated object, with a suitable high resolution area detector [5,6]. In such a scheme, the visual appearance of PhC effects in the final image is a characteristic contrast enhancement at the interfaces between structures with different x-ray refractive indices.The clinical implementation of every new imaging modality, however, is preceded by an optimisation work focussed on optimal energy and acquisition geometries which both depend on the sample, type of the detectors and phase retrieval algorithms in respect to the visibility of structures of interest (breast lesions). The best approach to carry out optimisation work is by the use of computer modelling and simulation.Most computer simulations performed in the field of PhC are limited to the use of simple phantoms, composed of few geometrical forms like cylinders and spheres that approximate fibers and tumours in the breast tissue. These geometries are adopted in investigations on the optimal geometrical distances like the distance object-to-detector as a function of the object shape and its size [7–11]. Investigations also focussed on the influence of the pixel dimensions on the PhC signal [10], on the development of phase retrieval algorithms [11], to study the suitability of inverse Compton sources for PhC mammography [12], on comparison of several methods for phase retrieval for CT imaging [13,14]. All these are carried for in-line phase contrast. These simple phantoms play an important role in setting and optimising the imaging technique. Computational phantoms characterised with increased complexity are also required to test and evaluate the performance of advanced 3D imaging techniques. In the case of breast imaging, the use of advanced breast phantoms would allow to perform accurate breast dosimetry, to investigate the effect of different imaging acquisition parameters on the quality of breast structures on images, to test and optimise novel and existing reconstruction techniques, etc. Recent simulations in the field of in-line PhC mammography were performed with an average compressed breast modelled as a homogeneous slab and abnormalities represented by spheres and cylinders with different diameters [12,15–17]. Further investigations in this field, however, require simulations with more complex, anthropomorphic breast phantoms.X-ray PhC effects can be simulated in several ways. One possible approach is the analytical one, based on the wave-optical theory (Fresnel–Kirchhoff diffraction integral and paraxial approximation) [18]. This method allows evaluating the diffraction angle of photons exiting from the object by means of simple equations [19]. In some papers, the Wigner distribution formalism was applied to modelling the phase effects [20]. Another approach is the use of an advanced wave-optical method proposed by Bravin et al. [21]. The approach was applied successfully to simulate diffraction enhanced x-ray imaging with large and thick objects, eliminating the assumption of the usual ‘weak object approximation’. Monte Carlo methods were utilised to simulate the refractive x-ray interactions [15,22,23]. However, the use of Monte Carlo techniques is still a challenge in the field of PhC imaging and simulations are still at the initial stage.There are few published simulation platforms for PhC dedicated to 2D and 3D x-ray breast imaging. The most complete one is the Virtual X-ray Imaging (VXI) [9,19], based on a computer code dedicated to the simulation of radiographic, radioscopic or tomographic procedures [24,25]. The PhC effects are simulated based on the Fresnel–Kirchhoff integral and they can be integrated with computer-aided design objects and objects based on non-uniform rational B-spline. The usefulness and application of this code have been shown by simulating simple objects like cylinders and spheres as well as objects of different shapes embedded into a 1.5-mm thick bounding box.Our goal is to develop and evaluate algorithms for volumetric breast reconstructions from PhC x-ray projection images, obtained in a tomosynthesis setup. The first stage of this project aims at the development of a software tool for generation of PhC x-ray images from simple phantoms as well as from more complex breast-like models. This paper presents the results from the development, validation and the initial testing of the simulation platform dedicated to PhC breast imaging studies. The validation study involved comparison of simulated images of simple phantoms with those obtained from experimental work carried out at the European Synchrotron Radiation Facility (ESRF), Grenoble, France. The in-line (or so-called propagation based) acquisition geometry was used [6]. The developed platform was exploited to generate PhC x-ray images from complex inhomogeneous and anthropomorphic breast phantoms.Fig. 1 shows the in-line configuration adapted for simulation of PhC x-ray images. The wave propagation is modelled based on the Fresnel–Kirchhoff diffraction theory [18]. A pure coherent radiation of wavelength λ is considered, emerging from a point-like monochromatic source, located at a distance zsofrom the object plane. The object is placed in a plane located at z=0 and the detector is located at a distance zodfrom the object plane.The electric wave field in the free space, detected at a distance r from the source, has the following expression:(1)E(xi,yi)=Areikr=Areik(xi−xs)2+(yi−ys)2+z2where A is the amplitude of the wave that originates in the source point (xs, ys) located in the source plane, (xi, yi) are the coordinates of the detection point on the detector plane, r2=(xi2+yi2), z=zso+zod, whilek=2πλis the wavenumber. In mammography, incident x-ray photons are in the energy range 10–32keV, with a mean photon energy in the range 17–22keV. For this range, the corresponding wavelength, λ varies between 56pm and 73pm. Since the tissue features of diagnostic interest in the breast have much greater size compared to these wavelengths, then one can apply the small angle approximation [z2≫(xi−xs)2+(yi−ys)2] to Eq. (1), which then becomes(2)E(xi,yi)=Areikr=Areikzeik(xi−xs)2+(yi−ys)22zWhen a wave interacts with an object, both its amplitude and phase are modified. The waves (either interacting or not) detected at a point (xi, yi) in the detector plane then may be expressed in the following form:(3)Ei(xi,yi)=−iλ∬Eo(xo,yo)OTF(xo,yo)eikrodrodcos(θ)dxodyowhere (xo,yo) are the coordinates of a point in the object plane, which becomes a source of new wave, and E0 is the incident upon the object plane (z=0) wave (E(xo,yo)=(A/rso)eikrso). The cos(θ) term corresponds to the Fresnel’s assumption that only the forward-propagating part of the spherical waves is to be retained. The function OTF is the object transmission function and it is a 2D function in a plane perpendicular to the x-ray projection direction, placed close behind the object:(4)OTF(xo,yo)=e−∫0siδ(r)2πλdre−∫0sµ(r)2dr=e−i2πλ∫0sδ(r)dre−∫0sµ(r)2dr=eB(xo,yo)eiΦ(xo,yo)here, Φ and B are the amount of the phase change and amplitude attenuation in traversing the biological tissue, s is the total path through the object, µ(r)=4πβ(r)/λ is the linear attenuation coefficient of the tissue in the specified point, while δ(r) is the refractive index decrement of the tissue and β(r) is the absorption coefficient.In the case of small angle approximation, Eq. (3) is transformed as follows:(5)E(xi,yi)=−iλAzsozodeikz∬OTF(xo,yo)eik(xo−xs)2+(yo−ys)22zsoeik(xi−xo)2+(yi−yo)22zoddxodyoSimulations are based on Eq. (5): depending on the distance zod(simulating Fresnel or Fraunhofer approximations), it is numerically solved using either the Fourier transform approach (Eq. (6)) or the convolution approach (Eq. (7)):(6)E(xi,yi)=−Aiλzsozodeikzeik2zod(xi2+yi2)∬[OTF(xo,yo)eλiπMzod[(xoλzod)2+(yoλzod)2]]e−2πi(xoxiλzod+yoyiλzod)dxodyo,E(xi,yi)=−AiλzsozodeikzPz(xi,yi)∬[OTF(xo,yo)Pz(xo,yo)]e−2πi(xoxiλzod+yoyiλzod)dxodyoPz(xi,yi) being the Fresnel propagator with unit modulus and M=z/zod.(7)E(xi,yi)=−Aieikzλzsozod∬OTF(xo,yo)eik(xo2+yo2)2zsoeik2zod[(xo−xi)2+(yo−yi)2]dxodyoE(xi,yi)=−Aieikzλzsozod∬OTF(xo,yo)Pz(xo,yo)eik2zod[(xo−xi)2+(yo−yi)2]dxodyo=AeikzzsoIFFT|(F(u,v)H(u,v))|,F(u,v) and H(u,v) are the Fourier transforms of OTF(xo,yo)Pz(xo,yo) andeik2d[(xo−xi)2+(yo−yi)2], while the symbol IFFT indicates the inverse Fourier transform of the product of F(u,v) and H(u,v).For thick objects, the multislice approximation described in [26] is applied. The object is divided into slices and Eq. (6 and 7) are recursively implemented. The wave propagates from slice z to slice dz, then from slice z+dz to slice z+2dz, … until it arrives at the exit surface of the phantom. The relative intensity distribution on the detector can be described asI(xi,yi)=|E(xi,yi)E0(xi,yi)|2.Three physical phantoms that differ in their content and complexity, as described inTable 1, were produced for the experimental work: (a) a phantom with four air channels having a diameter of 1mm, drilled within a polymethyl methacrylate (PMMA) slab of size 6cm×6cm×4cm (specified as Ph1 in Table 1); (b) a phantom with three silica gel spheres soacked with water, placed within a paraffin slab at different heights (specified as Ph2 in Table 1); (c) a paraffin slab tightly filled with spheres made from silica gel filled with water (specified as Ph3 in Table 1). Two of the phantoms used in the experimental study are shown inFig. 2. The first two phantoms listed in Table 1 were used to adjust software application parameters and to validate simulated images. The air in Ph1 does not represent a realistic scenario when a breast is concerned; however, it allows obtaining of high-contrast images of materials and shapes of different but known chemical compositions. Together with the second phantom, they turn out to be a good choice when a verification of a technique is performed. The third phantom is much more breast-oriented.Six software phantoms were created in order to test and validate the software code: (a) a simple phantom consisting of a thin nylon wire 0.1mm in diameter placed free in the air; (b) computational versions of the three physical phantoms used in the experimental study and described in Table 1; (c) two software breast phantoms.Fig. 3 shows four of the six software phantoms used in the study: a paraffin slab phantom with water-filled spheres (Fig. 3a), a paraffin slab phantom with three water spheres embedded within the slab (Fig. 3b), a software breast phantom composed of acrylic spheres placed within a semi-cylinder filled with water (Fig. 3c, first row) and an anthropomorphic software breast phantom (Fig. 3c, second row).The computational phantoms were designed with the phantom modelling module of the XRAYImagingSimulator [27]. The anthropomorphic breast phantom shown in Fig. 3c was designed with the BreastSimulator software code [28]. The phantom shown in Fig. 3a consists of 157 spheres, while the phantom that simulates the compressed breast (Fig. 3c, first row) is composed of about 33,000 spheres. The latter phantom represents a software model of the physical phantom that was previously developed, validated and tested for the purposes of 2D mammography and breast tomosynthesis [29]. The phantom is composed of two main parts: an acrylic semi-cylinder container with height, 58mm, and diameter, 200mm, and equal volumes of acrylic spheres of various diameters: 15.88mm, 12.70mm, 9.52mm, 6.35mm, 3.18mm and 1.58mm. As in the physical phantom, the total volume of each different sphere type was set to 60,806mm³.The software breast phantom shown in Fig. 3c, second row, represents a computed 3D uncompressed breast of small size [30]. The glandular portion occupies 21% of the breast volume which was calculated to be 77cm3. The breast model was compressed to a thickness of 2.6cm; subsequently, a water sphere of diameter 10mm was inserted, in order to simulate a breast mass.Software phantoms were explicitly modelled according to dimensions and materials used in the experimental samples. The elemental composition of the materials by weight, together with the densities used in simulations, is reported inTable 2. Mass attenuation coefficients for the individual elements that are present in the mixture were taken from the XCOM Photon Cross Sections Database from NIST [31].The experimental work has been carried out at the ID17 Biomedical Beamline at the European Synchrotron Radiation Facility [32], Grenoble, France. The experimental arrangement used for this study is schematically shown inFig. 4a and b for the phase contrast and the absorption modes, respectively. The beam width and height were 100mm×4mm.The x-ray detector was a high resolution ‘FReLoN’ CCD camera with an active input surface of 94mm×94mm [33]. The phosphor screen was Gd2O2S:Tb with a thickness of 60µm. Images were acquired with size of 2048×2048pixel and a pixel size of 47µm×47µm. The distance between the x-ray source and the front of the detector was 155m. The object-to-detector distances were 0.17m and 11m for absorption and phase contrast acquisition modes, respectively.Phantoms were placed on a motorized stage that could perform micrometric movements along the directions: vertical, horizontal and rotational (around a vertical axis). The image acquisition for each projection comprised 30 adjacent frames in total, while moving the stage vertically. Each frame contained 55 detector lines. All images were corrected by subtracting a dark-current image and then by normalising to the flat-field image acquired at the same energy, without the sample in the beam. Then, the final projection image was assembled from its component frames. The incident exposure was monitored by a calibrated TW 31010 dosimetry chamber (PTW-Freiburg, Freiburg, Germany), placed horizontally at a distance of 7m away from the detector surface. Incident monochromatic photon energies of 25keV and 60keV were used. Incident exposure was set to 2.15mGy and 3.25mGy per projection acquisition at 25keV and 60keV, respectively. Effective pixel size was estimated before each experiment. Experiments were repeated for both absorption (0.17m detector distance) and phase contrast modes (11m detector distance).The XRAYImagingSimulator is an in-house developed software platform dedicated for in silico investigations in the field of absorption x-ray imaging [27]. Main parts are the module for object creation and the module for x-ray image formation. Computational phantoms are either composed of simple 3D geometrical primitives or represented by 3D arrays of voxels. X-ray images are simulated by exploiting the concept of ray tracing, as this includes the definition of the ray and its intersections with the objects. The x-ray image is formed by using the analytical Lambert–Beer’s expression to calculate the x-ray energy of the photons transmitted through the phantom that reach the detector surface.The source code of the XRAYImagingSimulator is structured to allow building and adding new approaches for x-ray image simulation. Based on this, a new module has been developed dedicated to the generation of PhC images. This module included the following new features: (a) calculation of the complex refractive index, n, for each material included in the simulated phantom; (b) implementation of projection approximations to calculate the 2D distributions of the two functions Φ and B (Eq. (4)); (c) multislice approximation implementation; (d) calculation of final PhC images by using both fast Fourier transform and convolution approaches.The complex refractive index,n=1−δ+iβis calculated by taking into account thatδ=(reλ2/2π)Ne, where reis the classical electron radius, while Neis the electron density of the tissue. For each element and composition, Neis calculated, knowing the chemical formula for each material simulated. To speed up calculations in the x-ray tracing subroutine, OpenMP was used. The software phantoms were divided in thin sections (slices) during the ray tracing process. Two-dimensional distributions of the two functions, Φ and B, were generated for each object slice, and those are subsequently used as input for the subroutine for the calculation of the final PhC image. The slice thickness depends on the size a of the finest features within the phantoms to be imaged, the phantom thickness d itself and the x-ray energy (in order to assume the condition of the projection approximation). In our phantoms, the size a of the finest features within the phantoms with thickness d that were imaged (and simulated) were larger than 1mm. As discussed by other authors [19], the phantom can be accepted to be “thin” as long as the smallest feature size a is larger thanλd. The incident energy for most experiments was 25keV that corresponds to a wavelength of 0.05nm. For a phantom thickness of 40mm, the size of the finest feature to be imaged should be larger than 1.41µm. In this case, the application of the multislice theorem was avoided.X-ray images were simulated with the analytical approach. Poisson quantum noise was subsequently added to the original calculated images. A Poisson random generator was used, with a variance set equal to the number of photons that are incident on each detector pixel. The number of photons that impinge on the phantom was calculated from experimentally measured exposure at the phantom surface, similarly to the approached used in [30]. Detector blurring was simulated by a Gaussian point spread function with full-width-half-maximum (FWHM) of 30.8µm [34]. A point x-ray source was considered. Additional noise was not simulated. Images with a size of 104×104 square pixels with a pitch of 10µm were generated for each phantom: they were software versions of the physical ones, and they were convolved with the point spread function of the detector. Then, this high resolution image was down-sampled to an image with a pixel size equal to the corresponding size in the experimental images. In all cases, the simulated distances from the source to the object and from the object to the detector were set equal to the experimental distances. The software package is running under Windows as a standalone application with a graphical user interface. The executable for Windows, with relevant help and demo files, can be obtained for free, upon request [35], by any research team working in the field.

@&#CONCLUSIONS@&#
A software platform dedicated to phase contrast breast x-ray imaging has been developed, validated and tested to generate images of complex anthropomorphic breast phantoms for in-line phase contrast acquisition setup. Results indicate good agreement between simulated and experimental images, acquired at a synchrotron radiation source. Phase contrast images of modelled and physical phantoms showed improved visualization of edges of the different objects included in these phantoms compared to images obtained in absorption mode, as predicted by in-line phase contrast x-ray imaging theory and well confirmed in the related literature. However, for complex breast anthropomorphic phantoms, results need further validation. The developed platform will be exploited further for research in 3D phase contrast breast imaging techniques and for educational purposes, as well as for the development of a dedicated physical breast phantom for research in this field.None declared.