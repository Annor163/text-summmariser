@&#MAIN-TITLE@&#
Feasible partition problem in reverse convex and convex mixed-integer programming

@&#HIGHLIGHTS@&#
We study the consistent partition problem in reverse convex and convex mixed-integer programming.We show that an infeasible system can be partitioned into two disjoint feasible subsystems.Polynomial time algorithm to generate the partition has been proposed.Algorithm for a maximal partition has been provided.

@&#KEYPHRASES@&#
Integer programming,Infeasibility,Reverse convex and convex constraints,Feasible partition and maximal consistent partition problem,

@&#ABSTRACT@&#
In this paper we consider the consistent partition problem in reverse convex and convex mixed-integer programming. In particular we will show that for the considered classes of convex functions, both integer and relaxed systems can be partitioned into two disjoint subsystems, each of which is consistent and defines an unbounded region. The polynomial time algorithm to generate the partition will be proposed and the algorithm for a maximal partition will also be provided.

@&#INTRODUCTION@&#
One of the fundamental issues in constrained optimization is to determine whether or not the system of inequality constraints defining the feasible region is consistent. The importance and various aspects of infeasibility analysis in linear systems and in some types of nonlinear systems have been discussed by many authors (Amaldi & Kann, 1995; Amaldi & Mattavelli, 2002; Chakravarti, 1994; Chinneck & Dravnieks, 1991; Chinneck, 1995, 2008; Greenberg, 1996; Obuchowska, 1998, 1999, 2010a, 2010b). In both linear and nonlinear case a common approach is to isolate an irreducible infeasible set (Chinneck & Dravnieks, 1991; Chinneck, 1995, 2008; Obuchowska, 1998, 1999, 2010a, 2012), or to find a smallest number of linear constraints to remove, such that the remaining constraints form a feasible set (referred to as MIN ULR (Amaldi & Kann, 1995)). The latter problem is equivalent to finding the maximum cardinality feasible subset in an infeasible set of inequality constraints (MAX FS). It has been shown that these problems (i.e. MIN ULR and MAX FS) are NP-hard even in linear systems (Amaldi & Kann, 1995; Chakravarti, 1994).A closely related problem to MAX FS problem is to find a partition of the infeasible system into a minimum number of feasible subsystems (Amaldi & Mattavelli, 2002). While the system defining MIN ULR may be in general infeasible, it has been proved by W. Pulleyblank and others and shown by Greenberg (1996) that any inconsistent set of linear (continuous) inequalities can be partitioned into two sets that are both feasible. In this paper inspired by the above result, we consider the problem of the feasible partition in the following more general system of reverse convex constraints defined over the set of integers:(1)fi(x)⩾0,i∈J,x∈Zn,and in the corresponding relaxed system, whereJ={1,2,…,m}, andfi(x),i∈J, are either faithfully convex functions or a composition of convex increasing functions and convex multivariate polynomials, which in particular includes convex multivariate polynomial functions. The relaxed system corresponding to (1)(2)fi(x)⩾0,i∈J,x∈Rn,defines the regionR={x∈Rn|fi(x)⩾0,i∈J}, and the region defined by the system (1) is denoted byG={x∈Zn|fi(x)⩾0,i∈J}.We also address the problem of the feasible partition in convex systems, defined over the set of integers:(3)fi(x)⩽0,i∈J,x∈Zn,and in the corresponding relaxed systems(4)fi(x)⩽0,i∈J,x∈Rn,for the same classes of convex functions, assuming that they satisfy some additional condition.Optimization problems with constraints (1)–(4) formulated above have important applications in operations research, mathematical economics and various engineering problems (Hillestad & Jacobsen, 1980; Horst & Tuy, 1993; Horst & Pardalos, 1995; Jacobsen, 2001; Li & Sun, 2006; Nemhauser & Wolsey, 1988; Pardalos & Romeijn, 2002; Pardalos & Rosen, 1986; Schrijver, 1986; Tuy, Thieu, & Thai, 1985; Ueing, 1972). For instance, integer programming problems with a concave objective (cost) function, are often encountered in optimization models involving economies of scale. These problems can be equivalently formulated as problems with linear objective function and an additional reverse convex constraint.Furthermore, some classes of integer programming problems can be formulated equivalently as concave programming problems or an optimization problem with reverse convex constraints. For instance problems with integer constraintsxi=0or 1 can be cast into reverse convex form as-xi+xi2⩾0,0⩽xi⩽1.Several classes of optimization problems involving reverse convex constraints and methods of their solution were studied by many authors, in particular by Ueing (1972), Hillestad and Jacobsen (1980), in Horst and Tuy (1993), in Ben-Saad and Jacobsen (1990), in Jacobsen (2001) and by this author in Caron and Obuchowska, 1992, Obuchowska (2007, 2010b, 2012). These methods, as well as other algorithms for global constrained (continuous or integer) optimization problems are based upon the assumption that the set of optimal solutions is nonempty and compact, although there are many concave optimization problems, which do not satisfy these requirements. The boundedness of reverse convex systems was investigated in Caron and Obuchowska (1992), Obuchowska (2007, 2010b) and feasibility was studied recently in Obuchowska (2012), where the constraint functions included in particular convex multivariate functions. Since similar situation also occurs in convex optimization, the issue of boundedness and feasibility of the feasible region was addressed subsequently for continuous programs in Obuchowska (1998, 1999, 2006, 2007) and for convex integer programs in Obuchowska (2008, 2010a), where the functions defining the inequality constraints were either quasi-convex multivariate polynomials or faithfully convex.We will begin with recalling that a convex functionfi(x)is faithfully convex (Rockafellar, 1970b) if it can be represented in the formfi(x)=Fi(ci+Bix)+〈bi,x〉-di, whereFiis a strictly convex function defined onRpi, (for somepi⩽n,pi∈N),Bi∈Rpi×n, (whereBiare full-row rank matrices),ci∈Rpi,bi∈Rn,di∈R,i∈J.A vector s is called a direction of recession of f, if for every x the functionf(x+ts),t∈R, is nonincreasing function of t (Rockafellar, 1970a). The set of all vectors of recession of the function f forms a convex cone, called the cone of recession, denoted by0+f. We assume that in case the functionsfi,i∈Jare faithfully convex, then they satisfy the following condition:(5)s∈0+fi⇒Bis=0,i∈J.We note that convex multivariate polynomials and functions of the formf(x)=(〈x,Ax〉)r2+〈b,x〉-d, wherer⩾1, andA∈Rn×n, is positive semidefinite, belong to the class of faithfully convex functions satisfying condition (5). We also consider the class of functions of the formf(x)=h(p(x)), where h is a convex increasing function fromRtoRandp(x)is a convex multivariate polynomial. Convex multivariate polynomials belong to this class as well, which can be seen usingh(t)=t.Although both classes of functions used in this paper are very important in optimization theory and practice, the most attention has been given to date to convex and quasi-convex multivariate polynomials, which have been studied by many authors, for instance in Bank and Mandel (1988), Belousov and Andronov (1993), Belousov and Klatte (2002), Jeyakumar and Li (2011), Li (2010), Obuchowska (2006, 2008).In this paper, which is a continuation of our recent study of infeasibility in reverse convex mixed-integer programming in Obuchowska (2012), we show that for the considered classes of convex functions, both integer and relaxed system can be partitioned into two subsystems each of which has a solution and the respective feasible regions are unbounded. The polynomial time algorithm to generate the partition has been proposed and an algorithm for a maximal partition has been also given.The problem of the consistent partition in reverse convex and convex mixed-integer programming considered in this paper is motivated by its potential applications in infeasibility analysis, and practical importance of MAX FS and MIN ULR problems, to which the partition problem is related.The paper is organized as follows. In Section 2, which provides mostly auxiliary results used in the remaining part of the paper, we consider the feasible partition problem in linear integer systems, which in particular may include explicit equalities. In Section 3 we extend the results of Section 2 to systems of reverse convex inequality constraints, and in Section 4 we study the problem of feasible partition in systems of convex inequality constraints. We note that while the results developed in Sections 3 and 4 apply to the same two classes of convex functions, namely to faithfully convex functions and functions defined as a composition of convex increasing functions and multivariate polynomials, in Section 4 it was necessary to assume that none of the linear terms offi(x)is a linear combination of the rows of the matrices defining all nonlinear terms. The latter assumption was necessary, since otherwise as illustrated in a simple example, it is not possible in general, to partition a convex infeasible system into two feasible subsystems.We observe that since all results proved in this paper hold for both the integer systems with reverse convex and convex constraints (1) and (3) respectively, as well as for the corresponding relaxed systems (2) and (4), we can conclude that they also apply to the mixed-integer programming problem of the same structure, where only some of the variables are assumed to be integer.In this section we investigate the problem of the maximal consistent partition, showing that any infeasible linear integer system can be partitioned into two subsystems each of which has an integer solution. Furthermore, we consider a system where both inequalities and explicit equations are included, showing that under certain conditions the system can be partitioned into two feasible subsystems. Suppose that we consider first the following inconsistent linear system defined over the set of integers(6)〈bi,x〉⩾di,x∈Zn,i∈J={1,2,…,m}wherebi∈Rnanddi∈R, for alli∈Jand the corresponding relaxed system(7)〈bi,x〉⩾di,x∈Rn,i∈J.Algorithm C1 below allows us to construct a fulldimensional polyhedral coneCwith a nonempty interior, such that any linex(t)=ts, with the integer direction vectors∈int(C), (where int(C), denote the interior of the coneC) intersects each hyperplaneSi={x|〈bi,x〉=di}in exactly one pointxi. The algorithm also produces a vectorx0∈C, which has all components rational provided that all vectorsbi,i∈Jare rational. We assume thatm>1, as otherwise the coneC={x|〈b1,x〉⩾0}andx0=b1.Algorithm C1(to construct a fulldimensional polyhedral coneCand a rational vector inint(C))Step 1.k≔1,C1≔b1.Step 2. Determine whether the optimal solutionz0of the LP:z0={maxz|〈Ci,x〉-z⩾0,i=1,2,…,k;〈bk+1,x〉-z⩾0;z⩽1}is positive. If yes, thenCk+1≔bk+1, otherwiseCk+1≔-bk+1.Step 3. Setk≔k+1. Ifk<mgo to Step 2.Step 4. Define the coneC={x∈Rn|〈Ci,x〉⩾0,i∈J}and find the optimal solution(x0,z0)of the LP problemz0=max{z|〈Ci,x〉-z⩾0,i∈J;z⩽1}to determine the rational vectorx0∈int(C). Terminate the algorithm by going to Stop.Stop.Algorithm C1 requires solution of at mostm-1linear programming problems having a special structure, that is the fulldimensional coneCand an integer vectors=nx0∈int(C)can be obtained in a polynomial time. This is due to the fact that the linear programming problem can be solved in polynomial time (Karmarkar, 1984).Lemma 2.1The polyhedral coneC, constructed byAlgorithm C1has the following properties:(i)dim(C)=n,int(C)∩Zn≠∅andfor anys∈int(C), the linex(t)=tsintersects each hyperplaneSi={x|〈bi,x〉=di}in exactly one pointxi.The fact that the coneCis fulldimensional is assured by the construction process described in the algorithm. We observe that in order for the vectorx0generated by the Algorithm C1 to have rational coefficients, it is necessary to assume that all coefficients of the vectorsbi,i∈Jare rational. However all three properties stated in this lemma are valid for anybi∈R,i∈J. To show that the coneCcontains infinitely many integer vectors, we will show first that the coneCcontains at least one integer vector in its interior. Letxˆ∈int(C). Sincexˆis in the interior of the fulldimensional cone, then there exists∊>0, such that the open ballB(xˆ,∊)={x∈Rn|‖x-xˆ‖<∊}belongs to int(C). The ballB(xˆ,∊)contains a point, sayx¯, with all coefficients rational. There is a positive integern¯0, such that the vectorx¯0=n0x¯is integer and indeednx¯0∈int(C),∀n⩾n¯,n∈N.To prove part (iii) lets∈int(C). We definexi,i∈Jas a point of intersection of the planeSiwith the linex(t)=ts,t∈R, asxi=tis, whereti=di〈bi,s〉. Indeed the construction process of the coneCassures that〈bi,s〉≠0, sinces∈int(C)⇒〈bi,s〉<0or〈bi,s〉>0,∀i∈J,which completes the proof of the lemma. □A feasible subsystem of the integer system (6) (or of the corresponding relaxed system (7)) is called maximal, if addition of any of the remaining constraints changes its status to infeasible. A feasible subsystem of the system (6) (or respectively (7)) is called the maximum feasible subsystem, if there is no other feasible subsystem of a larger cardinality.Thus every maximum feasible subsystem is also a maximal subsystem, though some maximal subsystems may have the number of constraints too small to qualify to the former category. While the maximal feasible subsystem in a linear program can be found by solving a finite number of linear programs, the problem of finding the maximal feasible subsystem in the corresponding integer linear system is NP-hard in general. This follows from the fact that in order to find a maximal feasible subsystem in the integer linear program it is necessary to solve integer linear programs which cannot be solved in polynomial time. On the other hand, as shown in Amaldi and Kann (1995), Chakravarti (1994) the problem of finding the maximum feasible subsystem is NP-hard even for linear noninteger systems (7).It has been shown in Greenberg (1996), that the maximal consistent subsystem of the linear system (7) can be found by partitioning the system into two feasible subsystems.Suppose that the system(7)is inconsistent. Then there exists a partition of the set of inequality constraints in(7)into two disjoint subsetsJ1andJ2, whereJ1∪J2=J, such that each subsystem is consistent and the system of constraints inJ1is a maximal consistent subsystem.□The theorem below extends the above result to linear systems defined over the set of integers.Theorem 2.2Suppose that there is no integer solution to the system(6). Then(i)There exists a partition of the set of m inequality constraints in(6)into two subsetsJ1andJ2whereJ=J1∪J2, andJ1∩J2=∅, such that each subsystem(8)〈bi,x〉⩾di,x∈Zn,i∈J1and(9)〈bi,x〉⩾di,x∈Zn,i∈J2is consistent and unbounded.There exists partition of the set J intoJ1′andJ2′whereJ=J1′∪J2′, andJ1′∩J2′=∅, such that subsystems corresponding to both sets of indicesJ1′andJ2′are consistent and the subsystem with indices inJ1′is a maximal consistent subsystem of the system(6). The setJ2′is an infeasibility set of the system(6)and the region defined by the constraints inJ2′is unbounded.The results stated in parts (i) and (ii) remain valid for the relaxed system(7).(i)Lets∈int(C)∩Zn, where the polyhedral coneCwas obtained by applying Algorithm C1. We define vectorsxi,i∈Jas described in the proof of the Lemma 2.1, i.e.xi=tis, whereti=di〈bi,s〉. Let us order the sequenceti,i=1,…,min the nondecreasing order. For simplicity of notation the same symbolsti,xi,bi, anddi,i=1,…,mwill be used for the reordered and reindexed system, i.e. we assume thatti⩽ti+1,i=1,2,…,m-1. Forx0=(t1-1)swe construct the index setsJ1={i∈J|〈bi,x0〉⩾di}andJ2={i∈J|〈bi,x0〉<di}.Lett¯∈Zbe such thatt¯⩽t1-1andtˆ∈Zbe such thattˆ⩾tm+1. It is easy to see that all integer vectors ns, wheren⩽t¯,n∈Z, satisfy all constraints in the system (8) and all vectors of the form ns, wheren⩾tˆ,n∈Z, satisfy all constraints in the system (9), which proves part (i) of the theorem.To construct the index setsJ1′andJ2′we will modify appropriately the setsJ1andJ2defined in the proof of the part (i) of the theorem. The index setJ1′is constructed by including first all constraints from the setJ1and subsequently updating the setJ1′by including only these constraints fromJ2which do not change the feasibility status of the resulting system〈bi,x〉⩾di,i∈J1′x∈Zn.This process assures that the system of constraints with indicesJ1′defines a maximal consistent subsystem of the system (6), and the setJ2′contains only indices of those constraints fromJ2which would make the region defined by constraints inJ1′empty. Furthermore, since the region defined by constraints inJ2as shown in part (i) is nonempty and unbounded then the inclusionJ2′⊆J2, assures that the system of constraints with indices inJ2′has the same properties.Proof can be obtained from the proof of parts (i) and (ii) by removing assumption that x is integer.□The following example illustrates results in Lemma 2.1 and Theorem 2.2.Example 2.1Let us consider the following infeasible linear system:x1⩾0,x2⩾-1,-x1⩾-1,-x2⩾-2,-x1-x2⩾3,x1,x2∈Z.Applying Algorithm C1 yields the following coneC={x∈R2|x1⩾0,x2⩾0}. We selects=(1,1)∈int(C)∩Z2. Suppose that the inequality constraints are indexed in the order they are listed. Then we have the following points of intersection of the lines(t)=t(1,1)with the hyperplanesS1,S2,…,S5:y1=(0,0),y2=(-1,-1),y3=(1,1),y4=(2,2),y5=-32,-32. Applying the construction process described in the proof of Theorem 2.2 (i) withx0=(-3,-3)results in the partition of the given system into the following two feasible and unbounded subsystems:J1={3,4,5}andJ2={1,2}. It is easy to see that all integer vectors of the form(n,n), wheren⩽-3,n∈Z, satisfy constraints with indices inJ1and all integer vectors(n,n), wheren⩾2satisfy constraints inJ2. Furthermore, the technique described in the proof of the part (ii) of the Theorem 2.2, generates the following maximal consistent subsystemJ1′={1,3,4,5}, andJ2′={2}, whereJ2′is an infeasibility set.□We note that an interesting approach to generate a direction vector of a line that intersects all hyperplanes has been provided by one of the anonymous referees of this paper. It relies on using the vectorv=(t,t2,…,tn)for some integer number t. Indeed for a randomly selected integer or rational number t there is no warranty that a vector v will have the required property, which becomes more likely in case of a large number of constraints m and of high dimension n, in addition to the fact that components of the vector v will grow exponentially with n. However it can be shown easily that there exist integer numberst1andt2, (t1<t2), such thatbiTv≠0for allt⩾t2andt⩽t1,∀i∈J. To determine the values oft1andt2we observe that since each of the polynomial equations(10)bi1t+bi2t2+…+bintn=0,i∈J,wherebi=bi1,bi2,…,bin, may have up ton-1real nonzero solutions, we can taket2>maxi∈J{maximal root of theith equation in(10)}andt1<mini∈J{minimal root of theith equation in(10)}.This means that to implement this approach algorithmically, methods for estimating lower and upper bounds for real roots of polynomial equations should be used, for instance applying Cauchy’s bound (Hirst & Macey, 1997).We observe that Theorem 2.2 cannot be generalized to the linear systems containing the set of explicit linear equalitiesAx=a, whereA∈Zp×n,a∈Zp. Such generalization is impossible even in case of continuous (noninteger) linear systems (Chinneck, 2008). We will show however that in case whenAx=ahas an integer solution, and the homogeneous systemAx=0has a nonzero solution, and the inequality constraints satisfy some additional assumption, then it is possible to partition the linear system, consisting of both equalities and inequalities, into two feasible subsystems, which have properties analogous to the properties proved in Theorem 2.2 for the systems containing only inequality constraints.LetC(AT)denote the column space of the matrixAT. We assume that either none of the vectorsbi,i∈J, can be represented as a linear combination of the rows of the matrix A, that isbi∉C(AT),∀i∈Jor the systemAx=a,〈bi,x〉⩾di,x∈Zn,i∈I,whereI={i∈J|bi∈C(AT)},has a solution.Theorem 2.3Assume that the following assumptions hold:(I)The linear systemAx=a, whereA∈Zp×n,a∈Zn, has an integer solutionx0andAx=0has a nonzero solution andem either the setI={i∈J|bi∈C(AT)}=∅, or(11)Ax=a,〈bi,x〉⩾di,x∈Zn,i∈I,has a solution. Then(i)The system(12)Ax=a,〈bi,x〉⩾di,x∈Zn,i∈Jcan be partitioned into two subsystems(13)Ax=a,〈bi,x〉⩾di,x∈Zn,i∈J1and(14)Ax=a,〈bi,x〉⩾di,x∈Zn,i∈J2,whereJ=J1∪J2, andJ1∩J2=∅, each of which is consistent and unbounded.There exists partition of the set J intoJ1′andJ2′whereJ=J1′∪J2′, andJ1′∩J2′=∅, such that subsystems(15)Ax=a,〈bi,x〉⩾di,x∈Zn,i∈J1′andAx=a,〈bi,x〉⩾di,x∈Zn,i∈J2′,are consistent and the system in(15)is a maximal consistent subsystem of the system(12). The setJ2′is an infeasibility set of the system(12)and the region defined by the constraints inJ2′is unbounded.The results stated in parts (i) and (ii) remain valid for a relaxed system corresponding to the system(12)without a need to assume thatA∈Zp×nanda∈Zm, and that the solutionx0of the systemAx=ais integer.Suppose that ifI≠∅,x0is an integer solution of the system (11), and in caseI=∅,x0satisfies only the system of equationsAx=a. Without a loss of generality let us assume that the matrix A is full-row rank anddim{x|Ax=0}=n-k. Letq1,q2,…,qn-k∈Zn, be linearly independent vectors with integer coefficients satisfying the systemAx=0. (We note that the vectorsq1,q2,…,qn-k∈Zn, can be easily obtained from rational, linearly independent vectors generated by applying the Gauss–Jordan elimination method to the systemAx=0). Let Q be then×(n-k)matrix whose columns are the vectorsq1,q2,…,qn-k. Thus the systemAx=a,〈bi,x〉⩾di,i∈J,can be equivalently represented in a form of the system:(16)x=Qy+x0,〈b¯i,y〉⩾d¯i,i∈Jwhereb¯i≔QTbi,d¯i≔di-〈bi,x0〉,i∈J, andy∈Rn-k. To show that the system of inequalities in (16) is well defined, suppose first thatI=∅. Since the set of vectorsq1,q2,…,qn-kare defining the null space of the matrix A and none of the vectorsbibelongs toC(AT), thenb¯i≠0,∀i∈J. In caseI≠∅, then for anyi∈I, we haveb¯i=0, andd¯i⩽0, since〈bi,x0〉⩾di,i∈I. Thus inequalities〈b¯i,y〉⩾d¯i,i∈I, are satisfied for anyy∈Rn-k. It is easy to see that assumption (II) in the theorem is necessary, since otherwise we would have〈0,y〉>0, for somei∈Iin (16). Now application of the Algorithm C1 to the system (16) will yield a cone, sayC‾, withdim(C‾)=n-k. On the other hand Theorem 2.2, will imply that the system (16) can be partitioned into two subsystems with indicesJ1andJ2respectively such that each of the subsystems(17)〈b¯i,y〉⩾d¯i,y∈Zn-k,i∈J1and(18)〈b¯i,y〉⩾d¯i,y∈Zn-k,i∈J2has an integer solution and its set of solutions is unbounded. Lety1andy2be integer vectors satisfying the system (17) and (18) respectively. Then we haveA(Qy1)=0andA(Qy2)=0andxi=Qyi+x0∈Zn,i=1,2, satisfy the systemAx=a. Unboundedness of the regions defined in (13) and (14) follows from the fact that the systems (17) and (18) have infinitely many integer solutions. This completes the proof of part (i) of the theorem. To prove part (ii) it is enough to apply the construction process outlined in the proof of the Theorem 2.2 (ii) to the system (13) consisting of the inequalities inJ1andAx=a, and to the second system containing only linear inequalities inJ2, i.e.〈bi,x〉⩾di,x∈Zn,i∈J2. Proof of part (iii) can be obtained from the proofs of parts (i) and (ii) by removing the assumption that x is integer. □We observe that the feasible partitions in parts (i) of Theorems 2.2 and 2.3 can be obtained in polynomial time, which follows from the fact that linear programming and Gaussian (or Gauss–Jordan) elimination can be performed in polynomial time, as shown by Karmarkar (1984) for linear programming and by Edmonds (1967) for Gaussian elimination.In this section we will generalize results proved in Lemma 2.1 and Theorem 2.2 for linear systems to systems of reverse convex constraints(19)fi(x)⩾0,x∈Zn,i∈J,wherem-2(or fewer) of m inequality constraints are defined by either faithfully convex functions satisfying condition (5) or by a composition of convex increasing functions and convex multivariate polynomials. We note that by Corollary 2.1 in Obuchowska (2012), the system (19) is always feasible if it contains less than 2 linear inequality constraints.The following corollary will be used in this paper. Let the symbolDp=represent the constancy space of the functionp(x), that is the set of vectors along which the functionp(x)is constant. It is well known that if a faithfully convex function (which includes convex multivariate polynomials) is constant along any line segment, then it is constant along any line parallel to the line segment. The constancy spaceDp=ofp(x)may be defined in terms of the set0+p(Rockafellar, 1970a) asDp=={y∈Rn|y∈0+p∧-y∈0+p}.Corollary 3.1Obuchowska (2010b)If all coefficients of the polynomialp(x)are integer then linear subspaceDp=may be described by a system of homogeneous linear equations with integer coefficients and the cone of recession0+pcan be represented by a system of homogeneous linear equations and one linear homogeneous inequality all with integer coefficients, i.e. there exist matrix G and vector g, both with integer entries only, such thatDp=={x∈Rn|Gx=0,〈g,x〉=0}and0+p={x∈Rn|Gx=0,〈g,x〉⩽0}.□Since in the remaining part of the paper we assume thatfiare either faithfully convex or a composition of convex increasing function and convex multivariate polynomial,fi(x)=hi(pi(x)), whenever the latter class of functions is considered, the matricesBiand vectorsbiare defined as stated in the Corollary 3.1. This means that the vectorsbicorrespond to the linear terms〈bi,x〉of the respective polynomialspi(x), and the matricesBisatisfyDpi=={x∈Rn|Bix=0,〈bi,x〉=0}and0+pi={x∈Rn|Bix=0,〈bi,x〉⩽0}. We observe that it follows from Lemma 2.4 (Obuchowska, 2010b), that the functionsfi(x)=hi(pi(x))andpi(x)have the same cone of recession and the same constancy space. This fact will imply that the functionshiare not directly implicated in the proofs of the results provided in this paper.In the Lemma 3.1 below we consider the linear system, consisting of all linear constraints in (19), and linear terms of all nonlinear constraints in (19). In case a polynomial or faithfully convex functionfihas a linear term equal zero, i.e.bi=0, then we consider a nonzero row of the matrixBias a replacement for a missing linear term. LetI0={i∈J|Bi=0}.Lemma 3.1Suppose that the polyhedral coneCJhas been constructed by applying theAlgorithm C1to the linear system(20)〈ui,x〉⩾di,i∈J,whereui≔bi,∀i∈Jifbi≠0, andui≔Bij¯, ifbi=0, whereBij¯is the (nonzero)j¯-th row of the matrixBi, for somej¯∈{1,2,…,pi}. Then the coneCJhas the following properties:(i)dim(CJ)=n,int(CJ)∩Zn≠∅,for anys∈int(CJ), the linex(t)=ts, has at most two points common with the surfaceSi={x∈Rn|fi(x)=0}of i-th constraint, fori∈J⧹I0and exactly one point of intersection withSifori∈I0, and∀i∈J,∃t¯∈R, such that eitherfi(ts)>0,∀t⩾t¯, orfi(ts)>0,∀t⩽t¯.Proof of parts (i) and (ii) follows directly from the Lemma 2.1.Suppose thats¯∈int(CJ).It follows from Lemma 2.1 that the lines¯(t)=ts¯has exactly one point of intersection with every linear constrainti∈I0in the system (20).To prove that for any nonlinear constrainti∈J⧹I0the linex¯(t)=ts¯has at most two points of intersection with the surfaceSi, let us consider first a case whenbi≠0.Suppose the contrary, i.e.that there are at least three distinct values of t, such thatfi(ts¯)=0.Considert1,t2,t3, wheret1<t2<t3.Then by convexity offi(x),fi(ts¯)=0,∀t∈[t1,t3].Since functionsfi(x)are faithfully convex (or a composition of convex increasing function and convex polynomial), the latter equation would imply thatfi(ts¯)=0,∀t∈R.Therefores¯∈Dfi=and consequentlyBis¯=0,〈bi,s¯〉=0,i∈J⧹I0, which is not a possibility since proof of Lemma 2.1 (iii) implies that〈bi,s¯〉≠0.Now we will prove that in case when forJ⧹I0,bi=0, the linex¯(t)=ts¯has at most two points of intersection with the surfaceSi.To this end we note that sinces¯∈int(CJ)the Algorithm C1 ensures (by Lemma 2.1) thatBij¯s¯≠0.Suppose to the contrary that there are at least three distinct values of t such thatfi(ts¯)=0.This similarly like in the previous case, would lead us to the conclusion thatBis¯=0, a contradiction, sinceBij¯s¯≠0. To prove part (iv) suppose to the contrary that for somei0∈J⧹I0,Si0∩x¯(t)=∅,∀t. Thus we may have eitherfi0(ts¯)<0,∀torfi0(ts¯)>0,∀t. Iffi0(ts¯)<0,∀t, thens¯∈NBi0bi0,(whereN(·)denotes the nullspace of the matrix(·)), which contradicts the fact that either〈bi,s¯〉≠0orBis¯≠0,∀i∈J.This proves that∀i∈J, there existst¯such that eitherfi(ts¯)>0,∀t⩾t¯orfi(ts¯)>0,∀t⩽t¯, which completes proof of part (iv) of the lemma.□The theorem below generalizes results proved in Theorem 2.2 for linear systems, to systems of reverse convex constraints.Theorem 3.1Suppose that there is no integer solution to the system(19), i.e.fi(x)⩾0,x∈Zn,i∈J, where the functionsfi(x)are either faithfully convex satisfying condition(5)or they are a composition of convex increasing functions and convex multivariate polynomials. Then(i)There exists a partition of the set of m inequality constraints in(19)into two disjoint subsetsJ1andJ2whereJ1∪J2=J, such that each subsystem(21)fi(x)⩾0,x∈Zn,i∈J1and(22)fi(x)⩾0,x∈Zn,i∈J2is consistent and unbounded.There exists partition of the system(19)into two disjoint feasible subsystems, with indicesJ1′andJ2′whereJ=J1′∪J2′, andJ1′∩J2′=∅, such that subsystems corresponding to both sets of indices are consistent and the subsystem with indices inJ1′is a maximal consistent subsystem of the system(19)and the region defined by the constraints inJ2′is unbounded.The hypotheses stated in parts (i) and (ii) of the theorem remain true for the corresponding relaxed systemfi(x)⩾0,x∈Rn,i∈J, (without a need to assume that the coefficients ofBi, orbiare rational).(i)Lets¯∈int(CJ)∩Zn, where the polyhedral coneCJwas obtained by applying Algorithm C1 to the linear system (20). Let the vectorsxj,j=1,2,…,r, wherer<2mbe defined as the points of intersection of the straight-linex¯(t)=ts¯,t∈R, withSi={x∈R|fi(x)=0},i∈J, that isxj=tjs¯, wheretjs¯∈Sifor somei∈J. Lett¯=⌊min{tj,j=1,2,…,r}⌋-1andtˆ=⌈max{tj,j=1,2,…,r}⌉+1. Suppose thatJ‾is the index set of all nonlinear constraints, which have either two or no points of intersection with the linex¯(t),t∈R. For simplicity of notation, (though without a loss of generality) let us assume that(J⧹J‾)={1,2,…,r¯}, andJ‾={r¯+1,…,m}. Since the system (19) has no integer solution, then it follows from Theorem 3.1 (Obuchowska, 2012) that there are at least two linear inequality constraint in the system (19), and consequently,J⧹J‾≠∅, which implies thatr¯⩾2.To construct the index setsJ1andJ2we apply the following procedure.Procedure B1Step 1.SetJ1≔J‾,J2≔∅,x0=t¯s¯andk≔1.Determine whetherfk(x0)⩾0. If yes, thenJ1≔J1∪{k}, otherwiseJ2≔J2∪{k}.Setk≔k+1. Ifk⩽r¯go to Step 2, otherwise terminate the procedure and go to Stop.Stop.Clearly, all integer vectorsns¯, wheren<t¯,n∈Z, satisfy all constraints in the system (21) and all points of the formns¯, wheren>tˆ,n∈Z, satisfy all constraints in the system (22), which proves part (i) of the theorem.(ii)The following procedure, very similar to the method described in the proof of Theorem 2.2 (ii) can be used to construct the index setsJ1′andJ2′by modifying appropriately the setsJ1andJ2obtained by applying Procedure B1. For simplicity of notation let us assume thatJ1={1,2,…,rˆ}andJ2={rˆ+1,…,m}.SetJ1′≔J1,J2′≔J2, andk≔rˆ+1.Determine if the systemfi(x)⩾0,i∈J1′fk(x)⩾0,x∈Znis consistent. If Yes, then beginJ1′≔J1′∪{k}, andJ2′≔J2′⧹{k}endSetk≔k+1. Ifk⩽mthen go to Step 2. Otherwise terminate the procedure and go to Stop.Stop.The remaining part of the proof is very similar to the proof of part (ii) in Theorem 2.2 and therefore omitted.(iii) Proof can be obtained from the proofs of parts (i) and (ii) by removing the assumption that x is integer.□The setJ2′=J⧹J1′constructed by applying the Procedures B1 and B2 is an infeasibility set of the system(19).Proof follows from the fact that the setJ1′is a maximal consistent subsystem of the system (19).□We observe that partition described in part (i) of Theorem 3.1 can be computed in a polynomial time, but the maximal consistent partition in part (ii) is NP-hard, since it requires to determine feasibility of the integer program.The following example illustrates results proved in Lemma 3.1 and Theorem 3.1.Example 3.1Let us consider the following infeasible system:x1⩾0,x2⩾-1,-x1⩾-1,-x2⩾-2,-x1-x2⩾3,x12+x22-2x1+2x2⩾23,x1,x2∈Z.The cone obtained by applying Algorithm C1 is:C={x∈R2|x1⩾0,x2⩾0,-x1+x2⩾0}. We selects¯=(1,2)∈int(C)∩Z2. Then the lines¯(t)=t(1,2)intersects the surfaces of the constraints in the following points:y1=(0,0),y2=-12,-1,y3=(1,2),y4=(1,2),y5=(-1,-2),y6′=t̃1(1,2),y6″=t̃2(1,2)wheret̃1=-1+1165≈1.954andt̃2=-1-1165≈2.354. Applying Procedure B1 withx0=-4(1,2)leads to the following partition of the given system into two feasible and unbounded subsystems:J1={3,4,5,6}andJ2={1,2}. In particular, all integer vectors of the form(n,2n), wheren⩽-4,n∈Z, satisfy constraints with indices inJ1and all integer vectors(n,2n), wheren⩾2satisfy constraints inJ2. Furthermore, Procedure B2 generates the following maximal consistent subsystemJ1′={1,3,4,5,6}, whereJ2′={2}is an infeasibility set.□The results obtained in Section 3 for reverse convex constraints, are valid for a very broad class of convex functions, which in particular includes convex multivariate polynomials (both in discrete and continuous case) without any additional assumptions. The following simple example shows that it is not possible to extend the result stated in Theorems 2.2 and 3.1 to systems of convex inequality constraints even when functionsfi(x)are convex quadratic.Example 4.1Consider the following infeasible system ofm2constraints:(x1-i)2+(x2-j)2⩽15,i=1,2,…,m,j=1,2,…,m,x1,x2∈Z.Indeed, it is not possible to partition the system into 2 or even intom2-1subsystems, each of which is feasible, since the graph of each ofm2constraints is a circle which has no common points with any of the remaining circles.Furthermore, in systems of convex inequality constraints even a single inequality may be infeasible, e.g.x2+y2⩽-1, thus additional assumptions on functionsfi(x)are necessary. The purpose of this section is to determine a subclass of convex functions considered in this paper, for which the feasible partition into two feasible convex subsystems is possible.In the remaining part of this paper we will generalize results proved for linear and reverse convex systems defined in (1) and (2) to convex systems defined in (3) and (4) where the constraint functions are either faithfully convex satisfying condition (5) or a composition of convex increasing functions and convex multivariate polynomials, assuming that linear termsbiand matricesBiof all functions satisfy some additional assumptions. LetBJdenote the matrix whose columns are rows of the matricesBi,i∈J, andC(BJ)denote the column space of the matrixBJ. The orthogonal complement ofC(BJ)is the nullspace ofBJTdenoted byNBJT. We assume that none of the vectorsbi,i∈Jcan be represented as a linear combination of the rows of the matricesBj,j∈J, that is(23)bi∉C(BJ),∀i∈J.We observe that if condition (23) is satisfied, then in particular for every constraint there is a halfline along whichfi(x)is unbounded below.Algorithm C2 below, which is an extension of the Algorithm C1, allows us to construct a fulldimensional polyhedral coneCB, such that any linex(t)=ts, with the integer direction vectors∈int(CB), (where int(CB), denote the interior of the coneCB) intersects boundary of the i-th constraint, i.e. the setSi={x|fi(x)〉=0}in exactly one pointxi.Algorithm C2(to construct a fulldimensional polyhedral coneCBand a rational vector in rint(CB))Step 1.k≔1,C1≔b1.Step 2. Determine whether the optimal solutionz0of the LPz0=maxzsubject toBix=0,i∈J,〈Ci,x〉+z⩽0,i=1,2,…,k〈bk+1,x〉+z⩽0,z⩽1is positive. If yes, thenCk+1≔bk+1, otherwiseCk+1≔-bk+1.Step 3. Setk≔k+1. Ifk<mgo to Step 2, otherwise go to Step 4.Step 4. Define the coneCB={x∈Rn|Bix=0,〈Ci,x〉⩽0,i∈J}and find the optimal solution(x0,z0)of the LP problemz0=max{z|Bix=0,i∈J,〈Ci,x〉+z⩽0,i∈J;z⩽1}to determine the rational vectorx0∈rint(CB). Terminate the algorithm by going to Stop.Stop.Algorithm C2, similarly as Algorithm C1 has a polynomial time property.Lemma 4.1Assume that the following assumptions are satisfied:Bi∈Zpi×nfor alli∈J, the systemBix=0,i∈Jhas a nonzero solution andbi∉C(BJ),∀i∈J. Then the polyhedral coneCBconstructed byAlgorithm C2has the following properties: dim(CB)=dimNBJT, rint(CB)∩Zn≠∅and for anys∈rint(CB)∩Zn, the linex(t)=ts, has exactly one point(xi)common with the surfaceSiof each constraint.The fact thatdim(CB)equals the dimension of the null space of the matrixBJTfollows directly from the Algorithm C2, and the assumption that none of the vectorsbi,i∈Jcan be represented as a linear combination of the rows of the matricesBj,j∈J.To show thatrint(CB)∩Zn≠∅we assume without a loss of generality that the matrixBJTis full-row rank anddimx|BJTx=0=n-k. Letv1,v2,…,vn-k∈Zn, be linearly independent vectors with integer coefficients satisfying the systemBJTx=0(the vectorsv1,v2,…,vn-k∈Zn, can be easily obtained from rational linearly independent vectors generated by applying Gauss–Jordan elimination method to the systemBJTx=0). Let V be then×(n-k)matrix whose columns are the vectorsv1,v2,…,vn-k. Thus the systemBJTx=0,〈Ci,x〉⩽0,i∈J,can be equivalently represented in a form of the system:(24)x=Vy,〈C‾i,y〉⩽0,i∈JwhereC‾i≔VTCi,i∈J, andy∈Rn-k. Now application of the Algorithm C1 to the system (24) will yield a cone of recession, sayC‾, withdim(C‾)=n-k. Thus Lemma 2.1 (ii) allows us to conclude that the polyhedral cone defined by the system (24) contains at least one integer vector, say p, and consequentlynq∈CB, forq=Vpand anyn∈N, which proves thatrint(CB)∩Zn≠∅.Lets∈rint(CB)∩Zn. We definexi,i∈Jas the points of intersection of the setsSiwith the linex(t)=ts,t∈R, that isxi=tis, wheretisatisfiesfi(tis)=Fi(ci+Bitis)+〈bi,tis〉-di=0. Sinces∈NBJT, thenti=di-Fi(ci)〈bi,s〉. We note that the latter quotient is correctly defined sinces∈rint(CB)and dim(CB)=dimNBJT⇒〈bi,s〉<0or〈bi,s〉>0,∀i∈J,that is〈bi,s〉≠0. □Assume that the functionsfi(x)i∈J,are either faithfully convex satisfying condition(5)or they are a composition of convex increasing functions and convex multivariate polynomials, whereBi∈Zpi×n,i∈J,dimx|BJTx=0⩾1, i.e. the homogeneous systemBix=0,i∈Jhas a nonzero solution, and that for alli∈J,bi∉C(BJ).Then if there is no integer solution to the system(25)fi(x)⩽0,x∈Zn,i∈J,then it holds that:(i)There exists a partition of the set of m inequality constraints in (25) into two disjoint subsetsJ1andJ2whereJ1∪J2=J, such that each subsystemfi(x)⩽0,x∈Zn,i∈J1andfi(x)⩽0,x∈Zn,i∈J2is consistent and unbounded.There exists partition of the system (25) into two disjoint feasible subsystems, with indicesJ1′andJ2′whereJ=J1′∪J2′, andJ1′∩J2′=∅, such that subsystems corresponding to both sets of indicesJ1′andJ2′are consistent and the subsystem with indices inJ1′is a maximal consistent subsystem of the system (25) and the setJ2′is an infeasibility set and the region defined by the inequalities inJ2′is unbounded.The hypotheses stated in parts (i) and (ii) of the theorem remain true for the corresponding relaxed systemfi(x)⩽0,x∈Rn,i∈J, where we assume that the latter system has no real solution. It is sufficient to assume here that the coefficients ofBi, andbii∈J, are real numbers.Proof of this theorem is very similar to the proof of the Theorem 2.2, which is due to the fact that as shown in Lemma 4.1, for anys∈int(CB)∩Zn, the linex(t)=ts, has exactly one point(xi)common with the surfaceSiof each constraint. The slight modifications include usingti=di-Fi(ci)〈bi,s〉, and replacing linear inequalities with appropriate convex nonlinear constraints. □As noted earlier the results for convex constraints proved in Lemma 4.1 and Theorem 4.1 are not valid for the entire class of convex functions considered in Section 3, that is if the assumptions that for alli∈J,bi∉C(BJ)and thatBTx=0has a nonzero solution are not satisfied, as shown in the Example 4.1. To the best of my knowledge, the class of functions considered in this section is the broadest subclass of convex functions considered in this paper, for which the feasible partition of an infeasible system of convex inequalities is possible.The assumptions in Theorem 4.1 thatbi∉C(BJ)and thatBTx=0has a nonzero solution can be easily satisfied in case of a large number of variables n, sparse matricesBiand relatively small number of constraints, and it is very easy to provide an example of the system of convex inequality constraints, where the above mentioned assumptions are satisfied. Below we provide example of convex (quadratic) functions, where vectorsbiand matricesBisatisfy conditions of Lemma 4.1 and Theorem 4.1.Example 4.2Consider the following system of convex quadratic and linear inequality constraints:fi(x)=〈Bix,Bix〉+〈bi,x〉-di⩽0,i=1,2,3,4,5,withm=5,n=4,B1=B2=B3=0,B4=01101001,B5=-200-20440,b1T=(-1,3,1,0),b2T=(0,1,2,3),b3T=(1,-2,1,0),b4T=(0,-1,-1,-1),b5T=(-5,0,0,0),It is easy to see that the systemBix=0,i=4,5, has a nonzero solution, since for instance the vectors(1,0,-1)and(0,1,-1,0)satisfy the latter system and none of the vectorsbi,i=1,2,3,4,5is a linear combinations of the rows of the matricesBi,i=4,5.

@&#CONCLUSIONS@&#
In this paper we develop new results concerning (maximal) consistent partition problem, showing in particular how to partition inconsistent system of reverse convex (or linear) inequalities defined over the set of integers, into two feasible subsystems, one of which is maximal. Similar results have been proposed for convex systems, although in this case it was necessary to impose additional assumptions on the convex functions defining the region. The polynomial time algorithm to generate feasible partition has been proposed and the algorithm for a maximal partition has also been provided. We note that Algorithms C1 and C2 and Procedure B1 can be performed in polynomial time.Concluding, since all results developed in this paper are valid for both the integer systems (1) and (3) as well as for the corresponding relaxed systems (2) and (4), we are able to infer that these results also apply to mixed-integer programming problem of the same structure, where only some of the variables are assumed to be integer.To the best of our knowledge, the class of functions considered in this paper is the broadest class of convex or concave functions for which the feasible partition of the infeasible system is possible. In order to determine whether the results can be extended to another large and important class of functions, further studies would be needed.