@&#MAIN-TITLE@&#
Parameter estimation for crop growth model using evolutionary and bio-inspired algorithms

@&#HIGHLIGHTS@&#
An approach based on evolutionary and bio-inspired algorithms is proposed for solving the parameter estimation problem in crop growth dynamic models.Differential Evolution algorithm showed the best performance in solving the parameter estimation problem of a dynamic crop growth model.A statistical analysis and ANOVA were applied to quantitatively evaluate the efficiency and effectiveness of Differential Evolution, CMA-ES, PSO, ABC and LSE algorithms.

@&#KEYPHRASES@&#
Parameter estimation,Evolutionary algorithms,Bio-inspired algorithms,SUCROS model,

@&#ABSTRACT@&#
All dynamic crop models for growth and development have several parameters whose values are usually determined by using measurements coming from the real system. The parameter estimation problem is raised as an optimization problem and optimization algorithms are used to solve it. However, because the model generally is nonlinear the optimization problem likely is multimodal and therefore classical local search methods fail in locating the global minimum and as a consequence the model parameters could be inaccurate estimated. This paper presents a comparison of several evolutionary (EAs) and bio-inspired (BIAs) algorithms, considered as global optimization methods, such as Differential Evolution (DE), Covariance Matrix Adaptation Evolution Strategy (CMA-ES), Particle Swarm Optimization (PSO) and Artificial Bee Colony (ABC) on parameter estimation of crop growth SUCROS (a Simple and Universal CROp Growth Simulator) model. Subsequently, the SUCROS model for potential growth was applied to a husk tomato crop (Physalis ixocarpa Brot. ex Horm.) using data coming from an experiment carried out in Chapingo, Mexico. The objective was to determine which algorithm generates parameter values that give the best prediction of the model. An analysis of variance (ANOVA) was carried out to statistically evaluate the efficiency and effectiveness of the studied algorithms. Algorithm's efficiency was evaluated by counting the number of times the objective function was required to approximate an optimum. On the other hand, the effectiveness was evaluated by counting the number of times that the algorithm converged to an optimum. Simulation results showed that standard DE/rand/1/bin got the best result.

@&#INTRODUCTION@&#
Mathematical models in agriculture are powerful tools to describe and understand complex systems. These models have been used in plant breeding to simulate the effects of changes in the morphological and physiological characteristics of crops which aid in identification of ideotypes for different environments. The structure of dynamic crop growth models consist in a set of ordinary first order differential equations characterized by non-linearity, multivariate dynamic, complexity and uncertainty [1]. Generally, these equations have a set of coefficients that represent physiological parameters whose values have to be determined with precision to obtain a good fit between predicted variables and measurements. In the development process of a mathematical crop growth model, parameter estimation or model calibration is essential in order to get the objective aforementioned. Which implies, by applying optimization algorithms, to estimate parameters values from measurements that affect more model behavior. The process to determine parameter values can be established as an optimization problem which allowing that a variety of algorithms can be used to look for a solution. Generally, local methods such as LSE (Least Squares Estimation) and SQP (Sequential Quadratic Programming) are used. However, those algorithms have the drawback of leading to inaccurate estimated parameter values (high variance of parameters estimators) and inaccurate model predictions (over parameterization) when they are applied in the estimation of a large number of model parameters (i.e. > 10). This problem is because such algorithms often fail to converge to the optimum value when the parameters are too numerous [2]. Also, due to high non-linearity of models of crop growth and a dependency between the parameters (epistasis), the optimization problem can be non-convex or multi-modal.In order to solve multi-modal optimization problems, global optimization methods such as evolutionary algorithms (DE, Differential Evolution and CMA-ES, Covariance Matrix Adaptation Evolution Strategy) and algorithms inspired by the behavior of biological systems (PSO, Particle Swarm Optimization and ABC, Artificial Bee Colony) can provide good approximations to the global optimal value [3–8,21–24].In the literature many works devoted to parameter estimation have been focused on greenhouse crop growth models, mainly using evolutionary algorithms (e.g. [9–12]). However, few works have been done to parameter estimation of the crop growth models in open field. Ioslovich and Gutman [13] and Wallach et al. [14] proposed a procedure for parameter estimation of crop models calibrated with field data, but they did not use global optimization methods. Pabico et al. [15] formulated a Genetic Algorithm (GA) to calculate the cultivar coefficients of crop models. However, nowadays limitations of genetic algorithms as optimizers are well known [16]. To our best knowledge no one, so far has applied bio-inspired optimization algorithms to parameter estimation of crop models in open field. Therefore, the objective of the present research was to evaluate the performance through efficiency and effectiveness of the DE, CMA-ES, PSO and ABC algorithms, to estimate 25 parameters of the SUCROS (a Simple and Universal CROp Growth Simulator) model [17] applied to a husk tomato crop, in order to analyze which algorithm generates parameter values that give the best prediction of the model not only to increase the knowledge of the husk tomatoes cropping system but also the potential developing of practical applications. Efficiency or computational cost of an algorithm is the number of times the objective function is evaluated to find an optimum. The effectiveness or performance of an algorithm, to achieve an optimum in a multi-modal optimization problem, is calculated by counting the number of times the algorithm converges to the same optimum with different initial values for the iterative process [18].The SUCROS (a Simple and Universal CROp Growth Simulator) is a mechanistic model that explains crop growth on the basis of the underlying processes, such as carbon dioxide (CO2) assimilation and respiration, as influenced by environmental conditions [19]. It simulates potential growth of a crop, i.e. its dry matter accumulation under ample supply of water and nutrients, in a pest, disease and weed-free environment under the prevailing weather conditions. The potential crop growth model has been described extensively elsewhere [19,17] and a brief summary to emphasize its main properties is given in Tables 1 and 2. The seven ordinary differential equations that make up the model are:(1)dxdsdt=f(xds,T)(2)dxlaidt=Growthlai−Deathlai(3)dxgldwdt=Growthgldw−Deathgldw(4)dxdldwdt=Deathdldw(5)dxrdwdt=(1−frsh(xds))TotalGrowth(6)dxstdwdt=frst(xds)frsh(xds)TotalGrowth(7)dxsodwdt=frso(xds)frsh(xds)TotalGrowthwhere xds(dimensionless) represents the development state, xlai(m2m−2) is the leaf area index, xgldw(gm−2) is the green leaves biomass, xdldw(gm−2) is the biomass of death leaves, xrdw(gm−2) is the biomass of roots, xstdw(gm−2) is the biomass of stems and xsodw(gm−2) is the biomass of fruits. Main equations of the model structure are shown on Table 1. The total set of SUCROS parameters are described on Table 2. On the other hand, on Table 1 Δt (d, day) is the integration step size, Tmax(°C) is the maximum daily temperature, and Tmin(°C) is the minimum daily temperatures which are the inputs variables for the SUCROS model. Empirical functions in the SUCROS model are the following: f(xds,T) which calculates the development stage rate depending on temperature, frsh(xds) the fraction total dry matter allocated to shoots, frst(xds) the fraction of shoot dry matter allocated to stems, frso(xds) the fraction of shoot dry matter allocated to storage organs, frleaves(xds) the fraction of shoot dry matter allocated to leaves. All these functions depend on stage of development. Other empirical functions are: f(xst, xds, Tavg), f1(xds), f2(xlai) and f(demerg) is a switching function which output is one as the simulation time is equal to the emergence day, otherwise its output is zero.A husk tomato crop (Physalis ixocarpa Brot. ex Horm.) was grown during the summer of 2007 in Chapingo, Mexico (19°16′52″ LN and 99°39′0″ LW). The site has a temperate weather with a raining season during the summer and a drought time during winter. The annual average temperature is 15.5°C and the annual rainfall of 664mm. The husk tomato variety was CHF1-Chapingo coming from genetic plant breeders of University of Chapingo. The transplanting day was March 30 with a density of 16122plantsha−1. In order to guarantee potential growth conditions, by using a fertigation automated system 100% of the reference evapotranspiration calculated by the Penman–Monteith method was applied as irrigation. The fertilization formulation was 200-110-50 (N, P, K respectively) which is enough to avoid nitrogen and phosphorus limitation. Fertilizers were applied each week. A weather station (GroWheather, Davis, USA) recorded daily the climatic variables global solar radiation (°C), minimum and maximum temperatures (°C) (Fig. 1). A destructive method was used to calculate the biomass and leaf area index of the crop six harvest (Julian days 103, 117, 124, 145, 159 and 177) during the growing period. In each sampling 3–10 husk tomato plants were harvested randomly [20].With reference to parameter optimization issue, one objective function is commonly expressed as [9,11]:(8)p*=argminf(p)(9)f(p)=∑j=1M∑i=1Nwj(yi,j−yˆi,j)2where yi,jrepresents the measured variable (total, stem, fruits and leaf biomass (green leaves and death leaves) and also leaf area index). The variableyˆi,jrepresents the values predicted by the SUCROS model.wjis an associated weight with each variable to make them comparable. The coefficients were 1, 1, 1, 1, 100 respectively. N is the number of samples during the growing period (N=6). M is the number of output variables considered in the objective function (M=5). The estimated parameter vector p is (Table 2): [RGRL, TBASE, SLA, AMX, EFF, KDF, SCP, Q10, TREF, MAINLV, MAINST, MAINRT, MAINSO, ASRQLV, ASRQST, ASRQRT, ASRQSO, LAICR, FRTRL, CFST, CFLV, CFRT, CFSO, FRDR, CONVL]. The output variables considered in this work are: Total dry weight (gm−2), Stem dry weight (gm−2), Fruit dry weight (gm−2), Leaves dry weight (gm−2) and LAI (m2m−2). Eq. (9) indicates how well a model simulates observed data by minimizing the error sum of squares among measurements and predictions.The algorithms Differential Evolution (DE), Covariance Matrix Adaptation Evolution Strategy (CMA-ES), Particle Swarm Optimization (PSO) and Artificial Bee Colony (ABC) as described in Refs. [3–8] were applied to estimate 25 parameter values (dimension of the problem (D)) of the SUCROS model. A total of 20 test runs were performed randomly chosen initial parameter vectors (over 20% of the nominal value of the parameters the upper and lower limits were proposed, Table 2) for the test function and each minimization. In all experiments, the values of the common parameters used in each global search algorithm such as the maximum number of generations (MaxIter) were chosen to be the same (1000). The other specific parameters of each algorithm were specified as follows:In DE, F is a real constant which affects the differential variation between two solutions and set to 0.5 in our experiments. Value of crossover rate (CR), which controls the change of the diversity of the population, was chosen to be 0.5. Population size was 50 (several tests were performed with different populations, e.g., 50, 75, 150, 200 and 250). In this case the standard DE/rand/1/bin algorithm was implemented [3,21–24,40].σ which determines the initial coordinate wise standard deviations for the search, was chosen to be 25 [7,26, 28–30]. Population size was 250 (several tests were performed with different populations, e.g., 50, 75, 150, 200 and 250). In this proyect, the cmaes.m script file for Matlab, Version 2.35, available in the Internet web page http://www.Iri.fr/~hansen/cmaes_inmatlab.html was used.Cognitive and social components (φ1 and φ2) are constants that can be used to change the weighting between personal and population experience, respectively. In our experiments cognitive and social components were both set to 1.53. Inertia weight (w), which determines how the previous velocity of the particle influences the velocity in the next iteration, was 1 [31–35]. Population size was 250 (this value was obtained after that several tests were carried out with different populations, e. g. 25. 50, 75, 125, 200, 250 and 300).The Basic ABC uses only one control parameter, which is called limit. A food source will not be exploited anymore and is assumed to be abandoned when limit is exceeded for the source. This means that the solution of which “trial number” exceeds the limit value cannot be improved anymore [36–38]. We defined a relation for the limit value using the dimension of the problem and the colony size: limit=PS×D, where D is the dimension of the problem and PS is the colony size (number of food sources or employed bees). In our experiment PS was 250 (this value was obtained after that several tests were carried out with different colony size, e.g. 25, 50, 75, 125, 150, 200, 250 and 300). The ABC computer program used in this study is available in Internet (http://mf.erciyes.edu.tr/abc).LSE solves the non-linear least squares problem. We used the lsqnonlin.m algorithm programmed in Matlab Optimization Toolbox, which implements two different algorithms: trust region reflective and Levenberg–Marquardt algorithm [42]. In this experiment we used Levenberg–Marquard option. The maximum number of generations was 20,000 and the maximum evaluation number of the objective function was 150,000.The parameter values of the tested evolutionary and bio-inspired algorithms were empirically derived after performing a set of experiments where each of them had the best performance for the problem at hand. Heuristic rules reported in the literature were also taking into consideration. The number of individuals of the population used for each algorithm described above is necessary to obtain a good convergence to the global optimum, a smaller population generates divergence and a larger population does not improve performance of the algorithms.

@&#CONCLUSIONS@&#
