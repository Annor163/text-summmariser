@&#MAIN-TITLE@&#
A MIP-based timetable rescheduling formulation and algorithm minimizing further inconvenience to passengers

@&#HIGHLIGHTS@&#
A timetable recovery MIP model minimizing inconvenience to passengers is proposed.Train operation and passenger’s behavior are expressed by inequalities.Several countermeasures against a disruption are implemented.Inconvenience consists of travel by a train, a wait for a train, a train transfer.

@&#KEYPHRASES@&#
Timetable rescheduling,Mixed Integer Programming,Passenger’s behavior,Connection,Shortest path,

@&#ABSTRACT@&#
This paper presents a timetable rescheduling algorithm based on Mixed Integer Programming (MIP) formulation when train traffic is disrupted. We minimize further inconvenience to passengers instead of consecutive delays caused by the disruption, since loss of time and satisfaction of the passengers are considered implicitly and insufficiently in the latter optimization. We presume that inconvenience of traveling by train consists of the traveling time on board, the waiting time at platforms and the number of transfers. Hence, the objective function is calculated on the positive difference between the inconvenience which each passenger suffers on his/her route in a rescheduled timetable and that in a planned timetable. The inconvenience-minimized rescheduling is often achieved at the cost of further train delays. Some trains dwell longer at a station to wait for extra passengers to come or to keep a connection, for instance. In the MIP model, train operation, each passenger’s behavior and the amount inconvenience are simultaneously expressed by a system of integer linear inequalities. As countermeasures against the disruption, changes of train types and rolling stock operation schedules at termini as well as changes of departing order of trains and assignment of a track to trains in stations are performed. We also consider capacities of a line between adjacent stations as well as those of a track in stations. We have conducted numerical experiments using actual data and have obtained better rescheduled timetables in terms of customer satisfaction within practical time in proper solution space.set of train directionsopposite direction ofb∈Bset of trainsset of trains traveling inb∈Bset of ordered pair of distinct trains traveling inb∈Bset of candidate successor trains ofr∈Rset of stationsstarting station of trains traveling inb∈Bterminus of trains traveling inb∈Bstation next tos∈Sinb∈Bset of O–D pair of stations inb∈Bset of stations at which passengers tod∈Sinb∈Bcan transferstation next tos∈Sinb∈Bat which passengers can transferset of tracks ats∈Swhich trains traveling inb∈Bcan pass through or stop atset of train typesset of train types which stop ats∈Sset of train types which passengers can take at s to reach d where(s,d)∈Sb<2priority relation between two train typesset of discrete time periodsset of two pairs(o,d1),(o,d2)∈Sb<2withd1≠d2whose behavior is same when they appear at same timearrival/departure time ofr∈Rats∈Sin planned timetableamount of inconvenience to passengers between(o,d)∈Sb<2appearing att∈Tin planned timetablearrival/departure time ofr∈Rats∈Sin certain feasible rescheduled timetableminimum interval required between arrivals and departuresarbitrary large number concerning headway/inconveniencemaximum number of trains traveling inb∈Ballowed to exist on line between(s,Next(b,s))number of passengers between(o,d)∈Sb<2appearing att∈Tinconvenience of waiting for 1min at platforminconvenience of one train transferflexibility in timetable to be rescheduledarrival/departure time ofr∈Rats∈S0–1 if or not type ofr∈Rise∈E0–1 if or notr∈Rbpasses through or stops atk∈Kb,s0–1 if or not successor ofr1∈Risr2∈RSuc(r1)0–1 if or notr1∈Rbdeparts froms∈S⧹{Term(b)} earlier thanr2∈Rb⧹{r1}0–1 if or notr1∈Rbarrives at Term(b) earlier thanr2∈ROpp(b)departs from0–1 if or notr2∈ROpp(b)departs from Term(b) earlier thanr1∈Rbarrives at0–1 if or notNb,s-1trains depart from s afterr1and beforer2does0–1 if or not passengers between(o,d)∈Sb<2appearing att∈Ttaker∈Rb0–1 if or not passengers tod∈Sats∈STra(b,d)transfer fromr1∈Rbtor2∈Rbamount of inconvenience to passengers to d when they taker∈Rbat s where(s,d)∈Sb<2increased amount of inconvenience to passengers between(o,d)∈Sb<2appearing att∈Ttakingr∈Rb

@&#INTRODUCTION@&#
In Japan, railways play quite an important role in public transportation. The total number of passengers carried by the railways per year reaches as much as 22 billion and the total running distance of trains per day is approximately 3.3 million kilometers. In fact, trains are operated every several minutes in big cities to transport a massive amount of commuters. The trains are known to be very punctual; nevertheless, train operation is occasionally disrupted by accidents, natural disasters, malfunctions of facilities, etc., and a lot of passengers are more or less affected. When the trains are delayed by these disruptions, a series of changes is made to a timetable to prevent the delay from further propagating. This task is called timetable rescheduling (sometimes we just call “rescheduling”).The major part of the timetable rescheduling is currently carried out by human experts called train dispatchers and computers aid them by showing a prediction about future train operation. Although a comprehensive and intelligent support system, whose core is an algorithm to provide a good timetable rescheduling plan, has been longed for, it is a challenging task to develop a practical algorithm on account of the following reasons (refer to (Institute of Electrical Engineers of Japan, 2010)):•The timetable rescheduling is a complicated combinatorial optimization problem since there are a lot of methods to change train schedules.The problem size is large for busy railway lines.We need a fast algorithm to solve the problem in real time.We have to reduce dissatisfaction of the passengers based on their present locations and a forecast of their behavior, which is difficult since there exist a lot of passengers whose origins and destinations are different.We believe that the last issue is of crucial importance. A major rescheduling objective in the literature has been the total amount of delays. This does not suffice particularly in busy lines since:•If we cancel trains, delays of the canceled trains will obviously disappear and the total amount of delays will decrease. On the other hand, it is quite probable that some passengers have to wait for a period of time at several stations until the next train comes and congestion of the train as well as the stations will increase very much. Hence, trains must not be canceled if there exist a lot of passengers.Urban railway lines transport a massive amount of passengers. In these lines, it is sometimes more important to keep an interval between two train departures constant than to reduce delays. Otherwise, a certain train becomes too congested and the congestion brings more delays.In this paper, we formulate the timetable rescheduling problem as a Mixed Integer Programming (MIP) problem (refer to Williams (2013) for MIP and its applications) and introduce a timetable rescheduling algorithm which outputs a rescheduling plan minimizing further inconvenience to the passengers caused by the disruption. In the MIP model, each passenger’s behavior and the amount of inconvenience which he/she suffers on his/her route as well as train operation are simultaneously expressed by a system of integer linear inequalities. We adopt several countermeasures against the disruption which train dispatchers in Japan actually perform. We also take into account capacities of a line between adjacent stations as well as those of a track in stations. Each passenger is assumed to take a train and transfer so that the inconvenience to him/her will be minimized, depending on the rescheduled train operation.MIP provides, unlike most metaheuristics, an exact optimal solution by improving lower and upper bounds of an objective function. On the other hand, it is considered to be time-consuming when a problem size or solution space is large. In the timetable rescheduling problem, the solution space is a range of time at which the occurrence of events such as rescheduled train arrivals/departures is allowed. We observe and discuss a tradeoff between the quality of a passenger-oriented timetable and computation time or train punctuality by numerical experiments using actual data.The rest of the paper is organized as follows. In Section 2, we describe the timetable rescheduling problem together with related work. We introduce aims and assumptions of this study in Section 3. In Section 4, we formulate the problem as MIP and propose the passenger-oriented rescheduling algorithm in detail. We present numerical results based on arbitrary and actual data in Section 5. Section 6 concludes the paper and presents our view of future work.Given information on railway facilities such as a track layout of a line and stations, physical, resource and operational constraints, a planned timetable, passenger demand and a disrupted situation (e.g., when and where the disruption has occurred), a timetable rescheduling problem is to find a feasible rescheduled timetable satisfying the constraints after applying a series of countermeasures against the disruption. Train dispatchers in Japan perform: a change of arriving/departing order of trains, a change of assignment of a track to trains in stations, a change of train types, adjustment of an interval between trains, a change of rolling stock operation schedules, (partial) cancellation of trains, etc. (also refer to (Institute of Electrical Engineers of Japan, 2010)).Fig. 1illustrates the change of departing order of trains. In railway lines which connect a suburban area and a downtown area, express trains are operated to offer a fast transportation service for passengers who live distant from a downtown area. In order to give a good service to customers of small stations where express trains do not stop, railway companies usually offer a timetable which is called “coupling” between express and local trains. The change of departing order works effectively for such a timetable when there occurs a delay. Fig. 1 depicts a situation where Express train (the bold gray line) is scheduled to overtake Local train (the thin black lines) at Station C originally. Suppose that Express is delayed at Station D (the bold black line), then the departing order of these trains at Station C should be changed and Local should depart prior to the Express. Otherwise Local has to wait for a long time.The delayed Express departs earlier than Local at Station B in Fig. 1. When the both trains are scheduled to pass through or dwell at the same track at station B originally, the change of assignment of a track to Local is performed so that Express can overtake it.The change of train types intends to make an express train stop at a station where it does not usually stop. If there are a lot of passengers waiting at the station, this countermeasure is very effective to reduce their dissatisfaction.Fig. 2is an example of the adjustment of intervals between trains. If the intervals become too large on account of a disruption, there might occur two types of problems. One is that waiting time of passengers becomes too long. The other is that, in urban railway lines, a delayed train becomes very congested since more passengers than usual are waiting for it. In order to avoid these problems, preceding trains are intentionally delayed; in other words, dispatchers try to equalize the intervals between pairs of adjacent trains by giving extra dwell time to the preceding trains. In Fig. 2, the fourth train is delayed at Station D and the dwell time of the second and the third train are prolonged at Stations B and C, respectively (the bold black lines).Fig. 3is an example of the change of rolling stock operation schedules. At Station A, the first arriving train is scheduled to enter a rolling stock depot adjacent to Station A (the thin triangle) and the second train is due to turn back and be operated as the third train in the opposite direction (the thin lines). Even if the second train is delayed, the third train can depart Station A without a delay by making the first train turn back and be operated as the third train, and instead the second train enter the depot (the bold lines and triangle).Although we show rather simple examples in Figs. 1–3, we note that these countermeasures are combined and applied to a lot of trains in real time, which makes the timetable rescheduling problem very difficult.

@&#CONCLUSIONS@&#
In this paper we have proposed the MIP-based timetable rescheduling algorithm during the disruption which minimizes the sum of the positive difference between the inconvenience which each passenger suffers on his/her route in a rescheduled timetable and that in a planned timetable. Inconvenience of traveling by train has been defined as the weighted sum of the traveling time on board, the waiting time at platforms and the number of transfers. We have simultaneously modeled the train operation, each passenger’s behavior and the amount of inconvenience as the system of integer linear inequalities. We have realized the change of departing order of trains, the change of assignment of a track to trains in stations, the change of train types and the change of rolling stock operation schedules at termini as the countermeasures against the disruption. In the train operation constraints which include the problem of train capacities, we have covered all the types of minimum intervals required between the arrival and departure events considered in the previous PERT formulation. Each passenger has been assumed to take a train and transfer so that the inconvenience to him/her would be minimized, depending on the rescheduled train operation. We have first solved the arrival delay minimization problem and then optimized the timetable in terms of the inconvenience based on the delay-minimized timetable and the timetable flexibility parameter. Numerical experiments with both the arbitrary and the real data have indicated the tradeoff between the inconvenience minimization and the delay minimization or the computation time. We have obtained better rescheduled timetables in terms of customer satisfaction within practical time in the proper solution space.Our future study aims to incorporate congestion of trains into the MIP model. It is one of the factors which form inconvenience to the passengers and sometimes brings another delay in Japan particularly when a lot of passengers rush into a train. We also need to reduce the overall computation time without restricting the solution space. Novel valid inequalities, including cutting planes, will improve the lower bound of the passenger-oriented objective function. When we extend the optimization on a single line to that on a large complex network, an optimal solution will not be obtained in real time. A (meta)heuristics-based algorithm will be a practical approach for such an instance. Even though we believe that the inconvenience-minimization should be prioritized to the delay-minimization, the latter can be an important criterion particularly when the precise passenger O–D data are not available. Hence we also have to conduct a deeper analysis of the tradeoff between the two indices.