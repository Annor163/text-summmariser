@&#MAIN-TITLE@&#
A new signal decomposition to estimate breathing rate and heart rate from photoplethysmography signal

@&#HIGHLIGHTS@&#
The PPG signal has been modeled by a set of Gaussian basis functions.The spectrum can be deduced from the Hilbert transform of the Gaussian basis.The Shannon energy envelope is used to smooth the spectrum.The heart rate and respiratory rate are estimated form the Shannon energy envelope.

@&#KEYPHRASES@&#


@&#ABSTRACT@&#
The growing interest in wearable computing during daily life has lead to many studies on unconstrained biological signal measurements. The photoplethysmography (PPG), as an extremely useful wearable sensing medical diagnostic tool, adequately creates a health care monitoring device since it can be easily measured in our bodies. In this paper, we study the decomposition of photoplethysmography signal based on a finite Gaussian basis. When we employ a set of n (n<8) Gaussian basis to approximate the original PPG signal, we can use a feature vector only including 3n parameters to represent the original PPG signal, with almost no losses in geometrical shape. In contrast with a thousand samples in time domain, the proposed method can save a lot of resources in processing, transmitting and storing PPG signal. Besides that, we studied the application of our decomposition method for the extraction of respiratory and heart information from PPG signal. Determination of baseline heart rate and respiratory rate were easily identified in the experiments of exercise condition. The results indicate the accurate determination of heart rate and respiratory rate from PPG signal. We believe that method could soon be easily incorporated into current Body Area Network applications.

@&#INTRODUCTION@&#
Wearable computing has the potential to revolutionize healthcare by realizing low-cost and pervasive physiological monitoring. By enabling comfortable and continuous cardiovascular monitoring outside the clinical setting over extended periods of time, wearable biosensors could play an important role in many areas, ranging from personal health monitoring to sports medicine and hazardous operations. Photoplethysmography, in particular, can provide valuable information about human physiological and pathological conditions. Analyzing the PPG signal is an important method to diagnosis the status of human health [1].Until now, PPG signal has been widely used for the detection of many basic physiological parameters [2], such as blood oxygen [3], heart rate, breath [4] and blood pressure [5]. Besides, it could also reflect some other important cardiovascular parameters, such as atherosclerosis [6]. The recent researches were also focused on the relationship between the PPG signal and physiological models [7]. It is widely demonstrated that PPG can provide a lot of information about the cardiovascular system and diseases, although its origins and the physiological information hidden in the different components of the PPG signal remain nowadays not fully comprehended [8].In Body Area Networks (BANs) and wearable computing products, many PPG processing, storing, transmission and analyzing applications really require an efficient PPG signal representation to save energy and achieve real time application. The efficiency of the PPG representation is determined by the number of parameters needed to accurately approximate PPG signal. Representations resulting in fewer parameters often yield superior PPG signal processing algorithms.In the physiological signal modeling, various signal representations may be formed by selection of different decomposition bases such as Wavelet basis, Radial basis and Gabor basis. The physiological signal modeling can provide a set of features from the time series of physiological signal. After physiological signal modeling, the features of physiological signal are used to predict and classify the human physiological state. In the past 20 years, many methods have been proposed to model electroencephalography (EEG) [9], electrocardiography (ECG) [10] and respiratory signal [11].For modeling the PPG signal, a particularly interesting decomposition basis is formed by the Gaussian basis. The PPG signal representation corresponding to the Gaussian basis shall be referred to as the Gaussian basis representation. Intuitively, the main advantage of the Gaussian basis is in resulting in optimal simultaneous spatial and frequency resolutions; thus, the Gaussian basis captures abrupt spatial and frequency variations in PPG signal.In this paper, we study the representation of PPG signal based on a finite Gaussian basis. In Section 2, the iterative optimization scheme is introduced for the solution of the optimal representation. The scheme is based on the steepest-descent and modified Gauss–Newton algorithm for the solution of nonlinear least-squares estimation problems [12]. Initial parameter values for the Gaussian basis of a PPG signal are estimated from the second derivative of the PPG signal. In Section 3, we illustrate Gaussian basis use in the interrogation of the PPG signal in order to extract breathing and heart pulse features. In Section 4, several simulation experiments have been used to demonstrate that the Gaussian basis results in a highly efficient method to estimate heart rate and respiratory rate from PPG signal. Finally, in Section 5, we conclude with a summary and discussion of our results.Arterial pulse is one of the most critical signals of human life. It comes directly from heart to the blood vessel system. Some cardiovascular disease risk indicators such as resistance of blood flow, elastic of vessel wall, and blood viscosity can be deduced from arterial pulse. As pulse transmitted, reflections will occur at different level of blood vessels. It is reflection of the wave from left ventricular ejection that gives the arterial pulse its characteristic contour. The morphological features of arterial pulse are determined by the amplitudes and positions of peaks and valleys in each period. As illustrated in Fig. 1a, some peaks and valleys are significant indexes for surgeons in cardiovascular disease diagnosis and treatment.When studying arterial pulse, the peaks and valleys can be regard as the result of component waves in arterial pulse. Therefore, it is possible to decompose the measured arterial pulse waveform into the percussion wave and the three reflected components for index calculation. For fully characterizing the time and real nature of wave reflection and also allowing accurate determination of the time of arrival of the reflected waves, we can use the Gaussian function to represent the peak. The morphology of the upstroke in PPG signal can be well modeled by the upcurve of Gaussian function. The upstroke is entirely caused by the left ventricular ejection which is a physical process. This physical process contains the rise and fall of blood volume. The fluctuation of blood volume is a concentrated impulse which is very similar to the 3-sigma rule of Gaussian function [13].Considering the wave reflection phenomenon [14–16], the PPG waveform can be interpreted as the time-domain summation of a progressive wave traveling downward to the organs and body segments and some regressive waves traveling backwards to the heart form the reflection of peripheral arteries, where the differences between the progressive and regressive components are related to the vascular impedance. The systolic ejection phase of the cardiac cycle is actually a two-stage phenomenon, where the first stage comprises a rapid increase in intraventricular pressure due to the high electric myocardial excitability while the second stage is characterized by a slow decrease in intraventricular pressure due to reduction in excitation [17]. Hence, the complete phase is marked by the presence of two systolic peaks in the PPG signal, which are transmitted to peripheral arteries of the upper extremities as the progressive waveform shape. Thus, the progressive time-domain PPG waveform could be empirically modeled as the summation of two Gaussian functions where each peak represents its respective stage.As the regressive waves travel backward to acquisition site of the progressive PPG waveform, changes in contour due to the filtering process are reversed and it can be assumed that a very similar contour will be obtained although scaled in amplitude and lagged in time [14]. Because there is not only a reflected wave in the acquisition site of the progressive PPG waveform, the regressive component of the traveling wave was also modeled by the summation of reasonable quantities of Gaussian functions.Based on the above hypothesis the time-sampled PPG waveform at a fixed arterial site is then represented by summation of the progressive and regressive time-domain pulse waveforms. Since both progressive and regressive time-domain pulse waveforms can be decomposed into a number of Gaussian functions, the PPG signal can be represented by the summation of a certain number of Gaussian functions. An example of an original PPG signal of forefinger for healthy subject aged 30 and the corresponding Gaussian basis representation are depicted in Fig. 1.In this paper, we call(1)Gt=a×e−t−b/c2a Gaussian basis, where a stands for the amplitude of the each Gaussian pulse waveform, b indicates the location of the Gaussian wave peaks and c indicates the width or ‘duration’ of the Gaussian pulse waveform. In this section, the concept and mathematical model are derived from [12], which proposed by Goshtasby and Schonfeld [12].The PPG signal p(t) can be approximated by finite Gaussian basis Gi(t), for i=1,2,…,n. The expression of Gi(t) is(2)Git=ai×e−t−bi/ci2,i=1,2,…,nWhen the n Gaussian bases are selected, there are 3n parameters in the approximation. The 3n parameters can be arranged in the matrix L which is consist of n rows and 3 columns.(3)L={(ai,bi,ci,),i=1,2,…,n}.As the symbol p(t) is used to denote the PPG signal, the symbol p′(t) is applied to indicate the approximation of PPG signal by Gaussian basis.(4)p′t=∑i=1nai×e−t−bi/ci2For less approximation error between the p(t) and p′(t), the matrix L must be optimized. Specifically, the 3n parameters of the n Gaussian bases in (4) are critical to approximate the PPG signal. The procedure to find the optimal matrix L is employed from [12], which is discussed in Section 2.3. Fig. 2illustrates the empirical results of curve fitting and the residuals from the fitted curve. The residuals appear randomly scattered around zero indicating that the method of Gaussian basis representation describes the data well.In practice the practical PPG signal p(t) is a digital signal, so the original PPG signal p(t) can be considered as a time series of N samples which is expressed as set P. The definition of P is indicated as P={p(tk), k=1,2,…,N}. For minimizing the squared error between samples of the original PPG signal p(t) and the approximation PPG signal p′(t), a optimization methods proposed in [12] is employed. When the best Gaussian basis parameters are calculated by the optimization methods from [12], the Gaussian Basis representation of PPG signal will have the best propinquity effect. The optimal Gaussian basis representation is formulated as(5)R=argminL∑k=1k=N[p(tk)−p′(tk)]2In (5), the elements L are the unknown variables which can be solved by the first order partial derivative assigned to zero. It is a multi-dimensional extremum points searching problem. The equals form (5) can be solved by the steepest-descent method which is a very useful and practical method in solving nonlinear minimization problems [18]. As reference from [12], the matrix L is considered as the target to search by the iterative refinement processing.(6)∇R=−∂R∂Li,i=1,2,…,3nTo calculate the results more quickly, the modified Gauss–Newton method [19,20] can be employed. In [12], a exact process, which has been used in this section, is obtained by [20]. The major enhancement of the procedure is using the Taylor serves expansion to get the linearization of the approximation PPG signal. The example is shown as(7)Pˆα+β=Pˆα+Sβ(8)Pˆα=p′tk,k=1,2,…,N(9)S=∂p′tk∂Li,k=1,2,…,N,i=1,2,…,3n(10)β=βi,i=1,2,…,3nAfter processing above, the problem of the least-squares estimation of parameters in (5) has been linearized. It will contribute to speed up the search process for available time. As derived from [20], the extreme point can be located by setting the first-order partial derivative to zero. The process we referred from [20] are indicated as(11)Aβ=B,(12)A=STS,(13)B=ST(P−Pˆα),where the symbol T denotes matrix transpose operation.The steepest-descent method guarantees convergence but consumes more computation time [12,19]. In contrast, the modified Gauss–Newton method does not always converge but consumes less computation time [12,19]. The new integrated method proposed in [19] balances both convergence and computation time. The advantage of the integrated method is using the steepest-descent method to updated the Gaussian basis parameters in the direction and is using the modified Gauss–Newton method to updated the Gaussian basis parameters in the search coverage. Specifically, the matrix L are iteratively optimized by(14)γ=|β|×∇RThe means to located the initial positions impacts on the result of the new integrated method proposed in [19] obviously. If the good starting search positions are selected, the best Gaussian basis representation parameters can be found faster and easier. In this section, we use the second derivative of the PPG signal in order to estimate the initial values of these parameters.When a PPG signal is filtered by a Gaussian filter, a smoother PPG signal is obtained. The second derivative of a PPG signal is formed by plotting the zero-crossings associated with the filtered signal versus the scale of the Gaussian filter [21]. We shall now investigate the relationship between the second derivative and the Gaussian basis representation of a PPG signal.Given a PPG signal we shall form the corresponding second derivative. The sequence of pairs (ti1, ti2), for i=1,2,…,n, represents the zero-crossings associated with n arches at the highest resolution (smallest scale) of the second derivative of the PPG signal. The parameters associated with these Gaussian basis, L={(ai, bi, ci) i=1,2,…,n}, may be estimated by(15)bi=ti1+ti22and(16)ci=ti1−ti22Thus, the Gaussian basis has been estimated directly from the second derivative.After having extracted all Gaussian basis, they can be analyzed further by applying the Hilbert transform (HT) or processing them in any other suitable way. The combination of Gaussian decomposition of a PPG signal into its Gaussian basis plus residue and a subsequent Hilbert spectral analysis to extract instantaneous frequencies and phases will be discussed in this section. The Hilbert transform calculates the conjugate pair of Gaussian basis Gi(t) via(17)HGi(t)=1πPV∫−∞∞Giτt−τdτwhere PV indicates the Cauchy principal value. This way an analytical signal gi(t) can be defined via(18)git=Git+j×HGi(t)=Vit×ej×θitwith amplitude Vi(t) and instantaneous phase θi(t) given by(19)Vit=Git2+HGit2(20)θit=arctanHGitGitEach Gaussian basis can now be expressed as(21)Git=ReVi(t)×ej×θitPPG signal p(t) can then be expressed as(22)pt=∑i=1nReVit×ej×θit+rtA Gaussian basis expansion thus provides a generalized Fourier expansion. Note that because(23)θit=arggit=∫−∞tωiτdτ=∫0tωiτdτ+θi0An instantaneous frequency fi(t) can be obtained as(24)fit=12π×ωit=12π×dθitdtA system for continuous acquisition of the PPG waveform was developed and validated previously [22,23]. As demonstrated in Fig. 3, the PPG waveforms were acquired by using a photoelectric transducer (HKG-07) connected to a preamplifier with a second order band pass between the characteristic frequencies 1.54Hz and 2.34Hz (−3dB points 1.0 and 3.5Hz). Radial PPG pulse waveform signals were acquired by a 16b, 16 single channels, acquisition model USB-6210 (National Instruments, USA). The PPG waveforms were acquired at a sampling rate of 1.0kHz to increase the temporal resolution and consequently the accuracy in determining values for the Gaussian basis parameters. We also designed an analysis tool in LabVIEW environment.According to the preceding procedure, an example of a ridge detection method used on a real PPG signal to detect subject breathing rate and heart rate from the ridge associated with subject PPG signal is shown in Fig. 4. During the experiment from which the signal was taken the subject was breathing regularly at breaths of 2s duration (=0.5Hz).Fig. 4 contains a PPG signal with its associated spectrum plot according to Eqs. (17)–(24). The spectrum in Fig. 4b is plotted in 3-D. Two dominant bands appear in the spectrum: the pulse band and a band associated with subject breathing. These are marked P and B, respectively, in the plot. In this example we are concerned with the detection the breathing and heart pulse through time and hence here the breathing band and pulse band are the primary bands. The pulse band appears at just over l.2Hz, or 72bpm. However, the identification of breathing features (around 0.5–0.7Hz) is often masked by other low frequency artefact in these signals. One such low frequency artefact feature is indicated in the plot by an arrow. We can see that the low frequency artefact feature causes a bifurcation of the breathing band at the location indicated by the arrow.To eliminate the variations and artifacts from the distribution of the peak positions shown in Fig. 4b, the Shannon energy envelope smooth approach, a non-linear transformation, has more advantages over conventional approaches [24]. In this paper, we demonstrate that the Shannon energy envelope estimator introduced from [24] is better able to estimate the heart rate and respiration rate in case of the variations and the artifacts using the Shannon energy and smooth envelope extraction. Experimental results demonstrate that the first two maxima in a smooth Shannon energy envelope indicate approximate locations of the heart rate and respiration rate in Fig. 4b. Hence, the smooth Shannon energy envelopes are processed further to detect the peaks corresponding to heart and respiration.For a given moment, the Shannon energy values of the frequency are formulated by Eq. (6) of [24]. According the process of [24], the little peaks in the Shannon energy envelope can be smoothed out by a filter which has a rectangular impulse response of a given length. In this study, the smoothing filter length is set as a tenth of the length of frequency axis based on practical experience. To keep the zero-phase of filtering results, the filtering operation is performed twice in two different reverse directions.Based on this method, we can find the location of first two peaks in the frequency domain for each time unit. At a given time in Fig. 4b, the location of the highest peak of the Shannon energy envelope along the frequency axis indicates the heart rate. Moreover, the location of the secondary highest peak of the Shannon energy envelope along the frequency axis denotes the respiratory rate. As summarized in [24], the advantages of Shannon energy envelop can not only reduce the artifact but also produce smooth sharp to find the major peaks in Fig. 4b.The heart rate derived from our system was compared with that obtained by the ECG monitor. Fig. 5shows a typical example of dynamic variation in heart rate at rest, and during and after exercise. During the first 4min. subjects were allowed to rest in a sitting position, and exercise was then performed for 9min. After exercise, the subject rested, sitting on the bicycle for the remaining 7min. Heart rates obtained from PPG agreed well with those obtained by ECG at rest and during exercise in this subject. The maximum error of heart rate was 7bpm.To verify the accuracy of respiratory rate derived from our method, a respiration marker signal was recorded by an observer monitoring the subject's chest movements and activating a small pushbutton switch in synchronization with inspiration (switch depressed) and expiration (switch released). The switch marker signals were processed to derive a manual respiratory rate. The results from the full analysis are presented in Fig. 6, where the PPG-derived and the marker respiratory rates are shown, with the difference between them being less than 1bpm in all subjects, and an average difference of less than 1bpm.While specialist probes have been used to identify respiratory rates and heart rate form the spectrum of Gaussian basis representation, and we believe that this is the early attempt Gaussian basis representation have been used to detect respiratory rate and pulse rate in PPG signal obtained from standard pulse oximetry equipment. As the initial discovery was made on the traces taken in our laboratory environment, and our study has shown that respiratory signals and heart signals are detectable. We expect that this technique is applicable and will cope with the artefact, etc, created during standard clinical practice.We are confident that Gaussian basis representation will provide a comparatively inexpensive and robust way of monitoring respiratory rate and heart pulse rate with only minor adaptations to current technology. We are currently working on a real time algorithm that we hope can be incorporated in future pulse oximeters. This will greatly improve the role of the pulse oximeter, permitting the rapid detection and correction of apnoea, bradypnoea and atrial fibrillation before any change in PPG signal.

@&#CONCLUSIONS@&#
