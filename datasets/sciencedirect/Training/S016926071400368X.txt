@&#MAIN-TITLE@&#
Automated detection of endotracheal tubes in paediatric chest radiographs

@&#HIGHLIGHTS@&#
We developed a computerised method for the automated detection of the endotracheal tubes and tip positions in paediatric chest radiographs.In the proposed method, a seed point was determined first from a line crossing the cervical region and was used as the initial point to trace a line path. Two features determined from the path were combined to detect the existence of the endotracheal tube, and multiple thresholds were used to determine the tip location.The proposed method was evaluated using 528 images with endotracheal tubes and 816 images without endotracheal tubes.The discriminant performance in this study, evaluated as Az (area under the ROC curve), for detecting the existence of endotracheal tubes was 0.943±0.009, and the detection error of the tip location was 1.89±2.01mm.

@&#KEYPHRASES@&#
Computer-aided detection,Endotracheal tube,Paediatric chest radiograph,

@&#ABSTRACT@&#
The aim of this study was to develop an automated method for the detection of endotracheal tube and location of its tip in paediatric chest radiographs. In this method, a seed point was first determined from the line crossing the cervical region and a line path was traced from the seed point. Two features, Lmax and C, were determined from the path and were combined to detect the existence of the endotracheal tube. Multiple thresholds applied to the line path were used to determine the candidate locations for the tip, and the most suitable location was selected from these candidates by analysing the image features. To evaluate the performance of detection of endotracheal tube existence, support vector machine was used to classify the images with and without endotracheal tubes on the basis of Lmax and C. The discriminant performance of the method was evaluated using receiver operating characteristic (ROC) analysis. To evaluate the precision of the detected tip locations, the tip locations in paediatric chest images were annotated by a radiologist. The distance (error) between the detected and annotated locations was used to evaluate detection precision for the tip location. The proposed method was evaluated using 528 images with endotracheal tubes and 816 images without endotracheal tubes. The discriminant performance in this study, evaluated as Az (area under the ROC curve), for detecting the existence of endotracheal tubes on the basis of the two features was 0.943±0.009, and the detection error of the tip location was 1.89±2.01mm. The proposed method obtained high performance results and could be useful for detecting the malposition of endotracheal tubes in paediatric chest radiographs.

@&#INTRODUCTION@&#
Tracheal intubation, the insertion of a tube into the trachea to inflate the lungs, remains a common procedure in the neonatal intensive care unit (NICU). The main goal of tracheal intubation is to position the tube at an appropriate depth inside the trachea. When correctly placed, the tip of the endotracheal tube should be positioned in the mid-tracheal region [1,2]. Malposition of the endotracheal tube may result in complications, including hypoxaemia, pneumothorax, lung collapse and death [3–5]. Hence confirmation of correct tracheal tube placement is an important procedure.To ensure that the endotracheal tube is ideally placed for proper ventilation, the current gold standard for confirming tube position is a chest radiograph [6,7]. A chest radiograph can be used to confirm the correct tube position within the trachea, which should be just below the level of the vocal cords and well above the carina. However, this is often delayed after ventilation via the tube has commenced. An important issue in this regard is how to notify physicians at the earliest when an endotracheal tube malposition occurs. This could be achieved by automatically detecting the malposition of the endotracheal tube at the moment when a radiograph is acquired or uploaded to a picture archiving and communication system (PACS) and immediately notifying the physicians.Computer-aided diagnosis/detection has been applied to chest radiographs in many aspects [8,9]. However, research on the automated detection of endotracheal tube position has received little attention. Only some related studies [10–13] on the detection of tubes in chest radiographs had been previously conducted. For the automated detection of endotracheal tube malposition, identifying the presence of endotracheal tubes and precisely locating the tip are essential steps. Besides, endotracheal tube malposition occurs more often in infants [6,14]. Therefore, in the present study, we proposed a computerised method for the automated detection of endotracheal tubes and tip positions in paediatric chest radiographs and evaluated the performance of the proposed method.The proposed method was evaluated using 1344 anteroposterior paediatric chest radiographs, including 528 images with endotracheal tubes and 816 images without endotracheal tubes. The images were obtained from 412 patients in the NICU of Kaohsiung Medical University Hospital, Taiwan, from January to July 2013. All the chest radiographs were obtained using a computed radiography system (FCR 5000; Fuji Photo Film, Tokyo, Japan) and a digital radiography system (CXDI; Canon Inc., Tokyo, Japan). The images obtained by FCR 5000 were digitised with a pixel size of 0.1mm, a matrix size of 2505×3015, and a grey scale of 10 bits. The images obtained by CXDI were digitised with a pixel size of 0.08625mm, a matrix size of 2868×3460, and a grey scale of 12 bits. In this study, all MONOCHROME2 images were converted to MONOCHROME1 images, in which the regions of greater X-ray attenuation correspond to lower pixel values.The proposed method was developed based on the assumption that an endotracheal tube exists in a test image. This assumption was tested by specific criteria to determine the existence of the endotracheal tube. Fig. 1demonstrates the overall scheme of the proposed method and each step is described in detail as follows.In a paediatric chest image, the field of view (FOV) is often smaller than the whole image, as shown in Fig. 2(a). A threshold, Tmask, was first determined by Otsu's method [15] from the histogram of the image, as shown in Fig. 2(b). The FOV mask was further obtained by Tmask. In the FOV mask, the mass centre (Cx, Cy) was first determined, and four edge points were further determined based on the mass centre, as shown in Fig. 2(c). Only the portion of the image inside the rectangle with the upper border at Y1, lower border at Y2, left border at X1 and right border at X2 was used for the following procedures.To detect the endotracheal tube in a chest radiograph, a horizontal line intercepting the cervical region was first obtained as shown in Fig. 3(a). The cervical region could be located in the upper part of a paediatric chest image. In the present study, the search process was limited to the interval between 1 and HFOV/4. To determine the horizontal line, a projection profile, V(y), was first obtained by summing the pixel values of the image along the x-coordinate. V(y) can be defined as follows (Eq. (1)):(1)V(y)=∑x=1WFOVI(x,y)WFOVwhere I(x, y) is the chest image, WFOV is the width of the FOV and HFOV is the height of the FOV. Yneck, corresponding to the narrowest portion of the cervical region, can be determined by searching a global maximum from the projection profile V(y) between 1 and HFOV/4, as shown in Fig. 3(b). If an endotracheal tube exists in a chest image, the horizontal line at Yneck will intercept the tube.If an endotracheal tube exists, the above-mentioned horizontal line would intercept the tube. To trace the endotracheal tube, a seed point was first determined from the horizontal line. To construct the template for determining the seed point, the endotracheal tube width was measured. Manual measurements of 20 chest images with endotracheal tubes showed that the average width of the tubes was 9.4±2.5 pixels. This information was used to construct the template, which consisted of three lines with a length of 50 pixels, as shown in Fig. 4(a). The line V1 corresponds to the centre of the endotracheal tube and lines V2 and V3 correspond to the neighbourhood. The lines were separated by an interval of 5 pixels so that the lines of the neighbourhood would not fall within the tube according to the measurement of the tube width. Applying the template with three lines to an image, V1, V2 and V3 are the summation of the pixel values on the three lines, respectively. The seed point was detected using the following Eq. (2):(2)M=(V1+V3)/2−V2V2Fig. 4(b) demonstrates the scanning path, which was along the horizontal line between (Cx−WFOV/8) and (Cx+WFOV/8). For each location in the path, scanning was performed at angles varying from −30° to 30° to overcome the tilt of the tube. Our observations in the present study revealed that the angle range between −30° and 30° was sufficient to cover the tilt of the tube. Fig. 4(c) shows a typical search space (the M values in terms of x location and angle) obtained by scanning with the template. When the template matched a dense line, the M value was relatively high. The seed point location, Xseed, was determined by searching the maximum among the M values, as shown in Fig. 4(c) and (d). In addition to the endotracheal tube, the nasogastric tube often appears in the cervical region. From our observation, it was noted that the density of the endotracheal tube in paediatric chest radiographs was higher than that of the nasogastric tube, as shown in Fig. 5, and that the use of maximum value to search the seed point for the endotracheal tube worked well in this study.After determining the seed point, tracing of the line path from the seed point was performed. A small patch of an image was used to detect the endotracheal tube, as shown in Fig. 6(a). The line segments in the patch were enhanced using the mask as shown in Fig. 6(b), and the line-enhanced image G(x,y) is shown in Fig. 6(c). For a simple description of the algorithm for line path tracing, the y-coordinate of the patch image was transformed from Yneck∼Cy to 1∼m. A line path from the seed point (Xseed, 1) was determined using the line-enhanced image. Along the y position from 2 to m, each x position in the line path was determined based on the previous one, iteratively. By assuming the current y position as Ycurrent and the previous x position as Xpre, the x position with the highest value among G(Xpre−1, Ycurrent), G(Xpre, Ycurrent) and G(Xpre+1, Ycurrent) was selected as the current x position. This process was repeated to find the x position for each y location from 2 to m, and the tracing path is shown in Fig. 6(d).As the line path was obtained, the features of the line path were analysed to determine the existence of the endotracheal tube and location of the tip. This procedure is described in detail as follows.Fig. 7(a) demonstrates the values along the line path (g(y)) in a line-enhanced image. At the location of the tip, the pixel value of the line-enhanced image would drop acutely. This feature was used to determine the location of the tip. To find the tip location, each pixel value could be compared with the previous average pixel value along y. If the current value is lower than the previous average value by a threshold, the search would stop and the tip location is determined. However, choosing a proper threshold is difficult. In the present study, multiple thresholds were used to determine the potential locations of the tip, and a final location was selected from these candidates by analysing the image features around the candidate locations. The average pixel value can be defined as follows:(3)Ay=g(1)y=2Ay=(g(y−1)+Ay−1)/2y=3,…,mwhere g(y) is the pixel values of the line-enhanced image along the line path and Ayis the average pixel value at the location y. The threshold can be defined by Eq. (4) as follows:(4)Ty=w×Aywhere Tyis the threshold used to compare at location y and w is the weighting factor for the threshold. Multiple thresholds were obtained using different w values of 0.8, 0.7, 0.6, 0.5 and 0.4. For each w, the comparison was performed along y from 2 to m, as shown in Fig. 7(a). If g(y) was lower than Tyat location n, the search would stop and the location n−1 would be selected as a candidate location. Five candidate locations for the tip were determined by different w values, as shown in Fig. 7(b). The extent of criterion (w) would result in the length of candidate location from the seed point.As the candidate locations for the tip were determined, the most suitable one was selected from these candidates by analysing the image features around the candidate locations. Fig. 8(a) shows that two regions of interest (ROI) above and below a candidate location were used to analyse the surrounding features. For each candidate location, the average pixel values in the two ROI (DROI1 and DROI2) were calculated from the original image. At the tip location, DROI1 would be small due to lower pixel value of the endotracheal tube and the difference between the two ROI (DROI2−DROI1) would be high at the endpoint of the tube. Eq. (5) simply combines these two features as follows:(5)F=(Dmax−DROI1)×(DROI2−DROI1)where Dmax is the highest pixel value in the image. Among the candidate locations, the one with the highest F value was selected as the endpoint location, as shown in Fig. 8(b).Without a line segment in a chest image, the search process cannot stray considerably from the seed point even when the loosest threshold (w=0.4) is used. This feature can be used to indicate the existence of the line segment in the analysed region. The length (Lmax) determined by the threshold with w=0.4 was used as a feature to detect the existence of the endotracheal tube, as shown in Fig. 9.In addition to the endotracheal tube, the nasogastric tube is often noted in the analysed region, and another feature is required to distinguish between the endotracheal tube and other line segments. As shown in Fig. 10, the line path could be separated into the upper and lower segments by the position p with highest F value. For the endotracheal tube, the properties of the upper and lower segments are very different; however, for the nasogastric tube or other line segments crossing the analysed region, the properties of the two segments are similar due to the continuity of the line segment. This feature was used to distinguish between the endotracheal tube and other line segments. Eq. (6) is defined to indicate the property difference between the upper and lower segments as follows:(6)C=0ifp=mC=(Mupper−Mlower)/MupperotherwisewhereMupper=∑y=1pg(y)/p,Mlower=∑y=p+1mg(y)/(m−p), Mupper and Mlower are the average line-enhanced values of the upper and lower segments, respectively. The C value is close to zero if the properties of the two segments are similar; otherwise, C has a high value due to the property difference. The C value was set to zero if p was located at the lower border (m) of the analysed region.The two features, Lmax and C, were combined to detect the existence of the endotracheal tube in a paediatric chest radiograph. If the existence of the endotracheal tube was detected by the proposed method, the location corresponding to p in the original image was further used as the tip location.Lmax and C were combined for use in detecting the existence of the endotracheal tube. The discriminant performance was evaluated for each feature and combination of the two features. For the combination of the two features, support vector machine (SVM) [16,17] with radial basis function kernel was used in the present study to classify the cases with and without endotracheal tubes based on the Lmax and C values. To prepare the training set, 100 cases with endotracheal tubes and 100 cases without endotracheal tubes were selected randomly from the whole data. The randomly selected cases were then used to train the classifier and create a model. Finally, the prediction values for the remaining 1144 cases were determined using the obtained model. The prediction values for the combination of the two features as well as the values of the two features themselves were analysed by receiver operating characteristic (ROC) analysis [18,19]. The discriminant performance was evaluated as Az, the area under the ROC curve. The data obtained were analysed and plotted using SPSS statistical software (version 14.0).A radiologist annotated the tip location for each paediatric chest image with endotracheal tube used in the present study by employing the software developed in-house. These annotated locations were then used to evaluate the proposed method. Using the manually annotated locations as the gold standards, the errors of the detections are defined by the distance between the detected locations (xd, yd) and the gold standards (xs, ys) as follows:(7)Errtip=(xd−xs)2−(yd−ys)2

@&#CONCLUSIONS@&#
In the present study, we proposed an automated method for detecting the endotracheal tube and location of its tip in paediatric chest radiographs. In this method, a seed point was determined first from a line crossing the cervical region and was used as the initial point to trace the line path. Two features, Lmax and C, determined from the path were combined to detect the existence of the endotracheal tube, and multiple thresholds were used to determine the tip location. The proposed method obtained high performance results and could be useful for detecting the malposition of the endotracheal tubes in paediatric chest radiographs.