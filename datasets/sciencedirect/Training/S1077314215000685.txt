@&#MAIN-TITLE@&#
Phase correlation with sub-pixel accuracy: A comparative study in 1D and 2D

@&#HIGHLIGHTS@&#
Six methods for the accurate estimation of phase-correlation maxima are evaluated.Methods are tested under noise, extreme transformations, incomplete data, and for real cases with unknown transformations.Sinc function fitting provides the best average accuracy.Local Center of Mass, and Minimization of the POC gradient provide good balance between accuracy and efficiency.

@&#KEYPHRASES@&#
Phase correlation,Sub-pixel accuracy,Rigid image registration,Motion estimation,

@&#ABSTRACT@&#
Six methods for the accurate estimation of the phase-correlation maxima are discussed and evaluated in this article for one- and two-dimensional signals. The evaluation was carried out under a rigid image registration framework, where artificially generated transformations were used in order to perform a quantitative assessment of the accuracy of each method and its robustness in the presence of noise, incomplete data, or extreme transformations. Another round of tests were performed with real cases where the true transformation is unknown, and not necessarily rigid; for these tests, quantitative evaluation was achieved by means of the root mean square error of the overlapping area between the two aligned images. While most methods behaved similarly under difficult conditions, three of the methods under study displayed clear advantages under mild levels of noise, low transformation complexity, and small percentages of missing data. These methods are the local center of mass, sinc function fitting, and minimization of the POC gradient magnitude. The other tested methods included quadratic fitting, linear fitting in the frequency domain, and up-sampling; however, these methods did not perform consistently well.

@&#INTRODUCTION@&#
The phase correlation method [1] is a frequency domain technique used to estimate the delay or shift between two copies of the same signal. This technique is based on the shift properties of the Fourier transform. Specifically, consider two discrete periodic signals f(x) and g(x), and let F(ω) and G(ω) be their respective Fourier transforms. The normalized cross-spectrum R(ω) of f and g is given by(1)R(ω)=F(ω)G*(ω)|F(ω)G*(ω)|,where G* is the complex conjugate of G. Note that|R(ω)|=1for all ω. Also, the phase-only correlation (POC) function r(x) is defined as the inverse Fourier transform of R(ω).Now suppose g is simply a delayed copy of f; that is,g(x)=f(x+d), where d is an unknown integer. The shift property of the Fourier transform states thatG(ω)=F(ω)exp{jωd}, wherej=−1. In this case, it is easy to see thatR(ω)=exp{−jωd}andr(x)=δ(x−d), where δ is the discrete impulse function (i.e.,δ(0)=1andδ(x)=0forx0.25em0ex≠0.25em0ex0). Therefore, one can recover d by simply locating the maximum of r(x).This method can be easily extended to 2D and 3D images, and has been successfully applied in several image processing and computer vision problems, such as image registration [2–5], biometrics [6–8], stereo disparity estimation [9,10], motion and optical flow estimation [11,10], and video encoding [12,10]. While newer methods have been proposed, such as Gradient Correlation [13], the phase correlation method is still very popular and widely used in a variety of applications.One of the most important drawbacks of the basic phase correlation method, when implemented in the discrete-time domain, is that the recovered displacements have integer accuracy; i.e., the coordinates of the maximum of the discrete POC function will be a rounded version of the components of the true displacement vector. Various alternatives have been devised to estimate the displacements with non-integer (sub-pixel) accuracy. Among the most popular are those which rely on local function fitting: one can first obtain the displacement d0 with integer accuracy using the basic phase correlation method and fit a simple analytical function f(d) (e.g., a polynomial) to the POC values in a neighborhood of d0; then one maximizes f(d) to estimate the true maximum. The most common fitting functions are quadratic polynomials and Gaussian functions [14,15], cubic splines [6], and Dirichlet or sinc functions [16,17,11]. In a recent approach, the authors derive an expression for the continuous gradient of the POC function, and use different search methods to find the minima of the magnitude of the gradient, which correspond to the extrema of the POC function [18]; since the search is performed around the initial integer-valued solution, this method is able to quickly estimate the location of the POC maximum with good accuracy.Most of the methods described above perform reasonably well under controlled conditions but their accuracy is seriously degraded by noise, border effects, and the presence of multiple motions. This restricts many of the methods from being applied to some computer vision problems, such as stereo depth or optical flow estimation. Also, most of these methods were originally proposed in order to overcome the limitations of the classic POC method within the context of a specific application, without considering other possible approaches to the estimation of the POC maxima with sub-pixel accuracy.A few papers have been published where some of the methods described above are compared. For instance, Argyriou and Vlachos perform a comparison by fitting different functions (quadratic, Gaussian, and sinc) around the integer-valued solution, in the context of motion-based video encoding [19]. This work shows that fitting a Sinc function produces the best results among the tested fitting functions, particularly in the presence of white additive noise. In another study, Vera and Torres evaluate five different methods, including up-sampling in the frequency domain, linear fitting in the frequency domain, and Gaussian fitting in the spatial domain, for the estimation of 2D translations under aliasing conditions [20]. The authors conclude that Gaussian function fitting provides results that are less affected by aliasing than the other methods under study. While these works provide a good reference point, they do not include some of the more recent proposals and also lack a detailed explanation of each method under study. Moreover, the batteries of tests reported in these works are relatively limited and sometimes do not show the particular strengths and shortcomings of each method.In this work, a thorough comparison of six of the most representative methods for the estimation of POC maxima at sub-pixel level is presented, focusing on accuracy, success rate, and robustness to noise and missing data in a translational and rigid image registration framework. In Section 2 we will describe in detail all the methods under study. Section 3 will present some ideas that may increase the performance of some of the methods. In Section 4, the evaluation results for the estimation of translational and rigid transformations will be shown. And finally, Section 5 will present our conclusions.

@&#CONCLUSIONS@&#
Six methods for the estimation of the phase-correlation maxima with sub-pixel accuracy were evaluated. These methods included: local fitting of quadratic (QuadFit) and sinc functions (SincFit), fitting a linear function in the frequency domain (LinFit), local center of mass (LCM), up-sampling in the frequency domain (UpSamp), and minimization of the magnitude of the POC gradient (GradPOC). Various tests were performed to assess the robustness of each method against additive noise, extreme transformations, and missing data. From these tests, one can conclude that the more accurate methods at mild or moderate noise levels are LCM, SincFit and GradPOC, with SincFit having a slight edge in accuracy. At higher noise levels, all of the methods under study perform similarly, with the exception of LinFit, which seems to be extremely sensitive to noise, even at mild levels. A similar behavior is observed at increasing degrees of ranges for the transformation parameters (transformation complexity), increasing degrees of missing data, and for difficult cases such as those presented in Section 4.4. Surprisingly, the LCM method, which is the easiest to implement and the most computationally efficient, performed very well with real transformations, which makes it apt for real-time implementations, or for a first approach before implementing a more sophisticated method. In general, however, SincFit appears to be the most accurate and robust of all the evaluated methods. On the other hand, linear fitting in the frequency domain proved to be very sensitive in our tests, although it has been used successfully in certain scenarios, mostly for translational registration [22]; however, its application to rigid registration seems to be challenging due to the non-linearities introduced to the normalized cross-correlation function by the presence of rotations and scales, interpolation artefacts, and multiple motions. Finally, the Up-sampling method did not produce results that were competitive enough to justify its high computational cost.