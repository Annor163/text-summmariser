@&#MAIN-TITLE@&#
Automated lesion detectors in retinal fundus images

@&#HIGHLIGHTS@&#
A novel computer-aided decision support system for diabetic retinopathy using retinal fundus images is proposed.Microaneurysm, hemorrhage and bright lesion binary classifier detectors are devised.Validation of the system on large datasets using standard measures is performed.

@&#KEYPHRASES@&#
Microaneurysm detector,Hemorrhage detector,Bright lesion detector,Retinal fundus image,Computer-aided diagnosis,Wavelets,Multiscale analysis,Variational segmentation,Cartoon+texture decomposition,

@&#ABSTRACT@&#
Diabetic retinopathy (DR) is a sight-threatening condition occurring in persons with diabetes, which causes progressive damage to the retina. The early detection and diagnosis of DR is vital for saving the vision of diabetic persons. The early signs of DR which appear on the surface of the retina are the dark lesions such as microaneurysms (MAs) and hemorrhages (HEMs), and bright lesions (BLs) such as exudates. In this paper, we propose a novel automated system for the detection and diagnosis of these retinal lesions by processing retinal fundus images. We devise appropriate binary classifiers for these three different types of lesions. Some novel contextual/numerical features are derived, for each lesion type, depending on its inherent properties. This is performed by analysing several wavelet bands (resulting from the isotropic undecimated wavelet transform decomposition of the retinal image green channel) and by using an appropriate combination of Hessian multiscale analysis, variational segmentation and cartoon+texture decomposition. The proposed methodology has been validated on several medical datasets, with a total of 45,770 images, using standard performance measures such as sensitivity and specificity. The individual performance, per frame, of the MA detector is 93% sensitivity and 89% specificity, of the HEM detector is 86% sensitivity and 90% specificity, and of the BL detector is 90% sensitivity and 97% specificity. Regarding the collective performance of these binary detectors, as an automated screening system for DR (meaning that a patient is considered to have DR if it is a positive patient for at least one of the detectors) it achieves an average 95–100% of sensitivity and 70% of specificity at a per patient basis. Furthermore, evaluation conducted on publicly available datasets, for comparison with other existing techniques, shows the promising potential of the proposed detectors.

@&#INTRODUCTION@&#
Diabetic retinopathy (DR) is a sight-threatening consequence of Diabetes mellitus which affects the small blood vessels in the retina, the nerve layer that lines the back of your eye. Often there are no visual symptoms in the early stages of diabetic retinopathy. Early diagnosis and treatment are essential to prevent significant vision loss from DR. So, it is vital for a diabetic patient to have regular eye examinations. One of the easiest ways to diagnose DR is by analyzing fundus images. They are the visual records which document the current ophthalmoscopic appearance of a patient׳s retina, the retinal vasculature, and the optic nerve head (optic disc) from which the retinal vessels enter the eye. The acquisition of fundus images is inexpensive, non-invasive and easy to perform. Therefore they are adapted for large scale screening purposes.DR can be mainly classified into two classes: non-proliferative diabetic retinopathy (NPDR) and proliferative diabetic retinopathy (PDR). NPDR is the earliest stage of DR and can be described as mild, moderate or severe. With this condition, the walls of the blood vessels in the retina become weak. Tiny bulges protrude from the vessel walls, sometimes leaking or oozing fluid and blood into the retina. Also, sometimes, deposits of cholesterol or other fats from the blood may leak into the retina. NPDR can cause several changes in the eye, including microaneurysms (MAs), hemorrhages (HEMs) and bright lesions (BLs) (as for instance hard and soft exudates). PDR is the more advanced form of the disease, where fragile new blood vessels form on the surface of the retina over time. These abnormal vessels can bleed or develop scar tissue causing severe loss of vision. PDR may cause more severe vision loss than NPDR because it can affect both central and peripheral vision. Due to this reason it is very significant to diagnose and treat DR in the non-proliferative stage.Computer-aided detection and diagnosis of DR with retinal fundus images significantly lessens the burden of the implementation of a large scale screening of the diabetic patients. Recent years have seen the development of methods for the accurate detection of MAs, HEMs and BLs by considering them individually and in a collective way. Without being exhaustive we mention here some of these works on automated detection of DR. A survey of various methods related to DR can be found in [1]. The segmentation of exudates using fuzzy c-means clustering algorithm is done in [2]. After extracting color, size, edge strength, and texture features from the regions, a multilayer neural network classifier is used to classify the images. In [3] a new hybrid classifier as an ensemble of Gaussian mixture model and support vector machine is proposed for exudate detection. In [4] a new candidate segmentation method, based on mathematical morphology, is proposed. After extracting some features, a random forest algorithm is used to detect the exudates among the candidates. An automatic MA detector based on template matching in wavelet space using a Gaussian template is proposed in [5]. The detection of MAs and HEMs based on recursive region growing segmentation algorithm and a moat operator is done in [6]. After extracting the potential candidates and formulating a set of features of MAs, HEMs and exudates, [7] used a hybrid classifier which is a weighted combination of multivariate m-Mediods and a Gaussian mixture model. An ensemble-based framework for the detection of MAs is proposed in [8]. The algorithm in [9] assessed the need for referral in DR detection with a decision based on the fusion of results by meta-classification. A novel splat feature classification method is proposed in [10] to detect retinal hemorrhages. In [11] a method for the diagnosis of diabetic macular edema based on exudate detection is proposed. This detection relies on a feature vector generated for each image that results from an exudate probability map (computed from the exudate candidate map in a pre-processing step), from color analysis and from wavelet analysis. In [12], the authors describe a method for segmentation of exudates in fundus images using image registration. A retinal statistical atlas based on ethnicity is built and the lesions on a diseased eye image are identified depending on the chromaticity differences between the mean atlas image and the diseased image.The present paper describes an intelligent automated system for the binary classification of different types of DR lesions by processing eye fundus images. We derive some novel contextual detectors for MAs, HEMs and BLs, depending on the lesion intrinsic properties. The numerical features, which define each detector, rely on the analysis of several wavelet bands (resulting from the isotropic undecimated wavelet transform [13] decomposition of the retinal image), and on an appropriate combination of Hessian multiscale analysis (more precisely, using the Hessian eigenvalues), variational segmentation [14,15] and cartoon+texture decomposition [16]. The features are then used to classify the retinal images into separate categories of DR. The decision criteria, on whether a frame has or does not have one of these lesions, are based on simple thresholding approaches.To the best of our knowledge, this is the first time that the variational segmentation [14,15] and cartoon+texture decomposition [16] (of high wavelet levels) are combined and used in retinal fundus images for the detection of medium/large HEMs or BLs (more noticeable in the cartoon part) and clusters of dotted BLs (more prominent in the texture part). In particular, in the segmented regions (containing the HEM or BL candidates) the discriminant descriptors, devised for classification, are based on suitable medical information related to the different characteristics of the lesions, such as shape, size and texture.Concerning the proposed MA detector and the detector for identifying prominent dot isolated BLs, which have proven to be very effective, they involve low wavelet levels and a blob-like detector (based on Hessian multiscale analysis and corresponding eigenvalues properties). A very recent work [17] also uses scale-adapted blob analysis and semi-supervised learning for an automated detection of MAs in digital fundus images. Our MA detector is different and simpler than the one proposed in [17]. The main differences are that we perform several pre-processing steps directly in the low wavelets sub-bands, to enhance the MAs and suppress unwanted structures, we explicitly build a scale-adapted blob-like function and finally use a simple thresholding approach for classification.We also perform a thorough testing of the proposed methods, as a system for DR detection, on several rich and large datasets (with thousands of images – a total of 45,770 fundus images from 11,511 patients) to ensure its good performance in realistic environment. It achieves an average 95–100% sensitivity and 70% specificity at a per patient basis. Further evaluation carried out on publicly available datasets, for comparison with the state-of-the art techniques, confirms the significance and potential of the proposed methods.The rest of the paper is structured as follows. Section 2 describes the mathematical models and setting used throughout the paper. Section 3 presents in detail the methodology, by explaining the definition of the MA, HEM and BL detectors. This includes the extraction of the candidates for the different lesions, description of all the features and the binary classifiers for the lesions. Section 4 presents the experimental results on several medical datasets prepared by retinal experts. Then, the paper ends with a discussion of the results and some conclusions in Section 5.The methodology developed in this paper for detecting different retinal lesions relies on four major mathematical techniques (i – wavelets, ii – multiscale analysis of the image Hessian matrix, iii – cartoon and texture image decomposition, iv – variational image segmentation) which are combined in a sequential and suitable way. This combination depends on the visual information transmitted by the different lesions (that by nature are very diverse in shape, size, texture and color). In this section we start by explaining the motivation that justifies the use of these aforementioned image processing techniques, and then for convenience of the reader, we outline these 4 techniques in an abstract framework, for a scalar image. The application of these techniques to retinal fundus images for lesion detection is afterwards explained in Section 3.

@&#CONCLUSIONS@&#
We developed a system for automated detection and diagnosis of DR, by devising appropriate MA, HEM and BL binary classifier detectors in retinal fundus images. The preprocessing phase involves the extraction of the background pixels that enables further computations on the foreground pixels only, as well as the removal of main image structures, such as the optic disk and blood vessels, so that they cannot interfere in the detection of the lesions. The extraction of the candidates for different types of lesions (MAs, HEMs and BLs) is done by analysing different sub-band wavelet images (resulting from the isotropic undecimated wavelet transform decomposition of the green channel of the retinal image), and applying Hessian multiscale analysis, variational segmentation, cartoon+texture decomposition. These techniques, that are combined in a sequential and suitable way, are appropriate for exploring the particular characteristics of the lesions (that by nature are very diverse in shape, size, texture and color). Some novel contextual features are derived and quantified, for each lesion depending on the lesion specific properties. Then the corresponding numerical feature values are used to obtain a binary classification method. Standard performance measures such as sensitivity and specificity are used for its evaluation. Firstly, the testing of the proposed methods for MA, HEM and BL detection is done individually. The performance, per frame, of the MA detector is 93% sensitivity and 89% specificity, of the HEM detector is 86% sensitivity and 90% specificity, and of the BL detector is 90% sensitivity and 97% specificity. Secondly, we consider the proposed methods as a system for DR detection and performed a thorough testing of the system on rich datasets to ensure its good performance in realistic situations. The proposed system achieves an average 95–100% sensitivity and 70% specificity at a per patient basis. Further, we tested the proposed methodology on publicly available datasets, for comparison with the state-of-the art techniques. The results confirm the significance and potential of the proposed methodology.In this work a simple thresholding approach was used for combining the MA, HEM and BL detectors to classify DR. In the future other methods, as for instance some classification algorithms, e.g. support vector machines or neural networks, will be studied for combining the proposed different detectors.None declared.