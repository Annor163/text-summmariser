@&#MAIN-TITLE@&#
A framework on wavelet-based nonlinear features and extreme learning machine for epileptic seizure detection

@&#HIGHLIGHTS@&#
Wavelet decomposition of epileptic EEG into sub-band signals helps to exhibit significant distinction between interictal and ictal EEG states.A framework on wavelet-based nonlinear features and extreme machine learning is proposed for the seizure detection.The union of sub-band features leads to better identification of seizure activities.Three nonlinear methods attain better detection performance to that of classic wavelet-based energy analysis using the same classifier.The proposed ELM detector achieves not only a high detection accuracy but also a very fast learning speed.

@&#KEYPHRASES@&#
Seizure detection,Wavelet decomposition,Approximate entropy (ApEn),Sample entropy (SampEn),Recurrence quantification analysis (RQA),Extreme learning machine (ELM),Support vector machine (SVM),

@&#ABSTRACT@&#
BackgroundMany investigations based on nonlinear methods have been carried out for the research of seizure detection. However, some of these nonlinear measures cannot achieve satisfying performance without considering the basic rhythms of epileptic EEGs.New methodTo overcome the defects, this paper proposed a framework on wavelet-based nonlinear features and extreme learning machine (ELM) for the seizure detection. Three nonlinear methods, i.e., approximate entropy (ApEn), sample entropy (SampEn) and recurrence quantification analysis (RQA) were computed from orignal EEG signals and corresponding wavelet decomposed sub-bands separately. The wavelet-based energy was measured as the comparative. Then the combination of sub-band features was fed to ELM and SVM classifier respectively.ResultsThe decomposed sub-band signals show significant discrimination between interictal and ictal states and the union of sub-band features helps to achieve better detection. All the three nonlinear methods show higher sensitivity than the wavelet-based energy analysis using the proposed framework. The wavelet-based SampEn-ELM detector reaches the best performance with a sensitivity of 92.6% and a false detection rate (FDR) of 0.078. Compared with SVM, the ELM detector is better in terms of detection accuracy and learning efficiency.Comparison with existing method(s)The decomposition of original signals into sub-bands leads to better identification of seizure events compared with that of the existing nonlinear methods without considering the time–frequency decomposition.ConclusionsThe proposed framework achieves not only a high detection accuracy but also a very fast learning speed, which makes it feasible for the further development of the automatic seizure detection system.

@&#INTRODUCTION@&#
Epilepsy is a serious disorder of the central nervous system, which is characterized by recurrent seizures that occur at unpredictable occasions. Approximately 1% of the general population exhibits symptoms of epilepsy [1]. Frequent seizures increase the risk of sustaining physical injuries and may even result in death [2,3].The electroencephalography signals (EEGs) have been viewed as the practical way for epilepsy monitoring and diagnosis. However, the visual inspection of long time EEG data is very laborious work for medical doctors [4] and the detection of the seizure activities is a challenging job even for the trained neurologist since EEG signals are easy to be contaminated by the excessive presence of artifacts. Hence, it is significant to develop the automatic system to liberate the neurologists from long-term EEG interpretation.Many methods have been explored for the automatic analysis of epileptic EEGs and those studies mainly focus on feature extraction of epileptic characteristics and classification of seizure activities. Some of the efficient seizure detection methods are based on power spectral analysis [5–7], wavelet decomposition [1,8] and morphologic pattern [9]. Some of these studies have been tested on commercial software such as IdentEventTM [7]. In the recent years, nonlinear analysis techniques have gained more popularity with promising results due to the nonlinear and dynamic nature of EEG signals [10–13]. The summary of such studies is given in the discussion part of the paper. In this study, we assess and compare three nonlinear feature extraction techniques: approximate entropy (ApEn) [14–16], sample entropy (SampEn) [17–19] and recurrence quantification analysis (RQA) [20–25].Recent investigations indicate in some cases, EEG wavelet sub-bands may yield more accurate information about constituent neuronal activities underlying EEG signals [8]. The characteristics which are not evident in the original full-spectrum EEG may be distinct in separate sub-band signals. In our experiments, some of the nonlinear measures cannot gain satisfying classification performance based on the analysis of original EEG signals. Hence, our proposed method includes the time–frequency decomposition to extract the data characteristics by different resolutions of time and frequency scales. In addition, a wavelet-based energy analysis is carried out for the comparison with nonlinear methods.In the research of epileptic seizure detection, classification method is another focus of this type of work. Up to now, the design of detectors still encounters big challenge because the long time recording generates extremely large amount of data and has considerable overlap of seizure and non-seizure states [3,26]. To improve the overall performance of a detection system, the designers must confront a steep tradeoff between detector sensitivity and specificity and make a compromise between detector efficiency and specificity. The first widely applicable technique was developed on wavelet filter to extract the frequency features and constructed a neural network detector for classification [5]. Back-propagation (BP) algorithm and support vector machine (SVM) [3] have been widely explored as the detector for classification. However, when the sample size is large, the learning speed of both methods is too slow to meet the requirements for real-time applications. A novel learning algorithm extreme learning machine (ELM) can not only avoid falling into local optima but also largely improve the learning speed [19,27]. In this research, the wavelet-based nonlinear features were fed to the ELM classifier for detecting epileptic seizures with overall consideration of detector sensitivity, specificity and efficiency. The goal of this research is to develop a highly sensitive automatic system with a low false detection rate to assist neurologists to review potential EEG epochs containing seizures.The data set explored in this study consists of 476h continuous EEG sampled at 256Hz. The data set was recorded from 12 pediatric patients at Children's Hospital Boston. Subjects were monitored for up to several days following withdrawal of anti-seizure medication in order to characterize their seizures and assess their candidacy for surgical intervention. In all these records, 68 events were judged as clinical seizures by medical doctors. The beginning and end of each seizure was annotated by the experts. The data was segmented into 1h long records. The international 10-20 system of EEG electrode positions and nomenclature was used for these recordings. Most records contain 23 channels of EEG signals (24 or 26 in a few cases). More details of the EEG data used in this paper are described in Shoeb and Guttag [3]. The data is available in the CHB-MIT database, which can be downloaded from the PhysioNet website: http://www.physionet.org/physiobank/database/chbmit/. Seizure is not always present in all EEG channels [26] and knowledge of seizure onset channels is necessary. For this purpose, a 25-s file with each seizure activity on one of the seizure onset channels is created from the above dataset. The channel selection is based on the knowledge of the epileptic focus. Further details regarding the patients and EEG dataset can be found in Table 1. This event-based data is then used for training the classifier which is explained in Section 2.5. The file length of seizure activities should be chosen with caution. A small length focuses on seizure onset, but also causes the detector to fail to detect a seizure whenever the onset changes. A large length enables the detection of later seizure stages, but increases the detector's false detection rate because it will extend the decision boundary to enclose more non-seizure vectors [3]. In this research, we set file length to 25s.The block diagram of the detection system is shown in Fig. 1. First, original EEG signals are decomposed into sub-band signals. Then three nonlinear features, i.e., approximate entropy (ApEn), sample entropy (SampEn), recurrence quantification analysis (RQA) and a comparative, i.e., wavelet-based energy are computed from the original EEG signals and the corresponding decomposed sub-band signals separately. Further, the union of the sub-band features is fed to an efficient classifier – extreme learning machine (ELM) to determine the class membership of these feature vectors: 1 – seizure, 0 – non-seizure. Finally, the performance of ELM is compared with another detector – support vector machine (SVM) in terms of sensitivity, false detection rate and consuming time.Since the sampling frequency of the EEG is 256Hz, the maximum available frequency is half of the sampling frequency, i.e., 128Hz, a seven level wavelet decomposition is utilized to EEG data and the sub-band signals {d3d4d5d6d7} are further analyzed. Because these sub-band signals represent activity corresponding to the frequency range 1–32Hz, which is a frequency that captures seizure onsets of various electrographic manifestations [1]. The sub-band signal a7 represents slow baseline variations mainly caused by sweating, while the sub-band signals {d1d2} capture high-frequency artifacts such as muscular contractions and environment noise [1]. The frequency bands of decomposed signals are listed in Table 2.In addition, the decomposed components {d3d4d5d6d7} approximately correspond to the basic physiological EEG rhythms, i.e., delta (0–4Hz), theta (4–8Hz), alpha (8–12Hz), beta (13–30Hz) and gamma (30–60Hz). Recent investigations indicate that in some cases, the EEG basic rhythm may yield more accurate information about constituent neuronal activities underlying the EEG [1].Considering the similarity of the wavelet family and the epileptic EEG waveform [1,15], Daubeehies 4 (db4) is used.Pincus [14] proposed approximate entropy (ApEn) as an estimator to quantify the regularity of a time series and successfully applied it to relatively short and noisy data. A large value of ApEn reflects a high degree of complexity of the time series. ApEn measures the difference in the time series between the probability of templates of length m which are close to each other and that of templates of length m+1 which are close to each other. Hence, ApEn indicates the probability of creating a new pattern while the dimension of templates increases. The larger the probability is, the more complex the time series is. The details about the algorithm are introduced in Pincus [14] and Al-Angari and Sahakian [18]. The general computing process is given in Appendix A.The ApEn counts each sequence as matching itself to avoid the happening of ln(0) in the process of calculation, which will lead to the bias of ApEn [18,19]. To overcome the drawbacks, Richman and Moorman [17] proposed a new method named sample entropy (SampEn) to reduce this bias. The computation of SampEn has two differences from ApEn. First, SampEn does not count self-matches. Second, SampEn does not use a template-wise approach when estimating conditional probabilities. It only requires that one template find a match of length m+1, and then it computes the logarithm of a probability associated with the time series as a whole [18]. The calculation details of SampEn method are given in Appendix B. Recently, SampEn has been applied for the analysis of physiological signals. Especially, it is resistant to short strong fluctuations such as epileptic activities. Song et al. [19] used SampEn to reveal the characteristics of epileptic EEG signals and identify the EEG signals regarding the existence of seizure or not.Recurrence plots are graphical tools which visualize the recurrence behavior of the phase space trajectory of dynamical systems. This method, proposed by Eckmann et al. [28] and developed by Webber and Zbilut [20], aims to quantify differently appearing recurrence plots (RPs) based on the small-scale structures. Several recurrence quantification measures have been introduced in the recent past and successfully applied to analyze noisy and non-stationary data. This research mainly focuses on three fundamental measures introduced by Webber and Zbilut [20] and one supplementary indicator explored by Gao and Cai [21]. Appendix C introduces the four recurrence quantification estimators assessed in this paper, i.e., %REC, %DET, ENTR and T1. More details of recurrence plot analysis can be found in Gao and Cai [21], Marwan et al. [22], Li et al. [23], Marwan et al. [29], and Chen et al. [25].Fig. 2illustrates the recurrence plots (RPs) of EEG at interical and ictal states. EEG time series at the ictal state (Fig. 2b upper) is characterized by high amplitude and rhythmic activity and its RP presents well-aligned vertical and horizontal structure. On the contrary, EEG time series at the interictal state (Fig. 2a upper) demonstrates non-stationary and evolving fluctuations and its RP displays different structure from that of the ictal state. In order to go beyond the visual impression yielded by RPs, four recurrence quantification measures, i.e., %REC, %DET, ENTR and T1 are calculated. The parameters selection of recurrence quantification analysis (RQA) should insure that %REC<1 [20,30]. The embedding dimension can be determined by using the mutual information method and the false nearest neighbor method [31].For the purpose of comparison with the three nonlinear methods introduced above, the energy in each of the sub-band signals {d3d4d5d6d7} is computed. The sub-band signals {d3d4d5d6d7} are not used directly as entries of the feature vector. Using such a direct representation of the EEG waveform is too sensitive to noise and slight variations in morphology [1]. Instead, the energy in each of the sub-band signals {d3d4d5d6d7} is used. An explicit representation of the features computed for each sub-band is:(1)X3X4X5X6X7=log(∑nd3(n))log(∑nd4(n))log(∑nd5(n))log(∑nd6(n))log(∑nd7(n))where n represents the length of EEG epoch. Since EEG cannot be segmented into too short physiological relevant units, four-second long epoch with an overlap of 0.5s is used in this paper.The extreme learning machine (ELM) is a new learning algorithm developed on the basis of single-hidden layer feed-forward neural networks (SLFN) [27]. For almost all practical feed-forward neural networks, it is extremely time-consuming to adjust the input weights and hidden layer biases and is easy to fall into local optima. To overcome the defects of the traditional gradient-based learning algorithms, Huang et al. [27] proposed a simple implementation of SLFN by randomly choosing input weights and hidden layer biases if the activation functions in the hidden layer are infinitely differentiable. After this process, SLFN can be viewed as a linear system and only the outputs weights need to be analytically determined. More details of ELM can be found in Huang et al. [27] and Song et al. [19]. The general process of ELM algorithm is explained in Appendix D.In this experiment, the ELM that can achieve the best classification results has 20 hidden neurons and the sigmoid function is chosen as the hidden layer activation function. There is one node in the output layer whose target value is defined as: 1 – seizure, 0 – non-seizure.In addition, support vector machine is applied for comparison with ELM. For the SVM classifier, RBF kernel is chosen as kernel function and for model selection ten-fold cross-validation on training data is used. Once the optimal pair of parameters is found, it is used to train the final model on all the training data.The proposed seizure detection system is patient-independent and a leave-one-out cross validation method is used [26]. All but one patients’ data is trained for the classifier. The withheld patient's data is used for testing. This process is repeated N times (N is the amount of patients) so that each patient's data has been tested.In the training stage, seizure and non-seizure epochs are labeled 1 and 0, respectively. For the seizure class, if a training dataset consists of N−1(N=12) patients for which 25s of each seizure event are computed and on average M(M=5.7) seizures occur on each patient, then for an epoch length of 4s with an overlap of 0.5s, the seizure class of training data will consist of 11 patients*5.7seizures*(25/0.5)=3135 epochs. For the non-seizure class, a long period of non-seizure record is used to ensure that awake, sleep, abnormal, and artifact-contaminated EEG are included [3]. Non-seizure EEGs are randomly selected from long-term EEG recordings free of seizures from all patients in the training dataset. The averaged interictal period for each patient is 39.6h. The number of non-seizure epochs may be more or less depending on the length of EEG recordings for every patient. Before the training stage, the training features are normalized by subtracting the minimum and dividing by the difference between the maximum and minimum. The trained model is then applied to the testing data.Different combination of feature extraction methods and classifiers should be evaluated using conforming assessment criteria [3,12,26,32]. Considering of the clinical utility of the detection system, two event-based estimators, i.e., sensitivity and false detection rate are defined. Sensitivity (Sens.) refers to the percentage of test seizures correctly identified as seizure activities by the system. False detection rate (FDR) refers to the number of times per hour, that the detector declares the seizure activity in the absence of an actual clinical seizure.

@&#CONCLUSIONS@&#
This research proposed a framework on wavelet-based nonlinear features and extreme learning machine for the epileptic seizure detection. First, the original EEG signals were subjected to a seven level decomposition. Three nonlinear methods, i.e., approximate entropy (ApEn), sample entropy (SampEn), recurrence quantification analysis (RQA) and a comparative wavelet-based energy were computed for the original and the corresponding sub-band EEG signals separately. Our experimental results demonstrate that the features in the sub-bands {d4d5d6d7} represent significant discrimination between interictal and ictal states. The union of the sub-band features helps to achieve a better identification of seizure activities. In addition, three nonlinear methods attain better detection performance than that of wavelet-based energy analysis using the same detector. Further, compared with the learning algorithm of SVM, the ELM has much faster speed and reaches higher detection accuracy, which demonstrates its potential for the development of automatic seizure detection.