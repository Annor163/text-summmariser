@&#MAIN-TITLE@&#
Novel fuzzy active contour model with kernel metric for image segmentation

@&#HIGHLIGHTS@&#
We propose a model which incorporates kernel metric and fuzzy logic for image segmentation.The updating of region prototypes is more robust against outliers and noise.The evolution of contour in our model is stable and accurate.The proposed model achieves good balance between accuracy and efficiency.

@&#KEYPHRASES@&#
Active contour mode,Image segmentation,Fuzziness,Kernel metric,Nonlinear,

@&#ABSTRACT@&#
In this paper, a novel region-based fuzzy active contour model with kernel metric is proposed for a robust and stable image segmentation. This model can detect the boundaries precisely and work well with images in the presence of noise, outliers and low contrast. It segments an image into two regions – the object and the background by the minimization of a predefined energy function. Due to the kernel metric incorporated in the energy and the fuzziness of the energy, the active contour evolves very stably without the reinitialization for the level set function during the evolution. Here the fuzziness provides the model with a strong ability to reject local minima and the kernel metric is employed to construct a nonlinear version of energy function based on a level set framework. This new fuzzy and nonlinear version of energy function makes the updating of region centers more robust against the noise and outliers in an image. Theoretical analysis and experimental results show that the proposed model achieves a much better balance between accuracy and efficiency compared with other active contour models.

@&#INTRODUCTION@&#
Image segmentation has always been a fundamental and important task in computer vision and machine learning. Many methods for image segmentation have been proposed such as thresholding [1], clustering [2], edge detection and so on. However, due to the presence of noise, outliers, low contrast and imaging artifacts in images, robust and stable image segmentation is still a challenging problem. Among these methods, a well-established class of methods are active contour models (ACMs).The ACM has two major advantages over classical methods mentioned above. It can achieve better accuracy of segmentation [3] and can be easily formulated as a minimization of an energy function which allows the incorporation of different and useful image information [4–6].The ACM is early known as a snake model proposed by Kass et al. [7]. With the development of active contour methodology, different variations of active contour models have been proposed for image segmentation. According to the difference of forces driving the evolution, existing active contour models can be roughly put into two categories: edge-based models [3,8–10] and region-based models [11–14]. Image gradient information is usually employed in edged-based models to guide the contour to the location of object. Therefore, noise or weak boundaries in an image will make it difficult for edge-based models to perform a successful image segmentation. Region-based models usually use the region-based information, such as intensity, color or texture, to guide the motion of contour. And compared with edge-based models, region-based models are less sensitive to the noise, weak boundaries and the initial location of the contour. One of the most famous and widely used region-based models is Chan–Vese (CV) mode [11] which is based on Mumford–Shah functional [15] and proposed by T.F. Chan and L. Vese. This model uses the global intensity difference between the original image and its approximation image to guide the contour. The approximation image in CV model is constructed under the assumption that the intensities of the original image are piecewise constant. And this model is very successful to detect the objects of which the boundaries are not necessarily defined by gradient. However, the sign distance function [16,17] used as the initial LSF in CV model could be seriously degraded during the evolution. Usually a procedure called reinitialization of the LSF is applied periodically to preserve the distance information of the LSF and maintain the stability of evolution. The introducing of this procedure not only causes the problem of how and when to perform the procedure [18] but also introduces a lot of computations and some numerical errors. In addition, the CV model generally does not work well for images with low contrast, intensity inhomogeneity. This also limits the application of CV model. To get rid of this reinitialization procedure, Li et al. [9] proposed a distance regularized term to encourage the LSF to preserve the distance information during the evolution. And to deal with the problem of intensity inhomogeneity in image segmentation, the global fitting energy in CV model is replaced by the local binary fitting (LBF) energy [13,12]. In addition the distance regularized term is further improved by Li [10]. The energy function in LBF model is constructed with a kernel function and therefore, this model allows the extraction of local intensity information on different scales. Due to its good segmentation performance, LBF model has attracted extensive attentions. However the scale parameter in the kernel function is not self-adaptive and it is sensitive to set this parameter in some cases. Besides, there are four convolution computations in each iteration which greatly increases the computational complexity of this model.However, the CV based ACMs trap into local optima easily [19]. An appropriate way to reject local optimal is to construct a bi-convex objective function by introducing fuzzy sets [20]. Fuzzy sets which have been widely used in image segmentation and data clustering is first introduced to ACMs by S. Krinidis and V. Chatzis [21]. Combining the fuzzy sets and active contour methodology, the fuzzy energy-based active contour (FEBAC) model proposed in [21] has a capacity of rejecting local minima. Although this model is formulated with a pseudo-level set function, the active contour is represented by the 0.5 level set of LSF which also called fuzzy membership function here. And instead of traditional methods solving Euler–Lagrange equation, a direct method based on a fast optimization algorithm proposed by B. Song and T. Chan [22] is applied to minimize the fuzzy energy function. The convergence of this model can be achieved after very few iterations and the computational speed is very fast. Meanwhile, this model does not need the reinitialization procedure and the distance regularized term is not incorporated in energy function. However, for images without high contrast, this model may result in a not good balance between stability and efficiency. With this direct minimization method, the evolution of the contour is not stable in some cases where many regional pixels in the background are intensity similar with these pixels in the foreground. This causes that the updating of the LSF could be easily deceived by intensity information and many pixels could be wrongly labeled after very few iterations. Besides, the updating of average prototypes is sensitive to noise and outliers in this model.To deal with these problems mentioned above, our goal in this paper is designing a new active contour model for a stable, effective and robust image segmentation. Meanwhile, this new active contour model should achieve a much better balance between efficiency and stability. Besides, image segmentation based on this model should be more robust to noise and outliers in images. Based on the FEBAC model, we propose a novel region-based fuzzy active contour with kernel metric for image segmentation. Kernel methods [23,24] have attracted an enormous amount of attention in machine learning. In this paper, the motivation of introducing kernel metric is providing a robust updating of region prototypes against noise and outliers. The fuzzy sets incorporated in energy formulation are providing the model with a strong ability to reject local minima. Specially, the kernel metric is employed to replace the Euclidean distance with non-Euclidean distance and therefore, a nonlinear version of energy function is constructed. Due to the non-linearity introduced by kernel metric, this new energy function cannot be minimized by the direct method used in FEBAC model and traditional methods exploiting Euler–Lagrange equations are used to minimize the proposed energy function. However, the nonlinear distance metric used in this model and the fuzziness of the energy function result in a stable updating of the fuzzy membership function. Therefore, the reinitialization procedure is not necessary any more and the segmentation results are more accurate. In addition, the kernel metric is parameter free. The main contributions of our paper: we propose a model which incorporates kernel metric and fuzzy sets for image segmentation, the updating of region prototypes and the evolution of contour are more robust against outliers and noise, and no more parameters introduced needs to be adjusted artificially.The rest of this paper is organized as follows. Section 2 gives a brief review on related background. Section 3 describes the proposed active contour model in details. Section 4 presents the experimental results based on real images and Section 5 draws the conclusions.The Chan–Vese model is formulated under the minimization of an energy function defined by the Mumford–Shah model which is known for its robustness against noise. The basic idea of Mumford–Shah model is to find an image IAto approximate the original image I0. Let us define C as an edge set which segments the original image into non-overlapping sub-regions and Ω as the image domain. Then the energy function in Mumford–Shah model [15] can be expressed by (1)(1)FMSI,C=∫ΩI0x−IAx2dx+∫Ω\C|▿IAx|2dx+μ·LengthCwhere ∇ is the gradient operator. The first term in the right side of (1) is the mean data square term and the second one is a smoothing term used to extract smooth regions. The third one forces the edge set C to be regularized. A special case arises when intensities in the approximation image I are piecewise constant. This case is called the cartoon limit in which the second term satisfies∫Ω\C|▿Ix|2dx=0. Particularly, in the case of two phase segmentation, the image domain Ω can be divided into two sub regions:insideCandoutsideC. Here we use two constants c1 and c2 to represent the intensity averages of I0 inside C and outside C. And therefore, the energy function in CV model [11] is defined by (2).(2)FCVc1,c2,C=μ·LengthC+λ1∫insideCI0x−c12dx+λ2∫outsideCI0x−c22dxHere λ1 and λ2 are fixed parameters and usually both set to 1. To minimize the energy function2, the level set framework is introduced. And the evolving C is represented as the zero level set of the LSF ϕ such as we have following definitions expressed by (3).(3)C=x∈Ω:ϕx=0insideC=x∈Ω:ϕx>0outsideC=x∈Ω:ϕx<0Thus, the energy function (2) can be further expressed by (4).(4)FCVc1,c2,C=μ·∫Ωδϕx∇ϕxdx+λ1∫ΩI0x−c12Hϕxdx+λ2∫ΩI0x−c221−HϕxdxAnd the Heaviside function H and Dirac function δ are defined by (5) as [11].(5)Hx=1x≥00x<0δx=ddxHxThe energy function (4) is minimized by computing associated Euler–Lagrange equations and the steepest descent method is employed to update the LSF. Due to the adoption of region information in driving the evolution, the CV model is robust against noise and is very successful in detecting weak boundaries which are necessarily defined by gradient. However, as mentioned before, the CV model does not work well with images with low contrast, intensity inhomogeneity. Besides, the time-consuming reinitialization procedure used for a stable evolution is also a drawback for its application.The FEBAC model is also a region-based model which combines the fuzzy sets with the active contour methodology. In this model, different from the CV model, the evolving contour is implicitly represented as the 0.5 zero level set of the LSF u such that we have the following definitions expressed by (6).(6)C=x∈Ω:ux=0.5insideC=x∈Ω:ux>0.5outsideC=x∈Ω:ux<0.5And the fuzzy energy function [21] is expressed by (7).(7)FC,c1,c2,u=μ·length(C)+λ1∫ΩuxmI0x−c12dx+λ2∫Ω1−uxmI0x−c22dxHere the function u is also called the fuzzy membership function. u(x) represents the membership value that pixel x belongs to c1 and (1−u(x)) represents the membership value that pixel x belongs to c2. m usually set to 2 is the weighting exponent on each fuzzy membership. c1 and c2 are average prototypes of the original image inside C and outside C. With u fixed, we minimize the energy function (7) with respect to c1 and c2. And it is easy to get the equations used to update c1 and c2. The equations are respectively expressed by (8) and (9).(8)c1=∫ΩuxmI0xdx∫Ωuxmdx(9)c2=∫Ω1−uxmI0xdx∫Ω1−uxmdxWith c1, c2 fixed and the length term unconsidered for simplicity, we minimize the energy function (7) with respect to u. For simplicity, without losing the generality, the equation used for the updating of u is expressed by (10).(10)ux=11+λ1I0x−c12λ2I0x−c221m−1Specifically, for a certain pixel xi, we compute the new fuzzy membership in this pixel by (10). Then, according to the change of F caused by the single change of the fuzzy membership in pixel xi, we decide whether this new fuzzy membership replaces the old one in this pixel or not. If the change of F makes F become smaller (▵F<0), then the new fuzzy membership is adopted. If not, the old one is kept. This minimization method based on the algorithm [22] results in a very fast convergence of this model. However, according to the updating criterion of u, pixels in the background could be easily labeled as pixels belonging to the object region if their intensities are very close to the average prototype of the object region. Besides, the updating of average prototypes could be easily influenced by noise and outliers.

@&#CONCLUSIONS@&#
In this paper, we propose a novel fuzzy active contour model which incorporates the fuzzy energy and kernel metric into active contour methodology. The fuzziness of the energy function provides our model with a strong ability to reject local minima. The kernel metric is used to construct a nonlinear energy function which makes our model more robust against outliers and noise. And the kernel metric are parameter free. Due to the non-linearity of the energy function, traditional method by solving Euler–Lagrange equation is used to minimize the new energy function. This results in a lower convergence speed of our model compared with FEBAC model. However, experiments show that the evolution of contour in our model is more stable which results in a more accuracy image segmentation. In addition, experiments results also confirm that, without the introducing of reinitialization procedure or distance regularized term, our model achieves a more efficiency and accuracy segmentation of images with noise compared with other active contour models based on the same minimization method of the energy function.