@&#MAIN-TITLE@&#
Optimal arc spline approximation

@&#HIGHLIGHTS@&#
A method for approximating point sequences by arc splines is presented.The breakpoints of the arc spline are not restricted to any pre-defined set of points.For any user-defined accuracy, the minimal number of segments is guaranteed.The resulting compact curve representation enables an efficient further processing.Among others, it is hence suited for the generation of highly accurate digital maps.

@&#KEYPHRASES@&#
Approximation,Arc spline,Biarc,SMAP,

@&#ABSTRACT@&#
Graphical abstract

@&#INTRODUCTION@&#
Various applications require the approximation of planar point sequences by a suitable class of curves. Arc splines are curves composed of circular arcs and line segments (shortly: segments) which therefore have advantageous properties: exact offset and arc length computation, parameter free description and simple closest point calculation (cf. Maier, 2010). In particular, smooth, i.e.G1-continuous arc splines have been studied in literature in the past few years. Ones of the first publications were Sandel (1937) and Sabin (1977). Arc splines were then further popularized in the publications (Meek and Walton, 1992, 1995). Often, methods are considered which guarantee that the resulting arc spline has a possibly small number of arcs and stays within a user-specified tolerance from the input data (cf. Piegl and Tiller, 2002; Heimlich and Held, 2008; Drysdale et al., 2008). For this purpose, corresponding algorithms mostly follow geometric approaches: In order to approximate a simple polygonal curve, the ε-tolerance zone is focused, which is a closed polygon deduced by the set of points which have an Euclidean distance of at most ε from the input points. In Heimlich and Held (2008) an efficient method is introduced which generates tolerance zones using Voronoi diagrams.Biarcs, i.e.G1curve segments consisting of two circular arcs, have been used in a large number of algorithms for approximation or interpolation of given point and possibly tangent data. For an overview we refer to Heimlich and Held (2008). Usually, biarc algorithms fit biarcs or single arcs between selected pairs of points and use the connecting line segments of each two corresponding points for the tangent data. Doubtlessly, they are appropriate for various applications. However, there are cases where they suffer from the unnatural requirement that breakpoints and tangent data of the approximating arc spline have to be chosen from a given finite point set in advance. This is even more the case for the second main approach in literature which is based on interpolation (e.g. Yang, 2002). Note that restricting the loci of the breakpoints can have considerable influence on the resulting segment number: In Maier and Pisinger (2013), which deals with the approximation of a cyclic polygonal curve byG0-continuous arc splines, one can find an illustrative example: For each biarc and interpolation based algorithm A andn∈N, an open polygon K with n vertices can be created and an ε can be chosen such that A needsO(n)segments but the SMAP algorithm needs only one segment for approximating K with a maximum tolerance of ε.Thus, we are interested in an arc spline approximation achieving the minimal number of segments subject to the following: The solution isG1-continuous and it stays inside a user-specified tolerance. Such a solution is called Smooth Minimum Arc Path (SMAP).The paper is organized as follows: In Section 2 we fix some basic definitions and notation needed in the main part, which deals with the two main tools used in this work: alternating sequences and feasible direction sets (cf. Sections 3 and 4). After the characterization of the so-called visibility set in Section 5 and the continuity properties of feasible directions in Section 6, we focus on n-visibility sets forn>1and finally the computation of a SMAP (cf. Sections 7 and 8). Finally, we address practical applications of the SMAP algorithm, and discuss possible extensions of the proposed method.An extensive treatise of this topic including all special cases and more detailed proofs can be found in Maier (2010). In contrast, this paper is of a comprehensive nature and is more comfortable to read: We made some assumptions which allow a simplification of the notation and the proofs, which is still general enough for most practical applications.For a setA⊂R2, ∂A denotes the boundary of A,A¯its closure andA∘its interior. The setK(A)is used for the set of all non-empty compact subsets of A. Bydist(A,B):=infx∈Ainfy∈B‖x−y‖we denote the Euclidean distance and use the abbreviationdist(x,A):=dist({x},A). Likewise, the Hausdorff metric is defined as follows:h(A,B):=max{supx∈Adist(x,B),supx∈Bdist(x,A)}.We will deal with planar curves which are simple, i.e. curves without any self-intersections. The image set, also called trace, of a curve ω is denoted bytr(ω)⊂R2. To simplify the notation we often identify ω withtr(ω). The order ontr(ω)induced by the orientation of ω is denoted by≺ωand[x,y]ω⊂ωis the subset ‘between’x∈ωandy∈ω. For the tangent unit vector, if it exists, at a pointa∈ω, we use the symbolτω(a).Definition 1A simple curve Γ inR2is called arc spline if its trace is a unionΓ=⋃i=1nAiof finitely many arcs or line segments. The minimally possible numbern∈Nfor the above condition is called segment number of Γ. We use the abbreviation|Γ|:=n. Arc splines γ with|γ|=1are simply called segments. Every segment γ has exactly one starting points(γ)and one endpointe(γ). An arc spline Γ is called smooth if it isG1-continuous, i.e.τΓ(x+)=τΓ(x−)for allx∈Γ.Let x and a be two distinct points in the plane and let v be a direction, i.e. a point of the unit sphereS1. Ifv≠x−a‖x−a‖, then there exists exactly one segmentγ:=γx,a,vwiths(γ)=x,e(γ)=aandτγ(a)=v.The proposed approach deals with an approximation up to a given tolerance, which can possibly vary locally. As described above we control the approximation error by considering only smooth arc splines staying inside the so-called tolerance channel, which is a closed polygon deduced from the input points and two designated edges. The width of this channel represents the user-specified maximum tolerance, which can vary locally as well. The canonical shape of a tolerance channel modeling a maximum error ε is given by the set of points which have an Euclidean distance to the open polygon running through the set of input points P of at most ε. Generally speaking, this ε-offset is a region formed from strips of width 2ε which are centered at the polygon edges. Thus, in a neighborhood of sharp corners this doesn't guarantee that the curve remains close to the given points. In Heimlich and Held (2008) however a method is introduced which avoids this problem and computes such tolerance channel in an efficient manner. Therefore, we do not deal with the generation of tolerance channels for a given point set and user-specified tolerance within this scope.Actually, tolerance channels can be formed by a much broader class of bounding curves, namely piecewise restricted analytic curves.11Restricted analytic curves are curves which have analytic extensions, i.e. developable as power series. See Maier (2010) for an exact definition.We focus on simple closed polygons, which is absolutely sufficient for most purposes. The term polygon is used to denote the union of both the boundary and the interior of the corresponding polygonal Jordan curve.Definition 2Let P be a simple closed polygon inR2. Furthermore, let s and d be two disjoint edges of P. Then(P,s,d)is called tolerance channel and a Smooth Minimum Arc Path (SMAP) is a smooth arc spline starting at s ending in d and staying in P with the minimal number of segments.An example of a point list, the corresponding tolerance channel for a user-specified tolerance and a resulting SMAP are illustrated in Fig. 1.Definition 3A pointa∈Pis said to be (circularly) visible (from s with respect to P) if there exists a segment γ in P withs(γ)∈sande(γ)=a. In this case γ is called visibility arc (for s and a). The set of all circularly visible points is denoted by V and the set of all visibility arcs is denoted byS. Furthermore, we define:S(a):={γ∈S|e(γ)=a}andS(a,v):={γ∈S(a)|τγ(a)=v}.Likewise,Vn⊂P,n>1, denotes the set of pointsa∈Psuch that there is an arc spline Γ in P with at most n segments,s(Γ)∈sande(Γ)=a. Then Γ is called visibility spline and the corresponding set is denoted bySn.In order to give an efficient mathematical characterization of the sets V andVnforn>1, alternating sequences and feasible direction sets are defined and various properties are examined. We are then able to give an equivalent condition whether a segment in P ending in a non-visible point can be touched by a visibility arc. The characterization of the set of all n-visible points follows by induction. Consequently, we work out characterizations of a SMAP and we present an approach for the computation of a solution based on alternating sequences. Since we can again proceed inductively, this leads to a constructive and iterative procedure, which will result in a greedy algorithm.Motivated by classical Chebyshev approximation theory (e.g. Braess, 1971), where sequences of alternating signs ±1 play an important role, we introduce alternating sequences: sequences of points a visibility arc γ and ∂P have in common. At these points, γ is alternately touched from the “left” and from the “right”.As a circle is uniquely determined by three distinct points, so one would intuitively say an arc has three degrees of freedom. Alternating sequences are used to fix these degrees of freedom defining a visibility arc. Whenever a segment in a tolerance channel is in an ‘extremal’ position, its ‘variability’ will be restricted by three alternating left and right restriction points.To keep the notation as simple as possible, we assume for the remaining part of this paper that the two vertices of s are convex, i.e. their interior angles are strictly smaller than π. The general case can be found in Maier (2010).We first define the compact subsetsL(γ)andR(γ)describing the part of ∂P which is left/right of γ. In fact,L(γ)andR(γ)are unions of finitely many edges sections of P:Definition 4Let γ be a visibility arc. Then we defineR(γ):={x∈∂P∖s|det(x−y,τγ(y))>0∀y∈γwithdist(γ,x)=‖x−y‖}¯.The setL(γ)is defined by using the opposite sign, i.e.det(x−y,τγ(y))<0.Definition 5Let γ be a visibility arc anda∈γ∩∂P. Then a is called right restriction point (of γ with respect to s) if one of the following conditions hold:i)a∈R(γ)∖{e(γ)},a=e(γ)and γ touchesR(γ)in a, i.e.a∈R(γ)andτγ(a)∈−T∂P(a), whereT∂P(a):=⋂ε>0{λ⋅(x−a)|λ⩾0,x∈∂P,‖x−a‖⩽ε}denotes the tangent cone of ∂P in a.a=s(γ)and ‘s is locally left of γ’, i.e. for allx∈swe havedet(x−y,τγ(y))⩽0whenever‖x−y‖=dist(γ,x).With the aid of left and right restrictions, alternating sequences can be defined as follows:Definition 6Letγ∈S. A finite sequence of points(ai)1⩽i⩽minγ∩∂Pis called alternating sequence (of γ) if it is increasing regarding the orientation of γ and eachaiis a restriction point of γ,1⩽i⩽m.The set of all alternating sequences is denoted byA(γ)and for every(ai)1⩽i⩽m∈A(γ)we can define the numbersσi:={1ifaiis a right restriction point,−1ifaiis a left restriction point,1⩽i⩽m,andεi:=ε(σi):={1ifσiσi+1=−1,0otherwise,1⩽i⩽m−1.Hence the alternating number of(ai)1⩽i⩽misA((ai)1⩽i⩽m):=1+∑i=1m−1εi. We say(ai)1⩽i⩽mis of length k ifA((ai)1⩽i⩽m)=k. Accordingly, we obtain the alternating number of γ:A(γ):=max(ai)i∈A(γ)A((ai)i),whereA(γ)is set to 0 ifA(γ)is empty.The numberA(γ)is well-defined sinceA(γ)is finite for allγ∈Sasγ∩∂Kis homeomorphic to a disjoint union of finitely many intervals and points inR.As an example, the alternating sequence(ai)1⩽i⩽6depicted in Fig. 3has three left restriction pointsa1,a2,a6and three right restriction pointsa3,a4anda5. Thus, we obtainε1=ε3=ε4=0,ε2=ε5=1and the alternating number of(ai)1⩽i⩽6is1+∑i=15εi=3. Since this sequence contains all left and right restriction points of γ, we haveA(γ)=3.The degrees of freedom of visibility arcs are consistent with their alternating number. In particular, we will show the following:•For fixeda∈Vand end direction v we can always choose a visibility arcγ∈S(a,v)withA(γ)⩾1since there is one degree of freedom.For fixeda∈Vthere exists aγ∈S(a)withA(γ)⩾2.Fora∈∂V∖∂Pthere exists even a visibility arc γ withA(γ)⩾3.Regarding the first claim, let us choose a visibility arcγ∈S(a)andv:=τγ(a). Then we prove that there are always visibility arcsγlandγrhaving a left and right restriction respectively.Proposition 1Letγ0∈S(a,v)for somea∈Vandv∈S1. Then there existγ1,γ2∈S(a,v)having a left or a right restriction, respectively.ProofIt suffices to show the existence ofγ1∈S(a,v)supplying a left restriction. Ifγl:=γx,a,v⊂Pis contained in P, wherex∈sis the left end point of s orγltouches s in x from the right, we are done since x is then a left restriction point. Likewise, ifγ0already has a left restriction. Hence we can assume that the setX:={x∈[s(γl),s(γ0)]⊂s|dist(γx,a,v,L(γ0))>0}is not empty. Obviously, X is bounded below and we can setγ1:=γx0,a,vwithx0:=inf(X)∈s. Due to continuity reasons one can show thatγ1∈S(a,v)and thatγ1has a left restriction.  □In this section we are interested in all the exiting directionsτγ(a)of these visibility arcs γ withe(γ)=asince we later want to compose segments in a smooth manner: The ending direction of the predecessor segment will have to equal the starting direction of the successor segment.For this purpose, we first introduce the set of all feasible exiting directions of corresponding visibility arcs ending in the same circularly visible point:Definition 7For everya∈V∖sthe setT(a):={v|∃γ∈S(a)withv=τγ(a)}is called feasible direction set of a. We setT(a):=∅for alla∈s.Note thatT(a)is closely related to tangent cones of visibility arcs ending in a. Due to more convenient formulations in the sequel, we prefer the notation introduced in Definition 7.The properties of the feasible direction sets of the circularly visible points allow efficient characterizations of the setsS(a). First we can show:Proposition 2For everya∈V∖sthe settr(S(a)):={tr(γ)⊂R2|γ∈S(a)}is closed with respect to the Hausdorff metric.ProofLet(An)n∈Nbe a convergent sequence intr(S(a))withA:=limn→∞An. Then A is a compact subset of P which is either a point or the trace of some segment γ. Sincea∈Aands∩A≠∅, A cannot be a single point. Thus, A is the trace of a segment γ withs(γ)∈s,e(γ)=aandγ⊂P. Therefore, we haveγ∈S(a), which completes the proof.  □Lemma 3The feasible direction setT(a)⊂S1is compact for everya∈V.ProofIt is sufficient to consider a pointa∈V∖ssinceT(a)=∅for alla∈s. LetEa:={(x,v)∈s×S1|v≠x−a‖x−a‖,γx,a,v∈S(a)}be the subset of all feasible pairs of starting points and exiting directions in a. In order to show thatEais closed ins×S1, let(xn,vn)n∈Nbe an arbitrary sequence inEa. According to Proposition 2, the trace settr(S(a))is closed with respect to the Hausdorff metric. Hence the sequence(tr(γxn,a,vn))n∈Nconverges to sometr(γx,a,v)withγx,a,v∈S(a)and we obtain(x,v)∈Eaby construction ofEa. Clearly, we havex=limn→∞xnandv=limn→∞vn. Therefore,Ea⊂s×S1is closed and thus compact sinces×S1is compact. As the canonical projectionπ2:s×S1→S1is continuous, we obtainT(a)={v∈S1|∃x∈s:γx,a,v∈S(a)}=π2(Ea)is compact as well.  □To examine further properties, we focus on special exiting directions, to be called ‘extremal’ ones in the following way:Definition 8Leta∈Vandv∈T(a). We call v left (right) extremal inT(a)if there exists a neighborhood U of v inT(a)withdet(v,w)⩽0(det(v,w)⩾0)for everyw∈U. A visibility arcγ∈S(a)is called left/right extremal ifτγ(a)is left/right extremal inT(a).It is not hard to see thatT(a)is locally connected and thus the boundary points∂T(a)are left or right extremal. For the sake of brevity we simply call them extremal. If we consider a left (right) extremal exiting direction v ofa∈V, then no visibility arcγ∈S(a)with a directionτγ(a)that is to the left (right) of v in a suitable small neighborhood exists.We will merge the two concepts ‘alternating sequences’ and ‘feasible direction sets’ in the following. In the previous section we have seen that for fixeda∈Vandv∈T(a)one can always choose a visibility arc γ withA(γ)⩾1. We now show that we even getA(γ)⩾2in case of an extremal directionv∈T(a). As already indicated, alternating sequences are used to characterize the three degrees of freedom that visibility arcs possess. Fixing two degrees and ‘driving one into an extremal position’, we obtain an alternating number of at least 1. If only the endpoint is fixed, we have two degrees of freedom that can be modified until they are in an extremal situation. Hence we obtain an alternating numberA(γ)⩾2.Proposition 4Fora∈Vletv∈T(a)be left [right] extremal. Then there exists aγ∈S(a,v)having a right [left] restriction.ProofThe mapping(x,a,v)↦tr(γx,a,v)is continuous and the functionK(R2)→R,A↦dist(A,B)is upper semi-continuous for everyB∈K(R2)(cf. Braess, 1986). SettingB:=L(γ)for a visibility arc γ, we can easily deduce the claimed.  □Theorem 5Leta∈Vandv∈∂T(a). Then there exist exactly one visibility arcγ∈S(a,v)and a corresponding alternating sequence(a1,a2)of length 2 so thata2is a right (left) restriction point if v is left (right) extremal. In particular, we haveA(γ)⩾2.ProofLet v be left extremal. By Proposition 1 there exists a visibility arcγ∈S(a,v)having a right restriction. LetXrdenote the set of all right restriction points of γ. SinceXris compact and not empty, we can setxr:=maxXrwith respect to the orientation of γ. Ifxr=a, γ touches ∂P in a with direction v. In this case a is a right restriction point of every visibility arc inS(a,v)and Proposition 1 allows choosing γ with an additional left restriction. Otherwise, there exists a pointb∈γbetween a andxrand a small neighborhood of b being included in P. Let us split γ at b into two segmentsγ1andγ2. Ifγ1would have no left restriction, a visibility arcη:=γx,b,w∈S(b)could be constructed with x being left ofs(γ1)and w being right ofτγ1(b). Some possible tedious manipulation yields that η can be continued so that it ends in a and stays inside P. Then however it can be shown thatτη(a)is left of v, a contradiction.For the proof of the uniqueness letγ1,γ2∈S(a,v)and let(a1,a2)be an alternating sequence ofγ1of length 2. Then we haveγ2∩[a1,a2]γ1≠∅and thus we can easily conclude thatγ1andγ2have at least two points and the exiting direction in common. Hence they are equal.The argumentation proceeds similarly if v is right extremal.  □Note that the converse of the claim in the theorem above is not true in general. It is not hard to prove that this is equivalent toT(a)=S1. Furthermore, it is easy to see thatT(a)=S1implies that a is not on the boundary of V. At least the following can be shown:Lemma 6Leta∈Vandv∈T(a)≠S1. If a visibility arcγ∈S(a,v)has an alternating sequence(a1,a2)of length 2 with a right [left] restriction pointa2, then v is left [right] extremal.ProofIt is sufficient to consider a visibility arcγ∈S(a,v)with an alternating sequence(a1,a2)of length 2, wherea2is a right restriction point. Let us assume that γ is not left extremal. Then for every neighborhood U of v there exists a directionw∈Usuch thatw∈T(a),det(v,w)>0, and we can choose aγw∈S(a,w)so that[x,a]γwis right of γ for somex∈γw. It can then be shown thatγw∩[a2,a[γis not empty whenever‖v−w‖is sufficiently small since{s(η)∈s|η∈S(a,w)}is connected. However, we have[s(γ),a2[γ∩γw≠∅. Consequently, γ andγwhave at least three points in common, and we haveγ=γ2, a contradiction.  □The characterization of left and right extremal directions of the feasible direction sets by alternating sequences enables the examination of further properties ofT(a):Proposition 7Leta∈V∖sand letT(a)≠S1. ThenT(a)contains exactly one left and one right extremal direction.ProofObviously,T(a)is not empty. It is sufficient to show the existence and uniqueness of a left extremal direction. The existence follows from the local connectivity and compactness ofT(a)(cf. Lemma 3). For the proof of the uniqueness letv1andv2be two left extremal directions. Then by Theorem 5 we can choose visibility arcsγi∈S(vi)and alternating sequences(a1(i),a2(i))of length 2 with right restriction pointsa2(i)fori=1,2. It follows thatγ1andγ2have at least three distinct points in common, which means that they are equal. Hencev1=v2.  □SinceT(a)is locally connected, Proposition 7 yields the following:Corollary 8The feasible direction setT(a)is connected for everya∈V.Obviously, an exiting directionv∈T(a)is left and right extremal if and only if it is an isolated point ofT(a). Hence by Corollary 8 we obtain:Corollary 9A directionv∈T(a)is left and right extremal if and only ifT(a)={v}.For continuity reasons we obtain:Corollary 10Leta∈Vandv∈T(a)∘withT(a)≠S1. Then there exists a visibility arcγ∈S(a,v)having neither a left nor a right restriction.With the aid of the two instruments alternating sequences and feasible directions sets we are able to characterize the set V: In the previous sections we have seen that we can choose visibility arcs γ withA(γ)⩾1for a fixed endpointa∈Vand exiting directionv∈T(a). If v is extremal, we can even require an alternating number of at least two as two of the three degrees of freedom have been driven to an extremal position. Visibility arcs ending in a point of the boundary of V with respect to the relative topology on P are called blocking arcs. We will prove that blocking arcs have at least three alternating restrictions. This allows us to describe them in an efficient manner and to enable a constructive approach in view of developing an algorithm. We will focus on one special blocking arc, namely the window, which is the one being ‘nearest’ to the destination segment d.Lemma 11Fora∈Vwithcard(T(a))=1we havecard(S(a))=1.AsT(a)≠S1, we haveN:=card(S(a))∈{1,∞}. Let us assumeN=∞. For continuity reasons then there is aγ∈S(a)without any restriction point. By Theorem 5v:=τγ(a)is not an extremal direction, a contradiction since∂T(a)=T(a). Thus,N=1.  □A visibility arcγ∈Sis called right-blocking if the points to its right hand side are not visible in neighborhood, i.e.: There exist a pointa∈γ∩P∘and a neighborhood U of a withUr∩V=∅, whereUr:={x∈U|det(x−y,τγ(y))>0∀y∈γwith‖x−y‖=dist(x,γ)}.The term left-blocking andUlare defined analogously. We simply call γ blocking if it is left- or right-blocking.Obviously, the blocking arcs are exactly the visibility arcs γ containing boundary pointsa∈∂V∖∂P. We will show that these segments are exactly the segments supplying alternating sequences of length 3 and examine how the terms right- and left-blocking relate to specific alternating sequences.Theorem 12Fora∈V∖∂Pandγ∈S(a)the following is equivalent:1)a∈∂V,T(a)is a singleton, i.e.card(T(a))=1,S(a)={γ}andA(γ)⩾3,γ is a blocking arc.The implication ‘1)⇒2)’ is shown as follows: Trivially,T(a)is not empty, i.e. it contains at least one feasible direction. Ifcard(T(a))>1, we can choose a direction v from the interior ofT(a)sinceT(a)is connected (cf. Corollary 8), Hence there is aγ∈S(a,v)having neither a right nor a left restriction (cf. Corollary 10). For continuity reasons we obtain a whole neighborhood U that is visible, i.e.U⊂V, a contradiction to a being on the boundary of V.Next we consider the implication ‘2)⇒3)’: Sincea∉∂P, the setS(a,v)=S(a)is a singleton by Lemma 11. The unique corresponding visibility arc γ is left and right extremal since v is left and right extremal. Hence we have alternating sequences(a1,a2)and(a3,a4)of γ of length 2, wherea2is a right restriction anda4is a left restriction point, and we obtain an alternating sequence(ai1,ai2,ai3)of length 3 withij∈{1,…,4}, i.e.A(γ)⩾3.In order to show the implication ‘3)⇒4)’, let(a1,a2,a3)be an alternating sequence of γ of length 3 where we assume thata3is a right restriction point. If we denote the connected component ofP∘∖[a2,a3]γnot containing s by C, we can choose a pointx0∈]a3,e(γ)[∩Cand a neighborhood U ofx0included in C. By construction every visibility arcγxof a pointx∈Uhas to cross[a2,a3]γat somes1(x). According to Lemma 6,τγ(s1(x))∈T(s1(x))is right-extremal. Henceγxis locally left to γ ins1(x). Supposingx∈Ur,γxis locally right to γ in x and there must be an intersections2(x)∈]a3,e(γ)]γ∩γxwithτγx(s2(x))right toτγ(s2(x)). But again by Lemma 6τγ(s2(x))∈T(s2(x))is right-extremal, a contradiction.Eventually, the implication ‘4)⇒1)’ follows directly from the definition of a blocking arc.  □The terms ‘right-blocking’ and ‘left-blocking’ are not mutually exclusive: A visibility arc γ is left- and right-blocking if and only ifA(γ)⩾4. In any case, there are finitely many blocking arcsγ1,…,γndescribing the boundary of V, i.e.∂V∖∂P⊂⋃i=1mγi.Exactly one blocking arc corresponds to each connected component ofP∖V. Of course, we are especially interested in the connected component containing the destination d. The corresponding blocking arc is called window:Definition 10LetV∩d=∅, and letC⁎denote the connected component ofP∖Vcontaining d. Then the blocking arc ω which is uniquely determined by the set inclusionC⁎¯∩V⊂ωis called window.To keep the exposition as simple as possible and to avoid special cases let us assume for the rest of the paper that each blocking arc has an alternating number of exactly three. A more general treatise can be found in Maier (2010). In particular, we assume that ω has a unique alternating sequence(a1,a2,a3)of length three. Then we can define another useful term:Definition 11The subsetV˜⊂Vis the closure of the connected component ofV∖[a2,e(ω)]ωwhich does not contain s.It is not hard to prove thatV˜is compact. An illustration can be found in Fig. 4.The local property ‘left’ and ‘right’ in the definition of alternating sequences can be replaced by a global one in the case of the window. The alternating restrictions defining the window are described due to the left and right channelPlandPr: The counterclockwise polygonal path of P frome(s)tos(d)is denoted byPr. Analogously,Plis the clockwise polygonal path froms(s)toe(d)(cf. Fig. 4).Theorem 13There are pointsa1,a2,a3,a4:=e(ω)of ω such that(ai)1⩽i⩽3is an alternating sequence of length three andi)eithera2,a4∈Planda3∈Prora2,a4∈Pranda3∈Pl.ProofLet ω be right-blocking. By definition we can choose an alternating sequencea1,a2,a3witha3∈Pranda4:=e(ω)∈Pl. Hence we haveL(ω)⊂PlandR(ω)⊂Prand thereforea2∈Pl(cf. Definition 4).On the one hand, only the connected componentC⁎containing d satisfiesPl∩C⁎≠∅≠Pr∩C⁎. On the other hand, we haveC⁎¯∩V⊂ω. Thus, also the addendum follows.  □We have discussed the properties of V on the assumption that d is not circularly visible. The development of the blocking arcs and the window are crucial for this purpose. If we consider d and V not to be disjoint, the term ‘window’ is not generally well-defined any longer. However, we have the following property:Lemma 14IfV∩d≠∅, there exists a visibility arc γ ending in d and pointsa1,a2,a3on γ so that one of the following conditions hold:1)(a1,a2,a3)is an alternating sequence of length 3.(a1,a2)is an alternating sequence of length 2 anda3=e(γ)is an endpoint of d.ProofIf an endpoint a of d is visible, we can choose av∈∂T(a)since obviouslyT(a)≠S1. Hence by Theorem 5 there is a visibility arcγ∈S(a,v)withA(γ)⩾2. Otherwise,V∩dis a line segment and a visibility arc γ ending in an endpoint of this line segment has to be a blocking arc. Therefore, we obtain by Theorem 12:A(γ)⩾3.  □In order to characterize the n-visibility setVnwithn>1, we first have to work out the behavior of the feasible direction sets when the corresponding points are varied. Our idea will be to use the intermediate value theorem in order to give an equivalent condition whether a segment can be joined with a predecessor visibility arc.In order to examine the continuity properties of the feasible direction sets, it is useful to consider T as a mapping that assigns its feasible direction set to every circularly visible point:T:V∖s→K(S1),a↦T(a).T(a)is not empty for alla∈V∖sand compact by Lemma 3. Thus, T is well-defined. Let us now establish its continuity properties: First we show the upper semi-continuity, which is comparatively easy to prove. We will see later on that T is not lower semi-continuous on V but on the subsetV˜∖∂P. For the verification of the lower semi-continuity we will need more technical effort. However, we first show:Lemma 15T is upper semi-continuous.ProofSinceV×S1is compact andV∖sis locally compact, it is sufficient to show that for every compact subsetK⊂V∖sthe setgraph(T|K):={(a,v)∈K×S1|v∈T(a)}is closed (cf. Aubin and Frankowska, 1990, Prop. 1.4.12). Let(an,vn)n∈Nbe a sequence ingraph(T|K)converging to a pair(a,v)witha∈Ksince K is compact. Forn∈Nwe can choose a visibility arcγn∈S(an,vn). By passing to a subsequence if necessary, we can assume that(tr(γn))n∈Nconverges totr(γ)due to Proposition 2. Even more we obtainτγ(a)=vbecause of the convergence of(tr(γn))n∈Nsinceγnis a segment. However, this meansγ∈S(a,v), and hence we have(a,v)∈graph(T|K), which completes the proof.  □Since we need the lower semi-continuity just for a subset of V, we focus on the setV˜. Dealing with the whole set of circularly visible points would be somewhat clumsy. We will show that the mapping T is lower semi-continuous at all points ofV˜except the vertices of P. For this purpose, we distinguish between three cases: First we focus on pointsa∈V˜∖∂Pand interior directionsv∈T(a)∘. Next, we take smooth points on the boundary∂P∩V˜and interior directions into account. Eventually, the enhancement to boundary directions can be deduced by a ‘diagonal trick’.Lemma 16For everya∈V˜∖∂Pandv∈T(a)∘we obtain: For allε>0there exists aδ>0such that for allx∈Vwith‖x−a‖<δthere is a feasible directionw∈T(x)with‖v−w‖<ε.ProofBy Corollary 10 there exists a visibility arcγ0∈S(a,v)having neither a left nor a right restriction since v is not an extremal direction. Thus, there exists aδ>0withS(x,v)≠∅and hencev∈T(x)for allx∈Vwith‖x−a‖<δ.  □Proposition 17Leta∈V˜∩∂Pnot be a vertex of P andv∈T(a)∘an interior direction. Then for allε>0there exists a neighborhood U of a such that for allx∈U∩Pthere is a directionvx∈T(x)with‖v−vx‖<ε.ProofWe only give a short sketch of the proof. The full argumentation can again be found in Maier (2010). Since a is not a vertex of P, the tangent cone on P is the half-plane defined by the corresponding edge of P for all points in a sufficiently small neighborhood of a in ∂P. The idea now is to slightly extend the given tolerance channel so that the boundary pointa∈∂Pwill become an interior point of the extended channel and use the results from Lemma 16: Consider the canonical extensionP˜:=P∪Bδ(a)of P for a suitable δ, whereBδ(a)denotes the compact square with center a and edge length δ. Obviously, a is an interior point of the visibility set with respect toP˜and v is a corresponding interior direction. Applying Lemma 16 yields the existence of a neighborhoodU˜of a such that for allx∈U˜there is a feasible directionvxinx∈P˜with‖v−vx‖sufficiently small. Consequently, it can be shown that for allx∈U:=U˜∩Vthe directionvxis contained inT(x), thus completing the proof.  □Lemma 18T is lower semi-continuous onV˜∖∂Pand at all smooth points ofV˜∩∂P.ProofChoosea∈V˜which is not a vertex of P andv∈T(a). Let(an)n∈Nbe a sequence in V convergent to a andε>0. SinceT(a)is connected, either its interior is not empty orT(a)is a singleton. Ifv∈T(a)∘, we obtain by Lemma 16 and Proposition 17 that there exists avn∈T(an)with‖v−vn‖<εwhenevern>Nfor someN∈N. Let us now focus on a boundary directionv∈∂T(a)withT(a)∘≠∅. SinceT(a)has no isolated points by Corollary 8, we can deduce the existence of aw∈T(a)∘with‖w−v‖<ε2. As above, we obtain directionsvn∈T(an)with‖w−vn‖<ε2whenevern>Nfor someN∈N. Thus, we have‖vn−v‖=‖(vn−w)+(w−v)‖⩽‖vn−w‖+‖w−v‖<ε2+ε2=ε,which completes the proof in the case ofT(a)not being a singleton.LetT(a)now be a singleton, for instanceT(a):={v}. Considering an arbitraryε>0and a sequence(an)n∈Nin V convergent to a, there exists a boundN∈Nso thatT(an)⊂{w∈S1|‖v−w‖<ε}for alln⩾Nsince T is upper semi-continuous at a (cf. Lemma 15). In particular, we can choose avn∈T(an)with‖v−vn‖<εfor alln⩾N. Hence we obtain a sequence(vn)n∈Nconverging to v and we have shown the lower semi-continuity at points whose direction set is a singleton as well.  □Altogether, we obtain directly:Corollary 19T is continuous onV˜except the vertices of P.In Fig. 5the direction sets of some circularly visible points are depicted to outline the continuity attitudes of the mapping T. Note that the direction set at a vertex can abruptly increase but not abruptly shrink when approaching the vertex since T is at least upper semi-continuous. Furthermore, it is illustrated thatT(x)is steadily getting smaller when approaching the boundary of V and on ∂V it is just a singleton (cf. Theorem 12).We now give a characterization of the n-visibility setVn, the set of all points that can be reached by a smooth arc spline with n segments,n>1. First, we focus on the setV2and then proceed inductively. Unfortunately, the setV2∖Vis not simply the set of all end pointsa∈Pof visibility splines with two segments of which the first segment is a restriction of the corresponding blocking.In order to characterizeV2, we examine conditions whether for an arbitrary segment γ in P there is a visibility arc which γ can be smoothly joined with. The properties of the mapping T worked out previously are used for this purpose. It will turn out thatV2can be computed by examining tolerance channels with a more sophisticated starting condition, the so-called continuation condition. For simplicity we focus on the examination of the connected componentC⁎ofP∖V(cf. Definition 10) leading to d.First we present a lemma proved by homotopy techniques. By combining this lemma with the continuity properties of the feasible direction sets, we give an equivalent condition for when a segment γ within P can be smoothly joined to a visibility arc of(P,s,d). The idea is stated as follows: Considering two pointsx1andx2of γ where the tangent unit vectorτγ(x1)is ‘left’ ofT(x1)andτγ(x2)is ‘right’ ofT(x2), there must be a pointx∈γbetweenx1andx2withτγ(x)∈T(x)by the intermediate value theorem. Hence there exists a visibility arc smoothly joined to γ. In particular,e(γ)∈V2.Definition 12A segment γ satisfies the continuation condition (CC) with respect to a segment η if one of the following conditions hold:i)There is a pointx∈γ∩ηwithτγ(x)=τη(x)orthere are two intersection pointsx1,x2of γ and η so that the order induced by γ and the one induced by η are equal:x1≺γx2andx1≺ηx2.Letγ2be a segment in P withe(γ2)=a∈C⁎, and suppose thatγ1∈S(x0)for somex0∈[x1,x2]γ2withτγ1(x0)=±τγ2(x0), where{x1,x2}=ω∩γ2withx1≺ωx2. Furthermore, suppose there existy1,y2∈γ1∩ωwhich satisfy one of the following two propertiesi)y1≺ωy2andy1≺γ1y2ory1=y2andτγ1(y1)=τω(y1).ProofLetw:[0,1]→R2be a parametrization ofγ2betweenx2andx0with‖w′(t)‖constant,w(0)=x2andw(1)=x0. For everyλ∈[0,1]we define a segmentγ(λ)withs(γ(λ))=y1ande(γ(λ))=w(λ)and additionally:y2∈γ(λ)orτγ(λ)(y1)=τω(y1)ify1=y2. SettingX(λ):=Cλ∩γ2andCλ:=C(γ(λ)), whereC(γ)denotes the supporting circle or line corresponding to a segment γ, it can be shown that1)C0=C(ω)andC1=C(γ1).The mapping[0,1]→K(R2),λ↦tr(γ(λ))is continuous.card(X(λ))=2for everyλ<1andcard(X(1))=1.Let us use the abbreviationx2(λ):=e(γ(λ))and letx2(λ)be the uniquely determined point contained inX(λ)withx1(λ)≠x2(λ),λ∈[0,1[. Consequently, for everyλ∈[0,1[andi∈{1,2}there exist uniquely determined parametersti(λ),si(λ)∈[0,1]withwλ(ti(λ))=xi(λ)andw˜(si(λ))=xi(λ), wherewλis a parametrization ofγ(λ)with constant‖wλ′(t)‖≠0andw˜is a parametrization ofγ2betweenx1andx2with constant‖w˜′(t)‖≠0,w˜(0)=x1andw˜(1)=x2. Obviously, we can conclude:t1(λ)<t2(λ)=1ands1(λ)<s2(λ). Therefore, the mappingsτ1:[0,1]→[0,1],λ↦{t1(λ)+12⋅(t2(λ)−t1(λ)),0⩽λ<1t0,λ=1andτ2:[0,1]→[0,1],λ↦{s1(λ)+12⋅(s2(λ)−s1(λ)),0⩽λ<1t0,λ=1are continuous. Since the parametrizationswλandw˜are regular, the mappingsf1:[0,1]→R2,f1(λ):=ddtwλ(τ1(λ))‖ddtwλ(τ1(λ))‖andf2:[0,1]→R2,f2(λ):=ddtw˜(τ2(λ))‖ddtw˜(τ2(λ))‖are well-defined and continuous. By an easy geometric observation (see Fig. 6) we havef1(λ)=x2(λ)−x1(λ)‖x2(λ)−x1(λ)‖=f2(λ)for allλ<1. Thus,f1andf2are equal on the dense subset[0,1[⊂[0,1]and therefore, we getf1=f2since they are continuous. In particular, we obtain:τγ1(x0)=f1(1)=f2(1)=ddtw˜(t0).Altogether, these results yield the following: The orientation oftr(w˜)induced byτγ1(x0)equals the orientation onw˜and therefore it is equal to the orientation of ω as well. I.e. we havex1≺x2with respect toτγ1(x0). From this we can easily deduce both implications of the assertion.  □Theorem 21Leta∈C⁎. Thena∈V2if and only if there exists a segment γ inV∪C⁎ending in a and satisfying the CC with respect to the window ω. We can even choose a visibility spline whose first segmentγ1is extremal, i.e.A(γ1)⩾2ore(γ1)is a vertex of P andA(γ1)⩾1.ProofLeta∈V2∩C⁎. Then there is a visibility spline with two segmentsγ1andγ2in P ending in a. Ifγ1⊂ω, we are done. Otherwise, there are two intersectionsx1,x2between the circles corresponding to ω andγ2. Let these points be ordered regarding ω. Some rather technical argumentation, based on an alternating sequence of ω of length 3, curvature reasons and the Homotopy-Lemma 20, shows thatx1≺γ˜2x2, whereγ˜2is an extension ofγ2, which ends in a and contains bothx1andx2. Therefore,γ˜2satisfies the CC with respect to ω.Asx1does not necessarily lie onγ2but onγ˜2, it remains to show that[x1,x2]γ˜2is included in V. For this purpose, lety∈[x1,x2]γ˜2. Theny∈Pas otherwise one could construct a Jordan curve moving around y. Since ∂P is simply connected, the constructed loop is contractible, which would contradict the assumption thaty∈R2∖P. After some tedious argumentation we can even assumey≻γ˜2x0, wherex0∈Vdenotes the breakpoint ofγ1andγ2. Thus, we havey∈V2and obviously,y∉C. Ify∈V2∖V, y would be contained in another connected component corresponding to a blocking arc η. However, the orientations induced by η andγ˜2on the two intersection pointsx˜1,x˜2∈η∩γ2would then not be identical, which is contradictory to the Homotopy-Lemma 20. Altogether, we obtain the first implication.In order to show the other implication letγ2be a segment in P ending ina∈V∪C. Again letC=C⁎be the component including d. Then we can assume pointsx1,x2∈ω∩C(γ2)withx1≺γ2x2,x1≺ωx2and[x1,x2]γ2⊂Vsince the casex1=x2is obvious. Because of these orientation properties, we can assumedet(τγ2(x1),τω(x1))>0anddet(τγ2(x2),τω(x2))<0.LetX⊂V˜∩∂Pdenote the subset of all vertices which are passed through byγ2inV˜betweenx1andx2. If there is a pointx0∈Xand a feasible directionv∈T(x0)withdet(τγ2(x0),v)=0, we are done. Otherwise, we have to distinguish between two cases:Firstly, supposedet(τγ2(x1),v)>0for allv∈T(x1). Because of the continuity properties of T (cf. Corollary 19), after possible diminution of[x1,x2]γ2, we can assume X to be empty anddet(τγ2(x1),v)>0anddet(τγ2(x2),w)<0for allv∈T(x1)andw∈T(x2).Then the mappingl:[x1,x2]γ2→R2,x↦l(x)is a continuous selection of the set-valued mappingT|[x1,x2]γ2, wherel(x)denotes the left extremal direction ofT(x). The mappingf(x):=det(τγ2(x),l(x))is continuous. By the intermediate value theorem we thus obtain a pointx0onγ2betweenx1andx2withf(x0)=0sincef(x1)<0andf(x2)>0. Therefore, again the Homotopy-Lemma 20 yields:τγ2(x0)=l(x0)∈∂T(x0).Let us now consider the other case: If there is a directionv∈T(x1)withdet(τγ2(x1),v)⩽0, there exists av∈T(x1)withdet(τγ2(x1),v)=0, i.e.τγ2(x1)=±vsinceT(x1)is connected. By the Homotopy-Lemma we haveτγ2(x1)∈T(x1). Wlog we can assume that ω has exactly three alternating restriction points(a1,a2,a3). Ifx1equalsa2, the claimed is shown. Otherwise, ‘x1≻ωa2’, and it can be shown thatv1:=τω(x1)is an extremal direction. Hence we can put this case back to the situation above.Altogether, we have shown that there is a pointx0∈Vonγ2withx0∈T(x0)wherex0is a vertex of P orτγ2(x0)is an extremal direction. Consequently, Theorem 5 and Proposition 1 yielda∈V2and the addendum as well.  □In this case we can even choose a segment γ that is extremal, i.e. having at least two alternating restrictions, which is fundamental for a constructive approach and hence for the algorithmic design.We are now able to characterize the setC⁎and analogously the whole setV2. In particular, we have thata∈C⁎if and only if there exists a visibility arc γ in P, ending in a and satisfying the CC with respect to the window ω ofV1=V. Therefore, characterizingV2means to use a ‘modified’ tolerance channel with the corresponding window ω as starting segment instead of s. The only differences to the kind of tolerance channels we have seen till now are the more complicated starting requirements, namely the CC regarding ω. Using the abbreviationE:=(P,s,d)we denote this “modified” tolerance channel byE2and call it continuation channel. Consequently, for a pointa∈Pwe havea∈V2if and only if a is in the visibility set ofE2.As the CC shows certain continuity conditions it can be proved that the results presented in the preceding sections hold for continuation channels as well. The arguments are essentially the same. Only the details are more intricate, which are explicated at full length in Maier (2010). Especially, the window and blocking arcs ofV2are characterized in the same manner. Recall that touching the start segment, which is here the window of V, is a left or right restriction point.We confined ourselves to the case that the window ω has exactly three alternating restriction points. Hence we can use the introduced Connection-Theorems inductively and exploit the properties of the setsVnwhen successively dealing with the continuation channelsEn, which can be defined analogously toE2. This yields a constructive method for computing a SMAP: The outcome is a greedy algorithm, which will be discussed in the next section.By iteratively exploiting Theorem 21 we can compute a SMAP as follows: We traverse P from s to d in a forward step and back again from d to s in the backward step.The forward step: Firstly, we compute the windowω1:=ωand corresponding blocking arcs of V by identifying segments with three alternating restrictions. Next, the windowω2and the blocking arcs ofE2are computed such that the conditions of Theorem 21 and Theorem 13 are satisfied. In particular,ω2has to satisfy the CC with respect toω1. The condition[x1,x2]ω2⊂Vin case of{x1,x2}=ω1∩ω2can be checked by taking the blocking arcs into account. We can proceed this way, i.e. computeωiand the blocking arcs inEi,i=3,4,…,k. The procedure is stopped when a point of d is circularly visible, and a visibility arc satisfying Theorem 21 and ending in d is computed. As it can be seen in Fig. 7, the windows do not represent a smooth arc spline. However, the computed windows are used in the backward step to generate a SMAP.The backward step: The final segmentωkrepresents the last segment of the resulting SMAP. In particular, the minimum segment number is k. Since Theorem 21 is an equivalence, we can be sure that the predecessor segments can then be determined by touching their successor and by two alternating restrictions. The whole procedure is finished when s has been reached. After possibly restricting the particular segments we obtain a SMAP. Consequently, a SMAP can be computed in an iterative way.In the second row of Fig. 7 the backward step is visualized as well. The dotted segments indicate the windowsωiwhich the SMAP segmentsγihave to satisfy the CC with. Algorithm 1summarizes the approach in pseudo code form.Clearly, the determination of the several windows and blocking arcs is a crucial part of the forward step as well as the computation of the SMAP segments during the backward step. Of course, the characterization by alternating sequences plays an important role for this purpose. A segment with three alternating restrictions can be found by discovering triples(c1,c2,c3), whereciis a vertex or an edge of P or the start segment, a predecessor blocking arc or the predecessor window. Computing a circle being tangent to each of them leads to the well known Apollonius Problem (up to eight possible solutions). The general problem is, in principle, solvable by straightedge and compass alone and can be quite easily computed (cf. Maier, 2010). Satisfying the starting condition (e.g. the CC) and staying inside P is not difficult to check. For ensuring that a segment stays inEiin the case ofi>1, one has to additionally consider the predecessor blocking arcs. The segments in the backward step can be found analogously since they have two alternating restrictions and touch their successor segments which obviously corresponds to a line or a circle.From a run time complexity point of view this proceeding is not very efficient. However, for many off-line applications this approach is sufficient. An efficient and more detailed algorithmic description can be found in Maier (2010), where a worst case complexity ofO(n2)could be shown for polygons P with n vertices. The proposed implementation uses so-called Circular Visibility Diagrams, which were introduced in Chou and Woo (1995).We have presented a method for approximating polygonal input data by a smooth arc spline with the minimal number of segments while not exceeding a user-specified tolerance. In particular, we focused on the mathematical characterization of corresponding solutions, i.e. the properties of a SMAP and its segments. The main tools for this purpose were alternating sequences and feasible direction sets. The former are used for the algorithmic design as well. This approach enables an iterative algorithm which generates the breakpoints of the solution curve automatically.Thus, the SMAP algorithm ensures the (real) minimality of segments which results in a compact representation and allows an efficient further processing. This is decisive for numerous applications. Most important, a minimum number of segments provides a considerably faster computation of point-to-curve distances. Among applications like reverse engineering of planar working pieces (cf. Maier and Schindler, 2011) and the vectorization of pixel graphics (cf. Maier et al., 2012), the SMAP methodology therefore turned out to be very suited for the generation of digital maps of high precision: On behalf of the Ko-FAS research initiative (cf. Ko-fas, http://www.ko-fas.de), a vehicle equipped with a highly accurate sensor system records measuring points on road markings. After reconstructing the extracted points in world coordinates for each marking a tolerance channel is build with an appropriate accuracy (in the magnitude of 0.1 m) and the SMAP algorithm is applied. Regarding the resulting data volume for storage and the efficiency of map calculations the outcome is far superior to digital maps generated by state of the art approaches (cf. Schindler et al., 2012; Brummer et al., 2013).Fig. 8shows a tolerance channel representing a maximum error of 0.5 m and a corresponding SMAP (for visualization reasons the threshold is comparatively big). This example is a small extract of some test data based on a lane of a tortuous mountain road, which were investigated in Brummer et al. (2013). By means of this example and an additional high way track the advantages regarding the accuracy, data compression and curvature reconstruction are highlighted and compared to state of the art methods. In fact, an extension of the SMAP algorithm is applied, which additionally integrates line segments in the approximating arc spline at areas which are likely to belong to straight parts of the lane (cf. Maier et al., 2013). To get an impression of the algorithmic performance note that only 127 SMAP segments are needed for approximating 74 km highway (ca. 35 000 input points) with a maximum error of 0.2 m.A compact and accurate lane representation is crucial for various advanced driver assistance systems. For instance, it can be used for vehicle self-localization purposes as it enables fast access to map elements in a desired local environment and allows efficient calculations of distances from points to map elements. Based on this issue in Schindler (2013) an approach is proposed that associates locally recognized objects with corresponding elements of the map in order to deduce the pose of the ego vehicle. Experiments have shown that a positioning accuracy significantly below one meter and an orientation accuracy below one degree even at a speed up to 100 km/h in real-time are reached.In order to represent entire systems of roads and streets, further theoretical and algorithmic requirements of the arc spline approximation have to be considered, such as cyclic structures, crossings and self-intersections. For this purpose, we will work on a solid basis for a completely automatic map development within the research project “Methods for generating High Precision Digital Maps using Circular Arc Splines”. This project is funded by the German Research Foundation (DFG – Deutsche Forschungsgemeinschaft) under grant number MA 5834/1-1.

@&#CONCLUSIONS@&#
