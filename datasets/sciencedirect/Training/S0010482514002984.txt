@&#MAIN-TITLE@&#
Reconstruction of sparse-view X-ray computed tomography using adaptive iterative algorithms

@&#HIGHLIGHTS@&#
Two practical algorithms for limited-projection-view CT reconstruction are proposed.Reconstruction parameters of both algorithms are determined automatically.Computationally intense ART are saved if the data fidelity constraint is satisfied.

@&#KEYPHRASES@&#
Computed tomography,Iterative reconstruction,Total variation,Automatic parameter tuning,ART,

@&#ABSTRACT@&#
In this paper, we propose two reconstruction algorithms for sparse-view X-ray computed tomography (CT). Treating the reconstruction problems as data fidelity constrained total variation (TV) minimization, both algorithms adapt the alternate two-stage strategy: projection onto convex sets (POCS) for data fidelity and non-negativity constraints and steepest descent for TV minimization. The novelty of this work is to determine iterative parameters automatically from data, thus avoiding tedious manual parameter tuning. In TV minimization, the step sizes of steepest descent are adaptively adjusted according to the difference from POCS update in either the projection domain or the image domain, while the step size of algebraic reconstruction technique (ART) in POCS is determined based on the data noise level. In addition, projection errors are used to compare with the error bound to decide whether to perform ART so as to reduce computational costs. The performance of the proposed methods is studied and evaluated using both simulated and physical phantom data. Our methods with automatic parameter tuning achieve similar, if not better, reconstruction performance compared to a representative two-stage algorithm.

@&#INTRODUCTION@&#
X-ray computed tomography (CT) is an imaging technique widely used for medical diagnosis and treatments [1]. Due to potential risk of inducing secondary cancers, it is desirable to reduce radiation doses of X-ray CT imaging (e.g. fewer projection views, less angular coverage and lower incident X-ray intensity) [2]. For CT reconstruction with limited data, iterative reconstruction (IR) methods have demonstrated their capability of producing high quality images [3,4]. Thanks to advances of computer hardware and reconstruction algorithms, IR for CT has become a realistic approach in clinic practice [5].One advantage of IR methods is that prior information can be incorporated with the imaging models, which can further improve reconstruction qualities [6–9]. In the past few years IR methods regularized by sparsity priors have been investigated [10–12]. One common approach is to minimize the total variation (TV), which is based on assumption of image sparsity in the gradient domain [13]. The nonlinear TV regularization can reduce noise while somewhat preserving edges of CT images.Many iterative algorithms have been developed for regularized CT reconstruction [9,14–16]. A two-stage reconstruction approach was utilized in [17] where the data fidelity condition and prior constraints were enforced onto images separately. The same strategy was also adopted in TV regularized reconstruction [18–20]. In these iterative approaches, data fidelity constraints were enforced using the algebraic reconstruction technique (ART) and the TV objective was minimized using steepest descent or other optimization methods. To balance the two operations, a set of empirical parameters were introduced to adjust the contributions of the ART and TV optimization in [18]. However, one disadvantage of these iterative methods is that the parameters, such as step sizes, usually need to be manually tuned to achieve quick and convergent reconstruction and good image quality under different imaging conditions. Since this manual tuning process is tedious and time consuming, an automatic determination of reconstruction parameters for predictable results is highly desirable, which is the focus of this work.For this purpose, a non-parametric control method was proposed to adjust the TV step size according to changes in the projection domain [21]. In this work, we propose to determine all iterative parameters automatically from data to avoid tedious manual parameter tuning. In TV minimization, the step sizes of steepest descent are adaptively adjusted according to the difference from POCS update in either the projection domain (projection controlled steepest descent, “PCSD”) or the image domain (image controlled steepest descent, “ICSD”), while the step size of the ART in POCS is determined based on the data noise level.Furthermore, in two-stage approaches, the projections of the reconstructed image need to compare with the observed data to determine certain parameters [18]. This requires one full forward projection in addition to the forward and backward projections of the ART for each iteration. In this paper we utilize a novel mechanism to reduce the computational cost of two-stage CT reconstruction by skipping the ART operation for the data fidelity constraint when the projection error is not greater than a predefined error bound.The rest of this paper is organized as follows. The objective function for X-ray CT reconstruction is provided in Section 2. The new adaptive iterative reconstruction algorithms are proposed in Section 3. In Section 4, performances of the proposed algorithms are evaluated using both simulated and real data. Discussion and conclusion are given in Section 5.Given the system matrix M, reconstruction of X-ray CT image x, i.e. linear attenuation coefficient map, can be represented as optimization of the following regularized least-square model,(1)x⁎=minx{12‖Mx−p‖2+β‖x‖TV},where the first term in the model is a data fidelity term,pis the projection data whose element piis the logarithm of inversely normalized measured data on ith detector bin, and the second total variation (TV) term enforces edge-preserving smoothness penalty on reconstructed images [13]. TV is usually defined as,(2)‖x‖TV=∑u,v|(∇x)u,v|,where∇xis the gradient vector of x. Its element(∇x)u,v=((∇x)u,(∇x)v)with(∇x)u=xu+1,v−xu,vand(∇x)v=xu,v+1−xu,v.|(∇x)u,v|is defined as,(3)|(∇x)u,v|=((∇x)u)2+((∇x)v)2+δ,whereδis a small positive constant to smooth the non-differentiable TV norm as proposed in [10].Eq. (1) is an unconstrained convex optimization problem and can be solved by well-established optimization techniques, such as conjugate gradient [19] and the first order primal dual methods [22]. However, the solution of Eq. (1) varies depending on the value ofβthat balances the contributions between TV and data fidelity terms. There is no straightforward way to determine its value for the optimal reconstruction other than trial-and-error tests. In this work, we focus on the parameter determination by treating sparse-view CT reconstruction as a constrained optimization as follows:(4)x⁎=minx‖x‖TVsubjectto‖Mx−p‖2≤є.In this from, the objective is a TV minimization problem constrained by a data fidelity term in the projection domain. The parameterєdefines a certain amount of data error allowed between predicted and observed projection data due to noise and modeling errors, so called the “error bound” parameter. It is noted that there is an equivalence between the objective functions (1) and (4) whenєis not equal to zero. Nevertheless, the automatic determination ofєcan be achieved using the projection data, thus avoiding the difficulty of the selection ofβ. For a well-calibrated CT system and well-compensated projection data,єis dominated by the photon counting noise obeying Poisson distribution. Thus, an appropriate value forєcan be determined using the method proposed in [23]. The method approximates the noise variance of the measurement yifor the line integral along the ith ray, the received X-ray intensities on the ith pixel of detectors,(5)єi=1yi.Given incident photon intensity y0,pi=ln(y0/yi)based on the Beer’s law.єis then estimated as the summation over all projections(6)є=∑iєi.In practice, a non-negative constraint on image pixels (linear attenuation coefficients) is also introduced and leads to the following constrained optimization problem,(7)x⁎=argmin‖x‖TVsubjectto‖Mx−p‖2≤єandx≥0,The constrained optimization problem can be solved using a two-stage framework: (1) the enforcement of data fidelity and non-negativity constraints, and (2) the minimization of TV [10]. Two operations are iterated in alternation to achieve the optimal solution. Projection onto convex sets (POCS) is used at the first stage by treating constraint sets as convex sets and selecting a feasible image through projections onto these sets. Iterative methods such as steepest descent can be applied for TV optimization. Such TV-POCS approaches usually include two loops of iteration: a main loop of POCS and a sub-loop of TV optimization. The parameters that control the step sizes of POCS and TV minimization are important for a well-behaved iterative reconstruction. In this work, we proposed automatic approaches to determine these parameters to avoid tedious trial-and-error parameter tuning.In the POCS stage, the feasible solution of data fidelity term can be obtained using the algebraic reconstruction technique (ART). For the ith ray of X-ray CT, the original ART from an initial point xs is the pure projection Pxs onto the hyperplane defined bymix−pi=0,(8)x=Pxs=xs+1‖mi‖2(pi−mixs)miT,where miis the ith row of the system matrix M. The original projection form of ART is suitable for noiseless data where the set of linear equations is consistent. To accommodate noisy data fidelity constraint, a relaxed projection form of ART is introduced,(9)x=(1−λi)xs+λiPxs=xs+λi‖mi‖2(pi−mixs)miT,whereλiis the relaxation parameter [24].In this study we proposed to determine the relaxation parameter according to the noise level of X-ray photon detection, whose variance can be approximated as the inverse of the detected counts shown in Eq. (5)[25–27]. Specifically, the relaxation parameter can be defined as the normalized X-ray intensities,(10)λi=yiy0=exp(−pi).As can be seen,λiis confined between [0, 1]. Geometrically, the relaxed point x can be interpreted as an interior point on the line segment from the initial point xs to the projection Pxs, andλiis a weight of projection point. When the projection data has the lowest noise level, i.e. yi=y0or no attenuation,λi=1will lead to the pure projection Pxs. On the other hand, to account for the variability of the observation pi, the relaxation parameterλiwill relax the projection to(1−λi)xs+λiPxs. The higher the noise level, the further away the relaxed projection point from the pure projection point. This operation reflects the fact that the solution may not exactly equal to pi, but rather fall in a confidence region‖mix−pi‖2≤єi. The relaxed projection is also similar in spirit to a weighted least squares (WLS) implementation, which weights more on the observations with less variance [28,29]. The influence of the relaxed projection of ART on reconstruction is studied experimentally in Section 4.3.To enforce the non-negativity constraint, the negative values in the reconstructed image are set as zero. POCS is the combination of non-negativity projections and the ART.Steepest descent is an effective first order method for large-scale optimization problems such as X-ray CT. Starting at an initial point x0, the iterative formula of steepest descent at the (n+1)th iteration of TV minimization is,(11)x(n+1)=x(n)−η⋅s(n)‖s(n)‖,wheres(n)=(∂‖x(n)‖TV/∂x(n))is the derivative of the TV norm,‖x(n)‖TV, with respect to x(n), whose element is the partial derivative of the image TV at the corresponding pixel (u, v) of 2D images, andηis the step size. However, TV-gradient descent cannot be implemented without the consideration of the constraints (achieved by POCS) for the reconstruction problem at hand. Otherwise it will lead to a solution of a non-negative flat image. The balance between TV-gradient descent and POCS can be achieved by making TV-gradient descent step size proportional to the change in the image due to POCS. Furthermore, the gradient descent step size needs to be non-increasing at every main iteration to ensure that the image constraints are satisfied at the end. The value of the step size during the wth main iteration was defined as a function of image changes in [10],(12)η=α×ΔI(w),where α was an empirical factor valued in (0,1] andΔI(w)was image changes by the wth POCS operation. In the adaptive steepest descent (ASD) approach [18], more parameters were introduced forηadjustment to balance the data fidelity and regularization terms. However, the reconstruction may not be stable when a complicated parameter scheme was used. The proposed step-size methods are inspired by [10] with the improvement that an adaptive relaxation scheme based on changes in the projection domain or in the image domain after each main iteration, thus avoiding the (unstable) arbitrary relaxation.In our previous work of the consistency controlled steepest descent (CCSD) method [21], an automatic method was proposed to determine the step sizeηusing projection errors,(13)η=kΔP(w)ΔP(1),whereΔP(w)=‖Mx(w−1)−p‖was the estimation error in the projection domain at the wth main iteration,ΔP(1)was the projection error after the first iteration where the initialηwas set to 1 and k was a scale factor with an unit 1/cm to match the physical dimensions of both sides of the equation. The factor is adjusted to compensate unit changes of image, e.g. k=1 with the attenuation unit of cm−1 and k=10 with mm−1. After the first iteration, the numerator in Eq. (13) becomes smaller than the denominator asMxis approaching the projection data p. The step-size is determined directly by intermediate estimation x(w) and observed data p without artificial parameters.In the CCSD method, the step size was the function of projection errors. Besides forward and backward projections in the ART, the CCSD method requires one additional forward projection for step-size control. In this study, we propose an improvement of CCSD to reduce the computational cost. In this improvement, a forward projection is implemented at the beginning of the main-loop iteration to estimate projection errorΔP(w). The ART is conducted only ifΔP(w)is larger than the error bound. The calculatedΔP(w)is also used as in Eq. (13) for TV step-size adjustment. We call this new implementation as projection-controlled steepest descent (PCSD) algorithm in which no manually tuning parameters are needed; it also saves forward and backward projections in ART if(ΔP(w))2≤є.The procedure of the proposed PCSD algorithm is described as follows,(1)Initialization: set ntand wt; w=0;η=k(k=1 for cm−1); select x(0)POCS: from x(w) to xPOCS(at the wth main iteration)(a)xART=x(w),ΔP(w)=‖MxART−p‖;Enforcing ART along all projections if(ΔP(w))2>є,xART=xART+λi‖mi‖2(pi−mixART)miT;Non-negativity projection on all pixelsxPOCS=max{xART,0};TV routine (subroutine): from xPOCSto xTV(a)Initialization (of sub-routine): n=0,xTV(0)=xPOCS,η=k(ΔP(w)/ΔP(1))if w>0 and(ΔP(1))2>єxTV(n+1)=xTV(n)−η×s(n)‖s(n)‖n=n+1; repeat step (b) until n>nt;w=w+1,x(w)=xTVnt;Repeat steps (2)–(4) whenw<wt.The iterative algorithm includes two loops of iterations. Lines (2) to (4) are the main-loop, which is composed of POCS and TV stages. Besides, the operations (a–c) under line (3) are a sub-loop for TV minimization. ntis the total iteration number of TV subroutine. Two operations are conducted alternately until the stopping criteria are satisfied. The stopping criteria include: (1) the current image satisfies the constraints; and (2) either a predefined iteration number or a predefined small value of the difference of images of two successive iterations is reached. For comparison of different methods, the same iteration number is used in the experiments, i.e. the algorithm is terminated after wtmain-loop iterations.The step sizeηin [18] was adjusted according to changes in the image domain. The method used an artificial factor α, which has to be determined empirically. We propose to determineηusing a ratio of changes measured in the image domain,(14)η=kΔI(w)/ΔI(1)whereΔI(w)=‖x(w−1)−xPOCS‖is the image change due to the current PCOS operation andΔI(1)is image changes after the first main-loop iteration forη=1in the initial iteration, and k is a scale factor defined the same as Eq. (12). Similar to the PCSD, the ART operation is only conducted when projection error(ΔP(w))2is larger than the error boundє. The whole procedure of the ICSD algorithm is similar to that of PCSD and described as follows,(1)Initialization: set ntand wt,; w=0;η=k(k=1 for cm−1); select x(0)POCS: from x(w) to xPOCS(at the wth main iteration)(a)xART=x(w),ΔP(w)=‖MxART−p‖;Enforcing weight ART along all projections if(ΔP(w))2>є,xART=xART+λi‖mi‖2(pi−mixART)miT;Non-negativity projection on all pixelsxPOCS=max{xART,0};If(ΔP(w))2>є,ΔI(w)=‖x(w)−xPOCS‖, elseΔI(w)=ΔI(w−1);TV routine (subroutine): from xPOCSto xTV(a)Initialization (of sub-routine): n=0,xTV(0)=xPOCS,η=kΔI(w)/ΔI(1)if w>0 and(ΔP(1))2>єxTV(n+1)=xTV(n)−η×s(n)‖s(n)‖n=n+1; repeat step (b) until n>nt;w=w+1,x(w)=xTVnt;Repeat step (2)–(4) whenw<wt.Note thatΔP(w)is the difference between estimated projection data and observed projection data, whileΔI(w)is the difference between the images after the wth main iteration and the (w+1)th POCS and is not directly related to the observation data.

@&#CONCLUSIONS@&#
