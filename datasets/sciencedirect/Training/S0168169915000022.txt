@&#MAIN-TITLE@&#
Optimal design and operation of a UASB reactor for dairy cattle manure

@&#HIGHLIGHTS@&#
Optimal design and operation of a UASB reactor at a dairy farm is determined.Brute force optimization is based on a dynamic AD model and temperature models.Solutions provided are maximum gas flow, minimum volume, and maximum power surplus.The optimal solutions are improved if the biomass retention time is increased.

@&#KEYPHRASES@&#
Anaerobic digestion,UASB reactor,Biogas,Mathematical models,Optimization,

@&#ABSTRACT@&#
Optimal design and operation of a planned full-scale UASB reactor at a dairy farm are determined using optimization algorithms based on steady state simulations of a dynamic AD process model combined with models of the reactor temperature and heat exchanger temperatures based on energy balances. Available feedstock is 6m3/d dairy manure produced by the herd. Three alternative optimization problems are solved: Maximization of produced methane gas flow, minimization of reactor volume, and maximization of power surplus. Constraints of the optimization problems are an upper limit of the VFA concentration, and an upper limit of the feed rate corresponding to a normal animal waste production at the farm. The most proper optimization problem appears to be minimization of the reactor volume, assuming that the feed rate is fixed at its upper limit and that the VFA concentration is at its upper limit. The optimal result is a power surplus of 49.8MWh/y, a hydraulic retention time of 6.1d, and a reactor temperature of 35.9°C, assuming heat recovery with an heat exchanger, and perfect reactor heat transfer insulation. In general, the optimal solutions are improved if the ratio of the solids (biomass) retention time to the hydraulic retention time is increased.

@&#INTRODUCTION@&#
The aim of this paper is to optimize the design and steady-state operation of a planned full-scale upflow anaerobic sludge blanket (UASB) reactor fed with dairy cattle waste with 6m3/d available feedstock. The optimization is based on a mathematical model of the reactor comprising a dynamic AD process model combined with models of the reactor temperature and the heat exchanger temperatures based on energy balances. The biological parameters of the AD process model was estimated from experiments on a real pilot reactor using the same feedstock as the planned full-scale reactor.Three sets of optimization problems are studied: Maximization of the produced methane gas flow, minimization of the reactor volume, and maximization of the power surplus. The biological product considered in the optimization problems is the produced methane gas.Actually, the real pilot plant in Foss Biolab includes a nitrification reactor used to enhance the quality of the effluent as a biological fertilizer. The planned full-scale plant also includes a nitrification reactor. However, the present study focuses at the energy production – not fertilizer production. Therefore, the AD effluent is taken into account in the present study only through its contribution to the energy balance, and not as a fertilizer.An early attempt to use a dynamic AD model for optimization of anaerobic digestion (AD) reactors was made by Hill (1983a). In that study, a series of simulations based on the model presented by Hill (1983b) were used to detect the optimum hydraulic retention time (HRT) that maximized the volumetric methane productivity defined as steady-state volumetric methane gas flow divided by reactor volume. The solids retention time (SRT) was assumed equal to the HRT, as in a continuous stirred tank reactor (CSTR).In the present study, the reactor is a UASB type reactor (Lettinga et al., 1980), having SRT larger than HRT. In UASB type reactors, the dense granulated sludge bed retains the microorganisms, and prevents them from being washed out of the reactor with the effluent. The formation of the granulated sludge is due to flocculation and gravity. Since the SRT is larger than the HRT for UASB reactors, their reactor volume can be made smaller, or, alternatively, their loading (feeding) rate can be higher compared with CSTRs.Poels et al. (1983) reported experiences from AD processing of swine waste on a farm of typical size for Belgium. They emphasized the importance of insulation and preheating the (cold) influent by the (warm) effluent.Bozinis et al. (1996) showed in a simulation study of a hypothetical centralized wastewater treatment plant based on co-digestion of a number of wastewater streams how optimization methods, namely nonlinear programming (NLP), can be used to identify the optimal number of CSTR AD reactors and their volumes that minimize costs. They also showed how to identify the optimal mixing of the wastewater streams that maximize the total COD (chemical oxygen demand) conversion of the plant. Simple steady-state AD process models based on Monod kinetics were assumed.The methods of formulation and solution of optimization problems for technical systems and industrial plants presented in Edgar et al. (2001) have been useful for the present paper as they are applicable also to biological plants.The outline of this paper is as follows. A description of the planned AD reactor and the optimization method used are described in Section 2. Optimization results are presented in Section 3. A discussion is given in Section 4, and conclusions are given in Section 5. Mathematical models are presented in Appendix A.Unless otherwise stated, the numerical values of variables presented in this paper are steady-state values.MATLAB (The MathWorks, Inc.) is used for numerical computations.The AD reactor is a part of a (planned) full-scale biological plant for nutrient and energy recovery, named Foss Biolab, situated at Foss Farm, Skien, Norway. A small-scale pilot plant has been in operation for about two years. A description of the pilot plant, including its monitoring and control system, is in Haugen et al. (2013a).The feed to the pilot reactor, which has 250L liquid volume, is dairy waste diluted with approximately 25% water and filtered with a home-made rotary sieve with mesh-size 1.4mm. The sieve, or separator, removes larger particles to avoid technical problems (the dry-matter from the sieve is used for vermicomposting). The wet-fraction is used as feed to the AD reactor. Feed characteristics from laboratory analysis are presented in Table 1.The produced biogas consists of approximately 70% methane.Fig. 1depicts the planned full-scale reactor. The figure includes a heat exchanger (however, the pilot reactor has no heat exchanger).The mathematical model used for optimization of the planned full-scale reactor comprises the following sub-models:1.The modified Hill model of the AD processes adapted to the pilot reactor (Haugen et al., 2013a). For easy reference, the model is summarized in Appendix A.1.A model of the reactor liquid temperature based on energy balance (Haugen et al., 2013a). The model is summarized in Appendix A.2.A model of the temperatures of heat exchanger based on energy balances. The model is derived in Appendix A.3.The modified Hill model is a relatively simple AD process model, however it has been successfully adapted to the real pilot reactor (Haugen et al., 2013a). The modified Hill model is selected in the present study since it is assumed sufficient for model-based optimization of the full-scale AD reactor. The most interesting alternative model is probably the comprehensive ADM1 model (Anaerobic Digestion Model No. 1) (Batstone et al., 2002), which, after adaptation to the real pilot reactor, may be used in future model-based studies.Fig. 2shows alternative optimization variables and objective variables. In the various optimization problems discussed in Sections 3.2, 3.3 and 3.4, various subsets of these variables are used.Fig. 2 defines alternative optimization objective variables (the outputs in the block diagram):Fmeth, to be maximized, which is an appropriate objective if the gas is supplied (sold) to a gas grid.V, to be minimized, which is an appropriate objective to save space and constructional and installation costs.Psur, to be maximized, which is an appropriate objective if the gas is applied for heating within the farm.Psuris calculated with Eq. (A.20), where all power terms are in units of MWh/y.In the following, the optimization variables are characterized as either operational or design optimization variables. The former can be changed while the reactor is being operated, while design optimization variables can be changed in the design or constructional phase.The various optimization variables shown in Fig. 2, and their constraints, are described in the following.Ffeed:The livestock of the pertinent farm counts approximately 60 cows, each producing approximately 0.1m3 diluted raw waste per day. The wet fraction which remains after the separation, amounts to approximately 0.7 (weight base), which is fed to the reactor. Thus, feasible values ofFfeedis(1)0⩽Ffeed≤4.2m3/d=FfeedmaxFfeedis an operational optimization variable.According to Tchobanoglous et al. (2003), most AD reactors are operated in the mesophilic temperature range which is 30–38°C. For the planned reactor, it is of interest to also investigate temperatures below this range mainly because of the relatively cold climate in Norway. The modified Hill model is applicable forTreacin the range20⩽Treac≤60°C, cf. Appendix A.1. The following range ofTreacis considered in this paper:(2)Treacmin=20⩽Treac≤38°C=TreacmaxTreacis an operational optimization variable.Above, it is defined as an optimization objective, but it is also used as an optimization design variable in some of the optimization problems.We think that it makes sense to allow V to become virtually unlimited in the optimization problems. However, a well-defined upper limit is necessary by computational reasons, and to this end we select 700m3, but another very large value might have been chosen. (In one of the optimization problems, namelyPF3, the optimal V is at this upper limit, but it is regarded as an impractical solution.)In Haugen et al. (2013a), the retention times ratio is defined as(3)b=SRTHRTwhere SRT is the solids (biomass) retention time, and HRT is the hydraulic retention time (HRT) which is defined as (Tchobanoglous et al., 2003):(4)HRT=VFfeedSRT can not be less than HRT. Therefore, b is lower bounded to 1. It is assumed that b does not have a larger value than 20, i.e.(5)bmin=1⩽b≤20=bmaxThis assumption is supported by simulations: Fig. 3, plot 3a, indicates that the sensitivity ofFmethto b is relatively small for b above 20.In the majority of the optimization problems studied in the article, b is set to 2.9, the estimated value for the real pilot reactor. The upper limit of b of 20 is questionable, and we do not have real data supporting this limit. However, the main purpose of setting such a specific upper limit is to allow for qualitative results, i.e. demonstrating the importance of attempting to design the reactor so that b becomes as large as possible.b is a design optimization variable, but may be changed after the reactor has been set into operation. As shown in Section 3, it is beneficial in the optimization scenarios that b is as large as possible. A large b is obtained with a relatively large SRT. Khanal (2008) presents different techniques to increase the SRT for AD reactors, e.g. settling and filtering. For the existing real pilot reactor, granules have been added in an attempt to increase the SRT, however, the effect of adding granules has not been analyzed.For the pilot reactor, b is estimated from time-series as 2.9 (Haugen et al., 2013a). It is interesting to compare this value with the parameter α estimated in Bernard et al. (2001) where a dynamical AD model which resembles the modified Hill model in important aspects, is adapted to a 0.95m3 real fixed-bed reactor with recycling using wine distillery vinasses as substrate. α is denoted “proportion of dilution rate for bacteria”. It can be shown thatb=1/α. From real data, α was estimated as 0.5, corresponding tob=1/0.5=2which is relatively close to 2.9 which is estimated for our reactor. Although these two reactors differs in many aspects, the resemblance between b and α is reassuring.the heat exchanger coefficient, is defined with Eq. (A.14) in Appendix A.ghxis a design optimization variable. In the optimization problems,ghxhas value either∞(perfect heat exchange) or 0 (no heat exchange, or no heat exchanger). On a real heat exchanger, perfect heat exchange can of course not be obtained, corresponding to a limited value ofghx. Still, it is decided to assume an ideal heat exchanger to avoid complicating the analysis. Also, the principal difference between applying heat exchange and not is expected to be principally the same for a real heat exchanger as for an ideal heat exchanger.the specific heat transfer coefficient of the reactor, is calculated from the value of the real pilot reactor as explained in Appendix A. In optimization problems where perfect thermal insulation of the reactor walls is assumed, U is set to zero. U is a design optimization variable.The constraints onSvfais an important optimization constraint. According to the discussion in Haugen et al. (2013b) based on the results in Hill et al. (1987), the range ofSvfafor safe reactor operation is(6)Svfa≤0.8g/L=SvfamaxIn each of the optimization problems, bothTambandTfeedare set to 10°C.1In an online system for optimal reactor operation, online temperature measurements may be used as inputs to the optimizer.1The rationale for this is as follows. It is assumed that the reactor is indoor in a barn or similar. It is assumed that the filtered feed is stored for so long time “inhouse” thatTambandTfeedare approximately equal. Furthermore, the value of 10°C is a rough estimate of the average for the real pilot plant.The optimization problems are solved using the straightforward “brute force” (BF) method: Assume that the vector of optimization variables isx={xi}, withi=1,…,nwhere n is the number of optimization variables. For example, in optimization problemPF1studied below,x1=Ffeedandx2=Treac. For each{xi}, an array of discrete values is generated. A reasonable range of this array is guessed, and the resolution of the array is adapted (manually), but is typically selected as1/NxiwhereNxi=100(the number of elements in the array). By regarding each{xi}as a coordinate, the n arrays constitute a grid. The objective function,fobj, is calculated at each grid point (or joint), i.e. for each possible combination of the elements in eachxi. The optimal solution,xopt, is that particular value of x which corresponds to the optimal value offobj, i.e. either the maximum or the minimum depending on how “optimal” is defined for the given optimization problem.In general, precise solutions are desired. To obtain more precise solutions, the following alternative approaches were tested on some of the optimizations problems: (1) Reducing the range. (2) Improving the resolution by increasing number of grid intervals. (3) Applying a local optimizer (Edgar et al., 2001) with the global optimal solution found with the BF method as the initial (guessed) optimal solution. The fmincon function in MATLAB was used as local optimizer. It was found that the differences between approach No. (3) – using a local optimizer – and the other two alternative approaches were negligible. The computer program implementation of the BF method is considerably simpler and more flexible (scalable) than an implementation using fmincon. Therefore, the BF method, without any local optimizer, is the selected method in this paper.The value offobjis calculated from the steady-state of the dynamic simulations of the modified Hill model of the AD process combined with the steady-state models of the reactor temperature and the heat exchanger temperatures based on energy balances. The simulator is based on the Euler explicit numerical method implemented in for-loops. This approach to findfobjis similar to that in Rivas et al. (2008) where a wastewater treatment plant is optimized. There, the GRG22Generalized reduced gradient.2algorithm implemented in Microsoft Excel is used.

@&#CONCLUSIONS@&#
Optimal design and operation of a planned full-scale UASB reactor at a dairy farm have been determined using optimization algorithms based on steady state simulations of a dynamic AD process model combined with models of the reactor temperature and the heat exchanger temperatures based on energy balances. Available feedstock is 6m3/d dairy waste.The optimization solutions have been found using the straightforward “brute force” (BF) method which is based on a scan for the global optimal solution over a grid of the optimization variables. The grid resolution is typically selected as 1/100 of the range of the pertinent variable, giving a sufficient precision of the optimal solution.For the given AD reactor and its mathematical model, alternative optimization objectives are maximizingFmeth, minimizing V, and maximizingPsur. Optimization variables candidates areFfeed,Treac,b,V,ghx, and U. The optimization algorithm takes into account the following constraints:Svfa⩽Svfamax, andFfeed⩽Ffeedmax.The results indicate that any optimal solution is improved, for example, the maximumPsuris increased, if b is increased, if energy is recovered with a heat exchanger, and if the reactor is well insulated.Evaluated over all of the optimization problems studied, the maximumPsuris 68.2MWh/y, corresponding to power surplus productivityγP=1.14(MWh/y)/LU.