@&#MAIN-TITLE@&#
Blood vessel extraction and optic disc removal using curvelet transform and kernel fuzzy c-means

@&#HIGHLIGHTS@&#
An integrated framework for retinal blood vessel extraction.Matched filtering, Laplacian of Gaussian, KFCM and morphological operation.Accurate vessel extraction from DRIVE, STARE and DIARETDB1 databases.Vessel extraction accuracy-96.16% for DRIVE and 97.35% for STARE databases.

@&#KEYPHRASES@&#
Retinal vessel extraction,Curvelet,Matched filter,Kernel fuzzy c-means,Laplacian of Gaussian,

@&#ABSTRACT@&#
This paper proposes an automatic blood vessel extraction method on retinal images using matched filtering in an integrated system design platform that involves curvelet transform and kernel based fuzzy c-means. Since curvelet transform represents the lines, the edges and the curvatures very well and in compact form (by less number of coefficients) compared to other multi-resolution techniques, this paper uses curvelet transform for enhancement of the retinal vasculature. Matched filtering is then used to intensify the blood vesselsâ€™ response which is further employed by kernel based fuzzy c-means algorithm that extracts the vessel silhouette from the background through non-linear mapping. For pathological images, in addition to matched filtering, Laplacian of Gaussian filter is also employed to distinguish the step and the ramp like signal from that of vessel structure. To test the efficacy of the proposed method, the algorithm has also been applied to images in presence of additive white Gaussian noise where the curvelet transform has been used for image denoising. Performance is evaluated on publicly available DRIVE, STARE and DIARETDB1 databases and is compared with the large number of existing blood vessel extraction methodologies. Simulation results demonstrate that the proposed method is very much efficient in detecting the long and the thick as well as the short and the thin vessels with an average accuracy of 96.16% for the DRIVE and 97.35% for the STARE database wherein the existing methods fail to extract the tiny and the thin vessels.

@&#INTRODUCTION@&#
Diabetic Retinopathy (DR) is a progressive microvascular chronic disorder of diabetes mellitus and one of the major causes of visual impairment all over the world. It occurs when the blood vessels that nourish the retina are blocked and hence deprive several areas of retina with blood and oxygen supply [1]. In proliferative diabetic retinopathy (PDR), new blood vessels start growing along the retina. These blood vessels are fragile and abnormal in nature and cause frequent minor bleeding, sometimes cause permanent vision loss. The first step of PDR treatment needs the design of an automated system that enables accurate detection of different blood vessels that travel radially outward from the optic disc (OD) at different orientations [2]. The vessels are often disconnected, indistinguishable from the background and the vessel boundaries are unsharp. Retinal images are also contaminated by noise during acquisition, storage and transmission and are also degraded in the form of blurring. Furthermore, sometimes the images are non-uniformly illuminated.Presence of noise, drift in image intensity, non-uniform illumination, lack of image contrast altogether make accurate extraction of the thick and the thin as well as the tiny and the large vessels from the retinal background really a very complicated and challenging task. The task becomes more challenging when the retinal images contain different lesions, exudates, drusen, symptoms of different ocular diseases like background DR, hypertensive retinopathy etc. It is worth to mention that different types of databases are available online for the retinal images, namely the DRIVE [3] database, the STARE [4] database, the DIARETDB1 [5] database etc. The characteristics, the contents and the pathological changes on the retinal images are also different from one another and needs certain modifications of the tools and techniques used for accurate blood vessel extraction. Not only that, for proper gradation of DR and further medical diagnosis, in addition to the accurate extraction of blood vessels, an automated system must be capable of differentiating vessels of different widths. In the existing literature, a single threshold is used that partition the retinal image pixels into two classes: vessel or non-vessel. However, for diagnostic purpose, identification of various types of blood vessels is of utmost importance. It is difficult to find an optimal global threshold value that would partition separately the thick and the thin vessels which vary largely in shape, size, length, diameter etc. with equal accuracy. This is basically a classification problem where the thickness of the vessel is subjective.A short version of the present work was reported in [6] where fuzzy c-means (FCM) algorithm was used to extract the vessel silhouette from the matched filter response as vessel and non-vessel pixels. The main disadvantage of FCM based classification is that it uses Euclidean distance measure to determine the similarity (distance) between the data points and the cluster centers. Hence, this is unable to capture the non-linear structures of the feature space adequately. It produces accurate results for noise free images. However, its performance deteriorates to a great extent when the retinal images are contaminated by noise and suffer from outliers and/or other imaging artifacts such as in-homogeneous intensity distribution, and non-uniform illumination. Recently kernel based FCM (KFCM) reported in [7] looks promising for data clustering as well as in image segmentation. The basic idea behind kernel based technique is that it transforms the low dimensional input space into a high dimensional feature space through some form of non-linear mapping. As a result, the data points not linearly separable in the original input space are now linearly separable in the high dimensional feature space and hence produces better results. This principle may be used for automated and accurate extraction of different types of blood vessels and is addressed in this work. Another drawback of [6] is that it also detects the OD boundary due to its high matched filter response (MFR) which also increases the false detection rate. The present work eliminates the OD through morphological techniques.Performance of [6] is evaluated only for noise-free images. In other words, performance in presence of noise was not studied. The present work studies its performance in presence of zero mean additive white Gaussian noise. Curvelet transform is used first for image denoising. Extensive simulation results on various databases show its performance gain over [6] and outperforms several other existing techniques for retinal vessel extraction. More importantly, the proposed method not only improves overall vessel extraction but also extracts diverse types of vessel structures separately.Information about the different types of blood vessels are very much helpful for the diagnosis and grading the severity level of ocular diseases including glaucoma, DR etc. The blood vessels can have measurable abnormalities in diameter, color, tortuosity etc. as a result of different opthalmologic diseases. The proposed method aims not only to extract blood vessels but also to efficiently classify the vessels into different categories. Vessel extraction results may be used to study various properties like radius, length, vessel width etc. to find the vessel abnormalities.The remainder of this paper is organized as follows. A comprehensive review of the state-of-the-art vessel extraction methods, their limitations and scope of the present work are presented in Section 2. Section 3 describes the tools, techniques and various numerical measures used in the present work. Proposed method of vessel detection is stated in Section 4. Experimental results, performance evaluation of the proposed method and discussions are reported in Section 5. Conclusions and scope of future works are stated in Section 6.Literature on the retinal vessel extraction problem is quite rich. A noteworthy survey on blood vessel segmentation in retinal images can be found in [8].Vessel extraction methods reported in the literature are broadly grouped into the following classes: pattern recognition techniques using supervised [9] and unsupervised classification [10,11], mathematical morphology based methods [12], vessel tracking/tracing methods [13] and matched filtering based techniques [14].Different methods using back propagation algorithm with modified delta rule [15], principal component analysis (PCA) followed by neural networks [16], multilayer feed forward neural network for training and classification using gray-level and moment invariant-based features [9] are reported in the literature for vessel extraction using supervised learning. The main disadvantage of neural network based methods lies in training process to adjust the network weights by supervised learning with standard training data. First major problem is the need of large number of images. Not only that, for each image in the training set, vascular structure needs precisely marked by an ophthalmologist. As observed by Hoover et al. [17], there exists significant difference on the retinal vasculature marked by different experts.Morphological operation is a powerful tool for extracting region and shape based features including boundaries, skeletons, convex hulls etc. using structural elements (SE) to the images under experimentation. In [18], morphological top-hat operation followed by fuzzy clustering is used for vessel extraction. A combination of morphological multiscale enhancement, fuzzy filter and watershed transformation has been used by Sun et al. [19]. Mendonca and Campilho [12] extracted vessel center lines using multiscale morphological reconstruction for vessel segmentation. However, this method suffers from the problem of under segmentation for some vessel segments and sometimes partial/complete missing of small vessels occurs. The main disadvantage in morphological operation as is used and benefited in matched filtering lies in lack of scope in exploiting the known vessel cross-sectional shape. Moreover, the length of the SE is very high which may cause difficulty to fit in the highly tortuous vessels.Vessel tracking/tracing method reported in [13] segments a vessel between two points and instead of working on the entire vasculature they work at the level of a single vessel. Can et al. [20] described a real-time recursively tracking based algorithm for vessel extraction to produce the maximum response for an edge oriented in a particular direction. Delibasis et al. [13] described an automated model based tracing algorithm for vessel segmentation and diameter estimation. This method usually requires a starting point and an end point to be specified by the user. The method is not suitable for detecting the vessels or the vessel segments that have no seed point at all. Furthermore, if any bifurcation point is missed, some of the sub-trees remain undetected.The widely used vessel extraction method is the matched filter (MF) based approach [14,21]. A two dimensional linear kernel is rotated and convolved on the retinal image. For each pixel, the highest response is selected which is then thresholded to extract the vessels. The widely used template for matched filtering is the Gaussian kernel which produces high response when matched to the vessels since the gray-level profiles of the cross-section of the blood vessels in retinal image are also Gaussian in nature. The other advantage is that retinal blood vessels can be approximated as piece-wise linear segments and the diameters of the vessels decrease along their length. It can also extract retinal vasculature even from a noisy image as it is optimal in nature in presence of noise. Since the MF kernel is rotated in all possible directions and is convolved with the image under consideration, it can easily track the different orientations of the diverse types of vessels. Performance of MF based approaches depend to a large extent on the appropriate pre-processing technique(s) used. This leads to feature enhancement of retinal images. Various wavelet and its variants are found to be efficient for pre-processing operation. One such operation is curvelet transform and morphological operation as reported in [22] and curvelet transform followed by matched filtering in [23].An automatic and accurate blood vessel extraction method, in general, should posses the ability to handle noise (denoising) cleaning, enhancement of thin vessels and also to highlight distinction of various types of vessels. To this aim, an integrated vessel extraction method is suggested with the following contributions:â€¢An integrated scheme is proposed in this work that uses curvelet transform for image denoising and edge enhancement. Curvelet transform not only removes noise but also intensifies the thin and the weak vessels and highlights the missing and the imprecise edge details. For edge enhancement, the image is decomposed into a number of subbands using curvelet transform. The approximate subband is completely suppressed and the detailed subbands are intensified multiplying by some amplification factor.To remove the OD, the edge enhanced image is first opened by a disk shaped SE which is then subtracted from the inverted histogram equalized image. The poor dynamic range of the subtracted image is enhanced through contrast stretching using the gamma (Î³) law transformations function with Î³=0.85.MF with proper Gaussian profile is applied on the spatial domain to intensify the response against the various types of blood vessels. The output then undergoes KFCM to detect the vessel pixels from the maximum MFR of both the vessel and the non-vessel pixels.For abnormal retinal images that contain different pathological signs, to distinguish vessels from different non-vascular patterns like bright blobs, red lesions etc. a pair of filters, the zero mean Gaussian filter (i.e. the MF) and the Laplacian of Gaussian (LoG) filter are used which then undergo KFCM based classification. To the best of our knowledge, the application of LoG filter and KFCM for retinal blood vessel extraction is not reported earlier. The novelty of the proposed method lies in the concept of multiple threshold using KFCM. Once the vessels are detected, the proposed method categorizes the extracted vessels into the thick, the medium and the thin vessels.Extensive simulation results are shown to highlight the efficiency of the proposed method with respect to the several existing methods. Improved performance is supported by high true positive rate and low false positive rate for different image databases.This section briefly presents various tools, techniques and different performance matrices used in this work.The basic concept of curvelet transform, as proposed by Donoho and Duncan [24], is to decompose the entire image into a number of subbands, i.e. to separate the object into a series of disjoint scales. Unlike the wavelets which are specified by two parameters, scale and translation (location), curvelet is a geometric multiscale transform that is indexed by scale, orientation and location, respectively. A curvelet transform can be specified mathematically asÎ¨i,j,k(x)=Î¨j(R0j,l(xâˆ’xk(j,l)))wherex=(x1,x2)âˆˆR2. The termÎ¼=(j,l,k), the triple index, represents the curvelet coefficientsCÎ¼(f)=ã€ˆf,Î¨Î¼ã€‰. Computation cost associated with the forward and the inverse wavelet transform isO(N2logN)for anNÃ—Nimage. The Fast Discrete Curvelet Transform (FDCT) can be implemented in the following two ways:(i)Unequally spaced Fast Fourier transforms (USFFT),Wrapping function.The wrapping based FDCT algorithm is used in this work since it is faster and more efficient than USFFT. In this method, the Fourier plane is divided into a number of concentric circles, referred to as scale; each of these concentric circles is again divided into a number of angular divisions, referred to as the orientation. This combination of the scale and the angular division is known as parabolic wedges. Next to find out the curvelet coefficients, inverse FFT is taken on each scale and angle.Vessel detection using matched filtering considers the fact that the gray-level profiles of the cross-section of retinal blood vessels are Gaussian in nature. It is also assumed that the intensity profile is symmetric about the straight line that passes through the center of the vessel [14]. A two dimensional prototype MF kernel may be mathematically expressed as(1)K(x,y)=âˆ’1Ïƒ2Ï€exp(âˆ’x2/2Ïƒ2),for|x|â‰¤(3Ïƒ)and|y|â‰¤(L/2)Here â€˜Ïƒâ€™ is the scale of the Gaussian function, â€˜Lâ€™ is the length of the blood vessel segment considered to have fixed orientation. The negative sign implies that the background is brighter than the vessels.Along with the vessels, pathological images are rich with different non-vascular structures such as bright lesions, exudates, and step and ramp like transient components. For all such images, if the maximum MFR values are directly applied for KFCM based classification, these spurious components are erroneously detected as vessels due to their high MFR. To distinguish between the vessel and the non-vessel structures specially for the abnormal images, in addition to MF, negative LoG filter which is the 2nd order derivative of Gaussian is also applied. This justification is due to the asymmetric nature in non-vascular structures and can be modeled as step or ramp functions. LoG filter gives zero response to uniform intensity region. However, when there is a variation in the intensity, it gives positive response on the darker side and negative response on the lighter side. Therefore, at a sharp intensity transition the LoG response contains zero crossing about it×³s center. This property of the LoG response is utilized to distinguish the transient like non-vessel structures from the vessels. The LoG filter kernel which is the second order derivative of the MF kernel can be mathematically expressed as(2)R(x,y)=1Ïƒ2Ï€(x2âˆ’Ïƒ2Ïƒ4)exp(âˆ’x22Ïƒ2)âˆ€|x|â‰¤3Ïƒ,|y|â‰¤L/2Here also â€˜Lâ€™ represents the length for which the vessels are assumed to have fixed orientation and â€˜Ïƒâ€™ is the spread of the Gaussian curve.Fig. 1shows the response of Gaussian, step and ramp functions to the MF and negative LoG filter. Fig. 1(a), (b) and (c) show the plot of a Gaussian function, an ideal step edge and an ideal ramp edge, respectively. Fig. 1(d) shows the MF impulse response in one dimension and response of the Gaussian function, the step edge and the ramp edge to MF are shown in Fig. 1(e), (f) and (g), respectively. The one dimensional negative LoG and its response to the Gaussian function, the step edge and the ramp edge are shown in Fig. 1(h), (i), (j) and (k), respectively. It is clear from the figure that the MF gives high response to both the vessels and the typical non-vessel structures. On the other hand, LoG filter gives high response to symmetric vessel structures and zero response about the center to the asymmetric non-vessel structures due to it×³s zero crossing property.KFCM maps the low dimensional input space to high dimensional feature space through a nonlinear mapping [7]. Let us define a nonlinear mapÎ¦:xâˆˆXâŠ†Rdâ†’Î¦(x)âˆˆFâŠ†RH(dâª¡H)where X is the original data space and F is the transformed high dimensional feature space. Since direct computation in the feature space is complex, kernel functions are used for this purpose. If Î¼ijis the membership of the ith element to the jth cluster andVjâ†’is the jth cluster center, the objective function of KFCM can be expressed as(3)JmÎ¦=âˆ‘i=1nâˆ‘j=1cÎ¼ijmâˆ¥Î¦(Xiâ†’)âˆ’Î¦(Vjâ†’)âˆ¥2The 2nd term of Eq. (3) can be expressed as(4)âˆ¥Î¦(Xiâ†’)âˆ’Î¦(Vjâ†’)âˆ¥2=(Î¦(Xiâ†’)âˆ’Î¦(Vjâ†’))T(Î¦(Xiâ†’)âˆ’Î¦(Vjâ†’))=Î¦(Xiâ†’)TÎ¦(Xiâ†’)âˆ’Î¦(Vjâ†’)TÎ¦(Xiâ†’)âˆ’Î¦(Xiâ†’T)Î¦(Vjâ†’)+Î¦(Vjâ†’)TÎ¦(Vjâ†’)=K(Xiâ†’,Xiâ†’)+K(Vjâ†’,Vjâ†’)âˆ’2K(Xiâ†’,Vjâ†’)The Gaussian kernel or the Radial Basis Function (RBF) used in this paper can mathematically be expressed as(5)K(Xâ†’,Yâ†’)=exp(âˆ’(âˆ‘j=1d|xjâˆ’yj|a)bs2)whereaâ‰¥0,1â‰¤bâ‰¤2ands>0are constants. Here,K(Xâ†’,Xâ†’)=1for allXâ†’. Euclidean distance between the two sample pointsXiâ†’andVjâ†’in the feature space is given by,(6)dÎ¦(Xiâ†’,Vjâ†’)=âˆ¥Î¦(Xiâ†’)âˆ’Î¦(Vjâ†’)âˆ¥2=2(1âˆ’K(Xiâ†’,Vjâ†’))Now Eq. (3) can be represented as(7)JmÎ¦=2âˆ‘i=1nâˆ‘j=1cÎ¼ijm(1âˆ’K(Xiâ†’,Vjâ†’))The expressions forVjâ†’and Î¼ijare obtained by differentiating the objective function as described in Eq. (7) with respect toVjâ†’(keeping Î¼ijconstant) and with respect to Î¼ij(keepingVjâ†’as constant) followed by equating them to zero (zero vector). This leads to the expressions ofVjâ†’and Î¼ijas(8)Vjâ†’=âˆ‘i=1nÎ¼ijmK(Xiâ†’,Vj)â†’Xiâ†’âˆ‘i=1nÎ¼ijmK(Xiâ†’,Vjâ†’)(9)Î¼ij=(1âˆ’K(Xiâ†’,Vjâ†’))âˆ’1/(mâˆ’1)âˆ‘l=1c(1âˆ’K(Xiâ†’,Xlâ†’)âˆ’1/(mâˆ’1)Here the parameterm(m>1)controls the amount of fuzziness of the resulting partition.This subsection presents the different performance metrics used for contrast enhancement and vessel extraction.To evaluate contrast enhancement using curvelet transform, Mean Structural Similarity Measure (MSSIM), Peak-Signal-to-Noise-Ratio (PSNR) and contrast improvement index (CII) [22] are used.1. To calculate structural similarity measure (SSIM), the image is decomposed into K blocks of sizenÃ—nand then SSIM is calculated as follows:(10)SSIM=(2xÂ¯yÂ¯+C1)(2Ïƒxy+C2)(Ïƒx2+Ïƒy2+C2)((xÂ¯)2+(yÂ¯)2+C1)wherexÂ¯andyÂ¯are the mean values, Ïƒ stands for the standard deviation in the original and the enhanced blocks and Ïƒxycorresponds to the covariance measure of the pixel intensities. The values of C1 and C2 are chosen to beC1=(0.01Ã—255)2andC2=(0.03Ã—255)2. The MSSIMis obtained by taking the average of SSIM over all the image blocks.2. For an image I of sizeMÃ—N, PSNR can be computed as(11)PSNR=10log10(MAXI2MSE)where MAXIis the maximum intensity value of the image. MSE is the mean squared error and can be computed as(12)MSE=1MNâˆ‘m=1Mâˆ‘n=1Nâˆ¥I(m,n)âˆ’Ie(m,n)âˆ¥2Here Ierepresents the enhanced image.3. Another measure for contrast enhancement is the contrast improvement index (CII) which is given as(13)CII=CenhancedCoriginalwhere Cenhancedand Coriginalare the contrast of the original and the enhanced image, respectively. The contrast C of an image can be defined as(14)C=râˆ’br+bwhere r and b represent the mean gray level value of the foreground and the background, respectively.Performance of vessel extraction is quantified by three matrices, namely True Positive Rate (TPR), False positive Rate (FPR) and Detection Accuracy (ACC). True Positive (TP) and True Negative (TN) indicate the number of pixels correctly classified as vessel and background pixels, respectively and False Positive (FP) and False Negative (FN) indicate the number of pixels erroneously detected as vessel and background pixels, respectively. TPR, FPR and ACC can be described as follows:(15)TPR=TPTP+FN(16)FPR=FPFP+TN(17)ACC=TP+TNTP+FP+TN+FNPerformance evaluation also includes sensitivity (normalized measure of TPs) and specificity expressed as(18)Sensitivity=TPTP+FN=TPR(19)Specificity=TNFP+TN=1âˆ’FPR

@&#CONCLUSIONS@&#
