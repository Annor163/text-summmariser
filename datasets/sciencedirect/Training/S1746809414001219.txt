@&#MAIN-TITLE@&#
A comparison of open-loop and closed-loop stimulation strategies to control excitation of retinal ganglion cells

@&#HIGHLIGHTS@&#
We investigate the advantages of using a closed-loop strategy in neuroprosthetics.We set stimulation level based on continuous measurement of neural activity.We use Kalman decomposition to control controllable and observable part.Closed-loop performs better than open-loop when perturbations are introduced.

@&#KEYPHRASES@&#
Vision,Retina modelling,Bionic implants,Neuroprosthetics,Feedback,Stimulation strategy,

@&#ABSTRACT@&#
Currently, open-loop stimulation strategies are prevalent in medical bionic devices. These strategies involve setting electrical stimulation that does not change in response to neural activity. We investigate through simulation the advantages of using a closed-loop strategy that sets stimulation level based on continuous measurement of the level of neural activity. We propose a model-based controller design to control activation of retinal neurons. To deal with the lack of controllability and observability of the whole system, we use Kalman decomposition and control only the controllable and observable part. We show that the closed-loop controller performs better than the open-loop controller when perturbations are introduced into the system. We envisage that our work will give rise to more investigations of the closed-loop techniques in basic neuroscience research and in clinical applications of medical bionics.

@&#INTRODUCTION@&#
Most currently used stimulation strategies for medical bionic devices rely upon open-loop control of the stimulation levels. The open-loop strategies may involve the machine-learning of the algorithm parameters or changing the algorithm parameters based on the patient's performance (slow-time scale); however, these strategies do not change stimulation parameters on a pulse-by-pulse basis in response to the evoked activity (fast-time scale), i.e., the level of stimulation does not change in response to any continuous measurement of the level of neural activity that is generated.While many stimulation strategy algorithms in bionic devices have been successful using open-loop techniques [5,11,25], the outcomes differ from patient to patient [1,8,27,36,43]. For example, the benefits of the cochlear implant may vary even among patients with similar otologic pathologies and with the same type of the cochlear implant system [36].It has been shown that a customized controller in a bionic device allows the manipulation of specific patient-based neural responses [2,38]. By monitoring neural response and adjusting stimulation parameters using closed-loop control techniques, it is possible to optimize the stimulation on-line based on the acquired data. More effective stimuli are delivered by utilising neuronal recording in a feedback loop to control neurostimulation on a continuous basis. At present, to fit stimulation parameters requires repeated patient's visits to a clinic. This is a major commercial impediment and the parameter's optimization is done in a sub-optimal way. Closed-loop techniques may minimize the time to fit stimulation parameters while in a clinic. Additional benefits of using feedback in neuroprosthetic stimulation may include selective and controlled effects on populations of neurons, directing the electric current based on the response of the targeted neural elements, and reduction in power consumption, since a stimulator is activated only when required, delivering the precisely required amount of electrical stimulation to the targeted location [47].Closed-loop stimulation paradigms have been realized in some clinical applications, including neuromuscular stimulation in paraplegic subjects [2] and to control neural activity in epilepsy patients [12]. Closed-loop strategies have been used in vivo in animal models to control muscle excitations [13], to control the heart rate by electrical stimulation of the vagus nerve [46], and to modulate seizure activity [32,35]. Closed-loop controllers have been used in vitro to adjust stimulation current to maintain the average firing rate at a desired inter-spike-interval [31], to correlate the spike timing between sets of arbitrary neurons [34], to control the firing rate of a neuron [31], to control the instantaneous response probability of a neuron [50], to control bursting dynamics in cortical cultures [49], and to identify different visual stimulus patterns that yield the same neuronal response [4].Closed-loop control techniques to control neural activity have been investigated through simulation studies [17,20,41,47]. Computer simulations of closed-loop techniques explored the possibilities to mimic the restoration of thalamocortical capabilities [17], to control simulated limbs movement [33], to adjust stimulation parameters to reduce simulated oscillatory neuronal activity [10,41], and to control motion of a musculoskeletal system using a multilayer perceptron network feedforward controller combined with a feedback controller [37].Various measures of the neuronal response can be taken into account for the closed-loop control and different performance measures can be incorporated. Closed-loop output measurements include ECoG signals [12], firing rate of individual neurons [50], spike timing of individual neurons [34], inter-spike-intervals [31], and electrical activity of population of neurons recorded with multi-electrode array [49]. Closed-loop performance measures included difference between target and average achieved median firing rate [49], percentage of decrease in seizure frequency [12], speed of correcting errors, and robustness of the system for different controller gains [31].While feedback control plays a fundamental role in modern technological systems [16] and has many desirable properties including the capacity to improve robustness with respect to disturbances, to decrease sensitivity to model errors, and to stabilize an unstable system, its full advantages have not been utilized in medical bionic devices. In this study, we present a comparison of closed-loop and open-loop stimulation techniques to control neural activation in the retina. We investigate through simulation the advantages of using a closed-loop strategy; in particular, we demonstrate the controller's robustness to disturbances and parameter uncertainties. Our motivation comes from retinal prostheses applications [51,43].We propose a model-based controller design for controlling activation of surviving neurons in people with retinitis pigmentosa (RP) and age-related macular degeneration (AMD). RP and AMD are examples of retinopathies that involve photoreceptor loss leading to eventual loss of vision. Postmortem analysis of the retinae of RP and AMD patients reveals that a large number of retinal neurons survive [26,28,29]. It has been shown that it is possible to elicit a sensation of light in RP and AMD patients by electrically stimulating the surviving neurons in the retina by means of visual prosthetic devices [3,21]. Electrical stimulation of a small area of neuronal tissue in the vicinity of each electrode may create light perception, called a phosphene. To adjust the size and brightness of the phosphene, stimulation parameters are currently adjusted post-operatively, with associated potential difficulties due to limited time available with patients and clinical resources. When several electrodes are stimulated simultaneously, the phosphene size and brightness may change depending on the combination of active electrodes. Testing visual perception on the activation of all possible electrode combinations may take a significant amount of time, and becomes impractical as the number of electrodes increases. Challenges of adjusting stimulation parameters post-operatively include difficulties quantifying and measuring patient's perception, a large number of degrees of freedom, the complexity of the responses, and changes in neuronal responses over time.The electrophysiology and topology of retinal neurons pose issues that are specific to this particular neural application. The first issue is a high density of RGCs compared to a low number of electrodes. A large difference between the density of electrodes and the density of neurons, in our case, leads to lack of controllability and observability of the whole system due to the fact that neurons are not interconnected. While control of individual neurons is not possible, to deal with a system that has a much smaller number of actuators and sensors (electrodes) than the number of systems states (neurons), we use Kalman decomposition to control a linear combination of neuron states of the system that correspond to a controllable and observable subspace in our model. We assume that the retinal ganglion cells (RGCs), the output neurons of the retina that transmit visual information to the brain, are not connected to each other. They act as outputs of communication buses that transmit information in parallel and do not exchange signals between each other. This known to not be the case because of gap junctions connecting the same ganglion cell types, but these are assumed not to play an important role and are neglected in the present analysis.The main contribution of this paper can be summarized as follows. We propose the use of a model-based closed-loop design (a linear quadratic regulator in combination with a feedforward controller) to adjust stimulation parameters based on a linearized model of neural dynamics and a desired reference signal. To deal with the lack of controllability and observability of the whole system, we use Kalman decomposition and control only the controllable and observable part. Then, the dynamics of a linear combination of neurons (that represent the controllable and observable subspace of the system) can be controlled. In simulations, we are able to achieve acceptable performance despite a small number of actuators and sensors. We show that the closed-loop controller performs better than the open-loop controller when perturbations are introduced into the system. We envisage that our work will provide a better understanding of the opportunities and limitations of the closed-loop control, leading to more research and clinical investigations on the use of closed-loop techniques in bionic devices.The paper is organized as follows. In Section 2, we derive a simple model suitable for the controller design and describe the feedback system set-up. In Section 3, we present the results of the simulations. Discussion and conclusions are given in Section 4.

@&#CONCLUSIONS@&#
This paper provides a proof of principal of benefits for a closed-loop stimulation strategy to be used in a bionic device. This computational study is the first step towards potential clinical implementation of such stimulation paradigms. Benefits of computational models include relative ease of manipulations of the parameters of stimulation and making concrete predictions of the stimulation effect on the neural response.We propose a simple linear model of neural activation for a model-based closed-loop controller design to adjust stimulation parameters dynamically based on the response of retinal neurons. Using Kalman-decomposition techniques, we are able to control linear combination of neurons and achieve acceptable performance. Our findings suggest that the closed-loop stimulation strategy offers some advantages over the open-loop strategy. We show that the closed-loop controller performs better than the open-loop controller when disturbances are introduced into the system.A fundamental problem to convey sensory information using a bionic implant is to understand how electrical stimulation affects neurons. Biological systems are complex, and many approximations and simplifications are usually done in order to build a model of the neural response to electrical stimulation. The choice of the model used in this study is based on the fact that linear models are easier to analyze for the observability and stability criteria. It has been shown that linear models approximate well the individual ganglion cells response to electrical stimulation [22]. In addition, linear models offer a wider range of controllers that can be implemented. Note that in this work, we assumed that the neural activity can be described by the continuous intracellular membrane potential, whereas the measurements that are realistically accessible to a neuroprosthetic device are discrete spikes, from which the response strength can be estimated by averaging over time or a population of neurons. This extension is left for future research.Closed-loop strategy presented here compares more favorably to the open-loop strategy. Open-loop controllers can work well when the model of the system is known and the disturbances are measured. Often, an open-loop controller signal is found by inverting the model. In our case, however, due to model imperfections and unknown disturbances the open-loop controller performance is not satisfactory. On the other hand, the closed-loop controller shows robustness to model perturbations.Closed-loop dynamic clamp is a standard procedure to measure ionic channel conductance [39,42]. However there are many challenges to implement this method in clinical practice. While it is unlikely that many cells are controllable in a dynamic clamp individually, it is realistic that future prostheses can record neuronal activity extracellularly. However, this comes with many challenges including reliable on-line spike sorting and passing axons stimulations. A publication by Jepson et al. [22,23] shows how retinal ganglion cells can be controlled individually using multi-electrode array stimulation.Feedback systems can be realized using standard in-vitro equipment. However, feedback strategies in neuroprosthetics have not been extensively investigated. A shift in paradigm to real-time closed-loop electrophysiology may provide many insights. With recent advancements in microelectronics, it may become feasible to test a range of closed-loop stimulation strategies in clinical settings in the near future. The ability to continuously collect and analyze data may improve the monitoring of the disease progression and optimize the therapy efficacy. Novel sensing elements that measure electrochemical concentration may lead to stimulation paradigms that combine electrical stimulation with a drug delivery system.A direct representation of neural activity as a gray scale image may not necessarily be the best approximation of the resulting perception of a patient. However, there is no clear measure of the subject's perception in simulations. The measure of algorithm's performance as a grey scale image quality was taken as an approximation.In this work, step-wise constant presentations of the stimuli were considered. Real-life applications will involve dynamic stimuli that may cause time delay in the feedback system. Sufficient robustness conditions have to be derived under which the system remains stable, independent of the length of the delay. Some approaches for stabilization are introduced by Verriest et al. [48].For safety reasons, short charge-balanced biphasic pulses are used in neuroprosthetic devices. In this paper, we implemented long monophasic pulse stimulation. We do not expect that this approximation will affect the results significantly. Future work include analyzing the response of neurons to different frequencies of stimulation, and investigating the effect of novel waveform shapes such as seesaw and sinusoids. In addition, maximum stimulation level, bandwidth limitations, the effects of the electrode geometry, and power requirements have to be investigated before implementing feedback controllers in clinical settings.