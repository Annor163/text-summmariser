@&#MAIN-TITLE@&#
WM-DOVA maps for accurate polyp highlighting in colonoscopy: Validation vs. saliency maps from physicians

@&#HIGHLIGHTS@&#
We present WM-DOVA energy maps highlighting image areas likely to contain a polyp.We present the first available database with clinical metadata associated.WM-DOVA maps outperform other localization methods in two different databases.WM-DOVA performs similar to clinicians when searching for polyps in full sequences.Our maps outperform other saliency models, best candidates for clinical practice.

@&#KEYPHRASES@&#
Polyp localization,Energy maps,Colonoscopy,Saliency,Valley detection,

@&#ABSTRACT@&#
We introduce in this paper a novel polyp localization method for colonoscopy videos. Our method is based on a model of appearance for polyps which defines polyp boundaries in terms of valley information. We propose the integration of valley information in a robust way fostering complete, concave and continuous boundaries typically associated to polyps. This integration is done by using a window of radial sectors which accumulate valley information to create WM-DOVA (Window Median Depth of Valleys Accumulation) energy maps related with the likelihood of polyp presence. We perform a double validation of our maps, which include the introduction of two new databases, including the first, up to our knowledge, fully annotated database with clinical metadata associated. First we assess that the highest value corresponds with the location of the polyp in the image. Second, we show that WM-DOVA energy maps can be comparable with saliency maps obtained from physicians’ fixations obtained via an eye-tracker. Finally, we prove that our method outperforms state-of-the-art computational saliency results. Our method shows good performance, particularly for small polyps which are reported to be the main sources of polyp miss-rate, which indicates the potential applicability of our method in clinical practice.

@&#INTRODUCTION@&#
Colon cancer is nowadays the fourth cause of cancer death worldwide. In 2012, an estimated number of 746.298 cases were diagnosed with colorectal cancer (CRC) and a total number of 373.631 died of the disease [1]. CRC's survival rate depends on the stage it is detected on, going from rates higher than 95% in early stages to rates lower than 35% in latter ones [2], hence the necessity of an early colon screening.Clinical guidelines based on scientific evidence recommend screening with colonoscopy which allows the identification and removal of polyps, which are the first step in the sequence ‘adenoma’ – ‘high grade dysplasia’ – ‘carcinoma’, leading to the development of CRC [3,4]. Conventional colonoscopy is currently the most precise procedure for early CRC detection and prevention, demonstrating several prospective studies with a large number of cases that conventional colonoscopy with polypectomy reduces CRC's incidence by 40–90% [5,6]. However, colonoscopy presents some drawbacks being polyp miss-rate the most relevant – reported to be as high as 22% [7] – resulting in a lack of total effectiveness of colonoscopy [8]. The miss-rate increases significantly in smaller sized polyps (2% for adenomas ≥10mm versus 26% for adenomas <5mm) [9] and this is meaningful in clinical practice because the prevalence of high grade dysplasia among patients with adenomas is related to the polyp size, with figures that vary from 50% in adenomas larger than 10mm to 16% in adenomas between 6 and 9mm [10].Other alternatives proposed for CRC screening are colon capsule endoscopy and CT colonography but they present a lower accuracy for small polyps detection and do not allow to obtain histological confirmation. These data reinforce the need to improve the detection rate of polyps at colonoscopy in order to be able to remove all small adenomas.In this sense, there has been an increasing effort during last years on exploring the use of intelligent systems to provide additional information to the output of colonoscopy [11], including the task of automatic polyp localization. The contributions of this paper go in this direction and they are two-fold: (1) The introduction of Window Median Depth of Valley Accumulation (WM-DOVA) energy maps as a tool for automatic polyp localization in colonoscopy images, and (2) the definition of the, up to our knowledge, first validation framework over a fully annotated database and over visual saliency maps created from physicians’ fixations obtained via an eye-tracker device and state-of-the-art computational saliency models. Two new databases are introduced: (1) CVC-ClinicDB which is the only fully annotated database with clinical metadata associated and (2) CVC-EyeTrackerDB which contains annotations of polyps throughout all the frames in the sequence and information about physicians’ fixations when observing these sequences.Our polyp localization method takes as input a colonoscopy frame, and it offers as output image an energy map in which high energy concentration is related with high likelihood of polyp presence. Our method is based on a model of appearance for polyps, which characterizes polyp boundaries by using valley information. The energy maps obtained by our method are validated in two ways: (1) We check whether the maximum of the maps coincides with the polyp location in the image, and (2) we assess whether their energy distribution has correspondence with visual saliency models from physicians fixations and state-of-the-art saliency models. As our method is based on valley information associated to polyp boundaries, our model also considers the impact of different elements of the scene with valley information associated. In the next subsection we make a review of existing methods on the characterization of different elements of the endoluminal scene.The different elements that appear on the endoluminal scene are: (1) lumen; (2) wrinkles and folds; (3) blood vessels; (4) polyps; (5) fecal content, and (6) specular highlights [11]. We focus our review on available methods for polyp localization, but also on two other elements with valley information associated: specular highlights and blood vessels.The majority of the works related to polyp characterization are based on the calculation of a certain feature descriptor over the image to support the final decision about polyp presence. Existing approaches are divided in two groups: (1) shape-based; and (2) texture and color-based. Shape-based approaches aim to search in colonoscopy frames those specific shapes that polyps commonly have. This group can be divided into two categories: detection by curvature analysis and by ellipse fitting. The first subgroup cluster a series of methods which observe the curvature value of the boundaries observed in the image, which are obtained generally using low-level image processing operations such as gradient, edges or valley information. Methods belonging to this category include the works of [12,13] or [14]. The second group of methods assumes that polyps tend to have elliptical shape. Examples belonging to this group can be found in the work of [15] or at [16]. Finally some other works like the one proposed in [17] combine both curvature analysis and shape fitting to detect polyps in the image whereas other methods [18,19] base their localization of polyps in the pure analysis of low-level features of the image such as valleys or edges. The use of texture and color-based approaches in polyp characterization has been gaining interest during the last years. Some works are based on the use of wavelet descriptors – such as [20] – paying attention on the detail and approximation coefficients of the wavelet transform. Other alternatives include the use of local binary patterns [21] or co-ocurrence matrices [22]. Finally an interesting approach is the use of several texture and color MPEG-7 descriptors to build up polyp detection methods [23]. One big drawback of this group of methods is that they tend to need of an exhaustive training and they are very sensitive to parameter tuning.We propose in this paper our Window Median Depth of Valleys Accumulation method (WM-DOVA), which can be enclosed into the shape-based group. Although WM-DOVA shares similarities with some available methods in the use of low-level image processing [12], our method is the only one which also searches for concavity of boundaries and considers other elements of the scene such as blood vessels and specular highlights. WM-DOVA also admits variable polyp shapes, unlike other methods [15,16] which are specifically focused on elliptical shapes. In addition, WM-DOVA also integrates color information for discarding those valleys originated by blood vessels.One big problem when comparing different approaches is the lack of a public fully annotated database [18]. Nevertheless none of the published methods consider clinical impact of polyp localization, since the databases used in the experiments do not convey any kind of clinical information regarding polyp size or type. In order to solve this we contribute in this paper with the introduction of the CVC-ClinicDB11CVC-ClinicDB is currently available at http://www.polyp2015.com/wp/?page_id=141 and at http://mv.cvc.uab.es.database, built in collaboration with Hospital Clinic of Barcelona, Spain.The output of a valley detector gives response both inside the specular highlight and in a neighborhood of pixels around it, impacting the performance of algorithms relying on valley information such as the one we propose. In order to mitigate their impact two different operations must be performed: (1) detection of specular highlights, and (2) inpainting, defined as the substitution of the specular highlight area to avoid the apparition of valley information.We find several related works in the literature regarding specular high-lights detection, such as the work of [24] which assign sudden color changes to highlights, or the works of [25–27], which exploit the definition of specular highlights as a combination of diffuse and specular reflection. Other methods offer a combined solution for detection and inpainting, although some of them [25,26] are not suitable for our case since there is no non-overexposed channel from which to extract information needed for inpainting. Finally, there are two works that present a solution for both detection and inpainting in colonoscopy images [19,28] with high reported accuracy against general methods.The majority of the literature regarding the presence of blood vessels is related to their segmentation and consequently different methods have been proposed [29] in non endoscopy domains. In our particular case we are not concerned on blood vessels segmentation but on their contribution in terms of valley information, and taking this into account, we opted to study if their impact changed according to the color space we were working with, as a way to mitigate their presence. Current experimental results [19] show that by using the channel B of the standard RGB image we both enhance polyp-related valleys and mitigate blood vessels valleys.We present in this section WM-DOVA energy maps which are based on an extended model of appearance for polyps.In order to build up our model we consider both the physical model of a polyp along with how colonoscopy images are acquired. In our model we consider polyps as abnormalities that appear as protruding surfaces on the colon wall. Polyps create a sloping surface in their union with the colon wall.This surface generates a contour around the polyp which is meant to delimit the polyp from the colon wall. The contour can be approximated as a closed and continue curve with smooth curvature profile. Taking this into account, we can approximate polyps as spheres, with some degree of deformation embedded on the colon wall.Regarding image acquisition, colonoscopes have a light source and a camera, both attached and pointing in the same direction towards the colon walls. This can be approximated as illuminating a tubular surface with an axial light. Thus, surfaces with their normals oriented in the same direction as the pair light-camera appear brighter as they reflect the incident light towards the camera. Conversely, as we deviate from this situation, the amount of light reflected decreases [18].Given this model, we consider three different scenarios: (1) optimal scenario (with respect to model fitting), with a complete zenithal view of the polyp (see Fig. 1(a)); (2) semi lateral view of the polyp (see Fig. 1(b)) and (3) lateral view of the polyp (Fig. 1(c)).In zenithal view, the normal at the polyp center shares orientation with normals on the colon wall so polyp surface will appear with high intensity value due to maximal reflection. Conversely, polyp frontier appears dark since its normal deviates from the wall's normal. If we move from the center of the polyp towards its boundary, the corresponding intensity profile will constitute a valley, as can be observed in Fig. 1(b). Consequently, polyps in zenithal views appear as surrounded by intensity valleys.As we deviate from the optimal scenario, the orientation of the pair light-camera diverts from the orientation of the normal on the colon wall (semi lateral view, Fig. 1(c)). The worst possible scenario will happen when the camera looks laterally at polyps while looking in parallel to the colon axis (lateral view, Fig. 1(e)). Even in semi lateral and lateral views valley information is still present. In semi lateral views valleys are present in both extremes of the polyp profile as long as some part of the colon wall can still be observed. In lateral views, the valley behind the polyp is substituted by a steep contour which separates the lumen from the polyp (Fig. 1(f)).In conclusion, our model implies that polyps are surrounded completely by valleys in zenithal views and partially when they are viewed laterally. Valleys surrounding the polyp will constitute a closed curve which can be partial or completely closed. This curve will appear as concave from inside the polyp. The intensity and strength of the valley depends greatly on the direction of the illumination and on how protruding is the polyp. Considering this, according to Paris classification criteria [30] our model fits completely to polyp appearances of types Is, IIa, IIb, and Ip polyps in zenithal view, and partially to polyps in lateral and semi lateral views.Unfortunately polyps are not the only source of valley information (see Fig. 2). Both specular highlights and blood vessels convey valley information that should be treated properly in order not to have an impact in polyp localization results. Image preprocessing is performed to mitigate impact of non-polyp valleys. Preprocessing is also used here to eliminate some image artifacts that are caused by the image acquisition system. We apply four different preprocessing operations: (1) image deinterlacing to remove artificial valleys created by time difference in the acquisition of the odd and even lines of a frame; (2) specular highlights detection and inpainting; 3) Black mask inpainting, and (4) blood vessels mitigation by using channel B of sRGB image. The interested reader can find more details about these operations in [19].Once image preprocessing operations are applied to the colonoscopy frame, we need to obtain the valley information which will be used to characterize polyp boundaries. Consequently, the use of a valley detector is crucial in our localization scheme. There are several approaches for valley detection in the literature but we opt to use a geometrical valley detector [31] which adjusts better to the structures we are searching in the image. This valley detector succeeds at localizing the valleys in the image but it does not give enough information of the depth of the valley, i.e., the strength of its contribution.To cope with this, we developed the Depth of Valleys image (DV image) [18] which combines valley information – from the valley detector [31] – with gradient information – via morphological gradient. The DV is achieved through the pixel-wise multiplication of the ridges/valleys detector and morphological gradient in the following way:(1)DV=Vσd,σiMG=Vσd,σiI⊕Cσi−I⊕Cσiwhere V stands for the output of valley detector, I for the original input image and C for the disk structuring element used in the dilation (⊕) and erosion (⊖) morphological operations. Formulated in this way, DV image has higher values in the points that constitute the relevant valleys of the image. It must be noticed that, in order to calculate the morphological gradient, the ridge and valley extractor needs two parameters – differentiation σdand integration scales σi– that must be set in correspondence to the size of the structuring element (sd) [31]. More precisely, σishould span the same size as sdto both work in the same scale.The basic idea of our localization method is that, as our model defines polyps as surrounded by intensity valleys, any given pixel in the image inside a valley structure is prone to be part of the polyp. WM-DOVA energy maps are created to integrate valley information in a way such polyp boundaries are fostered. High energy areas of WM-DOVA energy maps are meant to be related with areas with high likelihood of polyp presence. In order to favor polyp boundaries against other structures in the image, WMDOVA applies four different constraints to boundary candidates, namely: completeness, robustness, continuity and concavity.Our model states that polyp boundaries tend to be complete, that is, a pixel inside the polyp should be surrounded by valleys in the majority of directions. In order to favor complete boundaries from those which only have contribution in a few directions we use the following approach: we define a ring of radial sectors centered on each pixel in the image and we accumulate DV values for all the sectors. As our DV image has been defined to enhance deep valleys, we only accumulate the maximum of DV image under each sector. In this way we are fostering boundaries composed by pixels with high DV value which have contribution for a high number of directions. We can see an example of this in Fig. 3(a and b), where we can observe that the maximum of accumulation is higher for a more complete boundary than for the incomplete one.Our system should discard contributions from boundaries composed by pixels with high DV value concentrated in a few directions against contributions from boundaries composed by pixels with lower DV value comprising the majority of directions. To achieve this, we apply a median operation to the final value to be accumulated. By doing this, we penalize those undesired boundaries such as the one shown on the right part of Fig. 3(c–d). We can observe in Fig. 3(d) that the accumulation is higher for the circular (complete) boundary, although it is composed by pixels with lower DV value.WM-DOVA energy maps should favor continuous boundaries against discontinuous. This is achieved by the use of an angular median operator Med. The angular median calculates the median of the distances from the maximum of DV under each sector to the center of the ring of sectors, for a given number of sectors 2ws+1. This operator favors the contributions of consecutive sectors having the maximum of DV at a similar distance to the center. We can see an example of how this is fostered by observing Fig. 3(e). We can observe how the synthetic boundary on the right is composed by two incomplete boundaries which do not have a maximum of DV at the same distance to the center. By applying the angular median, the maximum of accumulation for this boundary will be very low, as the median of distances to the center between two adjacent parts of the two boundaries will be between both of them, hence mitigating their contribution to the final accumulation value, as it can be seen in Fig. 3(f).The final condition that our model imposes is that boundaries should be locally concave from the point of view of a pixel inside the polyp, which implies that if we take a window of sectors comprising several directions, the distance from the boundary candidate for a given direction to the median of distances under the window should be small. We use the median of the distances to the center as exposed before but in this case we calculate a pondering factor which will modify the contribution of maximum of DV under each sector. This pondering factor will depend on the distance from the maximum under the current sector to the median of the distances for the considered window of sectors. By applying this pondering factor we favor boundaries such as the ones shown in the left part of Fig. 3(g), as in this case all the pixels constituting the boundary have a more similar distance to the center than those in the right part of the figure. WM-DOVA energy maps will be consequently more focused on concave boundaries than to those locally convex, as can be observed in Fig. 3(h).By imposing the four mentioned constraints we help also to mitigate the impact of other elements of the endoluminal scene. The definition of the window of radial sectors helps to mitigate response of blood vessels or folds as its contribution in terms of DV image will happen only in a few directions and without concave profile. The use of the median in the accumulation has also effect in the removal of the contribution of spurious valleys that can appear due to non-homogeneous illumination.As mentioned above, WM-DOVA defines a window of 2ws+1 sectors which integrates the information of neighboring ring sectors fostering in this way concavity and continuity. To ease the comprehension of the WM-DOVA algorithm we will support on the graphical example shown in Fig. 4, in which the black contour is a binary approximation of the DV output for a polyp contour. For each pixel p in the image, the WM-DOVA algorithm consists of 4 different steps:1.Calculation for each sector Siof the following: (a)Simax=maxSi(DV)as the maximum of DV under sector Si; (b)pSimax=argmaxSi(DV)as the position of the maximum of DV under sector Si; and (c)di=dist(p,pSimax)as the distance between current pixel p andpSimax.Definition of a window of width 2ws+1 sectors centered on Si(Fig. 4(b)).Calculation of the contribution ofSimaxin the final accumulation value. To do so we first obtaind˜i=Meddj, with j∈[i−ws, i+ws], as the angular median of the distances dj to p for the window of sectors centered on Si(Fig. 4(c)).Then we calculate a pondering factor γi which is calculated as follows:(2)γi=11+di−d˜i/d˜iwith γi∈[0,1]. γi is a mitigation coefficient which penalizes isolated high DV values which break the continuity of the contour. On the one hand, if the distancepSimaxfrom the current pixel toSimaxis similar tod˜I, there will be no mitigation. On the other hand, in cases like the one shown in Fig. 4(c) wherepSimaxis substantially higher thand˜I, the correspondingSimaxvalue will be mitigated, as γi will be low. The final contribution ofSimaxto the final accumulation value is calculated as follows:(3)Sˆimax=γiSimaxWM-DOVA also favors concavity since for the case of locally circular contours the line that joins the maxima of DV under the sectors of the window tends to coincide with the boundary (particularly true for polyp contours).Calculation of the final accumulation value for pixel p as:Accp=Medi(Sˆimax),withi∈1,ns.WM-DOVA needs of three different parameters: (1) minimum radii of the sectors (radmin); (2) maximum radii of the sectors (radmax), and (3) Width of the windows of sectors (ws). The number of sectors nshas been set to 180 aiming to cover all the needed different directions. Regarding the scale at which WM-DOVA works, we want to stress that parameters radmin and radmax are not actually defining a particular scale but a range of scales. This allows the method to detect both small and large polyps. Should radmin be smaller, directional information would be lost due to the smaller number of pixels in the lower part of the sector.As WM-DOVA has been built according to our model of appearance of the polyps, the maxima of the WM-DOVA energy map should fall inside the polyp. Our polyp localization processing scheme therefore consists of preprocessing the input image by applying the different operations explained in Section 2.1, and then DV image is calculated. Finally WM-DOVA energy maps are generated. We can see a complete example of the different steps in Fig. 5.

@&#CONCLUSIONS@&#
