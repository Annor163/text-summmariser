@&#MAIN-TITLE@&#
Inverse portfolio problem with mean-deviation model

@&#HIGHLIGHTS@&#
An inverse mean-deviation portfolio problem finds a deviation measure for a given optimal portfolio.Necessary and sufficient conditions for the existence of such a deviation measure are obtained.The deviation measure can be represented in the form of a mixed CVaR-deviation.For n risky assets, it is determined by a combination of n+1 CVaR-deviations.If the number of CVaR-deviations is constrained, an approximate deviation measure is found.

@&#KEYPHRASES@&#
Risk preferences,Portfolio optimization,Deviation measure,Conditional value-at-risk,

@&#ABSTRACT@&#
A Markowitz-type portfolio selection problem is to minimize a deviation measure of portfolio rate of return subject to constraints on portfolio budget and on desired expected return. In this context, the inverse portfolio problem is finding a deviation measure by observing the optimal mean-deviation portfolio that an investor holds. Necessary and sufficient conditions for the existence of such a deviation measure are established. It is shown that if the deviation measure exists, it can be chosen in the form of a mixed CVaR-deviation, and in the case of n risky assets available for investment (to form a portfolio), it is determined by a combination of (n+1) CVaR-deviations. In the later case, an algorithm for constructing the deviation measure is presented, and if the number of CVaR-deviations is constrained, an approximate mixed CVaR-deviation is offered as well. The solution of the inverse portfolio problem may not be unique, and the investor can opt for the most conservative one, which has a simple closed-form representation.

@&#INTRODUCTION@&#
Understanding and modeling of individual risk preferences has long been a central venue in decision sciences, finance, and economics. A general approach is to introduce a system of axioms on preference relations that agree with “rational” behavior and then to construct a numerical equivalent (representation) to that system, so that given a choice of several random variables, a decision maker compares only their numerical equivalents. For example, the celebrated von Neumann and Morgenstern’s theory [12] introduces axioms of completeness, transitivity, continuity, and independence and shows that the decision maker needs to deal only with expected utilities. A change in the system of axioms leads to another numerical equivalent that results in possibly different decisions. Since Neumann and Morgenstern’s seminal work [12], similar choice theories such as the prospect theory [7], the dual utility theory [20], and the regret theory have emerged. However, none of their axiomatic systems are in complete agreement with empirical evidence, which is known as axiom violations or paradoxes. Even if a particular decision maker does agree on a proposed system of axioms on preference relations, still there is a wide class of possible numerical equivalents (utility functions) that represent the system, so that finding a particular numerical equivalent amounts to a tedious questionnaire procedure. A different approach was proposed by Markowitz [10], who suggested that portfolios of risky assets can be ordered at least partially based on two quantities: mean and standard deviation of portfolio rate of return. The approach reduces mean–variance portfolio selection to a simple quadratic programming problem and also leads to a convenient capital asset pricing model (CAPM). However, the simplicity of this approach has proved to be both its advantage and disadvantage. The extensive body of empirical and theoretical research shows that standard deviation is hardly an appropriate measure of risk and that a market portfolio, predicted by the mean–variance approach to be held by all investors, is only a theoretical concept (a real market index does not follow from the mean–variance approach). General measures of deviation introduced by Rockafellar et al. [14,15] address main shortcomings of standard deviation: they are not symmetrical with respect to ups and downs of a random variable and provide sufficient flexibility in customizing individual risk preferences. Let a random variable X represent the portfolio return. A Markowitz-type portfolio selection problem replaces standard deviation by a general deviation measureD:(1)minX∈VD(X)subject toEX⩾π,where π is a desired expected return, andVis a feasible set of portfolio returns. Rockafellar et al. [17,16] generalized the one-fund theorem and CAPM, originally established for (1) with standard deviation, for an arbitrary deviation measure. Also, if each investor believes in the mean-deviation paradigm [4] and has a corresponding deviation measure as a numerical representation of his/her risk preferences then there exists a market equilibrium (see [18]), and, moreover, a group of investors can form a cooperative portfolio that satisfies (1) with a “cooperative” deviation measure (see [5]). However, as in the aforementioned utility theories and in contrast to the Markowitz’s mean–variance approach, a variety of deviation measures brings the question of choosing appropriate deviation measure for each investor. Partially, this question was answered in [3] by establishing a one-to-one correspondence between the class of alpha-concave distributions and the class of comonotone deviation measures via the maximum entropy principle. However, the resulting deviation measure reflected the “average” preferences (of the market as a whole) rather than preferences of an individual investor.A different perspective to this question could be offered through an inverse approach. Instead of agonizing over idealized postulates of rational behavior, an investor can identify his/her risk preferences in the form of a set of benchmarks (portfolios, financial instruments, assets, etc.) that he/she is relatively satisfied with. This work solves the inverse portfolio problem: given a convex set of bounded portfolio returnsVand a portfolio returnX∗∈V, find a deviation measureD∗such that X∗ is optimal for (1) withD∗. An approximate solution to this problem was given in [8], where a set of feasible deviation measures was confined to linear combinations of conditional value-at-risk (CVaR) deviations for certain risk-tolerance levels or, equivalently, to so-called mixed CVaR-deviations. However, an approximateD∗substantially depends on the choice of the risk-tolerance levels and on an error measure for residuals. Here, it is proved that “exact”D∗exists for every risk-averse investor,1An investor is risk-averse, if the return X∗ of the portfolio he/she holds is undominated in the sense of second-order stochastic dominance (SSD); see Section 2 for the exact definition.1and that, indeed, the set forD∗can be narrowed down to mixed CVaR-deviations. However,D∗may not be unique, and it is suggested that in this case, the investor takes the supremum over all possible deviation measuresD, such that X∗ is optimal for (1) withD. Remarkably, this supremum admits a simple closed-form representation in the form similar to a worst-case mixed-CVaR deviation. In addition, given T scenarios for asset returns, an algorithm for findingD∗in (1) in the form of mixed CVaR-deviations is provided, and if the number of CVaR-deviations is constrained, an alternative approach to constructing an approximate deviation measure is also presented.This work is organized into seven sections. Section 2 reviews basic notions of general deviation measures. Section 3 formulates and solves the inverse portfolio problem. Section 4 addresses the inverse problem for scenario-based portfolio selection. Section 5 finds an approximate deviation measure in the form of mixed CVaR-deviation with specified number of risk-tolerance levels. Section 6 constructs a risk-envelope representation for a non law-invariant deviation measure provided that law-invariant one does not exists. Section 7 concludes the work.Let(Ω,M,P)be a probability space, where Ω denotes the designated space of future states ω,Mis a field of sets in Ω, andPis a probability measure on(Ω,M). A random variable (r.v.) is considered to be an element ofL2(Ω)=L2(Ω,M,P). FX(x) and qX(α)=inf{x∣FX(x)>α} will denote the cumulative distribution function (CDF) and quantile function of an r.v. X, respectively. Also, C will denote a constant in the real numbers. The relations between r.v.’s are understood to hold in the almost sure sense, e.g., we write X=Y ifP[X=Y]=1and X⩾Y ifP[X⩾Y]=1. The probability space Ω is called atomless, if there exists an r.v. with a continuous CDF. This implies existence of r.v.’s on Ω with all possible CDFs (see e.g. [2]).Definition 1general deviation measuresA deviation measure is any functionalD:L2(Ω)→[0,∞]satisfying2In [14,15], axiom D4 was not included in the definition. Deviation measures satisfying D4 were called lower semicontinuous deviation measures.2(D1)D(X)=0for constant X, butD(X)>0otherwise (nonnegativity),D(λX)=λD(X)for all X and all λ>0 (positive homogeneity),D(X+Y)⩽D(X)+D(Y)for all X and Y (subadditivity),set{X∈L2(Ω)|D(X)⩽C}is closed for all C<∞ (lower semicontinuity).As shown in [14], axioms D1–D3 imply that(2)D(X+C)=D(X)for all constantsC(constanttranslationinvariance).In general, for two r.v.’s with the same CDF, a deviation measure may assume different values. This work is confined to law-invariant deviation measures [15], i.e., those which depend only on the CDF of an r.v.Definition 2law-invariant deviation measuresA deviation measureD(X)is called law-invariant, ifD(X1)=D(X2)for any two r.v.’s X1 and X2 yielding the same CDF on (−∞;∞).Well-known examples of deviation measures include (see [15,14]):(i)deviation measures ofLptypeD(X)=‖X-EX‖p,p∈[1,∞], for example, the standard deviation σ(X)=∥X−EX∥2 and mean absolute deviation MAD(X)=∥X−EX∥1, where ∥·∥pis theLpnorm;deviation measures of semi-LptypeD-(X)=‖[X-EX]-‖pandD+(X)=‖[X-EX]+‖p,p∈[1,∞], for example, standard lower semideviationσ-(X)=‖[X-EX]−‖2and standard upper semideviationσ+(X)=‖[X-EX]+‖2, where [X]±=max{0,±X};range-based deviations, for example, lower range of X, defined asD(X)=EX-infX, and its reflection, upper range of X, defined asD(X)=supX-EX.conditional value-at-risk (CVaR) deviation, defined for any α∈(0,1) by(3)CVaRαΔ(X)≡EX-1α∫0αqX(β)dβ.For convenience, letCVaR0Δ(X)=EX-infXandCVaR1Δ(X)=supX-EX.3Observe thatlimα→1-CVaRαΔ(X)=0, whereaslimα→1-ddαCVaRαΔ(X)=EX-supX, so thatCVaR1Δ(X)=supX-EXis only a mathematical convention.3As generalizations of CVaR deviation, Rockafellar et al. [15,14] introduced mixed CVaR-deviation(4)D(X)=∫01CVaRαΔ(X)dλ(α)with some λ(α)⩾0 such that∫01dλ(α)=1, and worst-case mixed-CVaR deviation(5)D(X)=supλ∈Λ∫01CVaRαΔ(X)dλ(α)for some collection Λ of weighting nonnegative measures λ on [0,1]4In [15,14], nonnegative measures λ are defined on (0,1), so that range-based deviations are not included into mixed CVaR-deviations.4with∫01dλ(α)=1. All the above deviation measures are law invariant. See [15,16] for other examples.Deviation measures can be characterized in terms of risk envelopesQ⊂L2(Ω)each of which, being a set of r.v.’s, satisfies:(Q1)Qis a convex, closed set containing 1 (constant r.v.),EQ=1 for everyQ∈Q,for every nonconstantX∈L2(Ω)there is aQ∈Qsuch that E[XQ]<EX.The representation (6) shows that ifQis a risk envelope, thenD(X)=EX-infQ∈QE[XQ]is a deviation measure. If all elements ofQare nonnegative, then allP′such thatdP′=QdP,Q∈Q, are probability measures that can be viewed as “distortions” of the original (“reference”) probability measureP. In this case,infQ∈QE[XQ]=infQ∈QEP′[X]is the expected value of X under the “worst-case” probability distortionP′, andD(X)has a simple meaning: it is the drop in the expected value of X under the “reference” and “worst-case” probability measures. In fact, all deviation measures that have nonnegative risk envelopes form a class of so-called lower range dominated deviation measures that satisfyD(X)⩽EX-infXfor allX∈L2(Ω)and have a one-to-one correspondence with coherent averse measures of risk; see [15].5Originally, in [15], averse measures of risk were called strictly expectation bounded risk measures.5Examples of lower range dominated deviation measures include lower semideviation, lower range deviation, CVaR-deviation, and mixed CVaR-deviation. Nonnegative risk envelopes offer a powerful modeling tool: given T scenarios for asset returns with historical probabilities p1,…,pT, an investor may generate distorted probabilities p1q1,…,pTqTaccording to his/her risk perception with each Q=(q1,…,qT) being such that∑k=1Tpkqk=1and qk⩾0, k=1,…,T. Then a convex hull of all such Q including element 1 forms a risk envelopeQ^, and investor’s deviation measure is uniquely determined byD(X)=EX-infQ∈Q^E[XQ]. In other words, if investor’s risk preferences conform to the mean-deviation problem (1) with a lower range dominated deviation measure, then they can be expressed in the form of a certain set of probability measures that are distortions of the reference (historical) probability measure.An r.v. X dominates Y with respect to concave ordering, i.e.X≽cY, if E[f(X)]⩾E[f(Y)] for every concave functionf:R→R, see [11]. Similarly, X dominates Y with respect to second-order stochastic dominance (SSD), i.e.X≽SSDY, if E[f(X)]⩾E[f(Y)] for every concave increasing functionf:R→R. Theorem 1.5.3 in [11] states thatX≽cYif and only ifX≽SSDYand EX=EY. A functionalF:L2(Ω)→[-∞,∞]is called Schur convex ifX≽cYimpliesF(X)⩽F(Y). On an atomless probability space, every law invariant deviation measureD(X):L2(Ω)→[0,∞]is Schur convex, see [6]. In particular, this implies thatCVaRαΔ(X)⩽CVaRαΔ(Y)for everyX≽cY. In fact, this necessary condition is also sufficient.Proposition 1X≽cYif and only if EX=EY and(7)CVaRαΔ(X)⩽CVaRαΔ(Y)for allα∈[0,1].Theorem 1.5.3 in [11] implies thatX≽cYif and only if EX=EY andX≽SSDY. The last condition is equivalent to (7) (under EX=EY) by Theorem 2.58 in [2].□Two r.v.’sX:Ω→RandY:Ω→Rare said to be comonotone, if there exists a set A⊆Ω such that P[A]=1 and (X(ω1)−X(ω2))(Y(ω1)−Y(ω2))⩾0 for all ω1∈A and, ω2∈A. A deviation measureD:L2(Ω)→[0,∞]is called comonotone, ifD(X+Y)=D(X)+D(Y)for comonotone r.v.’s X and Y. The representation (3) implies thatCVaRαΔis comonotone for every α∈[0,1], and so is mixed CVaR-deviation (4). A deviation measureDis called proper ifD(X)<∞for some nonconstant X. It follows from [3, Proposition 2.4] that every proper comonotone law-invariant deviation measureD, which can be defined on an atomless probability space (in particular, every mixed CVaR-deviation (4)), can be represented in the form(8)D(X)=∫01g(α)d(qX(α))for some positive concave functiong:(0,1)→R. For mixed CVaR-deviation (4), Proposition 2.2 in [3] implies thatg(α)=-∫0αϕ(t)dt, where ϕ is defined by conditions dλ(α)=αdϕ(α) and∫01ϕ(α)dα=0. Conversely, deviation measure (8) is a mixed CVaR-deviation if and only if g′(1−)≡limα→1g′(α)=−1. The function g in (8) can be viewed as investor’s risk profile and is closely related to a dual utility function [20,19].Example 1The mixed CVaR-deviation (4) with λ(α)≡α, i.e.(9)D(X)=∫01CVaRαΔ(X)dα,corresponds to (8) with g(α)=−α ln α.A finite convex combination of CVaR-deviations(10)Dλ,a(X)=∑i=1nλiCVaRaiΔ(X)for some a=(a1,…,an) such that a1<a2<⋯<anwith ai∈(0,1), i=1,…,n, and weights λ=(λ1,…,λn) such that∑i=1nλi=1,λi⩾0,i=1,…,n, can be represented in the form (8) with a piecewise linear function g that joins the points (0,0),(a1,g(a1)),…,(an,g(an)),(1,0), where(11)g(ai)=∑j=1i-1λj+ai∑j=inλjaj-ai,i=1,…,n.Conversely, ifDis defined by (8) with a piecewise linear concave function g with g(0)=g(1)=0, g(an)=1−an, thenD=Dλ,a, where λ1,…,λnare found from (11).In fact, every (not necessarily comonotone) Schur convex deviation measureDcan be represented in the form(12)D(X)=supg(α)∈G∫01g(α)d(qX(α)),where G is a collection of positive concave functionsg:(0,1)→R. The representation (12) was first established for an atomless probability space in [3, Proposition 2.2], and then it was generalized to an arbitrary probability space in [6]. It implies the following result.Proposition 2LetDbe a proper Schur convex deviation measure. ThenD(X)<∞for every bounded r.v. X.For properD, functions g∈G in (12) are uniformly bounded by some constant M[3, Proposition 3.2], and, consequently,D(X)⩽M(supX-infX)<∞for every bounded r.v. X.□LetVbe a feasible set of bounded portfolio returns. It is assumed that the setVcontains a constant r0 corresponding to the rate of return of a risk-free asset, and thatVis convex: ifX1∈VandX2∈VthenλX1+(1-λ)X2∈Vfor any λ∈[0,1]. A setVis called arbitrage-free if there exists a probability measureP′on(Ω,M), equivalent toP, such thatEP′[X]=r0for allX∈V, i.e. E[Q∗X]=r0 for allX∈V, whereQ∗=dP′/dPis the Radon–Nikodym derivative ofP′with respect toP. Obviously, EQ∗=1, and Q∗⩾0. Such Q∗ will be called a risk-neutral r.v.Example 3Let(13)V=X=∑j=0nrjxj∑j=0nxj=1,(x0,…,xn)∈Rn+1,where r0,r1,…,rnare the rates of return of n+1 assets, of which asset 0 is assumed to be risk-free, xjis the fraction of capital invested into asset j with xj<0 corresponding to short selling, and∑j=0nxj=1is the budget constraint.Vis called arbitrage-free if X⩾r0 forX∈Vimplies X=r0. By the fundamental theorem of asset pricing (see, e.g., [2, Theorem 1.6]), this is equivalent to the definition of arbitrage-freeVstated above. An r.v.Q∗∈L2(Ω)is risk-neutral if and only if Q∗⩾0, EQ∗=1, and E[Q∗ri]=r0, i=1,…,n.Suppose an investor formulates the Markowitz-type portfolio selection problem (1) with some set of feasible portfoliosV. Theorem 4 in [16] shows that the necessary and sufficient optimality condition for (1) with finiteDand withVin the form (13) amounts to the existence of a risk identifierQ∗∈QD(X∗)such that(14)E[(Eri-ri)Q∗]=λ[Eri-r0],i=1,…,n,whereλ=D(X∗)/π. In fact, the condition (14) can be reformulated in the form of a generalized capital asset pricing model (CAPM): Eri−r0=βi(ErM−r0), whereβi=covar(-ri,QM)/D(rM)is the generalized beta, rMis the rate of return of a master fund that has zero weight in the risk-free asset, and QMis a risk identifier of rMwith respect toD, i.e.QM∈QD(rM), see [17,16].Suppose an investor believes that his/her risk preferences are consistent with the mean-deviation approach, i.e. he/she prefers instruments’ rates of return with higher means and lower deviations, and suppose the investor is relatively satisfied with a given rate of return X∗, so that X∗ can be assumed to represent the rate of return of investor’s optimal portfolio. This is a typical situation at a pension fund, when the investor, being presented with several predetermined portfolios (investment “schemes”), choses just one of them based on his/her risk preferences. Now, the question is what deviation measureDproduces X∗ through the portfolio problem (1). In addition,Dis desired to be law invariant and to be defined for all possible distributions, which is equivalent toDbeing Schur convex (see Proposition 2.4 in [3]). This is an inverse portfolio problem that can be formulated as follows.Problem 1Given a convex setVof bounded feasible portfolio returns and givenX∗∈V, find a proper Schur convex deviation measureD, such that X∗ is a solution of (1).Observe that ifVcontains no constant C∗ such that C∗⩾EX∗, the deviation measureD(X)≡∞with X≠C is a trivial solution, so thatD∗is required to be proper. Once the investor determinesDfrom Problem 1, he/she can use it in (1) with a different setV, e.g. with different instruments and different constraints on portfolio weights.First, we characterize portfolio rates of return that cannot be optimal in (1) and then establish necessary and sufficient conditions for the existence of a solution to Problem 1.Definition 3super-dominationAn r.v. X super-dominates another r.v. Y, or X≻sY if(15)CVaRαΔ(X)<CVaRαΔ(Y)for allα∈[0,1].Equivalently, X≻sY for nonconstant r.v.’s X and Y if and only if(16)ϕXY(α)<1for allα∈[0,1],where(17)ϕXY(α)≔CVaRαΔ(X)CVaRαΔ(Y)for allα∈[0,1].If both X and Y are bounded, (3) implies that limα→0+ϕXY(α) and limα→1−ϕXY(α) exist, are finite and determined bylimα→0+ϕXY(α)=EX-infXEY-infY=ϕXY(0),(18)limα→1-ϕXY(α)=limα→1-ddαEX-1α∫0αqX(t)dtddαEY-1α∫0αqY(t)dt=supX-EXsupY-EY=ϕXY(1),so that ϕXY(α) is a continuous function on [0,1].The following proposition shows that there is no deviation measure for which a super-dominated portfolio is optimal in (1).Proposition 3For nonconstant bounded r.v.’s X and Y, the following two statements are equivalent(i)X≻sY, andD(X)<D(Y)for every proper Schur convex deviation measureD.The definition of super-domination implies that (i) follows from (ii). Let us show that (i) yields (ii). Suppose that X≻sY. Since the function ϕXY(α) defined by (17) is continuous on [0,1], it attains its maximum on [0,1], and (16) implies that ϕXY(α)<1−∊ for all α∈[0,1] and some ∊>0. Then by Proposition 1, the r.v. X/(1−∊)+E[Y−X/(1−∊)] dominates Y with respect to concave ordering, so thatD(Y)⩾D(X/(1-∊))=D(X)/(1-∊). Because X and Y are bounded and nonconstant, it follows that∞>D(Y)>D(X)>0.□An r.v.Y∈Vis called ≻s-undominated, if there is noX∈Vsuch that EX⩾EY and X≻sY. Proposition 3 implies that every optimal solution in (1) must be ≻s-undominated. Next we show that the converse also holds.Proposition 4LetVbe a convex set of bounded feasible portfolio returns, and letX∗∈Vbe ≻s-undominated. Then there exist a proper Schur convex deviation measureDand constantπ=EX∗, such that X∗is a solution of(1). Moreover,Dcan be chosen in the form of mixed CVaR-deviation(4).Without loss of generality, we may assume that EX⩾π for everyX∈V, otherwise r.v.’s with EX<π may be safely excluded fromV. LetSbe the vector space of all continuous functions[0,1]→R. The convexity ofVand ofCVaRαΔimplies that the setU⊂Sdefined asU={ϕ|∃X∈V:ϕ(α)⩾ϕXX∗(α)for allα∈[0,1]}is convex. BecauseϕX∗X∗(α)=1for all α, andX∗∈Vis ≻s-undominated, the function ϕ∗≡1 belongs toU, but not to the interior ofU. Thus, there exists a supporting functionalLfor the setUat the point ϕ∗: a non-zero linear functionalL:S→Rwhich attains its supremum onUat ϕ∗; see e.g. [21, Corollary 1.1.4]. Then a functionalDdefined asD(X)=-L(ϕXX∗(α))attains its infimum onVat X∗.For any nonnegative function ϕ (ϕ(α)⩾0 for all α∈[0,1]),ϕ∗+ϕ∈U, so thatL(ϕ∗+ϕ)⩽L(ϕ∗), which impliesL(ϕ)⩽0, or(-L)(ϕ)⩾0. Thus,(-L)is a positive linear functional, and(-L)(ϕ)=∫01ϕ(α)dμ(α)for some Borel regular measure μ on [0,1]. Consequently,(19)D(X)=-L(ϕXX∗(α))=∫01CVaRαΔ(X)CVaRαΔ(X∗)dμ(α).Then the functionalD′(X)=D(X)/C, whereC=∫01dμ(α)CVaRαΔ(X∗), is a mixed CVaR-deviation (4) with measure λ given bydλ(α)=1Cdμ(α)CVaRαΔ(X∗).□Propositions 3 and 4 imply thatX∗∈Vis optimal in (1) for a proper Schur convex deviation measureDif and only if it is ≻s-undominated, and, in this case, the corresponding deviation measure can always be chosen in the form of mixed CVaR-deviation (4).A solution to Problem 1 is obviously not unique. For example, ifDis a solution, then so is(CD)defined as(CD)(X)≡CD(X)for any constant C>0. Also,D′(X)≡max{D(X),D1(X)}is a solution, whereD1is any deviation measure withD1(X∗)=D(X∗). However, the following result holds.Proposition 5Let Ω be an atomless probability space and letD∗:L2(Ω)→[0,∞]be a mixed CVaR-deviation(4). Then there exist a convex setVof bounded portfolio returns withX∗∈V, such thatD∗is the unique solution ofProblem 1in the form(4).Let X∗ be an arbitrary r.v. with a continuous CDF, and letVbe a set of r.v.’s X=f(X∗), wheref:R→Ris any non-decreasing function such that X is bounded,EX=EX∗, andD∗(X)⩾D∗(X∗). Then all r.v.’s inVare pairwise comonotone, which impliesD∗(λX+(1-λ)Y)=λD∗(X)+(1-λ)D∗(Y)⩾D∗(X∗)for allXandYinV.Consequently,Vis a convex set. Obviously,X∗∈V, andD∗is a solution to Problem 1.Now, letD1be another solution in the form of (4). ThenD1is comonotone, andD2(X)=D∗(X∗)D1(X∗)D1(X)is another comonotone solution withD2(X∗)=D∗(X∗). Proposition 2.4 in [3] shows that every comonotone deviation measureDcan be represented in the form (8) for some positive concave functiong:(0,1)→R. Let g∗ and g2 be the corresponding functions in (8) forD∗andD2, respectively, such that g2(α)<g∗(α) for some α∈(0,1). For the function f defined by f(x)=0 forx⩽qX∗(α)and by f(x)=1 forx>qX∗(α), the r.v. Y=f(X∗) takes values 0 and 1 with probabilities α and 1−α, respectively, so thatD2(Y)=g2(α)<g∗(α)=D∗(Y). Thus, the r.v.Y′=D∗(X∗)D∗(Y)(Y-EY)+EX∗is inV. However,D2(Y′)<D∗(X∗)=D2(X∗), which contradicts the optimality of X∗. Consequently, g2(α)⩾g∗(α) for all α∈(0,1). Now, if the last inequality is strict for some α∈(0,1), concavity of g2 and of g∗ implies that it is strict on some interval with non-zero measure. Thus,D2(X∗)>D∗(X∗)by (8) and by continuity of the distribution of X∗, which is a contradiction. Consequently, g2(α)=g∗(α) for all α∈(0,1), which impliesD2(X)≡D∗(X), orD1(X)≡C·D∗(X). Because bothD1andD∗are mixed CVaR-deviations (4), C=1 andD1(X)≡D∗(X).□Problem 1 may have solutions not necessarily in the form (4). More important, for a given setV, more than one mixed CVaR-deviation can solve it. In this case, which one to chose?Proposition 4 shows that ifX∗∈Vis ≻s-undominated, Problem 1 always has a solution in the form of mixed CVaR-deviation (4). IfVis given by (13), this implies that there exists a weighting measure λ such that (4) satisfies the optimality conditions (14), which can be restated as∫01fi(α)dλ(α)=0,i=1,…,n,wherefi(α)=(Eri-r0)CVaRαΔ(X∗)+πcovar(ri,Qα(X∗))with Qα(X∗) being the risk identifier of X∗ with respect toD=CVaRαΔ. Observe that f1(α),…,fn(α) are linearly dependent. Indeed, ifx0∗,x1∗,…,xn∗are optimal portfolio weights that correspond to X∗ in (13), i.e.X∗=∑i=0nrixi∗, then∑i=1nxi∗fi(α)≡0. Thus, withxn∗≠0, only conditions for i=1,…,n−1 should be used.If λ is not unique, then the investor may take the supremum over all corresponding mixed CVaR-deviations. In other words, he/she finds the worst-case mixed-CVaR deviation from the variational problem(20)D(X)=supλ(α)⩾0∫01CVaRαΔ(X)dλ(α)s.t.∫01fi(α)dλ(α)=0,i=1,…,n-1,∫01dλ(α)=1.Let ξ1,…,ξn−1 and u be Lagrange multipliers corresponding to the constraints in (20), then with the LagrangianL(X;λ;ξ,u)=∫01CVaRαΔ(X)+∑i=1n-1ξifi(α)-udλ(α)+uwhere ξ=(ξ1,…,ξn−1), (20) takes the form(21)D(X)=supλ(α)⩾0infξ,uL(X;λ;ξ,u).Since L(X;λ;ξ,u) is linear with respect to λ, ξ, and u, it has a saddle point, so that ”sup” and ”inf” in (21) can be exchanged, and (21) simplifies toD(X)=infξ1,…,ξn-1,uus.t.CVaRαΔ(X)+∑i=1n-1ξifi(α)⩽ufor allα∈[0,1],which can be recast as(22)D(X)=infξ1,…,ξn-1supα∈[0,1]CVaRαΔ(X)+∑i=1n-1ξifi(α).ForX∗∈Vbeing ≻s-undominated, the right-hand side in (20) has always a feasible solution, whereas for bounded X, (22) and (20) are both finite and, consequently, define the same deviation measureD.The deviation measure (20) solves Problem 1 in the form of worst-case mixed-CVaR deviation (5). However, it may not be a unique solution in this form and in deviation measures that do not admit the representation (5). In this case, the investor may take the supremum over all possible solutions of Problem 1. Since any solutionDgenerates a family of equivalent solutions(CD),C>0, we may assumeD(X∗)=π. LetWbe the set of all solutionsDto Problem 1 such thatD(X∗)=π.Proposition 6If non-empty, the setWcontains the unique “maximal” element, i.e. there exists a unique deviation measureD∗∈Wsuch thatD∗(X)⩾D(X)for allX∈L2(Ω)andD∈W. In fact,D∗is the supremum of all elements ofW:(23)D∗(X)=supD∈WD(X)for allX∈L2(Ω),which admits an equivalent representation(24)D∗(X)=πsupα∈[0,1]CVaRαΔ(X)CVaRαΔ(X∗)for allX∈L2(Ω).The deviation (23), being the supremum of Schur convex deviations, is Schur convex. Also,D∗(X∗)=supD∈WD(X∗)=supD∈Wπ=πandD∗(X)=supD∈WD(X)⩾supD∈Wπ=πfor everyX∈Vwith EX⩾π, so thatD∗∈W, and (23) implies thatD∗(X)⩾D(X)for allX∈L2(Ω)andD∈W.Now, letD∗∗(X)be the right-hand side in (24).D∗∗, being the supremum of Schur convex deviations, is Schur convex, and, obviously,D∗∗(X∗)=π. SinceWis non-empty, X∗ is ≻s-undominated by Proposition 3, which implies thatD∗(X)⩾πfor everyX∈Vwith EX⩾π, i.e.D∗∗∈W. LetDbe another proper Schur convex deviation measure such thatD(X∗)=π, and letX∈L2(Ω). By Proposition 3.3 in [3], the supremum in (12) is attained for some positive concave function gX: (0,1)→[0,∞], so that(25)D(X)=∫01CVaRαΔ(X)dλX(α)for some nonnegative weighting measure λXon [0,1]. Consequently,D(X)⩽∫01D∗∗(X)πCVaRαΔ(X∗)dλX(α)⩽D∗∗(X)πD(X∗)=D∗∗(X),which implies thatD∗∗is the maximal element ofW, and thus,D∗=D∗∗by the uniqueness of the maximal element.□The deviation measure (24) is finite for any bounded X and is +∞ for any unbounded X.In contrast to (22), the deviation measure (24) does not depend on the setV, which is a substantial advantage. For example, if no-shorting constraints are added to (13), then the optimality conditions (14) may no longer hold, and as a result, the deviation (22) that follows from (14)–(20) may be meaningless.The deviation measure (24) can be represented in the form(26)D∗(X)=πinfuus.t.CVaRαΔ(X)⩽uCVaRαΔ(X∗)for allα∈[0,1].Let X be bounded. Then with a Lagrange multiplier η(α)⩾0 and the LagrangianL∼(X;u;η)=u+∫01η(α)CVaRαΔ(X)-uCVaRαΔ(X∗)dα,(26) can be rewritten asD∗(X)=πinfusupη(α)⩾0L∼(X;u;η).SinceL∼(X;u;η)is linear with respect to u and η(α), it has a saddle point, so that “inf” and “sup” in the last problem can be exchanged, and (26) simplifies to(27)D∗(X)=πsupη(α)⩾0∫01η(α)CVaRαΔ(X)dαs.t.∫01η(α)CVaRαΔ(X∗)dα=1.Observe that sinceCVaRαΔ(X∗)>0forα∈[0,1),CVaRαΔ(X)<∞for α∈ (0,1) andX∈L2(Ω), andlimα→1-CVaRαΔ(X)/CVaRαΔ(X∗)exists for bounded X, both (26) and (27) have feasible solutions. The representation (27) shows that (24) is similar to the worst-case mixed-CVaR deviation (5) with dλ(α)=η(α)dα.LetVbe given by (13). Suppose that there are T⩾2 equiprobable scenarios with the excess return aji=rji−r0 under scenario i. Elements ajiform an n×T matrix A, and the columns of A are assumed to be linearly independent. In this model, eachY∈Vis a discrete r.v. assuming values y1,…,yTwith equal probabilities.Proposition 7LetVbe given by(13), and letX,Y∈V. Then X≻sY if and only if(28)CVaRαΔ(X)<CVaRαΔ(Y),α=i/T,1⩽i⩽T-1.For discrete r.v.’s X andY,CVaRαΔ(X)andCVaRαΔ(Y)are piecewise-linear functions of α on (0,1). Consequently, it suffices to check the inequalityCVaRαΔ(X)<CVaRαΔ(Y)only at the joints of the segments. Moreover, for any r.v.Z∈V,CVaR1/TΔ(Z)=EZ-T∫01/TqZ(β)dβ=EZ-T∫01/T(infZ)dβ=EZ-infZ=CVaR0Δ(Z)andCVaRT-1TΔ(Z)=EZ-TT-1∫0T-1TqZ(β)dβ=EZ-TT-1EZ-∫T-1T1(supZ)dβ=supZ-EZT-1=CVaR1Δ(Z)T-1.Consequently, for α=0 and α=1, (15) follows from (28) for i=1 and i=T−1, respectively.□The proof of Proposition 7 implies that in the discrete case, the portfolio problem (1) with the restored deviation measure (24) in the form (26) can be solved with the constraint in (26) taken at α=i/T, i=1,…,T−1, i.e.minX∈V,uus.t.CVaRi/TΔ(X)⩽uCVaRi/TΔ(X∗),i=1,…,T-1,EX⩾π̃.With the formula [13](29)CVaRαΔ(X)=minc∈REX-c+1αE[max{0,c-X}],this problem can be rewritten as(30)minX∈V,u,ci,Zius.t.EX-ci+TiEZi⩽uCVaRi/TΔ(X∗),Zi⩾ci-X,Zi⩾0,i=1,…,T-1,EX⩾π̃.IfVis a set of linear constraints for portfolio weights, then (30) admits a linear programming (LP) formulation.Similarly, through the formula (29), the portfolio problem (1) with the worst-case mixed-CVaR deviation in the form (22) and withVbeing a set of linear constraints for portfolio weights can be reduced to an LP problem.For discrete random variables, the proof of Proposition 4 yields the following result.Proposition 8LetVbe given by(13), and letX∗∈Vbe ≻s-undominated. Then there exist nonnegative weights λ1,…,λT−1with∑i=1T-1λi=1and such that X∗is a solution of(1)for the deviation measure(31)D(X)=∑i=1T-1λiCVaRi/TΔ(X).As in the proof of Proposition 4, it is assumed that EX⩾EX∗ for allX∈V. The convexity ofVand ofCVaRαΔimplies that the setU=u=(u1,…,uT-1)|∃X∈V:ui⩾CVaRi/TΔ(X),i=1,…,T-1⊂RT-1is convex. BecauseX∗∈Vis ≻s-undominated, the vector u∗ with componentsui∗=CVaRi/TΔ(X∗),i=1,…,T-1, belongs to the boundary ofU. Thus, by the supporting hyperplane theorem, there exists a non-zero vector λ=(λ1,…,λT−1), such that∑iλiui⩾∑iλiui∗for allu∈U. Becauseu∗+ei∈U,i=1,…,T-1, where eihas componentseji=0,j≠i, andeii=1, this implies λi⩾0, i=1,…,T−1. Normalizing λ if necessary, we can assume that∑i=1T-1λi=1, and, consequently, λ defines a deviation measureDvia (31). Finally, for everyX∈V,D(X)=∑i=1T-1λiCVaRi/TΔ(X)⩾∑i=1T-1λiui∗=D(X∗),as required.□The optimality conditions for the portfolio problem (1) with the mixed CVaR-deviation (31) can be formulated in the form (see [16,8])(32)∑i=1T-1cijλi=0,j=1,…,n,with(33)cij=(E[rj]-r0)CVaRαiΔ(X∗)+(E[X∗]-r0)covarrj,Qi∗for i=1,…,T−1, j=1,…,n, and with(34)∑i=1T-1λi=1,λi⩾0,i=1,…,T-1,whereQi∗is a risk identifier such thatEQi∗=1and0⩽Qi∗⩽1/αiand satisfiesCVaRαiΔ(X∗)=covar-X∗,Qi∗. If X∗ assumes values Xkwith equal probabilities 1/T for k=1,…,T, thenQi∗=qik∗k=1T, whereqi1∗,…,qiT∗are found from the optimization problem(35)minqik∑k=1TqikXks.t.∑k=1Tqik=T,0⩽qik⩽1/αi,k=1,…,K.In this case,CVaRαiΔ(X∗)=1T∑k=1T1-qik∗Xk.The system (32)–(34) has T−1 unknowns, n+1 linear equations, and T−1 linear inequalities. Observe that since X∗ is the rate of return of an optimal portfolio, the equations in (32) are linearly dependent. (Indeed, letxj∗,j=1,…,n, be optimal portfolio weights with∑j=1nxj∗=1, then multiplying equation j in (32) byxj∗and adding all equations, we obtain an identity.) If T−1<n, the system (32)–(34) can be solved approximately by minimizing the total quadratic error in satisfying the equations in (32) with respect to λ1,…,λT−1:minλ1,…,λT-1∑j=1n∑i=1T-1cijλi2s.t.∑i=1T-1λi=1,λi⩾0,i=1,…,T-1.A problem similar to this one was solved for the S&P500 index in [8].The results obtained in this work imply that:•IfX∗∈Vis not ≻s-undominated, then the system (32)–(34) has no solution even if T−1>n.IfX∗∈Vis ≻s-undominated, then by Proposition 8, the system (32)–(34) always has a solution even if n>T−1.In real-life portfolio management, T≫n, in which case, the following result is useful.Proposition 9LetVbe defined by(13), and letX∗∈Vbe ≻s-undominated. Then there exist a1∈(0,1),…,an+1∈(0,1), and nonnegative weightsλ1,…,λn+1,∑i=1n+1λi=1, such that X∗is a solution of(1)with the deviation measure(36)D(X)=∑i=1n+1λiCVaRaiΔ(X).Let T−1>n+1, otherwise the statement of this proposition follows from Proposition 8. It is sufficient to prove that the system (32)–(34) has a solution with at most n+1 non-zero λi. Proposition 8 implies that the system has some solution λ=(λ1,…,λT−1). Let λ have at least n+2 non-zero entries with the corresponding indices to be K={k1,…,kn+2}. The system∑i∈Kzi=0,∑i∈Kcijzi=0,j=1,…,n,with n+1 equations and n+2 unknowns has a non-zero solutionzk1∗,…,zkn+2∗. Let y=(y1,…,yT−1) be such thatyi=zi∗for i∈K and yi=0 otherwise. Then, for positive and small enough ∊, the vector λ′=λ+∊y satisfies the system (32)–(34). With maximal ∊ such that the inequalitiesλ1′⩾0,…,λT-1′⩾0still hold, the solutionλ′=λ1′,…,λT-1′, compared to λ, has strictly smaller number of non-zero entries. The process is then repeated.□In other words, Proposition 9 claims that there exists a solution in the form (8) with a piecewise linear function g with at most n+2 segments.Observe that ifX∗∈Vis not ≻s-undominated, it can be dominated by someY∈Vwith respect to SSD. This indicates that the investor is not risk averse. On the other hand, the mean-deviation portfolio problem (1) is inappropriate for risk seeking investors. Several algorithms are available for testing of whether solutions to portfolio optimization with n assets and T scenarios are SSD-efficient; see e.g. [9]. Thus, the inverse portfolio Problem 1 can be solved by the following algorithm.(i)Test whether X∗ is dominated by SSD withinV. If so, stop. The investor is not risk averse, and investor’s risk preferences are incompatible with the mean-deviation portfolio problem (1).IfX∗∈Vis not dominated by SSD withinV, it is also ≻s-undominated, and thus, investor’s deviation measure has the form (31). Also, this implies that the system (32)–(34) has a solution even if n>T−1.(a)If n+1⩾T−1, solve the system (32)–(34) for weights λ to be used in (31).If n+1<T−1, use the procedure in the proof of Proposition 9 to find a simpler solution in the form (36).Construct the risk profile g in the representation (8) by (11).The portfolio problem (1) with the “restored” deviation measure (31) takes the formminX∈V∑i=1T-1λiCVaRi/TΔ(X)s.t.EX⩾π̃.Using the formula (29), we can rewrite it as(37)minX∈V,ci,Zi∑i=1T-1λiEX-ci+TiEZis.t.Zi⩾ci-X,Zi⩾0,i=1,…,T-1,EX⩾π̃.IfVis a set of linear constraints for portfolio weights, then (37) is an LP problem, which can be solved with popular optimization packages such as CPLEX or Portfolio Safeguard.Example 4numerical illustrationWe consider a risk-free asset with zero rate of return and 91 assets from the FTSE 100 index6There are 94 assets in the index, and three assets EVRAZ, Glencore Intl, and Polymetal Intl are excluded because of the lack of data.6with weekly rates of return from 3-January-2011 to 4-March-2013. The setVis assumed to be in the form (13). The algorithm in [9] shows that the index is dominated by SSD onV. In this case, one may construct an SSD-efficient portfolio either by the algorithm in [9] starting from the index or as described in [22]. Yet another way is to find an optimal mean–variance portfolio, which will be SSD-efficient. We proceed with the latter approach. With X∗ being the rate of return of the optimal mean–variance portfolio consisting of the specified 91 assets, the system (32)–(34) is solved to find weights λ1,…,λT−1 in (31). Fig. 1shows the risk profile g, which is determined by (11) and plays the role of a dual utility function [20,19] in the representation (8). Once λ1,…,λT−1 in the mixed CVaR-deviation (31) are determined, we can now solve the portfolio problem (1), which in the discrete case and withVbeing a set of linear constraints for portfolio weights reduces to the LP problem (37). However, the found λ1,…,λT−1 are not unique, and “to be safe,” we can use either the worst-case deviation measure in the form (26) or the worst-case mixed-CVaR deviation (22) with given X∗.As in Proposition 5, let Problem 1 have a unique solution D∗ in the form (4). If the corresponding weighting measure λ∗ in (4) is not simple, an approximate solution to Problem 1 can be sought in the form (10).Determining an approximate solution requires a metric on the space of deviation measures, which can be introduced by(38)d(D1,D2)=supX∈L2(Ω):|X|⩽1|D1(X)-D2(X)|.Proposition 10A set of proper Schur convex deviation measuresD:L2(Ω)→[0,∞]with the distance(38)forms a metric space, i.e. for allD1,D2, andD3,(38)satisfies the metric properties: (i)d(D1,D2)<∞; (ii)d(D1,D2)=0if and only ifD1=D2; (iii)d(D1,D2)=d(D2,D1); and (iv)d(D1,D3)⩽d(D1,D2)+d(D2,D3).(i) follows from Proposition 2. Thend(D1,D2)=0implies thatD1(X)=D2(X)for all ∣X∣⩽1. Positive homogeneity D2 yieldsD1(X)=D2(X)for all bounded X, so thatD1(X)=D2(X)for allX∈L2(Ω)by lower semicontinuity D4, so that (ii) holds. Properties (iii) and (iv) follow from (38).□Now, the question of finding an approximate solutionDλ,ato Problem 1 in the form (10) can be stated as two alternative problems: letD∗be given by (4) with the weighting measure λ∗ and let n be fixed, then find λ and a such that(39)minλ,adD∗,Dλ,a,or, given a, find λ such that(40)minλd(D∗,Dλ,a).Next proposition is instrumental in solving (39) and (40).Proposition 11Let Ω be an atomless probability space, and letD1:L2(Ω)→[0,∞]andD2:L2(Ω)→[0,∞]be deviation measures in the form(8)with g1and g2, respectively. Then(41)d(D1,D2)=2supα∈(0,1)|g1(α)-g2(α)|.For ∊>0, let α∗∈(0,1) be such that supα∈[0,1]∣g1(α)−g2(α)∣⩽ ∣g1(α∗)−g2(α∗)∣+∊. Thend(D1,D2)⩾|D1(X∗)-D2(X∗)|=|2g1(α∗)-2g2(α∗)|=2supα∈[0,1]|g1(α)-g2(α)|-2∊,where X∗ is an r.v. such thatP[X∗=-1]=α∗andP[X∗=1]=1-α∗. Since ∊ is arbitrary, “⩾” part in (41) follows. Conversely,|D1(X)-D2(X)|=∫01(g1(α)-g2(α))dqX(α)⩽supα∈(0,1)|g1(α)-g2(α)|∫01dqX(α)for anyX∈L2(Ω). If ∣X∣⩽1, then∫01d(qX(α))⩽2, and “⩽” part in (41) holds.□Proposition 11 and Example 2 reduce the problems (39) and (40) to piecewise linear approximation of a convex function on (0,1) with the uniform error measure.Example 5The problem (39) withD∗in the form (9) and with n=1 has the unique solutionD(X)=CVaRaΔ(X), where a≈0.515 is the only zero of 1−a+alna−exp (−1/a) on (0,1).IfX∗∈Vis not ≻-undominated, Problem 1 has no solution. This section does not require deviationDin Problem 1 to be Schur convex.Problem 2Given an arbitrage-free setVof feasible portfolio rates of returns andX∗∈V, find a proper deviation measureD, such that X∗ is a solution to (1).IfDsolves Problem 2, then so doesCDdefined as(CD)(X)≡C·D(X)for C>0. Thus, without loss of generality,Dcan be assumed to satisfyD(X∗)=π.Proposition 12IfVis arbitrage-free and there exists a risk neutralQ∗∈QD(X∗), thenX∗∈Vis an optimal solution in(1)for someD. In addition, ifVis given by(13),Dis finite, andD(X∗)=π, then arbitrage-freeVand the existence of a risk neutralQ∗∈QD(X∗)are also necessary conditions for X∗to be optimal.LetVbe arbitrage-free, and let there exist a risk neutralQ∗∈QD(X∗), thenD(X)⩾E[(1-Q∗)X]=EX-r0⩾EX∗-r0=E[(1-Q∗)X∗]=D(X∗)for everyX∈L2(Ω)such that EX⩾EX∗, so thatX∗∈Vis an optimal solution in (1) for π=EX∗ andD. Conversely, ifVis given by (13), andDis finite, then (14) implies that E[Q∗ri]=r0, i=1,…,n, so that Q∗ is risk-neutral.□The next proposition solves Problem 2 for any arbitrage-freeVand anyX∗∈Vsuch that EX∗>r0.Proposition 13LetVbe arbitrage-free. Then anyX∗∈Vsuch that EX∗>r0is an optimal solution in(1)for π=EX∗and for a deviation measureD∗with the risk envelope(42)Q={Q∈L2(Ω)|Q⩾0,EQ=1,E[X∗Q]⩾E[X∗Q∗]for allX},whereQ∗∈L2(Ω)is a risk-neutral r.v.The setQdefined by (42) is a risk envelope. Indeed, convexity and closedness in property Q1 are straightforward, and EX∗>r0 implies that1∈Q. Property Q2 follows directly from (42). Finally, letQ∊∈L2(Ω)be defined by Q∊(ω)=1+∊ if X(ω)<EX, by Q∊(ω)=1−∊p2/p1 if X(ω)>EX, and by Q∊(ω)=1 if X(ω)=EX, whereX∈L2(Ω)is nonconstant,p1=P[X>EX]>0andp2=P[X<EX]>0. Then EQ∊=1 and E[XQ∊]<EX for all ∊>0. On the other hand, lim∊→0E[X∗Q∊]=EX∗>r0=E[X∗Q∗], whence E[X∗Q∊]⩾E[X∗Q∗], orQ∊∈Qfor some ∊>0, which proves Q3. Thus, the second representation in (6) withQgiven by (42) defines a deviation measureD∗, and (42) implies that Q∗ is a risk identifier of X∗. Consequently, X∗ is optimal in (1) by Proposition 12.□LetVbe given by (13). This section constructs a solution of Problem 1 in the dual form (6).Proposition 14A deviation measureDis Schur convex if and only if the corresponding risk envelopeQis ⪰c-closed, i.e.Y∈Qand Z⪰cY imply thatZ∈Q. In this case, −Q is comonotone withX∈L2(Ω)for allQ∈Q(X).The first statement follows from [1, Corollary 3.3], let us prove the second one. By contradiction, letX∈L2(Ω)andQ∈Q(X), and letQbe ⪰c-closed. Now suppose there exist sets A1⊂Ω and A2⊂Ω such thatpi=P(Ai)>0,i=1,2,∊=infω∈A1X(ω)-supω∈A2X(ω)>0andδ=infω∈A1Q(ω)-supω∈A2Q(ω)>0. Then Q∗⪰cQ, where the r.v. Q∗ is defined by Q∗(ω)=Q(ω)−δ p2/(p1+p2) for ω∈A1, by Q∗(ω)=Q(ω)+δp1/(p1+p2) for ω∈A2, and by Q∗(ω)=Q(ω) for ω∉A1∪A2. Consequently,Q∗∈Q, andD(X)⩾E[(1-Q∗)X]⩾E[(1-Q)X]+∊δp1p2/(p1+p2)>E[(1-Q)X], which contradicts toQ∈Q(X).□LetVbe given by(13), and let Eri≠r0for some i. An r.v. X∗is ≻s-undominated if and only if there exists a risk-neutral r.v.Q∗∈L2(Ω), such that −Q∗is comonotone with X∗. In this case, X∗is a solution of(1)with π=EX∗and with a proper Schur convex deviation measureD∗with the risk envelope(43)Q={Q∈L2(Ω)|Q⪰cQ∗},andD∗can be represented in the form(44)D∗(X)=∫01q1-Q∗(α)qX(α)dα.If X∗ is ≻s-undominated, Proposition 4 implies that it is optimal in (1) with π=EX∗ and with a deviation measureDin the form (4). In particular,Dis finite, and, by Proposition 12, there exists a risk neutralQ∗∈QD(X∗). Then −Q∗ is comonotone with X∗ by Proposition 14.Conversely, letQ∗∈L2(Ω)be risk neutral and such that −Q∗ is comonotone with X∗. ThenQdefined in (43) satisfies the three properties (Q1, Q2, and Q3) of risk envelope. Indeed, Proposition 1 and convexity ofCVaRαΔimply that 1=EQ∗⪰cQ∗, and λQ1+ (1−λ)Q2⪰cQ∗ whenever Q1⪰cQ∗ and Q2⪰cQ∗, and Q1 follows. Then Q⪰cQ∗ implies EQ=EQ∗=1 for allQ∈Q, which is Q2. Because Eri≠r0 for some i, Q∗≠1, and, by Proposition 1, Q∊⪰cQ∗ for some ∊>0, whereQ∊∈L2(Ω)is defined as in the proof of Proposition 13, namely, Q∊(ω)=1+∊ if X(ω)<EX, Q∊(ω)=1−∊p2/p1 if X(ω)>EX, and Q∊(ω)=1 if X(ω)=EX, whereX∈L2(Ω)is nonconstant,p1=P[X>EX]>0andp2=P[X<EX]>0. Since E[XQ∊]<EX for all ∊>0, Q3 follows. Thus, the second representation in (6) withQgiven by (43) determines a deviation measureD∗, which is Schur convex by Proposition 14.Next, for everyQ∈Q, the condition Q∗⪰cQ is equivalent to 1−Q∗⪰c1−Q by (43), which impliesE[(1-Q)X]⩽∫01qX(α)q1-Q(α)dα⩽∫01qX(α)q1-Q∗(α)dα⩽D∗(X)for allX∈L2(Ω),where the first, second, and third inequalities are due to Hardy-Littlewood [2, Theorem A.24], Dana [1, Lemma 2.1], and Grechuk and Zabarankin [6, Proposition 4.3], respectively, and (44) follows.Since 1−Q∗ is comonotone with X∗,Y=E[1−Q∗∣X] is an increasing function of X, and consequently,E[(1-Q∗)X∗]=E[YX∗]=∫01qX∗(α)q1-Q∗(α)dα=D∗(X∗),where the second equality follows from [2, Theorem A.24]. Thus,Q∗∈QD∗(X∗), and, by Proposition 12, X∗ is optimal in (1) forD∗. In particular, with Proposition 3, this implies that X∗ is ≻s-undominated. □IfVis arbitrage-free and EX∗>r0, a solution to Problem 2 is given by Proposition 13. Suppose there are T scenarios for the rates of return of the risky assets with historical probabilities p1,…,pT. In this case,Q∗=q1∗,…,qT∗is risk-neutral if Q∗⩾0, EQ∗=1, and E[Q∗ri]=r0,i=1,…,n, i.e. if∑j=1Tqj∗pj=1,qj∗⩾0,j=1,…,T,∑j=1Tqj∗pjrij=r0,i=1,…,n,soq1∗,…,qT∗can be found from this system of linear equations and inequalities. IfVis arbitrage-free, the solution is guaranteed to exist by the fundamental theorem of asset pricing. In fact, as in Proposition 9, one can show that there exists a risk-neutral r.v. Q∗ with at most n+1 non-zero entries, which is useful if T≫n. The risk envelope ofD∗can then be found from (42), i.e.Q=(q1,…,qT)∈Qif and only ifqj⩾0,j=1,…,T,∑j=1Tqjpj=1and∑j=1Tqjpjxj∗⩾∑j=1Tqj∗pjxj∗, whereX∗=x1∗,…,xT∗.Proposition 15 implies that Problem 1 has a solution if and only if there exists a risk-neutral r.v.Q∗∈L2(Ω), such that −Q∗ is comonotone with X∗. Suppose that p1=…=pT=1/T and that there exists a permutation (j1,…,jT) of the set (1,…,T) such thatxj1∗<xj2∗<⋯<xjT∗. Then the condition “−Q∗ is comonotone with X∗” can be written asqj1∗⩾qj2∗⩾…⩾qjT∗, in which case,qj∗can also be found from the above system of linear equations and inequalities, and, by Proposition 15, the solution exists if and only if X∗ is ≻s-undominated. Onceq1∗,…,qT∗are found, then for anyX=(x1,…,xT),D∗(X)is determined by (44):D∗(X)=1T∑i=1T1-qji∗xki, where (k1,…,kT) is a permutation of the set (1,…,T) such thatxk1⩽xk2⩽…⩽xkT.

@&#CONCLUSIONS@&#
The problem of identifying investor’s deviation measure in the mean-deviation portfolio problem (1) based on observing the rate of return of investor’s portfolio has been solved. This inverse problem assumes that investor’s portfolio is an optimal solution to (1) for some deviation measure. A necessary and sufficient condition for the inverse problem to have a law-invariant solution has been established. Proposition 4 shows that if a given portfolio is ≻s-undominated, then a solution always exists and has the form of mixed CVaR-deviation (4); otherwise, the inverse problem has no law-invariant solution. If the solution is not unique, the investor may choose the worst-case solution given by (24). Also, Proposition 5 proves that in general, if the inverse problem is required to have a solution, mixed CVaR-deviations (4) represent the smallest feasible set of deviation measures. However, if the portfolio problem (1) has n assets with T scenarios for assets’ rates of return, a solution to the inverse problem can always be chosen in the form of a mixed CVaR-deviation with no more than min{T−1,n+1} CVaR-deviations. When the number of CVaR-deviations is constrained, an approximate mixed CVaR-deviation is provided as well. Finally, if a given portfolio is not ≻s-undominated, and law-invariant solution does not exists, a non law-invariant solution is presented in the dual form (6) with the risk-envelopeQdetermined by (42).