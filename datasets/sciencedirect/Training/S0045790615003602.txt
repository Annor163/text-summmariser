@&#MAIN-TITLE@&#
Multi-quantized local binary patterns for facial gender classification

@&#HIGHLIGHTS@&#
Multi-level quantization scheme is proposed to enhance discrimination power of LBP.The proposed method utilizes both the sign and magnitude components from GLD.The results of the experiments validate the robustness of the proposed method.Thorough evaluation of four popular features (LBP, CLBP, ELBP and LTP) is presented.

@&#KEYPHRASES@&#
Feature extraction,Pattern classification,Local binary patterns,Gender classification,

@&#ABSTRACT@&#
Graphical abstractImage, graphical abstract

@&#INTRODUCTION@&#
The human face is an information rich source providing cues to determine multiple traits such as identity, age, gender and ethnicity. This paper addresses the problem of automatic gender recognition from facial images. Automatic gender recognition has many potential applications like biometric authentication, surveillance, photo album management, image retrieval, human-computer interaction and targeted advertising.Gender recognition is a binary classification problem. Every classification problem demands efficient feature representation as it heavily affects the performance of a classifier. The key issues in feature description are computational cost, robustness and generalization capability. The feature descriptor should have low computational cost, high robustness and it should perform well on unseen test samples. Numerous methods exist in the literature to describe facial features. These methods can be categorized as holistic or local. The former use whole face images and they do not incorporate any knowledge about input object. The simplest and probably the oldest holistic feature is the raw pixel intensity. Some of the early works [1–4] used raw pixel intensity for recognizing facial gender. In contrast, the famous work in [5] proposed a set of binary features generated from various types of pixel comparison operators. The other popular holistic features are principal component analysis [6] and linear discriminant analysis [7,8]. Holistic features though simple in nature perform inferior even for slight variations in illumination and pose [9].Recently, local appearance-based features have gained increasing attention because of their robustness to illumination variation and high discrimination power. The works in [10–13] used Gabor wavelets for local feature extraction and had shown promising performance. However, the major drawback of Gabor features is high computational cost. Local binary pattern (LBP) on the other hand provides high discrimination power with great computational efficiency. The use of LBP for face description was pioneered by Ahonen et al. [14]. Subsequently, it has been widely used in face recognition and facial gender recognition.The earliest attempts made in [15,16] demonstrated the success of LBP in gender classification of frontal face images. In contrast, the work in [17] revealed multi-view gender discrimination capability of LBP features. Later, Shan [18] addressed more difficult problem of classifying gender of real-world face images which contain significant variations in pose, illumination and expression. On a challenging LFW database [19], they validated a promising performance of LBP features. To improve further, they also proposed an Adaboost based boosting algorithm to select discriminative LBP histogram bins. The boosted LBP features were not only compact but also more efficient in classifying gender. To further enhance the performance of gender classification, LBP has been successfully employed in various fusion schemes. The works in [20,21] proposed a fusion of three different types of features including LBP, pixel intensity and edges histogram. The other interesting works employing LBP in information fusion schemes can be found in [22,23].Since its introduction by Ojala et al. [24], LBP has enjoyed widespread popularity because of advantages such as computational simplicity, invariance to monotonic intensity transformation and availability of open source codes. However, LBP has also some serious drawbacks like sensitivity to noise and non-monotonic lighting variations. Many different variants of LBP have been proposed to overcome these limitations. Here, we briefly review some of the relevant variants only. Comprehensive review on LBP and its variants can be found in [25].The use of binary quantization scheme makes LBP very sensitive to random noise. To enhance robustness against noise, Tan and Triggs [26] proposed a local ternary pattern (LTP) which employed three-level quantization scheme. The other major drawback of LBP is that the information about magnitude of gray level difference (GLD) is completely lost. This loss of information reduces the discrimination ability of the LBP operator. To handle this issue, Ylioinas et al. [27] proposed to combine contrast information with LBP and showed improved gender classification performance. The other two relevant works namely extended local binary pattern (ELBP) [28] and completed local binary patterns (CLBP) [29] followed a different approach to utilize GLD magnitude information. Both the above methods explicitly encode the sign and magnitude of GLD. To retain the magnitude information, the ELBP operator slices the GLD into three different layers, in addition to the fourth layer corresponding to sign information. Thus it generates four different patterns. In contrast, CLBP encodes magnitude information by comparing the magnitude of local GLD with the average magnitude of GLD of the whole image. Hence, it generates two different patterns namely CLBP_S and CLBP_M corresponding to sign and magnitude components respectively. In [29], the authors also proposed binary coding of center pixel (CLBP_C) which was fused with sign and magnitude components for further improvement. However, for fair comparison we have considered only two CLBP patterns corresponding to sign and magnitude information in this paper.This paper also addresses the issue of enhancing the discrimination capability of LBP by utilizing the magnitude information of GLD. However, unlike CLBP and ELBP, we propose to generalize the concept of LBP by quantizing the GLD into multiple levels (Fig. 1). These multi-quantized local binary patterns (MQLBP) implicitly encode both the sign and magnitude information of GLD. Further, our method is conceptually different from LTP. Whereas LTP quantizes GLD into three fixed levels, we follow a more natural philosophy to quantize GLD into desired number of levels. To demonstrate enhanced discrimination capability of the MQLBP, we apply it to facial gender classification task. We designed a comprehensive experimental setup which included four different datasets under four different settings resulting in a total of 35 combinations. The results clearly indicated that MQLBP improves discrimination power, noise tolerance and generalization capability as compared to LBP, CLBP, ELBP and LTP.The main contributions of the paper are highlighted below:•We thoroughly evaluate the applicability of CLBP, ELBP and LTP features for gender classification task and demonstrate superior performance of these features over binary quantized LBP feature.We generalize the concept of LBP and propose a scheme to quantize the GLD into multiple levels. The resulting multi-quantized local binary patterns are evaluated on four different experimental settings to demonstrate enhanced discrimination power, noise tolerance and generalization capability.The paper contains experimental novelty which includes the gender classification of noisy images which has not been explored much in the literature. Further, we also carry out a challenging experiment of cross-database testing on noisy images. To the best of our knowledge, this experimental setting is the first of its kind. Even under this challenging setting, the proposed method showed promising results.The rest of the paper is structured as follows: In Section 2, we briefly review the existing methods and then present the methodology of MQLBP. Experimental setup and its results are discussed in detail in Section 3. Finally, we present conclusions in Section 4.LBP code for a center pixel at coordinates (xc, yc) is given as follows:(1)LBPP,R(xc,yc)=∑p=0P−1f1(gp−gc)2pwhere gcand gpindicate a pixel intensity of a center pixel and its pth neighbor in the circular neighborhood of radius R. Parameter P indicates the total number of neighboring pixels. The function f1(x) is defined as(2)f1(x)={1,ifx≥0;0,otherwise.To reduce noise sensitivity of LBP, Tan and Triggs [26] proposed a three-level quantization scheme as shown in Fig. 1(b) to derive a method namely local ternary pattern. Using an additional thresholding parameter, they quantized GLD into three levels using a function as shown below:(3)f2(x,t)={−1,x≤−t0,−t<x<t1,x≥tTo reduce feature dimensionality, the ternary code was split into two parts to generate two binary patterns by encoding positive and negative quantization levels. More details can be found in [26].To enhance the discrimination capability, Guo et al. [29] proposed completed local binary patterns by utilizing sign and magnitude patterns from GLD. The component namely CLBP_S is the same as original LBP which retains the sign of GLD. Further, the magnitude information was utilized using an additional pattern (CLBP_M) as follows:(4)CLBP_MP,R(xc,yc)=∑p=0P−1f3(|gp−gc|,τ)2pwhere the symbol |.| denotes an absolute value. The function f3(x, τ) is defined as(5)f3(x,τ)={1,x≥τ0,x<τwhere the variable τ denotes the thresholding parameter which is set to mean value of the GLD magnitude of the whole image. More details can be found in [29].The work in [28] followed a different approach to utilize the magnitude information of GLD. They used four different binary patterns corresponding to four layers obtained from GLD. The first layer retains the sign of GLD and hence returns the same code as LBP. The remaining layers encode the magnitude of GLD which can take any value in the range of (0, 255) assuming 8-bit images. They assumed that the neighboring pixels have a smaller difference in their intensities. Hence, they encoded GLD magnitude into 8 levels corresponding to range (0, 7). The first seven codes (0–6) represent the actual GLD magnitude, while all the magnitudes higher than six were assigned a common code of 7. These octal codes from all the neighbors were then converted to three-bit binary numbers which were used separately to build three LBP-like codes using respective bit position. More details and numerical example can be found in [28].It is clear from Eq. (1) that the computation of LBP requires three major steps:1.Compute the GLD between a center pixel and its neighbors.Encode the GLD using a binary quantization function which retains the sign information only.Get the LBP code by converting the binary pattern into a decimal form.Resulting GLD after the first step can take up any value in the range of (−255, 255) assuming 8-bit gray scale images. The second step encodes the GLD using a binary quantization function. In other words, the output range of difference operator is quantized into two levels as shown in Fig. 1(a). Such two-valued encoding function leads to computational simplicity. However, the information about the magnitude of the difference is completely lost in the process which limits the discrimination capability of LBP. To overcome this limitation, Ylioinas et al. [27] proposed to combine LBP with contrast information to improve gender classification performance. The contrast information was computed using the local variance measure (VAR) as follows:(6)VARP,R(xc,yc)=1P∑p=0P−1(gp−μ)2,whereμ=1P∑p=0P−1gpAs variance measure provides a continuous valued output, they proposed to quantize the feature space for obtaining histogram descriptor. However, there are two major issues with this approach: (1) to determine the cut values for histogram bins, additional training stage is required. (2) The choice of the number of bins is also crucial for better classification performance. If the less number of bins are chosen, it reduces the discrimination ability while the large number of bins increases the feature size which may result in unstable histograms.To avoid aforementioned issues, we propose a generalized form of LBP which implicitly captures both the magnitude and sign information from the gray level difference. The generalized form of LBP builds upon the basic idea of quantizing the output range of GLD operator. However, instead of limiting up to a binary quantization, we propose to quantize the output range into multiple levels and hence the resulting patterns will be known as multi-quantized local binary patterns (MQLBP). Multi-level quantization of GLD is carried out using a thresholding parameter t as shown in Fig. 1(c) and (d). It is important to note that MQLBP is conceptually different from LTP. As shown in Fig. 1(b) LTP quantizes GLD into three fixed levels, whereas the MQLBP extends the idea to quantize GLD into desired number of levels. Moreover, LTP ignores the sign information when GLD is quantized into middle level (level 0) which limits its discrimination power. As shown in Fig 1(c) and (d), our proposed method overcomes this limitation by symmetrically quantizing the GLD with respect to zero. The proposed quantization function fL(x, t) for level L (L > 0) is formally defined as follows:(7)fL(x,t)={0,x<−(L−1)t1,−(L−1)t≤x<−(L−2)t⋮L−1,−t≤x<0L,0≤x<tL+1,t≤x<2t⋮2L−2,(L−2)t≤x<(L−1)t2L−1,x≥(L−1)tThus 1-level quantization, as used in original LBP, segments the whole output range in two different parts. At each higher level of quantization, each sub-part is further quantized into two different segments. Hence, it results in a total of 2L segments and MQLBP code corresponding to ith segment is computed as follows:(8)MQLBPP,R,Li(xc,yc)=∑p=0P−1δ(fL(gp−gc,t)−i)2p,{i=1,L=10≤i≤2L−1,L>1The binary function δ(x) is defined as below:(9)δ(x)={1,x=00,otherwiseTo describe each face image using MQLBP, spatially enhance histograms are computed as suggested in [14]. Each MQLBP image is divided into non-overlapping rectangular blocks to compute local histograms which are concatenated to build a feature vector. These feature vectors of all MQLBP images are further concatenated to build a final face descriptor. The flowchart summarizing the steps involved in the proposed algorithm is illustrated in Fig. 2. It is clear that feature dimension is directly proportional to number of levels used in computing MQLBP. To demonstrate more discrimination power of MQLBP while keeping lower feature dimensionality, we consider only two-level MQLBP in this work.Fig. 3shows the numerical example, which also highlights computational differences between LBP, LTP and MQLBP. It is important to note that MQLBP is capable of retaining both the sign and magnitude information about the GLD computed in the first step outlined above. Hence, we hypothesize that MQLBP should enhance the discrimination ability of LBP. An example showing improved discrimination ability of 2-level MQLBP over LBP and CLBP is shown in Fig. 4. The figure shows sample face images of each gender from PAL database. As shown in the figure, the enlarged rectangular patches of both the images represent the same sign vector (CLBP_S). Hence, the resulting LBP and CLBP_S codes are the same as shown in the figure. However, it is difficult to state that both the patches share similar local structure because they belong to two different genders.Though, CLBP can improve the discrimination ability by the use of magnitude component (CLBP_M), their CLBP_S codes are still the same. Hence, out of two CLBP codes, only one of them is different in contrast to four different codes generated by MQLBP. Thus, the less correlation between the MQLBP codes of two different patches may provide better discrimination as compared to CLBP. To obtain the required codes we have assumed the threshold t = 5, without loss of generality.Before presenting experimental results, we would like to highlight the differences between the proposed work and the work in [27]. To make comparison easier, the differences are tabulated in Table 1.Further, it is possible to have the same contrast measure for two different texture patterns. To understand this point, consider the illustrative example shown in Fig. 5which shows two different blocks and resulting codes for LBP, variance (VAR) and MQLBP. As shown in the figure, the LBP and VAR result in the same codes for both the blocks. However, it is difficult to conclude that they have the same texture. Thus the combination of LBP and VAR fails to distinguish the difference between the patterns represented by these blocks. However, our proposed method provides different codes for each block and thus capable to discriminate between them. In this example, the VAR values are considered to be exactly same. However, even if their continuous values are not exactly the same, their discrete values may still fall into the same histogram bin after quantization which can limit the discrimination capability.

@&#CONCLUSIONS@&#
