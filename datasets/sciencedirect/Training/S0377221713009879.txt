@&#MAIN-TITLE@&#
Tandem queueing system with infinite and finite intermediate buffers and generalized phase-type service time distribution

@&#HIGHLIGHTS@&#
Tandem queueing system with generalized phase-type service time distribution is investigated.The ergodicity condition and the steady-state distribution of the system states are analyzed.Some key performance measures are calculated.The Laplace–Stieltjes transform of the sojourn time distribution of customers is derived.The numerical examples are presented.

@&#KEYPHRASES@&#
Queueing,Tandem queueing system,Marked Markovian arrival process,Phase-type distribution,Laplace–Stieltjes transform,

@&#ABSTRACT@&#
A tandem queueing system with infinite and finite intermediate buffers, heterogeneous customers and generalized phase-type service time distribution at the second stage is investigated. The first stage of the tandem has a finite number of servers without buffer. The second stage consists of an infinite and a finite buffers and a finite number of servers. The arrival flow of customers is described by a Marked Markovian arrival process. Type 1 customers arrive to the first stage while type 2 customers arrive to the second stage directly. The service time at the first stage has an exponential distribution. The service times of type 1 and type 2 customers at the second stage have a phase-type distribution with different parameters. During a waiting period in the intermediate buffer, type 1 customers can be impatient and leave the system. The ergodicity condition and the steady-state distribution of the system states are analyzed. Some key performance measures are calculated. The Laplace–Stieltjes transform of the sojourn time distribution of type 2 customers is derived. Numerical examples are presented.

@&#INTRODUCTION@&#
Tandem queueing systems are very important part of the queueing theory that takes into account the possibility that a customer may need service from several sequentially arranged servers. The overwhelming majority of the results in the theory of tandem queues is obtained for systems with stationary Poisson arrival process and exponential service time distribution. Tandem queueing systems with correlated arrival flows were investigated not so extensively. For background information and overview of the present state of the art in the study of tandem queueing systems with correlated arrival flows and phase-type service time distribution see, e.g., Gomez-Corral (2002a, 2002b), Klimenok, Breuer, Tsarenkov, and Dudin (2005), Gomez-Corral and Martos (2006), Klimenok, Kim, Tsarenkov, Breuer, and Dudin (2007), Kim, Park, Dudin, Klimenok, and Tsarenkov (2010), and Kim, Dudin, Dudin, and Dudina (2013a). The papers Gomez-Corral (2002a, 2002b) and Gomez-Corral and Martos (2006) are devoted to theMAP/PH/1→•/G/1system with blocking. The tandem queueBMAP/G/1/N→•/PH/1/Mwith losses is considered in Klimenok et al. (2005). The tandem-queue of theBMAP/G/1→•/PH/1/Mtype with losses and feedback is investigated in Klimenok et al. (2007). Analysis of theBMAP/G/1→•/PH/1/Mtandem queue with retrials and losses is provided in Kim et al. (2010). In Kim et al. (2013a), a tandem queueing system with more than one server in each stage, Markovian arrival flow, and phase-type service time distribution at the second stage is considered.In this paper, we analyze a tandem queueing system with two types of customers. Type 1 customers arrive to the first stage that represents a multi-server queue without buffer. After service completion at the first stage, type 1 customers leave the system or move to the second stage. Type 2 customers arrive to the second stage directly. The second stage is a multi-server queue with a finite buffer for type 1 customers and an infinite buffer for type 2 customers. Type 1 customers have non-preemptive priority over type 2 customers. They can be impatient and leave the intermediate buffer without service.In order to study the effect of variation and correlation within the arrival process as well as the correlation of arrivals of different types of customers, we consider a Marked Markovian arrival process(MMAP)to model customer arrivals. Additionally, we assume that the service time of different types customers has a phase-type(PH)distribution with different parameters. This allows us to take into account the variance of the service time. Note that using a phase-type distribution significantly increases the dimension of the system state space and complicates the investigation of the system. To overcome these difficulties to some extent, we use the method proposed by Ramaswami (1985) and Ramaswami and Lucantoni (1985), for reducing the dimension of the state spaces of systems with a phase-type service time distribution, and consider a generalized phase-type distribution of the service times at the second stage instead of considering two separate phase-type distributions for each type of customers, that greatly facilitates the investigation of the system.The queueing system under consideration is quite general and can be applied for modeling many real-world systems. Let us introduce several examples of such systems:(i)Contact-center with an IVR (Interactive Voice Response). Type 1 customers can be interpreted as calls and type 2 customers are the text requests (e’mails). The first stage server represents an IVR and the second stage server is a contact center operator. E’mail requests arrive to the second stage directly and are always patient. Callers are firstly serviced by an IVR. If the caller cannot solve his (her) problem by using an IVR, he (she) can request to connect with an operator and move to the second stage. Type 1 customers can be impatient. The service times of e’mail requests and calls are different.Manufacturing system. The system processes two types of details. Type 1 details need some preprocessing while type 2 details do not require such a preprocessing. After the preprocessing, type 1 details should be processed during a limited time (e.g., if the preprocessing includes heating of details, type 1 details should be processed before they become cool).Database. The system processes queries from external users, who need preliminary identification and are non-patient, along with the requests from the internal users to retrieve or update information.Information transmission system. More important information should be encrypted prior transmission and transmitted more urgent than some less important information which is sent without encryption.Medical system. Emergency surgery center has several rooms for anesthesiology and operation theatre. Depending on the type of injury, some arriving patients need more urgent treatment after a preliminary general anesthetic, while others may wait longer time and do not need general anesthetic at all.The paper is organized as follows. In Section 2, the mathematical model is described. In Section 3, the process of the system states is considered. The ergodicity condition and the stationary state distribution are analyzed in Section 4. The expressions for the main performance measures of the system are given in Section 4. The Laplace–Stieltjes transform of the sojourn time distribution of an arbitrary type 2 customer is presented in Section 5. Section 6 contains numerical examples. Section 7 concludes the paper.We consider a tandem queueing system with two types of customers and two intermediate buffers. The structure of the system under study is presented in Fig. 1.Customers arrive to the system according to the MMAP. The customers in the MMAP are heterogeneous and have different types. The arrival of customers is directed by the stochastic processνt,t⩾0, which is an irreducible continuous-time Markov chain with the state space{0,1,…,W}. The sojourn time of this chain in the stateνis an exponentially distributed with the positive finite parameterλ(ν). When the sojourn time in the stateνexpires, with probabilitypν,ν′(0)the processνtjumps to the stateν′without generation of a customer,ν,ν′=0,W‾,ν≠ν′, and with probabilitypν,ν′(l)the processνtjumps to the stateν′with a generation of type l customer,l=1,2,ν,ν′=0,W‾. The notationν=0,W‾means that the parameterνtakes values in the set{0,1,…,W}.The behavior of the MMAP is completely characterized by the matricesD0,D1(l),l=1,2, defined by the entries(D1(l))ν,ν′=λ(ν)pν,ν′(l),ν,ν′=0,W‾,l=1,2, and(D0)ν,ν=-λ(ν),ν=0,W‾,(D0)ν,ν′=λ(ν)pν,ν′(0),ν,ν′=0,W‾,ν≠ν′. The matrixD(1)=D0+D1(1)+D1(2)represents the generator of the processνt,t⩾0.The average total arrival intensityλis defined byλ=θD1(1)+D1(2)ewhereθis the invariant vector of the stationary distribution of the Markov chainνt,t⩾0. The vectorθis the unique solution to the systemθD(1)=0,θe=1. Hereinafteredenotes a column vector consisting of 1’s, and0is a zero row vector. The average arrival intensityλlof type l customers is defined byλl=θD1(l)e,l=1,2.The squared integral (without differentiating the types of customers) coefficient of variationcvarof the intervals between customer arrivals is defined bycvar=2λθ(-D0)-1e-1. The squared coefficient of variationcvar(l)of inter-arrival times of type l customers is defined bycvar(l)=2λlθ-D0-D1(l′)-1e-1,l′≠l,l′,l=1,2.The integral coefficient of correlationccorof two successive intervals between arrivals is defined byccor=(λθ(-D0)-1(D(1)-D0)(-D0)-1e-1)/cvar.The coefficient of correlationccor(l)of two successive intervals between type l customers’ arrivals is computed byccor(l)=λlθD0+D1(l′)-1D1(l)D0+D1(l′)-1e-1/cvar(l),l′≠l,l′,l=1,2.We assume that type 1 customers arrive to the first stage, while type 2 customers arrive to the second stage directly, not entering the first stage. The first stage is described by an R-server queueing system without buffer. The service time for each server at this stage has an exponential distribution with the parameterμ.After receiving service at the first stage, type 1 customer proceeds to the second stage of the tandem with probability q,0⩽q⩽1, or leaves the system forever (is lost) with the complementary probability. The second stage represents an N-server queue with a finite buffer of capacity K for type 1 customers (buffer 1) and an infinite buffer for type 2 customers (buffer 2).If there is a free server at the second stage during an arbitrary customer arrival epoch, the customer occupies this server immediately. If all servers are busy and buffer 1 is not full during an arbitrary type 1 customer arrival epoch, the customer is admitted to this buffer. Otherwise, type 1 customer leaves the system forever (is lost). If all servers at the second stage are busy during a type 2 customer arrival epoch, this customer moves to buffer 2.We suggest that type 1 customers have priority, i.e., if there is at least one type 1 customer in buffer 1 during the service completion epoch, the next service will be provided to type 1 customer. Otherwise, type 2 customer is taken for service if he (she) is presenting in buffer 2. For customers of the same type the service discipline is First-In-First-Out.At the second stage, type 1 customers can be impatient, i.e., the customer leaves buffer 1 after an exponentially distributed time described by the parameter α,0<α<∞, after arrival, due to a lack of service.The service time of type l customer for the second stage server has a phase-type distributionPHlwith an irreducible representation(βl,Sl),l=1,2. This service time can be interpreted as the time until the underlying Markov processmt(l),t⩾0, with the finite state space{1,…,Ml,Ml+1}reaches the single absorbing stateMl+1conditioned on the fact that the initial state of this process is selected among the states{1,…,Ml}according to the probabilistic row vectorβl,l=1,2. The transition rates of the processmt(l)within the set{1,…,Ml}are defined by the sub-generatorSland the transition rates into the absorbing state (what leads to service completion) are given by the entries of the column vectorS0(l)=-Sle,l=1,2. Note that the representation(βl,Sl)is irreducible if the matrixSl+S0(l)βlis irreducible,l=1,2.The service time distribution function has the formAl(x)=1-βleSlxe, the Laplace–Stieltjes transform(LST)∫0∞e-sxdAl(x)of this distribution isβl(sI-Sl)-1S0(l),Res>0,l=1,2. The mean service time of type l customer at the second stage is calculated byb1(l)=βl(-Sl)-1e,l=1,2. The squared coefficient of variation of type l customer is given bycvar(l)=b2(l)/b1(l)2-1whereb2(l)=2βl(-Sl)-2e.Let us note that the queueing system under consideration is complicated for analysis. So, the task of the optimal choice of the process of the system states is extremely important.The behavior of the queueing system under study can be described in terms of the following regular irreducible continuous-time Markov chain:ξt(1)=it,rt,kt,nt,νt,ωt(1),…,ωt(nt),ζt(1),…,ζt(min{it,N}-nt),t⩾0,whereitis the number of customers at the second stage,it⩾0,rtis the number of customers at the first stage,rt=0,R‾,ktis the number of type 1 customers in buffer 1,kt=0,max{0,min{it-N,K}}‾,ntis the number of type 1 customers in service,nt=0,min{it,N}}‾,νtis the state of the underlying process of the MMAP,νt=0,W‾,ωt(m)is the state of mth server that serves type 1 customer,m=1,nt‾,ωt(m)=1,M1‾,ζt(l)is the state of lth server that serves type 2 customer,l=1,min{it,N}-nt‾,ζt(l)=1,M2‾, during the epocht,t⩾0.It is evident that the Markov chainξt(1)has a huge dimension of the state space even for small dimensions of underlying MMAP and PH processes. Computation of the performance measures of the queueing system under consideration even on advanced computer seems to be extremely difficult task. To reduce the dimension of the stochastic processξt(1)we use the method proposed by Ramaswami (1985) and Ramaswami and Lucantoni (1985), for reducing the dimension of the state space of systems with a phase-type service time distribution. The main idea of this method is the following. Instead of the consideration of the componentsωt(1),…,ωt(nt)andζt(1),…,ζt(min{it,N}-nt), it is proposed to consider the componentsωt(1),…,ωt(M1)andζt(1),…,ζt(M2), which mean the following:•ωt(m)is the number of servers at the phase m of service of type 1 customers,m=1,M1‾,ωt(m)=0,nt‾,∑m=1M1ωt(m)=nt;ζt(l)is the number of servers at the phase l of service of type 2 customers,l=1,M2‾,ζt(l)=0,min{it-nt,N}‾,∑l=1M2ζt(l)=min{it-nt,N}.Then to reduce the dimension of the process of system states instead of the Markov chainξt(1)we should consider the Markov chainξt(2)=it,rt,kt,nt,νt,ωt(1),…,ωt(M1),ζt(1),…,ζt(M2),t⩾0.Despite on the fact that the Markov chainξt(2)has more suitable dimension of the state space for investigation in comparison to Markov chainξt(1), its complicated structure is not conducive to the analysis.In order to greatly simplify the investigation of the queue under study, instead of considering the service times of type 1 and type 2 customers we propose to consider a generalized processing time having distribution which we call as a generalized phase-type distribution with an irreducible representation(β(1),β(2),S).The time having such a distribution can be interpreted as the time until the underlying Markov processηt,t⩾0, with the finite state space{1,…,M,M+1}, whereM=M1+M2, reaches the single absorbing stateM+1. The initial state of this process is selected among the states{1,…,M}depending on the type of a customer who is chosen for service. If an arbitrary type 1 customer is chosen for service, the initial state of this process is selected according to the probabilistic row vectorβ(1)=(β1,0M2)and, if type 2 customer is chosen for the service, the initial state is selected according to the probabilistic row vectorβ(2)=(0M1,β2). The transition rates of the processηtwithin the set{1,…,M}are defined by the sub-generatorS=S1OOS2and the transition rates into the absorbing state (which lead to the service completion) are given by the entries of the column vectorS0=-Se.If we use a generalized phase-type distribution, we do not consider the service process of each type of customers separately. Using of a generalized phase-type distribution instead of consideration of two separate phase-type distributions does not change the dimension of the state space of the Markov chain, but allows us to eliminate from the consideration of the componentnt(the number of type 1 customers in service) that greatly simplifies the investigation of the system under study and allows us to construct the generator, obtain the ergodicity condition, and find sojourn time distribution more or less easily.So, instead of the Markov chainξt(2)we assume that the behavior of the system under study is described in terms of the regular irreducible continuous-time Markov chainξt={it,rt,kt,νt,ηt(1),…,ηt(M)},t⩾0,whereηt(m)is the number of servers at the phase m of generalized service,m=1,M‾,ηt(m)=0,min{it,N}‾,∑m=1Mηt(m)=min{it,N}, during the epoch t,t⩾0.For further use throughout this paper, we introduce the following notation:•I is the identity matrix;⊕and⊗indicate the symbols of Kronecker sum and product of matrices, respectively;W‾=W+1,R‾=R+1,K‾=K+1,Ki=max{0,min{i-N,K}}+1,i⩾0;Ti=i+M-1M-1=(i+M-1)!i!(M-1)!,i=0,N‾;Cl=diag{0,1,…,l-1};I‾is the square matrix of sizeK‾with all zero entries except the entry(I‾)0,0=1;I^l,l=R‾,K‾, is the square matrix of size l with all zero entries except the entry(I^l)l-1,l-1=1;Il+,l=R‾,K‾, is the square matrix of size l with all zero entries except the entriesIl+i,i+1,i=0,l-2‾, which are equal to 1;Il-,l=R‾,K‾, is the square matrix of size l with all zero entries except the entriesIl-i,i-1,i=1,l-1‾, which are equal to 1;E‾l,l=2,K+1‾, is the matrix of sizel×(l-1)with all zero entries except the entry(E‾l)0,0=1;El+,l=1,K+1‾, is the matrix of sizel×(l+1)with non-zero entriesEl+i,i+1,i=0,l-1‾, which are equal to 1;El-,l=2,K+1‾, is the matrix of sizel×(l-1)with all zero entries except the entriesEl-i,i-1,i=1,l-1‾, which are equal to 1;E∼l,l=1,K‾, is the matrix of sizel×(l+1)with all zero entries except the entries(E∼l)i,i,i=0,l-1‾, which are equal to 1.Let us enumerate the states of the Markov chainξt,t⩾0, in the reverse lexicographic order of the componentsη(1),…,η(M)and in the direct lexicographic order of the componentsν,kand refer to(i,r)as macro-state consisting ofW‾KiTmin{i,N}states. Let Q be the generator of the Markov chainξt,t⩾0, consisting of the blocksQi,j, which, in turn, consist of the matrices(Qi,j)r,r′of the transition rates of this chain, from the macro-state(i,r)to the macro-state(j,r′),r,r′=0,R‾. The diagonal entries of the matricesQi,iare negative, and the modulus of the diagonal entry of the blocks(Qi,i)r,rdefines the total intensity of leaving the corresponding state of the Markov chainξt,t⩾0.Analysing all transitions of the Markov chainξt,t⩾0, during an interval of an infinitesimal length and rewriting the intensities of these transitions in the block matrix form we obtain the following result.Lemma 1The infinitesimal generatorQ=(Qi,j)i,j⩾0of the Markov chainξt,t⩾0, has a block-tridiagonal structure:Q=Q0,0Q0,1OO…OOOOO…Q1,0Q1,1Q1,2O…OOOOO…OQ2,1Q2,2Q2,3…OOOOO…⋮⋮⋱⋱⋱⋮⋮⋮⋮⋮…OOOO…QN+K,N+K-1Q1Q2OO…OOOO…OQ0Q1Q2O…OOOO…OOQ0Q1Q2…⋮…⋮⋮⋮⋮⋮⋮⋱⋱⋱.The non-zero blocksQi,j,i,j⩾0, have the following form:Qi,i=-μCR‾⊗IKiW‾Tmin{i,N}+IR‾Ki⊗D0⊗ITmin{i,N}+IR‾KiW‾⊗(Amin{i,N}(N,S)+Δ(min{i,N}))+I^R‾+IR‾+⊗IKi⊗D1(1)⊗ITmin{i,N}+(1-q)μCR‾IR‾-⊗IKiW‾Tmin{i,N}-αIR‾⊗CKi⊗IW‾Tmin{i,N},0⩽i<N+K,Qi,i=Q1=-μCR‾⊗IK‾W‾TN+IR‾K‾⊗D0⊗ITN+IR‾K‾W‾⊗(AN(N,S)+Δ(N))+I^R‾+IR‾+⊗IK‾⊗D1(1)⊗ITN+(1-q)μCR‾IR‾-⊗IK‾W‾TN-αIR‾⊗CK‾⊗IW‾TN+qμCR‾IR‾-⊗I^K‾⊗IW‾TN,i⩾N+K,Qi,i-1=IR‾W‾⊗LN-i(N,S̃),1⩽i⩽N,Qi,i-1=IR‾⊗Ei-N+1-⊗IW‾⊗L1+E‾i-N+1⊗IW‾⊗L2+αCi-N+1Ei-N+1-⊗IW‾TN,N<i⩽N+K,Qi,i-1=Q0=IR‾⊗IK‾-⊗IW‾⊗L1+I‾⊗IW‾⊗L2+αCK‾IK‾-⊗IW‾TN,i>N+K,Qi,i+1=qμCR‾IR‾-⊗IW‾⊗Pi(β(1))+IR‾⊗D1(2)⊗Pi(β(2)),0⩽i<N,Qi,i+1=qμCR‾IR‾-⊗Ei-N+1+⊗IW‾TN+IR‾⊗E∼i-N+1⊗D1(2)⊗ITN,N⩽i<N+K,Qi,i+1=Q2=qμCR‾IR‾-⊗IK‾+⊗IW‾TN+IR‾K‾⊗D1(2)⊗ITN,i⩾N+K,whereL1=L0(N,S∼)PN-1(β(1)),L2=L0(N,S̃)PN-1(β(2)),Δ(0)=0,Δ(i)=-diag{Ai(N,S)e+LN-i(N,S∼)e},i=1,N‾.The detailed description of the matricesPi(β(l)),l=1,2,i=0,N-1‾,Ai(N,S)andLi(N,S∼),i=0,N‾, and the algorithms for their calculation can be found inKim, Dudin, Taramin, and Baek (2013b).The entries of the blocksQi,i+1,i⩾0, define the intensities of the transitions of the Markov chainξt,t⩾0, that increase the number of customers at the second stage by one. This can happen only if type 1 or type 2 customer arrives to the second stage. Let us consider three possible cases:(a)The number of customers at the second stagei<N(there is a free server). There are the following events that increase the number of customers at this stage:•Arrival of type 1 customer to the second stage after receiving service at the first stage. The entries of the matrixqμCR‾IR‾-⊗IW‾⊗Pi(β(1))define the intensities of the event that the number of customers at the first stage decreases by one (a customer completes service at this stage), type 1 customer proceeds to the second stage and starts service at this stage.Arrival of type 2 customer. The intensities of this event are defined by the entries of the matrixIR‾⊗D1(2)⊗Pi(β(2)).Note that the matrixPi(β(l)),l=1,2, defines the transition probabilities of the processηt(1),…,ηt(M),t⩾0, at the epoch of starting new service of type l customer given that i servers are busy.The number of customers at the second stageN⩽i<N+K(all servers are busy and an arriving customer can join the buffer). The following events are possible:•Type 1 customer enters the second stage and joins buffer 1. The entries of the matrixqμCR‾IR‾-⊗Ei-N+1+⊗IW‾TNdefine the intensities of the event that the number of customers at the first stage decreases by one, the number of type 1 customers in buffer 1 increases by one.Type 2 customer enters the second stage and joins buffer 2. The intensities of this event are defined by the entries of the matrixIR‾⊗E∼i-N+1⊗D1(2)⊗ITN.The number of customers at the second stagei⩾N+K. There are the following possible events:•Arrival of type 1 customer to the second stage from the first stage. Then the number of customers at the second stage increases only if an arriving customer joins buffer 1 (if buffer 1 is not full). The intensities of this event are given by the entries of the matrixqμCR‾IR‾-⊗IK‾+⊗IW‾TN.Arrival of type 2 customer to the second stage. The intensities of this event are given by the entries of the matrixIR‾K‾⊗D1(2)⊗ITN.Since the component k has the state space{0,…,max{0,min{i-N,K}}}, then fori⩾N+Kthe state space of the component k does not depend on i, and the blocksQi,i+1also do not depend on i and equal the matrixQ2.The entries of the blocksQi,i-1,i⩾1, define the intensities of the transitions of the Markov chainξt,t⩾0, that decrease the number of customers at the second stage by one. This can happen if(a)an arbitrary customer completes service or(b)type 1 customer leaves the system due to impatience.If there are no customers in buffer 1 and buffer 2, i.e.,i⩽N, only event(a)is possible. Its intensities are given by the entries of the matrixIR‾W‾⊗LN-i(N,S∼). Note that the matrixLN-i(N,S∼)defines the intensities of the transitions of the processηt(1),…,ηt(M),t⩾0, during the service completion epoch given that i servers are busy during this epoch.If the number of customers in the buffers does not exceed K, i.e.,i=N+1,N+K‾, then both events are possible. The intensities of event(a)are given by the entries of the matrixIR‾⊗Ei-N+1-⊗IW‾⊗L1if there are type 1 customers in buffer 1, and by the entries of the matrixIR‾⊗E‾i-N+1⊗IW‾⊗L2, otherwise. The intensities of event(b)are given by the entries of the matrixIR‾⊗αCi-N+1Ei-N+1-⊗IW‾TN.By analogy, if the number of customers in the buffers exceeds K, i.e.,i>N+K, then both events are also possible and their intensities are given by the entries of the matricesIR‾⊗IK‾-⊗IW‾⊗L1,IR‾⊗I‾⊗IW‾⊗L2andIR‾⊗αCK‾IK‾-⊗IW‾TN, respectively. The blocksQi,i-1,i>N+K, are equal to the matrixQ0, since the state space of the component k does not depend on i fori>N+K.The non-diagonal entries of the blocksQi,i,i⩾0, define the intensities of the transitions of the chainξt,t⩾0, that do not lead to the change of the number of customers at the second stage. If the number of customers at the second stagei<N+K, the following events are possible:(a)the transition of the processνtwithout generation of customers;(b)the transition of the processνtwith generation of type 1 customer;(c)loss of type 1 customer after service at the first stage and(d)the transition of the processηt(1),…,ηt(M),t⩾0, which does not lead to the service completion at the second stage. The intensities of events(a),(b),(c)and(d)are given by the non-diagonal entries of the matricesIR‾Ki⊗D0⊗ITmin{i,N},IR‾+⊗IKi⊗D1(1)⊗ITmin{i,N},(1-q)μCR‾IR‾-⊗IKiW‾Tmin{i,N}andIR‾KiW‾⊗Amin{i,N}(N,S), respectively.The diagonal entries of the matrixQi,iare negative and the modulus of each entry defines the total intensity of leaving the corresponding state of the chainξt,t⩾0. The diagonal entries of the matrix-μCR‾⊗IKiW‾Tmin{i,N}+IR‾Ki⊗D0⊗ITmin{i,N}+I^R‾⊗IKi⊗D1(1)⊗ITmin{i,N}+IR‾KiW‾⊗(Amin{i,N}(N,S)+Δ(min{i,N}))+(1-q)μCR‾IR‾-⊗IKiW‾Tmin{i,N}-αIR‾⊗CKi⊗IW‾Tmin{i,N},i<N+K, define, up to sign, the total intensity of leaving the corresponding state of the chain.Note that the matrixAi(N,S)defines the intensities of the transitions of the processηt(1),…,ηt(M),t⩾0, which do not lead to the service completion, while the moduli of the diagonal entries of the matrixΔ(i)define the total intensity of leaving the corresponding states of this process given that i servers are busy.Fori⩾N+K, the blocksQi,ido not depend on i and are equal to the matrixQ1.Since the probability that more than one arrival can occur and more than one customer can leave the system during the interval of an infinitesimal length is negligible, the blocksQi,jare zero matrices for|i-j|>1, thus the generator Q has a block-tridiagonal structure.□The Markov chainξt,t⩾0, belongs to the class of continuous-time quasi-birth-and-death processes, see, e.g.,Neuts (1981).It follows from Neuts (1981) that the necessary and sufficient ergodicity condition of the quasi-birth-and-death process is the fulfillment of the inequality(1)yQ0e>yQ2e,where the row vectoryis the unique solution to the following system of linear algebraic equationsy(Q0+Q1+Q2)=0,ye=1.Let us suppose that the vectoryhas the form(y0,y1,…,yR). Note that the matrixQ0+Q1+Q2has a block-tridiagonal structure and we propose the following numerically stable algorithm for calculation of the sub-vectorsyr,r=0,R‾.Step 1.Calculate the matricesQr,r,Qr,r+1andQr,r-1which are the diagonal, the updiagonal and the subdiagonal blocks of the matrixQ0+Q1+Q2respectively:Qr,r=IK‾⊗D0+δR,RD1(1)+D1(2)⊗ITN+IK‾W‾⊗(AN(N,S)+Δ(N))+IK‾-⊗IW‾⊗L1+I‾⊗IW‾⊗L2-μrIK‾W‾TN+αCK‾IK‾--IK‾⊗IW‾TN,r=0,R‾,Qr,r+1=IK‾⊗D1(1)⊗ITN,r=0,R-1‾,Qr,r-1=qμrI^K‾+IK‾+⊗IW‾TN+(1-q)μrIK‾W‾TN,r=1,R‾,whereδi,jis the Kronecker delta.Calculate the matricesAr,r=0,R-1‾, using the backward recursionAR-1=-QR-1,R(QR,R)-1,Ar=-Qr,r+1(Qr+1,r+1+Ar+1Qr+2,r+1)-1,r=R-2,R-3,…,0.Calculate the matricesFrusing the recurrent formulasF0=I,Fr=Fr-1Ar-1,r=1,R‾.Calculate the sub-vectory0as the unique solution to the following systemy0(Q0,0+A0Q1,0)=0,y0∑r=0RFre=1.Calculate the sub-vectorsyr=y0Fr,r=1,R‾.If ergodicity condition (1) of the Markov chainξtis fulfilled, then the stationary probabilities of the system statesπ(i,r,k,ν,η(1),…,η(M)),i⩾0,r=0,R‾,k=0,max{0,min{i-N,K}}‾,ν=0,W‾,η(m)=0,min{i,N}‾,m=1,M‾, exist. Let us form the row vectorsπ(i,r,k,ν)of these probabilities enumerated in the reverse lexicographic order of the componentsη(1),…,η(M). Then let us form the row vectorsπ(i,r,k)=(π(i,r,k,0),π(i,r,k,1),…,π(i,r,k,W)),k=0,max{0,∈{i-N,K}}‾,π(i,r)=(π(i,r,0),π(i,r,1),…,π(i,r,max{0,min{i-N,K}})),r=0,R‾,πi=(π(i,0),π(i,1),…,π(i,R)),i⩾0.It is well known that the probability vectorsπi,i⩾0, satisfy the following system of linear algebraic equations:(π0,π1,…,πi,…)Q=0,(π0,π1,…,πi,…)e=1where Q is the infinitesimal generator of the Markov chainξt,t⩾0. To solve this system the numerically stable algorithm that takes into account that the matrix Q has a block-tridiagonal structure, which is presented in Dudin, Kim, and Dudina (2013), could be proposed.As soon as the vectorsπi,i⩾0, have been calculated, we are able to find various performance measures of the system.The probabilityPloss(1)that an arbitrary type 1 customer will be lost at the first stage is computed byPloss(1)=1λ1∑i=0∞π(i,R)IKi⊗D1(1)⊗ITmin{i,N}e.The average numberN(1)of busy servers at the first stage is computed byN(1)=∑i=0∞∑r=1Rrπ(i,r)e.The average intensityλout(1)of flow of customers, who receive service at the first stage, is computed byλout(1)=N(1)μ.The average numberN(2)of busy servers at the second stage is computed byN(2)=∑i=1∞min{i,N}πie.The average numberN1bufferof type 1 customers in buffer 1 is computed byN1buffer=∑i=N+1∞∑r=0R∑k=1min{i-N,K}kπ(i,r,k)e.The average numberN2bufferof type 2 customers in buffer 2 is computed byN2buffer=∑i=N+1∞∑r=0R∑k=0min{i-N,K}(i-N-k)π(i,r,k)e.The average numberLsystemof customers in the system is computed byLsystem=∑i=0∞∑r=0R(i+r)π(i,r)e.The average intensityλoutof flow of customers, who receive service at the second stage, is computed byλout=∑i=1∞πi(IR‾KiW‾⊗Lmax{0,N-i}(N,S∼))e.The probabilityPloss(2)that an arbitrary type 1 customer will be lost at the second stage is computed byPloss(2)=1-λout-λ2qλout(1).The probabilityPloss2-entthat an arbitrary type 1 customer will be lost at the entrance to the second stage is computed byPloss2-ent=λout(1)-1∑i=N+K∞∑r=1Rrμπ(i,r,K)e.The probabilityPloss2-impthat, after arrival to the second stage, an arbitrary type 1 customer will go to the buffer and leave it due to impatience is computed byPloss2-imp=Ploss(2)-Ploss2-ent.The average intensityλouttype1of flow of type 1 customers, who receive service at the second stage, is computed byλouttype1=1-Ploss(2)qλout(1).Because type 1 customers have a priority, they leave the system due to impatience and restriction on the total number of type 1 customers at the second stage, the upper bound of their sojourn time is more or less clear. So, we concentrate on the consideration of the sojourn time of type 2 customers.We will derive the distribution of an arbitrary type 2 customer’s waiting and sojourn time in terms of the LST. LetW(x)be the distribution function of the sojourn time of an arbitrary type 2 customer in the system under study andw(s)=∫0∞e-sxdW(x),Res>0, be its LST.To derive the expression for the LSTw(s)we use the method of collective marks (method of additional event, method of catastrophes) (see, e.g., Kesten & Runnenburg (1956) and van Danzig (1955)). Let us tag an arbitrary type 2 customer and keep track of its staying in the system. We interpret the variable s as the intensity of some virtual stationary Poisson flow of catastrophes. Thus,w(s)has the meaning of the probability that no catastrophe arrives during the sojourn time of the tagged type 2 customer.Letw(s,n,r,k,ν,η(1),…,η(M))be the probability that catastrophe will not arrive during the tagged type 2 customer’s sojourn time in the system conditioned on the fact that, during the given moment, the position of the tagged customer in buffer 2 isn,n⩾1, the number of customers at the first stage isr,r=0,R‾, the number of type 1 customers in buffer 1 is equal tok,k=0,K‾, the state of the processνtisν, the states of the processesηt(1),…,ηt(M)areη(1),…,η(M)respectively,t⩾0.Let us enumerate the probabilitiesw(s,n,r,k,ν,η(1),…,η(M))in the lexicographic order of components as indicated above and form the column vectorsw(s,n,r,k)from these probabilities.Theorem 1The LSTw(s)of distribution of an arbitrary type 2 customer’s sojourn time in the system is computed byw(s)=λ2-1∑i=0N-1πi(IR‾⊗D1(2)⊗ITi)eβ2(sI-S2)-1S0(2)+∑i=N∞∑r=0R∑k=0min{i-N,K}π(i,r,k)D1(2)⊗ITNw(s,i-N-k+1,r,k).The following situations are possible during the arrival epoch of the tagged type 2 customer:•There is an idle server during the arrival epoch of the tagged customer and this customer immediately starts getting service. The probability of this event isλ2-1∑i=0N-1πi(IR‾⊗D1(2)⊗ITi)e. In this case, the probability that no catastrophe arrives during the sojourn time is equal to the probability that no catastrophe arrives during the service time of type 2 customer and is given asβ2(sI-S2)-1S0(2).All servers are busy during the arrival epoch and the tagged customer joins buffer 2. The probability of this event isλ2-1∑i=N∞∑r=0R∑k=0min{i-N,K}π(i,r,k)D1(2)⊗ITNe. In this case, the probability that no catastrophe arrives during the sojourn time of the tagged type 2 customer under the fixed values of the componentsn,r,kis equal tow(s,i-N-k+1,r,k)e.Using the law of total probability one can verify the validity of the theorem.□So, for calculation of the LSTw(s)we must compute the vectorsw(s,n,r,k). Let us introduce the column vectorsw(s,n,r)=(w(s,n,r,0),…,w(s,n,r,K))T,w(s,n)=(w(s,n,0),…,w(s,n,R))T.Theorem 2The column vectorsw(s,n),n⩾1, are computed byw(s,1)=(sI-Ω)-1a(s),w(s,n)=(sI-Ω)-1Ψw(s,n-1),n>1,whereΩ=-μCR‾⊗IK‾W‾TN+IR‾K‾⊗D0+D1(2)⊕(AN(N,S)+Δ(N))+I^R‾+IR‾+⊗IK‾⊗D1(1)⊗ITN+αIR‾⊗CK‾IK‾--IK‾⊗IW‾TN+IR‾⊗IK‾-⊗IW‾⊗L1+μCR‾IR‾-⊗qI^K‾+IK‾++(1-q)IK‾⊗IW‾TN,Ψ=IR‾⊗I‾⊗IW‾⊗L2,a(s)=eR‾⊗ẽ⊗((IW‾⊗L2)e)β2(sI-S2)-1S0(2),andẽis the column vector of sizeK‾with all zero entries except the entry(ẽ)0=1.Based on a probabilistic sense of the LST and the law of total probability, the vectorsw(s,n,r,k)can be found from the following system of linear algebraic equations:(2)w(s,n,r,k)=[(s+kα+rμ)I-D0⊕(AN(N,S)+Δ(N))]-1×(1-δr,R)D1(1)⊗ITNw(s,n,r+1,k)+δr,RD1(1)+D1(2)⊗ITNw(s,n,r,k)+rμ((1-q)+δk,Kq)w(s,n,r-1,k)+(1-δk,K)rμqw(s,n,r-1,k+1)+δk,0δn,1(IW‾⊗L2)eβ2(sI-S2)-1S0(2)+δk,0(1-δn,1)IW‾⊗L2w(s,n-1,r,0)+(1-δk,0)(IW‾⊗L1+kαIW‾TN)w(s,n,r,k-1),n⩾1,r=0,R‾,k=0,K‾.Let us explain formula (2) in brief. The diagonal entries of the matrix in the square brackets in (2) are equal to the total intensity of the events which can happen after an arbitrary epoch: catastrophe arrival, the transition of the underlying process of the MMAP, the transition of any underlying process of the generalized PH service processes, abandon of type 1 customers from the buffer, and the service completion of type 1 customer at the first stage. The non-diagonal entries of the matrix in the square brackets in (2) are equal to the intensities of the transition of the MMAP underlying process without generation of a customer, the transition of one of generalized PH underlying processes which does not lead to the service completion (these events do not impact on the components n, r and k). The first term in the round brackets in (2) corresponds to the case when type 1 customer is admitted at the first stage of the system. In this case the number of customers at the first stage (the component r) increases by one. The second term in the round brackets in (2) corresponds to the cases when type 1 customer is rejected at the first stage upon arrival and type 2 customer is admitted at the second stage. In this case the values of the components n, r and k do not change. The third term corresponds to the cases when type 1 customer leaves the system after the service completion at the first stage. In this case the number of customers at the first stage decreases by one. The fourth term corresponds to the case when type 1 customer is admitted to the second stage. In this case the number of customers at the first stage decreases by one, and the number of type 1 customers in buffer 1 (the component k) increases by one. The fifth term correspond to the case when during the service completion epoch at the second stage there are no type 1 customers in buffer 1, the tagged customer has the first position in buffer 2 and is chosen for service. The numberβ2(sI-S2)-1S0(2)defines the probability that catastrophe will not arrive during the service time of the tagged customer. The sixth term corresponds to the case when during the service completion epoch at the second stage there are no type 1 customers in buffer 1 and there are type 2 customers that arrive to the system before the tagged customer. In this case the position of the tagged customer in buffer 2 (component n) decreases by one. Finally, the seventh term corresponds to the case when type 1 customer leaves the buffer (starts service or leaves the buffer due to impatience).System (2) can be rewritten into the matrix form as(3)(-sI+Ω)w(s,n)+(1-δn,1)Ψw(s,n-1)+δn,1a(s)=0T,n⩾1.It can be verified that the diagonal entries of the matrixΩ-sIdominate in all rows of this matrix. So the inverse matrix exists. Thus, based on (3) one can verify the validity of the theorem.□The average sojourn timeVsojof an arbitrary type 2 customer is calculated byVsoj=λ2-1b1(2)∑i=0N-1πiIR‾⊗D1(2)⊗ITie--∑i=N∞∑r=0R∑k=0min{i-N,K}π(i,r,k)D1(2)⊗ITNw′(s,i-N-k+1,r,k)|s=0,where the column vectorsw′(s,n,r,k)|s=0are calculated as the blocks of the vectorw′(s,n)|s=0which can be computed as followsw′(s,1)|s=0=Ω-1[e-a′(s)|s=0],w′(s,n)|s=0=Ω-1[e-Ψw′(s,n-1)|s=0],n>1.Herea′(s)|s=0=-b1(2)eR‾⊗ẽ⊗((IW‾⊗L2)e).Formula for the calculation of the average sojourn time of an arbitrary type 2 customer is based on the definitionVsoj=-w′(s)|s=0taking into account thatw(s,n)|s=0=e,n≥1.□The average waiting timeVwaitof an arbitrary type 2 customer is calculated byVwait=Vsoj-b1(2).In Experiment 1, we investigate the impact of the coefficient of correlation in the arrival flow on the system performance measures.For this purpose, let us introduce three MMAPs defined by the matricesD0,D1(1)andD1(2). All these MMAPs have the same average total arrival intensityλ, the average intensity of type 1 customersλ1=34λ, the average intensity of type 2 customersλ2=14λ, but different coefficients of correlation.MMAPxdefines the MMAP arrival process with the coefficient of correlationccor=x.The first process, coded asMMAP0, is defined by the matricesD0=(-λ),D1(1)=34λandD1(2)=14λ. It has the coefficients of correlationccor=ccor(l)=0and the coefficients of variationcvar=cvar(l)=1,l=1,2. In this case, the arrival processes of type 1 and type 2 customers are defined as the stationary Poisson processes.The second process, coded asMMAP0.2, is defined by the matricesD0=λ-1.3516200-0.04384,D1(1)=λ1.006990.006730.018320.01457,D1(2)=λ0.335660.002240.006100.00485,has the coefficients of correlationccor(1)=0.17,ccor(2)=0.07and the coefficients of variationcvar=12.34,cvar(1)=10.55,cvar(2)=5.21.The third process, coded asMMAP0.4, is defined by the matricesD0=λ-3.3976700.00101-0.11019,D1(1)=λ2.521720.026540.009090.07280,D1(2)=λ0.840570.008840.003030.02426.It has the coefficients of correlationccor(1)=0.38,ccor(2)=0.28and the coefficients of variationcvar=12.39,cvar(1)=11.92,cvar(2)=9.20.We assume that the number of servers at the first stageR=8, the service intensity at the first stageμ=0.8, the probabilityq=0.2, the number of servers at the second stageN=8, the intensityα=0.5, the buffer capacity for type 1 customersK=8.PH1service process of type 1 customers at the second stage is characterized by the vectorβ1=(1)and the matrixS1=(-1). The mean service timeb1(1)of type 1 customers at the second stage is equal to 1.PH2service process of type 2 customers at the second stage is characterized by the vectorβ2=(1)and the matrixS2=(-0.5). The mean service timeb1(2)of type 2 customers at the second stage is equal to 2.Let us vary the average total arrival intensityλin the interval[1,15]in steps of 0.1.Figs. 2, 3illustrate the dependence of the average number L of customers in the system, the average sojourn timeVsojof type 2 customers, the average intensitiesλoutof flow of customers andλouttype1of flow of type 1 customers, who receive service at the second stage, the loss probabilityPloss(1)of an arbitrary type 1 customer at the first stage, the average intensityλout(1)of flow of customers, who receive service at the first stage, the loss probabilityPloss(2)of an arbitrary type 1 customer at the second stage and the probabilityPloss2-impthat an arbitrary type 1 customer will join buffer 1 and leave it due to impatience on the average arrival intensityλfor different MMAPs.It is clearly evident from Figs. 2 and 3 that an increase in the average arrival intensity leads to an increase in the average intensities of output flows, the loss probabilities of type 1 customers and the average sojourn time of type 2 customers. So, with increasing average arrival intensity the quality of service becomes worse. Based on figures presented one can conclude that the coefficient of correlation in the arrival process has a profound impact on the system performance measures and taking into account the correlation in the arrival flow is extremely important for adequate modeling of the system performance. For example, when the coefficient of correlation increases, the average output intensitiesλouttype1,λout(1)andλoutdecrease essentially, while the loss probability of type 1 customers at the first stage increases essentially. Additionally, the fulfillment of the ergodicity condition depends on the coefficient of correlation in the arrival flow. In the example under consideration, the ergodicity condition is not fulfilled forλ⩾14.1in case ofMMAP0, forλ⩾14.4in case ofMMAP0.2and forλ⩾14.9in case ofMMAP0.4. This finding can be explained as follows. As it was mentioned above, for arrival flows with small coefficients of correlation the loss probability of type 1 customers at the second stage is less than for arrival flows with high coefficients of correlation. Thus, for arrival flows with small coefficients of correlation more type 1 customers arrive to the second stage thereby increasing the load of the second stage and lead to an earlier violation of the ergodicity condition. It also explains the dependence of the average number L of customers in the system and the average sojourn timeVsojof an arbitrary type 2 customer on the average arrival intensityλforλ>13. Note for example, that for the stationary Poisson arrival flows withλ=13the average sojourn time of an arbitrary type 2 customerVsoj=5.23, while underλ=14the average sojourn timeVsoj=327.71, i.e., increasing the average arrival flow of 7.7% (changeλfrom 13 to 14) leads to an increase in the average sojourn timeVsojby more than 62 times. Prediction of such behavior without corresponding calculations is unrealistically difficult task, so this proves the necessity of the presented research.The numerical results also show that the following equalities hold true:Vsoj-b1(2)=Vwait=N2bufferλ2,N1bufferλout(1)=Ploss2-impα.The first equality is the famous Little formula. The second equality can be explained as follows. Let us rewrite it in the formαN1buffer=λout(1)Ploss2-imp. The left and the right sides of the equality define the intensity of type 1 customers leaving buffer 1 due to impatience, so the equality is correct.In Experiment 2, let us show the impact of the coefficient of variation in the service processes of type 1 and type 2 customers at the second stage on the main performance measures of the system. To this end, we consider three cases of PH service processes of type 1 and type 2 customers.The first case corresponds to the exponential service time distributions of type 1 and type 2 customers. We assume that the service time of type 1 customers is defined by the vectorβ1=(1)and the matrixS1=(-1). The service time of type 2 customers is defined by the vectorβ2=(1)and the matrixS2=(-0.5). These processes have the same coefficient of variationcvar=1.In the second case, we assume that the service time distribution of type 1 customers is characterized by the vectorβ1=(1,0)and the matrixS1=-220-2, and the service time distribution of type 2 customers is characterized by the vectorβ2=(1,0)and the matrixS2=-110-1. These processes have the same coefficient of variationcvar=0.5.In the third case, we assume that the service time distribution of type 1 customers is characterized by the vectorβ1=(0.1,0.9)and the matrixS1=-0.233190.011630.13989-2.54192, and the service time distribution of type 2 customers is characterized by the vectorβ2=(0.1,0.9)and the matrixS2=-0.116590.005810.06994-1.27096. These processes have the same coefficient of variationcvar=5.Note that in all cases under consideration the average service time of type 1 customersb1(1)=1and the average service time of type 2 customersb1(2)=0.5, but the service processes have different values of the coefficient of variationcvar.Let us fix the number of servers at the first stageR=5, the service intensity at the first stageμ=0.8, the probabilityq=0.5, the number of servers at the second stageN=4, the buffer capacity for type 1 customersK=5. We assume that arrivals are defined by theMMAP0.4arrival process presented in the first experiment with the arrival intensityλ=1, the coefficient of correlationccor=0.4and the coefficient of variationcvar=12.39.Let us vary the intensity of impatienceαin the interval[0.01,4].Fig. 4illustrates the dependence of the average waiting timeVsojof type 2 customers, the average numberN1bufferof type 1 customers in buffer 1, the probabilityPloss2-entthat an arbitrary type 1 customer will be lost at the entrance to the second stage, and the loss probabilityPloss(2)of an arbitrary type 1 customer at the second stage on the intensity of impatienceαfor PH service processes with different coefficients of variation.As it is seen from Fig. 4, with growth of the intensity of impatienceαthe average sojourn time of type 2 customers decreases. This finding can be explained as follows. When the intensity of impatience increases, the loss probability of type 1 customers at the second stagePloss(2)also increases. Because type 1 customers have a priority over type 2 customers, the loss of type 1 customers decreases the average waiting time (and also the average sojourn time) of type 2 customers. For the same reason the average number of type 1 customers in buffer 1 essentially decreases with an increase in the intensity of impatience which in turn leads to decrease in the loss probability of type 1 customers due to buffer 1 overflow.Another important conclusion from Fig. 4 is that the coefficient of variation in the service process affects the system performance measures. So, for adequate prediction of the system operation it is necessary to take into account the variation in the service process.

@&#CONCLUSIONS@&#
