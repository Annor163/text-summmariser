@&#MAIN-TITLE@&#
Retinal vessel segmentation using multi-scale textons derived from keypoints

@&#HIGHLIGHTS@&#
We present a retinal vessel segmentation approach that uses textons.Vessel textons are derived from responses of a multi-scale Gabor filter bank.We train on keypoint descriptors instead of labelled ground truth.We show our unsupervised approach performs well compared to previous work.Our method outperforms other unsupervised approaches on the Drive data set.

@&#KEYPHRASES@&#
Retinal vessel,Image segmentation,Texton,Keypoints,

@&#ABSTRACT@&#
This paper presents a retinal vessel segmentation algorithm which uses a texton dictionary to classify vessel/non-vessel pixels. However, in contrast to previous work where filter parameters are learnt from manually labelled image pixels our filter parameters are derived from a smaller set of image features that we call keypoints. A Gabor filter bank, parameterised empirically by ROC analysis, is used to extract keypoints representing significant scale specific vessel features using an approach inspired by the SIFT algorithm. We first determine keypoints using a validation set and then derive seeds from these points to initialise a k-means clustering algorithm which builds a texton dictionary from another training set. During testing we use a simple 1-NN classifier to identify vessel/non-vessel pixels and evaluate our system using the DRIVE database. We achieve average values of sensitivity, specificity and accuracy of 78.12%, 96.68% and 95.05%, respectively. We find that clusters of filter responses from keypoints are more robust than those derived from hand-labelled pixels. This, in turn yields textons more representative of vessel/non-vessel classes and mitigates problems arising due to intra and inter-observer variability.

@&#INTRODUCTION@&#
The visual appearance of the retina in digital fundus images is an important indicator of eye disease and can be diagnostic of a range of more general issues relating to health and wellbeing. As such, fundus photography is also used in screening programmes for diseases such as diabetes and hypertension and the morphological properties of retinal vessels are reported in routine clinical and ophthalmological examinations. The projected increase in patients suffering from these disorders together with the tedious nature and high cost of manual examination has motivated research into computer assisted tools that can improve precision, consistency and throughput. Vessel segmentation is a key stage in all published work on interactive and fully-automated computer analysis and diagnosis systems and the focus of our research.Features such as the displacements of blood vessels within the optic disk (OD) have been used for automated diagnosis of diseases such as Glaucoma, age-related macular degeneration (AMD), diabetic retinopathy (DR) and vascular disorders etc. [1–5]. In many systems the retinal blood vessels are segmented and used to generate a mask which enables the vessels to be eliminated from subsequent stages of the processing pipeline. Since pathologic changes in the vessel structure manifest the progress of various systemic diseases such as hypertension, diabetes, etc., other tools use features extracted directly from segmented retinal blood vessels to detect or grade the condition. Vessels also play a role as landmarks that describe the locations of other elements in the image [6] or provide features that are used for multimodal image registration [7].The importance of retinal vessel segmentation has motivated the development of accurate retinal vessel segmentation methods. However although much progress has been made, vessel segmentation is still a challenging problem that remains a focus for ongoing research [14,31–33]. The primary factors that challenge the accuracy of the segmentation include:•Variations in vessel and non-vessel objects, such as the wide range of vessel diameters and the presence of pathological features including haemorrhage, exudates and microanerurysms, etc.Variations in local and global image appearance due to illumination that in turn may give rise to various image artefacts. For example, reflection at the vessel surface and refraction within it can produce complex intensity profiles and singularities in the image. Additionally, low and unstable local intensity contrast between the vessels and background may cause miss-segmentation of the small capillary vessels.Morphological characteristics of vessels (e.g. how they cross and overlap) and the extremely noisy background can influence the accuracy of segmentation and this is especially challenging for segmentation approaches that attempt to recover vessel structures by region growing and tracking of individual vessel components.Amongst the methods and algorithms that have been presented for retinal vessel segmentation, those that use prior knowledge (supervised methods) produce correspondingly better segmentation results. Generally, supervised segmentation procedures can be divided into two primary stages. First, small local regions sharing similar visual properties are detected by a low-level algorithm, then those candidate regions are classified as vessel or non-vessel based on a set of features extracted from the region. Machine learning is often employed to train vessel/non-vessel classifiers based on ground truth labels. In this context, ground truth is derived from reference fundus images that have been manually segmented and precisely labelled by one or more clinical experts. Describing such segmentations using the term ground truth can be misleading due to the high intra and inter-observer variability in expert manual segmentations. This is some cause for concern and suggests that supervised segmentation methods may benefit from unsupervised training techniques that compensate for this variability.Although supervised segmentation methods (reviewed in Section 2) are more competitive in terms of performance than unsupervised approaches [36–38], their dependence on ground-truth and the problem of intra- and inter-observer variability limits their robustness [34]. In this and many other fields of medical image understanding, ground truth tends to be sparse as the laborious and skilled nature of the task makes it very expensive to acquire. Even when suitable image databases with corresponding ground truth labels are published, inaccuracies in the segmentation labels will lead to poor performance. Computational complexity is also an issue, especially for supervised vessel segmentation methods that use filter banks to extract vessel and non-vessel features. For instance, matched filters can provide a powerful tool to extract numerous features, however they are computationally expensive since many filter kernels need to be applied to the image. Learning matched filter banks is also expensive due to the high cost of clustering and classifying high dimensional feature vectors. With this in mind, we propose a different approach for retinal vessel segmentation in fundus images which extends previously published work [17–19]. Our technique uses the Gabor filter kernel to extract vessel features in a set of training images. We optimise scale parameters for the filter bank by performing receiver operating curve (ROC) analysis on segmentations produced by a conventional texton classifier trained learning using hand labelled pixels (see Section 3.1). We then use the filter bank to identify so-called keypoints in a (validation) training set. Candidate keypoints are found by searching for local maxima in filter outputs, both spatially and across scales (see Section 3.2) and keypoint descriptors are stored in a dictionary which is indexed by scale. Once we have learnt a set of keypoint features we build the texton dictionary in a further training cycle. The texton dictionary is built by clustering the multi-scale Gabor filter bank outputs from another set of example images. Vessel clusters are seeded by cluster centres corresponding to keypoint pixels (one at each scale) which are identified by a matching process and a further cluster centre is seeded to form a background (non-vessel) cluster. This two-stage approach allows us to decouple parameter selection from training, so avoiding possible over fitting while also supporting the possibility of using different databases for model selection and training. During testing we assign pixels as vessel or non-vessel by using the texton dictionary as a 1-NN classifier. Our experimental results show that the performance achieved by this filter bank is comparable to that of approaches that use more complex kernels.The rest of this paper is organised as follows. Section 2 reviews some supervised and unsupervised retinal vessel segmentation methods. In Section 3.1, we describe the design of a Gabor filter kernel for feature extraction, and explain how we specify and optimise its parameters. In Sections 3.2 and 3.3 we describe how we identify keypoints and generate textons. Section 4 describes how we evaluate of our method and compares performance with that of other methods. Finally, in Section 5, we present conclusions, discuss limitations of the approach and propose further work.

@&#CONCLUSIONS@&#
