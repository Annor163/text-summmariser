@&#MAIN-TITLE@&#
Some properties of LR-splines

@&#HIGHLIGHTS@&#
A polynomial representation formula for the LR B-spline collection is shown.The number of functions of the LR B-spline collection whose support contains a point is studied.The close relation between the above properties is asserted.

@&#KEYPHRASES@&#
Locally refinable splines,Linear independence,Polynomial representation,Quasi-interpolant,Overlap,

@&#ABSTRACT@&#
Recently a new approach to piecewise polynomial spaces generated by B-spline has been presented by T. Dokken, T. Lyche and H.F. Pettersen, namely Locally Refined splines. In their recent work (Dokken et al., 2013) they define the LR B-spline collection and provide tools to compute the space dimension. Here different properties of the LR-splines are analyzed: in particular the coefficients for polynomial representations and their relation with other properties such as linear independence and the number of B-splines covering each element.

@&#INTRODUCTION@&#
B-splines are a basis of piecewise polynomials on tensor-product meshes. Their rational counterpart, the NURBS, are the standard tool to represent shapes in Computers Aided Design. This choice was motivated both by the flexibility of B-splines and NURBS for the parametrization of relevant geometric shapes, and by the existence of efficient and stable algorithms to modify, refine and evaluate them. B-splines are available for any polynomial degree and allow different choices of smoothness on the inter-element boundaries. Because of these properties B-splines are a promising choice for the development of Galerkin methods for both ODEs and PDEs. This choice has been proposed in Hughes et al. (2005) under the name of isogeometric analysis (the same functions are used for geometry and analysis). Isogeometric analysis has given a new momentum to the research both in the field of geometric design and numerical analysis of PDEs. A more comprehensive description of isogeometric analysis can be found in Cottrell et al. (2009). The main advantages of the isogeometric method are:•the NURBS geometry is exactly represented within the solver, and is preserved by refinements;the refinement of the space is flexible: both p-, h- and k-refinement are possible, the latter being a combination of the first two (Hughes et al., 2005);it is possible to use highly smooth functions that enjoy superior approximation properties (Evans et al., 2009; Beirão da Veiga et al., 2011) and are the foundation of many isogeometric analysis schemes (Buffa et al., 2011a, 2011b; Evans and Hughes, 2012a, 2012b).The weakness of the B-spline basis, both as design and as analysis tool, is the tensor-product structure of the underlying mesh that hinders local refinements, and thus forces the use of big discrete spaces and causes a loss in efficiency. In the last two decades there were many attempts to overcome this limitation: in 1988 Forsay and Bartels introduced the hierarchical-splines (Forsey and Bartels, 1988), in 2003 Sederberg introduced T-splines (Sederberg et al., 2003, 2004) (see also the extension in Finnigan, 2008), in 2008 Deng, Chen, Li, Hu, Tong, Yang and Feng introduced PHT-splines (Deng et al., 2008), and in 2012 Dokken, Lyche, and Pettersen introduced LR-splines (Dokken et al., 2013). T-splines are the currently preferred framework for refinement in isogeometric analysis (Bazilevs et al., 2010). T-splines were initially introduced for Computer Aided Design and, at the beginning, their use in analysis has shown some difficulties. Indeed the generators can be linearly dependent (Buffa et al., 2010), they may produce severe fill-in of the mesh (Dörfel et al., 2010) and their properties are difficult to study. These problems were and are being addressed by researchers. For bivariate T-splines, most of these problems were solved by identifying a subset of T-meshes for which some fundamental properties hold. This subset is called analysis suitable T-splines (Scott et al., 2012; da Beirão et al., 2012; Li et al., 2012; Beirão da Veiga et al., 2012; Li and Scott, 2012). The development of LR-splines started in parallel to find an alternative refinement strategy. Contrarily to AS T-splines, LR-splines are defined from the description of the discrete space in terms of Bezier domains and continuity conditions. This point of view makes the theory more structured and organized.The present manuscript extends the work in Dokken et al. (2013) and provides some theoretical results about the LR B-spline collection. The following issues are addressed:1.the number of LR-splines with overlapping support;the partition of unity property of LR-splines;the adaptation of the blossoming formula for the representation of polynomials and the construction of quasi-interpolants on LR-splines spaces.In particular here it is proved that if there are not two B-splines in the LR B-spline collection whose supports are nested then the number of B-spline on each element equals the space dimension, moreover the LR B-spline collection is a partition of unity and the coefficients for polynomial representation are the same as in tensor product case. Actually all the properties above are equivalent to the more technical condition that there are no nested (see Definition 2.4) B-splines in the LR B-spline collection.These properties have a clear impact on the use of LR-splines in isogeometric analysis applications. E.g., from 1 it is possible to obtain a bound for the number of nonzero entries in mass and stiffness matrices in applications to PDEs and from 3 it is possible to define quasi-interpolants on the space spanned by the LR B-spline collection.This text is structured in the following way: Section 2 contains preliminary material about B-splines and box-meshes; this is a review of the content of Dokken et al. (2013). Section 3 contains the study of the overlap, that is the number of nonzero B-spline in each point of the domain. Section 4 deals with the coefficients of polynomial representations by reducing it to the tensor-product case. Section 5 summarizes the previous results and link them together.Note that all the results are valid for general box-meshes and not only for LR-meshes.This section contains a selection of the concepts and results from Dokken et al. (2013). There are few modifications and additions that are due the different focus. They are always highlighted and commented.This subsection shows the used notation for B-splines and introduces the concept of nested B-splines.A B-spline functionBΞ:R→Rof degree p is a right continuous piecewise polynomial of degree p uniquely identified by a knot vectorΞ=(ξ1⩽⋯⩽ξp+2)such thatξ1<ξp+2. Given ζ the multiplicity of ζ in Ξ ismΞ(ζ)=#{j:ξj=ζ}and it is related with the regularity ofBΞin ζ. IndeedBΞisCp−mΞ(ζ)on ζ. The support ofBΞissuppBΞ=[ξ1,ξp+2]. Multivariate B-splines are obtained by multiplying univariate B-splines. In particularBΞ:Rd→RwithΞ=(Ξ1,…,Ξd)andΞi=(ξi,1⩽⋯⩽ξi,pi+2)is the B-spline of degreep=(p1,…,pd)defined byBΞ(x)=∏i=1dBΞi(xi).The basic B-spline refinement method is knot insertion and consists in adding a new knot to the knot vector in order to obtain two new knots vectors of the same length. Here the knot insertion is seen as an operation on B-splines (it is described as knot vector refinement in Dokken et al., 2013).Definition 2.1The knot insertion operator associated to a directionk∈{1,…,d}isRk:{B-splines:Rd→R}×R×{1,2}→{B-splines:Rd→R}defined byRk(BΞ,ξ¯,σ)={BΞ,ξ¯∉]ξk,1,ξk,pk+2[,BΘσ,otherwisewhere the components ofΘσareΘσ,i={Ξi,i≠k,(ξk,1,…,ξ¯,…,ξk,pk+1),i=k∧σ=1,(ξk,2,…,ξ¯,…,ξk,pk+2),i=k∧σ=2.Definition 2.2A knot insertion is a tripletℵ=(B,k,ξ¯)where B is a B-splineRd→R,k∈{1,…,d}is a direction andξ¯∈Ris a knot. It is said that ℵ refines B and producesRk(B,ξ¯,1)andRk(B,ξ¯,2).Proposition 2.3For all knot insertions operatorsRk, allξ¯∈Rand B-splineBΞ:Rd→Rit holdsBΞ=c1Rk(BΞ,ξ¯,1)+c2Rk(BΞ,ξ¯,2),wherec1={0,ξ¯⩽ξk,1,ξ¯−ξk,1ξk,pk+1−ξk,1,ξ¯∈]ξk,1,ξk,pk+1],1,ξ¯>ξk,pk+1;c2={1,ξ¯⩽ξk,2,ξk,pk+2−ξ¯ξk,pk+2−ξk,2,ξ¯∈]ξk,2,ξk,pk+2],0,ξ¯>ξk,pk+2.Note that bothc1andc2are strictly positive whenRk(B,ξ¯,{1,2})≠{B}.Definition 2.4A B-splineBΞis nested in a B-splineBΘand it is writtenBΞ⊂NBΘif there exists a sequence of B-splinesBΘ=B1,…,Bn=BΞsuch that for alli=1,…,n−1there is a knot insertionℵithat refinesBiand producesBi+1.Nestedness is a partial order relation on B-splines and it implies the nestedness of the supports:B1⊂NB2⇒suppB1⊂suppB2. The converse is false. A counter-example issuppB(0,13,1)⊂suppB(0,23,1), butB(0,13,1)⊄NB(0,23,1).Proposition 2.5LetBΘ,BΞbe B-splines thenBΘ⊂NBΞif and only if the following hold fork=1,…,dmΘk(ζ)⩾mΞk(ζ)∀ζ∈]θk,1,θk,pk+2[,mΘk(ζ)⩽mΞk(ζ)∀ζ∉]ξk,1,ξk,pk+2[.Box-meshes are the basis of the LR-spline theory. A box is the generalization to any dimension of vertexes, edges, faces and elements that are usually associated to a quadrilateral mesh. There are minor differences compared to Dokken et al. (2013): here the multiplicity of mesh faces is not restricted to be greater that 0, and the definitions of boundary and interior of a box inRdare extended to boxes of arbitrary codimension.Definition 2.6A box inRdis a Cartesian product[a,b]=⨉i=1d[ai,bi]where fori=1,…,dai⩽biand thus[ai,bi]is a nonempty closed finite interval. The dimension of β isdim[a,b]=#{i:ai<bi}.A box of dimension k is called k-box.Usually boxes are denoted with Greek letters such asα,β,…etc.Definition 2.7The boundary of a boxβ=[a,b]is∂β=⋃i=1,…,d:ai<biJ1×Jˆi×JdwhereJˆi={ai,bi}.Definition 2.8The interior of box β isβ0=β∖∂β.Note that the boundary and interior of a k-box β are those corresponding to the topology induced on the k-dimensional affine subspace containing β.Definition 2.9LetΩ=[a,b]be a d-box inRd. A box partition of Ω is a finite collection of d-boxesEsuch that:•⋃β∈Eβ=Ω;∀β1,β2∈Eit holdsβ10∩β20=∅.Definition 2.10LetEbe a box partition of Ω andq∈Ω. Thenβqisβq(E)=⋂β∈E:q∈ββ.The above definition formalizes the intuitive description of the mesh a composition of vertexes, segments, …elements. Indeedβqis the least dimensional box containing q of this intuitive decomposition. To make this formalization work for points q that are in ∂Ω it is necessary to use the auxiliary partitionE∪Ω+where forΩ=[a,b]Ω+={J1×⋯×Jd:Ji∈{[ai−1,ai],[ai,bi],[bi,bi+1]}}∖{Ω}.Definition 2.11Given a box partitionEof Ω letF(E)={βq(E∪Ω+)}q∈Ω,F0(E)={βq(E∪Ω+)}q∈Ω0={βq(E)}q∈Ω0,Fk(E)={β∈F(E):dimβ=k},Fk0(E)={β∈F0(E):dimβ=k}.Definition 2.12μ-extended box-meshA μ-extended box-mesh on the d-box Ω inRdis a couple(M,μ)where:•MisFd−1(EM)for some box partitionEMof Ω;μ:M→Nis a function.The above definition is slightly more general than the corresponding Definition 2.5 in Dokken et al. (2013). Indeed in Dokken et al. (2013)μ is not allowed to take the value 0, this forbids L shaped Bezier domains. Here this restriction is not imposed.Definition 2.13μ-extended tensor meshA μ-extended box-tensor mesh inRdis a μ-extended box-mesh(M,μ)such that•EM={[a1,i1,a1,i1+1]×⋯×[ad,id,ad,id+1]:1⩽ik⩽nk−1,k=1,…,d}where theak,jare real number such that fork=1,…,dandi=1,…,nk−1ak,i<ak,i+1;for allβ1,β2∈Mcontained in the same hyperplane Hμ(β1)=μ(β2).Definition 2.14A polynomial of degreep=(p1,…,pd)is a polynomial of degree at mostpkin the variablexkfork=1,…,d. The space of polynomials of degree p isPpand it is the tensor-product⨂i=1dPpi(xi)wherePpi(xi)is the space of univariate polynomials in the variablexiof degree at mostpi.Definition 2.15The spline space of degree p associated to an extended box mesh(M,μ)isSp(M,μ)and it contains thef:Ω→Rsatisfying•f is right continuous in each variablexiand continuous on ∂Ω;f|β0is a polynomial of degree p for allβ∈Fd(M);f isCpk−μ(β)inβ0for allβ∈Fd−10(M)orthogonal to the k-th canonical vectorek,k=1,…,d.Note that all spline spaces corresponding to extended box-meshes contain the polynomials of degree p, i.e.Pp⊂Sp(M,μ).Proposition 2.16A B-spline functionBΞof degreepis inSp(M,μ)if and only if the following propositions hold true1.for allk=1,…,dandξk,i∈Ξk{q∈suppBΞ:qk=ξk,i}⊂⋃β∈Mβ;for allβ∈Fd−10(M)such thatβ⊂{q∈suppBΞ:qk=ξk,i}μ(β)⩾mΞk(ξk,i).The most interesting subclass of box-meshes are the LR-meshes. They are meshes that can be obtained by subsequent refinements of a tensor mesh. Given a μ-extended box-mesh(M,μ)and a(d−1)-box α it is possible to define(M,μ)+αas the μ-extended box-mesh(M˜,μ˜)corresponding to the partitionE˜={X¯:Xis a connected component ofβ∖α,β∈Fd(M)}and mapμ˜(β)={1,∄β′∈M:β⊂β′,μ(β′)+1,∃β′∈M:β⊂β′⊂α,μ(β′),∃β′∈M:β⊂β′⊄α.Definition 2.17LR-meshA μ-extended LR-mesh is a μ-extended box-mesh(M,μ)such that either(M,μ)is a tensor mesh or(M,μ)=(Mˆ,μˆ)+αfor an LR-mesh(Mˆ,μˆ)and a(d−1)-box α.This definition is equivalent to that in Dokken et al. (2013) where it is also required that after the insertion of a(d−1)-box αμ(β1)=μ(β2)for allβ1,β2⊂α. This requirement does not change the space of LR-meshes, but forces the use of a longer sequence of smaller insertions. This is linked with their main results: if all the insertions of a(d−1)-box α have the above property and some other conditions are met, thenSp(M,μ)is generated by the LR B-spline collection. See Dokken et al. (2013) for details.The B-spline graph was originally introduced in Appendix A of Dokken et al. (2013) to prove that the LR B-spline collection is well defined. Since it plays a central role in the results reported in this paper its definition is formalized. By using the B-spline graph it is possible to generalize the LR B-spline collection to arbitrary box-meshes. Indeed it can be viewed as the set of the reachable sinks of the B-spline graph associated to the mesh.Definition 2.18A knot insertionℵ=(B,k,ξ¯)is compatible with a set of B-splines X when•Rk(B,ξ¯,1)≠B≠Rk(B,ξ¯,2);B,Rk(B,ξ¯,1),Rk(B,ξ¯,2)∈X.Usually X will beSp(M,μ)and, in this case, it will be subsumed. Note also that if X is a linear space then, by Proposition 2.3, it is sufficient that any two of B,Rk(B,ξ¯,1)andRk(B,ξ¯,2)are in X to conclude that(B,k,ξ¯)is compatible with X. From Proposition 2.16 it follows that a knot insertion(BΞ,k,ζ)withBΞ∈Sp(M,μ)and aζ∈]ξk,1,ξk,pk+2[is compatible withS(M,μ)if and only if∀β∈M:β⊂{x:xk=ζ}∩suppBΞ,μ(β)>mΞk(ζ).This fact will be used in the form of the following proposition.Proposition 2.19Let(M,μ)be an extended box-mesh then the following implications hold for allBΘ,BΞ∈Sp(M,μ)such thatsuppBΘ⊂suppBΞ:1.ζ∈]θk,1,θk,pk+2[∧mΞk(ζ)>mΘk(ζ)implies that(BΘ,k,ζ)is compatible;ζ∈]θk,1,θk,pk+2[∧mΞk(ζ)=mΘk(ζ)∧(BΞ,k,ζ)compatible implies that(BΘ,k,ζ)is compatible.Definition 2.20The B-spline-graph ofSp(M,μ)is the directed graphGp(M,μ)whose vertexes are all the B-spline of degree p inSp(M,μ), and whose arrows are the couples(B1,B2)such thatB2=Rk(B1,ξ¯,σ)for some k,ξ¯and σ. An example is shown in Fig. 1.By definition a unique compatible knot insertion(B1,k,ξ¯)corresponds to each arrow(B1,B2)withB1≠B2. A couple of arrows(B1,Rk(B1,ξ¯,1))and(B1,Rk(B1,ξ¯,2))corresponds to each compatible knot insertion.Definition 2.21A path in a directed graph is a succession of vertexes(ϕ1,…,ϕn)such that for alli=1,…,n−1(ϕi,ϕi+1)is an arrow of the graph. A vertexB1is a predecessor of a vertexB2if there exist a path(B1=ϕ1,…,ϕn=B2)and a successor if there exists a path(B2=ϕ1,…,ϕn=B1). It is a direct predecessor when(B1,B2)is an arrow andB1≠B2. Likewise it is a direct successor when(B2,B1)is an arrow andB1≠B2. A vertex ϕ is reachable from a set of vertexes Ψ if there exists a path from a vertex in Ψ to ϕ.For all extended box-mesh and degree the corresponding B-spline-graph is oriented, finite and acyclic. This implies that it corresponds to a partial order relation. This partial order relation is a subset of the nestedness relation, i.e.B1is a successor ofB2impliesB1⊂NB2, but the converse is not true.Definition 2.22A vertex of a directed graphGthat has no direct predecessors is called a source. The set of all sources ofGisSr(G). The set of sources of a B-spline graphGp(M,μ)is shortened withSrp(M,μ).A vertex that have no direct successors is called a sink. The set of all sinks is denoted withSk(G). The set of sinks of a B-spline graphGp(M,μ)is shortened withSkp(M,μ).Note that for all degree p and mesh(M,μ)the set of the sourcesSrp(M,μ)contains the Bernstein polynomial basis ofPpfor Ω. The set of the Bernstein polynomials is denoted withBp(M,μ). See Fig. 1.Definition 2.23A vertex of a B-spline-graph B that is a successor of any of the Bernstein polynomials is said to be reachable. The set of reachable sinks isSkpr(M,μ).For an example of mesh such thatSkpr(M,μ)≠Skp(M,μ)see Fig. 2.The setSkpr(M,μ)is a generalization to arbitrary box-meshes of the LR B-spline collection for LR-meshes. The problem is that for general box-meshes (also LR-meshes) it is not true thatSp(M,μ)admits a basis composed of B-splines. Thus the approach in Dokken et al. (2013) is to define the LR B-spline collection and study when it spans the wholeSp(M,μ). To be useful the LR B-spline collection must depend only on the mesh and must be easily computable. Because of this it is defined in Dokken et al. (2013) as the result of an algorithm that corresponds to update iteratively the set of generators (of possibly a subspace) as the mesh is constructed. See Section 3.2 of Dokken et al. (2013).A variation of this procedure that is unrelated to the mesh construction and thus suitable to arbitrary box-meshes is shown in Algorithm 2.25. Both the original procedure and Algorithm 2.25 admit arbitrary choices. To prove that the result was independent of the choices the authors of Dokken et al. (2013) introduced the B-spline graph (see Appendix A of Dokken et al., 2013). Their proof works for Algorithm 2.25 without modification. Anyway an alternative proof is contained in this section.Definition 2.24LR B-spline collectionThe LR B-spline collection relative to a LR-mesh(M,μ)and a degree p is the setBobtained with the following algorithm.Roughly speaking to choose a compatible knot insertion is equivalent to searching for a B-spline in the temporary collection whose support is cut in two by a mesh-face that either it is not in its knot vector or it has higher multiplicity than the corresponding knot.The difference with the procedure in Dokken et al. (2013) is that there the choice of a compatible knot insertion(B,k,ξ¯)is mandated to follow the iterative construction of the LR-mesh.Theorem 2.26For all extended box-mesh(M,μ)and degreepthe result ofAlgorithm 2.25isB=Skpr(M,μ).Lemma 2.27Let(M,μ)be an extended box-mesh and(ϕ1,…,ϕn)be a path inGp(M,μ)such thatϕn∈Skp(M,μ). Then for all compatible knot insertionsℵ=(ϕ1,k0,ξ¯0)there exists a path(ϕ1′,…,ϕn′=ϕn)such thatϕ1′is produced by ℵ.ProofThe proof is constructive and the new path is built by selectingϕi′betweenϕi,Rk0(ϕi,ξ¯0,1)andRk0(ϕi,ξ¯0,2). Thus it is possible to simplify the notation by describing only thek0-th component of the knot vector ofϕi, let it beΞi=(ξi,1,…,ξi,pk0+2).Let(ϕi,ki,ξ¯i)be the knot insertion corresponding to the arrow(ϕi,ϕi+1). The construction is done by backward induction: it starts fromϕn′=ϕnand goes back tillϕ1′. Let ℓ beℓ=max{i:ξ¯0∈]ξi,1,ξi,pk0+2[∧mΞi(ξ¯0)=mΞ1(ξ¯0)}.Necessarilyℓ<nandkℓ=k0. Otherwise, by Proposition 2.19 and using thatϕn⊂Nϕ1, it would follow that(ϕn,k0,ξ¯0)is compatible and thusϕn∉Skp(M,μ). Fori=ℓ+1,…,nsetϕi′=ϕi.From Proposition 2.19 it follows that fori=1,…,ℓthe knot insertion(ϕi,k0,ξ¯0)is compatible. Then setϕℓ′toϕℓ′={ϕℓ+1,mΞ1(ξ¯0)+1=mΞℓ+1(ξ¯0),Rk0(ϕℓ,ξ¯0,1),ξ¯0⩾ξℓ+1,pk0+2,Rk0(ϕℓ,ξ¯0,2),ξ¯0⩽ξℓ+1,1.Thek0-th component of the knot vector ofϕℓ′is thusΞℓ′={Ξℓ+1,mΞ1(ξ¯0)+1=mΞℓ+1(ξ¯0),(ξℓ,1,…,ξℓ,pk0+1,ξ¯0),ξ¯0⩾ξℓ+1,pk0+2,(ξ¯0,ξℓ,2,…,ξℓ,pk0+2),ξ¯0⩽ξℓ+1,1.Then(ϕℓ′,kl,ξ¯ℓ)is compatible and producesϕℓ+1′=ϕℓ+1.Fori=1,…,ℓ−1ϕi′are defined based onϕi+1′. Whenki≠k0then setϕi′={Rk0(ϕi,ξ¯0,1),ϕi+1′=Rk0(ϕi+1,ξ¯0,1),Rk0(ϕi,ξ¯0,2),ϕi+1′=Rk0(ϕi+1,ξ¯0,2).OtherwiseΞi+1′is obtained fromΞiby inserting the two knotsξ¯0andξ¯i, thusΞi+1′is in one of the following groups of possibilities1.(ξi,1,…,ξ¯i,ξ¯0,…,ξi,pk0),(ξi,1,…,ξ¯0,…,ξi,pk0+1);(ξi,3,…,ξ¯i,ξ¯0,…,ξi,pk0+2),(ξi,2,…,ξ¯0,…,ξi,pk0+2);(ξi,2,…,ξ¯i,ξ¯0,…,ξi,pk0+1),To complete the proof of Theorem 2.26 it is enough to apply iteratively Lemma 2.27. Indeed the set of sinks reachable fromB=BmisBand from the above lemma it equals the set of sinks reachable fromBm−1. Proceeding by induction it follows thatBequals the set of sinks reachable fromB0=Bp(M,μ)and thusB=Skpr(M,μ).In this section the results about the number of B-splines that are non-null in the points of the domain are collected. The number ofB∈Skp(M,μ)such thatB(q)≠0depends on q. In order to avoid special cases forq∈⋃β∈Mβthe position and overlap are defined.Definition 3.1The position of a point q with respect of a B-splineBΞof degree p isposBΞ(q)=(c1,…,cd)∈⨉i=1d{0,…,pi+2}whereci=#{j:ξi,j⩽qi}. The position is a right continuous function of q and it is constant onβ0for allβ∈Fd(M).Note that ifposB(q)∈⨉i=1d{1,…,pi+1}thenq∈suppB. The converse can be false only ifq∈∂suppB. In particular ifq∉⋃β∈Mβthen#{B∈Skp(M,μ):posB(q)∈⨉i=1d{1,…,pi+1}}=#{B∈Skp(M,μ):q∈suppB}=#{B∈Skp(M,μ):B(q)≠0}.Definition 3.2The overlap of pointq∈Ω0for the B-spline graphGp(M,μ)isOp,M,μ(q)=#{B∈Skp(M,μ):posB(q)∈⨉i=1d{1,…,pi+1}}.The reachable overlapOp,M,μr(β)is the same withB∈Skpr(M,μ). The overlaps on the elements of a mesh(M,μ)such thatSkp(M,μ)≠Skpr(M,μ)are shown in Fig. 3.Definition 3.3The overlap of an extended box-mesh(M,μ)for the degree p isOp(M,μ)=maxq∈Ω0Op,M,μ(q).The reachable overlap isOpr(M,μ)=maxq∈Ω0Op,M,μr(q).Lemma 3.4Let(M,μ)be an extended box-mesh on Ω andpbe a degree. For everyq∈Ω0andc∈⨉i=1d{1,…,pi+1}there exists a uniqueB∈Skpr(M,μ)such that•posB(q)=c;∀B′∈Skp(M,μ)such thatposB′(q)=cit holdsB′⊂NB.ProofLetϕ1be the unique B-spline inBp(M,μ)such thatposϕ1(q)=c. Let(ϕ1,…,ϕm)be a path such thatposϕi(q)=cfori=1,…,mandϕm∈Skpr(M,μ). A path with the above properties can be constructed iteratively: ifϕi∉Skpr(M,μ)then choose a compatible knot insertion(ϕi,ki,ξ¯i)and setϕi+1={Rki(ϕi,ξ¯,1),ξ¯i−1>qki,Rki(ϕi,ξ¯,2),ξ¯i−1⩽qki.In this wayposϕi+1(q)=c. The B-splineϕmis the unique B-spline of the thesis.LetB′∈Skp(M,μ)such thatposB(q)=c. SincesuppB′⊂ΩthenB′⊂Nϕ1. It is possible to show thatB′⊂Nϕmby induction. Let(ϕi,ki,ξ¯i)be the knot insertion corresponding to(ϕi,ϕi+1),Θbe the knot vector ofB′,Ξibe that ofϕi, and assumeB′⊂Nϕi. The following propositions hold because of Proposition 2.5•mΘk(ζ)⩾mΞi,k(ζ)for allζ∈]θk,1,θk,pk+2[;mΘk(ζ)⩽mΞi,k(ζ)for allζ∉]ξi,k,1,ξi,k,pk+2[.#{ζ∈Ξi+1,k:ζ⩽qk}=#{ζ∈Θk:ζ⩽qk}=ckand thusmΘk(ζ)⩽mΞi+1,k(ζ)for allζ∈]−∞,ξi+1,k,1];#{ζ∈Θk:ζ>qk}=pk+2−ckand thusmΘk(ζ)⩽mΞi+1,k(ζ)for allζ∈[ξi+1,k,2+pk,∞[.Definition 3.5The B-spline of Lemma 3.4 corresponding to a point q and a position c is denoted withBq,c.Corollary 3.6For all extended box-mesh(M,μ)and degreepit holdsOp(M,μ)⩾Opr(M,μ)⩾∏i=1d(pi+1).ProofGivenq∈Ω0there isBq,cfor allc∈⨉i=1d{1,…,pi+1}. Since they are all distinctOp,M,μr(q)⩾∏i=1d(pi+1). The other inequality follows fromSkpr(M,μ)⊂Skp(M,μ). □Corollary 3.7Let(M,μ)be an extended box-mesh,pbe a degree andq∈Ω0be a point such thatOp,M,μr(q)=∏i=1d(pi+1). Then for allB∈Skpr(M,μ)such thatposB(q)=c∈⨉i=1d{1,…,pi+1}it holdsB=Bq,c.Corollary 3.8For all extended box-mesh(M,μ)and degreepit holdsOp(M,μ)=∏i=1d(pi+1)⇒Skp(M,μ)=Skpr(M,μ).To study the relations between overlap and nestedness it is convenient to introduce the following syntax to represent the set of components in which the positions relative to two B-splinesB1,B2agree at a point q:J(B1,B2,q)={j∈{1,…,d}:posB1(q)j∈{1,…,pj+1}posB1(q)j=posB2(q)j}.Lemma 3.9Let(M,μ)be an extended box-meshB1,B2∈Skpr(M,μ),q∈Ω0such thatH1.B1⊂NB2;Op,M,μr(q)=∏i=1d(pi+1);posB1(q)∈⨉i=1d{1,…,pi+1};#J(B1,B2,q)<d.B′∈Skpr(M,μ);B′≠B2andB′⊂NB2;posB′(q′)∈⨉i=1d{1,…,pi+1};J(B′,B2,q′)⊋J(B1,B2,q).ProofThe proof is constructive and is based on the existence of paths(η1,…,ηn)in the B-spline graph such thatηn∈Skpr(M,μ)and for alli=1,…,n,posηi(x)=cfor some point x andc∈⨉i=1d{1,…,pi+1}. Such paths can be constructed iteratively as done in the proof of Lemma 3.4.Let(ψ1,…,ψm)be a path fromBp(M,μ)such that for alli=1,…,mposψi(q)=posB2(q). From H2 and Corollary 3.7 it follows thatψm=B2. The proof is done by showing by induction that for alli=1,…,mthere existsϕi∈Sp(M,μ)such that:P1.ϕi⊂Nψi;posϕi(q)=posB1(q);B1is a successor ofϕi;∃qi=q+λiekisuch thatJ(ϕi,ψi,qi)⊃J(B1,B2,q)∪{ki};ϕiis reachable.ThenB′can be obtained fromϕmby following a path(ϕm=η1,…,ηn)such that fori=1,…,nposηi(qm)=posϕm(qm)andηn∈Skpr(M,μ). Indeed forB′=ηnandq′=qmthen T1 follows from P5, T2 follows from P1 and P3, T3 and T4 follow from P4.The first step is to prove the existence ofϕ1. Let(η1,…,ηn)be a path such thatη1∈Bp(M,μ),ηn∈Skpr(M,μ)andposηi(q)=posB1(q),i=1,…,n. From H2 and Corollary 3.7 it follows thatηn=B1and thus starting from some index s all theηifori⩾sare nested inψ1. Defineϕ1to beηs. By constructionϕ1is reachable (P5), it is nested inψ1(P1), and has properties P2 and P3.LetΘibe the knot vector ofηi,Ξbe that ofψ1and(ηs−1,k1,θ¯)be the knot insertion corresponding to(ηs−1,ηs). Sinceηs−1⊄Nψ1it follows from Proposition 2.5 that at least one of the following is true:•∃ζ¯∈]θs−1,k1,1,θs−1,k1,pk1+2[:mΘs−1,k1(ζ¯)<mΞk1(ζ¯);∃ζ¯∈{θs−1,k1,1,θs−1,k1,pk1+2}∖]ξk1,1,ξk1,2+pt[:mΘs−1,k1(ζ¯)>mΞk1(ζ¯).Assume now thatϕiandqiare given and let(ψi,k¯,ξ¯)be the knot insertion corresponding to the arrow(ψi,ψi+1). If(ϕi,k¯,ξ¯)is compatible setη1to the B-spline produced by(ϕi,k¯,ξ¯)and such thatposη1(q)=posB1(q). Otherwise setη1toϕi. Let(η1,…,ηn)be a path such thatηn∈Skpr(M,μ)andposηi(q)=posB1(q),i=1,…,n. Again from H2 and Corollary 3.7 it follows thatηn=B1and thus starting from some index s all theηifori⩾sare nested inψi+1. Setϕi+1=ηs. Also in this case P1, P2, P3 and P5 are consequences of the construction.LetΘibe the knot vector ofηiandΞbe that ofψi+1. By construction the only knot that can have greater multiplicity in the knot vector ofψi+1compared to that ofψiisξ¯in thek¯-th component ofΞ. Thus fromϕi⊂Nψi, Proposition 2.5, Proposition 2.19 and the construction ofη1it follows that for allk=1,…,d,i=1,…,sandζ∈]θi,k,1,θi,k,pk+2[it holds(2)mΘi,k(ζ)⩾mΞk(ζ).Whenη1⊄Nψi+1then the existence ofqi+1that realizes P4 is proved with the same argument as forq1. In this caseqi+1is a translation of q along the directionki+1of the refinement corresponding to(ηs−1,ηs). From Eq. (2) it follows also that fork∈J(B1,B2,q)andi=1,…,mit holds thatΘi,kis a refinement ofΞkand thus thatki+1∉J(B1,B2,q).Whenϕi+1=η1⊂Nψi+1there are two cases:k¯≠kiandk¯=ki. In the first case fork∈J(B1,B2,q)∪{ki}it holdsposψi+1(qi)k=posψi(qi)kand thus P4 holds settingqi+1=qi. Indeed from H3q∈suppϕi+1and thus alsoqi∈suppϕi+1because the extension ofsuppϕi+1along thekiaxis equals that ofsuppϕi. The last case is whenϕi+1=η1andk¯=ki. In this caseposψi+1(qi)kican be different fromposψi(qi)ki. When they are equal P4 holds settingqi+1=qi. Whenposψi+1(qi)ki=posψi(qi)ki+1thenqki<qi,kiandξ¯∈]qki,qi,ki]. From the definition of position it followsposϕi+1(qi)ki−posϕi+1(q)ki=#{θ∈Θs,ki∈]qki,qi,ki]}.Using Eq. (2) givesposϕi+1(qi)ki−posϕi+1(q)ki⩾posψi+1(qi)ki−posψi+1(q)ki=posψi(qi)ki−posψi(q)ki+1.But since at most one knot has been inserted also the other inequality holds:posϕi+1(qi)ki−posϕi+1(q)ki⩽posϕi(qi)ki−posϕi(q)ki+1and thusposϕi+1(qi)ki−posϕi+1(q)ki=posψi+1(qi)ki−posψi+1(q)kifrom which it followsposϕi+1(qi)ki=posψi+1(qi)ki. Thus ifposϕi+1(qi)ki<pki+2then P4 holds withqi+1=qi. Otherwise it means thatqiwas in the last knot span and the last knots along theki-th axis of bothψiandϕihad multiplicity 1. Together with Eq. (2) this implies that the multiplicities of the last knots along theki-th axis of bothψi+1andϕi+1are equal and thus it is possible to findqi+1by settingq1to a translation of q along theki-th axis such thatq1,ki∈]max{ζ∈Ξki∪Θs,ki:ζ<ξki,pki+2},ξki,pki+2[.Similarly whenposψi+1(qi)ki=posψi(qi)ki−1thenqki>qi,kiandξ¯∈]qi,ki,qki]. As above if the positions do not change or ifposψi+1(qi)ki>0then P4 holds withqi+1=qi. Otherwiseqi+1can be chosen as a translation of q along thekiaxis such thatqi+1,ki∈]ξki,1,min{ζ∈Ξki∪Θ1,ki:ζ>ξki,1}[.□Theorem 3.10Let(M,μ)be an extended box-mesh andpbe a degree, then the following two equivalences hold1.Opr(M,μ)=∏i=1d(pi+1)⇔∄B1,B2∈Skpr(M,μ):B1⊂NB2;Op(M,μ)=∏i=1d(pi+1)⇔∄B1,B2∈Skp(M,μ):B1⊂NB2.ProofIfOpr(M,μ)>∏i=1d(pi+1)then there existsq∈Ω0such thatOp,M,μr(q)>∏i=1d(pi+1). Thus there existB1,B2∈Skpr(M,μ)such thatposB1(q)=posB2(q)=c. At least one betweenB1andB2is different fromBq,cand thus nested in it (Lemma 3.4). To complete the proof of the first equivalence it is enough to show that the propositions “Opr(M,μ)=∏i=1d(pi+1)” and “∃B1,B2∈Skpr(M,μ):B1⊂NB2” are in contradiction. Assuming both and applying iteratively Lemma 3.9 it is possible to findB′∈Skpr(M,μ)such thatB′⊂NB2and there exists q such that#J(B′,B2,q)=d. This means thatposB′(q)=posB2(q)=cand thusOpr(M,μ)>∏i=1d(pi+1)contrarily to the assumption.WhenSkp(M,μ)=Skpr(M,μ)the second equivalence is the first one. Otherwise there existsB∈Skp(M,μ)∖Skpr(M,μ)and forc=posB(q)∈⨉i=1d{1,…,pi+1}B⊂NBq,cby Lemma 3.4; moreover from Corollary 3.8 it followsOp(M,μ)>∏i=1d(pi+1).  □This section studies the representation of polynomials as linear combinations of the sinks of a B-spline graph. The motivation is the construction of projectors and quasi-interpolants to the LR-spline space. Quasi-interpolants are linear approximation operators that are constructed using a collection of local approximation operators (Lyche and Schumaker, 1975). They can be used to give constructive proofs for the spline approximation results. While the results in this section allow the construction of quasi-interpolants that preserve polynomials, further investigation is needed to understand the local approximation properties of these operators.One of the problems in the study of the coefficients for polynomial representation is that for a general box and LR-meshSkpr(M,μ)is not always a set of linearly independent functions, and thus the set of coefficients is not unique (see Section 6 of Dokken et al. (2013) for an example). In Dokken et al. (2013) the authors used a combination of Algorithm 2.25 and Proposition 2.3 to study the partition of unity property of the LR B-spline collection. Here the same tools are used to study the coefficients for the representation of general polynomials.LetΛp(M,μ)be the set of functions from the vertexes ofGp(M,μ)toR. A splinefρ∈Sp(M,μ)given byfρ=∑B∈Gp(M,μ)ρ(B)Bcorresponds to an elementρ∈Λp(M,μ). The support ofρ∈Λp(M,μ)is thus a subset of the vertexes ofGp(M,μ). This formalism allows us to distinguish between different linear combinationsρ1,ρ2∈Λp(M,μ)that correspond to the same functionsfρ1=fρ2.A positive projectionℵ:Λp(M,μ)→Λp(M,μ)defined byℵρ=ρ−ρ(B)(1{B}−c11{Rk(B,ξ¯,1)}−c21{Rk(B,ξ¯,2)})corresponds to a compatible knot insertionℵ=(B,k,ξ¯), wherec1andc2are the coefficients from Proposition 2.3 and1Xis the characteristic function of X i.e.1X(x)={1,x∈X,0,otherwise.These projections preserve the associated splines inSp(M,μ), that is for all ρ and ℵfρ=fℵρ.The positive linear mapΓ:Λp(M,μ)→Λp(M,μ)obtained by composing theℵiΓ=ℵm∘⋯∘ℵ1corresponds to a sequence of knot insertionsΓ=(ℵ1,…,ℵm). Also for sequences of knot insertions it holdsfΓρ=fρ.Definition 4.1Let V be a subspace ofSp(M,μ)andGVbe the subgraph ofGp(M,μ)containing the B-splines in V. A sequenceΓ=(ℵ1,…,ℵm)of knot insertions is said to be exhaustive forGVwhen•for alli=1,…,mℵiis compatible withGV, i.e. it refines and produces functions of V;for allρ:suppρ⊂GVit holdssuppΓρ⊂Sk(GV).Let V andGVbe as above. Then when the sinks ofGVare linearly independent the same map Γ is associated to all exhaustive sequences. Indeed given a function in V there exists a unique linear combination ofSk(GV)that represents it. This is always the case for tensor B-spline spaces. Moreover, in the tensor case, the result of Γρ is known from general B-spline theory. In particular iffρ|β0=g∈Ppfor someβ⊂suppBthen(Γρ)(B)=B[g](B),whereB[g](B)is the blossom of g evaluated in the internal knots of B (Ramshaw, 1987). In order to exploit this knowledge for general box-meshes it is useful to associate to each B-spline inSkp(M,μ)an auxiliary tensor mesh.Definition 4.2Let(M,μ)be an extended box-mesh andB∈Skp(M,μ)be a B-spline. LetΞbe the knot vector of B. The tensor mesh associated to B is(MB,μB)defined by:•MBcorresponds to the sequences(ak,1,…,ak,nk)k=1,…,dcontaining all the k-th coordinatesak,iof theβ∈Morthogonal toekand such thatak,i∈{a<ξk,1}∪Ξk∪{a>ξk,pk+2};forβ∈MBletHβ={x:xk=ak,i}be the hyperplane containing β, thenμB(β)={mΞk(b),ak,i∈]ξk,1,ξk,pk+2[,max{μ(α):α∈M∧α⊂Hβ},otherwise.Lemma 4.3Given a sequenceΓ=(ℵ1,…,ℵm)of compatible knot insertions andρ∈Λp(M,μ)it holds thatsuppΓρ⊂{B:Breachable fromsuppρ}.Moreover if Γ is exhaustive forGV, the subgraph associated to a subspace V ofSp(M,μ),suppρ⊂Gandρ⩾0, thensuppΓρ={B∈Sk(GV):Breachable fromsuppρ}.ProofIt is enough to observe that the coefficient of unreachable B-splines are unchanged and that the coefficientsc1andc2of Proposition 2.3 are strictly positive for compatible knot insertions. □LetΓBbe an exhaustive sequence forGp(MB,μB). Since(MB,μB)is a tensor mesh the associated mapΓBdoes not depend on the sequence and can be written in term of the blossom. With a notation abuseΓB(as a map) will be applied toρ∈Λp(M,μ): in these casesΓBρmeansΓBρ˜whereρ˜is defined byρ˜(B)={ρ(B),B∈Gp(M,μ)∩Gp(MB,μB),0,otherwise.Theorem 4.4Let(M,μ)be an extended box-mesh,ρ∈Λp(M,μ)and Γ be an exhaustive sequence of knot insertions. Then for allB∈Skp(M,μ)it holds(Γρ)(B)=(ΓBρ)(B)−(ΓBNB)(B),whereNBis defined byNB(ϕ)={(Γρ)(ϕ),ϕ∈Skp(M,μ)∧B⊂Nϕ∧B≠ϕ,0,otherwise.ProofFixB∈Skp(M,μ)and let V be the subspace ofSp(M,μ)generated by the B-splines ϕ that lie in a path from suppρ to B. Let G be the associated subgraph ofGp(M,μ)andΓGbe the subsequence of Γ containing only the knot insertions compatible with G. Since Γ is exhaustive thenΓGis exhaustive for G, moreover by Lemma 4.3 it follows that the knot insertions that are not inΓGare irrelevant for the computation ofΓρ(B)and thus(3)(ΓGρ)(B)=(Γρ)(B).From the definition of(MB,μB)it follows that G is a subgraph ofGp(MB,μB). Thus it is possible to completeΓGto an exhaustive sequence forGp(MB,μB)by appendingΓBto it. Since(MB,μB)is a tensor mesh it follows(4)(ΓBρ)(B)=((ΓB∘ΓG)ρ)(B).MoreoverΓB|Skp(MB,μB)is the identity map and thus(5)((ΓB∘ΓG)ρ)(B)=(ΓGρ)(B)+(ΓB(ΓGρ−1{B}⋅ΓGρ))(B).Using Lemma 4.3 it follows that(6)(ΓGρ)(B)+(ΓB(ΓGρ−1{B}⋅ΓGρ))(B)=(ΓGρ)(B)+(ΓBNB)(B).Putting together the equalities (4), (5) and (6), gives(ΓBρ)(B)=(ΓGρ)(B)+(ΓBNB)(B). From here the thesis follows using (3).  □LetNibe the subset ofSkp(M,μ)containing the B such that the longest sequenceB=ϕ1⊂N⋯⊂Nϕiwithϕj∈Skp(M,μ)has length i (ϕi≠ϕi+1). The coefficients of the B-splines inN1can be computed from the coefficients of their predecessors using the blossom (throughΓB). Those of the B-splines inNican be computed from the coefficients of their predecessors and of the B-splines inN1∪⋯∪Ni−1again using the blossom. The above observations imply that Γρ depends only on the mesh(M,μ)and it is independent of the exhaustive sequence Γ. This justifies the following definition.Definition 4.5The map associated to any exhaustive sequence forGp(M,μ)is denoted withΓM.Given a box-mesh(M,μ)and a degree p it is always possible to write a polynomialg∈Ppas linear combinations ofBp(M,μ). Letρgbe the corresponding function inΛp(M,μ)then the canonical coefficients of g areΓMρg. Note that for all polynomialssuppΓMρg⊂Skpr(M,μ).This observation is enough to construct quasi-interpolants to the LR-spline space. LetΩ=[a,b]andf:Ω→Ra function then a quasi-interpolant Q has the formQf=∑B∈Skpr(M,μ)λB(f)B,where theλBare linear operators that depends only on the shape of f on some setUB⊂Ω. TheλBcan be constructed using the following steps•choose a local polynomial approximation method, letfUBbe the local approximating polynomial for the setUBassociated to B;represent the local polynomials in terms of the Bernstein basis for Ω:Bp(M,μ);applyΓMto obtain the coefficient of B.For all quasi-interpolants constructed on this model it holds that if the local approximation operators preserve polynomials then so does the quasi-interpolant:(∀Bf|UB∈Pp⇒fUB=f|UB)⇒(f∈Pp⇒Qf=f).The above suggests that, as for quasi-interpolants on tensor product B-spline, the same applies to spline preservation. This is false. The problem is thatSkpr(M,μ)are not necessarily linearly independent onUBand thus the coefficient of B given from the local approximation can be incompatible with the value of original spline inΩ∖UB.For instance if(M,μ)is such thatSkpr(M,μ)are linearly independent and there existB1,B2∈Skpr(M,μ)such thatB1⊂NB2then the quasi-interpolant Q based on Taylor expansion cannot preserve splines, but it preserves splines locally on the Bezier elements. Indeed from the properties ofΓMit follows thatλB2(B1)≠0and thusQB1≠B1.It is possible to recover the corresponding theorem for spline preservation assuming the following local linear independence property: for all B the set{ϕ∈Skpr(M,μ):suppB∩UB≠∅}contains linearly independent B-splines. With this assumption the following holds(∀Bf|UB∈Sp(M,μ)⇒fUB=f|UB)⇒(f∈Sp(M,μ)⇒Qf=f).In particular when theUBare open this is truth for the meshes(M,μ)such thatOpr(M,μ)=∏i=1d(pi+1).Theorem 4.6Let(M,μ)be an extended box-mesh. Then the following propositions are equivalent1.for allg∈Ppit holdsg=∑B∈Skpr(M,μ)B[g](B)B;∄B1,B2∈Skpr(M,μ):B1⊂NB2;Skpr(M,μ)is a partition of unity.ProofThe implication1⇒3is obvious knowing that for all BB[1](B)=1.The implication2⇒1follows from Theorem 4.4 and the fact that(ΓBρg)(B)=B[g](B).The implication3⇒2follows from Theorem 4.4. Letρ1be the representation of 1 in the Bernstein basis, then1=∑B∈Skpr(M,μ)B=∑B∈Skp(M,μ)(ΓMρ1)(B)B=∑B∈Skpr(M,μ)((ΓBρ1)(B)−(ΓBNB)(B))B=(∑B∈Skpr(M,μ)B)−(∑B∈Skpr(M,μ)(ΓBNB)(B)B).Thus∑B∈Skpr(M,μ)(ΓBNB)(B)B=0. Note that for allB∈Skpr(M,μ)(ΓBNB)(B)⩾0becauseΓBis a positive projection. Thus, since B-splines are positive functions,(ΓBNB)(B)=0for all B and this implies{ϕ∈Skp(M,μ):B⊂Nϕ}=∅(Lemma 4.3). Since B is arbitrary then 2 holds. □Theorem 5.1Let(M,μ)be an extended box-mesh, then}⟹Skpr(M,μ)are locally linearly independentMoreover if∄B1,B2∈Skp(M,μ)such thatB1⊂NB2thenSkpr(M,μ)=Skp(M,μ).In particular when(M,μ)is an LR-mesh the above equivalence holds for the LR B-spline collectionB=Skpr(M,μ).

@&#CONCLUSIONS@&#
