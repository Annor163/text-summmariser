@&#MAIN-TITLE@&#
Optimization of a multiproduct economic production quantity problem with stochastic constraints using sequential quadratic programming

@&#HIGHLIGHTS@&#
A multiproduct single vendor–single buyer supply chain problem is modeled.To suite real-world environments, the model includes five stochastic constraints.The recently-developed SQP is used to solve the problem.Twenty numerical examples are solved in order to demonstrate the performance.The results show that SQP has better performance than the interior point method.

@&#KEYPHRASES@&#
Economic production quantity,Stochastic constraints,Sequential quadratic programming,Interior point method,Optimization,

@&#ABSTRACT@&#
In this paper, a multiproduct single vendor–single buyer supply chain problem is investigated based on the economic production quantity model developed for the buyer to minimize the inventory cost. The model to be more applicable for real-world supply chain problems contains five stochastic constraints including backordering cost, space, ordering, procurement, and available budget. The objective is to find the optimal order quantities of the products such that the total inventory cost is minimized while the constraints are satisfied. The recently-developed sequential quadratic programming (SQP), as one of the best optimization methods available in the literature, is used to solve the problem. Twenty numerical examples in 3 scales of small, medium, and large are solved in order to demonstrate the applicability of the proposed methodology and to evaluate its optimum performance. The results show that SQP has satisfactory performance in terms of optimum solutions, number of iterations to achieve the optimum solution, infeasibility, optimality error, and complementarity. Besides, the optimum performance of the SQP method is compared with the one of another exact method called interior point using the above numerical examples under similar conditions. The comparison results are in favor of the employed SQP. At the end, a sensitivity analysis is performed on the change rate of the objective function obtained based on the change rate of the variance of the order quantity.The economic production quantity (EPQ) model is often used in the manufacturing sector to assist firms in determining the optimal production lot size that minimizes overall production-inventory costs. Among an extensive research conducted on the applications of the EPQ model one can mention the following recent works in chronological order.In the first decade of 2000, Jamal et al. [1] developed an EPQ model to determine the optimum batch quantity in a single-stage system. They assumed rework to be completed under two different operational policies named immediate and N-Cycle rework processes, to minimize the total system cost. Huang [16] introduced an EPQ model in which imperfect products were allowed into the produced lot sizes. Chiu et al. [8] considered the effects of random defective rate and imperfect rework process on the EPQ model. However, they did not take into account the service level as an operational performance. Chang [6] investigated the effects of imperfect products on the total inventory cost associated with an EPQ model. Goyal and Cárdenas-Barrón [14] presented an EPQ model by considering an imperfect production system that would produce defective products, supposing all the defective items that were randomly produced were reworked. Chiu et al. [9] investigated an EPQ model with scrap, rework, and stochastic machine breakdowns to determine the optimal run time and production quantity. Choi et al. [10] developed a production model in which demand was satisfied by recovering used products as well as new products. They assumed that a fixed proportion of the used products were collected from customers and later recovered for reuse. Sarker et al. [27] introduced an extended EPQ model dealing with the optimum production quantity in a multi-stage system in which rework was performed under two different operational policies to minimize the total system cost. Jaber et al. [17] developed an EPQ model for items with imperfect quality subject to learning effects. They assumed imperfect quality items were withdrawn from inventory and sold at a discount price. However, they did not consider the learning effect as it can affect production rate and shortage costs, directly. Cárdenas-Barrón [3] proposed a simple derivation to find the optimal production quantity of a system that includes a rework process. Liao et al. [18] studied an integrated maintenance and production system with an EPQ model for an imperfect process involving a defective production system under increasing failure rate. Yoo et al. [31] proposed a profit-maximizing EPQ model that incorporates both the imperfect production quality and two-way imperfect inspection. Widyadanaa and Wee [30] provided a multi-product EPQ vendor–buyer integrated model in just-in-time philosophy under budget constraint. The problem was modeled as a mixed integer non-linear program (MINLP) with constraint. Cárdenas-Barrón [4] introduced an EPQ model with a rework process at a single-stage manufacturing system with planned backorders. Some of the other works in this decade include Chandrasekaran et al. [7], Liu et al. [19], Mohan et al. [20], Cárdenas-Barrón [5], and Parveen and Rao [22].In the second decade of 2000, Pasandideh et al. [24] developed a multi-product EPQ model in which there were some imperfect items of different types being produced such that reworks were allowed and that there was a warehouse space limitation. Under these conditions, they formulated the problem as a nonlinear integer-programming model and proposed a genetic algorithm to solve it. Taleizadeh et al. [28] introduced an EPQ model with scrapped items and limited production capacity in a multiproduct single-machine production system with stochastic scrapped production rate, partial backordering, and service level constraint. They did not consider the impact of rejection and rework in their model. Furthermore, they only considered a limited production capacity. Taleizadeh et al. [29] studied two joint production systems in the form of a multiproduct single machine with and without rework. In their work, shortage was allowed and backordered. For each system, the optimal cycle length and the backordered and production quantities of each product were determined such that the cost function is minimized. The results obtained by solving the models with and without rework of defective items along with sensitivity analysis and some managerial insights based on the numerical illustration were provided in their research. Hafshejani et al. [15] developed a multi-product EPQ model under warehouse space limitation by assuming that each produced lot would contain some imperfect items and scraps. Under these conditions, they formulated the problem as a non-linear programming model and proposed a genetic algorithm to solve it. Although some constraints including a limitation on the available procurement budget was considered in their work, backorder and ordering costs were not taken into account in their modeling. Besides, rework and its impact have not been considered either. Pasandideh et al. [25] presented a multi-item multi-period inventory control problem with all-unit and/or incremental quantity discount policies under limited storage capacity. In their work, the independent random demand rates of the items in the periods were known and the items were supplied in distinct batch sizes. The objective was to find the optimal order quantities of all items in different periods such that the total inventory cost would be minimized and the constraint was satisfied. A mixed binary integer programming model was first developed in this work to model the problem and then a parameter-tuned genetic algorithm (GA) was employed to solve it. Mousavi et al. [21] modeled a seasonal multi-product multi-period inventory control problem. In their research, inventory costs were obtained under inflation and all-unit discount policy. Furthermore, the products were delivered in boxes of known number of items, and in case of shortage, a fraction of demand was considered backorder and a fraction lost sale. Besides, the total storage space and total available budget were limited. The objective of their work was to find the optimal number of boxes of the products in different periods to minimize the total inventory cost. As the integer nonlinear model of their problem was hard to solve using exact methods, a particle swarm optimization (PSO) algorithm was proposed to find a near-optimal solution. They did not consider the service level constraint in their model. Besides, despite the difficulty involved in their model, exact methods were good alternative solution approaches that were not taken into account. Pasandideh et al. [23] investigated the vendor managed inventory (VMI) problem of a single vendor–single buyer supply chain, in which the vendor was responsible to manage the buyer’s inventory.To suit real-world inventory problems, in this paper, the EPQ model of the single vendor–single buyer supply chain problem proposed by Pasandideh et al. [23] is extended to include five new stochastic constraints of (1) backorder cost, (2) space, (3) ordering, (4) procurement, and (5) available budget. The main objective here is to find the order quantities of the products such that the stochastic constraints are satisfied and the total inventory cost is minimized. To answer this main research question, SQP is used as a technique to solve the derived nonlinear programming problem (NLP). This iterative procedure that models an NLP for a given iterate using a quadratic programming (QP) sub-problem, first solves that QP subproblem, and then uses the solution to construct a new iterate. SQP is a general exact method to solve nonlinear optimization problems. Although it has been employed to solve some nonlinear optimization problems previously, to the best of authors’ knowledge, it has never been used to solve inventory control problems with stochastic constraints.The outline of the rest of the paper is as follows: Section 2 sheds light on the problem definition and assumptions. The model derivation is described in Section 3. Section 4 deals with the sequential quadratic programming method. Numerical examples in 3 scales of small, medium, and large are presented in Section 5. In Section 6, the optimum performance of the sequential quadratic programming method is compared with the one of another exact solution method called the interior point. Finally, sensitivity analysis and conclusion are presented in Sections 7 and 8, respectively.The problem at hand arises from a single-buyer inventory control environment that uses EPQ system to minimize total inventory costs for all products. In this problem, there are several products and the EPQ model is utilized with practical instances of finite production rate, limited procurement cost, limited backorder cost, limited space cost, limited ordering cost, and limited available budget for procurement, backorder, space and ordering. The objective is to find the order quantities of the products such that the total inventory cost is minimized while the stochastic constraints are satisfied. The following assumptions are used for formulation of the problem:(1)There is a single buyer to minimize his (her) total inventory cost.There arenproducts.The planning horizon is infinite.The lead time is assumed negligible.Selling prices of all products are fixed.Quantity discount is not allowed.Production rate for all products is continuous and finite.For each product, shortage is allowed and backordered(πˆ≠0andπ=0).Buyer’s demand rate for all products is known and constant.The total backorder cost of all products is less thanBwith a probability greater thanα.The total space cost of all products is less thanSwith a probability greater thanα.The total ordering cost of all products is less thanOwith a probability greater thanα.The total procurement cost of all products is less thanCwith a probability greater thanα.The total available budget for procurement, backorder, space, and ordering is less thanXwith a probability greater thanα.Pasandideh et al. [23] investigated the inventory problem of a single vendor–single buyer supply chain in which the vendor is responsible to manage buyer’s inventory. In the current research, their model is applied for the buyer’s inventory to minimize his total inventory cost including ordering, shortage, and holding costs. Therefore, the objective function of their work is changed, while new stochastic constraints are added for more applicability. The stochastic limitations include cost limitation for backorder, space, ordering, procurement, and available budget. To develop the model, the following notations for the parameters and the variables are used.Forj=1,2,…,n, define the parameters and variables of the model as follows.Parametersn: Number of productsDj: Demand rate of product jAj: Fixed ordering cost per order of product jhj: Holding cost of product j per unit held in time unitPj: Production rate of product jπˆ: Fixed backorder cost per unit per time unitbj: Maximum backorder level of product jTC: Total inventory costCj: Procurement cost per unit of product jnj: Space cost of product j per unitfj: Space occupied by each unit of product jX: Total available budget for procurement, backorder, space, and orderingB: Maximum backorder cost for all productsS: Maximum space cost for all productsO: Maximum ordering cost for all productsC: Maximum procurement cost for all productsμ: The mean of the order quantity of each productσ2: The variance of the order quantity of each productα: The probability of violating each of the five stochastic constraintsVariablesQj: Order quantity of product jReferring to Cárdenas-Barrón [2], the total inventory cost of the buyer, including the ordering, shortage, and holding, is obtained by:(1)TC=∑j=1nDjQjAj+(πˆ+hj)2PjQjbj2-hjbj+hjPj2QjIn Eq. (1), the first term is the ordering cost of the buyer and the rest are the costs associated with the shortage and holding. Note that the ordering cost is dependent on the number of orders and the holding and shortage costs are dependent on the space occupied for the buyer’s inventory and backordering quantity.As the shortage, space, ordering, and procurement costs along with the total available budget are not deterministic in real-world systems, in this paper, they all are considered stochastic. On this basis, the stochastic constraints are:(1)Backorder cost of all products is limited toBwith a probability greater thanα.Space cost of all products is limited toSwith a probability greater thanα.Ordering cost of all products is limited toOwith a probability greater thanα.Procurement cost of all products is limited toCwith a probability greater thanα.Total available budget for procurement, backorder, space, and ordering is limited toXwith a probability greater thanα.Incorporating stochastic constraints, the mathematical formulation of the problem using Eq. (1) becomes:(2)MinTC=∑j=1nDjQjAj+(πˆ+hj)2PjQjbj2-hjbj+hjPj2QjSubject to:(3)P∑j=1n(πˆ+hj)2PjQjbj2-hjbj⩽B⩾α(4)P∑j=1nPjfjQjnj⩽S⩾α(5)P∑j=1nDjQjAj⩽O⩾α(6)P∑j=1nCjQj⩽X-B-S-O⩾α(7)P∑j=1nDjQjAj+PjfjQjnj+CjQj+(πˆ+hj)2PjQjbj2-hjbj⩽X⩾αConstraint (3) assures the total backordering cost of all products is less than B with a probability greater than or equalα. Constraint (4) guarantees space cost limitation with probability greater than or equalα. Constraint (5) assigns a lower bound on the probability of the ordering costs being less than or equalO. Constraint (6) specifies a lower bound on the probability of the procurement cost being less than or equal its budget. Finally, Constraint (7) guarantees the total available budget limitation with probability greater than or equal.Assuming a normal distribution with a meanμand varianceσ2for order quantity of each product, the constraint in (3) becomes:(8)∑j=1n(πˆ+hj)2PjQjbj2-hjbj⩾Z∝σ∑j=1n(πˆ+hj)24Pj2bj4+1μ∑j=1n(πˆ+hj)2Pjbj2+∑j=1nhjbjwhereZ∝is the upperα-percentile of the standard normal distribution. Similarly, the constraints in (4)–(7) can be written as:(9)∑j=1nPjfjQjnj⩾Z∝·σ·∑j=1nPj2fj2nj2+μ·∑j=1nPjfjnj(10)∑j=1nDjQjAj⩾Z∝σ·∑j=1nDj2Aj2+1μ·∑j=1nDjAj(11)∑j=1nCjQj⩾Z∝·σ·∑j=1nCj2+μ·∑j=1nCj(12)∑j=1nDjQjAj+PjfjQjnj+CjQj+(πˆ+hj)2PjQjbj2-hjbj⩾Z∝·∑j=1nDj2σ2Aj2+σ2∑j=1nPj2fj2nj2+σ2∑j=1nCj2+1σ2∑j=1n(πˆ+hj)24Pj2bj4)+1μ·∑j=1nDjAj+μ·∑j=1nPjfjnj+μ·∑j=1nCj+1μ·∑j=1n(πˆ+hj)2Pjbj2-∑j=1nhjbjNow, the goal is to determine the values of the production order quantities in a cycle such that the total cost of system (shown in Eq. (2)) is minimized while the constraints are fulfilled. The formulation given in (8)–(12) is of a nonlinear-programming type, adequately hard to be solved analytically [12]. However, as SQP is a powerful and effective solution method for a wide range of nonlinear optimization problems [13], it will be used in the next section to solve the stochastic nonlinear programming problem at hand.Sequential (or successive) quadratic programming (SQP) is a technique to solve nonlinear programming (NLP) optimization problems. It is one of the most recently developed and perhaps one of the best methods of optimization. It relies on a profound theoretical foundation and provides powerful algorithmic tools for the solution of large-scale technologically relevant problems. SQP has a theoretical basis that is related to solution of a set of nonlinear equations using Newton’s method and derivation of simultaneous nonlinear equations using Kuhn–Tucker conditions to the Lagrangian of the constrained optimization problem. SQP is an iterative procedure that models NLP problems for a given iterate to a quadratic programming (QP) sub-problem, solves that QP subproblem, and then uses the solution to construct a new iterate. This construction is done in such a way that the sequence converges to a local minimumX∗of the NLP. In general, sequential (or successive) quadratic programming is a technique for the solution of nonlinear programming (NLP) problems with superlinear convergence rate that requires the related QP subproblem must be solvable per iteration [32].Consider the following quadratic programming problem:FindXsuch that(13)Q=∇fTΔX+12ΔXT[∇2L]·ΔXis minimized subject to:(14)gj+∇gjTΔX⩽0;j=1,2,…m(15)hk+∇hkTΔX=0;k=1,2,…,pThe Lagrange function is given in Eq. (16):(16)L∼=f(X)+∑j=1m(λjgj(X)+∑k=1P(λm+khk(X))As in the case of Newton’s method of unconstrained minimization, the solution vectorΔXis treated as the search directionS, and the quadratic programming subproblem (in terms of the design vectorS) is restated as follows:FindSsuch that(17)Q(S)=∇f(X)TS+12ST[H]·Sis minimized subject to:(18)βjgj(X)+∇gj(X)TS⩽0;j=1,2,…,m(19)β¯hk(X)+∇hk(X)TS=0;k=1,2,…,pConstraints (18) and (19) are related to a local quadratic model of the LagrangianL∼as the objective functional which leads to the QP subproblem. In Eq. (17) and Constraints (18) and (19),[H]is a positive definite matrix that is taken initially as the identity matrix and is updated in subsequent iterations so as to converge to the Hessian matrix of the Lagrange function andβ¯, andβjare constants used to ensure that the linearized constraints do not cut off the feasible space completely.(20)β¯≈0.9;βj=1ifgj(X)≪0β¯ifgj(X)≫0Relation (20) is typical values of constraint (18) whenβ¯has certain value.The subproblem derived based on Eq. (17) is a quadratic programming problem and hence methods for minimizing quadratic functions can be used for its solution. Once the search direction, S, is found by solving the problem modeled in (17), the design vector is updated as shown in Eq. (21).(21)Xj+1=Xj+∝∗SEq. (21) is the updated design vector when search direction is found by solving Eq. (17), where∝∗is the optimal step length along the directionSfound by minimizing the functionφgiven in Eq. (22).(22)φ=f(X)+∑j=1m(λj(max[0,gj(X)])+∑k=1P(λm+k(|hk(X)|)With(23)λj=|λj|,j=1,2,…,m+pin first iterationmax{|λj|,12(λj∼,|λj|)}in subsequent iterationsandλ̃J=λjof the previous iteration. Moreover, the one-dimensional step length∝∗can be found by any of the methods discussed before for one-dimensional minimization. OnceXjis found by Eq. (17) in an iteration, the Hessian matrix[H]is updated to improve the quadratic approximation for the next iteration.In the next section numerical examples are provided to illustrate the application of the proposed solution method.Three classes of problems including small, medium, and large size problems are considered in this section to illustrate the applicability as well as to evaluate the performance of the SQP method. They are provided in the following three subsections.In the small scale, ten numerical examples with five stochastic constraints on backorder, space, ordering, procurement, and available budget, each having five products are solved. For instance, the general and the specific data of Examples 1 and 2 are given in Tables 1 and 2, respectively. Moreover, the order quantity of all products in Example #1 follows a normal distribution with mean 93 and variance 25, whereαis assumed 0.75. The order quantity of all products in Example #2 follows a normal distribution with mean and variance of 120 and 16, respectively, whereαis assumed 0.85. Similarly, the order quantity of all products in the remaining 8 examples follows a normal distribution with mean and variance of 80 and 36, whereαis considered 0.75. Moreover, the starting point of SQP in the first example is:Q1=70,Q2=70,Q3=70,Q4=70,andQ5=70The starting point of SQP in the second example is:Q1=90,Q2=90,Q3=90,Q4=90,andQ5=90The starting point of SQP in the remaining 8 examples is:Q1=65,Q2=70,Q3=55,Q4=80,andQ5=90The examples have been solved using the SAS 9.2 computer software with its embedded sequential quadratic programming. A typical SAS program is given in Appendix A. Table 3shows the optimum solution, number of iterations to achieve the optimum solution, infeasibility, optimality error, and complementarity obtained for the first two examples. The optimal solutions of the remaining 8 examples are provided in Table 4.In Tables 3 and 4, Q1 to Q5 are the optimum order quantities of Products 1 to 5 and the column titled “objective function value” is calculated based on Eq. (2). The number of steps taken by the SQP algorithm to achieve the optimal solution is shown in the column entitled as “number of iterations.” As the computation is carried out in a finite-precision environment, rounding errors prevent the algorithm to obtain a solution that satisfies the preceding condition exactly (the degree of infeasibility is shown in the fifth column of Tables 3 and 4.) Instead, we terminate the algorithms at some small threshold values that can be measured in an absolute or relative sense. The sixth column in Tables 3 and 4 refers to the “optimality error” and the last column (“complementarity”) is the relative infeasibility defined as the maximum amount of constraint violation relative to the one in the “infeasibility” column.In medium scale, five numerical examples with five stochastic constraints on backorder, space, ordering, procurement, and available budget, each having ten products are solved. The order quantity of all products in 5 examples follows a normal distribution with mean and variance of 140 and 49, whereαis considered 0.75. Moreover, the starting point of SQP for all examples is 60. As stated earlier, the examples have been solved using the SAS 9.2 computer software with its embedded sequential quadratic programming. Table 5shows the optimum solution, number of iterations to achieve the optimum solution, infeasibility, optimality error, and complementarity obtained for these five examples.In large scale, five numerical examples with five stochastic constraints on backorder, space, ordering, procurement, and available budget, each having fifteen products are solved. The order quantity of all products in 5 examples follows a normal distribution with mean and variance of 200 and 64, whereαis considered 0.75. Moreover, the starting point of SQP in these five examples is 40. Table 6shows the output of the SAS software for these examples.The results in Tables 3–6 indicate that SQP is a powerful method to solve nonlinear programming optimization problems of different sizes all with stochastic constraints. In the next section an analysis is performed to compare the performance of the SQP with the one of another exact method called the interior point.In this section, the performance of the utilized sequential quadratic programming is compared with the one of the interior point method. To this aim, all the numerical examples solved in Section 5 using the SQP have also been solved under similar conditions with the interior point method using the SAS 9.2 computer software with its embedded interior point procedure.Interior point methods belongs to a certain class of algorithms to solve linear and nonlinear convex optimization problems. The modern era of interior point methods dates to 1984, when Karmarkar proposed his algorithm for linear programming [26]. His idea was to approach the optimal solution from the strict interior of the feasible region. This led to a series of interior point methods that combined the advantages of the simplex algorithm with the geometry of the ellipsoid algorithm. Interior point methods are of interest from a theoretical point of view because they have polynomial complexity, and from a practical point of view because they have produced solutions to many industrial problems that were hitherto intractable. Interior-point methods have permanently changed the landscape of mathematical programming theory, practice and computation. Interior-point methods in mathematical programming have been the largest and the most dramatic area of research in optimization since the development of the simplex method [11].Table 7shows the solutions of the numerical examples provided in Section 5, solved by the interior point method.The minimum total costs obtained in Table 7 using the interior point method all are greater than the ones obtained using the SQP. Thus, it can be concluded that the SQP method works better than the interior point procedure to solve nonlinear optimization problem with stochastic constraints.A sensitivity analysis on the effect of the variance(σ2)change of the order quantity on the optimal result is performed in this section only for Example #1 with the initial data shown in Table 1. It involves increasing or decreasingσ2at the rates of ±20%, ±40% and ±60%. Table 8shows the results. Moreover, Fig. 1shows the change rate of the objective function with respect to the change rate of the variance. It can be seen from Fig. 1 that there exists a direct relationship between an increase/decrease in the change rate of the variance and the change rate of the objective function. Note that as Fig. 1 is symmetric around the no-change point, positive or negative change rates of an equal quantity for the variance results in an almost equal change rates of the objective function. This can be an indicative for the good performance of SQP.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
In this paper, the vendor-managed inventory problem of a single vendor–single buyer supply chain was extended and applied only for the buyer’s inventory control system to minimize his total inventory cost under five realistic stochastic constraints on backorder, space, ordering, and procurement costs as well as the available budget, each with a certain probability of satisfaction. As the developed model in its simplified form was shown to be of a nonlinear programming type, the sequential quadratic programming (SQP) was utilized in order to find optimal order quantities of the buyer. The results of SQP implementations on 20 numerical examples in 3 sizes of small, medium, and large showed good performance of the SQP method. Besides, a comparison study between the performance of SQP method with the one of another exact method called the interior point, when both were employed to solve similar problems, showed the superiority of the SQP method. At last, a sensitivity analysis on the effect of the variance of the order quantity on the total cost confirmed excellent performance of the SQP method.