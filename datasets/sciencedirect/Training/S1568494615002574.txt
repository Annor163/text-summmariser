@&#MAIN-TITLE@&#
Region based interpolation error expansion algorithm for reversible image watermarking

@&#HIGHLIGHTS@&#
Proposed algorithm is a new reversible image watermarking algorithm based on interpolation error expansion.In the data extraction, original image can be obtained from watermarked image in a distortionless manner.Watermarking algorithm embeds data adaptively into the image.Spatial correlation has been exploited effectively by using image interpolation algorithm.Image quality is preserved by proposed pixel selection algorithm.

@&#KEYPHRASES@&#
Watermarking,Reversible image watermarking,Interpolation-error expansion,Region based interpolation-error expansion,Adaptive embedding,

@&#ABSTRACT@&#
In this paper, we propose a new reversible image watermarking method based on interpolation-error expansion called region based interpolation error expansion (RBIEE). We improved Thodi's prediction error expansion (PEE) technique by using a novel interpolation algorithm which exploits interpixel correlation better. Furthermore, interpolation error histogram is divided into two regions. The parameters of each region are determined separately and iteratively to reach a given embedding capacity more precisely. However, adaptive embedding strategy is utilized to get better capacity-distortion performance. Advantage of the proposed method over the other state-of-the-art methods in terms of capacity and visual quality is demonstrated experimentally.

@&#INTRODUCTION@&#
Digital watermarking is expressed as a data hiding technique which is developed for purposes such as identification, copyright protection and indexing of digital media content. In this technique, a secret data called watermark is embedded into the digital multimedia content. In the decoder, watermark data is extracted from the watermarked signal in a lossless manner although original signal cannot be obtained back. However, in some important applications such as military imaginary, forensic law and medical imaginary, distortion in the original signal may cause fatal results. For instance, a small distortion in a medical image may interfere with the accuracy of physician diagnosis. Distortion problems which may arise in applications above mentioned can be fixed in a reversible watermarking method [2]. In a reversible watermarking technique, original signal is represented in a new domain to create an empty space. That empty space is exploited for watermark insertion. Then, both watermark data and original signal can be reconstructed in a reversible manner by going back to the original representation.Reversible image watermarking (RIW) algorithms can be classified into five groups. Lossless compression based algorithms [5,7,3,4], difference expansion (DE) based algorithms [16,1,8,12,13], histogram shifting (HS) based algorithms [14,6,11,17,9], prediction-error expansion (PEE) based algorithms [10,15] and integer to integer transform based algorithms [18]. Recent studies have been focused on the PEE based algorithms which give effective results in terms of capacity-distortion performance. PEE combines difference expansion and histogram shifting methods. It exploits spatial correlation more efficiently than DE by watermarking prediction error instead of pixel difference. PEE takes advantage of HS approach to make room for data embedding. Several PEE based methods have been presented in the literature. Each of these methods obtains prediction error in a different way to exploit spatial correlation between neighboring pixels more efficiently. In almost all PEE based RIW methods; prediction error histogram of the image is calculated first and then the histogram is divided into two distinct region according to the capacity parameter (t) which is determined depending on the size of the watermark data. Fig. 1shows the divided regions and prediction error histogram. Pixels in inner region are expanded by adding 1 bit watermark data while pixels in outer region are shifted [15]. In order to achieve a given target capacity, capacity parameter is increased iteratively.Performance of a reversible image watermarking (RIW) method is measured by embedding capacity, visual quality and complexity. Due to advances in computer technology, complexity could be ignored. Capacity and visual quality are inversely proportional. Increasing embedding capacity leads to image quality deterioration. Although, there are very effective algorithms in the literature, PEE based RIW algorithms can still be improved. Embedding capacity can be increased by using more correlated pixels while visual quality is preserved by different watermarking approaches.In this study, we propose a novel RIW method which has a better capacity-distortion performance. The proposed method embeds data into the interpolation-error which exploits the correlation between adjacent pixels more efficiently than prediction error. In order to watermark the interpolation error histogram, a new reversible watermarking method called region based interpolation error expansion (RBIEE) has been developed. RBIEE is a kind of PEE method which divides the interpolation error histogram into two sub-regions and capacity parameters of both regions are calculated separately. However, each sub-region is watermarked according to its own capacity parameter. Thus, desired embedding capacity is reached more accurately. Therefore, visual quality can be controlled more precisely than in conventional PEE based algorithms. Furthermore proposed algorithm exploits correlation between adjacent pixels by interpolation method. Since interpolation error is smaller than prediction error, interpolation error histogram becomes sharper. Therefore, proposed method gives better capacity-distortion performance. Adaptive embedding strategy proposed by Li et al. [10] is exploited in our method by applying it to the interpolation-errors to get high embedding capacity. Also, pixel selection algorithm is utilized to improve visual quality.We improved the Li et al.'s method by using more than one capacity parameter to control visual quality more precisely for a given payload. When Li et al.'s method is applied to our method, some problems can be encountered such as obtaining same interpolation error in both sides, distributing payload homogeneously to the image pixels especially at low capacities, embedding and obtaining the side information reversibly. However, for each problem, we proposed an original solution in our watermarking algorithm. Efficiency of our method over state-of-the-art methods in terms of capacity and visual quality has been demonstrated according to the experimental results.The rest of the paper is organized as follows. Image interpolation, region based interpolation-error expansion, pixel classification, adaptive watermarking and pixel selection are explained in Section 2. Additional information, embedding and extraction algorithms are explained in Section 3. In Section 4, our method is evaluated in comparison with conventional reversible watermarking algorithms. Finally, conclusions are drawn in the last section.In this paper, instead of conventional reversible watermarking scheme described above, we present a new reversible watermarking method that utilizes more than one maximum point of interpolation-error histogram to embed data. Capacity and image quality of our method are enhanced by an adaptive approach and pixel selection method. Especially, pixels in smooth regions of image are used for watermarking to decrease the number of watermarked pixel count. In this section, image interpolation, region based interpolation error expansion, pixel classification, adaptive embedding and pixel selection algorithms have been explained respectively.Our data hiding scheme utilizes the interpolation algorithm presented by Zhang et al. [19]. Using interpolation-error in a data hiding scheme has two important advantages compared with other methods [19]. The first one is that almost all the pixel values are used for data embedding. For instance, in Tian's method, interpixel difference is expanded. Hence, the number of difference values is only a half of the total number of pixels which means that potential embedding capacity of the scheme is cut in half. The second one is that the correlation between neighboring pixels is exploited more efficiently in interpolation methods. Therefore, the peak point of interpolation-error histogram becomes higher than prediction-error histogram. This can be seen in Fig. 2. As a result of that, capacity of watermarking increases. Proposed interpolation algorithm applied both in embedding and extraction phases is capable of estimating the same interpolated image for both processes.Fig. 3illustrates the pixels of a 5×5 image in which the cover image is divided into two sets denoted as “sampled” and “non-sampled”. The pixels denoted with letter indices are called sampled pixels and the others are called non-sampled pixels. The interpolation of non-sampled pixels P22, P24, P42, P44 are calculated from nearest sampled pixels. For instance, interpolated value of P22 is obtained by using P{a,b,d,e} pixels. Let the mean value of sampled pixels (Pa, Pe) and (Pb, Pd) be denoted by Mpaeand Mpbd, respectively. Interpolation-error eaeand ebdare obtained viaeae=MPae−P22ebd=MPbd−P22Mean value of the sampled pixels is k=∑x={a,b,d,e}(Px/4). For a given non-sampled pixel, weight of neighbor non-sampled pixels should be determined to calculate better interpolation. σaeand σbdvariances of the interpolation-error could be used for weighting the non-sampled pixels. σaeand σbdare formulated asσae=13∑l=13(Kae(l)−k)σbd=13∑l=13(Kbd(l)−k)where Kae={Pa,Pe,Mpae} and Kbd={Pb,Pd,Mpbd}Pˆ22interpolated pixel value is obtained via,(1)Pˆ22=σbdσbd+σaeMpae+σaeσbd+σaeMpbdInterpolated pixel values of all other non-sampled pixels are calculated in the same way. For example, interpolated value of P23 is estimated by using (Pb, Pe),(Pˆ22,Pˆ24)and Eq. (1).PEE based watermarking methods control the embedding capacity with capacity parameter t by using the prediction error values between [−t, t) for data embedding. In order to reach target capacity, capacity parameter is increased iteratively. Each increase in capacity leads to a decrease in image quality. We improved the PEE based watermarking algorithm to achieve target capacity more precisely with less image degradation.One can divide the interpolation-error histogram into two disjoint sets called “left histogram (LH)” and “right histogram (RH)” regions. Interpolation-error values in [−255, −1] correspond to LH and the other values correspond to RH. T1 and T2 are capacity parameters of LH and RH regions, respectively. In the interpolation-error histogram, values between [−T1, T2] are called inner region, the remaining values are referred to as outer region. Maximum amount of watermark information is determined by the number of pixels in the inner regions. Fig. 4shows the scenario when T1=1 and T2=2. For LH region, pixels, whose interpolation-error is em1=−1, are watermarked while pixels, whose interpolation error is between [−255, em1), are shifted. Similarly, in RH region, pixels, whose interpolation-error is em2=0 or em3=1, are watermarked while pixels, whose interpolation error is between (em3, 255], are shifted. However, increasing capacity parameters T1 and T2 leads to degradation in image quality. T1 and T2 parameters should be determined with an iterative algorithm to reach target capacity. Let the grayscale value of the pixel located at position (i, j) be denoted by x(i, j) and corresponding interpolated value isxˆ(i,j).Generalized embedding formula for LH and RH regions can be expressed as below. Watermarked pixel valuexw(i,j)is(2)xwi,j=xi,j+e+b,−T1≤e<T2xi,j+T2,T2≤exi,j−T1,e<−T1Selection of T1=⌈k/2⌉ and T2=⌈(k+1)/2⌉ capacity parameters is demonstrated in Table 1. It can be seen from Table 1 that each increment of parameter k makes a new interpolation-error candidate for data embedding.The comparison between conventional PEE and RBIEE is shown in Table 2. For example, in the lena image, in order to reach 0.25 BPP target capacity all of the pixels are shifted 2 bits in PEE. But in RBIEE algorithm some pixels are shifted 1 bit, while others are shifted 2 bits. In RBIEE method, image quality is preserved by reducing the total amount of shifted pixels. For all moderate ER (embedding rate in bit per pixel) our method has better visual quality than conventional PEE. However, for high ER levels, RBIEE has similar visual quality performance with PEE. The proposed RBIEE method has been enhanced by the adaptive embedding, pixel selection and pixel classifications algorithms to get better capacity-distortion performance.Higher embedding capacity requires the use of larger interpolation errors for watermarking. Therefore, visual quality deteriorates. For the protection of visual quality, instead of high interpolation errors, watermarking the pixels with low interpolation error with more bits, produces better results. For example, let the corresponding interpolation error values of xaand xbpixels be ea=4, eb=0 and T2=5. When embedding one bit into xa, watermarked pixel value is calculated asxaw=xa+4+b=xa+5{b=1}. However, watermarked pixel value of xbisxbw=xb+0+(2b1+b2)=xb+3{b1=b2=1}, while embedding two bits. Thus, watermarking xbpixel with two bits leads lower modified interpolation error value eb. As a result, visual quality has been improved by embedding two bits into a pixel with small interpolation-error. Embedding one or more bits into a pixel according to its error value is referred adaptive watermarking [10].In order to determine which pixels will be embedded with one bit and which pixels will be embedded with more bits, adaptive watermarking strategy exploits the standard deviation (SD). SD indicates the local complexity of watermarked pixel. SD of P22 pixel is calculated viaSD22=0.5∑x=a,b,d,e(px−k)2, where k=0.25∑x∈(a,b,d,e)px. To embed data adaptively, first, original image img is divided into two sets called img1 (primary image) and img2 (secondary image) by a threshold value Δtha. img1 is composed of pixels whose standard deviation satisfies SD<Δthaand img2 is the remaining pixels. img1 contains smooth regions and watermarked with 2 bits while img2 consists of rough regions and watermarked with 1 bit. In the watermark extraction process, same “SD” can be obtained. Therefore, decoder can determine which pixels are double embedded and which pixels are single embedded.For a given M×N image, to embed watermark in an adaptive manner; first, interpolation-error of the image is calculated to get the interpolation-error histograms of img1 and img2, respectively. Fig. 5illustrates the histograms of img1 and img2. img2 is watermarked by using capacity parameters T1 and T2 as described in the previous section. Watermarked pixel values of img1 are obtained via(3)xwi,j=xi,j+3e+b,t1≤e<t2xi,j+3t23t2≤exi,j−3t1,e<−3t1wheret1=⌊T13⌋,t2=⌊T23⌋and b=2b1+b2.Embedding performance of conventional PEE, RBIEE and adaptive RBIEE are given in Table 3in terms of BPP and PSNR. For small and moderate ER, all methods have same capacity-distortion performance. However, proposed method has better visual quality for a given high ER. For the standard gray-scale image lena with 1 BPP embedding capacity, PSNR gains of adaptive RBIEE are 2.99dB and 3.08dB over RBIEE and conventional PEE, respectively.Pixel selection algorithm is based on the principles of selecting relatively smooth distributed pixels in order to increase image quality and to disregard the rough ones. Consider a special case where the capacity parameters are T1=T2=T as a result of embedding and shifting average distortion of a pixel are 0.5T2 and T2, respectively. Then average distortion of an image is formulated as(4)ADall=0.5T2Pc+T2PsPcand Psare the numbers of watermarked and shifted pixel count, respectively. The following inferences can be made from Eq. (4). Image distortion depends on the watermark payload capacity Pc, number of shifted pixels Psand capacity parameter T. And also, distortion varies depending on whether the watermark bit is b=1 or b=0. T is determined according to the capacity while b and Pcare constant. Therefore, these three parameters cannot be modified. However, the number of pixels is to be shifted Psis variable and can be reduced. Reduction of Psincreases the visual quality. A threshold value Δthsis exploited to determine whether a pixel is modified or not. Pixels whose SD is smaller than threshold value Δths, are watermarked or shifted while remaining pixels are not modified. Pixel selection algorithm is performed on changeable pixels to watermark smooth regions. This strategy provides a better visual quality.For a given target capacity, amount of shifted pixels and improvement of visual quality in terms of PSNR in RBIEE and RBIEE with pixel selection methods are given in Table 4. As can be seen from the table, decreasing the amount of shifted pixels, improves the visual quality.

@&#CONCLUSIONS@&#
