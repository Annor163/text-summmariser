@&#MAIN-TITLE@&#
A tool for linguistic assessment of rehabilitation exercises

@&#HIGHLIGHTS@&#
We propose a tool for linguistic assessment of rehabilitation exercises.A report about the patient's performance during a complex exercise is provided.We contribute to the field of linguistic description of complex phenomena.The methodology can be directly applied to monitor different complex exercises.The experiments demonstrate the great expressiveness of the presented resources.

@&#KEYPHRASES@&#
Rehabilitation assessment,Linguistic modeling,Fuzzy linguistic summarization,

@&#ABSTRACT@&#
In this paper, human motion analysis is performed by modeling a physical complex exercise in order to provide feedback about the patient's performance in rehabilitation therapies.The Sun Salutation exercise, which is a flowing sequence of 12 yoga poses, is analyzed. This exercise provides physical benefits as improving the strength and flexibility of the muscles and the alignment of the spinal column. A temporal series of measures that contains a numerical description of this sequence is obtained by using a wearable sensing system for monitoring, which is formed by five high precision tri-axial accelerometer sensors worn by the patient while performing the exercise.Due to the complexity of the exercise and the huge amount of available data, its interpretation is a challenging task. Therefore, this paper describes the design of a computational system able of interpreting and generating linguistic descriptions about this exercise. Previous works on both Granular Linguistic Models of Phenomena and Fuzzy Finite State Machines are used to create a basic linguistic model of the Sun Salutation. This model allows generating human friendly reports focused on the assessment of the exercise quality based on its symmetry, stability and rhythm.

@&#INTRODUCTION@&#
After suffering a serious injury, illness or surgery, the patient usually needs to follow a physical rehabilitation program to recover the former strength, mobility and fitness. Many rehabilitation programs rely on classical treatments based on physiotherapy, which requires trained specialists and their precious experience. One of the limitations of these treatments is the lack of standardized and objective information for properly evaluating patients’ performance.Monitoring the patient and interpreting properly the acquired information, being able to provide a useful feedback, is one of the current challenges. Human motion tracking and analysis systems are particularly useful for medical diagnosis and monitoring [1]. These systems are able to acquire a big amount of information regarding the poses or movements of people [23].One of the oldest yoga exercises, the Sun Salutation (Fig. 1), is taken as an example of a rehabilitation exercise. It is a sequence formed by 12 postures, each of them counteracting the preceding one, producing a balance between flexion and extension. The reason for choosing this practice is that it provides a very well established sequence of movements, involving different parts of the body, which can be performed by any person in a limited frame of time and space without needing any additional equipment. The work done can however be extended to any other activity or exercise.Empirically based studies show the beneficial effects of yoga poses, not just by improving muscular strength and flexibility through stretching, but also on psychological conditions including anxiety and depression, and on pain syndromes and cardiovascular conditions, through, e.g., body-and-breath control [13,27]. Other studies are focused on the potential use of yoga in rehabilitation programs [24,28], and more specifically in physical therapies [19], where the effects of practicing yoga on motor variability, i.e. strength, steadiness and balance, are assessed.Some work has already been done regarding motion analysis of Sun Salutation. In [26] the transition phase during motion of such exercise in terms of grace and consistency is studied by using one sensor attached to the lower back, but without providing a feedback to the user about how the exercise has been performed. This work was afterwards extended in [25] studying the effects on specific joints during this practice. This particular sequence has also been used in [14,21] for testing a virtual rehabilitation system which guides the user through a therapeutic exercise program. In [21] feedback on performance is provided in terms of scores. Based on these results, [14] is able to provide corrective advices stating the part of the body needing adjustment to achieve the pose. At the physical level, the main inconvenient of these systems is the use of a motion tracking suit which includes several wires. At the level of text generation, there is a clear necessity of new computational systems able to generate performance reports and linguistic advices that are more complex than the current ones.In this paper, an extensive use of previous research on this field is done, contributing to the quality analysis of this particular exercise. Moreover, a computational application which uses a wearable sensing system [16,17] capable of generating linguistic descriptions for assessing the user's performance after the analysis of the acquired data is developed.In order to face the complexity of the exercise, the Granular Linguistic Model of a Phenomenon (GLMP), which includes a Fuzzy Finite State Machine (FFSM) for modeling the different poses of the user and merging information from several sensors, is used. First, the relevant poses of the Sun Salutation are identified based on the accelerations produced during the process, performing the analysis involving body parts. Once the poses are recognized by the FFSM, the rhythm, stability and symmetry of the movements produced are analyzed to evaluate the Sun Salutation quality corresponding to a specific exercise. Finally, a method for producing a linguistic report about the quality of the execution, in terms of the relevant features, is used. This type of reports could be used to analyze the temporal evolution of the Sun Salutation exercise, e.g., while learning and improving its execution during physical rehabilitation therapies.The approach that we follow in this work for data analysis is based on the Computational Theory of Perceptions. This field was first introduced in Zadeh's paper “From computing with numbers to computing with words – From manipulation of measurements to manipulation of perceptions” [31] and further developed in subsequent papers. The Computational Theory of Perceptions provides a framework to develop computational systems with the capacity of computing with the meaning of Natural Language (NL) expressions, i.e. with the capacity of computing with imprecise descriptions of the world in a similar way that humans do it.The contributions of this paper are both theoretical and practical. The contribution to the field of quality assessment of rehabilitation exercises is done by designing and developing a tool for linguistic assessment of a physical rehabilitation exercise such as the Sun Salutation sequence. The tool includes a computational model able to describe the exercise execution at different levels of granularity by giving insights about its rhythm, stability and symmetry. The theoretical contribution consists of exploring the possibility of creating linguistic descriptions about how phenomena evolve in time. Not only the current state of phenomena is analyzed but also the intermediate states to generate a new type of linguistic descriptions.The remainder of this paper is organized as follows. Section 2 presents the main concepts of our approach to linguistic description of complex phenomena evolving in time. In Section 3, the system used for human motion monitoring is introduced. Section 4 describes how to use the previously introduced concepts for the linguistic assessment of the Sun Salutation quality. Section 5 describes the experimentation carried out, by describing the experimental setup and discussing the results. Finally, Section 6 draws some conclusions and introduces future research works.The approach to computational model of phenomena is based on subjective perceptions of a domain expert that observes phenomena, called the “designer”. The designer perceives through the sensors and provides the computer with her/his own personal experience, i.e., the designer is who speaks when the computer speaks. Therefore, the more experienced designer, with better understanding and use of NL in the application domain, the richer the model with more possibilities of achieving and responding to final users’ needs and expectations. In the current project, the designer is a person experienced with the motion of the body while performing the Sun Salutation sequence, being able of modeling the exercise by using the data available from several on-body sensors. Furthermore, the designer takes into consideration which is the relevant information to be extracted during the analysis in order to provide a useful feedback for rehabilitation purposes.In this section, we describe the components of the Granular Linguistic Model of a Phenomenon (GLMP), our approach based on the Computational Theory of Perceptions for developing computational systems able to generate linguistic descriptions of phenomena [7,12].A CP is the computational model of a unit of information acquired by the designer about the phenomenon to be modeled. In general, CPs correspond to particular details of the phenomenon at certain degrees of granularity. A CP is a couple (A, W) where:A=(a1, a2, …, an)is a vector of n linguistic expressions (words or sentences in NL) that represents the whole linguistic domain of the CP. Each aidescribes the value of the CP in each situation with specific granularity degree. These sentences can be either simple, e.g., ai=“The angle of the sensor is negative.” or more complex, e.g., ai=“The symmetry of the calves during the first pose is high.”is a vector of validity degreeswi∈[0,1]assigned to each aiin the specific context. The concept of validity depends on the application, e.g., it is a function of the truthfulness of each sentence in its context of use.We use PMs to create and aggregate CPs. A PM is a tuple (U, y, g, T) where:Uis a vector of input CPs, U=(u1, u2, …, un), whereui=(Aui,Wui)and n is the number of input CPs. In the special case of first order perception mappings (1-PMs), these are the inputs to the GLMP and they are valuesz∈ℝbeing provided either by sensors or obtained from a database.is the output CP, y=(Ay, Wy).is an aggregation function employed to calculate the vector of validity degrees assigned to each element iny,Wy=(w1,w2,…,wny). It is an aggregation of input vectors,Wy=g(Wu1,Wu2,…,Wun), whereWuiare the degrees of validity of the input perceptions. In fuzzy logic, many different types of aggregation functions have been developed. For example, g might be implemented using a set of fuzzy rules. In the case of 1-PMs, g is built using a set of membership functions as follows:Wy=(μa1(z),μa2(z),…,μany(z))=(w1,w2,…,wny)where Wyis the vector of degrees of validity assigned to each ay, andz∈ℝis the input data.is a text generation algorithm that allows generating the sentences in Ay. In simple cases, T is a linguistic template, e.g., “The calves symmetry is {low | medium | high}”.The GLMP consists of a network of PMs. Each PM receives a set of input CPs and transmits upwards an output CP. We say that each output CP is explained by the PM using a set of input CPs. In the network, each CP covers specific aspects of the phenomenon with certain level of granularity. Fig. 2shows an example of a GLMP, where the phenomenon can be described at a very basic level in terms of two variables providing values, z1 and z2, at a certain instant of time.As mentioned above, we call first order perception mappings (1-PM) to those which are inputs to the GLMP. These 1-PMs produce first order computational perceptions (1-CP). On the other side, PMs whose inputs are CPs are called second order perception mappings (2-PM) and their outputs are 2-CPs.Using different aggregation functions and linguistic expressions, the GLMP paradigm allows the designer to model computationally her/his perceptions. In the case of Fig. 2, the second order perception mapping 2-PM3 indicates that 2-CP3 can be explained in terms of the first order computational perceptions 1-CP1 and 1-CP2, i.e., how the validity of each item in 2-CP3 is explained by those of 1-CP1 and 1-CP2. Finally, the top-order description of the phenomenon is provided, at the highest level of abstraction, by 2-CP4, explained by 2-PM4 in terms of 2-CP3 and 1-CP2. Notice that, by using this structure, one can provide not only a linguistic description of the phenomenon at a certain level, but an explanation in terms of linguistic expressions at a lower level.Once the GLMP is fed with input data, the aggregation functions are used to calculate the validity degrees corresponding to potentially hundreds of linguistic expressions. The input data depends on each particular application. In this case, it is motion data acquired by a wearable sensing system. Now, the challenge consists of choosing the more adequate combination of these sentences to generate a useful linguistic description of the phenomenon evolution including the current state. The design of this report requires a deep analysis of the application domain of language and, therefore, the collaboration of the specific final user.For the demonstration of concept in this paper, we will use a simple report, made by choosing the linguistic expressions with the highest validity degree and including detailed explanations of a perception by using the conjunction “because”. The interested reader is referred to [6], where two different types of report templates are developed.The objective of human motion tracking is to provide data that allows to obtain the related information about the pose of the human body, or part of it. The later analysis of this data can contribute significantly to understand the observed phenomena. The development of miniaturized wearable sensors is of particular relevance in physical therapy, as this technology allows gathering data that can precisely assess the impact of clinical interventions on the real life of patients and the recovery [10,32]. Among the many different sensors that can be used for monitoring, Micro-Electro-Mechanical Systems (MEMS) show great potentials. This is mainly due to their size and low cost, which allow to incorporate them in compact, non-obtrusive continuous monitoring devices that can be easily attached to the body [22]. In particular, accelerometers can provide reliable and accurate information as well as objective and quantitative measurements when attached to different parts of the body [30].A previously developed low-cost and low-power wearable sensing system [16,17], was used in this work. It is formed by six small universal modules (a master module, and five wearable slave modules, which include high performance tri-axial accelerometers), and a software for data reception and synchronization, as it can be seen in Fig. 3(a). The main component of the architecture is the acquisition device, the Henesis WiModule [20], shown in Fig. 3(b).The master module acts as a receiver, and it is connected to a computer in order to save the data, while the other five modules, acting as slaves (and identified by an ID number), are attached to the body and transmit the information related to human motion to the master device using wireless communications. The transmissions follow the IEEE 802.15.4 standard for wireless communications in the 2.4GHz band, while the accelerometers provide measurements in ±6g range with a sampling frequency fs=160Hz. For each time instant, i.e., every 6.25ms, the record contains the following information: (x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, x5, y5, z5), 15 channels, which correspond to the three axis of each of the five slave modules.In order to acquire meaningful data to appropriately model the movement, the location of the sensors was established as follows:•Sensor 1: on the right forearm, above the hand.Sensor 2: on the left forearm, above the hand.Sensor 3: on the back waist, near to the center of mass of the body.Sensor 4: on the right lower part of the calf, over the Achilles tendon.Sensor 5: on the left lower part of the calf, over the Achilles tendon.The selected locations allow, in addition, to avoid the problems related to placing the sensors and the influence of the user's height.During the Sun Salutation, the movement of the body is measured along the antero-posterior and the superior–inferior axes, as shown in Fig. 4(a). Considering how the exercises are performed in this space, we change from the Cartesian to the spherical coordinate system in order to measure the angle of the sensors with respect to the vertical axis Z, i.e., the θ angle (see Fig. 4(b)). This angle proves to be a relevant attribute with an adequate resolution degree to describe the human body movements while performing this sequence of poses. Following this approach, the record was reduced to five channels related to the angles:θ1,θ2,θ3,θ4,θ5. Moreover, in order to more accurately recognize the transitions between the different poses of the exercise, five additional channels were considered, which correspond to the derivatives of the mentioned angles:dθ1/dt,dθ2/dt,dθ3/dt,dθ4/dt,dθ5/dt. Each of these channels allows knowing if the corresponding angle is decreasing, increasing or keeping constant at each instant of time.Once the sensors are worn, it is necessary to proceed with a calibration process to align the axes of their accelerometers to the same reference coordinate system, previously shown in Fig. 4. For this reason, at the beginning of the exercise it is required that the user stays in a certain position, just standing with the arms in a relaxed position next to the body and the legs closed together, for a pair of seconds. In our convention, the Z axis is aligned with the gravity, being positive in the upper half-plane. By obtaining the corresponding rotation matrix and applying it to the following data, in this static position, all the accelerometers’ vectors point to the floor, due to the gravity. These angles are referred afterwards to the horizontal plane, going from −90° to 90° (in the calibration pose).Fig. 5shows the GLMP designed for the linguistic description of the Sun Salutation exercise quality. The gray speech bubbles show different examples of linguistic expressions associated to several CPs. We have selected three main features to assess the patient's performance: the symmetry, the stability and the rhythm. People with disabilities, such as people who suffer a stroke, which is considered the most common neurological disorder, are generally affected of weakness or paralysis on one side of their bodies, which results in asymmetrical posture. Working on postural symmetry in the early stages of rehabilitation creates an awareness of body position. On the other hand, being able to stabilize the movement determines the postural balance control. Evaluation of postural stability is important for clinicians to diagnose balance problems early and to evaluate the effects of interventions to treat these problems [11]. Finally, the study of the rhythm reflects the pace of the movement of the patient, which is particularly relevant for Parkinson's disease patients.The GLMP is organized into three levels. The lower one corresponds to the time instant and it is divided into three different sublevels (entry, pose elements, and pose recognition), the medium level is related to the pose and the higher one to the whole Sun Salutation sequence. It is worth noting that we can generate linguistic expressions for each level of granularity.In the entry level, we use the angles related to the five accelerometers (θ1, θ2, θ3, θ4, θ5) and their derivatives (dθ1/dt, dθ2/dt, dθ3/dt, dθ4/dt, dθ5/dt) to identify the poses and movements of the forearms, the back waist and the calves for the pose elements level. Afterwards, in the pose recognition level, the corresponding CPs allow to identify the pose that is being performed at each instant.In the intermediate level related to the pose, we analyze the symmetry of the forearms and the calves for each pose, by considering the data provided by the accelerometers worn on them. The stability during each pose is also obtained by analyzing how well it is maintained without trembling.These measures are aggregated at the Sun Salutation sequence level to evaluate the symmetry and the stability during the whole exercise. Moreover, the duration of each of the poses and its variability are taken into account. These measures allow evaluating afterwards the rhythm of the execution of the exercise. Finally, we use the total symmetry, stability and rhythm of the Sun Salutation execution to estimate its quality in order to provide a feedback to the patient and the clinicians by a linguistic description. “The quality of the Sun Salutation execution is medium because the symmetry is medium, the stability is low and the rhythm is adequate” could be an example of a final report.In this section, each of the PMs is described. For the sake of simplicity, the set of poses of the Sun Salutation to be considered is reduced to the first three and the last two poses (which correspond to poses 1, 2, 3, 11 and 12 in Fig. 1, respectively), including an additional one at the beginning and at the end for sensors calibration.The entry level is formed by 1-PMs which collect information directly from the sensors. There are two different types: the former related to the angle of the sensors, and the latter, related to the corresponding derivatives.It is a 1-PM whose input is the numerical value of the angle formed by the vector given by the sensor i and the Z axis (θi∈[0°, 180°], i∈[1, 5]). The outputCPyθi, gives a fuzzy description related to the angle formed by the vector given by the sensor i and the horizontal plane (). It includes the following set of NL sentences:a1θi→“The angle of the sensor ‘i’ is very negative.”a2θi→“The angle of the sensor ‘i’ is negative.”a3θi→“The angle of the sensor ‘i’ is zero.”a4θi→“The angle of the sensor ‘i’ is positive.”a5θi→“The angle of the sensor ‘i’ is very positive.” which can be described by the following template:a[1:5]θi→“The angle of the sensor ‘i’ is {very negative | negative | zero | positive | very positive}.”The validity degrees are obtained from trapezoidal membership functions that were designed empirically after an important experimental effort, being tuned according with the criteria of the specific final application. The same happens regarding to the definition of the most suitable set of sentences for describing each CP.It is a 1-PM whose input is the numerical value of the derivative of the angle θiof the sensor i: dθi/dt, which is negative when the angle is decreasing, positive when it is increasing and zero when it is keeping constant. The outputCPydθi, gives information related to this derivative. The corresponding set of NL sentences is described by the following template:a[1:3]dθidθt→“The angle of the sensor ‘i’ is {decreasing | not varying | increasing}.”The validity degrees are also calculated by means of trapezoidal membership functions.We decided to aggregate the information from the sensors in such a way that we could describe the pose of different parts of the body (forearms, back waist and calves) and their movement. This level is formed by 2-PMs whose inputs are the outputs of the 1-PMs of the level below:CPθ1,CPθ2,CPθ3,CPθ4,CPθ5,CPdθ1,CPdθ2,CPdθ3,CPdθ4andCPdθ5. In particular, PMF, PMBand PMCmake use of the CPs related to the angles to describe the poses of the forearms, the back waist and the calves. On the other side, PMFM, PMBMand PMCMhave as inputs the CPs related to the derivatives of the angles of the sensors to describe the movements of these parts of the body. These PMs allow to specify intermediate fuzzy variables that will simplify later the rules of the FFSM in the upper level.The PMFhas two inputs: the two CPs corresponding to the angles of the sensors on both forearms which provide an output CPyFwith information about the forearms pose, as shown in Table 1. Next to each NL description, the associated variable is indicated. These conditions result in the following set of sentences:a1F→“The forearms are in straight pose.”a2F→“The forearms are in mountain pose.”a3F→“The forearms are in overhead pose.” being the associated template:a[1:3]F→“The forearms are in {straight | mountain | overhead} pose.”Fig. 6shows the space where the forearms poses are defined considering the membership functions of the angles of sensors 1 and 2.The PMBhas just one input, the CP corresponding to the angle of the sensor in the back waist. Its main purpose is to provide a more descriptive output, CPyF, indicating the back waist pose, as shown in Table 2. The corresponding set of NL sentences is described by the following template:a[1:3]B→“The back waist is in {straight | bending backward | bending forward} pose.”Table 3shows the NL description the calves pose and the corresponding intermediate variables, provided by the PMCby using the CPs corresponding to the angles of the sensors on both calves. The associated template for its NL sentences is the following one:a[1:2]C→“The calves are in {straight | bending backward} pose.”By combining the information of the derivatives of the angles corresponding to the sensors of the forearms, PMFMprovides an output CP describing their movement, as shown in Table 4. Its template for the NL sentences is:a[1:3]FM→“The forearms are {not moving | moving up | moving down}.”PMBMprovides a description of the movement of the back waist by interpreting the CP related to the derivative of the angle of the sensor attached to it. Table 5shows its output CPyBMand the variables related to it. The corresponding template is the folllowing one:a[1:3]FM→“The back waist is {not moving | moving backwards | moving forwards}.”The last PM in this level provides information of the calves movement, as shown in Table 6. The template below describes its set of NL sentences:a[1:2]CM→“The calves are {not moving | moving to “bending backward pose”}.”This level allows to recognize the pose at each time instant by using a special PM, described below.This 2-PM, whose inputs are the outputs of the PMs of the level below (PMF, PMB, PMC, PMFM, PMBMand PMCM), defines the elements of a pose. The output CPyposeincludes the following set of NL sentences:a0pose→“The current pose is 0: standing with arms falling in relaxed position.”a1pose→“The current pose is 1: standing with hands in mountain pose.”a2pose→“The current pose is 2: standing raising hands overhead.”a3pose→“The current pose is 3: standing forward fold, hands next to feet.”a4pose→“The current pose is 4: standing raising hands overhead.”a5pose→“The current pose is 5: standing with hands in mountain pose.”The aggregation function (gpose) calculates, at each time instant, the next value of the validity degrees for each sentence based on the previous validity degrees and current input CPs, the intermediate fuzzy variables described above. The aggregation function is, therefore, an expert knowledge based FFSM. The interested reader could see previous papers on FFSM for a more detailed description of this paradigm and its applications [5,15,29]. Fig. 7represents the state diagram of the FFSM designed for the reduced cycle of the Sun Salutation. This state diagram allows to recognize the different poses depending on the PMs aggregated on PMpose.There are rules to remain in each pose i (Ri→i) and rules to change from one pose i to another pose j (Ri→j). Due to the characteristics of the reduced Sun Salutation exercise and according to the state diagram previously shown in Fig. 7, there are 12 fuzzy rules in total in the system, six rules to remain in each pose and other six to change between poses. We chose the pose 0 as the initial one, i.e.w0posewill initially have a value equal to 1. In this way, the FFSM will synchronize with the Sun Salutation exercise when the conditions to be in that pose are fulfilled, without the need of doing previous segmentation of the signal. In this work, the set of fuzzy rules of the FFSM has been set up experimentally using the available expert knowledge about the Sun Salutation sequence. However, it is interesting to mention that in [8,9] it is presented an automatic method for learning the model parameters based on the hybridization of Fuzzy Finite State Machines and Genetic Algorithms leading to Genetic Fuzzy Finite State Machines. The rule base of gposeis as follows:R0→0: IFa0poseANDa1FANDa1BANDa1CANDa1FMANDa1BMANDa1CMTHENa0poseR1→1: IFa1poseANDa2FANDa1BANDa1CANDa1FMANDa1BMANDa1CMTHENa1poseR2→2: IFa2poseANDa3FANDa2BANDa2CANDa1FMANDa1BMANDa1CMTHENa2poseR3→3: IFa3poseANDa1FANDa3BANDa1CANDa1FMANDa1BMANDa1CMTHENa3poseR4→4: IFa4poseANDa3FANDa2BANDa2CANDa1FMANDa1BMANDa1CmTHENa4poseR5→5: IFa5poseANDa2FANDa1BANDa1CANDa1FMANDa1BMANDa1CMTHENa5poseR0→1: IFa0poseANDa2FANDa1BANDa1CANDa2FMANDa1BMANDa1CMANDTmove0(d0)THENa1poseR1→2: IFa1poseANDa3FANDa2BANDa2CANDa2FMANDa2BMANDa2CMANDTmove1(d1)THENa2poseR2→3: IFa2poseANDa1FANDa3BANDa1CANDa3FMANDa3BMANDa1CMANDTmove2(d2)THENa3poseR3→4: IFa3poseANDa3FANDa2BANDa2CANDa2FMANDa2BMANDa2CMANDTmove3(d3)THENa4poseR4→5: IFa4poseANDa2FANDa1BANDa1CANDa3FMANDa1BMANDa1CMANDTmove4(d4)THENa5poseR5→0: IFa5poseANDa1FANDa1BANDa1CANDa3FMANDa1BMANDa2CMANDTmove5(d5)THENa0poseWhere•The first term in the antecedent computes the previous validity degree of the sentenceaipose, i.e.,wipose. With this mechanism, we only allow the FFSM to move from the pose i to the pose j (or to remain in pose i, when i=j). For example, in R0→0, it is computed the validity degree of the sentence “The current pose is 0: standing with arms falling in relaxed position” (w0pose).The second, third and fourth terms in the antecedents describe the constraints imposed on the positions of the forearms, the back and the calves, respectively. For example, in the case of the second antecedent, related to the position of the forearms, it computes the validity degree of one or various of the three possible sentences that this CP (uF) has, e.g., “The forearms are in mountain pose” (w2F).The fifth, sixth and seventh terms in the antecedents describe the constraints imposed on the movement of the forearms, the back and the calves, respectively. For example, in the case of the fifth antecedent, related to the movement of the forearms, it computes the validity degree of one or various of the three possible sentences that this CP (uFM) has, e.g., “The forearms are moving down” (w2FM).The eighth term in the antecedent, if present, describes the conditions that constrain the poses duration. To control the duration diof each pose we define a linguistic label for each pose i:Tmovei(which is the minimum time that the pose i is expected to lasts before changing to pose j). For example, in R1→2, we calculate the membership degree of d1 to the linguistic label Tmove. To calculate the duration of each pose di, we use Eq. (1) which weights the duration of each pose with its validity degreewipose:(1)di[t]=0ifwipose[t]=0di[t−1]+wipose[t]·Tsotherwisebeing Ts=1/fsthe inverse of the sampling frequency (160Hz), which corresponds to the sampling period, 6.25ms.Fig. 8shows an example of the linguistic label Tmoveused to define the temporal constraints for moving from one state to another. In agreement with our knowledge about the Sun Salutation, we assign to each pose a duration between 3s and 15s.Finally, the consequent of the rule defines the next pose. To calculate the validity degrees of the sentences associated with each pose j (wjpose), a weighted average using the firing degree of each rule Rij(ϕij) is computed as defined in Eq. (2):(2)wjpose=∑i=05ϕij∑i=05∑j=05ϕijwhere (ϕij) is calculated using the minimum for the AND operator and the bounded sum of Łukasiewicz [4] for the OR operator.Note that each rule of this set is a complete linguistic expression as can be seen in the following expanded expression of the rule R44 to remain in pose 4: “If the previous pose is 4, standing raising hands overhead, and the forearms are in overhead pose, and the back and the calves are bending backward, and none of them are moving, then, the current pose is 4, standing raising hands overhead”.As an example of the performance of our proposal for the reduced Sun Salutation sequence, Fig. 9represents the validity degrees the sentences associated to each pose together with the angles and their derivatives of each one of the sensors (θiand dθi/dt, respectively). It shows how this set of fuzzy rules is able to model linguistically the six poses of the selected sequence of positions.The PMs here belong to an upper level of granularity (pose level). Their output CPs are calculated for each pose instead of being calculated at each time instant.As it can be seen in Fig. 5, PMFShas three CPs as inputs: the angle of the sensors on the forearms, 1 and 2, and the current pose, i.e.,U=(uθ1,uθ2,upose). The output CPyFSincludes the following set of NL sentences:a[1:3]FS→“The forearms symmetry in pose {i} is {low | medium | high}.”The validity degrees (w1FS,w2FS,w3FS) are obtained by means of the aggregation function gFS. This function makes use of the Jaccard index [18] as similarity function J(x, y), which is defined using Eq. (3), in order to compare the angles of both forearms during the pose. This is done for each instant of time and then averaged over its duration.(3)J(x,y)=1ifx=0andy=0min(x,y)max(x,y)otherwiseThis PM is equivalent to the previous one, but it takes into consideration the angle of the sensors in the calves, sensors 4 and 5, to calculate their symmetry for each pose. Therefore, its three CPs inputs are: the angles of the sensors 4 and 5, and the current pose, i.e.,U=(uθ4,uθ5,upose). The output CPyCSincludes the following set of NL sentences:a[1:3]CS→“The calves symmetry in pose {i} is {low | medium | high}.”Following the same criteria that in the previous PM, the aggregation function gCSmakes use of the Jaccard index for comparing the angles of both calves during each pose.In order to give information about the stability, this PM considers the fluctuation of the validity degree of each sentence related to the pose. It is calculated as the average value of the validity degree for the current pose i along its duration (Ti) as shown in Eq. (4).(4)wiPST=∑t=0Tiwipose[t]TiThe output CPyPSTincludes the following set of NL sentences:a[1:3]PST→“The stability in pose {i} is {low | medium | high}.”In Fig. 5, these CPs are calculated for a complete sequence of the Sun Salutation instead of being calculated for each pose.This perception mapping is in charge of analyzing the forearms symmetry during the Sun Salutation sequence. It has just one input CP, which corresponds to the lower level forearms symmetry for each pose, so the set is U=(uFS). This PM includes a set of three NL sentences in its output CP (yAFS) following the template below:a[1:3]AFS→“The forearms symmetry during the Sun Salutation is {low | medium | high}.”The aggregation function (gAFS) calculates the validity degree (wiAFS) of each sentence as shown in Eq. (5):(5)wiAFS=∑k=1PwiFS[k]Pwhere P is the total number of poses, six in the case of the reduced version of the Sun Salutation sequence.This PM is equivalent to the previous one, but it analyzes the calves symmetry during the Sun Salutation sequence, instead of the forearms symmetry. The input CP included in its set, U=(uACS), corresponds to the calves symmetry for each pose. Its set of three NL sentences in its output CP (yACS) is described by the following template:a[1:3]ACS→“The calves symmetry during the Sun Salutation is {low | medium | high}.”Similarly to the previous PM, the equivalent aggregation function gACScalculates the validity degree of each sentence.This PM makes use of the duration of each pose (di) calculated using Eq. (1) to estimate the total duration of the exercise, being its output CP (yD) a set of three NL sentences defined by the template below:a[1:3]D→“The Sun Salutation has a {low | medium | high} duration.”On the other hand, this PM provides information of the variability of the duration of the Sun Salutation sequence by considering the standard deviation of the duration of the individual poses. Its output is defined as follows:a[1:3]σD→“The variability of the duration of the Sun Salutation is {low | medium | high}.”This PM has two CPs as inputs: the symmetry of the forearms and the symmetry of the calves. Therefore, the set of input CPs is U=(uAFS, uACS). This PM includes a set of three NL sentences in its output CP (yS) following the template below:a[1:3]S→“The symmetry of the Sun Salutation is {low | medium | high}.”The aggregation function (gS) calculates the validity degrees (wiS) for each sentence. This function is defined by Eq. (6), which calculates the average value of each pair of validity degrees of the input CPs associated with a low, medium, and high symmetry:(6)wiS=wiAFS+wiACS2This PM has one CP as input: the stability of the poses along the Sun Salutation sequence. Therefore, the set of input CPs is U=(uPST). This PM has a set of three NL sentences as output CP (yST) which are defined by the template below:a[1:3]ST→“The stability during the Sun Salutation is {low | medium | high}.”The aggregation function (gST) calculates the validity degrees (wiST) for each sentence. This function is defined by Eq. (7), which calculates the average value of the three validity degrees of the input CPs associated with a low, medium, and high stability considering the values obtained previously for each of the poses:(7)wiST=∑k=1PwiPST[k]Pbeing P the total number of poses of the reduced version of the Sun Salutation sequence.This PM makes use of the CPs corresponding to the duration of the Sun Salutation exercise and its variability between the poses. The output CP (yR) of this PM includes a set of three NL sentences defined by the template below:a[1:3]R→“The rhythm of the Sun Salutation is {variable | adequate | optimal}.”The aggregation function (gR) is an expert knowledge based Fuzzy Rule-Based System (FRBS). Considering the three different sentences for each of the inputs, there are nine different rules obtained when combining them:R1: IFa1DANDa1σDTHENa2RR2: IFa2DANDa1σDTHENa3RR3: IFa3DANDa1σDTHENa2RR4: IFa1DANDa2σDTHENa1RR5: IFa2DANDa2σDTHENa2RR6: IFa3DANDa2σDTHENa1RR7: IFa1DANDa3σDTHENa1RR8: IFa2DANDa3σDTHENa1RR9: IFa3DANDa3σDTHENa1RThe top PM, PMQ, has three CPs as inputs: the symmetry, the stability and the rhythm obtained from the Sun Salutation performance. Therefore, the set of input CPs is U=(uS, uST, uR). We have defined five different levels of quality: very low, low, medium, high, and very high. Therefore, the output CPyQhas a set of five possible sentences defined by the following template:a[1:5]Q→“The quality of the Sun Salutation execution is {very low | low | medium | high | very high}.”The aggregation function (gQ) in this case is also an expert knowledge FRBS. The combination of all possible values for each of the input would give us a total of 33=27 rules. After a rule simplification process using [2,3], we obtained the following 19 ones:R1: IFa1SANDa1STAND NOTa3RTHENa1QR2: IFa1SANDa2STANDa1RTHENa1QR3: IFa2SANDa1STANDa1RTHENa1QR4: IFa1SANDa1STANDa3RTHENa2QR5: IFa1SANDa3STANDa1RTHENa2QR6: IFa3SANDa1STANDa1RTHENa2QR7: IF NOTa3SANDa2STAND NOTa1RTHENa3QR8: IF NOTa3SANDa3STANDa2RTHENa3QR9: IFa2SANDa1STAND NOTa1RTHENa3QR10: IFa2SAND NOTa1STANDa1RTHENa3QR11: IFa3SANDa1STANDa2RTHENa3QR12: IFa3SANDa2STANDa1RTHENa3QR13: IFa1SANDa3STANDa3RTHENa4QR14: IFa3SANDa1STANDa3RTHENa4QR15: IFa3SANDa2STANDa2RTHENa4QR16: IFa3SANDa3STANDa1RTHENa4QR17: IF NOTa1SANDa3STANDa3RTHENa5QR18: IFa3SANDa2STANDa3RTHENa5QR19: IFa3SANDa3STANDa2RTHENa5QThe consequents of the rules define the Sun Salutation quality. To calculate the validity degrees of the sentences associated to the different levels of the Sun Salutation quality (wiQ), a weighted average using the firing degree of each rule Ri(ϕi) is computed as defined in Eq. (8):(8)wiQ=ϕi∑i=15ϕiEach rule of this set is a complete linguistic expression as can be seen in the following expanded expression of the rule R19 that predicts a very high value of the Sun Salutation quality: “If the symmetry is high, the stability is high and the rhythm is optimal, then, the Sun Salutation quality is very high”.In this section, we present the experimental results obtained by our proposal. In order to assess the quality of execution of the Sun Salutation exercise, we collected the acceleration signals of a set of 10 healthy participants, who voluntarily took part in the evaluation. There were 7 men and 3 women with the following characteristics (mean±standard deviation): age=28.10±2.02 years, height=176.60±12.83cm, mass=73.90±17.69kg and body mass index=23.37±3.10kg/m2.We asked each person to perform the Sun Salutation exercise four times producing a total of four datasets for each person, except for the first subject that performed the exercise 10 times (where the first six datasets were used to tune the model parameters and the remaining four were used in the test phase).Table 7shows the validity degrees of the sentences associated to the quality of one randomly chosen exercise from each person among the four test samples. It also shows the validity degrees associated to the symmetry, stability and rhythm. The report provided by the proposed system is generated by using the sentences corresponding to the maximum validity degrees, which are boldfaced. As an example, three different generated sentences are as follows:•“The quality of the Sun Salutation execution of subject 5 is medium because the symmetry is high, the stability is high and the rhythm is variable.”“The quality of the Sun Salutation execution of subject 7 is high because the symmetry is high, the stability is high and the rhythm is variable.”“The quality of the Sun Salutation execution of subject 10 is very high because the symmetry is high, the stability is high and the rhythm is adequate.”It can be seen from the results that the quality of the Sun Salutation execution is always medium or greater, being high for three subjects and very high for six subjects. Their performance is mainly influenced by the rhythm that they maintain during the exercise. Thanks to the hierarchical structure of the GLMP, we can provide reports with a higher level of detail. As an example, in Table 8the validity degrees associated to the Sun Salutation sequence partial level performed by Subject 5 are shown. The sentences that explain the symmetry and the rhythm of Subject 5 are as follows:•“The symmetry is high because the forearms symmetry is high and the calves symmetry is high.”“The rhythm is variable because the duration of the Sun Salutation is low and the variability of the duration is medium.”In case we want to check why the symmetry of the forearms does not have a very high value for the validity degree, we can descend to the pose level, whose validity degrees are shown in Table 9: “The forearms symmetry is high because the symmetry of poses 0, 1, 2 and 3 is high and the symmetry of poses 4 and 5 is medium”. At this level, we can also check the information of the stability of each pose: “The stability is high because the stability of poses 0, 1, 2 and 3 is high, the stability of pose 4 is medium and the stability of pose 5 is low.”.

@&#CONCLUSIONS@&#
This work contributes to the field of linguistic assessment of rehabilitation exercises. It includes the use of a Granular Linguistic Model of a Phenomenon in combination with a Fuzzy Finite State Machine in order to merge data from multiple sensors. We have developed a tool which is able to provide linguistic assessment of a physical rehabilitation exercise such as the Sun Salutation sequence, which is an interesting example of a phenomenon evolving in time. We have created a computational model which evaluates the quality of the exercise based on its symmetry, stability and rhythm during the movements at different levels of granularity. To capture the available data, we have used a previously developed low cost wearable sensing system demonstrating its usefulness for human motion acquisition and tracking for the posterior processes of activity recognition and performance evaluation. From the theoretical point of view, we have created linguistic descriptions about phenomena evolution by analyzing not only the current pose of the exercise but also the transitions between poses, giving insight about the symmetry, stability and rhythm of the movements when the user moves from the first pose to the last one.In the current stage of development, we have been able to model and generate linguistic descriptions that correspond to a particular exercise. In future projects, we will focus on the given application field in order to improve the usability of these texts. We could develop a commercial product that combines both a low-cost human motion monitoring system and the software needed to generate natural language expressions in the context of each specific purpose.Thanks to the versatility of our wearable sensing system and the interpretability of our Granular Linguistic Model of a Phenomenon it is possible to apply the current proposal for monitoring different complex exercises involving movements of any part of the body.