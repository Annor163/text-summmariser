@&#MAIN-TITLE@&#
A robust signal preprocessing framework for wrist pulse analysis

@&#HIGHLIGHTS@&#
We provide a robust and effective preprocessing framework for wrist pulse analysis.We introduce a cascade filter based on frequency-dependent analysis for de-noising.The first derivation strategy has the best performance in pulse period segmentation.We propose an adaptive thresholding method to eliminate the outliers.The wrist pulse analysis depends heavily on the pulse preprocessing methods.

@&#KEYPHRASES@&#
Wrist pulse preprocessing,Wavelet-based decomposition,Intra-class distance,Period segmentation,

@&#ABSTRACT@&#
Wrist pulse has been a physical health indicator in Traditional Chinese Medicine (TCM) for a long history. With the development of sensor technology and bioinformatics, quantifying pulse diagnosis by using signal processing technology is attracting increasing attentions in recent years. Since wrist pulse signals collected by the sensors are often corrupted by artifacts in real situations, many approaches on the wrist pulse preprocessing including pulse de-noising and baseline wander removal are introduced for more accurate wrist pulse analysis. However, these scattered methods are incomplete with some limitations when used to preprocess our special pulse data for the clinical applications. This paper presents a robust signal preprocessing framework for wrist pulse analysis. The cascade filter based on frequency-dependent analysis (FDA) is first introduced to remove the high frequency noises and to select the significant pulse intervals. Then the curve fitting method is developed to adjust the direction and the baseline drift with minimum signal distortion. Last, the period segmentation and pulse normalization is applied for the feature extraction. The effectiveness of the proposed pulse preprocessing is validated through experiments on actual pulse records with biochemical markers. In contrast with the traditional methods, the proposed preprocessing framework is effective in extracting more accurate pulse features. And the highest classification rate 91.6% is obtained on diabetes diagnosis. The results demonstrate that our method is superior to the former pulse preprocessing researches and practical for wrist pulse analysis.

@&#INTRODUCTION@&#
Wrist pulse contains rich information of human body. It has been applied to health diagnosis in Traditional Chinese Medicine (TCM) since ancient times [1]. The Chinese medicine practitioners used to feel the pulsations by placing three fingers at the radial artery to judge the health status of patients. Thus, the pulse diagnosis depends heavily on the subjective analysis of practitioners and turns out to be unreliable and inconsistent [2]. With the advances in sensor technology, a number of pulse acquisition platforms are developed to collect the computerized wrist pulse waveforms for more objective and accurate pulse diagnosis recently [3–6].We design a novel wrist pulse acquisition platform with multi-channel and fusion sensors. The pulsations at the wrist are first detected by the sensor arrays, and then transformed into the digital voltage outputs through the analog and digital circuit. Since the wrist pulses are weak vibrations inside human body, they are often noised by disturbances from environments. Three dominant artifacts present in our wrist pulse signals are: (1) high-frequency noise caused by 50Hz power line interferences and artifact motions acting on the sensors; (2) baseline wander caused by respiration; (3) cycle deviation that may be due to the chaos phenomenon. All these artifacts badly influence the accuracy of wrist pulse analysis and should be removed to avoid false-positive classification.It is well known that wrist pulse is a periodic physiological signal with each single period representing a heartbeat cycle as electrocardiogram (ECG). These two physiological signals are both driven by the heart and somewhat reflect the health status of heart [7,25]. Thus, ECG has been widely used for the heart monitoring and arrhythmia checkup [8]. The heart rhythms can be accurately obtained from the periods of the both two signals. Compared with ECG, the wrist pulse waveform flows a long way from the heart. As a result, it is not only influenced by the heart conditions, but also affected by the conditions of nerves, muscles, skin, arterial walls and blood parameters (volume, contents, viscosity, pressure, and velocity) [9]. Therefore, the wrist pulse contains more information than ECG due to the interactions of inside organs [10]. And the methods for ECG preprocessing could not be applied to preprocess the wrist pulse directly.A number of methods have been proposed for the wrist pulse preprocessing, but to data all have been flawed for our wrist pulse database. In summary, the former researches on pulse preprocessing can be divided into two categories, pulse de-noising and baseline drift removal. For the pulse de-noising, Ciaccio and Drzewiecki [11] propose a differential steepest descent (DSD) adaptive noise cancelation method. However, there is a large shift in the baseline level. Xia et al. [12] introduce a zero-phase filtering on pulse trend, which processes the input pulse data in both forward and reverse directions to overcome the phase shift. Arunkumar et al.[28,29] and Sareen [30] use wavelet based method for removing the noise in the acquired pulse signals. An approach of Dynamic Time Warping (DTW) is utilized for the identification of outlier pulses in the wrist pulse series by Thakker and Vyas [31]. But the evaluation criterions of the filters are not verified through the wrist pulse analysis. Empirical mode decomposition (EMD) is introduced for the pulse de-nosing by Wu and Lee [13]. However, the experiment is conducted by adding a white noise series to the targeted data under simulated environments. And it is not suitable for our actual pulse records collected under real environments. As a result of the baseline drift, the wrist pulse has a relatively low frequency component throughout the entire signal. This kind of distortion also appears in ECG and other physiological signals [14,15]. Approaches from frequency view, including Finite Impulse Response (FIR) filter, Kalman filter and wavelet cascade filter, are applied to remove the baseline drift [15–19]. They all attempt to suppress the baseline wander with high pass filter, which would introduce nonlinear phase distortion as well as the key-knots displacement caused by time-domain convolution. Besides, the wrist pulse signals in these experiments are corrupted by adding the drift manually, which is not convincing for practical application.Besides the two conventional preprocessing methods, we add the pulse period segmentation into the framework for the first time. The period segmentation plays an important role in pulse analysis to extract the intra-class information. Xia et al. [12] propose a period segmentation and estimation method to represent the pulse trend. Chen et al. [20] introduce a period segmentation for pulse analysis by using modified Gaussian models. Joshi et al. [26,27] extracted peaks in the pulse signals using a complex frequency b-spline wavelet method. However, these methods all choose the average single-period pulse from the entire signal after the period segmentation, resulting in the loss of detail information.In this paper, our focus is on building a robust signal preprocessing framework for wrist pulse analysis. We first introduce the proposed pulse acquisition platform and specify the inherent properties of the coarser pulse data. Then, a cascade filter based on frequency-dependent analysis is proposed for the wrist pulse de-noising. Next, the interval selection is performed to remove the distortion sections. For the baseline drift in our database, the direction correction and curve fitting method is employed to adjust the baseline wanderings. Last, the pulse normalization is developed for feature extraction.Besides the description of the wrist pulse preprocessing algorithms and the related theoretical derivations, in this paper, much attention is paid on comparisons of the methods through the quantitative and qualitative evaluations. We do experiments using the real wrist pulse records with definite labels, which are acquired from the volunteers of Prince of Wales Hospital, Hong Kong. The experiment results indicate that the classification accuracy is increased significantly by using the proposed preprocessing framework. And the experimental studies also demonstrate that the proposed pulse preprocessing framework outperforms the previous methods, especially for the wrist pulse analysis. The contributions of this work lie in two aspects. First, we introduce the novel algorithms in pulse signal enhancement. Second, the preprocessing framework is applied to extract the intra-class features for wrist pulse analysis.The remainder of this paper is organized as follows. In Section 2, we introduce the pulse acquisition platform and the characteristics of the original pulse database from both time-domain and frequency-domain. The preprocessing framework and the comparisons of the preprocessing methods are outlined in Sections 3 and 4, respectively. Finally, a conclusion is given in Section 5.In TCM, the practitioners took pulse by feeling the pulsations at “Cun”, “Guan” and “Chi” three adjacent positions of the wrist with proper pressures (deep, middle and superficial). The pressures and positions yield the concept of nine indicators. The health status of specific internal organs could be obtained from the relationships between nine indicators and the internal organs [21]. The relations are based on the “Maijing (The Pulse Classic)” compiled by Wang Shuhe, which is the first extant book specializing in sphygmology. Thus, the pulsations from “Cun”, “Guan” and “Chi” three parts should be collected as a whole for the pulse diagnosis.In our work, an USB-based pulse acquisition platform with multi-channel and fusion sensor array is developed to collect the wrist pulse signals from “Cun”, “Guan” and “Chi” simultaneously (see Fig. 1). The proposed system is composed of three parts, pulse sensor array, circuit and interface. And the three independent channels correspond to the Cun, Guan and Chi positions. Each channel contains a pulse sensor array to transform the physical beatings into weak voltage outputs. Then, the millivolt voltages are processed by the amplification and filtering module. The amplified voltages from the sensor array are converted into digital signals simultaneously using a 12-bit data acquisition card at a sample rate of 500Hz. Next, the micro digital signal processing module is applied to control the static contact pressures. Finally, the digital wrist pulse signals are sent to a PC for real-time monitoring through a universal serial bus interface and stored in Microsoft Database (MDB) format.Fig. 2shows the proposed pulse acquisition platform. All measurements were undertaken in a quiet indoor environment. When taking subject's pulse, we first search the rough positions of wrist pulse by feeling the pulsations at the radial artery. Then the transducer is put around the wrist with the sensor array covering the right corresponding regions. Next, the contact pressure is subtly controlled by the step motors at the top to obtain optimal pulse waveforms. Once stable pulses with high amplitudes appear, we pause the pressure adjustment and preview the waveforms for a moment. Last, the wrist pulse is recorded for more than 60s for each volunteer.Fig. 3(a) shows a typical pulse waveform collected by the pulse acquisition platform. It can be seen that wrist pulse is a periodic signal similar to ECG. The periods are correlated with the cardiac rhythm. And the baselines often wander due to the respiration and artifact motions. The difference between the two physiological signals is that the shape of each single-period pulse varies with each other in the detail points.Fig. 3(b) presents a local enlargement of the single-period pulse signal. The signal is composed of an ascending limb and a descending limb. A tidal wave and a dicrotic wave often exist in the descending limb, which make up the characteristic points of the pulse shape information along with the percussion wave. Many methods based on the time series analysis such as auto-regression (AR) model [22], Gaussian model [20] and spatial parameters [9] are proposed to extract the time-domain pulse features.In general, the heart rate is around 30–90 beats per minute in an adult human being. The basic period of the pulse is, therefore, the same as heart rhythm. And the frequency components of the characteristic points are above the cardiac rhythm. A scientific way of studying the pulse should be to analyze its frequency spectrum distribution [10].Fig. 4shows the frequency spectrum of the pulse waveform in Fig. 2(a). The sampling rate is set to 500Hz to cover the frequency bands of the pulsations. According to the Nyquist sampling theorem, the frequency range of the acquired pulse waveform is from 0Hz to 250Hz. Fig. 4(a) shows the global frequency distribution. The frequency spectrum is concentrated in the bands below 20Hz. The high frequency components at around 50Hz and 100Hz belongs to the power line interference. Fig. 4(b) shows the frequency spectrum details from 0Hz to 20Hz. The frequency component with the highest amplitude at around 1Hz denotes to the basic period. Components with frequency lower than the period are caused by uncontrollable artifacts and respiration activities.Based on the frequency distribution, we propose a frequency-dependent analysis (FDA) method to analyze pulse properties in frequency-domain. Wavelet transform is a mature algorithm that has been widely applied to signal decomposition. By using the wavelet decomposition, the wrist pulse signals are divided into several frequency bands. We select the wavelets ‘sym8’ as the basic component and the decomposition is processed at level eight. Fig. 5shows the wavelet decomposition coefficients of a typical wrist pulse. A partial enlargement view of the wavelet coefficients of bandCD1toCD4is placed in the center.Table 1shows the relationship between the divided frequency bands and the levels of wavelet decomposition. According to the energy distribution properties, we separate them into four groups: noise, details, structure and baseline. The pulse information mainly contains in the bands fromCD4toCD8, which covers the frequency spectrum range from 1Hz to 20Hz. Because the energies decrease rapidly above 20Hz, which belongs to the power line interference section. We simply ignore this range in the pulse analysis. The energy at the bandAD8reflects the DC component and the baseline wander, and this band can be discarded. The pulse de-noising and baseline wander removal are performed in theCD1–CD4bands andCA8band, respectively.The wrist pulse waveforms collected by electronic sensing elements bring in noise, inevitably. And the pulse baseline drift varies with each individual. Besides, distortions, inversions and period variances exist in the pulse database. These interferences should be removed to perform accurate pulse analysis. Fig. 6shows the proposed preprocessing framework for wrist pulse analysis, which consists of four stages in sequence: pulse de-noising, interval selection, baseline wander removal, period segmentation and pulse normalization.The wrist pulse is easily noised by micro disturbance such as the 50Hz power line interference, tiny jitter and talking. In addition, the circuit itself also brings in white Gaussian noise and high frequency noise at the analog-to-digital conversion module. According to the FDA theory, the useful pulse information is contained below 20Hz. Consequently, we first design an Equiripple FIR low-pass filter with pass-band frequency at 12Hz and stop-band frequency at 16Hz to eliminate the high frequency noise caused by power line interference and the AD conversion module. It removes the burrs and keeps the trends. However, the low-pass filter brings distortions to the de-noised pulse signals due to the errors between desired filter and ideal filter. And the dramatic subtle ups and downs in the pulse waveforms are restrained owing to the filtering effect. These disadvantages motivate us to find a more accurate pulse de-noising method.We design a cascade de-noising method by combining the wavelet transform with Gaussian filter. Fig. 7presents the diagram of the proposed de-noising method. First, the original pulse waveform is divided into 8 bands based on wavelet decomposition. According to the FDA theory, the pulse information is mainly contained in the bands from CD4 to CD8. In band CA8, the coefficients approximate the pulse baseline. Then, the coefficients of these bands are used to reconstruct the pulse waveform by using the inverse wavelet transform. Finally, the reconstructed signals are smoothed by the Gaussian filter.Although body movements, hysterical emotions, talking and coughing are forbidden during the pulse collecting. The pulse waveforms are often corrupted by unconscious jitters, coughing or uncontrollable movements of patient's arm. Besides, signal magnitudes maybe exceed the quantization range and lead to truncations in certain pulse samples. These distortions are still reserved after the pulse de-nosing procedure.Fig. 8(a) illustrates a pulse waveform disturbed by a sudden body movement. Fig. 8(b) presents a typical truncated pulse waveform owing to the saturation effect, and the corresponding value distribution is shown in Fig. 8(c). The values of normal pulse waveforms are distributed evenly over the whole range. Conversely, the outlying observations such as the truncated and abnormal values lie in the two ends of the histogram. These two kinds of distortion cannot be recovered as critical information is missing. Therefore, we propose an adaptive thresholding method to eliminate the pulse intervals with the unrecoverable distortions. The interval selection algorithm is defined by the formula below:(1)p(t)=1,ts(t)−E(s)≤θ1*δ1(s)+θ′1δ′1(s)0,otherwiseu(t)=s(t)*p(t)(2)q(t)=1,tu˙(t)−E(u˙)≤θ2*δ(u˙)0,otherwisey(t)=q(t)*u(t)First, we calculate the global standard deviation δ1(s) and the local standard deviationδ′1(s)of the pulse waveform, which are used to eliminate the intervals with abnormal values. Since the normal pulse waveforms change gradually during the sampling period. Then the first order derivation which measures the gradient is extracted to eliminate the intervals with drastic changes. The weighted parameters θ1,θ′1and θ2 are set to 0.5, 2 and 1.5 based on the experience. In order to guarantee that all segmented waveforms contain several complete pulse periods, the length of the selected intervals is required to have at least four cycle periods.Fig. 9presents the procedure of the pulse baseline wander removal. It consists of three steps. First, the pulse direction is adjusted to the same standard. Next, the consecutive local minimums of each period are extracted for the cubic spline interpolation. Finally, the drift is removed by subtracting the estimated wander curve.Since a two-level cantilever beam structure is proposed as the pressure sensing element in the proposed pulse acquisition platform, the positions of the pulsation force applied on the beam result in two opposite deformation directions. Thus, the pressure sensors laid on the top of cantilever beam detect two states of pressure changes with opposite directions.Direction adjustment is performed before baseline estimation. There are two pulse direction types existed in the pulse database. Fig. 10shows typical pulse waveforms with opposite directions. Fig. 10(a) displays the normal pulse waveform with positive direction. Fig. 10(b) presents the variant pulse signal with negative direction.In order to reduce the varieties of pulse direction, we need to adjust the pulse waveform directions to the same standard. In the experiments, we set the pulse waveform with a shorter length ascending branch as the standard direction. Meanwhile, the onset point of the first cycle is regarded as the pulse zero-phase. Peak and valley detection is employed to compare the length of ascending and descending branch. And the pulse direction is determined by the length of the two branches. An adaptive sliding window method is adopted to obtain the peak and valley points in the signals (see Fig. 11). The whole algorithm is described as follows:(1)Perform the Fourier transform to find out the basic frequency fp, basic period is calculated as Tp=1/fp.Detect peak and valley points of the pulse signal within initial window [0,Tp]. Peak is the maximum point and valley is the minimum. The corresponding positions at timing axis are p1 and v1 respectively.Slide the window step by step to update the information. The second extreme points p2 and v2are detected in time interval [p1+(Tp/2), p1+(3Tp/2)].Repeat the procedure (2) and (3) till the window moves to the end. Check up the missing valleys and peaks by the rules of one to one correspondence.Assume that x stands for a pulse signal, the time sets of pulse peaks and valleys are given byp(x)=p1,p2,…,pmandv(x)=v1,v2,…,vm, respectively. They meet the conditionv1<p1<v2<p2<⋯<vm<pmand m is the length of pulse cycle. The pulse direction is given by the follow formulas:(3)D(x)=sgn1m−1∑i=1m−1(vi+1−pi)−1m∑i=1m(pi−vi)pi∈p(x),vi∈v(x)Then the algorithm of pulse direction adjustment is given by the formula below:(4)y(t)=D(x)x(t)+1−D(x)N∑i=1Nx(i),t=1,2,…,NIf the pulse waveform is negative, the peaks will be turned into valleys after the direction adjustment. The time sets of pulse valleysv(x)=v1,v2,…,vmare used for baseline estimation.The cubic spline is selected as the interpolation curve. Since the baseline wander caused by respiration has nonlinear contents and the linear estimation will bring distortions if used. Thus, we prefer the cubic spline functions to the linear interpolation in baseline drift estimation. Fig. 12shows the baseline estimation result. The pulse waveforms are then corrected by subtracting the estimated remaining wander.Pulse is a periodical physiological signal driven by the heart and flows along the artery through the internal organs. It is not a determinate process that can be expressed by a mathematic function. Although the rough structures of each period in one sample are almost the same, the details vary from cycle to cycle. The traditional period selection and average single-period pulse extraction both ignore the intra-class information. Thus, the period segmentation methods are necessary to extract the intra-class distance among cycles for pulse analysis.The period segmentation is developed following the baseline wander removal module. From an overall point of view, each cycle can be regarded as the basic element of pulse waveforms. Consequently, pulse samples are segmented into a set of the single-period signals. Different segmentations are employed in this module, since the segmentation performance is affected by the strategies. To obtain the optimal segmented single-period pulse sets, we propose six segmentation strategies to ensure the split points as below:1)Encoding valley detection(EVD): The pulse value is encoded using the integer function to remove the interferences caused by small extreme points. Then, the valley of each cycle is set as the onsets.Encoding peak detection(EPD): The encoding method is the same as EVD and the peak of each cycle is set as the onsets.Local minimum(LM): The standard methods by using the local minimum value of each cycle as the onsets without encoding and the baseline wander removal.Local minimum slope(LMS): Onsets are determined by the local minimum slope of the ascending limb at each cycle.Wander correction(WC): Baseline wander removal and encoding are used to ensure the onsets.First derivation(FD): The original pulse waveforms are mapped into the first derivation space and the local maximums of each cycle are detected as the onsets.The performance comparisons on the segmentation strategies are discussed in Section 4.2.Due to the variances of heart rhythm, the pulse periods vary from individual to individual. Therefore, the segmented single-period pulse signals always have unequal lengths. The amplitude, which is influenced by static contact pressure and pulse energy, also differs. Additionally, the onsets and ending points of each single-period pulse which are not in a horizontal line, which leads to the pulse rotation. Consequently, the pulse normalization is essential to preprocess the pulse data from various operational and environmental conditions. It consists of three stages, pulse rotation transformation, down sampling and amplitude normalization.The rotation transformation aims to rotate the wrist pulse to be horizontal. The angle between the horizontal line and the line connecting the onset and end point of the single-period pulse is defined as the rotation angle θ. The adjusted pulse is obtained by using the transformation formula below:(5)[t′,y(t′)]=[t,x(t)]cosθ−sinθsinθcosθDown sampling and amplitude normalization are applied to obtain equal single-period pulse points and to scale the value magnitude to a proper range, respectively. Let the single-period pulse be a time series y(i). Where N1 stands for the number of original single-period points and N2 for the resampled single-period points. Linear interpolation is used to calculate the value of pulse point y(i+Δt) between points y(i) and y(i+1). The down sampling procedure is accomplished by the following equations to get the resampled signalz(i)i=1,…,m.(6)z(i)i=1,…,m=y1+(i−1)×N−1m−1(7)y(i+Δt)=(1−Δt)⋅y(i)+Δt⋅y(i+1)The amplitude scale normalization is given by the formula below:(8)z¯(i)=z(i)−mini=1,…,mz(i)maxi=1,…,mz(i)−mini=1,…,mz(i)×Awhere A is the predetermined rescaled amplitude, max(·) and min(·) denotes to the maximum value and the minimum value of the pulse data series, respectively.The collected pulse signals are authentic and original in the truest sense. And the pulse from healthy subjects and diabetic patients are chosen as two classes. In total, we collect 250 pulse samples from 125 healthy subjects and 125 diabetes patients, respectively. The database is built in Prince of Wales Hospital, Hong Kong. All patients were inpatient volunteers from the Hospital and the written consents are taken before pulse taking. The labels of the healthy subjects are determined according to the recent health check. The diabetic patients are confirmed by comparing their blood levels with standard clinical blood markers.For each subject, the pulse signals from Cun, Guan and Chi three channels are all acquired as one pulse sample. The distribution of the pulse database is ensured to avoid the influence caused by biological inter-patient variability. Table 2lists the organization of the dataset. The age, BMI and gender distribution is similar between healthy and diabetes patients.In the first experiment, we study the performances of the proposed cascade de-noising filter, wavelet filter, FIR low-pass filter and moving average filter by using actual pulse records. We randomly choose 200 pulse data from our database and pass the coarse pulse data series through the filters. Fig. 13illustrates the results, demonstrating the performance of the proposed cascade filter. In Fig. 13(a), Sig1 is the clean pulse waveform and Sig2 is the noised pulse waveform. Sig3, Sig4, Sig5 and Sig6 are the de-noised pulse signals of Sig2 by using wavelet filter, FIR Low-pass filter, moving average filter and the proposed cascade filter, respectively. Fig. 13(b) is the local enlargement of Fig. 13(a).Three parameters are used to quantitatively evaluate the quality of the de-noised pulse signals: (1) percentage mean error (PME); (2) percentage standard deviation error (PSDE); (3) percentage smoothness (PS). The PS parameter is to measure the smoothness of the de-noised pulse waveform in contrast to the noised pulse, and it correlated with continuity of the derivative. The parameters of PME, PSDE and PS are defined, respectively, as:(9)PME=m¯−mm,m¯=1N∑i=1Nx¯(i),m=1N∑i=1Nx(i)(10)PSDE=x¯−m¯2−x−m2x−m2(11)PS=(x−x¯)'2/x′2wherex¯(i)represents the de-noised pulse signal and N denotes the number of points of the pulse waveform, m andm¯is the mean value of original and de-noised pulse, respectively. x′ represents the first-order derivation vector and is calculated by using the functionf′=f2−f1,f3−f2,…,fN−fN−1. The smaller the evaluation parameters, the better is the pulse de-noising performance.The evaluation result is listed in Table 3. It can be seen that the parameters of the de-noised signals by using the proposed cascade filter are the smallest. The FIR filter brings much distortions to the shape components around the cut-off frequency. The wavelet filter and the moving average filter both have shortcomings in keeping continuous. The experimental result illustrates that the proposed de-noising filter outperforms the others in keeping details of the pulse signals and preserving the smoothness.In the second experiment, the proposed period segmentation strategies are compared to select the optimal algorithm. The period segmentation is introduced to extract the inter-class distance information for the pulse analysis. An optimal period segmentation guarantees that the variance should be small within the class and the distance between classes should be distinguishable. Thus, the inter-class distance and intra-class distance are employed as the evaluation criterions.For each subject, the pulse de-noising, interval selection and baseline drift correction are applied to the wrist pulse before the period segmentation module. Six criterions are then developed to find the optimal algorithm. The inter-class distance and intra-class distance of the segmented single-period pulse signals are given by the formulas below:(12)mi=1Ni∑x∈ϕix,i=1,2,…,N(13)Mj=∑mi∈Pjmi,j=1,2In the above equation, x stands for the single-period pulse signal segmented from the sample ϕi. And midenotes to the average waveform. The pulse from healthy subjects and diabetic patients are divided into two classes Pjand Mjis the center of class. Thus, the inter-class distance Sbcan be obtained by the formula below:(14)Sb=(M1−M2)(M1−M2)TThe intra-class scatter matrix Siis calculated in each sample ϕi, and the total intra-class scatter matrixSwis defined by the formula below:(15)Si=∑x∈ϕi(x−mi)(x−mi)T(16)Sw=∑iSiAnd the intra-class distance is given by the formula below:(17)l=tr(Sw)/Nwhere tr() denotes to the trace of a matrix. The intra-class distance l describes the pulse self-similarity and the pulse stability.The segmentation comparison result is shown in Fig. 14. The average single-period pulse and the standard deviation of the two classes are presented in different colors. The red line stands for the healthy class and the blue line for the diabetes. Error bars show the confidence intervals of the deviation at each point. Fig. 14(a) and (b) displays the segmentation results by using valley and peak detection with encoding. Fig. 14(c) shows the original method by detecting the local minimum points in the valleys. Fig. 14(d) gives the single-period pulse waveforms by using the local minimum slope as the onsets. Fig. 14(e) shows the segmentation strategy with the baseline wander correction module. Fig. 14(f) presents the segmented results based on first derivation method.The evaluation result of the proposed segmentation strategies is shown in Table 4. The first derivation segmentation (FDS) has the smallest intra-class distance and the largest inter-class distance among the six strategies. The intra-class distance of the signals reflects the segmentation quality, and small intra-class distance is preferred. The inter-class distance measures the separability from the center vector. The encoding and baseline wander correction strategies are superior to the original local minimum strategy. And the peak detection is superior to the valley detection in the time-domain space owing to the stability. The single-period pulse signals segmented in derivation space have the most distinguishable state. Thus, the FDS strategy is finally selected in the period segmentation module.In the third experiment, we intend to compare the proposed pulse preprocessing with other methods on diabetes diagnosis. In the former pulse analysis researches, the pulse waveforms were considered as a determinate periodic signal. As a result, one cycle from the pulse was manually selected for the feature extraction. In this paper, we take the wrist pulse waveforms as a complicated set with variances from cycle to cycle. The pulse features are extracted from the entire signal.Fig. 15shows the flow chart of pulse analysis. The raw pulse waveforms are first processed by the proposed preprocessing framework, which consists of pulse de-noising, interval selection, baseline wander adjustment, period segmentation and pulse normalization. After the preprocessing, the single-period pulse set of each pulse sample is computed. Then, the characteristic points, amplitudes, periods, pulse width, intra-class distance and wavelet coefficients are extracted as the pulse fusion features. At last, a proper classification hyper plane is constructed to distinguish the diabetic samples from the healthy samples.We select the SVM with radial basis function (RBF) kernel for constructing the classifiers. To reduce influence caused by sample partitioning, the fivefold cross validation is used in the experiments. We randomly divide the pulse samples into five folds in each class. Each fold contains 25 different samples and each sample only belongs to one fold. In each cross validation, we use four of the five groups in each class for the training and leave one for the testing. The optimum specifications of the RBF kernel parameters are determined by the grid searching technique. The final classification accuracy is obtained by averaging recognition rates of the fivefold cross experiments.An additional four pulse preprocessing techniques and the related features applied to diabetes diagnosis are introduced for comparisons. Chen et al. [22] proposed an AR model to extract the disease-sensitive features. The AR model deals with the entire signal. In order to normalize the measured data with respect to varying operational and environmental conditions, each wrist pulse signal f(t) is normalized prior to fitting an AR model by the formula below:(18)f˜(t)=f(t)−mfδfwhere mfand δfare the mean and standard deviation of f(t), respectively. Table 5gives the classification results. An accuracy of 82.3% is obtained by using the AR features.Gaussian model [20], which is similar to the AR model, is also developed to match the pulse waveforms. Nevertheless, the Gaussian model deals with the single-period pulse signals. Both the low-frequency baseline drift and the high-frequency noise are reduced simply by using a 7-level ‘db6’ wavelet transform. Then a single-period pulse signal is selected and expressed by a two-term Gaussian function with an offset. The fitting parameters of the model are taken as the feature inputs to the fuzzy clustering classifier. The accuracy reaches 85.9% by using the Gaussian model features with de-noising and period segmentation preprocessing.Zhang et al. [23] introduce a wavelet-based method for wrist pulse analysis. Before feature extraction, the amplitudes of the pulse signals are first normalized to the same scale. Then, the wavelet coefficient features are extracted by using the wavelet decomposition at each level. A maximal margin support vector classifier is used for the pattern recognition. The classification rate reaches 85.6% for diabetes diagnosis. Liu et al. [24] select a stable segment of 1200 points from entire pulse signals to extract heterogeneous features for wrist pulse diagnosis. The classification accuracy reaches 66.89% for classifying healthy persons and patients with three kinds of diseases by using multiple kernel learning method.The performances between pulse analysis with preprocessing and without preprocessing are also developed. For pulse signals without preprocessing procedure, we extract the fusion features of shape, energy, frequency and wavelet coefficient, except the intra-class distance. And the features are classified by using the kernel SVM classifier. In the condition without preprocessing, an accuracy of 61.2% is obtained for diabetes diagnosis. And the classification rate reaches 91.6% by using the proposed pulse preprocessing framework. A ratio of 30% increase is obtained. It demonstrates that the proposed pulse preprocessing framework is necessary for pulse analysis. The experimental result also implies that the single-period pulse signals from different cycles bring complementary information.It is evident in Table 5 that the classification accuracy of the fusion feature by using the proposed pulse preprocessing is much higher than the other methods on diabetes diagnosis. An increase of 5.7% and 6.0% is obtained compared to the Gaussian model method and the wavelet method, respectively. The wrist pulse preprocessing of AR model and multiple kernel learning only considers the deviation normalization and de-nosing for a segment of entire pulse, respectively. The accuracy is lower than the methods with period segmentation. And the wrist pulse diagnosis without any preprocessing gains the worst performance.By this experiment, we can draw a conclusion that the performance of the proposed preprocessing framework is effective and superior to the former researches. The preprocessing framework is robust under various conditions, and it is also practical for wrist pulse analysis.

@&#CONCLUSIONS@&#
