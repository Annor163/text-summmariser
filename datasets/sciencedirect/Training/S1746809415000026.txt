@&#MAIN-TITLE@&#
EEG–fMRI: Dictionary learning for removal of ballistocardiogram artifact from EEG

@&#HIGHLIGHTS@&#
A novel method based on dictionary learning is proposed for BCG removal from EEG data, simultaneously recorded with fMRI.Review of existing BCG removal techniques is presented.Original dictionary learning approach is explained.A new cost function, having the generic dictionary learning as its core, is proposed.The solution to the proposed cost function can model BCG artifact and then remove it from EEG recordings.

@&#KEYPHRASES@&#
Artifact removal,Ballistocardiogram (BCG),Dictionary learning,Electroencephalography (EEG),Sparse representation,

@&#ABSTRACT@&#
In this paper, artifact removal from biomedical signals is addressed. We particularly focus on removing ballistocardiogram (BCG) artifact from EEG. BCG mainly appears in EEG signals during simultaneous EEG–fMRI recordings. Different from most existing artifact removal techniques, we propose a method based on dictionary learning framework. Due to strength of sparsifying dictionaries in applications such as image denoising, it is expected to succeed in BCG removal task as well. This is investigated in the proposed approach where a dictionary is learned from original EEG recording. The dictionary is designed to locally model BCG characteristics. After achieving the dictionary, BCG can be simply subtracted from the original signal and the clean EEG is obtained. Our experimental results on both synthetic and real data confirm the effectiveness of the proposed method. The results reveal the flexibility of learned dictionary for modeling the fluctuations in artifact, and removing it from original EEG signals.

@&#INTRODUCTION@&#
Electroencephalography (EEG) acquired from the brain scalp, reflects the synaptic activity inside the brain. This type of biomedical signal has shown advantages in diagnosis of different brain illness and also brain functions. EEG, which is normally recorded in a number of channels (at different locations of the brain), is known to convey significant temporal information about the brain. However, it cannot reveal detailed spatial information about the brain and therefore it is not a perfect brain representative in cases where exact locations in the brain is to be found. In contrast to EEG, functional magnetic resonance imaging (fMRI) reveals useful spatial information and represents the local hemodynamic changes in the brain known as blood oxygenation level dependent (BOLD). Although EEG and fMRI have been separately used in many applications, simultaneous EEG–fMRI has been recently received too much interests due to its spatial–temporal characteristics [1–6]. This specific multimodal property of EEG–fMRI opens a new window to study unknown human brain functions which is an ongoing field of study [7–9].In spite of advantages of simultaneous EEG–fMRI, it has major limitations. The most obvious one is the effects of artifacts appeared in EEG. Several dominant artifacts which contaminate EEG signals recorded inside the MRI scanner are vibration-related artifacts, gradient artifact, and ballistocardiogram (BCG). Vibration-related artifacts are caused due to the helium pump of the MR scanner [10]. Several techniques such as template subtraction or spatial filtering were used in this regard. However, these have not shown to be very effective mainly because of irregular temporal shape of the artifact. Another artifact in the EEG signal is induced due to the scanner's internal ventilation system (for fresh air supply). The properties of this artifact have been recently studied by Nierhaus et. al [10]. They show that the ventilation system causes a peak in the power spectrum of the EEG, mainly around the gamma frequency range of the EEG, which can be problematic. Gradient artifact results from variations of magnetic field in the MRI scanner during image acquisition, and severely distorts the EEG signals. Fortunately, gradient artifact appears in high frequencies and in very high amplitudes up to 100 times larger than the EEG amplitudes [11]. Therefore, it can be removed using averaging and subtraction approaches [1]. BCG artifact, which is more difficult to be removed, is the result of EEG electrode movements over the subject scalp laid inside the scanner. Small electrode movements, resulted from cardiac pulsation in the magnetic field, induce a voltage into each electrode. Primary EEG recordings inside the MR scanner appeared to have heart-beat-related artifact. The artifact was supposed to be due to whole body movement as a result of acceleration and abrupt reversal in blood flow in the aortic arch [12]. After this observation, further studies have been achieved to characterize and interpret BCG behavior with the aim of performing a successful removal technique. It is obvious that strength of electromagnetic field has a direct effect on the BCG and this is the fundamental reason of causing BCG. In other words, movement of any electrical conductor (including body movements) inside a static magnetic field causes electromagnetic induction [12]. In other studies, the pulsatile movement of the scalp is interpreted as a result of expansion and contraction of adjacent blood vessels [12]. Following this conclusion, a method was proposed for BCG removal by using a motion sensor, combined with an adaptive filtering approach. It is also believed that blood flow by itself, as a conductive fluid, could cause BCG. In fact, when blood flow is exposed in a static magnetic field, its movement induces electrical potentials [13]. These studies show that electrodes adjacent to blood vessels, such as frontal–temporal and occipital channels, would severely be affected and thus leading to major contribution of BCG-related artifacts in EEG signals.BCG artifact obscures the EEG signal mainly at alpha frequencies (8–13Hz) and below [14]. The amplitude of BCG is approximately 150μV inside a magnetic field with the strength of 1.5T [14]. It is very important to remove BCG artifact in an EEG–fMRI regime. This should be carried out very carefully as losing EEG information during BCG removal may lead the output signal to be meaningless. There are essentially two approaches in this regard. One family is devoted to designing different data recording techniques, and the second category aims at developing signal processing algorithms to remove BCG artifacts.Investigating of BCG-related artifact properties would be very important for the researchers to develop novel removal techniques either at the acquisition stage or through signal processing methods. One primary approach to decrease the electrode movements, and consequently reduce BCG artifact, is firmly bandaging the wires and electrodes to the subject scalp [11]. Recently, a specific data recording called DRPE (direct recording prior encoding) is proposed for better separation of BCG and EEG [15]. This recording technique leads to representative bases of BCG- and EEG-only signals, alleviating the risk of model mismatches. In another study, an integrated learning and inference approach is proposed to estimate the BCG artifacts in a noisy recording [16]. This is achieved by utilizing a high-density EEG-cap and setting a special-designed experiment. Yan et al. [17] studied the magnitude and spatial variation of the artifact voltages. They expect that these effects are due to cardiac-pulse driven head rotation. Moreover, the Hall effect [17] is expected to be caused by blood flow in the main arteries of the brain, which conclusively lead to BCG artifact. Deeper study has been recently demonstrated by Mullinger et al. [18] for identifying the sources of the pulse artifact in a combined EEG–fMRI recording. They design extensive sets of experiments to measure the amplitude and variability of three sources; cardiac-pulse-driven head rotation, the Hall effect due to pulsatile blood flow and pulse-driven expansion of the scalp. They could significantly reduce the effects of pulse artifact by using head restraint and utilizing an insulating layer during EEG acquisition.The second and more popular category of BCG removal approaches relies mainly on signal processing techniques. One of the pioneering simple BCG removal methods is average artifact subtraction (AAS) [11]. In this method, the ballistocardiogram is removed from EEG signal by subsequent template subtraction from each channel. The main challenge in using AAS is that the template cannot well follow the artifact changes over time. This is due to the fact that shape of BCG artifact is affected by both variation of heart beat and subject movements and thus does not occur similarly in all trials and time segments. Improved versions of AAS using different techniques, such as a dynamic template [19], or clustering of pulse artifacts [2], to address the variability of the artifact over time was later proposed. Recently, a statistical modeling based on singular value decomposition (SVD) is used to remove both gradient and BCG artifacts in EEG–fMRI recordings [20]. Although these techniques could mitigate the lacks of original AAS, they still have a major limitation and that is the need for a reference electrocardiogram (ECG) signal which may not always be available. Other previous BCG removal studies are mainly based on blind source separation (BSS) techniques. Principal component analysis (PCA) is used by Niazy et al. [21] to develop an algorithm known as optimal basis set (OBS). This method, first recognizes BCG components in the contaminated signals, then adaptively subtracts a fixed number of components. OBS performs well when BCG-only artifact exists in the recordings. In cases where additional artifacts exist in EEG data, e.g. due to subject movement, OBS fails. There are several attempts to address this issue by applying Infomax to the results of OBS [12,22]. Independent component analysis (ICA) is another well-known and powerful BSS technique which has been used to remove the BCG from EEG [23]. ICA-based methods assume that the EEG recordings can be represented as a linear mixture of several occurrences, namely, neural activities inside the brain, BCG, the artifacts caused by muscles, and noise. ICA separates these components by decomposing the EEG recording into a set of independent components (ICs). After identifying the BCG component and removing it, the clean EEG can be obtained by backprojection of the remaining components [24,25]. The most important issue in BCG removal by ICA, is choosing the correct number of extracted components that should be deflated. Numerous studies discuss and propose different strategies to select most convenient number of component to be deflated [24–26]. There is always a trade-off in removing the number of ICs; small number of sources may leave some artifacts in the deflated signals, whereas large number of sources may eliminate vital EEG information. Incorporating prior knowledge (if exist) into BSS algorithms is also another stream of works interested to some researchers [27,28]. These techniques are conventionally called blind source extraction (BSE) as these attempt to extract a specific source(s) with known behaviors. Another such method is the work of Ferdowsi et al. [29] which use linear predictors (LP) to model temporal characteristics of BCG for gaining an acceptable removal performance.In this paper, we address the BCG artifact removal problem using a different technique. Our proposed method is based on the idea of sparse representation and dictionary learning which has been recently shown to be very effective in variety of applications [30,31], particularly denoising [32]. Although advantages of sparse representation has been studied in many biomedical applications [33,34], it rarely studied for artifact removal purposes. For instance, in [35] and [36], the authors apply predefined basis to sparsely represent EEG recordings and remove the existing artifacts. These works neither consider EEG–fMRI data nor take advantage of learned dictionaries. Another related work that addresses BCG removal is the work of [3] where combination of a set of predefined basis called discrete hermite transform (DHT) is used to model BCG artifact. However, it does not address the advantages of learned dictionaries and is mainly successful for removing BCG-only artifacts. It is evident that due to strong separability property of learned dictionaries [37], much work needs to be done in this field. In this work, we learn a sparsifying dictionary from the EEG recordings, contaminated with BCG, acquired in an EEG–fMRI experiment. The learned dictionary mainly captures characteristics of BCG due to relatively higher amplitude compared to EEG. In order words, the learned dictionary can well describe main features of BCG. To remove the artifact, we simply backproject the signal using the learned dictionary and sparse coefficients, and then subtract it from the original EEG recordings. We have conducted extensive experiments to examine the effectiveness of the proposed method. The obtained results confirm accurate BCG removal performance. In addition, we observed that the learned dictionary is capable of removing not only BCG but other types of existing artifacts.The rest of the paper is organized as follows. In the next section dictionary learning is described in detail. In Section 3 we mathematically present the proposed technique for the purpose of BCG artifact removal. The simulation results for both synthetic and real data are presented in Section 4. Finally, the conclusion is drawn in Section 5.The objective in dictionary learning is to find a dictionary that can sparsely represent a signal or image. Dictionary is an overcomplete matrix in which its columns (also called atoms) describe the features of the corresponding signals/images. The term sparse refers to signals with small number of non-zero samples compared to signal length. Assume an overcomplete dictionaryD∈ℝn×K, n<K, is available. A signalx1∈ℝncan be represented as a linear combination of the columns of dictionary, i.e.{di}i=1K, such that x1=Ds1. The key point is that if x1 belongs to the class of dictionary atoms, thens1∈ℝKis said sparse. Consequently, x1 will be the result of linear combination of few columns of D with a good approximation. The question now is how to learn such dictionary? In order to mathematically define the dictionary learning problem assume m training signal of length n:{xi}i=1m. By collecting all training vectors into one matrixX={xi}i=1mof size n×m, and constitutingS={si}i=1mof size K×m, the dictionary learning problem can be expressed as:(1)minD,SX−DSF2=∑i=1mxi−Dsi22s.t.∥si∥0≤τ.where ∥.∥Fdenotes the Frobenius norm. The term ∥.∥0 is called ℓ0-norm which counts the number of non-zeros and is a measure of sparsity. τ is the upper bound for acceptable number of non-zero in each xiand should satisfy τ<<K. Many solutions to (1) or its variations have been reported in the corresponding literature.11One popular variation of (1) is a relaxed version, by replacing ℓ0-norm with ℓ1-norm defined as ∥s∥1=∑i|s(i)|.Most existing techniques tackle (1) alternatingly, i.e. obtaining S assuming D is fixed, then, obtaining D assuming S is fixed. This process is iteratively executed until a local minimum is met. One of the popular and powerful methods that follows the above alternating minimization process is K-SVD [30]. As its name implies, it applies combination of singular value decomposition (SVD) and K-means clustering to find D. For finding S, any of many sparse recovery techniques can be used [38,39]. As theoretical details of K-SVD is out of the scope of this paper we refer the interested readers to [30] for more details. In this paper, we use K-SVD as the dictionary learning algorithm. Some of other existing proposed dictionary learning methods are method of optimal directions (MOD) [31] and maximum likelihood (ML)-based method [40].In the previous section, the mathematical tools to be used in this section were introduced. This section is devoted to discussing how we can apply these tools to corrupted EEG data for removing its BCG contribution. In fact, we can simply say that our problem here is similar to the classical denoising problem [32] but with a different interpretation. If we define the clean EEG signal by v, the corrupted acquired EEG by y, and the BCG contribution by x, the following additive model can be addressed:(2)y=x+v.The desire is to model BCG part, i.e. x, to make it separable from y. This can be accurately achieved using dictionary learning techniques, particularly due to relatively higher magnitude of x, compared to v. Applying this model to y will leave portions that cannot be modeled by the dictionary, and that would be the clean EEG, i.e. v.It is worthy to note here that the proposed method is applied individually to each EEG recording channel. Hence, we denote y of length N as one of the EEG recording signal channels, acquired in an EEG–fMRI scheme. As seen in the previous section, we require m training signals as input of any dictionary learning method. A simple and common approach to provide these training samples is to segment the original signal into m smaller signal of length n. Note that these m segments can have any percentage overlap with each other. In this paper, full overlap between the adjacent segments is considered. It means that each segment is different from its adjacent segment only by one sample. The advantage of this strategy, i.e. learning the dictionary from small segments, is that the learned dictionary is local, meaning that it can perfectly capture local behavior of the input signals. In order words, the learned dictionary is expected to contain local existing features in the given input signal, which could be valuable for later analysis. In fact, the nature of using small signal segments (regardless of the amount of overlaps), for learning the dictionary, makes it local. This is in contrast to global analytical transforms such as discrete cosine transform (DCT) which are instantaneously applied to the entire signal. In addition, if non-overlapping segments are used for dictionary learning, the existence dependence between the adjacent samples (in the segments borders) is lost. Therefore, we use overlapping segments to learn informative dictionary atoms. However, our main purpose in this paper is not just learning the dictionary from EEG recordings; more importantly we aim at removing its BCG contribution. Therefore, we need to modify the original dictionary learning problem (1), taking model (2) into account:(3)minD,{si},xλy−x22+∑iρisi0+∑iDsi−Rix22.The first term in the above expression is the Euclidean norm between the acquired EEG, y, and BCG contribution, x. Parameter λ is a positive scalar that controls the amount of energy that should be devoted to x or v (note that based on (2):y−x22=v22). The second and third terms in (3), is equivalent to the dictionary learning problem given in (1) with slight differences in writing. Here, siis the sparse coefficient vector for i-th signal segment xisuch that xi=Dsi. Moreover,xi=Rix, whereRiis an n×N binary (0,1) matrix that extracts the i-th segment from x. Parameter ρiis a positive scalar to control the level of sparsity of si, and is adjusted within the dictionary learning algorithm.The result of solving (3) is the dictionary, D, sparse coefficients, {si}, and BCG signal, x. It is obvious that this problem is not simultaneously convex in all these three variables. The most straightforward solution to these kind of problems is alteraning minimization, similar to what used to solve original dictionary learning problem (1). To apply an alternating minimization process, we first initialize x and D respectively with y and overcomplete DCT dictionary.22Note that in (3), only y andRare known at first.Then, as explained above, all the segments of x are extracted and re-arranged. The segments are then processed by K-SVD [30] algorithm which updates D and estimates the sparse coefficients {si} in an iterative procedure. Up to this point, x was assumed fixed and dictionary learning was updating the dictionary and sparse coefficients. Afterward, the situation is reversed, i.e. D and {si} are assumed fixed and only x varies. So, x can be estimated by computing the derivative of (3) with respect to x and setting it to zero:(4)λy−x+∑iRiTDsi−Rix=0,leading to:(5)xˆ=λI+∑iRiTRi−1λy+∑iRiTDsi.In this equation, I is the identity matrix andxˆis the extracted BCG portion of original EEG recording. Also, (.)Tstands for matrix transpose. Finally, the clean EEG is simply obtained via:vˆ=y−xˆ. It is important to note that, calculation of (5) is achieved much simpler than what appears. Since,∑iRiTRiis diagonal,xˆcan be calculated sample-by-sample, and matrix inverse and huge matrix computations can be avoided. The steps of proposed method are summarized in Algorithm 1.Algorithm 1: The proposed algorithm.Input: EEG recording y, dictionary dimension n×K, and segment size m.Output: Estimated clean EEGvˆ.1begin21. Set D to overcomplete DCT;32. Set x=y;43. Extract segments from x:{xi}i=1m;54. Apply K-SVD to find{si}i=1mand D;65. Computexˆusing (5);76. Compute clean EEG:vˆ=y−xˆ8end

@&#CONCLUSIONS@&#
In this paper a new method for removal of BCG artifact from EEG signals was proposed. The method first learns a sparsifying dictionary from the given data. Then, the dictionary is used to model the existing BCG contribution in the original signals. The obtained BCG model is then subtracted from the original EEG to achieve clean EEG. To the best of our knowledge, this is the first reported study about applicability of dictionary learning for BCG removal. The keypoint here is that the learned dictionary, which is obtained from input data, can adaptively and locally represent the BCG characteristics. This is in contrast to methods based on predefined global basis such as Fourier, wavelet, etc. In other words, the proposed method specifically designs a dictionary for the given data, while well-known fixed transforms are publicly designed for a broader class of signals and may not be able to follow all aspects of a given signal. The experiments on both synthetic and real data confirmed that promising results can be achieved using the proposed method. Moreover, unlike other existing methods which rely on periodicity of BCG (which is not always met), or ECG channel information, no strong presumption is utilized in the proposed algorithm. This leads to higher robustness and stability especially in badly acquired EEG signals contaminated with BCG artifacts.Further evaluation of the proposed method for other EEG–fMRI recordings is still an open issue. The performance of the proposed method could differ for other EEG–fMRI experiments. In fact, depending on the tasks performed by subject, different types of brain activities are expected to occur. For instance, we were not able to verify steady state evoked potentials (SSEP) for the dataset used in this work due to lack of a repeated flashing. However, it might be measurable for other EEG–fMRI experiments. It would be valuable to know if such brain activity is preserved after applying the proposed removal algorithm. These are open streams of work which should be addressed in the future.