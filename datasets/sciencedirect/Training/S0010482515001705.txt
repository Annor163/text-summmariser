@&#MAIN-TITLE@&#
Age-series based link prediction in evolving disease networks

@&#HIGHLIGHTS@&#
A weighted disease network which indicates the relationships between diseases.A novel age-series based link prediction method for the disease network.A large number of correlations are hinted by the topology of a disease network.Medical histories of a set of similar patients are important for prediction.Good performance values for the case-based link prediction.

@&#KEYPHRASES@&#
Link prediction,Social networks,Proximity measures,Medical informatics,

@&#ABSTRACT@&#
Recently, several research efforts based on social network analysis and methods have been made for medical care information. One of these efforts is to extract the relationships between diseases by using social network modeling. However, all of previous works used the relationships in a simple way in a network consisting of diseases regardless of time or age factors. In this paper, we predict the onset of future diseases on the basis of the current health status of patients by considering age factor. The problem of predicting the relations between diseases is a really difficult and, at the same time, an important task. For this purpose, this paper first constructs a weighted disease network and then, it proposes a novel link prediction method, to identify the connections between diseases, building the evolving structure of the disease network with respect to patients’ ages. To the best of our knowledge, this is the first attempt in predicting the connections between diseases according to patients’ ages. Experiments on a real network demonstrate that the proposed approach can reveal disease correlations accurately and perform well at capturing future disease risks.

@&#INTRODUCTION@&#
Many complex systems, such as social, information, and biological systems, can be modeled as networks [1,2], where nodes represent individuals in the network, while links show the relations or interactions between the nodes [3]. Network is a useful tool in analyzing a wide range of complex systems. Social networks are social structures composed by entities and relationships among them. In this structure, new connections and entities appear or disappear overtime. This case makes them highly dynamic and complex systems. Analysis of social network includes broad field of research concerning method and strategies for the study of social networks [3]. Link prediction is an important task treated by social network analysis. This task is related to the problem of predicting the existence of a connection between two entities and the interactions already present in the network. Many efforts have been made to understand the structure, evolution, and function of networks [3–5]. In this meaning, link prediction tries to infer the likelihood of existence of a link between two nodes, which has important theoretical and practical value [6].In many real world problems, link prediction can be employed to expect future behavior or to identify plausible relationships that are difficult or expensive to observe directly [7–9]. One of these scenarios is related to medical care research area. Medical care area should become more proactive than reactive in identifying the beginning of disease and risk [10,11]. At present time, doctors generally utilize laboratory results to evaluate the patient’s stage of health. However, these evaluations are generally based on only a few medical parameters and are extremely dependent on a particular doctor’s experience, memory, and time. Hence, present medical care mostly steps in after a disease has emerged. Such an assessment does not treat disease at the earliest signs.As a remedy to the above mentioned problems, in this paper, we propose a predictor to determine the risk of individuals to develop disease, and to undertake the correct actions at the earliest signs of illness. To this purpose, we first construct a weighted disease network which indicates the relationships between diseases. In this network, nodes are the diseases and edges connect those pairs of diseases appearing in the same patient. Then, we propose an age-series based link prediction method, ASLIP, based on the evolution of the constructed disease network in order to identify the relations in between diseases. Differently from the traditional link prediction methods, in this paper, the disease network is split into several age-sliced snapshots. The more often the interaction of two diseases with each other in each age-sliced snapshot, the stronger is the connection between these diseases. Also, the larger the number of common neighbors between two diseases, the higher is their probability to be connected in the future. The disease prediction problem can thus be naturally formulated as a link prediction problem if objects are diseases and a predicted link (x,y) between two diseases x, y means that a patient affected by the illness x (y resp.) is likely to be effected also by disease y (x resp.) after a specified age interval. In other words, we see hidden relationships strengthening between diseases instead of extracting associations between very common sicknesses. The search for these missing links is performed by applying similarity-based algorithms (see Section 3) that assign a score to the pair (x,y) that measures the proximity between a and y. Finally, we test the proposed method on the disease network constructed with laboratory results of patients more than 210,000. The experimental results demonstrate the accuracy of our method on unsupervised prediction and encourage us for further analysis.The rest of the paper is organized as follows. Section 2 explains the construction of disease network. Section 3 briefly discusses the link prediction problem and gives some related work. Section 4 presents our age-series based link prediction method, proposing the evolving structure of disease network and the evolving cases in this network. The conducted experiments and the results achieved for the disease network are discussed in Section 5. Conclusions and future research directions are included in Section 6.In disease network, nodes are the disease and edges connect these pairs of diseases appearing in the same patient. Thus, a relationship between two nodes exists whenever they appear in even different times in the same patient. In this paper, we first construct an evolving disease network based on age-series. For this purpose, the network is split into several age-sliced snapshots, which represent states of the network at different age intervals. After that, age-series are built by grouping sequential snapshots. These series are at the same time called as frames. We then exploit the connections between diseases to build a prediction model. In this model, we propose the utilization of link prediction methods to generate the predictive model of illnesses.Fig. 1 shows a snippet of the disease network. The patient records contain an important view regarding the co-occurrences of illnesses affecting the same patient. In order to understand better the correlations among the diseases contained in our dataset, a disease network whose nodes are the diseases and a link between two nodes occurs every time those diseases are appeared in even different times in the same patient, i.e., when the couple of illnesses affects at least one patient, is built. The edges are labeled with the number of patients indicating both the illnesses.A classic definition of the link prediction problem is expressed by: “Given a snapshot of a social network at time t, we seek to accurately predict the edges that will be added to the network during the interval from time t to a given future time tı” [12]. So far, many approaches have been proposed in order to handle link prediction task. All of these methods are based on the measures indicating the proximity between nodes. These measures proposed in the literature are generally categorized into semantic or topological/structural measures [6]. In semantic measures, the content of the nodes is taken into account to evaluate proximity. For example, the similarity between topics discovered from titles can be used to predict future connections among the authors in a co-authorship network. As apart from the semantic ones, the topological measures consider the network structure to obtain the proximity values. Topological measures are more widely adopted because they are more general and do not require detailed information related to the content of node. Moreover, this content may not be present for every time at the social network considered. Topological measures are categorized into neighborhood-based or path-based measures [13]. The neighborhood-based measures consider the immediate neighbors of the nodes. According to this measure, if the neighbors of two nodes have a large overlap, they will probably form a link [6]. The most widely used measures among them are Common Neighbors [14], Preferential Attachment [14,15], Adamic–Adar Index [16] and Jaccard’s Coefficient [17]. The path-based measures generate a proximity value considering the paths between the related nodes. According to this idea, it is probable that two nodes will form a link if short paths are present in between the related nodes [18]. However, in order to predict new relations at future time, many of studies are established on the applications of proximity measures to non-connected pairs of nodes in the network at present time. Proximity measures showing the similarity between pairs of nodes can be utilized either by unsupervised [12,19,20], or supervised link prediction [21–23]. In unsupervised methods, a proximity measure is selected and utilized to rank node pairs in the network. The node pairs having good score are predicted to be linked. In the supervised approach, the link prediction problem is handled as a classification task and attributes of network are used as predictor attributes by a classification method. A classifier employs these attributes to implement a binary classification to find whether the link will be occurred or not in the future. In all of the above mentioned studies, the proximity values are calculated without considering the evolution of the network. In other words, the proximity measures are calculated using all network data up to the current network state without taking into account when links are created. Therefore, hidden and potentially valuable source of information is not adequately considered for link prediction.There are specific cases occurred between a pair of nodes in sequential time intervals. These cases deal with creation or removal of link between nodes. For instance, a new link can be formed between two nodes in the next interval, while they are not connected in a specific time interval. This situation represents the evolution of the related social network. Some studies, recently, have been done concerning the use of time intervals for link prediction. Tylenda et al. [24] proposed a network model in which link weight was showing the age of the most recent specific cases between the related nodes. Brigmann et al. [25] proposed a network with temporal information for discovering association rules explaining the network evolution. The other approaches proposed for link prediction handles the task as a time series forecasting problem [26–28]. For this purpose, time series were first built for each pair of nodes. Here, each series observation is the frequency of occurrence of links between the nodes during a specific interval [28]. All of the studies done in this area consider time concept as interval. For instance, by using time series based link prediction in co-author network the collaborations between authors after several time series can be predicted. In this paper, as apart from the previous works, we handle age concept for intervals in the series. Our aim is to investigate the prediction of new links in age series based network. Thus, if any, we can discover the relationships between diseases having common neighbors during age series. However, time series based network is not suitable for disease networks because we think that disease is not a parameter varying with respect to time like years or seasons. For instance, since out dataset includes all the patient records only for 2013 year, we cannot say: “a patient having illness x in winter is likely to be also effected by disease y, looking at the past three seasons”.In this section, the metrics with/without weights used for computing the similarity of two nodes are illustrated. For this purpose, some definitions and notation which will be useful to understand are first given. Let Γ(x) be the set of neighbors of node x in the social network and let |Γ(x)| be the number of neighbors (degree of node) of node x. In such a case, let w(x,y) be the link weight between nodes x and y. Many of the used approaches are based on the idea that two nodes x and y will have more chance to form a link in the future if their sets of neighbors Γ(x) and Γ(y) overlap, respectively. In other words, a link (x,y) is more likely to form if (x,z) and (z,y) already exist for some z in the network.Common neighbors (CN): According to this measure, two nodes are more likely to be connected if they share more common neighbors [14]. The following formula defines the CN measure without weight:(1)CN(x,y)=|Γ(x)∩Γ(y)|For the disease network having links with weight, the CN measure is extended as:(2)CN(x,y)=∑z∈Γ(x)∩Γ(y)w(x,z)+w(y,z)Jaccard’s coefficient (JC): The JC is a very common used similarly measure in data mining field [17]. It computes the probability that two nodes x and y share a feature f, where f is a randomly selected feature of either x and y. The following formula defines the JC measure:(3)JC(x,y)=|Γ(x)∩Γ(y)||Γ(x)∪Γ(y)|In the disease network, the JC is determined as:(4)JC(x,y)=∑z∈Γ(x)∩Γ(y)w(x,z)+w(y,z)∑a∈Γ(x)w(a,x)+∑b∈Γ(y)w(b,y)Preferential attachment (PA): The PA metric indicates that new links will be more likely to connect nodes having larger number of neighbors. It is determined as:(5)PA(x,y)=|Γ(x)|.|Γ(y)|In the constructed network, the PA mentions that the probability that a new link is created from a node x is proportional to the total weight of the node y. In other words, the PA measure can be defined as:(6)PA(x,y)=∑a∈Γ(x)w(a,x)⁎∑b∈Γ(x)w(b,y)Adamic–Adar coefficient (AA): The AA refines the simple counting of common neighbors by assigning to rarer features a more heavy weight [16]. The following formula defines the AA measure without weight:(7)AA(x,y)=∑z∈Γ(x)∩Γ(y)1log(|Γ(z)|)In our network, the AA is computed as:(8)AA(x,y)=∑z∈Γ(x)∩Γ(y)w(x,z)+w(y,z)log(1+∑c∈Γ(z)w(z,c))Resource allocation index (RA): According to this proximity measure by taking inspiration from a real physical process, x send some resource to y while their common neighbors act as transmitters. In the simplest case, x has a unit of resource and can send part of it to y by averagely distributing the amount to all its neighbors [29]. The greater the amount of resources y receives from x, the more likely a link between x and y will form. RA is defined as:(9)RA(x,y)=∑z∈Γ(x)∩Γ(y)1|Γ(z)|In the weighted network, the RA is calculated as:(10)RA(x,y)=∑z∈Γ(x)∩Γ(y)w(x,z)+w(y,z)∑c∈Γ(z)w(z,c)Social networks are dynamic structures. These structures evolve over time either by addition of new nodes or by new links shaping between nodes. Therefore, the evolution of these networks brings to mind the question what the future connections will be. In the present work, we propose a novel link prediction method based on unsupervised strategy that considers the evolving structure of a weighted network, such as disease network, and evolving cases concerning pairs of nodes in the network. The goal of the paper is to merge Homans’ idea [30] that the strength of a connection between two nodes is proportional with how often they interact with one another and Newman’s method [31] that the larger the number of common neighbors between two nodes, the higher is their probability to be connected in the future [28]. Since the weighted network is used in this paper, we modified Newman’s method in the form of “the larger the total weights of common neighbors between two nodes, the higher is their probability to be connected in the future”.The proposed method will strengthen or weaken the proximity score between two nodes with respect to the evolving cases occurred among the two nodes and their neighborhood. As network evolves, the increment or decrement of weights of links at a specific rate is defined as an evolving case which will be explained in more detail in the next section. In the proposed study, an evolving structure is first constructed by extracting sequential frames of the networks at the different age intervals. Then, the predictor attributes are described for each candidate pair of nodes by proximity scores determined with the evolving cases occurred during the transitions of frames.The evolving structure represents states of the network according to different age intervals of the patients in the disease network. For this purpose, in this paper, we built age-series or the frames by grouping several age-sliced sequential snapshots. For instance, the frame(Fi)at [20–25] age interval is a sub-graph containing all links observed among diseases of all people in between 20 and 25 years old. An example of evolving structure and prediction frame of the disease network is given inFig. 2.It should be noted that the size of each frame is the same as the length of the prediction window, which is pre-specified in the link prediction problems.An evolving case is generally the action that conducts a pair of nodes from a state (linked or unlinked) to another. An evolving case is defined as the increment or decrement of weight of a link between two nodes from a frame to its subsequent in a weighted network as disease network. These cases can be categorized into one of three different types; consistent, strengthening and weakening.A consistent case in the disease network occurs when the weight of the relation between two nodes does not increase more than a case changing rate pre-determined or does not decrease less than this rate while the network evolves. In other words, while two diseases have a link in a frame, the strength of this connection is kept in the subsequent one. In such a case, in order to consider a consistent case during the transition from the (k−1)th to the kth frame,Ck(x,y)score for each pair of nodes(x,y)is defined as follows:(11)Ck(x,y)={cifwk−1(x,y)−r.wk−1(x,y)<wk(x,y)<wk−1(x,y)+r.wk−1(x,y)0otherwisewherewk−1(x,y)andwk(x,y)are the weights of connection between x and y nodes in framesFk−1andFk, respectively. r(0<r≤1)is the case changing rate pre-determined, the cases between frames changes with respect to this rate. The constant c(0<c≤1)indicates the positive score for consistent cases since the strength of a connection between two nodes is kept.Strengthening cases occur when the weight of link between two nodes on different frames is increased more than the case changing rate pre-determined. In other words, they happen when the weight of two nodes in a frame increases more than the case changing rate in the next frame. The strengthening caseSk(x,y)score associated to a pair(x,y)and a frameFkis computed as follows:(12)Sk(x,y)={sifwk(x,y)>wk−1(x,y)+r.wk−1(x,y)0otherwisewhere s(0<s≤1)indicates a reward for the strengthening cases, this value should be positive since the connection between two nodes is strengthened.Weakening case is opposite to the strengthening one. In the kind of this case, the strength of existing link between two nodes decreases from a frame to its subsequent. The weakening case scoreDk(x,y)is computed as follows:(13)Dk(x,y)={difwk(x,y)<wk−1(x,y)−r.wk−1(x,y)0otherwisewhere d(−1≤d<0)is a decrement value and should be negative since the strength of the connection between the nodes decreases.The values c, s, d which are given for the consistent, strengthening and weakening cases, respectively, are estimated by evaluating the link prediction performance on a validation set. The validation set is the last frame before the prediction frame.Many methods for link prediction calculate scores to pairs of nodes by employing a chosen proximity measure. Thus, it is determined how similar those nodes are and, therefore, how probably a connection between them will be formed in a near future.In this paper, we have combined the scores associated to primary cases, which are the evolving cases directly related to pairs of nodes under consideration, with the scores associated to secondary cases, which are the evolving cases observed in the nodes’ neighborhood.Finally, the age-series score concerning a given pair of nodes(x,y)is determined as;(14)Score(x,y)=∑k=2nP(x,y,k)+∝S(x,y,k)(15)P(x,y,k)=Ck(x,y)+Sk(x,y)+Dk(x,y)(16)S(x,y,k)=∑z∈(x)∩Γ(y)P(x,z,k)+P(z,y,k)P(x,y,k)computes the score of the case for the pair of nodes(x,y)observed in the transition from the frame k−1 to the frame k. The case observed at this moment may be one of three evolving cases; consistent, strengthening or weakening.S(x,y,k)gives the aggregated score of secondary cases concerning to the pair(x,y). Here,(x)is the set of neighbors of the node x in the constructed network. The parameter α is a control factor that shows how strong secondary cases affect the tie between x and y.In our experiment, the proposed measures were compared with commonly used measures in the literature for link prediction. We will use the proximity scores in the weighted networks since the edges are labeled with the number of patients having diseases in this paper. For this purpose, five proximity scores modified for weighted networks were considered; Common Neighbors (CN) [14], Jaccard’s Coefficient (JC) [7], Preferential Attachment (PA) [15], Adamic–Adar Coefficient (AA) [16] and Resource Allocation Index (RA) [29].The steps of the proposed method, ASLIP, are as follows:1.The non-connected pairs or pairs having a weight less than pre-specified threshold are chosen from the validation set. However, the non-connected pairs that were directly or indirectly not affected by some case during the network evolution were eliminated.The proximity scores of these pairs chosen are computed with respect to six different predictors (CN, JC, PA, AA, RA and ASLIP).The top 1000-pair having the highest proximity values are determined for testing. The top ranked pairs are considered as the future links that are more likely to appear.If a non-connected pair in the validation set converts a connected pair in the prediction frame or the weight of a pair having a weight less than predefined threshold increases more than the case changing rate from the validation set to the prediction frame, the pair of nodes is assumed as positive and assumed as negative otherwise.The performance measures of all the predictors considered are determined.

@&#CONCLUSIONS@&#
In this paper, we contributed to the ongoing research by proposing an age-series based link prediction method, ASLIP, for finding the most appropriate connections between diseases. Our work focuses on unsupervised machine learning strategy for link prediction. The paper includes four contributions. First, we proposed a novel weighted disease network where nodes are the diseases and edges connect these pairs of diseases appearing in even different times in the same patient. Next, we propose an efficient link prediction method for weighted social networks, such as disease network. In this method, the evolving structure of disease network was considered with respect to patients’ ages. Third, for this purpose, the evolving cases were defined. Finally, our case-based link prediction score outperforms all the methods compared in this paper in terms of prediction, recall and F-measure.The experiments conducted on real data sets illustrate that the proposed approach produces meaningful results and has reasonable efficiency. The results at the frames with different age interval are consistent and hence encouraging. Our link prediction method can be also directly applied to other diverse types of weighted social networks, or it can be extended to address problems not yet considered.The network proposed in this paper is a unipartite network. However, many social networks are bipartite networks, such as the author-topic networks in reviewer finding area. So far, most of the link prediction problems have usually been explained on unipartite graphs. But, when a unipartite link prediction method applies to bipartite graphs, it is seen that the results are not encouraging. In the future, we will revise our case-based score to make this score more realistic, improve our algorithm such that one could have better performance in bipartite networks having disease and symptom nodes.Authors do not have conflict of interest to declare.