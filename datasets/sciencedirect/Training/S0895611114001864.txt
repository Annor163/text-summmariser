@&#MAIN-TITLE@&#
Bilateral filter regularized accelerated Demons for improved discontinuity preserving registration

@&#HIGHLIGHTS@&#
Replacement the Gaussian filter with a bilateral filter were proposed.Image registration approach that better handles the discontinuities proposed.Approach was tested and compared on 2D liver and 3D lung images.Higher computational cost for the method is caused by the complex computation.

@&#KEYPHRASES@&#
Image-guided therapy,Medical image registration,Discontinuities,Demons method,Bilateral filter,

@&#ABSTRACT@&#
The classical accelerated Demons algorithm uses Gaussian smoothing to penalize oscillatory motion in the displacement fields during registration. This well known method uses the L2 norm for regularization. Whereas the L2 norm is known for producing well behaving smooth deformation fields it cannot properly deal with discontinuities often seen in the deformation field as the regularizer cannot differentiate between discontinuities and smooth part of motion field.In this paper we propose replacement the Gaussian filter of the accelerated Demons with a bilateral filter. In contrast the bilateral filter not only uses information from displacement field but also from the image intensities. In this way we can smooth the motion field depending on image content as opposed to the classical Gaussian filtering. By proper adjustment of two tunable parameters one can obtain more realistic deformations in a case of discontinuity. The proposed approach was tested on 2D and 3D datasets and showed significant improvements in the Target Registration Error (TRE) for the well known POPI dataset.Despite the increased computational complexity, the improved registration result is justified in particular abdominal data sets where discontinuities often appear due to sliding organ motion.

@&#INTRODUCTION@&#
In medical image processing, a lot of research has and still is devoted to image registration [1].11This work has been supported by the SCOPES project of the Swiss National Science Foundation (http://www.snf.ch)The non-rigid image registration methods play an important role in today's modern medical diagnostics and Image-Guided Therapy (IGT) systems. Medical image registration seeks geometrical transformations which map one of the images into the spatial domain of the other image. In general, image registration is not restricted to the same modality but can also handle multi-modal image pairs.During the last decade, imaging techniques capable of acquiring four-dimensional (4D) organ motion (3D+time), for example 4D MRI [3] became available. With the introduction of these imaging principles also the need for image registration approaches able to handle the discontinuities in the motion field, e.g., due organs sliding along the chest wall, grew [9].Discontinuities preserving regularization methods can be based on local and global support, or with or without prior segmentation of region of interest. In Ruan et al. [5] the authors propose a regularization energy that encodes a discriminative treatment of different types of motion discontinuities, by using Helmholtz-Hodge decomposition. Heinrich et al. [6] presented a framework using a variational formulation of the optical flow model for 3D medical image registration, using robust discontinuity preserving non-quadratic regularization. This allows globally smooth deformations with local discontinuities, such as seen in sliding motion of the abdominal organs during respiration.Applying discontinuities preserving regularization across the entire volume domain, i.e., globally, does not distinguish between different structures producing unrealistic motion fields.On the other hand, in Staring et al. [2] the locally adapted, tissue-dependent filtering technique were developed. The degree of filtering is related to tissue stiffness. The tissue-dependent filter is incorporated in registration algorithm which uses mutual information as a similarity measure and cubic B-splines to model the deformation field.In Werner et al. [10] authors apply Thirions Demons registration with masked and unmasked force calculation, and the most accurate approach is then applied to local lung motion analysis. Ding et al. [11] proposed a method to evaluate the sliding motion of the lobar surfaces during respiration using lobe-by-lobe mass-preserving non-rigid image registration. They, however, segmented the lobes during preprocessing in the three parts. In Schmidt-Richberg et al. [7] a diffusion-based model for incorporating physiological knowledge in image registration is presented. They estimate slipping motion at the organ borders by decoupling normal- and tangential- directed smoothing for the estimation of respiratory lung motion. A different approach based on anisotropic diffusion to accommodate the deformation field discontinuities seen during sliding motion is shown in Pace et al. [8]. In [4] for example Kiriyanthan et al. proposed a unified variational approach that simultaneously segments and registers the images.With the state-of-the-art registration methods this problem can only be handled when manual segmentations of the different tissues are provided. This, however, implies significant manual work. On the other side, the assumption about the type of the tissues, or decomposition to basic components that are regularized separately, sliding motion detection are some of the disadvantage of the state-of-the art implementations. In contrast we propose in this paper an automatic bilateral filter based Demons registration approach that can handle discontinuous motion fields intuitively.Our contribution is mainly inspired by the work proposed in [2] and also Manduchi et al. [18] and Xiao et al. [14]. The proposed regularization of deformation fields is a spatially adaptive, and it is able to produce more realistic deformations. Proposed regularization use two controllable parameters for detection local changes: spatial and intensity smoothness. Proposed method does not need prior information. The quantitative analysis shows improved Target Registration Error (TRE) when compared to original Gaussian smoothing.

@&#CONCLUSIONS@&#
