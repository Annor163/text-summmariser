@&#MAIN-TITLE@&#
Optimal switching decisions under stochastic volatility with fast mean reversion

@&#HIGHLIGHTS@&#
Study optimal switching problems under “fast” mean-reverting stochastic volatility.Derive closed-form approximations of the full problem via homogenization theory.Apply our general solution to well-known switching problems and volatility models.Proposed method is of interest to applied problems involving switching flexibility.

@&#KEYPHRASES@&#
Optimal switching problems,Multi-scale stochastic volatility,Quasi-variational inequalities,Hysteresis,

@&#ABSTRACT@&#
We study infinite-horizon, optimal switching problems for underlying processes that exhibiting “fast” mean-reverting stochastic volatility. We obtain closed-form analytic approximations of the solution for the resulting quasi-variational inequalities, that provide quantitative and qualitative results for the effects of multi-scale variability of the underlying process on the optimal switching rule. The proposed methodology is applicable to a number of operations research problems involving switching flexibility.

@&#INTRODUCTION@&#
An important class of problems arising in operations research are the so-called optimal switching problems, in which the objective is to find the optimal time to initiate or terminate a process, subject to uncertainty. This general formulation finds numerous applications in manufacturing and logistics (e.g. Benaroch, Webster, & Kazaz, 2012), networked systems, optimal control of energy systems (see for example Parpas and Webster, 2014; Ho and Parpas, 2014, and references therein), decision support (e.g. technology choice in Bobtcheff & Villeneuve, 2010), production management and capacity choice (see, e.g. Dixit, 1989; Trigeorgis, 1993; Pindyck, 1988; McDonald & Siegel, 1985), but also in fields such as natural resource management (see, e.g. Brennan & Schwartz, 1985; Paddock, Siegel, & Smith, 1988), transportation and shipping, etc. (Kavussanos, Tsekrekos, & Cullinane, 2011; Sødal, Koekebakker, & Aadland, 2008).A key issue in all the above problems is the determination of the stochastic model that can represent the random evolution of the process in question, hereafter called the underlying. Depending on the particular concrete application in mind, the underlying can be interpreted in different ways, for instance a product price in manufacturing, an input price like the price of electricity in energy systems, a commodity price in natural resource management, etc.A useful class of models for the evolution of the underlying is the family of Itô processes, which lead to convenient formulations of switching problems in terms of elliptic or parabolic quasi-variational inequalities (see for example Bensoussan & Lions, 1984; Brekke & Øksendal, 1994), the solution of which provides useful insights on the optimal switching decision rule. Most of these models adopt the assumption of constant volatility for the underlying process, mainly for analytical and numerical convenience. However, there is ample empirical evidence that often the underlying displays stochastic volatility effects, which may develop on different time scales (Eydeland & Wolyniec, 2003; Hikspoor & Jaimungal, 2008). In particular, one characteristic feature of volatility is that its mean-reversion rate is quite “fast”, as compared to the time scale of evolution of the other state variables, a feature referred to as fast mean-reverting stochastic volatility. This has also been documented for the volatility of financial asset prices (Alizadeh, Brandt, & Diebold, 2002; Fouque, Papanicolaou, Sircar, & Sølna, 2003a, 2003b; Hillebrand, Fomby, & Terrell, 2006), and stochastic volatility has played a prominent role in the valuation and hedging of financial derivatives, explaining many stylized facts of such markets. A comprehensive review related to stochastic volatility in financial markets is Taylor (1994), and a multi-scale approach to the problem of hedging and pricing financial derivatives has been developed in Fouque, Papanicolaou, Sircar, and Sølna (2011), leading to increased recent activity in this field (see for example Souza & Zubelli, 2011; Zhu & Chen, 2011a; 2011b; Chen & Zhu, 2012).Despite the fact that asset and commodity prices have been documented to exhibit fast mean-reverting volatility, the study of its effects on optimal switching policies has been overlooked. It is the aim of this paper to examine optimal switching decisions under multi-scale stochastic volatility, and assess its quantitative and qualitative effects.To accomplish this, we formulate and solve infinite-horizon, optimal switching problems driven by a general class of stochastic volatility models that exhibit fast mean-reversion. We employ the perturbation method of Fouque, Papanicolaou, and Sircar (2000) on the resulting quasi-variational inequalities, a fact that allows us to approximate the full problem with a sequence of simplified and manageable problems, each one offering a “correction” of different order to the decision rule corresponding to the constant-volatility model. These corrections, that are the effect of fast stochastic volatility, are derived in closed-form, allowing one to analytically approximate the solution of the general switching problem up to any desired order. Our analytic approach is important as it lends itself easily to comparative statics that are of value to decision-makers dealing with processes or projects that can be switched from and to an idle/active mode, contingent on state variables that exhibit random evolution on multiple scales. Moreover, as the full multi-scale optimal switching problem is difficult and tricky to handle by numerical methods, our analytic results offer useful benchmarks for the numerical analysis of the full problem. Our general results are illustrated in terms of the extension of the switching problem in Dixit (1989), for multi-scale volatility.The rest of the paper is organized as follows: Section 2 starts by presenting a general optimal switching problem under fast mean-reverting stochastic volatility, and proceeds by providing a general perturbative framework for the analytic approximation of the solution to any desired order. In Section Section 3 we illustrate the method for the multi-scale volatility extension of the switching problem in Dixit (1989) and provide comments on the qualitative and quantitative effects of multi-scale volatility on the optimal policy. Finally, Section 4 concludes the paper.Consider a risk-neutral decision maker contemplating a project/process that can operate in two modes (active or idle) and which, depending on the mode, produces a stochastic flow payoff Rq(P) (q=0is idle,q=1active), where P is a commodity or product price (underlying) that can be modeled by a diffusion process. Transition from one mode to the other can take place instantaneously and for an unlimited number of times, but at constant fixed costs, each time a transition decision is made.11The assumption of risk-neutrality is not crucial for the solution and it is made only for simplicity. The extension to a risk-averse process/project owner is straightforward and we make it available upon request from the authors. Equally non-crucial is the assumption of instantaneous transition from one mode of operation to the other. Switches between modes that take time to implement could be easily be accommodated, only at the cost of extra notation.The problem we consider here, is that of finding the optimal switching decision rule, for a wide class of diffusion models for the price process, exhibiting dynamics on fast/slow time scales, and in particular providing semi-analytic approximations for the decision rule. This framework allows one to avoid the need for numerical treatment and provides important qualitative and quantitative information on the effect of different volatility dynamics on the optimal switching decision.Our generic model for the underlying P of the project belongs to a general class of latent-factor stochastic volatility models and is given by the Itô process(1)dPt=μPtdt+f(Yt)PtdW1,t,P0=p(2)dYt=δ−2(m−Yt)dt+ν2δ(ρdW1,t+1−ρ2dW2,t),Y0=y,where Ytis a latent stochastic factor that drives the volatility through a general feedback term described by a smooth functionf:I⊂R→R,(I compact). It is important to note that f need not be specified at this point. In the above, (W1, t, W2, t)′ is a standard, two-dimensional Wiener process on a complete filtered probability space satisfying the usual conditions (Karatzas & Shreve, 1991), with |ρ| < 1 a constant correlation coefficient.The small parameter δ plays an important role in our analysis and models the fact that the latent factor Y follows a mean-reverting process, whose dynamics are on a “faster” time scale than the dynamics of P. Note that the introduction of the latent factor Y and of the different time scales make the dynamics of P more realistic, (as suggested by the empirical evidence in Alizadeh et al., 2002; Fouque, Papanicolaou, Sircar, and Sølna, 2003b; Hillebrand et al., 2006; Hikspoor and Jaimungal, 2008, among others), but at the cost of not being able to obtain, unless f is very specific, a closed-form solution for P. Furthermore, the difference in the time scales creates problems in the numerical resolution of (1) and (2), which is of the form of a stiff stochastic differential equation.The decisions to switch from one mode of operation to the other can be modeled by an adapted, finite variation, càglàd process Q taking values in {0, 1}, withQt=0or 1 if at time t, the process is idle or active, respectively. Let q denote the mode of operation att=0.Let K0, K1 denote the fixed costs of leaving the idle or the active mode respectively. For any switching decision ruleQ={Qt}t≥0and initial state (q, p, y), the present value of the project is(3)J(q,p,y)(Q)=E[∫0∞e−rs[R1(Ps)Qs+R0(Ps)(1−Qs)]ds−∑s≥0e−rs[K0(ΔQs)++K1(ΔQs)−]],where r is the (constant) risk-free rate of interest and by (x)± we denote the positive/negative part of x. The flow functions Rqare assumed to be concave and of the formRq(p)=aqp+bq+Rq(p)where functionsRqsatisfy the conditionlimp→0R0(p)p=limp→+∞R1(p)p=0.The objective is to maximize (3) over all possible switching rules Q and obtain the value function,(4)Vqδ(p,y):=supQJ(q,p,y)(Q),where the superscript δ is used to emphasize the dependence of the value function on the small parameter δ.The above general model provides a convenient and flexible framework for the treatment of a wide class of switching problems encountered in the operations research and management science literature. Just to provide a few indicative examples, in the context of supply-chain contracts, several papers (e.g. Wagner & Friedl, 2007; Löffler, Pfeiffer, & Schneider, 2012) analyze supplier-switching options, that allow firms to switch suppliers and/or flexibly adjust their order quantity over time in the face of uncertainty in the underlying state process (e.g. the exchange rate in Kamrad & Siddique, 2004). In manufacturing (Kazaz, Dada, & Moskowitz, 2005; Kogut & Kulatilaka, 1994), as well as in service processes (Ellram, Tate, & Billington, 2008), optimal switching between in-sourcing and out-sourcing for cost reduction purposes and for achieving better cost management has attracted increased research attention in recent years (see, for example Li and Wang, 2010; Benaroch et al., 2012, and references therein). A wide range of applications, from municipal waste management (Di Corato & Montinari, 2014), to the valuation of flex fuel car engines (Bastian-Pinto, Brand ao, & de Lemos Alves, 2010), to the optimal choice between short-lived and long-lived projects in the face of interest rate uncertainty (as in Dias & Shackleton, 2011), are treated as optimal switching problems in the literature.Such switching problems, for constant volatility and in the absence of multiple time scales, have been treated in the real options and operational research literature before (see Duckworth and Zervos, 2001; Dixit, 1989, among others). Here, unlike the constant volatility case of e.g. Merton (1973) where the price levels that “trigger” optimal switching are constants, we find that they are strongly affected by the volatility dynamics, and the proposed approach that follows, allows one to provide exact quantitative estimates of this effect to any desired order.Using standard results on impulse control theory (see e.g. Bensoussan & Lions, 1984; Duckworth & Zervos, 2001), it can be shown that the value functionsVqδsatisfy the quasi-variational inequality(5)max{LδVqδ(p,y)+Rq(p),V1−qδ(p,y)−Vqδ(p,y)−Kq}=0,q∈{0,1},where the operatorLδis the generator of the process (P, Y), defined byLδ=δ−2L0+δ−1L1+L2withL0=(m−y)∂∂y+ν2∂2∂y2L1=2νρf(y)p∂2∂p∂yL2=12f2(y)p2∂2∂p2+μp∂∂p−rI,and I is the identity operator.The variational inequality in (5) is a free-boundary value problem, the solution of which can be characterized in terms of two thresholdsP0δ(y)>P1δ(y)(to be specified). The optimal switching times are defined in terms of the following stopping rule: for times t such thatPt≥P0δ(y)the process should be turned (or remain) active, whereas for times t such thatPt≤P1δ(y)the process should be turned (or remain) idle. The appearance of y, the initial state of the latent factor, is not alarming as it can expressed in terms of the instantaneous volatility. The variational inequality (5) cannot be solved analytically and, as a result of the different time scales, its numerical treatment can be very difficult. However, the singular nature of the problem allows the use of a perturbative approach, similar to averaging or homogenization theory, which can produce semi-analytic results for the switching levelsP0δ(y),P1δ(y). One of the main contributions of this paper is to provide a step-by-step procedure that allows the approximation, in terms of an asymptotic expansion and at any desired order, of the switching thresholds. Note that the approximation is derived for any possible feedback function f(y), a fact that allows—if desired—easy comparison between various models and provides qualitative and quantitative intuition on the effect of various parameters and processes, yielding useful implications for the decision-maker. The analytic approximation provided here may also be of use for the testing or calibration of numerical algorithms for solving the quasi-variational inequality (5).As P goes to zero (infinity) we should be in the idle (active) mode and by the form of Rq(p), it can be shown thatV0δ(p)=a0pr−μ+b0rfor small p andV1δ(p)=a1pr−μ+b1rfor large p. These can be identified as the expected present value of receiving the flow Rq(p) perpetually.The variational inequality (5) admits a solution of the form(6)Vqδ(p,y)=∑n=0∞δnVq,n(p,y),andPqδ(y)=∑n=0∞δnPq,n(y),where Vq, nand Pq, nare provided by the following propositions.Proposition 1Forn=0,the value functions Vq, 0only depend on p, and in particularVq,0(p,y)=Vq,0(p)is the solution of the “averaged” equation(7)L2¯Vq,0:=12f¯2p2∂2Vq,0∂p2+μp∂Vq,0∂p−rVq0=−Rq,subject to(8)limp→0V0,0(p)=b0randlimp→+∞V1,0(p)=sgn(a1)∞,wheref¯2=⌈f2(y)⌉:=∫−∞+∞f2(y)12πνe−(m−y)22ν2dy.The zeroth-order free boundary, Pq, 0is independent of y and is provided by the solution of the algebraic system of four equations(9)V1−q,0(Pq,0)−Vq,0(Pq,0)=Kq(10)∂∂p[V1−q,0(p)−Vq,0(p)]|p=Pq,0=0where Vq, 0is the solution of(7)subject to(8).See Appendix A.□For n ≥ 1, the general form for Vq, nis(11)Vq,n(p,y)=∑i=1ℓ(n)Pq,n,i(p)Yq,n,i(y)+Vq,n(p),where the number of cross-product terms ℓ(n) is determined by the sequenceℓ(n)=ℓ(n−1)+2ℓ(n−2)+1,withℓ(0)=ℓ(1)=0,meaning thatVq,1=Vq,n(p)only depends on p. The exact form ofPq,n,i(p)andYq,n,i(y)are given inEqs. (B.6)–(B.9)inAppendix B, andVq,n(p)satisfy “averaged” equations of the formL2¯Vq,n(p)=Rq,n(p),with vanishing boundary conditions, and where the exact form of the source termRq,n(p)is provided inEq. (B.4)inAppendix B. The “corrections” to the free boundaries Pq, nsatisfy linear algebraic systems depending only on Vq, m, m < n (and whose exact form is provided inAppendix B). In particular, the first-order “corrections” to the free-boundary are given by(12)Pq,1=Vq,1(Pq,0)−V1−q,1(Pq,0)∂∂p[V1−q,0(p)−Vq,0(p)]|p=Pq,0,q∈{0,1}.See Appendix B.□Note that the operatorL2¯is the generator for Eq. (1) with a constant (independent of y) volatility, often referred to as the Black–Scholes–Merton operator, equal tof¯,which in fact is the average of the volatility weighted by the invariant distribution of the latent variable dynamics.We can also consider further extensions of model (1)–(4) for switching decisions, where the payoffs in each mode display path-dependence or other exotic-type features. As an example of path-dependence, one may consider an Asian-type switching option, where the payoff in the active mode depends on the running average of P. Such a problem can be brought into the general form (1)–(4) by defining the new variableXt=∫0tPsds,and considering the extended model for the Itô process (Pt, Xt, Yt). The payoff in (4) would depend on Xt, and now the extended model for the underlying would comprise of a two-dimensional “slow” part, (Pt, Xt), and an one-dimensional “fast” part Yt. The variational inequality derivation proceeds in a similar fashion as for the original model, where now of courseL1andL2will depend on three variables (Pt, Xt, Yt). The analysis proceeds in a similar fashion, the invariant density for Ytbeing unaffected, at the cost of more complicated expressions when the Fredholm alternative is invoked on account of the higher dimensionality of operatorsL1andL2. While in principle such extensions are possible, path-dependence may lead to quantitative changes in Propositions 1 and 2 and the resulting optimal switching policy; however the detailed treatment of this problem is clearly beyond the scope of the present paper.In this section, in order to illustrate the general results of Section 2, we extend the standard, benchmark entry/exit problem treated in Dixit (1989), to include the effect of “fast” mean-reverting stochastic volatility. At this point, we take a general form for the volatility feedback function f(y), but we set, as in Dixit (1989),(13)Rq(Pt)={Pt−cforq=10forq=0with c a constant flow cost. Define the quantities(14)α,β=−μ+12f¯2±2f¯2r+(μ−12f¯2)2f¯2,(15)γ=2νρf¯2(α−β),ddyΩ(y)=−f(y)(16)Γ=12ν2∫−∞+∞Ω(y)(f¯2−f2(y))12πνe−(m−y)22ν2dy.Furthermore, let A, B, P0, 0, P1, 0 be the solution of the system of the following four (q={0,1}) algebraic equations(17)APq,0α+(−1)qKq=BPq,0β+Pq,0r−μ−cr(18)AαPq,0α−1=BβPq,0β−1+1r−μ,and define the constants(19)D0=Aα2(α−1),D1=Bβ2(β−1),Eq=D0Pq,0α+D1Pq,0βCq=E0P1,0(1−q)β+qαlnP0,0−E1P0,0(1−q)β+qαlnP1,0(P0,0βP1,0α−P0,0αP1,0β).Using the procedure of the previous section, the following proposition can be established:Proposition 3Up to first order, the value function for the Dixit problem under the dynamics in(1)and(2), isVqδ(p)=Vq,0(p)+δVq,1(p),q ∈ {0, 1}, where(20)Vq,0(p)=(1−q)Apα+q(Bpβ+pr−μ−cr),(21)Vq,1(p)=γΓ[(1−q)pα+qpβ][(−1)qDqlnp+Cq].The switching thresholds are given byPqδ(y)=Pq,0+δPq,1,q ∈ {0, 1}, where(22)Pq,1=αβγΓ{(D0Pq,0α+1+D1Pq,0β+1)[αD1Pq,0β−βD0Pq,0α]+Pq,0α+β+1(D0P1−q,0α+D1P1−q,0β)(α−β)lnP1,0P0,0(P0,0αP1,0β−P0,0βP1,0α)[αD1Pq,0β−βD0Pq,0α]}See Appendix C.□Proposition 3 provides the general solution, up to first order, of the problem treated in Dixit (1989) for a general multi-scale, stochastic volatility model. Note that any choice of a specific stochastic volatility model, i.e. any specific choice of f, affects the solution through the constantsf¯2and Γ, which are both easily calculated, either analytically if f is provided in a convenient closed-form, or by elementary quadrature methods for numerical integration if f does not have a convenient analytic form, or is inferred numerically from calibration of the model on empirical data via non-parametric techniques.We provide a brief discussion concerning the possible specification of the function f, before turning to the treatment of specific, fully-worked examples. Naturally, f should be chosen in such a way that the model is well-posed, but typically, a Lipchitz continuity condition is sufficient for that.(a)An interesting class of choices for f would be to choose it in analytic forms such asf(y)=exp(y)orf(y)=y. Such choices lead to well-established models in the literature (Heston, 1993; Hull & White, 1987), and are usually treated as benchmark cases for quantitative and qualitative studies.Another choice would be to select f so that the full model belongs to the affine class. Such a choice would be advantageous if European-type or Asian-type options were studied, since in this case the option valuation problem would be reduced to a convenient Riccati differential equation, which nevertheless must be treated numerically; however, it is not clear whether such a reduction simplifies the American-type problem considered here. At any rate, the proposed general scheme of Propositions 1–3 can be fully implemented for such cases.A third important class of models would be to choose f as a linear combination,f(y)=∑i=1NλiPi(y)of a family of orthogonal polynomials{Pi}on I (e.g. Chebyshev or Hermite polynomials), where λiare appropriate expansion weights. Such expansions can be very convenient when used in conjunction with non-parametric schemes for the inference of the model from real data. As noted above, the optimal switching strategy is only affected through constantsf¯and Γ which can be readily calculated once the coefficients λiare specified by standard numerical integration techniques involving the basis{Pi}. In particular,f¯2is expressed asf¯2=∑i=1N∑j=1NλiλiMij,where the matrix {Mij} is defined byMij=∫−∞+∞Pi(y)Pj(y)12πνe−(m−y)22ν2dy.In what follows, for the sake of brevity we only illustrate the results of Proposition 3 for the two analytic specifications in case (a) above, which correspond to well-established models in the literature. It should be stressed that the intention of the specific stochastic volatility models that appear in the following examples, is simply to demonstrate the ability of the perturbation method in Fouque et al. (2003a) to “correct” the well-known solution of the general optimal switching problem under constant volatility. The application of the results of Proposition 3 for the specifications in (b) and (c) above are straightforward and areleft to the interested reader.As a first example, we choose the stochastic volatility model employed by Fouque et al. (2003c), where the product price change volatility is related to the latent “fast” mean-reverting factor y viaf(y)=exp(y). This stochastic volatility model has been used in the pricing of American-style perpetual options by Zhu and Chen (2011a).In order to apply Proposition 3, one has to calculate the constantsf¯2and Γ. For this model,Ω(y)=−f(y),and straightforward calculations involving Gaussian integrals yieldf¯2=e2(m+ν2)andΓ=e5ν+3m(1−e2ν2)2ν2.To investigate the effects of “fast” mean-reverting stochastic volatility, define forq={0,1}the value function and the optimal switching threshold differences between the present model (denoted by FPSS) and the original, constant volatility, Dixit model (denoted D), calibrated such that the constant volatility is set equal tof¯,i.e.(23)VqFPSS(P,y)−VqD(P)≈δVq,1(P)andPqFPSS(y)−PqD≈δPq,1(y),where the right-hand sides of the above are obtained by equations (21) and (22). For brevity, only the differences at the first-order of δ are considered.The effect (of the first order corrections) due to “fast” mean reverting stochastic volatility is quantitatively assessed in Figs. 1 and 2. Since the results are obtained analytically, detailed comparative statics are feasible and available upon request. Note that value differences due to “fast” mean-reverting stochastic volatility are not monotone with respect to the resource price P and can change sign (see Fig. 1).Fig. 2 focuses on the behavior of the optimal switching price thresholds with respect to the switching costs Kq, the correlation coefficient ρ, as well as the parameters of the latent part of the stochastic volatility model. Whether the effect on the thresholds is positive or negative depends on the correlation coefficient. For ρ < 0 which is the most usual case in financial variables (see for example Fouque et al., 2000), the owner of the process/project that can be switched from and to an idle/active mode will optimally decide to leave the current mode at lower thresholds: Lower levels of P (than those in the constant volatility case with volatility set tof¯) now lead to project activation, and the owner is now willing to incur more losses before activation is suspended on the down side. This effect can be significant in magnitude, as shown in Panel (b) of Fig. 2, where as ρ → ±1 the “corrections”δPq1can be in excess of ± 20 percent of the constant-volatility benchmarksPqD.We provide an additional example of the approach by employing a correlated version of the stochastic volatility model in Renault and Touzi (1996), which is based on the model by Hull and White (1987). In these models the volatility of the underlying is related to the latent “fast” mean-reverting factor y viaf(y)=y. It can be shown that for this specific stochastic volatility model,Ω(y)=−23y3/2,f¯2=mandΓ=−125/4πν[ν2Γ(34)M(−14,12,−m22ν2)+mΓ(54)M(14,32,−m22ν2)]where Γ(·) is the Gamma function and M(·, ·, ·) is Kummer’s confluent hyper-geometric function (see Abramowitz & Stegun, 1972).Choosing a different stochastic volatility model changes the magnitudes of value function and switching threshold differences, but does not affect qualitatively the impact of “fast” mean-reverting stochastic volatility on optimal switching decisions, as Fig. 3 demonstrates. Value differencesVqHWRT(P,y)−VqD(P)in Panels (a) and (b) are again non-monotone with respect to P and change sign depending on parameter values (ρ, m and ν). Moreover, in Panels (c) and (d) the “modified” switching thresholds are again found to be above or below the constant-volatility ones depending on the correlation coefficient sign, and the percentage threshold correction due to “fast” stochastic volatility are non-linear in m and ν, that positively determine the effective volatility levelf¯.

@&#CONCLUSIONS@&#
This paper formulates and solves an infinite-horizon, optimal switching problem under uncertainty—a methodological problem that is recurrent in many operations research applications—for a general class of stochastic volatility models that exhibit “fast” mean-reversion. Our main results, motivated by the perturbation method (as in Fouque et al., 2000), allow one to obtain analytically and up to any desired order of accuracy the optimal switching policy, subject to the calculation of two constants, which are model-dependent and can be estimated, either analytically (as demonstrated in the examples) or using numerical integration techniques. The results allow the assessment of the quantitative and qualitative effects of stochastic, “fast” mean-reverting volatility in the cash flow process and being analytic, lend themselves to comparative statics which are of interest to the decision-maker and can serve as useful benchmarks for the full numerical treatment of the original problem, which presents difficulties on account of the presence of multiple scales.As a demonstration of our results, we extend the standard model of switching flexibility by Dixit (1989) to include the effects of multi-scale variability, and explicitly calculate its effects on the optimal decision rule. Our main findings are that when the uncertainty in an economic system exhibits fast mean-reverting stochastic volatility: (a) optimal switching between modes will be more frequent, (b) agents will be more willing to activate earlier and will endure higher losses before deciding to optimally suspend operations and (c) findings (a) and (b) are more pronounced for lower (more negative) levels of correlation between price and volatility uncertainty, faster volatility mean-reversion speeds and higher effective volatility levels.The proposed methodology is of interest to decision makers dealing with processes or projects that can be switched from and to an idle/active mode, contingent on state variables that exhibit random evolution on multiple scales.We substitute the expansions (6) into the variational inequality (5) and consider different orders n of δ. At ordern=0,we get the single equationL0Vq,0(p,y)=0which, by the form ofL0,yields thatVq,0(p,y)=Vq,0(p),the exact form of which will be specified at ordern=2. Atn=1,we obtain the single equationL0Vq,1(p,y)=−L1Vq,0(p)=0(by the previous step); hence, by similar reasoningVq,1(p,y)=Vq,1(p),the exact form of which will be specified atn=3(see Appendix B).Forn=2,the boundary conditions are activated, and the variational inequality (5) yields(A.1)L0Vq,2=−L2Vq,0−Rq(p)=:F(p),subject to(A.2)V1−q,0(Pq,0)−Vq,0(Pq,0)=Kq(A.3)∂∂p[V1−q,0(p)−Vq,0(p)]|p=Pq,0=0(A.4)limp→0V0,0(p)=b0r(A.5)limp→+∞V1,0(p)=sgn(a1)∞We apply the Fredholm alternative to Eq. (A.1), to specify the solvability condition, which reduces to choosing F orthogonal to the null space of the adjoint operatorL0*. This implies〈F,φ¯〉L2=0,whereφ¯is the solution of equationL0*φ¯=0. It is easy to verify thatφ¯is the density of the invariant distribution of the latent process Yt, i.e.φ¯=12πνe−(m−y)22ν2. Define the operator⌈·⌉:L2→Rbyh↦⌈·⌉:∫−∞+∞hφ¯dy. The solvability condition reduces to⌈L2Vq0⌉=−Rq,which provides a PDE for determiningVq0of the form(A.6)L2¯Vq0:=12f¯2p2∂2Vq0∂p2+μp∂Vq0∂p−rVq0=−Rqwheref¯2=⌈f2(y)⌉. Note that Eq. (A.6) can be solved, subject to conditions (A.4) and (A.5), for any given Rq(in terms of an integral expression available upon request) to determine Vq, 0. Eqs. (A.2) and (A.3) provide the set of algebraic Eqs. (9) and (10) in the text that uniquely determine the zeroth-order free boundaries Pq, 0.□Recall the definition of the weighted-averaging operator ⌈ · ⌉ in Appendix A. We will also need the following operatorA:L2→L2defined byA(g)=⌈g⌉−g,which centers any function g by its weighted average. Clearly,⌈A(g)⌉=0.Subtract (A.6) from (A.1) to obtain(B.1)L0Vq,2=(L2¯−L2)Vq,0=W0(y)Π0(Vq,0),whereW0(y)=12A(f2(y))andΠ0(.)=p2∂2∂p2. This has a solution,Vq,2(p,y)=L0−1{W0}(y)Π0(Vq,0)(p)+Vq,2(p),which is of the form in (11) withℓ(2)=1,Pq,2,1(p)=Π0(Vq,0)(p)andYq,2,1(y)=L0−1{W0}(y).We continue the expansion in orders of δ. It is easy to see that orders n > 2 lead to equation(B.2)L0Vq,n=−L1Vq,n−1−L2Vq,n−2.The proof now follows by an induction argument. In order to formulate the argument, we need to consider the action of the operatorsL0,L1andL2on products of functions of the formPq,n,iYq,n,iandVq,n. In particular,L0(Pq,n,iYq,n,i)=Pq,n,iL0(Yq,n,i),L0(Vq,n)=0,L1(Pq,n,iYq,n,i)=2νρΛ1(Yq,n,i)Π1(Pq,n,i)L1(Vq,n)=0L2(Pq,n,iYq,n,i)=Λ2(Yq,n,i)Π0(Pq,n,i)+Yq,n,iΠ2(Pq,n,i)L2(Vq,n)=Λ0Π0(Vq,n)+Π2(Vq,n)whereΠ0(.)=p2∂2∂p2,Π1(.)=p∂∂p,Π2(.)=μΠ1−rI,Λ0(y)=12f2(y),Λ1=f(y)∂∂y,Λ2=f2(y)I.Substitute (11) into (B.2) to get(B.3)∑i=1ℓ(n)L0(Yq,n,i)Pq,n,i=−Π2(Vq,n−2)−2νρ∑i=1ℓ(n−1)Λ1(Yq,n−1,i)Π1(Pq,n−1,i)−∑i=1ℓ(n−2)Λ2(Yq,n−2,i)Π0(Pq,n−2,i)−∑i=1ℓ(n−2)Yq,n−2,iΠ2(Pq,n−2,i)−Λ0Π0(Vq,n−2).Apply the Fredholm alternative to (B.3): The solvability condition for (B.3) is that the weighted average of the right-hand side byφ¯is equal to zero, which yields the “averaged” equation(B.4)⌈Λ0⌉Π0(Vq,n−2)+Π2(Vq,n−2)=−2νρ∑i=1ℓ(n−1)⌈Λ1(Yq,n−1,i)⌉Π1(Pq,n−1,i)−∑i=1ℓ(n−2)⌈Λ2(Yq,n−2,i)⌉Π0(Pq,n−2,i)−∑i=1ℓ(n−2)⌈Yq,n−2,i⌉Π2(Pq,n−2,i),which can be identified asL2¯Vq,n−2=Rq,n,whereRq,nis the right-hand side of Eq. (B.4).Move all terms to the left-hand side in (B.4), and adding to the right-hand side of (B.3) we obtain(B.5)∑i=1ℓ(n)L0(Yq,n,i)Pq,n,i=2νρ∑i=1ℓ(n−1)A(Λ1(Yq,n−1,i))Π1(Pq,n−1,i)+∑i=1ℓ(n−2)A(Λ2(Yq,n−2,i))Π0(Pq,n−2,i)+∑i=1ℓ(n−2)A(Yq,n−2,i)Π2(Pq,n−2,i)+A(Λ0)Π0(Vq,n−2).Sinceℓ(n)=ℓ(n−1)+2ℓ(n−2)+1,we break the sum of the left-hand as∑i=1ℓ(n)αi=∑i=1ℓ(n−1)αi+∑i=ℓ(n−1)+1ℓ(n−1)+ℓ(n−2)αi+∑i=ℓ(n−1)+ℓ(n−2)+1ℓ(n−1)+2ℓ(n−2)αi+αℓ(n).Matching the sums on the right and the left-hand sides term-by-term, we have(B.6)Yq,n,i=2νρL0−1[A(Λ1(Yq,n−1,i))](B.7)Pq,n,i=Π1(Pq,n−1,i),i=1,…,ℓ(n−1)Yq,n,i=L0−1[A(Λ2(Yq,n−2,i))](B.8)Pq,n,i=Π0(Pq,n−2,i),i=ℓ(n−1)+1,…,ℓ(n−1)+ℓ(n−2)Yq,n,i=L0−1[A(Yq,n−2,i)](B.9)Pq,n,i=Π2(Pq,n−2,i),i=ℓ(n−1)+ℓ(n−2)+1,…,ℓ(n−1)+2ℓ(n−2)Yq,n,i=L0−1[A(Λ0)]Pq,n,i=Π0(Vq,n−2)i=ℓ(n),plus a termVq,nthat depends only on p.We now turn our attention to the “corrections” of the free-boundary for orders1,2,…. We formulate the expansion using the following notation: LetD=ddδ,D0=∂∂δ,D1=∂∂p,and expressVqδ(Pqδ)=Vq(δ,Pq(δ)),where now Vqis considered a function of two variables, δ and P. By the chain rule,DVq=D0Vq+D1VqD0Pq. Note that1n!D0nVq|δ=0=Vq,nand1n!D0nPq|δ=0=Pq,n,that the operatorDsatisfies the Leibnitz ruleD(FG)=FDG+GDF,andD0,D1commute when acting on Vqon account of smoothness. To obtain the expansion of the boundary conditions at order n, we have to apply the operatorDnat each boundary condition, and then setδ=0,using the above algebraic rules. Forn=1,applyDon the boundary conditionV1−q(δ,Pq(δ))−Vq(δ,Pq(δ))=Kq,and setδ=0to obtainV1−q,1(Pq,0)+∂∂pV1−q,0(Pq,0)Pq,1−Vq,1(Pq,0)−∂∂pVq,0(Pq,0)Pq,1=0.Solving for Pq, 1 we obtain Eq. (12). Note that from the first-order onwards, there is no free-boundary condition. The next orders can be obtained by acting the operatorDnto the boundary conditions, which can easily be done using an algebraic manipulator. This completes the proof.□Forn=0,apply Proposition 1: For the particular choice of Rqin Eq. (13), the general solution of Eq. (7), subject to (8), is readily seen to be (21). Substituting the general solution (21) into the boundary conditions yields the algebraic systems (9) and (10), the solution of which provides the zeroth-order contribution to the free-boundaries.To obtain the “corrections”, apply Proposition 2: To go to the first-order “corrections”, setn=3to (B.4) in Appendix B. Sinceℓ(1)=0andℓ(2)=1,one gets(C.1)L2¯Vq,1=−2νρ⌈Λ1(Yq,2,1)⌉Π1(Pq,2,1)where from (B.17) and (B.18), we see thatYq,2,1=L0−1(A(Λ0)),i.e.Yq,2,1is the solution of the differential equationL0Yq,2,1=A(Λ0),which is(C.2)(m−y)∂Yq,2,1∂y+ν2∂2Yq,2,1∂y2=12(f¯2−f2(y))and(C.3)Pq,2,1=Π0(Vq,0)=(1−q)D0αpα+qD1βpβDefineΓ=⌈Λ1(Yq,2,1)⌉=∫−∞+∞φ¯(y)f(y)∂Yq,2,1∂y(y)dy,whereYq,2,1solves the differential Eq. (C.2) above. For the calculation of Γ, use the notationWy=∂Yq,2,1∂yand express (C.1) as a first-order differential equation. Note thatφ¯is an integrating factor for this equation, so thatddy[φ¯Wy]=φ¯1ν2A(Λ0).Multiply this equation by any function H and integrate by parts to obtain−∫−∞+∞dHdyφ¯Wydy=1ν2∫−∞+∞Hφ¯A(Λ0)dy.ChoosingH(y)=Ω(y)such that−dΩdy(y)=f(y),the above equation yields an expression for Γ as in Eq. (16).Substituting the above expressions in (C.1) and using the variation of coefficients method, we obtain the expression for Vq, 1 in (21). Finally, a straightforward application of Eq. (12) leads to Eq. (22). This completes the proof.□