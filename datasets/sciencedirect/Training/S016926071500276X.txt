@&#MAIN-TITLE@&#
Quadratic blind linear unmixing: A graphical user interface for tissue characterization

@&#HIGHLIGHTS@&#
Interactive software which implements blind linear unmixing algorithms in Matlab.Estimation of the number of components, the end-members and their abundances.Estimations based on constrained quadratic optimization and Neyman–Pearson tests.Software freely available in a hosted webpage by one of the developing institutions.Quick, easy-to-use and efficient tool for multi/hyper-spectral data decomposition.

@&#KEYPHRASES@&#
Linear spectral unmixing,Endogenous fluorescence,Chemometrics,Graphical user interface,Quadratic optimization,

@&#ABSTRACT@&#
Spectral unmixing is the process of breaking down data from a sample into its basic components and their abundances. Previous work has been focused on blind unmixing of multi-spectral fluorescence lifetime imaging microscopy (m-FLIM) datasets under a linear mixture model and quadratic approximations. This method provides a fast linear decomposition and can work without a limitation in the maximum number of components or end-members. Hence this work presents an interactive software which implements our blind end-member and abundance extraction (BEAE) and quadratic blind linear unmixing (QBLU) algorithms in Matlab. The options and capabilities of our proposed software are described in detail. When the number of components is known, our software can estimate the constitutive end-members and their abundances. When no prior knowledge is available, the software can provide a completely blind solution to estimate the number of components, the end-members and their abundances. The characterization of three case studies validates the performance of the new software: ex-vivo human coronary arteries, human breast cancer cell samples, and in-vivo hamster oral mucosa. The software is freely available in a hosted webpage by one of the developing institutions, and allows the user a quick, easy-to-use and efficient tool for multi/hyper-spectral data decomposition.blind end-member and abundance extractionfluorescence lifetime imaging microscopyfield of viewgraphical user interfacelow density lipo-proteinslinear mixture modelmultivariate curve resolutionmulti-spectral FLIMnon-negative matrix factorizationNeyman–Pearsonsignal-to-noise ratioquadratic blind linear unmixingscalar elementvector elementmatrix elementN-dimensional real vectorsN×M real matricestranspose operatorcomponent-wise inequality for vectors or matricesidentity matrix of dimension N×NN-dimensional vector with unitary entriesEuclidean vector normFrobenius matrix norm

@&#INTRODUCTION@&#
Recent advances in optics and electronics have led to the development of new devices capable of multi-dimensional measurements. A particular application is the so-called optical biopsy technologies [1,2]. Their goal is to characterize a sample by extracting their constituent components and contributions in a minimal invasive fashion. Fluorescence-based measurements can describe the biochemical environment [3] within a sample. They are minimal invasive techniques when no exogenous dyes are employed. However endogenous, intrinsic or auto-fluorescence emissions are characterized by a wide spectral response. Overlapping and high similarity among different endogenous fluorophores is a common problem and the reason why auto-fluorescence signals could be difficult to employ in quantitative characterizations. Multi-dimensional fluorescence measurements [4] provide information that facilitates the identification of auto-fluorescence information [5]. Particularly, fluorescence lifetime imaging microscopy (FLIM) data [6] can record the natural fluorescence decay and extract features for its identification and classification. Quantitative interpretation of the information obtained from FLIM measurements is an ongoing research problem. One approach relies on assuming a mono or multi-exponential model for the fluorescence impulse response. Such is the case of global analysis techniques [7] in frequency domain fluorescence measurements [8]. These methods determine the fractional contribution from the endogenous fluorophores without prior information, and with a fast response [9].A different approach is to consider every measured fluorescence decay in the dataset as a linear mixture, produced by the contribution of different fluorophores within the sample. Several techniques can be employed to perform this decomposition. Multi-variate curve resolution (MCR) methods aim to decompose input data into concentration or abundance profiles and spectra that satisfy multicomponent Beer's Law [10]. They can incorporate several constraints to enforce physical properties in the input data. In [11], the Multi-variate Curve Resolution Alternating Least Squares (MCR-ALS) software [12] is employed to separate the intrinsic and extrinsic fluorophores from an in-vivo sample. This method can also estimate the number of components based on the most significant singular values obtained from the input data [13]. Meanwhile, blind source separation methods are other techniques used to characterize fluorescence data. The non-negative matrix factorization (NMF) [14] and its variants aim to decompose the input data into the product of two positive matrices. For example, the authors in [15] employ the NMF method to separate the auto-fluorescence contribution in the sample from extrinsic fluorophores. In fact, similar methods have been studied and applied since the 90s [16] in the decomposition of satellite imagery based on linear and non-linear mixture models [17,18]. Although the latter can characterize complex relations, the former is usually preferred in practice by its efficiency. Finally, the estimation of the characteristic profiles, or end-members, has been also thoroughly studied specially in the remote sensing literature [19,20]. Recently, many efforts have focused on the estimation of the number of components in the mixing model or the model order [21–23]. In fact, no single approach available gathers all the desirable characteristics, some methods require prior information, or they might be sensible to data with high similarity; others can be limited by a maximum number of components or rely on a fitting model. Furthermore, most of them are not tailored for multi/hyper-spectral fluorescence data.Our previous work in [24,25] has been dedicated to the development of linear unmixing methods for m-FLIM data based on quadratic optimization. These methods perform blind decomposition, without prior information, under a linear mixture model (LMM). They calculate the end-members, which correspond to the characteristic fluorescence intensity decays, and their abundances within the sample. Furthermore, the number of end-members in the dataset is estimated such that the measurements can be accurately reconstructed and the abundances have significant spatial meaning. In this context, this paper presents the development of a graphical user interface (GUI) for our quadratic blind linear unmixing (QBLU) method [24,25]. This program will be useful for the characterization of multi-spectral data given the input data is not highly mixed, i.e. it contains samples of the pure components. The program can perform decomposition based on a linear mixture model to estimate the correct number of constituents, their characteristic decays and proportional contributions. The software also provides basic tools to discard low SNR regions and border effects. The results can be employed to analyse different multi-spectral datasets according to the contribution of their mixed components.Our software looks to ease the application of our unmixing methodology with data from different sources, as well as to take advantage of the graphical tools and numerical precision of Matlab. The software was tested for tissue or molecular characterization in three case studies to illustrate possible applications in different fields. The GUI as an application in Matlab and some m-FLIM datasets are freely available online, see Fig. 1, at the following website: http://galia.fc.uaslp.mx/∼omargn/mflim.html.The rest of the paper is organized as follows. The LMM employed for the processing of m-FLIM data is detailed in Section 2, as well as the physical constraints in end-members and abundances. Next, the QBLU algorithm is briefly overviewed in Section 3, where the quadratic approximations for the end-member and abundance estimations are highlighted. Section 4 describes some of the basic functionality of the GUI for preprocessing, visualization and output data storage, as well as its setting parameters. The case studies: ex-vivo human coronary arteries, breast tumor cell samples and in-vivo hamster oral mucosa are presented in Section 5. Finally, Section 6 discusses the results and provides final remarks.The m-FLIM measurementsyˆk∈ℝLcontain L-dimensional vectors of fluorescence decays recorded at positions k∈[1, K] and at Λ different wavelengths. Due to its nature, the measured fluorescence decays are non-negative, i.e.yˆk⪰0for all k∈[1, K]. These measurements are usually preprocessed to reduce the effects of signal variability [26]. One common approach is to normalize the m-FLIM data so each vector sums to one(1)yk=yˆk1L⊤yˆk.These K normalized measurementsyk∈ℝLare stored in a matrixY=[y1,…,yK]∈ℝL×K. The linear mixture model [3,17] states that each fluorescence decayykis a linear combination of N end-members (p1, …,pN) and their abundances (αk,1, …, αk,N):(2)yk=∑j=1Nαk,jpjwherepj∈ℝL, and the abundances satisfy αk,j≥0 and ∑jαk,j=1. Our departing assumption is that the number of end-members N and their profiles (p1, …,pN) do not change in the m-FLIM dataset, and the abundances reflect the fractional contribution of each end-member on each spatial location.Given the number of end-members N, the matrixPN=[p1,…,pN]∈ℝL×Ngathers the ideal end-members, and the vectorsαk=[αk,1,…,αk,N]⊤∈ℝNcontain the abundances at position k. The abundances of the N end-members in the dataset are grouped in the matrixAN=[α1,…,αK]∈ℝN×K. Since we are looking for end-members with characteristics similar to the measurementsyk, the estimation ofPNis also constrained to positivity and sum-to-one per column. Using these definitions, we can now state the linear mixture model in matrix notation as(3)Y=PNAN(4)1N⊤AN=1K⊤&AN⪰0,(5)1L⊤PN=1N⊤&PN⪰0.

@&#CONCLUSIONS@&#
