@&#MAIN-TITLE@&#
Fuzzy PWM based on Genetic Algorithm for battery charging

@&#HIGHLIGHTS@&#
A new fuzzy PWM controller for DC/DC buck converter is proposed.A lead–acid battery charging is simulated.Fuzzy control with small rule obtains good enough effectiveness.

@&#KEYPHRASES@&#
Fuzzy logic systems,PWM,Genetic Algorithm,Buck converter,

@&#ABSTRACT@&#
This paper investigates the use of fuzzy logic control together with Genetic Algorithm (GA) to tune corresponding membership functions in a pulse width modulation voltage (PWM)-based converter for battery charging. For quick charging purposes, a current-charging mode is built on the charging battery series with small impedance resistance. Once the rechargeable battery voltage reaches the preset output voltage value during the current-charging mode, constant voltage-charging mode should take to do the battery charging. No matter what you use a voltage/current mode for battery charging, the PWM converter with tuning duty cycle is necessary to obtain various output voltages to charge battery. The proposed pulse width modulation (PWM) control strategy based on fuzzy logic systems is applied to charge batteries for buck converter. A simulation is proposed to illustrate the efficiency of the design proposed in this paper.

@&#INTRODUCTION@&#
What is DC to DC converters? The input to a DC to DC converter is an unregulated DC voltage Vg. The converter produces a regulated output voltage V, having a magnitude (and possibly polarity) that differs from Vg. For example, in a computer off-line power supply, the 120V or 240V AC utility voltage is rectified, producing a DC voltage of approximately 170V or 340V, respectively. A DC–DC converter then reduces the voltage to the regulated 5V or 3.3V required by the processor ICs [1].Why is there so much excitement about DC–DC converters? DC to DC converters are important in portable electronic devices such as cellular phones and laptop computers, which are supplied with power from batteries primarily. Such electronic devices often contain several sub-circuits, each with its own voltage level requirement different from that supplied by the battery or an external supply (sometimes higher or lower than the supply voltage). Additionally, the battery voltage declines as its stored power is drained. Switched DC to DC converters offer a method to increase voltage from a partially lowered battery voltage and thereby saves space instead of using multiple batteries to accomplish the same thing. Most DC to DC converters also regulate the output voltage. Some exceptions include high-efficiency LED power sources, which are a kind of DC to DC converter that regulates the current through the LEDs, and simple charge pumps which double or triple the output voltage.What is pulse width modulation? (Pulse Width Modulation) A modulation technique that uses a digital circuit to create a variable analogue signal. PWM is a simple concept: open and close a switch at uniform, repeatable intervals. Analogue circuits that vary the voltage tend to drift, and it costs more to produce ones that do not than it does to make digital PWM circuits. In addition, control of almost everything today is already in the digital realm. For example, the PWM is widely used to control the speed of a DC motor and the brightness of a bulb, in which case the PWM circuit is used to open/close a power line. If the switch were opened for 1 microsecond (ms) and closed for 1ms, and this is continuously repeated, the target would receive an average of 50% of the voltage and run at half speed or half brightness. If the line were opened for 1ms and closed for 3ms, the target would receive an average of 25% [2].Why is there so much excitement about PWM? Pulse-width modulation (PWM) allows control and regulation of the total output voltage. This approach is also employed in applications involving alternating current, including high-efficiency DC–AC power converters (inverters and power amplifiers), AC–AC power converters, and some AC–DC power converters (low-harmonic rectifiers). Charging a battery with a solar system is a unique and difficult challenge. In the “old days,” simple on–off regulators were used to limit battery outgassing when a solar panel produced excess energy. However, as solar systems matured, it became clear how much these simple devices interfered with the charging process. The history for on–off regulators has been early battery failures, increasing load disconnects, and growing user dissatisfaction. PWM has recently surfaced as the first significant advance in solar battery charging. PWM solar chargers use technology similar to other modern high quality battery chargers. When a battery voltage reaches the regulation setpoint, the PWM algorithm slowly reduces the charging current to avoid heating and gassing of the battery, yet the charging continues to return the maximum amount of energy to the battery in the shortest time. The result is a higher charging efficiency, rapid recharging, and a healthy battery at full capacity. In addition, this new method of solar battery charging promises some very interesting and unique benefits from the PWM pulsing. These include: ability to recover lost battery capacity and desulfate a battery; dramatically increase the charge acceptance of the battery; maintain high average battery capacities (90–95%) compared to on–off regulated state of charge levels that are typically 55–60%; equalize drifting battery cells; reduce battery heating and gassing; automatically adjust for battery ageing; self-regulate for voltage drops and temperature effects in solar systems [3].From above-mentioned we know that DC–DC power converters are the main components of switching power supplies and PWM control is an indispensable tool for DC–DC power converter. Thus, there are many literatures [4–6] focus on the PWM control strategies to improve the dynamic behaviour of DC–DC power converters. Pulse width modulation (PWM) is the most effective means to achieve constant voltage battery charging by switching the controller's power devices. Conventional PWM duty cycle adjustment based PID control will burn off a lot of trial and error time to manually adjust parameter but not necessarily be able to get a better system response. The advantage of fuzzy control is that a mathematical model for the system does not require. Only some input/output data are employed to obtain an effective control or model.Fuzzy control has been reported to be successfully used for a number of complex and nonlinear process, including DC–DC power converters [7,8], robotics [9], and renewable energy systems [10]. They are often constructed based on expert knowledge which often requires extensive knowledge for extensive trial and error tuning, which needs much time to learn. A more systematic approach, Genetic Algorithm, for tuning fuzzy control is proposed in this paper to reduce reliance on expert database.Genetic algorithms (GAs) had been widely used in function optimization [11,12]. It was parallel, global search algorithms based on the mechanics of natural genetics. Before applying GAs to solve an optimization search problem, we need to transform the problem into a respective function called the fitness function. The fitness function is equivalent to the system performance index. The purpose of GAs is to find a better fitness function via some simulated artificial operation processes which roughly include reproduction, crossover, mutation and replacement. One cycle of reproduction, crossover, mutation and replacement is defined as one generation. After some generations, by working the above artificial operation process, the GAs can efficiently search many local optima and thereby increase the likelihood of finding the global one. Thus, after using GAs to tune the fuzzy controller for DC–DC converter we should obtain a better system performance than traditional one.Due to the aforementioned advantageous features, the proposed fuzzy logical controller of PWM Genetic Algorithm (GA)-based reinforcement learning networks is optimal and effective. The main contributions of this paper are to propose a tunable of PWM based on fuzzy control to use in the rechargeable battery control. In order to do this, we set up the paper as follows. The configuration of a fuzzy control system for the buck converter is viewable in Section 2. Section 3 proposes the design and tuning of a fuzzy control using GAs. The battery charging mode is introduced in Section 4. An illustrative example to show the simulation result is given in Section 5. Conclusions are summarized in Section 6.We propose a battery charging system with constant voltage/current charging mode in Fig. 1that Vois the output voltage, Q is powered switch, Vdcis the input voltage and R is a small feedback resistance. A buck converter is a second order system with nonlinear property. The fuzzy PWM controller is proposed to control the output voltage Vo/VRapproaching to the desired one Vrin Fig. 1.The circuit in Fig. 1 can be written in two sets of state equation depends on the position of power switch Q. If the switch is in position on, the inductor voltage can be obtained, from KVL, as(1a)diLdt=Vdc−Vo−VRL≅Vdc−VoL,(1b)dVodt=iLC−VRRC.The other one is obtained if the switch is in off position.(2a)diLdt=−VoL,(2b)dVodt=iLC−VRRC.Two distinct equations (1) and (2) are weighted by the duty ratio and superimposed as (δ)∗(1)+(1−δ)∗(2):(3a)diLdt=δ(Vdc−Vo)L−(1−δ)VoL=δVdc−VoL,(3b)dVodt=δiLC−VRRC+(1−δ)iLC−VRRC=iLC−VRRC,where δ∈[0 1] is the duty ratio, which is also the control input. Fuzzy logic controller (FLC) parameters vary according to system state evolution, allowing it to deal with modelling uncertainties and system parameters variation [9]. Thus we construct the control input δ in (3) based on FLS to handle the controlled voltage Vo/VRapproaching the desired reference Vr. No complicated arithmetic express is needed but a linguistic control variable to do is a character of fuzzy logic system.Because the integral of the inductor voltage VLover one time period must be zero, we can obtain the following∫0TsVLdt=∫0δTsVLdt+∫δTsTsVLdt=0=δTs(Vdc−Vo)+Ts(1−δ)(−Vo)=0(3c)⇒Vo=δVdc.The relation (3c) between output voltage Voand input voltage Vdccan be regarded as a principle while constructing fuzzy rule of FLS. From above mention, this paper's main task is that a completely new fuzzy PWM controller is proposed to produce the control input δ for handing the output Vo/VRto approach the desired one Vr. The configuration is shown schematically in Fig. 1 which also is applied to the battery charging with constant voltage/current mode.The block diagram of the fuzzy PWM (FPWM) controller based on GAs for DC–DC converter is shown in Fig. 1. The FPWM is composed of PWM and fuzzy logic system (FLS) whose membership function is tuned by GAs. The FLS can be divided into four modules: (i) fuzzification is the classification of input data into suitable linguistic values or sets; (ii) knowledge base includes rule base and data base; (iii) decision making is inferring control action from rule base; (iv) defuzzification is the conversion from the inferred fuzzy value to real crisp value. Furthermore, the input signal of the FLS should be normalized before input FLS. The normalized signal is expressed mathematically as(4a)e_=e1|e1_|;fore1_<e1<0,(4b)e¯=e1|e¯1|;for0<e1<e¯1,where e1 is the input of normalizer which ranges between lower bounde1_and upper onee¯1. The output of normalizer is e whose range between −1 and 1 in Fig. 1. The relation between e and e1 is named as(5a)e=normalize(e1)=normalize(Vr−Vo(orVR)).where Vris the reference output voltage, Vo(or VR) is the actual output voltage of DC–DC buck converter. The error difference de is defined as(5b)de=e(k)−e(k−1).We take the e and de as the antecedent part of the proposed FLS to produce the duty ratio control signal δ between 0 and 1 then pass it to PWM for completing fuzzy PWM control signal. The duty ratio δ is the consequent part of the proposed FLS, i.e.,(6)δ=FLS(e,de).The FLS is shown to be of Mamdani-type and uses a control strategy expressed linguistically by the form:(7)Rule(i):ifeisX1(i)anddeisX2(i)thenδ=Y(i)where Rule(i) is the ith control rule,Xj(i)and Y(i) denote the fuzzy sets of the ith rule defined on e, de and δ, respectively. The mean value of maximum is chosen as defuzzification strategies for this FLS which membership function is a triangular shape of this paper. The shape of the membership functions associated with the input fuzzy levels does not affect the stability issue.Table 1lists the fuzzy rule base in which the input variables in the antecedent part of the rules are e and de. The consequent part is δ of output variable. The linguistic representation of fuzzy sets P, MP, SP, LP, Z and N are “positive”, “medium positive”, “small positive”, “less positive”, “zero” and “negative”. The antecedent sets and consequent one are chosen as (P, Z, N) and (P, MP, SP, LP, Z), respectively, whose corresponding membership functions are shown in Fig. 2. The rules in Table 1 are read as, taking rule 1 as an example, “Rule 1: if e is P and de is P, then δ is P”. The degree of membership functions μi(e, de)∈[−1, 1] and μi(δ)∈[0, 1] is obtained for each rule. Traditionally, it is necessary to construct the rule table of fuzzy system by in-depth knowledge of the plant. And it will waste time to try and error to tune fuzzy rule and membership function. Here we propose an easily realizable method to overcome this drawback for obtaining satisfactory system performance of DC–DC converter.Take the rule 1 to interpret the construction principle of Table 1. This trajectory phenomenon of rule 1 can be shown as Fig. 3which illustrates the output voltage Vojust goes forward to the desired voltage Vrbut far away from it. That is “e(kT)∈P,deΔ̲̲(e(kT)−e(kT−T))∈P”. In order to accelerate the output voltage Voapproaching the desired one Vr, it is reasonable to use the linguistic control “δ∈P” to raise the Vowhich is proportional to δ according to (3c). The phenomenon of rules 2 and 3 of Table 1 also is schematically shown in Fig. 4. The three cases, rule 1–3, are all e(kT)∈P which means Vofar from Vr, so it is reasonable that the linguistic control strategy δ∈P is chosen to decrease the error between Voand Vr. Based on above-mentioned principle, the rest of control rule also follows the same principle to construct.The control action δ is given by FLS at the beginning of each clock cycle and inputs to PWM which output pulses are generated by comparing a triangular carrier waveform to a reference modulating signal shown as Fig. 5. In short, the FLS produces a value, duty ratio δ, and pass it to PWM which produces a series pulses to handle DC/DC buck converter shown in Fig. 1. In order to refine the system performance,e≈̲̲0, we induce the GAs to tune the membership function of FLS. Each individual in the population is called a chromosome, representing a solution to the problem at hand. The chromosome structure is double-vector form [13] in this paper. The chromosomes evolve through successive iterations, called generations. During each generation, the chromosomes are evaluated, using some measure fitness. The GAs structure can be illustrated in Fig. 6. Before applying GAs basic operators, reproduction, crossover and mutation, to search the good membership function of consequent sets, we complete the preliminary work shown as follows:(a)Decision of tuning parameters: Smaller tuning parameter causes lower searching time in the GA operational cycle. Hence, just middle points of the triangle membership function of consequent sets are chosen to tune, i.e., the two points a1 and a2 in Fig. 2(b) are what we want to tune such that the output voltage Vo/VRapproaches to the desired one Vr. The range of searching parameters a1 and a2 should be set 0<a1<0.5; 0.5<a2<1 in Fig. 2(b).Definition of fitness function: Fitness function is equivalent to the system performance index which is defined as(8)J=∫0tf|e1(t)|dt,wheree1(t)Δ̲̲Vr−Vo(ore1(t)Δ̲̲Vr−VR), || denotes an absolute positive operator. In the search process of the GA, each generation produces an adaptive population. When this population is higher than the last generation, it means that the new population is better than the last generation's population, and the new generation's excellent population is more likely to be preserved. Finally, the preserved population is the optimal solution of the fitness function which plays the role of distinguishing between good and bad for the searched parameter.Producing the initial population: The initial generations of GA will influence the speed of convergence. Hence, before applying GA operators, the initial individual can be randomly produced and mixed with a manual chosen individual to shorten the generation in the GA execution.After completion of the above-mentioned preparation of GAs, the algorithm then creates a sequence of new populations. At each step, the algorithm uses the individuals in the current generation to create the next population. To create the new population, the algorithm performs the following steps [13]:i.Scores each member of the current population by computing its fitness value.Scales the raw fitness scores to convert them into a more usable range of values.Selects members, called parents, based on their fitness.Some of the individuals in the current population that have lower fitness are chosen as elite. These elite individuals are passed to the next population.Produces children from the parents. Children are produced either by making random changes to a single parent—mutation—or by combining the vector entries of a pair of parents—crossover.Replaces the current population with the children to form the next generation.The algorithm stops when one of the stopping criteria is met.If the performance index of operating point is higher/lower than the previous one, the GA will automatically discard/save this operating point. These are shown in steps iv–vii. GA uses different operating point caused by mutation/crossover to find a set of approximately global optimal gains with minimum performance index. GA is generally used for off-line parameter searching rather than online. That is, tune parameters by GA before using them in real time.Battery charging control can be divided into two modes, constant voltage charging and constant current charging, shown in Fig. 1. Battery charging technology relies on microprocessors (computer chips) to recharge, using 3 stages (or 2 or 4 stages) regulated charging. The three stages in lead/acid battery charging are bulk, absorption, and float. The bulk stage involves about 80% of the recharge, wherein the charger current is held constant (in a constant current charger), and voltage increases. The properly sized charger will give the battery as much current as it will accept up to charger capacity (25% of battery capacity in amp hours), and not raise a wet battery over 125°F. That is why this paper to propose constant current charger Fig. 1(b).The switching DC/DC converter system can be controlled by the proposed FPWM control to handle the Vo/VRclose to the desired output Vr. Constant voltage/current battery charging means constant output voltage/current can be handled by changing the duty ratio δ of PWM into Mosfet Q. The two modes of battery charging are described in detail as bellows:•Voltage-charging mode: The feedback signal is a battery terminal voltage Vowhich is compared with the reference voltage Vrand the error signal e1 is processed by the FPWM controller such that the constant output voltage Vo≅Vris obtained. Different Vrmakes different constant voltage charging shown in Fig. 1(a).Current-charging mode: The small resistance R series connection with battery such that electric current flowing through resistance equals the battery flowing through the battery. Hence, to regulate the voltage VRis corresponding to regulate the current flow through the battery. The DC output voltage VRis feedback to compare with the reference voltage Vr(like current demand) and the error signal e1 is further processed by the proposed FPWM in Fig. 1(b) such that constant current charging is satisfied. For example, when the reference voltage Vr=0.1 is set, the FPWM will handle DC–DC converter output VRclose to Vr=0.1 in Fig. 1(b). That isVR=IRR=0.1=I∗0.1=Vr=0.1⇒I=1A. Using R to replace the current sensor can save costs in electric implementation for constant current charging.The proposed FPWM control can satisfy above mentioned charging mode, constant current/voltage charging. Next simulation will show the proposed control strategy's effectiveness no matter what kind of battery charging mode.The study is done by SIMULINK and SIMPOWER of MATLAB. The parameters of buck converter Fig. 1 are L=1600μH, C=200μF, R=0.1Ω, PWM frequency f=100kHz, lead–acid battery of 12V/1.5AH. Based on the rule in Table 1, we use the GA operator with the fitness function (8) to tune the parameters a1 and a2 of output membership function shown in Fig. 2b. The search space is given 0<a1<0.5 and 0.5<a2<1.The information of GA parameters is shown as: population size is 50, crossover rate is 0.8, mutation rate is 0.01 and the used crossover method is “single point” which chooses a random integer n between 1 and number of variables 2 of this paper, and selects the vector entries numbered less than or equal to n from the first parent, selects genes numbered greater than n from the second parent, and concatenates these entries to form the second parent, and concatenates these entries to form the child. For example: two genes are given asp1=[0.10.5],p2=[0.80.4].If random crossover point=2, their corresponding children arechildren1=[0.10.4];children2=[0.80.5].We set a performance index in Eq. (8) of the paper to play the role of distinguishing between good and bad for the searched parameter. The GA gains have a corresponding performance index. The desired optimal GA gains with smallest performance index ensue those are optimal. After 50 generations of GAs, we obtain the desired consequent membership function shown in Fig. 7.In order to show the robustness of our proposed method, we take input voltage is a DC source 24V with variation 2sin(200πt). That is, regardless of the input voltage varying from 22 to 26, we still can obtain a desired output voltage by the proposed method. When the constant voltage/current charging mode in Fig. 1(a) and (b) with reference voltage Vr=14/Vr=0.2 is experimented, Fig. 8shows a snapshot of the simulation and the satisfactory system robust performance by proposing FPWM control under varying input source Vdc. Simulation results show the output voltage of buck converter can be exactly and rapidly controlled at the two charging modes.Traditional PID control can reduce steady-state error as far as possible by tuning the gains P, I, and D for the linear controlled model but nonlinear one. The DC buck converter of this article is a nonlinear model, the steady state error is hard to be cancelled by PID control unless that the controlled DC buck converter can be linearized to a linear model. Unfortunately, the existing MATLAB PID tuning tool fails to linearize the DC buck converter, therefore steady-state error will exist. The partition search of three gains, P=1–20, I=1–50 and D=1–10, is used to search the relative steady-state error based on the criterion (8). After 104 simulations with various combinations of PID control gains, the relative small steady state error response shown in Fig. 9with the gains P=20, I=50 and D=1. In order to show our approach is better than traditional PID control, the output voltage of the two control methods, proposed FLC and traditional PID, is simultaneously shown in Fig. 9 based on the above-mentioned parameters for tracking the reference 0.5V. From the viewpoint of tracking accuracy to the desired 0.5V, the proposed method is obviously superior to traditional PID control.The battery block implements a generic dynamic model parameterized to represent most popular types of rechargeable batteries. The equivalent circuit of the battery [15] is shown below:The battery is a nonlinear load under charge mode of the proposed simulation. Traditional PID control can reduce steady-state error for the linear controlled model rather than nonlinear one by using the fixed PID gains after tuning. Fuzzy PI control can adjust adaptively the PI gain according to feedback error. So the control gains of fuzzy PI control are variable, not fixed to handle the nonlinear load. This is why fuzzy PI control can reduce the steady state error to zero, but the traditional PID one can not. The proposed fuzzy control also adjusts adaptively the controller gain to cope with the nonlinear battery load, but the gains of tradition PID control are fixed to do. This makes the difference of the performance in Fig. 9.Recently Elmas [14] also proposed the DC–DC converter with an adaptive fuzzy logic controller. We also take their article's results to compare with ours. The output voltage response of the buck converter circuit [14] with tracking 5V is shown in Fig. 10(a) whose steady state is not stable enough and jitters about 3ms. However, the output voltage of DC–DC buck converter based on proposed method is very stable and no beating case shown in Fig. 10(b). After comparison with similar study, we illustrate the effectiveness of the proposed design method.

@&#CONCLUSIONS@&#
A complete new robust FPWM controller for DC/DC buck converter has been proposed. With input voltage source variation, the proposed controller still can handle the output voltage to attain desired one. The proposed DC/DC converter controlled by FPWM has the robustness to input variables. We also apply it to lead–acid battery charging with constant voltage/current mode which is proven to be feasible. Traditional fuzzy controller with more rules needs more time to defuzzify computation, however this study used the simplest fuzzy rules to minimize the fuzzy engine calculation time and simulation results also show the proposed method's effectiveness.