@&#MAIN-TITLE@&#
On modeling with rational ringed surfaces

@&#HIGHLIGHTS@&#
The paper focuses on modeling with rational ringed surfaces, mainly for blending purposes.We answer the question of their rationality and use P-curves for constructing rational ringed surfaces.The method for constructing blends that satisfy certain prescribed constraints is presented.The designed approach can be easily modified also for computingn-way blends.The contour curves are used for computing approximate parameterizations of implicitly given blends by ringed surfaces.

@&#KEYPHRASES@&#
Ringed surface,Canal surface,Rational parameterization,Contour curves,Approximation,Blending,

@&#ABSTRACT@&#
A surface in Euclidean space is called ringed (or cyclic) if there exists a one-parameter family of planes that intersects this surface in circles. Well-known examples of ringed surfaces are the surfaces of revolution, (not only rotational) quadrics, canal surfaces, or Darboux cyclides. This paper focuses on modeling with rational ringed surfaces, mainly for blending purposes. We will deal with the question of rationality of ringed surfaces and discuss the usefulness of the so called P-curves for constructing rational ringed-surface-blends. The method of constructing blending surfaces that satisfy certain prescribed constraints, e.g. a necessity to avoid some obstacles, will be presented. The designed approach can be easily modified also for computingn-way blends. In addition, we will study the contour curves on ringed surfaces and use them for computing approximate parameterizations of implicitly given blends by ringed surfaces. The designed techniques and their implementations are verified on several examples.

@&#INTRODUCTION@&#
In this paper, we will focus on modeling with the ringed (or cyclic) surfaces. They are generated by sweeping a circle with variable radius–which is contained in a plane with a possibly non-constant normal vector–along a directrix curve, see  [1]. Special cases include Darboux cyclides (see  [2]) which can carry up to six families of real circles, see  [3–6]. Ringed surfaces are well suited e.g. for designing pipe structures in plant modeling,  [7,8]. A special method for computing the intersection of two ringed surfaces is described in  [9].The class of ringed surfaces contains a special subclass of canal surfaces that are obtained as the envelopes of a one-parameter family of spheres, see e.g.  [10,11]. Special cases include pipe surfaces (obtained for spheres of constant radius) and surfaces of revolution (generated by spheres whose centers are located on a given line). Dupin cyclides (defined as the envelopes of all spheres touching three given spheres) form probably the most studied family of canal surfaces  [12–14].It was proved in  [15,16] that any canal surface with a rational spine curve (which is the curve formed by the centers of the moving spheres) and a rational radius function admits a rational parameterization  [15,16]. An algorithm for generating rational parameterizations of canal surfaces was presented in  [17]. An analogous result was proved also for normal ringed surfaces—in particular a normal ringed surface with rational directrix and a rational radius function is rational, see  [15]. We will extend this result for an arbitrary ringed surface with rational directrix, rational normal vector field and radius function equal to the square root of some non-negative rational function.The canal surfaces have been studied more thoroughly than the ringed surfaces and one can find many applications in CAD based on canal surfaces. Let us recall, for instance, the operation of blending which is one of the most important operations in Computer-Aided (Geometric) Design. The main purpose of this operation is to generate one or more surfaces that create a smooth joint between the given shapes. Blending surfaces are necessary for rounding edges and corners of mechanical parts, or for smooth connection of separated objects, see e.g.  [18,19] and references therein. Canal surfaces are often used as blending surfaces between two given surfaces  [20–22].However not for all input shapes (ending with circular profiles), the canal surfaces are suitable as blending primitives. We recall e.g. the case when oblique cones shall be blended—then the ringed surfaces find their straightforward application. Our goal is to investigate the possibility to construct a smooth joint between given shapes by parametric ringed surfaces. In addition, the designed technique will enable us to construct also generaln-way blends betweennringed surfaces. As the method produces watertight blends the results can be interesting also for Isogeometric Analysis,  [23].Methods for connecting ringed surfaces by implicit blends were presented in  [24,25]. As known, an exact rational parameterization does not exist for an arbitrary implicitly given algebraic surface. Then, suitable techniques producing approximate parameterizations must be used. Methods for the computation of an approximate parameterization of a implicitly given canal surface obtained as a result of some blending technique were thoroughly studied in  [26,27]. In this paper, we will continue with this approach and present a method for an approximate parameterization of implicitly given ringed-surface-blends.The remainder of this paper is organized as follows. The next section summarizes some fundamental facts about ringed surfaces. In Section  3 we deal with the question of rationality of ringed surfaces. The method of constructing blending surfaces by rational ringed surfaces is described in Section  4. In Section  5 we show how such a blending surface can be adjusted to satisfy certain constraints, e.g. when avoiding obstacles is required. In Section  6 we present a short sketch of the construction ofn-way blends and Section  6 is devoted to contour curves on ringed surfaces which are used for computing approximate parameterizations of implicitly given blends by ringed surfaces. Then we conclude the paper.A ringed surfaceR, see Fig. 1, is a surface generated by sweeping a circle centered at a curved(t), called the directrix, lying in a plane with the prescribed normal vectorn(t), called the orientation function, and possessing a radius described by the radius functionϱ(t). We shortly writeR:(d,n,ϱ)(t). We will omit the dependence on parametertwhenever no confusion is likely to arise. Whenn×d′=o(i.e., the orientation function describes the field of the directrix tangents’ directions) we speak about the normal ringed surfaces, see Fig. 2.A special subclass of the ringed surfaces is constituted by the so called canal surfaces. A canal surface is defined as the envelope of a one-parameter family of spheres whose centers trace the spine curvemand possess the radii described by the radius functionr. The canal surfaces with constant radius function are called pipe surfaces.Every canal surface is a ringed surfaces with(1)d=m−rr′‖m′‖2m′,n=m′,ϱ=r‖m′‖2−r′2‖m′‖.On the other hand a ringed surface is a canal surface if and only if(2)((n⋅d′)d′+(ϱϱ′)n′)×n≡o,see  [6], where a close relation of ringed/canal surfaces to Darboux cyclides is investigated.A parameterizations(t,u)of the ringed surfaceRcan be obtained by rotating the points of a (suitably chosen) curvec(t)onR(different from any of the sweeping circles) around the corresponding line element(d(t),n(t)), i.e., we arrive at(3)s(t,u)=d+(φ+n)⋆(c−d)⋆(φ−n)(φ+n)⋆(φ−n),whereφ(u)is a rational function (for the sake of simplicity we chooseφ(u)=ufor the low rational degree ofs(t,u)inu), the sumsφ(u)±n(t)of scalars and vectors are considered as quaternions, and⋆is the operation of quaternion multiplication, see e.g.  [28] for more details about quaternions.Hence the problem of finding a rational parameterization ofRis reduced to the problem of finding a rational curvec⊂R. All such curves (except from the sweeping circles) can be written in the form(4)c=d+ϱn⊥‖n⊥‖,wheren⊥is a vector field perpendicular to the vector fieldn.Here, we will consider the ringed surfaceR:(d,n,ϱ)given by a rational directrixd, rational radius functionϱand rational orientation functionn. As discussed above, to compute a rational parameterization ofRit is enough to find a rational curve(5)f(t)=n(t)⊥‖n(t)⊥‖,associated ton(t). This is a curve lying on the unit sphereS2whose parameterizationf(t)satisfies the conditions(6)n⋅f≡0,f⋅f≡1.Before we show a general result on the rationality of the ringed surfaces we present some special cases. These cases are mentioned and discussed especially because of their straightforward application potential in geometric modeling (blending, approximate parameterizations, etc.)—see the next sections.In  [29] the so called polynomial Pythagorean curves (shortly P-curves) were introduced as polynomial curvesx(t)inR3satisfying the defining condition(7)x⋅x=σ2for some polynomialσ∈R[t]. This approach can be directly generalized to any dimension and also to rational counterparts.P-curves possess a distinguished feature suitable for our construction, i.e., they enable to find immediately an associated polynomial/rational curvex⊥with the same polynomial/rational normσand fulfilling the propertyx⋅x⊥≡0. All polynomial P-curves can be written in the form:(8)x=(x02+x12−x22−x32,2(x1x2−x0x3),2(x0x2+x1x3))⊤,(9)σ=x02+x12+x22+x32,wherexi∈R[t]. Then there exist curvesx1⊥andx2⊥such that‖x‖2=‖x1⊥‖2=‖x2⊥‖2=σ2andx⋅x1⊥=x⋅x2⊥=x1⊥⋅x2⊥=0which are of the following form, see  [30](10)x1⊥=(2(x1x2+x0x3),x02−x12+x22−x32,2(x2x3−x0x1))⊤,(11)x2⊥=(2(x1x3−x0x2),2(x0x1+x2x3),x02−x12−x22+x32)⊤.Thus, if the orientation functionnof some ringed surfaceRis a P-curve we can easily find a spherical curvefin the form (5) by choosing someϕ∈[0,2π)and setting(12)f=cos(ϕ)n1⊥+sin(ϕ)n2⊥σ,whereni⊥have the meaning ofxi⊥forx≔n. Consequently, we compute a rational parameterization ofRusing thisf(andcderived from it).Proposition 3.1Let be given a ringed surfaceR:(d,n,ϱ)such that the orientation function describes a spatial polynomial P-curve. Consider a spherical curvefassociated tonin the form   (12)   and the corresponding curveconRin the form   (4). Then the parameterization   (3)   is rational.Furthermore, we will assume thatnis not a spatial P-curve but the projection ofnto a plane going through the origin and having the unit normal vectorv, i.e.,(13)πv(n)=n−(n⋅v)v,is a planar P-curve. So it holds(14)πv(n)⋅πv(n)=n⋅n−(n⋅v)2=σ2.In this case we can take(15)f=n×vσsince this choice ensures thatf⋅n=0and moreover(16)‖f‖2=‖n‖2−(n⋅v)2σ2=1.Proposition 3.2Let be given a ringed surfaceR:(d,n,ϱ)such that the projectionπv(n)of the orientation function, see   (13), is a planar P-curve. Consider a spherical curvefassociated tonin the form(15)   and the corresponding curveconRin the form   (4). Then the parameterization   (3)   is rational.Example 3.3We want to find a rational curvefonS2for the case of quadraticn. To ensure the orthogonality we choose(17)f=n×v‖n×v‖.Asfis supposed to be rational‖n×v‖has to be a polynomial. So, we ask: Is there for a givenna vectorv∈S2such that(18)‖v×n‖2=σ2?After rewriting we get the conditions(19)‖n‖2−(n⋅v)2=σ2,‖v‖=1.According to results from  [31], where a similar condition was thoroughly discussed, we can prove that Eq. (19) has a real solution for all quadratic orientation functions. To sum up, for any quadratic curve there exists a plane going through the origin such that the projected curve is a planar P-curve.In this section we will present how the curvefcan be found for any generalR:(d,n,ϱ). In  [16,32] a similar equation to (6), which is a crucial step for the computation of a rational parameterization of pipe/canal and also normal ringed surfaces, is solved and discussed. Here, we exploit and follow the idea introduced in  [16]. The solution of (6) is a curvefsuch that for eacht∈Rthe pointf(t)lies on the unit circlec(t)centered at the origin and lying in the plane having the normal vectorn(t). When projecting the circlesc(t)via the stereographic projectionδ:S2→ν(whereνdenotes the planez=0) with the center(0,0,1)⊤, we obtain the circles inνhaving the centerss(t)and radiiρ(t)(20)s=−(n1,n2,0)⊤n3,ρ=−‖n‖n3.Remark 3.4It is obvious that whenn3=0, i.e., the circleccontains the center(0,0,1)⊤, the projectionδ(c)is a straight line going through the origin and having(n2,−n1,0)⊤as its direction vector.Now, it is enough to find some rational curvehsuch that for eacht∈Rthe pointh(t)lies on the circleδ(c(t)). Since the radius functionρis not rational in general, we compute the sum of squares (SOS) decomposition ofρ2. In particular, ifg=(g1,g2,0)⊤is a planar curve satisfying(21)‖n‖2=g12+g22then the curvehcan be written as follows:(22)h=s+gn3.Finally the inverse projectionδ−1:ν→S2yields the curve(23)f=(2h1,2h2,‖h‖2−1)⊤‖h‖2+1solving equation (6). Hence, we can formulate the following theorem.Theorem 3.5Any ringed surfaceR:(d,n,ϱ)with a rational directrix, radius and orientation function is rational.We have proved that all ringed surfaces with rational directrices, radius functions and orientation functions are rational. However, a next question naturally follows: Do exist other rational ring surfaces which are not given by rationald,n,ϱ? And the answer is yes.Consider a canal surfaceS(which belongs to the class of ringed surfaces) determined by a rational spine curvemand a rational (sphere) radius functionr. Such a canal surface is rational, see  [16]. Nevertheless, considering it as a ringed surfaceRand computing its directrix, radius function and orientation function according to (1), the (circle) radius functionϱis a square root of a non-negative rational function(24)ϱ=r2‖m′‖2−r′2‖m′‖2.So we will continue with our considerations further and prove that a general ringed surfaceR:(d,n,ϱ=R)with a rational directrix, a rational orientation function and a radius function equal to the square root of some non-negative rational function is rational.Without loss of generality we can assume thatnis polynomial. Our goal is to find a rational curvefsatisfying(25)n⋅f≡0andf⋅f≡R.For such a curvefwe can construct a corresponding rational curve onRin the form(26)c=d+ϱf‖f‖=d+f.Eq. (25) describes a curvefwith the property that for eacht∈Rit holdsf(t)∈c(t), wherecis a great circle of the sphere centered at the origin with the radiusRand lying in the plane having the normal vectorn. Hence we seekfdetermined by a 1-parameter system of circles(27)c(t):x⋅x−R(t)=0,x⋅n(t)=0,wherex=(x,y,z)⊤. Projectingcto the planeνwe obtain a 1-parameter system of ellipses(28)(n1x+n2y)2+n32(x2+y2−R)=0and the lifting (the inverse of the above projection) is described(29)z=−n1x+n2yn3.Ellipses (28) have centers at the origin and the directions of their axes are(30)a1=(−n2,n1)⊤,a2=(n1,n2)⊤.Hence by transforming (28) via the transformation(31)x→−n2x′+n1y′,y→n1x′+n2y′we get(32)(n12+n22)n32x′2+(n12+n22)‖n‖2y′2−n32R=0.Now using the projective coordinates, multiplying Eq. (32) by(n12+n22)and performing the transformation(33)X′→X″n3(n12+n22),X′→Y″n12+n22,Z′→Z″n3we arrive at the 1-parameter system of ellipses:(34)X″2+‖n‖2Y″2−(n12+n22)RZ″2=0,which can be rationally transformed to the following one(35)A(t)X2+B(t)Y2+C(t)Z2=0,whereA,B,Cpossess only complex 1-multiple roots andA,BneitherB,CneitherA,Cdo not have common roots, cf.  [33]. Eq. (35) always possesses a rational solution, see the proof of Proposition 2.1 in  [33], where one particular rational solution of Eq. (35) is constructed.This approach can be generalized for rationalnandR, too. We only multiply Eq. (34) by the denominators of‖n‖2and(n12+n22)Rand obtain an equation which can be rationally transformed to (35). Hence, we can formulate:Theorem 3.6Any ringed surfaceR:(d,n,ϱ=R)with a rational directrix, rational radius function and orientation function equal to the square root of a non-negative rational function is rational.We recall that this result was also noted in  [6], though the details of the proof have not been worked out there.Consider two ringed surfacesR1andR2given by their directrices, radius functions and orientation functions, i.e.,(36)R1:(d1,n1,ϱ1)(t),R2:(d2,n2,ϱ2)(t).Without loss of generality, we can assume that both surfaces are defined fort∈[0,1](otherwise this is fixed by a linear reparameterization). Our goal is to construct a blending ringed surfaceBbetweenR1andR2. Such a blending surface shall smoothly join two given ringed surfacesR1andR2. When interpolating given Hermite data inR7(37)p0=(d1,n1,ϱ1)⊤(1),v0=(d1′,n1′,ϱ1′)⊤(1)p1=(d2,n2,ϱ2)⊤(0),v1=(d2′,n2′,ϱ2′)⊤(0)by a curveb(t)=(d,n,ϱ)(t)⊤,t∈[0,1], withC1/G1continuity we obtain a blending surfaceBwhich will joinR1andR2withC1/G1continuity, too.In the previous section it was shown that an arbitrary rational curveb=(d,n,ϱ)⊤describes a rational ring surfaceB:(d,n,ϱ)and its rational parameterization can be computed by the SOS decomposition (which is solvable only numerically, in general). However, as indicated in Propositions 3.1 and 3.2, using some special curves (when interpolating (37)) will make the computation of the parameterization of the blending ringed surface considerably easier as it allows to avoid the SOS decomposition. Let us discuss this approach in more detail.When interpolating Hermite data sampled from the orientation functions, i.e.,{n1(1),n1′(1);n2(0),n2′(0)}, by a P-curve we immediately obtain a curve with the polynomial norm and fulfilling the condition on orthogonality. So we will focus on this part of the interpolation more thoroughly. The interpolation by polynomial P-curves is based on solving quadratic quaternion equations as in the case of spatial PH curves, see  [29]. Consequently, Hermite data sampled from the directrices together with radius functions, i.e.,{d1(1),ϱ1(1),d1′(1),ϱ1′(1);d2(0),ϱ2(0),d2′(0),ϱ2′(0)}, can be interpolated by an arbitrary rational curve.Nevertheless, Proposition 3.2 offers even an easier way. It is enough to interpolate 2-dimensional data (sampled from the projection of the orientation functions to a coordinate plane) by a planar P-curve. This can be done by solving “only” complex quadratic equations. The remaining coordinate of the orientation function together with the directrix and the radius function will be obtained via the interpolation by some rational curve. Thus, we will interpolate(38)p01=(d1,n13,ϱ1)⊤(1),v01=(d1′,n1′3,ϱ1′)⊤(1)p11=(d2,n23,ϱ2)⊤(0),v11=(d2′,n2′3,ϱ2′)⊤(0)by a suitable rational curve (e.g. Ferguson’s cubic) and(39)p02=(n11,n12)⊤(1),v02=(n1′1,n1′2)⊤(1)p12=(n21,n22)⊤(0),v12=(n2′1,n2′2)⊤(0)by a suitable planar rational P-curve (e.g. planar P-curve of degree 6).Now, we will show how the interpolation by a planar P-curve can be computed. As in the case of planar PH curves we use a complex representation of points/curves in the plane. Then the curvex(t)is a polynomial P-curve if and only if it can be written as(40)x(t)=w2(t),wherew(t)=w1(t)+iw2(t)is a polynomial with the complex coefficients. This curve is described by the Bernstein–Bézier form as follows(41)w(t)=∑i=0nni(1−t)n−itiwi,wi∈C.Conditions forC1Hermite interpolation(42)x(0)=p0,x′(0)=v0,x(1)=p1,x′(1)=v1,yield four complex quadratic equations which have a solution forn≥3. Hence, forn=3(i.e., the corresponding P-curves is of degree six) we obtain two distinct solutions:(43)w0=p0,w1=6p0+v06p0,w2=±6p1−v16p1,w3=±p1.As in the case of interpolating by planar PH quintics it can be shown that the “more suitable” interpolant is the one with+sign.To sum up, theC1interpolation by planar P-curve is simple and straightforward since it is enough to substitute given Hermite data (in the form of the complex representation of points in the plain) to (43) and obtain the solution. A main drawback of this approach is that the resulting P-curve has degree 6, which could be for some applications considered as too high.However, the degree of the interpolant can be reduced by using P-biarcs, which is a method successfully used for PH curves e.g. in  [34,35]. In particular we construct two quartic P-curves(44)x1(t)=(∑i=022i(1−t)n−itiwi)2,t∈[0,τ],x2(t)=(∑i=022i(1−t)n−itiwi+3)2,t∈[τ,1].which have to satisfy the HermiteC1conditions:(45)x1(0)=p0,x1′(0)=v0,x2(1)=p1,x2′(1)=v1and simultaneously these curves are joining with theC1continuity in a valueτ∈(0,1)of the parametert. This gives two additional conditions(46)x1(τ)=x2(τ),x1′(τ)=x2′(τ).Solving (45) and (46) yields three distinct solutions, however only two of them give a regular P-curve:(47)w0=p0,w1=4p0+v04p0,w2=(τ−1)(±p0v1+p1(4p0+v0))±4p0p14p0p1τ,w3=τ(−p1v0±p0(4p1−v1))−4p0p14p0p1(τ−1),w4=±4p1−v14p1,w5=±p1.And again, the “more suitable” interpolant is the one with+sign.Example 4.1Consider two ringed surfaces given by(48)d1=(2t−6,2t2−5,t3)⊤,ϱ1=t24+1,n1=(1,t,t)⊤,and(49)d2=(3sin(t),t,log(t+1))⊤,ϱ2=t+2,n2=(4,sin(t),t)⊤.We interpolate data (38) by the Ferguson’s cubic and data (39) by the planar P-curve of degree six and compute the corresponding rational parameterization of the resulting ringed surface, see Fig. 3.Remark 4.2We would like to emphasize that using ringed surfaces for the operation of blending significantly extends the family of surfaces (and their mutual positions) which can be blended. For instance, the surfaces from Example 4.1 have to be blended by (non-canal) ringed surface as they are not canal surfaces. Moreover, even when we want to construct blends between two specially situated canal surfaces it may occur a position which cannot be successfully solved by a canal-surface-blend but it is possible to find a suitable ringed-surface-blend, see Fig. 4.In  [22,31], the so called contour curves (see Definition 7.1) on canal surfaces were investigated and used for constructing a whole family of canal surfaces sharing the same silhouette with respect to a parallel projection while only one SOS decomposition was necessary to be found for the computation of their parameterizations. This approach is especially useful for constructing blends satisfying certain constraints, e.g. when avoiding obstacles or bypassing other objects is required. The constructed blending surface can be easily modified only with the help of a certain distance function, see  [31] for more details.When using ringed surfaces for constructing blends with constraints, the situation is significantly easier (without involving contour curves)—the contour curves on ringed surfaces will be discussed in Section  7. The key step of the computation of a parameterization of a curve on a ringed surfaceR(and thus also a parameterization ofR) is the computation of the unit rational vector fieldforthogonal to the orientation functionnofR(cf. (6)). This can be done by decomposing a polynomial/rational function into a sum of squares or by modeling with P-curves. However, this computation step does not depend on the directrixdand thereforedcould be adjusted as the prescribed constraints require. In particular, we construct a new directrix(50)d∗=d+vf,obtained from the original directrixdby adding in a suitable directionvsome (rational) distance functionfcontinuous on(0,1)and satisfying the conditions(51)f(0)=0,f′(0)=0,f(1)=0,f′(1)=0.This distance functionfenables to modify the blending ringed surface in thev-direction. In examples presented in Fig. 5, the following distance function with respect to the vectorv=(0,0,λ)⊤for different values ofτandλwere applied(52)f(t,τ)=(1−t)2t2(t(2−4τ)+τ(5τ−3))(1−τ)3τ3.Example 5.1Consider two normal ringed surfacesR1andR2defined by(53)d1=(sin(t)−4,cos(t),2t−5)⊤,ϱ1=2t−2;d2=(t,−t,sin(t))⊤,ϱ2=3t2,and a prescribed sphere with the center at(−1.4,−0.3,−1.2)⊤and the radius equal to 0.75 (taken as a obstacle). Firstly, we construct a classical blending ringed surface, see Fig. 6. Then we adjust the blend so that it avoids the prescribed sphere, i.e., we modify its directrix according to (50). As the satisfying (not necessary) criterion for blending surface with the directrixd∗and the radius functionϱnot intersecting the sphere centered atsand with the radiusrwe use the following condition(54)‖d∗(t)−s‖>ϱ(t)+r,for allt∈[0,1]. We used the distance function (52) and(55)v=(15,45,35)⊤andτ=12.The new constructed blend does not intersect the sphere (see Fig. 7) since(56)mint∈[0,1](‖d∗(t)−s‖−ϱ(t)−r)≐0.0228>0.The shape variability (especially suitable for modeling purposes) of ringed surfaces can be used when e.g. one wants to optimize (in some sense) the shape of the already constructed blend. As a particular example, we choose a criterion that the shape of the modified blend is as close as possible to the shape of a normal ringed surface. This is a natural criterion from the point of view of practical applications as we would like to avoid the situations when the normalsndiffer too much from the tangents ofd.The presented approach starts with the computation of a blending ringed surface. So, we have the directrixd, orientation functionn, radius functionϱand some functionfsatisfying (6). We construct the new directrixd∗, cf. (50), where the distance function can be chosen as e.g.  (52), or as the following one which is composed of two parts (which enables us again to decrease the degree)(57)f(t,τ)={1τ3t2(3τ−2t),t∈[0,τ],1(1−τ)3(t−1)2(2t−3τ+1),t∈[τ,1],see  [31]. We leave the vectorvand the parameters of the distance function as free parameters and optimize the following objective function(58)∫I((f⋅(d∗)′)2‖f‖2‖(d∗)′‖2+((f×n)⋅(d∗)′)2‖f×n‖2‖(d∗)′‖2)dt,which measures the deviance of the vectors(d∗)′from the vectorsn.Example 5.2Let be given two canal surfacesS1andS2defined by the cubic/quadratic spine curves and the quadratic radius functions(59)m1=(0.3t−1.1,(1.1−0.3t)2−1,(0.3t−1.1)3)⊤,r1=0.03t2−0.22t+0.736667,and(60)m2=(0.3t+2,2(0.3t+1)2,(0.3t+1)2)⊤,r2=0.045t2+0.3t+1.We consider them as ringed surfaces and compute their directrices, orientation functions and radius functions, cf. (1). Then we construct a blending ringed surface, see Fig. 8. Finally involving the distance function (52) (where we setτ=1/2) and minimizing integral (58), we arrive at the vector(61)v≐(−0.23824,−1.04859,0.13459)⊤,yielding a blending ringed surface which is “more normal” than the original one, see Fig. 9. In particular the deviance of the tangents of the directrix from the vectors of the orientation function measured by integral (58) is improved from 0.337 to 0.112.In this section, we will deal with the problem of constructing a blending surface between three or more ringed surfaces. The method is based on choosing an auxiliary sphere and separately constructing blending ringed surfaces between the given ringed surfaces and the sphere by the methods discussed in the previous sections.Consider the (parts of the) three ringed surfacesRi,i=1,2,3given by(62)Ri:(di,ni,ϱi)(t),t∈[0,1].Firstly, we choose an auxiliary sphereSin a suitable position “between”Risimultaneously not intersecting them—e.g., we can choose the centersofSon the line going through the center of the inscribed circle of the triangle joining pointsdi(1)and having the direction vector perpendicular to the plane containing pointsdi(1), i.e.,(63)s=y(1)+α[(d1(1)−d2(1))×(d1(1)−d3(1))],α∈R,where(64)y=d1+(d2−d1)‖d3−d1‖+(d3−d1)‖d2−d1‖‖d2−d1‖+‖d3−d1‖+‖d3−d2‖.The parameterαis set to reflect the angle betweendi′(1)and the plane containing pointsdi(1). The radiusrofShas to be chosen so thatSdoes not intersect any ofRi, i.e.(65)r∈(0,mini=1,2,3{‖di(1)−s‖}).Next, for each ringed surfaceRiwe consider the sphereSas a ringed surfaceSigiven by(66)ni∗=di(1)−s‖di(1)−s‖,di∗=s−rni∗+t(2rni∗),ri∗=r2−‖di∗−s‖2=2rt(1−t).For eachi∈{1,2,3}, this enables to describe the sphereSas a family of circles (denoted bySi) set coherently with the end circles of a particularRi.Now, for eachi∈{1,2,3}we compute a classical blending surfaceBibetweenRiandSisuch that we interpolate Hermite data(67)pi=(di,ni,ϱi)⊤(1),vi=(di′,ni′,ϱi′)⊤(1)pi∗=(di∗,ni∗,ϱi∗)⊤(λi),vi∗=((di∗)′,(ni∗)′,(ϱi∗)′)⊤(λi),whereλi∈(0,1)corresponds to a particular selected circleci∈Siat whichBijoinsSi. Parametersλihave to be chosen so that the circlesci,i=1,2,3, do not intersect each other.Remark 6.1Let us note that in the construction of the multiple blends the position and the radius of the auxiliary sphere (and even the circles on the sphere at which the blend surfaces join it) can be chosen freely (only some natural criteria must be satisfied). Hence the multiple blends can be easily modified according to further prescribed requirements reflecting additional modeling conditions.Example 6.2We construct a blending surface between three given normal ringed surfacesR1,R2andR3given as follows:(68)d1=(14t3−23t2+12t−9,4t−7,0)⊤,ϱ1=16(t+4);d2=(−4t3+4t+6,−2t3+3t2+4t−8,0)⊤,ϱ2=12(2−t2);d3=(0,2t3−5t2+8,2t3−3t2+4t−8)⊤,ϱ3=16(9−4t).We have chosen the auxiliary spheres with the following center and radius(69)s=(0.5,0.3,−0.25)⊤,r=2.6,and all the parametersλiwere set to 0.2, see Fig. 10.Analogously, we can construct generaln-way blends betweennringed surfaces; Fig. 11presents 5-way blend between five given ringed surfaces.We start with investigating contour curves on ringed surfaces and then we focus on computing approximate parameterizations of implicitly given ringed surfaces gained e.g. by some implicit blending techniques.Definition 7.1A contour curveCvwith respect to the vectorvof the ringed surfaceRis a curve onR(different from any of the sweeping circles) consisting of all the points at which the normals ofRare orthogonal tov.A contour curveCvwith respect to the vectorvcorresponds to the silhouette of the given ringed surface when projecting it to the plane with the normal vectorv, see Fig. 12. Without loss of generality, we may assume in what follows thatvis a unit vector. We recall that studying projected contour curves (silhouettes) do not only help to create a first visual perception of the shape of the studied object but they have also many practical applications—for instance, in reconstruction of the 3D object from a 2D image, in rendering, in computing the visible area, when deleting invisible curves, see  [36–38].Contrary to canal surfaces, the expression of contour curves for a general ringed surface is more complicated and contains even nested square roots. More precisely, a parameterization of the contour curve with respect to the vectorvcan be computed as the envelope of the family of ellipses obtained by projecting the family of sweeping circles(70)‖x−d‖2−ϱ2=0,(x−d)⋅n=0in the projectionπv, see (13).Nonetheless, studying the resulting parametric expression in more detail is beyond the scope of this paper. Here we only consider some special cases (special ringed surfaces) having the contour curves without nested square roots in their parametric expressions. One of the special situation occurs when the ellipses (projected characteristic circles in the projectionπv) degenerate to line segments. This happens when the orientation functionnis orthogonal to the directionvof the projectionπv.Consider a ringed surfaceR:(d,n,ϱ)and a vectorvfor which the following condition holds(71)n⋅v≡0.Then the orthogonal projectionπvsends the generating circles ofRto the line segments and the contour curve ofRwith respect tovis of the form(72)cv±=d±ϱn×v‖n‖.Thus we can formulate the following proposition.Proposition 7.2Consider a vectorvand a ringed surfaceR:(d,n,ϱ)with the orientation function satisfying   (71). ThenRpossesses a rational contour curve with respect tovif and only if the orientation functionncorresponds to a P-curve.Corollary 7.3Any normal ringed surface with the directrix being a quadratic PH curve possesses a rational contour curve.The usefulness of the contour curves on ringed surfaces can be demonstrated on the problem of approximating implicitly given blends by a rational ringed surface. Let be given two normal ringed surfacesR1andR2(e.g. cones or cylinders of revolution) implicitly determined by polynomialsf1andf2, and bounded by planesP1andP2(perpendicular to their directrices) described by linear polynomialsf10andf20, respectively. In  [24], an implicit blending surfaceBbetweenR1andR2(and joiningR1andR2along the circles lying inP1andP2, respectively) is constructed and described by the polynomial(73)f=f1(1−λ)f20n+1−f2λf10n+1,whereλ∈(0,1)andn∈N. Now, a practical problem can be formulated as follows: Construct a rational approximation of this implicitly given blending surface by some suitable rational ringed surface.We recall that in  [26] a method for computing approximate parameterizations of implicitly given canal surfaces based on approximating their contour curves by polynomial cubics was introduced and in  [27] improved. The algorithm from  [27] starts with computing the polynomial cubic approximate parameterizations of three different contour curves of the given canal surfaceS. From these parameterizations an approximation of the spine curve (also polynomial of degree 3) ofSis reconstructed and consequently an approximate parameterization ofSis computed.An analogous approach can be used for computing approximate parameterizations of implicitly given ringed surfaces. We also (approximately) parameterize three different contour curves on the given ringed surfaceBand reconstruct an approximation of the directrix and the orientation function from these parameterizations.In the case of canal surfaces the contour curves possess a special feature—in particular for a contour curvecvwith respect tovon a canal surfaceSthe equality(74)(cv−m)⋅v=0holds, wheremis the spine curve ofS. This feature allows us to compute easily the parameterization of the spine curve from the parameterizations of three different contour curvescv1,cv2andcv3, i.e.,(75)m=(v1v2v3)−1(v1⋅cv1v2⋅cv2v3⋅cv3).However, this advantageous feature is not satisfied for general ringed surfaces. So one can ask: Why to use the contour curves (in the case of ringed surfaces) while any arbitrary curve onBcan be used instead with the same effect? Nonetheless the answer is simple: When a ringed surface is given by its implicit equationf(x)=0then the contour curve with respect tovis determined as the complete intersection of two algebraic surfaces defined by the polynomials(76)f(x)andfv(x)=∇f(x)⋅v,where∇fstands for the gradient off.We start with choosing three different contour curvesCv1,Cv2andCv3onB. Then we compute the intersection pointspi1,…,pikiof the planeP1and the contour curvesCvi, i.e., we solve the following system of equations(77)f10=0,f=0,fvi=0,i=1,2,3.Analogously by solving(78)f20=0,f=0,fvi=0,i=1,2,3,we obtain the intersection pointsqi1,…,qikiof the planeP2and the contour curveCvi. Then we choose pointspi∈{pi1,…,piki}andqi∈{qi1,…,qiki}such thatpiqilie on the same branch of the contour curveCvi—this can be done e.g. by considering a topology (constructing topological graphs) of the contour curves, for more details see  [26,39].Frompiandqi,i=1,2,3, the centers of the characteristic circless1ands2can be reconstructed. In particular the center of the circle passing through the pointspiis computed as follows(79)s=p1+p22+(a⋅b)−‖b‖22‖a×b‖2((a⋅b)a−‖a‖2b),wherea=p2−p1andb=p3−p1. Then we construct an auxiliary approximationd¯of the directrix curve ofBby interpolating pointss1ands2with the tangent vectors being the normal vectors of the planesP1andP2by the Ferguson’s cubic. The lengths ofn1andn2are chosen e.g. according to the distance ofs1ands2; our tests show that using the lengths ofn1andn2both equal to this distance works sufficiently.Now we compute approximate parameterizationscv1,cv2andcv3of the particular branches of the contour curvesCv1,Cv2andCv3so that we construct the Ferguson’s cubics joining the pointspiandqiwith the tangent vectorsαitpiandβitqiwith the lengthsαiandβias free parameters, where(80)txi=∇f(xi)×∇fvi(xi)‖∇f(xi)×∇fvi(xi)‖.Finally we compute the “optimal” values of the free parametersαiandβiby minimizing the following objective function(81)Ω=Φ(f,fv1,cv1)+Φ(f,fv2,cv2)+Φ(f,fv3,cv3)+wΨ(d¯,cv1−cv2,cv1−cv3),wherewis a suitable weight, the objective function(82)Φ(f,g,c)=∫If2(c)‖∇f(c)‖2+g2(c)‖∇g(c)‖2dtis responsible for the deviance of the approximate parameterizationcfrom the implicit representationf=g=0, and the objective function(83)Ψ(n,a,b)=∫I(a⋅n)2‖a‖2‖n‖2+(b⋅n)2‖b‖2‖n‖2dtmeasures the deviance of the approximation of the normal vector of the plane spanned by the vectorsa,bfrom the vectorn.Remark 7.4When the blend, which shall be approximated, is of a more complex shape, then the refinement can be done to increase the accuracy. The input blending surface is divided into a suitable number of parts by cutting it by planesPτi,τi∈(0,1), where(84)Pτi:d¯′(τi)⋅(x−d¯(τi))=0.Then each part of the blending surface is approximated analogously as we discussed above.Remark 7.5Let us note that it is enough to use only two contour curves in the parameterization process. Since contour curves possess two branches in general, we can work with the two real branchescv1±of one contour curveCv1and one real branchcv2+of another contour curveCv2.Example 7.6We compute an approximate parameterization of the ringed surfaceBdefined by the polynomialf, see Fig. 13, obtained by the method from  [24], cf.  (73), as an implicit blending surface between the cylinders given by(85)f1=y2+z2−9,f2=x2−2xy−12x+y2+12y+2z2+28,bounded by the planesf10=x=0andf20=x+y=10, respectively. We start with computing approximate parameterizations of the contour curves with respect to the vectors(86)v1=(0,0,1)⊤,v2=(0,1,0)⊤,v3=(0,12,12)⊤.From these parameterizations we reconstructdandn. Finally, we compute the approximate parameterization ofBby using one of the curvescviand formula (3). The error of the approximation measured by the integral(87)∫I∫Jf2(s(t,u))‖∇f(s(t,u))‖2dudtis less than2.1⋅10−2when using parameterization of one part and3.7⋅10−4when using parameterizations of two parts.

@&#CONCLUSIONS@&#
