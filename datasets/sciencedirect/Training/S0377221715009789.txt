@&#MAIN-TITLE@&#
Fundamental properties and pseudo-polynomial-time algorithm for network containership sailing speed optimization

@&#HIGHLIGHTS@&#
Analytical solution for speed optimization of a single ship route.Bi-section search for the optimal number of ships on a route.Pseudo-polynomial-time algorithm for optimal speeds in a network.

@&#KEYPHRASES@&#
Transportation,Liner shipping,Containership,Sailing speed,Bunker fuel,

@&#ABSTRACT@&#
In container liner shipping, bunker cost is an important component of the total operating cost, and bunker consumption increases dramatically when the sailing speed of containerships increases. A higher speed implies higher bunker consumption (higher bunker cost), shorter transit time (lower inventory cost), and larger shipping capacity per ship per year (lower ship cost). Therefore, a container shipping company aims to determine the optimal sailing speed of containerships in a shipping network to minimize the total cost. We derive analytical solutions for sailing speed optimization on a single ship route with a continuous number of ships. The advantage of analytical solutions lies in that it unveils the underlying structure and properties of the problem, from which a number of valuable managerial insights can be obtained. Based on the analytical solution and the properties of the problem, the optimal integer number of ships to deploy on a ship route can be obtained by solving two equations, each in one unknown, using a simple bi-section search method. The properties further enable us to identify an optimality condition for network containership sailing speed optimization. Based on this optimality condition, we propose a pseudo-polynomial-time solution algorithm that can efficiently obtain an epsilon-optimal solution for sailing speed of containerships in a liner shipping network.

@&#INTRODUCTION@&#
Liner shipping companies deploy containerships on regularly scheduled services to transport containers. Unlike tramp shipping, containerships in liner shipping have to sail according to the planned schedule no matter whether they are fully loaded or not (Christiansen, Fagerholt, & Ronen, 2004, 2013). Once designed, the liner services are operated for a period of three to six months. Therefore, it is important for liner shipping companies to design efficient services as a large proportion of the total operating cost is fixed once the services are designed (Brouer, Alvarez, Plum, Pisinger, & Sigurd, 2014; Mulder & Dekker, 2014; Ng, 2014; Plum, Pisinger, & Sigurd, 2014; Zheng, Sun, & Meng, 2014).Bunker cost is a significant component in the total operating cost of a liner shipping company. Ronen (2011) estimated that when bunker fuel price is around 500 dollars/ton, the bunker cost constitutes about three quarters of the operating cost of a large containership. In 2011, the bunker price in Singapore reached 647 dollars/ton (UNCTAD, 2012). On 10 March 2015, the bunker price at Rotterdam dropped to 296 dollars/ton (Bunkerworld, 2015), which considerably cut down the costs for liner shipping companies.The bunker consumption is largely affected by the sailing speed of containerships. When the speed increases, the bunker consumption increases more than linearly. Studies usually assume that daily bunker consumption is approximately proportional to the sailing speed cubed (or bunker consumption per unit of distance is proportional to the sailing speed squared). Wang and Meng (2012) calibrated the exponent to be between 2.7 and 3.3 using historical operating data of containerships, which supports the power of three approximations. Suggested by a ship engine manufacturing company, Du, Chen, Quan, Long, and Fung (2011) adopted the exponent of 3.5 for feeder containerships, 4 for medium-sized containerships, and 4.5 for jumbo containerships. Kontovas and Psaraftis (2011) suggested using an exponent of 4 or greater when the speed of containerships is greater than 20 knots. As a result of the high bunker price and the sensitivity of bunker consumption on sailing speed, slow-steaming is a common technique to curb bunker consumption. After 2007, many liner shipping companies adopted the slow-steaming strategy to reduce bunker expenditure (UNCTAD, 2011). However, shippers are unhappy about slow steaming because it increases the transit time of cargoes from origin to destination.In fact, on one hand, slow-steaming reduces bunker consumption and thereby bunker cost; on the other hand, it also decreases the effective shipping capacity and increases the transit time. Liner shipping companies usually provide a weekly service frequency, which means that each port of call is visited on the same day every week (Bell, Liu, Angeloudis, Fonzone, & Hosseinloo, 2011; Brouer et al., 2011, 2013). For example, Fig. 1shows the North & Central China East Coast Express (NCE) operated by Orient Overseas Container Line (OOCL, 2013) which has a weekly frequency, meaning that the round-trip journey time (weeks) is equal to the number of ships deployed. For example, the round-trip journey time of NCE is 63 days, and hence 9 ships should be deployed to maintain a weekly service. If, for example, slow-steaming increases the round-trip journey time to 70 days, then 10 ships must be deployed, which leads to higher ship operating costs (manning, maintenance, insurance, consumables, etc.). Moreover, slow-steaming results in a longer transit time of containers. Consequently, the inventory cost for customers will be higher. For instance, Notteboom (2006) estimated that one day delay of a 4000-TEU (20-foot equivalent unit) ship implies a total cost of 57,000 Euros associated with the cargos in the containers. Therefore, liner shipping companies must design the speed to balance the trade-off between ship cost, bunker cost, and inventory cost.It should be noted that a more straightforward approach for shipping lines is to set a maximum transit time for each port pair. The maximum transit time approach and the inventory costs approach have similarities and differences. On one hand, we could consider the maximum transit time as a “soft” constraint in some cases: a 30 days’ maximum transit time does not mean there are no cargoes when the real transit time is 30.1 days, but means there are fewer cargoes due to customers’ loss. Similarly, a 30 days’ maximum transit time does not mean there is no difference for the customers whether the real transit time is 29 days or 1 day. In the maximum transit time approach, if we penalize transit time longer than the maximum one and reward shorter transit time, the model will be the same as the inventory cost approach where the inventory cost rate is equal to the penalty rate and the reward rate. In fact, both Alvarez (2012) and Kim (2014) have used the inventory costs as a surrogate for level of service provided by shipping lines. On the other hand, if we treat the maximum transit time as a “hard” constraint to account for perishable products, then the shipping line will not provide a very short transit time even when the bunker price is low because nothing is gained by fast steaming. By contrast, when the bunker price is low, in the inventory costs approach the speed will be higher than that in the maximum transit time approach because the inventory cost implicitly assumes that the liner shipping company gains more revenue when the transit time is shorter by charging a higher freight rate or receiving more demand from customers.There are a number of studies that are devoted to the optimization of sailing speed in different contexts of maritime transportation: shipping network design (Alvarez, 2009), ship fleet deployment (Gelareh & Meng, 2010; Meng & Wang, 2010), ship schedule construction (Bell & Bichou, 2008; Qi & Song, 2012), selection of bunkering port and volume (Kim, 2014; Yao, Ng, & Lee, 2012), emission control (Kim, Chang, Kim, & Kim, 2012, 2013; Kontovas & Psaraftis, 2011; Psaraftis & Kontovas, 2010, 2013), berth allocation (Du et al., 2011; Zhen, Chew, & Lee, 2011a, 2011b), and minimizing bunker cost (Fagerholt, Laporte, & Norstad, 2010; Hvattum, Norstad, Fagerholt, & Laporte, 2013; Kim, 2014; Kim, Kim, & Lee, 2014; Norstad, Fagerholt, & Laporte, 2011; Ronen, 2011; Wang & Meng, 2012). These studies have developed various mathematical models and optimization algorithms. Fagerholt et al. (2010) and Norstad et al. (2011) discretized the possible sailing speed and used dynamic programming to find the optimal speed to adopt in a tramp shipping environment. Du et al. (2011) investigated a joint berth allocation and speed optimization problem. They transformed the power relation between sailing speed and bunker consumption rate to second-order cone programming (SOCP) constraints and took advantage of state-of-the-art solvers to solve the SOCP problem. Wang and Meng (2012) generated piecewise linear functions and developed a mixed-integer linear programming approximation model to optimize the speed of containerships in a liner shipping network with container routing. Yao et al. (2012) studied not only the speed of containerships, but also the selection of bunkering ports and the amount of bunker to take at the refill port. They discretized the sailing speed into many small intervals and introduced binary decision variables to indicate the adopted sailing speed interval. Kim (2014) addressed a similar problem to Yao et al. (2012) by presenting an interesting Lagrangian heuristic.Our study aims to bridge the gap in the literature in three aspects. First, not many prior studies have considered the level of service provided to customers. The level of service can be formulated as maximum transit time (Karsten, Pisinger, Ropke, & Brouer, 2015), or time window (Fagerholt et al., 2010; Hvattum et al., 2013; Norstad et al., 2011), or cargo inventory costs (Alvarez, 2012; Kim, 2014). We will use the cargo inventory costs as the surrogate for level of service. Second, many of the existing studies focus on just one route, and we will examine a shipping network consisting of a number of routes. Third, unlike the literature that uses numerical or approximate solution approaches, we develop analytical solutions and a pseudo-polynomial-time epsilon-optimal solution algorithm.The objective of this paper is to develop mathematical models and analyze fundamental properties of network containership sailing speed optimization that minimizes the sum of ship cost, bunker cost, and inventory cost. We derive analytical solutions for sailing speed optimization on a single ship route with a continuous number of ships, i.e., an explicit relation between the input and the ouput of the (continuous) number of ships. The advantage of analytical solutions lies in that it unveils the underlying structure and properties of the problem, from which a number of valuable managerial insights can be obtained. Based on the analytical solution and the properties of the problem, the optimal integer number of ships to deploy on a ship route can be obtained by solving two equations, each in one unknown, using a simple bi-section search method. The properties further enable us to identify an optimality condition for network containership sailing speed optimization. Based on this optimality condition, we propose a pseudo-polynomial-time solution algorithm that can efficiently obtain an epsilon-optimal solution for sailing speed of containerships in a liner shipping network.The remainder of this paper is organized as follows. Section 2 examines a single ship route assuming that the number of ships can be a fractional quantity. Section 3 investigates a single ship route with an integer number of ships. Section 4 derives the optimality condition and a pseudo-polynomial-time algorithm for network containership sailing speed optimization with a limited number of available ships. Section 5 reports a case study to demonstrate the applicability of the proposed algorithm. Conclusions are presented in Section 6.We first examine a single ship route such as the NCE service shown in Fig. 1. To begin with, we assume that the number of ships deployed on it, denoted by m, can be a fractional number.The itinerary of the liner ship route forms a directed loop and a string of homogeneous containerships are deployed to maintain a weekly frequency. The ship route can be represented by its port calling sequence –1 → 2, →⋅⋅⋅ → N → 1 – where the number 1 denotes its first port of call and N is the number of ports of call, and these ports of call are grouped into a setI:={1,2,…,N}. The voyage between two consecutive ports of call on the liner ship route is referred to as a leg. The ith leg is defined as the voyage from the ith port of call to the(i+1)thport of call wheni=1,2,…,N−1and the Nth leg is from the Nth port of call to the 1st port of call. The distance of the ith leg is denoted by Li(n mile).Represent by α(dollars/ton) the price of bunker for the main engine and let c (dollars/week) be the fixed operating cost of a ship (excluding bunker cost for the main engine). Represent further byT^(hours) the total time spent at ports during a round-trip journey. The sum ofT^and sailing time at sea is the round-trip journey time. We denote by hi(dollars/hour) the inventory cost rate of containers on leg i. We note that hidepends on (i) the volume of containers on the leg, (ii) the value of the cargo per container, (iii) the characteristics of the cargo (e.g. the value of cargos with a short life-cycle depreciates fast), and (iv) the priority of customers’ inventory cost on the liner shipping company's planning decision. The bunker consumption function on the ith leg, denoted by gi(vi) (tons/nautical mile), is dependent on the sailing speed viand has the following form when the speed is within the range of acceptable speeds:(1)gi(vi)=ai(vi)bi,∀i∈Iwhere ai> 0, bi> 1 are two parameters calibrated from historical operating data and depend on the cargo load and sea conditions (Ronen, 2011; Wang & Meng, 2012).The speed optimization problem aims to determine the number of ships m to deploy and the sailing speed vion each leg to minimize the total operating cost including ship cost, bunker cost, and inventory cost, while maintaining a weekly frequency. For the ease of presentation, we use the sailing timeti:=Li/vion leg i as the decision variable. The bunker consumption per nautical mile on leg i then becomesai(Li/ti)bi. The speed optimization problem can be formulated as a nonlinear optimization model:(2)[P1]minti,mcm+α∑i∈ILiai(Li/ti)bi+∑i∈Ihitisubject to:(3)∑i∈Iti−168m=−T^(4)ti≥0,∀i∈I(5)m≥0The objective function (2) minimizes the total cost. Constraint (3) imposes the weekly frequency where the coefficient 168 means that each week has 168 hours. Constraints (4) and (5) enforce nonnegativity of variables.To analyze the properties of the optimal solution to the nonlinear model [P1], we derive its KKT conditions. Let λ, πiand θ be the Lagrangian multiplier associated with Eqs. (3)–(5), respectively. Since all of the constraints (3)–(5) are linear, the linearity constraint qualification holds. As a result, the optimal solution to [P1] must satisfy the KKT conditions below (Boyd & Vandenberghe, 2004):[KKT](6)c−168λ−θ=0(7)α(Li)bi+1ai(−bi)(ti)−bi−1+hi+λ−πi=0,∀i∈I(8)πiti=0,∀i∈I(9)θm=0(10)πi≥0,∀i∈I(11)θ≥0(12)∑i∈Iti−168m=−T^(13)ti≥0,∀i∈I(14)m≥0where Eqs. (6) and (7) are the KKT equations, Eqs. (8) and (9) are complementary slackness conditions, Eqs. (10) and (11) are nonnegativity constraints on Lagrangian multipliers, and Eqs. (12)–(14) impose feasibility of the solution.Evidently, at the optimal solution we must have ti> 0, i ∈ I and m > 0. Therefore, the complementary slackness conditions (8) and (9) imply thatπi=0,i∈Iandθ=0, respectively. According to Eq. (6), we obtain(15)λ=c168Eq. (7) becomes:(16)ti=Li(hi+c/168αaibi)−1bi+1Equivalently,(17)vi=(hi+c/168αaibi)1bi+1The optimal number of ships m can be derived from Eqs. (12) and (16):(18)m=T^+∑i∈Iti168=T^+∑i∈ILi(hi+c/168αaibi)−1bi+1168Note that by assumption, m can be a fractional number.The close-form expressions (16)–(18) of the optimal solution enable us to analyze useful managerial insights. First, Eq. (17) demonstrates that even if aiand bido not change with voyage leg, the optimal speeds on different legs are still different due to the inventory cost. If the inventory cost is not considered, but a maximum transit time or port time windows are considered, the sailing speeds on different legs will also be different.Second, we notice that the optimal speed on a leg viincreases with the inventory cost rate hiand the ship operating cost c, and decreases with the bunker price α and the bunker consumption coefficient ai. This means that, for example, a lower bunker price and more valuable cargos should lead to a higher speed. However, the relation is not linear and depends on the coefficient bi. When the daily bunker consumption is proportional to the sailing speed cubed, we will havebi=2. In this case, if the bunker price is increased by 50 percent, the resulting optimal speed should be(1/1.5)1/3=0.87times the original speed. In other words, the sailing time at sea is 1.14 times as long as before. Take the NCE service in Fig. 1 as an example. Its round-trip journey time is 63 days and 9 ships are deployed. Suppose that in a round-trip journey, 2 weeks are port time and 7 weeks are sailing time. When the bunker price is increased by 50 percent, the sailing time should be increased to 7 × 1.14=7.98 weeks. This suggests that one more ship should be inserted to the existing string (service) of 9 ships.The optimal speed vialso decreases with the coefficient bi, which can be shown below. The term(hi+c/168)/(αaibi)in Eq. (17) is greater than 1 in practice (otherwise the optimal speed is less than 1 knot). Hence, for two different bi's satisfying 1 < bi1 < bi2, the following relation holds:(19)vi1=(hi+c/168αaibi1)1bi1+1>(hi+c/168αaibi2)1bi1+1>(hi+c/168αaibi2)1bi2+1=vi2The first “>” is correct becausey=x1/(bi1+1),x>0is an increasing function of x. The second “>” is correct becausey=px,p>1,x>0is an increasing function of x. Therefore, the optimal speed videcreases with both aiand bi.Third, the optimal speed vihas a marginal cost explanation. Suppose that the optimal sailing time on leg i is increased by a small value Δt > 0. Then the ship cost and inventory cost on the leg will increase by(20)c168Δt+hiΔtAt the same time, the speed will be reduced and the bunker cost on the leg will be reduced by(21)|d[αLiai(Li/ti)bi]dti|Δt=αaibi(Li)bi+1(ti)−bi−1ΔtReplacing tiin Eq. (21) by Eq. (16), the bunker cost will be reduced by(22)(c168+hi)Δtwhich is identical to Eq. (20). This implies the marginal cost of adding/reducing sailing time on a leg is 0 in the optimal solution.Fourth, we notice that the optimal sailing speed of a leg in Eq. (17) is independent of parameters on other legs. We stress that this results from the assumption that m can be a fractional number. It has the following implication. In [P1] we do not impose an upper limit on the sailing speed although in reality each ship has a maximum speed. This assumption is reasonable when containerships do not sail at the highest speed during periods of high bunker prices and oversupply of ship capacity. When the bunker price is low, the inventory costs are high, and the maximum sailing speed of ships is low, it is possible that the calculated speed of a leg exceeds the maximum sailing speed. In this case, we simply need to set the speed for that leg to the highest sailing speed and reoptimize the speed for other legs. The fact that the optimal sailing speed of a leg is independent of parameters on other legs means that such a simple revision leads to an optimal solution.In reality, the number of ships m must be an integer. A natural question is, what is the integer number of ships that should be deployed if the optimal number of ships computed in [P1], denoted by m*, in not an integer? What ifm*=5.3is obtained? What ifm*=5.5and what ifm*=5.9? One might conjecture that 5 ships should be deployed ifm*=5.3, 6 ships should be deployed ifm*=5.9, and it makes no difference whether 5 or 6 ships are deployed ifm*=5.5. Unfortunately, this conjecture is incorrect.We first develop a method for computing the optimal sailing time tiwith a given number of ships m. Asm=(T^+∑i∈Iti)/168, we rewrite Eq. (2) as the summation of cost (ship cost, bunker cost and inventory cost) associated with each leg and consider tias the decision variable:(23)minti>0T^c168+∑i∈I[ti168c+α(Li)1+biai(ti)−bi+hiti]Note that the first term in Eq. (23) is constant. We define(24)ci(ti):=ti168c+α(Li)1+biai(ti)−bi+hiti,∀i∈IGiven the number of ships m, to minimize the total cost, we can formulate the following model by removing the constant term in Eq. (23):(25)[P2(m)]:C(m):=minti>0∑i∈Ici(ti)subject to:(26)∑i∈Iti=168m−T^In the sequel, whenever we mention the total cost, we refer to the objective function Eq. (25) that has already excluded the constant term. Let λ be the Lagrangian multiplier associated with constraint (26). The KKT condition of model [P2(m)] is:(27)dci(ti)dti+λ=0,∀i∈I(28)∑i∈Iti=168m−T^Eqs. (24) and (27) imply that(29)c168+hi−α(Li)1+biaibi(ti)−bi−1=−λ,∀i∈IThe left-hand side is |I| expressions that are all equal to−λ. Therefore, any of the two expressions are equal and equal to the first expressionc/168+h1−α(L1)1+b1a1b1(t1)−b1−1. Hence, all the tican be expressed as functions of the sailing time on the first leg t1:(30)c168+hi−α(Li)1+biaibi(ti)−bi−1=c168+h1−α(L1)1+b1a1b1(t1)−b1−1,∀i∈I(31)ti=[hi−h1+α(L1)1+b1a1b1(t1)−b1−1α(Li)1+biaibi]−1bi+1,∀i∈ISubstituting Eq. (31) into Eq. (28), we have(32)∑i∈I[hi−h1+α(L1)1+b1a1b1(t1)−b1−1α(Li)1+biaibi]−1bi+1=168m−T^The left-hand side of Eq. (32) is a function that is strictly increasing with t1. Therefore, bi-section search method could efficiently find the solution to Eq. (32), which is also the optimal solution to [P2(m)].In sum, given the number of ships, the optimal sailing time on each leg and the minimum total operating cost can easily be obtained by a bi-section search process (Fox & Landi, 1970).We then analyze the property of the function ci(ti) in Eq. (24). Its first, second, and third derivatives are respectively:(33)ci′(ti)=c168+hi−α(Li)1+biaibi(ti)−bi−1,∀i∈I(34)ci′′(ti)=(bi+1)α(Li)1+biaibi(ti)−bi−2,∀i∈I(35)ci′′′(ti)=−(bi+2)(bi+1)α(Li)1+biaibi(ti)−bi−3,∀i∈ILetti*be the optimal solution shown in Eq. (16) to model [P1]. It is easy to see thatti*is also a stationary point of ci(ti), i.e.,(36)ci′(ti*)=0,∀i∈IMoreover, as ti> 0, we have(37)ci′′(ti)>0,∀i∈I(38)ci′′′(ti)<0,∀i∈IEq. (37) implies that ci(ti) is a strictly convex function. Eqs. (37) and (38) imply thatci′(ti)is a strictly increasing and strictly concave function, as shown in Fig. 2. Therefore, we have(39)ci′(ti*+Δt)>0,∀Δt>0(40)ci′(ti*−Δt)<0,∀0<Δt<ti*(41)|c′i(ti*−Δt)|>ci′(ti*+Δt),∀0<Δt<ti*Eqs. (39)–(41) imply that ci(ti) increases faster when tiis decreased fromti*toti*−Δtthan when tiis increased fromti*toti*+Δt,0<Δt<ti*. In other words, the total cost is more sensitive when the sailing time is reduced than when it is increased. Mathematically, we writeci(ti*−Δt)andci(ti*+Δt)using Taylor theorem:(42)ci(ti*−Δt)=ci(ti*)+c′i(ti*)1!(−Δt)+c′′i(ti*)2!(−Δt)2+c′′′i(ti*−h1Δt)3!(−Δt)3,h1∈[0,1](43)ci(ti*+Δt)=ci(ti*)+c′i(ti*)1!Δt+c′′i(ti*)2!(Δt)2+c′′′i(ti*+h2Δt)3!(Δt)3,h2∈[0,1]Note thatci′(ti*)=0. Hence,(44)ci(ti*−Δt)−ci(ti*+Δt)=−c′′′i(ti*−h1Δt)3!(Δt)3−c′′′i(ti*+h2Δt)3!(Δt)3Eqs. (38) and (44) imply that(45)ci(ti*−Δt)>ci(ti*+Δt),∀0<Δt<ti*as shown in Fig. 3.Recall that C(m) is the optimal objective value of [P2(m)] in Eq. (25), which is the minimum total cost of the ship route if m ships are deployed on it. Let m* andti*be the optimal solution to [P1] (m* may be a fractional number), andt¯ibe the optimal solution to [P2(m)].Theorem 1[P2(m)] has the following properties:(i)t¯istrictly increases with m. In particular, if m < m*, thent¯i<ti*,∀i∈I; if m > m*, thent¯i>ti*,∀i∈I.If m < m*,C(m) strictly decreases with m; if m > m*,C(m) strictly increases with m.For 0 < Δm < m, we haveC(m−Δm)+C(m+Δm)>2C(m).For 0 < Δm < m*, we haveC(m*−Δm)>C(m*+Δm).The proof of Theorem 1 can be found in Appendix A.The form of C(m) is similar to ci(ti), and is shown in Fig. 4.Theorem 2Let m* be the optimal solution to [P1]. We assume that m* is not an integer. We further assume that m* > 1 because otherwise it is evident that one ship should be deployed. Define ⌊x⌋ to be the largest integer not greater than x. Then, (i) ifm*−⌊m*⌋≥0.5, deploying⌊m*⌋+1ships is the unique optimal integer solution; (ii) if0<m*−⌊m*⌋<0.5, it is possible that deploying⌊m*⌋+1ships is still preferable to ⌊m*⌋ ships.The proof of Theorem 2 can be found in Appendix B.When0<m*−⌊m*⌋<0.5, to find the optimal integer number of ships to deploy, we need to solve two problems [P2(⌊m*⌋)] and [P2(⌊m*⌋+1)]. Note that to solve each problem, only a one-dimensional bi-section search is needed.This section extends a single ship route to a liner shipping network that consists of many ship routes such as the one shown in Fig. 5. Moreover, in contrast to the previous two sections that assume an unlimited number of ships available, here we consider a limited number of available ships in the ship fleet of the liner shipping company.The set of ship routes is denoted by R and the legs on ship route r ∈ R are denoted by set Ir. The distance of leg i ∈ Irof ship route r is Lri, the sailing speed on the leg is denoted by vri, and the inventory cost rate is hri. The sailing time istri=Lri/vri. The fixed port time on ship route r isT^rand a total of mrships are deployed to maintain a weekly frequency. Both mrand triare decision variables.Different ship routes may have different types of ships. We let V be the set of ship types. We assume that a limited number of Mvships in type v ∈ V are available. The fixed operating cost of a ship in type v is denoted by cv. Moreover, we represent by Rvthe set of ship routes that use ships in type v. The bunker consumption function on leg i ∈ Irof ship route r ∈ R isgri(vri)=ari(vri)bri.The speed optimization problem for a liner shipping network can be formulated as a mixed-integer nonlinear optimization model with variables mrand tri:(46)[P3]mintri,mr∑v∈V∑r∈Rvcvmr+α∑r∈R∑i∈IrLriari(Lri/tri)bri+∑r∈R∑i∈Irhritrisubject to:(47)∑i∈Irtri−168mr=−T^r,∀r∈R(48)∑r∈Rvmr≤Mv,∀v∈V(49)tri≥0,∀r∈R,∀i∈Ir(50)mr≥1andinteger,∀r∈Rwhere constraint (48) requires that the number of ships in each type used cannot exceed the number of available ships in the fleet.It is not difficult to see that [P3] can be decomposed for each ship type v ∈ V:(51)[P3−v]mintri,mr∑r∈Rvcvmr+α∑r∈Rv∑i∈IrLriari(Lri/tri)bri+∑r∈Rv∑i∈Irhritrisubject to:(52)∑i∈Irtri−168mr=−T^r,∀r∈Rv(53)∑r∈Rvmr≤Mv(54)tri≥0,∀r∈Rv,∀i∈Ir(55)mr≥1andinteger,∀r∈RvLetmr*be the optimal number of ships obtained by model [P1] for ship route r ∈ Rvandmr*may not be an integer. Provided that there are sufficient ships, the optimal integer number of ships for ship route r, denoted bym˜r, can easily be obtained according to Section 3. Note that if there are two optimal integer solutions, i.e.,⌊mr*⌋and⌊mr*⌋+1, the method in Section 3 can find both solutions and we definem˜ras the smaller one, i.e.,⌊mr*⌋. If∑r∈Rvm˜r≤Mv, then(m˜r,r∈Rv)is the optimal solution to [P3-v]. Otherwise, in model [P3-v], constraint (53) must be binding at the optimal solution.Now we investigate the optimal number of ships on each ship route when∑r∈Rvm˜r>Mv. Similar to C(m) in Eq. (25), we define function Cr(m) as the minimum total cost of ship route r ∈ Rvif m ships are deployed on it.[P3-v] can thus be reformulated as:(56)[P4−v]minmr∑r∈RvCr(m)subject to:(57)∑r∈Rvmr≤Mv(58)mr≥1andinteger,∀r∈RvTheorem 3Assuming that∑r∈Rvm˜r>Mvwherem˜ris the optimal integer number of ships for ship route r provided that there are sufficient ships, a solution denoted by(m^r,r∈Rv)to [P4-v] when there are only Mv ships is optimal if and only if it satisfies the following condition: For any two ship routes r1 ∈ Rv, r2 ∈ Rv such thatm^r1≥2, we haveCr1(m^r1−1)−Cr1(m^r1)≥Cr2(m^r2)−Cr2(m^r2+1). In other words, shifting one ship from ship route r1to ship route r2cannot reduce the total cost.The proof of Theorem 3 can be found in Appendix C.It should be noted that even if the optimal integer solution to [P1] is unique, the optimal solution to [P4-v] may not be unique. For instance, suppose that a total of 7 ships are available and Rvconsists of two identical ship routes, and the optimal integer number of ships on each ship route is 5. Hence, there are two optimal solutions: one ship route has 3 ships, the other has 4; or vice versa. We further have the property:Theorem 4The optimal solution(m^r,r∈Rv)to model [P4-v] satisfiesm^r≤m˜r, r ∈ Rv.The proof of Theorem 4 can be found in Appendix D.Based on the above optimality condition, we develop a pseudo-polynomial-time algorithm for solving the mixed-integer nonlinear programming model [P3-v] or [P4-v] for network containership sailing speed optimization.A pseudo-polynomial-time algorithm for solving [P3-v]:Step 1. For each ship route r ∈ Rv, compute the optimal number of shipsmr*by model [P1]. Ifmr*is an integer, setm˜r:=mr*; else ifmr*<1, setm˜r:=1; else ifmr*−⌊mr*⌋≥0.5, setm˜r:=⌊mr*⌋+1; else, solve the two models [P2(⌊mr*⌋)] and [P2(⌊mr*⌋+1)] for the ship route using bi-section search and setm˜r:=⌊mr*⌋ifCr(⌊mr*⌋)≤Cr(⌊mr*⌋+1)and setm˜r:=⌊mr*⌋+1otherwise.Step 2. If∑r∈Rvm˜r≤Mv, then(m˜r,r∈Rv)is the optimal solution to [P3-v] and stop. Otherwise compute Cr(m) for each ship route r ∈ Rvand eachm=⌈T^r/168⌉,⌈T^r/168⌉+1,…,m˜r−1where ⌈•⌉ is the smallest integer greater than or equal to •, setCr(m˜r+1)=+∞, r ∈ Rv, and definem^r:=m˜r, r ∈ Rv.Step 3. Find one ship route r* satisfying(59)r*∈argminr∈Rv,m˜r≥2[Cr(m^r−1)−Cr(m^r)]That is, reducing one ship on ship route r* leads to the smallest increase in the total cost. Setm^r*:=m^r*−1Step 4. If∑r∈Rvm^r≤Mv,(m^r,r∈Rv)is the optimal solution and stop. Otherwise go to Step 3. □We note that to solve [P2(m)] using bi-section search, we can specify a predetermined tolerance for tr1 (the sailing time on leg 1 of ship route r) denoted by ɛ. Since the domain of tr1 is a subset of (0, 168M), the bi-section search method ends in log2(168M/ɛ) iterations. In each iteration we need to calculate the sailing time for |Ir| legs (i.e., the number of legs that the route consists of). Therefore, the time required for solving [P2(m)] is bounded by O(|Imax |log2(168M/ɛ)), where |Imax | is the maximum number of legs a route contains. The optimal number of ships in [P1] can straightforwardly be found using Eq. (18). Hence, both [P2(m)] and [P1] can be solved polynomially.In the above algorithm, [P1] is solved at most |Rv| times and [P2(m)] is solved at most O(|Rv|) times in Step 1 and Step 2. Step 3 and Step 4 require at most O(|Rv|2) comparisons. However, Step 3 may be repeated at most Mvtimes. Moreover, model [P3-v] needs to be solved |V| times. Therefore, the above algorithm can find an ε-optimal solution to network containership sailing speed optimization problem inO(|Rv∥Imax∥V|log2(168M/ɛ)+M|Rv|2|V|)time, which is pseudo-polynomial with regard of the input length. The algorithm is pseudo-polynomial rather than polynomial because the expression is bounded by the number of ships M.Finally, we note that the pseudo-polynomial is fast enough for practical purposes as in reality the number of ships deployed on a route has an upper bound M, for example,M=500. This can be substantiated by the fact that the largest container shipping company in the world Maersk Line had 453 ships in total in 2012 (UNCTAD, 2013).We use an Asia–Europe–Oceania shipping network shown in Fig. 6 provided by a global liner shipping company to demonstrate the applicability of the pseudo-polynomial-time algorithm. This network has 46 ports and 11 ship routes, as shown in Table 1. Because ship routes with different types of ships can be optimized separately, we assume that the same type of ships – 8000-TEU ships – is deployed on all the ship routes. The other parameters are as follows:cv=200,000,α=500,ari=0.001andbri=2for all legs of all of the ship routes; hriis equal to 0.5 times the volume of containers on the leg, and we assume that on each ship route the first leg has 4000 TEUs of containers, the last leg has 8000 TEUs, and the differences of the flows on leg i ∈ Ir\{1} and legi−1are the same; the port time is 24 hours at each port of call; andMv=35.The pseudo-polynomial time algorithm for [P3-v] and the bi-section search algorithm for [P1] are coded in MATLAB on a 3.5 Gigahertz Eight Core PC with 16 Gigabyte of RAM. In the bi-section search algorithm,ɛ=0.001. The model [P3-v], with a total of 11 integer variables and 87 continuous variables, can be solved in 1 second.To optimize the total cost, we first computemr*, and the result is shown in Table 2. The optimal integer numbers of ships on ship routes 6, 7, 8, 10, 11 can easily be computed as they satisfymr*−⌊mr*⌋≥0.5. We need to calculateCr(⌊mr*⌋)andCr(⌊mr*⌋+1)for the other ship routes. Their values (unit: 106 dollars/week) and the optimal integer numbers of ships are shown in Table 2. It can be seen that on ship routes 3 and 4, althoughmr*−⌊mr*⌋<0.5, deploying⌊mr*⌋+1ships are preferable. This again validates part (ii) of Theorem 2.The total cost of all of the ship routes with the (infeasible) solution(m˜r,r∈Rv)is 32.02 × 106 dollars/week. As∑r∈Rvm˜r=41>Mv, we compute Cr(m) for each ship route r ∈ Rvand eachm=⌈T^r/168⌉,⌈T^r/168⌉+1,…,m˜r−1. Table 3 reports the value of Cr(m) (unit: 106 dollars/week) for each ship route r ∈ Rv(the rows) and eachm=⌈T^/168⌉,⌈T^/168⌉+1,…,m˜r(the columns). Steps 3 and 4 of the algorithm then gives the optimal solution(m^r,r∈Rv)=(3,5,1,1,4,2,2,3,3,2,9), highlighted in gray shadings in Table 3. The minimum total cost is 33.42 × 106 dollars/week.

@&#CONCLUSIONS@&#
This paper has examined the fundamental properties of the network containership sailing speed optimization problem that minimizes the sum of ship cost, bunker cost, and inventory cost and thereby developed a pseudo-polynomial-time solution algorithm. We have derived analytical solutions for sailing speed optimization on a single ship route with a continuous number of ships. The analytical solutions demonstrate that the optimal sailing speeds on different legs are generally different due to the different inventory cost rates. The optimal speed on a leg increases with the inventory cost rate and the ship operating cost, and decreases with the bunker price and the bunker consumption coefficients. Nevertheless, the rates of change are not constant. If the optimal continuous number of ship to deploy is not an integer, and its part on the right of the decimal place is not smaller than 0.5, then the optimal integer number of ships can be obtained by simply rounding up the optimal continuous number to the nearest integer. However, there is no straightforward answer if the part on the right of the decimal place is smaller than 0.5. In this case, to find the optimal integer number of ships, we need to solve two equations, each in one unknown, using a simple bi-section search method. The properties of two functions, namely, the function of the total cost on a leg with regard to the sailing time on it and the function of the total cost of a ship route with regard to the number of ships deployed on it, enabled us to identify an optimality condition for network containership sailing speed optimization. Based on this optimality condition, we proposed a pseudo-polynomial-time solution algorithm that can efficiently obtain an epsilon-optimal solution for sailing speed of containerships in a liner shipping network. The proposed pseudo-polynomial-time solution algorithm was applied to an Asia–Europe–Oceania liner shipping network.